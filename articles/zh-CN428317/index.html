<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘©ğŸ¿ ğŸ•´ğŸ¼ ğŸ“‰ ååº”é’©å­-èµ¢è¿˜æ˜¯è¾“ï¼Ÿ ğŸ’§ ğŸ¤Ÿ ğŸ›ï¸</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="éšç€æ–°çš„React 16.6.0çš„å‘å¸ƒï¼ŒHOOKS ï¼ˆå»ºè®®ï¼‰å‡ºç°åœ¨æ–‡æ¡£ä¸­ã€‚ ç°åœ¨ï¼Œå®ƒä»¬åœ¨react 17.0.0-alphaä¸­å¯ç”¨ï¼Œå¹¶åœ¨å¼€æ”¾çš„RFCï¼šReact Hooksä¸­è¿›è¡Œäº†è®¨è®ºã€‚ è®©æˆ‘ä»¬çœ‹çœ‹å®ƒæ˜¯ä»€ä¹ˆï¼Œä»¥åŠä¸ºä»€ä¹ˆéœ€è¦å‰Šå‡å®ƒã€‚ 


 æ˜¯çš„ï¼Œå®ƒæ˜¯RFCï¼Œæ‚¨å¯ä»¥å½±å“ä¸reactçš„åˆ›å»ºè€…è®¨è®ºçš„æœ€ç»ˆå®...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ååº”é’©å­-èµ¢è¿˜æ˜¯è¾“ï¼Ÿ</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/428317/"><p><img src="https://habrastorage.org/webt/qi/fs/qc/qifsqcglrtrastzefywxuzgnhfk.jpeg" alt="å›¾ç‰‡"></p><br><p> éšç€æ–°çš„React 16.6.0çš„å‘å¸ƒï¼ŒHOOKS <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ï¼ˆå»ºè®®ï¼‰</a>å‡ºç°åœ¨æ–‡æ¡£ä¸­ã€‚ ç°åœ¨ï¼Œå®ƒä»¬åœ¨react 17.0.0-alphaä¸­å¯ç”¨ï¼Œå¹¶åœ¨å¼€æ”¾çš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">RFCï¼šReact Hooksä¸­</a>è¿›è¡Œäº†è®¨è®ºã€‚ è®©æˆ‘ä»¬çœ‹çœ‹å®ƒæ˜¯ä»€ä¹ˆï¼Œä»¥åŠä¸ºä»€ä¹ˆéœ€è¦å‰Šå‡å®ƒã€‚ </p><a name="habracut"></a><br><p> æ˜¯çš„ï¼Œå®ƒæ˜¯RFCï¼Œæ‚¨å¯ä»¥å½±å“ä¸reactçš„åˆ›å»ºè€…è®¨è®ºçš„æœ€ç»ˆå®ç°æ–¹å¼ï¼Œä¸ºä»€ä¹ˆä»–ä»¬é€‰æ‹©è¿™ç§æˆ–é‚£ç§æ–¹æ³•ã€‚ </p><br><p> è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹æ ‡å‡†æŒ‚é’©çš„å¤–è§‚ï¼š </p><br><pre><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { useState } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Example</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// Declare a new state variable, which we'll call "count" const [count, setCount] = useState(0); return ( &lt;div&gt; &lt;p&gt;You clicked {count} times&lt;/p&gt; &lt;button onClick={() =&gt; setCount(count + 1)}&gt; Click me &lt;/button&gt; &lt;/div&gt; ); }</span></span></code> </pre> <br><p> å°è¯•è€ƒè™‘ä¸€ä¸‹è¿™æ®µä»£ç ï¼Œè¿™æ˜¯ä¸€ä¸ªé¢„å‘Šç‰‡ï¼Œåˆ°æœ¬æ–‡ç»“å°¾ï¼Œæ‚¨å·²ç»äº†è§£äº†å®ƒçš„å«ä¹‰ã€‚ æ‚¨åº”è¯¥çŸ¥é“çš„ç¬¬ä¸€ä»¶äº‹æ˜¯ï¼Œè¿™ä¸ä¼šç ´åå‘åå…¼å®¹æ€§ï¼Œä¹Ÿè®¸åœ¨RFCä¸­æ”¶é›†åé¦ˆå’Œå»ºè®®åï¼Œå®ƒä»¬ä¼šåœ¨16.7ä¸­æ·»åŠ ã€‚ </p><br><p> å°±åƒä¼™è®¡ä»¬ä¿è¯çš„é‚£æ ·ï¼Œè¿™ä¸æ˜¯å‰Šå‡è¯•å‰‚ç§ç±»çš„è®¡åˆ’ã€‚ </p><br><p> åŒæ ·ï¼Œé’©å­ä¸èƒ½æ›¿ä»£å½“å‰çš„ååº”æ¦‚å¿µï¼Œä¸€åˆ‡éƒ½å¯ä»¥ä»£æ›¿props / state / context / refsã€‚ è¿™åªæ˜¯åˆ©ç”¨ä»–ä»¬åŠ›é‡çš„å¦ä¸€ç§æ–¹å¼ã€‚ </p><br><h3 id="motivaciya"> åŠ¨æœº </h3><br><p> é’©å­ä¹çœ‹ä¹‹ä¸‹è§£å†³äº†éè¿æ¥é—®é¢˜ï¼Œè¿™äº›é—®é¢˜æ˜¯åœ¨è¿‡å»5å¹´ä¸­æ¥è‡ªFacebookçš„æˆåƒä¸Šä¸‡ä¸ªç»„ä»¶çš„æ”¯æŒä¸‹å‡ºç°çš„ã€‚ </p><br><p> æœ€å›°éš¾çš„äº‹æƒ…æ˜¯åœ¨æœ‰çŠ¶æ€ç»„ä»¶ä¸­é‡ç”¨é€»è¾‘ï¼Œååº”æ— æ³•å°†å¯é‡ç”¨è¡Œä¸ºé™„åŠ åˆ°ç»„ä»¶ä¸Šï¼ˆä¾‹å¦‚ï¼Œå°†å…¶è¿æ¥åˆ°å­˜å‚¨åº“ï¼‰ã€‚ å¦‚æœæ‚¨ä½¿ç”¨è¿‡Reactï¼Œå°±ä¼šçŸ¥é“HOCï¼ˆé«˜é˜¶ç»„ä»¶ï¼‰æˆ–æ¸²æŸ“é“å…·çš„æ¦‚å¿µã€‚ è¿™äº›è¶³å¤Ÿå¥½ï¼Œä½†æ˜¯æœ‰æ—¶å®ƒä»¬ä½¿ç”¨è¿‡å¤šï¼Œå®ƒä»¬éœ€è¦é‡ç»„ç»„ä»¶ä»¥ä¾¿å¯ä»¥ä½¿ç”¨å®ƒä»¬ï¼Œè¿™é€šå¸¸ä¼šä½¿ä»£ç å˜å¾—æ›´éº»çƒ¦ã€‚ å€¼å¾—ç ”ç©¶å…¸å‹çš„Reactåº”ç”¨ç¨‹åºï¼Œè¿™å°†ä½¿é—®é¢˜å˜å¾—æ¸…æ™°ã€‚ </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/35f/c76/c98/35fc76c98f2288b4c2c46a45a2f4145c.gif" alt="å›¾ç‰‡"></p><br><p> è¿™ç§°ä¸º<em>åŒ…è£…åœ°ç‹±</em> -åŒ…è£…åœ°ç‹±ã€‚ </p><br><p> åœ¨å½“å‰ç°å®ä¸­ï¼Œä»…æ¥è‡ªHOCçš„åº”ç”¨ç¨‹åºæ˜¯æ­£å¸¸çš„ï¼Œå®ƒä»¬å°†ç»„ä»¶è¿æ¥åˆ°å•†åº—/ä¸»é¢˜/æœ¬åœ°åŒ–/è‡ªå®šä¹‰ç»„ä»¶ï¼Œæˆ‘æƒ³æ¯ä¸ªäººéƒ½çŸ¥é“è¿™ä¸€ç‚¹ã€‚ </p><br><p> æ˜¾ç„¶ï¼Œååº”éœ€è¦å¦ä¸€ç§åŸå§‹æœºåˆ¶æ¥åˆ†ç¦»é€»è¾‘ã€‚ </p><br><p> ä½¿ç”¨æŒ‚é’©ï¼Œæˆ‘ä»¬å¯ä»¥æå–ç»„ä»¶çš„çŠ¶æ€ï¼Œä»¥ä¾¿å¯¹å…¶è¿›è¡Œæµ‹è¯•å’Œé‡ç”¨ã€‚ æŒ‚é’©å…è®¸æ‚¨é‡ç”¨çŠ¶æ€é€»è¾‘ï¼Œè€Œæ— éœ€æ›´æ”¹ç»„ä»¶çš„å±‚æ¬¡ç»“æ„ã€‚ è¿™ä¿ƒè¿›äº†è®¸å¤šç»„ä»¶æˆ–æ•´ä¸ªç³»ç»Ÿä¹‹é—´çš„é“¾æ¥äº¤æ¢ã€‚ åŒæ ·ï¼Œç±»ç»„ä»¶çœ‹èµ·æ¥å¾ˆå“äººï¼Œæˆ‘ä»¬æè¿°äº†<code>componentDidMount</code> / <code>shouldComponentUpdate</code> / <code>componentDidUpdate</code>çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼Œ <code>componentDidMount</code>çš„çŠ¶æ€ï¼Œåˆ›å»ºç”¨äºçŠ¶æ€/è¾¹çš„æ–¹æ³•ï¼Œä¸ºç»„ä»¶å®ä¾‹ç»‘å®šæ–¹æ³•ç­‰ï¼Œå› æ­¤å®ƒå¯ä»¥ä¸æ–­åœ°è¿›è¡Œä¸‹å»ã€‚ é€šå¸¸ï¼Œæ­¤ç±»ç»„ä»¶è¶…å‡ºäº†xè¡Œï¼Œå…¶ä¸­xå¾ˆéš¾ç†è§£ã€‚ </p><br><p> æŒ‚é’©ä½¿æ‚¨å¯ä»¥é€šè¿‡å°†ç»„ä»¶ä¹‹é—´çš„é€»è¾‘åˆ†è§£ä¸ºå°åŠŸèƒ½å¹¶åœ¨ç»„ä»¶å†…éƒ¨ä½¿ç”¨å®ƒä»¬æ¥æ‰§è¡Œç›¸åŒçš„æ“ä½œã€‚ </p><br><h3 id="klassy-slozhny-dlya-lyudey-i-dlya-mashin"> å¯¹äººå’Œæ±½è½¦æ¥è¯´ï¼Œä¸Šè¯¾éƒ½å¾ˆå›°éš¾ </h3><br><p> åœ¨è§‚å¯ŸFacebookç±»æ—¶ï¼Œå­¦ä¹ Reactæ˜¯ä¸€ä¸ªå¾ˆå¤§çš„éšœç¢ã€‚ æ‚¨éœ€è¦äº†è§£<code>this</code>å·¥ä½œåŸç†ï¼Œå¹¶ä¸”å®ƒä¸èƒ½åƒå…¶ä»–ç¼–ç¨‹è¯­è¨€é‚£æ ·å·¥ä½œï¼Œæ‚¨è¿˜åº”è¯¥è®°ä½ç»‘å®šäº‹ä»¶å¤„ç†ç¨‹åºã€‚ æ²¡æœ‰ç¨³å®šçš„è¯­æ³•è¯­å¥ï¼Œä»£ç çœ‹èµ·æ¥å¾ˆå†—é•¿ã€‚ äººä»¬äº†è§£é“å…·/çŠ¶æ€æ¨¡å¼å’Œæ‰€è°“çš„è‡ªä¸Šè€Œä¸‹çš„æ•°æ®æµï¼Œä½†æ˜¯è¿™äº›ç±»å¾ˆéš¾ç†è§£ã€‚ </p><br><p> å°¤å…¶æ˜¯å¦‚æœä¸é™äºæ¨¡æ¿ï¼Œä¸ä¹…å‰ååº”ä¸­çš„äººå°±ä½¿ç”¨Prepack <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å¯¹ç»„ä»¶</a>çš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å¸ƒå±€è¿›è¡Œ</a>äº†è¯•éªŒï¼Œå¹¶çœ‹åˆ°äº†å¯å–œçš„ç»“æœï¼Œä½†æ˜¯å°½ç®¡å¦‚æ­¤ï¼Œè¯¥ç±»çš„ç»„ä»¶ä»ä½¿æ‚¨å¯ä»¥åˆ›å»ºæ„æƒ³ä¸åˆ°çš„ä¸è‰¯æ¨¡å¼ï¼Œä½¿è¿™äº›ä¼˜åŒ–æ¶ˆå¤±ï¼Œå¹¶ä¸”å½“çƒ­é‡è½½ç±»ä½¿å…¶ä¸å¯é ã€‚ é¦–å…ˆï¼Œè¿™äº›å®¶ä¼™æƒ³æä¾›ä¸€ä¸ªAPIï¼Œè¯¥APIæ”¯æŒæ‰€æœ‰ä¼˜åŒ–å¹¶ä¸”å¯ä»¥åœ¨çƒ­é‡å¯æ—¶æ­£å¸¸å·¥ä½œã€‚ </p><br><h3 id="glyanem-na-huki"> çœ‹çœ‹é’©å­ </h3><br><h4 id="state-hook"> çŠ¶æ€é’© </h4><br><p> ä¸‹é¢çš„ä»£ç å‘ˆç°äº†ä¸€ä¸ªæ®µè½å’Œä¸€ä¸ªæŒ‰é’®ï¼Œå¦‚æœæˆ‘ä»¬å•å‡»è¯¥æŒ‰é’®ï¼Œåˆ™è¯¥æ®µè½ä¸­çš„å€¼å°†å¢åŠ ã€‚ </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { useState } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Example</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// Declare a new state variable, which we'll call "count" const [count, setCount] = useState(0); return ( &lt;div&gt; &lt;p&gt;You clicked {count} times&lt;/p&gt; &lt;button onClick={() =&gt; setCount(count + 1)}&gt; Click me &lt;/button&gt; &lt;/div&gt; ); }</span></span></code> </pre> <br><p> ç”±æ­¤æˆ‘ä»¬å¯ä»¥å¾—å‡ºç»“è®ºï¼Œè¯¥é’©å­ä¸<code>state</code>ç±»çš„æ¦‚å¿µç±»ä¼¼ã€‚ <br> æ›´è¯¦ç»†ä¸€ç‚¹çš„<code>useState</code>æ–¹æ³•ä½¿ç”¨ä¸€ä¸ªå‚æ•°ï¼Œè¿™æ˜¯é»˜è®¤å€¼ï¼Œå¹¶è¿”å›ä¸€ä¸ªå…ƒç»„ï¼Œå…¶ä¸­åŒ…å«å€¼æœ¬èº«ä»¥åŠç”¨äºæ›´æ”¹å®ƒçš„æ–¹æ³•ï¼Œä¸setStateä¸åŒï¼ŒsetCountä¸ä¼š<em>åˆå¹¶</em>å€¼ï¼Œè€Œåªæ˜¯æ›´æ–°å®ƒã€‚ æˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨å¤šä¸ªçŠ¶æ€å£°æ˜ï¼Œä¾‹å¦‚ï¼š </p><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ExampleWithManyStates</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// Declare multiple state variables! const [age, setAge] = useState(42); const [fruit, setFruit] = useState('banana'); const [todos, setTodos] = useState([{ text: 'Learn Hooks' }]); // ... }</span></span></code> </pre> <br><p> å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ä¸€æ¬¡åˆ›å»ºå¤šä¸ªçŠ¶æ€ï¼Œè€Œæ— éœ€è€ƒè™‘å¦‚ä½•ä»¥æŸç§æ–¹å¼åˆ†è§£å®ƒä»¬ã€‚ å› æ­¤ï¼Œå¯ä»¥åŒºåˆ†å‡ºæŒ‚é’©æ˜¯å…è®¸æ‚¨â€œè¿æ¥â€åˆ°ç±»ç»„ä»¶çš„èŠ¯ç‰‡çš„å‡½æ•°ï¼Œå°±åƒæŒ‚é’©åœ¨ç±»å†…éƒ¨ä¸èµ·ä½œç”¨ä¸€æ ·ï¼Œè®°ä½è¿™ä¸€ç‚¹å¾ˆé‡è¦ã€‚ </p><br><h4 id="effect-hook"> æ•ˆæœé’© </h4><br><p> é€šå¸¸åœ¨ç±»ç»„ä»¶ä¸­ï¼Œæˆ‘ä»¬ä¼šäº§ç”Ÿå‰¯ä½œç”¨åŠŸèƒ½ï¼Œä¾‹å¦‚ï¼Œè®¢é˜…äº‹ä»¶æˆ–è¯·æ±‚æ•°æ®ï¼Œä¸ºæ­¤ï¼Œé€šå¸¸ä½¿ç”¨<code>componentDidMount</code> / <code>componentDidUpdate</code>æ–¹æ³• </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { useState, useEffect } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Example</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> [count, setCount] = useState(<span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-comment"><span class="hljs-comment">// Similar to componentDidMount and componentDidUpdate: useEffect(() =&gt; { // Update the document title using the browser API document.title = `You clicked ${count} times`; }); return ( &lt;div&gt; &lt;p&gt;You clicked {count} times&lt;/p&gt; &lt;button onClick={() =&gt; setCount(count + 1)}&gt; Click me &lt;/button&gt; &lt;/div&gt; ); }</span></span></code> </pre> <br><p> å½“æˆ‘ä»¬è°ƒç”¨<code>useEffect</code>æˆ‘ä»¬å‘Šè¯‰<code>useEffect</code>åœ¨æ›´æ–°DOMæ ‘ä¸­çš„æ›´æ”¹ååšå‡ºâ€œå‰¯ä½œç”¨â€ã€‚ æ•ˆæœåœ¨ç»„ä»¶å†…éƒ¨å£°æ˜ï¼Œå› æ­¤å¯ä»¥è®¿é—®é“å…·/çŠ¶æ€ã€‚ æ­¤å¤–ï¼Œæˆ‘ä»¬å¯ä»¥æŒ‰ç…§æ‚¨å¸Œæœ›çš„æ–¹å¼å®Œå…¨ç›¸åŒåœ°åˆ›å»ºå®ƒä»¬ã€‚ </p><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FriendStatusWithCounter</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">props</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> [count, setCount] = useState(<span class="hljs-number"><span class="hljs-number">0</span></span>); useEffect(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.title = <span class="hljs-string"><span class="hljs-string">`You clicked </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${count}</span></span></span><span class="hljs-string"> times`</span></span>; }); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> [isOnline, setIsOnline] = useState(<span class="hljs-literal"><span class="hljs-literal">null</span></span>); useEffect(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> { ChatAPI.subscribeToFriendStatus(props.friend.id, handleStatusChange); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> { ChatAPI.unsubscribeFromFriendStatus(props.friend.id, handleStatusChange); }; }); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">handleStatusChange</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">status</span></span></span><span class="hljs-function">) </span></span>{ setIsOnline(status.isOnline); } <span class="hljs-comment"><span class="hljs-comment">// ...</span></span></code> </pre> <br><p> ç«‹å³å€¼å¾—å…³æ³¨å…¶ä¸­çš„ç¬¬äºŒä¸ªå‰¯ä½œç”¨ï¼Œæˆ‘ä»¬è¿”å›è¯¥å‡½æ•°ï¼Œæˆ‘ä»¬æ‰§è¡Œæ­¤æ“ä½œæ˜¯ä¸ºäº†åœ¨ç»„ä»¶æ‰§è¡Œå¸è½½åæ‰§è¡Œä¸€äº›æ“ä½œï¼Œåœ¨æ–°çš„apiä¸­ï¼Œè¿™ç§°ä¸ºå¸¦æœ‰æ¸…æ´—çš„æ•ˆæœã€‚ å…¶ä»–æ•ˆæœå¯ä»¥è¿”å›ä»»ä½•ç»“æœã€‚ </p><br><h3 id="pravila-hukov"> æŒ‚é’©è§„åˆ™ </h3><br><p> æŒ‚é’©åªæ˜¯javascriptå‡½æ•°ï¼Œä½†å®ƒä»¬åªéœ€è¦ä¸¤ä¸ªè§„åˆ™ï¼š </p><br><ul><li> æŒ‚é’©åº”åœ¨å‡½æ•°å±‚æ¬¡ç»“æ„çš„æœ€é¡¶å±‚æ‰§è¡Œï¼ˆè¿™æ„å‘³ç€æ‚¨ä¸åº”åœ¨æ¡ä»¶å’Œå¾ªç¯ä¸­è°ƒç”¨æŒ‚é’©ï¼Œå¦åˆ™ååº”ä¸èƒ½ä¿è¯æŒ‚é’©çš„æ‰§è¡Œé¡ºåºï¼‰ </li><li> ä»…åœ¨Reactå‡½æ•°æˆ–åŠŸèƒ½ç»„ä»¶ä¸­è°ƒç”¨é’©å­ï¼Œæˆ–è€…åœ¨è‡ªå®šä¹‰é’©å­ä¸­è°ƒç”¨é’©å­ï¼ˆå¦‚ä¸‹æ‰€ç¤ºï¼‰ã€‚ <br> ä¸ºäº†éµå¾ªè¿™äº›è§„åˆ™ï¼Œreactå›¢é˜Ÿçš„æˆå‘˜åˆ›å»ºäº†ä¸€ä¸ª<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">linteræ’ä»¶</a> ï¼Œå¦‚æœæ‚¨åœ¨ç±»ç»„ä»¶æˆ–å¾ªç¯å’Œæ¡ä»¶ä¸­è°ƒç”¨é’©å­ï¼Œåˆ™<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è¯¥æ’ä»¶</a>å°†<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å¼•å‘</a>é”™è¯¯ã€‚ </li></ul><br><h3 id="kastomnye-huki"> å®šåˆ¶æŒ‚é’© </h3><br><p> åŒæ—¶ï¼Œæˆ‘ä»¬æƒ³é‡ç”¨æœ‰çŠ¶æ€ç»„ä»¶çš„é€»è¾‘ï¼Œä¸ºæ­¤é€šå¸¸ä½¿ç”¨HOCæˆ–æ¸²æŸ“é“å…·æ¨¡å¼ï¼Œä½†å®ƒä»¬ä¼šå¢åŠ åº”ç”¨ç¨‹åºçš„ä½“ç§¯ã€‚ <br> ä¾‹å¦‚ï¼Œæˆ‘ä»¬æè¿°ä»¥ä¸‹åŠŸèƒ½ï¼š </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { useState, useEffect } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">useFriendStatus</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">friendID</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> [isOnline, setIsOnline] = useState(<span class="hljs-literal"><span class="hljs-literal">null</span></span>); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">handleStatusChange</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">status</span></span></span><span class="hljs-function">) </span></span>{ setIsOnline(status.isOnline); } useEffect(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> { ChatAPI.subscribeToFriendStatus(friendID, handleStatusChange); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> { ChatAPI.unsubscribeFromFriendStatus(friendID, handleStatusChange); }; }); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> isOnline; }</code> </pre> <br><p> å®ç°æ­¤ä»£ç ï¼Œå®ƒå°†æ˜¯ä¸€ä¸ªè‡ªå®šä¹‰æŒ‚é’©ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å„ä¸ªç»„ä»¶ä¸­è°ƒç”¨å®ƒã€‚ ä¾‹å¦‚ï¼Œåƒè¿™æ ·ï¼š </p><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FriendStatus</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">props</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> isOnline = useFriendStatus(props.friend.id); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (isOnline === <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">'Loading...'</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> isOnline ? <span class="hljs-string"><span class="hljs-string">'Online'</span></span> : <span class="hljs-string"><span class="hljs-string">'Offline'</span></span>; }</code> </pre> <br><p> å¤§æ¦‚ </p><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FriendListItem</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">props</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> isOnline = useFriendStatus(props.friend.id); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ( <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">li</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">style</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{{</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">color:</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">isOnline</span></span></span></span><span class="xml"><span class="hljs-tag"> ? '</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">green</span></span></span></span><span class="xml"><span class="hljs-tag">' </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">:</span></span></span></span><span class="xml"><span class="hljs-tag"> '</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">black</span></span></span></span><span class="xml"><span class="hljs-tag">' }}&gt;</span></span></span><span class="xml"> {props.friend.name} </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">li</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> ); }</code> </pre> <br><p> æ— è®ºå¦‚ä½•ï¼Œæˆ‘ä»¬éƒ½å°†é‡ç”¨ç»„ä»¶çš„çŠ¶æ€ï¼Œæ¯æ¬¡å¯¹<code>useFriendStatus</code>å‡½æ•°çš„è°ƒç”¨<code>useFriendStatus</code>åˆ›å»ºä¸€ä¸ªéš”ç¦»çŠ¶æ€ã€‚ è¿˜å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæ­¤å‡½æ•°çš„å¼€å¤´ä»¥å•è¯<em>use</em>å¼€å¤´ï¼Œè¿™æ„å‘³ç€å®ƒæ˜¯ä¸€ä¸ªé’©å­ã€‚ æˆ‘ä»¬å»ºè®®æ‚¨éµå¾ªè¿™ç§æ ¼å¼ã€‚ æ‚¨å¯ä»¥ä¸ºä»»ä½•å†…å®¹ï¼ŒåŠ¨ç”»/è®¢é˜…/è®¡æ—¶å™¨ç­‰ç¼–å†™è‡ªå®šä¹‰é’©å­ã€‚ </p><br><p> è¿˜æœ‰æ›´å¤šçš„æŒ‚é’©ã€‚ </p><br><h4 id="usecontext">  useContext </h4><br><p>  <code>useContext</code>å…è®¸æ‚¨ä½¿ç”¨é€šå¸¸çš„è¿”å›å€¼è€Œä¸æ˜¯renderPropsï¼Œæˆ‘ä»¬è¦åœ¨å…¶ä¸­æ£€ç´¢ä¸Šä¸‹æ–‡å¹¶å°†å…¶è¿”å›ç»™æˆ‘ä»¬ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥æ‘†è„±å°†ä¸Šä¸‹æ–‡ä¼ é€’ç»™propçš„æ‰€æœ‰HOCã€‚ </p><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Example</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> locale = useContext(LocaleContext); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> theme = useContext(ThemeContext); <span class="hljs-comment"><span class="hljs-comment">// ... }</span></span></code> </pre> <br><p> ç°åœ¨æˆ‘ä»¬å¯ä»¥åœ¨è¿”å›å€¼ä¸­ä½¿ç”¨ä¸Šä¸‹æ–‡å¯¹è±¡ã€‚ </p><br><h4 id="usecallback">  useCallback </h4><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> memoizedCallback = useCallback( <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> { doSomething(a, b); }, [a, b], );</code> </pre> <br><p> ä¸ºäº†ä¿å­˜å¯¹æ–¹æ³•çš„å¼•ç”¨ï¼Œæ‚¨å¿…é¡»å¤šä¹…åˆ›å»ºä¸€ä¸ªç±»çš„ç»„ä»¶ï¼Ÿ ä¸å†éœ€è¦è¿™æ ·åšï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨useCallbackï¼Œå¹¶ä¸”ä¸ä¼šé‡ç»˜æˆ‘ä»¬çš„ç»„ä»¶ï¼Œå› ä¸ºå·²ç»æœ‰äº†æŒ‡å‘onClickçš„æ–°é“¾æ¥ã€‚ </p><br><h4 id="usememo">  useMemo </h4><br><p> æˆ‘ä»¬è¿”å›è®°å¿†å€¼ï¼Œè®°å¿†å€¼æ„å‘³ç€ä»…å½“å…¶ä¸­ä¸€ä¸ªå‚æ•°å·²æ›´æ”¹æ—¶æ‰è®¡ç®—è¯¥å€¼ï¼Œè€Œç¬¬äºŒæ¬¡å°†ä¸è®¡ç®—è¯¥å€¼ã€‚ </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> memoizedValue = useMemo(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> computeExpensiveValue(a, b), [a, b]);</code> </pre> <br><p> æ˜¯çš„ï¼Œåœ¨è¿™é‡Œæ‚¨å¿…é¡»å¤åˆ¶æ•°ç»„ä¸­çš„å€¼ï¼Œä»¥ä¾¿æŒ‚é’©äº†è§£å®ƒä»¬æ²¡æœ‰æ›´æ”¹ã€‚ </p><br><h4 id="useref">  useRef </h4><br><p>  <code>useRef</code>è¿”å›ä¸€ä¸ªçªå˜å€¼ï¼Œå…¶ä¸­<code>.current</code>å­—æ®µå°†ä½¿ç”¨ç¬¬ä¸€ä¸ªå‚æ•°åˆå§‹åŒ–ï¼Œåªè¦ç»„ä»¶å­˜åœ¨ï¼Œè¯¥å¯¹è±¡å°±ä¼šå­˜åœ¨ã€‚ <br> ä¸“æ³¨äºè¾“å…¥çš„æœ€å¸¸è§ç¤ºä¾‹ </p><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TextInputWithFocusButton</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> inputEl = useRef(<span class="hljs-literal"><span class="hljs-literal">null</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> onButtonClick = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-comment"><span class="hljs-comment">// `current` points to the mounted text input element inputEl.current.focus(); }; return ( &lt;&gt; &lt;input ref={inputEl} type="text" /&gt; &lt;button onClick={onButtonClick}&gt;Focus the input&lt;/button&gt; &lt;/&gt; ); }</span></span></code> </pre> <br><h4 id="useimperativemethods">  useImperativeMethods </h4><br><p>  <code>useImperativeMethods</code>å®šåˆ¶ä»çˆ¶çº§ä¼ é€’å¹¶ç›´æ¥ä½¿ç”¨refçš„å®ä¾‹çš„å€¼ã€‚ ä¸å¾€å¸¸ä¸€æ ·ï¼Œåº”é¿å…ç›´æ¥é“¾æ¥ï¼Œ <code>forwardRef</code>åº”ä½¿ç”¨<code>forwardRef</code> </p><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FancyInput</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">props, ref</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> inputRef = useRef(); useImperativeMethods(ref, () =&gt; <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">{ focus: (</span></span></span><span class="hljs-function">) =&gt;</span></span> { inputRef.current.focus(); } })); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">input</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">ref</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{inputRef}</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">...</span></span></span></span><span class="xml"><span class="hljs-tag"> /&gt;</span></span></span><span class="xml">; } FancyInput = forwardRef(FancyInput);</span></span></code> </pre> <br><p> åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œ <code>FancyInput</code>çš„ç»„ä»¶å¯ä»¥è°ƒç”¨<code>fancyInputRef.current.focus()</code> ã€‚ </p><br><h4 id="usemutationeffect">  useMutationEffect </h4><br><p>  <code>useMutationEffect</code>ä¸<code>useMutationEffect</code>éå¸¸ç›¸ä¼¼ï¼Œ <code>useEffect</code>å¤„åœ¨äºï¼Œå®ƒåœ¨æ›´æ–°ç›¸é‚»ç»„ä»¶ä¹‹å‰ååº”æ›´æ”¹DOMå€¼çš„é˜¶æ®µåŒæ­¥å¯åŠ¨ï¼Œæ­¤é’©å­åº”ç”¨äºæ‰§è¡ŒDOMçªå˜ã€‚ <br> æœ€å¥½ä½¿ç”¨useEffectæ¥é˜»æ­¢è§†è§‰å˜åŒ–ã€‚ </p><br><h4 id="uselayouteffect">  useLayoutEffect </h4><br><p>  <code>useLayoutEffect</code>ä¸<code>useLayoutEffect</code>ç›¸ä¼¼ï¼Œ <code>useEffect</code>å¤„åœ¨äºï¼Œå®ƒ<em>åœ¨æ‰€æœ‰DOMæ›´æ–°</em>å’ŒåŒæ­¥é‡æ–°å‘ˆç°<em>ä¹‹åå‡</em>åŒæ­¥è¿è¡Œã€‚ åœ¨æµè§ˆå™¨å¯ä»¥ç»˜åˆ¶å…ƒç´ ä¹‹å‰ï¼Œå°†åŒæ­¥åº”ç”¨<code>useLayoutEffect</code>ä¸­è®¡åˆ’çš„æ›´æ–°ã€‚ æ‚¨è¿˜åº”è¯¥å°è¯•ä½¿ç”¨æ ‡å‡†çš„<code>useEffect</code>ä»¥å…é˜»æ­¢è§†è§‰å˜åŒ–ã€‚ </p><br><h4 id="usereducer">  useReducer </h4><br><p>  <code>useReducer</code>æ˜¯ç”¨äºåˆ›å»ºè¿”å›çŠ¶æ€å’Œè°ƒåº¦æ›´æ”¹åŠŸèƒ½çš„reducerçš„é’©å­ï¼š </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> [state, dispatch] = useReducer(reducer, initialState);</code> </pre> <br><p> å¦‚æœæ‚¨äº†è§£Reduxçš„å·¥ä½œåŸç†ï¼Œé‚£ä¹ˆæ‚¨å°†äº†è§£<code>useReducer</code>å·¥ä½œåŸç†ã€‚ ä¸ä¸Šè¿°è®¡æ•°å™¨ç›¸åŒçš„ç¤ºä¾‹ä»…é€šè¿‡<code>useReducer</code> ï¼š </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> initialState = {<span class="hljs-attr"><span class="hljs-attr">count</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>}; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">reducer</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state, action</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (action.type) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">'reset'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> initialState; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">'increment'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> {<span class="hljs-attr"><span class="hljs-attr">count</span></span>: state.count + <span class="hljs-number"><span class="hljs-number">1</span></span>}; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">'decrement'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> {<span class="hljs-attr"><span class="hljs-attr">count</span></span>: state.count - <span class="hljs-number"><span class="hljs-number">1</span></span>}; } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Counter</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">{initialCount}</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> [state, dispatch] = useReducer(reducer, initialState); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> &lt;&gt; Count: {state.count} &lt;button onClick={(</span></span></span><span class="hljs-function">) =&gt;</span></span> dispatch({<span class="hljs-attr"><span class="hljs-attr">type</span></span>: <span class="hljs-string"><span class="hljs-string">'reset'</span></span>})}&gt; Reset &lt;<span class="hljs-regexp"><span class="hljs-regexp">/button&gt; &lt;button onClick={() =&gt; dispatch({type: 'increment'})}&gt;+&lt;/</span></span>button&gt; <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">onClick</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{()</span></span></span></span><span class="xml"><span class="hljs-tag"> =&gt;</span></span></span><span class="xml"> dispatch({type: 'decrement'})}&gt;-</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> &lt;<span class="hljs-regexp"><span class="hljs-regexp">/&gt; ); }</span></span></code> </pre> <br><p>  UseReducerä¹Ÿå¸¦æœ‰3ä¸ªå‚æ•°ï¼Œè¿™æ˜¯åˆå§‹åŒ–reduceræ—¶åº”æ‰§è¡Œçš„<code>action</code> ï¼š </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> initialState = {<span class="hljs-attr"><span class="hljs-attr">count</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>}; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">reducer</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state, action</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (action.type) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">'reset'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> {<span class="hljs-attr"><span class="hljs-attr">count</span></span>: action.payload}; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">'increment'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> {<span class="hljs-attr"><span class="hljs-attr">count</span></span>: state.count + <span class="hljs-number"><span class="hljs-number">1</span></span>}; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">'decrement'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> {<span class="hljs-attr"><span class="hljs-attr">count</span></span>: state.count - <span class="hljs-number"><span class="hljs-number">1</span></span>}; } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Counter</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">{initialCount}</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> [state, dispatch] = useReducer( reducer, initialState, {<span class="hljs-attr"><span class="hljs-attr">type</span></span>: <span class="hljs-string"><span class="hljs-string">'reset'</span></span>, <span class="hljs-attr"><span class="hljs-attr">payload</span></span>: initialCount}, ); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> &lt;&gt; Count: {state.count} &lt;button onClick={(</span></span></span><span class="hljs-function">) =&gt;</span></span> dispatch({<span class="hljs-attr"><span class="hljs-attr">type</span></span>: <span class="hljs-string"><span class="hljs-string">'reset'</span></span>, <span class="hljs-attr"><span class="hljs-attr">payload</span></span>: initialCount})}&gt; Reset &lt;<span class="hljs-regexp"><span class="hljs-regexp">/button&gt; &lt;button onClick={() =&gt; dispatch({type: 'increment'})}&gt;+&lt;/</span></span>button&gt; <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">onClick</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{()</span></span></span></span><span class="xml"><span class="hljs-tag"> =&gt;</span></span></span><span class="xml"> dispatch({type: 'decrement'})}&gt;-</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> &lt;<span class="hljs-regexp"><span class="hljs-regexp">/&gt; ); }</span></span></code> </pre> <br><p> æˆ‘ä»¬è¿˜å¯ä»¥åœ¨è¯¥åŒ–<code>useContext</code>å™¨ä¸­åˆ›å»ºä¸€ä¸ªä¸Šä¸‹æ–‡ï¼Œå¹¶é€šè¿‡<code>useContext</code>é’©å­ä½¿ç”¨å®ƒæ¥åœ¨æ•´ä¸ªåº”ç”¨ç¨‹åºä¸­ä½¿ç”¨å®ƒï¼Œè¿™ä»ç„¶æ˜¯å®¶åº­ä½œä¸šã€‚ </p><br><h4 id="podvodya-itog"> æ€»ç»“ä¸€ä¸‹ </h4><br><p> æŒ‚é’©æ˜¯è§£å†³åŒ…è£…å™¨åœ°ç‹±å’Œè§£å†³è‹¥å¹²é—®é¢˜çš„ä¸€ç§éå¸¸æœ‰æ•ˆçš„æ–¹æ³•ï¼Œä½†æ˜¯æ‰€æœ‰è¿™äº›éƒ½å¯ä»¥ä¸<em>é“¾æ¥ä¼ è¾“</em>çš„ç›¸åŒå®šä¹‰ä¸€èµ·ä½¿ç”¨ã€‚ ç°åœ¨å·²ç»å¼€å§‹å‡ºç°<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä½¿ç”¨</a>é’©å­<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">çš„</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">é›†åˆ</a>æˆ–<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è¯¥é›†åˆ</a> ã€‚ æ‚¨å¯ä»¥åœ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ–‡æ¡£ä¸­</a>äº†è§£æœ‰å…³é’©å­çš„æ›´å¤šä¿¡æ¯ã€‚ </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN428317/">https://habr.com/ru/post/zh-CN428317/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN428305/index.html">ä½ å­¦è‹±è¯­å—ï¼Ÿ æ•‘æ´æ¼«ç”»</a></li>
<li><a href="../zh-CN428307/index.html">Java Challengersï¼ƒ1ï¼šJVMä¸­çš„æ–¹æ³•é‡è½½</a></li>
<li><a href="../zh-CN428311/index.html">TrustZoneï¼šå—ä¿¡ä»»çš„æ“ä½œç³»ç»ŸåŠå…¶åº”ç”¨ç¨‹åº</a></li>
<li><a href="../zh-CN428313/index.html">MacOSä¸Šçš„ç”µæŠ¥[å¤§æ¦‚]ä¹Ÿä»¥å¯è®¿é—®çš„å½¢å¼åœ¨æœ¬åœ°å­˜å‚¨é€šä¿¡</a></li>
<li><a href="../zh-CN428315/index.html">æˆ‘ä»¬å…‹æœäº†å¯¹å¼€å‘äººå‘˜çš„5ç§ææƒ§</a></li>
<li><a href="../zh-CN428321/index.html">é¢„æµ‹æ€§æ•°æ®åˆ†æ-å»ºæ¨¡å’ŒéªŒè¯</a></li>
<li><a href="../zh-CN428327/index.html">æŸ¥æ‰¾å†…å®¹ï¼šæ¬§æ´²eIDASç”µå­è¯†åˆ«æ³•è§„</a></li>
<li><a href="../zh-CN428329/index.html">å¼ºåŒ–è®­ç»ƒï¼šè§£æè§†é¢‘æ¸¸æˆ</a></li>
<li><a href="../zh-CN428333/index.html">2018 RAIF Hackathon AI Hackathonç»“æœ</a></li>
<li><a href="../zh-CN428335/index.html">Siriå¿«æ·æ–¹å¼æ›´æ–°</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>