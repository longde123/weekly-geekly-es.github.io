<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🐙 👉🏾 🧑🏾‍🤝‍🧑🏻 Membuat game logika untuk platform game 🍺 🐚 ⬛️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Halo 

 Saya ingin berbagi cerita tentang kenalan saya dengan platform game Gameduino 3, serta sedikit pembicaraan tentang pemrograman game logika pal...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Membuat game logika untuk platform game</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/423577/">  Halo <br><br>  Saya ingin berbagi cerita tentang kenalan saya dengan platform game Gameduino 3, serta sedikit pembicaraan tentang pemrograman game logika paling sederhana untuk platform ini, yang digunakan bersama dengan Arduino Uno. <br><br>  Apa itu Gameduino 3?  Gameduino 3 adalah papan ekspansi yang memungkinkan Anda untuk mengubah Arduino menjadi konsol game genggam (artinya ukuran).  Yang mengejutkan saya, saya tidak dapat menemukan informasi terperinci di papan ini di hub.  Saya ingin mengisi celah ini, terutama karena dewan, menurut pendapat saya, patut mendapat perhatian. <br><br><h3>  Sedikit sejarah </h3><br>  Penulis proyek yang disebut Gameduino adalah James Bowman, yang pada 2011 menciptakan versi pertama papan.  Kemudian diposisikan sebagai modul VGA untuk Arduino.  Dewan itu disebut Gameduino dan didasarkan pada keluarga Xilinx Spartan-3A dari logika FPGA yang dapat diprogram.  Konektor untuk menghubungkan monitor VGA dan speaker stereo dipasang di papan. <img src="https://habrastorage.org/webt/as/6q/1-/as6q1-hlbbmoyubblbcs6hehog0.jpeg" alt="gambar"><br><a name="habracut"></a><br><div class="spoiler">  <b class="spoiler_title">Fitur Gameduino (1):</b> <div class="spoiler_text"><ul><li>  Output video VGA dengan resolusi 400x300 piksel, 512 warna; </li><li>  semua gamut warna diproses dalam FPGA dengan akurasi 15-bit; </li></ul><br>  gambar latar belakang: <br><br><ul><li>  bidang grafis latar belakang simbolis 512x512 piksel; </li><li>  256 karakter, masing-masing dengan palet 4-warna independen; </li><li>  menerapkan efek pembungkus string teks dengan perataan piksel; </li></ul><br>  grafik foreground: <br><br><ul><li>  Setiap sprite memiliki resolusi 16x16 piksel; </li><li>  setiap sprite dapat memiliki palet 256-, 16- atau 4-warna; </li><li>  dukungan untuk rotasi 4 arah dan algoritma rotasi horisontal; </li><li>  96 sprite per garis raster, 1536 elemen tekstur per garis raster; </li><li>  mekanisme untuk mendeteksi kemungkinan persimpangan sprite; </li></ul><br>  output audio: <br><br><ul><li>  12-bit dual-channel synthesizer frekuensi; </li><li>  Polifoni 64-suara dalam rentang frekuensi 10 - 8000 Hz. </li></ul><br>  Gambar ditampilkan pada layar monitor VGA standar dengan resolusi 400x300 piksel, <br>  kompatibilitas dengan monitor VGA standar dengan resolusi 800x600 piksel dipertahankan. <br></div></div><br>  Pada tahun 2013, versi kedua papan dirilis - Gameduino 2, di mana, tidak seperti versi sebelumnya, sudah ada layar sentuh resistif 4,3 inci dengan resolusi 480x272, akselerometer 3-sumbu, slot kartu memori microSD, dan output audio untuk headphone. <br><br><img src="https://habrastorage.org/webt/rv/e-/vg/rve-vggbftjqtpadk4ftr7xtfq4.jpeg" alt="gambar"><br><br>  "Jantung" papan adalah pengontrol grafis EVE (Embedded Video Engine - dalam bahasa Rusia dapat diterjemahkan sebagai "modul video tertanam") FT800, yang memiliki kemampuan komputasi yang kuat, menggabungkan beberapa fungsi pada saat yang bersamaan: pembentukan gambar dan outputnya ke layar layar TFT, pemrosesan layar sentuh, generasi suara. <br><br><div class="spoiler">  <b class="spoiler_title">Diagram fungsional pengontrol grafis FT800</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/lj/7_/dd/lj7_ddvshsrqz9f1mhfs_xhzvja.jpeg" alt="gambar"><br><br>  Blok fungsional berikut termasuk dalam struktur sirkuit mikro: pengontrol grafis, pengontrol audio, pengontrol panel sentuh resistif.  Chip FT800 dirancang untuk mengontrol tampilan dengan resolusi hingga 512 x 512 piksel.  FT800 juga mendukung LCD WQVGA (480 x 272) dan QVGA (320 x 240).  EVE (Embedded Video Engine) FT800 adalah solusi turnkey untuk membuat antarmuka pengguna grafis.  Microcircuit menghasilkan sinyal kontrol tampilan, memiliki fungsi grafis built-in untuk menampilkan titik, garis, gambar bitmap, tombol volume, teks, dll. </div></div><br><br><div class="spoiler">  <b class="spoiler_title">Struktur Sistem Berdasarkan Pengontrol Grafis FT800</b> <div class="spoiler_text">  Pembentukan gambar didasarkan pada seperangkat perintah (daftar tampilan), yang ditransmisikan oleh mikrokontroler kontrol ke FT800 melalui antarmuka I2C atau SPI (dalam Gameduino 2, komunikasi antara Arduino dan FT800 dilakukan melalui antarmuka SPI).  Fitur FT800 secara signifikan mengurangi pengontrol host sistem. <br><br><img src="https://habrastorage.org/webt/br/2b/2u/br2b2ueemryzlv-qxkor6whrft4.jpeg" alt="gambar"><br><br>  Misalnya, untuk menampilkan sejumlah tombol, cukup untuk mentransfer satu perintah ke pengontrol grafis (empat kata 32-bit), dan FT800 akan secara mandiri membentuk gambar tombol-tombol ini pada layar layar TFT.  Set perintah pengontrol grafis FTDI mencakup lebih dari 50 fungsi yang dapat digunakan untuk menampilkan berbagai gambar pada layar tampilan dengan berbagai efek. <br><br>  Manual pemrograman pengontrol terperinci dan contoh-contoh bekerja dengan berbagai lingkungan desain dapat ditemukan di Catatan Aplikasi di situs web <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">FTDI</a> . <br><br>  Di Rusia, deskripsi yang baik tentang fungsi, prinsip-prinsip umum dan contoh-contoh pekerjaan ada di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sini</a> . <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Fitur Gameduino 2:</b> <div class="spoiler_text"><ul><li>  resolusi layar 480x272 piksel dalam warna 24-bit; </li><li>  satu set perintah dengan gaya OpenGL; </li><li>  hingga 2000 sprite dalam berbagai ukuran; </li><li>  Memori video 256 KB; </li><li>  rotasi sprite halus dan penskalaan dengan penyaringan bilinear; </li><li>  lingkaran halus dan pola linier dalam perangkat keras - pemulusan 16x; </li><li>  Decoding perangkat keras JPEG; </li><li>  Render bawaan, gradien, teks, tombol dan tombol. </li></ul><br>  Suara dihasilkan melalui jack headphone yang diperkuat. <br>  Sistem mendukung pemilihan sampel dan alat bawaan. <br><br>  ROM pengontrol sudah terhubung: <br><br><ul><li>  font berkualitas tinggi (6 ukuran); </li><li>  sampel 8 alat musik yang dimainkan oleh not MIDI; </li><li>  sampel 10 suara perkusi. </li></ul><br>  Dan, tentu saja, Anda dapat memuat font dan suara Anda sendiri ke dalam 256 Kbytes RAM. <br><br>  Menggunakan platform Arduino bukanlah prasyarat: papan Gameduino 2 dapat dihubungkan ke papan mikrokontroler atau mikrokontroler apa pun dengan antarmuka SPI. </div></div><br>  Pada 2017, versi ketiga dewan dirilis - Gameduino 3, yang terlihat hampir identik dengan Gameduino 2. Alih-alih FT800, pengontrol grafis FT810 baru digunakan, yang memiliki kompatibilitas perangkat lunak mundur dengan FT800 (mis. Semua kode untuk Gameduino2 berfungsi pada Gameduino3). tetapi pada saat yang sama memiliki kemampuan komputasi 4 kali lebih besar, seperti decoding JPEG perangkat keras yang lebih cepat, decoding video, hingga 1 MB RAM, dll. <br><br><div class="spoiler">  <b class="spoiler_title">Fitur Gameduino 3:</b> <div class="spoiler_text"><ul><li>  decoder video untuk video layar penuh 30 fps; </li><li>  RAM internal 1 megabyte; </li><li>  konektor untuk kartu microSD dan output audio; </li><li>  4.3 "480x272 panel LCD kontras tinggi dengan layar sentuh resistif; </li><li>  dukungan untuk peta yang dibuat menggunakan editor Tiled Map; </li><li>  Unduh gambar PNG dari microSD; </li><li>  decoding JPEG yang dipercepat; </li><li>  potret perangkat keras / pergantian lanskap; </li><li>  dukungan untuk Arduino, ESP8266 dan Teensy 3.2; </li><li>  alat online untuk menyiapkan grafik, audio, font dan video; </li></ul><br></div></div><br>  James Bowman telah menerbitkan perpustakaan untuk proyeknya dengan banyak contoh yang berfungsi langsung.  Perpustakaan saat ini yang berhasil saya temukan ada di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sini</a> .  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Panduan Pemrograman</a> (dalam bahasa Inggris), di mana semuanya dijelaskan secara rinci.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Banyak informasi berguna</a> tentang cara menginstal IDE, dll., Dll. <br><br><h3>  Pemrograman </h3><br>  Entah bagaimana, berkeliaran di sekitar <s>Bolshoi</s> Internet <s>Theatre</s> , saya menemukan proyek yang menarik untuk Arduino - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">permainan logis “Kolom”</a> , yang ditulis di bawah tampilan warna Cina yang biasa murah 128x160 piksel.  Saya ingin mengulang game ini, tetapi di papan saya, saya akan menyebutnya FT810 (dengan nama GPU), yang saat itu sudah ada di tangan saya.  Saya sudah berhasil mempelajari manual pemrograman dan contoh-contoh dari perpustakaan, jadi tangan saya hanya "gatal" karena keinginan untuk menulis sesuatu dari mereka sendiri.  Yang saya segera mulai. <br><br>  Hal pertama yang harus saya lakukan adalah menampilkan teks di layar. <br><br>  Berkat kehadiran font bawaan, output teks ke layar cukup mudah.  Berikut ini adalah sketsa demo dari perpustakaan (dengan komentar saya): <br><br><div class="spoiler">  <b class="spoiler_title">Buat sketsa helloworld.ino</b> <div class="spoiler_text"><pre><code class="hljs objectivec"><span class="hljs-meta"><span class="hljs-meta">#include </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;EEPROM.h&gt;</span></span></span><span class="hljs-meta"> #include </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;SPI.h&gt;</span></span></span><span class="hljs-meta"> #include </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;GD2.h&gt;</span></span></span><span class="hljs-meta"> void setup() { Serial.begin(1000000); //   ,    1000000  GD.begin(0); //  ,   . } void loop() { GD.ClearColorRGB(0x103000); //    . GD.Clear(); //   (   ) GD.cmd_text( //  ,  GD.w / 2, //     2 GD.h / 2, //     2 31, //   OPT_CENTER, // ,         . </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"Hello world"</span></span></span><span class="hljs-meta">); //   GD.swap(); //         (   ). }</span></span></code> </pre>  Akibatnya, kami sampai di sini teks yang indah: <br><img src="https://habrastorage.org/webt/em/jq/xi/emjqxiynb2wjckhowwkvltpta9c.png" alt="gambar"><br></div></div><br>  Selanjutnya, perlu menggambar bentuk geometris, misalnya: garis. <br>  Untuk menggambar garis, Anda harus menggunakan Begin (LINES) atau Begin (LINE_STRIP). <br>  LINES bergabung dengan setiap pasangan simpul, sedangkan LINE_STRIP menggabungkan semua simpul bersama. <br><br>  Saya akan memberikan sketsa demo berikut dari perpustakaan (dengan komentar saya): <br><br><div class="spoiler">  <b class="spoiler_title">Buat sketsa lines.ino</b> <div class="spoiler_text"><pre> <code class="hljs objectivec"><span class="hljs-meta"><span class="hljs-meta">#include </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;EEPROM.h&gt;</span></span></span><span class="hljs-meta"> #include </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;SPI.h&gt;</span></span></span><span class="hljs-meta"> #include </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;GD2.h&gt;</span></span></span><span class="hljs-meta"> void setup() { Serial.begin(1000000); //   ,    1000000 . GD.begin(); //  ,   . } static void zigzag(int x) { GD.Vertex2ii(x - 10, 10); //     GD.Vertex2ii(x + 10, 60); //     () GD.Vertex2ii(x - 10, 110); GD.Vertex2ii(x + 10, 160); GD.Vertex2ii(x - 10, 210); GD.Vertex2ii(x + 10, 260); //     () } void loop() { GD.Clear(); //   (    - 0000000) GD.Begin(LINES); //     zigzag(140); //   zigzag   -   GD.Begin(LINE_STRIP); //     zigzag(240); GD.LineWidth(16 * 10); //        1/16 , .. 1/16 * 16 * 10 = 10  GD.Begin(LINE_STRIP); zigzag(340); GD.swap(); //         (   ). }</span></span></code> </pre> <br>  Baris di layar: <br><br><img src="https://habrastorage.org/webt/zr/bp/_w/zrbp_ws6saudfdakxpv8tf2tvwc.png" alt="gambar"></div></div><br>  Dari menggambar garis, mari kita beralih ke menggambar persegi panjang. <br><br>  Untuk menggambar persegi panjang, gunakan Begin (RECTS) dan atur sudut kebalikan dari persegi panjang.  Urutan kedua sudut itu tidak masalah.  Rectangles digambar dengan sudut bulat, menggunakan lebar garis saat ini sebagai jari-jari sudut.  Sudut membulat melampaui batas persegi panjang, sehingga meningkatkan jari-jari sudut mengarah ke peningkatan jumlah piksel.  Contoh ini menggambar persegi panjang 420 × 20 tiga kali dengan jari-jari sudut meningkat. <br><br><div class="spoiler">  <b class="spoiler_title">Sketsa rectangles.ino</b> <div class="spoiler_text"><pre> <code class="hljs objectivec"><span class="hljs-meta"><span class="hljs-meta">#include </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;EEPROM.h&gt;</span></span></span><span class="hljs-meta"> #include </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;SPI.h&gt;</span></span></span><span class="hljs-meta"> #include </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;GD2.h&gt;</span></span></span><span class="hljs-meta"> void setup() { Serial.begin(1000000); //   ,    1000000 . GD.begin(); //  ,   . } void loop() { GD.Clear(); //   (    - 0000000) GD.Begin(RECTS); //     GD.Vertex2ii(30, 30); //       GD.Vertex2ii(450, 50); //       GD.LineWidth(16 * 10); //         1/16 , .. 1/16 * 16 * 10 = 10  GD.Vertex2ii(30, 120); //       GD.Vertex2ii(450, 140); //       GD.LineWidth(16 * 20); //         1/16 , .. 1/16 * 16 * 20 = 20  GD.Vertex2ii(30, 220); //       GD.Vertex2ii(450, 230); //       GD.swap(); //         (   ) }</span></span></code> </pre> <br>  Hasil: <br><img src="https://habrastorage.org/webt/vg/qi/mc/vgqimcuhwc-jsiwqizewxsxlgf8.png" alt="gambar"><br></div></div><br>  Mari kita lanjutkan menggambar lingkaran - dasar tombol sentuh di masa depan.  Mari kita kembali ke contoh pertama dengan teks dan menambahkan beberapa baris ke loop (). <br><br><div class="spoiler">  <b class="spoiler_title">Buat sketsa dengan menggambar lingkaran berwarna</b> <div class="spoiler_text"><pre> <code class="hljs objectivec"><span class="hljs-meta"><span class="hljs-meta">#include </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;EEPROM.h&gt;</span></span></span><span class="hljs-meta"> #include </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;SPI.h&gt;</span></span></span><span class="hljs-meta"> #include </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;GD2.h&gt;</span></span></span><span class="hljs-meta"> void setup() { Serial.begin(1000000); //   ,    1000000  GD.begin(0); //  ,   . } void loop() { GD.ClearColorRGB(0x103000); //    . GD.Clear(); //   (   ) GD.cmd_text( //  ,  GD.w / 2, //     2 GD.h / 2, //     2 31, //   OPT_CENTER, // ,          </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"Hello world"</span></span></span><span class="hljs-meta">); //   GD.PointSize(16 * 30); //    ()    1/16 , .. 1/16 * 16 * 30 = 30  GD.Begin(POINTS); //     () GD.ColorRGB(0xff8000); //   orange GD.Vertex2ii(220, 100); //   ()   220,100 GD.ColorRGB(0x0080ff); //   teal GD.Vertex2ii(260, 170); //   ()   260,170 GD.swap(); //         (   ) }</span></span></code> </pre> <br>  Hasil: <br><br><img src="https://habrastorage.org/webt/gw/rz/ja/gwrzjak3bp7sqsywwd89rwj0-5w.png"><br></div></div><br>  Untuk bekerja dengan tombol sentuh, perlu mengatur pengolahan klik pada layar sentuh.  Ini dilakukan sebagai berikut.  Saya akan menjelaskan secara singkat prinsipnya.  Setiap piksel (titik) pada layar memiliki warna.  Ini juga memiliki nilai tag yang tidak terlihat, yang dapat ditetapkan ke titik (atau seluruh objek seperti garis, lingkaran, persegi panjang, dll.) Dan selanjutnya digunakan untuk mendeteksi sentuhan objek ini.  Sketsa berikut menunjukkan contoh pengaturan nilai tag untuk lingkaran berwarna ke 100 dan 101. <br><br><div class="spoiler">  <b class="spoiler_title">Sketsa Layar Sentuh</b> <div class="spoiler_text"><pre> <code class="hljs objectivec"><span class="hljs-meta"><span class="hljs-meta">#include </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;EEPROM.h&gt;</span></span></span><span class="hljs-meta"> #include </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;SPI.h&gt;</span></span></span><span class="hljs-meta"> #include </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;GD2.h&gt;</span></span></span><span class="hljs-meta"> void setup() { Serial.begin(1000000); //   ,    1000000  GD.begin(0); //  ,   . } void loop() { GD.ClearColorRGB(0x103000); //    . GD.Clear(); //   (   ) GD.cmd_text( //  ,  GD.w / 2, //     2 GD.h / 2, //     2 31, //   OPT_CENTER, // ,          </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"Hello world"</span></span></span><span class="hljs-meta">); //   GD.PointSize(16 * 30); //    ()    1/16 , .. 1/16 * 16 * 30 = 30  GD.Begin(POINTS); //     () GD.ColorRGB(0xff8000); //   orange GD.Tag(100); //       () GD.Vertex2ii(220, 100); //   ()   220,100 GD.ColorRGB(0x0080ff); //   teal GD.Tag(101); //       () GD.Vertex2ii(260, 170); //   ()   260,170 GD.swap(); //         (   ) GD.get_inputs(); //     if(GD.inputs.tag &gt; 0) //      Serial.println(GD.inputs.tag); //       “”  }</span></span></code> </pre> <br>  Sekarang, ketika sistem mendeteksi menyentuh lingkaran apa pun, ia melaporkan kode sensornya, dalam hal ini 100 atau 101. Ketika Anda mengklik objek (lingkaran berwarna) pada layar di jendela port serial, nilai tag yang sesuai dengan objek yang ditekan akan ditampilkan: <br><br><img src="https://habrastorage.org/webt/lh/q3/u_/lhq3u_jn8obrrcjy_kwke8m6gdw.png"><br></div></div><br>  Saya memberikan contoh operasi dasar, menggunakan yang sudah memungkinkan untuk melanjutkan pembuatan game dengan aman.  Tentu saja, game itu tidak dibuat dari awal, tetapi kode kerja yang sudah jadi diambil sebagai dasar, yang diadaptasi (sambil mempertahankan grafik), sehingga versi asli dari game itu sangat mirip dengan aslinya. <br><br>  Versi pertama dari game: <br><br><img src="https://habrastorage.org/webt/3f/no/xg/3fnoxgf8auqkkotrp1lgtjqk6kq.jpeg"><br><br>  Setelah bermain selama beberapa hari, saya ingin mengubah sesuatu dalam desain, misalnya, untuk menambahkan beberapa yang lain, tidak biasa, bukan latar belakang putih.  Dan kemudian saya ingat satu contoh dari perpustakaan, di mana langit berbintang melintas di latar belakang: <br><br><div class="spoiler">  <b class="spoiler_title">Sketsa Slot slotgag.ino</b> <div class="spoiler_text"><pre> <code class="hljs objectivec"><span class="hljs-meta"><span class="hljs-meta">#include </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;EEPROM.h&gt;</span></span></span><span class="hljs-meta"> #include </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;SPI.h&gt;</span></span></span><span class="hljs-meta"> #include </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;GD2.h&gt;</span></span></span><span class="hljs-meta"> #include </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"slotgag_assets.h"</span></span></span><span class="hljs-meta"> //      void setup() { Serial.begin(1000000); GD.begin(); LOAD_ASSETS(); //     } void loop() { GD.Clear(); //   ( ,     ) GD.ColorMask(1, 1, 1, 0); //        R, G, B,   GD.Begin(BITMAPS); //      GD.BitmapHandle(BACKGROUND_HANDLE); //   - GD.BitmapSize(NEAREST, REPEAT, REPEAT, 480, 272); //        GD.Vertex2ii(0, 0, BACKGROUND_HANDLE); //      0,0 GD.ColorMask(1, 1, 1, 1); GD.ColorRGB(0xa0a0a0); GD.Vertex2ii(240 - GAMEDUINO_WIDTH / 2, 136 - GAMEDUINO_HEIGHT / 2, GAMEDUINO_HANDLE); static int x = 0; GD.LineWidth(20 * 16); GD.BlendFunc(DST_ALPHA, ONE); GD.Begin(LINES); GD.Vertex2ii(x, 0); GD.Vertex2ii(x + 100, 272); x = (x + 20) % 480; //' }a GD.swap(); }</span></span></code> </pre> <br>  Lihat: <br><br><img src="https://habrastorage.org/webt/x-/es/y4/x-esy4aropwlyqh0bvl75jf1qpg.png"><br><br>  Agar tidak menyelidiki hutan, saya tidak mengomentari seluruh kode, tetapi hanya berkomentar pada baris kode yang diperlukan yang saya salin ke dalam sketsa kerja saya. </div></div><br>  Untuk menambahkan gambar langit berbintang sebagai latar belakang, saya harus melakukan hal berikut: pertama, ubah warna hitam garis dan teks menjadi putih (sehingga terlihat pada latar belakang hitam), tulis file slotgag.gd2 ke kartu micro SD, yang menyimpan gambar, tambahkan slotgag_assets.h ke folder proyek dan tambahkan 8 baris kode yang diperlukan ke sketsa. <br><br>  Akibatnya, game memperoleh formulir ini: <br><br><img src="https://habrastorage.org/webt/2t/hh/qo/2thhqo_apc-nidsqbcuudt98bwe.jpeg"><br><br>  Dan tentu saja, game seperti apa tanpa desain suara?  Tetap menambahkan efek suara, terutama karena mereka disajikan dalam kualitas dan variasi yang baik. <br><br>  Gameduino 2/3 memiliki dua sistem suara.  Yang pertama - synthesizer - dapat menghasilkan satu set suara tetap dan not musik.  Sebuah synthesizer berguna untuk menambahkan suara dengan cepat ke suatu proyek, tetapi karena rangkaian suara sudah diperbaiki, itu tidak terlalu fleksibel.  Yang kedua adalah reproduksi sampel.  Ini mereproduksi suara sampel dari memori utama dalam berbagai format.  Sistem ini jauh lebih fleksibel, tetapi Anda harus menyiapkan dan memuat sampel ke dalam RAM. <br><br>  Saya menggunakan synthesizer suara tetap.  The synthesizer menyediakan beberapa suara "perkusi" pendek, terutama untuk digunakan dalam antarmuka pengguna.  Untuk memainkan suara, Anda harus memanggil GD.play () dengan pengidentifikasi suara.  Daftar lengkap suara yang tersedia: <br><br>  Klik <br>  BERALIH <br>  Cowbell <br>  NOTCH <br>  Hihat <br>  Kickdrum <br>  Pop <br>  Clack <br>  CHACK <br><br><h3>  Ringkasan </h3><br>  Hasilnya berupa sketsa: <br><br><div class="spoiler">  <b class="spoiler_title">Sketsa Columns.ino</b> <div class="spoiler_text"><pre> <code class="hljs lua">#include &lt;SPI.h&gt; #include &lt;GD2.h&gt; #include &lt;avr/eeprom.h&gt; #include <span class="hljs-string"><span class="hljs-string">"slotgag_assets.h"</span></span> #define TAG_BUTTON_LEFT <span class="hljs-number"><span class="hljs-number">201</span></span> #define TAG_BUTTON_RIGHT <span class="hljs-number"><span class="hljs-number">202</span></span> #define TAG_BUTTON_ROT <span class="hljs-number"><span class="hljs-number">203</span></span> #define TAG_BUTTON_DROP <span class="hljs-number"><span class="hljs-number">204</span></span> #define X_BUTTON_LEFT <span class="hljs-number"><span class="hljs-number">50</span></span> #define Y_BUTTON_LEFT <span class="hljs-number"><span class="hljs-number">222</span></span> #define X_BUTTON_RIGHT <span class="hljs-number"><span class="hljs-number">430</span></span> #define Y_BUTTON_RIGHT <span class="hljs-number"><span class="hljs-number">222</span></span> #define X_BUTTON_ROT <span class="hljs-number"><span class="hljs-number">430</span></span> #define Y_BUTTON_ROT <span class="hljs-number"><span class="hljs-number">50</span></span> #define X_BUTTON_DROP <span class="hljs-number"><span class="hljs-number">50</span></span> #define Y_BUTTON_DROP <span class="hljs-number"><span class="hljs-number">50</span></span> // Color definitions #define BLACK <span class="hljs-number"><span class="hljs-number">0x000000</span></span> #define RED <span class="hljs-number"><span class="hljs-number">0xFF0000</span></span> #define GREEN <span class="hljs-number"><span class="hljs-number">0x00FF00</span></span> #define BLUE <span class="hljs-number"><span class="hljs-number">0x0000FF</span></span> #define YELLOW <span class="hljs-number"><span class="hljs-number">0xFFFF00</span></span> #define MAGENTA <span class="hljs-number"><span class="hljs-number">0xFF00FF</span></span> #define CYAN <span class="hljs-number"><span class="hljs-number">0x00FFFF</span></span> #define WHITE <span class="hljs-number"><span class="hljs-number">0xFFFFFF</span></span> #define DISPLAY_MAX_X <span class="hljs-number"><span class="hljs-number">480</span></span> #define DISPLAY_MAX_Y <span class="hljs-number"><span class="hljs-number">272</span></span> #define MaxX <span class="hljs-number"><span class="hljs-number">8</span></span> #define MaxY <span class="hljs-number"><span class="hljs-number">17</span></span> #define SmeX <span class="hljs-number"><span class="hljs-number">3</span></span> #define SmeY <span class="hljs-number"><span class="hljs-number">3</span></span> #define razmer <span class="hljs-number"><span class="hljs-number">18</span></span> #define NumCol <span class="hljs-number"><span class="hljs-number">6</span></span> #define MaxLevel <span class="hljs-number"><span class="hljs-number">8</span></span> #define NextLevel <span class="hljs-number"><span class="hljs-number">80</span></span> #define DISP_LEFT ((DISPLAY_MAX_X - MaxX*razmer)/<span class="hljs-number"><span class="hljs-number">2</span></span> - <span class="hljs-number"><span class="hljs-number">2</span></span>) #define DISP_RIGHT ((DISPLAY_MAX_X + MaxX*razmer)/<span class="hljs-number"><span class="hljs-number">2</span></span> + <span class="hljs-number"><span class="hljs-number">2</span></span>) #define DISP_TOP ((DISPLAY_MAX_Y - (MaxY<span class="hljs-number"><span class="hljs-number">-4</span></span>)*razmer)/<span class="hljs-number"><span class="hljs-number">2</span></span> - <span class="hljs-number"><span class="hljs-number">2</span></span>) #define DISP_BOT ((DISPLAY_MAX_Y + (MaxY<span class="hljs-number"><span class="hljs-number">-4</span></span>)*razmer)/<span class="hljs-number"><span class="hljs-number">2</span></span> + <span class="hljs-number"><span class="hljs-number">2</span></span>) uint8_t MasSt[MaxX][MaxY], MasTmp[MaxX][MaxY], fignext[<span class="hljs-number"><span class="hljs-number">3</span></span>]; uint8_t Level=<span class="hljs-number"><span class="hljs-number">1</span></span>, dx, dy, tr, flfirst=<span class="hljs-number"><span class="hljs-number">1</span></span>; uint32_t MasCol[]={WHITE, BLACK, RED, BLUE, GREEN, YELLOW, MAGENTA, CYAN}; unsigned long Counter, Score=<span class="hljs-number"><span class="hljs-number">0</span></span>, TScore=<span class="hljs-number"><span class="hljs-number">0</span></span>, Record=<span class="hljs-number"><span class="hljs-number">0</span></span>, myrecord; uint16_t tempspeed = <span class="hljs-number"><span class="hljs-number">1000</span></span>; bool fl, Demo=<span class="hljs-literal"><span class="hljs-literal">true</span></span>, Arbeiten=<span class="hljs-literal"><span class="hljs-literal">false</span></span>, FlZ=<span class="hljs-literal"><span class="hljs-literal">false</span></span>; int8_t x,y; int8_t mmm [<span class="hljs-number"><span class="hljs-number">4</span></span>][<span class="hljs-number"><span class="hljs-number">2</span></span>]={{<span class="hljs-number"><span class="hljs-number">-1</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>},{<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">-1</span></span>},{<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>},{<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>}}; uint16_t MasSpeed[MaxLevel]={<span class="hljs-number"><span class="hljs-number">500</span></span>,<span class="hljs-number"><span class="hljs-number">450</span></span>,<span class="hljs-number"><span class="hljs-number">400</span></span>,<span class="hljs-number"><span class="hljs-number">350</span></span>,<span class="hljs-number"><span class="hljs-number">300</span></span>,<span class="hljs-number"><span class="hljs-number">250</span></span>,<span class="hljs-number"><span class="hljs-number">200</span></span>,<span class="hljs-number"><span class="hljs-number">100</span></span>}; uint8_t state_game = <span class="hljs-number"><span class="hljs-number">0</span></span>; unsigned long time_count; <span class="hljs-built_in"><span class="hljs-built_in">byte</span></span> prevkey; uint32_t btn_color = <span class="hljs-number"><span class="hljs-number">0xff0000</span></span>; /****************************************************************************************************************/ void setup(void) { Serial.begin(<span class="hljs-number"><span class="hljs-number">1000000</span></span>); Serial.println(<span class="hljs-string"><span class="hljs-string">"Columns"</span></span>); GD.begin(); LOAD_ASSETS(); GD.BitmapHandle(BACKGROUND_HANDLE); GD.BitmapSize(NEAREST, REPEAT, REPEAT, <span class="hljs-number"><span class="hljs-number">480</span></span>, <span class="hljs-number"><span class="hljs-number">272</span></span>); randomSeed(analogRead(<span class="hljs-number"><span class="hljs-number">5</span></span>)); myrecord = eeprom_read_byte((unsigned <span class="hljs-built_in"><span class="hljs-built_in">char</span></span> *)<span class="hljs-number"><span class="hljs-number">1</span></span>); time_count = millis() + <span class="hljs-number"><span class="hljs-number">1000</span></span>; } static struct { <span class="hljs-built_in"><span class="hljs-built_in">byte</span></span> t, note; } pacman[] = { { <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">71</span></span> }, { <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">83</span></span> }, { <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">78</span></span> }, { <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">75</span></span> }, { <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">83</span></span> }, { <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">78</span></span> }, { <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">75</span></span> }, { <span class="hljs-number"><span class="hljs-number">16</span></span>, <span class="hljs-number"><span class="hljs-number">72</span></span> }, { <span class="hljs-number"><span class="hljs-number">18</span></span>, <span class="hljs-number"><span class="hljs-number">84</span></span> }, { <span class="hljs-number"><span class="hljs-number">20</span></span>, <span class="hljs-number"><span class="hljs-number">79</span></span> }, { <span class="hljs-number"><span class="hljs-number">22</span></span>, <span class="hljs-number"><span class="hljs-number">76</span></span> }, { <span class="hljs-number"><span class="hljs-number">24</span></span>, <span class="hljs-number"><span class="hljs-number">84</span></span> }, { <span class="hljs-number"><span class="hljs-number">25</span></span>, <span class="hljs-number"><span class="hljs-number">79</span></span> }, { <span class="hljs-number"><span class="hljs-number">28</span></span>, <span class="hljs-number"><span class="hljs-number">76</span></span> }, { <span class="hljs-number"><span class="hljs-number">32</span></span>, <span class="hljs-number"><span class="hljs-number">71</span></span> }, { <span class="hljs-number"><span class="hljs-number">34</span></span>, <span class="hljs-number"><span class="hljs-number">83</span></span> }, { <span class="hljs-number"><span class="hljs-number">36</span></span>, <span class="hljs-number"><span class="hljs-number">78</span></span> }, { <span class="hljs-number"><span class="hljs-number">38</span></span>, <span class="hljs-number"><span class="hljs-number">75</span></span> }, { <span class="hljs-number"><span class="hljs-number">40</span></span>, <span class="hljs-number"><span class="hljs-number">83</span></span> }, { <span class="hljs-number"><span class="hljs-number">41</span></span>, <span class="hljs-number"><span class="hljs-number">78</span></span> }, { <span class="hljs-number"><span class="hljs-number">44</span></span>, <span class="hljs-number"><span class="hljs-number">75</span></span> }, { <span class="hljs-number"><span class="hljs-number">48</span></span>, <span class="hljs-number"><span class="hljs-number">75</span></span> }, { <span class="hljs-number"><span class="hljs-number">49</span></span>, <span class="hljs-number"><span class="hljs-number">76</span></span> }, { <span class="hljs-number"><span class="hljs-number">50</span></span>, <span class="hljs-number"><span class="hljs-number">77</span></span> }, { <span class="hljs-number"><span class="hljs-number">52</span></span>, <span class="hljs-number"><span class="hljs-number">77</span></span> }, { <span class="hljs-number"><span class="hljs-number">53</span></span>, <span class="hljs-number"><span class="hljs-number">78</span></span> }, { <span class="hljs-number"><span class="hljs-number">54</span></span>, <span class="hljs-number"><span class="hljs-number">79</span></span> }, { <span class="hljs-number"><span class="hljs-number">56</span></span>, <span class="hljs-number"><span class="hljs-number">79</span></span> }, { <span class="hljs-number"><span class="hljs-number">57</span></span>, <span class="hljs-number"><span class="hljs-number">80</span></span> }, { <span class="hljs-number"><span class="hljs-number">58</span></span>, <span class="hljs-number"><span class="hljs-number">81</span></span> }, { <span class="hljs-number"><span class="hljs-number">60</span></span>, <span class="hljs-number"><span class="hljs-number">83</span></span> }, { <span class="hljs-number"><span class="hljs-number">255</span></span>, <span class="hljs-number"><span class="hljs-number">255</span></span> } }; //================================================== void loop(void) { GD.get_inputs(); <span class="hljs-built_in"><span class="hljs-built_in">byte</span></span> key = GD.inputs.tag; int8_t VAL = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (prevkey == <span class="hljs-number"><span class="hljs-number">0x00</span></span>) { switch (key) { case TAG_BUTTON_LEFT: VAL = <span class="hljs-number"><span class="hljs-number">-1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; case TAG_BUTTON_RIGHT: VAL = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; case TAG_BUTTON_ROT: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!FlZ) { GD.play(HIHAT); <span class="hljs-built_in"><span class="hljs-built_in">byte</span></span> aa=MasSt[x][y]; MasSt[x][y]=MasSt[x][y+<span class="hljs-number"><span class="hljs-number">2</span></span>]; MasSt[x][y+<span class="hljs-number"><span class="hljs-number">2</span></span>]=MasSt[x][y+<span class="hljs-number"><span class="hljs-number">1</span></span>]; MasSt[x][y+<span class="hljs-number"><span class="hljs-number">1</span></span>]=aa; } <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; case TAG_BUTTON_DROP: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Arbeiten) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!FlZ) { tempspeed=<span class="hljs-number"><span class="hljs-number">50</span></span>; GD.play(NOTCH); } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { GD.play(CLICK); Demo=<span class="hljs-literal"><span class="hljs-literal">false</span></span>; NewGame(); } <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } } prevkey = key; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (VAL!=<span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; fig_shift(VAL) &amp;&amp; !FlZ) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">byte</span></span> i=<span class="hljs-number"><span class="hljs-number">0</span></span>;i&lt;<span class="hljs-number"><span class="hljs-number">3</span></span>;i++) { MasSt[x+VAL][y+i]=MasSt[x][y+i]; MasSt[x][y+i]=<span class="hljs-number"><span class="hljs-number">0</span></span>; } x=x+VAL; } ProcGame(); ViewStacan(); GD.swap(); } //================================================== // redraw one square void ViewQuad(<span class="hljs-built_in"><span class="hljs-built_in">byte</span></span> i,<span class="hljs-built_in"><span class="hljs-built_in">byte</span></span> j,<span class="hljs-built_in"><span class="hljs-built_in">byte</span></span> mycolor) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (j&lt;<span class="hljs-number"><span class="hljs-number">3</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; uint16_t wy=DISP_TOP + SmeY+(j<span class="hljs-number"><span class="hljs-number">-3</span></span>)*razmer-j; uint16_t wx=DISP_LEFT + SmeX+i*razmer-i; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (mycolor!=<span class="hljs-number"><span class="hljs-number">0</span></span>) { GD.LineWidth(<span class="hljs-number"><span class="hljs-number">16</span></span>*<span class="hljs-number"><span class="hljs-number">1</span></span>); GD.ColorRGB(WHITE); GD.Begin(LINE_STRIP); GD.Vertex2ii(wx,wy); GD.Vertex2ii(wx + razmer<span class="hljs-number"><span class="hljs-number">-1</span></span>,wy); GD.Vertex2ii(wx + razmer<span class="hljs-number"><span class="hljs-number">-1</span></span>,wy + razmer<span class="hljs-number"><span class="hljs-number">-1</span></span>); GD.Vertex2ii(wx,wy + razmer<span class="hljs-number"><span class="hljs-number">-1</span></span>); GD.Vertex2ii(wx,wy); GD.Begin(RECTS); GD.ColorRGB(MasCol[mycolor]); GD.Vertex2ii(wx+<span class="hljs-number"><span class="hljs-number">1</span></span>, wy+<span class="hljs-number"><span class="hljs-number">1</span></span>); GD.Vertex2ii(wx+<span class="hljs-number"><span class="hljs-number">1</span></span> + razmer<span class="hljs-number"><span class="hljs-number">-2</span></span> - <span class="hljs-number"><span class="hljs-number">1</span></span>, wy+<span class="hljs-number"><span class="hljs-number">1</span></span> + razmer<span class="hljs-number"><span class="hljs-number">-2</span></span> - <span class="hljs-number"><span class="hljs-number">1</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { } } //================================================== void ViewStacan(void) { <span class="hljs-built_in"><span class="hljs-built_in">char</span></span> myStr2[<span class="hljs-number"><span class="hljs-number">5</span></span>]; // Draw background fone GD.Clear(); GD.ColorMask(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); GD.Begin(BITMAPS); GD.BitmapHandle(BACKGROUND_HANDLE); GD.BitmapSize(NEAREST, REPEAT, REPEAT, <span class="hljs-number"><span class="hljs-number">480</span></span>, <span class="hljs-number"><span class="hljs-number">272</span></span>); GD.Vertex2ii(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, BACKGROUND_HANDLE); // Print text GD.ColorRGB(WHITE); GD.cmd_text(DISP_LEFT - <span class="hljs-number"><span class="hljs-number">30</span></span>, DISP_TOP + <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">27</span></span>, OPT_CENTER, <span class="hljs-string"><span class="hljs-string">"LEVEL"</span></span>); GD.cmd_text(DISP_RIGHT + <span class="hljs-number"><span class="hljs-number">30</span></span>, DISP_TOP + <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">27</span></span>, OPT_CENTER, <span class="hljs-string"><span class="hljs-string">"NEXT"</span></span>); GD.cmd_text(DISP_RIGHT + <span class="hljs-number"><span class="hljs-number">30</span></span>, DISP_TOP + <span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-number"><span class="hljs-number">27</span></span>, OPT_CENTER, <span class="hljs-string"><span class="hljs-string">"SCORE"</span></span>); GD.cmd_text(DISP_LEFT - <span class="hljs-number"><span class="hljs-number">30</span></span>, DISP_TOP + <span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-number"><span class="hljs-number">27</span></span>, OPT_CENTER, <span class="hljs-string"><span class="hljs-string">"TOP"</span></span>); // Print digit Score GD.ColorRGB(RED); sprintf(myStr2,<span class="hljs-string"><span class="hljs-string">"%05d"</span></span>,Score ); GD.cmd_text(DISP_RIGHT + <span class="hljs-number"><span class="hljs-number">30</span></span>, DISP_TOP + <span class="hljs-number"><span class="hljs-number">130</span></span>, <span class="hljs-number"><span class="hljs-number">27</span></span>, OPT_CENTER, myStr2); // Print digit Top sprintf(myStr2,<span class="hljs-string"><span class="hljs-string">"%05d"</span></span>,myrecord ); GD.cmd_text(DISP_LEFT - <span class="hljs-number"><span class="hljs-number">30</span></span>, DISP_TOP + <span class="hljs-number"><span class="hljs-number">130</span></span>, <span class="hljs-number"><span class="hljs-number">27</span></span>, OPT_CENTER, myStr2); // Print digit Level sprintf(myStr2,<span class="hljs-string"><span class="hljs-string">"%02d"</span></span>,Level ); GD.cmd_text(DISP_LEFT - <span class="hljs-number"><span class="hljs-number">30</span></span>, DISP_TOP + <span class="hljs-number"><span class="hljs-number">40</span></span>, <span class="hljs-number"><span class="hljs-number">31</span></span>, OPT_CENTER, myStr2); // Draw color squares <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">byte</span></span> j=<span class="hljs-number"><span class="hljs-number">3</span></span>;j&lt;MaxY;j++) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">byte</span></span> i=<span class="hljs-number"><span class="hljs-number">0</span></span>;i&lt;MaxX;i++) ViewQuad(i,j,MasSt[i][j]); // Draw Next Figure <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">byte</span></span> i=<span class="hljs-number"><span class="hljs-number">0</span></span>;i&lt;<span class="hljs-number"><span class="hljs-number">3</span></span>;i++) { GD.ColorRGB(WHITE); GD.Begin(LINE_STRIP); GD.LineWidth(<span class="hljs-number"><span class="hljs-number">16</span></span>*<span class="hljs-number"><span class="hljs-number">1</span></span>); GD.Vertex2ii(DISP_RIGHT + <span class="hljs-number"><span class="hljs-number">15</span></span>, DISP_TOP + <span class="hljs-number"><span class="hljs-number">20</span></span> + razmer*ii); GD.Vertex2ii(DISP_RIGHT + <span class="hljs-number"><span class="hljs-number">15</span></span> + razmer<span class="hljs-number"><span class="hljs-number">-1</span></span>, DISP_TOP + <span class="hljs-number"><span class="hljs-number">20</span></span> + razmer*ii); GD.Vertex2ii(DISP_RIGHT + <span class="hljs-number"><span class="hljs-number">15</span></span> + razmer<span class="hljs-number"><span class="hljs-number">-1</span></span>, DISP_TOP + <span class="hljs-number"><span class="hljs-number">20</span></span> + razmer*ii + razmer<span class="hljs-number"><span class="hljs-number">-1</span></span>); GD.Vertex2ii(DISP_RIGHT + <span class="hljs-number"><span class="hljs-number">15</span></span>, DISP_TOP + <span class="hljs-number"><span class="hljs-number">20</span></span> + razmer*ii + razmer<span class="hljs-number"><span class="hljs-number">-1</span></span>); GD.Vertex2ii(DISP_RIGHT + <span class="hljs-number"><span class="hljs-number">15</span></span>, DISP_TOP + <span class="hljs-number"><span class="hljs-number">20</span></span> + razmer*ii); GD.Begin(RECTS); GD.ColorRGB(MasCol[fignext[i]]); GD.Vertex2ii(DISP_RIGHT+<span class="hljs-number"><span class="hljs-number">15</span></span>+<span class="hljs-number"><span class="hljs-number">1</span></span>, DISP_TOP+<span class="hljs-number"><span class="hljs-number">20</span></span>+razmer*i-i+<span class="hljs-number"><span class="hljs-number">1</span></span>); GD.Vertex2ii(DISP_RIGHT+<span class="hljs-number"><span class="hljs-number">15</span></span>+<span class="hljs-number"><span class="hljs-number">1</span></span>+razmer<span class="hljs-number"><span class="hljs-number">-2</span></span><span class="hljs-number"><span class="hljs-number">-1</span></span>, DISP_TOP+<span class="hljs-number"><span class="hljs-number">20</span></span>+razmer*i-i+<span class="hljs-number"><span class="hljs-number">1</span></span>+razmer<span class="hljs-number"><span class="hljs-number">-2</span></span><span class="hljs-number"><span class="hljs-number">-1</span></span>); } // Draw <span class="hljs-string"><span class="hljs-string">"stacan"</span></span> GD.ColorRGB(WHITE); GD.Begin(LINE_STRIP); GD.LineWidth(<span class="hljs-number"><span class="hljs-number">16</span></span>*<span class="hljs-number"><span class="hljs-number">1</span></span>); GD.Vertex2ii(DISP_LEFT + <span class="hljs-number"><span class="hljs-number">1</span></span>, DISP_TOP); GD.Vertex2ii(DISP_LEFT + <span class="hljs-number"><span class="hljs-number">1</span></span>, DISP_BOT); GD.Vertex2ii(DISP_LEFT + <span class="hljs-number"><span class="hljs-number">1</span></span> + razmer*MaxX+<span class="hljs-number"><span class="hljs-number">5</span></span>-MaxX - <span class="hljs-number"><span class="hljs-number">1</span></span>, DISP_BOT); GD.Vertex2ii(DISP_LEFT + <span class="hljs-number"><span class="hljs-number">1</span></span> + razmer*MaxX+<span class="hljs-number"><span class="hljs-number">5</span></span>-MaxX - <span class="hljs-number"><span class="hljs-number">1</span></span>, DISP_TOP); // Draw <span class="hljs-number"><span class="hljs-number">9</span></span> vertical <span class="hljs-built_in"><span class="hljs-built_in">lines</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">byte</span></span> i=<span class="hljs-number"><span class="hljs-number">0</span></span>; i&lt;<span class="hljs-number"><span class="hljs-number">9</span></span>; i++) { GD.ColorRGB(WHITE); GD.Begin(LINE_STRIP); GD.LineWidth(<span class="hljs-number"><span class="hljs-number">16</span></span>*<span class="hljs-number"><span class="hljs-number">1</span></span>); GD.Vertex2ii(DISP_LEFT + <span class="hljs-number"><span class="hljs-number">3</span></span> + razmer*ii, DISP_TOP); GD.Vertex2ii(DISP_LEFT + <span class="hljs-number"><span class="hljs-number">3</span></span> + razmer*ii, DISP_BOT - <span class="hljs-number"><span class="hljs-number">2</span></span>); } // Draw <span class="hljs-number"><span class="hljs-number">1</span></span> horizontal line GD.ColorRGB(WHITE); GD.Begin(LINE_STRIP); GD.Vertex2ii(DISP_LEFT + <span class="hljs-number"><span class="hljs-number">3</span></span>, DISP_BOT - <span class="hljs-number"><span class="hljs-number">2</span></span>); GD.Vertex2ii(DISP_LEFT + <span class="hljs-number"><span class="hljs-number">3</span></span> + razmer*MaxX-MaxX - <span class="hljs-number"><span class="hljs-number">1</span></span>, DISP_BOT - <span class="hljs-number"><span class="hljs-number">2</span></span>); // Draw <span class="hljs-string"><span class="hljs-string">"Game Over"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!Demo &amp;&amp; !Arbeiten) { GD.Begin(RECTS); GD.ColorRGB(WHITE); GD.Vertex2ii((DISP_LEFT + DISP_RIGHT)/<span class="hljs-number"><span class="hljs-number">2</span></span> - <span class="hljs-number"><span class="hljs-number">60</span></span>, (DISP_TOP + DISP_BOT)/<span class="hljs-number"><span class="hljs-number">2</span></span> - <span class="hljs-number"><span class="hljs-number">40</span></span>); GD.Vertex2ii((DISP_LEFT + DISP_RIGHT)/<span class="hljs-number"><span class="hljs-number">2</span></span> + <span class="hljs-number"><span class="hljs-number">60</span></span>, (DISP_TOP + DISP_BOT)/<span class="hljs-number"><span class="hljs-number">2</span></span> + <span class="hljs-number"><span class="hljs-number">40</span></span>); GD.ColorRGB(BLACK); GD.Vertex2ii((DISP_LEFT + DISP_RIGHT)/<span class="hljs-number"><span class="hljs-number">2</span></span> - <span class="hljs-number"><span class="hljs-number">58</span></span>, (DISP_TOP + DISP_BOT)/<span class="hljs-number"><span class="hljs-number">2</span></span> - <span class="hljs-number"><span class="hljs-number">38</span></span>); GD.Vertex2ii((DISP_LEFT + DISP_RIGHT)/<span class="hljs-number"><span class="hljs-number">2</span></span> + <span class="hljs-number"><span class="hljs-number">58</span></span>, (DISP_TOP + DISP_BOT)/<span class="hljs-number"><span class="hljs-number">2</span></span> + <span class="hljs-number"><span class="hljs-number">38</span></span>); GD.ColorRGB(RED); GD.cmd_text((DISP_LEFT + DISP_RIGHT)/<span class="hljs-number"><span class="hljs-number">2</span></span>, (DISP_TOP + DISP_BOT)/<span class="hljs-number"><span class="hljs-number">2</span></span> - <span class="hljs-number"><span class="hljs-number">20</span></span>, <span class="hljs-number"><span class="hljs-number">30</span></span>, OPT_CENTER, <span class="hljs-string"><span class="hljs-string">"GAME"</span></span>); GD.cmd_text((DISP_LEFT + DISP_RIGHT)/<span class="hljs-number"><span class="hljs-number">2</span></span>, (DISP_TOP + DISP_BOT)/<span class="hljs-number"><span class="hljs-number">2</span></span> + <span class="hljs-number"><span class="hljs-number">20</span></span>, <span class="hljs-number"><span class="hljs-number">30</span></span>, OPT_CENTER, <span class="hljs-string"><span class="hljs-string">"OVER"</span></span>); } // Draw Buttons GD.Begin(POINTS); GD.PointSize(<span class="hljs-number"><span class="hljs-number">16</span></span>*<span class="hljs-number"><span class="hljs-number">50</span></span>); // Set size of buttons (<span class="hljs-number"><span class="hljs-number">50</span></span> pix) GD.ColorRGB(btn_color); // Set fone color of buttons GD.Tag(TAG_BUTTON_LEFT); // Set TAG <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> BUTTON_LEFT GD.Vertex2ii( X_BUTTON_LEFT, Y_BUTTON_LEFT); // Place BUTTON1 GD.Tag(TAG_BUTTON_RIGHT); // Set TAG <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> BUTTON_RIGHT GD.Vertex2ii(X_BUTTON_RIGHT, Y_BUTTON_RIGHT); // Place BUTTON2 GD.Tag(TAG_BUTTON_ROT); // Set TAG <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> BUTTON_ROT GD.Vertex2ii( X_BUTTON_ROT, Y_BUTTON_ROT); // Place BUTTON3 GD.Tag(TAG_BUTTON_DROP); // Set TAG <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> BUTTON_DROP GD.Vertex2ii(X_BUTTON_DROP, Y_BUTTON_DROP); // Place BUTTON4 // Draw figures <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> buttons circles GD.Tag(<span class="hljs-number"><span class="hljs-number">255</span></span>); GD.ColorRGB(<span class="hljs-number"><span class="hljs-number">0xffff00</span></span>); GD.LineWidth(<span class="hljs-number"><span class="hljs-number">16</span></span>*<span class="hljs-number"><span class="hljs-number">2</span></span>); GD.Begin(LINE_STRIP); GD.Vertex2ii(X_BUTTON_LEFT + <span class="hljs-number"><span class="hljs-number">30</span></span>, Y_BUTTON_LEFT - <span class="hljs-number"><span class="hljs-number">20</span></span>); GD.Vertex2ii(X_BUTTON_LEFT, Y_BUTTON_LEFT - <span class="hljs-number"><span class="hljs-number">20</span></span>); GD.Vertex2ii(X_BUTTON_LEFT, Y_BUTTON_LEFT - <span class="hljs-number"><span class="hljs-number">40</span></span>); GD.Vertex2ii(X_BUTTON_LEFT - <span class="hljs-number"><span class="hljs-number">40</span></span>, Y_BUTTON_LEFT); GD.Vertex2ii(X_BUTTON_LEFT, Y_BUTTON_LEFT + <span class="hljs-number"><span class="hljs-number">40</span></span>); GD.Vertex2ii(X_BUTTON_LEFT, Y_BUTTON_LEFT + <span class="hljs-number"><span class="hljs-number">20</span></span>); GD.Vertex2ii(X_BUTTON_LEFT + <span class="hljs-number"><span class="hljs-number">30</span></span>, Y_BUTTON_LEFT + <span class="hljs-number"><span class="hljs-number">20</span></span>); GD.Vertex2ii(X_BUTTON_LEFT + <span class="hljs-number"><span class="hljs-number">30</span></span>, Y_BUTTON_LEFT - <span class="hljs-number"><span class="hljs-number">20</span></span>); GD.Begin(LINE_STRIP); GD.Vertex2ii(X_BUTTON_RIGHT - <span class="hljs-number"><span class="hljs-number">30</span></span>, Y_BUTTON_RIGHT - <span class="hljs-number"><span class="hljs-number">20</span></span>); GD.Vertex2ii(X_BUTTON_RIGHT, Y_BUTTON_RIGHT - <span class="hljs-number"><span class="hljs-number">20</span></span>); GD.Vertex2ii(X_BUTTON_RIGHT, Y_BUTTON_RIGHT - <span class="hljs-number"><span class="hljs-number">40</span></span>); GD.Vertex2ii(X_BUTTON_RIGHT + <span class="hljs-number"><span class="hljs-number">40</span></span>, Y_BUTTON_RIGHT); GD.Vertex2ii(X_BUTTON_RIGHT, Y_BUTTON_RIGHT + <span class="hljs-number"><span class="hljs-number">40</span></span>); GD.Vertex2ii(X_BUTTON_RIGHT, Y_BUTTON_RIGHT + <span class="hljs-number"><span class="hljs-number">20</span></span>); GD.Vertex2ii(X_BUTTON_RIGHT - <span class="hljs-number"><span class="hljs-number">30</span></span>, Y_BUTTON_RIGHT + <span class="hljs-number"><span class="hljs-number">20</span></span>); GD.Vertex2ii(X_BUTTON_RIGHT - <span class="hljs-number"><span class="hljs-number">30</span></span>, Y_BUTTON_RIGHT - <span class="hljs-number"><span class="hljs-number">20</span></span>); GD.Begin(LINE_STRIP); GD.Vertex2ii(X_BUTTON_ROT - <span class="hljs-number"><span class="hljs-number">40</span></span>, Y_BUTTON_ROT); GD.Vertex2ii(X_BUTTON_ROT, Y_BUTTON_ROT - <span class="hljs-number"><span class="hljs-number">40</span></span>); GD.Vertex2ii(X_BUTTON_ROT + <span class="hljs-number"><span class="hljs-number">40</span></span>, Y_BUTTON_ROT); GD.Vertex2ii(X_BUTTON_ROT, Y_BUTTON_ROT + <span class="hljs-number"><span class="hljs-number">40</span></span>); GD.Vertex2ii(X_BUTTON_ROT - <span class="hljs-number"><span class="hljs-number">40</span></span>, Y_BUTTON_ROT); GD.Begin(LINE_STRIP); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Arbeiten) { GD.Vertex2ii(X_BUTTON_DROP - <span class="hljs-number"><span class="hljs-number">40</span></span>, Y_BUTTON_DROP - <span class="hljs-number"><span class="hljs-number">10</span></span>); GD.Vertex2ii(X_BUTTON_DROP + <span class="hljs-number"><span class="hljs-number">40</span></span>, Y_BUTTON_DROP - <span class="hljs-number"><span class="hljs-number">10</span></span>); GD.Vertex2ii(X_BUTTON_DROP, Y_BUTTON_DROP + <span class="hljs-number"><span class="hljs-number">30</span></span>); GD.Vertex2ii(X_BUTTON_DROP - <span class="hljs-number"><span class="hljs-number">40</span></span>, Y_BUTTON_DROP - <span class="hljs-number"><span class="hljs-number">10</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { GD.Vertex2ii(X_BUTTON_DROP - <span class="hljs-number"><span class="hljs-number">10</span></span>, Y_BUTTON_DROP - <span class="hljs-number"><span class="hljs-number">40</span></span>); GD.Vertex2ii(X_BUTTON_DROP + <span class="hljs-number"><span class="hljs-number">30</span></span>, Y_BUTTON_DROP); GD.Vertex2ii(X_BUTTON_DROP - <span class="hljs-number"><span class="hljs-number">10</span></span>, Y_BUTTON_DROP + <span class="hljs-number"><span class="hljs-number">40</span></span>); GD.Vertex2ii(X_BUTTON_DROP - <span class="hljs-number"><span class="hljs-number">10</span></span>, Y_BUTTON_DROP - <span class="hljs-number"><span class="hljs-number">40</span></span>); } } //================================================== void ClearMas(<span class="hljs-built_in"><span class="hljs-built_in">byte</span></span> MasStx[MaxX][MaxY]) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">byte</span></span> j=<span class="hljs-number"><span class="hljs-number">0</span></span>;j&lt;MaxY;j++) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">byte</span></span> i=<span class="hljs-number"><span class="hljs-number">0</span></span>;i&lt;MaxX;i++) MasStx[i][j]=<span class="hljs-number"><span class="hljs-number">0</span></span>; } //================================================== void Sosed(int i,int j,int dx,int dy, <span class="hljs-built_in"><span class="hljs-built_in">byte</span></span> mode) { int nx=i+dx; int ny=j+dy; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (nx&gt;=<span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; ny&gt;=<span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; nx&lt;MaxX &amp;&amp; ny&lt;MaxY &amp;&amp; MasSt[nx][ny]==MasSt[i][j]) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (mode==<span class="hljs-number"><span class="hljs-number">1</span></span>) MasTmp[i][j]++; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (mode==<span class="hljs-number"><span class="hljs-number">2</span></span> &amp;&amp; (MasTmp[nx][ny]&gt;<span class="hljs-number"><span class="hljs-number">1</span></span> || MasTmp[i][j]&gt;<span class="hljs-number"><span class="hljs-number">2</span></span> )) { MasTmp[nx][ny]=<span class="hljs-number"><span class="hljs-number">3</span></span>; MasTmp[i][j]=<span class="hljs-number"><span class="hljs-number">3</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (mode==<span class="hljs-number"><span class="hljs-number">3</span></span> &amp;&amp; MasTmp[nx][ny]==<span class="hljs-number"><span class="hljs-number">3</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (MasTmp[i][j]!=<span class="hljs-number"><span class="hljs-number">3</span></span>) { MasTmp[i][j]=<span class="hljs-number"><span class="hljs-number">3</span></span>; fl=<span class="hljs-literal"><span class="hljs-literal">true</span></span>; } } } } } //================================================== void Sos(int i,int j, <span class="hljs-built_in"><span class="hljs-built_in">byte</span></span> mode) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">byte</span></span> k=<span class="hljs-number"><span class="hljs-number">0</span></span>;k&lt;<span class="hljs-number"><span class="hljs-number">4</span></span>;k++) Sosed(i,j,mmm[k][<span class="hljs-number"><span class="hljs-number">0</span></span>],mmm[k][<span class="hljs-number"><span class="hljs-number">1</span></span>],mode); } //================================================== // <span class="hljs-built_in"><span class="hljs-built_in">create</span></span> <span class="hljs-built_in"><span class="hljs-built_in">next</span></span> figure void GetNext(void) { x=<span class="hljs-number"><span class="hljs-number">3</span></span>; y=<span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">byte</span></span> i=<span class="hljs-number"><span class="hljs-number">0</span></span>;i&lt;<span class="hljs-number"><span class="hljs-number">3</span></span>;i++) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!Demo) MasSt[x][i]=fignext[i]; fignext[i]=<span class="hljs-built_in"><span class="hljs-built_in">random</span></span>(NumCol)+<span class="hljs-number"><span class="hljs-number">2</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!Demo) { Counter++; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Counter==NextLevel) { Counter=<span class="hljs-number"><span class="hljs-number">0</span></span>; Level++; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Level&gt;MaxLevel) Level=MaxLevel; } tempspeed=MasSpeed[Level<span class="hljs-number"><span class="hljs-number">-1</span></span>]; } } //================================================== // <span class="hljs-built_in"><span class="hljs-built_in">find</span></span> onecolor elements bool FindFull(void) { <span class="hljs-built_in"><span class="hljs-built_in">byte</span></span> i,j,k; bool res; res=<span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">byte</span></span> k=<span class="hljs-number"><span class="hljs-number">2</span></span>;k&lt;<span class="hljs-number"><span class="hljs-number">8</span></span>;k++) { // by every color ClearMas(MasTmp); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (j=<span class="hljs-number"><span class="hljs-number">3</span></span>;j&lt;MaxY;j++) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (i=<span class="hljs-number"><span class="hljs-number">0</span></span>;i&lt;MaxX;i++) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (MasSt[i][j]==k) Sos(i,j,<span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (j=<span class="hljs-number"><span class="hljs-number">3</span></span>;j&lt;MaxY;j++) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (i=<span class="hljs-number"><span class="hljs-number">0</span></span>;i&lt;MaxX;i++) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (MasTmp[i][j]&gt;<span class="hljs-number"><span class="hljs-number">1</span></span>) Sos(i,j,<span class="hljs-number"><span class="hljs-number">2</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> { fl=<span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (j=<span class="hljs-number"><span class="hljs-number">3</span></span>;j&lt;MaxY;j++) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (i=<span class="hljs-number"><span class="hljs-number">0</span></span>;i&lt;MaxX;i++) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (MasTmp[i][j]&gt;<span class="hljs-number"><span class="hljs-number">0</span></span>) Sos(i,j,<span class="hljs-number"><span class="hljs-number">3</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (fl); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (j=<span class="hljs-number"><span class="hljs-number">3</span></span>;j&lt;MaxY;j++) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (i=<span class="hljs-number"><span class="hljs-number">0</span></span>;i&lt;MaxX;i++) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (MasTmp[i][j]==<span class="hljs-number"><span class="hljs-number">3</span></span>) { MasSt[i][j]=<span class="hljs-number"><span class="hljs-number">1</span></span>; TScore++; } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>(res); } //================================================ // move figure down bool fig_drop(int dy) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (dy&gt;<span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; !FlZ) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (y+dy+<span class="hljs-number"><span class="hljs-number">2</span></span>&gt;MaxY<span class="hljs-number"><span class="hljs-number">-1</span></span> || MasSt[x+dx][y+dy+<span class="hljs-number"><span class="hljs-number">2</span></span>]&gt;<span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (y&lt;<span class="hljs-number"><span class="hljs-number">3</span></span>) { gameover(); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (y+dy+dy+<span class="hljs-number"><span class="hljs-number">2</span></span>&gt;MaxY<span class="hljs-number"><span class="hljs-number">-1</span></span> || MasSt[x+dx][y+dy+dy+<span class="hljs-number"><span class="hljs-number">2</span></span>]&gt;<span class="hljs-number"><span class="hljs-number">0</span></span>) { GD.play(COWBELL); } <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">byte</span></span> i=<span class="hljs-number"><span class="hljs-number">0</span></span>;i&lt;<span class="hljs-number"><span class="hljs-number">3</span></span>;i++) MasSt[x][y+<span class="hljs-number"><span class="hljs-number">2</span></span>-i+dy]=MasSt[x][y+<span class="hljs-number"><span class="hljs-number">2</span></span>-i]; MasSt[x][y]=<span class="hljs-number"><span class="hljs-number">0</span></span>; y=y+dy; } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>(<span class="hljs-literal"><span class="hljs-literal">false</span></span>); } //================================================ // move figure left/right (shift) bool fig_shift(int dx) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (x+dx&lt;<span class="hljs-number"><span class="hljs-number">0</span></span> || x+dx&gt;MaxX<span class="hljs-number"><span class="hljs-number">-1</span></span>) { GD.play(COWBELL); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>(<span class="hljs-literal"><span class="hljs-literal">false</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (dx!=<span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (MasSt[x+dx][y+dy+<span class="hljs-number"><span class="hljs-number">2</span></span>]==<span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (x+dx+dx&lt;<span class="hljs-number"><span class="hljs-number">0</span></span> || x+dx+dx&gt;MaxX<span class="hljs-number"><span class="hljs-number">-1</span></span>) GD.play(COWBELL); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> GD.play(CHACK); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>(<span class="hljs-literal"><span class="hljs-literal">true</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { GD.play(COWBELL); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>(<span class="hljs-literal"><span class="hljs-literal">false</span></span>); } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>(<span class="hljs-literal"><span class="hljs-literal">false</span></span>); } //================================================== // State-machine void ProcGame(void) { <span class="hljs-built_in"><span class="hljs-built_in">byte</span></span> i,j,k; bool res = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (time_count &lt; millis()) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Arbeiten) time_count = millis() + tempspeed; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> time_count = millis() + <span class="hljs-number"><span class="hljs-number">1000</span></span>; switch (state_game) { // Demo case <span class="hljs-number"><span class="hljs-number">0</span></span>: Score=<span class="hljs-number"><span class="hljs-number">0</span></span>; GetNext(); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">byte</span></span> j=<span class="hljs-number"><span class="hljs-number">3</span></span>;j&lt;MaxY;j++) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">byte</span></span> i=<span class="hljs-number"><span class="hljs-number">0</span></span>;i&lt;MaxX;i++) MasSt[i][j]=<span class="hljs-built_in"><span class="hljs-built_in">random</span></span>(<span class="hljs-number"><span class="hljs-number">6</span></span>)+<span class="hljs-number"><span class="hljs-number">2</span></span>; state_game = <span class="hljs-number"><span class="hljs-number">1</span></span>; TScore=<span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; case <span class="hljs-number"><span class="hljs-number">1</span></span>: FindFull(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (TScore&gt;<span class="hljs-number"><span class="hljs-number">0</span></span>) { FlZ=<span class="hljs-literal"><span class="hljs-literal">true</span></span>; time_count = millis() + <span class="hljs-number"><span class="hljs-number">500</span></span>; } state_game = <span class="hljs-number"><span class="hljs-number">2</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; case <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (j=<span class="hljs-number"><span class="hljs-number">0</span></span>;j&lt;MaxY;j++) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (i=<span class="hljs-number"><span class="hljs-number">0</span></span>;i&lt;MaxX;i++) { <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (MasSt[i][MaxY<span class="hljs-number"><span class="hljs-number">-1</span></span>-j]==<span class="hljs-number"><span class="hljs-number">1</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (k=<span class="hljs-number"><span class="hljs-number">0</span></span>;k&lt;MaxY<span class="hljs-number"><span class="hljs-number">-2</span></span>-j;k++) MasSt[i][MaxY<span class="hljs-number"><span class="hljs-number">-1</span></span>-kj] = MasSt[i][MaxY<span class="hljs-number"><span class="hljs-number">-2</span></span>-kj]; res=<span class="hljs-literal"><span class="hljs-literal">true</span></span>; } } } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(res) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (TScore&gt;<span class="hljs-number"><span class="hljs-number">7</span></span>) Score=Score+TScore+(TScore<span class="hljs-number"><span class="hljs-number">-8</span></span>)*<span class="hljs-number"><span class="hljs-number">2</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> Score=Score+TScore; state_game = <span class="hljs-number"><span class="hljs-number">1</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { state_game = <span class="hljs-number"><span class="hljs-number">0</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; // Arbeiten case <span class="hljs-number"><span class="hljs-number">3</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (fig_drop(<span class="hljs-number"><span class="hljs-number">1</span></span>)) { tempspeed=MasSpeed[Level<span class="hljs-number"><span class="hljs-number">-1</span></span>]; TScore=<span class="hljs-number"><span class="hljs-number">0</span></span>; FindFull(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (TScore&gt;<span class="hljs-number"><span class="hljs-number">0</span></span>) { GD.play(KICKDRUM); FlZ=<span class="hljs-literal"><span class="hljs-literal">true</span></span>; state_game = <span class="hljs-number"><span class="hljs-number">4</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { FlZ=<span class="hljs-literal"><span class="hljs-literal">false</span></span>; GetNext(); } } <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; case <span class="hljs-number"><span class="hljs-number">4</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (j=<span class="hljs-number"><span class="hljs-number">0</span></span>;j&lt;MaxY;j++) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (i=<span class="hljs-number"><span class="hljs-number">0</span></span>;i&lt;MaxX;i++) { <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (MasSt[i][MaxY<span class="hljs-number"><span class="hljs-number">-1</span></span>-j]==<span class="hljs-number"><span class="hljs-number">1</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (k=<span class="hljs-number"><span class="hljs-number">0</span></span>;k&lt;MaxY<span class="hljs-number"><span class="hljs-number">-2</span></span>-j;k++) MasSt[i][MaxY<span class="hljs-number"><span class="hljs-number">-1</span></span>-kj] = MasSt[i][MaxY<span class="hljs-number"><span class="hljs-number">-2</span></span>-kj]; res=<span class="hljs-literal"><span class="hljs-literal">true</span></span>; } } } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(res) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (TScore&gt;<span class="hljs-number"><span class="hljs-number">7</span></span>) Score=Score+TScore+(TScore<span class="hljs-number"><span class="hljs-number">-8</span></span>)*<span class="hljs-number"><span class="hljs-number">2</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> Score=Score+TScore; state_game = <span class="hljs-number"><span class="hljs-number">5</span></span>; FlZ=<span class="hljs-literal"><span class="hljs-literal">true</span></span>; GD.play(CLACK); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { state_game = <span class="hljs-number"><span class="hljs-number">3</span></span>; FlZ=<span class="hljs-literal"><span class="hljs-literal">false</span></span>; time_count = millis() + <span class="hljs-number"><span class="hljs-number">100</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; case <span class="hljs-number"><span class="hljs-number">5</span></span>: state_game = <span class="hljs-number"><span class="hljs-number">3</span></span>; FlZ=<span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; default: <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } } } //================================================ // start new game void NewGame() { Score = <span class="hljs-number"><span class="hljs-number">0</span></span>; FlZ = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; ClearMas(MasSt); Arbeiten = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; GetNext(); Counter = <span class="hljs-number"><span class="hljs-number">0</span></span>; Level = <span class="hljs-number"><span class="hljs-number">1</span></span>; tempspeed = MasSpeed[<span class="hljs-number"><span class="hljs-number">0</span></span>]; Record = myrecord; state_game = <span class="hljs-number"><span class="hljs-number">3</span></span>; } //================================================ // draw <span class="hljs-string"><span class="hljs-string">"GAME OVER"</span></span> void gameover() { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Arbeiten==<span class="hljs-literal"><span class="hljs-literal">true</span></span>) { GD.play(SWITCH); Arbeiten=<span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Score&gt;myrecord) { myrecord=Score; eeprom_write_byte((unsigned <span class="hljs-built_in"><span class="hljs-built_in">char</span></span> *) <span class="hljs-number"><span class="hljs-number">1</span></span>, myrecord); } } }</code> </pre> </div></div><div class="spoiler">  <b class="spoiler_title">slotgag_assets.h</b> <div class="spoiler_text"><pre> <code class="hljs cpp"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> LOAD_ASSETS() GD.safeload(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"slotgag.gd2"</span></span></span><span class="hljs-meta">); #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> BACKGROUND_HANDLE 0 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> BACKGROUND_WIDTH 256 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> BACKGROUND_HEIGHT 256 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> BACKGROUND_CELLS 1 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> GAMEDUINO_HANDLE 1 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> GAMEDUINO_WIDTH 395 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> GAMEDUINO_HEIGHT 113 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> GAMEDUINO_CELLS 1 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> ASSETS_END 220342UL static const shape_t BACKGROUND_SHAPE = {0, 256, 256, 0}; static const shape_t GAMEDUINO_SHAPE = {1, 395, 113, 0};</span></span></code> </pre></div></div><br>  Saya percaya bahwa saya menyelesaikan tugas membuat sketsa kerja pertama saya untuk forum ini.  Saya harap setidaknya satu orang tertarik untuk membaca cerita saya.  Kritik dan komentar dipersilahkan.  Rencana tidak berhenti, terus maju dan, tentu saja, berbagi pengalaman, pengetahuan. <br><br>  Untuk menunjukkan pengoperasian papan, saya memposting <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">video</a> dengan suara (Perhatian! Suara keras!). <br>  Terima kasih atas perhatian anda </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id423577/">https://habr.com/ru/post/id423577/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id423567/index.html">Sekali lagi tentang kecerdasan buatan</a></li>
<li><a href="../id423569/index.html">Kami mendefinisikan bahasa pesan dengan sederhana dan akurat</a></li>
<li><a href="../id423571/index.html">Segala macam hal di MetaPost</a></li>
<li><a href="../id423573/index.html">Sinkronisitas adalah mitos</a></li>
<li><a href="../id423575/index.html">Standar desain dalam mikroelektronika: di mana sebenarnya ada 7 nanometer dalam teknologi 7 nm?</a></li>
<li><a href="../id423579/index.html">Layanan Cloud untuk WebGL? Tidak terima kasih</a></li>
<li><a href="../id423583/index.html">Mendapatkan kecelakaan melalui NotificationIRP di OSS</a></li>
<li><a href="../id423585/index.html">Langsung: CI / CD di iOS dan Android</a></li>
<li><a href="../id423587/index.html">Membangun InnoDB cluster dari mysql 5.7 pada centos 7</a></li>
<li><a href="../id423589/index.html">Bagaimana kami memilih TTS, misalnya, suara dalam Kamus</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>