<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>😾 🧑🏿‍🤝‍🧑🏻 🔍 Pembuat kode untuk Laravel - untuk input OAS, untuk output JSON-API 👩🏼‍🎤 ⚾️ 👨🏿‍🚀</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Kemampuan untuk membuat generator kode untuk API guna menyelamatkan generasi mendatang dari kebutuhan untuk terus-menerus membuat pengontrol, model, r...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Pembuat kode untuk Laravel - untuk input OAS, untuk output JSON-API</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/427741/">  Kemampuan untuk membuat generator kode untuk API guna menyelamatkan generasi mendatang dari kebutuhan untuk terus-menerus membuat pengontrol, model, router, middleware, migrasi, kerangka yang sama, filter, validasi, dll. Yang sama.  secara manual (bahkan dalam konteks kerangka kerja yang akrab dan nyaman), sepertinya menarik bagi saya. <br><br>  Saya mempelajari tipifikasi dan seluk-beluk spesifikasi OpenAPI, saya menyukainya karena linearitas dan kemampuannya untuk menggambarkan struktur dan jenis entitas apa pun pada kedalaman 1-3 tingkat.  Karena pada waktu itu saya sudah terbiasa dengan Laravel (Yii2 digunakan untuk menggunakannya, CI tetapi mereka kurang populer), serta dengan format output data json-api - seluruh arsitektur turun di kepala saya dengan grafik yang terhubung. <br><br><img src="https://habrastorage.org/webt/av/8r/tv/av8rtvzwmlh6aiuh2oir4qmmgdm.png"><br><br>  Mari kita beralih ke contoh. <br><a name="habracut"></a><br>  Misalkan kita memiliki entitas berikut yang dijelaskan dalam OAS: <br><br><pre><code class="plaintext hljs">ArticleAttributes: description: Article attributes description type: object properties: title: required: true type: string minLength: 16 maxLength: 256 facets: index: idx_title: index description: required: true type: string minLength: 32 maxLength: 1024 facets: spell_check: true spell_language: en url: required: false type: string minLength: 16 maxLength: 255 facets: index: idx_url: unique show_in_top: description: Show at the top of main page required: false type: boolean status: description: The state of an article enum: ["draft", "published", "postponed", "archived"] facets: state_machine: initial: ['draft'] draft: ['published'] published: ['archived', 'postponed'] postponed: ['published', 'archived'] archived: [] topic_id: description: ManyToOne Topic relationship required: true type: integer minimum: 1 maximum: 6 facets: index: idx_fk_topic_id: foreign references: id on: topic onDelete: cascade onUpdate: cascade rate: type: number minimum: 3 maximum: 9 format: double date_posted: type: date-only time_to_live: type: time-only deleted_at: type: datetime</code> </pre> <br>  Jika kita menjalankan perintah <br><br><pre> <code class="bash hljs">php artisan api:generate oas/openapi.yaml --migrations</code> </pre><br>  maka kita mendapatkan objek yang dihasilkan berikut: <br><br>  1) Pengendali Entitas <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">Modules</span></span>\<span class="hljs-title"><span class="hljs-title">V1</span></span>\<span class="hljs-title"><span class="hljs-title">Http</span></span>\<span class="hljs-title"><span class="hljs-title">Controllers</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ArticleController</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DefaultController</span></span></span><span class="hljs-class"> </span></span>{ }</code> </pre><br>  Dia sudah tahu GET / POST / PATCH / DELETE, yang dia akan pergi ke tabel melalui model, migrasi yang juga akan dihasilkan.  DefaultController selalu tersedia untuk pengembang sehingga dimungkinkan untuk mengimplementasikan fungsionalitas untuk semua pengontrol. <br><br>  2) Model entitas artikel <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">Modules</span></span>\<span class="hljs-title"><span class="hljs-title">V2</span></span>\<span class="hljs-title"><span class="hljs-title">Entities</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Illuminate</span></span>\<span class="hljs-title"><span class="hljs-title">Database</span></span>\<span class="hljs-title"><span class="hljs-title">Eloquent</span></span>\<span class="hljs-title"><span class="hljs-title">SoftDeletes</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">rjapi</span></span>\<span class="hljs-title"><span class="hljs-title">extension</span></span>\<span class="hljs-title"><span class="hljs-title">BaseModel</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Article</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BaseModel</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">SoftDeletes</span></span>; <span class="hljs-comment"><span class="hljs-comment">// &gt;&gt;&gt;props&gt;&gt;&gt; protected $dates = ['deleted_at']; protected $primaryKey = 'id'; protected $table = 'article'; public $timestamps = false; public $incrementing = false; // &lt;&lt;&lt;props&lt;&lt;&lt; // &gt;&gt;&gt;methods&gt;&gt;&gt; public function tag() { return $this-&gt;belongsToMany(Tag::class, 'tag_article'); } public function topic() { return $this-&gt;belongsTo(Topic::class); } // &lt;&lt;&lt;methods&lt;&lt;&lt; }</span></span></code> </pre><br><cut></cut><br>  Seperti yang Anda lihat, komentar muncul di sini // &gt;&gt;&gt; alat peraga &gt;&gt;&gt; dan // &gt;&gt;&gt; metode &gt;&gt;&gt; - mereka diperlukan untuk memisahkan ruang kode dari ruang kode pengguna.  Ada juga hubungan tag / topik - belognsToMany / milikTo, masing-masing, yang akan menghubungkan entitas Artikel dengan tag / topik, memberikan kesempatan untuk mengaksesnya dalam hubungan json-api dengan permintaan GET tunggal atau mengubahnya dengan memperbarui artikel. <br><br>  3) Migrasi entitas, dengan dukungan rollback (refleksi / atomicity): <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Illuminate</span></span>\<span class="hljs-title"><span class="hljs-title">Support</span></span>\<span class="hljs-title"><span class="hljs-title">Facades</span></span>\<span class="hljs-title"><span class="hljs-title">Schema</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Illuminate</span></span>\<span class="hljs-title"><span class="hljs-title">Database</span></span>\<span class="hljs-title"><span class="hljs-title">Schema</span></span>\<span class="hljs-title"><span class="hljs-title">Blueprint</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Illuminate</span></span>\<span class="hljs-title"><span class="hljs-title">Database</span></span>\<span class="hljs-title"><span class="hljs-title">Migrations</span></span>\<span class="hljs-title"><span class="hljs-title">Migration</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CreateArticleTable</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Migration</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">up</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ Schema::create(<span class="hljs-string"><span class="hljs-string">'article'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Blueprint $table)</span></span></span><span class="hljs-function"> </span></span>{ $table-&gt;bigIncrements(<span class="hljs-string"><span class="hljs-string">'id'</span></span>); $table-&gt;string(<span class="hljs-string"><span class="hljs-string">'title'</span></span>, <span class="hljs-number"><span class="hljs-number">256</span></span>); $table-&gt;index(<span class="hljs-string"><span class="hljs-string">'title'</span></span>, <span class="hljs-string"><span class="hljs-string">'idx_title'</span></span>); $table-&gt;string(<span class="hljs-string"><span class="hljs-string">'description'</span></span>, <span class="hljs-number"><span class="hljs-number">1024</span></span>); $table-&gt;string(<span class="hljs-string"><span class="hljs-string">'url'</span></span>, <span class="hljs-number"><span class="hljs-number">255</span></span>); $table-&gt;unique(<span class="hljs-string"><span class="hljs-string">'url'</span></span>, <span class="hljs-string"><span class="hljs-string">'idx_url'</span></span>); <span class="hljs-comment"><span class="hljs-comment">// Show at the top of main page $table-&gt;unsignedTinyInteger('show_in_top'); $table-&gt;enum('status', ["draft","published","postponed","archived"]); // ManyToOne Topic relationship $table-&gt;unsignedInteger('topic_id'); $table-&gt;foreign('topic_id', 'idx_fk_topic_id')-&gt;references('id')-&gt;on('topic')-&gt;onDelete('cascade')-&gt;onUpdate('cascade'); $table-&gt;timestamps(); }); } public function down() { Schema::dropIfExists('article'); } }</span></span></code> </pre><br>  Generator migrasi mendukung semua jenis indeks (termasuk yang komposit). <br><br>  4) Router untuk permintaan bergulir: <br><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">// &gt;&gt;&gt;routes&gt;&gt;&gt; // Article routes Route::group(['prefix' =&gt; 'v2', 'namespace' =&gt; 'Modules\\V2\\Http\\Controllers'], function() { // bulk routes Route::post('/article/bulk', 'ArticleController@createBulk'); Route::patch('/article/bulk', 'ArticleController@updateBulk'); Route::delete('/article/bulk', 'ArticleController@deleteBulk'); // basic routes Route::get('/article', 'ArticleController@index'); Route::get('/article/{id}', 'ArticleController@view'); Route::post('/article', 'ArticleController@create'); Route::patch('/article/{id}', 'ArticleController@update'); Route::delete('/article/{id}', 'ArticleController@delete'); // relation routes Route::get('/article/{id}/relationships/{relations}', 'ArticleController@relations'); Route::post('/article/{id}/relationships/{relations}', 'ArticleController@createRelations'); Route::patch('/article/{id}/relationships/{relations}', 'ArticleController@updateRelations'); Route::delete('/article/{id}/relationships/{relations}', 'ArticleController@deleteRelations'); }); // &lt;&lt;&lt;routes&lt;&lt;&lt;</span></span></code> </pre><br>  Rute dibuat tidak hanya untuk permintaan dasar, tetapi juga hubungan dengan entitas lain, yang akan ditarik oleh 1 kueri dan ekstensi sebagai operasi massal untuk kemampuan membuat / memperbarui / menghapus data dalam batch. <br><br>  5) FormRequest untuk pra-pemrosesan / validasi permintaan: <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">Modules</span></span>\<span class="hljs-title"><span class="hljs-title">V1</span></span>\<span class="hljs-title"><span class="hljs-title">Http</span></span>\<span class="hljs-title"><span class="hljs-title">Requests</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">rjapi</span></span>\<span class="hljs-title"><span class="hljs-title">extension</span></span>\<span class="hljs-title"><span class="hljs-title">BaseFormRequest</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ArticleFormRequest</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BaseFormRequest</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// &gt;&gt;&gt;props&gt;&gt;&gt; public $id = null; // Attributes public $title = null; public $description = null; public $url = null; public $show_in_top = null; public $status = null; public $topic_id = null; public $rate = null; public $date_posted = null; public $time_to_live = null; public $deleted_at = null; // &lt;&lt;&lt;props&lt;&lt;&lt; // &gt;&gt;&gt;methods&gt;&gt;&gt; public function authorize(): bool { return true; } public function rules(): array { return [ 'title' =&gt; 'required|string|min:16|max:256|', 'description' =&gt; 'required|string|min:32|max:1024|', 'url' =&gt; 'string|min:16|max:255|', // Show at the top of main page 'show_in_top' =&gt; 'boolean', // The state of an article 'status' =&gt; 'in:draft,published,postponed,archived|', // ManyToOne Topic relationship 'topic_id' =&gt; 'required|integer|min:1|max:6|', 'rate' =&gt; '|min:3|max:9|', 'date_posted' =&gt; '', 'time_to_live' =&gt; '', 'deleted_at' =&gt; '', ]; } public function relations(): array { return [ 'tag', 'topic', ]; } // &lt;&lt;&lt;methods&lt;&lt;&lt; }</span></span></code> </pre><br>  Semuanya sederhana di sini - aturan untuk memvalidasi properti dan relasi dibuat untuk menghubungkan entitas utama dengan entitas dalam metode relasi. <br><br>  Akhirnya, bagian terbaik adalah contoh kueri: <br><br><pre> <code class="php hljs">http:<span class="hljs-comment"><span class="hljs-comment">//example.com/v1/article?include=tag&amp;page=2&amp;limit=10&amp;sort=asc</span></span></code> </pre><br>  Tampilkan artikel, kencangkan semua tag-nya dalam hubungan, pagination pada halaman 2, dengan batas 10, dan urutkan berdasarkan usia. <br><br>  Jika kita tidak perlu menampilkan semua bidang artikel: <br><br><pre> <code class="php hljs">http:<span class="hljs-comment"><span class="hljs-comment">//example.com/v1/article/1?include=tag&amp;data=["title", "description"]</span></span></code> </pre><br>  Urutkan berdasarkan beberapa bidang: <br><br><pre> <code class="php hljs">http:<span class="hljs-comment"><span class="hljs-comment">//example.com/v1/article/1?include=tag&amp;order_by={"title":"asc", "created_at":"desc"}</span></span></code> </pre><br>  Pemfilteran (atau apa pun yang termasuk dalam klausa WHERE): <br><br><pre> <code class="php hljs">http:<span class="hljs-comment"><span class="hljs-comment">//example.com/v1/article?include=tag&amp;filter=[["updated_at", "&gt;", "2018-01-03 12:13:13"], ["updated_at", "&lt;", "2018-09-03 12:13:15"]]</span></span></code> </pre><br>  Contoh membuat entitas (dalam hal ini, artikel): <br><br><pre> <code class="json hljs">POST http://laravel.loc/v<span class="hljs-number"><span class="hljs-number">1</span></span>/article { <span class="hljs-attr"><span class="hljs-attr">"data"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>:<span class="hljs-string"><span class="hljs-string">"article"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"attributes"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"title"</span></span>:<span class="hljs-string"><span class="hljs-string">"Foo bar Foo bar Foo bar Foo bar"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"description"</span></span>:<span class="hljs-string"><span class="hljs-string">"description description description description description"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"fake_attr"</span></span>: <span class="hljs-string"><span class="hljs-string">"attr"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"url"</span></span>:<span class="hljs-string"><span class="hljs-string">"title title bla bla bla"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"show_in_top"</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span> } } }</code> </pre><br>  Jawabannya adalah: <br><br><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"data"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"article"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"1"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"attributes"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"title"</span></span>: <span class="hljs-string"><span class="hljs-string">"Foo bar Foo bar Foo bar Foo bar"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">"description description description description description"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"url"</span></span>: <span class="hljs-string"><span class="hljs-string">"title title bla bla bla"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"show_in_top"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"links"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"self"</span></span>: <span class="hljs-string"><span class="hljs-string">"laravel.loc/article/1"</span></span> } } }</code> </pre><br>  Lihat tautan di tautan-&gt; mandiri?  kamu bisa segera <pre> <code class="json hljs">GET http://laravel.loc/article/<span class="hljs-number"><span class="hljs-number">1</span></span></code> </pre>  atau simpan untuk referensi di masa mendatang. <br><br><pre> <code class="json hljs">GET http://laravel.loc/v<span class="hljs-number"><span class="hljs-number">1</span></span>/article?include=tag&amp;filter=[[<span class="hljs-string"><span class="hljs-string">"updated_at"</span></span>, <span class="hljs-string"><span class="hljs-string">"&gt;"</span></span>, <span class="hljs-string"><span class="hljs-string">"2017-01-03 12:13:13"</span></span>], [<span class="hljs-string"><span class="hljs-string">"updated_at"</span></span>, <span class="hljs-string"><span class="hljs-string">"&lt;"</span></span>, <span class="hljs-string"><span class="hljs-string">"2019-01-03 12:13:15"</span></span>]] { <span class="hljs-attr"><span class="hljs-attr">"data"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"article"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"1"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"attributes"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"title"</span></span>: <span class="hljs-string"><span class="hljs-string">"Foo bar Foo bar Foo bar Foo bar 1"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">"The quick brovn fox jumped ower the lazy dogg"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"url"</span></span>: <span class="hljs-string"><span class="hljs-string">"http://example.com/articles_feed 1"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"show_in_top"</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-attr"><span class="hljs-attr">"status"</span></span>: <span class="hljs-string"><span class="hljs-string">"draft"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"topic_id"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">"rate"</span></span>: <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-attr"><span class="hljs-attr">"date_posted"</span></span>: <span class="hljs-string"><span class="hljs-string">"2018-02-12"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"time_to_live"</span></span>: <span class="hljs-string"><span class="hljs-string">"10:11:12"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"links"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"self"</span></span>: <span class="hljs-string"><span class="hljs-string">"laravel.loc/article/1"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"relationships"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"tag"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"links"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"self"</span></span>: <span class="hljs-string"><span class="hljs-string">"laravel.loc/article/1/relationships/tag"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"related"</span></span>: <span class="hljs-string"><span class="hljs-string">"laravel.loc/article/1/tag"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"data"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"tag"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"1"</span></span> } ] } } } ], <span class="hljs-attr"><span class="hljs-attr">"included"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"tag"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"1"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"attributes"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"title"</span></span>: <span class="hljs-string"><span class="hljs-string">"Tag 1"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"links"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"self"</span></span>: <span class="hljs-string"><span class="hljs-string">"laravel.loc/tag/1"</span></span> } } ] }</code> </pre><br>  Saya mengembalikan daftar objek, di mana masing-masing jenis objek ini, id-nya, seluruh rangkaian atribut, lalu tautan ke diri saya sendiri, hubungan yang diminta dalam url melalui <u>include = tag,</u> dengan spesifikasi, tidak ada batasan untuk menyertakan relasi, yaitu, misalnya, <u>termasuk = tag, topik, kota,</u> dan semuanya akan dimasukkan dalam blok <b>hubungan</b> , dan objek mereka akan disimpan di dalamnya. <br><br>  Jika kita ingin mendapatkan 1 artikel dan semua hubungannya / hubungan: <br><br><pre> <code class="json hljs">GET http://laravel.loc/v<span class="hljs-number"><span class="hljs-number">1</span></span>/article/<span class="hljs-number"><span class="hljs-number">1</span></span>?include=tag&amp;data=[<span class="hljs-string"><span class="hljs-string">"title"</span></span>, <span class="hljs-string"><span class="hljs-string">"description"</span></span>] { <span class="hljs-attr"><span class="hljs-attr">"data"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"article"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"1"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"attributes"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"title"</span></span>: <span class="hljs-string"><span class="hljs-string">"Foo bar Foo bar Foo bar Foo bar 123456"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">"description description description description description 123456"</span></span>, }, <span class="hljs-attr"><span class="hljs-attr">"links"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"self"</span></span>: <span class="hljs-string"><span class="hljs-string">"laravel.loc/article/1"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"relationships"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"tag"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"links"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"self"</span></span>: <span class="hljs-string"><span class="hljs-string">"laravel.loc/article/1/relationships/tag"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"related"</span></span>: <span class="hljs-string"><span class="hljs-string">"laravel.loc/article/1/tag"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"data"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"tag"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"3"</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"tag"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"1"</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"tag"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"2"</span></span> } ] } } }, <span class="hljs-attr"><span class="hljs-attr">"included"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"tag"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"3"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"attributes"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"title"</span></span>: <span class="hljs-string"><span class="hljs-string">"Tag 4"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"links"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"self"</span></span>: <span class="hljs-string"><span class="hljs-string">"laravel.loc/tag/3"</span></span> } }, { <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"tag"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"1"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"attributes"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"title"</span></span>: <span class="hljs-string"><span class="hljs-string">"Tag 2"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"links"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"self"</span></span>: <span class="hljs-string"><span class="hljs-string">"laravel.loc/tag/1"</span></span> } }, { <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"tag"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"2"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"attributes"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"title"</span></span>: <span class="hljs-string"><span class="hljs-string">"Tag 3"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"links"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"self"</span></span>: <span class="hljs-string"><span class="hljs-string">"laravel.loc/tag/2"</span></span> } } ] }</code> </pre><br><br>  Dan di sini adalah contoh menambahkan hubungan ke entitas yang ada - permintaan: <br><br><pre> <code class="json hljs">PATCH http://laravel.loc/v<span class="hljs-number"><span class="hljs-number">1</span></span>/article/<span class="hljs-number"><span class="hljs-number">1</span></span>/relationships/tag { <span class="hljs-attr"><span class="hljs-attr">"data"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>:<span class="hljs-string"><span class="hljs-string">"article"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>:<span class="hljs-string"><span class="hljs-string">"1"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"relationships"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"tag"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"data"</span></span>: [{ <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"tag"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"2"</span></span> },{ <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"tag"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"3"</span></span> }] } } } }</code> </pre><br>  Jawabannya adalah: <br><br><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"data"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"article"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"1"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"attributes"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"title"</span></span>: <span class="hljs-string"><span class="hljs-string">"Foo bar Foo bar Foo bar Foo bar 1"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">"The quick brovn fox jumped ower the lazy dogg"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"url"</span></span>: <span class="hljs-string"><span class="hljs-string">"http://example.com/articles_feed 1"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"show_in_top"</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-attr"><span class="hljs-attr">"status"</span></span>: <span class="hljs-string"><span class="hljs-string">"draft"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"topic_id"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">"rate"</span></span>: <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-attr"><span class="hljs-attr">"date_posted"</span></span>: <span class="hljs-string"><span class="hljs-string">"2018-02-12"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"time_to_live"</span></span>: <span class="hljs-string"><span class="hljs-string">"10:11:12"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"links"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"self"</span></span>: <span class="hljs-string"><span class="hljs-string">"laravel.loc/article/1"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"relationships"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"tag"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"links"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"self"</span></span>: <span class="hljs-string"><span class="hljs-string">"laravel.loc/article/1/relationships/tag"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"related"</span></span>: <span class="hljs-string"><span class="hljs-string">"laravel.loc/article/1/tag"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"data"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"tag"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"2"</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"tag"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"3"</span></span> } ] } } }, <span class="hljs-attr"><span class="hljs-attr">"included"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"tag"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"2"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"attributes"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"title"</span></span>: <span class="hljs-string"><span class="hljs-string">"Tag 2"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"links"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"self"</span></span>: <span class="hljs-string"><span class="hljs-string">"laravel.loc/tag/2"</span></span> } }, { <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"tag"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"3"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"attributes"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"title"</span></span>: <span class="hljs-string"><span class="hljs-string">"Tag 3"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"links"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"self"</span></span>: <span class="hljs-string"><span class="hljs-string">"laravel.loc/tag/3"</span></span> } } ] }</code> </pre><br>  Anda dapat mentransfer opsi tambahan ke generator konsol: <br><br><pre> <code class="json hljs">php artisan api:generate oas/openapi.yaml --migrations --regenerate --merge=last</code> </pre><br>  Dengan demikian, Anda memberi tahu generator - membuat kode dengan migrasi (Anda sudah melihatnya) dan membuat ulang kode, menyimpannya dengan perubahan terbaru dari riwayat yang disimpan, tanpa memengaruhi bagian khusus dari kode, tetapi hanya yang dihasilkan secara otomatis (yaitu, hanya yang , yang disorot oleh blok khusus dengan komentar dalam kode).  Dimungkinkan untuk menentukan langkah mundur, misalnya: <b>--merge = 9</b> (memutar kembali generasi 9 langkah mundur), tanggal pembuatan kode di masa lalu <b>--merge = "2017-07-29 11:35:32"</b> . <br><br>  Salah satu pengguna perpustakaan menyarankan pembuatan tes fungsional untuk kueri - dengan menambahkan opsi - tes Anda dapat menjalankan tes untuk memastikan bahwa API Anda berfungsi tanpa kesalahan. <br><br>  Selain itu, Anda dapat menggunakan banyak opsi (semuanya dikonfigurasi secara fleksibel melalui konfigurator, yang terletak pada modul yang dibuat - contoh: <i>/Modules/V2/Config/config.php</i> ): <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> [ <span class="hljs-string"><span class="hljs-string">'name'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'V2'</span></span>, <span class="hljs-string"><span class="hljs-string">'query_params'</span></span>=&gt; [ <span class="hljs-comment"><span class="hljs-comment">//    - 'limit' =&gt; 15, 'sort' =&gt; 'desc', 'access_token' =&gt; 'db7329d5a3f381875ea6ce7e28fe1ea536d0acaf', ], 'trees'=&gt; [ //      'menu' =&gt; true, ], 'jwt'=&gt; [ // jwt  'enabled' =&gt; true, 'table' =&gt; 'user', 'activate' =&gt; 30, 'expires' =&gt; 3600, ], 'state_machine'=&gt; [ // finite state machine 'article'=&gt; [ 'status'=&gt; [ 'enabled' =&gt; true, 'states'=&gt; [ 'initial' =&gt; ['draft'], 'draft' =&gt; ['published'], 'published' =&gt; ['archived', 'postponed'], 'postponed' =&gt; ['published', 'archived'], 'archived' =&gt; [''], ], ], ], ], 'spell_check'=&gt; [ //       'article'=&gt; [ 'description'=&gt; [ 'enabled' =&gt; true, 'language' =&gt; 'en', ], ], ], 'bit_mask'=&gt; [ //     permissions ( true/false /  ) 'user'=&gt; [ 'permissions'=&gt; [ 'enabled' =&gt; true, 'flags'=&gt; [ 'publisher' =&gt; 1, 'editor' =&gt; 2, 'manager' =&gt; 4, 'photo_reporter' =&gt; 8, 'admin' =&gt; 16, ], ], ], ], 'cache'=&gt; [ //    'tag'=&gt; [ 'enabled' =&gt; false, //    tag  'stampede_xfetch' =&gt; true, 'stampede_beta' =&gt; 1.1, 'ttl' =&gt; 3600, ], 'article'=&gt; [ 'enabled' =&gt; true, //    article  'stampede_xfetch' =&gt; true, 'stampede_beta' =&gt; 1.5, 'ttl' =&gt; 300, ], ], ];</span></span></code> </pre><br>  Secara alami, semua konfigurasi dapat dihidupkan / dimatikan jika perlu.  Untuk informasi lebih lanjut tentang fitur tambahan pembuat kode, lihat tautan di bawah ini.  Kontribusi selalu diterima. <br><br>  Terima kasih atas perhatian Anda, kesuksesan kreatif. <br><br>  Sumber Daya Artikel: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">generator</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">spesifikasi json-api</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Spesifikasi OAS</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id427741/">https://habr.com/ru/post/id427741/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id427731/index.html">Linus Torvalds kembali beroperasi setelah rilis versi kernel 4,19</a></li>
<li><a href="../id427733/index.html">Cyberpunk 2000: Deus Ex Creation Tools</a></li>
<li><a href="../id427735/index.html">Analisis game dari Classmates di Joker 2018</a></li>
<li><a href="../id427737/index.html">Perjalanan ke Negeri Raksasa: Ulasan ONYX BOOX Gulliver</a></li>
<li><a href="../id427739/index.html">DDD, Hexagonal, Bawang, Bersih, CQRS ... bagaimana saya menggabungkan semuanya</a></li>
<li><a href="../id427743/index.html">Lucu dan aneh: kami telah mengumpulkan permintaan pencarian yang kami sukai</a></li>
<li><a href="../id427745/index.html">Kiat & trik Kubernetes: akses ke situs dev</a></li>
<li><a href="../id427747/index.html">Siapa yang menabrak mobil tak berawak: Hasil percobaan Mesin Moral</a></li>
<li><a href="../id427749/index.html">Apple dan Samsung untuk pertama kalinya didenda karena memperlambat ponsel lama</a></li>
<li><a href="../id427751/index.html">Gagasan Sublime CudaText</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>