<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ЁЯзЦЁЯП╝ ЁЯеЫ ЁЯПд рд╕реБрдЕрд░ рдЙрдбрд╝рд╛рди, рдпрд╛ Bytecode рджреБрднрд╛рд╖рд┐рдпреЛрдВ рдХрд╛ рдЕрдиреБрдХреВрд▓рди ЁЯМ╢я╕П ЁЯд╜ЁЯП╝ тШХя╕П</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content=""рдХреЛрдИ рдлрд░реНрдХ рдирд╣реАрдВ рдкрдбрд╝рддрд╛ рдХрд┐ рдЖрдк рдХрд┐рддрдиреА рдХреЛрд╢рд┐рд╢ рдХрд░рддреЗ рд╣реИрдВ, рдЖрдк рдПрдХ рд╕реБрдЕрд░ рд╕реЗ рдмрд╛рд╣рд░ рджреМрдбрд╝рдиреЗ рдХрд╛ рд░рд╛рд╕реНрддрд╛ рдирд╣реАрдВ рдмрдирд╛ рд╕рдХрддреЗред рдЖрдк рд╣рд╛рд▓рд╛рдВрдХрд┐, рдПрдХ рддреЗрдЬ рд╕реБрдЕрд░ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ" (Emax рдХреЗ рд╕реНрд░...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>рд╕реБрдЕрд░ рдЙрдбрд╝рд╛рди, рдпрд╛ Bytecode рджреБрднрд╛рд╖рд┐рдпреЛрдВ рдХрд╛ рдЕрдиреБрдХреВрд▓рди</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/badoo/blog/428878/"><p><img src="https://habrastorage.org/webt/bg/lp/cz/bglpczwnjg-u0usatiwfxggd-zi.jpeg"></p><br><blockquote>  "рдХреЛрдИ рдлрд░реНрдХ рдирд╣реАрдВ рдкрдбрд╝рддрд╛ рдХрд┐ рдЖрдк рдХрд┐рддрдиреА рдХреЛрд╢рд┐рд╢ рдХрд░рддреЗ рд╣реИрдВ, рдЖрдк рдПрдХ рд╕реБрдЕрд░ рд╕реЗ рдмрд╛рд╣рд░ рджреМрдбрд╝рдиреЗ рдХрд╛ рд░рд╛рд╕реНрддрд╛ рдирд╣реАрдВ рдмрдирд╛ рд╕рдХрддреЗред рдЖрдк рд╣рд╛рд▓рд╛рдВрдХрд┐, рдПрдХ рддреЗрдЬ рд╕реБрдЕрд░ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ" (Emax рдХреЗ рд╕реНрд░реЛрдд рдХреЛрдб рдореЗрдВ рдЯрд┐рдкреНрдкрдгреА) </blockquote><p>  рдЗрд╕ рддрдереНрдп рдХреЛ рд╕рднреА рдЬрд╛рдирддреЗ рд╣реИрдВ рдХрд┐ рд╕реВрдЕрд░ рдЙрдбрд╝рддреЗ рдирд╣реАрдВ рд╣реИрдВред  рдХреЛрдИ рднреА рдХрдо рд▓реЛрдХрдкреНрд░рд┐рдп рд░рд╛рдп рдпрд╣ рдирд╣реАрдВ рд╣реИ рдХрд┐ рдЙрдЪреНрдЪ-рд╕реНрддрд░реАрдп рднрд╛рд╖рд╛рдУрдВ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреА рддрдХрдиреАрдХ рдХреЗ рд░реВрдк рдореЗрдВ рдмрд╛рдИрдЯреЗрдХреЛрдб рд╡реНрдпрд╛рдЦреНрдпрд╛рдХрд╛рд░реЛрдВ рдХреЛ рд╕рдордп-рд╕рдордп рдкрд░ рдЧрддрд┐рд╢реАрд▓ рд╕рдВрдХрд▓рди рдХреЗ рдЙрдкрдпреЛрдЧ рдХреЗ рдмрд┐рдирд╛ рддреНрд╡рд░рд┐рдд рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред </p><br><p>  рдмрд╛рдИрдЯреЗрдХреЛрдб рджреБрднрд╛рд╖рд┐рдпреЛрдВ рдкрд░ рд▓реЗрдЦреЛрдВ рдХреА рдПрдХ рд╢реНрд░реГрдВрдЦрд▓рд╛ рдХреЗ рджреВрд╕рд░реЗ рднрд╛рдЧ рдореЗрдВ, рдПрдХ рдЫреЛрдЯреЗ рд╕реЗ рд╕реНрдЯреИрдХреНрдб рдПрдлрдбреАрдП рд╡рд░реНрдЪреБрдЕрд▓ рдорд╢реАрди (рдкрд┐рдЧ рд╡рд░реНрдЪреБрдЕрд▓ рдорд╢реАрди) рдХреЗ рдЙрджрд╛рд╣рд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП, рдореИрдВ рдпрд╣ рджрд┐рдЦрд╛рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реВрдВрдЧрд╛ рдХрд┐ рдорд╣рддреНрд╡рд╛рдХрд╛рдВрдХреНрд╖рд╛рдУрдВ рдХреЗ рд╕рд╛рде рдореЗрд╣рдирддреА рдкрд┐рдЧрд▓реЗрдЯ рдХреЗ рд▓рд┐рдП рд╕рдм рдХреБрдЫ рдЦреЛ рдирд╣реАрдВ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдпрд╣ (рдЬреНрдпрд╛рджрд╛рддрд░) рдорд╛рдирдХ рд╕реА рдХреЗ рдврд╛рдВрдЪреЗ рдХреЗ рднреАрддрд░ рддреЗрдЬреА рд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрднрд╡ рд╣реИред рдЗрд╕ рддрд░рд╣ рдХреЗ рджреБрднрд╛рд╖рд┐рдпреЛрдВ рдХрд╛ рдХрд╛рдо рдХрдо рд╕реЗ рдХрдо рдбреЗрдврд╝ рдЧреБрдирд╛ рд╣реИред </p><a name="habracut"></a><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рднрд╛рдЧ рдПрдХ, рдкрд░рд┐рдЪрдпрд╛рддреНрдордХ</a> <br>  рднрд╛рдЧ рджреЛ, рдЕрдиреБрдХреВрд▓рди (рд╡рд░реНрддрдорд╛рди) <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рднрд╛рдЧ рддреАрди, рд▓рд╛рдЧреВ</a> </p><br><h1 id="porosenokvm">  PorosenokVM </h1><br><p>  рдЖрдЗрдП рдкрд░рд┐рдЪрд┐рдд рд╣реЛрдВред </p><br><p>  <a href="">рдкрд┐рдЧрд▓реЗрдЯ</a> рд╡реАрдПрдо рдПрдХ рд╕рд╛рдзрд╛рд░рдг рд╕реНрдЯреИрдХреНрдб рдорд╢реАрди рд╣реИ рдЬреЛ рд▓реЗрдЦреЛрдВ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдХреА рдПрдХ</a> рд╢реНрд░реГрдВрдЦрд▓рд╛ рдХреЗ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдкрд╣рд▓реЗ рднрд╛рдЧ</a> рд╕реЗ рдПрдХ <a href="">рдЙрджрд╛рд╣рд░рдг</a> рдкрд░ рдЖрдзрд╛рд░рд┐рдд рд╣реИред  рд╣рдорд╛рд░рд╛ рд╕реБрдЕрд░ рдХреЗрд╡рд▓ рдПрдХ рдбреЗрдЯрд╛ рдкреНрд░рдХрд╛рд░ рдЬрд╛рдирддрд╛ рд╣реИ - рдПрдХ 64-рдмрд┐рдЯ рдорд╢реАрди рд╢рдмреНрдж, рдФрд░ рд╕рднреА (рдкреВрд░реНрдгрд╛рдВрдХ) рдЧрдгрдирд╛ 256 рдорд╢реАрди рд╢рдмреНрджреЛрдВ рдХреА рдЕрдзрд┐рдХрддрдо рдЧрд╣рд░рд╛рдИ рдХреЗ рд╕рд╛рде рд╕реНрдЯреИрдХ рдкрд░ рдХреА рдЬрд╛рддреА рд╣реИред  рд╕реНрдЯреИрдХ рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдЗрд╕ рдкрд┐рдЧрд▓реЗрдЯ рдореЗрдВ 65,536 рдорд╢реАрди рд╢рдмреНрджреЛрдВ рдХреА рдПрдХ рдХрд╛рд░реНрдпрд╢реАрд▓ рдореЗрдореЛрд░реА рд╣реИред  рдХрд╛рд░реНрдпрдХреНрд░рдо рдирд┐рд╖реНрдкрд╛рджрди рдХрд╛ рдкрд░рд┐рдгрд╛рдо - рдПрдХ рдорд╢реАрди рд╢рдмреНрдж - рдпрд╛ рддреЛ рдкрд░рд┐рдгрд╛рдо рд░рдЬрд┐рд╕реНрдЯрд░ рдореЗрдВ рд░рдЦрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдпрд╛ рдмрд╕ рдорд╛рдирдХ рдЖрдЙрдЯрдкреБрдЯ (рд╕реНрдЯрдбрдЖрдЙрдЯ) рдХреЗ рд▓рд┐рдП рдЖрдЙрдЯрдкреБрдЯред </p><br><p>  рдкрд┐рдЧрд▓реЗрдЯ рд╡реАрдПрдо рдорд╢реАрди рдореЗрдВ рдкреВрд░реЗ рд░рд╛рдЬреНрдп рдХреЛ рдПрдХ рд╕рдВрд░рдЪрдирд╛ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ: </p><br><pre><code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-comment"><span class="hljs-comment">/* Current instruction pointer */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span> *ip; <span class="hljs-comment"><span class="hljs-comment">/* Fixed-size stack */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">uint64_t</span></span> <span class="hljs-built_in"><span class="hljs-built_in">stack</span></span>[STACK_MAX]; <span class="hljs-keyword"><span class="hljs-keyword">uint64_t</span></span> *stack_top; <span class="hljs-comment"><span class="hljs-comment">/* Operational memory */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">uint64_t</span></span> memory[MEMORY_SIZE]; <span class="hljs-comment"><span class="hljs-comment">/* A single register containing the result */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">uint64_t</span></span> result; } vm;</code> </pre> <br><p>  рдЙрдкрд░реЛрдХреНрдд рд╣рдореЗрдВ рдЗрд╕ рдорд╢реАрди рдХреЛ рдирд┐рдореНрди-рд╕реНрддрд░реАрдп рдЖрднрд╛рд╕реА рдорд╢реАрдиреЛрдВ рдХреА рд╡рд┐рд╢реЗрд╖рддрд╛ рдкреНрд░рджрд╛рди рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ, рд▓рдЧрднрдЧ рд╕рднреА рдУрд╡рд░рд╣реЗрдб рдЬрд┐рд╕рдореЗрдВ рдореБрдЦреНрдп рдкреНрд░реЛрдЧреНрд░рд╛рдо рдЪрдХреНрд░ рдХреЗ рд░рдЦрд░рдЦрд╛рд╡ рдкрд░ рдкрдбрд╝рддрд╛ рд╣реИ: </p><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">interpret_result </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">vm_interpret</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint8_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *bytecode)</span></span></span><span class="hljs-function"> </span></span>{ vm_reset(bytecode); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (;;) { <span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span> instruction = NEXT_OP(); <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (instruction) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> OP_PUSHI: { <span class="hljs-comment"><span class="hljs-comment">/* get the argument, push it onto stack */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> arg = NEXT_ARG(); PUSH(arg); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> OP_ADD: { <span class="hljs-comment"><span class="hljs-comment">/* Pop 2 values, add 'em, push the result back to the stack */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">uint64_t</span></span> arg_right = POP(); *TOS_PTR() += arg_right; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } <span class="hljs-comment"><span class="hljs-comment">/* * ... * Lots of other instruction handlers here * ... */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> OP_DONE: { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> SUCCESS; } <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ERROR_UNKNOWN_OPCODE; } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ERROR_END_OF_STREAM; }</code> </pre> <br><p>  рдХреЛрдб рд╕реЗ рдкрддрд╛ рдЪрд▓рддрд╛ рд╣реИ рдХрд┐ рдкреНрд░рддреНрдпреЗрдХ opcode рдХреЗ рд▓рд┐рдП, рдЧреБрд▓реНрд▓рдХ рдЪрд╛рд╣рд┐рдП: </p><br><ol><li>  рдирд┐рд░реНрджреЗрд╢ рдзрд╛рд░рд╛ рд╕реЗ opcode рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВред </li><li>  рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ рдХрд┐ opcode opcode рдорд╛рдиреЛрдВ рдХреА рдорд╛рдиреНрдп рд╢реНрд░реЗрдгреА рдореЗрдВ рд╣реИ (рдпрд╣ рддрд░реНрдХ C рдХрдВрдкрд╛рдЗрд▓рд░ рджреНрд╡рд╛рд░рд╛ рд╕реНрд╡рд┐рдЪ рдХреЛрдб рдмрдирд╛рддреЗ рд╕рдордп рдЬреЛрдбрд╝рд╛ рдЬрд╛рддрд╛ рд╣реИ)ред </li><li>  рд╢рд░реАрд░ рдХреЗ рдирд┐рд░реНрджреЗрд╢реЛрдВ рдкрд░ рдЬрд╛рдПрдВред </li><li>  рд╕реНрдЯреИрдХ рд╕реЗ рдЕрдиреБрджреЗрд╢ рддрд░реНрдХ рдирд┐рдХрд╛рд▓реЗрдВ рдпрд╛ рд╕реАрдзреЗ рдмрд╛рдпреЛрдЯреЗрдХ рдореЗрдВ рд╕реНрдерд┐рдд рдПрдХ рдирд┐рд░реНрджреЗрд╢ рддрд░реНрдХ рдХреЛ рдбреАрдХреЛрдб рдХрд░реЗрдВред </li><li>  рдПрдХ рдСрдкрд░реЗрд╢рди рдХрд░реЗрдВред </li><li>  рдпрджрд┐ рдЧрдгрдирд╛ рдХрд╛ рдПрдХ рдкрд░рд┐рдгрд╛рдо рд╣реИ, рддреЛ рдЗрд╕реЗ рд╕реНрдЯреИрдХ рдкрд░ рд░рдЦреЗрдВред </li><li>  рд╡рд░реНрддрдорд╛рди рдирд┐рд░реНрджреЗрд╢ рд╕реЗ рд╕реВрдЪрдХ рдХреЛ рдЕрдЧрд▓реЗ рдкрд░ рд▓реЗ рдЬрд╛рдПрдВред </li></ol><br><p>  рдпрд╣рд╛рдВ рдкреЗрд▓реЛрдб рдХреЗрд╡рд▓ рдкрд╛рдВрдЪрд╡реЗрдВ рдкреИрд░рд╛рдЧреНрд░рд╛рдл рдореЗрдВ рд╣реИ, рдмрд╛рдХреА рдУрд╡рд░рд╣реЗрдб рд╣реИ: рд╕реНрдЯреИрдХ (рдХреНрд▓реЙрдЬ 4) рд╕реЗ рдирд┐рд░реНрджреЗрд╢ рддрд░реНрдХреЛрдВ рдХреЛ рдбрд┐рдХреЛрдб рдХрд░рдирд╛ рдпрд╛ рдкреБрдирд░реНрдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛, рдУрдкрдХреЛрдб рдореВрд▓реНрдп (рдХреНрд▓реЙрдЬ 2) рдХреА рдЬрд╛рдВрдЪ рдХрд░рдирд╛, рдмрд╛рд░-рдмрд╛рд░ рдореБрдЦреНрдп рд▓реВрдк рдХреА рд╢реБрд░реБрдЖрдд рдореЗрдВ рд▓реМрдЯрдирд╛ рдФрд░ рдмрд╛рдж рдореЗрдВ рдореБрд╢реНрдХрд┐рд▓ рд╕реЗ рдЕрдиреБрдорд╛рдирд┐рдд рд╕рд╢рд░реНрдд рд╕рдВрдХреНрд░рдордг (рдХреНрд▓рд╛рдЬ 3) рдХреА рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдХрд░рдирд╛ред </p><br><p>  рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ, рд╕реБрдЕрд░ рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ рдЕрдиреБрд╢рдВрд╕рд┐рдд рдмреЙрдбреА рдорд╛рд╕ рдЗрдВрдбреЗрдХреНрд╕ рдХреЛ рдкрд╛рд░ рдХрд░ рдЧрдпрд╛ рд╣реИ, рдФрд░ рдпрджрд┐ рд╣рдо рдЗрд╕реЗ рдЖрдХрд╛рд░ рдореЗрдВ рд▓рд╛рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рддреЛ рд╣рдореЗрдВ рдЗрди рд╕рднреА рдЕрддрд┐рд░рд┐рдХреНрддрддрд╛рдУрдВ рд╕реЗ рдирд┐рдкрдЯрдирд╛ рд╣реЛрдЧрд╛ред </p><br><h1 id="svinskiy-yazyk-assemblera-i-resheto-eratosfena">  рд╕реБрдЕрд░ рд╡рд┐рдзрд╛рдирд╕рднрд╛ рднрд╛рд╖рд╛ рдФрд░ рдПрд░рд╛рдЯреЛрд╕реНрдердиреАрдЬ рдХреА рдЫрд▓рдиреА </h1><br><p>  рдкрд╣рд▓реЗ, рдЪрд▓реЛ рдЦреЗрд▓ рдХреЗ рдирд┐рдпрдореЛрдВ рдкрд░ рдирд┐рд░реНрдгрдп рд▓реЗрддреЗ рд╣реИрдВред </p><br><p>  рд╕реА рдореЗрдВ рдПрдХ рдЖрднрд╛рд╕реА рдорд╢реАрди рдХреЗ рд▓рд┐рдП рд╕реАрдзреЗ рдкреНрд░реЛрдЧреНрд░рд╛рдо рд▓рд┐рдЦрдирд╛ рдПрдХ рдмреБрд░рд╛ рд╡рд┐рдЪрд╛рд░ рд╣реИ, рд▓реЗрдХрд┐рди рдПрдХ рдкреНрд░реЛрдЧреНрд░рд╛рдорд┐рдВрдЧ рднрд╛рд╖рд╛ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд▓рдВрдмрд╛ рд╕рдордп рд╣реИ, рдЗрд╕рд▓рд┐рдП рд╣рдордиреЗ рдЦреБрдж рдХреЛ рдЧреБрд▓реНрд▓рдХ рд╡рд┐рдзрд╛рдирд╕рднрд╛ рднрд╛рд╖рд╛ рдореЗрдВ рд╕реАрдорд┐рдд рдХрд░рдиреЗ рдХрд╛ рдлреИрд╕рд▓рд╛ рдХрд┐рдпрд╛ред </p><br><p>  рдПрдХ рдкреНрд░реЛрдЧреНрд░рд╛рдо рдЬреЛ рдЗрд╕ рдЕрд╕реЗрдВрдмрд▓рд░ рдореЗрдВ 1 рд╕реЗ 65,536 рддрдХ рдХреА рд╕рдВрдЦреНрдпрд╛ рдХреА рдЧрдгрдирд╛ рдХрд░рддрд╛ рд╣реИ, рд╡рд╣ рдХреБрдЫ рдЗрд╕ рддрд░рд╣ рджрд┐рдЦрддрд╛ рд╣реИ: </p><br><pre> <code class="plaintext hljs"># sum numbers from 1 to 65535 # init the current sum and the index PUSHI 1 PUSHI 1 # stack s=1, i=1 STOREI 0 # stack: s=1 # routine: increment the counter, add it to the current sum incrementandadd: # check if index is too big LOADI 0 # stack: s, i ADDI 1 # stack: s, i+1 DUP # stack: s, i+1, i+1 GREATER_OR_EQUALI 65535 # stack: s, i+1, 1 or 0 JUMP_IF_TRUE done # stack: s, i+1 DUP # stack: s, i+1, i+1 STOREI 0 # stack: s, i+1 ADD # stack: s+i+1 JUMP incrementandadd done: DISCARD PRINT DONE</code> </pre> <br><p>  рдЕрдЬрдЧрд░ рдирд╣реАрдВ, рдирд┐рд╢реНрдЪрд┐рдд рд░реВрдк рд╕реЗ, рд▓реЗрдХрд┐рди рд╕реБрдЕрд░ рдХреА рдЦреБрд╢реА рдХреЗ рд▓рд┐рдП рдЖрдкрдХреА рдЬрд░реВрд░рдд рдХреА рд╣рд░ рдЪреАрдЬ рд╣реИ: рдЯрд┐рдкреНрдкрдгреА, рдЯреИрдЧ, рд╕рд╢рд░реНрдд рдФрд░ рдмрд┐рдирд╛ рд╢рд░реНрдд рдХреВрджрдирд╛, рдЙрдиреНрд╣реЗрдВ рдирд┐рд░реНрджреЗрд╢ рдХреЗ рд▓рд┐рдП рдореЗрдиреЗрдорд┐рдХреНрд╕, рдФрд░ рдирд┐рд░реНрджреЗрд╢реЛрдВ рдХреЗ рд▓рд┐рдП рд╕реАрдзреЗ рддрд░реНрдХ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ред </p><br><p>  рдорд╢реАрди "рдкрд┐рдЧрд▓реЗрдЯ рд╡реАрдПрдо" рдХреЗ рд╕рд╛рде рдкреВрд░рд╛ рдХрд░реЗрдВ рдХреЛрдбрд╛рдВрддрд░рдХ рдФрд░ рдбрд┐рд╕реНрд╕реЗрдореНрдмрд▓рд░ рд╣реИрдВ, рдЬреЛ рдЖрддреНрдорд╛ рдореЗрдВ рд╕рд╛рд╣рд╕реА рд╣реИрдВ рдФрд░ рдмрд╣реБрдд рдЕрдзрд┐рдХ рдЦрд╛рд▓реА рд╕рдордп рд╣реИ, рдкрд╛рдардХ рд╕реНрд╡рддрдВрддреНрд░ рд░реВрдк рд╕реЗ рд▓рдбрд╝рд╛рдИ рдореЗрдВ рдкрд░реАрдХреНрд╖рдг рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред </p><br><p>  рд╕рдВрдЦреНрдпрд╛ рдмрд╣реБрдд рддреЗрдЬрд╝реА рд╕реЗ рдмрдврд╝рддреА рд╣реИ, рдЗрд╕рд▓рд┐рдП рдкреНрд░рджрд░реНрд╢рди рдХреЗ рдкрд░реАрдХреНрд╖рдг рдХреЗ рд▓рд┐рдП рдореИрдВрдиреЗ рдПрдХ рдФрд░ рдХрд╛рд░реНрдпрдХреНрд░рдо рд▓рд┐рдЦрд╛ - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдПрд░рд╛рдЯреЛрд╕реНрдердиреАрдЬрд╝</a> рдХреА <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЫрд▓рдиреА рдХрд╛</a> рдПрдХ рднреЛрд▓реА рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрдиред </p><br><p>  рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рдкрд┐рдЧрд▓реЗрдЯ рд╡реИрд╕реЗ рднреА рдХрд╛рдлреА рддреЗрдЬ рдЪрд▓рддрд╛ рд╣реИ (рдЗрд╕рдХреЗ рдирд┐рд░реНрджреЗрд╢ рдорд╢реАрди рд╡рд╛рд▓реЛрдВ рдХреЗ рдХрд░реАрдм рд╣реИрдВ), рдЗрд╕рд▓рд┐рдП, рд╕реНрдкрд╖реНрдЯ рдкрд░рд┐рдгрд╛рдо рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдореИрдВ рдХрд╛рд░реНрдпрдХреНрд░рдо рдХреЗ рд╕реМ рд╢реБрд░реБрдЖрдд рдХреЗ рд▓рд┐рдП рдкреНрд░рддреНрдпреЗрдХ рдорд╛рдк рдХрд░реВрдВрдЧрд╛ред </p><br><p>  рд╣рдорд╛рд░реЗ рдЧреИрд░-рдЕрдиреБрдХреВрд▓рд┐рдд рд╕реБрдЕрд░ рдХрд╛ рдкрд╣рд▓рд╛ рд╕рдВрд╕реНрдХрд░рдг рдЗрд╕ рддрд░рд╣ рдЪрд▓рддрд╛ рд╣реИ: </p><br><pre> <code class="plaintext hljs">&gt; ./pigletvm runtimes test/sieve-unoptimized.bin 100 &gt; /dev/null PROFILE: switch code finished took 545ms</code> </pre> <br><p>  рдЖрдзрд╛ рд╕реЗрдХрдВрдб!  рддреБрд▓рдирд╛ рдирд┐рд╢реНрдЪрд┐рдд рд░реВрдк рд╕реЗ рдмреЗрдИрдорд╛рди рд╣реИ, рд▓реЗрдХрд┐рди рд╡рд╣реА рдкрд╛рдпрдерди рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рд╕реМ рд░рди рдмрдирд╛рддрд╛ рд╣реИ рдереЛрдбрд╝рд╛ рдзреАрдорд╛: </p><br><pre> <code class="plaintext hljs">&gt; python test/sieve.py &gt; /dev/null 4.66692185402</code> </pre> <br><p>  4.5 рд╕реЗрдХрдВрдб, рдпрд╛ рдиреМ рдмрд╛рд░ рдзреАрдорд╛ред  рд╣рдореЗрдВ рдШреЗрдВрдЯрд╛ рдХреЛ рд╢реНрд░рджреНрдзрд╛рдВрдЬрд▓рд┐ рджреЗрдиреА рдЪрд╛рд╣рд┐рдП - рдЙрд╕рдХреЗ рдкрд╛рд╕ рдХреНрд╖рдорддрд╛ рд╣реИ!  рдареАрдХ рд╣реИ, рдЕрдм рджреЗрдЦрддреЗ рд╣реИрдВ рдХрд┐ рдХреНрдпрд╛ рд╣рдорд╛рд░реЗ рд╕реБрдЕрд░ рдкреНрд░реЗрд╕ рдХреЛ рдкрдВрдк рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред <br><img src="https://habrastorage.org/webt/ce/eq/ni/ceeqnik6-41cuvd3rwvkkuquoes.jpeg"></p><br><h1 id="uprazhnenie-pervoe-staticheskie-superinstrukcii">  рд╡реНрдпрд╛рдпрд╛рдо рдПрдХ: рд╕реНрдЯреЗрдЯрд┐рдХ рд╕реБрдкрд░рд┐рдирд╕реНрдЯреНрд░рдХреНрд╢рди </h1><br><p>  рдлрд╛рд╕реНрдЯ рдХреЛрдб рдХрд╛ рдкрд╣рд▓рд╛ рдирд┐рдпрдо рдмрд╣реБрдд рдЕрдзрд┐рдХ рдХрд╛рдо рдирд╣реАрдВ рдХрд░рдирд╛ рд╣реИред  рдлрд╛рд╕реНрдЯ рдХреЛрдб рдХрд╛ рджреВрд╕рд░рд╛ рдирд┐рдпрдо рдпрд╣ рд╣реИ рдХрд┐ рдХрднреА рднреА рдмрд╣реБрдд рдЕрдзрд┐рдХ рдХрд╛рдо рди рдХрд░реЗрдВред  рддреЛ рдкрд┐рдЧрд▓реЗрдЯ рд╡реАрдПрдо рдХрд┐рд╕ рддрд░рд╣ рдХрд╛ рдЕрддрд┐рд░рд┐рдХреНрдд рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ? </p><br><p>  рдЕрд╡рд▓реЛрдХрди рдПрдХ: рд╣рдорд╛рд░реЗ рдХрд╛рд░реНрдпрдХреНрд░рдо рдХреА рд░реВрдкрд░реЗрдЦрд╛ рд╕реЗ рдкрддрд╛ рдЪрд▓рддрд╛ рд╣реИ рдХрд┐ рдирд┐рд░реНрджреЗрд╢реЛрдВ рдХреЗ рдЕрдиреБрдХреНрд░рдо рд╣реИрдВ рдЬреЛ рджреВрд╕рд░реЛрдВ рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рдЕрдзрд┐рдХ рд╕рд╛рдорд╛рдиреНрдп рд╣реИрдВред  рд╣рдо рдЕрдкрдиреЗ рд╕реБрдЕрд░ рдХреЛ рдЕрдзрд┐рдХ рдкреАрдбрд╝рд╛ рдирд╣реАрдВ рджреЗрдВрдЧреЗ рдФрд░ рдЦреБрдж рдХреЛ рд╕рд┐рд░реНрдл рдПрдХ-рджреЛ рдирд┐рд░реНрджреЗрд╢реЛрдВ рддрдХ рд╕реАрдорд┐рдд рд░рдЦреЗрдВрдЧреЗ: </p><br><ol><li>  LOADI 0, ADD - рд╕реНрдЯреИрдХ рдХреЛ рдореЗрдореЛрд░реА 0 рд╕реЗ рдирдВрдмрд░ 0 рдкрд░ рд░рдЦреЗрдВ рдФрд░ рдЗрд╕реЗ рд╕реНрдЯреИрдХ рдХреЗ рд╢реАрд░реНрд╖ рдкрд░ рд╕реНрдерд┐рдд рд╕рдВрдЦреНрдпрд╛ рдореЗрдВ рдЬреЛрдбрд╝реЗрдВред </li><li>  PUSHI 65536, GREATER_OR_EQUAL - рд╕реНрдЯреИрдХ рдкрд░ рдПрдХ рд╕рдВрдЦреНрдпрд╛ рдбрд╛рд▓реЗрдВ рдФрд░ рдЙрд╕ рд╕рдВрдЦреНрдпрд╛ рдХреЗ рд╕рд╛рде рддреБрд▓рдирд╛ рдХрд░реЗрдВ рдЬреЛ рдкрд╣рд▓реЗ рд╕реНрдЯреИрдХ рдХреЗ рд╢реАрд░реНрд╖ рдкрд░ рдереА, рддреБрд▓рдирд╛ (0 рдпрд╛ 1) рдХрд╛ рдкрд░рд┐рдгрд╛рдо рд╕реНрдЯреИрдХ рдкрд░ рд╡рд╛рдкрд╕ рдбрд╛рд▓ рджрд┐рдпрд╛ред </li><li>  PUSHI 1, ADD - рд╕реНрдЯреИрдХ рдкрд░ рдПрдХ рд╕рдВрдЦреНрдпрд╛ рдбрд╛рд▓реЗрдВ, рдЗрд╕реЗ рдЙрд╕ рд╕рдВрдЦреНрдпрд╛ рдореЗрдВ рдЬреЛрдбрд╝реЗрдВ рдЬреЛ рдкрд╣рд▓реЗ рд╕реНрдЯреИрдХ рдХреЗ рд╢реАрд░реНрд╖ рдкрд░ рдереА, рдФрд░ рд╕реНрдЯреИрдХ рдкрд░ рдЬреЛрдбрд╝ рдХреЗ рдкрд░рд┐рдгрд╛рдо рдХреЛ рд╡рд╛рдкрд╕ рдбрд╛рд▓ рджрд┐рдпрд╛ред </li></ol><br><p>  рдкрд┐рдЧрд▓реЗрдЯ рд╡реАрдПрдо рдорд╢реАрди рдореЗрдВ 20 рд╕реЗ рдЕрдзрд┐рдХ рдирд┐рд░реНрджреЗрд╢ рд╣реИрдВ, рдФрд░ рдПрдХ рдкреВрд░реЗ рдмрд╛рдЗрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдПрдиреНрдХреЛрдбрд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ - 256 рдорд╛рдиред  рдирдП рдирд┐рд░реНрджреЗрд╢реЛрдВ рдХрд╛ рдкрд░рд┐рдЪрдп рджреЗрдирд╛ рдХреЛрдИ рд╕рдорд╕реНрдпрд╛ рдирд╣реАрдВ рд╣реИред  рд╣рдо рдХреНрдпрд╛ рдХрд░реЗрдВрдЧреЗ: </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (;;) { <span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span> instruction = NEXT_OP(); <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (instruction) { <span class="hljs-comment"><span class="hljs-comment">/* * Other instructions here * */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> OP_LOADADDI: { <span class="hljs-comment"><span class="hljs-comment">/* get immediate argument as an memory address , add it to value from the address to the top * of the stack */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> addr = NEXT_ARG(); <span class="hljs-keyword"><span class="hljs-keyword">uint64_t</span></span> val = vm.memory[addr]; *TOS_PTR() += val; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> OP_GREATER_OR_EQUALI:{ <span class="hljs-comment"><span class="hljs-comment">/* get the immediate argument, compare it with the value from the address to the top of the stack */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">uint64_t</span></span> arg_right = NEXT_ARG(); *TOS_PTR() = PEEK() &gt;= arg_right; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> OP_ADDI: { <span class="hljs-comment"><span class="hljs-comment">/* Add immediate value to the top of the stack */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> arg_right = NEXT_ARG(); *TOS_PTR() += arg_right; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } <span class="hljs-comment"><span class="hljs-comment">/* * Other instructions here * */</span></span> }</code> </pre><br><p>  рдХреБрдЫ рднреА рдЬрдЯрд┐рд▓ рдирд╣реАрдВ рд╣реИред  рдЖрдЗрдпреЗ рджреЗрдЦрддреЗ рд╣реИрдВ рдХреНрдпрд╛ рдЖрдпрд╛: </p><br><pre> <code class="plaintext hljs">&gt; ./pigletvm runtimes test/sieve.bin 100 &gt; /dev/null PROFILE: switch code finished took 410ms</code> </pre> <br><p>  рд╡рд╛рд╣!  рдХреЛрдб рдХреЗрд╡рд▓ рддреАрди рдирдП рдирд┐рд░реНрджреЗрд╢реЛрдВ рдХреЗ рд▓рд┐рдП рд╣реИ, рдФрд░ рд╣рдордиреЗ рдбреЗрдврд╝ рд╕реМ рдорд┐рд▓реАрд╕реЗрдХрдВрдб рдЬреАрддреЗ! </p><br><p>  рдЗрд╕ рддрдереНрдп рдХреЗ рдХрд╛рд░рдг рдпрд╣рд╛рдВ рд▓рд╛рдн рдкреНрд░рд╛рдкреНрдд рд╣реЛрддрд╛ рд╣реИ рдХрд┐ рдЗрд╕ рддрд░рд╣ рдХреЗ рдирд┐рд░реНрджреЗрд╢реЛрдВ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рддреЗ рд╕рдордп рд╣рдорд╛рд░рд╛ рдЧреБрд▓реНрд▓рдХ рдЕрдирд╛рд╡рд╢реНрдпрдХ рдЖрдВрджреЛрд▓рдиреЛрдВ рдХреЛ рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ: рдирд┐рд╖реНрдкрд╛рджрди рдХрд╛ рдзрд╛рдЧрд╛ рдореБрдЦреНрдп рд▓реВрдк рдореЗрдВ рдирд╣реАрдВ рдЧрд┐рд░рддрд╛ рд╣реИ, рдХреБрдЫ рднреА рдбрд┐рдХреЛрдб рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдФрд░ рдирд┐рд░реНрджреЗрд╢реЛрдВ рдХреЗ рддрд░реНрдХ рдПрдХ рдмрд╛рд░ рдлрд┐рд░ рд╕реНрдЯреИрдХ рд╕реЗ рдирд╣реАрдВ рдЧреБрдЬрд░рддреЗ рд╣реИрдВред </p><br><p>  рдЗрд╕реЗ рд╕реНрдерд┐рд░ рд╕реБрдкрд░рдЗрдВрд╕реНрдЯреНрд░рдХреНрд╢рди рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдЕрддрд┐рд░рд┐рдХреНрдд рдирд┐рд░реНрджреЗрд╢ рд╕реНрдЯреЗрдЯрд┐рдХ рд░реВрдк рд╕реЗ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ, рдЕрд░реНрдерд╛рдд рд╡рд┐рдХрд╛рд╕ рдХреЗ рдЪрд░рдг рдореЗрдВ рд╡рд░реНрдЪреБрдЕрд▓ рдорд╢реАрди рдкреНрд░реЛрдЧреНрд░рд╛рдорд░ рджреНрд╡рд╛рд░рд╛ред  рдпрд╣ рдПрдХ рд╕рд░рд▓ рдФрд░ рдкреНрд░рднрд╛рд╡реА рддрдХрдиреАрдХ рд╣реИ рдЬрд┐рд╕реЗ рдкреНрд░реЛрдЧреНрд░рд╛рдорд┐рдВрдЧ рднрд╛рд╖рд╛рдУрдВ рдХреА рд╕рднреА рдЖрднрд╛рд╕реА рдорд╢реАрдиреЗрдВ рдПрдХ рдпрд╛ рджреВрд╕рд░реЗ рд░реВрдк рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд░рддреА рд╣реИрдВред </p><br><p>  рд╕реНрдереИрддрд┐рдХ рд╕реБрдкрд░рд┐рдирд╕реНрдЯреНрд░рдХреНрд╢рди рдХреЗ рд╕рд╛рде рдореБрдЦреНрдп рд╕рдорд╕реНрдпрд╛ рдпрд╣ рд╣реИ рдХрд┐ рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдХрд╛рд░реНрдпрдХреНрд░рдо рдХреЗ рдмрд┐рдирд╛ рдпрд╣ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдирд╛ рдЕрд╕рдВрднрд╡ рд╣реИ рдХрд┐ рдХрд┐рди рдирд┐рд░реНрджреЗрд╢реЛрдВ рдХреЛ рд╕рдВрдпреЛрдЬрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред  рд╡рд┐рднрд┐рдиреНрди рдХрд╛рд░реНрдпрдХреНрд░рдо рдирд┐рд░реНрджреЗрд╢реЛрдВ рдХреЗ рд╡рд┐рднрд┐рдиреНрди рдЕрдиреБрдХреНрд░рдореЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ, рдФрд░ рдЖрдк рдХреЗрд╡рд▓ рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдХреЛрдб рд▓реЙрдиреНрдЪ рдХрд░рдиреЗ рдХреЗ рдЪрд░рдг рдореЗрдВ рдЗрди рдЕрдиреБрдХреНрд░рдореЛрдВ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛ рд╕рдХрддреЗ рд╣реИрдВред </p><br><p>  рдЕрдЧрд▓рд╛ рдХрджрдо рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдХрд╛рд░реНрдпрдХреНрд░рдо рдХреЗ рд╕рдВрджрд░реНрдн рдореЗрдВ рд╕реБрдкрд░рдЗрдВрд╕реНрдЯреНрд░рдХреНрд╢рди рдХрд╛ рдЧрддрд┐рд╢реАрд▓ рд╕рдВрдХрд▓рди рд╣реЛ рд╕рдХрддрд╛ рд╣реИ, рдЕрд░реНрдерд╛рдд, рдбрд╛рдпрдирд╛рдорд┐рдХ рд╕реБрдкрд░рд┐рдирд╕реНрдЯреНрд░рдХреНрд╢рди (90 рдФрд░ 2000 рдХреЗ рджрд╢рдХ рдХреА рд╢реБрд░реБрдЖрдд рдореЗрдВ, рдЗрд╕ рддрдХрдиреАрдХ рдиреЗ рдПрдХ рдЖрджрд┐рдо JIT рд╕рдВрдХрд▓рди рдХреА рднреВрдорд┐рдХрд╛ рдирд┐рднрд╛рдИ рдереА)ред </p><br><p>  рд╕рд╛рдзрд╛рд░рдг рд╕реА рдХреЗ рдврд╛рдВрдЪреЗ рдореЗрдВ рдордХреНрдЦреА рдкрд░ рдирд┐рд░реНрджреЗрд╢ рдмрдирд╛рдирд╛ рдЕрд╕рдВрднрд╡ рд╣реИ, рдФрд░ рд╣рдорд╛рд░реЗ рдЧреБрд▓реНрд▓рдХ рдХрд╛рдлреА рд╣рдж рддрдХ рдЗрд╕реЗ рдПрдХ рдИрдорд╛рдирджрд╛рд░ рдкреНрд░рддрд┐рдпреЛрдЧрд┐рддрд╛ рдирд╣реАрдВ рдорд╛рдирддреЗ рд╣реИрдВред  рд╕реМрднрд╛рдЧреНрдп рд╕реЗ, рдореЗрд░реЗ рдкрд╛рд╕ рдЙрд╕рдХреЗ рд▓рд┐рдП рдХреБрдЫ рдмреЗрд╣рддрд░ рдЕрднреНрдпрд╛рд╕ рд╣реИрдВред </p><br><h1 id="uprazhnenie-vtoroe-proverka-intervala-znacheniy-opkodov">  рд╡реНрдпрд╛рдпрд╛рдо рджреЛ: opcode рдореВрд▓реНрдпреЛрдВ рдХреА рд╕реАрдорд╛ рдХреА рдЬрд╛рдБрдЪ </h1><br><p>  рд╣рдорд╛рд░реЗ рддреНрд╡рд░рд┐рдд рдХреЛрдб рдирд┐рдпрдореЛрдВ рдХрд╛ рдкрд╛рд▓рди рдХрд░рддреЗ рд╣реБрдП, рдПрдХ рдмрд╛рд░ рдлрд┐рд░ рд╣рдо рдЕрдкрдиреЗ рдЖрдк рд╕реЗ рд╢рд╛рд╢реНрд╡рдд рдкреНрд░рд╢реНрди рдкреВрдЫрддреЗ рд╣реИрдВ: рдЖрдк рдХреНрдпрд╛ рдирд╣реАрдВ рдХрд░ рд╕рдХрддреЗ? </p><br><p>  рдЬрдм рд╣рдо рдкрд┐рдЧрд▓реЗрдЯ рд╡реАрдПрдо рдорд╢реАрди рдХреЗ рдЙрдкрдХрд░рдг рд╕реЗ рдкрд░рд┐рдЪрд┐рдд рд╣реЛ рдЧрдП, рддреЛ рдореИрдВрдиреЗ рдЙрди рд╕рднреА рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рд╕реВрдЪреАрдмрджреНрдз рдХрд┐рдпрд╛ рдЬреЛ рд╡рд░реНрдЪреБрдЕрд▓ рдорд╢реАрди рдкреНрд░рддреНрдпреЗрдХ рдУрдкреЛрдб рдХреЗ рд▓рд┐рдП рдХрд░рддреА рд╣реИред  рдФрд░ рдмрд┐рдВрджреБ 2 (рд╕реНрд╡рд┐рдЪ рдорд╛рдиреЛрдВ рдХреА рд╡реИрдз рд╕реАрдорд╛ рдореЗрдВ рдлрд┐рдЯ рд╣реЛрдиреЗ рдХреЗ рд▓рд┐рдП рдУрдкрдХреЛрдб рдХреЗ рдореВрд▓реНрдп рдХреА рдЬрд╛рдВрдЪ рдХрд░рдирд╛) рд╕рдмрд╕реЗ рд╕рдВрджрд┐рдЧреНрдз рд╣реИред </p><br><p>  рдЖрдЗрдП рдПрдХ рдирдЬрд░ рдбрд╛рд▓рддреЗ рд╣реИрдВ рдХрд┐ GCC рд╕реНрд╡рд┐рдЪ рдирд┐рд░реНрдорд╛рдг рдХреЛ рдХреИрд╕реЗ рд╕рдВрдХрд▓рд┐рдд рдХрд░рддрд╛ рд╣реИ: </p><br><ol><li>  рдПрдХ рд╕рдВрдХреНрд░рдордг рддрд╛рд▓рд┐рдХрд╛ рдХрд╛ рдирд┐рд░реНрдорд╛рдг рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЕрд░реНрдерд╛рддреН, рдПрдХ рддрд╛рд▓рд┐рдХрд╛ рдЬреЛ рдирд┐рд░реНрджреЗрд╢ рдХреЗ рд╢рд░реАрд░ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдХреЛрдб рдХреЗ рдкрддреЗ рдкрд░ рдУрдкрдХреЛрдб рдХреЗ рдореВрд▓реНрдп рдХреЛ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рддреА рд╣реИред </li><li>  рдПрдХ рдХреЛрдб рдбрд╛рд▓рд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬреЛ рдпрд╣ рдЬрд╛рдВрдЪрддрд╛ рд╣реИ рдХрд┐ рдкреНрд░рд╛рдкреНрдд рдУрдкрдХреЛрдб рд╕рднреА рд╕рдВрднрд╡ рд╕реНрд╡рд┐рдЪ рдореВрд▓реНрдпреЛрдВ рдХреА рд╕реАрдорд╛ рдХреЗ рднреАрддрд░ рд╣реИ рдпрд╛ рдирд╣реАрдВ рдФрд░ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд▓реЗрдмрд▓ рдкрд░ рднреЗрдЬрддрд╛ рд╣реИ рдпрджрд┐ рдУрдкрдХреЛрдб рдХреЗ рд▓рд┐рдП рдХреЛрдИ рд╣реИрдВрдбрд▓рд░ рдирд╣реАрдВ рд╣реИред </li><li>  рд╣реИрдВрдбрд▓рд░ рдореЗрдВ рдЬрд╛рдиреЗ рд╡рд╛рд▓рд╛ рдХреЛрдб рдбрд╛рд▓рд╛ рдЬрд╛рддрд╛ рд╣реИред </li></ol><br><p>  рд▓реЗрдХрд┐рди рдкреНрд░рддреНрдпреЗрдХ рдирд┐рд░реНрджреЗрд╢ рдХреЗ рд▓рд┐рдП рдореВрд▓реНрдпреЛрдВ рдХреЗ рдЕрдВрддрд░рд╛рд▓ рдХреА рдЬрд╛рдВрдЪ рдХреНрдпреЛрдВ рдХреА рдЬрд╛рддреА рд╣реИ?  рд╣рдо рдорд╛рдирддреЗ рд╣реИрдВ рдХрд┐ рдУрдкреЗрдХ рдпрд╛ рддреЛ рд╕рд╣реА рд╣реИ - OP_DONE рдирд┐рд░реНрджреЗрд╢ рджреНрд╡рд╛рд░рд╛ рдирд┐рд╖реНрдкрд╛рджрди рдХреЛ рд╕рдорд╛рдкреНрдд рдХрд░рдирд╛, рдпрд╛ рдЧрд▓рдд - рдмрд╛рдпрдЯреЗрдХреЛрдб рд╕реЗ рдкрд░реЗ рдЬрд╛рдирд╛ред  рдУрдкрдХреЛрдб рд╕реНрдЯреНрд░реАрдо рдХреА рдкреВрдВрдЫ рд╢реВрдиреНрдп рдХреЗ рд╕рд╛рде рдЪрд┐рд╣реНрдирд┐рдд рд╣реИ, рдФрд░ рд╢реВрдиреНрдп OP_ABORT рдирд┐рд░реНрджреЗрд╢ рдХрд╛ рдСрдкрдХреЛрдб рд╣реИ, рдЬреЛ рдПрдХ рддреНрд░реБрдЯрд┐ рдХреЗ рд╕рд╛рде рдмрд╛рдпрдЯреЗрдХреЛрдб рдХреЗ рдирд┐рд╖реНрдкрд╛рджрди рдХреЛ рдкреВрд░рд╛ рдХрд░рддрд╛ рд╣реИред </p><br><p>  рдпрд╣ рдкрддрд╛ рдЪрд▓рд╛ рд╣реИ рдХрд┐ рдЗрд╕ рдЪреЗрдХ рдХреА рдмрд┐рд▓реНрдХреБрд▓ рдЬрд╝рд░реВрд░рдд рдирд╣реАрдВ рд╣реИ!  рдФрд░ рдкрд┐рдЧреЗрдЯ рдХреЛ рдЗрд╕ рд╡рд┐рдЪрд╛рд░ рдХреЛ рд╕рдВрдХрд▓рдХ рддрдХ рдкрд╣реБрдВрдЪрд╛рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред  рдЖрдЗрдП рдореБрдЦреНрдп рд╕реНрд╡рд┐рдЪ рдХреЛ рдереЛрдбрд╝рд╛ рдареАрдХ рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ: </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span> instruction = NEXT_OP(); <span class="hljs-comment"><span class="hljs-comment">/* Let the compiler know that opcodes are always between 0 and 31 */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (instruction &amp; <span class="hljs-number"><span class="hljs-number">0x1f</span></span>) { <span class="hljs-comment"><span class="hljs-comment">/* All the instructions here */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">26</span></span> ... <span class="hljs-number"><span class="hljs-number">0x1f</span></span>: { <span class="hljs-comment"><span class="hljs-comment">/*Handle the remaining 5 non-existing opcodes*/</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ERROR_UNKNOWN_OPCODE; } }</code> </pre> <br><p>  рдпрд╣ рдЬрд╛рдирддреЗ рд╣реБрдП рдХрд┐ рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдХреЗрд╡рд▓ 26 рдирд┐рд░реНрджреЗрд╢ рд╣реИрдВ, рд╣рдо рдПрдХ рдмрд┐рдЯ рдорд╛рд╕реНрдХ рд▓рдЧрд╛рддреЗ рд╣реИрдВ (рдУрдкрд▓ рдореВрд▓реНрдп 0x1f рдПрдХ рджреНрд╡рд┐рдЖрдзрд╛рд░реА 0b11111 рд╣реИ рдЬреЛ рдУрдкрдХреЛрдб рдкрд░ рдорд╛рдиреЛрдВ рдХреА рд╕реАрдорд╛ рдХреЛ 0 рд╕реЗ 31 рддрдХ рдХрд╡рд░ рдХрд░рддрд╛ рд╣реИ) рдФрд░ 26 рд╕реЗ 31 рдХреЗ рдмреАрдЪ рдЕрдкреНрд░рдпреБрдХреНрдд рдорд╛рдиреЛрдВ рдореЗрдВ рд╣реИрдВрдбрд▓рд░ рдЬреЛрдбрд╝рддреЗ рд╣реИрдВред </p><br><p>  рдмрд┐рдЯ рдирд┐рд░реНрджреЗрд╢ x86 рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░ рдореЗрдВ рдХреБрдЫ рд╕рдмрд╕реЗ рд╕рд╕реНрддреЗ рд╣реИрдВ, рдФрд░ рд╡реЗ рдирд┐рд╢реНрдЪрд┐рдд рд░реВрдк рд╕реЗ рд╕рдорд╕реНрдпрд╛рдЧреНрд░рд╕реНрдд рд╕рд╢рд░реНрдд рд╢рд╛рдЦрд╛рдУрдВ рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рд╕рд╕реНрддреЗ рд╣реИрдВ рдЬреИрд╕реЗ рдХрд┐ рдЕрдВрддрд░рд╛рд▓ рдЬрд╛рдБрдЪ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред  рд╕реИрджреНрдзрд╛рдВрддрд┐рдХ рд░реВрдк рд╕реЗ, рд╣рдореЗрдВ рдкреНрд░рддреНрдпреЗрдХ рдирд┐рд╖реНрдкрд╛рджрди рдпреЛрдЧреНрдп рдирд┐рд░реНрджреЗрд╢ рдкрд░ рдХрдИ рдЪрдХреНрд░ рдЬреАрддрдиреЗ рдЪрд╛рд╣рд┐рдП, рдпрджрд┐ рдХрдВрдкрд╛рдЗрд▓рд░ рд╣рдорд╛рд░реЗ рд╕рдВрдХреЗрдд рдХреЛ рд╕рдордЭрддрд╛ рд╣реИред </p><br><p>  рд╡реИрд╕реЗ, рдорд╛рдорд▓реЗ рдореЗрдВ рдореВрд▓реНрдпреЛрдВ рдХреА рд╕реАрдорд╛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рдиреЗ рдХрд╛ рддрд░реАрдХрд╛ рдорд╛рдирдХ рд╕реА рдирд╣реАрдВ рд╣реИ, рд▓реЗрдХрд┐рди рдЬреАрд╕реАрд╕реА рд╡рд┐рд╕реНрддрд╛рд░ рд╣реИред  рд▓реЗрдХрд┐рди рд╣рдорд╛рд░реЗ рдЙрджреНрджреЗрд╢реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП рдпрд╣ рдХреЛрдб рдЙрдкрдпреБрдХреНрдд рд╣реИ, рдЦрд╛рд╕рдХрд░ рдЬрдм рд╕реЗ рдкреНрд░рддреНрдпреЗрдХ рдЕрдирд╛рд╡рд╢реНрдпрдХ рдореВрд▓реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП рдЗрд╕реЗ рдХрдИ рд╣реИрдВрдбрд▓рд░ рдореЗрдВ рд░реАрдореЗрдХ рдХрд░рдирд╛ рдореБрд╢реНрдХрд┐рд▓ рдирд╣реАрдВ рд╣реИред </p><br><p>  рд╣рдо рдХреЛрд╢рд┐рд╢ рдХрд░рддреЗ рд╣реИрдВ: </p><br><pre> <code class="plaintext hljs">&gt; ./pigletvm runtimes test/sieve.bin 100 &gt; /dev/null PROFILE: switch code finished took 437ms PROFILE: switch code (no range check) finished took 383ms</code> </pre> <br><p>  рдПрдХ рдФрд░ 50 рдорд┐рд▓реАрд╕реЗрдХрдВрдб!  рдШреЗрдВрдЯрд╛, рдРрд╕рд╛ рд▓рдЧрддрд╛ рд╣реИ рдЬреИрд╕реЗ рдЖрдкрдиреЗ рдЦреБрдж рдХреЛ рдЕрдкрдиреЗ рдХрдВрдзреЛрдВ рдореЗрдВ рд╕реБрдирд╛ рд╣реИ! " </p><br><h1 id="uprazhnenie-trete-trassy">  рд╡реНрдпрд╛рдпрд╛рдо рддреАрди: рдЯреНрд░реЗрд▓реНрд╕ </h1><br><p>  рдХреНрдпрд╛ рдЕрдиреНрдп рдЕрднреНрдпрд╛рд╕ рд╣рдорд╛рд░реЗ рдкрд┐рдЧрд▓реЗрдЯ рдХреА рдорджрдж рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ?  рд╕реБрдкрд░ рдирд┐рд░реНрджреЗрд╢реЛрдВ рдХреЗ рд▓рд┐рдП рд╣рдореЗрдВ рд╕рдмрд╕реЗ рдмрдбрд╝реА рдмрдЪрдд рдорд┐рд▓реАред  рдФрд░ рд╡реЗ рдореБрдЦреНрдп рдЪрдХреНрд░ рд╕реЗ рдмрд╛рд╣рд░ рдирд┐рдХрд▓рдиреЗ рдХреА рд╕рдВрдЦреНрдпрд╛ рдХреЛ рдХрдо рдХрд░рддреЗ рд╣реИрдВ рдФрд░ рдЖрдкрдХреЛ рдЗрд╕реА рдУрд╡рд░рд╣реЗрдб рд▓рд╛рдЧрдд рд╕реЗ рдЫреБрдЯрдХрд╛рд░рд╛ рдкрд╛рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреЗ рд╣реИрдВред </p><br><p>  рдирд┐рд░реНрджреЗрд╢реЛрдВ рдХреЗ рдЕрд╕рд╛рдзрд╛рд░рдг рдирд┐рд╖реНрдкрд╛рджрди рдХреЗ рд╕рд╛рде рдХрд┐рд╕реА рднреА рдкреНрд░реЛрд╕реЗрд╕рд░ рдХреЗ рд▓рд┐рдП рдХреЗрдВрджреНрд░реАрдп рд╕реНрд╡рд┐рдЪ рдореБрдЦреНрдп рд╕рдорд╕реНрдпрд╛ рд╕реНрдерд╛рди рд╣реИред  рдЖрдзреБрдирд┐рдХ рд╢рд╛рдЦрд╛ рдХреЗ рднрд╡рд┐рд╖реНрдпрд╡рдХреНрддрд╛рдУрдВ рдиреЗ рдЗрд╕ рддрд░рд╣ рдХреЗ рдЬрдЯрд┐рд▓ рдЕрдкреНрд░рддреНрдпрдХреНрд╖ рдмрджрд▓рд╛рд╡реЛрдВ рдХреА рднреА рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдХрд░рдирд╛ рд╕реАрдЦ рд▓рд┐рдпрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдХреЛрдб рдХреЗ рд╕рд╛рде "рд╕реНрдореАрдпрд░рд┐рдВрдЧ" рд╢рд╛рдЦрд╛ рдЕрдВрдХ рдкреНрд░реЛрд╕реЗрд╕рд░ рдХреЛ рдирд┐рд░реНрджреЗрд╢ рд╕реЗ рдирд┐рд░реНрджреЗрд╢ рдкрд░ рдЬрд▓реНрджреА рд╕реЗ рд╕реНрд╡рд┐рдЪ рдХрд░рдиреЗ рдореЗрдВ рдорджрдж рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред </p><br><p>  рдПрдХ рдФрд░ рд╕рдорд╕реНрдпрд╛ рд╣реИ рдмрд╛рдЗрдЯ-рдмрд╛рдп-рдмрд╛рдпрдЯ рд░реАрдбрд┐рдВрдЧ рдСрдлрд╝рд┐рд╕ рдУрдкрдХреЛрдбреНрд╕ рдФрд░ рд╕реАрдзреЗ рддрд░реНрдХреЛрдВ рдХреЛ рдмрд╛рдпрдЯреЗрдХреЛрдб рд╕реЗред  рднреМрддрд┐рдХ рдорд╢реАрдиреЗрдВ 64-рдмрд┐рдЯ рдорд╢реАрди рд╢рдмреНрдж рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рддреА рд╣реИрдВ рдФрд░ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдЗрд╕реЗ рдкрд╕рдВрдж рдирд╣реАрдВ рдХрд░рддреА рд╣реИрдВ рдЬрдм рдХреЛрдб рдХрдо рдореВрд▓реНрдпреЛрдВ рдХреЗ рд╕рд╛рде рд╕рдВрдЪрд╛рд▓рд┐рдд рд╣реЛрддрд╛ рд╣реИред </p><br><p>  рдХрдВрдкрд╛рдЗрд▓рд░ рдЕрдХреНрд╕рд░ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдмреБрдирд┐рдпрд╛рджреА рдмреНрд▓реЙрдХреЛрдВ рдХреЗ</a> рд╕рд╛рде рдХрд╛рдо <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдХрд░рддреЗ рд╣реИрдВ</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЕрд░реНрдерд╛рддреН</a> , рдмрд┐рдирд╛ рд╢рд╛рдЦрд╛рдУрдВ рдФрд░ рд▓реЗрдмрд▓ рдХреЗ рдирд┐рд░реНрджреЗрд╢реЛрдВ рдХрд╛ рдЕрдиреБрдХреНрд░рдоред  рдмреЗрд╕ рдмреНрд▓реЙрдХ рдпрд╛ рддреЛ рдкреНрд░реЛрдЧреНрд░рд╛рдо рдХреА рд╢реБрд░реБрдЖрдд рд╕реЗ рдпрд╛ рд▓реЗрдмрд▓ рд╕реЗ рд╢реБрд░реВ рд╣реЛрддрд╛ рд╣реИ, рдФрд░ рдкреНрд░реЛрдЧреНрд░рд╛рдо рдХреЗ рдЕрдВрдд рдХреЗ рд╕рд╛рде рд╕рдорд╛рдкреНрдд рд╣реЛрддрд╛ рд╣реИ, рд╕рд╢рд░реНрдд рдмреНрд░рд╛рдВрдЪрд┐рдВрдЧ рдпрд╛ рдЕрдЧрд▓реЗ рдмреЗрд╕ рдмреНрд▓реЙрдХ рдХреЛ рд╢реБрд░реВ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рд▓реЗрдмрд▓ рдкрд░ рд╕реАрдзрд╛ рдХреВрджрддрд╛ рд╣реИред </p><br><p>  рдЖрдзрд╛рд░ рдЗрдХрд╛рдЗрдпреЛрдВ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рдХрдИ рдлрд╛рдпрджреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рд╣рдорд╛рд░реЗ рд╕реБрдЕрд░ рдЗрд╕рдХреА рдкреНрд░рдореБрдЦ рд╡рд┐рд╢реЗрд╖рддрд╛ рдореЗрдВ рд░реБрдЪрд┐ рд░рдЦрддреЗ рд╣реИрдВ: рдЖрдзрд╛рд░ рдЗрдХрд╛рдИ рдХреЗ рднреАрддрд░ рдирд┐рд░реНрджреЗрд╢реЛрдВ рдХреЛ рдХреНрд░рдорд┐рдХ рд░реВрдк рд╕реЗ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рдХрд┐рд╕реА рднреА рддрд░рд╣ рд╕реЗ рдЗрди рдмреЗрд╕ рдмреНрд▓реЙрдХ рдХреЛ рдЕрд▓рдЧ рдХрд░рдирд╛ рдФрд░ рдореБрдЦреНрдп рд▓реВрдк рдореЗрдВ рд╕рдордп рдмрд░реНрдмрд╛рдж рдХрд┐рдП рдмрд┐рдирд╛ рдирд┐рд░реНрджреЗрд╢реЛрдВ рдХрд╛ рдкрд╛рд▓рди рдХрд░рдирд╛ рдмрд╣реБрдд рдЕрдЪреНрдЫрд╛ рд╣реЛрдЧрд╛ред </p><br><p>  рд╣рдорд╛рд░реЗ рдорд╛рдорд▓реЗ рдореЗрдВ, рдЖрдк рдмреЗрд╕ рдпреВрдирд┐рдЯ рдХреА рдкрд░рд┐рднрд╛рд╖рд╛ рдХреЛ рдЯреНрд░реИрдХ рддрдХ рднреА рдмрдврд╝рд╛ рд╕рдХрддреЗ рд╣реИрдВред  рдкрд┐рдЧрд▓реЗрдЯ рд╡реАрдПрдо рдорд╢реАрди рдХреЗ рд╕рдВрджрд░реНрдн рдореЗрдВ рдЯреНрд░реИрдХ рдореЗрдВ рд╕рднреА рдХреНрд░рдорд┐рдХ рд░реВрдк рд╕реЗ рдЬреБрдбрд╝реЗ (рдпрд╛рдиреА рдмрд┐рдирд╛ рд╢рд░реНрдд рдХреВрдж рдХрд╛ рдЙрдкрдпреЛрдЧ) рдмреЗрд╕ рдмреНрд▓реЙрдХ рд╢рд╛рдорд┐рд▓ рд╣реЛрдВрдЧреЗред </p><br><p>  рдирд┐рд░реНрджреЗрд╢реЛрдВ рдХреЗ рдХреНрд░рдорд┐рдХ рдирд┐рд╖реНрдкрд╛рджрди рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдирд┐рд░реНрджреЗрд╢реЛрдВ рдХреЗ рдкреНрд░рддреНрдпрдХреНрд╖ рддрд░реНрдХреЛрдВ рдХреЛ рдЕрдЧреНрд░рд┐рдо рд░реВрдк рд╕реЗ рдбрд┐рдХреЛрдб рдХрд░рдирд╛ рдЕрдЪреНрдЫрд╛ рд╣реЛрдЧрд╛ред </p><br><p>  рдпрд╣ рд╕рдм рдмрд╣реБрдд рдбрд░рд╛рд╡рдирд╛ рд▓рдЧрддрд╛ рд╣реИ рдФрд░ рдПрдХ рдЧрддрд┐рд╢реАрд▓ рд╕рдВрдХрд▓рди рдЬреИрд╕рд╛ рджрд┐рдЦрддрд╛ рд╣реИ, рдЬрд┐рд╕реЗ рд╣рдордиреЗ рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд░рдиреЗ рдХрд╛ рдлреИрд╕рд▓рд╛ рдХрд┐рдпрд╛ред  рд╕реБрдЕрд░ рдиреЗ рднреА рдЕрдкрдиреА рддрд╛рдХрдд рдкрд░ рдереЛрдбрд╝рд╛ рд╕рдВрджреЗрд╣ рдХрд┐рдпрд╛, рд▓реЗрдХрд┐рди рд╡реНрдпрд╡рд╣рд╛рд░ рдореЗрдВ рдпрд╣ рдЗрддрдирд╛ рдмреБрд░рд╛ рдирд╣реАрдВ рдерд╛ред </p><br><p>  рдЖрдЗрдП рдкрд╣рд▓реЗ рдЗрд╕ рдмрд╛рд░реЗ рдореЗрдВ рд╕реЛрдЪреЗрдВ рдХрд┐ рдЖрдк рдЯреНрд░реИрдХ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рдирд┐рд░реНрджреЗрд╢ рдХреА рдХрд▓реНрдкрдирд╛ рдХреИрд╕реЗ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: </p><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">scode</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">uint64_t</span></span> arg; trace_op_handler *handler; };</code> </pre> <br><p>  рдпрд╣рд╛рдБ рдЖрд░реНрдЧ рдирд┐рд░реНрджреЗрд╢ рдХрд╛ рдкреВрд░реНрд╡-рдбрд┐рдХреЛрдбреЗрдб рддрд░реНрдХ рд╣реИ, рдФрд░ рд╣реИрдВрдбрд▓рд░ рдПрдХ рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рд╕реВрдЪрдХ рд╣реИ рдЬреЛ рдирд┐рд░реНрджреЗрд╢ рдХреЗ рддрд░реНрдХ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рддрд╛ рд╣реИред </p><br><p>  рдЕрдм рдкреНрд░рддреНрдпреЗрдХ рдЯреНрд░реЗрд╕ рдХрд╛ рджреГрд╢реНрдп рдЗрд╕ рддрд░рд╣ рджрд┐рдЦрддрд╛ рд╣реИ: </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">typedef</span></span> scode trace[MAX_TRACE_LEN];</code> </pre> <br><p>  рдЕрд░реНрдерд╛рддреН, рдПрдХ рдЯреНрд░реЗрд╕ рд╕реАрдорд┐рдд рд▓рдВрдмрд╛рдИ рдХреЗ рдПрд╕-рдХреЛрдб рдХрд╛ рдПрдХ рдХреНрд░рдо рд╣реИред  рд╡рд░реНрдЪреБрдЕрд▓ рдорд╢реАрди рдХреЗ рдЕрдВрджрд░ рдЯреНрд░реЗрд╕ рдХреИрд╢ рд╣реА рдЗрд╕ рддрд░рд╣ рджрд┐рдЦрддрд╛ рд╣реИ: </p><br><pre> <code class="cpp hljs">trace trace_cache[MAX_CODE_LEN];</code> </pre> <br><p>  рдпрд╣ рд╕рдВрднрд╡ рдмрд╛рдпреЛрдЯреЗрдХ рд▓рдВрдмрд╛рдИ рд╕реЗ рдЕрдзрд┐рдХ рдирд╣реАрдВ рд▓рдВрдмрд╛рдИ рдХреЗ рд╕рд╛рде рдирд┐рд╢рд╛рди рдХреА рдПрдХ рд╕рд░рдгреА рд╣реИред  рд╕рдорд╛рдзрд╛рди рдЖрд▓рд╕реА рд╣реИ, рд╕реНрдореГрддрд┐ рдХреЛ рдмрдЪрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдпрд╣ рдПрдХ рд╣реИрд╢ рддрд╛рд▓рд┐рдХрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдордЭ рдореЗрдВ рдЖрддрд╛ рд╣реИред </p><br><p>  рджреБрднрд╛рд╖рд┐рдпрд╛ рдХреА рд╢реБрд░реБрдЖрдд рдореЗрдВ, рдкреНрд░рддреНрдпреЗрдХ рдЯреНрд░реЗрд╕ рдХрд╛ рдкрд╣рд▓рд╛ рд╣реИрдВрдбрд▓рд░ рдЦреБрдж рдХреЛ рд╕рдВрдХрд▓рд┐рдд рдХрд░реЗрдЧрд╛: </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> trace_i = <span class="hljs-number"><span class="hljs-number">0</span></span>; trace_i &lt; MAX_CODE_LEN; trace_i++ ) vm_trace.trace_cache[trace_i][<span class="hljs-number"><span class="hljs-number">0</span></span>].handler = trace_compile_handler;</code> </pre> <br><p>  рдореБрдЦреНрдп рджреБрднрд╛рд╖рд┐рдпрд╛ рд▓реВрдк рдЕрдм рдЗрд╕ рддрд░рд╣ рджрд┐рдЦрддрд╛ рд╣реИ: </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(vm_trace.is_running) { scode *code = &amp;vm_trace.trace_cache[vm_trace.pc][<span class="hljs-number"><span class="hljs-number">0</span></span>]; code-&gt;handler(code); }</code> </pre> <br><p>  рдПрдХ рдЯреНрд░реЗрд╕ рдХрдореНрдкрд╛рдЗрд▓рд░ рдереЛрдбрд╝рд╛ рдЕрдзрд┐рдХ рдЬрдЯрд┐рд▓ рд╣реИ, рдФрд░ рд╡рд░реНрддрдорд╛рди рдирд┐рд░реНрджреЗрд╢ рд╕реЗ рд╢реБрд░реВ рд╣реЛрдиреЗ рд╡рд╛рд▓реЗ рдЯреНрд░реЗрд╕ рдХреЗ рдирд┐рд░реНрдорд╛рдг рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдпрд╣ рдирд┐рдореНрди рдХрд╛рд░реНрдп рдХрд░рддрд╛ рд╣реИ: </p><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">trace_compile_handler</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(scode *trace_head)</span></span></span><span class="hljs-function"> </span></span>{ scode *trace_tail = trace_head; <span class="hljs-comment"><span class="hljs-comment">/* * Trace building here */</span></span> <span class="hljs-comment"><span class="hljs-comment">/* now, run the chain that has a trace_compile_handler replaced with proper instruction handler * function pointer */</span></span> trace_head-&gt;handler(trace_head); }</code> </pre><br><p>  рд╕рд╛рдорд╛рдиреНрдп рдирд┐рд░реНрджреЗрд╢ рд╣реИрдВрдбрд▓рд░: </p><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">op_add_handler</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(scode *code)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">uint64_t</span></span> arg_right = POP(); *TOS_PTR() += arg_right; <span class="hljs-comment"><span class="hljs-comment">/* * Call the next trace handler * */</span></span> <span class="hljs-comment"><span class="hljs-comment">/* scodes are located in an array so we can use pointer arithmetic to get the next handler */</span></span> code++; code-&gt;handler(code); }</code> </pre> <br><p>  рдПрдХ рд╣реИрдВрдбрд▓рд░ рдЬреЛ рдлрд╝рдВрдХреНрд╢рди рдХреА рдкреВрдВрдЫ рдкрд░ рдХреЛрдИ рдХреЙрд▓ рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ, рдкреНрд░рддреНрдпреЗрдХ рдЯреНрд░реЗрд╕ рдХреЛ рд╕рдорд╛рдкреНрдд рдХрд░рддрд╛ рд╣реИ: </p><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">op_done_handler</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(scode *code)</span></span></span><span class="hljs-function"> </span></span>{ (<span class="hljs-keyword"><span class="hljs-keyword">void</span></span>) code; vm_trace.is_running = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; vm_trace.error = SUCCESS; }</code> </pre> <br><p>  рдпрд╣ рд╕рдм, рдЬрд╝рд╛рд╣рд┐рд░ рд╣реИ, рд╕реБрдкрд░рдЗрдВрд╕реНрдЯреНрд░рдХреНрд╢рди рдЬреЛрдбрд╝рдиреЗ рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрдЯрд┐рд▓ рд╣реИ, рд▓реЗрдХрд┐рди рджреЗрдЦрддреЗ рд╣реИрдВ рдХрд┐ рдХреНрдпрд╛ рдпрд╣ рд╣рдореЗрдВ рдХреБрдЫ рднреА рджреЗрддрд╛ рд╣реИ: </p><br><pre> <code class="plaintext hljs">&gt; ./pigletvm runtimes test/sieve.bin 100 &gt; /dev/null PROFILE: switch code finished took 427ms PROFILE: switch code (no range check) finished took 395ms PROFILE: trace code finished took 367ms</code> </pre> <br><p>  рд╣реБрд░реНрд░реЗ, рдПрдХ рдФрд░ 30 рдорд┐рд▓реАрд╕реЗрдХрдВрдб! </p><br><p>  рдРрд╕рд╛ рдХреИрд╕реЗ?  рдХреЗрд╡рд▓ рд▓реЗрдмрд▓ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдиреЗрд╡рд┐рдЧреЗрдЯ рдХрд░рдиреЗ рдХреЗ рдмрдЬрд╛рдп, рд╣рдо рдирд┐рд░реНрджреЗрд╢ рд╕рдВрдЪрд╛рд▓рдХреЛрдВ рдХреА рдХреЙрд▓ рд╢реНрд░реГрдВрдЦрд▓рд╛ рдмрдирд╛рддреЗ рд╣реИрдВ, рдХреЙрд▓ рдФрд░ рдкрд╛рд╕рд┐рдВрдЧ рддрд░реНрдХреЛрдВ рдкрд░ рд╕рдордп рдмрд┐рддрд╛рддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рд╣рдорд╛рд░рд╛ рдкрд┐рдЧреА рдЕрднреА рднреА рдЕрдкрдиреЗ рд▓реЗрдмрд▓ рдХреЗ рд╕рд╛рде рдПрдХ рд╕рд╛рдзрд╛рд░рдг рд╕реНрд╡рд┐рдЪ рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рддреЗрдЬреА рд╕реЗ рдкрдЯрд░рд┐рдпреЛрдВ рдХреЗ рд╕рд╛рде рдЪрд▓рддрд╛ рд╣реИред </p><br><p>  рдЯреНрд░реИрдХ рдкреНрд░рджрд░реНрд╢рди рдореЗрдВ рдпрд╣ рд▓рд╛рдн рддреАрди рдХрд╛рд░рдХреЛрдВ рдХреЗ рдХрд╛рд░рдг рдкреНрд░рд╛рдкреНрдд рд╣реБрдЖ рд╣реИ: </p><br><ol><li>  рдХреЛрдб рдореЗрдВ рд╡рд┐рднрд┐рдиреНрди рд╕реНрдерд╛рдиреЛрдВ рдореЗрдВ рдмрд┐рдЦрд░реА рд╣реБрдИ рд╢рд╛рдЦрд╛рдУрдВ рдХрд╛ рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рди рд▓рдЧрд╛рдирд╛ рдЖрд╕рд╛рди рд╣реИред </li><li>  рд╣реИрдВрдбрд▓рд░ рдХреЗ рддрд░реНрдХ рд╣рдореЗрд╢рд╛ рдПрдХ рдкреВрд░реНрдг рдорд╢реАрди рд╢рдмреНрдж рдореЗрдВ рдкреВрд░реНрд╡-рдПрдиреНрдХреЛрдбреЗрдб рд╣реЛрддреЗ рд╣реИрдВ, рдФрд░ рдпрд╣ рдХреЗрд╡рд▓ рдПрдХ рдмрд╛рд░ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ - рдЯреНрд░реЗрд╕ рдХреЗ рд╕рдВрдХрд▓рди рдХреЗ рджреМрд░рд╛рдиред </li><li>  рдХрдВрдкрд╛рдЗрд▓рд░ рдПрдХ рдХреЙрд▓ рдореЗрдВ рдлрд╝рдВрдХреНрд╢рди рдХреА рд╢реНрд░реГрдВрдЦрд▓рд╛ рдХреЛ рдкрд╣рд▓реЗ рд╣реИрдВрдбрд▓рд░ рдлрд╝рдВрдХреНрд╢рди рдореЗрдВ рдмрджрд▓ рджреЗрддрд╛ рд╣реИ, рдЬреЛ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЯреЗрд▓ рдХреЙрд▓ рдХреЗ</a> рдЕрдиреБрдХреВрд▓рди рдХреЗ рдХрд╛рд░рдг рд╕рдВрднрд╡ рд╣реИред </li></ol><br><p>  рд╣рдорд╛рд░реЗ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЗ рдкрд░рд┐рдгрд╛рдореЛрдВ рдХреЛ рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рдкреНрд░рд╕реНрддреБрдд рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ, рдкрд┐рдЧрд▓реЗрдЯ рдФрд░ рдореИрдВрдиреЗ рдХрд╛рд░реНрдпрдХреНрд░рдореЛрдВ рдХреА рд╡реНрдпрд╛рдЦреНрдпрд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдФрд░ рдкреНрд░рд╛рдЪреАрди рддрдХрдиреАрдХ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рдиреЗ рдХрд╛ рдлреИрд╕рд▓рд╛ рдХрд┐рдпрд╛ - рд╕рд┐рд▓рдирд╛ рдХреЛрдбред </p><br><h1 id="uprazhnenie-chetvertoe-shityy-kod">  рд╡реНрдпрд╛рдпрд╛рдо рдЪрд╛рд░: "рд╕рд┐рд▓рдирд╛" рдХреЛрдб </h1><br><p>  рд╡реНрдпрд╛рдЦреНрдпрд╛рддрд╛рдУрдВ рдХреЗ рдЗрддрд┐рд╣рд╛рд╕ рдореЗрдВ рд░реБрдЪрд┐ рд░рдЦрдиреЗ рд╡рд╛рд▓реЗ рдХрд┐рд╕реА рднреА рд╕реБрдЕрд░ рдиреЗ рдПрдХ рд▓рдбрд╝реА рдкрд┐рд░реЛрдпрд╛ рдХреЛрдб рд╕реБрдирд╛ред  рдЗрд╕ рддрдХрдиреАрдХ рдХреЗ рд▓рд┐рдП рдХрдИ рд╡рд┐рдХрд▓реНрдк рд╣реИрдВ, рд▓реЗрдХрд┐рди рд╡реЗ рд╕рднреА рдПрдХ opcodes рдХреА рдПрдХ рд╕рд░рдгреА рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЬрд╛рдиреЗ рдХреЗ рдмрдЬрд╛рдп рдЙрдмрд▓рддреЗ рд╣реИрдВ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдлрд╝рдВрдХреНрд╢рдВрд╕ рдпрд╛ рд▓реЗрдмрд▓реЛрдВ рдХреЛ рдЗрдВрдЧрд┐рдд рдХрд░рддреЗ рд╣реИрдВ, рд╕реАрдзреЗ рдордзреНрдпрд╡рд░реНрддреА рдУрдкрдХреЛрдб рдХреЗ рдмрд┐рдирд╛ рдЙрдирдХрд╛ рдкрд╛рд▓рди рдХрд░рддреЗ рд╣реИрдВред </p><br><p>  рдХреЙрд▓рд┐рдВрдЧ рдлрд╝рдВрдХреНрд╢рди рдЗрди рджрд┐рдиреЛрдВ рдПрдХ рдорд╣рдВрдЧрд╛ рдФрд░ рдЕрд░реНрдерд╣реАрди рд╡реНрдпрд╡рд╕рд╛рдп рд╣реИ;  рд╕рд┐рд▓рдирд╛ рдХреЛрдб рдХреЗ рдЕрдзрд┐рдХрд╛рдВрд╢ рдЕрдиреНрдп рд╕рдВрд╕реНрдХрд░рдг рдорд╛рдирдХ рд╕реА рдХреЗ рдврд╛рдВрдЪреЗ рдХреЗ рднреАрддрд░ рдЕрд╡рд╛рд╕реНрддрд╡рд┐рдХ рд╣реИрдВред рдпрд╣рд╛рдВ рддрдХ тАЛтАЛрдХрд┐ рддрдХрдиреАрдХ, рдЬрд┐рд╕ рдкрд░ рдиреАрдЪреЗ рдЪрд░реНрдЪрд╛ рдХреА рдЬрд╛рдПрдЧреА, рд▓реЗрдмрд▓ рдХреЗ рд▓рд┐рдП рд╡реНрдпрд╛рдкрдХ, рд▓реЗрдХрд┐рди рдЧреИрд░-рдорд╛рдирдХ рд╡рд┐рд╕реНрддрд╛рд░ рд╕реА-рдкреЙрдЗрдВрдЯрд░реНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред </p><br><p>  рд╕реАрд╡рди рдХреЛрдб (рдЕрдВрдЧреНрд░реЗрдЬреА рдЯреЛрдХрди рдереНрд░реЗрдбреЗрдб рдХреЛрдб) рдХреЗ рд╕рдВрд╕реНрдХрд░рдг рдореЗрдВ, рдЬрд┐рд╕реЗ рдореИрдВрдиреЗ рдЕрдкрдиреЗ рд╕реБрдЕрд░ рд▓рдХреНрд╖реНрдпреЛрдВ рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЪреБрдирд╛ рдерд╛, рд╣рдо рдмрд╛рдпрдЯреЗрдХреЛрдб рдХреЛ рдмрдЪрд╛рддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рд╡реНрдпрд╛рдЦреНрдпрд╛ рд╢реБрд░реВ рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ, рд╣рдо рдПрдХ рддрд╛рд▓рд┐рдХрд╛ рдмрдирд╛рддреЗ рд╣реИрдВ рдЬреЛ рдирд┐рд░реНрджреЗрд╢ рд╣реИрдВрдбрдХреЛрдб рд▓реЗрдмрд▓ рдХреЗ рдкрддреЗ рдкрд░ рдирд┐рд░реНрджреЗрд╢ рдСрдкрдХреЛрдб рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИ: </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> *labels[] = { [OP_PUSHI] = &amp;&amp;op_pushi, [OP_LOADI] = &amp;&amp;op_loadi, [OP_LOADADDI] = &amp;&amp;op_loadaddi, [OP_STORE] = &amp;&amp;op_store, [OP_STOREI] = &amp;&amp;op_storei, [OP_LOAD] = &amp;&amp;op_load, [OP_DUP] = &amp;&amp;op_dup, [OP_DISCARD] = &amp;&amp;op_discard, [OP_ADD] = &amp;&amp;op_add, [OP_ADDI] = &amp;&amp;op_addi, [OP_SUB] = &amp;&amp;op_sub, [OP_DIV] = &amp;&amp;op_div, [OP_MUL] = &amp;&amp;op_mul, [OP_JUMP] = &amp;&amp;op_jump, [OP_JUMP_IF_TRUE] = &amp;&amp;op_jump_if_true, [OP_JUMP_IF_FALSE] = &amp;&amp;op_jump_if_false, [OP_EQUAL] = &amp;&amp;op_equal, [OP_LESS] = &amp;&amp;op_less, [OP_LESS_OR_EQUAL] = &amp;&amp;op_less_or_equal, [OP_GREATER] = &amp;&amp;op_greater, [OP_GREATER_OR_EQUAL] = &amp;&amp;op_greater_or_equal, [OP_GREATER_OR_EQUALI] = &amp;&amp;op_greater_or_equali, [OP_POP_RES] = &amp;&amp;op_pop_res, [OP_DONE] = &amp;&amp;op_done, [OP_PRINT] = &amp;&amp;op_print, [OP_ABORT] = &amp;&amp;op_abort, };</code> </pre> <br><p>  рдкреНрд░рддреАрдХреЛрдВ рдкрд░ рдзреНрдпрд╛рди рджреЗрдВ &amp;&amp; - рдпреЗ рдирд┐рд░реНрджреЗрд╢ рдХреЗ рдирд┐рдХрд╛рдпреЛрдВ рдХреЗ рд╕рд╛рде рд▓реЗрдмрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреЗрдд рд╣реИрдВ, рдЬреАрд╕реАрд╕реА рдХрд╛ рд╕рдмрд╕реЗ рдЧреИрд░-рдорд╛рдирдХ рд╡рд┐рд╕реНрддрд╛рд░ред </p><br><p>  рдХреЛрдб рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдирд╛ рд╢реБрд░реВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдкреНрд░реЛрдЧреНрд░рд╛рдо рдХреЗ рдкрд╣рд▓реЗ рдУрдкрдХреЛрдб рдХреЗ рд▓рд┐рдП рдкреЙрдЗрдВрдЯрд░ рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ: </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> *labels[NEXT_OP()];</code> </pre> <br><p>  рдпрд╣рд╛рдБ рдХреЛрдИ рдЪрдХреНрд░ рдирд╣реАрдВ рд╣реИ рдФрд░ рд╡рд╣рд╛рдБ рдирд╣реАрдВ рд╣реЛрдЧрд╛, рдкреНрд░рддреНрдпреЗрдХ рдирд┐рд░реНрджреЗрд╢ рд╕реНрд╡рдпрдВ рд╣реА рдирд┐рдореНрди рд╣реИрдВрдбрд▓рд░ рдХреЗ рд▓рд┐рдП рдПрдХ рдХреВрдж рдмрдирд╛рддрд╛ рд╣реИ: </p><br><pre> <code class="cpp hljs">op_pushi: { <span class="hljs-comment"><span class="hljs-comment">/* get the argument, push it onto stack */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> arg = NEXT_ARG(); PUSH(arg); <span class="hljs-comment"><span class="hljs-comment">/* jump to the next instruction*/</span></span> <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> *labels[NEXT_OP()]; }</code> </pre> <br><p>  рдПрдХ рд╕реНрд╡рд┐рдЪ "рдлреИрд▓рддрд╛" рд╢рд╛рдЦрд╛ рдХреА рдЕрдиреБрдкрд╕реНрдерд┐рддрд┐ рдирд┐рд░реНрджреЗрд╢реЛрдВ рдХреЗ рдирд┐рдХрд╛рдпреЛрдВ рдХреЗ рд╕рд╛рде-рд╕рд╛рде рдЗрдВрдЧрд┐рдд рдХрд░рддреА рд╣реИ, рдЬреЛ рд╕рд┐рджреНрдзрд╛рдВрдд рдХреЗ рдирд┐рд░реНрджреЗрд╢реЛрдВ рдХреЗ рдЕрд╕рд╛рдзрд╛рд░рдг рдирд┐рд╖реНрдкрд╛рджрди рдХреЗ рдорд╛рдорд▓реЗ рдореЗрдВ рд╢рд╛рдЦрд╛ рднрд╡рд┐рд╖реНрдпрд╡рдХреНрддрд╛ рдХреА рдорджрдж рдХрд░рдиреА рдЪрд╛рд╣рд┐рдПред  рдРрд╕рд╛ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рд╣рдордиреЗ рд╕реНрд╡рд┐рдЪ рдХреЛ рд╕реАрдзреЗ рдирд┐рд░реНрджреЗрд╢реЛрдВ рдореЗрдВ рдмрдирд╛рдпрд╛ рд╣реИ рдФрд░ рдореИрдиреНрдпреБрдЕрд▓ рд░реВрдк рд╕реЗ рдПрдХ рд╕рдВрдХреНрд░рдордг рддрд╛рд▓рд┐рдХрд╛ рдмрдирд╛рдИ рд╣реИред </p><br><p>  рд╡рд╣ рдкреВрд░реА рддрдХрдиреАрдХ рд╣реИред  рд╡рд╣ рдЕрдкрдиреА рд╕рд╛рджрдЧреА рдХреЗ рд▓рд┐рдП рдЧреБрд▓реНрд▓рдХ рдкрд╕рдВрдж рдХрд░рддреА рдереАред  рдЖрдЗрдП рджреЗрдЦреЗрдВ рдХрд┐ рд╡реНрдпрд╡рд╣рд╛рд░ рдореЗрдВ рдХреНрдпрд╛ рд╣реЛрддрд╛ рд╣реИ: </p><br><pre> <code class="plaintext hljs">&gt; ./pigletvm runtimes test/sieve.bin 100 &gt; /dev/null PROFILE: switch code finished took 443ms PROFILE: switch code (no range check) finished took 389ms PROFILE: threaded code finished took 477ms PROFILE: trace code finished took 364ms</code> </pre> <br><p>  рдКрдкреНрд╕!  рдпрд╣ рд╣рдорд╛рд░реА рд╕рднреА рддрдХрдиреАрдХреЛрдВ рдореЗрдВ рд╕рдмрд╕реЗ рдзреАрдорд╛ рд╣реИ!  рдХреНрдпрд╛ рд╣реБрдЖ рдерд╛?  рдЪрд▓реЛ рд╕рднреА GCC рдЕрдиреБрдХреВрд▓рди рдХреЛ рдмрдВрдж рдХрд░рддреЗ рд╣реБрдП рдПрдХ рд╣реА рдкрд░реАрдХреНрд╖рдг рдЪрд▓рд╛рддреЗ рд╣реИрдВ: </p><br><pre> <code class="plaintext hljs">&gt; ./pigletvm runtimes test/sieve.bin 100 &gt; /dev/null PROFILE: switch code finished took 969ms PROFILE: switch code (no range check) finished took 940ms PROFILE: threaded code finished took 824ms PROFILE: trace code finished took 1169ms</code> </pre> <br><p>  рдпрд╣рд╛рдВ, рд╕рд┐рд▓рдирд╛ рдХреЛрдб рдмреЗрд╣рддрд░ рдкреНрд░рджрд░реНрд╢рди рдХрд░рддрд╛ рд╣реИред </p><br><p>  рддреАрди рдХрд╛рд░рдХ рдпрд╣рд╛рдВ рднреВрдорд┐рдХрд╛ рдирд┐рднрд╛рддреЗ рд╣реИрдВ: </p><br><ol><li>  рдСрдкреНрдЯрд┐рдорд╛рдЗрдЬрд╝рд┐рдВрдЧ рдХрдВрдкрд╛рдЗрд▓рд░ рд╕реНрд╡рдпрдВ рдПрдХ рд░реВрдкрд╛рдВрддрд░рдг рддрд╛рд▓рд┐рдХрд╛ рдмрдирд╛рдПрдЧрд╛ рдЬреЛ рд╣рдорд╛рд░реЗ рдореИрдиреБрдЕрд▓ рд▓реЗрдмрд▓ рдкреНрд▓реЗрдЯ рд╕реЗ рдмрджрддрд░ рдирд╣реАрдВ рд╣реИред </li><li>  рдЖрдзреБрдирд┐рдХ рд╕рдВрдХрд▓рдХ рдЙрд▓реНрд▓реЗрдЦрдиреАрдп рд░реВрдк рд╕реЗ рдЕрддрд┐рд░рд┐рдХреНрдд рдлрд╝рдВрдХреНрд╢рди рдХреЙрд▓ рд╕реЗ рдЫреБрдЯрдХрд╛рд░рд╛ рдкрд╛ рд▓реЗрддреЗ рд╣реИрдВред </li><li>  рдЗрдВрдЯреЗрд▓ рдкреНрд░реЛрд╕реЗрд╕рд░ рдХреЗ рд╣рд╡реЗрд▓рд╡реЗрд▓ рдкреАрдврд╝реА рдХреЗ рдЖрд╕рдкрд╛рд╕ рд╢реБрд░реВ рд╣реЛрдиреЗ рд╕реЗ, рд╢рд╛рдЦрд╛ рдХреЗ рднрд╡рд┐рд╖реНрдпрд╡рдХреНрддрд╛рдУрдВ рдиреЗ рдПрдХрд▓ рд╢рд╛рдЦрд╛ рдмрд┐рдВрджреБ рдкрд░ рд╕рдВрдХреНрд░рдордг рдХрд╛ рд╕рдЯреАрдХ рдЕрдиреБрдорд╛рди рд▓рдЧрд╛рдирд╛ рд╕реАрдЦ рд▓рд┐рдпрд╛ рд╣реИред </li></ol><br><p>  рдкреБрд░рд╛рдиреА рд╕реНрдореГрддрд┐ рдХреЗ рдЕрдиреБрд╕рд╛рд░, рдЗрд╕ рддрдХрдиреАрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдЕрднреА рднреА рдХреЛрдб рдореЗрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдкрд╛рдпрдерди рд╡реАрдПрдо рджреБрднрд╛рд╖рд┐рдпрд╛, рд▓реЗрдХрд┐рди, рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ, рдЗрди рджрд┐рдиреЛрдВ рдпрд╣ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдкреБрд░рд╛рддрдирддрд╛ рд╣реИред </p><br><p>  рдЖрдЗрдП рд╣рдо рдЖрдЦрд┐рд░рдХрд╛рд░ рдЕрдкрдиреЗ рд╕реВрдЕрд░ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рд╛рдкреНрдд рд╕рдлрд▓рддрд╛рдУрдВ рдХрд╛ рд╕рд╛рд░рд╛рдВрд╢ рдФрд░ рдореВрд▓реНрдпрд╛рдВрдХрди рдХрд░реЗрдВред </p><br><h1 id="razbor-porosyachih-poletov">  рд╕реБрдЕрд░ рдХреЗ рдЙрдбрд╝рд╛рди рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг </h1><br><p><img src="https://habrastorage.org/webt/co/vy/6k/covy6k28ts8__ozuzuswtqpcora.jpeg"><br>  рдореБрдЭреЗ рдпрдХреАрди рдирд╣реАрдВ рд╣реИ рдХрд┐ рдЗрд╕реЗ рдПрдХ рдЙрдбрд╝рд╛рди рдХрд╣рд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдЪрд▓реЛ рдЗрд╕рдХрд╛ рд╕рд╛рдордирд╛ рдХрд░рддреЗ рд╣реИрдВ, рд╣рдорд╛рд░реА рдЧреБрд▓реНрд▓рдХ рдиреЗ 550 рдорд┐рд▓реАрд╕реЗрдХрдВрдб рд╕реЗ рд▓реЗрдХрд░ "рдЪрд▓рдиреА" рдкрд░ рдЕрдВрддрд┐рдо 370 рдорд┐рд▓реАрд╕реЗрдХрдВрдб рддрдХ рдХреЗ рд▓рд┐рдП рдПрдХ рд▓рдВрдмрд╛ рд╕рдлрд░ рддрдп рдХрд┐рдпрд╛ рд╣реИред  рд╣рдордиреЗ рд╡рд┐рднрд┐рдиреНрди рддрдХрдиреАрдХреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛: рд╕реБрдкрд░-рдирд┐рд░реНрджреЗрд╢, рдореВрд▓реНрдпреЛрдВ рдХреЗ рдЕрдВрддрд░рд╛рд▓ рдХреА рдЬрд╛рдВрдЪ рд╕реЗ рдЫреБрдЯрдХрд╛рд░рд╛, рдирд┐рд╢рд╛рди рдХреЗ рдЬрдЯрд┐рд▓ рдпрд╛рдВрддреНрд░рд┐рдХреА рдФрд░ рдЕрдВрдд рдореЗрдВ, рдпрд╣рд╛рдВ рддрдХ тАЛтАЛрдХрд┐ рд╕рд┐рд▓рдирд╛ рдХреЛрдб рднреАред  рдПрдХ рд╣реА рд╕рдордп рдореЗрдВ, рд╣рдо, рд╕рд╛рдорд╛рдиреНрдп рддреМрд░ рдкрд░, рд╕рднреА рд▓реЛрдХрдкреНрд░рд┐рдп рд╕реА рдХрдВрдкрд╛рдЗрд▓рд░реЛрдВ рдореЗрдВ рд▓рд╛рдЧреВ рдЪреАрдЬреЛрдВ рдХреЗ рдврд╛рдВрдЪреЗ рдХреЗ рднреАрддрд░ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВред 1.5 рдХреЗ рдПрдХ рдХрд╛рд░рдХ рджреНрд╡рд╛рд░рд╛ рддреНрд╡рд░рдг, рдЬреИрд╕рд╛ рдХрд┐ рдореБрдЭреЗ рд▓рдЧрддрд╛ рд╣реИ, рдПрдХ рдЕрдЪреНрдЫрд╛ рдкрд░рд┐рдгрд╛рдо рд╣реИ, рдФрд░ рдШреЗрдВрдЯрд╛ рдЧрд░реНрдд рдореЗрдВ рдЪреЛрдХрд░ рдХреЗ рдПрдХ рдЕрддрд┐рд░рд┐рдХреНрдд рд╣рд┐рд╕реНрд╕реЗ рдХреЗ рд╣рдХрджрд╛рд░ рд╣реИрдВред </p><br><p>  рд╕реБрдЕрд░ рдХреЗ рд╕рд╛рде рд╣рдо рдЦреБрдж рдХреЗ рд▓рд┐рдП рдЬреЛ рдирд┐рд╣рд┐рдд рд╢рд░реНрддреЗрдВ рд░рдЦрддреЗ рд╣реИрдВ, рдЙрдирдореЗрдВ рд╕реЗ рдПрдХ рдкрд┐рдЧрд▓реЗрдЯ рд╡реАрдПрдо рдорд╢реАрди рдХреЗ рд╕реНрдЯреИрдХ рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░ рдХреЛ рд╕рдВрд░рдХреНрд╖рд┐рдд рдХрд░рдирд╛ рд╣реИред  рд╡рд╛рд╕реНрддреБрдХрд▓рд╛ рдХреЛ рдкрдВрдЬреАрдХреГрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд░рдордг, рдПрдХ рдирд┐рдпрдо рдХреЗ рд░реВрдк рдореЗрдВ, рдХрд╛рд░реНрдпрдХреНрд░рдореЛрдВ рдХреЗ рддрд░реНрдХ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рдирд┐рд░реНрджреЗрд╢реЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рдХреЛ рдХрдо рдХрд░рддрд╛ рд╣реИ рдФрд░ рддрджрдиреБрд╕рд╛рд░, рдЕрдиреБрджреЗрд╢ рдкреНрд░рдмрдВрдзрдХ рдХреЛ рдЕрдирд╛рд╡рд╢реНрдпрдХ рдирд┐рдХрд╛рд╕ рд╕реЗ рдЫреБрдЯрдХрд╛рд░рд╛ рдкрд╛рдиреЗ рдореЗрдВ рдорджрдж рдХрд░ рд╕рдХрддрд╛ рд╣реИред  рдореБрдЭреЗ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рдЗрд╕ рдкрд░ 10-20% рд╕рдордп рдХрдЯ рд╕рдХрддрд╛ рд╣реИред </p><br><p>  рд╣рдорд╛рд░реА рдореБрдЦреНрдп рд╕реНрдерд┐рддрд┐ - рдЧрддрд┐рд╢реАрд▓ рд╕рдВрдХрд▓рди рдХреА рдХрдореА - рднреА рдкреНрд░рдХреГрддрд┐ рдХрд╛ рдирд┐рдпрдо рдирд╣реАрдВ рд╣реИред  рдЬреЗрдЖрдИрдЯреА рд╕рдВрдХрд▓рди рдХреЗ рд░реВрдк рдореЗрдВ рд╕реНрдЯреЗрд░реЙрдпрдб рдХреЗ рд╕рд╛рде рдПрдХ рд╕реБрдЕрд░ рдХреЛ рдкрдВрдк рдХрд░рдирд╛ рдЗрди рджрд┐рдиреЛрдВ рдмрд╣реБрдд рдЖрд╕рд╛рди рд╣реИ: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЬреАрдПрдирдпреВ рд▓рд╛рдЗрдЯрдирд┐рдВрдЧ</a> рдпрд╛ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд▓рд┐рдмрдЬрд┐рдЯ</a> рдЬреИрд╕реА рдкреБрд╕реНрддрдХрд╛рд▓рдпреЛрдВ рдореЗрдВ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">,</a> рд╕рднреА рдЧрдВрджреЗ рдХрд╛рдо рдкрд╣рд▓реЗ рд╣реА рд╣реЛ рдЪреБрдХреЗ рд╣реИрдВред  рд▓реЗрдХрд┐рди рдкреБрд╕реНрддрдХрд╛рд▓рдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП рд╡рд┐рдХрд╛рд╕ рд╕рдордп рдФрд░ рдХреЛрдб рдХреА рдХреБрд▓ рдорд╛рддреНрд░рд╛ рдореЗрдВ рднреА рдЬрдмрд░рджрд╕реНрдд рд╡реГрджреНрдзрд┐ рд╣реЛ рд░рд╣реА рд╣реИред </p><br><p>  рдмреЗрд╢рдХ, рдЕрдиреНрдп рдЪрд╛рд▓реЗрдВ рд╣реИрдВ рдЬрд┐рдирдХреЗ рд▓рд┐рдП рд╣рдорд╛рд░реА рдЫреЛрдЯреА рд╕реБрдЕрд░ рдЦреБрд░ рддрдХ рдирд╣реАрдВ рдкрд╣реБрдВрдЪреА рд╣реИред    ,     тАФ       - тАФ    - .         ,       . </p><br><p> <strong>PS</strong>    ,  ,   ,   ,   ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">https://www.instagram.com/vovazomb/</a> ),   . </p><br><p> <strong>PPS</strong>       ,     .  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" class="user_link">true-grue</a> -           тАФ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">PigletC</a> .     ! </p><br><p> <strong>PPPS</strong>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" class="user_link">iliazeus</a>    :      .            ;             .      <a href=""></a> . </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/hi428878/">https://habr.com/ru/post/hi428878/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi428866/index.html">7 рдбрд┐рдЬрд╛рдЗрди рд╕рд┐рджреНрдзрд╛рдВрддреЛрдВ, рдбрд┐рдЬрд╛рдЗрди рдкреНрд░рд╡реГрддреНрддрд┐рдпреЛрдВ рдХреЗ рд░реБрдЭрд╛рди, UX- рдбрд┐рдЬрд╛рдЗрдирд░ рдкреЛрд░реНрдЯрдлреЛрд▓рд┐рдпреЛ, ...</a></li>
<li><a href="../hi428868/index.html">рдмрд╣реБ-рд░рд┐рд▓реАрдЬ рдЬрд╛рд░ - рдЦрд░рд╛рдм рдпрд╛ рдЕрдЪреНрдЫрд╛?</a></li>
<li><a href="../hi428870/index.html">Mrr: рд░рд┐рдПрдХреНрдЯ рдХреЗ рд▓рд┐рдП рдХреБрд▓ рдПрдлрдЖрд░рдкреА</a></li>
<li><a href="../hi428872/index.html">рдПрдХ рдЖрдВрдЦ рдФрд░ 20 рдСрдкрд░реЗрд╢рди (рдЗрдореНрдкреНрд░реИрд╕реЗрдмрд▓ рдирд╣реАрдВ рдкрдврд╝реЗ) рдХреА рдХрд╣рд╛рдиреА рдпрд╛ рд╡рд╣ рдкрд╛рдпрд▓рдЯ рдмрдирдирд╛ рдЪрд╛рд╣рддрд╛ рдерд╛, рд▓реЗрдХрд┐рди рдЙрд╕реЗ рдЖрдХрд╛рд╢ рдореЗрдВ рдЬрд╛рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдирд╣реАрдВ рдереА</a></li>
<li><a href="../hi428876/index.html">рдХреЛрдИ рднреА рдореЛрдбрд╝ рдирд╣реАрдВ рд╣реИ: рдкрд░реАрдХреНрд╖рдХ рдХрд╛ рд╡реНрдпрдХреНрддрд┐рдЧрдд рдЕрдиреБрднрд╡</a></li>
<li><a href="../hi428880/index.html">рдирдП рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЗ рддрд░реАрдХреЗ - рдЧреЛрдкрдиреАрдпрддрд╛ рдХреЗ рд▓рд┐рдП рдЦрддрд░рд╛?</a></li>
<li><a href="../hi428882/index.html">рдореЛрдмрд╛рдЗрд▓ рдпрд╛рдВрдбреЗрдХреНрд╕ред рдмреНрд▓рд┐рдЯреНрдЬ: рд╣рдо рдХрд╛рд░реНрдпреЛрдВ рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░рддреЗ рд╣реИрдВ</a></li>
<li><a href="../hi428888/index.html">qml: рд╢рдХреНрддрд┐ рдФрд░ рд╕рд╛рджрдЧреА</a></li>
<li><a href="../hi428890/index.html">RTOS рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдкреВрд░реА рд╕рдЪреНрдЪрд╛рдИред рдЕрдиреБрдЪреНрдЫреЗрдж # 18ред рдЗрд╡реЗрдВрдЯ рдлрд╝реНрд▓реИрдЧ рд╕рдореВрд╣: рд╕рд╣рд╛рдпрдХ рд╕реЗрд╡рд╛рдПрдБ рдФрд░ рдбреЗрдЯрд╛ рд╕рдВрд░рдЪрдирд╛рдПрдБ</a></li>
<li><a href="../hi428892/index.html">рдЧреЗрдо рдПрдЖрдИ рдХреИрд╕реЗ рдмрдирд╛рдПрдВ: рд╢реБрд░реБрдЖрддреА рд▓реЛрдЧреЛрдВ рдХреЗ рд▓рд┐рдП рдПрдХ рдЧрд╛рдЗрдб</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>