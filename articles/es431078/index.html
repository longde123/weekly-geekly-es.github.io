<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üîù ‚öïÔ∏è üéà Gu√≠a de manejo de errores de JavaScript üßöüèΩ üëâüèª üöô</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Los errores son buenos. El autor del material, cuya traducci√≥n publicamos hoy, dice que conf√≠a en que esta idea sea conocida por todos. A primera vist...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Gu√≠a de manejo de errores de JavaScript</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/431078/">  Los errores son buenos.  El autor del material, cuya traducci√≥n publicamos hoy, dice que conf√≠a en que esta idea sea conocida por todos.  A primera vista, los errores parecen atemorizantes.  Pueden estar acompa√±ados de alg√∫n tipo de p√©rdida.  Un error cometido en p√∫blico perjudica la autoridad de quien lo cometi√≥.  Pero al cometer errores, aprendemos de ellos, lo que significa que la pr√≥xima vez que nos encontremos en una situaci√≥n en la que previamente nos comportamos incorrectamente, hacemos todo lo que sea necesario. <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><img src="https://habrastorage.org/webt/9q/dw/s5/9qdws5ejk1iibkjghqujq6m4c_4.jpeg"></a> <br><br>  Arriba hablamos sobre los errores que cometen las personas en la vida cotidiana.  Los errores en la programaci√≥n son otra cosa.  Los mensajes de error nos ayudan a mejorar el c√≥digo, nos permiten informar a los usuarios de nuestros proyectos que algo sali√≥ mal y tal vez decirles a los usuarios c√≥mo comportarse para que ya no se produzcan errores. <br><a name="habracut"></a><br>  Este material de manejo de errores de JavaScript se divide en tres partes.  Primero, daremos una descripci√≥n general del sistema de manejo de errores en JavaScript y hablaremos sobre los objetos de error.  Despu√©s de eso, buscamos la respuesta a la pregunta de qu√© hacer con los errores que ocurren en el c√≥digo del servidor (en particular, cuando se usa el paquete Node.js + Express.js).  A continuaci√≥n, discutimos el manejo de errores en React.js.  Los marcos que se considerar√°n aqu√≠ se seleccionan debido a su enorme popularidad.  Sin embargo, los principios para trabajar con los errores discutidos aqu√≠ son universales, por lo que incluso si no usa Express y React, puede aplicar f√°cilmente lo que aprendi√≥ a las herramientas con las que trabaja. <br><br>  El c√≥digo para el proyecto de demostraci√≥n utilizado en este material se puede encontrar en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">este</a> repositorio. <br><br><h2>  <font color="#3AC1EF">1. Errores en JavaScript y formas universales de trabajar con ellos.</font> </h2><br>  Si algo sali√≥ mal en su c√≥digo, puede usar la siguiente construcci√≥n. <br><br><pre><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Error</span></span>(<span class="hljs-string"><span class="hljs-string">'something went wrong'</span></span>)</code> </pre> <br>  Durante la ejecuci√≥n de este comando, se crear√° una instancia del objeto <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Error</a> y se generar√° una excepci√≥n (o, como dicen, "arrojada") con este objeto.  La instrucci√≥n <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">throw</a> puede lanzar excepciones que contienen expresiones arbitrarias.  En este caso, la ejecuci√≥n del script se detendr√° si no se han tomado medidas para manejar el error. <br><br>  Los programadores principiantes de JS generalmente no usan la instrucci√≥n <code>throw</code> .  Por lo general, se encuentran con excepciones lanzadas por el tiempo de ejecuci√≥n del lenguaje o las bibliotecas de terceros.  Cuando esto sucede, algo as√≠ como un <code>ReferenceError: fs is not defined</code> entra en la consola <code>ReferenceError: fs is not defined</code> y la ejecuci√≥n del programa se detiene. <br><br><h3>  <font color="#3AC1EF">‚ñç Error de objeto</font> </h3><br>  Las instancias del objeto <code>Error</code> tienen varias propiedades que podemos usar.  La primera propiedad que nos interesa es el <code>message</code> .  Aqu√≠ es donde se obtiene la l√≠nea que se puede pasar al constructor de errores como argumento.  Por ejemplo, a continuaci√≥n se muestra c√≥mo crear una instancia del objeto <code>Error</code> y enviar a la consola la cadena que pas√≥ el constructor accediendo a su propiedad de <code>message</code> . <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> myError = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Error</span></span>(<span class="hljs-string"><span class="hljs-string">'please improve your code'</span></span>) <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(myError.message) <span class="hljs-comment"><span class="hljs-comment">// please improve your code</span></span></code> </pre> <br>  La segunda propiedad del objeto, muy importante, es la traza de la pila de errores.  Esta es una propiedad de <code>stack</code> .  En cuanto a √©l, puede ver la pila de llamadas (historial de errores), que muestra la secuencia de operaciones que condujeron al mal funcionamiento del programa.  En particular, esto nos permite comprender qu√© archivo contiene el c√≥digo incorrecto y ver qu√© secuencia de llamadas a funciones condujo al error.  Aqu√≠ hay un ejemplo de lo que puede ver accediendo a la propiedad de <code>stack</code> . <br><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">Error</span></span>: please improve your code at <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.&lt;anonymous&gt; (<span class="hljs-regexp"><span class="hljs-regexp">/Users/gi</span></span>sderdube/Documents/_projects/hacking.nosync/error-handling/src/general.js:<span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-number"><span class="hljs-number">79</span></span>) at Module._compile (internal/modules/cjs/loader.js:<span class="hljs-number"><span class="hljs-number">689</span></span>:<span class="hljs-number"><span class="hljs-number">30</span></span>) at <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.Module._extensions..js (internal/modules/cjs/loader.js:<span class="hljs-number"><span class="hljs-number">700</span></span>:<span class="hljs-number"><span class="hljs-number">10</span></span>) at Module.load (internal/modules/cjs/loader.js:<span class="hljs-number"><span class="hljs-number">599</span></span>:<span class="hljs-number"><span class="hljs-number">32</span></span>) at tryModuleLoad (internal/modules/cjs/loader.js:<span class="hljs-number"><span class="hljs-number">538</span></span>:<span class="hljs-number"><span class="hljs-number">12</span></span>) at <span class="hljs-built_in"><span class="hljs-built_in">Function</span></span>.Module._load (internal/modules/cjs/loader.js:<span class="hljs-number"><span class="hljs-number">530</span></span>:<span class="hljs-number"><span class="hljs-number">3</span></span>) at <span class="hljs-built_in"><span class="hljs-built_in">Function</span></span>.Module.runMain (internal/modules/cjs/loader.js:<span class="hljs-number"><span class="hljs-number">742</span></span>:<span class="hljs-number"><span class="hljs-number">12</span></span>) at startup (internal/bootstrap/node.js:<span class="hljs-number"><span class="hljs-number">266</span></span>:<span class="hljs-number"><span class="hljs-number">19</span></span>) at bootstrapNodeJSCore (internal/bootstrap/node.js:<span class="hljs-number"><span class="hljs-number">596</span></span>:<span class="hljs-number"><span class="hljs-number">3</span></span>)</code> </pre> <br>  Aqu√≠, en la parte superior, hay un mensaje de error, seguido de una indicaci√≥n de la secci√≥n de c√≥digo cuya ejecuci√≥n caus√≥ el error, luego describe el lugar desde donde se llam√≥ a esta secci√≥n fallida.  Esto contin√∫a hasta el "m√°s alejado" en relaci√≥n con el fragmento de c√≥digo de error. <br><br><h3>  <font color="#3AC1EF">‚ñç Generaci√≥n y manejo de errores</font> </h3><br>  Crear una instancia del objeto <code>Error</code> , es decir, ejecutar un comando de la forma <code>new Error()</code> , no conlleva ninguna consecuencia especial.  Cosas interesantes comienzan a suceder despu√©s de aplicar el operador de <code>throw</code> , lo que genera un error.  Como ya se mencion√≥, si dicho error no se procesa, la ejecuci√≥n del script se detendr√°.  En este caso, no importa si el programador us√≥ el operador <code>throw</code> , si ocurri√≥ un error en cierta biblioteca o en el tiempo de ejecuci√≥n del idioma (en un navegador o en Node.js).  Hablemos de varios escenarios de manejo de errores. <br><br><h3>  <font color="#3AC1EF">‚ñçconstrucci√≥n intente ... atrapar</font> </h3><br>  El <code>try...catch</code> es la forma m√°s f√°cil de manejar errores que a menudo se olvidan.  Hoy en d√≠a, sin embargo, se usa mucho m√°s intensamente que antes, debido al hecho de que puede usarse para manejar errores en construcciones <code>async/await</code> . <br><br>  Este bloque se puede usar para manejar cualquier error que ocurra en el c√≥digo s√≠ncrono.  Considera un ejemplo. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> a = <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> {   <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(b) <span class="hljs-comment"><span class="hljs-comment">//  b   -   } catch (err) {   console.error(err) //          } console.log(a) //    ,   </span></span></code> </pre> <br>  Si en este ejemplo no incluimos el comando <code>console.log(b)</code> fallido en un <code>try...catch</code> , el script se detendr√≠a. <br><br><h3>  <font color="#3AC1EF">‚ñç finalmente bloquear</font> </h3><br>  A veces sucede que algunos c√≥digos deben ejecutarse independientemente de si se produjo un error o no.  Para hacer esto, puede usar el tercer bloque opcional, <code>finally</code> , en el <code>try...catch</code> construct.  A menudo, su uso es equivalente a alg√∫n c√≥digo que viene inmediatamente despu√©s de <code>try...catch</code> , pero en algunas situaciones puede ser √∫til.  Aqu√≠ hay un ejemplo de su uso. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> a = <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> {   <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(b) <span class="hljs-comment"><span class="hljs-comment">//  b   -   } catch (err) {   console.error(err) //          } finally {   console.log(a) //        }</span></span></code> </pre> <br><h3>  <font color="#3AC1EF">‚ñçMecanismos asincr√≥nicos - devoluciones de llamada</font> </h3><br>  Al programar en JavaScript, siempre debe prestar atenci√≥n a las secciones de c√≥digo que se ejecutan de forma asincr√≥nica.  Si tiene una funci√≥n asincr√≥nica y se produce un error, la secuencia de comandos continuar√° ejecut√°ndose.  Cuando se implementan mecanismos asincr√≥nicos en JS utilizando devoluciones de llamada (por cierto, esto no se recomienda), la devoluci√≥n de llamada correspondiente (funci√≥n de devoluci√≥n de llamada) generalmente recibe dos par√°metros.  Esto es algo as√≠ como el par√°metro <code>err</code> , que puede contener un error y un <code>result</code> , con los resultados de una operaci√≥n asincr√≥nica.  Se parece a esto: <br><br><pre> <code class="javascript hljs">myAsyncFunc(someInput, (err, result) =&gt; {   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(err) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.error(err) <span class="hljs-comment"><span class="hljs-comment">//           console.log(result) })</span></span></code> </pre> <br>  Si se produce un error en la devoluci√≥n de llamada, es visible all√≠ como un par√°metro de <code>err</code> .  De lo contrario, este par√°metro obtendr√° el valor <code>undefined</code> o <code>null</code> .  Si resulta que <code>err</code> algo, es importante responder a esto porque en nuestro ejemplo, usando el comando <code>return</code> , o usando la <code>if...else</code> y colocando comandos en el bloque <code>else</code> para trabajar con el resultado de la operaci√≥n asincr√≥nica.  El punto es, en el caso de que ocurra un error, excluir la posibilidad de trabajar con el resultado, el par√°metro <code>result</code> , que en este caso puede ser <code>undefined</code> .  Trabajar con este valor, si se supone, por ejemplo, que contiene un objeto, puede causar un error.  Digamos que esto sucede cuando intentas usar la construcci√≥n <code>result.data</code> o <code>result.data</code> similar. <br><br><h3>  <font color="#3AC1EF">‚ñçMecanismos asincr√≥nicos: promesas</font> </h3><br>  Para realizar operaciones asincr√≥nicas en JavaScript, es mejor usar promesas en lugar de devoluciones de llamada.  Aqu√≠, adem√°s de mejorar la legibilidad del c√≥digo, existen mecanismos m√°s avanzados para el manejo de errores.  Es decir, no necesita preocuparse por el objeto de error que puede caer en la funci√≥n de devoluci√≥n de llamada al usar promesas.  Aqu√≠ para este prop√≥sito se proporciona un bloque de <code>catch</code> especial.  Intercepta todos los errores que ocurrieron en las promesas anteriores o todos los errores que ocurrieron en el c√≥digo despu√©s del <code>catch</code> anterior.  Tenga en cuenta que si se produce un error en la promesa que no tiene un bloque <code>catch</code> para procesar, esto no detendr√° la ejecuci√≥n del script, pero el mensaje de error no ser√° particularmente legible. <br><br><pre> <code class="javascript hljs">(node:<span class="hljs-number"><span class="hljs-number">7741</span></span>) UnhandledPromiseRejectionWarning: Unhandled promise rejection (rejection id: <span class="hljs-number"><span class="hljs-number">1</span></span>): <span class="hljs-built_in"><span class="hljs-built_in">Error</span></span>: something went wrong (node:<span class="hljs-number"><span class="hljs-number">7741</span></span>) DeprecationWarning: Unhandled promise rejections are deprecated. In the future, promise rejections that are not handled will terminate the Node.js process <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> a non-zero exit code. *<span class="hljs-regexp"><span class="hljs-regexp">/</span></span></code> </pre> <br>  Como resultado, siempre puede recomendar, cuando trabaje con promesas, usar el <code>catch</code> .  Echa un vistazo a un ejemplo. <br><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>.resolve(<span class="hljs-number"><span class="hljs-number">1</span></span>)   .then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">res</span></span></span><span class="hljs-function"> =&gt;</span></span> {       <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(res) <span class="hljs-comment"><span class="hljs-comment">// 1       throw new Error('something went wrong')       return Promise.resolve(2)   })   .then(res =&gt; {       console.log(res) //        })   .catch(err =&gt; {       console.error(err) //  ,     ,         return Promise.resolve(3)   })   .then(res =&gt; {       console.log(res) // 3   })   .catch(err =&gt; {       //      ,      -        console.error(err)   })</span></span></code> </pre> <br><h3>  <font color="#3AC1EF">‚ñçMecanismos asincr√≥nicos e intenta ... atrapar</font> </h3><br>  Despu√©s de que apareciera la construcci√≥n <code>async/await</code> en JavaScript, volvimos a la forma cl√°sica de manejar los errores: <code>try...catch...finally</code> .  Manejar errores con este enfoque es muy f√°cil y conveniente.  Considera un ejemplo. <br><br><pre> <code class="javascript hljs">;(<span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{   <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> {       <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> someFuncThatThrowsAnError()   } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (err) {       <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.error(err) <span class="hljs-comment"><span class="hljs-comment">//       }   console.log('Easy!') //   })()</span></span></code> </pre> <br>  Con este enfoque, los errores en el c√≥digo asincr√≥nico se manejan de la misma manera que en el s√≠ncrono.  Como resultado, ahora, si es necesario, en un solo <code>catch</code> puede manejar una gama m√°s amplia de errores. <br><br><h2>  <font color="#3AC1EF">2. Generando y procesando errores en el c√≥digo del servidor</font> </h2><br>  Ahora que tenemos las herramientas para trabajar con errores, veamos qu√© podemos hacer con ellos en situaciones reales.  Generar y manejar correctamente los errores es un aspecto cr√≠tico de la programaci√≥n del lado del servidor.  Existen diferentes enfoques para trabajar con errores.  Aqu√≠ demostraremos un enfoque utilizando nuestro propio constructor para instancias del objeto <code>Error</code> y c√≥digos de error que se pasan convenientemente al front-end o a cualquier mecanismo que use API de servidor.  La forma en que se estructura el backend de un proyecto espec√≠fico realmente no importa, ya que con cualquier enfoque puede usar las mismas ideas para trabajar con errores. <br><br>  Como el marco del servidor responsable del enrutamiento, utilizaremos Express.js.  Pensemos en qu√© estructura necesitamos para organizar un sistema eficaz de manejo de errores.  Entonces, esto es lo que necesitamos: <br><br><ol><li>  El manejo universal de errores es un mecanismo b√°sico adecuado para manejar cualquier error, durante el cual <code>Something went wrong, please try again or contact us</code> un mensaje como <code>Something went wrong, please try again or contact us</code> , pidi√©ndole al usuario que intente realizar la operaci√≥n que fall√≥, nuevamente o comun√≠quese con el propietario del servidor.  Este sistema no es particularmente inteligente, pero al menos puede informar al usuario de que algo sali√≥ mal.  Tal mensaje es mucho mejor que la "descarga sin fin" o algo similar. </li><li>  Procesamiento de errores espec√≠ficos: un mecanismo que le permite informar al usuario informaci√≥n detallada sobre las causas del comportamiento incorrecto del sistema y brindarle consejos espec√≠ficos sobre c√≥mo abordar el problema.  Por ejemplo, esto puede referirse a la ausencia de algunos datos importantes en la solicitud que el usuario env√≠a al servidor, o que ya hay un cierto registro en la base de datos que est√° tratando de agregar nuevamente, y as√≠ sucesivamente. </li></ol><br><h3>  <font color="#3AC1EF">‚ñç Desarrollando su propio constructor de objetos de error</font> </h3><br>  Aqu√≠ usaremos la clase de <code>Error</code> est√°ndar y la extenderemos.  El uso de mecanismos de herencia en JavaScript es arriesgado, pero en este caso, estos mecanismos son muy √∫tiles.  ¬øPor qu√© necesitamos herencia?  El hecho es que para que podamos depurar convenientemente el c√≥digo, necesitamos informaci√≥n sobre el seguimiento de la pila de errores.  Extendiendo la clase de <code>Error</code> est√°ndar, tenemos la capacidad de rastrear la pila sin esfuerzo adicional.  Agregamos dos propiedades a nuestro propio objeto de error.  La primera es la propiedad de <code>code</code> , a la que se puede acceder utilizando una estructura de la forma <code>err.code</code> .  El segundo es la propiedad de <code>status</code> .  Grabar√° el c√≥digo de estado HTTP, que se planea transmitir a la parte cliente de la aplicaci√≥n. <br><br>  As√≠ es como se ve la clase <code>CustomError</code> , cuyo c√≥digo est√° dise√±ado como un m√≥dulo. <br><br><pre> <code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CustomError</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Error</span></span></span><span class="hljs-class"> </span></span>{   <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(code = 'GENERIC', status = 500, ...params) {       <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(...params)       <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">Error</span></span>.captureStackTrace) {           <span class="hljs-built_in"><span class="hljs-built_in">Error</span></span>.captureStackTrace(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, CustomError)       }       <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.code = code       <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.status = status   } } <span class="hljs-built_in"><span class="hljs-built_in">module</span></span>.exports = CustomError</code> </pre> <br><h3>  <font color="#3AC1EF">‚ñç Enrutamiento</font> </h3><br>  Ahora que nuestro objeto de error est√° listo para su uso, necesitamos configurar la estructura de ruta.  Como se mencion√≥ anteriormente, necesitamos implementar un enfoque unificado para el manejo de errores, que nos permite manejar igualmente los errores para todas las rutas.  Por defecto, el framework Express.js no es totalmente compatible con dicho esquema.  El hecho es que todas sus rutas est√°n encapsuladas. <br><br>  Para hacer frente a este problema, podemos implementar nuestro propio controlador de ruta y definir la l√≥gica de ruta en forma de funciones ordinarias.  Gracias a este enfoque, si la funci√≥n de ruta (o cualquier otra funci√≥n) arroja un error, caer√° en el controlador de ruta, que luego puede pasarlo a la parte cliente de la aplicaci√≥n.  Si se produce un error en el servidor, planeamos transferirlo al front-end en el siguiente formato, suponiendo que la API JSON se utilizar√° para esto: <br><br><pre> <code class="javascript hljs">{   <span class="hljs-attr"><span class="hljs-attr">error</span></span>: <span class="hljs-string"><span class="hljs-string">'SOME_ERROR_CODE'</span></span>,   <span class="hljs-attr"><span class="hljs-attr">description</span></span>: <span class="hljs-string"><span class="hljs-string">'Something bad happened. Please try again or contact support.'</span></span> }</code> </pre> <br>  Si en esta etapa lo que est√° sucediendo le parece incomprensible, no se preocupe, solo siga leyendo, intente trabajar con lo que se est√° discutiendo y gradualmente lo resolver√°.  De hecho, si hablamos de capacitaci√≥n en inform√°tica, el enfoque "de arriba hacia abajo" se usa aqu√≠, cuando las ideas generales se discuten por primera vez y luego se lleva a cabo la transici√≥n a detalles. <br><br>  As√≠ es como se ve el c√≥digo del controlador de ruta. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> express = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'express'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> router = express.Router() <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> CustomError = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'../CustomError'</span></span>) router.use(<span class="hljs-keyword"><span class="hljs-keyword">async</span></span> (req, res) =&gt; {   <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> {       <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> route = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">`.</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${req.path}</span></span></span><span class="hljs-string">`</span></span>)[req.method]       <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> {           <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> result = route(req) <span class="hljs-comment"><span class="hljs-comment">//    route           res.send(result) //   ,     route       } catch (err) {           /*                ,    route             */           if (err instanceof CustomError) {               /*                   -                                  */               return res.status(err.status).send({                   error: err.code,                   description: err.message,               })           } else {               console.error(err) //                  //   -                   return res.status(500).send({                   error: 'GENERIC',                   description: 'Something went wrong. Please try again or contact support.',               })           }       }   } catch (err) {       /*          ,    ,  ,            ,  ,          ,                       */       res.status(404).send({           error: 'NOT_FOUND',           description: 'The resource you tried to access does not exist.',       })   } }) module.exports = router</span></span></code> </pre> <br>  Creemos que los comentarios en el c√≥digo lo explican bastante bien.  Esperamos que leerlos sea m√°s conveniente que las explicaciones de dicho c√≥digo dadas despu√©s. <br><br>  Ahora eche un vistazo al archivo de ruta. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> CustomError = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'../CustomError'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> GET = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">req</span></span></span><span class="hljs-function"> =&gt;</span></span> {   <span class="hljs-comment"><span class="hljs-comment">//       return { name: 'Rio de Janeiro' } } const POST = req =&gt; {   //       throw new Error('Some unexpected error, may also be thrown by a library or the runtime.') } const DELETE = req =&gt; {   //  ,      throw new CustomError('CITY_NOT_FOUND', 404, 'The city you are trying to delete could not be found.') } const PATCH = req =&gt; {   //      CustomError   try {       //   -        throw new Error('Some internal error')   } catch (err) {       console.error(err) //    ,           throw new CustomError(           'CITY_NOT_EDITABLE',           400,           'The city you are trying to edit is not editable.'       )   } } module.exports = {   GET,   POST,   DELETE,   PATCH, }</span></span></code> </pre> <br>  En estos ejemplos, no se hace nada con las consultas mismas.  Simplemente considera diferentes escenarios para la ocurrencia de errores.  Entonces, por ejemplo, la solicitud <code>GET /city</code> caer√° en la funci√≥n <code>const GET = req =&gt;...</code> , la <code>POST /city</code> caer√° en la funci√≥n <code>const POST = req =&gt;...</code> y as√≠ sucesivamente.  Este esquema tambi√©n funciona cuando se utilizan par√°metros de consulta.  Por ejemplo, para una solicitud del formulario <code>GET /city?startsWith=R</code>  En general, se ha demostrado aqu√≠ que al procesar errores, la interfaz de usuario puede recibir un error general que contiene solo una oferta para volver a intentarlo o contactar al propietario del servidor, o un error generado utilizando el constructor <code>CustomError</code> que contiene informaci√≥n detallada sobre el problema. <br>  Los datos de error general llegar√°n a la parte del cliente de la aplicaci√≥n en el siguiente formulario: <br><br><pre> <code class="javascript hljs">{   <span class="hljs-attr"><span class="hljs-attr">error</span></span>: <span class="hljs-string"><span class="hljs-string">'GENERIC'</span></span>,   <span class="hljs-attr"><span class="hljs-attr">description</span></span>: <span class="hljs-string"><span class="hljs-string">'Something went wrong. Please try again or contact support.'</span></span> }</code> </pre> <br>  El constructor <code>CustomError</code> se usa as√≠: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CustomError(<span class="hljs-string"><span class="hljs-string">'MY_CODE'</span></span>, <span class="hljs-number"><span class="hljs-number">400</span></span>, <span class="hljs-string"><span class="hljs-string">'Error description'</span></span>)</code> </pre> <br>  Esto proporciona el siguiente c√≥digo JSON pasado a la interfaz: <br><br><pre> <code class="javascript hljs">{   <span class="hljs-attr"><span class="hljs-attr">error</span></span>: <span class="hljs-string"><span class="hljs-string">'MY_CODE'</span></span>,   <span class="hljs-attr"><span class="hljs-attr">description</span></span>: <span class="hljs-string"><span class="hljs-string">'Error description'</span></span> }</code> </pre> <br>  Ahora que hemos trabajado a fondo en la parte del servidor de la aplicaci√≥n, los registros de errores in√∫tiles ya no caen en la parte del cliente.  En cambio, el cliente recibe informaci√≥n √∫til sobre lo que sali√≥ mal. <br><br>  No olvide que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu√≠ se</a> encuentra el repositorio con el c√≥digo considerado aqu√≠.  Puede descargarlo, experimentar con √©l y, si es necesario, adaptarlo a las necesidades de su proyecto. <br><br><h2>  <font color="#3AC1EF">3. Trabajar con errores en el cliente.</font> </h2><br>  Ahora es el momento de describir la tercera parte de nuestro sistema de manejo de errores front-end.  Aqu√≠ ser√° necesario, en primer lugar, manejar los errores que ocurren en la parte cliente de la aplicaci√≥n, y en segundo lugar, ser√° necesario notificar al usuario sobre los errores que ocurren en el servidor.  Primero trataremos con mostrar informaci√≥n de error del servidor.  Como ya se mencion√≥, la biblioteca React se usar√° en este ejemplo. <br><br><h3>  <font color="#3AC1EF">‚ñçGuardar informaci√≥n de error en el estado de la aplicaci√≥n</font> </h3><br>  Al igual que cualquier otro dato, los errores y los mensajes de error pueden cambiar, por lo que tiene sentido colocarlos en el estado de los componentes.  Cuando se monta el componente, los datos de error se restablecen, por lo tanto, cuando el usuario ve por primera vez la p√°gina, no habr√° mensajes de error. <br><br>  El siguiente problema es que los errores del mismo tipo deben mostrarse con el mismo estilo.  Por analog√≠a con el servidor, aqu√≠ puede distinguir 3 tipos de errores. <br><br><ol><li>  Errores globales: esta categor√≠a incluye mensajes de error de naturaleza general que provienen del servidor o errores que, por ejemplo, ocurren si el usuario no ha iniciado sesi√≥n en el sistema en otras situaciones similares. </li><li>  Errores espec√≠ficos generados por el lado del servidor de la aplicaci√≥n: esto incluye errores que se informan desde el servidor.  Por ejemplo, se produce un error similar si un usuario intent√≥ iniciar sesi√≥n y envi√≥ un nombre de usuario y contrase√±a al servidor, y el servidor le inform√≥ que la contrase√±a era incorrecta.  Tales cosas no se verifican en la parte del cliente de la aplicaci√≥n, por lo que los mensajes sobre dichos errores deben provenir del servidor. </li><li>  Errores espec√≠ficos generados por la parte cliente de la aplicaci√≥n.  Un ejemplo de dicho error es un mensaje sobre una direcci√≥n de correo electr√≥nico no v√°lida ingresada en el campo correspondiente. </li></ol><br>  Los errores del segundo y tercer tipo son muy similares, puede trabajar con ellos utilizando el almac√©n de estado de componentes del mismo nivel.  Su principal diferencia es que provienen de diferentes fuentes.  A continuaci√≥n, analizando el c√≥digo, veremos c√≥mo trabajar con ellos. <br><br>  Utilizar√° el sistema incorporado para administrar el estado de la aplicaci√≥n en React, pero, si es necesario, puede usar soluciones especializadas para administrar el estado, como MobX o Redux. <br><br><h3>  <font color="#3AC1EF">‚ñç Errores globales</font> </h3><br>  T√≠picamente, tales mensajes de error se almacenan en el componente de nivel m√°s alto con un estado.  Se muestran en un elemento de interfaz de usuario est√°tico.  Puede ser un cuadro rojo en la parte superior de la pantalla, una ventana modal o cualquier otra cosa.  La implementaci√≥n depende del proyecto espec√≠fico.  As√≠ es como se ve el mensaje de error. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1fb/5d9/c43/1fb5d9c436f66a99bd3b14d07f543740.jpg"></div><br>  <i><font color="#999999">Mensaje de error global</font></i> <br><br>  Ahora eche un vistazo al c√≥digo que est√° almacenado en el archivo <code>Application.js</code> . <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React, { Component } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> GlobalError <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./GlobalError'</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Application</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Component</span></span></span><span class="hljs-class"> </span></span>{   <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(props) {       <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(props)       <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.state = {           <span class="hljs-attr"><span class="hljs-attr">error</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span>,       }       <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._resetError = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._resetError.bind(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>)       <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._setError = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._setError.bind(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>)   }   render() {       <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (           <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">className</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"container"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">               </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">GlobalError</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">error</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{this.state.error}</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">resetError</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{this._resetError}</span></span></span></span><span class="xml"><span class="hljs-tag"> /&gt;</span></span></span><span class="xml">               </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">Handling Errors</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">           </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">       )   }   _resetError() {       this.setState({ error: '' })   }   _setError(newError) {       this.setState({ error: newError })   } } export default Application</span></span></code> </pre> <br>  ,  ,  <code>Application.js</code> ,      .  ,           . <br><br>         <code>GlobalError</code> ,                  <code>x</code>  ,   .    <code>GlobalError</code> ( <code>GlobalError.js</code> ). <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React, { Component } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">GlobalError</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Component</span></span></span><span class="hljs-class"> </span></span>{   render() {       <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.props.error) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>       <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (           <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">               </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">style</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{{</span></span></span></span><span class="xml"><span class="hljs-tag">                   </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">position:</span></span></span></span><span class="xml"><span class="hljs-tag"> '</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">fixed</span></span></span></span><span class="xml"><span class="hljs-tag">',                   </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">top:</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">0</span></span></span></span><span class="xml"><span class="hljs-tag">,                   </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">left:</span></span></span></span><span class="xml"><span class="hljs-tag"> '</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">50</span></span></span></span><span class="xml"><span class="hljs-tag">%',                   </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">transform:</span></span></span></span><span class="xml"><span class="hljs-tag"> '</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">translateX</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">-50</span></span></span></span><span class="xml"><span class="hljs-tag">%)',                   </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">padding:</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">10</span></span></span></span><span class="xml"><span class="hljs-tag">,                   </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">backgroundColor:</span></span></span></span><span class="xml"><span class="hljs-tag"> '#</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">ffcccc</span></span></span></span><span class="xml"><span class="hljs-tag">',                   </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">boxShadow:</span></span></span></span><span class="xml"><span class="hljs-tag"> '</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">0</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">3px</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">25px</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">-10px</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">rgba</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">0</span></span></span></span><span class="xml"><span class="hljs-tag">,</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">0</span></span></span></span><span class="xml"><span class="hljs-tag">,</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">0</span></span></span></span><span class="xml"><span class="hljs-tag">,</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">0.5</span></span></span></span><span class="xml"><span class="hljs-tag">)',                   </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">display:</span></span></span></span><span class="xml"><span class="hljs-tag"> '</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">flex</span></span></span></span><span class="xml"><span class="hljs-tag">',                   </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">alignItems:</span></span></span></span><span class="xml"><span class="hljs-tag"> '</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">center</span></span></span></span><span class="xml"><span class="hljs-tag">',               }}           &gt;</span></span></span><span class="xml">               {this.props.error}                              </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">i</span></span></span></span><span class="xml"><span class="hljs-tag">                   </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">className</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"material-icons"</span></span></span></span><span class="xml"><span class="hljs-tag">                   </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">style</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{{</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">cursor:</span></span></span></span><span class="xml"><span class="hljs-tag"> '</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">pointer</span></span></span></span><span class="xml"><span class="hljs-tag">' }}                   </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">onClick</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{this.props.resetError}</span></span></span></span><span class="xml"><span class="hljs-tag">               &gt;</span></span></span><span class="xml">                   close               </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">font</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">i</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span>           &lt;<span class="hljs-regexp"><span class="hljs-regexp">/div&gt;       )   } } export default GlobalError</span></span></code> </pre> <br>     <code>if (!this.props.error) return null</code> .    ,        .        . , ,  ,        . ,  ,       <code>x</code> ,   -   ,       . <br><br> ,        ,       <code>_setError</code>  <code>Application.js</code> . ,      ,  ,    ,      ( <code>error: 'GENERIC'</code> ).   ( <code>GenericErrorReq.js</code> ). <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React, { Component } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> axios <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'axios'</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">GenericErrorReq</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Component</span></span></span><span class="hljs-class"> </span></span>{   <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(props) {       <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(props)       <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._callBackend = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._callBackend.bind(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>)   }   render() {       <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (           <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">               </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">onClick</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{this._callBackend}</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">Click me to call the backend</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">           </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span>       )   }   _callBackend() {       axios           .post(<span class="hljs-string"><span class="hljs-string">'/api/city'</span></span>)           .then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">result</span></span></span><span class="hljs-function"> =&gt;</span></span> {               <span class="hljs-comment"><span class="hljs-comment">//  -     ,               })           .catch(err =&gt; {               if (err.response.data.error === 'GENERIC') {                   this.props.setError(err.response.data.description)               }           })   } } export default GenericErrorReq</span></span></code> </pre> <br>   ,            .          ,       ,        .          . -,         ,  -,    UX-,        ,    ‚Äî . <br><br><h3> <font color="#3AC1EF">‚ñç  ,    </font> </h3><br>      ,    ,        ,   . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/dee/2f6/bd1/dee2f6bd1605d89c082a46f6feaa86b6.jpg"></div><br> <i><font color="#999999">   </font></i> <br><br>     ,        .           .          .    <code>SpecificErrorReq.js</code> . <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React, { Component } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> axios <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'axios'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> InlineError <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./InlineError'</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SpecificErrorRequest</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Component</span></span></span><span class="hljs-class"> </span></span>{   <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(props) {       <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(props)       <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.state = {           <span class="hljs-attr"><span class="hljs-attr">error</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span>,       }       <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._callBackend = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._callBackend.bind(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>)   }   render() {       <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (           <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">               </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">onClick</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{this._callBackend}</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">Delete your city</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">               </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">InlineError</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">error</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{this.state.error}</span></span></span></span><span class="xml"><span class="hljs-tag"> /&gt;</span></span></span><span class="xml">           </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">       )   }   _callBackend() {       this.setState({           error: '',       })       axios           .delete('/api/city')           .then(result =&gt; {               //  -     ,               })           .catch(err =&gt; {               if (err.response.data.error === 'GENERIC') {                   this.props.setError(err.response.data.description)               } else {                   this.setState({                       error: err.response.data.description,                   })               }           })   } } export default SpecificErrorRequest</span></span></code> </pre> <br>   ,      , ,      <code>x</code> . ,         ,     .   ,     ,  ‚Äî   ,    ,  ,    .        , ,    .       ,      ,       ,   ‚Äî     . <br><br><h3> <font color="#3AC1EF">‚ñç,     </font> </h3><br>    ,            ,        ,   . ,                ,       - .            . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/532/553/2f5/5325532f59efd4ff9ad92e2a33209d9f.jpg"></div><br> <i><font color="#999999">   ,     </font></i> <br><br>    <code>SpecificErrorFrontend.js</code> ,   . <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React, { Component } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> axios <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'axios'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> InlineError <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./InlineError'</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SpecificErrorRequest</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Component</span></span></span><span class="hljs-class"> </span></span>{   <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(props) {       <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(props)       <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.state = {           <span class="hljs-attr"><span class="hljs-attr">error</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span>,           <span class="hljs-attr"><span class="hljs-attr">city</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span>,       }       <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._callBackend = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._callBackend.bind(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>)       <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._changeCity = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._changeCity.bind(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>)   }   render() {       <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (           &lt;div&gt;               &lt;input                   type="text"                   value={this.state.city}                   style={{ marginRight: 15 }}                   onChange={this._changeCity}               /&gt;               &lt;button onClick={this._callBackend}&gt;Delete your city&lt;/button&gt;               &lt;InlineError error={this.state.error} /&gt;           &lt;/div&gt;       )   }   _changeCity(e) {       this.setState({           error: '',           city: e.target.value,       })   }   _validate() {       if (!this.state.city.length) throw new Error('Please provide a city name.')   }   _callBackend() {       this.setState({           error: '',       })       try {           this._validate()       } catch (err) {           return this.setState({ error: err.message })       }       axios           .delete('/api/city')           .then(result =&gt; {               //  -     ,               })           .catch(err =&gt; {               if (err.response.data.error === 'GENERIC') {                   this.props.setError(err.response.data.description)               } else {                   this.setState({                       error: err.response.data.description,                   })               }           })   } } export default SpecificErrorRequest</code> </pre> <br><h3> <font color="#3AC1EF">‚ñç       </font> </h3><br> ,      ,      ( <code>GENERIC</code> ),        ,   .   , ,      , ,  ,    ,   ,   ,           .                 . <br><br><h2>  <font color="#3AC1EF">Resumen</font> </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Esperamos que ahora comprenda c√≥mo lidiar con los errores en las aplicaciones web. </font><font style="vertical-align: inherit;">Algo como esto </font></font><code>console.error(err)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">deber√≠a usarse solo para prop√≥sitos de depuraci√≥n, tales cosas olvidadas por el programador no deber√≠an penetrar en la producci√≥n. </font><font style="vertical-align: inherit;">Simplifica la soluci√≥n al problema de iniciar sesi√≥n utilizando alguna biblioteca adecuada como </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">loglevel</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Estimados lectores! </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬øC√≥mo manejas los errores en tus proyectos?</font></font><br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es431078/">https://habr.com/ru/post/es431078/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es431068/index.html">El arte de la educaci√≥n: la ideolog√≠a de las m√°quinas tragamonedas</a></li>
<li><a href="../es431070/index.html">Hara comer? Estamos hablando de los h√°bitos alimenticios de un especialista en TI moderno.</a></li>
<li><a href="../es431072/index.html">Gu√≠a de JavaScript parte 7: modo estricto, esta palabra clave, eventos, m√≥dulos, matem√°ticas</a></li>
<li><a href="../es431074/index.html">Gu√≠a de JavaScript, Parte 8: Descripci√≥n general de las caracter√≠sticas de ES6</a></li>
<li><a href="../es431076/index.html">Los frameworks Node.js m√°s populares de 2018</a></li>
<li><a href="../es431080/index.html">C√≥mo organizar oficinas remotas y no perder un equipo en el espacio</a></li>
<li><a href="../es431082/index.html">Kotlin: buscando jefe de marketing</a></li>
<li><a href="../es431084/index.html">En cualquier situaci√≥n incomprensible - escriba guiones</a></li>
<li><a href="../es431086/index.html">Todo lo que quer√≠a saber sobre PVS-Studio y no dud√≥ en preguntar</a></li>
<li><a href="../es431088/index.html">La gesti√≥n de archivos se hizo mal - Parte 1: Originalmente de los a√±os 90</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>