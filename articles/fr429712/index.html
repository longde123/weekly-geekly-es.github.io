<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üêû ü¶ç üë®‚Äçüë¶ Introduction aux crochets React ü§∂ üíó üï°</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Si vous lisez Twitter, vous savez tr√®s probablement que Hooks est une nouvelle fonctionnalit√© de React, mais vous pouvez vous demander, comment pouvon...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Introduction aux crochets React</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/429712/"><img src="https://habrastorage.org/webt/fi/qp/xs/fiqpxsj8dqr3mts4ayrpml4es0u.png"><br><br>  Si vous lisez Twitter, vous savez tr√®s probablement que Hooks est une nouvelle fonctionnalit√© de React, mais vous pouvez vous demander, <b>comment pouvons-nous les utiliser dans la pratique</b> ?  Dans cet article, nous allons vous montrer quelques exemples d'utilisation de crochets. <br>  L'une des id√©es cl√©s √† comprendre est que les <b>hooks vous permettent d'utiliser l'√©tat et d'autres fonctionnalit√©s de React sans √©crire de classes</b> . <br><a name="habracut"></a><br><h1>  La motivation derri√®re les crochets </h1><br>  Bien que l'architecture orient√©e composants nous permette de r√©utiliser la vue dans notre application, l'un des plus gros probl√®mes auxquels un d√©veloppeur est confront√© est de savoir comment <b>r√©utiliser la logique bas√©e sur l'√©tat entre les composants</b> .  Lorsque nous avons des composants qui ont une logique d'√©tat similaire, il n'y a pas de bonnes solutions pour r√©utiliser des composants, ce qui peut parfois entra√Æner une duplication de la logique dans les m√©thodes du constructeur et du cycle de vie. <br>  Pour r√©soudre ce probl√®me, utilisez g√©n√©ralement: <br><br><ul><li>  Composants d'ordre √©lev√© </li><li>  accessoires de rendu </li></ul><br>  Mais ces deux mod√®les pr√©sentent des inconv√©nients qui peuvent contribuer √† la complexit√© de la base de code. <br><br>  <b>Les crochets visent √† r√©soudre tous ces probl√®mes, vous permettant d'√©crire des composants fonctionnels qui ont acc√®s √† l'√©tat, au contexte, aux m√©thodes de cycle de vie, √† la r√©f√©rence, etc., sans √©crire de classes.</b> <br><br><h1>  Crochets en Alpha </h1><br><blockquote>  Avant de plonger, il est important de mentionner que le d√©veloppement de l'API Hooks n'est pas encore termin√©. <br><br>  De plus, la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">documentation officielle est</a> tr√®s bonne, et nous vous recommandons de la lire √©galement car elle d√©crit en d√©tail la motivation derri√®re l'introduction de Hooks. <br>  <b>UPD</b> L'article original, dont vous lisez la traduction, a √©t√© √©crit √† une √©poque o√π cette API √©tait en test alpha, au moment o√π React Hooks est officiellement pr√™t √† l'emploi.  Des modifications irr√©versibles apport√©es √† la version (par rapport √† alpha) peuvent √™tre trouv√©es au bas de l'article ou dans les <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">notes de version</a> . <br></blockquote><br><h2>  Comment les crochets se rapportent aux classes </h2><br>  Si vous connaissez React, l'une des meilleures fa√ßons de comprendre les hooks est de voir comment nous pouvons reproduire le comportement que nous avons l'habitude de travailler avec des classes utilisant des hooks. <br><br>  Rappelons que lors de l'√©criture de classes de composants, nous devons souvent: <br><br><ul><li>  G√©rer l'√©tat </li><li>  Utilisez des m√©thodes de cycle de vie comme componentDidMount () et componentDidUpdate () </li><li>  Contexte d'acc√®s (contextType statique) </li></ul><br><br>  Avec React Hooks, nous pouvons reproduire un comportement similaire dans les composants fonctionnels: <br><br><ul><li>  Pour utiliser l'√©tat d'un composant, utilisez le crochet useState () </li><li>  Au lieu d'utiliser des m√©thodes de cycle de vie telles que componentDidMount () et componentDidUpdate (), utilisez le crochet useEffect (). </li><li>  Au lieu d'utiliser la propri√©t√© contextType statique, utilisez le hook useContext (). </li></ul><br><h2>  La derni√®re version de React est requise pour utiliser les crochets. </h2><br>  Vous pouvez commencer avec Hooks d√®s maintenant en changeant la valeur de react et react-dom dans votre package.json en ¬´suivant¬ª. <br><br><img src="https://habrastorage.org/webt/ys/tx/47/ystx47s3snw_tfev_vqedjlzqfe.png"><br><br><h1>  Exemple de crochet UseState () </h1><br>  L'√âtat fait partie int√©grante de React.  Il nous permet de d√©clarer des variables qui contiennent des donn√©es qui, √† leur tour, seront utilis√©es dans notre application.  √Ä l'aide de classes, l'√©tat est g√©n√©ralement d√©fini comme suit: <br><br><img src="https://habrastorage.org/webt/qs/se/7a/qsse7afsrvty1pgadlncirgnljk.png"><br><br>  Avant Hooks, l'√©tat √©tait g√©n√©ralement utilis√© uniquement dans un composant - une classe, mais, comme mentionn√© ci-dessus, <b>Hooks nous permet √©galement d'ajouter l'√©tat √† un composant fonctionnel</b> . <br>  Voyons un exemple ci-dessous.  Ici, nous construisons un commutateur r√©tro-√©clair√© qui change de couleur en fonction de la valeur de l'√©tat.  Pour cela, nous utiliserons hook useState (). <br>  Voici le code complet (et un exemple ex√©cutable) - nous verrons ce qui se passe ci-dessous.  En cliquant sur l'image, vous pouvez regarder cet exemple sur CodeSandBox. <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/ct/-f/xa/ct-fxahjxyoqamk8h-rkguxnfia.png"></a> <br><br><h2>  Notre composant est une fonction </h2><br>  Dans le bloc de code ci-dessus, nous commen√ßons par importer <b>useState</b> de React.  UseState est une nouvelle fa√ßon de profiter des possibilit√©s que cet √©tat pourrait offrir. <br>  Notez ensuite que ce composant <b>est une fonction, pas une classe</b> .  Int√©ressant! <br><br><h2>  √âtat de lecture et d'√©criture </h2><br>  A l'int√©rieur de cette fonction, nous appelons useState pour cr√©er une variable dans l'√©tat: <br><br><img src="https://habrastorage.org/webt/mw/3n/ti/mw3ntirdvzk3oxyedpzi00q-vv0.png"><br><br>  <b>useState est utilis√© pour d√©clarer une variable d'√©tat</b> et peut √™tre initialis√© avec n'importe quel type de valeur (contrairement √† l'√©tat dans les classes, qui devrait √™tre un objet). <br><br>  Comme vu ci-dessus, nous utilisons la d√©structuration sur la valeur de retour de useState. <br><ul><li>  La premi√®re valeur, l√©g√®re dans ce cas, est l'√©tat actuel (comme this.state) </li><li>  La deuxi√®me valeur est la fonction utilis√©e pour mettre √† jour la valeur d'√©tat (premi√®re valeur) (comme this.setState). </li></ul><br>  Ensuite, nous cr√©ons deux fonctions, chacune d√©finissant l'√©tat sur des valeurs diff√©rentes, 0 ou 1. <br><br><img src="https://habrastorage.org/webt/ma/sp/lk/masplkqh6lcp33bsywxmhs9zu7g.png"><br><br>  Ensuite, nous les appliquons en tant que gestionnaires d'√©v√©nements sur les boutons de la vue: <br><br><img src="https://habrastorage.org/webt/bu/6y/ht/bu6yhtzsnm1tory2ro257etb2yi.png"><br><br><h2>  React suit l'√©tat </h2><br>  Lorsque le bouton ¬´On¬ª est enfonc√©, la fonction setOn est appel√©e, qui appelle setLight (1).  L'appel √† setLight (1) <b>met √† jour la valeur de la lumi√®re pour le prochain rendu</b> .  Cela peut sembler un peu magique, mais <b>React garde une trace de la valeur de cette variable</b> et passera une nouvelle valeur lorsque ce composant sera rendu. <br>  Ensuite, nous utilisons l'√©tat actuel ( <b>lumi√®re</b> ) pour d√©terminer si la lampe doit √™tre <b>allum√©e</b> ou non.  Autrement dit, nous d√©finissons la couleur de remplissage du SVG en fonction de la valeur de la <b>lumi√®re</b> .  Si la lumi√®re est 0 (d√©sactiv√©e), fillColor est d√©finie sur # 000000 (et si elle est 1 (activ√©e), fillColor est d√©finie sur # ffbb73). <br><br><h2>  Plusieurs √©tats </h2><br>  Bien que nous ne le fassions pas dans l'exemple ci-dessus, vous pouvez cr√©er plusieurs √©tats en appelant useState plusieurs fois.  Par exemple: <br><br><img src="https://habrastorage.org/webt/f6/hc/rt/f6hcrt31natgsnrwwxznmwya2da.png"><br><br><blockquote>  REMARQUE <br>  Il existe certaines limites √† l'utilisation des crochets dont vous devez √™tre conscient.  Plus important encore, vous ne devez appeler des hooks qu'au niveau sup√©rieur de votre fonction.  Voir ¬´ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">R√®gles des crochets</a> ¬ª pour plus d'informations. </blockquote><br><br><h2>  Exemple de crochet UseEffect () </h2><br>  <b>UseEffect Hook vous permet d'effectuer des effets secondaires dans les composants fonctionnels</b> .  Les effets secondaires peuvent inclure l'acc√®s √† l'API, la mise √† jour du DOM, l'abonnement aux gestionnaires d'√©v√©nements - tout ce que vous voulez, c'est qu'une action ¬´imp√©rative¬ª se produise. <br><br>  √Ä l'aide du hook useEffect (), React sait que vous souhaitez effectuer une action sp√©cifique apr√®s le rendu. <br><br>  Regardons un exemple ci-dessous.  Nous utiliserons useEffect () pour appeler l'API et obtenir une r√©ponse. <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/d3/s9/wm/d3s9wmjvrllc8z6xfwol0hocesg.png"></a> <br><br>  Cet exemple de code utilise √† la fois <b>useState</b> et <b>useEffect</b> , et c'est parce que nous voulons √©crire le r√©sultat de l'appel d'API √† state. <br><br><img src="https://habrastorage.org/webt/l_/ro/uh/l_rouhqptfnk3xxxpevplnsg8qm.png"><br><br><h2>  Recevoir des donn√©es et mettre √† jour l'√©tat </h2><br>  Pour ¬´utiliser l'effet¬ª, nous devons placer notre action dans la fonction <b>useEffect</b> , c'est-√†-dire que nous transmettons l'effet ¬´action¬ª comme une fonction anonyme, comme premier argument √† <b>useEffect</b> . <br>  Dans l'exemple ci-dessus, nous faisons r√©f√©rence √† une API qui renvoie une liste de noms.  Lorsque la <b>r√©ponse</b> revient, nous la convertissons en JSON, puis utilisons <b>setNames (data)</b> pour d√©finir l'√©tat. <br><br><img src="https://habrastorage.org/webt/jn/2m/a6/jn2ma6v7m2cdiiy6pwxoscgdtsq.png"><br><br><h2>  Probl√®mes de performances lors de l'utilisation d'effets </h2><br><br>  Cependant, il y a autre chose √† dire sur l'utilisation de <b>useEffect</b> . <br><br>  La premi√®re chose √† penser est que par d√©faut, notre <b>useEffect</b> sera appel√© √† chaque rendu!  La bonne nouvelle est que nous n'avons pas √† nous soucier des donn√©es obsol√®tes, mais la mauvaise nouvelle est que nous ne voulons probablement pas faire de requ√™te HTTP pour chaque rendu (comme dans ce cas). <br><br>  Vous pouvez ignorer les effets <b>√† l'aide du deuxi√®me argument useEffect</b> , comme dans ce cas.  Le deuxi√®me argument √† useEffect est une liste de variables que nous voulons ¬´observer¬ª, puis nous ne r√©ex√©cuterons l'effet que lorsque l'une de ces valeurs changera. <br><br>  Dans l'exemple de code ci-dessus, notez que nous transmettons <b>un tableau vide</b> comme deuxi√®me argument.  C'est nous qui disons √† React que nous ne voulons nommer cet effet que lors du montage du composant. <br><br><blockquote>  Pour en savoir plus sur les performances des effets, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">consultez cette section dans les livres blancs.</a> </blockquote><br>  De plus, comme la fonction useState, useEffect vous permet d'utiliser plusieurs instances, ce qui signifie que vous pouvez avoir plusieurs fonctions useEffect. <br><br><h2>  Exemple de hook UseContext () </h2><br>  <b>Point de contexte</b> <br><br>  Le contexte dans React est un moyen pour un composant enfant d'acc√©der √† une valeur dans le composant parent. <br><br>  Pour comprendre le besoin de contexte: lors de la cr√©ation d'une application React, vous devez souvent transmettre des valeurs du haut de votre arbre React vers le bas.  En n'utilisant pas de contexte, vous passez des accessoires via des composants qui n'ont pas besoin de les conna√Ætre. <br><br>  Passer des accessoires le long de l'arbre de composants ¬´non li√©s¬ª est affectueusement appel√© forage d'accessoires. <br>  React Context r√©sout le probl√®me de forage des accessoires en vous permettant de partager des valeurs via l'arborescence des composants, avec tout composant qui demande ces valeurs. <br><br>  <b>useContext () simplifie l'utilisation du contexte</b> <br><br>  Avec useContext Hook, l'utilisation du contexte est plus facile que jamais. <br><br>  La fonction <b>useContext ()</b> prend un objet contextuel, qui est initialement renvoy√© par <b>React.createContext ()</b> , puis retourne la valeur de contexte actuelle.  Regardons un exemple ci-dessous. <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/aa/uh/w6/aauhw6dryv5g7ltu15gake6yu_a.png"></a> <br><br>  Dans le code ci-dessus, le contexte du JediContext est cr√©√© √† l'aide de React.createContext (). <br><br>  Nous utilisons JediContext.Provider dans notre composant App et y d√©finissons la valeur "Luke".  Cela signifie que tout composant ayant besoin d'acc√©der au contexte pourra d√©sormais lire cette valeur. <br><br>  Pour lire cette valeur dans la fonction Display (), nous appelons useContext, en passant l'argument JediContext. <br><br>  Ensuite, nous transmettons l'objet contextuel que nous avons obtenu de React.createContext, et il affiche automatiquement la valeur.  Lorsque la valeur du fournisseur est mise √† jour, ce crochet fonctionnera automatiquement avec la derni√®re valeur de contexte. <br><br><h4>  Obtenir un lien vers le contexte dans une application plus grande </h4><br>  Ci-dessus, nous avons cr√©√© JediContext dans les deux composants, mais dans une application plus grande, Display et App seront dans des fichiers diff√©rents.  Par cons√©quent, si vous avez une situation similaire, vous vous demandez peut-√™tre: "Comment obtenir un lien vers JediContext entre les fichiers?" <br><br>  La r√©ponse est que vous devez <b>cr√©er un nouveau fichier qui exporte le JediContext</b> . <br>  Par exemple, vous pourriez avoir un fichier context.js qui contient quelque chose comme ceci: <br><br><img src="https://habrastorage.org/webt/7p/aj/8g/7paj8gv_3osxvml7qa8figr6jnk.png"><br><br>  puis dans App.js (et Display.js), vous devez √©crire: <br><br><img src="https://habrastorage.org/webt/3p/sp/f1/3pspf1ab9sgflp2xvfhqn_edcig.png"><br><br>  Merci, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Dave</a> ) <br><br><h3>  Exemple de crochet UseRef () </h3><br>  Refs fournit un moyen d'acc√©der aux √©l√©ments React cr√©√©s dans la m√©thode render (). <br>  Si vous √™tes nouveau dans les r√©f√©rences React, vous pouvez lire cette <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">introduction aux r√©f√©rences React</a> . <br>  La fonction <b>useRef ()</b> renvoie un objet ref. <br><br><img src="https://habrastorage.org/webt/lx/ti/yw/lxtiywoqga-4a5mynvgtmhc9nhq.png"><br><br><h3>  useRef () et formulaires avec entr√©e </h3><br>  Voyons un exemple d'utilisation du crochet useRef (). <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/kj/5j/kv/kj5jkvt8rawy6g9relz8icq7rks.png"></a> <br><br>  Dans l'exemple ci-dessus, nous utilisons useRef () en combinaison avec useState () pour rendre la valeur d'entr√©e √† la balise p. <br><br>  Ref est cr√©√© dans la variable nameRef.  Ensuite, la variable nameRef peut √™tre utilis√©e en entr√©e, donn√©e comme r√©f√©rence.  Essentiellement, cela signifie que maintenant le contenu du champ de saisie sera accessible via ref. <br><br>  Le bouton d'envoi dans le code a un gestionnaire d'√©v√©nements onClick appel√© submitButton.  La fonction submitButton appelle setName (cr√©√© via useState). <br><br>  Comme nous l'avons d√©j√† fait avec hookState, setName sera utilis√© pour d√©finir le nom de l'√©tat.  Pour extraire le nom de la balise d'entr√©e, nous lisons la valeur de nameRef.current.value. <br><br>  Une autre remarque concernant useRef est qu'il peut √™tre utilis√© plus que l'attribut ref. <br><br><h3>  Utilisation de crochets personnalis√©s </h3><br>  L'une des fonctionnalit√©s les plus int√©ressantes des crochets est que vous pouvez facilement <b>partager la logique entre plusieurs composants en cr√©ant votre propre crochet.</b> <br><br>  Dans l'exemple ci-dessous, nous allons cr√©er un <b>crochet setCounter ()</b> personnalis√© qui nous permet de suivre l'√©tat et de fournir des fonctions de mise √† jour d'√©tat personnalis√©es! <br><br><blockquote>  Voir √©galement, ce crochet <b>useCounter de react</b> <a href="">-use</a> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">useCounter de Kent</a> </blockquote><br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/5j/1t/po/5j1tpoviea-npppg002j2vbyydw.png"></a> <br><br>  Dans le bloc de code ci-dessus, nous cr√©ons une fonction useCounter qui stocke la logique de notre hook. <br><br>  Veuillez noter que useCounter peut utiliser d'autres crochets!  Commen√ßons par cr√©er un nouvel √©tat Hook via useState. <br><br>  Ensuite, nous d√©finissons deux fonctions d'assistance: <b>incr√©menter</b> et <b>d√©cr√©menter</b> , qui appellent <b>setCount</b> et ajustent le <b>nombre</b> actuel en cons√©quence. <br><br>  Enfin, nous renvoyons les liens n√©cessaires pour interagir avec notre hook. <br><br>  Q: Que se passe-t-il en retournant un tableau avec un objet? <br>  R: Eh bien, comme la plupart des choses dans Hooks, les conventions API ne sont pas encore termin√©es.  Mais ce que nous faisons ici renvoie un tableau, o√π: <br><br><ul><li>  Le premier √©l√©ment est la valeur actuelle du crochet. </li><li>  Le deuxi√®me √©l√©ment est un objet contenant les fonctions utilis√©es pour interagir avec le crochet. </li></ul><br>  Cette convention vous permet de ¬´renommer¬ª facilement la valeur actuelle du crochet - comme nous le faisons ci-dessus avec <b>myCount</b> . <br><br>  Cependant, vous pouvez retourner tout ce que vous voulez de votre crochet personnalis√©. <br><br>  Dans l'exemple ci-dessus, nous utilisons l' <b>incr√©mentation</b> et la <b>d√©cr√©mentation</b> comme gestionnaires <b>onClick</b> √† notre avis.  Lorsque l'utilisateur appuie sur les boutons, le compteur est mis √† jour et r√©-affich√© (comme <b>myCount</b> ) dans la vue. <br><br><h2>  √âcriture de tests pour React Hooks </h2><br>  Pour √©crire des tests pour les hooks, nous utiliserons la <b>biblioth√®que react-testing-</b> test. <br><br>  <b>react-testing-library</b> est une solution tr√®s l√©g√®re pour tester les composants React.  C'est une extension de <b>react-dom</b> et <b>react-dom / test-utils</b> .  L'utilisation de la <b>biblioth√®que react-testing</b> garantit que vos tests fonctionnent directement avec les n≈ìuds DOM. <br><br>  Avec les crochets de test, tout n'est pas encore clair.  Actuellement, vous ne pouvez pas tester le hook de mani√®re isol√©e.  Au lieu de cela, vous devez attacher votre crochet au composant et tester ce composant. <br><br>  Donc, ci-dessous, nous √©crirons des tests pour nos crochets, interagissant avec nos composants, et non pas directement avec des crochets.  La bonne nouvelle est que nos tests ressembleront √† des tests React r√©guliers. <br><br><h3>  Test du hook useState () </h3><br>  Voyons un exemple d'√©criture de tests pour <b>useState</b> Hook.  Dans le didacticiel ci-dessus, nous testons plus de variantes de l'exemple useState utilis√© ci-dessus.  Nous √©crirons des tests pour nous assurer que le fait d'appuyer sur le bouton ¬´Off¬ª met l'√©tat √† 0 et d'appuyer sur le bouton ¬´On¬ª met l'√©tat √† 1. <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/y4/tc/i7/y4tci7evnak6quqqgjfp1ngdg9m.png"></a> <br><br>  Dans le bloc de code ci-dessus, nous commen√ßons par importer quelques assistants √† partir de la <b>biblioth√®que react-testing-</b> et du composant sous test. <br><br><ul><li>  <b>rendu</b> , cela aidera √† afficher notre composant.  Il est rendu dans un conteneur qui est ajout√© au <b>document.body</b> </li><li>  <b>getByTestId</b> obtient l'√©l√©ment DOM <b>par data-testid</b> </li><li>  <b>fireEvent</b> , il est utilis√© pour "d√©clencher" des √©v√©nements DOM.  Il attache un gestionnaire d'√©v√©nements pour <b>documenter</b> et traite certains √©v√©nements DOM via la d√©l√©gation d'√©v√©nements, par exemple.  en cliquant sur un bouton. </li></ul><br>  De plus, dans la fonction d'approbation de test, nous d√©finissons les valeurs des variables pour les √©l√©ments avec <b>data-testid</b> et leurs valeurs que nous aimerions utiliser dans le test.  Avec des liens vers des √©l√©ments du DOM, nous pouvons ensuite utiliser la m√©thode <b>fireEvent</b> pour simuler un clic sur un bouton. <br><br>  Le test v√©rifie que si l'on clique sur <b>onButton</b> , la valeur d'√©tat est d√©finie sur 1 et lorsque vous cliquez sur <b>offButton, l'</b> √©tat est 1. <br><br><h3>  Test du crochet useEffect () </h3><br>  Dans cet exemple, nous allons √©crire des tests pour ajouter un produit au panier en utilisant <b>useEffect</b> Hook.  Le nombre d'√©l√©ments est √©galement stock√© dans localStorage.  Le fichier index.js dans CodeSandbox ci-dessous contient la logique r√©elle utilis√©e pour ajouter des articles au panier. <br><br>  Nous allons √©crire des tests pour nous assurer que la mise √† jour du nombre d'articles du panier est √©galement refl√©t√©e dans localStorage, et m√™me si la page se recharge, le nombre d'articles du panier est toujours le m√™me. <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/74/w8/vj/74w8vjaiwkk_okdrqgrgg4s90bc.png"></a> <br><br>  Dans la fonction qui confirme le test, nous d√©finissons d'abord <b>cartItem</b> dans <b>localStorage</b> sur 0, ce qui signifie que le nombre d'√©l√©ments du panier est 0. Ensuite, nous obtenons √† la fois le <b>conteneur</b> et le <b>rendu</b> du composant <b>App</b> via la d√©structuration.  <b>Le rendu</b> nous permet de simuler des rechargements de page. <br><br>  Ensuite, nous obtenons les liens vers les boutons et la balise p, qui affiche la valeur actuelle du panier et les d√©finit en variables. <br><br>  Une fois cela fait, le test simule ensuite un clic sur <b>addButton</b> et v√©rifie si le compteur de panier actuel est 1 et recharge la page, apr√®s quoi s'il v√©rifie si <b>localStorage</b> , <b>cartItem</b> est d√©fini sur 1. Ensuite, il simule un clic sur <b>resetButton</b> et v√©rifie si le nombre actuel d'articles du panier est d√©fini sur 0. <br><br><h3>  Test du crochet useRef () </h3><br>  Dans cet exemple, nous allons tester <b>useRef</b> Hook, et nous utiliserons l'exemple original <b>useRef</b> ci-dessus comme base pour le test.  <b>UseRef est</b> utilis√© pour obtenir la valeur du champ de saisie, puis d√©finit la valeur √† l'√©tat.  Le fichier <b>index.js</b> dans <b>CodeSandbox</b> ci-dessous contient la logique pour entrer une valeur et l'envoyer. <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/zu/m4/yu/zum4yuqeeszwservqx8mzj8ypoy.png"></a> <br><br>  Dans la fonction qui approuve le test, nous d√©finissons les variables dans le champ de saisie, une balise p qui affiche la valeur actuelle de ref et un bouton de soumission.  Nous d√©finissons √©galement la valeur que nous souhaitons saisir dans le champ de saisie de la variable newName.  Cela sera utilis√© pour la v√©rification dans le test. <br><br><img src="https://habrastorage.org/webt/pj/gz/jz/pjgzjzqildkkv6tkasce6xy389c.png"><br><br>  La m√©thode fireEvent.change est utilis√©e pour entrer une valeur dans le champ de saisie, auquel cas le nom stock√© dans la constante newName est utilis√©, apr√®s quoi le bouton d'envoi est enfonc√©. <br><br>  Le test v√©rifie ensuite si la valeur ref apr√®s avoir appuy√© sur le bouton <b>correspond √† la</b> valeur de <b>newName</b> . <br><br>  Enfin, vous devriez voir "Pas de crash de test, f√©licitations!"  message dans la console. <br><br><h3>  R√©ponse de la communaut√© aux crochets </h3><br>  Depuis l'introduction de React Hooks, la communaut√© est ravie de cette fonctionnalit√©, et nous avons vu de <b>nombreux</b> exemples et exemples d'utilisation de React Hooks.  En voici quelques-uns: <br><br><ul><li>  Ce <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">site</a> contient une collection de React Hooks. </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">react-use</a> , la biblioth√®que livr√©e avec un tas de React Hooks. </li><li>  Cet exemple <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">CodeSandbox</a> montre comment utiliser useEffect Hook pour cr√©er des animations √† l'aide de react <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">-spring</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Un exemple</a> useMutableReducer qui vous permet de simplement muter un √©tat pour le mettre √† jour dans un r√©ducteur. </li><li>  Cet <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">exemple se trouve</a> sur CodeSandbox, qui montre une utilisation int√©gr√©e complexe de la communication parent-enfant et l'utilisation de redisers. </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Composant du commutateur</a> React Hooks </li><li>  Une autre <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">collection de React Hooks</a> qui a des crochets pour les valeurs d'entr√©e, l'orientation du p√©riph√©rique et la visibilit√© du document. </li></ul><br><br><h3>  Diff√©rents types de crochets </h3><br>  Il existe diff√©rents types de crochets que vous pouvez commencer √† utiliser dans votre application React.  Ils sont list√©s ci-dessous: <br><br><ul><li>  <b>useState</b> - nous permet d'√©crire des fonctions pures avec acc√®s √† l'√©tat en elles. </li><li>  <b>useEffect</b> - nous permet d'effectuer des effets secondaires.  Les effets secondaires peuvent √™tre des appels API, la mise √† jour du DOM, l'abonnement √† des gestionnaires d'√©v√©nements. </li><li>  <b>useContext</b> - vous permet d'√©crire des fonctions pures avec du contexte dedans. </li><li>  <b>useReducer</b> - nous donne un lien vers un r√©ducteur de type Redux </li><li>  <b>useRef</b> - vous permet d'√©crire des fonctions pures qui retournent un objet ref mutable. </li><li> <b>useMemo</b> -      . </li><li> <b>useCallback</b> ‚Äî  Hook     . </li><li> <b>useImperativeMethods</b> -   ,       ref. </li><li> <b>useMutationEffects</b> ‚Äî   useEffect Hook   ,     DOM-. </li><li> <b>useLayoutEffect</b> -       DOM   -. </li><li> <b> hooks</b> -        . </li></ul><br><br><h3>  hooks </h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La grande chose √† propos des Hooks est qu'ils fonctionnent c√¥te √† c√¥te avec le code existant, vous pouvez donc lentement apporter des modifications qui impl√©mentent Hooks. Tout ce que vous avez √† faire est de mettre √† niveau React vers une version prenant en charge les hooks. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cependant, les Hooks sont toujours une fonctionnalit√© exp√©rimentale, et l'√©quipe React a averti √† plusieurs reprises que l'API est susceptible de changer. Consid√©rez que vous √™tes averti. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Que signifie l'√©mergence des crochets pour les classes? Comme le rapporte l'√©quipe React, les classes restent toujours, elles sont une partie √©norme de la base de code React, et le seront probablement pendant un certain temps √† venir.</font></font><br><br><blockquote>      .  Facebook      ,  , ,    ,     .    React  Hooks,          ‚Äî <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="> </a> </blockquote><br> <b>  API- Hooks   ,    Hooks,   ,      .</b> <br><br><h3>  Ressources suppl√©mentaires </h3><br><ul><li>  React      React Hooks,    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="></a> </li><li> API    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="></a> . </li><li>    RFC,     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="></a> ,       </li></ul><br><br><blockquote> <b>UPD</b> <br>  : <br>      React 16.8   Hooks API.        -: <br> ‚Äî  useMutationEffect. <br> ‚Äî  useImperativeMethods  useImperativeHandle. <br> ‚Äî         useState  useReducer Hooks. <br> ‚Äî      ,   useEffect/useMemo/useCallback Hooks. <br> ‚Äî  Object.is     useState  useReducer. <br> ‚Äî     Strict Mode (DEV-only). <br> ‚Äî  lazy initialization API  useReducer Hook. <br>    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="></a> . <br></blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr429712/">https://habr.com/ru/post/fr429712/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr429702/index.html">Google Analytics Pixel Sync Facebook, VK, Yandex, MyTarget</a></li>
<li><a href="../fr429704/index.html">Connectez le stockage LUN √† chemins d'acc√®s multiples √† Windows Server 2008 et Windows Server 2012</a></li>
<li><a href="../fr429706/index.html">A1: 2017 - Injections (partie 3 et derni√®res)</a></li>
<li><a href="../fr429708/index.html">Dans le cadre du programme HolyJS 2018 Moscou</a></li>
<li><a href="../fr429710/index.html">Le dioxyde de carbone sur l'ISS</a></li>
<li><a href="../fr429714/index.html">Plus simple que MQTT? MQTT / UDP</a></li>
<li><a href="../fr429716/index.html">5 meilleurs jeux PC pour apprendre l'anglais</a></li>
<li><a href="../fr429718/index.html">Je veux tout √† la fois! Nous √©tudions la RAM HyperX Predator DDR4 RGB, avec une fr√©quence de 4000 MHz</a></li>
<li><a href="../fr429720/index.html">Comment un d√©veloppeur novice pour survivre dans une interview et ne pas devenir fou au travail</a></li>
<li><a href="../fr429722/index.html">Comment nous avons effectu√© le paiement via Google Pay dans Yandex.Cash [mis √† jour]</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>