<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üí© üéí üë®‚Äçüë©‚Äçüëß Deep Learning ahora est√° en Java üë®üèΩ‚Äç‚úàÔ∏è üßíüèΩ üí¨</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="¬øNo te gusta Java? ¬°S√≠, no sabes c√≥mo cocinarlo! Mani Sarkar nos invita a conocer la herramienta Valohai, que le permite realizar investigaciones mode...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Deep Learning ahora est√° en Java</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/469405/">  ¬øNo te gusta Java?  ¬°S√≠, no sabes c√≥mo cocinarlo!  Mani Sarkar nos invita a conocer la herramienta Valohai, que le permite realizar investigaciones modelo en Java. <br><br><img src="https://habrastorage.org/webt/et/p-/se/etp-sezekre2qlznmvgdzlgds0a.png"><br><a name="habracut"></a><br><div class="spoiler">  <b class="spoiler_title">Descargo de responsabilidad del traductor</b> <div class="spoiler_text"> Espero que esta no sea una publicaci√≥n publicitaria.  No estoy afiliado a Valohai.  Acabo de traducir el art√≠culo al que remito el enlace.  Si se traduce torpemente, patee PM.  Si es necesario, puedo eliminar enlaces y mencionar otros recursos externos.  Gracias por su comprensi√≥n <br></div></div><br><h3>  Introduccion </h3><br>  Hace alg√∫n tiempo, me encontr√© con un servicio en la nube llamado Valohai, y estaba satisfecho con su interfaz de usuario y la simplicidad del dise√±o y el dise√±o.  Ped√≠ el servicio de uno de los miembros de Valohai y recib√≠ una versi√≥n demo.  Antes de eso, escrib√≠ una tuber√≠a simple usando GNU Parallel, JavaScript, Python y Bash, y otra que usa solo GNU Parallel y Bash. <br><br>  Tambi√©n pens√© en usar herramientas de administraci√≥n de tareas / flujo de trabajo listas para usar como Jenkins X, Jenkins Pipeline, Concourse o Airflow, pero por varias razones decid√≠ no hacerlo. <br><br>  Not√© que muchos ejemplos y documentaci√≥n de Valohai se basan en Python y R y sus respectivos marcos y bibliotecas.  Decid√≠ no perder la oportunidad y quiero corregir la falta de ejemplos y documentaci√≥n. <br><br>  Valohai me presion√≥ para implementar algo usando la famosa biblioteca de Java llamada <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">DL4J - Deep Learning for Java</a> . <br><br>  Mi primera experiencia con Valohai me caus√≥ una buena impresi√≥n despu√©s de sentirme a trav√©s de su dise√±o, dise√±o y flujo de trabajo.  Los creadores ya han tenido en cuenta varios aspectos tanto de los flujos de trabajo como de la infraestructura del desarrollador.  En nuestro mundo, el proceso de desarrollo de infraestructura est√° controlado principalmente por los equipos DevOps o SysOps, y conocemos los matices y los puntos d√©biles asociados con √©l. <br><br><h3>  ¬øQu√© necesitamos y c√≥mo? </h3><br>  En cualquier proyecto de aprendizaje autom√°tico, hay dos componentes importantes (desde un punto de vista de alto nivel): un c√≥digo que funcionar√° con el modelo y un c√≥digo que funcionar√° con la infraestructura, en la que se ejecutar√° todo el ciclo de vida del proyecto. <br><br>  Por supuesto, habr√° pasos y componentes necesarios antes, durante y despu√©s, pero para simplificar, digamos, necesitamos c√≥digo e infraestructura. <br><br><h4>  C√≥digo </h4><br>  Para el c√≥digo, eleg√≠ un ejemplo complejo usando DL4J, este es un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">proyecto MNist</a> con un conjunto de capacitaci√≥n de 60,000 im√°genes y un conjunto de prueba de 10,000 im√°genes de d√≠gitos escritos a mano.  Este conjunto de datos est√° disponible a trav√©s de la biblioteca DL4J (al igual que Keras). <br><br>  Antes de comenzar, le recomendamos que eche un vistazo al c√≥digo fuente que usaremos.  La clase principal de Java se llama <a href="">org.deeplearning4j.feedforward.mnist.MLPMnistSingleLayerRunner</a> . <br><br><h4>  La infraestructura </h4><br>  Decidimos probar el ejemplo de Java utilizando Valohai como nuestra infraestructura para realizar experimentos (capacitaci√≥n y evaluaci√≥n de modelos).  Valohai reconoce los repositorios git y se conecta directamente a ellos, lo que nos permite ejecutar nuestro c√≥digo independientemente de la plataforma o el idioma, as√≠ que veremos c√≥mo funciona.  Tambi√©n significa que si usa GitOps o Infrastructure-As-Code, todo funcionar√° para usted tambi√©n. <br><br>  Para hacer esto, solo necesitamos una cuenta en Valohai.  Despu√©s de crear una cuenta gratuita, tenemos acceso a varias instancias de varias configuraciones.  Para lo que nos gustar√≠a hacer, Free-Tier es m√°s que suficiente. <br><br><h4>  Aprendizaje profundo para Java y Valohai </h4><br>  Proporcionaremos todas las dependencias a la imagen de Docker y la usaremos para compilar nuestra aplicaci√≥n Java, entrenar el modelo y evaluarlo en la plataforma Valohai usando un simple archivo <a href="">valohai.yaml</a> ubicado en la carpeta ra√≠z del repositorio del proyecto. <br><br><h4>  Aprendizaje profundo para Java: DL4J </h4><br>  La parte mas simple.  No tenemos que hacer mucho, solo recolecte el jar y cargue el conjunto de datos en el contenedor Docker.  Tenemos una imagen Docker pre-creada que contiene todas las dependencias necesarias para crear una aplicaci√≥n Java.  Ponemos esta imagen en el Docker Hub, y puede encontrarla buscando dl4j-mnist-single-layer (usaremos una etiqueta especial como se define en el archivo YAML).  Decidimos utilizar GraalVM 19.1.1 como nuestro entorno Java de compilaci√≥n y tiempo de ejecuci√≥n para este proyecto, y est√° integrado en la imagen de Docker. <br><br>  Cuando se llama al uber jar desde la l√≠nea de comandos, creamos la clase MLPMnistSingleLayerRunner, que nos dice la acci√≥n deseada, dependiendo de los par√°metros pasados ‚Äã‚Äãa: <br><br><pre><code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String[] args)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> Exception </span></span>{ MLPMnistSingleLayerRunner mlpMnistRunner = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MLPMnistSingleLayerRunner(); JCommander.newBuilder() .addObject(mlpMnistRunner) .build() .parse(args); mlpMnistRunner.execute(); }</code> </pre> <br>  Los par√°metros pasados ‚Äã‚Äãa uber jar son aceptados por esta clase y procesados ‚Äã‚Äãpor el m√©todo execute (). <br><br>  Podemos crear un modelo usando el par√°metro --action train y evaluar el modelo creado usando el par√°metro --action Evaluation pasado a la aplicaci√≥n Java. <br><br>  Las partes principales de la aplicaci√≥n Java que hace este trabajo se pueden encontrar en las dos clases Java mencionadas en las secciones a continuaci√≥n. <br><br><h3>  Entrenamiento modelo </h3><br>  Llamar <br><br><pre> <code class="plaintext hljs">./runMLPMnist.sh --action train --output-dir ${VH_OUTPUTS_DIR} or java -Djava.library.path="" \ -jar target/MLPMnist-1.0.0-bin.jar \ --action train --output-dir ${VH_OUTPUTS_DIR}</code> </pre><br>  Este comando crea un modelo llamado mlpmnist-single-layer.pb en la carpeta especificada por el par√°metro --output-dir pasado al inicio de la ejecuci√≥n.  Desde el punto de vista de Valohai, debe colocarse en $ {VH_OUTPUTS_DIR}, lo cual hacemos (ver el archivo <a href="">valohai.yaml</a> ). <br><br>  Para el c√≥digo fuente, vea la clase <a href="">MLPMNistSingleLayerTrain.java</a> . <br><br><h3>  Evaluaci√≥n modelo </h3><br>  Llamar <br><br><pre> <code class="plaintext hljs">./runMLPMnist.sh --action evaluate --input-dir ${VH_INPUTS_DIR}/model or java -Djava.library.path="" \ -jar target/MLPMnist-1.0.0-bin.jar \ --action evaluate --input-dir ${VH_INPUTS_DIR}/model</code> </pre><br>  Se supone que el modelo (creado durante la fase de entrenamiento) con el nombre mlpmnist-single-layer.pb estar√° presente en la carpeta especificada en el par√°metro --input-dir pasado cuando se llam√≥ a la aplicaci√≥n. <br><br>  Para el c√≥digo fuente, vea la clase <a href="">MLPMNistSingleLayerEvaluate.java</a> . <br><br>  Espero que esta breve ilustraci√≥n aclare c√≥mo funciona una aplicaci√≥n Java que ense√±a y eval√∫a un modelo. <br><br>  Esto es todo lo que se requiere de nosotros, pero no dude en jugar con el resto de las <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">fuentes</a> (junto con los <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">scripts README.md</a> y bash) y satisfacer su curiosidad y comprensi√≥n de c√≥mo se hace. <br><br><h3>  Valohai </h3><br>  Valohai nos permite vincular libremente nuestro tiempo de ejecuci√≥n, c√≥digo y conjunto de datos, como puede ver en la estructura de archivos YAML a continuaci√≥n.  Por lo tanto, varios componentes pueden desarrollarse independientemente uno del otro.  En consecuencia, solo los componentes de ensamblaje y tiempo de ejecuci√≥n se empaquetan en nuestro contenedor Docker. <br><br>  En tiempo de ejecuci√≥n, recolectamos el UAR JAR en un contenedor Docker, lo cargamos en un almacenamiento interno o externo, y luego usamos el otro paso de ejecuci√≥n para cargar el UAR JAR y el conjunto de datos del almacenamiento (u otro lugar) para comenzar el entrenamiento.  Por lo tanto, los dos pasos de ejecuci√≥n est√°n desconectados;  Por ejemplo, podemos compilar una jarra una vez y completar cientos de pasos de entrenamiento en una sola jarra.  Debido a que los entornos de ensamblaje y tiempo de ejecuci√≥n no tienen que cambiar con tanta frecuencia, podemos almacenarlos en cach√©, y el c√≥digo, los conjuntos de datos y los modelos pueden ser accesibles din√°micamente en tiempo de ejecuci√≥n. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">valohai.yaml</a> <br>  La parte principal de la integraci√≥n de nuestro proyecto Java con la infraestructura de Valohai es determinar el orden de los pasos de Ejecuci√≥n en el archivo valohai.yaml ubicado en la ra√≠z de la carpeta de su proyecto.  Nuestro valohai.yaml se ve as√≠: <br><br><pre> <code class="xml hljs">--- - step: name: Build-dl4j-mnist-single-layer-java-app image: neomatrix369/dl4j-mnist-single-layer:v0.5 command: - cd ${VH_REPOSITORY_DIR} - ./buildUberJar.sh - echo "~~~ Copying the build jar file into ${VH_OUTPUTS_DIR}" - cp target/MLPMnist-1.0.0-bin.jar ${VH_OUTPUTS_DIR}/MLPMnist-1.0.0.jar - ls -lash ${VH_OUTPUTS_DIR} environment: aws-eu-west-1-g2-2xlarge - step: name: Run-dl4j-mnist-single-layer-train-model image: neomatrix369/dl4j-mnist-single-layer:v0.5 command: - echo "~~~ Unpack the MNist dataset into ${HOME} folder" - tar xvzf ${VH_INPUTS_DIR}/dataset/mlp-mnist-dataset.tgz -C ${HOME} - cd ${VH_REPOSITORY_DIR} - echo "~~~ Copying the build jar file from ${VH_INPUTS_DIR} to current location" - cp ${VH_INPUTS_DIR}/dl4j-java-app/MLPMnist-1.0.0.jar . - echo "~~~ Run the DL4J app to train model based on the the MNist dataset" - ./runMLPMnist.sh {parameters} inputs: - name: dl4j-java-app description: DL4J Java app file (jar) generated in the previous step 'Build-dl4j-mnist-single-layer-java-app' - name: dataset default: https://github.com/neomatrix369/awesome-ai-ml-dl/releases/download/mnist-dataset-v0.1/mlp-mnist-dataset.tgz description: MNist dataset needed to train the model parameters: - name: --action pass-as: '--action {v}' type: string default: train description: Action to perform ie train or evaluate - name: --output-dir pass-as: '--output-dir {v}' type: string default: /valohai/outputs/ description: Output directory where the model will be created, best to pick the Valohai output directory environment: aws-eu-west-1-g2-2xlarge - step: name: Run-dl4j-mnist-single-layer-evaluate-model image: neomatrix369/dl4j-mnist-single-layer:v0.5 command: - cd ${VH_REPOSITORY_DIR} - echo "~~~ Copying the build jar file from ${VH_INPUTS_DIR} to current location" - cp ${VH_INPUTS_DIR}/dl4j-java-app/MLPMnist-1.0.0.jar . - echo "~~~ Run the DL4J app to evaluate the trained MNist model" - ./runMLPMnist.sh {parameters} inputs: - name: dl4j-java-app description: DL4J Java app file (jar) generated in the previous step 'Build-dl4j-mnist-single-layer-java-app' - name: model description: Model file generated in the previous step 'Run-dl4j-mnist-single-layer-train-model' parameters: - name: --action pass-as: '--action {v}' type: string default: evaluate description: Action to perform ie train or evaluate - name: --input-dir pass-as: '--input-dir {v}' type: string default: /valohai/inputs/model description: Input directory where the model created by the previous step can be found created environment: aws-eu-west-1-g2-2xlarge</code> </pre><br><h4>  C√≥mo funciona Build-dl4j-mnist-single-layer-java-app </h4><br>  Desde el archivo YAML, vemos que definimos este paso, primero usando la imagen de Docker y luego ejecutando el script para construir el JAR de Uber.  Nuestra imagen acoplable tiene personalizaci√≥n de dependencias del entorno de compilaci√≥n (por ejemplo, GraalVM JDK, Maven, etc.) para crear una aplicaci√≥n Java.  No proporcionamos ninguna entrada o par√°metro, ya que esta es la fase de ensamblaje.  Una vez que la compilaci√≥n es exitosa, copiamos el archivo uber llamado MLPMnist-1.0.0-bin.jar (nombre original) a la carpeta / valohai / salidas (representada como $ {VH_OUTPUTS_DIR}).  Todo en esta carpeta se guarda autom√°ticamente en el almacenamiento de su proyecto, por ejemplo, en la papelera de reciclaje de AWS S3.  Finalmente, definimos nuestro trabajo para AWS. <br><br><div class="spoiler">  <b class="spoiler_title">Nota</b> <div class="spoiler_text">  La cuenta gratuita de Valohai no tiene acceso a la red desde el contenedor Docker (esto est√° deshabilitado de forma predeterminada), comun√≠quese con el soporte para habilitar esta opci√≥n (tuve que hacer lo mismo), de lo contrario no podremos descargar nuestro Maven y otras dependencias durante el montaje <br></div></div><br><h4>  C√≥mo funciona Run-dl4j-mnist-single-layer-train-model </h4><br>  La sem√°ntica de la definici√≥n es similar al paso anterior, excepto que especificamos dos entradas: una para uber jar (MLPMnist-1.0.0.jar) y la otra para el conjunto de datos (desempaquetado en la carpeta $ {HOME} /. Deeplearning4j).  Pasaremos dos par√°metros: --action train y --output-dir / valohai / salidas.  El modelo creado en este paso est√° integrado en / valohai / salidas / model (representado como $ {VH_OUTPUTS_DIR} / model). <br><br><div class="spoiler">  <b class="spoiler_title">Nota</b> <div class="spoiler_text">  En los campos de entrada en la pesta√±a Ejecutar de la interfaz web de Valohai, podemos seleccionar la salida de ejecuciones anteriores usando el n√∫mero de ejecuci√≥n, es decir, # 1 o # 2, adem√°s de usar el datum: // o http: / URLs /, ingresar algunas letras del nombre del archivo tambi√©n ayuda a buscar en toda la lista. <br></div></div><br><h4>  C√≥mo funciona Run-dl4j-mnist-single-layer -valu-model </h4><br>  Nuevamente, este paso es similar al paso anterior, excepto que pasaremos dos par√°metros: evaluaci√≥n de acci√≥n y --input-dir / valohai / inputs / model.  Adem√°s, nuevamente indicamos en la entrada: las secciones definidas en el archivo YAML con el nombre dl4j-java-app y el modelo sin el valor predeterminado para ambos.  Esto nos permitir√° seleccionar el uber jar y el modelo que queremos evaluar, que fue creado usando el paso Run-dl4j-mnist-single-layer-train-model usando la interfaz web. <br><br>  Espero que esto explique los pasos en el archivo de definici√≥n anterior, pero si necesita m√°s ayuda, no dude en ver la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">documentaci√≥n</a> y los <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">tutoriales</a> . <br><br><h3>  Interfaz web Valohai </h3><br>  Despu√©s de recibir la cuenta, podemos iniciar sesi√≥n y continuar creando el proyecto con el nombre mlpmnist-single-layer y asociar git repo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">github.com/valohai/mlpmnist-dl4j-example</a> con el proyecto y guardar el proyecto. <br><br>  ¬°Ahora puedes completar el paso y ver c√≥mo resulta! <br><br><h4>  Construir una aplicaci√≥n Java DL4J </h4><br>  Vaya a la pesta√±a "Ejecuci√≥n" en la interfaz web y copie la ejecuci√≥n existente o cree una nueva con el bot√≥n [Crear ejecuci√≥n].  Se completar√°n todos los par√°metros predeterminados necesarios.  Seleccione Step Build-dl4j-mnist-single-layer-java-app. <br><br>  Para el <i>entorno,</i> seleccion√© AWS eu-west-1 g2.2xlarge y hice clic en el bot√≥n [Crear ejecuci√≥n] en la parte inferior de la p√°gina para ver el inicio de la ejecuci√≥n. <br><br><img src="https://habrastorage.org/webt/le/18/zo/le18zo_udbscmekflaux7kqfjcw.png"><br><br><h3>  Entrenamiento modelo </h3><br>  Vaya a la pesta√±a "Ejecuci√≥n" en la interfaz web y haga lo mismo que en el paso anterior, y seleccione Ejecutar-dl4j-mnist-single-layer-train-model.  Deber√° seleccionar la aplicaci√≥n Java (solo ingrese jar en el campo) creada en el paso anterior.  El conjunto de datos ya se ha rellenado previamente utilizando el archivo valohai.yaml: <br><br><img src="https://habrastorage.org/webt/md/ls/ov/mdlsovhg3vw9zjnpoeqhxwzgk7w.png"><br><br>  Haga clic en [Crear ejecuci√≥n] para comenzar. <br><br><img src="https://habrastorage.org/webt/6n/mr/wm/6nmrwmveck6cgdughud1xgx7qdg.png"><br><br>  Ver√° el resultado en la consola: <br><br><pre> <code class="plaintext hljs">[&lt;--- snipped ---&gt;] 11:17:05 ======================================================================= 11:17:05 LayerName (LayerType) nIn,nOut TotalParams ParamsShape 11:17:05 ======================================================================= 11:17:05 layer0 (DenseLayer) 784,1000 785000 W:{784,1000}, b:{1,1000} 11:17:05 layer1 (OutputLayer) 1000,10 10010 W:{1000,10}, b:{1,10} 11:17:05 ----------------------------------------------------------------------- 11:17:05 Total Parameters: 795010 11:17:05 Trainable Parameters: 795010 11:17:05 Frozen Parameters: 0 11:17:05 ======================================================================= [&lt;--- snipped ---&gt;]</code> </pre><br>  Los modelos creados se pueden encontrar en la pesta√±a "Salidas" de la pesta√±a principal "Ejecuci√≥n" durante y despu√©s de la ejecuci√≥n: <br><br><img src="https://habrastorage.org/webt/pg/g2/-k/pgg2-kmsr85x87fedfoy24lreye.png"><br><br>  Puede observar varios artefactos en la subpesta√±a Salidas.  Esto se debe a que mantenemos puntos de control al final de cada era.  Veamos esto en los registros: <br><br><pre> <code class="plaintext hljs">[&lt;--- snipped ---&gt;] 11:17:14 odolCheckpointListener - Model checkpoint saved: epoch 0, iteration 469, path: /valohai/outputs/checkpoint_0_MultiLayerNetwork.zip [&lt;--- snipped ---&gt;]</code> </pre><br>  El punto de control contiene el estado del modelo en tres archivos: <br><br><pre> <code class="plaintext hljs">configuration.json coefficients.bin updaterState.bin</code> </pre><br><h3>  Modelo de entrenamiento.  Metadatos </h3><br>  Es posible que haya notado estas entradas en los registros de ejecuci√≥n: <br><br><pre> <code class="plaintext hljs">[&lt;--- snipped ---&gt;] 11:17:05 {"epoch": 0, "iteration": 0, "score (loss function)": 2.410047} 11:17:07 {"epoch": 0, "iteration": 100, "score (loss function)": 0.613774} 11:17:09 {"epoch": 0, "iteration": 200, "score (loss function)": 0.528494} 11:17:11 {"epoch": 0, "iteration": 300, "score (loss function)": 0.400291} 11:17:13 {"epoch": 0, "iteration": 400, "score (loss function)": 0.357800} 11:17:14 odolCheckpointListener - Model checkpoint saved: epoch 0, iteration 469, path: /valohai/outputs/checkpoint_0_MultiLayerNetwork.zip [&lt;--- snipped ---&gt;]</code> </pre><br>  Estos datos le permiten a Valohai obtener estos valores (en formato JSON), que se utilizar√°n para crear las m√©tricas que se pueden ver durante y despu√©s de la ejecuci√≥n en la pesta√±a Metadatos adicional en la pesta√±a principal Ejecuciones: <br><br><img src="https://habrastorage.org/webt/et/p-/se/etp-sezekre2qlznmvgdzlgds0a.png"><br><br>  Pudimos hacer esto conectando la clase ValohaiMetadataCreator al modelo, para que Valohai se refiera a esta clase durante el entrenamiento.  En el caso de esta clase, derivamos varias eras, el n√∫mero de iteraciones y la puntuaci√≥n (valor de la funci√≥n de p√©rdida).  Aqu√≠ hay un fragmento de c√≥digo de la clase: <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">iterationDone</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Model model, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> iteration, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> epoch)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (printIterations &lt;= <span class="hljs-number"><span class="hljs-number">0</span></span>) printIterations = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (iteration % printIterations == <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> score = model.score(); System.out.println(String.format( <span class="hljs-string"><span class="hljs-string">"{\"epoch\": %d, \"iteration\": %d, \"score (loss function)\": %f}"</span></span>, epoch, iteration, score) ); } }</code> </pre><br><h3>  Evaluaci√≥n modelo </h3><br>  Una vez que el modelo se haya creado con √©xito en el paso anterior, debe evaluarse.  Creamos una nueva Ejecuci√≥n de la misma manera que antes, pero esta vez seleccione el paso Run-dl4j-mnist-single-layer -valu-model.  Tendremos que seleccionar la aplicaci√≥n Java (MLPMnist-1.0.0.jar) y el modelo creado (mlpmnist-single-layer.pb) nuevamente antes de comenzar la ejecuci√≥n (como se muestra a continuaci√≥n): <br><br><img src="https://habrastorage.org/webt/e9/_b/am/e9_bamnlhownoo40utziaqazg8e.png"><br><br>  Despu√©s de seleccionar el modelo deseado como entrada, haga clic en el bot√≥n [Crear ejecuci√≥n].  Se ejecutar√° m√°s r√°pido que el anterior, y veremos el siguiente resultado: <br><br><img src="https://habrastorage.org/webt/gp/0i/co/gp0icomuurv7a0gt-niye5hyri4.png"><br><br>  Vemos que nuestro "hola mundo" condujo a un modelo cuya precisi√≥n es aproximadamente del 97% basada en un conjunto de datos de prueba.  La matriz de confusi√≥n ayuda a encontrar casos en los que un d√≠gito se predijo incorrectamente como otro d√≠gito. <br><br>  La pregunta permanece (y m√°s all√° del alcance de esta publicaci√≥n): ¬øqu√© tan bueno es el modelo cuando se enfrenta a datos reales? <br><br>  Para clonar un repositorio de git, esto es lo que debe hacer: <br><br><pre> <code class="plaintext hljs"> $ git clone https://github.com/valohai/mlpmnist-dl4j-example</code> </pre><br>  Luego, necesitamos vincular nuestro proyecto Valohai, creado a trav√©s de la interfaz web en la secci√≥n anterior, con el proyecto almacenado en nuestra m√°quina local (la que acabamos de clonar).  Ejecute los siguientes comandos para hacer esto: <br><br><pre> <code class="plaintext hljs">$ cd mlpmnist-dl4j-example $ vh project --help ### to see all the project-specific options we have for Valohai $ vh project link</code> </pre><br>  Se le mostrar√° algo como esto: <br><br><pre> <code class="plaintext hljs">[ 1] mlpmnist-single-layer ... Which project would you like to link with /path/to/mlpmnist-dl4j-example? Enter [n] to create a new project.:</code> </pre><br>  Seleccione 1 (o el que m√°s le convenga) y deber√≠a ver este mensaje: <br><br><pre> <code class="plaintext hljs">Success! Linked /path/to/mlpmnist-dl4j-example to mlpmnist-single-layer.</code> </pre><br>  Una cosa m√°s, antes de continuar, aseg√∫rese de que su proyecto Valohai est√© sincronizado con el √∫ltimo proyecto git haciendo esto: <br><br><pre> <code class="plaintext hljs"> $ vh project fetch</code> </pre><br><img src="https://habrastorage.org/webt/h0/l4/vb/h0l4vbe1eqis5kb9sd7gfslbozk.png"><br><br>  Ahora podemos completar los pasos desde la CLI con: <br><br><pre> <code class="plaintext hljs"> $ vh exec run Build-dl4j-mnist-single-layer-java-app</code> </pre><br>  Una vez realizada la ejecuci√≥n, podemos verificarlo con: <br><br><pre> <code class="plaintext hljs">$ vh exec info $ vh exec logs $ vh exec watch</code> </pre><br><h3>  Conclusi√≥n </h3><br>  Como hemos visto, es muy conveniente trabajar juntos con DL4J y Valohai.  Adem√°s, podemos desarrollar los diversos componentes que componen nuestros experimentos (investigaci√≥n), es decir, el entorno de compilaci√≥n / tiempo de ejecuci√≥n, el c√≥digo y el conjunto de datos, e integrarlos en nuestro proyecto. <br><br>  Las plantillas de muestra utilizadas en esta publicaci√≥n son una buena manera de comenzar a crear proyectos m√°s complejos.  Y puede usar la interfaz web o de l√≠nea de comandos para hacer su trabajo con Valohai.  Con la CLI, tambi√©n puede integrarlo con sus instalaciones y scripts (o incluso con trabajos CRON o CI / CD). <br><br>  Adem√°s, est√° claro que si estoy trabajando en un proyecto relacionado con AI / ML / DL, no necesito preocuparme por crear y mantener una tuber√≠a de extremo a extremo (que muchos otros tuvieron que hacer en el pasado). <br><br><h5>  Referencias </h5><br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">El proyecto mlpmnist-dl4j-examples en GitHub</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Recursos impresionantes de AI / ML / DL</a> </li><li>  <a href="">Recursos Java AI / ML / DL</a> </li><li>  <a href="">Aprendizaje profundo y recursos DL4J</a> </li></ol><br>  Gracias por su atencion! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/469405/">https://habr.com/ru/post/469405/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../469399/index.html">Wi-Fi en el Museo-Finca Arkhangelskoye</a></li>
<li><a href="../469401/index.html">Actualizaci√≥n del servicio 3CX WebMeeting, Elastix Online Converter y nuevos videos tutoriales</a></li>
<li><a href="../469403/index.html">Estamos entrevistando a un candidato para el puesto de Desarrollador de Software Senior</a></li>
<li><a href="../469407/index.html">ARIES PLC110 [M02] -MS4, HMI, OPC y SCADA, o cu√°nto necesita una persona el t√© de manzanilla. Parte 1</a></li>
<li><a href="../469409/index.html">Perfiles de Linux con Performance Analyzer</a></li>
<li><a href="../469411/index.html">RE: Dolor y l√°grimas en Svelte 3</a></li>
<li><a href="../469413/index.html">El resumen de materiales frescos del mundo del front-end para la √∫ltima semana No. 382 (22-29 de septiembre de 2019)</a></li>
<li><a href="../469415/index.html">Niveles de aislamiento transaccional para los m√°s peque√±os.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>