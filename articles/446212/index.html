<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üòï üë®üèø‚Äçüéì üéõÔ∏è Profundidades SIEM: correlaciones listas para usar. Parte 5. Metodolog√≠a para desarrollar reglas de correlaci√≥n üà≥ üçí üê¢</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Concluimos la serie de art√≠culos dedicados a las reglas de correlaci√≥n que salen de la caja. Fijamos una meta para formular un enfoque que nos permiti...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Profundidades SIEM: correlaciones listas para usar. Parte 5. Metodolog√≠a para desarrollar reglas de correlaci√≥n</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pt/blog/446212/">  Concluimos la serie de art√≠culos dedicados a las reglas de correlaci√≥n que salen de la caja.  Fijamos una meta para formular un enfoque que nos permitiera crear reglas de correlaci√≥n que puedan funcionar "fuera de la caja" con un m√≠nimo de falsos positivos. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/e6/bz/th/e6bzthq7bfspxncuni5hbtudz84.png" alt="Metodolog√≠a para desarrollar reglas de correlaci√≥n"></div><br>  <i>Imagen: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Marketing de software</a></i> <br><a name="habracut"></a><br>  Todos los puntos clave del art√≠culo est√°n disponibles en la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">conclusi√≥n</a> , donde la metodolog√≠a dada se presenta en forma de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">diagrama</a> gr√°fico. <br><br>  Brevemente sobre lo que sucedi√≥ en art√≠culos anteriores: describieron c√≥mo deber√≠a ser un conjunto de campos de un evento normalizado: un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">diagrama</a> ;  qu√© sistema de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">categorizaci√≥n de</a> eventos usar;  c√≥mo, utilizando un sistema de categorizaci√≥n y un esquema, unificar el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">proceso de</a> normalizaci√≥n de eventos.  Tambi√©n examinamos el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">contexto de la</a> implementaci√≥n de las reglas de correlaci√≥n y examinamos lo que SIEM debe saber sobre el Sistema Automatizado (AS) que est√° monitoreando y por qu√©. <br><br>  Todos los enfoques y razonamientos anteriores son los bloques a partir de los cuales se construye la metodolog√≠a para desarrollar reglas de correlaci√≥n.  Es hora de juntarlos y ver la imagen completa. <br><br>  La metodolog√≠a completa para desarrollar reglas de correlaci√≥n consta de cuatro bloques: <br><br><ul><li>  preparaci√≥n de fuentes y alrededores; </li><li>  normalizaci√≥n de eventos y su enriquecimiento; </li><li>  adaptaci√≥n de reglas de correlaci√≥n al contexto de AS; </li><li>  formaci√≥n de un acuerdo sobre aspectos positivos. </li></ul><br><h1>  Preparaci√≥n de fuentes y entornos. </h1><br>  Las reglas de correlaci√≥n operan en eventos que generan fuentes.  A este respecto, es extremadamente importante que las fuentes necesarias para las reglas de correlaci√≥n est√©n presentes en los altavoces y est√©n configuradas correctamente. <br><br><img src="https://habrastorage.org/webt/7r/ih/b5/7rihb5lksdmrzhpjpte5q9-3wls.png" alt="Preparaci√≥n de fuentes y entornos."><br>  <i>Preparaci√≥n de fuentes y entornos.</i> <br><br>  <b>Paso 1</b> : <i>Piense en la l√≥gica general de la regla y comprenda qu√© fuentes de eventos se necesitan.</i>  Si est√° desarrollando desde cero o adoptando una <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">regla de</a> correlaci√≥n <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Sigma ya</a> preparada, debe comprender en funci√≥n de los eventos de qu√© fuentes funcionar√°. <br><br>  <b>Paso 2</b> : <i>aseg√∫rese de que todas las fuentes necesarias est√©n en la empresa y que puedan recopilarse.</i>  Una situaci√≥n es posible cuando una regla opera en una cadena de eventos de varias fuentes del formulario (evento A de la fuente 1) - (evento B de la fuente 2) - (evento C de la fuente 3) durante 5 minutos.  Si su empresa no tiene al menos una fuente, dicha regla se vuelve in√∫til, ya que nunca funcionar√°.  Debe comprender si, en principio, es posible recopilar eventos de las fuentes necesarias y si su SIEM puede proporcionarlo.  Por ejemplo, la fuente escribe eventos en un archivo, pero el archivo est√° encriptado, o se usa una base de datos no est√°ndar en la fuente para el almacenamiento, cuyo acceso no puede garantizarse a trav√©s del controlador ODBC / JDBC est√°ndar. <br><br>  <b>Paso 3</b> : <i>Conecte las fuentes a SIEM.</i>  <i>No importa cu√°n trivial pueda parecer, pero en este paso es necesario implementar la colecci√≥n de eventos.</i>  A menudo hay muchos problemas.  Por ejemplo, problemas de organizaci√≥n, cuando la administraci√≥n de TI proh√≠be categ√≥ricamente conectarse a sistemas de misi√≥n cr√≠tica.  O t√©cnico, cuando sin configuraciones adicionales, el agente SIEM (SmartConnector, Universal Forwarder), al recopilar eventos, simplemente "mata" la fuente, lo que lleva a una denegaci√≥n de servicio.  Esto a menudo se puede observar cuando se conectan DBMS altamente cargados a SIEM. <br><br>  <b>Paso 4</b> : <i>Aseg√∫rese de que la auditor√≠a en las fuentes est√© configurada correctamente, los eventos necesarios para la correlaci√≥n se reciben en SIEM.</i>  Las reglas de correlaci√≥n esperan ciertos tipos de eventos.  Deben ser generados por la fuente.  A menudo sucede que para generar los eventos necesarios para las reglas, la fuente debe configurarse adicionalmente: la auditor√≠a avanzada est√° habilitada y la salida del registro en un formato determinado est√° configurada. <br><br>  La habilitaci√≥n de la auditor√≠a extendida a menudo afecta la cantidad de flujo de eventos (EPS) recibida en el SIEM desde la fuente.  Debido al hecho de que la fuente misma y SIEM est√°n en el √°rea de responsabilidad de los diferentes departamentos, siempre existe el riesgo de que la auditor√≠a extendida se pueda deshabilitar y, como resultado, los tipos de eventos necesarios dejar√°n de llegar a SIEM.  Este problema puede detectarse parcialmente mediante el monitoreo del flujo de eventos para cada fuente, o m√°s bien, monitoreando los cambios en Eventos por segundo (EPS). <br><br>  <b>Paso 5</b> : <i>Verifique que los eventos est√©n en progreso y configure el monitoreo de origen.</i>  En cualquier infraestructura, tarde o temprano, aparecen fallas en la red o en la fuente misma.  En este punto, SIEM pierde contacto con la fuente y no puede recibir eventos.  Si la fuente es pasiva y escribe sus registros en un archivo o base de datos, los eventos no se perder√°n en caso de falla, y SIEM podr√° recibirlos cuando se restablezca la comunicaci√≥n.  Si la fuente est√° activa y env√≠a eventos a SIEM, por ejemplo, a trav√©s de syslog, sin guardarlos adicionalmente en ning√∫n lugar, entonces, en caso de falla, los eventos se perder√°n y su regla de correlaci√≥n simplemente no funcionar√°, porque el evento deseado no esperar√°.  Al profundizar, puede ver que, incluso cuando se trabaja con una fuente pasiva, al restaurar la comunicaci√≥n despu√©s de una falla, no hay garant√≠a de que las reglas de correlaci√≥n funcionen, especialmente aquellas que operan con ventanas de tiempo.  Considere el ejemplo de regla descrito anteriormente: (evento A de la fuente 1) - (evento B de la fuente 2) - (evento C de la fuente 3) durante 5 minutos.  Si ocurre una falla despu√©s del evento B y la conexi√≥n se restablece en una hora, la correlaci√≥n no funcionar√°, ya que el evento C no llegar√° en los 5 minutos esperados. <br><br>  Teniendo en cuenta estas caracter√≠sticas, debe configurar la supervisi√≥n de las fuentes de las que se recopilan los eventos.  Este monitoreo debe monitorear la disponibilidad de fuentes, la puntualidad de la llegada de eventos de ellas, el poder del flujo de eventos recopilados (EPS). <br><br>  La activaci√≥n del sistema de monitoreo es la primera campana que habla de la aparici√≥n de un factor negativo que afecta el desempe√±o de todas o parte de las reglas de correlaci√≥n. <br><br><h1>  Normalizaci√≥n de eventos y su enriquecimiento. </h1><br>  Recolectar los eventos necesarios para la correlaci√≥n no es suficiente.  Los eventos que lleguen a SIEM deben normalizarse estrictamente de acuerdo con las reglas aceptadas.  Escribimos sobre los problemas de normalizaci√≥n y la formaci√≥n de una metodolog√≠a de normalizaci√≥n en un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">art√≠culo</a> separado.  En general, este bloque puede caracterizarse como una lucha contra la basura que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">entra y</a> sale ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">GIGO</a> ). <br><br><img src="https://habrastorage.org/webt/1b/na/-x/1bna-xnslsomq5xp8shkaz7snr4.png" alt="Normalizaci√≥n y enriquecimiento de eventos."><br>  <i>Normalizaci√≥n y enriquecimiento de eventos.</i> <br><br>  <b>Paso 6</b> y <b>Paso 7</b> : <i>Categorizaci√≥n de eventos y normalizaci√≥n de eventos de acuerdo con la categor√≠a, seg√∫n la metodolog√≠a.</i>  No nos detendremos en ellos en detalle, ya que consideramos estos pasos en detalle en el art√≠culo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">"Metodolog√≠a para normalizar eventos"</a> . <br><br>  <b>Paso 8</b> : <i>Enriquecimiento de eventos con informaci√≥n faltante y adicional, de acuerdo con la categor√≠a.</i>  A menudo, los eventos entrantes no siempre contienen informaci√≥n en la medida necesaria para que las reglas de correlaci√≥n funcionen.  Por ejemplo, un evento contiene solo la direcci√≥n IP del host, pero no hay informaci√≥n sobre su FQDN o nombre de host.  Otro ejemplo: un evento contiene una ID de usuario, pero no hay nombre de usuario en el evento.  En este caso, la informaci√≥n necesaria debe extraerse de fuentes externas: bases de datos, controladores de dominio u otros directorios y agregarse al evento. <br><br>  Es importante tener en cuenta que la categorizaci√≥n de eventos ocurre al principio, antes de la normalizaci√≥n.  Adem√°s del hecho de que la categor√≠a define las reglas para normalizar el evento, tambi√©n establece la lista de datos que deben buscarse en fuentes externas si no est√°n en el evento en s√≠. <br><br><h1>  Adaptaci√≥n de reglas de correlaci√≥n al contexto AS </h1><br>  Una vez que haya preparado los datos de entrada (eventos) y haya desarrollado las reglas de correlaci√≥n, es necesario tener en cuenta los detalles de los eventos entrantes, el AS mismo y su variabilidad.  M√°s sobre esto fue en el art√≠culo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">"Modelo del sistema como contexto de las reglas de correlaci√≥n"</a> . <br><br><img src="https://habrastorage.org/webt/i6/tr/uk/i6trukg2z33jqm-lhuzuierlcbk.png" alt="Adaptaci√≥n de reglas de correlaci√≥n al contexto AS"><br>  <i>Adaptaci√≥n de reglas de correlaci√≥n al contexto AS</i> <br><br>  <b>Paso 9</b> : <i>Comprenda la frecuencia de los eventos de cada fuente, determine la ventana de tiempo para la correlaci√≥n.</i>  Muy a menudo, las reglas de correlaci√≥n usan ventanas de tiempo cuando es necesario esperar la llegada de un determinado evento dentro de un intervalo de tiempo determinado.  Al desarrollar tales reglas, es importante considerar el retraso en la recepci√≥n de eventos.  Generalmente son causados ‚Äã‚Äãpor dos factores. <br><br>  <b>En primer lugar</b> , la fuente en s√≠ misma no puede escribir eventos de inmediato en la base de datos, en un archivo o enviarlo a trav√©s de syslog.  El tiempo de este retraso debe ser estimado y tomado en cuenta en la regla. <br><br>  <b>En segundo lugar</b> , hay un retraso en la entrega de eventos a SIEM.  Por ejemplo, la recopilaci√≥n de eventos de la base de datos se configura para que la solicitud de eventos se realice una vez cada 10 minutos, por supuesto, que la ventana de correlaci√≥n de 5 minutos no sea la mejor soluci√≥n en esta situaci√≥n. <br><br>  El problema se agrava cuando es necesario desarrollar una regla de correlaci√≥n que funcione con eventos de varias fuentes a la vez.  En este caso, es importante entender que pueden tener diferentes tiempos de entrega.  En el peor de los casos, los eventos vendr√°n en orden aleatorio con una violaci√≥n de la cronolog√≠a.  En tal situaci√≥n, el desarrollador de las reglas de correlaci√≥n necesita comprender claramente a qu√© hora el SIEM realiza la correlaci√≥n (en el momento del evento o cuando el evento lleg√≥ a SIEM).  Observo que la correlaci√≥n en el momento de llegada de los eventos es la opci√≥n m√°s simple t√©cnicamente y m√°s com√∫n para procesar eventos en modo pseudo-tiempo real.  Sin embargo, esta opci√≥n solo exacerba los problemas anteriores y no los resuelve. <br><br>  Si su SIEM proporciona una correlaci√≥n en el tiempo del evento, lo m√°s probable es que haya mecanismos para reordenar eventos que puedan restaurar la cronolog√≠a real de los eventos. <br><br>  En el caso de que comprenda que la ventana de tiempo es demasiado grande para hacer la correlaci√≥n en la secuencia, debe usar el mecanismo de correlaci√≥n retro, en el que los eventos ya guardados se seleccionan de la base de datos SIEM de acuerdo con la programaci√≥n y se ejecutan a trav√©s de las reglas de correlaci√≥n. <br><br>  <b>Paso 10</b> : <i>Establecer un mecanismo de excepci√≥n.</i>  En el mundo real, siempre habr√° un objeto con un comportamiento especial que no debe ser manejado por una regla de correlaci√≥n espec√≠fica, ya que esto conduce a un falso positivo.  Por lo tanto, en la etapa de desarrollo de las reglas, se deben establecer mecanismos para agregar tales objetos a las excepciones.  Por ejemplo, si su regla funciona con las direcciones IP de las m√°quinas, necesita una lista de tabla donde puede agregar direcciones para las que la regla no funcionar√°.  Del mismo modo, si una regla funciona con inicios de sesi√≥n de usuario o nombres de proceso, es necesario trabajar preliminarmente con listas de exclusi√≥n de tablas en la l√≥gica de la regla. <br><br>  Este enfoque le permitir√° agregar objetos autom√°tica o manualmente a las excepciones sin tener que reescribir el cuerpo de la regla. <br><br>  <b>Paso 11</b> : <i>Defina los l√≠mites f√≠sicos y l√≥gicos de aplicabilidad de la regla de correlaci√≥n.</i>  Al desarrollar una regla de correlaci√≥n, es importante comprender inicialmente los l√≠mites de aplicabilidad (alcance) de la regla y si existen en absoluto.  Al resolver la l√≥gica y depurar la regla, es necesario centrarse en los detalles de esta √°rea.  Si una regla comienza a funcionar con datos que van m√°s all√° del alcance de esta √°rea, la probabilidad de falsos positivos aumenta. <br><br>  Se pueden distinguir dos tipos de alcance: f√≠sico y l√≥gico.  El alcance f√≠sico son las redes adyacentes y de la compa√±√≠a, y el √°rea l√≥gica son las partes del AS, las aplicaciones comerciales o los procesos comerciales.  Ejemplos del √°rea f√≠sica: segmento DMZ, subredes internas y externas, redes de acceso remoto.  Ejemplos del alcance l√≥gico de las reglas: control de procesos, contabilidad, segmento PCI DSS, segmento PD, o simplemente roles de equipos espec√≠ficos: controladores de dominio, conmutadores de acceso, enrutadores centrales. <br><br>  Puede establecer √°mbitos para las reglas de correlaci√≥n a trav√©s de listas de tablas.  Se pueden llenar de forma manual o autom√°tica.  Si encuentra tiempo en su empresa para la gesti√≥n de activos (gesti√≥n de activos), es posible que todos los datos necesarios ya est√©n contenidos en el modelo AS creado en SIEM.  La generaci√≥n autom√°tica de tales listas tabulares le permite incluir din√°micamente en el alcance nuevos activos que aparecen en la empresa.  Por ejemplo, si ten√≠a una regla que funcionaba exclusivamente con controladores de dominio, la adici√≥n de un nuevo controlador al bosque de dominio se solucionar√° en el modelo y entrar√° en el alcance de su regla. <br><br>  En general, las listas de tablas utilizadas para excepciones pueden considerarse como listas negras, y las listas responsables del alcance de las reglas como listas blancas. <br><br>  <b>Paso 12</b> : <i>use el modelo de altavoz para aclarar el contexto.</i>  En el proceso de desarrollar una regla de correlaci√≥n que identifique acciones maliciosas, es importante asegurarse de que realmente se puedan implementar.  Si esto no se tiene en cuenta, la activaci√≥n de la regla que revel√≥ el posible ataque resultar√° ser falsa, ya que este tipo de ataque simplemente puede no ser aplicable a su infraestructura.  Explicar√© con un ejemplo: <br><br><ol><li>  Supongamos que tenemos una regla de correlaci√≥n que detecta conexiones RDP remotas a los servidores. </li><li>  El firewall muestra un intento de conectarse al servidor TCP 3389 del servidor myserver.local. </li><li>  La regla se dispara y usted comienza a analizar un posible incidente con alta prioridad. </li></ol><br>  Durante la investigaci√≥n, descubres r√°pidamente que en myserver.local 3389 est√° cerrado y nunca ha sido abierto por ning√∫n servicio y Linux est√° all√≠.  Este es un falso positivo que te llev√≥ tiempo investigar. <br><br>  Otro ejemplo: IPS env√≠a un evento desencadenante de firma cuando se intenta explotar la vulnerabilidad CVE-2017-0144, pero durante la investigaci√≥n resulta que el parche correspondiente est√° instalado en la m√°quina atacada y no hay necesidad de responder a dicho incidente con la m√°xima prioridad. <br>  El uso de datos del modelo de altavoz ayudar√° a nivelar este problema. <br><br>  <b>Paso 13</b> : <i>Use identificadores de entidad, no sus claves de origen.</i>  Como ya se describi√≥ en el art√≠culo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">"Modelo del sistema como contexto de las reglas de correlaci√≥n", la</a> direcci√≥n IP, el FQDN e incluso el MAC de un activo pueden cambiar.  Por lo tanto, si utiliza los identificadores de origen del activo en la regla de correlaci√≥n o en la lista de la tabla, despu√©s de un tiempo existe una alta probabilidad de recibir falsos positivos por una raz√≥n completamente banal, por ejemplo, el servidor DHCP simplemente emiti√≥ esta IP a otra m√°quina. <br><br>  Si su SIEM tiene un mecanismo para identificar activos, rastrear sus cambios y permitirle operar con sus identificadores, debe usar identificadores, no las claves de origen del activo. <br><br><h1>  Formaci√≥n de un acuerdo positivo. </h1><br>  Al acercarnos al bloque final de creaci√≥n de la regla de correlaci√≥n, recordamos que el resultado de la regla es un incidente planteado en SIEM.  Los profesionales responsables deben responder a tal incidente.  Aunque el prop√≥sito de esta serie de art√≠culos no incluye la consideraci√≥n del proceso de respuesta a incidentes, debe tenerse en cuenta que parte de la informaci√≥n sobre el incidente ya se genera en la etapa de creaci√≥n de la regla de correlaci√≥n correspondiente. <br><br>  A continuaci√≥n, consideramos los puntos b√°sicos que deben tenerse en cuenta al configurar los par√°metros para activar la regla de correlaci√≥n y generar un incidente. <br><br><img src="https://habrastorage.org/webt/fg/z5/dj/fgz5djbyxha-uqiduo8ubym8ncq.png" alt="Formaci√≥n de un acuerdo positivo."><br>  <i>Formaci√≥n de un acuerdo positivo.</i> <br><br>  <b>Paso 14</b> : <i>Determine las condiciones de agregaci√≥n y apagado en caso de una gran cantidad de falsos positivos.</i>  En la etapa de depuraci√≥n, y en el proceso de su funcionamiento, si no se adhiere a esta t√©cnica :), pueden producirse falsas alarmas de las reglas.  Es bueno si hay uno o dos viajes por d√≠a, pero ¬øqu√© pasa si una regla tiene miles o decenas de miles de viajes?  Por supuesto, esto sugiere que la regla debe desarrollarse m√°s.  Sin embargo, es necesario asegurar que en tales situaciones un falso positivo tan masivo: <br><br><ol><li>  No afect√≥ el rendimiento de SIEM. </li><li>  Entre la masa de falsos positivos, no se perdieron incidentes realmente importantes.  Incluso hay un tipo separado de ataque destinado a ocultar la principal actividad maliciosa detr√°s de muchas <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">actividades</a> falsas. </li></ol><br>  Los problemas de este tipo pueden resolverse si, al crear una regla de correlaci√≥n a nivel de todo el sistema en su conjunto, o para cada regla individualmente, establece las condiciones para la agregaci√≥n de incidentes y las condiciones para el cierre de emergencia de la regla. <br><br>  El mecanismo de agregaci√≥n de incidentes permitir√° no crear millones de incidentes id√©nticos, sino "pegar" incidentes nuevos a uno, siempre que sean id√©nticos.  En casos extremos, cuando incluso la agregaci√≥n de incidentes genera una carga significativa, se recomienda establecer la regla de correlaci√≥n para que se apague autom√°ticamente cuando se excede el n√∫mero especificado de operaciones por unidad de tiempo (minuto, hora, d√≠a). <br><br>  <b>Paso 15</b> : <i>Defina las reglas para generar el nombre del incidente.</i>  Este elemento a menudo se descuida, especialmente si no est√°n desarrollando reglas para su compa√±√≠a, por ejemplo, si una compa√±√≠a externa es responsable de implementar SIEM y desarrollar reglas.  El nombre de la regla de correlaci√≥n, as√≠ como el incidente que gener√≥, debe ser breve y reflejar claramente la esencia de una regla en particular. <br><br>  Si m√°s de una persona trabaja con incidentes y reglas de correlaci√≥n en su empresa, se recomienda que desarrolle reglas de nomenclatura.  Deben ser entendidos y aceptados por todo el equipo que trabaja con SIEM. <br><br>  <b>Paso 16</b> : <i>Defina las reglas para dar forma a la importancia del incidente.</i>  La mayor√≠a de las soluciones SIEM en la √∫ltima etapa de la creaci√≥n de un incidente le permiten establecer su importancia y significado.  Algunas decisiones incluso calculan la importancia autom√°ticamente, seg√∫n el contexto del incidente y los objetos involucrados en √©l. <br><br>  En el caso de que su SIEM opere un c√°lculo exclusivamente autom√°tico de la importancia de los incidentes, vale la pena averiguar sobre la base de qu√© y por qu√© f√≥rmula se calcula.  Por ejemplo, si la importancia se calcula sobre la base de la importancia de los activos involucrados en el incidente, debe tomar en serio los problemas de Gesti√≥n de activos en una empresa de antemano. <br><br>  Si establece la importancia de un incidente manualmente, se recomienda que desarrolle una f√≥rmula de c√°lculo que tenga en cuenta al menos lo siguiente: <br><br><ol><li>  La importancia del alcance en el que funciona la regla.  Por ejemplo, un incidente en la zona de sistemas de misi√≥n cr√≠tica puede ser m√°s cr√≠tico que si ocurriera exactamente el mismo incidente en la zona de sistemas cr√≠ticos de negocios. </li><li>  La importancia de los activos y las cuentas de usuario involucradas en el incidente. </li><li>  La recurrencia de este incidente en la empresa. </li></ol><br>  Adem√°s, como en el nombramiento de incidentes, es importante que todas las partes interesadas comprendan de manera clara e igual las reglas por las cuales se forma la importancia de un incidente. <br><a name="Conclusions"></a><br><h1>  Conclusiones </h1><br>  Resumiendo los resultados de nuestra serie de art√≠culos, noto que es posible, en mi opini√≥n, crear reglas de correlaci√≥n que funcionen de manera inmediata.  La soluci√≥n puede ser una fusi√≥n de enfoques organizativos y t√©cnicos.  El SIEM en s√≠ mismo debe poder hacer algo, pero los especialistas que lo operan deben hacer y saber algo. <br><br>  Para resumir: <br><br><ol><li>  El m√©todo consta de los siguientes bloques: <br><ul><li>  Preparaci√≥n de fuentes y entornos. </li><li>  Normalizaci√≥n de eventos y su enriquecimiento. </li><li>  Adaptaci√≥n de las reglas de correlaci√≥n al contexto AS. </li><li>  Formaci√≥n de un acuerdo sobre aspectos positivos. </li></ul></li><li>  Cada unidad tiene componentes organizativos y t√©cnicos. </li><li>    ,        SIEM,        . </li><li>      ,     ,     SIEM-. </li><li>              .      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="></a> . </li></ol><br><a name="Schema"></a><br><img src="https://habrastorage.org/webt/iw/gz/kz/iwgzkzilc0khjwsscaycz8mowes.png" alt="   ,  ¬´ ¬ª"><br> <i>   ,  ¬´ ¬ª</i> <br><br>   ,     ,       .      ‚Äî        .   . <br><a name="Articles"></a><br><hr><br> <b> :</b> <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="> SIEM:  ¬´ ¬ª.  1:     ?</a> <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="> SIEM:  ¬´ ¬ª.  2.      ¬´¬ª</a> <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="> SIEM:  ¬´ ¬ª.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 3.1.</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="> </a> <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="> SIEM:  ¬´ ¬ª.  3.2.   </a> <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="> SIEM:  ¬´ ¬ª.  4.      </a> <br><br>  SIEM:  ¬´ ¬ª.  5.     ( <i> </i> ) </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/446212/">https://habr.com/ru/post/446212/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../446202/index.html">El resumen de materiales frescos del mundo del front-end para la √∫ltima semana No. 358 (25 al 31 de marzo de 2019)</a></li>
<li><a href="../446204/index.html">Pron√≥stico sobre c√≥mo se superar√°n las restricciones de Internet</a></li>
<li><a href="../446206/index.html">Tutorial de React Parte 26: Arquitectura de aplicaci√≥n, patr√≥n de contenedor / componente</a></li>
<li><a href="../446208/index.html">Tutorial React Parte 25: Taller sobre formularios</a></li>
<li><a href="../446210/index.html">ADAM-3600 - un controlador industrial multifuncional</a></li>
<li><a href="../446214/index.html">OS1: un n√∫cleo primitivo en Rust para x86. Parte 3. Tarjeta de memoria, excepci√≥n de falla de p√°gina, mont√≥n y asignaciones</a></li>
<li><a href="../446218/index.html">El dise√±ador de juegos no es muy diferente de un psic√≥pata. C√≥mo hicimos el juego CMAN</a></li>
<li><a href="../446222/index.html">Uso de potenciales t√©rmicos para el an√°lisis del territorio.</a></li>
<li><a href="../446228/index.html">Mejora de la calidad de la clasificaci√≥n de texto conectando Wikipedia</a></li>
<li><a href="../446230/index.html">Monitoreo y administraci√≥n remotos de dispositivos basados ‚Äã‚Äãen Linux / OpenWrt / Lede a trav√©s del puerto 80, continuaci√≥n</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>