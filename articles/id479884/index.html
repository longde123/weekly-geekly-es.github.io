<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëµüèª üçº üë©üèΩ‚Äçüéì CI / CD Kustom untuk Persatuan üë®üèø‚Äçüè≠ ü§æüèº ‚è±Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Sekarang saya akan memberi tahu Anda seperti apa proses pengembangan Unity di perusahaan kecil gamedev dan bagaimana kami meningkatkan dan mengotomasi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>CI / CD Kustom untuk Persatuan</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/479884/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/fg/sd/n8/fgsdn8dvxghcqvygtwgr03jfmxw.jpeg" alt="gambar"></div><br>  Sekarang saya akan memberi tahu Anda seperti apa proses pengembangan Unity di perusahaan kecil gamedev dan bagaimana kami meningkatkan dan mengotomasinya.  Namun, 2020 ada di halaman, itu sudah cukup untuk mengemudi dengan mouse ... <br><a name="habracut"></a><br>  Tentang mouse, ini bukan lelucon.  Sampai saat ini, proses pengujian dan pengembangan game bersama kami terlihat seperti ini: <br><br><h4>  Android </h4><br><ol><li>  Pengembang menulis kode </li><li>  Akan Versi Android </li><li>  Unggah ke folder bersama di Google Drive </li><li>  Penguji mengunduh versi terbaru </li><li>  Menguji dan melempar tugas di Redmine </li><li>  Goto: Langkah 1 </li></ol><br>  Versi iOS sedikit lebih rumit: <br><br><h4>  iOS </h4><br><ol><li>  Pengembang menulis kode </li><li>  Pergi ke proyek Xcode </li><li>  Script postbuild menambahkan lokalisasi, SDK, dan lainnya </li><li>  Proyek yang disusun </li><li>  Diarsipkan </li><li> Diekspor ke file IPA (semua ini tidak dilakukan dengan sangat cepat, haha) </li><li>  Setelah itu, Anda dapat mengunggah IPA ke folder bersama di Google Drive </li><li>  Atau unggah ke TestFlight, tempat Anda bisa menunggu beberapa hari </li><li>  Penguji mengunduh IPA terbaru </li><li>  Menghubungkan perangkat, menginstal aplikasi </li><li>  Menguji dan melempar tugas di Redmine </li><li>  Goto: Langkah 1 </li></ol><br>  Di sini ada kesedihan.  Dan jika untuk Android, prosesnya masih bisa diterima (tidak), maka untuk iOS - semuanya sangat panjang, tidak nyaman dan salah.  Selain itu, sebagian besar operasi dilakukan secara manual oleh pengembang (di sini tentang mouse) dan waktu yang mungkin dihabiskan untuk pengembangan diperlukan untuk menunggu kompilasi, ekspor proyek Xcode, dan sebagainya.  Juga perlu untuk mempertimbangkan bahwa setiap orang di kantor yang sama, yaitu  Anda bisa datang untuk bertanya / mengatakan sesuatu sebelum memulai seluruh proses neraka ini. <br><br>  Tapi, secara umum, entah bagaimana itu berfungsi dan merilis game :) <br><br>  Dan di sini baru-baru ini, dengan pengajuan <a href="https://habr.com/ru/users/leopotam/" class="user_link">Leopotam</a> , pencinta <a href="https://habr.com/ru/users/leopotam/" class="user_link">konstruksi</a> sepeda dan optimalisasi segalanya, saya memutuskan untuk mengotomatiskan proses ini.  Hasilnya adalah skrip BASH yang dapat: <br><br><ul><li>  Unduh perubahan terbaru dari repositori GIT </li><li>  Jalankan tes </li><li>  Bangun APK untuk Android, dalam pengembangan dan rilis </li><li>  Bangun proyek untuk iOS Xcode, dalam pengembangan dan rilis </li><li>  Kompilasi </li><li>  Arsipkan dan ekspor IPA </li><li>  Buat manifes untuk itu </li><li>  Hasilkan halaman HTML untuk diinstal </li><li>  Unggah semua ini ke server menggunakan sshpass </li><li>  Masukkan semua log dalam folder terpisah </li><li>  Kirim pemberitahuan telegram </li></ul><br>  <u>Dan semua ini dengan satu sentuhan tombol.</u>  <u>Tanpa memulai Persatuan dan Xcode.</u>  Entah bagaimana lebih menyenangkan, ya? <br><br><img src="https://habrastorage.org/webt/-2/nz/hp/-2nzhpzyu5qm1b0zpl_mqmff5fk.gif" alt="gambar"><br><br>  Sekarang, ketika perakitan selesai, tester menerima pemberitahuan di Telegram dengan dua tautan ke versi Android dan iOS.  Masih harus melalui mereka dan menginstal aplikasi langsung dari perangkat.  Ini juga berfungsi di iOS, dan manifes khusus dihasilkan untuk ini. <br><br>  Sebenarnya, ini adalah pengalaman pertama saya dalam pemrograman BASH, jadi saya tidak tahu bagaimana itu, dalam Feng Shui atau tidak, tetapi itu berfungsi dengan baik.  Bagaimanapun, skrip akan diperbarui dan dimodifikasi untuk memenuhi kebutuhan proyek.  Berikut adalah beberapa poin penting tentang apa yang sedang dilakukan: <br><br><h4>  Cara mulai membangun proyek Persatuan untuk platform tertentu </h4><br>  <a href="https://docs.unity3d.com/Manual/CommandLineArguments.html">Manual</a> menjelaskan semua argumen yang dapat digunakan untuk membangun.  Jalankan build APK: <br><br><pre><code class="bash hljs"><span class="hljs-variable"><span class="hljs-variable">$UNITY</span></span> -batchmode -quit -projectPath <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$PATH</span></span></span><span class="hljs-string">"</span></span> -executeMethod Game.BuildActions.AndroidDevelopment -buildTarget android -logFile <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$LOGS_PATH</span></span></span><span class="hljs-string">/android_development.log"</span></span></code> </pre> <br>  Di sini <b>-buildTarget</b> hanya mengatur platform, dan - <b>executeMethod</b> memanggil fungsi dalam proyek Unity, yang memulai build dengan parameter yang diberikan, tampilannya seperti ini: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AndroidDevelopment</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { PlayerSettings.SetScriptingBackend (BuildTargetGroup.Android, ScriptingImplementation.IL2CPP); PlayerSettings.SetScriptingDefineSymbolsForGroup (BuildTargetGroup.Android, <span class="hljs-string"><span class="hljs-string">"DEV"</span></span>); EditorUserBuildSettings.SwitchActiveBuildTarget (BuildTargetGroup.Android, BuildTarget.Android); EditorUserBuildSettings.development = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; EditorUserBuildSettings.androidETC2Fallback = AndroidETC2Fallback.Quality32Bit; BuildReport report = BuildPipeline.BuildPlayer (GetScenes (), ANDROID_DEVELOPMENT_FILE, BuildTarget.Android, BuildOptions.None); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> code = (report.summary.result == BuildResult.Succeeded) ? <span class="hljs-number"><span class="hljs-number">0</span></span> : <span class="hljs-number"><span class="hljs-number">1</span></span>; EditorApplication.Exit (code); }</code> </pre><br>  Di sini Anda dapat mengatur parameter Anda sendiri untuk bangunan, kondisi, dll.  Hasilnya dikembalikan ke skrip BASH. <br><br><h4>  Cara mengompilasi dan mengekspor proyek Xcode </h4><br>  Setelah Unity berhasil mengeluarkan proyek Xcode, ia harus dikompilasi, diarsipkan, dan diekspor ke file IPA, ini dilakukan seperti ini: <br><br><pre> <code class="bash hljs">xcodebuild -project <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$IOS_PATH</span></span></span><span class="hljs-string">/Unity-iPhone.xcodeproj"</span></span> -quiet &gt; <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$LOGS_PATH</span></span></span><span class="hljs-string">/ios_build_release.log"</span></span> 2&gt;&amp;1</code> </pre> <br><pre> <code class="bash hljs">xcodebuild -project <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$IOS_PATH</span></span></span><span class="hljs-string">/Unity-iPhone.xcodeproj"</span></span> -scheme <span class="hljs-string"><span class="hljs-string">"Unity-iPhone"</span></span> archive -archivePath <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$IOS_RELEASE</span></span></span><span class="hljs-string">/Unity-iPhone.xcarchive"</span></span> -quiet &gt; <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$LOGS_PATH</span></span></span><span class="hljs-string">/ios_archive_release.log"</span></span> 2&gt;&amp;1</code> </pre><br><pre> <code class="bash hljs">xcodebuild -exportArchive -archivePath <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$IOS_RELEASE</span></span></span><span class="hljs-string">/Unity-iPhone.xcarchive"</span></span> -exportOptionsPlist <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$IOS_RELEASE</span></span></span><span class="hljs-string">/options.plist"</span></span> -exportPath <span class="hljs-variable"><span class="hljs-variable">$IOS_RELEASE</span></span> -allowProvisioningUpdates -quiet &gt; <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$LOGS_PATH</span></span></span><span class="hljs-string">/ios_export_release.log"</span></span> 2&gt;&amp;1</code> </pre> <br><br>  Di sini <b>options.plist</b> adalah manifes khusus yang menunjukkan metode ekspor, TeamID, dan lainnya.  Semua parameter yang tersedia dapat dilihat oleh perintah: <br><br><pre> <code class="bash hljs">xcodebuild -<span class="hljs-built_in"><span class="hljs-built_in">help</span></span></code> </pre> <br>  Dengan semua operasi ini, <i>Unity-iPhone.xcodeproj</i> standar yang dihasilkan Unity ditentukan.  Jika Anda memiliki <i>xcworkspace</i> , maka Anda perlu memeriksa ketersediaan dan penggunaannya. <br><br><h4>  Cara mengirim pesan ke Telegram dari skrip BASH </h4><br>  Anda perlu menemukan bot <b>BotFather</b> , menulis / mulai, atau / newbot, mengisi kolom dan menerima pesan dengan token dan tautan ke dokumentasi.  Untuk mengirim pesan menggunakan bot, Anda harus menjalankan perintah berikut: <br><br><pre> <code class="bash hljs">curl <span class="hljs-variable"><span class="hljs-variable">$BOT_PROXY</span></span> https://api.telegram.org/bot<span class="hljs-variable"><span class="hljs-variable">$BOT_TOKEN</span></span>/sendMessage -m 60 -s -X POST -d chat_id=<span class="hljs-variable"><span class="hljs-variable">$CHAT_ID</span></span> -d text=<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$1</span></span></span><span class="hljs-string">"</span></span> &gt; <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$LOGS_PATH</span></span></span><span class="hljs-string">/bot.log"</span></span> 2&gt;&amp;1</code> </pre> <br>  Di sini <b>CHAT_ID</b> adalah pengenal obrolan tempat mengirim pesan.  Misalnya, Anda dapat menambahkan bot ke grup tempat penguji duduk, berikan hak untuk membaca pesan.  Setelah itu jalankan: <br><br><pre> <code class="bash hljs">https://api.telegram.org/bot[BOT_TOKEN]/getUpdates</code> </pre> <br>  Dan dapatkan ID grup dan anggota yang menulis sesuatu.  Setelah itu, tunjukkan ID grup atau anggota tertentu kepada siapa akan dikirim.  Cara menemukan dan mengkonfigurasi pengiriman melalui proxy, saya pikir tidak masalah. <br><br>  Fungsi lainnya, templat templat manifes dan HTML menggunakan <b>sed</b> dan unggah file yang diperlukan ke server menggunakan <b>sshpass</b> . <br><br>  Parameter yang dapat diubah dengan cepat: <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># # PARAMS TO CHANGE # BRANCH='master' COMPANY='my_company' GAME_NAME='new_game' BUNDLE='com.mygames.game' TEAM='ios_team_id' REMOTE_PATH='url_my_builds_server' SSH_LOGIN='my_login' SSH_PASS='my_pass' SSH_HOST='my_builds_server.ru' SSH_PATH='~/domains/my_builds_server.ru/builds' TEMPLATE_FILE=$(PWD)'/template.html' MANIFEST_FILE=$(PWD)'/manifest.plist' VERSION_FILE=$(PWD)'/version.txt' LOGS_PATH=$PROJECT_PATH'/Logs' ANDROID_PATH=$PROJECT_PATH'/Builds/Android' BUILDS_PATH=$PROJECT_PATH'/Builds' IOS_PATH=$PROJECT_PATH'/Builds/iOS' IOS_BUILD_PATH=$PROJECT_PATH'/Builds/iOS/build' IOS_DEVELOPMENT=$PROJECT_PATH'/Builds/iOS/build/development' IOS_RELEASE=$PROJECT_PATH'/Builds/iOS/build/release' BOT_TOKEN='my_bot_token' BOT_PROXY='--proxy 185.189.211.70:8080' CHAT_ID='123456798' UNITY='/Applications/Unity/Hub/Editor/2019.3.0f1/Unity.app/Contents/MacOS/Unity' # # #</span></span></code> </pre><br>  <a href="https://github.com/mopsicus/unity-build-pipeline">Demo dan sumber</a> <br><br><hr><br>  Tentu saja, semua ini bisa dilakukan melalui Gitlab CI / CD yang sama, sudah ada skrip yang sudah jadi untuk ini, jalankan runner, build dan test.  Singkatnya, gunakan infrastruktur dan mekanisme yang sudah jadi.  Tetapi Anda harus pindah ke sana dan juga mengkonfigurasinya.  Mungkin kita akan membahas ini, sementara itu jauh lebih baik daripada sebelumnya.  Apalagi seluruh naskah ditulis cukup cepat. <br><br>  Semua otomatisasi pada tahun 2020!  Robot menyuntikkan, bukan pria. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id479884/">https://habr.com/ru/post/id479884/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id479874/index.html">Bagaimana saya masuk ke ThoughtWorks atau wawancara teladan</a></li>
<li><a href="../id479876/index.html">Apakah bantal diperlukan di pusat data?</a></li>
<li><a href="../id479878/index.html">TK universal untuk Wi-Fi, dengan penjelasan</a></li>
<li><a href="../id479880/index.html">Buat bangunan perawatan yang indah dengan Cetak Biru</a></li>
<li><a href="../id479882/index.html">Pergi konfigurasi perangkat lunak</a></li>
<li><a href="../id479886/index.html">Mendengar sebagai ganti penglihatan: mengkonfigurasi ulang neuron otak untuk beradaptasi dengan kegelapan</a></li>
<li><a href="../id479888/index.html">Kompresi Tangguh Berkecepatan Tinggi (Lanjutan)</a></li>
<li><a href="../id479890/index.html">Masalah dan tugas penerapan konsep Internet of Things</a></li>
<li><a href="../id479892/index.html">Tentang plugin Gradle, multithreading dalam sistem terdistribusi dan pemantauan otomasi: video dari Yandex.Money metap</a></li>
<li><a href="../id479894/index.html">Dari Hyper-V ke VMware dan sebaliknya: mengubah disk virtual</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>