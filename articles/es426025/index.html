<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üíò üë®üèø‚Äçüî¨ ü§õüèø Usar m√©todos ofensivos para enriquecer la Inteligencia de amenazas ü§π üî± üí¨</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hoy, Threat Intelligence, o la recopilaci√≥n activa de informaci√≥n sobre amenazas a la seguridad de la informaci√≥n, es una herramienta esencial en el p...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Usar m√©todos ofensivos para enriquecer la Inteligencia de amenazas</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/jetinfosystems/blog/426025/"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/440/45a/1d4/44045a1d4cbaec976766cd6206eee205.jpg" width="500"></div><br>  Hoy, Threat Intelligence, o la recopilaci√≥n activa de informaci√≥n sobre amenazas a la seguridad de la informaci√≥n, es una herramienta esencial en el proceso de identificaci√≥n de incidentes de seguridad de la informaci√≥n.  Las fuentes t√≠picas de TI incluyen suscripciones gratuitas con indicadores maliciosos, boletines de fabricantes de hardware y software que describen vulnerabilidades, informes de investigadores de seguridad con descripciones detalladas de amenazas, as√≠ como suscripciones comerciales de proveedores de TI.  Adem√°s, a menudo la informaci√≥n obtenida utilizando las fuentes anteriores no tiene un grado suficiente de integridad y relevancia.  El uso de OSINT (inteligencia de c√≥digo abierto) y m√©todos ofensivos (es decir, m√©todos que no son caracter√≠sticos del defensor sino del atacante) en la seguridad de la informaci√≥n, que se discutir√°n en este art√≠culo, pueden contribuir a mejorar la eficiencia y mejorar la calidad de TI. <br><a name="habracut"></a><br><h2>  Descargo de responsabilidad </h2><br>  Este art√≠culo es solo para fines informativos.  El autor no es responsable de posibles da√±os y / o interrupciones de las redes y / o servicios de terceros asociados con el desempe√±o de ciertas acciones descritas en el art√≠culo.  El autor tambi√©n alienta a los lectores a cumplir con la ley. <br><br><h2>  No en cambio, sino juntos </h2><br>  Me gustar√≠a hacer una reserva de inmediato para que no se trate de rechazar o reemplazar Threat Intelligence con informaci√≥n recibida de fuentes tradicionales pagas y gratuitas, sino de complementarla y enriquecerla. <br><br>  Por lo tanto, el uso de m√©todos TI adicionales puede aumentar su eficiencia y ayudar a resolver una serie de problemas.  Por ejemplo, con la pr√≥xima epidemia de IoT que afecta ciertas versiones vulnerables de firmware, ¬øqu√© tan pronto puedo obtener un feed con las direcciones IP de dispositivos potencialmente vulnerables para detectar r√°pidamente su actividad en el per√≠metro?  O cuando las reglas del sistema de monitoreo son activadas por un indicador (direcci√≥n IP o nombre de dominio) que se marc√≥ como malicioso hace un a√±o o m√°s, c√≥mo entender si a√∫n sigue siendo malicioso, siempre que inicie alguna verificaci√≥n adicional del indicador como "Por ahora" suele ser imposible. <br><br>  Es decir, la adici√≥n y el enriquecimiento ser√°n especialmente √∫tiles para los indicadores de mediana edad de acuerdo con la "pir√°mide del dolor" de David Bianco <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">[0]</a> (direcciones IP, nombres de dominio, artefactos de red), sin embargo, en algunas circunstancias es posible obtener nuevos indicadores de larga duraci√≥n (arriba de la pir√°mide) analistas <br><br><img src="https://habrastorage.org/getpro/habr/post_images/946/868/d57/946868d575b064e8f552c06fa0b8c363.png"><br><br><h2>  Exploraci√≥n de Internet </h2><br>  Uno de los m√©todos √∫tiles para obtener Threat Intelligence es el escaneo en red. <br><br><div class="spoiler">  <b class="spoiler_title">Lo que generalmente se recolecta al escanear</b> <div class="spoiler_text">  La mayor√≠a de las veces, al realizar un escaneo, los resultados m√°s interesantes se obtienen al recopilar los llamados "banners", las respuestas del software de la aplicaci√≥n del sistema escaneado a las solicitudes del esc√°ner.  Los "banners" contienen una gran cantidad de datos que identifican el software de la aplicaci√≥n y sus diversos par√°metros en el "otro lado", y dicha verificaci√≥n se realiza con bastante rapidez. </div></div><br>  Al resolver la tarea de expandir el alcance de la Inteligencia de amenazas, el escaneo se dirigir√° a todo Internet.  Al escanear un espacio de direcciones p√∫blicas (~ 3.700 millones de direcciones IPv4, excluidas las direcciones reservadas), puede extraer la siguiente informaci√≥n √∫til: <br><br><ul><li>  Qu√© nodos son vulnerables a vulnerabilidades que se explotan ampliamente como parte de campa√±as maliciosas reales y, en vista de este hecho, son fuentes potenciales de exposici√≥n maliciosa. </li><li>  Qu√© nodos son los servidores de control de las redes de botnets <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">[1]</a> , cuyos accesos pueden identificarse mediante un nodo comprometido en el per√≠metro protegido. </li><li>  Qu√© nodos pertenecen a la parte no p√∫blica de las redes an√≥nimas distribuidas, que se pueden usar para salir discretamente sin control fuera del per√≠metro protegido. </li><li>  Informaci√≥n m√°s detallada sobre los nodos "iluminados" en la operaci√≥n del sistema de monitoreo. </li></ul><br><h2>  Selecci√≥n de herramienta </h2><br>  A lo largo de los a√±os de desarrollo de las redes de informaci√≥n, se han creado una gran cantidad de herramientas para el escaneo de redes.  Entre el software actual, se pueden distinguir los siguientes esc√°neres: <br><br><ul><li>  Nmap <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">[2]</a> </li><li>  Zmap <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">[3]</a> </li><li>  Masscan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">[4]</a> </li></ul><br>  Considere brevemente las principales ventajas y desventajas de estas herramientas para el enriquecimiento de TI en el espacio de Internet. <br><br><h4>  Nmap </h4><br>  Quiz√°s el esc√°ner de red m√°s famoso, creado hace 20 a√±os.  Debido a la posibilidad de utilizar secuencias de comandos personalizadas (a trav√©s del motor de secuencias de comandos de Nmap), esta es una herramienta extremadamente flexible, que no se limita a la simple recopilaci√≥n de "banners" aplicados.  Por el momento, se ha escrito una gran cantidad de scripts NSE, muchos de los cuales est√°n disponibles de forma gratuita.  Dado que Nmap monitorea cada conexi√≥n, en otras palabras, tiene una naturaleza s√≠ncrona, no vale la pena usarla para redes grandes como Internet debido a la baja velocidad del esc√°ner.  Al mismo tiempo, es aconsejable utilizar esta herramienta en peque√±as muestras de direcciones obtenidas por herramientas m√°s r√°pidas, debido al poder de NSE. <br><br><div class="spoiler">  <b class="spoiler_title">Acerca de la velocidad de Nmap</b> <div class="spoiler_text">  A pesar de la baja productividad inicial, desde el lanzamiento de este esc√°ner, sus desarrolladores han agregado muchas caracter√≠sticas que aumentan la velocidad de escaneo.  Entre ellos se encuentran los modos operativos paralelos y la tarea de velocidad en paquetes por segundo.  Sin embargo, incluso con configuraciones retorcidas, Nmap va a la zaga de sus competidores as√≠ncronos en velocidad.  Usando el ejemplo de escaneo / 15 subredes en un puerto 443 / tcp desde una m√°quina virtual con 1 CPU Xeon Gold 6140 y un canal gigabit, obtenemos: <br><br><ul><li> 71.08 segundos para Nmap con par√°metros <code>-T5 -n -Pn -p 443 --open --min-rate 1000000 --randomize-hosts --defeat-rst-ratelimit ‚ÄìoG nmap.txt</code> </li><li>  9.15 segundos para Zmap con par√°metros <code>-p 443 ‚Äìo zmap.txt</code> </li></ul><br></div></div><br><h4>  Zmap </h4><br>  Un esc√°ner de red as√≠ncrono bastante conocido, aunque no el primero de su tipo, que apareci√≥ en 2013.  Seg√∫n el informe de los desarrolladores publicado en la 22¬™ conferencia USENIX Security Simposium <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">[5]</a> , la herramienta puede escanear todo el rango de direcciones p√∫blicas, ejecutarse en una computadora promedio con una conexi√≥n a Internet de gigabits, en menos de 45 minutos (a trav√©s de un puerto).  Los beneficios de Zmap incluyen: <br><br><ul><li>  Alta velocidad;  Con el marco PF_RING y una conexi√≥n de 10 gigabits, el tiempo de exploraci√≥n te√≥rico de un espacio p√∫blico de direcciones IPv4 es de 5 minutos (un puerto). </li><li>  Soporte para escaneo aleatorio de direcciones de red. </li><li>  Soporte de m√≥dulo para escaneos TCP SYN, ICMP, consultas DNS, UPnP, BACNET <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">[6]</a> , sondeo UDP. </li><li>  Presencia en los repositorios de distribuciones comunes de GNU / Linux (adem√°s, hay soporte para Mac OS y BSD). </li><li>  Adem√°s de Zmap, se han desarrollado varios proyectos de utilidad relacionados que ampl√≠an la funcionalidad del esc√°ner. </li></ul><br>  Si hablamos de las desventajas de Zmap, aqu√≠ podemos observar la capacidad de escanear direcciones en un solo puerto en este momento. <br><br>  De los proyectos relacionados con Zmap, que ampl√≠an su funcionalidad para tareas de inter√©s, se pueden distinguir los siguientes: <br><br><ul><li>  ZGrab es un esc√°ner de protocolo de aplicaci√≥n compatible con los protocolos TTP, HTTPS, SSH, Telnet, FTP, SMTP, POP3, IMAP, Modbus, BACNET, Siemens S7 y Tridium Fox (capturador de pancartas con funciones avanzadas). </li><li>  ZDNS es una utilidad para consultas r√°pidas de DNS. </li><li>  ZTag es una utilidad para etiquetar los resultados de escaneo proporcionados por ZGrab. </li><li>  ZBrowse es una utilidad de distribuci√≥n sin cabeza basada en Chrome para rastrear cambios en el contenido del sitio web. </li></ul><br><div class="spoiler">  <b class="spoiler_title">Acerca de las caracter√≠sticas de ZGrab</b> <div class="spoiler_text">  El esc√°ner avanzado de los protocolos de aplicaci√≥n ZGrab, para el cual ya se lanz√≥ la versi√≥n 2.0 (no existe una paridad funcional completa con la versi√≥n 1.X, pero se lograr√° en un futuro pr√≥ximo, despu√©s de lo cual ser√° posible hablar sobre el reemplazo completo de la versi√≥n anterior por una nueva), lo que le permite filtrar los resultados de manera bastante flexible escaneo gracias a la compatibilidad con el formato de salida estructurado (JSON).  Por ejemplo, para recopilar solo el emisor y el sujeto de nombre distinguido de los certificados HTTPS, un comando simple es suficiente: <br><br><pre> <code class="hljs powershell">zmap -<span class="hljs-literal"><span class="hljs-literal">-target</span></span><span class="hljs-literal"><span class="hljs-literal">-port</span></span>=<span class="hljs-number"><span class="hljs-number">443</span></span> -<span class="hljs-literal"><span class="hljs-literal">-output</span></span><span class="hljs-literal"><span class="hljs-literal">-fields</span></span>=saddr | ./zgrab2 tls <span class="hljs-literal"><span class="hljs-literal">-o</span></span> - | jq <span class="hljs-string"><span class="hljs-string">'.ip + "|" + .data.tls.result.handshake_log.server_certificates.certificate.parsed.issuer_dn + "|" + .data.tls.result.handshake_log.server_certificates.certificate.parsed.subject_dn'</span></span> &gt; zmap<span class="hljs-literal"><span class="hljs-literal">-dn</span></span><span class="hljs-literal"><span class="hljs-literal">-443</span></span>.txt</code> </pre> <br></div></div><br><h4>  Masscan </h4><br>  El esc√°ner as√≠ncrono, creado en el mismo a√±o que Zmap, es similar en sintaxis de comando a Nmap. <br><br>  El creador (Robert David Graham) declar√≥ una mayor productividad que todos los esc√°neres as√≠ncronos que exist√≠an en ese momento, incluido Zmap, logrado mediante el uso de una pila TCP / IP personalizada. <br><br>  Ventajas del esc√°ner: <br><br><ul><li>  Alta velocidad con rendimiento te√≥rico de hasta 10 millones de paquetes por segundo, lo que le permite escanear todo el espacio p√∫blico IPv4 en pocos minutos (en un puerto) en una conexi√≥n de 10 gigabits, lo mismo que en Zmap usando el marco PF_RING. </li><li>  Soporte para protocolos TCP, SCTP y UDP (a trav√©s del env√≠o de cargas UDP desde Nmap). </li><li>  Soporte para escaneo aleatorio de direcciones de red. </li><li>  Soporte para seleccionar tanto el rango de IP como el rango de puertos al escanear. </li><li>  Soporte para varios formatos para generar resultados de escaneo (XML, grepable, JSON, binario, como una lista). </li></ul><br>  Al mismo tiempo, el esc√°ner tiene varias desventajas: <br><br><ul><li>  En relaci√≥n con el uso de una pila TCP / IP personalizada, se recomienda ejecutar una exploraci√≥n en una IP dedicada para evitar conflictos con la pila del sistema operativo. </li><li>  En comparaci√≥n con ZGrab, las posibilidades de capturar pancartas son bastante limitadas. </li></ul><br><h4>  Cuadro comparativo de esc√°ner </h4><br>  La siguiente tabla de resumen proporciona una comparaci√≥n de la funcionalidad de estos esc√°neres. <br><br><div class="spoiler">  <b class="spoiler_title">Valores en filas de tabla</b> <div class="spoiler_text">  "++" - muy bien implementado <br>  "+" - implementado <br>  "¬±" - implementado con restricciones <br>  "-" - no implementado </div></div><br><img src="https://habrastorage.org/getpro/habr/post_images/253/a0d/74e/253a0d74ef6cf82937472729a65f1cd0.png"><br><br><h2>  Selecci√≥n de objetivos y m√©todo de escaneo </h2><br>  Despu√©s de elegir qu√© herramientas usar, debe decidir sobre el objeto y el prop√≥sito del escaneo, es decir, comprender qu√© y por qu√© escanear.  Si el primero, como regla, no surgen preguntas (este es un espacio p√∫blico de direcciones IPv4 con una serie de excepciones), entonces con el segundo todo depende del resultado final deseado.  Por ejemplo: <br><br><ul><li>  Para identificar nodos que est√°n sujetos a una vulnerabilidad particular, es razonable pasar primero por el rango escaneado con una herramienta r√°pida (Zmap, Masscan) para identificar nodos con puertos abiertos de servicios vulnerables;  despu√©s de finalizar la lista de direcciones, debe usar Nmap con el script NSE correspondiente, si existe, o crear un script personalizado basado en la informaci√≥n disponible sobre la vulnerabilidad en las publicaciones de los investigadores de seguridad.  A veces, un simple grep es suficiente para los banners de aplicaciones recopilados, porque muchos servicios muestran informaci√≥n sobre su versi√≥n. </li><li>  Para identificar los nodos de la infraestructura oculta, tanto las redes an√≥nimas como los nodos C2 (es decir, los servidores de control de las redes botnet), ser√° necesario compilar sondas / cargas √∫tiles personalizadas. </li><li>  Para resolver una amplia gama de problemas en la identificaci√≥n de nodos comprometidos, partes de la infraestructura de redes an√≥nimas y otras cosas, la recopilaci√≥n y el an√°lisis de certificados pueden dar mucho durante los apretones de manos TLS. </li></ul><br><h2>  Elecci√≥n de infraestructura </h2><br>  El hecho de que los esc√°neres r√°pidos modernos puedan mostrar resultados impresionantes en recursos bastante modestos del procesador promedio no significa que la carga en la infraestructura de la red sea insignificante.  Debido a los detalles del tr√°fico generado durante el escaneo, se obtiene una tasa suficientemente significativa de paquetes por segundo.  Seg√∫n la experiencia, un n√∫cleo del procesador promedio (en una CPU de producci√≥n de los √∫ltimos a√±os, en un entorno virtual, en cualquier sistema operativo, sin ning√∫n ajuste de la pila TCP / IP) es capaz de generar un flujo del orden de 100-150 mil paquetes por segundo por l√≠nea de ~ 50 Mb / s , que es una carga grave para los enrutadores de software.  El equipo de red de hardware tambi√©n puede tener problemas para alcanzar el l√≠mite de rendimiento de ASIC.  Al mismo tiempo, a una velocidad de exploraci√≥n de 100-150 Kpps (miles de paquetes por segundo), pasar por alto el rango p√∫blico de IPv4 puede llevar m√°s de 10 horas, es decir.  una cantidad de tiempo bastante significativa.  Para un escaneo realmente r√°pido, debe usar una red distribuida de nodos de escaneo que divida el grupo escaneado en partes.  Tambi√©n es necesaria una orden de exploraci√≥n aleatoria para que la utilizaci√≥n de canales de Internet y la carga por lotes de equipos de proveedores en la "√∫ltima milla" no sea significativa. <br><br><h2>  Dificultades y momentos "sutiles" </h2><br><img src="https://habrastorage.org/getpro/habr/post_images/a07/061/a45/a07061a458b372bd5bddbec15b9fb7a5.jpg"><br><br>  En la pr√°ctica, cuando se realizan exploraciones masivas de redes, uno puede encontrar una serie de dificultades, tanto de naturaleza tecnol√≥gica como organizativa-legal. <br><br><h4>  Problemas de rendimiento y disponibilidad </h4><br>  Como se mencion√≥ anteriormente, el escaneo masivo de la red crea un flujo de tr√°fico con un alto valor de PPS, causando una gran carga tanto en la infraestructura local como en la red del proveedor a la que est√°n conectados los nodos de escaneo.  Antes de realizar cualquier an√°lisis con fines de investigaci√≥n, es imprescindible coordinar todas las acciones con los administradores locales y los representantes del proveedor.  Por otro lado, pueden producirse problemas de rendimiento en los nodos de exploraci√≥n finales cuando se alquilan servidores virtuales en servicios de alojamiento de Internet. <br><br><div class="spoiler">  <b class="spoiler_title">No todos los VPS son igualmente √∫tiles.</b> <div class="spoiler_text">  En el VPS alquilado de servidores no convencionales, uno puede encontrar una situaci√≥n en la que en m√°quinas virtuales productivas (varias vCPU y un par de gigabytes de memoria), las tasas de paquetes Zmap y Masscan no superan las docenas de Kpps.  Muy a menudo, la combinaci√≥n de hardware obsoleto y una combinaci√≥n no √≥ptima de software de entorno virtual juega un papel negativo.  De una forma u otra, de acuerdo con la experiencia del autor, solo se pueden obtener garant√≠as de desempe√±o m√°s o menos sustanciales de las compa√±√≠as, l√≠deres del mercado. </div></div><br>  Adem√°s, al identificar nodos vulnerables, vale la pena considerar que ciertas comprobaciones de NSE pueden conducir a una denegaci√≥n de servicio en los nodos escaneados.  Tal desarrollo de la situaci√≥n no es simplemente no √©tico, sino que definitivamente se ubica fuera del campo legal y conlleva la aparici√≥n de consecuencias en forma de responsabilidad hasta penal. <br><br><h4>  ¬øQu√© estamos buscando y c√≥mo? </h4><br>  Para encontrar algo, necesita saber c√≥mo buscar algo.  Las amenazas evolucionan constantemente y se necesita constantemente un nuevo estudio anal√≠tico para identificarlas.  A veces, los an√°lisis publicados en los documentos de investigaci√≥n se vuelven obsoletos, lo que los lleva a realizar su propia investigaci√≥n. <br><br><div class="spoiler">  <b class="spoiler_title">Un ejemplo famoso</b> <div class="spoiler_text">  Como ejemplo, podemos tomar un estudio <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">[5] de</a> 2013 realizado por los autores de Zmap, dedicado a la identificaci√≥n de nodos de una red TOR.  En el momento de la publicaci√≥n del documento, al analizar la cadena de certificados e identificar el nombre del sujeto especialmente generado en los certificados autofirmados, se encontraron ~ 67 mil nodos TOR trabajando en el puerto tcp / 443 y ~ 2.9 mil nodos trabajando en tcp / 9001.  Actualmente, la lista de nodos TOR detectados por este m√©todo es mucho m√°s peque√±a (se utiliza una variedad m√°s amplia de puertos, se utilizan transportes obfs, se realiza la migraci√≥n a los certificados Let's Encrypt), lo que obliga al uso de otros m√©todos anal√≠ticos para resolver un problema similar. </div></div><br><h4>  Abuso de quejas </h4><br>  Al escanear Internet, existe casi un 100% de riesgo de recibir un flujo de quejas de abuso.  Particularmente molesto es el abuso generado autom√°ticamente para un par de docenas de paquetes SYN.  Y si los escaneos se repiten regularmente, tambi√©n pueden fluir las quejas creadas manualmente. <br><br><div class="spoiler">  <b class="spoiler_title">¬øQui√©n se queja m√°s a menudo?</b> <div class="spoiler_text">  Las principales fuentes de abuso (en su mayor√≠a autom√°ticas) son las instituciones educativas en la zona de dominio * .edu.  Por experiencia, deber√≠a evitar especialmente escanear direcciones de ASN propiedad de la Universidad de Indiana (EE. UU.).  Tambi√©n en las presentaciones de Zmap <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">[5]</a> y Masscan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">[7],</a> uno puede encontrar algunos ejemplos interesantes de respuesta inadecuada al escaneo en red. </div></div><br>  No tome este abuso a la ligera, porque: <br><br><ul><li>  En el caso de quejas, el proveedor de alojamiento suele bloquear el tr√°fico hacia o desde las m√°quinas virtuales alquiladas o incluso suspende su operaci√≥n. </li><li>  Un ISP puede deshabilitar el enlace ascendente para eliminar los riesgos de bloquear el sistema aut√≥nomo. </li></ul><br>  La mejor pr√°ctica para minimizar las quejas es: <br><br><ol><li>  Conocimiento de los T√©rminos de servicio de su proveedor de Internet / hosting. </li><li>  Crear una p√°gina de informaci√≥n sobre las direcciones de origen del escaneo informando sobre el prop√≥sito del escaneo;  haciendo aclaraciones apropiadas en los registros TXT de DNS. </li><li>  Aclaraci√≥n de escaneos al recibir quejas de abuso. </li><li>  Mantener una lista de exclusiones del escaneo, adem√°s de la exclusi√≥n de subredes que se aplican a la primera solicitud, brindando aclaraciones sobre el procedimiento para hacer exclusiones en la p√°gina de informaci√≥n. </li><li>  El escaneo ya no es m√°s frecuente que el requerido para resolver la tarea. </li><li>  Distribuci√≥n del tr√°fico de escaneo por origen, direcciones de destino, as√≠ como el momento en que es posible. </li></ol><br><h2>  Outsourcing de escaneo de red </h2><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/0ad/0fe/7bd/0ad0fe7bdfc413fb9e6326362bed1d9d.jpg" width="500"></div><br>  La realizaci√≥n de exploraciones de masas independientes requiere un enfoque equilibrado (los riesgos se describen anteriormente), aunque debe tener en cuenta que si el procesamiento anal√≠tico de los resultados de exploraci√≥n utilizados no es lo suficientemente profundo, el resultado final puede ser insatisfactorio.  Al menos en t√©rminos t√©cnicos, puede facilitar la tarea utilizando herramientas comerciales existentes, tales como: <br><br><ul><li>  Shodan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">[8]</a> </li><li>  Censys <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">[9]</a> </li><li>  ZoomEye <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">[10]</a> </li></ul><br><div class="spoiler">  <b class="spoiler_title">Mas servicios</b> <div class="spoiler_text">  Adem√°s de los servicios mencionados, hay una gran cantidad de proyectos, de una forma u otra, conectados con el escaneo de redes globales.  Por ejemplo: <br><br><ul><li>  Punk.sh (anteriormente motor de b√∫squeda web PunkSPIDER) </li><li>  Proyecto Sonar (conjunto de datos con los resultados de escaneos de red de Rapid7) </li><li>  Cosa (otro motor de b√∫squeda de IoT) </li></ul></div></div><br><h2>  Shodan </h2><br><img src="https://habrastorage.org/getpro/habr/post_images/ce6/877/d6b/ce6877d6b6b39cb0639d148a7992e46e.jpg"><br><br>  El primer y m√°s famoso motor de b√∫squeda de servicios publicados en Internet, creado originalmente como un motor de b√∫squeda IoT y lanzado en 2009 por John Materley <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">[11]</a> .  Actualmente, el motor de b√∫squeda ofrece varios niveles de acceso a la informaci√≥n dentro de s√≠ mismo.  Sin registro, las posibilidades son muy b√°sicas, al registrarse y comprar una membres√≠a, la siguiente funcionalidad est√° disponible: <br><br><ul><li>  B√∫squeda por filtros b√°sicos. </li><li>  Emisi√≥n de informaci√≥n detallada sobre nodos ("datos en bruto"). </li><li>  Una API "b√°sica" con la capacidad de integrarse con utilidades comunes como Maltego, Metasploit, Nmap y otras. </li><li>  La capacidad de exportar resultados de b√∫squeda (por una tarifa, para "Cr√©ditos" - la moneda interna del servicio). </li><li>  La capacidad de escanear a pedido direcciones y rangos individuales (por una tarifa, para "Cr√©ditos"). </li></ul><br>  Las caracter√≠sticas mencionadas ya son suficientes para el OSINT b√°sico <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">[12]</a> , sin embargo, el motor de b√∫squeda revela completamente sus capacidades con una suscripci√≥n Enterprise, a saber: <br><br><ul><li>  An√°lisis bajo demanda de todo el rango p√∫blico de IPv4 de Internet, incluida la verificaci√≥n del rango especificado de puertos y la especificaci√≥n de colectores de banners espec√≠ficos del protocolo. </li><li>  Notificaciones en tiempo real basadas en los resultados de la ejecuci√≥n de an√°lisis. </li><li>  La capacidad de cargar resultados de an√°lisis sin procesar para un an√°lisis posterior (sin restricciones, toda la base de datos est√° disponible). </li><li>  La capacidad de desarrollar recopiladores personalizados para tareas espec√≠ficas (protocolos no est√°ndar, etc.). </li><li>  Acceso a resultados de escaneos hist√≥ricos (hasta octubre de 2015). </li></ul><br>  El proyecto Shodan ha creado una serie de proyectos relacionados, como cazadores de malware, escaneo de honeypot, exploits, enriqueciendo los resultados del escaneo. <br><br><h2>  Censys </h2><br><img src="https://habrastorage.org/getpro/habr/post_images/29b/24e/4ef/29b24e4efeb65eb7c9d22fee64baa3e8.jpg"><br><br>  Motor de b√∫squeda en IoT y no solo, creado por el autor de Zmap Zakir Durumerik y presentado p√∫blicamente en 2015.  El motor de b√∫squeda utiliza la tecnolog√≠a Zmap y una serie de proyectos relacionados (ZGrab y ZTag).  Sin registro, a diferencia de Shodan, el motor de b√∫squeda est√° limitado a 5 solicitudes por d√≠a desde una IP.  Despu√©s del registro, se ampl√≠an las posibilidades de uso: aparece una API, se aumentan los resultados de b√∫squeda de solicitudes (hasta 1000 resultados), sin embargo, el acceso m√°s completo, incluida la descarga de datos hist√≥ricos, solo est√° disponible en el plan Enterprise. <br><br>  Las ventajas del motor de b√∫squeda sobre Shodan incluyen las siguientes caracter√≠sticas: <br><br><ul><li>  No hay restricciones en los filtros de b√∫squeda en los planes tarifarios b√°sicos. </li><li>  Alta velocidad de actualizaci√≥n de los resultados del escaneo autom√°tico (diariamente, seg√∫n los autores; la velocidad de Shodan es mucho menor). </li></ul><br>  Las desventajas incluyen: <br><br><ul><li>  Menos puertos escaneados en comparaci√≥n con Shodan. </li><li>  Incapacidad para escanear "a pedido" (tanto por rangos de IP como por puertos). </li><li>  Menos profundidad para enriquecer los resultados con los medios "listos para usar" (lo cual es obvio, dado el mayor n√∫mero de herramientas Shodan implementadas a trav√©s de proyectos relacionados). </li></ul><br>  Si los resultados recopilados en el rango de puertos admitidos por Censys son suficientes para lograr este objetivo, entonces la falta de la capacidad de escanear bajo demanda no deber√≠a ser un obst√°culo grave debido a la alta velocidad de actualizaci√≥n de los resultados del escaneo. <br><br><h2>  Zoomeye </h2><br><img src="https://habrastorage.org/getpro/habr/post_images/b0a/9c4/46b/b0a9c446b5585b1256f1f707c2bdd40a.jpg"><br><br>  Un motor de b√∫squeda IoT creado por la compa√±√≠a china de seguridad de la informaci√≥n Knowsec Inc en 2013.  Hoy el motor de b√∫squeda funciona utilizando sus propios desarrollos: Xmap (esc√°ner host) y Wmap (esc√°ner web).  El motor de b√∫squeda recopila informaci√≥n sobre un rango bastante amplio de puertos, cuando se realiza la b√∫squeda es posible clasificarlos de acuerdo con una gran cantidad de criterios (puertos, servicios, SO, aplicaciones) con detalles para cada host (el contenido de los banners de las aplicaciones).  Los resultados de la b√∫squeda enumeran posibles vulnerabilidades para el software de aplicaci√≥n identificado del proyecto SeeBug relacionado (sin verificar la aplicabilidad).  Para las cuentas registradas, una API y una b√∫squeda web tambi√©n est√°n disponibles con un conjunto completo de filtros, pero con una limitaci√≥n en el n√∫mero de resultados mostrados.  Para eliminar restricciones, se propone comprar un plan Enterprise.  De las ventajas de un motor de b√∫squeda, podemos notar: <br><br><ul><li>  Una gran cantidad de puertos escaneados (aproximadamente similares a Shodan). </li><li>  Soporte web ampliado. </li><li>  Aplicaci√≥n e identificador del sistema operativo. </li></ul><br>  Entre las desventajas incluyen: <br><br><ul><li>  Intervalo de actualizaci√≥n lento para resultados de escaneo. </li><li>  Incapacidad para escanear bajo demanda. </li><li>  El enriquecimiento de los resultados del escaneo se limita a la identificaci√≥n de servicios, software de aplicaci√≥n, sistema operativo y posibles vulnerabilidades. </li></ul><br><h4>  Cuadro comparativo de servicios </h4><br>  La siguiente tabla de resumen proporciona una comparaci√≥n de la funcionalidad de los servicios considerados. <br><br><div class="spoiler">  <b class="spoiler_title">Valores en filas de tabla</b> <div class="spoiler_text">  "++" - muy bien implementado <br>  "+" - implementado <br>  "¬±" - implementado con restricciones <br>  "-" - no implementado </div></div><br><img src="https://habrastorage.org/getpro/habr/post_images/1fd/028/d58/1fd028d5843b449c8820b81d3f5d620f.png"><br><br><h2>  Escaneate </h2><br>  La infraestructura propia tambi√©n puede ser una fuente √∫til de TI, por lo que puede comprender qu√© nuevos hosts y servicios aparecieron en la red, ¬øson vulnerables o incluso maliciosos?  Si se pueden usar servicios externos para escanear el per√≠metro (por ejemplo, dicho caso de uso es oficialmente compatible con el caso del usuario de Shodan), entonces todas las acciones dentro del per√≠metro solo pueden llevarse a cabo de forma independiente.  La gama de herramientas para el an√°lisis de red en este caso puede ser bastante extensa: ambos son analizadores pasivos, como Bro <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">[13]</a> , Argus <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">[14]</a> , Nfdump <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">[15]</a> , p0f <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">[16]</a> y esc√°neres activos: Nmap, Zmap, Masscan y sus competidores comerciales.  El marco IVRE <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">[17]</a> , que le permite obtener su propia herramienta similar a Shodan / Censys, puede ayudar a interpretar los resultados. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f32/ab2/cc3/f32ab2cc38acf9802402815b460574d0.jpg"><br><br>  El marco fue desarrollado por un grupo de investigadores de seguridad de la informaci√≥n, uno de los autores es un desarrollador activo de la escasa utilidad <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">[18]</a> Pierre Lalet <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">[19]</a> .  Entre las caracter√≠sticas del marco incluyen: <br><br><ul><li>  El uso de an√°lisis visuales para identificar patrones y anormalidades anormales. </li><li>  Motor de b√∫squeda avanzado con an√°lisis detallado de los resultados del escaneo. </li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Integraci√≥n con utilidades de terceros a trav√©s de la API con soporte de Python. </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> IVRE tambi√©n es adecuado para analizar grandes escaneos de Internet. </font></font><br><br><h2>  Conclusiones </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El escaneo y la inteligencia de red activa son herramientas excelentes que han sido utilizadas por varios investigadores en el campo de la seguridad de la informaci√≥n. </font><font style="vertical-align: inherit;">Sin embargo, para los guardias de seguridad "cl√°sicos", estos m√©todos de trabajo siguen siendo nuevos. </font><font style="vertical-align: inherit;">El uso de OSINT y m√©todos ofensivos en combinaci√≥n con los medios defensivos cl√°sicos fortalecer√° significativamente la protecci√≥n y asegurar√° su proactividad.</font></font><br><br><div class="spoiler">  <b class="spoiler_title">Referencias</b> <div class="spoiler_text"> [0] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">https://detect-respond.blogspot.com/2013/03/the-pyramid-of-pain.html</a> <br> [1] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">https://malware-hunter.shodan.io/</a> <br> [2] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">https://nmap.org</a> <br> [3] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">https://zmap.io</a> <br> [4] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">https://github.com/robertdavidgraham/masscan</a> <br> [5] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">https://zmap.io/paper.pdf</a> <br> [6] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">https://en.wikipedia.org/wiki/BACnet</a> <br> [7] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">https://www.defcon.org/images/defcon-22/dc-22-presentations/Graham-McMillan-Tentler/DEFCON-22-Graham-McMillan-Tentler-Masscaning-the-Internet.pdf</a> <br> [8] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">https://shodan.io</a> <br> [9] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">https://censys.io</a> <br> [10] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">https://www.zoomeye.org</a> <br> [11] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">https://twitter.com/achillean</a> <br> [12] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">https://en.wikipedia.org/wiki/Open-source_intelligence</a> <br> [13] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">https://www.bro.org/</a> <br> [14] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">http://qosient.com/argus/</a> <br> [15] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">http://nfdump.sourceforge.net/</a> <br> [16] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">http://lcamtuf.coredump.cx/p0f/</a> <br> [17] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">https://github.com/cea-sec/ivre</a> <br> [18] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">https://scapy.net/</a> <br> [19] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">https://github.com/pl-</a> </div></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mikhail Larin, experto en el Centro de Monitoreo y Respuesta a Incidentes de Seguridad de la Informaci√≥n Jet CSIRT, Jet Infosystems.</font></font></i> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es426025/">https://habr.com/ru/post/es426025/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es426015/index.html">El uso de drones civiles aserrados para fotograf√≠a a√©rea geod√©sica profesional de la zona.</a></li>
<li><a href="../es426017/index.html">C√≥mo reducir el n√∫mero de experimentos con animales.</a></li>
<li><a href="../es426019/index.html">Estaci√≥n meteorol√≥gica en Arduino de la A a la Z. Parte 5</a></li>
<li><a href="../es426021/index.html">libgdx y sentimientos</a></li>
<li><a href="../es426023/index.html">Lecci√≥n abierta "Laboratorio virtual en Vagrant"</a></li>
<li><a href="../es426027/index.html">Servicios de Amazon Cloud y an√°lisis de cartera de inversiones</a></li>
<li><a href="../es426029/index.html">¬øTe rindes y quieres abandonar la tarea? As√≠ es como se ve la capacitaci√≥n efectiva para desarrolladores</a></li>
<li><a href="../es426031/index.html">Preocuparse por capturar el mundo con inteligencia artificial puede basarse en suposiciones no cient√≠ficas</a></li>
<li><a href="../es426033/index.html">Choque de titanes matem√°ticos sobre prueba √©pica de hip√≥tesis ABC</a></li>
<li><a href="../es426039/index.html">Lanzamiento de emergencia "Soyuz MS-10" (equipo rescatado, transmitido)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>