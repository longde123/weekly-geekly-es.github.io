<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨‍👧 🤲🏾 👼🏼 Examen du kit Xadow Wearable pour Intel Edison et la création d'un étrange jeu basé sur celui-ci 👨🏽‍🚒 😊 👨🏿‍✈️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content=", Intel Edison , Arduino, , . , Edison .
 , Intel Edison . , . Hirose 70 1 . Xadow Wearable Kit for Intel Edison Seeed, , .
 
 
 , FCC. , .
 
 , :
 
 ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Examen du kit Xadow Wearable pour Intel Edison et la création d'un étrange jeu basé sur celui-ci</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/intel/blog/386271/"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/files/dbc/4f0/e79/dbc4f0e794394e80b65192b2c97770ef.jpg"></a><br>
<br>
,   Intel Edison ,          Arduino,    ,     .        ,  Edison        .<br>
   ,    Intel Edison  .          ,       .   Hirose  70     1 .        <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Xadow Wearable Kit for Intel Edison</a>  Seeed,        ,      .<br>
<a name="habracut"></a><br>
<br>
        ,        FCC.        ,    .<br>
<br>
,     :<br>
<br>
<img src="https://habrastorage.org/files/442/662/0c8/4426620c85a146e9a1ef8171ad501184.jpg"><br>
<br>
<ul>
<li>Xadow — Edison –     Intel Edison.</li>
<li>Xadow — 3Axis Accelerometer —     .</li>
<li>Xadow — Edison Programmer –      USB.</li>
<li>Xadow — Barometer BMP 180 –   .</li>
<li>Xadow — Edison SD –   SD .</li>
<li>Battery – .</li>
<li>Xadow — Q Touch Sensor –  .</li>
<li>Digital RGB LED Flexi-Strip —     RGB-.</li>
<li>Xadow — NFC — NFC .</li>
<li>Xadow — Breakout —       .</li>
<li>Xadow – Buzzer – .</li>
<li>Xadow — Vibration Motor – .</li>
<li>Xadow — OLED –  OLED   128x64.</li>
<li>NFC Tags –  3 NFC-.</li>
<li>FFC cable package –   .</li>
<li>Power cable White, Red, Yellow –  .</li>
</ul><br>
<br>
<h1><font color="#0071c5"></font></h1><br>
     ,    ,                 . -,    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">  </a>.<br>
<br>
     <br>
<pre><code class="bash hljs">configure_edison –version</code></pre><br>
     159.<br>
<br>
    .     .<br>
<pre><code class="bash hljs">opkg update<font></font>
opkg upgrade</code></pre><br>
      Arduino IDE.   Seeed,   . <br>
<br>
      Intel XDK for IoT   ++,    .<br>
  - ,         Arduino.   -     I2C.     .     ,     OLED ,   ,    - .            .<br>
      Arduino IDE,      .   ,      :<br>
<pre><code class="bash hljs">systemctl stop clloader</code></pre><br>
    /sketch,       Arduino IDE.   Intel Edison (shutdown now),   ,   PWR    .<br>
<br>
    ,          Edison.     .   /etc/init.d,     automateSketch.sh,     :<br>
<pre><code class="bash hljs"><span class="hljs-meta">#!/bin/sh</span>
<span class="hljs-built_in">exec</span> /sketch/sketch.elf /dev/ttyGS0 /dev/ttyGS0</code></pre><br>
  :<br>
<pre><code class="bash hljs">chmod +x automateSketch.sh</code></pre><br>
    :<br>
<pre><code class="bash hljs">update-rc.d automateSketch.sh defaults</code></pre><br>
<br>
<h1><font color="#0071c5"> </font></h1><br>
          Intel Edison.<br>
         Arduino , ,         Arduino IDE,   .      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">www.arduino.cc</a>. <br>
<br>
   ,   Xadow-Edison Programmer .     USB ,       ,     Arduino IDE.        Device.  Arduino IDE    Intel Edison  Boards Manager.<br>
<br>
     Edison ( 30 )          .<br>
 <br>
<img src="https://habrastorage.org/files/697/d1e/51c/697d1e51cb5a47f4acd002eaf687fe72.png"><br>
<br>
Intel Edison Virtual Com Port (COM25) —    Arduino IDE.<br>
USB Serial Port (COM29) —      , ,  Putty.<br>
<br>
<h1><font color="#0071c5"> </font></h1><br>
    ,     Intel Edison.       .                  .<br>
<br>
     FFC –   .     .    ,    .         .      .     .  ,      ,   3 .  .<br>
<br>
<img src="https://habrastorage.org/files/ba4/834/e33/ba4834e3345c4c3eaba33698dafdfe30.jpg"><br>
<br>
      .     .          1 .   , , ,      .        ,      3 .   ,   .     .<br>
          .<br>
<br>
<img src="https://habrastorage.org/files/487/348/02d/48734802d9c5431394a656dc6c0ced91.jpg"><br>
<br>
      ,               .      ,           , , .<br>
<br>
<img src="https://habrastorage.org/files/dcb/d82/5de/dcbd825deef348d7a1d3eb08270f3be8.jpg"><br>
<br>
<h1><font color="#0071c5">Arduino </font></h1><br>
     .      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">github.com/Seeed-Studio/Xadow_Edison_Demos</a>      .ZIP .  ,      ,            .<br>
<br>
<h1><font color="#0071c5">Battery</font></h1><br>
 Li-Ion .  3.7V.  500 mAh. <br>
<br>
<img src="https://habrastorage.org/files/f75/7d4/ae9/f757d4ae97bd4afeb4f72f8e7d7f79da.jpg"><br>
<br>
<h1><font color="#0071c5">Xadow — Edison</font></h1><br>
<img src="https://habrastorage.org/files/4b4/468/90d/4b446890d9204aac820d85bde58395c2.jpg"><br>
<br>
      Edison.        Edison.   , Edison      .        Arduino .<br>
<br>
    .        .      Edison-Programmer.  —      .        SD .<br>
   PWR  FW_RCVR. PWR       . 9  —  , 2  —  .<br>
<br>
        ,    .   .   ,     USB.    ,     .    ,   .<br>
<br>
,   ,   Edison. , ,   .<br>
<br>
<img src="https://habrastorage.org/files/c6b/ebd/c73/c6bebdc7399b41ecb3e44bef026291f9.jpg"><br>
<br>
         .     —     Linux’,      WiFi. <br>
<br>
<h1><font color="#0071c5">Xadow — Edison Programmer</font></h1><br>
<img src="https://habrastorage.org/files/8d0/f45/479/8d0f454795154e55a674c6fdf5b23811.jpg"><br>
<br>
    .        .   Micro USB :<br>
 —   UART       COM     .<br>
 —   Device/Host     Arduino IDE.   Device  Host  .  Arduino   Device.<br>
<br>
<h1><font color="#0071c5">Xadow — Edison SD</font></h1><br>
<img src="https://habrastorage.org/files/073/06b/ff6/07306bff6ade4bfda50c0ade63d1c753.jpg"><br>
<br>
    SD .         .<br>
  SD    /dev/mmcblk1<br>
     Linux.   -  , :<br>
<pre><code class="bash hljs">mkdir /home/data</code></pre><br>
     :<br>
<pre><code class="bash hljs">mount /dev/mmcblk1   /home/data </code></pre><br>
   Linux   ,    /etc/fstab  <br>
<pre><code class="bash hljs">/dev/mmcblk1	/home/data	auto	auto 0 0</code></pre><br>
<br>
<h1><font color="#0071c5">Xadow – OLED 12864</font></h1><br>
OLED   128x64 . <br>
<br>
<img src="https://habrastorage.org/files/160/2b0/a14/1602b0a1422b40508e31da229ce3fadb.jpg"><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">    seeed</a>. <br>
    I2C.   0x3C.<br>
<br>
,        .<br>
<br>
<pre><code class="hljs pgsql"><span class="hljs-meta">#include &lt;Wire.h&gt;</span>
<span class="hljs-meta">#include &lt;SeeedOLED.h&gt;</span><font></font>
<font></font>
<span class="hljs-type">void</span> setup()<font></font>
 {<font></font>
  Wire.<span class="hljs-keyword">begin</span>();<font></font>
  SeeedOled.init();  //initialze SEEED OLED display<font></font>
  SeeedOled.clearDisplay();          //clear the screen <span class="hljs-keyword">and</span> <span class="hljs-keyword">set</span> <span class="hljs-keyword">start</span> position <span class="hljs-keyword">to</span> top left corner<font></font>
  SeeedOled.setBrightness(<span class="hljs-number">255</span>);<font></font>
  SeeedOled.setNormalDisplay();      //<span class="hljs-keyword">Set</span> display <span class="hljs-keyword">to</span> normal mode (i.e non-inverse mode)<font></font>
  SeeedOled.setPageMode();           //<span class="hljs-keyword">Set</span> addressing mode <span class="hljs-keyword">to</span> Page Mode<font></font>
  SeeedOled.setTextXY(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>);          //<span class="hljs-keyword">Set</span> the <span class="hljs-keyword">cursor</span> <span class="hljs-keyword">to</span> Xth Page, Yth <span class="hljs-keyword">Column</span>  <font></font>
  SeeedOled.putString("Xadow and Edison"); //Print the String<font></font>
<font></font>
  SeeedOled.setTextXY(<span class="hljs-number">7</span>,<span class="hljs-number">0</span>);          //<span class="hljs-keyword">Set</span> the <span class="hljs-keyword">cursor</span> <span class="hljs-keyword">to</span> Xth Page, Yth <span class="hljs-keyword">Column</span>  
  <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> k = <span class="hljs-number">0</span>; k &lt; <span class="hljs-number">128</span>; k++)<font></font>
  {<font></font>
    SeeedOled.sendData(k);<font></font>
  }<font></font>
}<font></font>
<font></font>
<span class="hljs-type">void</span> <span class="hljs-keyword">loop</span>() {<font></font>
}</code></pre><br>
,           .<br>
  8 ,    16 . <br>
<br>
  SeeedOLED   :<br>
<br>
init() –  .<br>
sendCommand(unsigned char command)<br>
setBrightness(unsigned char Brightness) –  <br>
setHorizontalMode()<br>
setPageMode()<br>
setTextXY(unsigned char Row, unsigned char Column) –    .      ,      ,  ,  .         .<br>
clearDisplay() –  .<br>
sendData(unsigned char Data) –    <br>
putChar(unsigned char C) –  .  32-127<br>
putString(const char *String) –   <br>
putNumber(long long_num) —   <br>
putFloat(float floatNumber,unsigned char decimal) —  float <br>
putFloat(float floatNumber) —  float <br>
drawBitmap(unsigned char *bitmaparray,int bytes) –  .     .<br>
setHorizontalScrollProperties(bool direction,unsigned char startPage, unsigned char endPage, unsigned char scrollSpeed)<br>
activateScroll() –  <br>
deactivateScroll() –  .<br>
setNormalDisplay() –  ,   .   .<br>
setInverseDisplay() –     .   .<br>
<br>
<h1><font color="#0071c5">Xadow – Buzzer. </font></h1><br>
<img src="https://habrastorage.org/files/1d2/62a/d1d/1d262ad1d7e148e287b84e6b45b91867.jpg"><br>
<br>
     11  13.      .   ,    0  1    . <br>
<br>
 ,        1     ,   .<br>
<br>
  :<br>
<br>
<pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">buzzerInit</span><span class="hljs-params">()</span>
</span>{<font></font>
    pinMode(<span class="hljs-number">11</span>,OUTPUT);<font></font>
    pinMode(<span class="hljs-number">13</span>,OUTPUT);<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">buzzerOn</span><span class="hljs-params">()</span>
</span>{<font></font>
    digitalWrite(<span class="hljs-number">11</span>,HIGH);<font></font>
    digitalWrite(<span class="hljs-number">13</span>,HIGH); <font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">buzzerOff</span><span class="hljs-params">()</span>
</span>{<font></font>
    digitalWrite(<span class="hljs-number">11</span>,LOW);<font></font>
    digitalWrite(<span class="hljs-number">13</span>,LOW);<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">buzzerSignal</span><span class="hljs-params">(<span class="hljs-keyword">int</span> t_ms)</span>
</span>{
    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> cur = millis(); 
    <span class="hljs-keyword">while</span>((millis()-cur) &lt; t_ms )<font></font>
    {<font></font>
        buzzerOn();<font></font>
        delayMicroseconds(<span class="hljs-number">150</span>);<font></font>
        buzzerOff();<font></font>
        delayMicroseconds(<span class="hljs-number">150</span>);<font></font>
    }<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setup</span><span class="hljs-params">()</span>	
</span>{<font></font>
    buzzerInit();	<font></font>
    buzzerSignal(<span class="hljs-number">1000</span>);<font></font>
}<font></font>
 <font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">loop</span><span class="hljs-params">()</span>	 	
</span>{	<font></font>
}</code></pre><br>
    ,      .      .<br>
 ,       ,     Intel XDK for IoT  ++.   .<br>
<br>
<h1><font color="#0071c5">Xadow — Vibration Motor. </font></h1><br>
<img src="https://habrastorage.org/files/953/8d4/3f8/9538d43f890e493a97133e06c7a0b386.jpg"><br>
<br>
      .     .<br>
<br>
<pre><code class="hljs cs"><span class="hljs-comment">// Xadow - Vibro</span>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">vibroInit</span>(<span class="hljs-params"></span>)</span><font></font>
{<font></font>
    pinMode(<span class="hljs-number">11</span>,OUTPUT);<font></font>
    pinMode(<span class="hljs-number">10</span>,OUTPUT);<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">vibroOn</span>(<span class="hljs-params"></span>)</span><font></font>
{<font></font>
    digitalWrite(<span class="hljs-number">11</span>,HIGH);<font></font>
    digitalWrite(<span class="hljs-number">10</span>,HIGH); <font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">vibroOff</span>(<span class="hljs-params"></span>)</span><font></font>
{<font></font>
    digitalWrite(<span class="hljs-number">11</span>,LOW);<font></font>
    digitalWrite(<span class="hljs-number">10</span>,LOW);<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setup</span>(<span class="hljs-params"></span>)</span>	<font></font>
{<font></font>
    vibroInit();	<font></font>
    vibroOn();<font></font>
    delay(<span class="hljs-number">500</span>);<font></font>
    vibroOff();<font></font>
}<font></font>
 <font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">loop</span>(<span class="hljs-params"></span>)</span>	 	<font></font>
{	<font></font>
}</code></pre><br>
       ,    ,     1.<br>
<br>
<h1><font color="#0071c5">Xadow — Q Touch Sensor</font></h1><br>
<img src="https://habrastorage.org/files/50b/475/a59/50b475a5925545ec8d2929758a9e6ae6.jpg"><br>
<br>
       .    I2C   0x1B. <br>
  .        .          .<br>
<br>
  ,    :<br>
<br>
<pre><code class="hljs pgsql"><span class="hljs-meta">#include &lt;Wire.h&gt;</span>
<span class="hljs-meta">#include "Seeed_QTouch.h"</span><font></font>
<font></font>
<span class="hljs-type">void</span> setup()<font></font>
{<font></font>
    <span class="hljs-type">Serial</span>.<span class="hljs-keyword">begin</span>(<span class="hljs-number">9600</span>);<font></font>
    Wire.<span class="hljs-keyword">begin</span>();<font></font>
}<font></font>
<font></font>
<span class="hljs-type">void</span> <span class="hljs-keyword">loop</span>()<font></font>
{<font></font>
    <span class="hljs-type">int</span> tn = QTouch.touchNum();<font></font>
    <font></font>
    <span class="hljs-keyword">if</span>(tn&gt;=<span class="hljs-number">0</span>)<font></font>
    {<font></font>
        <span class="hljs-type">Serial</span>.print("KEY");
        <span class="hljs-type">Serial</span>.print(tn);
        <span class="hljs-type">Serial</span>.println(" touched");<font></font>
    }<font></font>
    <font></font>
    delay(<span class="hljs-number">10</span>);<font></font>
}</code></pre><br>
<br>
<h1><font color="#0071c5">Xadow – NFC</font></h1><br>
<img src="https://habrastorage.org/files/3f7/3e0/db0/3f73e0db011141fd918ead44a89bcf8d.jpg"><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">http://www.seeedstudio.com/wiki/Xadow_-_NFC</a><br>
<br>
NFC .   I2C, SPI, UART.    13.56 .      .   ISO14443 Type A and Type B.  P2P .       .<br>
<br>
     NFC ,     .<br>
 <br>
<img src="https://habrastorage.org/files/137/708/df8/137708df862a4c3b96a9f40cbb3d7b63.jpg"><br>
<br>
        NDEF, PN532, PN532_HSU, PN532_I2C, PN532_SPI      Seeed.<br>
<br>
         ,            NDEF-&gt;readTag<br>
<br>
,       .       :<br>
<pre><code class="bash hljs">Tag is not NDEF formatted.<font></font>
NFC Tag - Mifare Classic<font></font>
UID 6E A5 0B 01</code></pre><br>
    - ,    .  NDEF-&gt;FormatTag:<br>
<br>
    ,    NDEF-&gt;WriteTag.<br>
<br>
     :<br>
<pre><code class="bash hljs">NFC Tag - Mifare Classic<font></font>
UID 5E B1 FB 01<font></font>
<font></font>
NDEF Message 1 record, 28 bytes<font></font>
  NDEF Record<font></font>
    TNF 0x1 Well Known<font></font>
    Type Length 0x1 1<font></font>
    Payload Length 0x18 24<font></font>
    Type 55  U<font></font>
    Payload 00 49 6E 74 65 6C 20 45 64 69 73 6F 6E 20 77 69 74 68 20 58 61 64 6F 77  .Intel Edison with Xadow<font></font>
    Record is 28 bytes</code></pre><br>
<br>
<h1><font color="#0071c5">Xadow — 3Axis Accelerometer</font></h1><br>
<img src="https://habrastorage.org/files/ae3/b5d/624/ae3b5d6242a2411493312b38ec887176.jpg"><br>
<br>
 .    .    ±16 g.    I2C   0x53.   ADXL345.    DigitalAccelerometer_ADXL345  .<br>
    ±2g, ±4g, ±8g, ±16g.      .<br>
   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">pdf1.alldatasheet.com/datasheet-pdf/view/254714/AD/ADXL345.html</a><br>
<br>
  16- .   .     int,    , , :<br>
<br>
<pre><code class="hljs cs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">correct</span>(<span class="hljs-params"><span class="hljs-keyword">int</span> &amp;a</span>)</span><font></font>
{<font></font>
 <span class="hljs-keyword">if</span>( a &gt; <span class="hljs-number">32767</span> )<font></font>
     a = -(<span class="hljs-number">65536</span> - a);  <font></font>
}</code></pre><br>
   ±2g,       256.    ,       .       Linux   I2C.     ,        ,   .<br>
<br>
<h1><font color="#0071c5">Xadow — Barometer BMP 180</font></h1><br>
<img src="https://habrastorage.org/files/f53/fe3/d54/f53fe3d5408c47d2a9a54ad394e2d4e2.jpg"><br>
<br>
  .    300-1100  (  -500..+9000    ).   I2C   0x77. <br>
 ,         . ,     I2C ,          .<br>
<br>
<h1><font color="#0071c5">Xadow – Breakout</font></h1><br>
<img src="https://habrastorage.org/files/65a/c45/141/65ac45141b264d9b9fdfafe9d6e93e75.jpg"><br>
<br>
    .   3.3V, SCL, SDA, TX0, GND, SCK, MOS1, MOS0, A5.      ,       seeed.   Serial,  I2C.      .<br>
<br>
<h1><font color="#0071c5">Digital RGB LED Flexi-Strip</font></h1><br>
<img src="https://habrastorage.org/files/99e/56e/e5d/99e56ee5dd524b1d98d4d35e6576dd6e.jpg"><br>
<br>
  5 . RGB  WS2812B.     .<br>
 ,   ,   .    Xadow-Breakout.<br>
<br>
<img src="https://habrastorage.org/files/ce0/9eb/8ec/ce09eb8ec9024860aa22f22b40ae4958.png"><br>
<br>
<img src="https://habrastorage.org/files/b51/5f5/160/b515f5160d8b4ea6812c0983d7228ee0.jpg"><br>
<br>
   ,            .<br>
<br>
  :<br>
<br>
<pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;Wire.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"Seeed_ws2812.h"</span></span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> SIG_PIN 12</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> LEN_NUM 5</span><font></font>
<font></font>
WS2812 strip = WS2812(LEN_NUM, SIG_PIN);<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setup</span><span class="hljs-params">()</span> </span>{<font></font>
  strip.begin();<font></font>
  <span class="hljs-comment">//Serial.begin(115200);   </span><font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">int</span> pos = <span class="hljs-number">0</span>;<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">loop</span><span class="hljs-params">()</span> </span>{  <font></font>
  strip.WS2812SetRGB(pos,<span class="hljs-number">255</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>);<font></font>
  strip.WS2812Send();<font></font>
  delay(<span class="hljs-number">100</span>);<font></font>
  <font></font>
  strip.WS2812SetRGB(pos,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>);<font></font>
  strip.WS2812Send();<font></font>
  delay(<span class="hljs-number">100</span>);<font></font>
<font></font>
  pos = (pos+<span class="hljs-number">1</span>)%LEN_NUM;<font></font>
}</code></pre><br>
<br>
<h1><font color="#0071c5"> </font></h1><br>
   -   .      .       .     .    ,      ,     45    . ,     ,      .    ,     .       ,    ,    ,  ,     .     ,     ,    .<br>
<br>
<img src="https://habrastorage.org/files/8d3/450/97c/8d345097c7394595966f590ec7e56361.jpg"><br>
<br>
 :<br>
<ul>
<li>,</li>
<li>OLED ,</li>
<li> ,</li>
<li>    ,</li>
<li>  ,</li>
<li>.</li>
</ul><br>
    .      Breakout,   .    ,   .       .    .      .     ,   .         .<br>
     ,    .<br>
<br>
<img src="https://habrastorage.org/files/d2a/fb8/9c6/d2afb89c641e4a6f93b7591a452c6ef0.jpg"><br>
<br>
 Linux   .<br>
     PWR    9    .     3 .<br>
<br>
    ,        A       B.      .<br>
<br>
<img src="https://habrastorage.org/files/177/44d/764/17744d764d684868aa633b7e45be7b64.jpg"><br>
<br>
    .            .      You Win!       ,  You Lose!<br>
<br>
<iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://www.youtube.com/embed/1Tjff7wDPIQ%3Ffeature%3Doembed&amp;usg=ALkJrhjyM_uZWHqBhaFlmph_-qQyGVEavg" frameborder="0" allowfullscreen=""></iframe><br>
<br>
             ,      .<br>
<br>
<div class="spoiler"><b class="spoiler_title">   </b><div class="spoiler_text"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;Wire.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;Seeed_ws2812.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;SeeedOLED.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;Seeed_QTouch.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;ADXL345.h&gt;</span></span><font></font>
<font></font>
<span class="hljs-comment">//  </span>
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> stateMenu = <span class="hljs-number">1</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> stateCount = <span class="hljs-number">3</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> stateHelp = <span class="hljs-number">4</span>;<font></font>
<font></font>
<span class="hljs-comment">// </span>
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> keyBack = <span class="hljs-number">0</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> keyA = <span class="hljs-number">1</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> keyB = <span class="hljs-number">2</span>;<font></font>
<font></font>
<span class="hljs-comment">// LED </span>
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> ledSigPin =  <span class="hljs-number">12</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> numLed = <span class="hljs-number">5</span>;<font></font>
<font></font>
<span class="hljs-comment">// </span>
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> answerLeft = <span class="hljs-number">1</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> answerRight = <span class="hljs-number">2</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> answerUp = <span class="hljs-number">3</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> answerDown = <span class="hljs-number">4</span>;<font></font>
<font></font>
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> colorGreen = <span class="hljs-number">1</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> colorRed = <span class="hljs-number">2</span>;<font></font>
<font></font>
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> numLevels = <span class="hljs-number">6</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> answerID = <span class="hljs-number">5</span>;<font></font>
<font></font>
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> angleScale = <span class="hljs-number">100</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> angleReact = <span class="hljs-number">100</span>;<span class="hljs-comment">//   * angleScale</span><font></font>
<font></font>
<span class="hljs-keyword">int</span> numWins;<span class="hljs-comment">//  </span>
<span class="hljs-keyword">int</span> numLosts;<span class="hljs-comment">//  </span>
<span class="hljs-keyword">int</span> gameState;<span class="hljs-comment">//  </span><font></font>
<font></font>
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> numSets = <span class="hljs-number">5</span>;<span class="hljs-comment">//    </span><font></font>
<font></font>
<span class="hljs-comment">//  </span>
<span class="hljs-keyword">int</span> levels[numLevels][numLed+<span class="hljs-number">1</span>] = {  {colorGreen,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,answerLeft},<font></font>
                             {colorRed,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,answerRight},<font></font>
                             {<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,colorGreen,answerRight},<font></font>
                             {<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,colorRed,answerLeft},<font></font>
                             {<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,colorGreen,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,answerUp},<font></font>
                             {<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,colorRed,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,answerRight}};
<span class="hljs-comment">//  </span>
<span class="hljs-keyword">int</span> rightAnswer;<font></font>
<font></font>
WS2812 strip = WS2812(numLed, ledSigPin);<font></font>
ADXL345 adxl; <font></font>
<font></font>
<span class="hljs-comment">//   </span>
<span class="hljs-keyword">int</span> gameLevel;<font></font>
<font></font>
<span class="hljs-comment">//  </span>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">initAccel</span><span class="hljs-params">()</span>
</span>{<font></font>
  adxl.powerOn();<font></font>
<font></font>
  <span class="hljs-comment">//set activity/ inactivity thresholds (0-255)</span>
  adxl.setActivityThreshold(<span class="hljs-number">75</span>); <span class="hljs-comment">//62.5mg per increment</span>
  adxl.setInactivityThreshold(<span class="hljs-number">75</span>); <span class="hljs-comment">//62.5mg per increment</span>
  adxl.setTimeInactivity(<span class="hljs-number">10</span>); <span class="hljs-comment">// how many seconds of no activity is inactive?</span><font></font>
 <font></font>
  <span class="hljs-comment">//look of activity movement on this axes - 1 == on; 0 == off </span>
  adxl.setActivityX(<span class="hljs-number">1</span>);<font></font>
  adxl.setActivityY(<span class="hljs-number">1</span>);<font></font>
  adxl.setActivityZ(<span class="hljs-number">1</span>);<font></font>
 <font></font>
  <span class="hljs-comment">//look of inactivity movement on this axes - 1 == on; 0 == off</span>
  adxl.setInactivityX(<span class="hljs-number">1</span>);<font></font>
  adxl.setInactivityY(<span class="hljs-number">1</span>);<font></font>
  adxl.setInactivityZ(<span class="hljs-number">1</span>);<font></font>
 <font></font>
  <span class="hljs-comment">//look of tap movement on this axes - 1 == on; 0 == off</span>
  adxl.setTapDetectionOnX(<span class="hljs-number">0</span>);<font></font>
  adxl.setTapDetectionOnY(<span class="hljs-number">0</span>);<font></font>
  adxl.setTapDetectionOnZ(<span class="hljs-number">1</span>);<font></font>
 <font></font>
  <span class="hljs-comment">//set values for what is a tap, and what is a double tap (0-255)</span>
  adxl.setTapThreshold(<span class="hljs-number">50</span>); <span class="hljs-comment">//62.5mg per increment</span>
  adxl.setTapDuration(<span class="hljs-number">15</span>); <span class="hljs-comment">//625us per increment</span>
  adxl.setDoubleTapLatency(<span class="hljs-number">80</span>); <span class="hljs-comment">//1.25ms per increment</span>
  adxl.setDoubleTapWindow(<span class="hljs-number">200</span>); <span class="hljs-comment">//1.25ms per increment</span><font></font>
 <font></font>
  <span class="hljs-comment">//set values for what is considered freefall (0-255)</span>
  adxl.setFreeFallThreshold(<span class="hljs-number">7</span>); <span class="hljs-comment">//(5 - 9) recommended - 62.5mg per increment</span>
  adxl.setFreeFallDuration(<span class="hljs-number">45</span>); <span class="hljs-comment">//(20 - 70) recommended - 5ms per increment</span><font></font>
 <font></font>
  <span class="hljs-comment">//setting all interrupts to take place on int pin 1</span>
  <span class="hljs-comment">//I had issues with int pin 2, was unable to reset it</span><font></font>
  adxl.setInterruptMapping( ADXL345_INT_SINGLE_TAP_BIT,   ADXL345_INT1_PIN );<font></font>
  adxl.setInterruptMapping( ADXL345_INT_DOUBLE_TAP_BIT,   ADXL345_INT1_PIN );<font></font>
  adxl.setInterruptMapping( ADXL345_INT_FREE_FALL_BIT,    ADXL345_INT1_PIN );<font></font>
  adxl.setInterruptMapping( ADXL345_INT_ACTIVITY_BIT,     ADXL345_INT1_PIN );<font></font>
  adxl.setInterruptMapping( ADXL345_INT_INACTIVITY_BIT,   ADXL345_INT1_PIN );<font></font>
 <font></font>
  <span class="hljs-comment">//register interrupt actions - 1 == on; 0 == off  </span>
  adxl.setInterrupt( ADXL345_INT_SINGLE_TAP_BIT, <span class="hljs-number">1</span>);<font></font>
  adxl.setInterrupt( ADXL345_INT_DOUBLE_TAP_BIT, <span class="hljs-number">1</span>);<font></font>
  adxl.setInterrupt( ADXL345_INT_FREE_FALL_BIT,  <span class="hljs-number">1</span>);<font></font>
  adxl.setInterrupt( ADXL345_INT_ACTIVITY_BIT,   <span class="hljs-number">1</span>);<font></font>
  adxl.setInterrupt( ADXL345_INT_INACTIVITY_BIT, <span class="hljs-number">1</span>);<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">initGame</span><span class="hljs-params">()</span>
</span>{<font></font>
  SeeedOled.clearDisplay();<font></font>
  SeeedOled.setNormalDisplay();<font></font>
  SeeedOled.setPageMode(); <font></font>
<font></font>
  switchToMenu();<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setup</span><span class="hljs-params">()</span>
</span>{<font></font>
    strip.begin();<font></font>
    SeeedOled.init();<font></font>
    initAccel();<font></font>
    initGame();<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">cleanLED</span><span class="hljs-params">()</span>
</span>{
  <span class="hljs-keyword">for</span>( <span class="hljs-keyword">int</span> led = <span class="hljs-number">0</span>; led &lt; numLed; led++ )<font></font>
      strip.WS2812SetRGB(led,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>); <font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">updateLED</span><span class="hljs-params">()</span>
</span>{<font></font>
  strip.WS2812Send();<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">drawMenu</span><span class="hljs-params">()</span>
</span>{<font></font>
  SeeedOled.clearDisplay();<font></font>
  SeeedOled.setTextXY(<span class="hljs-number">0</span>,<span class="hljs-number">2</span>);<font></font>
  SeeedOled.putString(<span class="hljs-string">"Edison Game"</span>);<font></font>
<font></font>
  SeeedOled.setTextXY(<span class="hljs-number">2</span>,<span class="hljs-number">1</span>);<font></font>
  SeeedOled.putString(<span class="hljs-string">"A - Start"</span>);<font></font>
<font></font>
  SeeedOled.setTextXY(<span class="hljs-number">4</span>,<span class="hljs-number">1</span>);<font></font>
  SeeedOled.putString(<span class="hljs-string">"B - Help"</span>); <font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">drawHelp</span><span class="hljs-params">()</span>
</span>{<font></font>
  SeeedOled.clearDisplay();<font></font>
  <font></font>
  <span class="hljs-keyword">char</span> *messages[] = {    <span class="hljs-string">"Center green -"</span>,
    <span class="hljs-string">"tilt forward."</span> ,
    <span class="hljs-string">"Center red -"</span> ,
    <span class="hljs-string">"tilt backward."</span>, 
    <span class="hljs-string">"Green edge -"</span> ,
    <span class="hljs-string">"tilt same side."</span> ,
    <span class="hljs-string">"Red edge - tilt"</span>,
    <span class="hljs-string">"other side."</span><font></font>
 };<font></font>
<font></font>
   <span class="hljs-keyword">for</span>( <span class="hljs-keyword">int</span> k = <span class="hljs-number">0</span>; k &lt; <span class="hljs-number">8</span>; k++ )<font></font>
   {<font></font>
      SeeedOled.setTextXY(k,<span class="hljs-number">0</span>);<font></font>
      SeeedOled.putString(messages[k]);<font></font>
   }<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">makeNewLevel</span><span class="hljs-params">()</span>
</span>{<font></font>
    gameLevel = rand() % numLevels;<font></font>
    rightAnswer = levels[gameLevel][answerID];<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">showGameStart</span><span class="hljs-params">()</span>
</span>{<font></font>
  SeeedOled.clearDisplay();<font></font>
  SeeedOled.setTextXY(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>);<font></font>
  SeeedOled.putString(<span class="hljs-string">"Press Start"</span>);<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">getKeys</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-keyword">int</span> tn = QTouch.touchNum();
    <span class="hljs-keyword">return</span> tn;   <font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">int</span> haveTime = <span class="hljs-number">20</span>;<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">showGameLevel</span><span class="hljs-params">()</span>
</span>{
  <span class="hljs-keyword">for</span>( <span class="hljs-keyword">int</span> k = <span class="hljs-number">0</span>; k &lt; numLed; k++ )<font></font>
  {<font></font>
     <span class="hljs-keyword">int</span> color = levels[gameLevel][k];
     <span class="hljs-keyword">switch</span>(color)<font></font>
     {<font></font>
         <span class="hljs-keyword">case</span> colorRed  : strip.WS2812SetRGB(k,<span class="hljs-number">255</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>); <span class="hljs-keyword">break</span>;
         <span class="hljs-keyword">case</span> colorGreen: strip.WS2812SetRGB(k,<span class="hljs-number">0</span>,<span class="hljs-number">255</span>,<span class="hljs-number">0</span>); <span class="hljs-keyword">break</span>;
         <span class="hljs-keyword">default</span>        : strip.WS2812SetRGB(k,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>);<font></font>
     }<font></font>
  }<font></font>
<font></font>
  updateLED();<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">switchToSets</span><span class="hljs-params">()</span>
</span>{<font></font>
  numWins = <span class="hljs-number">0</span>;<font></font>
  numLosts = <span class="hljs-number">0</span>;<font></font>
  switchToPlay();<font></font>
}<font></font>
<font></font>
<span class="hljs-comment">//------------------------------------</span><font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">switchToPlay</span><span class="hljs-params">()</span>
</span>{<font></font>
  cleanLED();<font></font>
  updateLED();<font></font>
<font></font>
  SeeedOled.clearDisplay();<font></font>
  SeeedOled.setTextXY(<span class="hljs-number">3</span>,<span class="hljs-number">3</span>);<font></font>
  SeeedOled.putString(<span class="hljs-string">"Get ready!"</span>);<font></font>
<font></font>
  <span class="hljs-keyword">int</span> waitTime = <span class="hljs-number">2000</span> + (rand()%<span class="hljs-number">4</span>)*<span class="hljs-number">500</span>;<font></font>
<font></font>
  delay(waitTime);<font></font>
<font></font>
  makeNewLevel();<font></font>
  <font></font>
  SeeedOled.setTextXY(<span class="hljs-number">3</span>,<span class="hljs-number">3</span>);<font></font>
  SeeedOled.putString(<span class="hljs-string">"          "</span>);<font></font>
<font></font>
  haveTime = <span class="hljs-number">100</span>;<font></font>
  gameState = stateCount;<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">doPlay</span><span class="hljs-params">()</span>
</span>{
  <span class="hljs-keyword">if</span>( haveTime &gt;= <span class="hljs-number">0</span> )<font></font>
  {<font></font>
    SeeedOled.setTextXY(<span class="hljs-number">3</span>,<span class="hljs-number">1</span>);
    <span class="hljs-keyword">char</span> str[<span class="hljs-number">100</span>];
    <span class="hljs-built_in">sprintf</span>(str,<span class="hljs-string">"-- TILT NOW --"</span>);<font></font>
    SeeedOled.putString(str);<font></font>
<font></font>
    SeeedOled.setTextXY(<span class="hljs-number">5</span>,<span class="hljs-number">6</span>);
    <span class="hljs-built_in">sprintf</span>(str,<span class="hljs-string">"%d  "</span>,haveTime);<font></font>
    SeeedOled.putString(str);<font></font>
<font></font>
    showGameLevel();<font></font>
    <font></font>
    <span class="hljs-keyword">int</span> answerID = getAnswerID();<font></font>
<font></font>
    haveTime--;<font></font>
    <font></font>
    <span class="hljs-keyword">if</span>( answerID !=<span class="hljs-number">0</span> || haveTime &lt; <span class="hljs-number">0</span>)<font></font>
    {<font></font>
      <span class="hljs-keyword">char</span> *message;
      <span class="hljs-keyword">if</span>( answerID != rightAnswer || haveTime &lt; <span class="hljs-number">0</span>)<font></font>
      {<font></font>
        numLosts++;<font></font>
        message = <span class="hljs-string">"You lose!"</span>;<font></font>
      }<font></font>
      <span class="hljs-keyword">else</span><font></font>
      {<font></font>
        numWins++;<font></font>
        message = <span class="hljs-string">"You win!"</span>;<font></font>
      }<font></font>
<font></font>
      cleanLED();<font></font>
      updateLED();<font></font>
<font></font>
      SeeedOled.clearDisplay();<font></font>
      SeeedOled.setTextXY(<span class="hljs-number">3</span>,<span class="hljs-number">4</span>);<font></font>
      SeeedOled.putString(message);<font></font>
<font></font>
      delay(<span class="hljs-number">1000</span>);<font></font>
<font></font>
      <span class="hljs-keyword">if</span>( numWins + numLosts == numSets )<font></font>
      {<font></font>
        switchToMenu();<font></font>
      }<font></font>
      <span class="hljs-keyword">else</span><font></font>
      {<font></font>
        switchToPlay();<font></font>
      }<font></font>
    }<font></font>
  }<font></font>
}<font></font>
<font></font>
<span class="hljs-comment">//-----------------------</span><font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">switchToHelp</span><span class="hljs-params">()</span>
</span>{<font></font>
    drawHelp();<font></font>
    gameState = stateHelp;<font></font>
<font></font>
    cleanLED();<font></font>
    updateLED();<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">doHelp</span><span class="hljs-params">()</span>
</span>{<font></font>
  cleanLED();<font></font>
  updateLED();<font></font>
  <font></font>
  <span class="hljs-keyword">int</span> key = getKeys();<font></font>
  <font></font>
  <span class="hljs-keyword">if</span>( key == keyBack )<font></font>
      switchToMenu();  <font></font>
}<font></font>
<font></font>
<span class="hljs-comment">//-----------------------</span>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">switchToMenu</span><span class="hljs-params">()</span>
</span>{<font></font>
  drawMenu();<font></font>
  gameState = stateMenu;<font></font>
<font></font>
  cleanLED();<font></font>
  updateLED();<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">doMenu</span><span class="hljs-params">()</span>
</span>{
  <span class="hljs-keyword">int</span> key = getKeys();<font></font>
  <font></font>
  <span class="hljs-keyword">if</span>( key == keyA )<font></font>
      switchToSets();  <font></font>
<font></font>
    <span class="hljs-keyword">if</span>( key == keyB )<font></font>
      switchToHelp();  <font></font>
}<font></font>
<span class="hljs-comment">//-----------------------</span><font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">correct</span><span class="hljs-params">(<span class="hljs-keyword">int</span> &amp;a)</span>
</span>{
 <span class="hljs-keyword">if</span>( a &gt; <span class="hljs-number">32767</span> )<font></font>
     a = -(<span class="hljs-number">65536</span> - a);  <font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">int</span>  <span class="hljs-title">getAnswerID</span><span class="hljs-params">()</span>
</span>{
  <span class="hljs-keyword">int</span> x,y,z;  <font></font>
  adxl.readXYZ(&amp;x, &amp;y, &amp;z);<font></font>
<font></font>
  correct(x);<font></font>
  correct(y);<font></font>
  correct(z);<font></font>
<font></font>
  <span class="hljs-keyword">int</span> v1 = angleReact;
  <span class="hljs-keyword">if</span>( z != <span class="hljs-number">0</span> )<font></font>
      v1 = y*angleScale/z;<font></font>
<font></font>
  <span class="hljs-keyword">if</span>( v1 &gt; angleReact )
    <span class="hljs-keyword">return</span> answerRight;<font></font>
<font></font>
  <span class="hljs-keyword">if</span>( v1 &lt; -angleReact )
    <span class="hljs-keyword">return</span> answerLeft;<font></font>
<font></font>
  <span class="hljs-keyword">int</span> v2 = angleReact;<font></font>
<font></font>
  <span class="hljs-keyword">if</span>( z != <span class="hljs-number">0</span> )<font></font>
      v2 = x*angleScale/z;<font></font>
<font></font>
  <span class="hljs-keyword">if</span>( v2 &gt; angleReact )
    <span class="hljs-keyword">return</span> answerUp;<font></font>
<font></font>
  <span class="hljs-keyword">if</span>( v2 &lt; -angleReact )
    <span class="hljs-keyword">return</span> answerDown;<font></font>
<font></font>
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">gameStep</span><span class="hljs-params">()</span>
</span>{
  <span class="hljs-keyword">switch</span>(gameState)<font></font>
  {<font></font>
    <span class="hljs-keyword">case</span> stateCount: doPlay();<span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> stateMenu:  doMenu();<span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> stateHelp:  doHelp();<span class="hljs-keyword">break</span>;<font></font>
  }<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">loop</span><span class="hljs-params">()</span>
</span>{<font></font>
    gameStep();<font></font>
    delay(<span class="hljs-number">10</span>);<font></font>
}</code></pre></div></div></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr386271/">https://habr.com/ru/post/fr386271/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr386255/index.html">Ответы гендиректора «Соликс БиоСистемз Восток» на вопросы пользователей Geektimes</a></li>
<li><a href="../fr386259/index.html">Nous économisons l'eau automatiquement</a></li>
<li><a href="../fr386261/index.html">Les incroyables aventures de Robert Hanbury Brown et Richard Twiss. Partie 2: sous la Croix du Sud</a></li>
<li><a href="../fr386263/index.html">Les sociétés de médias tentent de sélectionner des publicités en étudiant les réactions neurologiques et biologiques du public.</a></li>
<li><a href="../fr386265/index.html">Bande-annonce du film Warcraft</a></li>
<li><a href="../fr386273/index.html">Capture de vidéo à partir de caméras USB sur des appareils Linux</a></li>
<li><a href="../fr386275/index.html">"Assembler un gros hélicoptère sans rien savoir d'eux?" - oui un non-sens</a></li>
<li><a href="../fr386279/index.html">Comment les wearables du futur sont-ils apparus en 1992? Excursion dans le monde des gadgets 1992 et 2003</a></li>
<li><a href="../fr386281/index.html">Collecte de fonds pour un scanner inhabituel qui peut rapidement faire face même avec des livres</a></li>
<li><a href="../fr386283/index.html">5 cas originaux de marques se faisant connaître à travers des jeux</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>