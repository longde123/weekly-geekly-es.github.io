<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚óªÔ∏è üèåÔ∏è ü§ô JavaScript-Anleitung zur Fehlerbehandlung ‚ÜîÔ∏è üèöÔ∏è üôÖ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Fehler sind gut. Der Autor des Materials, dessen √úbersetzung wir heute ver√∂ffentlichen, ist zuversichtlich, dass diese Idee allen bekannt ist. Auf den...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>JavaScript-Anleitung zur Fehlerbehandlung</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/431078/">  Fehler sind gut.  Der Autor des Materials, dessen √úbersetzung wir heute ver√∂ffentlichen, ist zuversichtlich, dass diese Idee allen bekannt ist.  Auf den ersten Blick scheinen die Fehler be√§ngstigend.  Sie k√∂nnen von einer Art Verlust begleitet sein.  Ein Fehler in der √ñffentlichkeit schadet der Autorit√§t desjenigen, der ihn begangen hat.  Aber wenn wir Fehler machen, lernen wir daraus. Wenn wir das n√§chste Mal in eine Situation geraten, in der wir uns zuvor falsch verhalten haben, tun wir alles nach Bedarf. <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/webt/9q/dw/s5/9qdws5ejk1iibkjghqujq6m4c_4.jpeg"></a> <br><br>  Oben haben wir √ºber die Fehler gesprochen, die Menschen im Alltag machen.  Programmierfehler sind etwas anderes.  Fehlermeldungen helfen uns, den Code zu verbessern. Sie erm√∂glichen es uns, Benutzer √ºber unsere Projekte zu informieren, dass ein Fehler aufgetreten ist, und Benutzern m√∂glicherweise mitzuteilen, wie sie sich verhalten sollen, damit keine Fehler mehr auftreten. <br><a name="habracut"></a><br>  Dieses JavaScript-Material zur Fehlerbehandlung ist in drei Teile unterteilt.  Zun√§chst geben wir einen allgemeinen √úberblick √ºber das Fehlerbehandlungssystem in JavaScript und sprechen √ºber Fehlerobjekte.  Danach suchen wir nach der Antwort auf die Frage, was mit Fehlern im Servercode zu tun ist (insbesondere bei Verwendung des Bundles Node.js + Express.js).  Als n√§chstes diskutieren wir die Fehlerbehandlung in React.js.  Die Frameworks, die hier betrachtet werden, werden aufgrund ihrer enormen Beliebtheit ausgew√§hlt.  Die hier beschriebenen Prinzipien f√ºr die Arbeit mit Fehlern sind jedoch universell. Selbst wenn Sie Express und React nicht verwenden, k√∂nnen Sie das Gelernte problemlos auf die Tools anwenden, mit denen Sie arbeiten. <br><br>  Der Code f√ºr das in diesem Material verwendete Demo-Projekt befindet sich in <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">diesem</a> Repository. <br><br><h2>  <font color="#3AC1EF">1. Fehler in JavaScript und universelle M√∂glichkeiten, mit ihnen zu arbeiten</font> </h2><br>  Wenn in Ihrem Code ein Fehler aufgetreten ist, k√∂nnen Sie die folgende Konstruktion verwenden. <br><br><pre><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Error</span></span>(<span class="hljs-string"><span class="hljs-string">'something went wrong'</span></span>)</code> </pre> <br>  W√§hrend der Ausf√ºhrung dieses Befehls wird eine Instanz des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Fehlerobjekts</a> erstellt und eine Ausnahme mit diesem Objekt generiert (oder, wie sie sagen, "ausgel√∂st").  Die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">throw-</a> Anweisung kann Ausnahmen ausl√∂sen, die beliebige Ausdr√ºcke enthalten.  In diesem Fall wird die Ausf√ºhrung des Skripts gestoppt, wenn keine Ma√ünahmen zur Behebung des Fehlers ergriffen wurden. <br><br>  Anf√§nger-JS-Programmierer verwenden normalerweise nicht die <code>throw</code> Anweisung.  Sie sto√üen normalerweise auf Ausnahmen, die entweder von der Sprachlaufzeit oder von Bibliotheken von Drittanbietern ausgel√∂st werden.  In diesem Fall gelangt so etwas wie ein <code>ReferenceError: fs is not defined</code> in die Konsole <code>ReferenceError: fs is not defined</code> und die Programmausf√ºhrung wird gestoppt. <br><br><h3>  <font color="#3AC1EF">‚ñçObjektfehler</font> </h3><br>  Instanzen des <code>Error</code> haben mehrere Eigenschaften, die wir verwenden k√∂nnen.  Die erste Eigenschaft, die uns interessiert, ist <code>message</code> .  Hier wird die Zeile abgerufen, die als Argument an den Fehlerkonstruktor √ºbergeben werden kann.  Im Folgenden wird beispielsweise gezeigt, wie Sie das Fehlerobjekt instanziieren und die vom Konstruktor √ºbergebene Zeichenfolge durch Zugriff auf seine <code>message</code> an die Konsole ausgeben. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> myError = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Error</span></span>(<span class="hljs-string"><span class="hljs-string">'please improve your code'</span></span>) <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(myError.message) <span class="hljs-comment"><span class="hljs-comment">// please improve your code</span></span></code> </pre> <br>  Die zweite sehr wichtige Eigenschaft des Objekts ist die Verfolgung des Fehlerstapels.  Dies ist eine <code>stack</code> .  Wenn Sie sich dem zuwenden, k√∂nnen Sie den Aufrufstapel (Fehlerverlauf) anzeigen, der die Abfolge der Vorg√§nge anzeigt, die zu einer Fehlfunktion des Programms gef√ºhrt haben.  Dies erm√∂glicht uns insbesondere zu verstehen, welche Datei den fehlerhaften Code enth√§lt, und zu sehen, welche Folge von Funktionsaufrufen zu dem Fehler gef√ºhrt hat.  Hier ist ein Beispiel daf√ºr, was Sie sehen k√∂nnen, wenn Sie auf die <code>stack</code> Eigenschaft zugreifen. <br><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">Error</span></span>: please improve your code at <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.&lt;anonymous&gt; (<span class="hljs-regexp"><span class="hljs-regexp">/Users/gi</span></span>sderdube/Documents/_projects/hacking.nosync/error-handling/src/general.js:<span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-number"><span class="hljs-number">79</span></span>) at Module._compile (internal/modules/cjs/loader.js:<span class="hljs-number"><span class="hljs-number">689</span></span>:<span class="hljs-number"><span class="hljs-number">30</span></span>) at <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.Module._extensions..js (internal/modules/cjs/loader.js:<span class="hljs-number"><span class="hljs-number">700</span></span>:<span class="hljs-number"><span class="hljs-number">10</span></span>) at Module.load (internal/modules/cjs/loader.js:<span class="hljs-number"><span class="hljs-number">599</span></span>:<span class="hljs-number"><span class="hljs-number">32</span></span>) at tryModuleLoad (internal/modules/cjs/loader.js:<span class="hljs-number"><span class="hljs-number">538</span></span>:<span class="hljs-number"><span class="hljs-number">12</span></span>) at <span class="hljs-built_in"><span class="hljs-built_in">Function</span></span>.Module._load (internal/modules/cjs/loader.js:<span class="hljs-number"><span class="hljs-number">530</span></span>:<span class="hljs-number"><span class="hljs-number">3</span></span>) at <span class="hljs-built_in"><span class="hljs-built_in">Function</span></span>.Module.runMain (internal/modules/cjs/loader.js:<span class="hljs-number"><span class="hljs-number">742</span></span>:<span class="hljs-number"><span class="hljs-number">12</span></span>) at startup (internal/bootstrap/node.js:<span class="hljs-number"><span class="hljs-number">266</span></span>:<span class="hljs-number"><span class="hljs-number">19</span></span>) at bootstrapNodeJSCore (internal/bootstrap/node.js:<span class="hljs-number"><span class="hljs-number">596</span></span>:<span class="hljs-number"><span class="hljs-number">3</span></span>)</code> </pre> <br>  Hier oben wird eine Fehlermeldung angezeigt, gefolgt von einer Angabe des Codeabschnitts, dessen Ausf√ºhrung den Fehler verursacht hat. Anschlie√üend wird der Ort beschrieben, von dem aus dieser fehlerhafte Abschnitt aufgerufen wurde.  Dies setzt sich in Bezug auf das Fehlercodefragment bis zum ‚Äûweitesten‚Äú fort. <br><br><h3>  <font color="#3AC1EF">‚ñç Generierung und Fehlerbehandlung</font> </h3><br>  Das Erstellen einer Instanz des <code>Error</code> , dh das Ausf√ºhren eines Befehls des Formulars <code>new Error()</code> , f√ºhrt zu keinen besonderen Konsequenzen.  Interessante Dinge beginnen nach dem Anwenden des <code>throw</code> zu passieren, was einen Fehler erzeugt.  Wie bereits erw√§hnt, wird die Skriptausf√ºhrung gestoppt, wenn ein solcher Fehler nicht verarbeitet wird.  In diesem Fall spielt es keine Rolle, ob der <code>throw</code> Operator vom Programmierer selbst verwendet wurde, ob ein Fehler in einer bestimmten Bibliothek oder in der Sprachlaufzeit (in einem Browser oder in Node.js) aufgetreten ist.  Lassen Sie uns √ºber verschiedene Fehlerbehandlungsszenarien sprechen. <br><br><h3>  <font color="#3AC1EF">Konstruktionsversuch ... fangen</font> </h3><br>  Der <code>try...catch</code> ist der einfachste Weg, um h√§ufig vergessene Fehler zu behandeln.  Heutzutage wird es jedoch viel intensiver als zuvor verwendet, da es zur Behandlung von Fehlern in <code>async/await</code> Konstrukten verwendet werden kann. <br><br>  Dieser Block kann verwendet werden, um Fehler zu behandeln, die im synchronen Code auftreten.  Betrachten Sie ein Beispiel. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> a = <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> {   <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(b) <span class="hljs-comment"><span class="hljs-comment">//  b   -   } catch (err) {   console.error(err) //          } console.log(a) //    ,   </span></span></code> </pre> <br>  Wenn wir in diesem Beispiel den fehlgeschlagenen <code>console.log(b)</code> in einen <code>try...catch</code> einschlie√üen w√ºrden, w√ºrde das Skript gestoppt. <br><br><h3>  <font color="#3AC1EF">‚ñç endlich blockieren</font> </h3><br>  Manchmal muss Code ausgef√ºhrt werden, unabh√§ngig davon, ob ein Fehler aufgetreten ist oder nicht.  Dazu k√∂nnen Sie den dritten optionalen Block <code>finally</code> im Konstrukt <code>try...catch</code> verwenden.  Oft entspricht seine Verwendung einem Code, der unmittelbar nach dem <code>try...catch</code> , aber in einigen Situationen kann er n√ºtzlich sein.  Hier ist ein Beispiel f√ºr seine Verwendung. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> a = <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> {   <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(b) <span class="hljs-comment"><span class="hljs-comment">//  b   -   } catch (err) {   console.error(err) //          } finally {   console.log(a) //        }</span></span></code> </pre> <br><h3>  <font color="#3AC1EF">‚ñçAsynchrone Mechanismen - R√ºckrufe</font> </h3><br>  Bei der Programmierung in JavaScript sollten Sie immer auf asynchron ausgef√ºhrte Codeabschnitte achten.  Wenn Sie eine asynchrone Funktion haben und ein Fehler darin auftritt, wird das Skript weiterhin ausgef√ºhrt.  Wenn asynchrone Mechanismen in JS mithilfe von R√ºckrufen implementiert werden (dies wird √ºbrigens nicht empfohlen), erh√§lt der entsprechende R√ºckruf (R√ºckruffunktion) normalerweise zwei Parameter.  Dies ist so etwas wie der Parameter <code>err</code> , der einen Fehler und ein <code>result</code> - mit den Ergebnissen einer asynchronen Operation.  Es sieht ungef√§hr so ‚Äã‚Äãaus: <br><br><pre> <code class="javascript hljs">myAsyncFunc(someInput, (err, result) =&gt; {   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(err) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.error(err) <span class="hljs-comment"><span class="hljs-comment">//           console.log(result) })</span></span></code> </pre> <br>  Wenn im R√ºckruf ein Fehler auftritt, wird dieser dort als <code>err</code> angezeigt.  Andernfalls erh√§lt dieser Parameter den Wert <code>undefined</code> oder <code>null</code> .  Wenn sich herausstellt, dass <code>err</code> etwas hat, ist es wichtig, darauf zu reagieren, entweder weil in unserem Beispiel der Befehl <code>return</code> wird oder <code>if...else</code> der Befehl <code>if...else</code> und Befehle im <code>else</code> Block platziert werden, um mit dem Ergebnis der asynchronen Operation zu arbeiten.  Der Punkt ist, im Falle eines Fehlers die M√∂glichkeit auszuschlie√üen, mit dem Ergebnis, dem <code>result</code> , zu arbeiten, der in diesem Fall <code>undefined</code> .  Das Arbeiten mit diesem Wert kann selbst einen Fehler verursachen, wenn beispielsweise angenommen wird, dass er ein Objekt enth√§lt.  <code>result.data</code> , dies geschieht, wenn Sie versuchen, das Konstrukt <code>result.data</code> oder √§hnliches zu verwenden. <br><br><h3>  <font color="#3AC1EF">‚ñçAsynchrone Mechanismen - Versprechen</font> </h3><br>  Um asynchrone Operationen in JavaScript auszuf√ºhren, ist es besser, Versprechen als R√ºckrufe zu verwenden.  Neben der verbesserten Lesbarkeit des Codes gibt es hier erweiterte Fehlerbehandlungsmechanismen.  Sie m√ºssen sich n√§mlich nicht mit dem Fehlerobjekt besch√§ftigen, das bei der Verwendung von Versprechungen in die R√ºckruffunktion fallen kann.  Zu diesem Zweck ist hier ein spezieller <code>catch</code> vorgesehen.  Es f√§ngt alle Fehler ab, die in den Versprechungen vor ihm aufgetreten sind, oder alle Fehler, die im Code nach dem vorherigen <code>catch</code> aufgetreten sind.  Beachten Sie, dass wenn ein Fehler in dem Versprechen auftritt, das keinen zu verarbeitenden <code>catch</code> Block enth√§lt, die Ausf√ºhrung des Skripts nicht gestoppt wird, die Fehlermeldung jedoch nicht besonders lesbar ist. <br><br><pre> <code class="javascript hljs">(node:<span class="hljs-number"><span class="hljs-number">7741</span></span>) UnhandledPromiseRejectionWarning: Unhandled promise rejection (rejection id: <span class="hljs-number"><span class="hljs-number">1</span></span>): <span class="hljs-built_in"><span class="hljs-built_in">Error</span></span>: something went wrong (node:<span class="hljs-number"><span class="hljs-number">7741</span></span>) DeprecationWarning: Unhandled promise rejections are deprecated. In the future, promise rejections that are not handled will terminate the Node.js process <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> a non-zero exit code. *<span class="hljs-regexp"><span class="hljs-regexp">/</span></span></code> </pre> <br>  Daher k√∂nnen Sie bei der Arbeit mit Versprechungen immer empfehlen, den Fangblock zu verwenden.  Schauen Sie sich ein Beispiel an. <br><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>.resolve(<span class="hljs-number"><span class="hljs-number">1</span></span>)   .then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">res</span></span></span><span class="hljs-function"> =&gt;</span></span> {       <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(res) <span class="hljs-comment"><span class="hljs-comment">// 1       throw new Error('something went wrong')       return Promise.resolve(2)   })   .then(res =&gt; {       console.log(res) //        })   .catch(err =&gt; {       console.error(err) //  ,     ,         return Promise.resolve(3)   })   .then(res =&gt; {       console.log(res) // 3   })   .catch(err =&gt; {       //      ,      -        console.error(err)   })</span></span></code> </pre> <br><h3>  <font color="#3AC1EF">‚ñçAsynchrone Mechanismen und versuchen Sie ... zu fangen</font> </h3><br>  Nachdem das Konstrukt <code>async/await</code> in JavaScript <code>async/await</code> , kehrten wir zur klassischen Methode der Fehlerbehandlung zur√ºck - um zu <code>try...catch...finally</code> .  Die Behandlung von Fehlern mit diesem Ansatz ist sehr einfach und bequem.  Betrachten Sie ein Beispiel. <br><br><pre> <code class="javascript hljs">;(<span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{   <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> {       <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> someFuncThatThrowsAnError()   } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (err) {       <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.error(err) <span class="hljs-comment"><span class="hljs-comment">//       }   console.log('Easy!') //   })()</span></span></code> </pre> <br>  Bei diesem Ansatz werden Fehler im asynchronen Code genauso behandelt wie im synchronen.  Infolgedessen k√∂nnen Sie jetzt bei Bedarf in einem einzelnen Fangblock einen gr√∂√üeren Bereich von Fehlern behandeln. <br><br><h2>  <font color="#3AC1EF">2. Generieren und Verarbeiten von Fehlern im Servercode</font> </h2><br>  Nachdem wir nun die Werkzeuge zum Arbeiten mit Fehlern haben, schauen wir uns an, was wir in realen Situationen damit machen k√∂nnen.  Das Generieren und korrekte Behandeln von Fehlern ist ein kritischer Aspekt der serverseitigen Programmierung.  Es gibt verschiedene Ans√§tze, um mit Fehlern zu arbeiten.  Hier zeigen wir einen Ansatz mit unserem eigenen Konstruktor f√ºr Instanzen des <code>Error</code> und Fehlercodes, die bequem an das Front-End oder an einen beliebigen Mechanismus mithilfe von Server-APIs √ºbergeben werden.  Wie das Backend eines bestimmten Projekts strukturiert ist, spielt keine Rolle, da Sie bei jedem Ansatz dieselben Ideen f√ºr die Arbeit mit Fehlern verwenden k√∂nnen. <br><br>  Als Server-Framework f√ºr das Routing verwenden wir Express.js.  √úberlegen wir uns, welche Struktur wir ben√∂tigen, um ein effektives Fehlerbehandlungssystem zu organisieren.  Also hier ist was wir brauchen: <br><br><ol><li>  Die universelle Fehlerbehandlung ist ein grundlegender Mechanismus, der zur Behandlung von Fehlern geeignet ist. W√§hrend dieser Zeit wird eine Meldung wie " <code>Something went wrong, please try again or contact us</code> Der Benutzer wird aufgefordert, den fehlgeschlagenen Vorgang erneut auszuf√ºhren oder den Serverbesitzer zu kontaktieren."  Dieses System ist nicht besonders intelligent, kann aber zumindest den Benutzer dar√ºber informieren, dass ein Fehler aufgetreten ist.  Eine solche Nachricht ist viel besser als "endloser Download" oder √§hnliches. </li><li>  Verarbeiten spezifischer Fehler - Ein Mechanismus, mit dem Sie den Benutzer detailliert √ºber die Ursachen f√ºr falsches Systemverhalten informieren und ihm spezifische Ratschl√§ge zur Behebung des Problems geben k√∂nnen.  Dies kann beispielsweise auf das Fehlen einiger wichtiger Daten in der Anforderung zur√ºckzuf√ºhren sein, die der Benutzer an den Server sendet, oder darauf, dass die Datenbank bereits einen bestimmten Datensatz enth√§lt, den er erneut hinzuf√ºgen m√∂chte, und so weiter. </li></ol><br><h3>  <font color="#3AC1EF">‚ñç Entwicklung eines eigenen Konstruktors f√ºr Fehlerobjekte</font> </h3><br>  Hier verwenden wir die Standardfehlerklasse und erweitern sie.  Die Verwendung von Vererbungsmechanismen in JavaScript ist riskant, aber in diesem Fall sind diese Mechanismen sehr n√ºtzlich.  Warum brauchen wir Vererbung?  Tatsache ist, dass wir zum bequemen Debuggen des Codes Informationen √ºber die Ablaufverfolgung des Fehlerstapels ben√∂tigen.  Durch die Erweiterung der Standardfehlerklasse k√∂nnen wir den Stapel ohne zus√§tzlichen Aufwand verfolgen.  Wir f√ºgen unserem eigenen Fehlerobjekt zwei Eigenschaften hinzu.  Die erste ist die <code>code</code> Eigenschaft, auf die √ºber eine Struktur des Formulars <code>err.code</code> .  Die zweite ist die <code>status</code> .  Es wird der HTTP-Statuscode aufgezeichnet, der an den Client-Teil der Anwendung √ºbertragen werden soll. <br><br>  So sieht die <code>CustomError</code> Klasse aus, deren Code als Modul konzipiert ist. <br><br><pre> <code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CustomError</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Error</span></span></span><span class="hljs-class"> </span></span>{   <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(code = 'GENERIC', status = 500, ...params) {       <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(...params)       <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">Error</span></span>.captureStackTrace) {           <span class="hljs-built_in"><span class="hljs-built_in">Error</span></span>.captureStackTrace(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, CustomError)       }       <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.code = code       <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.status = status   } } <span class="hljs-built_in"><span class="hljs-built_in">module</span></span>.exports = CustomError</code> </pre> <br><h3>  <font color="#3AC1EF">‚ñç Routing</font> </h3><br>  Nachdem unser Fehlerobjekt einsatzbereit ist, m√ºssen wir die Routenstruktur konfigurieren.  Wie oben erw√§hnt, m√ºssen wir einen einheitlichen Ansatz f√ºr die Fehlerbehandlung implementieren, der es uns erm√∂glicht, Fehler f√ºr alle Routen gleicherma√üen zu behandeln.  Standardm√§√üig unterst√ºtzt das Express.js-Framework ein solches Schema nicht vollst√§ndig.  Tatsache ist, dass alle seine Routen gekapselt sind. <br><br>  Um dieses Problem zu l√∂sen, k√∂nnen wir unseren eigenen Routenhandler implementieren und die Routenlogik in Form gew√∂hnlicher Funktionen definieren.  Dank dieses Ansatzes f√§llt die Routenfunktion (oder eine andere Funktion), wenn sie einen Fehler ausl√∂st, in den Routenhandler, der ihn dann an den Client-Teil der Anwendung √ºbergeben kann.  Wenn auf dem Server ein Fehler auftritt, planen wir, ihn im folgenden Format an das Front-End zu √ºbertragen, vorausgesetzt, die JSON-API wird daf√ºr verwendet: <br><br><pre> <code class="javascript hljs">{   <span class="hljs-attr"><span class="hljs-attr">error</span></span>: <span class="hljs-string"><span class="hljs-string">'SOME_ERROR_CODE'</span></span>,   <span class="hljs-attr"><span class="hljs-attr">description</span></span>: <span class="hljs-string"><span class="hljs-string">'Something bad happened. Please try again or contact support.'</span></span> }</code> </pre> <br>  Wenn Ihnen zu diesem Zeitpunkt das, was passiert, unverst√§ndlich erscheint - keine Sorge - lesen Sie einfach weiter, versuchen Sie, mit dem zu arbeiten, was gerade besprochen wird, und Sie werden es nach und nach herausfinden.  Wenn wir √ºber Computertraining sprechen, wird hier der ‚ÄûTop-Down‚Äú -Ansatz verwendet, wenn zuerst allgemeine Ideen diskutiert und dann der √úbergang zu Einzelheiten durchgef√ºhrt wird. <br><br>  So sieht der Route-Handler-Code aus. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> express = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'express'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> router = express.Router() <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> CustomError = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'../CustomError'</span></span>) router.use(<span class="hljs-keyword"><span class="hljs-keyword">async</span></span> (req, res) =&gt; {   <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> {       <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> route = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">`.</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${req.path}</span></span></span><span class="hljs-string">`</span></span>)[req.method]       <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> {           <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> result = route(req) <span class="hljs-comment"><span class="hljs-comment">//    route           res.send(result) //   ,     route       } catch (err) {           /*                ,    route             */           if (err instanceof CustomError) {               /*                   -                                  */               return res.status(err.status).send({                   error: err.code,                   description: err.message,               })           } else {               console.error(err) //                  //   -                   return res.status(500).send({                   error: 'GENERIC',                   description: 'Something went wrong. Please try again or contact support.',               })           }       }   } catch (err) {       /*          ,    ,  ,            ,  ,          ,                       */       res.status(404).send({           error: 'NOT_FOUND',           description: 'The resource you tried to access does not exist.',       })   } }) module.exports = router</span></span></code> </pre> <br>  Wir glauben, dass die Kommentare im Code dies recht gut erkl√§ren.  Wir hoffen, dass das Lesen bequemer ist als die nachfolgenden Erkl√§rungen zu diesem Code. <br><br>  Schauen Sie sich nun die Routendatei an. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> CustomError = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'../CustomError'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> GET = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">req</span></span></span><span class="hljs-function"> =&gt;</span></span> {   <span class="hljs-comment"><span class="hljs-comment">//       return { name: 'Rio de Janeiro' } } const POST = req =&gt; {   //       throw new Error('Some unexpected error, may also be thrown by a library or the runtime.') } const DELETE = req =&gt; {   //  ,      throw new CustomError('CITY_NOT_FOUND', 404, 'The city you are trying to delete could not be found.') } const PATCH = req =&gt; {   //      CustomError   try {       //   -        throw new Error('Some internal error')   } catch (err) {       console.error(err) //    ,           throw new CustomError(           'CITY_NOT_EDITABLE',           400,           'The city you are trying to edit is not editable.'       )   } } module.exports = {   GET,   POST,   DELETE,   PATCH, }</span></span></code> </pre> <br>  In diesen Beispielen wird nichts mit den Abfragen selbst gemacht.  Es werden lediglich verschiedene Szenarien f√ºr das Auftreten von Fehlern ber√ºcksichtigt.  So f√§llt beispielsweise die <code>GET /city</code> Anforderung in die <code>const GET = req =&gt;...</code> Funktion <code>const GET = req =&gt;...</code> , die <code>POST /city</code> Anforderung in die <code>const POST = req =&gt;...</code> Funktion <code>const POST = req =&gt;...</code> und so weiter.  Dieses Schema funktioniert auch bei Verwendung von Abfrageparametern.  Zum Beispiel f√ºr eine Anfrage des Formulars <code>GET /city?startsWith=R</code>  Im Allgemeinen wurde hier gezeigt, dass das Frontend bei der Verarbeitung von Fehlern entweder einen allgemeinen Fehler erhalten kann, der nur ein Angebot zum erneuten Versuch enth√§lt, oder den Serverbesitzer zu kontaktieren, oder einen Fehler, der mit dem <code>CustomError</code> Konstruktor generiert wurde und detaillierte Informationen zum Problem enth√§lt. <br>  Allgemeine Fehlerdaten werden in folgender Form an den Client-Teil der Anwendung gesendet: <br><br><pre> <code class="javascript hljs">{   <span class="hljs-attr"><span class="hljs-attr">error</span></span>: <span class="hljs-string"><span class="hljs-string">'GENERIC'</span></span>,   <span class="hljs-attr"><span class="hljs-attr">description</span></span>: <span class="hljs-string"><span class="hljs-string">'Something went wrong. Please try again or contact support.'</span></span> }</code> </pre> <br>  Der <code>CustomError</code> Konstruktor wird folgenderma√üen verwendet: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CustomError(<span class="hljs-string"><span class="hljs-string">'MY_CODE'</span></span>, <span class="hljs-number"><span class="hljs-number">400</span></span>, <span class="hljs-string"><span class="hljs-string">'Error description'</span></span>)</code> </pre> <br>  Dies gibt den folgenden JSON-Code, der an das Frontend √ºbergeben wird: <br><br><pre> <code class="javascript hljs">{   <span class="hljs-attr"><span class="hljs-attr">error</span></span>: <span class="hljs-string"><span class="hljs-string">'MY_CODE'</span></span>,   <span class="hljs-attr"><span class="hljs-attr">description</span></span>: <span class="hljs-string"><span class="hljs-string">'Error description'</span></span> }</code> </pre> <br>  Nachdem wir den Serverteil der Anwendung gr√ºndlich bearbeitet haben, fallen nutzlose Fehlerprotokolle nicht mehr in den Clientteil.  Stattdessen erh√§lt der Client n√ºtzliche Informationen dar√ºber, was schief gelaufen ist. <br><br>  Vergessen Sie nicht, dass <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> das Repository mit dem hier betrachteten Code liegt.  Sie k√∂nnen es herunterladen, damit experimentieren und bei Bedarf an die Anforderungen Ihres Projekts anpassen. <br><br><h2>  <font color="#3AC1EF">3. Arbeiten Sie mit Fehlern auf dem Client</font> </h2><br>  Jetzt ist es Zeit, den dritten Teil unseres Front-End-Fehlerbehandlungssystems zu beschreiben.  Hier m√ºssen zum einen Fehler behandelt werden, die im Client-Teil der Anwendung auftreten, und zum anderen muss der Benutzer √ºber Fehler informiert werden, die auf dem Server auftreten.  Wir werden uns zun√§chst mit der Anzeige von Serverfehlerinformationen befassen.  Wie bereits erw√§hnt, wird in diesem Beispiel die React-Bibliothek verwendet. <br><br><h3>  <font color="#3AC1EF">‚ñçSpeichern Sie Fehlerinformationen im Anwendungsstatus</font> </h3><br>  Wie bei allen anderen Daten k√∂nnen sich Fehler und Fehlermeldungen √§ndern. Daher ist es sinnvoll, sie in den Status von Komponenten zu versetzen.  Wenn die Komponente bereitgestellt wird, werden die Fehlerdaten zur√ºckgesetzt. Wenn der Benutzer die Seite zum ersten Mal sieht, werden keine Fehlermeldungen angezeigt. <br><br>  Als n√§chstes m√ºssen Fehler desselben Typs im selben Stil angezeigt werden.  In Analogie zum Server k√∂nnen Sie hier 3 Arten von Fehlern unterscheiden. <br><br><ol><li>  Globale Fehler - Diese Kategorie umfasst allgemeine Fehlermeldungen, die vom Server stammen, oder Fehler, die beispielsweise auftreten, wenn der Benutzer in anderen √§hnlichen Situationen nicht am System angemeldet ist. </li><li>  Spezifische Fehler, die von der Serverseite der Anwendung generiert werden - dies schlie√üt Fehler ein, die vom Server gemeldet werden.  Ein √§hnlicher Fehler tritt beispielsweise auf, wenn ein Benutzer versucht hat, sich anzumelden und einen Benutzernamen und ein Kennwort an den Server gesendet hat, und der Server ihn dar√ºber informiert hat, dass das Kennwort falsch ist.  Solche Dinge werden im Client-Teil der Anwendung nicht √ºberpr√ºft, daher sollten Nachrichten √ºber solche Fehler vom Server kommen. </li><li>  Spezifische Fehler, die vom Client-Teil der Anwendung generiert werden.  Ein Beispiel f√ºr einen solchen Fehler ist eine Nachricht √ºber eine ung√ºltige E-Mail-Adresse, die in das entsprechende Feld eingegeben wurde. </li></ol><br>  Fehler des zweiten und dritten Typs sind sehr √§hnlich. Sie k√∂nnen mit ihnen √ºber den Statusspeicher von Komponenten derselben Ebene arbeiten.  Ihr Hauptunterschied besteht darin, dass sie aus verschiedenen Quellen stammen.  Im Folgenden wird der Code analysiert und die Arbeit mit ihnen betrachtet. <br><br>  Es verwendet das integrierte System zum Verwalten des Status der Anwendung in React. Bei Bedarf k√∂nnen Sie jedoch spezielle L√∂sungen zum Verwalten des Status verwenden, z. B. MobX oder Redux. <br><br><h3>  <font color="#3AC1EF">‚ñç Globale Fehler</font> </h3><br>  In der Regel werden solche Fehlermeldungen in der Komponente der h√∂chsten Ebene mit einem Status gespeichert.  Sie werden in einem statischen Benutzeroberfl√§chenelement angezeigt.  Dies kann ein rotes K√§stchen am oberen Bildschirmrand, ein modales Fenster oder etwas anderes sein.  Die Umsetzung h√§ngt vom jeweiligen Projekt ab.  So sieht die Fehlermeldung aus. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1fb/5d9/c43/1fb5d9c436f66a99bd3b14d07f543740.jpg"></div><br>  <i><font color="#999999">Globale Fehlermeldung</font></i> <br><br>  Schauen Sie sich nun den Code an, der in der Datei <code>Application.js</code> gespeichert ist. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React, { Component } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> GlobalError <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./GlobalError'</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Application</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Component</span></span></span><span class="hljs-class"> </span></span>{   <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(props) {       <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(props)       <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.state = {           <span class="hljs-attr"><span class="hljs-attr">error</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span>,       }       <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._resetError = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._resetError.bind(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>)       <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._setError = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._setError.bind(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>)   }   render() {       <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (           <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">className</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"container"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">               </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">GlobalError</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">error</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{this.state.error}</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">resetError</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{this._resetError}</span></span></span></span><span class="xml"><span class="hljs-tag"> /&gt;</span></span></span><span class="xml">               </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">Handling Errors</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">           </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">       )   }   _resetError() {       this.setState({ error: '' })   }   _setError(newError) {       this.setState({ error: newError })   } } export default Application</span></span></code> </pre> <br>  ,  ,  <code>Application.js</code> ,      .  ,           . <br><br>         <code>GlobalError</code> ,                  <code>x</code>  ,   .    <code>GlobalError</code> ( <code>GlobalError.js</code> ). <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React, { Component } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">GlobalError</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Component</span></span></span><span class="hljs-class"> </span></span>{   render() {       <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.props.error) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>       <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (           <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">               </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">style</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{{</span></span></span></span><span class="xml"><span class="hljs-tag">                   </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">position:</span></span></span></span><span class="xml"><span class="hljs-tag"> '</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">fixed</span></span></span></span><span class="xml"><span class="hljs-tag">',                   </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">top:</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">0</span></span></span></span><span class="xml"><span class="hljs-tag">,                   </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">left:</span></span></span></span><span class="xml"><span class="hljs-tag"> '</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">50</span></span></span></span><span class="xml"><span class="hljs-tag">%',                   </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">transform:</span></span></span></span><span class="xml"><span class="hljs-tag"> '</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">translateX</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">-50</span></span></span></span><span class="xml"><span class="hljs-tag">%)',                   </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">padding:</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">10</span></span></span></span><span class="xml"><span class="hljs-tag">,                   </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">backgroundColor:</span></span></span></span><span class="xml"><span class="hljs-tag"> '#</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">ffcccc</span></span></span></span><span class="xml"><span class="hljs-tag">',                   </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">boxShadow:</span></span></span></span><span class="xml"><span class="hljs-tag"> '</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">0</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">3px</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">25px</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">-10px</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">rgba</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">0</span></span></span></span><span class="xml"><span class="hljs-tag">,</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">0</span></span></span></span><span class="xml"><span class="hljs-tag">,</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">0</span></span></span></span><span class="xml"><span class="hljs-tag">,</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">0.5</span></span></span></span><span class="xml"><span class="hljs-tag">)',                   </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">display:</span></span></span></span><span class="xml"><span class="hljs-tag"> '</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">flex</span></span></span></span><span class="xml"><span class="hljs-tag">',                   </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">alignItems:</span></span></span></span><span class="xml"><span class="hljs-tag"> '</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">center</span></span></span></span><span class="xml"><span class="hljs-tag">',               }}           &gt;</span></span></span><span class="xml">               {this.props.error}                              </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">i</span></span></span></span><span class="xml"><span class="hljs-tag">                   </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">className</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"material-icons"</span></span></span></span><span class="xml"><span class="hljs-tag">                   </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">style</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{{</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">cursor:</span></span></span></span><span class="xml"><span class="hljs-tag"> '</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">pointer</span></span></span></span><span class="xml"><span class="hljs-tag">' }}                   </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">onClick</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{this.props.resetError}</span></span></span></span><span class="xml"><span class="hljs-tag">               &gt;</span></span></span><span class="xml">                   close               </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">font</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">i</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span>           &lt;<span class="hljs-regexp"><span class="hljs-regexp">/div&gt;       )   } } export default GlobalError</span></span></code> </pre> <br>     <code>if (!this.props.error) return null</code> .    ,        .        . , ,  ,        . ,  ,       <code>x</code> ,   -   ,       . <br><br> ,        ,       <code>_setError</code>  <code>Application.js</code> . ,      ,  ,    ,      ( <code>error: 'GENERIC'</code> ).   ( <code>GenericErrorReq.js</code> ). <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React, { Component } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> axios <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'axios'</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">GenericErrorReq</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Component</span></span></span><span class="hljs-class"> </span></span>{   <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(props) {       <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(props)       <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._callBackend = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._callBackend.bind(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>)   }   render() {       <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (           <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">               </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">onClick</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{this._callBackend}</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">Click me to call the backend</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">           </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span>       )   }   _callBackend() {       axios           .post(<span class="hljs-string"><span class="hljs-string">'/api/city'</span></span>)           .then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">result</span></span></span><span class="hljs-function"> =&gt;</span></span> {               <span class="hljs-comment"><span class="hljs-comment">//  -     ,               })           .catch(err =&gt; {               if (err.response.data.error === 'GENERIC') {                   this.props.setError(err.response.data.description)               }           })   } } export default GenericErrorReq</span></span></code> </pre> <br>   ,            .          ,       ,        .          . -,         ,  -,    UX-,        ,    ‚Äî . <br><br><h3> <font color="#3AC1EF">‚ñç  ,    </font> </h3><br>      ,    ,        ,   . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/dee/2f6/bd1/dee2f6bd1605d89c082a46f6feaa86b6.jpg"></div><br> <i><font color="#999999">   </font></i> <br><br>     ,        .           .          .    <code>SpecificErrorReq.js</code> . <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React, { Component } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> axios <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'axios'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> InlineError <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./InlineError'</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SpecificErrorRequest</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Component</span></span></span><span class="hljs-class"> </span></span>{   <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(props) {       <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(props)       <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.state = {           <span class="hljs-attr"><span class="hljs-attr">error</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span>,       }       <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._callBackend = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._callBackend.bind(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>)   }   render() {       <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (           <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">               </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">onClick</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{this._callBackend}</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">Delete your city</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">               </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">InlineError</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">error</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{this.state.error}</span></span></span></span><span class="xml"><span class="hljs-tag"> /&gt;</span></span></span><span class="xml">           </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">       )   }   _callBackend() {       this.setState({           error: '',       })       axios           .delete('/api/city')           .then(result =&gt; {               //  -     ,               })           .catch(err =&gt; {               if (err.response.data.error === 'GENERIC') {                   this.props.setError(err.response.data.description)               } else {                   this.setState({                       error: err.response.data.description,                   })               }           })   } } export default SpecificErrorRequest</span></span></code> </pre> <br>   ,      , ,      <code>x</code> . ,         ,     .   ,     ,  ‚Äî   ,    ,  ,    .        , ,    .       ,      ,       ,   ‚Äî     . <br><br><h3> <font color="#3AC1EF">‚ñç,     </font> </h3><br>    ,            ,        ,   . ,                ,       - .            . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/532/553/2f5/5325532f59efd4ff9ad92e2a33209d9f.jpg"></div><br> <i><font color="#999999">   ,     </font></i> <br><br>    <code>SpecificErrorFrontend.js</code> ,   . <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React, { Component } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> axios <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'axios'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> InlineError <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./InlineError'</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SpecificErrorRequest</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Component</span></span></span><span class="hljs-class"> </span></span>{   <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(props) {       <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(props)       <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.state = {           <span class="hljs-attr"><span class="hljs-attr">error</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span>,           <span class="hljs-attr"><span class="hljs-attr">city</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span>,       }       <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._callBackend = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._callBackend.bind(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>)       <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._changeCity = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._changeCity.bind(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>)   }   render() {       <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (           &lt;div&gt;               &lt;input                   type="text"                   value={this.state.city}                   style={{ marginRight: 15 }}                   onChange={this._changeCity}               /&gt;               &lt;button onClick={this._callBackend}&gt;Delete your city&lt;/button&gt;               &lt;InlineError error={this.state.error} /&gt;           &lt;/div&gt;       )   }   _changeCity(e) {       this.setState({           error: '',           city: e.target.value,       })   }   _validate() {       if (!this.state.city.length) throw new Error('Please provide a city name.')   }   _callBackend() {       this.setState({           error: '',       })       try {           this._validate()       } catch (err) {           return this.setState({ error: err.message })       }       axios           .delete('/api/city')           .then(result =&gt; {               //  -     ,               })           .catch(err =&gt; {               if (err.response.data.error === 'GENERIC') {                   this.props.setError(err.response.data.description)               } else {                   this.setState({                       error: err.response.data.description,                   })               }           })   } } export default SpecificErrorRequest</code> </pre> <br><h3> <font color="#3AC1EF">‚ñç       </font> </h3><br> ,      ,      ( <code>GENERIC</code> ),        ,   .   , ,      , ,  ,    ,   ,   ,           .                 . <br><br><h2>  <font color="#3AC1EF">Zusammenfassung</font> </h2><br> ,      ,       -.   <code>console.error(err)</code>      ,    ,  ,   .      -    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">loglevel</a> . <br><br>  <b>Liebe Leser!</b>       ? <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de431078/">https://habr.com/ru/post/de431078/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de431068/index.html">Die Kunst der Bildung: die Ideologie der Spielautomaten</a></li>
<li><a href="../de431070/index.html">Hara essen? Wir sprechen √ºber die Essgewohnheiten eines modernen IT-Spezialisten</a></li>
<li><a href="../de431072/index.html">JavaScript-Handbuch Teil 7: Strenger Modus, dieses Schl√ºsselwort, Ereignisse, Module, Mathematik</a></li>
<li><a href="../de431074/index.html">JavaScript-Handbuch Teil 8: √úbersicht √ºber die ES6-Funktionen</a></li>
<li><a href="../de431076/index.html">Die beliebtesten Node.js-Frameworks von 2018</a></li>
<li><a href="../de431080/index.html">So organisieren Sie Remote-B√ºros und verlieren kein Team im Weltraum</a></li>
<li><a href="../de431082/index.html">Kotlin: auf der Suche nach Marketingleiter</a></li>
<li><a href="../de431084/index.html">In jeder unverst√§ndlichen Situation - schreiben Sie Skripte</a></li>
<li><a href="../de431086/index.html">Alles, was Sie √ºber PVS-Studio wissen wollten und ohne zu z√∂gern zu fragen</a></li>
<li><a href="../de431088/index.html">Dateiverwaltung falsch gemacht - Teil 1: Urspr√ºnglich aus den 90ern</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>