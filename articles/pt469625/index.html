<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëô üçª ü•§ Como coletamos dados em campanhas publicit√°rias de plataformas on-line (o caminho dif√≠cil para o produto) üçá ‚ôãÔ∏è üôéüèæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Parece que o campo da publicidade on-line deve ser o mais tecnol√≥gico e automatizado poss√≠vel. De fato, gigantes e especialistas em suas √°reas de atua...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Como coletamos dados em campanhas publicit√°rias de plataformas on-line (o caminho dif√≠cil para o produto)</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/dentsuaegisnetworkrussia/blog/469625/">  Parece que o campo da publicidade on-line deve ser o mais tecnol√≥gico e automatizado poss√≠vel.  De fato, gigantes e especialistas em suas √°reas de atua√ß√£o, como Yandex, Mail.Ru, Google e Facebook, trabalham l√°.  Mas, como se viu, n√£o h√° limite para a perfei√ß√£o e sempre h√° algo para automatizar. <br><br><img src="https://habrastorage.org/webt/gg/cq/j3/ggcqj3ws0e1dpcxixrkjdez28ry.png" alt="imagem"><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><i>Fonte</i></a> <br><br>  O grupo de comunica√ß√£o <b>Dentsu Aegis Network Russia</b> √© o maior player no mercado de publicidade digital e investe ativamente em tecnologia, tentando otimizar e automatizar seus processos de neg√≥cios.  Um dos problemas n√£o resolvidos do mercado de publicidade on-line era a tarefa de coletar estat√≠sticas sobre campanhas publicit√°rias de diferentes sites on-line.  A solu√ß√£o para esse problema acabou resultando na cria√ß√£o do produto <b>D1.Digital</b> (lido como DiVan), sobre o qual queremos falar sobre o desenvolvimento. <br><a name="habracut"></a><br><h3>  Porque </h3><br>  1. No momento do in√≠cio do projeto, n√£o havia um √∫nico produto acabado no mercado que resolvesse a tarefa de automatizar a coleta de estat√≠sticas em campanhas publicit√°rias.  <i>Isso significa que ningu√©m al√©m de n√≥s mesmos fechar√° nossas necessidades.</i> <br><br>  Servi√ßos como Improvado, Roistat, Supermetrics, SegmentStream, oferecem integra√ß√£o com sites, redes sociais e Google Analitycs, al√©m de oferecer a capacidade de criar pain√©is anal√≠ticos para uma an√°lise e controle convenientes das campanhas publicit√°rias.  Antes de come√ßar a desenvolver nosso produto, tentamos usar alguns desses sistemas em nosso trabalho para coletar dados de sites, mas, infelizmente, eles n√£o conseguiram resolver nossos problemas. <br><br>  O principal problema era que os produtos testados eram repelidos a partir de fontes de dados, exibindo as estat√≠sticas de veicula√ß√µes em se√ß√µes por sites e n√£o permitiam a agrega√ß√£o de estat√≠sticas em campanhas publicit√°rias.  Essa abordagem n√£o permitiu ver estat√≠sticas de sites diferentes em um s√≥ lugar e analisar o estado da campanha como um todo. <br><br>  Outro fator foi que, nos est√°gios iniciais, os produtos eram orientados para o mercado ocidental e n√£o suportavam a integra√ß√£o com sites russos.  E para os sites com os quais a integra√ß√£o foi implementada, nem sempre foram carregadas todas as m√©tricas necess√°rias com detalhes suficientes, e a integra√ß√£o nem sempre foi conveniente e transparente, especialmente quando era necess√°rio obter algo que n√£o estava na interface do sistema. <br>  Em geral, decidimos n√£o nos adaptar a produtos de terceiros, mas come√ßamos a desenvolver nossos pr√≥prios ... <br><br>  2. O mercado de publicidade on-line est√° crescendo de ano para ano e, em 2018, tradicionalmente superava o maior mercado de publicidade de TV em termos de or√ßamento de publicidade.  <i>Portanto, h√° uma escala</i> . <br><br>  3. Diferentemente do mercado de publicidade na TV, onde a venda da publicidade comercial √© monopolizada, a massa de propriet√°rios individuais de equipamentos de publicidade de v√°rios tamanhos com seus escrit√≥rios de publicidade trabalha na Internet.  Como a campanha publicit√°ria, em regra, √© executada em v√°rios sites ao mesmo tempo, para entender o estado da campanha publicit√°ria, √© necess√°rio coletar relat√≥rios de todos os sites e reuni-los em um grande relat√≥rio que mostrar√° toda a imagem.  <i>Portanto, h√° potencial para otimiza√ß√£o.</i> <br><br>  4. Pareceu-nos que os propriet√°rios de invent√°rio de publicidade na Internet j√° tinham uma infraestrutura para coletar estat√≠sticas e exibi-las em escrit√≥rios de publicidade, e eles poderiam fornecer uma API para esses dados.  <i>Portanto, existe uma viabilidade t√©cnica.</i>  Diremos imediatamente que n√£o foi t√£o simples. <br><br>  Em geral, todos os pr√©-requisitos para a implementa√ß√£o do projeto eram √≥bvios para n√≥s, e corremos para implement√°-lo ... <br><br><h3>  Grande plano </h3><br>  Primeiro, formamos a vis√£o de um sistema ideal: <br><br><ul><li>  Ele deve carregar automaticamente campanhas publicit√°rias do sistema corporativo 1C com seus nomes, per√≠odos, or√ßamentos e canais em v√°rias plataformas. </li><li>  Para cada canal dentro da campanha publicit√°ria, todas as estat√≠sticas poss√≠veis dos sites em que o canal est√° em andamento devem ser baixadas automaticamente, como o n√∫mero de impress√µes, cliques, visualiza√ß√µes etc. </li><li>  Algumas campanhas publicit√°rias s√£o monitoradas pelo monitoramento de terceiros pelos chamados sistemas de servi√ßo de an√∫ncios, como Adriver, Weborama, DCM, etc.  H√° tamb√©m um medidor de Internet industrial na R√∫ssia - Mediascope.  De acordo com nossa ideia, os dados do monitoramento independente e industrial tamb√©m devem ser automaticamente carregados nas campanhas publicit√°rias correspondentes. </li><li>  A maioria das campanhas de publicidade na Internet √© direcionada a determinadas a√ß√µes direcionadas (compra, liga√ß√£o, grava√ß√£o para um test drive, etc.), que s√£o rastreadas usando o Google Analytics e estat√≠sticas nas quais tamb√©m s√£o importantes para entender o status da campanha e devem ser carregadas em nossa ferramenta . </li></ul><br><h3>  A primeira panqueca √© irregular </h3><br>  Considerando nosso compromisso com princ√≠pios flex√≠veis de desenvolvimento de software (√°gil, tudo), decidimos primeiro desenvolver o MVP e depois avan√ßar iterativamente para o objetivo pretendido. <br>  Decidimos construir o MVP com base no nosso produto <b>DANBo (Dentsu Aegis Network Board)</b> , que √© um aplicativo da web com informa√ß√µes gerais sobre as campanhas publicit√°rias de nossos clientes. <br><br>  Para o MVP, o projeto foi simplificado ao m√°ximo em termos de implementa√ß√£o.  Selecionamos uma lista limitada de sites para integra√ß√£o.  Essas foram as principais plataformas, como Yandex.Direct, Yandex.Display, RB.Mail, MyTarget, Adwords, DBM, VK, FB e os principais sistemas de servi√ßo de an√∫ncios Adriver e Weborama. <br><br>  Para acessar as estat√≠sticas dos sites por meio da API, usamos uma √∫nica conta.  O gerente do grupo de clientes, que desejava usar a cole√ß√£o autom√°tica de estat√≠sticas na campanha publicit√°ria, primeiro delegou o acesso √†s campanhas publicit√°rias necess√°rias nos sites na conta da plataforma. <br><br>  Em seguida, o usu√°rio do sistema <b>DANBo</b> teve que enviar um arquivo de um determinado formato para o sistema Excel, no qual todas as informa√ß√µes sobre a veicula√ß√£o (campanha publicit√°ria, site, formato, per√≠odo de veicula√ß√£o, indicadores planejados, or√ßamento etc.) e os identificadores das campanhas publicit√°rias correspondentes nas plataformas e contadores em sistemas de servi√ßo de an√∫ncios. <br><br>  Parecia francamente aterrorizante: <br><br><img src="https://habrastorage.org/webt/ie/kc/sd/iekcsdiz6k8fltryf2ydfgi-f14.png" alt="imagem"><br><br>  Os dados baixados foram armazenados no banco de dados e, em seguida, servi√ßos individuais coletaram identificadores de campanha deles nos sites e baixaram estat√≠sticas sobre eles. <br><br>  Um servi√ßo do Windows separado foi gravado para cada site, que uma vez por dia passava por uma conta de servi√ßo na API do site e fazia o download de estat√≠sticas nos identificadores de campanha especificados.  O mesmo aconteceu com os sistemas de servi√ßo de an√∫ncios. <br><br>  Os dados baixados foram exibidos na interface na forma de um pequeno painel auto-escrito: <br><br><img src="https://habrastorage.org/webt/8n/xy/bl/8nxyblj7gcdigcrczqpryslhoue.png" alt="imagem"><br><br>  Inesperadamente, para n√≥s, o MVP ganhou e come√ßou a baixar as estat√≠sticas atuais de campanhas publicit√°rias na Internet.  Implementamos o sistema em v√°rios clientes, mas quando tentamos escalar, tivemos s√©rios problemas: <br><br><ul><li>  O principal problema foi a laboriosa prepara√ß√£o de dados para carregamento no sistema.  Al√©m disso, os dados do canal precisavam ser reduzidos para um formato estritamente fixo antes do download.  No arquivo para carregamento, era necess√°rio registrar os identificadores de entidades de diferentes sites.  Estamos diante do fato de que √© muito dif√≠cil para usu√°rios tecnicamente n√£o treinados explicar onde encontrar esses identificadores no site e onde coloc√°-los no arquivo.  Considerando o n√∫mero de funcion√°rios nas divis√µes que realizam campanhas nos sites e a rotatividade, isso resultou em uma enorme quantidade de apoio do nosso lado, o que categoricamente n√£o nos convinha. </li><li>  Outro problema era que nem todas as plataformas de publicidade tinham mecanismos para delegar o acesso a campanhas de publicidade em outras contas.  Mas, mesmo que o mecanismo de delega√ß√£o estivesse dispon√≠vel, nem todos os anunciantes estavam dispostos a fornecer acesso √† conta de terceiros para suas campanhas. </li><li>  Um fator importante foi a indigna√ß√£o que causou aos usu√°rios que todos os indicadores planejados e detalhes de posicionamento que eles j√° contribuem para o nosso sistema cont√°bil 1C deveriam ser reinseridos no <b>DANBo</b> . </li></ul><br>  Isso nos deu a ideia de que a principal fonte de informa√ß√µes sobre a localiza√ß√£o deveria ser o nosso sistema 1C, no qual todos os dados s√£o inseridos com precis√£o e no prazo (o ponto √© que, com base nos dados 1C, as contas s√£o formadas, portanto, a entrada correta dos dados em 1C √© para todos KPI).  Ent√£o um novo conceito de sistema apareceu ... <br><br><h3>  Conceito </h3><br>  A primeira coisa que decidimos fazer foi separar o sistema de coleta de estat√≠sticas de campanhas publicit√°rias na Internet em um produto separado - <b>D1.Digital</b> . <br><br>  No novo conceito, decidimos carregar informa√ß√µes sobre campanhas e canais de publicidade dentro deles de 1C para <b>D1.Digital</b> e, em <b>seguida</b> , <b>extra√≠mos</b> estat√≠sticas dos sites e dos sistemas AdServing para esses canais.  Isso deveria simplificar bastante a vida dos usu√°rios (e, como de costume, adicionar trabalho aos desenvolvedores) e reduzir a quantidade de suporte. <br><br>  O primeiro problema que encontramos foi de natureza organizacional e estava relacionado ao fato de n√£o conseguirmos encontrar uma chave ou atributo pelo qual pud√©ssemos comparar entidades de diferentes sistemas com campanhas e veicula√ß√µes da 1C.  O fato √© que o processo em nossa empresa √© organizado de tal maneira que as campanhas publicit√°rias s√£o inseridas em diferentes sistemas por pessoas diferentes (players de m√≠dia, compras, etc.). <br><br>  Para resolver esse problema, tivemos que inventar uma chave de hash exclusiva, DANBoID, que conectaria entidades em diferentes sistemas e que poderia ser identificada de maneira f√°cil e inequ√≠voca nos conjuntos de dados carregados.  Esse identificador √© gerado no sistema interno 1C para cada canal individual e se lan√ßa em campanhas, canais e contadores em todas as plataformas e em todos os sistemas AdServing.  A implementa√ß√£o da pr√°tica de afixar o DANBoID em todos os canais levou algum tempo, mas n√≥s o fizemos :) <br><br>  Em seguida, descobrimos que nem todos os sites t√™m uma API para coleta autom√°tica de estat√≠sticas, e mesmo aqueles que possuem uma API n√£o retornam todos os dados necess√°rios. <br><br>  Nesse est√°gio, decidimos reduzir significativamente a lista de sites para integra√ß√£o e focar nos principais sites envolvidos na grande maioria das campanhas publicit√°rias.  Esta lista inclui todos os maiores players do mercado de publicidade (Google, Yandex, Mail.ru), redes sociais (VK, Facebook, Twitter), os principais sistemas de an√°lise e servi√ßo de an√∫ncios (DCM, Adriver, Weborama, Google Analytics) e outras plataformas. <br><br>  A maior parte dos sites que selecionamos tinha uma API que nos fornecia as m√©tricas necess√°rias.  Nesses casos, quando a API n√£o estava l√°, ou n√£o possu√≠a os dados necess√°rios, para usar os dados que usamos relat√≥rios que chegavam diariamente no correio comercial (em alguns sistemas √© poss√≠vel configurar esses relat√≥rios, em outros, concordamos em desenvolver esses relat√≥rios para n√≥s). <br><br>  Ao analisar dados de sites diferentes, descobrimos que a hierarquia de entidades n√£o √© a mesma em sistemas diferentes.  Al√©m disso, informa√ß√µes de diferentes sistemas devem ser carregadas em diferentes detalhes. <br><br>  Para resolver esse problema, o conceito SubDANBoID foi desenvolvido.  A ideia de SubDANBoID √© bastante simples, marcamos a ess√™ncia principal da campanha no site com o DANBoID gerado e carregamos todas as entidades aninhadas com identificadores exclusivos do site e formamos o SubDANBoID de acordo com o princ√≠pio DANBoID + identificador da entidade aninhada do primeiro n√≠vel + identificador da entidade aninhada do segundo n√≠vel + ... Essa abordagem nos permitiu associar ... campanhas publicit√°rias em diferentes sistemas e fazer upload de estat√≠sticas detalhadas sobre elas. <br><br>  Tamb√©m tivemos que resolver o problema do acesso a campanhas em sites diferentes.  Como escrevemos acima, o mecanismo de delegar o acesso √† campanha em uma conta t√©cnica separada nem sempre √© aplic√°vel.  Portanto, tivemos que desenvolver uma infraestrutura para autoriza√ß√£o autom√°tica por meio do OAuth usando tokens e atualizar mecanismos para esses tokens. <br><br>  Ainda neste artigo, tentaremos descrever com mais detalhes a arquitetura da solu√ß√£o e os detalhes t√©cnicos da implementa√ß√£o. <br><br><h3>  Arquitetura de Solu√ß√£o 1.0 </h3><br>  Iniciando a implementa√ß√£o de um novo produto, entendemos que era imediatamente necess√°rio prever a possibilidade de conectar novos sites, por isso decidimos seguir o caminho da arquitetura de microsservi√ßo. <br><br>  Ao projetar a arquitetura, destacamos em conectores de servi√ßos separados para todos os sistemas externos - 1C, plataformas de publicidade e sistemas de servi√ßo de an√∫ncios. <br>  A id√©ia principal √© que todos os conectores dos sites tenham a mesma API e sejam adaptadores que tragam as APIs do site para a nossa interface conveniente. <br><br>  No centro de nosso produto, h√° um aplicativo da web, que √© um mon√≥lito, projetado para que possa ser facilmente desmontado em servi√ßos.  Este aplicativo √© respons√°vel pelo processamento dos dados baixados, comparando estat√≠sticas de diferentes sistemas e apresentando-os aos usu√°rios do sistema. <br><br>  Para comunicar conectores com um aplicativo da Web, tivemos que criar um servi√ßo adicional, que chamamos de Connector Proxy.  Ele executa as fun√ß√µes do Service Discovery e do Task Scheduler.  Este servi√ßo executa tarefas de coleta de dados para cada conector todas as noites.  Escrever uma camada de servi√ßo era mais f√°cil do que conectar um intermedi√°rio de mensagens e, para n√≥s, era importante obter o resultado o mais r√°pido poss√≠vel. <br><br>  Para simplificar e acelerar o desenvolvimento, tamb√©m decidimos que todos os servi√ßos seriam uma API da Web.  Isso tornou poss√≠vel montar rapidamente uma prova de conceito e verificar se todo o projeto estava funcionando. <br><br><img src="https://habrastorage.org/webt/eb/_s/ui/eb_suixgwtg5u5e35t01dzqhuqw.png" alt="imagem"><br><br>  Uma tarefa separada, bastante dif√≠cil, era configurar o acesso para coletar dados de gabinetes diferentes, que, como decidimos, deveriam ser executados pelos usu√°rios por meio de uma interface da web.  Consiste em duas etapas separadas: primeiro, o usu√°rio atrav√©s do OAuth adiciona um token para acessar a conta e, em seguida, configura a coleta de dados para o cliente a partir de uma conta espec√≠fica.  √â necess√°rio obter um token atrav√©s do OAuth, porque, como j√° escrevemos, nem sempre √© poss√≠vel delegar o acesso ao gabinete desejado no site. <br><br>  Para criar um mecanismo universal para escolher um gabinete de sites, tivemos que adicionar um m√©todo √† API de conectores que processa o JSON Schema, que √© renderizado no formul√°rio usando um componente JSONEditor modificado.  Assim, os usu√°rios puderam escolher as contas para baixar os dados. <br><br>  Para cumprir os limites de solicita√ß√£o existentes nos sites, combinamos a solicita√ß√£o de configura√ß√µes no mesmo token, mas podemos processar tokens diferentes em paralelo. <br><br>  Escolhemos o MongoDB como reposit√≥rio de dados para download, tanto para aplicativos da Web quanto para conectores, o que nos permitiu n√£o nos preocupar muito com a estrutura de dados nos est√°gios iniciais de desenvolvimento, quando o modelo de aplicativo muda ap√≥s um dia. <br><br>  Logo descobrimos que nem todos os dados se encaixam bem no MongoDB e, por exemplo, as estat√≠sticas di√°rias s√£o mais convenientes para armazenar em um banco de dados relacional.  Portanto, para conectores cuja estrutura de dados √© mais adequada para um banco de dados relacional, come√ßamos a usar o PostgreSQL ou o MS SQL Server como armazenamento. <br><br>  A arquitetura e a tecnologia selecionadas nos permitiram construir e lan√ßar relativamente rapidamente o produto D1.Digital.  Ao longo dos dois anos de desenvolvimento de produtos, desenvolvemos 23 conectores de sites, adquirimos uma experi√™ncia inestim√°vel trabalhando com APIs de terceiros, aprendemos a ignorar as armadilhas de sites diferentes, cada um com o seu, contribu√≠ram para o desenvolvimento da API em pelo menos tr√™s sites, baixaram automaticamente informa√ß√µes sobre quase 15.000 campanhas e em mais de 80.000 veicula√ß√µes, coletamos muitos coment√°rios dos usu√°rios sobre o produto e conseguimos alterar o processo principal do produto v√°rias vezes, com base nesse feedback. <br><br><h3>  Arquitetura de Solu√ß√£o 2.0 </h3><br>  Dois anos se passaram desde o in√≠cio do desenvolvimento do <b>D1.Digital</b> .  O aumento constante da carga no sistema e o surgimento de novas fontes de dados gradualmente revelaram problemas na arquitetura da solu√ß√£o existente. <br><br>  O primeiro problema est√° relacionado √† quantidade de dados baixados dos sites.  Fomos confrontados com o fato de que a coleta e a atualiza√ß√£o de todos os dados necess√°rios dos maiores sites come√ßaram a levar muito tempo.  Por exemplo, a coleta de dados no sistema de veicula√ß√£o de an√∫ncios do AdRiver, com o qual rastreamos estat√≠sticas para a maioria dos canais, leva cerca de 12 horas. <br><br>  Para resolver esse problema, come√ßamos a usar todos os tipos de relat√≥rios para baixar dados dos sites, estamos tentando desenvolver suas APIs juntamente com os sites para que sua velocidade atenda √†s nossas necessidades e paralelize o carregamento de dados o m√°ximo poss√≠vel. <br><br>  Outro problema √© o processamento dos dados baixados.  Agora, com a chegada de novas estat√≠sticas de posicionamento, √© iniciado um processo de rec√°lculo de m√©tricas em v√°rios est√°gios, que inclui o carregamento de dados brutos, o c√°lculo de m√©tricas agregadas para cada site, a compara√ß√£o de dados de diferentes fontes entre si e o c√°lculo de m√©tricas de resumo para a campanha.  Isso causa uma grande carga no aplicativo Web, que executa todos os c√°lculos.  V√°rias vezes, no processo de recontagem, o aplicativo consome toda a mem√≥ria do servidor, cerca de 10 a 15 GB, o que tem o efeito mais prejudicial no trabalho do usu√°rio com o sistema. <br><br>  Os problemas identificados e os planos grandiosos para o desenvolvimento adicional do produto nos levaram √† necessidade de revisar a arquitetura do aplicativo. <br><br>  Come√ßamos com conectores. <br>  Percebemos que todos os conectores funcionam de acordo com o mesmo modelo; portanto, constru√≠mos um transportador de tubula√ß√£o no qual, para criar o conector, era necess√°rio apenas programar a l√≥gica das etapas, o resto era universal.  Se algum conector precisar ser aprimorado, n√≥s o transferiremos imediatamente para uma nova estrutura enquanto finalizamos o conector. <br><br>  Paralelamente, come√ßamos a colocar conectores no docker e no Kubernetes. <br>  Planejamos mudar para o Kubernetes por um longo tempo, experimentamos as configura√ß√µes de CI / CD, mas come√ßamos a mudar somente quando um conector come√ßou a consumir mais de 20 GB de mem√≥ria no servidor devido a um erro, quase matando o restante dos processos.  Durante a investiga√ß√£o, o conector foi realocado para o cluster Kubernetes, onde permaneceu eventualmente, mesmo quando o erro foi corrigido. <br><br>  Muito rapidamente, percebemos que o Kubernetes era conveniente e, em seis meses, transferimos 7 conectores e Proxy de Conectores para o cluster de produ√ß√£o, que consomem mais recursos. <br><br>  Seguindo os conectores, decidimos alterar a arquitetura do restante do aplicativo. <br>  O principal problema era que os dados v√™m de conectores para proxies em pacotes grandes e, em seguida, eles batiam no DANBoID e transferidos para um aplicativo da Web central para processamento.  Devido ao grande n√∫mero de rec√°lculos de m√©tricas, ocorre uma grande carga no aplicativo. <br><br>              ,   ,   web ,    ,  ,  -    . <br><br>        2.0. <br><br>        ,   Web API   RabbitMQ   MassTransit     .       Connectors Proxy,    Connectors Hub.   ,             ,       . <br><br>   web             ,                  .             . <br><br>           Kubernetes,         . <br><br><img src="https://habrastorage.org/webt/lx/3j/tw/lx3jtwply2iyyms99xajwhtnsie.png" alt="imagem"><br><br><h3>    </h3><br> Proof-of-concept  2.0  <b>D1.Digital</b>          .    ‚Äî   20    , ,    ,     ,      . <br><br>   ,              API,    . <br><br>        ,           ,      adserving . <br><br>     ,      web ,    Kubernetes.     ,     ,     . <br><br>          ,     MongoDB.        SQL-,     ,      ,      ,     . <br><br>  ,  ,   :) <br><br> <i>  R&amp;D Dentsu Aegis Network Russia:   ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link">shmiigaa</a> ),   ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link">hitexx</a> )</i> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt469625/">https://habr.com/ru/post/pt469625/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt469613/index.html">Sobre o sistema nacional de gerenciamento de dados</a></li>
<li><a href="../pt469615/index.html">Tempo de alta precis√£o: como trabalhar com fra√ß√µes de segundo no MySQL e PHP</a></li>
<li><a href="../pt469617/index.html">Destrua o monop√≥lio da Am√©rica na EDA. Inn√≥polis d√° o primeiro passo</a></li>
<li><a href="../pt469619/index.html">Pesquisa: se o comprador entender que est√° conversando com o bot de bate-papo, a compra n√£o ser√° realizada.</a></li>
<li><a href="../pt469623/index.html">GitLab 12.3 com firewall de aplicativos da web e an√°lise de desempenho</a></li>
<li><a href="../pt469629/index.html">O √°tomo pac√≠fico n√£o est√° em todos os lares: op√ß√µes inesperadas para fontes de energia de radionucl√≠deos</a></li>
<li><a href="../pt469631/index.html">Acelerando em Figma. Precisa de mais plugins</a></li>
<li><a href="../pt469633/index.html">Criamos um conjunto de dados para reconhecimento de contadores no Yandex.Tolok</a></li>
<li><a href="../pt469635/index.html">Como funcionam as transfer√™ncias de dinheiro entre cart√µes</a></li>
<li><a href="../pt469637/index.html">Nos anos 90, o rapper MC Hammer desenvolveu o jogo, mas hoje U Can't Touch This</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>