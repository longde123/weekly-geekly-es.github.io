<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🦃 👩🏽‍🎨 👨‍🔧 Wir verbinden jeden (fast) GPS-Tracker (am Beispiel des Sinotrack ST-901) mit dem HomeAssistant Smart Home 🌴 🙆🏼 🧑🏿‍🤝‍🧑🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Einführung 
 Irgendwie fiel mir der chinesische GPS-Tracker ST-901 in die Hände. Das Gerät ist hauptsächlich für den Einsatz in der Auto- und Motorrad...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Wir verbinden jeden (fast) GPS-Tracker (am Beispiel des Sinotrack ST-901) mit dem HomeAssistant Smart Home</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/414509/"><h3>  Einführung </h3><br>  Irgendwie fiel mir der chinesische GPS-Tracker ST-901 in die Hände.  Das Gerät ist hauptsächlich für den Einsatz in der Auto- und Motorradtechnik konzipiert, verfügt über ein gsm 2G-Modul für die Kommunikation mit der Außenwelt, ein versiegeltes wasserdichtes Gehäuse und eine kleine eingebaute Batterie, mit der Sie etwa 2-3 Tage ohne externe Stromversorgung arbeiten können, wenn Sie alle 3 Minuten ein Signal senden. sowie ein Signalzündkabel, mit dem Sie vor dem Starten des Motors warnen können.  Sie können diesen Tracker über SMS-Befehle an die Trackernummer verwalten und Benachrichtigungen sowohl per SMS als auch durch Verbindung mit der Cloud über GPRS kommunizieren und empfangen.  Nachdem ich eine Weile mit ihm gespielt hatte, warf ich ihn in eine Schublade, bis HomeAssistant zu Hause erschien.  Es gab eine Idee, es mit einem Smart Home zu verbinden. <br><br><h3>  Die Aufgaben </h3><br>  Um den Tracker mit HomeAssistant zu verbinden, müssen Sie zwei Probleme lösen: Die Koordinaten vom Tracker abrufen und in HomeAssistant schreiben.  Wenn es für die zweite Aufgabe mehrere mögliche Lösungen gleichzeitig gibt (z. B. <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">gpslogger</a> oder <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://www.home-assistant.io/components/device_tracker.owntracks_">owntracks_http</a> ), wurde die Lösung für die erste Aufgabe in meinem Fall dadurch erschwert, dass Sie in den Tracker-Einstellungen für die Übertragung von Koordinaten nur eine IP-Adresse und keinen Domänennamen angeben können.  Da ich zu Hause keine statische Adresse habe, entstand die Idee, einen Vermittler zu verwenden.  <b>Ich stelle fest, dass Sie auf diese Weise fast jeden GPS-Tracker (und nicht nur in meinem Artikel berücksichtigt) anschließen können, der mit den Ressourcen eines Vermittlers kompatibel ist</b> .  Jeder, der sich für das interessiert, was daraus entstanden ist, ist herzlich willkommen bei cat. <br><a name="habracut"></a><br><br><h3>  Idee </h3><br>  Wie oben erwähnt, kann dieser Tracker mit vielen Cloud-Diensten verbunden werden.  Bei einigen von ihnen mit bestimmten Einschränkungen können Sie die Dienste kostenlos nutzen.  Einige Dienste verfügen über vollwertige APIs für die Interaktion mit ihnen, aber ich habe solche unter den kostenlosen nicht gefunden.  Fast alle Dienste bieten jedoch den Dienst, den Standort des Trackers über eine permanente Verbindung zu "teilen".  Nachdem ich einige dieser Dienste durchgesehen und im Quellcode der freigegebenen Seiten <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">herumgestöbert hatte</a> , fand ich im <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">livegpstracks-</a> Dienst, wonach ich suchte: eine Anfrage nach Koordinaten.  Das allgemeine Arbeitsschema lautet daher wie folgt: Der Tracker stellt eine Verbindung zum Livegpstracks-Dienst her und überträgt seine Koordinaten. HomeAssistant sendet regelmäßig eine http-Anforderung an den Dienst und empfängt die zuletzt aufgezeichneten Koordinaten, die von einer anderen http-Anforderung an den HomeAssistant geschrieben werden.  Hier ist ein <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Link</a> zu einer Liste aller mit dem Dienst kompatiblen Tracker. <br><br><h3>  Implementierung </h3><br>  <b>1. Beschaffung von Koordinaten auf Anfrage</b> <br><br>  Wir registrieren uns beim <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Livegpstracks-</a> Service und schließen unseren Tracker an (auf der Website finden Sie detaillierte Anweisungen für verschiedene Modelle).  Erstellen Sie anschließend über die Symbolleiste auf der Website einen privaten Link für die Nachverfolgung.  Der Link hat die Form: <br><br><pre><code class="plaintext hljs">https://livegpstracks.com/dv_USERID.html</code> </pre> <br>  Dabei ist USERID die digitale ID Ihrer Bälle. <br><br>  Das ist alles.  Sie können über Anfragen auf den Dienst zugreifen.  Um Sie nicht lange zu quälen, gebe ich nur das Anforderungsformat an: <br><br><pre> <code class="plaintext hljs">https://livegpstracks.com/viewer_coos_s.php?username=USER&amp;ctp=one&amp;code=USERID&amp;tgst=site&amp;tgsv=12&amp;tkv11=TIMENOWMS</code> </pre> <br>  Hier ist USER der Benutzer, unter dem Sie sich im livegpstracks-Dienst registriert haben. USERID ist die digitale ID, die dem freigegebenen Link zugewiesen ist. TIMENOWMS ist die aktuelle Zeit in Millisekunden (Unix-Zeit). <br><br>  Eine typische Antwort lautet: <br><br><pre> <code class="json hljs">[{<span class="hljs-attr"><span class="hljs-attr">"code"</span></span>:<span class="hljs-string"><span class="hljs-string">"xxx"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"id"</span></span>:<span class="hljs-string"><span class="hljs-string">"xxx"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"lat"</span></span>:<span class="hljs-string"><span class="hljs-string">"44"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"lng"</span></span>:<span class="hljs-string"><span class="hljs-string">"48"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"speed"</span></span>:<span class="hljs-string"><span class="hljs-string">"0"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"azimuth"</span></span>:<span class="hljs-string"><span class="hljs-string">"0"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"d"</span></span>:<span class="hljs-string"><span class="hljs-string">"2018-06-19"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"t"</span></span>:<span class="hljs-string"><span class="hljs-string">"09:35:17"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"altitude"</span></span>:<span class="hljs-string"><span class="hljs-string">"0"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"battery"</span></span>:<span class="hljs-string"><span class="hljs-string">"0"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"gpsaccuracy"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span>}]</code> </pre> <br><blockquote>  Hinweis: Ich habe die Ausgabe erheblich reduziert und auch den Parametercode, id, lat, lng geändert. </blockquote><br>  Die Methode zum Abrufen von Koordinaten in Python sieht folgendermaßen aus: <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getInfoFrom</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> timenow = int(datetime.now().strftime(<span class="hljs-string"><span class="hljs-string">"%s"</span></span>)) * <span class="hljs-number"><span class="hljs-number">1000</span></span> response = requests.get(<span class="hljs-string"><span class="hljs-string">'https://livegpstracks.com/viewer_coos_s.php'</span></span>, params={<span class="hljs-string"><span class="hljs-string">'username'</span></span>: self._user, <span class="hljs-string"><span class="hljs-string">'ctp'</span></span>: <span class="hljs-string"><span class="hljs-string">'one'</span></span>, <span class="hljs-string"><span class="hljs-string">'code'</span></span>: self._myid, <span class="hljs-string"><span class="hljs-string">'tgst'</span></span>: <span class="hljs-string"><span class="hljs-string">'site'</span></span>, <span class="hljs-string"><span class="hljs-string">'tgsv'</span></span>: <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-string"><span class="hljs-string">'tkv11'</span></span>: timenow}) data = response.json() self._lat = data[<span class="hljs-number"><span class="hljs-number">0</span></span>][<span class="hljs-string"><span class="hljs-string">"lat"</span></span>] self._lon = data[<span class="hljs-number"><span class="hljs-number">0</span></span>][<span class="hljs-string"><span class="hljs-string">"lng"</span></span>] self._speed = data[<span class="hljs-number"><span class="hljs-number">0</span></span>][<span class="hljs-string"><span class="hljs-string">"speed"</span></span>] self._direction = data[<span class="hljs-number"><span class="hljs-number">0</span></span>][<span class="hljs-string"><span class="hljs-string">"azimuth"</span></span>] self._last_time_rcv = data[<span class="hljs-number"><span class="hljs-number">0</span></span>][<span class="hljs-string"><span class="hljs-string">"d"</span></span>] + <span class="hljs-string"><span class="hljs-string">' '</span></span> + data[<span class="hljs-number"><span class="hljs-number">0</span></span>][<span class="hljs-string"><span class="hljs-string">"t"</span></span>]</code> </pre> <br>  Ich denke, dass Sie in diesem Code nichts erklären müssen: Wir erhalten die aktuelle Uhrzeit, stellen eine Abrufanfrage, erhalten eine Antwort von json, analysieren sie und ermitteln den Breitengrad, den Längengrad, die Geschwindigkeit, die Bewegungsrichtung und die Zeit, zu der der Server die Koordinaten zuletzt erhalten hat. <br><br>  <b>2. Aufzeichnung der Koordinaten</b> <br><br>  Für die Aufzeichnung habe ich das GPSLogger-Modul für HomeAssistant verwendet, da es über eine http-Anforderung funktioniert und Sie ein separates Kennwort verwenden können, das sich vom Kennwort für die gesamte HA unterscheidet.  Die Dokumentation ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">gpslogger</a> ) zeigt, dass die Anfrage das folgende Format hat: <br><br><pre> <code class="plaintext hljs">https://HAADRESS:HAPORT/api/gpslogger?latitude=LAT&amp;longitude=LON&amp;device=DEV&amp;accuracy=ACC&amp;speed=SPD&amp;direction=DIR&amp;api_password=PASS</code> </pre> <br>  Hier ist HAADRESS die IP-Adresse oder der Servername mit HA, HAPORT ist der Server-Port, LAT ist der Breitengrad, LON ist der Längengrad, DEV ist der Name des Geräts, das in HA angezeigt werden soll, ACC ist die Genauigkeit der Koordinatenbestimmung (aus irgendeinem Grund funktioniert es in HA nicht, es gibt einen Fehler, I. nicht verwendet), SPD - Geschwindigkeit, DIR - Bewegungsrichtung, PASS - Passwort für die Übertragung von Koordinaten <br><br>  Die Methode zum Schreiben von Koordinaten in Python sieht folgendermaßen aus: <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">putInfoTo</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> self._lat != <span class="hljs-string"><span class="hljs-string">''</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> self._lon != <span class="hljs-string"><span class="hljs-string">''</span></span>: req_str = self._haddr+<span class="hljs-string"><span class="hljs-string">'/api/gpslogger'</span></span> response = requests.get(req_str, params={<span class="hljs-string"><span class="hljs-string">'latitude'</span></span>: self._lat, <span class="hljs-string"><span class="hljs-string">'longitude'</span></span>: self._lon, <span class="hljs-string"><span class="hljs-string">'accuracy'</span></span>: <span class="hljs-number"><span class="hljs-number">30</span></span>, <span class="hljs-string"><span class="hljs-string">'speed'</span></span>: self._speed, <span class="hljs-string"><span class="hljs-string">'direction'</span></span>: self._direction, <span class="hljs-string"><span class="hljs-string">'device'</span></span>: self._name, <span class="hljs-string"><span class="hljs-string">' api_password'</span></span>: self._pwd}) self._last_time_upd = time.strftime(<span class="hljs-string"><span class="hljs-string">"%Y.%m.%d %H:%M"</span></span>)</code> </pre> <br>  Ich denke auch hier sind Kommentare überflüssig. <br><br>  <b>3. Modul</b> <br><br>  Der vollständige Code des Moduls zum Empfangen und Aufzeichnen von Koordinaten ist unten angegeben. <br><br><div class="spoiler">  <b class="spoiler_title">Modulcode</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#!/usr/local/bin/python3 # coding: utf-8 import time import requests import json import logging from datetime import datetime from datetime import timedelta import voluptuous as vol import homeassistant.helpers.config_validation as cv from homeassistant.components.sensor import PLATFORM_SCHEMA from homeassistant.const import (CONF_NAME) from homeassistant.helpers.entity import Entity _LOGGER = logging.getLogger(__name__) CONF_USER = 'user' CONF_ID = 'myid' CONF_PWD = 'pwd' CONF_SITE = 'haddr' ATTR_LAT = '' ATTR_LON = '' ATTR_SPEED = '' DEFAULT_NAME = 'GPS_Sensor' SCAN_INTERVAL = timedelta(seconds=120) PLATFORM_SCHEMA = PLATFORM_SCHEMA.extend({ vol.Required(CONF_USER): cv.string, vol.Required(CONF_ID): cv.string, vol.Required(CONF_PWD): cv.string, vol.Required(CONF_SITE): cv.string, vol.Optional(CONF_NAME, default=DEFAULT_NAME): cv.string, }) def setup_platform(hass, config, add_devices, discovery_info=None): user = config.get(CONF_USER) name = config.get(CONF_NAME) pwd = config.get(CONF_PWD) myid = config.get(CONF_ID) haddr = config.get(CONF_SITE) add_devices([CarGPS(name, user, myid, haddr, pwd)]) class CarGPS(Entity): def __init__(self, name, user, myid, haddr, pwd): self._name = name self._user = user self._myid = myid self._haddr = haddr self._pwd = pwd self._lat = '' self._lon = '' self._speed = '0' self._direction = '0' self._last_time_rcv = '' self._last_time_upd = '' def getInfoFrom(self): try: today = int(datetime.now().strftime("%s")) * 1000 response = requests.get('https://livegpstracks.com/viewer_coos_s.php', params={'username': self._user, 'ctp': 'one', 'code': self._myid, 'tgst': 'site', 'tgsv': 12, 'tkv11': today}) data = response.json() self._lat = data[0]["lat"] self._lon = data[0]["lng"] self._speed = data[0]["speed"] self._direction = data[0]["azimuth"] self._last_time_rcv = data[0]["d"] + ' ' + data[0]["t"] except: _LOGGER.error('coudnt get parameters') def putInfoTo(self): if self._lat != '' and self._lon != '': try: req_str = self._haddr+'/api/gpslogger' response = requests.get(req_str, params={'latitude': self._lat, 'longitude': self._lon, 'accuracy': 30, 'speed': self._speed, 'direction': self._direction, 'device': self._name, ' api_password': self._pwd}) _LOGGER.info(response) self._last_time_upd = time.strftime("%Y.%m.%d %H:%M") except: _LOGGER.error('coudnt put parameters') #for HASS @property def name(self): return self._name @property def state(self): return self._last_time_upd def update(self): self.getInfoFrom() self.putInfoTo() @property def device_state_attributes(self): attr = {} attr[ATTR_LAT] = self._lat attr[ATTR_LON] = self._lon attr[ATTR_SPEED] = self._speed return attr</span></span></code> </pre> <br></div></div><br>  Um dieses Modul zu verbinden, muss der Code in das Verzeichnis "config_folder_homeassistant / custom_components / sensor / car_location.py" kopiert werden und der Konfiguration die folgenden Zeilen hinzufügen: <br><br><pre> <code class="plaintext hljs">device_tracker: - platform: gpslogger password: !secret gpslogger_password sensor: - platform: car_location name: car_sensor user: USER myid: USERID haddr: YOUR_HA_ADDRESS pwd: !secret gpslogger_password</code> </pre> <br>  Hier finden Sie alle Variablen aus dem Abschnitt "Koordinaten auf Anfrage abrufen". <br><br>  Dieses Modul arbeitet seit mehr als einem Monat in HA ohne Fehler oder andere Probleme. <br><br>  Das ist alles, danke für Ihre Aufmerksamkeit. <br><br>  <b>UPD:</b> <br>  HomeAssistant hat die GPSLogger-Komponente aktualisiert, in Verbindung mit der eine neue Version des Mods und der Einstellungen: <br><br><div class="spoiler">  <b class="spoiler_title">neue Einstellungen</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">device_tracker: - platform: gpslogger sensor: - platform: car_location name: car_sensor user: USER myid: USERID haddr: YOUR_HA_ADDRESS_WEBHOOK</code> </pre><br>  YOUR_HA_ADDRESS_WEBHOOK - Weblog-Adresse von GPSLogger finden Sie im Abschnitt Einstellungen - Integrationen - GPSLogger. <br></div></div><br><br><div class="spoiler">  <b class="spoiler_title">neuer Modulcode</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#!/usr/local/bin/python3 # coding: utf-8 import time import requests import json import logging from datetime import datetime from datetime import timedelta import voluptuous as vol import homeassistant.helpers.config_validation as cv from homeassistant.components.sensor import PLATFORM_SCHEMA from homeassistant.const import (CONF_NAME) from homeassistant.helpers.entity import Entity _LOGGER = logging.getLogger(__name__) CONF_USER = 'user' CONF_ID = 'myid' CONF_SITE = 'haddr' CONF_NAME = 'name' ATTR_LAT = '' ATTR_LON = '' ATTR_SPEED = '' ATTR_DATE = '' DEFAULT_NAME = 'GPS_Sensor' SCAN_INTERVAL = timedelta(seconds=120) PLATFORM_SCHEMA = PLATFORM_SCHEMA.extend({ vol.Required(CONF_USER): cv.string, vol.Required(CONF_ID): cv.string, vol.Required(CONF_SITE): cv.string, vol.Optional(CONF_NAME, default=DEFAULT_NAME): cv.string, }) def setup_platform(hass, config, add_devices, discovery_info=None): user = config.get(CONF_USER) name = config.get(CONF_NAME) myid = config.get(CONF_ID) haddr = config.get(CONF_SITE) add_devices([CarGPS(name, user, myid, haddr)]) class CarGPS(Entity): def __init__(self, name, user, myid, haddr): self._name = name self._user = user self._myid = myid self._haddr = haddr self._lat = '' self._lon = '' self._speed = '0' self._direction = '0' self._last_time_rcv = '' self._last_time_upd = '' def getInfoFrom(self): try: today = int(datetime.now().strftime("%s")) * 1000 response = requests.get('https://livegpstracks.com/viewer_coos_s.php', params={'username': self._user, 'ctp': 'one', 'code': self._myid, 'tgst': 'site', 'tgsv': 12, 'tkv11': today}) data = response.json() self._lat = str(data[0]["lat"]) self._lon = str(data[0]["lng"]) self._speed = str(data[0]["speed"]) self._direction = str(data[0]["azimuth"]) self._last_time_rcv = data[0]["d"] + ' ' + data[0]["t"] except: _LOGGER.error('coudnt get parameters') def putInfoTo(self): if self._lat != '' and self._lon != '': try: header = {'Content-Type': 'application/x-www-form-urlencoded'} body = 'latitude=' + self._lat + '&amp;longitude=' + self._lon + '&amp;device=' + self._name + '&amp;accuracy=30&amp;battery=100&amp;speed=' + self._speed + '&amp;direction=' + self._direction + '&amp;altitude=0&amp;provider=0&amp;activity=0' response = requests.post(self._haddr, headers=header, data=body) self._last_time_upd = time.strftime("%Y.%m.%d %H:%M") except: _LOGGER.error('coudnt put parameters') #for HASS @property def name(self): return self._name @property def state(self): return self._last_time_upd def update(self): self.getInfoFrom() self.putInfoTo() @property def device_state_attributes(self): attr = {} attr[ATTR_LAT] = self._lat attr[ATTR_LON] = self._lon attr[ATTR_SPEED] = self._speed attr[ATTR_DATE] = self._last_time_rcv return attr</span></span></code> </pre><br></div></div><br><br>  <b>UPD2:</b> <br>  HomeAssistant hat die Arbeitslogik von Version 0.88 aktualisiert, in Verbindung mit der die neue Version des mod: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">sensor</a> <br><br>  <b>UPD3:</b> <br>  Neue Version der Integration.  Das Projekt wurde auf <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">GitHub verschoben</a> .  Die aktuelle Version ist da. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de414509/">https://habr.com/ru/post/de414509/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de414499/index.html">Bericht des Club of Rome 2018, Kapitel 1.1.3: „Eine leere Welt gegen einen vollen Frieden“</a></li>
<li><a href="../de414501/index.html">Bericht des Club of Rome 2018, Kapitel 3.11: „Reformen des Finanzsektors“</a></li>
<li><a href="../de414503/index.html">Intel NUC Hades Canyon mit AMD Vega Graphics - VR oder nicht VR?</a></li>
<li><a href="../de414505/index.html">MIT-Kurs "Computer Systems Security". Vorlesung 2: „Kontrolle von Hackerangriffen“, Teil 1</a></li>
<li><a href="../de414507/index.html">Wie sich die beliebteste programmierbare Tastatur für den Handel verändert hat: die Geschichte der Bloomberg-Tastatur</a></li>
<li><a href="../de414513/index.html">27 großartige Open Source-Webentwicklungstools</a></li>
<li><a href="../de414515/index.html">Lektion zur Optimierung von Webanwendungsservern</a></li>
<li><a href="../de414517/index.html">Oxford-Wissenschaftler: Die Wahrscheinlichkeit, dass wir im vorhersehbaren Teil des Universums allein sind, ist viel höher als Null</a></li>
<li><a href="../de414519/index.html">Wie kann man 15 Minuten Scrum-Meetings in ein volles Haus verwandeln?</a></li>
<li><a href="../de414523/index.html">Vergleich der Quadcopter DJI Mavic Pro und Mavic Air</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>