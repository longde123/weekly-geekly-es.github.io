<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üìú üõéÔ∏è üíÖüèæ Contos de desenvolvedores 1C: admin ‚óÄÔ∏è üë©‚Äçüë©‚Äçüë¶ üë®üèº‚Äçüéì</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Todos os desenvolvedores da 1C, de uma maneira ou de outra, interagem estreitamente com os servi√ßos de TI e diretamente com os administradores do sist...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Contos de desenvolvedores 1C: admin</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/449946/">  Todos os desenvolvedores da 1C, de uma maneira ou de outra, interagem estreitamente com os servi√ßos de TI e diretamente com os administradores do sistema.  Mas nem sempre essa intera√ß√£o ocorre sem problemas.  Eu gostaria de contar algumas hist√≥rias engra√ßadas sobre isso. <br><a name="habracut"></a><br><h2>  Canal de comunica√ß√£o de alta velocidade </h2><br>  A maioria dos nossos clientes √© grande parte dos seus grandes departamentos de TI.  E para c√≥pias de seguran√ßa de infobases, como regra, os especialistas do cliente s√£o respons√°veis.  Mas existem organiza√ß√µes relativamente pequenas.  Especialmente para eles, temos um servi√ßo pelo qual cuidamos de todos os problemas relacionados ao backup de todos os 1C.  Sobre essa empresa ser√° discutida nesta hist√≥ria. <br><br>  Um novo cliente veio em suporte ao 1C e, entre outras coisas, o contrato continha uma cl√°usula de que √©ramos respons√°veis ‚Äã‚Äãpelos backups, embora eles tivessem seu pr√≥prio administrador de sistema na equipe.  O banco de dados cliente-servidor, como o DBMS - MS SQL.  Uma situa√ß√£o bastante padr√£o, mas ainda havia uma ressalva: a base principal era bastante grande, mas ao mesmo tempo o aumento mensal era muito pequeno.  Ou seja, o banco de dados continha muitos dados hist√≥ricos.  Dada essa peculiaridade, configurei os planos de manuten√ß√£o de backup da seguinte forma: no primeiro s√°bado de cada m√™s, era feito um backup completo, bastante ponderado; depois, uma c√≥pia diferencial era feita todas as noites - uma quantidade relativamente pequena e a cada hora uma c√≥pia do log de transa√ß√µes.  Al√©m disso, c√≥pias completas e diferenciais, al√©m de copiadas para um recurso de rede, tamb√©m foram enviadas para o nosso servidor FTP.  Este √© um requisito obrigat√≥rio para a presta√ß√£o deste servi√ßo. <br><br>  Tudo isso foi configurado com sucesso, colocado em opera√ß√£o e funcionou em geral sem falhas. <br><br>  Mas alguns meses depois, o administrador do sistema mudou nesta organiza√ß√£o.  O novo administrador do sistema come√ßou a reconstruir gradualmente a infraestrutura de TI da empresa, de acordo com as tend√™ncias modernas.  Em particular, apareceu a virtualiza√ß√£o, prateleiras de discos, o acesso foi fechado em todos os lugares e tudo, etc., que no caso geral, √© claro, n√£o podem deixar de se alegrar.  Mas nem sempre foi tranquilo com ele, muitas vezes houve problemas com o desempenho do 1C, o que causou alguma discord√¢ncia e mal-entendido com o nosso apoio.  Al√©m disso, deve-se notar que nossas rela√ß√µes com ele geralmente se desenvolviam bastante frias e um tanto tensas, o que apenas aumentava o grau de tens√£o em caso de problemas. <br><br>  Mas uma manh√£, descobriu-se que o servidor desse cliente n√£o estava dispon√≠vel.  Liguei para o administrador do sistema para descobrir o que aconteceu e recebi algo como "Nosso servidor travou, estamos trabalhando nisso, n√£o depende de voc√™".  Bem, isso funciona.  Ent√£o a situa√ß√£o est√° sob controle.  Depois do almo√ßo, ligo novamente, na voz do administrador, em vez de irrita√ß√£o, j√° sinto cansa√ßo e apatia.  Tentando esclarecer o que aconteceu, e de alguma forma podemos ajudar?  A conversa revelou o seguinte: <br><br>  Ele mudou o servidor para um novo sistema de armazenamento com um ataque rec√©m-montado.  Mas algo deu errado e depois de alguns dias esse ataque desmoronou em seguran√ßa.  Ou o controlador se esgotou ou algo aconteceu com os discos, n√£o me lembro exatamente, mas todas as informa√ß√µes foram irremediavelmente perdidas.  E o principal foi que o recurso de rede com backups tamb√©m no processo de qualquer migra√ß√£o estava no mesmo conjunto de discos.  Ou seja, a pr√≥pria base produtiva e todos os seus backups foram perdidos.  E o que fazer agora n√£o est√° claro. <br><br>  Calmamente, eu digo.  Temos o seu backup noturno.  A resposta √© o sil√™ncio, pelo qual entendo que acabei de salvar a vida de uma pessoa.  Come√ßamos a discutir como transferir essa c√≥pia para um novo servidor rec√©m-implantado.  Mas aqui surgiu um problema. <br><br>  Lembre-se, eu disse que o backup completo era bastante grande?  Fiz isso uma vez por m√™s aos s√°bados.  O fato √© que a empresa era uma planta pequena, localizada muito al√©m da cidade e a Internet que possu√≠am era muito mais ou menos.  Na segunda-feira de manh√£, ou seja, no fim de semana, esta c√≥pia com luto pela metade tinha tempo para fazer o upload para o nosso servidor FTP.  Mas n√£o havia como esperar um dia ou dois at√© que ele carregasse na dire√ß√£o oposta.  Ap√≥s v√°rias tentativas malsucedidas de arrastar o arquivo, o administrador removeu o disco r√≠gido direto do novo servidor, encontrou um carro com um motorista em algum lugar e correu rapidamente para o nosso escrit√≥rio, pois ainda est√°vamos na mesma cidade. <br><br>  Enquanto est√°vamos na sala do servidor e aguardamos a c√≥pia dos arquivos, nos conhecemos, por assim dizer, ‚Äúao vivo‚Äù, bebemos uma x√≠cara de caf√©, conversamos em um ambiente informal.  Eu simpatizei com sua dor e enviei com um parafuso cheio de backups, com pressa para restaurar o trabalho parado da empresa. <br><br>  Posteriormente, todos os nossos aplicativos para o departamento de TI foram resolvidos muito rapidamente e n√£o houve mais discord√¢ncias. <br><br><h2>  Entre em contato com o administrador do sistema </h2><br>  Uma vez, com um √∫nico cliente, por muito tempo n√£o pude publicar o 1C para acesso √† web atrav√©s do IIS.  Parece ser uma tarefa comum, mas aqui n√£o saiu do caminho.  Os administradores de sistema local conectados, tentaram diferentes configura√ß√µes e arquivos de configura√ß√£o.  1C na web normalmente n√£o queria trabalhar em nenhum.  Havia algo errado com as pol√≠ticas de seguran√ßa do dom√≠nio, ou com um firewall sofisticado local, ou o que diabos.  Na en√©sima itera√ß√£o, o administrador solta um link para mim com as palavras: <br><br>  - Tente novamente com esta instru√ß√£o.  Tudo √© bem detalhado l√°.  Se n√£o der certo, escreva para o autor deste site, talvez ele ajude. <br>  "N√£o", eu digo, "n√£o vai ajudar." <br>  Porque? <br>  - Eu sou o autor deste site ... ( <br><br>  Como resultado, eles lan√ßaram o Apache sem problemas.  O IIS n√£o p√¥de vencer. <br><br><h2>  Mais profundo </h2><br>  T√≠nhamos um cliente - uma pequena empresa de manufatura.  Eles tinham um servidor, um "cl√°ssico" 3 em 1 t√£o peculiar: servidor de terminal + servidor de aplicativos + servidor de banco de dados.  Eles trabalharam em algumas configura√ß√µes do setor baseadas em soft starters, havia cerca de 15 a 20 usu√°rios no sistema, e o desempenho do sistema era, em princ√≠pio, adequado para todos. <br><br>  O tempo passou, tudo funcionou mais ou menos est√°vel.  Mas a Europa imp√¥s san√ß√µes contra a R√∫ssia, como resultado dos quais os russos come√ßaram a comprar principalmente produtos dom√©sticos, e as coisas nessa empresa subiram.  O n√∫mero de usu√°rios aumentou para 50 a 60 pessoas, uma nova filial foi aberta e o fluxo de trabalho tamb√©m.  E agora o servidor atual deixou de lidar com o aumento acentuado da carga, e o 1C come√ßou, como se costuma dizer, "desacelerar".  No hor√°rio de pico, os documentos eram mantidos por v√°rios minutos, os erros de bloqueio ca√≠am, os formul√°rios eram abertos por um longo tempo, bem, e todo o outro grupo de servi√ßos relacionados.  O administrador do sistema local descartou todos os problemas, dizendo: "Este √© o seu 1C, voc√™ precisa descobrir".  Sugerimos repetidamente realizar uma auditoria do sistema para obter desempenho, mas isso n√£o atingiu a auditoria propriamente dita.  O cliente simplesmente pediu recomenda√ß√µes sobre solu√ß√£o de problemas. <br><br>  Bem, sentei-me e escrevi uma carta bastante volumosa afirmando que √© necess√°rio separar as fun√ß√µes do servidor de terminal e do servidor de aplicativos do DBMS (que, em princ√≠pio, j√° dissemos antes).  Escrevi sobre DFSS em servidores de terminal, sobre Mem√≥ria Compartilhada, criei links para fontes autorizadas e at√© ofereci algumas op√ß√µes de hardware.  Essa carta alcan√ßou os poderes da empresa, voltou ao departamento de TI com as resolu√ß√µes "Executar" e o gelo geralmente quebrou. <br><br>  Depois de algum tempo, o administrador me envia o endere√ßo IP do novo servidor e as credenciais de login.  Ele diz que o MS SQL e os componentes do servidor 1C est√£o implantados l√°, e voc√™ precisa transferir os bancos de dados, mas at√© agora apenas para o servidor DBMS, pois houve alguns problemas com as chaves 1C. <br><br>  De fato, todos os servi√ßos entraram, o servidor n√£o √© muito poderoso, tudo bem, acho que √© melhor que nada.  Transferirei os bancos de dados at√© o momento para, de alguma forma, aliviar o servidor atual.  No tempo negociado, ele executou todas as transfer√™ncias, mas a situa√ß√£o n√£o mudou - todos os mesmos problemas de desempenho.  Estranho, √© claro, bem, vamos registrar as bases no cluster 1C, vamos ver. <br><br>  Demora v√°rios dias, as chaves n√£o foram transferidas.  Estou interessado em saber qual √© o problema, tudo parece simples l√° - removi-o de um servidor, prendi-o em outro, instalei o driver e est√° pronto.  O administrador responde, diz algo sobre encaminhamento de porta, um servidor virtual e muito mais. <br><br>  Hmm ... um servidor virtual?  Parece que nunca houve virtualiza√ß√£o e eles n√£o existiam ... Lembro-me de um problema bem conhecido com a incapacidade de encaminhar a chave do servidor 1C para a m√°quina virtual no Hyper-V no Windows Server 2008. E aqui come√ßam a surgir algumas suspeitas ... <br><br>  Abro o gerenciador do servidor - Fun√ß√µes - uma nova fun√ß√£o apareceu - Hyper-V.  Vou ao gerente do Hyper-V, vejo uma m√°quina virtual, estou conectando ... e realmente ... Nosso novo servidor de banco de dados ... <br><br>  Bem o que?  As instru√ß√µes das autoridades e minhas recomenda√ß√µes s√£o cumpridas, as fun√ß√µes s√£o separadas.  A tarefa pode ser fechada. <br><br>  Depois de algum tempo, a crise passou, a nova filial teve que ser fechada, a carga diminuiu, o desempenho do sistema tornou-se mais ou menos toler√°vel. <br><br>  Bem, √© claro, eles n√£o puderam encaminhar a chave do servidor para a m√°quina virtual.  Como resultado, tudo estava como estava e saiu: o servidor de terminal + 1C cluster na m√°quina f√≠sica, o servidor de banco de dados no mesmo local no virtual. <br><br>  E tudo bem, seria algum tipo de escrit√≥rio em Sharashkin.  Ent√£o n√£o.  Uma empresa bem conhecida, cujos produtos voc√™ provavelmente conhece e j√° viu nos departamentos correspondentes de todos os tipos de fitas e Auchanov. <br><br><h2>  Agenda de f√©rias do disco r√≠gido </h2><br>  Uma grande holding com planos ambiciosos <s>de dominar o mundo</s> mais uma vez comprou uma pequena empresa com o objetivo de incorpor√°-la √† sua megacorpora√ß√£o.  Em todas as divis√µes dessa propriedade, os usu√°rios trabalham em seus bancos de dados, mas com uma configura√ß√£o id√™ntica.  Por isso, iniciamos um pequeno projeto para incluir uma nova unidade nesse sistema. <br><br>  Primeiro de tudo, √© necess√°rio implantar bases de combate e teste.  O desenvolvedor recebeu os dados da conex√£o, efetuou logon no servidor, visualizou o MS SQL instalado, servidor 1C, 2 unidades l√≥gicas: uma unidade C de 250 gigabytes e uma unidade D de 1 terabyte.  Bem, "C" √© um sistema, "D" para dados, o desenvolvedor decide e implanta logicamente todos os bancos de dados l√°.  At√© configurei planos de manuten√ß√£o, incluindo backups, apenas por precau√ß√£o (embora n√£o sejamos respons√°veis ‚Äã‚Äãpor isso).  Os backups verdadeiros tomaram forma aqui no "D".  No futuro, planejava-se reconfigurar j√° em algum recurso de rede separado. <br><br>  O projeto foi lan√ßado, os consultores realizaram treinamento sobre como trabalhar no novo sistema, as sobras foram transferidas, algumas melhorias pontuais foram feitas e os usu√°rios come√ßaram a trabalhar j√° na nova base de informa√ß√µes. <br><br>  Tudo correu bem at√© que uma manh√£ na segunda-feira foi descoberto que a unidade de banco de dados havia desaparecido.  Simplesmente n√£o h√° "D" no servidor e √© isso. <br><br>  Investiga√ß√µes posteriores revelaram o seguinte: de fato, esse "servidor" era o computador de trabalho do administrador do sistema local.  √â verdade que o sistema operacional do servidor ainda estava nele.  Um disco USB pessoal desse administrador foi inserido no servidor.  E o administrador saiu de f√©rias levando consigo o seu pr√≥prio parafuso, com o objetivo de bombear filmes na estrada. <br><br>  Gra√ßas a Deus, ele n√£o conseguiu excluir os arquivos do banco de dados e conseguiu restaurar o banco de dados em funcionamento. <br><br>  Vale ressaltar que todos, em geral, ficaram satisfeitos com o desempenho do sistema localizado na unidade USB.  Ningu√©m reclamou de qualquer trabalho insatisfat√≥rio da 1C.  J√° era mais tarde que o megaprojeto come√ßou na holding a transferir todos os bancos de dados de informa√ß√µes para uma √∫nica plataforma centralizada com super servidores, armazenamento para mais de um milh√£o de rublos, hipervisores sofisticados e freios 1C insuport√°veis ‚Äã‚Äãem todas as filiais. <br><br>  Mas esta √© uma hist√≥ria completamente diferente ... <br><br><h2>  PS Veja tamb√©m: </h2><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">1C Developer Tales: Epicafe</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt449946/">https://habr.com/ru/post/pt449946/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt449936/index.html">Por que √© dif√≠cil trabalhar em uma equipe multinacional?</a></li>
<li><a href="../pt449938/index.html">Desenvolvedores vs. Neg√≥cios</a></li>
<li><a href="../pt449940/index.html">Como espremer 16 GB de mem√≥ria em uma placa-m√£e que n√£o suporta essa quantidade</a></li>
<li><a href="../pt449942/index.html">Como testamos um recurso do TK para p√≥s-produ√ß√£o e mantemos rela√ß√µes amig√°veis ‚Äã‚Äãdentro da equipe</a></li>
<li><a href="../pt449944/index.html">Docker: Bad Tips</a></li>
<li><a href="../pt449948/index.html">JavaScript: 7 pequenas coisas √∫teis</a></li>
<li><a href="../pt449952/index.html">Configurando a entrega cont√≠nua no gitlab.com</a></li>
<li><a href="../pt449954/index.html">Instale o Zimbra Open-Source Edition no CentOS 7</a></li>
<li><a href="../pt449956/index.html">AI @ MIPT: Big data para modelos matem√°ticos do genoma humano</a></li>
<li><a href="../pt449960/index.html">Fontes de inspira√ß√£o ao desenvolver para o UDB</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>