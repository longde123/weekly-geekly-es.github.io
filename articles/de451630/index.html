<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üàµ ‚ò£Ô∏è üëçüèø Kontinuierliche √úberwachung - Automatisierung der Softwarequalit√§tspr√ºfungen in der CI / CD-Pipeline üê© üòñ üßïüèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Nun zum Hype-Thema DevOps. Der F√∂rderer f√ºr die kontinuierliche Integration und Bereitstellung von CI / CD wird von jedem implementiert, der Lust dazu...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Kontinuierliche √úberwachung - Automatisierung der Softwarequalit√§tspr√ºfungen in der CI / CD-Pipeline</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/lanit/blog/451630/">  Nun zum Hype-Thema DevOps.  Der F√∂rderer f√ºr die kontinuierliche Integration und Bereitstellung von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">CI / CD wird</a> von jedem implementiert, der Lust dazu hat.  Die meisten achten jedoch nicht immer darauf, die Zuverl√§ssigkeit von Informationssystemen in verschiedenen Phasen der CI / CD-Pipeline sicherzustellen.  In diesem Artikel m√∂chte ich √ºber meine Erfahrungen bei der Automatisierung von Softwarequalit√§tspr√ºfungen und der Implementierung m√∂glicher Szenarien f√ºr deren ‚ÄûSelbstheilung‚Äú sprechen. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/279/b1b/d43/279b1bd4301b7755a590307a9378243c.jpg"></div>  <a href=""><i>Quelle</i></a> <br><a name="habracut"></a><br>  Ich arbeite als Ingenieur in der Abteilung IT Services Management bei <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">LANIT-Integration</a> .  Mein Kernbereich ist die Implementierung verschiedener Systeme zur √úberwachung der Leistung und Verf√ºgbarkeit von Anwendungen.  Ich kommuniziere h√§ufig mit IT-Kunden aus verschiedenen Marktsegmenten √ºber aktuelle Fragen der √úberwachung der Qualit√§t ihrer IT-Services.  Die Hauptaufgabe besteht darin, die Freigabezykluszeit zu minimieren und die H√§ufigkeit ihrer Freigabe zu erh√∂hen.  Das ist nat√ºrlich alles gut: mehr Releases - mehr neue Funktionen - zufriedenere Benutzer - mehr Gewinn.  Aber in Wirklichkeit l√§uft nicht immer alles gut.  Bei sehr hohen Bereitstellungsraten stellt sich sofort die Frage nach der Qualit√§t unserer Releases.  Selbst bei einer vollautomatisierten Pipeline ist eines der gr√∂√üten Probleme die √úbertragung von Diensten vom Test in die Produktion, was sich nicht auf die Verf√ºgbarkeit und die Benutzerinteraktion mit der Anwendung auswirkt. <br><br>  Aufgrund der Ergebnisse zahlreicher Kundengespr√§che kann ich sagen, dass die Qualit√§tskontrolle von Releases, das Problem der Anwendungszuverl√§ssigkeit und die M√∂glichkeit ihrer "Selbstheilung" (z. B. Rollback auf eine stabile Version) in verschiedenen Phasen der CI / CD-Pipeline zu den spannendsten und relevantesten Themen geh√∂ren. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/373/e6e/f90/373e6ef9080b3a7f8c6c4e65568254eb.png"></div><br>  Vor kurzem habe ich selbst auf Kundenseite gearbeitet - im Support-Service f√ºr Online-Banking-Anwendungen.  Die Architektur unserer Anwendung verwendete eine gro√üe Anzahl selbstgeschriebener Mikrodienste.  Das Traurigste ist, dass nicht alle Entwickler mit dem hohen Entwicklungstempo, der Qualit√§t einiger Microservices, fertig wurden, was zu l√§cherlichen Spitznamen f√ºr sie und ihre Entwickler f√ºhrte.  Es gab Geschichten dar√ºber, aus welchen Materialien diese Produkte hergestellt werden. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/210/472/129/21047212917809f642f154cfa2b8e6c6.png"></div><br><h1>  "Erkl√§rung des Problems" </h1><br>  Die hohe H√§ufigkeit von Releases und eine gro√üe Anzahl von Microservices erschweren das Verst√§ndnis der gesamten Anwendung sowohl in der Testphase als auch in der Betriebsphase.  √Ñnderungen treten st√§ndig auf und es ist sehr schwierig, sie ohne gute √úberwachungswerkzeuge zu kontrollieren.  Oft sitzen Entwickler nach einer n√§chtlichen Ver√∂ffentlichung am Morgen auf einem Pulverfass und warten darauf, dass nichts kaputt geht, obwohl in der Testphase alle √úberpr√ºfungen erfolgreich waren. <br><br>  Es gibt noch einen Punkt.  In der Testphase wird die Funktionsf√§higkeit der Software √ºberpr√ºft: die Implementierung der Hauptfunktionen der Anwendung und das Fehlen von Fehlern.  Qualitative Leistungssch√§tzungen fehlen entweder oder ber√ºcksichtigen nicht alle Aspekte der Anwendung und der Integrationsschicht.  Einige Metriken werden m√∂glicherweise √ºberhaupt nicht √ºberpr√ºft.  Wenn eine St√∂rung in einer produktiven Umgebung auftritt, findet die Abteilung f√ºr technischen Support daher erst heraus, wenn echte Benutzer anfangen, sich zu beschweren.  Ich m√∂chte die Auswirkungen von Software geringer Qualit√§t auf Endbenutzer minimieren. <br><br>  Eine der L√∂sungen besteht darin, Softwarequalit√§tskontrollprozesse in verschiedenen Phasen der CI / CD-Pipeline zu implementieren und verschiedene Skripte hinzuzuf√ºgen, um das System im Falle eines Unfalls wiederherzustellen.  Denken Sie auch daran, dass wir DevOps haben.  Das Unternehmen erwartet, so schnell wie m√∂glich ein neues Produkt zu erhalten.  Daher m√ºssen alle unsere Pr√ºfungen und Skripte automatisiert werden. <br><br>  Die Aufgabe ist in zwei Komponenten unterteilt: <br><br><ul><li>  Qualit√§tskontrolle von Baugruppen in der Testphase (um den Prozess des Auffangens minderwertiger Baugruppen zu automatisieren); </li><li>  Software-Qualit√§tskontrolle in der Produktionsumgebung (automatische Problemerkennungsmechanismen und m√∂gliche Szenarien zur Selbstheilung). </li></ul><br><h1>  Tool zum √úberwachen und Sammeln von Metriken </h1><br>  Um die gestellten Aufgaben zu realisieren, ist ein √úberwachungssystem erforderlich, das Probleme erkennen und in verschiedenen Phasen der CI / CD-Pipeline an Automatisierungssysteme √ºbertragen kann.  Ein positiver Punkt wird auch sein, wenn dieses System n√ºtzliche Metriken f√ºr verschiedene Teams bereitstellt: Entwicklung, Test, Betrieb.  Und ganz wunderbar, wenn gesch√§ftlich. <br><br>  Zum Sammeln von Metriken k√∂nnen Sie eine Kombination verschiedener Systeme (Prometheus, ELK Stack, Zabbix usw.) verwenden. Meiner Meinung nach eignen sich APM-L√∂sungen ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Application Performance Monitoring</a> ) jedoch am besten f√ºr diese Aufgaben, was Ihr Leben erheblich vereinfachen kann. <br><br>  Im Rahmen meiner Arbeit im Escortservice begann ich ein √§hnliches Projekt mit der APM-Klassenl√∂sung von Dynatrace durchzuf√ºhren.  Als Integrator kenne ich den Markt f√ºr √úberwachungssysteme sehr gut.  Meine subjektive Meinung: Dynatrace eignet sich am besten f√ºr solche Aufgaben. <br>  Die Dynatrace-L√∂sung bietet eine horizontale Anzeige jeder Benutzeroperation mit einem tiefen Detaillierungsgrad bis hin zur Ebene der Codeausf√ºhrung.  Sie k√∂nnen die gesamte Interaktionskette zwischen verschiedenen Informationsdiensten verfolgen: von Front-End-Ebenen von Web- und Mobilanwendungen √ºber Back-End-Anwendungsserver, Integrationsbus bis hin zu einem bestimmten Aufruf der Datenbank. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/223/706/776/223706776e2f818b7c9e58451f3b5874.png"></div>  <i><a href="">Quelle</a></i>  <i>Automatische Erstellung aller Abh√§ngigkeiten zwischen Systemkomponenten</i> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/73f/796/e80/73f796e80d722c47cc6044f1c60bf2c8.png"></div>  <i><a href="">Quelle</a></i>  <i>Automatische Erkennung und Erstellung eines Pfades f√ºr einen Servicevorgang</i> <br><br>  Denken Sie auch daran, dass wir in verschiedene Automatisierungstools integrieren m√ºssen.  Hier verf√ºgt die L√∂sung √ºber eine praktische API, mit der Sie verschiedene Metriken und Ereignisse senden und empfangen k√∂nnen. <br><br>  Als N√§chstes werden wir uns eingehender mit der L√∂sung von Aufgaben mit dem Dynatrace-System befassen. <br><br><h1>  Aufgabe 1. Automatisierung der Qualit√§tskontrolle von Baugruppen in der Testphase </h1><br>  Die erste Aufgabe besteht darin, Probleme so fr√ºh wie m√∂glich in den Phasen der Anwendungsbereitstellungspipeline zu finden.  Nur "gute" Code-Builds sollten die Produktumgebung erreichen.  Zu diesem Zweck sollten in der Testphase zus√§tzliche Monitore in Ihre Pipeline aufgenommen werden, um die Qualit√§t Ihrer Dienste zu √ºberpr√ºfen. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/034/bd9/498/034bd9498761bf4addffd97f68e70699.png"></div><br><br>  Schauen wir uns die Schritte an, um dies zu implementieren und diesen Prozess zu automatisieren: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1b6/2eb/b7f/1b62ebb7fa1fd652fc7ca5110926676e.png"></div>  <i><a href="">Quelle</a></i> <br><br>  Die Abbildung zeigt den Ablauf der automatisierten Schritte zur Qualit√§tskontrolle von Software: <br><br><ol><li>  Bereitstellung eines √úberwachungssystems (Installation von Agenten); </li><li>  Definition von Ereignissen zur Qualit√§tsbewertung Ihrer Software (Metriken und Schwellenwerte) und deren √úbertragung an das √úberwachungssystem; </li><li>  Lastgenerierung und Leistungstests; </li><li>  Sammeln von Leistungs- und Verf√ºgbarkeitsdaten in einem √úberwachungssystem; </li><li>  √úbertragen von Testdaten basierend auf Ereignissen zur Bewertung der Softwarequalit√§t vom √úberwachungssystem zum CI / CD-System.  Automatische Montageanalyse. </li></ol><br>  <b>Schritt 1. Stellen Sie ein √úberwachungssystem bereit</b> <br><br>  Sie m√ºssen zuerst die Agenten in Ihrer Testumgebung installieren.  Gleichzeitig verf√ºgt die Dynatrace-L√∂sung √ºber eine nette Funktion: Sie verwendet den OneAgent Universal Agent, der auf der Betriebssysteminstanz (Windows, Linux, AIX) installiert ist, erkennt Ihre Dienste automatisch und beginnt mit der Erfassung von √úberwachungsdaten.  Sie m√ºssen nicht f√ºr jeden Prozess einen Agenten separat konfigurieren.  √Ñhnliches gilt f√ºr Cloud- und Containerplattformen.  Gleichzeitig k√∂nnen Sie auch die Installation von Agenten automatisieren.  Dynatrace passt perfekt zum Konzept der ‚ÄûInfrastruktur als Code‚Äú ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Infrastruktur als Code oder IaC</a> ): Es gibt vorgefertigte Skripte und Anweisungen f√ºr alle g√§ngigen Plattformen.  Betten Sie den Agenten in die Konfiguration Ihres Dienstes ein. Wenn Sie ihn bereitstellen, erhalten Sie sofort einen neuen Dienst mit einem bereits ausgef√ºhrten Agenten. <br><br>  <b>Schritt 2. Identifizieren Sie Ihre Ereignisse zur Bewertung der Softwarequalit√§t</b> <br><br>  Jetzt m√ºssen Sie die Liste der Services und Gesch√§ftsvorg√§nge festlegen.  Es ist wichtig, genau die Benutzervorg√§nge zu ber√ºcksichtigen, die f√ºr Ihren Service gesch√§ftskritisch sind.  Hier empfehle ich die Beratung von Gesch√§fts- und Systemanalysten. <br><br>  Als N√§chstes m√ºssen Sie festlegen, welche Metriken f√ºr jede der Ebenen in die √úberpr√ºfung einbezogen werden sollen.  Dies k√∂nnen beispielsweise Laufzeit (mit Trennung nach Durchschnitt, Median, Perzentil usw.), Fehler (logisch, Dienst, Infrastruktur usw.) und verschiedene Infrastrukturmetriken (Speicherheap, Garbage Collector, Thread-Anzahl usw.) sein. <br><br>  Zur Automatisierung und Benutzerfreundlichkeit f√ºhrt das DevOps-Team das Konzept der ‚Äû√úberwachung als Code‚Äú ein.  Damit meine ich, dass ein Entwickler / Tester eine einfache JSON-Datei schreiben kann, die die Indikatoren f√ºr die Softwarequalit√§tskontrolle definiert. <br><br>  Schauen wir uns ein Beispiel f√ºr eine solche JSON-Datei an.  Objekte aus der Dynatrace-API werden als Schl√ºssel / Wert-Paar verwendet ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">eine Beschreibung der API finden</a> Sie in der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Dynatrace-API</a> ). <br><br><pre><code class="json hljs">{    <span class="hljs-attr"><span class="hljs-attr">"timeseries"</span></span>: [    {      <span class="hljs-attr"><span class="hljs-attr">"timeseriesId"</span></span>: <span class="hljs-string"><span class="hljs-string">"service.ResponseTime"</span></span>,      <span class="hljs-attr"><span class="hljs-attr">"aggregation"</span></span>: <span class="hljs-string"><span class="hljs-string">"avg"</span></span>,      <span class="hljs-attr"><span class="hljs-attr">"tags"</span></span>: <span class="hljs-string"><span class="hljs-string">"Frontend"</span></span>,      <span class="hljs-attr"><span class="hljs-attr">"severe"</span></span>: <span class="hljs-number"><span class="hljs-number">250000</span></span>,      <span class="hljs-attr"><span class="hljs-attr">"warning"</span></span>: <span class="hljs-number"><span class="hljs-number">1000000</span></span>    },    {      <span class="hljs-attr"><span class="hljs-attr">"timeseriesId"</span></span>: <span class="hljs-string"><span class="hljs-string">"service.ResponseTime "</span></span>,      <span class="hljs-attr"><span class="hljs-attr">"aggregation"</span></span>: <span class="hljs-string"><span class="hljs-string">"avg"</span></span>,      <span class="hljs-attr"><span class="hljs-attr">"tags"</span></span>: <span class="hljs-string"><span class="hljs-string">"Backend"</span></span>,      <span class="hljs-attr"><span class="hljs-attr">"severe"</span></span>: <span class="hljs-number"><span class="hljs-number">4000000</span></span>,      <span class="hljs-attr"><span class="hljs-attr">"warning"</span></span>: <span class="hljs-number"><span class="hljs-number">8000000</span></span>    },    {      <span class="hljs-attr"><span class="hljs-attr">"timeseriesId"</span></span>: <span class="hljs-string"><span class="hljs-string">"docker.Container.Cpu"</span></span>,      <span class="hljs-attr"><span class="hljs-attr">"aggregation"</span></span>: <span class="hljs-string"><span class="hljs-string">"avg"</span></span>,      <span class="hljs-attr"><span class="hljs-attr">"severe"</span></span>: <span class="hljs-number"><span class="hljs-number">50</span></span>,      <span class="hljs-attr"><span class="hljs-attr">"warning"</span></span>: <span class="hljs-number"><span class="hljs-number">70</span></span>    }  ] }</code> </pre> <br>  Die Datei besteht aus einer Reihe von Zeitreihendefinitionen: <br><br><ul><li>  timeseriesId - Metrik √ºberpr√ºft, z. B. Antwortzeit, Fehleranzahl, verwendeter Speicher usw.; </li><li>  Aggregation - Die Ebene der Aggregation von Metriken, in unserem Fall Durchschnitt, aber Sie k√∂nnen alles verwenden, was Sie ben√∂tigen (Durchschnitt, Min, Max, Summe, Anzahl, Perzentil). </li><li>  Tags - Ein Objekt-Tag im √úberwachungssystem, oder Sie k√∂nnen eine bestimmte Objektkennung angeben. </li><li>  schwerwiegend und warnend - Diese Indikatoren steuern die Schwellenwerte unserer Metriken. Wenn der Wert der Tests den schwerwiegenden Schwellenwert √ºberschreitet, wird unsere Baugruppe als nicht erfolgreich markiert. </li></ul><br>  Die folgende Abbildung zeigt ein Beispiel f√ºr die Verwendung solcher M√ºlleimer. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/087/be4/db9/087be4db9e8c7a51de722110e526f39a.png"></div>  <i><a href="">Quelle</a></i> <br><br>  <b>Schritt 3. Lastgenerierung</b> <br><br>  Nachdem wir die Qualit√§tsstufen unseres Service ermittelt haben, muss eine Testlast generiert werden.  Sie k√∂nnen jedes der f√ºr Sie geeigneten Testwerkzeuge verwenden, z. B. Jmeter, Selen, Neotys, Gatling usw. <br><br>  Mit dem Dynatrace-√úberwachungssystem k√∂nnen Sie verschiedene Metadaten aus Ihren Tests erfassen und erkennen, welcher Test sich auf welchen Release-Zyklus und welchen Service bezieht.  Es wird empfohlen, den Test-HTTP-Anforderungen zus√§tzliche Header hinzuzuf√ºgen. <br><br>  Die folgende Abbildung zeigt ein Beispiel, in dem unter Verwendung des optionalen X-Dynatrace-Test-Headers markiert wird, dass sich dieser Test auf das Testen des Vorgangs zum Hinzuf√ºgen eines Artikels zum Warenkorb bezieht. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/96a/3b8/277/96a3b8277f52b4643cc05acc38b7258b.png"></div>  <i><a href="https://dt-cdn.net/images/dynatrace-loadtesting-">Quelle</a></i> <br><br>  Wenn Sie jeden Auslastungstest ausf√ºhren, senden Sie zus√§tzliche Kontextinformationen mithilfe der Ereignis-API vom CI / CD-Server an Dynatrace.  Somit kann das System untereinander zwischen verschiedenen Tests unterscheiden. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/574/f50/948/574f509484f4a0fcc4dea39f9a39870e.png"></div>  <i><a href="">Quelle</a></i>  <i>Ereignis im √úberwachungssystem √ºber den Start von Lasttests</i> <br><br>  <b>Schritt 4-5.</b>  <b>Sammeln Sie Leistungsdaten und √ºbertragen Sie Daten an ein CI / CD-System</b> <br><br>  Zusammen mit dem generierten Test wird dem √úberwachungssystem ein Ereignis √ºber die Notwendigkeit √ºbertragen, Daten zur √úberpr√ºfung der Servicequalit√§tsindikatoren zu sammeln.  Unsere JSON-Datei wird ebenfalls angezeigt, in der Schl√ºsselmetriken definiert sind. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/584/427/af6/584427af69b059959ece68661cefbf9e.png"></div>  <i>Ein Ereignis √ºber die Notwendigkeit, die Qualit√§t der auf dem CI / CD-Server generierten Software f√ºr das Senden an das √úberwachungssystem zu √ºberpr√ºfen</i> <br><br>  In unserem Beispiel hei√üt das Qualit√§tskontrollereignis <i>perfSigDynatraceReport</i> (Performance_Signature <i>)</i> - dies ist ein fertiges <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Plug-In</a> f√ºr die Integration mit Jenkins, das von den Mitarbeitern von T-Systems Multimedia Solutions entwickelt wurde.  Jedes Ereignis zum Start des Tests enth√§lt Informationen zu Service, Build-Nummer und Testzeit.  Das Plugin sammelt Leistungswerte w√§hrend der Montage, wertet sie aus und vergleicht das Ergebnis mit fr√ºheren Baugruppen und nicht funktionalen Anforderungen. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e58/f13/7d8/e58f137d890618ddb2c59be5eb292b3d.png"></div>  <i>Ereignis im √úberwachungssystem √ºber den Beginn der Qualit√§tskontrolle der Montage.</i>  <i><a href="">Quelle</a></i> <br><br>  Nach Abschluss des Tests werden alle Metriken zur Bewertung der Softwarequalit√§t zur√ºck an das kontinuierliche Integrationssystem √ºbertragen, z. B. Jenkins, das einen Bericht √ºber die Ergebnisse erstellt. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/0y/nl/rc/0ynlrc9qxeffy9v4ei_s4ihn5v0.png"></div>  <i>Das Ergebnis der Baugruppenstatistik auf dem CI / CD-Server.</i>  <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Quelle</a></i> <br><br>  F√ºr jede einzelne Baugruppe werden Statistiken f√ºr jede Metrik angezeigt, die wir w√§hrend des gesamten Tests festgelegt haben.  Wir sehen auch, ob es bei bestimmten Schwellenwerten Verst√∂√üe gab (Warnung und schwere Thrasholds).  Basierend auf den aggregierten Metriken wird die gesamte Baugruppe als stabil, instabil oder fehlgeschlagen markiert.  Der Einfachheit halber k√∂nnen Sie auch Indikatoren hinzuf√ºgen, um die aktuelle Baugruppe mit der vorherigen im Bericht zu vergleichen. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/09a/a3d/106/09aa3d106d50eb6be368d1be57e5ee39.png"></div>  <i>Zeigen Sie detaillierte Baugruppenstatistiken auf dem CI / CD-Server an.</i>  <i><a href="">Quelle</a></i> <br><br>  <b>Detaillierter Vergleich zweier Baugruppen</b> <br><br>  Bei Bedarf k√∂nnen Sie zur Dynatrace-Oberfl√§che gehen und dort die Statistiken f√ºr jede Ihrer Baugruppen genauer betrachten und miteinander vergleichen. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/586/d52/12d/586d5212dcf21aeb30d8f7a6bbd4f158.png"></div>  <i>Vergleich der Baugruppenstatistik in Dynatrace.</i>  <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Quelle</a></i> <br><br>  <b>Schlussfolgerungen</b> <br><br>  Als Ergebnis erhalten wir den Service ‚ÄûMonitoring as a Service‚Äú, der in der Pipeline der kontinuierlichen Integration automatisiert wird.  Der Entwickler oder Tester muss nur die Liste der Metriken in der JSON-Datei ermitteln, und alles andere geschieht automatisch.  Wir erhalten eine transparente Qualit√§tskontrolle von Releases: alle Benachrichtigungen √ºber Leistung, Ressourcenverbrauch oder Architekturregressionen. <br><br><h1>  Aufgabe 2. Automatisierung der Softwarequalit√§tskontrolle in einer Produktionsumgebung </h1><br>  Daher haben wir das Problem gel√∂st, wie der √úberwachungsprozess in der Testphase in Pipeline automatisiert werden kann.  Auf diese Weise minimieren wir den Prozentsatz minderwertiger Baugruppen, die die Lebensmittelumgebung erreichen. <br><br>  Aber was tun, wenn schlechte Software immer noch an den Point of Sale kommt oder einfach etwas kaputt geht?  F√ºr die Utopie wollten wir Mechanismen zur automatischen Erkennung von Problemen, und wenn m√∂glich, w√ºrde das System selbst zumindest nachts seine Arbeitsf√§higkeit wiederherstellen. <br><br>  Zu diesem Zweck bieten wir in Analogie zum vorherigen Abschnitt automatische Softwarequalit√§tspr√ºfungen in der Produktionsumgebung an und legen Skripte zur Selbstheilung des Systems darunter. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/94d/63e/6c0/94d63e6c0575a310f5982386d731649a.png"></div><br>  <b>Automatische Korrektur als Code</b> <br><br>  Die meisten Unternehmen verf√ºgen bereits √ºber eine gesammelte Wissensbasis zu verschiedenen Arten von h√§ufig auftretenden Problemen und eine Liste von Ma√ünahmen, um diese zu beheben, z. B. Neustarten von Prozessen, Bereinigen von Ressourcen, Zur√ºcksetzen von Versionen, Wiederherstellen falscher Konfigurations√§nderungen, Erh√∂hen oder Verringern der Anzahl von Komponenten in einem Cluster, Wechseln eines blauen oder gr√ºnen Umrisses und andere <br><br>  Trotz der Tatsache, dass viele der Teams, mit denen ich kommuniziere, diese Anwendungsf√§lle seit vielen Jahren kennen, haben nur wenige √ºber ihre Automatisierung nachgedacht und in sie investiert. <br><br>  Wenn Sie dar√ºber nachdenken, dann ist bei der Implementierung von Prozessen zur Selbstheilung des Anwendungszustands nichts besonders Kompliziertes. Sie m√ºssen die bekannten Arbeitsszenarien Ihrer Administratoren in Form von Codeskripten (das Konzept der ‚ÄûAutokorrektur als Code‚Äú) darstellen, die Sie im Voraus f√ºr jeden einzelnen Fall geschrieben haben.  Automatische Reparaturszenarien sollten die Hauptursache des Problems beheben.  Sie legen selbst die richtigen Ma√ünahmen zur Reaktion auf Vorf√§lle fest. <br><br>  Jede Metrik Ihres √úberwachungssystems kann als Ausl√∂ser f√ºr die Ausf√ºhrung eines Skripts dienen. Hauptsache, diese Metriken bestimmen genau, dass alles schlecht ist, da ich in einer produktiven Umgebung keine Fehlalarme erhalten m√∂chte. <br><br>  Sie k√∂nnen jedes System oder jede Reihe von Systemen verwenden: Prometheus, ELK Stack, Zabbix usw.  Aber ich werde einige Beispiele geben, die auf der APM-L√∂sung basieren (Dynatrace wird wieder ein Beispiel sein), die Ihnen auch das Leben erleichtern werden. <br><br>  Erstens gibt es alles, was die Bedienbarkeit in Bezug auf die Anwendung betrifft.  Die L√∂sung bietet Hunderte von Metriken auf verschiedenen Ebenen, die Sie als Ausl√∂ser verwenden k√∂nnen: <br><br><ul><li>  Benutzerebene (Browser, mobile Anwendungen, IoT-Ger√§te, Benutzerverhalten, Konvertierung usw.); </li><li>  Servicelevel und Betrieb (Leistung, Verf√ºgbarkeit, Fehler usw.); </li><li>  Ebene der Anwendungsinfrastruktur (Host-Betriebssystemmetriken, JMX, MQ, Webserver usw.); </li><li>  Plattformebene (Virtualisierung, Cloud, Container usw.). </li></ul><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ac2/5f9/480/ac25f94800d26b672cace37d7495d008.png"></div>  <i>√úberwachungsebenen in Dynatrace.</i>  <i><a href="">Quelle</a></i> <br><br>  Zweitens verf√ºgt Dynatrace, wie bereits erw√§hnt, √ºber eine offene API, die die Integration in verschiedene Systeme von Drittanbietern sehr bequem macht.  Senden Sie beispielsweise eine Benachrichtigung an das Automatisierungssystem, wenn die Steuerparameter √ºberschritten werden. <br><br>  Unten finden Sie ein Beispiel f√ºr die Interaktion mit Ansible. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b90/a7a/d74/b90a7ad74b93428578dafb42235e19b4.png"></div>  <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Quelle</a></i> <br><br>  Im Folgenden werde ich einige Beispiele daf√ºr geben, welche Automatisierung genau durchgef√ºhrt werden kann.  Dies ist nur ein Teil der F√§lle. Die Auflistung in Ihrer Umgebung kann nur durch Ihre Vorstellungskraft und die Funktionen Ihrer √úberwachungstools eingeschr√§nkt werden. <br><br>  <b>1. Fehlerhafte Bereitstellung - Rollback der Version</b> <br><br>  Selbst wenn wir alle in einer Testumgebung sehr gut testen, besteht immer noch die M√∂glichkeit, dass eine neue Version Ihre Anwendung in der Produktumgebung zerst√∂rt.  Der gleiche menschliche Faktor wurde nicht aufgehoben. <br><br>  In der n√§chsten Abbildung sehen wir, dass die Ausf√ºhrungszeit von Operationen auf dem Dienst stark ansteigt.  Der Beginn dieses Sprungs f√§llt mit der Bereitstellungszeit f√ºr die Anwendung zusammen.  Wir √ºbertragen alle diese Informationen als Ereignisse an das Automatisierungssystem.  Wenn sich die Servicefreundlichkeit des Dienstes nach Ablauf der von uns angegebenen Zeit nicht normalisiert, wird automatisch ein Skript aufgerufen, das die Version auf die alte zur√ºcksetzt. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/lk/f9/ps/lkf9psxvdi6kivm-oa29pvypblw.png"></div>  <i>Leistungsminderung nach der Bereitstellung.</i>  <i><a href="">Quelle</a></i> <br><br>  <b>2. Ressourcenbelastung zu 100% - F√ºgen Sie dem Routing einen Knoten hinzu</b> <br><br>  Im folgenden Beispiel stellt das √úberwachungssystem fest, dass eine der Komponenten eine 100% ige CPU-Auslastung aufweist. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a6c/f16/d1a/a6cf16d1aebeb435e1a24c3760563f54.png"></div>  <i>CPU-Auslastung 100%</i> <br><br>  F√ºr dieses Ereignis sind verschiedene Szenarien m√∂glich.  Beispielsweise pr√ºft das √úberwachungssystem zus√§tzlich, ob der Mangel an Ressourcen mit einer Erh√∂hung der Belastung des Dienstes verbunden ist.  Wenn ja, wird ein Skript ausgef√ºhrt, das den Knoten automatisch zum Routing hinzuf√ºgt und dadurch das gesamte System wiederherstellt. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/du/kc/1z/dukc1zzqhiae9ymfilbxpoem2qo.jpeg"></div>  <i>Skalieren von Knoten nach einem Vorfall</i> <br><br>  <b>3. Mangel an Festplattenspeicher - Datentr√§gerbereinigung</b> <br><br>  Ich denke, dass viele dieser Prozesse bereits automatisiert sind.  Mit APM k√∂nnen Sie auch den freien Speicherplatz auf dem Festplattensubsystem √ºberwachen.  In Ermangelung von Speicherplatz oder langsamer Festplattenoperation rufen wir das Skript auf, um Speicherplatz zu bereinigen oder hinzuzuf√ºgen. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ea8/0cc/b7f/ea80ccb7f269eb465f30e7c94ba18c6d.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/3d8/f22/64d/3d8f2264dd7f312dac430eaa4446d845.png"></div>  <i>Festplattenladen 100%</i> <br><br>  <b>4. Geringe Benutzeraktivit√§t oder geringe Conversion - Wechseln Sie zwischen dem blauen und dem gr√ºnen Zweig</b> <br><br>  Ich treffe Kunden h√§ufig mit zwei Schaltkreisen (blau-gr√ºn bereitstellen) f√ºr Anwendungen in der Produktionsumgebung.  Auf diese Weise k√∂nnen Sie bei der Bereitstellung neuer Versionen schnell zwischen Zweigen wechseln.  Oft k√∂nnen nach der Bereitstellung grundlegende √Ñnderungen auftreten, die nicht sofort erkennbar sind.  Eine Verschlechterung der Leistung und Verf√ºgbarkeit kann jedoch nicht beobachtet werden.  Um schnell auf solche √Ñnderungen zu reagieren, ist es besser, verschiedene Metriken zu verwenden, die das Benutzerverhalten widerspiegeln (Anzahl der Sitzungen und Benutzeraktionen, Conversion, Absprungrate).  Die folgende Abbildung zeigt ein Beispiel, in dem bei einem R√ºckgang der Konvertierung zwischen Softwarezweigen gewechselt wird. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f9c/db2/776/f9cdb27767029d743a6f7b51a31fc87b.png"></div>  <i>Conversion-Drop nach dem Wechsel zwischen Software-Zweigen.</i>  <i><a href="">Quelle</a></i> <br><br>  <b>Automatische Problembestimmungsmechanismen</b> <br><br>  Am Ende werde ich noch ein Beispiel geben, f√ºr das ich Dynatrace am meisten mag. <br><br>  In einem Teil meiner Geschichte √ºber die Automatisierung der Qualit√§tskontrolle von Baugruppen in einer Testumgebung haben wir alle Schwellenwerte im manuellen Modus ermittelt.  Dies ist in einer Testumgebung normal. Der Tester bestimmt die Indikatoren vor jedem Test abh√§ngig von der Belastung.  In der Produktionsumgebung ist es w√ºnschenswert, dass Probleme unter Ber√ºcksichtigung der verschiedenen Basismechanismen automatisch erkannt werden. <br><br>  Dynatrace verf√ºgt √ºber interessante integrierte Tools f√ºr k√ºnstliche Intelligenz, die auf den Mechanismen zur Ermittlung anomaler Metriken (Baselining) und zur Erstellung einer Interaktionskarte zwischen allen Komponenten, zum Vergleich und zur Korrelation von Ereignissen untereinander, zur Ermittlung von Anomalien in der Arbeit Ihres Dienstes und zur Bereitstellung detaillierter Informationen zu jedem Problem und jeder Grundursache basieren. <br><br>  Durch die automatische Analyse der Abh√§ngigkeiten zwischen Komponenten ermittelt Dynatrace nicht nur, ob der problematische Dienst die Hauptursache ist, sondern auch seine Abh√§ngigkeit von anderen Diensten.  Im folgenden Beispiel √ºberwacht und bewertet Dynatrace automatisch den Zustand jedes Dienstes als Teil einer Transaktion und identifiziert den Golang-Dienst als Hauptgrund. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/afa/623/f52/afa623f525f3c5e2565fcc6382c173e3.png"></div>  <i>Ein Beispiel f√ºr die Ermittlung der Grundursache eines Fehlers.</i>  <i><a href="">Quelle</a></i> <br><br>  Die folgende Abbildung zeigt den Prozess der √úberwachung von Problemen mit Ihrer Anwendung vom Beginn des Vorfalls an. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/fu/z_/rt/fuz_rt4omgppab3zkuxs4b-xfmm.gif"></div>  <i>Visualisierung eines auftretenden Problems mit der Anzeige aller Komponenten und Ereignisse darauf</i> <br><br>  Das √úberwachungssystem hat eine vollst√§ndige Chronologie der Ereignisse zu dem Problem zusammengestellt.  Im Fenster unter der Zeitleiste sehen wir alle wichtigen Ereignisse f√ºr jede der Komponenten.  Basierend auf diesen Ereignissen k√∂nnen Sie Verfahren zur automatischen Korrektur in Form von Codeskripten festlegen. <br><br>  Dar√ºber hinaus empfehle ich Ihnen, das √úberwachungssystem in Service Desk oder einen Bug-Tracker zu integrieren.  Wenn ein Problem auftritt, erhalten Entwickler schnell vollst√§ndige Informationen f√ºr die Analyse auf Codeebene in der Produktionsumgebung. <br><br><h1>  Fazit </h1><br>  Als Ergebnis haben wir eine CI / CD-Pipeline mit integrierten automatisierten Softwarequalit√§tspr√ºfungen in Pipeline erhalten.  Wir minimieren die Anzahl von Baugruppen mit schlechter Qualit√§t, erh√∂hen die Zuverl√§ssigkeit des Gesamtsystems und starten Mechanismen zur Wiederherstellung des Systems, wenn wir die Leistung des Systems weiterhin beeintr√§chtigen. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/9e3/1c3/ae2/9e31c3ae24cc9f07a4771167ad2043d3.png"></div><br>  Es lohnt sich auf jeden Fall, die √úberwachung der Softwarequalit√§t zu automatisieren. Es ist nicht immer ein schneller Prozess, aber im Laufe der Zeit wird er Fr√ºchte tragen.  Ich empfehle, nach dem L√∂sen eines neuen Vorfalls in der Produktumgebung sofort zu √ºberlegen, welche Monitore f√ºr √úberpr√ºfungen in der Testumgebung hinzugef√ºgt werden sollen, um zu vermeiden, dass das Produkt fehlerhaft erstellt wird, und ein Skript zu erstellen, um diese Probleme automatisch zu beheben. <br><br>  Ich hoffe, meine Beispiele helfen Ihnen bei Ihren Bem√ºhungen.  Es wird mich auch interessieren, Ihre Beispiele f√ºr verwendete Metriken f√ºr die Implementierung von Selbstheilungssystemen zu sehen. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bea/ccc/1c5/beaccc1c5f2fb65ac9cf91e6dda3bbd5.jpg"></div>  <i><a href="">Quelle</a></i> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de451630/">https://habr.com/ru/post/de451630/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de451620/index.html">Automatische Autorisierung auf der Strava Heatmap-Karte</a></li>
<li><a href="../de451622/index.html">√úber Bitz√§hlung, vorzeichenlose Typen in Kotlin und √ºber Situationen, in denen das Speichern von √úbereinstimmungen gerechtfertigt ist</a></li>
<li><a href="../de451624/index.html">Nat√ºrlich dar√ºber, wie Harry Potter die russische Bildung gestaltet, nicht dort, wo Sie sie brauchen</a></li>
<li><a href="../de451626/index.html">Lernen ohne Lehrer: ein neugieriger Sch√ºler</a></li>
<li><a href="../de451628/index.html">Top 3D Expo Bewertung im April 2019</a></li>
<li><a href="../de451634/index.html">Wie wir in Gesch√§ften und Restaurants analysiert werden</a></li>
<li><a href="../de451636/index.html">F√ºnf Jahre Sklaverei</a></li>
<li><a href="../de451638/index.html">Animation in mobilen Anwendungen: Testen von Lottie</a></li>
<li><a href="../de451640/index.html">Game of Thrones: Erstellen von Infografiken zu Morden, Sex, Reisen in Westeros und mehr</a></li>
<li><a href="../de451642/index.html">Einen Weg zwischen runden Hindernissen finden</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>