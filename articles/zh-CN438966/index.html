<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘® âœ´ï¸ ğŸ” Haproxyæ–‡æ¡£æ¼«æ¸¸å†å²è®°å½•æˆ–é…ç½®æ—¶æŸ¥æ‰¾çš„å†…å®¹ ğŸ¤šğŸ» ğŸŠ ğŸ“‡</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ä½ å¥½ï¼ 

 ä¸Šæ¬¡ï¼Œæˆ‘ä»¬è®¨è®ºäº†åœ¨Ostrovok.ruä¸­é€‰æ‹©ä¸€ç§å·¥å…·æ¥è§£å†³å°†å¤§é‡è¯·æ±‚ä»£ç†åˆ°å¤–éƒ¨æœåŠ¡çš„é—®é¢˜ï¼Œè€Œæ— éœ€åŒæ—¶æ”¾ç½®ä»»ä½•äººã€‚ æ–‡ç« ä»¥ç²¾é€‰çš„Haproxyç»“å°¾ ã€‚ ä»Šå¤©ï¼Œæˆ‘å°†åˆ†äº«ä½¿ç”¨è¯¥è§£å†³æ–¹æ¡ˆæ—¶å¿…é¡»é¢å¯¹çš„ç»†å¾®å·®åˆ«ã€‚ 



 ä»£ç†é…ç½® 
 ç¬¬ä¸€ä¸ªå›°éš¾æ˜¯maxconné€‰é¡¹æ ¹æ®ä¸Šä¸‹æ–‡è€Œæœ‰æ‰€ä¸åŒï¼š 

...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Haproxyæ–‡æ¡£æ¼«æ¸¸å†å²è®°å½•æˆ–é…ç½®æ—¶æŸ¥æ‰¾çš„å†…å®¹</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ostrovok/blog/438966/"> ä½ å¥½ï¼ <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä¸Šæ¬¡ï¼Œ</a>æˆ‘ä»¬è®¨è®ºäº†åœ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Ostrovok.ruä¸­</a>é€‰æ‹©ä¸€ç§å·¥å…·æ¥è§£å†³å°†å¤§é‡è¯·æ±‚ä»£ç†åˆ°å¤–éƒ¨æœåŠ¡çš„é—®é¢˜ï¼Œè€Œæ— éœ€åŒæ—¶æ”¾ç½®ä»»ä½•äººã€‚ æ–‡ç« ä»¥ç²¾é€‰çš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Haproxyç»“å°¾</a> ã€‚ ä»Šå¤©ï¼Œæˆ‘å°†åˆ†äº«ä½¿ç”¨è¯¥è§£å†³æ–¹æ¡ˆæ—¶å¿…é¡»é¢å¯¹çš„ç»†å¾®å·®åˆ«ã€‚ <br><br><img src="https://habrastorage.org/webt/ns/mz/sb/nsmzsbtu2c1rgib_avecisgyrlk.jpeg"><br><a name="habracut"></a><br><h3> ä»£ç†é…ç½® </h3><br> ç¬¬ä¸€ä¸ªå›°éš¾æ˜¯<code>maxconn</code>é€‰é¡¹æ ¹æ®ä¸Šä¸‹æ–‡è€Œæœ‰æ‰€ä¸åŒï¼š <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">maxconnï¼ˆæ€§èƒ½è°ƒæ•´ï¼‰ï¼›</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">maxconnï¼ˆç»‘å®šé€‰é¡¹ï¼‰;</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">maxconnï¼ˆæœåŠ¡å™¨å’Œé»˜è®¤æœåŠ¡å™¨é€‰é¡¹ï¼‰ã€‚</a> </li></ul><br> å‡ºäºä¹ æƒ¯ï¼Œæˆ‘ä»…è°ƒæ•´äº†ç¬¬ä¸€ä¸ªé€‰é¡¹ï¼ˆ <code>performance tuning</code> ï¼‰ã€‚ è¿™æ˜¯æ–‡æ¡£ä¸­å…³äºæ­¤é€‰é¡¹çš„è¯´æ˜ï¼š <br><blockquote> å°†æ¯ä¸ªè¿›ç¨‹çš„æœ€å¤§å¹¶å‘è¿æ¥æ•°è®¾ç½®ä¸º&lt;number&gt;ã€‚ å®ƒ <br> ç­‰æ•ˆäºå‘½ä»¤è¡Œå‚æ•°â€œ -nâ€ã€‚ ä»£ç†å°†åœæ­¢æ¥å— <br> è¾¾åˆ°æ­¤é™åˆ¶æ—¶è¿æ¥ã€‚ <br></blockquote><br> ä¼¼ä¹éœ€è¦ä»€ä¹ˆã€‚ ä½†æ˜¯ï¼Œå½“æˆ‘å‘ç°ä¸ä»£ç†æœåŠ¡å™¨çš„æ–°è¿æ¥å¹¶æ²¡æœ‰é©¬ä¸Šæ¶ˆå¤±çš„äº‹å®æ—¶ï¼Œæˆ‘å¼€å§‹æ›´ä»”ç»†åœ°é˜…è¯»æ–‡æ¡£ï¼Œå¹¶ä¸”åœ¨é‚£é‡Œæˆ‘å·²ç»æ‰¾åˆ°äº†ç¬¬äºŒä¸ªå‚æ•°ï¼ˆ <code>bind options</code> ï¼‰ï¼š <br><blockquote> å°†å¥—æ¥å­—é™åˆ¶ä¸ºæ­¤å¹¶å‘è¿æ¥æ•°ã€‚ å¤–æ¥çš„ <br> è¿æ¥å°†ä¿ç•™åœ¨ç³»ç»Ÿçš„å¾…åŠäº‹é¡¹ä¸­ï¼Œç›´åˆ°å»ºç«‹è¿æ¥ä¸ºæ­¢ <br> å·²å‘å¸ƒã€‚ å¦‚æœæœªæŒ‡å®šï¼Œåˆ™é™åˆ¶å°†ä¸å‰ç«¯çš„maxconnç›¸åŒã€‚ <br></blockquote><br> æ‰€ä»¥ï¼Œ <code>frontends maxconn</code>å§ï¼Œç„¶åå¯»æ‰¾<code>frontends maxconn</code> ï¼š <br><blockquote> å›ºå®šå‰ç«¯çš„æœ€å¤§å¹¶å‘è¿æ¥æ•° <br>  ... <br> é»˜è®¤æƒ…å†µä¸‹ï¼Œæ­¤å€¼è®¾ç½®ä¸º2000ã€‚ <br></blockquote><br> å¤ªå¥½äº†ï¼Œæ‚¨éœ€è¦ä»€ä¹ˆã€‚ æ·»åŠ åˆ°é…ç½®ï¼š <br><br><pre> <code class="apache hljs"><span class="hljs-attribute"><span class="hljs-attribute">global</span></span> daemon maxconn 524288 ... defaults mode http maxconn 524288</code> </pre><br> ä¸‹ä¸€ä¸ªé—®é¢˜æ˜¯Haproxyæ˜¯å•çº¿ç¨‹çš„ã€‚ æˆ‘éå¸¸ä¹ æƒ¯Nginxä¸­çš„æ¨¡å‹ï¼Œå› æ­¤è¿™ç§ç»†å¾®å·®åˆ«ä¸€ç›´ä»¤æˆ‘æ²®ä¸§ã€‚ ä½†æ˜¯è¯·ä¸è¦ç»æœ›<i>-Willy Tarreauï¼ˆHaproxyçš„å¼€å‘äººå‘˜</i> ï¼‰äº†è§£ä»–åœ¨åšä»€ä¹ˆï¼Œå› æ­¤ä»–æ·»åŠ äº†é€‰é¡¹<code>nbproc</code> ã€‚ <br><br> ä½†æ˜¯ï¼Œç›´æ¥åœ¨æ–‡æ¡£ä¸­æ˜¾ç¤ºï¼š <br><blockquote> ä½¿ç”¨å¤šä¸ªè¿‡ç¨‹ <br> å¾ˆéš¾è°ƒè¯•ï¼Œå› æ­¤éå¸¸ä¸é«˜å…´ã€‚ <br></blockquote> å¦‚æœæ‚¨éœ€è¦ï¼Œæ­¤é€‰é¡¹ç¡®å®ä¼šä½¿æ‚¨å¤´ç—›ï¼š <br><br><ul><li> é™åˆ¶ä¸æœåŠ¡å™¨çš„è¯·æ±‚/è¿æ¥æ•°ï¼ˆå› ä¸ºæ‚¨å·²ç»æ²¡æœ‰ä¸€ä¸ªè¿›ç¨‹å¸¦æœ‰ä¸€ä¸ªè®¡æ•°å™¨ï¼Œè€Œæ˜¯å¾ˆå¤šè¿›ç¨‹ï¼Œå¹¶ä¸”æ¯ä¸ªè¿›ç¨‹éƒ½æœ‰è‡ªå·±çš„è®¡æ•°å™¨ï¼‰ï¼› </li><li> ä»Haproxyç®¡ç†å¥—æ¥å­—æ”¶é›†ç»Ÿè®¡ä¿¡æ¯ </li><li> é€šè¿‡æ§åˆ¶å¥—æ¥å­—å¯ç”¨/ç¦ç”¨åç«¯ï¼› </li><li>  ...ä¹Ÿè®¸å…¶ä»–çš„ä¸œè¥¿ã€‚  Â¯\ _ï¼ˆãƒ„ï¼‰_ /Â¯ </li></ul><br> å°½ç®¡å¦‚æ­¤ï¼Œä¼—ç¥ç»™äº†æˆ‘ä»¬å¤šæ ¸å¤„ç†å™¨ï¼Œæ‰€ä»¥æˆ‘æƒ³æœ€å¤§é™åº¦åœ°ä½¿ç”¨å®ƒä»¬ã€‚ å°±æˆ‘è€Œè¨€ï¼Œä¸¤ä¸ªç‰©ç†æ ¸å¿ƒä¸­æœ‰å››ä¸ªæ ¸å¿ƒã€‚ å¯¹äºHaproxyï¼Œæˆ‘é€‰æ‹©äº†ç¬¬ä¸€ä¸ªæ ¸å¿ƒï¼Œå®ƒçœ‹èµ·æ¥åƒè¿™æ ·ï¼š <br><br><pre> <code class="apache hljs"> <span class="hljs-attribute"><span class="hljs-attribute">nbproc</span></span> 4 cpu-map 1 0 cpu-map 2 1 cpu-map 3 2 cpu-map 4 3</code> </pre><br> ä½¿ç”¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">cpu-mapï¼Œ</a>æˆ‘ä»¬å°†Haproxyè¿›ç¨‹ç»‘å®šåˆ°ç‰¹å®šçš„æ ¸å¿ƒã€‚ æ“ä½œç³»ç»Ÿè°ƒåº¦ç¨‹åºä¸å†éœ€è¦è€ƒè™‘åœ¨ä½•å¤„è®¡åˆ’Haproxyï¼Œä»è€Œä½¿<code>content switch</code>ä¿æŒå‡‰çˆ½ï¼Œå¹¶ä½¿CPUç¼“å­˜ä¿æŒæ¸©æš–ã€‚ <br><br><h4> æœ‰å¾ˆå¤šç¼“å†²åŒºï¼Œä½†åœ¨æˆ‘ä»¬è¿™é‡Œæ²¡æœ‰ </h4><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">tune.bufsize-</a>åœ¨æˆ‘ä»¬çš„æƒ…å†µä¸‹ï¼Œæ²¡æœ‰å¿…è¦è¿è¡Œå®ƒï¼Œä½†æ˜¯å¦‚æœæ‚¨å¯¹ä»£ç <code>400 (Bad Request)</code>æœ‰é”™è¯¯ï¼Œåˆ™å¯èƒ½æ˜¯æ‚¨çš„æƒ…å†µã€‚ </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=http://cbonte.github.io/haproxy-dconv/1.9/configuration.html&amp;usg=ALkJrhig2SylYJqvRQvmAyvnr9WLJ3EutA#tune.">tune.http.cookielen-</a>å¦‚æœæ‚¨å‘ç”¨æˆ·åˆ†å‘å¤§çš„cookieï¼Œåˆ™ä¸ºäº†é¿å…åœ¨ç½‘ç»œä¼ è¾“è¿‡ç¨‹ä¸­é€ æˆæŸåï¼Œä¹Ÿæœ‰å¿…è¦å¢åŠ æ­¤ç¼“å†²åŒºã€‚ </li><li> å¦‚æœæ ‡é¢˜å¤ªå¤šï¼Œåˆ™<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=http://cbonte.github.io/haproxy-dconv/1.9/configuration.html&amp;usg=ALkJrhig2SylYJqvRQvmAyvnr9WLJ3EutA#tune.">tune.http.maxhdr</a>æ˜¯400ä¸ªå“åº”ä»£ç çš„å¦ä¸€ä¸ªå¯èƒ½æ¥æºã€‚ </li></ul><br><h4> ç°åœ¨è€ƒè™‘ä¸‹å±‚çš„ä¸œè¥¿ </h4><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">tune.rcvbuf.client</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">tune.rcvbuf.server</a> ï¼Œ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">tune.sndbuf.client</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">tune.sndbuf.server-</a>è¯¥æ–‡æ¡£æ˜¾ç¤ºä»¥ä¸‹å†…å®¹ï¼š <br><blockquote> é€šå¸¸ä¸åº”è®¾ç½®è¯¥å€¼ï¼Œé»˜è®¤å¤§å°ï¼ˆ0ï¼‰å¯ä½¿å†…æ ¸æ ¹æ®å¯ç”¨å†…å­˜é‡è‡ªåŠ¨è°ƒæ•´è¯¥å€¼ã€‚ <br></blockquote><br> ä½†æ˜¯å¯¹æˆ‘æ¥è¯´ï¼Œæ˜¾è€Œæ˜“è§çš„è¦æ¯”éšå«çš„å¥½ï¼Œæ‰€ä»¥æˆ‘å¼ºè¿«è¿™äº›é€‰é¡¹çš„å€¼æ¥ç¡®ä¿æ˜å¤©ã€‚ <br><br> å¦ä¸€ä¸ªä¸ç¼“å†²åŒºæ— å…³ä½†å¾ˆé‡è¦çš„å‚æ•°æ˜¯<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">tune.maxaccept</a> ã€‚ <br><blockquote> è®¾ç½®è¿›ç¨‹å¯ä»¥æ¥å—çš„æœ€å¤§è¿ç»­è¿æ¥æ•° <br> åˆ‡æ¢åˆ°å…¶ä»–å·¥ä½œä¹‹å‰ åœ¨å•è¿›ç¨‹æ¨¡å¼ä¸‹ï¼Œæ›´é«˜çš„æ•°å­— <br> åœ¨é«˜è¿æ¥é€Ÿç‡ä¸‹æä¾›æ›´å¥½çš„æ€§èƒ½ã€‚ ä½†æ˜¯åœ¨å¤šè¿›ç¨‹ä¸­ <br> æ¨¡å¼ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œä¿æŒæµç¨‹ä¹‹é—´çš„å…¬å¹³æ€§æ›´å¥½ <br> æé«˜æ€§èƒ½ã€‚ <br></blockquote><br> åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œç”Ÿæˆäº†å¾ˆå¤šä»£ç†è¯·æ±‚ï¼Œå› æ­¤æˆ‘æé«˜äº†æ­¤å€¼ä»¥ä¸€æ¬¡æ¥å—æ›´å¤šè¯·æ±‚ã€‚ ä½†æ˜¯ï¼Œæ­£å¦‚æ–‡æ¡£æ‰€è¿°ï¼Œå€¼å¾—æµ‹è¯•çš„æ˜¯ï¼Œåœ¨å¤šçº¿ç¨‹æ¨¡å¼ä¸‹ï¼Œè´Ÿè½½åº”å°½å¯èƒ½å‡åŒ€åœ°åˆ†å¸ƒåœ¨å„ä¸ªè¿›ç¨‹ä¹‹é—´ã€‚ <br><br> æ‰€æœ‰å‚æ•°ä¸€èµ·ï¼š <br><br><pre> <code class="apache hljs"> <span class="hljs-attribute"><span class="hljs-attribute">tune</span></span>.bufsize 16384 tune.http.cookielen 63 tune.http.maxhdr 101 tune.maxaccept 256 tune.rcvbuf.client 33554432 tune.rcvbuf.server 33554432 tune.sndbuf.client 33554432 tune.sndbuf.server 33554432</code> </pre><br><h4> æ°¸è¿œä¸ä¼šå‘ç”Ÿè¶…æ—¶ã€‚ æ²¡æœ‰ä»–ä»¬æˆ‘ä»¬è¯¥æ€ä¹ˆåŠï¼Ÿ </h4><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è¶…æ—¶è¿æ¥</a> -ä¸åç«¯å»ºç«‹<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è¿æ¥çš„</a>æ—¶é—´ã€‚ å¦‚æœä¸åç«¯çš„è¿æ¥ä¸æ˜¯å¾ˆå¥½ï¼Œé‚£ä¹ˆæœ€å¥½åœ¨æ­¤è¶…æ—¶ä¹‹å‰å°†å…¶ç¦ç”¨ï¼Œç›´åˆ°ç½‘ç»œæ¢å¤æ­£å¸¸ã€‚ </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è¶…æ—¶å®¢æˆ·ç«¯</a> -ä¼ è¾“æ•°æ®çš„ç¬¬ä¸€ä¸ªå­—èŠ‚çš„è¶…æ—¶ã€‚ å®ƒæœ‰åŠ©äºæ–­å¼€é‚£äº›â€œä¿ç•™â€è¯·æ±‚çš„äººã€‚ </li></ul><br><div class="spoiler">  <b class="spoiler_title">æœ‰å…³Goä¸­HTTPå®¢æˆ·ç«¯çš„Kulstory</b> <div class="spoiler_text">  Goå…·æœ‰ä¸€ä¸ªå¸¸è§„HTTPå®¢æˆ·ç«¯ï¼Œè¯¥å®¢æˆ·ç«¯èƒ½å¤Ÿä¿ç•™ä¸æœåŠ¡å™¨çš„è¿æ¥æ± ã€‚ å› æ­¤å‘ç”Ÿäº†ä¸€ä¸ªæœ‰è¶£çš„æ•…äº‹ï¼Œå…¶ä¸­HTTPå®¢æˆ·ç«¯ä¸­çš„ä¸Šè¿°è¶…æ—¶å’Œè¿æ¥æ± å‚ä¸å…¶ä¸­ã€‚ ä¸€æ—¦å¼€å‘äººå‘˜æŠ•è¯‰ä»–å®šæœŸä»ä»£ç†æ”¶åˆ°408é”™è¯¯ã€‚ æˆ‘ä»¬æŸ¥çœ‹äº†å®¢æˆ·ç«¯ä»£ç ï¼Œå¹¶åœ¨å…¶ä¸­çœ‹åˆ°äº†ä»¥ä¸‹é€»è¾‘ï¼š <br><br><ul><li> æˆ‘ä»¬æ­£åœ¨å°è¯•ä»æ± ä¸­å»ºç«‹å…è´¹çš„å·²å»ºç«‹è¿æ¥ï¼› </li><li> å¦‚æœæ— æ³•è§£å†³ï¼Œè¯·åœ¨goroutineä¸­å¼€å§‹å®‰è£…æ–°è¿æ¥ï¼› </li><li> å†æ¬¡æ£€æŸ¥æ¸¸æ³³æ± ï¼› </li><li> å¦‚æœæ± ä¸­æœ‰å¯ç”¨çš„ä¸œè¥¿-æˆ‘ä»¬å°†å…¶æ‹¿èµ°ï¼Œç„¶åå°†æ–°çš„æ”¾å…¥æ± ä¸­ï¼›å¦‚æœæ²¡æœ‰ï¼Œè¯·ä½¿ç”¨æ–°çš„ã€‚ </li></ul><br> å·²ç»äº†è§£ç›æ˜¯ä»€ä¹ˆï¼Ÿ <br><br> å¦‚æœå®¢æˆ·ç«¯å·²å»ºç«‹æ–°è¿æ¥ä½†å°šæœªä½¿ç”¨ï¼Œåˆ™æœåŠ¡å™¨åœ¨äº”ç§’é’Ÿåå…³é—­å®ƒï¼Œå¹¶ä¸”æƒ…å†µå·²ç»“æŸã€‚ å®¢æˆ·ç«¯ä»…åœ¨å®ƒå·²ç»ä»æ± ä¸­è·å–è¿æ¥å¹¶å°è¯•ä½¿ç”¨å®ƒæ—¶æ‰æ•è·æ­¤è¿æ¥ã€‚ å€¼å¾—ç‰¢è®°è¿™ä¸€ç‚¹ã€‚ <br></div></div><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è¶…æ—¶æœåŠ¡å™¨</a> -ç­‰å¾…æœåŠ¡å™¨å“åº”çš„æœ€é•¿æ—¶é—´ã€‚ </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è¶…æ—¶client-fin</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è¶…æ—¶server-fin-</a>åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä¿æŠ¤è‡ªå·±å…å—åŠå°é—­è¿æ¥çš„å½±å“ï¼Œä»¥å…å°†å…¶ç´¯ç§¯åœ¨æ“ä½œç³»ç»Ÿè¡¨ä¸­ã€‚ </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=http://cbonte.github.io/haproxy-dconv/1.9/configuration.html&amp;usg=ALkJrhig2SylYJqvRQvmAyvnr9WLJ3EutA#timeout%20">è¶…æ—¶http-request</a>æ˜¯æœ€åˆé€‚çš„è¶…æ—¶ä¹‹ä¸€ã€‚ å…è®¸æ‚¨æ–©æ–­æ— æ³•åœ¨åˆ†é…çš„æ—¶é—´å†…å‘å…¶å‘å‡ºHTTPè¯·æ±‚çš„æ…¢é€Ÿå®¢æˆ·ç«¯ã€‚ </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=http://cbonte.github.io/haproxy-dconv/1.9/configuration.html&amp;usg=ALkJrhig2SylYJqvRQvmAyvnr9WLJ3EutA#timeout%20">è¶…æ—¶http-keep-alive-</a>åœ¨æˆ‘ä»¬çš„æƒ…å†µä¸‹ï¼Œç‰¹åˆ«æ˜¯å¦‚æœ<code>keep-alive</code>è¿æ¥åœ¨æ²¡æœ‰è¯·æ±‚çš„æƒ…å†µä¸‹æŒ‚èµ·è¶…è¿‡50ç§’ï¼Œåˆ™å¾ˆå¯èƒ½å‡ºç°äº†é—®é¢˜ï¼Œå¯ä»¥å…³é—­è¿æ¥ï¼Œä»è€Œä¸ºæ–°çš„ç©ºé—´é‡Šæ”¾äº†å†…å­˜è½»ã€‚ </li></ul><br> æ‰€æœ‰è¶…æ—¶ä¸€èµ·ï¼š <br><br><pre> <code class="apache hljs"><span class="hljs-attribute"><span class="hljs-attribute">defaults</span></span> mode http maxconn 524288 timeout connect 5s timeout client 10s timeout server 120s timeout client-fin 1s timeout server-fin 1s timeout http-request 10s timeout http-keep-alive 50s</code> </pre><br><h4> è®°å½•ä¸­ ä¸ºä»€ä¹ˆè¿™ä¹ˆéš¾ï¼Ÿ </h4><br> å¦‚æˆ‘å…ˆå‰æ‰€å†™ï¼Œåœ¨æˆ‘çš„å†³ç­–ä¸­ï¼Œå¤§å¤šæ•°æ—¶å€™æˆ‘éƒ½ä½¿ç”¨Nginxï¼Œå› æ­¤ï¼Œå®ƒçš„è¯­æ³•å’Œä¿®æ”¹æ—¥å¿—æ ¼å¼çš„ç®€å•æ€§è®©æˆ‘ç€è¿·ã€‚ æˆ‘ç‰¹åˆ«å–œæ¬¢æ€æ‰‹çº§åŠŸèƒ½-ä»¥jsonçš„å½¢å¼æ ¼å¼åŒ–æ—¥å¿—ï¼Œç„¶åå°†å…¶ä¸ä»»ä½•æ ‡å‡†åº“ä¸€èµ·è§£æã€‚ <br><br> åœ¨Haproxyæˆ‘ä»¬æœ‰ä»€ä¹ˆï¼Ÿ æœ‰è¿™æ ·çš„æœºä¼šï¼Œåªæœ‰æ‚¨æ‰èƒ½ä»¥syslogç‹¬å æ–¹å¼ç¼–å†™ï¼Œå¹¶ä¸”é…ç½®è¯­æ³•è¦ç¨å¾®åŒ…è£…ä¸€äº›ã€‚ <br> æˆ‘å°†ä¸ºæ‚¨æä¾›ä¸€ä¸ªç¤ºä¾‹é…ç½®ï¼Œå¹¶æä¾›æ³¨é‡Šï¼š <br><br><pre> <code class="apache hljs"><span class="hljs-comment"><span class="hljs-comment">#  ,     ,    (   # error.log  nginx) log 127.0.0.1:2514 len 8192 local1 notice emerg #    -  access.log log 127.0.0.1:2514 len 8192 local7 info</span></span></code> </pre><br> ç‰¹æ®Šçš„ç–¼ç—›æ˜¯ç”±ä»¥ä¸‹æ—¶åˆ»å¼•èµ·çš„ï¼š <br><ul><li> çŸ­å˜é‡åï¼Œå°¤å…¶æ˜¯å®ƒä»¬çš„ç»„åˆï¼Œä¾‹å¦‚ï¼…HUæˆ–ï¼…fp </li><li> æ ¼å¼ä¸èƒ½åˆ†ä¸ºå‡ è¡Œï¼Œå› æ­¤æ‚¨å¿…é¡»åœ¨ä¸€è¡Œä¸­å†™ä¸Šè„šå°ã€‚ éš¾ä»¥æ·»åŠ /åˆ é™¤æ–°çš„/ä¸å¿…è¦çš„é¡¹ç›® </li><li> ä¸ºäº†ä½¿æŸäº›å˜é‡èµ·ä½œç”¨ï¼Œå¿…é¡»é€šè¿‡æ•è·è¯·æ±‚æ ‡å¤´æ˜ç¡®å£°æ˜å®ƒä»¬ </li></ul><br> ç»“æœï¼Œè¦è·å¾—ä¸€äº›æœ‰è¶£çš„ä¸œè¥¿ï¼Œæ‚¨å°±å¿…é¡»æ‹¥æœ‰è¿™æ ·çš„é‹å±¥ï¼š <br><br><pre> <code class="apache hljs"><span class="hljs-attribute"><span class="hljs-attribute">log</span></span>-format '{<span class="hljs-string"><span class="hljs-string">"status"</span></span>:<span class="hljs-string"><span class="hljs-string">"%ST"</span></span>,<span class="hljs-string"><span class="hljs-string">"bytes_read"</span></span>:<span class="hljs-string"><span class="hljs-string">"%B"</span></span>,<span class="hljs-string"><span class="hljs-string">"bytes_uploaded"</span></span>:<span class="hljs-string"><span class="hljs-string">"%U"</span></span>,<span class="hljs-string"><span class="hljs-string">"hostname"</span></span>:<span class="hljs-string"><span class="hljs-string">"%H"</span></span>,<span class="hljs-string"><span class="hljs-string">"method"</span></span>:<span class="hljs-string"><span class="hljs-string">"%HM"</span></span>,<span class="hljs-string"><span class="hljs-string">"request_uri"</span></span>:<span class="hljs-string"><span class="hljs-string">"%HU"</span></span>,<span class="hljs-string"><span class="hljs-string">"handshake_time"</span></span>:<span class="hljs-string"><span class="hljs-string">"%Th"</span></span>,<span class="hljs-string"><span class="hljs-string">"request_idle_time"</span></span>:<span class="hljs-string"><span class="hljs-string">"%Ti"</span></span>,<span class="hljs-string"><span class="hljs-string">"request_time"</span></span>:<span class="hljs-string"><span class="hljs-string">"%TR"</span></span>,<span class="hljs-string"><span class="hljs-string">"response_time"</span></span>:<span class="hljs-string"><span class="hljs-string">"%Tr"</span></span>,<span class="hljs-string"><span class="hljs-string">"timestamp"</span></span>:<span class="hljs-string"><span class="hljs-string">"%Ts"</span></span>,<span class="hljs-string"><span class="hljs-string">"client_ip"</span></span>:<span class="hljs-string"><span class="hljs-string">"%ci"</span></span>,<span class="hljs-string"><span class="hljs-string">"client_port"</span></span>:<span class="hljs-string"><span class="hljs-string">"%cp"</span></span>,<span class="hljs-string"><span class="hljs-string">"frontend_port"</span></span>:<span class="hljs-string"><span class="hljs-string">"%fp"</span></span>,<span class="hljs-string"><span class="hljs-string">"http_request"</span></span>:<span class="hljs-string"><span class="hljs-string">"%r"</span></span>,<span class="hljs-string"><span class="hljs-string">"ssl_ciphers"</span></span>:<span class="hljs-string"><span class="hljs-string">"%sslc"</span></span>,<span class="hljs-string"><span class="hljs-string">"ssl_version"</span></span>:<span class="hljs-string"><span class="hljs-string">"%sslv"</span></span>,<span class="hljs-string"><span class="hljs-string">"date_time"</span></span>:<span class="hljs-string"><span class="hljs-string">"%t"</span></span>,<span class="hljs-string"><span class="hljs-string">"http_host"</span></span>:<span class="hljs-string"><span class="hljs-string">"%[capture.req.hdr(0)]"</span></span>,<span class="hljs-string"><span class="hljs-string">"http_referer"</span></span>:<span class="hljs-string"><span class="hljs-string">"%[capture.req.hdr(1)]"</span></span>,<span class="hljs-string"><span class="hljs-string">"http_user_agent"</span></span>:<span class="hljs-string"><span class="hljs-string">"%[capture.req.hdr(2)]"</span></span>}'</code> </pre><br><h4> å¥½å§ï¼Œä¼¼ä¹æ²¡ä»€ä¹ˆï¼Œä½†æ˜¯å¾ˆå¥½ </h4><br> æˆ‘åœ¨ä¸Šé¢æè¿°äº†æ—¥å¿—çš„æ ¼å¼ï¼Œä½†ä¸æ˜¯é‚£ä¹ˆç®€å•ã€‚ åœ¨å…¶ä¸­å­˜æ”¾ä¸€äº›å…ƒç´ ï¼Œä¾‹å¦‚ï¼š <br><br><ul><li>  http_host </li><li>  http_refererï¼Œ </li><li>  http_user_agentï¼Œ </li></ul><br> é¦–å…ˆï¼Œæ‚¨éœ€è¦ä»è¯·æ±‚ä¸­æ•è·æ­¤æ•°æ®ï¼ˆ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">capture</a> ï¼‰å¹¶å°†å…¶æ”¾å…¥æ•è·å€¼æ•°ç»„ä¸­ã€‚ <br><br> è¿™æ˜¯ä¸€ä¸ªä¾‹å­ï¼š <br><br><pre> <code class="apache hljs"><span class="hljs-attribute"><span class="hljs-attribute">capture</span></span> request header Host len 32 capture request header Referer len 128 capture request header User-Agent len 128</code> </pre><br> ç»“æœï¼Œæˆ‘ä»¬ç°åœ¨å¯ä»¥é€šè¿‡è¿™ç§æ–¹å¼è®¿é—®â€‹â€‹æ‰€éœ€çš„å…ƒç´ ï¼š <br>  <code>%[capture.req.hdr(N)]</code> ï¼Œå…¶ä¸­Næ˜¯æ•è·ç»„å®šä¹‰çš„åºåˆ—å·ã€‚ <br> åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼ŒHostæ ‡å¤´å°†ä½äºæ•°å­—0ï¼Œè€ŒUser-Agentå°†ä½äºæ•°å­—2ã€‚ <br><br>  Haproxyå…·æœ‰ä¸€ä¸ªç‰¹æ®Šæ€§ï¼šå®ƒåœ¨å¯åŠ¨æ—¶è§£æåç«¯çš„DNSåœ°å€ï¼Œå¹¶ä¸”ï¼Œå¦‚æœå®ƒä¸èƒ½è§£æä»»ä½•åœ°å€ï¼Œåˆ™å°†å¤±å»å‹‡æ°”ã€‚ <br><br> åœ¨æˆ‘ä»¬çš„æƒ…å†µä¸‹ï¼Œè¿™ä¸æ˜¯å¾ˆæ–¹ä¾¿ï¼Œå› ä¸ºåç«¯å¾ˆå¤šï¼Œæˆ‘ä»¬ä¸å¯¹å…¶è¿›è¡Œç®¡ç†ï¼Œå› æ­¤ä»Haproxyè·å–503æœ€å¥½æ¯”æ•´ä¸ªä»£ç†æœåŠ¡å™¨ç”±äºä¸€ä¸ªæä¾›ç¨‹åºè€Œæ‹’ç»å¯åŠ¨æ›´å¥½ã€‚ ä»¥ä¸‹é€‰é¡¹å¯ä»¥å¸®åŠ©æˆ‘ä»¬ï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">init-addr</a> ã€‚ <br><br> ç›´æ¥ä»æ–‡æ¡£ä¸­æ‘˜å½•çš„ä¸€è¡Œä½¿æˆ‘ä»¬å¯ä»¥ç ”ç©¶æ‰€æœ‰å¯ç”¨çš„æ–¹æ³•æ¥è§£æåœ°å€ï¼Œå¯¹äºæ–‡ä»¶ï¼Œåªéœ€å°†å…¶æ¨è¿Ÿåˆ°ä»¥åå†ç»§ç»­ï¼š <br><br><pre> <code class="apache hljs"><span class="hljs-attribute"><span class="hljs-attribute">default</span></span>-server init-addr last,libc,none</code> </pre> <br> æœ€åï¼Œæˆ‘æœ€å–œæ¬¢çš„æ˜¯ï¼šåç«¯é€‰æ‹©ã€‚ <br> æ¯ä¸ªäººéƒ½ç†Ÿæ‚‰Haproxyåç«¯é€‰æ‹©é…ç½®çš„è¯­æ³•ï¼š <br><br><pre> <code class="apache hljs"><span class="hljs-attribute"><span class="hljs-attribute">use_backend</span></span> &lt;backend1_name&gt; if &lt;condition1&gt; use_backend &lt;backend2_name&gt; if &lt;condition2&gt; default-backend &lt;backend3&gt;</code> </pre><br> ä½†æ˜¯ï¼Œæ­£ç¡®çš„è¯´ï¼Œä¸æ˜¯å¾ˆæ­£ç¡®ã€‚ æˆ‘å·²ç»ä»¥è‡ªåŠ¨åŒ–çš„æ–¹å¼æè¿°äº†æ‰€æœ‰åç«¯ï¼ˆè¯·å‚é˜…<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä¸Šä¸€ç¯‡æ–‡ç« </a> ï¼‰ï¼Œä¹Ÿå¯ä»¥åœ¨è¿™é‡Œç”Ÿæˆ<code>use_backend</code> ï¼Œä¸å¥½çš„äº‹æƒ…å¹¶ä¸æ£˜æ‰‹ï¼Œä½†æˆ‘ä¸æƒ³è¿™ä¹ˆåšã€‚ ç»“æœï¼Œæ‰¾åˆ°äº†å¦ä¸€ç§æ–¹æ³•ï¼š <br><br><pre> <code class="apache hljs"> <span class="hljs-attribute"><span class="hljs-attribute">capture</span></span> request header Host len 32 capture request header Referer len 128 capture request header User-Agent len 128 #   host_present      Host acl host_present hdr(host) -m len gt 0 #    ,     use_backend %[req.hdr(host),lower,field(1,'.')] if host_present #      ,    default_backend default backend default mode http server no_server 127.0.0.1:65535</code> </pre><br> å› æ­¤ï¼Œæˆ‘ä»¬æ ‡å‡†åŒ–äº†åç«¯å’ŒURLçš„åç§°ï¼Œæ‚¨å¯ä»¥é€šè¿‡å®ƒä»¬æ¥è®¿é—®å®ƒä»¬ã€‚ <br><br> å¥½äº†ï¼Œç°åœ¨å°†ä»¥ä¸Šç¤ºä¾‹ç¼–è¯‘æˆä¸€ä¸ªæ–‡ä»¶ï¼š <br><br><div class="spoiler">  <b class="spoiler_title">å®Œæ•´ç‰ˆæœ¬çš„é…ç½®</b> <div class="spoiler_text"><pre> <code class="apache hljs"> <span class="hljs-attribute"><span class="hljs-attribute">global</span></span> daemon maxconn 524288 nbproc 4 cpu-map 1 0 cpu-map 2 1 cpu-map 3 2 cpu-map 4 3 tune.bufsize 16384 tune.comp.maxlevel 1 tune.http.cookielen 63 tune.http.maxhdr 101 tune.maxaccept 256 tune.rcvbuf.client 33554432 tune.rcvbuf.server 33554432 tune.sndbuf.client 33554432 tune.sndbuf.server 33554432 stats socket /run/haproxy.sock mode 600 level admin log /dev/stdout local0 debug defaults mode http maxconn 524288 timeout connect 5s timeout client 10s timeout server 120s timeout client-fin 1s timeout server-fin 1s timeout http-request 10s timeout http-keep-alive 50s default-server init-addr last,libc,none log 127.0.0.1:2514 len 8192 local1 notice emerg log 127.0.0.1:2514 len 8192 local7 info log-format '{<span class="hljs-string"><span class="hljs-string">"status"</span></span>:<span class="hljs-string"><span class="hljs-string">"%ST"</span></span>,<span class="hljs-string"><span class="hljs-string">"bytes_read"</span></span>:<span class="hljs-string"><span class="hljs-string">"%B"</span></span>,<span class="hljs-string"><span class="hljs-string">"bytes_uploaded"</span></span>:<span class="hljs-string"><span class="hljs-string">"%U"</span></span>,<span class="hljs-string"><span class="hljs-string">"hostname"</span></span>:<span class="hljs-string"><span class="hljs-string">"%H"</span></span>,<span class="hljs-string"><span class="hljs-string">"method"</span></span>:<span class="hljs-string"><span class="hljs-string">"%HM"</span></span>,<span class="hljs-string"><span class="hljs-string">"request_uri"</span></span>:<span class="hljs-string"><span class="hljs-string">"%HU"</span></span>,<span class="hljs-string"><span class="hljs-string">"handshake_time"</span></span>:<span class="hljs-string"><span class="hljs-string">"%Th"</span></span>,<span class="hljs-string"><span class="hljs-string">"request_idle_time"</span></span>:<span class="hljs-string"><span class="hljs-string">"%Ti"</span></span>,<span class="hljs-string"><span class="hljs-string">"request_time"</span></span>:<span class="hljs-string"><span class="hljs-string">"%TR"</span></span>,<span class="hljs-string"><span class="hljs-string">"response_time"</span></span>:<span class="hljs-string"><span class="hljs-string">"%Tr"</span></span>,<span class="hljs-string"><span class="hljs-string">"timestamp"</span></span>:<span class="hljs-string"><span class="hljs-string">"%Ts"</span></span>,<span class="hljs-string"><span class="hljs-string">"client_ip"</span></span>:<span class="hljs-string"><span class="hljs-string">"%ci"</span></span>,<span class="hljs-string"><span class="hljs-string">"client_port"</span></span>:<span class="hljs-string"><span class="hljs-string">"%cp"</span></span>,<span class="hljs-string"><span class="hljs-string">"frontend_port"</span></span>:<span class="hljs-string"><span class="hljs-string">"%fp"</span></span>,<span class="hljs-string"><span class="hljs-string">"http_request"</span></span>:<span class="hljs-string"><span class="hljs-string">"%r"</span></span>,<span class="hljs-string"><span class="hljs-string">"ssl_ciphers"</span></span>:<span class="hljs-string"><span class="hljs-string">"%sslc"</span></span>,<span class="hljs-string"><span class="hljs-string">"ssl_version"</span></span>:<span class="hljs-string"><span class="hljs-string">"%sslv"</span></span>,<span class="hljs-string"><span class="hljs-string">"date_time"</span></span>:<span class="hljs-string"><span class="hljs-string">"%t"</span></span>,<span class="hljs-string"><span class="hljs-string">"http_host"</span></span>:<span class="hljs-string"><span class="hljs-string">"%[capture.req.hdr(0)]"</span></span>,<span class="hljs-string"><span class="hljs-string">"http_referer"</span></span>:<span class="hljs-string"><span class="hljs-string">"%[capture.req.hdr(1)]"</span></span>,<span class="hljs-string"><span class="hljs-string">"http_user_agent"</span></span>:<span class="hljs-string"><span class="hljs-string">"%[capture.req.hdr(2)]"</span></span>}' frontend http bind *:80 http-request del-header X-Forwarded-For http-request del-header X-Forwarded-Port http-request del-header X-Forwarded-Proto capture request header Host len 32 capture request header Referer len 128 capture request header User-Agent len 128 acl host_present hdr(host) -m len gt 0 use_backend %[req.hdr(host),lower,field(1,'.')] if host_present default_backend default backend default mode http server no_server 127.0.0.1:65535 resolvers dns hold valid 1s timeout retry 100ms nameserver dns1 127.0.0.1:53</code> </pre><br></div></div><br> æ„Ÿè°¢é‚£äº›è¯»åˆ°æœ€åçš„äººã€‚ ä½†æ˜¯ï¼Œè¿™è¿˜ä¸æ˜¯å…¨éƒ¨ã€‚  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä¸‹æ¬¡ï¼Œ</a>æˆ‘ä»¬å°†ç ”ç©¶ä¸ä¼˜åŒ–ç³»ç»Ÿæœ¬èº«ç›¸å…³çš„ä½çº§äº‹ç‰©ï¼ŒHaproxyå¯ä»¥åœ¨å…¶ä¸­è¿›è¡Œå·¥ä½œï¼Œä»¥ä½¿å…¶ä¸ä»–çš„æ“ä½œç³»ç»Ÿé…åˆä½¿ç”¨ï¼Œå¹¶ä¸”æ¯ä¸ªäººéƒ½æœ‰è¶³å¤Ÿçš„åŠ¨åŠ›ã€‚ <br><br> å¾…ä¼šè§ï¼ </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN438966/">https://habr.com/ru/post/zh-CN438966/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN438956/index.html">ç‰™é½¿ä¸­çš„ç£ç‚ï¼šå£³è½¯ä½“åŠ¨ç‰©çš„ç»„ç»‡è½¬å½•ç»„æµ‹åº</a></li>
<li><a href="../zh-CN438958/index.html">ILVç¡®è®¤å…¶â€œç©ºé—´ç«™â€çš„å­˜åœ¨</a></li>
<li><a href="../zh-CN438960/index.html">åœ¨åç«¯å·¥ä½œæ—¶ï¼Œæˆ‘å¦‚ä½•æ”¾å¼ƒRubyå–è€Œä»£ä¹‹çš„æ˜¯Python</a></li>
<li><a href="../zh-CN438962/index.html">åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼ŒèŠ¯ç‰‡çš„æœªæ¥å‰æ™¯ä¹è§‚</a></li>
<li><a href="../zh-CN438964/index.html">è°çœŸæ­£èƒŒåæµè¡Œçš„å…è´¹VPNï¼Ÿ</a></li>
<li><a href="../zh-CN438968/index.html">ä¿„ç½—æ–¯çš„æ ‡å¿—é‹ï¼šå¸‚åœºå°šæœªå‡†å¤‡å°±ç»ªï¼Œä½†å¿…é¡»å¥æ•ˆ</a></li>
<li><a href="../zh-CN438970/index.html">æ®è¯´Haskellæ˜¯ä¸€ç§å¤©æ‰å’Œå­¦è€…çš„è¯­è¨€ã€‚ å¯¹ä¸å¯¹</a></li>
<li><a href="../zh-CN438972/index.html">ä»å†…éƒ¨å¤§è„‘ï¼ˆé€šè¿‡äººå·¥ç¥ç»ç½‘ç»œæ¨¡å‹å¯è§†åŒ–æ¨¡å¼çš„é€šè¿‡ï¼‰</a></li>
<li><a href="../zh-CN438974/index.html">è™šæ‹Ÿç°å®æœ‰åŠ©äºåº”å¯¹ç²¾ç¥ç–¾ç—…</a></li>
<li><a href="../zh-CN438976/index.html">ã€Šæ˜¥å¤©ã€‚ æ‰€æœ‰è®¾è®¡æ¨¡å¼Â»</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>