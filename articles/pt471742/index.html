<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏾‍💻 🧙🏿 🔆 Sberbank AI Journey. Como ensinamos uma rede neural a fazer um exame 🔤 😕 🛀🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Se você se formou no ensino médio no momento do USO, sabe que todas as tarefas nele têm um conjunto de formulações padrão e são classificadas por tipo...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Sberbank AI Journey. Como ensinamos uma rede neural a fazer um exame</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/sberbank/blog/471742/"><p>  Se você se formou no ensino médio no momento do USO, sabe que todas as tarefas nele têm um conjunto de formulações padrão e são classificadas por tipo.  Por um lado, isso facilita a preparação para o exame: o aluno já sabe o que fazer na tarefa sem sequer ler suas condições.  Por outro lado, qualquer alteração na ordem das perguntas pode causar problemas.  Grosso modo, o resultado começa a ser mais influenciado pelo quanto uma pessoa trouxe decisões para o automatismo, e não como ele reasones.  O exame se torna como um roteiro. </p><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/eec/665/ee2/eec665ee224a3d9f7a51029c5673ae52.jpg" alt="imagem" width="500" height="409"></div><br><p>  Como parte da <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">conferência AI Journey,</a> decidimos organizar uma competição para desenvolver um algoritmo que não passasse em um exame pior que uma pessoa.  Os participantes recebem versões de teste de tarefas que podem ser usadas para validar soluções e para treinamento.  Como funcionários do Sberbank, não podemos reivindicar um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">fundo de prêmios</a> , mas mesmo assim tentamos resolver esse problema e queremos conversar sobre como o fizemos.  Spoiler - certificado que recebemos. </p><br><a name="habracut"></a><br><p></p><h2>  Pouco de teoria </h2><br><p>  A aplicação de redes neurais a qualquer tarefa hoje já é uma história da série: "Nunca houve tal coisa, e aqui está novamente."  Mas a que novas tarefas de uma rede neural realmente devem ser aplicadas? </p><br><p>  Historicamente, os teóricos estabelecem as seguintes habilidades no conceito de Inteligência Geral Artificial: </p><br><p></p><ul><li>  tomada de decisão diante da incerteza </li><li>  auto-aprendizagem </li><li>  operando uma base de conhecimento sobre o mundo </li><li>  multidisciplinaridade, processamento conjunto de informações de diferentes fontes (texto, imagens, som) </li></ul><br><p>  A metáfora “cérebro como computador” determinou amplamente esses requisitos, e nenhum deles, exceto o treinamento, ainda não foi totalmente implementado pela IA ¯ \ <i>(ツ)</i> / ¯ <br>  Nos últimos anos, você pode observar as primeiras tentativas de criar sistemas mais complexos - por exemplo, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Aristo</a> , do Allen Institute, 90% completou o teste de conhecimentos gerais da oitava série. </p><br><p>  Há 27 tarefas no exame final no idioma russo, das quais 26 são tarefas com uma opção de resposta ou uma resposta aberta, nas quais você pode inserir sua própria versão, e a última é um ensaio sobre o texto.  Ou seja, a primeira tarefa é sempre sobre o significado do texto, a quarta - sobre a ênfase, a sétima - sobre erros de fala comuns, etc.  Essa tarefa coloca os sistemas de ML na situação de um “aluno do ensino médio”, onde você precisa obter um conjunto básico de habilidades e conhecimentos com antecedência e, em seguida, responder corretamente às perguntas usando-os. </p><br><p>  Para passar o idioma russo, o aluno deve: </p><br><ul><li>  Aprenda a escrever e falar corretamente, <br></li><li>  Aprenda a estruturar seus pensamentos <br></li><li>  entender as conexões lógicas no texto, conhecer o estilo, ortografia, ortografia, etc., <br></li><li>  leia uma lista impressionante de literatura, dos monumentos mais famosos da literatura russa antiga aos modernos e opere nas principais obras, enredos, problemas ou <s>amortizações</s> . <br></li></ul><br><p>  Sabendo que os métodos modernos de PNL ainda podem lidar com muitas dessas tarefas, decidimos experimentá-las. </p><br><p>  Todos os dados que recebemos são apresentados no formato json, padronizados e contêm uma redação e um texto claros nos quais você precisa concluir a tarefa; responda às opções, se elas forem fornecidas pela pergunta. </p><br><p><img src="https://habrastorage.org/webt/bm/54/v3/bm54v3hircrha2rhkfxkrmhftwi.png" width="767" height="298"></p><br><p>  <i>Captura de tela do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Yandex.Tutor</a></i> </p><br><p>  As perguntas nas tarefas são formuladas de maneira muito clara para a máquina - você precisa executar não apenas a tarefa - para encontrar erros no texto e corrigi-los, colocar as letras que faltam, encontrar frases que atendam às condições determinadas, mas também anote a resposta corretamente.  Pode ser a própria expressão com erro ou, inversamente, exemplos sem erros, número desses exemplos, número de sentenças em ordem crescente, etc.  E então nos lembramos do clássico: </p><br><blockquote><p>  Na arte de levantar questões, o legislador Goracek era um verdadeiro virtuoso.  Ele forçou os discípulos a listar ao contrário os dez mandamentos do Senhor ou exigiu: <br>  - Ludwik, responda rapidamente, vilão, que mandamento está em terceiro lugar no final, antes de "Não matar"? <br>  <i>Yaroslav Hasek, “A lição da lei de Deus”</i> </p></blockquote><br><h2>  Como lidamos com isso na linha de base? </h2><br><p>  Resposta: <s>¡ɯǝɓn̯ɔ ʞɐɯ e</s> </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/1b3/73c/1d3/1b373c1d365bc0394e7125939f255e37.jpg" width="700" height="459"></p><br><p>  Como não existem mais de 27 tipos de tarefas, nos dados de treinamento, criamos um analisador json que seleciona as palavras exatas de todo o texto da tarefa - o que e como fazer - e criamos nessas formulações o classificador linear mais simples em n-gramas de palavras e SVM (máquinas de vetores de suporte), que previam o número do trabalho e o sistema recebeu o formato de trabalho e resposta: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">https://github.com/sberbank-ai/ai-journey-2019</a> . </p><br><p>  Potencialmente, eu gostaria de implementar um mecanismo de atenção ou algo semelhante nesta parte da solução, a fim de encontrar conexões entre formulações e tipos de perguntas.  Esperamos que um dos participantes implemente essa solução. </p><br><br><h2>  Avaliação da Decisão </h2><br><p>  Ao avaliar essa solução, para comparação com uma pessoa, as métricas de classificação usuais (precisão, f-measure.) Não são usadas, mas é feita uma <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">escala de classificação de 100 pontos</a> , onde são resumidos os pontos para as tarefas concluídas corretamente. </p><br><p>  As soluções de problemas são verificadas automaticamente e o que fazer com o ensaio final?  Professores e metodologistas de Moscou e Novosibirsk participam da avaliação de ensaios no âmbito da competição.  Eles avaliam os ensaios coletados de acordo com critérios independentes, incluindo ortografia, pontuação, coerência lógica do texto, presença de argumentos literários e posição do autor.  Em geral, tudo é como na escola. </p><br><h1>  Design da linha de base </h1><br><p>  Após implementar o analisador json e o classificador de perguntas, recebemos tipos específicos de tarefas.  Eles se resumem a esta lista: </p><br><ul><li>  verificar ortografia, inserir letras, corrigir erros (H e HH, NOT e NI, juntos - separadamente, raízes com alternância, etc.); <br></li><li>  entender no contexto o significado de uma palavra com vários valores (escolha da resposta no contexto); <br></li><li>  destacar as principais reflexões do texto (seleção de uma lista de frases); <br></li><li>  colocar sinais de pontuação (selecione locais onde vírgulas, traços, etc. são necessários); <br></li><li>  enfatize palavras (encontre um erro); <br></li><li>  encontre erros gramaticais nos exemplos e indique seu tipo (correlato); <br></li><li>  anular alianças entre partes do texto (com base na lógica do texto); <br></li><li>  escrevendo um ensaio sobre o texto (encontre o problema e revele-o). <br></li></ul><br><p>  Usando o método de peering adicional, reduzimos todos os tipos de tarefas para métodos de processamento de texto conhecidos. </p><br>  <b>Embedders</b> <br><p>  Os incorporadores (word2vec, fasttext, GloVe) são usados ​​para obter representações vetoriais de palavras, frases e textos individuais.  Usamos o <b>BERT</b> no pytorch - um transformador universal, usado com mais frequência para obter as propriedades das palavras (do Google).  Esse transformador fornece um alto resultado em tarefas nas quais você precisa entender o significado de uma palavra com vários valores, destacar as frases mais significativas no texto etc.  - as tarefas são reduzidas à escolha da incorporação mais próxima por medida de cosseno. </p><br>  <b>Modelos de linguagem</b> <br><p>  Os modelos de linguagem podem fornecer informações úteis sobre a probabilidade da próxima palavra, multiplicação de sentenças.  Em conjunto com os exames, eles podem ser usados ​​para detectar e corrigir erros de fala (substituir fragmentos que não sejam de frequência por fragmentos de frequência semelhantes) e gerar textos.  Basicamente, usamos a base de frequência do n-grama do corpus nacional do idioma russo, escolhendo palavras normativas e os ausentes foram considerados candidatos a erro.  Também usamos essa base para substituir as letras que faltam em palavras.  Para gerar os textos dos ensaios, também adotamos o “modelo universal” - <b>ULMFit</b> .  Este é o LSTM de abandono múltiplo do fast.ai, muito bom para gerar sequências.  Nós a treinamos em ensaios escolares sobre literatura, que coletamos on-line.  Acabou sendo inútil, mas quase sem erros. </p><br>  <b>Analisadores de morfologia e sintaxe</b> <br><p>  Para determinar a parte da fala, casos, número, sexo, forma normal da palavra e as conexões entre as palavras, utilizamos pymorphy2 e UDPipe. </p><br>  <b>Classificadores</b> <br><p>  As tarefas de pontuação podem ser reduzidas à classificação - coloque uma vírgula em um local específico ou não, de acordo com qual regra um traço é definido etc. </p><br><p>  Resolvemos dois tipos de tarefas com os seguintes tipos de arquiteturas: </p><br><p>  <b>A rede neural siamesa</b> recebe duas entradas BERT de um par de sentenças na entrada, decide se traços, dois pontos ou não são definidos de acordo com uma regra. </p><br><p>  O <b>classificador CatBoost</b> recebe uma janela de entrada para as tags de uma parte do discurso de comprimento 6 (no formato “ <b>NOUN VERBO NOUN ADJ NOUN NOUN</b> ”) e decide se deve ou não colocar uma vírgula no meio. </p><br>  <b>Bases de conhecimento</b> <br><p>  O que os alunos precisam lembrar e aprender, coletamos de fontes abertas: </p><br><p>  1 Dicionário Orthoepic (stress) - como no currículo escolar. </p><br><p>  2 Dicionário de tropos - meios literários: sinônimos, antônimos, parônimos, unidades fraseológicas, etc., coletados em sites da literatura. </p><br><p>  3 Coleção de ensaios escolares sobre literatura - para a educação continuada do modelo generativo. </p><br>  <b>Modelos de composição</b> <br><p>  Geração de texto, sumarização, modelagem temática.  Aqui o escopo para o pensamento foi ótimo.  No final, adotamos, como já mencionado, o ULMFit para gerar texto.  Mas o ensaio deve estar no texto e atender a muitos critérios.  Se considerarmos que temos ortografia e coerência do texto devido ao ULMFit, pelo menos a posição do autor e a coerência temática do nosso trabalho e este texto permanecem. </p><br><br><p>  Resolvemos essas subtarefas da seguinte maneira: </p><br><ul><li>  <b>LDA + preparou a primeira frase</b> .  As versões coletadas dos ensaios escolares são agrupadas com base na palavra n-grama em 30 tópicos que interpretamos.  Cada um dos tópicos mostrou-se relacionado ao trabalho de um ou dois escritores sobre um tópico relacionado - obras sobre o destino da Rússia, sobre a situação do povo, sobre as obras de Dostoiévski, sobre o trabalho de A. Akhmatova e seu significado para a cultura russa do século XX, etc. <br></li><li>  <b>Modelos TextRank +</b> .  O algoritmo de resumo seleciona as 2-3 frases mais significativas do texto fornecido e essas frases são inseridas em um conjunto de modelos que enquadram aspas com a posição do autor. <br></li></ul><br><p>  Pipeline final: o modelo temático determina o tópico do texto e dá a primeira frase ao modelo generativo.  O modelo generativo recebe a primeira frase e continua até o final da composição.  Em seguida, o modelo de resumo insere um segundo parágrafo neste texto, que reflete a posição do autor. </p><br><p>  Aqui está um exemplo de uma composição típica que obtivemos nesse modelo (os modelos estão em itálico, a primeira frase do modelo temático está em negrito). </p><br><blockquote>  <b>O destino do homem na guerra, o amor de sua terra natal, seu amor por sua mãe são temas de interesse de Tolstoi</b> , aqueles que o deixaram.  e dois príncipes Andrei Tolstoi - Pierre e Andrei - passaram pela guerra.  As más relações humanas também não estão em seu curso, mas na vida, em padrões civis e morais.  A liberdade reside no fato de serem uma pessoa gentil e terrível, uma sensação de abertura e traição.  Eles são a liberdade - de Deus - para Napoleão, para ele - Napoleão.  Traz a eles o bem e o mal, de modo que grandes heróis compõem o que são representantes das mesmas pessoas. <br><br>  <i>O autor ilustra esse problema com o exemplo das frases</i> "Quando digo que uma pessoa não deve contrariar sua consciência, não deve fazer um acordo com ela, não quero dizer de forma alguma que uma pessoa não possa ou não cometa erros, tropeçar".  e "respondi que não é apenas possível, mas também necessário escrever sobre os erros de grandes pessoas, que um homem é ótimo não porque não se enganou em nada".  <i>Na minha opinião, o leitor observa a posição do autor na frase:</i> "Mas mesmo se você não preservou a honra de sua juventude, você pode e deve recuperá-la na idade adulta, se quebrar, encontrar coragem e coragem para admitir erros". <br><br>  A guerra é a parte da personalidade que deve dar a uma pessoa a possibilidade de outro serviço universal.  O futuro é a libertação, o desejo de liberdade, um amor ardente pela pátria.  Esta é uma crença na possibilidade da Pátria.  Podemos dizer que, apesar do cristianismo, Pierre não pode atrapalhar o curso da história, mas ele o fez de fato.  A guerra de 1812 Tolstoi mostra como a luta do novo Napoleão com um ambiente folclórico simples e com o povo. <br><br>  Estamos diante de toda a Rússia e Novgorod faz parte da Rússia.  A idéia principal que ele tem é a conexão do povo russo com a natureza.  O romance de Tolstoi, "Guerra e Paz", é um trabalho em que os problemas sociais estão intimamente relacionados, a vida consiste no fato de que vozes, bem e mal - tudo isso não esconde Tolstoi.  Dostoiévski escreveu que para Tolstói essa é uma posição política.  O autor coloca seu lugar no romance: aqui o escritor mostra pessoas que estão por trás dos muros da pátria.  Tolstoi dá um exemplo disso e dá um exemplo do primeiro e do personagem principal. </blockquote><br><h2>  A arquitetura de linha de base resultante </h2><br><p>  A <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">solução</a> final tem a seguinte lógica: </p><br><p></p><ol><li>  O trabalho recebido é digitado pelo classificador - ele obtém um tipo de 1 a 27. </li><li>  Cada uma das 27 tarefas possui seu próprio solucionador - um script com análise de formulações de tarefas, que recebe as informações necessárias do pool de modelos de ML disponíveis e bases de conhecimento e emite a resposta no formato correto. </li></ol><br><p>  O conjunto de modelos e bases de conhecimento para todos os solucionadores é comum, ele é carregado na memória uma vez. </p><br><p><img src="https://habrastorage.org/webt/8q/hs/vi/8qhsviepecj-hpolp9vj3yvxcc4.png"></p><br><h2>  Qual é o resultado? </h2><br><p>  A linha de base (até agora sem verificação de ensaio) fornece 27 pontos em 100 - mais de 60 equipes aproveitaram a solução básica.  De acordo com os critérios do exame final, para obter um certificado, você precisa marcar 24, mas para enviar documentos para a universidade, você precisa de um mínimo de 36 pontos.  Esta marca passou agora pelas 2 melhores equipes. </p><br><img src="https://habrastorage.org/webt/w0/ye/qu/w0yequyyccr1jtemrms-gri4cmw.png"><br><br><p>  Muitos participantes usam nossa solução como uma abordagem básica, melhorando e refinando.  Se você está interessado em inteligência artificial e está pronto para tentar uma tarefa tão interessante, terá mais algumas semanas!  E nós mesmos continuamos a melhorar os modelos, saindo da competição <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">com o apelido CDS_team</a> </p><br><p>  A final da competição será realizada nos dias 8 e 9 de novembro na conferência AI Journey, em Moscou.  Registre-se para a competição e a conferência <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> . <br><br></p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt471742/">https://habr.com/ru/post/pt471742/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt471726/index.html">Método moderno para medir a resposta ao impulso e distorção não linear</a></li>
<li><a href="../pt471728/index.html">Avalonia meus prós e contras</a></li>
<li><a href="../pt471736/index.html">Sensor Ethernet sem contato</a></li>
<li><a href="../pt471738/index.html">Uma pequena história sobre como a conveniência às vezes dispara no joelho</a></li>
<li><a href="../pt471740/index.html">Serviço de cache inteligente baseado em ZeroMQ e Tarantool</a></li>
<li><a href="../pt471744/index.html">Tarantool Data Grid: arquitetura e recursos</a></li>
<li><a href="../pt471746/index.html">Guia completo para a configuração de cabeçalhos HTTP para segurança</a></li>
<li><a href="../pt471748/index.html">Otimização de farmácia: o que fizemos com a matemática</a></li>
<li><a href="../pt471750/index.html">Gerenciamento de acesso privilegiado como uma tarefa prioritária em segurança da informação (por exemplo, Fudo PAM)</a></li>
<li><a href="../pt471756/index.html">Como o servidor inicia</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>