<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>  锔 Operaci贸n "Migraci贸n": c贸mo se mueve a la nube de DataLine   </title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hace aproximadamente 7 a帽os, los primeros proyectos se trasladaron a nuestra nube de manera simple y sin pretensiones. Las im谩genes de las m谩quinas vi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Operaci贸n "Migraci贸n": c贸mo se mueve a la nube de DataLine</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/dataline/blog/476828/">  Hace aproximadamente 7 a帽os, los primeros proyectos se trasladaron a nuestra nube de manera simple y sin pretensiones.  Las im谩genes de las m谩quinas virtuales se cargaron en un servidor FTP, o se llevaron a los discos duros.  Luego, a trav茅s de un servidor de importaci贸n especial, las m谩quinas virtuales se cargaron en la nube. <br><br>  Si no es un problema para el cliente apagar la m谩quina virtual durante un d铆a o dos (o no otras opciones), entonces es posible.  Pero si el tiempo de inactividad es de un m谩ximo de una hora, entonces este m茅todo no funcionar谩.  Hoy les dir茅 qu茅 herramientas lo ayudar谩n a migrar a la nube con un tiempo de inactividad m铆nimo y c贸mo funciona el proceso de migraci贸n con nosotros. <br><br><img src="https://habrastorage.org/webt/5x/cx/dg/5xcxdguftiv1yk7grwcbj7fmf4q.jpeg"><br><a name="habracut"></a><br><h3>  Migraci贸n con Veeam Backup and Replication </h3><br>  Todos conocen Veeam Backup and Replication como una herramienta para crear copias de seguridad y r茅plicas.  Lo usamos para la migraci贸n entre nuestros sitios y para transportar clientes con virtualizaci贸n privada a nuestra nube.  Las m谩quinas virtuales del cliente se replican en nuestro vCenter, despu茅s de lo cual el ingeniero las agrega a vCloud Director. <br><br>  La replicaci贸n primaria se realiza en una m谩quina virtual habilitada.  A la hora acordada, la m谩quina en el lado del cliente se apaga.  La replicaci贸n comienza nuevamente para transferir los cambios que ocurrieron desde la primera replicaci贸n.  Despu茅s de eso, la m谩quina virtual comienza ya en nuestra nube. <br><br><img src="https://habrastorage.org/webt/mn/us/t0/mnust0ek7ckllt7afy8kty-y_qa.png"><br><br>  Por lo general, desde el momento en que la m谩quina se apaga en la infraestructura del cliente y hasta el momento en que se enciende, no pasa m谩s de media hora, sino m谩s bien 15-20 minutos, en nuestra nube. <br><br>  Al mismo tiempo, la m谩quina virtual original permanece en el sitio del cliente.  Si de repente algo sale mal, siempre puede retroceder y encenderlo.  Para el cliente, este m茅todo tambi茅n es conveniente porque no requiere Veeam de 茅l. <br><br>  <i>Caso 1</i> <i><br></i>  <i>El cliente ten铆a su propia infraestructura virtual basada en VMware: 40 m谩quinas virtuales con una capacidad de 30 Tb.</i>  <i>El equipo en el que se implement贸 el cl煤ster ya est谩 desactualizado, y el cliente decidi贸 no involucrarse en la compra de uno nuevo y pasar a una nube p煤blica.</i>  <i>El requisito de tiempo de inactividad de los sistemas cr铆ticos no era m谩s de una hora.</i>  <i>Veeam Replication fue elegido como herramienta.</i>  <i>La ventaja tambi茅n fue que el proveedor de Internet del cliente estaba presente en nuestro centro de datos, lo que nos permiti贸 organizar un buen canal.</i>  <i>La migraci贸n tom贸 aproximadamente un mes, mientras que el cambio fue simple, tom贸 hasta 30 minutos para un grupo de m谩quinas virtuales.</i> <br><br><h3>  Migre con Veeam Cloud Connect </h3><br>  Veeam Cloud Connect es una herramienta que lo ayuda a configurar la replicaci贸n de m谩quinas virtuales y ejecutar r茅plicas en la nube del proveedor de servicios.  Despu茅s de la actualizaci贸n en <a href="https://habr.com/ru/company/dataline/blog/436086/">2019</a> , se hizo posible replicar m谩quinas virtuales directamente en vCloud Director.  La 煤nica condici贸n es que en el lado del cliente, su Veeam Backup and Replication debe implementarse al menos en la versi贸n 9. En resumen (una versi贸n detallada est谩 <a href="https://habr.com/ru/company/dataline/blog/308984/">aqu铆</a> ), todo el proceso es el siguiente. <br><br>  VCloud Director crea una organizaci贸n con los recursos y redes necesarios.  En Veeam Cloud Connect, creamos una cuenta, el cliente se conecta a ella desde nuestro Veeam B&amp;R, selecciona el proveedor y la organizaci贸n de DataLine, y configura tareas para la replicaci贸n.  Adem谩s del hecho de que durante dicha migraci贸n, el tiempo de inactividad ser谩 de 15 a 20 minutos, el cliente no depende del soporte t茅cnico del proveedor y gestiona todo el proceso de forma independiente: crea tareas de replicaci贸n, replicaci贸n en s铆, apaga las m谩quinas y comienza su inicio en un nuevo sitio. <br><br><img src="https://habrastorage.org/webt/g7/bm/j9/g7bmj9ziorp-bxksjcep9s73kfw.png"><br><br>  <i>Caso 2</i> <i><br></i>  <i>La infraestructura del cliente desde donde se planific贸 la migraci贸n estaba ubicada en Bielorrusia.</i>  <i>Era necesario transportar 90 m谩quinas virtuales con un volumen total de 27 TB, a pesar de que el canal de Internet era de 100 Mbps.</i>  <i>Si realiza una copia de seguridad e inmediatamente la carga en nuestra nube, entonces, para algunas m谩quinas virtuales, esto tomar铆a varios d铆as.</i>  <i>Durante este tiempo, un gran delta crecer铆a en la VM, y esto ya podr铆a afectar negativamente el rendimiento de las m谩quinas o, peor a煤n, el lugar en el almac茅n de datos se agot贸.</i>  <i>Actuaron de la siguiente manera: primero, el cliente realiz贸 una copia de seguridad completa local y nos transfiri贸 una copia de la misma en la nube a trav茅s de Veeam Cloud Connect.</i>  <i>Luego hizo y arroj贸 el incremento a la nube.</i>  <i>La m谩quina virtual original continu贸 funcionando.</i>  <i>Despu茅s de apagar la VM, el cliente realiz贸 otro incremento y tambi茅n lo transfiri贸 a la nube.</i>  <i>De nuestro lado, implementamos una m谩quina virtual desde una copia de seguridad completa, y luego lanzamos dos incrementos sobre ella.</i>  <i>Tal esquema nos permiti贸 minimizar el tiempo de inactividad a 2 horas al cambiar a nuestro sitio.</i> <br><br><h3>  Migraci贸n con VMware vCloud Availability </h3><br>  En marzo de este a帽o, VMware lanz贸 vCloud Availability 3.0, que permite que las m谩quinas virtuales migren entre diferentes nubes (vCloud Director - vCloud Director) y desde soportes de virtualizaci贸n de clientes privados a la nube (vCenter - vCloud Director).  La conveniencia principal es la integraci贸n con la interfaz de vCloud Director.  Esto simplifica enormemente la gesti贸n de la replicaci贸n y minimiza el tiempo de inactividad al cambiar. <br><br>  Con esta herramienta, migramos a uno de los clientes de nuestra nube de Mosc煤 a nuestra nube en San Petersburgo.  Era necesario transportar 18 m谩quinas virtuales con una capacidad total de 14 TB.  Para el cliente, se cre贸 una organizaci贸n en la nube de San Petersburgo y se organizaron las redes necesarias.  Luego, desde la interfaz de vCloud Director, el cliente cambi贸 a la configuraci贸n de Disponibilidad de vCloud, cre贸 tareas de replicaci贸n y cambi贸 al sitio de San Petersburgo en un momento conveniente.  El tiempo de inactividad al cambiar fue de 12 minutos. <br><br><img src="https://habrastorage.org/webt/3p/v8/9b/3pv89bdu2lsktkf8kcjg3tikqme.png"><br>  <i>El esquema de migraci贸n entre las nubes DataLine en San Petersburgo y Mosc煤.</i> <br><br>  VCloud Availability tiene un mecanismo para migrar m谩quinas virtuales de un sitio cliente a nuestra nube.  Para hacer esto, se implementa una aplicaci贸n especial de vCloud Availability en el cliente vCenter.  Despu茅s de una configuraci贸n simple, est谩 conectado a la nube y se configuran las tareas de migraci贸n.  El cliente tambi茅n gestiona de forma independiente todo el proceso, y el tiempo de migraci贸n se minimiza. <br><br><img src="https://habrastorage.org/webt/qe/0h/xg/qe0hxg2qd306tw-ismqzsvuftue.png"><br>  <i>Un diagrama de la migraci贸n de m谩quinas virtuales desde una instalaci贸n privada a la nube.</i> <br><br>  VMware vCloud Availability tiene muchos otros casos de uso; pronto hablaremos de ellos en otro art铆culo. <br><br><h3>  Prepar谩ndose para la migraci贸n </h3><br>  Para seleccionar una herramienta y continuar con la migraci贸n, debe decidir sobre los siguientes puntos: <br><br>  <b>驴De d贸nde estamos migrando?</b>  Si est谩 migrando desde una soluci贸n privada, tiene total libertad para elegir herramientas.  Si se muda del proveedor, entonces es m谩s dif铆cil.  Lo m谩s probable es que la conexi贸n de la infraestructura de los dos proveedores y simplemente arrastrar la VM falle por razones de seguridad.  A veces, el proveedor, que el cliente va a rechazar, comienza a ser completamente da帽ino y lleva tiempo.  Puede dejar el proveedor a la antigua usanza: cargando la VM en discos y FTP o migrando a nivel de aplicaci贸n.  El nombre de este 煤ltimo es arbitrario, y se parece a esto. <br><br>  <i>Caso 3</i> <i><br></i>  <i>Era necesario migrar el sistema SAP del cliente desde un proveedor europeo: 34 m谩quinas virtuales con un volumen de 54 Tb.</i>  <i>Se asignaron recursos al cliente en nuestra nube.</i>  <i>Entre nosotros y la infraestructura del proveedor europeo se organiz贸 la conectividad de red.</i>  <i>Los servidores de aplicaciones se volvieron a implementar, con la acumulaci贸n de las configuraciones necesarias.</i>  <i>Grandes bases de datos migraron mediante la carga de copias de seguridad en nuestra nube.</i>  <i>Luego, se configur贸 la replicaci贸n entre las bases de datos en nuestro sitio y el sitio fuente.</i>  <i>A la hora acordada, cambiamos a las bases de datos en nuestra nube.</i> <br><br>  <b>La cantidad de datos y el canal de Internet.</b>  Por lo general, le pedimos al cliente que proporcione la descarga en los sistemas con par谩metros de memoria, CPU, discos.  Estimamos si el canal es suficiente para enviar directamente r茅plicas o copias de seguridad de m谩quinas virtuales. <br><br>  <b>V谩lido simple.</b>  Para diferentes sistemas y, en consecuencia, m谩quinas virtuales, puede ser diferente dependiendo de su criticidad para el negocio.  Por lo general, un cliente viene con requisitos listos para el tiempo de inactividad durante la migraci贸n, y en base a esto elegimos la herramienta y el plan de migraci贸n correctos.  Intentamos planificar el cambio final a noche o fin de semana, de modo que incluso un ligero tiempo de inactividad no sea perceptible para los usuarios finales del cliente. <br><br>  Seg煤n estos datos, puede elegir una herramienta y continuar con la migraci贸n en s铆.  Esto es lo que pasa despu茅s. <br><br><ol><li>  <b>Configuraci贸n de conectividad de red.</b>  Organizamos la conectividad de red entre nuestra nube y la infraestructura del cliente.  Las m谩quinas virtuales se copiar谩n a trav茅s de esta red.  Si se usa Veeam Backup and Replication, este es un canal dedicado, menos com煤nmente un canal VPN.  Si Veeam Cloud Connect, entonces todo pasa por Internet o el mismo canal dedicado. <br><br>  Luego, la red se configura para la VM en la nube.  Los autom贸viles generalmente se mueven en grupos y m谩s de un d铆a.  Despu茅s de que las m谩quinas virtuales nos fueron transferidas y lanzadas, deber铆an interactuar con las m谩quinas que a煤n permanecen en el sitio de inicio. </li><li>  <b>Calendario de migraciones.</b>  Cuando hay muchos autom贸viles, es razonable dividirlos en grupos y transportarlos en lotes.  Junto con el cliente, acordamos un plan en el que prescribimos cu谩ndo y qu茅 m谩quinas se mueven y cu谩ndo se realizar谩 la replicaci贸n final y el cambio a un nuevo sitio. </li><li>  <b>Prueba de migraci贸n.</b>  Migramos la m谩quina virtual de prueba y verificamos si todo est谩 configurado correctamente: conectividad de red entre sitios, la disponibilidad de la m谩quina virtual para m谩quinas en el sitio de origen, derechos de cuenta y m谩s.  Tal prueba ayuda a evitar problemas durante la etapa de migraci贸n de combate. </li></ol><br>  Eso es todo para m铆.  Haga preguntas en los comentarios y hable sobre su experiencia de migraci贸n. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/476828/">https://habr.com/ru/post/476828/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../476806/index.html">MPS 2019.2: tipos de datos enumerados, personalizaci贸n de mensajes de error, transici贸n a JDK 11 y mucho m谩s</a></li>
<li><a href="../476812/index.html">Notas sobre todo. Fuentes de alimentaci贸n simples y peligrosas</a></li>
<li><a href="../476816/index.html">Dubai Mall en un tel茅fono inteligente, o c贸mo agregar un plano de un edificio a su aplicaci贸n</a></li>
<li><a href="../476824/index.html">McKinsey: repensar la arquitectura de software y electr贸nica en automoci贸n</a></li>
<li><a href="../476826/index.html">Experimentos m煤ltiples: teor铆a y pr谩ctica</a></li>
<li><a href="../476830/index.html">驴C贸mo implementar las funciones de la utilidad de JavaScript usando Reducir?</a></li>
<li><a href="../476834/index.html">Red Hat OpenShift 4.2: Nuevas herramientas</a></li>
<li><a href="../476838/index.html">C贸mo atrapar la luz con espuma: red de espuma-fotones</a></li>
<li><a href="../476842/index.html">C贸mo construir un sistema efectivo de atenci贸n al cliente</a></li>
<li><a href="../476844/index.html">Espec铆fico y global: programa Mobius 2019 Mosc煤</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>