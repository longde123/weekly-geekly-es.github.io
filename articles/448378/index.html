<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üñçÔ∏è üëå üíô Seguridad DHCP en Windows 10: Explorando la vulnerabilidad cr√≠tica CVE-2019-0726 ‚úçüèæ üë©‚Äç‚úàÔ∏è üèÇüèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Imagen: Pexels 

 Con el lanzamiento de las actualizaciones de enero para Windows, la noticia de la vulnerabilidad cr√≠ticamente peligrosa CVE-2019-054...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Seguridad DHCP en Windows 10: Explorando la vulnerabilidad cr√≠tica CVE-2019-0726</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pt/blog/448378/"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><img src="https://habrastorage.org/webt/sw/gb/5n/swgb5nnwlka74q3klyp10gk-ofu.jpeg"></a> <br><br>  <i>Imagen: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Pexels</a></i> <br><br>  Con el lanzamiento de las actualizaciones de enero para Windows, la noticia de la vulnerabilidad cr√≠ticamente peligrosa <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">CVE-2019-0547</a> en clientes DHCP <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">conmovi√≥</a> al p√∫blico.  La alta calificaci√≥n de CVSS y el hecho de que Microsoft no public√≥ inmediatamente una evaluaci√≥n de desempe√±o, lo que dificult√≥ a los usuarios decidir sobre una actualizaci√≥n urgente del sistema, despert√≥ el inter√©s.  Algunas publicaciones incluso sugirieron que la falta de un √≠ndice puede interpretarse como evidencia de que un exploit funcional aparecer√° en el futuro cercano. <a name="habracut"></a><br><br>  Soluciones como <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">MaxPatrol 8</a> pueden identificar computadoras en la red que son vulnerables a ataques espec√≠ficos.  Otras soluciones, como PT NAD, detectan tales ataques por s√≠ mismos.  Para que esto sea posible, es necesario describir tanto las reglas para detectar vulnerabilidades en los productos como las reglas para detectar ataques en estos productos.  A su vez, para que esto sea posible, es necesario que cada vulnerabilidad individual descubra el vector, el m√©todo y las condiciones de su operaci√≥n, es decir, literalmente todos los detalles y matices asociados con la operaci√≥n.  Se requiere una comprensi√≥n mucho m√°s completa y profunda de lo que generalmente se puede compilar a partir de descripciones en sitios de proveedores o en CVE, tales como: <br><br><blockquote>  La vulnerabilidad se manifiesta porque el sistema operativo procesa incorrectamente los objetos en la memoria. </blockquote><br>  Por lo tanto, para agregar a los productos de la compa√±√≠a las reglas para detectar ataques a una vulnerabilidad reci√©n creada en DHCP, as√≠ como las reglas para identificar los dispositivos afectados por ella, debe comprender los detalles.  En el caso de las vulnerabilidades binarias, patch-diff se usa a menudo para obtener informaci√≥n sobre los errores subyacentes, es decir, una comparaci√≥n de los cambios realizados en el c√≥digo binario de una aplicaci√≥n, biblioteca o n√∫cleo del sistema operativo con un parche espec√≠fico, una actualizaci√≥n que corrige este error.  Pero la primera etapa es siempre el reconocimiento. <br><br>  <b>Nota</b> : <i>Para ir directamente a la descripci√≥n de la vulnerabilidad, omitiendo los conceptos DHCP subyacentes, puede omitir las primeras p√°ginas e ir directamente a la secci√≥n "Funci√≥n DecodeDomainSearchListData".</i> <br><br><h2>  Reconocimiento </h2><br>  Pasamos al motor de b√∫squeda y vemos todos los detalles de vulnerabilidad conocidos actualmente.  Esta vez hay un m√≠nimo de detalles, y todos ellos son procesiones gratuitas de la informaci√≥n recopilada de la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">publicaci√≥n original</a> en el sitio web de MSRC.  Esta situaci√≥n es bastante t√≠pica para los errores descubiertos por Microsoft durante una auditor√≠a interna. <br><br>  En la publicaci√≥n, descubrimos que nos enfrentamos a una vulnerabilidad de corrupci√≥n de memoria, que est√° contenida en los sistemas cliente y servidor de Windows 10 versi√≥n 1803 y aparece en el momento en que un atacante env√≠a respuestas especialmente dise√±adas a un cliente DHCP.  Despu√©s de un par de d√≠as a partir de ese momento en la p√°gina, tambi√©n aparecer√°n los √≠ndices de rendimiento: <br><br><img src="https://habrastorage.org/webt/oi/kr/ha/oikrhaavmkrvqdgzpfxqp4oquiy.png"><br><br>  Como puede ver, MSRC calific√≥ "2 - Explotaci√≥n menos probable".  Esto significa que un error con una alta probabilidad no es operacional en absoluto, o la operaci√≥n est√° llena de dificultades, cuya superaci√≥n requerir√° costos laborales demasiado altos.  Es cierto que Microsoft no tiende a subestimar tales estimaciones.  Esto est√° en parte influenciado por el riesgo de p√©rdida de reputaci√≥n, y en parte por cierta independencia del centro de respuesta dentro de la empresa.  Por lo tanto, suponga: dado que la amenaza de explotaci√≥n se indica en el informe como poco probable, ciertamente lo es.  En realidad, esto podr√≠a haber completado el an√°lisis, pero no ser√≠a superfluo verificar dos veces y al menos descubrir cu√°l era la vulnerabilidad.  En √∫ltima instancia, a pesar de toda la personalidad innegable, los errores tienden a repetirse y manifestarse en otros lugares. <br><br>  Desde la misma p√°gina, descargamos el parche (actualizaci√≥n de seguridad) provisto en forma de archivo .msu, lo desempaquetamos y buscamos los archivos relacionados con el procesamiento de las respuestas de DHCP en el lado del cliente.  Recientemente, se ha vuelto mucho m√°s dif√≠cil hacer esto, ya que las actualizaciones comenzaron a entregarse no en forma de paquetes separados que corrigen errores espec√≠ficos, sino como un √∫nico paquete acumulativo que incluye todas las correcciones mensuales.  Esto aument√≥ en gran medida el exceso de ruido, es decir, los cambios no relacionados con nuestra tarea. <br><br>  Entre todo el conjunto de archivos, la b√∫squeda encuentra varias bibliotecas adecuadas para el filtro, que comparamos con sus versiones en un sistema no parcheado.  La biblioteca dhcpcore.dll parece la m√°s prometedora.  En este caso, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">BinDiff</a> produce cambios m√≠nimos: <br><br> <a href=""><img src="https://habrastorage.org/webt/vr/ml/oe/vrmloeuvnuyeqib2f8rarowqnri.png"></a> <br><br>  En realidad, aparte de los cambios cosm√©ticos realizados en una sola funci√≥n: DecodeDomainSearchListData.  Si conoce bien el protocolo DHCP y sus opciones que no se utilizan con demasiada frecuencia, puede suponer que esta funci√≥n procesa la lista.  De lo contrario, pase a la segunda etapa: el estudio del protocolo. <br><br><h2>  DHCP y sus opciones </h2><br>  DHCP ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">RFC 2131</a> | <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">wiki</a> ) es un protocolo extensible cuyas capacidades de reposici√≥n son proporcionadas por el campo de opciones.  Cada opci√≥n se describe mediante una etiqueta √∫nica (n√∫mero, identificador), el tama√±o ocupado por los datos contenidos en la opci√≥n y los datos en s√≠.  Esta pr√°ctica es t√≠pica de los protocolos de red, y una de las opciones "implantadas" en el protocolo es la Opci√≥n de b√∫squeda de dominio descrita en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">RFC 3397</a> .  Permite al servidor DHCP establecer las terminaciones de nombre de dominio est√°ndar en los clientes, que se utilizar√°n como sufijos DNS para la conexi√≥n configurada de esta manera. <br><br>  Supongamos, por ejemplo, las siguientes terminaciones de nombre establecidas en nuestro cliente: <br><br><pre><code class="bash hljs">.microsoft.com .wikipedia.org</code> </pre> <br><img src="https://habrastorage.org/webt/_a/7o/ag/_a7oag6njc0p-kdww7o32ggatxc.png"><br><br>  Luego, en cualquier intento de determinar la direcci√≥n por el nombre de dominio, las consultas de DNS sustituir√°n los sufijos de esta lista hasta que se encuentre una asignaci√≥n exitosa.  Por ejemplo, si el usuario ingres√≥ ru en la barra de direcciones del navegador, las consultas DNS se generar√°n primero para ru.microsoft.com, luego para ru.wikipedia.org: <br><br><img src="https://habrastorage.org/webt/qu/8v/kz/qu8vkzddg_pkqvt1o4dwstz2eho.png"><br><br>  De hecho, los navegadores modernos son demasiado inteligentes y, por lo tanto, responden a los redireccionamientos al motor de b√∫squeda a nombres que no son similares al FQDN.  Por lo tanto, a continuaci√≥n adjuntamos la conclusi√≥n de utilidades menos estropeadas: <br><br><img src="https://habrastorage.org/webt/ke/tq/f3/ketqf3pyckb-rp2en-dygbswtrq.png"><br><br>  Puede parecerle al lector que esta es la vulnerabilidad, porque la capacidad de sustituir sufijos DNS usando un servidor DHCP, con el que cualquier dispositivo en la red puede identificarse, representa una amenaza para los clientes que solicitan par√°metros de red a trav√©s de DHCP .  Pero no: como se desprende del RFC, esto se considera un comportamiento bastante leg√≠timo y documentado.  En realidad, el servidor DHCP es inherentemente uno de esos componentes confiables que pueden tener un fuerte impacto en los dispositivos que acceden a ellos. <br><br><h2>  Opci√≥n de b√∫squeda de dominio </h2><br>  La opci√≥n de b√∫squeda de dominio est√° numerada 0x77 (119).  Como todas las opciones, est√° codificada con una etiqueta de un solo byte con el n√∫mero de opci√≥n.  Como la mayor√≠a de las otras opciones, inmediatamente despu√©s de la etiqueta hay un tama√±o de un solo byte de los datos que siguen al tama√±o.  Las instancias de opci√≥n pueden estar presentes en el mensaje DHCP m√°s de una vez.  En este caso, los datos de todas estas secciones se concatenan en la secuencia en que aparecen en el mensaje. <br><br><img src="https://habrastorage.org/webt/cp/dg/yz/cpdgyzwd_4zxdxiujznhojbfczk.png"><br><br>  En el ejemplo presentado, tomado de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">RFC 3397</a> , los datos se dividen en tres secciones, cada una de 9 bytes.  Como puede ver en la imagen, los nombres de subdominio en el nombre de dominio completo est√°n codificados con una longitud de un solo byte del nombre, seguido inmediatamente por el nombre mismo.  La codificaci√≥n del nombre de dominio completo termina con un byte nulo (es decir, un nombre de subdominio de tama√±o nulo). <br><br>  Adem√°s, la opci√≥n utiliza el m√©todo m√°s simple de compresi√≥n de datos, o mejor dicho, solo vuelve a analizar los puntos.  En lugar del tama√±o del nombre de dominio, el campo puede contener el valor 0xc0.  Luego, el siguiente byte establece el desplazamiento relativo al comienzo de los datos de la opci√≥n, que debe usarse para buscar el final del nombre de dominio. <br><br>  Por lo tanto, en este ejemplo, se codifica una lista de dos sufijos de dominio: <br><br><pre> <code class="bash hljs">.eng.apple.com .marketing.apple.com</code> </pre><br><h2>  Funci√≥n DecodeDomainSearchListData </h2><br>  Entonces, el n√∫mero de opci√≥n DHCP 0x77 (119) permite al servidor configurar sufijos DNS en los clientes.  Pero no en m√°quinas con sistemas operativos Windows.  Los sistemas de Microsoft han ignorado tradicionalmente esta opci√≥n, por lo que hist√≥ricamente el final de los nombres DNS, si es necesario, se pas√≥ a trav√©s de pol√≠ticas de grupo.  Esto continu√≥ hasta hace poco, cuando la pr√≥xima versi√≥n de Windows 10, versi√≥n 1803, agreg√≥ procesamiento para la Opci√≥n de b√∫squeda de dominio.  A juzgar por el nombre de la funci√≥n en dhcpcore.dll, en el que se realizaron los cambios, es en el controlador agregado donde reside el error en cuesti√≥n. <br><br>  Ponerse a trabajar.  Peinamos un poco el c√≥digo y descubrimos lo siguiente.  El procedimiento DecodeDomainSearchListData, de acuerdo con el nombre, decodifica los datos de la Opci√≥n de b√∫squeda de dominio del mensaje recibido del servidor.  En la entrada, recibe una matriz de datos empaquetada de la manera descrita en el p√°rrafo anterior, y en la salida, genera una cadena terminada en nulo que contiene una lista de terminaciones de nombres de dominio, separadas por comas.  Por ejemplo, esta funci√≥n convierte los datos del ejemplo anterior en una cadena: <br><br><pre> <code class="bash hljs"> eng.apple.com,marketing.apple.com</code> </pre> <br>  Se llama a DecodeDomainSearchListData desde el procedimiento UpdateDomainSearchOption, que establece la lista devuelta en el valor "DhcpDomainSearchList" de la clave del registro: <br> <code>HKLM\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters\Interfaces\{INTERFACE_GUID}\</code> <br>  almacenar los par√°metros principales de una interfaz de red espec√≠fica. <br><br><img src="https://habrastorage.org/webt/po/cq/zk/pocqzkd8ldtqb8ecrh_oyiajgba.png"><br><br>  La funci√≥n DecodeDomainSearchListData se cumple en dos pases.  En el primer paso, realiza todas las acciones excepto escribir en el b√∫fer de salida.  Por lo tanto, la primera pasada se dedica a calcular el tama√±o de la memoria requerida para acomodar los datos devueltos.  En la segunda pasada, la memoria ya est√° asignada para estos datos y la memoria asignada est√° llena.  La funci√≥n es bastante peque√±a, aproximadamente 250 instrucciones, y su trabajo principal es procesar cada una de las tres opciones posibles para el car√°cter representado en la secuencia de entrada: 1) 0x00, 2) 0xc0 o 3) todos los dem√°s valores.  La soluci√≥n hipot√©tica para el error relacionado con DHCP b√°sicamente se reduce a agregar una verificaci√≥n del tama√±o del b√∫fer resultante al comienzo del segundo paso.  Si este tama√±o es cero, la memoria no est√° asignada para el b√∫fer y la funci√≥n finaliza inmediatamente la ejecuci√≥n y devuelve un error: <br><br><img src="https://habrastorage.org/webt/fn/ym/4g/fnym4gbsu66h64bn03lwrqttxlm.png"><br><br>  Resulta que la vulnerabilidad se manifiesta en casos donde el tama√±o del b√∫fer de destino es cero.  Al mismo tiempo, al comienzo de la ejecuci√≥n, la funci√≥n verifica los datos de entrada, cuyo tama√±o no puede ser inferior a dos bytes.  Por lo tanto, para la operaci√≥n se requiere seleccionar una opci√≥n no vac√≠a de sufijos de dominio de tal manera que el tama√±o del b√∫fer de salida sea cero. <br><br><h2>  Operaci√≥n </h2><br>  Lo primero que viene a la mente es que puede usar los puntos de an√°lisis descritos anteriormente para que los datos de entrada no vac√≠os generen una l√≠nea de salida vac√≠a: <br><br><img src="https://habrastorage.org/webt/fz/px/vp/fzpxvpozmhgp7sbxoavng5hork8.png"><br><br>  Un servidor configurado para enviar una opci√≥n con dicho contenido en la respuesta realmente causar√° violaci√≥n de acceso en clientes no actualizados.  Esto sucede por la siguiente raz√≥n.  En cada paso, cuando la funci√≥n analiza parte del nombre de dominio completo, lo copia en el b√∫fer de destino y coloca un punto despu√©s.  En el ejemplo tomado del RFC, los datos se copiar√°n al b√∫fer en el siguiente orden: <br><br><pre> <code class="bash hljs">1). eng. 2). eng.apple. 3). eng.apple.com.</code> </pre> <br>  Luego, cuando el dominio contiene un tama√±o de dominio cero, la funci√≥n reemplaza el car√°cter anterior del b√∫fer de destino con una coma: <br><br><pre> <code class="bash hljs">4). eng.apple.com,</code> </pre> <br>  y contin√∫a analizando: <br><br><pre> <code class="bash hljs">5). eng.apple.com,marketing. 6). eng.apple.com,marketing.apple. 7). eng.apple.com,marketing.apple.com. 8). eng.apple.com,marketing.apple.com,</code> </pre> <br>  Al final de la entrada, solo queda reemplazar la √∫ltima coma con un car√°cter cero y obtienes una l√≠nea lista para escribir en el registro: <br><br><pre> <code class="bash hljs">9). eng.apple.com,marketing.apple.com</code> </pre> <br>  ¬øQu√© sucede cuando un atacante env√≠a un b√∫fer formado de la manera descrita?  Si observa el ejemplo, puede ver que la lista que contiene consta de un elemento: una cadena vac√≠a.  En la primera pasada, la funci√≥n calcula el tama√±o de los datos de salida.  Como los datos no contienen un solo nombre de dominio distinto de cero, el tama√±o es cero. <br><br>  En la segunda pasada, se asigna un bloque de memoria din√°mica para colocar datos en √©l y copiar los datos en s√≠.  Pero la funci√≥n de an√°lisis encuentra inmediatamente un car√°cter nulo, lo que significa el final del nombre de dominio y, por lo tanto, como se dijo, reemplaza el car√°cter anterior de un punto a una coma.  Y aqu√≠ nos enfrentamos con un problema.  El iterador del b√∫fer de destino est√° en la posici√≥n cero.  No hay personaje previo.  El car√°cter anterior pertenece al encabezado del bloque de memoria din√°mica.  Y este mismo personaje ser√° reemplazado con 0x2c, es decir, con una coma. <br><br>  Sin embargo, esto solo ocurre en sistemas de 32 bits.  El uso de unsigned int para almacenar la posici√≥n actual del iterador del b√∫fer de destino introduce ajustes en el procesamiento en sistemas x64.  Prestemos m√°s atenci√≥n al c√≥digo responsable de escribir una coma en el b√∫fer: <br><br><img src="https://habrastorage.org/webt/cv/wr/da/cvwrdacd4nzbpec5skyyqubd5sg.png"><br><br>  La unidad se resta de la posici√≥n actual utilizando el registro eax de 32 bits, mientras que al direccionar el b√∫fer, el c√≥digo accede al registro completo de 64 bits.  En la arquitectura AMD64, cualquier operaci√≥n con registros de 32 bits anula la parte superior del registro.  Esto significa que en el registro rax, que anteriormente conten√≠a cero, despu√©s de la resta, no se almacenar√° el valor ‚Äì1, sino 0xffffffff.  Por lo tanto, en sistemas de 64 bits, el valor 0x2c se escribir√° en la direcci√≥n buf [0xffffffff], es decir, mucho m√°s all√° de los l√≠mites de la memoria asignada para el b√∫fer. <br><br>  Los datos obtenidos est√°n en buen acuerdo con la evaluaci√≥n de rendimiento de Microsoft, porque para aprovechar esta vulnerabilidad, un atacante necesita aprender a realizar de forma remota la pulverizaci√≥n de mont√≥n en un cliente DHCP y al mismo tiempo tener un control suficiente sobre la asignaci√≥n de memoria din√°mica para registrar valores predefinidos, es decir, una coma y cero byte, producido en la direcci√≥n preparada y conducido a consecuencias negativas controladas.  De lo contrario, escribir datos en una direcci√≥n no verificada provocar√° una ca√≠da en el proceso svchost.exe, junto con todos los servicios actualmente alojados en √©l, y un nuevo reinicio de estos servicios por parte del sistema operativo.  Un hecho que los atacantes en ciertas condiciones tambi√©n pueden usar para su propio beneficio. <br><br>  Eso parece ser todo lo que se puede decir sobre el error bajo investigaci√≥n.  Solo queda la sensaci√≥n de que esto est√° lejos del final.  Como si no consider√°ramos todas las opciones.  Debe haber algo m√°s que est√© oculto en estas l√≠neas. <br><br><h2>  CVE-2019-0726 </h2><br>  Probablemente como es.  Si observa detenidamente el tipo de datos que causan el error y lo compara con la forma exacta en que ocurre este error, notar√° que la lista de nombres de dominio se puede cambiar de tal manera que el b√∫fer resultante sea de un tama√±o distinto de cero, pero un intento de escribir fuera de √©l es Lo mismo se har√°.  Para hacer esto, el primer elemento de la lista debe ser una cadena vac√≠a, y todos los dem√°s pueden contener terminaciones de dominio normales.  Por ejemplo: <br><br><img src="https://habrastorage.org/webt/b2/me/mx/b2memx0tuctb6b7oozdlqwykubw.png"><br><br>  La opci√≥n presentada incluye dos elementos.  El primer sufijo de dominio est√° vac√≠o, inmediatamente termina con un byte cero.  El segundo sufijo es .ru.  El tama√±o de l√≠nea calculado en la salida ser√° igual a tres bytes, lo que permitir√° superar la comprobaci√≥n impuesta por la actualizaci√≥n de enero sobre el vac√≠o del b√∫fer de destino.  Al mismo tiempo, cero al comienzo de los datos obligar√° a la funci√≥n a escribir una coma en la cadena resultante, pero dado que la posici√≥n actual del iterador en la cadena es igual a cero, como en el caso considerado anteriormente, la grabaci√≥n volver√° a ocurrir fuera del b√∫fer asignado. <br><br>  Ahora es necesario confirmar los resultados te√≥ricos obtenidos en la pr√°ctica.  Simulamos una situaci√≥n en la que el servidor DHCP env√≠a un mensaje con la opci√≥n presentada en respuesta a una solicitud del cliente, e inmediatamente detectamos una excepci√≥n al intentar escribir una coma en la posici√≥n 0xffffffff asignada bajo la l√≠nea de b√∫fer resultante: <br><br><img src="https://habrastorage.org/webt/o3/zk/us/o3zkus_tpdsnpbtff_rqnlu1cdw.png"><br><br>  Aqu√≠, el registro r8 contiene un puntero a las opciones entrantes, rdi es la direcci√≥n del b√∫fer de destino seleccionado y rax es la posici√≥n en este b√∫fer donde se va a escribir el car√°cter.  Obtuvimos dichos resultados en un sistema completamente actualizado (a partir de enero de 2019). <br><br>  Escribimos sobre el problema descubierto en Microsoft y ... pierden la carta.  S√≠, esto a veces sucede incluso con proveedores acreditados.  Ning√∫n sistema es perfecto, y en este caso hay que buscar otras formas de comunicaci√≥n.  Por lo tanto, una semana despu√©s, sin siquiera recibir una respuesta autom√°tica durante este tiempo, contactamos al gerente directamente a trav√©s de Twitter y, de acuerdo con los resultados de varios d√≠as de analizar la aplicaci√≥n, descubrimos que los detalles enviados no tienen nada que ver con CVE-2019-0547 y representan una vulnerabilidad independiente para la cual nuevo identificador CVE.  Un mes despu√©s, en marzo, sale la correcci√≥n correspondiente y el error recibe el n√∫mero <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">CVE-2019-0726</a> . <br><br>  As√≠ es como a veces puedes tratar de descubrir los detalles de la vulnerabilidad de 1 d√≠a para descubrir accidentalmente 0 d√≠as simplemente confiando en tu intuici√≥n. <br><br>  <b>Publicado por</b> Mikhail Tsvetkov, Especialista en An√°lisis de Aplicaciones de Tecnolog√≠as Positivas. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/448378/">https://habr.com/ru/post/448378/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../448366/index.html">Rust 1.34 Lanzamiento</a></li>
<li><a href="../448368/index.html">SQL: la tarea del tiempo de trabajo</a></li>
<li><a href="../448372/index.html">Deja de rechazar a los que buscan trabajo con tus preguntas equivocadas.</a></li>
<li><a href="../448374/index.html">Se recibe nueva evidencia de actividad volc√°nica, que caus√≥ la extinci√≥n m√°s masiva de la historia.</a></li>
<li><a href="../448376/index.html">Matem√°ticas diciendo a las c√©lulas lo que deber√≠an ser</a></li>
<li><a href="../448382/index.html">C√≥mo evaluamos la calidad de la documentaci√≥n</a></li>
<li><a href="../448386/index.html">9 maneras incre√≠blemente simples de hacer que la gente responda a tus mensajes</a></li>
<li><a href="../448388/index.html">Dictado digital se llevar√° a cabo por primera vez en Rusia</a></li>
<li><a href="../448390/index.html">C√≥mo hacer un reloj para Ilona Mask</a></li>
<li><a href="../448392/index.html">Dos enfoques para estructurar un cuadro de actividades</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>