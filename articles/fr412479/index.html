<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üèóÔ∏è üë©üèª‚Äçüè´ üëåüèª Scanner laser 3D sur t√©l√©phone Android ü¶é ‚ôéÔ∏è üç≤</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Je vous pr√©sente un scanner DIY bas√© sur un smartphone Android. 

 Lors de la conception et de la cr√©ation d'un scanner, tout d'abord, j'√©tais int√©res...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Scanner laser 3D sur t√©l√©phone Android</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/412479/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/mb/dd/op/mbddoptooexgtjkqnnpchqsfkiq.jpeg"></div><br>  Je vous pr√©sente un scanner DIY bas√© sur un smartphone Android. <br><br>  Lors de la conception et de la cr√©ation d'un scanner, tout d'abord, j'√©tais int√©ress√© par la num√©risation de gros objets.  Minimum - la figure d'une personne en pleine croissance avec pr√©cision - au moins 1-2 mm. <br><br>  Ces crit√®res ont √©t√© atteints avec succ√®s.  Objets scann√©s avec succ√®s √† la lumi√®re naturelle (sans lumi√®re directe du soleil).  Le champ de balayage est d√©termin√© par l'angle de capture de la cam√©ra du smartphone et la distance √† laquelle le faisceau laser maintient une luminosit√© suffisante pour la d√©tection (pendant la journ√©e dans la pi√®ce).  Il s'agit d'une figure d'une personne en pleine hauteur (1,8 m√®tre) avec une largeur de travail de 1,2 m√®tre. <br><br>  Le scanner a √©t√© fait √† partir de consid√©rations "et s'il fallait faire quelque chose de plus ou moins utile et int√©ressant quand il n'y a rien √† faire."  Toutes les illustrations sont bas√©es sur l'exemple d'un objet ¬´test¬ª (le t√©l√©chargement de scans humains n'est pas correct). <br><br>  Comme l'exp√©rience l'a montr√©, pour un scanner de ce type de logiciel, il est secondaire et le moins de temps a √©t√© consacr√© √† celui-ci (pour la version finale. Mis √† part les exp√©riences et les options sans issue).  Par cons√©quent, je ne toucherai pas aux fonctionnalit√©s du logiciel dans l'article (Lien vers les codes source √† la fin de l'article.) <br><br>  Le but de l'article est de parler des branches de blocage et des probl√®mes collect√©s sur le chemin de la cr√©ation de la version de travail finale. <br><a name="habracut"></a><br>  Pour le scanner, la version finale utilise: <br><br><ol><li>  T√©l√©phone Samsung S5 </li><li>  Lasers rouges et verts avec une lentille pour une ligne (ligne √† 90 degr√©s) √† 30 mW avec optique en verre (pas la moins ch√®re). </li><li>  Moteurs pas √† pas 35BYGHM302-06LA 0,3A, 0,9 ¬∞ </li><li>  Pilotes de moteur pas √† pas A4988 </li><li>  Module Bluetooth HC-05 </li><li>  Carte STM32F103C8t </li></ol><br>  Les pilotes A4988 sont r√©gl√©s √† demi-pas, ce qui avec une bo√Æte de vitesses 15-&gt; 120 donne 400 * 2 * 8 pas par PI. <br><br><h2>  Le choix de la technologie de num√©risation. </h2><br>  Les diff√©rentes options suivantes ont √©t√© envisag√©es. <br><br><h4>  Projecteur LED. </h4><br>  L'option a √©t√© envisag√©e et calcul√©e.  M√™me les projecteurs co√ªteux n'ont pas la bonne r√©solution pour atteindre la pr√©cision requise.  Et √ßa ne vaut m√™me pas la peine d'en parler √† bas prix. <br><br><h4>  Balayage m√©canique d'un faisceau laser en combinaison avec un r√©seau de diffraction. </h4><br>  L'id√©e a √©t√© test√©e et jug√©e appropri√©e.  Mais pas pour les performances de bricolage, pour des raisons: <br><br><ol><li>  Nous avons besoin d'un laser suffisamment puissant, pour qu'apr√®s la diffraction, les marques soient suffisamment brillantes (la distance √† l'objectif du smartphone est de 1 √† 2 m√®tres).  Et mes yeux sont d√©sol√©s.  Un point laser d√©j√† avec 30mW n'est pas utile. </li><li>  Les exigences pour un balayage m√©canique de pr√©cision sur 2 plans sont trop √©lev√©es pour les performances de bricolage. </li></ol><br><h3>  Balayage m√©canique standard d'une ligne laser sur un objet de balayage fixe. </h3><br>  Finalement, l'option a √©t√© choisie avec deux lasers de couleurs diff√©rentes. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/2i/uf/ue/2iufuep6mdd8uemj582b1fkhpja.jpeg"></div><br><ol><li>  Diff√©rentes couleurs de lasers permettent de les d√©tecter ind√©pendamment dans une seule trame. </li><li>  L'emplacement des lasers sur les c√¥t√©s oppos√©s de la cam√©ra vous permet d'obtenir deux num√©risations en une seule passe. </li><li>  Deux scans √† la fois vous permettent d'√©valuer objectivement la qualit√© de l'alignement du scanner (les scans doivent converger et se chevaucher). </li></ol><br>  Il s'est av√©r√© que le dernier crit√®re est le plus important.  La qualit√© de la num√©risation est enti√®rement d√©termin√©e par la pr√©cision de la mesure des dimensions g√©om√©triques et des angles du scanner.  Et la pr√©sence de deux scans de deux lasers vous permet d'√©valuer imm√©diatement la qualit√© du scan: <br>  Des nuages ‚Äã‚Äãde points ont converg√©.  C'est-√†-dire  les avions captur√©s par deux lasers ont converg√© sur toute la surface. <br><br><h1>  Version infructueuse de la partie m√©canique du 28BYJ-48. </h1><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/f5/bd/d7/f5bdd7gj652kanczlquqybadyv8.jpeg"></div><br>  Bien que d√®s le d√©but, j'ai suppos√© qu'il s'agissait d'une option sans issue qui ne fournissait pas la pr√©cision n√©cessaire, je l'ai quand m√™me v√©rifi√©e avec diverses astuces: <br><br><ol><li>  L'axe du moteur est fix√© par le roulement. </li><li>  √âl√©ment de friction et but√©e ajout√©s pour l'√©chantillonnage du jeu de bo√Æte de vitesses. </li><li>  Une tentative de d√©terminer la "position exacte" par un phototransistor par exposition au laser </li></ol><br>  La r√©p√©tabilit√© du retour au m√™me endroit de la ligne laser s'est av√©r√©e faible - 2-3 mm √† une distance de 1,5 m√®tre.  Pendant le fonctionnement de l'engrenage, malgr√© l'apparente douceur, des secousses de 1 √† 3 mm sont visibles √† une distance de 1,5 m√®tre. <br><br>  C'est-√†-dire  28BYJ-48 est totalement inadapt√© √† un scanner plus ou moins pr√©cis de gros objets. <br><br><h2>  Exigences de num√©risation bas√©es sur mon exp√©rience </h2><br>  <u>Un √©l√©ment obligatoire du balayage doit √™tre une bo√Æte de vitesses.</u> <br><br>  Ne vous m√©prenez pas sur le mode pas 1 / x.  Les exp√©riences ont montr√© qu'en mode 1/16 sur les micro-√©tapes A4988 ne sont pas uniformes.  Et au 1/8, cette irr√©gularit√© est perceptible dans l'≈ìil. <br><br>  La solution la plus optimale pour la bo√Æte de vitesses √©tait l'utilisation d'un engrenage √† courroie.  Bien que cela se soit av√©r√© assez lourd, il est facile √† cr√©er et pr√©cis. <br>  La pr√©cision de positionnement (plus pr√©cis√©ment, la r√©p√©tabilit√© de positionnement de la position initiale des lasers pour le balayage) des lasers s'est av√©r√©e √™tre d'environ 0,5 mm pour une largeur de ligne laser de 5 mm sur 4 m√®tres de distance.  C'est-√†-dire  √† une distance de balayage (1,2-1,8 m√®tres), il est g√©n√©ralement difficile √† mesurer. <br><br>  Positionnement - optocoupleurs (noname chinois) sur les fentes du disque sous les lasers. <br><br><h2>  Probl√®mes de transmission des signaux de commande du t√©l√©phone au module de commande des lasers et des moteurs pas √† pas </h2><br>  Le canal de contr√¥le s'est av√©r√© √™tre un goulot d'√©tranglement en termes de vitesse de balayage.  Comme il s'agissait d'un d√©veloppement de bricolage pour votre propre plaisir, toutes les m√©thodes de communication avec un smartphone ont √©t√© essay√©es. <br><br><h4>  Transmission des signaux de contr√¥le via la prise audio (prise audio du t√©l√©phone =&gt; oscilloscope) </h4><br>  La fa√ßon la plus inhibitrice de transmettre des donn√©es en temps r√©el.  Oui, m√™me avec un temps flottant.  Jusqu'√† 500 ms (!) De l'activation logicielle de la transmission des donn√©es audio √† l'apparition r√©elle du signal dans la prise audio. <br><br>  Cet exotique a √©t√© v√©rifi√©, car au travail, je devais m'occuper de lecteurs de cartes √† puce mobiles. <br><br><h4>  Photodiodes sur l'√©cran du smartphone (tranche de l'√©cran du t√©l√©phone =&gt; phototransistors + STM32F103) </h4><br>  Par souci d'int√©r√™t, m√™me une m√©thode aussi exotique a √©t√© test√©e comme phototransistors avec une matrice 2x2 sous la forme de pinces √† linge sur l'√©cran. <br><br>  Bien que cette m√©thode de transmission d'informations depuis le t√©l√©phone soit la plus rapide, mais pas fondamentalement plus rapide (10 ms vs 50 ms) que Bluetooth, qui accepterait ses d√©fauts (pince √† linge √† l'√©cran). <br><br><h4>  Canal IR (t√©l√©phone =&gt; TSOP1736-&gt; STM32F103) </h4><br>  Pratiquement v√©rifi√© et la m√©thode de transmission via le canal IR.  M√™me une certaine mise en ≈ìuvre du protocole de transfert de donn√©es devait √™tre effectu√©e. <br><br>  Mais l'IR s'est √©galement av√©r√© peu pratique (il n'est pas pratique de monter le capteur photo sur le t√©l√©phone), et pas beaucoup plus rapide que Bluetooth. <br><br><h4>  Module WiFi (t√©l√©phone =&gt; ESP8266-RS232-&gt; STM32F103) </h4><br>  Les r√©sultats de la v√©rification de ce module se sont av√©r√©s compl√®tement d√©courageants.  La r√©ponse √† la demande (√©cho) pendant l'ex√©cution s'est av√©r√©e √™tre flottante de fa√ßon impr√©visible dans la plage de 20 √† 300 ms (une moyenne de 150 ms).  Pourquoi et quoi - n'a pas compris.  Je suis tomb√© uniquement sur un article d√©crivant une tentative infructueuse d'utiliser l'ESP8266 pour l'√©change de donn√©es en temps r√©el avec des exigences strictes en mati√®re de temps de demande / r√©ponse. <br><br>  C'est-√†-dire  ESP8266 avec le firmware "standard" TCP -&gt; RS232 ne convient pas √† de telles fins. <br><br><h3>  Option s√©lectionn√©e pour le module de commande et la transmission du signal </h3><br>  Finalement, apr√®s toutes les exp√©riences, le canal Bluetooth (module HC-05) a √©t√© s√©lectionn√©.  Il donne un temps de demande-r√©ponse de transfert de donn√©es stable (et c'est le plus important) de 40 ms. <br><br>  Le temps est assez long et affecte consid√©rablement le temps de scan (la moiti√© du temps total). <br>  Mais la meilleure option n'a pas √©t√© obtenue. <br><br>  En tant que module de contr√¥le, une carte r√©pandue avec SM32F103C8T. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/zt/v4/h_/ztv4h_9yaihwssmvespqbnixnv8.jpeg"></div><br><h2>  M√©thodes de d√©tection d'une ligne dans une trame. </h2><br>  La fa√ßon la plus simple d'isoler les lignes laser dans le cadre consiste √† utiliser la soustraction du cadre avec le laser √©teint et du cadre avec le laser. <br><br>  En principe, la recherche par trame fonctionne √©galement sans soustraction.  Mais cela fonctionne bien pire en plein jour.  Bien que ce mode ait √©t√© laiss√© dans le logiciel pour des tests comparatifs (photo du mode ci-dessous. Toutes les autres photos avec le mode de soustraction de trame). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/u8/ui/er/u8uieroxdwngl1vbhe8xqq_wxi4.jpeg"></div><br>  La valeur pratique de l'option sans soustraire les images √©tait faible. <br><br>  Il est possible et possible d'extraire le signal laser de ces informations bruyantes.  Cependant, il n'a pas pris la peine. <br><br>  L'option avec soustraction de trame fonctionne bien. <br><br>  Toutes les exp√©riences avec des tentatives d'approximation de la ligne et de traitement de la trame enti√®re ont montr√© que plus l'algorithme est complexe, plus souvent il ¬´fait des erreurs¬ª et ralentit m√™me le traitement ¬´√† la vol√©e¬ª.  L'algorithme le plus rapide (et le plus simple) pour trouver un laser (point laser) sur une ligne horizontale √©tait: <br><br><ul><li>  Pour chaque point de la ligne, la somme des carr√©s du niveau de couleur laser (RVB) dans la fen√™tre sp√©cifi√©e dans la configuration est prise en compte (13 px - valeur optimale exp√©rimentalement pour la fen√™tre) </li><li>  Le point laser est le milieu de la fen√™tre avec la valeur maximale des sommes des niveaux de ¬´couleur¬ª. </li></ul><br>  Le temps n√©cessaire pour traiter une image en recherchant les ¬´lignes vertes¬ª et ¬´rouges¬ª est de 3 ms. <br><br>  Les nuages ‚Äã‚Äãde points pour le laser rouge et vert sont compt√©s s√©par√©ment.  Avec un r√©glage m√©canique correct, ils sont r√©duits avec une pr√©cision &lt;1 mm. <br><br><h2>  Pr√©cision et alignement </h2><br>  La pr√©cision √©tait de 1 mm √† une distance de 1,2 m√®tre.  Principalement en raison de la r√©solution de l'appareil photo du t√©l√©phone (1920 x 1080) et de la largeur du faisceau laser. <br><br>  Il est tr√®s important d'obtenir les analyses correctes pour configurer la statique et la dynamique.  La pr√©cision / inexactitude est clairement visible lors du chargement des deux nuages ‚Äã‚Äãde points dans MeshLab.  Id√©alement, les nuages ‚Äã‚Äãde points devraient converger et se compl√©ter. <br><br>  Les param√®tres statiques sont d√©finis aussi pr√©cis√©ment que possible une fois: <br><br><ol><li>  La tangente de l'angle de vue de la cam√©ra. </li><li>  La longueur des "√©paules" des lasers (du centre de la lentille √† l'axe de rotation). </li></ol><br>  Et bien s√ªr, la focalisation maximale des lentilles laser √† une distance de balayage donn√©e et la "verticalit√©" des lignes laser. <br><br>  Le param√®tre dynamique de l'angle r√©el de la position des lasers par rapport au plan virtuel du cadre doit √™tre ajust√© √† chaque fois lors du m√©lange du t√©l√©phone dans le support.  Pour cela, le mode de configuration dans le logiciel est effectu√©.  En r√©duisant l'√©cran laser au centre et en ajustant l'angle, il est n√©cessaire de r√©gler la distance calcul√©e aussi pr√®s que possible de la vraie distance (mesur√©e) pour les deux lasers. <br><br>  Avant le r√©glage fin: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/om/bi/zn/ombiznxwfxp9omvn9iykl7r2euk.jpeg"></div><br>  Apr√®s ajustement: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/4-/5y/jq/4-5yjqvqndfskpdqsqozgtjl6cs.jpeg"></div><br><h2>  Conclusions </h2><br>  Peut-√™tre que cette conception peut √™tre r√©p√©t√©e par n'importe qui.  J'ai coup√© tous les d√©tails de la fibre de verre √† la CNC. <br><br>  Bien s√ªr, sans fraiseuse CNC, il est difficile de faire une poulie sous le laser.  Mais compte tenu du fait que vous avez besoin d'un angle de rotation d'un maximum de 90 degr√©s, avec une patience appropri√©e, la poulie peut √©galement √™tre d√©coup√©e avec une lime. <br><br>  Mais il vaut mieux le faire sur CNC.  Les exigences de jeu axial de l'ensemble rotatif sont √©lev√©es.  La qualit√© des num√©risations est d√©termin√©e √† 100% par la pr√©cision de fabrication et d'alignement. <br><br>  Le scanner a fait en arri√®re-plan.  Parfois, par intermittence pendant quelques mois.  Par cons√©quent, je ne peux pas √©valuer la complexit√© totale de sa cr√©ation. <br><br>  Le co√ªt total de la structure n'est pas trop √©lev√©.  Comme mes exp√©riences l'ont montr√©, bien qu'il soit loin des scanners industriels de gros objets, vous pouvez obtenir des scans assez d√©cents. <br>  La qualit√© des num√©risations est principalement affect√©e par la pr√©cision de la pi√®ce m√©canique.  En ce sens, en bricolage, il est difficile de faire face √† la m√©canique cr√©√©e pour les scanners industriels. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Code source</a> <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/86_ZMUdhrN4" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr412479/">https://habr.com/ru/post/fr412479/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr412469/index.html">EmDrive donne une traction en raison d'un mauvais blindage</a></li>
<li><a href="../fr412471/index.html">G√©rer les articles: niveau avanc√©</a></li>
<li><a href="../fr412473/index.html">EW contre Internet par satellite</a></li>
<li><a href="../fr412475/index.html">Trouv√© une nouvelle vuln√©rabilit√© dans les processeurs</a></li>
<li><a href="../fr412477/index.html">Elon Musk: pour l'instant, nous ne vendrons pas la version de base du mod√®le 3</a></li>
<li><a href="../fr412481/index.html">Quel est le probl√®me avec la m√©thode Bates</a></li>
<li><a href="../fr412483/index.html">Le manque de sommeil entra√Æne une baisse radicale de l'attention et des performances</a></li>
<li><a href="../fr412485/index.html">[GT-H]: √Ä propos des probl√®mes syst√©miques, de l'avenir et (un peu) de Tesla - o√π en serait-elle sans elle</a></li>
<li><a href="../fr412487/index.html">Appels √† 5 heures du matin et arrangements avec le Parlement europ√©en: comment nous pr√©parons nos conf√©rences blockchain</a></li>
<li><a href="../fr412489/index.html">Une br√®ve histoire des alternatives quantiques</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>