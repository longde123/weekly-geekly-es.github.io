<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üö† üßòüèΩ üíò Lista de verifica√ß√£o: o que precisava ser feito antes de iniciar os microsservi√ßos no prod üëåüèΩ üôèüèª ü¶è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Este artigo cont√©m um breve extrato de minha pr√≥pria experi√™ncia e da experi√™ncia de meus colegas, com quem passei dias e noites investigando incident...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Lista de verifica√ß√£o: o que precisava ser feito antes de iniciar os microsservi√ßos no prod</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/438064/"><p><img src="https://habrastorage.org/webt/y7/-a/th/y7-ath7wga1jfx9issm1rhog2lg.jpeg" width="45%" align="right">  Este artigo cont√©m um breve extrato de minha pr√≥pria experi√™ncia e da experi√™ncia de meus colegas, com quem passei dias e noites investigando incidentes.  E muitos incidentes nunca teriam ocorrido se todos gostassem de seus microsservi√ßos, pelo menos um pouco mais precisamente. </p><br><p>  Infelizmente, alguns programadores de <s>baixo</s> n√≠vel acreditam seriamente que um arquivo Docker com algum tipo de comando interno √© um microsservi√ßo e pode ser implantado agora.  Os estivadores est√£o girando, o banco est√° lamacento.  Essa abordagem est√° repleta de problemas que variam de queda no desempenho, incapacidade de depura√ß√£o e nega√ß√£o de servi√ßo a um pesadelo chamado Inconsist√™ncia de Dados. </p><br><p>  Se voc√™ acha que chegou a hora de lan√ßar outro aplicativo no Kubernetes / ECS / o que for, ent√£o tenho algo a que me opor. </p><br><p>  <strong>Vers√£o em ingl√™s <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">tamb√©m est√° dispon√≠vel</a></strong> . </p><a name="habracut"></a><br><p>  Formei para mim um certo conjunto de crit√©rios para avaliar a prontid√£o dos aplicativos para lan√ßamento na produ√ß√£o.  Alguns pontos desta lista de verifica√ß√£o n√£o podem ser aplicados a todos os aplicativos, mas apenas aos especiais.  Outros geralmente se aplicam a tudo.  Tenho certeza de que voc√™ pode adicionar suas op√ß√µes nos coment√°rios ou contestar alguns desses pontos. </p><br><p>  Se o seu microsservi√ßo n√£o atender a pelo menos um dos crit√©rios, n√£o permitirei que ele esteja no meu cluster ideal, constru√≠do em um bunker a 2000 metros de profundidade, com piso aquecido e um sistema fechado de suprimento de Internet. </p><br><p>  Vamos l√° .... </p><br><p>  <i>Nota: a ordem dos itens n√£o importa.</i>  <i>Enfim, para mim.</i> </p><br><h2 id="korotkoe-opisanie-v-readme">  Leia-me Breve Descri√ß√£o </h2><br><blockquote>  Ele cont√©m uma breve descri√ß√£o de si mesmo no in√≠cio do Readme.md em seu reposit√≥rio. </blockquote><p>  Deus, parece t√£o simples.  Mas com que frequ√™ncia me deparei com que o reposit√≥rio n√£o cont√©m a menor explica√ß√£o sobre por que √© necess√°rio, quais tarefas ele resolve e assim por diante.  N√£o h√° necessidade de falar sobre algo mais complicado, como op√ß√µes de configura√ß√£o. </p><br><h2 id="integraciya-s-sistemoy-monitoringa">  Integra√ß√£o com um sistema de monitoramento </h2><br><blockquote>  Envia m√©tricas para DataDog, NewRelic, Prometheus e assim por diante. </blockquote><p>  An√°lise do consumo de recursos, vazamentos de mem√≥ria, rastreamento de pilha, interdepend√™ncia de servi√ßos, taxa de erros - sem entender tudo isso (e n√£o apenas), √© extremamente dif√≠cil controlar o que est√° acontecendo em um aplicativo distribu√≠do grande. </p><br><h2 id="opovescheniya-nastroeny">  Alertas configurados </h2><br><blockquote>  O servi√ßo inclui alertas que cobrem todas as situa√ß√µes padr√£o, al√©m de situa√ß√µes exclusivas conhecidas. </blockquote><p>  As m√©tricas s√£o boas, mas ningu√©m as seguir√°.  Portanto, recebemos automaticamente chamadas / push / sms se: </p><br><ul><li>  O consumo de CPU / mem√≥ria aumentou drasticamente. </li><li>  O tr√°fego aumentou / caiu acentuadamente. </li><li>  O n√∫mero de transa√ß√µes processadas por segundo mudou dramaticamente em qualquer dire√ß√£o. </li><li>  O tamanho do artefato ap√≥s a montagem mudou drasticamente (exe, app, jar, ...). </li><li>  A porcentagem de erros ou sua frequ√™ncia excedeu o limite permitido. </li><li>  O servi√ßo parou de enviar m√©tricas (situa√ß√£o geralmente ignorada). </li><li>  A regularidade de certos eventos esperados √© violada (o trabalho do cron n√£o funciona, nem todos os eventos s√£o processados ‚Äã‚Äãetc.) </li><li>  ... </li></ul><br><h2 id="runbooks-sozdany">  Runbooks criados </h2><br><blockquote>  Um documento foi criado para o servi√ßo que descreve conting√™ncias conhecidas ou esperadas. </blockquote><br><ul><li>  como garantir que o erro seja interno e n√£o dependa de terceiros; </li><li>  se depende de onde, para quem e o que escrever; </li><li>  como reiniciar com seguran√ßa; </li><li>  como restaurar do backup e onde est√£o os backups; </li><li>  Quais pain√©is / consultas especiais s√£o criados para monitorar este servi√ßo; </li><li>  O servi√ßo tem seu pr√≥prio painel de administra√ß√£o e como chegar l√°; </li><li>  existe uma API / CLI e como us√°-la para corrigir problemas conhecidos; </li><li>  e assim por diante. </li></ul><br><p>  A lista pode variar muito entre as organiza√ß√µes, mas pelo menos as coisas b√°sicas devem estar l√°. </p><br><h2 id="vse-logi-pishutsya-v-stdoutstderr">  Todos os logs s√£o gravados em STDOUT / STDERR </h2><br><blockquote>  O servi√ßo n√£o cria nenhum arquivo de log no modo de produ√ß√£o, n√£o os envia para nenhum servi√ßo externo, n√£o cont√©m abstra√ß√µes redundantes para rota√ß√£o de logs etc. </blockquote><p>  Quando um aplicativo cria arquivos de log, esses logs s√£o in√∫teis.  Voc√™ n√£o entrar√° em cinco cont√™ineres rodando em paralelo, esperando capturar o erro de que precisa (e aqui est√°, <em>chorando</em> ...).  Reiniciar o cont√™iner resultar√° em uma perda completa desses logs. </p><br><p>  Se um aplicativo gravar seus pr√≥prios logs em um sistema de terceiros, por exemplo, no Logstash, isso criar√° redund√¢ncia in√∫til.  O servi√ßo vizinho n√£o sabe como fazer isso, porque  ele tem uma estrutura diferente?  Voc√™ ganha um zool√≥gico. </p><br><p>  O aplicativo grava parte dos logs nos arquivos e parte no stdout porque √© conveniente para o desenvolvedor ver INFO no console e DEBUG nos arquivos?  Geralmente √© a pior op√ß√£o.  Ningu√©m precisa de complexidade e c√≥digo e configura√ß√µes completamente redundantes que voc√™ precisa conhecer e manter. </p><br><h2 id="logi---eto-json">  Os logs s√£o Json </h2><br><blockquote>  Cada linha de log √© gravada no formato Json e cont√©m um conjunto consistente de campos </blockquote><p>  At√© agora, quase todo mundo grava logs em texto simples.  Este √© um verdadeiro desastre.  Eu ficaria feliz em nunca saber sobre <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Grok Patterns</a> .  √Äs vezes sonho com eles e congelo, tentando n√£o me mexer, para n√£o atrair a aten√ß√£o deles.  Apenas tente analisar as exce√ß√µes Java nos logs uma vez. </p><br><p>  Json √© bom, √© fogo dado do c√©u.  Basta adicionar l√°: </p><br><ul><li>  registro de data e hora em <strong>milissegundos de</strong> acordo com a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">RFC 3339</a> ; </li><li>  n√≠vel: informa√ß√µes, aviso, erro, depura√ß√£o </li><li>  user_id; </li><li>  app_name </li><li>  e outros campos. </li></ul><br><p>  Fa√ßa o download para qualquer sistema adequado (ElasticSearch corretamente configurado, por exemplo) e aproveite.  Conecte os logs de muitos microsservi√ßos e sinta novamente <em>quais</em> eram as boas aplica√ß√µes monol√≠ticas. </p><br><p>  <em>(E voc√™ pode adicionar o Request-Id e obter o rastreamento ...)</em> </p><br><h2 id="logi-s-urovnyami-verbosity">  Logs com n√≠veis de verbosidade </h2><br><blockquote>  O aplicativo deve suportar uma vari√°vel de ambiente, por exemplo, LOG_LEVEL, com pelo menos dois modos de opera√ß√£o: ERRORS e DEBUG. </blockquote><p>  √â desej√°vel que todos os servi√ßos no mesmo ecossistema suportem a mesma vari√°vel de ambiente.  N√£o √© uma op√ß√£o de configura√ß√£o, n√£o √© uma op√ß√£o na linha de comando (embora isso seja revers√≠vel, √© claro), mas imediatamente por padr√£o no ambiente.  Voc√™ deve conseguir o maior n√∫mero poss√≠vel de logs se algo der errado e o menor n√∫mero poss√≠vel de logs, se tudo estiver bem. </p><br><h2 id="fiksirovannye-versii-zavisimostey">  Vers√µes de depend√™ncia fixa </h2><br><blockquote>  As depend√™ncias para gerenciadores de pacotes s√£o corrigidas, incluindo vers√µes secund√°rias (por exemplo, cool_framework = 2.5.3). </blockquote><p>  Isso j√° foi discutido muito, √© claro.  Algumas corrigem depend√™ncias nas vers√µes principais, esperando que apenas pequenas corre√ß√µes de bugs e seguran√ßa estejam em vers√µes menores.  Isto est√° errado. <br>  Cada altera√ß√£o em cada depend√™ncia deve ser refletida em uma <em>confirma√ß√£o separada</em> .  Para que possa ser cancelado em caso de problemas.  √â dif√≠cil controlar com as m√£os?  Existem rob√¥s √∫teis, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">como este</a> , que acompanhar√£o as atualiza√ß√µes e criar√£o solicita√ß√µes pull para cada um de voc√™s. </p><br><h2 id="dockerized">  Dockerized </h2><br><blockquote>  O reposit√≥rio cont√©m Dockerfile pronto para produ√ß√£o e docker-compose.yml </blockquote><p>  O Docker tem sido o padr√£o para muitas empresas.  Existem exce√ß√µes, mas mesmo que voc√™ n√£o tenha o Docker em produ√ß√£o, qualquer engenheiro deve ser capaz de compor o docker e n√£o pensar em mais nada para obter um assembly de desenvolvimento para verifica√ß√£o local.  E o administrador do sistema deve ter o assembly j√° verificado pelos desenvolvedores com as vers√µes necess√°rias de bibliotecas, utilit√°rios etc., nas quais o aplicativo, <em>pelo menos de alguma forma, trabalha</em> para adapt√°-lo √† produ√ß√£o. </p><br><h2 id="konfiguraciya-cherez-okruzhenie">  Configura√ß√£o do ambiente </h2><br><blockquote>  Todas as op√ß√µes importantes de configura√ß√£o s√£o lidas no ambiente e o ambiente tem preced√™ncia maior que os arquivos de configura√ß√£o (mas menor que os argumentos da linha de comandos na inicializa√ß√£o). </blockquote><p>  Ningu√©m nunca vai querer ler seus arquivos de configura√ß√£o e estudar seu formato.  Apenas aceite. </p><br><p>  Mais detalhes aqui: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">https://12factor.net/config</a> </p><br><h2 id="readiness-and-liveness-probes">  Sondas de prontid√£o e vivacidade </h2><br><blockquote>  Cont√©m terminais ou comandos cli apropriados para testar a prontid√£o para atender a solicita√ß√µes na inicializa√ß√£o e no tempo de atividade ao longo da vida. </blockquote><p>  Se o aplicativo atender solicita√ß√µes HTTP, ele dever√° ter duas interfaces por padr√£o: </p><br><ol><li><p>  Para verificar se o aplicativo est√° ativo e sem congelamento, √© usado um teste de vida.  Se o aplicativo n√£o responder, ele poder√° ser automaticamente interrompido por orquestradores como o Kubernetes, " <em>mas isso n√£o √© exato</em> ".  De fato, matar um aplicativo congelado pode causar um efeito domin√≥ e colocar seu servi√ßo permanentemente.  Mas este n√£o √© um problema do desenvolvedor, basta fazer este endpoint. </p><br></li><li><p>  Para verificar se o aplicativo n√£o foi iniciado apenas, mas est√° pronto para aceitar solicita√ß√µes, √© realizado um teste de prontid√£o.  Se o aplicativo estabeleceu uma conex√£o com o banco de dados, o sistema de filas e assim por diante, ele deve responder com um status de 200 a 400 (para o Kubernetes). </p><br></li></ol><br><h2 id="ogranicheniya-resursov">  Limites de recursos </h2><br><blockquote>  Cont√©m limites para o consumo de mem√≥ria, CPU, espa√ßo em disco e quaisquer outros recursos dispon√≠veis em um formato consistente. </blockquote><p>  A implementa√ß√£o espec√≠fica deste item ser√° muito diferente em diferentes organiza√ß√µes e para diferentes orquestradores.  No entanto, esses limites devem ser definidos em um √∫nico formato para todos os servi√ßos, diferentes para diferentes ambientes (prod, dev, test, ...) e estar <em>fora do reposit√≥rio com o c√≥digo do aplicativo</em> . </p><br><h2 id="sborka-i-dostavka-avtomatizirovana">  A montagem e entrega s√£o automatizadas </h2><br><blockquote>  O sistema de CI / CD usado em sua organiza√ß√£o ou projeto est√° configurado e pode entregar o aplicativo no ambiente desejado de acordo com o fluxo de trabalho aceito. </blockquote><p>  <em>Nada √© entregue √† produ√ß√£o manualmente.</em> </p><br><p>  N√£o importa qu√£o dif√≠cil seja automatizar a montagem e entrega do seu projeto, isso deve ser feito antes que o projeto entre em produ√ß√£o.  Este item inclui a cria√ß√£o e execu√ß√£o de livros de receitas Ansible / Chef / Salt / ..., a cria√ß√£o de aplicativos para dispositivos m√≥veis, a cria√ß√£o de uma bifurca√ß√£o do sistema operacional, a cria√ß√£o de imagens de m√°quinas virtuais, qualquer que seja. <br>  N√£o consegue automatizar?  Ent√£o voc√™ n√£o pode publicar isso no mundo.  Depois de voc√™, ningu√©m ir√° colet√°-lo. </p><br><h2 id="graceful-shutdown--korrektnoe-vyklyuchenie">  Desligamento gracioso - desligamento correto </h2><br><blockquote>  O aplicativo pode processar o SIGTERM e outros sinais e interromper sistematicamente seu trabalho ap√≥s o t√©rmino do processamento da tarefa atual. </blockquote><p>  Este √© um ponto extremamente importante.  Os processos do Docker ficam √≥rf√£os e funcionam por meses em segundo plano, onde ningu√©m os v√™.  As opera√ß√µes n√£o transacionais s√£o interrompidas no meio da execu√ß√£o, criando inconsist√™ncia de dados entre servi√ßos e bancos de dados.  Isso leva a erros que n√£o podem ser previstos e podem ser muito, muito caros. </p><br><p>  Se voc√™ n√£o controla nenhuma depend√™ncia e n√£o pode garantir que seu c√≥digo processe corretamente o SIGTERM, use algo como <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">dumb-init</a> . </p><br><p>  Mais informa√ß√µes aqui: </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">https://12factor.net/disposability</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">https://kubernetes.io/docs/concepts/workloads/pods/pod/#termination-of-pods</a> </li></ul><br><h2 id="soedinenie-s-bazoy-dannyh-regulyarno-proveryaetsya">  Conex√£o com o banco de dados verificada regularmente </h2><br><blockquote>  O aplicativo envia um ping ao banco de dados constantemente e responde automaticamente √† exce√ß√£o de "perda de conex√£o" para qualquer solicita√ß√£o, tentando restaur√°-lo por conta pr√≥pria ou termina seu trabalho corretamente </blockquote><p>  Vi muitos casos (isso n√£o √© apenas um discurso) quando os servi√ßos criados para processar filas ou eventos perderam a conex√£o com o tempo limite e come√ßaram a despejar infinitamente erros nos logs, retornando mensagens √†s filas, enviando-os para a fila de devolu√ß√µes ou simplesmente n√£o fazendo seu trabalho. </p><br><h2 id="masshtabiruetsya-gorizontalno">  Dimensionado horizontalmente </h2><br><blockquote>  Com o aumento da carga, √© suficiente executar mais inst√¢ncias de aplicativos para garantir que todas as solicita√ß√µes ou tarefas sejam processadas. </blockquote><p>  Nem todos os aplicativos podem ser dimensionados horizontalmente.  Um exemplo impressionante √© o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Consumidor Kafka</a> .  Isso n√£o √© necessariamente ruim, mas se um aplicativo espec√≠fico n√£o puder ser iniciado duas vezes, todas as partes interessadas precisam saber sobre isso com anteced√™ncia.  Esta informa√ß√£o deve ser desagrad√°vel, pendure no Leia-me e sempre que poss√≠vel.  Em geral, alguns aplicativos n√£o podem ser iniciados em paralelo, o que cria s√©rias dificuldades em seu suporte. </p><br><p>  √â muito melhor se o aplicativo em si controla essas situa√ß√µes ou se um wrapper monitora efetivamente "concorrentes" e simplesmente n√£o permite que o processo inicie ou inicie o trabalho at√© que outro processo conclua seu trabalho ou at√© que alguma configura√ß√£o externa permita que N processos funcionem simultaneamente. </p><br><h2 id="dead-letter-queues-i-ustoychivost-k-plohim-soobscheniyam">  Filas de cartas n√£o entregues e resili√™ncia de mensagens ruins </h2><br><blockquote>  Se o servi√ßo ouvir filas ou responder a eventos, alterar o formato ou o conte√∫do das mensagens n√£o causar√° sua queda.  Tentativas malsucedidas de processar a tarefa s√£o repetidas N vezes, ap√≥s as quais a mensagem √© enviada para a Fila de mensagens n√£o entregues. </blockquote><p>  Muitas vezes vi consumidores e linhas reiniciarem incessantemente a um tamanho que o processamento subsequente levou muitos dias.  Qualquer ouvinte de fila deve estar preparado para alterar o formato, para erros aleat√≥rios na pr√≥pria mensagem (digitando dados em json, por exemplo) ou quando √© processado pelo c√≥digo filho.  Eu at√© me deparei com uma situa√ß√£o em que a biblioteca RabbitMQ padr√£o para uma estrutura extremamente popular n√£o suportava tentativas, contadores de tentativas etc. </p><br><p>  Pior ainda, quando uma mensagem √© simplesmente destru√≠da em caso de falha. </p><br><h2 id="ogranichenie-na-kolichestvo-obrabatyvaemyh-soobscheniy-i-zadach-odnim-processom">  Limita√ß√£o no n√∫mero de mensagens e tarefas processadas por processo </h2><br><blockquote>  Ele suporta uma vari√°vel de ambiente, que pode ser for√ßada a limitar o n√∫mero m√°ximo de tarefas processadas, ap√≥s o qual o servi√ßo ser√° desligado corretamente. </blockquote><p>  Tudo flui, tudo muda, especialmente a mem√≥ria.  O gr√°fico continuamente crescente de consumo de mem√≥ria e OOM Killed no final √© a norma nas mentes c√∫bicas modernas.  A implementa√ß√£o de um teste primitivo que simplesmente salvaria voc√™, mesmo a necessidade de examinar todos esses vazamentos de mem√≥ria, facilitaria a vida.  Vi muitas vezes pessoas gastando muito tempo e esfor√ßo (e dinheiro) para interromper essa rotatividade, mas n√£o h√° garantias de que o pr√≥ximo compromisso do seu colega n√£o piorar√°.  Se o aplicativo pode sobreviver uma semana - este √© um √≥timo indicador.  Deixe-o terminar e reiniciar.  Isso √© melhor que o SIGKILL (sobre o SIGTERM, veja acima) ou a exce√ß√£o "falta de mem√≥ria".  Por algumas d√©cadas, esse plugue √© suficiente para voc√™. </p><br><h2 id="ne-ispolzuet-third-party-integracii-s-filtraciey-po-ip-adresam">  N√£o usa integra√ß√£o de terceiros com filtragem por endere√ßos IP </h2><br><blockquote>  Se o aplicativo fizer solicita√ß√µes para um servi√ßo de terceiros que permita o acesso a partir de endere√ßos IP limitados, o servi√ßo executar√° essas chamadas indiretamente por meio de um proxy reverso. </blockquote><p>  Este √© um caso raro, mas extremamente desagrad√°vel.  √â muito inconveniente quando um pequeno servi√ßo bloqueia a possibilidade de alterar o cluster ou mover toda a infraestrutura para outra regi√£o.  Se voc√™ precisar se comunicar com algu√©m que n√£o sabe usar oAuth ou VPN, configure <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">o proxy reverso</a> antecipadamente.  N√£o implemente em seu programa a adi√ß√£o / remo√ß√£o din√¢mica de integra√ß√µes externas, pois, ao fazer isso, voc√™ se fixa no √∫nico tempo de execu√ß√£o dispon√≠vel.  √â melhor automatizar imediatamente esses processos para gerenciar as configura√ß√µes do Nginx e, em seu aplicativo, entre em contato com ele. </p><br><h2 id="ochevidnyy-http-user-agent">  Agente de usu√°rio HTTP √≥bvio </h2><br><blockquote>  O servi√ßo substitui o cabe√ßalho User-agent por um personalizado para todas as solicita√ß√µes de qualquer API, e esse cabe√ßalho cont√©m informa√ß√µes suficientes sobre o pr√≥prio servi√ßo e sua vers√£o. </blockquote><p>  Quando voc√™ tem 100 aplicativos diferentes conversando, pode ficar louco vendo nos logs algo como "Go-http-client / 1.1" e o endere√ßo IP din√¢mico do cont√™iner do Kubernetes.  Sempre identifique seu aplicativo e sua vers√£o explicitamente. </p><br><h2 id="ne-narushaet-licenzii">  N√£o viola a licen√ßa </h2><br><blockquote>  Ele n√£o cont√©m depend√™ncias que limitam excessivamente o aplicativo, n√£o √© uma c√≥pia do c√≥digo de outra pessoa e assim por diante. </blockquote><p>  Este √© um caso evidente, mas aconteceu que at√© o advogado que escreveu a NDA agora solu√ßa. </p><br><h2 id="ne-ispolzuet-nepodderzhivaemye-zavisimosti">  N√£o usa depend√™ncias n√£o suportadas </h2><br><blockquote>  Quando voc√™ inicia o servi√ßo, ele n√£o inclui depend√™ncias que j√° est√£o desatualizadas. </blockquote><p>  Se a biblioteca que voc√™ levou para o projeto n√£o for mais suportada por ningu√©m - procure outra maneira de atingir a meta ou desenvolver a pr√≥pria biblioteca. </p><br><h2 id="zaklyuchenie">  Conclus√£o </h2><br><p>  Existem algumas verifica√ß√µes muito espec√≠ficas na minha lista para tecnologias ou situa√ß√µes espec√≠ficas, mas esqueci de adicionar algo.  Tenho certeza que voc√™ tamb√©m encontrar√° algo para se lembrar. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt438064/">https://habr.com/ru/post/pt438064/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt438048/index.html">Removemos recursos e produtos desnecess√°rios para melhorar os neg√≥cios.</a></li>
<li><a href="../pt438052/index.html">Interator, Padr√£o de Opera√ß√£o</a></li>
<li><a href="../pt438058/index.html">"An√°lise de dados em Python" em duas partes</a></li>
<li><a href="../pt438060/index.html">Estimativa da orienta√ß√£o espacial ou Como n√£o ter medo dos filtros Mahoney e Majwik</a></li>
<li><a href="../pt438062/index.html">Meu endere√ßo n√£o √© uma casa ou rua, meu endere√ßo √© a Uni√£o Sovi√©tica?</a></li>
<li><a href="../pt438066/index.html">10 canais educacionais do YouTube em ingl√™s dos quais voc√™ nunca ouviu falar</a></li>
<li><a href="../pt438070/index.html">Como a gera√ß√£o Y se transformou em uma gera√ß√£o esgotada?</a></li>
<li><a href="../pt438074/index.html">[An√∫ncio para Ecaterimburgo, Novosibirsk, S√£o Petersburgo] QSess√£o de teste de automa√ß√£o: cobriremos tudo, desde o Neva ao Ob, com testes</a></li>
<li><a href="../pt438078/index.html">O Facebook paga US $ 20 por m√™s para configurar sua pseudo-VPN</a></li>
<li><a href="../pt438080/index.html">Eletr√¥nicos alimentados por sinal Wi-Fi</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>