<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚öíÔ∏è ‚óæÔ∏è üßöüèΩ Fazemos um roteador e NAS em um processador üàØÔ∏è üîº üí™</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Este artigo tem uma sequela . 


 Eu tenho um ‚Äúservidor dom√©stico‚Äù no Linux apenas alguns anos depois que comprei um computador. Agora, a partir desse...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Fazemos um roteador e NAS em um processador</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/477810/"><p>  Este artigo tem uma <a href="https://habr.com/ru/post/478924/">sequela</a> . </p><br><p>  Eu tenho um ‚Äúservidor dom√©stico‚Äù no Linux apenas alguns anos depois que comprei um computador.  Agora, a partir desse momento, mais de quinze anos se passaram e, na maioria das vezes, eu tinha algum tipo de segundo computador adicional em casa.  Uma vez, na hora de atualiz√°-lo, pensei: por que preciso de um roteador separado, se j√° tenho um computador livre?  Afinal, por um longo tempo, no zero, para muitos, era uma configura√ß√£o padr√£o. </p><br><p>  De fato: hoje, para isso, voc√™ pode obter uma m√°quina virtual separada, encaminhar para l√° uma placa Wi-Fi USB ou PCI.  E como sistema operacional, voc√™ pode usar o MikroTik RouterOS de uma s√≥ vez, obtendo software de n√≠vel empresarial por pouco dinheiro. </p><a name="habracut"></a><br><h3 id="vstuplenie">  Entrada </h3><br><p>  Vou descrever minhas metas e objetivos no momento em que eu estava apenas iniciando o projeto: </p><br><ol><li>  A montagem deve consistir nos componentes padr√£o mais comuns.  Isso significa que n√£o h√° placas-m√£e de tamanhos diferentes de mATX / mini-ITX e casos baixos nos quais cart√µes de tamanho normal n√£o cabem </li><li>  Deve haver muito espa√ßo em disco, mas as pr√≥prias cestas t√™m menos de 2,5 ‚Äù </li><li>  A modularidade deve levar a economia depois de um tempo - afinal, o cart√£o Wi-Fi do antigo padr√£o 5 pode ser simplesmente alterado para 7 </li><li>  Suporte para pelo menos algum controle remoto, para que voc√™ possa entender por que o sistema n√£o aumenta, sem conectar fisicamente o monitor e o teclado a algo alto e distante </li><li>  Liberdade total na escolha de um sistema operacional e seu suporte a todos os componentes cr√≠ticos em qualquer sistema operacional </li><li>  Alto desempenho.  Cansado de esperar que o Deluge ‚Äúviva‚Äù .torrent em v√°rios milhares de arquivos ou a criptografia ativada, isso leva a uma queda na velocidade abaixo dos discos ou da conex√£o de rede. </li><li>  Beleza visual e precis√£o da montagem </li><li>  A maior compacta√ß√£o.  O tamanho ideal √© um console de jogos moderno. </li></ol><br><p>  Avisarei imediatamente que, se voc√™ acredita que, no artigo abaixo, vou lhe dizer como concluir todos os pontos, voc√™ √© muito ing√™nuo e √© melhor comprar a Synology ou um lugar na nuvem. <br>  Na verdade, n√£o vejo nada de irreal nessa decis√£o, mas provavelmente n√£o estudei toda a oferta o suficiente e talvez porque o mercado de NAS auto-montado esteja em decl√≠nio e os componentes para esse fim estejam ficando menores e mais baratos. </p><br><h3 id="nemnogo-o-softe">  Um pouco sobre software </h3><br><p>  Recentemente, fiquei t√£o pregui√ßoso que nem queria configurar o KVM, ent√£o decidi tentar ver o que √© unRAID, que o LinusTechTips anunciava tanto como uma GUI conveniente para configurar o KVM e como um bom software para o NAS como um todo.  Como eu estava com pregui√ßa de brincar com mdadm - o unRAID matou dois coelhos com uma cajadada s√≥. </p><br><h3 id="sborka">  Assembl√©ia </h3><br><h4 id="korpus">  Habita√ß√£o </h4><br><p>  Surpreendentemente, veio a parte mais dif√≠cil de montar um NAS improvisado em componentes padr√£o: escolher um gabinete!  Como eu disse, os tempos em que o estojo da porta, atr√°s do qual existem cestas com discos, se foram h√° muito tempo.  E eu ainda realmente queria usar unidades Seagate de 2,5 "(2,5") como discos (no momento da escrita, a capacidade m√°xima √© de 5 TB).  Eles ficam em sil√™ncio e ocupam pouco espa√ßo.  Enquanto 5 TB foi suficiente para mim. </p><br><p>  Obviamente, a placa-m√£e queria o miniITX, pois parecia que um slot de expans√£o era suficiente. </p><br><p>  Descobriu-se que existem gabinetes compactos do tamanho de um netbook, mas existe apenas um lugar para 2,5 e os ‚Äúoutros‚Äù, onde j√° existem alguns 3,5 do tamanho apropriado.  O meio simplesmente n√£o existe.  Mesmo pelo dinheiro.  Havia algo em Ali, mas foi interrompido (SEMPRE verifique Ali, em busca de coisas incomuns, √†s vezes os chineses j√° inventaram tudo e o colocaram na produ√ß√£o em massa).  Em algum f√≥rum pequeno, li sobre o SilverStone CS01B-HS, mas o pre√ßo n√£o se encaixava na categoria de or√ßamento.  Cansado da pesquisa, encomendei na Amazon atrav√©s do Shipito, que falhou completamente no terceiro ponto da tarefa t√©cnica. </p><br><p>  Mas agora voc√™ n√£o pode se preocupar com o or√ßamento! </p><br><p>  Aconselho que voc√™ fa√ßa imediatamente um modelo 3D da sua caixa Dream e ligue-a em uma m√°quina CNC de alum√≠nio real.  Vai ser um pouco mais caro que o silverstone, mas mil vezes mais agrad√°vel.  Compartilhe-o mais tarde no github! </p><br><h4 id="processor">  CPU </h4><br><p>  Claro, eu queria tomar a AMD como processador, 2019 est√° no quintal, apenas aqueles que n√£o se aprofundam no shtud.  Mas, tentando cumprir o ponto quatro ‚ÄúSuporte para controle remoto‚Äù, encontro apenas a AMD Ryzen DASH e entendo que, nesse caso, voc√™ precisa escolher a Intel. </p><br><p>  Al√©m disso, tudo √© como sempre: Yandex.Market, filtros, pesquisa f√°cil para problemas das crian√ßas e entrega amanh√£ dentro do MKAD gratuitamente. </p><br><h4 id="matplata">  Placa-m√£e </h4><br><p>  De placas-m√£e, de fato, a escolha √© de uma - a Gigabyte GA-Q170TN. </p><br><p>  N√£o sei por que o slot de expans√£o √© apenas x4, mas se, no futuro, voc√™ quiser colocar uma placa de rede de dez gigabytes, haver√° estoque suficiente (mas voc√™ n√£o poder√° conectar o armazenamento que fornece esse desempenho). </p><br><p>  Das grandes vantagens: dois slots miniPCI-E.  O MikroTik est√° lan√ßando todas as suas placas Wi-Fi (e precisamos delas, porque s√£o suportadas apenas no RouterOS) no formato miniPCI-E, e provavelmente estar√° liberando por muitos mais anos, pois esse √© o principal padr√£o para placas de expans√£o.  Por exemplo, voc√™ pode comprar o m√≥dulo <a href="https://mikrotik.com/product/r11e_lora8" rel="nofollow">LoRaWAN</a> e obter suporte facilmente para dispositivos com LoRa. </p><br><p>  Dois Ethernet, mas 1 Gbps.  Em 2017, propus uma lei proibindo a venda de placas-m√£e com velocidades Ethernet de at√© 4 Gbps, mas n√£o consegui coletar o n√∫mero necess√°rio de assinaturas para a passagem do filtro municipal. </p><br><h4 id="diski">  Discos </h4><br><p>  Tomamos dois STDR5000200 como discos.  Por alguma raz√£o, eles custam menos do que o ST5000LM000, que est√° realmente l√°.  Ap√≥s a compra, verificamos, desmontamos, obtemos o ST5000LM000 e conectamos via SATA.  No caso de uma garantia, voc√™ a coleta e a entrega, recebendo um novo disco em troca (n√£o estou brincando, fiz). </p><br><p>  N√£o usei o NVMe SSD, talvez no futuro, se necess√°rio. </p><br><p>  A Intel, em suas melhores tradi√ß√µes, difunde o rake: n√£o h√° suporte suficiente na placa-m√£e, o suporte a vPro tamb√©m √© necess√°rio no processador e voc√™ se cansar√° de procurar uma tabela de compatibilidade.  Por algum milagre, descobri que preciso de um m√≠nimo de i5-7500.  Mas como n√£o havia mais um limite no or√ßamento, eu me reconciliei. </p><br><p>  N√£o vejo nada de interessante nos componentes restantes, eles podem ser substitu√≠dos por quaisquer an√°logos. Portanto, aqui est√° uma tabela geral com pre√ßos no momento da compra: </p><br><div class="scrollable-table"><table><thead><tr><th>  Nome </th><th>  Quantidade </th><th>  Pre√ßo </th><th>  Custo </th></tr></thead><tbody><tr><td>  Crucial DDR4 SO-DIMM 2400MHz PC4-19200 CL17 - 4Gb CT4G4SFS624A </td><td>  2 </td><td>  1 259 </td><td>  2.518 </td></tr><tr><td>  Seagate STDR5000200 </td><td>  2 </td><td>  8 330 </td><td>  16 660 </td></tr><tr><td>  SilverStone CS01B-HS </td><td>  1 </td><td>  $ 159 + $ 17 (frete da Amazon) + $ 80 (frete para a R√∫ssia) = $ 256 </td><td>  16.830 </td></tr><tr><td>  Controlador PCI-E Espada FG-EST14A-1-BU01 </td><td>  1 </td><td>  2 850 </td><td>  2 850 </td></tr><tr><td>  Fonte de alimenta√ß√£o SFX 300 W Fique quieto SFX POWER 2 BN226 </td><td>  1 </td><td>  4160 </td><td>  4160 </td></tr><tr><td>  SSD Kingston de 240 GB SUV500MS / 240G {mSATA} </td><td>  1 </td><td>  2.770 </td><td>  2.770 </td></tr><tr><td>  Intel Core i5-7500 </td><td>  1 </td><td>  10.000 </td><td>  10.000 </td></tr><tr><td>  GIGABYTE GA-Q170TN </td><td>  1 </td><td>  9 720 </td><td>  9 720 </td></tr><tr><td>  MikroTik R11e-5HacT </td><td>  1 </td><td>  3.588 </td><td>  3.588 </td></tr><tr><td>  Antenas </td><td>  3 </td><td>  358 </td><td>  1.074 </td></tr><tr><td>  Licen√ßa RouterOS N√≠vel 4 </td><td>  1 </td><td>  $ 45 </td><td>  2 925 </td></tr><tr><td>  Licen√ßa b√°sica UnRAID </td><td>  1 </td><td>  $ 59 </td><td>  3 835 </td></tr></tbody></table></div><br><p>  Total de 66 930 rublos.  O ponto tr√™s sobre a parte econ√¥mica da quest√£o foi abalado, mas a id√©ia de que em dez anos esse ferro ainda ser√° capaz de realizar a tarefa designada aquece a alma. </p><br><p>  A instala√ß√£o do software foi muito f√°cil, √© bom, ele tem: 95% pode ser clicado com o mouse em uma noite.  Posso descrever isso em um artigo separado, se for interessante, pois nem tudo foi perfeito, mas n√£o houve problemas n√£o solucion√°veis ‚Äã‚Äãque n√£o sejam do Google.  Por exemplo, n√£o era t√£o f√°cil se livrar dos adaptadores Ethernet com fio no RouterOS, porque sua lista de equipamentos suportados √© bastante escassa. </p><br><h3 id="vyvody-posle-prohozhdeniya-granicy-v-sto-dney-uptime">  Conclus√µes depois de atravessar a fronteira de cem dias de atividade </h3><br><ol><li>  O vPro n√£o √© necess√°rio para esse fim.  Isso reduz bastante a escolha de placas-m√£e e processadores e, para uso dom√©stico, voc√™ precisar√° de um cabo de extens√£o HDMI sem fio e um teclado sem fio.  Em casos extremos (o servidor est√° no por√£o sob uma laje de concreto armado) - use um cabo de extens√£o de par tran√ßado. </li><li>  Onze gigabits foram necess√°rios ontem.  O disco r√≠gido m√©dio dos anos 2010 l√™ mais de 120 megabytes por segundo, para o qual uma rede de gigabit n√£o √© suficiente.  E colocaremos o cache do SSD, para o qual 1,25 GB / s pode se tornar uma limita√ß√£o. </li><li>  O corpo comeu um quarto do or√ßamento.  Isso √© inaceit√°vel. </li><li>  Processador r√°pido em NAS / roteador - mais necess√°rio do que parecia inicialmente </li><li>  O unRAID √© um software realmente bom, h√° tudo o que √© necess√°rio e n√£o h√° nada que n√£o seja necess√°rio.  Voc√™ paga uma vez, se precisar de mais discos - eles pedem apenas a diferen√ßa no custo das licen√ßas. </li></ol><br><p>  Meu antigo hap ac estava distribuindo cerca de 20 megabits com a criptografia de t√∫nel VPN ativada.  Agora, apenas um n√∫cleo i5-7500 √© suficiente para fornecer gigabits. </p><br><img src="https://habrastorage.org/webt/m1/i-/kb/m1i-kbxxfxmtko2p9bec5neooaq.png"><br><h3 id="ps">  PS </h3><br><p>  Estou muito feliz se voc√™ leu at√© o fim e foi interessante para voc√™!  Fa√ßa perguntas se algo permanecer incerto.  Eu poderia ter esquecido completamente. </p><br><p>  Eu responderei imediatamente o √≥bvio: </p><br><p>  <strong>- Por que tudo isso, voc√™ pode simplesmente comprar Synology?</strong> <br>  "Sim, e eu aconselho voc√™ a faz√™-lo."  √â mais simples, mais r√°pido, mais barato e mais confi√°vel.  Um artigo para entusiastas que sabem por que precisam de recursos adicionais. </p><br><p>  <strong>- Por que n√£o o FreeNAS, existe tudo o que est√° no unRAID, mas de gra√ßa?</strong> <br>  - Infelizmente, o c√≥digo aberto j√° √© completamente diferente.  O FreeNAS √© escrito exatamente pelos mesmos programadores de folha de pagamento.  E se voc√™ obt√©m o trabalho deles de gra√ßa, o produto final √© voc√™.  Ou eles logo parar√£o de pagar ao investidor. </p><br><p>  <strong>- Voc√™ pode fazer tudo no Linux puro e economizar mais!</strong> <br>  Sim.  Uma vez eu fiz.  Mas porque?  Para mim, configurar uma rede no Linux sempre foi um problema.  Deixe que permane√ßam zeladores de computador.  E o RouterOS resolve completamente essa classe de problemas.  O mesmo ocorre com o MD RAID: apesar do mdadm n√£o permitir que voc√™ cometa erros est√∫pidos, ainda perdi os dados.  E o unRAID simplesmente n√£o permite que voc√™ pressione o bot√£o errado.  Novamente, voc√™ n√£o deve perder seu tempo configurando manualmente o reposit√≥rio. </p><br><p>  <strong>- Mas voc√™ ainda instalou o ubuntu usual em uma m√°quina virtual!</strong> <br>  - Por uma quest√£o de tudo, tudo foi iniciado.  Agora voc√™ tem sua AWS pessoal com a velocidade m√°xima de conex√£o com seu armazenamento, rede dom√©stica e Internet ao mesmo tempo, o que ningu√©m pode oferecer.  E quais servi√ßos executar nesta m√°quina virtual s√£o com voc√™. </p><br><p>  <strong>- Qualquer problema na casa imediatamente, n√£o h√° Wi-Fi, internet, armazenamento.</strong> <br>  - Um roteador sobressalente est√° mentindo por 1.000 rublos e nada sai das unidades.  Durante todo o tempo, exceto discos e coolers, nada quebrou.  Mesmo um nettop regular trabalha 24/7 por quase dez anos e parece √≥timo agora.  Sobreviveu a dois discos. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt477810/">https://habr.com/ru/post/pt477810/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt477792/index.html">Quando ganhar √© o seu perfil</a></li>
<li><a href="../pt477800/index.html">Destaques do F√≥rum de Desenvolvimento Web do Chrome Web Dev Summit 2019</a></li>
<li><a href="../pt477802/index.html">Caixa para um dispositivo eletr√¥nico: como projet√°-lo e fabric√°-lo na China</a></li>
<li><a href="../pt477804/index.html">O caminho para a intelig√™ncia natural</a></li>
<li><a href="../pt477808/index.html">N√≥s nos livramos de avisos irritantes ao entrar no servidor de terminal</a></li>
<li><a href="../pt477812/index.html">Revis√£o da legisla√ß√£o russa para proteger a infraestrutura de informa√ß√µes cr√≠ticas</a></li>
<li><a href="../pt477814/index.html">Existem v√≠rus no Mac?</a></li>
<li><a href="../pt477816/index.html">Como encontrar um emprego com um bom contrato</a></li>
<li><a href="../pt477818/index.html">Como se tornar um cientista de dados em 2019</a></li>
<li><a href="../pt477820/index.html">VMware, Hyper-V, OpenStack, Kubernetes, Swarm - monitorando a partir de uma √∫nica interface no Quest Foglight</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>