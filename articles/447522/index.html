<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚ôìÔ∏è ‚ôèÔ∏è üë©üèø‚Äçü§ù‚Äçüë®üèΩ Qu√© cosas √∫tiles se pueden extraer de los registros de una estaci√≥n de trabajo basada en Windows üë©üèø‚Äçüè´ üë∞ üßîüèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="La estaci√≥n de trabajo del usuario es la infraestructura m√°s vulnerable en t√©rminos de seguridad de la informaci√≥n. Los usuarios pueden recibir una ca...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Qu√© cosas √∫tiles se pueden extraer de los registros de una estaci√≥n de trabajo basada en Windows</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/galssoftware/blog/447522/"> La estaci√≥n de trabajo del usuario es la infraestructura m√°s vulnerable en t√©rminos de seguridad de la informaci√≥n.  Los usuarios pueden recibir una carta de su correo de trabajo que parece ser de una fuente segura, pero con un enlace al sitio infectado.  Quiz√°s alguien descargar√° una utilidad √∫til para trabajar desde una ubicaci√≥n desconocida.  S√≠, puede llegar a m√°s de una docena de casos, c√≥mo a trav√©s de los usuarios el malware puede infiltrarse en los recursos corporativos internos.  Por lo tanto, las estaciones de trabajo requieren mayor atenci√≥n, y en el art√≠culo le diremos d√≥nde y qu√© eventos tomar para rastrear ataques. <br><br><img src="https://habrastorage.org/webt/n1/5h/lf/n15hlfq8b3n3ka64c-ahfco6ktm.png"><br><a name="habracut"></a><br>  Hay tres fuentes de eventos √∫tiles para detectar un ataque en una etapa temprana en Windows: un registro de eventos de seguridad, un registro de monitoreo del sistema y registros de Power Shell. <br><br><h2>  Registro de seguridad </h2><br>  Esta es la ubicaci√≥n de almacenamiento principal para los registros de seguridad del sistema.  Esto incluye eventos de inicio / cierre de sesi√≥n de usuario, acceso a objetos, cambios en pol√≠ticas y otras actividades relacionadas con la seguridad.  Por supuesto, si se configura la pol√≠tica adecuada. <br><br><img src="https://habrastorage.org/webt/_9/eg/ys/_9egysaz3btzcitbobp2gofmcu0.png"><br><br>  <b>Enumeraci√≥n de usuarios y grupos (eventos 4798 y 4799).</b>  El software malicioso al comienzo de un ataque a menudo pasa a trav√©s de cuentas de usuarios locales y grupos locales en una estaci√≥n de trabajo para encontrar credenciales para sus asuntos oscuros.  Estos eventos ayudar√°n a detectar c√≥digo malicioso antes de que avance m√°s y, utilizando los datos recopilados, se propagar√°n a otros sistemas. <br><br>  <b>Crear una cuenta local y cambiar grupos locales (eventos 4720, 4722‚Äì4726, 4738, 4740, 4767, 4780, 4781, 4794, 5376 y 5377).</b>  Un ataque tambi√©n puede comenzar, por ejemplo, agregando un nuevo usuario a un grupo de administradores locales. <br><br>  <b>Intenta iniciar sesi√≥n con una cuenta local (evento 4624).</b>  Los buenos usuarios inician sesi√≥n con una cuenta de dominio e identificar una entrada en una cuenta local puede indicar el comienzo de un ataque.  El evento 4624 tambi√©n incluye inicios de sesi√≥n en una cuenta de dominio, por lo que al procesar eventos, debe filtrar los eventos en los que el dominio es diferente del nombre de la estaci√≥n de trabajo. <br><br>  <b>Intento de inicio de sesi√≥n con una cuenta determinada (evento 4648).</b>  Esto sucede cuando el proceso se ejecuta en modo "Ejecutar como".  En la operaci√≥n normal de los sistemas, esto no deber√≠a ser, por lo tanto, tales eventos deber√≠an ser controlados. <br><br>  <b>Estaci√≥n de trabajo de bloqueo / desbloqueo (eventos 4800-4803).</b>  Los eventos sospechosos incluyen cualquier acci√≥n que haya ocurrido en una estaci√≥n de trabajo bloqueada. <br><br>  <b>Cambios en la configuraci√≥n del firewall (eventos 4944-4958).</b>  Obviamente, al instalar un nuevo software, la configuraci√≥n de firewall puede cambiar, lo que causar√° falsos positivos.  En la mayor√≠a de los casos, no es necesario controlar tales cambios, pero no ser√° superfluo saber sobre ellos. <br><br>  <b>Conexi√≥n de dispositivos Plug'n'play (evento 6416 y solo para Windows 10).</b>  Es importante controlar esto, si los usuarios generalmente no conectan nuevos dispositivos a la estaci√≥n de trabajo, y de repente, lo han conectado. <br><br>  Windows incluye 9 categor√≠as de auditor√≠a y 50 subcategor√≠as para un ajuste fino.  El conjunto m√≠nimo de subcategor√≠as que se deben incluir en la configuraci√≥n: <br><br>  <b>Inicio / cierre de sesi√≥n</b> <br><br><ul><li>  Inicio de sesi√≥n; </li><li>  Cierre de sesi√≥n; </li><li>  Bloqueo de cuenta; </li><li>  Otros eventos de inicio / cierre de sesi√≥n. </li></ul><br>  <b>Gesti√≥n de cuentas</b> <br><br><ul><li>  Gesti√≥n de cuentas de usuario; </li><li>  Gesti√≥n del grupo de seguridad. </li></ul><br>  <b>Cambio de pol√≠tica</b> <br><br><ul><li>  Cambio de pol√≠tica de auditor√≠a </li><li>  Cambio de pol√≠tica de autenticaci√≥n; </li><li>  Cambio de pol√≠tica de autorizaci√≥n. </li></ul><br><h2>  Monitor de sistema (Sysmon) </h2><br>  Sysmon es una utilidad incorporada en Windows que puede escribir eventos en el registro del sistema.  Por lo general, se requiere instalarlo por separado. <br><br><img src="https://habrastorage.org/webt/zt/e6/jg/zte6jgkrmzj6evy8vyojwcpo_fy.png"><br><br>  En principio, se pueden encontrar los mismos eventos en el registro de seguridad (al incluir la pol√≠tica de auditor√≠a deseada), pero Sysmon brinda m√°s detalles.  ¬øQu√© eventos se pueden tomar de Sysmon? <br><br>  <b>Creaci√≥n de un proceso (evento ID 1).</b>  El registro del sistema de eventos de seguridad tambi√©n puede indicar cu√°ndo se ha iniciado cualquier * .exe e incluso mostrar su nombre y ruta de inicio.  Pero a diferencia de Sysmon, no podr√° mostrar el hash de la aplicaci√≥n.  El software malicioso incluso se puede llamar notepad.exe inofensivo, pero es el hash lo que lo pondr√° en aguas claras. <br><br>  <b>Conexiones de red (ID de evento 3).</b>  Obviamente, hay muchas conexiones de red y no puedes hacer un seguimiento de todos.  Pero es importante tener en cuenta que Sysmon, a diferencia del Registro de seguridad, puede vincular una conexi√≥n de red a los campos ProcessID y ProcessGUID, muestra el puerto y las direcciones IP de la fuente y el receptor. <br><br>  <b>Cambios en el registro (evento ID 12-14).</b>  La forma m√°s f√°cil de agregarse al inicio es registrarse en el registro.  Security Log puede hacer esto, pero Sysmon muestra qui√©n realiz√≥ los cambios, cu√°ndo, d√≥nde, ID de proceso y valor de clave anterior. <br><br>  <b>Creaci√≥n de archivos (evento ID 11).</b>  Sysmon, a diferencia del Registro de seguridad, mostrar√° no solo la ubicaci√≥n del archivo, sino tambi√©n su nombre.  Est√° claro que no puede realizar un seguimiento de todo, pero tambi√©n puede auditar ciertos directorios. <br><br>  Y ahora qu√© pol√≠ticas de registro de seguridad no tienen, pero est√°n en Sysmon: <br><br>  <b>Cambiar el tiempo de creaci√≥n del archivo (ID de evento 2).</b>  Algunos programas maliciosos pueden reemplazar la fecha de creaci√≥n del archivo para ocultarlo de los informes con archivos creados recientemente. <br><br>  <b>Descargue controladores y bibliotecas din√°micas (ID de evento 6-7).</b>  Seguimiento de la carga de DLL y controladores de dispositivo en la memoria, verificaci√≥n de la firma digital y su validez. <br><br>  <b>Crear un hilo en un proceso continuo (ID de evento 8).</b>  Un tipo de ataque que tambi√©n necesita monitorear. <br><br>  <b>Eventos de RawAccessRead (ID de evento 9).</b>  Leer operaciones desde el disco usando "\\. \".  En la gran mayor√≠a de los casos, dicha actividad debe considerarse anormal. <br><br>  <b>Crear una secuencia de archivo con nombre (ID de evento 15).</b>  Un evento se registra cuando se genera una secuencia de archivos con nombre que genera eventos con un hash del contenido del archivo. <br><br>  <b>Crear una tuber√≠a y conexi√≥n con nombre (ID de evento 17-18).</b>  Seguimiento de c√≥digo malicioso que se comunica con otros componentes a trav√©s de una tuber√≠a con nombre. <br><br>  <b>Actividad de WMI (evento ID 19).</b>  Registro de eventos que se generan al acceder al sistema a trav√©s del protocolo WMI. <br><br>  Para proteger el propio Sysmon, debe realizar un seguimiento de los eventos con ID 4 (detener e iniciar Sysmon) e ID 16 (cambiar la configuraci√≥n de Sysmon). <br><br><h2>  Revistas Power Shell </h2><br>  Power Shell es una herramienta poderosa para administrar la infraestructura de Windows, por lo que hay muchas posibilidades de que el atacante la elija.  Puede usar dos fuentes para obtener informaci√≥n sobre los eventos de Power Shell: el registro de Windows PowerShell y el registro de Microsoft-WindowsPowerShell / Operational. <br><br><h4>  Registro de Windows PowerShell </h4><br><img src="https://habrastorage.org/webt/ao/zu/r3/aozur3ankpoqqckwf-x2af-ywza.png"><br><br>  <b>Proveedor de datos cargado (ID de evento 600).</b>  Los proveedores de PowerShell son programas que sirven como fuente de datos para que PowerShell los vea y administre.  Por ejemplo, los proveedores integrados pueden ser variables de entorno de Windows o el registro.  La aparici√≥n de nuevos proveedores debe ser monitoreada para identificar actividades maliciosas a tiempo.  Por ejemplo, si ve que WSMan aparece entre los proveedores, se ha iniciado una sesi√≥n remota de PowerShell. <br><br><h4>  Microsoft-WindowsPowerShell / Registro operativo (o MicrosoftWindows-PowerShellCore / Operational en PowerShell 6) </h4><br><img src="https://habrastorage.org/webt/de/ga/ci/degaci8kfzznwue4ywft7w2zwk8.png"><br><br>  <b>M√≥dulo diario (ID de evento 4103).</b>  Los eventos almacenan informaci√≥n sobre cada comando ejecutado y los par√°metros con los que se llam√≥. <br><br>  <b>Registro de bloqueo de script (ID de evento 4104).</b>  El registro de bloqueo de script muestra cada bloque de c√≥digo de PowerShell ejecutado.  Incluso si un atacante intenta ocultar el comando, este tipo de evento mostrar√° el comando PowerShell ejecutado realmente.  Incluso en este tipo de evento, se pueden grabar algunas llamadas API de bajo nivel, estos eventos generalmente se escriben como Verbose, pero si se utiliza un comando o script sospechoso en un bloque de c√≥digo, se registrar√° como Advertencia con criticidad. <br><br>  Tenga en cuenta que despu√©s de configurar la herramienta para recopilar y analizar estos eventos, se requerir√° un tiempo de depuraci√≥n adicional para reducir el n√∫mero de falsos positivos. <br><br>  D√≠ganos en los comentarios qu√© registros recopila para la auditor√≠a de seguridad de la informaci√≥n y qu√© herramientas utiliza para esto.  Una de nuestras √°reas son las soluciones para auditar eventos de seguridad de la informaci√≥n.  Para resolver el problema de recopilar y analizar registros, podemos ofrecer una mirada m√°s cercana a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Quest InTrust</a> , que puede comprimir los datos almacenados con una proporci√≥n de 20: 1, y una instancia instalada es capaz de procesar hasta 60,000 eventos por segundo desde 10,000 fuentes. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/447522/">https://habr.com/ru/post/447522/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../447510/index.html">GeekUniversity abre la inscripci√≥n en el departamento de dise√±o</a></li>
<li><a href="../447512/index.html">¬øY qui√©n hizo esto? Automatizar la auditor√≠a de seguridad de la informaci√≥n.</a></li>
<li><a href="../447514/index.html">7 startups interesantes en IoT</a></li>
<li><a href="../447516/index.html">C√≥mo overclockeamos CAD COMPASS-3D ‚Üí Parte 2</a></li>
<li><a href="../447520/index.html">Funciones de nivelaci√≥n autom√°tica en el almacenamiento Qsan XCubeSAN</a></li>
<li><a href="../447526/index.html">Bicicleta propia para sincronizar MariaDB y Sphinx</a></li>
<li><a href="../447528/index.html">¬øQui√©n es responsable de la calidad?</a></li>
<li><a href="../447530/index.html">OceanLotus: actualizaci√≥n de Malvari para macOS</a></li>
<li><a href="../447532/index.html">Splunk Universal Forwarder en el Docker como recopilador de registros del sistema</a></li>
<li><a href="../447534/index.html">El cosmonauta Aleksandr Laveykin sobre la mejor pel√≠cula espacial, fuerza G de 20 g y aterrizaje suave</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>