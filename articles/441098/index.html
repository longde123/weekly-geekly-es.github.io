<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>   Profundidades SIEM: correlaciones listas para usar. Parte 4. Modelo del sistema como contexto de reglas de correlaci贸n   </title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Imagine la situaci贸n: pas贸 mucho tiempo escribiendo y depurando reglas de correlaci贸n, y un d铆a despu茅s descubri贸 que no funcionaban. Como dicen, esto...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Profundidades SIEM: correlaciones listas para usar. Parte 4. Modelo del sistema como contexto de reglas de correlaci贸n</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pt/blog/441098/">  Imagine la situaci贸n: pas贸 mucho tiempo escribiendo y depurando reglas de correlaci贸n, y un d铆a despu茅s descubri贸 que no funcionaban.  Como dicen, esto nunca ha sucedido y aqu铆 de nuevo!  Luego resulta que por la noche la red se actualiz贸 una vez m谩s y se reemplazaron un par de servidores, pero las reglas de correlaci贸n no tienen esto en cuenta.  En este art铆culo, le mostraremos c贸mo ense帽arle a SIEM a adaptarse al panorama cambiante de la infraestructura. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/g9/u2/9g/g9u29g2rux2enwdrvq7rwhltfvg.png" alt="Modelo de sistema como contexto de reglas de correlaci贸n"></div><br><a name="habracut"></a><br>  Nos estamos acercando cada vez m谩s al final de la serie de art铆culos dedicados a la creaci贸n de reglas de correlaci贸n adaptativa que funcionan de forma inmediata.  El art铆culo result贸 ser largo, quien quiera puede llegar inmediatamente a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">conclusiones</a> . <br><br>  En el art铆culo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">"Metodolog铆a para normalizar eventos"</a> resumimos t茅cnicas que ayudar谩n a minimizar el problema de la p茅rdida de datos y la normalizaci贸n incorrecta de los eventos iniciales.  Sin embargo, 驴se puede argumentar que, si se reduce el papel de los errores de normalizaci贸n, es posible hacer reglas de correlaci贸n que funcionen de forma inmediata?  Te贸ricamente, s铆, si el objeto de monitoreo monitoreado por SIEM ser铆a est谩tico y funcionar铆a exclusivamente como est谩 escrito en los t茅rminos de referencia.  Pero en la pr谩ctica resulta que en el mundo real no hay nada est谩tico. <br><br>  Por lo tanto, consideraremos con m谩s detalle el objeto de monitoreo.  SIEM recopila registros de fuentes, de ellos extrae direcciones IP, cuentas de usuario, acceso a archivos y claves de registro, interacciones de red.  Si todo se resume, esto no es m谩s que informaci贸n sobre las etapas del ciclo de vida de un sistema automatizado (en adelante, AS).  Por lo tanto, el objeto de monitoreo SIEM es un sistema automatizado en su totalidad o en parte. <br><br>  Un sistema de altavoces no es un objeto est谩tico, tiende a cambiar constantemente: se introducen nuevos trabajos y servidores, se desarma el equipo viejo y se reemplaza por uno nuevo, los sistemas se "bloquean" debido a errores y se restauran de las copias de seguridad.  La din谩mica a nivel de red, como el direccionamiento din谩mico o el enrutamiento, cambia la cara de los altavoces todos los d铆as.  驴C贸mo verificarlo?  Intente encontrar en su empresa un esquema L3 completo y actual de la red y verifique con los administradores de la red cu谩nto refleja el estado actual de las cosas. <br><br>  Cuando desarrolle reglas de correlaci贸n, intente proceder de la apariencia de los hablantes aqu铆 y ahora.  Al probar las reglas de correlaci贸n, las refina a un estado en el que pueden trabajar con el menor n煤mero de falsos positivos en la configuraci贸n actual del altavoz.  Como los hablantes cambian constantemente, las reglas de correlaci贸n, tarde o temprano, tendr谩n que actualizarse. <br><br>  Ahora, compliquemos la tarea y consideremos las reglas proporcionadas por expertos externos, como los SOC comerciales, los integradores que implementan SIEM o los propios desarrolladores de soluciones SIEM.  Estas reglas no incluyen las caracter铆sticas de sus altavoces (el contexto de ejecuci贸n), no est谩n optimizadas para ellos.  Este problema es otro obst谩culo en el concepto de reglas de correlaci贸n que funcionan de forma inmediata.  Su soluci贸n puede ser ese SIEM dentro de s铆 mismo: <br><br><ol><li>  Construye un modelo de los altavoces observados. </li><li>  Siempre mantiene este modelo actualizado. </li><li>  Le permite usar este modelo como contexto de ejecuci贸n en las reglas de correlaci贸n. </li></ol><br><h1>  Contexto - Modelo de sistema automatizado </h1><br>  Primero, describimos la composici贸n del modelo de altavoz.  Si pasamos a la definici贸n cl谩sica de un t茅rmino de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">GOST 34.003-90</a> , entonces un AS es "un sistema que consiste en personal y un conjunto de herramientas de automatizaci贸n para sus actividades que implementa tecnolog铆a de informaci贸n para realizar funciones establecidas".  Es importante que al implementar tecnolog铆a de la informaci贸n, el personal (usuarios) y las herramientas de automatizaci贸n operen con datos. <br><br>  Dado que SIEM recopila informaci贸n de muchas fuentes diferentes, incluidas TI, seguridad de la informaci贸n y aplicaciones comerciales, todas las partes de esta definici贸n ser谩n "visibles" para nosotros directamente en los eventos. <br><br>  A continuaci贸n, describiremos c贸mo se ve el modelo creado para entidades como el usuario, un conjunto de herramientas de automatizaci贸n (en lo sucesivo, los sistemas de red y de computadora) y los datos. <br><br>  Desafortunadamente, es bastante dif铆cil modelar procesos tecnol贸gicos dentro del marco de SIEM, porque esa clase de soluciones no est谩 destinada a esto.  Sin embargo, parte de los procesos es visible a trav茅s de los modelos de comportamiento de estas entidades. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/fm/2p/kc/fm2pkc5kvi9a1kzgknivksk9uce.png" alt="Modelo de altavoz general"></div><br>  <i>Modelo de altavoz general</i> <br><br>  Adem谩s consideraremos cada entidad y nos detendremos en: <br><br><ul><li>  identificaci贸n 煤nica; </li><li>  la composici贸n del modelo; </li><li>  encontrar los datos necesarios para el modelo; </li><li>  la naturaleza del cambio en los datos de la entidad; </li><li>  actualizar datos en el modelo cuando cambian. </li></ul><br><h2>  Modelo de usuario </h2><br><h3>  Identificaci贸n </h3><br>  Un usuario de un AS debe entenderse como una persona espec铆fica: un empleado de una empresa, contratista o profesional independiente.  Es importante que haya autorizado el acceso a los altavoces. <br><br>  La informaci贸n sobre los usuarios de AS generalmente est谩 fragmentada en muchos sistemas.  Para armarlo, debes hacer un esfuerzo.  Veamos un ejemplo de d贸nde y qu茅 informaci贸n se puede recopilar para un usuario espec铆fico. <br><br><ol><li>  Microsoft Active Directory y Microsoft Exchange.  De ellos podemos averiguar su nombre de usuario principal de dominio y direcci贸n de correo electr贸nico. </li><li>  El Cisco Identity Services Engine (ISE) almacena su segundo inicio de sesi贸n para acceso remoto a trav茅s de VPN. </li><li>  La base de datos del portal interno almacena su tercer inicio de sesi贸n. </li><li>  Si el usuario es un administrador de la base de datos, el cuarto inicio de sesi贸n se almacena en el DBMS, y tal vez no uno. </li><li>  Base de datos de recursos humanos, en la que se almacena su nombre completo (en caso de que Active Directory fuera demasiado vago para obtener al usuario de acuerdo con todas las reglas). </li></ol><br>  Por lo tanto, si la empresa no cuenta con soluciones de gesti贸n de identidad o de derechos de usuario que al menos de alguna manera ayudan a reunir esta informaci贸n de identificaci贸n dispareja, deber谩 hacerlo usted mismo en SIEM manualmente. <br><br>  Para resumir: <br><br><ol><li>  SIEM requiere una sola identificaci贸n de usuario. </li><li>  Cuando las cuentas de usuario aparecen en cualquier registro, en cualquier sistema, debemos identificarlo de manera 煤nica y colocar nuestro propio identificador de usuario 煤nico. </li></ol><br><h3>  Composici贸n modelo </h3><br>  Al componer un modelo de cualquier entidad, lo dividimos en dos bloques.  El primer bloque se usa para almacenar informaci贸n general sobre la entidad, el segundo es responsable de compilar un modelo del comportamiento de la entidad.  Este perfil puede ser usado por las reglas de correlaci贸n para identificar desviaciones anormales en el comportamiento de una entidad. <br><br>  Como m铆nimo, se debe incluir lo siguiente en el modelo de usuario general: <br><br><ul><li>  ID de usuario 煤nico en SIEM </li><li>  Todos sus identificadores de varios sistemas, incluyendo: <br><ul><li>  direcciones de correo electr贸nico externas e internas; </li><li>  Nombre completo; </li><li>  Cuenta de sistema operativo local </li><li>  cuenta de dominio; </li><li>  Cuenta VPN </li><li>  Cuenta proxy </li><li>  Cuentas DBMS </li><li>  Cuentas en otros sistemas de aplicaci贸n. </li></ul></li><li>  Unidad organizativa en Microsoft Active Directory a la que pertenece el usuario; </li><li>  Grupos de Microsoft Active Directory a los que pertenece el usuario. </li></ul><br>  Como m铆nimo, el modelo de comportamiento de un usuario debe incluir: <br><br><ul><li>  tipo de conexi贸n utilizada (local, remota) y tipo de canal de comunicaci贸n (cableado, inal谩mbrico); </li><li>  dispositivos utilizados para acceder a la red corporativa; </li><li>  aplicaciones usadas; </li><li>  geo-encuadernaci贸n, especialmente para usuarios remotos; </li><li>  recursos de la empresa a los que se conecta el usuario; </li><li>  a qui茅n y qu茅 transferencias de datos (flujos de informaci贸n). </li></ul><br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/cx/ue/77/cxue77ottubbfc1kxmiwdadwprm.png" alt="Modelo de usuario"></div><br>  <i>Modelo de usuario</i> <br><br>  Perfilar los flujos de informaci贸n es una tarea dif铆cil para la cual SIEM a menudo carece de mecanismos convenientes y simples.  Pero la creaci贸n de dicho perfil puede comenzar con el correo electr贸nico y los recursos de red compartidos utilizados. <br><br><h3>  Fuentes de datos para el modelo </h3><br>  驴D贸nde obtener los datos necesarios para construir el modelo?  Considere los dos principios principales para obtener informaci贸n disponible en la mayor铆a de los SIEM: m茅todos de recopilaci贸n activos y pasivos. <br><br>  Con el <b>m茅todo activo,</b> SIEM se convierte en fuentes que contienen los datos necesarios para construir el modelo. <br>  Con el <b>m茅todo pasivo, el</b> modelo se llena en base a datos de eventos recibidos en SIEM de fuentes. <br><br>  Como regla general, para obtener el modelo m谩s completo, es mejor combinar dos m茅todos. <br><br>  Es importante comprender que los datos recopilados en el marco del modelo deben actualizarse constantemente y hacerse en modo autom谩tico en lugar de manual.  Exactamente los mismos m茅todos que se utilizan para su recopilaci贸n inicial ser谩n adecuados para actualizar los datos. <br><br>  Considere qu茅 fuentes pueden proporcionar datos para construir el modelo y de qu茅 manera puede obtener la informaci贸n necesaria de ellos. <br><br><div class="spoiler">  <b class="spoiler_title">Para modelo general</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/mx/jw/mu/mxjwmu98calzgr0e_3foan5fbhg.png"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Para un modelo de comportamiento</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/30/k7/0m/30k70mkr7qx0bh5uzbtjvbidcw4.png"><br></div></div><br><h2>  Modelo de red y sistemas inform谩ticos </h2><br><h3>  Identificaci贸n </h3><br>  Por elementos de red y sistemas inform谩ticos nos referimos a estaciones de trabajo, servidores y equipos de red, y herramientas de seguridad de la informaci贸n.  Por el momento, en SIEM y en las soluciones de gesti贸n de vulnerabilidades, se denominan activos. <br><br>  Parece bastante obvio que dichos activos se pueden identificar f谩cilmente por direcci贸n IP, direcci贸n MAC, FQDN o nombre de host (en adelante, las claves de identificaci贸n originales).  驴Es este siempre el caso?  Como se indic贸 anteriormente, algunos cambios tienen lugar constantemente en la UA.  Veamos algunos de estos cambios y pensemos en c贸mo se comportan nuestras claves de identificaci贸n originales. <br><br><ol><li>  Usar en una red DHCP.  Las direcciones IP de los activos est谩n cambiando. </li><li>  Cambio de nodos en una configuraci贸n de cl煤ster.  Dependiendo del tipo de agrupaci贸n, MAC e IP pueden cambiar. </li><li>  Restaurar un sistema desde una copia de seguridad en otro servidor debido a una falla cr铆tica.  Las direcciones MAC cambian, a veces IP, FQDN y nombre de host. </li><li>  Reemplazo planificado, modernizaci贸n de equipos o partes de altavoces.  Casi todas las llaves pueden cambiar. </li></ol><br>  En una empresa peque帽a, estos cambios pueden ser extremadamente raros y pueden ser manejados por los expertos a cargo de SIEM.  Pero, 驴y si una empresa con una amplia red de sucursales?  Y lejos de siempre, el servicio de IS tiene comunicaciones bien establecidas con el servicio de TI, lo que significa que el experto SIEM puede no obtener la informaci贸n necesaria sobre los cambios en el AS. <br><br>  Dado que no puede confiar en IP, MAC, FQDN o nombre de host por separado para identificar un activo, puede intentar identificarlo de inmediato mediante los 4 par谩metros.  Aqu铆 nos enfrentamos a un problema global: SIEM opera en eventos y casi nunca contienen todas las claves de identificaci贸n originales al mismo tiempo. <br><br>  驴C贸mo se puede resolver?  Veamos algunas opciones: <br><br><ol><li>  <b>M茅todo activo que utiliza soluciones del nivel de la base de datos de gesti贸n de configuraci贸n (CMDB)</b> .  Se puede obtener informaci贸n sobre las claves de identificaci贸n originales desde all铆.  驴Pero el CMDB contiene todas las claves de origen de los activos necesarios para la identificaci贸n?  Y, lo m谩s importante, 驴tiene en cuenta los cambios en los altavoces descritos anteriormente?  Tambi茅n es importante tener en cuenta el tiempo de actualizaci贸n de datos en CMDB, si los datos se retrasan docenas de minutos u horas detr谩s del estado real del AS; lo m谩s probable es que esta soluci贸n no sea adecuada para su uso en la correlaci贸n de eventos en SIEM. </li><li>  <b>Forma activa utilizando la soluci贸n de gesti贸n de vulnerabilidades</b> .  Puede cargar sus informes a SIEM, como, por ejemplo, Micro focus ArcSight.  驴Pero hay una garant铆a de que un esc谩ner de terceros traer谩 todos los datos necesarios para la identificaci贸n?  Cu谩n relevantes ser谩n si los escaneos se realizan no m谩s de una vez al mes (promedio para grandes empresas), y lejos de cubrir toda la infraestructura. </li><li>  <b>Forma pasiva</b> .  Identifique activos de eventos, a pesar de sus datos incompletos e inexactos.  Los eventos no contienen todas las claves; diferentes fuentes env铆an diferentes conjuntos de claves.  Sin embargo, esta es la forma m谩s r谩pida de obtener informaci贸n sobre los cambios en los altavoces.  Las fuentes, por regla general, generan eventos en todas las situaciones descritas anteriormente, con la excepci贸n del reemplazo planificado del equipo. </li><li>  <b>Forma h铆brida</b> .  Aproveche todos los enfoques a la vez: <br><ul><li>  La recolecci贸n activa con CMDB permite el llenado inicial r谩pido de activos SIEM. </li><li>  La integraci贸n con Vulnerability Management agregar谩 la informaci贸n que falta. </li><li>  Un an谩lisis de eventos le permitir谩 actualizar r谩pidamente el modelo, teniendo en cuenta los detalles de cada fuente individualmente. </li></ul><br>  El m茅todo h铆brido le permite nivelar los problemas de los dem谩s, pero es dif铆cil de implementar. </li></ol><br>  Por el momento, solo trabaj茅 con dos soluciones en las que los fabricantes ten铆an la experiencia para implementar este enfoque: IBM QRadar (descripci贸n general por <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">referencia</a> , los detalles del algoritmo est谩n cerrados) y Positive Technologies MaxPatrol SIEM (los detalles del algoritmo est谩n cerrados).  Por el momento, ambas compa帽铆as contin煤an usando y mejorando con precisi贸n el enfoque h铆brido. <br><br>  Entonces <br><br><ol><li>  Las estaciones de trabajo, los equipos de red y servidor deben identificarse de manera h铆brida, agregando datos de CMDB, sistemas de gesti贸n de vulnerabilidades y eventos de las propias fuentes. </li><li>  Para la correcta combinaci贸n y actualizaci贸n de la informaci贸n recopilada para su identificaci贸n, es necesario contar con mecanismos expertos que tengan en cuenta las caracter铆sticas de cada fuente. </li></ol><br><h3>  Composici贸n modelo </h3><br>  Los sistemas inform谩ticos, incluidos los sistemas y aplicaciones de software instalados en ellos, llevan mucha informaci贸n necesaria para mejorar la precisi贸n de las reglas de correlaci贸n. <br><br>  Al igual que el modelo de usuario, el modelo de red y sistemas inform谩ticos consta de una parte com煤n y de comportamiento. <br><br>  La composici贸n del modelo general de red y sistemas inform谩ticos debe incluir al menos: <br><br><ul><li>  hardware (incluidos dispositivos externos); </li><li>  usuarios terminados; </li><li>  servicios instalados y su paquete con puertos abiertos; </li><li>  software instalado y su versi贸n; </li><li>  actualizaciones instaladas; </li><li>  vulnerabilidades existentes; </li><li>  tareas programadas </li><li>  lista de software para el inicio; </li><li>  tablas de enrutamiento; </li><li>  recursos de red compartidos </li></ul><br>  La composici贸n del modelo de comportamiento de la red y los sistemas inform谩ticos debe incluir al menos: <br><br><ul><li>  Interacciones de red de L3 y L4 (con qu茅 interact煤a y seg煤n qu茅 protocolos); </li><li>  La cantidad promedio de datos transmitidos por semana; </li><li>  qu茅 usuarios est谩n usando; </li><li>  desde qu茅 nodos se implementa el control remoto; </li><li>  estad铆sticas del funcionamiento de las funciones de seguridad para este host (red y local). </li></ul><br><img src="https://habrastorage.org/webt/ki/db/fq/kidbfqjr2nniyvrdf2mtxcu33fq.png" alt="Modelo de red y sistemas inform谩ticos"><br>  <i>Modelo de red y sistemas inform谩ticos</i> <br><br><h3>  Fuentes de datos para el modelo </h3><br>  La recopilaci贸n de informaci贸n para este modelo es posible de dos maneras: activa y pasiva. <br><br>  Considere el modelo general: <br><br><div class="spoiler">  <b class="spoiler_title">Para modelo general</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/n2/0z/zg/n20zzgcknfxisjhb1tzkdhgcib8.png"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Para un modelo de comportamiento</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/9z/d3/v-/9zd3v-pfxgicgfrvlnvyxgzia2y.png"><br></div></div><br><h2>  Modelo de datos protegidos </h2><br><h3>  Identificaci贸n </h3><br>  Pasemos al 煤ltimo componente del contexto: el modelo de datos protegidos. <br><br>  La mayor铆a de las veces, SIEM no se usa para monitorear datos protegidos, ya que existen soluciones para la clase de Prevenci贸n de Fugas de Datos (DLP) para esto.  Sin embargo, este conocimiento ayuda a evaluar con mayor precisi贸n la importancia del incidente.  Por ejemplo, al escribir una regla de correlaci贸n, ser铆a 煤til saber que el incidente no solo ocurre en alguna estaci贸n de trabajo, sino en la estaci贸n que actualmente almacena el informe financiero del a帽o u otra informaci贸n confidencial. <br><br>  La identificaci贸n de la informaci贸n confidencial se implementa mediante un motor de b煤squeda de huellas digitales en la propia soluci贸n DLP.  La especificidad del mecanismo no permite implementarlo dentro de SIEM.  Por lo tanto, en t茅rminos de identificaci贸n de datos protegidos, es posible utilizar solo una estrecha integraci贸n con soluciones de clase DLP. <br><br><h3>  Composici贸n modelo </h3><br>  Debido al hecho de que DLP implementa la mayor parte del monitoreo y protecci贸n de la informaci贸n confidencial, la composici贸n del modelo en SIEM es bastante compacta. <br><br>  Como m铆nimo, se debe incluir lo siguiente en el modelo general de datos protegidos: <br><br><ul><li>  en qu茅 activos se almacena la informaci贸n confidencial; </li><li>  qu茅 usuarios tienen acceso a informaci贸n confidencial. </li></ul><br>  Al menos lo siguiente debe incluirse en el modelo de comportamiento de los datos protegidos: <br><br><ul><li>  entre qu茅 activos se transmite informaci贸n confidencial; </li><li>  entre qu茅 usuarios se transmite informaci贸n confidencial. </li></ul><br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/1h/_o/1-/1h_o1-hyencky58ht3qtkw8nuhk.png" alt="Modelo de datos protegidos"></div><br>  <i>Modelo de datos protegidos</i> <br><br><h3>  Fuentes de datos para el modelo </h3><br>  Para construir un modelo de datos protegidos, tambi茅n est谩n disponibles dos m茅todos para obtener informaci贸n: activa y pasiva. <br><br>  Considere el modelo general: <br><br><div class="spoiler">  <b class="spoiler_title">Para modelo general</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/8m/l3/em/8ml3emxgrdwmmzcaexnxtmzvz0g.png"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Para un modelo de comportamiento</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/sy/xp/3b/syxp3bghz2jqhmu7yawrnzhjyzc.png"><br></div></div><br><h1>  Modelos de mecanismos de implementaci贸n en SIEM </h1><br>  Veamos c贸mo es posible implementar un modelo de altavoz en SIEM.  Para hacer esto, a nivel SIEM, se deben abordar dos cuestiones principales: <br><br><ol><li>  C贸mo implementar la recopilaci贸n de datos activa y pasiva. </li><li>  D贸nde y de qu茅 forma almacenar el modelo. </li></ol><br>  <b>La recopilaci贸n de</b> datos <b>activos</b> para el modelo, por regla general, se lleva a cabo mediante mecanismos de integraci贸n SIEM con esc谩neres de seguridad.  Adem谩s, la recopilaci贸n activa se puede realizar descargando datos de fuentes externas, por ejemplo, bases de datos. <br><br>  <b>La recolecci贸n pasiva se</b> lleva a cabo analizando los eventos que pasan por el SIEM. <br><br>  Como regla general, en SIEM de la generaci贸n actual para almacenar los datos del modelo anterior, se utilizan las listas de tablas / Lista activa / Conjunto de referencia del conjunto y similares.  Con la recopilaci贸n de datos activa, las tareas planificadas se crean para completarlas desde fuentes externas.  Con la recopilaci贸n pasiva, se crean reglas de correlaci贸n separadas, dentro de las cuales, cuando aparecen los eventos necesarios (creaci贸n del usuario, eliminaci贸n de software, transferencia de archivos, etc.), los datos del evento se insertan en la lista de la tabla. <br><br>  En el caso general, todas las soluciones SIEM modernas contienen todos los elementos necesarios para crear y completar los datos del modelo de CA descrito. <br><br><h1>  La historicidad del modelo. </h1><br>  El AS est谩 cambiando constantemente, es importante tener en cuenta, si no en las reglas de correlaci贸n, ya que operan en modo casi en tiempo real y operan en el estado actual del AS, luego cuando se investiga un incidente.  Pueden transcurrir minutos, horas y, a veces, meses desde el momento en que comienza un incidente hasta su investigaci贸n.  Con algunos ataques, pueden transcurrir hasta 6 meses entre la introducci贸n de un atacante en el sistema y la detecci贸n de sus actividades por el SIEM ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Estudio de costo de una violaci贸n de datos de 2018 por Ponemon</a> ).  Durante este tiempo, el panorama del sistema puede cambiar dr谩sticamente: los usuarios se agregan y eliminan, la configuraci贸n del equipo ha cambiado, el equipo importante para la investigaci贸n del incidente ha dejado de funcionar y los datos copiados por el atacante de un host se han "derramado" a otro.  Por lo tanto, durante la investigaci贸n es importante observar el modelo del sistema en el estado en que se encontraba en el momento del incidente, y no en el actual, cuando reci茅n comenzamos a investigarlo. <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> La conclusi贸n de todo esto es la siguiente: el que est谩 construido dentro de SIEM debe tener un historial al que se pueda acceder en cualquier momento. </font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/8v/sd/lb/8vsdlbk-rl2js1ioeswjhaqjjbq.png" alt="Cambio de modelo a lo largo del tiempo"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cambio de modelo a lo largo del tiempo</font></font></i> <br><br><a name="Conclusions"></a><br><h1>  Conclusiones </h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Para resumir: </font></font><br><br><ol><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Para que las reglas de correlaci贸n funcionen con un n煤mero m铆nimo de falsos positivos, deben tener en cuenta el contexto en el que trabajan. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> El contexto para las reglas de correlaci贸n es el modelo del sistema automatizado de la compa帽铆a. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> SIEM est谩 obligado a construir este modelo en el curso de su trabajo. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> El modelo de sistema automatizado consta de tres partes principales: </font></font><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> modelo de usuario y comportamiento; </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> modelo de red y sistemas inform谩ticos, sus conexiones de red y su comportamiento; </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> modelo de datos protegidos y su comportamiento. </font></font></li></ul></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Los datos necesarios para el modelo se pueden recopilar de dos maneras: </font></font><br><ul><li> <b></b>     ; </li><li> <b></b>        . </li></ul></li><li>         ,      .          . </li><li>           . </li><li>           ,          ,        ,     . </li><li>     SIEM   . </li></ol><br><hr><br> <b> :</b> <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="> SIEM:  芦 禄.  1:     ?</a> <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="> SIEM:  芦 禄.  2.      芦禄</a> <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="> SIEM:  芦 禄.  3.1.  </a> <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="> SIEM:  芦 禄.  3.2.   </a> <br><br>  SIEM:  芦 禄.  4.       ( <i> </i> ) <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="> SIEM:  芦 禄.  5.    </a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/441098/">https://habr.com/ru/post/441098/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../441082/index.html">Los boletos para Marte costar谩n menos de $ 500,000</a></li>
<li><a href="../441084/index.html">驴A d贸nde fueron los primeros adoptadores?</a></li>
<li><a href="../441090/index.html">AI de audio: extracci贸n de voces de la m煤sica usando redes neuronales convolucionales</a></li>
<li><a href="../441092/index.html">Embedded World 2019: la mayor exposici贸n de electr贸nica integrada</a></li>
<li><a href="../441096/index.html">Simulador de lectura de art铆culos</a></li>
<li><a href="../441102/index.html">Kaspersky Mobile Talks: una reuni贸n para desarrolladores avanzados</a></li>
<li><a href="../441104/index.html">Obtenci贸n de informaci贸n y omisi贸n de la autenticaci贸n de dos factores en tarjetas bancarias de TOP-10 (Ucrania)</a></li>
<li><a href="../441108/index.html">Ya no es un concepto: Samsung present贸 el tel茅fono plegable Galaxy Fold por $ 1980</a></li>
<li><a href="../441112/index.html">Fijamos la autorizaci贸n LDAP a Kubernetes</a></li>
<li><a href="../441114/index.html">Programaci贸n relacional: dolor, inter茅s y dolor de nuevo.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>