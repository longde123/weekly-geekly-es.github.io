<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧜🏾 🎶 🦁 Profundidades SIEM: correlaciones listas para usar. Parte 4. Modelo del sistema como contexto de reglas de correlación 🖖🏾 📤 📤</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Imagine la situación: pasó mucho tiempo escribiendo y depurando reglas de correlación, y un día después descubrió que no funcionaban. Como dicen, esto...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Profundidades SIEM: correlaciones listas para usar. Parte 4. Modelo del sistema como contexto de reglas de correlación</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pt/blog/441098/">  Imagine la situación: pasó mucho tiempo escribiendo y depurando reglas de correlación, y un día después descubrió que no funcionaban.  Como dicen, esto nunca ha sucedido y aquí de nuevo!  Luego resulta que por la noche la red se actualizó una vez más y se reemplazaron un par de servidores, pero las reglas de correlación no tienen esto en cuenta.  En este artículo, le mostraremos cómo enseñarle a SIEM a adaptarse al panorama cambiante de la infraestructura. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/g9/u2/9g/g9u29g2rux2enwdrvq7rwhltfvg.png" alt="Modelo de sistema como contexto de reglas de correlación"></div><br><a name="habracut"></a><br>  Nos estamos acercando cada vez más al final de la serie de artículos dedicados a la creación de reglas de correlación adaptativa que funcionan de forma inmediata.  El artículo resultó ser largo, quien quiera puede llegar inmediatamente a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">conclusiones</a> . <br><br>  En el artículo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">"Metodología para normalizar eventos"</a> resumimos técnicas que ayudarán a minimizar el problema de la pérdida de datos y la normalización incorrecta de los eventos iniciales.  Sin embargo, ¿se puede argumentar que, si se reduce el papel de los errores de normalización, es posible hacer reglas de correlación que funcionen de forma inmediata?  Teóricamente, sí, si el objeto de monitoreo monitoreado por SIEM sería estático y funcionaría exclusivamente como está escrito en los términos de referencia.  Pero en la práctica resulta que en el mundo real no hay nada estático. <br><br>  Por lo tanto, consideraremos con más detalle el objeto de monitoreo.  SIEM recopila registros de fuentes, de ellos extrae direcciones IP, cuentas de usuario, acceso a archivos y claves de registro, interacciones de red.  Si todo se resume, esto no es más que información sobre las etapas del ciclo de vida de un sistema automatizado (en adelante, AS).  Por lo tanto, el objeto de monitoreo SIEM es un sistema automatizado en su totalidad o en parte. <br><br>  Un sistema de altavoces no es un objeto estático, tiende a cambiar constantemente: se introducen nuevos trabajos y servidores, se desarma el equipo viejo y se reemplaza por uno nuevo, los sistemas se "bloquean" debido a errores y se restauran de las copias de seguridad.  La dinámica a nivel de red, como el direccionamiento dinámico o el enrutamiento, cambia la cara de los altavoces todos los días.  ¿Cómo verificarlo?  Intente encontrar en su empresa un esquema L3 completo y actual de la red y verifique con los administradores de la red cuánto refleja el estado actual de las cosas. <br><br>  Cuando desarrolle reglas de correlación, intente proceder de la apariencia de los hablantes aquí y ahora.  Al probar las reglas de correlación, las refina a un estado en el que pueden trabajar con el menor número de falsos positivos en la configuración actual del altavoz.  Como los hablantes cambian constantemente, las reglas de correlación, tarde o temprano, tendrán que actualizarse. <br><br>  Ahora, compliquemos la tarea y consideremos las reglas proporcionadas por expertos externos, como los SOC comerciales, los integradores que implementan SIEM o los propios desarrolladores de soluciones SIEM.  Estas reglas no incluyen las características de sus altavoces (el contexto de ejecución), no están optimizadas para ellos.  Este problema es otro obstáculo en el concepto de reglas de correlación que funcionan de forma inmediata.  Su solución puede ser ese SIEM dentro de sí mismo: <br><br><ol><li>  Construye un modelo de los altavoces observados. </li><li>  Siempre mantiene este modelo actualizado. </li><li>  Le permite usar este modelo como contexto de ejecución en las reglas de correlación. </li></ol><br><h1>  Contexto - Modelo de sistema automatizado </h1><br>  Primero, describimos la composición del modelo de altavoz.  Si pasamos a la definición clásica de un término de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">GOST 34.003-90</a> , entonces un AS es "un sistema que consiste en personal y un conjunto de herramientas de automatización para sus actividades que implementa tecnología de información para realizar funciones establecidas".  Es importante que al implementar tecnología de la información, el personal (usuarios) y las herramientas de automatización operen con datos. <br><br>  Dado que SIEM recopila información de muchas fuentes diferentes, incluidas TI, seguridad de la información y aplicaciones comerciales, todas las partes de esta definición serán "visibles" para nosotros directamente en los eventos. <br><br>  A continuación, describiremos cómo se ve el modelo creado para entidades como el usuario, un conjunto de herramientas de automatización (en lo sucesivo, los sistemas de red y de computadora) y los datos. <br><br>  Desafortunadamente, es bastante difícil modelar procesos tecnológicos dentro del marco de SIEM, porque esa clase de soluciones no está destinada a esto.  Sin embargo, parte de los procesos es visible a través de los modelos de comportamiento de estas entidades. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/fm/2p/kc/fm2pkc5kvi9a1kzgknivksk9uce.png" alt="Modelo de altavoz general"></div><br>  <i>Modelo de altavoz general</i> <br><br>  Además consideraremos cada entidad y nos detendremos en: <br><br><ul><li>  identificación única; </li><li>  la composición del modelo; </li><li>  encontrar los datos necesarios para el modelo; </li><li>  la naturaleza del cambio en los datos de la entidad; </li><li>  actualizar datos en el modelo cuando cambian. </li></ul><br><h2>  Modelo de usuario </h2><br><h3>  Identificación </h3><br>  Un usuario de un AS debe entenderse como una persona específica: un empleado de una empresa, contratista o profesional independiente.  Es importante que haya autorizado el acceso a los altavoces. <br><br>  La información sobre los usuarios de AS generalmente está fragmentada en muchos sistemas.  Para armarlo, debes hacer un esfuerzo.  Veamos un ejemplo de dónde y qué información se puede recopilar para un usuario específico. <br><br><ol><li>  Microsoft Active Directory y Microsoft Exchange.  De ellos podemos averiguar su nombre de usuario principal de dominio y dirección de correo electrónico. </li><li>  El Cisco Identity Services Engine (ISE) almacena su segundo inicio de sesión para acceso remoto a través de VPN. </li><li>  La base de datos del portal interno almacena su tercer inicio de sesión. </li><li>  Si el usuario es un administrador de la base de datos, el cuarto inicio de sesión se almacena en el DBMS, y tal vez no uno. </li><li>  Base de datos de recursos humanos, en la que se almacena su nombre completo (en caso de que Active Directory fuera demasiado vago para obtener al usuario de acuerdo con todas las reglas). </li></ol><br>  Por lo tanto, si la empresa no cuenta con soluciones de gestión de identidad o de derechos de usuario que al menos de alguna manera ayudan a reunir esta información de identificación dispareja, deberá hacerlo usted mismo en SIEM manualmente. <br><br>  Para resumir: <br><br><ol><li>  SIEM requiere una sola identificación de usuario. </li><li>  Cuando las cuentas de usuario aparecen en cualquier registro, en cualquier sistema, debemos identificarlo de manera única y colocar nuestro propio identificador de usuario único. </li></ol><br><h3>  Composición modelo </h3><br>  Al componer un modelo de cualquier entidad, lo dividimos en dos bloques.  El primer bloque se usa para almacenar información general sobre la entidad, el segundo es responsable de compilar un modelo del comportamiento de la entidad.  Este perfil puede ser usado por las reglas de correlación para identificar desviaciones anormales en el comportamiento de una entidad. <br><br>  Como mínimo, se debe incluir lo siguiente en el modelo de usuario general: <br><br><ul><li>  ID de usuario único en SIEM </li><li>  Todos sus identificadores de varios sistemas, incluyendo: <br><ul><li>  direcciones de correo electrónico externas e internas; </li><li>  Nombre completo; </li><li>  Cuenta de sistema operativo local </li><li>  cuenta de dominio; </li><li>  Cuenta VPN </li><li>  Cuenta proxy </li><li>  Cuentas DBMS </li><li>  Cuentas en otros sistemas de aplicación. </li></ul></li><li>  Unidad organizativa en Microsoft Active Directory a la que pertenece el usuario; </li><li>  Grupos de Microsoft Active Directory a los que pertenece el usuario. </li></ul><br>  Como mínimo, el modelo de comportamiento de un usuario debe incluir: <br><br><ul><li>  tipo de conexión utilizada (local, remota) y tipo de canal de comunicación (cableado, inalámbrico); </li><li>  dispositivos utilizados para acceder a la red corporativa; </li><li>  aplicaciones usadas; </li><li>  geo-encuadernación, especialmente para usuarios remotos; </li><li>  recursos de la empresa a los que se conecta el usuario; </li><li>  a quién y qué transferencias de datos (flujos de información). </li></ul><br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/cx/ue/77/cxue77ottubbfc1kxmiwdadwprm.png" alt="Modelo de usuario"></div><br>  <i>Modelo de usuario</i> <br><br>  Perfilar los flujos de información es una tarea difícil para la cual SIEM a menudo carece de mecanismos convenientes y simples.  Pero la creación de dicho perfil puede comenzar con el correo electrónico y los recursos de red compartidos utilizados. <br><br><h3>  Fuentes de datos para el modelo </h3><br>  ¿Dónde obtener los datos necesarios para construir el modelo?  Considere los dos principios principales para obtener información disponible en la mayoría de los SIEM: métodos de recopilación activos y pasivos. <br><br>  Con el <b>método activo,</b> SIEM se convierte en fuentes que contienen los datos necesarios para construir el modelo. <br>  Con el <b>método pasivo, el</b> modelo se llena en base a datos de eventos recibidos en SIEM de fuentes. <br><br>  Como regla general, para obtener el modelo más completo, es mejor combinar dos métodos. <br><br>  Es importante comprender que los datos recopilados en el marco del modelo deben actualizarse constantemente y hacerse en modo automático en lugar de manual.  Exactamente los mismos métodos que se utilizan para su recopilación inicial serán adecuados para actualizar los datos. <br><br>  Considere qué fuentes pueden proporcionar datos para construir el modelo y de qué manera puede obtener la información necesaria de ellos. <br><br><div class="spoiler">  <b class="spoiler_title">Para modelo general</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/mx/jw/mu/mxjwmu98calzgr0e_3foan5fbhg.png"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Para un modelo de comportamiento</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/30/k7/0m/30k70mkr7qx0bh5uzbtjvbidcw4.png"><br></div></div><br><h2>  Modelo de red y sistemas informáticos </h2><br><h3>  Identificación </h3><br>  Por elementos de red y sistemas informáticos nos referimos a estaciones de trabajo, servidores y equipos de red, y herramientas de seguridad de la información.  Por el momento, en SIEM y en las soluciones de gestión de vulnerabilidades, se denominan activos. <br><br>  Parece bastante obvio que dichos activos se pueden identificar fácilmente por dirección IP, dirección MAC, FQDN o nombre de host (en adelante, las claves de identificación originales).  ¿Es este siempre el caso?  Como se indicó anteriormente, algunos cambios tienen lugar constantemente en la UA.  Veamos algunos de estos cambios y pensemos en cómo se comportan nuestras claves de identificación originales. <br><br><ol><li>  Usar en una red DHCP.  Las direcciones IP de los activos están cambiando. </li><li>  Cambio de nodos en una configuración de clúster.  Dependiendo del tipo de agrupación, MAC e IP pueden cambiar. </li><li>  Restaurar un sistema desde una copia de seguridad en otro servidor debido a una falla crítica.  Las direcciones MAC cambian, a veces IP, FQDN y nombre de host. </li><li>  Reemplazo planificado, modernización de equipos o partes de altavoces.  Casi todas las llaves pueden cambiar. </li></ol><br>  En una empresa pequeña, estos cambios pueden ser extremadamente raros y pueden ser manejados por los expertos a cargo de SIEM.  Pero, ¿y si una empresa con una amplia red de sucursales?  Y lejos de siempre, el servicio de IS tiene comunicaciones bien establecidas con el servicio de TI, lo que significa que el experto SIEM puede no obtener la información necesaria sobre los cambios en el AS. <br><br>  Dado que no puede confiar en IP, MAC, FQDN o nombre de host por separado para identificar un activo, puede intentar identificarlo de inmediato mediante los 4 parámetros.  Aquí nos enfrentamos a un problema global: SIEM opera en eventos y casi nunca contienen todas las claves de identificación originales al mismo tiempo. <br><br>  ¿Cómo se puede resolver?  Veamos algunas opciones: <br><br><ol><li>  <b>Método activo que utiliza soluciones del nivel de la base de datos de gestión de configuración (CMDB)</b> .  Se puede obtener información sobre las claves de identificación originales desde allí.  ¿Pero el CMDB contiene todas las claves de origen de los activos necesarios para la identificación?  Y, lo más importante, ¿tiene en cuenta los cambios en los altavoces descritos anteriormente?  También es importante tener en cuenta el tiempo de actualización de datos en CMDB, si los datos se retrasan docenas de minutos u horas detrás del estado real del AS; lo más probable es que esta solución no sea adecuada para su uso en la correlación de eventos en SIEM. </li><li>  <b>Forma activa utilizando la solución de gestión de vulnerabilidades</b> .  Puede cargar sus informes a SIEM, como, por ejemplo, Micro focus ArcSight.  ¿Pero hay una garantía de que un escáner de terceros traerá todos los datos necesarios para la identificación?  Cuán relevantes serán si los escaneos se realizan no más de una vez al mes (promedio para grandes empresas), y lejos de cubrir toda la infraestructura. </li><li>  <b>Forma pasiva</b> .  Identifique activos de eventos, a pesar de sus datos incompletos e inexactos.  Los eventos no contienen todas las claves; diferentes fuentes envían diferentes conjuntos de claves.  Sin embargo, esta es la forma más rápida de obtener información sobre los cambios en los altavoces.  Las fuentes, por regla general, generan eventos en todas las situaciones descritas anteriormente, con la excepción del reemplazo planificado del equipo. </li><li>  <b>Forma híbrida</b> .  Aproveche todos los enfoques a la vez: <br><ul><li>  La recolección activa con CMDB permite el llenado inicial rápido de activos SIEM. </li><li>  La integración con Vulnerability Management agregará la información que falta. </li><li>  Un análisis de eventos le permitirá actualizar rápidamente el modelo, teniendo en cuenta los detalles de cada fuente individualmente. </li></ul><br>  El método híbrido le permite nivelar los problemas de los demás, pero es difícil de implementar. </li></ol><br>  Por el momento, solo trabajé con dos soluciones en las que los fabricantes tenían la experiencia para implementar este enfoque: IBM QRadar (descripción general por <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">referencia</a> , los detalles del algoritmo están cerrados) y Positive Technologies MaxPatrol SIEM (los detalles del algoritmo están cerrados).  Por el momento, ambas compañías continúan usando y mejorando con precisión el enfoque híbrido. <br><br>  Entonces <br><br><ol><li>  Las estaciones de trabajo, los equipos de red y servidor deben identificarse de manera híbrida, agregando datos de CMDB, sistemas de gestión de vulnerabilidades y eventos de las propias fuentes. </li><li>  Para la correcta combinación y actualización de la información recopilada para su identificación, es necesario contar con mecanismos expertos que tengan en cuenta las características de cada fuente. </li></ol><br><h3>  Composición modelo </h3><br>  Los sistemas informáticos, incluidos los sistemas y aplicaciones de software instalados en ellos, llevan mucha información necesaria para mejorar la precisión de las reglas de correlación. <br><br>  Al igual que el modelo de usuario, el modelo de red y sistemas informáticos consta de una parte común y de comportamiento. <br><br>  La composición del modelo general de red y sistemas informáticos debe incluir al menos: <br><br><ul><li>  hardware (incluidos dispositivos externos); </li><li>  usuarios terminados; </li><li>  servicios instalados y su paquete con puertos abiertos; </li><li>  software instalado y su versión; </li><li>  actualizaciones instaladas; </li><li>  vulnerabilidades existentes; </li><li>  tareas programadas </li><li>  lista de software para el inicio; </li><li>  tablas de enrutamiento; </li><li>  recursos de red compartidos </li></ul><br>  La composición del modelo de comportamiento de la red y los sistemas informáticos debe incluir al menos: <br><br><ul><li>  Interacciones de red de L3 y L4 (con qué interactúa y según qué protocolos); </li><li>  La cantidad promedio de datos transmitidos por semana; </li><li>  qué usuarios están usando; </li><li>  desde qué nodos se implementa el control remoto; </li><li>  estadísticas del funcionamiento de las funciones de seguridad para este host (red y local). </li></ul><br><img src="https://habrastorage.org/webt/ki/db/fq/kidbfqjr2nniyvrdf2mtxcu33fq.png" alt="Modelo de red y sistemas informáticos"><br>  <i>Modelo de red y sistemas informáticos</i> <br><br><h3>  Fuentes de datos para el modelo </h3><br>  La recopilación de información para este modelo es posible de dos maneras: activa y pasiva. <br><br>  Considere el modelo general: <br><br><div class="spoiler">  <b class="spoiler_title">Para modelo general</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/n2/0z/zg/n20zzgcknfxisjhb1tzkdhgcib8.png"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Para un modelo de comportamiento</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/9z/d3/v-/9zd3v-pfxgicgfrvlnvyxgzia2y.png"><br></div></div><br><h2>  Modelo de datos protegidos </h2><br><h3>  Identificación </h3><br>  Pasemos al último componente del contexto: el modelo de datos protegidos. <br><br>  La mayoría de las veces, SIEM no se usa para monitorear datos protegidos, ya que existen soluciones para la clase de Prevención de Fugas de Datos (DLP) para esto.  Sin embargo, este conocimiento ayuda a evaluar con mayor precisión la importancia del incidente.  Por ejemplo, al escribir una regla de correlación, sería útil saber que el incidente no solo ocurre en alguna estación de trabajo, sino en la estación que actualmente almacena el informe financiero del año u otra información confidencial. <br><br>  La identificación de la información confidencial se implementa mediante un motor de búsqueda de huellas digitales en la propia solución DLP.  La especificidad del mecanismo no permite implementarlo dentro de SIEM.  Por lo tanto, en términos de identificación de datos protegidos, es posible utilizar solo una estrecha integración con soluciones de clase DLP. <br><br><h3>  Composición modelo </h3><br>  Debido al hecho de que DLP implementa la mayor parte del monitoreo y protección de la información confidencial, la composición del modelo en SIEM es bastante compacta. <br><br>  Como mínimo, se debe incluir lo siguiente en el modelo general de datos protegidos: <br><br><ul><li>  en qué activos se almacena la información confidencial; </li><li>  qué usuarios tienen acceso a información confidencial. </li></ul><br>  Al menos lo siguiente debe incluirse en el modelo de comportamiento de los datos protegidos: <br><br><ul><li>  entre qué activos se transmite información confidencial; </li><li>  entre qué usuarios se transmite información confidencial. </li></ul><br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/1h/_o/1-/1h_o1-hyencky58ht3qtkw8nuhk.png" alt="Modelo de datos protegidos"></div><br>  <i>Modelo de datos protegidos</i> <br><br><h3>  Fuentes de datos para el modelo </h3><br>  Para construir un modelo de datos protegidos, también están disponibles dos métodos para obtener información: activa y pasiva. <br><br>  Considere el modelo general: <br><br><div class="spoiler">  <b class="spoiler_title">Para modelo general</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/8m/l3/em/8ml3emxgrdwmmzcaexnxtmzvz0g.png"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Para un modelo de comportamiento</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/sy/xp/3b/syxp3bghz2jqhmu7yawrnzhjyzc.png"><br></div></div><br><h1>  Modelos de mecanismos de implementación en SIEM </h1><br>  Veamos cómo es posible implementar un modelo de altavoz en SIEM.  Para hacer esto, a nivel SIEM, se deben abordar dos cuestiones principales: <br><br><ol><li>  Cómo implementar la recopilación de datos activa y pasiva. </li><li>  Dónde y de qué forma almacenar el modelo. </li></ol><br>  <b>La recopilación de</b> datos <b>activos</b> para el modelo, por regla general, se lleva a cabo mediante mecanismos de integración SIEM con escáneres de seguridad.  Además, la recopilación activa se puede realizar descargando datos de fuentes externas, por ejemplo, bases de datos. <br><br>  <b>La recolección pasiva se</b> lleva a cabo analizando los eventos que pasan por el SIEM. <br><br>  Como regla general, en SIEM de la generación actual para almacenar los datos del modelo anterior, se utilizan las listas de tablas / Lista activa / Conjunto de referencia del conjunto y similares.  Con la recopilación de datos activa, las tareas planificadas se crean para completarlas desde fuentes externas.  Con la recopilación pasiva, se crean reglas de correlación separadas, dentro de las cuales, cuando aparecen los eventos necesarios (creación del usuario, eliminación de software, transferencia de archivos, etc.), los datos del evento se insertan en la lista de la tabla. <br><br>  En el caso general, todas las soluciones SIEM modernas contienen todos los elementos necesarios para crear y completar los datos del modelo de CA descrito. <br><br><h1>  La historicidad del modelo. </h1><br>  El AS está cambiando constantemente, es importante tener en cuenta, si no en las reglas de correlación, ya que operan en modo casi en tiempo real y operan en el estado actual del AS, luego cuando se investiga un incidente.  Pueden transcurrir minutos, horas y, a veces, meses desde el momento en que comienza un incidente hasta su investigación.  Con algunos ataques, pueden transcurrir hasta 6 meses entre la introducción de un atacante en el sistema y la detección de sus actividades por el SIEM ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Estudio de costo de una violación de datos de 2018 por Ponemon</a> ).  Durante este tiempo, el panorama del sistema puede cambiar drásticamente: los usuarios se agregan y eliminan, la configuración del equipo ha cambiado, el equipo importante para la investigación del incidente ha dejado de funcionar y los datos copiados por el atacante de un host se han "derramado" a otro.  Por lo tanto, durante la investigación es importante observar el modelo del sistema en el estado en que se encontraba en el momento del incidente, y no en el actual, cuando recién comenzamos a investigarlo. <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> La conclusión de todo esto es la siguiente: el que está construido dentro de SIEM debe tener un historial al que se pueda acceder en cualquier momento. </font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/8v/sd/lb/8vsdlbk-rl2js1ioeswjhaqjjbq.png" alt="Cambio de modelo a lo largo del tiempo"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cambio de modelo a lo largo del tiempo</font></font></i> <br><br><a name="Conclusions"></a><br><h1>  Conclusiones </h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Para resumir: </font></font><br><br><ol><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Para que las reglas de correlación funcionen con un número mínimo de falsos positivos, deben tener en cuenta el contexto en el que trabajan. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> El contexto para las reglas de correlación es el modelo del sistema automatizado de la compañía. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> SIEM está obligado a construir este modelo en el curso de su trabajo. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> El modelo de sistema automatizado consta de tres partes principales: </font></font><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> modelo de usuario y comportamiento; </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> modelo de red y sistemas informáticos, sus conexiones de red y su comportamiento; </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> modelo de datos protegidos y su comportamiento. </font></font></li></ul></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Los datos necesarios para el modelo se pueden recopilar de dos maneras: </font></font><br><ul><li> <b></b>     ; </li><li> <b></b>        . </li></ul></li><li>         ,      .          . </li><li>           . </li><li>           ,          ,        ,     . </li><li>     SIEM   . </li></ol><br><hr><br> <b> :</b> <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="> SIEM:  « ».  1:     ?</a> <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="> SIEM:  « ».  2.      «»</a> <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="> SIEM:  « ».  3.1.  </a> <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="> SIEM:  « ».  3.2.   </a> <br><br>  SIEM:  « ».  4.       ( <i> </i> ) <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="> SIEM:  « ».  5.    </a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/441098/">https://habr.com/ru/post/441098/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../441082/index.html">Los boletos para Marte costarán menos de $ 500,000</a></li>
<li><a href="../441084/index.html">¿A dónde fueron los primeros adoptadores?</a></li>
<li><a href="../441090/index.html">AI de audio: extracción de voces de la música usando redes neuronales convolucionales</a></li>
<li><a href="../441092/index.html">Embedded World 2019: la mayor exposición de electrónica integrada</a></li>
<li><a href="../441096/index.html">Simulador de lectura de artículos</a></li>
<li><a href="../441102/index.html">Kaspersky Mobile Talks: una reunión para desarrolladores avanzados</a></li>
<li><a href="../441104/index.html">Obtención de información y omisión de la autenticación de dos factores en tarjetas bancarias de TOP-10 (Ucrania)</a></li>
<li><a href="../441108/index.html">Ya no es un concepto: Samsung presentó el teléfono plegable Galaxy Fold por $ 1980</a></li>
<li><a href="../441112/index.html">Fijamos la autorización LDAP a Kubernetes</a></li>
<li><a href="../441114/index.html">Programación relacional: dolor, interés y dolor de nuevo.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>