<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üåÆ üë®üèº‚Äçüè´ üì´ Wi-Fi und viele andere Abk√ºrzungen. So erhalten Sie Daten auf Wi-Fi-Knoten in einer Android-Anwendung und schwellen nicht an üë©‚Äçüë¶‚Äçüë¶ ü§πüèΩ ü¶ã</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Einmal musste ich Wi-Fi-Netzwerkanwendungen von Android aus scannen und eine detaillierte Berechnung der Daten √ºber Access Points erhalten. 

 Hier ha...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Wi-Fi und viele andere Abk√ºrzungen. So erhalten Sie Daten auf Wi-Fi-Knoten in einer Android-Anwendung und schwellen nicht an</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/467765/"> Einmal musste ich Wi-Fi-Netzwerkanwendungen von Android aus scannen und eine detaillierte Berechnung der Daten √ºber Access Points erhalten. <br><a name="habracut"></a><br>  Hier hatte ich mit mehreren Schwierigkeiten zu k√§mpfen: In der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Off-Dokumentation von Android wurden</a> viele der beschriebenen Klassen veraltet (API-Level&gt; 26), was sich darin nicht widerspiegelte;  Die Beschreibung einiger Dinge in der Dokumentation ist minimal (zum Beispiel wurde das Funktionsfeld der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ScanResult-</a> Klasse zum Zeitpunkt des Schreibens in keiner Weise beschrieben, obwohl es viele wichtige Daten enth√§lt).  Die dritte Schwierigkeit kann darin bestehen, dass Sie, wenn Sie sich zum ersten Mal dem WLAN n√§hern, das sich vom Lesen der Theorie und dem Einrichten des Routers f√ºr localhost unterscheidet, mit einer Reihe von Abk√ºrzungen umgehen m√ºssen, die separat verst√§ndlich erscheinen.  Es ist jedoch m√∂glicherweise nicht offensichtlich, wie sie in Beziehung gesetzt und strukturiert werden sollen (die Beurteilung ist subjektiv und h√§ngt von fr√ºheren Erfahrungen ab). <br><br>  In diesem Artikel wird erl√§utert, wie Sie umfassende Daten zu Wi-Fi-Umgebungen aus Android-Code ohne NDK und Hacks abrufen, jedoch nur mithilfe der Android-API, und wie Sie diese interpretieren. <br><br>  Wir werden nicht ziehen und anfangen, Code zu schreiben. <br><br><h3>  1. Erstellen Sie ein Projekt </h3><br>  Der Hinweis richtet sich an Personen, die das Android-Projekt mehrmals erstellt haben. Daher lassen wir die Details dieses Elements weg.  Der folgende Code wird in der Kotlin-Sprache minSdkVersion = 23 angezeigt. <br><br><h3>  2. Zugriffsberechtigungen </h3><br>  Um mit Wi-Fi in der Anwendung arbeiten zu k√∂nnen, m√ºssen Sie vom Benutzer mehrere Berechtigungen einholen.  Gem√§√ü der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Dokumentation</a> ben√∂tigen Sie zum Scannen des Netzwerks auf Ger√§ten mit Betriebssystemversionen nach 8.0 zus√§tzlich zum Zugriff auf den Status der Netzwerkumgebung entweder Zugriff, um den Status des Wi-Fi-Moduls des Ger√§ts zu √§ndern, oder Zugriff auf Koordinaten (ungef√§hr oder genau).  Ab Version 9.0 m√ºssen Sie den Benutzer f√ºr beides und das anfordern und den Benutzer ausdr√ºcklich auffordern, den Ortungsdienst zu aktivieren.  Vergessen Sie nicht, dem Nutzer galant zu erkl√§ren, dass dies eine Laune von Google ist und nicht unser Wunsch, ihn auszuspionieren :) <br><br>  Insgesamt in AndroidManifest.xml hinzuf√ºgen: <br><br><pre><code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.ACCESS_NETWORK_STATE"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.ACCESS_WIFI_STATE"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.CHANGE_WIFI_STATE"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.ACCESS_FINE_LOCATION"</span></span></span><span class="hljs-tag">/&gt;</span></span></code> </pre> <br>  Und im Code, der einen Link zur aktuellen Aktivit√§t enth√§lt: <br><br><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.app.Activity <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.content.Context <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.location.LocationManager <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> androidx.core.app.ActivityCompat .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (android.os.Build.VERSION.SDK_INT &gt;= android.os.Build.VERSION_CODES.O) { ActivityCompat.requestPermissions( activity, arrayOf(Manifest.permission.ACCESS_FINE_LOCATION, Manifest.permission.CHANGE_WIFI_STATE), <span class="hljs-number"><span class="hljs-number">1</span></span> ) makeEnableLocationServices(activity.applicationContext) } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { ActivityCompat.requestPermissions( activity, arrayOf(Manifest.permission.CHANGE_WIFI_STATE), <span class="hljs-number"><span class="hljs-number">1</span></span> ) } <span class="hljs-comment"><span class="hljs-comment">/*        */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">makeEnableLocationServices</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(context: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Context</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { <span class="hljs-comment"><span class="hljs-comment">// </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">TODO:</span></span></span><span class="hljs-comment">       ,      val lm: LocationManager = context.applicationContext.getSystemService(Context.LOCATION_SERVICE) as LocationManager val gpsEnabled: Boolean = lm.isProviderEnabled(LocationManager.GPS_PROVIDER); val networkEnabled: Boolean = lm.isProviderEnabled(LocationManager.NETWORK_PROVIDER); if (!gpsEnabled &amp;&amp; !networkEnabled) { context.startActivity(Intent(ACTION_LOCATION_SOURCE_SETTINGS)); } }</span></span></code> </pre><br><h3>  3. Erstellen Sie BroadcastReceiver und abonnieren Sie Aktualisierungsereignisse beim Scannen der Wi-Fi-Netzwerkumgebung </h3><br><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">val</span></span> wifiManager = context.getSystemService(Context.WIFI_SERVICE) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> WifiManager <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> wifiScanReceiver = <span class="hljs-keyword"><span class="hljs-keyword">object</span></span> : BroadcastReceiver() { <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onReceive</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(context: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Context</span></span></span></span><span class="hljs-function"><span class="hljs-params">, intent: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Intent</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> success = intent.getBooleanExtra(WifiManager.EXTRA_RESULTS_UPDATED, <span class="hljs-literal"><span class="hljs-literal">false</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (success) { scanSuccess() } } } <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> intentFilter = IntentFilter() <span class="hljs-comment"><span class="hljs-comment">/*         */</span></span> intentFilter.addAction(WifiManager.SCAN_RESULTS_AVAILABLE_ACTION) context.registerReceiver(wifiScanReceiver, intentFilter) <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> success = wifiManager.startScan() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!success) { <span class="hljs-comment"><span class="hljs-comment">/* -     ,    */</span></span> } .... <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">scanSuccess</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-comment"><span class="hljs-comment">/*  ,   */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> results: List&lt;ScanResult&gt; = wifiManager.scanResults }</code> </pre><br>  Die WiFiManager.startScan-Methode in der Dokumentation ist in API-Version 28 als nicht verf√ºgbar markiert, jedoch deaktiviert.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Anleitung</a> schl√§gt vor, es zu verwenden. <br><br>  Insgesamt haben wir eine Liste der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ScanResult-</a> Objekte erhalten. <br><br><h3>  4. Wir schauen uns ScanResult an und verstehen die Begriffe </h3><br>  Schauen wir uns einige Felder dieser Klasse an und beschreiben, was sie bedeuten: <br><br>  <b>SSID</b> - Service Set Identifier ist der Name des Netzwerks. <br><br>  <b>BSSID</b> - Basic Service Set Identifier - MAC-Adresse des Netzwerkadapters (Wi-Fi-Punkt) <br><br>  <b>Pegel</b> - Anzeige der St√§rke des empfangenen Signals [dBm (russisch dBm) - Dezibel, Referenzleistung 1 mW.] - Anzeige des Pegels des empfangenen Signals.  Es nimmt einen Wert von 0 bis -100 an. Je weiter von 0 entfernt, desto mehr Signalleistung geht auf dem Weg vom Wi-Fi-Punkt zu Ihrem Ger√§t verloren.  Weitere Details finden Sie beispielsweise auf <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Wikipedia</a> .  Hier <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">m√∂chte</a> ich Ihnen sagen, dass Sie mit dem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">WifiManager</a> der Android-Klasse den Signalpegel mit dem von Ihnen ausgew√§hlten Schritt auf einer Skala von ausgezeichnet bis schrecklich kalibrieren k√∂nnen: <br><br><pre> <code class="kotlin hljs"> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> wifiManager = context.applicationContext.getSystemService(Context.WIFI_SERVICE) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> WifiManager <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> numberOfLevels = <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> level = WifiManager.calculateSignalLevel(level, numberOfLevels)</code> </pre><br>  <b>Frequenz</b> - Die Frequenz des Wi-Fi-Punkts [Hz].  Neben der Frequenz selbst k√∂nnte Sie auch der sogenannte Kanal interessieren.  Jeder Punkt hat seine eigene Sauberkeit.  Zum Zeitpunkt des Schreibens betr√§gt der beliebteste Bereich von Wi-Fi-Punkten 2,4 GHz.  Genauer gesagt √ºbertr√§gt der Punkt Informationen mit einer nummerierten Frequenz nahe der genannten auf Ihr Telefon.  Die Anzahl der Kan√§le und die Werte der entsprechenden Frequenzen sind <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">standardisiert</a> .  Dies geschieht so, dass nahegelegene Punkte mit unterschiedlichen Frequenzen arbeiten, wodurch sie sich nicht gegenseitig st√∂ren und die Geschwindigkeit und Qualit√§t der √úbertragung nicht gegenseitig verringern.  Gleichzeitig arbeiten die Punkte nicht auf derselben Frequenz, sondern auf dem Frequenzbereich ( <b>Parameter</b> channelWidth), der als Kanalbreite bezeichnet wird.  Das hei√üt, Punkte, die auf benachbarten Kan√§len (und nicht nur auf benachbarten Kan√§len, sondern sogar auf 3 von sich selbst) arbeiten, erzeugen Interferenzen miteinander.  Dieser einfache Code kann f√ºr Sie n√ºtzlich sein, mit dem Sie die Kanalnummer anhand des Frequenzwerts f√ºr Punkte mit einer Frequenz von 2,4 und 5 GHz berechnen k√∂nnen: <br><br><pre> <code class="kotlin hljs"><span class="hljs-comment"><span class="hljs-comment">/*      */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> channel: <span class="hljs-built_in"><span class="hljs-built_in">Int</span></span> <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (frequency <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-number"><span class="hljs-number">2412</span></span>..<span class="hljs-number"><span class="hljs-number">2484</span></span>) { (frequency - <span class="hljs-number"><span class="hljs-number">2412</span></span>) / <span class="hljs-number"><span class="hljs-number">5</span></span> + <span class="hljs-number"><span class="hljs-number">1</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (frequency <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-number"><span class="hljs-number">5170</span></span>..<span class="hljs-number"><span class="hljs-number">5825</span></span>) { (frequency - <span class="hljs-number"><span class="hljs-number">5170</span></span>) / <span class="hljs-number"><span class="hljs-number">5</span></span> + <span class="hljs-number"><span class="hljs-number">34</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { -<span class="hljs-number"><span class="hljs-number">1</span></span> } }</code> </pre><br>  <b>F√§higkeiten</b> sind das interessanteste Feld f√ºr die Analyse, dessen Arbeit viel Zeit in Anspruch nahm.  Hier werden die "F√§higkeiten" des Punktes in die Linie geschrieben.  In diesem Fall k√∂nnen Details zur Interpretation der Zeichenfolge in der Dokumentation nicht gesucht werden.  Hier sind einige Beispiele daf√ºr, was in dieser Zeile liegen k√∂nnte: <br><br><pre> <code class="bash hljs">[WPA-PSK-TKIP+CCMP][WPA2-PSK-TKIP+CCMP][WPS][ESS] [WPA2-PSK-CCMP][ESS] [WPA2-PSK-CCMP+TKIP][ESS] [WPA-PSK-CCMP+TKIP][WPA2-PSK-CCMP+TKIP][ESS] [ESS][WPS]</code> </pre><br><h3>  5. Abk√ºrzungen und Parsim-Funktionen verstehen </h3><br>  Es ist erw√§hnenswert, dass die Klassen des Pakets android.net.wifi. * Verwendet das Linux-Dienstprogramm <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">wpa_supplicant</a> unter der Haube, und die Ausgabe im Feld "Funktionen" ist eine Kopie des Felds "Flags" w√§hrend des Scannens. <br><br>  Wir werden nacheinander handeln.  Betrachten Sie zun√§chst die Ausgabe eines Formats, in dem Elemente in den Klammern durch ein "-" - Zeichen getrennt sind: <br><br><pre> <code class="bash hljs">[WPA-PSK-TKIP+CCMP] [WPA2-PSK-CCMP]</code> </pre><br>  Der erste Wert beschreibt das sogenannte  <b>Authentifizierungsmethode</b>  Das hei√üt, welche Abfolge von Aktionen vom Ger√§t und vom Zugriffspunkt ausgef√ºhrt werden muss, damit der Zugriffspunkt selbst verwendet werden kann und wie die Nutzdaten verschl√ºsselt werden.  Zum Zeitpunkt des Schreibens dieses Beitrags sind die h√§ufigsten Optionen WPA und WPA2, bei denen entweder jedes Ger√§t direkt oder √ºber das sogenannte angeschlossen ist.  Der RADIUS-Server (WPA-Enterprice) stellt ein Kennwort √ºber einen verschl√ºsselten Kanal bereit.  H√∂chstwahrscheinlich stellt der Zugangspunkt bei Ihnen zu Hause eine Verbindung gem√§√ü diesem Schema her.  Der Unterschied zwischen der zweiten und der ersten Version in einer robusteren Verschl√ºsselung: AES gegen unsicheres TKIP.  WPA3, das komplexer und fortschrittlicher ist, wird ebenfalls schrittweise eingef√ºhrt.  Theoretisch gibt es m√∂glicherweise eine Option f√ºr die CCKM-Unternehmensl√∂sung (Cisco Centralized Key Managment), die ich jedoch noch nie getroffen habe. <br><br>  Der Zugriffspunkt kann f√ºr die Authentifizierung anhand der MAC-Adresse konfiguriert werden.  Wenn der Access Point Daten mithilfe des veralteten WEP-Algorithmus bereitstellt, erfolgt praktisch keine Authentifizierung (der geheime Schl√ºssel ist hier der Verschl√ºsselungsschl√ºssel).  Diese Optionen werden als SONSTIGES klassifiziert. <br>  Es gibt auch eine bevorzugte Methode im √∂ffentlichen WLAN mit versteckter Captive Portal-Erkennung - eine Anforderung zur Authentifizierung √ºber einen Browser.  Solche Zugangspunkte scheinen f√ºr den Scanner offen zu sein (was sie aus Sicht der physischen Verbindung sind).  Daher klassifizieren wir sie als OFFEN. <br><br>  Der zweite Wert kann als <b>Schl√ºsselverwaltungsalgorithmus festgelegt werden</b> .  Es ist ein Parameter der oben beschriebenen Authentifizierungsmethode.  Spricht dar√ºber, wie genau der Austausch von Verschl√ºsselungsschl√ºsseln erfolgt.  Betrachten wir die m√∂glichen Optionen.  EAP - wird im oben genannten WPA-Unternehmenspreis verwendet und verwendet eine Datenbank, um die eingegebenen Authentifizierungsdaten zu √ºberpr√ºfen.  SAE - wird in fortgeschrittenem WPA3 verwendet und ist widerstandsf√§higer gegen Busting.  PSK ist die h√§ufigste Option. Dabei wird das Kennwort eingegeben und verschl√ºsselt √ºbertragen.  IEEE8021X - gem√§√ü dem internationalen Standard (au√üer von der WPA-Familie unterst√ºtzt).  OWE (Opportunistic Wireless Encryption) ist eine Erweiterung des IEEE 802.11-Standards f√ºr die Punkte, die wir als OPEN klassifiziert haben.  OWE gew√§hrleistet die Sicherheit von Daten, die √ºber ein unsicheres Netzwerk √ºbertragen werden, indem es diese verschl√ºsselt.  Eine Variante ist auch m√∂glich, wenn keine Zugriffsschl√ºssel vorhanden sind. Nennen wir diese Option NONE. <br><br>  Der dritte Parameter ist der sogenannte  <b>Verschl√ºsselungsmethode (Verschl√ºsselungsschemata)</b> - Wie genau wird die Verschl√ºsselung zum Schutz der √ºbertragenen Daten verwendet?  Wir listen die Optionen auf.  WEP - verwendet eine RC4-Stream-Verschl√ºsselung, der geheime Schl√ºssel ist ein Verschl√ºsselungsschl√ºssel, der in der Welt der modernen Kryptographie als inakzeptabel angesehen wird.  TKIP - verwendet in WPA, CKIP - in WPA2.  TKIP + CKIP - kann aus Gr√ºnden der Abw√§rtskompatibilit√§t an WPA- und WPA2-f√§higen Punkten angegeben werden. <br><br>  Anstelle von drei Elementen finden Sie eine einzelne WEP-Markierung: <br><br><pre> <code class="bash hljs">[WEP]</code> </pre><br>  Wie oben erl√§utert, reicht dies aus, um den Algorithmus f√ºr die Verwendung von nicht vorhandenen Schl√ºsseln und die standardm√§√üig verwendete Verschl√ºsselungsmethode nicht anzugeben. <br><br>  Betrachten Sie nun diese Klammer: <br><br><pre> <code class="bash hljs">[ESS]</code> </pre><br>  Dies ist <b>der Wi-Fi-Betriebsmodus</b> oder die <b>Topologie von Wi-Fi-Netzwerken</b> .  M√∂glicherweise tritt der BSS-Modus (Basic Service Set) auf, wenn es einen Zugangspunkt gibt, √ºber den verbundene Ger√§te kommunizieren.  Kann in lokalen Netzwerken gefunden werden.  In der Regel werden Zugriffspunkte ben√∂tigt, um Ger√§te aus verschiedenen lokalen Netzwerken zu verbinden. Sie sind daher Teil der ESS (Extended Service Sets).  Der Typ der IBSSs (Independent Basic Service Sets) gibt an, dass das Ger√§t Teil eines Peer-to-Peer-Netzwerks ist. <br><br>  Die WPS-Flagge kann auch fallen: <br><br><pre> <code class="bash hljs">[WPS]</code> </pre><br>  WPS (Wi-Fi Protected Setup) - ein Protokoll zur halbautomatischen Initialisierung eines Wi-Fi-Netzwerks.  Zum Initialisieren gibt der Benutzer entweder ein 8-stelliges Passwort ein oder klemmt eine Taste am Router.  Wenn Ihr Zugangspunkt vom ersten Typ ist und dieses Flag neben dem Namen Ihres Zugangspunkts hervorgehoben ist, wird dringend empfohlen, zum Admin-Bereich zu gehen und den Zugriff √ºber WPS zu deaktivieren.  Tatsache ist, dass eine 8-stellige PIN h√§ufig an der MAC-Adresse erkannt oder in absehbarer Zeit aussortiert werden kann, was jemand, der nicht sauber ist, nutzen kann. <br><br><h3>  6. Erstellen Sie ein Parsing-Modell und eine Parsing-Funktion </h3><br>  Basierend auf dem, was wir oben herausgefunden haben, beschreiben wir mit Datenklassen, was passiert ist: <br><br><pre> <code class="kotlin hljs"><span class="hljs-comment"><span class="hljs-comment">/*   */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">enum</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AuthMethod</span></span></span><span class="hljs-class"> </span></span>{ WPA3, WPA2, WPA, <span class="hljs-comment"><span class="hljs-comment">// Wi-Fi Protected Access OTHER, //    Shared Key Authentication  .  mac-address-based  WEP CCKM, // Cisco OPEN // Open Authentication.     Captive Portal Detection -     } /*    */ enum class KeyManagementAlgorithm { IEEE8021X, //   EAP, // Extensible Authentication Protocol,    PSK, // Pre-Shared Key ‚Äî         WEP, //  WEP     (No auth key) SAE, // Simultaneous Authentication of Equals -    WPA3 OWE, // Opportunistic Wireless Encryption -    ,    OPEN NONE //      OPEN, OTHER } /*   */ enum class CipherMethod { WEP, // Wired Equivalent Privacy,       TKIP, // Temporal Key Integrity Protocol CCMP, // Counter Mode with Cipher Block Chaining Message Authentication Code Protocol, //              //   AES NONE //      OPEN, OTHER } /*     ,      */ data class Capability( var authScheme: AuthMethod? = null, var keyManagementAlgorithm: KeyManagementAlgorithm? = null, var cipherMethod: CipherMethod? = null ) /*   WiFi (   WiFi) */ enum class TopologyMode { IBSS, //   (Ad-Hoc  IBSS ‚Äì Independent Basic Service Set). BSS, //    Basic Service Set (BSS)  Infrastructure Mode. ESS //    ESS ‚Äì Extended Service Set. }</span></span></code> </pre><br>  Jetzt schreiben wir eine Funktion, die das Feld "Funktionen" analysiert: <br><br><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">parseCapabilities</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(capabilitiesString: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>: List &lt; Capability &gt; { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> capabilities: List &lt; Capability &gt; = capabilitiesString .splitByBrackets() .filter { !it.isTopology() &amp;&amp; !it.isWps() } .flatMap { parseCapability(it) } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!capabilities.isEmpty()) { capabilities } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { listOf(Capability(AuthMethod.OPEN, KeyManagementAlgorithm.NONE, CipherMethod.NONE)) } } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">parseCapability</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(part: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>: List &lt; Capability &gt; { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (part.contains(<span class="hljs-string"><span class="hljs-string">"WEP"</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> listOf(Capability( AuthMethod.OTHER, KeyManagementAlgorithm.WEP, CipherMethod.WEP )) } <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> authScheme = <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> { part.contains(<span class="hljs-string"><span class="hljs-string">"WPA3"</span></span>) - &gt; AuthMethod.WPA3 part.contains(<span class="hljs-string"><span class="hljs-string">"WPA2"</span></span>) - &gt; AuthMethod.WPA2 part.contains(<span class="hljs-string"><span class="hljs-string">"WPA"</span></span>) - &gt; AuthMethod.WPA <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> - &gt; <span class="hljs-literal"><span class="hljs-literal">null</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> keyManagementAlgorithm = <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> { part.contains(<span class="hljs-string"><span class="hljs-string">"OWE"</span></span>) - &gt; KeyManagementAlgorithm.OWE part.contains(<span class="hljs-string"><span class="hljs-string">"SAE"</span></span>) - &gt; KeyManagementAlgorithm.SAE part.contains(<span class="hljs-string"><span class="hljs-string">"IEEE802.1X"</span></span>) - &gt; KeyManagementAlgorithm.IEEE8021X part.contains(<span class="hljs-string"><span class="hljs-string">"EAP"</span></span>) - &gt; KeyManagementAlgorithm.EAP part.contains(<span class="hljs-string"><span class="hljs-string">"PSK"</span></span>) - &gt; KeyManagementAlgorithm.PSK <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> - &gt; <span class="hljs-literal"><span class="hljs-literal">null</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> capabilities = ArrayList &lt; Capability &gt; () <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (part.contains(<span class="hljs-string"><span class="hljs-string">"TKIP"</span></span>) || part.contains(<span class="hljs-string"><span class="hljs-string">"CCMP"</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (part.contains(<span class="hljs-string"><span class="hljs-string">"TKIP"</span></span>)) { capabilities.add(Capability( authScheme ? : AuthMethod.OPEN, keyManagementAlgorithm ? : KeyManagementAlgorithm.NONE, CipherMethod.TKIP )) } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (part.contains(<span class="hljs-string"><span class="hljs-string">"CCMP"</span></span>)) { capabilities.add(Capability( authScheme ? : AuthMethod.OPEN, keyManagementAlgorithm ? : KeyManagementAlgorithm.NONE, CipherMethod.CCMP )) } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (authScheme != <span class="hljs-literal"><span class="hljs-literal">null</span></span> || keyManagementAlgorithm != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { capabilities.add(Capability( authScheme ? : AuthMethod.OPEN, keyManagementAlgorithm ? : KeyManagementAlgorithm.NONE, CipherMethod.NONE )) } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> capabilities } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">parseTopologyMode</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(capabilitiesString: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>: TopologyMode ? { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> capabilitiesString .splitByBrackets() .mapNotNull { <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> { it.contains(<span class="hljs-string"><span class="hljs-string">"ESS"</span></span>) - &gt; TopologyMode.ESS it.contains(<span class="hljs-string"><span class="hljs-string">"BSS"</span></span>) - &gt; TopologyMode.BSS it.contains(<span class="hljs-string"><span class="hljs-string">"IBSS"</span></span>) - &gt; TopologyMode.IBSS <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> - &gt; <span class="hljs-literal"><span class="hljs-literal">null</span></span> } } .firstOrNull() } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">parseWPSAvailable</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(capabilitiesString: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>: <span class="hljs-built_in"><span class="hljs-built_in">Boolean</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> capabilitiesString .splitByBrackets() .any { it.isWps() } } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> String.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">splitByBrackets</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>: List &lt; String &gt; { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> m = Pattern.compile(<span class="hljs-string"><span class="hljs-string">"\\[(.*?)\\]"</span></span>).matcher(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> parts = ArrayList &lt; String &gt; () <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (m.find()) { parts.add(m.group().replace(<span class="hljs-string"><span class="hljs-string">"["</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>).replace(<span class="hljs-string"><span class="hljs-string">"]"</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>)) } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> parts } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> String.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isTopology</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>: <span class="hljs-built_in"><span class="hljs-built_in">Boolean</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> TopologyMode.values().any { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span> == it.name } } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> String.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isWps</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>: <span class="hljs-built_in"><span class="hljs-built_in">Boolean</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span> == <span class="hljs-string"><span class="hljs-string">"WPS"</span></span> }</code> </pre><br><h3>  8. Wir schauen uns das Ergebnis an </h3><br>  Ich werde das Netzwerk scannen und zeigen, was passiert ist.  Anzeigen der Ergebnisse der einfachen Ausgabe √ºber Log.d: <br><br><pre> <code class="plaintext hljs">Capability of Home-Home [WPA2-PSK-CCMP][ESS][WPS] ... capabilities=[Capability(authScheme=WPA2, keyManagementAlgorithm=PSK, cipherMethod=CCMP)], topologyMode=ESS, availableWps=true</code> </pre><br>  Die Frage der Verbindung zum Netzwerk √ºber den Anwendungscode blieb unbeantwortet.  Ich kann nur sagen, dass Sie zum Lesen der gespeicherten Betriebssystemkennw√∂rter eines Mobilger√§ts Root-Rechte und die Bereitschaft ben√∂tigen, das Dateisystem zu durchsuchen, um wpa_supplicant.conf zu lesen.  Wenn die Anwendungslogik die Eingabe eines Kennworts von au√üen umfasst, kann die Verbindung √ºber die Klasse <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">android.net.wifi.WifiManager hergestellt werden</a> . <br><br>  Vielen Dank an <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Egor Ponomarev</a> f√ºr wertvolle Erg√§nzungen. <br><br>  Wenn Sie denken, dass Sie etwas hinzuf√ºgen oder reparieren m√ºssen, schreiben Sie in die Kommentare :) </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de467765/">https://habr.com/ru/post/de467765/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de467753/index.html">Weltrekord f√ºr drahtlose Daten√ºbertragung: 40 Gbit / s pro 11 Kilometer</a></li>
<li><a href="../de467755/index.html">Prionen, Kalzium, Mikrobiota, Nahrungshormone und Alzheimer</a></li>
<li><a href="../de467759/index.html">Unix-√§hnliches Betriebssystemdesign - Virtueller Adressraum (6)</a></li>
<li><a href="../de467761/index.html">Energie, W√§rme und Wasser Teil drei: Gehen Sie zum Radio</a></li>
<li><a href="../de467763/index.html">Die ganze Wahrheit √ºber RTOS. Artikel # 33. Verwenden des Echtzeit-Betriebssystems Nucleus SE</a></li>
<li><a href="../de467767/index.html">Weitere Annehmlichkeiten f√ºr JSON-RPC-Follower</a></li>
<li><a href="../de467769/index.html">Auf einer einzigen Bundesinformationsquelle, die Bev√∂lkerungsinformationen enth√§lt</a></li>
<li><a href="../de467773/index.html">Beschaffung ungew√∂hnlicher Ressourcen und Erstkontakt</a></li>
<li><a href="../de467775/index.html">5 Mythen √ºber das Gesch√§ft: Warum der Kunde falsch liegt und wie man Apple √ºbertrifft</a></li>
<li><a href="../de467779/index.html">√úber Godot, GLSL und WebGL, Shader, die im Minispiel verwendet werden</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>