<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§∂üèΩ ‚åõÔ∏è ü•ë Diarizaci√≥n basada en el modelo GMM-UBM y el algoritmo de adaptaci√≥n MAP üëÇüèø ü¶Ä üë®üèø‚Äçüåæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hola Habr Me gustar√≠a hablar sobre uno de los enfoques para resolver el problema de la diarizaci√≥n del hablante y mostrar c√≥mo se puede implementar es...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Diarizaci√≥n basada en el modelo GMM-UBM y el algoritmo de adaptaci√≥n MAP</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/420515/">  Hola Habr  Me gustar√≠a hablar sobre uno de los enfoques para resolver el problema de la diarizaci√≥n del hablante y mostrar c√≥mo se puede implementar este m√©todo en Python.  Para no asustar al lector, no dar√© f√≥rmulas matem√°ticas complejas (en parte porque yo mismo "no soy un verdadero soldador"), pero intentar√© explicar todo en un lenguaje simple y contarlo todo de tal manera que un desarrollador que nunca antes haya encontrado el aprendizaje autom√°tico lo haya entendido. <br><a name="habracut"></a><br>  Al prepararme para escribir este art√≠culo, eleg√≠ entre dos opciones: para aquellos que ya est√°n familiarizados con Data Science y para aquellos que simplemente programan bien.  Al final, eleg√≠ la segunda opci√≥n, decidiendo que ser√≠a una buena demostraci√≥n de las capacidades de DS. <br><br><h3>  Declaraci√≥n del problema. </h3><br>  Como nos <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">dice</a> Wikipedia, la diarizaci√≥n es el proceso de dividir una secuencia de audio entrante en segmentos homog√©neos de acuerdo con si la secuencia de audio pertenece a uno u otro altavoz.  En otras palabras, el registro debe dividirse en partes y numerarse: una persona habla en estos lugares y otra en estos lugares.  Desde el punto de vista del aprendizaje autom√°tico, las tareas de este tipo pertenecen a la clase de aprendizaje sin un maestro y se denominan agrupaciones.  Puede leer acerca de qu√© m√©todos de agrupaci√≥n existen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu√≠</a> o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu√≠</a> , por ejemplo, pero solo hablar√© de los que nos son √∫tiles: este es un modelo de mezcla gaussiana y agrupaci√≥n espectral.  Pero sobre ellos un poco m√°s tarde. <br>  Comencemos desde el principio. <br><br><h3>  Preparaci√≥n del medio ambiente </h3><br><div class="spoiler">  <b class="spoiler_title">Spoiler</b> <div class="spoiler_text">  No estaba seguro de si abandonar esta secci√≥n; no quer√≠a convertir el art√≠culo en un tutorial.  Pero al final lo dej√©.  Quien no lo necesite saltar√°, y para aquellos que har√°n todo desde cero, este paso facilitar√° el inicio. <br></div></div><br>  En t√©rminos generales, adem√°s de R, python es el lenguaje principal para resolver problemas de Data Science, y si a√∫n no ha intentado programarlo, le recomiendo hacerlo porque python le permite hacer muchas cosas con elegancia, literalmente en unas pocas l√≠neas (por cierto, hay incluso ese meme). <br><br>  Hay dos ramas de python en desarrollo por separado: las versiones 2 y 3. En mis ejemplos, utilic√© la versi√≥n 3.6, pero si lo deseaba, se pueden portar f√°cilmente a la versi√≥n 2.7.  Es conveniente implementar cualquiera de estas ramas junto con el instalador de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Anaconda</a> , instalando el cual recibir√° de inmediato un shell interactivo para el desarrollo: IPython. <br><br>  Adem√°s del entorno de desarrollo en s√≠, se necesitar√°n bibliotecas adicionales: librosa (para trabajar con audio y extraer atributos), webrtcvad (para segmentaci√≥n) y pickle (para escribir modelos entrenados en un archivo).  Todos ellos se instalan mediante un comando simple en Anaconda Prompt. <br><br><pre><code class="hljs sql">pip <span class="hljs-keyword"><span class="hljs-keyword">install</span></span> [<span class="hljs-keyword"><span class="hljs-keyword">library</span></span>]</code> </pre> <br><h3>  Extracci√≥n de caracter√≠sticas </h3><br>  Comencemos con la extracci√≥n de caracter√≠sticas: datos con los que trabajar√°n los modelos de aprendizaje autom√°tico.  En principio, la se√±al de sonido en s√≠ misma ya son datos, es decir, una matriz ordenada de valores de amplitud de sonido, a la que se agrega un encabezado que contiene el n√∫mero de canales, frecuencia de muestreo y otra informaci√≥n.  Pero no podremos analizar estos datos directamente, ya que no contienen esas cosas, observando qu√©, nuestro modelo puede decir: s√≠, estas piezas pertenecen a la misma persona. <br><br>  En las tareas de procesamiento de voz, hay varios enfoques para extraer funciones.  Una de ellas es obtener coeficientes cepstrales de frecuencia de mel.  Ya se <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">han</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">escrito</a> aqu√≠, as√≠ que solo te recordar√© un poco. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/fg/dn/w-/fgdnw-m6jhpjb7b1wbj1xevahps.png" alt="imagen"></div><br>  La se√±al original se corta en cuadros con una longitud de 16-40 ms.  Luego, aplicando una ventana de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Hamming</a> al marco, realizan una r√°pida transformaci√≥n de Fourier y obtienen la densidad espectral de potencia.  Luego, con un "peine" especial de filtros dispuestos uniformemente en la escala de tiza, se crea un espectrograma de tiza, al que se aplica una transformada discreta de coseno (DCT), un algoritmo de compresi√≥n de datos ampliamente utilizado.  Los coeficientes as√≠ obtenidos son una especie de caracter√≠stica comprimida del marco, y dado que los filtros que utilizamos estaban ubicados en la escala de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">tiza</a> , los coeficientes transportan m√°s informaci√≥n en el rango de percepci√≥n del o√≠do humano.  T√≠picamente, se utilizan de 13 a 25 MFCC por cuadro.  Como adem√°s del espectro en s√≠, la personalidad de la voz est√° formada por la velocidad y la aceleraci√≥n, MFCC se combina con la primera y la segunda derivada. <br><br>  En general, MFCC es la opci√≥n m√°s com√∫n para trabajar con el habla, pero hay otros signos adem√°s de ellos: LPC (Codificaci√≥n predictiva lineal) y PLP (Predicci√≥n lineal perceptual), y a veces tambi√©n puede encontrar LFCC, donde en lugar de la escala de tiza, se usa lineal. <br><br>  Veamos c√≥mo extraer MFCC en python. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> librosa mfcc=librosa.feature.mfcc(y=y, sr=sr, hop_length=int(hop_seconds*sr), n_fft=int(window_seconds*sr), n_mfcc=n_mfcc) mfcc_delta=librosa.feature.delta(mfcc) mfcc_delta2=librosa.feature.delta(mfcc, order=<span class="hljs-number"><span class="hljs-number">2</span></span>) stacked=np.vstack((mfcc, mfcc_delta, mfcc_delta2)) features=stacked.T <span class="hljs-comment"><span class="hljs-comment">#librosa   MFCC   ,       .</span></span></code> </pre><br>  Como puede ver, esto realmente se hace en unas pocas l√≠neas.  Ahora pasemos al primer algoritmo de agrupamiento. <br><br><h3>  Modelo de mezcla gaussiana </h3><br>  Un modelo de una mezcla de distribuciones gaussianas sugiere que nuestros datos son una mezcla de distribuciones gaussianas multidimensionales con ciertos par√°metros. <br><br>  Si lo desea, puede encontrar f√°cilmente una descripci√≥n detallada del modelo y c√≥mo funciona el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">algoritmo EM</a> que entrena este modelo, pero promet√≠ no molestar con f√≥rmulas complejas y, por lo tanto, mostrar√© hermosos ejemplos de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">este</a> art√≠culo. <br><br>  Generaremos cuatro grupos y los dibujaremos. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.datasets.samples_generator <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> make_blobs X, y_true=make_blobs(n_samples=<span class="hljs-number"><span class="hljs-number">400</span></span>, centers=<span class="hljs-number"><span class="hljs-number">4</span></span>, cluster_std=<span class="hljs-number"><span class="hljs-number">0.60</span></span>, random_state=<span class="hljs-number"><span class="hljs-number">0</span></span>) plt.scatter(X[:, <span class="hljs-number"><span class="hljs-number">0</span></span>], X[:, <span class="hljs-number"><span class="hljs-number">1</span></span>]);</code> </pre><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/px/my/d7/pxmyd7covni39hf8fq19684nrv0.png" alt="imagen"></div><br>  Crearemos un modelo, entrenaremos sobre nuestros datos y nuevamente dibujaremos los puntos, pero teniendo en cuenta el modelo predicho de membres√≠a de cl√∫ster. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.mixture <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> GaussianMixture gmm = GaussianMixture(n_components=<span class="hljs-number"><span class="hljs-number">4</span></span>) gmm.fit(X) labels=gmm.predict(X) plt.scatter(X[:, <span class="hljs-number"><span class="hljs-number">0</span></span>], X[:, <span class="hljs-number"><span class="hljs-number">1</span></span>], c=labels, s=<span class="hljs-number"><span class="hljs-number">40</span></span>, cmap=<span class="hljs-string"><span class="hljs-string">'viridis'</span></span>);</code> </pre><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/n0/2y/6n/n02y6nz_1nw3krhnatqj_qf5o9k.png" alt="imagen"></div><br>  El modelo se las arregl√≥ bien con datos artificiales.  En principio, al regular el n√∫mero de componentes de la mezcla y el tipo de matriz de covarianza (el n√∫mero de grados de libertad de los gaussianos), se pueden describir datos bastante complicados. <br><br><img src="https://habrastorage.org/webt/ni/je/-m/nije-mrfqiykrrfykphnafbyr5w.png" alt="imagen"><br><br>  Entonces, sabemos c√≥mo parametrizar los datos y podemos entrenar un modelo de una mezcla de distribuciones gaussianas.  Ahora se podr√≠a tratar de agrupar en la frente: entrenar GMM en el MFCC extra√≠do del di√°logo.  Y, probablemente, en alg√∫n di√°logo ideal de vac√≠o esf√©rico, en el que cada hablante se ajuste a su gaussiano, obtendremos un buen resultado.  Est√° claro que en realidad esto nunca suceder√°.  De hecho, con la ayuda de GMM, no modelan un di√°logo, pero cada persona en un di√°logo, es decir, imaginan que la voz de cada hablante en los signos extra√≠dos es descrita por su propio conjunto de gaussianos. <br>  Para resumir, estamos llegando lentamente al tema principal. <br><br><h3>  Segmentaci√≥n </h3><br>  Tradicionalmente, el proceso de diarizaci√≥n consta de tres bloques consecutivos: detecci√≥n de voz (detecci√≥n de actividad de voz), segmentaci√≥n y agrupamiento (existen modelos en los que se combinan los dos √∫ltimos pasos, ver <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">LIA E-HMM</a> ). <br><br>  En el primer paso, el habla se separa de varios tipos de ruido.  El algoritmo VAD determina si la parte del archivo de audio que se le env√≠a es un discurso o, por ejemplo, si suena una sirena o alguien estornud√≥.  Est√° claro que para que dicho algoritmo sea de alta calidad, es necesario capacitarse con un maestro.  Y esto a su vez significa que necesita marcar los datos; en otras palabras, crear una base de datos con grabaciones de voz y todo tipo de ruido.  Lo haremos perezosamente: tome un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">VAD ya</a> hecho, que no funciona perfectamente, pero para empezar tenemos suficiente. <br><br>  El segundo bloque corta los datos de voz en segmentos con un altavoz activo.  El enfoque cl√°sico a este respecto es el algoritmo para determinar el cambio del hablante basado en el criterio de informaci√≥n bayesiano - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">BIC</a> .  La esencia de este m√©todo es la siguiente: una ventana deslizante pasa a trav√©s de las grabaciones de audio y en cada punto del pasaje responden la pregunta: "¬øC√≥mo se describen mejor los datos en este lugar? ¬øUna distribuci√≥n o dos?"  Para responder a esta pregunta, se calcula el par√°metro <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>D</mi><mi>e</mi><mi>l</mi><mi>t</mi><mi>a</mi><mi>B</mi><mi>I</mi><mi>C</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="11.053ex" height="2.057ex" viewBox="0 -780.1 4759 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-44" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-65" x="1078" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-6C" x="1545" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-74" x="1843" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-61" x="2205" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-42" x="2734" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-49" x="3494" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-43" x="3998" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>D</mi><mi>e</mi><mi>l</mi><mi>t</mi><mi>a</mi><mi>B</mi><mi>I</mi><mi>C</mi></math></span></span><script type="math/tex" id="MathJax-Element-1"> \ Delta BIC </script>  , seg√∫n el signo de que se toma la decisi√≥n de cambiar el hablante.  El problema es que este m√©todo no funcionar√° muy bien en caso de cambios frecuentes de los altavoces, e incluso en presencia de ruido (que son muy caracter√≠sticos para grabar una conversaci√≥n telef√≥nica). <br><br><div class="spoiler">  <b class="spoiler_title">Una peque√±a explicacion</b> <div class="spoiler_text">  En el original, trabaj√© con grabaciones telef√≥nicas de un centro de llamadas con una duraci√≥n promedio de aproximadamente 4 minutos.  Por razones obvias, no puedo publicar estas notas, as√≠ que para la demostraci√≥n tom√© <a href="">una</a> entrevista de una estaci√≥n de radio.  En el caso de una entrevista larga, este m√©todo probablemente dar√≠a un resultado aceptable, pero no funcion√≥ en mis datos. <br></div></div><br>  En las condiciones en que los locutores no se interrumpen entre s√≠ y sus voces no se superponen, el VAD que utilizaremos m√°s o menos hace frente a la tarea de segmentaci√≥n, por lo tanto, los dos primeros pasos se ver√°n as√≠. <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#  y_, sr = librosa.load('data/2018-08-26-beseda-1616.mp3', sr=SR) #   pre-emphasis:    pre_emphasis = 0.97 y = np.append(y[0], y[1:] - pre_emphasis * y[:-1]) #       webrtcvad    vad = webrtcvad.Vad(2) #  VAD audio = np.int16(y/np.max(np.abs(y)) * 32767) frames = frame_generator(10, audio, sr) frames = list(frames) segments = vad_collector(sr, 50, 200, vad, frames) if not os.path.exists('data/chunks'): os.makedirs('data/chunks') for i, segment in enumerate(segments): chunk_name = 'data/chunks/chunk-%003d.wav' % (i,) # vad      ,     write_wave(chunk_name, segment[0: len(segment)-int(100*sr/1000)], sr)</span></span></code> </pre><br>  En realidad, la gente ciertamente hablar√° simult√°neamente.  Adem√°s, el VAD en algunos lugares se ha equivocado debido al hecho de que el registro no est√° vivo, sino que es un encolado en el que se cortan las pausas.  Puede intentar repetir el corte en segmentos, aumentando la agresividad del VAD de 2 a 3. <br><br><h3>  GMM-UBM </h3><br>  Ahora tenemos segmentos separados, y decidimos que modelar√≠amos cada altavoz usando GMM.  Extraemos los signos del segmento y sobre estos datos entrenamos el modelo.  Hag√°moslo en cada segmento y comparemos los modelos resultantes entre s√≠.  Es justificable esperar que los modelos entrenados en segmentos pertenecientes a la misma persona sean algo similares.  Pero aqu√≠ nos enfrentamos con el siguiente problema, extrayendo signos de un archivo de audio de 1 segundo de largo con una frecuencia de muestreo de 8000 Hz con un tama√±o de ventana de 10 ms, obtenemos un conjunto de 800 vectores MFCC.  Nuestro modelo no podr√° aprender de tales datos, porque es insignificante.  Incluso si no es un segundo, sino diez, los datos a√∫n no ser√°n suficientes.  Y aqu√≠ el Universal Background Model (UBM) viene al rescate, tambi√©n se llama independiente del hablante.  La idea es la siguiente.  Entrenaremos GMM en una muestra de datos de gran tama√±o (en nuestro caso, esta es una grabaci√≥n completa de la entrevista) y obtendremos un modelo ac√∫stico de un orador generalizado (esta ser√° nuestra UBM).  Y luego, utilizando un algoritmo de adaptaci√≥n especial (sobre esto m√°s adelante), "ajustaremos" este modelo a las caracter√≠sticas extra√≠das de cada segmento.  Este enfoque es ampliamente utilizado no solo para la diarizaci√≥n, sino tambi√©n en los sistemas de reconocimiento de voz.  Para reconocer a una persona por voz, primero debe entrenar a un modelo y, sin UBM, deber√≠a tener varias horas de grabaci√≥n del discurso de esta persona. <br><br>  De cada GMM adaptado, extraemos el vector de coeficientes de corte <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>m</mi><mi>u</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.951ex" height="1.455ex" viewBox="0 -520.7 1701 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-6D" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-75" x="1128" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>m</mi><mi>u</mi></math></span></span><script type="math/tex" id="MathJax-Element-2"> \ mu </script>  (tambi√©n es una expectativa de mediana o mat., si lo desea) y, seg√∫n los datos de estos vectores de todos los segmentos, haremos un agrupamiento (a continuaci√≥n, quedar√° claro por qu√© es el vector de desplazamiento). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/8o/v1/gc/8ov1gcun9ic5sqshic7fvlg09wo.png" alt="imagen"></div><br><h3>  Adaptaci√≥n del mapa </h3><br>  El m√©todo mediante el cual personalizaremos UBM para cada segmento se llama Adaptaci√≥n m√°xima A-posteriori.  En general, el algoritmo es el siguiente.  Primero, la probabilidad posterior se calcula sobre los datos de adaptaci√≥n y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">las estad√≠sticas suficientes</a> para el peso, la mediana y la varianza de cada gaussiano.  Luego, las estad√≠sticas obtenidas se combinan con los par√°metros UBM y se obtienen los par√°metros del modelo adaptado.  En nuestro caso, adaptaremos solo las medianas, sin afectar el resto de los par√°metros.  A pesar del hecho de que promet√≠ no profundizar en las matem√°ticas, citar√© tres f√≥rmulas despu√©s de todo, porque la adaptaci√≥n MAP es el punto clave en este art√≠culo. <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>E</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></msub><mo>=</mo><mtext>&amp;#xA0;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>n</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></msub></mrow><mtext>&amp;#xA0;</mtext><mi>s</mi><mi>u</mi><msubsup><mi>m</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><mi>P</mi><mi>r</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><msub><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi></mrow></msub></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="32.446ex" height="3.021ex" viewBox="0 -883.9 13969.9 1300.8" role="img" focusable="false" style="vertical-align: -0.969ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-45" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-69" x="1044" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMAIN-3D" x="1360" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-66" x="2666" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-72" x="3217" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-61" x="3668" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-63" x="4198" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMAIN-31" x="4631" y="0"></use><g transform="translate(5132,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-6E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-69" x="849" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-73" x="6327" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-75" x="6796" y="0"></use><g transform="translate(7369,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-6D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-4E" x="1242" y="488"></use><g transform="translate(878,-308)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-74" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMAIN-3D" x="361" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMAIN-31" x="1140" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-50" x="9507" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-72" x="10259" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMAIN-28" x="10710" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-69" x="11100" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMAIN-7C" x="11445" y="0"></use><g transform="translate(11724,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-74" x="809" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMAIN-29" x="12652" y="0"></use><g transform="translate(13041,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-74" x="809" y="-213"></use></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>E</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub><mo>=</mo><mtext>&nbsp;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow><mrow class="MJX-TeXAtom-ORD"><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub></mrow><mtext>&nbsp;</mtext><mi>s</mi><mi>u</mi><msubsup><mi>m</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><mi>P</mi><mi>r</mi><mo stretchy="false">(</mo><mi>i</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub><mo stretchy="false">)</mo><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-3"> E_ {i} = \ frac {1} {n_ {i}} \ sum_ {t = 1} ^ NPr (i | x_ {t}) x_ {t} </script></p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtext>&amp;#xA0;</mtext><mi>h</mi><mi>a</mi><mi>t</mi><mtext>&amp;#xA0;</mtext><mi>m</mi><msub><mi>u</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></msub><mo>=</mo><mtext>&amp;#xA0;</mtext><mi>b</mi><mi>e</mi><mi>t</mi><msub><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></msub><msub><mi>E</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></msub><mo>+</mo><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo>&amp;#x2212;</mo><mtext>&amp;#xA0;</mtext><mi>b</mi><mi>e</mi><mi>t</mi><msub><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><mtext>&amp;#xA0;</mtext><mi>m</mi><msub><mi>u</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></msub></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="38.817ex" height="2.66ex" viewBox="0 -832 16713 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-68" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-61" x="826" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-74" x="1356" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-6D" x="1967" y="0"></use><g transform="translate(2846,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-75" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-69" x="809" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMAIN-3D" x="4040" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-62" x="5346" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-65" x="5776" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-74" x="6242" y="0"></use><g transform="translate(6604,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-69" x="748" y="-213"></use></g><g transform="translate(7478,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-45" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-69" x="1044" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMAIN-2B" x="8783" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMAIN-28" x="9783" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMAIN-31" x="10173" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMAIN-2212" x="10896" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-62" x="12146" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-65" x="12576" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-74" x="13042" y="0"></use><g transform="translate(13404,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-69" x="748" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMAIN-29" x="14278" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-6D" x="14917" y="0"></use><g transform="translate(15796,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-75" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-69" x="809" y="-213"></use></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtext>&nbsp;</mtext><mi>h</mi><mi>a</mi><mi>t</mi><mtext>&nbsp;</mtext><mi>m</mi><msub><mi>u</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub><mo>=</mo><mtext>&nbsp;</mtext><mi>b</mi><mi>e</mi><mi>t</mi><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub><msub><mi>E</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>‚àí</mo><mtext>&nbsp;</mtext><mi>b</mi><mi>e</mi><mi>t</mi><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub><mo stretchy="false">)</mo><mtext>&nbsp;</mtext><mi>m</mi><msub><mi>u</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-4"> \ hat \ mu_ {i} = \ beta_ {i} E_ {i} + (1- \ beta_ {i}) \ mu_ {i} </script></p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtext>&amp;#xA0;</mtext><mi>b</mi><mi>e</mi><mi>t</mi><msub><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></msub><mo>=</mo><msub><mi>n</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><mo stretchy=&quot;false&quot;>(</mo><msub><mi>n</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></msub><mo>+</mo><msup><mi>r</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>&amp;#xA0;</mtext><mi>b</mi><mi>e</mi><mi>t</mi><mi>a</mi></mrow></msup><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="23.627ex" height="3.021ex" viewBox="0 -987.6 10172.5 1300.8" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-62" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-65" x="679" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-74" x="1146" y="0"></use><g transform="translate(1507,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-69" x="748" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMAIN-3D" x="2659" y="0"></use><g transform="translate(3715,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-6E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-69" x="849" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMAIN-2F" x="4660" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMAIN-28" x="5160" y="0"></use><g transform="translate(5550,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-6E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-69" x="849" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMAIN-2B" x="6717" y="0"></use><g transform="translate(7717,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-72" x="0" y="0"></use><g transform="translate(451,412)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-62" x="353" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-65" x="783" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-74" x="1249" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-61" x="1611" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMAIN-29" x="9783" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtext>&nbsp;</mtext><mi>b</mi><mi>e</mi><mi>t</mi><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub><mo>=</mo><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mo stretchy="false">(</mo><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub><mo>+</mo><msup><mi>r</mi><mrow class="MJX-TeXAtom-ORD"><mtext>&nbsp;</mtext><mi>b</mi><mi>e</mi><mi>t</mi><mi>a</mi></mrow></msup><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-5"> \ beta_ {i} = n_ {i} / (n_ {i} + r ^ {\ beta}) </script></p><br>  Aqui <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>P</mi><mi>r</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.208ex" height="2.66ex" viewBox="0 -832 3534.1 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-50" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-72" x="751" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMAIN-28" x="1203" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-69" x="1592" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMAIN-7C" x="1938" y="0"></use><g transform="translate(2216,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-74" x="809" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMAIN-29" x="3144" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mi>r</mi><mo stretchy="false">(</mo><mi>i</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-6"> Pr (i | x_ {t}) </script>  - probabilidad posterior, <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>E</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.515ex" height="2.419ex" viewBox="0 -780.1 1082.8 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-45" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-69" x="1044" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>E</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-7"> E_ {i} </script>  - estad√≠sticas suficientes para <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>m</mi><mi>u</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.951ex" height="1.455ex" viewBox="0 -520.7 1701 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-6D" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-75" x="1128" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>m</mi><mi>u</mi></math></span></span><script type="math/tex" id="MathJax-Element-8"> \ mu </script>  , <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>h</mi><mi>a</mi><mi>t</mi><mtext>&amp;#xA0;</mtext><mi>m</mi><msub><mi>u</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.739ex" height="2.419ex" viewBox="0 -780.1 3762.8 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-68" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-61" x="826" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-74" x="1356" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-6D" x="1967" y="0"></use><g transform="translate(2846,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-75" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-69" x="809" y="-213"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>h</mi><mi>a</mi><mi>t</mi><mtext>&nbsp;</mtext><mi>m</mi><msub><mi>u</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-9"> \ hat \ mu_ {i} </script>  - mediana del modelo adaptado, <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>b</mi><mi>e</mi><mi>t</mi><msub><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.531ex" height="2.419ex" viewBox="0 -780.1 2381.3 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-62" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-65" x="679" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-74" x="1146" y="0"></use><g transform="translate(1507,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-69" x="748" y="-213"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>b</mi><mi>e</mi><mi>t</mi><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-10"> \ beta_ {i} </script>  - coeficiente de adaptaci√≥n, <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>r</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>&amp;#xA0;</mtext><mi>b</mi><mi>e</mi><mi>t</mi><mi>a</mi></mrow></msup></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.796ex" height="2.419ex" viewBox="0 -935.7 2065.1 1041.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-72" x="0" y="0"></use><g transform="translate(451,362)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-62" x="353" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-65" x="783" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-74" x="1249" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-61" x="1611" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>r</mi><mrow class="MJX-TeXAtom-ORD"><mtext>&nbsp;</mtext><mi>b</mi><mi>e</mi><mi>t</mi><mi>a</mi></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-11"> r ^ {\ beta} </script>  - factor de cumplimiento. <br>  Si todo esto parece absurdo y causa des√°nimo, no se desespere.  De hecho, para comprender el funcionamiento del algoritmo, no es necesario profundizar en estas f√≥rmulas; su funcionamiento se puede demostrar f√°cilmente con el siguiente ejemplo: <br><br><img src="https://habrastorage.org/webt/rj/fg/st/rjfgstiekke6cv1m8zc-d6s4kji.png" alt="imagen"><br><br>  Supongamos que tenemos algunos datos lo suficientemente grandes y capacitamos a UBM en ellos (imagen de la izquierda, UBM es una mezcla de dos componentes de distribuciones gaussianas).  Aparecen nuevos datos que no se ajustan a nuestro modelo (figura en el medio).  Usando este algoritmo, desplazaremos los centros de los gaussianos para que se encuentren en los nuevos datos (figura a la derecha).  Aplicando este algoritmo a los datos experimentales, esperaremos que en segmentos con el mismo altavoz los gaussianos se desplacen en una direcci√≥n, formando as√≠ grupos.  Es por eso que usaremos datos de corte para agrupar segmentos <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>m</mi><mi>u</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.951ex" height="1.455ex" viewBox="0 -520.7 1701 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-6D" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-75" x="1128" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>m</mi><mi>u</mi></math></span></span><script type="math/tex" id="MathJax-Element-12"> \ mu </script>  . <br><br>  Entonces, hagamos la adaptaci√≥n MAP para cada segmento.  (Como referencia: adem√°s de la adaptaci√≥n MAP, el m√©todo MLLR - Regresi√≥n lineal de m√°xima verosimilitud y algunas de sus modificaciones son ampliamente utilizadas. Tambi√©n intentan combinar estos dos m√©todos). <br><br><pre> <code class="python hljs">SV = [] <span class="hljs-comment"><span class="hljs-comment">#    chunk-000  chunk-100 for i in range(101): clear_output(wait=True) fname='data/chunks/chunk-%003d.wav' % (i,) print('UBM MAP adaptation for {0}'.format(fname)) y_, sr_ = librosa.load(fname, sr=None) f_ = extract_features(y_, sr_, window=N_FFT, hop=HOP_LENGTH, n_mfcc=N_MFCC) f_ = preprocessing.scale(f_) gmm = copy.deepcopy(ubm) gmm = map_adaptation(gmm, f_, max_iterations=1, relevance_factor=16) sv = gmm.means_.flatten() #   sv = preprocessing.scale(sv) SV.append(sv) SV = np.array(SV) clear_output() print(SV.shape)</span></span></code> </pre><br>  Ahora que para cada segmento tenemos datos sobre <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-13-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>m</mi><mi>u</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.951ex" height="1.455ex" viewBox="0 -520.7 1701 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-6D" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMATHI-75" x="1128" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>m</mi><mi>u</mi></math></span></span><script type="math/tex" id="MathJax-Element-13"> \ mu </script>  , finalmente pasamos al paso final. <br><br><h3>  Agrupaci√≥n espectral </h3><br>  La agrupaci√≥n espectral se describe brevemente en el art√≠culo, un enlace al que di al principio.  El algoritmo construye un gr√°fico completo, donde los v√©rtices son nuestros datos, y los bordes entre ellos son una medida de similitud.  En las tareas de reconocimiento de voz, se utiliza una m√©trica del coseno como tal medida, ya que tiene en cuenta el √°ngulo entre los vectores, ignorando su magnitud (que no lleva informaci√≥n sobre el hablante).  Al construir el gr√°fico, se calculan los vectores propios de la matriz de Kirchhoff (que es esencialmente una representaci√≥n del gr√°fico resultante) y luego se utiliza alg√∫n m√©todo de agrupamiento est√°ndar, por ejemplo, el m√©todo de k-medias.  Todo cabe en dos l√≠neas de c√≥digo. <br><br><pre> <code class="python hljs">N_CLUSTERS = <span class="hljs-number"><span class="hljs-number">2</span></span> sc = SpectralClustering(n_clusters=N_CLUSTERS, affinity=<span class="hljs-string"><span class="hljs-string">'cosine'</span></span>) labels = sc.fit_predict(SV) <span class="hljs-comment"><span class="hljs-comment">#     , . [2,1,1,0,2] labels = rearrange(labels, N_CLUSTERS) #     [0,1,1,2,0] print(labels) #   , ,  1 -  .     print([i for i, x in enumerate(labels) if x == 1])</span></span></code> </pre><br><h3>  Conclusiones y planes futuros </h3><br>  El algoritmo descrito ha sido probado con varios par√°metros: <br><br><ol><li>  N√∫mero MFCC: 7, 13, 20 </li><li>  MFCC en combinaci√≥n con LPC </li><li>  Tipo y n√∫mero de mezclas en GMM: completo [8, 16, 32], diag [8, 16, 32, 64, 256] </li><li>  M√©todos de adaptaci√≥n UBM: MAP (con covariance_type = 'full') y MLLR (con covariance_type = 'diag') </li></ol><br>  Como resultado, los par√°metros permanecieron subjetivamente √≥ptimos: MFCC 13, GMM covariance_type = 'full' n_components = 16. <br><br>  Desafortunadamente, no tuve la paciencia (comenc√© a escribir este art√≠culo hace m√°s de un mes) para marcar los segmentos recibidos y calcular DER (tasa de error de diarrea).  Subjetivamente, eval√∫o el funcionamiento del algoritmo como "en principio, no est√° mal, pero est√° lejos de ser ideal".  Al agrupar en vectores obtenidos de los primeros cien segmentos (con un pase de MAP), y luego seleccionar aquellos donde el entrevistador dice (ni√±a, ella habla mucho menos que el invitado all√≠), el agrupamiento da una lista <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-14-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>[</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>25</mn><mo>,</mo><mn>26</mn><mo>,</mo><mn>46</mn><mo>,</mo><mn>48</mn><mo>,</mo><mn>49</mn><mo>,</mo><mn>61</mn><mo>,</mo><mn>85</mn><mo>,</mo><mn>86</mn><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="31.523ex" height="2.66ex" viewBox="0 -832 13572.5 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMAIN-5B" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMAIN-31" x="278" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMAIN-2C" x="779" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMAIN-32" x="1224" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMAIN-2C" x="1724" y="0"></use><g transform="translate(2169,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMAIN-32"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMAIN-35" x="500" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMAIN-2C" x="3170" y="0"></use><g transform="translate(3616,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMAIN-32"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMAIN-36" x="500" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMAIN-2C" x="4617" y="0"></use><g transform="translate(5062,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMAIN-34"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMAIN-36" x="500" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMAIN-2C" x="6063" y="0"></use><g transform="translate(6508,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMAIN-34"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMAIN-38" x="500" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMAIN-2C" x="7509" y="0"></use><g transform="translate(7954,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMAIN-34"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMAIN-39" x="500" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMAIN-2C" x="8955" y="0"></use><g transform="translate(9400,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMAIN-36"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMAIN-31" x="500" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMAIN-2C" x="10401" y="0"></use><g transform="translate(10846,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMAIN-38"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMAIN-35" x="500" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMAIN-2C" x="11847" y="0"></use><g transform="translate(12292,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMAIN-38"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMAIN-36" x="500" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhgGDJdvO2YYeipKNBbzFY0hv9CfxQ#MJMAIN-5D" x="13293" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>25</mn><mo>,</mo><mn>26</mn><mo>,</mo><mn>46</mn><mo>,</mo><mn>48</mn><mo>,</mo><mn>49</mn><mo>,</mo><mn>61</mn><mo>,</mo><mn>85</mn><mo>,</mo><mn>86</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-14"> [1, 2, 25, 26, 46, 48, 49, 61, 85, 86] </script>  eso es 100% de √©xito.  Al mismo tiempo, los segmentos donde ambos altavoces est√°n presentes (por ejemplo, 14) se desconectan, pero esto ya puede atribuirse al error VAD.  Adem√°s, dichos segmentos comienzan a tenerse en cuenta con un aumento en el n√∫mero de pases MAP.  Un punto importante  La entrevista con la que trabajamos es m√°s o menos "limpia".  Si se agregan varias inserciones musicales, ruidos y otras cosas no verbales, la agrupaci√≥n comienza a cojear.  Por lo tanto, hay planes para tratar de entrenar nuestro propio VAD (porque webrtcvad, por ejemplo, no separa la m√∫sica del habla). <br><br>  Debido al hecho de que inicialmente trabaj√© con una conversaci√≥n telef√≥nica, no necesitaba estimar la cantidad de hablantes.  Pero el n√∫mero de oradores no siempre est√° predeterminado, incluso si se trata de una entrevista.  Por ejemplo, en <a href="">esta</a> entrevista en el medio hay un anuncio superpuesto en la m√∫sica y expresado por dos personas adicionales.  Por lo tanto, ser√≠a interesante probar el m√©todo para estimar el n√∫mero de hablantes especificado en el primer art√≠culo en la secci√≥n de la lista de referencias (basado en un an√°lisis de los valores propios de la matriz de Laplace normalizada). <br><br><h3>  Referencias </h3><br>  Adem√°s de los materiales ubicados en los enlaces en el texto y las computadoras port√°tiles Jupyter, se utilizaron las siguientes fuentes para preparar este art√≠culo: <br><br><ol><li>  Diarizaci√≥n de altavoces usando GMM Supervector y algoritmos de reducci√≥n avanzada.  Nurit Spingarn </li><li>  M√©todos de extracci√≥n de caracter√≠sticas LPC, PLP y MFCC en reconocimiento de voz.  Namrata dave </li><li>  Evaluaci√≥n de MAP para observaciones de mezcla gaussiana mulivariada de cadenas de markov.  Jean-Luc Gauvain y Chin-Hui Lee </li><li>  Sobre an√°lisis de agrupamiento espectral y un algoritmo.  Andrew Y. Ng, Michael I. Jordan, Yair Weiss </li><li>  Reconocimiento de oradores utilizando el modelo de fondo universal en la base de datos YOHO  Alexandre Majetniak </li></ol><br>  Tambi√©n agregar√© algunos proyectos de diarizaci√≥n: <br><br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Sidekit</a> y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">extensi√≥n de</a> diarizaci√≥n <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">s4d</a> .  Una biblioteca de python para trabajar con el habla.  Lamentablemente, la documentaci√≥n es pobre. </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Bob</a> y sus diversas partes, como <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">bob.bio</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">bob.learn.em</a> , una biblioteca de python para procesar se√±ales y trabajar con datos biom√©tricos.  Windows no es compatible. </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">LIUM</a> es una soluci√≥n llave en mano escrita en Java. </li></ol><br>  Todo el c√≥digo se publica en el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">github</a> .  Por conveniencia, hice varias computadoras port√°tiles Jupyter con una demostraci√≥n de ciertas cosas: MFCC, GMM, MAP Adaptation and Diarization.  Este √∫ltimo es el proceso principal.  Tambi√©n en el repositorio hay archivos de pepinillos con algunos modelos previamente entrenados y la entrevista en s√≠. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es420515/">https://habr.com/ru/post/es420515/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es420505/index.html">OpenAI Five ganar√° el equipo profesional en The International</a></li>
<li><a href="../es420507/index.html">Antecedentes: Internet global para todos y sus creadores.</a></li>
<li><a href="../es420509/index.html">Un problema obvio con el uso de afirmar</a></li>
<li><a href="../es420511/index.html">Trabajar como especialista en TI en el Lejano Oriente - Regi√≥n de Amur</a></li>
<li><a href="../es420513/index.html">Una copia pirateada de un servicio pago en 39 l√≠neas de c√≥digo Python</a></li>
<li><a href="../es420517/index.html">Implementaci√≥n FPGA Integer FFT</a></li>
<li><a href="../es420519/index.html">Popularizaci√≥n de la ciencia.</a></li>
<li><a href="../es420521/index.html">Ahora oficialmente: TLS 1.3 reconocido como est√°ndar</a></li>
<li><a href="../es420523/index.html">An√°lisis de gr√°ficos de opciones binarias o c√≥mo una vez m√°s me demostr√© a m√≠ mismo que los obsequios no existen</a></li>
<li><a href="../es420525/index.html">Redes para los m√°s experimentados. Parte quince. QoS</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>