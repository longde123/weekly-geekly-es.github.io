<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👍🏼 🧑🏽‍🤝‍🧑🏼 🏇🏻 关于在Ubuntu上构建JDK 8，热点代码的质量以及为什么所有这些在C ++中都会失败 👩🏽‍⚖️ 🌽 👃🏽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="我今天想睡觉，但又失败了。 电报中出现一条消息，提示某人不会使用Java ...，只有几个小时，又累又快乐，我们才醒来。 


 谁可以使用此帖子？ 是的，除了那些也收集JDK8或只喜欢阅读噩梦恐怖片的人之外，大概是任何人。 总的来说，我警告过您，请紧急关闭这篇文章。 


 三个问题： 


- ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>关于在Ubuntu上构建JDK 8，热点代码的质量以及为什么所有这些在C ++中都会失败</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/jugru/blog/422861/"><p> 我今天想睡觉，但又失败了。 电报中出现一条消息，提示某人不会使用Java ...，只有几个小时，又累又快乐，我们才醒来。 </p><br><img src="https://habrastorage.org/webt/ti/ov/lf/tiovlf2wctfucdlsql2-avqmkwe.png"><br><br> 谁可以使用此帖子？ 是的，除了那些也收集JDK8或只喜欢阅读噩梦恐怖片的人之外，大概是任何人。 总的来说，我警告过您，请紧急关闭这篇文章。 <br><p> 三个问题： </p><br><ul><li> 不参加（第一<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">级</a> ） <br> 要跳过的部分非常无聊。 仅对于那些想要完全恢复事件历史的人而言； </li><li> 不参加（第二<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">级</a> ） <br> 它更有趣，因为存在一些典型的错误，如死灵症，死灵症，哪个BSD优于GNU / Linux，以及为什么要升级到新版本的JDK。 </li><li> 即使发生，它也会<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">掉入地壳</a> <br> 更有趣。  Yahuuu，JVM掉进了地壳，让我们踢吧！ </li></ul><br><p> 在猫的下方显示了对问题的详细解决方案，对生活有不同的想法。 </p><br><p> 将会有很多C ++，根本不会有Java代码。 最后，任何最笨拙的事情都只开始用C ++编写。 </p><a name="habracut"></a><br><h1 id="ne-sobiraetsya"> 不去 </h1><br><p> 至少一次构建Java的人都知道它看起来像这样： </p><br><pre><code class="bash hljs">hg <span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> http://hg.openjdk.java.net/jdk8u/jdk8u <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> jdk8u sh ./get_source.sh sh ./configure \ --with-debug-level=fastdebug \ --with-target-bits=64 \ --with-native-debug-symbols=internal \ --with-boot-jdk=/home/me/opt/jdk1.8.0_161 make images</code> </pre> <br><p>  （我的所有用户都简称为“我”，因此您可以随时将虚拟机提供给任何人，而不会因为使用您自己的用户名而遭到拒绝） </p><br><p> 当然，问题在于这不起作用。 并以一种愤世嫉俗的方式。 </p><br><a name="one"></a><br><h2 id="pervyy-uroven-pogruzheniya"> 第一次潜水 </h2><br><p> 让我们尝试运行： </p><br><pre> <code class="bash hljs">/home/me/git/jdk8u/hotspot/src/os/linux/vm/os_linux.inline.hpp:127:18: warning: <span class="hljs-string"><span class="hljs-string">'int readdir_r(DIR*, dirent*, dirent**)'</span></span> is deprecated [-Wdeprecated-declarations] <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>((status = ::readdir_r(dirp, dbuf, &amp;p)) != 0) { ^~~~~~~~~</code> </pre> <br><p> 首先，为了您理解，我已经安装了此软件： </p><br><pre> <code class="hljs powershell"><span class="hljs-variable"><span class="hljs-variable">$</span></span> g++ -<span class="hljs-literal"><span class="hljs-literal">-version</span></span> g++ (Ubuntu <span class="hljs-number"><span class="hljs-number">7.3</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span><span class="hljs-literal"><span class="hljs-literal">-16ubuntu3</span></span>) <span class="hljs-number"><span class="hljs-number">7.3</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span> Copyright (C) <span class="hljs-number"><span class="hljs-number">2017</span></span> Free Software Foundation, Inc.</code> </pre> <br><p> 编译器不是第一个版本，不是8.2，但是这个也应该可以工作。 </p><br><p>  C ++开发人员喜欢仅在已安装的编译器版本上测试软件。 通常，在一般意义上，在不同平台上进行测试的愿望会终止于gcc和clang之间差异的区域中的某个位置。 因此，先运行<code>-Werror</code> （“将警告视为错误”），然后编写代码，将其在所有其他版本中视为恶意代码，这是很正常的。 </p><br><p> 这是一个已知的问题，很清楚如何解决。 您需要设置环境变量CXX_FLAGS，在其中设置正确的错误级别。 </p><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">export</span></span> CXX_FLAGS=-Wno-error=deprecated-declarations -Wno-error-deprecated-declarations</code> </pre> <br><p> 然后，我们看到了奇妙的效果： </p><br><pre> <code class="hljs powershell">Ignoring CXXFLAGS found <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> environment. Use -<span class="hljs-literal"><span class="hljs-literal">-with</span></span><span class="hljs-literal"><span class="hljs-literal">-extra</span></span><span class="hljs-literal"><span class="hljs-literal">-cxxflags</span></span></code> </pre> <br><p> 好的，构建系统，随您便！ 我们用以下命令替换configure： </p><br><pre> <code class="bash hljs">hg <span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> http://hg.openjdk.java.net/jdk8u/jdk8u <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> jdk8u sh ./configure \ --with-extra-cflags=<span class="hljs-string"><span class="hljs-string">'-Wno-cpp -Wno-error=deprecated-declarations'</span></span> \ --with-extra-cxxflags=<span class="hljs-string"><span class="hljs-string">'-Wno-cpp -Wno-error=deprecated-declarations'</span></span> \ --with-debug-level=fastdebug \ --with-target-bits=64 \ --with-native-debug-symbols=internal \ --with-boot-jdk=/home/me/opt/jdk1.8.0_161 make images</code> </pre> <br><p> 和错误保持不变！ <br> 我们传递给重型火炮：源代码。 </p><br><pre> <code class="hljs perl"><span class="hljs-keyword"><span class="hljs-keyword">grep</span></span> -rl <span class="hljs-string"><span class="hljs-string">"Werror"</span></span> .</code> </pre> <br><p> 大量自动生成的帽子都会掉落，其中包括一些有意义的文件： </p><br><pre> <code class="hljs go">./common/autoconf/flags.m4 ./hotspot/<span class="hljs-built_in"><span class="hljs-built_in">make</span></span>/bsd/makefiles/gcc.<span class="hljs-built_in"><span class="hljs-built_in">make</span></span> ./hotspot/<span class="hljs-built_in"><span class="hljs-built_in">make</span></span>/solaris/makefiles/gcc.<span class="hljs-built_in"><span class="hljs-built_in">make</span></span> ./hotspot/<span class="hljs-built_in"><span class="hljs-built_in">make</span></span>/aix/makefiles/xlc.<span class="hljs-built_in"><span class="hljs-built_in">make</span></span></code> </pre> <br><p> 在<code>flags.m4</code>我们可以轻松找到上一条有关“忽略CXXFLAGS”的消息和更成熟的硬编码标志<code>CCXX_FLGS</code> （是的，两个字母C），该标志立即代替<code>CFLAGS</code>和<code>XX_FLAGS</code> 。 方便！ 有两个事实很有趣： </p><br><ul><li> 此标志不通过configure参数传递； </li><li> 在默认值中，这些参数有意义且可疑地类似于以下参数： </li></ul><br><pre> <code class="bash hljs"> <span class="hljs-comment"><span class="hljs-comment"># Setup compiler/platform specific flags to CFLAGS_JDK, # CXXFLAGS_JDK and CCXXFLAGS_JDK (common to C and CXX?) if test "x$TOOLCHAIN_TYPE" = xgcc; then # these options are used for both C and C++ compiles CCXXFLAGS_JDK="$CCXXFLAGS $CCXXFLAGS_JDK -Wall -Wno-parentheses -Wextra -Wno-unused -Wno-unused-parameter -Wformat=2 \ -pipe -D_GNU_SOURCE -D_REENTRANT -D_LARGEFILE64_SOURCE"</span></span></code> </pre> <br><p> 这个问题在注释中看起来非常好-但是，标记是常见的吗？ 对不对 </p><br><p> 我们将不使用民主制度，而在<code>-w</code>那里对其进行威权主义的硬编码（“不显示任何错误”）： </p><br><pre> <code class="bash hljs"> CCXXFLAGS_JDK=<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$CCXXFLAGS</span></span></span><span class="hljs-string"> </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$CCXXFLAGS_JDK</span></span></span><span class="hljs-string"> -w -ffreestanding -fno-builtin -Wno-parentheses -Wno-unused -Wno-unused-parameter -Wformat=2 \</span></span></code> </pre> <br><p> 还有-干杯！  -我们遇到的第一个错误。 她不再举报了，一般来说一切都很好。 好像。 </p><br><a name="two"></a><br><h2 id="vtoroy-uroven-pogruzheniya"> 第二次潜水 </h2><br><p> 但是现在它落入了其他许多新地方！ </p><br><p> 事实证明，我们的<code>-w</code>可以工作，但不能转发到程序集的所有部分。 我们仔细阅读了makefile，完全不知道该参数的转发方式。 真的忘了他吗？ </p><br><p> 知道了正确的Google问题（“为什么cxx无法进入构建版本？！”），我们很快进入错误页面，并说<strong>“ configure --with-extra-cxxflags不会影响热点”</strong> （ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">JDK-8156967</a> ）。 </p><br><p> 哪个承诺将在JDK 12中修复。 太棒了-程序集中没有使用最重要的build参数！ </p><br><p> 第一个想法是，让我们卷起袖子，纠正错误！ </p><br><h2 id="oshibka-1-xn12"> 错误1.xn [12] </h2><br><pre> <code class="hljs powershell">dependencies.cpp: <span class="hljs-keyword"><span class="hljs-keyword">In</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> '</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">static</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Dependencies</span></span></span><span class="hljs-function">::</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">write_dependency_to</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(xmlStream*, Dependencies::DepType, GrowableArray&lt;Dependencies::DepArgument&gt;*, Klass*)</span></span></span><span class="hljs-function">': </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dependencies</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cpp</span></span></span><span class="hljs-function">:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">498</span></span></span><span class="hljs-function">:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">6</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">error</span></span></span><span class="hljs-function">: '%</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">d</span></span></span><span class="hljs-function">' </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">directive</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">writing</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">between</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">1</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">and</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">10</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bytes</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">into</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">a</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">region</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">of</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">size</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">9</span></span></span><span class="hljs-function"> [-</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Werror</span></span></span><span class="hljs-function">=</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">format-overflow</span></span></span><span class="hljs-function">=] </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Dependencies</span></span></span><span class="hljs-function">::</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">write_dependency_to</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(xmlStream* xtty, ^~~~~~~~~~~~ dependencies.cpp:498:6: note: directive argument in the range [0, 2147483647]</span></span></span></span></code> </pre> <br><p> 好吧，我们可能需要扩大区域。 一百磅，有人通过单击“我很幸运！”来计算缓冲区。 在谷歌。 </p><br><p> 但是您如何理解您的需求呢？ 以下是另一种改进： </p><br><pre> <code class="hljs pgsql">stdio2.h:<span class="hljs-number"><span class="hljs-number">34</span></span>:<span class="hljs-number"><span class="hljs-number">43</span></span>: note: <span class="hljs-string"><span class="hljs-string">'__builtin___sprintf_chk'</span></span> output <span class="hljs-keyword"><span class="hljs-keyword">between</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-number"><span class="hljs-number">12</span></span> bytes <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> a destination <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> size <span class="hljs-number"><span class="hljs-number">10</span></span> __bos (__s), __fmt, __va_arg_pack ());</code> </pre> <br><p> 位置12看起来很有价值，现在您可以用脏脚闯入信号源。 </p><br><p> 我们进入<code>dependencies.cpp</code> ，观察下图： </p><br><pre> <code class="cpp hljs">DepArgument arg = args-&gt;at(j); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (j == <span class="hljs-number"><span class="hljs-number">1</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (arg.is_oop()) { xtty-&gt;object(<span class="hljs-string"><span class="hljs-string">"x"</span></span>, arg.oop_value()); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { xtty-&gt;object(<span class="hljs-string"><span class="hljs-string">"x"</span></span>, arg.metadata_value()); } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> xn[<span class="hljs-number"><span class="hljs-number">10</span></span>]; <span class="hljs-built_in"><span class="hljs-built_in">sprintf</span></span>(xn, <span class="hljs-string"><span class="hljs-string">"x%d"</span></span>, j); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (arg.is_oop()) { xtty-&gt;object(xn, arg.oop_value()); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { xtty-&gt;object(xn, arg.metadata_value()); } }</code> </pre> <br><p> 注意有问题的行： </p><br><pre> <code class="hljs perl">char xn[<span class="hljs-number"><span class="hljs-number">10</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">sprintf</span></span>(xn, <span class="hljs-string"><span class="hljs-string">"x%d"</span></span>, j);</code> </pre> <br><p> 我们将10更改为12，重新组装，而...组装已经消失了！ </p><br><p> 但是我是唯一一个如此聪明并且修复了所有时间错误的人吗？ 毫无疑问，我们再次将巨型补丁带入Google： <code>char xn[12];</code> </p><br><p> 我们看到...是的，没错。 弗拉基米尔·伊万诺夫（Vladimir Ivanov）禁止的错误<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">JDK-8184309</a>包含完全相同的修复程序。 </p><br><p> 但最重要的是，它仅在JDK 10中已修复，而nifiga并未反向移植到jdk8u。 这就是为什么需要新版本的Java的问题。 </p><br><h2 id="oshibka-2-strcmp"> 错误2. strcmp </h2><br><pre> <code class="hljs powershell">fprofiler.cpp: <span class="hljs-keyword"><span class="hljs-keyword">In</span></span> member <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> '</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ThreadProfiler</span></span></span><span class="hljs-function">::</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">vm_update</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(TickPosition)</span></span></span><span class="hljs-function">': /</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">home</span></span></span><span class="hljs-function">/</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">me</span></span></span><span class="hljs-function">/</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">git</span></span></span><span class="hljs-function">/</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">jdk8ut</span></span></span><span class="hljs-function">/</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">hotspot</span></span></span><span class="hljs-function">/</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">src</span></span></span><span class="hljs-function">/</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">share</span></span></span><span class="hljs-function">/</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">vm</span></span></span><span class="hljs-function">/</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">runtime</span></span></span><span class="hljs-function">/</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fprofiler</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cpp</span></span></span><span class="hljs-function">:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">638</span></span></span><span class="hljs-function">:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">56</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">error</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">argument</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">1</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">null</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">where</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">non-null</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">expected</span></span></span><span class="hljs-function"> [-</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Werror</span></span></span><span class="hljs-function">=</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nonnull</span></span></span><span class="hljs-function">] </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">vm_match</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(const char* name)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">const</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> strcmp(name, _name) == <span class="hljs-number"><span class="hljs-number">0</span></span>; }</code> </pre> <br><p> 通过先前的痛苦经验，我们立即去看看JDK 11中的这个位置。而且...此文件不存在。 目录结构也进行了一些重构。 </p><br><p> 但是，您不能摆脱我们！ </p><br><p> 任何勇敢者在他的灵魂中都是个死灵法师，甚至是个死灵法师。 因此，现在将有紧急行动！ </p><br><p> 首先，您需要吸引死者的灵魂，并找出死者的死亡时间： </p><br><pre> <code class="hljs powershell"><span class="hljs-variable"><span class="hljs-variable">$</span></span> hg log -<span class="hljs-literal"><span class="hljs-literal">-template</span></span> <span class="hljs-string"><span class="hljs-string">"File(s) deleted in rev {rev}: {file_dels % '\n {file}'}\n\n"</span></span> <span class="hljs-literal"><span class="hljs-literal">-r</span></span> <span class="hljs-string"><span class="hljs-string">'removes("**/fprofiler.cpp")'</span></span> File(s) deleted <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> rev <span class="hljs-number"><span class="hljs-number">47106</span></span>: hotspot/src/share/vm/runtime/fprofiler.cpp hotspot/src/share/vm/runtime/fprofiler.hpp hotspot/test/runtime/MinimalVM/Xprof.java</code> </pre> <br><p> 现在，您需要找出他的死因： </p><br><pre> <code class="hljs pgsql">hg <span class="hljs-keyword"><span class="hljs-keyword">log</span></span> -r <span class="hljs-number"><span class="hljs-number">47106</span></span> changeset: <span class="hljs-number"><span class="hljs-number">47106</span></span>:bed18a111b90 parent: <span class="hljs-number"><span class="hljs-number">47104</span></span>:<span class="hljs-number"><span class="hljs-number">6</span></span>bdc0c9c44af <span class="hljs-keyword"><span class="hljs-keyword">user</span></span>: gziemski <span class="hljs-type"><span class="hljs-type">date</span></span>: Thu Aug <span class="hljs-number"><span class="hljs-number">31</span></span> <span class="hljs-number"><span class="hljs-number">20</span></span>:<span class="hljs-number"><span class="hljs-number">26</span></span>:<span class="hljs-number"><span class="hljs-number">53</span></span> <span class="hljs-number"><span class="hljs-number">2017</span></span> <span class="hljs-number"><span class="hljs-number">-0500</span></span> <span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>: <span class="hljs-number"><span class="hljs-number">8173715</span></span>: Remove FlatProfiler</code> </pre><br><p> 因此，我们有一个杀手:： <strong>gziemski</strong> 。 让我们找出为什么他钉了这个不幸的文件。 </p><br><p> 为此，请在提交摘要中指定的故障单中找到胖子。 这是<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">JDK-8173715</a> ： </p><br><p> 删除FlatProfiler： <br> 我们假定该技术已不再使用，并且是GC根扫描的来源。 </p><br><p> 对于shih bis。 实际上，现在我们被邀请修理尸体，以使建造顺利进行。 它已经分解得如此之多，以至于我们甚至来自OpenJDK的死灵法师同事都放弃了它。 </p><br><p> 让我们复活死者，并尝试问他最后记得的事情。 他已经在版本47106中死了，这意味着版本中少了一个-这是“第二个”： </p><br><pre> <code class="bash hljs">hg cat <span class="hljs-string"><span class="hljs-string">"~/git/jdk11/hotspot/src/share/vm/runtime/fprofiler.cpp"</span></span> -r 47105 &gt; ~/tmp/fprofiler_new.cpp cp ~/git/jdk8u/hotspot/src/share/vm/runtime/fprofiler.cpp ~/tmp/fprofiler_old.cpp <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ~/tmp diff fprofiler_old.cpp fprofiler_new.cpp</code> </pre> <br><p> 不幸的是，与<code>return strcmp(name, _name) == 0;</code>无关<code>return strcmp(name, _name) == 0;</code> 在差异号 病人因用钝的锋利物体（rm功用）击打而死亡，但在死亡时他已经身患绝症。 </p><br><p> 让我们深入研究错误的本质。 </p><br><p> 这是代码作者想要告诉我们的： </p><br><pre> <code class="cpp hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">char</span></span></span><span class="hljs-function"> *</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">name</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _name; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">is_compiled</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">vm_match</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params">* name)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">strcmp</span></span>(name, _name) == <span class="hljs-number"><span class="hljs-number">0</span></span>; }</code> </pre> <br><p> 现在有点哲学。 </p><br><p> 第7.1.4节“库函数的使用”中的C11标准明确指出： </p><br><blockquote> 除非在后面的详细说明中另有明确说明，否则以下每个语句均适用：如果函数的参数具有无效值（例如[...]空指针[...]），行为是不确定的。 </blockquote><p> 也就是说，现在的整个问题是是否存在<em>“另有明确说明”</em> 。 在7.24.4节中对<code>strcmp</code>的描述中没有任何内容，我没有其他要介绍的部分。 </p><br><p> 也就是说，我们在这里有未定义的行为。 </p><br><p> 当然，您可以获取并重写这段代码，并在其周围进行验证。 但是我完全不确定我是否正确理解了应该使用UB的人们的逻辑。 例如，某些系统生成SIGSERV进行零解引用，黑客爱好者可以利用它，但是这种行为不是强制性的，可能会在另一个平台上启动。 </p><br><p> 是的，当然，有人会说您是一个傻瓜，您使用的是GCC 7.3，但是在GCC 4中，一切都会聚集在一起。 但是未定义的行为！=未指定！=实现已定义。 可以将这最后两个放在旧的编译器中。 第六版的UB是UB。 </p><br><p> 简而言之，当我突然意识到它可能与众不同时，我为这个复杂的哲学问题（我应该以自己的假设进入代码）感到完全难过。 </p><br><h1 id="est-drugoy-put"> 还有另一种方法 </h1><br><p> 如您所知，好英雄总是四处走动。 </p><br><p> 即使我们忽略关于UB的哲学，那里也存在着令人难以置信的大量问题。 他们不是可以修理直到早上的事实。 不是我无法用弯曲的双手做这件事。 更不用说它会在上游被接受的事实：jdk8u中的最后一个补丁是在6周前，这是新标签的全球合并。 </p><br><p> 试想一下上面的代码实际上是正确编写的。 我们与执行之间存在的只是警告，由于构建系统中的错误，该警告被视为错误。 但是我们可以构建一个构建系统。 </p><br><p> 里维亚的巫师杰拉特曾经说过： </p><br><blockquote>  “邪恶是邪恶的，斯崔戈博尔，”女巫严肃地说，站起来。  -较小，较大，平均-一切都一样，比例是任意的，边界也模糊了。 我不是一个神圣的隐士，不仅在我的生活中做了一件好事。 但是，如果您必须在一种邪恶与另一种邪恶之间做出选择，我宁愿根本不选择。 <br><br>  -Zło到Zło，Stregoborze-rzekłpoważniewiedźminwstając。  -Mniejsze，większe，średnie，wszystko jedno，proporcjesąumrane格兰尼萨特zatarte。  Nie jestemświątobliwympustelnikiem，nie samo dobroczyniłemwżciu。  Alejeżelimamwybieraćpomiędzyjednymzłem吸毒，向wolęniewybieraćwcale致意。 </blockquote><p> 这摘自《最后的愿望》，一个名为《小恶魔》的故事。 众所周知，杰拉特（Geralt）几乎永远无法扮演真正中立的角色，甚至因另一种典型的混沌行为而死亡。 </p><br><p> 因此，让我们快速展示一下较小的邪恶。 让我们开始构建系统。 </p><br><p> 在开始的时候，我们已经看到了这种疲惫： </p><br><pre> <code class="hljs go">grep -rl <span class="hljs-string"><span class="hljs-string">"Werror"</span></span> . ./common/autoconf/flags.m4 ./hotspot/<span class="hljs-built_in"><span class="hljs-built_in">make</span></span>/linux/makefiles/gcc.<span class="hljs-built_in"><span class="hljs-built_in">make</span></span> ./hotspot/<span class="hljs-built_in"><span class="hljs-built_in">make</span></span>/bsd/makefiles/gcc.<span class="hljs-built_in"><span class="hljs-built_in">make</span></span> ./hotspot/<span class="hljs-built_in"><span class="hljs-built_in">make</span></span>/solaris/makefiles/gcc.<span class="hljs-built_in"><span class="hljs-built_in">make</span></span> ./hotspot/<span class="hljs-built_in"><span class="hljs-built_in">make</span></span>/aix/makefiles/xlc.<span class="hljs-built_in"><span class="hljs-built_in">make</span></span></code> </pre> <br><p> 比较这两个文件，我用facespalm弄乱了脸，意识到了两个平台的文化差异： </p><br><p>  BSD是关于自由和选择的故事： </p><br><pre> <code class="hljs lisp"># Compiler warnings are treated as errors ifneq ($(<span class="hljs-name"><span class="hljs-name">COMPILER_WARNINGS_FATAL</span></span>),false) WARNINGS_ARE_ERRORS = -Werror endif</code> </pre> <br><p>  GNU / Linux是一种专制的纯粹主义政权： </p><br><pre> <code class="hljs sql"><span class="hljs-comment"><span class="hljs-comment"># Compiler warnings are treated as errors WARNINGS_ARE_ERRORS = -Werror</span></span></code> </pre> <br><p> 好吧，它将通过<code>XX_FLAGS</code>转发到linux，在计算<code>WARNINGS_ARE_ERRORS</code>时不会考虑该变量！ 在GNU / Linux构建中，我们别无选择，只能遵循从上面启动的默认设置。 </p><br><p> 好吧，或者您可以简化它，并将<code>WARNINGS_ARE_ERRORS</code>的值更改为简短但功能<code>-w</code> 。 埃隆·马斯克（Elon Musk），您觉得怎么样？ </p><br><p> 您可能已经猜到了，这完全解决了该构建问题。 </p><br><p> 汇编代码后，您会看到一堆奇怪的，看上去非常可怕的问题。 有时它发生得太可怕了，以至于我真的想按ctrl + C并尝试找出答案。 但是不，你不能，你不能... </p><br><p> 似乎一切都聚集了，没有带来任何其他问题。 尽管我当然不敢开始测试。 仍然，到了晚上，我的眼睛开始粘在一起，以某种方式我不想去不得已-从冰箱里取出四罐能量。 </p><br><a name="three"></a><br><h1 id="padaet-v-korku"> 掉入地壳 </h1><br><p> 程序集已经通过，可执行文件已经生成，我们很棒。 </p><br><p> 因此，我们来到了终点线。 还是没来？ </p><br><p> 我们的组装方式如下： </p><br><pre> <code class="hljs powershell">export JAVA_HOME=~/git/jdk8u/build/linux<span class="hljs-literal"><span class="hljs-literal">-x86_64</span></span><span class="hljs-literal"><span class="hljs-literal">-normal</span></span><span class="hljs-literal"><span class="hljs-literal">-server</span></span><span class="hljs-literal"><span class="hljs-literal">-fastdebug</span></span>/jdk export PATH=<span class="hljs-variable"><span class="hljs-variable">$JAVA_HOME</span></span>/bin:<span class="hljs-variable"><span class="hljs-variable">$PATH</span></span></code> </pre> <br><p> 当您尝试运行<code>java</code>可执行文件时，它立即崩溃。 对于那些不熟悉的人-看起来像这样： </p><br><p><img src="https://habrastorage.org/webt/n2/3p/ep/n23pepls-unfomopiqb1zgkx5eq.png"><br></p><br><p> 同时，Alex有Debian 9.5，而我有Ubuntu。  GCC的两个不同版本，两个不同外观的外壳。 我对strcmp手动补丁和其他几个地方很无知，但Alex没有。 怎么了 </p><br><p> 这个故事值得一个单独的故事，但在这里让我们直接得出结论，否则我将永远不会添加这篇文章。 </p><br><p> 问题是我们最喜欢的C ++种族主义者再次使用了未定义的行为。 </p><br><p>  （此外，它以某种未知的方式取决于编译器的实现。但是，我们必须记住，UB始终是UB，即使在已知版本的编译器中，也无法将其放在上面） </p><br><p> 在一个地方，我们转到那里设计不足的课程领域，一切都中断了。 不要问它是怎么发生的，一切都很复杂。 </p><br><p> 一个javista很难想象一个人如何可以转向一个构造欠佳的类，除非通过直接从构造函数中发出指向它的链接。 幸运的是，出色的C ++语言可以完成所有或几乎所有事情。 我将用一个特定的伪代码编写一个示例： </p><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">A</span></span></span><span class="hljs-class"> {</span></span> A() { _b.Show(); } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> B _b; }; A a; BA::_b; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ }</code> </pre> <br><p> 有一个不错的调试！ </p><br><p> 如果您查看C ++ 98 [class.cdtor]： </p><br><blockquote> 对于非POD类类型的对象...在构造函数开始执行之前...引用该对象的任何非静态成员或基类都会导致未定义的行为 </blockquote><p> 从某个版本的GCC（我有7.3）开始，出现了“终生消除死存储”的优化，它认为我们仅在对象的生命周期内引用它，并且所有事物在生命周期之外都会咳嗽。 </p><br><p> 解决方案是禁用新的优化并返回旧的GCC： </p><br><pre> <code class="hljs powershell">CFLAGS += <span class="hljs-literal"><span class="hljs-literal">-fno</span></span><span class="hljs-literal"><span class="hljs-literal">-strict</span></span><span class="hljs-literal"><span class="hljs-literal">-aliasing</span></span> <span class="hljs-literal"><span class="hljs-literal">-fno</span></span><span class="hljs-literal"><span class="hljs-literal">-lifetime</span></span><span class="hljs-literal"><span class="hljs-literal">-dse</span></span> <span class="hljs-literal"><span class="hljs-literal">-fno</span></span><span class="hljs-literal"><span class="hljs-literal">-delete</span></span><span class="hljs-literal"><span class="hljs-literal">-null</span></span><span class="hljs-literal"><span class="hljs-literal">-pointer</span></span><span class="hljs-literal"><span class="hljs-literal">-checks</span></span></code> </pre> <br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">这里有</a>一个讨论。 <br> 由于某些原因，讨论参与者决定不将其包含在上游。 但是您仍然必须尝试发送它。 </p><br><p> 将这些选项添加到我们的<code>./hotspot/make/linux/makefiles/gcc.make</code> ，再次重新组装所有内容，然后查看下面的代码行： </p><br><pre> <code class="hljs powershell">t<span class="hljs-variable"><span class="hljs-variable">$</span></span> ~/git/jdk8u/build/linux<span class="hljs-literal"><span class="hljs-literal">-x86_64</span></span><span class="hljs-literal"><span class="hljs-literal">-normal</span></span><span class="hljs-literal"><span class="hljs-literal">-server</span></span><span class="hljs-literal"><span class="hljs-literal">-fastdebug</span></span>/jdk/bin/java <span class="hljs-literal"><span class="hljs-literal">-version</span></span> openjdk version <span class="hljs-string"><span class="hljs-string">"1.8.0-internal-fastdebug"</span></span> OpenJDK Runtime Environment (build <span class="hljs-number"><span class="hljs-number">1.8</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span><span class="hljs-literal"><span class="hljs-literal">-internal</span></span><span class="hljs-literal"><span class="hljs-literal">-fastdebug</span></span><span class="hljs-literal"><span class="hljs-literal">-me_2018_09_10_08_14</span></span><span class="hljs-literal"><span class="hljs-literal">-b00</span></span>) OpenJDK <span class="hljs-number"><span class="hljs-number">64</span></span><span class="hljs-literal"><span class="hljs-literal">-Bit</span></span> Server VM (build <span class="hljs-number"><span class="hljs-number">25.71</span></span><span class="hljs-literal"><span class="hljs-literal">-b00</span></span><span class="hljs-literal"><span class="hljs-literal">-fastdebug</span></span>, mixed mode)</code> </pre> <br><h1 id="zaklyuchenie"> 结论 </h1><br><p> 您可能以为结论是：“ Java真是个地狱，代码中有垃圾，没有支持，一切都不好。” </p><br><p> 事实并非如此！ 相反，以上示例表明，我们的朋友（来自OpenJDK的巫师）使我们远离了什么可怕的邪恶。 </p><br><p> 尽管事实上他们必须生活和使用C ++，与每个UB颤抖并更改编译器版本并了解平台的精妙之处，但Java的最终用户代码还是非常稳定的，并且在诸如Azul这样的公司的官方网站上发布，在一个简单的案例中，红帽和甲骨文几乎不会陷入困境。 </p><br><p> 唯一可悲的是，很可能发现的错误不太可能在jdk8u中接受。 我们之所以选择JDK 8，仅仅是因为它使我们现在更容易修补它，而我们将不得不处理JDK 11。 尽管如此，恕我直言，要在2018年使用JDK 8是一个非常糟糕的做法，我们并非一帆风顺。 也许将来我们的生活会有所改善，并且您将从JDK 11和JDK 12的世界中读到更多令人难以置信的故事。 </p><br><p> 感谢您对无图文字的关注：-) </p><br><blockquote> 分钟的广告。  Joker 2018大会将很快举行，届时将有许多Java和JVM的知名专家。  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">在官方网站上</a>查看发言人和报告的完整列表。 我也将在那里，有可能与OpenJDK相遇并为之奋斗。 </blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN422861/">https://habr.com/ru/post/zh-CN422861/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN422843/index.html">虚假芯片世界简介：伪造检测技术</a></li>
<li><a href="../zh-CN422845/index.html">如何使电视真正智能？</a></li>
<li><a href="../zh-CN422851/index.html">为什么数据存储的未来仍然是磁带</a></li>
<li><a href="../zh-CN422857/index.html">实施您的IoC容器</a></li>
<li><a href="../zh-CN422859/index.html">交通部建议从FSB转换为具有加密功能的SIM卡</a></li>
<li><a href="../zh-CN422863/index.html">部落，行会，建造火车而没有TDD：Uber，Spotify，Odnoklassniki和Avito中的移动开发工作原理</a></li>
<li><a href="../zh-CN422865/index.html">Java Enterprise开放课程“ CDI的实际应用”</a></li>
<li><a href="../zh-CN422867/index.html">在没有机器学习的情况下根据他的照片确定房屋的层数</a></li>
<li><a href="../zh-CN422869/index.html">我们依靠已学到的知识来掌握新的编程语言</a></li>
<li><a href="../zh-CN422871/index.html">识别VK中有意义的配置文件</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>