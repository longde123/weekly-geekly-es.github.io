<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üî∑ üèê ü§öüèΩ Comment faire √©voluer les centres de donn√©es. Rapport Yandex üí§ üßô üòã</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Nous avons d√©velopp√© une conception d'un r√©seau de centres de donn√©es, qui vous permet de d√©ployer des clusters informatiques de plus de 100 000 serve...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Comment faire √©voluer les centres de donn√©es. Rapport Yandex</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yandex/blog/476146/"> Nous avons d√©velopp√© une conception d'un r√©seau de centres de donn√©es, qui vous permet de d√©ployer des clusters informatiques de plus de 100 000 serveurs avec une bande passante de bissection de plus d'un p√©tabit par seconde. <br><br>  √Ä partir du rapport de Dmitry Afanasyev, vous d√©couvrirez les principes de base de la nouvelle conception, la mise √† l'√©chelle des topologies qui surviennent avec ces probl√®mes, les options pour les r√©soudre, les caract√©ristiques du routage et la mise √† l'√©chelle des fonctions du plan de transfert des p√©riph√©riques r√©seau modernes dans des topologies fortement connect√©es avec un grand nombre de routes ECMP. .  En outre, Dima a bri√®vement parl√© de l'organisation de la connectivit√© externe, du niveau physique, du syst√®me de c√¢bles et des moyens d'augmenter encore la capacit√©. <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/rd/dy/sc/rddysciofis_rkvkotpo1tr52i0.jpeg"></a> <br><br>  - Bonjour tout le monde!  Je m'appelle Dmitry Afanasyev, je suis architecte r√©seau de Yandex et je m'occupe principalement de la conception de r√©seaux de centres de donn√©es. <br><a name="habracut"></a><br><img src="https://habrastorage.org/webt/zv/gl/5v/zvgl5vyexhel7a_6_mxp8wm4qoe.jpeg"><br><br>  Mon histoire portera sur le r√©seau de centres de donn√©es Yandex mis √† jour.  Il s'agit en grande partie d'une √©volution de la conception que nous avions, mais en m√™me temps, il y a de nouveaux √©l√©ments.  Il s'agit d'une pr√©sentation de revue, car il a fallu ajuster beaucoup d'informations en peu de temps.  Nous commen√ßons par choisir une topologie logique.  Ensuite, il y aura une vue d'ensemble du plan de contr√¥le et des probl√®mes d'√©volutivit√© du plan de donn√©es, le choix de ce qui se passera au niveau physique, regardons quelques fonctionnalit√©s des appareils.  Nous aborderons √©galement ce qui se passe dans le centre de donn√©es avec MPLS, dont nous avons parl√© il y a quelque temps. <br><br><img src="https://habrastorage.org/webt/ew/lm/rc/ewlmrcydwmv1s3gz2irvhuyev-q.jpeg"><br><br>  Alors, qu'est-ce que Yandex en termes de charges de travail et de services?  Yandex est un hyperscaler typique.  Si vous regardez dans la direction des utilisateurs, nous traitons principalement les demandes des utilisateurs.  En outre, divers services de streaming et sortie de donn√©es, car nous avons √©galement des services de stockage.  S'il est plus proche du backend, les charges et les services d'infrastructure y apparaissent, tels que les magasins d'objets distribu√©s, la r√©plication de donn√©es et, bien s√ªr, les files d'attente persistantes.  L'un des principaux types de charges est MapReduce et similaires, le traitement en streaming, l'apprentissage automatique, etc. <br><br><img src="https://habrastorage.org/webt/qi/71/qd/qi71qdjq7zbaxhmfmqbd6y66fba.jpeg"><br><br>  Comment est l'infrastructure au-dessus de laquelle tout cela se produit?  Encore une fois, nous sommes un hyperskaler tr√®s typique, bien que nous soyons peut-√™tre un peu plus pr√®s du c√¥t√© du spectre o√π se trouvent les plus petits hyperskalers.  Mais nous avons tous les attributs.  Dans la mesure du possible, nous utilisons du mat√©riel de base et une mise √† l'√©chelle horizontale.  Nous avons une croissance compl√®te de la mise en commun des ressources: nous ne travaillons pas avec des machines distinctes, des racks s√©par√©s, mais les combinons en un grand pool de ressources interchangeables avec quelques services suppl√©mentaires qui sont engag√©s dans la planification et l'allocation, et nous travaillons avec tout ce pool. <br><br>  Nous avons donc le niveau suivant - le cluster de calcul au niveau du syst√®me d'exploitation.  Il est tr√®s important que nous contr√¥lions enti√®rement la pile technologique que nous utilisons.  Nous contr√¥lons les terminaux (h√¥tes), le r√©seau et la pile logicielle. <br><br>  Nous avons plusieurs grands centres de donn√©es en Russie et √† l'√©tranger.  Ils sont unis par une √©pine dorsale utilisant la technologie MPLS.  Notre infrastructure interne est presque enti√®rement bas√©e sur IPv6, mais comme nous devons g√©rer le trafic externe, qui est toujours principalement achemin√© via IPv4, nous devons en quelque sorte livrer les demandes provenant d'IPv4 aux serveurs frontaux et continuer √† aller un peu vers IPv4 externe. Internet - par exemple, pour l'indexation. <br><br>  Les derni√®res it√©rations de la conception de r√©seaux de centres de donn√©es utilisent des topologies Clos √† plusieurs niveaux, et seul L3 y est utilis√©.  Nous avons quitt√© L2 il y a quelque temps et avons pouss√© un soupir de soulagement.  Enfin, notre infrastructure comprend des centaines de milliers d'instances informatiques (serveur).  Il y a quelque temps, la taille maximale du cluster √©tait d'environ 10 000 serveurs.  Cela est largement d√ª √† la fa√ßon dont les m√™mes syst√®mes d'exploitation au niveau du cluster - ordonnanceurs, allocation des ressources, etc., peuvent fonctionner. Depuis que des progr√®s ont √©t√© r√©alis√©s du c√¥t√© des logiciels d'infrastructure, l'objectif est d√©sormais d'environ 100 000 serveurs dans un cluster informatique, et nous avions une t√¢che - √™tre en mesure de construire des usines de r√©seau qui permettent une mise en commun efficace des ressources dans un tel cluster. <br><br><img src="https://habrastorage.org/webt/ra/co/cb/racocb4wtrqihsf4qcpswzzihhc.jpeg"><br><br>  Que voulons-nous d'un r√©seau de centres de donn√©es?  Tout d'abord - beaucoup de bande passante bon march√© et assez uniform√©ment r√©partie.  Parce que le r√©seau est ce substrat √† travers lequel nous pouvons faire la mise en commun des ressources.  La nouvelle taille cible est d'environ 100 000 serveurs dans un cluster. <br><br>  Bien s√ªr, nous voulons √©galement un plan de contr√¥le √©volutif et stable, car sur une si grande infrastructure, beaucoup de maux de t√™te surviennent m√™me √† cause d'√©v√©nements al√©atoires, et nous ne voulons pas que le plan de contr√¥le nous apporte un mal de t√™te.  En m√™me temps, nous voulons minimiser l'√©tat en son sein.  Plus l'√©tat est petit, mieux tout est stable et plus il est facile √† diagnostiquer. <br><br>  Bien s√ªr, nous avons besoin d'automatisation, car il est impossible de g√©rer une telle infrastructure manuellement, et c'√©tait impossible il y a quelque temps.  Dans la mesure du possible, nous avons besoin d'un soutien op√©rationnel et d'un soutien CI / CD dans la mesure du possible. <br><br>  Avec de telles tailles de centres de donn√©es et de grappes, la t√¢che de prise en charge du d√©ploiement et de l'expansion incr√©mentiels sans interruption de service est devenue assez aigu√´.  Si sur des clusters la taille d'un millier de voitures est probablement proche de dix mille voitures, elles pourraient toujours √™tre d√©ploy√©es en une seule op√©ration - c'est-√†-dire que nous pr√©voyons d'√©tendre l'infrastructure, et plusieurs milliers de machines sont ajout√©es en une seule op√©ration, puis un cluster de la taille de cent mille voitures ne se pose pas juste comme √ßa, il a √©t√© construit depuis un certain temps.  Et il est souhaitable que pendant tout ce temps ce qui a d√©j√† √©t√© pomp√©, l'infrastructure qui est d√©ploy√©e, soit disponible. <br><br>  Et une exigence que nous avions et que nous avons quitt√©e: il s'agit du support de la mutualisation, c'est-√†-dire de la virtualisation ou de la segmentation du r√©seau.  Maintenant, nous n'avons plus besoin de le faire au niveau de l'usine du r√©seau, car la segmentation est all√©e aux h√¥tes, ce qui a rendu la mise √† l'√©chelle tr√®s facile pour nous.  Gr√¢ce √† IPv6 et √† un grand espace d'adressage, nous n'avons pas eu besoin d'utiliser des adresses en double dans l'infrastructure interne, tout l'adressage √©tait d√©j√† unique.  Et du fait que nous avons appliqu√© le filtrage et la segmentation du r√©seau aux h√¥tes, nous n'avons pas besoin de cr√©er d'entit√©s de r√©seau virtuel dans les r√©seaux de centres de donn√©es. <br><br><img src="https://habrastorage.org/webt/nx/hi/9l/nxhi9l-ggxw-kvhbuoeldgkhnno.jpeg"><br><br>  Une chose tr√®s importante est que nous n'en avons pas besoin.  Si certaines fonctions peuvent √™tre supprim√©es du r√©seau, cela simplifie consid√©rablement la vie et, en r√®gle g√©n√©rale, √©largit le choix du mat√©riel et des logiciels disponibles, et simplifie consid√©rablement les diagnostics. <br><br>  Alors, de quoi n'avons-nous pas besoin, de quoi avons-nous pu refuser, pas toujours avec joie au moment o√π cela s'est produit, mais avec grand soulagement, une fois le processus termin√©? <br><br>  Tout d'abord, le rejet de L2.  Nous n'avons pas besoin de L2 r√©el ou √©mul√©.  Non utilis√© dans une large mesure en raison du fait que nous contr√¥lons la pile d'applications.  Nos applications sont mises √† l'√©chelle horizontalement, elles fonctionnent avec l'adressage L3, elles ne se soucient pas vraiment qu'une instance particuli√®re soit d√©sactiv√©e, elles en d√©ploient simplement une nouvelle, elle n'a pas besoin de se d√©ployer sur l'ancienne adresse, car il existe un niveau distinct de d√©couverte de service et de surveillance des machines situ√©es dans le cluster .  Nous ne transf√©rons pas cette t√¢che au r√©seau.  La t√¢che du r√©seau est de livrer des paquets du point A au point B. <br><br>  De plus, nous n'avons aucune situation o√π les adresses se d√©placent au sein du r√©seau, et cela doit √™tre surveill√©.  Dans de nombreuses conceptions, cela est g√©n√©ralement n√©cessaire pour prendre en charge la mobilit√© des machines virtuelles.  Nous n'utilisons pas la mobilit√© des machines virtuelles dans l'infrastructure interne du grand Yandex exactement, et, en outre, nous pensons que, m√™me si cela est fait, cela ne devrait pas se produire avec le support r√©seau.  Si vous avez vraiment besoin de le faire, vous devez le faire au niveau de l'h√¥te et conduire les adresses qui peuvent migrer dans des superpositions afin de ne pas toucher ou apporter trop de modifications dynamiques au syst√®me de routage lui-m√™me sous-jacent (r√©seau de transport). <br><br>  Une autre technologie que nous n'utilisons pas est la multidiffusion.  Je peux vous expliquer en d√©tail pourquoi.  Cela rend la vie beaucoup plus facile, car si quelqu'un s'occupe de lui et regarde √† quoi ressemble exactement le plan de contr√¥le d'une multidiffusion - dans toutes les installations, sauf la plus simple, c'est un gros casse-t√™te.  Et de plus, il est difficile de trouver une impl√©mentation open source qui fonctionne bien, par exemple. <br><br>  Enfin, nous concevons nos r√©seaux pour qu'ils n'aient pas trop de changements.  Nous pouvons compter sur le fait que le flux d'√©v√©nements externes dans le syst√®me de routage est faible. <br><br><img src="https://habrastorage.org/webt/qa/nz/e3/qanze3l9jiktreg59urwgnfmpec.jpeg"><br><br>  Quels probl√®mes surviennent et quelles limites doivent √™tre prises en compte lorsque nous d√©veloppons un r√©seau de centre de donn√©es?  Co√ªt bien s√ªr.  √âvolutivit√©, √† quel niveau nous voulons grandir.  La n√©cessit√© d'une expansion sans arr√™ter le service.  Disponibilit√© de la bande passante.  La visibilit√© de ce qui se passe sur le r√©seau, pour les syst√®mes de surveillance, pour les √©quipes op√©rationnelles.  La prise en charge de l'automatisation est, l√† encore, autant que possible, car diff√©rentes t√¢ches peuvent √™tre r√©solues √† diff√©rents niveaux, y compris l'introduction de couches suppl√©mentaires.  Eh bien et non - [dans la mesure du possible] - d√©pendance vis-√†-vis des fournisseurs.  Bien que dans diff√©rentes p√©riodes historiques, selon la section √† examiner, cette ind√©pendance √©tait plus facile ou plus difficile √† r√©aliser.  Si nous prenons une tranche des puces des p√©riph√©riques r√©seau, alors jusqu'√† r√©cemment, parlons d'ind√©pendance vis-√†-vis des fournisseurs, si nous voulions √©galement des puces √† haut d√©bit, cela pourrait √™tre tr√®s arbitraire. <br><br><img src="https://habrastorage.org/webt/fd/bq/s1/fdbqs1_kegdd7s4twvg144y0rus.jpeg"><br><br>  Quelle topologie logique utiliserons-nous pour construire notre r√©seau?  Ce sera un Clos √† plusieurs niveaux.  En fait, il n'existe actuellement aucune v√©ritable alternative.  Et la topologie Clos est assez bonne, m√™me si nous la comparons avec diverses topologies avanc√©es qui sont d√©sormais plus dans la sph√®re d'int√©r√™t acad√©mique, si nous avons des commutateurs avec une grande radix. <br><br><img src="https://habrastorage.org/webt/4y/pk/tt/4ypkttuvzezqubmxx3te-envyzo.jpeg"><br><br>  Comment le r√©seau de Clos en couches est-il approximativement structur√© et quels sont les diff√©rents √©l√©ments qui y sont appel√©s?  Tout d'abord, le vent s'est lev√©, pour savoir o√π le nord, o√π le sud, o√π l'est, o√π l'ouest.  Les r√©seaux de ce type sont g√©n√©ralement construits par ceux qui ont un tr√®s gros trafic ouest - est.  Comme pour le reste des √©l√©ments, un commutateur virtuel assembl√© √† partir de commutateurs plus petits est illustr√© en haut.  C'est l'id√©e de base de la construction r√©cursive de r√©seaux Clos.  Nous prenons des √©l√©ments avec une sorte de radix et les connectons afin que ce qui s'est pass√© puisse √™tre consid√©r√© comme un commutateur avec une radix plus grande.  Si vous en avez besoin de plus, la proc√©dure peut √™tre r√©p√©t√©e. <br><br>  Dans les cas, par exemple, avec un Clos √† deux niveaux, lorsqu'il est possible de distinguer clairement les composants verticaux dans mon diagramme, ils sont g√©n√©ralement appel√©s plans.  Si nous construisions Clos-avec trois niveaux de commutateurs vert√©braux (tous ceux qui ne sont pas des commutateurs borderline et non ToR et qui ne sont utilis√©s que pour le transit), les avions auraient l'air plus compliqu√©s, les deux niveaux ressembleraient exactement √† cela.  Le bloc de commutateurs ToR ou feuille et les commutateurs vert√©braux associ√©s de premier niveau que nous appelons Pod.  Les commutateurs de niveau 1 de la colonne vert√©brale en haut du pod sont le haut du pod, le haut du pod.  Les commutateurs qui sont situ√©s en haut de l'usine enti√®re sont la couche sup√©rieure de l'usine, le haut du tissu. <br><br><img src="https://habrastorage.org/webt/k-/sk/dd/k-skddvn98f6y-jk2e_5zzvlm4a.jpeg"><br><br>  Bien s√ªr, la question se pose: les Clos-r√©seaux sont construits depuis un certain temps, l'id√©e elle-m√™me vient g√©n√©ralement de l'√©poque de la t√©l√©phonie classique, les r√©seaux TDM.  Peut-√™tre que quelque chose de mieux est apparu, peut-√™tre que vous pouvez faire quelque chose de mieux d'une mani√®re ou d'une autre?  Oui et non.  Th√©oriquement, oui, dans la pratique, dans un proche avenir, certainement pas.  Parce qu'il existe un certain nombre de topologies int√©ressantes, certaines d'entre elles sont m√™me utilis√©es en production, par exemple, Dragonfly est utilis√© dans les applications HPC;  Il existe √©galement des topologies int√©ressantes telles que Xpander, FatClique, Jellyfish.  Si vous regardez des rapports lors de conf√©rences telles que SIGCOMM ou NSDI ces derniers temps, vous pouvez trouver un assez grand nombre d'articles sur des topologies alternatives qui ont de meilleures propri√©t√©s (l'une ou l'autre) que Clos. <br><br>  Mais toutes ces topologies ont une propri√©t√© int√©ressante.  Il emp√™che leur mise en ≈ìuvre dans les r√©seaux de centres de donn√©es, que nous essayons de construire sur du mat√©riel de base et qui co√ªtent de l'argent raisonnablement raisonnable.  Dans toutes ces topologies alternatives, la majeure partie de la bande n'est malheureusement pas accessible via les chemins les plus courts.  Par cons√©quent, nous perdons imm√©diatement la possibilit√© d'utiliser le plan de contr√¥le traditionnel. <br><br>  Th√©oriquement, la solution au probl√®me est connue.  Ce sont, par exemple, des modifications de l'√©tat de la liaison utilisant le chemin le plus court k, mais, encore une fois, il n'y a pas de protocoles qui seraient mis en ≈ìuvre en production et massivement disponibles sur l'√©quipement. <br><br>  De plus, comme la majeure partie de la capacit√© n'est pas accessible via les chemins les plus courts, nous devons modifier non seulement le plan de contr√¥le afin qu'il s√©lectionne tous ces chemins (et, en passant, c'est un √©tat beaucoup plus grand dans le plan de contr√¥le).  Nous devons encore modifier le plan de transfert et, en r√®gle g√©n√©rale, au moins deux fonctionnalit√©s suppl√©mentaires sont requises.  C'est l'occasion de prendre toutes les d√©cisions concernant le transfert de packages une seule fois, par exemple, sur un h√¥te.  Il s'agit en fait d'un routage source, parfois dans la litt√©rature sur les r√©seaux d'interconnexion, il est appel√© d√©cision de transfert tout √† la fois.  Et le routage adaptatif est d√©j√† une fonction dont nous avons besoin sur les √©l√©ments du r√©seau, ce qui se r√©sume, par exemple, au fait que nous s√©lectionnons le saut suivant en fonction des informations sur la moindre charge dans la file d'attente.  A titre d'exemple, d'autres options sont possibles. <br><br>  Ainsi, la direction est int√©ressante, mais, h√©las, nous ne pouvons pas l'appliquer maintenant. <br><br><img src="https://habrastorage.org/webt/5d/ki/zy/5dkizyihr8k0owfwar8yjdkx5m0.jpeg"><br><br>  D'accord, r√©gl√© sur la topologie logique de Clos.  Comment allons-nous l'adapter?  Voyons comment cela fonctionne et ce qui peut √™tre fait. <br><br><img src="https://habrastorage.org/webt/ap/dy/-2/apdy-2dnjdljys76pfv4rw7sr-k.jpeg"><br><br>  Dans le r√©seau Clos, il existe deux param√®tres principaux que nous pouvons en quelque sorte varier et obtenir certains r√©sultats: les √©l√©ments radix et le nombre de niveaux dans le r√©seau.  Je d√©cris sch√©matiquement comment l'un et l'autre affectent la taille.  Id√©alement, nous combinons les deux. <br><br><img src="https://habrastorage.org/webt/5d/ki/zy/5dkizyihr8k0owfwar8yjdkx5m0.jpeg"><br><br>  On peut voir que la largeur totale du r√©seau Clos est un produit de tous les niveaux de commutateurs vert√©braux du radix sud, du nombre de liens que nous avons, de la fa√ßon dont il se ramifie.  C'est ainsi que nous adaptons la taille du r√©seau. <br><br><img src="https://habrastorage.org/webt/ap/dy/-2/apdy-2dnjdljys76pfv4rw7sr-k.jpeg"><br><br>  En ce qui concerne la capacit√©, en particulier sur les commutateurs ToR, il existe deux options de mise √† l'√©chelle.  Soit nous pouvons, tout en conservant la topologie g√©n√©rale, utiliser des liens plus rapides, soit nous pouvons ajouter plus de plans. <br><br>  Si vous regardez la version d√©taill√©e du r√©seau Clos (dans le coin inf√©rieur droit) et revenez √† cette image avec le r√©seau Clos ci-dessous ... <br><br><img src="https://habrastorage.org/webt/4y/pk/tt/4ypkttuvzezqubmxx3te-envyzo.jpeg"><br><br>  ... alors c'est exactement la m√™me topologie, mais sur cette diapositive, elle est r√©duite de mani√®re plus compacte et les plans d'usine sont superpos√©s les uns aux autres.  C'est une seule et m√™me chose. <br><br><img src="https://habrastorage.org/webt/n9/ny/zd/n9nyzdzmz4i8o_c-adybirjhfos.jpeg"><br><br>  √Ä quoi ressemble la mise √† l'√©chelle d'un r√©seau Clos en chiffres?  Ici, j'ai des donn√©es sur la largeur maximale qu'un r√©seau peut obtenir, sur le nombre maximal de racks, de commutateurs ToR ou de commutateurs feuille, s'ils ne sont pas dans des racks, nous pouvons les obtenir en fonction de la gamme de commutateurs que nous utilisons pour les √©pines niveaux et combien de niveaux nous utilisons. <br><br>  Il montre combien de racks nous pouvons avoir, combien de serveurs et combien tout cela peut consommer √† raison de 20 kW par rack.  Un peu plus t√¥t, j'ai mentionn√© que nous visons une taille de cluster d'environ 100 000 serveurs. <br><br>  On peut voir que dans toute cette construction, deux options et demie sont int√©ressantes.  Il y a une option avec deux couches d'√©pines et des commutateurs 64 ports, ce qui est un peu court.  Ensuite, des options parfaitement adapt√©es pour les commutateurs de colonne vert√©brale √† 128 ports (avec 128 radix) √† deux niveaux, ou les commutateurs √† 32 radix √† trois niveaux.  Et dans tous les cas o√π il y a plus de radix et plus de niveaux, vous pouvez faire un tr√®s grand r√©seau, mais si vous regardez la consommation attendue, en r√®gle g√©n√©rale, il y a des gigawatts.  Vous pouvez poser le c√¢ble, mais il est peu probable que nous obtenions autant d'√©lectricit√© sur un seul site.  Si vous regardez les statistiques, les donn√©es publiques sur les centres de donn√©es - tr√®s peu de centres de donn√©es peuvent √™tre trouv√©s pour une capacit√© estim√©e √† plus de 150 MW.  De plus, en r√®gle g√©n√©rale, les campus de centres de donn√©es, plusieurs grands centres de donn√©es situ√©s assez pr√®s les uns des autres. <br><br>  Il y a un autre param√®tre important.  Si vous regardez la colonne de gauche, la bande passante utilisable y est indiqu√©e.  Il est facile de remarquer que dans un r√©seau Clos, une partie importante des ports est consacr√©e √† la connexion des commutateurs entre eux.  La bande passante utilisable est ce que vous pouvez distribuer, vers les serveurs.  Naturellement, je parle des ports conditionnels et de la bande.  En r√®gle g√©n√©rale, les liaisons au sein du r√©seau sont plus rapides que les liaisons vers les serveurs, mais par unit√© de bande, dans la mesure o√π nous pouvons la distribuer √† notre √©quipement serveur, il y a encore plus de bandes au sein du r√©seau lui-m√™me.  Et plus nous faisons de niveaux, plus les co√ªts unitaires pour fournir cette bande √† l'ext√©rieur sont √©lev√©s. <br><br>  De plus, m√™me cette bande suppl√©mentaire n'est pas exactement la m√™me.  Bien que les port√©es soient courtes, nous pouvons utiliser quelque chose comme le DAC (cuivre √† connexion directe, c'est-√†-dire des c√¢bles twinax) ou l'optique multimode, qui co√ªte encore plus ou moins raisonnable.  D√®s que nous passons √† des port√©es plus authentiques - en r√®gle g√©n√©rale, il s'agit d'optiques monomodes, et le co√ªt de cette bande suppl√©mentaire augmente consid√©rablement. <br><br>  Et encore une fois, en revenant √† la diapositive pr√©c√©dente, si nous cr√©ons un r√©seau Clos sans r√©abonnement, il est facile de regarder le diagramme, de voir comment le r√©seau est construit - en ajoutant chaque niveau de commutateurs vert√©braux, nous r√©p√©tons la bande enti√®re qui √©tait en dessous.  Niveau plus - plus toute la m√™me bande, le m√™me nombre de ports sur les commutateurs qu'au niveau pr√©c√©dent, le m√™me nombre d'√©metteurs-r√©cepteurs.  Par cons√©quent, le nombre de niveaux de commutateurs vert√©braux est tr√®s souhaitable pour minimiser. <br><br>  Sur la base de cette image, il est clair que nous voulons vraiment construire sur quelque chose comme des commutateurs avec 128 radix. <br><br><img src="https://habrastorage.org/webt/lh/hu/qu/lhhuquq763qnw40v3n66copxa5w.jpeg"><br><br>  Ici, en principe, tout est le m√™me que je viens de le dire, cette diapositive est plus susceptible d'√™tre examin√©e plus tard. <br><br><img src="https://habrastorage.org/webt/ci/yy/zi/ciyyzijzbhajnlsarxtn-tcoybo.jpeg"><br><br>   ,        ?     ,     -      .    ,     . ,      .  ,    .  ,   ,  ,  , .        ( ),       control plane    , , ,     ,       .        ,    ,     . <br><br> , ,    ,         SerDes- ‚Äî  -   .          forwarding .  ,    ,     ,  ,  ,     Clos-,     .      . <br><br>       ,    ,      .     ,      ,   ,    ,     ,      ,        ,    ,       ,   . <br><br><img src="https://habrastorage.org/webt/8y/in/ym/8yinymhp1wcbtuhl6tbvooghq24.jpeg"><br><br>      ‚Äî   , .  ,  ,   .     ,    ,  ,    -           ,    . ,    ,   ,  ,    . <br><br> ,  ,     ,   . -,    ,    .    ,    ,   128 ,              . <br><br>       ,  , ,    data plane.  . ,  ,   .  ,          ,      ,     . ,   ,   , ,    128    ,       .            .       .          . <br><br>   ,    -  ,    .   ( ),   ,    ‚Äî ToR-  leaf-,        .     -   ,    ,            , , -    .   ,     ,         ,    -    . <br><br><img src="https://habrastorage.org/webt/wc/yl/hl/wcylhl91sqnrvns5wqmembthdaa.jpeg"><br><br> ,        ,    . <br><br><img src="https://habrastorage.org/webt/uz/mo/ng/uzmongpipgv1bxt94ksbvlkruvi.jpeg"><br><br>     ?   .       ,       ,   ,       :    leaf-,   1,   2. ,     ‚Äî  twinax, multimode, single mode.    ,   ,    ,   ,    ,     . <br><br>       .    ,   ,   multimode ,      ,  ,  100-  .  , ,  ,  single mode ,    ,   single mode,  -      CWDM,   single mode (PSM)    ,     ,      ,      . <br><br>   :  ,      100  425  .      SFP28    ,  QSFP28  100 .     multimode   . <br><br>    - ,  -   , -    -   .  ,         .  , -   Pods      twinax- ( ). <br><br>  ,         ,     ,          CWDM.     . <br><br><img src="https://habrastorage.org/webt/ea/ci/pf/eacipf4xy2usawno2ccx4ucuwsm.jpeg"><br><br>   ,   ,      . ,   ,      50- SerDes      .  ,   ,           400G,      50G SerDes-   ,       100 Gbps per lane.   ,     50    100- SerDes  100 Gbps per lane,           . ,  50G SerDes   , ,    ,   100G SerDes         .   -    , ,    . <br><br><img src="https://habrastorage.org/webt/uz/mo/ng/uzmongpipgv1bxt94ksbvlkruvi.jpeg"><br><br>      .  ,      400-  200-    50G SerDes.  ,      ,  ,    ,       ,   , .   128.            ,  , , ,  . <br><br>         ,      ,    .     ,     ,    ,        , ,    100- ,       . <br><br><img src="https://habrastorage.org/webt/0b/r0/or/0br0oryllu-b_r4p9fcbino5bks.jpeg"><br><br>   ‚Äî   ,       . ,     .   leaf-     ‚Äî     ,     .       , ,    ‚Äî            . <br><br> ,  ,     ,      -. ,           ,   -       -,      .     .      ,  ,   ,       .           -  -,                -,     ,       ,  ,       .      :        .   -   , ¬´ ¬ª,      Clos-,      .     ,    ,   . <br><br><img src="https://habrastorage.org/webt/1t/hu/rq/1thurqskba0vbopspd3nhpfgsus.jpeg"><br><br>          .        -  ,   ,       ,      ,    -2-. <br><br>    .       ,      - 512  512 ,    ,      ,     -2.            Pods   -1,      -,      -2. <br><br><img src="https://habrastorage.org/webt/c6/gv/mr/c6gvmrqk7tjkdwxuvopyn76gvn8.jpeg"><br><br>  Voici √† quoi √ßa ressemble.      -2 ()   -.  ,      .            -,  .    ,   ,   . <br><br><img src="https://habrastorage.org/webt/ip/gh/sd/ipghsdpwb_goedtygn0bpaj89kq.jpeg"><br><br>  :   ,  .    control plane-?      ,  -  ,  link state  ,    , ,  ,       .     ,    ‚Äî  ,     link state .     ,   ,    , ,        fanout,     control plane .          link state    . <br><br>  ‚Äî  BGP.    ,   RFC 7938   BGP   -.   :            ,  ,   ,   path hunting.    ,    , ,   valley free.  ,  ,   ,    .    ,   ,     .    .   . <br><br>   ,     ,     BGP.      eBGP,   link local,      :    ToR,      -1-  Pod,       Top of Fabric.      ,       BGP     ,   . <br><br><img src="https://habrastorage.org/webt/hw/ep/kf/hwepkfz0cr9y5fhmdix0xbvhv00.jpeg"><br><br> ,       ,      ,   ,     control plane. L3      ,       ,         .     ‚Äî  ,  ,  ,      multi-path,       multi-path   ,  ,    ,    .  ,          ,     ,    ,      ,   .     ,    multi-path,     ToR-. <br><br><img src="https://habrastorage.org/webt/md/ce/zb/mdcezbkgiaxpdjcs1llfgnsvvps.jpeg"><br><br>   ,  ,   ‚Äî           .     ,   ,    ,        ,     BGP,    .  ,  corner cases    ,     BGP        . <br><br>           RIFT,       . <br><br><img src="https://habrastorage.org/webt/0u/h7/uq/0uh7uqwufze4nmj1oqrb6kun2jm.jpeg"><br><br>     ‚Äî  ,   data plane   ,        .       : ECMP ,       Next Hop. <br><br>    ,  ,     Clos- ,     ,   ,   ,  ,   .       ,     ECMP,  single path-.  .   ,   Clos-   ,      Top of fabric,   ,        .      ,            ,     .     ,     ECMP     state. <br><br>    data plane   ?    LPM (longest prefix match),   ,  100 .    Next Hop ,   , 2-4 .    ,    Next Hops ( adjacencies),   -  16  64.     .       :     MPLS  -?  ,    . <br><br><img src="https://habrastorage.org/webt/ze/ub/bj/zeubbjnb97nq_gvoprd374lotda.jpeg"><br><br>   .     ,        .                 white boxes  MPLS.   MPLS,   ,   ,  ,     ECMP.  Et voici pourquoi. <br><br><img src="https://habrastorage.org/webt/fc/za/pr/fczaprpywdv5b1jhoqrn9lxq8ti.jpeg"><br><br>    ECMP-  IP.                 Next Hops ( adjacencies,          -).   ,           -,     Next Hop.  IP   ,             ,      Next Hops. <br><br><img src="https://habrastorage.org/webt/n5/bl/jw/n5bljwqyrivakkgc2_f8cl4oifw.jpeg"><br><br>   MPLS ,            .          Next Hops    .  , ,  . <br><br>  ,         4000 ToR-,   ‚Äî 64  ECMP,    -1   -2.    ,  ,    ECMP-,      ToR ,       Next Hops. <br><br><img src="https://habrastorage.org/webt/ut/rz/jf/utrzjfe-ddmgf0dxjbq5ipxukcs.jpeg"><br><br>   ,     Segment Routing   .          Next Hops.      wild card:           .   ,       . <br><br>  ,    -   .   ?     Clos- .     ,       Top of fabric.          .  ,         ,       Top of fabric,      , ,          . ,   ,      ,     ,      . <br><br>   ‚Äî    .  ,  Clos-  ,  ,  ,     ToR,       Top of fabric   ,   .      Pod, Edge Pod,    . <br><br>    . , ,  Facebook.     Fabric Aggregator  HGRID.   -,    -.   ,           .   ,   touch points,  .  ,       ,    -.      ,    -  ,       ,       .  , ,    .    overlays,    . <br><br><img src="https://habrastorage.org/webt/mw/sj/ci/mwsjcikq0-fdqoklr0nal6vtjtg.jpeg"><br><br>     ?    ‚Äî   CI/CD-.    ,   ,   ,  .     ,    ,     .  ,       ,     . <br><br>  ,       .       .      ‚Äî  . <br><br>      .      ,  RIFT.        congestion control , , ,      ,  RDMA   . <br><br>        ,    , , ,   overhead.    ‚Äî        HPC Cray Slingshot,     commodity Ethernet,        .   overhead . <br><br><img src="https://habrastorage.org/webt/ja/-z/yx/ja-zyxc9orfwrz1lryew_4jt7r4.jpeg"><br><br>     ,  ,   .  ‚Äî  .     ‚Äî  .   -  scale out ‚Äî .  ,     .    .  Je vous remercie </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr476146/">https://habr.com/ru/post/fr476146/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr476134/index.html">MONQ - surveillance et AIOps originaires de Russie</a></li>
<li><a href="../fr476138/index.html">Les astronomes pensent que les satellites de communication SpaceX, OneWeb et d'autres soci√©t√©s menacent l'avenir de l'astronomie</a></li>
<li><a href="../fr476140/index.html">Comment am√©liorer l'√©coute si vous connaissez 7 000 mots mais ne le comprenez pas √† l'oreille?</a></li>
<li><a href="../fr476142/index.html">Pourquoi √©viter d'utiliser des exceptions pour contr√¥ler votre flux en Java</a></li>
<li><a href="../fr476144/index.html">Comment vous avez besoin et n'avez pas besoin d'√©crire un chat pour les bots en utilisant l'exemple de mon bot pour jouer √† Secret Santa</a></li>
<li><a href="../fr476148/index.html">postfix + dovecot + mysql sur FreeBSD</a></li>
<li><a href="../fr476156/index.html">Synchronous Request-Response √† l'aide d'Apache Kafka</a></li>
<li><a href="../fr476160/index.html">La naissance du logiciel √©ducatif et son histoire: des machines m√©caniques aux premiers ordinateurs</a></li>
<li><a href="../fr476162/index.html">Nous cr√©ons une application web moderne. Connaissance du projet et pr√©paration au travail. Partie 1</a></li>
<li><a href="../fr476164/index.html">¬´C'est aussi une analyse de donn√©es.¬ª Parlez de bioinformatique avec Mikhail Gelfand</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>