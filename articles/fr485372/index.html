<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßëüèø‚Äçü§ù‚Äçüßëüèø üåñ üõãÔ∏è √Ä propos de l'immuable: histoire de la 9e place de la Coupe AI russe 2019 üôà ‚ñ´Ô∏è üî∂</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Je m'appelle Andrey Rybalka, je participe √† la Russian AI Cup sous le surnom de lama et je vais vous redire comment ne pas gagner un macbook. Heureuse...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>√Ä propos de l'immuable: histoire de la 9e place de la Coupe AI russe 2019</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/mailru/blog/485372/"><p>  Je m'appelle Andrey Rybalka, je participe √† la Russian AI Cup sous le surnom de <a href="https://russianaicup.ru/profile/lama">lama</a> et je <a href="https://habr.com/ru/post/345598/">vais</a> vous <a href="https://habr.com/ru/post/345598/">redire</a> comment ne pas gagner un macbook.  Heureusement, je suis une personne exp√©riment√©e dans ce domaine - avec ces mains, je n'ai pas gagn√© jusqu'√† 7 pi√®ces. </p><br><p>  La t√¢che de cette ann√©e √©tait donc un jeu de plateforme / shooter 2D, pour lequel vous deviez √©crire un bot.  Le jeu ressemblait √† ceci: </p><br><p><img src="https://habrastorage.org/webt/81/rg/vp/81rgvptb0d2fztphudph9deltvc.jpeg"></p><br><p>  Le bot ressemblait √† ceci: </p><br><p><img src="https://habrastorage.org/webt/au/a7/qp/aua7qpjn5khyazt7nqnefeyvra0.png"></p><br><p>  Si vous √™tes int√©ress√© par la fa√ßon dont l'image # 2 a jou√© dans l'image # 1, s'il vous pla√Æt, sous cat. </p><a name="habracut"></a><br><p>  Si vous n'avez pas particip√© et n'avez pas lu d'autres articles, je vous recommande de voir d'abord √† quoi tout cela ressemble en dynamique <a href="https://russianaicup.ru/profile/lama">sur le site</a> ou sur le tube: </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/vfImU0kAFI0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><h2 id="turnirnaya-sistema">  Syst√®me de tournoi </h2><br><p>  Pour commencer, plus de 2 semaines sont accord√©es pour la programmation.  Ensuite, le premier tour commence.  Cela dure 2 jours et les 300 meilleurs durent.  Apr√®s le tour, les r√®gles du jeu changent (maintenant nous contr√¥lons deux personnages √† la fois) et une autre semaine est donn√©e, apr√®s quoi le deuxi√®me tour passe.  Ensuite, les r√®gles sont √† nouveau compliqu√©es (maintenant nous jouons sur des cartes beaucoup plus complexes), une autre semaine est donn√©e et, enfin, nous jouons la finale. </p><br><p> Mais ce n'est pas la fin.  Apr√®s les finales, il y a une autre semaine, √† la fin de laquelle le bac √† sable s'arr√™te simplement, et les 6 meilleurs, hors vainqueurs des finales, sont √©galement d√©cern√©s.  La diff√©rence fondamentale entre la finale du bac √† sable et la finale du championnat est que dans le bac √† sable, les jeux sont cr√©√©s dans un format al√©atoire, et pas seulement dans le format de la manche en cours. </p><br><h1 id="istoriya-uchastiya">  Historique de participation </h1><br><p>  O√π sans √ßa?  Vous pouvez sauter ceux qui ne sont pas int√©ress√©s.  La partie technique sera plus faible. </p><br><h2 id="nedelya-beta-testirovaniya-i-pervyy-raund">  Semaine de test b√™ta et premi√®re manche </h2><br><p>  J'ai commenc√© √† programmer, semble-t-il, le lendemain du d√©but de l'Open Beta Test.  Mais personnellement, c'√©tait un peu d√©motivant pour moi que les organisateurs cette fois, contrairement au pass√©, aient d√©cid√© de s'√©loigner √† nouveau de la pratique de publier un pseudo-code d'un simulateur.  Certes, parmi les participants, il y avait ceux qui aiment √©crire un simulateur par r√©tro-ing√©nierie, mais je ne suis pas l'un d'eux et je m'ennuyais √† le faire.  Comme ce n'√©tait pas mon premier championnat, je savais que t√¥t ou tard je m'impliquerais, mais pour la raison d√©crite ci-dessus, je me suis impliqu√© trop tard.  En cons√©quence, ce que certains participants ont fait au cours des deux premiers jours, j'ai pu me forcer √† terminer en seulement une semaine et demie.  En cons√©quence, j'ai √©crit la premi√®re ligne de code du bot 5 jours avant le premier tour.  Bref, au d√©but du premier tour, je n'√©tais pas pr√™t et le tour s'est pass√© sans ma participation.  J'ai d√©cid√© de me frayer un chemin jusqu'au deuxi√®me tour, gr√¢ce √† la num√©rotation par poste. </p><br><h2 id="vtoroy-raund">  Deuxi√®me tour </h2><br><p>  √Ä ce stade, j'ai d√©j√† programm√© au maximum, en moyenne 4 √† 6 heures par jour.  Quelques jours avant le d√©but du deuxi√®me tour, j'ai t√©l√©charg√© la premi√®re version du bot.  Elle est imm√©diatement remont√©e rapidement et est rapidement entr√©e dans le top 10 des bacs √† sable.  Puis le tour a commenc√©, o√π j'ai pris la cinqui√®me place. </p><br><h2 id="final">  Finale </h2><br><p>  J'ai pass√© la premi√®re soir√©e de la derni√®re semaine (sur quatre, car un d√©part √©tait pr√©vu vendredi) pour trouver le chemin.  Il y avait encore beaucoup d'id√©es, mais ce sur quoi se concentrer et laquelle des id√©es donnerait potentiellement le plus grand r√©sultat n'√©tait pas clair, j'ai donc essay√© d'am√©liorer en premier lieu ce qui a caus√© le plus grand nombre de d√©faites.  Mardi et mercredi, il s'agissait de l'am√©lioration de la vis√©e et du tir, ainsi que du contr√¥le des trousses de premiers secours. </p><br><p>  Ensuite, j'ai vu que quelque chose s'√©tait produit auquel je m'attendais depuis longtemps, mais j'esp√©rais que cela ne se produirait pas - certains opposants ont commenc√© √† utiliser activement les mines. </p><br><p>  Le fait est que lors de l'OBT, les organisateurs ont √©cout√© la proposition des participants et chang√© l'une des m√©caniques de jeu.  Dans le cas g√©n√©ral, cela est bien s√ªr bon lorsque les participants sont √©cout√©s.  Mais pr√©cis√©ment cette fois, la pr√©sence de commentaires a jou√© une blague cruelle.  Bref, les organisateurs ont permis de faire exploser des mines d'un coup de feu. </p><br><p>  C'est en soi logique.  Si j'√©tais une mine et qu'ils me tiraient dessus, j'exploserais aussi.  Mais le probl√®me est que nous avons jou√© sur des points, et des points ont √©t√© accord√©s non seulement pour des meurtres, mais aussi pour des d√©g√¢ts.  Ainsi, il s'est av√©r√© que si vous vous approchez suffisamment de l'ennemi, placez des mines sous vous et tirez dessus, vous tuez l'ennemi et vous-m√™me avec une explosion.  Il est impossible d'esquiver.  Vous obtenez tous les deux 1000 points pour les deux personnages mourants, mais vous obtenez √©galement des points pour les d√©g√¢ts.  Ainsi, si l'ennemi √©tait en bonne sant√©, vous recevrez 1000 points pour tuer et 100 pour les d√©g√¢ts, et l'ennemi - seulement 1000. </p><br><p>  Bien que tout le monde le sache, mais au sommet, presque personne n'a utilis√© de mines jusqu'au dernier.  Je ne sais pas comment les autres, mais personnellement, je ne l'ai pas utilis√© simplement parce que je ne voulais pas abuser de l'erreur de calcul involontaire.  Mais, comme ils l'ont dit dans un film, je savais que t√¥t ou tard nous passerons √† ces ordures. </p><br><p>  Bref, au milieu de la nuit du mercredi au jeudi, j'ai fouett√© l'auto-perturbation.  Purement situationnel, rien de bien avanc√©.  Juste par le principe que si √† la tique actuelle mon personnage est rentable de se suicider, et qu'il peut le faire, il le fait.  Comme la pratique l'a montr√©, certains autres participants pr√©voyaient d'utiliser les mines √† l'avance, ils ont donc mis en ≈ìuvre un suicide plus avanc√©, mais ont strat√©giquement pr√©vu de le d√©cha√Æner juste avant la finale.  En cons√©quence, il s'est av√©r√© ce qui s'est pass√© - 9√®me place en finale, ainsi que l'ann√©e derni√®re. </p><br><h2 id="final-pesochnicy">  Sandbox Finale </h2><br><p>  Apr√®s la finale, j'ai quitt√© la ville pour les vacances.  Il est revenu une semaine plus tard et le premier soir, litt√©ralement en 2-3 heures de travail, a consid√©rablement am√©lior√© les mines, dont je parlerai plus en d√©tail dans la partie technique.  Les autres changements concernaient principalement l'√©dition de bogues et l'ach√®vement de la fonction d'√©valuation.  Bref, un peu de programmation et beaucoup de tests. </p><br><h1 id="tehnicheskaya-chast">  Partie technique </h1><br><p>  Soit la vitesse de Java, soit le rayon de courbure des mains, mais plut√¥t, les deux ensemble, une fois de plus ne m'a pas permis de m'entendre avec une pure simulation.  Par cons√©quent, le mouvement, le tir normal et l'installation de mines sont s√©par√©s de moi. </p><br><h2 id="simulyaciya">  La simulation </h2><br><p>  √Ä travers les yeux d'un bot, le monde ressemblait √† ceci: </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/jwnUo2b96eA" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><p>  Sur la vid√©o, je pense, et donc tout est √† peu pr√®s clair.  Dans le coin sup√©rieur gauche se trouve le d√©bogage de la fonction d'√©valuation.  Vous pouvez voir en quoi consiste le score de chaque trajectoire.  Silhouettes jaunes (par exemple, √† 2h30) - ce sont les m√™mes trajectoires dans 9 directions, celles-ci seront plus basses.  Les lignes de fl√®ches quelque part √† partir de 2:50 sont une recherche de chemin (rouge - √† l'ennemi, vert - √† la trousse de premiers soins, jaune-vert - √† l'arme, bleu - √† la mine).  Les carr√©s verts √† la fin de la vid√©o sont mes tuiles PVS, qui sont visibles depuis la tuile s√©lectionn√©e.  Les points rouges en leur centre indiquent d'o√π vient la visibilit√© inverse. </p><br><p>  Les mouvements des personnages simulent sans microtics.  Les vols de balles aussi, mais j'utilise plusieurs hacks pour que les situations soient moins susceptibles de se produire lorsque la coche compl√®te la balle "traverse" le personnage sans le toucher, m√™me si elle aurait d√ª le toucher avec microtics.  Par exemple, si vous y r√©fl√©chissez, la situation d√©crite ne peut se produire que dans les coins: </p><br><p><img src="https://habrastorage.org/webt/ve/b3/wf/veb3wfaqijpe7p-qk2scwgfrueq.png"></p><br><p> Au tick 1, la balle est √† la position 1, au tick 2 - √† la position 2, respectivement.  Sans Mikrotik - Boris-raifort - vous obtenez, avec Mikrotik - tir d'oreille.  Donc, pour que cela se produise, la position de la puce dans les graduations 1 et 2 doit √™tre sur des c√¥t√©s diff√©rents d'au moins l'une des faces du personnage ou de la tuile (un rectangle √† la menthe).  Ainsi, il est possible de simuler une balle sans microtics jusqu'√† ce que, comme appliqu√© √† l'image ci-dessus, la condition <code>old_bullet.x &gt; character_left_side.x != new_bullet.x &gt; character_left_side.x</code> , et si cela se produit, alors vous devriez analyser cette coche plus attentivement . </p><br><p>  Ensuite, √† chaque tick, j'ai recalcul√© les trajectoires de toutes les balles volantes avant qu'elles n'entrent en collision avec le mur et j'ai enregistr√© leur position dans chaque tick du tableau, de sorte que dans la simulation, vous puissiez rapidement v√©rifier les collisions avec elles. </p><br><p>  Pour un bazooka, apr√®s avoir heurt√© un mur, j'ai math√©matiquement, sans microtics, calcul√© le point exact d'impact afin de calculer correctement l'√©picentre de l'explosion. </p><br><p>  De plus, √† chaque tick, je remplissais le tableau <code>dodge_trajectories</code> - simulait le mouvement de chaque personnage, y compris les ennemis, dans 8 directions pour 25 ticks (silhouettes jaunes dans la vid√©o du visualiseur, apr√®s avoir activ√© la case √† cocher traj possible. Par exemple, √† 2h30).  Et, comme pour les balles, il a gard√© toutes les positions possibles √† chaque tick.  Il a ensuite √©t√© utilis√© dans de nombreux endroits, dont certains que je mentionnerai. </p><br><p>  J'ai √©galement calcul√© <a href="https://www.wikiwand.com/en/Potentially_visible_set">PVS</a> par tuiles √† l'avance.  Pour chaque cellule, j'ai gard√© une liste de tuiles, dont le centre peut √™tre vu debout en elle.  Il a √©t√© calcul√© par lancer de rayons.  Cela peut √™tre vu dans la vid√©o du visualiseur, √† la fin.  Les carr√©s verts sont des tuiles visibles depuis la cellule s√©lectionn√©e.  Les points rouges en leur centre indiquent d'o√π vient la visibilit√© inverse. </p><br><h2 id="poisk-puti">  Rechercher un moyen </h2><br><p>  Impl√©ment√© par l'algorithme de Dijkstra selon les points de cheminement.  La tuile dans laquelle vous pouvez vous tenir √©tait consid√©r√©e comme Waypoint.  L'adaptation de l'algorithme pour le jeu de plateforme 2D est la sienne, propre au pays, et donc, dans un souci d'optimisation, il est construit sur des b√©quilles.  Mais cela a fonctionn√© assez rapidement: j'ai d√©j√† construit Dijkstra (je n'ai pas compris comment le dire correctement) √† partir de chaque sujet au niveau de chaque tuile.  J'ai construit des routes uniquement celles qui avaient une capacit√© de cross-country bidirectionnelle.  C'√©tait n√©cessaire pour que plus tard vous puissiez tr√®s rapidement obtenir le chemin de n'importe quelle tuile √† n'importe quelle trousse de premiers soins / arme / mine.  Il √©tait possible de se d√©barrasser de cette restriction, mais dans la pratique, j'estimais qu'il √©tait plus raisonnable de consacrer du temps √† d'autres choses, car cette restriction n'√©tait pas tr√®s dommageable. </p><br><p>  De plus, chaque fois que je passais √† une autre tuile avec n'importe quel personnage (le mien et celui de l'ennemi), je comptais pour lui le chemin vers l'ennemi le plus proche, une trousse de premiers soins, ainsi que vers la mine et les armes, s'il en avait encore besoin. </p><br><p>  Sur mon ordinateur personnel dans un jeu avec 1000 ticks, la recherche de chemin enti√®re a pris environ 100 ms au total. </p><br><p>  Si le chemin croise un ennemi ou un ami, j'ajoute simplement quelques dizaines d'unit√©s √† son poids.  Ainsi, s'il y a un d√©tour relativement court, ou si apr√®s cela il est plus rentable de courir vers un autre objet, je le ferai.  Dans la vid√©o du visualiseur ci-dessus, cela peut √™tre vu √† 2h55, o√π le chemin vers l'ennemi le plus proche a √©t√© contourn√©, car  un chemin droit croise le deuxi√®me caract√®re. </p><br><p>  Visualisation du chemin de recherche: </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/Dyk03lk14Ho" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><p>  Les carr√©s violets translucides sont des points de cheminement, ce sont aussi les sommets du graphique.  Fl√®ches vert lime - bords <sup>1</sup> colonne <sup>2</sup> <br>  <em><sup>1 √†</sup> ne pas confondre avec les c√¥tes; <sup>2</sup> toute co√Øncidence de nature monarchique est al√©atoire [environ]</em> </p><br><h2 id="peredvizhenie">  Mouvement </h2><br><p>  Deux personnages ont march√© √† tour de r√¥le.  Si vous pensiez juste - "et maintenant il est entr√© dans le top 10?!", Alors vous avez pens√© correctement.  :) Il n'y avait pas assez de ressources pour marcher avec les deux.  Une exception a √©t√© le cas de l'apparition d'une nouvelle balle volante. </p><br><p>  La base du choix d'une trajectoire est la g√©n√©tique sans croisement.  Mais si l'ann√©e derni√®re, dans le football, la g√©n√©tique s'est montr√©e parfaitement, alors cette ann√©e elle a donn√© un tout petit avantage.  Mes exp√©riences ont montr√© un r√©sultat tr√®s proche aussi bien en g√©n√©tique qu'en recherches al√©atoires.  Je vois plusieurs raisons √† cela, mais la principale me semble √™tre la suivante: Dans le football, nous avions un objectif fixe - le ballon.  La plupart du temps, son comportement √©tait pr√©visible - si nous trouvions une bonne trajectoire pour frapper le ballon au but et le suivre, puis apr√®s 20 tics, cette trajectoire sera probablement toujours bonne, car  le ballon ne peut pas changer spontan√©ment sa trajectoire.  Mais cette ann√©e, nous avons jou√© non pas avec le ballon, mais avec des personnages ennemis.  Ils ont chang√© de comportement √† chaque tick.  La pertinence de la trajectoire est donc rest√©e tr√®s courte. </p><br><p>  J'ai toujours utilis√© la g√©n√©tique pour deux raisons: </p><br><ol><li>  Je viens de copier son code de l'ann√©e derni√®re.  C'√©tait m√™me dr√¥le √† quel point j'avais peu √† faire des changements, √† l'exception de la fonction d'√©valuation, de sorte que le bot a commenc√© √† se d√©placer de mani√®re tol√©rable.  En bref, j'ai √©crit un simulateur pendant une semaine et demie, puis pendant environ une heure, j'ai copi√© la logique du mouvement de l'ann√©e derni√®re, dans une autre heure j'ai jet√© une estimation simple et le bot, lors du tournage d'un d√©marrage rapide, a commenc√© √† gagner assez stable avec. </li><li>  J'aime apparemment la douleur.  Sinon, je ne sais pas comment expliquer √† nouveau pourquoi j'ai √©crit en Java, et pas comme tous les tops normaux: </li></ol><br><p><img src="https://habrastorage.org/webt/kt/qp/2n/ktqp2np94dkdbxjbajr9pgp0fky.png"></p><br><p>  J'ai donc d√ª tout faire dans tous les sens pour que la strat√©gie ne tombe tout simplement pas avec un timeout √† chaque premier match.  Et l'approche avec la g√©n√©tique m'a permis de sauvegarder un instantan√© de la simulation du monde et des points compt√©s, puis, lors du calcul des g√©n√©rations suivantes, de d√©sactiver les instantan√©s uniquement √† partir du premier g√®ne <em>mut√©</em> . </p><br><p>  C'est-√†-dire  en gros, si dans la premi√®re g√©n√©ration, je suis all√© 10 tiques vers la droite, puis j'ai saut√©, et dans la deuxi√®me g√©n√©ration, j'√©value un mutant qui va de 10 tiques vers la droite puis saute vers le bas, alors le point de r√©f√©rence pour le mutant sera l'instantan√© pr√©c√©demment calcul√© du monde et des points apr√®s 10 mouvements vers la droite.  Ainsi, j'ai consid√©rablement r√©duit le calcul. </p><br><p>  Igogo, un algorithme de mouvement approximatif: </p><br><ol><li>  Nous g√©n√©rons N g√©notypes al√©atoires.  Chacun se compose de M g√®nes al√©atoires.  Chaque g√®ne est un nombre cod√© par action: un num√©ro est responsable de la direction du mouvement, le second est pour sauter / marcher / sauter vers le bas, le troisi√®me est pour le tir de base (uniquement pour la fonction d'√©valuation, l'algorithme de tir de base sera d√©crit ci-dessous), le quatri√®me pour le nombre de r√©p√©titions de ce action.  Le nombre total d'actions dans le g√©notype, ainsi que les r√©p√©titions, ne d√©passe pas la profondeur de simulation - 40 ticks. </li><li>  Nous leur ajoutons un certain nombre de g√©notypes cod√©s en dur: mouvement direct dans 9 directions (8 c√¥t√©s + immobile) et quelques pr√©r√©glages simples, ce qui en pratique a aid√© √† sortir un peu plus rapidement de certaines situations typiques du labyrinthe.  Par exemple, ce sont les trajectoires: ‚Æ§ ‚Æ• </li><li>  Ajoutez le meilleur g√©notype du mouvement pr√©c√©dent. </li><li>  √âvaluez tout, laissez le M meilleur. </li><li>  Nous cr√©ons la prochaine g√©n√©ration dans laquelle dans chaque g√©notype un ou plusieurs g√®nes ont mut√©. </li><li>  Nous les ajoutons au pool g√©n√©ral, qui contient d√©j√† le M best de la derni√®re g√©n√©ration. </li><li>  Nous r√©p√©tons, √† partir du point 4, plusieurs fois. </li></ol><br><h2 id="ocenochnaya-funkciya">  Fonction d'√©valuation </h2><br><p>  En fait, l'endroit o√π vit la strat√©gie. </p><br><p>  Tout au long du championnat, un tas de m√©triques de toutes sortes ont √©t√© ajout√©es (pour √™tre pr√©cis, 57).  Certains d'entre eux n'ont pas v√©cu pour voir la finale.  L'autre partie a surv√©cu, mais dans le contexte d'inflation du score pendant le championnat, cela n'a pratiquement pas affect√© le r√©sultat, mais le reste, de l'ordre de 20-25, √©tait pr√©cis√©ment responsable du mouvement et du tir de base. </p><br><p>  Je vais donner quelques exemples de m√©triques importantes, dans un ordre al√©atoire: </p><br><ol><li>  P√©nalit√© pour une explosion de balle / bazooka en moi. </li><li>  Bonus pour les degr√©s de libert√©.  C'est-√†-dire  pour le nombre de directions (haut / bas / gauche / droite) o√π je peux me d√©placer de la tuile actuelle.  Comme vous pouvez le deviner, plus il y a de degr√©s de libert√© - plus il y a de chances d'esquiver une balle.  Ce bonus a oblig√© le bot √† s'en tenir aux plates-formes et aux escaliers.  Le bonus est trois fois plus √©lev√© si l'adversaire a un bazooka. </li><li>  P√©nalit√© pour la distance (par la recherche du chemin) √† la trousse de premiers soins la plus proche;  pour la distance moyenne (par la recherche du chemin) √† toutes les trousses de premiers soins;  parce que le chemin de lui √† la trousse de premiers soins la plus proche de lui est inf√©rieur √† celui de moi √† sa (!) trousse de premiers soins. </li><li>  P√©nalit√© pour le fait que l'ennemi voit ma t√™te. </li><li>  P√©nalit√© pour le fait que l'ennemi voit mes jambes (les points 4 et 5 ont oblig√© le bot √† se cacher derri√®re des abris partiels). </li><li>  Bonus d'attaque lors du rechargement des armes ennemies. </li><li>  Bonus pour les coups r√©alis√©s. </li><li>  P√©nalit√© pour trop ou trop peu de distance de l'ennemi.  Cela d√©pendait de plusieurs facteurs: la sant√© des deux, si les armes des deux √©taient recharg√©es, etc. </li><li>  Bonus pour les conditions de travail dangereuses. </li><li>  P√©nalit√©s pour l'√©tat de chute et l'√©tat de vol sur le jumppad (car ces deux √©tats ne peuvent pas √™tre interrompus, et donc, ils sont beaucoup moins susceptibles d'√©chapper √† la balle). </li><li>  Le bonus pour le nombre de trousses de premiers soins qui se trouvent de l'autre c√¥t√© de moi, par rapport √† l'ennemi (c'est-√†-dire, par exemple, si l'ennemi est √† ma droite, alors j'obtiendrai un bonus pour le nombre de trousses de premiers soins qui sont √† ma gauche. Rounds 1 et 2, o√π le seul moyen de passer de l'ennemi √† ces trousses de premiers soins √©tait par moi). </li><li>  Bonus pour suivre le chemin de l'ennemi, de la trousse de premiers soins (si je suis bless√©), d'une mine (si j'en ai moins de deux), des armes (s'il n'y en a pas). </li><li>  P√©nalit√© pour la proximit√© des murs au cas o√π l'ennemi aurait un bazooka.  Plus pr√©cis√©ment, j'ai consid√©r√© combien de tiques la roquette ennemie, si elle la rel√¢che, volera vers le mur pr√®s de moi, et sur cette base, cette zone pr√®s du mur d'o√π il est impossible d'√©chapper √† l'explosion √©tait consid√©r√©e comme dangereuse et j'ai re√ßu une amende pour y √™tre. </li><li>  Bonus du Nouvel An. </li></ol><br><h2 id="uklonenie-ot-pul">  Bullet Evasion </h2><br><p>  Cela se produit automatiquement, en raison de ce qui pr√©c√®de </p><br><h2 id="pricelivanie">  Viser </h2><br><p>  Il se passe beaucoup de choses.  Le plus important est peut-√™tre un algorithme simple et efficace qui d√©cide si je dois pointer une arme vers l'ennemi (car viser augmente la propagation des armes): </p><br><ol><li>  Nous consid√©rons l'angle entre (last_angle - min_spread) et (last_angle + max_spread). </li><li>  Nous tirons les rayons du centre de mon personnage aux deux coins de l'ennemi <a href="https://www.wikiwand.com/ru/AABB">AABB le</a> plus proche de la perpendiculaire.  Si l'un d'eux est hors de port√©e (last_angle - min_spread) ... (last_angle + max_spread), nous coupons cette plage. </li><li>  Nous consid√©rons l'angle entre ces rayons. </li><li>  Divisez le premier deuxi√®me coin par le premier, nous obtenons la couverture (couverture).  Repr√©sente la probabilit√© <em>actuelle</em> en pourcentage que la trajectoire de la balle tir√©e croise la bo√Æte de l'adversaire. </li><li>  Nous simulons une action dans laquelle la vis√©e d'un ennemi se produit, avec un changement de dispersion. </li><li>  R√©p√©tez les √©tapes 1 √† 4 pour le nouvel ensemble [last_angle, min_spread, max_spread].  Ainsi, nous consid√©rons quelle couverture sera au cas o√π nous viserions. </li><li>  En cons√©quence, nous avons la couverture actuelle, ainsi que la couverture pr√©vue au cas o√π nous viserions l'arme sur l'ennemi.  Si la couverture estim√©e est sup√©rieure √† la couverture actuelle, nous visons. </li></ol><br><p>  D√©mo 2 points: </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/au1eInNY9XQ" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><p>  Si les lignes sont vertes, l'ennemi tombe enti√®rement dans la zone de vis√©e.  Orange - partiellement, rouge - ne tombe pas du tout. </p><br><p>  Mais je ne vise g√©n√©ralement pas le ventre de l'ennemi, mais un point plus optimal. </p><br><p>  Pour un pistolet et un fusil d'assaut, si l'ennemi est dans les airs, je consid√®re combien de tiques la balle atteindra sa position actuelle, puis je prends de son tableau <code>dodge_trajectories</code> d√©crit ci-dessus toutes ses positions possibles √† travers ce nombre de tiques, en moyenne toutes les 8 positions et, lorsque je viser, je consid√®re que l'ennemi est √† ce point moyen. </p><br><p>  S'il se tient au sol, je vise ¬´sur la t√™te¬ª, sur la base de ces consid√©rations qu'il ne peut que sauter vers le haut, de sorte qu'un coup dans la t√™te est beaucoup plus difficile √† esquiver qu'un coup dans l'estomac, et plus encore, dans les jambes. </p><br><p>  Pour un bazooka, je prends √©galement 8 positions possibles √† travers autant de tiques que la fus√©e atteint l'ennemi.  Pour eux, je construis un c√¥ne (plus pr√©cis√©ment, un secteur d'un cercle) qui d√©crit toutes ces positions et √† l'int√©rieur de ce c√¥ne je trie les trajectoires en quelques pas.  Pour chaque trajectoire, je simule un vol de fus√©e, accompagn√© d'une explosion en cas de choc dans le mur.  La trajectoire dans laquelle l'ennemi a le moins de chance d'esquiver, je l'utilise pour viser. </p><br><p>  M√™me dans certains cas, pour tomber et voler du jumppad (c'est-√†-dire ces √©tats que l'ennemi ne peut pas interrompre), je consid√®re simplement le point d'interception par la balle de l'ennemi, en r√©solvant le syst√®me d'√©quations de mouvement.  Le code a √©t√© copi√© de son propre robot de hockey de 2014, o√π il a √©t√© utilis√© pour intercepter la rondelle.  :) </p><br><p>  Entre autres choses, dans certaines situations, j'ai annul√© la vis√©e s'il y a une position sur mon chemin pour les 10 tics suivants dans laquelle le rayon du centre de cette position dans la direction du dernier angle <em>actuel</em> intersecte avec l'ennemi.  Cela m'a permis de viser avec le mouvement, sans changer l'angle, et donc sans augmenter l'√©cart. </p><br><h2 id="strelba">  Tournage </h2><br><p>  Le tir de base √©tait cousu dans la trajectoire trouv√©e et √©tait purement situationnel.  Mais aussi, √† chaque tic, mon bot essayait de calculer s'il √©tait logique de tirer en ce moment, et si c'√©tait le cas, il tirait.  Par exemple: </p><br><ul><li>  si l'ennemi n'est pas assur√© d'esquiver; </li><li>  si la couverture √©tait sup√©rieure √† une valeur fixe. </li></ul><br><p>  De plus, si mon arme √©tait un bazooka, j'ai simul√© toutes sortes de trajectoires au sein de la propagation en cas de tir imm√©diat, avec un pas.  Et si le r√©sultat montrait que le b√©n√©fice potentiel d√©passait le pr√©judice potentiel, je tirais.  J'ai √©valu√© l'avantage par 4 m√©triques par ordre d√©croissant d'importance pour moi et pour l'ennemi: mort garantie (la mienne ou l'ennemi), mort possible, dommage garanti, dommage possible.  S'il y avait au moins une trajectoire dans laquelle, par exemple, j'√©tais <em>assur√© de</em> me tuer et de ne tuer que l'ennemi, je ne tirais pas. </p><br><p>  Il y a eu d'autres contr√¥les.  Par exemple, je pourrais annuler un tir si dans le prochain tick de ma trajectoire la couverture potentielle est plus √©lev√©e que dans l'actuelle. </p><br><p>  En g√©n√©ral, la logique m'a dit que la prise de vue de base devrait √™tre d√©sactiv√©e, mais les tests ont montr√© le contraire.  Je ne peux pas imaginer pourquoi. </p><br><h2 id="miny">  Mines </h2><br><p>  Au moment de la finale, ils √©taient √† leurs balbutiements: j'ai coch√© chaque tick ce qui se passerait si je mettais 1 ou 2 mines en ce moment, selon la sant√© de l'adversaire, et les tirais.  Si je suis assur√© de tuer l'ennemi et si cela est rentable pour moi (soit sur des points, soit parce que seul l'ennemi mourra), je l'ai fait. </p><br><p>  Apr√®s la nouvelle ann√©e, au retour d'un voyage, j'ai √©crit l'algorithme le premier soir, ce qui m'a amen√© √† 2-4 places dans le tableau.  L'algorithme √©tait simple: je simulais √† chaque tick ce qui se passerait si je passais imm√©diatement en mode berserk et courais vers l'ennemi afin de le faire exploser avec une mine d√®s que possible.  Pour l'ennemi, j'ai simul√© une simple √©vasion en utilisant les m√™mes dodge_trajectories: j'ai pris trois trajectoires qui augmentaient la distance de moi.  Par exemple, si j'√©tais √† gauche de l'ennemi, j'ai analys√© trois cas: l'ennemi s'enfuit √† droite;  l'ennemi court √† droite et saute;  court √† droite et saute vers le bas.  Si, dans les trois cas, j'avais la garantie d'avoir le temps de le tuer avec une mine et qu'il ne pouvait pas mettre les mines devant moi, je l'ai fait. </p><br><p>  En outre, l'algorithme a pu sauter ou sauter au niveau de la strat√©gie de d√©marrage rapide - simplement en fonction de la diff√©rence dans la coordonn√©e Y. </p><br><p>  En cons√©quence, sur les cartes finales, presque chaque match s'est termin√© en moins de 1000 ticks avec l'auto-dynamitage de mes deux personnages. </p><br><h2 id="pacifizm">  Pacifisme </h2><br><p>  Voyant l'efficacit√© de mes mines, j'ai d√©cid√© de v√©rifier mon hypoth√®se faite plus t√¥t sur le <a href="https://t.me/aicups">canal t√©l√©gramme</a> qu'en finale il √©tait possible de prendre une place au sommet sans tirer du tout.  J'ai donc juste pris et d√©sactiv√© le tournage dans mon bot, √† l'exception d'un tir de mine.  La seule chose est que pour ne pas perdre la note, ce mode n'√©tait activ√© que si j'avais suffisamment de mines pour tuer l'ennemi. </p><br><p>  Bref, mon bot est devenu pacifiste.  Pour d√©montrer sa paix et son humilit√©, il n'a m√™me pas regard√© l'ennemi (voir vid√©o).  Eh bien, il a parfois tir√© des mines, vous pensez.  Je n'ai pas tir√© sur des adversaires!  Et s'ils sont morts en m√™me temps - eh bien, que pouvez-vous faire, un accident tragique. </p><br><p>  En g√©n√©ral, j'ai t√©l√©charg√© cette version sur le site, cr√©√© 4 jeux avec chacun des 3 premiers puis ... </p><br><p><img src="https://habrastorage.org/webt/sv/e8/69/sve869ijby1cp9lduijtx5wfusc.png"></p><br><p>  ... a remport√© 3 des 4 matchs contre chacun.  En g√©n√©ral, il est √©trange que les voisins ne soient pas venus se plaindre de mon rire hom√©rique au milieu de la nuit.  :) </p><br><p>  Admirez-vous: </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/ZpvvN21vufg" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><p>  Eh, si j'ai pass√© ces 2-3 heures avant la finale, et non apr√®s, cet article dirait peut-√™tre comment gagner un MacBook, et non comment l'√©viter par tous les moyens, qui sait.  H√©las, l'histoire ne conna√Æt pas l'humeur subjonctive. </p><br><h1 id="testirovanie">  Test </h1><br><p>  En g√©n√©ral, j'ai test√© toutes les modifications si souvent que le r√©sultat √©tait statistiquement significatif.  Plus pr√©cis√©ment, la limite inf√©rieure de l'intervalle de confiance devrait d√©passer 50%.  Pour les finales du bac √† sable, le script a s√©lectionn√© les coefficients.  Au cours des ann√©es pr√©c√©dentes, j'ai essay√© la g√©n√©tique, mais cela a mal fonctionn√© - pour un r√©sultat normal, il fallait jouer √† trop de jeux.  Cette fois, je viens de changer un coefficient √† la fois et j'ai r√©cup√©r√© 200 matchs.  Dans les cas o√π le r√©sultat √©tait bon, j'ai effectu√© des tests suppl√©mentaires.  Bref, a laiss√© du jour au lendemain deux douzaines de coefficients et a eu un r√©sultat le matin. </p><br><h1 id="v-zaklyuchenie">  En conclusion </h1><br><p>  C'est en quelque sorte que tout cela a fonctionn√© avec le chagrin en deux. </p><br><p>  Au cours des derniers jours avant la fin du bac √† sable, j'ai pass√© la plupart du temps √† la deuxi√®me place du tableau avec une marge importante par rapport au troisi√®me, mais quelques heures avant la fin du bac √† sable, je n'ai pas eu de chance et j'ai commenc√© une s√©rie de jeux selon les r√®gles des tours 1 et 2, tandis que ma strat√©gie a le plus jou√© par les r√®gles de la finale.  Par exemple, ici, sur 13 matchs, il n'y en a qu'un selon les r√®gles finales.  Donc moi aussi, mon taux de victoire dans ces matchs est ressorti bien pire que d'habitude.  En g√©n√©ral, le tout-puissant al√©atoire: </p><br><p><img src="https://habrastorage.org/webt/4-/xl/wi/4-xlwimvw-jwctcn8qerejyjsma.jpeg"></p><br><p>  En cons√©quence, j'ai perdu trop de matchs, perdu tout mon avantage et je suis tomb√© de 2 √† 4 places, et je n'ai pas eu le temps de r√©cup√©rer, car le championnat √©tait termin√©.  C'est bien que le bac √† sable n'ait pas perdu la premi√®re place dans la liste des gagnants. </p><br><p>  Encore une fois, je tiens √† remercier Mail.ru Group pour ce prochain merveilleux championnat.   , ,   ,          ( 1100 ).      ‚Äî ,   .  ,         .  , , ,  ! </p><br><p>   ,    .  , ,       .       "   8 ". </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr485372/">https://habr.com/ru/post/fr485372/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr485354/index.html">Moto fabriqu√©e en utilisant l'impression 3D SLS</a></li>
<li><a href="../fr485358/index.html">Le d√©veloppement mobile est-il facile et ennuyeux? Rapport Yandex</a></li>
<li><a href="../fr485362/index.html">Innovations JavaScript ES2020 avec des exemples simples</a></li>
<li><a href="../fr485364/index.html">Comment arr√™ter de perdre du temps aux d√©veloppeurs sur la dette technique</a></li>
<li><a href="../fr485370/index.html">Comment un d√©veloppeur peut-il aider un manager √† conclure un accord</a></li>
<li><a href="../fr485374/index.html">Le cache est le roi des performances: les processeurs ont-ils besoin d'un quatri√®me niveau de mise en cache</a></li>
<li><a href="../fr485376/index.html">Comment rendre le frontend trois fois plus rapide et quand appliquer des commandes au lieu de r√©f√©rentiels? Vid√©o</a></li>
<li><a href="../fr485378/index.html">√âtude de cas: comment √™tre pr√©sent√© sur Google Play et adapter ASO √† diff√©rents pays</a></li>
<li><a href="../fr485380/index.html">Succ√®s artisanal et informatique</a></li>
<li><a href="../fr485384/index.html">NeurIPS 2019: tendances ML qui nous accompagneront au cours de la prochaine d√©cennie</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>