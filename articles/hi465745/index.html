<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ЁЯСйЁЯП┐тАНЁЯдЭтАНЁЯСиЁЯП╗ ЁЯШБ ЁЯд╖ЁЯП╗ TensorFlow рдЯреНрдпреВрдЯреЛрд░рд┐рдпрд▓: 10 рдорд┐рдирдЯ TensorFlow рд╢реБрд░реБрдЖрдд рдЯреНрдпреВрдЯреЛрд░рд┐рдпрд▓ [рдЕрдиреБрд╡рд╛рдж] тЩея╕П тЮХ ЁЯУб</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="рдирдорд╕реНрдХрд╛рд░, рд╣реЗрдмреНрд░! рдореИрдВ рдЖрдкрдХреЗ рд▓рд┐рдП рдЕрдВрдХрд┐рдд рд╕рдЪрд╛рди рджреНрд╡рд╛рд░рд╛ "TensorFlow Tutorial: 10 рдорд┐рдирдЯ рдкреНрд░реИрдХреНрдЯрд┐рдХрд▓ рдЯреЗрдирд╕рдлрд╝реНрд▓реЛ рд╕рдмрдХ рдлреЙрд░ рдХреНрд╡рд┐рдХ рд▓рд░реНрдирд░реНрд╕" рд▓реЗрдЦ рдХрд╛ рдЕрдиреБрд╡рд╛рдж рдкреНрд░рд╕реНрддреБрдд рдХрд░рддрд╛ рд╣...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>TensorFlow рдЯреНрдпреВрдЯреЛрд░рд┐рдпрд▓: 10 рдорд┐рдирдЯ TensorFlow рд╢реБрд░реБрдЖрдд рдЯреНрдпреВрдЯреЛрд░рд┐рдпрд▓ [рдЕрдиреБрд╡рд╛рдж]</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/465745/"><p>  рдирдорд╕реНрдХрд╛рд░, рд╣реЗрдмреНрд░!  рдореИрдВ рдЖрдкрдХреЗ рд▓рд┐рдП рдЕрдВрдХрд┐рдд рд╕рдЪрд╛рди рджреНрд╡рд╛рд░рд╛ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">"TensorFlow Tutorial: 10 рдорд┐рдирдЯ рдкреНрд░реИрдХреНрдЯрд┐рдХрд▓ рдЯреЗрдирд╕рдлрд╝реНрд▓реЛ рд╕рдмрдХ рдлреЙрд░ рдХреНрд╡рд┐рдХ рд▓рд░реНрдирд░реНрд╕"</a> рд▓реЗрдЦ рдХрд╛ рдЕрдиреБрд╡рд╛рдж рдкреНрд░рд╕реНрддреБрдд рдХрд░рддрд╛ рд╣реВрдБред </p><br><p>  рдпрд╣ TensorFlow рдЯреНрдпреВрдЯреЛрд░рд┐рдпрд▓ рдорд╢реАрди рд╕реАрдЦрдиреЗ рдХреА рдмреБрдирд┐рдпрд╛рджреА рд╕рдордЭ рд░рдЦрдиреЗ рд╡рд╛рд▓реЗ рдХрд┐рд╕реА рднреА рд╡реНрдпрдХреНрддрд┐ рдХреЗ рд▓рд┐рдП рд╣реИ рдФрд░ TensorFlow рдХреЗ рд╕рд╛рде рд╢реБрд░реБрдЖрдд рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд░рд╣рд╛ рд╣реИред </p><a name="habracut"></a><br><p>  рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рдЖрдкрдХреЗ рдкрд╛рд╕ TensorFlow рд╕реНрдерд╛рдкрд┐рдд рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред  рдЖрдк рдЗрд╕реЗ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЗрд╕</a> рдЧрд╛рдЗрдб рдореЗрдВ рд╕реНрдерд╛рдкрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  рдЗрд╕ рдкрд╛рда рдХреЛ рджреЛ рднрд╛рдЧреЛрдВ рдореЗрдВ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ: рдкрд╣рд▓реЗ рднрд╛рдЧ рдореЗрдВ рд╣рдо рдПрдХ рдХрд╛рдо рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдЙрджрд╛рд╣рд░рдг рдХреЗ рд╕рд╛рде рдореВрд▓ рдмрд╛рддреЗрдВ рд╕рдордЭрд╛рддреЗ рд╣реИрдВ, рджреВрд╕рд░реЗ рднрд╛рдЧ рдореЗрдВ рд╣рдо рдПрдХ рд░реЗрдЦреАрдп рдкреНрд░рддрд┐рдЧрдорди рдореЙрдбрд▓ рдХрд╛ рдирд┐рд░реНрдорд╛рдг рдХрд░рддреЗ рд╣реИрдВред </p><br><h2 id="chast-1-osnovy-tensorflow">  рднрд╛рдЧ 1. рдЯреЗрдВрд╕реЛрд░рдлреНрд▓реЛ рдореВрд▓ рдмрд╛рддреЗрдВ </h2><br><p>  TensorFlow рдПрдХ рд╕рдВрдЦреНрдпрд╛рддреНрдордХ рдкреБрд╕реНрддрдХрд╛рд▓рдп рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдбреЗрдЯрд╛ рдПрдХ рдЧреНрд░рд╛рдл рд╕реЗ рдЧреБрдЬрд░рддрд╛ рд╣реИред  TensorFlow рдореЗрдВ рдбреЗрдЯрд╛ n- рдЖрдпрд╛рдореА рд╕рд░рдгрд┐рдпреЛрдВ рджреНрд╡рд╛рд░рд╛ рджрд░реНрд╢рд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ - рджрд╕рд┐рдпреЛрдВред  рдЧреНрд░рд╛рдл рдбреЗрдЯрд╛ (рджрд╕рд┐рдпреЛрдВ) рдФрд░ рдЧрдгрд┐рддреАрдп рдХрд╛рд░реНрдпреЛрдВ рд╕реЗ рдмрдирд╛ рд╣реИред </p><br><p>  рдЧреНрд░рд╛рдл рдХреЗ рдиреЛрдбреНрд╕ рдореЗрдВ рдЧрдгрд┐рддреАрдп рд╕рдВрдХреНрд░рд┐рдпрд╛рдПрдВ рд╣реИрдВред </p><br><p>  рдЧреНрд░рд╛рдлрд╝ рдХреЗ рдХрд┐рдирд╛рд░реЗ рджрд╕рд┐рдпреЛрдВ рдХрд╛ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдХрд░рддреЗ рд╣реИрдВ рдЬреЛ рд╕рдВрдЪрд╛рд▓рди рдХреЗ рдмреАрдЪ "рдкреНрд░рд╡рд╛рд╣" рдХрд░рддреЗ рд╣реИрдВред </p><br><p>  рдПрдХ рдФрд░ рдкрд╣рд▓реВ рд╣реИ рдЬрд┐рд╕рдореЗрдВ TensorFlow рдХрд┐рд╕реА рднреА рдЕрдиреНрдп рдкреНрд░реЛрдЧреНрд░рд╛рдорд┐рдВрдЧ рднрд╛рд╖рд╛ рд╕реЗ рдмрд╣реБрдд рдЕрд▓рдЧ рд╣реИред  TensorFlow рдореЗрдВ, рдЖрдкрдХреЛ рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ рдПрдХ рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдмрдирд╛рдиреЗ рдХреА рдЬрд░реВрд░рдд рд╣реИ рдЬреЛ рдЖрдк рдмрдирд╛рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВред  рдкреНрд░рд╛рд░рдВрдн рдореЗрдВ, рдЧреНрд░рд╛рдлрд╝ рдмрдирд╛рддреЗ рд╕рдордп, рдЪрд░ рдХрд╛ рдХреЛрдИ рдЕрд░реНрде рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИред  рдмрд╛рдж рдореЗрдВ, рдЬрдм рдЖрдкрдиреЗ рдПрдХ рдкреВрд░реНрдг рдЧреНрд░рд╛рдлрд╝ рдмрдирд╛рдпрд╛, рддреЛ рдЖрдк рдЗрд╕реЗ рдПрдХ рд╕рддреНрд░ рдореЗрдВ рдЪрд▓рд╛рддреЗ рд╣реИрдВ рдФрд░ рдЙрд╕рдХреЗ рдмрд╛рдж рд╣реА рдЪрд░ рдХрд┐рд╕реА рднреА рдорд╛рди рдкрд░ рдЪрд▓реЗрдВрдЧреЗред </p><br><p>  рдЪрд▓реЛ рдХрд░рдХреЗ рд╕реАрдЦрдирд╛ рд╢реБрд░реВ рдХрд░рддреЗ рд╣реИрдВред  рдЕрдЬрдЧрд░ рдЪрд▓рд╛рдПрдБ рдФрд░ TensorFlow рдЖрдпрд╛рдд рдХрд░реЗрдВ: </p><br><pre><code class="python hljs">~$ python Python <span class="hljs-number"><span class="hljs-number">2.7</span></span><span class="hljs-number"><span class="hljs-number">.6</span></span> (default, Oct <span class="hljs-number"><span class="hljs-number">26</span></span> <span class="hljs-number"><span class="hljs-number">2016</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>:<span class="hljs-number"><span class="hljs-number">30</span></span>:<span class="hljs-number"><span class="hljs-number">19</span></span>) [GCC <span class="hljs-number"><span class="hljs-number">4.8</span></span><span class="hljs-number"><span class="hljs-number">.4</span></span>] on linux2 Type <span class="hljs-string"><span class="hljs-string">"help"</span></span>, <span class="hljs-string"><span class="hljs-string">"copyright"</span></span>, <span class="hljs-string"><span class="hljs-string">"credits"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> <span class="hljs-string"><span class="hljs-string">"license"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> more information. &gt;&gt;&gt; &gt;&gt;&gt;<span class="hljs-keyword"><span class="hljs-keyword">import</span></span> tensorflow <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> tf</code> </pre> <br><p>  рдПрдХ рдЧреНрд░рд╛рдл рдХрд╛ рдЙрдкрдпреЛрдЧ рдСрдкрд░реЗрд╢рдиреЛрдВ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдФрд░ рд╕рднреА рдСрдкрд░реЗрд╢рди рдПрдХ рд╕рддреНрд░ рдореЗрдВ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВред  рдЧреНрд░рд╛рдл рдФрд░ рд╕рддреНрд░ рдПрдХ-рджреВрд╕рд░реЗ рд╕реЗ рд╕реНрд╡рддрдВрддреНрд░ рд░реВрдк рд╕реЗ рдмрдирд╛рдП рдЬрд╛рддреЗ рд╣реИрдВред  рдПрдХ рдирд┐рд░реНрдорд╛рдг рдкрд░рд┐рдпреЛрдЬрдирд╛ рдХреЗ рд░реВрдк рдореЗрдВ рдЧреНрд░рд╛рдл рдФрд░ рдПрдХ рдирд┐рд░реНрдорд╛рдг рд╕реНрдерд▓ рдХреЗ рд░реВрдк рдореЗрдВ рд╕рддреНрд░ рдХреЛ рд╕рдордЭреЛред </p><br><h4 id="11-grafy-v-tensorflow">  1.1ред  TensorFlow рдореЗрдВ рд░реЗрдЦрд╛рдВрдХрди </h4><br><p>  рдПрдХ рдЧреНрд░рд╛рдл TensorFlow рдХрд╛ рдЖрдзрд╛рд░ рд╣реИ, рд╕рднреА рдЧрдгрдирд╛ (рд╕рдВрдЪрд╛рд▓рди), рдЪрд░ рдЧреНрд░рд╛рдл рдкрд░ рд╣реИрдВред  рдХреЛрдб рдореЗрдВ рдЬреЛ рдХреБрдЫ рднреА рд╣реЛрддрд╛ рд╣реИ рд╡рд╣ TensorFlow рджреНрд╡рд╛рд░рд╛ рдкреНрд░рджрд╛рди рдХрд┐рдП рдЧрдП рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдЧреНрд░рд╛рдлрд╝ рдкрд░ рд╣реЛрддрд╛ рд╣реИред  рдЖрдк рдЗрд╕ рдЧреНрд░рд╛рдл рдХреЛ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдПрдХреНрд╕реЗрд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: </p><br><pre> <code class="python hljs">graph = tf.get_default_graph()</code> </pre> <br><p>  рдФрд░ рдЗрд╕рд▓рд┐рдП рдЖрдк рдЗрд╕ рдХреЙрд▓рдо рдореЗрдВ рд╕рднреА рдСрдкрд░реЗрд╢рдиреЛрдВ рдХреА рд╕реВрдЪреА рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: </p><br><pre> <code class="python hljs">graph.get_operations()</code> </pre> <br><p>  рдЖрдкрдХрд╛ рдЧреНрд░рд╛рдл рдЕрдм рдЦрд╛рд▓реА рд╣реИред  рдпрджрд┐ рдЖрдкрдХреЛ рдкреНрд░рддреНрдпреЗрдХ рдСрдкрд░реЗрд╢рди рдХрд╛ рдирд╛рдо рдкреНрд░рд┐рдВрдЯ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рддреЛ рдирд┐рдореНрди рдХреЛрдб рдЪрд▓рд╛рдПрдБ: </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> op <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> graph.get_operations(): print(op.name)</code> </pre> <br><p>  рдЖрдЙрдЯрдкреБрдЯ рдлрд┐рд░ рд╕реЗ рд░рд┐рдХреНрдд рд╣реЛ рдЬрд╛рдПрдЧрд╛ред  рднрд╡рд┐рд╖реНрдп рдореЗрдВ, рдЧреНрд░рд╛рдлрд╝ рдореЗрдВ рд╕рдВрдЪрд╛рд▓рди рдЬреЛрдбрд╝рдиреЗ рдХреЗ рдмрд╛рдж, рд╣рдо рдЙрдирдХреЗ рдирд╛рдо рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕ рдХреЛрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗред </p><br><h4 id="12-sessii-v-tensorflow">  1.2ред  TensorFlow рдореЗрдВ рд╕рддреНрд░ </h4><br><p>  рдЧреНрд░рд╛рдл рдХреЗрд╡рд▓ рдЧрдгрдирд╛ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддрд╛ рд╣реИ (рдкрд░рд┐рдпреЛрдЬрдирд╛ рдмрдирд╛рддрд╛ рд╣реИ), рд▓реЗрдХрд┐рди рдХреЛрдИ рдЪрд░, рдХреЛрдИ рдореВрд▓реНрдп рдирд╣реАрдВ рд╣реИ, рдЬрдм рддрдХ рдХрд┐ рд╣рдо рд╕рддреНрд░ рдореЗрдВ рдЧреНрд░рд╛рдл рдпрд╛ рдЧреНрд░рд╛рдл рдХреЗ рд╣рд┐рд╕реНрд╕реЗ рдХреЛ рдирд╣реАрдВ рдЪрд▓рд╛рддреЗ рд╣реИрдВред </p><br><p>  рдЖрдк рдЗрд╕ рддрд░рд╣ рдПрдХ рд╕рддреНрд░ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ: </p><br><pre> <code class="python hljs">sess=tf.Session() ... your code ... ... your code ... sess.close()</code> </pre> <br><p>  рдпрд╣ рдордд рднреВрд▓реЛ рдХрд┐ рдПрдХ рд╕рддреНрд░ рд╢реБрд░реВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЛ рдЗрд╕реЗ рд╕рдорд╛рдкреНрдд рдХрд░рдиреЗ рдпрд╛ рдЗрд╕рдХреЗ <strong>рд╕рд╛рде</strong> рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ <strong>...</strong> рдмреНрд▓реЙрдХ рдХреЗ <strong>рд░реВрдк рдореЗрдВ</strong> , рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП рдЗрд╕ рддрд░рд╣: </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">with</span></span> tf.Session() <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> sess: sess.run(f)</code> </pre> <br><p>  рдЗрд╕ рджреГрд╖реНрдЯрд┐рдХреЛрдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХрд╛ рд▓рд╛рдн рдпрд╣ рд╣реИ рдХрд┐ рд╕рддреНрд░ рдХреЛ рдмреНрд▓реЙрдХ рдХреЗ рдЕрдВрдд рдореЗрдВ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдмрдВрдж рдХрд░ рджрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ </p><br><h4 id="13-tenzory-v-tensorflow">  1.3ред  TensorFlow рдореЗрдВ рд╕реЗрдВрд╕рд░ </h4><br><p>  TensorFlow рдбреЗрдЯрд╛ рдХреЛ рджрд╕рд┐рдпреЛрдВ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рддрд╛ рд╣реИ - рдмрд╣реБрдЖрдпрд╛рдореА рд╕рд░рдгрд┐рдпреЛрдВ рдХреЛ numPy рд╕рд░рдгрд┐рдпреЛрдВ рдХреЗ рд╕рдорд╛рдиред </p><br><p>  a) <strong>рд▓рдЧрд╛рддрд╛рд░</strong> рдРрд╕реЗ рдорд╛рди рд╣реИрдВ рдЬрд┐рдиреНрд╣реЗрдВ рдмрджрд▓рд╛ рдирд╣реАрдВ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред  рдЙрдиреНрд╣реЗрдВ рдирд┐рдореНрдирд╛рдиреБрд╕рд╛рд░ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ: </p><br><pre> <code class="python hljs">a=tf.constant(<span class="hljs-number"><span class="hljs-number">1.0</span></span>)</code> </pre> <br><p>  рд╣рд╛рд▓рд╛рдБрдХрд┐, рдЬрдм рдЖрдк рдЖрдЙрдЯрдкреБрдЯ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдЖрдкрдХреЛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдорд┐рд▓рддреЗ рд╣реИрдВ: </p><br><pre> <code class="python hljs">print(a) &lt;tf.Tenso<span class="hljs-string"><span class="hljs-string">r'Const:0'</span></span> shape=() dtype=float32&gt; print(a) Tensor(<span class="hljs-string"><span class="hljs-string">"Const:0"</span></span>, shape=(), dtype=float32)</code> </pre> <br><p>  рдЬреИрд╕рд╛ рдХрд┐ рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ, рдпрд╣ рдЕрдиреНрдп рдкреНрд░реЛрдЧреНрд░рд╛рдорд┐рдВрдЧ рднрд╛рд╖рд╛рдУрдВ рд╕реЗ рдЕрд▓рдЧ рд╣реИ, рдЬреИрд╕реЗ рдХрд┐ рдЕрдЬрдЧрд░ред  рдЬрдм рддрдХ рдЖрдк рд╕рддреНрд░ рд╢реБрд░реВ рдирд╣реАрдВ рдХрд░рддреЗ рддрдм рдЖрдк рдирд┐рд░рдВрддрд░ рдкреНрд░рд┐рдВрдЯ рдпрд╛ рдПрдХреНрд╕реЗрд╕ рдирд╣реАрдВ рдХрд░ рд╕рдХрддреЗред  рдРрд╕рд╛ рдХрд░рддреЗ рд╣реИрдВ: </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">with</span></span> tf.Session() <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> sess: print(sess.run(a))</code> </pre> <br><p>  рдпрд╣ рдХреЛрдб 1.0 рдЖрдЙрдЯрдкреБрдЯ рдХрд░реЗрдЧрд╛ </p><br><p>  рдЦ) <strong>рдЪрд░</strong> рднреА рджрд╕рд┐рдпреЛрдВ рд╣реИрдВ рдЬреЛ рдЕрдиреНрдп рдкреНрд░реЛрдЧреНрд░рд╛рдорд┐рдВрдЧ рднрд╛рд╖рд╛рдУрдВ рдореЗрдВ рдЪрд░ рдХреА рддрд░рд╣ рд╣реИрдВ: </p><br><pre> <code class="python hljs">&gt;&gt;&gt;b = tf.Variable(<span class="hljs-number"><span class="hljs-number">2.0</span></span>,name=<span class="hljs-string"><span class="hljs-string">"test_var"</span></span>) &gt;&gt;&gt;b &lt;tensorflow.python.ops.variables.Variable object at <span class="hljs-number"><span class="hljs-number">0x7f37ebda1990</span></span>&gt;</code> </pre> <br><p>  рд╕реНрдерд┐рд░рд╛рдВрдХ рдХреЗ рд╡рд┐рдкрд░реАрдд, рдЪрд░ рдЕрдкрдиреА рд╕рд╛рдордЧреНрд░реА рдХреЛ рдмрджрд▓ рд╕рдХрддреЗ рд╣реИрдВред  рд╣рд╛рд▓рд╛рдБрдХрд┐, TensorFlow рдореЗрдВ рд╡реИрд░рд┐рдПрдмрд▓ рдХреЛ рдПрдХ рдЕрд▓рдЧ рдЗрдирд┐рд╢рд┐рдпрд▓рд╛рдЗрдЬрд╝реЗрд╢рди рдСрдкрд░реЗрд╢рди рдореЗрдВ рдЖрд░рдВрднреАрдХреГрдд рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред  рд╕рднреА рд╡реЗрд░рд┐рдПрдмрд▓реНрд╕ рдХреЛ рдЗрдирд┐рд╢рд┐рдпрд▓рд╛рдЗрдЬрд╝ рдХрд░рдиреЗ рдореЗрдВ рдХрд╛рдлреА рд╕рдордп рд▓рдЧ рд╕рдХрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди TensorFlow рд╕рднреА рд╡реЗрд░рд┐рдПрдмрд▓реНрд╕ рдХреЛ рдПрдХ рд╕рд╛рде рд╢реБрд░реВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рддрдВрддреНрд░ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ: </p><br><pre> <code class="python hljs">init_op = tf.global_variables_initializer()</code> </pre> <br><p>  рдЪрд░ рдХреЛ рдПрдХреНрд╕реЗрд╕ рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдЕрдм рдЖрдкрдХреЛ рдЗрдирд┐рд╢рд┐рдпрд▓рд╛рдЗрдЬрд╝реЗрд╢рди рдСрдкрд░реЗрд╢рди рд╢реБрд░реВ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ: </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">with</span></span> tf.Session() <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> sess: sess.run(init_op) print(sess.run(b))</code> </pre> <br><p>  рдпрд╣ рдХреЛрдб 2.0 рдЖрдЙрдЯрдкреБрдЯ рдХрд░реЗрдЧрд╛ <br>  рдпрджрд┐ рдЖрдк рдЕрдм рдЧреНрд░рд╛рдлрд╝ рдореЗрдВ рдСрдкрд░реЗрд╢рди рдкреНрд░рд┐рдВрдЯ рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рддреЗ рд╣реИрдВ </p><br><pre> <code class="python hljs">graph = tf.get_default_graph() <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> op <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> graph.get_operations(): print(op.name)</code> </pre> <br><p>  рдЖрдкрдХреЛ рдирд┐рдореНрди рдЖрдЙрдЯрдкреБрдЯ рдорд┐рд▓реЗрдЧрд╛: </p><br><pre> <code class="plaintext hljs">Const test_var/initial_value test_var test_var/Assign test_var/read init</code> </pre> <br><p>  рдЬреИрд╕рд╛ рдХрд┐ рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ, рд╣рдордиреЗ "рдП" рдХреЛ рдХрд╛рд╕реНрдЯ рдШреЛрд╖рд┐рдд рдХрд┐рдпрд╛ рдФрд░ рдЗрд╕реЗ рдЪрд╛рд░реНрдЯ рдореЗрдВ рдЬреЛрдбрд╝рд╛ рдЧрдпрд╛ред  рдЗрд╕реА рддрд░рд╣, рд╡реЗрд░рд┐рдПрдмрд▓ b рдХреЗ рд▓рд┐рдП, рдХрдИ test_var рд░рд╛рдЬреНрдпреЛрдВ рдХреЛ TensorFlow рдЧреНрд░рд╛рдл рдореЗрдВ рдЬреЛрдбрд╝рд╛ рдЧрдпрд╛, рдЬреИрд╕реЗ test_var / initial_value, test_var / read, рдЖрджрд┐ред рдЖрдк TensorBoard рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреВрд░реЗ рдиреЗрдЯрд╡рд░реНрдХ рдХреА рдХрд▓реНрдкрдирд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЬреЛ TensorFlow рдЧреНрд░рд╛рдл рдФрд░ рд╕реАрдЦрдиреЗ рдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рд╕рдордЭрдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЙрдкрдХрд░рдг рд╣реИред ред </p><br><p>  рдЧ) <strong>рдкреНрд▓реЗрд╕рд╣реЛрд▓реНрдбрд░</strong> рдбреЗрдЯрд╛ рдХреЗ рд╕рд╛рде рдЖрд░рдВрдн рд╣реЛрдиреЗ рдХреА рдкреНрд░рддреАрдХреНрд╖рд╛ рдХрд░ рд░рд╣реЗ рд╣реИрдВред  рд╡реЗ рдбреЗрдЯрд╛ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ рдЬреЛ рдХреЗрд╡рд▓ рддрдм рдкреНрд░рджрд╛рди рдХрд┐рдП рдЬрд╛рдПрдВрдЧреЗ рдЬрдм рдХреЛрдб рдХреЛ рд╕рддреНрд░ рдореЗрдВ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рдкреНрд▓реЗрд╕рд╣реЛрд▓реНрдбрд░ рдХреЛ рд╣рд╕реНрддрд╛рдВрддрд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдиреЗ рд╡рд╛рд▓рд╛ рдПрдХ рд╢рдмреНрджрдХреЛрд╖ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдкреНрд▓реЗрд╕рд╣реЛрд▓реНрдбрд░реНрд╕ рдХреЗ рдирд╛рдо рдФрд░ рдЙрдирдХреЗ рдЕрд░реНрде рд╢рд╛рдорд┐рд▓ рд╣реИрдВ: </p><br><pre> <code class="python hljs">a = tf.placeholder(<span class="hljs-string"><span class="hljs-string">"float"</span></span>) b = tf.placeholder(<span class="hljs-string"><span class="hljs-string">"float"</span></span>) y = tf.multiply(a, b) fd = {a: <span class="hljs-number"><span class="hljs-number">2</span></span>, b: <span class="hljs-number"><span class="hljs-number">3</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> tf.Session() <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> sess: print(sess.run(y, fd))</code> </pre> <br><p>  рдпрд╣ рдХреЛрдб 6.0 рдЖрдЙрдЯрдкреБрдЯ рдХрд░реЗрдЧрд╛ </p><br><h4 id="14-ustroystva-v-tensorflow">  1.4ред  TensorFlow рдореЗрдВ рдЙрдкрдХрд░рдг </h4><br><p>  TensorFlow рдореЗрдВ GPU, CPU рдпрд╛ рдХреНрд▓рд╕реНрдЯрд░ рдкрд░ рдЕрдкрдирд╛ рдХреЛрдб рдЪрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдмрд╣реБрдд рд╢рдХреНрддрд┐рд╢рд╛рд▓реА рдЕрдВрддрд░реНрдирд┐рд╣рд┐рдд рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдВ рд╣реИрдВред  рдпрд╣ рдЖрдкрдХреЛ рдЙрд╕ рдбрд┐рд╡рд╛рдЗрд╕ рдХреЛ рдЪреБрдирдиреЗ рдХрд╛ рдЕрд╡рд╕рд░ рджреЗрддрд╛ рд╣реИ рдЬрд┐рд╕ рдкрд░ рдЖрдк рдЕрдкрдирд╛ рдХреЛрдб рдЪрд▓рд╛рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВред  рд╣рд╛рд▓рд╛рдБрдХрд┐, рдпрд╣ рд╕реЛрдЪрдиреЗ рд╡рд╛рд▓реА рдмрд╛рдд рдирд╣реАрдВ рд╣реИ рдХрд┐ рдЖрдк рдЯреАрдПрдл рдХреЗ рд╕рд╛рде рд╢реБрд░реБрдЖрдд рдХрдм рдХрд░ рд░рд╣реЗ рд╣реИрдВред <br>  рддреЛ рдпрд╣рд╛рдБ рдПрдХ рдкреВрд░реА рддрд╕реНрд╡реАрд░ рд╣реИ рдХрд┐ TensorFlow рдореЗрдВ рдЧрдгрдирд╛ рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддреА рд╣реИ: <br><img src="https://habrastorage.org/getpro/habr/post_images/766/e0f/632/766e0f632420b671d966449d12a79b0a.webp" alt="рдЫрд╡рд┐"></p><br><h2 id="chast-2-tutorial-po-tensorflow-s-prostym-primerom">  рднрд╛рдЧ 2. TensorFlow рдЯреНрдпреВрдЯреЛрд░рд┐рдпрд▓ рдПрдХ рд╕рд░рд▓ рдЙрджрд╛рд╣рд░рдг рдХреЗ рд╕рд╛рде </h2><br><p>  рдЗрд╕ рднрд╛рдЧ рдореЗрдВ, рд╣рдо рд░реИрдЦрд┐рдХ рдкреНрд░рддрд┐рдЧрдорди рдХреЛ рдЪрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХреЛрдб рдХреЛ рджреЗрдЦреЗрдВрдЧреЗред  рдЗрд╕рд╕реЗ рдкрд╣рд▓реЗ, рдЖрдЗрдП рдХреБрдЫ рдмреБрдирд┐рдпрд╛рджреА TensorFlow рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рджреЗрдЦреЗрдВ рдЬрд┐рдиреНрд╣реЗрдВ рд╣рдо рдХреЛрдб рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗред </p><br><p>  рдПрдХ рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рд╕рд╛рдорд╛рдиреНрдп рд╡рд┐рддрд░рдг рдмрдирд╛рдирд╛: </p><br><p>  рд╕рд╛рдорд╛рдиреНрдп рд╡рд┐рддрд░рдг рд╕реЗ рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рдорд╛рди рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП <strong>random_normal</strong> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред  рдЗрд╕ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ, w 0.01 рдХреЗ рдорд╛рдирдХ рд╡рд┐рдЪрд▓рди рдХреЗ рд╕рд╛рде рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рдореВрд▓реНрдпреЛрдВ рдХреЗ рд╕рд╛рде 784 * 10 рдЖрдпрд╛рдо рдХрд╛ рдПрдХ рдЪрд░ рд╣реИред </p><br><pre> <code class="python hljs">w=tf.Variable(tf.random_normal([<span class="hljs-number"><span class="hljs-number">784</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>], stddev=<span class="hljs-number"><span class="hljs-number">0.01</span></span>))</code> </pre> <br><p>  <strong>Reduce_mean</strong> - рдХрд┐рд╕реА рд╕рд░рдгреА <strong>рдХреЗ</strong> рдФрд╕рдд рдорд╛рди рдХреА <strong>рдЧрдгрдирд╛ рдХрд░рддрд╛ рд╣реИ</strong> </p><br><pre> <code class="python hljs">b = tf.Variable([<span class="hljs-number"><span class="hljs-number">10</span></span>,<span class="hljs-number"><span class="hljs-number">20</span></span>,<span class="hljs-number"><span class="hljs-number">30</span></span>,<span class="hljs-number"><span class="hljs-number">40</span></span>,<span class="hljs-number"><span class="hljs-number">50</span></span>,<span class="hljs-number"><span class="hljs-number">60</span></span>],name=<span class="hljs-string"><span class="hljs-string">'t'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> tf.Session() <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> sess: sess.run(tf.initialize_all_variables()) sess.run(tf.reduce_mean(b))</code> </pre> <br><p>  рдпрд╣ рдХреЛрдб 35 рдЖрдЙрдЯрдкреБрдЯ рдХрд░реЗрдЧрд╛ </p><br><p>  <strong>argmax</strong> - рдкрд╛рдпрдерди рдореЗрдВ argmax рдХреЗ рд╕рдорд╛рдиред  рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдЕрдХреНрд╖ рдХреЗ рд╕рд╛рде рдЯреЗрдВрд╕рд░ рд╕реЗ рдЕрдзрд┐рдХрддрдо рдореВрд▓реНрдп рдкреНрд░рд╛рдкреНрдд рдХрд░рддрд╛ рд╣реИред </p><br><pre> <code class="python hljs">a=[ [<span class="hljs-number"><span class="hljs-number">0.1</span></span>, <span class="hljs-number"><span class="hljs-number">0.2</span></span>, <span class="hljs-number"><span class="hljs-number">0.3</span></span> ], [<span class="hljs-number"><span class="hljs-number">20</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span> ] ] b = tf.Variable(a,name=<span class="hljs-string"><span class="hljs-string">'b'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> tf.Session() <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> sess: sess.run(tf.initialize_all_variables()) sess.run(tf.argmax(b,<span class="hljs-number"><span class="hljs-number">1</span></span>))</code> </pre> <br><p>  рдПрдХ рд╕рд░рдгреА ([2, 0]) рдкреНрд░рд┐рдВрдЯ рдХрд░реЗрдВ рдЬреЛ рдкреНрд░рддреНрдпреЗрдХ рдкрдВрдХреНрддрд┐ рдореЗрдВ рдЕрдзрд┐рдХрддрдо рдорд╛рди рдХрд╛ рд╕реВрдЪрдХрд╛рдВрдХ рджрд┐рдЦрд╛рддрд╛ рд╣реИред </p><br><h4 id="zadacha-lineynoy-regressii">  рд░реИрдЦрд┐рдХ рдкреНрд░рддрд┐рдЧрдорди рд╕рдорд╕реНрдпрд╛ </h4><br><p>  рд╕рдорд╕реНрдпрд╛ рдХрдерди: рдмрдбрд╝реА рд╕рдВрдЦреНрдпрд╛ рдореЗрдВ рдбреЗрдЯрд╛ рдмрд┐рдВрджреБ рд╣реИрдВ, рдЬреЛ рдЙрдирдХреЗ рд╕рд╛рде рдПрдХ рд╕реАрдзреА рд░реЗрдЦрд╛ рд╕реЗ рдореЗрд▓ рдЦрд╛рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд░рд╣реЗ рд╣реИрдВред  рдЗрд╕ рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рд╣рдо 100 рдбреЗрдЯрд╛ рдкреЙрдЗрдВрдЯ рдмрдирд╛рдПрдВрдЧреЗ рдФрд░ рдЙрдирдХреЗ рд╕рд╛рде рд▓рд╛рдЗрди рдХрд╛ рдорд┐рд▓рд╛рди рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВрдЧреЗред </p><br><h4 id="21-sozdanie-trenirovochnogo-nabora-dannyh">  2.1ред  рдПрдХ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдбреЗрдЯрд╛рд╕реЗрдЯ рдмрдирд╛рдПрдВ </h4><br><p>  рдЯреНрд░реЗрдирдПрдХреНрд╕ рдореЗрдВ -1 рдФрд░ 1 рдХреЗ рдмреАрдЪ рдорд╛рди рд╣реЛрддреЗ рд╣реИрдВ, рдФрд░ рдЯреНрд░реЗрди рдореЗрдВ рдЯреНрд░реЗрдирдПрдХреНрд╕ рдХреЗ рдореВрд▓реНрдп рд╕реЗ 3 рдЧреБрдирд╛ рдЕрдзрд┐рдХ рдФрд░ рдХреБрдЫ рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рдЪрд░ рд╣реЛрддреЗ рд╣реИрдВ: </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> tensorflow <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> tf <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np trainX = np.linspace(<span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">101</span></span>) trainY = <span class="hljs-number"><span class="hljs-number">3</span></span> * trainX + np.random.randn(*trainX.shape) * <span class="hljs-number"><span class="hljs-number">0.33</span></span></code> </pre> <br><h4 id="22-pleysholdery">  2.2ред  рдкреНрд▓реЗрд╕рд╣реЛрд▓реНрдбрд░ </h4><br><pre> <code class="python hljs">X = tf.placeholder(<span class="hljs-string"><span class="hljs-string">"float"</span></span>) Y = tf.placeholder(<span class="hljs-string"><span class="hljs-string">"float"</span></span>)</code> </pre> <br><h4 id="23-modelirovanie">  2.3ред  рдореЛрдбрд▓рд┐рдВрдЧ </h4><br><p>  рд░реИрдЦрд┐рдХ рдкреНрд░рддрд┐рдЧрдорди рдореЙрдбрд▓ рдХрд╛ рд░реВрдк рд╣реИ </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1"><span class="MJXp-mrow" id="MJXp-Span-2"><span class="MJXp-mo" id="MJXp-Span-3" style="margin-left: 0.278em; margin-right: 0.278em;">рдп</span></span><span class="MJXp-mrow" id="MJXp-Span-4"><span class="MJXp-mo" id="MJXp-Span-5" style="margin-left: 0.278em; margin-right: 0.278em;">рдо</span></span><span class="MJXp-mrow" id="MJXp-Span-6"><span class="MJXp-mo" id="MJXp-Span-7" style="margin-left: 0.278em; margin-right: 0.278em;">реЛ</span></span><span class="MJXp-mrow" id="MJXp-Span-8"><span class="MJXp-mo" id="MJXp-Span-9" style="margin-left: 0.278em; margin-right: 0.278em;">рдб</span></span><span class="MJXp-mrow" id="MJXp-Span-10"><span class="MJXp-mo" id="MJXp-Span-11" style="margin-left: 0.278em; margin-right: 0.278em;">реЗ</span></span><span class="MJXp-mrow" id="MJXp-Span-12"><span class="MJXp-mo" id="MJXp-Span-13" style="margin-left: 0.278em; margin-right: 0.278em;">рд▓</span></span><span class="MJXp-mo" id="MJXp-Span-14" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-15">w</span><span class="MJXp-mo" id="MJXp-Span-16" style="margin-left: 0.267em; margin-right: 0.267em;">тИЧ</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-17">x</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="17.528ex" height="2.66ex" viewBox="0 -935.7 7546.9 1145.2" role="img" focusable="false" style="vertical-align: -0.487ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">рдп</text><g transform="translate(622,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">рдо</text></g><g transform="translate(1296,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">реЛ</text></g><g transform="translate(2049,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">рдб</text></g><g transform="translate(2724,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">реЗ</text></g><g transform="translate(3304,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">рд▓</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/465745/&amp;usg=ALkJrhieiTM-FVVcjgoD9GwUcaiBmyNjOw#MJMAIN-3D" x="4256" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/465745/&amp;usg=ALkJrhieiTM-FVVcjgoD9GwUcaiBmyNjOw#MJMATHI-77" x="5312" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/465745/&amp;usg=ALkJrhieiTM-FVVcjgoD9GwUcaiBmyNjOw#MJMAIN-2217" x="6251" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/465745/&amp;usg=ALkJrhieiTM-FVVcjgoD9GwUcaiBmyNjOw#MJMATHI-78" x="6974" y="0"></use></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-1"> рдпрдореЛрдбреЗрд▓ = w * x </script></p><br>  - рд╣рдореЗрдВ w рдХреЗ рдореВрд▓реНрдп рдХреА рдЧрдгрдирд╛ рдХрд░рдиреА рдЪрд╛рд╣рд┐рдПред  рдЖрдЗрдП w рдХреЛ рд╢реВрдиреНрдп рдХрд░реЗрдВ рдФрд░ рдЗрд╕ рд╕рдорд╕реНрдпрд╛ рдХреЛ рд╣рд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдореЙрдбрд▓ рдмрдирд╛рдПрдВред  рд╣рдо рд▓рд╛рдЧрдд рд╕рдорд╛рд░реЛрд╣ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддреЗ рд╣реИрдВ <p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-18"><span class="noError" id="MJXp-Span-19" style="display: inline-block;">(Y-y__model)&nbsp;^&nbsp;2</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed"><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><span class="noError" style="display: inline-block;">(Y-y__model)&nbsp;^&nbsp;2</span></span></div><script type="math/tex;mode=display" id="MathJax-Element-2"> (Y-y__model) ^ 2 </script></p><br>  TensorFlow рдХрдИ рдСрдкреНрдЯрд┐рдорд╛рдЗрдЬрд╝рд░ рдХреЗ рд╕рд╛рде рдЖрддрд╛ рд╣реИ рдЬреЛ рдкреНрд░рддреНрдпреЗрдХ рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐ рдХреЗ рдмрд╛рдж рдЧреНрд░реЗрдбрд┐рдПрдВрдЯ рдХреА рдЧрдгрдирд╛ рдФрд░ рдЕрджреНрдпрддрди рдХрд░рддреЗ рд╣реИрдВ, рдирд┐рд░реНрджрд┐рд╖реНрдЯ рд▓рд╛рдЧрдд рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдХрдо рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рддреЗ рд╣реИрдВред  0.01 рдХреА рд╕реАрдЦрдиреЗ рдХреА рдЧрддрд┐ рд╕реЗ рд╣рдорд╛рд░реА рд▓рд╛рдЧрдд рдХреЛ рдХрдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣рдо GradientDescentOptimizer рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рд▓рд░реНрдирд┐рдВрдЧ рдСрдкрд░реЗрд╢рди рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рдиреЗ рдЬрд╛ рд░рд╣реЗ рд╣реИрдВред  рдлрд┐рд░ рд╣рдо рдЗрд╕ рд▓рд░реНрдирд┐рдВрдЧ рдСрдкрд░реЗрд╢рди рдХреЛ рд▓реВрдк рдореЗрдВ рдЪрд▓рд╛рддреЗ рд╣реИрдВред <br><pre> <code class="python hljs">w = tf.Variable(<span class="hljs-number"><span class="hljs-number">0.0</span></span>, name=<span class="hljs-string"><span class="hljs-string">"weights"</span></span>) y_model = tf.multiply(X, w) cost = (tf.pow(Y-y_model, <span class="hljs-number"><span class="hljs-number">2</span></span>)) train_op = tf.train.GradientDescentOptimizer(<span class="hljs-number"><span class="hljs-number">0.01</span></span>).minimize(cost)</code> </pre> <br><h4 id="24-obuchenie">  2.4ред  рдЯреНрд░реЗрдирд┐рдВрдЧ </h4><br><p>  рдЗрд╕ рдмрд┐рдВрджреБ рддрдХ, рд╣рдордиреЗ рдХреЗрд╡рд▓ рдПрдХ рдЧреНрд░рд╛рдл рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд┐рдпрд╛ рд╣реИред  рдХреЛрдИ рдЧрдгрдирд╛ рдирд╣реАрдВ рд╣реБрдИ рд╣реИ, TensorFlow рдЪрд░ рдореЗрдВ рд╕реЗ рдХреЛрдИ рднреА рдмрд╛рдд рдирд╣реАрдВ рд╣реИред  рдЗрд╕ рдЧреНрд░рд╛рдлрд╝ рдХреЛ рдЪрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ рдПрдХ рд╕рддреНрд░ рдмрдирд╛рдиреЗ рдФрд░ рдЗрд╕реЗ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред  рдЗрд╕рд╕реЗ рдкрд╣рд▓реЗ, рд╣рдореЗрдВ рд╕рднреА рдЪрд░ рдХреЗ рд▓рд┐рдП рдПрдХ рдЗрдирд┐рд╢рд┐рдпрд▓рд╛рдЗрдЬрд╝реЗрд╢рди рдСрдкрд░реЗрд╢рди рдмрдирд╛рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ: </p><br><pre> <code class="python hljs">init = tf.initialize_all_variables() <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> tf.Session() <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> sess: sess.run(init) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">100</span></span>): <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (x, y) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> zip(trainX, trainY): sess.run(train_op, feed_dict={X: x, Y: y}) print(sess.run(w))</code> </pre> <br><p>  рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдкрд╣рд▓реА рдмрд╛рдд рдпрд╣ рдереА рдХрд┐ <strong>рд╕рддреНрд░ .run () рдХреЗ</strong> рднреАрддрд░ <strong>init</strong> рдХреЛ рдХреЙрд▓ рдХрд░рдХреЗ рд╡реЗрд░рд┐рдПрдмрд▓реНрд╕ рдХреЛ рдЗрдирд┐рд╢рд┐рдпрд▓рд╛рдЗрдЬрд╝ рдХрд░рдирд╛ рдерд╛ред  рдмрд╛рдж рдореЗрдВ рд╣рдо рдЙрд╕реЗ <strong>feed_dict рдЦрд┐рд▓рд╛рдХрд░ train_op рдЪрд▓рд╛рддреЗ рд╣реИрдВ</strong> ред  рдЕрдВрдд рдореЗрдВ, рд╣рдо w (рдлрд┐рд░ рд╕реЗ sess.run ()) рдХреЗ рдорд╛рди рдХреЛ рдкреНрд░рд┐рдВрдЯ рдХрд░рддреЗ рд╣реИрдВ, рдЬреЛ рд▓рдЧрднрдЧ 3 рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред </p><br><h4 id="uprazhnenie">  рд╡реНрдпрд╛рдпрд╛рдо: </h4><br><p>  рдпрджрд┐ рдЖрдк рдЗрд╕ рдХреЛрдб рдХреЗ рдмрд╛рдж рдПрдХ рдирдпрд╛ рд╕рддреНрд░ рдмрдирд╛рддреЗ рд╣реИрдВ рдФрд░ w рдХреЛ рдкреНрд░рд┐рдВрдЯ рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдЖрдЙрдЯрдкреБрдЯ рдХреНрдпрд╛ рд╣реЛрдЧрд╛? </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">with</span></span> tf.Session() <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> sess: sess.run(init) print(sess.run(w))</code> </pre> <br><p>  рд╣рд╛рдВ, рдЖрдкрдиреЗ рд╕рд╣реА рддрд░реАрдХреЗ рд╕реЗ рд╕рдордЭрд╛, 0.0 рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред  рдЬреИрд╕реЗ рд╣реА рд╣рдордиреЗ рдкрд╣рд▓реЗ рдмрдирд╛рдП рдЧрдП рд╕рддреНрд░ рдХреЛ рдЫреЛрдбрд╝ рджрд┐рдпрд╛, рд╕рднреА рдСрдкрд░реЗрд╢рдиреЛрдВ рдХрд╛ рдЕрд╕реНрддрд┐рддреНрд╡ рд╕рдорд╛рдкреНрдд рд╣реЛ рдЧрдпрд╛ред </p><br><p>  рдореБрдЭреЗ рдЙрдореНрдореАрдж рд╣реИ рдХрд┐ рдпрд╣ рдЯреНрдпреВрдЯреЛрд░рд┐рдпрд▓ рдЖрдкрдХреЛ TensorFlow рдХреЗ рд╕рд╛рде рдПрдХ рддреНрд╡рд░рд┐рдд рд╢реБрд░реБрдЖрдд рджреЗрддрд╛ рд╣реИред  рдХреГрдкрдпрд╛ рдЯрд┐рдкреНрдкрдгреА рдореЗрдВ рдЕрдкрдиреЗ рд╕рд╡рд╛рд▓ рдкреВрдЫрдиреЗ рдХреЗ рд▓рд┐рдП рд╕реНрд╡рддрдВрддреНрд░ рдорд╣рд╕реВрд╕ рдХрд░реЗрдВред  рдкреВрд░рд╛ рдХреЛрдб <a href="">рдпрд╣рд╛рдВ</a> рдбрд╛рдЙрдирд▓реЛрдб рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ <a href="">рд╣реИ</a> ред </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/hi465745/">https://habr.com/ru/post/hi465745/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi465733/index.html">рдпрджрд┐ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рд╕рдбрд╝реЗ рд╣реБрдП рд╣реИрдВ рдФрд░ рдХреНрд▓рд╕реНрдЯрд░ рдПрдХ рдХрджреНрджреВ рдореЗрдВ рдмрджрд▓ рдЬрд╛рддрд╛ рд╣реИ рддреЛ рдХреНрдпрд╛ рдХрд░реЗрдВ?</a></li>
<li><a href="../hi465735/index.html">рдХрдВрдкреНрдпреВрдЯрд░реЛрдВ рдореЗрдВ рдкреИрд╕рд┐рд╡ рдХреВрд▓рд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдо MIC-7900 рдХреИрд╕реЗ рд╣реИ</a></li>
<li><a href="../hi465737/index.html">рд╕реБрдВрджрд░рдо рдЫрд▓рдиреА</a></li>
<li><a href="../hi465741/index.html">рдЧреБрд░реБрддреНрд╡рд╛рдХрд░реНрд╖рдг рддрд░рдВрдЧреЛрдВ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдореЗрдВ рдХреНрд╡рд╛рдВрдЯрдо рдЙрд▓рдЭрд╛рд╡ рдХреИрд╕реЗ рдорджрдж рдХрд░реЗрдЧрд╛</a></li>
<li><a href="../hi465743/index.html">рд░реИрдЦрд┐рдХ рдкреНрд░рддрд┐рдЧрдорди рдФрд░ рдЗрд╕рдХреА рдмрд╣рд╛рд▓реА рдХреЗ рд▓рд┐рдП рддрд░реАрдХреЗ</a></li>
<li><a href="../hi465747/index.html">Neuronomicsред рд╕реНрдЯрд╛рд░реНрдЯрдЕрдк рдХреЗ рд▓рд┐рдП рдЖрдЗрдбрд┐рдпрд╛ 2030</a></li>
<li><a href="../hi465749/index.html">рдЕрдЪреНрдЫрд╛ рдмреБрд░рд╛ рд╕рд╛рдХреНрд╖рд╛рддреНрдХрд╛рд░</a></li>
<li><a href="../hi465751/index.html">рдХрд╣рд╛рдирд┐рдпреЛрдВ рдХрд╛ рдЦреЗрд▓</a></li>
<li><a href="../hi465753/index.html">рдПрдордПрд╕ SQL тАЛтАЛрд╕рд░реНрд╡рд░ рдХреЗ рд╕реНрдХреАрдорд╛ рдФрд░ рдбреЗрдЯрд╛рдмреЗрд╕ рдбреЗрдЯрд╛ рдХреЛ рд╕рд┐рдВрдХреНрд░рдирд╛рдЗрдЬрд╝ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рддреБрд▓рдирд╛рдХрд░реНрддрд╛рдУрдВ рдХреА рддреБрд▓рдирд╛</a></li>
<li><a href="../hi465755/index.html">рдЕрдЧрд╕реНрдд рдорд╢реАрди рд▓рд░реНрдирд┐рдВрдЧ рдПрдВрдб рдЖрд░реНрдЯрд┐рдлрд┐рд╢рд┐рдпрд▓ рдЗрдВрдЯреЗрд▓рд┐рдЬреЗрдВрд╕ рдиреНрдпреВрдЬ рдбрд╛рдЗрдЬреЗрд╕реНрдЯ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>