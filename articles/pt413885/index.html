<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§ôüèΩ üéÖüèæ üèπ Avalia√ß√£o Cavium ThunderX2: O sonho do Arm Server se torna realidade (Parte 1, Introdu√ß√£o) üßëüèæ ‚òîÔ∏è ‚ìÇÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="H√° menos de dois anos, exploramos o primeiro servidor Arm SoC, que teoricamente poderia competir com o Intel Xeon E5s - Cavium ThunderX. O servidor So...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Avalia√ß√£o Cavium ThunderX2: O sonho do Arm Server se torna realidade (Parte 1, Introdu√ß√£o)</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ua-hosting/blog/413885/"> H√° menos de dois anos, exploramos o primeiro servidor Arm SoC, que teoricamente poderia competir com o Intel Xeon E5s - Cavium ThunderX.  O servidor SoC demonstrou tudo o que foi anunciado, no entanto, devido ao baixo desempenho de thread √∫nico e dificuldades em otimizar as caracter√≠sticas de energia, o SoC de 48 n√∫cleos foi atribu√≠do a nichos de mercado.  Como resultado, o primeiro servidor Cavium SoC nunca foi capaz de competir com o Xeon da Intel. <br><br><img src="https://habrastorage.org/webt/x6/z7/5j/x6z75jaf9myymohvcozvis4hahg.jpeg"><br><br>  Mas a Cavium n√£o desistiu por raz√µes √≥bvias: no momento, o mercado de servidores se tornou mais atraente do que nunca.  Os datacenters da gigante global Intel faturam cerca de 20 bilh√µes de d√≥lares (!) Por ano.  Al√©m disso, a rentabilidade √© de 50%.  Em termos de lucro e rotatividade, o mercado de servidores √© muitas vezes maior do que qualquer outro mercado de equipamentos.  Portanto, ap√≥s o lan√ßamento do ThunderX, a Cavium prometeu lan√ßar uma segunda itera√ß√£o: gerenciamento de energia aprimorado, desempenho aprimorado de thread √∫nico e ainda mais n√∫cleos (54). <br><a name="habracut"></a><br>  O que n√£o interessa √†s m√£os da Cavium √© que, se o usu√°rio precisar de um servidor, ele poder√° usar uma m√°quina Intel depurada e confi√°vel.  De fato, promessas altas da Arm, Calxeda, Broadcom, AppliedMicro nos √∫ltimos 5 anos permaneceram promissoras, causando uma onda s√©ria de ceticismo e desconfian√ßa e o surgimento do novo SoCs Arm Server. <br><br>  No entanto, a nova cria√ß√£o de um outsider Cavium merece aten√ß√£o.  V√°rias altera√ß√µes foram feitas, n√£o apenas a adi√ß√£o do n√∫mero "2" ao nome: a Cavium comprou o design Vulcan da Avago.  Vulcan √© um design de processador bastante ambicioso, originalmente desenvolvido pela equipe do servidor Arm SoC Broadcom, e tem um legado muito maior que o ThunderX original.  Al√©m disso, com base em sua experi√™ncia com o ThunderX, a Cavium conseguiu introduzir algumas melhorias microarquiteturais no design do Vulcan, melhorando seu desempenho e pot√™ncia. <br><br>  Como resultado, o ThunderX2 ‚Äúacabou‚Äù por ser um n√∫cleo mais elaborado do que a gera√ß√£o anterior.  O n√∫cleo ThunderX tinha um pipeline muito curto e dificilmente suportaria duas instru√ß√µes por ciclo, mas o n√∫cleo Vulcan foi projetado para 8 buscas e executando at√© 4 instru√ß√µes por ciclo.  E ainda mais: todos os 4 fluxos (SMT4) podem estar ativos ao mesmo tempo, fornecendo carregamento de back-end constante.  O novo ThunderX2 SoC32 possui 32 desses n√∫cleos com uma frequ√™ncia de at√© 2,5 GHz. <br><br><img src="https://habrastorage.org/webt/nt/nl/7a/ntnl7apffv6jkwh6k1v_aoqptae.png"><br><br>  Com at√© 128 threads e pelo menos oito controladores DDR4, essa CPU deve ter um bom desempenho em todas as cargas de servidor.  Em outras palavras, diferentemente do ThunderX (1), o ThunderX2 √© o primeiro processador de servidor Arm e tem todas as chances de abalar a balan√ßa no mercado de servidores. <br><br><h2>  Quem tem mais: especifica√ß√µes </h2><br>  Trinta e dois n√∫cleos altos de IPC em um pacote parecem promissores.  Mas como √© o novo ThunderX2 em compara√ß√£o com os produtos AMD, Qualcomm e Intel?  Na tabela abaixo, comparamos as especifica√ß√µes de v√°rios SKUs de servidor de ponta. <br><br><img src="https://habrastorage.org/webt/p3/hv/fx/p3hvfxp0iatr1ockmnjx9xm8xp8.png"><br><br>  Os leitores informados notar√£o imediatamente que o topo da linha de processadores Intel √© o Xeon Platinum 8180. No entanto, esse SKU com 205 W TDP e um pre√ßo superior a US $ 10.000 geralmente n√£o √© compar√°vel a qualquer processador da lista.  J√° cruzamos quase a linha da raz√£o, incluindo 8176, que, como nos parece, se enquadra nessa lista de acordo com os par√¢metros do SKU m√°ximo dos blocos de kernel / thread.  De fato, o Cavium posiciona o Cavium 9980 como "compar√°vel" ao Xeon Platinum 8164 (e a Intel desempenha esse papel 8176), mas com frequ√™ncias um pouco mais baixas. <br><br>  No entanto, em termos de desempenho do d√≥lar, a Cavium compara seu carro-chefe 9980 com o Intel Xeon Gold 6148 e, nesse caso, o pre√ßo do processador Cavium parece bastante apetitoso.  De acordo com os resultados do teste, o ThunderX2 mais r√°pido est√° 30-40% √† frente do Xeon 6148, enquanto a oferta da Cavium √© US $ 1.300 mais barata.  Pre√ßos t√£o agressivos explicam os rumores de que a Qualcomm n√£o entrar√° no mercado de servidores. <br><br>  Os dados da tabela acima mostram diferen√ßas importantes entre os rivais.  A Intel parece ter a topologia principal mais avan√ßada e a maior velocidade turbo.  A Qualcomm, entretanto, parece mais atraente quando se trata de desempenho por watt. <br><br><img src="https://habrastorage.org/webt/no/2u/7-/no2u7-_oyjv6ol2vd6vqiartfks.png"><br><br>  Como o EPYC da AMD, o ThunderX2 da Cavium provavelmente brilhar√° no mercado de computa√ß√£o de alto desempenho (taxa de transfer√™ncia 33% maior, n√∫cleos / threads mais altos).  Como no design da AMD, o cache EPYC L3 √© lento se voc√™ precisar de dados que n√£o est√£o no slot de cache local de 8 MB.  O ThunderX2 √© muito mais complexo - com uma arquitetura de anel duplo semelhante √† arquitetura de anel Xeon v4 (Broadwell-EP).  De acordo com informa√ß√µes da Cavium, sua arquitetura sem bloqueio de anel √© capaz de fornecer taxas de transfer√™ncia de at√© 6 TB / s. <br><br>  Essa arquitetura de anel √© conectada √† interconex√£o coerente de processadores da Cavium (CCPI2 - na parte superior da figura), que opera a uma velocidade de 600 Gbit / s.  Essa conex√£o conecta dois n√≥s de soquete / NUMA.  56 pistas do PCIe 3.0 SoC est√£o conectadas ao anel, que a Cavium localizou entre os 14 controladores PCIe.  Esses 14 controladores podem, por sua vez, se ramificar para x4 ou x1, como mostrado abaixo. <br><br><img src="https://habrastorage.org/webt/yw/e3/r8/ywe3r8nlwh9n0sjcobksmoeqf58.png"><br><br>  Al√©m disso, ele suporta SR-IOV, que √© t√£o importante para a virtualiza√ß√£o de E / S (Xen e KVM). <br><br><h2>  ThunderX: do f√°cil ao complexo </h2><br>  <b>Briefing breve.</b>  O ThunderX original era uma vers√£o aprimorada do Octeon III: uma CPU com a capacidade de executar simultaneamente duas instru√ß√µes (n√∫cleo de emiss√£o dupla) com dois pipelines curtos. <br><br><img src="https://habrastorage.org/webt/s_/vu/na/s_vunadz47iappsidwdpeuyjmhw.png"><br><br>  Uma vantagem do design original do ThunderX √© sua alta efici√™ncia energ√©tica, especialmente para cargas de trabalho com baixo ILP (paralelismo no n√≠vel de instru√ß√£o).  Obviamente, um transportador t√£o curto apresenta s√©rias limita√ß√µes para aumentar a frequ√™ncia do rel√≥gio, e um design de projeto simples garante baixo desempenho de rosca √∫nica com cargas ILP m√©dias e altas, enquanto processadores avariados mais avan√ßados podem extrair o m√°ximo de "paralelismo oculto" poss√≠vel. " <br><br><h3>  O ‚Äúnovo‚Äù n√∫cleo do Cavium: Vulcan </h3><br><img src="https://habrastorage.org/webt/20/1j/9c/201j9c0fk3jebmf5cwxryqdxkva.png"><br><br>  Comparado com o ThunderX original, o n√∫cleo do Vulcan ThunderX2 √© um animal completamente diferente.  Anunciado em 2014 pela Broadcom, o Vulcan √© um n√∫cleo relativamente grande que controla 4 threads simult√¢neos (SMT4).  Como resultado, o back-end deve ser bem carregado, mesmo ao trabalhar com cargas de servidor com baixo ILP. <br><br>  Para garantir a estabilidade de quatro fluxos SMT, o front-end ThunderX2 pode extrair at√© 64 bytes de um cache de instru√ß√µes associativo de 32 KB de 8 vias, equipado com um pr√©-buscador simples da "pr√≥xima linha".  No entanto, a escolha de 8 comandos √© poss√≠vel apenas se n√£o houver ramifica√ß√£o nesses 64 bytes.  Caso contr√°rio, a sele√ß√£o √© interrompida na bifurca√ß√£o. <br><br>  Isso significa que, no c√≥digo de ramifica√ß√£o intensiva (bancos de dados, AI ...), o buscador recebe uma m√©dia de ¬± 5 instru√ß√µes por ciclo, uma vez que uma das 5 instru√ß√µes √© uma ramifica√ß√£o.  As instru√ß√µes selecionadas s√£o enviadas ao buffer de suaviza√ß√£o - um buffer no qual as instru√ß√µes armazenadas s√£o armazenadas para decodifica√ß√£o. <br><br><img src="https://habrastorage.org/webt/lt/4e/q4/lt4eq4bh57wresbzuf84layrak8.png"><br><br>  Em seguida, o decodificador trabalha com um pacote de 4 instru√ß√µes.  Entre o decodificador e a fase de renomea√ß√£o, cada fluxo possui um "buffer slip", que consiste em 8 pacotes.  Com 4 threads, at√© 32 pacotes (128 instru√ß√µes) podem ser armazenados em buffer a qualquer momento. <br><br>  Essas 4 instru√ß√µes - o pacote - movem-se ao longo do pipeline at√© que uma √∫nica fila de mensagens seja alcan√ßada para o planejador.  Como o Loop Stream Detector da Intel (funciona como um pequeno cache), ele tamb√©m possui um buffer de loop e um preditor.  Esse buffer de loop elimina previs√µes incorretas de ramifica√ß√£o e cont√©m Œºops decodificados que "encurtam" o pipeline e reduzem a energia usada para decodifica√ß√£o. <br><br>  Podem ser executadas at√© 6 instru√ß√µes por vez.  A implementa√ß√£o inclui 2 slots ALU / FP / NEON, 1 slot ALU / tap, 2 slots de carregamento / armazenamento (16 bytes) e 1 slot de armazenamento limpo que envia 16 bytes para o cache D.  Existe um pequeno TL1 LB (a Cavium n√£o divulgar√° quanto) para alternar com atraso zero de endere√ßos virtuais para f√≠sicos.  N√£o h√° pr√©-buscador de hardware para o cache L1 D1, mas o cache L2 possui um pr√©-buscador de hardware bastante sofisticado que pode reconhecer padr√µes (ele pode funcionar passo a passo ou recuperar a pr√≥xima linha). <br><br>  Isso √© suficiente para "alimentar" o backend, que pode suportar 4 instru√ß√µes por ciclo a partir de 4 threads diferentes. <br><br><h3>  Diferen√ßas na microarquitetura </h3><br>  A Cavium publicou uma quantidade limitada de informa√ß√µes sobre os n√∫cleos ThunderX2.  Alguns recursos principais de v√°rias arquiteturas de processador est√£o resumidos abaixo. <br><br><img src="https://habrastorage.org/webt/ud/di/rc/uddircouggaghevqdm5rtzgfrry.png"><br><br>  Uma an√°lise detalhada est√° al√©m do escopo deste artigo.  Mas voc√™ pode ler as an√°lises de Johan De Gelas sobre a arquitetura de Falkor, Skylake e Zen no AnandTech.  N√≥s nos limitamos √†s diferen√ßas mais √≥bvias. <br><br>  √â bastante √≥bvio que o desempenho single-thread da Intel permanece incompar√°vel: o n√∫cleo Skylake √© o n√∫cleo que executa a maioria das instru√ß√µes em tempo real e, o mais importante, roda em uma velocidade de clock mais alta.  O n√∫cleo do ThunderX2 √© diferente, pois extrai o m√°ximo de instru√ß√µes por ciclo, capaz de suportar constantemente 4 threads.  O buscador capturar√° 8 equipes de um segmento, depois 8 do segundo segmento e continuar√° alternando entre os segmentos.  Isso significa que previs√µes ruins podem reduzir significativamente o desempenho de um √∫nico encadeamento. <br><br><h2>  Os SKUs ThunderX2: 16 a 32 n√∫cleos </h2><br>  O SKU usado para os testes √© o ThunderX2 CN9980 2.2.  Este √© o SKU de ponta, cont√©m 32 n√∫cleos a uma frequ√™ncia de 2,2 GHz com capacidade de aumentar at√© 2,5 GHz. <br><br><img src="https://habrastorage.org/webt/bs/p0/cz/bsp0czxkrsx9_oxyoavedet_lje.png"><br><br>  Se voc√™ acredita nos planos da Cavium, nos pr√≥ximos meses haver√° muito mais SKUs.  A Cavium afirma que o CN9980 estar√° dispon√≠vel em breve com uma frequ√™ncia de 2,5 GHz e turbo de at√© 3 GHz. <br><br>  A Cavium listou todos os SKUs planejados, juntamente com os SKUs Intel compar√°veis.  Pela defini√ß√£o da Cavium, um SKU Intel compar√°vel √© um chip que atinge o mesmo SPECInRate (2017) sob gcc que o SKU da Cavium. <br><br><img src="https://habrastorage.org/webt/nz/yd/7m/nzyd7mn7vi6azmttjyosotv51ma.png"><br><br>  A Cavium acredita que o CN9880 2.2 que adquirimos √© compar√°vel ao 8164, muito mais caro. Para nossos testes, comparamos com o 8176 (SKU da Intel dispon√≠vel para n√≥s).  N√£o que isso importe: o 8176 possui uma velocidade de clock apenas 3% mais alta e 2 n√∫cleos adicionais (+ 7%) em compara√ß√£o com o 8164. No entanto, observe que embora o ThunderX2 Cavium possa realmente competir com os SKUs da Intel indicados, eles oferecem o mesmo desempenho por um ter√ßo do custo do SKU da Intel. <br><br>  Na pr√≥xima parte: <br><br><ul><li>  Configura√ß√£o e metodologia de teste </li><li>  Subsistema de mem√≥ria: Largura de banda </li><li>  Desempenho de thread √∫nico: SPEC CPU2006 </li><li>  SPEC CPU2006 Cont: desempenho baseado em n√∫cleo com SMT </li></ul><br>  Obrigado por ficar conosco.  Voc√™ gosta dos nossos artigos?  Deseja ver materiais mais interessantes?  Ajude-nos fazendo um pedido ou recomendando a seus amigos, um <b>desconto de 30% para os usu√°rios da Habr em um an√°logo exclusivo de servidores b√°sicos que inventamos para voc√™:</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Toda a verdade sobre o VPS (KVM) E5-2650 v4 (6 n√∫cleos) 10GB DDR4 240GB SSD 1Gbps de US $ 20 ou como dividir o servidor?</a>  (as op√ß√µes est√£o dispon√≠veis com RAID1 e RAID10, at√© 24 n√∫cleos e at√© 40GB DDR4). <br><br>  <b>Dell R730xd 2 vezes mais barato?</b>  Somente n√≥s temos <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">2 TVs Intel Dodeca-Core Xeon E5-2650v4 128GB DDR4 6x480GB SSD 1Gbps 100 a partir de US $ 249</a> na Holanda e nos EUA!</b>  Leia sobre <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Como criar um pr√©dio de infraestrutura.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">classe usando servidores Dell R730xd E5-2650 v4 custando 9.000 euros por um centavo?</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt413885/">https://habr.com/ru/post/pt413885/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt413873/index.html">Os dados recuperados da miss√£o Apollo ajudaram a resolver o mist√©rio de "aquecer a lua"</a></li>
<li><a href="../pt413875/index.html">A SpaceX desenvolver√° um "centro espacial do futuro"</a></li>
<li><a href="../pt413877/index.html">Voc√™ apenas d√° uma raz√£o. Ou sob que pretexto eles podem roubar voc√™ agora?</a></li>
<li><a href="../pt413879/index.html">Aprendendo um cavalo (parte 4)</a></li>
<li><a href="../pt413881/index.html">Imagem do docker de 5,94 metros com Telegram MTProxy</a></li>
<li><a href="../pt413889/index.html">Prazo n√£o cumprido ou por que mais da metade das empresas n√£o estava pronta para o RGPD</a></li>
<li><a href="../pt413891/index.html">Como √© organizado o Registro Estadual Unificado de Pessoas Jur√≠dicas - um registro estadual unificado de pessoas jur√≠dicas</a></li>
<li><a href="../pt413893/index.html">Um buraco como ferramenta de seguran√ßa - 2, ou como capturar a ‚Äúisca viva‚Äù do APT</a></li>
<li><a href="../pt413895/index.html">Hackeando uma pulseira barata de fitness</a></li>
<li><a href="../pt413897/index.html">Unity3D ECS e sistema de tarefas</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>