<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ›¥ï¸ ğŸ§•ğŸ¼ ğŸ¦ˆ ä½¿ç”¨Pythonå’ŒTextBlobè¿›è¡ŒåŸå‹æƒ…æ„Ÿåˆ†æ ğŸ‘©ğŸ»â€ğŸ’¼ ğŸ‘” ğŸ¤œğŸ½</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="å¯¹äºåˆšåˆšå¼€å§‹æ„å»ºæœºå™¨å­¦ä¹ ç³»ç»Ÿçš„å¼€å‘å›¢é˜Ÿæ¥è¯´ï¼Œé‡è¦çš„æ˜¯ä»€ä¹ˆï¼Ÿ åˆ©ç”¨é›†æˆå’Œå•å…ƒæµ‹è¯•çš„ä½“ç³»ç»“æ„ï¼Œç»„ä»¶ï¼Œæµ‹è¯•åŠŸèƒ½ï¼Œå¯ä»¥åˆ¶ä½œåŸå‹å¹¶è·å¾—ç¬¬ä¸€æ‰¹ç»“æœã€‚ å¹¶è¿›ä¸€æ­¥è¯„ä¼°åŠ³åŠ¨åŠ›æŠ•å…¥ï¼Œè§„åˆ’åˆ¶å®šå’Œå®æ–½ã€‚ 

 æœ¬æ–‡å°†é‡ç‚¹ä»‹ç»åŸå‹ã€‚ ä¸äº§å“ç»ç†äº¤è°ˆåçš„æŸä¸ªæ—¶é—´åˆ›å»ºäº†å“ªä¸ªï¼šæˆ‘ä»¬ä¸ºä»€ä¹ˆä¸â€œæ¥è§¦â€æœºå™¨å­¦ä¹ ï¼Ÿ ç‰¹åˆ«æ˜¯NLPå’Œæƒ…ç»ªåˆ†æ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ä½¿ç”¨Pythonå’ŒTextBlobè¿›è¡ŒåŸå‹æƒ…æ„Ÿåˆ†æ</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/457168/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/8l/ir/g2/8lirg2klkrmofom9vhhcgldh-qo.jpeg" alt="å›¾ç‰‡"></div><br> å¯¹äºåˆšåˆšå¼€å§‹æ„å»ºæœºå™¨å­¦ä¹ ç³»ç»Ÿçš„å¼€å‘å›¢é˜Ÿæ¥è¯´ï¼Œé‡è¦çš„æ˜¯ä»€ä¹ˆï¼Ÿ åˆ©ç”¨é›†æˆå’Œå•å…ƒæµ‹è¯•çš„ä½“ç³»ç»“æ„ï¼Œç»„ä»¶ï¼Œæµ‹è¯•åŠŸèƒ½ï¼Œå¯ä»¥åˆ¶ä½œåŸå‹å¹¶è·å¾—ç¬¬ä¸€æ‰¹ç»“æœã€‚ å¹¶è¿›ä¸€æ­¥è¯„ä¼°åŠ³åŠ¨åŠ›æŠ•å…¥ï¼Œè§„åˆ’åˆ¶å®šå’Œå®æ–½ã€‚ <br><br> æœ¬æ–‡å°†é‡ç‚¹ä»‹ç»åŸå‹ã€‚ ä¸äº§å“ç»ç†äº¤è°ˆåçš„æŸä¸ªæ—¶é—´åˆ›å»ºäº†å“ªä¸ªï¼šæˆ‘ä»¬ä¸ºä»€ä¹ˆä¸â€œæ¥è§¦â€æœºå™¨å­¦ä¹ ï¼Ÿ ç‰¹åˆ«æ˜¯NLPå’Œæƒ…ç»ªåˆ†æï¼Ÿ <br><a name="habracut"></a><br>  â€œä¸ºä»€ä¹ˆä¸å‘¢ï¼Ÿâ€ æˆ‘å›ç­”äº†ã€‚ ä¸è¿‡ï¼Œæˆ‘ä»äº‹åç«¯å¼€å‘å·²ç»è¶…è¿‡15å¹´ï¼Œæˆ‘å–œæ¬¢å¤„ç†æ•°æ®å¹¶è§£å†³æ€§èƒ½é—®é¢˜ã€‚ ä½†æ˜¯æˆ‘ä»ç„¶ä¸å¾—ä¸æ‰¾å‡ºâ€œå…”å­æ´æœ‰å¤šæ·±â€ã€‚ <br><br><h2> é€‰æ‹©ç»„ä»¶ </h2><br> ä¸ºäº†ä»¥æŸç§æ–¹å¼æ¦‚è¿°å®ç°MLæ ¸å¿ƒé€»è¾‘çš„ç»„ä»¶é›†ï¼Œè®©æˆ‘ä»¬çœ‹ä¸€ä¸ªç®€å•çš„æƒ…æ„Ÿåˆ†æå®ç°ç¤ºä¾‹ï¼Œå®ƒæ˜¯GitHubä¸Šå¯ç”¨çš„ä¼—å¤šç¤ºä¾‹ä¹‹ä¸€ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">Pythonä¸­æƒ…æ„Ÿåˆ†æçš„ä¸€ä¸ªç¤ºä¾‹</b> <div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> collections <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> nltk <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> os <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ( datasets, model_selection, feature_extraction, linear_model ) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">extract_features</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(corpus)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">'''Extract TF-IDF features from corpus'''</span></span> <span class="hljs-comment"><span class="hljs-comment"># vectorize means we turn non-numerical data into an array of numbers count_vectorizer = feature_extraction.text.CountVectorizer( lowercase=True, # for demonstration, True by default tokenizer=nltk.word_tokenize, # use the NLTK tokenizer stop_words='english', # remove stop words min_df=1 # minimum document frequency, ie the word must appear more than once. ) processed_corpus = count_vectorizer.fit_transform(corpus) processed_corpus = feature_extraction.text.TfidfTransformer().fit_transform( processed_corpus) return processed_corpus data_directory = 'movie_reviews' movie_sentiment_data = datasets.load_files(data_directory, shuffle=True) print('{} files loaded.'.format(len(movie_sentiment_data.data))) print('They contain the following classes: {}.'.format( movie_sentiment_data.target_names)) movie_tfidf = extract_features(movie_sentiment_data.data) X_train, X_test, y_train, y_test = model_selection.train_test_split( movie_tfidf, movie_sentiment_data.target, test_size=0.30, random_state=42) # similar to nltk.NaiveBayesClassifier.train() model = linear_model.LogisticRegression() model.fit(X_train, y_train) print('Model performance: {}'.format(model.score(X_test, y_test))) y_pred = model.predict(X_test) for i in range(5): print('Review:\n{review}\n-\nCorrect label: {correct}; Predicted: {predict}'.format( review=X_test[i], correct=y_test[i], predict=y_pred[i] ))</span></span></code> </pre> <br></div></div><br> è§£æè¿™æ ·çš„ç¤ºä¾‹å¯¹äºå¼€å‘äººå‘˜æ˜¯ä¸€ä¸ªå•ç‹¬çš„æŒ‘æˆ˜ã€‚ <br> ä¸€æ¬¡åªæœ‰45è¡Œä»£ç ï¼Œå¹¶ä¸”ä¸€æ¬¡æœ‰4ä¸ªï¼ˆå››ä¸ªï¼ŒKarlï¼ï¼‰é€»è¾‘å—ï¼š <br><br><ol><li> ä¸‹è½½æ•°æ®ä»¥è¿›è¡Œæ¨¡å‹è®­ç»ƒï¼ˆç¬¬25-26è¡Œï¼‰ </li><li> å‡†å¤‡ä¸Šä¼ çš„æ•°æ®-ç‰¹å¾æå–ï¼ˆç¬¬31-34è¡Œï¼‰ </li><li> åˆ›å»ºå’Œè®­ç»ƒæ¨¡å‹ï¼ˆç¬¬36-39è¡Œï¼‰ </li><li> æµ‹è¯•è®­ç»ƒå¥½çš„æ¨¡å‹å¹¶è¾“å‡ºç»“æœï¼ˆç¬¬41-45è¡Œï¼‰ </li></ol><br> è¿™äº›è¦ç‚¹ä¸­çš„æ¯ä¸€ä¸ªéƒ½åº”å•ç‹¬æ’°å†™ã€‚ å½“ç„¶ï¼Œå®ƒéœ€è¦åœ¨å•ç‹¬çš„æ¨¡å—ä¸­æ³¨å†Œã€‚ è‡³å°‘å‡ºäºå•å…ƒæµ‹è¯•çš„éœ€è¦ã€‚ <br><br> å¦å¤–ï¼Œå€¼å¾—é‡ç‚¹ä»‹ç»æ•°æ®å‡†å¤‡å’Œæ¨¡å‹è®­ç»ƒçš„ç»„æˆéƒ¨åˆ†ã€‚ <br> åœ¨ä½¿æ¨¡å‹æ›´ç²¾ç¡®çš„æ¯ç§æ–¹å¼ä¸­ï¼ŒæŠ•å…¥äº†æ•°ç™¾å°æ—¶çš„ç§‘å­¦å’Œå·¥ç¨‹å·¥ä½œã€‚ <br><br> å¹¸è¿çš„æ˜¯ï¼Œä¸ºäº†å¿«é€Ÿå¼€å§‹ä½¿ç”¨NLPï¼Œæœ‰ä¸€ä¸ªç°æˆçš„è§£å†³æ–¹æ¡ˆ<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">-NLTK</a>å’Œ<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">TextBlobåº“</a> ã€‚ ç¬¬äºŒä¸ªæ˜¯NLTKçš„åŒ…è£…ç¨‹åºï¼Œå®ƒå¾ˆç¹ç-ä»è®­ç»ƒé›†ä¸­æå–ç‰¹å¾ï¼Œç„¶åæ ¹æ®ç¬¬ä¸€ä¸ªåˆ†ç±»è¯·æ±‚è®­ç»ƒæ¨¡å‹ã€‚ <br><br> ä½†æ˜¯åœ¨è®­ç»ƒæ¨¡å‹ä¹‹å‰ï¼Œæ‚¨éœ€è¦ä¸ºå…¶å‡†å¤‡æ•°æ®ã€‚ <br><br><h2> å‡†å¤‡èµ„æ–™ </h2><br><h3> ä¸‹è½½èµ„æ–™ </h3><br> å¦‚æœæˆ‘ä»¬è°ˆè®ºåŸå‹ï¼Œé‚£ä¹ˆä»CSV / TSVæ–‡ä»¶åŠ è½½æ•°æ®æ˜¯åŸºæœ¬çš„ã€‚ æ‚¨åªéœ€ä»pandasåº“è°ƒç”¨<b>read_csv</b>å‡½æ•°ï¼š <br><br><pre> <code class="plaintext hljs">import pandas as pd data = pd.read_csv(data_path, delimiter)</code> </pre><br> ä½†æ˜¯ï¼Œè¯¥æ•°æ®å°†æ— æ³•åœ¨æ¨¡å‹ä¸­ä½¿ç”¨ã€‚ <br><br> é¦–å…ˆï¼Œå¦‚æœæˆ‘ä»¬ç¨å¾®å¿½ç•¥csvæ ¼å¼ï¼Œé‚£ä¹ˆå¾ˆå®¹æ˜“æœŸæœ›æ¯ä¸ªæºéƒ½å°†æä¾›å…·æœ‰å…¶è‡ªèº«ç‰¹å¾çš„æ•°æ®ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦è¿›è¡Œä¸€äº›ä¸æºç›¸å…³çš„æ•°æ®å‡†å¤‡å·¥ä½œã€‚ å³ä½¿æ˜¯æœ€ç®€å•çš„CSVæ–‡ä»¶ï¼Œè¦è§£æå®ƒï¼Œæˆ‘ä»¬ä¹Ÿéœ€è¦çŸ¥é“å®šç•Œç¬¦ã€‚ <br><br> æ­¤å¤–ï¼Œæ‚¨åº”è¯¥ç¡®å®šå“ªäº›æ¡ç›®ä¸ºæ­£ï¼Œå“ªäº›æ¡ç›®ä¸ºè´Ÿã€‚ å½“ç„¶ï¼Œæ­¤ä¿¡æ¯åœ¨æˆ‘ä»¬è¦ä½¿ç”¨çš„æ•°æ®é›†çš„æ‰¹æ³¨ä¸­æŒ‡ç¤ºã€‚ ä½†æ˜¯äº‹å®æ˜¯ï¼Œåœ¨ä¸€ç§æƒ…å†µä¸‹pos / negçš„ç¬¦å·æ˜¯0æˆ–1ï¼Œåœ¨å¦ä¸€ç§æƒ…å†µä¸‹å®ƒæ˜¯é€»è¾‘ä¸Šçš„True / Falseï¼Œåœ¨ç¬¬ä¸‰ç§æƒ…å†µä¸‹åªæ˜¯pos / negå­—ç¬¦ä¸²ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹æ˜¯ä»0åˆ°5çš„æ•´æ•°å…ƒç»„åè€…ä¸å¤šç±»åˆ†ç±»çš„æƒ…å†µæœ‰å…³ï¼Œä½†æ˜¯è°è¯´è¿™æ ·çš„æ•°æ®é›†ä¸èƒ½ç”¨äºäºŒè¿›åˆ¶åˆ†ç±»å‘¢ï¼Ÿ æ‚¨åªéœ€è¦é€‚å½“åœ°æ ‡è¯†æ­£å€¼å’Œè´Ÿå€¼çš„è¾¹ç•Œå³å¯ã€‚ <br><br> æˆ‘æƒ³åœ¨ä¸åŒçš„æ•°æ®é›†ä¸Šå°è¯•è¯¥æ¨¡å‹ï¼Œå¹¶ä¸”è¦æ±‚è®­ç»ƒåï¼Œè¯¥æ¨¡å‹ä»¥ä¸€ç§å•ä¸€æ ¼å¼è¿”å›ç»“æœã€‚ ä¸ºæ­¤ï¼Œåº”å°†å…¶å¼‚æ„æ•°æ®ç»Ÿä¸€åŒ–ã€‚ <br><br> å› æ­¤ï¼Œåœ¨æ•°æ®åŠ è½½é˜¶æ®µæˆ‘ä»¬éœ€è¦ä¸‰ä¸ªåŠŸèƒ½ï¼š <br><br><ol><li> ä¸æ•°æ®æºçš„è¿æ¥æ˜¯é’ˆå¯¹CSVçš„ï¼Œåœ¨æˆ‘ä»¬çš„ç¤ºä¾‹ä¸­ï¼Œå®ƒæ˜¯åœ¨read_csvå‡½æ•°å†…éƒ¨å®ç°çš„ï¼› </li><li> æ”¯æŒæ ¼å¼åŠŸèƒ½ï¼› </li><li> åˆæ­¥æ•°æ®å‡†å¤‡ã€‚ </li></ol><br> è¿™å°±æ˜¯å®ƒåœ¨ä»£ç ä¸­çš„å¤–è§‚ã€‚ <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-comment"><span class="hljs-comment"># linear algebra import pandas as pd # data processing, CSV file I/O (eg pd.read_csv) import logging log = logging.getLogger() class CsvSentimentDataLoader(): def __init__(self, file_path, delim, text_attr, rate_attr, pos_rates): self.data_path = file_path self.delimiter = delim self.text_attr = text_attr self.rate_attr = rate_attr self.pos_rates = pos_rates def load_data(self): #     csv  tsv  data = pd.read_csv(self.data_path, self.delimiter) data.head() #   , #      data = data[[self.text_attr, self.rate_attr]] #    #     'pos'  'neg' data[self.rate_attr] = np.where( data[self.rate_attr].isin(self.pos_rates), 'pos', 'neg') return data</span></span></code> </pre><br> åˆ¶ä½œäº†ç±»<b>CsvSentimentDataLoader</b> ï¼Œè¯¥ç±»åœ¨æ„é€ å‡½æ•°ä¸­ä¼ é€’ç»™csvçš„è·¯å¾„ï¼Œåˆ†éš”ç¬¦ï¼Œæ–‡æœ¬åç§°å’Œåˆ†ç±»å±æ€§ä»¥åŠå»ºè®®æ–‡æœ¬ä¸ºæ­£å€¼çš„å€¼åˆ—è¡¨ã€‚ <br><br> åŠ è½½æœ¬èº«å‘ç”Ÿåœ¨<b>load_data</b>æ–¹æ³•ä¸­ã€‚ <br><br><h3> æˆ‘ä»¬å°†æ•°æ®åˆ†ä¸ºæµ‹è¯•é›†å’Œè®­ç»ƒé›† </h3><br> å¥½çš„ï¼Œæˆ‘ä»¬ä¸Šä¼ äº†æ•°æ®ï¼Œä½†æ˜¯æˆ‘ä»¬ä»ç„¶éœ€è¦å°†å…¶åˆ’åˆ†ä¸ºè®­ç»ƒé›†å’Œæµ‹è¯•é›†ã€‚ <br><br> è¿™æ˜¯é€šè¿‡<b>sklearn</b>åº“ä¸­çš„<b>train_test_split</b>å‡½æ•°å®Œæˆçš„ã€‚ æ­¤å‡½æ•°å¯ä»¥é‡‡ç”¨å¾ˆå¤šå‚æ•°ä½œä¸ºè¾“å…¥ï¼Œä»è€Œç¡®å®šå°†æ­¤æ•°æ®é›†å‡†ç¡®åˆ†ä¸ºè®­ç»ƒå’Œæµ‹è¯•çš„ç¨‹åº¦ã€‚ è¿™äº›å‚æ•°ä¼šæå¤§åœ°å½±å“æœ€ç»ˆçš„è®­ç»ƒå’Œæµ‹è¯•é›†ï¼Œå¯¹äºæˆ‘ä»¬æ¥è¯´ï¼Œåˆ›å»ºä¸€ä¸ªç±»ï¼ˆå°†å…¶ç§°ä¸ºSimpleDataSplitterï¼‰æ¥ç®¡ç†è¿™äº›å‚æ•°å¹¶å°†è¯¥å‡½æ•°çš„è°ƒç”¨æ±‡æ€»èµ·æ¥å¯èƒ½ä¼šå¾ˆæ–¹ä¾¿ã€‚ <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.model_selection <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> train_test_split <span class="hljs-comment"><span class="hljs-comment"># to split the training and testing data import logging log = logging.getLogger() class SimpleDataSplitter(): def __init__(self, text_attr, rate_attr, test_part_size=.3): self.text_attr = text_attr self.rate_attr = rate_attr self.test_part_size = test_part_size def split_data(self, data): x = data[self.text_attr] y = data[self.rate_attr] x_train, x_test, y_train, y_test = train_test_split( x, y, test_size = self.test_part_size) return x_train, x_test, y_train, y_test</span></span></code> </pre><br> ç°åœ¨ï¼Œæ­¤ç±»åŒ…æ‹¬æœ€ç®€å•çš„å®ç°ï¼Œå°†å…¶åˆ’åˆ†æ—¶å°†ä»…è€ƒè™‘ä¸€ä¸ªå‚æ•°-åº”å°†å…¶è§†ä¸ºæµ‹è¯•é›†çš„è®°å½•ç™¾åˆ†æ¯”ã€‚ <br><br><h3> æ•°æ®é›† </h3><br> ä¸ºäº†è®­ç»ƒæ¨¡å‹ï¼Œæˆ‘ä½¿ç”¨äº†CSVæ ¼å¼çš„å…è´¹å¯ç”¨æ•°æ®é›†ï¼š <br><br><ul><li>  Amazon Alexaè¯„è®ºæ•°æ®é›†ï¼Œ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å¯åœ¨Kaggleè·å¾—</a> </li><li> åŠ å·å¤§å­¦<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æƒ…æ„Ÿæ ‡è®°å¥å­æ•°æ®é›†</a> </li></ul><br> ä¸ºäº†æ›´åŠ æ–¹ä¾¿ï¼Œæˆ‘ä¸ºæ¯ä¸ªæ•°æ®é›†åˆ›å»ºäº†ä¸€ä¸ªç±»ï¼Œè¯¥ç±»ä»ç›¸åº”çš„CSVæ–‡ä»¶åŠ è½½æ•°æ®å¹¶å°†å…¶åˆ†ä¸ºè®­ç»ƒé›†å’Œæµ‹è¯•é›†ã€‚ <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> os <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> collections <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> logging <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> web.data.loaders <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> CsvSentimentDataLoader <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> web.data.splitters <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> SimpleDataSplitter, TdIdfDataSplitter log = logging.getLogger() <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AmazonAlexaDataset</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">()</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.file_path = os.path.normpath(os.path.join(os.path.dirname(__file__), <span class="hljs-string"><span class="hljs-string">'amazon_alexa/train.tsv'</span></span>)) self.delim = <span class="hljs-string"><span class="hljs-string">'\t'</span></span> self.text_attr = <span class="hljs-string"><span class="hljs-string">'verified_reviews'</span></span> self.rate_attr = <span class="hljs-string"><span class="hljs-string">'feedback'</span></span> self.pos_rates = [<span class="hljs-number"><span class="hljs-number">1</span></span>] self.data = <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> self.train = <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> self.test = <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">load_data</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> loader = CsvSentimentDataLoader(self.file_path, self.delim, self.text_attr, self.rate_attr, self.pos_rates) splitter = SimpleDataSplitter(self.text_attr, self.rate_attr, test_part_size=<span class="hljs-number"><span class="hljs-number">.3</span></span>) self.data = loader.load_data() x_train, x_test, y_train, y_test = splitter.split_data(self.data) self.train = [x <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> x <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> zip(x_train, y_train)] self.test = [x <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> x <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> zip(x_test, y_test)]</code> </pre><br> æ˜¯çš„ï¼Œå¯¹äºæ•°æ®åŠ è½½ï¼ŒåŸå§‹ç¤ºä¾‹ä¸­çš„ä»£ç å¤šäº5è¡Œã€‚ <br> ä½†æ˜¯ç°åœ¨ï¼Œå¯ä»¥é€šè¿‡å¤„ç†æ•°æ®æºå’Œè®­ç»ƒé›†å‡†å¤‡ç®—æ³•æ¥åˆ›å»ºæ–°çš„æ•°æ®é›†ã€‚ <br><br> å¦å¤–ï¼Œå•ä¸ªç»„ä»¶å¯¹äºå•å…ƒæµ‹è¯•æ›´åŠ æ–¹ä¾¿ã€‚ <br><br><h2> æˆ‘ä»¬è®­ç»ƒæ¨¡å‹ </h2><br> è¯¥æ¨¡å‹å·²ç»å­¦ä¹ äº†ä¸€æ®µæ—¶é—´ã€‚ å¹¶ä¸”å¿…é¡»åœ¨åº”ç”¨ç¨‹åºå¯åŠ¨æ—¶æ‰§è¡Œä¸€æ¬¡ã€‚ <br> ä¸ºæ­¤ï¼Œæˆ‘ä»¬åˆ¶ä½œäº†ä¸€ä¸ªå°å‹åŒ…è£…ç¨‹åºï¼Œä½¿æ‚¨å¯ä»¥ä¸‹è½½å’Œå‡†å¤‡æ•°æ®ï¼Œä»¥åŠåœ¨åº”ç”¨ç¨‹åºåˆå§‹åŒ–æ—¶è®­ç»ƒæ¨¡å‹ã€‚ <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TextBlobWrapper</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">()</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.log = logging.getLogger() self.is_model_trained = <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> self.classifier = <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">init_app</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.log.info(<span class="hljs-string"><span class="hljs-string">'&gt;&gt;&gt;&gt;&gt; TextBlob initialization started'</span></span>) self.ensure_model_is_trained() self.log.info(<span class="hljs-string"><span class="hljs-string">'&gt;&gt;&gt;&gt;&gt; TextBlob initialization completed'</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ensure_model_is_trained</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> self.is_model_trained: ds = SentimentLabelledDataset() ds.load_data() <span class="hljs-comment"><span class="hljs-comment"># train the classifier and test the accuracy self.classifier = NaiveBayesClassifier(ds.train) acr = self.classifier.accuracy(ds.test) self.log.info(str.format('&gt;&gt;&gt;&gt;&gt; NaiveBayesClassifier trained with accuracy {}', acr)) self.is_model_trained = True return self.classifier</span></span></code> </pre><br> é¦–å…ˆè·å¾—è®­ç»ƒå’Œæµ‹è¯•æ•°æ®ï¼Œç„¶åè¿›è¡Œç‰¹å¾æå–ï¼Œæœ€åè®­ç»ƒåˆ†ç±»å™¨å¹¶æ£€æŸ¥æµ‹è¯•é›†çš„å‡†ç¡®æ€§ã€‚ <br><br><h2> æµ‹è¯•ä¸­ </h2><br> åˆå§‹åŒ–åï¼Œæˆ‘ä»¬å°†è·å¾—ä¸€ä¸ªæ—¥å¿—ï¼Œä»¥åˆ¤æ–­æ˜¯å¦å·²ä¸‹è½½æ•°æ®å¹¶æˆåŠŸè®­ç»ƒäº†æ¨¡å‹ã€‚ å¹¶ä»¥éå¸¸é«˜çš„ç²¾åº¦ï¼ˆå¯¹äºåˆå­¦è€…ï¼‰è¿›è¡Œäº†åŸ¹è®­-0.8878ã€‚ <br><br><img src="https://habrastorage.org/webt/nl/hw/pt/nlhwptjx8xnwfao2anynttvbr1u.png" alt="å›¾ç‰‡"><br><br> æ”¶åˆ°äº†è¿™æ ·çš„æ•°å­—åï¼Œæˆ‘éå¸¸çƒ­å¿ƒã€‚ ä½†æ˜¯ä¸å¹¸çš„æ˜¯ï¼Œæˆ‘çš„å–œæ‚¦å¹¶ä¸é•¿ã€‚ åœ¨è¿™ç»„æ¨¡å‹ä¸Šè®­ç»ƒçš„æ¨¡å‹æ˜¯åšä¸å¯æ‘§çš„ä¹è§‚ä¸»ä¹‰è€…ï¼ŒåŸåˆ™ä¸Šä¸èƒ½è¯†åˆ«è´Ÿé¢è¯„è®ºã€‚ <br><br> åŸå› æ˜¯åœ¨è®­ç»ƒé›†æ•°æ®ä¸­ã€‚ è¯¥é›†ä¸­çš„æ­£é¢è¯„è®ºæ•°é‡è¶…è¿‡90ï¼…ã€‚ å› æ­¤ï¼Œæ¨¡å‹çš„å‡†ç¡®æ€§çº¦ä¸º88ï¼…ï¼Œå¦å®šæ€§è¯„è®ºåªä¼šè½å…¥é¢„æœŸé”™è¯¯åˆ†ç±»çš„12ï¼…ã€‚ <br><br> æ¢å¥è¯è¯´ï¼Œä½¿ç”¨è¿™æ ·çš„è®­ç»ƒé›†ï¼Œæ ¹æœ¬ä¸å¯èƒ½è®­ç»ƒæ¨¡å‹æ¥è¯†åˆ«è´Ÿé¢è¯„è®ºã€‚ <br><br> ä¸ºäº†çœŸæ­£ç¡®ä¿è¿™ä¸€ç‚¹ï¼Œæˆ‘è¿›è¡Œäº†å•å…ƒæµ‹è¯•ï¼Œè¯¥æµ‹è¯•åˆ†åˆ«é’ˆå¯¹å¦ä¸€ä¸ªæ•°æ®é›†çš„100ä¸ªè‚¯å®šçŸ­è¯­å’Œ100ä¸ªå¦å®šçŸ­è¯­è¿è¡Œåˆ†ç±»-ä¸ºè¿›è¡Œæµ‹è¯•ï¼Œæˆ‘ä»åŠ åˆ©ç¦å°¼äºšå¤§å­¦è·å¾—äº†<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Sentiment Labeled Sentences Data Set</a> ã€‚ <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta"> @loggingtestcase.capturelogs(None, level='INFO') def test_classifier_on_separate_set(self, logs): tb = TextBlobWrapper() # Going to be trained on Amazon Alexa dataset ds = SentimentLabelledDataset() # Test dataset ds.load_data() # Check poisitives true_pos = 0 data = ds.data.to_numpy() seach_mask = np.isin(data[:, 1], ['pos']) data = data[seach_mask][:100] for e in data[:]: # Model train will be performed on first classification call r = tb.do_sentiment_classification(e[0]) if r == e[1]: true_pos += 1 self.assertLessEqual(true_pos, 100) print(str.format('\n\nTrue Positive answers - {} of 100', true_pos))</span></span></code> </pre><br> æµ‹è¯•æ­£å€¼åˆ†ç±»çš„ç®—æ³•å¦‚ä¸‹ï¼š <br><br><ul><li> ä¸‹è½½æµ‹è¯•æ•°æ®ï¼› </li><li> æ¥å—100ä¸ªæ ‡è®°ä¸ºâ€œ posâ€çš„å¸–å­ </li><li> æˆ‘ä»¬é€šè¿‡æ¨¡å‹è¿è¡Œå®ƒä»¬ä¸­çš„æ¯ä¸€ä¸ªå¹¶è®¡ç®—æ­£ç¡®ç»“æœçš„æ•°é‡ </li><li> åœ¨æ§åˆ¶å°ä¸­æ˜¾ç¤ºæœ€ç»ˆç»“æœã€‚ </li></ul><br> ç±»ä¼¼åœ°ï¼Œå¯¹å¦å®šè¯„è®ºè¿›è¡Œè®¡æ•°ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">ç»“æœ</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/79/lj/px/79ljpxifxo5sl1kpdt_h0q4zd58.png" alt="å›¾ç‰‡"><br></div></div><br> ä¸å‡ºæ‰€æ–™ï¼Œæ‰€æœ‰è´Ÿé¢è¯„è®ºå‡è¢«ç¡®è®¤ä¸ºæ­£é¢ã€‚ <br><br> è€Œä¸”ï¼Œå¦‚æœæ‚¨åœ¨ç”¨äºæµ‹è¯•çš„æ•°æ®é›†ä¸Šè®­ç»ƒæ¨¡å‹- <b>æ„Ÿå¹æ ‡ç­¾</b> ï¼Ÿ åœ¨é‚£é‡Œï¼Œè´Ÿé¢å’Œæ­£é¢è¯„è®ºçš„åˆ†å¸ƒæ°å¥½æ˜¯50åˆ°50ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">æ›´æ”¹ä»£ç å¹¶æµ‹è¯•ï¼Œè¿è¡Œ</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/tj/cw/oo/tjcwoocc2qodmbd5zl7emwqt8ve.png" alt="å›¾ç‰‡"><br></div></div><br> å·²ç»æœ‰ä¸œè¥¿äº† æ¥è‡ªç¬¬ä¸‰æ–¹é›†çš„200ä¸ªæ¡ç›®çš„å®é™…å‡†ç¡®æ€§ä¸º76ï¼…ï¼Œè€Œå¦å®šè¯„è®ºçš„åˆ†ç±»å‡†ç¡®æ€§ä¸º79ï¼…ã€‚ <br><br> å½“ç„¶ï¼Œæœ‰76ï¼…çš„äººä¼šä¸ºåŸå‹åšå‡†å¤‡ï¼Œä½†ä¸è¶³ä»¥è¿›è¡Œç”Ÿäº§ã€‚ è¿™æ„å‘³ç€å°†éœ€è¦é‡‡å–å…¶ä»–æªæ–½æ¥æé«˜ç®—æ³•çš„å‡†ç¡®æ€§ã€‚ ä½†è¿™æ˜¯å¦ä¸€ä¸ªæŠ¥å‘Šçš„ä¸»é¢˜ã€‚ <br><br><h2> æ€»ç»“ </h2><br> é¦–å…ˆï¼Œæˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ªå…·æœ‰åå‡ ä¸ªç±»å’Œ200ä½™è¡Œä»£ç çš„åº”ç”¨ç¨‹åºï¼Œæ¯”åŸå§‹ç¤ºä¾‹å¤šäº†30è¡Œã€‚ æ‚¨åº”è¯¥è¯šå®-è¿™äº›åªæ˜¯ç»“æ„çš„æš—ç¤ºï¼Œæ˜¯å¯¹æœªæ¥åº”ç”¨ç¨‹åºè¾¹ç•Œçš„é¦–æ¬¡é˜æ˜ã€‚ åŸå‹ã€‚ <br><br> ä»æœºå™¨å­¦ä¹ ä¸“å®¶å’Œä¼ ç»Ÿåº”ç”¨ç¨‹åºå¼€å‘äººå‘˜çš„è§’åº¦æ¥çœ‹ï¼Œè¯¥åŸå‹ä½¿å®ç°ä»£ç æ–¹æ³•ä¹‹é—´çš„è·ç¦»æˆä¸ºå¯èƒ½ã€‚ æˆ‘è®¤ä¸ºï¼Œè¿™æ˜¯å†³å®šå°è¯•æœºå™¨å­¦ä¹ çš„å¼€å‘äººå‘˜çš„ä¸»è¦å›°éš¾ã€‚ <br><br> æ¥ä¸‹æ¥å¯èƒ½ä¼šä½¿åˆå­¦è€…é™·å…¥åƒµå±€çš„äº‹æƒ…-æ•°æ®çš„é‡è¦æ€§ä¸äºšäºæ‰€é€‰æ¨¡å‹ã€‚ è¿™å·²ç»æ¸…æ¥šåœ°è¡¨æ˜äº†ã€‚ <br><br> æ­¤å¤–ï¼Œåœ¨æŸäº›æ•°æ®ä¸Šè®­ç»ƒçš„æ¨¡å‹æ€»æ˜¯æœ‰å¯èƒ½åœ¨å…¶ä»–æ•°æ®ä¸Šæ˜¾ç¤ºä¸å……åˆ†ï¼Œæˆ–è€…åœ¨æŸäº›æ—¶å€™å…¶å‡†ç¡®æ€§å°†å¼€å§‹ä¸‹é™ã€‚ <br> å› æ­¤ï¼Œéœ€è¦æŒ‡æ ‡æ¥ç›‘æ§æ¨¡å‹çš„çŠ¶æ€ï¼Œä½¿ç”¨æ•°æ®æ—¶çš„çµæ´»æ€§ä»¥åŠè°ƒæ•´åŠ¨æ€å­¦ä¹ çš„æŠ€æœ¯èƒ½åŠ›ã€‚ ä¾æ­¤ç±»æ¨ã€‚ <br><br> å¯¹äºæˆ‘æ¥è¯´ï¼Œåœ¨è®¾è®¡ä½“ç³»ç»“æ„å’Œæ„å»ºå¼€å‘è¿‡ç¨‹æ—¶åº”è€ƒè™‘æ‰€æœ‰è¿™äº›å› ç´ ã€‚ <br><br> é€šå¸¸ï¼Œâ€œå…”å­æ´â€ä¸ä»…å¾ˆæ·±ï¼Œè€Œä¸”è¿˜éå¸¸å·§å¦™åœ°é“ºè®¾äº†ã€‚ ä½†æ˜¯å¯¹äºæˆ‘ï¼ˆä½œä¸ºå¼€å‘äººå‘˜ï¼‰æ¥è¯´ï¼Œå°†æ¥ç ”ç©¶æ­¤ä¸»é¢˜æ›´åŠ æœ‰è¶£ã€‚ </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN457168/">https://habr.com/ru/post/zh-CN457168/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN457152/index.html">DEFCON 25ä¼šè®®ï¼ŒGarry Kasparovã€‚ â€œå¤§è„‘çš„æœ€åä¸€æˆ˜ã€‚â€ ç¬¬ä¸€éƒ¨åˆ†</a></li>
<li><a href="../zh-CN457154/index.html">é’ˆå¯¹æ¯ä¸ªç”¨æˆ·çš„å“åº”å¼åº”ç”¨ç¨‹åºè®¾è®¡</a></li>
<li><a href="../zh-CN457156/index.html">æœªæ¥çš„è®¡ç®—ç³»ç»Ÿå¯èƒ½æ˜¯ä»€ä¹ˆ</a></li>
<li><a href="../zh-CN457160/index.html">æˆ‘åœ¨C ++ä¸­å®ç°å§”æ‰˜çš„æ–¹æ³•ï¼šåœ¨è¿è¡Œæ—¶è°ƒç”¨å‚æ•°æœªçŸ¥çš„å‡½æ•°</a></li>
<li><a href="../zh-CN457164/index.html">ä½¿ç”¨ReactiveUIå’ŒAvaloniaçš„ç¤ºä¾‹åœ¨è·¨å¹³å°.NET Coreåº”ç”¨ç¨‹åºä¸­å¯¼èˆªå¹¶å°†çŠ¶æ€ä¿å­˜åˆ°ç£ç›˜</a></li>
<li><a href="../zh-CN457172/index.html">ScreenLogger-å¾®ç¬‘ï¼Œéšè—çš„æ‘„åƒå¤´å¸¦æ‚¨</a></li>
<li><a href="../zh-CN457178/index.html">å¤„ç†å™¨çš„è®¾è®¡å’Œåˆ¶é€ æ–¹å¼ï¼šCPUè®¾è®¡</a></li>
<li><a href="../zh-CN457180/index.html">å®˜æ–¹ç½‘ç«™Node.jsç°å·²å¯ç”¨ä¿„è¯­</a></li>
<li><a href="../zh-CN457182/index.html">REXXè¯­è¨€40å‘¨å¹´</a></li>
<li><a href="../zh-CN457184/index.html">ä¸ºASP.NET Coreç½‘ç«™åŠ¨æ€åˆ›å»ºrobots.txt</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>