<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>↗️ 🙌🏿 🧞 Senhas da Cisco, migração de zona DNS, zero solicitações LDAP, coletamos pacotes Ethernet. Resolvendo problemas em uma rede com r0ot-mi. Parte 2 👩🏿‍🤝‍👩🏽 🙆🏽 🤔</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Este artigo resolverá vários outros problemas. Links para outras partes abaixo. 

 A primeira parte: Ethernet, FTP, Telnet, HTTP, Bluetooth - o básico...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Senhas da Cisco, migração de zona DNS, zero solicitações LDAP, coletamos pacotes Ethernet. Resolvendo problemas em uma rede com r0ot-mi. Parte 2</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/475280/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/ab/4d/wa/ab4dwaqym9eytqby-gg5z-ascjy.jpeg" alt="imagem"></div><br>  Este artigo resolverá vários outros problemas.  Links para outras partes abaixo. <br><br>  A primeira parte: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Ethernet, FTP, Telnet, HTTP, Bluetooth - o básico da análise de tráfego.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Resolvendo problemas em uma rede com r0ot-mi.</a> <br><br><div class="spoiler">  <b class="spoiler_title">Informações Organizacionais</b> <div class="spoiler_text">  Especialmente para aqueles que desejam aprender algo novo e se desenvolver em qualquer uma das áreas de segurança da informação e da informática, escreverei e falarei sobre as seguintes categorias: <br><br><ul><li>  PWN; </li><li>  criptografia (criptografia); </li><li>  tecnologias de rede (rede); </li><li>  reverso (engenharia reversa); </li><li>  esteganografia (estegano); </li><li>  pesquisa e exploração de vulnerabilidades na WEB. </li></ul><br>  Além disso, compartilharei minha experiência em análise forense de computadores, análise de malware e firmware, ataques a redes sem fio e redes locais, realização de protestos e explorações por escrito. <br><a name="habracut"></a><br>  Para que você possa descobrir sobre novos artigos, software e outras informações, criei um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">canal no Telegram</a> e um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">grupo para discutir quaisquer questões</a> no campo da CID.  Além disso, considerarei pessoalmente seus pedidos, perguntas, sugestões e recomendações <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">pessoais e responderei a todos</a> . <br><br>  Todas as informações são fornecidas apenas para fins educacionais.  O autor deste documento não se responsabiliza por nenhum dano causado a alguém como resultado do uso dos conhecimentos e métodos obtidos como resultado do estudo deste documento. <br></div></div><br><h2>  Senha da Cisco </h2><br><img src="https://habrastorage.org/webt/ch/wk/qj/chwkqjhwtrybty2fcvtbxaeexxw.png" alt="imagem"><br><br>  Somos solicitados a encontrar habilitar a senha e fornecer a configuração do Cisco. <br><br><img src="https://habrastorage.org/webt/jk/96/gj/jk96gjoz227psvj8yz3qlor7th8.png" alt="imagem"><br><br>  A configuração contém seu hash, vamos percorrê-lo.  Vou usar o hashcat. <br><br><pre><code class="bash hljs">hashcat -a 0 -m 500 cisco_hash rockyou.txt --force</code> </pre> <br><img src="https://habrastorage.org/webt/dj/lp/or/djlporhzmlbx8k-nmpj9576za3i.png" alt="imagem"><br><br>  E não encontramos a senha.  Vamos gritar com os outros.  Você pode usar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">este</a> site para <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">isso</a> . <br><br><img src="https://habrastorage.org/webt/bc/fw/-w/bcfw-w1eb_b5h81psbissrjb1wm.png" alt="imagem"><br><br><img src="https://habrastorage.org/webt/oy/eh/zf/oyehzfe3xlnjv4cpnqar8qf-_4i.png" alt="imagem"><br><br><img src="https://habrastorage.org/webt/np/gf/vv/npgfvvvm058plt9vsya5xrktvae.png" alt="imagem"><br><br>  Nós quebramos todas as senhas do Cisco tipo 7.  Vemos o padrão: 6sK0_ nome do usuário.  Vamos pegar um hash da linha 6sK0_enable de acordo com um princípio semelhante.  Primeiro, um pouco sobre o formato hash. <br><br><img src="https://habrastorage.org/webt/1n/qp/ev/1nqpevsvtiix3t8fc7cxler9blk.png" alt="imagem"><br><br>  Como você pode ver, o hash consiste em três partes.  A primeira parte é do tipo hash (neste caso, MD5, usamos no hashcat), a segunda e a terceira parte são salt e hash.  Nós usamos python. <br><br><img src="https://habrastorage.org/webt/as/wf/s4/aswfs4c05dcuypudijr0mpzjrkc.png" alt="imagem"><br><br>  Esse hash corresponde ao hash na configuração.  O problema está resolvido. <br><br><h2>  Transferência de zona DNS </h2><br><img src="https://habrastorage.org/webt/lx/og/la/lxoglai4yppfwyyzq5mfbiljkw4.png" alt="imagem"><br><br>  Como pode ser entendido a partir da tarefa, precisamos realizar a transferência da zona DNS. <br><br>  A transferência de zona DNS é um tipo de transação DNS.  É um dos mecanismos para sincronizar o conteúdo de vários bancos de dados DNS entre servidores.  As informações contidas na zona DNS podem ser consideradas confidenciais do ponto de vista da segurança operacional.  Por exemplo, os registros de recursos podem conter informações de função de servidor ou impressões digitais de chave SSH. <br><br>  Você pode transferir uma zona usando o programa dig, onde especificamos o host, porta, tipo de transação - axfr e domínio. <br><br><pre> <code class="bash hljs">dig @challenge01.root-me.org -p 54011 axfr ch11.challenge01.root-me.org</code> </pre> <br><img src="https://habrastorage.org/webt/wo/t6/nn/wot6nnuruoyfohw38yshijmp2hs.png" alt="imagem"><br><br>  Nós recebemos a chave secreta. <br><br><h2>  IP TTL </h2><br><img src="https://habrastorage.org/webt/0s/d1/b1/0sd1b1a5piqaenjpsp2lhqmel4g.png" alt="imagem"><br><br>  Eles nos fornecem um despejo de tráfego e são solicitados a encontrar o TTL usado para alcançar o host de destino.  É muito fácil  Abrimos o dump e notamos que algumas respostas estão marcadas em preto, enquanto o TTL é 11 e 12. Quando a solicitação TTL é 13, a resposta vem sem erros.  Ou seja, o TTL desejado é 13. <br><br><img src="https://habrastorage.org/webt/m9/ju/3f/m9ju3fewgwjio2twawcgqqkrta8.png" alt="imagem"><br><br><h2>  Ligação nula LDAP </h2><br><img src="https://habrastorage.org/webt/so/tk/-y/sotk-yevgkk6jird0ozcu5idve8.png" alt="imagem"><br><br>  Precisamos acessar os dados, de onde será necessário descobrir o endereço de e-mail. <br><br>  O LDAP é um protocolo de acesso ao diretório facilmente extensível que usa TCP / IP e permite autenticação (ligação), pesquisa (pesquisa) e comparação (comparação), além de adicionar, alterar ou excluir entradas. <br><br>  O nome da tarefa sugere uma solicitação nula.  O fato é que essa solicitação não requer autenticação para receber informações.  Testaremos usando o programa ldapsearch.  Um pouco sobre as opções: precisamos especificar o host (-H), especificar a autenticação normal (-x), o nível de aninhamento da pesquisa (-s), neste caso, apenas na entrada raiz (base) e também o tipo de atributos - também procuraremos atributos do usuário (* ) e em operação (+). <br><br><img src="https://habrastorage.org/webt/s1/ox/7j/s1ox7jry-yprauf8erb1ap1lio0.png" alt="imagem"><br><br>  Como você pode ver, os atributos foram retornados para nós, o que significa que a suposição sobre a solicitação zero estava correta.  Além disso, namingContexts corresponde ao que é fornecido na tarefa. <br><br>  O endereço fornecido a nós está ausente de uma unidade organizacional.  Como a solicitação é zero, especificaremos o padrão anônimo. <br><br><img src="https://habrastorage.org/webt/qr/au/dg/qraudgfpldjlnvo0boxhykn5jd8.png" alt="imagem"><br><br>  Nós obtemos os dados onde encontramos o correio. <br><br><h2>  Autenticação SIP </h2><br><img src="https://habrastorage.org/webt/fa/ek/3v/faek3vou9fwfkczymfu0ot60zww.png" alt="imagem"><br><br>  Precisa encontrar uma senha.  Isso é muito fácil, pois a última coluna contém um hash ou uma senha.  Tentando PLAIN ... Encaixa ... <br><br><img src="https://habrastorage.org/webt/c0/mp/nj/c0mpnjbfk7ejnfq5qxbhrdqsn7i.png" alt="imagem"><br><br>  Eu argumentaria sobre a complexidade dessa tarefa e sua avaliação. <br><br><h2>  ETHERNET - Transmissão com patch </h2><br><img src="https://habrastorage.org/webt/ji/xu/ng/jixungvucfxnxsgg4am5rx4jp4e.png" alt="imagem"><br><br>  Recebemos pacotes em formato hexadecimal.  No último pacote, 10 bytes foram alterados, eles precisam ser restaurados.  A maneira mais conveniente de trabalhar com pacotes é no Wireshark.  Para carregar um despejo hexadecimal, você precisa trazê-lo para o seguinte formulário. <br><br><img src="https://habrastorage.org/webt/ro/yd/w7/roydw7cmqvnzo2yntzt_pljh5ta.png" alt="imagem"><br><br>  Em seguida, selecione Arquivo -&gt; Importar de hex ... <br><br><img src="https://habrastorage.org/webt/04/ye/jm/04yejmmxog8dnnzksqxhdyjljja.png" alt="imagem"><br><br>  Depois de baixar todos os pacotes, eles precisam ser combinados.  Para fazer isso, selecione Arquivo -&gt; Mesclar.  Agora temos a seguinte imagem. <br><br><img src="https://habrastorage.org/webt/xl/xg/bn/xlxgbniu7tuxdlrzvci7gbfptpi.png" alt="imagem"><br><br>  Examinamos quais bytes precisam ser restaurados. <br><br><img src="https://habrastorage.org/webt/sd/jz/h8/sdjzh8nqtslexyatxpzbssyy0om.png" alt="imagem"><br><br>  Levamos em conta 2 fatos.  O primeiro: três pacotes de solicitação e um pacote de resposta; o segundo: 1 e 3 pacotes são marcados com uma soma de verificação inválida. <br><br><img src="https://habrastorage.org/webt/z9/u9/dd/z9u9dd5wusdtntww7lpxrbn_lfs.png" alt="imagem"><br><br>  A partir disso, podemos concluir que estamos analisando a resposta do ICMPv6 à solicitação do segundo pacote.  Vamos começar o pedido.  Os primeiros 16 bytes são os endereços MAC do receptor e da fonte.  Retiramos do segundo pacote e trocamos de lugar, ou seja,  primeiros 2 bytes desconhecidos de f9f7.  Em seguida, vêm os tipos 8100 e 3a.  Em seguida, vêm os endereços IP da fonte e do receptor, também trocam do segundo pacote - fadab00b. <br><br>  O último byte é deixado.  Este é um tipo de mensagem ICMPv6. <br><br><img src="https://habrastorage.org/webt/jx/en/he/jxenhei76hxv48q9yftw4ba1vx8.png" alt="imagem"><br><br>  No segundo pacote de solicitação (128), temos resposta. <br><br><img src="https://habrastorage.org/webt/fe/by/rb/febyrbntkjcro8pqel56uygwple.png" alt="imagem"><br><br>  Ou seja, o último byte procurado é 81. Coletamos, enviamos, a resposta está correta. <br><br>  Mais e mais complicado ... Você pode se juntar a nós no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Telegram</a> .  Lá, você pode propor seus próprios tópicos e votar na escolha de tópicos para os seguintes artigos. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt475280/">https://habr.com/ru/post/pt475280/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt475268/index.html">Parametrização incerta como um método universal para criar arquitetura de aplicativos em C ++ e Java, no mínimo. o preço</a></li>
<li><a href="../pt475270/index.html">SwiftUI: Criando seções expansíveis / recolhíveis na exibição de lista</a></li>
<li><a href="../pt475272/index.html">Migrando para a infraestrutura de espera assíncrona no Rust</a></li>
<li><a href="../pt475276/index.html">Como escrever afirmar corretamente</a></li>
<li><a href="../pt475278/index.html">Como espiar um hacker enquanto um hacker espia você</a></li>
<li><a href="../pt475284/index.html">Gerente de um minuto e macacos, compêndio</a></li>
<li><a href="../pt475286/index.html">Trigeneração: uma alternativa ao suprimento centralizado de energia</a></li>
<li><a href="../pt475288/index.html">Discriminação de funcionários por idade - implacável e sem sentido</a></li>
<li><a href="../pt475290/index.html">Club of Santa Cláusulas anônimas 2019-2020 on Habrahabr</a></li>
<li><a href="../pt475294/index.html">DevOops 2019 através dos olhos do desenvolvedor</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>