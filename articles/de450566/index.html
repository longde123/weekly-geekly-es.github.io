<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🍈 🌮 🤩 OutOfMemory und die Verwendung von Vektorbildern in Android Studio 🤸🏻 👩🏾‍🤝‍👩🏽 🥑</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hallo Habr! In diesem Artikel, der sich an Anfänger richtet, möchte ich einige Tipps zur Optimierung der Nutzung des Gerätespeichers durch die Anwendu...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>OutOfMemory und die Verwendung von Vektorbildern in Android Studio</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/450566/">  Hallo Habr!  In diesem Artikel, der sich an Anfänger richtet, möchte ich einige Tipps zur Optimierung der Nutzung des Gerätespeichers durch die Anwendung geben, um OutOfMemory nicht ständig abzurufen, und auch die Verwendung von Vektorgrafiken in der aktuellen Version von Android Studio (3.4) in Betracht ziehen, da die meisten russischsprachigen Ressourcen diesbezüglich Das Thema (der letzte <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Artikel</a> über Habré über Vektorbilder stammt aus dem Jahr 2015) ist veraltet, was unerfahrene Entwickler häufig in die Irre führt.  Also fangen wir an. <br><a name="habracut"></a><br><h3>  1. Verwenden Sie Vektorbilder anstelle von Bitmaps </h3><br>  Natürlich sollten große Bilder mit vielen kleinen Details nicht in einen Vektor konvertiert werden - dies nimmt genauso viel Platz ein wie ein Raster, wenn nicht sogar mehr.  Kleine Bilder wie Symbole und andere Details der Benutzeroberfläche sollten jedoch in einen Vektor konvertiert werden, um Speicherplatz zu sparen.  Und das Arbeiten mit <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Vektorbildern ist</a> oft viel bequemer.  Und jetzt das Wichtigste - wie geht das? <br><br><ol><li>  Öffnen Sie Android Studio. </li><li>  Klicken Sie mit der rechten Maustaste auf den Zeichenordner oder dessen Inhalt&gt; Neu&gt; Vektor-Asset <br><br><img src="https://habrastorage.org/webt/yd/yx/nz/ydyxnzofoc2w58vidp0v7kj2pm0.jpeg"></li><li>  Geben Sie den Pfad zu Ihrer SVG-Datei an.  Wenn Ihr Bild eine unregelmäßige Form hat, empfehlen wir Ihnen, das Kontrollkästchen neben dem Parameter Überschreiben zu aktivieren. Andernfalls wird das Bild auf Standardgrößen angepasst, wodurch die Proportionen verzerrt werden können. <br><br><img src="https://habrastorage.org/webt/zw/nx/8j/zwnx8jptjsjvvipavpn5an0v4de.jpeg"></li><li>  Weiter&gt; Fertig stellen </li><li>  Fertig! </li></ol><br>  Für die Konvertierung von Raster zu Vektor kann ich eine hervorragende kostenlose <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Inkscape-</a> Anwendung empfehlen.  Ein wenig über die Arbeit mit ihm: <br><br><ol><li>  Öffnen Sie Inkscape. </li><li>  Ziehen Sie ein beliebiges Raster hinein.  Wählen Sie im folgenden Fenster die Importoptionen aus und klicken Sie auf OK. </li><li>  Wählen Sie in der oberen Symbolleiste nach Auswahl unseres Bildes Pfad&gt; Raster vektorisieren (Umschalt + Alt + B). </li><li>  Nun das Wichtigste.  Aktivieren Sie im neuen Fenster das Kontrollkästchen neben "Hintergrund entfernen" und wählen Sie Folgendes aus: ob unser Bild farbig ist und wie viele Scans durchgeführt werden sollen.  Wir dürfen nicht vergessen, dass die Größe unserer Vektordatei direkt von diesen beiden Parametern abhängt. <br><br>  Mehr Scans - mehr Farben, Schattierungen und Details.  Mein Kobold, um ein göttliches Aussehen zu erhalten, waren aufgrund der größeren Anzahl von Farben im Bild 30 Scans erforderlich.  Das ist ziemlich viel, es ist besser, nicht mehr als zehn zu machen und Bilder einfacher auszuwählen. <br><br><img src="https://habrastorage.org/webt/k-/qk/a3/k-qka3pfsclaxmfx5z0lkql_uiq.jpeg"></li><li>  Schließen Sie das Fenster, klicken Sie auf das Raster und löschen Sie es mit der Entf-Taste. Gehen Sie zu Datei&gt; Dokumenteigenschaften (Umschalt + Strg + D) und passen Sie die Seitengröße für den Inhalt an. </li></ol><br>  Jetzt werden wir einen kleinen Test durchführen, der den Vorteil des Vektors beim Speichern von Speicher belegt. <br>  Ich habe ein neues Projekt mit einer einzelnen ImageView erstellt, auf das ich eine Animation angewendet habe, die es von Punkt A nach Punkt B verschiebt und die Bilder abwechselnd in Raster und Vektor ändert.  Wir schauen uns die Daten an. <br><br>  Raster <br><br><img src="https://habrastorage.org/webt/1m/dc/zl/1mdczltjsqgifnfhtxjignty6o0.jpeg"><br><br>  Vektor <br><br><img src="https://habrastorage.org/webt/ez/hm/oq/ezhmoqzzrltr5pinghsv8r-0e4a.jpeg"><br><br>  Der Unterschied ist fast zweimal.  Ich finde das ziemlich überzeugend. <br><br><h3>  2. Erhöhen Sie die Heap-Größe </h3><br>  Wechseln Sie dazu zum Manifest Ihres Projekts (App&gt; Manifeste&gt; AndroidManifest.xml) und fügen Sie die Zeile in die Anwendungsspalte ein: <br><br><pre><code class="xml hljs">android:largeHeap="true"</code> </pre> <br>  Tatsächlich ist das Erhöhen des Heaps keine Lösung für das OutOfMemory-Problem, sondern das Verschieben in den hinteren Bereich.  Anstatt die Nutzung des Gerätespeichers durch die Anwendung zu optimieren, geben wir ihm mehr Speicherplatz.  Vergessen Sie nicht, dass jedes Gerät über eine eigene primäre und sekundäre Speicherkapazität für die Anwendung verfügt. <br><br><h3>  3. Vermeiden Sie Speicherlecks </h3><br>  Jede Anwendung in ihrer Arbeit verwendet viele Objekte, die natürlich einen bestimmten Platz im Gedächtnis einnehmen.  Im Idealfall sollte der Garbage Collector nicht verwendete Objekte daraus entfernen. Manchmal gibt es jedoch sogenannte „Speicherlecks“, die schwerwiegende Probleme in der Anwendung verursachen.  Es gibt verschiedene Ursachen für Speicherlecks, die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> ausführlich beschrieben <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">werden</a> . <br><br>  Ich selbst möchte die von Badoo entwickelte <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">WeakHandler-</a> Bibliothek <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">empfehlen</a> , die Speicherlecks im Zusammenhang mit dem Missbrauch von android.os.Handler beseitigen soll.  Um diese Bibliothek zu verwenden, fügen Sie der Spalte "Abhängigkeiten" in Ihrer Gradle-Datei die folgende Zeile hinzu (Gradle-Skripte&gt; build.gradle (Modul: App)): <br><br><pre> <code class="xml hljs">compile 'com.badoo.mobile:android-weak-handler:1.1'</code> </pre> <br>  und in der Java-Datei: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> WeakHandler mHandler; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Bundle savedInstanceState)</span></span></span><span class="hljs-function"> </span></span>{ mHandler = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> WeakHandler(); ... } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onClick</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(View view)</span></span></span><span class="hljs-function"> </span></span>{ mHandler.postDelayed(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Runnable() { view.setVisibility(View.INVISIBLE); }, <span class="hljs-number"><span class="hljs-number">5000</span></span>); }</code> </pre> <br>  Und vergessen Sie nicht, WeakHandler selbst zu importieren, wenn das Studio dies nicht automatisch getan hat. <br><br><h3>  4. Vermeiden Sie große Zeitrafferanimationen </h3><br>  Frame-für-Frame-Animationen in Android Studio sind praktisch, aber nicht die wirtschaftlichste.  Wenn Sie eine große Anzahl von Bildern verwenden, erhalten Sie mit Sicherheit OutOfMemory. <br><br>  Wenn Sie es jedoch wirklich benötigen, ist es besser, das GIF-Bild zusammen mit der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Android Gif Drawable-</a> Bibliothek zu verwenden.  Diese Bibliothek vereinfacht die Arbeit mit Gifs und verbraucht viel weniger Speicher als Einzelbildanimationen von Android Studio.  Um diese Bibliothek zu verwenden, fügen Sie der Spalte "Abhängigkeiten" in Ihrer Gradle-Datei die folgende Zeile hinzu (Gradle-Skripte&gt; build.gradle (Modul: App)): <br><br><pre> <code class="xml hljs">implementation 'pl.droidsonroids.gif:android-gif-drawable:1.2.16'</code> </pre> <br>  und in Ihrer zweiten Gradle-Datei (Gradle-Skripte&gt; build.gradle (Modul: „Ihr Anwendungsname“)) in den Buildscript- und allproject-Spalten die Zeile: <br><br><pre> <code class="xml hljs">mavenCentral()</code> </pre> <br>  und in der Java-Datei: <br><br><pre> <code class="java hljs">GifDrawable gifFromResource = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GifDrawable( getResources(), R.drawable._ ); gifFromResource.start();</code> </pre><br>  Um gif zu deaktivieren, schreiben Sie anstelle von start () stop ().  Vergessen Sie auch nicht, Gifs zu komprimieren, dies spart noch mehr Platz. <br><br>  Ich hoffe, dass mein Artikel für Sie nützlich war.  Vielen Dank. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de450566/">https://habr.com/ru/post/de450566/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de450550/index.html">Teil 4. Karriereprogrammierer. Junior. Freiberuflicher Einstieg</a></li>
<li><a href="../de450552/index.html">Wir zeigen das Labor "Advanced Nanomaterials and Optoelectronic Devices" der ITMO University</a></li>
<li><a href="../de450554/index.html">Das Entwurfsmuster brechen - Singleton in PHP</a></li>
<li><a href="../de450556/index.html">Ventilindex - Überprüfung des neuen VR-Sets</a></li>
<li><a href="../de450564/index.html">Glitzer und Armut: Wie die digitale Revolution Musiker ärmer machte</a></li>
<li><a href="../de450568/index.html">Jedes Gift hat sein eigenes Gegenmittel. Wie man spart oder zumindest versucht (upd: über Gegenmittel gegen häusliche Vergiftungen)</a></li>
<li><a href="../de450572/index.html">Samba DC als zweiter Controller in der AD-Domäne von Windows 2012R2 und Roaming-Ordnern für Clients unter Windows und Linux</a></li>
<li><a href="../de450574/index.html">Erstellen Sie ein Multiplayer-.io-Webspiel</a></li>
<li><a href="../de450576/index.html">Neue Regeln für die Anonymität von Messenger</a></li>
<li><a href="../de450578/index.html">Was ist in der Luft zu hören? Wir empfangen und decodieren die interessantesten Signale. Teil 2, UKW</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>