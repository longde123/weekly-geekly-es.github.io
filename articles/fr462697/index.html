<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë∂üèº üí≤ üõ¨ uWSGI pour aider les m√©triques. Rapport Yandex ü•î üßëüèæ‚Äçü§ù‚Äçüßëüèª üí´</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="L'autre jour, le Meetup # 66 de Moscou Python a eu lieu - la communaut√© continue de discuter des outils pertinents qui am√©liorent le langage et l'adap...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>uWSGI pour aider les m√©triques. Rapport Yandex</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yandex/blog/462697/">  L'autre jour, le Meetup # 66 de Moscou Python a eu lieu - la communaut√© continue de discuter des outils pertinents qui am√©liorent le langage et l'adaptent √† diff√©rents environnements.  Y compris √† la r√©union, mon rapport a √©t√© fait.  Je m'appelle Nail, je fais Yandex.Connect. <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/oh/bd/zt/ohbdztka-hxtbhnhb8gz2g1ohmc.jpeg"></a> <br><br>  L'histoire que j'ai pr√©par√©e concernait uWSGI.  Il s'agit d'un serveur d'applications Web multifonctionnel, et chaque application moderne est accompagn√©e de m√©triques.  J'ai essay√© de montrer comment les capacit√©s de uWSGI peuvent aider √† collecter des m√©triques. <br><br><a name="habracut"></a>  - Bonjour √† tous, je suis heureux de vous accueillir tous sur les murs de Yandex.  C'est bien que tant de gens soient venus voir mes rapports et d'autres, que tant de gens soient int√©ress√©s et vivent en Python.  Quel est mon rapport?  Il est appel√© "uWSGI pour aider les m√©triques".  Je vais vous parler un peu de moi.  Je fais du Python depuis six ans, je travaille dans l'√©quipe Yandex.Connect, nous √©crivons une plateforme commerciale qui fournit des services Yandex d√©velopp√©s en interne pour des utilisateurs externes, c'est-√†-dire pour tout le monde.  Toute personne ou organisation peut utiliser les produits d√©velopp√©s par Yandex pour elle-m√™me, √† ses propres fins. <br><br>  Nous parlerons des m√©triques, comment obtenir ces m√©triques, comment nous utilisons dans notre √©quipe uWSGI comme outil pour obtenir des m√©triques, comment cela nous aide.  Ensuite, je vais vous raconter une petite histoire d'optimisation. <br><br>  Quelques mots sur les m√©triques.  Comme vous le savez, le d√©veloppement d'une application moderne est impossible sans tests.  Il est √©trange que quelqu'un d√©veloppe ses applications sans tests.  En m√™me temps, il me semble que le fonctionnement d'une application moderne est impossible sans m√©triques.  Notre application est un organisme vivant.  Une personne peut prendre certaines mesures, telles que la pression, la fr√©quence cardiaque, - l'application a √©galement des indicateurs qui nous int√©ressent et que nous aimerions observer.  Contrairement √† une personne qui prend g√©n√©ralement ces mesures vitales lorsqu'elle se sent mal, dans le cas d'une application, nous pouvons toujours les prendre. <br><br><img src="https://habrastorage.org/webt/gm/3s/oi/gm3soikaaai-tmfoi6mf7_u3waq.jpeg"><br><br>  Pourquoi prenons-nous des mesures?  Au fait, qui utilise les m√©triques?  J'esp√®re qu'apr√®s mon rapport, il y aura plus de mains, et que les gens seront int√©ress√©s et commenceront √† collecter des m√©triques, ils comprendront que cela est n√©cessaire et utile. <br><br>  Alors pourquoi avons-nous besoin de mesures?  Tout d'abord, nous voyons ce qui se passe avec le syst√®me, nous mettons en √©vidence certains indicateurs normatifs pour notre syst√®me et comprenons si nous allons au-del√† de ces indicateurs pendant le processus de candidature ou non.  Vous pouvez voir un comportement anormal du syst√®me, par exemple, une augmentation du nombre d'erreurs, comprendre ce qui ne va pas avec le syst√®me, avant nos utilisateurs et recevoir des messages sur les incidents non pas des utilisateurs, mais du syst√®me de surveillance.  Sur la base de mesures, nous pouvons configurer des alertes et recevoir des SMS, des lettres, des appels, comme vous le souhaitez. <br><br><img src="https://habrastorage.org/webt/sw/1a/ru/sw1arunikx2d6u7ngqaiofuqfvo.jpeg"><br><br>  Quelles sont, en r√®gle g√©n√©rale, les mesures?  Ce sont des chiffres, peut-√™tre un compteur qui cro√Æt de fa√ßon monotone.  Par exemple, le nombre de demandes.  Certaines valeurs unitaires qui changent dans le temps augmentent ou diminuent.  Un exemple est le nombre de t√¢ches dans une file d'attente.  Ou des histogrammes - des valeurs qui tombent dans certains intervalles, les soi-disant paniers.  En r√®gle g√©n√©rale, il est pratique de lire ces donn√©es temporelles et de savoir dans quel intervalle de temps le nombre de valeurs convient. <br><br><img src="https://habrastorage.org/webt/ba/in/dk/baindkmahmhfz9-wq20ahlm4oyg.jpeg"><br><br>  Quel type de mesures pouvons-nous prendre?  Je vais me concentrer sur le d√©veloppement d'applications web, car il est plus proche de moi.  Par exemple, nous pouvons filmer le nombre de demandes, nos points de terminaison, le temps de r√©ponse de nos points de terminaison, les codes de r√©ponse des services associ√©s, si nous y allons et que nous avons une architecture de microservice.  Si nous utilisons le cache, nous pouvons comprendre l'efficacit√© du cache miss ou hit, comprendre la distribution des temps de r√©ponse des deux serveurs tiers et, par exemple, de la base de donn√©es.  Mais pour voir les m√©triques, vous devez en quelque sorte les collecter. <br><br><img src="https://habrastorage.org/webt/4f/x3/9a/4fx39auteviuwx9dfiefacsjz_q.jpeg"><br><br>  Comment pouvons-nous les collecter?  Il existe plusieurs options.  Je veux vous parler de la premi√®re option - un sch√©ma push.  En quoi cela consiste-t-il? <br><br>  Supposons que nous recevions une demande d'un utilisateur.  Localement, avec notre application, nous installons une sorte, g√©n√©ralement un agent push.  Disons que nous avons un Docker, qu'il contient une application et qu'un agent push se tient toujours en parall√®le.  L'agent push re√ßoit localement la valeur des m√©triques, il les met en m√©moire tampon, cr√©e des lots et les envoie au syst√®me de stockage des m√©triques. <br><br>  Quel est l'avantage d'utiliser des sch√©mas push?  Nous pouvons envoyer des m√©triques directement de l'application au syst√®me m√©trique, mais en m√™me temps, nous obtenons une sorte d'interaction r√©seau, de latence, de surcharge pour collecter des m√©triques.  Dans le cas d'un client push local, cela est nivel√©. <br><br><img src="https://habrastorage.org/webt/n5/ff/o7/n5ffo732rxl3styovoxwmjnffim.jpeg"><br><br>  Une autre option est un sch√©ma de tirage.  Avec le sch√©ma de traction, nous avons le m√™me sc√©nario.  Une demande de l'utilisateur nous parvient, nous la gardons en quelque sorte √† la maison.  Et puis avec une certaine fr√©quence - une fois par seconde, une fois par minute, comme cela vous convient - le syst√®me de collecte de m√©triques arrive √† un point final sp√©cial de notre application et prend ces indicateurs. <br><br><img src="https://habrastorage.org/webt/ob/xy/88/obxy88kzj0owhgydp-kr02gisx0.jpeg"><br><br>  Une autre option est les journaux.  Nous √©crivons tous des journaux et les envoyons quelque part.  Rien ne nous emp√™che de prendre ces journaux, de les traiter en quelque sorte et d'obtenir des mesures bas√©es sur les journaux. <br><br>  Par exemple, nous √©crivons le fait de la demande d'un utilisateur dans le journal, puis nous prenons les journaux, hop-hop, compt√©s.  Un exemple typique est ELK (Elasticsearch, Logstash, Kibana). <br><br><img src="https://habrastorage.org/webt/qb/r1/ji/qbr1ji36v03ahocy3_hj5wy7ihs.jpeg"><br><br>  Comment √ßa marche avec nous?  Yandex poss√®de sa propre infrastructure, son propre syst√®me de collecte de m√©triques.  Elle attend une r√©ponse standardis√©e pour une poign√©e qui impl√©mente un sch√©ma de traction.  De plus, nous avons un cloud interne o√π nous lan√ßons notre application.  Et tout cela est int√©gr√© dans un seul syst√®me.  Lors du t√©l√©chargement vers le cloud, nous indiquons simplement: "Acc√©dez √† ce stylet et obtenez les statistiques." <br><br><img src="https://habrastorage.org/webt/p7/ug/ls/p7uglskaraaguno_ngqnemhmbgc.jpeg"><br><br>  Voici un exemple de r√©ponse pour le sch√©ma d'extraction que notre syst√®me de collecte m√©trique attend. <br><br>  Pour nous-m√™mes dans l'√©quipe, nous avons d√©cid√© de choisir une mani√®re plus appropri√©e pour nous, de mettre en √©vidence plusieurs crit√®res selon lesquels nous choisirons la meilleure option pour nous.  L'efficacit√© est la rapidit√© avec laquelle nous pouvons obtenir dans le syst√®me m√©trique un affichage du fait de toute action.  D√©pendance - si nous devons installer des outils suppl√©mentaires ou configurer l'infrastructure d'une mani√®re ou d'une autre pour obtenir la m√©trique.  Et la polyvalence - comment cette m√©thode est adapt√©e √† diff√©rents types d'applications. <br><br><img src="https://habrastorage.org/webt/h2/ao/s4/h2aos4jq6iboqpi9ze3254om0rs.jpeg"><br><br>  C'est ce que nous avons finalement obtenu.  Bien que, selon les crit√®res d'efficacit√© et de polyvalence, le sch√©ma push gagnera.  Mais nous d√©veloppons une application Web, et notre cloud dispose d√©j√† d'une infrastructure pr√™te √† l'emploi pour travailler avec cette t√¢che, nous avons donc d√©cid√© de choisir un sch√©ma d'extraction pour nous-m√™mes.  Nous allons parler d'elle. <br><br>  Afin de donner quelque chose au sch√©ma de tirage, nous devons le pr√©-agr√©ger quelque part, l'enregistrer.  Notre syst√®me de surveillance entre dans des poign√©es de traction toutes les cinq secondes.  O√π pouvons-nous √©conomiser?  Localement dans votre m√©moire ou dans un stockage tiers. <br><br><img src="https://habrastorage.org/webt/pa/ft/sb/paftsbyryl5ojm43di6mhwrxge4.jpeg"><br><br>  Si nous enregistrons localement, alors en r√®gle g√©n√©rale, cela convient au cas avec un processus.  Et nous, dans notre uWSGI, ex√©cutons plusieurs processus en parall√®le.  Ou nous pouvons utiliser une sorte de stockage partag√©.  Qu'est-ce qui nous vient √† l'esprit avec le mot ¬´stockage partag√©¬ª?  Il s'agit d'une sorte de bases de donn√©es Redis, Memcached, relationnelles ou non relationnelles, ou m√™me d'un fichier. <br><br><img src="https://habrastorage.org/webt/ms/um/fb/msumfb5j3za1j6b7qxrklpnvww8.jpeg"><br><br>  √Ä propos d'uWSGI.  Permettez-moi de vous rappeler ceux qui l'utilisent peu ou rarement: uWSGI est un serveur Web d'applications qui vous permet d'ex√©cuter des applications Python sous vous.  Il impl√©mente l'interface, le protocole uWSGI.  Ce protocole est d√©crit dans PEP 333, qui sont int√©ress√©s, vous pouvez lire. <br><br><img src="https://habrastorage.org/webt/vg/ke/yy/vgkeyyiamyh4dfcbclpg-rhi17m.jpeg"><br><br>  Cela nous aidera √©galement √† choisir la meilleure solution Yandex.Tank.  Il s'agit d'un outil de test de charge qui vous permet de d√©cortiquer notre application avec diff√©rents profils de charge et de cr√©er de superbes graphismes.  Ou cela fonctionne dans la console, comme vous le souhaitez. <br><br><img src="https://habrastorage.org/webt/vl/79/jq/vl79jqtqnv8hgqvjeqhetqdzhpi.jpeg"><br><br>  Les exp√©riences.  Nous allons cr√©er une application synth√©tique pour nos tests synth√©tiques, nous la bombarderons avec un r√©servoir.  L'application uWSGI aura un conflit simple avec 10 travailleurs. <br><br><img src="https://habrastorage.org/webt/nk/ui/s4/nkuis4s4fgzpkj7tmvlchyn0dr4.jpeg"><br><br>  Voici notre application Flask.  La charge utile que notre application effectue, nous √©mulerons une boucle vide. <br><br><img src="https://habrastorage.org/webt/sc/d5/qt/scd5qtepls29c1u46xknxbcwfxm.jpeg"><br><br>  Nous tirons et Yandex.Tank nous donne l'un de ces graphiques.  Que montre-t-il?  Centiles de temps de r√©ponse.  La ligne oblique est le RPS qui grandit, et les histogrammes sont les centiles dans lesquels notre serveur Web s'int√®gre sous une telle charge. <br><br>  Nous prendrons cette option comme r√©f√©rence et examinerons comment les diff√©rentes options de stockage des m√©triques affectent les performances. <br><br><img src="https://habrastorage.org/webt/9d/j2/x_/9dj2x_mwlyb7ovl-e9y24nkey1c.jpeg"><br><br>  L'option la plus simple consiste √† utiliser PostgreSQL.  Parce que nous travaillons avec PostgreSQL, nous l'avons.  Utilisons ce qui est d√©j√† pr√™t. <br><br>  Disons que nous avons une √©tiquette dans PostgreSQL dans laquelle nous incr√©mentons simplement le compteur. <br><br><img src="https://habrastorage.org/webt/_7/zx/ja/_7zxjarhpil1cwhzw2q-b1j48rg.jpeg"><br><br>  D√©j√† sur de petites quantit√©s de RPS, nous constatons une forte d√©gradation des performances.  On peut dire juste √©norme. <br><br><img src="https://habrastorage.org/webt/ox/c7/tm/oxc7tm1_kizqnqdli6rkzunqeau.jpeg"><br><br>  L'option suivante est Redis.  Mais ici, nous faisons plus intelligemment: nous l'installons localement et nous y acc√©dons non pas via le r√©seau, mais via le socket Unix.  Augmentez √©galement le compteur. <br><br><img src="https://habrastorage.org/webt/6k/zv/wv/6kzvwvil-aitqzp2rdys3ggjz5e.jpeg"><br><br>  On obtient l'histogramme des temps de r√©ponse en sortie.  Nous voyons que les choses vont mieux ici, mais √† un moment donn√©, nous nous heurtons √† une √©tag√®re, puis la productivit√© n'augmente plus.  Cette option semble plus optimale, mais nous voulons faire encore mieux. <br><br><img src="https://habrastorage.org/webt/ts/xs/m7/tsxsm7cnr7qsk0-aydibqnsmobg.jpeg"><br><br>  Ici uWSGI, une v√©ritable moissonneuse-batteuse, vient √† notre secours.  Il existe de nombreux modules diff√©rents.  Mule pour ex√©cuter les sous-processus, le cadre de mise en cache, le cron, le sous-syst√®me de m√©triques et le syst√®me d'alerte.  ¬´Syst√®me de mesure des sous-syst√®mes¬ª - semble prometteur. <br><br><img src="https://habrastorage.org/webt/xt/rd/ip/xtrdipfn_v0kmanjjipkuc2fd_w.jpeg"><br><br>  Elle sait comment ajouter une sorte de m√©trique, augmenter le compteur, diminuer le compteur, multiplier, diviser - tout ce que votre c≈ìur d√©sire. <br><br>  Le seul sous-syst√®me de m√©trique n'est pas en mesure de donner exactement les m√©triques int√©gr√©es. <br><br>  Pourquoi est-ce important pour nous?  Comme vous l'avez vu plus t√¥t, nous avons une poign√©e pour donner des statistiques dans un format sp√©cifique, et plusieurs travailleurs sont en cours d'ex√©cution.  Nous ne savons pas lequel des employ√©s recevra la demande, mais pour renvoyer toutes les mesures, nous devons cr√©er une sorte de registre de noms et le brouiller d'une mani√®re ou d'une autre entre les processus.  C'est un gros probl√®me, je veux √©viter cela.  Qu'avons-nous d'autre? <br><br><img src="https://habrastorage.org/webt/tu/st/ir/tustir9lyytiuq5noxzeosk7uyq.jpeg"><br><br>  Bien s√ªr, sous-syst√®me de cache.  Et nous voyons ici: il peut faire presque la m√™me chose, et est √©galement capable de donner les noms des cl√©s stock√©es dans le cache.  Voil√† ce dont vous avez besoin. <br><br><img src="https://habrastorage.org/webt/4l/le/um/4lleum60xf9n635wiue31dvaptk.jpeg"><br><br>  Le sous-syst√®me de cache est un cache int√©gr√© √† uWSGI.  Un module rapide et thread-safe, qui est un stockage de valeur-cl√© ordinaire. <br><br><img src="https://habrastorage.org/webt/gf/a3/w4/gfa3w4hje0atgnlctpzdr6n1hcg.jpeg"><br><br>  Mais puisqu'il s'agit d'un cache, il y a un deuxi√®me probl√®me bien connu: comment nommer une variable et comment invalider le cache?  Dans notre cas, voyons quels sont les param√®tres de cache par d√©faut.  Il a des restrictions sur la longueur de la cl√©.  Dans notre cas, il s'agit du nom de la m√©trique.  La valeur par d√©faut est 2048 octets.  Et vous pouvez augmenter la configuration si n√©cessaire.  Le nombre d'√©l√©ments qu'il stocke par d√©faut est de 65 536. Il semble que cette valeur devrait √™tre suffisante pour tout le monde.  Il est peu probable que quiconque collecte un tel nombre de m√©triques √† partir de son application. <br><br>  Et ttl par d√©faut est 0. Autrement dit, les valeurs des caches stock√©s ne sont pas invalid√©es dans le temps.  Ainsi, nous pouvons les r√©cup√©rer dans le cache et les envoyer au syst√®me de m√©triques. <br><br><img src="https://habrastorage.org/webt/nb/q8/zu/nbq8zuosdcqk0rss824oiweqifc.jpeg"><br><br>  Encore une fois, l'option est une application qui utilise la bo√Æte uWSGI. <br><br><img src="https://habrastorage.org/webt/v6/ri/fb/v6rifbjrax-igqz5bfpn2m5powu.jpeg"><br><br>  Voici les r√©sultats du d√©corticage de cette application. <br><br><img src="https://habrastorage.org/webt/qs/dg/0-/qsdg0-_dj_bqttsbdoewg5rcps8.jpeg"><br><br>  Le r√©sultat sans m√©triques, si avec uWSGI, avec un √©tirement, il ressemble presque au m√™me. <br><br><img src="https://habrastorage.org/webt/lw/xp/xz/lwxpxzc2jf-hyfnx4fcysnfmrfi.jpeg"><br><br>  Comme vous pouvez le voir, dans le cas de uWSGI, nous ne perdons que 5% des performances par rapport √† la version "vanille" sans m√©triques.  D'autres options ont un tirage assez important et, par cons√©quent, √† la suite du vote des spectateurs, uWSGI gagne. <br><br><img src="https://habrastorage.org/webt/xw/sg/hf/xwsghfrlb5z8kwt_kzv4mgvxjhe.jpeg"><br><br>  Comment avons-nous appliqu√© cela?  Nous avons √©crit une petite biblioth√®que, un wrapper autour de uWSGI.  Par exemple, nous installons une instance de notre biblioth√®que et ici nous ajoutons la m√©trique ¬´heure de requ√™te de base de donn√©es¬ª comme exemple. <br><br><img src="https://habrastorage.org/webt/jh/k2/qa/jhk2qajtaazyhqvckbyi63r8iiy.jpeg"><br><br>  Nous souhaitons √©galement suivre le fonctionnement du cache.  Nous red√©finissons simplement les m√©thodes du client memca, √©conomisons le temps de recevoir des donn√©es, le temps de t√©l√©chargement et le nombre de cache hit et cache cache miss. <br><br><img src="https://habrastorage.org/webt/6r/cy/v7/6rcyv7zh51cjphtabkfhwwgjui4.jpeg"><br><br>  Comment faisons-nous cela √† l'int√©rieur de la biblioth√®que?  Pour exp√©dier les valeurs, nous obtenons les noms des cl√©s stock√©es dans le cache, les parcourons et les donnons simplement au format souhait√© au point de terminaison. <br><br><img src="https://habrastorage.org/webt/3g/ts/y-/3gtsy-g-qfq9ro1h71j_pjkhtk0.jpeg"><br><br>  En cons√©quence, nous obtenons un graphique, dans ce cas, il s'agit du 99e centile du temps d'acc√®s au cache, en lecture et en √©criture. <br><br><img src="https://habrastorage.org/webt/ho/fg/td/hofgtdq1ewg1qoqabjpid3ukpds.jpeg"><br><br>  Ou, en option, le nombre de demandes de service tiers √† notre API. <br><br><img src="https://habrastorage.org/webt/dk/ba/zw/dkbazwujnh0sq9uf2uyj6wmgy_o.jpeg"><br><br>  Nous avons des histoires d‚Äô√©chec et de succ√®s.  Nous avons commenc√© √† ajouter de plus en plus de mesures et nous avons constat√© une baisse des performances.  Les param√®tres eux-m√™mes nous ont aid√©s.  Si vous collectez des mesures, vous pouvez voir que quelque chose ne va pas.  Par cons√©quent, je vous recommande √©galement de regarder r√©trospectivement les m√©triques que vous avez accumul√©es au cours de la semaine, du mois, de six mois.  Et voyez quelle tendance votre application montre dans quels indicateurs.  Nous avons r√©alis√© que nous avons commenc√© √† nous reposer sur le calcul des m√©triques. <br><br><img src="https://habrastorage.org/webt/if/k_/uc/ifk_ucasa_eegw5jangcb-oudwm.jpeg"><br><br>  Le profilage nous a aid√©s.  Ici, vous voyez un graphique de flamme, il nous montre visuellement combien d'appels de diff√©rentes fonctions ont pris au cours du processus, lesquels appels ont apport√© la plus grande contribution dans le temps.  Nous avons r√©alis√© que nous n'avions pas tr√®s bien r√©ussi dans la premi√®re version √† l'aide de cornichons.  √Ä l'int√©rieur de notre biblioth√®que, elle a pass√© beaucoup de temps √† d√©caper. <br><br><img src="https://habrastorage.org/webt/kd/xn/nm/kdxnnm1oaklpbbsdoiw48yljkc8.jpeg"><br><br>  Nous avons refus√© le d√©capage, transf√©r√© √† cashe inc, tout mesur√©, c'est devenu plus rapide. <br><br><img src="https://habrastorage.org/webt/fp/v_/qe/fpv_qetjlbsj1dcgt4wo2z3xr2q.jpeg"><br><br>  Dans la nouvelle impl√©mentation, nous passons la plupart de notre temps √† travailler avec le cache, pas √† d√©caper. <br><br><img src="https://habrastorage.org/webt/ju/x2/cs/jux2cs4k52ekeeqalcaeltpawkc.jpeg"><br><br>  Pourquoi je te dis √ßa?  Je vous invite √† commencer √† collecter des m√©triques, √† les surveiller et √† vous concentrer sur les m√©triques.  Lorsque vous choisissez une option de collecte de m√©triques possible, comparez les options, voyez celle qui vous convient le mieux.  Et, bien s√ªr, le profilage est bon.  Si vous voyez que quelque chose ne va pas, quelque chose ralentit - profil. <br><br>  Merci √† tous!  Comme je l'ai promis, les r√©f√©rences: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Yandex.Tank</a> , </li><li>  utilitaire de profilage <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">py-spy</a> √©crit en Rust, </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">rapport d'</a> Alexander Koshelev sur l'utilisation de uWSGI. </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr462697/">https://habr.com/ru/post/fr462697/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr462687/index.html">Nouveau panneau de contr√¥le d'h√©bergement d'ISPsystem: comment voir</a></li>
<li><a href="../fr462689/index.html">DISKOBALL: comp√©titions de lancer de disques durs, 23 ao√ªt, Moscou</a></li>
<li><a href="../fr462691/index.html">Comment migrer d'AD vers LDAP lors de l'utilisation de Zimbra</a></li>
<li><a href="../fr462693/index.html">En route vers des applications durables avec le g√©n√©rateur de site statique PSKOV comme exemple</a></li>
<li><a href="../fr462695/index.html">Mat√©riel en tant que composants Web</a></li>
<li><a href="../fr462699/index.html">Maillage de service, ¬´Plan de donn√©es¬ª et ¬´Plan de contr√¥le¬ª (Plan de donn√©es de maillage de service par rapport au plan de contr√¥le)</a></li>
<li><a href="../fr462701/index.html">Biblioth√®que de g√©n√©rateur de code assembleur pour microcontr√¥leurs AVR. 2e partie</a></li>
<li><a href="../fr462703/index.html">Le tourniquet ¬´le moins cher¬ª de Russie contr√¥l√© depuis un smartphone</a></li>
<li><a href="../fr462705/index.html">Top 5 des bugs dans mes applications ReactJS</a></li>
<li><a href="../fr462707/index.html">Kubernetes lance les outils de d√©veloppement d'applications</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>