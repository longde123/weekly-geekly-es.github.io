<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧀 👩‍❤️‍👨 🛫 Interaksi dengan server melalui API di iOS pada Swift 3. Bagian 2 🤶🏿 👩🏿‍🤝‍👨🏻 👩‍🔧</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Artikel ini adalah kelanjutan dari artikel Berinteraksi dengan server melalui API di iOS pada Swift 3. Bagian 1 dan memperbarui artikel lama yang ditu...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Interaksi dengan server melalui API di iOS pada Swift 3. Bagian 2</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/415615/">  Artikel ini adalah kelanjutan dari artikel <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Berinteraksi dengan server melalui API di iOS pada Swift 3. Bagian 1</a> dan memperbarui <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">artikel lama yang</a> ditulis dalam Objective-C pada swift 3. <br><br><h2>  Teori singkat </h2><br><h3>  DAPATKAN permintaan </h3><br>  GET adalah metode permintaan HTTP paling sederhana, dan itulah yang digunakan browser untuk memuat halaman web.  Ini digunakan untuk meminta konten yang terletak di URL tertentu.  Konten tersebut mungkin, misalnya, halaman web, gambar, atau file audio.  Secara konvensi, permintaan GET bersifat hanya-baca dan, sesuai dengan standar W3C, tidak boleh digunakan dalam operasi yang mengubah sisi server.  Misalnya, kami tidak akan menggunakan permintaan GET untuk mengirim formulir atau mengirim foto, karena operasi ini memerlukan beberapa perubahan di sisi server (kami akan menggunakan POST dalam kasus ini). <br><br><h3>  Permintaan POST </h3><br>  POST mengirim data untuk diproses lebih lanjut ke URL.  Parameter dimasukkan dalam badan permintaan menggunakan format yang sama dengan GET.  Misalnya, jika kami ingin memposting formulir yang berisi dua bidang, nama dan usia, maka kami akan mengirim sesuatu yang mirip dengan nama = Martin &amp; umur = 29 di badan permintaan. <br><br>  Metode pengiriman parameter ini banyak digunakan di halaman web.  Kasus yang paling populer adalah formulir.  Ketika kami mengisi formulir di situs dan klik Kirim, kemungkinan besar permintaan akan POST. <br><a name="habracut"></a><br>  Dalam aplikasi kami, kami menggunakan POST untuk membuat peringkat lelucon.  Kami akan mengirimkan suara (atau +1, atau -1) ke server jarak jauh. <br><br>  Data permintaan POST dapat disusun menggunakan berbagai format.  Parameter biasanya diformat sesuai dengan standar pengkodean form-url (sesuai dengan standar HTML W3C).  Ini adalah format default dan banyak digunakan di banyak browser.  Metode kami menerima kamus Kamus sebagai argumen, tetapi kami tidak dapat mengirim kamus Kamus melalui koneksi HTTP karena ini adalah tipe Swift internal.  Untuk meneruskan koneksi HTTP, kita perlu membuat representasi kamus yang dapat dikenali.  Ini seperti berkomunikasi dengan orang asing.  Kami menerjemahkan pesan kami ke dalam bahasa universal, dan itu menerjemahkan dari bahasa universal ke dalam bahasa aslinya.  Bahasa universal dalam HTTP adalah standar W3C, bahasa kami Swift, bahasa penerima tidak diketahui oleh kami. <br><br>  Standar W3C mendefinisikan aturan yang mendefinisikan apa arti representasi yang dapat dikenali untuk setiap kasus.  Dalam kasus kami, kami perlu menyajikan parameter mengikuti bagian form-url-encoded dari standar (misalnya, param1 = var1 &amp; param2 = var2). <br><br><h3>  Tampilan web </h3><br>  Menggunakan alat bahasa pemrograman, kami dapat mengirim permintaan ke server jauh.  Inilah yang dilakukan browser sebelum menampilkan halaman web.  Perbedaannya hanya pada konten jawabannya.  Halaman web diformat menggunakan standar HTML, yang mendefinisikan seperangkat aturan tentang cara mendefinisikan berbagai tag markup secara grafis.  Aturan-aturan ini tampak sederhana, tetapi menampilkan seluruh halaman mengikuti standar W3C adalah tugas yang sulit.  Untungnya, iOS memiliki komponen UIWebView built-in yang menggunakan mesin WebKit yang terkenal dan menafsirkan HTML / CSS / JavaScript dan menampilkan seluruh halaman web di dalam UIView. <br><br>  Ada beberapa kasus di mana kami ingin mengontrol aliran navigasi.  Misalnya, kami ingin tahu kapan konten tertentu atau URL tertentu dimuat. <br><br>  Atau mungkin kami menerapkan browser yang aman untuk anak-anak, kami ingin memblokir pengguna dari memuat halaman yang masuk dalam kriteria tertentu, seperti seks atau narkoba.  Untuk semua jenis penyesuaian seperti itu, kami membuat instance kelas yang mengimplementasikan protokol UIWebViewDelegate sebagai delegasi UIWebView.  Kami dapat menerapkan metode berikut: <br><br><pre><code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">webView</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:shouldStartLoadWithRequest</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:navigationType</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">webViewDidStartLoad</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">webViewDidFinishLoad</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">webView</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:didFailLoadWithError</span></span>:</code> </pre> <br>  Dengan menggunakan metode pertama, kita dapat mengontrol aliran navigasi dengan mengizinkan atau memblokir permintaan tertentu.  Tiga metode lainnya adalah peristiwa informasi (nama metode memberi ide bagus tentang peristiwa itu). <br><br><h2>  Implementasi pemungutan suara melalui permintaan POST </h2><br>  Kami akan menambahkan <b>file</b> <b>MainViewController.swift</b> dan <b>HTTPCommunication.swift</b> , dan membuat file <b>WebViewController.swift</b> baru di mana kami mendefinisikan webView kami. <br><br>  Pertama, buat file WebViewController.swift baru dan tentukan kelas WebViewController di dalamnya: <br><br>  <b>WebViewController.swift</b> <br><br><pre> <code class="hljs kotlin"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> UIKit <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">WebViewController</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">UIViewController { } extension WebViewController { }</span></span></span></span></code> </pre> <br>  Sekarang kami mengimplementasikan fungsionalitas untuk membuat permintaan POST di kelas yang bertanggung jawab untuk semua operasi HTTP kami: kelas komunikasi HTTPC.  Untuk melakukan ini, tambahkan metode postURL (_: params: completionHandler :) baru di HTTPCommunication.swift, yang mirip dengan metode recoverveURL (_: completionHandler :) sebelumnya. <br><br>  <b>HTTPCommunication.swift</b> <br><br><pre> <code class="hljs swift"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">HTTPCommunication</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">NSObject</span></span></span><span class="hljs-class"> </span></span>{ … <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">retrieveURL</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> url: URL, completionHandler: @escaping </span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">(</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params">(Data)</span></span></span></span></span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Void</span></span>)) { … } <span class="hljs-comment"><span class="hljs-comment">// </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">TODO:</span></span></span><span class="hljs-comment">    } // end of class HTTPCommunication</span></span></code> </pre><br>  Kode metode <br><br><pre> <code class="hljs powershell">func postURL(_ url: URL, params: <span class="hljs-function"><span class="hljs-function">[</span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-built_in">String</span></span></span><span class="hljs-function">: </span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-built_in">Int</span></span></span><span class="hljs-function">], </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">completionHandler</span></span></span></span>: @escaping ((<span class="hljs-keyword"><span class="hljs-keyword">Data</span></span>) -&gt; Void)) { // (K.<span class="hljs-number"><span class="hljs-number">1</span></span>) self.completionHandler = completionHandler // (K.<span class="hljs-number"><span class="hljs-number">2</span></span>) func postBody(params: <span class="hljs-function"><span class="hljs-function">[</span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-built_in">String</span></span></span><span class="hljs-function">: </span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-built_in">Int</span></span></span><span class="hljs-function">]) -&gt; </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">Data</span></span></span></span>? { // (K.<span class="hljs-number"><span class="hljs-number">3</span></span>) var paramsArr: <span class="hljs-function"><span class="hljs-function">[</span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-built_in">String</span></span></span><span class="hljs-function">] = [] </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">for</span></span></span></span> (key, value) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> params { paramsArr.append(<span class="hljs-string"><span class="hljs-string">"\(key)=\(value)"</span></span>) } let postBodyString: String = paramsArr.joined(separator: <span class="hljs-string"><span class="hljs-string">"&amp;"</span></span>) let postBodyData: <span class="hljs-keyword"><span class="hljs-keyword">Data</span></span>? = postBodyString.data(using: .utf8) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> postBodyData } var request: URLRequest = URLRequest(url: url) // (K.<span class="hljs-number"><span class="hljs-number">4</span></span>) request.httpMethod = <span class="hljs-string"><span class="hljs-string">"POST"</span></span> request.httpBody = postBody(params: params) let session: URLSession = URLSession(configuration: .default, delegate: self, delegateQueue: nil) // (K.<span class="hljs-number"><span class="hljs-number">5</span></span>) let task: URLSessionDownloadTask = session.downloadTask(with: request) task.resume() }</code> </pre> <br>  (K.1) Dengan penutupan, kami akan bekerja di luar fungsi ini, oleh karena itu kami menyatakannya dengan @escaping. <br>  (K.2) Kami menyimpan penutupan yang disahkan di properti Handler penyelesaian. <br>  (K.3) Kami menulis metode yang mengubah kamus parameter yang dikirimkan ke dalam bentuk string, dan kemudian menyandikan string ini ke dalam tipe data dalam pengkodean utf8. <br>  (K.4) Kami membuat permintaan dengan url yang dikirimkan dan mengkonfigurasinya: mengatur POST sebagai metode, dan menjadikan parameter tipe data kami dengan utf8 sebagai badan permintaan. <br>  (K.5) Akhirnya, buat sesi dengan konfigurasi default dan delegasi seperti diri kita sendiri.  Dan kami membuat tugas untuk memuat hasil permintaan ini ke penyimpanan sementara.  Pada akhirnya, defrost tugas. <br><br>  Sekarang mari kita tambahkan antarmuka yang diperlukan ke MainViewController.swift.  Tambahkan dua tombol untuk memilih voteUp dan voteDown, yang masing-masing akan menambah atau mengurangi peringkat dari lelucon saat ini.  Kami juga menambahkan Tombol "Chuck Who?", Yang akan kami isi dengan fungsionalitas di bagian pada tampilan web. <br><br>  Di MainViewController.swift, masukkan kode inisialisasi voteUpButton, voteDownButton dan chuckWhoButton. <br><br>  <b>MainViewController.swift</b> <br><br><pre> <code class="hljs swift"><span class="hljs-built_in"><span class="hljs-built_in">lazy</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> jokeLabel: <span class="hljs-type"><span class="hljs-type">UILabel!</span></span> = … <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> jokeID: <span class="hljs-type"><span class="hljs-type">Int!</span></span> <span class="hljs-built_in"><span class="hljs-built_in">lazy</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> activityView: <span class="hljs-type"><span class="hljs-type">UIActivityIndicatorView!</span></span> = … <span class="hljs-comment"><span class="hljs-comment">//</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">TODO:</span></span></span><span class="hljs-comment">    lazy var stackView: UIStackView! = …</span></span></code> </pre><br>  Kode Inisialisasi Tombol <br><pre> <code class="hljs pgsql">lazy var voteUpButton: UIButton! = { // (L<span class="hljs-number"><span class="hljs-number">.1</span></span>) let button: UIButton = UIButton(<span class="hljs-keyword"><span class="hljs-keyword">type</span></span>: .<span class="hljs-keyword"><span class="hljs-keyword">system</span></span>) // (L<span class="hljs-number"><span class="hljs-number">.2</span></span>) button.setTitle("Vote Up", <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>: .normal) button.sizeToFit() button.addTarget(self, action: #selector(self.voteUp), <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>: .touchUpInside) // (L<span class="hljs-number"><span class="hljs-number">.3</span></span>) self.<span class="hljs-keyword"><span class="hljs-keyword">view</span></span>.addSubview(button) // (L<span class="hljs-number"><span class="hljs-number">.4</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> button // (L<span class="hljs-number"><span class="hljs-number">.5</span></span>) }() lazy var voteDownButton: UIButton! = { let button: UIButton = UIButton(<span class="hljs-keyword"><span class="hljs-keyword">type</span></span>: .<span class="hljs-keyword"><span class="hljs-keyword">system</span></span>) button.setTitle("Vote Down", <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>: .normal) button.sizeToFit() button.addTarget(self, action: #selector(self.voteDown), <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>: .touchUpInside) self.<span class="hljs-keyword"><span class="hljs-keyword">view</span></span>.addSubview(button) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> button }() lazy var chuckWhoButton: UIButton! = { let button: UIButton = UIButton(<span class="hljs-keyword"><span class="hljs-keyword">type</span></span>: .<span class="hljs-keyword"><span class="hljs-keyword">system</span></span>) button.setTitle("Chuck Who?", <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>: .normal) button.sizeToFit() button.addTarget(self, action: #selector(self.chuckWho), <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>: .touchUpInside) self.<span class="hljs-keyword"><span class="hljs-keyword">view</span></span>.addSubview(button) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> button }()</code> </pre> <br>  Kode inisialisasi untuk ketiga tombol adalah sama. <br><br>  (L.1) Kami mendeklarasikan variabel malas dan menginisialisasi dengan penutupan. <br>  (L.2) Di dalam penutupan, kami mendefinisikan variabel lokal untuk tombol, tipe sistem, tentukan nama dan ukuran. <br>  (L.3) Kami mengaitkan dengan tombol tindakan yang sesuai ketika ditekan. <br>  (L.4) Tambahkan ke hierarki tampilan. <br>  (L.5) Dan kami menetapkan variabel lokal ini ke variabel malas kami. <br><br>  Selanjutnya, di MainViewController.swift, masukkan kode metode untuk tombol <br><br>  <b>MainViewController.swift</b> <br><br><pre> <code class="hljs swift"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MainViewController</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UIViewController</span></span></span><span class="hljs-class"> </span></span>{ … <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">retrieveRandomJokes</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { … } <span class="hljs-comment"><span class="hljs-comment">// </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">TODO:</span></span></span><span class="hljs-comment">    } // end of class MainViewController</span></span></code> </pre><br>  Kode metode untuk tombol <br><pre> <code class="hljs powershell">func voteUp() { let http: HTTPCommunication = HTTPCommunication() // (M.<span class="hljs-number"><span class="hljs-number">1</span></span>) let params: [<span class="hljs-built_in"><span class="hljs-built_in">String</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">Int</span></span>] = [<span class="hljs-string"><span class="hljs-string">"joke_id"</span></span>: <span class="hljs-type"><span class="hljs-type">self.jokeID</span></span>, <span class="hljs-string"><span class="hljs-string">"vote"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>] // (M.<span class="hljs-number"><span class="hljs-number">2</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> let url = URL(string: <span class="hljs-string"><span class="hljs-string">"http://example.com/rater/vote"</span></span>) { // (M.<span class="hljs-number"><span class="hljs-number">3</span></span>) http.postURL(url, params: params) { (<span class="hljs-keyword"><span class="hljs-keyword">data</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> // (M.<span class="hljs-number"><span class="hljs-number">4</span></span>) print(<span class="hljs-string"><span class="hljs-string">"\(data). Voted Up"</span></span>) } } } func voteDown() { let http: HTTPCommunication = HTTPCommunication() let params: [<span class="hljs-built_in"><span class="hljs-built_in">String</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">Int</span></span>] = [<span class="hljs-string"><span class="hljs-string">"joke_id"</span></span>: <span class="hljs-type"><span class="hljs-type">self.jokeID</span></span>, <span class="hljs-string"><span class="hljs-string">"vote"</span></span>: -<span class="hljs-number"><span class="hljs-number">1</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> let url = URL(string: <span class="hljs-string"><span class="hljs-string">"http://example.com/rater/vote"</span></span>) { http.postURL(url, params: params) { (<span class="hljs-keyword"><span class="hljs-keyword">data</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> print(<span class="hljs-string"><span class="hljs-string">"\(data). Voted Down"</span></span>) } } } func chuckWho() { }</code> </pre> <br>  Kode metode untuk memilih naik dan turun adalah sama. <br><br>  (M.1) Buat objek kelas untuk komunikasi dengan server. <br>  (M.2) Kami membuat kamus parameter yang menyertakan id lelucon yang kami pilih, dan nilai sebenarnya dari pemungutan suara adalah +1 atau -1. <br>  (M.3) Selanjutnya, kami mendapatkan url dengan aman dari bilah alamat dari domain pelatihan kami <code>http://example.com/rater/vote.</code> <br>  (M.4) Dan kami mengirimkan melalui POST permintaan untuk url parameter kami.  Dan cetak ke konsol garis yang menunjukkan penyelesaian permintaan. <br><br>  Selanjutnya, di MainViewController.swift kita menulis ulang kode metode configStackView, dengan mempertimbangkan perubahan yang dilakukan pada UI. <br><br>  <b>MainViewController.swift</b> <br><br><pre> <code class="hljs powershell">func configStackView() -&gt; UIStackView { let innerStackView: UIStackView = UIStackView(arrangedSubviews: [<span class="hljs-type"><span class="hljs-type">self.voteUpButton</span></span>, <span class="hljs-type"><span class="hljs-type">self.voteDownButton</span></span>]) // (N.<span class="hljs-number"><span class="hljs-number">1</span></span>) innerStackView.axis = .horizontal // (N.<span class="hljs-number"><span class="hljs-number">2</span></span>) innerStackView.distribution = .fillEqually let mainStackView: UIStackView = UIStackView(arrangedSubviews: [<span class="hljs-type"><span class="hljs-type">self.jokeLabel</span></span>, <span class="hljs-type"><span class="hljs-type">innerStackView</span></span>, <span class="hljs-type"><span class="hljs-type">self.chuckWhoButton</span></span>]) // (N.<span class="hljs-number"><span class="hljs-number">3</span></span>) mainStackView.spacing = <span class="hljs-number"><span class="hljs-number">50</span></span> // (N.<span class="hljs-number"><span class="hljs-number">4</span></span>) mainStackView.axis = .vertical mainStackView.distribution = .fillEqually self.view.addSubview(mainStackView) // (N.<span class="hljs-number"><span class="hljs-number">5</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> mainStackView }</code> </pre> <br>  (N.1) Buat innerStackView yang berisi dua tombol untuk pemungutan suara. <br>  (N.2) Kami mengekspos sumbu vertikal;  distribusinya sama. <br>  (N.3) Di mainStackView utama, tambahkan innerStackView dan tombol tentang Chuck Norris ke label dari bagian terakhir. <br>  (N.4) Konfigurasikan mainStackView. <br>  (N.5) Tambahkan mainStackView ke hierarki tampilan. <br><br>  Kami meluncurkan aplikasi kami dan melihat antarmuka seperti pada Gambar.  1 <br><br><img src="https://habrastorage.org/webt/wj/nv/ur/wjnvurcfmrxazb2lhifxl689zqa.png"><br>  <i>Gambar. 1 Antarmuka aplikasi kami dengan tombol yang ditambahkan untuk pemungutan suara</i> <br><br>  kami memverifikasi bahwa ketika memberikan suara untuk atau melawan lelucon, pesan-pesan berikut ini ditampilkan di konsol: <br><br> <code>345 bytes. Voted Up</code> <br> <br>  atau <br><br> <code>345 bytes. Voted Down</code> <br> <br>  yang menunjukkan permintaan POST yang berhasil diselesaikan ke server. <br><br>  Kami menulis aplikasi lelucon menggunakan icndb API dan GET HTTP verb.  Kami dapat menunjukkan lelucon ini pada UIView dan setiap lelucon dapat dihargai.  Tindakan ini mengirim permintaan POST ke server jarak jauh, yang seharusnya menghemat estimasi kami. <br><br><h2>  Menggunakan webViews untuk menampilkan halaman web </h2><br>  Kami akan menambahkan webView untuk menampilkan halaman wikipedia tentang Chuck Norris.  Dia bingung dengan satu sentuhan tombol. <br><br>  Dalam file WebViewController.swift, tuliskan fungsi rintisan fungsi berikut: <br><br>  <b>WebViewController.swift</b> <br><br><pre> <code class="hljs haskell"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> UIKit class WebViewController: UIViewController { lazy var webView: UIWebView = { // (<span class="hljs-type"><span class="hljs-type">O</span></span>.1) self.configWebView() }() lazy var toolbar: UIToolbar = { // (<span class="hljs-type"><span class="hljs-type">O</span></span>.2) self.configToolbar() }() override func viewDidLoad() { super.viewDidLoad() } func back() { // (<span class="hljs-type"><span class="hljs-type">O</span></span>.3) self.webView.goBack() } func forward() { self.webView.goForward() } } extension WebViewController { func configWebView() -&gt; UIWebView { // (<span class="hljs-type"><span class="hljs-type">O</span></span>.4) } func configToolbar() -&gt; UIToolbar { // (<span class="hljs-type"><span class="hljs-type">O</span></span>.5) } func configConstraints() { // (<span class="hljs-type"><span class="hljs-type">O</span></span>.6) } }</code> </pre> <br>  (O.1) Kami membuat variabel malas untuk webView <br>  (O.2) dan bilah alat. <br>  (O.3) Kami membuat metode maju dan mundur, untuk navigasi pada riwayat kunjungan tautan. <br>  (O.4) Kami menambahkan metode inisialisasi webView ke ekstensi <br>  (O.5) dan toolBar <br>  (O.6) dan kendala untuk antarmuka. <br><br>  Sekarang kita lukis kode masing-masing fungsi: <br><br><pre> <code class="hljs swift"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">configWebView</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">UIWebView</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> webView: <span class="hljs-type"><span class="hljs-type">UIWebView</span></span> = <span class="hljs-type"><span class="hljs-type">UIWebView</span></span>() <span class="hljs-comment"><span class="hljs-comment">// (P.1) self.view.addSubview(webView) return webView }</span></span></code> </pre> <br>  (P.1) Kami menginisialisasi webView dan menambahkan tampilan ke hierarki. <br><br><pre> <code class="hljs smalltalk">func configToolbar() -&gt; <span class="hljs-type"><span class="hljs-type">UIToolbar</span></span> { let toolbar: <span class="hljs-type"><span class="hljs-type">UIToolbar</span></span> = <span class="hljs-type"><span class="hljs-type">UIToolbar</span></span>(frame: <span class="hljs-type"><span class="hljs-type">CGRect</span></span>.zero) // (<span class="hljs-type"><span class="hljs-type">Q</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span>) let backButton: <span class="hljs-type"><span class="hljs-type">UIBarButtonItem</span></span> = <span class="hljs-type"><span class="hljs-type">UIBarButtonItem</span></span>(title: <span class="hljs-comment"><span class="hljs-comment">"&lt;"</span></span>, style: .plain, target: <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>, action: <span class="hljs-symbol"><span class="hljs-symbol">#selector</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.back)) // (<span class="hljs-type"><span class="hljs-type">Q</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span>) let forwardButton: <span class="hljs-type"><span class="hljs-type">UIBarButtonItem</span></span> = <span class="hljs-type"><span class="hljs-type">UIBarButtonItem</span></span>(title: <span class="hljs-comment"><span class="hljs-comment">"&gt;"</span></span>, style: .plain, target: <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>, action: <span class="hljs-symbol"><span class="hljs-symbol">#selector</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.forward)) toolbar.setItems([backButton, forwardButton], animated: <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>) // (<span class="hljs-type"><span class="hljs-type">Q</span></span><span class="hljs-number"><span class="hljs-number">.3</span></span>) toolbar.backgroundColor = <span class="hljs-type"><span class="hljs-type">UIColor</span></span>.lightGray // (<span class="hljs-type"><span class="hljs-type">Q</span></span><span class="hljs-number"><span class="hljs-number">.4</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.view.addSubview(toolbar) return toolbar }</code> </pre> <br>  (R.1) Buat bilah alat dengan bingkai nol. <br>  (R.2) Kami membuat dua tombol untuk menavigasi riwayat tautan kunjungan.  Dengan nama "&lt;" dan "&gt;" dan tindakan dilampirkan ke metode yang sesuai di webView. <br>  (Q.3) Tambahkan tombol-tombol ini ke toolbar. <br>  (R.4) Atur warna latar belakang, seperti Bilah navigasi, abu-abu muda.  Dan tambahkan tampilan ke hierarki. <br><br><pre> <code class="hljs powershell">func configConstraints() { self.webView.translatesAutoresizingMaskIntoConstraints = false // (R.<span class="hljs-number"><span class="hljs-number">1</span></span>) NSLayoutConstraint.activate([ // (<span class="hljs-type"><span class="hljs-type">R.2</span></span>) <span class="hljs-type"><span class="hljs-type">self.webView.topAnchor.constraint</span></span>(<span class="hljs-type"><span class="hljs-type">equalTo</span></span>: <span class="hljs-type"><span class="hljs-type">self.topLayoutGuide.topAnchor</span></span>), <span class="hljs-type"><span class="hljs-type">self.webView.leadingAnchor.constraint</span></span>(<span class="hljs-type"><span class="hljs-type">equalTo</span></span>: <span class="hljs-type"><span class="hljs-type">self.view.leadingAnchor</span></span>), <span class="hljs-type"><span class="hljs-type">self.webView.trailingAnchor.constraint</span></span>(<span class="hljs-type"><span class="hljs-type">equalTo</span></span>: <span class="hljs-type"><span class="hljs-type">self.view.trailingAnchor</span></span>), <span class="hljs-type"><span class="hljs-type">self.webView.bottomAnchor.constraint</span></span>(<span class="hljs-type"><span class="hljs-type">equalTo</span></span>: <span class="hljs-type"><span class="hljs-type">self.toolbar.topAnchor</span></span>) ]) self.toolbar.translatesAutoresizingMaskIntoConstraints = false NSLayoutConstraint.activate([ // (<span class="hljs-type"><span class="hljs-type">R.3</span></span>) <span class="hljs-type"><span class="hljs-type">self.toolbar.leadingAnchor.constraint</span></span>(<span class="hljs-type"><span class="hljs-type">equalTo</span></span>: <span class="hljs-type"><span class="hljs-type">self.view.leadingAnchor</span></span>), <span class="hljs-type"><span class="hljs-type">self.toolbar.trailingAnchor.constraint</span></span>(<span class="hljs-type"><span class="hljs-type">equalTo</span></span>: <span class="hljs-type"><span class="hljs-type">self.view.trailingAnchor</span></span>), <span class="hljs-type"><span class="hljs-type">self.toolbar.bottomAnchor.constraint</span></span>(<span class="hljs-type"><span class="hljs-type">equalTo</span></span>: <span class="hljs-type"><span class="hljs-type">self.view.bottomAnchor</span></span>), <span class="hljs-type"><span class="hljs-type">self.toolbar.heightAnchor.constraint</span></span>(<span class="hljs-type"><span class="hljs-type">equalToConstant</span></span>: <span class="hljs-number"><span class="hljs-number">44.0</span></span>) ]) }</code> </pre> <br>  (R.1) Nonaktifkan masker autoresisasi sehingga tidak bertentangan dengan kendala kami <br>  (R.2) Untuk webView, konfigurasikan keempat sisi tampilan. <br>  (R.3) Untuk bilah alat, konfigurasikan tiga sisi tampilan, kecuali untuk bagian atas, tetapi tambahan atur ketinggian ke ukuran standar 44.0. <br><br>  Dan tulis ulang kode ViewDidLoad () sebagai berikut: <br><br><pre> <code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">viewDidLoad</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.viewDidLoad() <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.configConstraints() <span class="hljs-comment"><span class="hljs-comment">// (S.1) if let url = URL(string: "http://en.wikipedia.org/wiki/Chuck_Norris") { // (S.2) let request: URLRequest = URLRequest(url: url) // (S.3) self.webView.loadRequest(request) // (S.4) } }</span></span></code> </pre> <br>  (S.1) Meminta pengaturan kendala. <br>  (S.2) Dapatkan url dengan aman dari bilah alamat di halaman Wikipedia <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">en.wikipedia.org/wiki/Chuck_Norris</a> <br>  (S.3) Kami membuat permintaan dari url. <br>  (S.4) Dan kami menjalankan permintaan yang diberikan di webView. <br><br>  Kami kembali ke MainViewController dan mengisinya dengan metode memanggil informasi tentang Chuck Norris. <br><br>  <b>MainViewController.swift</b> <br><br><pre> <code class="hljs swift"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">chuckWho</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.navigationController?.show(<span class="hljs-type"><span class="hljs-type">WebViewController</span></span>(), sender: <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>) <span class="hljs-comment"><span class="hljs-comment">// (T.1) }</span></span></code> </pre> <br>  (T.1) Saat Anda mengklik tombol ini pada tumpukan navigationController, masukkan instance webView baru. <br><br>  Fig.  2 menunjukkan bagaimana tampilan webView dalam aplikasi kita. <br><br><img src="https://habrastorage.org/webt/cj/tv/-a/cjtv-a57shzmktsq3btfccu6hme.png"><br>  <i>Fig.</i>  <i>2. Tampilan akhir dari webView yang telah kami terapkan</i> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id415615/">https://habr.com/ru/post/id415615/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id415599/index.html">India juga ingin mendapatkan helium-3</a></li>
<li><a href="../id415601/index.html">Kubernetes HA cluster dengan contenterd. Atau adakah kehidupan tanpa buruh pelabuhan?</a></li>
<li><a href="../id415605/index.html">Bagaimana kami menyimpan pemrosesan kartu dengan Exadata</a></li>
<li><a href="../id415611/index.html">PKI: Perpustakaan GCrypt dan KSBA sebagai alternatif untuk OpenSSL dengan dukungan untuk kriptografi Rusia. Lanjutan</a></li>
<li><a href="../id415613/index.html">Mengapa Anda tidak membeli lampu LED</a></li>
<li><a href="../id415617/index.html">Menggunakan Perpustakaan FPC InternetPCools di Delphi</a></li>
<li><a href="../id415619/index.html">Apple dan Samsung menyelesaikan perang paten 7 tahun</a></li>
<li><a href="../id415621/index.html">Sistem pemantauan penambangan</a></li>
<li><a href="../id415623/index.html">Dinamika penerbangan vertikal pesawat lebih ringan dari udara</a></li>
<li><a href="../id415625/index.html">Kubernetes: webinar (4 Juli pukul 19:30) dan intensif (3-5 Agustus)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>