<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>猡碉   Gesti贸n automatizada de pruebas con Telegram  け </title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Como ingeniero de control de calidad, desarroll茅 un sistema de autocomprobaci贸n. Enfrent茅 una serie de problemas: 



- Para cada tipo de prueba, tuve...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Gesti贸n automatizada de pruebas con Telegram</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/471364/">  Como ingeniero de control de calidad, desarroll茅 un sistema de autocomprobaci贸n.  Enfrent茅 una serie de problemas: <br><br><ul><li>  Para cada tipo de prueba, tuve que crear mis propios trabajos en CI y ejecutarlos a mano. </li><li>  Los desarrolladores se negaron a ejecutar casos de autocomprobaci贸n. </li><li>  La imposibilidad de ejecutar autotests desde cualquier parte del dispositivo. </li><li>  Los ingenieros de pruebas manuales de control de calidad no pod铆an ejecutar las pruebas autom谩ticas ellos mismos. </li></ul><br>  Por lo tanto, decid铆 crear un peque帽o prototipo del bot para ejecutar pruebas automatizadas, que cubrir铆an la mayor铆a de los problemas descritos anteriormente. <br><br>  <b>Descripci贸n de la idea:</b> <br><br>  El usuario env铆a los comandos necesarios al chat, inicia la compilaci贸n en el sistema CI, de acuerdo con las reglas especificadas en la configuraci贸n.  CI ejecuta pruebas autom谩ticas con marcas pytest.  Despu茅s de la ejecuci贸n, el script dentro del repositorio de prueba recibe informaci贸n sobre el estado de compilaci贸n, recopila registros y lo env铆a de vuelta al usuario en el chat de telegramas. <br><a name="habracut"></a><br>  <b>Herramientas:</b> <br><br><div class="spoiler">  <b class="spoiler_title">Las herramientas</b> <div class="spoiler_text"><ul><li>  Lenguaje de programaci贸n - Python </li><li>  Marco de prueba - Pytest </li><li>  Cliente HTTP - Solicitudes </li><li>  Base de datos - SQLite3 </li><li>  ORM - Peewee </li><li>  Sistema CI - Travis CI </li></ul><br></div></div><br><br>  <b>Contenido</b> <br><br><ol><li>  Preparaci贸n </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Registro de bot</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Preparando un repositorio de prueba</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Pruebas y registro</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Generaci贸n de informes</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Configurar Travis CI</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Configuraci贸n de bot</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Los principios del bot</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Despliegue en Heroku</a> </li></ol><br><a name="1"></a><br><h3>  <b>Registro de bot</b> </h3><br>  En primer lugar, necesitamos registrar el telegrama del bot y obtener su identificaci贸n 煤nica, que es un token.  Para hacer esto, escriba el mensaje / inicio en el bot @BotFather. <br>  Nuestro equipo principal es / newbot, al ingresar, se nos pedir谩 que propongamos el nombre del bot. <br>  Pero hay una regla: el nombre debe terminar en bot.  BotFather toma el nombre del bot y devuelve tu token.  Active el bot comenzando a chatear.  A continuaci贸n, debe enviar una solicitud de API al m茅todo getUpdates. <br><br><pre><code class="python hljs">https://api.telegram.org/bot{_}/getUpdates</code> </pre> <br>  Recuerda el hat_id recibido. <br><br><a name="2"></a><br><h3>  <b>Preparando un repositorio de prueba</b> </h3><br>  A continuaci贸n, debe organizar un repositorio con pruebas o utilizar un art铆culo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">preparado</a> previamente. <br><br><a name="3"></a><br>  <i>Pruebas y registro</i> <br><br>  Cree funciones de prueba y m谩rquelas con la marca pytest: completa, humo y p谩jaro. <br><br>  Es importante agregar el registro a nuestras pruebas creando un archivo pytest.ini y agregando llamadas al m茅todo de informaci贸n desde la biblioteca de registro en las funciones de prueba. <br>  El archivo pytest.ini contiene plantillas para registros en vivo y un archivo de registro. <br><br><div class="spoiler">  <b class="spoiler_title">Ejemplo de prueba</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pytest <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> requests <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> logging @pytest.mark.full @pytest.mark.smoke <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_cat_facts</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> query = {<span class="hljs-string"><span class="hljs-string">"animal_type"</span></span>: <span class="hljs-string"><span class="hljs-string">"cat"</span></span>, <span class="hljs-string"><span class="hljs-string">"amount"</span></span>: <span class="hljs-string"><span class="hljs-string">"2"</span></span>} response = requests.get(<span class="hljs-string"><span class="hljs-string">"https://cat-fact.herokuapp.com/facts/random"</span></span>, params=query) logging.info(<span class="hljs-string"><span class="hljs-string">f"Request url: </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{response.request.url}</span></span></span><span class="hljs-string">, body: </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{response.request.body}</span></span></span><span class="hljs-string">"</span></span>) logging.info(<span class="hljs-string"><span class="hljs-string">f"Request status: </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{response.status_code}</span></span></span><span class="hljs-string">, body: </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{response.text}</span></span></span><span class="hljs-string">"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> response.status_code == <span class="hljs-number"><span class="hljs-number">200</span></span> @pytest.mark.full @pytest.mark.smoke <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_dog_facts</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> query = {<span class="hljs-string"><span class="hljs-string">"animal_type"</span></span>: <span class="hljs-string"><span class="hljs-string">"dog"</span></span>, <span class="hljs-string"><span class="hljs-string">"amount"</span></span>: <span class="hljs-string"><span class="hljs-string">"2"</span></span>} response = requests.get(<span class="hljs-string"><span class="hljs-string">"https://cat-fact.herokuapp.com/facts/random"</span></span>, params=query) logging.info(<span class="hljs-string"><span class="hljs-string">f"Request url: </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{response.request.url}</span></span></span><span class="hljs-string">, body: </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{response.request.body}</span></span></span><span class="hljs-string">"</span></span>) logging.info(<span class="hljs-string"><span class="hljs-string">f"Request status: </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{response.status_code}</span></span></span><span class="hljs-string">, body: </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{response.text}</span></span></span><span class="hljs-string">"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> response.status_code == <span class="hljs-number"><span class="hljs-number">200</span></span> @pytest.mark.full <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_horse_facts</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> query = {<span class="hljs-string"><span class="hljs-string">"animal_type"</span></span>: <span class="hljs-string"><span class="hljs-string">"horse"</span></span>, <span class="hljs-string"><span class="hljs-string">"amount"</span></span>: <span class="hljs-string"><span class="hljs-string">"2"</span></span>} response = requests.get(<span class="hljs-string"><span class="hljs-string">"https://cat-fact.herokuapp.com/facts/random"</span></span>, params=query) logging.info(<span class="hljs-string"><span class="hljs-string">f"Request url: </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{response.request.url}</span></span></span><span class="hljs-string">, body: </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{response.request.body}</span></span></span><span class="hljs-string">"</span></span>) logging.info(<span class="hljs-string"><span class="hljs-string">f"Request status: </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{response.status_code}</span></span></span><span class="hljs-string">, body: </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{response.text}</span></span></span><span class="hljs-string">"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> response.status_code == <span class="hljs-number"><span class="hljs-number">200</span></span> @pytest.mark.bird <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_bird_facts</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> query = {<span class="hljs-string"><span class="hljs-string">"animal_type"</span></span>: <span class="hljs-string"><span class="hljs-string">"bird"</span></span>, <span class="hljs-string"><span class="hljs-string">"amount"</span></span>: <span class="hljs-string"><span class="hljs-string">"2"</span></span>} response = requests.get(<span class="hljs-string"><span class="hljs-string">"https://cat-fact.herokuapp.com/facts/random"</span></span>, params=query) logging.info(<span class="hljs-string"><span class="hljs-string">f"Request url: </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{response.request.url}</span></span></span><span class="hljs-string">, body: </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{response.request.body}</span></span></span><span class="hljs-string">"</span></span>) logging.info(<span class="hljs-string"><span class="hljs-string">f"Request status: </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{response.status_code}</span></span></span><span class="hljs-string">, body: </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{response.text}</span></span></span><span class="hljs-string">"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> response.status_code == <span class="hljs-number"><span class="hljs-number">200</span></span></code> </pre> <br></div></div><br><br><div class="spoiler">  <b class="spoiler_title">pytest.ini</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">[pytest] markers = smoke: for smoking testing full: for regression testing bird: facts only bird log_cli = 1 log_cli_level=INFO log_cli_format = %(asctime)s [%(levelname)8s] %(message)s log_cli_date_format='%Y-%m-%d %H:%M:%S' log_file = test_log.log log_file_level=INFO log_file_format= %(asctime)s [%(levelname)8s] %(message)s log_file_date_format='%Y-%m-%d %H:%M:%S'</code> </pre> <br></div></div><br><br><a name="4"></a><br>  <i>Generaci贸n de informes</i> <br><br>  Creamos un script que, una vez que se completa el ensamblaje, recopila informaci贸n del sistema de CI y los env铆a al chat de telegramas, junto con los registros. <br>  Dentro del script, debe reemplazar los valores TELEGRAM_BOT y CHAT_ID por los valores que recibi贸 anteriormente. <br><br><div class="spoiler">  <b class="spoiler_title">C贸digo de script</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> requests <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> os TRAVIS_TEST_RESULT = os.environ.get(<span class="hljs-string"><span class="hljs-string">"TRAVIS_TEST_RESULT"</span></span>) TRAVIS_REPO_SLUG = os.environ.get(<span class="hljs-string"><span class="hljs-string">"TRAVIS_REPO_SLUG"</span></span>) TRAVIS_BRANCH = os.environ.get(<span class="hljs-string"><span class="hljs-string">"TRAVIS_BRANCH"</span></span>) TRAVIS_JOB_WEB_URL = os.environ.get(<span class="hljs-string"><span class="hljs-string">"TRAVIS_JOB_WEB_URL"</span></span>) TRAVIS_COMMIT_MESSAGE = os.environ.get(<span class="hljs-string"><span class="hljs-string">"TRAVIS_COMMIT_MESSAGE"</span></span>) TELEGRAM_TOKEN = <span class="hljs-string"><span class="hljs-string">"808619876:GHrtj9zs-KvKhhtWyu1YoxjtIikUYMGVjD8g"</span></span> CHAT_ID = <span class="hljs-string"><span class="hljs-string">"272560060"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> TRAVIS_TEST_RESULT != <span class="hljs-number"><span class="hljs-number">0</span></span>: build_status = <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: build_status = <span class="hljs-string"><span class="hljs-string">""</span></span> TEXT = <span class="hljs-string"><span class="hljs-string">f" : </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{build_status}</span></span></span><span class="hljs-string"> \n : </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{TRAVIS_REPO_SLUG}</span></span></span><span class="hljs-string"> \n : </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{TRAVIS_BRANCH}</span></span></span><span class="hljs-string"> \n Commit : </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{TRAVIS_COMMIT_MESSAGE}</span></span></span><span class="hljs-string"> \n -: </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{TRAVIS_JOB_WEB_URL}</span></span></span><span class="hljs-string">"</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">send_message</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> URL = <span class="hljs-string"><span class="hljs-string">f"https://api.telegram.org/bot</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{TELEGRAM_TOKEN}</span></span></span><span class="hljs-string">/sendMessage"</span></span> body = {<span class="hljs-string"><span class="hljs-string">'chat_id'</span></span>: CHAT_ID, <span class="hljs-string"><span class="hljs-string">'text'</span></span>: TEXT} response = requests.post(url=URL, json=body) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> response <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">send_file</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> URL = <span class="hljs-string"><span class="hljs-string">f"https://api.telegram.org/bot</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{TELEGRAM_TOKEN}</span></span></span><span class="hljs-string">/sendDocument"</span></span> body = {<span class="hljs-string"><span class="hljs-string">'chat_id'</span></span>: CHAT_ID} file = {<span class="hljs-string"><span class="hljs-string">"document"</span></span>: open(<span class="hljs-string"><span class="hljs-string">"test_log.log"</span></span>)} response = requests.post(url=URL, data=body, files=file) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> response send_message() send_file()</code> </pre> <br></div></div><br>  El script usa variables del sistema y recibe valores de Travis CI. <br><br>  Si el valor de TRAVIS_TEST_RESULT no es igual a cero, el valor se establece en "Correcto", primero se procesa la funci贸n send_message, que env铆a informaci贸n de ensamblaje al chat (nombre del repositorio, rama seleccionada, nombre del compromiso utilizado, enlace al registro web), luego la funci贸n send_file que env铆a archivo de registro <br><br>  En el repositorio de prueba, agregue el archivo de configuraci贸n - travis.yml.  En el interior describimos la tuber铆a a trav茅s de la cual funcionar谩 el ensamblaje. <br><br><div class="spoiler">  <b class="spoiler_title">travis.yml</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">language: python python: - "3.7" install: - pip install -r requirements.txt script: pytest -m smoke after_script: - python tg_command.py</code> </pre> <br></div></div><br>  A continuaci贸n, debemos implementar el repositorio en GitHub para agregarlo a Travis CI. <br><br><a name="5"></a><br><h3>  <b>Configurando TRAVIS_CI</b> </h3><br>  Vamos al <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">sitio</a> <br>  Inicie sesi贸n con su cuenta de GitHub.  Cambie a la pesta帽a Panel de control.  Habiendo abierto previamente DevTools (Red), en la subpesta帽a Repositorios en el sitio opuesto al repositorio de prueba, mueva el control deslizante - active su ensamblaje.  En la pesta帽a Red (DevTools), llega una solicitud activa, en la vista previa de la cual hay informaci贸n sobre la identificaci贸n del repositorio, el n煤mero debe ser recordado (copiar / escribir).  Cambiando al sitio en la pesta帽a Configuraci贸n.  Copiamos o recordamos el token, lo necesitamos. <br><br><a name="6"></a><br><h3>  <b>Configuraci贸n de bot</b> </h3><br>  En este art铆culo no nos detendremos en el an谩lisis del c贸digo, puede verlo en el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">repositorio</a> .  Ahora es importante que comprendamos los conceptos b谩sicos del tema, as铆 que pasemos a configurar nuestro bot: <br><br>  Dentro del repositorio est谩n los archivos: <br><br><ol><li>  main.py - script de bot; </li><li>  models.py - archivo con modelos para ORM; </li><li>  conf.ini - archivo con variables de configuraci贸n; </li><li>  runtime.txt: valores fijos de la versi贸n de Python para Travis CI; </li><li>  procfile - ajuste para gunicorn; </li><li>  wsgi.py: archivo de inicio de la aplicaci贸n con gunicorn. </li></ol><br>  Para que su bot funcione, debe reemplazar los datos en conf.ini, a saber: <br><br><ul><li>  travis_token - indica el token recibido a Travis CI; </li><li>  travis_base_url: especifique la direcci贸n de la API de Travis CI; </li><li>  travis_repository_id - especifica la identificaci贸n del repositorio con autotest, dentro de Travis CI; </li><li>  telegram_chat_id: especifique la identificaci贸n de chat del telegrama donde se enviar谩n los mensajes del bot; </li><li>  telegram_bot_url - especifica la url al bot. </li></ul><br><div class="spoiler">  <b class="spoiler_title">Ejemplo de Conf.ini</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">[travis] travis_token = token HkjhkjgGKJhjgFGfdgd travis_base_url = https://api.travis-ci.org travis_repository_id = 10898384 [telegram] telegram_chat_id = 24234234 telegram_bot_url = https://api.telegram.org/bot87543366:AAHtj9zs-Kv4zGWyu1eTXegikUYMGVjD8g/</code> </pre> <br></div></div><br><a name="7"></a><br>  <i>Los principios del bot</i> <br><br>  Es importante que cada solicitud d茅 un estado de respuesta de 200. De lo contrario, el telegrama comenzar谩 a enviar solicitudes c铆clicamente hasta que reciba una respuesta v谩lida. <br><br>  El bot tiene un conjunto de comandos: <br><br>  El delimitador puede ser cualquier car谩cter especial, excepto el gui贸n bajo. <br><br><ul><li>  add_m: agrega un kit de prueba (marcas de python). <br>  Plantilla: * comando * {descripci贸n del kit} {delimitador} {marca de nombre}. <br>  Ejemplo: add_m Prueba de aves / ave. </li><li>  add_b: agrega una rama para probar. <br>  Plantilla: * comando * {descripci贸n de la rama} {delimitador} {nombre de la rama de git}. <br>  Ejemplo: add_b Master. </li><li>  select: le permite seleccionar una rama para probar de forma predeterminada. <br>  Plantilla: * comando *. <br>  Ejemplo: despu茅s de ingresar el comando de selecci贸n, aparecen botones para seleccionar las ramas que se agregaron a la base de datos con el comando add_b. </li><li>  ejecutar: el comando para iniciar el ensamblaje. <br>  Plantilla: * comando *. <br>  Ejemplo: despu茅s de ingresar el comando de ejecuci贸n, aparecen los botones para seleccionar los conjuntos de autotests que se agregaron a la base de datos con el comando add_m.  Al inicio, la rama especificada por el comando select se selecciona autom谩ticamente. </li><li>  del_m: elimina un conjunto de pruebas. <br>  Plantilla: * comando * {marcas de nombre}. <br>  Ejemplo: del_m bird. </li><li>  del_b: elimina las ramas ingresadas en la base de datos. <br>  Plantilla: * comando * {branch from git}. <br>  Ejemplo: del_b master. </li></ul><br>  <i>驴C贸mo funciona el bot?</i> <br><br>  <b>1. El</b> usuario agrega un conjunto de pruebas (add_m): <br>  El comando divide los datos del usuario en 2 partes: la descripci贸n y el nombre de la rama en git.  El nombre se escribe en la columna mark_name dentro de la base de datos, y la descripci贸n en la columna mark_description. <br><br>  <b>2. El</b> usuario agrega ramas (add_b): <br>  El comando divide los datos del usuario en 2 partes: la descripci贸n y el nombre de la rama en git.  El nombre se escribe en la columna branch_name dentro de la base de datos, y la descripci贸n en la columna branch_description. <br><br>  <b>3. El</b> usuario selecciona la rama predeterminada (seleccionar): <br>  El usuario recibe botones en el chat, formados seg煤n los datos de las tablas branch_description y branch_name.  El usuario selecciona un bot贸n con la rama deseada.  Est谩 escrito en la tabla favorite_branch. <br><br>  <b>4. El</b> usuario inicia la inicializaci贸n de la compilaci贸n (ejecuci贸n): <br>  El usuario recibe botones en el chat, formados seg煤n los datos de las tablas. <br>  mark_description y mark_name.  El usuario selecciona un bot贸n con un kit para ejecutar pruebas autom谩ticas. <br><br>  Seg煤n los datos seleccionados por el usuario, el bot genera una solicitud en el m茅todo de activaci贸n en la clase TravisCI y la env铆a a Travis para su ejecuci贸n.  Dentro del sistema Travis, se activa el disparador de una opci贸n de construcci贸n.  Esta opci贸n anula el archivo travis.yml, cambiando la secci贸n del script a los datos seleccionados por el usuario. <br><br><a name="8"></a><br><h3>  <b>Despliegue en HEROKU</b> </h3><br>  Para que el bot funcione, debe implementarse en el alojamiento.  Recomiendo usar Heroku, porque esta plataforma tiene una tarifa gratuita, que proporciona la potencia necesaria para que funcione el bot. <br><br>  <i>驴C贸mo implementar un bot?</i> <br><br>  Para no describir todo el proceso, dejar茅 un enlace a la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">documentaci贸n</a> oficial para comenzar: <br><br>  Si desea trabajar con Heroku a trav茅s de la GUI, complete el c贸digo en Github.  Debe registrarse a trav茅s de la interfaz web de Heroku.  Despu茅s del registro, haga clic en Nuevo -&gt; Crear nueva aplicaci贸n -&gt; Ingrese el nombre de la aplicaci贸n y seleccione una regi贸n.  Vaya a la pesta帽a Implementar y seleccione la integraci贸n con Github en el m茅todo de Implementaci贸n. <br><br>  Ante nosotros aparece un bloque para buscar en el repositorio.  Ingrese el nombre del repositorio y haga clic en el bot贸n Buscar.  En los resultados de b煤squeda, frente al nombre del repositorio, haga clic en el bot贸n Conectar.  En el bloque Implementaci贸n manual, seleccione la rama y haga clic en "Implementar". <br><br>  ltimo momento: debe activar webhooks mediante una solicitud GET: <br><pre> <code class="python hljs">https://api.telegram.org/bot{id_}/setWebhook?url=https://{_}.herokuapp.com/bot</code> </pre> <br><br>  Se puede usar el bot.  Verificamos que todo funcion贸 para nosotros: <br><br><img src="https://cdn1.radikalno.ru/uploads/2019/10/13/7d55521afbcfd87833197fc0a3ad0c82-full.jpg" alt="imagen"></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/471364/">https://habr.com/ru/post/471364/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../471348/index.html">Aplicaciones TypeScript de pila completa</a></li>
<li><a href="../471350/index.html">Ingenier铆a inversa de amplificadores operacionales de bajo ruido desde una computadora anal贸gica en 1969</a></li>
<li><a href="../471352/index.html">Escribir presentaciones en LaTeX</a></li>
<li><a href="../471358/index.html">驴C贸mo escribir un contrato inteligente con Python en ontolog铆a? Parte 4: API nativa</a></li>
<li><a href="../471360/index.html">M茅todo de duplicaci贸n 11 ejemplos del dise帽o de ICE</a></li>
<li><a href="../471366/index.html">El tribunal de la UE se opone a las cookies de forma predeterminada: no debe haber casillas de verificaci贸n previamente marcadas</a></li>
<li><a href="../471372/index.html">驴Por qu茅 las empresas deben administrar los tel茅fonos inteligentes de los empleados?</a></li>
<li><a href="../471374/index.html">Te invitamos a NIXMultiConf # 3 en Jarkov</a></li>
<li><a href="../471378/index.html">驴D贸nde comienza la programaci贸n?</a></li>
<li><a href="../471380/index.html">Pentesters a la vanguardia de la ciberseguridad</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>