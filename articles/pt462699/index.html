<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§ê üîù üöà Malha de servi√ßo, "Plano de dados" e "Plano de controle" (plano de dados da malha de servi√ßo x plano de controle) üèåÔ∏è ü¶Ö ‚ò¢Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ol√° Habr! Apresento a voc√™ a tradu√ß√£o do artigo "Service mesh data plane vs control control" de Matt Klein . 



 Dessa vez, desejei e traduzi a descr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Malha de servi√ßo, "Plano de dados" e "Plano de controle" (plano de dados da malha de servi√ßo x plano de controle)</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/462699/">  Ol√° Habr!  Apresento a voc√™ a tradu√ß√£o do artigo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">"Service mesh data plane vs control control"</a> de <b>Matt Klein</b> . <br><br><img src="https://habrastorage.org/webt/oa/ar/bu/oaarbu82bai5hzqqe0l2f-qeupg.png"><br><br>  Dessa vez, desejei e traduzi a descri√ß√£o dos dois componentes da malha de servi√ßo, plano de dados e plano de controle.  Essa descri√ß√£o me pareceu a mais compreens√≠vel e interessante, e o mais importante, levando √† compreens√£o de "Isso √© mesmo necess√°rio?" <br><br>  Como a id√©ia de uma ‚Äúmalha de servi√ßo‚Äù se tornou cada vez mais popular nos √∫ltimos dois anos (artigo original em 10 de outubro de 2017) e o n√∫mero de participantes no espa√ßo aumentou, eu vi um aumento proporcional de confus√£o entre toda a comunidade t√©cnica sobre como comparar e contraste diferentes solu√ß√µes. <br><a name="habracut"></a><br>  A situa√ß√£o √© melhor descrita na seguinte s√©rie de tweets que escrevi em julho: <br><blockquote>  Confus√£o com a malha de servi√ßo (malha de servi√ßo) n¬∫ 1: Linkerd ~ = Nginx ~ = Haproxy ~ = Enviado.  Nenhum deles √© igual ao Istio.  Istio √© algo completamente diferente.  1 / </blockquote><blockquote>  O primeiro s√£o apenas planos de dados.  Eles mesmos n√£o fazem nada.  Eles precisam ser ajustados para algo mais.  2 / </blockquote><blockquote>  O Istio √© um exemplo de um plano de controle que liga partes.  Esta √© uma camada diferente.  / end </blockquote>  Os tweets anteriores mencionaram v√°rios projetos diferentes (Linkerd, NGINX, HAProxy, Envoy e Istio), mas, mais importante, introduziram os conceitos gerais de um plano de dados, uma malha de servi√ßo e um plano de controle.  Neste post, darei um passo atr√°s e direi o que quero dizer com os termos "plano de dados" e "plano de controle" em um n√≠vel muito alto. Depois, mostrarei como os termos se relacionam com os projetos mencionados. em tweets. <br><br><h1>  O que √© uma malha de servi√ßo (realmente)? </h1><br><img src="https://habrastorage.org/webt/3q/gw/dd/3qgwdd_ljaphirr4nlb9bdcghmc.png"><br>  <b>Figura 1: Vis√£o geral da malha de servi√ßo</b> <br><br>  <b>A Figura 1</b> ilustra o conceito de uma malha de servi√ßo no n√≠vel mais b√°sico.  Existem quatro clusters de servi√ßo (AD).  Cada inst√¢ncia de servi√ßo est√° associada a um servidor proxy local.  Todo o tr√°fego de rede (HTTP, REST, gRPC, Redis etc.) de uma √∫nica inst√¢ncia de aplicativo √© transmitido atrav√©s de um servidor proxy local para os clusters de servi√ßos externos correspondentes.  Portanto, a inst√¢ncia do aplicativo n√£o conhece a rede como um todo e apenas conhece seu proxy local.  De fato, a rede do sistema distribu√≠do era remota do servi√ßo. <br><br><h1>  Plano de dados </h1><br>  Em uma malha de servi√ßo, um servidor proxy localizado localmente para o aplicativo executa as seguintes tarefas: <br><br><ul><li>  <b>Descoberta de servi√ßo</b>  Quais servi√ßos / servi√ßos / aplicativos est√£o dispon√≠veis para o seu aplicativo? </li><li>  <b>Verifica√ß√£o de integridade</b>  As inst√¢ncias de servi√ßo retornadas pela descoberta de servi√ßo est√£o operacionais e prontas para aceitar o tr√°fego de rede?  Isso pode incluir verifica√ß√µes de sa√∫de ativas (por exemplo, verifica√ß√£o da resposta / verifica√ß√£o de sa√∫de) ou passivas (por exemplo, usando 3 erros 5xx consecutivos como uma indica√ß√£o do estado n√£o √≠ntegro do servi√ßo). </li><li>  <b>Encaminhamento</b>  Tendo recebido uma solicita√ß√£o para "/ foo" do servi√ßo REST, para qual cluster de servi√ßo a solicita√ß√£o deve ser enviada? </li><li>  <b>Balanceamento de carga</b>  Ap√≥s a sele√ß√£o de um cluster de servi√ßos durante o roteamento, para qual inst√¢ncia do servi√ßo a solicita√ß√£o deve ser enviada?  Que tempo limite?  Quais configura√ß√µes para interrup√ß√£o de circuito?  Se a solicita√ß√£o falhar, deve ser repetida? </li><li>  <b>Autentica√ß√£o e autoriza√ß√£o</b>  Para solicita√ß√µes de entrada, o servi√ßo de chamada pode ser identificado / autorizado criptograficamente usando mTLS ou algum outro mecanismo?  Se for identificado / autorizado, √© permitido chamar a opera√ß√£o solicitada (terminal) no servi√ßo ou deve ser retornada uma resposta n√£o autenticada? </li><li>  <b>Observabilidade</b>  Para cada solicita√ß√£o, estat√≠sticas detalhadas, logs / logs e dados de rastreamento distribu√≠dos devem ser gerados para que os operadores possam entender o fluxo de tr√°fego distribu√≠do e os problemas de depura√ß√£o √† medida que surgem. </li></ul><br>  Por todos os pontos anteriores na rede de servi√ßo (malha de servi√ßo), o plano de dados √© respons√°vel.  De fato, o proxy local do servi√ßo (side-car) √© um plano de dados.  Em outras palavras, o plano de dados √© respons√°vel pela transmiss√£o, encaminhamento e monitoramento condicionais de cada pacote de rede enviado ou enviado pelo servi√ßo. <br><br><h1>  O plano de controle </h1><br>  A abstra√ß√£o de rede fornecida pelo proxy local no plano de dados √© m√°gica (?).  No entanto, como o proxy realmente sabe sobre a rota "/ foo" para o servi√ßo B?  Como os dados de descoberta de servi√ßo preenchidos com solicita√ß√µes de proxy podem ser usados?  Como s√£o definidas as configura√ß√µes de balanceamento de carga, tempo limite, interrup√ß√£o de circuito etc.?  Como implantar o aplicativo usando o m√©todo azul / verde (azul / verde) ou o m√©todo de transfer√™ncia gradual de tr√°fego?  Quem define as configura√ß√µes de autentica√ß√£o e autoriza√ß√£o em todo o sistema? <br><br>  Todos os itens acima s√£o gerenciados pelo plano de controle da malha de servi√ßo.  <i>O plano de controle aceita um conjunto de servidores proxy isolados sem estado e os transforma em um sistema distribu√≠do</i> . <br><br>  Eu acho que a raz√£o pela qual muitos tecn√≥logos acham os conceitos separados do plano de dados e do plano de controle confusos √© porque, para a maioria das pessoas, o plano de dados √© familiar, enquanto o plano de controle √© estranho / incompreens√≠vel.  Trabalhamos com roteadores e comutadores de rede f√≠sicos h√° muito tempo.  Entendemos que os pacotes / solicita√ß√µes devem ir do ponto A ao ponto B e que podemos usar hardware e software para isso.  A nova gera√ß√£o de proxies de software s√£o simplesmente as vers√µes modernas das ferramentas que usamos h√° muito tempo. <br><br><img src="https://habrastorage.org/webt/ty/xa/re/tyxareqql4_ndfv1unsjrh0fx78.png"><br>  <b>Figura 2: Plano de controle humano</b> <br><br>  No entanto, h√° muito tempo usamos o plano de controle, embora a maioria dos operadores de rede n√£o possa associar essa parte do sistema a nenhum componente tecnol√≥gico.  A raz√£o para isso √© simples: <br>  <b>A maioria dos avi√µes de controle usados ‚Äã‚Äãhoje em dia √© ... n√≥s</b> . <br><br>  <b>A Figura 2</b> mostra o que eu chamo de "plano de controle humano".  Nesse tipo de implanta√ß√£o, que ainda √© muito comum, o operador humano, provavelmente mal-humorado, cria configura√ß√µes est√°ticas - potencialmente usando scripts - e as implementa usando algum tipo de processo especial em todos os proxies.  Em seguida, os proxies come√ßam a usar essa configura√ß√£o e come√ßam a processar o plano de dados usando as configura√ß√µes atualizadas. <br><br><img src="https://habrastorage.org/webt/nm/tj/dt/nmtjdtcwt4e22o_ow0gjns7sv9c.png"><br>  <b>Figura 3: Plano de controle de malha de servi√ßo avan√ßado</b> <br><br>  <b>A Figura 3</b> mostra o plano de controle "estendido" da malha de servi√ßo.  Consiste nas seguintes partes: <br><br><ul><li>  <b>O Humano</b> : Ainda existe uma pessoa (espero que menos zangada) que tome decis√µes de alto n√≠vel em rela√ß√£o a todo o sistema. </li><li>  <b>Interface do usu√°rio do plano de controle</b> : uma pessoa interage com algum tipo de interface do usu√°rio para controlar o sistema.  Pode ser um portal da web, um aplicativo de linha de comando (CLI) ou alguma outra interface.  Usando a interface do usu√°rio, o operador tem acesso a par√¢metros globais de configura√ß√£o do sistema, como: <br><ul><li>  Gerenciamento de implanta√ß√£o, azul / verde e / ou com transfer√™ncia gradual de tr√°fego </li><li>  Configura√ß√µes de autentica√ß√£o e autoriza√ß√£o </li><li>  Especifica√ß√µes da tabela de roteamento, por exemplo, quando o aplicativo A solicita informa√ß√µes sobre "/ foo", o que acontece </li><li>  Configura√ß√µes do balanceador de carga, como tempos limite, novas tentativas, par√¢metros de interrup√ß√£o de circuito, etc. </li></ul></li><li>  <b>Planejador de carga de trabalho</b> : os servi√ßos s√£o iniciados na infraestrutura por meio de um determinado tipo de sistema de planejamento / orquestra√ß√£o, como Kubernetes ou Nomad.  O agendador √© respons√°vel por carregar o servi√ßo junto com seu servidor proxy local. </li><li>  <b>Descoberta de servi√ßo</b>  Quando o planejador inicia e para as inst√¢ncias de servi√ßo, ele reporta o estado de integridade ao sistema de descoberta de servi√ßo. </li><li>  <b>APIs de configura√ß√£o de proxy de side-car</b> : os proxies locais extraem dinamicamente o estado de v√°rios componentes do sistema, de acordo com o modelo "consistente em √∫ltima an√°lise" sem interven√ß√£o do operador.  Todo o sistema, consistindo em todas as inst√¢ncias atualmente em execu√ß√£o de servi√ßos e servidores proxy locais, finalmente converge para um ecossistema.  A API do plano de dados Envoy √© um exemplo de como isso funciona na pr√°tica. </li></ul><br>  Essencialmente, o objetivo do plano de controle √© estabelecer uma pol√≠tica que ser√° finalmente adotada pelo plano de dados.  Planos de controle mais avan√ßados remover√£o mais partes de alguns sistemas do operador e exigir√£o menos controle manual, desde que funcionem corretamente! .. <br><br><h1>  Plano de dados e plano de controle.  Resumo do plano de dados x plano de controle </h1><br><ul><li>  <b>Plano de dados da malha de servi√ßo</b> : afeta todos os pacotes / solicita√ß√µes no sistema.  Respons√°vel pela descoberta de aplicativos / servi√ßos, verifica√ß√µes de integridade, roteamento, balanceamento de carga, autentica√ß√£o / autoriza√ß√£o e observabilidade. </li><li>  <b>Plano de controle de malha de servi√ßo</b> : fornece pol√≠tica e configura√ß√£o para todos os planos de dados em funcionamento na rede de servi√ßo.  N√£o toca em nenhum pacote / solicita√ß√£o no sistema.  O plano de controle transforma todos os planos de dados em um sistema distribu√≠do. </li></ul><br><h1>  Cen√°rio atual do projeto </h1><br>  Tendo descoberto a explica√ß√£o acima, vejamos o status atual do projeto ‚Äúservice mesh‚Äù. <br><br><ul><li>  <b>Planos de dados</b> : Linkerd, NGINX, HAProxy, Enviado, Traefik </li><li>  <b>Avi√µes de controle</b> : Istio, Nelson, SmartStack </li></ul><br>  Em vez de realizar uma an√°lise aprofundada de cada uma das solu√ß√µes acima, vou abordar brevemente alguns pontos que, na minha opini√£o, causam a maior parte da confus√£o no ecossistema no momento. <br><br>  No in√≠cio de 2016, o Linkerd foi um dos primeiros servidores proxy do plano de dados para a malha de servi√ßo e fez um trabalho fant√°stico de sensibiliza√ß√£o e aten√ß√£o ao modelo de design de malha de servi√ßo.  Cerca de 6 meses depois disso, o Enviado ingressou na Linkerd (embora esteja na Lyft desde o final de 2015).  Linkerd e Envoy s√£o dois dos projetos mais mencionados ao discutir redes de servi√ßos. <br><br>  Istio foi anunciado em maio de 2017.  Os objetivos do projeto Istio s√£o muito semelhantes ao plano de controle estendido mostrado na <b>Figura 3</b> .  O Enviado para Istio √© o servidor proxy padr√£o.  Assim, Istio √© o plano de controle e Envoy √© o plano de dados.  Em pouco tempo, o Istio causou muitos dist√∫rbios e outros planos de dados come√ßaram a se integrar como um substituto do Envoy (o Linkerd e o NGINX demonstraram integra√ß√£o com o Istio).  O fato de voc√™ poder usar planos de dados diferentes no mesmo plano de controle significa que o plano de controle e o plano de dados n√£o est√£o necessariamente intimamente relacionados.  Uma API como a API do plano de dados universal da Envoy pode formar uma ponte entre duas partes do sistema. <br><br>  Nelson e SmartStack ajudam a ilustrar ainda mais a separa√ß√£o entre o plano de controle e o plano de dados.  Nelson usa o Envoy como seu proxy e constr√≥i um plano de controle confi√°vel da malha de servi√ßo com base na pilha HashiCorp, ou seja,  Nomad etc.  O SmartStack √© talvez o primeiro de uma nova onda de redes de servi√ßo.  O SmartStack forma um plano de controle em torno de um HAProxy ou NGINX, demonstrando a capacidade de dissociar um plano de controle de uma malha de servi√ßo e de um plano de dados. <br><br>  Uma arquitetura de microsservi√ßo com uma malha de servi√ßo est√° atraindo mais aten√ß√£o (certo!), E mais e mais projetos e fornecedores est√£o come√ßando a trabalhar nessa dire√ß√£o.  Nos pr√≥ximos anos, veremos muitas inova√ß√µes tanto no plano de dados quanto no plano de controle, al√©m de outras misturas dos v√°rios componentes.  Por fim, a arquitetura de microsservi√ßo deve se tornar mais transparente e m√°gica (?) Para o operador. <br>  Espero cada vez menos irritado. <br><br><h1>  Pontos principais (Principais t√≥picos) </h1><br><ul><li>  Uma malha de servi√ßo (malha de servi√ßo) consiste em duas partes diferentes: um plano de dados e um plano de controle.  Ambos os componentes s√£o necess√°rios e, sem eles, o sistema n√£o funcionar√°. </li><li>  Todo mundo est√° familiarizado com o plano de controle, e agora voc√™ pode ser o plano de controle! </li><li>  Todos os planos de dados competem entre si em fun√ß√µes, desempenho, configurabilidade e extensibilidade. </li><li>  Todos os planos de controle competem em fun√ß√£o, configurabilidade, extensibilidade e usabilidade. </li><li>  Um √∫nico plano de controle pode conter as abstra√ß√µes e APIs corretas para que v√°rios planos de dados possam ser usados. </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt462699/">https://habr.com/ru/post/pt462699/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt462689/index.html">DISKOBALL: competi√ß√µes de lan√ßamento de HDD, 23 de agosto de Moscou</a></li>
<li><a href="../pt462691/index.html">Como migrar do AD para o LDAP ao usar o Zimbra</a></li>
<li><a href="../pt462693/index.html">No caminho para aplica√ß√µes dur√°veis ‚Äã‚Äãcom o gerador de site est√°tico PSKOV como exemplo</a></li>
<li><a href="../pt462695/index.html">Material como WebComponents</a></li>
<li><a href="../pt462697/index.html">uWSGI para ajudar nas m√©tricas. Relat√≥rio Yandex</a></li>
<li><a href="../pt462701/index.html">Biblioteca de gerador de c√≥digo Assembler para microcontroladores AVR. Parte 2</a></li>
<li><a href="../pt462703/index.html">A catraca ‚Äúmais barata‚Äù na R√∫ssia controlada a partir de um smartphone</a></li>
<li><a href="../pt462705/index.html">Os 5 principais erros nos meus aplicativos ReactJS</a></li>
<li><a href="../pt462707/index.html">Kubernetes lan√ßa ferramentas de desenvolvedor de aplicativos</a></li>
<li><a href="../pt462709/index.html">Teste de muta√ß√£o em PHP: uma medida qualitativa para cobertura de c√≥digo</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>