<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëÉ üññüèΩ ü§æüèø Timer - Start üëÇüèæ üëºüèº ‚õÖÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Alles begann mit ihm. Dies war mein erster Kauf bei Aliexpress f√ºr die erste Automatisierung des Landes - ich wollte die automatische Bew√§sserung im G...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Timer - Start</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/422435/"><img src="https://habrastorage.org/webt/yz/s9/r3/yzs9r3pd5_c6uacf0cvy0wbl9r8.jpeg" align="left">  Alles begann mit ihm.  Dies war mein erster Kauf bei Aliexpress f√ºr die erste Automatisierung des Landes - ich wollte die automatische Bew√§sserung im Gew√§chshaus durchf√ºhren.  Der Timer kam in einer zerknitterten Schachtel mit einer rissigen Schutzkappe, funktionierte aber.  Er hat die ganze Sommersaison √ºber Gurken gegossen. Er wurde entfernt und f√ºr den Winter an einem warmen und trockenen Ort versteckt.  Aber in der n√§chsten Saison wartete ich auf eine unangenehme √úberraschung - der Timer begann zu h√§ngen, reagierte nicht mehr auf die Steuertasten und √∂ffnete das Wasser.  Zuerst habe ich mit billigen Batterien ges√ºndigt und sie durch Duracell ersetzt.  Ich dachte, das Problem sei Strom und Einschaltstr√∂me.  Es hat nicht geholfen.  Dann nahm ich einen L√∂tkolben heraus und l√∂te alles, was ich konnte, hinein und f√ºgte sogar einige fehlende Kondensatoren hinzu.  Aber er hing hartn√§ckig weiter.  Leider ist das Produkt nicht sehr wartbar - da ich einen Mikrokreislauf-Tropfen mit offenem Kreislauf verwendet habe und anscheinend etwas genau unter der Verbindung mit dem Mikrokreislauf nicht montiert war.  Irgendwie war die Saison mit einem so zappelnden Timer vorbei und ich begann zu √ºberlegen, durch was ich ihn ersetzen sollte. <br><a name="habracut"></a><br>  Meine ersten Gedanken waren, ein Arduino Mini-Modul, ein Uhrmodul, eine Anzeige zu nehmen und alles irgendwie in den Fall eines kaputten Timers zu schieben und seinen nativen Motor und Kugelhahn zu verwenden.  Aber irgendwie ging es nicht wirklich dorthin, es w√ºrde deutlich mehr verbrauchen als die urspr√ºngliche F√ºllung (was bedeutet, dass Sie die Batterien im Geh√§use vergessen k√∂nnen) und es war langweilig und nicht skalierbar - ich wollte nicht nur das Gew√§chshaus, sondern nur einen kaputten Timer gie√üen. <br><br>  Und dann stie√ü ich bei Ali auf einen normalen motorisierten Kugelhahn.  Hier ist so ein gutaussehender Mann: <br><br><img src="https://habrastorage.org/webt/zu/md/c5/zumdc50whupl9mloczorxcmo6sg.jpeg"><br><br>  Ja, es kostete anst√§ndiges Geld, aber es war nicht be√§ngstigend, es an eine Sommerwasserversorgung anzuschlie√üen und es eine Woche lang unbeaufsichtigt zu lassen.  Es ist im Allgemeinen ziemlich solide, wenn auch mit einem Kunststoffgetriebe - jetzt funktionieren ein paar solcher Wasserh√§hne an meiner Hauptwasserversorgung, wo der Druck 5 atm betr√§gt. <br><br>  Die Idee war einfach.  In der Schublade des Tisches wartete ein Taschentuch mit dem WLAN-Modul ESP8266.  Es wurde beschlossen, die Energieeinsparung zugunsten einer Gebrauchtwagenbatterie aufzugeben, die nach Berechnungen f√ºr mindestens einen Monat Batterielebensdauer ausreichen sollte. Um den Moment der Batterieentladung nicht zu verpassen, stellte die Schaltung einen Teiler bereit, √ºber den der eingebaute ESP8266 ADC kontinuierlich die Versorgungsspannung ma√ü .  Das DS3231-Modul mit einer Batterie sollte als Uhr im Stromkreis dienen, und ein Taschentuch pro m / s MP1584EN sollte die Spannung von 12 V auf 3,3 V gesenkt haben. <br><br>  Hier ist ein Prototyp-Blockdiagramm: <br><br><img src="https://habrastorage.org/webt/qr/23/j6/qr23j6rhqqseg_haa2kevuaglqc.png"><br><div class="spoiler">  <b class="spoiler_title">Und hier ist ein Foto von seiner Umsetzung</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/ux/80/-p/ux80-pghlpqxovrie-igtxbpuee.jpeg"><br><br>  <i>bereits eine etwas zerlegte Implementierung - das DC-DC-Modul ging in den Kran, das Uhrmodul auf der R√ºckseite des Steckbretts</i> <br></div></div><br>  Die Steuerung des Kranmotors erfolgte hier einfach - welche Transistoren in der Schublade des Tisches gefunden wurden, wurden installiert.  In der Realit√§t kann ein Motor beispielsweise √ºber m / s ULN2003 gesteuert werden, indem mehrere Kan√§le parallel entweder mit Feldeffekttransistoren mit logischer Steuerung oder allgemein √ºber ein Relaismodul mit Optoisolation eingeschaltet werden.  Es muss nur ber√ºcksichtigt werden, dass der Motor mit einem Betriebsstrom von etwa 70 mA einen Einschaltstrom (und einen Strom zum Zeitpunkt der Rotationsblockierung) in der Gr√∂√üenordnung von 300 bis 350 mA aufweist. <br><br>  Eine kurze Skizze w√ºrde in Arduino mit einer einfachen Weboberfl√§che geschrieben: <br><br><img src="https://habrastorage.org/webt/vq/1u/rc/vq1urcw-ttzsjbbvcm7nbcxcuky.jpeg"><br><br>  Und der Prototyp stand im Testdienst.  Ich habe die Weboberfl√§che des Krans √ºber den Router weitergeleitet und das Ger√§t war st√§ndig online verf√ºgbar. <br><br>  Und die Gedanken liefen weiter.  Ein Prototyp ist gut, aber ich m√∂chte mehrere dieser Wasserh√§hne, und alles auf Steckbrett zu machen, ist keine Option.  Der Kran wurde ge√∂ffnet.  Und es wurde klar, dass unter einer versiegelten Abdeckung viel Platz ist und es sogar Befestigungsstellen gibt: <br><br><img src="https://habrastorage.org/webt/rt/tc/3f/rttc3f_0uzhnlpjql2vp4ds-nvm.jpeg"><br><br>  In diesem Wasserhahn, der im Prototyp verwendet wurde, befand sich unter der Abdeckung eine kleine Leiterplatte mit einem Relais, die die Steuerlogik bereitstellte.  Und auf dem Foto ist ein Kran mit dem Index CR05 zu sehen.  In diesen Abgriffen befindet sich keine Logik oder Leiterplatte.  Die Motorsteuerkabel und die Endschalterkabel werden einfach zur√ºckgezogen.  Und Sie m√ºssen solche Krane steuern, indem Sie die Polarit√§t der Spannung am Motor √§ndern.  Gleichzeitig ist es sehr ratsam, die Schlie√ü- / √ñffnungsendmomente an den Endpunkten des TC zu steuern. Wir erinnern uns, dass der Strom zu diesen Zeitpunkten bereits 300-350 mA betr√§gt. <br><br>  Das Blockdiagramm begann sich wie folgt abzuzeichnen: <br><br><img src="https://habrastorage.org/webt/ae/a1/uv/aea1uvc0g09wxdkdyxoioq8t8z8.png"><br><br>  Jetzt nehmen wir den Bremssattel, ein Blatt Papier in den H√§nden, und beginnen mit den Messungen, zeichnen den Umriss der Leiterplatte und versuchen, die Komponenten darauf zu platzieren.  Eine gro√üe CR2032-Batterie wurde aufgegeben und eine kleine CR1220 (oder 1225) wurde verwendet.  F√ºr eine sehr lange Zeit wurde ein H-Br√ºcken-Chip ausgew√§hlt, um den Motor zu steuern.  Die Auswahl scheint gro√ü zu sein, aber viele dieser Mikroschaltungen k√∂nnen entweder nicht mit einer Versorgungsspannung von 12 V arbeiten, oder sie verwenden Bipolartransistoren mit einem sehr gro√üen Spannungsabfall, oder der Fall ist nicht erfolgreich.  Der TB6612-Chip fiel mir zun√§chst lange nicht auf, und dann schien er f√ºr das L√∂ten sehr redundant und unpraktisch zu sein.  Aber am Ende habe ich mich auf sie konzentriert - es ist erschwinglich und g√ºnstig f√ºr Ali.  Die dortige H-Br√ºcke ist auf Feldeffekttransistoren aufgebaut und kann bei Spannungen bis 15 Volt betrieben werden.  Das DC-DC-Wandlermodul (MP1584DE) wurde vom Modul verlassen - es stellte sich heraus, dass es im Detail einfach billiger war und leicht zu l√∂ten war.  Aus Gr√ºnden der Zuverl√§ssigkeit besteht die Hauptsache darin, den darin enthaltenen Abstimmwiderstand durch einen konstanten zu ersetzen (27 kOhm - dies ergibt eine Ausgangsspannung von 3,4 V). Die Mikroschaltung der Uhr k√∂nnte in einem kompakteren Geh√§use verwendet werden, aber es gab eine Einschr√§nkung: Ich wollte alle Komponenten f√ºr Ali bestellen, und es bestand die Gefahr, dass ich sie bekam gef√§lschte oder defekte Schaltkreise.  Daher war in der Anfangsphase geplant, alle Mikroschaltungen als Teil der fertigen Module zu kaufen und auf die entwickelte Platine zu l√∂ten.  Und in den Modulen war die Uhr nur im SO16-Fall.  Tats√§chlich stellte sich heraus, dass nur eine Uhren-Mikroschaltung defekt oder eine falsche F√§lschung war - ihre Quarzfrequenz betrug 32727 bei 32768 kHz. <br><br>  Nach all den Vorbereitungsarbeiten nehmen wir KiKad, googeln ein bisschen auf der Suche nach fehlenden Sitzen, zeichnen einige Komponenten selbst und beginnen, das Board zu z√ºchten: <br><br><img src="https://habrastorage.org/webt/vj/zf/cy/vjzfcyt6qukg3sj5mev5xhkzcem.jpeg"><br><br>  Wir √ºberpr√ºfen dies, indem wir im Ma√üstab 1: 1 drucken.  Wir bringen Teile und Module an und bereiten, wenn alle √ºbereinstimmen, Gerber-Dateien f√ºr die Produktion vor und senden sie an EasyEda.  Nach 3 Wochen bekommen wir 10 s√º√üe Taschent√ºcher und sammeln sie. <br><br><img src="https://habrastorage.org/webt/ui/jn/hs/uijnhsbq8zqklcjm1n-pjhpax-c.jpeg"><br>  <i>Es sind noch 5 auf dem Foto, der Rest funktioniert</i> <br><br><img src="https://habrastorage.org/webt/dn/8c/nx/dn8cnx12fhixuzkxywboqkqfmou.jpeg"><br>  <i>Modulbaugruppe</i> <br><br>  Die L√∂cher f√ºr die Befestigungselemente stimmten nat√ºrlich nicht ein wenig √ºberein, einige der Sitze fielen nicht so aus, wie sie wollten, aber im Allgemeinen funktionierte das Produkt nach Montage und Firmware sofort.  Hermetische Kraftschw√§nze wurden bei Ali gekauft, durch eine Standard-Druckdichtung im Geb√§ude gef√ºhrt, und der WiFi-Kran-Timer erhielt sein Werks-Look: <br><br><img src="https://habrastorage.org/webt/kz/rn/zy/kzrnzyqalg_t_jsrrrjegdvc98q.jpeg"><br><br>  Hier sind ein paar Kr√§ne im Kampfeinsatz im Land: <br><br><div class="spoiler">  <b class="spoiler_title">an der Post</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/da/sx/ds/dasxds16utudu8su6efnv46dixy.jpeg"><br></div></div><br>  Aber dann ging der Gedanke wieder weiter.  Ich wollte mehr Automatisierung im Land, und das Modul erwies sich als recht kompakt und universell.  √úber die H-Br√ºcke k√∂nnen Sie ganz einfach ein herk√∂mmliches Relais steuern.  F√ºr die DIY-Automatisierung nehmen viele Sonoff, aber es stellt sich heraus, dass ich es selbst nicht schlechter machen kann. <br><br>  Und hier beginnt die Umwandlung eines einfachen Wi-Fi- <b>Abgriffs</b> in den Codenamen <b>SHAPEsp</b> - kurz f√ºr <b>Esp</b> 8266-basierte <b>S</b> mart Home <b>A</b> utomation <b>P</b> latform.  Wie geplant sollte dies ein kosteng√ºnstiges Universalmodul f√ºr die Hausautomation werden.  Und all dies sollte zuverl√§ssig sein und nach der Montage in einem erschwinglichen Koffer wie ein fertiges Produkt aussehen. <br><br>  √úberraschenderweise stellte sich heraus, dass im chinesischen Fall mit Aliexpress auf 2DIN das Ger√§t in Ordnung ist, der K√∂rper im K√∂rper, der beliebte AC / DC 220V / 12V HiLink-Wandler (naja oder sein Klon), das Relais und der Stromanschluss und nat√ºrlich mein leicht umgebautes Modul mit ESP8266, Uhr und H-Br√ºcke. <br><br><div class="spoiler">  <b class="spoiler_title">Mach es einmal</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/bp/wm/xk/bpwmxkb9rxu-mxso9_fbiz9wc4q.jpeg"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Mach zwei</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/ok/jd/d-/okjdd-orz-ecgzujbub-j-p2hzc.jpeg"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Mach drei</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/_i/ip/jm/_iipjmuknwsvpqelavmsrxrj3t0.jpeg"><br>  <i>Das Modul kann sowohl im Krank√∂rper als auch im DIN-Rackgeh√§use eingebaut werden</i> <br></div></div><br>  Und wir bekommen: <br><br><img src="https://habrastorage.org/webt/ht/2x/ui/ht2xuiatsx_ckjmyit2ihczozh4.jpeg"><br><br>  Die Form des Moduls wurde leicht ge√§ndert.  Ich habe Randverbinder hinzugef√ºgt, damit es im 2DIN-Paket aufrecht stehen kann.  Ich habe am oberen Ende der Platine Anzeige-LEDs angebracht, die im Licht eines Kunststoffgeh√§uses sichtbar sind.  Nun, ich habe die Medienplatine f√ºr das Relais und die Stromquelle ausgebreitet.  Um es billiger zu machen, wurde dies alles mit einem Board in die Produktion geschickt: <br><br><img src="https://habrastorage.org/webt/un/5j/z2/un5jz2k4nzvoo1g4bhkhdyik7bq.jpeg"><br><br>  Ich habe zwei solcher Prototypen zusammengebaut und sie in die H√ºtte gestellt, um die Aufnahme von Konvektoren f√ºr Winterank√ºnfte zu kontrollieren: <br><br><div class="spoiler">  <b class="spoiler_title">In einem anderen Beitrag</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/2t/yo/po/2tyopox-lcaqrqdd6yb3j8fqb3i.jpeg"><br>  <i>Eines der Module in der Schalttafel neben zwei Sch√ºtzen, die Konvektoren enthalten</i> <br></div></div><br>  Aber dann beschloss er, es noch weiter zu verbessern und universeller zu machen.  F√ºr eine zuverl√§ssigere und bequemere Firmware habe ich das Firmware-Schema von NodeMcu auf dem Modul platziert.  Er leitete alle m√∂glichen Stifte ab und f√ºgte Kontaktfl√§chen hinzu, um verschiedene Sensoren bequem anschlie√üen zu k√∂nnen.  Alle Randstifte werden in Schritten von 2,54 mm platziert, damit das Modul in das Steckbrett eingesetzt werden kann.  Nat√ºrlich habe ich den Anschluss des Thermometers ds1820, des kombinierten BME280-Sensors und des Feuchtigkeitssensors am Komparator getestet.  Es stellte sich heraus, dass Sie neben einem einfachen Timer mit Relais oder Kran problemlos eine Wetterstation oder beispielsweise ein Aquastop-System bauen k√∂nnen.  Nun, alle m√∂glichen anderen Benachrichtigungs- und Kontrollsysteme ... <br><br>  Mitgenommen, zeichnete ein Modell seines Moduls f√ºr Fritzing.  So k√∂nnen Sie die verschiedenen Anwendungsoptionen virtuell bewerten und drehen: <br><br><img src="https://habrastorage.org/webt/ob/rs/qm/obrsqm8tbnl6mknximfdzp7ossc.png"><br><br>  Ein Link zum GitHub-Modell befindet sich am Ende des Artikels. <br><br>  Nun beginnt der schwierigste Teil - die Softwareunterst√ºtzung f√ºr das Modul.  Anfangs habe ich alles mit meiner ziemlich einfachen Arduino-Skizze getestet und getestet.  Einfaches HTML, ein bisschen Java-Skript, verschiedene einfache M√∂glichkeiten zur Daten√ºbertragung, nur die Funktionalit√§t eines Timers und einige Sensoren, die ich brauche.  Aber ziemlich schnell wurde klar, dass es nicht so einfach sein w√ºrde, alles und jedes in der modernen Welt des IoT und des intelligenten Hausbaus zu beherrschen.  Und auch nur Faulheit (hier ist ein l√§chelnder Smiley).  Und manchmal m√∂chte ich das Rad nicht neu erfinden. <br><br>  Aus diesem Grund wurde entschieden, zu pr√ºfen, welche vorgefertigten Firmware-Programme Sie zur Unterst√ºtzung Ihres Moduls hinzuf√ºgen k√∂nnen.  Als Ausgangspunkt wurden alternative Firmwares f√ºr Sonoff-Produkte verwendet: Sonoff-Tasmota, ESPurna, ESPEasy.  Die Suche kann vergleichende Bewertungen dieser Firmware finden. <br><br>  Zum Beispiel: <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://lobradov.github.io/FOSS-Firmware-comparison-overview/</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><br></a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://lobradov.github.io/FOSS-Firmware-comparison-developers/</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><br></a> <br>  In Wirklichkeit habe ich den Quellcode in den Repositories dieser Firmware irgendwie mit meinem Auge durchgearbeitet. Mir wurde klar, dass der einfachste Weg f√ºr mich darin besteht, mein Modul zur ESPurna-Firmware hinzuzuf√ºgen.  Der Firmware-Code war recht vern√ºnftig strukturiert und √ºbernahm zun√§chst das Hinzuf√ºgen neuer Module und Funktionen.  In der Firmware befand sich die Timer-Funktionalit√§t, die ich brauchte, der eigenst√§ndige Sheduler.  Dar√ºber hinaus kann sofort gesagt werden, indem ich einfach meine Konfiguration mit einem einfachen Relais in der Datei hardware.h beschreibe. Ich habe eine funktionierende Version der Firmware des WiFi-Relais erhalten. <br><br>  Mein Modul hatte jedoch eine umfangreichere und komplexere Funktionalit√§t.  Und es wurde beschlossen, zur Firmware beizutragen.  Einerseits ist es ganz einfach - wir schreiben Funktionen und f√ºhren eine Pull-Anfrage durch, aber in Wirklichkeit ist es ein langweiliger und langer Prozess mit nicht immer einem positiven oder schnellen Ergebnis.  Dies sind die Kosten daf√ºr, dass die vorgeschlagene Funktionalit√§t im Gro√üen und Ganzen nur von mir und meinem unbekannten Board ben√∂tigt wird. <br><br>  Ich begann mit der Unterst√ºtzung der Uhr.  In der ESPurna-Firmware funktionierte alles √ºber NTP und die Zeitbibliothek f√ºr Arduino. Historisch gesehen m√ºssen Sie die Uhrzeit kennen, aber Sonoff-Produkte verf√ºgen nicht √ºber eine autonome Uhr und es wird davon ausgegangen, dass sie immer √ºber einen Internetzugang verf√ºgen.  Um die RTC-Uhr zu unterst√ºtzen, habe ich ein einfaches Modul geschrieben, das auf Wunsch die Zeitanbieterfunktion von reinem NTP auf NTP + RTC ersetzte.  Das Prinzip war einfach: Wenn keine NTP-Synchronisation verf√ºgbar ist, versuchen wir, die Zeit von der lokalen RTC-Uhr abzulesen.  Wenn der Zugriff auf NTP-Server angezeigt wird, stellen wir die Synchronisierung wieder her und synchronisieren bei Bedarf die lokale Uhr.  Also ging die Uhr auf meinem Modul in Arbeit.  Die Pull-Anfrage wurde ziemlich schnell angenommen, ging aber an eine separate espurna-rtc-Filiale. <br><br>  Das n√§chste war eine triviale Pull-Anfrage.  Da ich die Versorgungsspannung zum DC-DC-Wandler messe, um die Batterieentladung zu verfolgen, musste ich nicht die Versorgungsspannung des ESP8266-Moduls √ºberwachen, sondern einige benutzerdefinierte.  Was ich als Pull-Anfrage "Unterst√ºtzung f√ºr benutzerdefinierte VCC-√úberwachung hinzuf√ºgen" entworfen habe.  Aber diese Bitte hing irgendwie in der Luft ... und der Wunsch, etwas beizutragen, lie√ü irgendwie nach. <br><br>  Dar√ºber hinaus wurde deutlich, dass das Hinzuf√ºgen Ihres Moduls zur Liste der unterst√ºtzten fertigen Ger√§te nicht so einfach ist - es sind viele verschiedene Konfigurationen m√∂glich.  Daher wurde beschlossen, einfach die Firmware-Gabel zu entwickeln.  Und wenn m√∂glich und um die Synchronisation aufrechtzuerhalten, stellen Sie Pull-Anfragen oder bieten Sie Cherry-Pick im Haupt-Firmware-Repository an. <br><br>  Nach einer solchen Entscheidung wurde alles einfacher.  In der Firmware wurde das Relaissteuerungssystem teilweise neu geschrieben.  Der H-Br√ºcken-Steuermodus wurde hinzugef√ºgt und es wurde bequemer, benutzerdefinierte Relais-Betriebsmodi hinzuzuf√ºgen. <br><br>  Weitere Untersuchungen des Firmware-Codes haben gezeigt, dass es nicht m√∂glich ist, ihn umzugestalten.  Die Art des Schreibens und Verwendens von Ressourcen an einigen Stellen ist f√ºr einen Mikrocontroller sehr grausam (obwohl es sich um ein ziemlich intelligentes 32-Bit-System handelt).  Zum Beispiel hat das System zum Ausgeben von Debugging-Nachrichten den Stapel mit gro√üer Geschwindigkeit verschlungen, aber gleichzeitig wurde das Blockieren blockiert, um nicht das gesamte System zu l√∂schen, als die Stapelgr√∂√üe weniger als 10 KB betrug.  Ich habe den Code in meinem Thread ein wenig umgeschrieben, sodass jetzt alle Debugging-Meldungen und Eingabeaufforderungen in der Konsole vollst√§ndig angezeigt werden. <br><br>  Nun, im Moment wurde der Firmware ein Berechnungssubsystem hinzugef√ºgt <br>  Sonnenaufg√§nge / Sonnenunterg√§nge und ein virtueller SunriseSensor, sodass Sie aus dem SHAPEsp-Modul ein einfaches astronomisches Relais erstellen k√∂nnen.  Es wird notwendig sein, Mut zu fassen und sich f√ºr das Hauptlager zu engagieren.  Ich denke, dass dies eine n√ºtzliche Funktionalit√§t ist. <br><br>  Hier ist eine Geschichte √ºber die Umwandlung von DIY-Ideen von einem Prototyp zu einem fast fertigen Produkt.  Vielleicht ein gefragtes Produkt.  Das Erstaunlichste ist, dass ich noch keine Smart-Home-Systeme ausprobiert habe - alle Module arbeiten f√ºr mich v√∂llig autonom voneinander und sind einfach √ºber Webschnittstellen im Internet zug√§nglich.  Und einmal gekauft, liegt die OrangePi-PC-Karte in einer Schublade und wartet in den Startl√∂chern darauf, ein Smart-Home-Controller zu werden. <br><br>  Liste der Links: <br><br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Fritzing Modell und wie ich zusammenkomme Ich denke, dass es in Kikad ein Schaltungs- und Modullayout geben wird</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Einfache Test-Firmware f√ºr das Modul</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ESPurna-Firmware-Gabel mit Modulunterst√ºtzung</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Das Haupt-Firmware-Repository von ESPurna</a> <br></li></ol></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de422435/">https://habr.com/ru/post/de422435/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de422425/index.html">Ein √úberblick √ºber Nachbearbeitungsmethoden f√ºr FDM 3D-gedruckte Modelle</a></li>
<li><a href="../de422427/index.html">Dagaz: Aus dem Nebel</a></li>
<li><a href="../de422429/index.html">Wir beschleunigen den Prozess der Entwicklung komplexer Projekte. Ohne Chaos und Nerven</a></li>
<li><a href="../de422431/index.html">Japanische Feen zeigen Master-Slave-Trigger in neuem Manga auf digitaler Elektronik</a></li>
<li><a href="../de422433/index.html">Sonnenkollektoren und Asphaltstra√üen. Symbiose der Technologie</a></li>
<li><a href="../de422437/index.html">User Experience-Spiele sowie Website- und Anwendungsgeschwindigkeit</a></li>
<li><a href="../de422439/index.html">Der Kampf mit Yandex: Wie ich mehr als ein Jahr damit verbracht habe, die Seite an die Spitze zu bringen</a></li>
<li><a href="../de422441/index.html">Es wurde eine Formel f√ºr einen schmerzlosen √úbergang zu .Net Core gefunden</a></li>
<li><a href="../de422443/index.html">Corona SDK Pr√§ziser Timer</a></li>
<li><a href="../de422445/index.html">BottomAppBar-Implementierung. Teil 3: Verhalten f√ºr Android</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>