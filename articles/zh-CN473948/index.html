<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>✳️ 🧝 📝 Operon：提高Ansible的性能 ⚒️ 🔚 🙆🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="我很高兴最终介绍Operon ，这是Ansible Engine的高性能替代产品。 Operon专为大型安装而设计，并通过订阅进行分发。 它使用先进的引擎无需修改即可启动现有的剧本，模块，插件和第三方工具，从而显着增加了一次运行中寻址的实际节点数，每次调用可能节省数小时。 


 Operon既可以...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Operon：提高Ansible的性能</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/southbridge/blog/473948/"><p><img src="https://habrastorage.org/webt/lo/4s/i3/lo4si33bevrsrpbjkpg23lvxbye.jpeg"></p><br><p> 我很高兴最终介绍<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Operon</a> ，这是Ansible Engine的高性能替代产品。  Operon专为大型安装而设计，并通过订阅进行分发。 它使用先进的引擎无需修改即可启动现有的剧本，模块，插件和第三方工具，从而显着增加了一次运行中寻址的实际节点数，每次调用可能节省数小时。 </p><a name="habracut"></a><br><p>  <strong>Operon既可以单独安装</strong>也可以与Ansible Engine <strong>一起安装</strong> ：您可以逐步将项目转移到它，也可以根据需要在启动时使用它。 </p><br><p> 下图显示了通过SSH部署的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">DebOps</a> 0.7.2中的416个common.yml任务的运行情况： </p><br><p><img src="https://habrastorage.org/webt/-h/dj/vf/-hdjvfmecu117sb_puadvdg5w80.png"></p><br><p> 与干净的Ansible Operon相比，它减少了每个节点的运行时间约60％。 但是，随着大规模发射，优势就更大了。 查看运行时间的增长情况（硬件：24 GB，8核Xeon E5530；在18毫秒内通过SSH部署到Google Cloud虚拟机）： </p><br><p><img src="https://habrastorage.org/webt/cz/4c/eg/cz4ceg0tbpk1dzgekkbsaqxhtxs.png"></p><br><p> 对于每次运行，在每个节点上执行了416个任务，包括循环项。 在1024个节点的运行中，在54分钟内完成了540496个任务。 平均吞吐量-151个任务/秒。 水平缩放非常明显：从256到1024个节点几乎增加了4倍。 </p><br><p> 必须取消256节点的Ansible运行：很长一段时间没有产生结果，它不得不重新启动多次，将进程数从40个减少到10个，以便Ansible不会耗尽其RAM资源。 它可能已经解决了13个流程，但是我们不得不拒绝进一步的尝试：我们已经花了2天的机器时间。 </p><br><p> 对于最终运行，在取消之前，Ansible在6小时13分钟内完成了89％的任务： </p><br><p><img src="https://habrastorage.org/webt/qk/mo/yb/qkmoybfrc5yp2tccliv-fls2npq.png"></p><br><p> 在每次并行运行期间，Operon都会部署到所有节点。 在8个内核上执行1024个进程，负载几乎没有明显增加，而在24个内核上，进程数量增长了6144。如果在相同数量的节点上运行相同数量的任务，而只有16个内核，我们认为我们将运行完成时间不是54分钟，而是27分钟。 </p><br><p> 内存消耗是非常可预测的，并且很大程度上与进程分离。 拥有256个进程，Operon的消耗是Ansible消耗的10倍的四倍； 同时，处理器消耗的处理器时间至少少15倍。 </p><br><p><img src="https://habrastorage.org/webt/wg/6d/uc/wg6duc-smz_sklkgi23fewmde3i.png"></p><br><p> 这里的曲线逐渐下降：Ansible在具有40个进程的64个节点上运行，而在10个之上运行的256个节点上运行。Ansible在256个节点上运行需要1.6 Gb /进程。 因此，无论可用的RAM资源如何，都对可实现的并行性产生了严格的限制。 </p><br><p>  Operon是<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Mitogen for Ansible</a>首次在开发方法中迈出的新一步。 它继承了成千上万的用户所需的低级性能的大量改进： </p><br><p><img src="https://habrastorage.org/webt/ky/1p/w1/ky1pw1vyu3_qczrhqnjpvg7iwti.png"></p><br><p><img src="https://habrastorage.org/webt/ny/9j/se/ny9jsejzdbncitz0n92oywffsys.png"></p><br><h3 id="ne-tolko-po"> 不仅是软件 </h3><br><p> 生产力是文化转向更大的用户导向，兼容性和成本内部化的副作用。 我们有一些要展示的东西，但是为了让您充分体验新产品的品味，我很高兴地宣布，除了恢复一些过时的Ansible Engine结构之外，我们还将保证具有直接兼容性的剧本语法。 </p><br><p>  <strong>包括</strong> ： </p><br><pre><code class="plaintext hljs">- include: "i-will-always-work.yml"</code> </pre> <br><p>  <strong>“ with”循环</strong> </p><br><pre> <code class="plaintext hljs">- debug: msg={{item}} with_items: ["i", "will", "always", "work"]</code> </pre> <br><p>  <strong>“壁球动作”</strong> </p><br><pre> <code class="plaintext hljs">- apt: name: "{{item}}" with_items: ["i", "will", "always", "work"]</code> </pre> <br><p>  <strong>组名中的连字符</strong> </p><br><pre> <code class="plaintext hljs">$ cat hosts [i-will-always-work.us.mycorp.com] host1</code> </pre> <br><p>  <strong>哈希合并</strong> </p><br><pre> <code class="plaintext hljs"># I will always work [defaults] hash_behaviour = merge</code> </pre> <br><p> 语法与Ansible 2.9兼容的Operon出货<strong>将得到持续的支持</strong> ，并且在Ansible Engine中禁用语法不会在将来影响Operon。 此类更改会在不提高功能的情况下损害工作安装，并且它们是在更新过程中修复错误的主要工作来源。 </p><br><p> 随着时间的流逝，这种保证会扩展到引擎的语义之外。 </p><br><h3 id="kak-priobschitsya"> 如何加入？ </h3><br><p> 最初，Operon将在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Network Genomics的支持下</a>进行分发，这是一种经验和对服务的承诺，您将无法获得其他任何服务。 如果您的团队陷入了部署陷阱，或者厌倦了多年的更新更新，请<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">考虑要求进行评估</a> ，并毫不拖延地<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">给我写一封电子邮件</a> ，以解决任何问题和难以理解的问题。 </p><br><p> 最好的软件是在公共领域，因此，只要我们能够提供一定程度的免费支持，就会公开发布。  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">订阅我们的时事通讯</a> ，以及时了解未来版本。 </p><br><p>  <strong>Operon会提高Windows性能吗？</strong> <br> 是的 如果您在Windows部署过程中遇到性能问题，请立即关注。 </p><br><p>  <strong>Operon会提高网络设备性能吗？</strong> <br> 是的  Operon提出了一种架构上的重新设计，其扩展范围远远超出了传输层，并且同样适用于所有类型的连接。 </p><br><p>  <strong>Operon是Ansible分支吗？</strong> <br> 不行  Operon是对引擎的增量重写，它是大约6万行代码的一小部分，其中大约四分之一的代码已被替换。 每个Ansible装置都包含大约715k线路，其中绝大多数（如Operon）由大型Ansible社区独立支持。 </p><br><p>  <strong>Operon Ansible引擎会改善吗？</strong> <br> 是的  Operon已经在Ansible Engine中促进改进，并且由于它是一种改进，因此有动力做出贡献，并在必要时更正代码。 </p><br><p>  <strong>Operon是免费软件吗？</strong> <br> 是的  Operon与Ansible使用相同的GPL发行，您可以根据此许可自由使用代码。 </p><br><p>  <strong>Operon是否会破坏兼容性？</strong> <br> 不行  Operon不会违反与标准模块集，插件接口或周围的Ansible生态系统的兼容性，也不打算违反它。 兼容性首先是：您不应该落后于未来的改进，也不要忘记向后兼容性，例如，剧本语法的稳定性得到提高。 </p><br><p>  <strong>如果我只计划一个节点，是否需要Operon？</strong> <br>  Operon将确保您投入大量资源的技能的持续竞争力。 它提供了以前根本不存在的更高灵活性：选择发动机的自由度。 使用Operon，即使您不直接使用它也可以赢。 </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN473948/">https://habr.com/ru/post/zh-CN473948/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN473936/index.html">交互式音频性能-语音助手游戏的新时代</a></li>
<li><a href="../zh-CN473938/index.html">通过IConfiguration通用存储应用程序设置</a></li>
<li><a href="../zh-CN473940/index.html">强度测试：珍珠贝母高品纳的纳米力学</a></li>
<li><a href="../zh-CN473944/index.html">RimWorld创作者的建议：预测游戏迷的认知扭曲</a></li>
<li><a href="../zh-CN473946/index.html">微服务的分布式日志记录和跟踪</a></li>
<li><a href="../zh-CN473950/index.html">实施，扩展：在VTB中使用自动测试的经验</a></li>
<li><a href="../zh-CN473952/index.html">当我为回合制策略编写AI时</a></li>
<li><a href="../zh-CN473956/index.html">来自毒贩电话公司的秘密信息</a></li>
<li><a href="../zh-CN473958/index.html">来自NICT的日本人推出了工作带宽为1 Pbit / s的光纤集群</a></li>
<li><a href="../zh-CN473960/index.html">内容本地化策略</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>