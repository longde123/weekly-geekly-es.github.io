<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ЁЯЦНя╕П ЁЯжР ЁЯУн IOS рдРрдк рдореЗрдВ рд╕реНрд╡рддрдГ-рдирд╡реАрдХрд░рдгреАрдп рд╕рджрд╕реНрдпрддрд╛ рд╕реНрддрд░ ЁЯМЦ ЁЯТк ЁЯС╗</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="рд╣рд╛рдп, рдпрд╣ рдЕрдкреНрд╣реБрдж рд╕реЗ рд░реЗрдирд╛рдЯ рд╣реИ ред рдЗрд╕ рд▓реЗрдЦ рдореЗрдВ рд╣рдо рдЖрдкрдХреЛ рдмрддрд╛рдПрдВрдЧреЗ рдХрд┐ рдСрдЯреЛ-рд░рд┐рдиреНрдпреВрдПрдмрд▓ рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдХреЗ рд╕реНрддрд░ рдХреНрдпрд╛ рд╣реИрдВ, рдЙрдиреНрд╣реЗрдВ рд╕рд╣реА рддрд░реАрдХреЗ рд╕реЗ рдХреИрд╕реЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЬрд╛рдП рдФрд░...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>IOS рдРрдк рдореЗрдВ рд╕реНрд╡рддрдГ-рдирд╡реАрдХрд░рдгреАрдп рд╕рджрд╕реНрдпрддрд╛ рд╕реНрддрд░</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/apphud/blog/475758/"><p><img src="https://habrastorage.org/webt/ak/pz/18/akpz184-wzln3efdt6el6whs19o.png" alt="рдЫрд╡рд┐"></p><br><p>  рд╣рд╛рдп, рдпрд╣ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЕрдкреНрд╣реБрдж</a> рд╕реЗ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд░реЗрдирд╛рдЯ рд╣реИ</a> ред  рдЗрд╕ рд▓реЗрдЦ рдореЗрдВ рд╣рдо рдЖрдкрдХреЛ рдмрддрд╛рдПрдВрдЧреЗ рдХрд┐ рдСрдЯреЛ-рд░рд┐рдиреНрдпреВрдПрдмрд▓ рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдХреЗ рд╕реНрддрд░ рдХреНрдпрд╛ рд╣реИрдВ, рдЙрдиреНрд╣реЗрдВ рд╕рд╣реА рддрд░реАрдХреЗ рд╕реЗ рдХреИрд╕реЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЬрд╛рдП рдФрд░ рдХрд┐рди рдорд╛рдорд▓реЛрдВ рдореЗрдВ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдЕрдкреНрд░рдпреБрдХреНрдд рднреБрдЧрддрд╛рди рдЕрд╡рдзрд┐ рдХреЗ рд▓рд┐рдП рд╡рд╛рдкрд╕ рдХрд┐рдпрд╛ рдЬрд╛рдПред <a name="habracut"></a></p><br><h2 id="chto-takoe-uroven-podpiski">  рд╕рджрд╕реНрдпрддрд╛ рд╕реНрддрд░ рдХреНрдпрд╛ рд╣реИ? </h2><br><p>  рдпрд╣ рд╕рджрд╕реНрдпрддрд╛ рд╡рд░реНрдЧ рдХрд╛ рдкрджрдирд╛рдо рд╣реИ, рдЬреЛ рд╕реЗрд╡рд╛ рдХреЗ рд╕реНрддрд░ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддрд╛ рд╣реИред  рдкреНрд░рдердо рд╢реНрд░реЗрдгреА рдХреА рд╕рджрд╕реНрдпрддрд╛ рдХрд╛ рдЕрд░реНрде рд╣реИ рд╕реЗрд╡рд╛ рдХрд╛ рдЙрдЪреНрдЪрддрдо рд╕реНрддрд░, рджреВрд╕рд░рд╛ рд╡рд░реНрдЧ - рдирд┐рдореНрди, рдФрд░ рдЗрд╕реА рддрд░рд╣ред  рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рд╢рд╛рдпрдж рд╣реА рдХрднреА рдХрд┐рд╕ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВ рдЖрдк рддреАрди рдпрд╛ рдЕрдзрд┐рдХ рдХрд╛ рдЙрд▓реНрд▓реЗрдЦ рдирд╣реАрдВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рджрд╕реНрдпрддрд╛ рдХреЗ рджреЛ рд╕реНрддрд░ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВред </p><br><img src="https://habrastorage.org/webt/ek/ow/4r/ekow4rj6bw6nunu1yi078dzat1c.png"><br><p>  <em>рдиреНрдпреВрдпреЙрд░реНрдХ рдЯрд╛рдЗрдореНрд╕ рдЕрдЦрдмрд╛рд░ рдРрдк рдореЗрдВ рджреЛ рд╕рджрд╕реНрдпрддрд╛ рд╕реНрддрд░ред</em> </p><br><h2 id="kak-nastroit-urovni-podpiski">  рд╕рджрд╕реНрдпрддрд╛ рд╕реНрддрд░ рдХреИрд╕реЗ рд╕реЗрдЯ рдХрд░реЗрдВ? </h2><br><p>  рдЕрдкрдиреЗ рд╕рджрд╕реНрдпрддрд╛ рд╕реНрддрд░реЛрдВ рдХреЛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдРрдк рд╕реНрдЯреЛрд░ рдХрдиреЗрдХреНрдЯ рдкрд░ рдЬрд╛рдПрдВ</a> , рдЕрдкрдиреЗ рдЖрд╡реЗрджрди рдХрд╛ рдЪрдпрди рдХрд░реЗрдВ рдФрд░ <em>рд╕реБрд╡рд┐рдзрд╛рдПрдБ</em> рдЯреИрдм рдкрд░ рдЬрд╛рдПрдВред  рдЗрди-рдРрдк рдЦрд░реАрджрд╛рд░реА рдЕрдиреБрднрд╛рдЧ рдореЗрдВ, рдЕрдкрдиреА рд╕рджрд╕реНрдпрддрд╛ рдХреЛ рдПрдХ рд╕реНрддрд░ рдКрдкрд░ рдпрд╛ рдиреАрдЪреЗ рд▓реЗ рдЬрд╛рдПрдВред  рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдбреНрд░реИрдЧ рдПрдВрдб рдбреНрд░реЙрдк рдЖрдЗрдХрди рдХреЛ рджрдмрд╛рдХрд░ рдФрд░ рдЗрдЪреНрдЫрд┐рдд рд╕реНрддрд░ рдкрд░ рд╕рдмреНрд╕рдХреНрд░рд╛рдЗрдм рдХрд░рдХреЗ рд╡рд╛рдВрдЫрд┐рдд рд╕рджрд╕реНрдпрддрд╛ рдХрд╛ рдЪрдпрди рдХрд░реЗрдВред </p><br><img src="https://habrastorage.org/webt/mq/aq/8v/mqaq8vvrm_z0hkqsn8gvqso9fdc.gif"><br><p>  <em>рдХрд┐рд╕реА рд╕рджрд╕реНрдпрддрд╛ рдХреЛ рдЙрдЪреНрдЪ рд╕реНрддрд░ рддрдХ рдЦреАрдВрдЪреЗрдВ рдФрд░ рдЫреЛрдбрд╝реЗрдВред</em> </p><br><p>  рд╕рджрд╕реНрдпрддрд╛ рд╕рдВрдЦреНрдпрд╛ 1 рдХреЛ рд╕реЗрд╡рд╛ рдХреЗ рдЙрдЪреНрдЪрддрдо рд╕реНрддрд░ рдХреА рдкреЗрд╢рдХрд╢ рдХрд░рдиреА рдЪрд╛рд╣рд┐рдП, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рд╕рднреА рд╢реНрд░реЗрдгрд┐рдпреЛрдВ рдХреА рдкрддреНрд░рд┐рдХрд╛рдУрдВ рдХреА рд╕рджрд╕реНрдпрддрд╛ред  рд╕рджрд╕реНрдпрддрд╛ рдХреА рдЕрд╡рдзрд┐ рдФрд░ рдЙрд╕рдХреЗ рд╕реНрддрд░ рдХреЗ рдмреАрдЪ рдХреЛрдИ рдирд┐рд░реНрднрд░рддрд╛ рдирд╣реАрдВ рд╣реИред  рддреЛ, рдЙрдЪреНрдЪрддрдо рд╕рджрд╕реНрдпрддрд╛ рд╡рд╛рд░реНрд╖рд┐рдХ рд╣реЛ рд╕рдХрддреА рд╣реИ, рдФрд░ рдПрдХ рдорд╣реАрдиреЗ рд╕реЗ рдХрдо рд╕реНрддрд░ рдкрд░ рд╕рджрд╕реНрдпрддрд╛ред </p><br><h2 id="izmenenie-podpiski">  рд╕рджрд╕реНрдпрддрд╛ рдмрджрд▓реЗрдВ </h2><br><p>  рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЕрдкрдиреЗ рдкрдВрдЬреАрдХрд░рдг рдХреЗ рдмрд╛рдж рдРрдк рд╕реНрдЯреЛрд░ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВ рд╕рджрд╕реНрдпрддрд╛ рдХреЛ рдмрджрд▓ рд╕рдХрддрд╛ рд╣реИред  рдпрд╣ (рдЕрдкрдЧреНрд░реЗрдб), рдирд┐рдореНрди (рдбрд╛рдЙрдирдЧреНрд░реЗрдб) рд╕реНрддрд░ рдХреЛ рдмрдврд╝рд╛ рд╕рдХрддрд╛ рд╣реИ рдпрд╛ рд╕рдорд╛рди рд╕реНрддрд░ (рдХреНрд░реЙрд╕-рдЧреНрд░реЗрдб) рдХреЗ рднреАрддрд░ рд╕рджрд╕реНрдпрддрд╛ рдХреЛ рдмрджрд▓ рд╕рдХрддрд╛ рд╣реИред </p><br><h4 id="povyshenie-urovnya-podpiski-apgreyd">  рд╕рджрд╕реНрдпрддрд╛ рд╕реНрддрд░ рдХрд╛ рдЙрдиреНрдирдпрди (рдЕрдкрдЧреНрд░реЗрдб) </h4><br><p>  рдпрджрд┐ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рд╡рд░реНрддрдорд╛рди рд╕рджрд╕реНрдпрддрд╛ рд╕рдХреНрд░рд┐рдп рд╣реИ, рддреЛ рд╡рд╣ рддреБрд░рдВрдд рдПрдХ рдирдП рдЯреИрд░рд┐рдл рдореЗрдВ рдмрджрд▓ рдЬрд╛рдПрдЧрд╛, рдФрд░ рднреБрдЧрддрд╛рди рдХреА рдЧрдИ рдЕрд╡рдзрд┐ рдХреЗ рдЕрдкреНрд░рдпреБрдХреНрдд рд╣рд┐рд╕реНрд╕реЗ рдХреЛ рдХрд╛рд░реНрдб рдореЗрдВ рд╡рд╛рдкрд╕ рдХрд░ рджрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред </p><br><img src="https://habrastorage.org/webt/y-/fl/7d/y-fl7dwabjscib2zi6wwkwnwmdq.png"><br><p>  <em>рд╕рджрд╕реНрдпрддрд╛ рдХреЛ рдЕрдкрдЧреНрд░реЗрдб рдХрд░рддреЗ рд╕рдордп рдзрдирд░рд╛рд╢рд┐ рдХрд╛ рд╡рд╣ рд╣рд┐рд╕реНрд╕рд╛ рд╡рд╛рдкрд╕ рдХрд░ рджрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред</em> </p><br><p>  рд▓реЗрдЦ рдХреЗ рдЕрдВрдд рдореЗрдВ, рд╣рдо рджреЗрдЦреЗрдВрдЧреЗ рдХрд┐ рд╕рджрд╕реНрдпрддрд╛ рд╕реНрддрд░ рдореЗрдВ рд╡реГрджреНрдзрд┐ рдХреЛ рдХреИрд╕реЗ рдкрдХрдбрд╝рд╛ рдЬрд╛рдП рдФрд░ рд╡рд╛рдкрд╕реА рдХреА рдорд╛рддреНрд░рд╛ рдХреА рдЧрдгрдирд╛ рдХрд░реЗрдВред </p><br><h4 id="ponizhenie-urovnya-podpiski-daungreyd">  рд╕рджрд╕реНрдпрддрд╛ рдбрд╛рдЙрдирдЧреНрд░реЗрдб (рдбрд╛рдЙрдирдЧреНрд░реЗрдб) </h4><br><p>  рд╕реНрддрд░ рдХреЛ рдХрдо рдХрд░рдХреЗ, рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╡рд░реНрддрдорд╛рди рднреБрдЧрддрд╛рди рдЕрд╡рдзрд┐ рдХреЗ рдЕрдВрдд рдореЗрдВ рдПрдХ рдирдП рдкрд░ рд╕реНрд╡рд┐рдЪ рдХрд░рддрд╛ рд╣реИред  рдирд┐рдзрд┐ рд╡рд╛рдкрд╕ рдирд╣реАрдВ рдХреА рдЬрд╛рддреА рд╣реИ, рдФрд░ рд╕рдХреНрд░рд┐рдпрдг рдкрд░ рдПрдХ рдирдИ рд╕рджрд╕реНрдпрддрд╛ рдХреА рд▓рд╛рдЧрдд рдбреЗрдмрд┐рдЯ рд╣реЛрддреА рд╣реИред </p><br><h4 id="smena-podpiski-v-ramkah-odnogo-urovnya-krossgreyd">  рдЙрд╕реА рд╕реНрддрд░ рдкрд░ рд╕рджрд╕реНрдпрддрд╛ рдХрд╛ рдкрд░рд┐рд╡рд░реНрддрди (рдХреНрд░реЙрд╕-рдЧреНрд░реЗрдб) </h4><br><p>  рдпрд╣ рдПрдХ рд╕рд╛рдорд╛рдиреНрдп рд╕реНрдерд┐рддрд┐ рд╣реИ, рдЗрд╕реЗ рджреЛ рдкреНрд░рдХрд╛рд░реЛрдВ рдореЗрдВ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ: рдПрдХ рдЕрд╡рдзрд┐ рдХрд╛ рд╕рджрд╕реНрдпрддрд╛ рдкрд░рд┐рд╡рд░реНрддрди рдФрд░ рдЕрд▓рдЧ-рдЕрд▓рдЧред  рдХрд┐рд╕реА рднрд┐рдиреНрди рдЕрд╡рдзрд┐ рдХреЗ рд╕рд╛рде рд╕рджрд╕реНрдпрддрд╛ рдмрджрд▓рддреЗ рд╕рдордп, рдбрд╛рдЙрдирдЧреНрд░реЗрдб рдХреЗ рд╕рд╛рде рднреА рдпрд╣реА рд╣реЛрдЧрд╛: рд╕рджрд╕реНрдпрддрд╛ рд╡рд░реНрддрдорд╛рди рднреБрдЧрддрд╛рди рдЕрд╡рдзрд┐ рдХреЗ рдЕрдВрдд рдореЗрдВ рд▓рд╛рдЧреВ рдХреА рдЬрд╛рдПрдЧреАред </p><br><p>  рдпрджрд┐ рдЕрд╡рдзрд┐ рдорд┐рд▓рд╛рди рд╣реЛрддреА рд╣реИ, рддреЛ рд╡рд░реНрддрдорд╛рди рд╕рджрд╕реНрдпрддрд╛ рд░рджреНрдж рд╣реЛ рдЬрд╛рдПрдЧреА рдФрд░ рдПрдХ рдирдпрд╛ рддреБрд░рдВрдд рд╢реБрд░реВ рд╣реЛ рдЬрд╛рдПрдЧрд╛ред  рдирдИ рд╕рджрд╕реНрдпрддрд╛ рдХреЗ рд▓рд┐рдП рдкреИрд╕рд╛ рдбреЗрдмрд┐рдЯ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛, рдФрд░ рдкреБрд░рд╛рдиреА рд╕рджрд╕реНрдпрддрд╛ рдХрд╛ рдЕрдкреНрд░рдпреБрдХреНрдд рд╣рд┐рд╕реНрд╕рд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рд╡рд╛рдкрд╕ рдХрд░ рджрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред </p><br><h2 id="kak-uznat-o-smene-podpiski-na-servere">  рд╕рд░реНрд╡рд░ рдкрд░ рд╕рджрд╕реНрдпрддрд╛ рдмрджрд▓рдиреЗ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдХреИрд╕реЗ рдкрддрд╛ рдХрд░реЗрдВ? </h2><br><p>  рдЖрдк <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдРрдк рд╕реНрдЯреЛрд░ рдХреА рдЬрд╛рдВрдЪ</a> рдХреЛ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╕рддреНрдпрд╛рдкрд┐рдд</a> рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдпрд╛ рдРрдкреНрдкрд▓ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╕рд░реНрд╡рд░ рд╕реВрдЪрдирд╛рдУрдВ рдХреЛ рд╕реБрди</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╕рдХрддреЗ рд╣реИрдВ</a> ред </p><br><p>  рдкреНрд░рддреНрдпреЗрдХ рдирдП рд▓реЗрдирджреЗрди рдХреА рдЬрд╛рдВрдЪ рдХрд░рддреЗ рд╕рдордп, рдЖрдкрдХреЛ рдпрд╣ рджреЗрдЦрдиреЗ рдХреА рдЬрд░реВрд░рдд рд╣реИ рдХрд┐ рдХреНрдпрд╛ <em>product_id</em> рдмрджрд▓ рдЧрдпрд╛ рд╣реИред  <em>Product_id</em> рдмрджрд▓рдиреЗ рдХрд╛ рдЕрд░реНрде рд╣реИ рдХрд┐ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдиреЗ App Store рд╕реЗрдЯрд┐рдВрдЧ рдореЗрдВ рдЕрдкрдиреА рд╕рджрд╕реНрдпрддрд╛ рдмрджрд▓ рджреА рд╣реИред </p><br><p> рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдЖрдк <code>auto_renew_product_id</code> рдХреЗ рдорд╛рди рдХреЛ <code>auto_renew_product_id</code> рдореЗрдВ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВред  рдирдИ рд╕рджрд╕реНрдпрддрд╛ рдкреНрд░рднрд╛рд╡реА рд╣реЛрдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдЖрдкрдХреЛ <em>product_id рдореЗрдВ</em> рдкрд░рд┐рд╡рд░реНрддрди рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдиреЗ рдореЗрдВ рдорджрдж рдорд┐рд▓реЗрдЧреАред </p><br><p>  рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╕рд░реНрд╡рд░ рд╕реВрдЪрдирд╛рдПрдВ</a> рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХреА рдЧрдИ рд╣реИрдВ, рддреЛ <em>DID_CHANGE_RENEWAL_PREF</em> рдЕрдзрд┐рд╕реВрдЪрдирд╛ рдХреЛ <em>рд╕реБрдиреЗрдВ</em> , рдЬрд┐рд╕реЗ рдЙрддреНрдкрд╛рдж <em>рдкрд░рд┐рд╡рд░реНрддрд┐рдд</em> рд╣реЛрдиреЗ рдкрд░ рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИред  рдЖрдк рдЕрдкрдиреЗ рдЖрдк рдХреЛ рдЗрд╕ рд╕реВрдЪрдирд╛ рддрдХ рд╕реАрдорд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЕрдиреБрд░реЛрдз рдорд╛рдирдХреЛрдВ рд╕реЗ рдирдпрд╛ <em>product_id</em> рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдпрд╛ рдЖрдк рдРрдк рд╕реНрдЯреЛрд░ рд░рд╕реАрдж рдХреА рдлрд┐рд░ рд╕реЗ рдЬрд╛рдВрдЪ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  рдмрд╛рдж рдХреЗ рдорд╛рдорд▓реЗ рдореЗрдВ, Apple рд╕рд░реНрд╡рд░ рдиреЛрдЯрд┐рдлрд┐рдХреЗрд╢рди рдХреЗрд╡рд▓ рдПрдХ рдЕрдирд┐рд░реНрдзрд╛рд░рд┐рдд рдЪреЗрдХ рдХреЗ рд▓рд┐рдП рдЯреНрд░рд┐рдЧрд░ рдХреЗ рд░реВрдк рдореЗрдВ рдХрд╛рдо рдХрд░реЗрдЧрд╛ред </p><br><h2 id="kak-vychislit-summu-vozvrata-pri-apgreydah">  рдЙрдиреНрдирдпрди рдХреЗ рд▓рд┐рдП рд╡рд╛рдкрд╕реА рдХреА рдорд╛рддреНрд░рд╛ рдХреА рдЧрдгрдирд╛ рдХреИрд╕реЗ рдХрд░реЗрдВ? </h2><br><p>  рдпрд╣ рд╕рдордЭрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ рдХреНрдпрд╛ рдХреЛрдИ рдЕрдкрдЧреНрд░реЗрдб рдерд╛, рдЖрдкрдХреЛ <code>is_upgraded</code> рдлрд╝реАрд▓реНрдб рдХрд╛ рдорд╛рди рдЬрд╛рдБрдЪрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред  <code>true</code> рдореВрд▓реНрдп рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдЕрдЧрд▓рд╛ рд▓реЗрдирджреЗрди рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдирдИ рд╕рджрд╕реНрдпрддрд╛ рдореЗрдВ рд╣реИред </p><br><p>  рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ <code>is_upgraded</code> рд╕рдорд╛рди рдЕрд╡рдзрд┐ рдХреЗ рднреАрддрд░ рд╕рдорд╛рди рдЕрд╡рдзрд┐ рдХреЗ рд╕рд╛рде рд╕рджрд╕реНрдпрддрд╛ рдмрджрд▓рддреЗ рд╕рдордп рднреА <code>true</code> рд╣реЛрдЧрд╛ред  рдпрд╣реА рд╣реИ, <code>is_upgraded = true</code> рдорддрд▓рдм рд╕реНрддрд░ рдореЗрдВ рд╡реГрджреНрдзрд┐ рдирд╣реАрдВ рд╣реИ, рд▓реЗрдХрд┐рди рддрдереНрдп рдпрд╣ рд╣реИ рдХрд┐ рдзрдирд╡рд╛рдкрд╕реА рдХреЗ рд╕рд╛рде рд╕рджрд╕реНрдпрддрд╛ рдкрд░рд┐рд╡рд░реНрддрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред </p><br><p>  <code>is_upgraded</code> рдлрд╝реАрд▓реНрдб рдХреЗ рдЕрддрд┐рд░рд┐рдХреНрдд, рдЗрд╕ рд▓реЗрдирджреЗрди рдореЗрдВ <code>cancellation_date</code> рдлрд╝реАрд▓реНрдб рджрд┐рдЦрд╛рдИ рджреЗрдЧреА, рдЬреЛ рд░рджреНрдж рдХрд░рдиреЗ рдХреЗ рд╕рдордп рдХреЛ рдЗрдВрдЧрд┐рдд рдХрд░рддреА рд╣реИред  рдпрд╣ рдЕрдЧрд▓реЗ рд▓реЗрдирджреЗрди рдХреА рд╢реБрд░реБрдЖрдд рдХреА рддрд╛рд░реАрдЦ рдХреЗ рдмрд░рд╛рдмрд░ рдпрд╛ рд▓рдЧрднрдЧ рдореЗрд▓ рдЦрд╛рддрд╛ рд╣реИред </p><br><p>  рдпрд╣ рдкрддрд╛ рдЪрд▓рд╛ рд╣реИ рдХрд┐ <code>cancellation_date</code> рдлрд╝реАрд▓реНрдб <strong>рди рдХреЗрд╡рд▓ рд╕рджрд╕реНрдпрддрд╛ рдХреЗ рд╡рд╛рдкрд╕ рдЖрдиреЗ рдкрд░</strong> рдкреНрд░рдХрдЯ рд╣реЛрддрд╛ <strong>рд╣реИ</strong> , рдмрд▓реНрдХрд┐ рдЕрдкрдЧреНрд░реЗрдб рдХрд░рддреЗ рд╕рдордп рднреА рджрд┐рдЦрд╛рдИ рджреЗрддрд╛ <strong>рд╣реИ</strong> ред </p><br><p>  рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ <strong>рд╕реИрдВрдбрдмреЙрдХреНрд╕ рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдХреЛ рдЕрдкрдЧреНрд░реЗрдб</strong> рдХрд░рддреЗ <strong>рд╕рдордп, <code>cancellation_date</code> рдлрд╝реАрд▓реНрдб рдЕрдиреБрдкрд▓рдмреНрдз рд╣реИ</strong> ред  рдЗрд╕рд▓рд┐рдП, рд╕реИрдВрдбрдмреЙрдХреНрд╕ рдореЗрдВ рдкрд░реАрдХреНрд╖рдг рдХрд░рддреЗ рд╕рдордп, рдЖрдкрдХреЛ <code>cancellation_date</code> рдмрдЬрд╛рдп рдЕрдЧрд▓реЗ рд▓реЗрдирджреЗрди рдХреА рдЦрд░реАрдж_рдбреЗрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ <code>cancellation_date</code> ред  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">Apple рджрд╕реНрддрд╛рд╡реЗрдЬрд╝реАрдХрд░рдг рдореЗрдВ</a> рд░рджреНрдж рдХрд░рдиреЗ рдХреА рддрд╛рд░реАрдЦ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдФрд░ рдкрдврд╝реЗрдВред </p><br><p>  рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рд╡рд╛рдкрд╕ рдХреА рдЬрд╛рдиреЗ рд╡рд╛рд▓реА рд░рд╛рд╢рд┐ рдХреА рдЧрдгрдирд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ рдЕрдкреНрд░рдпреБрдХреНрдд рдЕрд╡рдзрд┐ рдХреЛ рдкрд┐рдЫрд▓реА рд╕рджрд╕реНрдпрддрд╛ рдХреА рдкреВрд░реА рдЕрд╡рдзрд┐ рд╕реЗ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд░рдиреЗ рдФрд░ рдЗрд╕рдХреА рд▓рд╛рдЧрдд рд╕реЗ рдЧреБрдгрд╛ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ: </p><br><pre> <code class="ruby hljs"><span class="hljs-comment"><span class="hljs-comment"># upgrade_date is `cancellation_date` in prodiction or `purchase_date` of new transaction in sandbox # to_f converts date to float timestamp value prorate_amount = price * (upgrade_date.to_f - cancellation_date.to_f) / (expires_date.to_f - purchase_date.to_f)</span></span></code> </pre> <br><h2 id="kak-eto-realizovano-v-apphud">  рдпрд╣ Apphud рдореЗрдВ рдХреИрд╕реЗ рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ? </h2><br><p>  Apphud рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рд╕рджрд╕реНрдпрддрд╛ рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрди рдХреЛ рдЯреНрд░реИрдХ рдХрд░рддрд╛ рд╣реИ рдФрд░ рдЕрдкреНрд░рдпреБрдХреНрдд рднрд╛рдЧреЛрдВ рдХреА рд╡рд╛рдкрд╕реА рдХреА рдЧрдгрдирд╛ рдХрд░рддрд╛ рд╣реИред </p><br><img src="https://habrastorage.org/webt/i-/ni/wk/i-niwkapdw5jjoaztapmznegq-c.png"><br><p>  <em>Apphud рдореЗрдВ рдзрди рдХреЗ рд╣рд┐рд╕реНрд╕реЗ рдХреА рд╡рд╛рдкрд╕реА рдХреЗ рд╕рд╛рде рдПрдХ рд╣реА рд╕реНрддрд░ рдкрд░ рд╕рджрд╕реНрдпрддрд╛ рдкрд░рд┐рд╡рд░реНрддрди рдХрд╛ рдПрдХ рдЙрджрд╛рд╣рд░рдгред</em> </p><br><p>  рдПрдХ iOS рдбреЗрд╡рд▓рдкрд░ рдХреЛ рдЗрди рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдХреЛ рд╕реНрд╡рдпрдВ рд╕рдВрднрд╛рд▓рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИред  рдЖрдкрдХреЛ рдХреЗрд╡рд▓ рдПрд╕рдбреАрдХреЗ рдХреЛ рдПрдХреАрдХреГрдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдмрд╛рдХреА рдПрдкреНрд╣реБрдб рджреНрд╡рд╛рд░рд╛ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред </p><br><h2 id="zaklyuchenie">  рдирд┐рд╖реНрдХрд░реНрд╖ </h2><br><p>  рдпрд╣ рдкрддрд╛ рдЪрд▓рд╛ рд╣реИ рдХрд┐ рд╕рд┐рд░реНрдл <code>product_id</code> рдорд╛рди рдЕрдкрдбреЗрдЯ рдХрд░рдирд╛ рд╣реА рдкрд░реНрдпрд╛рдкреНрдд рдирд╣реАрдВ рд╣реИ: рдЖрдкрдХреЛ рдЕрдкрдЧреНрд░реЗрдб рдХреЗ рд▓рд┐рдП рдзрдирд╡рд╛рдкрд╕реА рдкрд░ рднреА рд╡рд┐рдЪрд╛рд░ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред  рд╕рджрд╕реНрдпрддрд╛ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрдИ рд╕реАрдорд╛рд╡рд░реНрддреА рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдХреЛ рд╕рдВрднрд╛рд▓рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред  рд╣рдо <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдРрдкрд╣реБрдб</a> рдмрдирд╛рддреЗ рд╣реИрдВ - рдПрдХ рд╕реЗрд╡рд╛ рдЬреЛ рд╕рджрд╕реНрдпрддрд╛ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХреЛ рдмрд╣реБрдд рд╕рд░рд▓ рдХрд░рддреА рд╣реИред  рдЖрдк рдЗрд╕реЗ рдореБрдлреНрдд рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╢реБрд░реВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  рдкрдВрдЬреАрдХрд░рдг - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЗрд╕ рд▓рд┐рдВрдХ рдкрд░</a> ред </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/hi475758/">https://habr.com/ru/post/hi475758/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi475746/index.html">рдзреНрд╡рдирд┐рдХ рдкреНрд░рдгрд╛рд▓реА рдХрд╛ рдПрдирд╛рдЯреЙрдореА: рд╕реАрд░рдореЗрдЯреНрд╕ рдФрд░ рдХрдореНрдкреЛрдЬрд┐рдЯ - рдореЙрдирд┐рдЯрд░ рдСрдбрд┐рдпреЛ рдбрд┐рдлреНрдпреВрдЬрд╝рд░ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ</a></li>
<li><a href="../hi475748/index.html">22 рдирд╡рдВрдмрд░, рдореЙрд╕реНрдХреЛ - рдПрдирд╛рд▓рд╛рдЗрдЬрд╝рд┐рдЯ рдореАрдЯрдЕрдк рдирдВрдмрд░ 3</a></li>
<li><a href="../hi475750/index.html">рдЬреНрдЮрд╛рди рд╣рд╕реНрддрд╛рдВрддрд░рдг рдФрд░ рд╡реНрдпрд╡рд╣рд╛рд░ рдореЗрдВ рддрдВрддреНрд░рд┐рдХрд╛ рдорд╢реАрди рдЕрдиреБрд╡рд╛рдж</a></li>
<li><a href="../hi475754/index.html">рдШреЛрдЯрд╛рд▓реЗ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╢реЙрд░реНрдЯреНрд╕</a></li>
<li><a href="../hi475756/index.html">рдЦрд╛рджреНрдп рдбрд┐рдЬрд╛рдЗрди рдбрд╛рдЗрдЬреЗрд╕реНрдЯ рдЕрдХреНрдЯреВрдмрд░ 2019</a></li>
<li><a href="../hi475760/index.html">рдЬреВрдирд┐рдпрд░ рдбреЗрд╡рд▓рдкрд░реНрд╕ - рд╣рдо рдЙрдиреНрд╣реЗрдВ рдХреНрдпреЛрдВ рд▓реЗрддреЗ рд╣реИрдВ рдФрд░ рд╣рдо рдЙрдирдХреЗ рд╕рд╛рде рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ</a></li>
<li><a href="../hi475762/index.html">рдПрдХ рддрд╕реНрд╡реАрд░ рдХреЗ рд╕рд╛рде рдПрдХ рдлрд┐рд░ рд╕реЗ рд╢реБрд░реВ рдПрдХ рдХрд▓рд╢ рдореЗрдВ рдЙрдбрд╝ рдЬрд╛рддрд╛ рд╣реИред рд╕рдВрдпреБрдХреНрдд рд░рд╛рдЬреНрдп рдЕрдореЗрд░рд┐рдХрд╛ рдореЗрдВ рдиреМрдХрд░реА рдЦреЛрдЬ рдХреА рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдВ</a></li>
<li><a href="../hi475764/index.html">рдкреНрд░рдХреНрд░рд┐рдпрд╛рддреНрдордХ рдирд┐рд░реНрдорд╛рдг рдкреАрдврд╝реА рдХреЗ рд▓рд┐рдП рдорд╛рд░реНрдХреЛрд╡ рд╢реНрд░реГрдВрдЦрд▓рд╛</a></li>
<li><a href="../hi475768/index.html">Kotlin: рдпрд╣ рдПрдВрдбреНрд░реЙрдЗрдб рдРрдк рдбреЗрд╡рд▓рдкрдореЗрдВрдЯ рдХреЗ рд▓рд┐рдП рдПрдХ рдмрдврд╝рд┐рдпрд╛ рд╡рд┐рдХрд▓реНрдк рдХреИрд╕реЗ рд╣реИ?</a></li>
<li><a href="../hi475770/index.html">рд╕реНрдЯреИрдирдлреЛрд░реНрдб рд╡рд┐рд╢реНрд╡рд╡рд┐рджреНрдпрд╛рд▓рдп - рдпрд╛рддреНрд░рд╛ рдФрд░ рд╕рдореАрдХреНрд╖рд╛</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>