<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚úçüèø üë®üèº‚Äç‚öñÔ∏è üçÆ RecyclerView a la velocidad m√°xima: an√°lisis de bibliotecas üö∞ ü¶Ü üï¥üèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ilya Nekrasov, Mahtalitet , desarrollador de Android de KODE 
 Durante dos a√±os y medio en el desarrollo de Android, logr√© trabajar en proyectos compl...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>RecyclerView a la velocidad m√°xima: an√°lisis de bibliotecas</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/redmadrobot/blog/428525/"><p><img src="https://habrastorage.org/webt/02/i_/cl/02i_cl7q71uldgrkijpim0a0agk.jpeg"></p><br><p><img src="https://habrastorage.org/webt/np/kh/rc/npkhrc7elthbz0riiye9ri5zu1g.png" align="left">  <strong>Ilya Nekrasov, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" class="user_link">Mahtalitet</a> , desarrollador de Android de KODE</strong> <br>  <em>Durante dos a√±os y medio en el desarrollo de Android, logr√© trabajar en proyectos completamente diferentes: desde una red social para automovilistas y un banco let√≥n hasta un sistema de bonificaci√≥n federal y la tercera aerol√≠nea para el transporte.</em>  <em>De todos modos, en cada uno de estos proyectos, me encontr√© con tareas que requer√≠an la b√∫squeda de soluciones no cl√°sicas al implementar listas utilizando la clase RecyclerView.</em> <em><br></em>  <em>Este art√≠culo, fruto de la preparaci√≥n para una presentaci√≥n en DevFest Kaliningrad'18, as√≠ como de comunicarse con colegas, ser√° especialmente √∫til para los desarrolladores principiantes y aquellos que han usado solo una de las bibliotecas existentes.</em> </p><br><p>  Para comenzar, profundicemos un poco en la esencia del problema y la fuente del dolor, es decir, el crecimiento de la funcionalidad en el desarrollo de la aplicaci√≥n y la complejidad de las listas utilizadas. </p><a name="habracut"></a><br><h2 id="glava-pervaya-v-kotoroy-zakazchik-mechtaet-o-prilozhenii-a-my--o-chetkih-trebovaniyah">  Cap√≠tulo uno, en el que el cliente sue√±a con una aplicaci√≥n, y nosotros, sobre requisitos claros </h2><br><p><img src="https://habrastorage.org/webt/fi/wb/vs/fiwbvsaeyquagqloswybveolmaq.gif" align="right">  Imaginemos una situaci√≥n en la que un cliente contacta a un estudio que quiere una aplicaci√≥n m√≥vil para una tienda de patos de goma. </p><br><p>  El proyecto se est√° desarrollando r√°pidamente, surgen nuevas ideas regularmente y no se enmarcan en una hoja de ruta a largo plazo. </p><br><p>  Primero, el cliente nos pide que muestremos una lista de productos existentes y, cuando se hace clic en ella, completamos una solicitud de entrega.  No tiene que ir muy lejos para encontrar una soluci√≥n: utilizamos el conjunto cl√°sico de <strong>RecyclerView</strong> , un adaptador simple escrito para √©l y <strong>Activity</strong> . </p><br><p>  Para el adaptador, utilizamos datos homog√©neos, un <strong>ViewHolder</strong> y una l√≥gica de enlace simple. </p><br><div class="spoiler">  <b class="spoiler_title">Adaptador con patos</b> <div class="spoiler_text"><pre><code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DucksClassicAdapter</span></span></span></span>( <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> <span class="hljs-keyword"><span class="hljs-keyword">data</span></span>: List&lt;Duck&gt;, <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> onDuckClickAction: (Duck) -&gt; <span class="hljs-built_in"><span class="hljs-built_in">Unit</span></span> ) : RecyclerView.Adapter&lt;DucksClassicAdapter.ViewHolder&gt;() { <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreateViewHolder</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(parent: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">ViewGroup</span></span></span></span><span class="hljs-function"><span class="hljs-params">, viewType: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Int</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>: ViewHolder { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> rubberDuckView = LayoutInflater.from(parent.context).inflate(R.layout.item_rubber_duck, parent, <span class="hljs-literal"><span class="hljs-literal">false</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ViewHolder(rubberDuckView) } <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onBindViewHolder</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(holder: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">ViewHolder</span></span></span></span><span class="hljs-function"><span class="hljs-params">, position: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Int</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> duck = <span class="hljs-keyword"><span class="hljs-keyword">data</span></span>[position] holder.divider.isVisible = position != <span class="hljs-number"><span class="hljs-number">0</span></span> holder.rubberDuckImage.apply { Picasso.<span class="hljs-keyword"><span class="hljs-keyword">get</span></span>() .load(duck.icon) .config(Bitmap.Config.ARGB_4444) .fit() .centerCrop() .noFade() .placeholder(R.drawable.duck_stub) .into(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>) } holder.clicksHolder.setOnClickListener { onDuckClickAction.invoke(duck) } } <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getItemCount</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> = <span class="hljs-keyword"><span class="hljs-keyword">data</span></span>.count() <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ViewHolder</span></span></span></span>(view: View) : RecyclerView.ViewHolder(view) { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> rubberDuckImage: ImageView = view.findViewById(R.id.rubberDuckImage) <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> clicksHolder: View = view.findViewById(R.id.clicksHolder) <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> divider: View = view.findViewById(R.id.divider) } }</code> </pre> </div></div><br><p><br><br><img src="https://habrastorage.org/webt/kh/bn/x3/khbnx3_a59poubdcheopd3e5ax4.gif" align="left">  Con el tiempo, el cliente tiene la idea de agregar otra categor√≠a de productos a los patos de goma, lo que significa que tendr√° que agregar un nuevo modelo de datos y un nuevo dise√±o.  Pero lo m√°s importante, aparecer√° otro <strong>ViewType</strong> en el adaptador, con el que puede determinar qu√© ViewHolder usar para un elemento de lista espec√≠fico. </p><br><p>  Despu√©s de eso, los encabezados se agregan a las categor√≠as, seg√∫n las cuales cada categor√≠a se puede contraer y expandir para simplificar la orientaci√≥n de los usuarios en la tienda.  Esto es m√°s otro <strong>ViewType</strong> y <strong>ViewHolder</strong> para encabezados.  Adem√°s, tendr√° que complicar el adaptador, ya que necesita mantener una lista de grupos abiertos y usarla para verificar la necesidad de ocultar y mostrar este o aquel elemento haciendo clic en el encabezado. </p><br><div class="spoiler">  <b class="spoiler_title">Adaptador con todo</b> <div class="spoiler_text"><pre> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DucksClassicAdapter</span></span></span></span>( <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> onDuckClickAction: (Pair&lt;Duck, <span class="hljs-built_in"><span class="hljs-built_in">Int</span></span>&gt;) -&gt; <span class="hljs-built_in"><span class="hljs-built_in">Unit</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> onSlipperClickAction: (Duck) -&gt; <span class="hljs-built_in"><span class="hljs-built_in">Unit</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> onAdvertClickAction: (Advert) -&gt; <span class="hljs-built_in"><span class="hljs-built_in">Unit</span></span> ) : RecyclerView.Adapter&lt;RecyclerView.ViewHolder&gt;() { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> <span class="hljs-keyword"><span class="hljs-keyword">data</span></span>: List&lt;Duck&gt; = emptyList() <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>(value) { field = value internalData = <span class="hljs-keyword"><span class="hljs-keyword">data</span></span>.groupBy { it.javaClass.kotlin } .flatMap { groupedDucks -&gt; <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> titleRes = <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> (groupedDucks.key) { DuckSlipper::<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> -&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">R</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">string</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">slippers</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RubberDuck</span></span></span><span class="hljs-class">:</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">:class -&gt; R.string.rubber_ducks else -&gt; R.string.mixed_ducks } groupedDucks.value.let { listOf</span></span></span></span>(FakeDuck(titleRes, it)).plus(it) } } .toMutableList() duckCountsAdapters = internalData.map { duck -&gt; <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> rubberDuck = (duck <span class="hljs-keyword"><span class="hljs-keyword">as</span></span>? RubberDuck) DucksCountAdapter( <span class="hljs-keyword"><span class="hljs-keyword">data</span></span> = (<span class="hljs-number"><span class="hljs-number">1</span></span>..(rubberDuck?.count ?: <span class="hljs-number"><span class="hljs-number">1</span></span>)).map { count -&gt; duck to count }, onCountClickAction = { onDuckClickAction.invoke(it) } ) } } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> advert = DuckMockData.adverts.orEmpty().shuffled().first() <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> internalData: MutableList&lt;Duck&gt; = mutableListOf() <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> duckCountsAdapters: List&lt;DucksCountAdapter&gt; = emptyList() <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> collapsedHeaders: MutableSet&lt;Duck&gt; = hashSetOf() <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreateViewHolder</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(parent: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">ViewGroup</span></span></span></span><span class="hljs-function"><span class="hljs-params">, viewType: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Int</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>: RecyclerView.ViewHolder { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> (viewType) { VIEW_TYPE_RUBBER_DUCK -&gt; { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> view = parent.context.inflate(R.layout.item_rubber_duck, parent) DuckViewHolder(view) } VIEW_TYPE_SLIPPER_DUCK -&gt; { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> view = parent.context.inflate(R.layout.item_duck_slipper, parent) SlipperViewHolder(view) } VIEW_TYPE_HEADER -&gt; { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> view = parent.context.inflate(R.layout.item_header, parent) HeaderViewHolder(view) } VIEW_TYPE_ADVERT -&gt; { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> view = parent.context.inflate(R.layout.item_advert, parent) AdvertViewHolder(view) } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> UnsupportedOperationException(<span class="hljs-string"><span class="hljs-string">"view type </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$viewType</span></span></span><span class="hljs-string"> without ViewHolder"</span></span>) } } <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onBindViewHolder</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(holder: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">RecyclerView</span></span></span></span><span class="hljs-function"><span class="hljs-params">.</span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">ViewHolder</span></span></span></span><span class="hljs-function"><span class="hljs-params">, position: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Int</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> (holder) { <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> HeaderViewHolder -&gt; bindHeaderViewHolder(holder, position) <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> DuckViewHolder -&gt; bindDuckViewHolder(holder, position) <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> SlipperViewHolder -&gt; bindSlipperViewHolder(holder, position) <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> AdvertViewHolder -&gt; bindAdvertViewHolder(holder) } } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bindAdvertViewHolder</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(holder: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">AdvertViewHolder</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { holder.advertImage.showIcon(advert.icon) holder.advertTagline.text = advert.tagline holder.itemView.setOnClickListener { onAdvertClickAction.invoke(advert) } } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bindHeaderViewHolder</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(holder: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">HeaderViewHolder</span></span></span></span><span class="hljs-function"><span class="hljs-params">, position: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Int</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> item = getItem(position) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> FakeDuck holder.clicksHolder.setOnClickListener { changeCollapseState(item, position) } <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> arrowRes = <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (collapsedHeaders.contains(item)) R.drawable.ic_keyboard_arrow_up_black_24dp <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> R.drawable.ic_keyboard_arrow_down_black_24dp holder.arrow.setImageResource(arrowRes) holder.title.setText(item.titleRes) } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">changeCollapseState</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(item: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">FakeDuck</span></span></span></span><span class="hljs-function"><span class="hljs-params">, position: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Int</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> isCollapsed = collapsedHeaders.contains(item) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (isCollapsed) { collapsedHeaders.remove(item) } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { collapsedHeaders.add(item) } <span class="hljs-comment"><span class="hljs-comment">// 1 to add items after header val startPosition = position + 1 if (isCollapsed) { internalData.addAll(startPosition - ADVERTS_COUNT, item.items) notifyItemRangeInserted(startPosition, item.items.count()) } else { internalData.removeAll(item.items) notifyItemRangeRemoved(startPosition, item.items.count()) } notifyItemChanged(position) } @SuppressLint("SetTextI18n") private fun bindSlipperViewHolder(holder: SlipperViewHolder, position: Int) { val slipper = getItem(position) as DuckSlipper holder.duckSlipperImage.showIcon(slipper.icon) holder.duckSlipperSize.text = ": ${slipper.size}" holder.clicksHolder.setOnClickListener { onSlipperClickAction.invoke(slipper) } } private fun bindDuckViewHolder(holder: DuckViewHolder, position: Int) { val duck = getItem(position) as RubberDuck holder.rubberDuckImage.showIcon(duck.icon) holder.rubberDuckCounts.adapter = duckCountsAdapters[position - ADVERTS_COUNT] val context = holder.itemView.context holder.rubberDuckCounts.layoutManager = LinearLayoutManager(context, HORIZONTAL, false) } override fun getItemViewType(position: Int): Int { if (position == 0) return VIEW_TYPE_ADVERT return when (getItem(position)) { is FakeDuck -&gt; VIEW_TYPE_HEADER is RubberDuck -&gt; VIEW_TYPE_RUBBER_DUCK is DuckSlipper -&gt; VIEW_TYPE_SLIPPER_DUCK else -&gt; throw UnsupportedOperationException("unknown type for $position position") } } private fun getItem(position: Int) = internalData[position - ADVERTS_COUNT] override fun getItemCount() = internalData.count() + ADVERTS_COUNT class DuckViewHolder(view: View) : RecyclerView.ViewHolder(view) { val rubberDuckImage: ImageView = view.findViewById(R.id.rubberDuckImage) val rubberDuckCounts: RecyclerView = view.findViewById(R.id.rubberDuckCounts) } class SlipperViewHolder(view: View) : RecyclerView.ViewHolder(view) { val duckSlipperImage: ImageView = view.findViewById(R.id.duckSlipperImage) val duckSlipperSize: TextView = view.findViewById(R.id.duckSlipperSize) val clicksHolder: View = view.findViewById(R.id.clicksHolder) } class HeaderViewHolder(view: View) : RecyclerView.ViewHolder(view) { val title: TextView = view.findViewById(R.id.headerTitle) val arrow: ImageView = view.findViewById(R.id.headerArrow) val clicksHolder: View = view.findViewById(R.id.clicksHolder) } class AdvertViewHolder(view: View) : RecyclerView.ViewHolder(view) { val advertTagline: TextView = view.findViewById(R.id.advertTagline) val advertImage: ImageView = view.findViewById(R.id.advertImage) } } private class FakeDuck( val titleRes: Int, val items: List&lt;Duck&gt; ) : Duck private fun ImageView.showIcon(icon: String, placeHolderRes: Int = R.drawable.duck_stub) { Picasso.get() .load(icon) .config(Bitmap.Config.ARGB_4444) .fit() .centerCrop() .noFade() .placeholder(placeHolderRes) .into(this) } private class DucksCountAdapter( private val data: List&lt;Pair&lt;Duck, Int&gt;&gt;, private val onCountClickAction: (Pair&lt;Duck, Int&gt;) -&gt; Unit ) : RecyclerView.Adapter&lt;RecyclerView.ViewHolder&gt;() { override fun onCreateViewHolder(parent: ViewGroup, viewType: Int): RecyclerView.ViewHolder { val view = parent.context.inflate(R.layout.item_duck_count, parent) return CountViewHolder(view) } override fun getItemCount() = data.count() override fun onBindViewHolder(holder: RecyclerView.ViewHolder, position: Int) { (holder as CountViewHolder).count.apply { val item = data[position] text = item.second.toString() setOnClickListener { onCountClickAction.invoke(item) } } } class CountViewHolder(view: View) : RecyclerView.ViewHolder(view) { val count: TextView = view.findViewById(R.id.count) } }</span></span></code> </pre> </div></div><br><p>  Creo que entiendes el punto: tal mont√≥n de peque√±os se asemeja a un desarrollo saludable.  Adem√°s, cada vez hay m√°s requisitos nuevos del cliente: fijar un banner publicitario en la parte superior de la lista, darse cuenta de la posibilidad de elegir el n√∫mero de patos ordenados.  Solo estas tareas finalmente se convertir√°n en adaptadores regulares, que nuevamente tendr√°n que escribirse desde cero. </p><br><blockquote>  El proceso de desarrollar un adaptador cl√°sico en la historia de <a href="">github</a> </blockquote><br><h3 id="itogi">  Resumen </h3><br><p>  De hecho, la imagen no es nada alentadora: los adaptadores individuales deben ser afilados para casos espec√≠ficos.  Todos entendemos que en una aplicaci√≥n real hay docenas o incluso cientos de tales pantallas de lista.  Y no contienen informaci√≥n sobre patos, sino datos m√°s complejos.  S√≠, y su dise√±o es mucho m√°s complicado. </p><br><h3 id="chto-ne-tak-s-nashimi-adapterami">  ¬øQu√© hay de malo con nuestros adaptadores? </h3><br><ul><li>  obviamente, son dif√≠ciles de reutilizar; </li><li>  dentro de la l√≥gica de negocios aparece y con el tiempo se vuelve m√°s y m√°s; </li><li>  dif√≠cil de mantener y expandir; </li><li>  alto riesgo de errores al actualizar datos; </li><li>  Dise√±o no obvio. </li></ul><br><h2 id="glava-vtoraya-v-kotoroy-vse-moglo-byt-inache">  Cap√≠tulo dos, en el que todo podr√≠a ser diferente </h2><br><p>  No es realista ni tiene sentido imaginar el desarrollo de la aplicaci√≥n en los a√±os venideros.  Despu√©s de un par de bailes con una pandereta como en el √∫ltimo cap√≠tulo y escribir docenas de adaptadores, cualquiera tendr√° una pregunta: "¬øQuiz√°s hay otras soluciones?". </p><br><p><img src="https://habrastorage.org/webt/ct/6d/fx/ct6dfxsshhko-jfqycyqekpoqdu.jpeg"></p><br><p>  Despu√©s de completar Github, encontramos que la primera biblioteca <strong>AdapterDelegates</strong> apareci√≥ en 2015, y un a√±o despu√©s, <strong>Groupie</strong> y <strong>Epoxy se</strong> agregaron al arsenal de desarrolladores: todos ayudan a facilitar la vida, pero cada uno tiene sus propios detalles y dificultades. </p><br><blockquote>  Hay varias bibliotecas m√°s similares (por ejemplo, FastAdapter), pero ni yo ni mis colegas trabajamos con ellas, por lo que no las consideraremos en el art√≠culo. </blockquote><p>  Antes de comparar las bibliotecas, analizamos brevemente el caso descrito anteriormente con la tienda en l√≠nea con la condici√≥n de usar <strong>AdapterDelegates</strong> : de las bibliotecas desmontadas, es la m√°s simple desde el punto de vista de la implementaci√≥n y el uso interno (sin embargo, no est√° avanzado en todo, por lo que debe agregar muchas cosas a mano). </p><br><p>  La biblioteca no nos salvar√° completamente del adaptador, pero se formar√° a partir de bloques (ladrillos), que podemos agregar o quitar de la lista de forma segura e intercambiarlos. </p><br><div class="spoiler">  <b class="spoiler_title">Adaptador de bloque</b> <div class="spoiler_text"><pre> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DucksDelegatesAdapter</span></span></span><span class="hljs-class"> : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ListDelegationAdapter</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">List&lt;DisplayableItem</span></span></span><span class="hljs-class">&gt;&gt;</span></span>() { <span class="hljs-keyword"><span class="hljs-keyword">init</span></span> { delegatesManager.addDelegate(RubberDuckDelegate()) } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setData</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(items: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">List</span></span></span></span><span class="hljs-function"><span class="hljs-params">&lt;</span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">DisplayableItem</span></span></span></span><span class="hljs-function"><span class="hljs-params">&gt;)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.items = items notifyDataSetChanged() } } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RubberDuckDelegate</span></span></span><span class="hljs-class"> : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">AbsListItemAdapterDelegate</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">RubberDuckItem, DisplayableItem, RubberDuckDelegate.ViewHolder</span></span></span><span class="hljs-class">&gt;</span></span>() { <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isForViewType</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(item: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">DisplayableItem</span></span></span></span><span class="hljs-function"><span class="hljs-params">, items: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">List</span></span></span></span><span class="hljs-function"><span class="hljs-params">&lt;</span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">DisplayableItem</span></span></span></span><span class="hljs-function"><span class="hljs-params">&gt;, position: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Int</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>: <span class="hljs-built_in"><span class="hljs-built_in">Boolean</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> item <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> RubberDuckItem } <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreateViewHolder</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(parent: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">ViewGroup</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>: ViewHolder { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> item = parent.context.inflate(R.layout.item_rubber_duck, parent, <span class="hljs-literal"><span class="hljs-literal">false</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ViewHolder(item) } <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onBindViewHolder</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(item: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">RubberDuckItem</span></span></span></span><span class="hljs-function"><span class="hljs-params">, viewHolder: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">ViewHolder</span></span></span></span><span class="hljs-function"><span class="hljs-params">, payloads: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">List</span></span></span></span><span class="hljs-function"><span class="hljs-params">&lt;</span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Any</span></span></span></span><span class="hljs-function"><span class="hljs-params">&gt;)</span></span></span></span> { viewHolder.apply { rubberDuckImage.showIcon(item.icon) } } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ViewHolder</span></span></span></span>(itemView: View) : RecyclerView.ViewHolder(itemView) { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> rubberDuckImage: ImageView = itemView.findViewById(R.id.rubberDuckImage) } }</code> </pre> </div></div><br><div class="spoiler">  <b class="spoiler_title">Usar un adaptador de actividad</b> <div class="spoiler_text"><pre> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DucksDelegatesActivity</span></span></span><span class="hljs-class"> : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">AppCompatActivity</span></span></span></span>() { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">lateinit</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ducksList: RecyclerView <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(savedInstanceState: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Bundle</span></span></span></span><span class="hljs-function"><span class="hljs-params">?)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onCreate(savedInstanceState) setContentView(R.layout.activity_ducks_delegates) ducksList = findViewById(R.id.duckList) ducksList.apply { layoutManager = LinearLayoutManager(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span><span class="hljs-symbol"><span class="hljs-symbol">@DucksDelegatesActivity</span></span>) adapter = createAdapter().apply { showData() } } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createAdapter</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>: DucksDelegatesAdapter { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> DucksDelegatesAdapter() } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> DucksDelegatesAdapter.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">showData</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { setData(getRubberDucks()) } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getRubberDucks</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>: List&lt;DisplayableItem&gt; { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> DuckMockData.ducks.orEmpty().map { RubberDuckItem(it.icon) } } }</code> </pre> </div></div><br><p>  Desde la primera tarea, vemos la diferencia: tenemos una clase de adaptador que hereda de la biblioteca.  Y adem√°s, el mismo ladrillo, que se llama <strong>delegado</strong> y del que tambi√©n heredamos e implementamos parte de la l√≥gica que necesitamos.  A continuaci√≥n, agregamos un delegado al <strong>administrador</strong> ; esta tambi√©n es una clase de biblioteca.  Y lo √∫ltimo que necesita es crear un adaptador y llenarlo con datos </p><br><p>  Para implementar la segunda categor√≠a de la tienda y los encabezados, escribiremos un par de delegados m√°s y la animaci√≥n aparecer√° gracias a la clase <strong>DiffUtil</strong> . </p><br><p>  Aqu√≠ indicar√© una conclusi√≥n breve pero definitiva: el uso de incluso esta biblioteca resuelve todos los problemas enumerados que surgieron cuando complicamos la aplicaci√≥n en un caso con una tienda en l√≠nea, pero sin los inconvenientes, en ning√∫n otro lado. </p><br><blockquote>  Proceso de desarrollo del adaptador con <a href="">AdapterDelegates</a> en el historial de <a href="">github</a> </blockquote><br><h2 id="glava-tretya-v-kotoroy-razrabotchik-snimaet-rozovye-ochki-sravniv-biblioteki">  Cap√≠tulo tres, en el que el desarrollador elimina las gafas de color rosa al comparar bibliotecas </h2><br><p>  Nos sumergiremos en m√°s detalle en la funcionalidad y operaci√≥n de cada una de las bibliotecas.  De una forma u otra, utilic√© las tres bibliotecas en nuestros proyectos, dependiendo de las tareas y la complejidad de la aplicaci√≥n. </p><br><h3 id="adapterdelegateshttpsgithubcomsockeqweadapterdelegates">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Adaptadores delegados</a> </h3><br><p><img src="https://habrastorage.org/webt/u9/9q/up/u99quph_ecf1su3ggudei9au6eg.gif" align="left">  Utilizamos esta biblioteca en la aplicaci√≥n de una de las mayores aerol√≠neas rusas.  Necesit√°bamos reemplazar una lista de pago simple con una lista con grupos y una gran cantidad de par√°metros diferentes. </p><br><p>  Un esquema de trabajo de biblioteca simplificado se ve as√≠: <img src="https://habrastorage.org/webt/w6/mw/4s/w6mw4shsbgr6ndkpbwvhsyuvayo.jpeg"></p><br><p>  La clase principal es el <strong>DelegateAdapter</strong> , los diversos "ladrillos" son los "delegados" responsables de mostrar un tipo de datos en particular y, por supuesto, la lista misma. </p><br><h4 id="plyusy">  Pros: </h4><br><ul><li>  simplicidad de inmersi√≥n; </li><li>  adaptadores f√°ciles de reutilizar; </li><li>  pocos m√©todos y clases; </li><li>  sin reflexi√≥n, generaci√≥n de c√≥digo y enlace de datos. </li></ul><br><h4 id="minusy">  Contras: </h4><br><ul><li>  necesita implementar la l√≥gica usted mismo, por ejemplo <del>  actualizar elementos a trav√©s de DiffUti </del>  l (desde la versi√≥n 3.1.0 puede usar el adaptador AsyncListDifferDeferationAdapter); </li><li>  c√≥digo redundante </li></ul><br><blockquote>  En general, esta biblioteca resuelve todas las dificultades principales para expandir la funcionalidad de la aplicaci√≥n y es adecuada para aquellos que no han usado la biblioteca antes.  Pero para detenerse solo en eso, no lo aconsejo. </blockquote><br><h3 id="groupiehttpsgithubcomlisawraygroupie">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Groupie</a> </h3><br><p><img src="https://habrastorage.org/webt/wm/ke/5w/wmke5wd9rsxtqknnr_jsdhn6m_s.gif" align="left">  A menudo usamos <strong>Groupie</strong> , creado hace varios a√±os por <strong>Lisa Wray</strong> , que incluye escribir la solicitud para un banco let√≥n que lo usa por completo. </p><br><p>  Para utilizar esta biblioteca, en primer lugar, debe <strong>lidiar con las dependencias</strong> .  Adem√°s de la principal, puede usar varias opciones para elegir: </p><br><ul><li>  extensi√≥n para extensiones de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Android Kotlin</a> ; </li><li>  extensi√≥n para <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Android Data Binding</a> ; </li><li>  tanto eso como otro. </li></ul><br><p>  Nos detenemos en una cosa y prescribimos las dependencias necesarias. </p><br><p>  Usando un ejemplo de una tienda en l√≠nea con patos, necesitamos crear un <strong>art√≠culo</strong> heredado de la clase de biblioteca, especificar el dise√±o e implementar el enlace a trav√©s de los sint√©ticos de Kotlin.  En comparaci√≥n con la cantidad de c√≥digo que tuve que escribir con <strong>AdapterDelegates</strong> , es solo el cielo y la tierra. </p><br><p>  Todo lo que queda es configurar el RecyclerView <strong>GroupieAdapter</strong> como un adaptador y colocar los elementos <strong>simulados</strong> en √©l. </p><br><p><img src="https://habrastorage.org/webt/3z/q9/wi/3zq9wiax9tufogfr6fx9cwipobe.jpeg"></p><br><p>  Se puede ver que el esquema de trabajo es m√°s grande y m√°s complejo.  Aqu√≠, adem√°s de elementos simples, puede usar secciones enteras: grupos de elementos y otras clases. </p><br><h4 id="plyusy-1">  Pros: </h4><br><ul><li>  interfaz intuitiva, aunque api te hace pensar; </li><li>  la presencia de soluciones en caja; </li><li>  desglose en grupos de elementos; </li><li>  la elecci√≥n entre la opci√≥n habitual, Kotlin Extensions y DataBinding; </li><li>  incrustaci√≥n de ItemDecoration y animaciones. </li></ul><br><h4 id="minusy-1">  Contras: </h4><br><ul><li>  wiki incompleto; </li><li>  poco apoyo por parte del mantenedor y la comunidad; </li><li>  peque√±os errores que tuvieron que ser evitados en la primera versi√≥n; </li><li>  que difiere en el hilo principal (por ahora); </li><li>  no hay soporte para AndroidX (por el momento, pero necesita monitorear el repositorio) </li></ul><br><p>  Es importante que <strong>Groupie,</strong> con todos sus inconvenientes, pueda reemplazar f√°cilmente <strong>AdapterDelegates</strong> , especialmente si planea hacer listas plegables del primer nivel, y no quiere escribir mucho repetitivo. </p><br><blockquote>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Implementando</a> la lista de patos con Groupie </blockquote><br><h3 id="epoxyhttpsgithubcomairbnbepoxy">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Epoxi</a> </h3><br><p><img src="https://habrastorage.org/webt/te/fg/tt/tefgttnpx4qijjlckdpxtuqpucq.gif" align="left">  La √∫ltima biblioteca que comenzamos a usar relativamente recientemente es <strong>Epoxy</strong> , desarrollada por los chicos de <strong>Airbnb</strong> .  La biblioteca es compleja, pero le permite resolver una amplia gama de tareas.  Los propios programadores de Airbnb lo usan para representar pantallas directamente desde el servidor.  <strong>Epoxy</strong> fue √∫til en uno de nuestros √∫ltimos proyectos: una solicitud para un banco en Ekaterimburgo. </p><br><p>  Para desarrollar pantallas, tuvimos que trabajar con diferentes tipos de datos, una gran cantidad de listas.  Y una de las pantallas era realmente interminable.  Y <strong>Epoxy</strong> nos ayud√≥ a todos a lidiar con esto. </p><br><p>  El principio de la biblioteca en su conjunto es similar a los dos anteriores, excepto que en lugar de un adaptador, EpoxyController se usa para crear la lista, lo que le permite determinar declarativamente la estructura del adaptador. </p><br><p><img src="https://habrastorage.org/webt/im/rk/rl/imrkrl2d6nnnoolqijk-_ubvkmg.jpeg"></p><br><p>  Para lograr esto, la biblioteca se basa en la generaci√≥n de c√≥digo.  C√≥mo funciona: con todos los matices, est√° bien descrito en la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">wiki</a> y se refleja en las <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">muestras</a> . </p><br><h4 id="plyusy-2">  Pros: </h4><br><ul><li>  modelos para la lista, generados a partir de la Vista habitual, con posibilidad de reutilizaci√≥n en pantallas simples; </li><li>  descripci√≥n declarativa de pantallas; </li><li>  Enlace de datos a la velocidad m√°xima: genera modelos directamente a partir de archivos de dise√±o; </li><li>  simplemente muestre no solo listas de los bloques, sino tambi√©n pantallas complejas; </li><li>  ViewPool compartido en Actividad; </li><li>  diferenciaci√≥n asincr√≥nica fuera de la caja (AsyncEpoxyController); </li><li>  No es necesario vaporizar con listas horizontales. </li></ul><br><h4 id="minusy-2">  Contras: </h4><br><ul><li>  gran cantidad de clases, procesadores, anotaciones; </li><li>  inmersi√≥n dif√≠cil desde cero; </li><li>  usa el complemento ButterKnife para generar archivos R2 en m√≥dulos; </li><li>  es muy dif√≠cil entender c√≥mo trabajar correctamente con Callbacks (nosotros mismos a√∫n no lo entend√≠amos); </li><li>  Hay problemas que deben evitarse: por ejemplo, un bloqueo con la misma identificaci√≥n. </li></ul><br><blockquote>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Implementando</a> la Lista de Patos con Epoxy </blockquote><br><h2 id="itogi-1">  Resumen </h2><br><p>  Lo principal que quer√≠a transmitir era: no tolerar la complejidad que aparece cuando necesitas hacer listas complejas y constantemente tienes que rehacerlas.  Y esto sucede muy a menudo.  Y, en principio, cuando se implementan, si el proyecto reci√©n comienza o si est√° refactorizando. </p><br><p>  La realidad es que no es necesario complicar la l√≥gica una vez m√°s, pensando que bastar√° alg√∫n tipo de abstracci√≥n propia.  Son lo suficientemente cortos y trabajar con ellos no solo no es un placer, sino que tambi√©n existe la tentaci√≥n de transferir parte de la l√≥gica a la parte de la interfaz de usuario, que no deber√≠a estar all√≠.  Existen herramientas que pueden ayudarlo a evitar la mayor√≠a de los problemas, y debe usarlas. </p><br><blockquote>  Entiendo que para muchos desarrolladores experimentados (y no solo) esto es obvio o pueden estar en desacuerdo conmigo.  Pero considero importante enfatizar esto nuevamente. </blockquote><br><h2 id="tak-a-chto-vybrat-to">  Entonces, ¬øqu√© elegir? </h2><br><p>  Aconsejar permanecer en una biblioteca es bastante dif√≠cil, porque la elecci√≥n depende de muchos factores: desde las preferencias personales hasta la ideolog√≠a del proyecto. </p><br><p>  Yo har√≠a lo siguiente: </p><br><ol><li>  Si reci√©n est√° comenzando su camino en el desarrollo, intente comenzar <strong>en un peque√±o proyecto</strong> con <strong>AdapterDelegates</strong> , esta es la biblioteca m√°s simple, no se requieren conocimientos especiales.  Comprender√° c√≥mo trabajar con √©l y por qu√© es m√°s conveniente que escribir adaptadores usted mismo. </li><li>  <strong>Groupie es</strong> adecuado para aquellos que ya han jugado lo suficiente con AdapterDelegates y est√°n cansados ‚Äã‚Äãde escribir un mont√≥n de repeticiones, o para <strong>todos los</strong> que inmediatamente quieren comenzar con un t√©rmino medio.  Y no se olvide de la presencia de <strong>grupos plegables fuera de la caja</strong> ; este tambi√©n es un buen argumento a su favor. </li><li>  Bueno, y <strong>Epoxy</strong> : para aquellos que se enfrentan a un proyecto verdaderamente complejo, con una gran cantidad de datos, por lo que la complejidad con una gran biblioteca ser√° un problema menor.  Al principio ser√° dif√≠cil, pero una mayor implementaci√≥n de las listas parecer√° un poco insignificante.  Un argumento importante a favor de Epoxy puede ser la presencia de <strong>DataBinding</strong> y <strong>MVVM</strong> en el proyecto: se cre√≥ literalmente para esto, dada la posibilidad de generar modelos a partir de los dise√±os correspondientes. </li></ol><br><p>  Si a√∫n tiene preguntas, puede mirar el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">enlace</a> para ver nuevamente el c√≥digo de nuestra aplicaci√≥n con los detalles. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es428525/">https://habr.com/ru/post/es428525/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es428513/index.html">500 punteros l√°ser en un solo lugar</a></li>
<li><a href="../es428515/index.html">Top 3D Shop: c√≥mo cambiamos durante el a√±o - Resultados 2018</a></li>
<li><a href="../es428517/index.html">GraphQL - API de una nueva manera</a></li>
<li><a href="../es428521/index.html">¬øPor qu√© no hay amigos en GitHub? Sobre Robbie Barrath, Obvio y Copyright</a></li>
<li><a href="../es428523/index.html">ShadowCloud - cliente universal en la nube</a></li>
<li><a href="../es428526/index.html">Impuesto de Google: giro de 180 ¬∞</a></li>
<li><a href="../es428528/index.html">¬øPor qu√© a los revolucionarios les gusta la comida picante o c√≥mo el chile lleg√≥ a China?</a></li>
<li><a href="../es428530/index.html">Los resultados de la investigaci√≥n del accidente "Uni√≥n MS-10"</a></li>
<li><a href="../es428532/index.html">HyperloopTT planea lanzar la primera sucursal de Hyperloop en el tercer trimestre de 2019</a></li>
<li><a href="../es428534/index.html">Impresora 3D m√°quina perforadora y PCAD a G-Code convertidor de tarjeta de perforaci√≥n</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>