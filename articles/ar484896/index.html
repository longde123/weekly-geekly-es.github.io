<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ฒ๐ฝ ๐ ๐คฆ๐ฟ ูุฑูุฉ ุงูุบุด ููุณุคูู ูุธุงู SELinux: 42 ุฅุฌุงุจุฉ ุนูู ุงูุฃุณุฆูุฉ ุงููููุฉ โด๏ธ ๐ฅ๏ธ ๐</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ุชู ุฅุนุฏุงุฏ ุชุฑุฌูุฉ ููุฐู ุงูููุงูุฉ ุฎุตูุตูุง ูุทูุงุจ ุฏูุฑุฉ Linux Administrator . 



 ุณุชุญุตู ููุง ุนูู ุฅุฌุงุจุงุช ูุฃุณุฆูุฉ ูููุฉ ุญูู ุงูุญูุงุฉ ูุงูููู ููู ูุง ูู Linux ูุน ุชุนุฒูุฒ ุง...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ูุฑูุฉ ุงูุบุด ููุณุคูู ูุธุงู SELinux: 42 ุฅุฌุงุจุฉ ุนูู ุงูุฃุณุฆูุฉ ุงููููุฉ</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/484896/" style=";text-align:right;direction:rtl">  <i><b>ุชู ุฅุนุฏุงุฏ ุชุฑุฌูุฉ ููุฐู ุงูููุงูุฉ ุฎุตูุตูุง ูุทูุงุจ <a href="https://otus.pw/xIJ4/">ุฏูุฑุฉ Linux Administrator</a> .</b></i> <br><br><img src="https://habrastorage.org/webt/of/jl/y2/ofjly2ppm7zgwrztknxeodbhih0.png"><br><hr><br>  <i>ุณุชุญุตู ููุง ุนูู ุฅุฌุงุจุงุช ูุฃุณุฆูุฉ ูููุฉ ุญูู ุงูุญูุงุฉ ูุงูููู ููู ูุง ูู Linux ูุน ุชุนุฒูุฒ ุงูุฃูุงู.</i> <br><br><blockquote style=";text-align:right;direction:rtl">  "ุงูุญูููุฉ ุงููููุฉ ูู ุฃู ุงูุฃููุฑ ููุณุช ุฏุงุฆูุง ูุง ูุจุฏู ุฃููุง ูุนุฑููุฉ ุฌูุฏุง ..." <br><br>  <b>glDouglas Adams ุ <i>ุฏููู Hitchhiker ุฅูู Galaxy</i></b> </blockquote><br>  <b>ุงูุฃูู.</b>  <b>ุชุญุณูู ุงูููุซูููุฉ.</b>  <b>ุงูุงูุชุซุงู.</b>  <b>ุงูุณูุงุณุฉ.</b>  ุฃุฑุจุนุฉ ูุฑุณุงู ูู ููุงูุฉ ุงูุนุงูู ูู ูุณุคูู ุงููุธุงู.  ุจุงูุฅุถุงูุฉ ุฅูู ููุงููุง ุงูููููุฉ - ุงููุฑุงูุจุฉ ุ ุงููุณุฎ ุงูุงุญุชูุงุทู ุ ุงูุชูููุฐ ุ ุงูุชูููู ุ ุงูุชุญุฏูุซ ุ ุฅูุฎ - ูุญู ูุณุคูููู ุฃูุถูุง ุนู ุฃูุงู ุฃูุธูุชูุง.  ุญุชู ุชูู ุงูุฃูุธูุฉ ุงูุชู ููุตู ูููุง ูููุฑ ุฎุงุฑุฌู ุจุฃู ูููู ุชุดุบูู ุงูุฃูุงู ุงููุญุณู.  ูุฐุง ูุดุงุจู ูุนูู <a href="https://en.wikipedia.org/wiki/Ethan_Hunt">ุฅูุซุงู ูุงูุช</a> ูู ูููุฉ ูุณุชุญููุฉ. <a name="habracut"></a><br><br>  ูู ููุงุฌูุฉ ูุฐู ุงููุนุถูุฉ ุ ููุฑุฑ ุจุนุถ ูุณุคููู ุงููุธุงู ุชูุงูู <a href="https://en.wikipedia.org/wiki/Red_pill_and_blue_pill">ุญุจูุจ ููุน ุงูุญูู ุงูุฒุฑูุงุก</a> ูุฃููู ูุนุชูุฏูู ุฃููู ูู ูุนุฑููุง ุฃุจุฏูุง ุฅุฌุงุจุฉ ุงูุณุคุงู ุงููุจูุฑ ุนู ุงูุญูุงุฉ ูุงูููู ููู ุฐูู.  ูููุง ูุนูู ุฌููุนุง ุ ูุฐู ุงูุฅุฌุงุจุฉ ูู 42. <br><br>  ุงูุทูุงููุง ูู "ุฏููู Hitchhiker ุฅูู ุงููุฌุฑุฉ" ุ ุฅููู 42 ุฅุฌุงุจุฉ ุนูู ุฃุณุฆูุฉ ูููุฉ ุญูู ุฅุฏุงุฑุฉ ูุงุณุชุฎุฏุงู <a href="https://en.wikipedia.org/wiki/Security-Enhanced_Linux">SELinux</a> ุนูู ุฃูุธูุชู. <br><br>  <b>1.</b> SELinux ูู ูุธุงู ูุฑุงูุจุฉ ุงูุฏุฎูู ุงููุณุฑู ุ ููุง ูุนูู ุฃู ูู ุนูููุฉ ููุง ุนูุงูุฉ.  ูุญุชูู ูู ููู ูุฏููู ููุงุฆู ูุธุงู ุฃูุถูุง ุนูู ุนูุงูุงุช.  ุชุชุญูู ููุงุนุฏ ุงูุณูุงุณุฉ ูู ุงููุตูู ุจูู ุงูุนูููุงุช ูุงููุงุฆูุงุช ุงููููุฒุฉ.  ููุฑุถ ุงูููุงุฉ ูุฐู ุงูููุงุนุฏ. <br><br>  <b>2.</b> ุงููููููุงู ุงูุฃูุซุฑ ุฃูููุฉ ููุง: <i>ุงูุชุตููู</i> - ูุถุน ุงูุนูุงูุงุช (ุงููููุงุช ุ ุงูุนูููุงุช ุ ุงูููุงูุฐ ุ ุฅูุฎ) ููุฑุถ <i>ุงูููุน</i> (ุงูุฐู ูุนุฒู ุงูุนูููุงุช ุนู ุจุนุถูุง ุงูุจุนุถ ุจูุงุกู ุนูู ุงูุฃููุงุน). <br><br>  <b>3.</b> ุชูุณูู ุงูุชุณููุฉ ุงูุตุญูุญ ูู <code>user:role:type:level</code> (ุงุฎุชูุงุฑู). <br><br>  <b>4.</b> ุงููุฏู ูู ุชูููุฑ <i>ุงูุฃูุงู ูุชุนุฏุฏ ุงููุณุชููุงุช (MLS</i> ) ูู ุฅุฏุงุฑุฉ ุงูุนูููุงุช (ุงููุฌุงูุงุช) ุจูุงุกู ุนูู ูุณุชูู ุฃูุงู ุงูุจูุงูุงุช ุงูุชู ุณูุณุชุฎุฏููููุง.  ุนูู ุณุจูู ุงููุซุงู ุ ูุง ูููู ูุฑุงุกุฉ ุนูููุฉ ุณุฑูุฉ ุจูุงูุงุช ุณุฑูุฉ ููุบุงูุฉ. <br><br>  <b>5.</b> ูุญูู ุถูุงู <i>ุงูุฃูู ูุชุนุฏุฏ</i> ุงููุฆุงุช <i>(MCS</i> ) ุงูุนูููุงุช ุงูููุงุซูุฉ ูู ุจุนุถูุง ุงูุจุนุถ (ุนูู ุณุจูู ุงููุซุงู ุ ุงูุฃุฌูุฒุฉ ุงูุงูุชุฑุงุถูุฉ ูุขููุงุช OpenShift ูุตูุงุฏูู ุงูุฑูู SELinux ูุงูุญุงููุงุช ูุบูุฑูุง). <br><br>  <b>6.</b> ูุนููุงุช Kernel ูุชุบููุฑ ุฃูุถุงุน SELinux ุนูุฏ ุงูุชูููุฏ: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <code>autorelabel=1</code> ููุฑุถ ุงููุธุงู ูุจุฏุก ุฅุนุงุฏุฉ ูุถุน ุงูุนูุงูุงุช </li><li style=";text-align:right;direction:rtl">  <code>selinux=0</code> ูุง ูููู kernel ุจุชุญููู ุงูุจููุฉ ุงูุชุญุชูุฉ ูู SELinux </li><li style=";text-align:right;direction:rtl">  <code>enforcing=0</code> ุงูุชุญููู ูู ูุถุน ูุชุณุงูู </li></ul><br>  <b>7.</b> ุฅุฐุง ููุช ุจุญุงุฌุฉ ุฅูู ุฅุนุงุฏุฉ ูุถุน ุนูุงูุฉ ุนูู ุงููุธุงู ุจุฃูููู: <br><br> <code># touch /.autorelabel <br> #reboot</code> <br> <br>  ุฅุฐุง ูุงูุช ุนูุงูุฉ ุงููุธุงู ุชุญุชูู ุนูู ุนุฏุฏ ูุจูุฑ ูู ุงูุฃุฎุทุงุก ุ ููุฏ ุชุญุชุงุฌ ุฅูู ุงูุชูููุฏ ูู ูุถุน ูุชุณุงูู ููุฌุงุญ ุงูุนูุงูุฉ. <br><br>  <b>8.</b> ููุชุญูู ููุง ุฅุฐุง ุชู ุชูููู SELinux: <code># getenforce</code> <br><br>  <b>9.</b> ูุชูููู / ุชุนุทูู SELinux ูุคูุชูุง: <code># setenforce [1|0]</code> <br><br>  <b>10.</b> ุงูุชุญูู ูู ุญุงูุฉ SELinux: <code># sestatus</code> <br><br>  <b>11.</b> ููู ุงูุชูููู: <code>/etc/selinux/config</code> <br><br>  <b>12.</b> ููู ูุนูู ุณูููููุ  ูููุง ููู ูููุฐุฌ ูุชุณููุฉ ุฎุงุฏู ุงูููุจ Apache: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุงูุชูุซูู ุงูุซูุงุฆู: <code>/usr/sbin/httpdโhttpd_exec_t</code> </li><li style=";text-align:right;direction:rtl">  ุฏููู ุงูุชูููู: <code>/etc/httpdโhttpd_config_t</code> </li><li style=";text-align:right;direction:rtl">  ุฏููู ููู ุงูุณุฌู: <code>/var/log/httpd โ httpd_log_t</code> </li><li style=";text-align:right;direction:rtl">  ุฏููู ุงููุญุชูู: <code>/var/www/html โ httpd_sys_content_t</code> </li><li style=";text-align:right;direction:rtl">  ุชุดุบูู ุงูุจุฑูุงูุฌ ุงููุตู: <code>/usr/lib/systemd/system/httpd.service โ httpd_unit_file_d</code> </li><li style=";text-align:right;direction:rtl">  ุงูุนูููุฉ: <code>/usr/sbin/httpd -DFOREGROUND โ httpd_t</code> </li><li style=";text-align:right;direction:rtl">  ุงูููุงูุฐ: <code>80/tcp, 443/tcp โ httpd_t, http_port_t</code> </li></ul><br>  <i>ูููู ุฃู ุชุชูุงุนู ุงูุนูููุฉ ุงูุชู ูุชู ุชุดุบูููุง ูู ุณูุงู <code>httpd_t</code> ูุน ูุงุฆู ูุณูู <code>httpd_something_t</code> .</i> <br><br>  <b>13.</b> ุชูุจู ุงูุนุฏูุฏ ูู ุงูุฃูุงูุฑ ุงููุณูุทุฉ <code>-Z</code> ูุนุฑุถ ุงูุณูุงู <code>-Z</code> ูุชุบููุฑู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl"> <code>ls -Z</code> </li> <li style=";text-align:right;direction:rtl"> <code>id -Z</code> </li> <li style=";text-align:right;direction:rtl"> <code>ps -Z</code> </li> <li style=";text-align:right;direction:rtl"> <code>netstat -Z</code> </li> <li style=";text-align:right;direction:rtl"> <code>cp -Z</code> </li> <li style=";text-align:right;direction:rtl"> <code>mkdir -Z</code> </li> </ul><br>  <i>ูุชู ุชุนููู ุงูุณูุงูุงุช ุนูุฏ ุฅูุดุงุก ูููุงุช ุงุณุชูุงุฏูุง ุฅูู ุณูุงู ุงูุฏููู ุงูุฃุตู (ูุน ุจุนุถ ุงูุงุณุชุซูุงุกุงุช).</i>  <i>ูููู RPMs ุชุนููู ุณูุงูุงุช ููุง ูู ุงูุญุงู ุฃุซูุงุก ุงูุชุซุจูุช.</i> <br><br>  <b>14-</b> ููุงู ุฃุฑุจุนุฉ ุฃุณุจุงุจ ุฑุฆูุณูุฉ ูุฃุฎุทุงุก SELinux ุ ูุฑุฏ ูุตููุง ุจูุฒูุฏ ูู ุงูุชูุตูู ูู ุงูููุฑุงุช 15-21 ุฃุฏูุงู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุดุงูู ูุถุน ุงูุนูุงูุงุช </li><li style=";text-align:right;direction:rtl">  ุจุณุจุจ ุดูุก ูุญุชุงุฌ SELinux ุฅูู ูุนุฑูุชู </li><li style=";text-align:right;direction:rtl">  ุฎุทุฃ ูู ุณูุงุณุฉ / ุชุทุจูู SELinux </li><li style=";text-align:right;direction:rtl">  ูุฏ ุชููู ุงููุนูููุงุช ุงูุฎุงุตุฉ ุจู ููุฎุทุฑ. </li></ul><br>  <b>15.</b> <i>ูุดููุฉ ูู ูุถุน ุนูุงูุฉ</i> : ุฅุฐุง ุชู <i>ูุถุน ุนูุงูุฉ ุนูู</i> ูููุงุชู ูู <code>/srv/myweb</code> ุจุดูู ุบูุฑ ุตุญูุญ ุ ููุฏ ูุชู ุฑูุถ ุงููุตูู.  ูููุง ููู ุจุนุถ ุงูุทุฑู ูุฅุตูุงุญ ูุฐุง: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุฅุฐุง ููุช ุชุนุฑู ุงูููุตู: <br> <code># semanage fcontext -a -t httpd_sys_content_t '/srv/myweb(/.*)?'</code> </li> <li style=";text-align:right;direction:rtl">  ุฅุฐุง ููุช ุชุนุฑู ููููุง ุฐุง ุนูุงูุงุช ููุงูุฆุฉ: <br> <code># semanage fcontext -a -e /srv/myweb /var/www</code> </li> <li style=";text-align:right;direction:rtl">  ุจุนุฏ ุงุณุชุนุงุฏุฉ ุงูุณูุงู (ูููุชุง ุงูุญุงูุชูู): <br> <code># restorecon -vR /srv/myweb</code> </li> </ul><br>  <b>16.</b> <i>ูุดููุฉ ูุถุน ุงูุนูุงูุงุช:</i> ุฅุฐุง ููุช ุจููู ุงูููู ุจุฏูุงู ูู ูุณุฎู ุ ูุณูุญุชูุธ ุงูููู ุจุณูุงูู ุงูุฃุตูู.  ูุฅุตูุงุญ ูุฐู ุงููุดููุฉ: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุชุบููุฑ ุฃูุฑ ุงูุณูุงู ุงููุณูู: <br> <code># chcon -t httpd_system_content_t /var/www/html/index.html</code> </li> <li style=";text-align:right;direction:rtl">  ูู ุจุชุบููุฑ ุฃูุฑ ุงูุณูุงู ุจุงุณุชุฎุฏุงู ุชุณููุฉ ุงูุฑุงุจุท: <br> <code># chcon --reference /var/www/html/ /var/www/html/index.html</code> </li> <li style=";text-align:right;direction:rtl">  ุงุณุชุนุงุฏุฉ ุงูุณูุงู (ูู ููุชุง ุงูุญุงูุชูู): <code># restorecon -vR /var/www/html/</code> </li></ul><br>  <b>17.</b> ุฅุฐุง ูุงูุช <i>SELinux ุจุญุงุฌุฉ ุฅูู ูุนุฑูุฉ</i> ุฃู HTTPD ุชุณุชูุน ุนูู ุงููููุฐ 8585 ุ ูุฃุฎุจุฑ SELinux: <br><br> <code># semanage port -a -t http_port_t -p tcp 8585</code> <br> <br>  <b>18.</b> <i>ูุญุชุงุฌ SELinux ุฅูู ูุนุฑูุฉ</i> ุงูููู ุงูููุทููุฉ ุงูุชู ุชุณูุญ ูู ุจุชุบููุฑ ุฃุฌุฒุงุก ูู ุณูุงุณุฉ SELinux ูู ููุช ุงูุชุดุบูู ุฏูู ูุนุฑูุฉ ุฅุนุงุฏุฉ ูุชุงุจุฉ ุณูุงุณุงุช SELinux.  ุนูู ุณุจูู ุงููุซุงู ุ ุฅุฐุง ููุช ุชุฑูุฏ ุฃู ูููู httpd ุจุฅุฑุณุงู ุจุฑูุฏ ุฅููุชุฑููู ุ ูุฃุฏุฎู: <code># setsebool -P httpd_can_sendmail 1</code> <br><br>  <b>19.</b> <i>ูุญุชุงุฌ SELinux ุฅูู ูุนุฑูุฉ</i> ุงูููู ุงูููุทููุฉ ูุชูููู / ุชุนุทูู ุฅุนุฏุงุฏุงุช SELinux: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ููุดุงูุฏุฉ ูู ุงูููู ุงูููุทููุฉ: <code># getsebool -a</code> </li><li style=";text-align:right;direction:rtl">  ูุฑุคูุฉ ูุตู ููู: <code># semanage boolean -l</code> </li><li style=";text-align:right;direction:rtl">  ูุชุนููู ูููุฉ ููุทููุฉ: <code># setsebool [_boolean_] [1|0]</code> </li><li style=";text-align:right;direction:rtl">  ููุชุซุจูุช ุงูุฏุงุฆู ุ ุฃุถู <code>-P</code> .  ุนูู ุณุจูู ุงููุซุงู: <code># setsebool httpd_enable_ftp_server 1 -P</code> </li></ul><br>  <b>20.</b> ูุฏ ุชุญุชูู ุณูุงุณุงุช / ุชุทุจููุงุช SELinux ุนูู ุฃุฎุทุงุก ุ ุจูุง ูู ุฐูู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุณุงุฑุงุช ููุฏ ุงูููู </li><li style=";text-align:right;direction:rtl">  ุชููููุงุช </li><li style=";text-align:right;direction:rtl">  ุฅุนุงุฏุฉ ุชูุฌูู stdout </li><li style=";text-align:right;direction:rtl">  ุชุณุฑุจ ููู ูุงุตู </li><li style=";text-align:right;direction:rtl">  ุฐุงูุฑุฉ ูุงุจูุฉ ููุชูููุฐ </li><li style=";text-align:right;direction:rtl">  ููุชุจุงุช ุณูุฆุฉ ุงูุจูุงุก </li></ul><br>  ุชุฐุงูุฑ ููุชูุญุฉ (ูุง ุชุฑุณู ุชูุฑูุฑุงู ุฅูู Bugzilla ุ ูุง ููุฌุฏ ุฌูุด ุชุญุฑูุฑ ุงูุณูุฏุงู ูู Bugzilla). <br><br>  <b>21.</b> <i>ูุฏ ูุชู ุงุฎุชุฑุงู ูุนูููุงุชู</i> ุฅุฐุง ูุงู ูุฏูู ูุทุงูุงุช ูุญุฏูุฏุฉ ุชุญุงูู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุชูุฒูู ูุญุฏุงุช kernel </li><li style=";text-align:right;direction:rtl">  ุชุนุทูู ูุถุน SELinux ุงููุณุฑู </li><li style=";text-align:right;direction:rtl">  ุงูุชุจ ูู <code>etc_t/shadow_t</code> </li><li style=";text-align:right;direction:rtl">  ุชุบููุฑ ููุงุนุฏ iptables </li></ul><br>  <b>22.</b> ุฃุฏูุงุช SELinux ูุชุทููุฑ ูุญุฏุงุช ุงูุณูุงุณุฉ: <br><br> <code># yum -y install setroubleshoot setroubleshoot-server</code> <br> <br>  ุฃุนุฏ ุชุดุบูู ุฃู ุฃุนุฏ ุชุดุบูู <code>auditd</code> ุจุนุฏ ุงูุชุซุจูุช. <br><br>  <b>23.</b> ุงุณุชุฎุฏุงู <pre style=";text-align:right;direction:rtl"> <code class="1c hljs">journalctl</code> </pre>  ูุณุฑุฏ ุฌููุน ุงูุณุฌูุงุช ุงููุฑุชุจุทุฉ <code>setroubleshoot</code> : <br><br> <code># journalctl -t setroubleshoot --since=14:20</code> <br> <br>  <b>24.</b> ุงุณุชุฎุฏุงู <code>journalctl</code> ูุณุฑุฏ ุฌููุน ุงูุณุฌูุงุช ุงููุฑุชุจุทุฉ ุชุณููุฉ SELinux ูุนููุฉ.  ุนูู ุณุจูู ุงููุซุงู: <br><br> <code># journalctl _SELINUX_CONTEXT=system_u:system_r:policykit_t:s0</code> <br> <br>  <b>25. ูู</b> ุญุงูุฉ ุญุฏูุซ ุฎุทุฃ ูู SELinux ุ ุงุณุชุฎุฏู ุณุฌู <code>setroubleshoot</code> ูุน ุจุนุถ ุงูุญููู ุงูููููุฉ. <br>  ุนูู ุณุจูู ุงููุซุงู ุ ูู <code>journalctl</code> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="xml hljs">Jun 14 19:41:07 web1 setroubleshoot: SELinux is preventing httpd from getattr access on the file /var/www/html/index.html. For complete message run: sealert -l 12fd8b04-0119-4077-a710-2d0e0ee5755e # sealert -l 12fd8b04-0119-4077-a710-2d0e0ee5755e SELinux is preventing httpd from getattr access on the file /var/www/html/index.html. ***** Plugin restorecon (99.5 confidence) suggests ************************ If you want to fix the label, /var/www/html/index.html default label should be httpd_syscontent_t. Then you can restorecon. Do # /sbin/restorecon -v /var/www/html/index.html</code> </pre> <br><br>  <b>26.</b> ุชุณุฌูู ุงูุฏุฎูู: ุชุณุฌู SELinux ุงููุนูููุงุช ูู ุงูุนุฏูุฏ ูู ุงูุฃูุงูู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  / ูุงุฑ / ุณุฌู / ุฑุณุงุฆู </li><li style=";text-align:right;direction:rtl">  /var/log/audit/audit.log </li><li style=";text-align:right;direction:rtl">  /var/lib/setroubleshoot/setroubleshoot_database.xml </li></ul><br>  <b>27.</b> ุงูุชุณุฌูู: ุงุจุญุซ ุนู ุฃุฎุทุงุก SELinux ูู ุณุฌู ุงูุชุฏููู: <br><br> <code># ausearch -m AVC,USER_AVC,SELINUX_ERR -ts today</code> <br> <br>  <b>28.</b> ููุนุซูุฑ ุนูู ุฑุณุงุฆู SELinux Access Vector Cache (AVC) ูุฎุฏูุฉ ูุนููุฉ: <br><br> <code># ausearch -m avc -c httpd</code> <br> <br>  <b>29.</b> ุชููู ุงูุฃุฏุงุฉ <code>audit2allow</code> ุจุฌูุน ุงููุนูููุงุช ูู ุณุฌูุงุช ุงูุนูููุงุช ุงููุญุธูุฑุฉ ุ ุซู ุชููู ุจุฅูุดุงุก ููุงุนุฏ ุณูุงุณุฉ ุฅุฐู SELinux.  ุนูู ุณุจูู ุงููุซุงู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุฅูุดุงุก ูุตู ูุงุจู ูููุฑุงุกุฉ ูุณุจุจ ุฑูุถ ุงููุตูู: <code># audit2allow -w -a</code> </li><li style=";text-align:right;direction:rtl">  ูุนุฑุถ ูุงุนุฏุฉ ูุฑุถ ููุน ุชุณูุญ ุจุฑูุถ ุงููุตูู: <code># audit2allow -a</code> </li><li style=";text-align:right;direction:rtl">  ูุฅูุดุงุก ูุญุฏุฉ ููุทูุฉ ูุฎุตุตุฉ: <code># audit2allow -a -M mypolicy</code> </li><li style=";text-align:right;direction:rtl">  ูููู ุงูุฎูุงุฑ <code>-M</code> ุจุฅูุดุงุก ููู ูุฑุถ ููุน (.te) ุจุงูุงุณู ุงููุญุฏุฏ ููุฌูุน ุงููุงุนุฏุฉ ูู ุญุฒูุฉ ุณูุงุณุฉ (.pp): <code>mypolicy.pp mypolicy.te</code> </li><li style=";text-align:right;direction:rtl">  ูุชุซุจูุช ูุญุฏุฉ ููุทูุฉ ูุฎุตุตุฉ: <code># semodule -i mypolicy.pp</code> </li></ul><br>  <b>30.</b> ูุชูููู ุนูููุฉ ูููุตูุฉ (ุงููุฌุงู) ููุนูู ูู ูุถุน ูุชุณุงูู: <code># semanage permissive -a httpd_t</code> <br><br>  <b>31.</b> ุฅุฐุง ูู ุชุนุฏ ุชุฑุบุจ ูู ุฃู ูููู ุงููุฌุงู ูุชุณุงููุงู: <code># semanage permissive -d httpd_t</code> <br><br>  <b>32.</b> ูุชุนุทูู ุฌููุน ุงููุฌุงูุงุช ุงููุชุณุงููุฉ: <code># semodule -d permissivedomains</code> <br><br>  <b>33.</b> ุชูููู ุณูุงุณุฉ MLS SELinux: <code># yum install selinux-policy-mls <br>  /etc/selinux/config: <br> <br> SELINUX=permissive <br> SELINUXTYPE=mls</code> <code># yum install selinux-policy-mls <br>  /etc/selinux/config: <br> <br> SELINUX=permissive <br> SELINUXTYPE=mls</code> <br> <br>  ุชุฃูุฏ ูู ุฃู SELinux ูู ูุถุน ูุชุณุงูู: <code># setenforce 0</code> <br>  ุงุณุชุฎุฏู ุงูุจุฑูุงูุฌ ุงููุตู <code>fixfiles</code> ูุถูุงู ุฅุนุงุฏุฉ ุชูููุฒ ุงููููุงุช ุฃุซูุงุก ุฅุนุงุฏุฉ ุงูุชุดุบูู ุงูุชุงููุฉ: <br><br> <code># fixfiles -F onboot # reboot</code> <br> <br>  <b>34.</b> ุฅูุดุงุก ูุณุชุฎุฏู ูุน ูุฌููุนุฉ MLS ูุญุฏุฏุฉ: <code># useradd -Z staff_u john</code> <br><br>  ุจุงุณุชุฎุฏุงู ุงูุฃูุฑ <code>useradd</code> ุ ูู ุจุชุนููู ุงููุณุชุฎุฏู ุงูุฌุฏูุฏ ููุณุชุฎุฏู SELinux ุงูุญุงูู (ูู ูุฐู ุงูุญุงูุฉ ุ <code>staff_u</code> ). <br><br>  <b>35.</b> ููุดุงูุฏุฉ ุงููุฑุงุณูุงุช ุจูู ูุณุชุฎุฏูู SELinux ู Linux: <code># semanage login -l</code> <br><br>  <b>36.</b> ุญุฏุฏ ูุทุงููุง ูุญุฏุฏูุง ูููุณุชุฎุฏู: <code># semanage login --modify --range s2:c100 john</code> <br><br>  <b>37.</b> ูุชุตุญูุญ ุงูููุตู ูู ุงูุฏููู ุงูุฑุฆูุณู ูููุณุชุฎุฏู (ุฅุฐุง ูุฒู ุงูุฃูุฑ): <code># chcon -R -l s2:c100 /home/john</code> <br><br>  <b>38.</b> ูุนุฑุถ ุงููุฆุงุช ุงูุญุงููุฉ: <code># chcat -L</code> <br><br>  <b>39.</b> ูุชุบููุฑ ุงููุฆุงุช ุฃู ุงูุจุฏุก ูู ุฅูุดุงุก ุงูุฎุงุตุฉ ุจู ุ ูู ุจุชุญุฑูุฑ ุงูููู ุนูู ุงููุญู ุงูุชุงูู: <br><br> <code><code>/etc/selinux/_&lt;</code> selinuxtype <code>&gt;</code> _/setrans.conf</code> <br> <br>  <b>40.</b> ูุชุดุบูู ุฃูุฑ ุฃู ุจุฑูุงูุฌ ูุตู ูู ููู ูุญุฏุฏ ุ ุฏูุฑ ูุณูุงู ูุณุชุฎุฏู: <br><br> <code># runcon -t initrc_t -r system_r -u user_u yourcommandhere</code> <br> <br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุณูุงู ููู <code>-t</code> </li><li style=";text-align:right;direction:rtl">  ุณูุงู ุฏูุฑ <code>-r</code> </li><li style=";text-align:right;direction:rtl">  <code>-u</code> ุณูุงู ุงููุณุชุฎุฏู </li></ul><br>  <b>41.</b> ุญุงููุงุช ุงูุนูู ูุน ุงููุนูููู SELinux: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  Podman: <code># podman run --security-opt label=disable โฆ</code> </li><li style=";text-align:right;direction:rtl">  ุนุงูู ุงููููุงุก: <code># docker run --security-opt label=disable โฆ</code> </li></ul><br>  <b>42.</b> ุฅุฐุง ููุช ุจุญุงุฌุฉ ุฅูู ููุญ ุงูุญุงููุฉ ุญู ุงููุตูู ุงููุงูู ุฅูู ุงููุธุงู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  Podman: <code># podman run --privileged โฆ</code> </li><li style=";text-align:right;direction:rtl">  ุนุงูู ุงููููุงุก: <code># docker run --privileged โฆ</code> </li></ul><br>  <i>ูุงูุขู ุฃูุช ุชุนุฑู ุจุงููุนู ุงูุฌูุงุจ.</i>  <i>ูุฐูู ุ ูู ูุถูู: ูุง ุฏุงุนู ููููู ููู ุจุชุดุบูู SELinux.</i> <br><br><h3 style=";text-align:right;direction:rtl">  ุงููุฑุงุฌุน: </h3><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <a href="https://fedorapeople.org/~dwalsh/SELinux/SELinux">ุณููููู</a> ูู <a href="https://opensource.com/users/rhatdan">ุฏุงู ูุงูุด</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://opensource.com/business/13/11/selinux-policy-guide">ุฏูููู ุงููุฑุฆู ูุชุทุจูู ุณูุงุณุฉ SELinux ุฃูุถูุง ูู</a> ููุจู ุฏุงู ูุงูุด </li><li style=";text-align:right;direction:rtl">  <a href="http://people.redhat.com/tcameron/Summit2018/selinux/SELinux_for_Mere_Mortals_Summit_2018.pdf">ุงูุฃูู ุงููุญุณู ููููุณ ููุฌุฑุฏ ุงูุจุดุฑ ูู</a> ูุจู <a href="http://twitter.com/thomasdcameron">ุชููุงุณ ูุงููุฑูู</a> </li><li style=";text-align:right;direction:rtl">  <a href="http://blog.linuxgrrl.com/2014/04/16/the-selinux-coloring-book/">ูุชุงุจ ุงูุชูููู SELinux ูู</a> ูุจู <a href="https://opensource.com/users/mairin">ูุงุฑููู ุฏููู</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/selinux_users_and_administrators_guide/index">ุฏููู ูุณุชุฎุฏู ููุณุคูู SELinux - Red Hat Enterprise Linux 7</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar484896/">https://habr.com/ru/post/ar484896/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar484882/index.html">ูููุฏูุฒ ุงูุทุฑููุฉ ูุนุงููุฉ v0.8 ุตุฏุฑ</a></li>
<li><a href="../ar484884/index.html">HIPEC. ุณููุงุช ูู ุงูุญูุงุฉ ุจุฏูุง ูู ุฃุดูุฑ ูุน ุฃูุฑุงู ุฎุจูุซุฉ ูู ุชุฌููู ุงูุจุทู</a></li>
<li><a href="../ar484886/index.html">RTL Styling 101 - ุฏููู ููุตู ูุชุตููู CSS RTL</a></li>
<li><a href="../ar484890/index.html">ุชูููุฏ ุงููุตูู ุฅูู ุณูุงุช ุงูุจุนุฏ ูู ูููุฐุฌ ุฌุฏูู SSAS</a></li>
<li><a href="../ar484892/index.html">ุงูุฑุนุงูุฉ ุงููุชูุงููุฉ: ููู ุชุนูู ุงุณุชุถุงูุฉ SAP</a></li>
<li><a href="../ar484898/index.html">ุณุจุจ ูุฌูู ูุงุฎุชุจุงุฑ ุชุจุนูุงุชู: ุฅุตุฏุงุฑ AGPL</a></li>
<li><a href="../ar484900/index.html">ุชูุฏูู ุงููููุน 101</a></li>
<li><a href="../ar484902/index.html">ุนูู ูุนุงุฏูุงุช ุงูุฏุฑุฌุงุช ุงูุนููุง</a></li>
<li><a href="../ar484904/index.html">ุนุงู ุจุฏูู Splunk - ููู ุบูุฑุช ุฅุญุฏู ุงูุดุฑูุงุช ุงูุฃูุฑูููุฉ ุณูู ุชุญูููุงุช ุจูุงูุงุช ุงููุงูููุงุช ูู ุฑูุณูุง ููู ุชุฑูุชูุง ูุฑุงุกูุง</a></li>
<li><a href="../ar484906/index.html">ูุฑูู ุงูููุฒุนุฉ ููุฑูู ูุคุฏู ุนูู ุงูุจุนูุฏ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>