<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëèüèø üö™ üßì Lernen Sie kontroverse Taktiken, Techniken und allgemeines Wissen (ATT @ CK). Unternehmenstaktik. Teil 11 üë©‚Äçüëß‚Äçüëß üìô „äóÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Befehl und Kontrolle 
 Links zu allen Teilen: 
 Teil 1. Erstzugriff erhalten (Erstzugriff) 
 Teil 2. Ausf√ºhrung 
 Teil 3. Befestigung (Persistenz) 
 T...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Lernen Sie kontroverse Taktiken, Techniken und allgemeines Wissen (ATT @ CK). Unternehmenstaktik. Teil 11</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/449654/"><h2>  Befehl und Kontrolle </h2><br>  <b>Links zu allen Teilen:</b> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 1. Erstzugriff erhalten (Erstzugriff)</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 2. Ausf√ºhrung</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 3. Befestigung (Persistenz)</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 4. Eskalation von Berechtigungen</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 5. Verteidigungshinterziehung</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 6. Abrufen von Anmeldeinformationen (Zugriff auf Anmeldeinformationen)</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 7. Entdeckung</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 8. Seitliche Bewegung</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 9. Datenerfassung (Erfassung)</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 10. Exfiltration</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 11. Befehl und Kontrolle</a> <br><br>  Der Abschnitt ‚ÄûBefehl und Kontrolle‚Äú ( <i>Abk√ºrzung - C2, C &amp; C</i> ) ist die letzte Stufe der in <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ATT &amp; CK Matrix for Enterprise</a> eingef√ºhrten Angriffskette. <br><br>  Befehl und Kontrolle umfassen Techniken, mit denen der Gegner mit Systemen kommuniziert, die mit dem angegriffenen Netzwerk verbunden sind und von diesem kontrolliert werden.  Abh√§ngig von der Konfiguration der Systeme und der Topologie des Zielnetzwerks gibt es viele M√∂glichkeiten, den verdeckten Kanal C2 zu organisieren.  Die gebr√§uchlichsten Techniken sind unter Katze beschrieben.  Allgemeine Empfehlungen zur Organisation von Ma√ünahmen zur Verhinderung und Erkennung von C2 werden in einem separaten Block hervorgehoben und am Ende des Abschnitts platziert. <br><br><a name="habracut"></a><br>  <i>Der Autor ist nicht verantwortlich f√ºr die m√∂glichen Konsequenzen der Anwendung der im Artikel enthaltenen Informationen und entschuldigt sich auch f√ºr m√∂gliche Ungenauigkeiten in einigen Formulierungen und Begriffen.</i>  <i>Die ver√∂ffentlichten Informationen sind eine kostenlose Nacherz√§hlung des Inhalts von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">MITRE ATT &amp; CK</a> .</i> <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Gemeinsame Ports</a> </h3><br>  <i>System:</i> Windows, Linux, MacOS <br>  <i>Beschreibung:</i> Um Firewalls zu umgehen und b√∂swilligen Datenverkehr mit normaler Netzwerkaktivit√§t zu mischen, kann ein Gegner √ºber Standardports, die √ºblicherweise von regul√§ren Anwendungen verwendet werden, mit dem angegriffenen System kommunizieren: <br> <code>TCP: 80 (HTTP) <br> TCP: 443 (HTTPS) <br> TCP: 25 (SMTP) <br> TCP/UDP: 53 (DNS)</code> <br> <br>  Beispiele f√ºr Ports zum Organisieren von Netzwerkverbindungen innerhalb einer feindlichen Enklave (z. B. zwischen einem Proxyserver und anderen Knoten) sind: <br> <code>TCP/UDP: 135 (RPC) <br> TCP/UDP: 22 <br> TCP/UDP: 3389</code> <br> <br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Kommunikation √ºber Wechselmedien</a> </h3><br>  <i>System:</i> Windows, Linux, MacOS <br>  <i>Beschreibung: Ein</i> Gegner kann die C2-Infrastruktur zwischen physisch isolierten Knoten organisieren und Wechselmedien verwenden, um Befehle von System zu System zu √ºbertragen.  Beide Systeme m√ºssen kompromittiert werden.  Ein System mit einer Internetverbindung wird am wahrscheinlichsten durch das erste System beeintr√§chtigt, und das zweite System wird w√§hrend der seitlichen Bewegung durch Replikation von Malware √ºber Wechselmedien gef√§hrdet (siehe <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 8</a> ).  Befehle und Dateien werden von einem isolierten System an ein System mit Internetverbindung weitergeleitet, auf das der Gegner direkten Zugriff hat. <br><br>  Schutzempfehlungen <i>:</i> Deaktivieren Sie die automatische Ausf√ºhrung von Wechseldatentr√§gern.  Verbieten oder beschr√§nken Sie die Verwendung von Wechselmedien auf der Ebene der Organisationsrichtlinien.  Organisieren Sie eine Pr√ºfung der Prozesse, die beim Anschlie√üen von Wechselmedien ausgef√ºhrt werden. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Verbindung √ºber einen Proxy (Verbindungsproxy)</a> </h3><br>  <i>System:</i> Windows, Linux, MacOS <br>  <i>Beschreibung:</i> Ein Proxyserver kann von einem Angreifer verwendet werden, um den Netzwerkverkehr zwischen Systemen umzuleiten, oder als Vermittler f√ºr die Netzwerkkommunikation.  Mit vielen Tools (wie HTRAN, ZXProxy und ZXPortMap) k√∂nnen Sie Datenverkehr umleiten oder Ports weiterleiten. <br><br>  Das Konzept der Proxys kann auch Vertrauensstellungen in Peer-to-Peer (p2p), Mesh-Netzwerken oder vertrauensw√ºrdigen Verbindungen zwischen Netzwerken umfassen.  Ein Netzwerk kann sich innerhalb einer Organisation oder zwischen Organisationen mit Vertrauensstellungen befinden.  Ein Gegner kann Netzwerkvertrauensstellungen verwenden, um C2 zu steuern, die Anzahl der gleichzeitig ausgehenden Netzwerkverbindungen zu verringern, Fehlertoleranz bereitzustellen oder vertrauensw√ºrdige Verbindungen zu verwenden, um Verdacht zu vermeiden. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Benutzerdefiniertes Befehls- und Steuerprotokoll</a> </h3><br>  <i>System:</i> Windows, Linux, MacOS <br>  <i>Beschreibung: Ein</i> Angreifer kann einen C2-Kanal mithilfe seines eigenen Netzwerkprotokolls organisieren, anstatt Befehle / Daten in einem vorhandenen Standardprotokoll der Anwendungsschicht zu kapseln.  Eine feindliche C2-Protokollimplementierung kann bekannte Protokolle oder Benutzerprotokolle (einschlie√ülich Raw-Sockets) zus√§tzlich zu den zugrunde liegenden Protokollen imitieren, die in TCP / IP oder einem anderen Standardnetzwerkstapel dargestellt sind. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Benutzerdefiniertes kryptografisches Protokoll</a> </h3><br>  <i>System:</i> Windows, Linux, MacOS <br>  <i>Beschreibung:</i> Um den √ºber den C2-Kanal √ºbertragenen Verkehr zu verbergen, kann der Gegner sein eigenes kryptografisches Protokoll oder seinen eigenen Verschl√ºsselungsalgorithmus verwenden.  Ein einfaches Schema, wie die XOR-Verschl√ºsselung von einfachem Text mit einem festen Schl√ºssel, liefert Chiffretext (wenn auch sehr schwach). <br><br>  Propriet√§re Verschl√ºsselungsschemata k√∂nnen in ihrer Komplexit√§t variieren.  Die Analyse und das Reverse Engineering von Malware-Beispielen kann verwendet werden, um den verwendeten Algorithmus und den Verschl√ºsselungsschl√ºssel erfolgreich zu erkennen.  Einige Angreifer versuchen m√∂glicherweise, ihre eigene Version eines bekannten kryptografischen Algorithmus zu implementieren, anstatt eine bekannte Bibliothek zu verwenden, was zu unbeabsichtigten Fehlern beim Betrieb feindlicher Software f√ºhren kann. <br><br>  <i>Schutzempfehlungen:</i> Wenn Malware eine eigene Verschl√ºsselung mit symmetrischen Schl√ºsseln verwendet, k√∂nnen aus Softwarebeispielen ein Algorithmus und ein Schl√ºssel abgerufen werden, um den Netzwerkverkehr zu dekodieren und Malware-Signaturen zu identifizieren. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Datencodierung</a> </h3><br>  <i>System:</i> Windows, Linux, MacOS <br>  <i>Beschreibung:</i> √úber den C2-Kanal √ºbertragene Informationen werden mit Standard-Datencodierungssystemen codiert.  Die Verwendung der Datencodierung muss den vorhandenen Protokollspezifikationen entsprechen und umfasst die Verwendung von ASCII-, Unicode-, Base64-, MIME-, UTF-8- oder anderen bin√§ren Text- und Zeichencodierungen.  Einige Codierungssysteme wie gzip k√∂nnen zus√§tzlich Daten komprimieren. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Datenverschleierung</a> </h3><br>  <i>System:</i> Windows, Linux, MacOS <br>  <i>Beschreibung:</i> Daten in Kanal C2 k√∂nnen ausgeblendet werden (jedoch nicht unbedingt mit Verschl√ºsselung), um das Erkennen und Entschl√ºsseln des √ºbertragenen Inhalts zu erschweren, den Kommunikationsprozess weniger auff√§llig zu machen und die √ºbertragenen Befehle auszublenden.  Es gibt viele Verschleierungsmethoden, z. B. das Hinzuf√ºgen unn√∂tiger Daten zum Protokollverkehr, die Verwendung von Steganographie, die Kombination von legitimem Verkehr mit C2-Verkehr oder die Verwendung eines nicht standardm√§√üigen Datencodierungssystems, z. B. eines modifizierten Base64 im Hauptteil einer HTTP-Anforderungsnachricht. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Ausblenden der Endadresse einer Verbindung</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">(Domain Fronting)</a> </h3><br>  <i>System:</i> Windows, Linux, MacOS <br>  <i>Beschreibung:</i> Das Wesentliche bei Domain Fronting ist die M√∂glichkeit, die tats√§chliche Zieladresse des HTTP-Pakets in CDN-Netzwerken (Content Delivery Netwoks) auszublenden. <br><br>  <i>Beispiel: Es gibt Dom√§ne X und Dom√§ne Y, die Clients derselben CDNs sind.</i>  <i>Ein Paket mit der Dom√§ne X-Adresse im TLS-Header und der Dom√§ne Y-Adresse im HTTP-Header wird h√∂chstwahrscheinlich an die Dom√§ne Y-Adresse √ºbermittelt, selbst wenn die Netzwerkkommunikation zwischen Quell- und Zieladresse verboten ist.</i> <br><br>  Ein HTTP-Paket enth√§lt zwei S√§tze von Headern: Der erste, TLS, befindet sich im offenen Teil des Pakets, der zweite, HTTP - bezieht sich auf den verschl√ºsselten Teil des Pakets.  Dar√ºber hinaus verf√ºgt jeder Header √ºber ein eigenes Feld zur Angabe der Ziel-IP-Adresse.  Die Essenz von Domain Fronting ist die absichtliche Verwendung verschiedener Domainnamen im Feld "SNI" des TLS-Headers und im Feld "Host" des HTTP-Headers.  Somit wird die zul√§ssige Zieladresse im Feld "SNI" und die Lieferzieladresse im Feld "Host" angezeigt.  Wenn beide Adressen zu denselben CDNs geh√∂ren, kann der Routing-Knoten nach Empfang eines solchen Pakets die Anforderung an die Zieladresse weiterleiten. <br><br>  Es gibt eine andere Variante dieser Technik, die als dom√§nenloses Fronting bezeichnet wird.  In diesem Fall wird das Feld "SNI" (TLS-Header) absichtlich leer gelassen, wodurch das Paket sein Ziel erreichen kann, selbst wenn das CDN auf √úbereinstimmung der Felder "SNI" und "HOST" pr√ºft (wenn leere SNI-Felder ignoriert werden). <br><br>  Schutzempfehlungen <i>:</i> Wenn es m√∂glich ist, den HTTPS-Verkehr zu √ºberpr√ºfen, k√∂nnen Verbindungen √§hnlich wie bei Domain Fronting erfasst und analysiert werden.  Wenn eine SSL-√úberpr√ºfung durchgef√ºhrt wird oder der Datenverkehr nicht verschl√ºsselt ist, kann das Feld "HOST" auf √úbereinstimmung mit dem Feld "SNI" oder auf das Vorhandensein der angegebenen Adresse in wei√üen oder schwarzen Listen √ºberpr√ºft werden.  Um Domain Fronting zu implementieren, muss ein Gegner wahrscheinlich zus√§tzliche Tools in einem gef√§hrdeten System bereitstellen, dessen Installation durch die Installation lokaler Host-Schutz-Tools verhindert werden kann. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Fallback-Kan√§le</a> </h3><br>  <i>System:</i> Windows, Linux, MacOS <br>  <i>Beschreibung:</i> Um die Zuverl√§ssigkeit des Steuerkanals zu gew√§hrleisten und ein √úberschreiten der Schwellenwerte der √ºbertragenen Daten zu vermeiden, k√∂nnen Angreifer Sicherungs- oder alternative Kommunikationskan√§le verwenden, wenn der Hauptkanal C2 kompromittiert oder nicht verf√ºgbar ist. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Mehrstufige Kan√§le</a> </h3><br>  <i>System:</i> Windows, Linux, MacOS <br>  <i>Beschreibung:</i> Angreifer k√∂nnen mehrstufige C2-Kan√§le erstellen, die unter verschiedenen Bedingungen oder f√ºr bestimmte Funktionen verwendet werden.  Die Verwendung mehrerer Schritte kann den C2-Kanal verwirren und verschleiern, wodurch es schwierig wird, ihn zu erkennen. <br><br>  Auf dem Zielhost ausgef√ºhrte RATs initiieren eine Verbindung zum First-Tier-Server C2.  Der erste Schritt verf√ºgt m√∂glicherweise √ºber automatisierte Funktionen zum Sammeln grundlegender Informationen zum Host, zum Ausf√ºhren von Aktualisierungstools und zum Herunterladen zus√§tzlicher Dateien.  Als n√§chstes kann ein zweites RAT-Tool gestartet werden, um den Host auf den Server C2 der zweiten Ebene umzuleiten.  Die zweite Stufe von C2 wird h√∂chstwahrscheinlich voll funktionsf√§hig sein und es dem Feind erm√∂glichen, mit dem Zielsystem √ºber die Umkehrschale und zus√§tzliche RAT-Funktionen zu interagieren. <br><br>  Die Schritte C2 werden h√∂chstwahrscheinlich getrennt voneinander platziert, ohne ihre Infrastruktur zu √ºberschreiten.  Der Bootloader kann auch redundantes Feedback der ersten Stufe oder Ersatzkan√§le haben, falls der urspr√ºngliche Kanal der ersten Stufe erkannt und blockiert wird. <br><br>  <i>Schutzempfehlungen: Die</i> zur Organisation mehrstufiger Kan√§le verwendete C2-Infrastruktur kann blockiert werden, wenn dies im Voraus bekannt ist.  Wenn im C2-Verkehr eindeutige Signaturen vorhanden sind, k√∂nnen diese zum Identifizieren und Blockieren des Kanals verwendet werden. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Mehrfachproxy (Multi-Hop-Proxy)</a> </h3><br>  <i>System:</i> Windows, Linux, MacOS <br>  Beschreibung: Um die Quelle des b√∂swilligen Datenverkehrs zu verschleiern, kann ein Gegner eine Kette von mehreren Proxyservern verwenden.  In der Regel kann der Verteidiger nur den letzten Proxy bestimmen.  Die Verwendung von Multiproxing erschwert die Identifizierung der Quelle f√ºr b√∂swilligen Datenverkehr, sodass die verteidigende Partei den b√∂swilligen Datenverkehr √ºber mehrere Proxyserver √ºberwachen muss. <br><br>  <i>Schutzempfehlungen: Der</i> Datenverkehr zu bekannten anonymen Netzwerken (z. B. Tor) und C2-Infrastrukturen kann durch die Organisation von Schwarzwei√ülisten blockiert werden.  Sie sollten jedoch darauf achten, dass diese Blockierungsmethode mit √§hnlichen Techniken wie Domain Fronting umgangen werden kann. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Multiband-Kommunikation</a> </h3><br>  <i>System:</i> Windows, Linux, MacOS <br>  <i>Beschreibung:</i> Einige Gegner teilen den C2-Datenkanal m√∂glicherweise auf verschiedene Protokolle auf.  Eingehende Befehle k√∂nnen √ºber ein Protokoll und ausgehende Daten auf andere Weise √ºbertragen werden, sodass Sie bestimmte Firewall-Einschr√§nkungen umgehen k√∂nnen.  Die Trennung kann auch versehentlich erfolgen, um Warnungen vor dem √úberschreiten von Schwellenwerten f√ºr eine einzelne Nachricht zu vermeiden. <br><br>  <i>Schutzempfehlungen:</i> Analysieren Sie den Inhalt der Pakete, um Verbindungen zu finden, die nicht dem erwarteten Protokollverhalten f√ºr den verwendeten Port entsprechen.  √úbereinstimmende Warnungen zwischen mehreren Kommunikationskan√§len k√∂nnen auch bei der Erkennung von C2 hilfreich sein. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Mehrschichtverschl√ºsselung</a> </h3><br>  <i>System:</i> Windows, Linux, MacOS <br>  <i>Beschreibung: Ein</i> Gegner kann mehrere Ebenen der C2-Verkehrsverschl√ºsselung anwenden.  In der Regel (aber andere Optionen sind nicht ausgeschlossen) wird zus√§tzliches Tunneln unter Verwendung eines eigenen Verschl√ºsselungsschemas als Teil der HTTPS- oder SMTPS-Verschl√ºsselung verwendet. <br><br>  <i>Sicherheitstipps: Die</i> Verwendung von Verschl√ºsselungsprotokollen kann die typische C2-Erkennung auf der Grundlage einer signaturbasierten Verkehrsanalyse erschweren.  Wenn die Malware ein standardm√§√üiges kryptografisches Protokoll verwendet, kann die SSL / TLS-√úberpr√ºfung verwendet werden, um den C2-Verkehr auf einigen verschl√ºsselten Kan√§len zu erkennen.  Die SSL / TLS-√úberpr√ºfung birgt bestimmte Risiken, die vor der Implementierung ber√ºcksichtigt werden m√ºssen, um potenzielle Sicherheitsprobleme wie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">unvollst√§ndige Zertifikats√ºberpr√ºfung</a> zu vermeiden.  Nach der SSL / TLS-√úberpr√ºfung ist m√∂glicherweise eine zus√§tzliche kryptografische Analyse f√ºr die Verschl√ºsselung der zweiten Ebene erforderlich. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Port klopfen</a> </h3><br>  <i>System:</i> Linux, MacOS <br>  <i>Rechte:</i> Benutzer <br>  <i>Beschreibung:</i> Angreifer k√∂nnen Port Knocking-Methoden verwenden, um offene Ports auszublenden, √ºber die sie eine Verbindung zum System herstellen. <br><br>  <i>Sicherheitstipps: Die</i> Verwendung von Stateful Firewalls kann verhindern, dass einige Port Knocking-Optionen implementiert werden. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">RAS-Tools</a> </h3><br>  <i>System:</i> Windows, Linux, MacOS <br>  <i>Beschreibung:</i> Um einen interaktiven Befehls- und Kontrollmodus einzurichten, kann ein Angreifer legitime Software verwenden, die f√ºr diese entwickelt wurde.  Workstation-Support und Software f√ºr den Remotezugriff, z. B. TeamViewer, Go2Assist, LogMain, AmmyAdmin usw., die normalerweise von technischen Supportdiensten verwendet werden und auf die Whitelist gesetzt werden k√∂nnen.  Fernzugriffstools wie VNC, Ammy und Teamview werden am h√§ufigsten von Ingenieuren des technischen Supports und h√§ufig von Cyberkriminellen verwendet. <br><br>  RAS-Tools k√∂nnen installiert werden, nachdem das System f√ºr die Verwendung als alternativer C2-Kanal kompromittiert wurde.  Sie k√∂nnen auch als Bestandteil von Malware verwendet werden, um eine umgekehrte Verbindung mit einem Server oder System herzustellen, das von einem Gegner gesteuert wird. <br><br>  Verwaltungstools wie TeamViewer wurden von mehreren Gruppen verwendet, die sich auf Regierungsbeh√∂rden in L√§ndern konzentrierten, die f√ºr russische staatliche und kriminelle Unternehmen von Interesse sind. <br><br>  Schutzempfehlungen: RAS-Tools k√∂nnen in Verbindung mit Domain Fronting-Techniken verwendet werden. Es ist daher ratsam, zu verhindern, dass der Gegner RAT-Tools mithilfe von Host-Sicherheitstools installiert. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Remote-Dateikopie</a> </h3><br>  <i>System:</i> Windows, Linux, MacOS <br>  <i>Beschreibung:</i> Dateien k√∂nnen von einem System auf ein anderes kopiert werden, um feindliche Tools oder andere Dateien bereitzustellen.  Dateien k√∂nnen von einem externen System, das von einem Angreifer gesteuert wird, √ºber den C &amp; C-Kanal oder mithilfe anderer Tools unter Verwendung alternativer Protokolle wie FTP kopiert werden.  Dateien k√∂nnen auch mit integrierten Tools wie scp, rsync, sftp auf Mac und Linux kopiert werden. <br><br>  Feinde k√∂nnen Dateien auch seitlich zwischen internen Opfersystemen kopieren, um die Netzwerkbewegung und die Ausf√ºhrung von Remotebefehlen zu unterst√ºtzen.  Dies kann mithilfe von Dateifreigabeprotokollen erfolgen, indem Netzwerkressourcen √ºber SMB verbunden werden oder authentifizierte Verbindungen zu Windows Admin Shares oder RDP verwendet werden. <br><br>  <i>Schutzempfehlungen:</i> Zur Erkennung wird <i>empfohlen</i> , die Erstellung und √úbertragung von Dateien √ºber das Netzwerk √ºber das SMB-Protokoll zu √ºberwachen.  Ungew√∂hnliche Prozesse mit externen Netzwerkverbindungen, die Dateien im System erstellen, sollten ebenfalls verd√§chtig sein.  Die atypische Verwendung von Dienstprogrammen wie FTP kann ebenfalls verd√§chtig sein. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Standard Application Layer Protocol</a> </h3><br>  <i>System:</i> Windows, Linux, MacOS <br>  <i>Beschreibung:</i> Um zu vermeiden, dass C2-Verkehr erkannt und mit vorhandenem Netzwerkverkehr gemischt wird, k√∂nnen Angreifer Standardprotokolle auf Anwendungsebene wie HTTP, HTTPS, SMTP oder DNS verwenden.  F√ºr Verbindungen innerhalb des C2-Kanals (Enklave), beispielsweise zwischen dem Proxyserver und dem Masterknoten und anderen Knoten, werden normalerweise die RPC-, SSH- oder RDP-Protokolle verwendet. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Standard-Kryptographieprotokoll</a> </h3><br>  <i>System:</i> Windows, Linux, MacOS <br>  <i>Beschreibung:</i> Gegner k√∂nnen bekannte Verschl√ºsselungsalgorithmen verwenden, um den C2-Verkehr zu verbergen.  Trotz der Verwendung eines robusten Algorithmus kann der C2-Verkehr mithilfe von Reverse Engineering aufgedeckt werden, wenn geheime Schl√ºssel von Malware verschl√ºsselt und generiert und / oder in Konfigurationsdateien gespeichert werden. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Standardprotokoll ohne Anwendungsschicht</a> </h3><br>  <i>System:</i> Windows, Linux, MacOS <br>  <i>Beschreibung:</i> Protokolle auf Nichtanwendungsschicht des OSI-Modells k√∂nnen f√ºr die Kommunikation zwischen dem infizierten Host und dem Server oder f√ºr die Interaktion infizierter Hosts im Netzwerk verwendet werden.  In bekannten Implementierungen wurden das Netzwerkschichtprotokoll - ICMP, die Transportschicht - UDP, die Sitzungsschicht - SOCKS und Protokolle wie umgeleitet / getunnelt wie Serial over LAN (SOL) verwendet. <br><br>  ICMP wird h√§ufig von Cyberkriminellen verwendet, um die Kommunikation zwischen Hosts zu verbergen.  Da ICMP Teil der Internet Protocol Suite ist und von allen IP-kompatiblen Ger√§ten implementiert werden muss, wird es nicht so h√§ufig √ºberwacht wie andere Protokolle wie TCP oder UDP. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Ausgefallene Ports (ungew√∂hnlich genutzter Port)</a> </h3><br>  <i>System:</i> Windows, Linux, MacOS <br>  <i>Beschreibung:</i> Gegner k√∂nnen √ºber C2 √ºber einen nicht standardm√§√üigen Port kommunizieren, um Proxyserver und Firewalls zu umgehen, die nicht korrekt konfiguriert wurden. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Webdienst</a> </h3><br>  <i>System:</i> Windows <br>  <i>Rechte:</i> Benutzer <br>  <i>Beschreibung:</i> Angreifer k√∂nnen einen laufenden, legitimen externen Webdienst verwenden, um Befehle zur Steuerung eines infizierten Systems zu senden.  Verwaltungsserver werden als Befehl und Kontrolle (C &amp; C oder C2) bezeichnet.  Beliebte Websites und soziale Netzwerke k√∂nnen als Mechanismus f√ºr C2 fungieren, und verschiedene √∂ffentliche Dienste wie Google oder Twitter k√∂nnen ebenfalls verwendet werden.  All dies hilft, b√∂swillige Aktivit√§ten im gesamten Verkehrsfluss zu verbergen.  Webdienste verwenden normalerweise SSL / TLS, sodass Gegner eine zus√§tzliche Schutzschicht erhalten. <br><br>  <i>Schutzempfehlungen: Mit</i> Firewalls und Webproxys k√∂nnen Richtlinien implementiert werden, um die externe Netzwerkkommunikation einzuschr√§nken. <br><br><h3>  Allgemeine Empfehlungen zur Organisation von Ma√ünahmen zur Pr√§vention und Erkennung von C2 </h3><br><br>  ‚Ä¢ IDS / DLP-Systeme, die eine signaturbasierte Verkehrsanalyse verwenden, k√∂nnen verwendet werden, um bekannte spezifische C2-Tools und Schadprogramme zu erkennen und zu blockieren. Daher wird der Gegner h√∂chstwahrscheinlich die im Laufe der Zeit verwendeten Tools √§ndern oder das Daten√ºbertragungsprotokoll so konfigurieren, dass eine Erkennung durch ihm bekannte Mittel vermieden wird Schutz; <br><br>  ‚Ä¢ Verwenden Sie Tools zum Schutz vor Virenendpunkten, um bekannte spezifische C2-Tools und Malware zu blockieren. <br><br>  ‚Ä¢ Stellen Sie sicher, dass Hosts im internen Netzwerk nur √ºber autorisierte Schnittstellen zug√§nglich sind. <br><br>  ‚Ä¢ Begrenzen Sie den ausgehenden Datenverkehr, indem Sie nur die erforderlichen Ports an den Firewalls und Proxys √ºber die entsprechenden Netzwerk-Gateways zulassen. <br><br>  ‚Ä¢ Blockieren Sie Dom√§nen und IP-Adressen bekannter C2-Infrastrukturen.  Es ist jedoch zu beachten, dass dies keine wirksame und langfristige L√∂sung ist<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gegner k√∂nnen oft die Infrastruktur von C2 √§ndern; </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä¢ Verwenden Sie Whitelist-Tools f√ºr Anwendungen, um die Installation und Ausf√ºhrung von Software von Drittanbietern zu erschweren. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä¢ Beschr√§nken Sie mithilfe von Firewall, Anwendungsfirewalls und Proxys den ausgehenden Datenverkehr auf Websites und Dienste, die von bekannten RAS-Tools (TeamViewer, Go2Assist, LogMain, AmmyAdmin usw.) verwendet werden. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä¢ Wenn Malware eine eigene Verschl√ºsselung mit symmetrischen Schl√ºsseln verwendet, k√∂nnen mithilfe des Reverse Engineering von Softwarebeispielen ein Algorithmus und ein Schl√ºssel zum Dekodieren des Netzwerkverkehrs und zum Identifizieren von Malware-Signaturen abgerufen werden. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä¢ √úberwachen Sie Aufrufe von API-Funktionen im Zusammenhang mit der Aufnahme oder Verwendung alternativer Kommunikationskan√§le.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä¢ Analysieren Sie den Netzwerkverkehr auf ICMP-Nachrichten oder andere Protokolle, die abnormale Daten enthalten oder im Netzwerk oder au√üerhalb des Netzwerks normalerweise nicht sichtbar sind. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä¢ Analysieren Sie Netzwerkfl√ºsse, um abnormale Fl√ºsse zu identifizieren, z. B. wenn ein Client wesentlich mehr Daten sendet, als er von einem Server empf√§ngt, oder wenn ein Prozess, der normalerweise kein Netzwerk verwendet, Netzwerkverbindungen √∂ffnet. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä¢ Analysieren Sie Netzwerkfl√ºsse, um Pakete zu identifizieren, die nicht dem Protokollstandard f√ºr den verwendeten Port entsprechen.</font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de449654/">https://habr.com/ru/post/de449654/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de449644/index.html">VW-Studie zeigt Golf-E nach 100.000 km umweltfreundlich</a></li>
<li><a href="../de449646/index.html">Wavelet-Analyse. Die Grundlagen</a></li>
<li><a href="../de449648/index.html">Indigene Mikroben auf dem H√∂hepunkt der Mode</a></li>
<li><a href="../de449650/index.html">Vom Forum zum Video - der Weg des Graphomanen</a></li>
<li><a href="../de449652/index.html">Wir laden Entwickler ein, am PHDays 9 am Hackathon teilzunehmen</a></li>
<li><a href="../de449656/index.html">Wie man sich mit vk api unterh√§lt</a></li>
<li><a href="../de449658/index.html">Googles neues Osterei - Thanos und der Handschuh der Unendlichkeit im Vergleich zu den Google-Suchergebnissen</a></li>
<li><a href="../de449662/index.html">Willkommen auf der PyCon Russia 2019</a></li>
<li><a href="../de449664/index.html">Konfigurieren von GitLab CI zum Laden eines Java-Projekts in Maven Central</a></li>
<li><a href="../de449666/index.html">DevOpsForum 2019. DevOps bereitstellen kann nicht warten</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>