<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ ๐จโ๐จโ๐งโ๐ฆ ๐ฌ bytes.Buffer in Go: ุชุญุณููุงุช ูุง ุชุนูู ๐๐ฝ โ ๐</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ุงูุนุฏูุฏ ูู ูุจุฑูุฌู Go ุนูู ุฏุฑุงูุฉ ุจุงูุจุงูุช . ุชุชูุซู ุฅุญุฏู ููุฒุงุชู ูู ุฃูู ูุณูุญ ูู ุจุชุฌูุจ ุชุฎุตูุต ุฐุงูุฑุฉ ูู ุงููููุฉ ุจุงูุทุฑููุฉ ููุณูุง ุงูุชู ูุชู ุจูุง " ุชุญุณูู ุงูุชุฎุฒูู ุงููุคู...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>bytes.Buffer in Go: ุชุญุณููุงุช ูุง ุชุนูู</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/intel/blog/422447/" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl">  ุงูุนุฏูุฏ ูู ูุจุฑูุฌู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Go</a> ุนูู ุฏุฑุงูุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุจุงูุจุงูุช</a> .  ุชุชูุซู ุฅุญุฏู ููุฒุงุชู ูู ุฃูู ูุณูุญ ูู ุจุชุฌูุจ ุชุฎุตูุต ุฐุงูุฑุฉ ูู ุงููููุฉ ุจุงูุทุฑููุฉ ููุณูุง ุงูุชู ูุชู ุจูุง " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุชุญุณูู ุงูุชุฎุฒูู ุงููุคูุช / ุงูุญุฌู ุงูุตุบูุฑ</a> ": </p><br><pre style=";text-align:right;direction:rtl"><code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">type</span></span> Buffer <span class="hljs-keyword"><span class="hljs-keyword">struct</span></span> { bootstrap [<span class="hljs-number"><span class="hljs-number">64</span></span>]<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> <span class="hljs-comment"><span class="hljs-comment">//        // ...   }</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ููุงู ูุดููุฉ ูุงุญุฏุฉ ููุท.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุง ูุนูู</a> ูุฐุง ุงูุชุญุณูู. </p><br><p style=";text-align:right;direction:rtl">  ูู ููุงูุฉ ูุฐู ุงูููุงูุฉ ุ ุณุชูุชุดู ููุงุฐุง ูุง ูุนูู ูุฐุง ุงูุชุญุณูู ููุง ูููููุง ุงูููุงู ุจู ุญูุงู ุฐูู. </p><a name="habracut"></a><br><h1 id="kak-bylo-po-zadumke-small-buffer-optimization" style=";text-align:right;direction:rtl">  ููุง ูู ููุตูุฏ ุ "ุชุญุณูู ุงููุฎุฒู ุงููุคูุช ุงูุตุบูุฑ" </h1><br><p style=";text-align:right;direction:rtl">  ุฏุนููุง ููุฏู ุชุนุฑูููุง ูุจุณุทูุง ููููุงู <code>bytes.Buffer</code> </p><br><pre style=";text-align:right;direction:rtl"> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> smallBufSize <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> = <span class="hljs-number"><span class="hljs-number">64</span></span> <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> Buffer <span class="hljs-keyword"><span class="hljs-keyword">struct</span></span> { bootstrap [smallBufSize]<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> buf []<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุนูุฏูุง ูููู ุจุชูููุฐ ุฅุฌุฑุงุกุงุช ุนูู <code>Buffer</code> ุ ุนูู ุณุจูู ุงููุซุงู ุ ุงุณุชุฏุนุงุก ุฃุณููุจ <code>Buffer.Write</code> ุ ูุชู ุฅุฌุฑุงุก ุงูุณุฌู ุฏุงุฆููุง ูู <code>buf</code> ุ ููุน ุฐูู ุ ูุจู ูุฐุง ุงูุณุฌู ุ ูุชู <code>Buffer.grow(n)</code> ุฏุงุฎู ูู ุทุฑููุฉ ููุงุซูุฉ ุ ููุง ูุถูู ูุฌูุฏ ูุณุงุญุฉ ูุงููุฉ ูู ูุฐู ุงูุดุฑูุญุฉ ูู ุจุงูุช <code>n</code> ุงููุงุฏูุฉ. </p><br><p style=";text-align:right;direction:rtl">  ูุฏ ูุจุฏู ุงูููู ุดูุฆูุง ูุซู ูุฐุง: </p><br><pre style=";text-align:right;direction:rtl"> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(b *Buffer)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">grow</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(n </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { <span class="hljs-comment"><span class="hljs-comment">//         bytes.Buffer. l := len(b.buf) //   Buffer need := n + l have := cap(b.buf) - l if have &gt;= need { b.buf = b.buf[:need] return } if need &lt;= smallBufSize { //     , //   . b.buf = b.bootstrap[:] } else { // growFactor -     . //     need  need*2. newBuf := make([]byte, need, growFactor(need)) copy(newBuf, b.buf) b.buf = newBuf } }</span></span></code> </pre> <br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุงูุงูุชุฑุงุถุงุช ุงููุณุชุฎุฏูุฉ ูู ุชูููุฐ Buffer.grow</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><hr><br><p style=";text-align:right;direction:rtl">  ูุญู <code>len(b.buf)</code> ุฃู <code>len(b.buf)</code> ูู ุทูู ุงูุจูุงูุงุช ุงููุนูู ูู ุงููุฎุฒู ุงููุคูุช ุ ุงูุฃูุฑ ุงูุฐู ูุชุทูุจ <code>Write</code> ูุงุณุชุฎุฏุงู ุฃุณุงููุจ ุงูุฅูุญุงู ูุฅุถุงูุฉ ูุญุฏุงุช ุจุงูุช ุฌุฏูุฏุฉ ุฅูู ุงูุดุฑูุญุฉ.  ูุฐุง ููุณ ูู ุงูุญุงู ูู <code>bytes.Buffer</code> ูู ุงูููุชุจุฉ ุงูููุงุณูุฉ ุ ูููู ููุซุงู ุ ูุฐู ุชูุงุตูู ุชูููุฐ ุบูุฑ ุฐุงุช ุตูุฉ. </p><br><hr></div></div><br><p style=";text-align:right;direction:rtl">  ุฅุฐุง <code>b</code> ุชุฎุตูุต <code>b</code> ุนูู ุงูููุฏุณ ุ ูุณูุชู ุชุฎุตูุต <code>bootstrap</code> ุจุฏุงุฎููุง ุนูู ุงูููุฏุณ ุ ููุง ูุนูู ุฃู ุงูุดุฑูุญุฉ <code>b.buf</code> ุณุชุนูุฏ ุงุณุชุฎุฏุงู ุงูุฐุงูุฑุฉ ุฏุงุฎู <code>b</code> ุฏูู ุงูุญุงุฌุฉ ุฅูู ุชุฎุตูุต ุฅุถุงูู. </p><br><p style=";text-align:right;direction:rtl">  ุนูุฏูุง ููุดู <code>grow</code> ุนู ุฃู ูุตูููุฉ <code>bootstrap</code> ุบูุฑ ูุงููุฉ ุจุงููุนู ุ ุณูุชู ุฅูุดุงุก ุดุฑูุญุฉ "ุญููููุฉ" ุฌุฏูุฏุฉ ุ ุญูุซ ุณูุชู ุจุนุฏ ุฐูู ูุณุฎ ุนูุงุตุฑ ูู ุงูุชุฎุฒูู ุงูุณุงุจู (ูู "ุงููุฎุฒู ุงููุคูุช ุงูุตุบูุฑ").  ุจุนุฏ ุฐูู ุ <code>Buffer.bootstrap</code> ุฃูููุชู.  ุฅุฐุง ุชู <code>Buffer.Reset</code> ุ <code>cap(b.buf)</code> ููุง ูู ููู ุชููู ููุงู ุญุงุฌุฉ ุจุนุฏ ุงูุขู ุฅูู ูุตูููุฉ <code>bootstrap</code> . </p><br><h1 id="pamyat-ubegayuschaya-v-heap" style=";text-align:right;direction:rtl">  ุชุดุบูู ุงูุฐุงูุฑุฉ ูู ูููุฉ ุงูุฐุงูุฑุฉ ุงููุคูุชุฉ </h1><br><p style=";text-align:right;direction:rtl">  ูู ุงููุชููุน ุฃูุถูุง ุฃู ูููู ุงููุงุฑุฆ ุนูู ุงูุฃูู ุณุทุญููุง ุนูู ุฏุฑุงูุฉ ุจูุง ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุชุญููู ุงููุฑูุจ</a> ูู Go. </p><br><p style=";text-align:right;direction:rtl">  ุฎุฐ ุจุนูู ุงูุงุนุชุจุงุฑ ุงูุญุงูุฉ ุงูุชุงููุฉ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">f</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> *</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Buffer</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> b bytes.Buffer <span class="hljs-comment"><span class="hljs-comment">// leak.go:11:6: moved to heap: b return &amp;b // leak.go:12:9: &amp;b escapes to heap }</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ููุง ุณูุชู ุชุฎุตูุต <code>b</code> ูู ูููุฉ ุงูุฐุงูุฑุฉ ุงููุคูุชุฉ.  ูุงูุณุจุจ ูู ุฐูู ูู ูุคุดุฑ ุงูุชุณุฑูุจ ุฅูู <code>b</code> : </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">$ go tool compile -m leak.go leak.go:12:9: &amp;b escapes to heap leak.go:11:6: moved to heap: b</code> </pre> <br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุงููุตุทูุญุงุช</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><hr><br><p style=";text-align:right;direction:rtl">  ูู ูุฐู ุงูููุงูุฉ ุ ูุชู ุงุณุชุฎุฏุงู "ุงูุชุณุฑุจ" ู "ุงููุฑูุจ" ุจุดูู ูุชุฑุงุฏู ุชูุฑูุจูุง. </p><br><p style=";text-align:right;direction:rtl">  ููุงู ุจุนุถ ุงูุงุฎุชูุงู ูู ุงููุชุฑุฌู ููุณู ุ ุนูู ุณุจูู ุงููุซุงู ุ ุงููููุฉ "ุงููุฑูุจ ุฅูู ูููุฉ ุงูุฐุงูุฑุฉ ุงููุคูุชุฉ" ุ ูููู ูุนููุงุช ุงูุฏุงูุฉ ูู "ุชุณุฑุจ ุงููุนููุฉ x". </p><br><p style=";text-align:right;direction:rtl">  ุชุนูู ูุนููุฉ ุงูุชุณุฑุจ ุฃูู ุณูุชู ุชุฎุตูุต ุงููุณูุทุฉ ุงูุชู ุชู ุชูุฑูุฑูุง ููุฐู ุงููุนููุฉ ูู ูููุฉ ุงูุฐุงูุฑุฉ ุงููุคูุชุฉ.  ุจูุนูู ุขุฎุฑ ุ ุชุคุฏู ุงููุนููุฉ ุงููุชุณุฑุจุฉ ุฅูู ูุฑูุจ ุงูุญุฌุฌ ุฅูู ูููุฉ. </p><br><hr></div></div><br><p style=";text-align:right;direction:rtl">  ูุง ุณุจู ูุงู ุญุงูุฉ ูุงุถุญุฉ ุ ูููู ูุงุฐุง ุนู ูุฐุง: </p><br><pre style=";text-align:right;direction:rtl"> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">length</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">int</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> b bytes.Buffer b.WriteString(<span class="hljs-string"><span class="hljs-string">"1"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> b.Len() }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ููุง ูุญุชุงุฌ ุฅูู ุจุงูุช ูุงุญุฏ ููุท ุ ูู ุดูุก ููุงุณุจ ููู <code>bootstrap</code> ุ ุงููุฎุฒู ุงููุคูุช ููุณู ูุญูู ููุง "ููุฑุจ" ูู ุงููุธููุฉ.  ูุฏ ุชูุงุฌุฃ ุ ูููู ุงููุชูุฌุฉ ุณุชููู ูู ููุณูุง ุ <code>b</code> ุชุฎุตูุต ูู ูููุฉ ุงูุฐุงูุฑุฉ ุงููุคูุชุฉ. </p><br><img src="https://habrastorage.org/webt/_d/3w/jr/_d3wjrildbyauunsvvv5oq7zqpo.jpeg"><br><p style=";text-align:right;direction:rtl">  ููุชุฃูุฏ ุ ููููู ุงูุชุญูู ูู ุฐูู ุจุงุณุชุฎุฏุงู ุงููุนูุงุฑ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs powershell">BenchmarkLength<span class="hljs-literal"><span class="hljs-literal">-8</span></span> <span class="hljs-number"><span class="hljs-number">20000000</span></span> <span class="hljs-number"><span class="hljs-number">90.1</span></span> ns/op <span class="hljs-number"><span class="hljs-number">112</span></span> B/op <span class="hljs-number"><span class="hljs-number">1</span></span> allocs/op</code> </pre> <br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ูุงุฆูุฉ ูุฑุฌุนูุฉ</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><hr><br><pre style=";text-align:right;direction:rtl"> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> p <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ( <span class="hljs-string"><span class="hljs-string">"bytes"</span></span> <span class="hljs-string"><span class="hljs-string">"testing"</span></span> ) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">length</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">int</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> b bytes.Buffer b.WriteString(<span class="hljs-string"><span class="hljs-string">"1"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> b.Len() } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">BenchmarkLength</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(b *testing.B)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i := <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; bN; i++ { _ = length() } }</code> </pre> <br><hr></div></div><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุดุฑุญ 112 ุจ / ุน</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><hr><br><p style=";text-align:right;direction:rtl">  ุนูุฏูุง ูุทูุจ ููุช ุงูุชุดุบูู ุชุฎุตูุต <code>N</code> ุจุงูุช ุ ููุณ ูู ุงูุถุฑูุฑู ุชุฎุตูุต <code>N</code> ุจุงูุช ุจุงูุถุจุท. </p><br><blockquote style=";text-align:right;direction:rtl">  ุฌููุน ุงููุชุงุฆุฌ ุฃุฏูุงู ูู ูุฒูุฌ ูู <code>GOOS=linux</code> ู <code>GOARCH=AMD64</code> . </blockquote><br><pre style=";text-align:right;direction:rtl"> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> benchmark <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">"testing"</span></span> <span class="hljs-comment"><span class="hljs-comment">//go:noinline func alloc9() []byte { return make([]byte, 9) } func BenchmarkAlloc9(b *testing.B) { for i := 0; i &lt; bN; i++ { _ = alloc9() } }</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ุฅุฐุง ููุช ุจุชุดุบูู <code>go test -bench=. -benchmem</code>  <code>go test -bench=. -benchmem</code> ูุน ูุฐุง ุงูุงุฎุชุจุงุฑ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs powershell">BenchmarkAlloc9<span class="hljs-literal"><span class="hljs-literal">-8</span></span> <span class="hljs-number"><span class="hljs-number">50000000</span></span> <span class="hljs-number"><span class="hljs-number">33.5</span></span> ns/op <span class="hljs-number"><span class="hljs-number">16</span></span> B/op <span class="hljs-number"><span class="hljs-number">1</span></span> allocs/op</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุชู ุทูุจ 9 ุจุงูุช ุ ุชู ุชุฎุตูุต 16. ุนูุฏุฉ ุงูุขู ุฅูู <code>bytes.Buffer</code> </p><br><pre style=";text-align:right;direction:rtl"> <code class="go hljs">fmt.Println(unsafe.Sizeof(bytes.Buffer{})) =&gt; <span class="hljs-number"><span class="hljs-number">104</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ุฏุนููุง ูููู ูุธุฑุฉ ุนูู <a href="">$ GOROOT / src / runtime / sizeclasses.go</a> : </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs ruby">/<span class="hljs-regexp"><span class="hljs-regexp">/ class bytes/obj</span></span> bytes/span objects tail waste max waste /<span class="hljs-regexp"><span class="hljs-regexp">/ 1 8 8192 1024 0 87.50% /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/ 2 16 8192 512 0 43.75% /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/ 3 32 8192 256 0 46.88% /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/ 4 48 8192 170 32 31.52% /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/ 5 64 8192 128 0 23.44% /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/ 6 80 8192 102 32 19.07% /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/ 7 96 8192 85 32 15.95% /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/ 8 112 8192 73 16 13.56% /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/ ... </span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุง ูุชูุงุณุจ ูุน 96 ุจุงูุช ุ ุชู ุชุญุฏูุฏ 112. </p><br><hr></div></div><br><p style=";text-align:right;direction:rtl">  ูููู ููุงุฐุง ูุญุฏุซ ูุฐุงุ </p><br><h1 id="chto-proishodit-i-pochemu" style=";text-align:right;direction:rtl">  ูุงุฐุง ูุญุฏุซ ูููุงุฐุง </h1><br><p style=";text-align:right;direction:rtl">  ูููู ุงูุนุซูุฑ ุนูู ุจุนุถ ุชุญููู ุงููุถุน ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงููุถูุฉ</a> ุงููุฐููุฑุฉ ูู ุงูุจุฏุงูุฉ. <br>  ููุงู ุฃูุถุง <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุงุณุฎ ุจุณูุท</a> . </p><br><p style=";text-align:right;direction:rtl">  ููุงู ุงููุดููุฉ ููุท ูู ุงููููุฉ <code>b.buf = b.bootstrap[:]</code> .  ูุฌุนู ูุฐุง ุงูููุฏ ุชุญููู ุงููุฑูุจ ููุชุฑุถ ุฃู <code>b.bootstrap</code> "ููุฑุจ" ุ ูุจูุง ุฃูู ุตููู ุ ูุฅูู ูุชู ุชุฎุฒููู ุฏุงุฎู ุงููุงุฆู ููุณู ุ ููุง ูุนูู ุฃูู ูุฌุจ ุชุฎุตูุต ูู <code>b</code> ูู ุงููููุฉ. </p><br><p style=";text-align:right;direction:rtl">  ุฅุฐุง ูุงู bootstrap ุนุจุงุฑุฉ ุนู ุดุฑูุญุฉ ุ ูููุณ ุตููููุง ุ ููู ูุญุฏุซ ูุฐุง ุ ูุฃู ููุงู ุชุญุณูููุง ูุฎุตุตูุง ูุชุฎุตูุต ุดุฑุงุฆุญ ูู ุงููุงุฆู ุฅูู ุงููุงุฆู ููุณู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="go hljs"><span class="hljs-comment"><span class="hljs-comment">//   ,     , // object      . object.buf1 = object.buf2[a:b]</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ุชู ุจุงููุนู ุงูุฅุฌุงุจุฉ ุนู ุณุจุจ ุนุฏู ุนูู ูุฐุง ุงูุชุญุณูู ููุตูุงุฆู ุฃุนูุงู ุ ูููู ููุง ุถุบุท ูู <a href="">esc.go # L835-L866 ููุณู</a> (ูุชู ุชูููุฒ ุฑูุฒ ุงูุชุญุณูู ุจุงููุงูู ุญุณุจ ุงููุฑุฌุน): </p><br><pre style=";text-align:right;direction:rtl"> <code class="go hljs"><span class="hljs-comment"><span class="hljs-comment">// Note, this optimization does not apply to OSLICEARR, // because it does introduce a new pointer into b that was not already there // (pointer to b itself). After such assignment, if b contents escape, // b escapes as well. If we ignore such OSLICEARR, we will conclude // that b does not escape when b contents do.</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ุชุฌุฏุฑ ุงูุฅุดุงุฑุฉ ููุง ุฅูู ุฃูู ุจุงููุณุจุฉ ููุญูู ุงููุคุดุฑ ููุงู ุนุฏุฉ ูุณุชููุงุช ูู "ุงูุชุณุฑูุจุงุช" ุ ุฃูููุง: </p><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุงููุงุฆู ููุณู ููุฑุจ (ููุฑุจ b).  ูู ูุฐู ุงูุญุงูุฉ ุ ูุญุชุงุฌ ุงููุงุฆู ููุณู ุฅูู ุชุฎุตูุต ูู ูููุฉ ุงูุฐุงูุฑุฉ ุงููุคูุชุฉ. </li><li style=";text-align:right;direction:rtl">  ุนูุงุตุฑ ุงููุงุฆู (ูุฑูุจ ูุญุชููุงุช ุจ) ุชูุฑุจ.  ูู ูุฐู ุงูุญุงูุฉ ุ ุชุนุชุจุฑ ุงููุคุดุฑุงุช ุงูููุฌูุฏุฉ ูู ุงููุงุฆู ูุฑูุจูุง. </li></ol><br><p style=";text-align:right;direction:rtl">  ุญุงูุฉ ุงููุตูููุฉ ุฎุงุตุฉ ูู ุฃูู ุฅุฐุง ุชุณุฑุจ ุงููุตูููุฉ ุ ูุฌุจ ุฃู ูุชุณุฑุจ ุงููุงุฆู ุงูุฐู ูุญุชูู ุนููู ุฃูุถูุง. </p><br><p style=";text-align:right;direction:rtl">  ูุนุฑุถ ุชุญููู ุงููุฑูุจ ูุฑุงุฑูุง ุจุดุฃู ูุง ุฅุฐุง ูุงู ูู ุงููููู ูุถุน ูุงุฆู ุนูู ุงูููุฏุณ ุฃู ูุง ุ ุจุงูุงุนุชูุงุฏ ููุท ุนูู ุงููุนูููุงุช ุงููุชููุฑุฉ ูู ูุต ุงููุธููุฉ ุงูุชู ุชู ุชุญููููุง.  ุชุฃุฎุฐ ุทุฑููุฉ <code>Buffer.grow</code> <code>b</code> ุญุณุจ ุงููุคุดุฑ ุ ูุฐูู ุชุญุชุงุฌ ุฅูู ุญุณุงุจ ููุงู ููุงุณุจ ููุถุนู.  ูุธุฑูุง ูุฃูู ูู ุญุงูุฉ ูุฌูุฏ ูุตูููุฉ ุ ูุง ูููููุง ุงูุชูููุฒ ุจูู <code>"b escape"</code> <code>"b contents escape"</code> ุ ูุฌุจ ุฃู ูููู ุฃูุซุฑ ุชุดุงุคููุง ููุชูุตู ุฅูู ุงุณุชูุชุงุฌ ููุงุฏู ุฃู <code>b</code> ุขูู ููุถุนู ุนูู ุงูููุฏุณ. </p><br><p style=";text-align:right;direction:rtl">  ุงูุชุฑุถ ุงูุนูุณ ุ ุฃู ููุท <code>self-assignment</code> ูุญู ููุณู ุจุงููุณุจุฉ ูููุตูููุงุช ููุง ููุนู ูู ุงูุดุฑุงุฆุญ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> example <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> sink <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span>{} <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> bad <span class="hljs-keyword"><span class="hljs-keyword">struct</span></span> { array [<span class="hljs-number"><span class="hljs-number">10</span></span>]<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> slice []<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(b *bad)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bug</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { b.slice = b.array[:] <span class="hljs-comment"><span class="hljs-comment">// ignoring self-assignment to b.slice sink = b.array // b.array escapes to heap // b does not escape }</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ุณูุคุฏู ูุฑุงุฑ ูุถุน <code>b</code> ุนูู ุงูููุฏุณ ูู ูุฐู ุงูุญุงูุฉ ุฅูู ูุงุฑุซุฉ: ุจุนุฏ ุงูุฎุฑูุฌ ูู ุงููุธููุฉ ุงูุชู ุชู ุฅูุดุงุคูุง <code>b</code> ุ ูู ุชููู ุงูุฐุงูุฑุฉ ุงูุชู ุณูุดูุฑ ุฅูููุง <code>sink</code> ุฃูุซุฑ ูู ุงูููุงูุฉ. </p><br><h1 id="ukazateli-na-massivy" style=";text-align:right;direction:rtl">  ูุคุดุฑุงุช ุงูุตููู </h1><br><p style=";text-align:right;direction:rtl">  ุชุฎูู ุฃูู ุชู ุงูุฅุนูุงู ุนู <code>Buffer</code> ูุฏููุง ุจุดูู ูุฎุชูู ููููุงู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="diff hljs">const smallBufSize int = 64 type Buffer struct { - bootstrap [smallBufSize]byte + bootstrap *[smallBufSize]byte buf []byte }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุนูู ุนูุณ ุงููุตูููุฉ ุงูุนุงุฏูุฉ ุ ูู ูุฎุฒู ูุคุดุฑ ุงููุตูููุฉ ุฌููุน ุงูุนูุงุตุฑ ุฏุงุฎู <code>Buffer</code> ููุณู.  ููุฐุง ูุนูู ุฃูู ุฅุฐุง ูู ูุชุถูู ุชุฎุตูุต <code>bootstrap</code> ุนูู ุงููููุฉ ุชุฎุตูุต <code>Buffer</code> ุนูู ูููุฉ ุงูุฐุงูุฑุฉ ุงููุคูุชุฉ.  ูุธุฑูุง ูุฃู ุชุญููู ุงููุฑูุจ ูููู ุฃู ูุฎุตุต ุญููู ุงููุคุดุฑ ุนูู ุงูููุฏุณ ุนูุฏูุง ูููู ุฐูู ูููููุง ุ ูููููุง ุฃู ููุชุฑุถ ุฃู ุชุนุฑูู <code>Buffer</code> ูุฐุง ุฃูุซุฑ ูุฌุงุญูุง. </p><br><p style=";text-align:right;direction:rtl">  ููู ูุฐุง ูุธุฑูุง.  ูู ุงููุงุญูุฉ ุงูุนูููุฉ ุ ูุง ูุญุชูู ูุคุดุฑ ุงูุตููู ุนูู ุงููุซูุฑ ูู ุงููุนุงูุฌุฉ ูููุน ูู ููุณ ูุฆุฉ ุงูุดุฑูุญุฉ ูู ุตููู ุนุงุฏู ุ ููู ุบูุฑ ุตุญูุญ ุชูุงููุง.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">CL133375: cmd / compile / internal / gc: ูุนุงูุฌุฉ ุงูุชุฎุตูุต ุงูุฐุงุชู ูุดุฑูุญุฉ ุงูุตููู ูู esc.go</a> ุชูุฏู ุฅูู ุชุตุญูุญ ูุฐุง ุงููููู. </p><br><p style=";text-align:right;direction:rtl">  ุงูุชุฑุถ ุฃู ูุฐุง ุงูุชุบููุฑ ูุฏ ุชู ูุจููู ูู ูุชุฑุฌู Go. </p><br><h1 id="zero-value-kotoryy-my-poteryali" style=";text-align:right;direction:rtl">  ููุฏูุง ุงููููุฉ ุตูุฑ </h1><br><p style=";text-align:right;direction:rtl">  ูุณูุก ุงูุญุธ ุ ูุฅู ุงูุงูุชูุงู ูู <code>[64]byte</code> ุฅูู <code>*[64]byte</code> ูุนุงูู ูู ูุดููุฉ: ุงูุขู ูุง ูููููุง ุงุณุชุฎุฏุงู <code>bootstrap</code> ุจุฏูู ุชููุฆุชู ุจุดูู ุตุฑูุญ ุ ุชุชููู ุงููููุฉ ุงูุตูุฑูุฉ ูู <code>Buffer</code> ุนู ููููุง ูููุฏุฉ ุ ูุญู ุจุญุงุฌุฉ ุฅูู ูููุดุฆ. </p><br><pre style=";text-align:right;direction:rtl"> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">NewBuffer</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Buffer</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Buffer{bootstrap: <span class="hljs-built_in"><span class="hljs-built_in">new</span></span>(*[smallBufSize]<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>)} }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุนูุฏ <code>Buffer</code> ุ ูููุณ <code>*Buffer</code> ุ ูุชุฌูุจ ุงููุดุงูู ูู ุชุญููู ุงููุคุดุฑุงุช (ููู ูุญุงูุธุฉ ููุบุงูุฉ ูู Go) ุ ููุน ุงูุฃุฎุฐ ูู ุงูุงุนุชุจุงุฑ ุญูููุฉ ุฃู <code>NewBuffer</code> ูุฏูุฌ ุฏุงุฆููุง ูู ููุงู ุงูููุงููุฉ ุ ููู ูููู ููุงู ูุณุฎ ุบูุฑ ุถุฑูุฑู. </p><br><p style=";text-align:right;direction:rtl">  ุจุนุฏ ุชุถููู ูุต <code>NewBuffer</code> ูู ููุงู ุงูููุงููุฉ ุ ูููู ุฃู ูุญุงูู ุชุญููู ุงููุฑูุจ ุฅุซุจุงุช ุฃู <code>new(*[smallBufSize]byte)</code> ูุง ูุชุฌุงูุฒ ุนูุฑ ุฅุทุงุฑ ุงููุธููุฉ ุงูุชู ูุชู ุงุณุชุฏุนุงุคูุง.  ุฅุฐุง ูุงู ุงูุฃูุฑ ูุฐูู ุ ูุณูุชู ุงูุชุฎุตูุต ุนูู ุงูููุฏุณ. </p><br><h1 id="intel-bytebuf" style=";text-align:right;direction:rtl">  ุฅูุชู bytebuf </h1><br><p style=";text-align:right;direction:rtl">  ูุชู ุชุทุจูู ุงูุชุญุณูู ุงูููุถุญ ุฃุนูุงู ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุญุฒูุฉ intel-go / bytebuf</a> . </p><br><p style=";text-align:right;direction:rtl">  ุชุตุฏุฑ ูุฐู ุงูููุชุจุฉ ููุน <code>bytebuf.Buffer</code> ุ ุงูุฐู ููุฑุฑ 99.9ูช <code>bytes.Buffer</code> .  ูุชู ุชูููู ุฌููุน ุงูุชุบููุฑุงุช ุฅูู ููุฏูุฉ ูููุดุฆ ( <code>bytebuf.New</code> ) ููุคุดุฑ ุฅูู ุตููู ุจุฏูุงู ูู ุตููู ุนุงุฏู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="diff hljs">type Buffer struct { buf []byte // contents are the bytes buf[off : len(buf)] off int // read at &amp;buf[off], write at &amp;buf[len(buf)] - bootstrap [64]byte // helps small buffers avoid allocation. + bootstrap *[64]byte // helps small buffers avoid allocation. lastRead readOp // last read operation (for Unread*). }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูููุง ููู ููุงุฑูุฉ ููุฃุฏุงุก <code>bytes.Buffer</code> </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs powershell">name old time/op new time/op delta String/empty<span class="hljs-literal"><span class="hljs-literal">-8</span></span> <span class="hljs-number"><span class="hljs-number">138</span></span>ns ยฑ<span class="hljs-number"><span class="hljs-number">13</span></span>% <span class="hljs-number"><span class="hljs-number">24</span></span>ns ยฑ <span class="hljs-number"><span class="hljs-number">0</span></span>% <span class="hljs-literal"><span class="hljs-literal">-82</span></span>.<span class="hljs-number"><span class="hljs-number">94</span></span>% (p=<span class="hljs-number"><span class="hljs-number">0.000</span></span> n=<span class="hljs-number"><span class="hljs-number">10</span></span>+<span class="hljs-number"><span class="hljs-number">8</span></span>) String/<span class="hljs-number"><span class="hljs-number">5</span></span><span class="hljs-literal"><span class="hljs-literal">-8</span></span> <span class="hljs-number"><span class="hljs-number">186</span></span>ns ยฑ<span class="hljs-number"><span class="hljs-number">11</span></span>% <span class="hljs-number"><span class="hljs-number">60</span></span>ns ยฑ <span class="hljs-number"><span class="hljs-number">1</span></span>% <span class="hljs-literal"><span class="hljs-literal">-67</span></span>.<span class="hljs-number"><span class="hljs-number">82</span></span>% (p=<span class="hljs-number"><span class="hljs-number">0.000</span></span> n=<span class="hljs-number"><span class="hljs-number">10</span></span>+<span class="hljs-number"><span class="hljs-number">10</span></span>) String/<span class="hljs-number"><span class="hljs-number">64</span></span><span class="hljs-literal"><span class="hljs-literal">-8</span></span> <span class="hljs-number"><span class="hljs-number">225</span></span>ns ยฑ<span class="hljs-number"><span class="hljs-number">10</span></span>% <span class="hljs-number"><span class="hljs-number">108</span></span>ns ยฑ <span class="hljs-number"><span class="hljs-number">6</span></span>% <span class="hljs-literal"><span class="hljs-literal">-52</span></span>.<span class="hljs-number"><span class="hljs-number">26</span></span>% (p=<span class="hljs-number"><span class="hljs-number">0.000</span></span> n=<span class="hljs-number"><span class="hljs-number">10</span></span>+<span class="hljs-number"><span class="hljs-number">10</span></span>) String/<span class="hljs-number"><span class="hljs-number">128</span></span><span class="hljs-literal"><span class="hljs-literal">-8</span></span> <span class="hljs-number"><span class="hljs-number">474</span></span>ns ยฑ<span class="hljs-number"><span class="hljs-number">17</span></span>% <span class="hljs-number"><span class="hljs-number">338</span></span>ns ยฑ<span class="hljs-number"><span class="hljs-number">13</span></span>% <span class="hljs-literal"><span class="hljs-literal">-28</span></span>.<span class="hljs-number"><span class="hljs-number">57</span></span>% (p=<span class="hljs-number"><span class="hljs-number">0.000</span></span> n=<span class="hljs-number"><span class="hljs-number">10</span></span>+<span class="hljs-number"><span class="hljs-number">10</span></span>) String/<span class="hljs-number"><span class="hljs-number">1024</span></span><span class="hljs-literal"><span class="hljs-literal">-8</span></span> <span class="hljs-number"><span class="hljs-number">889</span></span>ns ยฑ <span class="hljs-number"><span class="hljs-number">0</span></span>% <span class="hljs-number"><span class="hljs-number">740</span></span>ns ยฑ <span class="hljs-number"><span class="hljs-number">1</span></span>% <span class="hljs-literal"><span class="hljs-literal">-16</span></span>.<span class="hljs-number"><span class="hljs-number">78</span></span>% (p=<span class="hljs-number"><span class="hljs-number">0.000</span></span> n=<span class="hljs-number"><span class="hljs-number">9</span></span>+<span class="hljs-number"><span class="hljs-number">10</span></span>) name old alloc/op new alloc/op delta String/empty<span class="hljs-literal"><span class="hljs-literal">-8</span></span> <span class="hljs-number"><span class="hljs-number">112</span></span>B ยฑ <span class="hljs-number"><span class="hljs-number">0</span></span>% <span class="hljs-number"><span class="hljs-number">0</span></span>B <span class="hljs-literal"><span class="hljs-literal">-100</span></span>.<span class="hljs-number"><span class="hljs-number">00</span></span>% (p=<span class="hljs-number"><span class="hljs-number">0.000</span></span> n=<span class="hljs-number"><span class="hljs-number">10</span></span>+<span class="hljs-number"><span class="hljs-number">10</span></span>) String/<span class="hljs-number"><span class="hljs-number">5</span></span><span class="hljs-literal"><span class="hljs-literal">-8</span></span> <span class="hljs-number"><span class="hljs-number">117</span></span>B ยฑ <span class="hljs-number"><span class="hljs-number">0</span></span>% <span class="hljs-number"><span class="hljs-number">5</span></span>B ยฑ <span class="hljs-number"><span class="hljs-number">0</span></span>% <span class="hljs-literal"><span class="hljs-literal">-95</span></span>.<span class="hljs-number"><span class="hljs-number">73</span></span>% (p=<span class="hljs-number"><span class="hljs-number">0.000</span></span> n=<span class="hljs-number"><span class="hljs-number">10</span></span>+<span class="hljs-number"><span class="hljs-number">10</span></span>) String/<span class="hljs-number"><span class="hljs-number">64</span></span><span class="hljs-literal"><span class="hljs-literal">-8</span></span> <span class="hljs-number"><span class="hljs-number">176</span></span>B ยฑ <span class="hljs-number"><span class="hljs-number">0</span></span>% <span class="hljs-number"><span class="hljs-number">64</span></span>B ยฑ <span class="hljs-number"><span class="hljs-number">0</span></span>% <span class="hljs-literal"><span class="hljs-literal">-63</span></span>.<span class="hljs-number"><span class="hljs-number">64</span></span>% (p=<span class="hljs-number"><span class="hljs-number">0.000</span></span> n=<span class="hljs-number"><span class="hljs-number">10</span></span>+<span class="hljs-number"><span class="hljs-number">10</span></span>) String/<span class="hljs-number"><span class="hljs-number">128</span></span><span class="hljs-literal"><span class="hljs-literal">-8</span></span> <span class="hljs-number"><span class="hljs-number">368</span></span>B ยฑ <span class="hljs-number"><span class="hljs-number">0</span></span>% <span class="hljs-number"><span class="hljs-number">256</span></span>B ยฑ <span class="hljs-number"><span class="hljs-number">0</span></span>% <span class="hljs-literal"><span class="hljs-literal">-30</span></span>.<span class="hljs-number"><span class="hljs-number">43</span></span>% (p=<span class="hljs-number"><span class="hljs-number">0.000</span></span> n=<span class="hljs-number"><span class="hljs-number">10</span></span>+<span class="hljs-number"><span class="hljs-number">10</span></span>) String/<span class="hljs-number"><span class="hljs-number">1024</span></span><span class="hljs-literal"><span class="hljs-literal">-8</span></span> <span class="hljs-number"><span class="hljs-number">2.16</span></span>kB ยฑ <span class="hljs-number"><span class="hljs-number">0</span></span>% <span class="hljs-number"><span class="hljs-number">2.05</span></span>kB ยฑ <span class="hljs-number"><span class="hljs-number">0</span></span>% <span class="hljs-literal"><span class="hljs-literal">-5</span></span>.<span class="hljs-number"><span class="hljs-number">19</span></span>% (p=<span class="hljs-number"><span class="hljs-number">0.000</span></span> n=<span class="hljs-number"><span class="hljs-number">10</span></span>+<span class="hljs-number"><span class="hljs-number">10</span></span>) name old allocs/op new allocs/op delta String/empty<span class="hljs-literal"><span class="hljs-literal">-8</span></span> <span class="hljs-number"><span class="hljs-number">1.00</span></span> ยฑ <span class="hljs-number"><span class="hljs-number">0</span></span>% <span class="hljs-number"><span class="hljs-number">0.00</span></span> <span class="hljs-literal"><span class="hljs-literal">-100</span></span>.<span class="hljs-number"><span class="hljs-number">00</span></span>% (p=<span class="hljs-number"><span class="hljs-number">0.000</span></span> n=<span class="hljs-number"><span class="hljs-number">10</span></span>+<span class="hljs-number"><span class="hljs-number">10</span></span>) String/<span class="hljs-number"><span class="hljs-number">5</span></span><span class="hljs-literal"><span class="hljs-literal">-8</span></span> <span class="hljs-number"><span class="hljs-number">2.00</span></span> ยฑ <span class="hljs-number"><span class="hljs-number">0</span></span>% <span class="hljs-number"><span class="hljs-number">1.00</span></span> ยฑ <span class="hljs-number"><span class="hljs-number">0</span></span>% <span class="hljs-literal"><span class="hljs-literal">-50</span></span>.<span class="hljs-number"><span class="hljs-number">00</span></span>% (p=<span class="hljs-number"><span class="hljs-number">0.000</span></span> n=<span class="hljs-number"><span class="hljs-number">10</span></span>+<span class="hljs-number"><span class="hljs-number">10</span></span>) String/<span class="hljs-number"><span class="hljs-number">64</span></span><span class="hljs-literal"><span class="hljs-literal">-8</span></span> <span class="hljs-number"><span class="hljs-number">2.00</span></span> ยฑ <span class="hljs-number"><span class="hljs-number">0</span></span>% <span class="hljs-number"><span class="hljs-number">1.00</span></span> ยฑ <span class="hljs-number"><span class="hljs-number">0</span></span>% <span class="hljs-literal"><span class="hljs-literal">-50</span></span>.<span class="hljs-number"><span class="hljs-number">00</span></span>% (p=<span class="hljs-number"><span class="hljs-number">0.000</span></span> n=<span class="hljs-number"><span class="hljs-number">10</span></span>+<span class="hljs-number"><span class="hljs-number">10</span></span>) String/<span class="hljs-number"><span class="hljs-number">128</span></span><span class="hljs-literal"><span class="hljs-literal">-8</span></span> <span class="hljs-number"><span class="hljs-number">3.00</span></span> ยฑ <span class="hljs-number"><span class="hljs-number">0</span></span>% <span class="hljs-number"><span class="hljs-number">2.00</span></span> ยฑ <span class="hljs-number"><span class="hljs-number">0</span></span>% <span class="hljs-literal"><span class="hljs-literal">-33</span></span>.<span class="hljs-number"><span class="hljs-number">33</span></span>% (p=<span class="hljs-number"><span class="hljs-number">0.000</span></span> n=<span class="hljs-number"><span class="hljs-number">10</span></span>+<span class="hljs-number"><span class="hljs-number">10</span></span>) String/<span class="hljs-number"><span class="hljs-number">1024</span></span><span class="hljs-literal"><span class="hljs-literal">-8</span></span> <span class="hljs-number"><span class="hljs-number">3.00</span></span> ยฑ <span class="hljs-number"><span class="hljs-number">0</span></span>% <span class="hljs-number"><span class="hljs-number">2.00</span></span> ยฑ <span class="hljs-number"><span class="hljs-number">0</span></span>% <span class="hljs-literal"><span class="hljs-literal">-33</span></span>.<span class="hljs-number"><span class="hljs-number">33</span></span>% (p=<span class="hljs-number"><span class="hljs-number">0.000</span></span> n=<span class="hljs-number"><span class="hljs-number">10</span></span>+<span class="hljs-number"><span class="hljs-number">10</span></span>)</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุชุชููุฑ ุฌููุน ุงููุนูููุงุช ุงูุฃุฎุฑู ูู <a href="">README</a> . </p><br><p style=";text-align:right;direction:rtl">  ูุธุฑูุง ูุนุฏู ุงููุฏุฑุฉ ุนูู ุงุณุชุฎุฏุงู ุงููููุฉ ุงูุตูุฑูุฉ <code>bytes.Buffer</code> ุจูุธููุฉ ุงูุฅูุดุงุก <code>New</code> ุ ูุง ูููู ุชุทุจูู ูุฐุง ุงูุชุญุณูู ุนูู <code>bytes.Buffer</code> . </p><br><p style=";text-align:right;direction:rtl">  ูู ูุฐู ูู ุงูุทุฑููุฉ ุงููุญูุฏุฉ ูุฌุนู ุฃุณุฑุน <code>bytes.Buffer</code> .  ุงูุฌูุงุจ ูุง.  ููู ูุฐู ุจุงูุชุฃููุฏ ุทุฑููุฉ ุชุชุทูุจ ุชุบููุฑุงุช ุทูููุฉ ูู ุงูุชูููุฐ. </p><br><h1 id="plany-na-escape-analysis" style=";text-align:right;direction:rtl">  ุฎุทุท ุชุญููู ุงููุฑูุจ </h1><br><p style=";text-align:right;direction:rtl">  ุชุญููู ุงููุฑูุจ ูู ุดููู ุงูุญุงูู ุถุนูู ุฌุฏูุง.  ุชุคุฏู ุฃู ุนูููุฉ ุชูุฑูุจูุง ุจููู ุงููุคุดุฑ ุฅูู ุชุฎุตูุตุงุช ูู ูููุฉ ุงูุฐุงูุฑุฉ ุงููุคูุชุฉ ุ ุญุชู ูู ูู ููู ูุฐุง ูุฑุงุฑูุง ูุนูููุงู. </p><br><p style=";text-align:right;direction:rtl">  ุณุฃุญุงูู ุชูุฌูู ูุนุธู ุงูููุช ุงูุฐู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฃุฎุตุตู</a> ููุดุฑูุน <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">golang / go</a> ูุญู ูุฐู ุงููุดุงูู ุ ูุฐุง ูุฅู ุจุนุถ ุงูุชุญุณููุงุช ููููุฉ ูู ุงูุฅุตุฏุงุฑ ุงููุงุฏู (1.12). </p><br><p style=";text-align:right;direction:rtl">  ููููู ุฃู ุชูุฑุฃ ุนู ูุชุงุฆุฌ ูุชูุงุตูู ุงูุชุฑููุจ ุงูุฏุงุฎูู ููุฐุง ุงูุฌุฒุก ูู ุงููุชุฑุฌู ูู ุฅุญุฏู ููุงูุงุชู ุงููุงุฏูุฉ.  ุณุฃุญุงูู ุชูุฏูู ูุฌููุนุฉ ูู ุงูุชูุตูุงุช ุงูุชู ุณุชุณุงุนุฏ ูู ุจุนุถ ุงูุญุงูุงุช ุนูู ุชูุธูู ุงูุดูุฑุฉ ุจุญูุซ ุชุญุชูู ุนูู ุชุฎุตูุตุงุช ุฐุงูุฑุฉ ุบูุฑ ูุฑุบูุจ ูููุง ุฃูู. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar422447/">https://habr.com/ru/post/ar422447/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar422437/index.html">ุชุฌุฑุจุฉ ูุณุชุฎุฏู ุงูุฃูุนุงุจ ููููุน ุงูููุจ ูุณุฑุนุฉ ุงูุชุทุจูู</a></li>
<li><a href="../ar422439/index.html">ุงููุนุฑูุฉ ูุน Yandex: ููู ูุถูุช ุฃูุซุฑ ูู ุนุงู ูู ุฌูุจ ุงููููุน ุฅูู ุงูููุฉ</a></li>
<li><a href="../ar422441/index.html">ุชู ุงูุนุซูุฑ ุนูู ุตูุบุฉ ููุงูุชูุงู ุบูุฑ ุงููุคูู ุฅูู .Net Core</a></li>
<li><a href="../ar422443/index.html">ุชูููุช ููุฑููุง SDK ุฏูููุฉ</a></li>
<li><a href="../ar422445/index.html">ุชูููุฐ BottomAppBar. ุงูุฌุฒุก 3: ุณููู Android</a></li>
<li><a href="../ar422449/index.html">ุฃุนุถุงุก ูุฌูุณ ุงูุดููุฎ ููุงุจู ุฃูุงุฒูู: ูุง ูุนูู ูุชุฌุฑ ุนูู ุงูุฅูุชุฑูุช</a></li>
<li><a href="../ar422451/index.html">ุงุณุชูุน ุนู ุชุณููู ุงูุฃูุนุงุจ ูุนู ููุงู ูุงุชุจ ุงูุณููุงุฑูู ูู ุตูุงุนุฉ ุงูุฃูุนุงุจ.</a></li>
<li><a href="../ar422453/index.html">SmartData 2018: ุชู ุฅูุบุงุก ุฃูู ูุคุชูุฑ ููุฌููุนุฉ JUG.ru</a></li>
<li><a href="../ar422455/index.html">ุฌุงูุนุงุช EPAM +: ููู ูุนูู ูุน ุงูุฌุงูุนุงุช ุงูุฃููุฑุงููุฉ</a></li>
<li><a href="../ar422457/index.html">"ููุณ ูู ุงูููุทูู ุจุงููุณุจุฉ ููุง ุงุณุชุฎุฏุงู ุงูุชุญุฏูุซ ุงูุชุญุฏูุซู": ุญูู ุชุทููุฑ Android ูู Sberbank Online</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>