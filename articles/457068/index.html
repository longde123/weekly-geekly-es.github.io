<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🕗 🎅🏾 🍦 Colas: ¿qué es, por qué y cómo usarlo? Eche un vistazo a las características de AWS SQS 👇 👦🏼 🧙🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Primero, definamos el concepto de "cola". 
 Tome en consideración el tipo de cola "FIFO" (primero en entrar , primero en salir). Si toma el valor de W...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Colas: ¿qué es, por qué y cómo usarlo? Eche un vistazo a las características de AWS SQS</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/457068/"><img src="https://habrastorage.org/webt/zw/yz/pq/zwyzpqk1p65bfsq6xzvqab7rt60.png"><br><h3>  <b>Primero, definamos el concepto de "cola".</b> </h3><br>  Tome en consideración el tipo de cola <b>"FIFO"</b> (primero en <b>entrar</b> , primero en salir).  Si toma el valor de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Wikipedia</a> , "este es un tipo de datos abstractos con la disciplina del acceso a los elementos".  En resumen, esto significa que no podemos obtener datos de él en un orden aleatorio, sino solo recoger lo que vino primero. <br><br><h3>  A continuación, ¿debe decidir por qué son necesarios? </h3><br>  <b>1. Para operaciones diferidas.</b>  Un ejemplo clásico es el procesamiento de imágenes.  Por ejemplo, un usuario cargó una imagen en el sitio que necesitamos procesar, esta operación lleva mucho tiempo, el usuario no quiere esperar tanto.  Por lo tanto, cargamos la imagen y luego la transferimos a la cola.  Y se procesará cuando cualquier "trabajador" lo obtenga. <br><br>  <b>2. Para el manejo de cargas máximas.</b>  Por ejemplo, hay una parte del sistema que a veces causa mucho tráfico y no requiere una respuesta instantánea.  Como opción, generar cualquier informe.  Lanzando esta tarea en la cola, le damos la oportunidad de manejarla con una carga uniforme en el sistema. <br><br>  <b>3. Escalabilidad.</b>  Y probablemente la razón más importante, la cola lo hace posible <br>  escalar  Esto significa que puede mostrar varios servicios para el procesamiento en paralelo, lo que aumentará considerablemente la productividad. <br><a name="habracut"></a><br><h3>  Ahora veamos los problemas que enfrentaremos si creamos la cola nosotros mismos: </h3><br>  <b>1. Acceso en paralelo.</b>  Solo un controlador puede tomar un mensaje de una cola.  Es decir, si al mismo tiempo dos servicios solicitan mensajes, cada uno de ellos debe devolver un conjunto único de mensajes.  De lo contrario, resulta que un mensaje se procesa dos veces.  Lo que podría estar cargado. <br><br>  <b>2. El mecanismo de deduplicación.</b>  El servicio debe tener un sistema que proteja la cola de los duplicados.  Puede haber una situación en la que uno y el mismo conjunto de datos se enviarán a la cola por casualidad dos veces.  Como resultado, procesaremos lo mismo dos veces.  Lo que de nuevo está cargado. <br><br>  <b>3. Mecanismo de manejo de errores.</b>  Digamos que nuestro servicio tomó tres mensajes de la cola.  Dos de los cuales procesó con éxito enviando solicitudes de eliminación de la cola.  Y el tercero no pudo procesarlo y murió.  Un mensaje que está en estado de procesamiento no está disponible para otros servicios.  Y no debe permanecer para siempre en estado de procesamiento.  Tal mensaje debe pasar a otro controlador por alguna lógica.  Pronto se considerará un ejemplo de la implementación de esta lógica utilizando AWS SQS (Simple Queue Service) como ejemplo. <br><br><h3>  Servicios web de Amazon: servicio de cola simple </h3><br><h4>  Ahora veamos cómo SQS resuelve estos problemas y qué puede hacer. </h4><br>  <b>1. Acceso en paralelo.</b>  En la cola, puede establecer el parámetro <b>Visibilidad de tiempo de espera</b> .  Determina cuánto tiempo puede tomar el procesamiento de un mensaje el mayor tiempo posible.  Por defecto, son <b>30 segundos.</b>  Cuando un servicio recoge un mensaje, se transfiere al estado <b>"En vuelo"</b> durante 30 segundos.  Si durante este tiempo no hubo un comando para eliminar este mensaje de la cola, vuelve al principio y el siguiente servicio puede recibirlo nuevamente para su procesamiento. <br><br>  <b>Pequeño trabajo shemka.</b> <br><br><img src="https://habrastorage.org/webt/zx/wj/pd/zxwjpdw6hdsdw8qoinabmifuyzo.png"><br><blockquote>  <b>Aviso:</b> ten cuidado.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">SQS en algunos casos puede enviar un mensaje duplicado (Elemento "Entrega al menos una vez").</a>  Por lo tanto, su servicio debe ser <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">idempotente</a> para el procesamiento. </blockquote><br>  <b>2. Mecanismo de manejo de errores.</b>  En SQS, puede configurar el segundo turno para mensajes "muertos" (Dead Letter Queue).  Es decir, aquellos que no pudieron procesar nuestro servicio se enviarán a una cola separada, que puede eliminar a su discreción.  También puede establecer después de qué número de intentos fallidos el mensaje irá a la cola "inactiva".  Un intento fallido es la expiración del "Tiempo de espera de visibilidad".  Es decir, si no se ha enviado una solicitud de eliminación durante este tiempo, dicho mensaje se considerará no procesado y volverá a la cola principal o irá a "inactivo". <br><br>  <b>3. Deduplicación de mensajes.</b>  SQS también tiene un sistema de protección duplicado.  Cada mensaje tiene un <b>"Id de deduplicación"</b> , SQS no pondrá en cola un mensaje con <br>  repitió el "Id de deduplicación" durante 5 minutos.  Debe especificar un "Id. De deduplicación" en cada mensaje o habilitar la generación de id basada en contenido.  Esto significa que un hash generado en función de su contenido entrará en el "Id. De deduplicación".  El parámetro <b>"Deduplicación basada en contenido".</b>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Más acerca de la deduplicación</a> <br><blockquote>  <b>Aviso:</b> Tenga cuidado si envía dos mensajes idénticos en 5 minutos y tiene activada la <b>"Desduplicación basada en contenido".</b> SQS no agregará un segundo mensaje a la cola. <br></blockquote><blockquote>  <b>Aviso:</b> Tenga cuidado, por ejemplo, si no hay conexión en el dispositivo y no recibe una respuesta y luego envía una segunda solicitud después de 5 minutos, se creará un duplicado. <br></blockquote>  <b>4. Encuesta larga.</b>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Encuesta larga</a>  SQS admite este tipo de conexión con un tiempo de espera máximo de 20 segundos.  Lo que nos permite ahorrar en tráfico y "sacudidas" del servicio. <br><br>  <b>5. Métricas.</b>  Amazon también proporciona métricas de cola detalladas.  Como la cantidad de mensajes recibidos / enviados / eliminados, el tamaño en KB de estos mensajes, etc.  También puede conectar SQS al servicio de registro de CloudWatch.  Allí puedes ver aún más.  También allí puede configurar las llamadas <b>"alarmas"</b> y puede configurar acciones para cualquier evento.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Obtenga más información sobre cómo conectarse a SQS.</a>  Y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">documentación de CloudWatch</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><br></a> <br><h3>  Ahora veamos la configuración de la cola: </h3><br><h4>  Los principales: </h4><br>  <b>Tiempo de espera de visibilidad predeterminado: la</b> cantidad de segundos / minutos / horas durante los cuales el mensaje después de recibir no estará visible para recibir.  El tiempo máximo de procesamiento es de 12 horas. <br><br>  <b>Período de retención de mensajes: la</b> cantidad de segundos / minutos / horas / días, lo que significa cuánto tiempo se guardarán los mensajes sin procesar en la cola.  Máximo - 14 días. <br><br>  <b>Tamaño</b> máximo del mensaje: tamaño máximo del mensaje en KB.  El valor es de 1 KB a 256 KB. <br><br>  <b>Demora de entrega:</b> puede establecer el tiempo de demora para entregar un mensaje a la cola.  De 0 segundos a 15 minutos (de hecho, los mensajes estarán en la cola, pero no serán visibles para recibir). <br><br>  <b>Tiempo de espera del mensaje de recepción:</b> tiempo, cuánto tiempo durará la conexión en caso de que usemos "Encuesta larga" para recibir nuevos mensajes. <br><br>  <b>Deduplicación basada en contenido: el</b> indicador, si se establece en verdadero, se agregará un "Id. De deduplicación" a cada mensaje en forma de hash SHA-256 generado a partir del contenido. <br><br><h4>  Configuración de cola muerta </h4><br>  <b>Use la política Redrive: una</b> bandera, si está configurada, los mensajes serán redirigidos después de varios intentos. <br><br>  <b>Cola de letra muerta: el</b> nombre de la cola "muerta" a la que se enviarán los mensajes sin formato. <br><br>  <b>Número máximo de recibos: el</b> número de intentos de procesamiento fallidos, después del cual el mensaje se enviará a la cola "inactiva" <br><blockquote>  <b>Aviso:</b> también tenga en cuenta que podemos enviar todos los parámetros principales junto con cada mensaje por separado.  Por ejemplo, cada mensaje individual puede tener su propio tiempo de <b>espera de visibilidad</b> o <b>retraso de entrega.</b> </blockquote><h3>  Ahora un poco sobre los mensajes en sí y sus propiedades: </h3><br>  Un mensaje tiene varios parámetros: <br><br>  <b>1. Cuerpo del mensaje:</b> cualquier texto <br>  <b>2. Id. De grupo de mensajes es</b> algo así como una etiqueta, un canal, requerido para todos los mensajes.  Se garantiza que cada uno de estos grupos se procesará en modo FIFO. <br>  <b>3. Id. De deduplicación del mensaje:</b> cadena para identificar duplicados.  Si se establece el modo "Deduplicación basada en contenido", el parámetro es opcional. <br><br><h4>  También hay atributos de mensaje </h4><br>  Los atributos consisten en un nombre, tipo y valor. <br><br>  <b>1. Nombre -</b> cadena <br>  <b>2. Tipo:</b> hay varios tipos: cadena, número, binario.  El tipo viene simplemente como una cadena, y es posible agregar un postfix al tipo.  En este caso, el tipo vendrá con este postfix a través del punto, por ejemplo string.example_postfix <br>  <b>3. Valor -</b> cadena <br><blockquote>  <b>Aviso:</b> tenga en cuenta que el número máximo de atributos es <b>10</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Detalles</a> </blockquote>  PD: Este artículo proporciona una breve descripción de la cola, así como un poco sobre las capacidades y la mecánica de SQS.  El siguiente artículo estará dedicado a <b>AWS Lambda</b> y, a continuación, a su intercambio práctico. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/457068/">https://habr.com/ru/post/457068/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../457058/index.html">Convertir resultados de impresiones en clics para Google y Yandex en 2019</a></li>
<li><a href="../457060/index.html">Tres videos para escritores de iOS</a></li>
<li><a href="../457062/index.html">Centro de Entrenamiento de Cosmonautas en Star City</a></li>
<li><a href="../457064/index.html">A la pregunta de módulos</a></li>
<li><a href="../457066/index.html">Cómo modificar el robot FEDOR y la silla de vuelo ISS</a></li>
<li><a href="../457070/index.html">Textolita en lugar de cartón. Algunas palabras sobre la insignia interactiva OFFZONE 2019</a></li>
<li><a href="../457072/index.html">Cómo resolver un viejo problema usando ML en Python y .Net</a></li>
<li><a href="../457074/index.html">La evolución de los desarrolladores: qué juegos debemos esperar en el futuro</a></li>
<li><a href="../457078/index.html">Cómo convertir tu avatar de Telegram en un reloj</a></li>
<li><a href="../457082/index.html">Concesión imperceptible de derechos de administrador</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>