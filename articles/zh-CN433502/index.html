<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤲🏻 🙄 🅾️ 蓝牙无线音频技术：哪个更好？ 👩🏿‍💼 🐎 ♑️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="随着技术的发展，如此熟悉的“管”式模拟耳机已被载入史册-越来越多地被蓝牙无线同类产品取代。 

 为了防潮和防尘，现代智能手机被剥夺了通常的连接器。 

 开发人员发布了所有新版本的蓝牙协议和所有新版本的编解码器，承诺“更快，更高，更强”-减少播放延迟，提高质量。 

 一切都很好吗？ 让我们看看。...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>蓝牙无线音频技术：哪个更好？</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/433502/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/uz/_p/or/uz_por_7qlk9snfb7v_jg2x5iae.jpeg"></div><br> 随着技术的发展，如此熟悉的“管”式模拟耳机已被载入史册-越来越多地被蓝牙无线同类产品取代。 <br><br> 为了防潮和防尘，现代智能手机被剥夺了通常的连接器。 <br><br> 开发人员发布了所有新版本的蓝牙协议和所有新版本的编解码器，承诺“更快，更高，更强”-减少播放延迟，提高质量。 <br><br> 一切都很好吗？ 让我们看看。 <br><a name="habracut"></a><br><h2> 引言 </h2><br> 我不会深入研究协议的技术实现以及无聊的规范。 亲爱的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" class="user_link">ValdikSS</a> ，他在很大程度上是本文的启发，甚至是科学顾问，他正在准备有关编解码器的综合材料-那里的所有内容都将更加详细和技术正确。 <br><br> 我想更多地谈谈个人经历。 好吧，有点娱乐性（无聊？）练习。 <br><br> 一年半以前，我对aptX的想法感到兴奋。 是的，我读了很多这样的评论，并且相信所有这些技术上的曲折。 一个孩子出生了-我真的很想在晚上和我的妻子一起戴着耳机看节目，而又不吵闹，也不吵醒屋里的任何人。 <br><br> 结果是什么？ <br><br><h2> 质素 </h2><br> 让我们从数字和事实开始（您好，维基百科！） <br><br>  <b>SBC</b>是一种很好的旧编解码器，符合A2DP标准。 该编解码器是Frans de Bont <i>（F.de Bont，M.Groenewegen和W.Oomen，“ 128 kb / s的高质量音频编码系统”，第98 AES公约，1995年2月25-28日）的工作</i>和使用的结果。在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">专利EP-0400755B1中</a>描述的算法。 值得注意的是，该专利的作者仅允许在蓝牙应用程序中免费使用SBC，但是该专利于2010年6月2日到期。 由于A2DP标准非常普遍，因此很难找到不支持SBC的耳机或扬声器。 <br><br> 编解码器提供16、32、44.1、48 kHz的采样频率，流速为10-1500 kbit / s。 是的，您没听错。 最高1500 kbps。 编解码器中根本没有比特率限制。 但是稍后会更多。 <br><br>  <b>aptX</b>编解码器<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">于1988年在贝尔法斯特女王大学开发</a> 。 是的，在蓝牙技术问世之前已有十几年了，因此编解码器被用于专业音频设备中。 高通公司目前拥有这些权利，因此使用需要许可和特许权使用费。 截至2014年，成本大致如下：一次性付款6,000美元，对于最多10,000个设备的参与者，每发布一台设备，≈1美元。 因此，许多具有Snapdragon 835、845、821、820、810、805、801、800、650、615、410芯片的设备都是很可能的，并支持aptX，但由于未购买许可证，该设备并未在那里激活。 关于它-也在下面。 <br><br> 编解码器具有16位的位深度和48 kHz的采样频率，可提供384 kbit / s（双通道）位速率。 <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">正式支持aptX的产品列表</a> 。 您可以在Aliexpress上找到许多支持aptX的未知系统，但要为事实做好准备，那就是实际上将有相同的旧SBC，而且仅此而已。 <br><br>  <b>aptX HD-</b>相同的编解码器，但具有不同的编码配置文件，流速度为576 kbit / s，支持高达48 kHz的采样频率和高达24位的位深。 有人称其为aptX无损编解码器-但这完全是胡说八道，仅是因为目前无法实现可以承载无损数据的流的价值。 该编解码器的一个特殊优势是可调整的编码延迟，在48 kHz的采样频率下可以将其降低到1 ms。 同样，从处理器加载的角度来看，编解码器是极其有利的，与MP3和AAS相比，它具有优势。 <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">正式支持aptX HD的产品列表</a> 。 他足够小。 <br><br>  <b>aptX低延迟</b> （或LL）是编解码器的特殊版本，可让您将声音延迟时间减少到40毫秒以下。  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">正式支持aptX LL的产品列表</a> 。 <br><br><img src="https://habrastorage.org/webt/oz/nd/5q/oznd5qcoovjbj8f4xdtfydbl_ym.png" alt="图片"><br><br> 她在那儿。 曾经是这张照片用细小东西给我买了。 延误！ 毕竟，谁想听到某部动作片的爆炸声，恐怖片中怪物的尖叫声或足球比赛结束后人群的吼叫声？ <br><br> 但是，这真的是这样吗？ <br><br>  las，不。 <br><br> 与任何营销材料一样，数字牵强。 延迟在很大程度上取决于系统中的缓冲和编解码器的实现。 因此，SBC的延迟可能会小于40 ms，考虑到电视广播的标准（+40 ms ... -60 ms），这是完全可以接受的。 <br><br>  <u>总结：</u> <br><br><ol><li> 现有的编解码器无法比有线技术更好，因为没有任何编解码器可以实现真正的无损压缩。 </li><li> 最受欢迎的编解码器是SBC。 他在设置上最灵活。 而且，尽管aptX发行得较早，但它无法击败SBC的流行，这显然是因为后者是免费的。 </li><li> 声音质量在很大程度上取决于编解码器的实施以及一般而言耳机/扬声器的硬件性能-如果扬声器本身较弱，则任何编解码器都无法提高质量。 因此，在将来，比较质量时，我们将讨论在相同的扬声器/耳机上使用相同的源，使用不同的编解码器播放相同内容的情况。 </li></ol><br><h2> 实际且非常主观的结果 </h2><br><img src="https://habrastorage.org/webt/fj/uf/kj/fjufkjmv-sxcezemnqcz3ztyue4.jpeg"><br><br> 这些信息基于已经提到的一年半的操作，比较和吸引外部听众经验。 <br><br> 体验的基础是在可以选择编解码器的SONY Walkman NWZ-A17播放器上收听无损音乐，以及观看通过Avantree Priva III输出音频的各种节目。 <br><br> 一共有三个耳机：Sennheiser PMX 60，Koss Porta Pro和Koss UR-20。 <br><br>  Jabra BT3030（SBC）和Avantree Clipper Pro（aptX）被用作无线信号接收器。 <br><br> 还使用了Voombox Outdoor（SBC）扬声器和Aftershokz Trekz Titanium（aptX）骨传导耳机。 <br><br> 所有均衡器和增强器均已关闭-这很重要。 <br><br>  <u>总计：</u> <br><br><ol><li> 有线连接播放的声音质量始终更好。 毫无疑问。 </li><li>  SBC和aptX之间的区别很难听到-仅在某些类型的音乐中。 例如，文章的作者清楚地听到了古典乐曲中大提琴独奏的差异，而对于小提琴和低频乐器，这种差异不太明显。 在现代流派（流行，电子音乐和摇滚）中，听不到差异。 在某些情况下，主观上似乎SBC的声音传输要比aptX好。 </li><li> 仅当您连接到同一信号源并将不同的接收器插入不同的耳朵时，才能看到SBC与aptX之间的延迟（例如，左声道为SBC，右声道为aptX）。 几乎不可能看到图片的延迟，但是因为aptX用于动态场景和内容的故事是一个神话。 </li><li> 令人惊讶的是由相当便宜且“不出名”的Voombox Outdoor的音质引起的。 显然，这是上面提到的SBC的成功实施。 </li><li>  aptX在具有骨骼传导功能的耳机中的实现是完全难以理解的-该技术非常具体，因此由于该技术本身，质量损失非常大。 考虑到设备操作的“范围”很小，与两个设备配对的实施效果非常差，我可以说Aftershokz是一家在营销方面投入更多资金而不是在开发方面投入资金的公司。 </li></ol><br><br> 我并不是说，如果您连接各种光谱分析仪等等，您可以并且应该看到两者之间的区别。 但是人耳，甚至更糟的是普通人耳，不是频谱设备，因此不会听到所有这些细微差别。 <br><br><h2> 实践：修复可以修复的问题 </h2><br><h3> 第1部分。打开aptX </h3><br> 如前所述，在某些设备中禁用了aptX的使用，可能是为了避免专利起诉。 <br><br> 通过滑动库设备以实现编解码器并在build.prop中编写使用此编解码器的功能，可以非常简单地解决此问题。 <br><br> 在Internet上，有许多这种性质的解决方案。 我自由地将它们组合为一个，同时将其实现为Magisk的模块。 是的，我真的很喜欢这个项目，我认为以Magisk模块的形式实现系统更改是一种更好，更安全的解决方案，它能够将系统保存为原始格式，并且可以轻松回滚。 <br><br> 该模块可<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">从此处</a>下载。 是的，我了解github。 不，直到我有时间把它放在那里。 <br><br> 该模块将自动模拟build.prop中的条目，包括aptX，如果可能的话，还包括aptX HD。 <br><br><img src="https://habrastorage.org/webt/vg/lc/gu/vglcguyqsbbyxptonmhdw-5ta3y.png"><br><br><h3> 第2部分。提高SBC比特率 </h3><br> 如先前报道，SBC编解码器基本上没有比特率限制。 但是，制造商通常将单声道设置为342 kbit / s，立体声设置为345 kbit / s，以确保在所有类型的接收设备上都能可靠运行。 <br><br> 同时，从2007年到2015年有效的A2DP v1.2规范要求所有解码设备以单声道最高320 kbit / s的比特率正常工作，而立体声信号则以512 kbit / s的比特率正常工作。 <br><br> 在规范的新版本中，根本没有比特率限制。 假定2015年之后发布并支持EDR的现代耳机可以支持高达730 kbps的比特率。 <br><br> 实际上，事实并非如此。  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">在</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" class="user_link">ValdikSS</a>进行的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">一项广泛研究</a>中，发现几乎所有接收设备都能以454 kbit / s的比特率可靠地工作，而相当数量的接收设备以507 kbit / s的比特率可靠地工作。 <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">在研究中，</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" class="user_link">ValdikSS</a>还表明，与人们普遍认为<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" class="user_link">aptX</a>编解码器质量相反，在某些文件上，其结果可能比标准328 kbps的SBC产生更差的结果，而切换到高比特率的SBC所产生的声音通常会超过aptX，在任何耳机上。 <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" class="user_link">根据</a>这些数据， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" class="user_link">ValdikSS</a>向Lineage OS和Google的开发人员发送了评论，但到目前为止还没有任何反应。 <br><br> 因此，我们只能手动修改蓝牙协议栈。 <br><br> 我们需要一个能够反编译ARM，任何HEX编辑器（我使用WinHEX）和我们设备中的bluetooth.default.so文件的IDA Pro。 通常，它位于路径/ system / lib / hw上，而且很少-路径/ system / lib64 / hw（肯定需要root访问）。 <br><br> 因此，打开bluetooth.default.so文件，下面描述的操作和修改仅适用于原始Android堆栈（bluedroid）。 如果您在IDA Pro中看到“需要的库'com.qualcomm.qti.bluetooth_audio@1.0.so'”之类的内容，则该说明很有可能对您没有帮助。 <br><br><img src="https://habrastorage.org/webt/cf/3l/jb/cf3ljbjgckew4pd9tbutsy-tyaw.png"><br><br> 我们的首要任务是在标准配置中用双通道替代联合立体声。 <br><br> 我们将使用<a href="">bta_av_build_src_cfg函数</a> 。 <br><br> 要在IDA中找到此过程，我们将<a href="">在调试日志“无法解析src cap ret =％d”中</a>使用<a href="">行</a>搜索<a href="">来</a>查找<a href="">特征消息</a> ： <br><br><img src="https://habrastorage.org/webt/wh/dk/ex/whdkexvibrxijvj7pqb-buzb0z8.png"><br><br><img src="https://habrastorage.org/webt/ea/2h/nh/ea2hnhbszbtyieokldywuch2qvi.png"><br><br> 结果，很快我们就以代码形式找到了函数本身： <br><br><img src="https://habrastorage.org/webt/mf/5_/_9/mf5__9yydhgwip0lvemgqwcwocw.png"><br><br> 我们的任务是替换支票的原始结构 <br><br><pre><code class="plaintext hljs">if (src_cap.ch_mode &amp; A2D_SBC_IE_CH_MD_JOINT) pref_cap.ch_mode = A2D_SBC_IE_CH_MD_JOINT; else if (src_cap.ch_mode &amp; A2D_SBC_IE_CH_MD_STEREO) pref_cap.ch_mode = A2D_SBC_IE_CH_MD_STEREO; else if (src_cap.ch_mode &amp; A2D_SBC_IE_CH_MD_DUAL) pref_cap.ch_mode = A2D_SBC_IE_CH_MD_DUAL; else if (src_cap.ch_mode &amp; A2D_SBC_IE_CH_MD_MONO) pref_cap.ch_mode = A2D_SBC_IE_CH_MD_MONO;&lt;/code&gt;  &lt;code&gt; if (src_cap.ch_mode &amp; A2D_SBC_IE_CH_MD_DUAL) pref_cap.ch_mode = A2D_SBC_IE_CH_MD_DUAL; else if (src_cap.ch_mode &amp; A2D_SBC_IE_CH_MD_STEREO) pref_cap.ch_mode = A2D_SBC_IE_CH_MD_STEREO; else if (src_cap.ch_mode &amp; A2D_SBC_IE_CH_MD_DUAL) pref_cap.ch_mode = A2D_SBC_IE_CH_MD_DUAL; else if (src_cap.ch_mode &amp; A2D_SBC_IE_CH_MD_MONO) pref_cap.ch_mode = A2D_SBC_IE_CH_MD_MONO;</code> </pre> <br> 有几种方法可以做到这一点。 <br><br> 首先是按照检查顺序将指令TST.W R0，＃1替换为TST.W R0，＃4并将MOVS R0，＃1替换为MOVS R0，＃4： <br><br><img src="https://habrastorage.org/webt/6e/zu/so/6ezusojttx0gavinlppmqeroet8.png"><br><br> 在字节码中，这是将x01替换为x04。 重要的是要注意字节的特征序列，通过该序列可以找到此模式。 在不深入细节的情况下，我会说本质上是对序列的搜索 <br><br><pre> <code class="plaintext hljs">10 20 8D F8 04 00 9D F8 0D 00 10 F0 01 0F ?? ?? 10 F0 02 0F ?? ?? 10 F0 04 0F ?? ?? 10 F0 08 0F ?? ?? 08 20 ?? ?? 01 20 ?? ?? 02 20 ?? ?? 04 20</code> </pre> <br> 及其替换 <br><br><pre> <code class="plaintext hljs">?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? 04 ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? 04 ?? ?? ?? ?? ?? ?? ?? ?? ??</code> </pre> <br> 但是，该方法具有缺点。 <br><br> 许多编译器根据优化来更改命令的执行顺序。 并且在这种情况下，不可能找到所需的模式，有时将结构中的检查机制通常引入到内联代码中。 因此，更改常量<a href="">btif_av_sbc_default_config</a>更加可靠。 <br><br> 对于初学者-找到她。 她刚开始担任我们的职务，因为 <br><br><pre> <code class="plaintext hljs">void bta_av_build_src_cfg (UINT8 *p_pref_cfg, UINT8 *p_src_cap) { tA2D_SBC_CIE src_cap; tA2D_SBC_CIE pref_cap; UINT8 status = 0; /* initialize it to default SBC configuration */ A2D_BldSbcInfo(AVDT_MEDIA_AUDIO, (tA2D_SBC_CIE *) &amp;btif_av_sbc_default_config, p_pref_cfg); /* now try to build a preferred one */ /* parse configuration */ if ((status = A2D_ParsSbcInfo(&amp;src_cap, p_src_cap, TRUE)) != 0) { APPL_TRACE_DEBUG(" Cant parse src cap ret = %d", status);</code> </pre> <br> 她在这里： <br><br><img src="https://habrastorage.org/webt/xi/j2/dt/xij2dtvma0evlnggxkxzqxkvdn4.png"><br><br><img src="https://habrastorage.org/webt/7a/z9/36/7az936re6naesontslfi1ogkd5c.png"><br><br> 可以看出btif_av_sbc_default_config本身是一个字节序列20 01 10 04 01 35 02，而第一个字节编码采样频率，可以是10（48 kHz）和20（44 kHz），因此不具体。 因此，我们的任务是替换序列 <br> <code>01 10 04 01 35 02</code> <br> 在 <br> <code>04 ?? ?? ?? ?? ??</code> <br> <br> 这将允许您以类似的方式更改结构的逻辑，但是同时优化编译器不会引起问题。 <br><br> 在某些情况下，耳机或扬声器本身会启动连接。 在这种情况下，模式由<a href="">bta_av_co_audio_init</a>函数确定。 <br><br> 该函数的<a href="">特点是“ bta_av_co_audio_init：％d”行</a> ，可以在代码中轻松地进行搜索： <br><img src="https://habrastorage.org/webt/fi/5o/ku/fi5okug9tbn6gvleetxo93uk9qg.png"><br><br> 在以下命令中枚举可能的连接模式： <br><br><pre> <code class="plaintext hljs"> switch (index) { case BTIF_SV_AV_AA_SBC_INDEX: /* Set up for SBC codec for SRC*/ *p_codec_type = BTA_AV_CODEC_SBC; /* This should not fail because we are using constants for parameters */ A2D_BldSbcInfo(AVDT_MEDIA_AUDIO, (tA2D_SBC_CIE *) &amp;bta_av_co_sbc_caps, p_codec_info); /* Codec is valid */ return TRUE;</code> </pre> <br>  <a href="">常量bta_av_co_sbc_caps具有以下结构</a> ： <br><br><pre> <code class="plaintext hljs">const tA2D_SBC_CIE bta_av_co_sbc_caps = { (A2D_SBC_IE_SAMP_FREQ_44), /* samp_freq */ (A2D_SBC_IE_CH_MD_MONO | A2D_SBC_IE_CH_MD_STEREO | A2D_SBC_IE_CH_MD_JOINT | A2D_SBC_IE_CH_MD_DUAL), /* ch_mode */ (A2D_SBC_IE_BLOCKS_16 | A2D_SBC_IE_BLOCKS_12 | A2D_SBC_IE_BLOCKS_8 | A2D_SBC_IE_BLOCKS_4), /* block_len */ (A2D_SBC_IE_SUBBAND_4 | A2D_SBC_IE_SUBBAND_8), /* num_subbands */ (A2D_SBC_IE_ALLOC_MD_L | A2D_SBC_IE_ALLOC_MD_S), /* alloc_mthd */ BTA_AV_CO_SBC_MAX_BITPOOL, /* max_bitpool */ A2D_SBC_IE_MIN_BITPOOL /* min_bitpool */ };</code> </pre> <br> 该常数很容易在代码中找到，在我的情况下为20 0F F0 0C 03 35 02： <br><br><img src="https://habrastorage.org/webt/kj/hw/oi/kjhwoibpuk8brwa3kzvxiuxgeba.png"><br><br> 注意字节<b>0F-</b>它提供了与任何有效模式连接的能力，因为 <br><br><pre> <code class="plaintext hljs">x0F = A2D_SBC_IE_CH_MD_MONO | A2D_SBC_IE_CH_MD_STEREO | A2D_SBC_IE_CH_MD_JOINT | A2D_SBC_IE_CH_MD_DUAL = x08 | x02 | x01 | x04</code> </pre> <br> 我们的任务是如下更改此值： <br><br><pre> <code class="plaintext hljs">x0F = A2D_SBC_IE_CH_MD_DUAL = x04</code> </pre> <br> 因此，有必要更换 <br><br> <code>?? 0F F0 0C 03 35 02</code> <br> 在 <br> <code>?? 04 ?? ?? ?? ?? ??</code> <br> <br> 因此，在通过设备启动连接的情况下以及在信号接收端启动连接的情况下，我们都强制堆栈以双通道模式进行连接。 <br><br> 现在，您需要删除比特率限制或提高其上限。 <br><br> 需要处理<a href="">btif_media_task_get_sbc_rate</a> 。 同样，要搜索<a href="">特征线“检测到非edr a2dp接收器，将速率限制为％d”，我们</a>在代码中查找函数： <br><img src="https://habrastorage.org/webt/kp/go/j2/kpgoj2xsq6vt8kbnexy81jy6j6s.png"><br><br> 比特率限制以字符串表示 <br>  UINT16速率= DEFAULT_SBC_BITRATE（依次<a href="">为328 kbps</a> ） <br><br> 在代码中，是这样的： <br><br><img src="https://habrastorage.org/webt/tf/ba/bn/tfbabnrxfks3pejhzqzdegiwn04.png"><br><br> 将此值更改为454 kbit / s-高于标准值，并且适用于绝大多数接收器。 为此，请替换字节 <br><br> <code>B1 4F F4 A4 74 ?? E0</code> <br> 在 <br> <code>?? ?? ?? E3 ?? ?? ??</code> <br> <br> 您还应该按模式搜索。 <br><br> <code>E0 4F F4 A4 74 ?? E0</code> <br> 并替换为 <br> <code>?? ?? ?? E3 ?? ?? ??</code> <br>  -这是许多设备所必需的。 <br><br>  E3的值可能会有所不同，具体取决于所需的最大比特率： <br><br><ul><li>  E3-454 kbps </li><li>  F1-482 kbps </li><li>  F3-486 kbps </li><li>  10-576 kbps </li><li>  48-无限制 </li></ul><br> 通常，这由操作MOV.W R4，XXX的字节码确定。 <br><br> 实际上，值得尝试并选择所有接收设备都能稳定接收信号的最大值，而不会出现破裂，中断或失真。 <br><br> 在实验中的所有接收器上（我在上面指出），该值为576 kbit / s，小米Redmi 4x MIUI10 Android 7.1手机是信号源。 <br><br> 根据描述的操作，创建了一个通用补丁程序，该补丁程序可在Bluetooth.default.so中找到指定的模式并将其替换？ 包括强制双通道模式，并将比特率限制设置为454 kbps。 如有必要，可以根据对相应字节的搜索和替换轻松更改限值-细心的阅读器将轻松完成此操作。 <br><br> 我强调：该修补程序仅在bluedroid堆栈的情况下有效，而在Fluoride堆栈和Android 8及更高版本的情况下很可能不会成功。 <br><br> 可以<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">从这里</a>下载补丁。 <br><br> 强烈建议您将原始文件替换为Magisk模块，对于我自己，我这样<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">做如下</a> 。  <b>请注意</b> ：这些模块是我为小米Redmi 4x 3/32 GB手机由我制作的，撰写本文时使用的是当前全局稳定的MIUI 10固件。对于您而言，如上所述，bluetooth.default.so文件必须替换为您自己的补丁补丁。 也有可能必须沿着路径/ system / lib64 / hw复制该文件-这取决于手机的型号和固件版本。 <br><br> 如果发现某些接收设备不支持双通道，则使用Magisk模块的这种方法可以轻松更改最大比特率，并且通常禁止更改。 <br><br><h2> 结论 </h2><br> 目前，为了追求销售，许多公司都提出了一些技术创新作为更高价格的理由。 <br><br> 实际上，事实证明，现有的廉价技术没有得到充分开发，并且技术创新没有得到充分实施，这极大地影响了质量。 <br><br> 很多时候，用户会体验到“安慰剂效应”，仅凭产品更新或更丰富的色彩就可以说服自己达到完美。 实际上，这种质量是虚构的。 <br><br> 尽管与有线版本相比，无线音频传输的质量明显下降，但现代设备制造商似乎正致力于向无线技术的完全过渡。 同时，使用营销技巧来证明价格上涨是合理的：防止电话浸入水中（如何在水下说话？为什么将设备掉入水中？），使用更昂贵的编解码器等。 同时，现有流行的SBC编解码器的潜力没有得到充分利用。 <br><br>  Google无法获得有关328 kbps比特率限制的任何澄清，也无法消除该限制，因此无法从Lineage OS的开发人员的蓝牙菜单中添加启用双通道的选项。 <br><br> 感谢所有读完本书的人！ <br><br> 注释中的讨论和有关LDAC编解码器的空格引起了一些延续。 <br><br><img src="https://habrastorage.org/webt/ob/mr/cc/obmrccmcn21gzh8g1ca3g3ykfs4.jpeg"></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN433502/">https://habr.com/ru/post/zh-CN433502/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN433490/index.html">Creality CR-X 3D打印机评论</a></li>
<li><a href="../zh-CN433494/index.html">你永远不会知道的10个英语习语</a></li>
<li><a href="../zh-CN433496/index.html">国有企业有义务在2022年之前转向家用软件</a></li>
<li><a href="../zh-CN433498/index.html">Sberbank-您为我准备了一个“包裹”，但我不会接受...</a></li>
<li><a href="../zh-CN433500/index.html">伯克利快递机器人因缺少监视系统状态而被烧毁</a></li>
<li><a href="../zh-CN433504/index.html">如何停止为微控制器编写固件并开始工作</a></li>
<li><a href="../zh-CN433506/index.html">欧盟寻求维修大型家用电器的权利</a></li>
<li><a href="../zh-CN433508/index.html">MIPS体系结构所有者打算在2019年开放其指令集（ISA）</a></li>
<li><a href="../zh-CN433510/index.html">游戏中的跨文化差异</a></li>
<li><a href="../zh-CN433512/index.html">幸福理论。 令人头晕的黄油三明治三明治</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>