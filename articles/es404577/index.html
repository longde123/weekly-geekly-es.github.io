<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚úã üåû üë®üèæ‚Äçüîß Evoluci√≥n del enfoque de implementaci√≥n de c√≥digo en Reddit ü•Ç üë©‚Äçüé§ üèí</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Nosotros, en el equipo de servicio de pago de blockchain de Wirex , estamos familiarizados con la experiencia de la necesidad de refinar y mejorar con...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Evoluci√≥n del enfoque de implementaci√≥n de c√≥digo en Reddit</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/wirex/blog/404577/"><img src="https://habrastorage.org/web/ff7/6e9/159/ff76e9159228455b8f91663d289c8e2f.png" alt="imagen"><br><br>  <i>Nosotros, en el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">equipo de</a> servicio de pago de blockchain de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Wirex</a> , estamos familiarizados con la experiencia de la necesidad de refinar y mejorar constantemente la soluci√≥n tecnol√≥gica existente.</i>  <i>El autor del material a continuaci√≥n habla sobre la historia de la evoluci√≥n del despliegue de c√≥digo de la famosa plataforma de noticias sociales Reddit.</i> <br><br><blockquote>  "Es importante seguir la direcci√≥n de su desarrollo para poder enviarlo en una buena direcci√≥n a tiempo". </blockquote><br>  El equipo de Reddit est√° implementando constantemente c√≥digo.  Todos los miembros del equipo de desarrollo escriben regularmente c√≥digo que es revisado por el propio autor, y se prueba desde el exterior, para que luego pueda ir a la "producci√≥n".  Cada semana realizamos al menos 200 "implementaciones", cada una de las cuales suele durar menos de 10 minutos. <br><br>  El sistema que proporciona todo esto ha evolucionado a lo largo de los a√±os.  Veamos qu√© ha cambiado todo este tiempo y qu√© ha permanecido sin cambios. <br><br><h3>  Comienzo de la historia: implementaciones estables y recurrentes (2007-2010) </h3><br>  Todo el sistema que tenemos hoy ha crecido a partir de una semilla: un script de Perl llamado push.  Fue escrito hace mucho tiempo, en tiempos muy diferentes para Reddit.  Todo nuestro equipo t√©cnico era tan peque√±o en ese momento que <a href="">cab√≠a</a> silenciosamente <a href="">en una peque√±a "sala de reuniones"</a> .  No usamos AWS entonces.  El sitio funcionaba en un n√∫mero finito de servidores, y cualquier capacidad adicional ten√≠a que agregarse manualmente.  Todo funcion√≥ en una gran aplicaci√≥n Python monol√≠tica llamada r2. <br><a name="habracut"></a><br>  Una cosa a lo largo de los a√±os se ha mantenido sin cambios.  Las solicitudes se clasificaron en el equilibrador de carga y se distribuyeron entre los "grupos" que conten√≠an servidores de aplicaciones m√°s o menos id√©nticos.  Por ejemplo, las p√°ginas de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">listas de temas</a> y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">comentarios</a> son procesadas por diferentes grupos de servidores.  De hecho, cualquier proceso r2 puede manejar cualquier tipo de solicitud, sin embargo, la divisi√≥n en grupos le permite proteger a cada uno de ellos de saltos repentinos en el tr√°fico en grupos vecinos.  Por lo tanto, en caso de crecimiento del tr√°fico, la falla no amenaza a todo el sistema, sino a sus grupos individuales. <br><br><img src="https://habrastorage.org/web/63d/7b1/8e7/63d7b18e768d4b15a6310ecf6f0e15d5.png" alt="imagen"><br><br>  La lista de servidores de destino se escribi√≥ manualmente en el c√≥digo de la herramienta de inserci√≥n, y el proceso de implementaci√≥n funcion√≥ con un sistema monol√≠tico.  La herramienta ejecut√≥ la lista de servidores, revis√≥ SSH, ejecut√≥ una de las secuencias de comandos predefinidas que actualizaban la copia actual del c√≥digo usando git y reinici√≥ todos los procesos de la aplicaci√≥n.  La esencia del proceso (el c√≥digo se simplifica enormemente para una comprensi√≥n general): <br><br><pre><code class="hljs mel">#            <span class="hljs-string"><span class="hljs-string">`make -C /home/reddit/reddit static`</span></span> <span class="hljs-string"><span class="hljs-string">`rsync /home/reddit/reddit/static public:/var/www/`</span></span> #    app-        #    ,   foreach $h (@hostlist) { <span class="hljs-string"><span class="hljs-string">`git push $h:/home/reddit/reddit master`</span></span> <span class="hljs-string"><span class="hljs-string">`ssh $h make -C /home/reddit/reddit`</span></span> <span class="hljs-string"><span class="hljs-string">`ssh $h /bin/restart-reddit.sh`</span></span> }</code> </pre> <br>  El despliegue tuvo lugar secuencialmente, un servidor tras otro.  A pesar de su simplicidad, el esquema ten√≠a una ventaja importante: es muy similar al " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">despliegue canario</a> ".  Al implementar el c√≥digo en varios servidores y al notar errores, inmediatamente se dio cuenta de que hab√≠a errores, pod√≠a interrumpir (Ctrl-C) el proceso y retroceder antes de que surjan problemas con todas las solicitudes a la vez.  La facilidad de implementaci√≥n hizo que fuera f√°cil y sin consecuencias serias verificar las cosas en producci√≥n y revertirlas si no funcionaban.  Adem√°s, fue conveniente determinar qu√© implementaci√≥n en particular caus√≥ errores, d√≥nde espec√≠ficamente y qu√© debe revertirse. <br><br>  Tal mecanismo hizo un buen trabajo al garantizar la estabilidad y el control durante el despliegue.  La herramienta funcion√≥ bastante r√°pido.  Las cosas salieron bien. <br><br><h3>  Nuestro regimiento lleg√≥ (2011) </h3><br>  Luego contratamos a m√°s personas, ahora hab√≠a seis desarrolladores y nuestra nueva <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">"sala de reuniones" se hizo m√°s espaciosa</a> .  Comenzamos a darnos cuenta de que el proceso de implementaci√≥n del c√≥digo ahora necesitaba m√°s coordinaci√≥n, especialmente cuando los colegas trabajaban desde casa.  La utilidad de inserci√≥n se ha actualizado: ahora anunci√≥ el comienzo y el final de las implementaciones utilizando el chatbot IRC, que simplemente se sent√≥ en el IRC y anunci√≥ eventos.  Los procesos llevados a cabo durante las implementaciones no sufrieron casi ning√∫n cambio, pero ahora el sistema hizo todo por el desarrollador y les inform√≥ a todos los dem√°s sobre las modificaciones realizadas. <br><br>  A partir de ese momento, el uso del chat comenz√≥ en el flujo de trabajo de implementaci√≥n.  Hablar de administrar la implementaci√≥n desde chats era bastante popular en ese momento, sin embargo, dado que utilizamos servidores IRC de terceros, no pod√≠amos confiar en el chat al cien por cien para administrar el entorno de producci√≥n y, por lo tanto, el proceso se mantuvo al nivel de un flujo de informaci√≥n unidireccional. <br><br>  A medida que el tr√°fico hacia el sitio creci√≥, tambi√©n lo hizo la infraestructura que lo soportaba.  De vez en cuando, ten√≠amos que lanzar un nuevo grupo de servidores de aplicaciones y ponerlos en funcionamiento.  El proceso a√∫n no estaba automatizado.  En particular, la lista de hosts en inserci√≥n todav√≠a necesitaba actualizarse manualmente. <br><br>  El poder de los grupos generalmente aumentaba al agregar varios servidores a la vez.  Como resultado, empujar sucesivamente a trav√©s de la lista logr√≥ transferir cambios a un grupo completo de servidores en el mismo grupo, sin afectar a los dem√°s, es decir, no hubo diversificaci√≥n por grupos. <br><br><img src="https://habrastorage.org/web/ccd/063/580/ccd0635803d647b7b0161762c2aa5ff7.png" alt="imagen"><br><br>  UWSGI se utiliz√≥ para controlar los procesos de los trabajadores y, por lo tanto, cuando le dimos a la aplicaci√≥n un comando de reinicio, elimin√≥ todos los procesos existentes a la vez y los reemplaz√≥ por otros nuevos.  Los nuevos procesos tardaron un tiempo en prepararse para procesar las solicitudes.  En el caso de un reinicio involuntario de un grupo de servidores ubicados en el mismo grupo, la combinaci√≥n de estas dos circunstancias afect√≥ seriamente la capacidad de este grupo para atender solicitudes.  As√≠ que nos topamos con un l√≠mite en la velocidad de implementaci√≥n segura de c√≥digo en todos los servidores.  A medida que crec√≠a el n√∫mero de servidores, tambi√©n lo hac√≠a la duraci√≥n de todo el procedimiento. <br><br><h3>  Reciclar despliegue de instrumentos (2012) </h3><br>  Redise√±amos completamente la herramienta de implementaci√≥n.  Y aunque su nombre, a pesar de una alteraci√≥n completa, sigui√≥ siendo el mismo (push), esta vez fue escrito en Python.  La nueva versi√≥n ha tenido algunas mejoras importantes. <br><br>  En primer lugar, tom√≥ la lista de hosts del DNS, y no de la secuencia que estaba codificada en el c√≥digo.  Esto permiti√≥ que solo se actualizara la lista, sin la necesidad de actualizar el c√≥digo de inserci√≥n.  Los comienzos de un sistema de descubrimiento de servicios han surgido. <br><br>  Para resolver el problema de los reinicios sucesivos, barajamos la lista de hosts antes de las implementaciones.  El barajado reduce los riesgos y permite acelerar el proceso. <br><br><img src="https://habrastorage.org/web/b13/1ec/1ee/b131ec1eec994fa0bc9900bd9d8f7766.PNG" alt="imagen"><br><br>  La versi√≥n original baraj√≥ la lista aleatoriamente cada vez, sin embargo, esto dificult√≥ la reversi√≥n r√°pida, porque cada vez que la lista del primer grupo de servidores era diferente.  Por lo tanto, corregimos la mezcla: ahora generaba un cierto orden que podr√≠a usarse durante la implementaci√≥n repetida despu√©s de la reversi√≥n. <br><br>  Otro cambio peque√±o pero importante fue el despliegue constante de alguna versi√≥n fija del c√≥digo.  La versi√≥n anterior de la herramienta siempre actualizaba la rama maestra en el host de destino, pero ¬øqu√© sucede si el maestro cambia correctamente durante la implementaci√≥n debido a que alguien lanz√≥ el c√≥digo por error?  La implementaci√≥n de una revisi√≥n git determinada en lugar de llamar por nombre de sucursal hizo posible asegurarse de que se usara la misma versi√≥n de c√≥digo en cada servidor de producci√≥n. <br><br>  Y finalmente, la nueva herramienta distingui√≥ su c√≥digo (trabaj√≥ principalmente con una lista de hosts y accedi√≥ a ellos a trav√©s de SSH) y los comandos ejecutados en los servidores.  Todav√≠a depend√≠a mucho de las necesidades de r2, pero ten√≠a algo as√≠ como un prototipo de API.  Esto permiti√≥ que r2 siguiera sus propios pasos de implementaci√≥n, lo que facilit√≥ los cambios continuos y liber√≥ el flujo.  El siguiente es un ejemplo de comandos ejecutados en un servidor separado.  El c√≥digo, nuevamente, no es el c√≥digo exacto, pero en general esta secuencia describe bien el flujo de trabajo de r2: <br><br><pre> <code class="hljs pgsql">sudo /opt/reddit/deploy.py <span class="hljs-keyword"><span class="hljs-keyword">fetch</span></span> reddit sudo /opt/reddit/deploy.py deploy reddit f3bbbd66a6 sudo /opt/reddit/deploy.py <span class="hljs-keyword"><span class="hljs-keyword">fetch</span></span>-names sudo /opt/reddit/deploy.py <span class="hljs-keyword"><span class="hljs-keyword">restart</span></span> <span class="hljs-keyword"><span class="hljs-keyword">all</span></span></code> </pre> <br>  Especialmente vale la pena mencionar los nombres de b√∫squeda: esta instrucci√≥n es exclusiva de r2. <br><br><h3>  Autoescalado (2013) </h3><br>  Luego, finalmente decidimos cambiar a una nube con escala autom√°tica (un tema para una publicaci√≥n completamente separada).  Esto nos permiti√≥ ahorrar un mont√≥n de dinero en esos momentos en que el sitio no estaba cargado de tr√°fico y aumentar autom√°ticamente la capacidad para hacer frente a cualquier aumento brusco de las solicitudes. <br><br>  Las mejoras anteriores, cargando autom√°ticamente la lista de hosts desde DNS, han hecho que esta transici√≥n sea algo natural.  La lista de hosts cambi√≥ con m√°s frecuencia que antes, pero desde el punto de vista de la herramienta de implementaci√≥n, esto no jug√≥ ning√∫n papel.  El cambio, que se introdujo originalmente como una mejora de la calidad, se ha convertido en uno de los componentes clave necesarios para ejecutar el escalado autom√°tico. <br><br>  Sin embargo, el escalado autom√°tico ha llevado a algunos casos l√≠mite interesantes.  Era necesario controlar los lanzamientos.  ¬øQu√© sucede si el servidor se inicia correctamente durante la implementaci√≥n?  Necesit√°bamos asegurarnos de que cada nuevo servidor que se estaba ejecutando verificaba la disponibilidad del nuevo c√≥digo y lo tomaba, si hab√≠a uno.  No podr√≠amos olvidarnos de que los servidores se desconectaron en el momento de la implementaci√≥n.  La herramienta necesitaba ser m√°s inteligente y aprender a determinar que el servidor se desconect√≥ como parte del procedimiento, y no como resultado de un error que ocurri√≥ durante la implementaci√≥n.  En el √∫ltimo caso, tuvo que advertir en voz alta a todos los colegas involucrados en el problema. <br><br>  Al mismo tiempo, nosotros, por cierto, y por varias razones, cambiamos de uWSGI a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Gunicorn</a> .  Sin embargo, desde el punto de vista del tema de esta publicaci√≥n, dicha transici√≥n no condujo a ning√∫n cambio significativo. <br><br>  Entonces funcion√≥ por un tiempo. <br><br><h3>  Demasiados servidores (2014) </h3><br>  Con el tiempo, la cantidad de servidores necesarios para atender el tr√°fico pico aument√≥.  Esto condujo al hecho de que las implementaciones requer√≠an m√°s y m√°s tiempo.  En el peor de los casos, una implementaci√≥n normal tom√≥ aproximadamente una hora, un resultado pobre. <br><br>  Reescribimos la herramienta para que pueda admitir el trabajo paralelo con hosts.  La nueva versi√≥n se llama <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">rollingpin</a> .  La versi√≥n anterior requer√≠a mucho tiempo para inicializar las conexiones ssh y esperar la finalizaci√≥n de todos los comandos, por lo que la paralelizaci√≥n dentro de l√≠mites razonables nos permiti√≥ acelerar la implementaci√≥n.  El tiempo de implementaci√≥n nuevamente disminuy√≥ a cinco minutos. <br><br><img src="https://habrastorage.org/web/efb/7ba/c3d/efb7bac3df5a4905897b462dea14bf62.PNG" alt="imagen"><br><br>  Para reducir el impacto de reiniciar simult√°neamente varios servidores, el componente de mezcla de la herramienta se ha vuelto m√°s inteligente.  En lugar de barajar a ciegas la lista, orden√≥ los grupos de servidores de modo que los hosts de un grupo estuvieran <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">lo m√°s</a> separados <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">posible</a> . <br><br>  El cambio m√°s importante en la nueva herramienta fue que la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">API entre la herramienta de implementaci√≥n y las herramientas en cada servidor</a> se defini√≥ mucho m√°s claramente y se separ√≥ de las necesidades de r2.  Inicialmente, esto se hizo por el deseo de hacer que el c√≥digo est√© m√°s orientado al c√≥digo abierto, pero pronto este enfoque fue muy √∫til de otra manera.  El siguiente es un ejemplo de implementaci√≥n con la selecci√≥n de comandos API lanzados de forma remota: <br><br><img src="https://habrastorage.org/web/a8b/2d4/750/a8b2d4750f65444998587581f1d1132f.png" alt="imagen"><br><br><h3>  Demasiada gente (2015) </h3><br>  De repente, lleg√≥ un momento en que, como result√≥, muchas personas ya estaban trabajando en r2.  Fue genial, y al mismo tiempo significaba que habr√≠a a√∫n m√°s implementaciones.  Cumplir con la regla de un despliegue a la vez se hizo m√°s y m√°s dif√≠cil.  Los desarrolladores tuvieron que ponerse de acuerdo el procedimiento para emitir el c√≥digo.  Para optimizar la situaci√≥n, agregamos otro elemento al chatbot que coordina la cola de implementaci√≥n.  Los ingenieros solicitaron una reserva de implementaci√≥n y la recibieron o su c√≥digo "en cola".  Esto ayud√≥ a simplificar los despliegues, y aquellos que quer√≠an completarlos pod√≠an esperar tranquilamente su turno. <br><br>  Otra adici√≥n importante a medida que el equipo creci√≥ fue rastrear las implementaciones en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">un solo lugar</a> .  Cambiamos la herramienta de implementaci√≥n para enviar m√©tricas a Graphite.  Esto facilit√≥ el seguimiento de la correlaci√≥n entre implementaciones y cambios m√©tricos. <br><br><h3>  Muchos (dos) servicios (tambi√©n 2015) </h3><br>  De repente, lleg√≥ el momento del lanzamiento del segundo servicio en l√≠nea.  Era una versi√≥n m√≥vil del sitio web con su propia pila completamente diferente, sus propios servidores y el proceso de compilaci√≥n.  Esta fue la primera prueba real de una API de herramienta de implementaci√≥n dividida.  Agregarle la capacidad de resolver todas las etapas de ensamblaje en diferentes "ubicaciones" para cada proyecto le permiti√≥ soportar la carga y hacer frente al mantenimiento de dos servicios dentro del mismo sistema. <br><br><h3>  25 servicios (2016) </h3><br>  Durante el a√±o siguiente, fuimos testigos de la r√°pida expansi√≥n del equipo.  En lugar de dos servicios, aparecieron dos docenas, en lugar de dos equipos de desarrollo, quince.  La mayor√≠a de los servicios se <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">crearon</a> en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Baseplate</a> , nuestro marco de back-end o en aplicaciones cliente, similares a la web m√≥vil.  La infraestructura detr√°s de las implementaciones es la misma para todos.  Pronto, muchos otros servicios nuevos se lanzar√°n en l√≠nea, y todo esto se debe en gran medida a la versatilidad del rodillo.  Le permite simplificar el lanzamiento de nuevos servicios utilizando herramientas familiares para las personas. <br><br><h3>  Airbag (2017) </h3><br>  A medida que aumentaba el n√∫mero de servidores en el monolito, aumentaba el tiempo de implementaci√≥n.  Quer√≠amos aumentar significativamente el n√∫mero de implementaciones paralelas, pero esto causar√≠a demasiados reinicios simult√°neos de los servidores de aplicaciones.  Tales cosas, por supuesto, conducen a una ca√≠da en el rendimiento y una p√©rdida de la capacidad de atender las solicitudes entrantes debido a la sobrecarga de los servidores restantes. <br><br>  El proceso principal de Gunicorn utilizaba el mismo modelo que uWSGI, recargando a todos los trabajadores al mismo tiempo.  Los nuevos procesos de trabajo no pudieron atender solicitudes hasta que se cargaron por completo.  El tiempo de lanzamiento de nuestro monolito oscil√≥ entre 10 y 30 segundos.  Esto significaba que durante este per√≠odo de tiempo no podr√≠amos procesar solicitudes en absoluto.  Para encontrar una salida a esta situaci√≥n, reemplazamos el proceso principal de gunicorn con el administrador de trabajo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Einhorn</a> de Stripe, al <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">tiempo que conservamos la pila HTTP Gunicorn y el contenedor WSGI</a> .  Durante el reinicio, Einhorn crea un nuevo trabajador, espera hasta que est√© listo, se deshace de un antiguo trabajador y repite el proceso hasta que se complete la actualizaci√≥n.  Esto crea una bolsa de aire y nos permite mantener el ancho de banda a un nivel durante las implementaciones. <br><br>  El nuevo modelo cre√≥ otro problema.  Como se mencion√≥ anteriormente, reemplazar a un trabajador por uno nuevo y completamente terminado tom√≥ hasta 30 segundos.  Esto significaba que si hab√≠a un error en el c√≥digo, no aparec√≠a inmediatamente y lograba desplegarse en muchos servidores antes de ser detectado.  Para evitar esto, introdujimos un mecanismo para bloquear la transici√≥n del procedimiento de implementaci√≥n al nuevo servidor, que estuvo vigente hasta que se reiniciaron todos los procesos de trabajo.  Se implement√≥ simplemente: encuestando el estado de Einhorn y esperando la preparaci√≥n de todos los nuevos trabajadores.  Para mantener la velocidad al mismo nivel, ampliamos la cantidad de servidores que se procesan en paralelo, lo que era completamente seguro en las nuevas condiciones. <br><br>  Dicho mecanismo nos permite implementar simult√°neamente en un n√∫mero mucho mayor de m√°quinas, y el tiempo de implementaci√≥n, que abarca aproximadamente 800 servidores, se reduce a 7 minutos, teniendo en cuenta pausas adicionales para verificar errores. <br><br><h3>  Mirando hacia atr√°s </h3><br>  La infraestructura de implementaci√≥n descrita aqu√≠ es un producto nacido de muchos a√±os de mejoras consistentes, en lugar de un esfuerzo enfocado de una sola vez.  Los ecos de las decisiones tomadas una vez y alcanzadas en las primeras etapas de los compromisos a√∫n se hacen sentir en el sistema actual, y este siempre ha sido el caso en todas las etapas.  Tal enfoque evolutivo tiene sus pros y sus contras: requiere un m√≠nimo de esfuerzo en cualquier etapa, sin embargo, tarde o temprano existe el riesgo de detenerse.  Es importante seguir la direcci√≥n de su desarrollo para poder enviarlo en una buena direcci√≥n a tiempo. <br><br><h3>  El futuro </h3><br>  La infraestructura de Reddit deber√≠a estar lista para el apoyo continuo del equipo a medida que crece y lanza cosas nuevas.  La tasa de crecimiento de la empresa es m√°s r√°pida que nunca, y estamos trabajando en proyectos a√∫n m√°s interesantes y a gran escala que todos los que hicimos antes.  Los problemas que enfrentamos hoy son de doble naturaleza: por un lado, es la necesidad de aumentar la autonom√≠a de los desarrolladores, por otro lado, para mantener la seguridad de la infraestructura de producci√≥n y mejorar el airbag, lo que permite a los desarrolladores realizar implementaciones de manera r√°pida y segura. <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><img src="https://habrastorage.org/files/4bd/bf6/597/4bdbf659775744b1bdbb4d8a00a0a980.png" alt="imagen"></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es404577/">https://habr.com/ru/post/es404577/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es404567/index.html">Editorial Peter. Venta de verano</a></li>
<li><a href="../es404569/index.html">Part√≠culas, antipart√≠culas y su aniquilaci√≥n.</a></li>
<li><a href="../es404571/index.html">Redes sociales: una nueva fuente seria de amenazas cibern√©ticas</a></li>
<li><a href="../es404573/index.html">Ganar el "monstruo matem√°tico": no se trata de n√∫meros, sino de aprender a pensar</a></li>
<li><a href="../es404575/index.html">La IA de Microsoft rompi√≥ el r√©cord de un hombre con la Sra. Pac-man</a></li>
<li><a href="../es404579/index.html">Polybius ICO recaud√≥ $ 20 millones en dos semanas</a></li>
<li><a href="../es404583/index.html">Facebook est√° experimentando con un bot que puede regatear y mentir</a></li>
<li><a href="../es404585/index.html">Como nosotros en el pueblo de la caba√±a proporcionamos Internet</a></li>
<li><a href="../es404587/index.html">Ficci√≥n y fantas√≠a en dos a√±os y medio, casi cien buenos libros.</a></li>
<li><a href="../es404589/index.html">World of Drones: desde dispositivos port√°tiles hasta anti-UAV</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>