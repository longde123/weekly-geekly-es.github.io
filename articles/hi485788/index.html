<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>тЬ┤я╕П ЁЯСйЁЯП╜тАНЁЯПн ЁЯСйЁЯП╗тАНЁЯОи рдЯреНрд░рд╛рдВрд╕реЗрдХреНрд╢рдирд▓ NTFS рдХреЗ рд╕рд╛рде рдХрд┐рд╕реА рднреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХрд╛ рдХрд╛рдо рдХреИрд╕реЗ рдХрд░реЗрдВ: рд╡рд┐рдВрдбреЛрдЬ рдХреЗ рд▓рд┐рдП рд╕реИрдВрдбрдмреЙрдХреНрд╕ рд▓рд┐рдЦрдиреЗ рдХрд╛ рдореЗрд░рд╛ рдкрд╣рд▓рд╛ рдХрджрдо ЁЯЦЦ ЁЯФп ЁЯзФЁЯП┐</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="рд╡рд┐рдВрдбреЛрдЬ рдХрд░реНрдиреЗрд▓ рдореЗрдВ рдореЙрдбреНрдпреВрд▓ рдореЗрдВ рд╕реЗ рдПрдХ рдПрдХ рд▓реЗрдирджреЗрди рдХреЗ рд░реВрдк рдореЗрдВ рдЬреНрдЮрд╛рдд рдЗрдХрд╛рдИ рдореЗрдВ рдлрд╝рд╛рдЗрд▓ рд╕рдВрдЪрд╛рд▓рди рдХреЗ рдПрдХ рд╕реЗрдЯ рдХреЗ рд╕рдВрдпреЛрдЬрди рдХреЗ рд▓рд┐рдП рд╕рдорд░реНрдерди рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред рдбреЗрдЯрд╛рдмреЗрд╕ рдХреА рддрд░рд╣ ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>рдЯреНрд░рд╛рдВрд╕реЗрдХреНрд╢рдирд▓ NTFS рдХреЗ рд╕рд╛рде рдХрд┐рд╕реА рднреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХрд╛ рдХрд╛рдо рдХреИрд╕реЗ рдХрд░реЗрдВ: рд╡рд┐рдВрдбреЛрдЬ рдХреЗ рд▓рд┐рдП рд╕реИрдВрдбрдмреЙрдХреНрд╕ рд▓рд┐рдЦрдиреЗ рдХрд╛ рдореЗрд░рд╛ рдкрд╣рд▓рд╛ рдХрджрдо</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/485788/"><p><img src="https://habrastorage.org/webt/p0/-s/fi/p0-sfitxnzzpywfqxuc4arx1fps.png" align="right" alt="TransactionMaster">  рд╡рд┐рдВрдбреЛрдЬ рдХрд░реНрдиреЗрд▓ рдореЗрдВ рдореЙрдбреНрдпреВрд▓ рдореЗрдВ рд╕реЗ рдПрдХ рдПрдХ <strong>рд▓реЗрдирджреЗрди рдХреЗ</strong> рд░реВрдк рдореЗрдВ рдЬреНрдЮрд╛рдд рдЗрдХрд╛рдИ рдореЗрдВ рдлрд╝рд╛рдЗрд▓ рд╕рдВрдЪрд╛рд▓рди рдХреЗ рдПрдХ рд╕реЗрдЯ рдХреЗ рд╕рдВрдпреЛрдЬрди рдХреЗ рд▓рд┐рдП рд╕рдорд░реНрдерди рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред  рдбреЗрдЯрд╛рдмреЗрд╕ рдХреА рддрд░рд╣ рд╣реА, рдпреЗ рдЗрдХрд╛рдЗрдпрд╛рдВ <em>рдЕрд▓рдЧ</em> - <em>рдерд▓рдЧ</em> рдФрд░ <em>рдкрд░рдорд╛рдгреБ рд╣реИрдВ</em> ред  рдЖрдк рдлрд╝рд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рдХреБрдЫ рдмрджрд▓рд╛рд╡ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рддрдм рддрдХ рдмрд╛рд╣рд░ рджрд┐рдЦрд╛рдИ рдирд╣реАрдВ рджреЗрдЧрд╛ рдЬрдм рддрдХ рдЖрдк рдЙрдиреНрд╣реЗрдВ <em>рдкреНрд░рддрд┐рдмрджреНрдз рдирд╣реАрдВ</em> рдХрд░рддреЗред  рдпрд╛, рдПрдХ рд╡рд┐рдХрд▓реНрдк рдХреЗ рд░реВрдк рдореЗрдВ, рдЖрдк рд╣рдореЗрд╢рд╛ рд╕рдм рдХреБрдЫ <em>рд░реЛрд▓рдмреИрдХ</em> рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  рдХрд┐рд╕реА рднреА рдорд╛рдорд▓реЗ рдореЗрдВ, рдЖрдк рдПрдХ рдкреВрд░реЗ рдХреЗ рд░реВрдк рдореЗрдВ рд╕рдВрдЪрд╛рд▓рди рдХреЗ рд╕рдореВрд╣ рдкрд░ рдХрд╛рд░реНрдп рдХрд░рддреЗ рд╣реИрдВред  рд╕реЙрдлреНрдЯрд╡реЗрдпрд░ рд╕реНрдерд╛рдкрд┐рдд рдХрд░рддреЗ рд╕рдордп рдпрд╛ рд╣рдорд╛рд░реЗ рд╕рд┐рд╕реНрдЯрдо рдХреЛ рдЕрдкрдбреЗрдЯ рдХрд░рддреЗ рд╕рдордп, <em>рдирд┐рд░рдВрддрд░рддрд╛</em> рдмрдирд╛рдП рд░рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдХреНрдпрд╛ рд╕рд╣реА рд╣реИ?  рдЕрдЧрд░ рдХреБрдЫ рдЧрд▓рдд рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ - рдЗрдВрд╕реНрдЯреЙрд▓рд░ рдпрд╛ рдпрд╣рд╛рдВ рддрдХ тАЛтАЛрдХрд┐ рдкреВрд░рд╛ рд╕рд┐рд╕реНрдЯрдо рдХреНрд░реИрд╢ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ - рд▓реЗрдирджреЗрди рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рд╡рд╛рдкрд╕ рдЖ рдЬрд╛рддрд╛ рд╣реИред </p><br><p>  рдкрд╣рд▓реА рдмрд╛рд░ рдореИрдВрдиреЗ рдЗрд╕ рдЕрд╡рд┐рд╢реНрд╡рд╕рдиреАрдп рддрдВрддреНрд░ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдПрдХ рд▓реЗрдЦ рджреЗрдЦрд╛, рдореИрдВ рд╣рдореЗрд╢рд╛ рд╕реЛрдЪрддрд╛ рдерд╛ рдХрд┐ рджреБрдирд┐рдпрд╛ рдЕрдВрджрд░ рд╕реЗ рдХреИрд╕реА рд╣реЛрдЧреАред  рдФрд░ рдЖрдкрдХреЛ рдкрддрд╛ рд╣реИ рдХреНрдпрд╛?  рдореИрдВрдиреЗ рдкреВрд░реНрд╡рдирд┐рд░реНрдзрд╛рд░рд┐рдд рд▓реЗрдирджреЗрди рдХреЗ рднреАрддрд░ рдХрд┐рд╕реА рднреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рд╕рдВрдЪрд╛рд▓рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдордЬрдмреВрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдПрдХ рдЕрджреНрднреБрдд рджреГрд╖реНрдЯрд┐рдХреЛрдг рдХреА рдЦреЛрдЬ рдХреА, <del>  рдЬрд┐рд╕рдореЗрдВ рдпрд╣ рдорд╛рд░реНрдЬрд┐рди рд╢рд╛рдорд┐рд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмрд╣реБрдд рд╕рдВрдХреАрд░реНрдг рд╣реИ </del>  ред  рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдЬреНрдпрд╛рджрд╛рддрд░ рд╕рдордп, рдЗрд╕реЗ рдкреНрд░рд╢рд╛рд╕рдирд┐рдХ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреА рднреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реЛрддреА рд╣реИред </p><br><p>  рдЪрд▓реЛ рдлрд┐рд░ рд╡рд┐рдВрдбреЛрдЬ рдЗрдВрдЯрд░реНрдирд▓ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдмрд╛рдд рдХрд░рддреЗ рд╣реИрдВ, рдПрдХ рдирдпрд╛ рдЯреВрд▓ рдЖрдЬрд╝рдорд╛рддреЗ рд╣реИрдВ, рдФрд░ рдПрдХ рд╕рд╡рд╛рд▓ рдХрд╛ рдЬрд╡рд╛рдм рджреЗрддреЗ рд╣реИрдВ: рд╕реИрдВрдбрдмреЙрдХреНрд╕ рдХреЗ рд╕рд╛рде рдЗрд╕рдХрд╛ рдХреНрдпрд╛ рдХрд░рдирд╛ рд╣реИ? </p><a name="habracut"></a><br><h2 id="repository">  рдХреЛрд╖ </h2><br><p>  рдЬреЛ рд▓реЛрдЧ рдЕрднреА рд╕реЗ рдкреНрд░рдпреЛрдЧ рдХрд░рдирд╛ рд╢реБрд░реВ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рд╡реЗ GitHub: <a href="https://github.com/diversenok/TransactionMaster">TransactionMaster</a> рдкрд░ рдкрд░рд┐рдпреЛрдЬрдирд╛ рдХреЗ рдкреГрд╖реНрда рдкрд░ рд╕реНрд╡рд╛рдЧрдд рдХрд░рддреЗ рд╣реИрдВред </p><br><h2 id="theory">  рд╕рд┐рджреНрдзрд╛рдВрдд </h2><br><p>  Windows Vista рдореЗрдВ рдЯреНрд░рд╛рдВрд╕реЗрдХреНрд╢рдирд▓ NTFS, рдЬрд┐рд╕реЗ <strong>TxF рдХреЗ</strong> рд░реВрдк рдореЗрдВ рднреА рдЬрд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ, рдХрд╛ рдкрд░рд┐рдЪрдп, рд╕рд┐рд╕реНрдЯрдо рд╕реНрдерд┐рд░рддрд╛ рдмрдирд╛рдП рд░рдЦрдиреЗ рдФрд░ рдЗрд╕рд▓рд┐рдП, рд╕реНрдерд┐рд░рддрд╛ рдХреА рджрд┐рд╢рд╛ рдореЗрдВ рдПрдХ рдХреНрд░рд╛рдВрддрд┐рдХрд╛рд░реА рдХрджрдо рдерд╛ред  рдбреЗрд╡рд▓рдкрд░реНрд╕ рдХреЗ рд▓рд┐рдП рд╕реАрдзреЗ рдЗрд╕ рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдХреЛ рдЙрдЬрд╛рдЧрд░ рдХрд░рдХреЗ, Microsoft рдиреЗ рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ рдХреЛ рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдФрд░ рдЕрджреНрдпрддрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЬрд┐рдореНрдореЗрджрд╛рд░ рд╕рднреА рдШрдЯрдХреЛрдВ рдореЗрдВ рдирд╛рдЯрдХреАрдп рд░реВрдк рд╕реЗ рддреНрд░реБрдЯрд┐ рдХреЛ рд╕рд░рд▓ рдмрдирд╛рдирд╛ рд╕рдВрднрд╡ рдмрдирд╛ рджрд┐рдпрд╛ред  рд╕рднреА рд╕рдВрднрд╡ рдлрд╝рд╛рдЗрд▓-рд╕рд┐рд╕реНрдЯрдо рд╡рд┐рдлрд▓рддрд╛рдУрдВ рдХреЗ рд▓рд┐рдП рдПрдХ рдмреИрдХрдЕрдк рдпреЛрдЬрдирд╛ рдмрдирд╛рдП рд░рдЦрдиреЗ рдХрд╛ рдХрд╛рд░реНрдп рдЦреБрдж рдУрдПрд╕ рдХрд╛ рдХрд╛рдо рдмрди рдЧрдпрд╛, рдЬрд┐рд╕рдиреЗ рдорд╛рдВрдЧ рдкрд░ рдПрдХ рдкреВрд░реНрдг-рд╡рд┐рд╢реЗрд╖рддрд╛рдУрдВ рд╡рд╛рд▓реЗ <a href="https://en.wikipedia.org/wiki/ACID"><abbr title="рдкрд░рдорд╛рдгреБ, рд╕рдВрдЧрддрд┐, рдЕрд▓рдЧрд╛рд╡, рд╕реНрдерд╛рдпрд┐рддреНрд╡">рдПрд╕реАрдЖрдИрдбреА</abbr> рд╢рдмреНрджрд╛рд░реНрде</a> рдкреНрд░рджрд╛рди рдХрд░рдирд╛ рд╢реБрд░реВ рдХрд░ рджрд┐рдпрд╛ред </p><br><p> рдЗрд╕ рдирдП рдЙрдкрдХрд░рдг рдХреЛ рдкреНрд░рджрд╛рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, Microsoft рдиреЗ API рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдПрдХ рд╕реЗрдЯ рдкреЗрд╢ рдХрд┐рдпрд╛, рдЬреЛ рдореМрдЬреВрджрд╛ рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдХреЛ рджреЛрд╣рд░рд╛рддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рд▓реЗрдирджреЗрди рдХреЗ рд╕рдВрджрд░реНрдн рдореЗрдВред  рд▓реЗрди-рджреЗрди рдЕрдкрдиреЗ рдЖрдк рдореЗрдВ рдПрдХ рдирдИ рдХрд░реНрдиреЗрд▓ рдСрдмреНрдЬреЗрдХреНрдЯ рдмрди рдЧрдИ рд╣реИ, рдЬреЛ рдореМрдЬреВрджрд╛ рдлрд╝рд╛рдЗрд▓реЛрдВ рдЬреИрд╕реЗ рдлрд╛рдЗрд▓реЛрдВ, рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдФрд░ рд╕рд┐рдВрдХреНрд░рдирд╛рдЗрдЬрд╝реЗрд╢рди рдкреНрд░рд╛рдЗрдорд░реА рдХреЗ рд╕рд╛рде рд╣реИред  рд╕рд░рд▓рддрдо рдкрд░рд┐рджреГрд╢реНрдп рдореЗрдВ, рдЕрдиреБрдкреНрд░рдпреЛрдЧ <a href="https://docs.microsoft.com/en-us/windows/win32/api/ktmw32/nf-ktmw32-createtransaction"><code>CreateTransaction</code></a> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рдирдпрд╛ рд▓реЗрдирджреЗрди рдмрдирд╛рддрд╛ рд╣реИ, рдЖрд╡рд╢реНрдпрдХ рдСрдкрд░реЗрд╢рди ( <a href="https://docs.microsoft.com/en-us/windows/win32/api/winbase/nf-winbase-createfiletransactedw"><code>CreateFileTransacted</code></a> , <a href="https://docs.microsoft.com/en-us/windows/win32/api/winbase/nf-winbase-movefiletransactedw"><code>MoveFileTransacted</code></a> , <a href="https://docs.microsoft.com/en-us/windows/win32/api/winbase/nf-winbase-deletefiletransactedw"><code>DeleteFileTransacted</code></a> , рдЖрджрд┐) рдХрд░рддрд╛ рд╣реИ, рдФрд░ рдлрд┐рд░ <a href="https://docs.microsoft.com/en-us/windows/win32/api/ktmw32/nf-ktmw32-createtransaction"><code>CreateTransaction</code></a> / <a href="https://docs.microsoft.com/en-us/windows/win32/api/ktmw32/nf-ktmw32-createtransaction"><code>CreateTransaction</code></a> рд╕рд╛рде рдЗрд╕реЗ рд╡рд╛рдкрд╕ рдХрд░рддрд╛ рдпрд╛ рд░реЛрд▓ рдХрд░рддрд╛ рд╣реИред </p><br><p>  рдЖрдЗрдП рдЗрди рдирдП рдХрд╛рд░реНрдпреЛрдВ рдХреА рд╡рд╛рд╕реНрддреБрдХрд▓рд╛ рдкрд░ рдПрдХ рдирдЬрд╝рд░ рдбрд╛рд▓реЗрдВред  рд╣рдо рдЬрд╛рдирддреЗ рд╣реИрдВ, рдХрд┐ <code>kernel32.dll</code> рдЬреИрд╕реЗ рдкреБрд╕реНрддрдХрд╛рд▓рдпреЛрдВ рдХреА рдЖрдзрд┐рдХрд╛рд░рд┐рдХ рдПрдкреАрдЖрдИ рдкрд░рдд рд╕реАрдзреЗ рдХрд░реНрдиреЗрд▓ рдХреЛ рдирд╣реАрдВ рдмреБрд▓рд╛рддреА рд╣реИ, рд▓реЗрдХрд┐рди рдорд╛рдкрджрдВрдбреЛрдВ рдХреЛ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рдХрд░рддреА рд╣реИ рдФрд░ рдЗрд╕рдХреЗ рдмрдЬрд╛рдп <code>ntdll.dll</code> рдХреЛ рдХреЙрд▓ рдХрд░рддреА рд╣реИред  рдЬреЛ рддрдм, рдПрдХ syscall рдЬрд╛рд░реА рдХрд░рддрд╛ рд╣реИред  рд╣реИрд░рд╛рдиреА рдХреА рдмрд╛рдд <u>рдпрд╣ рд╣реИ рдХрд┐ рдХреЙрд▓ рдХреЗ <strong>рдПрдирдбреАрдЯреАрдПрд▓</strong> рдФрд░ рдХрд░реНрдиреЗрд▓ рджреЛрдиреЛрдВ рддрд░рдл рдХрд┐рд╕реА рднреА рдЕрддрд┐рд░рд┐рдХреНрдд- <em>рдЯреНрд░рд╛рдВрд╕рдПрдХреНрдЯреЗрдб</em> рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдХреЛрдИ рд╕рдВрдХреЗрдд рдирд╣реАрдВ рд╣реИред</u> </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/hh/1f/pd/hh1fpdvbzuerpebayexmhpn1xui.png" alt="рдПрдкреАрдЖрдИ рдкрд░рддреЛрдВ"></div><br><p>  рдЗрди рдореВрд▓ API рдлрд╝рдВрдХреНрд╢рди рдХреА рдкрд░рд┐рднрд╛рд╖рд╛ рджрд╢рдХреЛрдВ рдореЗрдВ рдирд╣реАрдВ рдмрджрд▓реА рд╣реИ, рдЗрд╕рд▓рд┐рдП рд▓реЗрдирджреЗрди рдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреЛрдИ рдЕрддрд┐рд░рд┐рдХреНрдд рдкреИрд░рд╛рдореАрдЯрд░ рдирд╣реАрдВ рд╣реИред  рдХрд░реНрдиреЗрд▓ рдХреЛ рдХреИрд╕реЗ рдкрддрд╛ рдЪрд▓рддрд╛ рд╣реИ рдХрд┐ рдХрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╣реИ?  рдЬрд╡рд╛рдм рд╕рд░рд▓ рд╣реИ, рдлрд┐рд░ рднреА рдЖрд╢рд╛рдЬрдирдХ рд╣реИ: рдкреНрд░рддреНрдпреЗрдХ рдереНрд░реЗрдб рдореЗрдВ рдПрдХ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдлрд╝реАрд▓реНрдб рд╣реИ, рдЬрд╣рд╛рдВ рдпрд╣ рд╡рд░реНрддрдорд╛рди рд▓реЗрдирджреЗрди рдХреЛ рд╕рдВрднрд╛рд▓рддрд╛ рд╣реИред  рдпрд╣ рдЪрд░ TEB - рдереНрд░реЗрдб рдПрдирд╡рд╛рдпрд░реНрдирдореЗрдВрдЯрд▓ рдмреНрд▓реЙрдХ рдирд╛рдордХ рдореЗрдореЛрд░реА рдХреЗ рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдХреНрд╖реЗрддреНрд░ рдореЗрдВ рд░рд╣рддрд╛ рд╣реИред  рдпрд╣рд╛рдБ рдкрд░ рд╕реНрдерд┐рдд рдЕрдиреНрдп рдкреНрд░рд╕рд┐рджреНрдз рдХреНрд╖реЗрддреНрд░реЛрдВ рдХреЗ рд▓рд┐рдП, рдореИрдВ <a href="https://docs.microsoft.com/en-us/windows/win32/api/errhandlingapi/nf-errhandlingapi-getlasterror">рдЕрдВрддрд┐рдо рддреНрд░реБрдЯрд┐ рдХреЛрдб</a> рдФрд░ <a href="https://docs.microsoft.com/en-us/windows/win32/api/processthreadsapi/nf-processthreadsapi-getcurrentthreadid">рдереНрд░реЗрдб рдЖрдИрдбреА</a> рдХреЛ рдирд╛рдо рджреЗ рд╕рдХрддрд╛ рд╣реВрдБред </p><br><p>  рдЗрд╕рд▓рд┐рдП, <em>-Transacted</em> рдкреНрд░рддреНрдпрдп рдХреЗ рд╕рд╛рде рд╕рднреА рдлрд╝рдВрдХреНрд╢рди TEB рдореЗрдВ рд╡рд░реНрддрдорд╛рди рд▓реЗрдирджреЗрди рдлрд╝реАрд▓реНрдб рд╕реЗрдЯ рдХрд░рддреЗ рд╣реИрдВ, рд╕рдВрдмрдВрдзрд┐рдд рдЧреИрд░-рдЯреНрд░рд╛рдВрдЬрд╝реИрдХреНрдб API рдХреЛ рдХреЙрд▓ рдХрд░рддреЗ рд╣реИрдВ, рдФрд░ рдкрд┐рдЫрд▓реЗ рдорд╛рди рдХреЛ рдкреБрдирд░реНрд╕реНрдерд╛рдкрд┐рдд рдХрд░рддреЗ рд╣реИрдВред  рдЗрд╕ рд▓рдХреНрд╖реНрдп рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╡реЗ <a href=""><code>RtlSetCurrentTransaction</code></a> рд╕реЗ <code>ntdll</code> / <a href=""><code>RtlSetCurrentTransaction</code></a> рдирд╛рдордХ рдмрд╣реБрдд рд╕реАрдзреЗ рд░реВрдЯреАрди рдХреА рдПрдХ рдЬреЛрдбрд╝реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред  рд╡реЗ рдЕрдореВрд░реНрддрддрд╛ рдХрд╛ рдПрдХ рдкрд░реНрдпрд╛рдкреНрдд рд╕реНрддрд░ рдкреНрд░рджрд╛рди рдХрд░рддреЗ рд╣реИрдВ, рдЬреЛ рдХрд┐ рдмрд╛рдж рдореЗрдВ рдФрд░ рдЕрдзрд┐рдХ, <abbr title="рд╡рд┐рдВрдбреЛрдЬ-рдСрди-рд╡рд┐рдВрдбреЛрдЬ 64-рдмрд┐рдЯ">рд╡рд╛рд╣</abbr> рдХреЗ рдорд╛рдорд▓реЗ рдореЗрдВ рдХрд╛рдо рдЖрддрд╛ рд╣реИред </p><br><p>  рд╣рдорд╛рд░реЗ рд▓рд┐рдП рдЗрд╕рдХрд╛ рдХреНрдпрд╛ рдорддрд▓рдм рд╣реИ?  <strong>рдореЗрдореЛрд░реА рдореЗрдВ рдПрдХ рдЪрд░ рдХреЛ рдмрджрд▓рдХрд░, рд╣рдо рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЬрд┐рд╕рдХреЗ рд╕рдВрджрд░реНрдн рдореЗрдВ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдлрд╝рд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рддрдХ рдкрд╣реБрдВрдЪ рдкреНрд░рд╛рдкреНрдд рдХрд░рддреА рд╣реИред</strong>  рдХрд┐рд╕реА рднреА рд╣реБрдХ рдпрд╛ рдХрд░реНрдиреЗрд▓-рдореЛрдб рдХреЙрд▓рдмреИрдХ рдХреЛ рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ, рд╣рдо рд╕рднреА рдХреЛ рд▓рдХреНрд╖реНрдп рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рд╣реИрдВрдбрд▓ рд╡рд┐рддрд░рд┐рдд рдХрд░рдиреЗ рдФрд░ рдкреНрд░рддреНрдпреЗрдХ рдереНрд░реЗрдб рдкреНрд░рддрд┐ рдореЗрдореЛрд░реА рдХреЗ рдмрд╛рдЗрдЯреНрд╕ рдХреЗ рдПрдХ рдЬреЛрдбрд╝реЗ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред  рдЖрд╢реНрдЪрд░реНрдпрдЬрдирдХ рд░реВрдк рд╕реЗ рдЖрд╕рд╛рди рд▓рдЧрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдкрд░рд┐рдгрд╛рдо рдЖрд╢реНрдЪрд░реНрдпрдЬрдирдХ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП! </p><br><h2 id="pitfalls">  рдиреБрдХрд╕рд╛рди </h2><br><p>  рдкрд╣рд▓реЗ рдХрд╛рдо рдХрд░рдиреЗ рдХреА рдЕрд╡рдзрд╛рд░рдгрд╛ рдиреЗ рдХрдИ рдЕрдЬреАрдм рд╡рд┐рд╡рд░рдгреЛрдВ рдХрд╛ рдЦреБрд▓рд╛рд╕рд╛ рдХрд┐рдпрд╛ред  рдореЗрд░реЗ рдорд╣рд╛рди рдкреНрд░рд╕рдиреНрдирддрд╛ рдХреЗ рд▓рд┐рдП, <a href="https://farmanager.com/index.php%3Fl%3Den">рд╕реБрджреВрд░ рдкреНрд░рдмрдВрдзрдХ</a> , рдЬрд┐рд╕реЗ рдореИрдВ рд╡рд┐рдВрдбреЛрдЬ рдПрдХреНрд╕рдкреНрд▓реЛрд░рд░ рдХреЗ рдкреНрд░рддрд┐рд╕реНрдерд╛рдкрди рдХреЗ рд░реВрдк рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реВрдВ, рд▓реЗрдирджреЗрди рд╣реЙрдЯ-рд╕реНрд╡рд┐рдЪрд┐рдВрдЧ рдХреЗ рд╕рд╛рде рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдареАрдХ рд╣реИред  рд▓реЗрдХрд┐рди рдореИрдВрдиреЗ рдХреБрдЫ рдХрд╛рд░реНрдпрдХреНрд░рдореЛрдВ рдХреЛ рднреА рджреЗрдЦрд╛, рдЬрд┐рд╕ рдкрд░ рдлрд╝рд╛рдЗрд▓ рд╕рдВрдЪрд╛рд▓рди рдХреЗ рд▓рд┐рдП рдирдП рд╕реВрддреНрд░ рдмрдирд╛рдиреЗ рдХреЗ рдмрд╛рдж рд╕реЗ рдореЗрд░реА рд╡рд┐рдзрд┐ рдкрд░ рдЕрдкреЗрдХреНрд╖рд┐рдд рдкреНрд░рднрд╛рд╡ рдирд╣реАрдВ рдкрдбрд╝рд╛ред  рджреНрд╡рд┐рддреАрдп рд╢реНрд░реЗрдгреА рдХреЗ рдкреНрд░рддрд┐рдирд┐рдзрд┐ рдХрд╛ рдПрдХ рдЙрджрд╛рд╣рд░рдг <a href="https://github.com/microsoft/winfile">WinFile рд╣реИ</a> ред  рдПрдХ рдЕрдиреБрд╕реНрдорд╛рд░рдХ рдХреЗ рд░реВрдк рдореЗрдВ, рд╡рд░реНрддрдорд╛рди рд▓реЗрдирджреЗрди рдкреНрд░рддрд┐-рдереНрд░реЗрдб рд╕реБрд╡рд┐рдзрд╛ рд╣реИред  рдкреНрд░рд╛рд░рдВрдн рдореЗрдВ, рдпрд╣ рдСрдкрд░реЗрд╢рди рдХреА рд╕рдордп-рд╕рдВрд╡реЗрджрдирд╢реАрд▓рддрд╛ рдХреЛ рджреЗрдЦрддреЗ рд╣реБрдП рдереНрд░реЗрдб рдХреНрд░рд┐рдПрд╢рди рдЖрдЙрдЯ-рдСрдл-рдкреНрд░реЛрд╕реЗрд╕ рдкрд░ рдирдЬрд╝рд░ рд░рдЦрдиреЗ рдХреЗ рдмрд╛рдж рд╕реЗ рдкреНрд▓реЙрдЯ рдореЗрдВ рдЫреЗрдж рдерд╛ред </p><br><h3 id="thread-tracking-dll">  рдереНрд░реЗрдб-рдЯреНрд░реИрдХрд┐рдВрдЧ рдбреАрдПрд▓ </h3><br><p>  рд╕реМрднрд╛рдЧреНрдп рд╕реЗ, рдереНрд░реЗрдб рдирд┐рд░реНрдорд╛рдг рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рддреБрд▓реНрдпрдХрд╛рд▓рд┐рдХ рд╕реВрдЪрдирд╛рдПрдВ рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ рд▓рдХреНрд╖реНрдп рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рд╕рдВрджрд░реНрдн рдореЗрдВ рдмреЗрд╣рдж рд╕рд░рд▓ рд╣реИред  рд╣рдореЗрдВ рдмрд╕ рдПрдХ рдбреАрдПрд▓рдПрд▓ рдХреЛ рддреИрдпрд╛рд░ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдЬреЛ рд╡рд░реНрддрдорд╛рди рд▓реЗрдирджреЗрди рдХреЛ рдирдП рдереНрд░реЗрдбреНрд╕ рдореЗрдВ рдкреНрд░рд╕рд╛рд░рд┐рдд рдХрд░рддрд╛ рд╣реИ, <code>ntdll</code> рд╕реЗ рдореЙрдбреНрдпреВрд▓ рд▓реЛрдбрд░ рдмрд╛рдХреА рдХреЛ рд╕рдВрднрд╛рд▓ рд▓реЗрдЧрд╛ред  рд╣рд░ рдмрд╛рд░ <b>*</b> рдПрдХ рдирдпрд╛ рдзрд╛рдЧрд╛ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдВ рдЖрддрд╛ рд╣реИ, рдпрд╣ <a href="https://docs.microsoft.com/en-us/windows/win32/dlls/dllmain"><code>DLL_THREAD_ATTACH</code></a> рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рд╕рд╛рде рд╣рдорд╛рд░реЗ рдкреНрд░рд╡реЗрд╢-рдмрд┐рдВрджреБ рдХреЛ рдЯреНрд░рд┐рдЧрд░ рдХрд░реЗрдЧрд╛ред  рдЗрд╕ рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдХреЗ, рдореИрдВрдиреЗ рд╡рд┐рднрд┐рдиреНрди рдХрд╛рд░реНрдпрдХреНрд░рдореЛрдВ рдХреЗ рдПрдХ рдкреВрд░реЗ рд╕рдореВрд╣ рдХреЗ рд╕рд╛рде рд╕рдВрдЧрддрддрд╛ рддрдп рдХреАред </p><br><p>  <strong>*</strong> рдХрдбрд╝рд╛рдИ рд╕реЗ рдмреЛрд▓рддреЗ рд╣реБрдП, рдпрд╣ рдХреЙрд▓рдмреИрдХ рд╣рд░ рд╕рдВрднрд╡ рд╕реНрдерд┐рддрд┐ рдореЗрдВ рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИред  рдЕрдм рдФрд░ рдлрд┐рд░, рдЖрдк рдПрдХ рдпрд╛ рджреЛ рд╕рд╣рд╛рдпрдХ рдереНрд░реЗрдбреНрд╕ рдХреЛ рд▓реЗрди-рджреЗрди рдХреЗ рдмрд┐рдирд╛ рдЪрд╛рд░реЛрдВ рдУрд░ рд▓рдЯрдХрд╛ рджреЗрдЦреЗрдВрдЧреЗред  рдЬреНрдпрд╛рджрд╛рддрд░ рд╕рдордп, рдпреЗ рдореЙрдбреНрдпреВрд▓ рд▓реЛрдбрд░ рдХреЗ рдХрд╛рдо рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдкреВрд▓ рд╕реЗ рд╣реА рдереНрд░реЗрдб рд╣реЛрддреЗ рд╣реИрдВред  рдЗрд╕рдХрд╛ рдХрд╛рд░рдг, рдбреАрдПрд▓рдПрд▓ рдиреЛрдЯрд┐рдлрд┐рдХреЗрд╢рди <em>рд▓реЛрдбрд░ рд▓реЙрдХ рдХреЗ</em> рддрд╣рдд рд╣реЛрддрд╛ рд╣реИ, рдЬреЛ рд╡рд┐рднрд┐рдиреНрди рдореЙрдбреНрдпреВрд▓ рдХреЛ рд▓реЛрдб рдХрд░рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рд╕рд╣рд┐рдд рдХрдИ рдкреНрд░рдХрд╛рд░ рдХреА рд╕реАрдорд╛рдУрдВ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рддрд╛ рд╣реИред  рдФрд░ рдпрд╣ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдХреНрдпрд╛ рдЗрд╕ рддрд░рд╣ рдХреЗ рдзрд╛рдЧреЗ рдХреЛ рдкреВрд░рд╛ рдХрд░рдиреЗ рдХреА рдЬрд░реВрд░рдд рд╣реИ, рдЗрд╕ рдмреАрдЪ рдлрд╝рд╛рдЗрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рд╕рдорд╛рдирд╛рдВрддрд░ред  рдЗрд╕рд▓рд┐рдП, рдбреЗрдбрд▓реЙрдХ рдХреЛ рд░реЛрдХрдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЕрдкрд╡рд╛рдж рдореМрдЬреВрдж рд╣реИ: рдпрджрд┐ рдХреЙрд▓рд░ <a href=""><code>THREAD_CREATE_FLAGS_SKIP_THREAD_ATTACH</code></a> рдХреА рдорджрдж рд╕реЗ рдереНрд░реЗрдб рдмрдирд╛рддреЗ рд╕рдордп <a href=""><code>THREAD_CREATE_FLAGS_SKIP_THREAD_ATTACH</code></a> рдзреНрд╡рдЬ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рддрд╛ рд╣реИ, рддреЛ DLL- рд╕реВрдЪрдирд╛ рдХреЙрд▓рдмреИрдХ рдЯреНрд░рд┐рдЧрд░ рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИред </p><br><h3 id="starting-windows-explorer">  рд╡рд┐рдВрдбреЛрдЬ рдПрдХреНрд╕рдкреНрд▓реЛрд░рд░ рд╢реБрд░реВ рдХрд░рдирд╛ </h3><br><p>  рджреБрд░реНрднрд╛рдЧреНрдп рд╕реЗ, рдЕрднреА рднреА рдХреБрдЫ рдХрд╛рд░реНрдпрдХреНрд░рдо рдмрд╛рдХреА рд╣реИрдВ рдЬреЛ рд▓реЗрдирджреЗрди рдХреЛ рдЕрдЪреНрдЫреА рддрд░рд╣ рд╕реЗ рд╕реНрд╡рд┐рдЪ рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рдирд╣реАрдВ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ, рдФрд░ рд╡рд┐рдВрдбреЛрдЬ рдПрдХреНрд╕рдкреНрд▓реЛрд░рд░ рдЙрдирдореЗрдВ рд╕реЗ рдПрдХ рд╣реИред  рдореИрдВ рд╕рдорд╕реНрдпрд╛ рдХрд╛ рдирд┐рджрд╛рди рдирд╣реАрдВ рдХрд░ рд╕рдХрддрд╛ред  рдпрд╣ рдПрдХ рдЬрдЯрд┐рд▓ рдЕрдиреБрдкреНрд░рдпреЛрдЧ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдЖрдорддреМрд░ рдкрд░ рдмрд╣реБрдд рд╕рд╛рд░реЗ рд╣реИрдВрдбрд▓ рдЦреЛрд▓реЗ рдЬрд╛рддреЗ рд╣реИрдВ, рдФрд░ рдпрджрд┐ рд▓реЗрди-рджреЗрди рдХрд╛ рд╕рдВрджрд░реНрдн рдЙрдирдореЗрдВ рд╕реЗ рдХреБрдЫ рдХреЛ рдЕрдорд╛рдиреНрдп рдХрд░рддрд╛ рд╣реИ, рддреЛ рдЗрд╕рдХрд╛ рдкрд░рд┐рдгрд╛рдо рдХреНрд░реИрд╢ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред  рд╡реИрд╕реЗ рднреА, рдЗрд╕ рддрд░рд╣ рдХреА рд╕рдорд╕реНрдпрд╛рдУрдВ рдХрд╛ рд╕рд╛рд░реНрд╡рднреМрдорд┐рдХ рд╕рдорд╛рдзрд╛рди рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣реИ рдХрд┐ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдЙрд╕реА рд╕рдВрджрд░реНрдн рдореЗрдВ рд╕реБрд╕рдВрдЧрдд рд╕рдВрджрд░реНрдн рдХреЗ рднреАрддрд░ рдЪрд▓рддреА рд╣реИ, рдЬрд┐рд╕ рдкрд░ рд╡рд╣ рдкрд╣рд▓реЗ рд╕реЗ рд▓рд╛рдЧреВ рд╣реЛрддреА рд╣реИред </p><br><p>  рдЗрд╕ рдкреНрд░рдХрд╛рд░, рдореИрдВрдиреЗ рдПрдХ рдирдИ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдмрдирд╛рддреЗ рд╕рдордп рддреБрд░рдВрдд DLL рдЗрдВрдЬреЗрдХреНрд╢рди рдХрд░рдиреЗ рдХрд╛ рд╡рд┐рдХрд▓реНрдк рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ред  рдФрд░ рдпрд╣ рджреБрд░реНрдШрдЯрдирд╛рдЧреНрд░рд╕реНрдд рд╣реЛрдиреЗ рдХреЛ рдареАрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкрд░реНрдпрд╛рдкреНрдд рдирд┐рдХрд▓рд╛ред  рд╣рд╛рд▓рд╛рдБрдХрд┐, рдЪреВрдВрдХрд┐ рдПрдХреНрд╕рдкреНрд▓реЛрд░рд░ рдЧрд╣рди рд░реВрдк рд╕реЗ рдкреНрд░рдХреНрд░рд┐рдпрд╛ COM, рдкреВрд░реНрд╡рд╛рд╡рд▓реЛрдХрди, рдФрд░ рдХреБрдЫ рдЕрдиреНрдп рд╕реБрд╡рд┐рдзрд╛рдУрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ, рдЬреЛ рдЕрднреА рднреА рд╕рдВрд╢реЛрдзрд┐рдд рдлрд╝рд╛рдЗрд▓реЛрдВ рдкрд░ рдХрд╛рдо рдирд╣реАрдВ рдХрд░рддреЗ рд╣реИрдВред </p><br><h3 id="what-about-wow64">  WoW64 рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдХреНрдпрд╛? </h3><br><p>  рд╕рдВрдЧрддрддрд╛ рд▓рд╛рдн рдЬреЛ <em>рд╡рд┐рдВрдбреЛрдЬ-рдСрди-рд╡рд┐рдВрдбреЛрдЬ 64-рдмрд┐рдЯ</em> рд╕рдмрд╕рд┐рд╕реНрдЯрдо рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ, рдИрдорд╛рдирджрд╛рд░реА рд╕реЗ рдЙрд▓реНрд▓реЗрдЦрдиреАрдп рд╣реИред  рд╣рд╛рд▓рд╛рдБрдХрд┐, рд╕рд┐рд╕реНрдЯрдо рдХреА рдкреНрд░реЛрдЧреНрд░рд╛рдорд┐рдВрдЧ рдХреЗ рджреМрд░рд╛рди рдЗрд╕рдХреА рдмрд╛рд░реАрдХрд┐рдпреЛрдВ рдХреЛ рдзреНрдпрд╛рди рдореЗрдВ рд░рдЦрдирд╛ рдЕрдХреНрд╕рд░ рдердХрд╛рдК рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред  рдкрд╣рд▓реЗ рдореИрдВрдиреЗ рдЙрд▓реНрд▓реЗрдЦ рдХрд┐рдпрд╛ рдерд╛, рдХрд┐ <code>Rtl[Get/Set]CurrentTransaction</code> рдХрд╛ рд╡реНрдпрд╡рд╣рд╛рд░ рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рдереЛрдбрд╝рд╛ рдЕрдзрд┐рдХ рдЬрдЯрд┐рд▓ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред  рдЪреВрдВрдХрд┐ рдЗрд╕ рддрд░рд╣ рдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛рдПрдВ рдмрд╛рдХреА рдкреНрд░рдгрд╛рд▓реА рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рдмрд┐рдВрджреБрдУрдВ рдХреЗ рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдЖрдХрд╛рд░ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рддреА рд╣реИрдВ, рдкреНрд░рддреНрдпреЗрдХ WoW64 рдзрд╛рдЧрд╛ рдЗрд╕рдХреЗ рд╕рд╛рде рдЬреБрдбрд╝реЗ рджреЛ TEB рдХреЛ рдмрдирд╛рдП рд░рдЦрддрд╛ рд╣реИ: рдУрдПрд╕ рдЦреБрдж рд╣реА рдпрд╣ рдЙрдореНрдореАрдж рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдЙрд╕рдХреЗ рдкрд╛рд╕ 64-рдмрд┐рдЯ рдПрдХ рд╣реИ, рдФрд░ рдЖрд╡реЗрджрди рдХреЗ рд▓рд┐рдП 32-рдмрд┐рдЯ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рд╕рд╣реА рдврдВрдЧ рд╕реЗ рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред  рдФрд░ рдлрд┐рд░ рднреА, рдХрд░реНрдиреЗрд▓ рдХреЗ рджреГрд╖реНрдЯрд┐рдХреЛрдг рд╕реЗ, рджреЗрд╢реА TEB рдкреВрд░реНрд╡рддрд╛ рд▓реЗрддрд╛ рд╣реИ, рдЗрди рдХрд╛рд░реНрдпреЛрдВ рдореЗрдВ рдХреБрдЫ рдЕрддрд┐рд░рд┐рдХреНрдд рдХреЛрдб рд╣реЛрддрд╛ рд╣реИ рддрд╛рдХрд┐ рд╕рдВрдмрдВрдзрд┐рдд рдорд╛рди рд╣рдореЗрд╢рд╛ рдореЗрд▓ рдЦрд╛рддреЗ рд░рд╣реЗрдВред  рд╡реИрд╕реЗ рднреА, <a href="">рдирдИ рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рддреЗ рд╕рдордп</a> рдЗрди рд╕рднреА рд╡рд┐рд╢рд┐рд╖реНрдЯрддрд╛рдУрдВ рдХреЛ рдзреНрдпрд╛рди рдореЗрдВ рд░рдЦрдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИред </p><br><h3 id="unsolved-problems">  рдЕрдирд╕реБрд▓рдЭреА рд╕рдорд╕реНрдпрд╛рдПрдВ </h3><br><p>  рдпрд╣ рдЬрд┐рддрдирд╛ рджреБрдЦрдж рд╣реИ, рдкрд╣рд▓рд╛ рдЙрдкрдпреЛрдЧ рдкрд░рд┐рджреГрд╢реНрдп рдЬреЛ рд╣рдорд╛рд░реЗ рджрд┐рдорд╛рдЧ рдореЗрдВ рдЖрддрд╛ рд╣реИ - рдЗрд╕ рдореЛрдб рдореЗрдВ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдЗрдВрд╕реНрдЯреЙрд▓ рдХрд░рдирд╛ - рдЕрдм рдХреЗ рд▓рд┐рдП рдЕрдЪреНрдЫрд╛ рдХрд╛рдо рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИред  рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рдЗрдВрд╕реНрдЯреЙрд▓рд░ рдЕрдХреНрд╕рд░ рдкреВрд░рдХ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдПрдВ рдмрдирд╛рддреЗ рд╣реИрдВ, рдФрд░ рдореИрдВрдиреЗ рдЕрднреА рддрдХ рдПрдХ рд╣реА рд▓реЗрдирджреЗрди рдореЗрдВ рдмрд╛рд▓ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЛ рдХреИрдкреНрдЪрд░ рдХрд░рдиреЗ рдХреЛ рд▓рд╛рдЧреВ рдирд╣реАрдВ рдХрд┐рдпрд╛ рд╣реИред  рдореБрдЭреЗ рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рдХрдИ рддрд░реАрдХреЗ рджрд┐рдЦрд╛рдИ рджреЗрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдЗрд╕рдореЗрдВ рдХреБрдЫ рд╕рдордп рд▓рдЧ рд╕рдХрддрд╛ рд╣реИред  рдПрдХ рдФрд░ рдмрдбрд╝реА рд╕рдорд╕реНрдпрд╛ рддрдм рдЙрддреНрдкрдиреНрди рд╣реЛрддреА рд╣реИ рдЬрдм рд╣рдо рдЙрди рдмрд╛рдпрдиреЗрд░рд┐рдЬрд╝ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рддреЗ рд╣реИрдВ рдЬреЛ рд╕реНрдерд╛рдкрдирд╛ рдХреЗ рджреМрд░рд╛рди рдЕрдирдкреИрдХ рд╣реЛ рдЬрд╛рддреЗ рд╣реИрдВ, рдФрд░ рдЗрд╕рд▓рд┐рдП, рдХрд╣реАрдВ рдФрд░ рдореМрдЬреВрдж рдирд╣реАрдВ рд╣реИрдВред  рдпрд╣ рджреЗрдЦрддреЗ рд╣реБрдП рдХрд┐ <a href=""><code>NtCreateUserProcess</code></a> рдФрд░ рдЗрд╕рд▓рд┐рдП, <a href="https://docs.microsoft.com/en-us/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessw"><code>CreateProcess</code></a> , рдХрд┐рд╕реА рдХрд╛рд░рдг рдХреЗ рд▓рд┐рдП рд╡рд░реНрддрдорд╛рди рд▓реЗрдирджреЗрди рдХреЛ рдЕрдирджреЗрдЦрд╛ рдХрд░реЗрдВ, рдЗрд╕ рд╕рдорд╕реНрдпрд╛ рдХреЛ рд╣рд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╢рд╛рдпрдж рдХреБрдЫ рд░рдЪрдирд╛рддреНрдордХрддрд╛ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреА, рдЬреЛ рдкрд░рд┐рд╖реНрдХреГрдд рдЯреНрд░рд┐рдХреНрд╕ рдХреЗ рдПрдХ рдЧреБрдЪреНрдЫрд╛ рдХреЗ рд╕рд╛рде рд╕рдВрдпреБрдХреНрдд рд╣реИред  рдмреЗрд╢рдХ, рд╣рдо рд╣рдореЗрд╢рд╛ рдЕрдВрддрд┐рдо рдЙрдкрд╛рдп рдХреЗ рд░реВрдк рдореЗрдВ <a href=""><code>NtCreateProcessEx</code></a> рдкрд░ рднрд░реЛрд╕рд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рд╕рдВрдЧрддрддрд╛ рдХреЛ рдареАрдХ рдХрд░рдирд╛ рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рдПрдХ рдмреБрд░рд╛ рд╕рдкрдирд╛ рдмрди рд╕рдХрддрд╛ рд╣реИред </p><br><p>  рд╡реИрд╕реЗ, рдпрд╣ рдореБрдЭреЗ рдПрдХ рдРрд╕реА рдХрд╣рд╛рдиреА рдХреА рдпрд╛рдж рджрд┐рд▓рд╛рддрд╛ рд╣реИ рдЬреЛ рдореИрдВрдиреЗ рдПрдХ рдореИрд▓рд╡реЗрдпрд░ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдкрдврд╝реА рдереА рдЬреЛ рдПрдХ рд╕рдорд╛рди рджреГрд╖реНрдЯрд┐рдХреЛрдг рд▓рд╛рдЧреВ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рднреЛрд▓реЗ-рднрд╛рд▓реЗ рдПрдВрдЯреАрд╡рд╛рдпрд░рд╕ рдХреЛ рдмреЗрд╡рдХреВрдл рдмрдирд╛рдиреЗ рдореЗрдВ рдХрд╛рдордпрд╛рдм рд░рд╣реАред  рдпрд╣ рд▓реЗрди-рджреЗрди рдореЗрдВ рдПрдХ рдкреЗрд▓реЛрдб рдХреЛ рдЫреЛрдбрд╝ рджреЗрддрд╛ рд╣реИ, рдЗрд╕реЗ рд▓реЙрдиреНрдЪ рдХрд░рддрд╛ рд╣реИ, рдФрд░ рдкрдЯрд░рд┐рдпреЛрдВ рдХреЛ рдХрд╡рд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкрд░рд┐рд╡рд░реНрддрдиреЛрдВ рдХреЛ рд╡рд╛рдкрд╕ рд░реЛрд▓ рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдбрд┐рд╕реНрдХ рдкрд░ рдПрдХ рдЫрд╡рд┐ рдХреЗ рдмрд┐рдирд╛ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред  рднрд▓реЗ рд╣реА "рдХреЛрдИ рдлрд╝рд╛рдЗрд▓ - рдХреЛрдИ рдЦрддрд░рд╛ рдирд╣реАрдВ" рдХрд╛ рддрд░реНрдХ рдореВрд░реНрдЦрддрд╛рдкреВрд░реНрдг рд▓рдЧрддрд╛ рд╣реИ, рдпрд╣ рдХрдо рд╕реЗ рдХрдо рдХреБрдЫ рд╕рд╛рд▓ рдкрд╣рд▓реЗ рдХреБрдЫ рдПрд╡реА рдХреЗ рд▓рд┐рдП рдорд╛рдорд▓рд╛ рдирд╣реАрдВ рд╣реЛ рд╕рдХрддрд╛ рдерд╛ред </p><br><h2 id="whats-with-sandboxing">  рд╕реИрдВрдбрдмреЙрдХреНрд╕рд┐рдВрдЧ рдХреЗ рд╕рд╛рде рдХреНрдпрд╛ рд╣реИ? </h2><br><p>  рдЗрд╕ рд╕реНрдХреНрд░реАрдирд╢реЙрдЯ рдХреЛ рдиреАрдЪреЗ рджреЗрдЦреЗрдВред  рдЖрдк рдПрдХ рд╣реА рдлрд╝реЛрд▓реНрдбрд░ рдХреА рд╕рд╛рдордЧреНрд░реА рдкрд░ рдкреВрд░реА рддрд░рд╣ рдЕрд╕рд╣рдордд рддреАрди рдХрд╛рд░реНрдпрдХреНрд░рдо рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВред  рд╡реЗ рд╕рднреА рддреАрди рдЕрд▓рдЧ-рдЕрд▓рдЧ рд▓реЗрдирджреЗрди рдХреЗ рдЕрдВрджрд░ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВред  рдПрд╕реАрдЖрдИрдбреА тАЛтАЛрд╢рдмреНрджрд╛рд░реНрде рдореЗрдВ рдЕрд▓рдЧрд╛рд╡ рдХреА рд╢рдХреНрддрд┐ рд╣реИред </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/9f/ml/ds/9fmldsooc30vlqq7plchzoxystc.png" alt="рд▓реЗрди-рджреЗрди рдЕрд▓рдЧрд╛рд╡"></div><br><p>  рдореЗрд░рд╛ рдХрд╛рд░реНрдпрдХреНрд░рдо рд╕реИрдВрдбрдмреЙрдХреНрд╕ рдирд╣реАрдВ рд╣реИ рдЬреЛ рднреА рд╣реЛ;  рдЗрд╕рдореЗрдВ рдПрдХ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдЯреБрдХрдбрд╝реЗ рдХрд╛ рдЕрднрд╛рд╡ рд╣реИ - рдПрдХ <strong>рд╕реБрд░рдХреНрд╖рд╛ рд╕реАрдорд╛</strong> ред  рдореБрдЭреЗ рдкрддрд╛ рд╣реИ рдХрд┐ рдХреБрдЫ рдХрдВрдкрдирд┐рдпрд╛рдВ рдЕрднреА рднреА рд╕рдорд╛рди рдЙрддреНрдкрд╛рджреЛрдВ рдХреЛ рдмреЗрдЪрдиреЗ рдХрд╛ рдкреНрд░рдмрдВрдзрди рдХрд░рддреА рд╣реИрдВ, рдЙрдиреНрд╣реЗрдВ рдЕрд╕рд▓реА рд╕реИрдВрдбрдмреЙрдХреНрд╕ рдХреЗ рд░реВрдк рдореЗрдВ рдкреЗрд╢ рдХрд░рддреА рд╣реИрдВ, рдЙрди рдкрд░ рд╢рд░реНрдо рдЖрддреА рд╣реИ, рдореИрдВ рдХреНрдпрд╛ рдХрд╣ рд╕рдХрддрд╛ рд╣реВрдВред  рдФрд░ рдЖрдк рд╕реЛрдЪ рд╕рдХрддреЗ рд╣реИрдВ: рдЖрдк рдЗрд╕реЗ рдХрднреА рднреА рд╕реИрдВрдбрдмреЙрдХреНрд╕ рдХреИрд╕реЗ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ, рдпрд╣рд╛рдВ рддрдХ тАЛтАЛрдХрд┐ рдПрдХ рдбрд┐рдмрдЧрд░ рд╣реЛрдиреЗ рдХреЗ рдирд╛рддреЗ рдЖрдк рдХрд┐рд╕реА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рдПрдХ рдЪрд░ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдиреЗ рд╕реЗ рд░реЛрдХ рдирд╣реАрдВ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рд▓реЗрдирджреЗрди рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рддрд╛ рд╣реИ, рдпрд╣ рд╕рдм рдХреЗ рдмрд╛рдж рдЗрд╕рдХреА рдореЗрдореЛрд░реА рдореЗрдВ рд░рд╣рддрд╛ рд╣реИред  рдкрд░реНрдпрд╛рдкреНрдд рд░реВрдк рд╕реЗ, рдпрд╣реА рдХрд╛рд░рдг рд╣реИ рдХрд┐ рдореБрдЭреЗ рдЕрдкрдиреА рдЖрд╕реНрддреАрди рдореЗрдВ рдПрдХ рдФрд░ рдЕрджреНрднреБрдд рдЪрд╛рд▓ рдЪрд▓рдиреА рд╣реИ, рдЬреЛ рдЕрдВрддрддрдГ рдореБрдЭреЗ рдЗрд╕ рдкрд░рд┐рдпреЛрдЬрдирд╛ рдХреЛ рдкреВрд░рд╛ рдХрд░рдиреЗ рдореЗрдВ рдорджрдж рдХрд░реЗрдЧреА рдФрд░ рдЬрд┐рд╕реЗ рдореИрдВ рдЕрдм рддрдХ рдкреНрд░рдХрдЯ рдирд╣реАрдВ рдХрд░реВрдВрдЧрд╛ред  рд╣рд╛рдВ, рдореИрдВ рдлрд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рд╡рд░реНрдЪреБрдЕрд▓рд╛рдЗрдЬреЗрд╢рди рдХреЗ рд╕рд╛рде рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛-рдореЛрдб рд╕реИрдВрдбрдмреЙрдХреНрд╕ рдмрдирд╛рдиреЗ рдХреА рдпреЛрдЬрдирд╛ рдмрдирд╛ рд░рд╣рд╛ рд╣реВрдВред  рдЗрд╕ рдмреАрдЪ, <a href="https://sandboxie.com/">рд╕реИрдВрдбрдмреЙрдХреНрд╕ рдХрд╛</a> рдЙрдкрдпреЛрдЧ <a href="https://sandboxie.com/">рдХрд░реЗрдВ</a> рдФрд░ <a href="https://docs.microsoft.com/en-us/windows/win32/secauthz/appcontainer-isolation">AppContainers рдХреЗ</a> рд╕рд╛рде рдкреНрд░рдпреЛрдЧ рдХрд░рддреЗ <a href="https://docs.microsoft.com/en-us/windows/win32/secauthz/appcontainer-isolation">рд░рд╣реЗрдВ</a> ред  рджреЗрдЦрддреЗ рд░рд╣реЛред </p><br><p>  GitHub рдкрд░ рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдХрд╛ рднрдВрдбрд╛рд░: <strong><a href="https://github.com/diversenok/TransactionMaster">TransactionMaster</a></strong> ред </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/hi485788/">https://habr.com/ru/post/hi485788/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi485772/index.html">рдбреЗрд╕реНрдХрдЯреЙрдк рд╕реЗ тАЛтАЛрд╡рд░реНрдЪреБрдЕрд▓ рдбреЗрдЯрд╛ рд╕реЗрдВрдЯрд░ рддрдХ - рд╣рдо рд╡рд░реНрдЪреБрдЕрд▓рд╛рдЗрдЬреЗрд╢рди рдореЗрдВ рдХреИрд╕реЗ рдЧрдП</a></li>
<li><a href="../hi485776/index.html">рдкреВрд░реЗ рднреВрдЧреЛрд▓ рдореЗрдВ: рд╡рд┐рднрд┐рдиреНрди рднрд╛рд╖рд╛рдУрдВ рдореЗрдВ рдиреЗрд╡рд┐рдЧреЗрд╢рди рдФрд░ рднреВрдЧрд░реНрднреАрдп рдХрд╛рд░реНрдп</a></li>
<li><a href="../hi485780/index.html">рд░реЛрдмреЛрдЯ, рдХреНрд╡рд╛рд░реНрдЯреНрдЬ рдЧреБрдВрдЬрдпрдорд╛рди рдпрдВрддреНрд░, рдорд╛рдЗрдХреНрд░реЛрдХрдВрдЯреНрд░реЛрд▓рд░ ... рдПрдкреНрд╕рди рдХреНрдпрд╛ рдХрд░рддрд╛ рд╣реИ?</a></li>
<li><a href="../hi485784/index.html">рдХрд┐рд╕реА рднреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рдЯреНрд░рд╛рдВрдЬреЗрдХреНрд╢рдирд▓ NTFS рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рдирд╛: рд╡рд┐рдВрдбреЛрдЬ рдХреЗ рд▓рд┐рдП рд╕реИрдВрдбрдмреЙрдХреНрд╕ рдмрдирд╛рдиреЗ рдХрд╛ рдореЗрд░рд╛ рдкрд╣рд▓рд╛ рдХрджрдо рд╣реИ</a></li>
<li><a href="../hi485786/index.html">рдЕрдВрдХрдЧрдгрд┐рдд рдХрд╛ рд╣реЛрдорд╡рд░реНрдХ</a></li>
<li><a href="../hi485790/index.html">рд╕рд╛рдХреНрд╖рд╛рддреНрдХрд╛рд░: рдЙрдореНрдореАрджреЛрдВ рдмрдирд╛рдо рд╡рд╛рд╕реНрддрд╡рд┐рдХрддрд╛</a></li>
<li><a href="../hi485792/index.html">рдЗрд╡рд╛рди рд▓рд┐рд▓реЗрдХрд╡рд┐рд╕реНрдЯ рдФрд░ рдХрд┐рдо рдбреЙрдЯрдХреЙрдо, рдПрдХ рдмрдбрд╝рд╛ рд╕рд╛рдХреНрд╖рд╛рддреНрдХрд╛рд░: рдореЗрдЧрд╛рдЕрдкрд▓реЛрдб рдХреА рдХрд╣рд╛рдиреА, рд╕рдВрдпреБрдХреНрдд рд░рд╛рдЬреНрдп рдЕрдореЗрд░рд┐рдХрд╛ рдХреЗ рд▓рд┐рдП рдкреНрд░рддреНрдпрд░реНрдкрдг, рд╕реНрд╡рддрдВрддреНрд░рддрд╛, рдмрд┐рдЯрдХреЙрдЗрдиред рднрд╛рдЧ реи</a></li>
<li><a href="../hi485796/index.html">рдЕрд╕рдВрд╕рджреАрдп рд╣рд▓ рдХрд░реЗрдВ</a></li>
<li><a href="../hi485800/index.html">рдбрд┐рдЬрд┐рдЯрд▓рд╛рдЗрдЬреЗрд╢рди рдмрдирд╛рдоред рд╕реНрд╡рдЪрд╛рд▓рди</a></li>
<li><a href="../hi485804/index.html">рдФрд░ рдлрд┐рд░, рдХреИрдкреНрдЪрд╛ рдпрд╛ рдирдЧрдиреЗрдХреНрд╕ рднреА рдЬрд╛рдирддрд╛ рд╣реИ рдХрд┐ рдХреИрд╕реЗ рдХрдврд╝рд╛рдИ рдХрд░рдирд╛ рд╣реИ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>