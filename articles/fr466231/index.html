<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ¤¾ğŸ½ ğŸŒ— ğŸ¤±ğŸ¾ ShIoTiny et le monde environnant: connexion de capteurs aux entrÃ©es binaires, rebond de contact et autres problÃ¨mes ğŸ¤°ğŸ½ ğŸš¶ ğŸ‘©â€â¤ï¸â€ğŸ’‹â€ğŸ‘¨</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Points clÃ©s ou sujet de cet article 


 Un autre article sur ShIoTiny - un contrÃ´leur visuellement programmable basÃ© sur la puce ESP8266 . L'article d...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ShIoTiny et le monde environnant: connexion de capteurs aux entrÃ©es binaires, rebond de contact et autres problÃ¨mes</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/466231/"><img src="https://habrastorage.org/webt/3n/g5/5y/3ng55yiea33i2ft7gzbcydaenka.jpeg"><br><h4 id="osnovnye-tezisy-ili-o-chem-eta-statya">  Points clÃ©s ou sujet de cet article </h4><br><p>  Un autre article sur <strong>ShIoTiny</strong> - un contrÃ´leur visuellement programmable basÃ© sur la puce <strong>ESP8266</strong> .  L'article dÃ©crit les fonctionnalitÃ©s de connexion de capteurs de diffÃ©rents types aux entrÃ©es binaires du contrÃ´leur <strong>ShIoTiny</strong> .  En outre, il existe des rÃ©ponses Ã  un certain nombre de questions frÃ©quemment posÃ©es par les lecteurs d'articles prÃ©cÃ©dents de la sÃ©rie. </p><br><p>  <strong>Articles de la sÃ©rie prÃ©cÃ©dente</strong> <strong><br></strong> </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ShIoTiny: petite automatisation, Internet des objets, ou Â«six mois avant les vacancesÂ»</a> </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ShIoTiny: nÅ“uds, liens et Ã©vÃ©nements ou caractÃ©ristiques des programmes de dessin</a> </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ShIoTiny: ventilation de piÃ¨ce humide (exemple de projet)</a> </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Site du projet</a> </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Micrologiciel binaire, circuits de contrÃ´leur et documentation</a> </p><a name="habracut"></a><br><h4 id="vstuplenie-ili-otvety-na-voprosy">  Introduction ou rÃ©ponses aux questions </h4><br><p>  Tous mes articles sur le sujet de <strong>ShIoTiny</strong> , Ã  l'exception du premier, sont nÃ©s de questions de lecteurs qui risquaient d'essayer mon firmware. </p><br><p>  Le fait est que pour rÃ©pondre en dÃ©tail et Ã  tous Ã  la fois - je n'en ai pas l'occasion.  Un passe-temps est un passe-temps et il est rare que quiconque y consacre autant de temps que le travail, les tÃ¢ches mÃ©nagÃ¨res ou les enfants.  Moi non plus.  Et les questions des lettres peuvent Ãªtre essentiellement rÃ©duites Ã  plusieurs.  Par consÃ©quent, il est plus facile d'Ã©crire un article qui couvre plusieurs questions en dÃ©tail que d'Ã©crire une douzaine de lettres. </p><br><p>  De nombreuses questions concernent comment connecter des capteurs de diffÃ©rents types et comment les utiliser.  Ce n'est pas surprenant: travailler avec des relais de sortie est assez simple.  Et ce qu'ils ne veulent tout simplement pas se connecter aux entrÃ©es!  Il existe de nombreuses options.  Cet article est dÃ©diÃ© Ã  cet article et sera trÃ¨s probablement consacrÃ© aux sujets suivants: un sujet trÃ¨s large - la connexion des capteurs. </p><br><p>  Mais, avant de passer Ã  la biographie du monde merveilleux des capteurs, je vais me permettre d'utiliser le Habr comme mÃ©dia pour rÃ©pondre aux questions les plus populaires qu'ils me posent par lettres. </p><br><p>  <strong><em>RÃ©ponses aux questions les plus populaires des lecteurs</em></strong> <strong><br></strong> </p><br><p>  La question la plus frÃ©quente est probablement la suivante: Â« <strong><em>pourquoi ne supportez-vous pas PWM / DS1821 / RTC ... et ainsi de suite?</em></strong>  ".  Je rÃ©ponds.  Parce que quand j'ai conÃ§u ShIoTiny, je n'en avais pas besoin.  Quant au PWM, il n'y a tout simplement nulle part oÃ¹ le mettre sur la carte <strong>ShIoTiny</strong> .  Il n'y a plus de jambes pour connecter <strong>RTC</strong> .  Et ainsi de suite.  Mais si le projet se dÃ©veloppe assez bien - je ferai un autre appareil avec la mÃªme idÃ©ologie de programmation, mais avec un ensemble diffÃ©rent de pÃ©riphÃ©riques.  Bien sÃ»r, je prendrai en charge des puces supplÃ©mentaires dans ShIoTiny, car j'ai pris en charge, par exemple, hier encore le capteur de tempÃ©rature <strong>DS1820 / 22</strong> .  Mais vous ne pouvez pas embrasser l'immensitÃ© et pousser le non Ã©ditÃ©.  La mÃ©moire du contrÃ´leur, comme mon temps, n'est pas illimitÃ©e. </p><br><p>  La prochaine question la plus populaire est: Â« <strong><em>PrÃ©voyez-vous de produire en masse ShIoTiny?</em></strong>  ".  Je vais rÃ©pondre en dÃ©tail.  <strong><em>Pour le moment,</em></strong> j'ai quelques conseils supplÃ©mentaires et si quelqu'un est intÃ©ressÃ© - Ã©crivez, je vous enverrai.  S'ils restent d'ici lÃ , bien sÃ»r.  En sÃ©rie (ce qui signifie 50-100 piÃ¨ces), encore une fois, je n'ai pas l'intention de le publier.  Il n'y a tout simplement pas une telle demande, et dire que 50 planches n'est pas si facile pour un passe-temps et me coÃ»tera beaucoup.  Il y en aura beaucoup qui voudront obtenir des honoraires prÃªts - la situation pourrait changer.  <em>Si ce n'est pas tout, alors beaucoup dÃ©pend de l'opinion et du dÃ©sir de la sociÃ©tÃ©.</em> </p><br><p>  Une autre question posÃ©e trÃ¨s souvent: Â« <strong><em>oÃ¹ trouver la source?</em></strong>  ".  Je rÃ©ponds.  Nulle part ailleurs.  Pour une raison quelconque, je ne peux pas encore les publier et je ne sais pas si je le pourrai dans un avenir prÃ©visible. </p><br><p>  Et enfin, des questions sur la <strong>multidiffusion</strong> <strong>MQTT</strong> et <strong>UDP</strong> .  J'espÃ¨re faire un article sÃ©parÃ© sur ces questions, car il existe de nombreuses fonctionnalitÃ©s.  Quelque chose Ã  propos de <strong>MQTT</strong> est dans l'article prÃ©cÃ©dent sur le systÃ¨me de ventilation, mais tout y est dÃ©crit en termes gÃ©nÃ©raux.  Et pourtant - lisez les instructions.  Il existe de nombreuses rÃ©ponses, bien qu'il s'agisse encore d'un brouillon. </p><br><p>  Cela se termine par des questions populaires et traite enfin de la raison pour laquelle cet article a Ã©tÃ© Ã©crit - le monde Ã©tonnant, beau, effrayant et mystÃ©rieux des capteurs. </p><br><h4 id="datchik--chto-eto-i-zachem-ono">  Capteur - qu'est-ce que c'est et pourquoi est-ce? </h4><br><p>  Toute inscription dans une langue inconnue n'est qu'un motif complexe pour quelqu'un qui n'a jamais vu de lettres ou de hiÃ©roglyphes.  Il n'y a pas de photos pour les aveugles.  Pour les sourds, la musique.  Pourquoi suis-je?  Et le fait que l' <em>information</em> est un affichage conditionnel d'un objet ou d'un phÃ©nomÃ¨ne sur un support matÃ©riel.  L'information sans support matÃ©riel n'existe pas.  Ainsi que l'information n'existe pas sans quelqu'un qui est capable de le comprendre. </p><br><p>  Par consÃ©quent, si nous voulons que notre <strong>ShIoTiny</strong> ne <strong>soit</strong> pas Â«aveugleÂ», Â«sourdÂ» et Â«analphabÃ¨teÂ» - nous devons lui apprendre Ã  Â« <em>percevoir</em> Â» et Ã  Â« <em>comprendre</em> Â» les informations sur le monde autour de lui et sur cette base Ã  prendre certaines dÃ©cisions pour gÃ©rer ce qui est nÃ©cessaire nous Ã©quipement. </p><br><p>  Les informations sur le monde existent dans une grande variÃ©tÃ© de reprÃ©sentations et sur diffÃ©rents supports de matÃ©riaux: vibrations de l'air - flux sonore et photonique - lumiÃ¨re;  la concentration de vapeur d'eau dans l'air et la tempÃ©rature de la terre;  la prÃ©sence ou l'absence de masse et son ampleur.  Et ainsi de suite.  Tout cela peut nous apporter les informations nÃ©cessaires Ã  la prise de dÃ©cision. </p><br><p>  Mais notre microcontrÃ´leur <strong>ESP8266</strong> - la base de <strong>ShIoTiny</strong> - ne comprend que deux types d'informations - les signaux binaires numÃ©riques <strong>0V</strong> - <strong>3V</strong> et les signaux analogiques dans la plage de <strong>0V</strong> Ã  <strong>1V</strong> . </p><br><p>  Par consÃ©quent, nous avons besoin de Â« <strong>traducteurs</strong> Â» de la langue d'un phÃ©nomÃ¨ne physique ou d'une quantitÃ© physique particuliÃ¨re Ã  la langue de signaux Ã©lectriques comprÃ©hensibles par le microcontrÃ´leur <strong>ESP8266</strong> .  Ces " <strong>traducteurs</strong> " sont appelÃ©s <strong><em>capteurs</em></strong> . </p><br><p>  Ã€ strictement parler, dans notre cas, le <strong><em>capteur</em></strong> est un outil technique qui convertit les informations sur le monde environnant en signaux Ã©lectriques comprÃ©hensibles par les composants Ã©lectroniques du contrÃ´leur <strong>ShIoTiny</strong> . </p><br><p>  Les capteurs sont diffÃ©rents.  Il y a des milliers et des tÃ©nÃ¨bres.  Mais si vous commencez Ã  comprendre, alors tout n'est pas si effrayant.  <em>PremiÃ¨rement</em> , nous ne nous intÃ©ressons qu'aux capteurs qui gÃ©nÃ¨rent un signal Ã©lectrique en sortie.  <em>DeuxiÃ¨mement</em> , nous nous limiterons uniquement aux types de capteurs populaires.  Et <em>troisiÃ¨mement</em> , dans la pratique, il n'y a pas autant de types de signaux gÃ©nÃ©rÃ©s par les capteurs. </p><br><p>  DÃ¨s le "premier" - tout est clair.  Il est physiquement impossible de <strong>connecter</strong> directement <strong>un</strong> capteur Ã  <strong>ShIoTiny</strong> qui fournit des informations sous forme mÃ©canique, hydraulique ou pneumatique. </p><br><p>  Avec "deuxiÃ¨mement" - tout est Ã©galement clair.  Il est peu probable que quiconque connecte des dÃ©tecteurs de particules rapides ou des pH-mÃ¨tres spÃ©cifiques dans un lithium radioactif fondu Ã  <strong>ShIoTiny</strong> .  Eh bien, si quelqu'un le fait, je pense que ses qualifications sont beaucoup plus Ã©levÃ©es que les miennes et il n'aura probablement pas besoin de cet article.  Mais la tempÃ©rature de l'eau ou de l'air, la pression de l'air ou de l'eau, l'humiditÃ©, la lumiÃ¨re, le niveau de liquide ou l'Ã©tat de la porte (ouverte-fermÃ©e) - tout cela peut trÃ¨s bien Ãªtre mesurÃ© par le contrÃ´leur ShIoTiny dans les systÃ¨mes de contrÃ´le domestique. </p><br><p>  Nous traiterons du "troisiÃ¨me".  Quels signaux Ã©lectriques sont gÃ©nÃ©ralement Ã©mis par les types de capteurs courants?  On distingue trois principaux types de signaux aux sorties des capteurs: </p><br><p>  <strong>Signaux binaires</strong>  Autrement dit, les signaux qui n'ont que deux niveaux - logique 0 ou logique 1. Les paramÃ¨tres Ã©lectriques ne sont pas importants - ils peuvent toujours Ãªtre convertis aux niveaux souhaitÃ©s. </p><br><p>  <strong>Signaux analogiques</strong> .  C'est-Ã -dire, le courant ou la tension, variant en fonction du paramÃ¨tre mesurÃ© dans une plage de valeurs donnÃ©e. </p><br><p>  <strong>Signaux numÃ©riques</strong> .  Ce sont des capteurs qui communiquent avec des microcontrÃ´leurs Ã  l'aide d'un protocole spÃ©cifique. </p><br><p>  Voici peut-Ãªtre toutes les options qui peuvent Ãªtre connectÃ©es Ã  <strong>ShIoTiny</strong> .  Bien sÃ»r, il existe Ã©galement des capteurs avec une sortie de frÃ©quence, une sortie de phase et des capteurs avec toutes sortes de signaux de sortie exotiques.  Mais comme il est <strong>impossible</strong> de les connecter directement Ã  <strong>ShIoTiny,</strong> nous n'en parlerons pas maintenant. </p><br><h4 id="binarnye-vhody-shiotiny">  EntrÃ©es binaires ShIoTiny </h4><br><p>  CommenÃ§ons par le plus simple - avec les entrÃ©es binaires <strong>ShIoTiny</strong> .  Ils sont indiquÃ©s par <strong>Input1</strong> , <strong>Input2</strong> et <strong>Input3</strong> .  Puisque ces entrÃ©es sont absolument identiques, nous considÃ©rerons l'entrÃ©e <strong>Input1</strong> .  Tout ce qui est dit sur cette entrÃ©e est tout aussi vrai pour les deux autres entrÃ©es binaires - <strong>Input2</strong> et <strong>Input3</strong> . </p><br><p>  Le <strong>circuit d'</strong> entrÃ©e binaire <strong>ShIoTiny est</strong> illustrÃ© sur la figure.  Faites immÃ©diatement une rÃ©servation, le circuit avec un petit dÃ©faut - il Ã©tait nÃ©cessaire de connecter une rÃ©sistance <strong>10K</strong> Ã  une rÃ©sistance <strong>1K</strong> .  Mais cela n'affecte pas le fonctionnement de l'appareil et c'est merveilleux.  Alors, pourquoi y a-t-il autant d'Ã©lÃ©ments dans un circuit d'entrÃ©e binaire?  Une telle question m'a Ã©galement Ã©tÃ© posÃ©e.  J'essaierai d'y rÃ©pondre. </p><br><p><img src="https://habrastorage.org/webt/eo/ff/qh/eoffqhr5eib1g5jwc1wa5mojsyc.gif" alt="image"></p><br><p>  L'entrÃ©e binaire dans <strong>ShIoTiny</strong> fonctionne sur <em>les</em> contacts Â« <em>secs</em> Â» et Â« <em>humides</em> Â».  De plus, le circuit offre une protection contre les surtensions (c'est-Ã -dire si, par exemple, 5 Volts au lieu de 3 Volts parviennent Ã  <strong>Input1</strong> , par exemple). </p><br><h4 id="zaschita-binarnogo-vhoda">  Protection des entrÃ©es binaires </h4><br><p>  <strong>La</strong> protection contre les <strong>surtensions</strong> , qui est effectuÃ©e sur toutes les entrÃ©es binaires de <strong>ShIoTiny</strong> , ne sauvera bien sÃ»r pas le contrÃ´leur de l'Ã©puisement si une tension de ~ 220V est appliquÃ©e Ã  son entrÃ©e.  Mais de l'accÃ¨s aux entrÃ©es <strong>Input1,2,3</strong> <strong>+ 5V</strong> ou mÃªme <strong>+ 12V</strong> - cette protection sauve complÃ¨tement. </p><br><p>  Cette protection fonctionne trÃ¨s simplement et peut Ãªtre appliquÃ©e non seulement avec l' <strong>ESP8266</strong> , mais aussi avec d'autres microcontrÃ´leurs. </p><br><p>  ConsidÃ©rez deux options pour la protection: lors de l'application d' <strong>une</strong> tension de <strong>+ 5V</strong> et <strong>-5V</strong> au fil neutre ( <strong>masse</strong> ) Ã  l'entrÃ©e <strong>Input1</strong> . </p><br><p>  Lorsque la tension Ã  l'entrÃ©e <strong>Input1</strong> est normale, les diodes de protection <strong>D1</strong> et <strong>D2</strong> sont fermÃ©es, car elles sont allumÃ©es dans le sens opposÃ©. </p><br><p>  DÃ¨s que la tension Ã  <strong>Input1</strong> dÃ©passe + 3V (par exemple, nous avons <strong>court-circuitÃ© Input1</strong> Ã  <strong>+ 5V</strong> ), la diode <strong>D1</strong> s'ouvre et tire l'entrÃ©e du contrÃ´leur <strong>GPIO</strong> Ã  <strong>+ 3V</strong> , empÃªchant la tension au <strong>GPIO ESP8266</strong> <strong>de</strong> dÃ©passer <strong>3V</strong> .  En fait, la tension sera lÃ©gÃ¨rement supÃ©rieure Ã  <strong>3 V</strong> (3,2 <strong>V</strong> ou 3,3 <strong>V</strong> ) - mais ce n'est pas important.  L'entrÃ©e du microcontrÃ´leur ne brÃ»le pas et c'est important. </p><br><p>  DÃ¨s que la tension Ã  l'entrÃ©e <strong>1</strong> devient nÃ©gative (par exemple, nous avons court-circuitÃ© l'entrÃ©e Ã  <strong>-5 V</strong> ), la diode <strong>D2</strong> s'ouvre et tire l'entrÃ©e <strong>1</strong> Ã  la <strong>masse</strong> <strong>0 V</strong> , sans laisser la tension Ã  l'entrÃ©e <strong>GPIO ESP8266</strong> descendre en dessous de <strong>0 V.</strong>  En fait, la tension sera lÃ©gÃ¨rement infÃ©rieure Ã  <strong>0 V</strong> (-0,2 V ou -0,3 V) - mais ce n'est encore une fois pas important.  L'entrÃ©e du microcontrÃ´leur ne brÃ»le pas. </p><br><p>  La rÃ©sistance <strong>1K</strong> est un limiteur de courant pour qu'il n'y ait pas de court-circuit pendant le fonctionnement de la protection.  Les courants qui le traversent sont faibles.  Par exemple, dans notre exemple, si nous <strong>appliquons Input1</strong> <strong>+ 5V</strong> Ã  l'entrÃ©e, le courant Ã  travers la rÃ©sistance <strong>1K</strong> sera d'environ <strong>2mA</strong> .  Avec une tension nÃ©gative de <strong>-5V</strong> Ã  l'entrÃ©e <strong>Input1, le</strong> courant Ã  travers la rÃ©sistance <strong>1K</strong> sera d'environ <strong>5mA</strong> . </p><br><p>  Si quelqu'un ne comprend pas pourquoi les diodes s'ouvrent et se ferment, je recommande de lire le livre <strong>"Electronics Step by Step" de R. A. Svorenya</strong> .  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Sur Internet, c'est par exemple ici</a> .  Je conseille particuliÃ¨rement les dÃ©butants - le langage de ce livre est simple et il y a plein d'exemples. </p><br><h4 id="kakie-byvayut-kontakty">  Quels sont les contacts </h4><br><p>  Donc, avec la protection triÃ©e.  Passons Ã  un autre problÃ¨me fondamental - la connexion de l'entrÃ©e binaire <strong>ShIoTiny</strong> aux capteurs binaires. </p><br><p>  Comme nous l'avons dÃ©jÃ  dit, les capteurs binaires sont des capteurs dont la sortie a deux Ã©tats - zÃ©ro et un.  Mais c'est logique.  Et physiquement, il peut y avoir deux options pour les sorties du capteur binaire: Â« <strong>contact sec</strong> Â» et Â« <strong>contact humide</strong> Â».  ConsidÃ©rez ce que c'est et avec quoi il est mangÃ©. </p><br><p>  Un Â« <strong>contact sec</strong> Â» est un contact qui n'a pas sa propre source de tension.  Autrement dit, juste deux conducteurs mÃ©talliques qui peuvent Ãªtre court-circuitÃ©s ensemble et les ouvrir.  Cette dÃ©finition inclut la masse des capteurs - boutons, interrupteurs, capteurs Ã  flotteur pour le niveau de liquide, interrupteurs Ã  lames (capteurs de champ magnÃ©tique), etc.  Sur les circuits Ã©lectriques, <strong>les</strong> Â« <strong>contacts secs</strong> Â» <strong>normalement ouverts</strong> sont gÃ©nÃ©ralement indiquÃ©s comme indiquÃ© sur la figure. </p><br><p><img src="https://habrastorage.org/webt/vt/rc/ya/vtrcyaeq7yo2o4hdju-2edxx_7w.png" alt="image"></p><br><p>  Normalement ouvert - cela signifie ouvert lorsqu'il n'y a pas d'influence extÃ©rieure - le bouton n'est pas enfoncÃ©, l'interrupteur n'est pas activÃ©, l'interrupteur Ã  lames n'a pas d'aimant Ã  proximitÃ© ... </p><br><p>  Il existe Ã©galement <strong>des</strong> Â« <strong>contacts secs</strong> Â» <strong>normalement fermÃ©s</strong> .  Sur les circuits Ã©lectriques, ils sont gÃ©nÃ©ralement indiquÃ©s comme indiquÃ© sur la figure. </p><br><p><img src="https://habrastorage.org/webt/ze/mj/lj/zemjljubtoz6y8gldzq6gb5qznq.png" alt="image"></p><br><p>  Contrairement aux <strong>contacts secs</strong> normalement ouverts, normalement fermÃ©s, en l'absence d'influences externes, ils sont fermÃ©s. </p><br><p>  Ces deux <strong>contacts</strong> et d'autres " <strong>contacts secs</strong> " peuvent Ãªtre connectÃ©s en toute sÃ©curitÃ© aux entrÃ©es <strong>du</strong> contrÃ´leur <strong>Input1,2,3 ShIoTiny</strong> .  Les capteurs avec une sortie de type <strong>contact sec</strong> sont <strong>connectÃ©s aux</strong> entrÃ©es binaires <strong>ShIoTiny</strong> comme indiquÃ© sur la figure. </p><br><p><img src="https://habrastorage.org/webt/8j/fs/8i/8jfs8i8xydqsyuirvrrtihvotly.gif" alt="image"></p><br><p>  Si le Â« <strong>contact sec</strong> Â» de l'entrÃ©e <strong>1</strong> est fermÃ©, alors une tension d'environ zÃ©ro volt est appliquÃ©e Ã  l'entrÃ©e du contrÃ´leur (plus prÃ©cisÃ©ment, 0,3 volt en raison d'une erreur dans le circuit), car le Â« <strong>contact sec</strong> Â» ferme l'entrÃ©e du contrÃ´leur Ã  la terre via un diviseur formÃ© de rÃ©sistances <strong>1K</strong> et <strong>10K</strong> .  Dans ce cas, le <em>nÅ“ud</em> <strong>Input1</strong> dÃ©finira l'unitÃ© en sortie. </p><br><p>  Inversement, si le <strong>contact sec de</strong> <strong>Input1 est</strong> ouvert, alors environ trois volts sont fournis Ã  l'entrÃ©e du contrÃ´leur, puisque l'entrÃ©e du contrÃ´leur est tirÃ©e Ã  la tension d'alimentation via une rÃ©sistance de <strong>10K</strong> .  Dans ce cas, le nÅ“ud <strong>Input1</strong> mettra zÃ©ro Ã  sa sortie. </p><br><p>  Toute cette description dÃ©taillÃ©e est destinÃ©e aux curieux.  En fin de compte, nous avons ce qui suit: si nous avons connectÃ© un capteur avec une sortie de type Â« <strong>contact sec</strong> Â» Ã  l' <strong>entrÃ©e1</strong> , alors lorsque le contact est ouvert, la sortie du nÅ“ud <strong>Input1</strong> sera nulle, et lorsque le contact est fermÃ©, la sortie du mÃªme nÅ“ud sera un.  De mÃªme pour les entrÃ©es et les nÅ“uds <strong>Input2</strong> et <strong>Input3</strong> . </p><br><p>  Passons aux <strong>contacts humides</strong> . </p><br><p>  Un Â« <strong>contact humide</strong> Â» est un contact qui a sa propre source de tension dans au moins une de ses positions.  Par exemple, la sortie d'un autre contrÃ´leur ou circuit logique;  ampoule ligne Ã©lectrique et ainsi de suite.  Il peut y avoir beaucoup d'options ici.  Mais presque tous, directement ou Ã  l'aide de plusieurs dÃ©tails, permettent de faire correspondre les entrÃ©es binaires <strong>Input1,2,3</strong> avec la sortie de l'appareil - Â« <strong>contact humide</strong> Â». </p><br><p>  CommenÃ§ons par le plus simple - faire correspondre l'entrÃ©e <strong>Input1</strong> avec la sortie du capteur ou du type de microcircuit " <strong>collecteur ouvert</strong> " ou " <strong>drain ouvert</strong> ". </p><br><p>  En fait, <strong><em>dans notre cas</em></strong> , ce circuit est complÃ¨tement analogue Ã  la connexion d'un capteur avec une <strong>sortie Ã  contact sec</strong> .  Seul le rÃ´le du contact est assurÃ© par le transistor. </p><br><p>  Le schÃ©ma de cette connexion est illustrÃ© dans la figure.  L'essence du concept de " <strong>collecteur ouvert</strong> " ou " <strong>drain ouvert</strong> " est que l' <strong>Ã©metteur</strong> (ou la <strong>source</strong> ) du transistor de sortie est connectÃ© Ã  la " <strong>masse</strong> " (souvent juste Ã  l'intÃ©rieur du microcircuit), et le <strong>collecteur</strong> (ou <strong>drain</strong> ) est connectÃ© Ã  la "jambe" du microcircuit et plus encore. Ã  rien. </p><br><p>  Le fonctionnement de ce schÃ©ma est comprÃ©hensible pour un novice (pas un gaz imaginaire, mais une personne!).  DÃ¨s que le transistor Ã  l'intÃ©rieur du microcircuit s'ouvre, il ferme l'entrÃ©e <strong>Input1</strong> Ã  la masse puis tout fonctionne par analogie avec un contact Â« <strong>sec</strong> Â». </p><br><img src="https://habrastorage.org/webt/tl/__/nh/tl__nhsp-3hwmb1eztprk1lxo0g.gif"><br><p>  Malheureusement, toutes les micropuces et capteurs n'ont pas une sortie aussi merveilleuse avec un collecteur ouvert ou un drain.  Beaucoup, sinon la plupart des puces et capteurs ont une sortie active.  Cela signifie que lorsque nous avons une unitÃ© logique Ã  la sortie, la sortie est Â«remontÃ©eÂ» Ã  la tension d'alimentation, et lorsqu'un zÃ©ro logique, la sortie est Â«remontÃ©eÂ» Ã  la masse.  La sortie d'une telle puce est illustrÃ©e dans la figure ci-dessous.  Bien sÃ»r, tout est simplifiÃ©. </p><br><img src="https://habrastorage.org/webt/ll/9p/ca/ll9pcawme5kebyua--xi9hscacu.gif"><br><p>  Que devons-nous faire si le microcircuit ou le capteur que nous voulons connecter Ã  <strong>Input1</strong> a une telle sortie active? </p><br><p>  Il y a deux options ici et elles dÃ©pendent de la valeur de la tension d'alimentation du microcircuit ou du capteur <strong>Vcc</strong> . </p><br><p>  Si la tension d'alimentation de la puce ou du capteur <strong>Vcc</strong> est la mÃªme que celle de l' <strong>ESP8266</strong> (c'est-Ã -dire 3 Volts), vous pouvez simplement connecter cette sortie Ã  l'entrÃ©e <strong>Input1</strong> , qui est en fait illustrÃ©e dans la figure prÃ©cÃ©dente. </p><br><p>  Mais que faire si l'alimentation du capteur ou du microcircuit est de <strong>+ 5V</strong> ou <strong>+ 12V</strong> ?  Dans notre cas, vous pouvez le faire tout simplement en allumant la diode Schottky, comme indiquÃ© dans la figure ci-dessous. </p><br><img src="https://habrastorage.org/webt/xo/ig/mh/xoigmhvkz7mjgd4htvm2ygddtq8.gif"><br><p>  Et encore une nuance: tous les circuits avec un contact Â« <strong>humide</strong> Â» nous donnent un <strong>signal inverse</strong> .  Autrement dit, lorsque l'unitÃ© logique est Ã  la sortie du capteur ou du microcircuit, le nÅ“ud <strong>Input1</strong> mettra la sortie Ã  zÃ©ro.  Et vice versa.  Mais cela est corrigÃ© par programme - il suffit d'insÃ©rer le nÅ“ud de l'onduleur dans le circuit.  Tout cela est illustrÃ© dans la figure. </p><br><p><img src="https://habrastorage.org/webt/va/xh/te/vaxhteujl9fg9mlmom0ex2hijgm.png" alt="image"></p><br><p>  En fait, c'est tout ce que vous devez savoir sur la connexion des capteurs aux entrÃ©es binaires <strong>Input1,2,3</strong> . </p><br><p>  Bien sÃ»r, thÃ©oriquement, il peut y avoir d'autres options, mais j'ai montrÃ© les moyens les plus simples et les plus courants de connecter des capteurs avec <strong>des</strong> sorties Ã  <strong>contact sec</strong> et des sorties actives basse tension. </p><br><h4 id="trepet-kontaktov">  Sensation de contact </h4><br><p>  Les contacts tremblent.  Pas par crainte du crÃ©ateur de l'appareil, mais par le fait qu'ils sont rÃ©sistants.  Lorsque vous appuyez sur le bouton, les contacts peuvent se fermer de 5 Ã  7 fois avant d'Ãªtre fermÃ©s de maniÃ¨re stable.  Le mÃªme phÃ©nomÃ¨ne se produit lorsque les boutons sont relÃ¢chÃ©s.  Et ce phÃ©nomÃ¨ne est appelÃ© - Â« <strong>rebond des contacts</strong> Â». </p><br><p>  <strong>Le rebond de contact</strong> est la malÃ©diction de tous les capteurs de contact mÃ©caniques - interrupteurs, boutons, interrupteurs Ã  lames et ainsi de suite.  Le bavardage dÃ©sagrÃ©able est qu'il provoque de faux clics ou de fausses relÃ¢chements d'un bouton ou d'un contact. </p><br><p>  Il existe plusieurs faÃ§ons de faire face Ã  ce phÃ©nomÃ¨ne dÃ©sagrÃ©able.  Le <strong>dÃ©clencheur</strong> est probablement la faÃ§on la plus ancienne de se battre.  Avec cette mÃ©thode, un bouton avec un contact de commutation et un dÃ©clencheur RS normal sont utilisÃ©s, qui sont activÃ©s selon le schÃ©ma, comme indiquÃ© sur la figure. </p><br><p><img src="https://habrastorage.org/webt/1s/lm/yo/1slmyoteklx46ct9nfgjt-hevtk.png" alt="image"></p><br><p>  Comment Ã§a marche?  TrÃ¨s simple.  Un dÃ©clencheur a deux Ã©tats.  Alors que le bouton est fermÃ© sur l'entrÃ©e <strong>R du</strong> dÃ©clencheur, la sortie <strong>Q du</strong> dÃ©clencheur est mise Ã  zÃ©ro. </p><br><p>  Nous avons appuyÃ© sur le bouton - jusqu'Ã  ce que le contact central du bouton touche le bas - rien ne change, la sortie de la gÃ¢chette est nulle.  DÃ¨s que le contact central du bouton a touchÃ© le contact infÃ©rieur du mÃªme bouton et fermÃ© l'entrÃ©e du dÃ©clencheur <strong>S</strong> Ã  la masse, on apparaÃ®t Ã  la sortie du dÃ©clencheur.  Et cette unitÃ© reste alors que les contacts "cliquettent".  En effet, pour remettre la sortie de dÃ©clenchement Ã  zÃ©ro, il faut que l'entrÃ©e de dÃ©clenchement <strong>R</strong> soit court-circuitÃ©e Ã  la masse!  Ce schÃ©ma fonctionne exactement de la mÃªme maniÃ¨re lorsque vous relÃ¢chez le bouton. </p><br><p>  Pouvons-nous faire un tel circuit sur <strong>ShIoTiny</strong> ?  Oui, pas de problÃ¨me!  Sur la figure, il est illustrÃ©. </p><br><p><img src="https://habrastorage.org/webt/hz/p2/yg/hzp2yg7lx4zo7i6ko8lyok3iikk.png" alt="image"></p><br><p>  Mais passer deux de leurs trois entrÃ©es sur un capteur?!  De plus, tous les capteurs n'ont pas de contact de commutation! </p><br><p>  Non, nous irons dans l'autre sens, comme lÃ©guÃ©, Ã  tout l'ingÃ©nieux thÃ©oricien V.I.  Ulyanov! </p><br><p>  La deuxiÃ¨me maniÃ¨re, et probablement la plus courante aujourd'hui, de gÃ©rer le rebond de contact est un <strong>filtre logiciel</strong> . </p><br><p>  Qu'est-ce qui se cache derriÃ¨re ces mots intelligents?  Et encore une fois - rien de compliquÃ©.  Imaginez que nous ne rÃ©pondions pas aux Â«courtsÂ» changements d'Ã©tat des contacts.  Par exemple, si nous lisons zÃ©ro sur le bouton, puis pour de courtes (par exemple, la durÃ©e est infÃ©rieure Ã  0,3 sec) des rafales unitaires, nous <del>  nous martelons </del>  arrÃªte de rÃ©agir.  Et ce n'est que lorsque nous aurons un bouton pendant 0,3 seconde que nous Ã©mettrons continuellement une unitÃ© - nous y rÃ©pondrons.            . </p><br><p>     â€”    ,   .         .         RS-! </p><br><p>     ?  <strong>ShIoTiny</strong>  -,          . </p><br><p><img src="https://habrastorage.org/webt/-t/tv/hq/-ttvhqvwjzrj1_8f0rzuztiugz4.png" alt="image"></p><br><p>  <strong>Delay0/1</strong>      ,     <strong>0.4</strong> . </p><br><p> ,          .   ,   ,      . </p><br><h4 id="zaklyuchenie">  Conclusion </h4><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> En conclusion, je voudrais m'excuser auprÃ¨s de ceux Ã  qui cet article semblait inutilement dÃ©taillÃ© - rappelez-vous qu'il y a beaucoup de gens sur le hub qui ne sont pas aussi sages que vous. </font></font></p><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dans le prochain article, nous examinerons la connexion de capteurs avec un signal de sortie analogique Ã  l'entrÃ©e </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ADC</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></p><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Comme toujours, suggestions, souhaits, questions, fautes de frappe, etc., par e-mail: shiotiny@yandex.ru </font></font></p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr466231/">https://habr.com/ru/post/fr466231/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr466215/index.html">Conception orientÃ©e modÃ¨le. CrÃ©ation d'un modÃ¨le fiable, Ã  partir de l'exemple d'un Ã©changeur de chaleur aviation</a></li>
<li><a href="../fr466217/index.html">GÃ©nÃ©ration de documents Ã  l'aide d'ONLYOFFICE DocumentBuilder</a></li>
<li><a href="../fr466223/index.html">DÃ©composition propre</a></li>
<li><a href="../fr466227/index.html">Programmation orientÃ©e nÅ“ud</a></li>
<li><a href="../fr466229/index.html">Comment acheter dix boÃ®tes de coton et ne pas se tromper</a></li>
<li><a href="../fr466235/index.html">Munch dans un scan Ã©quidistant et Meyerhold, qui a dÃ©truit la Place Rouge - Denis Semenov sur l'art VR</a></li>
<li><a href="../fr466237/index.html">Comment le junior vert a Ã©crit son hot-recharger</a></li>
<li><a href="../fr466247/index.html">Entretien de Introvert</a></li>
<li><a href="../fr466249/index.html">Ã‰crire un serpent pour Android dans Kivy, Python</a></li>
<li><a href="../fr466251/index.html">Faire passer le projet de Soft Launch Ã  1 million de dollars de revenus par mois</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>