<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤾🏽 🌗 🤱🏾 ShIoTiny et le monde environnant: connexion de capteurs aux entrées binaires, rebond de contact et autres problèmes 🤰🏽 🚶 👩‍❤️‍💋‍👨</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Points clés ou sujet de cet article 


 Un autre article sur ShIoTiny - un contrôleur visuellement programmable basé sur la puce ESP8266 . L'article d...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ShIoTiny et le monde environnant: connexion de capteurs aux entrées binaires, rebond de contact et autres problèmes</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/466231/"><img src="https://habrastorage.org/webt/3n/g5/5y/3ng55yiea33i2ft7gzbcydaenka.jpeg"><br><h4 id="osnovnye-tezisy-ili-o-chem-eta-statya">  Points clés ou sujet de cet article </h4><br><p>  Un autre article sur <strong>ShIoTiny</strong> - un contrôleur visuellement programmable basé sur la puce <strong>ESP8266</strong> .  L'article décrit les fonctionnalités de connexion de capteurs de différents types aux entrées binaires du contrôleur <strong>ShIoTiny</strong> .  En outre, il existe des réponses à un certain nombre de questions fréquemment posées par les lecteurs d'articles précédents de la série. </p><br><p>  <strong>Articles de la série précédente</strong> <strong><br></strong> </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ShIoTiny: petite automatisation, Internet des objets, ou «six mois avant les vacances»</a> </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ShIoTiny: nœuds, liens et événements ou caractéristiques des programmes de dessin</a> </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ShIoTiny: ventilation de pièce humide (exemple de projet)</a> </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Site du projet</a> </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Micrologiciel binaire, circuits de contrôleur et documentation</a> </p><a name="habracut"></a><br><h4 id="vstuplenie-ili-otvety-na-voprosy">  Introduction ou réponses aux questions </h4><br><p>  Tous mes articles sur le sujet de <strong>ShIoTiny</strong> , à l'exception du premier, sont nés de questions de lecteurs qui risquaient d'essayer mon firmware. </p><br><p>  Le fait est que pour répondre en détail et à tous à la fois - je n'en ai pas l'occasion.  Un passe-temps est un passe-temps et il est rare que quiconque y consacre autant de temps que le travail, les tâches ménagères ou les enfants.  Moi non plus.  Et les questions des lettres peuvent être essentiellement réduites à plusieurs.  Par conséquent, il est plus facile d'écrire un article qui couvre plusieurs questions en détail que d'écrire une douzaine de lettres. </p><br><p>  De nombreuses questions concernent comment connecter des capteurs de différents types et comment les utiliser.  Ce n'est pas surprenant: travailler avec des relais de sortie est assez simple.  Et ce qu'ils ne veulent tout simplement pas se connecter aux entrées!  Il existe de nombreuses options.  Cet article est dédié à cet article et sera très probablement consacré aux sujets suivants: un sujet très large - la connexion des capteurs. </p><br><p>  Mais, avant de passer à la biographie du monde merveilleux des capteurs, je vais me permettre d'utiliser le Habr comme média pour répondre aux questions les plus populaires qu'ils me posent par lettres. </p><br><p>  <strong><em>Réponses aux questions les plus populaires des lecteurs</em></strong> <strong><br></strong> </p><br><p>  La question la plus fréquente est probablement la suivante: « <strong><em>pourquoi ne supportez-vous pas PWM / DS1821 / RTC ... et ainsi de suite?</em></strong>  ".  Je réponds.  Parce que quand j'ai conçu ShIoTiny, je n'en avais pas besoin.  Quant au PWM, il n'y a tout simplement nulle part où le mettre sur la carte <strong>ShIoTiny</strong> .  Il n'y a plus de jambes pour connecter <strong>RTC</strong> .  Et ainsi de suite.  Mais si le projet se développe assez bien - je ferai un autre appareil avec la même idéologie de programmation, mais avec un ensemble différent de périphériques.  Bien sûr, je prendrai en charge des puces supplémentaires dans ShIoTiny, car j'ai pris en charge, par exemple, hier encore le capteur de température <strong>DS1820 / 22</strong> .  Mais vous ne pouvez pas embrasser l'immensité et pousser le non édité.  La mémoire du contrôleur, comme mon temps, n'est pas illimitée. </p><br><p>  La prochaine question la plus populaire est: « <strong><em>Prévoyez-vous de produire en masse ShIoTiny?</em></strong>  ".  Je vais répondre en détail.  <strong><em>Pour le moment,</em></strong> j'ai quelques conseils supplémentaires et si quelqu'un est intéressé - écrivez, je vous enverrai.  S'ils restent d'ici là, bien sûr.  En série (ce qui signifie 50-100 pièces), encore une fois, je n'ai pas l'intention de le publier.  Il n'y a tout simplement pas une telle demande, et dire que 50 planches n'est pas si facile pour un passe-temps et me coûtera beaucoup.  Il y en aura beaucoup qui voudront obtenir des honoraires prêts - la situation pourrait changer.  <em>Si ce n'est pas tout, alors beaucoup dépend de l'opinion et du désir de la société.</em> </p><br><p>  Une autre question posée très souvent: « <strong><em>où trouver la source?</em></strong>  ".  Je réponds.  Nulle part ailleurs.  Pour une raison quelconque, je ne peux pas encore les publier et je ne sais pas si je le pourrai dans un avenir prévisible. </p><br><p>  Et enfin, des questions sur la <strong>multidiffusion</strong> <strong>MQTT</strong> et <strong>UDP</strong> .  J'espère faire un article séparé sur ces questions, car il existe de nombreuses fonctionnalités.  Quelque chose à propos de <strong>MQTT</strong> est dans l'article précédent sur le système de ventilation, mais tout y est décrit en termes généraux.  Et pourtant - lisez les instructions.  Il existe de nombreuses réponses, bien qu'il s'agisse encore d'un brouillon. </p><br><p>  Cela se termine par des questions populaires et traite enfin de la raison pour laquelle cet article a été écrit - le monde étonnant, beau, effrayant et mystérieux des capteurs. </p><br><h4 id="datchik--chto-eto-i-zachem-ono">  Capteur - qu'est-ce que c'est et pourquoi est-ce? </h4><br><p>  Toute inscription dans une langue inconnue n'est qu'un motif complexe pour quelqu'un qui n'a jamais vu de lettres ou de hiéroglyphes.  Il n'y a pas de photos pour les aveugles.  Pour les sourds, la musique.  Pourquoi suis-je?  Et le fait que l' <em>information</em> est un affichage conditionnel d'un objet ou d'un phénomène sur un support matériel.  L'information sans support matériel n'existe pas.  Ainsi que l'information n'existe pas sans quelqu'un qui est capable de le comprendre. </p><br><p>  Par conséquent, si nous voulons que notre <strong>ShIoTiny</strong> ne <strong>soit</strong> pas «aveugle», «sourd» et «analphabète» - nous devons lui apprendre à « <em>percevoir</em> » et à « <em>comprendre</em> » les informations sur le monde autour de lui et sur cette base à prendre certaines décisions pour gérer ce qui est nécessaire nous équipement. </p><br><p>  Les informations sur le monde existent dans une grande variété de représentations et sur différents supports de matériaux: vibrations de l'air - flux sonore et photonique - lumière;  la concentration de vapeur d'eau dans l'air et la température de la terre;  la présence ou l'absence de masse et son ampleur.  Et ainsi de suite.  Tout cela peut nous apporter les informations nécessaires à la prise de décision. </p><br><p>  Mais notre microcontrôleur <strong>ESP8266</strong> - la base de <strong>ShIoTiny</strong> - ne comprend que deux types d'informations - les signaux binaires numériques <strong>0V</strong> - <strong>3V</strong> et les signaux analogiques dans la plage de <strong>0V</strong> à <strong>1V</strong> . </p><br><p>  Par conséquent, nous avons besoin de « <strong>traducteurs</strong> » de la langue d'un phénomène physique ou d'une quantité physique particulière à la langue de signaux électriques compréhensibles par le microcontrôleur <strong>ESP8266</strong> .  Ces " <strong>traducteurs</strong> " sont appelés <strong><em>capteurs</em></strong> . </p><br><p>  À strictement parler, dans notre cas, le <strong><em>capteur</em></strong> est un outil technique qui convertit les informations sur le monde environnant en signaux électriques compréhensibles par les composants électroniques du contrôleur <strong>ShIoTiny</strong> . </p><br><p>  Les capteurs sont différents.  Il y a des milliers et des ténèbres.  Mais si vous commencez à comprendre, alors tout n'est pas si effrayant.  <em>Premièrement</em> , nous ne nous intéressons qu'aux capteurs qui génèrent un signal électrique en sortie.  <em>Deuxièmement</em> , nous nous limiterons uniquement aux types de capteurs populaires.  Et <em>troisièmement</em> , dans la pratique, il n'y a pas autant de types de signaux générés par les capteurs. </p><br><p>  Dès le "premier" - tout est clair.  Il est physiquement impossible de <strong>connecter</strong> directement <strong>un</strong> capteur à <strong>ShIoTiny</strong> qui fournit des informations sous forme mécanique, hydraulique ou pneumatique. </p><br><p>  Avec "deuxièmement" - tout est également clair.  Il est peu probable que quiconque connecte des détecteurs de particules rapides ou des pH-mètres spécifiques dans un lithium radioactif fondu à <strong>ShIoTiny</strong> .  Eh bien, si quelqu'un le fait, je pense que ses qualifications sont beaucoup plus élevées que les miennes et il n'aura probablement pas besoin de cet article.  Mais la température de l'eau ou de l'air, la pression de l'air ou de l'eau, l'humidité, la lumière, le niveau de liquide ou l'état de la porte (ouverte-fermée) - tout cela peut très bien être mesuré par le contrôleur ShIoTiny dans les systèmes de contrôle domestique. </p><br><p>  Nous traiterons du "troisième".  Quels signaux électriques sont généralement émis par les types de capteurs courants?  On distingue trois principaux types de signaux aux sorties des capteurs: </p><br><p>  <strong>Signaux binaires</strong>  Autrement dit, les signaux qui n'ont que deux niveaux - logique 0 ou logique 1. Les paramètres électriques ne sont pas importants - ils peuvent toujours être convertis aux niveaux souhaités. </p><br><p>  <strong>Signaux analogiques</strong> .  C'est-à-dire, le courant ou la tension, variant en fonction du paramètre mesuré dans une plage de valeurs donnée. </p><br><p>  <strong>Signaux numériques</strong> .  Ce sont des capteurs qui communiquent avec des microcontrôleurs à l'aide d'un protocole spécifique. </p><br><p>  Voici peut-être toutes les options qui peuvent être connectées à <strong>ShIoTiny</strong> .  Bien sûr, il existe également des capteurs avec une sortie de fréquence, une sortie de phase et des capteurs avec toutes sortes de signaux de sortie exotiques.  Mais comme il est <strong>impossible</strong> de les connecter directement à <strong>ShIoTiny,</strong> nous n'en parlerons pas maintenant. </p><br><h4 id="binarnye-vhody-shiotiny">  Entrées binaires ShIoTiny </h4><br><p>  Commençons par le plus simple - avec les entrées binaires <strong>ShIoTiny</strong> .  Ils sont indiqués par <strong>Input1</strong> , <strong>Input2</strong> et <strong>Input3</strong> .  Puisque ces entrées sont absolument identiques, nous considérerons l'entrée <strong>Input1</strong> .  Tout ce qui est dit sur cette entrée est tout aussi vrai pour les deux autres entrées binaires - <strong>Input2</strong> et <strong>Input3</strong> . </p><br><p>  Le <strong>circuit d'</strong> entrée binaire <strong>ShIoTiny est</strong> illustré sur la figure.  Faites immédiatement une réservation, le circuit avec un petit défaut - il était nécessaire de connecter une résistance <strong>10K</strong> à une résistance <strong>1K</strong> .  Mais cela n'affecte pas le fonctionnement de l'appareil et c'est merveilleux.  Alors, pourquoi y a-t-il autant d'éléments dans un circuit d'entrée binaire?  Une telle question m'a également été posée.  J'essaierai d'y répondre. </p><br><p><img src="https://habrastorage.org/webt/eo/ff/qh/eoffqhr5eib1g5jwc1wa5mojsyc.gif" alt="image"></p><br><p>  L'entrée binaire dans <strong>ShIoTiny</strong> fonctionne sur <em>les</em> contacts « <em>secs</em> » et « <em>humides</em> ».  De plus, le circuit offre une protection contre les surtensions (c'est-à-dire si, par exemple, 5 Volts au lieu de 3 Volts parviennent à <strong>Input1</strong> , par exemple). </p><br><h4 id="zaschita-binarnogo-vhoda">  Protection des entrées binaires </h4><br><p>  <strong>La</strong> protection contre les <strong>surtensions</strong> , qui est effectuée sur toutes les entrées binaires de <strong>ShIoTiny</strong> , ne sauvera bien sûr pas le contrôleur de l'épuisement si une tension de ~ 220V est appliquée à son entrée.  Mais de l'accès aux entrées <strong>Input1,2,3</strong> <strong>+ 5V</strong> ou même <strong>+ 12V</strong> - cette protection sauve complètement. </p><br><p>  Cette protection fonctionne très simplement et peut être appliquée non seulement avec l' <strong>ESP8266</strong> , mais aussi avec d'autres microcontrôleurs. </p><br><p>  Considérez deux options pour la protection: lors de l'application d' <strong>une</strong> tension de <strong>+ 5V</strong> et <strong>-5V</strong> au fil neutre ( <strong>masse</strong> ) à l'entrée <strong>Input1</strong> . </p><br><p>  Lorsque la tension à l'entrée <strong>Input1</strong> est normale, les diodes de protection <strong>D1</strong> et <strong>D2</strong> sont fermées, car elles sont allumées dans le sens opposé. </p><br><p>  Dès que la tension à <strong>Input1</strong> dépasse + 3V (par exemple, nous avons <strong>court-circuité Input1</strong> à <strong>+ 5V</strong> ), la diode <strong>D1</strong> s'ouvre et tire l'entrée du contrôleur <strong>GPIO</strong> à <strong>+ 3V</strong> , empêchant la tension au <strong>GPIO ESP8266</strong> <strong>de</strong> dépasser <strong>3V</strong> .  En fait, la tension sera légèrement supérieure à <strong>3 V</strong> (3,2 <strong>V</strong> ou 3,3 <strong>V</strong> ) - mais ce n'est pas important.  L'entrée du microcontrôleur ne brûle pas et c'est important. </p><br><p>  Dès que la tension à l'entrée <strong>1</strong> devient négative (par exemple, nous avons court-circuité l'entrée à <strong>-5 V</strong> ), la diode <strong>D2</strong> s'ouvre et tire l'entrée <strong>1</strong> à la <strong>masse</strong> <strong>0 V</strong> , sans laisser la tension à l'entrée <strong>GPIO ESP8266</strong> descendre en dessous de <strong>0 V.</strong>  En fait, la tension sera légèrement inférieure à <strong>0 V</strong> (-0,2 V ou -0,3 V) - mais ce n'est encore une fois pas important.  L'entrée du microcontrôleur ne brûle pas. </p><br><p>  La résistance <strong>1K</strong> est un limiteur de courant pour qu'il n'y ait pas de court-circuit pendant le fonctionnement de la protection.  Les courants qui le traversent sont faibles.  Par exemple, dans notre exemple, si nous <strong>appliquons Input1</strong> <strong>+ 5V</strong> à l'entrée, le courant à travers la résistance <strong>1K</strong> sera d'environ <strong>2mA</strong> .  Avec une tension négative de <strong>-5V</strong> à l'entrée <strong>Input1, le</strong> courant à travers la résistance <strong>1K</strong> sera d'environ <strong>5mA</strong> . </p><br><p>  Si quelqu'un ne comprend pas pourquoi les diodes s'ouvrent et se ferment, je recommande de lire le livre <strong>"Electronics Step by Step" de R. A. Svorenya</strong> .  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Sur Internet, c'est par exemple ici</a> .  Je conseille particulièrement les débutants - le langage de ce livre est simple et il y a plein d'exemples. </p><br><h4 id="kakie-byvayut-kontakty">  Quels sont les contacts </h4><br><p>  Donc, avec la protection triée.  Passons à un autre problème fondamental - la connexion de l'entrée binaire <strong>ShIoTiny</strong> aux capteurs binaires. </p><br><p>  Comme nous l'avons déjà dit, les capteurs binaires sont des capteurs dont la sortie a deux états - zéro et un.  Mais c'est logique.  Et physiquement, il peut y avoir deux options pour les sorties du capteur binaire: « <strong>contact sec</strong> » et « <strong>contact humide</strong> ».  Considérez ce que c'est et avec quoi il est mangé. </p><br><p>  Un « <strong>contact sec</strong> » est un contact qui n'a pas sa propre source de tension.  Autrement dit, juste deux conducteurs métalliques qui peuvent être court-circuités ensemble et les ouvrir.  Cette définition inclut la masse des capteurs - boutons, interrupteurs, capteurs à flotteur pour le niveau de liquide, interrupteurs à lames (capteurs de champ magnétique), etc.  Sur les circuits électriques, <strong>les</strong> « <strong>contacts secs</strong> » <strong>normalement ouverts</strong> sont généralement indiqués comme indiqué sur la figure. </p><br><p><img src="https://habrastorage.org/webt/vt/rc/ya/vtrcyaeq7yo2o4hdju-2edxx_7w.png" alt="image"></p><br><p>  Normalement ouvert - cela signifie ouvert lorsqu'il n'y a pas d'influence extérieure - le bouton n'est pas enfoncé, l'interrupteur n'est pas activé, l'interrupteur à lames n'a pas d'aimant à proximité ... </p><br><p>  Il existe également <strong>des</strong> « <strong>contacts secs</strong> » <strong>normalement fermés</strong> .  Sur les circuits électriques, ils sont généralement indiqués comme indiqué sur la figure. </p><br><p><img src="https://habrastorage.org/webt/ze/mj/lj/zemjljubtoz6y8gldzq6gb5qznq.png" alt="image"></p><br><p>  Contrairement aux <strong>contacts secs</strong> normalement ouverts, normalement fermés, en l'absence d'influences externes, ils sont fermés. </p><br><p>  Ces deux <strong>contacts</strong> et d'autres " <strong>contacts secs</strong> " peuvent être connectés en toute sécurité aux entrées <strong>du</strong> contrôleur <strong>Input1,2,3 ShIoTiny</strong> .  Les capteurs avec une sortie de type <strong>contact sec</strong> sont <strong>connectés aux</strong> entrées binaires <strong>ShIoTiny</strong> comme indiqué sur la figure. </p><br><p><img src="https://habrastorage.org/webt/8j/fs/8i/8jfs8i8xydqsyuirvrrtihvotly.gif" alt="image"></p><br><p>  Si le « <strong>contact sec</strong> » de l'entrée <strong>1</strong> est fermé, alors une tension d'environ zéro volt est appliquée à l'entrée du contrôleur (plus précisément, 0,3 volt en raison d'une erreur dans le circuit), car le « <strong>contact sec</strong> » ferme l'entrée du contrôleur à la terre via un diviseur formé de résistances <strong>1K</strong> et <strong>10K</strong> .  Dans ce cas, le <em>nœud</em> <strong>Input1</strong> définira l'unité en sortie. </p><br><p>  Inversement, si le <strong>contact sec de</strong> <strong>Input1 est</strong> ouvert, alors environ trois volts sont fournis à l'entrée du contrôleur, puisque l'entrée du contrôleur est tirée à la tension d'alimentation via une résistance de <strong>10K</strong> .  Dans ce cas, le nœud <strong>Input1</strong> mettra zéro à sa sortie. </p><br><p>  Toute cette description détaillée est destinée aux curieux.  En fin de compte, nous avons ce qui suit: si nous avons connecté un capteur avec une sortie de type « <strong>contact sec</strong> » à l' <strong>entrée1</strong> , alors lorsque le contact est ouvert, la sortie du nœud <strong>Input1</strong> sera nulle, et lorsque le contact est fermé, la sortie du même nœud sera un.  De même pour les entrées et les nœuds <strong>Input2</strong> et <strong>Input3</strong> . </p><br><p>  Passons aux <strong>contacts humides</strong> . </p><br><p>  Un « <strong>contact humide</strong> » est un contact qui a sa propre source de tension dans au moins une de ses positions.  Par exemple, la sortie d'un autre contrôleur ou circuit logique;  ampoule ligne électrique et ainsi de suite.  Il peut y avoir beaucoup d'options ici.  Mais presque tous, directement ou à l'aide de plusieurs détails, permettent de faire correspondre les entrées binaires <strong>Input1,2,3</strong> avec la sortie de l'appareil - « <strong>contact humide</strong> ». </p><br><p>  Commençons par le plus simple - faire correspondre l'entrée <strong>Input1</strong> avec la sortie du capteur ou du type de microcircuit " <strong>collecteur ouvert</strong> " ou " <strong>drain ouvert</strong> ". </p><br><p>  En fait, <strong><em>dans notre cas</em></strong> , ce circuit est complètement analogue à la connexion d'un capteur avec une <strong>sortie à contact sec</strong> .  Seul le rôle du contact est assuré par le transistor. </p><br><p>  Le schéma de cette connexion est illustré dans la figure.  L'essence du concept de " <strong>collecteur ouvert</strong> " ou " <strong>drain ouvert</strong> " est que l' <strong>émetteur</strong> (ou la <strong>source</strong> ) du transistor de sortie est connecté à la " <strong>masse</strong> " (souvent juste à l'intérieur du microcircuit), et le <strong>collecteur</strong> (ou <strong>drain</strong> ) est connecté à la "jambe" du microcircuit et plus encore. à rien. </p><br><p>  Le fonctionnement de ce schéma est compréhensible pour un novice (pas un gaz imaginaire, mais une personne!).  Dès que le transistor à l'intérieur du microcircuit s'ouvre, il ferme l'entrée <strong>Input1</strong> à la masse puis tout fonctionne par analogie avec un contact « <strong>sec</strong> ». </p><br><img src="https://habrastorage.org/webt/tl/__/nh/tl__nhsp-3hwmb1eztprk1lxo0g.gif"><br><p>  Malheureusement, toutes les micropuces et capteurs n'ont pas une sortie aussi merveilleuse avec un collecteur ouvert ou un drain.  Beaucoup, sinon la plupart des puces et capteurs ont une sortie active.  Cela signifie que lorsque nous avons une unité logique à la sortie, la sortie est «remontée» à la tension d'alimentation, et lorsqu'un zéro logique, la sortie est «remontée» à la masse.  La sortie d'une telle puce est illustrée dans la figure ci-dessous.  Bien sûr, tout est simplifié. </p><br><img src="https://habrastorage.org/webt/ll/9p/ca/ll9pcawme5kebyua--xi9hscacu.gif"><br><p>  Que devons-nous faire si le microcircuit ou le capteur que nous voulons connecter à <strong>Input1</strong> a une telle sortie active? </p><br><p>  Il y a deux options ici et elles dépendent de la valeur de la tension d'alimentation du microcircuit ou du capteur <strong>Vcc</strong> . </p><br><p>  Si la tension d'alimentation de la puce ou du capteur <strong>Vcc</strong> est la même que celle de l' <strong>ESP8266</strong> (c'est-à-dire 3 Volts), vous pouvez simplement connecter cette sortie à l'entrée <strong>Input1</strong> , qui est en fait illustrée dans la figure précédente. </p><br><p>  Mais que faire si l'alimentation du capteur ou du microcircuit est de <strong>+ 5V</strong> ou <strong>+ 12V</strong> ?  Dans notre cas, vous pouvez le faire tout simplement en allumant la diode Schottky, comme indiqué dans la figure ci-dessous. </p><br><img src="https://habrastorage.org/webt/xo/ig/mh/xoigmhvkz7mjgd4htvm2ygddtq8.gif"><br><p>  Et encore une nuance: tous les circuits avec un contact « <strong>humide</strong> » nous donnent un <strong>signal inverse</strong> .  Autrement dit, lorsque l'unité logique est à la sortie du capteur ou du microcircuit, le nœud <strong>Input1</strong> mettra la sortie à zéro.  Et vice versa.  Mais cela est corrigé par programme - il suffit d'insérer le nœud de l'onduleur dans le circuit.  Tout cela est illustré dans la figure. </p><br><p><img src="https://habrastorage.org/webt/va/xh/te/vaxhteujl9fg9mlmom0ex2hijgm.png" alt="image"></p><br><p>  En fait, c'est tout ce que vous devez savoir sur la connexion des capteurs aux entrées binaires <strong>Input1,2,3</strong> . </p><br><p>  Bien sûr, théoriquement, il peut y avoir d'autres options, mais j'ai montré les moyens les plus simples et les plus courants de connecter des capteurs avec <strong>des</strong> sorties à <strong>contact sec</strong> et des sorties actives basse tension. </p><br><h4 id="trepet-kontaktov">  Sensation de contact </h4><br><p>  Les contacts tremblent.  Pas par crainte du créateur de l'appareil, mais par le fait qu'ils sont résistants.  Lorsque vous appuyez sur le bouton, les contacts peuvent se fermer de 5 à 7 fois avant d'être fermés de manière stable.  Le même phénomène se produit lorsque les boutons sont relâchés.  Et ce phénomène est appelé - « <strong>rebond des contacts</strong> ». </p><br><p>  <strong>Le rebond de contact</strong> est la malédiction de tous les capteurs de contact mécaniques - interrupteurs, boutons, interrupteurs à lames et ainsi de suite.  Le bavardage désagréable est qu'il provoque de faux clics ou de fausses relâchements d'un bouton ou d'un contact. </p><br><p>  Il existe plusieurs façons de faire face à ce phénomène désagréable.  Le <strong>déclencheur</strong> est probablement la façon la plus ancienne de se battre.  Avec cette méthode, un bouton avec un contact de commutation et un déclencheur RS normal sont utilisés, qui sont activés selon le schéma, comme indiqué sur la figure. </p><br><p><img src="https://habrastorage.org/webt/1s/lm/yo/1slmyoteklx46ct9nfgjt-hevtk.png" alt="image"></p><br><p>  Comment ça marche?  Très simple.  Un déclencheur a deux états.  Alors que le bouton est fermé sur l'entrée <strong>R du</strong> déclencheur, la sortie <strong>Q du</strong> déclencheur est mise à zéro. </p><br><p>  Nous avons appuyé sur le bouton - jusqu'à ce que le contact central du bouton touche le bas - rien ne change, la sortie de la gâchette est nulle.  Dès que le contact central du bouton a touché le contact inférieur du même bouton et fermé l'entrée du déclencheur <strong>S</strong> à la masse, on apparaît à la sortie du déclencheur.  Et cette unité reste alors que les contacts "cliquettent".  En effet, pour remettre la sortie de déclenchement à zéro, il faut que l'entrée de déclenchement <strong>R</strong> soit court-circuitée à la masse!  Ce schéma fonctionne exactement de la même manière lorsque vous relâchez le bouton. </p><br><p>  Pouvons-nous faire un tel circuit sur <strong>ShIoTiny</strong> ?  Oui, pas de problème!  Sur la figure, il est illustré. </p><br><p><img src="https://habrastorage.org/webt/hz/p2/yg/hzp2yg7lx4zo7i6ko8lyok3iikk.png" alt="image"></p><br><p>  Mais passer deux de leurs trois entrées sur un capteur?!  De plus, tous les capteurs n'ont pas de contact de commutation! </p><br><p>  Non, nous irons dans l'autre sens, comme légué, à tout l'ingénieux théoricien V.I.  Ulyanov! </p><br><p>  La deuxième manière, et probablement la plus courante aujourd'hui, de gérer le rebond de contact est un <strong>filtre logiciel</strong> . </p><br><p>  Qu'est-ce qui se cache derrière ces mots intelligents?  Et encore une fois - rien de compliqué.  Imaginez que nous ne répondions pas aux «courts» changements d'état des contacts.  Par exemple, si nous lisons zéro sur le bouton, puis pour de courtes (par exemple, la durée est inférieure à 0,3 sec) des rafales unitaires, nous <del>  nous martelons </del>  arrête de réagir.  Et ce n'est que lorsque nous aurons un bouton pendant 0,3 seconde que nous émettrons continuellement une unité - nous y répondrons.            . </p><br><p>     —    ,   .         .         RS-! </p><br><p>     ?  <strong>ShIoTiny</strong>  -,          . </p><br><p><img src="https://habrastorage.org/webt/-t/tv/hq/-ttvhqvwjzrj1_8f0rzuztiugz4.png" alt="image"></p><br><p>  <strong>Delay0/1</strong>      ,     <strong>0.4</strong> . </p><br><p> ,          .   ,   ,      . </p><br><h4 id="zaklyuchenie">  Conclusion </h4><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> En conclusion, je voudrais m'excuser auprès de ceux à qui cet article semblait inutilement détaillé - rappelez-vous qu'il y a beaucoup de gens sur le hub qui ne sont pas aussi sages que vous. </font></font></p><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dans le prochain article, nous examinerons la connexion de capteurs avec un signal de sortie analogique à l'entrée </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ADC</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></p><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Comme toujours, suggestions, souhaits, questions, fautes de frappe, etc., par e-mail: shiotiny@yandex.ru </font></font></p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr466231/">https://habr.com/ru/post/fr466231/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr466215/index.html">Conception orientée modèle. Création d'un modèle fiable, à partir de l'exemple d'un échangeur de chaleur aviation</a></li>
<li><a href="../fr466217/index.html">Génération de documents à l'aide d'ONLYOFFICE DocumentBuilder</a></li>
<li><a href="../fr466223/index.html">Décomposition propre</a></li>
<li><a href="../fr466227/index.html">Programmation orientée nœud</a></li>
<li><a href="../fr466229/index.html">Comment acheter dix boîtes de coton et ne pas se tromper</a></li>
<li><a href="../fr466235/index.html">Munch dans un scan équidistant et Meyerhold, qui a détruit la Place Rouge - Denis Semenov sur l'art VR</a></li>
<li><a href="../fr466237/index.html">Comment le junior vert a écrit son hot-recharger</a></li>
<li><a href="../fr466247/index.html">Entretien de Introvert</a></li>
<li><a href="../fr466249/index.html">Écrire un serpent pour Android dans Kivy, Python</a></li>
<li><a href="../fr466251/index.html">Faire passer le projet de Soft Launch à 1 million de dollars de revenus par mois</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>