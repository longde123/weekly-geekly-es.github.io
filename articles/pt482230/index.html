<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚öíÔ∏è üí¢ üïπÔ∏è A batalha dos servidores WEB. Parte 2 - cen√°rio HTTPS realista: üöç üë®üèø üèçÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Falamos sobre a t√©cnica na primeira parte do artigo, neste testamos o HTTPS, mas em cen√°rios mais realistas. Para o teste, o certificado Let's Encrypt...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>A batalha dos servidores WEB. Parte 2 - cen√°rio HTTPS realista:</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ultravds/blog/482230/"><img src="https://habrastorage.org/getpro/habr/post_images/e98/b4f/df1/e98b4fdf1818cb6bfaf1d464ee87e3ac.png"><br><br>  Falamos sobre a t√©cnica na <a href="https://habr.com/ru/company/ultravds/blog/478854/">primeira parte do</a> artigo, neste testamos o HTTPS, mas em cen√°rios mais realistas.  Para o teste, o certificado Let's Encrypt foi recebido, a compacta√ß√£o Brotli por 11 foi ativada. <br><br>  Desta vez, tentaremos reproduzir o cen√°rio de implanta√ß√£o do servidor no VDS ou como uma m√°quina virtual em um host com um processador t√≠pico.  Para fazer isso, defina o limite para: <br><br><ul><li>  25% - Que em termos de frequ√™ncia ~ 1350MHz </li><li>  35% -1890MHz </li><li>  41% - 2214MHz </li><li>  65% - 3510MHz </li></ul><br>  O n√∫mero de conex√µes √∫nicas diminuiu de 500 para 1, 3, 5, 7 e 9, <br><a name="habracut"></a><br><h2>  Resultados: </h2><br><h3>  Atrasos: </h3><br>  O TTFB foi feito especialmente como um teste separado, porque o HTTPD Tools cria um novo usu√°rio para cada solicita√ß√£o individual.  Esse teste ainda est√° bastante separado da realidade, porque o usu√°rio clica em algumas p√°ginas de qualquer maneira e, na realidade, o TTFP desempenhar√° o papel principal. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d16/3a9/a21/d163a9a21730a7837ec6adccb4758e4d.png"></div><br>  A primeira, geralmente a primeira solicita√ß√£o, ap√≥s o primeiro in√≠cio da m√°quina virtual, o IIS processa uma m√©dia de 120 ms. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/586/dcb/0c9/586dcb0c9eeb8443c4cd52fd49a3d5c3.png"></div><br>  Todas as solicita√ß√µes subseq√ºentes mostram um TTFP de 1,5 ms.  Apache e Nginx est√£o atrasados.  Pessoalmente, o autor considera esse teste o mais revelador e escolheria apenas um vencedor. <br>  O resultado n√£o √© surpreendente, pois o IIS armazena em cache o conte√∫do est√°tico j√° compactado e n√£o o pin√ßa toda vez que √© acessado. <br><br><h3>  Tempo gasto em um cliente </h3><br>  Para avaliar o desempenho, basta um teste com 1 conex√£o √∫nica. <br>  Por exemplo, o IIS concluiu o teste com 5.000 usu√°rios em 40 segundos, ou seja, 123 solicita√ß√µes por segundo. <br><br>  Os gr√°ficos abaixo mostram o tempo at√© a transfer√™ncia completa do conte√∫do do site.  Essa √© a porcentagem de solicita√ß√µes conclu√≠das em um hor√°rio espec√≠fico.  No nosso caso, 80% de todas as solicita√ß√µes foram processadas em 8ms no IIS e 4.5ms no Apache e Nginx, e 98% de todas as solicita√ß√µes no Apache e Nginx foram executadas dentro de um intervalo de 8 milissegundos. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/305/e49/03c/305e4903cc0a2abf597b14132c8cdd85.png"></div><br>  O tempo necess√°rio para processar 5000 solicita√ß√µes: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f29/ef5/871/f29ef587182d7dd5e7df53af806855b0.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c52/60b/c4a/c5260bc4a393960d4116fb843ea7ffb1.png"></div><br>  O tempo necess√°rio para processar 5000 solicita√ß√µes: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/753/d66/f67/753d66f67f474f3c86c1fee8883b2a70.png"></div><br>  Se voc√™ possui uma m√°quina virtual com uma CPU de 3,5 GHz e 8 n√∫cleos, escolha o que deseja.  Todos os servidores da web s√£o muito semelhantes neste teste.  Falaremos sobre qual servidor web escolher para cada host abaixo. <br><br>  Quando se trata de uma situa√ß√£o um pouco mais real, todos os servidores da Web ficam cara a cara. <br><br><h3>  Rendimento: </h3><br>  Programa√ß√£o de atrasos no n√∫mero de conex√µes simult√¢neas.  Mais suave e mais baixo √© melhor.  Os √∫ltimos 2% foram jogados fora dos gr√°ficos porque os tornariam ileg√≠veis. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/06a/504/0ba/06a5040ba38a1ce27336a473f875a6a9.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/030/ac4/25a/030ac425a43f2508d1c8ce2235be30a2.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6ea/caf/960/6eacaf96036c0cb5032908b98977b1ef.png"></div><br>  Agora considere a op√ß√£o em que o servidor est√° hospedado em uma hospedagem compartilhada.  Tome 4 n√∫cleos a 2,2 GHz e um n√∫cleo a 1,8 GHz. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4b3/220/859/4b3220859223d1388b4c00b3eeb55194.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/0c1/d28/e1c/0c1d28e1cd67942fbc54a472bd28942a.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1ee/bec/40e/1eebec40e354a86a11b9324449fa49cf.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2f3/a99/53b/2f3a9953b0c7812932669f0b83a95c1b.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6f7/f98/f4f/6f7f98f4f4182b6560b653e4a0e8f6ac.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f2e/ca6/632/f2eca66320f4b03d34772fe7cf3403d6.png"></div><br><h2>  Como escalar </h2><br>  Se voc√™ j√° viu como s√£o as caracter√≠sticas I-V dos triodos de eletro-v√°cuo, pentodos, etc., esses gr√°ficos lhe ser√£o familiares.  √â isso que estamos tentando entender - saciedade.  O limite √© que, quando voc√™ n√£o joga quantos n√∫cleos, o crescimento da produtividade n√£o ser√° percept√≠vel. <br><br>  Anteriormente, todo o desafio era processar 98% das solicita√ß√µes com o menor atraso em todas as solicita√ß√µes, para manter a curva o mais uniforme poss√≠vel.  Agora, usando a constru√ß√£o de outra curva, encontramos o ponto operacional ideal para cada um dos servidores. <br><br>  Para fazer isso, use a m√©trica Solicita√ß√µes por segundo (RPR).  Frequ√™ncia horizontal, vertical - o n√∫mero de solicita√ß√µes processadas por segundo, linhas - o n√∫mero de n√∫cleos. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b49/5b4/1e2/b495b41e2ce0c33e84ed23b5ff3820d7.png"></div><br>  √â mostrada uma correla√ß√£o de qu√£o bem o Nginx lida com as solicita√ß√µes uma a uma.  8 n√∫cleos em tais testes se mostram melhor. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/0fc/73f/540/0fc73f5402df4d787ecffd3e838323d2.png"></div><br>  Este gr√°fico mostra claramente quanto melhor (n√£o muito) o Nginx √© executado em um √∫nico n√∫cleo.  Se voc√™ possui o Nginx, considere reduzir o n√∫mero de n√∫cleos para um se hospedar apenas est√°tica. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/201/608/276/201608276469ea155f7d151bae839d7f.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/45b/a4c/311/45ba4c311df1dc07220af9cc9c78a711.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4ea/dd6/831/4eadd68312d67d4579c9596b62cd6cb1.png"></div><br>  O IIS, embora tenha o TTFB mais baixo de acordo com o DevTools no Chrome, consegue perder o Nginx e o Apache em uma luta s√©ria contra o teste de estresse da Apache Foundation. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d95/f30/1a8/d95f301a854c9ebbd20aada507b7194c.png"></div><br>  Toda a curvatura dos gr√°ficos √© reproduzida por trem. <br><br><h2>  Uma esp√©cie de conclus√£o: </h2><br>  Sim, o Apache funciona pior nos n√∫cleos 1 e 8 e no 4 funciona um pouco melhor. <br><br>  Sim, o Nginx em 8 n√∫cleos lida com solicita√ß√µes melhores uma ap√≥s a outra, nos n√∫cleos 1 e 4 e funciona pior quando h√° muitas conex√µes. <br><br>  Sim, o IIS prefere 4 n√∫cleos para carga multithread e 8 n√∫cleos para single threaded.  No final, o IIS foi um pouco mais r√°pido do que todos os 8 n√∫cleos sob alta carga, embora todos os servidores tenham sido liberados. <br><br>  Este n√£o √© um erro de medi√ß√£o, o erro aqui n√£o passa de + -1ms.  em atrasos e n√£o mais que + - 2-3 solicita√ß√µes por segundo para RPR. <br><br>  Os resultados, quando oito n√∫cleos s√£o piores, n√£o surpreendem, muitos n√∫cleos e o SMT / Hyperthreading degradam severamente o desempenho se tivermos o prazo para o qual devemos concluir todo o pipeline. <br><br>  Oferecemos uma tarifa atualizada do UltraLite <a href="https://ultravds.com/">Windows VDS</a> por 99 rublos com o Windows Server 2019 Core instalado. <br> <a href="https://ultravds.com/"><img src="https://habrastorage.org/webt/ww/d4/ro/wwd4ro5_5a28hvdxyazf3enjxou.png"></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt482230/">https://habr.com/ru/post/pt482230/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt482220/index.html">Localiza√ß√£o de marcadores Aruco</a></li>
<li><a href="../pt482222/index.html">Aplicativo da Web no Kotlin + Spring Boot + Vue.js (complemento)</a></li>
<li><a href="../pt482224/index.html">Quando um designer precisa ser um pouco programador</a></li>
<li><a href="../pt482226/index.html">Os 20 principais aplicativos que um profissional de sa√∫de n√£o pode perder</a></li>
<li><a href="../pt482228/index.html">N√≥s escrevemos uma "calculadora" em C #. Parte I. C√°lculo do valor, derivada, simplifica√ß√£o e outros gansos</a></li>
<li><a href="../pt482232/index.html">StackOverflow √© mais do que apenas um reposit√≥rio de respostas para perguntas est√∫pidas</a></li>
<li><a href="../pt482234/index.html">Modelagem digital para anal√≥gica e mista no PADS Professional</a></li>
<li><a href="../pt482240/index.html">Desmontamos os primeiros dispositivos TP-Link com o roteador Wi-Fi 6: Archer AX6000 e o adaptador Archer TX3000E</a></li>
<li><a href="../pt482244/index.html">Resultados dos testes de c√¢mera cega: iPhone, Pixel, Huawei, Samsung</a></li>
<li><a href="../pt482248/index.html">Compartilhamos nossa experi√™ncia de como os SSDs aparecem sob RAID e qual n√≠vel de matriz √© mais lucrativo</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>