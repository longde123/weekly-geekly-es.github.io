<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üõãÔ∏è üë©‚Äçüåæ üßíüèø Jet frontend. La historia de c√≥mo reescribimos todo de nuevo. üêí üöÇ ‚úåÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hola, soy Katya de Yandex. Dinero de nuevo. Contin√∫o mi historia sobre c√≥mo dej√© de inventarme y comenc√© a vivir. En la primera parte, cont√© c√≥mo lleg...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Jet frontend. La historia de c√≥mo reescribimos todo de nuevo.</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yamoney/blog/414183/">  Hola, soy Katya de Yandex. Dinero de nuevo.  Contin√∫o mi historia sobre c√≥mo dej√© de inventarme y comenc√© a vivir.  En la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">primera</a> parte, cont√© c√≥mo llegu√© aqu√≠ y qu√© hacen nuestros desarrolladores front-end.  Hoy, sobre la pila frontal, de d√≥nde es React y d√≥nde se fue BEM. <br><br>  Spoiler: BEM no ha ido a ninguna parte ¬Ø \ _ („ÉÑ) _ / ¬Ø.  Vamos! <br><br><img src="https://habrastorage.org/webt/en/f4/oz/enf4ozorjurjqvgcr5nozsfcmfi.jpeg"><br><br>  Atenci√≥n: alta concentraci√≥n de frontend.  Mucho texto, im√°genes y c√≥digo, como se prometi√≥. <br><a name="habracut"></a><br><h1>  Parte 2. Sobre tecnolog√≠a </h1><br>  Lejos 2016. Intentando escribir en React, resulta bastante tolerable.  Todav√≠a no sospecho que en un a√±o transferir√© servicios completos a React.  2017 comienza en Yandex. Dinero, tengo un BEM del cerebro, y todav√≠a no sospecho. <br><br><h1>  Backend en Node.js, mi primera vez </h1><br>  Para familiarizarse con el proyecto, un nuevo desarrollador recibe una tarea de prueba.  Tuve suerte: tuve esta tarea de la cartera de pedidos.  Y el primer d√≠a me encontr√© con Node.js. <br><br>  El front-end en Yandex.Money es responsable no solo del lado del cliente, sino tambi√©n de la capa del servidor como una aplicaci√≥n Node.js.  La tarea de la aplicaci√≥n es organizar los datos del backend de Java para la preparaci√≥n en una forma orientada a la vista, as√≠ como el enrutamiento y la representaci√≥n del servidor.  Te lo habr√≠an dicho hace un par de a√±os, no habr√≠a entendido nada, y todo es bastante simple: cuando una solicitud llega desde el navegador al servidor, Node.js genera solicitudes HTTP para el backend, recibe los datos necesarios y las p√°ginas web de plantillas.  Usamos <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Express</a> como el marco del servidor, y para desarrollar aplicaciones internas sin un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">enlace</a> heredado <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">,</a> decidimos usar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Koa2</a> .  A los desarrolladores les encant√≥ el dise√±o del marco, y decidimos no degradar a Express, por lo que Koa2 permaneci√≥ en la pila.  Pero no implementamos el c√≥digo Koa2 para usuarios externos: el marco no tiene suficiente soporte, pero hay vulnerabilidades abiertas. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Ya escribimos</a> sobre el lugar de Node.js en nuestra interfaz, pero desde entonces algo ha cambiado.  Node.js 8 se ha convertido en LTS y ya se est√° ejecutando en nuestros servidores de producci√≥n.  Tambi√©n queremos abandonar los servidores Nginx, que generamos en cada host para distribuir estad√≠sticas; ser√°n reemplazados por servidores separados con Nginx y alg√∫n d√≠a CDN. <br><br>  Para buscar c√≥digo entre proyectos, pero no para que est√© disponible p√∫blicamente, utilizamos un conjunto completo de herramientas: almacenar los m√≥dulos en Bitbucket y recopilarlos en Jenkins.  Tambi√©n utilizamos el registro local de paquetes y, gracias a esto, no vamos a la red externa, esto acelera el ensamblaje y aumenta la seguridad de todo el sistema.  Los javists nos sugirieron este enfoque, son geniales.  Ama a tus seguidores;) <br><br>  Tambi√©n realizamos un experimento: introdujimos un administrador de procesos en una de las aplicaciones, lo que simplific√≥ la administraci√≥n de servicios en Node.js.  Ayud√≥ con la agrupaci√≥n y tambi√©n nos salv√≥ de un antiguo script de bash que ejecutaba aplicaciones. <br><br><h1>  Y toda la pila no es suficiente </h1><br>  Tenemos javascript en todas partes en la interfaz.  Y en el servidor, y en el cliente, y bajo el cap√≥ de las herramientas internas.  Conocemos otros idiomas, pero JavaScript hace un gran trabajo. <br><br>  Pero BEM en el marco de nuestras tareas no hace frente a todo. <br><br><div class="spoiler">  <b class="spoiler_title">¬øQu√© es el BEM?</b> <div class="spoiler_text">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">BEM</a> es un enfoque de desarrollo web inventado por Yandex durante la vida √∫til de las p√°ginas HTML est√°ticas y las cascadas CSS.  Todav√≠a no hab√≠a un enfoque de componentes, y era necesario mantener la uniformidad de muchos servicios.  Yandex no se sorprendi√≥ y desarroll√≥ su propio enfoque de componentes, que hoy le permite crear componentes aislados y escribir c√≥digo declarativo flexible. <br><br>  BEM no es solo una metodolog√≠a, sino tambi√©n un gran conjunto de tecnolog√≠as y bibliotecas.  Algunos de ellos se adaptan a los detalles espec√≠ficos de BEM, y algunos bien pueden usarse de forma aislada de la arquitectura BEM.  Si necesita un poderoso motor de plantillas o un ejemplo digno de abstracci√≥n de componentes sobre el DOM en su proyecto, ya sabe d√≥nde encontrarlos;) <br></div></div><br>  Por lo tanto, comenzamos a transferir servicios a React.  Algunos de ellos ya viven en dos aplicaciones creadas en diferentes pilas: <br><br>  - una plataforma espec√≠fica para Yandex BEM; <br>  - Reacciona el ecosistema joven y de moda. <br><br><h1>  Yandex Technologies </h1><br>  Es hora de decirte por qu√© me enamor√© de BEM. <br><br><h2>  Niveles de redefinici√≥n </h2><br>  Niveles, niveles, niveles ... ¬°BEM!  Beneficio! <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Los niveles superiores</a> son una de las principales caracter√≠sticas de la metodolog√≠a BEM.  Para entender c√≥mo funcionan, mira la imagen: <br><img src="https://habrastorage.org/webt/qs/a5/yd/qsa5yducqqeejyft1ymikcjhaxy.gif"><br><br>  La imagen est√° formada por capas superpuestas.  Cada capa cambia la imagen final, pero no cambia las otras capas.  La capa se puede extraer o agregar f√°cilmente, y la imagen cambiar√°. <br>  Los niveles de anulaci√≥n hacen lo mismo con el c√≥digo: <br><img src="https://habrastorage.org/webt/yt/x3/gt/ytx3gt_yik0xil0lw281v6xmjhy.gif"><br><br>  El comportamiento del componente se forma durante el ensamblaje del c√≥digo.  Para agregar un comportamiento adicional, simplemente conecte el nivel deseado al ensamblaje.  El c√≥digo del m√≥dulo desde diferentes niveles como si estuvieran superpuestos.  En este caso, el c√≥digo fuente no cambia, pero tenemos un comportamiento diferente, combinando diferentes niveles. <br><br><div class="spoiler">  <b class="spoiler_title">Cuales son los niveles</b> <div class="spoiler_text">  La imagen de arriba muestra varios niveles de redefinici√≥n: <br><ul><li>  El nivel b√°sico, la biblioteca, proporciona el m√≥dulo de c√≥digo fuente; <br></li><li>  El siguiente nivel, el proyecto, modifica este m√≥dulo a las necesidades del proyecto; <br></li><li>  Una plataforma de nivel superior hace que el mismo m√≥dulo sea espec√≠fico para diferentes dispositivos; <br></li><li>  La guinda del pastel, el nivel de los experimentos, cambia el m√≥dulo para las pruebas A / B. <br></li></ul><br><br>  El nivel del proyecto es independiente del nivel de la biblioteca, por lo que la biblioteca es f√°cil de actualizar.  El nivel de plataforma le permite usar un ensamblaje diferente para diferentes dispositivos.  Y el nivel con el experimento est√° conectado para probar en los usuarios y tambi√©n se apaga f√°cilmente cuando se obtienen los resultados. <br><br>  El desarrollador mismo decide qu√© niveles necesita: puede crear un nivel con un tema o un nivel con el mismo c√≥digo en un marco diferente. <br></div></div><br>  Los niveles le permiten escribir m√≥dulos complejos basados ‚Äã‚Äãen simples, combinar f√°cilmente el comportamiento y buscar el mismo c√≥digo entre servicios.  Y este c√≥digo es recopilado por <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">ENB</a> - Webpack en el mundo BEM. <br><br>  Cuando me familiaric√© con BEM, qued√© especialmente satisfecho con las bibliotecas de interfaz de usuario en las que se encuentran los componentes listos para usar.  Estamos ampliando estos componentes dentro del marco de nuevas bibliotecas y comparti√©ndolos entre proyectos.  Esto hace la vida m√°s f√°cil: rara vez invento, no escribo el mismo tipo de JS y ensamblo r√°pidamente interfaces a partir de bloques prefabricados. <br><br><img src="https://habrastorage.org/webt/wq/rg/gp/wqrggp5qnt1zkunnz73xagsgjpk.png"><br><br>  Ahora echaremos un vistazo m√°s de cerca a las herramientas de la plataforma BEM para comprender qu√© BEM no funciona lo suficientemente bien y por qu√© no se ajusta a nuestras tareas. <br><br><h2>  BEM-XJST </h2><br>  Comenzar√© con mi motor de plantillas <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">bem-xjst</a> favorito.  Antes de Yandex.Money, us√© Jade, y Bem-xjst ilustr√≥ perfectamente las desventajas de Jade, que no vi entonces.  Las plantillas bem-xjst son declarativas [1], no tienen un infierno [2], y cumplen perfectamente los requisitos del enfoque de componentes [3].  Todo esto se ve claramente en el ejemplo: <br><br><img src="https://habrastorage.org/webt/d_/hh/bz/d_hhbzkdjx9uj-fpr9olmhe8xty.png"><br><br>  En el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">sandbox,</a> puedes ver el resultado de la plantilla y jugar con ella. <br><br><div class="spoiler">  <b class="spoiler_title">Como funciona</b>  <b class="spoiler_title">Dentro est√° el secreto de la arquitectura perfecta;)</b> <div class="spoiler_text"><ul><li>  escribe BEMJSON.  BEMJSON es un JSON que describe un √°rbol BEM.  Un √°rbol BEM es una representaci√≥n del √°rbol DOM como componentes independientes; <br></li><li>  bem-xjst acepta BEMJSON como entrada y aplica patrones.  Este proceso se puede comparar con la representaci√≥n en un navegador.  El navegador omite el √°rbol DOM y aplica gradualmente reglas CSS a sus nodos DOM: tama√±o, color del texto, sangr√≠a.  Bem-xjst tambi√©n pasa por alto BEMJSON, busca plantillas correspondientes a sus nodos y las aplica gradualmente: etiqueta, atributos, contenido.  "Aplicar una plantilla" significa generar una cadena HTML a partir de ella.  La generaci√≥n de HTML de BEMJSON es manejada por uno de los motores de plantillas: BEMHTML. <br></li></ul><br><br>  Escribir plantillas es simple: seleccione la entidad y escriba las funciones que llamar√° el motor de plantillas para representar partes de la cadena HTML.  Lo m√°s dif√≠cil es resaltar la esencia.  ¬°Las entidades correctas son la clave de una buena arquitectura! <br><br>  Cuanto m√°s larga sea tu barba, mayores ser√°n las posibilidades de que ya hayas notado una referencia en el nombre de la plantilla: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">XSLT</a> (Transformaciones de lenguaje de hoja de estilo extensible) =&gt; XJST (Transformaciones de JavaScript extensible).  Utiliza los principios de XSLT y, por lo tanto, es muy declarativo.  Si no sabes qu√© es XSLT, consid√©rate afortunado :) <br></div></div><br>  Bem-xjst es isomorfo.  Representamos p√°ginas HTML en el servidor y lo cambiamos din√°micamente en el cliente.  Para crear plantillas en tiempo de ejecuci√≥n, bem-xjst proporciona una API que usamos al escribir c√≥digo javascript del lado del cliente. <br><br><h2>  I-bem </h2><br>  Con bem-xjst describimos la vista y la l√≥gica con <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">i-bem</a> .  I-bem es una abstracci√≥n sobre el DOM que proporciona una API de alto nivel para trabajar con componentes.  En pocas palabras, escribamos esto: <br><br><img src="https://habrastorage.org/webt/nb/mv/en/nbmvenurba_qz14drptqcrp_wmc.png"><br><br>  en cambio: <br><br><img src="https://habrastorage.org/webt/ev/2e/5g/ev2e5ggz8xgrzwhc6pfsqrjowiq.png"><br><br>  Para escribir c√≥digo, no necesita saber acerca de la implementaci√≥n interna del componente.  Operamos con entidades que describimos en la plantilla: de todos modos, ser√° un selector jQuery o un elemento DOM.  Podemos crear eventos personalizados adecuados para un modelo de objeto en particular, y trabajar con eventos nativos y las interfaces se ocultar√°n en la implementaci√≥n interna.  La l√≥gica de bajo nivel tambi√©n se describe all√≠, lo que significa que no cargamos el c√≥digo con la l√≥gica principal con comprobaciones innecesarias.  Como resultado, el c√≥digo es f√°cil de leer y no depende de una tecnolog√≠a espec√≠fica. <br><br>  I-bem le permite describir la l√≥gica del componente como un conjunto de estados [1].  Este es javascript declarativo.  I-bem implementa su propio Emisor de eventos: cuando los estados cambian, los componentes generan autom√°ticamente eventos a los que otro componente puede suscribirse [2]. <br><br>  As√≠ es como se ve la mayor√≠a del c√≥digo JavaScript del lado del cliente BEM: <br><br><img src="https://habrastorage.org/webt/fm/_j/bl/fm_jbln_7fjprukofbrmlj_ycrq.png"><br><br><div class="spoiler">  <b class="spoiler_title">Como funciona</b> <div class="spoiler_text"><ul><li>  mediante el evento domReady i-bem, encuentra componentes (bloques) en el √°rbol DOM y los inicializa: crea un objeto js en la memoria del navegador que corresponde al bloque; <br></li><li>  Tras la ocurrencia de los eventos necesarios, establecemos los marcadores de bloque que reflejan el estado.  El papel de los marcadores lo realizan las clases CSS.  Por ejemplo, cuando hacemos clic en input, le agregamos la clase "input_focused", que sirve como marcador; <br></li><li>  Al configurar dichos marcadores, i-bem inicia las devoluciones de llamada especificadas en la implementaci√≥n de JavaScript del bloque. <br></li></ul><br>  La l√≥gica de escritura es simple: debe describir los posibles estados del bloque (los mismos marcadores) y establecer controladores para cambiar estos estados (las mismas devoluciones de llamada). <br></div></div><br>  Con i-bem, podemos redefinir f√°cilmente el comportamiento de los componentes, crear una API bien formada para su interacci√≥n y cambiarlos din√°micamente en tiempo de ejecuci√≥n.  Entonces, ¬øqu√© falta? <br>  Nos encanta BEM por su capacidad de declaraci√≥n, escalabilidad f√°cil y abstracciones de alto nivel, pero ya no estamos listos para soportar sus limitaciones.  A continuaci√≥n, consideraremos el problema de la representaci√≥n del cliente, el almacenamiento de datos y otras limitaciones de la plataforma BEM.  Con el tiempo, los contribuyentes de BEM pueden resolver estos problemas, pero no estamos listos para esperar. <br><br>  La web moderna con SPA y la adaptabilidad para dispositivos m√≥viles tambi√©n requiere adaptabilidad de nuestra parte.  Por lo tanto, decidimos cambiar a nuestra propia pila.  Y eligieron Reaccionar. <br><br><h1>  Nueva pila de arce React </h1><br>  React trajo a nuestras vidas un DOM virtual, recarga en caliente, CSS en JS y una gran comunidad de la que nos hemos convertido en parte. <br><br>  La migraci√≥n de nuestros servicios a React est√° en pleno apogeo, algunas aplicaciones ya se han reescrito total o parcialmente en React.  Conocemos nuevos enfoques y herramientas y mejoramos la arquitectura de nuestras aplicaciones. <br><br><h2>  Bibliotecas </h2><br>  Particionar entidades de interfaz en bloques BEM independientes es muy amigable con el enfoque del componente React.  Los desarrolladores de Yandex escribieron <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">bem-react-core</a> y transfirieron la biblioteca de interfaz de usuario del componente base a React.  Escribimos una biblioteca de adaptadores que tiene en cuenta los detalles de estos componentes y los suministra como <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">HOC</a> : <br><br><img src="https://habrastorage.org/webt/2y/yg/26/2yyg26edgfevpttq3qpgl8s-alg.png"><br><br>  Dichas bibliotecas est√°n conectadas no en la aplicaci√≥n, sino en la biblioteca principal del componente: <br><br><img src="https://habrastorage.org/webt/wc/xh/h9/wcxhh9dhwnp-qmd30tnrazsjlko.png"><br><br>  La aplicaci√≥n depende solo de la biblioteca principal y obtiene todos los componentes de ella: <br><br><img src="https://habrastorage.org/webt/ub/rs/4-/ubrs4-p8-pedgu7lqrqvx81-vlu.png"><br><br>  Esto reduce el n√∫mero de dependencias de la aplicaci√≥n, y las bibliotecas no entran en el paquete dos veces en diferentes versiones. <br><br><h2>  Tecnolog√≠a </h2><br>  React no est√° vinculado a tecnolog√≠as espec√≠ficas y elegimos herramientas y bibliotecas nosotros mismos.  Hay axios, redux, forma redux, redux thunk, componentes con estilo, TypeScript, flow, broma y otras cosas interesantes en mi armamento.  Para evitar el zool√≥gico, coordinamos el uso de nuevas tecnolog√≠as con otros desarrolladores: enviamos una solicitud de extracci√≥n a un repositorio especial con un an√°lisis de cu√°n √∫til es la tecnolog√≠a y por qu√© se eligi√≥. <br><br><h2>  El front-end entra al bar, y el cantinero le dice </h2><br>  Para las aplicaciones en React, estamos creando una plataforma que reunir√° bibliotecas y procesos para crearlos y respaldarlos.  El coraz√≥n de esta plataforma es la utilidad de consola Frontend Bar.  Bar puede cocinar muchas piezas deliciosas. <br><br>  En el men√∫: <br><br><ol><li>  Configuraci√≥n con hielo: la barra mezcla y agita sus variables yml y prepara una plantilla de configuraci√≥n para ansible. <br></li><li>  Jugo con el aroma de los configuradores: bar crear√° una nueva aplicaci√≥n basada en un blanco modular: Juice. <br></li><li>  Conjunto de configuraciones b√°sicas de la biblioteca.  Pr√≥ximamente <br></li></ol><br>  Crear una aplicaci√≥n jugosa ahora es f√°cil: la barra frontal hace jugo.  ¬°Haga jugo, no guerra!  Cuando Bar implementa una nueva aplicaci√≥n, ejecuta un conjunto de configuraciones desde Juice: package.json, se genera .babelrc, middleware clave y c√≥digo de rutas, c√≥digo de componente ra√≠z.  Frontend Bar facilitar√° la asignaci√≥n de nuevos microservicios y ayudar√° a cumplir con las reglas uniformes para escribir c√≥digo. <br><br>  Al pasar a una nueva pila, comenzamos a mejorar la arquitectura de las aplicaciones del servidor: escribimos un nuevo registrador para el cliente y una biblioteca con un conjunto de abstracciones para implementar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">MVC</a> .  Hoy decidimos cu√°l ser√° la nueva arquitectura del servidor. <br><br><img src="https://habrastorage.org/webt/qd/wb/ib/qdwbib4ee20flundgjx-3d1m4q0.png"><br><br>  Spoiler: elige cebolla. <br><br><h1>  ¬øQu√© pas√≥ y mejor√≥?  Entendamos </h1><br><h2>  Interfaces din√°micas </h2><br><h4>  Era </h4><br>  Escrib√≠ anteriormente que bem-xjst proporciona una API para crear plantillas en tiempo de ejecuci√≥n.  I-bem, a su vez, puede funcionar con el √°rbol DOM.  Los haremos amigos y podremos generar y modificar din√°micamente HTML.  Intentemos cambiar el bot√≥n por evento: <br><br><img src="https://habrastorage.org/webt/bg/9b/4d/bg9b4d3tz7svwiifnivmacarf38.png"><br><img src="https://habrastorage.org/webt/bo/y5/1e/boy51ea8-l77moeaa4ogstifwz8.png"><br><br>  En este ejemplo, el lado d√©bil de BEM es visible: i-bem no quiere ser amigo de bem-xjst y no quiere saber nada sobre plantillas.  Agrega una clase al bloque, pero no aplica la plantilla [1].  Vuelve a renderizar el componente manualmente [2]: <br><br><ul><li>  describe una nueva pieza del √°rbol BEM [3]; </li><li>  luego aplique una nueva plantilla [4]; </li><li>  e inicializar otro componente en el nodo DOM actual [5]. </li></ul><br>  Adem√°s, i-bem no crea diff de √°rboles BEM, por lo tanto, se representa todo el componente, no las partes que han cambiado.  Considere un ejemplo simple: vuelva a representar el contenido de una ventana modal a pedido.  Se compone de tres elementos: <br><br><img src="https://habrastorage.org/webt/47/zo/it/47zoit3kwi5fq9idjqxluxuube0.png"><br><br>  Por simplicidad, asumimos que solo un elemento puede cambiar. <br><br><img src="https://habrastorage.org/webt/fe/kv/cf/fekvcf9j8mxnenc8v01lj29rgjm.png"><br><br>  Quiero hacer [1] y relajarme.  Pero i-bem no entender√° lo que ha cambiado, volver√° a procesar completamente el componente completo y tambi√©n se relajar√°.  En este ejemplo, no habr√° consecuencias graves, pero ¬øqu√© pasa si los formularios completos se presentan de manera incorrecta?  Esto empeora el rendimiento y causa efectos secundarios desagradables: en alg√∫n lugar la entrada parpadea, la informaci√≥n sobre herramientas sin propietario se cuelga en alg√∫n lugar.  Debido a esto, estamos tristes y controlamos manualmente partes de los componentes para crear un renderizador de puntos [2].  Esto complica el desarrollo, y nuevamente estamos tristes. <br><br><h4>  Se ha convertido </h4><br>  La reacci√≥n vino y arruin√≥ todo.  √âl mismo monitorea el estado de los componentes, ya no gestionamos el renderizado manual y no pensamos en interactuar con el DOM.  React contiene una implementaci√≥n <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">virtual de DOM</a> .  Llamar a React.createElement crea un objeto js del nodo DOM con sus propiedades y descendientes: el DOM virtual de este componente, que se almacena dentro de React.  Cuando un componente cambia, React calcula el nuevo DOM virtual y luego la diferencia entre el guardado y el nuevo, y actualiza solo la parte del DOM que ha cambiado.  Todo vuela, y solo podemos optimizar la l√≥gica compleja usando shouldComponentUpdate.  Es un exito! <br><br><h2>  Almacenamiento de datos </h2><br><h4>  Era </h4><br>  En BEM, preparamos todos los datos en el servidor y los transferimos a los componentes de la p√°gina: <br><br><img src="https://habrastorage.org/webt/2b/c5/kj/2bc5kjxp0jasbh4l3q4ympbiuki.png"><br><br>  Los componentes est√°n aislados y no compartir√°n datos entre s√≠, lo que significa que los mismos datos deber√°n arrojarse a diferentes componentes [1].  No podremos obtenerlos en el cliente, por lo que cada componente acepta de antemano un conjunto de datos que se necesitan para todos los escenarios posibles de su operaci√≥n.  Esto significa que cargamos el componente con datos que tal vez no necesite [2]. <br><br>  A veces una entidad global nos rescata, en la que se almacena parte de los datos comunes, pero el almacenamiento global de variables no encaja bien con el concepto BEM.  Por lo tanto, escribimos un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">bem-redux</a> que adapta Redux para BEM.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Redux</a> es un administrador de estado que gestiona el flujo de datos.  Maneja perfectamente nuestros datos dentro de interfaces simples, pero cuando desarrollamos un componente complejo, nos encontramos con el problema de representaci√≥n que describ√≠ anteriormente.  Redux no es amigable con i-bem, corregimos errores y estamos tristes. <br><br><h4>  Se ha convertido </h4><br>  <i>Redux + Reaccionar = &lt;3</i> <br>  Redux almacena datos para toda la aplicaci√≥n en un solo lugar [1]: <br><br><img src="https://habrastorage.org/webt/xv/k8/if/xvk8ifh8_9faxrwnmoeddps_wtm.png"><br><br>  El componente en s√≠ mismo decide cu√°ndo y qu√© datos necesita [2]: <br><br><img src="https://habrastorage.org/webt/wj/5j/l_/wj5jl_ffgk5f-7ql1mhno59hnd0.png"><br><br>  Solo necesitamos describir los escenarios del componente [3] e indicar d√≥nde obtener los datos para su ejecuci√≥n [4]: <br><br><img src="https://habrastorage.org/webt/jx/jh/kl/jxjhklr4appyvnlmv9r23jde3x0.png"><br><br>  Y React har√° el resto [5]: <br><br><img src="https://habrastorage.org/webt/zw/2t/iu/zw2tiux44khisns5fuem8ny7av8.png"><br><br>  Este enfoque le permite seguir el principio de responsabilidad √∫nica y encapsular la l√≥gica del componente en el componente mismo, en lugar de difundirlo en el c√≥digo de la p√°gina.  Es un exito! <br><br><h2>  Tienes que pagar por todo </h2><br>  Para tener √©xito, pagamos una gran cantidad de legado en React.  Es doloroso ver c√≥mo su c√≥digo, escrito hace solo un par de meses, se vuelve obsoleto. <br><br>  El hecho es que React es una biblioteca de capa de vista, no un marco completo.  Puede seleccionar todas las herramientas, pero <i>tendr√° que</i> seleccionar todas las herramientas.  Y tambi√©n para organizar el c√≥digo usted mismo, formular enfoques para resolver problemas t√≠picos, desarrollar un conjunto de acuerdos y escribir los complementos que faltan.  Escribimos nuestros propios validadores para formularios redux y a√∫n no hemos aprendido a trabajar con animaciones complejas.  Y tratamos de tirar, escribir y reescribir.  Y no lo estamos reescribiendo siempre, por lo que nuestra cartera de pedidos est√° creciendo. <br><br>  React es lo suficientemente joven y no est√° listo para el desarrollo empresarial, a diferencia de BEM.  Y mientras est√°bamos aprendiendo c√≥mo cocinarlo, arruinamos toda nuestra cocina y nosotros mismos lo arruinamos hasta el codo.  Y todav√≠a estamos debatiendo si necesitamos flujo o no, y a√∫n no entendemos completamente qu√© almacenar en la tienda y qu√© hay en la tienda local.  Escribimos seg√∫n sea necesario y vamos a conferencias para averiguar c√≥mo hacerlo.  Batimos los conos, pero avanzamos con confianza. <br><br><h1>  Bollos inesperados </h1><br>  La nueva pila nos permiti√≥ echar un vistazo a una serie de tareas y proporcion√≥ formas simples de resolverlas. <br><br><h2>  CSS en JS </h2><br><h4>  Era </h4><br>  Considere un caso simple de la vida: colorear y animar un √≠cono por evento, algo como esto: <br><br><img src="https://habrastorage.org/webt/vf/py/hx/vfpyhxhdazg6fjxqoehf7rrxatk.png"><br><br>  El c√≥digo no es nada: <br><br><img src="https://habrastorage.org/webt/ep/8c/ft/ep8cfthhe8trsxv3hes_vnblydu.png"><br><br>  Es cierto que, de acuerdo con las reglas de BEM, ya deber√° distribuirlo en tres directorios: <br><br><img src="https://habrastorage.org/webt/5y/7g/vg/5y7gvgsg4rg--bdw4ksuqymoyuq.png"><br><br>  ¬øArriba?  Un punto discutible.  M√°s importante a√∫n, en js agregamos estas clases manualmente cuando ocurren los eventos necesarios.  La situaci√≥n habitual, pero cuanto m√°s personalizada o compleja sea la interfaz, m√°s a menudo tendr√° que agregar y eliminar clases.  ¬øY si necesita cambiar no solo el icono, sino tambi√©n el texto?  No es exactamente la l√≥gica que quieres ver en el c√≥digo js: <br><br><img src="https://habrastorage.org/webt/ft/u9/bn/ftu9bn7g6ghzbepl6gomyezebyy.png"><br><br>  Pero, ¬øqu√© pasa si la duraci√≥n de la animaci√≥n depende de algo y se establece din√°micamente?  Luego reescribiremos la animaci√≥n CSS en jQuery y estaremos un poco tristes. <br><br><h4>  Se ha convertido </h4><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Componentes con estilo</a> , ¬°te amo!  CSS en JS: ¬°un amor!  Mi codificador interno se alegra: <br><br><img src="https://habrastorage.org/webt/pi/gp/b_/pigpb_it2ewws2q0ehn_oxsu_p8.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La modularidad se conserva, la animaci√≥n CSS funciona y no el trabajo manual con clases. </font><font style="vertical-align: inherit;">Una buena ventaja para la nueva pila.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Escribiendo </font></font></h2><br><h4>  Era </h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sol√≠amos escribir toneladas de jsDoc. </font><font style="vertical-align: inherit;">Veamos si es √∫til: </font></font><br><br><img src="https://habrastorage.org/webt/9-/fd/nf/9-fdnf3jssnze_gloxnkforgp6u.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">este ejemplo est√° tomado del c√≥digo de producci√≥n. </font><font style="vertical-align: inherit;">¬øQu√© contiene el estado? </font><font style="vertical-align: inherit;">No tengo idea </font><font style="vertical-align: inherit;">S√≠, hay un archivo L√©ame, pero, por desgracia, est√° un poco desactualizado. </font><font style="vertical-align: inherit;">S√≠, nos da verg√ºenza, pero con la documentaci√≥n y los comentarios a menudo esto sucede, no son confiables. </font><font style="vertical-align: inherit;">Tendr√° que profundizar en el c√≥digo. </font><font style="vertical-align: inherit;">O no profundice y accidentalmente rompa todo. </font><font style="vertical-align: inherit;">Tenemos prisa, no profundicemos, rompamos y nos sintamos tristes.</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Se ha convertido </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mecanografiar vino al rescate. </font><font style="vertical-align: inherit;">"Tyk" en el tipo, y todos los entresijos del m√©todo ante mis ojos. </font><font style="vertical-align: inherit;">Demasiado perezoso para entender? </font><font style="vertical-align: inherit;">El comprobador de precompromiso comenzar√° a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fluir</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , y a√∫n debe resolverlo. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">No me gust√≥ el flujo a primera vista. </font><font style="vertical-align: inherit;">Las fechas est√°n activadas, el gerente hace ping y usted tiene "no se puede obtener la propiedad", y aqu√≠ "falta la propiedad". </font><font style="vertical-align: inherit;">Pero recientemente me dijeron que los tipos pueden ser dise√±ados por O_o. ¬øC√≥mo dise√±ar por tipos? </font><font style="vertical-align: inherit;">Algo como esto: </font></font><br><br><img src="https://habrastorage.org/webt/_d/ud/_4/_dud_4ofrwr_idp9qdxmqoejdlg.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mi mundo se puso patas arriba. </font><font style="vertical-align: inherit;">El flujo ya no es una pesadilla. </font><font style="vertical-align: inherit;">Fue conveniente y √∫til describir los m√≥dulos API con tipos antes de escribir el c√≥digo. </font><font style="vertical-align: inherit;">C√≥digo confiable - ¬°un buen bono!</font></font><br><br><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ¬øEntonces no m√°s BEM? </font></font></h1><br>  No<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BEM est√° vivo y seguimos admitiendo aplicaciones en la pila BEM. </font><font style="vertical-align: inherit;">Con el tiempo, tambi√©n se trasladar√°n a Reaccionar, pero por ahora estamos preparando el camino para esto: traducimos bibliotecas de componentes, formamos un conjunto de herramientas y acuerdos, y aprendemos c√≥mo planificar las fechas de migraci√≥n. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En BEM, se implementa nuestro motor de plantillas de boletines por correo electr√≥nico. </font><font style="vertical-align: inherit;">Preparamos cartas en el servidor, y las limitaciones de la plataforma BEM descrita anteriormente no afectan a esta aplicaci√≥n. </font><font style="vertical-align: inherit;">Usar BEM para desarrollarlo es una soluci√≥n elegante apropiada. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Adem√°s, nuestros dise√±adores </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">crean prototipos con BEM</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y, a veces, nos traen componentes premontados en lugar de dise√±os. </font><font style="vertical-align: inherit;">E incluso si dejamos de escribir en BEM, todav√≠a nos encontrar√° :)</font></font><br><br><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le√≠ la primera parte. </font><font style="vertical-align: inherit;">¬øQu√© pasa con los codificadores?</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Particip√© en la traducci√≥n de una de las aplicaciones de BEM a React y descubr√≠ algo importante. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Antes de unirme a Yandex.Money, era un simple tipogr√°fico y pas√© m√°s de un a√±o, miles de toneladas de HTML y JSX. No tom√© en serio la comunidad front-end y su mundo cambiante. No entend√≠a por qu√© estudiar el primer Angular para olvidarlo ma√±ana y estudiar el segundo. No entend√≠ por qu√© cambiar jQuery.Ajax a Fetch, luego reemplazar Fetch con Axios.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Result√≥ que cuando transfieres un proyecto de un marco a otro, no solo est√°s transfiriendo el c√≥digo. </font><font style="vertical-align: inherit;">Tenemos que analizar y mejorar la arquitectura de la aplicaci√≥n, enderezar la l√≥gica, refactorizar. </font><font style="vertical-align: inherit;">Un cambio constante de herramientas no es un intento de subirse a la ola exagerada, sino una b√∫squeda constante de la mejor soluci√≥n que cumpla con los requisitos de la √©poca. </font><font style="vertical-align: inherit;">Un campo en desarrollo din√°mico como ning√∫n otro contribuye al desarrollo de su producto y su desarrollo profesional, respectivamente. </font><font style="vertical-align: inherit;">Y la interfaz es solo un √°rea. </font><font style="vertical-align: inherit;">¬°Luchemos por ello juntos! </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬°Reacciona a todos!</font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es414183/">https://habr.com/ru/post/es414183/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es414173/index.html">Dispersi√≥n de luz atmosf√©rica en menos de cuatro kilobytes.</a></li>
<li><a href="../es414175/index.html">Extraer entidades del texto con Stanford NLP desde cero</a></li>
<li><a href="../es414177/index.html">Transiciones animadas en aplicaciones m√≥viles</a></li>
<li><a href="../es414179/index.html">Oh, mi c√≥digo: c√≥mo convertirse en un l√≠der de TI</a></li>
<li><a href="../es414181/index.html">Impresora 3D CreatBot D600 grande</a></li>
<li><a href="../es414185/index.html">Clave celular: c√≥mo abrir una puerta de membrana</a></li>
<li><a href="../es414187/index.html">¬øPor qu√© ir a un maestro de TI?</a></li>
<li><a href="../es414189/index.html">The Boring Company conecta el centro de Chicago con el aeropuerto a trav√©s de t√∫neles</a></li>
<li><a href="../es414195/index.html">Cisco StealthWatch o las caracter√≠sticas de seguridad de red empresarial cl√°sica (FW, IPS, ACL, NAC, AV, SIEM)?</a></li>
<li><a href="../es414197/index.html">Marca negra</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>