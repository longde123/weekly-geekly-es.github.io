<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title> 锔  Resoluci贸n de problemas con pwnable.kr 06 - aleatorio y 09 - error 锔  </title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="En este art铆culo, aprendemos c贸mo interceptar los datos transferidos entre la funci贸n de la biblioteca y el programa, recordar los descriptores de arc...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Resoluci贸n de problemas con pwnable.kr 06 - aleatorio y 09 - error</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/460527/"><img src="https://habrastorage.org/webt/al/py/ef/alpyefagnx81cc2xc1ncjqs8lus.png" alt="imagen"><br><br>  En este art铆culo, aprendemos c贸mo interceptar los datos transferidos entre la funci贸n de la biblioteca y el programa, recordar los descriptores de archivos y resolver las tareas sexta y novena del sitio pwnable.kr. <br><a name="habracut"></a><br><div class="spoiler">  <b class="spoiler_title">Informaci贸n organizacional</b> <div class="spoiler_text">  Especialmente para aquellos que quieran aprender algo nuevo y desarrollarse en cualquiera de las 谩reas de informaci贸n y seguridad inform谩tica, escribir茅 y hablar茅 sobre las siguientes categor铆as: <br><br><ul><li>  PWN; </li><li>  criptograf铆a (criptograf铆a); </li><li>  tecnolog铆as de red (Red); </li><li>  inversa (ingenier铆a inversa); </li><li>  esteganograf铆a (Stegano); </li><li>  b煤squeda y explotaci贸n de vulnerabilidades WEB. </li></ul><br>  Adem谩s de esto, compartir茅 mi experiencia en inform谩tica forense, an谩lisis de malware y firmware, ataques a redes inal谩mbricas y redes de 谩rea local, realizaci贸n de pentests y escritura de exploits. <br><br>  Para que pueda conocer nuevos art铆culos, software y otra informaci贸n, cre茅 un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">canal en Telegram</a> y un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">grupo para discutir cualquier problema</a> en el campo de ICD.  Adem谩s, considerar茅 personalmente sus solicitudes personales, preguntas, sugerencias y recomendaciones <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">personalmente y responder茅 a todos</a> . <br><br>  Toda la informaci贸n se proporciona solo con fines educativos.  El autor de este documento no tiene ninguna responsabilidad por los da帽os causados a alguien como resultado del uso de los conocimientos y m茅todos obtenidos como resultado de estudiar este documento. <br></div></div><br><h2>  La soluci贸n al azar </h2><br>  Hacemos clic en el icono con la firma al azar, y nos dicen que debemos conectarnos a trav茅s de SSH con la contrase帽a de invitado. <br><br><img src="https://habrastorage.org/webt/je/bo/en/jeboen-rk92niig8b4conbm7v4u.png" alt="imagen"><br><br>  Cuando est谩 conectado, vemos el banner correspondiente. <br><br><img src="https://habrastorage.org/webt/p5/bq/u7/p5bqu7itbuwh_bneyaryl_i1lgc.png" alt="imagen"><br><br>  Veamos qu茅 archivos hay en el servidor y qu茅 derechos tenemos. <br><br><pre><code class="bash hljs">ls -l</code> </pre> <br><img src="https://habrastorage.org/webt/fu/3b/qo/fu3bqoqyoep63obkzqrh5qzvn10.png" alt="imagen"><br><br>  Por lo tanto, podemos leer el c贸digo fuente del programa, ya que existe el derecho de leer para todos, y ejecutar el programa al azar con los derechos del propietario (se establece el bit fijo).  Veamos el resultado del c贸digo. <br><br><img src="https://habrastorage.org/webt/zo/1i/46/zo1i46-qc_byf_h_jfiuu4pi18o.png" alt="imagen"><br><br>  El programa genera un n煤mero aleatorio, aplica la operaci贸n XOR (OR exclusivo) y, si el resultado de la operaci贸n XOR es igual al valor de referencia, muestra un indicador. <br><br>  El hecho es que la funci贸n rand () se usa en este programa.  Esta funci贸n genera un n煤mero pseudoaleatorio, convirtiendo el "grano" generado por la funci贸n srand ().  La funci贸n srand (n煤mero) debe llamarse cada vez antes de llamar a rand ().  Si esto no sucede, entonces srand (1) se activa antes que rand () por defecto. <br><br>  Por lo tanto, en este programa, un generador de n煤meros pseudoaleatorio convierte el mismo "grano" cada vez de acuerdo con el mismo algoritmo.  Necesitamos encontrar el n煤mero que devuelve la funci贸n rand () y el proxory con el valor de referencia.  Dado que la operaci贸n XOR es reversible, luego de pasar el valor recibido a la entrada del programa, obtenemos un indicador. <br><br>  Interceptemos los datos entre la funci贸n de biblioteca rand () y nuestro programa.  Para hacer esto, use la utilidad ltrace. <br><br><pre> <code class="bash hljs">ltrace ./random</code> </pre> <br><img src="https://habrastorage.org/webt/op/rx/-k/oprx-k_ooz0gpbw2kdymzlburwy.png" alt="imagen"><br><br>  Vemos con qu茅 par谩metros se llama la funci贸n rand () y qu茅 valor devuelve.  Ahora proxorite este valor con la referencia. <br><br><img src="https://habrastorage.org/webt/jh/u0/rp/jhu0rpigwnqozapsj5lx7jbq5_4.png" alt="imagen"><br><br>  Enviamos el n煤mero resultante a la entrada de nuestro programa. <br><br><img src="https://habrastorage.org/webt/6g/j8/6m/6gj86miecfw-uioz_lr_ydhysgc.png" alt="imagen"><br><br>  Pasamos la bandera y obtenemos un punto para una tarea tan f谩cil. <br><br><img src="https://habrastorage.org/webt/o-/zf/x6/o-zfx6phqvu9a3yiyrubviqwfys.png" alt="imagen"><br><br><h2>  Soluci贸n al error. </h2><br>  Hacemos clic en el icono con la firma de error y se nos dice que debemos conectarnos a trav茅s de SSH con la contrase帽a de invitado. <br><br><img src="https://habrastorage.org/webt/np/bd/pq/npbdpqfzjx35fln8l8iws3ug1kg.png" alt="imagen"><br><br>  Cuando est谩 conectado, vemos el banner correspondiente. <br><br><img src="https://habrastorage.org/webt/wm/7e/j-/wm7ej-3cerplb8pklbk7ter9pts.png" alt="imagen"><br><br>  Veamos qu茅 archivos hay en el servidor y qu茅 derechos tenemos. <br><br><pre> <code class="bash hljs">ls -l</code> </pre> <br><img src="https://habrastorage.org/webt/cr/ns/bz/crnsbzxmzzbth8llitk7pa5j5qg.png" alt="imagen"><br><br>  Por lo tanto, podemos leer el c贸digo fuente del programa, ya que existe el derecho de leer para todos y ejecutar un programa de error con los derechos del propietario (se establece un bit fijo).  Veamos el resultado del c贸digo. <br><br><img src="https://habrastorage.org/webt/jd/jm/ak/jdjmaktosipnwbmzh7jjwv3eybg.png" alt="imagen"><br><br>  Al comienzo del programa, se abre un archivo y se crea un descriptor.  Sobre los descriptores de archivos, ya escrib铆 en detalle en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">ESTE</a> art铆culo.  Pero el hecho es que la condici贸n cometi贸 un error.  Por lo tanto, primero se realiza una comparaci贸n, cuyo resultado es una mentira, y luego la asignaci贸n de este resultado falso (es decir, 0) a la variable fd. <br><br><img src="https://habrastorage.org/webt/ln/tb/8e/lntb8e-abbw6vz5hvnhfyeq4p2y.png" alt="imagen"><br><br>  A continuaci贸n, se llama a la funci贸n de suspensi贸n y, sin sugerir una entrada a la variable pw_buf, se leen los datos.  Pero debido a un error en la condici贸n, no se leen desde un archivo abierto con una contrase帽a, sino desde una entrada est谩ndar (identificador 0). <br><br>  Luego, ingresamos 10 caracteres, que car谩cter por car谩cter pelean con 1 y se comparan con una contrase帽a. <br><br><img src="https://habrastorage.org/webt/cj/59/3u/cj593uekciawucw9ljn12rtscxu.png" alt="imagen"><br><br>  Por lo tanto, ingresamos dos l铆neas, cuyos caracteres deber铆an resultar en un resultado de la operaci贸n XOR. Encontraremos dos caracteres, si los proxor, obtenemos 1. <br><br><img src="https://habrastorage.org/webt/oo/qd/sm/ooqdsmlgsfcwrwvlmzfn_1dfopc.png" alt="imagen"><br><br>  Estos son los caracteres A y @.  Ahora ingrese dos l铆neas en el programa, uno de los 10 caracteres 'A' y el otro - '@'. <br><br><img src="https://habrastorage.org/webt/bm/us/cy/bmuscyyjiclkdzoe_3bq4zcvvae.png" alt="imagen"><br><br>  Entregamos la bandera y obtenemos un punto m谩s. <br><br><img src="https://habrastorage.org/webt/zo/d2/pi/zod2pihkp_yjecldbcvfn5bbzyq.png" alt="imagen"><br><br>  隆Nos vemos en los siguientes art铆culos! <br><br>  Estamos en un canal de telegramas: un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">canal en Telegramas</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/460527/">https://habr.com/ru/post/460527/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../460515/index.html">驴Qu茅 tan cerca estamos realmente del advenimiento de los robomobiles?</a></li>
<li><a href="../460517/index.html">C贸mo detectar ataques a la infraestructura de Windows: explorando herramientas de hackers</a></li>
<li><a href="../460521/index.html">Las aventuras de los esquivos Malvari, Parte IV: DDE y campos de documentos de Word</a></li>
<li><a href="../460523/index.html">Anuncio de un mitap que se transforma sin problemas en una copa BeerPHP (en Mosc煤 y en l铆nea)</a></li>
<li><a href="../460525/index.html">Bienvenido a DINS IT TARDE en julio: QA y JS</a></li>
<li><a href="../460533/index.html">Se te ocurri贸 la idea de un producto de TI, 驴qu茅 sigue?</a></li>
<li><a href="../460537/index.html">ZuriHac: practicando programaci贸n funcional</a></li>
<li><a href="../460539/index.html">Manejo de errores en Vue</a></li>
<li><a href="../460541/index.html">Busque contornos faciales en un milisegundo usando un conjunto de 谩rboles de regresi贸n</a></li>
<li><a href="../460543/index.html">Nuevas certificaciones para desarrolladores de Cisco. Descripci贸n general de la certificaci贸n de la industria</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>