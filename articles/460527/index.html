<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👘 ⚔️ 🖕 Resolución de problemas con pwnable.kr 06 - aleatorio y 09 - error ㊗️ 🖐🏽 🐝</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="En este artículo, aprendemos cómo interceptar los datos transferidos entre la función de la biblioteca y el programa, recordar los descriptores de arc...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Resolución de problemas con pwnable.kr 06 - aleatorio y 09 - error</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/460527/"><img src="https://habrastorage.org/webt/al/py/ef/alpyefagnx81cc2xc1ncjqs8lus.png" alt="imagen"><br><br>  En este artículo, aprendemos cómo interceptar los datos transferidos entre la función de la biblioteca y el programa, recordar los descriptores de archivos y resolver las tareas sexta y novena del sitio pwnable.kr. <br><a name="habracut"></a><br><div class="spoiler">  <b class="spoiler_title">Información organizacional</b> <div class="spoiler_text">  Especialmente para aquellos que quieran aprender algo nuevo y desarrollarse en cualquiera de las áreas de información y seguridad informática, escribiré y hablaré sobre las siguientes categorías: <br><br><ul><li>  PWN; </li><li>  criptografía (criptografía); </li><li>  tecnologías de red (Red); </li><li>  inversa (ingeniería inversa); </li><li>  esteganografía (Stegano); </li><li>  búsqueda y explotación de vulnerabilidades WEB. </li></ul><br>  Además de esto, compartiré mi experiencia en informática forense, análisis de malware y firmware, ataques a redes inalámbricas y redes de área local, realización de pentests y escritura de exploits. <br><br>  Para que pueda conocer nuevos artículos, software y otra información, creé un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">canal en Telegram</a> y un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">grupo para discutir cualquier problema</a> en el campo de ICD.  Además, consideraré personalmente sus solicitudes personales, preguntas, sugerencias y recomendaciones <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">personalmente y responderé a todos</a> . <br><br>  Toda la información se proporciona solo con fines educativos.  El autor de este documento no tiene ninguna responsabilidad por los daños causados ​​a alguien como resultado del uso de los conocimientos y métodos obtenidos como resultado de estudiar este documento. <br></div></div><br><h2>  La solución al azar </h2><br>  Hacemos clic en el icono con la firma al azar, y nos dicen que debemos conectarnos a través de SSH con la contraseña de invitado. <br><br><img src="https://habrastorage.org/webt/je/bo/en/jeboen-rk92niig8b4conbm7v4u.png" alt="imagen"><br><br>  Cuando está conectado, vemos el banner correspondiente. <br><br><img src="https://habrastorage.org/webt/p5/bq/u7/p5bqu7itbuwh_bneyaryl_i1lgc.png" alt="imagen"><br><br>  Veamos qué archivos hay en el servidor y qué derechos tenemos. <br><br><pre><code class="bash hljs">ls -l</code> </pre> <br><img src="https://habrastorage.org/webt/fu/3b/qo/fu3bqoqyoep63obkzqrh5qzvn10.png" alt="imagen"><br><br>  Por lo tanto, podemos leer el código fuente del programa, ya que existe el derecho de leer para todos, y ejecutar el programa al azar con los derechos del propietario (se establece el bit fijo).  Veamos el resultado del código. <br><br><img src="https://habrastorage.org/webt/zo/1i/46/zo1i46-qc_byf_h_jfiuu4pi18o.png" alt="imagen"><br><br>  El programa genera un número aleatorio, aplica la operación XOR (OR exclusivo) y, si el resultado de la operación XOR es igual al valor de referencia, muestra un indicador. <br><br>  El hecho es que la función rand () se usa en este programa.  Esta función genera un número pseudoaleatorio, convirtiendo el "grano" generado por la función srand ().  La función srand (número) debe llamarse cada vez antes de llamar a rand ().  Si esto no sucede, entonces srand (1) se activa antes que rand () por defecto. <br><br>  Por lo tanto, en este programa, un generador de números pseudoaleatorio convierte el mismo "grano" cada vez de acuerdo con el mismo algoritmo.  Necesitamos encontrar el número que devuelve la función rand () y el proxory con el valor de referencia.  Dado que la operación XOR es reversible, luego de pasar el valor recibido a la entrada del programa, obtenemos un indicador. <br><br>  Interceptemos los datos entre la función de biblioteca rand () y nuestro programa.  Para hacer esto, use la utilidad ltrace. <br><br><pre> <code class="bash hljs">ltrace ./random</code> </pre> <br><img src="https://habrastorage.org/webt/op/rx/-k/oprx-k_ooz0gpbw2kdymzlburwy.png" alt="imagen"><br><br>  Vemos con qué parámetros se llama la función rand () y qué valor devuelve.  Ahora proxorite este valor con la referencia. <br><br><img src="https://habrastorage.org/webt/jh/u0/rp/jhu0rpigwnqozapsj5lx7jbq5_4.png" alt="imagen"><br><br>  Enviamos el número resultante a la entrada de nuestro programa. <br><br><img src="https://habrastorage.org/webt/6g/j8/6m/6gj86miecfw-uioz_lr_ydhysgc.png" alt="imagen"><br><br>  Pasamos la bandera y obtenemos un punto para una tarea tan fácil. <br><br><img src="https://habrastorage.org/webt/o-/zf/x6/o-zfx6phqvu9a3yiyrubviqwfys.png" alt="imagen"><br><br><h2>  Solución al error. </h2><br>  Hacemos clic en el icono con la firma de error y se nos dice que debemos conectarnos a través de SSH con la contraseña de invitado. <br><br><img src="https://habrastorage.org/webt/np/bd/pq/npbdpqfzjx35fln8l8iws3ug1kg.png" alt="imagen"><br><br>  Cuando está conectado, vemos el banner correspondiente. <br><br><img src="https://habrastorage.org/webt/wm/7e/j-/wm7ej-3cerplb8pklbk7ter9pts.png" alt="imagen"><br><br>  Veamos qué archivos hay en el servidor y qué derechos tenemos. <br><br><pre> <code class="bash hljs">ls -l</code> </pre> <br><img src="https://habrastorage.org/webt/cr/ns/bz/crnsbzxmzzbth8llitk7pa5j5qg.png" alt="imagen"><br><br>  Por lo tanto, podemos leer el código fuente del programa, ya que existe el derecho de leer para todos y ejecutar un programa de error con los derechos del propietario (se establece un bit fijo).  Veamos el resultado del código. <br><br><img src="https://habrastorage.org/webt/jd/jm/ak/jdjmaktosipnwbmzh7jjwv3eybg.png" alt="imagen"><br><br>  Al comienzo del programa, se abre un archivo y se crea un descriptor.  Sobre los descriptores de archivos, ya escribí en detalle en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">ESTE</a> artículo.  Pero el hecho es que la condición cometió un error.  Por lo tanto, primero se realiza una comparación, cuyo resultado es una mentira, y luego la asignación de este resultado falso (es decir, 0) a la variable fd. <br><br><img src="https://habrastorage.org/webt/ln/tb/8e/lntb8e-abbw6vz5hvnhfyeq4p2y.png" alt="imagen"><br><br>  A continuación, se llama a la función de suspensión y, sin sugerir una entrada a la variable pw_buf, se leen los datos.  Pero debido a un error en la condición, no se leen desde un archivo abierto con una contraseña, sino desde una entrada estándar (identificador 0). <br><br>  Luego, ingresamos 10 caracteres, que carácter por carácter pelean con 1 y se comparan con una contraseña. <br><br><img src="https://habrastorage.org/webt/cj/59/3u/cj593uekciawucw9ljn12rtscxu.png" alt="imagen"><br><br>  Por lo tanto, ingresamos dos líneas, cuyos caracteres deberían resultar en un resultado de la operación XOR. Encontraremos dos caracteres, si los proxor, obtenemos 1. <br><br><img src="https://habrastorage.org/webt/oo/qd/sm/ooqdsmlgsfcwrwvlmzfn_1dfopc.png" alt="imagen"><br><br>  Estos son los caracteres A y @.  Ahora ingrese dos líneas en el programa, uno de los 10 caracteres 'A' y el otro - '@'. <br><br><img src="https://habrastorage.org/webt/bm/us/cy/bmuscyyjiclkdzoe_3bq4zcvvae.png" alt="imagen"><br><br>  Entregamos la bandera y obtenemos un punto más. <br><br><img src="https://habrastorage.org/webt/zo/d2/pi/zod2pihkp_yjecldbcvfn5bbzyq.png" alt="imagen"><br><br>  ¡Nos vemos en los siguientes artículos! <br><br>  Estamos en un canal de telegramas: un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">canal en Telegramas</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/460527/">https://habr.com/ru/post/460527/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../460515/index.html">¿Qué tan cerca estamos realmente del advenimiento de los robomobiles?</a></li>
<li><a href="../460517/index.html">Cómo detectar ataques a la infraestructura de Windows: explorando herramientas de hackers</a></li>
<li><a href="../460521/index.html">Las aventuras de los esquivos Malvari, Parte IV: DDE y campos de documentos de Word</a></li>
<li><a href="../460523/index.html">Anuncio de un mitap que se transforma sin problemas en una copa BeerPHP (en Moscú y en línea)</a></li>
<li><a href="../460525/index.html">Bienvenido a DINS IT TARDE en julio: QA y JS</a></li>
<li><a href="../460533/index.html">Se te ocurrió la idea de un producto de TI, ¿qué sigue?</a></li>
<li><a href="../460537/index.html">ZuriHac: practicando programación funcional</a></li>
<li><a href="../460539/index.html">Manejo de errores en Vue</a></li>
<li><a href="../460541/index.html">Busque contornos faciales en un milisegundo usando un conjunto de árboles de regresión</a></li>
<li><a href="../460543/index.html">Nuevas certificaciones para desarrolladores de Cisco. Descripción general de la certificación de la industria</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>