<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ЁЯПНя╕П ЁЯСиЁЯП╛тАНЁЯФз ЁЯЪ╡ RabbitMQ - SQL рд╕рд░реНрд╡рд░ ЁЯШ╕ ЁЯРм ЁЯТЛ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="рдПрдХ рдпрд╛ рджреЛ рд╣рдлреНрддреЗ рдкрд╣рд▓реЗ, рдореИрдВрдиреЗ RabbitMQ Users рдлреЛрд░рдо рдкрд░ рдПрдХ рд╕рдВрджреЗрд╢ рджреЗрдЦрд╛ рдХрд┐ SQL Server рд╕реЗ рд╕рдВрджреЗрд╢ рднреЗрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдХреИрд╕реЗ RabbitMQ рд╕реНрдерд╛рдкрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПред рдЪреВрдВрдХрд┐ рд╣рдо рдбреЗрд░рд┐рд╡рдХреЛ рдХ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>RabbitMQ - SQL рд╕рд░реНрд╡рд░</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/419457/">  рдПрдХ рдпрд╛ рджреЛ рд╣рдлреНрддреЗ рдкрд╣рд▓реЗ, рдореИрдВрдиреЗ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">RabbitMQ Users</a> рдлреЛрд░рдо рдкрд░ рдПрдХ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╕рдВрджреЗрд╢</a> рджреЗрдЦрд╛ рдХрд┐ SQL Server рд╕реЗ рд╕рдВрджреЗрд╢ рднреЗрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдХреИрд╕реЗ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">RabbitMQ</a> рд╕реНрдерд╛рдкрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПред  рдЪреВрдВрдХрд┐ рд╣рдо <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдбреЗрд░рд┐рд╡рдХреЛ рдХреЗ</a> рд╕рд╛рде рдорд┐рд▓рдХрд░ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рдореИрдВрдиреЗ рд╡рд╣рд╛рдВ рдХреБрдЫ рд╕реБрдЭрд╛рд╡ рдЫреЛрдбрд╝ рджрд┐рдП, рдФрд░ рдпрд╣ рднреА рдХрд╣рд╛ рдХрд┐ рдореИрдВ рдпрд╣ рдХреИрд╕реЗ рдХрд░рдирд╛ рд╣реИ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдПрдХ рдмреНрд▓реЙрдЧ рд▓рд┐рдЦ рд░рд╣рд╛ рд╣реВрдВред  рдореЗрд░реЗ рд╕рдВрджреЗрд╢ рдХрд╛ рдПрдХ рд╣рд┐рд╕реНрд╕рд╛ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рд╕рдЪ рдирд╣реАрдВ рдерд╛ - рдХрдо рд╕реЗ рдХрдо рдЙрд╕ рдХреНрд╖рдг рддрдХ (рдХреНрд╖рдорд╛ рдХрд░реЗрдВ, рднрд╛рдИ, рд╡рд╣ рдмрд╣реБрдд рд╡реНрдпрд╕реНрдд рдерд╛)ред <br><br>  рдмрд╣реБрдд рдмрдврд╝рд┐рдпрд╛ рдмрд╛рдд рд╣реИ, рдпрд╣ рдЖрдкрдХрд╛ <b>SQL рд╕рд░реНрд╡рд░ рд╣реИ</b> ред  рдбреЗрдЯрд╛рдмреЗрд╕ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рдбрд╛рд▓рдирд╛ рдмрд╣реБрдд рдЖрд╕рд╛рди рд╣реИред  рдХреНрд╡реЗрд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдбреЗрдЯрд╛рдмреЗрд╕ рд╕реЗ рдбреЗрдЯрд╛ рдкреБрдирд░реНрдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ рдЙрддрдирд╛ рд╣реА рдЖрд╕рд╛рди рд╣реИред  рд▓реЗрдХрд┐рди рдЕрднреА рдЕрджреНрдпрддрди рдпрд╛ рдЪрд┐рдкрдХрд╛рдпрд╛ рдЧрдпрд╛ рдбреЗрдЯрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ рдереЛрдбрд╝рд╛ рдЕрдзрд┐рдХ рдХрдард┐рди рд╣реИред  рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд╕рдордп рдХреА рдШрдЯрдирд╛рдУрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╕реЛрдЪреЛ;  рдЦрд░реАрджрд╛рд░реА рдХреА рдЬрд╛рддреА рд╣реИ - рдЬреИрд╕реЗ рд╣реА рдРрд╕рд╛ рд╣реБрдЖ рдХрд┐рд╕реА рдХреЛ рдЗрд╕ рдмрд╛рд░реЗ рдореЗрдВ рд╕реВрдЪрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред  рд╢рд╛рдпрдж рдХреЛрдИ рдХрд╣реЗрдЧрд╛ рдХрд┐ рдЗрд╕ рддрд░рд╣ рдХреЗ рдбреЗрдЯрд╛ рдХреЛ рдбреЗрдЯрд╛рдмреЗрд╕ рд╕реЗ рдкреЙрдк рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП, рд▓реЗрдХрд┐рди рдХрд╣реАрдВ рдФрд░ рд╕реЗред  рдмреЗрд╢рдХ, рдпрд╣ рдорд╛рдорд▓рд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдЕрдХреНрд╕рд░ рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдХреЛрдИ рд╡рд┐рдХрд▓реНрдк рдирд╣реАрдВ рд╣реИред <br><a name="habracut"></a><br>  рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдПрдХ рдХрд╛рд░реНрдп рдерд╛: рдЖрдЧреЗ рдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рд▓рд┐рдП рдбреЗрдЯрд╛рдмреЗрд╕ рд╕реЗ рдШрдЯрдирд╛рдУрдВ рдХреЛ рднреЗрдЬреЗрдВ, рдФрд░ рд╕рд╡рд╛рд▓ рдерд╛ - рдпрд╣ рдХреИрд╕реЗ рдХрд░рдирд╛ рд╣реИ? <br><br><h3>  SQL рд╕рд░реНрд╡рд░ рдФрд░ рдмрд╛рд╣рд░реА рд╕рдВрдЪрд╛рд░ </h3><br>  SQL рд╕рд░реНрд╡рд░ рдХреЗ рдЕрд╕реНрддрд┐рддреНрд╡ рдХреЗ рджреМрд░рд╛рди, рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЗ рдмрд╛рд╣рд░ рд╕рдВрдЪрд╛рд░ рдХреЛ рд╡реНрдпрд╡рд╕реНрдерд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрдИ рдкреНрд░рдпрд╛рд╕ рдХрд┐рдП рдЧрдП рд╣реИрдВ;  <b>SQL рд╕рд░реНрд╡рд░ рд╕реВрдЪрдирд╛ рд╕реЗрд╡рд╛</b> (NS), рдЬреЛ SQL Server 2000 рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреА, рдФрд░ рдмрд╛рдж рдореЗрдВ, SQL Server 2005 рдореЗрдВ, <b>SQL рд╕рд░реНрд╡рд░ рд╕реЗрд╡рд╛ рдмреНрд░реЛрдХрд░</b> (SSB) рджрд┐рдЦрд╛рдИ рджреАред  рдореИрдВрдиреЗ рдЙрдиреНрд╣реЗрдВ рдмреЙрдм рдмреЙрд╢реЗрдореЗрди рдФрд░ рдбреИрди рд╕реБрд▓рд┐рд╡рди рдХреЗ рд╕рд╛рде <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдбреЗрд╡рд▓рдкрд░реНрд╕ рдХреЗ рд▓рд┐рдП рдПрд╕рдХреНрдпреВрдПрд▓ рд╕рд░реНрд╡рд░ 2005</a> рдореЗрдВ рдЕрдкрдиреА рдкреБрд╕реНрддрдХ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдП рдлрд░реНрд╕реНрдЯ рд▓реБрдХ</a> рдореЗрдВ рд╡рд░реНрдгрд┐рдд рдХрд┐рдпрд╛ред  NS SQL Server 2000 рдореЗрдВ рджрд┐рдЦрд╛рдИ рджрд┐рдпрд╛, рдЬреИрд╕рд╛ рдХрд┐ рдореИрдВрдиреЗ рдХрд╣рд╛ рдерд╛, рдФрд░ SQL Server 2005 рдХреЗ рдмреАрдЯрд╛ рд╕рдВрд╕реНрдХрд░рдг рдореЗрдВ рдкреБрди: рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред рд╣рд╛рд▓рд╛рдБрдХрд┐, NS рдХреЛ SQL Server 2005 рдХреЗ рд░реЗрдбреА-рдлреЙрд░-рд╕реЗрд▓ (RTM) рд╕рдВрд╕реНрдХрд░рдг рд╕реЗ <s>рдкреВрд░реА рддрд░рд╣ рд╕реЗ</s> рдмрд╛рд╣рд░ рд░рдЦрд╛ рдЧрдпрд╛ рдерд╛ред <br><blockquote>  <b>рдиреЛрдЯ:</b> рдпрджрд┐ рдЖрдк рдкреБрд╕реНрддрдХ рдкрдврд╝рддреЗ рд╣реИрдВ, рддреЛ рдЖрдкрдХреЛ рд╡рд╣рд╛рдБ рдХрдИ рд╕реБрд╡рд┐рдзрд╛рдПрдБ рдорд┐рд▓реЗрдВрдЧреА рдЬреЛ RTM рд╕рдВрд╕реНрдХрд░рдг рдореЗрдВ рдирд╣реАрдВ рдереАрдВред </blockquote>  SSB рдмрдЪ рдЧрдпрд╛, рдФрд░ Microsoft рдиреЗ рдЕрдкрдиреЗ SQL Server 2008 рдлрд╝реАрдЪрд░ рдкреИрдХ рдореЗрдВ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╕рд░реНрд╡рд┐рд╕ рдмреНрд░реЛрдХрд░ рдПрдХреНрд╕рдЯрд░реНрдирд▓ рдПрдХреНрдЯреАрд╡реЗрдЯрд░</a> (EA) рдкреЗрд╢ рдХрд┐рдпрд╛ред  рдпрд╣ рдПрд╕рдПрд╕рдмреА рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕реНрдерд╛рдиреАрдп рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЗ рдмрд╛рд╣рд░ рдмрд╛рддрдЪреАрдд рдХрд░рдирд╛ рд╕рдВрднрд╡ рдмрдирд╛рддрд╛ рд╣реИред  рд╕реИрджреНрдзрд╛рдВрддрд┐рдХ рд░реВрдк рд╕реЗ, рдпрд╣ рдЕрдЪреНрдЫрд╛ рд▓рдЧрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рд╡реНрдпрд╡рд╣рд╛рд░ рдореЗрдВ - рдпрд╣ рдмреЛрдЭрд┐рд▓ рдФрд░ рднреНрд░рдорд┐рдд рд╣реИред  рд╣рдордиреЗ рдХреБрдЫ рдкрд░реАрдХреНрд╖рдг рдХрд┐рдП рдФрд░ рдЬрд▓реНрджреА рд╕реЗ рдорд╣рд╕реВрд╕ рдХрд┐рдпрд╛ рдХрд┐ рдпрд╣ рд╡рд╣ рдирд╣реАрдВ рдХрд░ рд░рд╣рд╛ рдерд╛ рдЬрд┐рд╕рдХреА рд╣рдореЗрдВ рдЖрд╡рд╢реНрдпрдХрддрд╛ рдереАред  рдЗрд╕рдХреЗ рдЕрддрд┐рд░рд┐рдХреНрдд, SSB рдиреЗ рд╣рдореЗрдВ рд╡рд╣ рдкреНрд░рджрд░реНрд╢рди рдирд╣реАрдВ рджрд┐рдпрд╛ рдЬрд┐рд╕рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдереА, рдЗрд╕рд▓рд┐рдП рд╣рдореЗрдВ рдХреБрдЫ рдФрд░ рдЖрд╡рд┐рд╖реНрдХрд╛рд░ рдХрд░рдирд╛ рдерд╛ред <br><br><h3>  SQLCLR </h3><br>  рдкрд░рд┐рдгрд╛рдо рдХреЗ рд░реВрдк рдореЗрдВ рд╣рдо SQLCLR рддрдХрдиреАрдХ рдкрд░ рдЖрдзрд╛рд░рд┐рдд рдереЗред  SQLCLR рдПрдХ .NET рдкреНрд▓реЗрдЯрдлрд╝реЙрд░реНрдо рд╣реИ рдЬреЛ SQL Server рдХреЛрд░ рдореЗрдВ рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ рдФрд░ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реНрдиреЗрд▓ рдХреЗ рдЕрдВрджрд░ .NET рдХреЛрдб рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред  рдЪреВрдВрдХрд┐ рд╣рдо .NET рдХреЛрдб рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рддреЗ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рд╣рдо рд▓рдЧрднрдЧ рд╕рдм рдХреБрдЫ рдирд┐рдпрдорд┐рдд .NET рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рд░реВрдк рдореЗрдВ рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реИрдВред <br><blockquote>  <b>рдиреЛрдЯ:</b> рдореИрдВрдиреЗ рдКрдкрд░ "рд▓рдЧрднрдЧ" рд▓рд┐рдЦрд╛ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдХреБрдЫ рд╕реАрдорд╛рдПрдВ рд╣реИрдВред  рдЗрд╕ рд╕рдВрджрд░реНрдн рдореЗрдВ, рдЗрди рдкреНрд░рддрд┐рдмрдВрдзреЛрдВ рдХрд╛ рд▓рдЧрднрдЧ рдХреЛрдИ рдкреНрд░рднрд╛рд╡ рдирд╣реАрдВ рдкрдбрд╝рддрд╛ рд╣реИ рдХрд┐ рд╣рдо рдХреНрдпрд╛ рдХрд░рдиреЗ рдЬрд╛ рд░рд╣реЗ рд╣реИрдВред <br></blockquote>  SQLCLR рдХреЗ рд╕рдВрдЪрд╛рд▓рди рдХрд╛ рд╕рд┐рджреНрдзрд╛рдВрдд рдЗрд╕ рдкреНрд░рдХрд╛рд░ рд╣реИ: рдХреЛрдб рдПрдХ dll рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдореЗрдВ рд╕рдВрдХрд▓рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдФрд░ рдлрд┐рд░ рдпрд╣ рд▓рд╛рдЗрдмреНрд░реЗрд░реА SQL рд╕рд░реНрд╡рд░ рдЯреВрд▓реНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкрдВрдЬреАрдХреГрдд рд╣реИ: <br><br>  рд╡рд┐рдзрд╛рдирд╕рднрд╛ рдХрд╛ рдирд┐рд░реНрдорд╛рдг <br><br><pre><code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ASSEMBLY</span></span> [RabbitMQ.SqlServer] AUTHORIZATION rmq <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> <span class="hljs-string"><span class="hljs-string">'F:\some_path\RabbitMQSqlClr4.dll'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WITH</span></span> PERMISSION_SET = <span class="hljs-keyword"><span class="hljs-keyword">UNSAFE</span></span>; GO</code> </pre> <br>  <b>рдХреЛрдб рд╕реНрдирд┐рдкреЗрдЯ 1:</b> рдПрдмреНрд╕реЛрд▓реНрдпреВрдЯ рдкрд╛рде рдХреЗ рд╕рд╛рде рдЕрд╕реЗрдВрдмрд▓реА рдмрдирд╛рдирд╛ <br><br>  рдХреЛрдб рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреНрд░рд┐рдпрд╛рдПрдВ рдХрд░рддрд╛ рд╣реИ: <br><br><ul><li>  <code>CREATE ASSEMBLY</code> - рджрд┐рдП рдЧрдП рдирд╛рдо рдХреЗ рд╕рд╛рде рдПрдХ рд╡рд┐рдзрд╛рдирд╕рднрд╛ рдмрдирд╛рддрд╛ рд╣реИ (рдХреЛрдИ рдлрд░реНрдХ рдирд╣реАрдВ рдкрдбрд╝рддрд╛ рдХрд┐ рдпрд╣ рдХреНрдпрд╛ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП)ред </li><li>  <code>AUTHORIZATION</code> - рд╡рд┐рдзрд╛рдирд╕рднрд╛ рдХреЗ рдорд╛рд▓рд┐рдХ рдХреЛ рдЗрдВрдЧрд┐рдд рдХрд░рддрд╛ рд╣реИред  рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, rmq рдПрдХ рдкреВрд░реНрд╡рдирд┐рд░реНрдзрд╛рд░рд┐рдд SQL рд╕рд░реНрд╡рд░ рднреВрдорд┐рдХрд╛ рд╣реИред </li><li>  <code>FROM</code> - рдпрд╣ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдореВрд▓ рд╡рд┐рдзрд╛рдирд╕рднрд╛ рдХрд╣рд╛рдБ рд╕реНрдерд┐рдд рд╣реИред  <code>FROM</code> , рдЖрдк рдмрд╛рдЗрдирд░реА рдпрд╛ UNC рдлреЙрд░реНрдореЗрдЯ рдореЗрдВ рдкрде рднреА рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  рдЗрд╕ рдкрд░рд┐рдпреЛрдЬрдирд╛ рдХреЗ рд▓рд┐рдП рдЕрдзрд┐рд╖реНрдард╛рдкрди рдлрд╛рдЗрд▓реЗрдВ рдПрдХ рдмрд╛рдЗрдирд░реА рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреА рд╣реИрдВред </li><li>  <code>WITH PERMISSION_SET</code> - рдЕрдиреБрдорддрд┐рдпрд╛рдБ рд╕реЗрдЯ рдХрд░рддрд╛ рд╣реИред  <code>UNSAFE</code> рдХрдо рдХрдареЛрд░ рдФрд░ рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рдЖрд╡рд╢реНрдпрдХ рд╣реИред </li></ul><br><blockquote>  <b>рдиреЛрдЯ:</b> <code>AUTHORIZATION</code> рдХреНрд▓реЙрдЬ рдореЗрдВ рдЗрд╕реНрддреЗрдорд╛рд▓ рдХреА рдЧрдИ рднреВрдорд┐рдХрд╛ рдпрд╛ рд▓реЙрдЧрд┐рди рдХреА рдкрд░рд╡рд╛рд╣ рдХрд┐рдП рдмрд┐рдирд╛, рдЕрдкрдбреЛрдореИрди рдХреНрд▓рд╛рд╕ рдХреЛ рдЙрд╕реА рдирд╛рдо рд╕реЗ рдмрдирд╛рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП, рдЬрдм рдЕрд╕реЗрдВрдмрд▓реА рдореЗрдВ рд▓реЛрдб рд╣реЛ рд░рд╣рд╛ рд╣реЛред  рд╡рд┐рдзрд╛рдирд╕рднрд╛рдУрдВ рдХреЗ рд╡рд┐рднрд┐рдиреНрди рдирд╛рдореЛрдВ рдХреЗ рд╕рд╛рде рд╡рд┐рдзрд╛рдирд╕рднрд╛рдУрдВ рдХреЛ рдЕрд▓рдЧ рдХрд░рдиреЗ рдХреА рд╕рд┐рдлрд╛рд░рд┐рд╢ рдХреА рдЬрд╛рддреА рд╣реИ рддрд╛рдХрд┐ рдЬрдм рдПрдХ рд╡рд┐рдзрд╛рдирд╕рднрд╛ рд╡рд┐рдлрд▓ рд╣реЛ рдЬрд╛рдП, рддреЛ рдмрд╛рдХреА рди рдЧрд┐рд░реЗред  рд╣рд╛рд▓рд╛рдБрдХрд┐, рдпрджрд┐ рдЕрд╕реЗрдВрдмрд▓реА рдПрдХ-рджреВрд╕рд░реЗ рдкрд░ рдирд┐рд░реНрднрд░ рд╣реИрдВ, рддреЛ рдЙрдиреНрд╣реЗрдВ рдЕрд▓рдЧ-рдЕрд▓рдЧ рд╡рд░реНрдЧреЛрдВ рдореЗрдВ рд╡рд┐рднрд╛рдЬрд┐рдд рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред <br></blockquote>  рдЬрдм рдЕрд╕реЗрдВрдмрд▓реА рдмрдирд╛рдИ рдЬрд╛рддреА рд╣реИ, рд╣рдо рдЗрд╕рдореЗрдВ .NET рд╡рд┐рдзрд┐рдпреЛрдВ рдХреЗ рд░реИрдкрд░ рдмрдирд╛рддреЗ рд╣реИрдВ: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">PROCEDURE</span></span> rmq.pr_clr_PostRabbitMsg @EndpointID <span class="hljs-built_in"><span class="hljs-built_in">int</span></span>, @Message <span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">max</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">EXTERNAL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NAME</span></span> [RabbitMQ.SqlServer].[RabbitMQSqlClr.RabbitMQSqlServer].[pr_clr_PostRabbitMsg]; GO</code> </pre><br>  <b>рдХреЛрдб рд╕реНрдирд┐рдкреЗрдЯ 2:</b> .NET рд╡рд┐рдзрд┐ рдЖрд╡рд░рдг <br><br>  рдХреЛрдб рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреНрд░рд┐рдпрд╛рдПрдВ рдХрд░рддрд╛ рд╣реИ: <br><br><ul><li>  <code>rmq.pr_clr_PostRabbitMsg</code> рдирд╛рдо рдХреА рдПрдХ T-SQL рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд╛рд░реНрдпрд╡рд┐рдзрд┐ рдмрдирд╛рддрд╛ рд╣реИ рдЬреЛ рджреЛ рдкреИрд░рд╛рдореАрдЯрд░ рд▓реЗрддрд╛ рд╣реИ;  <code>@EndpointID</code> рдФрд░ <code>@Message</code> ред </li><li>  рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рд╢рд░реАрд░ рдХреЗ рдмрдЬрд╛рдп, рдПрдХ рдмрд╛рд╣рд░реА рд╕реНрд░реЛрдд рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рдирд┐рдореНрди рд╢рд╛рдорд┐рд▓ рд╣реИрдВ: <br><ul><li>  <code>RabbitMQ.SqlServer</code> рдирд╛рдо рдХрд╛ рдПрдХ рдЕрд╕реЗрдВрдмрд▓реА, рдпрд╛рдиреА рдХреБрд▓ рдорд┐рд▓рд╛рдХрд░ рдЬреЛ рд╣рдордиреЗ <b>рдХреЛрдб рд╕реНрдирд┐рдкреЗрдЯ 1</b> рдореЗрдВ рдмрдирд╛рдпрд╛ рд╣реИред </li><li>  рдкреВрд░реНрдг рдкреНрд░рдХрд╛рд░ (рдирд╛рдо рд╕реНрдерд╛рди рдФрд░ рд╡рд░реНрдЧ): <code>RabbitMQSqlClr.RabbitMQSqlServer</code> </li><li>  рдЙрдкрд░реЛрдХреНрдд рдирд╛рдорд╕реНрдерд╛рди рдФрд░ рд╡рд░реНрдЧ рдХреА рд╡рд┐рдзрд┐ рд╣реИ: <code>pr_clr_PostRabbitMsg</code> ред </li></ul></li></ul><br>  рдЬрдм <code>rmq.pr_clr_PostRabbitMsg</code> рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ <code>pr_clr_PostRabbitMsg</code> рд╡рд┐рдзрд┐ рдХреЛ рдмреБрд▓рд╛рдпрд╛ рдЬрд╛рдПрдЧрд╛ред <br><blockquote>  <b>рдиреЛрдЯ:</b> рдПрдХ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдмрдирд╛рддреЗ рд╕рдордп, рд╡рд┐рдзрд╛рдирд╕рднрд╛ рдХрд╛ рдирд╛рдо рдЯрд╛рдЗрдк рдФрд░ рд╡рд┐рдзрд┐ рдХреЗ рдкреВрд░реНрдг рдирд╛рдо рдХреЗ рд╡рд┐рдкрд░реАрдд, рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИред  рдпрд╣ рдЖрд╡рд╢реНрдпрдХ рдирд╣реАрдВ рд╣реИ рдХрд┐ рдмрдирд╛рдИ рдЬрд╛ рд░рд╣реА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХрд╛ рдирд╛рдо рд╡рд┐рдзрд┐ рдХреЗ рдирд╛рдо рд╕реЗ рдореЗрд▓ рдЦрд╛рддрд╛ рд╣реЛред  рд╣рд╛рд▓рд╛рдВрдХрд┐, рдорд╛рдкрджрдВрдбреЛрдВ рдХреЗ рд▓рд┐рдП рдЕрдВрддрд┐рдо рдбреЗрдЯрд╛ рдкреНрд░рдХрд╛рд░ рдореЗрд▓ рдЦрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред </blockquote>  рдЬреИрд╕рд╛ рдХрд┐ рдореИрдВрдиреЗ рдкрд╣рд▓реЗ рдХрд╣рд╛, рд╣рдо рдПрд╕рдХреНрдпреВрдПрд▓ рд╕рд░реНрд╡рд░ рдХреЗ рдмрд╛рд╣рд░ рдбреЗрдЯрд╛ рднреЗрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдХреА рдЬрд░реВрд░рдд рд╣реИ, рддреЛ рд╣рдо SQLCLR рдФрд░ рдкреНрд░рдпреЛрдЧ Derivco рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣реИ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">RabbitMQ</a> (RMQ)ред <br><br><h3>  RabbitMQ </h3><br>  RMQ рдПрдХ рдУрдкрди рд╕реЛрд░реНрд╕ рдореИрд╕реЗрдЬ рдмреНрд░реЛрдХрд░ рд╣реИ рдЬреЛ рдПрдбрд╡рд╛рдВрд╕реНрдб рдореИрд╕реЗрдЬ рдХреНрдпреВрдЗрдВрдЧ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ (AMQP) рдХреЛ рд▓рд╛рдЧреВ рдХрд░рддрд╛ рд╣реИ рдФрд░ рдПрд░реНрд▓рд╛рдВрдЧ рдореЗрдВ рд▓рд┐рдЦрд╛ рдЬрд╛рддрд╛ рд╣реИред <br><br>  рдХреНрдпреЛрдВрдХрд┐ RMQ рдПрдХ рдореИрд╕реЗрдЬ рдмреНрд░реЛрдХрд░ рд╣реИ, рдЗрд╕рд╕реЗ рдЬреБрдбрд╝рдиреЗ рдХреЗ рд▓рд┐рдП AMQP рдХреНрд▓рд╛рдЗрдВрдЯ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред  рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреНрд▓рд╛рдЗрдВрдЯ рдкреБрд╕реНрддрдХрд╛рд▓рдпреЛрдВ рдХреЛ рд╕рдВрджрд░реНрднрд┐рдд рдХрд░рддрд╛ рд╣реИ рдФрд░, рдЙрдирдХреА рдорджрдж рд╕реЗ, рдПрдХ рдХрдиреЗрдХреНрд╢рди рдЦреЛрд▓рддрд╛ рд╣реИ рдФрд░ рд╕рдВрджреЗрд╢ рднреЗрдЬрддрд╛ рд╣реИ - рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, SQL рд╕рд░реНрд╡рд░ рдХреЗ рд▓рд┐рдП ADO.NET рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдПрдХ рдХреЙрд▓ рд╣реИред  рд▓реЗрдХрд┐рди ADO.NET рдХреЗ рд╡рд┐рдкрд░реАрдд, рдЬрд╣рд╛рдВ, рд╕рдмрд╕реЗ рдЕрдзрд┐рдХ рд╕рдВрднрд╛рд╡рдирд╛ рд╣реИ, рдХрдиреЗрдХреНрд╢рди рд╣рд░ рдмрд╛рд░ рдбреЗрдЯрд╛рдмреЗрд╕ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреЗ рдмрд╛рдж рдЦреБрд▓рддрд╛ рд╣реИ, рдпрд╣рд╛рдВ рдХрдиреЗрдХреНрд╢рди рдЖрд╡реЗрджрди рдХреА рдкреВрд░реА рдЕрд╡рдзрд┐ рдХреЗ рд▓рд┐рдП рдЦреБрд▓рд╛ рд░рд╣рддрд╛ рд╣реИред <br><br>  рдЗрд╕ рдкреНрд░рдХрд╛рд░, RabbitMQ рдХреЗ рд╕рд╛рде рдбреЗрдЯрд╛рдмреЗрд╕ рд╕реЗ рдмрд╛рддрдЪреАрдд рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛрдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ RabbitMQ рдХреЗ рд▓рд┐рдП рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдФрд░ .NET рдХреНрд▓рд╛рдЗрдВрдЯ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред <br><blockquote>  <b>рдиреЛрдЯ:</b> рдЗрд╕ рд▓реЗрдЦ рдХреЗ рдЕрдЧрд▓реЗ рднрд╛рдЧ рдореЗрдВ, RabbitMQ рдХреЛрдб рдХреЗ рдЯреБрдХрдбрд╝реЗ рдорд┐рд▓реЗрдВрдЧреЗ, рд▓реЗрдХрд┐рди рд╡реЗ рдХреНрдпрд╛ рдХрд░рддреЗ рд╣реИрдВ, рдЗрд╕рдХреА рд╡рд┐рд╕реНрддреГрдд рд╡реНрдпрд╛рдЦреНрдпрд╛ рдХреЗ рдмрд┐рдирд╛ред  рдпрджрд┐ рдЖрдк RabbitMQ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирдП рд╣реИрдВ, рддреЛ рдореИрдВ рдХреЛрдб рдХреЗ рдЙрджреНрджреЗрд╢реНрдп рдХреЛ рд╕рдордЭрдиреЗ рдХреЗ рд▓рд┐рдП рд╡рд┐рднрд┐рдиреНрди <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">RabbitMQ рдЯреНрдпреВрдЯреЛрд░рд┐рдпрд▓</a> рдкрд░ рдПрдХ рдирдЬрд╝рд░ рдбрд╛рд▓рдиреЗ рдХрд╛ рд╕реБрдЭрд╛рд╡ рджреЗрддрд╛ рд╣реВрдВред  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╣реИрд▓реЛ рд╡рд░реНрд▓реНрдб</a> C # рдЯреНрдпреВрдЯреЛрд░рд┐рдпрд▓ рдПрдХ рдЕрдЪреНрдЫреА рд╢реБрд░реБрдЖрдд рд╣реИред  рдкрд╛рдареНрдпрдкреБрд╕реНрддрдХреЛрдВ рдФрд░ рдХреЛрдб рдЙрджрд╛рд╣рд░рдгреЛрдВ рдХреЗ рдмреАрдЪ рдПрдХ рдЕрдВрддрд░ рдпрд╣ рд╣реИ рдХрд┐ рдПрдХреНрд╕рдЪреЗрдВрдЬрд░реНрд╕ рдХреЛ рдЙрджрд╛рд╣рд░рдгреЛрдВ рдореЗрдВ рдШреЛрд╖рд┐рдд рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рдЙрдиреНрд╣реЗрдВ рдкреВрд░реНрд╡рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдорд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИред </blockquote><h3>  RabbitMQ.SqlServer </h3><br>  <b>RabbitMQ.SqlServer</b> рдПрдХ рдЕрд╕реЗрдВрдмрд▓реА рд╣реИ рдЬреЛ <b>RabbitMQ рдХреЗ</b> рд▓рд┐рдП .NET рдХреНрд▓рд╛рдЗрдВрдЯ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рдФрд░ рдбреЗрдЯрд╛рдмреЗрд╕ рд╕реЗ рдПрдХ рдпрд╛ рдЕрдзрд┐рдХ RabbitMQ рд╕рдорд╛рдкрди рдмрд┐рдВрджреБ (VHosts рдФрд░ рдПрдХреНрд╕рдЪреЗрдВрдЬрд░реНрд╕) рдХреЛ рд╕рдВрджреЗрд╢ рднреЗрдЬрдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред  рдХреЛрдб рдХреЛ GitHub рдкрд░ рдореЗрд░реЗ рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">RabbitMQ-SqlServer</a> рд╕реЗ рдбрд╛рдЙрдирд▓реЛрдб / рдХрд╛рдВрдЯрд╛ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред  рдЗрд╕рдореЗрдВ рдЕрд╕реЗрдВрдмрд▓реА рд╕реЛрд░реНрд╕ рдФрд░ рдЗрдВрд╕реНрдЯреЙрд▓реЗрд╢рди рдлрд╛рдЗрд▓реНрд╕ рд╣реИрдВ (рдпрд╛рдиреА рдЖрдкрдХреЛ рдЙрдиреНрд╣реЗрдВ рдЦреБрдж рдХрдВрдкрд╛рдЗрд▓ рдирд╣реАрдВ рдХрд░рдирд╛ рд╣реИ)ред <br><blockquote>  <b>рдиреЛрдЯ:</b> рдпрд╣ рджрд┐рдЦрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ SQL рд╕рд░реНрд╡рд░ RabbitMQ рдХреЗ рд╕рд╛рде рдХреИрд╕реЗ рдЗрдВрдЯрд░реИрдХреНрдЯ рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рдпрд╣ рдХреЗрд╡рд▓ рдПрдХ рдЙрджрд╛рд╣рд░рдг рд╣реИред  рдпрд╣ рдПрдХ рддреИрдпрд╛рд░ рдЙрддреНрдкрд╛рдж рдпрд╛ рдЗрд╕рдХрд╛ рд╣рд┐рд╕реНрд╕рд╛ рднреА рдирд╣реАрдВ рд╣реИред  рдпрджрд┐ рдпрд╣ рдХреЛрдб рдЖрдкрдХреЗ рдорд╕реНрддрд┐рд╖реНрдХ рдХреЛ рддреЛрдбрд╝рддрд╛ рд╣реИ - рдореБрдЭреЗ рджреЛрд╖ рди рджреЗрдВ, рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рд╕рд┐рд░реНрдл рдПрдХ рдЙрджрд╛рд╣рд░рдг рд╣реИред <br></blockquote><h3>  рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ </h3><br>  рдЬрдм рдЕрд╕реЗрдВрдмрд▓реА рд▓реЛрдб рдХреА рдЬрд╛рддреА рд╣реИ, рдпрд╛ рдЬрдм рдЗрд╕рдХреЗ рдЗрдирд┐рд╢рд┐рдпрд▓рд╛рдЗрдЬрд╝реЗрд╢рди рдХреЛ рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ, рдпрд╛ рдЬрдм рдЗрд╕реЗ рдЕрдкреНрд░рддреНрдпрдХреНрд╖ рд░реВрдк рд╕реЗ рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЙрд╕ рд╕рдордп рдЖрд╡рд░рдг рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЕрд╕реЗрдВрдмрд▓реА рдХрдиреЗрдХреНрд╢рди рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХреЛ рд╕реНрдерд╛рдиреАрдп рдбреЗрдЯрд╛рдмреЗрд╕ рдореЗрдВ рд▓реЛрдб рдХрд░рддреА рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдпрд╣ рд╕реНрдерд╛рдкрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛, рд╕рд╛рде рд╣реА рд╕рд╛рде рдпрд╣ рдХрдиреЗрдХреНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП RabbMM рд╕рдорд╛рдкрди рдмрд┐рдВрджреБ рднреА: <br><br>  рд╕рдВрдмрдВрдз <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">internal</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">InternalConnect</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { connFactory = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ConnectionFactory(); connFactory.Uri = connString; connFactory.AutomaticRecoveryEnabled = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; connFactory.TopologyRecoveryEnabled = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; RabbitConn = connFactory.CreateConnection(); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> x = <span class="hljs-number"><span class="hljs-number">0</span></span>; x &lt; channels; x++) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ch = RabbitConn.CreateModel(); rabbitChannels.Push(ch); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span>(Exception ex) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } }</code> </pre> <br>  <b>рдХреЛрдб рд╕реНрдирд┐рдкреЗрдЯ 3:</b> рд╕рдорд╛рдкрди рдмрд┐рдВрджреБ рд╕реЗ рдХрдиреЗрдХреНрдЯ рдХрд░реЗрдВ <br><br>  рдЙрд╕реА рд╕рдордп, рд╕рдорд╛рдкрди рдмрд┐рдВрджреБ рд╕реЗ рдХрдиреЗрдХреНрд╢рди рдХрд╛ рд╣рд┐рд╕реНрд╕рд╛ рднреА рдХрдиреЗрдХреНрд╢рди рдкрд░ IModels рдмрдирд╛рддрд╛ рд╣реИ, рдФрд░ рдЙрдиреНрд╣реЗрдВ (рдХрддрд╛рд░ рдореЗрдВ рдЬреЛрдбрд╝рдХрд░) рд╕рдВрджреЗрд╢ рднреЗрдЬрддреЗ рд╕рдордп рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ: <br><br>  рд╕рдВрджреЗрд╢ рднреЗрдЬрдирд╛ <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">internal</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Post</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> exchange, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] msg, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> topic</span></span></span><span class="hljs-function">)</span></span> { IModel <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> channelTryCount = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> ((!rabbitChannels.TryPop(<span class="hljs-keyword"><span class="hljs-keyword">out</span></span> <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>)) &amp;&amp; channelTryCount &lt; <span class="hljs-number"><span class="hljs-number">100</span></span>) { channelTryCount += <span class="hljs-number"><span class="hljs-number">1</span></span>; Thread.Sleep(<span class="hljs-number"><span class="hljs-number">50</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (channelTryCount == <span class="hljs-number"><span class="hljs-number">100</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> errMsg = <span class="hljs-string"><span class="hljs-string">$"Channel pool blocked when trying to post message to Exchange: </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{exchange}</span></span></span><span class="hljs-string">."</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ApplicationException(errMsg); } <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>.BasicPublish(exchange, topic, <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-literal"><span class="hljs-literal">null</span></span>, msg); rabbitChannels.Push(<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Exception ex) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">value</span></span> != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { _rabbitChannels.Push(<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span>; } }</code> </pre> <br>  <code>Post</code> рд╡рд┐рдзрд┐ рдХреЛ <code>pr_clr_PostRabbitMsg(int endPointId, string msgToPost)</code> рд╡рд┐рдзрд┐ <code>pr_clr_PostRabbitMsg(int endPointId, string msgToPost)</code> рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬрд┐рд╕реЗ рдПрдХ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рд░реВрдк рдореЗрдВ рдкреНрд░рд╕реНрддреБрдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛, рдЬреЛ рдХреЛрдб 2 рдореЗрдВ <code>pr_clr_PostRabbitMsg(int endPointId, string msgToPost)</code> <code>CREATE PROCEDURE</code> рдЦрдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣рд╛ рдерд╛ред <br><br>  рдкреЛрд╕реНрдЯ рдХреЙрд▓рд┐рдВрдЧ рд╡рд┐рдзрд┐ <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">pr_clr_PostRabbitMsg</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> endPointId, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> msgToPost</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(endPointId == <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ApplicationException(<span class="hljs-string"><span class="hljs-string">"EndpointId cannot be 0"</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!isInitialised) { pr_clr_InitialiseRabbitMq(); } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> msg = Encoding.UTF8.GetBytes(msgToPost); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (endPointId == <span class="hljs-number"><span class="hljs-number">-1</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> rep <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> remoteEndpoints) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> exch = rep.Value.Exchange; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> topic = rep.Value.RoutingKey; <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> pub <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> rabbitPublishers.Values) { pub.Post(exch, msg, topic); } } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { RabbitPublisher pub; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (rabbitPublishers.TryGetValue(endPointId, <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> pub)) { pub.Post(remoteEndpoints[endPointId].Exchange, msg, remoteEndpoints[endPointId].RoutingKey); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ApplicationException(<span class="hljs-string"><span class="hljs-string">$"EndpointId: </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{endPointId}</span></span></span><span class="hljs-string">, does not exist"</span></span>); } } } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span>; } }</code> </pre> <br>  <b>рдХреЛрдб рд╕реНрдирд┐рдкреЗрдЯ 5:</b> рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рд░реВрдк рдореЗрдВ рдПрдХ рд╡рд┐рдзрд┐ рдХрд╛ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдХрд░рдирд╛ <br><br>  рдЬрдм рд╡рд┐рдзрд┐ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдпрд╣ рдорд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ рдХрд┐ рдХреЙрд▓ рдХрд░рдиреЗ рд╡рд╛рд▓рд╛ рдЕрдВрддрд┐рдо рдмрд┐рдВрджреБ рдХреЗ рдкрд╣рдЪрд╛рдирдХрд░реНрддрд╛ рдХреЛ рднреЗрдЬрддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рд╕рдВрджреЗрд╢ рдкреНрд░рд╕рд╛рд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП, рдФрд░ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рд╕рдВрджреЗрд╢ рд╕реНрд╡рдпрдВред  рдпрджрд┐ рдорд╛рди -1 рдХреЛ рд╕рдорд╛рдкрди рдмрд┐рдВрджреБ рдХреЗ рдкрд╣рдЪрд╛рдирдХрд░реНрддрд╛ рдХреЗ рд░реВрдк рдореЗрдВ рдкрд╛рд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рд╣рдо рд╕рднреА рдмрд┐рдВрджреБрдУрдВ рдкрд░ рдкреБрдирд░рд╛рд╡реГрддрд┐ рдХрд░рддреЗ рд╣реИрдВ рдФрд░ рдЙрдирдореЗрдВ рд╕реЗ рдкреНрд░рддреНрдпреЗрдХ рдХреЛ рдПрдХ рд╕рдВрджреЗрд╢ рднреЗрдЬрддреЗ рд╣реИрдВред  рдПрдХ рд╕рдВрджреЗрд╢ рдПрдХ рд▓рд╛рдЗрди рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рд╕реЗ рд╣рдо рдкреНрд░рдпреЛрдЧ рдХрд░ рдмрд╛рдЗрдЯреНрд╕ рдорд┐рд▓ рдХреЗ рд░реВрдк рдореЗрдВ рдЖрддрд╛ рд╣реИ <code>Encoding.UTF8.GetBytes</code> ред  рдПрдХ рдЙрддреНрдкрд╛рджрди рд╡рд╛рддрд╛рд╡рд░рдг рдореЗрдВ, <code>Encoding.UTF8.GetBytes</code> рдХреЙрд▓ рдХреЛ рдХреНрд░рдорд╛рдВрдХрди рдХреЗ рд╕рд╛рде рдкреНрд░рддрд┐рд╕реНрдерд╛рдкрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред <br><br><h3>  рд╕реНрдерд╛рдкрдирд╛ </h3><br>  рдЙрджрд╛рд╣рд░рдг рдХреЛ рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдФрд░ рдЪрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ <code>src\SQL</code> рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ рд╕рднреА рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред  рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЗрди рдЪрд░рдгреЛрдВ рдХрд╛ рдкрд╛рд▓рди рдХрд░реЗрдВ: <br><br><ul><li>  рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛ рдЪрд▓рд╛рдПрдБ <code>01.create_database_and_role.sql</code> ред  рд╡рд╣ рдмрдирд╛рдПрдВрдЧреЗ: <br><ul><li>  <code>RabbitMQTest</code> рдкрд░реАрдХреНрд╖рдг рдбреЗрдЯрд╛рдмреЗрд╕ рдЬрд╣рд╛рдБ рдЕрд╕реЗрдВрдмрд▓реА рдмрдирд╛рдИ рдЬрд╛рдПрдЧреАред </li><li>  <code>rmq</code> рднреВрдорд┐рдХрд╛ рдХреЛ рд╡рд┐рдзрд╛рдирд╕рднрд╛ рдХреЗ рдорд╛рд▓рд┐рдХ рдХреЗ рд░реВрдк рдореЗрдВ рд╕реМрдВрдкрд╛ рдЬрд╛рдПрдЧрд╛ </li><li>  рдпреЛрдЬрдирд╛, рдЬрд┐рд╕реЗ <code>rmq</code> рднреА рдХрд╣рд╛ <code>rmq</code> ред  рдЗрд╕ рдЖрд░реЗрдЦ рдореЗрдВ, рд╡рд┐рднрд┐рдиреНрди рдбреЗрдЯрд╛рдмреЗрд╕ рдСрдмреНрдЬреЗрдХреНрдЯ рдмрдирд╛рдП рдЬрд╛рддреЗ рд╣реИрдВред <br></li></ul><br></li><li>  <code>02.create_database_objects.sql</code> рдлрд╝рд╛рдЗрд▓ рдЪрд▓рд╛рдПрдБред  рд╡рд╣ рдмрдирд╛рдПрдВрдЧреЗ: <br><br><ul><li>  <code>rmq.tb_RabbitSetting</code> рддрд╛рд▓рд┐рдХрд╛, рдЬреЛ рдХрдиреЗрдХреНрд╢рди рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХреЛ рд╕реНрдерд╛рдиреАрдп рдбреЗрдЯрд╛рдмреЗрд╕ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░реЗрдЧреАред </li><li>  <code>rmq.tb_RabbitEndpoint</code> рдЯреЗрдмрд▓, рдЬрд┐рд╕рдореЗрдВ рдПрдХ рдпрд╛ рдПрдХ рд╕реЗ рдЕрдзрд┐рдХ <code>RabbitMQ</code> рд╕рдорд╛рдкрди рдмрд┐рдВрджреБ рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реЛрдВрдЧреЗред </li></ul><br></li><li>  <code>03.create_localhost_connstring.sql</code> рдлрд╝рд╛рдЗрд▓ рдореЗрдВ <code>03.create_localhost_connstring.sql</code> рдЪрд░рдг 1 рдореЗрдВ рдирд┐рд░реНрдорд┐рдд <code>RabbitMQTest</code> рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЗ рд▓рд┐рдП рд╕рд╣реА рдХрдиреЗрдХреНрд╢рди рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХреЗ рд▓рд┐рдП <code>@connString</code> рдЪрд░ рдХрд╛ рдорд╛рди рдмрджрд▓реЗрдВ рдФрд░ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдЪрд▓рд╛рдПрдБред <br></li></ul><br>  рдЬрд╛рд░реА рд░рдЦрдиреЗ рд╕реЗ рдкрд╣рд▓реЗ, рдЖрдкрдХреЗ рдкрд╛рд╕ RabbitMQ рдмреНрд░реЛрдХрд░ рдХрд╛ рдПрдХ рдЗрдВрд╕реНрдЯреЗрдВрд╕ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП рдФрд░ VHost (рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ, VHost рдХреЛ / рдХреЗ рд░реВрдк рдореЗрдВ рджрд░реНрд╢рд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ)ред  рдПрдХ рдирд┐рдпрдо рдХреЗ рд░реВрдк рдореЗрдВ, рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдХрдИ VHost рд╣реИрдВ, рдмрд╕ рдЕрд▓рдЧрд╛рд╡ рдХреЗ рд▓рд┐рдПред  рдЗрд╕ рдореЗрдЬрдмрд╛рди рдХреЛ рднреА рдПрдХ рдПрдХреНрд╕рдЪреЗрдВрдЬрд░ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ, рдЙрджрд╛рд╣рд░рдг рдореЗрдВ рд╣рдо <code>amq.topic</code> рдЙрдкрдпреЛрдЧ <code>amq.topic</code> ред  рдЬрдм рдЖрдкрдХрд╛ RabbitMQ рдмреНрд░реЛрдХрд░ рддреИрдпрд╛рд░ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ <code>rmq.pr_UpsertRabbitEndpoint</code> рдкреНрд░рдХреНрд░рд┐рдпрд╛ <code>rmq.pr_UpsertRabbitEndpoint</code> рд╕рдВрдкрд╛рджрд┐рдд рдХрд░реЗрдВ, рдЬреЛ <code>04.upsert_rabbit_endpoint.sql</code> рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рд╕реНрдерд┐рдд рд╣реИ: <br><br>  рд╕рдорд╛рдкрди рдмрд┐рдВрджреБ RabbitMQ <br><br><pre> <code class="cs hljs">EXEC rmq.pr_UpsertRabbitEndpoint @Alias = <span class="hljs-string"><span class="hljs-string">'rabbitEp1'</span></span>, @ServerName = <span class="hljs-string"><span class="hljs-string">'RabbitServer'</span></span>, @Port = <span class="hljs-number"><span class="hljs-number">5672</span></span>, @VHost = <span class="hljs-string"><span class="hljs-string">'testHost'</span></span>, @LoginName = <span class="hljs-string"><span class="hljs-string">'rabbitAdmin'</span></span>, @LoginPassword = <span class="hljs-string"><span class="hljs-string">'some_secret_password'</span></span>, @Exchange = <span class="hljs-string"><span class="hljs-string">'amq.topic'</span></span>, @RoutingKey = <span class="hljs-string"><span class="hljs-string">'#'</span></span>, @ConnectionChannels = <span class="hljs-number"><span class="hljs-number">5</span></span>, @IsEnabled = <span class="hljs-number"><span class="hljs-number">1</span></span></code> </pre> <br>  <b>рдХреЛрдб рд╕реНрдирд┐рдкреЗрдЯ 6:</b> рд░реИрдмрд┐рдЯрдХреНрдпреВ рдореЗрдВ рдПрдХ рд╕рдорд╛рдкрди рдмрд┐рдВрджреБ рдмрдирд╛рдирд╛ <br><br>  рдЗрд╕ рдмрд┐рдВрджреБ рдкрд░, рдпрд╣ рдЕрд╕реЗрдВрдмрд▓рд┐рдпреЛрдВ рдХреЛ рддреИрдирд╛рдд рдХрд░рдиреЗ рдХрд╛ рд╕рдордп рд╣реИред  SQL рд╕рд░реНрд╡рд░ 2014 (2005, 2008, 2008R2, 2012) рд╕реЗ рдкрд╣рд▓реЗ рдФрд░ 2014 рдФрд░ рдЙрд╕рдХреЗ рдмрд╛рдж рдХреЗ рд▓рд┐рдП SQL рд╕рд░реНрд╡рд░ рдХреЗ рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдХреЗ рд▓рд┐рдП рдкрд░рд┐рдирд┐рдпреЛрдЬрди рд╡рд┐рдХрд▓реНрдкреЛрдВ рдореЗрдВ рдЕрдВрддрд░ рд╣реИрдВред  рдЕрдВрддрд░ рд╕реАрдПрд▓рдЖрд░ рдХреЗ рд╕рдорд░реНрдерд┐рдд рд╕рдВрд╕реНрдХрд░рдг рдореЗрдВ рдирд┐рд╣рд┐рдд рд╣реИред  SQL рд╕рд░реНрд╡рд░ 2014 рд╕реЗ рдкрд╣рд▓реЗ, .NET рдкреНрд▓реЗрдЯрдлрд╝реЙрд░реНрдо CLR рд╕рдВрд╕реНрдХрд░рдг 2 рдореЗрдВ рдЪрд▓ рд░рд╣рд╛ рдерд╛, рдФрд░ SQL рд╕рд░реНрд╡рд░ 2014 рдФрд░ рдЗрд╕рдХреЗ рдмрд╛рдж рдХреЗ рд╕рдВрд╕реНрдХрд░рдг рдореЗрдВ, рд╕рдВрд╕реНрдХрд░рдг 4 рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред <br><br><h3>  SQL рд╕рд░реНрд╡рд░ 2005 - 2012 </h3><br>  рдЪрд▓реЛ SQL рд╕рд░реНрд╡рд░ рдХреЗ рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рд╕реЗ рд╢реБрд░реВ рдХрд░рддреЗ рд╣реИрдВ рдЬреЛ CLR 2 рдкрд░ рдЪрд▓рддреЗ рд╣реИрдВ, рдХреНрдпреЛрдВрдХрд┐ рдЙрдирдХреА рдЕрдкрдиреА рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдВ рд╣реИрдВред  рд╣рдореЗрдВ рдирд┐рд░реНрдорд┐рдд рдЕрд╕реЗрдВрдмрд▓реА рдХреЛ рдкрд░рд┐рдирд┐рдпреЛрдЬрд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдФрд░ рдЙрд╕реА рд╕рдордп RabbitMQ рдХреНрд▓рд╛рдЗрдВрдЯ .NET рд▓рд╛рдЗрдмреНрд░реЗрд░реА ( <code>RabbitMQ.Client</code> ) рдХреЛ рддреИрдирд╛рдд рдХрд░реЗрдВред  рд╣рдорд╛рд░реА рд╡рд┐рдзрд╛рдирд╕рднрд╛ рд╕реЗ рд╣рдо рд░реИрдмрд┐рдЯрдПрдордХреНрдпреВ рдХреНрд▓рд╛рдЗрдВрдЯ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХрд╛ рдЙрд▓реНрд▓реЗрдЦ рдХрд░реЗрдВрдЧреЗред  рдХреНрдпреЛрдВрдХрд┐  рдЪреВрдБрдХрд┐ рд╣рдордиреЗ CLR 2, рд╣рдорд╛рд░реА рдЕрд╕реЗрдВрдмрд▓реА рдФрд░ <code>RabbitMQ.Client</code> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдпреЛрдЬрдирд╛ рдмрдирд╛рдИ рд╣реИред рдЗрд╕реЗ .NET 3.5 рдкрд░ рдЖрдзрд╛рд░рд┐рдд рд╕рдВрдХрд▓рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред  рд╕рдорд╕реНрдпрд╛рдПрдВ рд╣реИрдВред <br><br>  <code>RabbitMQ.Client</code> рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХреЗ рд╕рднреА рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг CLR 4 рдкрд░реНрдпрд╛рд╡рд░рдг рдХреЗ рд▓рд┐рдП рд╕рдВрдХрд▓рд┐рдд рдХрд┐рдП рдЧрдП рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рд╡реЗ рд╣рдорд╛рд░реЗ рдЕрд╕реЗрдВрдмрд▓реА рдореЗрдВ рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред  CLR 2 рдХреЗ рд▓рд┐рдП рдХреНрд▓рд╛рдЗрдВрдЯ рдкреБрд╕реНрддрдХрд╛рд▓рдпреЛрдВ рдХрд╛ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг .NET 3.4.3 рдкрд░ рд╕рдВрдХрд▓рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред  рд▓реЗрдХрд┐рди рдлрд┐рд░ рднреА рдпрджрд┐ рд╣рдо рдЗрд╕ рд╡рд┐рдзрд╛рдирд╕рднрд╛ рдХреЛ рддреИрдирд╛рдд рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рд╣рдореЗрдВ рдПрдХ рддреНрд░реБрдЯрд┐ рд╕рдВрджреЗрд╢ рдорд┐рд▓рддрд╛ рд╣реИ: <br><br><img src="https://habrastorage.org/webt/db/yo/uj/dbyouj4az0fzhnwpkvtdkgj6i-q.png"><br>  <i><b>рдЪрд┐рддреНрд░ 1:</b> рдорд┐рд╕рд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдоред ServiceModel рдЕрд╕реЗрдВрдмрд▓реА</i> <br><br>  <code>RabbitMQ.Client</code> рдХрд╛ рдпрд╣ рд╕рдВрд╕реНрдХрд░рдг SQL рд╕рд░реНрд╡рд░ CLR рдХрд╛ рд╣рд┐рд╕реНрд╕рд╛ рдирд╣реАрдВ рд╣реЛрдиреЗ рд╡рд╛рд▓реА рдЕрд╕реЗрдВрдмрд▓реА рдХреЛ рд╕рдВрджрд░реНрднрд┐рдд рдХрд░рддрд╛ рд╣реИред  рдпрд╣ рдПрдХ WCF рдЕрд╕реЗрдВрдмрд▓реА рд╣реИ, рдФрд░ рдпрд╣ SQLCLR рдХреА рдЙрди рд╕реАрдорд╛рдУрдВ рдореЗрдВ рд╕реЗ рдПрдХ рд╣реИ, рдЬрд┐рдирдХрд╛ рдореИрдВрдиреЗ рдКрдкрд░ рдЙрд▓реНрд▓реЗрдЦ рдХрд┐рдпрд╛ рд╣реИ: рдпрд╣ рд╡рд┐рд╢реЗрд╖ рдЕрд╕реЗрдВрдмрд▓реА рдЙрди рдкреНрд░рдХрд╛рд░ рдХреЗ рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП рд╣реЛрддреА рд╣реИ, рдЬрд┐рдиреНрд╣реЗрдВ SQL Server рдореЗрдВ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдирд╣реАрдВ рд╣реИред  <code>RabbitMQ.Client</code> рд╣рд╛рд▓ рдХреЗ рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдореЗрдВ рдпреЗ рдирд┐рд░реНрднрд░рддрд╛рдПрдВ рдирд╣реАрдВ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рдЙрдиреНрд╣реЗрдВ CLR рдХреА рдХрд╖реНрдЯрдкреНрд░рдж рдЖрд╡рд╢реНрдпрдХрддрд╛рдУрдВ рдХреЛ рдЫреЛрдбрд╝рдХрд░ рдХрд┐рд╕реА рднреА рд╕рдорд╕реНрдпрд╛ рдХреЗ рдмрд┐рдирд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдореБрдЭреЗ рдХреНрдпрд╛ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП? <br><br>  рдЬреИрд╕рд╛ рдХрд┐ рдЖрдк рдЬрд╛рдирддреЗ рд╣реИрдВ, RabbitMQ рдПрдХ рдЦреБрд▓рд╛ рд╕реНрд░реЛрдд рд╣реИ, рд▓реЗрдХрд┐рди рд╣рдо рдбреЗрд╡рд▓рдкрд░реНрд╕ рд╣реИрдВ, рд╣реИ рдирд╛?  ;) рддреЛ рдЪрд▓реЛ recompile!  <code>RabbitMQ.Client</code> рдХреЗ рдирд╡реАрдирддрдо рд░рд┐рд▓реАрдЬрд╝ (рдпрд╛рдиреА рд╕рдВрд╕реНрдХрд░рдг &lt;3.5.0) рд╕реЗ рдкрд╣рд▓реЗ рдХреЗ рд╕рдВрд╕реНрдХрд░рдг рдореЗрдВ <code>RabbitMQ.Client</code> рдореИрдВрдиреЗ <code>System.ServiceModel</code> рдХреЗ рд▓рд┐рдВрдХ рд╣рдЯрд╛ рджрд┐рдП рдФрд░ рдкреБрди: рд╕рдВрдХрд▓рд┐рдд рдХрд░ рд▓рд┐рдпрд╛ред  рдореБрдЭреЗ <code>System.ServiceModel</code> рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХреЛрдб рдХреА рдХреБрдЫ рдкрдВрдХреНрддрд┐рдпреЛрдВ рдХреЛ рдмрджрд▓рдирд╛ рдерд╛, рд▓реЗрдХрд┐рди рдпреЗ рдорд╛рдореВрд▓реА рдкрд░рд┐рд╡рд░реНрддрди рдереЗред <br><br>  рдЗрд╕ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ, рдореИрдВрдиреЗ рдХреНрд▓рд╛рдЗрдВрдЯ рд╕рдВрд╕реНрдХрд░рдг 3.4.3 рдХрд╛ рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд┐рдпрд╛, рд▓реЗрдХрд┐рди рдореИрдВрдиреЗ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╕реНрдерд┐рд░ рд░рд┐рд▓реАрдЬ 3.6.6</a> рд▓рд┐рдпрд╛ рдФрд░ .NET 3.5 (рд╕реАрдПрд▓рдЖрд░ 2) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреБрди: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╕рдВрдХрд▓рд┐рдд рдХрд┐рдпрд╛</a> ред  рдЗрд╕рдиреЗ рд▓рдЧрднрдЧ рдХрд╛рдо рдХрд┐рдпрд╛ :), рд╕рд┐рд╡рд╛рдп рдЗрд╕рдХреЗ рдХрд┐ рдмрд╛рдж рдореЗрдВ <code>RabbitMQ.Client</code> <code>Task</code> 'рдХрд╛ рд╡рд┐рдореЛрдЪрди рд╣реБрдЖ рдФрд░ рдЬреЛ рдореВрд▓ рд░реВрдк рд╕реЗ .NET 3.5 рдХрд╛ рд╣рд┐рд╕реНрд╕рд╛ рдирд╣реАрдВ рд╣реИрдВред <br><br>  рд╕реМрднрд╛рдЧреНрдп рд╕реЗ, .NET 3.5 рдХреЗ рд▓рд┐рдП <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><code>System.Threading.dll</code></a> рдХрд╛ рдПрдХ рд╕рдВрд╕реНрдХрд░рдг рд╣реИ рдЬрд┐рд╕рдореЗрдВ <code>Task</code> рд╢рд╛рдорд┐рд▓ рд╣реИред  рдореИрдВрдиреЗ рдЗрд╕реЗ рдбрд╛рдЙрдирд▓реЛрдб рдХрд┐рдпрд╛, рд▓рд┐рдВрдХ рд╕реЗрдЯ рдХрд┐рдпрд╛ рдФрд░ рд╕рдм рдХреБрдЫ рдЪрд▓рд╛ рдЧрдпрд╛!  рдпрд╣рд╛рдВ рдореБрдЦреНрдп рдЪрд╛рд▓ рдпрд╣ рд╣реИ рдХрд┐ <code>System.Threading.dll</code> рдХреЛ рд╡рд┐рдзрд╛рдирд╕рднрд╛ рдХреЗ рд╕рд╛рде рд╕реНрдерд╛рдкрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред <br><blockquote>  <b>рдиреЛрдЯ:</b> рд╕реНрд░реЛрдд <code>RabbitMQ.Client</code> , рдЬрд┐рд╕рдореЗрдВ рд╕реЗ рдореИрдВ .NET 3.5 рдХреЗ рд╕рдВрд╕реНрдХрд░рдг рдХреЗ рд▓рд┐рдП рдПрдХрддреНрд░ рд╣реБрдП, рд╡рд╣рд╛рдБ GitHub рдкрд░ рдореЗрд░реА рдЦрдЬрд╛рдиреЗ рдореЗрдВ рд╣реИ <a href="">RabbitMQ 3.6.6 рдХреНрд▓рд╛рдЗрдВрдЯ .NET 3.5</a> ред  .NET 3.5 рдХреЗ рд▓рд┐рдП <code>System.Threading.dll</code> рдХреЗ рд╕рд╛рде dll рдмрд╛рдЗрдирд░реА рднреА рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">(RabbitMQ-SqlServer)</a> рдХреЗ <code>lib\NET3.5</code> рдореЗрдВ рдирд┐рд╣рд┐рдд рд╣реИред <br></blockquote>  рдЖрд╡рд╢реНрдпрдХ рдЕрд╕реЗрдВрдмрд▓реА рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП ( <code>System.Threading</code> , <code>RabbitMQ.Client</code> рдФрд░ <code>RabbitMQ.SqlServer</code> ) рдирд┐рдореНрди рдХреНрд░рдо рдореЗрдВ <code>src\sql</code> рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рд╕реЗ рд╕рдВрд╕реНрдерд╛рдкрди рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдЪрд▓рд╛рдПрдБ: <br><br><ol><li>  <code>05.51.System.Threading.sql2k5-12.sql</code> - System.Threading </li><li>  <code>05.52.RabbitMQ.Client.sql2k5-12.sql</code> - <code>05.52.RabbitMQ.Client.sql2k5-12.sql</code> </li><li>  <code>05.53.RabbitMQ.SqlServer.sql2k5-12.sql</code> - RabbitMQ.SqlServer </li></ol><br><h3>  SQL рд╕рд░реНрд╡рд░ 2014+ </h3><br>  SQL рд╕рд░реНрд╡рд░ 2014 рдФрд░ рдмрд╛рдж рдореЗрдВ, рдЕрд╕реЗрдВрдмрд▓реА .NET 4.XX рдХреЗ рддрд╣рдд рд╕рдВрдХрд▓рд┐рдд рдХрд░рддрд╛ рд╣реИ (рдореЗрд░рд╛ рдЙрджрд╛рд╣рд░рдг 4.5.2 рдкрд░ рд╣реИ), рдФрд░ рдЖрдк <code>RabbitMQ.Client</code> рдХрд┐рд╕реА рднреА рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдХреЛ рд╕рдВрджрд░реНрднрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЬрд┐рд╕реЗ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">NuGet</a> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред  рдореЗрд░реЗ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ, рдореИрдВ 4.1.1 рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣рд╛ рд╣реВрдВред  <code>RabbitMQ.Client</code> , рдЬреЛ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА (RabbitMQ-SqlServer)</a> рдХреЗ <code>lib\NET4</code> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╣реИ</a> ред <br><br>  рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреНрд░рдо рдореЗрдВ <code>src\sql</code> рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рд╕реЗ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдЪрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП: <br><br><ol><li>  <code>05.141.RabbitMQ.Client.sql2k14+.sql</code> - RabbitMQ.Client </li><li>  <code>05.142.RabbitMQ.SqlServer.sql2k14+.sql</code> - <code>05.142.RabbitMQ.SqlServer.sql2k14+.sql</code> </li></ol><br><h3>  рдПрд╕рдХреНрдпреВрдПрд▓ рд╡рд┐рдзрд┐ рдЖрд╡рд░рдг </h3><br>  рд╣рдорд╛рд░реА рдЕрд╕реЗрдВрдмрд▓реА (3.5 рдпрд╛ 4) рд╕реЗ рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛рдиреЗ рд╡рд╛рд▓реА рдкреНрд░рдХреНрд░рд┐рдпрд╛рдПрдБ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП, рд╕реНрдХреНрд░рд┐рдкреНрдЯ <code>06.create_sqlclr_procedures.sql</code> ред  рд╡рд╣ рддреАрди .NET рд╡рд┐рдзрд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП рдЯреА-рдПрд╕рдХреНрдпреВрдПрд▓ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдПрдБ рдмрдирд╛рдПрдЧрд╛: <br><br><ul><li>  <code>rmq.pr_clr_InitialiseRabbitMq</code> рдХреЙрд▓ <code>pr_clr_InitialiseRabbitMq</code> ред  RabbitMQ.SqlServer рдЕрд╕реЗрдВрдмрд▓реА рдХреЛ рд▓реЛрдб рдФрд░ рдкреНрд░рд╛рд░рдВрдн рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред </li><li>  <code>rmq.pr_clr_ReloadRabbitEndpoints</code> рдХрд╛ рдХрд╛рд░рдг рдмрдирддрд╛ рд╣реИ <code>pr_clr_ReloadRabbitEndpoints</code> ред  рд╡рд┐рднрд┐рдиреНрди RabbitMQ рд╕рдорд╛рдкрди рдмрд┐рдВрджреБ рд▓реЛрдб рдХрд░рддрд╛ рд╣реИред </li><li>  <code>rmq.pr_clr_PostRabbitMsg</code> рдХрд╣рддрд╛ рд╣реИред  RabbitMQ рдХреЛ рд╕рдВрджреЗрд╢ рднреЗрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред </li></ul><br>  рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдПрдХ рд╕рд╛рдзрд╛рд░рдг T-SQL рдкреНрд░рдХреНрд░рд┐рдпрд╛ рднреА рдмрдирд╛рддреА рд╣реИ - <code>rmq.pr_PostRabbitMsg</code> , рдЬреЛ <code>rmq.pr_clr_PostRabbitMsg</code> рдкрд░ рд▓рд╛рдЧреВ рд╣реЛрддреА рд╣реИред  рдпрд╣ рдПрдХ рдЖрд╡рд░рдг рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╣реИ рдЬреЛ рдЬрд╛рдирддреА рд╣реИ рдХрд┐ рдбреЗрдЯрд╛ рдХреЗ рд╕рд╛рде рдХреНрдпрд╛ рдХрд░рдирд╛ рд╣реИ, рдЕрдкрд╡рд╛рджреЛрдВ рдХреЛ рд╕рдВрднрд╛рд▓рдирд╛ рдЖрджрд┐ред  рдЙрддреНрдкрд╛рджрди рдкрд░рд┐рд╡реЗрд╢ рдореЗрдВ, рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдХрдИ рд╕рдорд╛рди рдкреНрд░рдХреНрд░рд┐рдпрд╛рдПрдВ рд╣реИрдВ рдЬреЛ рд╡рд┐рднрд┐рдиреНрди рдкреНрд░рдХрд╛рд░ рдХреЗ рд╕рдВрджреЗрд╢реЛрдВ рдХреЛ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд░рддреА рд╣реИрдВред  рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдиреАрдЪреЗ рдкрдврд╝реЗрдВред <br><br><h3>  рдХреЗ рдЙрдкрдпреЛрдЧ </h3><br>  рдЙрдкрд░реЛрдХреНрдд рд╕рднреА рд╕реЗ, рдпрд╣ рд╕реНрдкрд╖реНрдЯ рд╣реИ рдХрд┐ RabbitMQ рдХреЛ рд╕рдВрджреЗрд╢ рднреЗрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рд╣рдо <code>rmq.pr_PostRabbitMsg</code> рдпрд╛ <code>rmq.pr_clr_PostRabbitMsg</code> рдХреЙрд▓ <code>rmq.pr_clr_PostRabbitMsg</code> , рдорд╛рдкрджрдВрдбреЛрдВ рдореЗрдВ рд╕рдорд╛рдкрди рдмрд┐рдВрджреБ рдХреЗ рдкрд╣рдЪрд╛рдирдХрд░реНрддрд╛ рдФрд░ рд╕рдВрджреЗрд╢ рдХреЛ рдПрдХ рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХреЗ рд░реВрдк рдореЗрдВ рдкрд╛рд╕ рдХрд░рддреЗ рд╣реИрдВред  рдпрд╣ рд╕рдм, рдЬрд╝рд╛рд╣рд┐рд░ рд╣реИ, рд╢рд╛рдВрдд рд╣реИ, рд▓реЗрдХрд┐рди рдореИрдВ рдпрд╣ рджреЗрдЦрдирд╛ рдЪрд╛рд╣реВрдВрдЧрд╛ рдХрд┐ рдпрд╣ рд╡рд╛рд╕реНрддрд╡рд┐рдХрддрд╛ рдореЗрдВ рдХреИрд╕реЗ рдХрд╛рдо рдХрд░реЗрдЧрд╛ред <br><br>  рд╣рдо рдЙрддреНрдкрд╛рджрди рд╡рд╛рддрд╛рд╡рд░рдг рдореЗрдВ рдЬреЛ рдХрд░рддреЗ рд╣реИрдВ рд╡рд╣ рдпрд╣ рд╣реИ рдХрд┐ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд╛рд░реНрдпрд╡рд┐рдзрд┐рдпреЛрдВ рдореЗрдВ рдЬреЛ рдбреЗрдЯрд╛ рдХреЛ RabbitMQ рдХреЛ рднреЗрдЬрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП, рд╣рдо рднреЗрдЬреЗ рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдбреЗрдЯрд╛ рдХреЛ рдЗрдХрдЯреНрдард╛ рдХрд░рддреЗ рд╣реИрдВ рдФрд░ рдХрдиреЗрдХреНрд╢рди рдмреНрд▓реЙрдХ рдореЗрдВ рд╣рдо <code>rmq.pr_PostRabbitMsg</code> рдЬреИрд╕реА рдкреНрд░рдХреНрд░рд┐рдпрд╛ <code>rmq.pr_PostRabbitMsg</code> ред  рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЗрд╕ рддрд░рд╣ рдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХрд╛ рдПрдХ рдмрд╣реБрдд рд╣реА рд╕рд░рд▓ рдЙрджрд╛рд╣рд░рдг рд╣реИ: <br><br>  рдбрд╛рдЯрд╛ рдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдкреНрд░рдХреНрд░рд┐рдпрд╛ <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">ALTER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">PROCEDURE</span></span> dbo.pr_SomeProcessingStuff @<span class="hljs-keyword"><span class="hljs-keyword">id</span></span> <span class="hljs-built_in"><span class="hljs-built_in">int</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> NOCOUNT <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span> TRY <span class="hljs-comment"><span class="hljs-comment">--     DECLARE @endPointId int; --    DECLARE @msg nvarchar(max) = '{' --        SET @msg = @msg + '"Id":' + CAST(@id AS varchar(10)) + ',' --  -  SET @msg = @msg + '"FName":"Hello",'; SET @msg = @msg + '"LName":"World"'; SET @msg = @msg + '}'; -- -  --     -,  -  SELECT @endPointId = 1; --    --     EXEC rmq.pr_PostRabbitMsg @Message = @msg, @EndpointID = @endPointId; END TRY BEGIN CATCH DECLARE @errMsg nvarchar(max); DECLARE @errLine int; SELECT @errMsg = ERROR_MESSAGE(), @errLine = ERROR_LINE(); RAISERROR('Error: %s at line: %d', 16, -1, @errMsg, @errLine); END CATCH END</span></span></code> </pre> <br>  <b>рдХреЛрдб рдЯреБрдХрдбрд╝рд╛ 7 рдореЗрдВ,</b> рд╣рдо рджреЗрдЦрддреЗ рд╣реИрдВ рдХрд┐ рдХреИрд╕реЗ рдЖрд╡рд╢реНрдпрдХ рдбреЗрдЯрд╛ рдХреЛ рдХреИрдкреНрдЪрд░ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдВ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рдХреЗ рдмрд╛рдж рднреЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИред  рдЗрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, <code>src\SQL</code> рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рд╕реЗ <code>07.create_processing_procedure.sql</code> рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдЪрд▓рд╛рдПрдБред <br><br><h3>  рдЪрд▓реЛ рдЗрд╕реЗ рд╕рдм рдЪрд▓рд╛рддреЗ рд╣реИрдВ </h3><br>  рдЗрд╕ рдмрд┐рдВрджреБ рдкрд░, рдЖрдкрдХреЛ рдХреБрдЫ рд╕рдВрджреЗрд╢ рднреЗрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рддреИрдпрд╛рд░ рд░рд╣рдирд╛ рдЪрд╛рд╣рд┐рдПред  рдкрд░реАрдХреНрд╖рдг рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ, рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ рдХрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ <code>rmq.tb_RabbitEndpoint</code> рдореЗрдВ рд╕рдорд╛рдкрди рдмрд┐рдВрджреБ рдПрдХреНрд╕рдЪреЗрдВрдЬрд░ рд╕реЗ рдЬреБрдбрд╝реЗ RabbitMQ рдореЗрдВ <code>rmq.tb_RabbitEndpoint</code> ред <br><br>  рддреЛ, рдЖрдкрдХреЛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ: <br>  <code>99.test_send_message.sql</code> рдлрд╝рд╛рдЗрд▓ рдЦреЛрд▓реЗрдВред <br>  рдХрд╛ рдкрд╛рд▓рди рдХрд░реЗрдВ <br><br><pre> <code class="sql hljs">EXEC rmq.pr_clr_InitialiseRabbitMq;</code> </pre> <br>  рдЕрд╕реЗрдВрдмрд▓реА рдХреЛ рдЖрд░рдВрднреАрдХреГрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдФрд░ RabbitMQ рд╕рдорд╛рдкрди рдмрд┐рдВрджреБ рд▓реЛрдб рдХрд░реЗрдВ  рдпрд╣ рдПрдХ рдЖрд╡рд╢реНрдпрдХ рдХрджрдо рдирд╣реАрдВ рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣ рдЕрдиреБрд╢рдВрд╕рд╛ рдХреА рдЬрд╛рддреА рд╣реИ рдХрд┐ рдЖрдк рдЗрд╕реЗ рдмрдирд╛рдиреЗ рдпрд╛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж рд╡рд┐рдзрд╛рдирд╕рднрд╛ рдХреЛ рд▓реЛрдб рдХрд░реЗрдВред <br><br>  рдХрд╛ рдкрд╛рд▓рди рдХрд░реЗрдВ <br><br><pre> <code class="sql hljs">EXEC dbo.pr_SomeProcessingStuff @id = 101</code> </pre> <br>  (рдЖрдк рдЕрдкрдиреА рдкрд╕рдВрдж рдХреЗ рдХрд┐рд╕реА рдЕрдиреНрдп рдкрд╣рдЪрд╛рдирдХрд░реНрддрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ)ред <br><br>  рдпрджрд┐ рд╕рдм рдХреБрдЫ рддреНрд░реБрдЯрд┐рдпреЛрдВ рдХреЗ рдмрд┐рдирд╛ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ, рддреЛ рдПрдХ рд╕рдВрджреЗрд╢ RabbitMQ рдХрддрд╛рд░ рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗрдирд╛ рдЪрд╛рд╣рд┐рдП!  рдЗрд╕рд▓рд┐рдП рдЖрдкрдиреЗ RabCLMQ рдХреЛ рд╕рдВрджреЗрд╢ рднреЗрдЬрдиреЗ рдХреЗ рд▓рд┐рдП SQLCLR рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ред <br><br>  Kongratuleyshens! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/hi419457/">https://habr.com/ru/post/hi419457/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi419443/index.html">рдирд╛рд╕рд╛ рдлрд┐рд░ рд╕реЗ рд╡рд┐рдорд╛рди рдХреЗ рд╕рднреА рддрддреНрд╡реЛрдВ рдХреЛ рдмрдирд╛рддреЗ рд╣реБрдП, рдЪрдВрджреНрд░рдорд╛ рдкрд░ рдЙрдбрд╝рд╛рди рднрд░реЗрдЧрд╛</a></li>
<li><a href="../hi419445/index.html">Arduino рдкрд░рд┐рдпреЛрдЬрдирд╛рдУрдВ рдХреЗ рд▓рд┐рдП рдпреВрдирд┐рдЯ рдкрд░реАрдХреНрд╖рдг</a></li>
<li><a href="../hi419449/index.html">Redux рдмрдирд╛рдо рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рд╕рдВрджрд░реНрдн рдПрдкреАрдЖрдИ</a></li>
<li><a href="../hi419451/index.html">Symfony 4 рдЪрд░рдг рдХреЗ рд▓рд┐рдП рдПрдХ рдмрдВрдбрд▓ рдмрдирд╛рдПрдВ</a></li>
<li><a href="../hi419453/index.html">Nonlinear рд╕рдореАрдХрд░рдгреЛрдВ рдХреЗ рд╕рд┐рд╕реНрдЯрдо рдХреЛ рд╣рд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдЦреНрдпрд╛рддреНрдордХ рддрд░реАрдХреЗ</a></li>
<li><a href="../hi419459/index.html">рд▓реАрдб-рдПрд╕рд┐рдб рдмреИрдЯрд░реА: рдкрд▓реНрд╕ рдЪрд╛рд░реНрдЬ рд╡рд░реНрдгрдорд╛рд▓рд╛</a></li>
<li><a href="../hi419461/index.html">рд╡рд╛рд╢рд░реВрдо рд╡реЗрдВрдЯрд┐рд▓реЗрд╢рди</a></li>
<li><a href="../hi419467/index.html">рдПрдХ рдкреНрд░рдХрд╛рд╢ рдмрд▓реНрдм рд╕реЗ рдПрдХ рд╡реИрдХреНрдпреВрдо рдХреНрд▓реАрдирд░ рдФрд░ рдПрдХ рдбреНрд░реЛрди рддрдХ - рд╣рдордиреЗ рд╕реИрдХрдбрд╝реЛрдВ рдЙрдкрдХрд░рдгреЛрдВ рдХрд╛ рдкреНрд░рдмрдВрдзрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдРрд▓рд┐рд╕ рдХреЛ рдХреИрд╕реЗ рд╕рд┐рдЦрд╛рдпрд╛</a></li>
<li><a href="../hi419469/index.html">UE4 | рджрд┐рди рдФрд░ рд░рд╛рдд рдХрд╛ рдЪрдХреНрд░ | рд╕реНрдХрд╛рдИрд╕реНрдлреЗрдпрд░ рдХрд╛ рд╕рдВрд╢реЛрдзрди</a></li>
<li><a href="../hi419471/index.html">JQuery рд╕реЗ рд╢реБрджреНрдз рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЗ рд▓рд┐рдП рдкреНрд░рд╡рд╛рд╕рди рд╡рд┐рдХрд▓реНрдк</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>