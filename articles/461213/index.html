<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§±üèº üßïüèº üëã Prueba autom√°tica: diez salvavidas del equipo de Skyeng üë®‚Äçüë®‚Äçüë¶‚Äçüë¶ üò† üî´</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hola, soy Andrey Shalnev, l√≠der de automatizaci√≥n de control de calidad en el proyecto Skyeng Vimbox. A lo largo del a√±o, el equipo y yo nos dedicamos...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Prueba autom√°tica: diez salvavidas del equipo de Skyeng</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/skyeng/blog/461213/"><p><img src="https://habrastorage.org/webt/2j/ig/o-/2jigo-vprulzx1phj3nt14fzs_u.png"></p><br><p>  Hola, soy Andrey Shalnev, l√≠der de automatizaci√≥n de control de calidad en el proyecto Skyeng Vimbox.  A lo largo del a√±o, el equipo y yo nos dedicamos a optimizar los procesos de prueba autom√°tica y ahora estamos muy cerca de su etapa final.  Y esta es una buena raz√≥n para exhalar, revisar el trabajo atrasado y tomar algunos resultados intermedios.  Para Habra, decid√≠ hacer una selecci√≥n de las diez cosas m√°s √∫tiles y al mismo tiempo simples que nos ayudaron a hacer frente a la tarea de optimizar las pruebas autom√°ticas.  Espero que el art√≠culo sea √∫til para los equipos de control de calidad en empresas en crecimiento, donde los viejos procesos de prueba ya no pueden hacer frente a la carga, y el problema de la reorganizaci√≥n plantea la ventaja. </p><a name="habracut"></a><br><h2 id="kak-u-nas-seychas-ustroeny-avtotesty">  C√≥mo organizamos las pruebas autom√°ticas </h2><br><p>  Vimbox usa Angular para la interfaz, por lo que escribimos pruebas en una pila bastante cl√°sica para esta soluci√≥n: Protractor + Jasmine + JS / Typecript.  Durante el a√±o, redise√±amos significativamente el conjunto de pruebas de regresi√≥n.  En su forma inicial, era redundante y no muy conveniente: pruebas de varios cientos de l√≠neas con un tiempo de paso de 5-10 minutos, con una longitud de secuencia de comandos de prueba por separado, a menudo no llega al final debido a un archivo falso.  Ahora hemos dividido las pruebas en escenarios m√°s cortos y m√°s estables, usamos failFast para que el tiempo de ejecuci√≥n sea aceptable (una prueba que se bloquea en el medio no intentar√° completar cada pr√≥ximo paso y esperar√° a que se agote el tiempo).  Adem√°s, nos deshicimos de las verificaciones redundantes: nos aseguramos de que una caracter√≠stica espec√≠fica sea funcional en general, pero no intentamos verificarla en todas las variaciones posibles. </p><br><p> Las pruebas autom√°ticas tienen prioridad.  Un peque√±o conjunto de prioridades, la prueba de aceptaci√≥n del usuario (UAT), se ejecuta cada hora en el producto, despu√©s del despliegue de los proyectos principales y cuando se prueban tareas en bancos de pruebas. </p><br><p>  El proceso en los stands se ve as√≠: el desarrollador transfiere la tarea a las pruebas, QA la implementa en su stand y ejecuta las pruebas, tanto UAT como regresi√≥n.  En UAT, tenemos alrededor de 150 casos, regresi√≥n, alrededor de 700 pruebas, se actualiza constantemente.  La mayor√≠a de los casos que son importantes y cr√≠ticos, esta suite cubre aproximadamente el 80% y se ejecuta en cada iteraci√≥n. </p><br><h2 id="desyat-layfhakov">  Diez trucos de la vida </h2><br><ol><li><p> <strong>Especifique expl√≠citamente el rol de la instancia del navegador</strong> .  La especificidad de las pruebas de Vimbox es que en la gran mayor√≠a de los casos se usan dos o m√°s instancias del navegador, ya que la lecci√≥n tiene al menos dos lados: un maestro y un estudiante.  Sol√≠a ‚Äã‚Äãhaber un problema: una instancia del navegador se indicaba con un n√∫mero, se entend√≠a que todos entend√≠an que el <code>browser1</code> era un maestro, y el <code>browser2</code> y m√°s all√° eran estudiantes.  Pero este no es siempre el caso, sucedi√≥ que el navegador del estudiante fue el primero.  Adem√°s, hay pruebas en las que los estudiantes mismos son diferentes; por ejemplo, debemos asegurarnos de que no pueda ingresar accidentalmente a la lecci√≥n de otra persona.  Para dejar en claro a todos qu√© usuario se encuentra en qu√© instancia del navegador, comenzaron a indicar expl√≠citamente el rol en su nombre: <code>teacher.browser</code> , <code>wrongStudent.browser</code> , <code>wrongStudent.browser</code> , etc.  Tengo guiones de prueba m√°s legibles. </p><br></li><li><p>  <strong>Utilizamos funciones de flecha: <code>() =&gt;</code> , no <code>function()</code></strong> .  En primer lugar, ese registro es m√°s corto.  En segundo lugar, una sintaxis m√°s moderna, tratamos de alejarnos de lo arcaico.  Tercero, las funciones de flecha evitan problemas con <code>this</code> puntero desde JavaScript.  La funci√≥n de flecha no crea su <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">alcance l√©xico</a> , por lo que es posible hacer referencia a algo definido fuera de <code>this</code> .  Desh√°gase de la cl√°sica muleta <code>self</code> = <code>this</code> . </p><br></li><li><p>  <strong>Utilizamos cadenas de plantilla en lugar de concatenaciones con m√°s: `Student $ {studentName}`, y no "Student" + studentName</strong> .  Intentamos usar cadenas de patrones en lugar de concatenaciones con m√°s. </p><br><img src="https://habrastorage.org/webt/gf/2c/n_/gf2cn_uy1g1i63kity7reuddx38.png"><br><p>  Esta es una sintaxis moderna, es m√°s legible, ambos tipos de comillas (simple y doble) se pueden usar dentro de la cadena y no se pueden filtrar. </p><br></li><li><p>  <strong>Usamos TypeScript</strong> .  Principalmente en aras de sugerencias de entorno de desarrollo m√°s adecuadas y navegaci√≥n de c√≥digo normal.  Ahora, en la mayor√≠a de los casos, en lugar de algunos consejos, es posible una transici√≥n directa al m√©todo / campo.  Al mismo tiempo, cambiar a TypeScript no requiri√≥ mucha refactorizaci√≥n al mismo tiempo: para empezar, simplemente puede cambiar las extensiones de archivo de .js a .ts, el proyecto sigue siendo viable.  Luego cambie gradualmente la sintaxis de <code>require</code> para <code>Import</code> , se mejora la navegaci√≥n. </p><br></li><li><p>  <strong>Divida los Objetos de p√°gina grandes en subclases</strong> para facilitar el mantenimiento de dichos objetos.  Nuestra mayor lecci√≥n de Objeto de p√°gina alcanz√≥ cuatro mil l√≠neas de c√≥digo, fue dif√≠cil hojearla, recuerda lo que comenz√≥, lo que no.  Ahora el c√≥digo m√°s largo es de aproximadamente 1300 l√≠neas.  Podemos decir que al hacerlo nos deshicimos de la gran clase antipatr√≥n.  Adem√°s, eliminaron comentarios innecesarios y trabajaron en la conveniencia y la comprensi√≥n de los nombres de los m√©todos: en la mayor√≠a de los casos, si el m√©todo se nombra de acuerdo con la convenci√≥n clara para todos, simplemente no es necesario un comentario que explique su trabajo. </p><br></li><li><p>  <strong>Ejecutamos la UAT en paralelo en varios subprocesos</strong> para facilitar el trabajo con la UAT en el producto.  El hecho es que con nosotros dicha prueba se ejecuta una vez por hora y se ejecuta en un hilo durante 15 minutos.  Si ocurre un archivo en √©l, se reiniciar√° y al final funcionar√° durante media hora.  Durante una implementaci√≥n, esto puede ser un problema porque la cola se retrasa.  El resultado de usar el paralelo es 2-3 minutos en el UAT (o 6 con un reinicio).  La cola se mueve m√°s r√°pido, la informaci√≥n sobre el problema o que el archivo result√≥ ser falso llega m√°s r√°pido. </p><br></li><li><p>  <strong>Regularmente ejecutamos UAT y regresi√≥n en bancos de prueba</strong> .  Cada uno de nuestros probadores manuales tiene su propio servidor.  Sol√≠amos ejecutar pruebas de regresi√≥n en prod despu√©s de que el probador manual encontrara una parte significativa de los errores; de hecho, simplemente lo verificamos.  Ahora ejecutamos pruebas autom√°ticas en cada iteraci√≥n de la prueba manual de la tarea, que, en primer lugar, facilita el trabajo de un probador manual (no necesita perforar lo que es autom√°ticamente), y en segundo lugar, acorta el ciclo de retroalimentaci√≥n.  Si el desarrollador ha roto algo, lo sabr√° media hora despu√©s de implementar la tarea, y no al d√≠a siguiente.  Adem√°s, en el banco de pruebas puede hacer muchas cosas que no son deseables en la producci√≥n: cambiar el n√∫mero de versi√≥n del producto, eliminar / agregar contenido de prueba, editar sin miedo la base de datos para preparar la situaci√≥n de prueba, etc. </p><br></li><li><p>  <strong>Eliminar archivos vac√≠os</strong> .  Intentamos mantener la coherencia entre la estructura de directorios en las pruebas autom√°ticas y en Testrail.  Pero al mismo tiempo, en alg√∫n momento nos encontramos con un problema: en Testrail hay una gran cantidad de casos con baja prioridad (solo alrededor de 9000+ casos), porque  Se utiliza como base de conocimiento del proyecto.  Al mismo tiempo, solo alrededor de mil de los casos m√°s importantes est√°n cubiertos con autotest.  Si logramos una coincidencia perfecta, obtenemos una gran cantidad de archivos y directorios no utilizados.  Esto complica la navegaci√≥n del proyecto y dificulta la comprensi√≥n de lo que realmente se est√° probando.  Como resultado, solo quedaron las carpetas y archivos necesarios, el resto se elimin√≥. </p><br></li><li><p>  <strong>Arreglamos los errores encontrados</strong> .  La tarea principal de las pruebas autom√°ticas no es encontrar errores, sino asegurarse r√°pidamente de que no est√°n all√≠, por lo que rara vez se detecta algo.  La fijaci√≥n resuelve dos problemas: en primer lugar, vemos estad√≠sticas donde los problemas persisten con mayor frecuencia y cu√°les, y en segundo lugar, nos deshacemos de la sensaci√≥n de que estamos haciendo algo mal.  Cuando las pruebas no encuentran nada, surge la pregunta: ¬øestamos haciendo todo bien, tal vez nuestras pruebas no sirvan?  Y luego hay una tableta que muestra que cuando pudieron atrapar: m√°s de 60 errores por a√±o.  Al mismo tiempo, el significado de ejecutar pruebas en servidores de prueba y prod se hizo evidente.  El lanzamiento frecuente en el producto, cada hora, ayuda a detectar problemas de infraestructura (un servicio externo no est√° disponible, nuestro servidor se apag√≥), el lanzamiento antes de las pruebas manuales detecta aver√≠as introducidas por el nuevo c√≥digo. </p><br></li><li><p>  <strong>Se implementaron los atributos data-qa-id</strong> , por ejemplo, <code>[data-qa-id="btn-login"]</code> .  Prop√≥sito: selectores m√°s estables.  Acordamos con el equipo de desarrollo que si cambia la implementaci√≥n de algunos elementos, si ven el atributo <code>data-qa-id</code> all√≠, entonces entienden que esto es para las pruebas autom√°ticas, no lo cambian y lo transfieren con precisi√≥n.  Este atributo tiene un nombre l√≥gico, que en s√≠ mismo puede determinar de qu√© es responsable el elemento.  Adem√°s, no dependemos de la implementaci√≥n espec√≠fica del elemento: qu√© identificaci√≥n ordinaria depende de √©l, qu√© clase, etiqueta, diferencial, enlace depende de √©l.  Se volvi√≥ m√°s tranquilo: los selectores se rompen con menos frecuencia, en algunos casos se puede mostrar informaci√≥n adicional con este atributo.  Por ejemplo, necesita el nombre de un paso en una lecci√≥n.  Si recurre al nombre del paso a trav√©s de XPath, el selector puede resultar largo, multinivel y de baja lectura, y si trabaja con la plantilla html en el c√≥digo Angular, puede mostrar el mismo nombre en un atributo comprensible corto, evitando el XPath largo. </p><br></li></ol><br><p>  ¬°Comparte tus trucos y pensamientos en los comentarios! </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/461213/">https://habr.com/ru/post/461213/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../461201/index.html">Temas y estilos en aplicaciones de Android</a></li>
<li><a href="../461205/index.html">Mejores sistemas de gesti√≥n de pruebas 2019</a></li>
<li><a href="../461207/index.html">Sysadmins, hoy es nuestro d√≠a</a></li>
<li><a href="../461209/index.html">Sprint o marat√≥n?</a></li>
<li><a href="../461211/index.html">Donde ense√±an a ense√±ar (no solo en el ped. Institute)</a></li>
<li><a href="../461215/index.html">Neuralink: una plataforma integrada de interfaz cerebro-computadora con miles de canales</a></li>
<li><a href="../461219/index.html">Dell Latitude 7400 2-en-1: una port√°til convertible corporativa hermosa y liviana con una carcasa de metal</a></li>
<li><a href="../461223/index.html">Resumen de IaaS: alto rendimiento, almacenamiento de datos y nuevas tecnolog√≠as para centros de datos</a></li>
<li><a href="../461225/index.html">C√≥mo llegar al Polo Norte desde la base a la deriva de Barneo</a></li>
<li><a href="../461227/index.html">Embarcadero RAD Studio 10.3.2 sali√≥ o lo que est√° muerto ... muri√≥</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>