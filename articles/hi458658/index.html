<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ЁЯТГЁЯП╜ ЁЯРЧ тЩЙя╕П рд╡рд░реНрдЪреБрдЕрд▓ рдорд╢реАрдиреЛрдВ рд╕реЗ рдПрд▓рдПрдХреНрд╕рд╕реА рдХрдВрдЯреЗрдирд░реЛрдВ рдореЗрдВ рд╕реНрд╡рд┐рдЪ рдХрд░рдирд╛: рдХрд╛рд░рдг, рдлрд╛рдпрджреЗ рдФрд░ рддреИрдпрд╛рд░-рд╕реЗ-рдЙрдкрдпреЛрдЧ рдирд┐рд░реНрджреЗрд╢ ЁЯТЖЁЯП┐ ЁЯеж тЩ╛</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="рд╣рдо рдХрд┐рд╕ рдмрд╛рд░реЗ рдореЗрдВ рдмрд╛рдд рдХрд░реЗрдВрдЧреЗ: 

 - рд╣рдордиреЗ LXC рдХрдВрдЯреЗрдирд░реЛрдВ рдореЗрдВ рдЬрд╛рдиреЗ рдХрд╛ рдлреИрд╕рд▓рд╛ рдХреНрдпреЛрдВ рдХрд┐рдпрд╛? 
 - рдПрдХ рдХрдВрдЯреЗрдирд░ рдХреИрд╕реЗ рдмрдирд╛рдПрдВ рдФрд░ рдЙрд╕ рдкрд░ рдмрд┐рдЯреНрд░рд┐рдХреНрд╕-рдЖрдзрд╛рд░рд┐рдд рд╣реЛрд╕реНрдЯ рдХреИрд╕реЗ рдЪрд▓рд╛рдПрдВ? ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>рд╡рд░реНрдЪреБрдЕрд▓ рдорд╢реАрдиреЛрдВ рд╕реЗ рдПрд▓рдПрдХреНрд╕рд╕реА рдХрдВрдЯреЗрдирд░реЛрдВ рдореЗрдВ рд╕реНрд╡рд┐рдЪ рдХрд░рдирд╛: рдХрд╛рд░рдг, рдлрд╛рдпрджреЗ рдФрд░ рддреИрдпрд╛рд░-рд╕реЗ-рдЙрдкрдпреЛрдЧ рдирд┐рд░реНрджреЗрд╢</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/458658/">  <b>рд╣рдо рдХрд┐рд╕ рдмрд╛рд░реЗ рдореЗрдВ рдмрд╛рдд рдХрд░реЗрдВрдЧреЗ:</b> <br><br>  - рд╣рдордиреЗ LXC рдХрдВрдЯреЗрдирд░реЛрдВ рдореЗрдВ рдЬрд╛рдиреЗ рдХрд╛ рдлреИрд╕рд▓рд╛ рдХреНрдпреЛрдВ рдХрд┐рдпрд╛? <br>  - рдПрдХ рдХрдВрдЯреЗрдирд░ рдХреИрд╕реЗ рдмрдирд╛рдПрдВ рдФрд░ рдЙрд╕ рдкрд░ рдмрд┐рдЯреНрд░рд┐рдХреНрд╕-рдЖрдзрд╛рд░рд┐рдд рд╣реЛрд╕реНрдЯ рдХреИрд╕реЗ рдЪрд▓рд╛рдПрдВ? <br><br>  <b>рдЬрд┐рдирдХреЗ рд▓рд┐рдП рдпрд╣ рдЙрдкрдпреЛрдЧреА рд╣реЛрдЧрд╛:</b> <br><br>  рдЙрди рд╕рднреА рдХреЗ рд▓рд┐рдП рдЬреЛ рдХрдо рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП рдПрдХ рдирдП рд╕рдорд╛рдзрд╛рди рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВред <br><a name="habracut"></a><br><h2>  рдЖрднрд╛рд╕реА рдорд╢реАрдиреЛрдВ рдкрд░ рдПрд▓рдПрдХреНрд╕рд╕реА рд▓рд╛рдн </h2><br>  рдЬрдм рд╣рдо рд╕рд░реНрд╡рд░ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреА рдХрдореА рдХрд╛ рд╕рд╛рдордирд╛ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рд╣рдо рдХрдВрдЯреЗрдирд░реЛрдВ рдореЗрдВ рдЪрд▓реЗ рдЬрд╛рддреЗ рд╣реИрдВ, рд╡рд┐рднрд┐рдиреНрди рдкрд░рд┐рдпреЛрдЬрдирд╛рдУрдВ рдХреЗ рд▓рд┐рдП рдПрдХреНрд╕реЗрд╕ рдЕрдзрд┐рдХрд╛рд░реЛрдВ рдХреЛ рдЕрд▓рдЧ рдХрд░рдиреЗ рдХреА рдХрдард┐рдирд╛рдИ, рдФрд░ рдПрдХ рдЖрднрд╛рд╕реА рдорд╢реАрди рдореЗрдВ рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ рд╕рдВрдШрд░реНрд╖ред  рдЖрднрд╛рд╕реА рдорд╢реАрдиреЛрдВ рдкрд░ LXC рдХреЗ рдХреБрдЫ рдкреНрд░рдореБрдЦ рд▓рд╛рдн рдЗрд╕ рдкреНрд░рдХрд╛рд░ рд╣реИрдВ: <br><br><ol><li>  рд╕реАрдкреАрдпреВ рдкреНрд░рджрд░реНрд╢рди, рдбрд┐рд╕реНрдХ рд╕рдВрдЪрд╛рд▓рди рдФрд░ рд░реИрдо рдХрд╛ рдХрдо рдиреБрдХрд╕рд╛рдиред  рдХрдВрдЯреЗрдирд░ рдореЗрдВ рдЙрдкрд▓рдмреНрдз рд▓рдЧрднрдЧ рд╣рд░ рдЪреАрдЬ рд╕рд░реНрд╡рд░ рд╕реНрдкреАрдб рдкрд░ рдХрд╛рдо рдХрд░рддреА рд╣реИред </li><li>  рдУрдПрд╕ рдХрд░реНрдиреЗрд▓, рд╡реАрдбрд┐рдпреЛ рдореЗрдореЛрд░реА, рдбрд┐рд╕реНрдХ рдмрдлрд╝рд░реНрд╕, рдЖрджрд┐ рдХреЗ рд▓рд┐рдП рд░реИрдо рдЖрд╡рдВрдЯрд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИред </li><li>  рдЬрд▓реНрджреА рд╢реБрд░реВ рдХрд░реЛред  рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рдХреЗрд╡рд▓ рдЙрди рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдХреЛ рд▓реЙрдиреНрдЪ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬреЛ рдХрдВрдЯреЗрдирд░ рдХреЗ рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рд╣реИрдВред </li><li>  рдпрд╣ рдкреВрд░реНрдг рдкреНрд░рдгрд╛рд▓реА рдХреЗ рдмрдЬрд╛рдп рдХрдВрдЯреЗрдирд░ рдореЗрдВ рд╡реНрдпрдХреНрддрд┐рдЧрдд рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдХреЛ рд▓реЙрдиреНрдЪ рдХрд░рдиреЗ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИред  рдпрд╣ рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рд╣реИ рдХрд┐ рдПрдХреНрд╕реЗрд╕ рдХреЛ рдХреЗрд╡рд▓ рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ (рдЪреЗрд░реЛрдЯ рдХреЗ рдмрдЬрд╛рдп) рдЬреЛрдбрд╝рдХрд░ рдкреНрд░рджрд╛рди рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдХрдВрдЯреЗрдирд░ рдореЗрдВ рдХреЗрд╡рд▓ рдПрдХ рдкрд░рд┐рдпреЛрдЬрдирд╛ рд╣реИ (рдЖрднрд╛рд╕реА рдорд╢реАрдиреЛрдВ рдкрд░ рдХрдИ рдереЗ)ред </li><li>  рдкреНрд░рддреНрдпреЗрдХ рдХрдВрдЯреЗрдирд░ рдХреЗ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХрд╛ рдкреНрд░рдмрдВрдзрди рдХрд░рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ред </li><li>  рдЬрд▓реНрджреА рдФрд░ рдЖрд╕рд╛рдиреА рд╕реЗ рд╕рд░реНрд╡рд░ рдХреЗ рдмреАрдЪ рдХрдВрдЯреЗрдирд░реЛрдВ рдХреЛ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░реЗрдВред </li></ol><br>  рд╣рдо rsync рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред  рдирдП рд╕рд░реНрд╡рд░ рдкрд░ рд╕рдорд╛рди рдирд╛рдо рд╡рд╛рд▓рд╛ рдПрдХ рдХрдВрдЯреЗрдирд░ рдмрдирд╛рдПрдВ рдФрд░ рдХреЙрдкреА рдХрд░реЗрдВ: <br><br><pre><code class="plaintext hljs">rsync -alvz :/var/lib/lxd/container/test/ /var/lib/lxd/container/test/</code> </pre> <br>  рд╣рдореЗрдВ рдкрд╛рдВрдЪрд╡реЗрдВ рдкреИрд░рд╛рдЧреНрд░рд╛рдл рдкрд░ рд╡рд┐рд╕реНрддрд╛рд░ рд╕реЗ рдмрд╛рдд рдХрд░рдиреЗ рдФрд░ рд╕рдВрд╕рд╛рдзрди рдкреНрд░рдмрдВрдзрди рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдмрд╛рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред  рд╣рдореЗрдВ рдХрдВрдЯреЗрдирд░ рдХреЛ рдХрд╛рдо рдХреЗ рд▓рд┐рдП рдкрд░реНрдпрд╛рдкреНрдд рдорд╛рддреНрд░рд╛ рдореЗрдВ рд╕рдВрд╕рд╛рдзрди рдЙрдкрд▓рдмреНрдз рдХрд░рд╛рдиреЗ рдЪрд╛рд╣рд┐рдП, рдФрд░ рд╕рд╛рде рд╣реА рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП рдХрд┐ рдХрдВрдЯреЗрдирд░ рдЕрдирд╛рд╡рд╢реНрдпрдХ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХрд╛ рдЙрдкрднреЛрдЧ рдирд╣реАрдВ рдХрд░реЗрдЧрд╛, рдЬрд┐рд╕рд╕реЗ рдмрд╛рдХреА рд╕рд┐рд╕реНрдЯрдо рдХреЗ рдХрд╛рдо рдореЗрдВ рдмрд╛рдзрд╛ рдЙрддреНрдкрдиреНрди рд╣реЛред <br><br>  рдЖрдк рдХрдорд╛рдВрдб рджреНрд╡рд╛рд░рд╛ рд╕рдВрд╕рд╛рдзрди рдЦрдкрдд рдХреЗ рдЖрдВрдХрдбрд╝реЗ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ: lxc info test <br><br><pre> <code class="plaintext hljs">Remote: unix:// : x86_64 : 2018/12/04 14:27 UTC Status: Running Type: persistent : default Pid: 28317 IPs: eth0: inet 172.27.2.204 vethF91F2U Resources: : 56 CPU usage:   ( ): 20583 Memory usage: Memory (current): 1.03GB Memory (peak): 3.11GB Network usage: eth0:  : 17.45GB  : 9.93GB</code> </pre><br>  рдЗрди рдЖрдБрдХрдбрд╝реЛрдВ рдХреЗ рдЕрдиреБрд╕рд╛рд░, рдЖрдк рдЯреНрд░реИрдХ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдХрдВрдЯреЗрдирд░ рдХрд┐рддрдиреЗ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХрд╛ рдЙрдкрднреЛрдЧ рдХрд░рддрд╛ рд╣реИ рдФрд░ рдпрджрд┐ рдЖрд╡рд╢реНрдпрдХ рд╣реЛ, рддреЛ рд╡рд┐рд╢реЗрд╖ рдЖрджреЗрд╢реЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЙрдирдХреА рдЦрдкрдд рдХреЛ рд╕реАрдорд┐рдд рдХрд░реЗрдВ: <br><br><ul><li>  lxc config рд╕реЗрдЯ рдкрд░реАрдХреНрд╖рдг рд╕реАрдорд╛ред рд╕реНрдореГрддрд┐ 2048M # рдореЗрдореЛрд░реА рд╕реАрдорд╛ рд╕реЗрдЯ рдХрд░реЗрдВред </li><li>  lxc config рд╕реЗрдЯ рдкрд░реАрдХреНрд╖рдг рд╕реАрдорд╛ред рд╕реАрдкреАрдпреВ 1,2,3,8 # рдХрдВрдЯреЗрдирд░ рдХреЛ рд╕реАрдкреАрдпреВ рдХреЛрд░ рд╕реЗ рдмрд╛рдВрдзреЗрдВред </li><li>  lxc config set test cpu.allowance 10% # рд╕реАрдорд╛ CPU рдЦрдкрддред </li><li>  lxc config рд╕реЗрдЯ рдЯреЗрд╕реНрдЯ рд░реВрдЯ рдЖрдХрд╛рд░ 50GB # рдХрдВрдЯреЗрдирд░ рджреНрд╡рд╛рд░рд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдбрд┐рд╕реНрдХ рд╕реНрдерд╛рди рдХреА рдорд╛рддреНрд░рд╛ рдХреЛ рд╕реАрдорд┐рдд рдХрд░рддрд╛ рд╣реИ (рдХреЗрд╡рд▓ ZFS рдпрд╛ btrfs рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ)ред </li><li>  lxc config рдкрд░реАрдХреНрд╖рдг рдХреА рд╕реАрдорд╛рдПрдБ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВред рд╕реЗрдЯ-рдорд╛рди рджреЗрдЦреЗрдВ </li></ul><br>  рдирддреАрдЬрддрди, рдХрдВрдЯреЗрдирд░ рдЖрдкрдХреЛ рдкрд░реНрдпрд╛рдкреНрдд рдкреНрд░рджрд░реНрд╢рди рдмрдирд╛рдП рд░рдЦрддреЗ рд╣реБрдП, рдмрд╣реБрдд рдорд╛рдирдХ рдбреЗрд╕реНрдХрдЯреЙрдк рдкрд░ рджрд░реНрдЬрдиреЛрдВ рдХрдВрдЯреЗрдирд░реЛрдВ рдХреЛ рд▓реЗрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреЗ рд╣реИрдВред <br><br><h2>  рд╣рдо рд╕рд░реНрд╡рд░ рдХреЛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рддреЗ рд╣реИрдВ рдФрд░ рд╡рд░реНрдЪреБрдЕрд▓ рдорд╢реАрди рд╕реЗ рдХрдВрдЯреЗрдирд░ рдореЗрдВ рдмрд┐рдЯреНрд░рд┐рдХреНрд╕ рдХреЗ рд╕рд╛рде рдорд╛рдирдХ рд╣реЛрд╕реНрдЯ рдХреЛ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░рддреЗ рд╣реИрдВ </h2><br>  <b>1. рд╕рд░реНрд╡рд░ рд╕реЗрдЯрдЕрдк</b> <br><br>  1.1 рд╕рд░реНрд╡рд░ рдкрд░ Ubuntu 18.04 рд╕рд░реНрд╡рд░ рдХрд╛ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рд╕реНрдерд╛рдкрд┐рдд рдХрд░реЗрдВред  рдЗрд╕рдореЗрдВ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА LXD рд╣реИред  LXD, LXC рдХрд╛ рдПрдХ рдРрдб-рдСрди рд╣реИ, рдПрдХ рд╣рд╛рдЗрдкрд░рд╡рд┐рдЬрд░ рд╣реИ рдЬреЛ рдХрдВрдЯреЗрдирд░реАрдХрд░рдг рдкреНрд░рдгрд╛рд▓реА рдХреЗ рд╕рд╛рде рд╕рд╣рднрд╛рдЧрд┐рддрд╛ рдХреЛ рд╕рд░рд▓ рдХрд░рддрд╛ рд╣реИред <br>  1.2 <b>рдЙрдкрдпреБрдХреНрдд рдкреБрд▓-рдмрд░реНрддрди</b> # рдкреБрд▓-рдмрд░реНрддрди рд╕реНрдерд╛рдкрд┐рдд рдХрд░реЗрдВ <br>  1.3 <b>lxd init</b> # lxd рдХреЛ рдЗрдирд┐рд╢рд┐рдпрд▓рд╛рдЗрдЬрд╝ рдХрд░реЗрдВ <br>  1.4 <b>lxc рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ</b> рд╕рдВрдкрд╛рджрд┐рдд рдХрд░реЗрдВ / рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ рдлрд╝рд╛рдЗрд▓ рд╕рдВрдкрд╛рджрд┐рдд рдХрд░реЗрдВ: <br><br><pre> <code class="plaintext hljs">devices: eth0: name: eth0 nictype: bridged parent: br0 type: nic root: path: / pool: default type: disk name: default</code> </pre><br>  <b>1.5 lxc рд▓реЙрдиреНрдЪ ubuntu: 04/18 рдЯреЗрд╕реНрдЯ #</b> рдЯреЗрд╕реНрдЯ рдирд╛рдордХ рдПрдХ рдХрдВрдЯреЗрдирд░ рдмрдирд╛рдПрдВред  рд╡рд╣ рдЫрд╡рд┐ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдЧрд╛, рдЗрд╕реЗ рдмрдирд╛рдПрдЧрд╛ рдФрд░ рд▓реЙрдиреНрдЪ рдХрд░реЗрдЧрд╛ред  рдпрд╣ рдХрдВрдЯреЗрдирд░ рдХреЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдФрд░ рдирд┐рд░реНрдорд╛рдг рдХреЛ рдкреВрд░рд╛ рдХрд░рддрд╛ рд╣реИ, рдлрд┐рд░ рдХрдВрдЯреЗрдирд░ рдХреЛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рдиреЗ рдФрд░ рдЗрд╕реЗ рд╣реЛрд╕реНрдЯ рдХреЛ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдЧреЗ рдмрдврд╝реЗрдВред <br><br>  <b>2. рдореЗрдЬрдмрд╛рди рдХрдВрдЯреЗрдирд░ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдФрд░ рд╕рд╛рдЗрдЯ рдорд╛рдЗрдЧреНрд░реЗрд╢рди</b> <br><br>  2.1 <b>lxc рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдкрд░реАрдХреНрд╖рдг / рдмрд┐рди / рдмреИрд╢ #</b> рдирд┐рд░реНрдорд┐рдд рдХрдВрдЯреЗрдирд░ рдкрд░ рдЬрд╛рдПрдВред <br>  2.2 <b>add-apt-repository ppa: ondrej / php #</b> рдПрдХ рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА рдЬреЛрдбрд╝реЗрдВред <br>  2.3 <b>рдЙрдкрдпреБрдХреНрдд рдЕрджреНрдпрддрди #</b> рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА рдХреЛ рдЕрдкрдбреЗрдЯ рдХрд░реЗрдВред <br>  2.4 <b>рдЙрдкрдпреБрдХреНрдд рд╕реНрдерд╛рдкрд┐рдд</b> <br>  <b>php7.1 {fpm, bcmath, bz2, cli, common, рдХрд░реНрд▓, рджреЗрд╡, рдХрд░рддрдм, fpm, gd, gmp, imap, intl, json,</b> <b><br></b>  <b>ldap, mbstring, mcrypt, mysql, odbc, opcache, phpdbg, pspell, readline, recode, рд╕рд╛рдмреБрди,</b> <b><br></b>  <b>tidy, xml, xmlrpc, xsl, zip} #</b> рд╕реНрдерд╛рдкрд┐рдд рдХрд░реЗрдВ php рдФрд░ рдмрд┐рдЯреНрд░рд┐рдХреНрд╕ рдХреЗ рд▓рд┐рдП рд╕рднреА рдЖрд╡рд╢реНрдпрдХ рдореЙрдбреНрдпреВрд▓ред <br>  2.5 <b>apt install nginx #</b> nginx рдЗрдВрд╕реНрдЯреЙрд▓ рдХрд░реЗрдВред <br>  2.6 <b>vim /etc/netplan/50-cloud-init.yaml #</b> IP рд╕реНрдерд┐рд░ рдХрд░реЗрдВ: <br><br><pre> <code class="plaintext hljs">network: version: 2 ethernets: eth0: addresses: [172.27.2.108/16] gateway4: 172.27.0.1 nameservers: addresses: [172.27.1.1] dhcp4: false</code> </pre> <br>  2.7 рд╣рдорд╛рд░реЗ рд╡рд░реНрдЪреБрдЕрд▓ рдорд╢реАрди рд╕реЗ php рдФрд░ nginx рдХреЛ рдХреЙрдкреА рдХрд░реЗрдВ, рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рд╕рдм рдХреБрдЫ рд╢реБрд░реВ рд╣реЛрддрд╛ рд╣реИ рдФрд░ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИред <br>  2.8 рд╣рдо рдЕрдкрдиреА рдЖрднрд╛рд╕реА рдорд╢реАрди рд╕реЗ рдкреВрд░реА рд╕рд╛рдЗрдЯ рдХреЛ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░рддреЗ рд╣реИрдВред  рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП: <br><br>  <b>rsync -vvz рдкреБрд░рд╛рдирд╛ рд╡рд░реНрдЪреБрдЕрд▓: / var / www / / var / www /</b> <br><br>  <b>3. рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЗ рд▓рд┐рдП рдПрдХ рдЕрд▓рдЧ рдХрдВрдЯреЗрдирд░ рдмрдирд╛рдирд╛</b> <br><br>  3.1 рджреЛрд╣рд░рд╛рдПрдБ рдЪрд░рдг 1 <b>.5, 2.1 рдФрд░ 2.6</b> , рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП рдХрдВрдЯреЗрдирд░ рдХрд╛ рдирд╛рдордХрд░рдг рдкрд░реАрдХреНрд╖рдг-рдбреАрдмреАред <br>  3.2 <b>рдЙрдкрдпреБрдХреНрдд mysql-server #</b> рдбреЗрдЯрд╛рдмреЗрд╕ рд╕реНрдерд╛рдкрд┐рдд рдХрд░реЗрдВ <br>  рдЬрдм рд╣рдо рдбреЗрдЯрд╛рдмреЗрд╕ рдЕрдкрд▓реЛрдб рдХрд░рддреЗ рд╣реИрдВ рддреЛ 3.3 <b>apt рдЗрдВрд╕реНрдЯреЙрд▓ pv #</b> рдЗрдВрд╕реНрдЯреЙрд▓ рдХрд░реЗрдВ рдкреНрд░рдЧрддрд┐ рджреЗрдЦрдиреЗ рдХреЗ рд▓рд┐рдП PV рд╕реНрдерд╛рдкрд┐рдд рдХрд░реЗрдВред <br><br>  <b>4. рдПрдХ рдирдпрд╛ рдбреЗрдЯрд╛рдмреЗрд╕ рд╕рд░реНрд╡рд░ рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдирд╛</b> <br><br>  рдЖрд░рдВрдн рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рдкреБрд░рд╛рдиреЗ рд╕рд░реНрд╡рд░ рд╕реЗ рдЬрд╛рдирдХрд╛рд░реА рдПрдХрддреНрд░ рдХрд░рддреЗ рд╣реИрдВ: <br><br>  4.1 рд╣рдореЗрдВ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЪрд╛рд╣рд┐рдП рдФрд░ рд╡рд╛рдВрдЫрд┐рдд рдбреЗрдЯрд╛рдмреЗрд╕ рд╕реЗ рдкрд╛рд╕ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред <br>  4.2 <b>mysql -u test -p'test '-e "show рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдбреЗрдЯрд╛рдмреЗрд╕ testDB;"</b>  <b>#</b> рдкрддрд╛ рд▓рдЧрд╛рдПрдБ рдХрд┐ рдбреЗрдЯрд╛рдмреЗрд╕ рдХреИрд╕реЗ рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рдерд╛ (рд╣рдореЗрдВ рдХреНрдпрд╛ рд╣рд╛рдЗрд▓рд╛рдЗрдЯ рдЪрд╛рд╣рд┐рдП): <br><br><pre> <code class="plaintext hljs">mysql: [Warning] Using a password on the command line interface can be insecure. +----------+--------------------------------------------------------------------------+ | Database | Create Database | +----------+--------------------------------------------------------------------------+ | demoshop | &lt;b&gt;CREATE DATABASE `demoshop` /*!40100 DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci */ |&lt;/b&gt; +----------+--------------------------------------------------------------------------+</code> </pre> <br>  4.3 <b>mysqldump -ER --single-transaction --quick testDB |</b>  <b>gzip&gt; testDB.sql.gz #</b> рдпрд╣ рдХрдорд╛рдВрдб рдЙрд╕ рд╕рд░реНрд╡рд░ рдкрд░ рдЪрд▓рд╛рдПрдВ рдЬрд╣рд╛рдВ рд╣рдорд╛рд░рд╛ рдбреЗрдЯрд╛рдмреЗрд╕ рд╕реНрдерд┐рдд рд╣реИред  рд╡рд╣ рдЗрд╕реЗ рд╕рдВрдЧреНрд░рд╣ рдореЗрдВ рдбреБрдмреЛрдПрдЧреА рдФрд░ рд╕рдВрдкреАрдбрд╝рд┐рдд рдХрд░реЗрдЧреАред <br><br>  рд╣рдо рдЕрдкрдиреЗ рдирдП рдбреЗрдЯрд╛рдмреЗрд╕ рдореЗрдВ рдЬрд╛рдПрдВрдЧреЗ рдФрд░ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреНрд░рд┐рдпрд╛рдПрдВ рдХрд░реЗрдВрдЧреЗ: <br><br>  4.4 <b>rsync -vvz рдкреБрд░рд╛рдирд╛ DB: / root / testDB.sql.gz / root / #</b> рд╕рдВрдЧреНрд░рд╣ рдХреЛ рд╣рдорд╛рд░реЗ рдХрдВрдЯреЗрдирд░ рдореЗрдВ рдбрдВрдк рдХреЗ рд╕рд╛рде рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░реЗрдВред <br>  4.5 <b>mysql #</b> рдЪрд▓реЛ рд╣рдорд╛рд░реЗ рдбреЗрдЯрд╛рдмреЗрд╕ рдкрд░ рдЬрд╛рдПрдВ <br>  4.5.1 <b>USER 'рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛' @ '%' рдЖрдИрдбреА 'рдкрд╛рд╕' рджреНрд╡рд╛рд░рд╛ рдмрдирд╛рдП рдЧрдП;</b>  <b>#</b> рдПрдХ рд╣реА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдФрд░ рдкрд╛рд╕рд╡рд░реНрдб рдмрдирд╛рдПрдБред <br>  4.5.2 рдЕрдиреБрдЪреНрдЫреЗрдж 4.2 рд╕реЗ, рд╣рдо рдХрдорд╛рдВрдб рджрд░реНрдЬ рдХрд░рддреЗ рд╣реИрдВ: <b>DATABASE `DBName` / * рдмрдирд╛рдПрдБ</b> ; <b>40100 DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci * /</b> ; <br>  4.5.3 <b>DB рдирд╛рдо рдкрд░ рд╕рднреА</b> рд╕рд┐рджреНрдзрд╛рдВрддреЛрдВ рдХреЛ <b>рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВред * 'рдкрд╛рд╕' рджреНрд╡рд╛рд░рд╛ 'рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛' @ '%' IDENTIFIED рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП;</b>  <b>#</b> рд╣рдо рдЕрдкрдиреЗ рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЛ рдЕрдзрд┐рдХрд╛рд░ рджреЗрдВрдЧреЗред <br>  4.6 рд╣рдо рдбреЗрдЯрд╛рдмреЗрд╕ рд╕реЗ рдмрд╛рд╣рд░ рдирд┐рдХрд▓рддреЗ рд╣реИрдВ рдФрд░ рдХрдВрдЯреЗрдирд░ рдХрдВрд╕реЛрд▓ рдЪрд▓рд╛рддреЗ рд╣реИрдВ: <b>pv testDB.sql.gz | zcat |</b>  <b>mysql testDB #</b> рд╣рдорд╛рд░реЗ рдбреЗрдЯрд╛рдмреЗрд╕ рдореЗрдВ рдбрдВрдк <b>рднрд░реЗрдВ</b> <br><br>  <b>5. рд╕рддреНрдпрд╛рдкрди</b> <br><br>  5.1 рдбреЗрдЯрд╛рдмреЗрд╕ рд╕реЗ рдХрдиреЗрдХреНрдЯ рдХрд░рдиреЗ рдХреЗ рдорд╛рдкрджрдВрдбреЛрдВ рдХреЛ рдмрджрд▓реЗрдВ, рд╣рдорд╛рд░реЗ рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЗ рдирдП рдЖрдИрдкреА рдХреЛ рдЗрдВрдЧрд┐рдд рдХрд░реЗрдВред <br>  5.2 рдЙрд╕рдХреЗ рдмрд╛рдж, рд╕рд╛рдЗрдЯ рдХреЛ рдЖрдИрдкреА рдпрд╛ рдбреАрдПрдирдПрд╕ рдкрд░ рдЦреБрд▓ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП, рдпрд╣ рдЖрдкрдХреЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддрд╛ рд╣реИред <br><br><h2>  рдирд┐рд╖реНрдХрд░реНрд╖ </h2><br>  рдЗрд╕ рдкреНрд░рдХрд╛рд░, LXC рдХрдВрдЯреЗрдирд░ рд╣рдореЗрдВ рдЯреЗрд╕реНрдЯ рд╕рд░реНрд╡рд░ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреА рдЦрдкрдд рдХреЛ рдХрдо рдХрд░рдиреЗ рдФрд░ рдПрдХ рд╕рд░реНрд╡рд░ рдкрд░ рдЕрдзрд┐рдХ рдореЗрдЬрдмрд╛рди рдлрд┐рдЯ рдХрд░рдиреЗ рдореЗрдВ рдорджрдж рдХрд░рддреЗ рд╣реИрдВ, рдЬрдмрдХрд┐ рдкреНрд░рддреНрдпреЗрдХ рдореЗрдЬрдмрд╛рди рдХреЗ рдЙрдкрднреЛрдЧ рдХрд┐рдП рдЧрдП рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЛ рдЖрд╕рд╛рдиреА рд╕реЗ рдкреНрд░рдмрдВрдзрд┐рдд рдХрд░рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рдмрдирд╛рдП рд░рдЦрддреЗ рд╣реИрдВред  рдЕрдм рдЖрдкрдХреЗ рдкрд╛рд╕ рддреИрдпрд╛рд░ рдХрд┐рдП рдЧрдП рдирд┐рд░реНрджреЗрд╢ рд╣реИрдВ рдЬреЛ рдпрд╣ рджрд┐рдЦрд╛рддреЗ рд╣реИрдВ рдХрд┐ рдЗрд╕реЗ рд▓рд╛рдЧреВ рдХрд░рдирд╛ рдХрд┐рддрдирд╛ рдЖрд╕рд╛рди рд╣реИред </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/hi458658/">https://habr.com/ru/post/hi458658/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi458646/index.html">рдкрд░рдорд╛рдгреБ рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ</a></li>
<li><a href="../hi458648/index.html">AWS рдФрд░ рдмрд╛рдВрд╕ рдХреЗ рд╕рд╛рде CI / CD</a></li>
<li><a href="../hi458650/index.html">рд╕рд╛рдЗрдмрд░ рдЪреИрд▓реЗрдВрдЬред рдПрдХ рдирдпрд╛ рд╕реНрддрд░ред рд░реЛрд╕реНрдЯреЗрд▓рдХреЙрдо рд╕реЛрд▓рд░ рд╕реЗ рдСрдирд▓рд╛рдЗрди рдкреНрд░рддрд┐рдпреЛрдЧрд┐рддрд╛</a></li>
<li><a href="../hi458652/index.html">рд░рдореНрдмрд▓рд░рдлреНрд░рдВрдЯ рдФрд░ рдореАрдЯрдЕрдк # 7</a></li>
<li><a href="../hi458654/index.html">Lurk рд╡рд╛рдпрд░рд╕ рдиреЗ рдмреИрдВрдХреЛрдВ рдХреЛ рд╣реИрдХ рдХрд░ рд▓рд┐рдпрд╛, рдЬрдмрдХрд┐ рдпрд╣ рд╕рд╛рдзрд╛рд░рдг рдХрд┐рд░рд╛рдП рдкрд░ рдХрд╛рдо рдХрд░рдиреЗ рд╡рд╛рд▓реЛрдВ рджреНрд╡рд╛рд░рд╛ рд▓рд┐рдЦрд╛ рдЧрдпрд╛ рдерд╛</a></li>
<li><a href="../hi458660/index.html">рдЕрд╕рдлрд▓ рд╕реЙрдлреНрдЯрд╡реЗрдпрд░ рдкрд░рд┐рдирд┐рдпреЛрдЬрди рдХреНрд░реИрд╢ рдХреНрд▓рд╛рдЙрдбрдлрд╝реЗрдпрд░ рд╕реЗрд╡рд╛</a></li>
<li><a href="../hi458662/index.html">рдИрдПрдордЖрдИ рдиреЗ рд╡рд┐рдорд╛рди рдбреНрд░реЛрди рдкрд░реАрдХреНрд╖рдг рд╢реБрд░реВ рдХрд░рдиреЗ рдХреА рдпреЛрдЬрдирд╛ рдмрдирд╛рдИ рд╣реИ</a></li>
<li><a href="../hi458666/index.html">рдореВрд░реНрдЦ рджрд┐рдорд╛рдЧ, рдЫрд┐рдкреА рднрд╛рд╡рдирд╛рдПрдВ, рдХрдкрдЯреА рдПрд▓реНрдЧреЛрд░рд┐рджрдо: рдЪреЗрд╣рд░реЗ рдХреА рдкрд╣рдЪрд╛рди рдХрд╛ рд╡рд┐рдХрд╛рд╕</a></li>
<li><a href="../hi458670/index.html">рдкреНрд░реЛрд╕реЗрд╕рд░ рдХреИрд╕реЗ рдбрд┐рдЬрд╝рд╛рдЗрди рдФрд░ рдирд┐рд░реНрдорд┐рдд рд╣реЛрддреЗ рд╣реИрдВ: рдХрдВрдкреНрдпреВрдЯрд░ рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░ рдХрд╛ рднрд╡рд┐рд╖реНрдп</a></li>
<li><a href="../hi458672/index.html">рдиреМрдХрд░реА рдмрджрд▓рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдЖрдИрдЯреА рдХрдВрдкрдирд┐рдпреЛрдВ рд╕реЗ рдкреВрдЫреЗрдВ 20 рд╕рд╡рд╛рд▓</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>