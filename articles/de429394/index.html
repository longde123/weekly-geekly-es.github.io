<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🍦 ♾ 👩🏼‍🏭 MIT-Kurs "Computer Systems Security". Vorlesung 16: „Seitenkanalangriffe“, Teil 3 🤠 🌄 🤘🏽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Massachusetts Institute of Technology. Vorlesung # 6.858. "Sicherheit von Computersystemen." Nikolai Zeldovich, James Mickens. 2014 Jahr 
 Computer Sy...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>MIT-Kurs "Computer Systems Security". Vorlesung 16: „Seitenkanalangriffe“, Teil 3</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ua-hosting/blog/429394/"><h3>  Massachusetts Institute of Technology.  Vorlesung # 6.858.  "Sicherheit von Computersystemen."  Nikolai Zeldovich, James Mickens.  2014 Jahr </h3><br>  Computer Systems Security ist ein Kurs zur Entwicklung und Implementierung sicherer Computersysteme.  Die Vorträge behandeln Bedrohungsmodelle, Angriffe, die die Sicherheit gefährden, und Sicherheitstechniken, die auf jüngsten wissenschaftlichen Arbeiten basieren.  Zu den Themen gehören Betriebssystemsicherheit, Funktionen, Informationsflussmanagement, Sprachsicherheit, Netzwerkprotokolle, Hardwaresicherheit und Sicherheit von Webanwendungen. <br><br>  Vorlesung 1: „Einführung: Bedrohungsmodelle“ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 3</a> <br>  Vorlesung 2: „Kontrolle von Hackerangriffen“ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 3</a> <br>  Vorlesung 3: „Pufferüberläufe: Exploits und Schutz“ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 3</a> <br>  Vorlesung 4: „Trennung von Privilegien“ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 3</a> <br>  Vorlesung 5: „Woher kommen Sicherheitssysteme?“ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 2</a> <br>  Vorlesung 6: „Chancen“ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 3</a> <br>  Vorlesung 7: „Native Client Sandbox“ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 3</a> <br>  Vorlesung 8: „Netzwerksicherheitsmodell“ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 3</a> <br>  Vorlesung 9: „Sicherheit von Webanwendungen“ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 3</a> <br>  Vorlesung 10: „Symbolische Ausführung“ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 3</a> <br>  Vorlesung 11: „Ur / Web-Programmiersprache“ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 3</a> <br>  Vorlesung 12: Netzwerksicherheit <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 3</a> <br>  Vorlesung 13: „Netzwerkprotokolle“ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 3</a> <br>  Vorlesung 14: „SSL und HTTPS“ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 3</a> <br>  Vorlesung 15: „Medizinische Software“ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 3</a> <br>  Vorlesung 16: „Seitenkanalangriffe“ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 3</a> <a name="habracut"></a><br><br>  <b>Teilnehmerin:</b> Verwenden Sie die Karatsuba-Methode? <br><br>  <b>Professor:</b> Ja, dies ist eine intelligente Multiplikationsmethode, für die keine vier Berechnungsstufen erforderlich sind.  Die Karatsuba-Methode wird im .601-Kurs unterrichtet, oder wie wird sie heute bezeichnet? <br><br>  <b>Teilnehmerin:</b> 042. <br><br>  <b>Professor:</b> 042, ausgezeichnet.  Ja, das ist eine sehr gute Methode.  Fast jede kryptografische Bibliothek verwendet es.  Für diejenigen unter Ihnen, die keine Absolventen unseres Instituts sind - ich sage dies, weil wir hier Doktoranden haben - werde ich an die Tafel über die Karatsuba-Methode schreiben.  Hier müssen Sie drei Werte berechnen: <br><br>  a <sub>1</sub> b <sub>1</sub> <br>  (a <sub>1</sub> - a <sub>0</sub> ) (b <sub>1</sub> - b <sub>0</sub> ) <br>  a <sub>0</sub> b <sub>0</sub> <br><br>  Sie führen also drei statt vier Multiplikationen durch, und es stellt sich heraus, dass Sie diesen Wert a <sub>1</sub> b <sub>0</sub> + a <sub>0</sub> b <sub>1</sub> aus diesen drei Multiplikationsergebnissen wiederherstellen können. <br><br><img src="https://habrastorage.org/webt/sg/_m/od/sg_modaezv2yehkmftzlhpybti0.jpeg"><br><br>  Der besondere Weg, dies zu tun, ist dies ... lassen Sie es mich in eine andere Form bringen. <br><br>  Also werden wir haben: <br><br>  (2 <sup>64</sup> + 2 <sup>32</sup> ) (a <sub>1</sub> b <sub>1</sub> ) + <br>  (2 <sup>32</sup> ) (- (a <sub>1</sub> - a <sub>0</sub> ) (b <sub>1</sub> - b <sub>0</sub> ) <br>  (2 <sup>32</sup> + 1) (a <sub>0</sub> b <sub>0</sub> ) <br><br>  Dies ist nicht sehr klar, aber wenn Sie die Details herausarbeiten, dann überzeugen Sie sich letztendlich davon, dass dieser Wert in diesen 3 Zeilen äquivalent zu ab ist, reduziert aber gleichzeitig die Berechnung um eine Multiplikation.  Und die Art und Weise, wie wir dies auf voluminösere Multiplikationen anwenden, ist, dass Sie rekursiv weiter nach unten gehen.  Wenn Sie also 512-Bit-Werte haben, können Sie diese in 256-Bit-Multiplikation aufteilen.  Sie führen drei 256-Bit-Multiplikationen durch, jedes Mal rekursiv mit der Karatsuba-Methode.  Am Ende kommen Ihre Berechnungen auf die Maschinengröße und können von einer einzelnen Maschinenanweisung verarbeitet werden. <br><br><img src="https://habrastorage.org/webt/gv/7s/ae/gv7saezq-q5xj52fvxnjxenikgo.jpeg"><br><br>  Wo ist also der Timing-Angriff?  Wie verwenden diese Leute die Karatsuba-Multiplikation?  Es stellt sich heraus, dass OpenSSL sich Sorgen über zwei Arten der Multiplikation macht, die Sie möglicherweise durchführen müssen. <br>  Die erste ist die Multiplikation von zwei großen Zahlen von ungefähr derselben Größe.  Dies passiert oft, wenn wir eine modulare Exponentiation durchführen, da alle Werte, die wir multiplizieren, eine Größe von ungefähr 512 Bit haben.  Wenn wir also c mit y oder Quadrat multiplizieren, multiplizieren wir zwei Dinge von ungefähr derselben Größe.  In diesem Fall ist die Karatsuba-Methode sehr sinnvoll, da sie die Größe der quadratischen Zahlen um das 1,58-fache reduziert, was den Berechnungsprozess erheblich beschleunigt. <br>  Die zweite Art der Multiplikation ist, wenn OpenSSL zwei Zahlen multipliziert, deren Größe sich erheblich voneinander unterscheidet: eine ist sehr groß und die andere ist sehr klein.  In diesem Fall können Sie auch die Karatsuba-Methode verwenden, diese funktioniert jedoch langsamer als die primitive Multiplikation.  Angenommen, Sie multiplizieren eine 512-Bit-Zahl mit einer 64-Bit-Zahl. Sie müssen jedes Bit der ersten Zahl auf eine Potenz von 64 erhöhen, was zu einer Verlangsamung des Prozesses um 2n anstelle einer Beschleunigung von n / 1,58 führt.  Daher haben diese Leute, die OpenSSL verwenden, versucht, klüger zu werden, und hier begannen die Probleme. <br><br>  Sie beschlossen, dynamisch zwischen der effektiven Karatsuba-Methode und der Multiplikationsmethode der Grundschule zu wechseln.  Ihre Heuristik war wie folgt.  Wenn die beiden Zahlen, die Sie multiplizieren, aus der gleichen Anzahl von Maschinenwörtern bestehen oder mindestens die gleiche Anzahl von Bits wie 32-Bit-Einheiten haben, wird die Karatsuba-Methode verwendet.  Wenn sich zwei Zahlen in ihrer Größe stark voneinander unterscheiden, wird eine normale Multiplikation durchgeführt. <br><br>  In diesem Fall können Sie verfolgen, wie der Wechsel zu einer anderen Multiplikationsmethode erfolgt.  Da der Moment des Umschaltens nicht spurlos vergeht, wird sich danach bemerkbar machen, ob er jetzt viel mehr Zeit für die Multiplikation benötigt oder viel weniger als zuvor.  Die Forscher nutzten diesen Umstand, um einen Angriff mithilfe der Timing-Methode zu organisieren. <br><br>  Ich glaube, ich habe Ihnen alle seltsamen Tricks erzählt, die die Leute bei der Implementierung von RSA in der Praxis anwenden.  Versuchen wir nun, sie zusammenzusetzen und in Bezug auf den gesamten Webserver zu verwenden, um herauszufinden, wie Sie die für uns interessanten Teile aus dem Eingangsnetzwerkpaket "abklemmen" können. <br><br>  Wenn Sie sich an die Vorlesung über HTTPS erinnern, verfügt der Webserver über einen geheimen Schlüssel.  Er verwendet diesen geheimen Schlüssel, um zu beweisen, dass er der richtige Eigentümer aller Zertifikate über HTTPS oder TLS ist.  Dies liegt an der Tatsache, dass Clients einige zufällig ausgewählte Bits senden, diese Bits mit dem öffentlichen Schlüssel des Servers verschlüsselt werden und der Server diese Nachricht mithilfe des TLS-Protokolls entschlüsselt.  Und wenn die Nachricht überprüft wird, werden diese zufälligen Bits verwendet, um eine Kommunikationssitzung einzurichten. <br><br>  In unserem Fall wird diese Nachricht jedoch nicht überprüft, da sie auf besondere Weise erstellt wird. Wenn sich herausstellt, dass die zusätzlichen Bits nicht übereinstimmen, gibt der Server einen Fehler zurück, sobald die Entschlüsselung unserer Nachricht abgeschlossen ist. <br><br>  Folgendes werden wir hier tun.  Der Server - Sie können davon ausgehen, dass es sich um Apache mit offenem SSL handelt - erhält vom Client eine Nachricht, die er als verschlüsselten Text mit oder als hypothetischen verschlüsselten Text betrachtet, den der Client erstellt hat.  Das erste, was wir mit dem Chiffretext c machen, ist, ihn mit der Formel mit → (c <sup>d</sup> mod n) = m zu entschlüsseln. <br><br>  Wenn Sie sich an die erste Optimierung erinnern, wenden wir den chinesischen Restsatz an und teilen unseren Text in zwei Teile: einen, der nach mod p berechnet wird, den anderen nach mod q, und kombinieren dann die Ergebnisse.  Nehmen Sie zuerst c und stellen Sie es in zwei Größen dar: Die erste heißt c <sub>0</sub> , ist gleich mod q und die zweite ist c <sub>1</sub> und ist gleich c mod p.  Dann werden wir dasselbe tun, um c für d mod p und c für d mod q zu berechnen. <br><br><img src="https://habrastorage.org/webt/re/sp/qo/respqor_rehsunlfqjtc9lbmeok.jpeg"><br><br>  Als nächstes wechseln wir zur Montgomery-Ansicht, da dies unsere Multiplikationen sehr schnell macht.  Das nächste, was SSL mit Ihrer Nummer machen wird, ist, c <sub>0</sub> 'zu berechnen, was gleich c <sub>0</sub> R mod q ist, und hier unten dasselbe für c1 zu tun. Ich werde es nicht aufschreiben, weil es gleich aussieht . <br><br>  Nachdem wir zur Montgomery-Form gewechselt sind, können wir endlich unsere Multiplikationen durchführen, und hier werden wir die "Schiebefenster" -Technik verwenden.  Sobald wir c <sub>0</sub> 'erhalten, machen wir diese einfache Erhöhung von c <sub>0</sub> ' auf die Potenz von d in mod q.  Und hier, da wir diesen Wert für d berechnen, werden wir "Schiebefenster" für Bits des Exponenten d verwenden, und wir werden auch die Karatsuba-Methode oder die übliche Multiplikation verwenden, abhängig von der Größe unserer Operanden. <br><br><img src="https://habrastorage.org/webt/ah/oa/um/ahoaumcorgtkbkeuj6uxli1yv9i.jpeg"><br><br>  Wenn sich also herausstellt, dass dieser Wert c <sub>0</sub> 'und das zuvor erhaltene Quadrierungsergebnis dieselbe Größe haben, verwenden wir die Karatsuba-Methode.  Wenn c <sub>0</sub> 'sehr klein ist und das vorherige Ergebnis der Multiplikation groß ist, werden wir auf die übliche Weise quadrieren und multiplizieren.  Hier verwenden wir "Schiebefenster" und die Karatsuba-Methode anstelle der normalen Multiplikation. <br><br><img src="https://habrastorage.org/webt/pk/xc/wl/pkxcwlnkl3fndnsc-nx3rqk1auo.jpeg"><br><br>  Auch in dieser Phase treten zusätzliche Reduzierungen auf.  Weil mit jeder Multiplikation zusätzliche Reduktionen proportional zu dem sind, was wir zur Potenz von mod q erhöhen, dh zum Wert von (c <sub>0</sub> ') <sup>d</sup> .  Hier ist bei einer einfachen Verbindung der Formel die Wahrscheinlichkeit zusätzlicher Reduktionen proportional zum Wert c <sub>0</sub> 'mod q geteilt durch 2R.  An dieser Stelle erscheint ein Bit, das das Timing beeinflusst. <br><br>  Tatsächlich gibt es zwei mögliche Effekte: Verwenden der Karatsuba-Methode anstelle der normalen Multiplikation und das Auftreten zusätzlicher Abkürzungen, die Sie ausführen werden. <br><br>  In einer Sekunde werden Sie sehen, wie es verwendet werden kann.  Wenn Sie nun dieses Ergebnis für mod q erhalten und ein ähnliches Ergebnis für mod p erhalten, können Sie diese beiden Teile oben und unten endlich neu kombinieren und CRT, den chinesischen Restsatz, verwenden. <br><br>  Und was Sie als Ergebnis von CRT erhalten ... Entschuldigung, ich denke, wir müssen dies zuerst aus dem Montgomery-Formular zurückkonvertieren.  Daher konvertieren wir vor der Rekombination den oberen Teil in den Ausdruck (c <sub>0</sub> ') <sup>d</sup> / R mod q und geben unseren Wert cd mod q zurück.  Im unteren Teil erhalten wir dementsprechend cd mod p. <br><br>  Jetzt können Sie CRT verwenden, um den Wert von c <sup>d</sup> mod n zu erhalten.  Entschuldigung für die kleine Schrift, ich hatte nicht genug Tafel.  Ungefähr das Gleiche bekommen wir hier unten mit <sub>1</sub> , und wir können endlich unser Ergebnis erhalten, das heißt, Nachricht m. <br><br><img src="https://habrastorage.org/webt/vw/md/4x/vwmd4xcq0kjbfpsvw29dyqtglnk.jpeg"><br><br>  Somit nimmt der Server ein eingehendes Paket, das er empfängt, führt es durch diese gesamte Pipeline, führt zwei Teile dieser Pipeline aus und endet mit einer entschlüsselten Nachricht m gleich cd mod m.  Dann wird er die Polsterung dieses Beitrags überprüfen.  Im Falle unseres spezifischen Angriffs haben wir so erstellt, dass dieser Zusatz tatsächlich nicht übereinstimmt.  Wir haben den Wert c für Heuristiken gewählt, die die reale Nachricht nicht mit dem richtigen Auffüllzusatz verschlüsseln. <br><br>  Daher besteht das Add-On den Test nicht. Der Server muss einen Fehler aufzeichnen, eine Fehlermeldung an den Client senden und die Verbindung trennen.  Wir werden also die Zeit messen, die der Server benötigt, um unsere Nachricht durch diese Pipeline zu leiten.  Haben Sie Fragen zum Prozess der Verarbeitung einer Nachricht durch den Server und zur Kombination all dieser Optimierungen? <br><br>  <b>Teilnehmerin:</b> Meiner Meinung nach liegt ein Fehler mit einem Index der Größenordnung c vor. <br><br>  <b>Professor:</b> Ja, Sie haben Recht, ich füge den Index 0 hinzu, hier sollte c <sub>0</sub> <sup>d</sup> mod q sein. <br><br><img src="https://habrastorage.org/webt/zf/c8/eb/zfc8ebgspz9g347khmvzs1n-9hc.jpeg"><br><br>  <b>Teilnehmerin:</b> Wenn Sie durch R mod q dividieren, gibt es keine Annahmen darüber, wie viel q Sie hinzufügen sollten, um die niedrigen Bits weiter auf Nullen zu reduzieren? <br><br>  <b>Professor:</b> Ja, Sie haben Recht, in dieser letzten Phase (c <sub>0</sub> ') <sup>d</sup> / R mod q kann es zu zusätzlichen Reduzierungen kommen.  Wir sollten also diese Division durch R auf die richtige Weise durchführen und wahrscheinlich dasselbe tun wie die Montgomery-Reduktion hier, wenn wir durch R dividieren, um den Wert zurück umzuwandeln.  Da zu Beginn der Berechnungen nicht klar ist, wie viel q wir hinzufügen sollen, verwenden wir die Auswahlmethode, zerstören die niedrigen Nullen, machen dann erneut mod q und möglicherweise eine zusätzliche Reduktion.  Sie sind absolut richtig, in diesem Fall ist es genau die gleiche Division durch R mod q wie für jeden Schritt der Montgomery-Multiplikation. <br><br>  Wie nutzen Sie dies?  Wie kann ein Angreifer den geheimen Schlüssel eines Servers lösen, indem er die Zeit misst, die zum Abschließen von Vorgängen benötigt wird?  Diese Leute haben einen Plan, der darauf basiert, jeweils einen privaten Schlüssel zu erraten.  Wir können davon ausgehen, dass der geheime Schlüssel der verschlüsselte Exponent d ist, da Sie e und n kennen, ist dies der öffentliche Schlüssel.  Das einzige, was Sie nicht wissen, ist d. <br><br><img src="https://habrastorage.org/webt/qw/pv/cg/qwpvcgujkfsub1kworr1vy2bmea.jpeg"><br><br>  Tatsächlich erraten sie bei diesem Angriff den Wert von d nicht direkt, da er ziemlich kompliziert ist.  Stattdessen betrachten sie q oder p, egal welche dieser beiden Größen.  Sobald Sie erraten haben, worauf es bei p oder q ankommt, können Sie n = pq berechnen.  Wenn Sie dann die Werte von p und q kennen, können Sie die Funktion φ berechnen, über die wir zuvor gesprochen haben.  Auf diese Weise können Sie den Wert von d aus dem Wert von e erhalten.  Daher ist diese Faktorisierung des Werts von n äußerst wichtig und muss geheim gehalten werden, um die RSA-Sicherheit zu gewährleisten. <br><br>  Tatsächlich wollten diese Leute den q-Wert erraten, indem sie die Zeitabläufe dieser Pipeline analysierten.  Was machen sie dafür?  Sie wählen sorgfältig den Anfangswert des Werts von c aus und messen die Zeit seines Durchlaufs durch die Server-Pipeline. <br><br>  Insbesondere besteht dieser Angriff aus zwei Teilen, und Sie müssen einige erste Schritte unternehmen, um die ersten paar Bits zu erraten.  Sobald Sie die ersten Bits haben, können Sie das nächste Bit erraten.  Lassen Sie mich daher nicht im Detail sagen, wie sie die ersten paar Bits erraten, da es in der Tat viel interessanter ist, zu überlegen, wie sie das nächste Bit erraten.  Wenn wir Zeit haben, werden wir darauf zurückkommen, wie das Erraten mehrerer Anfangsbits in einem Vorlesungsartikel beschrieben wird. <br><br>  Angenommen, Sie haben die Annahme g darüber, welche Bits im Wert dieses q enthalten sind.  Dieser Wert bestehe aus solchen Bits: g = g <sub>0</sub> g <sub>1</sub> g <sub>2</sub> ... und so weiter.  Vielmehr ist es nicht einmal g, sondern die realen Teile von q. Lassen Sie es mich also so umschreiben: g = q <sub>0</sub> q <sub>1</sub> q <sub>2</sub> ....  Wir glauben, dass diese q hohe Bits sind, und wir versuchen, die Bits immer niedriger zu erraten.  Angenommen, wir kennen den Wert von q bis zum Bit qj, und dann folgen alle Nullen.  Sie haben keine Ahnung, was der Rest der Bits ist. <br><br><img src="https://habrastorage.org/webt/8c/ca/df/8ccadfhe0orkn4jalptuhmm_c9a.jpeg"><br><br>  Diese Leute haben versucht, diese Vermutung g in diesen Ort unserer Pipeline zu injizieren: (c0 ') d mod q.  Denn hier werden zwei Arten der Optimierung verwendet: die Karatsub-Methode anstelle der üblichen Multiplikation und eine unterschiedliche Anzahl zusätzlicher Abkürzungen in Abhängigkeit vom Wert von c <sub>0</sub> '.  Tatsächlich versuchten sie, zwei verschiedene Vermutungen an dieser Stelle der Pipeline einzuführen: die erste, die wie g = q <sub>0</sub> q <sub>1</sub> q <sub>2</sub> ... qj 000 ... 0000 aussieht, und die zweite, die sie g <sub>high</sub> nannten, die aus denselben hohen Bits besteht, aber stattdessen Von allen Nullen am Ende gibt es eine Einheit, die ein hohes Bit bezeichnet, gefolgt von erneut Nullen: <br><br>  g = q <sub>0</sub> q <sub>1</sub> q <sub>2</sub> ... qj 100 ... 0000. <br><br>  Wie hilft das diesen Leuten zu verstehen, was passiert?  Es gibt zwei Möglichkeiten, dies zu tun.  Angenommen, unsere Vermutung g ist gleich dem Wert c <sub>0</sub> '.  Wir können annehmen, dass diese g und g <sub>hoch</sub> dem auf der linken Tafel angegebenen Wert c <sub>0</sub> 'entsprechen.  Tatsächlich ist dies recht einfach, da c <sub>0</sub> 'aus dem verschlüsselten Eingabewert c <sub>0</sub> ziemlich einfach rückwärts zu berechnen ist. Sie multiplizieren es einfach mit R. <br><br><img src="https://habrastorage.org/webt/u9/5k/yp/u95kypmv569-dhhozaeqfpcwgjo.jpeg"><br><br>  Um den Wert (c <sub>0</sub> ') <sup>d</sup> zu erraten, müssen sie nur ihre Vermutung, ihre Vermutung g, nehmen und sie zuerst durch R teilen, dh durch 512 mod etwas dort teilen.  Dann werden sie es wieder einführen, der Server wird es mit R multiplizieren und den in unserem Pipeline-Schema beschriebenen Prozess fortsetzen. <br><br>  Angenommen, wir konnten unseren bestimmten ausgewählten ganzzahligen Wert an der richtigen Stelle platzieren.  Was ist also die Rechenzeit c <sub>0</sub> 'bis d mod q? <br><br><img src="https://habrastorage.org/webt/zy/b5/ud/zyb5udmf96e2cvwliab80lhusum.jpeg"><br><br>  Es gibt zwei mögliche Optionen, bei denen q in dieses Bild passt.  Es kann sein, dass q zwischen diesen beiden Werten von g und g <sub>hoch liegt</sub> , weil das nächste Bit von q 0 ist. Somit ist dieser Wert - die erste 0 nach qj - kleiner als q, aber dieser Wert - 1 nach q - ist größer als q.  Dies geschieht, wenn das nächste Bit von q 0 ist, oder es ist möglich, dass q über diesen beiden Werten liegt, wenn das nächste Bit von q 1 ist. <br><br><img src="https://habrastorage.org/webt/g5/uk/mn/g5ukmnfmvzp_rdlyhwtptj-8e4o.jpeg"><br><br>  Nun können wir sagen, wie die Entschlüsselungszeit dieser beiden Werte sein wird, wenn q zwischen ihnen liegt oder wenn q über beiden liegt. <br><br>  Schauen wir uns die Situation an, in der sich q oben befindet.  In diesem Fall ist alles ziemlich gleich.  Da diese beiden Werte kleiner als q sind, ist der Wert dieser Dinge in mod q ungefähr gleich.  Sie unterscheiden sich aufgrund dieses zusätzlichen Bits geringfügig, sind aber immer noch mehr oder weniger gleich groß.  Und die Anzahl der zusätzlichen Reduktionen, die zusätzliche Reduktion, wird sich wahrscheinlich auch nicht wesentlich unterscheiden, da sie proportional zum Wert von c0 'mod q ist.  Und sowohl für g- als auch für g- <sub>hohe</sub> Werte kleiner als q sind sie alle ungefähr gleich.  Keiner von ihnen wird q überschreiten und keine große Anzahl zusätzlicher Reduzierungen verursachen, da für q, das größer als diese beiden Vermutungen ist, die Anzahl der Berechnungen nach der Karatsuba-Methode in Bezug auf die Anzahl der gewöhnlichen Berechnungen gleich bleibt.  In Bezug auf diese Beziehung wird der Server sowohl g als auch g <sub>high</sub> gleich behandeln.  Daher wird der Server für beide Werte ungefähr die gleiche Anzahl zusätzlicher Abkürzungen vornehmen.  Wenn Sie also feststellen, dass der Server dieselbe Zeit damit verbringt, auf diese Vermutungen zu reagieren, sollten Sie wahrscheinlich davon ausgehen, dass zu diesem Zeitpunkt tatsächlich 1 im g-Hochwert vorhanden ist. <br><br><img src="https://habrastorage.org/webt/ui/d_/tg/uid_tglidwosbzxkquvonqfrzi0.jpeg"><br><br>  Befindet sich andererseits q zwischen diesen beiden Werten, gibt es zwei mögliche Dinge, die zu Schalt- und Zeitänderungen führen können.  Eines der Dinge ist, dass, da g <sub>high</sub> etwas größer als q ist, die Anzahl der zusätzlichen Schnitte proportional zu c <sub>0</sub> 'mod q ist, was sehr klein ist, da c <sub>0</sub> ' q plus ein paar Bits in dieser zusätzlichen Bitfolge von 100 ... 00.  Dadurch wird die Anzahl der zusätzlichen Reduzierungen deutlicher und alles beginnt schneller. <br>    ,   ,  , , ,  : «,         !».  ,    g  c <sub>0</sub> '     ,   q,   ,  g <sub>high</sub>  q,  g <sub>high</sub> mod q     .      ,       .         –    ,       ,   . <br><br>     c <sub>0</sub> ' mod q.  c <sub>0</sub>     g <sub>high</sub> ,   q,    ,        g  q.       ,     .     ,     ,          . ,    32-        ,        . <br><br>   ,     32- , ,     ,   .  ,         .         32 ,   ,    -  .   ,     ,  32, , ,     ,      . <br><br> ,  ,     ,            .    ,     q  1,         ,     q  0,   ,    g <sub>high</sub>  q   ,      ,   . <br><br>          . ,      .          ,    .   ,     ,  1-2 .        , ,   Ethernet. <br>      ,   .      .   ,        7    . ,   , -,         ,        ? <br><br> <b>:</b>     ? <br><br> <b>:</b> ,        ,           ,               ,     ,   .   ,       . <br><br>        ,    ,           7 ,        ,            7 .     7   g,   7   g + 1,  g + 2   7      g + 400.      g,     g, , 7   400,    ? <br><br><img src="https://habrastorage.org/webt/oo/at/9h/ooat9hm2htm-wjoamvqlpfv1vac.jpeg"><br><br> <b>:</b> ,    ,   ? <br><br> : ,     ,   ,        — (c <sub>0</sub> ') <sup>d</sup> .      . ,  ,   ,     mod p.    ,           ,     .  ,         g,  1, 2, 3,  ,    . <br><br>       ,     ,          –    100…00.  ,        mod p,    ,      mod p       .       « »,     ,        (c <sub>0</sub> ') <sup>d</sup> ,    .  ? <br><br> <b>:</b>   ,     ? <br><br> <b>:</b>      -   ,       q. ,        q,   ,     ,     . <br><br> <b>:</b>    c <sub>0</sub> '? <br><br> <b>:</b>     c <sub>0</sub> ',     c,     c <sub>0</sub> '      R  mod n. <br><br><img src="https://habrastorage.org/webt/br/j9/xp/brj9xpzlbunothk8hhovxqsxcz8.jpeg"><br><br>      ,  «»  ,     c <sub>0</sub> =  mod q,       c <sub>0</sub> = ((c <sub>0</sub> ' R <sup>-1</sup> ) mod n) mod q.      R,     R.           c <sub>0</sub> ',     (c <sub>0</sub> ') <sup>d</sup> mod q.  ,     ,   ,  ,       R.   ,  R = 2 <sup>512</sup> .  ,    . <br><br> <b>:</b>            mod p    ? <br><br> <b>:</b>     ,    ,      ?    ,     !   ,        . <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/3v5Von-oNUg" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="></a> . <br><br>  Vielen Dank für Ihren Aufenthalt bei uns.  Gefällt dir unser Artikel?  Möchten Sie weitere interessante Materialien sehen?  Unterstützen Sie uns, indem Sie eine Bestellung <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">aufgeben</a> oder Ihren Freunden empfehlen, einen <b>Rabatt von 30% für Habr-Benutzer auf ein einzigartiges Analogon von Einstiegsservern, das wir für Sie erfunden haben:</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Die ganze Wahrheit über VPS (KVM) E5-2650 v4 (6 Kerne) 10 GB DDR4 240 GB SSD 1 Gbit / s von $ 20 oder wie teilt man den Server?</a>  (Optionen sind mit RAID1 und RAID10, bis zu 24 Kernen und bis zu 40 GB DDR4 verfügbar). <br><br> <b>VPS (KVM) E5-2650 v4 (6 Cores) 10GB DDR4 240GB SSD 1Gbps   </b>      ,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="></a> . <br><br>  <b>Dell R730xd 2 mal günstiger?</b>  Nur wir haben <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">2 x Intel Dodeca-Core Xeon E5-2650v4 128 GB DDR4 6 x 480 GB SSD 1 Gbit / s 100 TV von 249 US-Dollar</a> in den Niederlanden und den USA!</b>  Lesen Sie mehr über <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">den Aufbau eines Infrastrukturgebäudes.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Klasse mit Dell R730xd E5-2650 v4 Servern für 9.000 Euro für einen Cent?</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de429394/">https://habr.com/ru/post/de429394/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de429384/index.html">Elektrische Fahrradkomponenten: Motor</a></li>
<li><a href="../de429386/index.html">Der AT & T-Anbieter wird zum größten Urheberrechtsinhaber und beginnt, Benutzer zu trennen, denen Piraterie vorgeworfen wird</a></li>
<li><a href="../de429388/index.html">So gestalten Sie eine Website neu und machen keine Probleme: 4 wichtige Schritte</a></li>
<li><a href="../de429390/index.html">MIT-Kurs "Computer Systems Security". Vorlesung 16: „Seitenkanalangriffe“, Teil 1</a></li>
<li><a href="../de429392/index.html">MIT-Kurs "Computer Systems Security". Vorlesung 16: Angriffe durch den Seitenkanal, Teil 2</a></li>
<li><a href="../de429396/index.html">So testen Sie eine Anwendung bei der Interaktion mit der API mithilfe von SoapUI</a></li>
<li><a href="../de429400/index.html">Seals vs neuronales Netzwerk 2. Oder führen Sie SqueezeNet v.1.1 auf Raspberry Zero in Echtzeit aus (fast)</a></li>
<li><a href="../de429402/index.html">ML.NET 0.7 (Maschinelles Lernen .NET)</a></li>
<li><a href="../de429404/index.html">8 Sek. ½ Möglichkeiten zur Priorisierung der Funktionalität</a></li>
<li><a href="../de429406/index.html">"Monster in Spielen oder wie man Angst erzeugt"</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>