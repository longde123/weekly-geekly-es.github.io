<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤱 🤦🏿 ✒️ Komputasi Terdistribusi di Julia 🐗 ⏺️ 🥤</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Jika artikel sebelumnya lebih mungkin diunggulkan, sekarang saatnya untuk menguji kemampuan paralelisasi Julia di mesinnya. 
 Pemrosesan multi-core at...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Komputasi Terdistribusi di Julia</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/455846/"><p><img src="https://habrastorage.org/webt/ud/o6/5u/udo65u8kthnpek7hzrcedxgzwtk.jpeg"></p><br><p>  Jika <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">artikel sebelumnya</a> lebih mungkin diunggulkan, sekarang saatnya untuk menguji kemampuan paralelisasi Julia di mesinnya. </p><a name="habracut"></a><br><h2 id="mnogoyadernaya-ili-raspredelennaya-obrabotka">  Pemrosesan multi-core atau terdistribusi </h2><br><p> Implementasi komputasi paralel dengan memori terdistribusi disediakan oleh modul <code>Distributed</code> sebagai bagian dari perpustakaan standar yang disertakan dengan Julia.  Sebagian besar komputer modern memiliki lebih dari satu prosesor, dan beberapa komputer dapat dikelompokkan.  Menggunakan kekuatan beberapa prosesor ini memungkinkan Anda untuk melakukan banyak perhitungan lebih cepat.  Kinerja dipengaruhi oleh dua faktor utama: kecepatan prosesor itu sendiri dan kecepatan akses memori mereka.  Di cluster, jelas bahwa CPU ini akan memiliki akses tercepat ke RAM di komputer (node) yang sama.  Mungkin bahkan lebih mengejutkan, masalah seperti itu relevan pada laptop multi-core khas karena perbedaan kecepatan memori utama dan cache.  Oleh karena itu, lingkungan multiprosesor yang baik harus memungkinkan Anda untuk mengontrol "kepemilikan" sebagian memori oleh prosesor tertentu.  Julia menyediakan lingkungan multiprosesor berbasis pesan yang memungkinkan program untuk berjalan secara bersamaan pada beberapa proses dalam domain memori yang berbeda. </p><br><p>  Implementasi pengiriman pesan Julia berbeda dari lingkungan lain, seperti <abbr title="Dalam konteks ini, MPI mengacu pada standar MPI-1. Dimulai dengan MPI-2, komite standar MPI telah memperkenalkan mekanisme komunikasi baru, yang secara kolektif disebut Remote Memory Access (RMA).">MPI</abbr> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">[1]</a> .  Komunikasi dalam Julia biasanya "satu arah", yang berarti bahwa programmer perlu secara eksplisit mengendalikan hanya satu proses dalam operasi dua proses.  Selain itu, operasi ini biasanya tidak terlihat seperti "mengirim pesan" dan "menerima pesan," tetapi lebih menyerupai operasi tingkat yang lebih tinggi, seperti panggilan ke fungsi yang ditentukan pengguna. </p><br><p>  Pemrograman terdistribusi di Julia dibangun pada dua primitif: <em>tautan</em> <em>jarak jauh</em> dan <em>panggilan jarak jauh</em> .  Tautan jarak jauh adalah objek yang dapat digunakan dari proses apa pun untuk merujuk ke objek yang disimpan dalam proses tertentu.  Panggilan jarak jauh adalah permintaan dari satu proses untuk memanggil fungsi tertentu sesuai dengan argumen tertentu dari proses lain (mungkin sama). </p><br><p>  Tautan jarak jauh datang dalam dua bentuk: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Masa Depan</a> dan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Remote Saluran</a> . </p><br><p>  Panggilan jarak jauh mengembalikan <code>Future</code> dan segera melakukannya;  proses yang membuat panggilan dilanjutkan ke operasi berikutnya, sementara panggilan jarak jauh terjadi di tempat lain.  Anda bisa menunggu panggilan jarak jauh untuk menyelesaikan dengan perintah <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">tunggu</a> untuk <code>Future</code> dikembalikan, dan Anda juga bisa mendapatkan nilai penuh dari hasil menggunakan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">fetch</a> . </p><br><p>  Di sisi lain, kami memiliki RemoteChannels yang ditulis ulang.  Misalnya, beberapa proses dapat mengoordinasikan pemrosesan mereka, mengacu pada saluran jarak jauh yang sama.  Setiap proses memiliki pengidentifikasi terkait.  Proses yang menyediakan prompt interaktif Julia selalu memiliki pengidentifikasi 1. Proses yang digunakan secara default untuk operasi bersamaan disebut "pekerja."  Ketika hanya ada satu proses, proses 1 dianggap bekerja.  Kalau tidak, semua proses selain proses 1 dianggap pekerja. </p><br><p><img src="https://habrastorage.org/webt/vy/ts/gd/vytsgdo3oi1x52r901ibv8s4z1a.jpeg"></p><br><p>  Mari kita mulai.  <code>julia -pn</code> dengan <code>julia -pn</code> postscript menyediakan n alur kerja di komputer lokal.  Biasanya masuk akal bahwa n sama dengan jumlah utas CPU (core logis) pada mesin.  Perhatikan bahwa argumen -p secara implisit memuat modul Terdistribusi. </p><br><div class="spoiler">  <b class="spoiler_title">Bagaimana cara memulai postscript?</b> <div class="spoiler_text"><p>  Operasi konsol harus langsung bagi pengguna Linux, termasuk.  Program pendidikan ini ditujukan untuk pengguna Windows yang tidak berpengalaman. <br>  Terminal Julia (REPL) menyediakan kemampuan untuk menggunakan perintah sistem: </p><br><pre> <code class="plaintext hljs">julia&gt; pwd() #     "C:\\Users\\User\\AppData\\Local\\Julia-1.1.0" julia&gt; cd("C:/Users/User/Desktop") #   julia&gt; run(`calc`) #     #     Windows. #      Process(`calc`, ProcessExited(0))</code> </pre> <br><p>  menggunakan perintah ini, Anda dapat memulai Julia dari Julia, tetapi lebih baik tidak terbawa suasana </p><br><p><img src="https://habrastorage.org/webt/tb/yv/4m/tbyv4me6o0jhsk-5ap3xgdqivsq.png"></p><br><p>  Akan lebih benar untuk menjalankan <strong>cmd</strong> dari <em>julia / bin /</em> dan menjalankan perintah <code>julia -p 2</code> sana atau opsi untuk pecinta meluncurkan dari pintasan: pada desktop, buat dokumen notepad dengan konten berikut <code>C:\Users\User\AppData\Local\Julia-1.1.0\bin\julia -p 4</code> ( <em>tentukan alamat dan jumlah proses</em> ) dan simpan sebagai dokumen teks dengan nama <em>run.bat</em> .  Di sini, sekarang di desktop Anda ada file sistem peluncuran Julia untuk 4 core. </p><br><p>  Anda dapat menggunakan metode lain (terutama yang relevan untuk <em>Jupyter</em> ): </p><br><pre> <code class="julia hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Distributed addprocs(<span class="hljs-number"><span class="hljs-number">2</span></span>)</code> </pre> </div></div><br><pre> <code class="julia hljs">$ ./julia -p <span class="hljs-number"><span class="hljs-number">2</span></span> julia&gt; r = remotecall(rand, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>) <span class="hljs-built_in"><span class="hljs-built_in">Future</span></span>(<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-literal"><span class="hljs-literal">nothing</span></span>) julia&gt; s = <span class="hljs-meta"><span class="hljs-meta">@spawnat</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> .+ fetch(r) <span class="hljs-built_in"><span class="hljs-built_in">Future</span></span>(<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-literal"><span class="hljs-literal">nothing</span></span>) julia&gt; fetch(s) <span class="hljs-number"><span class="hljs-number">2</span></span>×<span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>{<span class="hljs-built_in"><span class="hljs-built_in">Float64</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>}: <span class="hljs-number"><span class="hljs-number">1.18526</span></span> <span class="hljs-number"><span class="hljs-number">1.50912</span></span> <span class="hljs-number"><span class="hljs-number">1.16296</span></span> <span class="hljs-number"><span class="hljs-number">1.60607</span></span></code> </pre><br><p>  Argumen pertama yang melakukan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">remotecall</a> adalah fungsi yang dipanggil. <br>  Sebagian besar program bersamaan di Julia tidak merujuk ke proses tertentu atau jumlah proses yang tersedia, tetapi panggilan jarak jauh dianggap sebagai antarmuka tingkat rendah yang menyediakan kontrol yang lebih tepat. </p><br><p>  Argumen kedua untuk <code>remotecall</code> adalah pengidentifikasi proses yang akan melakukan pekerjaan, dan argumen yang tersisa akan diteruskan ke fungsi yang disebut.  Seperti yang Anda lihat, di baris pertama kami meminta proses 2 untuk membangun matriks 2 demi 2 secara acak, dan di baris kedua kami meminta untuk menambahkan 1 ke dalamnya.  Hasil dari kedua perhitungan tersedia dalam dua futures, r dan s.  Makro spawnat mengevaluasi ekspresi dalam argumen kedua untuk proses yang ditentukan dalam argumen pertama.  Terkadang Anda mungkin membutuhkan nilai yang dihitung dari jarak jauh.  Ini biasanya terjadi ketika Anda membaca dari objek jarak jauh untuk mendapatkan data yang diperlukan untuk operasi lokal berikutnya.  Ada fungsi <code>remotecall_fetch</code> untuk <code>remotecall_fetch</code> .  Ini sama dengan <code>fetch (remotecall (...))</code> , tetapi lebih efisien. </p><br><p>  Ingat bahwa <code>getindex(r, 1,1)</code> setara dengan <code>r[1,1]</code> , jadi panggilan ini mengambil elemen pertama dari <code>r</code> akan datang. </p><br><p>  <code>remotecall</code> panggilan jarak jauh panggilan remot tidak terlalu nyaman.  Makro <code>@spawn</code> membuat <code>@spawn</code> lebih mudah.  Ini berfungsi dengan ekspresi, bukan fungsi, dan memilih tempat untuk melakukan operasi untuk Anda: </p><br><pre> <code class="julia hljs">julia&gt; r = <span class="hljs-meta"><span class="hljs-meta">@spawn</span></span> rand(<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>) <span class="hljs-built_in"><span class="hljs-built_in">Future</span></span>(<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-literal"><span class="hljs-literal">nothing</span></span>) julia&gt; s = <span class="hljs-meta"><span class="hljs-meta">@spawn</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> .+ fetch(r) <span class="hljs-built_in"><span class="hljs-built_in">Future</span></span>(<span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-literal"><span class="hljs-literal">nothing</span></span>) julia&gt; fetch(s) <span class="hljs-number"><span class="hljs-number">2</span></span>×<span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>{<span class="hljs-built_in"><span class="hljs-built_in">Float64</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>}: <span class="hljs-number"><span class="hljs-number">1.38854</span></span> <span class="hljs-number"><span class="hljs-number">1.9098</span></span> <span class="hljs-number"><span class="hljs-number">1.20939</span></span> <span class="hljs-number"><span class="hljs-number">1.57158</span></span></code> </pre> <br><p>  Perhatikan bahwa kami menggunakan <code>1 .+ Fetch(r)</code> alih-alih <code>1 .+ r</code>  Ini karena kami tidak tahu di mana kode akan dieksekusi, jadi dalam kasus umum mungkin perlu untuk mengambil <code>r</code> pindah ke dalam proses penambahan.  Dalam hal ini, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">@spawn</a> cukup pintar untuk melakukan perhitungan untuk proses yang memiliki <code>r</code> , jadi pengambilan akan menjadi non-operasional (tidak ada pekerjaan yang dilakukan).  (Perlu dicatat bahwa spawn tidak built-in, tetapi didefinisikan dalam Julia sebagai makro. Anda dapat mendefinisikan konstruksi seperti itu sendiri.) </p><br><p>  Penting untuk diingat bahwa setelah ekstraksi, <code>Future</code> akan men-cache nilainya secara lokal.  Panggilan lebih lanjut untuk mengambil tidak memerlukan lompatan jaringan.  Setelah semua berjangka referensi dipilih, nilai tersimpan yang dihapus dihapus. </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">@async</a> mirip dengan <code>@spawn</code> , tetapi hanya menjalankan tugas dalam proses lokal.  Kami menggunakannya untuk membuat tugas "umpan" untuk setiap proses.  Setiap tugas memilih indeks berikutnya, yang harus dihitung, kemudian menunggu selesainya proses dan mengulangi sampai kita kehabisan indeks. </p><br><p>  Harap dicatat bahwa tugas pengumpan tidak mulai dijalankan sampai tugas utama mencapai akhir blok <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">@sync</a> , setelah itu melewati kontrol dan menunggu untuk menyelesaikan semua tugas lokal sebelum kembali dari fungsi. </p><br><p>  Sedangkan untuk v0.7 dan lebih tinggi, tugas pengumpan dapat berbagi status melalui nextidx, karena semuanya dijalankan dalam proses yang sama.  Bahkan jika tugas direncanakan bersama, memblokir mungkin diperlukan dalam beberapa konteks, seperti dengan I / O yang tidak sinkron.  Ini berarti bahwa pengalihan konteks hanya terjadi pada titik yang ditentukan dengan baik: dalam kasus ini, ketika <code>remotecall_fetch</code> .  Ini adalah kondisi implementasi saat ini, dan mungkin berubah dalam versi Julia yang akan datang, karena dirancang untuk dapat menyelesaikan hingga tugas-tugas N dalam proses M, atau <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">M: N Threading</a> .  Maka kita memerlukan model untuk mendapatkan / melepaskan kunci untuk <code>nextidx</code> , karena tidak aman untuk memungkinkan beberapa proses membaca dan menulis sumber daya pada saat yang sama. </p><br><p>  Kode Anda harus tersedia untuk setiap proses yang menjalankannya.  Misalnya, pada prompt Julia, ketikkan yang berikut: </p><br><pre> <code class="julia hljs">julia&gt; <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> rand2(dims...) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>*rand(dims...) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> julia&gt; rand2(<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>) <span class="hljs-number"><span class="hljs-number">2</span></span>×<span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>{<span class="hljs-built_in"><span class="hljs-built_in">Float64</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>}: <span class="hljs-number"><span class="hljs-number">0.153756</span></span> <span class="hljs-number"><span class="hljs-number">0.368514</span></span> <span class="hljs-number"><span class="hljs-number">1.15119</span></span> <span class="hljs-number"><span class="hljs-number">0.918912</span></span> julia&gt; fetch(<span class="hljs-meta"><span class="hljs-meta">@spawn</span></span> rand2(<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>)) ERROR: <span class="hljs-built_in"><span class="hljs-built_in">RemoteException</span></span>(<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">CapturedException</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">UndefVarError</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">Symbol</span></span>(<span class="hljs-string"><span class="hljs-string">"#rand2"</span></span>)) Stacktrace: [...]</code> </pre> <br><p>  Proses 1 tahu tentang fungsi rand2, tetapi proses 2 tidak.  Paling sering, Anda akan mengunduh kode dari file atau paket, dan Anda akan memiliki fleksibilitas yang signifikan dalam mengendalikan proses mana yang memuat kode.  Pertimbangkan file <code>DummyModule.jl</code> berisi kode berikut: </p><br><pre> <code class="julia hljs"><span class="hljs-keyword"><span class="hljs-keyword">module</span></span> DummyModule <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> MyType, f <span class="hljs-keyword"><span class="hljs-keyword">mutable struct</span></span> MyType a::<span class="hljs-built_in"><span class="hljs-built_in">Int</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> f(x) = x^<span class="hljs-number"><span class="hljs-number">2</span></span>+<span class="hljs-number"><span class="hljs-number">1</span></span> println(<span class="hljs-string"><span class="hljs-string">"loaded"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre> <br><p>  Untuk referensi <code>MyType</code> di semua proses, <code>DummyModule.jl</code> harus dimuat di setiap proses.  Panggilan untuk <code>include ('DummyModule.jl')</code> memuatnya hanya untuk satu proses.  Untuk memuatnya ke setiap proses, gunakan makro <code>@everywhere</code> (jalankan Julia dengan julia -p 2): </p><br><pre> <code class="julia hljs">julia&gt; <span class="hljs-meta"><span class="hljs-meta">@everywhere</span></span> include(<span class="hljs-string"><span class="hljs-string">"DummyModule.jl"</span></span>) loaded From worker <span class="hljs-number"><span class="hljs-number">3</span></span>: loaded From worker <span class="hljs-number"><span class="hljs-number">2</span></span>: loaded</code> </pre> <br><p>  Seperti biasa, ini tidak membuat DummyModule dapat diakses oleh proses apa pun yang membutuhkan penggunaan atau impor.  Selain itu, ketika DummyModule termasuk dalam ruang lingkup satu proses, itu tidak termasuk dalam yang lain: </p><br><pre> <code class="julia hljs">julia&gt; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> .DummyModule julia&gt; MyType(<span class="hljs-number"><span class="hljs-number">7</span></span>) MyType(<span class="hljs-number"><span class="hljs-number">7</span></span>) julia&gt; fetch(<span class="hljs-meta"><span class="hljs-meta">@spawnat</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> MyType(<span class="hljs-number"><span class="hljs-number">7</span></span>)) ERROR: On worker <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">UndefVarError</span></span>: MyType not defined ⋮ julia&gt; fetch(<span class="hljs-meta"><span class="hljs-meta">@spawnat</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> DummyModule.MyType(<span class="hljs-number"><span class="hljs-number">7</span></span>)) MyType(<span class="hljs-number"><span class="hljs-number">7</span></span>)</code> </pre> <br><p>  Namun, masih mungkin, misalnya, untuk mengirim MyType ke proses yang memuat DummyModule, bahkan jika itu tidak dalam cakupan: </p><br><pre> <code class="julia hljs">julia&gt; put!(<span class="hljs-built_in"><span class="hljs-built_in">RemoteChannel</span></span>(<span class="hljs-number"><span class="hljs-number">2</span></span>), MyType(<span class="hljs-number"><span class="hljs-number">7</span></span>)) <span class="hljs-built_in"><span class="hljs-built_in">RemoteChannel</span></span>{<span class="hljs-built_in"><span class="hljs-built_in">Channel</span></span>{<span class="hljs-built_in"><span class="hljs-built_in">Any</span></span>}}(<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>)</code> </pre> <br><p>  File juga dapat dimuat ke dalam beberapa proses saat startup dengan flag -L, dan skrip driver dapat digunakan untuk mengontrol perhitungan: </p><br><pre> <code class="julia hljs">julia -p &lt;n&gt; -L file1.jl -L file2.jl driver.jl</code> </pre> <br><p>  Proses Julia yang menjalankan skrip driver dalam contoh di atas memiliki pengidentifikasi 1, sama seperti proses yang menyediakan prompt interaktif.  Akhirnya, jika DummyModule.jl bukan file terpisah, tetapi sebuah paket, maka menggunakan DummyModule akan memuat DummyModule.jl dalam semua proses, tetapi hanya mentransfernya ke lingkup proses yang digunakan untuk memanggil. </p><br><h2 id="zapusk-i-upravlenie-rabochimi-processami">  Meluncurkan dan mengelola alur kerja </h2><br><p>  Instalasi dasar Julia memiliki dukungan bawaan untuk dua jenis klaster: </p><br><ul><li>  Cluster lokal yang ditentukan dengan opsi -p, seperti yang ditunjukkan di atas. </li><li>  Mesin cluster menggunakan opsi --machine-file.  Ini menggunakan login ssh tanpa kata sandi untuk memulai alur kerja Julia (sepanjang jalur yang sama dengan host saat ini) pada mesin yang ditentukan. </li></ul><br><p><img src="https://habrastorage.org/webt/dr/1b/7y/dr1b7y4ly3ashzsh19-7lwmvwni.jpeg"></p><br><p>  Fungsi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">addprocs</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">rmprocs</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">pekerja,</a> dan lainnya tersedia sebagai alat perangkat lunak untuk menambah, menghapus, dan memproses pertanyaan dalam sebuah cluster. </p><br><pre> <code class="julia hljs">julia&gt; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Distributed julia&gt; addprocs(<span class="hljs-number"><span class="hljs-number">2</span></span>) <span class="hljs-number"><span class="hljs-number">2</span></span>-element <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>{<span class="hljs-built_in"><span class="hljs-built_in">Int64</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>}: <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span></code> </pre> <br><p>  Modul <code>Distributed</code> harus secara eksplisit dimuat ke dalam proses utama sebelum memanggil <code>addprocs</code> .  Secara otomatis menjadi tersedia untuk alur kerja.  Perhatikan bahwa pekerja tidak menjalankan skrip startup <code>~/.julia/config/startup.jl</code> juga tidak menyinkronkan keadaan global mereka (seperti variabel global, definisi metode baru, dan modul yang dimuat) dengan salah satu dari proses yang berjalan lainnya.  Jenis-jenis cluster lainnya dapat didukung dengan menulis <code>ClusterManager</code> Anda sendiri, seperti yang dijelaskan di bawah ini di bagian <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">ClusterManager</a> . </p><br><h2 id="deystviya-s-dannymi">  Tindakan Data </h2><br><p>  Mengirim pesan dan memindahkan data membentuk sebagian besar overhead dalam program terdistribusi.  Mengurangi jumlah pesan dan jumlah data yang dikirim sangat penting untuk mencapai kinerja dan skalabilitas.  Untuk ini, penting untuk memahami pergerakan data yang dilakukan oleh berbagai konstruksi pemrograman terdistribusi Julia. </p><br><p>  <code>fetch</code> dapat dianggap sebagai operasi perpindahan data yang eksplisit, karena ia secara langsung meminta perpindahan objek ke mesin lokal.  <code>@spawn</code> (dan beberapa konstruk terkait) juga memindahkan data, tetapi ini tidak begitu jelas, sehingga dapat disebut operasi perpindahan data implisit.  Pertimbangkan dua pendekatan ini untuk membangun dan mengkuadratkan matriks acak: </p><br><p>  Waktu cara: </p><br><pre> <code class="julia hljs">julia&gt; A = rand(<span class="hljs-number"><span class="hljs-number">1000</span></span>,<span class="hljs-number"><span class="hljs-number">1000</span></span>); julia&gt; Bref = <span class="hljs-meta"><span class="hljs-meta">@spawn</span></span> A^<span class="hljs-number"><span class="hljs-number">2</span></span>; [...] julia&gt; fetch(Bref);</code> </pre> <br><p>  metode dua: </p><br><pre> <code class="julia hljs">julia&gt; Bref = <span class="hljs-meta"><span class="hljs-meta">@spawn</span></span> rand(<span class="hljs-number"><span class="hljs-number">1000</span></span>,<span class="hljs-number"><span class="hljs-number">1000</span></span>)^<span class="hljs-number"><span class="hljs-number">2</span></span>; [...] julia&gt; fetch(Bref);</code> </pre> <br><p>  Perbedaannya nampak sepele, tetapi sebenarnya ini cukup signifikan karena perilaku <code>@spawn</code> .  Dalam metode pertama, matriks acak dibangun secara lokal, dan kemudian dikirim ke proses lain, di mana itu kuadrat.  Dalam metode kedua, matriks acak dibangun dan dikuadratkan pada proses lain.  Oleh karena itu, metode kedua mengirimkan lebih sedikit data daripada yang pertama.  Dalam contoh mainan ini, dua metode mudah dibedakan dan dipilih.  Namun, dalam program nyata, merancang pergerakan data bisa sangat mahal dan mungkin beberapa pengukuran. </p><br><p>  Misalnya, jika proses pertama membutuhkan matriks A, maka metode pertama mungkin lebih baik.  Atau, jika komputasi A mahal dan hanya menggunakan proses saat ini, maka memindahkannya ke proses lain mungkin tidak terhindarkan.  Atau, jika proses saat ini memiliki sangat sedikit kesamaan antara <code>spawn</code> dan <code>fetch(Bref)</code> , mungkin lebih baik untuk sepenuhnya menghilangkan konkurensi.  Atau bayangkan <code>rand(1000, 1000)</code> digantikan oleh operasi yang lebih mahal.  Maka mungkin masuk akal untuk menambahkan pernyataan <code>spawn</code> lain hanya untuk langkah ini. </p><br><h2 id="globalnye-peremennye">  Variabel global </h2><br><p>  Ekspresi yang dijalankan dari jarak jauh melalui spawn, atau penutupan yang ditentukan untuk eksekusi jarak jauh menggunakan <code>remotecall</code> jarak jauh, dapat merujuk ke variabel global.  Binding Global dalam modul <code>Main</code> ditangani sedikit berbeda dari binding global pada modul lainnya.  Pertimbangkan potongan kode berikut: </p><br><pre> <code class="julia hljs">A = rand(<span class="hljs-number"><span class="hljs-number">10</span></span>,<span class="hljs-number"><span class="hljs-number">10</span></span>) remotecall_fetch(()-&gt;sum(A), <span class="hljs-number"><span class="hljs-number">2</span></span>)</code> </pre> <br><p>  Dalam hal ini, <code>sum</code> HARUS didefinisikan dalam proses jarak jauh.  Perhatikan bahwa <code>A</code> adalah variabel global yang didefinisikan dalam ruang kerja lokal.  Pekerja 2 tidak memiliki variabel bernama <code>A</code> di bagian <code>Main</code> .  Mengirim fungsi penutupan <code>() -&gt; sum(A)</code> untuk pekerja 2 menyebabkan <code>Main.A</code> didefinisikan pada 2. <code>Main.A</code> terus ada pada pekerja 2 bahkan setelah mengembalikan panggilan <code>remotecall_fetch</code> . </p><br><p><img src="https://habrastorage.org/webt/kp/iv/xi/kpivxixwcfwqqzi4gv1dyqkjhcw.png"></p><br><p>  Panggilan jarak jauh dengan referensi global tertanam (hanya dalam modul utama) mengelola variabel global sebagai berikut: </p><br><ul><li>  Binding global baru dibuat di workstation tujuan jika mereka dirujuk sebagai bagian dari panggilan jarak jauh. </li><li>  Konstanta global juga dinyatakan sebagai konstanta pada node jarak jauh. </li><li>  Global dikirimkan kembali ke karyawan target hanya dalam konteks panggilan jarak jauh dan hanya jika nilainya telah berubah.  Selain itu, cluster tidak menyinkronkan binding global antar node.  Sebagai contoh: </li></ul><br><pre> <code class="julia hljs">A = rand(<span class="hljs-number"><span class="hljs-number">10</span></span>,<span class="hljs-number"><span class="hljs-number">10</span></span>) remotecall_fetch(()-&gt;sum(A), <span class="hljs-number"><span class="hljs-number">2</span></span>) <span class="hljs-comment"><span class="hljs-comment"># worker 2 A = rand(10,10) remotecall_fetch(()-&gt;sum(A), 3) # worker 3 A = nothing</span></span></code> </pre> <br><p>  Eksekusi fragmen di atas mengarah pada fakta bahwa <code>Main.A</code> pada karyawan 2 memiliki nilai yang berbeda dari <code>Main.A</code> pada karyawan 3, sedangkan nilai <code>Main.A</code> pada node 1 adalah nol. </p><br><p>  Seperti yang mungkin Anda pahami, meskipun memori yang terkait dengan variabel global dapat dikumpulkan ketika mereka dipindahkan ke perangkat master, tindakan seperti itu tidak diambil untuk pekerja, karena binding terus bekerja.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">jelas!</a>  dapat digunakan untuk secara manual menetapkan ulang variabel global tertentu menjadi <code>nothing</code> jika mereka tidak lagi diperlukan.  Ini akan membebaskan memori yang terkait dengannya sebagai bagian dari siklus pengumpulan sampah normal.  Karena itu, program harus berhati-hati ketika mengakses variabel global dalam panggilan jarak jauh.  Bahkan, jika memungkinkan, lebih baik menghindari mereka sama sekali.  Jika Anda harus referensi variabel global, pertimbangkan untuk menggunakan blok <code>let</code> untuk melokalisasi variabel global.  Sebagai contoh: </p><br><pre> <code class="julia hljs">julia&gt; A = rand(<span class="hljs-number"><span class="hljs-number">10</span></span>,<span class="hljs-number"><span class="hljs-number">10</span></span>); julia&gt; remotecall_fetch(()-&gt;A, <span class="hljs-number"><span class="hljs-number">2</span></span>); julia&gt; B = rand(<span class="hljs-number"><span class="hljs-number">10</span></span>,<span class="hljs-number"><span class="hljs-number">10</span></span>); julia&gt; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> B = B remotecall_fetch(()-&gt;B, <span class="hljs-number"><span class="hljs-number">2</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; julia&gt; <span class="hljs-meta"><span class="hljs-meta">@fetchfrom</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> InteractiveUtils.varinfo() name size summary ––––––––– ––––––––– –––––––––––––––––––––– A <span class="hljs-number"><span class="hljs-number">800</span></span> bytes <span class="hljs-number"><span class="hljs-number">10</span></span>×<span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>{<span class="hljs-built_in"><span class="hljs-built_in">Float64</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>} Base <span class="hljs-built_in"><span class="hljs-built_in">Module</span></span> Core <span class="hljs-built_in"><span class="hljs-built_in">Module</span></span> Main <span class="hljs-built_in"><span class="hljs-built_in">Module</span></span></code> </pre> <br><p>  Mudah untuk melihat bahwa variabel global <code>A</code> didefinisikan pada pekerja 2, tetapi <code>B</code> ditulis sebagai variabel lokal, dan oleh karena itu pengikatan untuk <code>B</code> tidak ada pada pekerja 2. </p><br><h2 id="parallelnye-cikly">  Loop paralel </h2><br><p><img src="https://habrastorage.org/webt/zv/m5/q_/zvm5q_scthnveue7fxljwa0dshu.jpeg"></p><br><p>  Untungnya, banyak perhitungan konkurensi berguna tidak memerlukan perpindahan data.  Contoh khas adalah simulasi Monte Carlo, di mana beberapa proses dapat secara bersamaan memproses tes simulasi independen.  Kita dapat menggunakan <code>@spawn</code> untuk membalik koin menjadi dua proses.  Pertama, tulis fungsi berikut di <code>count_heads.jl</code> : </p><br><pre> <code class="julia hljs"><span class="hljs-keyword"><span class="hljs-keyword">function</span></span> count_heads(n) c::<span class="hljs-built_in"><span class="hljs-built_in">Int</span></span> = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i = <span class="hljs-number"><span class="hljs-number">1</span></span>:n c += rand(<span class="hljs-built_in"><span class="hljs-built_in">Bool</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> c <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre> <br><p>  Fungsi count_heads hanya menambahkan n bit acak.  Inilah cara kami dapat melakukan beberapa pengujian pada dua mesin dan menambahkan hasilnya: </p><br><pre> <code class="julia hljs">julia&gt; <span class="hljs-meta"><span class="hljs-meta">@everywhere</span></span> include_string(Main, $(read(<span class="hljs-string"><span class="hljs-string">"count_heads.jl"</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">String</span></span>)), <span class="hljs-string"><span class="hljs-string">"count_heads.jl"</span></span>) julia&gt; a = <span class="hljs-meta"><span class="hljs-meta">@spawn</span></span> count_heads(<span class="hljs-number"><span class="hljs-number">100000000</span></span>) <span class="hljs-built_in"><span class="hljs-built_in">Future</span></span>(<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-literal"><span class="hljs-literal">nothing</span></span>) julia&gt; b = <span class="hljs-meta"><span class="hljs-meta">@spawn</span></span> count_heads(<span class="hljs-number"><span class="hljs-number">100000000</span></span>) <span class="hljs-built_in"><span class="hljs-built_in">Future</span></span>(<span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-literal"><span class="hljs-literal">nothing</span></span>) julia&gt; fetch(a)+fetch(b) <span class="hljs-number"><span class="hljs-number">100001564</span></span></code> </pre> <br><p>  Contoh ini menunjukkan pola pemrograman paralel yang kuat dan sering digunakan.  Banyak iterasi dilakukan secara independen dalam beberapa proses, dan kemudian hasilnya digabungkan menggunakan beberapa fungsi.  Proses penyatuan disebut reduksi, karena biasanya mengurangi peringkat tensor: vektor angka direduksi menjadi satu angka, atau matriks direduksi menjadi satu baris atau kolom, dll.  Dalam kode, ini biasanya terlihat seperti ini: pola <code>x = f(x, v [i])</code> , di mana <code>x</code> adalah baterai, <code>f</code> adalah fungsi reduksi, dan <code>v[i]</code> adalah elemen yang harus dikurangi. </p><br><p>  Diharapkan bahwa <code>f</code> menjadi asosiatif sehingga tidak masalah di mana urutan operasi dilakukan.  Harap perhatikan bahwa penggunaan kami atas template ini dengan <code>count_heads</code> dapat digeneralisasi.  Kami menggunakan dua pernyataan <code>spawn</code> eksplisit, yang membatasi konkurensi untuk dua proses.  Untuk berjalan pada sejumlah proses, kita dapat menggunakan paralel <code>for</code> operasi loop dalam memori terdistribusi, yang dapat ditulis ke Julia menggunakan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">terdistribusi</a> , misalnya: </p><br><pre> <code class="julia hljs">nheads = <span class="hljs-meta"><span class="hljs-meta">@distributed</span></span> (+) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i = <span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-number"><span class="hljs-number">200000000</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Int</span></span>(rand(<span class="hljs-built_in"><span class="hljs-built_in">Bool</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre> <br><p>                (   <code>(+)</code> ).          .         . </p><br><p>  ,     <code>for</code>    ,    .  ,      ,          ,      .  ,    ,      . ,       : </p><br><pre> <code class="julia hljs">a = zeros(<span class="hljs-number"><span class="hljs-number">100000</span></span>) <span class="hljs-meta"><span class="hljs-meta">@distributed</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i = <span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-number"><span class="hljs-number">100000</span></span> a[i] = i <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre> <br><p>      ,          .    ,  .  ,       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Shared Arrays</a> ,    ,    : </p><br><pre> <code class="julia hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> SharedArrays a = <span class="hljs-built_in"><span class="hljs-built_in">SharedArray</span></span>{<span class="hljs-built_in"><span class="hljs-built_in">Float64</span></span>}(<span class="hljs-number"><span class="hljs-number">10</span></span>) <span class="hljs-meta"><span class="hljs-meta">@distributed</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i = <span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-number"><span class="hljs-number">10</span></span> a[i] = i <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre> <br><p>  «»      ,      : </p><br><pre> <code class="julia hljs">a = randn(<span class="hljs-number"><span class="hljs-number">1000</span></span>) <span class="hljs-meta"><span class="hljs-meta">@distributed</span></span> (+) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i = <span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-number"><span class="hljs-number">100000</span></span> f(a[rand(<span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-keyword"><span class="hljs-keyword">end</span></span>)]) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre> <br><p>     <code>f</code>      ,    .    ,    ,    .      ,               <code>Future</code> ,   .     Future    ,    <code>fetch</code> ,      ,   <code>@sync</code> ,  <code>@sync distributed for</code> . </p><br><p>       ,              (,    ,      ).     ,  <em> </em> ,   Julia   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">pmap</a> . ,            : </p><br><pre> <code class="julia hljs">julia&gt; M = <span class="hljs-built_in"><span class="hljs-built_in">Matrix</span></span>{<span class="hljs-built_in"><span class="hljs-built_in">Float64</span></span>}[rand(<span class="hljs-number"><span class="hljs-number">1000</span></span>,<span class="hljs-number"><span class="hljs-number">1000</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i = <span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-number"><span class="hljs-number">10</span></span>]; julia&gt; pmap(svdvals, M);</code> </pre> <br><p> <code>pmap</code>    ,        . , <code>distributed for</code>   ,    , ,    .      <code>pmap</code> ,   <code>distributed</code>   .   <code>distributed for</code>      . </p><br><h2 id="obschie-massivy-shared-arrays">   (Shared Arrays) </h2><br><p><img src="https://habrastorage.org/webt/gg/46/u5/gg46u5y_8bmejazw_ijxwzrbxie.jpeg"></p><br><p> Shared Arrays              .        <a href="">DArray</a> ,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">SharedArray</a>  .  <a href="">DArray</a>         ,            ; ,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">SharedArray</a>        . </p><br><p> <code>SharedArray</code> —  ,   ,              .  Shared Array    <code>SharedArrays</code> ,         .  <code>SharedArray</code>  (    )   ,        ,       .        <code>SharedArray</code> ,     .  ,      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Array</a> ,      <code>SharedArray</code> ,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sdata</a> .    <code>AbstractArray</code> <code>sdata</code>    ,    <code>sdata</code>     <code>Array</code> .      : </p><br><pre> <code class="julia hljs"><span class="hljs-built_in"><span class="hljs-built_in">SharedArray</span></span>{T,N}(dims::<span class="hljs-built_in"><span class="hljs-built_in">NTuple</span></span>; init=<span class="hljs-literal"><span class="hljs-literal">false</span></span>, pids=<span class="hljs-built_in"><span class="hljs-built_in">Int</span></span>[])</code> </pre> <br><p>   <code>N</code> -     <code>T</code>   <code>dims</code>  ,   <code>pids</code> .     ,        ,      <code>pids</code> (  ,       ). </p><br><p>    <code>init</code>   <code>initfn(S :: SharedArray)</code> ,      .   ,      <code>init</code>    ,  . </p><br><p>   : </p><br><pre> <code class="julia hljs">julia&gt; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Distributed julia&gt; addprocs(<span class="hljs-number"><span class="hljs-number">3</span></span>) <span class="hljs-number"><span class="hljs-number">3</span></span>-element <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>{<span class="hljs-built_in"><span class="hljs-built_in">Int64</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>}: <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> julia&gt; <span class="hljs-meta"><span class="hljs-meta">@everywhere</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> SharedArrays julia&gt; S = <span class="hljs-built_in"><span class="hljs-built_in">SharedArray</span></span>{<span class="hljs-built_in"><span class="hljs-built_in">Int</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>}((<span class="hljs-number"><span class="hljs-number">3</span></span>,<span class="hljs-number"><span class="hljs-number">4</span></span>), init = S -&gt; S[localindices(S)] = myid()) <span class="hljs-number"><span class="hljs-number">3</span></span>×<span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-built_in"><span class="hljs-built_in">SharedArray</span></span>{<span class="hljs-built_in"><span class="hljs-built_in">Int64</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>}: <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> julia&gt; S[<span class="hljs-number"><span class="hljs-number">3</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>] = <span class="hljs-number"><span class="hljs-number">7</span></span> <span class="hljs-number"><span class="hljs-number">7</span></span> julia&gt; S <span class="hljs-number"><span class="hljs-number">3</span></span>×<span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-built_in"><span class="hljs-built_in">SharedArray</span></span>{<span class="hljs-built_in"><span class="hljs-built_in">Int64</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>}: <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">7</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span></code> </pre> <br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">SharedArrays.localindices</a>             . ,      ,  : </p><br><pre> <code class="julia hljs">julia&gt; S = <span class="hljs-built_in"><span class="hljs-built_in">SharedArray</span></span>{<span class="hljs-built_in"><span class="hljs-built_in">Int</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>}((<span class="hljs-number"><span class="hljs-number">3</span></span>,<span class="hljs-number"><span class="hljs-number">4</span></span>), init = S -&gt; S[indexpids(S):length(procs(S)):length(S)] = myid()) <span class="hljs-number"><span class="hljs-number">3</span></span>×<span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-built_in"><span class="hljs-built_in">SharedArray</span></span>{<span class="hljs-built_in"><span class="hljs-built_in">Int64</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>}: <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span></code> </pre> <br><p>        ,    ,    .  Sebagai contoh: </p><br><pre> <code class="julia hljs"><span class="hljs-meta"><span class="hljs-meta">@sync</span></span> <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> p <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> procs(S) <span class="hljs-meta"><span class="hljs-meta">@async</span></span> <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> remotecall_wait(fill!, p, S, p) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre> <br><p>    .     <em></em>    <code>pid</code> ,  ,     (    <code>S</code> ),   <code>pid</code> . </p><br><p>            «»: </p><br><pre> <code class="julia hljs">q[i,j,t+<span class="hljs-number"><span class="hljs-number">1</span></span>] = q[i,j,t] + u[i,j,t]</code> </pre> <br><p>   ,     ,   , ,  ,   :  <code>q [i,j,t]</code>    ,     <code>q[i,j,t+1]</code>     ,  ,  ,  <code>q[i,j,t]</code>      ,      <code>q[i,j,t+1]</code> .         .     .  ,    <code>(irange, jrange)</code> ,   : </p><br><pre> <code class="julia hljs">julia&gt; <span class="hljs-meta"><span class="hljs-meta">@everywhere</span></span> <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> myrange(q::<span class="hljs-built_in"><span class="hljs-built_in">SharedArray</span></span>) idx = indexpids(q) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> idx == <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-comment"><span class="hljs-comment"># This worker is not assigned a piece return 1:0, 1:0 end nchunks = length(procs(q)) splits = [round(Int, s) for s in range(0, stop=size(q,2), length=nchunks+1)] 1:size(q,1), splits[idx]+1:splits[idx+1] end</span></span></code> </pre> <br><p>   : </p><br><pre> <code class="julia hljs">julia&gt; <span class="hljs-meta"><span class="hljs-meta">@everywhere</span></span> <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> advection_chunk!(q, u, irange, jrange, trange) <span class="hljs-meta"><span class="hljs-meta">@show</span></span> (irange, jrange, trange) <span class="hljs-comment"><span class="hljs-comment"># display so we can see what's happening for t in trange, j in jrange, i in irange q[i,j,t+1] = q[i,j,t] + u[i,j,t] end q end</span></span></code> </pre> <br><p>        <code>SharedArray</code> </p><br><pre> <code class="julia hljs">julia&gt; <span class="hljs-meta"><span class="hljs-meta">@everywhere</span></span> advection_shared_chunk!(q, u) = advection_chunk!(q, u, myrange(q)..., <span class="hljs-number"><span class="hljs-number">1</span></span>:size(q,<span class="hljs-number"><span class="hljs-number">3</span></span>)-<span class="hljs-number"><span class="hljs-number">1</span></span>)</code> </pre> <br><p>      ,       : </p><br><pre> <code class="julia hljs">julia&gt; advection_serial!(q, u) = advection_chunk!(q, u, <span class="hljs-number"><span class="hljs-number">1</span></span>:size(q,<span class="hljs-number"><span class="hljs-number">1</span></span>), <span class="hljs-number"><span class="hljs-number">1</span></span>:size(q,<span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-number"><span class="hljs-number">1</span></span>:size(q,<span class="hljs-number"><span class="hljs-number">3</span></span>)-<span class="hljs-number"><span class="hljs-number">1</span></span>);</code> </pre> <br><p>   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">@distributed</a> : </p><br><pre> <code class="julia hljs">julia&gt; <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> advection_parallel!(q, u) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> t = <span class="hljs-number"><span class="hljs-number">1</span></span>:size(q,<span class="hljs-number"><span class="hljs-number">3</span></span>)-<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-meta"><span class="hljs-meta">@sync</span></span> <span class="hljs-meta"><span class="hljs-meta">@distributed</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> j = <span class="hljs-number"><span class="hljs-number">1</span></span>:size(q,<span class="hljs-number"><span class="hljs-number">2</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i = <span class="hljs-number"><span class="hljs-number">1</span></span>:size(q,<span class="hljs-number"><span class="hljs-number">1</span></span>) q[i,j,t+<span class="hljs-number"><span class="hljs-number">1</span></span>]= q[i,j,t] + u[i,j,t] <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> q <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>;</code> </pre> <br><p>  ,   : </p><br><pre> <code class="julia hljs">julia&gt; <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> advection_shared!(q, u) <span class="hljs-meta"><span class="hljs-meta">@sync</span></span> <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> p <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> procs(q) <span class="hljs-meta"><span class="hljs-meta">@async</span></span> remotecall_wait(advection_shared_chunk!, p, q, u) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> q <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>;</code> </pre> <br><p>    SharedArray    ,     (  <code>julia -p 4</code> ): </p><br><pre> <code class="julia hljs">julia&gt; q = <span class="hljs-built_in"><span class="hljs-built_in">SharedArray</span></span>{<span class="hljs-built_in"><span class="hljs-built_in">Float64</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span>}((<span class="hljs-number"><span class="hljs-number">500</span></span>,<span class="hljs-number"><span class="hljs-number">500</span></span>,<span class="hljs-number"><span class="hljs-number">500</span></span>)); julia&gt; u = <span class="hljs-built_in"><span class="hljs-built_in">SharedArray</span></span>{<span class="hljs-built_in"><span class="hljs-built_in">Float64</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span>}((<span class="hljs-number"><span class="hljs-number">500</span></span>,<span class="hljs-number"><span class="hljs-number">500</span></span>,<span class="hljs-number"><span class="hljs-number">500</span></span>));</code> </pre> <br><p>      JIT-     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">@time</a>   : </p><br><pre> <code class="julia hljs">julia&gt; <span class="hljs-meta"><span class="hljs-meta">@time</span></span> advection_serial!(q, u); (irange,jrange,trange) = (<span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-number"><span class="hljs-number">500</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-number"><span class="hljs-number">500</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-number"><span class="hljs-number">499</span></span>) <span class="hljs-number"><span class="hljs-number">830.220</span></span> milliseconds (<span class="hljs-number"><span class="hljs-number">216</span></span> allocations: <span class="hljs-number"><span class="hljs-number">13820</span></span> bytes) julia&gt; <span class="hljs-meta"><span class="hljs-meta">@time</span></span> advection_parallel!(q, u); <span class="hljs-number"><span class="hljs-number">2.495</span></span> seconds (<span class="hljs-number"><span class="hljs-number">3999</span></span> k allocations: <span class="hljs-number"><span class="hljs-number">289</span></span> MB, <span class="hljs-number"><span class="hljs-number">2.09</span></span>% gc time) julia&gt; <span class="hljs-meta"><span class="hljs-meta">@time</span></span> advection_shared!(q,u); From worker <span class="hljs-number"><span class="hljs-number">2</span></span>: (irange,jrange,trange) = (<span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-number"><span class="hljs-number">500</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-number"><span class="hljs-number">125</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-number"><span class="hljs-number">499</span></span>) From worker <span class="hljs-number"><span class="hljs-number">4</span></span>: (irange,jrange,trange) = (<span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-number"><span class="hljs-number">500</span></span>,<span class="hljs-number"><span class="hljs-number">251</span></span>:<span class="hljs-number"><span class="hljs-number">375</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-number"><span class="hljs-number">499</span></span>) From worker <span class="hljs-number"><span class="hljs-number">3</span></span>: (irange,jrange,trange) = (<span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-number"><span class="hljs-number">500</span></span>,<span class="hljs-number"><span class="hljs-number">126</span></span>:<span class="hljs-number"><span class="hljs-number">250</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-number"><span class="hljs-number">499</span></span>) From worker <span class="hljs-number"><span class="hljs-number">5</span></span>: (irange,jrange,trange) = (<span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-number"><span class="hljs-number">500</span></span>,<span class="hljs-number"><span class="hljs-number">376</span></span>:<span class="hljs-number"><span class="hljs-number">500</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-number"><span class="hljs-number">499</span></span>) <span class="hljs-number"><span class="hljs-number">238.119</span></span> milliseconds (<span class="hljs-number"><span class="hljs-number">2264</span></span> allocations: <span class="hljs-number"><span class="hljs-number">169</span></span> KB)</code> </pre> <br><p>    <code>advection_shared!</code>  ,      ,         . </p><br><h3 id="obschie-massivy-i-raspredelennaya-sborka-musora">       </h3><br><p>    ,          . ,        ,         . <br>    ,     ,   ,  . </p><br><h1 id="parallelnyy-monte-karlo-v-julia">  -  Julia </h1><br><p>  ,             ,    ,        . </p><br><p>         <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi><mo>=</mo><mn>3.14159265...</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="17.48ex" height="2.057ex" viewBox="0 -780.1 7526.1 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhiqgTWnKULfysPnOzmCzqg1CjDMFA#MJMATHI-3C0" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhiqgTWnKULfysPnOzmCzqg1CjDMFA#MJMAIN-3D" x="851" y="0"></use><g transform="translate(1907,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhiqgTWnKULfysPnOzmCzqg1CjDMFA#MJMAIN-33"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhiqgTWnKULfysPnOzmCzqg1CjDMFA#MJMAIN-2E" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhiqgTWnKULfysPnOzmCzqg1CjDMFA#MJMAIN-31" x="779" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhiqgTWnKULfysPnOzmCzqg1CjDMFA#MJMAIN-34" x="1279" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhiqgTWnKULfysPnOzmCzqg1CjDMFA#MJMAIN-31" x="1780" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhiqgTWnKULfysPnOzmCzqg1CjDMFA#MJMAIN-35" x="2280" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhiqgTWnKULfysPnOzmCzqg1CjDMFA#MJMAIN-39" x="2781" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhiqgTWnKULfysPnOzmCzqg1CjDMFA#MJMAIN-32" x="3281" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhiqgTWnKULfysPnOzmCzqg1CjDMFA#MJMAIN-36" x="3782" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhiqgTWnKULfysPnOzmCzqg1CjDMFA#MJMAIN-35" x="4282" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhiqgTWnKULfysPnOzmCzqg1CjDMFA#MJMAIN-2E" x="4783" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhiqgTWnKULfysPnOzmCzqg1CjDMFA#MJMAIN-2E" x="5061" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhiqgTWnKULfysPnOzmCzqg1CjDMFA#MJMAIN-2E" x="5340" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>π</mi><mo>=</mo><mn>3.14159265...</mn></math></span></span><script type="math/tex" id="MathJax-Element-1">\pi = 3.14159265...</script> ,      ,   -.   <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>p</mi><mi>i</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.553ex" height="2.298ex" viewBox="0 -728.2 1099 989.6" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhiqgTWnKULfysPnOzmCzqg1CjDMFA#MJMATHI-70" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhiqgTWnKULfysPnOzmCzqg1CjDMFA#MJMATHI-69" x="753" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>p</mi><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-2"> \ pi </script> ,     <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>S</mi><mo>=</mo><mi>&amp;#x03C0;</mi><msup><mi>r</mi><mn>2</mn></msup></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.033ex" height="2.419ex" viewBox="0 -935.7 3458.5 1041.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhiqgTWnKULfysPnOzmCzqg1CjDMFA#MJMATHI-53" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhiqgTWnKULfysPnOzmCzqg1CjDMFA#MJMAIN-3D" x="923" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhiqgTWnKULfysPnOzmCzqg1CjDMFA#MJMATHI-3C0" x="1979" y="0"></use><g transform="translate(2553,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhiqgTWnKULfysPnOzmCzqg1CjDMFA#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhiqgTWnKULfysPnOzmCzqg1CjDMFA#MJMAIN-32" x="638" y="513"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>S</mi><mo>=</mo><mi>π</mi><msup><mi>r</mi><mn>2</mn></msup></math></span></span><script type="math/tex" id="MathJax-Element-3">S = \pi r^2</script>  dimana <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>r</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.049ex" height="1.455ex" viewBox="0 -520.7 451.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhiqgTWnKULfysPnOzmCzqg1CjDMFA#MJMATHI-72" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi></math></span></span><script type="math/tex" id="MathJax-Element-4"> r </script> —  .     -   <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>p</mi><mi>i</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.553ex" height="2.298ex" viewBox="0 -728.2 1099 989.6" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhiqgTWnKULfysPnOzmCzqg1CjDMFA#MJMATHI-70" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhiqgTWnKULfysPnOzmCzqg1CjDMFA#MJMATHI-69" x="753" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>p</mi><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-5"> \ pi </script>    , ..        <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>[</mo><mo>&amp;#x2212;</mo><mn>1</mn><mo>,</mo><mn>1</mn><msup><mo stretchy=&quot;false&quot;>]</mo><mn>2</mn></msup></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.515ex" height="2.901ex" viewBox="0 -935.7 3235.6 1249" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhiqgTWnKULfysPnOzmCzqg1CjDMFA#MJMAIN-5B" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhiqgTWnKULfysPnOzmCzqg1CjDMFA#MJMAIN-2212" x="278" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhiqgTWnKULfysPnOzmCzqg1CjDMFA#MJMAIN-31" x="1057" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhiqgTWnKULfysPnOzmCzqg1CjDMFA#MJMAIN-2C" x="1557" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhiqgTWnKULfysPnOzmCzqg1CjDMFA#MJMAIN-31" x="2002" y="0"></use><g transform="translate(2503,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhiqgTWnKULfysPnOzmCzqg1CjDMFA#MJMAIN-5D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhiqgTWnKULfysPnOzmCzqg1CjDMFA#MJMAIN-32" x="393" y="513"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mo>−</mo><mn>1</mn><mo>,</mo><mn>1</mn><msup><mo stretchy="false">]</mo><mn>2</mn></msup></math></span></span><script type="math/tex" id="MathJax-Element-6">[−1,1]^2</script>   <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi><mo>&amp;#x2212;</mo><mi>y</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.326ex" height="2.178ex" viewBox="0 -676.4 2292.9 937.7" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhiqgTWnKULfysPnOzmCzqg1CjDMFA#MJMATHI-78" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhiqgTWnKULfysPnOzmCzqg1CjDMFA#MJMAIN-2212" x="794" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhiqgTWnKULfysPnOzmCzqg1CjDMFA#MJMATHI-79" x="1795" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo>−</mo><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-7">x-y</script>    ,    . </p><br><p><img src="https://habrastorage.org/webt/4v/ym/mb/4vymmbllbfnu3prcb3wfu0qqkje.png"></p><br><p>     ( <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>S</mi><mo>=</mo><mi>&amp;#x03C0;</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.93ex" height="2.057ex" viewBox="0 -780.1 2553.1 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhiqgTWnKULfysPnOzmCzqg1CjDMFA#MJMATHI-53" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhiqgTWnKULfysPnOzmCzqg1CjDMFA#MJMAIN-3D" x="923" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhiqgTWnKULfysPnOzmCzqg1CjDMFA#MJMATHI-3C0" x="1979" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>S</mi><mo>=</mo><mi>π</mi></math></span></span><script type="math/tex" id="MathJax-Element-8">S=\pi</script> ,   <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>r</mi><mo>=</mo><mn>1</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.31ex" height="1.937ex" viewBox="0 -728.2 2286.1 834" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhiqgTWnKULfysPnOzmCzqg1CjDMFA#MJMATHI-72" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhiqgTWnKULfysPnOzmCzqg1CjDMFA#MJMAIN-3D" x="729" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhiqgTWnKULfysPnOzmCzqg1CjDMFA#MJMAIN-31" x="1785" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi><mo>=</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-9">r = 1</script> )    ( <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>A</mi><mo>=</mo><mn>4</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.004ex" height="2.057ex" viewBox="0 -780.1 2585.1 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhiqgTWnKULfysPnOzmCzqg1CjDMFA#MJMATHI-41" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhiqgTWnKULfysPnOzmCzqg1CjDMFA#MJMAIN-3D" x="1028" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhiqgTWnKULfysPnOzmCzqg1CjDMFA#MJMAIN-34" x="2084" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi><mo>=</mo><mn>4</mn></math></span></span><script type="math/tex" id="MathJax-Element-10">A = 4</script> )  <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><mn>4</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.657ex" height="2.66ex" viewBox="0 -832 1574.5 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhiqgTWnKULfysPnOzmCzqg1CjDMFA#MJMATHI-3C0" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhiqgTWnKULfysPnOzmCzqg1CjDMFA#MJMAIN-2F" x="573" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhiqgTWnKULfysPnOzmCzqg1CjDMFA#MJMAIN-34" x="1074" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>π</mi><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mn>4</mn></math></span></span><script type="math/tex" id="MathJax-Element-11">\pi/4</script> ,      ,    ,          .  ,   <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>p</mi><mi>i</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.553ex" height="2.298ex" viewBox="0 -728.2 1099 989.6" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhiqgTWnKULfysPnOzmCzqg1CjDMFA#MJMATHI-70" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhiqgTWnKULfysPnOzmCzqg1CjDMFA#MJMATHI-69" x="753" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>p</mi><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-12"> \ pi </script>      ,    .    <code>compute_pi (N)</code> ,    <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-13-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>p</mi><mi>i</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.553ex" height="2.298ex" viewBox="0 -728.2 1099 989.6" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhiqgTWnKULfysPnOzmCzqg1CjDMFA#MJMATHI-70" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhiqgTWnKULfysPnOzmCzqg1CjDMFA#MJMATHI-69" x="753" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>p</mi><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-13"> \ pi </script> ,  <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-14-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>N</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.064ex" height="2.057ex" viewBox="0 -780.1 888.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhiqgTWnKULfysPnOzmCzqg1CjDMFA#MJMATHI-4E" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math></span></span><script type="math/tex" id="MathJax-Element-14">N</script> . </p><br><pre> <code class="julia hljs"><span class="hljs-keyword"><span class="hljs-keyword">function</span></span> compute_pi(N::<span class="hljs-built_in"><span class="hljs-built_in">Int</span></span>) <span class="hljs-comment"><span class="hljs-comment"># counts number of points that have radial coordinate &lt; 1, ie in circle n_landed_in_circle = 0 for i = 1:N x = rand() * 2 - 1 # uniformly distributed number on x-axis y = rand() * 2 - 1 # uniformly distributed number on y-axis r2 = x*x + y*y # radius squared, in radial coordinates if r2 &lt; 1.0 n_landed_in_circle += 1 end end return n_landed_in_circle / N * 4.0 end</span></span></code> </pre> <br><p>  ,     ,    <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-15-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>p</mi><mi>i</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.553ex" height="2.298ex" viewBox="0 -728.2 1099 989.6" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhiqgTWnKULfysPnOzmCzqg1CjDMFA#MJMATHI-70" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455846/&amp;usg=ALkJrhiqgTWnKULfysPnOzmCzqg1CjDMFA#MJMATHI-69" x="753" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>p</mi><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-15"> \ pi </script>  .      :   ,          ,     25  . </p><br><p>  Julia         <code>Pi.jl</code> (    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Sublime Text</a> ,          ): </p><br><pre> <code class="julia hljs">C:\Users\User\AppData\Local\Julia-<span class="hljs-number"><span class="hljs-number">1.1</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>\bin\julia -p <span class="hljs-number"><span class="hljs-number">4</span></span> julia&gt; include(<span class="hljs-string"><span class="hljs-string">"C:/Users/User/Desktop/Pi.jl"</span></span>)</code> </pre> <br><p>       </p><br><pre> <code class="julia hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Distributed addprocs(<span class="hljs-number"><span class="hljs-number">4</span></span>)</code> </pre> <br><p>       <em>Jupyter</em> </p><br><div class="spoiler"> <b class="spoiler_title">Pi.jl</b> <div class="spoiler_text"><pre> <code class="julia hljs"><span class="hljs-meta"><span class="hljs-meta">@everywhere</span></span> <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> compute_pi(N::<span class="hljs-built_in"><span class="hljs-built_in">Int</span></span>) n_landed_in_circle = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-comment"><span class="hljs-comment"># counts number of points that have radial coordinate &lt; 1, ie in circle for i = 1:N x = rand() * 2 - 1 # uniformly distributed number on x-axis y = rand() * 2 - 1 # uniformly distributed number on y-axis r2 = x*x + y*y # radius squared, in radial coordinates if r2 &lt; 1.0 n_landed_in_circle += 1 end end return n_landed_in_circle / N * 4.0 end function parallel_pi_computation(N::Int; ncores::Int=4) #       sum_of_pis = @distributed (+) for i=1:ncores compute_pi(ceil(Int, N / ncores)) end return sum_of_pis / ncores # average value end # ceil (T, x)     #  T,     x.</span></span></code> </pre> </div></div><br><p>       ,    : </p><br><pre> <code class="julia hljs">julia&gt; <span class="hljs-meta"><span class="hljs-meta">@time</span></span> parallel_pi_computation(<span class="hljs-number"><span class="hljs-number">1000000000</span></span>, ncores = <span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-number"><span class="hljs-number">6.818123</span></span> seconds (<span class="hljs-number"><span class="hljs-number">1.96</span></span> M allocations: <span class="hljs-number"><span class="hljs-number">99.838</span></span> MiB, <span class="hljs-number"><span class="hljs-number">0.42</span></span>% gc time) <span class="hljs-number"><span class="hljs-number">3.141562892</span></span> julia&gt; <span class="hljs-meta"><span class="hljs-meta">@time</span></span> parallel_pi_computation(<span class="hljs-number"><span class="hljs-number">1000000000</span></span>, ncores = <span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-number"><span class="hljs-number">5.081638</span></span> seconds (<span class="hljs-number"><span class="hljs-number">1.12</span></span> k allocations: <span class="hljs-number"><span class="hljs-number">62.953</span></span> KiB) <span class="hljs-number"><span class="hljs-number">3.141657252</span></span> julia&gt; <span class="hljs-meta"><span class="hljs-meta">@time</span></span> parallel_pi_computation(<span class="hljs-number"><span class="hljs-number">1000000000</span></span>, ncores = <span class="hljs-number"><span class="hljs-number">2</span></span>) <span class="hljs-number"><span class="hljs-number">3.504871</span></span> seconds (<span class="hljs-number"><span class="hljs-number">1.84</span></span> k allocations: <span class="hljs-number"><span class="hljs-number">109.382</span></span> KiB) <span class="hljs-number"><span class="hljs-number">3.1415942599999997</span></span> julia&gt; <span class="hljs-meta"><span class="hljs-meta">@time</span></span> parallel_pi_computation(<span class="hljs-number"><span class="hljs-number">1000000000</span></span>, ncores = <span class="hljs-number"><span class="hljs-number">4</span></span>) <span class="hljs-number"><span class="hljs-number">3.093918</span></span> seconds (<span class="hljs-number"><span class="hljs-number">1.12</span></span> k allocations: <span class="hljs-number"><span class="hljs-number">71.938</span></span> KiB) <span class="hljs-number"><span class="hljs-number">3.1416889400000003</span></span> julia&gt; <span class="hljs-literal"><span class="hljs-literal">pi</span></span> ? = <span class="hljs-number"><span class="hljs-number">3.1415926535897</span></span>...</code> </pre> <br><p>  <em>JIT</em> - —     .  ,    Julia  . ,             (       Multi-Threading, Atomic Operations, Channels  Coroutines). </p><br><h3 id="poleznye-ssylki">   </h3><br><p>   ,    ,   .  <a href="">MPI.jl</a>      <code>MPI</code> ,  <br> <a href="">DistributedArrays.jl</a>     . <br>       GPU,    : </p><br><ol><li>  (  C) <a href="">OpenCL.jl</a>  <a href="">CUDAdrv.jl</a>     OpenCL   CUDA. </li><li>  (  Julia)  <a href="">CUDAnative.jl</a>     CUDA . </li><li>  ,    ,   <a href="">CuArrays.jl</a>  <a href="">CLArrays.jl</a> </li><li>   ,   <a href="">ArrayFire.jl</a>  <a href="">GPUArrays.jl</a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="> -</a> </li><li>    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="> </a> </li><li>      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Kynseed</a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="> </a> </li></ol><br><p>  , , .    ! </p><br><p><img src="https://habrastorage.org/webt/f2/4o/pr/f24oprfnnrnguwwb03xcyo__xx4.gif"></p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id455846/">https://habr.com/ru/post/id455846/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id455832/index.html">Sejarah investigasi SQL tunggal</a></li>
<li><a href="../id455834/index.html">Tolok ukur untuk server Linux: 5 alat terbuka</a></li>
<li><a href="../id455840/index.html">Cara bekerja dengan beberapa kueri. Komposisi, Peredam, FP</a></li>
<li><a href="../id455842/index.html">Sebarkan daftar yang terhubung sendiri. Edisi cepat</a></li>
<li><a href="../id455844/index.html">Membuat penganalisis Roslyn menggunakan pengujian enkapsulasi sebagai contoh</a></li>
<li><a href="../id455848/index.html">Teknik untuk menghindari perilaku tidak terdefinisi saat mengakses singleton</a></li>
<li><a href="../id455850/index.html">Kotak Alat untuk Peneliti - Edisi Ketiga: Mencari dan Bekerja dengan Sumber</a></li>
<li><a href="../id455852/index.html">Pengangkatan sinus dan implantasi simultan</a></li>
<li><a href="../id455854/index.html">Bagaimana menerapkan Menu Konteks di iOS 13</a></li>
<li><a href="../id455856/index.html">Suhu nirkabel, kelembaban dan sensor tekanan atmosfer pada nRF52832</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>