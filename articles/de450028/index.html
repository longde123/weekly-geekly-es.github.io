<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üé• üè´ ‚úãüèº Aufbau einer serviceorientierten Architektur auf Schienen + Kafka üò≥ üôåüèº üê°</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hallo Habr! Ich pr√§sentiere Ihnen den Beitrag, der eine Textadaption der Leistung von Stella Cotton auf der RailsConf 2018 und eine √úbersetzung des Ar...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Aufbau einer serviceorientierten Architektur auf Schienen + Kafka</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/450028/">  Hallo Habr!  Ich pr√§sentiere Ihnen den Beitrag, der eine <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Textadaption</a> der Leistung von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Stella Cotton auf der RailsConf 2018</a> und eine √úbersetzung des Artikels <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">"Aufbau einer serviceorientierten Architektur mit Rails und Kafka"</a> von Stella Cotton ist. <br><br>  In j√ºngster Zeit ist der √úbergang von der monolithischen Architektur zu Mikrodiensten deutlich sichtbar.  In diesem Handbuch lernen wir die Grundlagen von Kafka kennen und wie ein ereignisgesteuerter Ansatz Ihre Rails-Anwendung verbessern kann.  Wir werden auch √ºber die Probleme der √úberwachung und Skalierbarkeit von Diensten sprechen, die durch einen ereignisorientierten Ansatz arbeiten. <br><a name="habracut"></a><br><h2>  Was ist Kafka? </h2><br>  Ich bin sicher, dass Sie Informationen dar√ºber haben m√∂chten, wie Ihre Benutzer zu Ihrer Plattform gekommen sind oder welche Seiten sie besuchen, auf welche Schaltfl√§chen sie klicken usw.  Eine wirklich beliebte Anwendung kann Milliarden von Ereignissen generieren und eine gro√üe Datenmenge an Analysedienste senden, was eine ernsthafte Herausforderung f√ºr Ihre Anwendung sein kann. <br><br>  Ein wesentlicher Bestandteil von Webanwendungen ist in der Regel der sogenannte <i>Echtzeitdatenfluss</i> .  Kafka bietet eine fehlertolerante Verbindung zwischen <b>Produzenten</b> , denen, die Ereignisse erzeugen, und <b>Verbrauchern</b> , denen, die diese Ereignisse erhalten.  Es kann sogar mehrere Hersteller und Verbraucher in einer Anwendung geben.  In Kafka existiert jedes Ereignis f√ºr eine bestimmte Zeit, sodass mehrere Verbraucher immer wieder dasselbe Ereignis lesen k√∂nnen.  Der Kafka-Cluster umfasst mehrere Broker, die Kafka-Instanzen sind. <br><br><img src="https://habrastorage.org/webt/ql/j1/uy/qlj1uyapeg_3fmswgflqauwmd7q.png"><br><br>  Ein wesentliches Merkmal von Kafka ist die hohe Geschwindigkeit der Ereignisverarbeitung.  Herk√∂mmliche Warteschlangensysteme wie AMQP verf√ºgen √ºber eine Infrastruktur, die die verarbeiteten Ereignisse f√ºr jeden Verbraucher √ºberwacht.  Wenn die Anzahl der Verbraucher auf ein anst√§ndiges Niveau ansteigt, beginnt das System kaum, mit der Last fertig zu werden, da es eine zunehmende Anzahl von Bedingungen √ºberwachen muss.  Es gibt auch gro√üe Probleme mit der Konsistenz zwischen Verbraucher- und Ereignisverarbeitung.  Lohnt es sich beispielsweise, eine Nachricht sofort als gesendet zu markieren, sobald sie vom System verarbeitet wird?  Und wenn ein Verbraucher am anderen Ende f√§llt, ohne eine Nachricht zu erhalten? <br><br>  Kafka hat auch eine ausfallsichere Architektur.  Das System wird als Cluster auf einem oder mehreren Servern ausgef√ºhrt, die durch Hinzuf√ºgen neuer Computer horizontal skaliert werden k√∂nnen.  Alle Daten werden auf die Festplatte geschrieben und an mehrere Broker kopiert.  Um die M√∂glichkeiten der Skalierbarkeit zu verstehen, sollten Sie sich Unternehmen wie Netflix, LinkedIn und Microsoft ansehen.  Alle senden t√§glich Billionen von Nachrichten √ºber ihre Kafka-Cluster! <br><br><h2>  Kafka in Rails einrichten </h2><br>  Heroku bietet ein <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Kafka-Cluster-Add-On</a> , das f√ºr jede Umgebung verwendet werden kann.  F√ºr <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Rubinanwendungen</a> empfehlen wir die Verwendung des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Rubin-Kafka-Edelsteins</a> .  Die minimale Implementierung sieht ungef√§hr so ‚Äã‚Äãaus: <br><br><pre><code class="ruby hljs"><span class="hljs-comment"><span class="hljs-comment"># config/initializers/kafka_producer.rb require "kafka" # Configure the Kafka client with the broker hosts and the Rails # logger. $kafka = Kafka.new(["kafka1:9092", "kafka2:9092"], logger: Rails.logger) # Set up an asynchronous producer that delivers its buffered messages # every ten seconds: $kafka_producer = $kafka.async_producer( delivery_interval: 10, ) # Make sure to shut down the producer when exiting. at_exit { $kafka_producer.shutdown }</span></span></code> </pre> <br>  Nach dem Konfigurieren der Konfiguration k√∂nnen Sie mit dem Gem Nachrichten senden.  Dank des asynchronen Sendens von Ereignissen k√∂nnen wir Nachrichten von √ºberall senden: <br><br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">OrdersController</span></span></span><span class="hljs-class"> &lt; ApplicationController </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">create</span></span></span><span class="hljs-class"> @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">comment</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Order</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">create!</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">params</span></span></span><span class="hljs-class">) $</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">kafka_producer</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">produce</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">order</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">to_json</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">topic</span></span></span><span class="hljs-class">: "</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">user_event</span></span></span><span class="hljs-class">", </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">partition_key</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">user</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">id</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span></span></code> </pre> <br>  Wir werden im Folgenden √ºber Serialisierungsformate sprechen, aber im Moment verwenden wir den guten alten JSON.  Das <code>topic</code> Argument bezieht sich auf das Protokoll, in das Kafka dieses Ereignis schreibt.  Die Themen sind in verschiedene Abschnitte unterteilt, sodass Sie die Daten f√ºr ein bestimmtes Thema f√ºr eine bessere Skalierbarkeit und Zuverl√§ssigkeit in verschiedene Broker aufteilen k√∂nnen.  Und es ist wirklich eine gute Idee, zwei oder mehr Abschnitte f√ºr jedes Thema zu haben, denn wenn einer der Abschnitte f√§llt, werden Ihre Ereignisse trotzdem aufgezeichnet und verarbeitet.  Kafka stellt sicher, dass Ereignisse in der Reihenfolge der Warteschlange innerhalb des Abschnitts, jedoch nicht innerhalb des gesamten Themas geliefert werden.  Wenn die Reihenfolge der Ereignisse wichtig ist, wird durch das Senden von partition_key sichergestellt, dass alle Ereignisse eines bestimmten Typs auf derselben Partition gespeichert werden. <br><br><h2>  Kafka f√ºr Ihre Dienste </h2><br>  Einige der Funktionen, die Kafka zu einem n√ºtzlichen Tool machen, machen es auch zu einem Failover-RPC zwischen Diensten.  Schauen Sie sich ein Beispiel f√ºr eine E-Commerce-Anwendung an: <br><br><pre> <code class="ruby hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">create_order</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">create_order_record</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">charge_credit_card</span></span></span><span class="hljs-function"> </span><span class="hljs-comment"><span class="hljs-function"><span class="hljs-comment"># call to Payments Service send_confirmation_email # call to Email Service end</span></span></span></span></code> </pre> <br>  Wenn der Benutzer eine Bestellung <code>create_order</code> , wird die Funktion <code>create_order</code> .  Dadurch wird eine Bestellung im System erstellt, Geld von der Karte abgezogen und eine E-Mail mit Best√§tigung gesendet.  Wie Sie sehen k√∂nnen, werden die letzten beiden Schritte in separaten Diensten ausgef√ºhrt. <br><br><img src="https://habrastorage.org/webt/i8/_y/tr/i8_ytruescd639f48vmelrmsfu4.png"><br><br>  Eines der Probleme bei diesem Ansatz besteht darin, dass der √ºbergeordnete Dienst in der Hierarchie f√ºr die √úberwachung der Verf√ºgbarkeit des nachgeschalteten Dienstes verantwortlich ist.  Wenn sich herausstellte, dass der Dienst zum Versenden von Briefen ein schlechter Tag war, muss der h√∂here Dienst dar√ºber Bescheid wissen.  Wenn der sendende Dienst nicht verf√ºgbar ist, m√ºssen Sie eine Reihe von Aktionen wiederholen.  Wie kann Kafka in dieser Situation helfen? <br><br>  Zum Beispiel: <br><br><img src="https://habrastorage.org/webt/i1/dh/a8/i1dha8zycj6ibxydaxja9y8bp10.png"><br><br>  Bei diesem ereignisgesteuerten Ansatz kann ein √ºbergeordneter Service ein Ereignis in Kafka aufzeichnen, bei dem ein Auftrag erstellt wurde.  Aufgrund des sogenannten <i>mindestens einmaligen</i> Ansatzes wird das Ereignis mindestens einmal in Kafka aufgezeichnet und steht den nachgeschalteten Verbrauchern zum Lesen zur Verf√ºgung.  Wenn der Dienst zum Senden von Briefen l√ºgt, wartet das Ereignis auf der Festplatte, bis der Verbraucher aufsteht und es liest. <br><br>  Ein weiteres Problem bei der RPC-orientierten Architektur besteht in schnell wachsenden Systemen: Das Hinzuf√ºgen eines neuen Downstream-Dienstes f√ºhrt zu √Ñnderungen im Upstream.  Beispielsweise m√∂chten Sie nach dem Erstellen einer Bestellung einen weiteren Schritt hinzuf√ºgen.  In einer ereignisgesteuerten Welt m√ºssen Sie einen weiteren Verbraucher hinzuf√ºgen, um einen neuen Ereignistyp zu verarbeiten. <br><br><img src="https://habrastorage.org/webt/ox/ic/ka/oxickaiivr5j6hey5fahjkcvsxc.png"><br><br><h2>  Integration von Ereignissen in serviceorientierte Architektur </h2><br>  In einem Beitrag mit dem Titel ‚Äû <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Was meinst du mit‚Äû ereignisgesteuert</a> ‚Äúvon Martin Fowler <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">?</a> ‚Äú Wird die Verwirrung um ereignisgesteuerte Anwendungen er√∂rtert.  Wenn Entwickler solche Systeme diskutieren, sprechen sie tats√§chlich √ºber eine gro√üe Anzahl verschiedener Anwendungen.  Um ein allgemeines Verst√§ndnis der Natur solcher Systeme zu vermitteln, definierte Fowler mehrere Architekturmuster. <br><br>  Werfen wir einen Blick auf diese Muster.  Wenn Sie mehr wissen m√∂chten, empfehle ich Ihnen, seinen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Bericht</a> auf der GOTO Chicago 2017 zu lesen. <br><br><h3>  Ereignisbenachrichtigung </h3><br>  Das erste Fowler-Muster hei√üt <i>Ereignisbenachrichtigung</i> .  In diesem Szenario benachrichtigt der Produzentendienst die Verbraucher √ºber das Ereignis mit einer Mindestmenge an Informationen: <br><br><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"event"</span></span>: <span class="hljs-string"><span class="hljs-string">"order_created"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"published_at"</span></span>: <span class="hljs-string"><span class="hljs-string">"2016-03-15T16:35:04Z"</span></span> }</code> </pre> <br>  Wenn Verbraucher weitere Informationen √ºber die Veranstaltung ben√∂tigen, stellen sie eine Anfrage an den Hersteller und erhalten weitere Daten. <br><br><h3>  Ereignis√ºbertragene Zustands√ºbertragung </h3><br>  Die zweite Vorlage hei√üt <i>Event-Carried State Transfer</i> .  In diesem Szenario stellt der Hersteller zus√§tzliche Informationen zum Ereignis bereit, und der Verbraucher kann eine Kopie dieser Daten speichern, ohne zus√§tzliche Anrufe zu t√§tigen: <br><br><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"event"</span></span>: <span class="hljs-string"><span class="hljs-string">"order_created"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"order"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"order_id"</span></span>: <span class="hljs-number"><span class="hljs-number">98765</span></span>, <span class="hljs-attr"><span class="hljs-attr">"size"</span></span>: <span class="hljs-string"><span class="hljs-string">"medium"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"color"</span></span>: <span class="hljs-string"><span class="hljs-string">"blue"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"published_at"</span></span>: <span class="hljs-string"><span class="hljs-string">"2016-03-15T16:35:04Z"</span></span> }</code> </pre> <br><h3>  Event-bezogen </h3><br>  Fowler nannte die dritte Vorlage <i>Event-Sourced</i> und sie ist eher architektonisch.  Die Freigabe der Vorlage beinhaltet nicht nur die Kommunikation zwischen Ihren Diensten, sondern auch die Wahrung der Pr√§sentation der Veranstaltung.  Auf diese Weise wird sichergestellt, dass Sie den Status der Anwendung auch dann wiederherstellen k√∂nnen, wenn Sie die Datenbank verlieren, indem Sie einfach den gespeicherten Ereignisstrom ausf√ºhren.  Mit anderen Worten, jedes Ereignis speichert einen bestimmten Status der Anwendung zu einem bestimmten Zeitpunkt. <br><br>  Das gro√üe Problem bei diesem Ansatz ist, dass sich der Anwendungscode immer √§ndert und sich damit das Format oder die Datenmenge, die der Hersteller angibt, √§ndern kann.  Dies macht das Wiederherstellen des Status der Anwendung problematisch. <br><br><h3>  Verantwortlichkeitstrennung f√ºr Befehlsabfragen </h3><br>  Die letzte Vorlage ist <i>Command Query Responsibility Segregation</i> (CQRS).  Die Idee ist, dass die Aktionen, die Sie auf das Objekt anwenden, z. B. Erstellen, Lesen, Aktualisieren, in verschiedene Dom√§nen unterteilt werden sollten.  Dies bedeutet, dass ein Dienst f√ºr die Erstellung, ein anderer f√ºr das Update usw. verantwortlich sein sollte.  In objektorientierten Systemen wird h√§ufig alles in einem Dienst gespeichert. <br><br><img src="https://habrastorage.org/webt/xb/5b/mx/xb5bmxasal6md3bq2xsdgnhfhgg.png"><br><br>  Ein Dienst, der in die Datenbank schreibt, liest den Ablauf von Ereignissen und verarbeitet Befehle.  Anforderungen treten jedoch nur in der schreibgesch√ºtzten Datenbank auf.  Die Aufteilung der Lese- und Schreiblogik in zwei verschiedene Dienste erh√∂ht die Komplexit√§t, erm√∂glicht es Ihnen jedoch, die Leistung f√ºr diese Systeme separat zu optimieren. <br><br><h2>  Die Probleme </h2><br>  Lassen Sie uns √ºber einige Probleme sprechen, die bei der Integration von Kafka in Ihre serviceorientierte Anwendung auftreten k√∂nnen. <br><br>  Das erste Problem k√∂nnten langsame Verbraucherprobleme sein.  In einem ereignisorientierten System sollten Ihre Dienste Ereignisse sofort verarbeiten k√∂nnen, wenn sie von einem √ºbergeordneten Dienst empfangen werden.  Andernfalls h√§ngen sie einfach ohne Benachrichtigungen √ºber das Problem oder Zeit√ºberschreitungen.  Der einzige Ort, an dem Sie Zeit√ºberschreitungen definieren k√∂nnen, ist eine Socket-Verbindung mit Kafka-Brokern.  Wenn der Dienst das Ereignis nicht schnell genug verarbeitet, kann die Verbindung durch eine Zeit√ºberschreitung unterbrochen werden. Die Wiederherstellung des Dienstes erfordert jedoch zus√§tzliche Zeit, da das Erstellen solcher Sockets teuer ist. <br><br>  Wie k√∂nnen Sie die Geschwindigkeit der Ereignisverarbeitung erh√∂hen, wenn der Verbraucher langsam ist?  In Kafka k√∂nnen Sie die Anzahl der Verbraucher in einer Gruppe erh√∂hen, sodass mehr Ereignisse parallel verarbeitet werden k√∂nnen.  F√ºr einen Service sind jedoch mindestens 2 Verbraucher erforderlich: Im Falle eines Sturzes k√∂nnen besch√§digte Abschnitte neu zugewiesen werden. <br><br>  Es ist auch sehr wichtig, Metriken und Warnungen zu haben, um die Geschwindigkeit der Ereignisverarbeitung zu √ºberwachen.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ruby-kafka</a> kann mit ActiveSupport-Warnungen arbeiten und verf√ºgt au√üerdem √ºber StatsD- und Datadog-Module, die standardm√§√üig aktiviert sind.  Dar√ºber hinaus enth√§lt das Juwel eine <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Liste</a> empfohlener Metriken f√ºr die √úberwachung. <br><br>  Ein weiterer wichtiger Aspekt beim Bauen von Systemen mit Kafka ist das Design von Verbrauchern, die in der Lage sind, Fehler zu behandeln.  Kafka wird garantiert mindestens einmal eine Veranstaltung senden.  schloss den Fall aus, dass die Nachricht √ºberhaupt nicht gesendet wurde.  Es ist jedoch wichtig, dass die Verbraucher auf wiederkehrende Ereignisse vorbereitet sind.  Eine M√∂glichkeit, dies zu tun, besteht darin, immer <code>UPSERT</code> zu verwenden, um der Datenbank neue Datens√§tze hinzuzuf√ºgen.  Wenn der Datensatz bereits mit denselben Attributen vorhanden ist, ist der Aufruf im Wesentlichen inaktiv.  Dar√ºber hinaus k√∂nnen Sie jedem Ereignis eine eindeutige Kennung hinzuf√ºgen und Ereignisse, die bereits zuvor verarbeitet wurden, einfach √ºberspringen. <br><br><h2>  Datenformate </h2><br>  Eine der √úberraschungen bei der Arbeit mit Kafka ist m√∂glicherweise die einfache Einstellung zum Datenformat.  Sie k√∂nnen alles in Bytes senden und die Daten werden ohne √úberpr√ºfung an den Verbraucher gesendet.  Einerseits bietet es Flexibilit√§t und erm√∂glicht es Ihnen, sich nicht um das Datenformat zu k√ºmmern.  Wenn der Hersteller hingegen beschlie√üt, die gesendeten Daten zu √§ndern, besteht die M√∂glichkeit, dass ein Verbraucher irgendwann kaputt geht. <br><br>  W√§hlen Sie vor dem Erstellen einer ereignisorientierten Architektur ein Datenformat aus und analysieren Sie, wie es in Zukunft helfen wird, Schemata zu registrieren und zu entwickeln. <br><br>  Eines der zur Verwendung empfohlenen Formate ist nat√ºrlich JSON.  Dieses Format ist f√ºr Menschen lesbar und wird von allen bekannten Programmiersprachen unterst√ºtzt.  Aber es gibt Fallstricke.  Beispielsweise kann die Gr√∂√üe der endg√ºltigen Daten in JSON erschreckend gro√ü werden.  Das Format ist erforderlich, um Schl√ºssel-Wert-Paare zu speichern, was flexibel genug ist, aber die Daten werden bei jedem Ereignis dupliziert.  Das √Ñndern des Schemas ist ebenfalls eine schwierige Aufgabe, da es keine integrierte Unterst√ºtzung f√ºr das √úberlagern eines Schl√ºssels mit einem anderen gibt, wenn Sie das Feld umbenennen m√ºssen. <br><br>  Das Team, das Kafka erstellt hat, ber√§t <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Avro</a> als Serialisierungssystem.  Daten werden in bin√§rer Form gesendet, und dies ist nicht das am besten lesbare Format, aber im Inneren gibt es eine zuverl√§ssigere Unterst√ºtzung f√ºr Schaltkreise.  Die letzte Entit√§t in Avro enth√§lt sowohl Schema als auch Daten.  Avro unterst√ºtzt sowohl einfache Typen wie Zahlen als auch komplexe Typen: Datumsangaben, Arrays usw. Dar√ºber hinaus k√∂nnen Sie Dokumentation in das Schema aufnehmen, wodurch Sie den Zweck eines bestimmten Felds im System verstehen und viele andere integrierte Tools f√ºr die Arbeit mit dem Schema enthalten. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">avro-builder</a> ist ein Juwel von Salsify, das ein rubinartiges DSL zum Erstellen von Schemas bietet.  Weitere <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Informationen zu</a> Avro finden Sie in <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">diesem Artikel</a> . <br><br><h2>  Weitere Informationen </h2><br>  Wenn Sie daran interessiert sind, wie Kafka gehostet wird oder wie es in Heroku verwendet wird, gibt es mehrere Berichte, die f√ºr Sie von Interesse sein k√∂nnen. <br><br>  Jeff Chao bei DataEngConf SF '17 ‚Äû <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Jenseits von 50.000 Partitionen: Wie Heroku arbeitet und die Grenzen von Kafka im Ma√üstab</a> √ºberschreitet‚Äú <br><br>  Pavel Pravosud auf der Dreamforce '16 <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">-Konferenz</a> ‚Äû <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Dogfooding Kafka: Wie wir Herokus Echtzeit-Plattform-Event-Stream aufgebaut haben</a> ‚Äú <br><br>  Sch√∂ne Aussicht! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de450028/">https://habr.com/ru/post/de450028/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de450016/index.html">Erstellung eines formalen Verifizierungssystems von Grund auf neu. Teil 1: Virtuelle Zeichenmaschine in PHP und Python</a></li>
<li><a href="../de450018/index.html">Ein Mathe-Duo kartierte ein endloses Gebiet mit minimalen Oberfl√§chen</a></li>
<li><a href="../de450020/index.html">Silicon Valley kam zu Schulkindern aus Kansas. Dies f√ºhrte zu Protesten.</a></li>
<li><a href="../de450024/index.html">Informationen zu Open-Source-Implementierungen der Hash-Funktion GOST R 34.11-2012 und deren Auswirkungen auf die elektronische Signatur von GOST R 34.10-2012</a></li>
<li><a href="../de450026/index.html">Beschleunigungsverschl√ºsselung: Wir untersuchen den Beschleunigungsmesser eines Android-Ger√§ts am Beispiel der Aufgabe NeoQUEST-2019</a></li>
<li><a href="../de450030/index.html">Ich kann Rift S nicht verwenden und Sie werden es auch nicht schaffen</a></li>
<li><a href="../de450032/index.html">So erstellen Sie ein dunkles Thema, ohne Dinge zu besch√§digen: Lernen Sie mit dem Yandex Mail-Team</a></li>
<li><a href="../de450034/index.html">Warum sollten Sie an Hackathons teilnehmen?</a></li>
<li><a href="../de450036/index.html">Summ3r 0f h4ck: Praktikum Digital Security 2019</a></li>
<li><a href="../de450040/index.html">Neues Unternehmen wird OpenJDK 8 und 11 unterst√ºtzen - wir verstehen die Situation</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>