<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®üèø‚Äçüåæ üèπ üí∏ √âmulation de litt√©raux de propri√©t√© avec la r√©f√©rence de m√©thode Java 8 üèóÔ∏è ü§±üèø üëºüèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="D'un traducteur: l'offense du manque d'op√©rateur nameOf en Java m'a pouss√© √† traduire cet article. Pour les impatients - √† la fin de l'article, il y a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>√âmulation de litt√©raux de propri√©t√© avec la r√©f√©rence de m√©thode Java 8</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/420533/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/rx/cy/ut/rxcyutfwkaqvjicfkhp78xtv_ts.png"></div><br>  <i>D'un traducteur: l'offense du manque d'op√©rateur nameOf en Java m'a pouss√© √† traduire cet article.</i>  <i>Pour les impatients - √† la fin de l'article, il y a une impl√©mentation pr√™te √† l'emploi dans les sources et les binaires.</i> <br><br>  Les litt√©raux de propri√©t√© manquent souvent aux d√©veloppeurs de biblioth√®ques en Java.  Dans cet article, je montrerai comment vous pouvez utiliser de mani√®re cr√©ative la r√©f√©rence de m√©thode de Java 8 pour √©muler des litt√©raux de propri√©t√© en utilisant la g√©n√©ration de bytecode. <br><br>  √Ä l'instar des litt√©raux de classe (par exemple, <code>Customer.class</code> ), les litt√©raux de propri√©t√© permettraient de faire r√©f√©rence aux propri√©t√©s des classes de bean en toute s√©curit√©.  Cela serait utile pour concevoir une API o√π il est n√©cessaire d'effectuer des actions sur les propri√©t√©s ou de les configurer d'une mani√®re ou d'une autre. <br><br>  <i>Du traducteur: Sous la coupe, nous analysons comment mettre en ≈ìuvre cela √† partir de moyens improvis√©s.</i> <br><a name="habracut"></a><br>  Par exemple, consid√©rez l'API de configuration de mappage d'index dans Hibernate Search: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SearchMapping().entity(Address.class) .indexed() .property(<span class="hljs-string"><span class="hljs-string">"city"</span></span>, ElementType.METHOD) .field();</code> </pre><br>  Ou la m√©thode <code>validateValue()</code> de l'API Bean Validation, qui vous permet de v√©rifier la valeur par rapport aux restrictions sur la propri√©t√©: <br><br><pre> <code class="java hljs">Set&lt;ConstraintViolation&lt;Address&gt;&gt; violations = validator.validateValue(Address.class, <span class="hljs-string"><span class="hljs-string">"city"</span></span>, <span class="hljs-string"><span class="hljs-string">"Purbeck"</span></span> );</code> </pre><br>  Dans les deux cas, le type <code>String</code> est utilis√© pour faire r√©f√©rence √† la propri√©t√© <code>city</code> de l'objet <code>Address</code> . <br><br>  Cela peut entra√Æner des erreurs: <br><ul><li>  la classe Address peut ne pas avoir du tout de propri√©t√© de <code>city</code> .  Ou, quelqu'un peut oublier de mettre √† jour le nom de cha√Æne de la propri√©t√© apr√®s avoir renomm√© les m√©thodes get / set lors de la refactorisation. </li><li>  dans le cas de <code>validateValue()</code> , nous n'avons aucun moyen de v√©rifier que le type de la valeur pass√©e correspond au type de la propri√©t√©. </li></ul><br>  Les utilisateurs de cette API ne peuvent conna√Ætre ces probl√®mes qu'en lan√ßant l'application.  Ne serait-ce pas cool si le compilateur et le syst√®me de type emp√™chaient une telle utilisation d√®s le d√©but?  Si Java avait des litt√©raux de propri√©t√©, nous pourrions le faire (ce code ne compile pas): <br><br><pre> <code class="java hljs">mapping.entity(Address.class) .indexed() .property(Address::city, ElementType.METHOD ) .field();</code> </pre><br>  Et: <br><br><pre> <code class="java hljs">validator.validateValue(Address.class, Address::city, <span class="hljs-string"><span class="hljs-string">"Purbeck"</span></span>);</code> </pre><br>  Nous pourrions √©viter les probl√®mes mentionn√©s ci-dessus: toute faute de frappe dans le nom de la propri√©t√© entra√Ænerait une erreur de compilation, qui peut √™tre remarqu√©e directement dans votre IDE.  Cela nous permettrait de concevoir l'API de configuration Hibernate Search de sorte qu'elle n'accepte les propri√©t√©s de la classe Address que lorsque nous configurons l'entit√© Address.  Et dans le cas de Bean Validation <code>validateValue()</code> les litt√©raux de propri√©t√© permettraient de s'assurer que nous transmettons une valeur du type correct. <br><br><h2>  R√©f√©rence des m√©thodes Java 8 </h2><br>  Java 8 ne prend pas en charge les litt√©raux de propri√©t√© (et il n'est pas pr√©vu de les prendre en charge dans Java 11), mais en m√™me temps, il fournit un moyen int√©ressant de les √©muler: R√©f√©rence de m√©thode (r√©f√©rence de m√©thode).  Initialement, la r√©f√©rence de m√©thode a √©t√© ajout√©e pour simplifier le travail avec les expressions lambda, mais elles peuvent √™tre utilis√©es comme litt√©raux de propri√©t√© pour les pauvres. <br><br>  Consid√©rez l'id√©e d'utiliser une r√©f√©rence √† la m√©thode getter comme litt√©ral de propri√©t√©: <br><br><pre> <code class="java hljs">validator.validateValue(Address.class, Address::getCity, <span class="hljs-string"><span class="hljs-string">"Purbeck"</span></span>);</code> </pre><br>  De toute √©vidence, cela ne fonctionnera que si vous avez un getter.  Mais si vos classes suivent d√©j√† la convention JavaBeans, ce qui est le plus souvent le cas, alors √ßa va. <br><br>  √Ä quoi ressemblerait une d√©claration de la m√©thode <code>validateValue()</code> ?  Le point cl√© est l'utilisation du nouveau type de <code>Function</code> : <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> &lt;T, P&gt; Set&lt;ConstraintViolation&lt;T&gt;&gt; validateValue( Class&lt;T&gt; type, Function&lt;? <span class="hljs-keyword"><span class="hljs-keyword">super</span></span> T, P&gt; property, P value);</code> </pre><br>  En utilisant deux param√®tres de frappe, nous pouvons v√©rifier que le type de bac, les propri√©t√©s et la valeur transmise sont corrects.  Du point de vue de l'API, nous avons obtenu ce dont nous avons besoin: il est s√ªr √† utiliser et l'EDI compl√©tera m√™me automatiquement les noms de m√©thode commen√ßant par <code>Address::</code> .  Mais comment d√©river le nom de la propri√©t√© de l'objet <code>Function</code> dans l'impl√©mentation de la m√©thode <code>validateValue()</code> ? <br><br>  Et puis le plaisir commence, puisque l'interface fonctionnelle Function ne d√©clare qu'une seule m√©thode - <code>apply()</code> , qui ex√©cute le code de fonction pour l'instance <code>T</code> pass√©e.  Cela ne semble pas √™tre ce dont nous avions besoin. <br><br><h2>  ByteBuddy √† la rescousse </h2><br>  En fait, l'astuce consiste √† appliquer la fonction!  En cr√©ant une instance proxy de type T, nous avons pour objectif d'appeler la m√©thode et d'obtenir son nom dans le gestionnaire d'appels proxy.  (Du traducteur: ci-apr√®s, nous parlons de proxys Java dynamiques - java.lang.reflect.Proxy). <br><br>  Java prend en charge les proxys dynamiques pr√™ts √† l'emploi, mais cette prise en charge est limit√©e uniquement aux interfaces.  √âtant donn√© que notre API devrait fonctionner avec tous les beans, y compris les classes r√©elles, je vais utiliser un excellent outil, ByteBuddy, au lieu de Proxy.  ByteBuddy fournit un DSL simple pour cr√©er des classes √† la vol√©e, ce dont nous avons besoin. <br><br>  Commen√ßons par d√©finir une interface qui nous permettrait de stocker et de r√©cup√©rer le nom de propri√©t√© extrait de la r√©f√©rence de m√©thode. <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PropertyNameCapturer</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-function">String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getPropertyName</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setPropertyName</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String propertyName)</span></span></span></span>; }</code> </pre> <br>  Maintenant, nous utilisons ByteBuddy pour cr√©er par programme des classes proxy qui sont compatibles avec les types qui nous int√©ressent (par exemple: Adresse) et impl√©menter <code>PropertyNameCapturer</code> : <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> &lt;T&gt; T <span class="hljs-comment"><span class="hljs-comment">/* &amp; PropertyNameCapturer */</span></span> getPropertyNameCapturer(Class&lt;T&gt; type) { DynamicType.Builder&lt;?&gt; builder = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ByteBuddy() (<span class="hljs-number"><span class="hljs-number">1</span></span>) .subclass( type.isInterface() ? Object.class : type ); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (type.isInterface()) { (<span class="hljs-number"><span class="hljs-number">2</span></span>) builder = builder.implement(type); } Class&lt;?&gt; proxyType = builder .implement(PropertyNameCapturer.class) (<span class="hljs-number"><span class="hljs-number">3</span></span>) .defineField(<span class="hljs-string"><span class="hljs-string">"propertyName"</span></span>, String.class, Visibility.PRIVATE) .method( ElementMatchers.any()) (<span class="hljs-number"><span class="hljs-number">4</span></span>) .intercept(MethodDelegation.to( PropertyNameCapturingInterceptor.class )) .method(named(<span class="hljs-string"><span class="hljs-string">"setPropertyName"</span></span>).or(named(<span class="hljs-string"><span class="hljs-string">"getPropertyName"</span></span>))) (<span class="hljs-number"><span class="hljs-number">5</span></span>) .intercept(FieldAccessor.ofBeanProperty()) .make() .load( (<span class="hljs-number"><span class="hljs-number">6</span></span>) PropertyNameCapturer.class.getClassLoader(), ClassLoadingStrategy.Default.WRAPPER ) .getLoaded(); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-meta"><span class="hljs-meta">@SuppressWarnings</span></span>(<span class="hljs-string"><span class="hljs-string">"unchecked"</span></span>) Class&lt;T&gt; typed = (Class&lt;T&gt;) proxyType; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> typed.newInstance(); (<span class="hljs-number"><span class="hljs-number">7</span></span>) } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (InstantiationException | IllegalAccessException e) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HibernateException( <span class="hljs-string"><span class="hljs-string">"Couldn't instantiate proxy for method name retrieval"</span></span>, e ); } }</code> </pre><br>  Le code peut sembler un peu d√©routant, alors laissez-moi vous l'expliquer.  Nous obtenons d'abord une instance de ByteBuddy (1), qui est le point d'entr√©e DSL.  Il est utilis√© pour cr√©er des types dynamiques qui √©tendent le type souhait√© (s'il s'agit d'une classe) ou h√©ritent Object et impl√©mentent le type souhait√© (s'il s'agit d'une interface) (2). <br><br>  Ensuite, nous indiquons que le type impl√©mente l'interface PropertyNameCapturer et ajoutons un champ pour stocker le nom de la propri√©t√© souhait√©e (3).  Ensuite, nous disons que les appels √† toutes les m√©thodes doivent √™tre intercept√©s par PropertyNameCapturingInterceptor (4).  Seuls setPropertyName () et getPropertyName () (√† partir de l'interface PropertyNameCapturer) doivent acc√©der √† la propri√©t√© r√©elle cr√©√©e pr√©c√©demment (5).  Enfin, la classe est cr√©√©e, charg√©e (6) et instanci√©e (7). <br><br>  C'est tout ce dont nous avons besoin pour cr√©er des types de proxy, merci ByteBuddy, cela peut √™tre fait en quelques lignes de code.  Voyons maintenant l'intercepteur d'appel: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PropertyNameCapturingInterceptor</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@RuntimeType</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> Object </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">intercept</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(@This PropertyNameCapturer capturer, @Origin Method method)</span></span></span><span class="hljs-function"> </span></span>{ (<span class="hljs-number"><span class="hljs-number">1</span></span>) capturer.setPropertyName(getPropertyName(method)); (<span class="hljs-number"><span class="hljs-number">2</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (method.getReturnType() == <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>.class) { (<span class="hljs-number"><span class="hljs-number">3</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>) <span class="hljs-number"><span class="hljs-number">0</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( ... ) { } <span class="hljs-comment"><span class="hljs-comment">// ... handle all primitve types // ... } else { return null; } } private static String getPropertyName(Method method) { (4) final boolean hasGetterSignature = method.getParameterTypes().length == 0 &amp;&amp; method.getReturnType() != null; String name = method.getName(); String propName = null; if (hasGetterSignature) { if (name.startsWith("get") &amp;&amp; hasGetterSignature) { propName = name.substring(3, 4).toLowerCase() + name.substring(4); } else if (name.startsWith("is") &amp;&amp; hasGetterSignature) { propName = name.substring(2, 3).toLowerCase() + name.substring(3); } } else { throw new HibernateException( "Only property getter methods are expected to be passed"); (5) } return propName; } }</span></span></code> </pre><br>  La m√©thode intercept () accepte la m√©thode appel√©e et la cible de l'appel (1).  Les <code>@This</code> <code>@Origin</code> et <code>@This</code> sont utilis√©es pour sp√©cifier les param√®tres appropri√©s afin que ByteBuddy puisse g√©n√©rer les appels intercept () corrects dans un proxy dynamique. <br><br>  Notez qu'il n'y a pas de d√©pendance stricte du r√©cepteur sur les types ByteBuddy, puisque ByteBuddy est utilis√© uniquement pour cr√©er un proxy dynamique, mais pas lors de son utilisation. <br><br>  En appelant <code>getPropertyName()</code> (4), nous pouvons obtenir le nom de propri√©t√© correspondant √† la r√©f√©rence de m√©thode pass√©e et l'enregistrer dans <code>PropertyNameCapturer</code> (2).  Si la m√©thode n'est pas un getter, le code l√®ve une exception (5).  Le type de retour du getter n'a pas d'importance, nous retournons donc null en consid√©rant le type de propri√©t√© (3). <br><br>  Nous sommes maintenant pr√™ts √† obtenir le nom de la propri√©t√© dans la m√©thode <code>validateValue()</code> : <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> &lt;T, P&gt; Set&lt;ConstraintViolation&lt;T&gt;&gt; validateValue( Class&lt;T&gt; type, Function&lt;? <span class="hljs-keyword"><span class="hljs-keyword">super</span></span> T, P&gt; property, P value) { T capturer = getPropertyNameCapturer(type); property.apply(capturer); String propertyName = ((PropertyLiteralCapturer) capturer).getPropertyName(); <span class="hljs-comment"><span class="hljs-comment">//      }</span></span></code> </pre><br>  Apr√®s avoir appliqu√© la fonction au proxy cr√©√©, nous convertissons le type en PropertyNameCapturer et obtenons le nom de Method. <br><br>  Ainsi, en utilisant une partie de la magie de la g√©n√©ration de bytecode, nous avons utilis√© la r√©f√©rence de m√©thode de Java 8 pour √©muler les litt√©raux de propri√©t√©. <br><br>  Bien s√ªr, si nous avions des litt√©raux immobiliers dans la langue, nous serions tous mieux lotis.  Je permettrais m√™me de travailler avec des propri√©t√©s priv√©es et, probablement, les propri√©t√©s pourraient √™tre r√©f√©renc√©es √† partir d'annotations.  Les litt√©raux des biens immobiliers seraient plus ordonn√©s (sans le pr√©fixe "get") et ne ressembleraient pas √† un hack. <br><br><h2>  Du traducteur </h2><br>  Il convient de noter que d'autres bonnes langues prennent d√©j√† en charge (ou presque) un m√©canisme similaire: <br><br><ul><li>  C # - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">instruction nameOf</a> </li><li>  Groovy et Scala - il existe des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">hacks et des macros de m√©taprogrammation</a> bien connus </li><li>  Kotlin - il existe une syntaxe normale <code>User::login.name</code> </li></ul><br>  Si vous utilisez soudainement le projet Lombok avec Java, un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">g√©n√©rateur de temps de compilation de bytecode est</a> √©crit pour cela. <br><br>  Inspir√© par l'approche d√©crite dans l'article, votre humble serviteur a cr√©√© une petite biblioth√®que qui impl√©mente nameOfProperty () pour Java 8: <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Code source</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Binaires</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr420533/">https://habr.com/ru/post/fr420533/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr420521/index.html">Maintenant officiellement: TLS 1.3 reconnu comme standard</a></li>
<li><a href="../fr420523/index.html">Analyse des graphiques d'options binaires ou comment je me suis encore une fois prouv√© que les cadeaux n'existent pas</a></li>
<li><a href="../fr420525/index.html">Des r√©seaux pour les plus aguerris. Quinzi√®me partie. QoS</a></li>
<li><a href="../fr420527/index.html">Un sourire peut retentir et c'est contagieux</a></li>
<li><a href="../fr420529/index.html">Utilisation avanc√©e de Geeta ou comment prendre sa retraite six mois plus t√¥t?</a></li>
<li><a href="../fr420537/index.html">Un autre conte sur la fa√ßon dont l'argent est relativement honn√™tement pris sur un m√©gaphone</a></li>
<li><a href="../fr420539/index.html">Approche personnalis√©e pour normaliser et r√©initialiser les styles (custom-reset.css)</a></li>
<li><a href="../fr420541/index.html">Les chercheurs de Carnegie Mellon ont cr√©√© les ¬´deepfakes¬ª les plus cr√©dibles</a></li>
<li><a href="../fr420547/index.html">Comme j'ai √©crit et d√©fendu un dipl√¥me en DEVOPS et en ing√©nierie en 1C √† partir de z√©ro</a></li>
<li><a href="../fr420549/index.html">Mod√®les FreeMarker</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>