<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üõÄüèΩ üôéüèº üêæ Ext JS en el servidor üêñ üë®üèø‚Äçüîß üìî</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Cuando se trata de la biblioteca Ext JS, los expertos han escuchado mucha negatividad: pesada, costosa, con errores. Como regla general, la mayor√≠a de...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Ext JS en el servidor</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/431180/"><img src="https://habrastorage.org/webt/wl/0h/yu/wl0hyunbvr2q-wqwydwamsfk804.png" width="250" align="left" alt="foto de aqu√≠ https://github.com/tj/palette">  Cuando se trata de la biblioteca Ext JS, los expertos han escuchado mucha negatividad: pesada, costosa, con errores.  Como regla general, la mayor√≠a de los problemas est√°n relacionados con la incapacidad para cocinarlo.  Un proyecto correctamente ensamblado que utiliza Sencha Cmd con todos los css, las im√°genes pesan en producci√≥n en la regi√≥n de 1Mb, que es comparable al mismo Angular.  S√≠, y los problemas t√©cnicos no son mucho m√°s ... <br><br>  La creaci√≥n de Sencha puede ser tratada de manera diferente, pero incluso sus oponentes de principios admiten que es dif√≠cil encontrar la mejor soluci√≥n para construir proyectos serios de intranet. <br><br>  En mi opini√≥n, lo m√°s valioso en Ext JS no es una colecci√≥n de componentes de la interfaz de usuario, sino m√°s bien una buena arquitectura OOP.  Incluso teniendo en cuenta el r√°pido desarrollo de JS en los √∫ltimos a√±os, muchas de las cosas necesarias que se implementaron en Ext JS hace 7 a√±os todav√≠a faltan en las clases nativas (espacios de nombres, mixins, propiedades est√°ticas, llamadas convenientes de m√©todos principales).  Esto es lo que me impuls√≥ hace unos a√±os a experimentar con el lanzamiento de las clases Ext JS en el back-end.  Sobre los primeros experimentos similares ya hice publicaciones en Habr√©.  Este art√≠culo describe una nueva implementaci√≥n de ideas antiguas y varias nuevas. <br><br>  Antes de comenzar, preste atenci√≥n a la pregunta: ¬øqu√© piensa, d√≥nde se ejecuta y qu√© hace el fragmento de c√≥digo a continuaci√≥n? <br><br><pre><code class="javascript hljs">Ext.define(<span class="hljs-string"><span class="hljs-string">'Module.message.model.Message'</span></span>, { .... <span class="hljs-comment"><span class="hljs-comment">/* scope:server */</span></span> ,<span class="hljs-keyword"><span class="hljs-keyword">async</span></span> newMessage() { ......... this.fireEvent(<span class="hljs-string"><span class="hljs-string">'newmessage'</span></span>, data); ...... } ... })</code> </pre> <a name="habracut"></a><br>  Este c√≥digo se ejecuta en el servidor y provoca el evento "newmessage" en todas las instancias de la clase "Module.message.model.Message" en todas las m√°quinas cliente conectadas al servidor. <br><br>  Para ilustrar las posibilidades de usar Ext JS del lado del servidor, analizaremos un proyecto de chat simple.  No haremos ning√∫n inicio de sesi√≥n, solo cuando ingresa el usuario ingresa un apodo.  Puede publicar mensajes generales o privados.  El chat deber√≠a funcionar en tiempo real.  Aquellos que lo deseen pueden probar de inmediato toda esta econom√≠a en los negocios. <br><br><h2>  Instalaci√≥n </h2><br>  Para comenzar, necesitamos nodejs 9+ y redis-server (se supone que ya est√°n instalados). <br><br><pre> <code class="bash hljs">git <span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> https://github.com/Kolbaskin/extjs-backend-example <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> extjs-backend-example npm i</code> </pre><br>  Iniciamos el servidor: <br><br><pre> <code class="bash hljs">node server</code> </pre><br>  En el navegador, abra la p√°gina <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">localhost</a> : 3000 / www / auth / <br>  Ingrese un apodo y presione enter. <br><br>  El proyecto es una demostraci√≥n, por lo que no hay soporte para navegadores antiguos (hay dise√±os ES8), use el nuevo Chrome o FF. <br><br><h2>  Servidor </h2><br>  Vamos en orden. <br><br>  C√≥digo de servidor (server.js) <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//   http-  express //   Ext JS     express const express = require('express'); const staticSrv = require('extjs-express-static'); const app = express(); const bodyParser = require('body-parser'); //    global = { config: require('config') } //     Ext JS require('extjs-on-backend')({ //     express app, //         wsClient: 'Base.wsClient' }); //    Ext.Loader.setPath('Api', 'protected/rest'); Ext.Loader.setPath('Base', 'protected/base'); Ext.Loader.setPath('Www', 'protected/www'); //   http   app.use( bodyParser.json() ); app.use(bodyParser.urlencoded({ extended: true })); //     Ext JS  app.use('/api/auth', Ext.create('Api.auth.Main')); app.use('/www/auth', Ext.create('Www.login.controller.Login')); //    app.use(staticSrv(__dirname + '/static')); //   const server = app.listen(3000, () =&gt; { console.log('server is running at %s', server.address().port); });</span></span></code> </pre><br>  Como puede ver, aqu√≠ todo es m√°s o menos est√°ndar para el servidor en express.  De inter√©s es la inclusi√≥n de clases Ext JS para servir las rutas correspondientes: <br><br><pre> <code class="javascript hljs">app.use(<span class="hljs-string"><span class="hljs-string">'/api/auth'</span></span>, Ext.create(<span class="hljs-string"><span class="hljs-string">'Api.auth.Main'</span></span>)); app.use(<span class="hljs-string"><span class="hljs-string">'/www/auth'</span></span>, Ext.create(<span class="hljs-string"><span class="hljs-string">'Www.login.controller.Login'</span></span>));</code> </pre><br><h3>  Implementaci√≥n de API REST </h3><br>  La clase Api.auth.Main atiende solicitudes a la API REST (protegido / rest / auth / Main.js). <br><br><pre> <code class="javascript hljs">Ext.define(<span class="hljs-string"><span class="hljs-string">'Api.auth.Main'</span></span>, { <span class="hljs-attr"><span class="hljs-attr">extend</span></span>: <span class="hljs-string"><span class="hljs-string">'Api.Base'</span></span>, <span class="hljs-comment"><span class="hljs-comment">//   //     routes: [ { path: '/', get: 'login'}, { path: '/restore', post: 'restoreLogin' }, { path: '/registration', post: 'newuser'}, { path: '/users', get: 'allUsers'} ] //     : // {query: &lt;...&gt;, params: &lt;...&gt;, body: &lt;...&gt;} ,async login(data) { return {data:[{ id:1, subject: 111, sender:222, }]} } ,async restoreLogin() { ... } ,async newuser() { ... } ,async allUsers() { .... } })</span></span></code> </pre><br><h3>  Generaci√≥n de p√°ginas HTML, usando XTemplate en el servidor </h3><br>  La segunda clase, Www.login.controller.Login, crea una p√°gina html normal con un formulario de inicio de sesi√≥n (protegido / www / login / controller / Login.js). <br><br><pre> <code class="javascript hljs">Ext.define(<span class="hljs-string"><span class="hljs-string">'Www.login.controller.Login'</span></span>, { <span class="hljs-comment"><span class="hljs-comment">//      "" : // ,    .. extend: 'Www.Base' //    //   ,   .. ,baseTpl: 'view/inner' //     // ,   ,loginFormTpl: 'login/view/login' //  ,routes: [ { path: '/', get: 'loginForm', post: 'doLogin'} ] //  html   //       ,async loginForm () { return await this.tpl(this.loginFormTpl, { pageTitle: 'Login page', date: new Date() }); } ,async doLogin (params, res) { if(params.body.name &amp;&amp; /^[a-z0-9]{2,10}$/i.test(params.body.name)) { this.redirect(`/index.html?name=${params.body.name}`, res); return; } return await this.tpl(this.loginFormTpl, { pageTitle: 'Login page', date: new Date() }); } })</span></span></code> </pre><br>  Las plantillas usan el XTemplate est√°ndar (protegido / www / login / view / login.tpl) <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h2</span></span></span><span class="hljs-tag">&gt;</span></span>{pageTitle} (date: {[Ext.Date.format(values.date,'dmY')]})<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h2</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">method</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"post"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"name"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">placeholder</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"name"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"submit"</span></span></span><span class="hljs-tag">&gt;</span></span>enter<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Todo lo descrito anteriormente es un conjunto completamente est√°ndar, dir√° un lector meticuloso, y para esto no hubo necesidad de cercar este jard√≠n con la transferencia de Ext JS al servidor.  Por lo tanto, pasamos a la segunda parte del art√≠culo, que mostrar√° para qu√© fue todo. <br><br><h2>  Cliente </h2><br>  Creemos la aplicaci√≥n Ext JS de cliente habitual en el directorio est√°tico.  En este ejemplo, deliberadamente no considero el uso de cmd, tom√© el tema est√°ndar y ext-all ya construido.  Los problemas de ensamblaje son un tema separado, que, quiz√°s, dedicar√° una publicaci√≥n separada. <br><br>  Todo comienza con app.js <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//   Ext.Loader.setConfig({ enabled: true, paths: { "Core": "app/core", "Admin": "app/admin", "Module": "app/admin/modules", "Ext.ux": "ext/ux" } }); //    this.token = Ext.data.identifier.Uuid.createRandom()(); //      //    () //    (   ) Ext.WS = Ext.create('Core.WSocket', { token: this.token, user: new URLSearchParams(document.location.search).get("name") }); //   Ext.application({ name: 'Example', extend: 'Ext.app.Application', requires: ['Admin.*'], autoCreateViewport: 'Admin.view.Viewport' })</span></span></code> </pre><br>  La presencia de un socket web es un punto crucial, es el que le permite implementar toda la magia que se describe a continuaci√≥n. <br><br>  El dise√±o de los elementos en la p√°gina est√° contenido en la clase Admin.view.Viewport (static / app / view / Viewport.js).  Nada interesante all√≠. <br><br>  Los principales elementos funcionales (lista de usuarios, barra de mensajes y formulario de env√≠o) se implementan como m√≥dulos separados. <br><br><h3>  Lista de usuarios </h3><br>  El algoritmo simple de esta lista es el siguiente: en el momento de abrir la p√°gina, los usuarios actuales se cargan desde el servidor.  Cuando se conectan nuevos usuarios, el servidor genera un evento "agregar" en la clase "Module.users.model.UserModel", cuando se desconecta, en la misma clase, se genera el evento "eliminar".  La cuesti√≥n es que el evento se desencadena en el lado del servidor y puede realizar un seguimiento en el cliente. <br><br>  Ahora, lo primero es lo primero.  En el lado del cliente, Store hace malabares con los datos (static / app / modules / users / store / UsersStore.js) <br><br><pre> <code class="javascript hljs">Ext.define(<span class="hljs-string"><span class="hljs-string">'Module.users.store.UsersStore'</span></span>, { <span class="hljs-attr"><span class="hljs-attr">extend</span></span>: <span class="hljs-string"><span class="hljs-string">'Ext.data.Store'</span></span> ,<span class="hljs-attr"><span class="hljs-attr">autoLoad</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> ,<span class="hljs-attr"><span class="hljs-attr">total</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span> ,<span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>() { <span class="hljs-comment"><span class="hljs-comment">//         this.dataModel = Ext.create('Module.users.model.UserModel'); //      this.dataModel.on({ add: (records) =&gt; { this.onDataAdd(records) }, remove: (records) =&gt; { this.onDataRemove(records) } }) this.callParent(arguments) } //   load ,async load() { //      const data = await this.dataModel.$read(); //   this.total = data.total; //    UI this.loadData(data.data); } ,getTotalCount() { return this.total; } //          ,onDataAdd(records) { this.add(records[0]); } //   --  ,onDataRemove(records) { this.remove(this.getById (records[0].id)) } });</span></span></code> </pre><br>  Hay 2 puntos interesantes.  En primer lugar, en la l√≠nea "const data = await this.dataModel. $ Read ();"  Se llama al m√©todo de servidor del modelo.  Ahora no necesita usar Ajax, protocolos de soporte, etc., simplemente llame al m√©todo del servidor como local.  Al mismo tiempo, no se sacrifica la seguridad (m√°s sobre eso a continuaci√≥n). <br><br>  En segundo lugar, la construcci√≥n est√°ndar de this.dataModel.on (...) le permite realizar un seguimiento de los eventos que generar√° el servidor. <br><br>  El modelo es un puente entre las partes cliente y servidor de la aplicaci√≥n.  Es como el dualismo de la luz: implementa las propiedades tanto del frontend como del backend.  Miremos el modelo con cuidado. <br><br><pre> <code class="javascript hljs">Ext.define(<span class="hljs-string"><span class="hljs-string">'Module.users.model.UserModel'</span></span>, { <span class="hljs-attr"><span class="hljs-attr">extend</span></span>: <span class="hljs-string"><span class="hljs-string">'Core.data.DataModel'</span></span> <span class="hljs-comment"><span class="hljs-comment">/* scope:client */</span></span> ,testClientMethod() { ... } ,testGlobalMethod() { ... } <span class="hljs-comment"><span class="hljs-comment">/* scope:server */</span></span> ,privateServerMethod() { .... } <span class="hljs-comment"><span class="hljs-comment">/* scope:server */</span></span> ,<span class="hljs-keyword"><span class="hljs-keyword">async</span></span> $read(params) { <span class="hljs-comment"><span class="hljs-comment">//      redis const keys = await this.getMemKeys('client:*'); let data = [], name; for(let i = 0;i&lt;keys.length;i++) { //         name = await this.getMemKey(keys[i]); if(name) { data.push({ id: keys[i].substr(7), name }) } } //    return { total: data.length, data } } })</span></span></code> </pre><br>  Preste atenci√≥n a los comentarios / * alcance: servidor * / y / * alcance: cliente * / - estas construcciones son etiquetas para el servidor por las cuales determina el tipo de m√©todo. <br><br>  testClientMethod: este m√©todo se ejecuta exclusivamente en el cliente y solo est√° disponible en el lado del cliente. <br>  testGlobalMethod: este m√©todo se ejecuta en el cliente y en el servidor y est√° disponible para su uso en el lado del cliente y del servidor. <br>  privateServerMethod: el m√©todo se ejecuta en el servidor y est√° disponible para llamar solo en el servidor. <br>  $ read es el tipo de m√©todo m√°s interesante que se ejecuta solo en el lado del servidor, pero puede llamarlo tanto en el cliente como en el servidor.  El prefijo $ hace que cualquier m√©todo del lado del servidor est√© disponible en el lado del cliente. <br><br>  Puede rastrear la conexi√≥n y desconexi√≥n del cliente utilizando un socket web.  Se crea una instancia de la clase Base.wsClient para cada conexi√≥n de usuario (protected / base / wsClient.js) <br><br><pre> <code class="javascript hljs">Ext.define(<span class="hljs-string"><span class="hljs-string">'Base.wsClient'</span></span>, { <span class="hljs-attr"><span class="hljs-attr">extend</span></span>: <span class="hljs-string"><span class="hljs-string">'Core.WsClient'</span></span> <span class="hljs-comment"><span class="hljs-comment">//      ,usersModel: Ext.create('Module.users.model.UserModel') //       ,async onStart() { //   "add"    this.usersModel.fireEvent('add', 'all', [{id: this.token, name: this.req.query.user}]); //     redis await this.setMemKey(`client:${this.token}`, this.req.query.user || ''); //   ""      , //     await this.queueProcess(`client:${this.token}`, async (data, done) =&gt; { const res = await this.prepareClientEvents(data); done(res); }) } //      ,onClose() { //   "remove"    this.usersModel.fireEvent('remove', 'all', [{id: this.token, name: this.req.query.user}]) this.callParent(arguments); } })</span></span></code> </pre><br>  El m√©todo fireEvent, a diferencia del est√°ndar, tiene un par√°metro adicional, donde se pasa en qu√© cliente se debe activar el evento.  Es aceptable pasar un √∫nico identificador de cliente, una matriz de identificadores o la cadena "todos".  En el √∫ltimo caso, el evento se activar√° en todos los clientes conectados.  De lo contrario, este es un evento fireEvent est√°ndar. <br><br><h3>  Enviar y recibir mensajes </h3><br>  El controlador de formulario (static / app / admin / modules / messages / view / FormController.js) es responsable de enviar los mensajes. <br><br><pre> <code class="javascript hljs">Ext.define(<span class="hljs-string"><span class="hljs-string">'Module.messages.view.FormController'</span></span>, { <span class="hljs-attr"><span class="hljs-attr">extend</span></span>: <span class="hljs-string"><span class="hljs-string">'Ext.app.ViewController'</span></span> ,init(view) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.view = view; <span class="hljs-comment"><span class="hljs-comment">//     this.model = Ext.create('Module.messages.model.Model'); //      this.msgEl = this.view.down('[name=message]'); //     this.usersGrid = Ext.getCmp('users-grid') //    "" this.control({ '[action=submit]' : {click: () =&gt; {this.newMessage() }} }) } //     ,newMessage() { let users = []; //     const sel = this.usersGrid.getSelection(); if(sel &amp;&amp; sel.length) { sel.forEach((s) =&gt; { users.push(s.data.id) }) } //        if(users.length &amp;&amp; users.indexOf(Ext.WS.token) == -1) users.push(Ext.WS.token); //       this.model.$newmessage({ to: users, user: Ext.WS.user, message: this.msgEl.getValue() }) //    this.msgEl.setValue(''); } });</span></span></code> </pre><br>  El mensaje no se guarda en ning√∫n lugar del servidor, simplemente se activa el evento "newmessage".  De inter√©s es la llamada "this.fireEvent ('newmessage', data.to, msg);", donde los identificadores del cliente se pasan como destinatarios del mensaje.  Por lo tanto, se implementa la distribuci√≥n de mensajes privados (static / app / admin / modules / messages / model / Model.js). <br><br><pre> <code class="javascript hljs">Ext.define(<span class="hljs-string"><span class="hljs-string">'Module.messages.model.Model'</span></span>, { <span class="hljs-attr"><span class="hljs-attr">extend</span></span>: <span class="hljs-string"><span class="hljs-string">'Core.data.DataModel'</span></span> <span class="hljs-comment"><span class="hljs-comment">/* scope:server */</span></span> ,<span class="hljs-keyword"><span class="hljs-keyword">async</span></span> $newmessage(data) { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> msg = { <span class="hljs-attr"><span class="hljs-attr">user</span></span>: data.user, <span class="hljs-attr"><span class="hljs-attr">message</span></span>: data.message } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(data.to &amp;&amp; Ext.isArray(data.to) &amp;&amp; data.to.length) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.fireEvent(<span class="hljs-string"><span class="hljs-string">'newmessage'</span></span>, data.to, msg); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.fireEvent(<span class="hljs-string"><span class="hljs-string">'newmessage'</span></span>, <span class="hljs-string"><span class="hljs-string">'all'</span></span>, msg); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } })</code> </pre><br>  Al igual que con los usuarios, los datos para la lista de mensajes son manejados por la Tienda (static / app / admin / modules / messages / store / MessagesStore.js) <br><br><pre> <code class="javascript hljs">Ext.define(<span class="hljs-string"><span class="hljs-string">'Module.messages.store.MessagesStore'</span></span>, { <span class="hljs-attr"><span class="hljs-attr">extend</span></span>: <span class="hljs-string"><span class="hljs-string">'Ext.data.Store'</span></span>, <span class="hljs-attr"><span class="hljs-attr">fields</span></span>: [<span class="hljs-string"><span class="hljs-string">'user'</span></span>, <span class="hljs-string"><span class="hljs-string">'message'</span></span>], <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>() { <span class="hljs-comment"><span class="hljs-comment">//       Ext.create('Module.messages.model.Model', { listeners: { newmessage: (mess) =&gt; { this.add(mess) } } }) this.callParent(arguments); } });</span></span></code> </pre><br>  En general, esto es todo lo que es interesante en este ejemplo. <br><br><h2>  Posibles preguntas </h2><br>  <b>La disponibilidad de m√©todos de servidor en el cliente es, por supuesto, buena, pero ¬øqu√© pasa con la seguridad?</b>  <b>¬øResulta que un hacker malvado puede ver el c√≥digo del servidor e intentar descifrar el backend?</b> <br><br>  No, no tendr√° √©xito.  Primero, todos los m√©todos del servidor se eliminan del c√≥digo de clase cuando se env√≠an al navegador del cliente.  Para este prop√≥sito, los comentarios / directivas / * alcance est√°n destinados: ... * /.  En segundo lugar, el c√≥digo del m√©todo m√°s p√∫blico del lado del servidor se reemplaza por una construcci√≥n intermedia que implementa el mecanismo de llamada remota en el lado del cliente. <br><br>  <b>De nuevo sobre seguridad.</b>  <b>Si se pueden invocar m√©todos de servidor en el cliente, ¬øpuedo llamar a alguno de estos m√©todos?</b>  <b>¬øY si este es un m√©todo de limpieza de base de datos?</b> <br><br>  Desde el cliente, solo puede llamar a m√©todos que tienen el prefijo $ en su nombre.  Para tales m√©todos, usted mismo determina la l√≥gica de los controles y accesos.  Un usuario externo no tiene acceso a los m√©todos del servidor sin $, ni siquiera los ver√° (ver respuesta anterior) <br><br>  <b>Parece que tienes un sistema monol√≠tico en el que el cliente y el servidor est√°n inextricablemente vinculados.</b>  <b>¬øEs posible el escalado horizontal?</b> <br><br>  El sistema, de hecho, parece monol√≠tico, pero no lo es.  El cliente y el servidor pueden "vivir" en diferentes m√°quinas.  El cliente se puede ejecutar en cualquier servidor web de terceros (Nginx, Apache, etc.).  El generador de proyectos autom√°tico resuelve el problema de la separaci√≥n del cliente y el servidor (puedo escribir una publicaci√≥n por separado sobre esto).  Para implementar el mecanismo de mensajer√≠a de servicio interno, el sistema usa colas (es decir, se requiere Redis para esto).  Por lo tanto, la parte del servidor puede escalarse f√°cilmente horizontalmente simplemente agregando nuevas m√°quinas. <br><br>  <b>Con el enfoque de desarrollo habitual, por regla general, el back-end proporciona un cierto conjunto de API a las que puede conectarse con diversas aplicaciones de cliente (sitio web, aplicaci√≥n m√≥vil).</b>  <b>En su caso, ¬øresulta que solo un cliente escrito en Ext JS puede trabajar con un back-end?</b> <br><br>  En el servidor, en particular en los modelos de m√≥dulos, se implementa una cierta l√≥gica empresarial.  Para proporcionar acceso a trav√©s de la API REST, un peque√±o "contenedor" es suficiente.  Un ejemplo correspondiente se presenta en la primera parte de este art√≠culo. <br><br><h2>  Conclusiones </h2><br>  Como puede ver, para una codificaci√≥n c√≥moda de aplicaciones bastante complejas, es bastante posible sobrevivir con una biblioteca en el front-end y back-end.  Esto tiene beneficios significativos. <br><br>  <b>Acelerando el proceso de desarrollo.</b>  Cada uno de los miembros del equipo puede trabajar en el backend y la interfaz.  El tiempo de inactividad por la raz√≥n "Estoy esperando que esta API aparezca en el servidor" ya no es relevante. <br><br>  <b>Menos c√≥digo</b>  Las mismas secciones de c√≥digo se pueden usar en el cliente y en el servidor (verificaciones, verificaci√≥n, etc.). <br><br>  <b>Mantener dicho sistema es mucho m√°s simple y econ√≥mico.</b>  En lugar de dos programadores diversos, el sistema podr√° soportar uno (o los mismos dos pero intercambiables).  Por la misma raz√≥n, los riesgos asociados con la rotaci√≥n del equipo tambi√©n son menores. <br><br>  <b>La capacidad de crear sistemas en tiempo real fuera de la caja.</b> <br><br>  <b>Usando un √∫nico sistema de prueba para backend y frontent.</b> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es431180/">https://habr.com/ru/post/es431180/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es431170/index.html">Un cient√≠fico de China anunci√≥ el nacimiento de ni√±os gen√©ticamente modificados.</a></li>
<li><a href="../es431172/index.html">¬øQu√© podemos esperar de Blizzard? El pasado, presente y futuro de la serie Diablo</a></li>
<li><a href="../es431174/index.html">Teor√≠a de la simulaci√≥n: la relaci√≥n de los c√°lculos qu√≠micos cu√°nticos y la realidad.</a></li>
<li><a href="../es431176/index.html">Microservicios, API e innovaciones: el poder de las API</a></li>
<li><a href="../es431178/index.html">Palabras par√°sitas en ingl√©s</a></li>
<li><a href="../es431184/index.html">Redes de malla de m√∫ltiples saltos WIFI con tecnolog√≠a Mesh Connex</a></li>
<li><a href="../es431186/index.html">Dise√±o por tipos: c√≥mo hacer que los estados no v√°lidos sean inexpresables en C #</a></li>
<li><a href="../es431188/index.html">Aspectos t√©cnicos del bloqueo de Internet en Rusia. Desaf√≠os y perspectivas</a></li>
<li><a href="../es431190/index.html">C√≥mo evaluar el nivel de la empresa SEO sin llegar a un acuerdo</a></li>
<li><a href="../es431192/index.html">AWC presenta Firecracker: micro virtualizaci√≥n para Linux</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>