<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ†‘ ğŸ’ ğŸ•ºğŸ½ PowerShellï¼Œæˆ‘çš„ç»éªŒè½¬å‚¨ ğŸ‘œ ğŸ§‘ğŸ¾â€ğŸ¤â€ğŸ§‘ğŸ¾ ğŸ‘©â€ğŸ”§</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="å¼•è¨€ 


 æœ¬æ–‡é¢å‘çš„è¯»è€…æ˜¯é‚£äº›å·²ç»ç†Ÿæ‚‰PowerShellåŸºç¡€çŸ¥è¯†ï¼Œä½¿ç”¨stackexchangeè¿è¡ŒæŸäº›è„šæœ¬ï¼Œå¹¶ä¸”å¯èƒ½æ‹¥æœ‰è‡ªå·±çš„æ–‡æœ¬æ–‡ä»¶ä»¥åŠå„ç§æ‘˜è¦ä»¥æ–¹ä¾¿æ—¥å¸¸å·¥ä½œçš„è¯»è€…ã€‚ ç¼–å†™å®ƒçš„ç›®çš„æ˜¯ä¸ºäº†å‡å°‘ç†µï¼Œæé«˜å…¬å¸ä¸­ä½¿ç”¨çš„PowerShellä»£ç çš„å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ï¼Œä»è€Œæé«˜ä¸ä¹‹åˆä½œçš„ç®¡ç†å‘˜çš„å·¥ä½œæ•ˆç‡ã€‚...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>PowerShellï¼Œæˆ‘çš„ç»éªŒè½¬å‚¨</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/443256/"><h2 id="vvedenie"> å¼•è¨€ </h2><br><p> æœ¬æ–‡é¢å‘çš„è¯»è€…æ˜¯é‚£äº›å·²ç»ç†Ÿæ‚‰PowerShellåŸºç¡€çŸ¥è¯†ï¼Œä½¿ç”¨stackexchangeè¿è¡ŒæŸäº›è„šæœ¬ï¼Œå¹¶ä¸”å¯èƒ½æ‹¥æœ‰è‡ªå·±çš„æ–‡æœ¬æ–‡ä»¶ä»¥åŠå„ç§æ‘˜è¦ä»¥æ–¹ä¾¿æ—¥å¸¸å·¥ä½œçš„è¯»è€…ã€‚ ç¼–å†™å®ƒçš„ç›®çš„æ˜¯ä¸ºäº†å‡å°‘ç†µï¼Œæé«˜å…¬å¸ä¸­ä½¿ç”¨çš„PowerShellä»£ç çš„å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ï¼Œä»è€Œæé«˜ä¸ä¹‹åˆä½œçš„ç®¡ç†å‘˜çš„å·¥ä½œæ•ˆç‡ã€‚ </p><br><p><img src="https://habrastorage.org/webt/go/9u/yw/go9uywfoytxpgrxmggcvf2bfi8e.png" alt="kdpv"></p><br><p> åœ¨ä»¥å‰çš„å·¥ä½œåœºæ‰€ä¸­ï¼Œç”±äºä»»åŠ¡çš„ç‰¹æ®Šæ€§ä»¥åŠä¸–ç•Œçš„ä¸å®Œå–„æ€§ï¼Œæˆ‘æå¤§åœ°æé«˜äº†ä½¿ç”¨PowerShellçš„æŠ€èƒ½ã€‚ æ¢å·¥ä½œåï¼Œè¿™ç§è´Ÿè½½å¤§å¤§å‡å°‘äº†ï¼Œåœ¨ç”¨æ–°æŠ€æœ¯è§£å†³æ–°é—®é¢˜çš„ç»éªŒä¸‹ï¼ŒæŒ‡å°–é™„è¿‘çš„ä¸€åˆ‡éƒ½å¼€å§‹ä¸‹æ²‰ã€‚ æ®æ­¤ï¼Œæœ¬æ–‡å£°ç§°åªæ˜¯å®ƒè‡ªå·±å£°æ˜çš„å†…å®¹ï¼Œå®ƒæ­ç¤ºäº†ä¸€ä¸ªä¸»é¢˜åˆ—è¡¨ï¼Œæˆ‘è®¤ä¸ºè¿™å¯¹æˆ‘è‡ªå·±å¤§çº¦7å¹´å‰æ˜¯æœ‰ç”¨çš„ï¼Œé‚£æ—¶æˆ‘å¯¹è¿™ä¸ªå·¥å…·çš„äº†è§£æ‰åˆšåˆšå¼€å§‹ã€‚ </p><a name="habracut"></a><br><p> å¦‚æœæ‚¨ä¸äº†è§£PowerShellä¸ºä»€ä¹ˆæ˜¯é¢å‘å¯¹è±¡çš„å¤–å£³ï¼Œä¸ºä»€ä¹ˆä¼šä»ä¸­è·å¾—æ”¶ç›Šï¼Œä»¥åŠä¸ºä»€ä¹ˆæœ‰å¿…è¦è¿™æ ·åšï¼Œæˆ‘ä¼šä¸ºæ‚¨æ¨èä¸€æœ¬ä¸é”™çš„ä¹¦ï¼Œå°½ç®¡æ¿€èµ·äº†ä»‡æ¨ï¼Œä½†å®ƒè¿˜æ˜¯è¿…é€Ÿåœ°ä»‹ç»äº†è¿™ç§ç¯å¢ƒçš„æœ¬è´¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">-Andrey Vladimirovich Popovï¼ŒWindows PowerShellç®€ä»‹</a> ã€‚ æ˜¯çš„ï¼Œå®ƒæ˜¯å…³äºPSçš„æ—§ç‰ˆæœ¬çš„ï¼Œæ˜¯çš„ï¼Œè¯¥è¯­è¨€è·å¾—äº†ä¸€äº›æ‰©å±•å’Œæ”¹è¿›ï¼Œä½†æ˜¯è¿™æœ¬ä¹¦å¾ˆå¥½ï¼Œå› ä¸ºå½“æè¿°è¿™ç§ç¯å¢ƒçš„å¼€å‘çš„æ—©æœŸé˜¶æ®µæ—¶ï¼Œå®ƒæ— æ„ä¸­åªå¼ºè°ƒäº†åŸºæœ¬çš„å†…å®¹ã€‚ æˆ‘è®¤ä¸ºï¼Œç¯å¢ƒä¸­é•¿æ»¡çš„è¯­æ³•ç³–åœ¨æ‚¨ä¸äº†è§£è¯¥æ¦‚å¿µå¦‚ä½•å·¥ä½œçš„æƒ…å†µä¸‹å¾ˆå¿«å°±æ„è¯†åˆ°äº†ã€‚ è¯»è¿™æœ¬ä¹¦åªéœ€è¦å‡ ä¸ªæ™šä¸Šï¼Œè¯»å®Œä»¥åå†å›æ¥ã€‚ </p><br><p><img src="https://habrastorage.org/webt/g9/ea/h9/g9eah9nfoao7gukeochjqasi2ne.jpeg" alt="æ³¢æ³¢å¤«"></p><br><p> è¯¥ä¹¦ä¹Ÿå¯ä»¥åœ¨ä½œè€…çš„ç½‘ç«™ä¸Šæ‰¾åˆ°ï¼Œå°½ç®¡æˆ‘ä¸ç¡®å®šè¿™ç§ä½¿ç”¨çš„è®¸å¯æ–¹å¼ï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">https</a> ï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">//andpop.ru/courses/winscript/books/posh_popov.pdf</a> </p><br><h2 id="stayl-gaydy"> é£æ ¼æŒ‡å— </h2><br><p> åœ¨æ‰€æœ‰æ ·å¼åº”ç”¨ä¸­ï¼Œæ ¹æ®æ ·å¼æŒ‡å—è®¾è®¡è„šæœ¬éƒ½æ˜¯ä¸€ç§å¥½çš„åšæ³•ï¼Œå‡ ä¹ä¸ä¼šæœ‰ä¸¤ç§æ„è§ã€‚ ä¸€äº›ç”Ÿæ€ç³»ç»Ÿå·²ç»åœ¨æœ¬åœ°è°ƒæ•´çº§åˆ«ä¸Šè§£å†³äº†è¿™ä¸€é—®é¢˜ï¼ŒPythonç¤¾åŒºä¸­çš„pep8å’ŒGolangä¸­çš„go fmtæ˜¾è€Œæ˜“è§ã€‚ è¿™äº›éƒ½æ˜¯èŠ‚çœæ—¶é—´çš„å®è´µå·¥å…·ï¼Œä¸å¹¸çš„æ˜¯ï¼Œæ ‡å‡†çš„PowerShellè½¯ä»¶åŒ…ä¸­ç¼ºå°‘è¿™äº›å·¥å…·ï¼Œå› æ­¤ï¼Œé—®é¢˜å°±å·²ç»å¼•èµ·äº†æˆ‘ä»¬çš„æ³¨æ„ã€‚ å½“å‰ï¼Œè§£å†³ç»Ÿä¸€ä»£ç æ ¼å¼é—®é¢˜çš„å”¯ä¸€æ–¹æ³•æ˜¯é€šè¿‡åå¤ç¼–å†™æ»¡è¶³æ ·å¼æŒ‡å—çš„ä»£ç æ¥å‘å±•åæ€ï¼ˆå®é™…ä¸Šï¼Œæ²¡æœ‰ï¼‰ã€‚ </p><br><p> ç”±äºç¼ºå°‘Microsoftçš„æ­£å¼æ‰¹å‡†å’Œè¯¦ç»†æè¿°è€Œå¯¼è‡´çš„æ ·å¼æŒ‡å—åœ¨PowerShell v3æ—¶ä»£è¯ç”Ÿäºç¤¾åŒºä¸­ï¼Œè‡ªé‚£æ—¶ä»¥æ¥ï¼Œå®ƒä»¬ä¸€ç›´ä»¥githubï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">PowerShellPracticeAndStyle</a>çš„å¼€æ”¾å½¢å¼è¿›è¡Œå¼€å‘ã€‚ å¯¹äºæ›¾ç»åœ¨PowerShell iseä¸­ä½¿ç”¨â€œä¿å­˜â€æŒ‰é’®çš„ä»»ä½•äººæ¥è¯´ï¼Œè¿™éƒ½æ˜¯ä¸€ä¸ªå€¼å¾—æ³¨æ„çš„å­˜å‚¨åº“ã€‚ </p><br><p> å¦‚æœæ‚¨å°è¯•è¿›è¡ŒæŒ¤å‹ï¼Œåˆ™å¯èƒ½ä¼šå½’ç»“ä¸ºä»¥ä¸‹å‡ ç‚¹ï¼š </p><br><ul><li>  PowerShellä½¿ç”¨PascalCaseæ¥å‘½åå˜é‡ï¼Œcmdletï¼Œæ¨¡å—åç§°ä»¥åŠé™¤è¿ç®—ç¬¦å¤–çš„å‡ ä¹æ‰€æœ‰å†…å®¹ã€‚ </li><li>è¯­è¨€è¿ç®—ç¬¦ï¼ˆå¦‚<code>if</code> ï¼Œ <code>switch</code> ï¼Œ <code>break</code> ï¼Œ <code>process</code> ï¼Œ <code>-match</code>ç”¨å¾ˆå°çš„å­—æ¯è¡¨ç¤ºï¼› </li><li> åœ†æ‹¬å·ä»¥<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å”¯ä¸€çœŸå®çš„æ–¹å¼</a>æ”¾ç½®ï¼Œå¦åˆ™ä¹Ÿç§°ä¸ºKerniganå’ŒRichieçš„é£æ ¼ï¼Œä»–çš„æ•…äº‹æ¥è‡ª<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ã€Š Cç¼–ç¨‹è¯­è¨€</a> ã€‹ä¸€ä¹¦ï¼› </li><li> ä¸è¦åœ¨äº¤äº’å¼æ§åˆ¶å°ä¼šè¯ä»¥å¤–çš„ä»»ä½•åœ°æ–¹ä½¿ç”¨åˆ«åï¼Œä¸è¦<code>ps | ? processname -eq firefox | %{$ws=0}{$ws+=$_.workingset}{$ws/1MB}</code>è„šæœ¬æ–‡ä»¶ä¸­å†™å…¥ä»»ä½•<code>ps | ? processname -eq firefox | %{$ws=0}{$ws+=$_.workingset}{$ws/1MB}</code> <code>ps | ? processname -eq firefox | %{$ws=0}{$ws+=$_.workingset}{$ws/1MB}</code>  <code>ps | ? processname -eq firefox | %{$ws=0}{$ws+=$_.workingset}{$ws/1MB}</code> ï¼› </li><li> æŒ‡ç¤ºæ˜¾å¼å‚æ•°åç§°ï¼Œ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">cmdlet</a>çš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è¡Œä¸ºåŠå…¶ç­¾åå¯èƒ½ä¼šæ›´æ”¹</a> ï¼Œæ­¤å¤–ï¼Œè¿™è¿˜ä¼šä¸ºä¸ç†Ÿæ‚‰ç‰¹å®šcmdletçš„äººæ·»åŠ ä¸Šä¸‹æ–‡ï¼› </li><li> è®¾è®¡ç”¨äºè°ƒç”¨è„šæœ¬çš„å‚æ•°ï¼Œä¸è¦åœ¨è„šæœ¬å†…éƒ¨ç¼–å†™å‡½æ•°ï¼Œæœ€åä¸€è¡Œè°ƒç”¨æ­¤å‡½æ•°æ—¶éœ€è¦æ›´æ”¹å…¨å±€å˜é‡çš„å€¼è€Œä¸æ˜¯æŒ‡å®šå‚æ•°ï¼› </li><li> æŒ‡å®š[CmdletBindingï¼ˆï¼‰]-è¿™å°†ä¸ºæ‚¨çš„cmdletæä¾›<code>-Verbose</code>å’Œ<code>-Debug</code>æ ‡å¿—ä»¥åŠ<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è®¸å¤šå…¶ä»–æœ‰ç”¨çš„åŠŸèƒ½</a> ã€‚ å°½ç®¡ä¸€äº›çº¯ç²¹ä¸»ä¹‰è€…åœ¨ç¤¾åŒºä¸­æŒåšå®šç«‹åœºï¼Œä½†æˆ‘ä¸æ”¯æŒåœ¨ç®€å•çš„å†…è”å‡½æ•°å’Œç”±å‡ è¡Œâ€‹â€‹æ–‡å­—ç»„æˆçš„è¿‡æ»¤å™¨ä¸­æŒ‡å‡ºæ­¤å±æ€§ï¼› </li><li> ç¼–å†™åŸºäºæ³¨é‡Šçš„å¸®åŠ©ï¼šä¸€ä¸ªå¥å­ï¼Œæ•…éšœå•é“¾æ¥ï¼Œå‘¼å«ç¤ºä¾‹ï¼› </li><li> åœ¨<code>#requires</code>éƒ¨åˆ†ä¸­æŒ‡å®šæ‰€éœ€çš„PowerShellç‰ˆæœ¬ã€‚ </li><li> ä½¿ç”¨<code>Set-StrictMode -Version Latest</code> ï¼Œ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è¿™å°†å¸®åŠ©æ‚¨é¿å…ä»¥ä¸‹é—®é¢˜</a> ï¼› </li><li> å¤„ç†é”™è¯¯ï¼› </li><li> ä¸è¦æ€¥äºåœ¨PowerShellä¸­é‡å†™æ‰€æœ‰å†…å®¹ã€‚  PowerShellä¸»è¦æ˜¯shellï¼Œè€Œè°ƒç”¨äºŒè¿›åˆ¶æ–‡ä»¶æ˜¯å…¶ç›´æ¥ä»»åŠ¡ã€‚ åœ¨è„šæœ¬ä¸­ä½¿ç”¨robocopyå¹¶æ²¡æœ‰é”™ï¼Œå½“ç„¶ä¸æ˜¯rsyncï¼Œä½†è¿™ä¹Ÿéå¸¸å¥½ã€‚ </li></ul><br><h2 id="comment-based-help"> åŸºäºæ³¨é‡Šçš„å¸®åŠ© </h2><br><p> ä»¥ä¸‹æ˜¯å¦‚ä½•è·å–å¸®åŠ©è„šæœ¬çš„ç¤ºä¾‹ã€‚ è¯¥è„šæœ¬å°†å›¾åƒæ„å›¾æˆä¸€ä¸ªæ­£æ–¹å½¢å¹¶è¿›è¡Œè°ƒæ•´å¤§å°ï¼Œæˆ‘è®¤ä¸ºæ‚¨çš„ä»»åŠ¡æ˜¯ä¸ºç”¨æˆ·åˆ¶ä½œåŒ–èº«ï¼ˆä¹Ÿè®¸æ ¹æ®exifæ•°æ®çš„æ—‹è½¬é™¤å¤–ï¼‰ã€‚  <code>.EXAMPLE</code>éƒ¨åˆ†ä¸­æœ‰ä¸€ä¸ªç”¨æ³•ç¤ºä¾‹ï¼Œè¯·å°è¯•ä¸€ä¸‹ã€‚ ç”±äºPowerShellç”±å…¬å…±è¯­è¨€è¿è¡Œåº“è¿è¡Œï¼Œä¸å…¶ä»–dotnetè¯­è¨€ç›¸åŒï¼Œå› æ­¤å®ƒå…·æœ‰ä½¿ç”¨dotnetåº“çš„å…¨éƒ¨åŠŸèƒ½ï¼š </p><br><pre> <code class="plaintext hljs">&lt;# .SYNOPSIS Resize-Image resizes an image file .DESCRIPTION This function uses the native .NET API to crop a square and resize an image file .PARAMETER InputFile Specify the path to the image .PARAMETER OutputFile Specify the path to the resized image .PARAMETER SquareHeight Define the size of the side of the square of the cropped image. .PARAMETER Quality Jpeg compression ratio .EXAMPLE Resize the image to a specific size: .\Resize-Image.ps1 -InputFile "C:\userpic.jpg" -OutputFile "C:\userpic-400.jpg"-SquareHeight 400 #&gt; # requires -version 3 [CmdletBinding()] Param( [Parameter( Mandatory )] [string]$InputFile, [Parameter( Mandatory )] [string]$OutputFile, [Parameter( Mandatory )] [int32]$SquareHeight, [ValidateRange( 1, 100 )] [int]$Quality = 85 ) # Add System.Drawing assembly Add-Type -AssemblyName System.Drawing # Open image file $Image = [System.Drawing.Image]::FromFile( $InputFile ) # Calculate the offset for centering the image $SquareSide = if ( $Image.Height -lt $Image.Width ) { $Image.Height $Offset = 0 } else { $Image.Width $Offset = ( $Image.Height - $Image.Width ) / 2 } # Create empty square canvas for the new image $SquareImage = New-Object System.Drawing.Bitmap( $SquareSide, $SquareSide ) $SquareImage.SetResolution( $Image.HorizontalResolution, $Image.VerticalResolution ) # Draw new image on the empty canvas $Canvas = [System.Drawing.Graphics]::FromImage( $SquareImage ) $Canvas.DrawImage( $Image, 0, -$Offset ) # Resize image $ResultImage = New-Object System.Drawing.Bitmap( $SquareHeight, $SquareHeight ) $Canvas = [System.Drawing.Graphics]::FromImage( $ResultImage ) $Canvas.DrawImage( $SquareImage, 0, 0, $SquareHeight, $SquareHeight ) $ImageCodecInfo = [System.Drawing.Imaging.ImageCodecInfo]::GetImageEncoders() | Where-Object MimeType -eq 'image/jpeg' # https://msdn.microsoft.com/ru-ru/library/hwkztaft(v=vs.110).aspx $EncoderQuality = [System.Drawing.Imaging.Encoder]::Quality $EncoderParameters = New-Object System.Drawing.Imaging.EncoderParameters( 1 ) $EncoderParameters.Param[0] = New-Object System.Drawing.Imaging.EncoderParameter( $EncoderQuality, $Quality ) # Save the image $ResultImage.Save( $OutputFile, $ImageCodecInfo, $EncoderParameters )</code> </pre> <br><p> ä¸Šé¢çš„è„šæœ¬ä»¥å¤šè¡Œæ³¨é‡Š<code>&lt;# ... #&gt;</code>å¼€å¤´ï¼Œå¦‚æœè¯¥æ³¨é‡Šé¦–å…ˆå‡ºç°å¹¶åŒ…å«æŸäº›å…³é”®å­—ï¼Œé‚£ä¹ˆPowerShellå°†è‡ªåŠ¨ä¸ºè¯¥è„šæœ¬æ„å»ºå¸®åŠ©ã€‚ è¿™ç§å¸®åŠ©çš„å­—é¢æ„æ€æ˜¯- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åŸºäºæ³¨é‡Šçš„å¸®åŠ©</a> ï¼š </p><br><p><img src="https://habrastorage.org/webt/9y/tw/d3/9ytwd3hlr6yb5nsobqqor_bjshw.png" alt="å¸®å¿™"></p><br><p> æ­¤å¤–ï¼Œè°ƒç”¨è„šæœ¬æ—¶ï¼Œæ— è®ºæ˜¯PowerShellæ§åˆ¶å°è¿˜æ˜¯ä»£ç ç¼–è¾‘å™¨ï¼Œå‚æ•°çš„å·¥å…·æç¤ºéƒ½å°†èµ·ä½œç”¨ï¼š </p><br><p><img src="https://habrastorage.org/webt/tr/ha/qg/trhaqga49fwvjphbl6i_cporowa.png" alt="å†…è”å¸®åŠ©"></p><br><p> æˆ‘å†æ¬¡æè¯·æ³¨æ„ä¸€ä¸ªäº‹å®ï¼Œå³å¥¹ä¸åº”è¢«å¿½ç•¥ã€‚ å¦‚æœæ‚¨ä¸çŸ¥é“åœ¨æ­¤å¤„å†™äº›ä»€ä¹ˆï¼Œè¯·å†™ç‚¹ä¸œè¥¿ï¼Œç„¶åå»å‡‰çˆ½çš„åœ°æ–¹ï¼Œä¸€ç»è¿”å›ï¼Œæ‚¨è‚¯å®šä¼šäº†è§£éœ€è¦æ›´æ”¹çš„å†…å®¹ã€‚ å¯ä»¥ç”¨ ä¸å¿…ç‹‚å¦„åœ°å¡«å†™æ‰€æœ‰å…³é”®å­—ï¼ŒPowerShellæ—¨åœ¨è‡ªæˆ‘è®°å½•ï¼Œå¦‚æœç»™å‚æ•°èµ‹äºˆäº†æœ‰æ„ä¹‰çš„å…¨åï¼Œåˆ™<code>.SYNOPIS</code>éƒ¨åˆ†ä¸­çš„<code>.SYNOPIS</code>å’Œä¸€ä¸ªç¤ºä¾‹å°±è¶³å¤Ÿäº†ã€‚ </p><br><h2 id="strict-mode"> ä¸¥æ ¼æ¨¡å¼ </h2><br><p> ä¸è®¸å¤šå…¶ä»–è„šæœ¬è¯­è¨€ä¸€æ ·ï¼ŒPowerShellå…·æœ‰åŠ¨æ€ç±»å‹ã€‚ è¿™ç§ç±»å‹çš„é”®å…¥æœ‰å¾ˆå¤šæ”¯æŒè€…ï¼šç¼–å†™ç®€å•ä½†åŠŸèƒ½å¼ºå¤§çš„é«˜çº§é€»è¾‘ä»…éœ€å‡ åˆ†é’Ÿï¼Œä½†æ˜¯å½“æ‚¨çš„å†³å®šå¼€å§‹è¾¾åˆ°ä¸€åƒè¡Œæ—¶ï¼Œæ‚¨è‚¯å®šä¼šé‡åˆ°è¿™ç§æ–¹æ³•çš„è„†å¼±æ€§ã€‚ </p><br><p> åœ¨æµ‹è¯•é˜¶æ®µè‡ªåŠ¨ä¸å˜åœ°è¾“å‡ºç±»å‹ï¼ˆåœ¨æ‚¨æ€»æ˜¯æ”¶åˆ°ä¸€ç»„å…ƒç´ çš„åœ°æ–¹å½¢æˆä¸€ä¸ªæ•°ç»„ï¼‰ï¼Œè‚¯å®šä¼šæ”¾ä¸€ä¸ªçŒªï¼Œä»¥é˜²ä¸‡ä¸€æ‚¨å¾—åˆ°ä¸€ä¸ªå…ƒç´ å¹¶ä¸”åœ¨ä»¥ä¸‹æ¡ä»¶ä¸‹ï¼Œè€Œä¸æ˜¯æ£€æŸ¥å…ƒç´ çš„æ•°é‡ï¼Œè€Œæ˜¯å¾—åˆ°å­—ç¬¦çš„æ•°é‡æˆ–å¦ä¸€ä¸ªå±æ€§ï¼Œå…·ä½“å–å†³äºé¡¹ç›®ç±»å‹ã€‚ è„šæœ¬çš„é€»è¾‘å°†ä¸­æ–­ï¼Œè¿è¡Œæ—¶å°†å‡è£…ä¸€åˆ‡æ­£å¸¸ã€‚ </p><br><p> è®¾ç½®ä¸¥æ ¼æ¨¡å¼æœ‰åŠ©äºé¿å…è¿™ç±»é—®é¢˜ï¼Œä½†æ˜¯è¿˜éœ€è¦æ‚¨å¤šä¸€ç‚¹ä»£ç ï¼Œä¾‹å¦‚åˆå§‹åŒ–å˜é‡å’Œæ˜¾å¼è½¬æ¢ã€‚ </p><br><p> é€šè¿‡<code>Set-StrictMode -Version Latest</code> cmdletå¯ç”¨æ­¤æ¨¡å¼ï¼Œå°½ç®¡â€œä¸¥æ ¼â€è¿˜æœ‰å…¶ä»–é€‰é¡¹ï¼Œä½†æˆ‘é€‰æ‹©ä½¿ç”¨åè€…ã€‚ </p><br><p> åœ¨ä¸‹é¢çš„ç¤ºä¾‹ä¸­ï¼Œä¸¥æ ¼æ¨¡å¼æ•è·å¯¹ä¸å­˜åœ¨çš„å±æ€§çš„è°ƒç”¨ã€‚ ç”±äºæ–‡ä»¶å¤¹å†…åªæœ‰ä¸€ä¸ªå…ƒç´ ï¼Œæ‰§è¡Œå<code>$Input</code>å˜é‡çš„ç±»å‹å°†ä¸º<code>FileInfo</code> ï¼Œè€Œä¸æ˜¯å¯¹åº”å…ƒç´ çš„é¢„æœŸæ•°ç»„ï¼š </p><br><p><img src="https://habrastorage.org/webt/fk/q-/jk/fkq-jkrdldogwcwyiwkwspskseq.png" alt="ä¸¥æ ¼çš„"></p><br><p> ä¸ºé¿å…æ­¤ç±»é—®é¢˜ï¼Œåº”å°†cmdletçš„ç»“æœæ˜¾å¼è½¬æ¢ä¸ºæ•°ç»„ï¼š </p><br><pre> <code class="plaintext hljs">$Items = @( Get-ChildItem C:\Users\snd3r\Nextcloud )</code> </pre> <br><p> å°†å…¶è®¾ç½®ä¸ºå§‹ç»ˆè®¾ç½®ä¸¥æ ¼æ¨¡å¼çš„è§„åˆ™ï¼Œè¿™å°†ä½¿æ‚¨é¿å…è¿è¡Œè„šæœ¬äº§ç”Ÿæ„å¤–ç»“æœã€‚ </p><br><h2 id="obrabotka-oshibok"> é”™è¯¯å¤„ç† </h2><br><h3 id="erroractionpreference">  ErrorActionPreference </h3><br><p> ä¾‹å¦‚ï¼Œåœ¨githubä¸ŠæŸ¥çœ‹å…¶ä»–äººçš„è„šæœ¬æ—¶ï¼Œæˆ‘ç»å¸¸çœ‹åˆ°è¦ä¹ˆå®Œå…¨å¿½ç•¥é”™è¯¯å¤„ç†æœºåˆ¶ï¼Œè¦ä¹ˆåœ¨å‡ºç°é”™è¯¯çš„æƒ…å†µä¸‹æ˜¾å¼æ¿€æ´»é™é»˜ç»§ç»­æ¨¡å¼ã€‚ ä¸€èˆ¬è€Œè¨€ï¼Œé”™è¯¯å¤„ç†é—®é¢˜å½“ç„¶ä¸æ˜¯æœ€å®¹æ˜“ç¼–ç¨‹çš„ï¼Œå°¤å…¶æ˜¯åœ¨è„šæœ¬ä¸­ï¼Œä½†ç»å¯¹ä¸å®¹å¿½è§†ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œå¦‚æœå‘ç”Ÿé”™è¯¯ï¼ŒPowerShellä¼šæ˜¾ç¤ºè¯¥é”™è¯¯å¹¶ç»§ç»­å·¥ä½œï¼ˆæˆ‘ç¨å¾®ç®€åŒ–äº†è¿™ä¸ªæ¦‚å¿µï¼Œä½†æ˜¯ä¸‹é¢æ˜¯è¯¥ä¸»é¢˜çš„gitä¹¦çš„é“¾æ¥ï¼‰ã€‚ å¦‚æœæ‚¨è¿«åˆ‡éœ€è¦å°†åœ¨è¯¥åŸŸä¸­å¹¿æ³›ä½¿ç”¨çš„ç¨‹åºæ›´æ–°åˆ†å‘ç»™æ‰€æœ‰è®¡ç®—æœºï¼Œè€Œä¸å¿…ç­‰åˆ°è¯¥ç¨‹åºæ•£å¸ƒåˆ°sccméƒ¨ç½²çš„æ‰€æœ‰ç‚¹æˆ–ä»¥æ‚¨ä½¿ç”¨çš„å¦ä¸€ç§æ–¹å¼æ•£å¸ƒï¼Œè¿™å°†éå¸¸æ–¹ä¾¿ã€‚ å¦‚æœå…¶ä¸­ä¸€å°è®¡ç®—æœºå·²å…³é—­ï¼Œåˆ™ä¸­æ–­å¹¶é‡æ–°å¯åŠ¨è¯¥è¿‡ç¨‹æ˜¯ä¸æ„‰å¿«çš„ï¼Œè¿™æ˜¯äº‹å®ã€‚ </p><br><p> å¦ä¸€æ–¹é¢ï¼Œå¦‚æœæ‚¨å¯¹ä¸€ä¸ªç³»ç»Ÿè¿›è¡Œå¤æ‚çš„å¤‡ä»½ï¼Œè¯¥ç³»ç»Ÿç”±ä¸€ä¸ªä¿¡æ¯ç³»ç»Ÿçš„ä¸€ä¸ªä»¥ä¸Šçš„å¤šä¸ªæ•°æ®æ–‡ä»¶ç»„æˆï¼Œåˆ™éœ€è¦ç¡®ä¿å¤‡ä»½æ˜¯ä¸€è‡´çš„ï¼Œå¹¶ä¸”æ‰€æœ‰å¿…è¦çš„æ•°æ®é›†éƒ½å·²å¤åˆ¶ä¸”æ²¡æœ‰é”™è¯¯ã€‚ </p><br><p> è‹¥è¦åœ¨å‘ç”Ÿé”™è¯¯æ—¶æ›´æ”¹cmdletçš„è¡Œä¸ºï¼Œæœ‰ä¸€ä¸ªå…¨å±€å˜é‡<code>$ErrorActionPreference</code> ï¼Œå…¶ä¸­åŒ…å«ä»¥ä¸‹å¯èƒ½çš„å€¼åˆ—è¡¨ï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Stopï¼ŒInquireï¼ŒContinueï¼ŒSuspendï¼ŒSilentlyContinue</a> ã€‚ </p><br><p> æˆ‘å»ºè®®æ‚¨åœ¨è„šæœ¬æ•°é‡æˆ–å®ƒä»¬çš„å¤æ‚æ€§ä¸å†å­˜å‚¨åœ¨æ‚¨çš„å¤´éƒ¨çš„å †æ ˆä¸­æ—¶å§‹ç»ˆä½¿ç”¨<code>Stop</code>å€¼ï¼Œæœ€å¥½ç¡®ä¿åœ¨ä»»ä½•ä¸å¯é¢„è§çš„æƒ…å†µä¸‹è¯¥è„šæœ¬å°†åœæ­¢å…¶å·¥ä½œï¼Œå¹¶ä¸”ä¸ä¼š``æ‚„æ‚„åœ°''ç ´åæŸ´ç«ï¼Œ``æˆåŠŸåœ°''å®Œæˆæ‰§è¡Œã€‚ </p><br><p> é™¤äº†åœ¨å‘ç”Ÿé”™è¯¯çš„æƒ…å†µä¸‹åœæ­¢è„šæœ¬ä¹‹å¤–ï¼Œä½¿ç”¨è„šæœ¬è¿˜æœ‰å¦ä¸€ä¸ªå…ˆå†³æ¡ä»¶-å¤„ç†å¼‚å¸¸æƒ…å†µã€‚ æœ‰ä¸€ä¸ª<code>try/catch</code>æ„é€ ï¼Œä½†æ˜¯ä»…å½“é”™è¯¯å¯¼è‡´æ‰§è¡Œåœæ­¢æ—¶æ‰èµ·ä½œç”¨ã€‚ ä¸å¿…å¿…é¡»åœ¨æ•´ä¸ªè„šæœ¬çº§åˆ«å¯ç”¨åœæ­¢ï¼Œ <code>ErrorAction</code>å¯ä»¥åœ¨cmdletçº§åˆ«ä½¿ç”¨ä»¥ä¸‹å‚æ•°è®¾ç½®<code>ErrorAction</code> ï¼š </p><br><pre> <code class="plaintext hljs">Get-ChildItem 'C:\System Volume Information\' -ErrorAction 'Stop'</code> </pre> <br><p> å®é™…ä¸Šï¼Œè¿™ç§å¯èƒ½æ€§å®šä¹‰äº†ä¸¤ç§é€»è¾‘ç­–ç•¥ï¼šâ€œé»˜è®¤æƒ…å†µä¸‹â€è§£å†³æ‰€â€‹â€‹æœ‰é”™è¯¯ï¼Œå¹¶ä»…é’ˆå¯¹å¤„ç†é”™è¯¯çš„å…³é”®ä½ç½®è®¾ç½®<code>ErrorAction</code> ï¼› é€šè¿‡è®¾ç½®å…¨å±€å˜é‡çš„å€¼å¹¶åœ¨éå…³é”®æ“ä½œä¸Šè®¾ç½®<code>-ErrorAction 'Continue'</code> ï¼Œå¯ä»¥åœ¨æ•´ä¸ªè„šæœ¬çº§åˆ«å¯ç”¨å®ƒä»¬ã€‚ æˆ‘æ€»æ˜¯é€‰æ‹©ç¬¬äºŒä¸ªé€‰é¡¹ï¼Œæˆ‘ä¸ç€æ€¥å°†å…¶å¼ºåŠ ç»™æ‚¨ï¼Œæˆ‘åªå»ºè®®æ‚¨ä¸€æ¬¡äº†è§£è¯¥é—®é¢˜å¹¶ä½¿ç”¨æ­¤æœ‰ç”¨çš„å·¥å…·ã€‚ </p><br><h3 id="trycatch"> å°è¯•/æŠ“ä½ </h3><br><p> åœ¨é”™è¯¯å¤„ç†ç¨‹åºä¸­ï¼Œæ‚¨å¯ä»¥æ ¹æ®å¼‚å¸¸çš„ç±»å‹è¿›è¡ŒåŒ¹é…å¹¶ä½¿ç”¨æ‰§è¡Œçº¿ç¨‹è¿›è¡Œæ“ä½œï¼Œä¾‹å¦‚ï¼Œæ·»åŠ æ›´å¤šä¿¡æ¯ã€‚ å°½ç®¡ä½¿ç”¨<code>try/catch/throw/trap</code>è¿ç®—ç¬¦å¯ä»¥æ„å»ºè„šæœ¬æ‰§è¡Œçš„æ•´ä¸ªæµç¨‹ï¼Œä½†æ‚¨åº”ç»å¯¹é¿å…è¿™æ ·åšï¼Œå› ä¸ºè¿™ç§æ‰§è¡Œæ‰§è¡Œçš„æ–¹æ³•ä¸ä»…è¢«è§†ä¸ºâ€œ goto-noodleâ€ç±»åˆ«ä¸­çš„ä¸€ç§æç«¯åæ¨¡å¼ï¼Œå› æ­¤ä¹Ÿä¼šæå¤§åœ°é™ä½æ€§èƒ½ã€‚ </p><br><pre> <code class="plaintext hljs">#requires -version 3 $ErrorActionPreference = 'Stop' #   ,    , #          $Logger = Get-Logger "$PSScriptRoot\Log.txt" #    trap { $Logger.AddErrorRecord( $_ ) exit 1 } #    $count = 1; while ( $true ) { try { #   $StorageServers = @( Get-ADGroupMember -Identity StorageServers | Select-Object -Expand Name ) } catch [System.Management.Automation.CommandNotFoundException] { #      ,         throw " Get-ADGroupMember ,    Active Directory module for PowerShell; $( $_.Exception.Message )" } catch [System.TimeoutException] { #             if ( $count -le 3 ) { $count++; Start-Sleep -S 10; continue } #             throw "     -   ,   $count ; $( $_.Exception.Message )" } #         break }</code> </pre> <br><p> å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œ <code>trap</code>æ“ä½œç¬¦æ˜¯å…¨å±€é”™è¯¯é™·é˜±ã€‚ å®ƒæ•è·æ‰€æœ‰æœªåœ¨è¾ƒä½çº§åˆ«è¿›è¡Œå¤„ç†çš„å†…å®¹ï¼Œæˆ–ç”±äºæ— æ³•ç‹¬ç«‹çº æ­£æƒ…å†µè€ŒæŠ›å‡ºå¼‚å¸¸å¤„ç†ç¨‹åºçš„æ‰€æœ‰å†…å®¹ã€‚ </p><br><p> é™¤äº†ä¸Šè¿°çš„é¢å‘å¯¹è±¡çš„å¼‚å¸¸æ–¹æ³•å¤–ï¼ŒPowerShellè¿˜æä¾›äº†ä¸å…¶ä»–â€œç»å…¸â€ shellå…¼å®¹çš„æ›´ç†Ÿæ‚‰çš„æ¦‚å¿µï¼Œä¾‹å¦‚ï¼Œé”™è¯¯æµï¼Œè¿”å›ä»£ç å’Œé”™è¯¯ç´¯ç§¯å˜é‡ã€‚ æ‰€æœ‰è¿™ä¸€åˆ‡å½“ç„¶å¾ˆæ–¹ä¾¿ï¼Œæœ‰æ—¶æ²¡æœ‰å…¶ä»–é€‰æ‹©ï¼Œä½†ä»æ€»ä½“ä¸Šæ¥è¯´ï¼Œè¿™è¶…å‡ºäº†æœ¬ä¸»é¢˜çš„èŒƒå›´ã€‚ å¹¸è¿çš„æ˜¯ï¼Œ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åœ¨github</a>ä¸Šæœ‰ä¸€<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æœ¬</a>å…³äºè¯¥ä¸»é¢˜çš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å¥½ä¹¦</a> ã€‚ </p><br><p> æˆ‘æ— æ³•ç¡®å®šç³»ç»Ÿå°†å…·æœ‰PowerShell 5æ—¶ä½¿ç”¨çš„è®°å½•å™¨ä»£ç ï¼ˆæ‚¨å¯ä»¥åœ¨å…¶ä¸­æ›´æ–¹ä¾¿åœ°æè¿°è®°å½•å™¨ç±»ï¼‰ï¼Œè¯·å°è¯•ä¸€ä¸‹ï¼Œç”±äºå®ƒçš„ç®€å•æ€§å’Œç®€æ´æ€§ï¼Œå®ƒå¯èƒ½å¯¹æ‚¨å¾ˆæœ‰ç”¨ï¼Œè¯·ç¡®ä¿æ¯«æ— å›°éš¾åœ°æ·»åŠ å…¶ä»–æ–¹æ³•ã€‚ ï¼š </p><br><pre> <code class="plaintext hljs">#   " ",   PowerShell v3 function Get-Logger { [CmdletBinding()] param ( [Parameter( Mandatory = $true )] [string] $LogPath, [string] $TimeFormat = 'yyyy-MM-dd HH:mm:ss' ) $LogsDir = [System.IO.Path]::GetDirectoryName( $LogPath ) New-Item $LogsDir -ItemType Directory -Force | Out-Null New-Item $LogPath -ItemType File -Force | Out-Null $Logger = [PSCustomObject]@{ LogPath = $LogPath TimeFormat = $TimeFormat } Add-Member -InputObject $Logger -MemberType ScriptMethod AddErrorRecord -Value { param( [Parameter( Mandatory = $true )] [string]$String ) "$( Get-Date -Format 'yyyy-MM-dd HH:mm:ss' ) [Error] $String" | Out-File $this.LogPath -Append } return $Logger }</code> </pre> <br><p> æˆ‘é‡å¤è¿™ä¸ªæƒ³æ³•-ä¸è¦å¿½ç•¥é”™è¯¯å¤„ç†ã€‚ ä»é•¿è¿œæ¥çœ‹ï¼Œè¿™å°†èŠ‚çœæ‚¨çš„æ—¶é—´å’Œç²¾åŠ›ã€‚ <br> ä¸è¦ä»¥ä¸ºè¿è¡Œè„šæœ¬ä¸ç®¡ä»€ä¹ˆéƒ½å¥½ã€‚ å¾ˆå¥½-æ˜¯æ—¶å€™æ‘”æ–­æŸ´ç«äº†ã€‚ </p><br><h2 id="instrumenty"> å·¥å…· </h2><br><p> å€¼å¾—ä»æ§åˆ¶å°ä»¿çœŸå™¨å¼€å§‹æ”¹è¿›ä½¿ç”¨PowerShellçš„å·¥å…·ã€‚ æˆ‘ç»å¸¸å¬åˆ°æ›¿ä»£æ€§é»„èœ‚çš„æ”¯æŒè€…è¯´ï¼ŒWindowsä¸­çš„æ§åˆ¶å°å¾ˆç³Ÿç³•ï¼Œæ ¹æœ¬ä¸æ˜¯æ§åˆ¶å°ï¼Œè€Œæ˜¯dosç­‰ã€‚ å¾ˆå°‘æœ‰äººèƒ½å°±æ­¤é—®é¢˜æå‡ºå……åˆ†çš„ä¸»å¼ ï¼Œä½†å¦‚æœæœ‰äººæˆåŠŸäº†ï¼Œé‚£ä¹ˆå®é™…ä¸Šäº‹å®è¯æ˜æ‰€æœ‰é—®é¢˜éƒ½å¯ä»¥è§£å†³ã€‚ é›†çº¿å™¨çª—å£ä¸­å·²ç»æœ‰å…³äºç»ˆç«¯å’Œæ–°æ§åˆ¶å°çš„æ›´å¤šä¿¡æ¯ï¼› <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">é‚£é‡Œçš„ä¸€åˆ‡éƒ½è¿˜å¯ä»¥</a> ã€‚ </p><br><p> ç¬¬ä¸€æ­¥æ˜¯å®‰è£…Conemuæˆ–å…¶Cmderç»„ä»¶ï¼Œè¿™å¹¶ä¸æ˜¯ç‰¹åˆ«é‡è¦ï¼Œå› ä¸ºæˆ‘è®¤ä¸ºæ— è®ºå¦‚ä½•éƒ½è¦è¿›è¡Œè®¾ç½®ã€‚ æˆ‘é€šå¸¸ä»¥æœ€å°çš„é…ç½®é€‰æ‹©cmderï¼Œæ²¡æœ‰é…ç½®çš„gitaå’Œå…¶ä»–äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå°½ç®¡å‡ å¹´æ¥æˆ‘ä¸ºçº¯Conemuè°ƒæ•´äº†é…ç½®ã€‚ è¿™ç¡®å®æ˜¯Windowsçš„æœ€ä½³ç»ˆç«¯ä»¿çœŸå™¨ï¼Œå®ƒå…è®¸æ‚¨åˆ†å‰²å±å¹•ï¼ˆå¯¹äºtmux /å±å¹•çˆ±å¥½è€…ï¼‰ï¼Œåˆ›å»ºé€‰é¡¹å¡å¹¶å¯ç”¨åœ°éœ‡å¼æ§åˆ¶å°æ¨¡å¼ï¼š </p><br><h3 id="conemu">  Conemu </h3><br><p><img src="https://habrastorage.org/webt/ag/2w/hy/ag2whyp2okkhyroygpuzjkdamis.png" alt="cmder"></p><br><p> ä¸‹ä¸€æ­¥ï¼Œæˆ‘å»ºè®®æ”¾ç½®ä»¥ä¸‹æ¨¡å—ï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">oh-my-posh</a> ï¼Œ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">posh-git</a>å’Œ<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">PSReadLine</a> ã€‚ å‰ä¸¤ä¸ªå°†é€šè¿‡æ·»åŠ æœ‰å…³å½“å‰ä¼šè¯ï¼Œä¸Šæ¬¡æ‰§è¡Œçš„å‘½ä»¤çš„çŠ¶æ€ï¼Œç‰¹æƒæŒ‡ç¤ºç¬¦å’Œgitå­˜å‚¨åº“åœ¨å½“å‰ä½ç½®çš„çŠ¶æ€çš„ä¿¡æ¯ï¼Œä½¿èˆä¼šå˜å¾—æ›´åŠ æ„‰å¿«ã€‚  PSReadLineå¤§å¤§æé«˜äº†promtçš„åŠŸèƒ½ï¼Œä¾‹å¦‚æ·»åŠ äº†å¯¹è¾“å…¥å‘½ä»¤çš„å†å²è®°å½•ï¼ˆCRTL + Rï¼‰çš„æœç´¢ä»¥åŠåœ¨CRTL + Spaceä¸Šcmdletçš„ä¾¿æ·æç¤ºï¼š </p><br><p><img src="https://habrastorage.org/webt/eg/w6/f2/egw6f2sa43hgi3dhwn_hhgxbesa.gif" alt="é˜…è¯»çº¿"></p><br><p> æ˜¯çš„ï¼Œç°åœ¨å¯ä»¥ä½¿ç”¨CTRL + Læ¸…é™¤æ§åˆ¶å°ï¼Œè€Œ<code>cls</code>æ‹…å¿ƒ<code>cls</code> ã€‚ </p><br><h3 id="visual-studio-code">  Visual Studioä»£ç  </h3><br><p> ç¼–è¾‘ã€‚ å…³äºPowerShellï¼Œæˆ‘èƒ½è¯´çš„æœ€ç³Ÿç³•çš„æ˜¯çº¯ç²¹çš„PowerShell ISEï¼Œé‚£äº›çœ‹åˆ°å…·æœ‰ä¸‰ä¸ªé¢æ¿çš„ç¬¬ä¸€ä¸ªç‰ˆæœ¬çš„äººä¸å¤ªå¯èƒ½ä¼šå¿˜è®°è¿™ç§ä½“éªŒã€‚ ç»ˆç«¯çš„ç¼–ç æ–¹å¼ä¸åŒï¼Œç¼ºå°‘åŸºæœ¬çš„ç¼–è¾‘å™¨åŠŸèƒ½ï¼Œä¾‹å¦‚è‡ªåŠ¨ç¼©è¿›ï¼Œè‡ªåŠ¨å…³é—­æ‹¬å·ï¼Œä»£ç æ ¼å¼ä»¥åŠç”±æ­¤ç”Ÿæˆçš„æ•´å¥—åæ¨¡å¼ï¼ˆæˆ‘ä»¥é˜²ä¸‡ä¸€ï¼‰ï¼Œè¿™å…¨éƒ½æ˜¯å…³äºISEçš„ã€‚ </p><br><p> ä¸è¦ä½¿ç”¨å®ƒï¼Œè€Œæ˜¯å°†Visual Studio Codeä¸PowerShellæ‰©å±•ä¸€èµ·ä½¿ç”¨-æœ‰æ‚¨ä¸æƒ³è¦çš„æ‰€æœ‰å†…å®¹ï¼ˆå½“ç„¶ï¼Œåœ¨åˆç†èŒƒå›´å†…ï¼‰ã€‚ å¹¶ä¸”ä¸è¦å¿˜è®°ï¼Œåœ¨PoweShellåˆ°ç¬¬å…­ç‰ˆï¼ˆPowerShell Core 6.0ï¼‰ä¸­ï¼Œè„šæœ¬çš„ç¼–ç æ˜¯UTF8 BOMï¼Œå¦åˆ™ä¿„è¯­ä¼šä¸­æ–­ã€‚ </p><br><p><img src="https://habrastorage.org/webt/dd/c0/pa/ddc0paj-xbx5tysllsrmzlxnugi.png" alt="vscode"></p><br><p> é™¤äº†è¯­æ³•é«˜äº®æ˜¾ç¤ºï¼Œå·¥å…·æç¤ºå’Œè„šæœ¬è°ƒè¯•åŠŸèƒ½ä¹‹å¤–ï¼Œè¯¥æ’ä»¶è¿˜å®‰è£…äº†ä¸€ä¸ªlinterï¼Œå®ƒå°†å¸®åŠ©æ‚¨éµå¾ªç¤¾åŒºä¸­å·²å»ºç«‹çš„æƒ¯ä¾‹ï¼Œä¾‹å¦‚ï¼Œä¸€é”®å¼æ‰©å±•å¿«æ·æ–¹å¼ï¼ˆåœ¨ç¯æ³¡ä¸Šï¼‰ã€‚ å®é™…ä¸Šï¼Œè¿™æ˜¯ä¸€ä¸ªå¸¸è§„æ¨¡å—ï¼Œå¯ä»¥ç‹¬ç«‹<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å®‰è£…</a> ï¼Œä¾‹å¦‚ï¼Œå°†å…¶æ·»åŠ åˆ°ç®¡é“ç­¾åè„šæœ¬ä¸­ï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">PSScriptAnalyzer</a> </p><br><p><img src="https://habrastorage.org/webt/mj/x7/ov/mjx7ovrtephqcdctuiptdu_tff4.png" alt="PSScriptAnalyzer"></p><br><p> æ‚¨å¯ä»¥åœ¨æ‰©å±•åè®¾ç½®ä¸­è®¾ç½®ä»£ç æ ¼å¼è®¾ç½®å‚æ•°ï¼Œå¯¹äºæ‰€æœ‰è®¾ç½®ï¼ˆç¼–è¾‘å™¨å’Œæ‰©å±•åï¼‰éƒ½å¯ä»¥è¿›è¡Œæœç´¢ï¼š <code>File - Preferences - Settings</code> ï¼š </p><br><p><img src="https://habrastorage.org/webt/ia/xr/km/iaxrkmgjcpcf4wck1ocb7kfp9ym.png" alt="Otbs"></p><br><p> ä¸ºäº†è·å¾—ä¸€ä¸ªæ–°çš„conptyæ§åˆ¶å°ï¼Œæ‚¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åº”è¯¥åœ¨settingsä¸­è®¾ç½®è¯¥æ ‡å¿—</a> ï¼Œç¨åï¼Œæ­¤å»ºè®®å¯èƒ½æ˜¯æ— å…³ç´§è¦çš„ã€‚ </p><br><p> å€¼å¾—è®°ä½çš„æ˜¯ï¼ŒVS Codeä¸­çš„ä»»ä½•æ“ä½œéƒ½å¯ä»¥åœ¨æ§åˆ¶ä¸­å¿ƒæ‰§è¡Œï¼Œç”±CTRL + Shift + Pè°ƒç”¨ã€‚æ ¼å¼åŒ–<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä»èŠå¤©ä¸­æ’å…¥çš„</a>ä¸€æ®µä»£ç ï¼ŒæŒ‰å­—æ¯é¡ºåºæ’åºï¼Œå°†ç¼©è¿›ä»ç©ºæ ¼æ›´æ”¹ä¸ºåˆ¶è¡¨ç¬¦ï¼Œä¾æ­¤ç±»æ¨ï¼Œæ‰€æœ‰è¿™äº›éƒ½åœ¨æ§åˆ¶ä¸­å¿ƒä¸­ã€‚ </p><br><p> ä¾‹å¦‚ï¼Œå¯ç”¨å…¨å±å’Œå±…ä¸­ç¼–è¾‘å™¨ä½ç½®ï¼š </p><br><p><img src="https://habrastorage.org/webt/3z/w9/-a/3zw9-avzniwjgooxfa1dvzi9kfc.png" alt="å¸ƒå±€å›¾"></p><br><h3 id="source-control-git-svn"> æºä»£ç æ§åˆ¶  Gitï¼ŒSVN </h3><br><p>  Windowsç³»ç»Ÿç®¡ç†å‘˜é€šå¸¸åœ¨ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿä¸­æœ‰è§£å†³å†²çªçš„ææƒ§ç—‡ï¼Œè¿™å¯èƒ½æ˜¯å› ä¸ºå¦‚æœè¯¥é›†åˆçš„ä»£è¡¨ä½¿ç”¨gitï¼Œåˆ™é€šå¸¸ä¸ä¼šé‡åˆ°ä»»ä½•æ­¤ç±»é—®é¢˜ã€‚ ä½¿ç”¨vscodeï¼Œè§£å†³å†²çªçš„æ–¹æ³•å®é™…ä¸Šæ˜¯ç”¨é¼ æ ‡å•å‡»éœ€è¦ä¿ç•™æˆ–æ›¿æ¢çš„ä»£ç éƒ¨åˆ†ã€‚ </p><br><p><img src="https://habrastorage.org/webt/ft/fd/8f/ftfd8f1ylxofsckzu6v1uujok1e.png" alt="åˆå¹¶"></p><br><p>  303è¡Œå’Œ304è¡Œä¹‹é—´çš„è¿™äº›æ ‡ç­¾æ˜¯å¯å•å‡»çš„ï¼Œå¦‚æœå‘ç”Ÿå†²çªï¼Œåˆ™åº”å•å‡»æ–‡æ¡£ä¸­æ˜¾ç¤ºçš„æ‰€æœ‰æ ‡ç­¾ï¼Œç„¶åæäº¤æ›´æ”¹å¹¶æäº¤åˆ°æœåŠ¡å™¨ã€‚  U-æ–¹ä¾¿ã€‚ </p><br><p> æœ‰å…³å¦‚ä½•ä½¿ç”¨ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿçš„ä¿¡æ¯ï¼Œä»¥åŠæœ‰å…³å›¾ç‰‡çš„ä¿¡æ¯<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ï¼Œå‡è®°å½•åœ¨vscodeæ‰©å±•åä¸­</a> ï¼Œåœ¨é‚£é‡Œç®€è¦ç®€è¦åœ°ä»‹ç»äº†æ‚¨ã€‚ </p><br><h3 id="snippets"> ç‰‡æ®µ </h3><br><p>  <a href="">ä»£ç æ®µ</a>æ˜¯ä¸€ç§å®/æ¨¡æ¿ï¼Œå¯è®©æ‚¨åŠ å¿«ä»£ç ç¼–å†™é€Ÿåº¦ã€‚ ç»å¯¹æ˜¯å¿…çœ‹çš„ã€‚ </p><br><p> å¿«é€Ÿåˆ›å»ºå¯¹è±¡ï¼š </p><br><p><img src="https://habrastorage.org/webt/yi/wp/om/yiwpomlohxird5oovnutj4hc7ec.gif" alt="è‡ªå®šä¹‰å¯¹è±¡"></p><br><p> å¯»æ±‚åŸºäºæ³¨é‡Šçš„å¸®åŠ©ï¼š </p><br><p><img src="https://habrastorage.org/webt/ol/jn/37/oljn37jxzabxa9h4yqquuh98s9i.gif" alt="å¸®å¿™"></p><br><p> å¦‚æœcmdletéœ€è¦ä¼ é€’å¤§é‡å‚æ•°ï¼Œåˆ™<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä½¿ç”¨splatting</a>æ˜¯æœ‰æ„ä¹‰çš„ã€‚ <br> è¿™æ˜¯ä»–çš„æ‘˜å½•ï¼š </p><br><p><img src="https://habrastorage.org/webt/lx/y_/ek/lxy_ekyxsjsuiad66yzqqfoxzta.gif" alt="å–·æº…"></p><br><p> é€šè¿‡Ctrl + Alt + JæŸ¥çœ‹æ‰€æœ‰å¯ç”¨çš„ä»£ç æ®µï¼š </p><br><p><img src="https://habrastorage.org/webt/0p/jm/k_/0pjmk_nms2ejlugtcsxvp1vjhea.gif" alt="ç‰‡æ®µ"></p><br><p> å¦‚æœä¹‹åæ‚¨å¸Œæœ›ç»§ç»­æ”¹å–„å‘¨å›´ç¯å¢ƒï¼Œä½†è¿˜æ²¡æœ‰å¬è¯´è¿‡<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">é»„èœ‚åºŠå•ï¼Œé‚£ä¹ˆæ‚¨æ¥äº†</a> ã€‚ å¦å¤–ï¼Œå¦‚æœæ‚¨åœ¨ç¼–å†™PowerShellè„šæœ¬æ—¶æ‹¥æœ‰ä¸€ç»„å¯¹æ‚¨æœ‰ç”¨çš„æ‰©å±•ï¼Œæˆ‘å°†å¾ˆé«˜å…´åœ¨æ³¨é‡Šä¸­çœ‹åˆ°å®ƒä»¬çš„åˆ—è¡¨ã€‚ </p><br><h2 id="proizvoditelnost"> æ€§èƒ½è¡¨ç° </h2><br><p> æ€§èƒ½ä¸»é¢˜å¹¶ä¸åƒä¹çœ‹èµ·æ¥é‚£æ ·ç®€å•ã€‚ ä¸€æ–¹é¢ï¼Œè¿‡æ—©çš„ä¼˜åŒ–ä¼šå¤§å¤§é™ä½ä»£ç çš„å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ï¼Œä»è€ŒèŠ‚çœ300msçš„è„šæœ¬æ‰§è¡Œæ—¶é—´ï¼ˆé€šå¸¸è¿è¡Œæ—¶é—´ä¸ºååˆ†é’Ÿï¼‰ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®ƒä»¬çš„åº”ç”¨è‚¯å®šå…·æœ‰ç ´åæ€§ã€‚ å¦ä¸€æ–¹é¢ï¼Œæœ‰ä¸€äº›ç›¸å½“ç®€å•çš„æŠ€å·§å¯ä»¥æé«˜ä»£ç çš„å¯è¯»æ€§å’Œé€Ÿåº¦ï¼Œéå¸¸é€‚åˆç»å¸¸ä½¿ç”¨ã€‚ ä¸‹é¢ï¼Œæˆ‘å°†è®¨è®ºå…¶ä¸­çš„ä¸€äº›å†…å®¹ï¼Œå¦‚æœæ€§èƒ½æ»¡è¶³æ‚¨çš„æ‰€æœ‰éœ€æ±‚ï¼Œå¹¶ä¸”ç”±äºç»´æŠ¤æœŸé—´æœåŠ¡åœæœºçš„ä¸¥æ ¼æ—¶é—´é™åˆ¶ï¼Œå¯è¯»æ€§ä¼šè¢«å¿½ç•¥ï¼Œæˆ‘å»ºè®®æ‚¨å‚è€ƒ<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä¸“ä¸š</a>æ–‡çŒ®ã€‚ </p><br><h3 id="pipeline-i-foreach"> ç®¡é“å’Œforeach </h3><br><p> æé«˜ç”Ÿäº§ç‡çš„æœ€ç®€å•ä¸”å§‹ç»ˆå¯è¡Œçš„æ–¹æ³•æ˜¯é¿å…ä½¿ç”¨ç®¡é“ã€‚ ç”±äºå‡ºäºå®‰å…¨æ€§çš„è€ƒè™‘ï¼Œç±»å‹å®‰å…¨å’Œæ–¹ä¾¿ï¼ŒPowerShellé€šè¿‡ç®¡é“ä¼ é€’å…ƒç´ å°†æ¯ä¸ªå…ƒç´ åŒ…è£…åœ¨ä¸€ä¸ªå¯¹è±¡ä¸­ã€‚ åœ¨dotnetè¯­è¨€ä¸­ï¼Œæ­¤è¡Œä¸º<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ç§°ä¸ºboxing</a> ã€‚ æ‹³å‡»æ˜¯å¥½çš„ï¼Œå®ƒå¯ä»¥ä¿è¯å®‰å…¨æ€§ï¼Œä½†æ˜¯å®ƒæœ‰è‡ªå·±çš„ä»·æ ¼ï¼Œæœ‰æ—¶å€™ä»˜ä¸èµ·é’±ã€‚ </p><br><p> ç¬¬ä¸€æ­¥æ˜¯é€šè¿‡åˆ é™¤<code>Foreach-Object</code>æ‰€æœ‰åº”ç”¨ç¨‹åºå¹¶å°†å…¶æ›¿æ¢ä¸ºforeachè¯­å¥æ¥æé«˜æ€§èƒ½ï¼Œå¹¶æé«˜å¯è¯»æ€§ã€‚ æ‚¨å¯èƒ½ä¼šå› ä¸ºå®ƒä»¬å®é™…ä¸Šæ˜¯ä¸¤ä¸ªä¸åŒçš„å®ä½“è€Œæ„Ÿåˆ°å›°æƒ‘ï¼Œå› ä¸º<code>foreach</code>æ˜¯<code>Foreach-Object</code>çš„åˆ«å-å®é™…ä¸Šï¼Œä¸»è¦åŒºåˆ«åœ¨äº<code>foreach</code>ä¸æ¥å—ç®¡é“ä¸­çš„å€¼ï¼ŒåŒæ—¶å®ƒçš„è¿è¡Œé€Ÿåº¦å¿«äº†ä¸‰å€ã€‚ </p><br><p>  :        -  , ,          : </p><br><pre> <code class="plaintext hljs">Get-Content D:\temp\SomeHeavy.log | Select-String '328117'</code> </pre> <br><p>        â€”       ,      .         â€” ,        ,    <code>Get-Content</code> .                  <code>string</code>  ,    ,            .    â€”      ,         : </p><br><blockquote> When reading from and writing to binary files, use the AsByteStream parameter and a value of 0 for the ReadCount parameter. A ReadCount value of 0 reads the entire file in a single read operation. The default ReadCount value, 1, reads one byte in each read operation and converts each byte into a separate object, which causes errors when you use the Set-Content cmdlet to write the bytes to a file unless you use AsByteStream <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.management/get-content</a> </blockquote><br><pre> <code class="plaintext hljs">Get-Content D:\temp\SomeHeavy.log -ReadCount 0 | Select-String '328117'</code> </pre> <br><p>                : </p><br><p><img src="https://habrastorage.org/webt/t2/bg/hw/t2bghwyeop1gofgu_tapyqimp3o.png" alt="readcount"></p><br><p>        ,          .    <code>Select-String</code>          â€”       .                ,          <code>Select-String</code> .      ,      <code>Select-String</code>       ,        ,             : </p><br><pre> <code class="plaintext hljs">foreach ( $line in ( Get-Content D:\temp\SomeHeavy.log -ReadCount 0 )) { if ( $line -match '328117' ) { $line } }</code> </pre> <br><p>        30 , -   30%,           ,         ,        , - ,   (     ;-).      ,     .         ,    <code>-match</code> ;   â€”     .                ,      â€”               â€”   -   ,    . </p><br><p>   â€” -   ,   " "              : </p><br><pre> <code class="plaintext hljs">foreach ( $line in ( Get-Content D:\temp\SomeHeavy.log -ReadCount 0 )) { if ( $line -match '328117' ) { "$( Get-Date -UFormat '%d.%m.%Y %H:%M:%S') $line" | Out-File D:\temp\Result.log -Append } }</code> </pre> <br><p>     <code>Measure-Command</code> : </p><br><pre> <code class="plaintext hljs">Hours : 2 Minutes : 20 Seconds : 9 Milliseconds : 101</code> </pre> <br><p>   .   ,           ,          ,      .    ,    PowerShell           ,    ,       â€”        .         ,    ,            â€” <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">StringBuilder</a> .                 ,            ,           .          ,                     . </p><br><pre> <code class="plaintext hljs">$StringBuilder = New-Object System.Text.StringBuilder foreach ( $line in ( Get-Content D:\temp\SomeHeavy.log -ReadCount 0 )) { if ( $line -match '328117' ) { $null = $StringBuilder.AppendLine( "$( Get-Date -UFormat '%d.%m.%Y %H:%M:%S') $line" ) } } Out-File -InputObject $StringBuilder.ToString() -FilePath D:\temp\Result.log -Append -Encoding UTF8</code> </pre> <br><p>      5 ,      : </p><br><pre> <code class="plaintext hljs">Hours : 0 Minutes : 5 Seconds : 37 Milliseconds : 150</code> </pre> <br><p>    <code>Out-File -InputObject</code> ,    ,       .          â€”        <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">   </a>    .              â€”  <code>Get-Help</code>     <code>-Full</code> ,         <code>Accept pipeline input? true (ByValue)</code> : </p><br><pre> <code class="plaintext hljs">-InputObject &lt;psobject&gt; Required? false Position? Named Accept pipeline input? true (ByValue) Parameter set name (All) Aliases None Dynamic? false</code> </pre> <br><p>    PowerShell     : </p><br><p><img src="https://habrastorage.org/webt/8d/zl/r-/8dzlr-yjpt13avpi_wjibzdpnxs.png" alt="taskmgr"></p><br><p>    <code>StringBuilder</code>                           : </p><br><p><img src="https://habrastorage.org/webt/lc/4j/1c/lc4j1c3-um9jozjohlauurwzo3a.png" alt="stringbuilder alloc"></p><br><p>    ,    ,  3  3.        dotnet-      â€” <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">StreamReader</a> . </p><br><pre> <code class="plaintext hljs">$StringBuilder = New-Object System.Text.StringBuilder $StreamReader = New-Object System.IO.StreamReader 'D:\temp\SomeHeavy.log' while ( $line = $StreamReader.ReadLine()) { if ( $line -match '328117' ) { $null = $StringBuilder.AppendLine( "$( Get-Date -UFormat '%d.%m.%Y %H:%M:%S') $line" ) } } $StreamReader.Dispose() Out-File -InputObject $StringBuilder.ToString() -FilePath C:\temp\Result.log -Append -Encoding UTF8</code> </pre> <br><pre> <code class="plaintext hljs">Hours : 0 Minutes : 5 Seconds : 33 Milliseconds : 657</code> </pre> <br><p>      ,       .               ,     ,       ,    ,          2.        ,          : </p><br><p><img src="https://habrastorage.org/webt/wr/ka/_w/wrka_wcvj1idodxx_37ka8wnhmm.png" alt="streamreader"></p><br><p>        â€”      "",   â€”  <code>StringBuilder</code> â€” ""       .   ,      (  100)           .       â€”       90%    (        ,     ): </p><br><pre> <code class="plaintext hljs">$BufferSize = 104857600 $StringBuilder = New-Object System.Text.StringBuilder $BufferSize $StreamReader = New-Object System.IO.StreamReader 'C:\temp\SomeHeavy.log' while ( $line = $StreamReader.ReadLine()) { if ( $line -match '1443' ) { #      if ( $StringBuilder.Length -gt ( $BufferSize - ( $BufferSize * 0.1 ))) { Out-File -InputObject $StringBuilder.ToString() -FilePath C:\temp\Result.log -Append -Encoding UTF8 $StringBuilder.Clear() } $null = $StringBuilder.AppendLine( "$( Get-Date -UFormat '%d.%m.%Y %H:%M:%S') $line" ) } } Out-File -InputObject $StringBuilder.ToString() -FilePath C:\temp\Result.log -Append -Encoding UTF8 $StreamReader.Dispose()</code> </pre> <br><pre> <code class="plaintext hljs">Hours : 0 Minutes : 5 Seconds : 53 Milliseconds : 417</code> </pre> <br><p>     1      : </p><br><p><img src="https://habrastorage.org/webt/rg/ro/f6/rgrof6lxdcrx96urvmxuflcbdbc.png" alt="streamreader with dump"></p><br><p>              ,                 .     ,      ,        <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">StreamWriter</a> ,   ,   ;-)      ,        ,    . </p><br><p> -     â€”     ,        .    ,     â€”  .  <code>Select-String</code>  <code>Out-File</code>    ,        <code>OutOfMemoryException</code> ,    â€”    . </p><br><h3 id="nativnye-binarniki">   </h3><br><p> ,      PowerShell         ,         â€” ,  : PowerShell â€”          ,     . </p><br><p>  ,       <code>StringBuilder</code>     <code>dir</code> â€”          (  ).          : </p><br><pre> <code class="plaintext hljs">$CurrentPath = ( Get-Location ).Path + '\' $StringBuilder = New-Object System.Text.StringBuilder foreach ( $Line in ( &amp;cmd /c dir /b /s /ad )) { $null = $StringBuilder.AppendLine( $Line.Replace( $CurrentPath, '.' )) } $StringBuilder.ToString()</code> </pre> <br><pre> <code class="plaintext hljs">Hours : 0 Minutes : 0 Seconds : 3 Milliseconds : 9</code> </pre> <br><pre> <code class="plaintext hljs">$StringBuilder = New-Object System.Text.StringBuilder foreach ( $Line in ( Get-ChildItem -File -Recurse | Resolve-Path -Relative )) { $null = $StringBuilder.AppendLine( $Line ) } $StringBuilder.ToString()</code> </pre> <br><pre> <code class="plaintext hljs">Hours : 0 Minutes : 0 Seconds : 16 Milliseconds : 337</code> </pre> <br><p>     $null â€”     .  ,    â€”    <code>Out-Null</code> ;  ,    (   <code>$null</code> )     ,   . </p><br><pre> <code class="plaintext hljs"># : $null = $StringBuilder.AppendLine( $Line ) # : $StringBuilder.AppendLine( $Line ) | Out-Null</code> </pre> <br><p>           ,          ,  .      <code>Compare-Object</code> ,      ,      ,       .            robocopy.exe,      (   PowerShell 5),      : </p><br><pre> <code class="plaintext hljs">class Robocopy { [String]$RobocopyPath Robocopy () { $this.RobocopyPath = Join-Path $env:SystemRoot 'System32\Robocopy.exe' if ( -not ( Test-Path $this.RobocopyPath -PathType Leaf )) { throw '    ' } } [void]CopyFile ( [String]$SourceFile, [String]$DestinationFolder ) { $this.CopyFile( $SourceFile, $DestinationFolder, $false ) } [void]CopyFile ( [String]$SourceFile, [String]$DestinationFolder, [bool]$Archive ) { $FileName = [IO.Path]::GetFileName( $SourceFile ) $FolderName = [IO.Path]::GetDirectoryName( $SourceFile ) $Arguments = @( '/R:0', '/NP', '/NC', '/NS', '/NJH', '/NJS', '/NDL' ) if ( $Archive ) { $Arguments += $( '/A+:a' ) } $ErrorFlag = $false &amp;$this.RobocopyPath $FolderName $DestinationFolder $FileName $Arguments | Foreach-Object { if ( $ErrorFlag ) { $ErrorFlag = $false throw "$_ $ErrorString" } else { if ( $_ -match '(?&lt;=\(0x[\da-f]{8}\))(?&lt;text&gt;(.+$))' ) { $ErrorFlag = $true $ErrorString = $matches.text } else { $Logger.AddRecord( $_.Trim()) } } } if ( $LASTEXITCODE -eq 8 ) { throw 'Some files or directories could not be copied' } if ( $LASTEXITCODE -eq 16 ) { throw 'Robocopy did not copy any files. Check the command line parameters and verify that Robocopy has enough rights to write to the destination folder.' } } [void]SyncFolders ( [String]$SourceFolder, [String]$DestinationFolder ) { $this.SyncFolders( $SourceFolder, $DestinationFolder, '*.*', '', $false ) } [void]SyncFolders ( [String]$SourceFolder, [String]$DestinationFolder, [Bool]$Archive ) { $this.SyncFolders( $SourceFolder, $DestinationFolder, '*.*', '', $Archive ) } [void]SyncFolders ( [String]$SourceFolder, [String]$DestinationFolder, [String]$Include ) { $this.SyncFolders( $SourceFolder, $DestinationFolder, $Include, '', $false ) } [void]SyncFolders ( [String]$SourceFolder, [String]$DestinationFolder, [String]$Include, [Bool]$Archive ) { $this.SyncFolders( $SourceFolder, $DestinationFolder, $Include, '', $Archive ) } [void]SyncFolders ( [String]$SourceFolder, [String]$DestinationFolder, [String]$Include, [String]$Exclude ) { $this.SyncFolders( $SourceFolder, $DestinationFolder, $Include, $Exclude, $false ) } [void]SyncFolders ( [String]$SourceFolder, [String]$DestinationFolder, [String]$Include, [String]$Exclude, [Bool]$Archive ) { $Arguments = @( '/MIR', '/R:0', '/NP', '/NC', '/NS', '/NJH', '/NJS', '/NDL' ) if ( $Exclude ) { $Arguments += $( '/XF' ) $Arguments += $Exclude.Split(' ') } if ( $Archive ) { $Arguments += $( '/A+:a' ) } $ErrorFlag = $false &amp;$this.RobocopyPath $SourceFolder $DestinationFolder $Include $Arguments | Foreach-Object { if ( $ErrorFlag ) { $ErrorFlag = $false throw "$_ $ErrorString" } else { if ( $_ -match '(?&lt;=\(0x[\da-f]{8}\))(?&lt;text&gt;(.+$))' ) { $ErrorFlag = $true $ErrorString = $matches.text } else { $Logger.AddRecord( $_.Trim()) } } } if ( $LASTEXITCODE -eq 8 ) { throw 'Some files or directories could not be copied' } if ( $LASTEXITCODE -eq 16 ) { throw 'Robocopy did not copy any files. Check the command line parameters and verify that Robocopy has enough rights to write to the destination folder.' } } }</code> </pre> <br><p>                ,             (      ),         â€”    . </p><br><p>   ,   :        <code>Foreach-Object</code> !?  ,             :    <code>foreach</code> ,  <code>Foreach-Object</code>          â€”   ,   , ,   ,      .       . </p><br><p>       ,     : </p><br><pre> <code class="plaintext hljs">$Robocopy = New-Object Robocopy #    $Robocopy.CopyFile( $Source, $Dest ) #   $Robocopy.SyncFolders( $SourceDir, $DestDir ) #    .xml     $Robocopy.SyncFolders( $SourceDir, $DestDir , '*.xml', $true ) #     *.zip *.tmp *.log     $Robocopy.SyncFolders( $SourceDir, $DestDir, '*.*', '*.zip *.tmp *.log', $true )</code> </pre> <br><h3 id="poslevkusie">  </h3><br><p>        â€”           ,       ,            ;   ,        ,   ,     : </p><br><ul><li><p>   <code>foreach</code>   <code>Foreach-Object</code>  ; </p><br></li><li><p>   ; </p><br></li><li><p> /  ,   ; </p><br></li><li><p>  <code>StringBuilder</code>    ; </p><br></li><li><p>      ,   - ; </p><br></li><li><p>      ( ""    ); </p><br></li></ul><br><p>     :    -   ,     . </p><br><h2 id="jobs"> Jobs </h2><br><p>  ,     ,        ,    ,      ,        ,     .            .      ,      IO,               . </p><br><div class="spoiler"> <b class="spoiler_title">    ssd</b> <div class="spoiler_text"><p>       Windows Server 2019  Hyper-V  ssd (    hdd): </p><br><p><img src="https://habrastorage.org/webt/mo/eu/jf/moeujfnupkxphhi7uso_hjbzsys.jpeg" alt="2019ssd"></p></div></div><br><p>    PowerShell       ( <code>Get-Command *-Job</code> ),    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="> </a> . </p><br><p>      ,  ,  ,     : </p><br><pre> <code class="plaintext hljs">$Job = Start-Job -ScriptBlock { Write-Output 'Good night' Start-Sleep -S 10 Write-Output 'Good morning' } $Job | Wait-Job | Receive-Job Remove-Job $Job</code> </pre> <br><p>          ,         â€”       ,    .             <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">     </a> . </p><br><p>      ,      : </p><br><p><img src="https://habrastorage.org/webt/gc/um/r-/gcumr-9xsk2fh5c5m7epk1eozqg.png" alt="jobs"><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">https://xaegr.wordpress.com/2011/07/12/threadping/</a> </p><br><p> ,      ,   â€”     ,                 .  , ,     (50  â€”  50 ): </p><br><p><img src="https://habrastorage.org/webt/3f/pg/xg/3fpgxg51u9augjj9iua05wm6fgi.png" alt="job dies"></p><br><p>           .    ,  â€”            ,        .     â€”           ,    . </p><br><p>   ,           , ,              - . </p><br><h2 id="runspaces"> Runspaces </h2><br><p>                  â€” <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Beginning Use of PowerShell Runspaces: Part 1</a> . ,  â€”    PowerShell        ,        .             (,    PowerShell ),       :      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">       (  )</a>       .        ,            . </p><br><p>          <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">WPF </a> ,              PowerShell,     .      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="> </a> â€”      ,   .    â€”            ,         "" .     . </p><br><p>       ,      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">           </a> . </p><br><p><img src="https://habrastorage.org/webt/cx/pp/7v/cxpp7vozkcxdsl_ibdyva0_z3wi.gif" alt="wpf"></p><br><pre> <code class="plaintext hljs">#     $GUISyncHash = [hashtable]::Synchronized(@{}) &lt;# WPF  #&gt; $GUISyncHash.FormXAML = [xml](@" &lt;Window xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" Title="Sample WPF Form" Height="510" Width="410" ResizeMode="NoResize"&gt; &lt;Grid&gt; &lt;Label Content=" " HorizontalAlignment="Left" Margin="10,10,0,0" VerticalAlignment="Top" Height="37" Width="374" FontSize="18"/&gt; &lt;Label Content="" HorizontalAlignment="Left" Margin="16,64,0,0" VerticalAlignment="Top" Height="26" Width="48"/&gt; &lt;TextBox x:Name="BackupPath" HorizontalAlignment="Left" Height="23" Margin="69,68,0,0" TextWrapping="Wrap" Text="" VerticalAlignment="Top" Width="300"/&gt; &lt;Label Content="" HorizontalAlignment="Left" Margin="16,103,0,0" VerticalAlignment="Top" Height="26" Width="35"/&gt; &lt;TextBox x:Name="RestorePath" HorizontalAlignment="Left" Height="23" Margin="69,107,0,0" TextWrapping="Wrap" Text="" VerticalAlignment="Top" Width="300"/&gt; &lt;Button x:Name="FirstButton" Content="âˆš" HorizontalAlignment="Left" Margin="357,68,0,0" VerticalAlignment="Top" Width="23" Height="23"/&gt; &lt;Button x:Name="SecondButton" Content="âˆš" HorizontalAlignment="Left" Margin="357,107,0,0" VerticalAlignment="Top" Width="23" Height="23"/&gt; &lt;CheckBox x:Name="Check" Content="  " HorizontalAlignment="Left" Margin="16,146,0,0" VerticalAlignment="Top" RenderTransformOrigin="-0.113,-0.267" Width="172"/&gt; &lt;Button x:Name="Go" Content="Go" HorizontalAlignment="Left" Margin="298,173,0,0" VerticalAlignment="Top" Width="82" Height="26"/&gt; &lt;ComboBox x:Name="Droplist" HorizontalAlignment="Left" Margin="16,173,0,0" VerticalAlignment="Top" Width="172" Height="26"/&gt; &lt;ListBox x:Name="ListBox" HorizontalAlignment="Left" Height="250" Margin="16,210,0,0" VerticalAlignment="Top" Width="364"/&gt; &lt;/Grid&gt; &lt;/Window&gt; "@) &lt;#   #&gt; $GUISyncHash.GUIThread = { $GUISyncHash.Window = [Windows.Markup.XamlReader]::Load(( New-Object System.Xml.XmlNodeReader $GUISyncHash.FormXAML )) $GUISyncHash.Check = $GUISyncHash.Window.FindName( "Check" ) $GUISyncHash.GO = $GUISyncHash.Window.FindName( "Go" ) $GUISyncHash.ListBox = $GUISyncHash.Window.FindName( "ListBox" ) $GUISyncHash.BackupPath = $GUISyncHash.Window.FindName( "BackupPath" ) $GUISyncHash.RestorePath = $GUISyncHash.Window.FindName( "RestorePath" ) $GUISyncHash.FirstButton = $GUISyncHash.Window.FindName( "FirstButton" ) $GUISyncHash.SecondButton = $GUISyncHash.Window.FindName( "SecondButton" ) $GUISyncHash.Droplist = $GUISyncHash.Window.FindName( "Droplist" ) $GUISyncHash.Window.Add_SourceInitialized({ $GUISyncHash.GO.IsEnabled = $true }) $GUISyncHash.FirstButton.Add_Click( { $GUISyncHash.ListBox.Items.Add( 'Click FirstButton' ) }) $GUISyncHash.SecondButton.Add_Click( { $GUISyncHash.ListBox.Items.Add( 'Click SecondButton' ) }) $GUISyncHash.GO.Add_Click( { $GUISyncHash.ListBox.Items.Add( 'Click GO' ) }) $GUISyncHash.Window.Add_Closed( { Stop-Process -Id $PID -Force }) $null = $GUISyncHash.Window.ShowDialog() } $Runspace = @{} $Runspace.Runspace = [RunspaceFactory]::CreateRunspace() $Runspace.Runspace.ApartmentState = "STA" $Runspace.Runspace.ThreadOptions = "ReuseThread" $Runspace.Runspace.Open() $Runspace.psCmd = { Add-Type -AssemblyName PresentationCore, PresentationFramework, WindowsBase }.GetPowerShell() $Runspace.Runspace.SessionStateProxy.SetVariable( 'GUISyncHash', $GUISyncHash ) $Runspace.psCmd.Runspace = $Runspace.Runspace $Runspace.Handle = $Runspace.psCmd.AddScript( $GUISyncHash.GUIThread ).BeginInvoke() Start-Sleep -S 1 $GUISyncHash.ListBox.Dispatcher.Invoke( "Normal", [action] { $GUISyncHash.ListBox.Items.Add( '' ) }) $GUISyncHash.ListBox.Dispatcher.Invoke( "Normal", [action] { $GUISyncHash.ListBox.Items.Add( '  ' ) }) foreach ( $item in 1..5 ) { $GUISyncHash.Droplist.Dispatcher.Invoke( "Normal", [action] { $GUISyncHash.Droplist.Items.Add( $item ) $GUISyncHash.Droplist.SelectedIndex = 0 }) } $GUISyncHash.ListBox.Dispatcher.Invoke( "Normal", [action] { $GUISyncHash.ListBox.Items.Add( 'While ( $true ) { Start-Sleep -S 10 }' ) }) while ( $true ) { Start-Sleep -S 10 }</code> </pre> <br><p>      WPF       github,       ,       smart : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">https://github.com/snd3r/GetDiskSmart/</a> .          ,    MVVM: </p><br><p><img src="https://habrastorage.org/webt/ke/-1/mb/ke-1mbcf2zuyg6crqt70zx4aoqw.png" alt="binging"></p><br><p>        Visual Studio,            Community Edition                 ,          xaml-  wpf â€” <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">https://github.com/punker76/kaxaml</a> </p><br><p><img src="https://habrastorage.org/webt/wf/wd/j1/wfwdj1mhk_f8bml8clv3n6sv02a.png" alt="kaxaml"></p><br><h2 id="vmesto-zaklyucheniya"> è€Œä¸æ˜¯ç»“è®º </h2><br><p> PowerShell â€”        Windows-.   ,      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">  </a> ,           ,            . </p><br><p>      ,                ,   "PowerShell,  ",   .           ,        â€”     ,      .                 .          ,  -    , -                . </p><br><p>          â€”    . </p><br><p><img src="https://habrastorage.org/webt/fd/qg/_1/fdqg_1uamuh8rc66ahep2utydeo.png" alt="calm"></p><br><p> PS <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" class="user_link">Boomburum</a> ,    2019   powershell â€”  . </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN443256/">https://habr.com/ru/post/zh-CN443256/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN443246/index.html">åœ¨å¼€å‘å•†å‡ºå”®å¹¶å…³é—­é¡¹ç›®åï¼Œæˆ‘ä»¬å¦‚ä½•é‡å¡‘Askozia IP PBX</a></li>
<li><a href="../zh-CN443248/index.html">PRPå’ŒHSRçš„æ— ç¼ä¿ç•™åè®®</a></li>
<li><a href="../zh-CN443250/index.html">OpenJDKçš„è‡ªåˆ¶åƒåœ¾æ”¶é›†å™¨</a></li>
<li><a href="../zh-CN443252/index.html">å¸¦å†…å­˜çš„æ¨¡å—åŒ–èš‚èšæœºå™¨äºº</a></li>
<li><a href="../zh-CN443254/index.html">æµ·å«ä¸€æ˜¯æœ€è‡´å‘½çš„ç—…æ¯’</a></li>
<li><a href="../zh-CN443258/index.html">Gotify-ä¸€ä¸ªç”¨äºå‘é€é€šçŸ¥å¹¶å°†æ¶ˆæ¯å‘é€åˆ°æœåŠ¡å™¨çš„å¼€æºé¡¹ç›®</a></li>
<li><a href="../zh-CN443260/index.html">è¿ç§»åˆ°Zimbraï¼Œè€Œä¸ä¼šå†’ç€ä½¿ç”¨é€šç”¨åŸŸåè¿›è¡Œä¸šåŠ¡çš„é£é™©</a></li>
<li><a href="../zh-CN443264/index.html">ä»–è®²è¯å¹¶è¡¨ç¤ºï¼šä¹Œå…‹å…°æµè¡Œæ”¿å®¢çš„è¨€è¾æ˜¯å¦æœ‰æ‰€ä¸åŒï¼Ÿ</a></li>
<li><a href="../zh-CN443266/index.html">æˆ‘ä»¬å¦‚ä½•å¸®åŠ©å¤§å‹èƒ½æºå…¬å¸è½¬å˜ä¼šè®¡å·¥ä½œ</a></li>
<li><a href="../zh-CN443268/index.html">éªŒå°¸ï¼šå…³æ³¨ä¸­é—´ä»¶æˆ–æˆ‘ä»¬å¦‚ä½•ç ´åè¯„è®º</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>