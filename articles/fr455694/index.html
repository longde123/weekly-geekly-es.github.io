<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üå•Ô∏è üë©üèæ‚Äç‚öïÔ∏è üèÇüèæ Architecture de facturation de nouvelle g√©n√©ration: transition vers Tarantool üî∏ üÜñ üß¶</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Pourquoi une soci√©t√© comme MegaFon, Tarantool dans la facturation? De l'ext√©rieur, il semble que le vendeur vienne habituellement, apporte une grosse ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Architecture de facturation de nouvelle g√©n√©ration: transition vers Tarantool</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/mailru/blog/455694/">  Pourquoi une soci√©t√© comme MegaFon, Tarantool dans la facturation?  De l'ext√©rieur, il semble que le vendeur vienne habituellement, apporte une grosse bo√Æte, branche la prise dans la prise - voici la facturation!  C'√©tait le cas, mais maintenant c'est un archa√Øque, et de tels dinosaures ont d√©j√† disparu ou sont en train de dispara√Ætre.  Au d√©part, la facturation est un syst√®me de facturation - un lecteur ou une calculatrice.  Dans les t√©l√©communications modernes, il s'agit d' <b>un syst√®me d'automatisation pour l'ensemble du cycle de vie de l'interaction avec l'abonn√©, de la conclusion du contrat √† la r√©siliation</b> , en <b>passant par la</b> facturation en temps r√©el, l'acceptation des paiements et bien plus encore.  La facturation dans les entreprises de t√©l√©communications est similaire √† un robot de combat - grand, puissant et accroch√© avec des armes. <br><br><img src="https://habrastorage.org/webt/fm/qq/n0/fmqqn0374oz43yleqaghmzfmh3i.jpeg"><br><br>  Et voici Tarantool?  <b>Oleg Ivlev</b> et <b>Andrey Knyazev</b> en parleront.  Oleg est l'architecte en chef de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">MegaFon</a> avec une vaste exp√©rience de travail dans des soci√©t√©s √©trang√®res, Andrey est le directeur des syst√®mes commerciaux.  √Ä partir de la transcription de leur rapport √† la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">conf√©rence Tarantool 2018,</a> vous apprendrez pourquoi la R&amp;D est n√©cessaire dans les entreprises, ce qu'est Tarantool, comment l'impasse pour la mise √† l'√©chelle verticale et la mondialisation est devenue les conditions pr√©alables √† l'√©mergence de cette base de donn√©es dans l'entreprise, sur les d√©fis technologiques, la transformation de l'architecture et comment le technostek de MegaFon ressemble √† Netflix, Google et Amazon. <br><a name="habracut"></a><br><iframe width="560" height="315" src="https://www.youtube.com/embed/bW24mJwSllQ" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br><h2>  Projet de facturation unique </h2><br>  Le projet qui sera discut√© est appel√© "facturation unique".  C'est en lui que Tarantool a montr√© ses meilleures qualit√©s. <br><br><img src="https://habrastorage.org/webt/gz/zv/uz/gzzvuztrluedxrko5az64xmlqs4.jpeg"><br><br>  La croissance des performances des √©quipements Hi-End n'a pas suivi la croissance de la base d'abonn√©s et l'augmentation du nombre de services, une nouvelle croissance du nombre d'abonn√©s et de services due au M2M, l'IoT √©tait attendue et les caract√©ristiques des succursales ont entra√Æn√© une d√©t√©rioration du d√©lai de mise sur le march√©.  L'entreprise a d√©cid√© de cr√©er un syst√®me d'entreprise unique avec une architecture modulaire unique de classe mondiale, au lieu de 8 syst√®mes de facturation diff√©rents actuels. <br><br>  <b>MegaFon, c'est huit entreprises en une</b> .  En 2009, la r√©organisation a √©t√© achev√©e: les succursales de toute la Russie ont fusionn√© en une seule soci√©t√© MegaFon OJSC (aujourd'hui PJSC).  Ainsi, l'entreprise dispose de 8 syst√®mes de facturation avec ses propres solutions ¬´sur mesure¬ª, des fonctionnalit√©s d'agence et une structure organisationnelle diff√©rente, informatique et marketing. <br><br>  Tout allait bien jusqu'√† ce que je doive lancer un produit f√©d√©ral commun.  Beaucoup de difficult√©s sont apparues ici: pour certains, tarification avec arrondi, pour d'autres dans une moindre mesure, et pour d'autres - selon la moyenne arithm√©tique.  Il y a des milliers de tels moments. <br><br>  Malgr√© le fait que la version du syst√®me de facturation soit la m√™me, un seul fournisseur, les r√©glages ont diverg√© de sorte que la colle depuis longtemps.  Nous avons essay√© de r√©duire leur nombre et sommes tomb√©s sur un deuxi√®me probl√®me qui est familier √† de nombreuses soci√©t√©s. <br><br>  <b>Mise √† l'√©chelle verticale</b> .  M√™me le fer le plus frais de l'√©poque ne r√©pondait pas aux besoins.  Nous avons utilis√© de l'√©quipement Hewlett-Packard, la ligne Superdome Hi-End, mais cela n'a pas attir√© le besoin de deux branches.  Je voulais une mise √† l'√©chelle horizontale sans grands co√ªts de transaction et investissements en capital. <br><br>  <b>Attente de croissance du nombre d'abonn√©s et de services</b> .  Les consultants ont depuis longtemps apport√© des histoires sur l'IoT et le M2M dans le monde des t√©l√©communications: il arrivera un moment o√π chaque t√©l√©phone et fer aura une carte SIM et deux dans le r√©frig√©rateur.  Aujourd'hui, nous avons un certain nombre d'abonn√©s, et dans un proche avenir, il y aura un ordre de grandeur de plus. <br><br><h2>  D√©fis technologiques </h2><br>  Ces quatre raisons nous ont conduits √† des changements majeurs.  Il y avait le choix entre la mise √† niveau du syst√®me et la conception √† partir de z√©ro.  Ils ont r√©fl√©chi longtemps, pris des d√©cisions s√©rieuses, jou√© des appels d'offres.  En cons√©quence, ils ont d√©cid√© de concevoir d√®s le d√©but et ont relev√© des d√©fis int√©ressants - des d√©fis technologiques. <br><br><h3>  √âvolutivit√© </h3><br>  S'il y avait auparavant, disons, <b>8 comptes de facturation pour 15 millions d'abonn√©s</b> , et maintenant <b>100 millions d'abonn√©s et plus</b> auraient d√ª se produire - la charge est d'un ordre de grandeur plus √©lev√©. <br><br><blockquote>  Notre √©chelle est devenue comparable √† celle des principaux acteurs Internet comme Mail.ru ou Netflix. </blockquote><br>  Mais de nouveaux mouvements pour augmenter la charge et la base d'abonn√©s nous ont pos√© de s√©rieux d√©fis. <br><br><h3>  La g√©ographie de notre vaste pays </h3><br>  Entre Kaliningrad et Vladivostok <b>7500 km et 10 fuseaux horaires</b> .  La vitesse de la lumi√®re est finie et √† de tels d√©lais, les distances sont d√©j√† importantes.  150 ms sur les canaux optiques modernes les plus cool est un peu trop pour la facturation en temps r√©el, en particulier comme c'est le cas actuellement dans les t√©l√©communications en Russie.  De plus, vous devez effectuer la mise √† jour en un jour ouvrable et avec des fuseaux horaires diff√©rents - c'est un probl√®me. <br><br>  Nous ne fournissons pas seulement des services moyennant des frais mensuels, nous avons des tarifs complexes, des forfaits, divers modificateurs.  Nous devons non seulement autoriser ou interdire √† l'abonn√© de parler, mais lui donner un certain quota - pour calculer les appels et les actions en temps r√©el afin qu'il ne le remarque pas. <br><br><h3>  Tol√©rance aux pannes </h3><br><blockquote>  C'est le revers de la centralisation. </blockquote><br>  Si nous rassemblons tous les abonn√©s dans un seul syst√®me, les √©v√©nements d'urgence et les catastrophes sont d√©sastreux pour les entreprises.  Par cons√©quent, nous concevons le syst√®me de mani√®re √† exclure l'effet des accidents sur l'ensemble de la base d'abonn√©s. <br><br>  C'est l√† encore une cons√©quence du rejet de la mise √† l'√©chelle verticale.  Lorsque nous sommes pass√©s √† une mise √† l'√©chelle horizontale, nous avons augment√© le nombre de serveurs de centaines √† des milliers.  Ils doivent √™tre g√©r√©s et interchangeables, une infrastructure informatique sauvegard√©e automatiquement et un syst√®me distribu√© restaur√©. <br><br>  Ces d√©fis int√©ressants nous ont confront√©s.  Nous avons con√ßu le syst√®me, et √† ce moment-l√†, nous avons essay√© de trouver les meilleures pratiques mondiales afin de v√©rifier √† quel point nous sommes en tendance, √† quel point nous suivons des technologies avanc√©es. <br><br><h2>  Exp√©rience mondiale </h2><br><blockquote>  √âtonnamment, dans le monde des t√©l√©communications, nous n'avons trouv√© aucune r√©f√©rence. </blockquote><br>  L'Europe a chut√© par le nombre d'abonn√©s et l'√©chelle, les √âtats-Unis - par le plan de ses tarifs.  Nous avons regard√© quelque chose en Chine, mais avons trouv√© quelque chose en Inde et avons pris des sp√©cialistes de Vodafone India. <br><br>  Pour analyser l'architecture, la Dream Team a √©t√© constitu√©e, dirig√©e par IBM, des architectes de divers domaines.  Ces personnes pourraient √©valuer ad√©quatement ce que nous faisons et apporter certaines connaissances √† notre architecture. <br><br><h2>  Echelle </h2><br>  Quelques chiffres pour illustrer. <br><br>  Nous concevons un syst√®me pour <b>80 millions d'abonn√©s avec une r√©serve d'un milliard</b> .  Nous supprimons donc les futurs seuils.  Ce n'est pas parce que nous allons prendre le contr√¥le de la Chine, mais √† cause de la pression de l'IoT et du M2M. <br><br>  <b>300 millions de documents sont trait√©s en temps r√©el</b> .  Bien que nous ayons 80 millions d'abonn√©s, nous travaillons avec des clients potentiels et ceux qui nous ont quitt√©s si nous avons besoin de recouvrer des cr√©ances.  Par cons√©quent, les volumes r√©els sont beaucoup plus importants. <br><br>  <b>2 milliards de transactions</b> changent quotidiennement l'√©quilibre - ce sont les paiements, les frais, les appels et autres √©v√©nements.  <b>200 To de donn√©es changent activement</b> , <b>8 PB de donn√©es</b> changent un peu plus lentement, et ce n'est pas une archive, mais des donn√©es en direct dans une seule facturation.  L'√©chelle du <b>centre de</b> donn√©es est de <b>5 000 serveurs r√©partis sur 14 sites</b> . <br><br><h2>  Pile technologique </h2><br>  Lorsque nous avons planifi√© l'architecture et commenc√© √† assembler le syst√®me, nous avons import√© les technologies les plus int√©ressantes et les plus avanc√©es.  Le r√©sultat a √©t√© une pile technologique famili√®re √† tout joueur Internet et √† toutes les soci√©t√©s qui fabriquent des syst√®mes tr√®s charg√©s. <br><br><img src="https://habrastorage.org/webt/cq/km/ys/cqkmyscpadcxt7nokj1_y_fwlny.jpeg"><br><br>  La pile est similaire aux piles des autres acteurs majeurs: Netflix, Twitter, Viber.  Il se compose de 6 composants, mais nous voulons le r√©duire et l'unifier. <br><br><blockquote>  La flexibilit√© est bonne, mais dans une grande entreprise, il n'y a aucun moyen sans l'unification. </blockquote><br>  Nous n'allons pas changer le m√™me Oracle en Tarantool.  Dans la r√©alit√© des grandes entreprises, c'est de l'utopie, ou une croisade de 5 √† 10 ans avec un d√©nouement incompr√©hensible.  Mais Cassandra et Couchbase peuvent √™tre remplac√©s par Tarantool, et nous nous y engageons. <br><br><h2>  Pourquoi Tarantool? </h2><br>  Il y a 4 crit√®res simples pour lesquels nous avons choisi cette base de donn√©es. <br><br>  <b>La vitesse</b> .  Nous avons effectu√© des tests de r√©sistance sur les syst√®mes industriels MegaFon.  Tarantool a gagn√© - il a montr√© la meilleure performance. <br><br>  Cela ne veut pas dire que d'autres syst√®mes ne r√©pondent pas aux besoins de MegaFon.  Les solutions de m√©moire actuelles sont si productives que ce stock de l'entreprise est plus que suffisant.  Mais nous sommes int√©ress√©s √† traiter avec le leader, et non avec celui qui tisse dans la queue, y compris le test de charge. <br><br><blockquote>  Tarantool couvre les besoins de l'entreprise m√™me √† long terme. </blockquote><br>  <b>Co√ªt du TCO</b> .  La prise en charge de Couchbase sur les volumes MegaFon co√ªte de l'argent, avec Tarantool, la situation est beaucoup plus agr√©able et en termes de fonctionnalit√©s, ils sont proches. <br><br>  Une autre fonctionnalit√© int√©ressante qui a l√©g√®rement influenc√© notre choix - Tarantool fonctionne mieux que les autres bases de donn√©es avec m√©moire.  Il montre <b>une efficacit√© maximale</b> . <br><br>  <b>Fiabilit√©</b>  MegaFon est investi dans la fiabilit√©, probablement pas comme les autres.  Par cons√©quent, lorsque nous avons examin√© Tarantool, nous avons r√©alis√© ce qui devait √™tre fait pour qu'il r√©ponde √† nos exigences. <br><br>  Nous avons investi notre temps et nos finances, et avec Mail.ru, nous avons cr√©√© une version d'entreprise, qui est maintenant utilis√©e par plusieurs autres soci√©t√©s. <br><br><blockquote>  Tarantool-enterprise nous a pleinement satisfaits de la s√©curit√©, de la fiabilit√© et de la journalisation. </blockquote><br><h3>  Partenariat </h3><br>  La chose la plus importante pour moi est <b>le contact direct avec le d√©veloppeur</b> .  C'est exactement ce que les gars de Tarantool ont corrompu. <br><br>  Si vous venez √† un joueur, en particulier celui qui travaille avec un client d'ancrage, et dites que vous avez besoin de la base de donn√©es pour pouvoir faire ceci, ceci et cela, cela r√©pond g√©n√©ralement: <br><br>  <i>- Eh bien, mettez les exigences sous le bas de cette pile - un jour, probablement, nous y arriverons.</i> <br><br>  Beaucoup ont une feuille de route pour les 2-3 prochaines ann√©es, et il est presque impossible de s'y int√©grer, et les d√©veloppeurs de Tarantool soudoient avec ouverture, et pas seulement avec MegaFon, et adaptent leur syst√®me au client.  C'est cool et nous l'aimons vraiment. <br><br><h2>  O√π avons-nous appliqu√© Tarantool </h2><br>  Chez nous, Tarantool est utilis√© dans plusieurs √©l√©ments.  <b>Le premier est dans le pilote</b> , que nous avons fait sur le syst√®me d'annuaire d'adresses.  √Ä un moment donn√©, je voulais que ce soit un syst√®me similaire √† Yandex.Maps et Google Maps, mais cela s'est av√©r√© un peu diff√©rent. <br><br>  Par exemple, le r√©pertoire d'adresses dans l'interface de vente.  Sur Oracle, trouver l'adresse dont vous avez besoin prend 12-13 s.  - num√©ros inconfortables.  Lorsque nous passons √† Tarantool, rempla√ßons Oracle par une autre base de donn√©es dans la console et effectuons la m√™me recherche, nous obtenons une acc√©l√©ration 200 fois!  La ville appara√Æt apr√®s la troisi√®me lettre.  Nous adaptons maintenant l'interface pour que cela se produise apr√®s la premi√®re.  Cependant, la vitesse de r√©ponse est compl√®tement diff√©rente - d√©j√† quelques millisecondes au lieu de secondes. <br><br>  <b>La deuxi√®me application est un sujet √† la mode appel√© l'informatique √† deux vitesses</b> .  C'est parce que les consultants de chaque fer disent que les soci√©t√©s devraient y aller. <br><br><img src="https://habrastorage.org/webt/3j/mb/oc/3jmboctdb2q3n6iwdlf1auvf_x0.jpeg"><br><br>  Il existe une couche d'infrastructure, des domaines au-dessus, par exemple, un syst√®me de facturation, comme les t√©l√©communications, les syst√®mes d'entreprise, les rapports d'entreprise.  C'est le noyau qui n'a pas besoin d'√™tre touch√©.  C'est bien s√ªr possible, mais parano√Øaque en fournissant de la qualit√©, car cela apporte de l'argent √† la soci√©t√©. <br><br>  Vient ensuite la couche de microservices - celle qui diff√©rencie l'op√©rateur ou un autre acteur.  Des microservices peuvent √™tre rapidement cr√©√©s sur la base de certains caches, y soulevant des donn√©es de diff√©rents domaines.  Voici un <b>champ d'exp√©riences</b> - si quelque chose ne fonctionne pas, fermez un microservice, ouvrez-en un autre.  Cela offre un d√©lai de mise sur le march√© vraiment am√©lior√© et augmente la fiabilit√© et la vitesse de l'entreprise. <br><br><blockquote>  Les microservices sont peut-√™tre le r√¥le principal de Tarantool dans MegaFon. </blockquote><br><h2>  O√π nous pr√©voyons d'appliquer Tarantool </h2><br>  Si nous comparons notre projet de facturation r√©ussi avec les programmes de transformation de Deutsche Telekom, Svyazkome, Vodafone India, il est √©tonnamment dynamique et cr√©atif.  Dans le processus de mise en ≈ìuvre de ce projet, non seulement MegaFon et sa structure ont √©t√© transform√©es, mais Tarantool-enterprise est √©galement apparu sur Mail.ru, et notre fournisseur Nexign (anciennement Peter-Service) avait une BSS Box (solution de facturation en bo√Æte). <br><br>  Dans un sens, il s'agit d'un projet historique pour le march√© russe.  Il peut √™tre compar√© √† ce qui est d√©crit dans le livre de Frederick Brooks ¬´Mythical Man-Month¬ª.  Puis, dans les ann√©es 60, IBM a attir√© 5 000 personnes pour d√©velopper un nouveau syst√®me d'exploitation OS / 360 pour les mainframes.  Nous en avons moins - 1 800, mais les n√¥tres sont dans des gilets, et compte tenu de l'utilisation de l'open source et des nouvelles approches, nous travaillons de mani√®re plus productive. <br><br>  Les domaines de facturation ou, plus largement, les syst√®mes d'entreprise sont affich√©s ci-dessous.  Les gens en entreprise connaissent tr√®s bien le CRM.  Tout le monde devrait d√©j√† avoir d'autres syst√®mes: Open API, Gateway API. <br><br><img src="https://habrastorage.org/webt/lj/g1/ec/ljg1ecnbyprze3f4js1j7899h9e.jpeg"><br><br><h3>  API ouverte </h3><br>  Examinons √† nouveau les chiffres et le fonctionnement de l'API ouverte maintenant.  Sa charge est de <b>10 000 transactions par seconde</b> .  √âtant donn√© que nous pr√©voyons de d√©velopper activement la couche de microservices et de cr√©er l'API publique MegaFon, nous nous attendons √† plus de croissance √† l'avenir dans cette partie particuli√®re.  <b>100 000 transactions seront certainement</b> . <br><br>  Je ne sais pas si le SSO est comparable √† Mail.ru - les gars, comme, ont 1 000 000 de transactions par seconde.  Nous sommes extr√™mement int√©ress√©s par leur solution et nous pr√©voyons de tirer parti de leur exp√©rience - par exemple, pour cr√©er une r√©serve SSO fonctionnelle √† l'aide de Tarantool.  Maintenant, les d√©veloppeurs de Mail.ru le font avec nous. <br><br><h2>  CRM </h2><br>  CRM - ce sont les 80 millions d'abonn√©s que nous voulons porter √† un milliard, car il y a d√©j√† 300 millions de documents qui incluent une histoire de trois ans.  Nous attendons vraiment avec impatience de nouveaux services, et ici <b>le point de croissance est les services connect√©s</b> .  C'est une balle qui va grandir, car il y aura de plus en plus de services.  En cons√©quence, une histoire sera n√©cessaire, nous ne voulons pas tr√©bucher l√†-dessus. <br><br>  La facturation elle-m√™me en termes de facturation, la collaboration avec les cr√©ances clients a √©t√© <b>transform√©e en un domaine distinct</b> .  Pour maximiser les performances, le <b>mod√®le d'architecture d'architecture de domaine est appliqu√©</b> . <br><br><blockquote>  Le syst√®me est divis√© en domaines, la charge est r√©partie et une tol√©rance aux pannes est fournie.  De plus, nous avons travaill√© avec une architecture distribu√©e. </blockquote><br>  Tout le reste est constitu√© de solutions au niveau de l'entreprise.  Dans le magasin d'appels - <b>2 milliards par jour</b> , 60 milliards par mois.  Parfois, il faut les raconter pendant un mois, et mieux vite.  <b>Le suivi financier,</b> c'est pr√©cis√©ment les 300 millions qui ne cessent de cro√Ætre et de plus en plus: les abonn√©s courent souvent entre op√©rateurs, ce qui augmente cette part. <br><br>  La composante la plus t√©l√©com des communications mobiles est <b>la facturation en ligne</b> .  Ce sont les syst√®mes qui vous permettent d'appeler ou non, de prendre une d√©cision en temps r√©el.  Ici, la charge est de 30 000 transactions par seconde, mais compte tenu de la croissance du transfert de donn√©es, nous pr√©voyons <b>250 000 transactions</b> , et nous sommes donc tr√®s int√©ress√©s par Tarantool. <br><br>  L'image pr√©c√©dente est les domaines o√π nous allons utiliser Tarantool.  Le CRM lui-m√™me, bien s√ªr, est plus large et nous allons l'appliquer au c≈ìur m√™me. <br><br>  Notre TTX estim√© √† 100 millions d'abonn√©s me confond en tant qu'architecte - et si 101 millions?  Pour tout refaire?  Pour √©viter cela, nous utilisons des caches, tout en augmentant l'accessibilit√©. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/167/a80/b0e/167a80b0e38db7f135407b097284a3ff.jpg"><br><br>  En g√©n√©ral, il existe deux approches pour utiliser Tarantool.  La premi√®re consiste <b>√† cr√©er tous les caches au niveau du microservice</b> .  Si je comprends bien, VimpelCom suit ce chemin, cr√©ant un cache client. <br><br>  Nous sommes moins d√©pendants des fournisseurs, nous changeons le c≈ìur de BSS, nous avons donc un seul index de carte client pr√™t √† l'emploi.  Mais nous voulons la broder.  Par cons√©quent, nous utilisons une approche l√©g√®rement diff√©rente - <b>nous cr√©ons des caches √† l'int√©rieur des syst√®mes</b> . <br><br><blockquote>  Il y a donc moins qu'un rassynchronisme - un syst√®me est responsable √† la fois d'un cache et de la source principale principale. </blockquote><br>  La m√©thode cadre bien avec l'approche du squelette transactionnel Tarantool, lorsque seules les parties li√©es aux mises √† jour, c'est-√†-dire les modifications de donn√©es, sont mises √† jour.  Tout le reste peut √™tre stock√© ailleurs.  Il n'y a pas d'√©norme lac de donn√©es, de cache global non g√©r√©.  Les caches sont con√ßues pour le syst√®me, soit pour les produits, soit pour les clients, soit pour faciliter la vie du service.  Lorsqu'un abonn√© appelle boulevers√© par la qualit√©, je veux le servir qualitativement. <br><br><h2>  RTO et RPO </h2><br>  Il y a deux termes en informatique - <b>RTO</b> et <b>RPO</b> . <br><br>  <b>L'objectif de temps de r√©cup√©ration</b> est le temps de r√©cup√©ration d'un service apr√®s une panne.  RTO = 0 signifie que m√™me si quelque chose tombe, le service continue de fonctionner. <br><br>  <b>L'objectif du point de r√©cup√©ration</b> est le temps de r√©cup√©ration des donn√©es, la quantit√© de donn√©es que nous pouvons perdre sur une p√©riode de temps.  RPO = 0 signifie que nous ne perdons pas de donn√©es. <br><br><h2>  D√©fi Tarantool </h2><br>  Essayons de r√©soudre le probl√®me pour Tarantool. <br><br>  <b>√âtant donn√©</b> : tout le monde comprend le panier d'applications, par exemple, sur Amazon ou ailleurs.  <b>Le</b> panier <b>doit</b> fonctionner 24h / 24 et 7j / 7, soit 99,99% du temps.  Les commandes qui nous parviennent doivent maintenir l'ordre, car nous ne pouvons pas activer ou d√©sactiver la communication au hasard pour l'abonn√© - tout doit √™tre strictement coh√©rent.  L'abonnement pr√©c√©dent affecte le suivant, donc les donn√©es sont importantes - rien ne doit √™tre perdu. <br><br>  <b>Solution</b> .  Vous pouvez essayer de le r√©soudre de front et demander aux d√©veloppeurs de la base de donn√©es, mais le probl√®me n'est pas r√©solu math√©matiquement.  On peut rappeler les th√©or√®mes, les lois de conservation, la physique quantique, mais pourquoi - cela ne peut pas √™tre r√©solu au niveau DB. <br><br>  La bonne vieille approche architecturale fonctionne ici - vous devez bien conna√Ætre le sujet et √† ses frais r√©soudre ce r√©bus. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/944/6e3/d25/9446e3d25815306bbe9dce45df4350ab.jpg"><br><br>  <b>Notre solution: cr√©er un registre distribu√© d'applications pour Tarantool - un cluster g√©o-distribu√©</b> .  Dans le diagramme, il s'agit de trois centres de donn√©es diff√©rents - deux pour l'Oural, un au-del√† de l'Oural, et nous distribuons toutes les applications √† ces centres. <br><br>  Netflix, qui est maintenant consid√©r√© comme l'un des leaders de l'informatique, n'avait qu'un seul centre de donn√©es jusqu'en 2012.  √Ä la veille du No√´l catholique du 24 d√©cembre, ce centre de donn√©es est tomb√© en panne.  Les utilisateurs du Canada et des √âtats-Unis se sont retrouv√©s sans leurs films pr√©f√©r√©s, tr√®s contrari√©s et ont √©crit √† ce sujet dans les r√©seaux sociaux.  Netflix poss√®de d√©sormais trois centres de donn√©es sur la c√¥te ouest-est et un en Europe occidentale. <br><br><blockquote>  Nous construisons initialement une solution g√©o-distribu√©e - la tol√©rance aux pannes est importante pour nous. </blockquote><br>  Donc, nous avons un cluster, mais qu'en est-il de RPO = 0 et RTO = 0?  La solution est simple, cela d√©pend du sujet. <br><br>  Qu'est-ce qui est important dans les applications?  Deux parties: lancer le panier <b>AVANT de</b> prendre une d√©cision d'achat et <b>APR√àS</b> .  Une partie de l'OD dans les t√©l√©communications est g√©n√©ralement appel√©e <b>capture</b> ou <b>n√©gociation d'ordres</b> .  Dans les t√©l√©communications, cela peut √™tre beaucoup plus compliqu√© que dans la boutique en ligne, car l√†, vous devez servir le client, offrir 5 options, et cela se produit pendant un certain temps, mais le panier est plein.  √Ä ce stade, un √©chec est possible, mais ce n'est pas effrayant, car il se produit en mode interactif sous la supervision d'une personne. <br><br>  Si le centre de donn√©es de Moscou tombe subitement en panne, puis en basculant automatiquement vers un autre centre de donn√©es, nous continuerons √† travailler.  Th√©oriquement, un produit dans un panier peut √™tre perdu, mais vous voyez cela, compl√©tez √† nouveau le panier et continuez √† travailler.  Dans ce cas, RTO = 0. <br><br>  Au m√™me moment, il y a une deuxi√®me option: lorsque nous avons cliqu√© sur ¬´soumettre¬ª, nous voulons que les donn√©es ne soient pas perdues.  √Ä partir de ce moment, l'automatisation commence √† fonctionner - c'est d√©j√† RPO = 0. L'application de ces deux mod√®les diff√©rents dans un cas peut √™tre juste un cluster g√©o-distribu√© avec un ma√Ætre commutable, dans l'autre cas une sorte d'entr√©e de quorum.  Les mod√®les peuvent varier, mais nous r√©solvons le probl√®me. <br><br>  De plus, en ayant un registre des demandes distribu√©, nous pouvons √©galement tout mettre √† l'√©chelle - pour avoir de nombreux r√©partiteurs et entrepreneurs qui acc√®dent √† ce registre. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/28f/ab6/da3/28fab6da317b89510738c9b2497fe529.jpg"><br><br><h2>  Cassandra et Tarantool ensemble </h2><br>  Il y a un autre cas - la <b>¬´vitrine des soldes¬ª</b> .  Voici juste un cas int√©ressant d'utilisation conjointe de Cassandra et Tarantool. <br><br>  Nous utilisons Cassandra, car 2 milliards d'appels par jour ne sont pas la limite, et il y en aura plus.  Les marketeurs adorent coloriser le trafic par source, il y a de plus en plus de d√©tails sur les r√©seaux sociaux, par exemple.  Tout cela augmente l'histoire. <br><br><blockquote>  Cassandra vous permet de mettre √† l'√©chelle horizontalement n'importe quel volume. </blockquote><br>  Nous nous sentons √† l'aise avec Cassandra, mais elle a un probl√®me - elle n'est pas bonne en lecture.    , 30 000     ‚Äî <b>  </b> . <br><br>     ,      :    ,      -   ,     Cassandra.        ,     IBM manager file transfer ‚Äî   ,     ,   UDP, ,   TCP.  ,    ,       ,   -    ,       ‚Äî  . <br><br>    ,  <b>   </b> .      Kafka  Tarantool,     , ,  ,   <b> </b> ,       , , 100        2 . <br><br>   ,       2         ,    ,   . <br><br><h2>  Conclusion </h2><br>     Tarantool.     Mail.ru,     . <br><br>   BCG  McKinsey, Accenture  IBM     -  ‚Äî   ,   ,    ,  ,   . ,  Tarantool             .       . <br><br><blockquote>     ‚Äî     Tarantool Conference  ,   17      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">T+ Conference 2019</a>   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">¬´ Tarantool  Enterprise¬ª</a> .         <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">¬´ Tarantool    Oracle¬ª</a> . ,  ,    .  ‚Äî  ,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="></a> .  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="> </a>    :  ,    Tarantool, , ,   . </blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr455694/">https://habr.com/ru/post/fr455694/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr455678/index.html">Sur le chemin de Sergey Pavlovich Korolev. Projet habit√© russe moderne. Partie 1. ¬´F√©d√©ration¬ª</a></li>
<li><a href="../fr455682/index.html">Combien d√©pensez-vous en infrastructure? Et comment √©conomiser sur cela?</a></li>
<li><a href="../fr455684/index.html">Pourquoi avons-nous organis√© un hackathon pour les testeurs</a></li>
<li><a href="../fr455686/index.html">Comment choisir le meilleur outil de gestion de projet si vous √™tes un mill√©naire?</a></li>
<li><a href="../fr455692/index.html">ASZP: le restyling ou le th√©√¢tre commence par un cintre</a></li>
<li><a href="../fr455696/index.html">L'√©tat √©lectronique du futur. 2e partie</a></li>
<li><a href="../fr455698/index.html">Le livre "Comment JavaScript fonctionne"</a></li>
<li><a href="../fr455700/index.html">4 astuces qui nous ont aid√©s √† optimiser le frontend</a></li>
<li><a href="../fr455702/index.html">G√©n√©ration efficace de nombres dans un intervalle donn√©</a></li>
<li><a href="../fr455710/index.html">Pourquoi chez Leroy Merlin, avons-nous besoin de notre propre service de d√©veloppement russe pour 200 personnes</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>