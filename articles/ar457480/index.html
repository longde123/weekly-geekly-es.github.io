<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ¤° ğŸ‘¨ğŸ¿â€ğŸ“ ğŸ“´ Ø¥Ù†Ø´Ø§Ø¡ ØªØ·Ø¨ÙŠÙ‚ Ø§Ø³ØªÙ…Ø§Ø¹ Ù„Ø¹Ø±Ø¶ Ø­Ø±ÙƒØ© Ù…Ø±ÙˆØ± MMORPG Ø¹Ù„Ù‰ Ø§Ù„Ù‡Ø§ØªÙ Ø§Ù„Ù…Ø­Ù…ÙˆÙ„ ğŸ¤ŸğŸ» ğŸ¦‹ ğŸ’‚</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ù‡Ø°Ø§ Ù‡Ùˆ Ø§Ù„Ø¬Ø²Ø¡ Ø§Ù„Ø«Ø§Ù†ÙŠ Ù…Ù† Ø³Ù„Ø³Ù„Ø© Ù…Ù† Ø§Ù„Ù…Ù‚Ø§Ù„Ø§Øª Ø­ÙˆÙ„ ØªØ­Ù„ÙŠÙ„ Ø­Ø±ÙƒØ© Ù…Ø±ÙˆØ± Ø´Ø¨ÙƒØ© MMORPG Ø§Ù„Ù…Ø­Ù…ÙˆÙ„. Ù…ÙˆØ§Ø¶ÙŠØ¹ Ø­Ù„Ù‚Ø© Ø¹ÙŠÙ†Ø©: 



1. ØªØ­Ù„ÙŠÙ„ ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø¨ÙŠÙ† Ø§Ù„Ø®Ø§Ø¯Ù… ÙˆØ§Ù„Ø¹Ù…ÙŠÙ„. 
2....">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Ø¥Ù†Ø´Ø§Ø¡ ØªØ·Ø¨ÙŠÙ‚ Ø§Ø³ØªÙ…Ø§Ø¹ Ù„Ø¹Ø±Ø¶ Ø­Ø±ÙƒØ© Ù…Ø±ÙˆØ± MMORPG Ø¹Ù„Ù‰ Ø§Ù„Ù‡Ø§ØªÙ Ø§Ù„Ù…Ø­Ù…ÙˆÙ„</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/457480/" style=";text-align:right;direction:rtl">  Ù‡Ø°Ø§ Ù‡Ùˆ Ø§Ù„Ø¬Ø²Ø¡ Ø§Ù„Ø«Ø§Ù†ÙŠ Ù…Ù† Ø³Ù„Ø³Ù„Ø© Ù…Ù† Ø§Ù„Ù…Ù‚Ø§Ù„Ø§Øª Ø­ÙˆÙ„ ØªØ­Ù„ÙŠÙ„ Ø­Ø±ÙƒØ© Ù…Ø±ÙˆØ± Ø´Ø¨ÙƒØ© MMORPG Ø§Ù„Ù…Ø­Ù…ÙˆÙ„.  Ù…ÙˆØ§Ø¶ÙŠØ¹ Ø­Ù„Ù‚Ø© Ø¹ÙŠÙ†Ø©: <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ØªØ­Ù„ÙŠÙ„ ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø¨ÙŠÙ† Ø§Ù„Ø®Ø§Ø¯Ù… ÙˆØ§Ù„Ø¹Ù…ÙŠÙ„.</a> </li><li style=";text-align:right;direction:rtl">  ÙƒØªØ§Ø¨Ø© ØªØ·Ø¨ÙŠÙ‚ Ø§Ø³ØªÙ…Ø§Ø¹ Ù„Ø¹Ø±Ø¶ Ø­Ø±ÙƒØ© Ù…Ø±ÙˆØ± Ø§Ù„Ù„Ø¹Ø¨Ø© Ø¨Ø·Ø±ÙŠÙ‚Ø© Ù…Ø±ÙŠØ­Ø©. </li><li style=";text-align:right;direction:rtl">  Ø§Ø¹ØªØ±Ø§Ø¶ Ø­Ø±ÙƒØ© Ø§Ù„Ù…Ø±ÙˆØ± ÙˆØªØ¹Ø¯ÙŠÙ„Ù‡ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø®Ø§Ø¯Ù… ÙˆÙƒÙŠÙ„ Ø¨Ø®Ù„Ø§Ù HTTP. </li><li style=";text-align:right;direction:rtl">  Ø§Ù„Ø®Ø·ÙˆØ§Øª Ø§Ù„Ø£ÙˆÙ„Ù‰ Ù„Ø®Ø§Ø¯Ù…Ùƒ ("Ø§Ù„Ù…Ù‚Ø±ØµÙ†"). </li></ol><br>  ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ø¬Ø²Ø¡ Ø³ÙˆÙ Ø£ØµÙ Ø¥Ù†Ø´Ø§Ø¡ ØªØ·Ø¨ÙŠÙ‚ Ø§Ø³ØªÙ…Ø§Ø¹ (sniffer) ØŒ ÙˆØ§Ù„Ø°ÙŠ Ø³ÙŠØªÙŠØ­ Ù„Ù†Ø§ ØªØµÙÙŠØ© Ø§Ù„Ø£Ø­Ø¯Ø§Ø« Ø­Ø³Ø¨ Ù†ÙˆØ¹Ù‡Ø§ ÙˆÙ…ØµØ¯Ø±Ù‡Ø§ ØŒ ÙˆØ¹Ø±Ø¶ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø­ÙˆÙ„ Ø§Ù„Ø±Ø³Ø§Ù„Ø© ÙˆØ­ÙØ¸Ù‡Ø§ Ø¨Ø´ÙƒÙ„ Ø§Ù†ØªÙ‚Ø§Ø¦ÙŠ Ù„Ù„ØªØ­Ù„ÙŠÙ„ ØŒ ÙˆÙƒØ°Ù„Ùƒ Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙÙŠ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ù‚Ø§Ø¨Ù„ Ù„Ù„ØªÙ†ÙÙŠØ° Ù„Ù„Ø¹Ø¨Ø© ("Ø«Ù†Ø§Ø¦ÙŠ") Ù‚Ù„ÙŠÙ„Ø§Ù‹ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¯Ø¹Ù… ÙˆØ¥Ø¶Ø§ÙØ© Ø¯Ø¹Ù… <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Ø¨Ø±ÙˆØªÙˆÙƒÙˆÙ„ Ù…Ø®Ø§Ø²Ù†</a> Ø¥Ù„Ù‰ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚.  Ù…Ù‡ØªÙ…Ø© ØŒ Ø£Ø·Ù„Ø¨ Ø§Ù„Ù‚Ø·. <br><a name="habracut"></a><br><h3 style=";text-align:right;direction:rtl">  Ø§Ù„Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© </h3><br>  Ù„ØªØªÙ…ÙƒÙ† Ù…Ù† ØªÙƒØ±Ø§Ø± Ø§Ù„Ø®Ø·ÙˆØ§Øª Ø§Ù„Ù…ÙˆØ¶Ø­Ø© Ø£Ø¯Ù†Ø§Ù‡ ØŒ Ø³ØªØ­ØªØ§Ø¬ Ø¥Ù„Ù‰: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  Wireshark Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø­Ø²Ù…Ø© Ø› </li><li style=";text-align:right;direction:rtl">  . NET. </li><li style=";text-align:right;direction:rtl">  Ù…ÙƒØªØ¨Ø© <a href="">PcapDotNet</a> Ù„Ù„Ø¹Ù…Ù„ Ù…Ø¹ WinPcap Ø› </li><li style=";text-align:right;direction:rtl">  Ù…ÙƒØªØ¨Ø© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">protobuf-net</a> Ù„Ù„Ø¹Ù…Ù„ Ù…Ø¹ Ù…Ø®Ø§Ø²Ù† Ø¨Ø±ÙˆØªÙˆÙƒÙˆÙ„. </li></ul><br><h3 style=";text-align:right;direction:rtl">  ÙƒØªØ§Ø¨Ø© Ø·Ù„Ø¨ Ø§Ù„Ø§Ø³ØªÙ…Ø§Ø¹ </h3><br>  ÙƒÙ…Ø§ Ù†ØªØ°ÙƒØ± Ù…Ù† <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Ø§Ù„Ù…Ù‚Ø§Ù„Ø© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©</a> ØŒ ØªØªÙˆØ§ØµÙ„ Ø§Ù„Ù„Ø¹Ø¨Ø© Ø¹Ø¨Ø± Ø¨Ø±ÙˆØªÙˆÙƒÙˆÙ„ TCP ØŒ ÙˆÙÙŠ Ø¥Ø·Ø§Ø± Ø§Ù„Ø¬Ù„Ø³Ø© ØªÙ‚ÙˆÙ… Ø¨Ø°Ù„Ùƒ Ù…Ø¹ Ø®Ø§Ø¯Ù… ÙˆØ§Ø­Ø¯ ÙÙ‚Ø· ÙˆÙ…Ù†ÙØ° ÙˆØ§Ø­Ø¯.  Ù„ØªÙƒÙˆÙ† Ù‚Ø§Ø¯Ø±Ù‹Ø§ Ø¹Ù„Ù‰ ØªØ­Ù„ÙŠÙ„ Ø­Ø±ÙƒØ© Ù…Ø±ÙˆØ± Ø§Ù„Ù„Ø¹Ø¨Ø© ØŒ Ù†Ø­ØªØ§Ø¬ Ø¥Ù„Ù‰ ØªÙ†ÙÙŠØ° Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„ØªØ§Ù„ÙŠØ©: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  Ø§Ø¹ØªØ±Ø§Ø¶ Ø§Ù„Ø­Ø²Ù… Ù„Ø¬Ù‡Ø§Ø² Ù…Ø­Ù…ÙˆÙ„ Ø› </li><li style=";text-align:right;direction:rtl">  Ø­Ø²Ù… Ù„Ø¹Ø¨Ø© ØªØµÙÙŠØ©. </li><li style=";text-align:right;direction:rtl">  Ø¥Ø¶Ø§ÙØ© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø²Ù…Ø© Ø§Ù„ØªØ§Ù„ÙŠØ© Ø¥Ù„Ù‰ Ø§Ù„Ù…Ø®Ø²Ù† Ø§Ù„Ù…Ø¤Ù‚Øª Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø© Ø› </li><li style=";text-align:right;direction:rtl">  Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø£Ø­Ø¯Ø§Ø« Ø§Ù„Ù„Ø¹Ø¨Ø© Ù…Ù† Ø§Ù„Ù…Ø®Ø§Ø²Ù† Ø§Ù„Ù…Ø¤Ù‚ØªØ© ÙƒÙ…Ø§ ÙŠØªÙ… Ù…Ù„Ø¤Ù‡Ø§. </li></ul><br>  ÙŠØªÙ… ØªØ·Ø¨ÙŠÙ‚ Ù‡Ø°Ù‡ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª ÙÙŠ ÙØ¦Ø© <code>Sniffer</code> ØŒ ÙˆØ§Ù„ØªÙŠ ØªØ³ØªØ®Ø¯Ù… Ù…ÙƒØªØ¨Ø© PcapDotNet Ù„Ø§Ø¹ØªØ±Ø§Ø¶ Ø§Ù„Ø­Ø²Ù….  ÙÙŠ Ø·Ø±ÙŠÙ‚Ø© <code>Sniff</code> ØŒ Ù†Ù†Ù‚Ù„ Ø¹Ù†ÙˆØ§Ù† IP Ù„Ù„Ù…Ø­ÙˆÙ„ (ÙÙŠ Ø§Ù„ÙˆØ§Ù‚Ø¹ ØŒ Ù‡Ø°Ø§ Ù‡Ùˆ Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ÙƒÙ…Ø¨ÙŠÙˆØªØ± Ø§Ù„Ø°ÙŠ ÙŠØªÙ… ØªÙˆØ²ÙŠØ¹ Wi-Fi Ù…Ù†Ù‡ Ø¹Ù„Ù‰ Ø§Ù„Ø¬Ù‡Ø§Ø² Ø§Ù„Ù…Ø­Ù…ÙˆÙ„ Ø¯Ø§Ø®Ù„ Ù†ÙØ³ Ø§Ù„Ø´Ø¨ÙƒØ©) ØŒ ÙˆØ¹Ù†ÙˆØ§Ù† IP Ù„Ù„Ø¬Ù‡Ø§Ø² Ø§Ù„Ù…Ø­Ù…ÙˆÙ„ ØŒ ÙˆØ¹Ù†ÙˆØ§Ù† IP Ø§Ù„Ø®Ø§Øµ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù….  Ù†Ø¸Ø±Ù‹Ø§ Ù„Ø¹Ø¯Ù… ØªÙ†Ø§Ø³Ù‚ Ø§Ù„Ø§Ø«Ù†ÙŠÙ† Ø§Ù„Ø£Ø®ÙŠØ±ÙŠÙ† (Ø¨Ø¹Ø¯ Ø£Ø´Ù‡Ø± Ù…Ù† Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ø£Ù†Ø¸Ù…Ø© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© ÙˆØ§Ù„Ø®ÙˆØ§Ø¯Ù… Ø§Ù„Ù…Ø®ØªÙ„ÙØ© ØŒ Ø§ØªØ¶Ø­ Ø£Ù† Ø§Ù„Ø®Ø§Ø¯Ù… Ù…Ø­Ø¯Ø¯ Ù…Ù† Ù…Ø¬Ù…ÙˆØ¹Ø© Ù…Ù† 50 Ø®Ø§Ø¯Ù…Ù‹Ø§ ØªÙ‚Ø±ÙŠØ¨Ù‹Ø§ ØŒ ÙƒÙ„ Ù…Ù†Ù‡Ø§ Ù„Ø§ ÙŠØ²Ø§Ù„ Ù„Ø¯ÙŠÙ‡ 5 Ø¥Ù„Ù‰ 7 Ù…Ù†Ø§ÙØ° Ù…Ø­ØªÙ…Ù„Ø©) ØŒ ÙØ£Ù†Ø§ Ø£Ø­ÙŠÙ„ ÙÙ‚Ø· Ø§Ù„Ø«Ù…Ø§Ù†ÙŠØ§Øª Ø§Ù„Ø«Ù„Ø§Ø«Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰.  Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù‡Ø°Ø§ Ø§Ù„ØªØµÙÙŠØ© Ù…Ø±Ø¦ÙŠ ÙÙŠ Ø·Ø±ÙŠÙ‚Ø© <code>IsTargetPacket</code> . <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Sniffer</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] _data = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[<span class="hljs-number"><span class="hljs-number">4096</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> Active { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> _adapterIP; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> _target; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> _server; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> List&lt;<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>&gt; _serverBuffer; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> List&lt;<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>&gt; _clientBuffer; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> LivePacketDevice _device = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> PacketCommunicator _communicator = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Action&lt;Event&gt; _eventCallback = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Sniff</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ip, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> target, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> server</span></span></span><span class="hljs-function">)</span></span> { _adapterIP = ip; _target = target; _server = server; _serverBuffer = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> List&lt;<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>&gt;(); _clientBuffer = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> List&lt;<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>&gt;(); IList&lt;LivePacketDevice&gt; allDevices = LivePacketDevice.AllLocalMachine; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i != allDevices.Count; ++i) { LivePacketDevice device = allDevices[i]; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> address = device.Addresses[<span class="hljs-number"><span class="hljs-number">1</span></span>].Address + <span class="hljs-string"><span class="hljs-string">""</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (address == <span class="hljs-string"><span class="hljs-string">"Internet "</span></span> + _adapterIP) { _device = device; } } _communicator = _device.Open(<span class="hljs-number"><span class="hljs-number">65536</span></span>, PacketDeviceOpenAttributes.Promiscuous, <span class="hljs-number"><span class="hljs-number">1000</span></span>); _communicator.SetFilter(_communicator.CreateFilter(<span class="hljs-string"><span class="hljs-string">"ip and tcp"</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Thread(() =&gt; { Thread.CurrentThread.IsBackground = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; BeginReceive(); }).Start(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">BeginReceive</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { _communicator.ReceivePackets(<span class="hljs-number"><span class="hljs-number">0</span></span>, OnReceive); <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> { PacketCommunicatorReceiveResult result = _communicator.ReceivePacket(<span class="hljs-keyword"><span class="hljs-keyword">out</span></span> Packet packet); <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (result) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> PacketCommunicatorReceiveResult.Timeout: <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> PacketCommunicatorReceiveResult.Ok: OnReceive(packet); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (Active); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AddEventCallback</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Action&lt;Event&gt; callback</span></span></span><span class="hljs-function">)</span></span> { _eventCallback = callback; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnReceive</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Packet packet</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Active) { IpV4Datagram ip = packet.Ethernet.IpV4; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (IsTargetPacket(ip)) { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { ParseData(ip); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (ObjectDisposedException) { } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (EndOfStreamException e) { Console.WriteLine(e); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Exception) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span>; } } } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">IsTargetPacket</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">IpV4Datagram ip</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> sourceIp = ip.Source.ToString(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> destIp = ip.Destination.ToString(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (sourceIp != _adapterIP &amp;&amp; destIp != _adapterIP) &amp;&amp; ( (sourceIp.StartsWith(_target) &amp;&amp; destIp.StartsWith(_server)) || (sourceIp.StartsWith(_server) &amp;&amp; destIp.StartsWith(_target)) ); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ParseData</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">IpV4Datagram ip</span></span></span><span class="hljs-function">)</span></span> { TcpDatagram tcp = ip.Tcp; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (tcp.Payload != <span class="hljs-literal"><span class="hljs-literal">null</span></span> &amp;&amp; tcp.PayloadLength &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> payload = ExtractPayload(tcp); AddToBuffer(ip, payload); ProcessBuffers(); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">byte</span></span></span><span class="hljs-function">[] </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ExtractPayload</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">TcpDatagram tcp</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> payloadLength = tcp.PayloadLength; MemoryStream ms = tcp.Payload.ToMemoryStream(); <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] payload = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[payloadLength]; ms.Read(payload, <span class="hljs-number"><span class="hljs-number">0</span></span>, payloadLength); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> payload; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AddToBuffer</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">IpV4Datagram ip, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] payload</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ip.Destination.ToString().StartsWith(_target)) { <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> payload) _serverBuffer.Add(<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> payload) _clientBuffer.Add(<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ProcessBuffers</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { ProcessBuffer(<span class="hljs-keyword"><span class="hljs-keyword">ref</span></span> _serverBuffer); ProcessBuffer(<span class="hljs-keyword"><span class="hljs-keyword">ref</span></span> _clientBuffer); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ProcessBuffer</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">ref</span></span></span></span><span class="hljs-function"><span class="hljs-params"> List&lt;</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params">&gt; buffer</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-comment"><span class="hljs-comment">// TODO } public void Suspend() { Active = false; } public void Resume() { Active = true; } }</span></span></code> </pre><br>  Ø¹Ø¸ÙŠÙ… ØŒ Ø§Ù„Ø¢Ù† Ù„Ø¯ÙŠÙ†Ø§ Ø§Ø«Ù†ÙŠÙ† Ù…Ù† Ø§Ù„Ù…Ø®Ø§Ø²Ù† Ø§Ù„Ù…Ø¤Ù‚ØªØ© Ù…Ø¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø²Ù…Ø© Ù…Ù† Ø§Ù„Ø¹Ù…ÙŠÙ„ ÙˆØ§Ù„Ø®Ø§Ø¯Ù….  Ø£Ø°ÙƒØ± ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø£Ø­Ø¯Ø§Ø« Ø¨ÙŠÙ† Ø§Ù„Ù„Ø¹Ø¨Ø© ÙˆØ§Ù„Ø®Ø§Ø¯Ù…: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Event</span></span></span><span class="hljs-class"> {</span></span> uint payload_length &lt;bgcolor=<span class="hljs-number"><span class="hljs-number">0xFFFF00</span></span>, name=<span class="hljs-string"><span class="hljs-string">"Payload Length"</span></span>&gt;; ushort event_code &lt;bgcolor=<span class="hljs-number"><span class="hljs-number">0xFF9988</span></span>, name=<span class="hljs-string"><span class="hljs-string">"Event Code"</span></span>&gt;; byte payload[payload_length] &lt;name=<span class="hljs-string"><span class="hljs-string">"Event Payload"</span></span>&gt;; };</code> </pre><br>  Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø°Ù„Ùƒ ØŒ ÙŠÙ…ÙƒÙ†Ùƒ Ø¥Ù†Ø´Ø§Ø¡ ÙØ¦Ø© <code>Event</code> Ø­Ø¯Ø«: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">enum</span></span> EventSource { Client, Server } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">enum</span></span> EventTypes : <span class="hljs-keyword"><span class="hljs-keyword">ushort</span></span> { Movement = <span class="hljs-number"><span class="hljs-number">11</span></span>, Ping = <span class="hljs-number"><span class="hljs-number">30</span></span>, Pong = <span class="hljs-number"><span class="hljs-number">31</span></span>, Teleport = <span class="hljs-number"><span class="hljs-number">63</span></span>, EnterDungeon = <span class="hljs-number"><span class="hljs-number">217</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Event</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">uint</span></span> ID; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">uint</span></span> Length { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ushort</span></span> Type { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">uint</span></span> DataLength { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> EventType { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> EventSource Direction { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] _data; <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> BinaryReader _br = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Event</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] data, EventSource direction</span></span></span><span class="hljs-function">)</span></span> { _data = data; _br = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BinaryReader(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MemoryStream(_data)); Length = _br.ReadUInt32(); Type = _br.ReadUInt16(); DataLength = <span class="hljs-number"><span class="hljs-number">0</span></span>; EventType = <span class="hljs-string"><span class="hljs-string">$"Unknown (</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{Type}</span></span></span><span class="hljs-string">)"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (IsKnown()) { EventType = ((EventTypes)Type).ToString(); } Direction = direction; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ParseData</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">IsKnown</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Enum.IsDefined(<span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(EventTypes), Type); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">byte</span></span></span><span class="hljs-function">[] </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetPayload</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> hasDatLength = </span></span><span class="hljs-literal"><span class="hljs-function"><span class="hljs-params"><span class="hljs-literal">true</span></span></span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> payloadLength = _data.Length - (hasDatLength ? <span class="hljs-number"><span class="hljs-number">10</span></span> : <span class="hljs-number"><span class="hljs-number">6</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> List&lt;<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>&gt;(_data).GetRange(hasDatLength ? <span class="hljs-number"><span class="hljs-number">10</span></span> : <span class="hljs-number"><span class="hljs-number">6</span></span>, payloadLength).ToArray(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Save</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> path = Path.Combine(AppDomain.CurrentDomain.BaseDirectory, <span class="hljs-string"><span class="hljs-string">"Packets"</span></span>, EventType); Directory.CreateDirectory(path); File.WriteAllBytes(path + <span class="hljs-string"><span class="hljs-string">$"/</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{ID}</span></span></span><span class="hljs-string">.dump"</span></span>, _data); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ToString</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">$"Type </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{Type}</span></span></span><span class="hljs-string">. Data length: </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{Length}</span></span></span><span class="hljs-string">."</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">ulong</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ReadVLQ</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> readFlag = </span></span><span class="hljs-literal"><span class="hljs-function"><span class="hljs-params"><span class="hljs-literal">true</span></span></span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (readFlag) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> flag = _br.ReadByte(); } <span class="hljs-keyword"><span class="hljs-keyword">ulong</span></span> vlq = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (i = <span class="hljs-number"><span class="hljs-number">0</span></span>; ; i += <span class="hljs-number"><span class="hljs-number">7</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> x = _br.ReadByte(); vlq |= (<span class="hljs-keyword"><span class="hljs-keyword">ulong</span></span>)(x &amp; <span class="hljs-number"><span class="hljs-number">0x7F</span></span>) &lt;&lt; i; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((x &amp; <span class="hljs-number"><span class="hljs-number">0x80</span></span>) != <span class="hljs-number"><span class="hljs-number">0x80</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vlq; } }</code> </pre><br>  Ø³ÙŠØªÙ… Ø§Ø³ØªØ®Ø¯Ø§Ù… ÙØ¦Ø© Ø§Ù„Ø£Ø­Ø¯Ø§Ø« ÙƒÙØ¦Ø© Ø£Ø³Ø§Ø³ÙŠØ© Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø­Ø¯Ø§Ø« ÙÙŠ Ø§Ù„Ù„Ø¹Ø¨Ø©.  ÙÙŠÙ…Ø§ ÙŠÙ„ÙŠ ÙØ¦Ø© Ù…Ø«Ø§Ù„ Ù„Ø­Ø¯Ø« <code>Ping</code> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Ping</span></span> : <span class="hljs-title"><span class="hljs-title">Event</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ulong</span></span> _pingTime; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Ping</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] data</span></span></span><span class="hljs-function">) : </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">base</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">data, EventSource.Client</span></span></span><span class="hljs-function">)</span></span> { EventType = <span class="hljs-string"><span class="hljs-string">"Ping"</span></span>; DataLength = <span class="hljs-number"><span class="hljs-number">4</span></span>; _pingTime = _br.ReadUInt32(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ToString</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">$"Pinging server at </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{_pingTime}</span></span></span><span class="hljs-string">ms."</span></span>; } }</code> </pre><br>  Ø§Ù„Ø¢Ù† Ø¨Ø¹Ø¯ Ø£Ù† Ø£ØµØ¨Ø­ Ù„Ø¯ÙŠÙ†Ø§ ÙØ¦Ø© Ø§Ù„Ø­Ø¯Ø« ØŒ ÙŠÙ…ÙƒÙ†Ù†Ø§ Ø¥Ø¶Ø§ÙØ© Ø·Ø±Ù‚ Ø¥Ù„Ù‰ <code>Sniffer</code> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ProcessBuffer</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">ref</span></span></span></span><span class="hljs-function"><span class="hljs-params"> List&lt;</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params">&gt; buffer</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (buffer.Count &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (Active) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (buffer.Count &gt; <span class="hljs-number"><span class="hljs-number">4</span></span>) <span class="hljs-comment"><span class="hljs-comment">//  4        ... { var eventLength = BitConverter.ToInt32(buffer.Take(4).ToArray(), 0) + 6; // ...    -   .. +  4  + 2    if (eventLength &gt;= 6 &amp;&amp; buffer.Count &gt;= eventLength) { var eventData = buffer.Take(eventLength).ToArray(); var ev = CreateEvent(eventData, direction); buffer.RemoveRange(0, eventLength); continue; } } break; } } } private Event CreateEvent(byte[] data, EventSource direction) { var ev = new Event(data, direction); var eventType = Enum.GetName(typeof(EventTypes), ev.Type); if (eventType != null) { try { //     (, &lt;code&gt;Ping&lt;/code&gt;). var className = "Events." + eventType; Type t = Type.GetType(className); ev = (Event)Activator.CreateInstance(t, data); } catch (Exception) { //     -   . ev = new Event(data, direction); } finally { } } _eventCallback?.Invoke(ev); return ev; }</span></span></code> </pre><br>  Ù‚Ù… Ø¨Ø¥Ù†Ø´Ø§Ø¡ ÙØ¦Ø© Ù†Ù…ÙˆØ°Ø¬ ØªØ¤Ø¯ÙŠ Ø¥Ù„Ù‰ ØªØ´ØºÙŠÙ„ Ø§Ù„ØªÙ†ØµØª: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">partial</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">MainForm</span></span> : <span class="hljs-title"><span class="hljs-title">Form</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Sniffer _sniffer = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> List&lt;Event&gt; _events = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> List&lt;Event&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> List&lt;<span class="hljs-keyword"><span class="hljs-keyword">ushort</span></span>&gt; _eventTypesFilter = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> List&lt;<span class="hljs-keyword"><span class="hljs-keyword">ushort</span></span>&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> _showClientEvents = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> _showServerEvents = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> _showUnknownEvents = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> _clearLogsOnRestart = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">uint</span></span> _eventId = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">InitializeSniffer</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { _sniffer = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Sniffer(); _sniffer.AddEventCallback(NewEventThreaded); _sniffer.Sniff(<span class="hljs-string"><span class="hljs-string">"192.168.137.1"</span></span>, <span class="hljs-string"><span class="hljs-string">"192.168.137."</span></span>, <span class="hljs-string"><span class="hljs-string">"123.45.67."</span></span>); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">NewEventThreaded</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Event ev</span></span></span><span class="hljs-function">)</span></span> { events_table.Invoke(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> NewEventCallback(NewEvent), ev); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">delegate</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">NewEventCallback</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Event ev</span></span></span><span class="hljs-function">)</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">NewEvent</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Event ev</span></span></span><span class="hljs-function">)</span></span> { ev.ID = _eventId++; _events.Add(ev); LogEvent(ev); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">LogEvent</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Event ev</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (FilterEvent(ev)) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> type = ev.GetType(); events_table.Rows.Add(<span class="hljs-number"><span class="hljs-number">1</span></span>); events_table.Rows[events_table.RowCount - <span class="hljs-number"><span class="hljs-number">1</span></span>].Cells[<span class="hljs-number"><span class="hljs-number">0</span></span>].Value = ev.ID; events_table.Rows[events_table.RowCount - <span class="hljs-number"><span class="hljs-number">1</span></span>].Cells[<span class="hljs-number"><span class="hljs-number">1</span></span>].Value = ev.EventType; events_table.Rows[events_table.RowCount - <span class="hljs-number"><span class="hljs-number">1</span></span>].Cells[<span class="hljs-number"><span class="hljs-number">2</span></span>].Value = Enum.GetName(<span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(EventSource), ev.Direction); events_table.Rows[events_table.RowCount - <span class="hljs-number"><span class="hljs-number">1</span></span>].Cells[<span class="hljs-number"><span class="hljs-number">3</span></span>].Value = ev.ToString(); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ReloadEvents</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { events_table.Rows.Clear(); events_table.Refresh(); <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ev <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> _events) { LogEvent(ev); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FilterEvent</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Event ev</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ( (ev.Direction == EventSource.Client &amp;&amp; _showClientEvents) || (ev.Direction == EventSource.Server &amp;&amp; _showServerEvents) ) &amp;&amp; (_eventTypesFilter.Contains(ev.Type) || (!ev.IsKnown() &amp;&amp; _showUnknownEvents)); } }</code> </pre><br>  Ø§Ù„Ù‚ÙŠØ§Ù… Ø¨Ù‡!  ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¢Ù† Ø¥Ø¶Ø§ÙØ© Ø¨Ø¶Ø¹Ø© Ø¬Ø¯Ø§ÙˆÙ„ Ù„Ø¥Ø¯Ø§Ø±Ø© Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ø­Ø¯Ø§Ø« (Ù…Ù† <code>_eventTypesFilter</code> ØªØ¹Ø¨Ø¦Ø© <code>_eventTypesFilter</code> ) ÙˆØ¹Ø±Ø¶Ù‡Ø§ ÙÙŠ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„ÙØ¹Ù„ÙŠ (Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ <code>events_table</code> ).  Ø¹Ù„Ù‰ Ø³Ø¨ÙŠÙ„ Ø§Ù„Ù…Ø«Ø§Ù„ ØŒ Ù„Ù‚Ø¯ Ù‚Ù…Øª <code>FilterEvent</code> Ø­Ø³Ø¨ Ø§Ù„Ù…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„ØªØ§Ù„ÙŠØ© (Ø·Ø±ÙŠÙ‚Ø© <code>FilterEvent</code> ): <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  Ø¹Ø±Ø¶ Ø§Ù„Ø£Ø­Ø¯Ø§Ø« Ù…Ù† Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø› </li><li style=";text-align:right;direction:rtl">  Ø¹Ø±Ø¶ Ø§Ù„Ø£Ø­Ø¯Ø§Ø« Ù…Ù† Ø§Ù„Ø®Ø§Ø¯Ù… Ø› </li><li style=";text-align:right;direction:rtl">  Ø¹Ø±Ø¶ Ø£Ø­Ø¯Ø§Ø« ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙØ© Ø› </li><li style=";text-align:right;direction:rtl">  Ø¹Ø±Ø¶ Ø§Ù„Ø£Ø­Ø¯Ø§Ø« Ø§Ù„Ù…Ø¹Ø±ÙˆÙØ© Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©. </li></ul><br><h3 style=";text-align:right;direction:rtl">  ØªØ¹Ù„Ù… Ø§Ù„Ù„Ø¹Ø¨Ø© Ø§Ù„Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„ØªÙ†ÙÙŠØ° </h3><br>  Ø¹Ù„Ù‰ Ø§Ù„Ø±ØºÙ… Ù…Ù† Ø£Ù†Ù‡ Ù…Ù† Ø§Ù„Ù…Ù…ÙƒÙ† Ø§Ù„Ø¢Ù† ØªØ­Ù„ÙŠÙ„ Ø£Ø­Ø¯Ø§Ø« Ø§Ù„Ù„Ø¹Ø¨Ø© Ø¯ÙˆÙ† Ù…Ø´Ø§ÙƒÙ„ ØŒ Ø¥Ù„Ø§ Ø£Ù† Ù‡Ù†Ø§Ùƒ Ù‚Ø¯Ø±Ù‹Ø§ Ù‡Ø§Ø¦Ù„Ø§Ù‹ Ù…Ù† Ø§Ù„Ø¹Ù…Ù„ Ø§Ù„ÙŠØ¯ÙˆÙŠ Ù„ÙŠØ³ ÙÙ‚Ø· Ù„ØªØ­Ø¯ÙŠØ¯ Ù…Ø¹Ù†Ù‰ Ø¬Ù…ÙŠØ¹ Ø±Ù…ÙˆØ² Ø§Ù„Ø£Ø­Ø¯Ø§Ø« ØŒ ÙˆÙ„ÙƒÙ† Ø£ÙŠØ¶Ù‹Ø§ Ø¨Ù†ÙŠØ© Ø§Ù„Ø­Ù…ÙˆÙ„Ø© Ø§Ù„ØµØ§ÙÙŠØ© ØŒ ÙˆØ§Ù„ØªÙŠ Ø³ØªÙƒÙˆÙ† ØµØ¹Ø¨Ø© Ù„Ù„ØºØ§ÙŠØ© ØŒ Ø®Ø§ØµØ©Ù‹ Ø¥Ø°Ø§ ØªØºÙŠØ±Øª ÙˆÙÙ‚Ù‹Ø§ Ù„Ø¨Ø¹Ø¶ Ø§Ù„Ø­Ù‚ÙˆÙ„.  Ù‚Ø±Ø±Øª Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø¨Ø¹Ø¶ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª ÙÙŠ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ù‚Ø§Ø¨Ù„ Ù„Ù„ØªÙ†ÙÙŠØ° Ù„Ù„Ø¹Ø¨Ø©.  Ù†Ø¸Ø±Ù‹Ø§ Ù„Ø£Ù† Ø§Ù„Ù„Ø¹Ø¨Ø© Ù…Ø´ØªØ±ÙƒØ© Ø¨ÙŠÙ† Ø§Ù„Ø£Ù†Ø¸Ù…Ø© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© (Ù…ØªÙˆÙØ±Ø© Ø¹Ù„Ù‰ Windows Ùˆ iOS Ùˆ Android) ØŒ ÙØ¥Ù† Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„ØªØ§Ù„ÙŠØ© Ù…ØªØ§Ø­Ø© Ù„Ù„ØªØ­Ù„ÙŠÙ„: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  .exe Ù…Ù„Ù (Ù„Ù‚Ø¯ ÙˆØ¬Ø¯Øª Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø³Ø§Ø± C: / Program Files / WindowsApps /Ùª appnameÙª /Ø› </li><li style=";text-align:right;direction:rtl">  Ù…Ù„Ù Ø«Ù†Ø§Ø¦ÙŠ Ù„Ù†Ø¸Ø§Ù… iOS ØªÙ… ØªØ´ÙÙŠØ±Ù‡ Ø¨ÙˆØ§Ø³Ø·Ø© Apple ØŒ ÙˆÙ„ÙƒÙ† Ù…Ø¹ JailBreak ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ù…Ø´ÙØ±Ø© Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Crackulous Ø£Ùˆ Ù…Ø§ Ø´Ø§Ø¨Ù‡ Ø› </li><li style=";text-align:right;direction:rtl">  Ù…ÙƒØªØ¨Ø© Ø£Ù†Ø¯Ø±ÙˆÙŠØ¯ Ø§Ù„Ù…Ø´ØªØ±ÙƒØ©  Ø¥Ù†Ù‡ Ù…ÙˆØ¬ÙˆØ¯ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø³Ø§Ø± / Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª / Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª /Ùª app-vendor-nameÙª / lib /. </li></ul><br>  Ù…Ø¹ Ø¹Ø¯Ù… ÙˆØ¬ÙˆØ¯ ÙÙƒØ±Ø© Ø¹Ù† Ø§Ù„Ø¨Ù†ÙŠØ© Ø§Ù„ØªÙŠ ÙŠØ¬Ø¨ Ø£Ù† ØªØ®ØªØ§Ø±Ù‡Ø§ Ù„Ù†Ø¸Ø§Ù…ÙŠ Android Ùˆ iOS ØŒ ÙÙ‚Ø¯ Ø¨Ø¯Ø£Øª Ù…Ø¹ Ù…Ù„Ù exe.  Ù†Ø­Ù…Ù‘Ù„ Ø§Ù„Ø«Ù†Ø§Ø¦ÙŠ ÙÙŠ Ø§Ù„Ù…Ø¤Ø³Ø³Ø© Ø§Ù„Ø¯ÙˆÙ„ÙŠØ© Ù„Ù„ØªÙ†Ù…ÙŠØ© ØŒ ÙˆÙ†Ø±Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø¨Ù†Ù‰. <br><br><img src="https://habrastorage.org/webt/jb/q6/vh/jbq6vhlp9nqovpae87uka5jrof0.png"><br><br>  Ø§Ù„ØºØ±Ø¶ Ù…Ù† Ø¨Ø­Ø«Ù†Ø§ Ù‡Ùˆ Ø¨Ø¹Ø¶ Ø§Ù„Ø£Ø³Ø·Ø± Ø§Ù„Ù…ÙÙŠØ¯Ø© Ù„Ù„ØºØ§ÙŠØ© ØŒ Ù…Ù…Ø§ ÙŠØ¹Ù†ÙŠ Ø£Ù† Ø¥Ù„ØºØ§Ø¡ ØªØ¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø¬Ù…Ù‘Ø¹ ØºÙŠØ± Ù…Ø¯Ø±Ø¬ ÙÙŠ Ø§Ù„Ø®Ø·Ø· ØŒ Ù„ÙƒÙ† ÙÙŠ Ø§Ù„Ø­Ø§Ù„Ø© ØŒ Ø­Ø¯Ø¯ "80806 Ø§Ù„Ù‚Ø§Ø¨Ù„ Ù„Ù„ØªÙ†ÙÙŠØ°" ØŒ Ù„Ø£Ù† Ø®ÙŠØ§Ø±Ø§Øª "Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø«Ù†Ø§Ø¦ÙŠ" Ùˆ "MS-DOS Ø§Ù„Ù‚Ø§Ø¨Ù„ Ù„Ù„ØªÙ†ÙÙŠØ°" ØºÙŠØ± Ù…Ù†Ø§Ø³Ø¨Ø© Ø¨Ø´ÙƒÙ„ ÙˆØ§Ø¶Ø­.  Ø§Ù†Ù‚Ø± ÙÙˆÙ‚ "Ù…ÙˆØ§ÙÙ‚" ØŒ Ø§Ù†ØªØ¸Ø± Ø­ØªÙ‰ ÙŠØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ù ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ØŒ ÙˆÙŠÙ†ØµØ­ Ø¨Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± Ø­ØªÙ‰ ÙŠÙƒØªÙ…Ù„ ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ù„Ù.  ÙŠÙ…ÙƒÙ† Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ù†Ù‡Ø§ÙŠØ© Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø¨Ø­Ù‚ÙŠÙ‚Ø© Ø£Ù†Ù‡ ÙÙŠ Ø´Ø±ÙŠØ· Ø§Ù„Ø­Ø§Ù„Ø© ÙÙŠ Ø£Ø³ÙÙ„ Ø§Ù„ÙŠØ³Ø§Ø± Ø³ØªÙƒÙˆÙ† Ù‡Ù†Ø§Ùƒ Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„ØªØ§Ù„ÙŠØ©: <br><br><img src="https://habrastorage.org/webt/yk/__/fb/yk__fbdgrskjle8c5zf6ro0q_f8.png"><br><br>  Ø§Ù†ØªÙ‚Ù„ Ø¥Ù„Ù‰ Ø¹Ù„Ø§Ù…Ø© ØªØ¨ÙˆÙŠØ¨ "Ø§Ù„Ø³Ù„Ø§Ø³Ù„" (Ø¹Ø±Ø¶ / ÙØªØ­ Ù…Ù‚Ø§Ø·Ø¹ ÙØ±Ø¹ÙŠØ© / Ø³Ù„Ø§Ø³Ù„ Ø£Ùˆ <code>Shift + F12</code> ).  Ù‚Ø¯ ØªØ³ØªØºØ±Ù‚ Ø¹Ù…Ù„ÙŠØ© Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø®Ø· Ø¨Ø¹Ø¶ Ø§Ù„ÙˆÙ‚Øª.  ÙÙŠ Ø­Ø§Ù„ØªÙŠ ØŒ ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø®Ø·ÙˆØ· 47k ~.  ØªØ­ØªÙˆÙŠ Ø¹Ù†Ø§ÙˆÙŠÙ† Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø³Ù„Ø§Ø³Ù„ Ø¹Ù„Ù‰ Ø¨Ø§Ø¯Ø¦Ø© Ù„Ù„Ù†Ù…ÙˆØ°Ø¬ <code>.data</code> Ùˆ. <code>.rdata</code> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ÙˆØºÙŠØ±Ù‡Ø§</a> .  ÙÙŠ Ø­Ø§Ù„ØªÙŠ ØŒ ÙƒØ§Ù†Øª Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø®Ø·ÙˆØ· "Ø§Ù„Ù…Ø«ÙŠØ±Ø© Ù„Ù„Ø§Ù‡ØªÙ…Ø§Ù…" Ù…ÙˆØ¬ÙˆØ¯Ø© ÙÙŠ Ù‚Ø³Ù… <code>.rdata</code> ØŒ ÙˆÙƒØ§Ù† Ø­Ø¬Ù…Ù‡Ø§ Ø­ÙˆØ§Ù„ÙŠ 44.5 Ø£Ù„Ù Ø³Ø¬Ù„.  Ù…Ù† Ø®Ù„Ø§Ù„ Ø§Ù„Ø§Ø·Ù„Ø§Ø¹ Ø¹Ù„Ù‰ Ø§Ù„Ø¬Ø¯ÙˆÙ„ ØŒ ÙŠÙ…ÙƒÙ†Ùƒ Ø±Ø¤ÙŠØ©: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ø®Ø·Ø£ ÙˆØ´Ø±Ø§Ø¦Ø­ Ø§Ù„Ø§Ø³ØªØ¹Ù„Ø§Ù… Ø£Ø«Ù†Ø§Ø¡ Ù…Ø±Ø­Ù„Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø› </li><li style=";text-align:right;direction:rtl">  Ø³Ù„Ø§Ø³Ù„ Ø§Ù„Ø®Ø·Ø£ ÙˆÙ…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØªÙ‡ÙŠØ¦Ø© Ù„Ù„Ø¹Ø¨Ø© ØŒ Ù…Ø­Ø±Ùƒ Ø§Ù„Ù„Ø¹Ø¨Ø© ØŒ ÙˆØ§Ø¬Ù‡Ø§Øª Ø› </li><li style=";text-align:right;direction:rtl">  Ø§Ù„ÙƒØ«ÙŠØ± Ù…Ù† Ø§Ù„Ù‚Ù…Ø§Ù…Ø© </li><li style=";text-align:right;direction:rtl">  Ù‚Ø§Ø¦Ù…Ø© Ø¨Ø¬Ø¯Ø§ÙˆÙ„ Ø§Ù„Ù„Ø¹Ø¨Ø© Ø¹Ù„Ù‰ Ø¬Ø§Ù†Ø¨ Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø› </li><li style=";text-align:right;direction:rtl">  Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø© Ù„Ù…Ø­Ø±Ùƒ Ø§Ù„Ù„Ø¹Ø¨Ø© ÙÙŠ Ø§Ù„Ù„Ø¹Ø¨Ø© Ø› </li><li style=";text-align:right;direction:rtl">  Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¢Ø«Ø§Ø± Ø› </li><li style=";text-align:right;direction:rtl">  Ù‚Ø§Ø¦Ù…Ø© Ø¶Ø®Ù…Ø© Ù…Ù† Ù…ÙØ§ØªÙŠØ­ ØªÙˆØ·ÙŠÙ† Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ø› </li><li style=";text-align:right;direction:rtl">  Ø¥Ù„Ø® </li></ul><br>  Ø£Ø®ÙŠØ±Ù‹Ø§ ØŒ ÙŠØ£ØªÙŠ Ù…Ø§ ÙƒÙ†Ø§ Ù†Ø¨Ø­Ø« Ø¹Ù†Ù‡ Ø£Ù‚Ø±Ø¨ Ø¥Ù„Ù‰ Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ø¬Ø¯ÙˆÙ„. <br><br><img src="https://habrastorage.org/webt/ua/jr/sw/uajrsw8i71x33xuhyhmzonprqku.png"><br><br>  Ù‡Ø°Ù‡ Ù‚Ø§Ø¦Ù…Ø© Ø¨Ø±Ù…ÙˆØ² Ø§Ù„Ø£Ø­Ø¯Ø§Ø« Ø¨ÙŠÙ† Ø§Ù„Ø¹Ù…ÙŠÙ„ ÙˆØ§Ù„Ø®Ø§Ø¯Ù….  Ù‡Ø°Ø§ ÙŠÙ…ÙƒÙ† Ø£Ù† ØªØ¨Ø³ÙŠØ· Ø­ÙŠØ§ØªÙ†Ø§ Ø¹Ù†Ø¯ ØªØ­Ù„ÙŠÙ„ Ø¨Ø±ÙˆØªÙˆÙƒÙˆÙ„ Ø§Ù„Ø´Ø¨ÙƒØ© Ù„Ù„Ø¹Ø¨Ø©.  Ù„ÙƒÙ†Ù†Ø§ Ù„Ù† Ù†ØªÙˆÙ‚Ù Ø¹Ù†Ø¯ Ù‡Ø°Ø§ Ø§Ù„Ø­Ø¯!  Ù…Ù† Ø§Ù„Ø¶Ø±ÙˆØ±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¥Ù…ÙƒØ§Ù†ÙŠØ© Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¹Ø¯Ø¯ÙŠØ© Ù„Ø±Ù…Ø² Ø§Ù„Ø­Ø¯Ø« Ø¨Ø·Ø±ÙŠÙ‚Ø© Ø£Ùˆ Ø¨Ø£Ø®Ø±Ù‰.  Ù†Ø±Ù‰ "Ù…Ø£Ù„ÙˆÙÙ‹Ø§" Ù…Ù† Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ù…Ù‚Ø§Ù„Ø§Øª Ø§Ù„Ø³Ø§Ø¨Ù‚Ø© <code>CMSG_PING</code> Ùˆ <code>SMSG_PONG</code> ØŒ Ù…Ø¹ Ø§Ù„Ø£ÙƒÙˆØ§Ø¯ 30 ( <code>1E <sub>16</sub></code> ) Ùˆ 31 ( <code>1F <sub>16</sub></code> ) ØŒ Ø¹Ù„Ù‰ Ø§Ù„ØªÙˆØ§Ù„ÙŠ.  Ø§Ù†Ù‚Ø± Ù†Ù‚Ø±Ù‹Ø§ Ù…Ø²Ø¯ÙˆØ¬Ù‹Ø§ Ø¹Ù„Ù‰ Ø§Ù„Ø³Ø·Ø± Ù„Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„Ù‰ Ù‡Ø°Ø§ Ø§Ù„Ù…ÙƒØ§Ù† ÙÙŠ Ø§Ù„ÙƒÙˆØ¯. <br><br><img src="https://habrastorage.org/webt/la/ro/wj/larowjnopxrmyc53htrzo_-_2zi.png"><br><br>  Ø¨Ø§Ù„ÙØ¹Ù„ ØŒ Ù…Ø¨Ø§Ø´Ø±Ø© Ø¨Ø¹Ø¯ Ø³Ù„Ø³Ù„Ø© Ù‚ÙŠÙ… Ø§Ù„Ø±Ù…ÙˆØ² ØªØ³Ù„Ø³Ù„ <code>0x10 0x1E</code> Ùˆ <code>0x10 0x1F</code> .  Ø­Ø³Ù†Ù‹Ø§ ØŒ Ù‡Ø°Ø§ ÙŠØ¹Ù†ÙŠ Ø£Ù†Ù‡ ÙŠÙ…ÙƒÙ†Ùƒ ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø¨Ø£ÙƒÙ…Ù„Ù‡ ÙˆØ§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù‚Ø§Ø¦Ù…Ø© Ø¨Ø§Ù„Ø£Ø­Ø¯Ø§Ø« ÙˆÙ‚ÙŠÙ…ØªÙ‡Ø§ Ø§Ù„Ø¹Ø¯Ø¯ÙŠØ© ØŒ Ù…Ù…Ø§ ÙŠØ²ÙŠØ¯ Ù…Ù† ØªØ¨Ø³ÙŠØ· ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¨Ø±ÙˆØªÙˆÙƒÙˆÙ„. <br><br>  Ù„Ø³ÙˆØ¡ Ø§Ù„Ø­Ø¸ ØŒ ÙØ¥Ù† Ø¥ØµØ¯Ø§Ø± Windows Ù…Ù† Ø§Ù„Ù„Ø¹Ø¨Ø© ÙŠØªØ®Ù„Ù Ø¹Ù† Ø§Ù„Ø¥ØµØ¯Ø§Ø±Ø§Øª Ø§Ù„Ù…Ø­Ù…ÙˆÙ„Ø© Ù…Ù† Ø®Ù„Ø§Ù„ Ø§Ù„ÙƒØ«ÙŠØ± Ù…Ù† Ø§Ù„Ø¥ØµØ¯Ø§Ø±Ø§Øª ØŒ ÙˆØ¨Ø§Ù„ØªØ§Ù„ÙŠ ÙØ¥Ù† Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ù…Ù† .exe Ù„ÙŠØ³Øª Ø°Ø§Øª ØµÙ„Ø© ØŒ ÙˆØ¹Ù„Ù‰ Ø§Ù„Ø±ØºÙ… Ù…Ù† Ø£Ù†Ù‡Ø§ ÙŠÙ…ÙƒÙ† Ø£Ù† ØªØ³Ø§Ø¹Ø¯ ØŒ ÙŠØ¬Ø¨ Ø£Ù„Ø§ ØªØ¹ØªÙ…Ø¯ Ø¹Ù„ÙŠÙ‡Ø§ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„.  Ø¨Ø¹Ø¯ Ø°Ù„Ùƒ ØŒ Ù‚Ø±Ø±Øª Ø¯Ø±Ø§Ø³Ø© Ø§Ù„Ù…ÙƒØªØ¨Ø© Ø§Ù„Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ© Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Android ØŒ ÙƒÙ…Ø§ Ø±Ø£ÙŠØª ÙÙŠ Ø£Ø­Ø¯ Ø§Ù„Ù…Ù†ØªØ¯ÙŠØ§Øª Ø§Ù„ØªÙŠ ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø§Ù„ÙƒØ«ÙŠØ± Ù…Ù† Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ÙˆØµÙÙŠØ© Ø­ÙˆÙ„ Ø§Ù„ÙØµÙˆÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ© ØŒ Ø¹Ù„Ù‰ Ø¹ÙƒØ³ Ø«Ù†Ø§Ø¦ÙŠØ§Øª iOS.  ÙˆÙ„ÙƒÙ† Ù„Ù„Ø£Ø³Ù ØŒ Ù„Ù… <code>CMSG_PING</code> Ø§Ù„Ø¨Ø­Ø« ÙÙŠ <code>CMSG_PING</code> Ù‚ÙŠÙ…Ø© <code>CMSG_PING</code> Ø§Ù„Ù†ØªØ§Ø¦Ø¬. <br><br>  Ø¯ÙˆÙ† Ø£Ù…Ù„ ØŒ Ø£Ù‚ÙˆÙ… Ø¨Ø¥Ø¬Ø±Ø§Ø¡ Ù†ÙØ³ Ø§Ù„Ø¨Ø­Ø« ÙÙŠ iOS Ø§Ù„Ø«Ù†Ø§Ø¦ÙŠ - Ù„Ø§ ÙŠÙ…ÙƒÙ† ØªØµØ¯ÙŠÙ‚Ù‡ ØŒ Ù„ÙƒÙ† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø© Ù‡Ù†Ø§Ùƒ Ù‡ÙŠ Ù†ÙØ³Ù‡Ø§ ÙƒÙ…Ø§ Ù‡ÙŠ ÙÙŠ .exe!  Ù‚Ù… Ø¨ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ù Ø¥Ù„Ù‰ Ø§Ù„Ù…Ø¤Ø³Ø³Ø© Ø§Ù„Ø¯ÙˆÙ„ÙŠØ© Ù„Ù„ØªÙ†Ù…ÙŠØ©. <br><br><img src="https://habrastorage.org/webt/la/ro/wj/larowjnopxrmyc53htrzo_-_2zi.png"><br><br>  Ø§Ø®ØªØ±Øª Ø§Ù„Ø®ÙŠØ§Ø± Ø§Ù„Ø£ÙˆÙ„ Ø§Ù„Ù…Ù‚ØªØ±Ø­ ØŒ Ù„Ø£Ù†Ù†ÙŠ Ù„Ø³Øª Ù…ØªØ£ÙƒØ¯Ù‹Ø§ Ù…Ù† Ø§Ù„Ø®ÙŠØ§Ø± Ø§Ù„Ù…Ø·Ù„ÙˆØ¨.  Ù…Ø±Ø© Ø£Ø®Ø±Ù‰ ØŒ Ù†Ø­Ù† Ù†Ù†ØªØ¸Ø± Ù†Ù‡Ø§ÙŠØ© ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ù„Ù (Ø­Ø¬Ù… Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø«Ù†Ø§Ø¦ÙŠ Ø£ÙƒØ¨Ø± Ø¨Ø­ÙˆØ§Ù„ÙŠ 4 Ø£Ø¶Ø¹Ø§Ù .exe ØŒ ÙˆÙ‚Øª Ø§Ù„ØªØ­Ù„ÙŠÙ„ ØŒ Ø¨Ø§Ù„Ø·Ø¨Ø¹ ØŒ ÙŠØ²Ø¯Ø§Ø¯ Ø£ÙŠØ¶Ù‹Ø§).  Ù†ÙØªØ­ Ù†Ø§ÙØ°Ø© Ù…Ø¹ Ø®Ø·ÙˆØ· ØŒ ÙˆØ§Ù„ØªÙŠ ØªØ­ÙˆÙ„Øª Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø±Ø© Ø¥Ù„Ù‰ 51k.  Ù…Ù† Ø®Ù„Ø§Ù„ <code>Ctrl + F</code> Ù†Ø¨Ø­Ø« Ø¹Ù† <code>CMSG_PING</code> Ùˆ ... Ù„Ù… Ù†Ø¹Ø«Ø± Ø¹Ù„ÙŠÙ‡.  Ø¹Ù†Ø¯ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù…Ø² Ø§Ù„Ø­Ø±Ù Ø¨Ø­Ø±Ù ØŒ ÙŠÙ…ÙƒÙ†Ùƒ Ù…Ù„Ø§Ø­Ø¸Ø© Ù‡Ø°Ù‡ Ø§Ù„Ù†ØªÙŠØ¬Ø©: <br><br><img src="https://habrastorage.org/webt/jk/rz/be/jkrzbe0uvyj2vi2fxphnldc_vki.png"><br><br>  Ù„Ø³Ø¨Ø¨ Ù…Ø§ ØŒ ÙˆØ¶Ø¹Øª Ø§Ù„Ù…Ø¤Ø³Ø³Ø© Ø§Ù„Ø¯ÙˆÙ„ÙŠØ© Ù„Ù„ØªÙ†Ù…ÙŠØ© ÙƒØ§Ø¦Ù† <code>Opcode.proto</code> Ø¨Ø£ÙƒÙ…Ù„Ù‡ ÙÙŠ Ø³Ø·Ø± ÙˆØ§Ø­Ø¯.  Ø§Ù†Ù‚Ø± Ù†Ù‚Ø±Ù‹Ø§ Ù…Ø²Ø¯ÙˆØ¬Ù‹Ø§ Ø¹Ù„Ù‰ Ù‡Ø°Ø§ Ø§Ù„Ù…ÙƒØ§Ù† ÙÙŠ Ø§Ù„ÙƒÙˆØ¯ ÙˆÙ†Ø±Ù‰ Ø£Ù† Ø§Ù„Ù‡ÙŠÙƒÙ„ Ù…ÙˆØµÙˆÙ Ø¨Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© Ù†ÙØ³Ù‡Ø§ ÙƒÙ…Ø§ ÙÙŠ Ø§Ù„Ù…Ù„Ù. exe ØŒ Ø¨Ø­ÙŠØ« ÙŠÙ…ÙƒÙ†Ùƒ Ù‚ØµÙ‡ ÙˆØªØ­ÙˆÙŠÙ„Ù‡ Ø¥Ù„Ù‰ <code>Enum</code> . <br><br>  Ø£Ø®ÙŠØ±Ù‹Ø§ ØŒ ØªØ¬Ø¯Ø± Ø§Ù„Ø¥Ø´Ø§Ø±Ø© Ø¥Ù„Ù‰ Ø£Ù†Ù‡ ØŒ ÙÙŠ Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù‚Ø§Ù„ Ø§Ù„Ø³Ø§Ø¨Ù‚ ØŒ Ø§Ù‚ØªØ±Ø­ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" class="user_link">aml</a> Ø£Ù† Ø¨Ù†ÙŠØ© Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù„Ø¹Ø¨Ø© Ø¹Ø¨Ø§Ø±Ø© Ø¹Ù† ØªØ·Ø¨ÙŠÙ‚ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Ù„Ø¨Ø±ÙˆØªÙˆÙƒÙˆÙ„Ø§Øª Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø¤Ù‚Øª</a> .  Ø¥Ø°Ø§ Ù†Ø¸Ø±Øª Ø¹Ù† ÙƒØ«Ø¨ Ø¥Ù„Ù‰ Ø§Ù„Ø´ÙØ±Ø© ÙÙŠ Ù…Ù„Ù Ø«Ù†Ø§Ø¦ÙŠ ØŒ ÙŠÙ…ÙƒÙ†Ùƒ Ø£Ù† ØªØ±Ù‰ Ø£Ù† ÙˆØµÙ <code>Opcode</code> Ù…ÙˆØ¬ÙˆØ¯ Ø£ÙŠØ¶Ù‹Ø§ Ø¨Ù‡Ø°Ø§ Ø§Ù„ØªÙ†Ø³ÙŠÙ‚. <br><br><img src="https://habrastorage.org/webt/a6/pl/bk/a6plbk-pb8ldifrvha6qfqmh0oi.png"><br><br>  Ø³Ù†ÙƒØªØ¨ Ù‚Ø§Ù„Ø¨ Ù…Ø­Ù„Ù„ Ù„Ù€ 010Editor Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¬Ù…ÙŠØ¹ Ù‚ÙŠÙ… Ø§Ù„ÙƒÙˆØ¯. <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ØªÙ… ØªØ­Ø¯ÙŠØ«Ù‡ Ù…Ø¹Ø¨Ø£Ø© * ÙƒÙˆØ¯ Ø§Ù„Ù†ÙˆØ¹ 010Editor</b> <div class="spoiler_text" style=";text-align:right;direction:rtl">  ØªØ­ØªÙˆÙŠ ØªØºÙŠÙŠØ±Ø§Øª Ø§Ù„Ù†ÙˆØ¹ Ø§Ù„Ø¨Ø³ÙŠØ·Ø© Ø¹Ù„Ù‰ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØªØ³Ù…ÙŠØ© Ø§Ù„Ø­Ù‚Ù„ Ù„ØªØ®Ø·ÙŠ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª Ø§Ù„Ù…ÙÙ‚ÙˆØ¯Ø©. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">uint </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PeekTag</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (FTell() == FileSize()) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>; } Varint tag; FSkip(-tag.size); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> tag._ &gt;&gt; <span class="hljs-number"><span class="hljs-number">3</span></span>; } <span class="hljs-function"><span class="hljs-function">struct </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Packed</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(uint fieldNumber)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (PeekTag() != fieldNumber) { <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } Varint key &lt;bgcolor=<span class="hljs-number"><span class="hljs-number">0xFFBB00</span></span>&gt;; local uint wiredType = key._ &amp; <span class="hljs-number"><span class="hljs-number">0x7</span></span>; local uint field = key._ &gt;&gt; <span class="hljs-number"><span class="hljs-number">3</span></span>; local uint size = key.size; <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (wiredType) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> value; size += <span class="hljs-number"><span class="hljs-number">8</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> value; size += <span class="hljs-number"><span class="hljs-number">4</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: Varint value; size += value.size; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } }; <span class="hljs-function"><span class="hljs-function">struct </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PackedString</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(uint fieldNumber)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (PeekTag() != fieldNumber) { <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } <span class="hljs-function"><span class="hljs-function">Packed </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">length</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(fieldNumber)</span></span></span></span>; <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> str[length.value._]; };</code> </pre><br></div></div><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Code</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-function"><span class="hljs-function">Packed </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">size</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">2</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> &lt;bgcolor</span></span>=<span class="hljs-number"><span class="hljs-number">0x00FF00</span></span>&gt;; <span class="hljs-function"><span class="hljs-function">PackedString </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">code_name</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">1</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> &lt;bgcolor</span></span>=<span class="hljs-number"><span class="hljs-number">0x00FF00</span></span>&gt;; <span class="hljs-function"><span class="hljs-function">Packed </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">code_value</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">2</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> &lt;bgcolor</span></span>=<span class="hljs-number"><span class="hljs-number">0x00FF00</span></span>&gt;; Printf(<span class="hljs-string"><span class="hljs-string">"%s = %d,\n"</span></span>, code_name.str, code_value.value._); <span class="hljs-comment"><span class="hljs-comment">//        Enum }; struct Property { Packed size(5) &lt;bgcolor=0x00FF00&gt;; PackedString prop_name(1) &lt;bgcolor=0x00FF00&gt;; while (FTell() - 0x176526B - prop_name.length.value._ &lt; size.value._) { Code codes &lt;name="Codes"&gt;; } }; struct { FSkip(0x176526B); PackedString object(1) &lt;bgcolor=0x00FF00&gt;; PackedString format(2) &lt;bgcolor=0x00FFFF&gt;; Property prop; } file;</span></span></code> </pre><br>  ÙˆØ§Ù„Ù†ØªÙŠØ¬Ø© Ù‡ÙŠ Ø´ÙŠØ¡ Ù…Ø«Ù„ Ù‡Ø°Ø§: <br><br><img src="https://habrastorage.org/webt/n5/ge/1d/n5ge1dnylry0n2tdskxrvqg9zmy.png"><br><br>  Ø£ÙƒØ«Ø± Ø¥Ø«Ø§Ø±Ø© Ù„Ù„Ø§Ù‡ØªÙ…Ø§Ù…!  Ù‡Ù„ Ù„Ø§Ø­Ø¸Øª <code>pb</code> ÙÙŠ ÙˆØµÙ Ø§Ù„ÙƒØ§Ø¦Ù†ØŸ  Ø³ÙŠÙƒÙˆÙ† Ù…Ù† Ø§Ù„Ø¶Ø±ÙˆØ±ÙŠ Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø®Ø·ÙˆØ· Ø£Ø®Ø±Ù‰ ØŒ ÙØ¬Ø£Ø© Ù‡Ù†Ø§Ùƒ Ø§Ù„ÙƒØ«ÙŠØ± Ù…Ù† Ù‡Ø°Ù‡ Ø§Ù„Ø£Ø´ÙŠØ§Ø¡ØŸ <br><br><img src="https://habrastorage.org/webt/wf/cp/fx/wfcpfxmh1c6vhwycv9jnp4k9wle.png"><br><br>  Ø§Ù„Ù†ØªØ§Ø¦Ø¬ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹Ø© Ù„Ù„ØºØ§ÙŠØ©.  Ø¹Ù„Ù‰ Ù…Ø§ ÙŠØ¨Ø¯Ùˆ ØŒ ÙŠØµÙ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ù‚Ø§Ø¨Ù„ Ù„Ù„ØªÙ†ÙÙŠØ° Ø§Ù„Ø®Ø§Øµ Ø¨Ø§Ù„Ù„Ø¹Ø¨Ø© Ø§Ù„Ø¹Ø¯ÙŠØ¯ Ù…Ù† Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ØŒ Ø¨Ù…Ø§ ÙÙŠ Ø°Ù„Ùƒ Ø§Ù„ØªØ¹Ø¯Ø§Ø¯Ø§Øª ÙˆØªÙ†Ø³ÙŠÙ‚Ø§Øª Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø¨ÙŠÙ† Ø§Ù„Ø®Ø§Ø¯Ù… ÙˆØ§Ù„Ø¹Ù…ÙŠÙ„.  ÙÙŠÙ…Ø§ ÙŠÙ„ÙŠ Ù…Ø«Ø§Ù„ Ø¹Ù„Ù‰ ÙˆØµÙ Ù„Ù†ÙˆØ¹ ÙŠØµÙ Ù…ÙˆØ¶Ø¹ ÙƒØ§Ø¦Ù† Ù…Ø§ ÙÙŠ Ø§Ù„Ø¹Ø§Ù„Ù…: <br><br><img src="https://habrastorage.org/webt/jl/br/ix/jlbrixdyltdfgfmzkdoxvl038eg.png"><br><br>  ÙƒØ´Ù Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ø³Ø±ÙŠØ¹ Ø¹Ù† Ù…ÙƒØ§Ù†ÙŠÙ† ÙƒØ¨ÙŠØ±ÙŠÙ† Ù…Ø¹ ÙˆØµÙ Ù„Ù„Ø£Ù†ÙˆØ§Ø¹ ØŒ Ø¹Ù„Ù‰ Ø§Ù„Ø±ØºÙ… Ù…Ù† Ø£Ù† Ø§Ù„ÙØ­Øµ Ø§Ù„Ø¯Ù‚ÙŠÙ‚ Ù‚Ø¯ ÙŠÙƒØ´Ù Ø¹Ù† Ø£Ù…Ø§ÙƒÙ† ØµØºÙŠØ±Ø© Ø£Ø®Ø±Ù‰.  Ø¨Ø¹Ø¯ Ù‚ØµÙ‡Ø§ ØŒ ÙƒØªØ¨Øª Ù†ØµÙ‹Ø§ ØµØºÙŠØ±Ù‹Ø§ ÙÙŠ C # Ù„ÙØµÙ„ Ø§Ù„Ø£ÙˆØµØ§Ù Ø­Ø³Ø¨ Ø§Ù„Ù…Ù„Ù (ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ù‡ÙŠÙƒÙ„ ÙŠØ´Ø¨Ù‡ ÙˆØµÙ Ù‚Ø§Ø¦Ù…Ø© Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ø£Ø­Ø¯Ø§Ø«) - ÙŠØ³Ù‡Ù„ ØªØ­Ù„ÙŠÙ„Ù‡Ø§ ÙÙŠ 010Editor. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Program</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Main</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] args</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> br = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BinaryReader(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FileStream(<span class="hljs-string"><span class="hljs-string">"./BinaryFile.partX"</span></span>, FileMode.Open)); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (br.BaseStream.Position &lt; br.BaseStream.Length) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> startOffset = br.BaseStream.Position; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> length = ReadVLQ(br, <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> size); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> tag = br.ReadByte(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> eventName = br.ReadString(); br.BaseStream.Position = startOffset; File.WriteAllBytes(<span class="hljs-string"><span class="hljs-string">$"./parsed/</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{eventName}</span></span></span><span class="hljs-string">"</span></span>, br.ReadBytes((<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)length + size + <span class="hljs-number"><span class="hljs-number">1</span></span>)); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">ulong</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ReadVLQ</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">BinaryReader br, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">out</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> size</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> flag = br.ReadByte(); <span class="hljs-keyword"><span class="hljs-keyword">ulong</span></span> vlq = <span class="hljs-number"><span class="hljs-number">0</span></span>; size = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (i = <span class="hljs-number"><span class="hljs-number">0</span></span>; ; i += <span class="hljs-number"><span class="hljs-number">7</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> x = br.ReadByte(); vlq |= (<span class="hljs-keyword"><span class="hljs-keyword">ulong</span></span>)(x &amp; <span class="hljs-number"><span class="hljs-number">0x7F</span></span>) &lt;&lt; i; size++; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((x &amp; <span class="hljs-number"><span class="hljs-number">0x80</span></span>) != <span class="hljs-number"><span class="hljs-number">0x80</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vlq; } }</code> </pre><br>  Ù„Ù† Ø£Ù‚ÙˆÙ… Ø¨ØªØ­Ù„ÙŠÙ„ Ø§Ù„ØªÙ†Ø³ÙŠÙ‚ Ù„ÙˆØµÙ Ø§Ù„Ù‡ÙŠØ§ÙƒÙ„ Ø¨Ø§Ù„ØªÙØµÙŠÙ„ ØŒ Ù„Ø£Ù†  Ø¥Ù…Ø§ Ø£Ù†Ù‡Ø§ ØªØ®Øµ Ø§Ù„Ù„Ø¹Ø¨Ø© Ø§Ù„Ù…Ø¹Ù†ÙŠØ© ØŒ Ø£Ùˆ Ø£Ù†Ù‡Ø§ ØªÙ†Ø³ÙŠÙ‚ Ù…Ù‚Ø¨ÙˆÙ„ Ø¹Ù…ÙˆÙ…Ù‹Ø§ ÙÙŠ <code>Protocol Buffers</code> (Ø¥Ø°Ø§ ÙƒØ§Ù† Ø£ÙŠ Ø´Ø®Øµ ÙŠØ¹Ø±Ù Ø¨Ø§Ù„ØªØ£ÙƒÙŠØ¯ ØŒ ÙÙŠØ±Ø¬Ù‰ Ø§Ù„Ø¥Ø´Ø§Ø±Ø© ÙÙŠ Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª).  Ù…Ù…Ø§ Ø§Ø³ØªØ·Ø¹Øª Ø§ÙƒØªØ´Ø§ÙÙ‡: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  Ø§Ù„ÙˆØµÙ ÙŠØ£ØªÙŠ Ø£ÙŠØ¶Ø§ ÙÙŠ Ø´ÙƒÙ„ <code>Protocol Buffers</code> Ø› </li><li style=";text-align:right;direction:rtl">  ÙŠØ­ØªÙˆÙŠ ÙˆØµÙ ÙƒÙ„ Ø­Ù‚Ù„ Ø¹Ù„Ù‰ Ø§Ø³Ù…Ù‡ ÙˆØ±Ù‚Ù…Ù‡ ÙˆÙ†ÙˆØ¹ Ø¨ÙŠØ§Ù†Ø§ØªÙ‡ ØŒ Ø­ÙŠØ« ØªÙ… Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù†ÙˆØ¹ Ø§Ù„Ø®Ø§Øµ Ø¨Ù‡: <br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-built_in">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TypeToStr</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(uint type)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (type) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"Float"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"UInt64"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"UInt32"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"Boolean"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">9</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"String"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">11</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"Struct"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">14</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"Enum"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: local <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> s; SPrintf(s, <span class="hljs-string"><span class="hljs-string">"%Lu"</span></span>, type); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> s; } };</code> </pre></li><li style=";text-align:right;direction:rtl">  Ø¥Ø°Ø§ ÙƒØ§Ù† Ù†ÙˆØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¹Ø¨Ø§Ø±Ø© Ø¹Ù† ØªØ¹Ø¯Ø§Ø¯ Ø£Ùˆ Ø¨Ù†ÙŠØ© ØŒ ÙÙ‡Ù†Ø§Ùƒ Ø±Ø§Ø¨Ø· Ø¥Ù„Ù‰ Ø§Ù„ÙƒØ§Ø¦Ù† Ø§Ù„Ù…Ø·Ù„ÙˆØ¨. </li></ul><br>  Ø­Ø³Ù†Ù‹Ø§ ØŒ Ø¢Ø®Ø± Ù…Ø§ ØªØ¨Ù‚Ù‰ Ø¨Ø§Ù„Ù†Ø³Ø¨Ø© Ù„Ù†Ø§ Ù‡Ùˆ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ÙˆØ§Ø±Ø¯Ø© ÙÙŠ ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø§Ø³ØªÙ…Ø§Ø¹ Ù„Ø¯ÙŠÙ†Ø§: ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…ÙƒØªØ¨Ø© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><code>protobuf-net</code></a> .  ØªÙˆØµÙŠÙ„ Ø§Ù„Ù…ÙƒØªØ¨Ø© Ø¹Ø¨Ø± NuGet ØŒ Ø¥Ø¶Ø§ÙØ© <code>using ProtoBuf;</code>  ÙˆÙŠÙ…ÙƒÙ†Ùƒ Ø¥Ù†Ø´Ø§Ø¡ ÙØ¦Ø§Øª Ù„ÙˆØµÙ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„.  Ø®Ø° Ù…Ø«Ø§Ù„Ø§Ù‹ ÙˆØ§Ø­Ø¯Ø§Ù‹ Ù…Ù† Ù…Ù‚Ø§Ù„Ø© Ø³Ø§Ø¨Ù‚Ø©: Ø­Ø±ÙƒØ© Ø§Ù„Ø´Ø®ØµÙŠØ§Øª.  ÙŠØ¨Ø¯Ùˆ Ø§Ù„ÙˆØµÙ Ø§Ù„Ù…Ù†Ø³Ù‚ Ù„Ù„ØªÙ†Ø³ÙŠÙ‚ Ø¹Ù†Ø¯ ØªÙ…ÙŠÙŠØ² Ø§Ù„Ø£Ø¬Ø²Ø§Ø¡ ÙƒÙ…Ø§ ÙŠÙ„ÙŠ: <br><br><img src="https://habrastorage.org/webt/ce/qg/py/ceqgpyfbuxygvoqx4jnlp8slumy.png"><br><br>  ÙŠØ³Ù…Ø­ Ù„Ùƒ Ø¥Ø®Ø±Ø§Ø¬ Ø§Ù„ØªØµØ­ÙŠØ­ Ø¨Ø¥Ù†Ø´Ø§Ø¡ ÙˆØµÙ Ù‚ØµÙŠØ± Ù…Ù† Ù‡Ø°Ø§: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">Field 1 (Type 13): time Field 2 (Struct .pb.CxGS_Vec3): position Field 3 (UInt64): guid Field 4 (Struct .pb.CxGS_Vec3): direction Field 5 (Struct .pb.CxGS_Vec3): speed Field 6 (UInt32): state Field 10 (UInt32): flag Field 11 (Float): y_speed Field 12 (Boolean): is_flying Field 7 (UInt32): emote_id Field 9 (UInt32): emote_duration Field 8 (Boolean): emote_loop</code> </pre><br>  Ø§Ù„Ø¢Ù† ÙŠÙ…ÙƒÙ†Ùƒ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ÙØ¦Ø© Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø© Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…ÙƒØªØ¨Ø© <code>protobuf-net</code> . <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs">[<span class="hljs-meta"><span class="hljs-meta">ProtoContract</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">MoveInfo</span></span> : <span class="hljs-title"><span class="hljs-title">ProtoBufEvent</span></span>&lt;<span class="hljs-title"><span class="hljs-title">MoveInfo</span></span>&gt; { [ProtoMember(<span class="hljs-number"><span class="hljs-number">3</span></span>)] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ulong</span></span> GUID; [ProtoMember(<span class="hljs-number"><span class="hljs-number">1</span></span>)] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ulong</span></span> Time; [ProtoMember(<span class="hljs-number"><span class="hljs-number">2</span></span>)] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Vec3 Position; [ProtoMember(<span class="hljs-number"><span class="hljs-number">4</span></span>)] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Vec3 Direction; [ProtoMember(<span class="hljs-number"><span class="hljs-number">5</span></span>)] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Vec3 Speed; [ProtoMember(<span class="hljs-number"><span class="hljs-number">6</span></span>)] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ulong</span></span> State; [ProtoMember(<span class="hljs-number"><span class="hljs-number">7</span></span>, IsRequired = <span class="hljs-literal"><span class="hljs-literal">false</span></span>)] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">uint</span></span> EmoteID; [ProtoMember(<span class="hljs-number"><span class="hljs-number">8</span></span>, IsRequired = <span class="hljs-literal"><span class="hljs-literal">false</span></span>)] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> EmoteLoop; [ProtoMember(<span class="hljs-number"><span class="hljs-number">9</span></span>, IsRequired = <span class="hljs-literal"><span class="hljs-literal">false</span></span>)] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">uint</span></span> EmoteDuration; [ProtoMember(<span class="hljs-number"><span class="hljs-number">10</span></span>, IsRequired = <span class="hljs-literal"><span class="hljs-literal">false</span></span>)] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">uint</span></span> Flag; [ProtoMember(<span class="hljs-number"><span class="hljs-number">11</span></span>, IsRequired = <span class="hljs-literal"><span class="hljs-literal">false</span></span>)] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> SpeedY; [ProtoMember(<span class="hljs-number"><span class="hljs-number">12</span></span>)] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> IsFlying; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ToString</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">$"</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{GUID}</span></span></span><span class="hljs-string">: </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{Position}</span></span></span><span class="hljs-string">"</span></span>; } }</code> </pre><br>  Ù„Ù„Ù…Ù‚Ø§Ø±Ù†Ø© ØŒ Ø¥Ù„ÙŠÙƒ Ù†Ù…ÙˆØ°Ø¬ Ù„Ù†ÙØ³ Ø§Ù„Ø­Ø¯Ø« Ù…Ù† Ù…Ù‚Ø§Ù„Ø© Ø³Ø§Ø¨Ù‚Ø©: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MoveEvent</span></span></span><span class="hljs-class"> {</span></span> uint data_length &lt;bgcolor=<span class="hljs-number"><span class="hljs-number">0x00FF00</span></span>, name=<span class="hljs-string"><span class="hljs-string">"Data Length"</span></span>&gt;; Packed move_time &lt;bgcolor=<span class="hljs-number"><span class="hljs-number">0x00FFFF</span></span>&gt;; PackedVector3 position &lt;bgcolor=<span class="hljs-number"><span class="hljs-number">0x00FF00</span></span>&gt;; PackedVector3 direction &lt;bgcolor=<span class="hljs-number"><span class="hljs-number">0x00FF00</span></span>&gt;; PackedVector3 speed &lt;bgcolor=<span class="hljs-number"><span class="hljs-number">0x00FF00</span></span>&gt;; Packed state &lt;bgcolor=<span class="hljs-number"><span class="hljs-number">0x00FF00</span></span>&gt;; };</code> </pre><br>  Ø¹Ù†Ø¯ <code>ParseData</code> ÙØ¦Ø© <code>Event</code> ØŒ ÙŠÙ…ÙƒÙ†Ù†Ø§ ØªØ¬Ø§ÙˆØ² Ø£Ø³Ù„ÙˆØ¨ <code>ParseData</code> Ø¹Ù† Ø·Ø±ÙŠÙ‚ Ø¥Ù„ØºØ§Ø¡ ØªØ³Ù„Ø³Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø²Ù…Ø©: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">CMSG_MOVE_INFO</span></span> : <span class="hljs-title"><span class="hljs-title">Event</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> MoveInfo _message; [...] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ParseData</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { _message = MoveInfo.Deserialize(GetPayload()); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ToString</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _message.ToString(); } }</code> </pre><br>  Ù‡Ø°Ø§ ÙƒÙ„ Ø´ÙŠØ¡.  ÙˆØ§Ù„Ø®Ø·ÙˆØ© Ø§Ù„ØªØ§Ù„ÙŠØ© Ù‡ÙŠ Ø¥Ø¹Ø§Ø¯Ø© ØªÙˆØ¬ÙŠÙ‡ Ø­Ø±ÙƒØ© Ø§Ù„Ù„Ø¹Ø¨Ø© Ø¥Ù„Ù‰ Ø®Ø§Ø¯Ù…Ù†Ø§ Ø§Ù„ÙˆÙƒÙŠÙ„ Ø¨ØºØ±Ø¶ Ø§Ù„Ø­Ù‚Ù† ÙˆØ§Ù„Ø®Ø¯Ø§Ø¹ ÙˆØ§Ù„Ù‚Ø·Ø¹. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar457480/">https://habr.com/ru/post/ar457480/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar457464/index.html">Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙƒØ±Ø±Ø© Ù„Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ø¹Ù„Ù‰ Yandex.Real Estate</a></li>
<li><a href="../ar457466/index.html">ÙƒÙŠÙ Ù‚Ù…Ù†Ø§ Ø¨ØªØ·ÙˆÙŠØ± ØªÙƒÙ†ÙˆÙ„ÙˆØ¬ÙŠØ§ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª ÙÙŠ Leroy Merlin: Ø¥Ø¹Ø§Ø¯Ø© Ø¨Ù†Ø§Ø¡ Ù…Ø­Ø±Ùƒ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ØªÙ†Ù‚Ù„</a></li>
<li><a href="../ar457468/index.html">Ø°Ø§ÙƒØ±Ø© Ø¹Ø§Ù„Ù…ÙŠØ©: SRAM ØŒ DRAM ÙˆØ°Ø§ÙƒØ±Ø© ÙÙ„Ø§Ø´ ÙÙŠ Ø²Ø¬Ø§Ø¬Ø© ÙˆØ§Ø­Ø¯Ø©</a></li>
<li><a href="../ar457470/index.html">ÙˆØ±Ù‚Ø© Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª: ÙƒÙŠÙ ØºÙŠØ±Øª Ø´Ø¬ÙŠØ±Ø© ØºÙŠØ± Ø¹Ø§Ø¯ÙŠØ© Ù…Ø¹Ø§Ø¯Ù„Ø© Ù†Ù…ÙˆØ°Ø¬ Ù†Ù…Ùˆ Ø§Ù„Ù†Ø¨Ø§Øª</a></li>
<li><a href="../ar457476/index.html">ØªÙ‚Ù„ÙŠÙ„ Ø­Ø¬Ù… ØµÙˆØ±Ø© Ø¹Ø§Ù…Ù„ Ù…ÙŠÙ†Ø§Ø¡ Ù…Ø¹ ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ØªÙ…Ù‡ÙŠØ¯ Ø§Ù„Ø±Ø¨ÙŠØ¹</a></li>
<li><a href="../ar457490/index.html">Aisioshechka Ù…Ù† Ø²ÙˆÙƒØ±Ø¨ÙŠØ±Ø¬ - Ù„ÙØªØ±Ø© ÙˆØ¬ÙŠØ²Ø© ÙÙŠ Ù‚Ø¶ÙŠØ© Ø§Ù„Ù…ÙŠØ²Ø§Ù†</a></li>
<li><a href="../ar457494/index.html">"ÙˆØ¥Ø°Ø§ Ù„Ù… Ø£ÙƒÙ† Ø£Ø¹Ù„Ù… Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª ØŒ Ù‡Ù„ Ø£Ù†Ø§ Ù…ÙŠØ¦ÙˆØ³ Ù…Ù†Ù‡ØŸ" - Ù…ØªØ®ØµØµÙˆÙ† ÙŠØ¬ÙŠØ¨ÙˆÙ† Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ù…ØªØ¯Ø§ÙˆÙ„Ø© Ø­ÙˆÙ„ Ø§Ù„Ù…Ù‡Ù† ÙÙŠ Ø¹Ù„ÙˆÙ… Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</a></li>
<li><a href="../ar457496/index.html">"Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø§Ø®ØªÙ„Ø§ÙØ§Øª Ø§Ù„Ø®Ù…Ø³Ø©." Ø§Ù„ØªØ¯Ø±Ø¬ ÙˆÙØ±ÙˆÙ‚ Ø§Ù„Ø¬ÙŠÙ„ - Ø¯ÙØ¹Ø© Ø¬Ø¯ÙŠØ¯Ø© Ù…Ù† Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª</a></li>
<li><a href="../ar457500/index.html">ÙƒÙŠÙ ÙØ¹Ù„Ù†Ø§ Ø§Ù„Ø·ÙŠØ§Ø± Ø§Ù„Ø¢Ù„ÙŠ Ù„Ù…Ø­Ø·Ø© Ø®Ø¯Ù…Ø©</a></li>
<li><a href="../ar457502/index.html">ÙƒÙŠÙ ÙŠØ¹Ø²Ø² Ù†Ù…ÙˆØ°Ø¬ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ù…Ù† RICE ØªØ±ØªÙŠØ¨ Ù…ÙŠØ²Ø§Øª Ø§Ù„Ù…Ù†ØªØ¬</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>