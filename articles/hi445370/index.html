<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ЁЯзФ ЁЯПНя╕П ЁЯЪн рдкреНрд░реЛрдореЗрдерд┐рдпрд╕ 2 рдореЗрдВ TSDB рд╡рд┐рд╢реНрд▓реЗрд╖рдг ЁЯСйЁЯП╜тАНЁЯПн ЁЯзЩЁЯП╜ ЁЯПЗЁЯП╛</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="рдкреНрд░реЛрдореЗрдерд┐рдпрд╕ 2 рдореЗрдВ рдЯрд╛рдЗрдо рд╕реАрд░реАрдЬрд╝ рдбреЗрдЯрд╛рдмреЗрд╕ (рдЯреАрдПрд╕рдбреАрдмреА) рдПрдХ рдЗрдВрдЬреАрдирд┐рдпрд░рд┐рдВрдЧ рд╕рдорд╛рдзрд╛рди рдХрд╛ рдПрдХ рдмрдбрд╝рд╛ рдЙрджрд╛рд╣рд░рдг рд╣реИ, рдЬреЛ рдбреЗрдЯрд╛ рд╕реНрдЯреЛрд░реЗрдЬ рдФрд░ рдХреНрд╡реЗрд░реА рдирд┐рд╖реНрдкрд╛рджрди, рд╕рдВрд╕рд╛рдзрди рджрдХреНрд╖рддрд╛ рдХреА рдЧрддрд┐ рдХ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>рдкреНрд░реЛрдореЗрдерд┐рдпрд╕ 2 рдореЗрдВ TSDB рд╡рд┐рд╢реНрд▓реЗрд╖рдг</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/funcorp/blog/445370/"><img src="https://habrastorage.org/webt/vd/66/kh/vd66khzvg2fd68xtdpwyq462zm0.png"><br><br>  рдкреНрд░реЛрдореЗрдерд┐рдпрд╕ 2 рдореЗрдВ рдЯрд╛рдЗрдо рд╕реАрд░реАрдЬрд╝ рдбреЗрдЯрд╛рдмреЗрд╕ (рдЯреАрдПрд╕рдбреАрдмреА) рдПрдХ рдЗрдВрдЬреАрдирд┐рдпрд░рд┐рдВрдЧ рд╕рдорд╛рдзрд╛рди рдХрд╛ рдПрдХ рдмрдбрд╝рд╛ рдЙрджрд╛рд╣рд░рдг рд╣реИ, рдЬреЛ рдбреЗрдЯрд╛ рд╕реНрдЯреЛрд░реЗрдЬ рдФрд░ рдХреНрд╡реЗрд░реА рдирд┐рд╖реНрдкрд╛рджрди, рд╕рдВрд╕рд╛рдзрди рджрдХреНрд╖рддрд╛ рдХреА рдЧрддрд┐ рдХреЗ рдорд╛рдорд▓реЗ рдореЗрдВ рдкреНрд░реЛрдореЗрдерд┐рдпрд╕ 1 рдореЗрдВ v2 рд╕реНрдЯреЛрд░реЗрдЬ рдкрд░ рдкреНрд░рдореБрдЦ рд╕реБрдзрд╛рд░ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред  рд╣рдордиреЗ рдкреЗрд░рдХреЛрдирд╛ рдореЙрдирд┐рдЯрд░рд┐рдВрдЧ рдПрдВрдб рдореИрдиреЗрдЬрдореЗрдВрдЯ (рдкреАрдПрдордПрдо) рдореЗрдВ рдкреНрд░реЛрдореЗрдерд┐рдпрд╕ 2 рдХреЛ рд▓рд╛рдЧреВ рдХрд┐рдпрд╛, рдФрд░ рдореБрдЭреЗ рдкреНрд░реЛрдореЗрдерд┐рдпрд╕ 2 рдЯреАрдПрд╕рдбреАрдмреА рдХреЗ рдкреНрд░рджрд░реНрд╢рди рдХреЛ рд╕рдордЭрдиреЗ рдХрд╛ рдЕрд╡рд╕рд░ рдорд┐рд▓рд╛ред  рдЗрд╕ рд▓реЗрдЦ рдореЗрдВ рдореИрдВ рдЗрди рдЯрд┐рдкреНрдкрдгрд┐рдпреЛрдВ рдХреЗ рдкрд░рд┐рдгрд╛рдореЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдмрд╛рдд рдХрд░реВрдВрдЧрд╛ред <br><a name="habracut"></a><br><h3>  рдкреНрд░реЛрдореЗрдерд┐рдпрд╕ рдФрд╕рдд рдХрд╛рд░реНрдпрднрд╛рд░ </h3><br>  рдЙрди рд▓реЛрдЧреЛрдВ рдХреЗ рд▓рд┐рдП рдЬреЛ рдкреНрд░рд╛рдердорд┐рдХ рдбреЗрдЯрд╛рдмреЗрд╕ рд╕реЗ рдирд┐рдкрдЯрдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ, рдкреНрд░реЛрдореЗрдерд┐рдпрд╕ рдирд┐рдпрдорд┐рдд рдХрд╛рд░реНрдпрднрд╛рд░ рдмрд╣реБрдд рдЙрддреНрд╕реБрдХ рд╣реИред  рдбреЗрдЯрд╛ рд╕рдВрдЪрдп рдХреА рдЧрддрд┐ рдПрдХ рд╕реНрдерд┐рд░ рдореВрд▓реНрдп рддрдХ рдЬрд╛рддреА рд╣реИ: рдЖрдорддреМрд░ рдкрд░ рдЖрдкрдХреЗ рджреНрд╡рд╛рд░рд╛ рдореЙрдирд┐рдЯрд░ рдХреА рдЬрд╛рдиреЗ рд╡рд╛рд▓реА рд╕реЗрд╡рд╛рдПрдВ рд╕рдорд╛рди рд╕рдВрдЦреНрдпрд╛ рдореЗрдВ рдореАрдЯреНрд░рд┐рдХ рднреЗрдЬрддреА рд╣реИрдВ, рдФрд░ рдмреБрдирд┐рдпрд╛рджреА рдврд╛рдБрдЪрд╛ рдЕрдкреЗрдХреНрд╖рд╛рдХреГрдд рдзреАрд░реЗ-рдзреАрд░реЗ рдмрджрд▓рддрд╛ рд╣реИред <br><br>  рд╕реВрдЪрдирд╛ рдЕрдиреБрд░реЛрдз рд╡рд┐рднрд┐рдиреНрди рд╕реНрд░реЛрддреЛрдВ рд╕реЗ рдЖ рд╕рдХрддреЗ рд╣реИрдВред  рдЙрдирдореЗрдВ рд╕реЗ рдХреБрдЫ, рдЬреИрд╕реЗ рдХрд┐ рдЕрд▓рд░реНрдЯ, рдПрдХ рд╕реНрдерд┐рд░ рдФрд░ рдЕрдиреБрдорд╛рдирд┐рдд рдореВрд▓реНрдп рдХреЗ рд▓рд┐рдП рднреА рдкреНрд░рдпрд╛рд╕ рдХрд░рддреЗ рд╣реИрдВред  рдЕрдиреНрдп, рдЬреИрд╕реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдкреНрд░рд╢реНрди, рд╕реНрдкрд╛рдЗрдХреНрд╕ рдХрд╛ рдХрд╛рд░рдг рдмрди рд╕рдХрддреЗ рд╣реИрдВ, рд╣рд╛рд▓рд╛рдВрдХрд┐ рдпрд╣ рдЕрдзрд┐рдХрд╛рдВрд╢ рд▓реЛрдб рдХреЗ рд▓рд┐рдП рд╡рд┐рд╢рд┐рд╖реНрдЯ рдирд╣реАрдВ рд╣реИред <br><br><h3>  рд▓реЛрдб рдкрд░реАрдХреНрд╖рдг </h3><br>  рдкрд░реАрдХреНрд╖рдг рдХреЗ рджреМрд░рд╛рди, рдореИрдВрдиреЗ рдбреЗрдЯрд╛ рдЬрдорд╛ рдХрд░рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рдкрд░ рдзреНрдпрд╛рди рдХреЗрдВрджреНрд░рд┐рдд рдХрд┐рдпрд╛ред  рдореИрдВрдиреЗ рдкреНрд░реЛрдореЗрдерд┐рдпрд╕ 2.3.2 рдХреЛ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд▓рд┐рдкрд┐реЛрдб</a> рд╕реЗрд╡рд╛ рдкрд░ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЧреЛ 1.10.1</a> ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдкреАрдПрдордПрдо</a> 1.14 рдХреЗ рднрд╛рдЧ рдХреЗ рд░реВрдк рдореЗрдВ) рдХреЗ рд╕рд╛рде рд╕рдВрдХрд▓рд┐рдд рдХрд┐рдпрд╛: рдЗрд╕ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗред  рд╕рдмрд╕реЗ рдпрдерд╛рд░реНрдерд╡рд╛рджреА рд▓реЛрдб рдкреАрдврд╝реА рдХреЗ рд▓рд┐рдП, рдЗрд╕ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">StackScript</a> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╣реБрдП,</a> рдореИрдВрдиреЗ рдПрдХ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд▓реЛрдб (Sysbench TPC-C рдЯреЗрд╕реНрдЯ) рдХреЗ рд╕рд╛рде рдХрдИ MySQL рдиреЛрдб рд▓реЙрдиреНрдЪ рдХрд┐рдП, рдЬрд┐рдирдореЗрдВ рд╕реЗ рдкреНрд░рддреНрдпреЗрдХ рдиреЗ 10 рд▓рд┐рдирдХреНрд╕ / MySQL рдиреЛрдбреНрд╕ рдХрд╛ рдЕрдиреБрдХрд░рдг рдХрд┐рдпрд╛ред <br><br>  рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╕рднреА рдкрд░реАрдХреНрд╖рдгреЛрдВ рдХреЛ рдПрдХ рд▓рд╛рдЗрдиреЛрдб рд╕рд░реНрд╡рд░ рдкрд░ рдЖрда рдЖрднрд╛рд╕реА рдХреЛрд░ рдФрд░ 32 рдЬреАрдмреА рдореЗрдореЛрд░реА рдХреЗ рд╕рд╛рде рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛, рдЬрд┐рд╕ рдкрд░ рджреЛ рд╕реМ MySQL рдЙрджрд╛рд╣рд░рдгреЛрдВ рдХреА рдирд┐рдЧрд░рд╛рдиреА рдХреЗ 20 рд▓реЛрдб рд╕рд┐рдореБрд▓реЗрд╢рди рд▓реЙрдиреНрдЪ рдХрд┐рдП рдЧрдП рдереЗред  рдпрд╛, рдкреНрд░реЛрдореЗрдерд┐рдпрд╕ рд╢рдмреНрджреЛрдВ рдореЗрдВ, 800 рд▓рдХреНрд╖реНрдп, рдкреНрд░рддрд┐ рд╕реЗрдХрдВрдб 440 рд╕реНрдХреНрд░реИрдк, рдкреНрд░рддрд┐ рд╕реЗрдХрдВрдб 380 рд╣рдЬрд╛рд░ рдирдореВрдиреЗ, рдФрд░ 1.7 рдорд┐рд▓рд┐рдпрди рд╕рдХреНрд░рд┐рдп рд╕рдордп рд╢реНрд░реГрдВрдЦрд▓рд╛ред <br><br><h3>  рдбрд┐рдЬрд╝рд╛рдЗрди </h3><br>  рдкрд╛рд░рдВрдкрд░рд┐рдХ рдбреЗрдЯрд╛рдмреЗрд╕ рдХрд╛ рд╕рд╛рдорд╛рдиреНрдп рджреГрд╖реНрдЯрд┐рдХреЛрдг, рдЬрд┐рд╕рдореЗрдВ рдкреНрд░реЛрдореЗрдерд┐рдпрд╕ 1.x рджреНрд╡рд╛рд░рд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╕реНрдореГрддрд┐ рд╕реАрдорд╛ рд╣реИ</a> ред  рдпрджрд┐ рдпрд╣ рднрд╛рд░ рдЭреЗрд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдкрд░реНрдпрд╛рдкреНрдд рдирд╣реАрдВ рд╣реИ, рддреЛ рдЖрдк рдмрдбрд╝реЗ рд╡рд┐рд▓рдВрдм рдХрд╛ рд╕рд╛рдордирд╛ рдХрд░реЗрдВрдЧреЗ рдФрд░ рдХреБрдЫ рдЕрдиреБрд░реЛрдз рдкреВрд░реЗ рдирд╣реАрдВ рд╣реЛрдВрдЧреЗред <br>  рдкреНрд░реЛрдореЗрдерд┐рдпрд╕ 2 рдореЗрдВ рдореЗрдореЛрд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ <code>storage.tsdb.min-block-duration</code> . <code>storage.tsdb.min-block-duration</code> рдХреБрдВрдЬреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЬреЛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдбрд┐рд╕реНрдХ рдХреЛ рдлреНрд▓рд╢ рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдореЗрдореЛрд░реА рдореЗрдВ рдХрд┐рддрдиреЗ рд╕рдордп рддрдХ рд░рд┐рдХреЙрд░реНрдб рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ (рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ, рдпрд╣ 2 рдШрдВрдЯреЗ рд╣реИ)ред  рдЖрд╡рд╢реНрдпрдХ рдореЗрдореЛрд░реА рдХреА рдорд╛рддреНрд░рд╛ рдХреБрд▓ рдЗрдирдкреБрдЯ рд╕реНрдЯреНрд░реАрдо рдХреЗ рд╕рд╛рде рд╕рдордп рд╢реНрд░реГрдВрдЦрд▓рд╛, рд▓реЗрдмрд▓ рдФрд░ рдбреЗрдЯрд╛ рд╕рдВрдЧреНрд░рд╣ (рд╕реНрдХреНрд░реИрдк) рдХреА рддреАрд╡реНрд░рддрд╛ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░реЗрдЧреАред  рдбрд┐рд╕реНрдХ рд╕реНрдерд╛рди рдХреЗ рд╕рдВрджрд░реНрдн рдореЗрдВ, рдкреНрд░реЛрдореЗрдерд┐рдпрд╕ рдХрд╛ рд▓рдХреНрд╖реНрдп рдкреНрд░рддрд┐ рд░рд┐рдХреЙрд░реНрдб (рдирдореВрдирд╛) 3 рдмрд╛рдЗрдЯреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╣реИред  рджреВрд╕рд░реА рдУрд░, рд╕реНрдореГрддрд┐ рдЖрд╡рд╢реНрдпрдХрддрд╛рдПрдВ рдмрд╣реБрдд рдЕрдзрд┐рдХ рд╣реИрдВред <br><br>  рдЗрд╕ рддрдереНрдп рдХреЗ рдмрд╛рд╡рдЬреВрдж рдХрд┐ рдмреНрд▓реЙрдХ рдЖрдХрд╛рд░ рдХреЛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИ, рдЗрд╕реЗ рдореИрдиреНрдпреБрдЕрд▓ рд░реВрдк рд╕реЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рдиреЗ рдХреА рдЕрдиреБрд╢рдВрд╕рд╛ рдирд╣реАрдВ рдХреА рдЬрд╛рддреА рд╣реИ, рдЗрд╕рд▓рд┐рдП рдЖрдкрдХреЛ рдкреНрд░реЛрдореЗрдерд┐рдпрд╕ рдХреЛ рдЙрддрдиреА рд╣реА рд╕реНрдореГрддрд┐ рджреЗрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдХреЗ рд╕рд╛рде рд╕рд╛рдордирд╛ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬрд┐рддрдирд╛ рд╡рд╣ рдЖрдкрдХреЗ рд▓реЛрдб рдХреЗ рд▓рд┐рдП рдкреВрдЫрддрд╛ рд╣реИред <br><br>  рдпрджрд┐ рдЖрдиреЗ рд╡рд╛рд▓реА рдореАрдЯреНрд░рд┐рдХ рд╕реНрдЯреНрд░реАрдо рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкрд░реНрдпрд╛рдкреНрдд рдореЗрдореЛрд░реА рдирд╣реАрдВ рд╣реИ, рддреЛ рдкреНрд░реЛрдореЗрдерд┐рдпрд╕ рдореЗрдореЛрд░реА рд╕реЗ рдмрд╛рд╣рд░ рдирд┐рдХрд▓ рдЬрд╛рдПрдЧрд╛ рдпрд╛ рдПрдХ OOM рдХрд┐рд▓рд░ рдорд┐рд▓реЗрдЧрд╛ред <br><br>  рдкреНрд░реЛрдореЗрдерд┐рдпрд╕ рд╕реНрдореГрддрд┐ рд╕реЗ рдмрд╛рд╣рд░ рдЪрд▓рд╛рддрд╛ рд╣реИ рдЬрдм рджреБрд░реНрдШрдЯрдирд╛ рдореЗрдВ рджреЗрд░реА рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реНрд╡реИрдк рдЬреЛрдбрд╝рдирд╛ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдорджрдж рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдЗрд╕ рд╕реБрд╡рд┐рдзрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рд╡рд┐рд╕реНрдлреЛрдЯрдХ рд╕реНрдореГрддрд┐ рдЦрдкрдд рдХрд╛ рдХрд╛рд░рдг рдмрдирддрд╛ рд╣реИред  рдореБрдЭреЗ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рдмрд╛рдд рдЧреЛ, рдЗрд╕рдХреЗ рдХрдЪрд░рд╛ рд╕рдВрдЧреНрд░рд╣рдХрд░реНрддрд╛ рдХреА рд╣реИ рдФрд░ рдпрд╣ рд╕реНрд╡реИрдк рдХреЗ рд╕рд╛рде рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИред <br><br>  рдПрдХ рдФрд░ рджрд┐рд▓рдЪрд╕реНрдк рджреГрд╖реНрдЯрд┐рдХреЛрдг рд╣реЗрдб рдмреНрд▓реЙрдХ рдХреЛ рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рд╕рдордп рдореЗрдВ рдбрд┐рд╕реНрдХ рдкрд░ рд░реАрд╕реЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрдЯ рдХрд░ рд░рд╣рд╛ рд╣реИ, рдмрдЬрд╛рдп рдЗрд╕реЗ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреА рд╢реБрд░реБрдЖрдд рд╕реЗ рдЧрд┐рдирдиреЗ рдХреЗред <br><br><img src="https://habrastorage.org/webt/bl/pi/qv/blpiqvwimzifjmfyzbrplkagkcg.png"><br><br>  рдЬреИрд╕рд╛ рдХрд┐ рдЖрдк рдЧреНрд░рд╛рдл рд╕реЗ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ, рдбрд┐рд╕реНрдХ рдлреНрд▓рд╢ рд╣рд░ рджреЛ рдШрдВрдЯреЗ рдореЗрдВ рд╣реЛрддрд╛ рд╣реИред  рдпрджрд┐ рдЖрдк рдиреНрдпреВрдирддрдо-рдмреНрд▓реЙрдХ-рдЕрд╡рдзрд┐ рдкреИрд░рд╛рдореАрдЯрд░ рдХреЛ рдПрдХ рдШрдВрдЯреЗ рдореЗрдВ рдмрджрд▓рддреЗ рд╣реИрдВ, рддреЛ рдпреЗ рдирд┐рд░реНрд╡рд╣рди рд╣рд░ рдШрдВрдЯреЗ рд╣реЛрдВрдЧреЗ, рдЬреЛ рдЖрдзреЗ рдШрдВрдЯреЗ рдореЗрдВ рд╢реБрд░реВ рд╣реЛрдЧрд╛ред <br><br>  <i>рдпрджрд┐ рдЖрдк рдЕрдкрдиреЗ рдкреНрд░реЛрдореЗрдерд┐рдпрд╕ рдЗрдВрд╕реНрдЯреЙрд▓реЗрд╢рди рдореЗрдВ рдЗрд╕ рдФрд░ рдЕрдиреНрдп рдЧреНрд░рд╛рдлрд┐рдХреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рддреЛ рдЖрдк рдЗрд╕ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдбреИрд╢рдмреЛрд░реНрдб рдХрд╛</a> рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред</i>  <i>рдпрд╣ рдкреАрдПрдордПрдо рдХреЗ рд▓рд┐рдП рд╡рд┐рдХрд╕рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛, рд▓реЗрдХрд┐рди, рдорд╛рдореВрд▓реА рд╕рдВрд╢реЛрдзрдиреЛрдВ рдХреЗ рд╕рд╛рде, рдкреНрд░реЛрдореЗрдерд┐рдпрд╕ рдХреА рдХрд┐рд╕реА рднреА рд╕реНрдерд╛рдкрдирд╛ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреБрдХреНрдд рд╣реИред</i> <br><br>  рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдПрдХ рд╕рдХреНрд░рд┐рдп рдмреНрд▓реЙрдХ рд╣реИ рдЬрд┐рд╕реЗ рд╣реЗрдб рдмреНрд▓реЙрдХ рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬреЛ рдореЗрдореЛрд░реА рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реЛрддрд╛ рд╣реИ;  рдкреБрд░рд╛рдиреЗ рдбреЗрдЯрд╛ рд╡рд╛рд▓реЗ рдмреНрд▓реЙрдХ <code>mmap()</code> рдорд╛рдзреНрдпрдо рд╕реЗ рд╕реБрд▓рдн рд╣реИрдВред  рдпрд╣ рдХреИрд╢ рдХреЛ рдЕрд▓рдЧ рд╕реЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдХреЛ рд╕рдорд╛рдкреНрдд рдХрд░рддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдЗрд╕рдХрд╛ рдорддрд▓рдм рдпрд╣ рднреА рд╣реИ рдХрд┐ рдЖрдкрдХреЛ рдСрдкрд░реЗрдЯрд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдо рдХреИрд╢ рдХреЗ рд▓рд┐рдП рдкрд░реНрдпрд╛рдкреНрдд рд╕реНрдерд╛рди рдЫреЛрдбрд╝рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рдпрджрд┐ рдЖрдк рд╣реЗрдб рдмреНрд▓реЙрдХ рд╕реЗ рдкреБрд░рд╛рдиреЗ рдбреЗрдЯрд╛ рдХреЗ рд▓рд┐рдП рдЕрдиреБрд░реЛрдз рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВред <br><br>  рдЗрд╕рдХрд╛ рдорддрд▓рдм рдпрд╣ рднреА рд╣реИ рдХрд┐ рдкреНрд░реЛрдореЗрдерд┐рдпрд╕ рд╡рд░реНрдЪреБрдЕрд▓ рдореЗрдореЛрд░реА рдХреА рдЦрдкрдд рдХрд╛рдлреА рдЕрдзрд┐рдХ рд╣реЛрдЧреА, рдЬрд┐рд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЪрд┐рдВрддрд╛ рдХрд░рдиреЗ рдпреЛрдЧреНрдп рдирд╣реАрдВ рд╣реИред <br><br><img src="https://habrastorage.org/webt/ls/sl/qp/lsslqpxvg2lgzvpvbnupee0qbik.png"><br><br>  рдПрдХ рдФрд░ рджрд┐рд▓рдЪрд╕реНрдк рдбрд┐рдЬрд╛рдЗрди рдмрд┐рдВрджреБ рд╡рд╛рд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ (рдЖрдЧреЗ рд▓реЙрдЧ рд▓рд┐рдЦреЛ) рд╣реИред  рдЬреИрд╕рд╛ рдХрд┐ рдЖрдк рднрдВрдбрд╛рд░рдг рдкреНрд░рд▓реЗрдЦрди рд╕реЗ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ, рдкреНрд░реЛрдореЗрдерд┐рдпрд╕ рдЧрд┐рд░ рдХреЗ рдХрд╛рд░рдг рдиреБрдХрд╕рд╛рди рд╕реЗ рдмрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рд╡рд╛рд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред  рдбреЗрдЯрд╛ рдЙрддреНрддрд░рдЬреАрд╡рд┐рддрд╛ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╡рд┐рд╢рд┐рд╖реНрдЯ рддрдВрддреНрд░, рджреБрд░реНрднрд╛рдЧреНрдп рд╕реЗ, рдЕрдЪреНрдЫреА рддрд░рд╣ рд╕реЗ рдкреНрд░рд▓реЗрдЦрд┐рдд рдирд╣реАрдВ рд╣реИрдВред  рдкреНрд░реЛрдореЗрдерд┐рдпрд╕ рд╕рдВрд╕реНрдХрд░рдг 2.3.2 рд╣рд░ 10 рд╕реЗрдХрдВрдб рдореЗрдВ рдбрд┐рд╕реНрдХ рдХреЛ рдлреНрд▓рд╢ рдХрд░рддрд╛ рд╣реИ, рдФрд░ рдпрд╣ рдкреИрд░рд╛рдореАрдЯрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рдиреЗ рдпреЛрдЧреНрдп рдирд╣реАрдВ рд╣реИред <br><br><h3>  рдЬрд╡рд╛рдиреЛрдВ (рдЧрдгрдирд╛) </h3><br>  рдкреНрд░реЛрдореЗрдерд┐рдпрд╕ TSDB рдПрдХ LSM рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА (рд▓реЙрдЧ рд╕реНрдЯреНрд░рдХреНрдЪрд░реНрдб рдорд░реНрдЬ - рд▓реЙрдЧрд┐рдВрдЧ рдХреЗ рд╕рд╛рде рдПрдХ рд▓реЙрдЧ-рд╕реНрдЯреНрд░рдХреНрдЪрд░реНрдб рдЯреНрд░реА) рдХреА рдЫрд╡рд┐ рдореЗрдВ рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ: рд╣реЗрдб рдмреНрд▓реЙрдХ рдХреЛ рд╕рдордп-рд╕рдордп рдкрд░ рдбрд┐рд╕реНрдХ рдореЗрдВ рдлреНрд▓рд╢ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬрдмрдХрд┐ рд╕рдВрдкреАрдбрд╝рди рддрдВрддреНрд░ рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЗ рджреМрд░рд╛рди рдмрд╣реБрдд рд╕рд╛рд░реЗ рдмреНрд▓реЙрдХ рдХреА рд╕реНрдХреИрдирд┐рдВрдЧ рдХреЛ рд░реЛрдХрдиреЗ рдХреЗ рд▓рд┐рдП рдХрдИ рдмреНрд▓реЙрдХреЛрдВ рдХреЛ рдПрдХ рд╕рд╛рде рдЬреЛрдбрд╝рддрд╛ рд╣реИред  рдпрд╣рд╛рдБ рдЖрдк рдЙрди рдмреНрд▓реЙрдХреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдЬрд┐рдиреНрд╣реЗрдВ рдореИрдВрдиреЗ рдПрдХ рджрд┐рди рдХреЗ рдХрд╛рдо рдХреЗ рдмрд╛рдж рдкрд░реАрдХреНрд╖рдг рдкреНрд░рдгрд╛рд▓реА рдкрд░ рджреЗрдЦрд╛ рдерд╛ред <br><br><img src="https://habrastorage.org/webt/4o/96/oy/4o96oyaps3brdaqea7n1qyerpgw.png"><br><br>  рдпрджрд┐ рдЖрдк рднрдВрдбрд╛рд░ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рддреЛ рдЖрдк рдореЗрдЯрд╛.json рдлрд╝рд╛рдЗрд▓ рдХрд╛ рдЕрдзреНрдпрдпрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЬрд┐рд╕рдореЗрдВ рдЙрдкрд▓рдмреНрдз рдмреНрд▓реЙрдХ рдФрд░ рд╡реЗ рдХреИрд╕реЗ рджрд┐рдЦрд╛рдИ рджреЗрддреЗ рд╣реИрдВ, рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рд╢рд╛рдорд┐рд▓ рд╣реИред <br><br><pre> <code class="json hljs">{       <span class="hljs-attr"><span class="hljs-attr">"ulid"</span></span>: <span class="hljs-string"><span class="hljs-string">"01CPZDPD1D9R019JS87TPV5MPE"</span></span>,       <span class="hljs-attr"><span class="hljs-attr">"minTime"</span></span>: <span class="hljs-number"><span class="hljs-number">1536472800000</span></span>,       <span class="hljs-attr"><span class="hljs-attr">"maxTime"</span></span>: <span class="hljs-number"><span class="hljs-number">1536494400000</span></span>,       <span class="hljs-attr"><span class="hljs-attr">"stats"</span></span>: {               <span class="hljs-attr"><span class="hljs-attr">"numSamples"</span></span>: <span class="hljs-number"><span class="hljs-number">8292128378</span></span>,               <span class="hljs-attr"><span class="hljs-attr">"numSeries"</span></span>: <span class="hljs-number"><span class="hljs-number">1673622</span></span>,               <span class="hljs-attr"><span class="hljs-attr">"numChunks"</span></span>: <span class="hljs-number"><span class="hljs-number">69528220</span></span>       },       <span class="hljs-attr"><span class="hljs-attr">"compaction"</span></span>: {               <span class="hljs-attr"><span class="hljs-attr">"level"</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span>,               <span class="hljs-attr"><span class="hljs-attr">"sources"</span></span>: [                       <span class="hljs-string"><span class="hljs-string">"01CPYRY9MS465Y5ETM3SXFBV7X"</span></span>,                       <span class="hljs-string"><span class="hljs-string">"01CPYZT0WRJ1JB1P0DP80VY5KJ"</span></span>,                       <span class="hljs-string"><span class="hljs-string">"01CPZ6NR4Q3PDP3E57HEH760XS"</span></span>               ],               <span class="hljs-attr"><span class="hljs-attr">"parents"</span></span>: [                       {                               <span class="hljs-attr"><span class="hljs-attr">"ulid"</span></span>: <span class="hljs-string"><span class="hljs-string">"01CPYRY9MS465Y5ETM3SXFBV7X"</span></span>,                               <span class="hljs-attr"><span class="hljs-attr">"minTime"</span></span>: <span class="hljs-number"><span class="hljs-number">1536472800000</span></span>,                               <span class="hljs-attr"><span class="hljs-attr">"maxTime"</span></span>: <span class="hljs-number"><span class="hljs-number">1536480000000</span></span>                       },                       {                               <span class="hljs-attr"><span class="hljs-attr">"ulid"</span></span>: <span class="hljs-string"><span class="hljs-string">"01CPYZT0WRJ1JB1P0DP80VY5KJ"</span></span>,                               <span class="hljs-attr"><span class="hljs-attr">"minTime"</span></span>: <span class="hljs-number"><span class="hljs-number">1536480000000</span></span>,                               <span class="hljs-attr"><span class="hljs-attr">"maxTime"</span></span>: <span class="hljs-number"><span class="hljs-number">1536487200000</span></span>                       },                       {                               <span class="hljs-attr"><span class="hljs-attr">"ulid"</span></span>: <span class="hljs-string"><span class="hljs-string">"01CPZ6NR4Q3PDP3E57HEH760XS"</span></span>,                               <span class="hljs-attr"><span class="hljs-attr">"minTime"</span></span>: <span class="hljs-number"><span class="hljs-number">1536487200000</span></span>,                               <span class="hljs-attr"><span class="hljs-attr">"maxTime"</span></span>: <span class="hljs-number"><span class="hljs-number">1536494400000</span></span>                       }               ]       },       <span class="hljs-attr"><span class="hljs-attr">"version"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span> }</code> </pre> <br>  рдкреНрд░реЛрдореЗрдерд┐рдпрд╕ рдореЗрдВ рд╕реАрд▓ рдЙрд╕ рд╕рдордп рд╕реЗ рдмрдВрдзреЗ рд╣реИрдВ рдЬрдм рдПрдХ рд╣реЗрдб рдмреНрд▓реЙрдХ рдбрд┐рд╕реНрдХ рдореЗрдВ рдкреНрд░рд╡рд╛рд╣рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред  рдЗрд╕ рдмрд┐рдВрджреБ рдкрд░, рдРрд╕реЗ рдХрдИ рдСрдкрд░реЗрд╢рди рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред <br><br><img src="https://habrastorage.org/webt/ux/a4/85/uxa485qrm1zltefalsn54euc0ei.png"><br><br>  рдЬрд╛рд╣рд┐рд░рд╛ рддреМрд░ рдкрд░, рд╕реАрд▓ рдХрд┐рд╕реА рднреА рддрд░рд╣ рд╕реЗ рдЕрд╕реАрдорд┐рдд рд╣реИрдВ рдФрд░ рдмрдбрд╝реА рдбрд┐рд╕реНрдХ I / O рдХреВрджрддрд╛ рд╣реИред <br><br><img src="https://habrastorage.org/webt/kw/bt/ty/kwbttykmjwhoopodhlsl5mbm0-i.png"><br><br>  рд╕реАрдкреАрдпреВ рдбрд╛рдЙрдирд▓реЛрдб рд╕реНрдкрд╛рдЗрдХреНрд╕ <br><br><img src="https://habrastorage.org/webt/zk/ls/x2/zklsx2x0txpjym_defuhn0qkoqi.png"><br><br>  рдмреЗрд╢рдХ, рдпрд╣ рд╕рд┐рд╕реНрдЯрдо рдХреА рдЧрддрд┐ рдХреЛ рдирдХрд╛рд░рд╛рддреНрдордХ рд░реВрдк рд╕реЗ рдкреНрд░рднрд╛рд╡рд┐рдд рдХрд░рддрд╛ рд╣реИ, рдФрд░ рдПрд▓рдПрд╕рдПрдо-рднрдВрдбрд╛рд░рдг рдХреЗ рд▓рд┐рдП рднреА рдПрдХ рдЧрдВрднреАрд░ рдЪреБрдиреМрддреА рд╣реИ: рдЙрдЪреНрдЪ рдХреНрд╡реЗрд░реА рдЧрддрд┐ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реАрд▓ рдХреИрд╕реЗ рдХрд░реЗрдВ рдФрд░ рдмрд╣реБрдд рдЕрдзрд┐рдХ рдЙрдкрд░рд┐ рдХрд╛ рдХрд╛рд░рдг рди рдмрдиреЗрдВ? <br><br>  рд╕рдВрдХрд▓рди рдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдВ рдореЗрдореЛрд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рднреА рдХрд╛рдлреА рджрд┐рд▓рдЪрд╕реНрдк рд▓рдЧрддрд╛ рд╣реИред <br><br><img src="https://habrastorage.org/webt/vb/bn/ei/vbbneip1p05brkhxasvmglr6-ts.png"><br><br>  рд╣рдо рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдХреИрд╕реЗ рд╕рдВрдШрдирди рдХреЗ рдмрд╛рдж, рдЕрдзрд┐рдХрд╛рдВрд╢ рдореЗрдореЛрд░реА рдХреИрд╢реНрдб рд╕реЗ рдлреНрд░реА рдореЗрдВ рдмрджрд▓ рдЬрд╛рддреА рд╣реИ: рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рд╕рдВрднрд╛рд╡рд┐рдд рд░реВрдк рд╕реЗ рдореВрд▓реНрдпрд╡рд╛рди рдЬрд╛рдирдХрд╛рд░реА рд╡рд╣рд╛рдВ рд╕реЗ рд╣рдЯрд╛ рджреА рдЧрдИ рдереАред  рдпрд╣ рдЙрддреНрд╕реБрдХ рд╣реИ рдХрд┐ рдХреНрдпрд╛ <code>fadvice()</code> рдпрд╛ рдХреБрдЫ рдЕрдиреНрдп рдиреНрдпреВрдирддрдо рддрдХрдиреАрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдпрд╣рд╛рдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдпрд╛ рдХреНрдпрд╛ рдпрд╣ рдЗрд╕ рддрдереНрдп рдХреЗ рдХрд╛рд░рдг рд╣реИ рдХрд┐ рд╕рдВрдШрдирди рдХреЗ рджреМрд░рд╛рди рдирд╖реНрдЯ рдХрд┐рдП рдЧрдП рдмреНрд▓реЙрдХреЛрдВ рд╕реЗ рдХреИрд╢ рдХреЛ рдореБрдХреНрдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛? <br><br><h3>  рдХреНрд░реИрд╢ рд░рд┐рдХрд╡рд░реА </h3><br>  рдЖрдкрджрд╛ рд╡рд╕реВрд▓реА рдореЗрдВ рд╕рдордп рд▓рдЧрддрд╛ рд╣реИ, рдФрд░ рдпрд╣ рдЙрдЪрд┐рдд рд╣реИред  рдкреНрд░рддрд┐ рд╕реЗрдХрдВрдб рдПрдХ рдорд┐рд▓рд┐рдпрди рд░рд┐рдХреЙрд░реНрдб рдХреА рдЖрдиреЗ рд╡рд╛рд▓реА рдзрд╛рд░рд╛ рдХреЗ рд▓рд┐рдП, рдореБрдЭреЗ рд▓рдЧрднрдЧ 25 рдорд┐рдирдЯ рдЗрдВрддрдЬрд╛рд░ рдХрд░рдирд╛ рдкрдбрд╝рд╛, рдЬрдмрдХрд┐ рд╡рд╕реВрд▓реА рдХреЛ рдПрд╕рдПрд╕рдбреА-рдбреНрд░рд╛рдЗрд╡ рдХреЛ рдзреНрдпрд╛рди рдореЗрдВ рд░рдЦрддреЗ рд╣реБрдП рдкреНрд░рджрд░реНрд╢рди рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред <br><br><pre> <code class="plaintext hljs">level=info ts=2018-09-13T13:38:14.09650965Z caller=main.go:222 msg="Starting Prometheus" version="(version=2.3.2, branch=v2.3.2, revision=71af5e29e815795e9dd14742ee7725682fa14b7b)" level=info ts=2018-09-13T13:38:14.096599879Z caller=main.go:223 build_context="(go=go1.10.1, user=Jenkins, date=20180725-08:58:13OURCE)" level=info ts=2018-09-13T13:38:14.096624109Z caller=main.go:224 host_details="(Linux 4.15.0-32-generic #35-Ubuntu SMP Fri Aug 10 17:58:07 UTC 2018 x86_64 1bee9e9b78cf (none))" level=info ts=2018-09-13T13:38:14.096641396Z caller=main.go:225 fd_limits="(soft=1048576, hard=1048576)" level=info ts=2018-09-13T13:38:14.097715256Z caller=web.go:415 component=web msg="Start listening for connections" address=:9090 level=info ts=2018-09-13T13:38:14.097400393Z caller=main.go:533 msg="Starting TSDB ..." level=info ts=2018-09-13T13:38:14.098718401Z caller=repair.go:39 component=tsdb msg="found healthy block" mint=1536530400000 maxt=1536537600000 ulid=01CQ0FW3ME8Q5W2AN5F9CB7R0R level=info ts=2018-09-13T13:38:14.100315658Z caller=web.go:467 component=web msg="router prefix" prefix=/prometheus level=info ts=2018-09-13T13:38:14.101793727Z caller=repair.go:39 component=tsdb msg="found healthy block" mint=1536732000000 maxt=1536753600000 ulid=01CQ78486TNX5QZTBF049PQHSM level=info ts=2018-09-13T13:38:14.102267346Z caller=repair.go:39 component=tsdb msg="found healthy block" mint=1536537600000 maxt=1536732000000 ulid=01CQ78DE7HSQK0C0F5AZ46YGF0 level=info ts=2018-09-13T13:38:14.102660295Z caller=repair.go:39 component=tsdb msg="found healthy block" mint=1536775200000 maxt=1536782400000 ulid=01CQ7SAT4RM21Y0PT5GNSS146Q level=info ts=2018-09-13T13:38:14.103075885Z caller=repair.go:39 component=tsdb msg="found healthy block" mint=1536753600000 maxt=1536775200000 ulid=01CQ7SV8WJ3C2W5S3RTAHC2GHB level=error ts=2018-09-13T14:05:18.208469169Z caller=wal.go:275 component=tsdb msg="WAL corruption detected; truncating" err="unexpected CRC32 checksum d0465484, want 0" file=/opt/prometheus/data/.prom2-data/wal/007357 pos=15504363 level=info ts=2018-09-13T14:05:19.471459777Z caller=main.go:543 msg="TSDB started" level=info ts=2018-09-13T14:05:19.471604598Z caller=main.go:603 msg="Loading configuration file" filename=/etc/prometheus.yml level=info ts=2018-09-13T14:05:19.499156711Z caller=main.go:629 msg="Completed loading of configuration file" filename=/etc/prometheus.yml level=info ts=2018-09-13T14:05:19.499228186Z caller=main.go:502 msg="Server is ready to receive web requests."</code> </pre> <br>  рд░рд┐рдХрд╡рд░реА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреА рдореБрдЦреНрдп рд╕рдорд╕реНрдпрд╛ рдЙрдЪреНрдЪ рдореЗрдореЛрд░реА рдЦрдкрдд рд╣реИред  рдЗрд╕ рддрдереНрдп рдХреЗ рдмрд╛рд╡рдЬреВрдж рдХрд┐ рд╕рд╛рдорд╛рдиреНрдп рд╕реНрдерд┐рддрд┐ рдореЗрдВ рд╕рд░реНрд╡рд░ рд╕рдорд╛рди рдорд╛рддреНрд░рд╛ рдореЗрдВ рдореЗрдореЛрд░реА рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рдЬрдм рдпрд╣ рдХреНрд░реИрд╢ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдпрд╣ рдУрдУрдПрдо рдХреЗ рдХрд╛рд░рдг рдирд╣реАрдВ рдмрдврд╝ рд╕рдХрддрд╛ рд╣реИред  рдПрдХрдорд╛рддреНрд░ рд╕рдорд╛рдзрд╛рди рдЬреЛ рдореБрдЭреЗ рдорд┐рд▓рд╛ рд╡рд╣ рдерд╛ рдбреЗрдЯрд╛ рд╕рдВрдЧреНрд░рд╣ рдХреЛ рдЕрдХреНрд╖рдо рдХрд░рдирд╛, рд╕рд░реНрд╡рд░ рдХреЛ рдКрдкрд░ рдЙрдард╛рдирд╛, рдЗрд╕реЗ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рд╕рдВрдЧреНрд░рд╣ рдХреЗ рд╕рд╛рде рдкреБрдирд░реНрдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдФрд░ рд░рд┐рдмреВрдЯ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдирд╛ред <br><br><h3>  рд╡рд╛рд░реНрдо рдЕрдк рдХрд░реЗрдВ </h3><br>  рдПрдХ рдФрд░ рд╡реНрдпрд╡рд╣рд╛рд░ рдЬрд┐рд╕реЗ рд╡рд╛рд░реНрдо-рдЕрдк рдХреЗ рджреМрд░рд╛рди рдпрд╛рдж рд░рдЦрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП, рд╡рд╣ рд╢реБрд░реБрдЖрдд рдХреЗ рддреБрд░рдВрдд рдмрд╛рдж рдХрдо рдЙрддреНрдкрд╛рджрдХрддрд╛ рдФрд░ рдЙрдЪреНрдЪ рд╕рдВрд╕рд╛рдзрди рдЦрдкрдд рдХрд╛ рдЕрдиреБрдкрд╛рдд рд╣реИред  рдХреБрдЫ рдХреЗ рджреМрд░рд╛рди, рд▓реЗрдХрд┐рди рд╕рднреА рд╢реБрд░реВ рдирд╣реАрдВ рд╣реЛрддреЗ рд╣реИрдВ, рдореИрдВрдиреЗ рд╕реАрдкреАрдпреВ рдФрд░ рдореЗрдореЛрд░реА рдкрд░ рдПрдХ рдЧрдВрднреАрд░ рднрд╛рд░ рджреЗрдЦрд╛ред <br><br><img src="https://habrastorage.org/webt/kj/lr/2d/kjlr2dlj8mqn0od1dvwlu5sxxdu.png"><br><br><img src="https://habrastorage.org/webt/k_/ua/-y/k_ua-yqqzwh9elxbcoceu6tsrry.png"><br><br>  рдореЗрдореЛрд░реА рд▓реИрдкреНрд╕ рд╕рдВрдХреЗрдд рджреЗрддреЗ рд╣реИрдВ рдХрд┐ рдкреНрд░реЛрдореЗрдерд┐рдпрд╕ рдкреНрд░рд╛рд░рдВрдн рд╕реЗ рд╕рднреА рд╢реБрд▓реНрдХреЛрдВ рдХреЛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдирд╣реАрдВ рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рдФрд░ рдХреБрдЫ рдЬрд╛рдирдХрд╛рд░реА рдЦреЛ рдЬрд╛рддреА рд╣реИред <br><br>  рдореБрдЭреЗ рдкреНрд░реЛрд╕реЗрд╕рд░ рдФрд░ рдореЗрдореЛрд░реА рдкрд░ рдЙрдЪреНрдЪ рднрд╛рд░ рдХреЗ рд╕рдЯреАрдХ рдХрд╛рд░рдгреЛрдВ рдХрд╛ рдкрддрд╛ рдирд╣реАрдВ рдЪрд▓рд╛ред  рдореБрдЭреЗ рд╕рдВрджреЗрд╣ рд╣реИ рдХрд┐ рдпрд╣ рдПрдХ рдЙрдЪреНрдЪ рдЖрд╡реГрддреНрддрд┐ рдХреЗ рд╕рд╛рде рд╣реЗрдб рдмреНрд▓реЙрдХ рдореЗрдВ рдирдИ рд╕рдордп рд╢реНрд░реГрдВрдЦрд▓рд╛ рдХреЗ рдирд┐рд░реНрдорд╛рдг рдХреЗ рдХрд╛рд░рдг рд╣реИред <br><br><h3>  рд╕реАрдкреАрдпреВ рд▓реЛрдб рд╕реНрдкрд╛рдЗрдХреНрд╕ </h3><br>  рдЬрд╡рд╛рдиреЛрдВ рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдЬреЛ рдПрдХ рдЙрдЪреНрдЪ I / O рд▓реЛрдб рдмрдирд╛рддреЗ рд╣реИрдВ, рдореИрдВрдиреЗ рд╣рд░ рджреЛ рдорд┐рдирдЯ рдореЗрдВ рдкреНрд░реЛрд╕реЗрд╕рд░ рдкрд░ рд▓реЛрдб рдореЗрдВ рдЧрдВрднреАрд░ рдЫрд▓рд╛рдВрдЧ рджреЗрдЦреАред  рдмрд░реНрд╕реНрдЯреНрд╕ рдПрдХ рдЙрдЪреНрдЪ рдЖрд╡рдХ рд╕реНрдЯреНрд░реАрдо рдХреЗ рд╕рд╛рде рд▓рдВрдмреЗ рд╕рдордп рддрдХ рд░рд╣рддрд╛ рд╣реИ рдФрд░ рдРрд╕рд╛ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рд╡реЗ рдЧреЛ рдХрдЪрд░рд╛ рдХрд▓реЗрдХреНрдЯрд░ рдХреЗ рдХрд╛рд░рдг рд╣реИрдВ, рдХрдо рд╕реЗ рдХрдо рдХреБрдЫ рдЧреБрдард▓реА рдкреВрд░реА рддрд░рд╣ рд╕реЗ рднрд░реА рд╣реБрдИ рд╣реИрдВред <br><br><img src="https://habrastorage.org/webt/uv/jp/os/uvjposyjmeulwwpvafsdqw_dn20.png"><br><br><img src="https://habrastorage.org/webt/rd/pp/se/rdppsepllvvc85uijh14zwzbsqc.png"><br><br>  рдпреЗ рдЫрд▓рд╛рдВрдЧ рдЗрддрдиреА рддреБрдЪреНрдЫ рдирд╣реАрдВ рд╣реИред  рдРрд╕рд╛ рдкреНрд░рддреАрдд рд╣реЛрддрд╛ рд╣реИ рдХрд┐ рдЬрдм рд╡реЗ рд╣реЛрддреЗ рд╣реИрдВ, рддреЛ рдЖрдВрддрд░рд┐рдХ рдкреНрд░рд╡реЗрд╢ рдмрд┐рдВрджреБ рдФрд░ рдкреНрд░реЛрдореЗрдерд┐рдпрд╕ рдореИрдЯреНрд░рд┐рдХреНрд╕ рдЕрдкреНрд░рд╛рдкреНрдп рд╣реЛ рдЬрд╛рддреЗ рд╣реИрдВ, рдЬреЛ рдПрдХ рд╣реА рд╕рдордп рдЕрдВрддрд░рд╛рд▓ рдкрд░ рдбреЗрдЯрд╛ рдЕрдВрддрд░рд╛рд▓ рдХрд╛ рдХрд╛рд░рдг рдмрдирддрд╛ рд╣реИред <br><br><img src="https://habrastorage.org/webt/_h/aw/cn/_hawcnvkbwin1kzi8opatkmgbku.png"><br><br>  рдЖрдк рдпрд╣ рднреА рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдкреНрд░реЛрдореЗрдерд┐рдпрд╕ рдирд┐рд░реНрдпрд╛рддрдХ рдПрдХ рд╕реЗрдХрдВрдб рдХреЗ рд▓рд┐рдП рдмрдВрдж рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред <br><br><img src="https://habrastorage.org/webt/i7/5s/3g/i75s3g5_1bemugg59bgcuiiv-xq.png"><br><br>  рд╣рдо рдХрдЪрд░рд╛ рд╕рдВрдЧреНрд░рд╣ (рдЬреАрд╕реА) рдХреЗ рд╕рд╛рде рд╕рд╣рд╕рдВрдмрдВрдз рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВред <br><br><img src="https://habrastorage.org/webt/vx/sn/_y/vxsn_ykevsbir37pexcvjunszn8.png"><br><br><h3>  рдирд┐рд╖реНрдХрд░реНрд╖ </h3><br>  рдкреНрд░реЛрдореЗрдерд┐рдпрд╕ 2 рдореЗрдВ рдЯреАрдПрд╕рдбреАрдмреА рддреЗрдЬ рд╣реИ, рдХрд╛рдлреА рд╕рдВрдпрдорд┐рдд рд╣рд╛рд░реНрдбрд╡реЗрдпрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд▓рд╛рдЦреЛрдВ рд░рд┐рдХреЙрд░реНрдбрд┐рдВрдЧ рдХреЗ рд╕рд╛рде-рд╕рд╛рде рд▓рд╛рдЦреЛрдВ рд╕рдордп рдХреА рд╢реНрд░реГрдВрдЦрд▓рд╛ рдХреЛ рд╕рдВрднрд╛рд▓рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реИред  рд╕реАрдкреАрдпреВ рдФрд░ рдбрд┐рд╕реНрдХ I / O рдХрд╛ рдЙрдкрдпреЛрдЧ рднреА рдкреНрд░рднрд╛рд╡рд╢рд╛рд▓реА рд╣реИред  рдореЗрд░рд╛ рдЙрджрд╛рд╣рд░рдг рдкреНрд░рддрд┐ рд╕реЗрдХрдВрдб 200,000 рдореАрдЯреНрд░рд┐рдХ рдкреНрд░рддрд┐ рдХреЛрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рджрд┐рдЦрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИред <br><br>  рд╡рд┐рд╕реНрддрд╛рд░ рдХреА рдпреЛрдЬрдирд╛ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ рдкрд░реНрдпрд╛рдкреНрдд рдореЗрдореЛрд░реА рд╡реЙрд▓реНрдпреВрдо рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдпрд╛рдж рд░рдЦрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдФрд░ рдпрд╣ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдореЗрдореЛрд░реА рд╣реЛрдиреА рдЪрд╛рд╣рд┐рдПред  рдЙрдкрдпреЛрдЧ рдХреА рдЧрдИ рдореЗрдореЛрд░реА рдХреА рдорд╛рддреНрд░рд╛ рдЬреЛ рдореИрдВрдиреЗ рджреЗрдЦреА, рд╡рд╣ рдЖрдиреЗ рд╡рд╛рд▓реА рдзрд╛рд░рд╛ рдХреЗ рдкреНрд░рддрд┐ рд╕реЗрдХрдВрдб 5 рдЬреАрдмреА рдкреНрд░рддрд┐ 100,000 рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпреЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдереА, рдЬреЛ рдСрдкрд░реЗрдЯрд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдо рдХреИрд╢ рдХреЗ рд╕рд╛рде 8 рдЬреАрдмреА рдХреЗ рдХрдмреНрдЬреЗ рд╡рд╛рд▓реА рдореЗрдореЛрд░реА рдХреЗ рд╕рд╛рде рд╕рдВрдпреБрдХреНрдд рдереАред <br><br>  рдмреЗрд╢рдХ, рд╕реАрдкреАрдпреВ рдФрд░ рдбрд┐рд╕реНрдХ I / O рдХреЗ рдлрдЯрдиреЗ рдХреЛ рд░реЛрдХрдиреЗ рдХреЗ рд▓рд┐рдП рдЕрднреА рднреА рдмрд╣реБрдд рдХрд╛рдо рд╣реИ, рдФрд░ рдпрд╣ рдЖрд╢реНрдЪрд░реНрдпрдЬрдирдХ рдирд╣реАрдВ рд╣реИ рдХрд┐ рдЯреАрдПрд╕рдбреАрдмреА рдкреНрд░реЛрдорд┐рдерд┐рдпрд╕ 2 рдХреЛ рдЗрдиреЛрд╡реАрдбреА, рддреЛрдХреБрдбрдмрдбреА, рд░реЙрдХреНрд╕рдбреАрдмреА, рд╡рд┐рдВрдЯрд░рдЯрд╛рдЗрдЧрд░ рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рдпреБрд╡рд╛ рдХреИрд╕реЗ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдЬреАрд╡рди рдЪрдХреНрд░ рдХреА рд╢реБрд░реБрдЖрдд рдореЗрдВ рдЙрдиреНрд╣реЗрдВ рд╕рдорд╛рди рд╕рдорд╕реНрдпрд╛рдПрдВ рдереАрдВред </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/hi445370/">https://habr.com/ru/post/hi445370/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi445358/index.html">рдПрдХрддрд╛ рдореЗрдВ рдШрдЯрдирд╛ рдкреНрд░рдгрд╛рд▓реА рдХрд╛ рд╕рдВрдЧрдарди - рдПрдХ рдЧреЗрдо рдбрд┐рдЬрд╛рдЗрдирд░ рдХреА рдЖрдВрдЦреЛрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ</a></li>
<li><a href="../hi445360/index.html">рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд╕рд╛рдХреНрд╖рд╛рддреНрдХрд╛рд░ рдХреЗ рд▓рд┐рдП 5 рд╡рд┐рд╢рд┐рд╖реНрдЯ рдХрд╛рд░реНрдп: рдкрд╛рд░реНрд╕рд┐рдВрдЧ рдФрд░ рд╕рдорд╛рдзрд╛рди</a></li>
<li><a href="../hi445362/index.html">рдкреБрд╕реНрддрдХ "рд╡рд┐рддрд░рд┐рдд рдкреНрд░рдгрд╛рд▓реАред рдбрд┐рдЬрд╛рдЗрди рдкреИрдЯрд░реНрди</a></li>
<li><a href="../hi445366/index.html">SIMD рдмреНрд▓реЙрдХ рдХреЗ рдХрд╛рд░рдг рдмреИрдХрд▓-рдЯреА 1 рдкреНрд░реЛрд╕реЗрд╕рд░ рдкрд░ GOST 28147-89 рдХреЗ рдЕрдиреБрд╕рд╛рд░ рдПрдиреНрдХреНрд░рд┐рдкреНрд╢рди рдХреЛ рдХреИрд╕реЗ рддреЗрдЬ рдХрд░реЗрдВ</a></li>
<li><a href="../hi445368/index.html">рд╣рдЬрд╛рд░реЛрдВ рдЖрднрд╛рд╕реА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЗ рдПрдХ рдЬреЛрдбрд╝реЗ рдХреЗ рд╕рд╛рде рдПрдХ рдЦреЗрд▓ рдХрд╛ рдкрд░реАрдХреНрд╖рдг рд▓реЛрдб рдХрд░реЗрдВ</a></li>
<li><a href="../hi445372/index.html">рдорд╢реАрди рд╡рд┐рдЬрди рдмрдирд╛рдо рдорд╛рдирд╡ рдЕрдВрддрд░реНрдЬреНрдЮрд╛рди: рдСрдмреНрдЬреЗрдХреНрдЯ рдорд╛рдиреНрдпрддрд╛ рдХрд╛рд░реНрдпрдХреНрд░рдореЛрдВ рдХреЗ рд╕рдВрдЪрд╛рд▓рди рдХреЛ рдмрд╛рдзрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрд▓реНрдЧреЛрд░рд┐рджрдо</a></li>
<li><a href="../hi445378/index.html">рд▓реЗрдмрд┐рд░рд┐рдВрде: рд╡рд░реНрдЧреАрдХрд░рдг, рдкреАрдврд╝реА, рд╕рдорд╛рдзрд╛рди рдХреА рдЦреЛрдЬ</a></li>
<li><a href="../hi445380/index.html">рдЖрдзреБрдирд┐рдХ PHP рд╕реБрдВрджрд░ рдФрд░ рдЙрддреНрдкрд╛рджрдХ рд╣реИ</a></li>
<li><a href="../hi445384/index.html">рдЪрд╛рдВрдЧ'рдИ -4 рдорд┐рд╢рди - рд▓реИрдВрдбрд┐рдВрдЧ рдореЙрдбреНрдпреВрд▓ рдФрд░ рдкреБрдирд░рд╛рд╡рд░реНрддрдХ рдЙрдкрдЧреНрд░рд╣ рдкрд░ рд╡реИрдЬреНрдЮрд╛рдирд┐рдХ рдЙрдкрдХрд░рдг</a></li>
<li><a href="../hi445390/index.html">рдПрдХ рд╕рд╛рдорд╛рдиреНрдп рд╡реНрдпрдХреНрддрд┐ рдХреА рдЖрдИрдбреАрдИ рдпрд╛ рд╣рдордиреЗ рдореЛрдирд╛рдХреЛ рдХреЛ рдХреНрдпреЛрдВ рдЪреБрдирд╛</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>