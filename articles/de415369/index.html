<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👍🏻 🌹 🚑 Refactoring Preis 🥫 🃏 🕐</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Subjektiv: Refactoring ist eine jugendliche „Krankheit“. Nach persönlichen Beobachtungen beginnt irgendwo nach 26 Jahren loszulassen. Wie in diesem al...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Refactoring Preis</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/415369/"><p></p><div style="text-align:center;"><img src="https://habrastorage.org/webt/2g/am/9h/2gam9hcz7vw9kp-513utyr0ezum.png" height="500"></div>  Subjektiv: Refactoring ist eine jugendliche „Krankheit“.  Nach persönlichen Beobachtungen beginnt irgendwo nach 26 Jahren loszulassen.  Wie in diesem alten Satz: "Wer in seiner Jugend kein Revolutionär war - er hat kein Herz, wer in seiner Reife nicht konservativ wird - er hat keinen Verstand."  Bis ich endlich loslasse, werde ich daher versuchen, die Refactoring-Benutzerfälle und mögliche Ziele zu beschreiben, die damit erreicht werden können. <a name="habracut"></a><br><h2 id="vdohnoviteli">  Inspiratoren </h2><br><p> Ich begann nach dem nächsten Anzeigen der Pull-Anfrage für mehr als 150 Dateien zu schreiben, wobei neue Funktionen und das Refactoring der vorhandenen Dateien sehr wichtig waren.  Refactoring war nicht nur kosmetisch, sondern auch logisch, was den größten Schmerz verursachte.  In Ruby wurde beispielsweise <code>amount == 0</code> fett durch <code>amount.zero?</code>  ohne zu berücksichtigen, dass diese Konstruktionen für den Fall der <code>nil</code> nicht äquivalent sind.  All dies wurde ungefähr wie folgt erklärt: "Aber laut Code wird der Standard so angenommen!"  Auf die logische Frage "Was ist der Zweck, dem Code zum Standard zu folgen und was ist Ihr Ziel als Entwickler im Allgemeinen?"  Der Mann schloss sich ein und wiederholte ein wenig schuldig "aber nach dem Code-Standard muss man so schreiben ..." und sah aus wie eine Blondine in einem Bekleidungsgeschäft, das das Verlangen nicht bewältigen konnte <del>  Refactor </del>  alles kaufen. </p><br><h2 id="opredelenie">  Definition </h2><br><p>  Das Thema ist sensibel, daher müssen Sie der Frage "Wer ist wer?" Besondere Aufmerksamkeit widmen.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Laut Wiki</a> ist Refactoring ein Prozess zur Änderung der internen Struktur eines Programms, der <u>sich nicht auf sein externes Verhalten auswirkt</u> und das Verständnis seiner Arbeit erleichtern soll. </p><br><p>  Ich für meinen Teil möchte die Grenzen eingrenzen und Refactoring (im schlimmsten Sinne des Wortes) als alle Änderungen definieren, die nicht direkt mit dem zu lösenden Problem zusammenhängen und das externe Verhalten des Systems nicht ändern, sondern als Teil der ursprünglichen Aufgabe ausgeführt werden. </p><br><p>  Das heißt, ich möchte nicht über die geplante Änderung der Codebasis sprechen, für die der Arbeitsumfang umrissen und spezifische Ziele festgelegt wurden, sondern über die spontanen Änderungen, die während der Entwicklung auftreten. </p><br><h2 id="cennost-produkta">  Produktwert </h2><br><p>  Jetzt fange ich von weitem an.  Der Quellcode ist weder ein Ziel noch ein Wert.  Natürlich kann es ästhetisch oder künstlerisch von Interesse sein, aber dies sind Ausnahmen.  Im Allgemeinen ist Code ein Werkzeug zum Erstellen eines Softwareprodukts, das von jedem verwendet wird.  Für den Anfang wäre es daher gut, die Werte im Produkt zu bestimmen. </p><br><h3 id="pryamye-cennosti-produkta">  Direkte Produktwerte </h3><br><p>  Hier ist alles einfach.  Sie verwenden das Produkt, so dass direkte Werte das sind, was der Benutzer klar fühlt / sieht / fühlt.  Nämlich: </p><br><ol><li>  alle Arten von Produktfunktionen; </li><li>  Benutzerfreundlichkeit (UI / UX, Leistung, Fehlertoleranz usw.). </li></ol><br><p>  Der zweite Punkt kann zu Diskussionen führen.  Schließlich glauben viele, dass dies nicht die Hauptsache ist.  Wenn die Funktionalität gut ist, spielt es keine Rolle, in was sie eingewickelt ist.  Gute Beispiele für Funktionen ohne vernünftige UI / UX: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Redmine</a> und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">SAP</a> .  Ich bin jedoch mit diesem Blick nicht einverstanden und denke näher an Genosse <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Alan Cooper</a> und sein "Psychiatrisches Krankenhaus in den Händen von Patienten". </p><br><h3 id="kosvennye-cennosti-produkta">  Indirekte Produktwerte </h3><br><p>  Dies sind Werte, die an sich keinen Einfluss auf den Benutzer haben.  Sie können jedoch „schießen“ oder „akkumulieren“ und Auswirkungen (unterschiedlicher Schwere) auf das Produkt oder seine Funktionalität haben. </p><br><ol><li>  Bugs.  Ein Grenzfall von Werten.  Sie sind sekundär, weil die Werte selbst nicht tragen, sondern von benachbarten Merkmalen stammen. </li><li>  Sauberkeit.  Hier geht es um Lesbarkeit, Modularität, Minimierung eingehender Komponenten, Standardisierung und Vereinheitlichung von Schnittstellen usw. </li><li>  Dokumentation  Hier geht es um Code und Erklärungen für Entwickler, nicht um Geschäftsbeschreibungen oder Benutzerkonten.  Der Satz eines fröhlichen Bauern aus einem der Interviews zeigt dies gut: "Die Logik in der Datenbank ist wie ein Buch geschrieben." </li><li>  Skalierbarkeit / Sicherheit / Sicherheit.  Der Benutzer sieht sie erst, wenn etwas Schlimmes passiert. </li></ol><br><h3 id="cennosti-dlya-razrabotchika">  Entwicklerwerte </h3><br><p>  Eine sehr wichtige Kategorie, die viele übersehen, die aber immer das Ergebnis beeinflusst. </p><br><ol><li>  Standardmäßig Code. </li><li>  Einrückung auf Feng Shui. </li><li>  Andere Transaktionen mit Gewissen.  Immerhin wurde der Code geschrieben, so dass es ein Ergebnis für den Tag gibt, und daher gibt es einen Vorteil. </li><li>  Übereinstimmung des Codes mit der inneren Welt. </li></ol><br><p>  Aber seien wir ehrlich.  Bei all dem geht es nicht um die Werte, die mit dem Produkt und dem Endbenutzer verbunden sind.  Hier geht es um Psychologie und persönliche Kakerlaken. </p><br><h2 id="vzglyad-so-storony-biznesa">  Blick von der Seite des Geschäfts </h2><br><p>  Der Vollständigkeit halber müsste man dies alles von der Seite des Geschäfts betrachten und nicht von einem Softwareprodukt.  In diesem Fall wird die Aufteilung in direkte und indirekte Werte ziemlich banal: direkt - bringen Sie offensichtlich Geld und Sie können eine eindeutige quantitative Bewertung abgeben;  indirekt - sie bringen kein Geld und / oder es ist sehr schwer zu quantifizieren;  Werte für den Entwickler bringen kein Geld in irgendeiner Form (vielleicht sogar wegnehmen). </p><br><p>  Zum Beispiel. </p><br><ul><li>  Eine neue Funktion mit OAuth-Schrauben erhöhte die Anzahl der Registrierungen um 10% und wir erhielten + 1k $. </li><li>  Wir haben das Abrechnungsmodul basierend auf dem Einzelverantwortungsmuster in mehrere unabhängige Teile unterteilt.  Es scheint einfacher zu warten, aber es war nicht möglich zu messen. </li><li>  Wir haben die Codebasis an den Codestandard angepasst und ... nichts erhalten. </li></ul><br><p>  Es ist erwähnenswert, dass nach den obigen Schätzungen die Beine bei der geliebten Geschäftsbeschleunigung, der allgemeinen Eile und der Zurückhaltung wachsen, Zeit für etwas anderes als Funktionalität und möglicherweise einen Bugfix aufzuwenden.  In der Tat können direkte Werte geschätzt und "verkauft" werden, und indirekte sind sehr schwierig oder unmöglich.  Und es stellt sich heraus, dass indirekte Werte entweder aufgrund eines technischen Hintergrunds realisiert oder auf einer intuitiven Ebene verstanden oder als "wertlos" verworfen werden. </p><br><p>  Fairerweise müssen wir hier an das Konzept des Enablers erinnern, das den Weg für die Implementierung der gewünschten Funktion "ebnet", aber für den Benutzer keinen offensichtlichen Gewinn bringt.  Aber das ist eine andere Geschichte. </p><br><h2 id="prichyom-tut-refaktoring">  Und was ist mit Refactoring? </h2><br><p>  Zumindest trotz der Tatsache, dass er nur die indirekten Werte des Produkts beeinflussen kann.  Daher wird sich der Benutzer durch ein Refactoring nicht besser fühlen. </p><br><p>  Es ist auch wichtig, sich an die Entropie zu erinnern.  Refactoring minimiert es immer.  Um die Entropie zu reduzieren, benötigen Sie im Idealfall ein Team von Architekten, die die Entropie in der Entwurfsphase minimieren.  Um ein Stück aus dem Mythical Man-Month zu zitieren: </p><br><blockquote>  Die Systemprogrammierung ist ein Prozess, der die Entropie reduziert und daher eine Metastabilität aufweist.  Die Programmwartung ist ein Prozess, der die Entropie erhöht, und selbst die geschickteste Wartung verzögert nur, dass das System in eine hoffnungslose Veralterung gerät. </blockquote><p>  Wenn wir das Refactoring als Teil des Programmwartungsprozesses betrachten, gilt: Je weniger Refactor, desto länger lebt der Code ohne Umschreiben. </p><br><h2 id="kakie-celi-mogut-byt-u-refaktoringa">  Welche Ziele kann Refactoring haben? </h2><br><p>  Ich möchte Sie daran erinnern, dass es sich um eine spontane Änderung während der Implementierung von Funktionen handelt und nicht um die geplanten Änderungen.  In diesem Fall liegt die Definition des Ziels vollständig beim Entwickler.  Er muss sich die Hauptfrage „Warum?“ Stellen, sie beantworten und sich danach dem beabsichtigten Ziel nähern. </p><br><h3 id="za-entropiyu">  Für die Entropie! </h3><br><p>  Es ist schwer, es selbst zu tun.  Und die Überprüfung durchzuziehen ist im Allgemeinen unrealistisch.  Das Ziel ist sicherlich gut: den Brückenkopf für neue Errungenschaften freizumachen sowie die während der Produktunterstützung angesammelten Toxine und Toxine zu entfernen.  Es ist jedoch keine leichte Aufgabe, ein paar Module von Grund auf neu zu schaufeln, ohne dabei etwas zu verlieren.  Es sollte in Zusammenarbeit mit Geschäftsanalysten und Architekten gelöst werden, falls vorhanden.  So wenige Menschen riskieren dies auf freiwilliger Basis. </p><br><h3 id="za-dokumentaciyu">  Für die Dokumentation! </h3><br><p>  Es ist schon einfacher.  Benennen Sie Variablen / Funktionen nach dem Prinzip „Was ist auf der Box, dann in der Box?“ Umbenennen, vereinfachen Sie das Design aufgrund der Funktionen der Sprache und der Bibliotheken, fügen Sie Kommentare an nicht offensichtlichen Stellen hinzu usw.  Dies kann alleine und mit dem richtigen Ansatz sowohl für sich selbst als auch für benachbarte Kollegen gut gemacht werden. </p><br><h3 id="za-bystrodeystvie">  Für Geschwindigkeit! </h3><br><p>  Um ehrlich zu sein, sollte eine solche Arbeit als separate Aufgabe hervorgehoben werden.  Da entweder die aktuellen Funktionen des Systems für Sie ausreichen und Sie nichts tun müssen oder Sie genau wissen, was und wie viel Sie beschleunigen müssen. </p><br><p>  Alles fällt in diese Kategorie: von der harmlosen Korrektur von N + 1 bis zur ernsthaften Beschleunigung aufgrund von Änderungen in den Betriebsalgorithmen.  Das ganze Problem ist, dass die „Parität“ der Fehler immer schnell ist.  Hier ein Beispiel: In einer Transaktion werden Daten in der Datenbank gepusht und in derselben Transaktion wird eine Aufgabe in Sidekiq festgelegt.  Die Warteschlange von Sidekiq in Redis und die Transaktion gelten nicht für diese.  Wenn die Geschwindigkeit der Warteschlange zunimmt, wird die Aufgabe manchmal ausgeführt, bevor die Daten festgeschrieben werden.  Sie können sich die Konsequenzen und den Debug-Prozess selbst vorstellen. </p><br><h3 id="za-refaktoring">  Zum Refactoring! </h3><br><p>  Stellen Sie sich vor, Sie haben den Reinigungsservice für Wohnungen genutzt.  Sie kamen, begannen zu putzen, aber auf dem Weg dorthin bewegten sie alle Möbel in der Wohnung und umrissen die Vorhänge vom Wohnzimmer zur Badewanne mit dem Argument: „Unter solchen Bedingungen war die Putzfrau angenehmer, ihre Arbeit zu erledigen.“  Bild aus "WTF ?!"  Sie können es sich vorstellen. </p><br><p>  Ich hoffe, Sie verstehen, dass Sie nicht an sich selbst denken müssen, sondern daran, für wen Sie es tun. </p><br><h2 id="smirenie-i-prinyatie">  Demut und Akzeptanz </h2><br><p>  Zusammenfassend ist es notwendig, vor dem Refactoring ein „Handbuch“ zu geben, was zu tun ist.  Dies ist zwar keine TODO-Liste, sondern eine Liste von Fakten, mit denen Sie sich abfinden und entweder akzeptieren oder keine Maßnahmen ergreifen müssen. </p><br><ol><li>  Ich erhöhe die Anzahl der Fehler im Projekt und kann ein Tamburin dafür bekommen. </li><li>  Ich werde Eigentümer des überarbeiteten Codes und alle Fragen dazu werden zunächst an mich gesendet. </li><li>  Durch meine Handlungen produziere ich für den Endbenutzer nichts Wertvolles. </li></ol><br><p>  Eine kleine Erklärung. </p><br><ol><li>  Jede Änderung am Code hat eine Chance ungleich Null, einen Fehler zu generieren.  Und da diese Aktion nicht mit der ultimativen Funktionalität verbunden ist, erzeugen Sie einfach Fehler, ohne Kernwerte zu generieren.  Es ist gut, sich dessen bewusst zu sein und sich nicht als Schläuche auszugeben, wenn sie mit Fragen zu Ihnen kommen. </li><li>  Ausreden wie "vorheriges Anotieren" und dergleichen sind sehr miserabel, weil es im selben Github / Gitlab keine solche Funktion gibt.  Außerdem hat der vorherige Autor bestätigt, dass alles in seiner Konfiguration funktioniert, und er trägt keine Verantwortung für Ihre Änderungen und verliert einen Teil des Bildes von dem, was passiert.  Genauer gesagt, Sie nehmen es ihm zusammen mit der Verantwortung weg. </li><li>  Dem Benutzer ist das Refactoring wirklich egal, er interessiert sich für Stabilität und Funktionalität, und beim Refactoring geht es nicht darum. </li></ol><br><p>  Und noch einmal: Wenn Sie mit mindestens einem der Punkte nicht einverstanden sind, beginnen Sie nicht mit dem Refactoring.  Lesen Sie besser Habr, Lurk, trinken Sie Tee oder sprengen Sie im schlimmsten Fall das nächste Feature vom Armaturenbrett. </p><br><h2 id="konec">  Das Ende </h2><br><p>  Nicht streng beurteilen.  Wenn möglich, konstruktiv konstruieren.  Und denken Sie immer über den Zweck Ihrer Handlungen nach.  Vielen Dank. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de415369/">https://habr.com/ru/post/de415369/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de415359/index.html">PHP 8: Was erwartet Sie? Zeev Suraskys Brief</a></li>
<li><a href="../de415361/index.html">Firefox überprüft kompromittierte Passwörter mithilfe der k-Anonymisierungsmethode</a></li>
<li><a href="../de415363/index.html">Indien wird die Produktion von grüner Energie bis 2022 um 100 GW steigern</a></li>
<li><a href="../de415365/index.html">Lass uns gehen! Oder ein wenig über das Entwerfen einer Datumsauswahloberfläche</a></li>
<li><a href="../de415367/index.html">Was ist, wenn sich Außerirdische als Maschinen mit künstlicher Intelligenz herausstellen?</a></li>
<li><a href="../de415371/index.html">Kryptowährungs-Datenschutz</a></li>
<li><a href="../de415373/index.html">NumPy in Python. Teil 4</a></li>
<li><a href="../de415375/index.html">Versteckte Schafe und typografische Archäologie</a></li>
<li><a href="../de415377/index.html">So funktioniert JS: Klassen und Vererbung, Transpilation in Babel und TypeScript</a></li>
<li><a href="../de415381/index.html">Spielen Sie mit Kubernetes - Service für eine praktische Bekanntschaft mit K8s</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>