<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëå üö£üèø ü§æüèø Wir verbinden den Multiplayer mit dem in C ++ geschriebenen Handyspiel "Machen Sie W√∂rter aus W√∂rtern" auf iOS und Android üë®üèº‚Äç‚öïÔ∏è ‚ö™Ô∏è üç®</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Zuvor schrieb ich √ºber meine Erfahrungen bei der Entwicklung eines mobilen Wortspiels f√ºr Android und iOS, das sehr beliebt ist, und entschied mich, d...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Wir verbinden den Multiplayer mit dem in C ++ geschriebenen Handyspiel "Machen Sie W√∂rter aus W√∂rtern" auf iOS und Android</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/433172/">  Zuvor schrieb ich √ºber meine Erfahrungen bei der Entwicklung eines mobilen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Wortspiels</a> f√ºr Android und iOS, das sehr beliebt ist, und entschied mich, den Mehrspielermodus daran zu binden, wenn zwei Spieler untereinander gegeneinander antreten und nacheinander W√∂rter schreiben, als letzte Runde der Fernsehsendung von Sergey Suponev Stunde. " <br><br><img src="https://habrastorage.org/webt/kk/v7/fw/kkv7fwu9wif6l37aoqmyzcp3gjm.png"><br><br>  Ich habe anderthalb Monate gebraucht, um den Multiplayer zu studieren und zu implementieren. In dem Artikel werde ich versuchen, das Konzept ohne Beispiele f√ºr den Quellcode zu beschreiben, um die Menge der geleisteten Arbeit zu reduzieren. <br><a name="habracut"></a><br><h3>  Ein bisschen Geschichte </h3><br>  Die Anwendung wurde in C ++ mit dem Marmalade SDK geschrieben.  Seitdem hat der Anbieter die Unterst√ºtzung dieser Plattform eingestellt und die Sorten an die Japaner verkauft, und die Zukunft dieser Entwicklungsumgebung ist sehr vage geworden. <br><br><img src="https://habrastorage.org/webt/sa/c4/fy/sac4fyzpnydiynvhugn1fl8olww.jpeg"><br><br>  Es stellte sich die Frage, was aktuelle Projekte f√ºr ihre weitere Unterst√ºtzung portieren sollen. <br><br><h3>  Warum nicht cocos2d-x </h3><br><img src="https://habrastorage.org/webt/il/dh/fn/ildhfnxa9jhrtc31jiw-sf5b6zm.png"><br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Cocos2d-x</a> ist eine der h√§ufigsten plattform√ºbergreifenden C ++ - Entwicklungsmaschinen f√ºr mobile Spiele.  Anscheinend aufgrund seines kostenlosen und Open Source Codes.  Der Motor ist schlecht dokumentiert.  Die Beschreibung deckt den mageren Teil des Motors ab und der gr√∂√üte Teil des Materials ist l√§ngst veraltet. <br><br>  Basierend auf den Ergebnissen einer Periode gelang es mir immer noch, einen Prototyp meiner Anwendung zu erstellen.  Aber die Eindr√ºcke waren sehr schlecht: Es f√ºhlt sich an, als w√§re cocos2d-x auf dem Knie montiert.  Die Abstraktionsebenen Szene, Sprite, Anwendungsdelegierter schienen mir sehr unangenehm, und die Notwendigkeit, im Kokosnussforum nach Antworten auf Fragen zu suchen, f√ºhrt Sie zunehmend zu der Idee, dass Sie etwas falsch machen.  Wahrscheinlich wachsen meine H√§nde an der falschen Stelle. <br><br><h3>  Meine Wahl fiel auf SDL </h3><br><img src="https://habrastorage.org/webt/4q/a4/vf/4qa4vfo-qzvtxas0a6egqpqknjk.png"><br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">SDL</a> ist wie Marmalade SDL keine Engine, sondern eine Plattform.  Es bietet eine Low-Level-API, aus der ich dann f√ºr mich geeignete Abstraktionsebenen erstelle.  All dies ist in C geschrieben, der Quellcode ist offen. <br><br>  Kurz gesagt, die SDL ist eine kostenlose plattform√ºbergreifende Bibliothek f√ºr die Arbeit mit Grafiken, Sound und die Verarbeitung von Nachrichten des Betriebssystems.  Es ist sehr praktisch, ein Win32-Build zu erstellen und die Logik des Spiels unter Windows zu debuggen, sodass mobile Emulatoren und physische Ger√§te nur betriebssystemspezifische Funktionen debuggen. <br><br>  Gl√ºcklicherweise oder ungl√ºcklicherweise bietet die SDL keine Tools f√ºr eine so enge Aufgabe wie die Entwicklung eines Multiplayers f√ºr iOS und Android, sodass ich mich selbst in die entsprechenden Dienste integrieren musste. <br><br><h3>  Multithread-Anwendungsarchitektur </h3><br>  Die Logik der Anwendung und alle Arbeiten mit Grafiken sind im Hauptthread implementiert, der ein Nachrichtenverarbeitungszyklus ist und in der Hauptfunktion beginnt.  Nennen Sie diesen Stream SDL Thread.  Andere Threads wiederum werfen Ereignisse (SDL_PushEvent) zur Verarbeitung in die Warteschlange und lesen sie mit SDL_WaitEvent und SDL_PollEvent daraus.  Dies sind entweder vom System ausgel√∂ste Systemereignisse, deren Unterst√ºtzung bereits in SDL implementiert ist, oder Aufrufe von R√ºckrufen und Listenern, die wir bereits √ºber die SDL-Funktionalit√§t hinaus implementieren. <br><br><img src="https://habrastorage.org/webt/cr/li/-r/crli-rojztdxy1p7fhqhiqa0jru.png"><br><br>  Die gesamte Spielelogik ist in C ++ geschrieben.  Das Projektverzeichnis enth√§lt eine Reihe von * .cpp-Dateien, die in drei Gruppen unterteilt werden k√∂nnen: <br><br><ul><li>  plattform√ºbergreifend - die Dateien, die in der Zusammenstellung aller Plattformen enthalten sind (Spielelogik); </li><li>  Monoplattform, d.h.  sind in der Anwendung einer Plattform enthalten, um deren Funktionen zu implementieren. </li></ul><br>  Dementsprechend gibt es drei separate Verzeichnisse f√ºr das Design jeder Plattform: <br><br><ul><li>  proj.win32 - Projekt VS2017 Community Edition; </li><li>  proj.android - Android-Projekt mit Gradle; </li><li>  proj.ios - Xcode-Projekt f√ºr iOS. </li></ul><br><h3>  Integration mit Multiplayer-Diensten </h3><br>  Jetzt m√ºssen wir eine separate Schicht kleben, die f√ºr folgende Funktionen verantwortlich ist: <br><br><ul><li>  Suche nach einem Gegner, Verbindung zum Spiel; </li><li>  Nachrichten zwischen Rivalen; </li><li>  Verlassen Sie das Spielzimmer. </li><li>  Festlegen von Spielerpunkten in Bestenlisten. </li></ul><br>  Sowohl iOS- als auch Android-Plattformen unterst√ºtzen Echtzeit-Multiplayer (RTMP).  Bei Android integrieren wir Google Play Services (GPS), bei iOS Game Center.  Zuvor unterst√ºtzte Google die Integration mit iOS, entschied sich jedoch in diesem Jahr, die Integration aufzugeben. <br><br>  In diesem Artikel werde ich nicht die Aktionen beschreiben, die Sie in der Google Play Console und in AppStoreConnect ausf√ºhren m√ºssen, um den Multiplayer zu konfigurieren. Ich werde nicht die Spezifikation von Klassen und Integrationsmethoden beschreiben - all dies wird auf Websites von Anbietern beschrieben. <br><br>  Als n√§chstes werde ich kurz beschreiben, welche √Ñnderungen im Projekt f√ºr jede der Plattformen vorgenommen werden m√ºssen. <br><br><h4>  Android </h4><br>  Wie?  Ich habe das noch nicht gesagt?  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Android NDK wird</a> zum Kompilieren von C ++ - Code verwendet.  Wenn Sie ein Android-Entwickler sind, wissen Sie es bereits. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Die allgemeinen Anweisungen</a> zum Integrieren von Google Play Services in ein Android-Projekt sind auf der Website f√ºr Android-Entwickler beschrieben.  In meinem Projekt verwende ich die folgenden Abh√§ngigkeiten: <br><br><pre><code class="json hljs">implementation 'com.google.android.gms:play-services-games:<span class="hljs-number"><span class="hljs-number">16.0</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>' implementation 'com.google.android.gms:play-services-nearby:<span class="hljs-number"><span class="hljs-number">16.0</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>' implementation 'com.google.android.gms:play-services-auth:<span class="hljs-number"><span class="hljs-number">16.0</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span>'</code> </pre> <br>  Urspr√ºnglich bestand die Idee darin, eine <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">C ++ - API zu verwenden</a> , die in Form kompilierter statischer Bibliotheken ohne Quellen vorliegt.  Aufgrund der Tatsache, dass die Liste der Bibliotheken keine Assembly f√ºr die x86_64-Plattform enth√§lt, entschied ich, dass die Jungs von Google die Relevanz dieses SDK nicht wirklich √ºberwachen, und beschloss, <s>ihr Fahrrad</s> zu <s>erfinden</s> , um diese Ebene in Java zu schreiben, und es mit <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">JNI-</a> Wrappern zu verpacken.  Und warum brauche ich dann eine zus√§tzliche Abh√§ngigkeit in Form von Bibliotheken ohne Quellcode, die in Java immer noch Java ziehen?  Neben der Relevanz von Java-Klassen m√ºssen Sie auch die Relevanz dieser Bibliotheken √ºberwachen. <br><br>  Als Leitfaden habe ich ein gutes Beispiel aus <a href="">Google Samples verwendet</a> .  Vielen Dank an Google daf√ºr.  Apple, nimm ein Beispiel von Google! <br><br><h4>  iOS </h4><br>  Um sich in Game Center zu integrieren, m√ºssen Sie das GameKit-Framework verbinden.  Wir beschreiben die gesamte Integrationsschicht mit Game Center in einer * .m-Datei und stellen die Schnittstelle dazu √ºber eine separate * .h-Datei bereit.  Da C ++ eine Teilmenge der Ziel-C-Sprache ist, gibt es keine Probleme bei der Zusammenstellung von * .cpp- und * .m-Dateien in einem Projekt. <br><br>  Neben der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">offiziellen Dokumentation wurde er</a> von diesem Projekt geleitet: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">GameCenterManager</a> .  Es stimmt, einige Dinge aus dem Beispiel sind bereits veraltet. Xcode 10 wird Ihnen dies mitteilen und Sie werden die veraltete Funktionalit√§t durch die neue ersetzen. <br><br><h3>  Das Prinzip der Arbeit mit der Multiplayer-Ebene </h3><br><h4>  Einzelner Einstiegspunkt </h4><br>  Nachdem ich die Funktionen der Arbeit mit Multiplayer auf beiden Plattformen untersucht hatte, erstellte ich eine einzelne C ++ - Zusammenfassung f√ºr meine Anwendung, und zum Zeitpunkt der Kompilierung ‚Äûpasst‚Äú die entsprechende Implementierung je nach Plattform darauf.  Das hei√üt, meine Anwendung kennt keine Google Play-Dienste, kein Game Center und deren Funktionen.  Es kennt nur die ihm zur Verf√ºgung gestellte C ++ - API, wobei es beispielsweise Methoden gibt wie: <br><br><pre> <code class="cpp hljs">SignIn() <span class="hljs-comment"><span class="hljs-comment">//     SignOut() //     LeaveRoom() //    SendMessage(...) //    ShowLeaderboards() //    SubmitScore(...) //    ...</span></span></code> </pre><br><h4>  Suche nach einem Gegner </h4><br>  Der Spieler kann einen Freund aus der Liste seiner Kontakte einladen oder das Spiel mit einem zuf√§lligen Gegner beginnen.  Der Spieler, der die Einladung erhalten hat, kann sie annehmen oder ablehnen.  F√ºr all diese Szenarien verwende ich die Standardschnittstelle des verwendeten Dienstes.  Ich m√∂chte darauf hinweisen, dass Google-Maulk√∂rbe viel besser aussehen iOS iOS.  Vielleicht werden meine H√§nde eines Tages dort ankommen und ich werde meine Schnittstelle mit Dominosteinen und jungen Damen schreiben. <br><br><h4>  Verbindung zum Spielzimmer </h4><br>  Wenn zwei Spieler eine Verbindung zum virtuellen Spielzimmer herstellen, erhalten sie die entsprechenden R√ºckrufe.  Jetzt m√ºssen Sie ausw√§hlen, wer der Gastgeber sein soll. <br><br><h4>  Hostauswahl </h4><br>  Unter den Spielern m√ºssen Sie einen Host ausw√§hlen, damit er den Ausgangszustand des Spiels bestimmt. <br>  √úberlegen Sie im allgemeinen Fall, wie Sie Nachrichten zwischen Spielern weiterleiten k√∂nnen.  Bitte beachten Sie, dass in der zweiten Ausf√ºhrungsform dem Host auch die Rolle eines Routers zugewiesen wird. <br><br><img src="https://habrastorage.org/webt/zl/u8/qu/zlu8qufestbs25fic3j8ajfn2w8.png"><br><br>  Da ich immer nur zwei Spieler im Spiel habe, stellt sich heraus, dass ich einen Sonderfall der Peer-to-Peer-Verbindung habe.  Und deshalb f√§llt nur die Definition des Anfangszustands auf die Wirtsrolle, n√§mlich die Wahl des Wortes, aus dem die W√∂rter zusammengesetzt werden. <br><br>  Nachdem die Spieler mit dem Spielzimmer verbunden sind, kennt jeder der Spieler die Liste der Kennungen der Teilnehmer des begonnenen Spiels.  Wir nennen es eine Liste der <b>Teilnehmer-ID</b> .  Die Teilnehmer-ID ist eine bestimmte eindeutige Zeichenfolgen-ID des Spielteilnehmers, die vom Dienst zugewiesen wird.  Sie m√ºssen ausw√§hlen, welcher von ihnen der Host sein soll, dies zum Host selbst bringen und dem anderen mitteilen, dass sein Gegner als Host ausgew√§hlt wurde.  Wie kann man das machen? <br><br><h5>  Android Host Auswahl </h5><br>  Ich habe keinen Rat zur Auswahl eines Hosts in Google Dock gefunden.  Sie schweigen, Partisanen.  Aber die guten Leute auf <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">stackoverflow.com</a> haben einen Link zum <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Video</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">geworfen</a> , der das folgende Prinzip im Detail erkl√§rt: <br><br><ul><li>  Jeder Teilnehmer sortiert die Teilnehmer-ID-Liste (aufsteigend oder absteigend - es spielt keine Rolle, die Hauptsache ist, dass jeder in der gleichen Reihenfolge arbeitet). </li><li>  Jeder Teilnehmer vergleicht seine Teilnehmer-ID mit der ersten Teilnehmer-ID aus der Liste. </li><li>  Wenn sie √ºbereinstimmen, hat der aktuelle Spieler das Recht zu w√§hlen, wer der Gastgeber sein wird.  Er <s>wirft eine M√ºnze,</s> zieht zuf√§llig (), w√§hlt dabei einen Host aus vorhandenen Teilnehmern aus und teilt jedem mit, wer der Host ist. </li></ul><br><h5>  Hostauswahl unter iOS </h5><br>  F√ºr iOS gibt es eine <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ChooseBestHostPlayerWithCompletionHandler-</a> Methode, die das <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Hostauswahlszenario im</a> Vergleich zu dem, was ich f√ºr Android beschrieben habe, erheblich vereinfacht.  Anhand der sp√ºrbaren Verz√∂gerungen beim Aufruf dieser Methode werden jedoch die Antwortparameter des Netzwerks gesch√§tzt, der Ping gemessen und anhand dieser Statistiken entschieden, wer der Host sein soll.  Dies ist wahrscheinlicher f√ºr die oben genannte Client-Server-Architektur, bei der der Host als Router fungiert.  In meiner Version einer privaten Peer-to-Peer-Verbindung ist dies nicht sinnvoll. Um Zeit zu sparen, verwende ich ein √§hnliches Prinzip wie f√ºr Android. <br><br><h4>  Nachrichten zwischen Spielern </h4><br>  Was ist eine Nachricht?  Eine Nachricht ist ein Array von Bytes. <br><br><ul><li>  In Java ist dies ein Typ: <pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[]</code> </pre> </li><li>  in Ziel-C ist dies: <pre> <code class="objectivec hljs"><span class="hljs-built_in"><span class="hljs-built_in">NSData</span></span> *</code> </pre> </li><li>  In C ++ ordne ich alle oben genannten Elemente zu <pre> <code class="cpp hljs"><span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">vector</span></span>&lt;Uint8&gt;</code> </pre> </li></ul><br>  Es gibt zwei Arten des Sendens von Nachrichten: <br><br><ul><li>  Zuverl√§ssig - garantierte Lieferung durch die Warteschlange.  Wird verwendet, um kritische Nachrichten zu √ºbermitteln. </li><li>  Unzuverl√§ssig - nicht garantierte Lieferung.  Verwendete Nachrichten, deren Zustellungserfolg vernachl√§ssigt werden kann. </li></ul><br>  Unzuverl√§ssig wird normalerweise schneller geliefert als Zuverl√§ssig.  Weitere Informationen finden Sie auf der Website des Anbieters: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Google Play Services: Echtzeit-Multiplayer</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Game Center-Programmierhandbuch: Echtzeit-√úbereinstimmungen</a> </li></ul><br>  Wie werden wir dieses Array verwenden?  Sehr einfach: <br><br><ul><li>  Im ersten Byte schreiben wir den Nachrichtentyp. </li><li>  Wenn die Nachricht Parameter enth√§lt, werden diese in die folgenden Bytes eingef√ºgt.  F√ºr jeden Nachrichtentyp, der hinzugef√ºgt wurde.  Parameter implementieren wir unsere Funktion der Serialisierung und Deserialisierung. </li><li>  Am Ende der Nachricht zur √úberpr√ºfung der Integrit√§t wird eine Pr√ºfsumme eingef√ºgt. </li></ul><br>  Wir definieren also eine <b>Aufz√§hlung</b> mit den Arten von Nachrichten, die die Spieler w√§hrend des Spiels untereinander austauschen: <br><br><ul><li>  Ich werde vom Gastgeber ausgew√§hlt.  Ich √ºbermittle den Ausgangszustand.  Jetzt bin ich an der Reihe (Parameter: Versionsnummer des Messaging-Protokolls, Quellwort); </li><li>  Sie werden vom Host ausgew√§hlt.  Ich freue mich darauf, von Ihnen zu h√∂ren. </li><li>  Ich √∂ffne (rufe) das Wort.  Jetzt sind Sie dran (Parameter: benanntes Wort); </li><li>  Ich gebe auf.  Du hast gewonnen; </li><li>  Ich konnte w√§hrend des Umzugs kein Wort sagen.  Du hast gewonnen; </li><li>  Ich bin damit einverstanden, mich zu r√§chen. </li><li>  Ich beende das Spiel. </li><li>  Fehler beim Parsen der Nachricht.  Getrennt; </li><li>  Ihre Version des Messaging-Protokolls ist veraltet.  √úberpr√ºfen Sie das Anwendungsupdate.  Getrennt; </li><li>  Meine Version des Messaging-Protokolls ist veraltet.  M√ºssen Sie das Update √ºberpr√ºfen.  Getrennt; </li><li>  Ping (Systemnachricht); </li></ul><br>  Wenn die Anwendung eine eingehende Nachricht von einem Gegner empf√§ngt, wird der entsprechende R√ºckruf aufgerufen, der sie wiederum zur Verarbeitung an den Haupt-SDL-Thread weiterleitet. <br><br><h4>  Verbindungs√ºberwachung </h4><br>  Spieledienste (die von Google, die von Apple) verf√ºgen √ºber Listener-Funktionen, die in der einen oder anderen Form dazu dienen, uns √ºber eine Trennung von einem Gegner zu informieren.  Ich habe jedoch festgestellt, dass, wenn einer der Spieler vom Internet getrennt ist, der zweite nicht sofort wei√ü, dass der erste die Verbindung getrennt hat und niemand zum Spielen da ist.  R√ºckrufe werden in solchen F√§llen nicht oder nach l√§ngerer Zeit aufgerufen.  Damit in diesem Fall der zweite Spieler nicht darauf wartet, dass der Krebs auf dem Berg pfeift, musste ich die Verbindung selbst √ºberwachen und dabei nach dem Prinzip arbeiten: <br><br><ul><li>  Jeder Spieler sendet jede Sekunde eine Ping-Nachricht an den Gegner. </li><li>  Jeder Spieler pr√ºft: Wenn der Gegner l√§nger als 5 Sekunden keine Nachricht erhalten hat, ist die Verbindung unterbrochen und wir beenden das Spiel. </li></ul><br><h3>  Ergebnis </h3><br>  Als Ergebnis der geleisteten Arbeit bekam ich ein Spiel, das ich selbst mit meinen Freunden und meiner Familie spiele.  Ich spiele sowohl auf iOS als auch auf Android. <br><br>  Es stimmt, es gibt eine Nuance unter iOS - aus irgendeinem Grund sind Brillen nicht in Bestenlisten festgelegt, √ºber die ich derzeit mit dem Apple-Support korrespondiere. <br><br>  Ich hoffe, dieser Artikel ist sowohl f√ºr Mitglieder meines Teams als auch f√ºr diejenigen n√ºtzlich, die an der Entwicklung mobiler Anwendungen interessiert sind.  Vielen Dank f√ºr Ihre Aufmerksamkeit. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de433172/">https://habr.com/ru/post/de433172/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de433156/index.html">Dell geht an die B√∂rse und strebt die Hybrid Cloud an</a></li>
<li><a href="../de433158/index.html">Musikalische Parodien von SUSE √ºber Kubernetes, Linus Torvalds und andere</a></li>
<li><a href="../de433164/index.html">Schnell und w√ºtend: Forza Horizon 4 beschleunigt mit Fenstershadern</a></li>
<li><a href="../de433168/index.html">Warum hat ein Programmierer ein Praktikum in der K√ºche - ein Gespr√§ch mit Dodo Pizza √ºber gemba, .NET und Offenheit</a></li>
<li><a href="../de433170/index.html">Wie wir die Architektur des Unternehmens nicht wiederholen konnten</a></li>
<li><a href="../de433174/index.html">Nicht alle Patches sind gleicherma√üen n√ºtzlich.</a></li>
<li><a href="../de433176/index.html">Docker Remote-API f√ºr Zertifikatauthentifizierung mit Sperr√ºberpr√ºfung</a></li>
<li><a href="../de433178/index.html">Wie wir eine besch√§digte WAV-Datei wiederhergestellt haben</a></li>
<li><a href="../de433180/index.html">L√∂sen von Datentypproblemen in Ruby oder Machen Sie Daten wieder zuverl√§ssig</a></li>
<li><a href="../de433182/index.html">Ist es m√∂glich, einen Agenten f√ºr den Handel an der B√∂rse mit Verst√§rkung auszubilden? Implementierung der R-Sprache</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>