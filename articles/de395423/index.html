<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧝 👩‍👩‍👦‍👦 🚚 Igel - sprechender Vogel [wenn mit einem MP3-Player] 🎇 📢 🐯</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Vor langer Zeit, so sehr, dass es bereits unwahr erscheint, sprach Masterkit über einen wunderbaren eingebauten MP3-Player , der mit allem ausgestatte...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Igel - sprechender Vogel [wenn mit einem MP3-Player]</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/395423/"><img src="https://habrastorage.org/files/dd1/444/264/dd1444264dca4f489dd7f23d7cd5e9e4.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vor langer Zeit, so sehr, dass es bereits unwahr erscheint,   </font><font style="vertical-align: inherit;">sprach </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Masterkit</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> über einen wunderbaren </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">eingebauten MP3-Player</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , der mit allem ausgestattet werden kann, auch mit MP3-Playern, wenn Sie zuerst Ihren eigenen entfernen und dann diesen </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link"><font style="vertical-align: inherit;">aufsetzen</font></a><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Kurz gesagt, eine nützliche Sache. </font><font style="vertical-align: inherit;">Vor allem, wenn Sie ein Kinderspielzeug zum einen mit Ihren eigenen Händen und zum anderen richtig herstellen möchten und nicht so, wie diejenigen, die es im industriellen Maßstab herstellen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In dem vorgestellten Produkt war ich jedoch nicht nur mit allem zufrieden, sondern dachte auch: Es kann nicht so sein, dass das chinesisch aussehende Ding nicht bei Aliexpress war. </font><font style="vertical-align: inherit;">In der Tat gab es eine bestimmte Anzahl solcher Player, und die Kenntnis der Modellpalette zeigte, dass es Optionen gibt, die attraktiver sind als Modelle mit einer festen Speichermenge. </font><font style="vertical-align: inherit;">Nämlich - mit einem Steckplatz für austauschbare microSD-Karten. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und los geht's.</font></font><br>
<br>
<a name="habracut"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um klar zu machen, was und wohin es ging, eine Igel-Demo in verschiedenen Modi. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Unterhaltsame Sätze während des Wartens:</font></font><br>
<br>
<iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://www.youtube.com/embed/1366DoGJP6A%3Ffeature%3Doembed&amp;usg=ALkJrhi-Ym0HqjE0wk218v-flzHVEedt5w" frameborder="0" allowfullscreen=""></iframe><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Geschichten ein- und ausschalten, Lautstärke mit Karten ein- und ausschalten und schütteln:</font></font><br>
<br>
<iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://www.youtube.com/embed/SS5_vjFK_TI%3Ffeature%3Doembed&amp;usg=ALkJrhiLWVXkZbIdgCeo4hiv5FLIA6jEXg" frameborder="0" allowfullscreen=""></iframe><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Drahtloses Laden:</font></font><br>
<br>
<iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://www.youtube.com/embed/Za0hYTwOwkk%3Ffeature%3Doembed&amp;usg=ALkJrhhSEpHF2ZxgAlFa70K1syh2SdHsrw" frameborder="0" allowfullscreen=""></iframe><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bevor ich die Geschichte fortsetze, entschuldige ich mich, dass ich einige Ungenauigkeiten in der Beschreibung und den Schaltkreisen machen kann, weil ich dabei sozusagen nichts ahnungsvoll dokumentiert habe. Bitte verwenden Sie gesunden Menschenverstand und praktische Materialien, damit es später nicht unerträglich schmerzhaft wird. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nach einer kurzen Suche und einem kurzen Vergleich wechselte ich zu Ebay, wo ich das bekam, was ich wollte - einen </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Player mit einem JQ6500-Decoder-Chip, 4 Megabyte internem Speicher und einem microSD-Steckplatz</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<img src="https://habrastorage.org/files/923/8cc/760/9238cc7604aa45fbb5ba4a76de92480c.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Warum genau dieser Spieler? Denn dann schien es mir, dass dies eine ideale Option für hausgemachte Arbeit ist. Weil alles bei ihm ist. Wenn Sie möchten, verwenden Sie es separat: Hierfür gibt es Wiedergabe- / Pausenstifte, Schaltspuren, Lautstärke, schnelle Wiedergabe von fünf Spuren und einen Monoverstärker zum direkten Anschließen des Lautsprechers an die Karte (es gibt auch einen Stereoausgang, aber es wird bereits ein externer Verstärker benötigt). Das heißt, zumindest genug Batterie, Lautsprecher, ein paar Tasten und eine Speicherkarte mit Musik.</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/2ca/379/9f7/2ca3799f706c4076ce19752a3f16bad3.jpg" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Viel interessanter ist jedoch die vollständige Kontrolle des Players durch den Anschein einer seriellen Schnittstelle. Hier können Sie alles tun - abspielen, anhalten, die Lautstärke ändern, den Equalizer- und Wiedergabemodus wechseln, beliebige Songs sowohl in der Reihenfolge „durch“ als auch aus bestimmten Ordnern abspielen. Und vor allem in meinem Fall gab es bereits eine </font></font><a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fertige Bibliothek</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> für Arduino. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es sind also bereits zwei Komponenten bekannt: Player und Arduino. Aber ich persönlich wollte hier nicht aufhören, weil es dumm ist, dumm zu sein, Tasten mit einem ganzen Mikrocontroller zu imitieren. Es wird etwas Besonderes benötigt, damit mit Emely sozusagen und Hechten. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Deshalb haben wir hier den einfachsten Vibrationssensor </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SW-18010P</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und den bekannten Kartenleser </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RC522 hinzugefügt</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/150/d3c/e96/150d3ce963b480b1fbec1ec4b268ce99.jpg" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Alles nur, um die Knöpfe komplett loszuwerden, was ich in dem unterhaltsamen Spielzeug für unnötig hielt. Überzeugen Sie sich selbst: Wenn es Knöpfe gibt, drückt das Kind sie irgendwie und öfter - eher zufällig als bewusst. Aber das sehr häufige Wechseln von Märchen ist immer noch nicht ganz richtig. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/b9c/02e/0a2/b9c02e0a23baf7608a221f9f4414597d.jpg" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier stellt sich heraus, wie: Der Vibrationssensor dient dazu, das Spielzeug einzuschalten, wenn das Kind es aufhebt. Mit demselben Sensor kann das Spielzeug erst ausgeschaltet werden, wenn das Kind es ausreichend lange angelegt hat. Was den Mifare-Kartenleser betrifft, so ist dieses Ding meiner Meinung nach äußerst praktisch, um Märchen zu wechseln. Zum Beispiel können Karten an Bücher angehängt werden, und dann kann das Kind das Märchen hören, indem es das Spielzeug zum Buch bringt.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Außerdem können Karten an verschiedene Themen angehängt werden, und dann kann das Kind ihre Beschreibung und Nutzungsregeln anhören. Zum Beispiel, dass diese weiße Figur ein Kühlschrank ist und dass wir Lebensmittel dort aufbewahren, damit sie sich nicht verschlechtern, und dass es sich aus diesem Grund nicht lohnt, sie zu öffnen. Oder dass dies der Ofen ist und er heiß sein kann, sodass Sie nicht an seinem Griff hängen und Ihre Hände auf das Glas legen müssen. Viele Dinge können erfunden werden, insbesondere da die Karten U-Bahn-Tickets sind (ja, ich bin glücklich, ich bin in Moskau), die leicht in der richtigen Menge gesammelt werden können. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Während ich </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nachdachte,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nahm ich in der Zwischenzeit den </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">ATmega328p-</font></a><font style="vertical-align: inherit;"> Controller aus dem Lager </font><font style="vertical-align: inherit;">, </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">löte</font></a><font style="vertical-align: inherit;"> ihn auf das </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Steckbrett</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und ließ den Adruino-Bootloader durch den Arduino Mega 2560 flashen.</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/7a1/8e1/1f2/7a18e11f2ab1d2216152487c55228bc4.jpg" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Einfachheit halber habe ich die serielle Schnittstelle, den Reset und die Erdung zur schnellen Neuprogrammierung an einen separaten Anschluss angeschlossen. Und dann kenne ich mich selbst - ich werde die Skizze ausfüllen, und dann ist einer nicht richtig, der andere ist falsch. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Daneben wurde auch ein 3,3-V-Stabilisator verlötet, da der RC522 aufgrund eines Missverständnisses mit dieser Spannung betrieben wird, während sich die restlichen Komponenten beim universellen 5-V-Stabilisator großartig anfühlen, den ich von einer </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">einfachen Powerbank mit 18650-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Batterien </font><font style="vertical-align: inherit;">erwartet hatte </font><font style="vertical-align: inherit;">. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/1f6/16e/7f6/1f616e7f61cff02dbe2dee78f2676ce1.jpg" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Entscheidung, eine solche Powerbank anstelle von zu verwenden Eine typische leere Batterie scheint nicht intuitiv zu sein. Aber ich dachte, da das Spielzeug ziemlich ordentlichen Strom verbraucht (nur der Controller und der Player im Standby-Modus verbrauchen ungefähr 40 mA), ist die Möglichkeit, eine leere Batterie schnell durch eine volle zu ersetzen, sehr hilfreich.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Außerdem musste ich einen piezokeramischen Hochtöner hinzufügen, um einige Ereignisse akustisch anzuzeigen (z. B. Lesen einer Karte). Das, sagen Sie, ist im Allgemeinen lustig - es gibt einen Sprecher, oder? Ja, nicht so. Immerhin ist der Lautsprecher an den Player und nicht an den Controller angeschlossen. Und er fügte einen Transistor als Schlüssel hinzu, der den MP3-Player im Ruhezustand ausschaltet, um den Energieverbrauch zu senken.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ein aufmerksamer Leser kann feststellen, dass der Player über einen digitalen Controller-Pin mit Strom versorgt werden kann, der sich perfekt zum Ein- und Ausschalten eignet. Ich würde es selbst mögen, aber nur im Standby-Modus verbraucht der Player 16 mA. Und wenn die Musik, dauert es leicht mehr als 100 mA, was bereits mindestens doppelt so viel Kapazität wie ATmega ist. Daher nahm ich "jeden" npn-Transistor mit einem Kollektorstrom von 300 mA und brachte ihn über einen Widerstand von etwa 200 Ohm an den digitalen Pin des Controllers. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Kartenleser verbraucht jedoch weniger als 40 mA, sodass der Stabilisator, der ihn speist, an den digitalen Pin des Controllers angeschlossen werden kann. Er tat es, arbeitete aber immer noch nicht, worüber - am Ende.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ein weiterer solcher Punkt: Der Spieler benötigt einen dynamischen Kopf mit einem Widerstand von mindestens 8 Ohm. Ich hatte einen (einen Lautsprecher von der Systemeinheit), aber ihr Sound ist nicht sehr gut. Es gab auch Lautsprecher mit einem Widerstand von 4 Ohm (von einem typischen chinesischen Sprecher). Im Allgemeinen habe ich beide in Reihe geschaltet: einer gibt mehr hoch, der andere gibt niedrig und zusammen klingen sie einfach cool. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Blieb eine Kleinigkeit, d.h. Spiegel der Seele. Welches ist am einfachsten aus einem Paar in Reihe geschalteter LEDs zu machen. Ich habe kein brutales Rot genommen - es ist sehr beängstigend. Aber bernsteingelbe Augen - das war's. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
So wird das Modell des Spielzeugs zusammengebaut und debuggt. Jetzt das Wichtigste: Sie brauchen einen Körperspender. Eigentlich wollte ich wirklich einen </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sprechervogel</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aber nach dem Preis benachbarter Spielzeuge zu urteilen, ist das Vergnügen nicht ganz budgetär. Besonders wenn man bedenkt, dass das Interesse des Kindes unvorhersehbar ist. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Daher suchte ich zunächst nach einem günstigeren Kandidaten für eine Transplantation. Und einer wurde gefunden: der charmante </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Igel Evelyn</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , der in der Kinderwelt verkauft wird.</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/0b5/e51/e8f/0b5e51e8f536d2fbb1b1316a8a452973.jpg" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Natürlich musste ich die reiche innere Welt des Igels fast vollständig loswerden. Und ersetzen Sie es durch ein hausgemachtes, verpackt in einer gewöhnlichen Seifenschale. Allerdings nicht ganz gewöhnlich. Tatsache ist, dass diese Seifenschale im Gegensatz zu vielen anderen eine flache Rückseite hat. Daher ist es praktisch, einen Kartenleser dort zu platzieren - Sie erhalten einen Mindestabstand. Andererseits hat die Seifenschale so etwas wie eine Massagebürste und sogar Löcher, d.h. Der Lautsprecher ist dort ideal platziert: Der Ton wird durch Öffnungen ausgegeben, die nicht durch Massagespitzen blockiert werden. Die Löcher erwiesen sich jedoch als nicht genug, aber es spielt keine Rolle - ich bohrte immer noch.</font></font><br>
<br>
<img src="https://habrastorage.org/files/bcd/a1c/4a8/bcda1c4a8ad44044821c32d684ff0458.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Schwierigste, muss ich zugeben, war die Operation für den Igel. Erstens nähe ich nicht gern. Und ich musste anständig: zuerst reiße ich es auseinander, befestige dann die Kanten zusammen und nähe dann sechs Knöpfe. Dann ließ er sechs Knöpfe los und nähte vier Knöpfe. Warum alle? Weil ich zuerst klein und falsch genäht habe, war der Igel gelöst. </font></font><br>
<br>
<img src="https://habrastorage.org/files/e04/0f1/091/e040f109159d4759b34e6c92aea4fe98.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zweitens die Augen. Natürlich habe ich die LEDs mit einem Durchmesser von 3 mm umsichtig erworben, damit sie garantiert die Pupillen darstellen. Es war jedoch nicht so einfach, Löcher in die vorhandenen Augen von Evelyns Igel zu bohren. Es scheint: Sie nehmen einen Graveur, setzen den richtigen Bohrer ein - und gehen. Es stellte sich jedoch heraus, dass sich der Kunststoff beim Bohren in eine viskose Masse verwandelt, in der der Bohrer eines schwachen Graveurs festsitzt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und ich muss sagen, ein Igel mit einem Bohrer aus dem Auge ist ein höllisches Schauspiel.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich weiß übrigens nicht einmal, was ich dazu raten soll. Ich drehte mich irgendwie und machte immer noch Löcher, steckte LEDs in sie und füllte sie mit Epoxidharz und bedeckte sie mit farblosem Nagellack. Die Augen wurden auch mit Epoxidharz auf den Igel geklebt, da das einheimische Reittier während des Bohrvorgangs starb. Das Ergebnis war nicht perfekt, aber durchaus erträglich. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie der Igel funktioniert, haben Sie bereits gesehen. Daher kann ich nur den Text seiner aktuellen Logik duplizieren. Der Igel befindet sich zunächst im Schlafmodus. Wenn Sie es aufheben (oder einfach bewegen oder die Oberfläche bewegen, auf der es liegt usw.), wird es durch einen Interrupt geweckt, der einen Vibrationssensor erzeugt.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Danach spricht der Igel in festgelegten Intervallen vordefinierte Sätze, und wenn Sie den Igel einige Zeit nicht berühren, schläft er wieder ein. Und wenn Sie es berühren, wird es nicht einschlafen. Und wenn Sie es für eine Weile schütteln, wird es ein Märchen erzählen, das zufällig ausgewählt wird. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie dem Igel eine Karte bringen (wenn er nicht schläft), beginnt der Igel eine Geschichte zu erzählen, die mit dieser Karte verbunden ist. Es gibt keine starre Bindung, die Reihenfolge ändert sich beim Ersetzen von Märchen. Es sind nur zwei Servicekarten festgelegt: zum Einstellen der Lautstärke und zum gewaltsamen Einschläfern des Igels. Die Lautstärke wird übrigens durch sequentielles Umschalten von drei Schritten (leise - mittel - laut) eingestellt.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bernsteinfarbene Augen blinken zweimal (im Zyklus), wenn der Igel aufwacht, schweigen jedoch und ändern ihre Helligkeit, wenn der Igel ein Märchen erzählt. Es schien mir die beste Option zu sein. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Während des Montageprozesses habe ich eine andere Innovation ausprobiert: Da die Power Bank über zwei Anschlüsse (Eingang und Ausgang) verfügt, habe ich den vorhandenen drahtlosen Qi-Ladeadapter an den Eingang angeschlossen. Und so stellte sich heraus, dass Sie den Igel zum Aufladen überhaupt nicht lösen müssen - legen Sie ihn einfach für die Nacht in ein kabelloses Ladegerät. Nur diese Funktion befindet sich jedoch noch im Testmodus.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im Allgemeinen haben mich trotz der scheinbaren Einfachheit einige Dinge verwirrt. Anhand des Codes können Sie beispielsweise erkennen, dass ich mehrmals hintereinander einige Befehle an den Player sende und am Ende sogar eine Zeitüberschreitung einstelle. Und das alles, weil es in meiner Konfiguration in der Praxis nur so möglich ist. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es ist auch zu sehen, dass ich aus irgendeinem Grund das Ende der Wiedergabe über das Hardware-Signal des Players steuere, anstatt den Wiedergabemodus nur einer Datei mit einem einfachen Befehl einzuschalten. Dies ist auch nicht einfach so: Aus irgendeinem Grund funktioniert dieser Modus bei mir nicht. Wenn also am Ende eines Songs der Player beginnt, den nächsten zu spielen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es mag noch merkwürdiger erscheinen, dass sich die Zufallsfunktion zum Abspielen einer zufälligen Komposition ständig in einer Schleife dreht, anstatt nur dann aufgerufen zu werden, wenn sie wirklich benötigt wird. Aber hier ist die Sache: Wenn Sie es nur dann aufrufen, wenn es benötigt wird, gibt es aus irgendeinem Grund in den allermeisten Fällen den gleichen Wert zurück. Wenn Sie jedoch eine Schleife einfügen, werden wirklich pseudozufällige Werte generiert. Eigentlich habe ich es auch in der Praxis herausgefunden, als ich versuchte, das unangemessene Verhalten des Igels zu verstehen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Was mich schließlich völlig verblüffte, war die Unfähigkeit, den Kartenleser mit dem digitalen Pin des Controllers auszuschalten, über den der Leser mit Strom versorgt wird. Aus irgendeinem Grund stellt sich heraus, dass sich das Lesegerät nicht ausschaltet, wenn der Pin auf LOW und dann auf INPUT gesetzt ist.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie nur LOW einstellen, leuchtet die LED des Kartenlesers vollständig auf. Die Spannung am Ausgang des Stabilisators, der den Leser versorgt, beträgt ungefähr Volt. Wenn dann am Controller-Pin INPUT ausgeführt wird, steigt diese Spannung auf ca. 3V an. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Noch interessanter ist es, dass sich das Lesegerät ausschaltet, wenn Sie zuerst die an den SS- und RST-Leser angeschlossenen Controller-Pins auf LOW und INPUT setzen und dann den Power-Pin des Controllers in dieselbe Position bringen. Und selbst dann schaltet es sich nach dem Ruhezustand ein, wenn der Stromanschluss auf OUTPUT und HIGH übertragen wird.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es passiert jedoch etwas irreparables mit Timern. Das heißt, ich denke schon, weil nach einer solchen Finte (Schlaf bei ausgeschaltetem Lesegerät) die Augen und der Schüttelzähler unzureichend funktionieren und beide Prozesse an millis () gebunden sind. Ich weiß nicht, was passiert und wie ich den Timer wiederherstellen kann, also habe ich ihn so belassen, wie er ist - der Kartenleser isst auch im Schlaf weiter. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn hochrangige Genossen helfen, einen Ausweg zu finden, bin ich sehr dankbar. Obwohl ich kaum glaube, dass ältere Kameraden an diesem Ort lesen werden.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In Anbetracht des Vorstehenden ist Evelyns Igelcode völlig unvollkommen, aber Sie können ihn jederzeit kämmen (Code oder Igel - wählen Sie ihn selbst aus), optimieren, ergänzen, reduzieren oder auf andere Weise an Ihre Bedürfnisse anpassen. </font><font style="vertical-align: inherit;">Deshalb hänge ich es an. </font><font style="vertical-align: inherit;">Und um die Verwendung zu vereinfachen, befindet sich das Maximum an Einstellungen (ich habe alles im Allgemeinen ausprobiert, aber es stellte sich wie gewohnt heraus) nicht im Code, sondern im Abschnitt zur Variablendefinition. </font><font style="vertical-align: inherit;">Es gibt eine Konfiguration von Pins und Zeitverzögerungen sowie die Anzahl der Spuren. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im Abschnitt zur Beschreibung der Kartennummern ist zu verstehen, dass die letzten beiden Karten immer für interne Funktionen reserviert sind - Umschalten der Lautstärke und des Ruhemodus.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aktionsprogramm</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">/*  A0 -   MP3 (  )
 *  pin 0, 1 -   ()
 *  pin 2 -   
 *  pin 4 -   MP3 ( )
 *  pin 5 - 
 *  pin 6 -  
 *  pin 7, 8 -  MP3
 *  pin 9 -  
 *  pin 10 -  
 *  pin 11, 12, 13 - SPI 
 */</span></span> <font></font>
<font></font>
<font></font>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;Arduino.h&gt;</span></span></span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;SoftwareSerial.h&gt;</span></span></span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;JQ6500_Serial.h&gt;</span></span></span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;avr/pgmspace.h&gt; //  PROGMEM</span></span></span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;SPI.h&gt;</span></span></span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;MFRC522.h&gt;</span></span></span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;avr/sleep.h&gt;</span></span></span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;avr/power.h&gt;</span></span></span></span><font></font>
<font></font>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> adc_disable() (ADCSRA &amp;= ~(1&lt;&lt;ADEN)) </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">// disable ADC (before power-off) </span></span></span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> adc_enable() (ADCSRA |= (1&lt;&lt;ADEN)) </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">// re-enable ADC</span></span></span></span><font></font>
<font></font>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> RST_PIN 9</span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> SS_PIN 10</span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> mp3Pin 4</span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> mp3Busy A0</span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> readerPin 6</span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> tonePin 5</span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> ledPin 3</span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> offDelay 70000 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">//  </span></span></span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> winkStep 1500 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">//   </span></span></span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> on 150 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">//  ""</span></span></span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> off 80 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">//  ""</span></span></span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> tOut1 0 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">//         (x - / x1 -  )</span></span></span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> tOut11 500</span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> tOut2 14000</span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> tOut21 15000</span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> tOut3 29000</span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> tOut31 30000</span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> tOut4 44000</span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> tOut41 45000</span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> tOut5 60000</span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> tOut51 65000</span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> tShake 2000 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">//     </span></span></span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> nShakeQ 10 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">//     </span></span></span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> introQ 5 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">//  -</span></span></span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> minVol 18 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">//  </span></span></span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> midVol  22 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">//  </span></span></span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> maxVol 25 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">//  </span></span></span></span><font></font>
<font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> dimDelay, winkStepDelay, onDelay, ledOffDelay, tShakeDelay;<font></font>
boolean ledOn, ledOff, eyes, pwm;<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> wink;
<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> pwmVal;<font></font>
<font></font>
boolean playON = <span class="hljs-literal"><span class="hljs-literal">false</span></span>;<font></font>
boolean pwmUp = <span class="hljs-literal"><span class="hljs-literal">false</span></span>;<font></font>
byte pwmStep = <span class="hljs-number"><span class="hljs-number">1</span></span>;<font></font>
<font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> playFile;<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-function">MFRC522 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mfrc522</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(SS_PIN, RST_PIN)</span></span></span></span>;       <span class="hljs-comment"><span class="hljs-comment">//  MFRC522</span></span>
<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> uidDec, uidDecTemp; <span class="hljs-comment"><span class="hljs-comment">//       </span></span><font></font>
byte bCounter, readBit, nShake, rnd;<font></font>
byte vol = midVol; <span class="hljs-comment"><span class="hljs-comment">//     </span></span>
<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> ticketNumber;
<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> offTimeOut = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-comment"><span class="hljs-comment">//   </span></span>
boolean mp3ON = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-comment"><span class="hljs-comment">//   </span></span>
boolean isInt = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-comment"><span class="hljs-comment">//   </span></span><font></font>
<font></font>
byte ticketQ = <span class="hljs-number"><span class="hljs-number">32</span></span>; <span class="hljs-comment"><span class="hljs-comment">//     (  -  )</span></span>
byte fileQ = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-comment"><span class="hljs-comment">//  MP3-</span></span><font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//    (  ,    ),         .   ,    </span></span>
PROGMEM <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">uint32_t</span></span> ticketSet[]  = {<span class="hljs-number"><span class="hljs-number">2515217196</span></span>, <span class="hljs-number"><span class="hljs-number">2540548337</span></span>, <span class="hljs-number"><span class="hljs-number">2490970856</span></span>, <span class="hljs-number"><span class="hljs-number">2486466332</span></span>, <span class="hljs-number"><span class="hljs-number">2485920633</span></span>, <span class="hljs-number"><span class="hljs-number">35870611</span></span>, <span class="hljs-number"><span class="hljs-number">37836807</span></span>, <span class="hljs-number"><span class="hljs-number">37836806</span></span>, <span class="hljs-number"><span class="hljs-number">2377004330</span></span>, <span class="hljs-number"><span class="hljs-number">2522873668</span></span>, <span class="hljs-number"><span class="hljs-number">2514304566</span></span>, <span class="hljs-number"><span class="hljs-number">23472725</span></span>, <span class="hljs-number"><span class="hljs-number">2485702426</span></span>, <span class="hljs-number"><span class="hljs-number">2374853555</span></span>, <span class="hljs-number"><span class="hljs-number">2374391583</span></span>, <span class="hljs-number"><span class="hljs-number">2492957469</span></span>, <span class="hljs-number"><span class="hljs-number">2486467162</span></span>, <span class="hljs-number"><span class="hljs-number">2489280075</span></span>, <span class="hljs-number"><span class="hljs-number">2488031661</span></span>, <span class="hljs-number"><span class="hljs-number">2491726641</span></span>, <span class="hljs-number"><span class="hljs-number">2491720188</span></span>, <span class="hljs-number"><span class="hljs-number">2490968782</span></span>, <span class="hljs-number"><span class="hljs-number">2490968783</span></span>, <span class="hljs-number"><span class="hljs-number">2488900952</span></span>, <span class="hljs-number"><span class="hljs-number">2489969016</span></span>, <span class="hljs-number"><span class="hljs-number">2506562651</span></span>, <span class="hljs-number"><span class="hljs-number">2375447052</span></span>, <span class="hljs-number"><span class="hljs-number">2375449579</span></span>, <span class="hljs-number"><span class="hljs-number">2489276180</span></span>, <span class="hljs-number"><span class="hljs-number">2483389692</span></span>, <span class="hljs-number"><span class="hljs-number">2486466331</span></span>, <span class="hljs-number"><span class="hljs-number">2484789326</span></span>};<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-function">JQ6500_Serial </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mp3</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">8</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">7</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>; <span class="hljs-comment"><span class="hljs-comment">//  </span></span><font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">enterSleep</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">
</span></span>{<font></font>
 mp3.playFileNumberInFolderNumber(<span class="hljs-number"><span class="hljs-number">01</span></span>, <span class="hljs-number"><span class="hljs-number">005</span></span>); <span class="hljs-comment"><span class="hljs-comment">// -</span></span>
 mp3.playFileNumberInFolderNumber(<span class="hljs-number"><span class="hljs-number">01</span></span>, <span class="hljs-number"><span class="hljs-number">005</span></span>); <span class="hljs-comment"><span class="hljs-comment">// -</span></span>
 delay(<span class="hljs-number"><span class="hljs-number">2500</span></span>);<font></font>
 tone(tonePin, <span class="hljs-number"><span class="hljs-number">800</span></span>, <span class="hljs-number"><span class="hljs-number">500</span></span>);<font></font>
 delay(<span class="hljs-number"><span class="hljs-number">500</span></span>); <font></font>
 digitalWrite(readerPin, LOW); <font></font>
 digitalWrite(mp3Pin, LOW);<font></font>
 digitalWrite(ledPin, LOW);<font></font>
 pinMode(ledPin, INPUT);<font></font>
 pinMode(readerPin, INPUT);<font></font>
 pinMode(mp3Pin, INPUT);<font></font>
 <font></font>
  adc_disable();<font></font>
<font></font>
  set_sleep_mode(SLEEP_MODE_PWR_DOWN);<font></font>
  <font></font>
  sleep_enable();<font></font>
  <font></font>
  sleep_mode();<font></font>
  <font></font>
 sleep_disable();<font></font>
 power_all_enable();<font></font>
<font></font>
 adc_enable();<font></font>
 tone(tonePin, <span class="hljs-number"><span class="hljs-number">450</span></span>, <span class="hljs-number"><span class="hljs-number">500</span></span>);<font></font>
 pinMode(ledPin, OUTPUT);<font></font>
 pinMode(readerPin, OUTPUT);<font></font>
 pinMode(mp3Pin, OUTPUT);<font></font>
 digitalWrite(ledPin, LOW);<font></font>
 digitalWrite(readerPin, HIGH); <font></font>
 digitalWrite(mp3Pin, HIGH);<font></font>
 SPI.begin();            <span class="hljs-comment"><span class="hljs-comment">//  SPI</span></span>
 mfrc522.PCD_Init();     <span class="hljs-comment"><span class="hljs-comment">//  MFRC522</span></span><font></font>
 mp3Init();<font></font>
 offTimeOut = millis();<font></font>
 ledOffDelay = millis();<font></font>
 mp3.playFileNumberInFolderNumber(<span class="hljs-number"><span class="hljs-number">01</span></span>, <span class="hljs-number"><span class="hljs-number">001</span></span>); <span class="hljs-comment"><span class="hljs-comment">// -</span></span>
 mp3.playFileNumberInFolderNumber(<span class="hljs-number"><span class="hljs-number">01</span></span>, <span class="hljs-number"><span class="hljs-number">001</span></span>); <span class="hljs-comment"><span class="hljs-comment">// -</span></span>
 delay(<span class="hljs-number"><span class="hljs-number">500</span></span>);<font></font>
 playON = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <font></font>
 mp3ON = <span class="hljs-literal"><span class="hljs-literal">true</span></span>;<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">wakeUp</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{<font></font>
   detachInterrupt(<span class="hljs-number"><span class="hljs-number">0</span></span>);<font></font>
   ledOffDelay = millis();<font></font>
   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (isInt == <span class="hljs-literal"><span class="hljs-literal">false</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//  </span></span>
    isInt = <span class="hljs-literal"><span class="hljs-literal">true</span></span>;<font></font>
   }<font></font>
   attachInterrupt(<span class="hljs-number"><span class="hljs-number">0</span></span>, wakeUp, LOW); <font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setup</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{<font></font>
  pinMode(<span class="hljs-number"><span class="hljs-number">2</span></span>, INPUT_PULLUP);<font></font>
  attachInterrupt(<span class="hljs-number"><span class="hljs-number">0</span></span>, wakeUp, LOW);<font></font>
  pinMode(readerPin, OUTPUT);  <font></font>
  digitalWrite(readerPin, HIGH);<font></font>
  SPI.begin();            <span class="hljs-comment"><span class="hljs-comment">//  SPI</span></span>
  mfrc522.PCD_Init();     <span class="hljs-comment"><span class="hljs-comment">//  MFRC522</span></span><font></font>
  pinMode(mp3Pin, OUTPUT);<font></font>
  mp3Init();<font></font>
  pinMode(ledPin, OUTPUT);<font></font>
  digitalWrite(ledPin, LOW);<font></font>
  eyes = <span class="hljs-literal"><span class="hljs-literal">false</span></span>;<font></font>
  ledOn = <span class="hljs-literal"><span class="hljs-literal">false</span></span>;<font></font>
  ledOff = <span class="hljs-literal"><span class="hljs-literal">false</span></span>;<font></font>
  dimDelay = millis();<font></font>
  winkStepDelay = millis();<font></font>
  wink = <span class="hljs-number"><span class="hljs-number">0</span></span>;<font></font>
  pwmUp = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-comment"><span class="hljs-comment">//    </span></span>
  pwmVal = <span class="hljs-number"><span class="hljs-number">0</span></span>;<font></font>
  ledOffDelay = millis();<font></font>
  offTimeOut = millis();  <font></font>
  mp3.playFileNumberInFolderNumber(<span class="hljs-number"><span class="hljs-number">01</span></span>, <span class="hljs-number"><span class="hljs-number">001</span></span>); <span class="hljs-comment"><span class="hljs-comment">// -</span></span>
  mp3.playFileNumberInFolderNumber(<span class="hljs-number"><span class="hljs-number">01</span></span>, <span class="hljs-number"><span class="hljs-number">001</span></span>); <span class="hljs-comment"><span class="hljs-comment">// -</span></span>
  delay(<span class="hljs-number"><span class="hljs-number">500</span></span>);<font></font>
  playON = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <font></font>
  mp3ON = <span class="hljs-literal"><span class="hljs-literal">true</span></span>;<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{<font></font>
<font></font>
rnd = random(<span class="hljs-number"><span class="hljs-number">1</span></span>, fileQ<span class="hljs-number"><span class="hljs-number">-1</span></span>);<font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((millis() - offTimeOut) &gt; offDelay) { <span class="hljs-comment"><span class="hljs-comment">//  </span></span><font></font>
<font></font>
     enterSleep();<font></font>
<font></font>
 } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <font></font>
<font></font>
 ledWink(); <span class="hljs-comment"><span class="hljs-comment">//   </span></span><font></font>
<font></font>
<font></font>
 <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (isInt == <span class="hljs-literal"><span class="hljs-literal">true</span></span>) {<font></font>
  <font></font>
  offTimeOut = millis(); <span class="hljs-comment"><span class="hljs-comment">//    -  ,    </span></span><font></font>
<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (nShake == <span class="hljs-number"><span class="hljs-number">0</span></span>) {<font></font>
    tShakeDelay = millis();<font></font>
  }<font></font>
  <font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((millis() - tShakeDelay) &lt; tShake){<font></font>
    nShake = nShake + <span class="hljs-number"><span class="hljs-number">1</span></span>;<font></font>
  } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> {<font></font>
    tShakeDelay = millis();<font></font>
    nShake = <span class="hljs-number"><span class="hljs-number">0</span></span>;<font></font>
  }<font></font>
<font></font>
   isInt = <span class="hljs-literal"><span class="hljs-literal">false</span></span>;<font></font>
 }<font></font>
<font></font>
 <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (nShake &gt; nShakeQ) {<font></font>
  playRandom();<font></font>
  nShake = <span class="hljs-number"><span class="hljs-number">0</span></span>;<font></font>
 }<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//    </span></span><font></font>
<font></font>
playPreset(); <span class="hljs-comment"><span class="hljs-comment">//     </span></span><font></font>
<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//   </span></span>
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (mp3ON == <span class="hljs-literal"><span class="hljs-literal">true</span></span>) {<font></font>
   <font></font>
   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (playON == <span class="hljs-literal"><span class="hljs-literal">true</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//  ,   </span></span>
    offTimeOut = millis(); <span class="hljs-comment"><span class="hljs-comment">//   </span></span><font></font>
   }<font></font>
<font></font>
   nShake = <span class="hljs-number"><span class="hljs-number">0</span></span>;<font></font>
<font></font>
   eyesPWM(); <span class="hljs-comment"><span class="hljs-comment">//  </span></span><font></font>
   <font></font>
<font></font>
    <span class="hljs-comment"><span class="hljs-comment">//  MP3</span></span>
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(analogRead(mp3Busy) &lt; <span class="hljs-number"><span class="hljs-number">250</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//    -  ,  </span></span>
     mp3ON = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <font></font>
     playON = <span class="hljs-literal"><span class="hljs-literal">false</span></span>;<font></font>
     digitalWrite(ledPin, LOW);<font></font>
    }<font></font>
  }<font></font>
  <font></font>
 scanPlay(); <span class="hljs-comment"><span class="hljs-comment">//   </span></span><font></font>
 <font></font>
 }<font></font>
}<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setBitsForGood</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(byte daBeat)</span></span></span><span class="hljs-function"> </span></span>{<font></font>
<font></font>
<font></font>
  <font></font>
        <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (daBeat == <span class="hljs-number"><span class="hljs-number">1</span></span>) {<font></font>
                bitSet(ticketNumber, bCounter);<font></font>
                bCounter=bCounter+<span class="hljs-number"><span class="hljs-number">1</span></span>;<font></font>
                }<font></font>
        <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> {<font></font>
                bitClear(ticketNumber, bCounter);<font></font>
                bCounter=bCounter+<span class="hljs-number"><span class="hljs-number">1</span></span>;<font></font>
        }<font></font>
}<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//    MP3</span></span>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mp3Init</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{<font></font>
  digitalWrite(mp3Pin, HIGH);<font></font>
  delay(<span class="hljs-number"><span class="hljs-number">100</span></span>);<font></font>
  mp3.begin(<span class="hljs-number"><span class="hljs-number">9600</span></span>);<font></font>
  mp3.reset();<font></font>
  mp3.setVolume(vol);<font></font>
  mp3.setLoopMode(MP3_LOOP_NONE);<font></font>
<font></font>
  fileQ = mp3.countFiles(MP3_SRC_SDCARD); <span class="hljs-comment"><span class="hljs-comment">//    </span></span>
  fileQ = fileQ - introQ; <span class="hljs-comment"><span class="hljs-comment">//  </span></span><font></font>
<font></font>
}<font></font>
<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//   </span></span>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">playRandom</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{<font></font>
   tone(tonePin, <span class="hljs-number"><span class="hljs-number">450</span></span>, <span class="hljs-number"><span class="hljs-number">500</span></span>);<font></font>
   delay(<span class="hljs-number"><span class="hljs-number">500</span></span>);  <font></font>
   playFile = rnd;<font></font>
   mp3ON = <span class="hljs-literal"><span class="hljs-literal">true</span></span>;<font></font>
   playON = <span class="hljs-literal"><span class="hljs-literal">true</span></span>;<font></font>
   mp3.playFileByIndexNumber(playFile);<font></font>
   mp3.playFileByIndexNumber(playFile);<font></font>
   mp3.playFileByIndexNumber(playFile);  <font></font>
   delay(<span class="hljs-number"><span class="hljs-number">500</span></span>);<font></font>
}<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">// </span></span>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ledWink</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{<font></font>
<font></font>
 <span class="hljs-comment"><span class="hljs-comment">//     </span></span>
<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((millis() - winkStepDelay) &gt; winkStep) { <span class="hljs-comment"><span class="hljs-comment">//  </span></span><font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">// </span></span>
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (eyes == <span class="hljs-literal"><span class="hljs-literal">true</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//   </span></span><font></font>
<font></font>
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ledOn == <span class="hljs-literal"><span class="hljs-literal">false</span></span>) {<font></font>
      onDelay = millis(); <span class="hljs-comment"><span class="hljs-comment">//  </span></span>
        ledOn = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-comment"><span class="hljs-comment">//  ,   </span></span><font></font>
    }<font></font>
 <font></font>
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((millis() - onDelay) &gt; on) { <span class="hljs-comment"><span class="hljs-comment">//   </span></span>
      digitalWrite(ledPin, LOW); <span class="hljs-comment"><span class="hljs-comment">//   </span></span>
      eyes = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-comment"><span class="hljs-comment">//   </span></span><font></font>
    }<font></font>
<font></font>
  }<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">// </span></span>
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (eyes == <span class="hljs-literal"><span class="hljs-literal">false</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//   </span></span><font></font>
    <font></font>
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ledOff == <span class="hljs-literal"><span class="hljs-literal">false</span></span>) {<font></font>
      ledOffDelay = millis(); <span class="hljs-comment"><span class="hljs-comment">//  </span></span>
        ledOff = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-comment"><span class="hljs-comment">//  ,   </span></span><font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((millis() - ledOffDelay) &gt; off) { <span class="hljs-comment"><span class="hljs-comment">//   </span></span>
      digitalWrite(ledPin, HIGH); <span class="hljs-comment"><span class="hljs-comment">//  </span></span>
      eyes = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-comment"><span class="hljs-comment">//   </span></span><font></font>
    }<font></font>
  }<font></font>
<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ledOn == <span class="hljs-literal"><span class="hljs-literal">true</span></span> &amp;&amp; ledOff == <span class="hljs-literal"><span class="hljs-literal">true</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//    (  /)</span></span>
    wink = wink+<span class="hljs-number"><span class="hljs-number">1</span></span>;<font></font>
    ledOn = <span class="hljs-literal"><span class="hljs-literal">false</span></span>;<font></font>
    ledOff = <span class="hljs-literal"><span class="hljs-literal">false</span></span>;    <font></font>
  }<font></font>
<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (wink == <span class="hljs-number"><span class="hljs-number">4</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//   /</span></span><font></font>
     winkStepDelay = millis();<font></font>
     wink = <span class="hljs-number"><span class="hljs-number">0</span></span>;<font></font>
 }<font></font>
<font></font>
 }<font></font>
<font></font>
}<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//     </span></span>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">playPreset</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{<font></font>
<font></font>
 <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (mp3ON == <span class="hljs-literal"><span class="hljs-literal">false</span></span>) {<font></font>
  <font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((millis() - offTimeOut) &gt; tOut2 &amp;&amp; (millis() - offTimeOut) &lt; tOut21) {<font></font>
    mp3.playFileNumberInFolderNumber(<span class="hljs-number"><span class="hljs-number">01</span></span>, <span class="hljs-number"><span class="hljs-number">002</span></span>); <span class="hljs-comment"><span class="hljs-comment">//   /001/002.mp3      tOut21 .</span></span>
    mp3ON = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <font></font>
    delay(<span class="hljs-number"><span class="hljs-number">500</span></span>);<font></font>
  }<font></font>
<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((millis() - offTimeOut) &gt; tOut3 &amp;&amp; (millis() - offTimeOut) &lt; tOut31) {<font></font>
    mp3.playFileNumberInFolderNumber(<span class="hljs-number"><span class="hljs-number">01</span></span>, <span class="hljs-number"><span class="hljs-number">003</span></span>); <span class="hljs-comment"><span class="hljs-comment">//   /001/003.mp3      tOut31 .</span></span>
    mp3ON = <span class="hljs-literal"><span class="hljs-literal">true</span></span>;<font></font>
    delay(<span class="hljs-number"><span class="hljs-number">500</span></span>);<font></font>
   }  <font></font>
<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((millis() - offTimeOut) &gt; tOut4 &amp;&amp; (millis() - offTimeOut) &lt; tOut41) {<font></font>
    mp3.playFileNumberInFolderNumber(<span class="hljs-number"><span class="hljs-number">01</span></span>, <span class="hljs-number"><span class="hljs-number">004</span></span>); <span class="hljs-comment"><span class="hljs-comment">//   /001/004.mp3      tOut41 .</span></span>
    mp3ON = <span class="hljs-literal"><span class="hljs-literal">true</span></span>;  <font></font>
    delay(<span class="hljs-number"><span class="hljs-number">500</span></span>); <font></font>
  }    <font></font>
<font></font>
    <font></font>
 }<font></font>
  <font></font>
}<font></font>
<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">// </span></span>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">eyesPWM</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{<font></font>
<font></font>
 <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((millis() - winkStepDelay) &gt; (pwmStep)/<span class="hljs-number"><span class="hljs-number">4</span></span>) {
   <span class="hljs-comment"><span class="hljs-comment">//     MP3 </span></span>
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (pwmUp == <span class="hljs-literal"><span class="hljs-literal">true</span></span>) {
      <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (pwmVal &lt; <span class="hljs-number"><span class="hljs-number">128</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//   254 -    (    255,      )</span></span><font></font>
        analogWrite(ledPin, pwmVal);<font></font>
        pwmVal = pwmVal + <span class="hljs-number"><span class="hljs-number">1</span></span>;<font></font>
        pwmStep = pwmStep - <span class="hljs-number"><span class="hljs-number">1</span></span>;<font></font>
        winkStepDelay = millis();<font></font>
      } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> {<font></font>
            pwmUp = <span class="hljs-literal"><span class="hljs-literal">false</span></span>;<font></font>
            pwmStep = <span class="hljs-number"><span class="hljs-number">1</span></span>;<font></font>
            pwmVal = <span class="hljs-number"><span class="hljs-number">128</span></span>;<font></font>
      } <font></font>
    }<font></font>
    <font></font>
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (pwmUp == <span class="hljs-literal"><span class="hljs-literal">false</span></span>) {
      <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (pwmVal &gt; pwmStep) {<font></font>
        analogWrite(ledPin, pwmVal);<font></font>
        pwmVal = pwmVal - <span class="hljs-number"><span class="hljs-number">1</span></span>;<font></font>
        pwmStep = pwmStep +<span class="hljs-number"><span class="hljs-number">1</span></span> ;<font></font>
        winkStepDelay = millis();<font></font>
      } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> {<font></font>
            pwmUp = <span class="hljs-literal"><span class="hljs-literal">true</span></span>;<font></font>
            pwmStep = <span class="hljs-number"><span class="hljs-number">128</span></span>;<font></font>
            pwmVal = <span class="hljs-number"><span class="hljs-number">1</span></span>;<font></font>
      } <font></font>
    }<font></font>
    }<font></font>
  <font></font>
}<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//   </span></span>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">scanPlay</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{<font></font>
<font></font>
 <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (fileQ &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) {
          <span class="hljs-comment"><span class="hljs-comment">//   </span></span>
        <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( ! mfrc522.PICC_IsNewCardPresent()) {
                <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-comment"><span class="hljs-comment">//  </span></span>
        <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( ! mfrc522.PICC_ReadCardSerial()) {
                <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>;<font></font>
        }<font></font>
<font></font>
        uidDec = <span class="hljs-number"><span class="hljs-number">0</span></span>;<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//   ,   </span></span><font></font>
<font></font>
        byte status;<font></font>
        byte byteCount;<font></font>
        byte buffer[<span class="hljs-number"><span class="hljs-number">18</span></span>]; <span class="hljs-comment"><span class="hljs-comment">//   (16  + 2   ) </span></span>
        byte pages[<span class="hljs-number"><span class="hljs-number">2</span></span>]={<span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>}; <span class="hljs-comment"><span class="hljs-comment">//   </span></span>
        byte pageByte; <span class="hljs-comment"><span class="hljs-comment">//   </span></span><font></font>
        <font></font>
        byteCount = <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(buffer);<font></font>
        byte bCount=<span class="hljs-number"><span class="hljs-number">0</span></span>;<font></font>
                <font></font>
<font></font>
        mfrc522.MIFARE_Read(<span class="hljs-number"><span class="hljs-number">4</span></span>, buffer, &amp;byteCount);<font></font>
        <font></font>
          <font></font>
                                bCounter = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-comment"><span class="hljs-comment">// 32-   </span></span><font></font>
                                <font></font>
                                <span class="hljs-comment"><span class="hljs-comment">//  0-3</span></span>
                                <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (bCount=<span class="hljs-number"><span class="hljs-number">0</span></span>; bCount&lt;<span class="hljs-number"><span class="hljs-number">4</span></span>; bCount++) {<font></font>
                                        readBit = bitRead(buffer[<span class="hljs-number"><span class="hljs-number">6</span></span>], (bCount+<span class="hljs-number"><span class="hljs-number">4</span></span>));<font></font>
                                        setBitsForGood(readBit);<font></font>
                                }<font></font>
<font></font>
                                <span class="hljs-comment"><span class="hljs-comment">//  4 - 27</span></span>
                                <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (pageByte=<span class="hljs-number"><span class="hljs-number">5</span></span>; pageByte &gt; <span class="hljs-number"><span class="hljs-number">2</span></span>; pageByte--) {
                                        <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (bCount=<span class="hljs-number"><span class="hljs-number">0</span></span>; bCount&lt;<span class="hljs-number"><span class="hljs-number">8</span></span>; bCount++) {<font></font>
                                                readBit = bitRead(buffer[pageByte], bCount);<font></font>
                                                setBitsForGood(readBit);<font></font>
                                        }<font></font>
                                }<font></font>
<font></font>
                                <span class="hljs-comment"><span class="hljs-comment">//  28-31</span></span>
                                <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (bCount=<span class="hljs-number"><span class="hljs-number">0</span></span>; bCount&lt;<span class="hljs-number"><span class="hljs-number">4</span></span>; bCount++) {<font></font>
                                        readBit = bitRead(buffer[<span class="hljs-number"><span class="hljs-number">2</span></span>], bCount);<font></font>
                                        setBitsForGood(readBit);<font></font>
                                }<font></font>
<font></font>
                               <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (byte ticketNum = <span class="hljs-number"><span class="hljs-number">0</span></span>; ticketNum &lt; ticketQ; ticketNum++) {
                                <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> ticketTemp = pgm_read_dword_near(ticketSet + ticketNum);
                                <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ticketTemp == ticketNumber) {<font></font>
                                  tone(tonePin, <span class="hljs-number"><span class="hljs-number">450</span></span>, <span class="hljs-number"><span class="hljs-number">500</span></span>);<font></font>
                                  delay(<span class="hljs-number"><span class="hljs-number">500</span></span>); 
                                  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ticketNum &lt; (ticketQ - <span class="hljs-number"><span class="hljs-number">2</span></span>)) {
                                    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((ticketNum+<span class="hljs-number"><span class="hljs-number">1</span></span>) &lt; fileQ) {<font></font>
                                      digitalWrite(ledPin, HIGH);<font></font>
                                       playFile = ticketNum+<span class="hljs-number"><span class="hljs-number">1</span></span>;<font></font>
                                      mp3ON = <span class="hljs-literal"><span class="hljs-literal">true</span></span>;<font></font>
                                      playON = <span class="hljs-literal"><span class="hljs-literal">true</span></span>;<font></font>
                                      mp3.playFileByIndexNumber(playFile);<font></font>
                                      mp3.playFileByIndexNumber(playFile);<font></font>
                                      mp3.playFileByIndexNumber(playFile);<font></font>
                                      delay(<span class="hljs-number"><span class="hljs-number">500</span></span>);<font></font>
                                      }<font></font>
                                      <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>;<font></font>
                                  } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> {
                                    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ticketNum == ticketQ<span class="hljs-number"><span class="hljs-number">-1</span></span>) {<font></font>
                                      enterSleep(); <span class="hljs-comment"><span class="hljs-comment">// </span></span><font></font>
                                    }<font></font>
                                    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ticketNum == ticketQ<span class="hljs-number"><span class="hljs-number">-2</span></span>) {<font></font>
                                      setVol(); <span class="hljs-comment"><span class="hljs-comment">//  </span></span><font></font>
                                    }<font></font>
                                  }<font></font>
                                  <font></font>
                                }<font></font>
                               }<font></font>
                        <span class="hljs-comment"><span class="hljs-comment">// }</span></span><font></font>
                <font></font>
        <span class="hljs-comment"><span class="hljs-comment">// Halt PICC</span></span><font></font>
    mfrc522.PICC_HaltA();    <font></font>
<font></font>
<font></font>
  }<font></font>
  <font></font>
}<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//    </span></span>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setVol</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{<font></font>
<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (vol) {
    <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> maxVol:<font></font>
      vol = minVol;<font></font>
      <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>;
    <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> midVol:<font></font>
      vol = maxVol;<font></font>
      <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>;
    <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> minVol:<font></font>
      vol = midVol;<font></font>
      <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>;<font></font>
  } <font></font>
<font></font>
  mp3.setVolume(vol);<font></font>
  <font></font>
}<font></font>
<font></font>
</code></pre><br>
</div></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ein durch den Code ungefähr wiederhergestelltes Diagramm sollte folgendermaßen aussehen (ich entschuldige mich, wenn meine Fehler irgendwo geblieben sind): </font></font><br>
<br>
<img src="https://habrastorage.org/files/edd/eb1/edf/eddeb1edff2442ee96801a317da303a8.jpg"><br>
<br>
<img src="https://habrastorage.org/files/d7f/314/529/d7f314529f8642af8e48e8ef38b20693.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">U1 = ATmega328p</font></font></li>
<li>UHT7333 = HT7333</li>
<li> C1 = 0,1 </li>
<li> R2 = ~50 </li>
<li> R3 = 220 </li>
<li> R4 = 1 </li>
<li>M1 = </li>
<li> R4 = 1 </li>
<li>SP1 =  8 </li>
<li>Piezo =  </li>
<li>T1 =  NPN-      0,3</li>
<li>U2 = JQ6500   : 1 — TX, 2 — RX, 3 — GND, 4 — VCC, 5 — BUSY, 6 — SPK+, 7 — SPK -</li>
</ul><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Habrauser   </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chigin</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , für den er sich sehr </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link"><font style="vertical-align: inherit;">bedankt</font></a><font style="vertical-align: inherit;"> , hat sich spürbar verbessert und all diese Wirtschaft in Ordnung gebracht. </font><font style="vertical-align: inherit;">Beachten Sie jedoch, dass der PNP-Transistor bereits vorhanden ist und die Energieverwaltung des Players invertiert werden muss (d. H. Bei dieser Verbindung wird der Player am Pin des Controllers niedrig eingeschaltet und ausgeschaltet - hoch): </font></font><br>
<br>
<img src="https://habrastorage.org/files/6dc/277/fea/6dc277fea79e4e0cb7da519abd15519b.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bei der aktuellen Konfiguration reicht eine Batterie mit einer Kapazität von ca. 2500 mAh für etwa einen Tag aus benutze einen Igel. </font><font style="vertical-align: inherit;">Um nicht viel zu sagen, aber Sie müssen verstehen, dass der Zeitplan immer anders ist und ich hoffe, dass der größte Teil der Energie im aktiven Modus verbraucht wird. </font><font style="vertical-align: inherit;">Dies erlaubt es uns bis zu einem gewissen Grad, den fehlgeschlagenen vollständigen Rückzug der gesamten Igelelektronik in den Schlaf zu vernachlässigen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie sich die Mühe machen, das ungefähre Budget zu berechnen, erhalten Sie ungefähr Folgendes (in USD):</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Spieler: 8.9</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ATmega328p: 1.1</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Entwicklungsausschuss: 0,28</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Reader RC522: 2.21</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dynamischer Kopf: 0,99</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Piezokeramischer Emitter: 0,77</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LEDs: 0,12</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Transistor: 0,14</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Stabilisator: 0,13</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vibrationssensor: 0,13</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Seifenschale: 0,99</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Powerbank: 0,75</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">18650 Batterie: 3.9</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Qi-Ladeadapter: 1.65</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Speicherkarte: 3</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Igel Evelyn: 6</font></font></li>
</ul><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Insgesamt 31.06, aber in der Tat ein bisschen mehr, weil Sie noch einen Draht für Verbindungen und andere Kleinigkeiten wie Schmelzkleber, doppelseitiges Klebeband und blaues Isolierband benötigen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es muss wahrscheinlich eine besonders wichtige letzte Phrase geben, aber ich habe sie definitiv nicht im Kopf. </font><font style="vertical-align: inherit;">Es ist wahrscheinlich sinnvoll zu sagen, dass das Kind mit dem Spielzeug sehr zufrieden ist, und dies ist definitiv besser (und oft schneller) als das Einschalten des Laptops. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ps. </font><font style="vertical-align: inherit;">Mir sind die Bluetooth-Lautsprecher bekannt, sie sind etwas anders, selbst wenn Sie einen so niedlichen Igel einsetzen.</font></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de395423/">https://habr.com/ru/post/de395423/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar486150/index.html">تطوير مجال تكنولوجيا المعلومات في سلوفاكيا. فوائد العمل للمهنيين الشباب</a></li>
<li><a href="../ar486156/index.html">كما علمت ، ثم كتب دليل التدريب في بيثون</a></li>
<li><a href="../ar486158/index.html">تصور الترجمة الآلية العصبية (نماذج seq2seq مع آلية الاهتمام)</a></li>
<li><a href="../ar486164/index.html">فيروس كورونا 2019-nCoV. أسئلة وأجوبة عن حماية الجهاز التنفسي والتطهير</a></li>
<li><a href="../ar486174/index.html">لدي صفر دوران</a></li>
<li><a href="../de395425/index.html">Die NASA kündigte das Elektroflugzeug X-57 Maxwell an</a></li>
<li><a href="../de395427/index.html">Der Zusammenbruch der Kryptowährung von Ethereum und die zweifelhafte Zukunft dezentraler Organisationen</a></li>
<li><a href="../de395429/index.html">Civilization V wird für den Unterricht an Schulen verwendet</a></li>
<li><a href="../de395431/index.html">Juni Kostenlose Webinare von MediaTek Labs</a></li>
<li><a href="../de395433/index.html">Im Jahr 2015 wurde ein Rekordanstieg bei internationalen Überweisungen von Migranten verzeichnet</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>