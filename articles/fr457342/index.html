<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§±üèΩ üíæ ü§∫ Signes d'en haut: comment nous avons sauv√© les cartographes du travail inutile et des yeux rouges üëáüèø üë®üèΩ‚Äçüöí üöØ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="2GIS est fier de l'exactitude des donn√©es. Chaque jour ouvrable dans chaque ville, nos experts parcourent des zones enti√®res pour corriger tous les ch...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Signes d'en haut: comment nous avons sauv√© les cartographes du travail inutile et des yeux rouges</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/2gis/blog/457342/"><img src="https://habrastorage.org/webt/qh/ar/dd/qharddtefsq8_kvfphp1wpxe9y8.jpeg" alt="image"><br><br>  2GIS est fier de l'exactitude des donn√©es.  Chaque jour ouvrable dans chaque ville, nos experts parcourent des zones enti√®res pour corriger tous les changements sur la carte - nouvelles maisons, routes et m√™me chemins.  Et ils collectent et mettent √©galement des panneaux routiers dessus, ce qui aide √† construire correctement des routes et des itin√©raires p√©destres.  Dans cet article, je vais vous expliquer comment nous avons d√©cid√© d'aider les cartographes et commenc√© √† collecter automatiquement les panneaux de signalisation. <br><a name="habracut"></a><br><h2>  Qu'est-ce que Fidji et pourquoi y a-t-il des signes </h2><br>  Fidji est un √©diteur de cartes que nous d√©veloppons pour nos sp√©cialistes SIG.  Il s'agit d'une application client-serveur classique.  Il y a d√©j√† plusieurs articles sur le hub: dans lesquels on parle des Fidji: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">L'interface utilisateur dans une application d'entreprise, ou comment nous avons cr√©√© un syst√®me pratique pour cr√©er des cartes</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Comment faisons-nous une carte pour ceux qui en font une</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Localisation infinie, ou comment nous traduisons une carte en temps r√©el</a> </li></ul><br><h2>  Comment collecter des signes avant </h2><br>  Les Fidji ont un mode de fonctionnement sp√©cial pour la collecte et la mise √† jour des panneaux.  Dans ce mode, le mappeur peut ouvrir la vid√©o enregistr√©e par le DVR.  La vid√©o elle-m√™me est affich√©e dans une fen√™tre s√©par√©e et sa trace est affich√©e sur la carte.  Le marqueur indique la position actuelle. <br><br><img src="https://habrastorage.org/webt/sn/ve/vf/snvevfj1qfrrvqtr4fzry_cb5ms.jpeg" alt="image"><br><br>  Une grille est appliqu√©e au-dessus de la vid√©o - elle vous permet de d√©terminer la distance jusqu'au panneau.  D√®s que le personnage prend la taille d'une cellule, le cartographe marque une pause et cr√©e le personnage.  √Ä ce moment, nous connaissons la position actuelle et la distance au signe, nous le d√©pla√ßons donc vers l'avant et le dessinons sur le lien.  Le lien dans notre terminologie est une repr√©sentation sch√©matique d'une section de route.  Chaque personnage a son propre code num√©rique, son cartographe entre dans un champ sp√©cial. <br><br>  Si nous avons d√©j√† entr√© un caract√®re, nous le chargeons dans l'√©diteur de caract√®res.  Le cartographe v√©rifie la vid√©o et, si n√©cessaire, apporte des modifications en utilisant les m√™mes codes num√©riques.  Ou, si le signe est correct, le marque comme mis √† jour. <br><br>  Bien s√ªr, cette m√©thode n√©cessite que le cartographe visionne chaque vid√©o - puis passe √©galement du temps √† saisir chaque personnage.  De plus, la position du panneau sur la carte n'est pas d√©termin√©e avec pr√©cision: nous nous √©cartons simplement de la position actuelle d'une distance qui est d√©termin√©e par la grille, puis nous dessinons le point r√©sultant sur la route la plus proche.  Par cons√©quent, les signes peuvent ne pas √™tre cr√©√©s exactement l√† (ou m√™me pas du tout) si n√©cessaire.  Cela signifie que le cartographe doit √©galement le d√©placer au bon endroit, ce qui consomme √©galement son temps.  De plus, la vid√©o peut ne pr√©senter aucun signe, mais le cartographe est toujours oblig√© de la visionner.  Bien s√ªr, le programme vous permet d'augmenter la vitesse de la vid√©o, mais le co√ªt en temps sera dans tous les cas sup√©rieur √† z√©ro.  Par cons√©quent, nous avons d√©cid√© d'automatiser ce processus. <br><br><h2>  Comment collecter maintenant </h2><br>  Nous avons encore besoin de vid√©os de registraire.  Mais maintenant, au lieu de regarder chacun, le cartographe s√©lectionne simplement les fichiers n√©cessaires et appuie sur le bouton "T√©l√©charger".  Apr√®s cela, il peut faire d'autres choses - la vid√©o sera trait√©e et des panneaux de signalisation appara√Ætront sur la carte.  Divers cas douteux seront sp√©cifiquement not√©s.  Il ne reste donc au cartographe qu'√† passer en revue ces cas et √† les corriger. <br><br><h2>  L'architecture </h2><br><img src="https://habrastorage.org/webt/kf/b9/ln/kfb9lnyqkgw-erepgi-icq-myne.jpeg" alt="image"><br><br>  Afin d'obtenir des objets des classes requises avec les attributs n√©cessaires de la vid√©o, nous avons √©crit plusieurs services. <br><br>  Le premier est VideoPreprocessingService - c'est l√† que le fichier vid√©o est t√©l√©charg√©.  Le service envoie le fichier au r√©f√©rentiel, en fait un enregistrement dans la base de donn√©es et cr√©e des t√¢ches pour son traitement.  Vous devez couper des images de la vid√©o avec une certaine fr√©quence, s√©lectionner des points GPS pour eux √† partir de la piste pour eux, envoyer le r√©sultat au service de traitement des images. <br><br>  Les deux premi√®res t√¢ches ne sont pas effectu√©es par le service lui-m√™me, mais par Worker.  Ceci est fait de sorte que vous puissiez facilement changer le nombre de ces travailleurs.  Augmentant ainsi la productivit√©, s'il y a un tel besoin. <br><br>  FrameProcessingService enregistre lui-m√™me toutes les trames et tous les points re√ßus.  Il t√©l√©charge √©galement des images dans la file d'attente.  Il est lu par un service √©crit par nos coll√®gues experts en apprentissage automatique.  Il reconna√Æt les panneaux de signalisation.  Bien s√ªr, FrameProcessingService lit les r√©ponses de ce service - ce sont les codes de caract√®res, s'ils sont sur le cadre, et les rectangles dans lesquels ce caract√®re est inscrit.  Connaissant la taille du rectangle, nous comprenons la distance au signe.  Et lorsque toutes les images de la vid√©o sont trait√©es, il les envoie √† notre serveur de carte. <br><br>  Le serveur de carte est la partie la plus importante du syst√®me.  Les clients re√ßoivent de lui toutes les donn√©es que nous stockons (√† l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">exception des tuiles</a> ).  Il enregistre ces donn√©es et ex√©cute toute la logique m√©tier. <br><br><h2>  Description g√©n√©rale </h2><br>  Nos donn√©es cartographiques sont des objets g√©ographiques.  Un g√©o-objet est une g√©om√©trie (c'est-√†-dire l'emplacement d'un objet dans l'espace) et un ensemble d'attributs.  Nous les stockons dans la base de donn√©es et les exploitons.  Mais de FrameProcessingService, nous obtenons uniquement le code du signe, les coordonn√©es du point √† partir duquel le signe a √©t√© reconnu, le cadre lui-m√™me et le masque de signe sur ce cadre.  Nous devons donc transformer cet ensemble de donn√©es en un objet g√©ographique.  Chaque objet g√©ographique appartient √† une classe.  Chaque type de panneau routier est une classe distincte.  Nous pouvons facilement l'obtenir √† partir du code de signe.  Du code de signe, nous pouvons obtenir des attributs sp√©cifiques √† cette classe.  Par exemple, nous avons re√ßu le code 3_24_60.  3_24 - dit qu'il s'agit d'une limite de vitesse (signe 3.24 dans les r√®gles de circulation).  La valeur de restriction doit √™tre indiqu√©e pour ces caract√®res.  Il nous raconte la troisi√®me partie du code - ici ce sera 60 km / h. <br><br>  Ainsi, la classe d'objets g√©o est d√©finie, ses attributs sont √©galement sp√©cifiques.  Il semblerait que vous puissiez d√©j√† cr√©er un objet g√©ographique.  Mais c'est trop t√¥t.  Premi√®rement, chaque signe a un attribut ¬´Direction¬ª, qui indique dans quelle direction le signe agit.  Deuxi√®mement, nous n'avons toujours pas de g√©om√©trie pour cet objet g√©o.  Nous avons un point √† partir duquel nous avons vu un signe.  Ainsi, le signe lui-m√™me est √† une certaine distance de nous.  De plus, sa g√©om√©trie affecte la valeur de l'attribut Direction. <br><br><img src="https://habrastorage.org/webt/8f/lb/pw/8flbpwm0fabred0ai5qdhfgeqyg.jpeg" alt="image"><br><br>  Ici, nous allons faire une petite digression.  Bien s√ªr, nous avons un r√©seau routier.  Il se compose de liens individuels.  Chaque lien est une ligne.  Dans la premi√®re partie de la figure, nous venons de tracer deux liens.  Les fl√®ches indiquent la direction dans laquelle elles ont √©t√© dessin√©es, c'est-√†-dire  la gauche a √©t√© dessin√©e de bas en haut, et la droite - de haut en bas. <br><br>  Chaque lien contient des informations sur la direction dans laquelle vous pouvez vous d√©placer.  La direction du mouvement est un attribut distinct; elle n'est pas √©gale √† la direction du rendu.  Cet attribut nous indique dans quelle direction vous pouvez vous d√©placer le long du lien, par rapport √† la direction du dessin.  Dans la deuxi√®me partie de la figure, les deux liens ont la m√™me valeur pour cet attribut, et dans la troisi√®me figure - des valeurs oppos√©es. <br><br>  Comment est-ce li√© aux signes?  Donc, nous nous d√©pla√ßons le long des liens de bas en haut, et nous voyons une sorte de signe.  Ainsi, sur le lien de gauche, le panneau aura la direction ¬´Seulement droit¬ª, √† droite - ¬´Seulement en arri√®re¬ª, c'est-√†-dire  m√™mes que les liens de la troisi√®me figure.  Tout s'est av√©r√© simple ici, mais c'est parce que nos liens sont √† sens unique.  En r√©alit√©, un tr√®s grand nombre de liens sont bilat√©raux, c'est-√†-dire  leur direction a le sens de "Dans les deux sens".  Et le signe est toujours dirig√© dans une direction, et nous devons comprendre dans quelle direction. <br><br><h2>  Correspondance de carte </h2><br>  Avant de commencer √† placer des panneaux sur la carte, nous devons comprendre quelles routes nous avons conduites lorsque nous avons enregistr√© la vid√©o.  Les donn√©es GPS ne suffisent pas pour cela: elles sont souvent confondues avec des dizaines de m√®tres.  De plus, les cartes sont toujours des sch√©mas et peuvent √©galement ne pas co√Øncider avec le terrain r√©el.  Par exemple, sur de larges routes √† plusieurs voies. <br><br>  Cela r√©soudra un certain nombre de probl√®mes √† la fois: <br><br><ul><li>  Des panneaux peuvent d√©j√† √™tre cr√©√©s sur ces routes, nous pouvons donc y apporter des modifications, le cas √©ch√©ant; </li><li>  Certains de ces signes peuvent ne pas appara√Ætre sur la vid√©o, et nous pouvons trouver de tels signes - et leur mettre une √©tiquette sp√©ciale; </li><li>  Nous pouvons comprendre sur quelle route nous nous trouvions lorsque nous avons vu un panneau reconnu, ce qui, √† son tour, nous aidera √† placer ce panneau au bon endroit sur la carte. </li></ul><br><h3>  Algorithme </h3><br>  L'algorithme que nous avons utilis√© est assez simple.  Il y a d√©j√† un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">article</a> sur Habr√© avec sa description.  De mani√®re g√©n√©rale, cela ressemble √† ceci: nous avons une route s√©lectionn√©e, prenez le point GPS le plus proche de son extr√©mit√© de la piste.  Et concernant ce point, nous √©valuons les routes qui joignent notre chemin - c'est-√†-dire, nous √©valuons la probabilit√© que notre point se r√©f√®re √† cette route particuli√®re.  Chaque route re√ßoit des points, celle avec le plus de points est s√©lectionn√©e.  R√©p√©tez jusqu'√† la fin de la piste. <br><br>  Dans le processus, nous avons fait plusieurs ajouts √† l'algorithme.  L'algorithme n'a pas pris en compte la direction sur les liaisons routi√®res, donc la premi√®re chose que nous avons faite a commenc√© √† les prendre en compte: maintenant, si la liaison est √† sens unique, nous comprenons quelle direction nous devons suivre.  Et si cette direction ne co√Øncide pas avec la direction du lien, nous rejetons ce lien. <br><br>  Au d√©part, il nous semblait que cela suffirait, et les premiers tests l'ont confirm√©.  Mais ensuite, nous avons commenc√© √† v√©rifier les vid√©os enregistr√©es dans les quartiers r√©sidentiels, et tout s'est av√©r√© moins rose.  Le fait est que nous avons une tr√®s grande pr√©cision des donn√©es, y compris sur les routes.  En cons√©quence, nous avons trac√© toutes les all√©es intra-quartier, dans les moindres d√©tails.  D'un autre c√¥t√© - comme je l'ai dit, le GPS peut ne pas √™tre tr√®s pr√©cis ni m√™me tr√®s impr√©cis.  Et si vous empruntez une route autour de laquelle se trouvent de hauts b√¢timents, les points de la piste peuvent partir assez fortement.  Il arrivait que les points se d√©placent vers plus de 20 m√®tres.  En cons√©quence, il s'av√®re que de nombreux points sont proches de ces routes sur lesquelles nous ne sommes pas all√©s.  Le r√©sultat du r√©tr√©cissement de ces pistes a √©t√© cette image: <br><br><img src="https://habrastorage.org/webt/w_/ur/qe/w_urqefphdidxo2ap6w66ipauz4.jpeg" alt="image"><br>  Le bon sens nous a dit qu'il y a peu de panneaux sur ces routes et qu'il n'y a donc aucune raison particuli√®re de les collecter l√†-bas.  Par cons√©quent, tr√®s probablement, dans la plupart des cas, la voiture s'est d√©plac√©e le long des rues principales.  Par cons√©quent, pour les voies d'acc√®s intra-quartier, nous avons introduit une amende.  Par amende, nous entendons une diminution du nombre de points le long de la route.  En cons√©quence, le probl√®me des entr√©es de rue intra-quartier a √©t√© r√©solu - elles ne sortaient pas lorsque nous ne les suivions pas, et lorsque nous les suivions vraiment, m√™me malgr√© l'amende, elles s'av√©raient √™tre la meilleure option, puis nous les choisissions. <br><br>  Apr√®s cela, les r√©sultats √©taient d√©j√† tr√®s bons.  Et il nous a sembl√© que la cartographie √©tait termin√©e.  Mais le probl√®me est venu, d'o√π ils n'ont pas attendu.  Tout √† coup, il s'est av√©r√© qu'il y a des cas o√π une autre route se d√©tache de la route et le fait tr√®s facilement.  Et tout a √©t√© aggrav√© par le fait que la route secondaire peut √©galement aller en parall√®le avec la n√¥tre, du moins pendant un certain temps.  Dans le m√™me temps, je vous rappelle que la trace GPS n'est presque jamais situ√©e au-dessus des liens vers lesquels nous avons voyag√©, elle est l√©g√®rement d√©cal√©e d'un c√¥t√©.  Et bien s√ªr, gr√¢ce √† tout cela, l'algorithme a commenc√© √† s'accrocher √† ces branches.  √Ä cause de cela, au mieux, nous avons re√ßu plusieurs liens que nous n'avons pas r√©ellement parcourus.  Et dans le pire des cas, ils ont mal plac√© la piste. <br><br><img src="https://habrastorage.org/webt/2z/gs/y9/2zgsy9lrsmmots0z2wcbnnovcki.jpeg" alt="image"><br><br>  Par cons√©quent, nous avons propos√© une √©valuation suppl√©mentaire de la route.  Nous prenons les points pr√©c√©dent et suivant de la trace GPS par rapport au point √† partir duquel nous avons s√©lectionn√© le lien.  Et nous voyons que l'azimut en ces points ne diff√®re pas trop de l'azimut du mouvement le long de ce lien.  S'il diff√®re consid√©rablement, nous affinons ce lien. <br><br>  En cons√©quence, nous avons obtenu un r√©sultat qui nous convient, bien que parfois de petites erreurs se produisent encore (parfois un lien suppl√©mentaire peut √™tre choisi que nous n'avons pas parcouru).  Mais ils sont assez rares et ne sont donc pas critiques pour nous. <br><br><h2>  Placement des personnages </h2><br>  Nous avons maintenant un ensemble de liaisons routi√®res sur lesquelles nous avons roul√© et un ensemble de cadres avec des panneaux.  Ainsi que des informations sur quel personnage se trouve sur cette image, √† partir de quel point sur la piste cette image et le masque du personnage sont obtenus (un rectangle qui d√©crit le personnage sur cette image).  Vous pouvez donc placer ces panneaux sur la carte. <br><br>  La premi√®re √©tape consiste √† obtenir des informations suppl√©mentaires qui nous aideront √† placer l'enseigne au bon endroit: <br><br><ol><li>  Signe d'azimut.  Si la marque est situ√©e exactement au centre du cadre, elle co√Øncide avec l'azimut au point GPS.  Si le signe n'est pas centr√©, c'est l'azimut au point + l'angle entre le centre du cadre et le signe.  Nous avons d√©j√† l'azimut du point GPS, et nous pouvons calculer l'angle entre le centre du cadre et le signe, car  nous savons o√π se trouve le masque de signalisation sur le cadre et nous connaissons l'angle de vision avec lequel la vid√©o a √©t√© enregistr√©e. </li><li>  La distance √† la marque du point GPS.  Nous pouvons le calculer, car  nous connaissons la taille du masque de signe, la r√©solution de l'image et l'angle de vision avec lequel la vid√©o est enregistr√©e. </li></ol><br>  Vous pouvez maintenant passer directement √† l'installation de l'enseigne.  Parce que  les points sur la piste ne se trouvent pas toujours (mais en fait jamais) sur les liaisons routi√®res, nous devons d'abord placer notre point de d√©tection de signe sur la liaison.  Nous le faisons comme suit: <br><br><ol><li>  Parmi les routes sur lesquelles la piste √©tait assise, nous ne laissons que celles qui traversent une sorte de tampon autour de notre point GPS; </li><li>  Nous calculons la distance √† chaque route s√©lectionn√©e et les trions par son augmentation; </li><li>  Nous prenons la route, calculons la projection du point GPS dessus; </li><li>  Nous obtenons la direction avec laquelle nous nous d√©pla√ßons √† ce point le long de cette route; </li><li>  Si la direction du point 4 est inacceptable sur cette route, alors nous revenons au point 3 et prenons la route suivante; </li><li>  Si la direction est acceptable, arr√™tez-vous. </li></ol><br>  Nous avons maintenant la route que nous avons emprunt√©e lorsque nous avons d√©fini le point GPS et la projection de ce point sur notre route.  En fait, cette route, et donc le point, peut ne pas √™tre choisie correctement.  Par exemple, dans les virages, il est tr√®s facile de se tromper. <br><br><img src="https://habrastorage.org/webt/qt/2k/1b/qt2k1bdnjoo0gxkoeytgv2a-2zm.jpeg" alt="image"><br><br>  Par cons√©quent, avant de continuer, vous devez vous assurer que nous ne nous trompons pas.  Ou, si vous faites une erreur, remplacez la route par la bonne et obtenez une projection dessus.  Pour ce faire, prenez les routes qui relient √† notre route et √©valuez-les par distance et azimut.  En cons√©quence, nous obtenons la route qui convient le mieux √† un point donn√© et construisons une projection sur celui-ci. <br><br>  Maintenant que notre point GPS est tir√© sur la route, nous pouvons calculer l'emplacement du panneau par rapport √† celui-ci.  Pour ce faire, construisez un vecteur √† partir de ce point avec une longueur √©gale √† la distance au signe dans la direction co√Øncidant avec l'azimut du signe.  Apr√®s cela, nous essayons de tirer le panneau vers l'une des routes sur lesquelles notre piste √©tait assise.  Dans ce cas, nous prenons en compte la direction des routes et la direction du panneau, qui est calcul√©e pour chaque route √† travers l'azimut du panneau. <br><br>  √Ä ce stade, il peut s'av√©rer qu'il n'y avait pas de route appropri√©e.  Par exemple, du fait que le panneau aura une direction inacceptable sur ces routes (c'est-√†-dire qu'elles sont √† sens unique).  Dans ce cas, ce panneau est situ√© sur une route voisine sur laquelle nous n'avons pas pass√©, ce qui signifie que nous ne le cr√©erons tout simplement pas. <br><br>  Maintenant que nous avons les coordonn√©es du panneau trac√©es sur la route, il reste √† v√©rifier qu'il est correctement r√©gl√©, car parfois nous pouvons faire une erreur.  Pour ce faire, nous v√©rifions que le signe n'est pas trop √©loign√© du point GPS d'origine en comparant cette distance avec la distance au signe obtenu √† travers le cadre, avec une certaine hypoth√®se.  V√©rifiez √©galement que la marque n'est pas derri√®re le point GPS.  Si les validations sont r√©ussies, nous avons obtenu les coordonn√©es du panneau sur la route et sa direction, ce qui signifie que notre g√©o-objet a la g√©om√©trie et tous les attributs n√©cessaires.  Vous pouvez proc√©der √† sa sauvegarde. <br><br><h2>  Fusionner les signes </h2><br>  En fait, il est trop t√¥t pour passer √† la conservation.  Le fait est que chaque panneau peut √™tre vu √† partir de plusieurs cadres, √† l'exception de certains cas particuliers, lorsque pour certaines parties du cadre, le panneau est cach√© derri√®re un obstacle, par exemple derri√®re un camion. <br><br>  De chacun de ces cadres, nous avons obtenu un objet g√©o pour le signe, ils ont les m√™mes attributs et ils sont situ√©s √† peu pr√®s au m√™me point.  Cela signifie que nous devons n'en laisser qu'un seul.  De plus, si ce signe n'est pas nouveau, nous l'avons d√©j√† dans la base de donn√©es, ce qui signifie que nous devons le marquer comme √©tant mis √† jour et ne pas cr√©er un nouvel objet g√©ographique. <br><br>  Pour cela, nous r√©alisons la fusion de nouveaux objets g√©ographiques entre nous et avec les objets existants. <br>  Tout d'abord, nous obtenons tous les signes que nous avons d√©j√† cr√©√©s, sur les liens sur lesquels nous avons roul√©.  √Ä eux, nous ajoutons tous les caract√®res que nous avons reconnus dans les cadres. <br><br>  Ce que nous devons faire avec eux: nous devons comprendre √† partir de leurs classes, attributs et g√©om√©tries qu'un ensemble de ces objets g√©ographiques est le m√™me signe.  S'il existe un objet g√©o existant dans cet ensemble, ne le laissez que et notez qu'il a √©t√© mis √† jour.  Si l'ensemble ne contient que de nouveaux objets g√©ographiques, n'en laissez qu'un seul. <br><br>  Nous le faisons en quatre √©tapes: <br><br><ol><li>  Regroupez les objets g√©ographiques par classe; </li><li>  Dans chaque groupe de l'√©tape 1, nous obtenons des groupes par attributs; </li><li>  Pour chaque groupe de l'√©tape 2, nous collectons les groupes par g√©om√©trie; </li><li>  S'il y a un signe existant dans le groupe de l'√©tape 3, nous le laissons seulement (s'il y en a plusieurs, alors laissez-les tous), et s'il n'y a pas de signe existant dans le groupe, nous laissons celui qui est au milieu. </li></ol><br>  Apr√®s cela, nous avons le nombre souhait√© de caract√®res qui peuvent enfin √™tre enregistr√©s. <br><br><img src="https://habrastorage.org/webt/lr/hd/wi/lrhdwidcpddigmpg98qtqfwu8-y.jpeg" alt="image"><br><br>  Bien s√ªr, il se peut que nous ayons une sorte de signe, mais nous ne l'avons pas reconnu avec la vid√©o.  Dans ce cas, ce symbole ne sera pas mis √† jour.  Malheureusement, nous ne pouvons pas √™tre s√ªrs que ce signe n‚Äôest plus sur le sol, car  il pourrait simplement √™tre couvert par une sorte d'obstacle lors de l'enregistrement d'une vid√©o.  Par cons√©quent, nous ne supprimons pas ce signe imm√©diatement, mais le marquons comme manquant sur la vid√©o.  Si ce signe est visible sur une autre vid√©o, nous supprimons simplement cette marque et la mettons √† jour.  S'il n'est toujours pas visible - le cartographe devra faire face √† ce signe.  Et supprimez-le s'il ne l'est plus. <br><br><h2>  Plans imm√©diats </h2><br><h3>  Signalisation des routes secondaires </h3><br>  Les signes sur la vid√©o proviennent non seulement des routes que nous conduisons, mais aussi des routes secondaires: il peut s'agir de routes qui traversent la n√¥tre ou qui sont adjacentes √† la n√¥tre.  Ou vice versa - des routes qui bifurquent sur la n√¥tre.  Il peut m√™me s'agir de routes parall√®les aux n√¥tres.  Il est tr√®s difficile de distinguer les panneaux qui se trouvent sur ces routes des panneaux dont nous avons besoin.  Apr√®s tout, ils sont souvent proches de notre route. <br><br>  Pour r√©soudre le probl√®me, nous pr√©voyons d'utiliser un certain nombre de r√®gles s√©mantiques lors du placement d'un signe sur un lien.  Par exemple, une limite de vitesse de 5 km / h est peu probable sur l'autoroute, mais tr√®s probablement √† l'entr√©e de la station-service. <br><br><h3>  Signes de suivi </h3><br>  Parfois, nous ne gardons pas de panneaux, et parfois vice versa - nous d√©tenons des panneaux qui n'ont pas besoin d'√™tre fusionn√©s.  Par cons√©quent, nous pr√©voyons de suivre les personnages par images - afin de reconna√Ætre le m√™me caract√®re sur diff√©rentes images avant m√™me de les transformer en objets g√©o.  Et utilisez ces connaissances avec la fusion. <br><br><h2>  Conclusion </h2><br>  La version actuelle est essentiellement b√™ta.  Par cons√©quent, il est imparfait.  Il y a des probl√®mes que nous allons r√©soudre dans un avenir proche.  Il y a des probl√®mes qui ne sont pas encore clairement r√©solus.   ,         . , GPS-     .  ,      ‚Äî    ,   .  ,    ,    . <br><br>        .  ,  .   , ,    - . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr457342/">https://habr.com/ru/post/fr457342/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr457332/index.html">Comment voir rapidement les avertissements int√©ressants g√©n√©r√©s par l'analyseur PVS-Studio pour le code C et C ++?</a></li>
<li><a href="../fr457334/index.html">TacacsGUI, Configuration Manager</a></li>
<li><a href="../fr457336/index.html">Les cons√©quences du retrait pr√©matur√© des dents de sagesse</a></li>
<li><a href="../fr457338/index.html">Blitz avec Ilya Krasinsky: comment tirer les mauvaises hypoth√®ses, pourquoi rejeter un produit et comment grandir pour un minimum d'action?</a></li>
<li><a href="../fr457340/index.html">10 plugins PostCSS qui vous feront gagner du temps de mise en page</a></li>
<li><a href="../fr457348/index.html">D√©ploiement sur PythonAnywhere depuis GitHub</a></li>
<li><a href="../fr457350/index.html">Pourquoi l'oscilloscope a-t-il besoin d'un support de cryptographie?</a></li>
<li><a href="../fr457352/index.html">Conclusion des informations sur l'affichage de l'acheteur</a></li>
<li><a href="../fr457354/index.html">Obfuscation des donn√©es pour les tests de performances</a></li>
<li><a href="../fr457362/index.html">Promotion de RUVDS: pr√©parer le serveur en √©t√©</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>