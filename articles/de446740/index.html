<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë∞üèø üèáüèª ‚ôëÔ∏è Verwenden von Python f√ºr die Berichterstellung in einem einzelnen Unternehmen ‚§µÔ∏è üë®‚Äçüë©‚Äçüëß‚Äçüë¶ üí∫</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Diese Geschichte ereignete sich in einer echten Firma, obwohl einige Namen und Ereignisse fiktiv sind. 

 Glory war ein gew√∂hnlicher Entwickler in ein...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Verwenden von Python f√ºr die Berichterstellung in einem einzelnen Unternehmen</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/446740/"> Diese Geschichte ereignete sich in einer echten Firma, obwohl einige Namen und Ereignisse fiktiv sind. <br><br>  Glory war ein gew√∂hnlicher Entwickler in einem kleinen Unternehmen in der Stadt N. Das Unternehmen war mit der Bereitstellung von Dienstleistungen f√ºr Bildungsorganisationen besch√§ftigt.  Es gab mehrere Anwendungen, die unterst√ºtzt werden mussten und sich nach und nach entwickelten.  Aber die Beh√∂rden von Glory glaubten nicht an seine Bem√ºhungen und die Tatsache, dass er sein Brot aus einem bestimmten Grund isst.  Dar√ºber hinaus wollten die Chefs der Informationstechnologie nicht wirklich, sondern wollten verstehen, was die Mitarbeiter taten und welche Art von Produktivit√§t die Verkaufsabteilung (die ich sagen muss, bestand aus eineinhalb Personen). <br><a name="habracut"></a><br>  Die Beh√∂rden sahen den Verkaufsleiter mit einem listigen Auge an und fragten: Was haben Sie heute f√ºr das Mutterland getan?  Der Verk√§ufer antwortete: hielt so viele Besprechungen ab, bot Dienstleistungen f√ºr so viele Menschen an.  Die F√ºhrung kam zu Glory und sagte: Sag mir, ob die Angestellten die Wahrheit sagen oder so, sie tragen einen Knebel.  Ben√∂tigen Sie Statistiken. <br><br>  Der Dialog fand statt: <br><br>  - Bezahlen Benutzer f√ºr den Dienst √ºber einen Drittanbieter, um Online-Zahlungen zu erhalten?  Also? <br>  - Also. <br>  - Hat die Unternehmensleitung Zugang zu diesem Service? <br>  - Es gibt. <br>  - Wahrscheinlich werden dort Zahlungen entladen. <br>  - Es gibt. <br>  "Aber brauchen Sie einen zus√§tzlichen Bericht?" <br>  - Ben√∂tigt. <br>  - Warum? <br>  - Weil es bequemer ist, weil Sie m√ºssen, weil "so und so". <br><br>  Fairerweise muss gesagt werden, dass zus√§tzliche Daten ben√∂tigt wurden. <br><br>  Ohne zu z√∂gern erf√ºllte Glory eine einfache Abfrage mit anschlie√üender Auswahl in Excel. <br><br>  Der Bericht war ein Datensatz in einer Spalte auf einer Seite.  Zuerst n√§herten sie sich mitten am Tag chaotisch Glory und fragten.  Aber gib mir einen Bericht √ºber diese Organisation und jetzt √ºber diese.  Ohne zu z√∂gern entschied Slava, dass es ausreichte, dies zu ertragen, und dass etwas Sch√∂nes und Einheitliches getan werden sollte, das die Bed√ºrfnisse derjenigen befriedigte, die darum baten. <br><br>  Es entstand ein kleines Skript, mit dem Newsletter an interessierte Personen gesendet werden konnten: <br><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> openpyxl, pymysql, os <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> smtplib <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> SMTP_SSL <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> email.mime.multipart <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> MIMEMultipart <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> email.mime.base <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> MIMEBase <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> email <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> encoders <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> datetime <span class="hljs-comment"><span class="hljs-comment"># Excel Settings today = datetime.date.today().strftime('%d.%m.%Y') excel_file = 'Oplata_polzovateley_' + today + '.xlsx' # SQL settings host = '' user = '' passwd = '' db = '' port=0000 headers = ['id', 'email', '', '', ' ', ' ', '', '- ', ' '] # SMTP Mail settings smtp_server = 'smtp.gmail.com' mail_login = '' mail_passwd = '' receiver = [''] cc = [''] def main(): # Fetch Data from SQL server conn = pymysql.connect(host=host, user=user, passwd=passwd, db=db, port=port) cursor = conn.cursor() cursor.execute('''select * from table''') data = cursor.fetchall() conn.close() # Write Data to Excel file wb = openpyxl.Workbook() contractors = {} for item in data: diff = item[6] - item[5] item = list(item) # print(item) if diff.days &gt; 10: item.append('') else: item.append('') item = tuple(item) if item[0][:30] in contractors: contractors[item[0][:30]] += 1 else: wb.create_sheet(item[0][:30]) contractors[item[0][:30]] = 2 for i in range(1, len(headers) + 1): letter = openpyxl.utils.get_column_letter(i) wb[item[0][:30]][letter + '1'] = headers[i - 1] wb[item[0][:30]]['A' + str(contractors[item[0][:30]])] = contractors[item[0][:30]] - 1 for i in range(2, len(headers) + 1): letter = openpyxl.utils.get_column_letter(i) wb[item[0][:30]][letter + str(contractors[item[0][:30]])] = item[i] wb.save(excel_file) wb.remove(wb['Sheet']) wb.save(excel_file) # Compose attachment part = MIMEBase('application', "octet-stream") part.set_payload(open(excel_file, "rb").read()) encoders.encode_base64(part) part.add_header('Content-Disposition', 'attachment; filename="%s"' % os.path.basename(excel_file)) # Compose message msg = MIMEMultipart() msg['From'] = mail_login msg['To'] = ', '.join(receiver) msg['Cc'] = ', '.join(cc) msg['Subject'] = excel_file msg.attach(part) # Send mail tosend = receiver + cc smtp = SMTP_SSL('smtp.gmail.com') smtp.connect(smtp_server) smtp.login(mail_login, mail_passwd) smtp.sendmail(mail_login, tosend, msg.as_string()) smtp.quit() # Wipe file os.remove(excel_file) if __name__ == '__main__': main()</span></span></code> </pre> <br>  Made dachte nat√ºrlich nicht wirklich an Ruhm.  Aber wie sie sagen: "Ah, und so wird es tun." <br><br>  Jeden Morgen kam Slava zur Arbeit, f√ºhrte ein Skript aus und schickte eine E-Mail an interessierte Parteien. <br>  Der n√§chste Schritt war das Einrichten des automatischen Sendens.  Es hat ungef√§hr so ‚Äã‚Äãfunktioniert: <br><br>  <i>Docker Build --tag = Berichte.</i> <i><br></i>  <i>Docker run -it --rm Berichte</i> <br>  Und in Worten in der Krone: <br>  <i>0 8 * * * Docker run --rm foo</i> <br><br>  Jeden Tag um 8 Uhr morgens ging der Brief.  Das Management war h√ºbsch und begann sogar zu glauben, dass Slava jeden Tag genau um 8 Uhr morgens zur Arbeit kam, einen Bericht in Excel verfasste und ihn dann per Post an seine H√§nde schickte.  Und er tat es am Samstag und Sonntag und im Schnee und im Regen und in der Polarnacht. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Github</a> <br><br>  Vorerst war f√ºr eine Weile alles in Ordnung und die F√ºhrung hielt an, aber nicht lange.  Es war einmal ein Treffen, bei dem eine neue Bestellung angek√ºndigt wurde.  H√∂ren Sie zu, h√∂ren Sie zu und sagen Sie nicht, dass Sie nicht geh√∂rt haben.  Sim erkl√§rt, dass jeder Mitarbeiter jeden Tag einem h√∂heren und noch h√∂heren Rang Bericht erstatten muss.  Nun, im Allgemeinen verstehen Sie. <br><br>  "Jeden Tag?", Fragte Glory. <br>  - T√§glich.  - antwortete der Leiter der technischen Abteilung. <br>  - Oder vielleicht auch nicht? <br>  - Es ist notwendig Ruhm, es ist notwendig. <br><br>  Slava hatte mehrere Fragen zu dieser Situation.  Die unmittelbare Verantwortung bestand darin, die Software fertigzustellen, und ihre Berichte sollten wie folgt bestehen: <br>  <b>feat (Modul) Ein Fehler in NoteLineCount wurde behoben ... nicht ernsthaft ...</b> <b><br></b>  <b>upd (Modul2) Achten Sie nicht auf den Mann hinter dem Vorhang</b> <b><br></b>  <b>behoben (Modul 3) Mir wurde gesagt, ich solle es in Ruhe lassen, aber ich habe dieses Ding namens OCD, verstehen Sie?</b> <br>  * Hinweis: Der Name der Nachrichten an Commits <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">wird von hier √ºbernommen</a> <br><br>  Glory beschloss, einen darauf basierenden Bericht zu erstellen.  Eine Woche ist vergangen.  Es fand ein neues Gespr√§ch √ºber folgenden Inhalt statt: <br><br>  - Sie senden also jeden Tag Berichte, aber es sind keine Fortschritte sichtbar.  Was zum Beispiel ist: "Bei der Eingabe einer Telefonnummer am Frontend wurde eine Maske hinzugef√ºgt". <br>  - Schau mal.  Zuvor mussten Sie Ihre Telefonnummer eingeben und die Anzahl der Ziffern √ºberpr√ºfen, was unpraktisch war.  Und so ist es bequem. <br>  - Hm.  Gut.  Ich verstehe.  Und wie erkl√§ren Sie das: ‚ÄûCode Refactoring f√ºr das Modul Gegenparteien.  Die Funktion zur Validierung erfolgt in einer separaten Methode. ‚Äú <br>  - Siehst du?  Es gibt so etwas - ein Versionskontrollsystem, das anzeigt, wer, wann und was getan hat.  Schau hier.  Hier sind die Commits und hier ist der Code, der ge√§ndert wurde.  Hier wird der Code hinzugef√ºgt, hier wird der Code gel√∂scht. <br>  - Gut.  Dann lass es uns tun.  Machen Sie einen Bericht basierend auf diesen Ihrer Verpflichtungen, und dann werden wir uns zusammensetzen und pr√ºfen, wie ja, was Sie dort geschrieben haben. <br><br>  Am Ende - das ist passiert: <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b>Github</b></a> <br><br>  Das Skript nahm √Ñnderungen im Repository vor und schickte einen Brief dar√ºber, was getan wurde und was nicht. <br><br>  Zuvor war es Slava peinlich zu berichten, dass diejenigen, die √ºberhaupt nichts √ºberpr√ºfen, nicht verstehen, wie man Code schreibt.  Vielleicht versteht das Management Verk√§ufe, Eink√§ufe und alles M√∂gliche und zahlt Geld, aber Sie werden bestimmte Codezeilen in einer nicht sehr vertrauten Sprache sehen und beobachten, wie die gr√ºnen und roten Linien beim Wechsel von Commit zu Commit flackern. <br><br>  Ja, Slava ist eine verantwortliche Person und die Arbeit hat funktioniert, aber es gab Tage, an denen der Code kaum fertiggestellt wurde oder es Faulheit war.  Im Allgemeinen funktionierte das System jedoch ohne Fehler und wollte keine weiteren 15 Abstraktionsebenen hinzuf√ºgen, sondern es mussten t√§glich Berichte gesendet werden. <br><br>  Es blieb nichts anderes √ºbrig, als ein neuer Mayakovsky zu werden und einen Knebel mit einer Leiter zu schreiben.  Aber ich wollte nicht jeden Tag einen neuen erfinden.  Infolgedessen begann Vyacheslav mit der Entwicklung der ersten L√∂sung, die mir in den Sinn kam, und stellte sich als einfacher Code heraus, in dem ein Bericht erstellt wurde, in dem keine Arbeit geleistet und √Ñnderungen vorangetrieben wurden.  Es sah ungef√§hr so ‚Äã‚Äãaus: <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Github</a> <br><br>  Es blieb zu tun, damit ein gef√§lschter Code mit nachfolgenden Commits gebildet wurde.  Muss das getan werden?  Die Zeit wird zeigen. <br><br>  PS: Die Geschichte von Glory endete nicht dort.  Es gab mehrere weitere Ereignisse, die sein Schicksal beeinflussten, aber dies ist eine ganz andere Geschichte.  Es ist interessant, in den Kommentaren √§hnliche Geschichten aus dem Leben und die Entscheidungen zu lesen, die auf ihrer Grundlage getroffen wurden.  Es ist m√∂glich, dass das Projekt auf der Grundlage dieser Kommentare weiterentwickelt wird. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de446740/">https://habr.com/ru/post/de446740/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de446728/index.html">Wie sich die vom kabellosen Laden empfangene Leistung √§ndert, h√§ngt vom Standort des Telefons ab</a></li>
<li><a href="../de446730/index.html">Backend-Bereich zu DUMP: Serverless, Postgres and Go, .NET Core, GraphQL und mehr</a></li>
<li><a href="../de446732/index.html">Feropoden werden nicht helfen: Forschung und mathematische Modellierung von Grubenfallen f√ºr Ameisenl√∂wenlarven</a></li>
<li><a href="../de446736/index.html">Oracle APEX Berichte</a></li>
<li><a href="../de446738/index.html">Grundlagen der Verarbeitung nat√ºrlicher Sprache f√ºr Text</a></li>
<li><a href="../de446742/index.html">Themen der Top 3D Expo 2019: ‚ÄûAnisoprinting - die Technologie zur Herstellung von Verbundstrukturen einer neuen Generation‚Äú, Fedor Antonov</a></li>
<li><a href="../de446744/index.html">VR mit neuronalen Schnittstellen - ein vollst√§ndiges Eintauchen in die virtuelle Realit√§t</a></li>
<li><a href="../de446746/index.html">Ein UBS-Mitarbeiter hat ein Gespr√§ch √ºber einen Nachbarn des Eurostar-Zuges mitgeh√∂rt und einen Deal √ºber 15 Milliarden US-Dollar herausgefunden. Jetzt werden er und die Bank mit einer Geldstrafe belegt</a></li>
<li><a href="../de446750/index.html">Nachrichten von unten: IT-Giganten haben begonnen, aktiv ihre eigenen U-Boot-Backbone-Netzwerke aufzubauen</a></li>
<li><a href="../de446752/index.html">Tracing Services, OpenTracing und Jaeger</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>