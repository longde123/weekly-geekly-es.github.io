<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üïï üîØ üíÖüèΩ O que voc√™ pode aprender ao desenvolver um reprodutor de √°udio para diferentes navegadores üí∑ üå™Ô∏è üë®‚Äçüç≥</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Esta hist√≥ria come√ßou cerca de 1,5 anos atr√°s. Est√° associado √† reprodu√ß√£o de m√∫sica em v√°rios navegadores e plataformas nas quais eles s√£o executados...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>O que voc√™ pode aprender ao desenvolver um reprodutor de √°udio para diferentes navegadores</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/438952/">  Esta hist√≥ria come√ßou cerca de 1,5 anos atr√°s.  Est√° associado √† reprodu√ß√£o de m√∫sica em v√°rios navegadores e plataformas nas quais eles s√£o executados.  Um caminho cheio de <s>‚Äúdor e sofrimento‚Äù da</s> percep√ß√£o de que uma tarefa f√°cil √† primeira vista pode n√£o ser t√£o f√°cil, e detalhes ‚Äúinsignificantes‚Äù aos quais voc√™ n√£o d√° import√¢ncia desde o in√≠cio, podem afetar tudo. <br><a name="habracut"></a><br><div class="spoiler">  <b class="spoiler_title">Pequenos detalhes para os mais curiosos :)</b> <div class="spoiler_text"> 1. Baixando dados da pr√≥xima faixa da rede. <br>  2. Para cada elemento do √°udio: novo √Åudio () ou &lt;audio&gt;, voc√™ precisa da permiss√£o do usu√°rio - uma a√ß√£o do usu√°rio na p√°gina. <br></div></div><br><h3>  Antecedentes </h3><br>  Provavelmente todo mundo que j√° escreveu um reprodutor de √°udio para navegadores pelo menos uma vez na vida encontrou o problema de compatibilidade entre navegadores e plataformas. <br><br>  Ent√£o, enquanto trabalhava no novo MVP, deparei-me com v√°rios recursos relacionados √† reprodu√ß√£o de √°udio nos navegadores. <br><br>  E tudo come√ßou com o fato de que era necess√°rio fazer um crossfade suave de duas faixas durante a reprodu√ß√£o - esse √© o primeiro recurso.  Nossa equipe queria mudar de faixa, como no r√°dio.  E o segundo recurso - cada faixa subseq√ºente √© solicitada da rede. <br><br><img src="https://habrastorage.org/webt/7h/o6/4h/7ho64hihtgz3atuttk1vm0mucpq.png"><br><br><h3>  Pesquisas </h3><br>  Ent√£o, quase todos os nossos projetos usaram a biblioteca do Sound Manager 2. <br><br>  Quase imediatamente, voc√™ percebe que a reprodu√ß√£o de dois arquivos de √°udio simultaneamente em dispositivos m√≥veis n√£o funciona da mesma maneira em todos os lugares! <br><br>  No Chrome (vers√£o ~ 62) para PC, as faixas eram reproduzidas como deveriam.  Em dispositivos m√≥veis (tamb√©m no Chrome), a reprodu√ß√£o da faixa funcionou, mas apenas com a tela ativa.  Quando a tela estava bloqueada, a pr√≥xima faixa depois que o player atual n√£o foi reproduzido.  Quanto ao iOS / macOS, a reprodu√ß√£o funcionou de maneira semelhante.  Mais informa√ß√µes podem ser obtidas <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> - se√ß√£o ‚ÄúSingle Audio Stream‚Äù. <br><br>  Ent√£o, come√ßou a <s>andar por tr√™s mares</s> procurando informa√ß√µes pouco a pouco sobre os recursos dos navegadores com √°udio. <br><br>  Ok, estou tentando uma solu√ß√£o com o √°udio da web sem usar nenhuma biblioteca.  Sim, esta tecnologia √© destinada a outros fins: s√≠ntese, processamento de som, para jogos, etc., em vez de simplesmente reproduzir faixas.  Mas para o experimento, foi necess√°rio tentar, pois permite compor sons de diferentes fontes em uma √∫nica <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">sa√≠da de √°udio</a> - alto-falantes / fones de ouvido / alto-falante do telefone / etc.  Existem pessoas que est√£o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">pesquisando</a> propositadamente <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">as</a> possibilidades de reproduzir som em dispositivos m√≥veis usando a API de √°udio da Web. <br><br>  Ap√≥s a implementa√ß√£o, certas nuances ficaram claras. <br><br>  Primeiro, voc√™ deve esperar at√© que a faixa inteira esteja totalmente carregada.  Com uma conex√£o lenta √† Internet, as pausas ser√£o vis√≠veis devido ao fato de que a segunda faixa pode n√£o ter tempo para carregar at√© o final da primeira faixa.  O download completo pode ser evitado usando um monte de tags de √°udio HTML5 que funcionar√£o como fontes de som para o √°udio da Web, mas, nesse caso, torna-se imposs√≠vel reproduzir dois sons simultaneamente. <br><br>  Em segundo lugar, se voc√™ baixar uma faixa pela rede em fragmentos e decodific√°-los programaticamente, isso aumenta a carga na CPU.  Era aceit√°vel para um PC, mas cr√≠tico para dispositivos m√≥veis. <br><br>  Em terceiro lugar, houve problemas com a decodifica√ß√£o.  Se fragmentos de arquivos mp3 / ogg / wav chegavam ao cliente, essas pe√ßas eram silenciosamente <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">decodificadas</a> e reproduzidas.  Mas se peda√ßos do arquivo mp4, que atuavam como um cont√™iner para HE-AAC, chegassem ao navegador, eles n√£o poderiam ser decodificados.  Isso tamb√©m se aplica, em certa medida, ao navegador Opera, no qual a reprodu√ß√£o de arquivos MP3 √© inst√°vel de vers√£o para vers√£o - algumas vezes, ela √© reproduzida e d√° um erro que esse formato n√£o √© suportado. <br><br>  Quarto, o nome da faixa n√£o foi exibido / n√£o foi alterado na tela bloqueada em um prato com um reprodutor de √°udio nativo (no iPad), incl.  ao alternar entre faixas.  Talvez devido ao fato de que os testes usaram o iPad com a vers√£o 9 do iOS - n√£o havia outro na √©poca. <br><br>  Como resultado, nesse est√°gio, o Web Audio teve que ser abandonado.  Ainda assim, o crossfade n√£o √© para navegadores, composi√ß√µes musicais padr√£o de boa qualidade pesam bastante. <br><br>  Como recusamos o crossfade, implementamos um simples fade in e fade out, no in√≠cio e no final da faixa de m√∫sica, respectivamente. <br><br>  O c√≥digo do ano anterior foi ligeiramente modificado e testado.  Como resultado dos testes, surgiram v√°rias nuances (mostradas na tabela).  Tudo isso usando a biblioteca do Sound Manager 2. <br><br><img src="https://habrastorage.org/webt/b5/bj/wg/b5bjwgh2mds3pn1x8ghbp3nuyue.png"><br><br>  Adicionamos o registro de todos os eventos para determinar o momento da transi√ß√£o entre as faixas e para entender em que ponto eles param de tocar. <br><br><img src="https://habrastorage.org/webt/z_/nr/0g/z_nr0g8j0zxskeevs2e3loddlok.png"><br><br><div class="spoiler">  <b class="spoiler_title">Ativa√ß√£o da guia</b> <div class="spoiler_text">  No Safari 9+, o som nem sempre aparece quando a guia √© ativada. <br></div></div><br>  A partir disso, pode-se supor que a execu√ß√£o de JS em segundo plano esteja otimizando ou que o encadeamento de execu√ß√£o pare completamente (eventos e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">timers</a> ).  No entanto, ficar√° claro mais tarde que essa foi parcialmente uma conclus√£o correta.  A seguir, consideraremos outra nuance associada √† reprodu√ß√£o de faixas e √† compreens√£o de por que o som n√£o aparece. <br><br><div class="spoiler">  <b class="spoiler_title">Observa√ß√£o</b> <div class="spoiler_text">  Para trabalhar com o progresso (barra de progresso), por exemplo, renderizando-o para uma faixa, √© bom usar requestAnimationFrame em vez de setInterval / setTimeout.  Voc√™ pode evitar o efeito cumulativo ao desativar (guia plano de fundo), ativar a guia e congel√°-la temporariamente, associado a todos os c√°lculos e redesenhar o estado do progresso. <br></div></div><br>  No mesmo momento, surgiu a pergunta: e a reprodu√ß√£o autom√°tica de faixas em um PC e em dispositivos m√≥veis? <br><blockquote>  A reprodu√ß√£o autom√°tica refere-se ao in√≠cio autom√°tico da reprodu√ß√£o de uma faixa sem nenhuma a√ß√£o do usu√°rio ao carregar uma p√°gina. <br></blockquote>  Quanto ao Safari em rela√ß√£o √† <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">reprodu√ß√£o autom√°tica</a> quando a p√°gina √© carregada, isso n√£o √© poss√≠vel, voc√™ precisa da <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">intera√ß√£o do usu√°rio</a> com a p√°gina, como em <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">dispositivos m√≥veis</a> .  Isso se aplica ao <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">conte√∫do de v√≠deo</a> e ao <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">√°udio</a> . <br><br>  E ent√£o, naquela √©poca, havia o seguinte: <br><br><ol><li>  √© imposs√≠vel (n√£o desej√°vel) reproduzir dois ou mais sons ao mesmo tempo; </li><li>  para a pseudo ‚Äúreprodu√ß√£o autom√°tica‚Äù da faixa, √© necess√°ria a permiss√£o do usu√°rio - a primeira intera√ß√£o, mais tarde foi chamada de ‚Äúvender um dedo para o dispositivo‚Äù; </li><li>  em segundo plano (guia plano de fundo / tela de bloqueio) JS (tudo depende do navegador): <br>  ou congela completamente; <br>  qualquer estrangulamento; <br>  ou funciona da mesma forma que na guia ativa; <br></li><li>  Voc√™ pode iniciar automaticamente a reprodu√ß√£o sem som, mas n√£o est√° claro por que (para conte√∫do de √°udio)? </li><li>  em algum lugar distante, o pensamento come√ßa a aparecer, mas como fazer o JS continuar executando em segundo plano? </li></ol><br>  Outras bibliotecas que implementam as fun√ß√µes do player assumiram que talvez haja uma solu√ß√£o para esse problema.  Apesar do fato de que muitos problemas foram observados no GitHub com uma descri√ß√£o de problemas ao reproduzir faixas em v√°rios navegadores, ainda havia esperan√ßa de que voc√™ estava prestes a chegar ao fundo: por que n√£o funciona e como faz√™-lo funcionar.  Como se viu, n√£o ... <br><br>  Alguns exemplos de c√≥digo com demonstra√ß√£o em v√≠deo do trabalho das bibliotecas: <br><br><ol><li>  Sound Manager 2 - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">p√°ginas do</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">github</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">reposit√≥rio do github</a> , v√≠deo: <a href="">macOS Safari 12</a> ;  <a href="">iOS Safari 10</a> com tela desbloqueada </li><li>  Furo <br>  Howler v2.0.9 - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">p√°ginas do github</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">reposit√≥rio do github</a> , v√≠deo: <a href="">macOS Safari 12</a> , <a href="">iOS Safari 10</a> <br>  Howler v2.0.15 - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">p√°ginas do</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">github</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">reposit√≥rio do github</a> , v√≠deo: <a href="">macOS Safari 12</a> <br>  Howler v2.1.1 - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">p√°ginas do github</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">reposit√≥rio do github</a> , v√≠deo: <a href="">macOS Safari 12</a> , <a href="">iOS Safari 10</a> <br></li></ol><br><blockquote>  Para o macOS, a grava√ß√£o de v√≠deo foi feita sem som; portanto, voc√™ precisa observar o indicador de volume - a imagem do alto-falante na guia. <br><br>  Mais v√≠deos de exemplo est√£o dispon√≠veis no reposit√≥rio. <br><br>  No exemplo interativo do Howler v2.1.1 - √†s vezes voc√™ pode ouvir v√°rios sons ao mesmo tempo, isso se deve √† adi√ß√£o de um conjunto de elementos de √°udio desbloqueados pelo usu√°rio (isso deve ser corrigido em vers√µes futuras da biblioteca). <br></blockquote>  Qual √© o motivo da inoperabilidade dessas bibliotecas? <br><br>  Escrevi acima: <i>‚ÄúNo plano de fundo (guia plano de fundo), o JS congela completamente ou sofre uma limita√ß√£o</i> . <i>‚Äù</i>  Ent√£o, aqui outro ponto aparece: as bibliotecas no c√≥digo usam a cria√ß√£o de novos objetos de √°udio via novo Audio ().  Se eles s√£o criados dinamicamente, ou seja,  se um objeto de √°udio existente n√£o for usado e o usu√°rio n√£o interagir com o site de qualquer forma, a guia estiver inativa ou a tela estiver bloqueada, alguns navegadores poder√£o considerar que o som desse elemento de √°udio n√£o deve ser reproduzido at√© que a guia esteja ativa novamente ou o usu√°rio n√£o qualquer a√ß√£o. <br><br>  Um exemplo de teste nas <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">p√°ginas do github</a> e no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">reposit√≥rio do github</a> usando o novo Audio ().  V√≠deo: <a href="">macOS Safari 12</a> ;  <a href="">iOS Safari 10</a> com tela desbloqueada. <br><br>  <b>Parece que n√£o existe algum tipo de ferramenta universal e √© necess√°rio procurar outra solu√ß√£o de compromisso.</b> <br><br>  Ent√£o sentamos com os caras da equipe para discutir, e o que √© realmente importante no trabalho do reprodutor de √°udio?  Pois seria poss√≠vel continuar os experimentos ad infinitum, mas precisamos seguir em frente. <br><br>  Primeiro, foram identificados pontos importantes que impediam a obten√ß√£o do resultado desejado: <br><br><ol><li>  O Safari no macOS n√£o reproduz faixas quando a guia est√° inativa; </li><li>  n√£o h√° possibilidade de ouvir m√∫sica em segundo plano (quando a tela est√° bloqueada) em smartphones executando iOS e Android, gostaria de evitar o redirecionamento agressivo de usu√°rios para um aplicativo m√≥vel (no futuro), pois a experi√™ncia anterior mostra que uma grande parte dos usu√°rios n√£o deseja instalar um aplicativo m√≥vel ; </li><li>  o player n√£o funciona corretamente com uma lista de reprodu√ß√£o din√¢mica, ou seja,  quando n√£o se sabe de antem√£o qual ser√° a pr√≥xima faixa. </li></ol><br>  Al√©m disso, permitiu formular as metas necess√°rias para alcan√ßar: <br><br><ol><li>  fornecer o player em segundo plano - em v√°rios navegadores e em v√°rias plataformas; </li><li>  permitir ao usu√°rio escolher o que usar: ouvir m√∫sica no site ou no aplicativo m√≥vel; </li><li>  fornecer a capacidade de usar o player (ou abordagem) em v√°rios projetos futuros. </li></ol><br>  Uma nova etapa na busca de uma solu√ß√£o para o problema j√° come√ßou.  Nesse est√°gio, v√°rias bibliotecas n√£o eram mais usadas; todos os estudos foram conduzidos usando o HTML5 Audio.  O resultado foi que uma op√ß√£o foi encontrada usando <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">trabalhadores dedicados</a> .  O iOS n√£o permitiu que essa decis√£o vencesse novamente - a reprodu√ß√£o em segundo plano n√£o funciona, mas acabou funcionando no Android (Chrome, Opera, Safari). <br><br>  Exemplo de teste de HTML5 Audio + Dedicated Workers <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">nas p√°ginas do github</a> e no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">reposit√≥rio do github</a> . <br><br>  Quando o Worker √© inicializado, s√£o solicitados dados sobre a trilha atual.  O Worker tamb√©m envia um sinal para obter o status do progresso - por quanto tempo a faixa √© reproduzida - do fluxo principal e decide quando solicitar dados sobre a pr√≥xima faixa da rede com base nesses dados. <br><br><img src="https://habrastorage.org/webt/ln/t0/sh/lnt0shcslejecuvcenkh-rlv28y.png"><br><br>  Tamb√©m naquela √©poca, o exemplo a seguir foi testado ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">p√°ginas do github</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">reposit√≥rio do</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">github</a> ), quando a tag de √°udio HTML5 √© incorporada no DOM (v√≠deo: <a href="">macOS Safari 12</a> , <a href="">iOS Safari 10</a> ) e simplesmente substitui o SRC ao alternar entre faixas.  At√© o momento, no macOS no Safari 12, este exemplo funciona.  Infelizmente, agora n√£o h√° como testar a funcionalidade deste exemplo no macOS no Safari 10 e 11, mas naquele momento esse exemplo n√£o funcionava durante os testes ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">pol√≠ticas de</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">reprodu√ß√£o autom√°tica</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">restri√ß√µes de reprodu√ß√£o autom√°tica</a> ). <br><br>  Para resumir, para iOS e macOS, o navegador Safari n√£o considera uma nova inst√¢ncia do elemento de √°udio a ser ativada pelo usu√°rio se ele foi criado em segundo plano dentro de um evento, por exemplo, ajax, setTimeout, recomendado. <br><br>  Al√©m disso, em rela√ß√£o √† reprodu√ß√£o de faixas no iOS Safari e no iOS Chrome, foi poss√≠vel reproduzir faixas em segundo plano (quando a tela est√° bloqueada) usando apenas <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">HLS</a> .  Para plataformas iOS e macOS, esse formato √© padr√£o e a transmiss√£o √© suportada pelo sistema operacional.  Para o Android Chrome e Edge, uma implementa√ß√£o nativa tamb√©m est√° dispon√≠vel.  E para PCs no Chrome, voc√™ pode usar manipuladores de software, por exemplo, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">hls.js</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Bitmovin Player</a> , etc. <br><br>  Um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">link para o reposit√≥rio do github</a> fornece um exemplo de c√≥digo que abrange o caso de uso mais simples - simplesmente reproduzindo o fluxo gerado no servidor sem a capacidade de retroceder, alternar para a pr√≥xima faixa etc.  S√£o apresentados exemplos usando: a marca de √°udio, a marca de v√≠deo, a biblioteca hls.js e o player do Bitmovin.  Este conte√∫do requer Node.js. <br><br><h3>  Conclus√µes </h3><br>  Infelizmente, o primeiro ponto, por causa da variedade de navegadores, n√£o existe uma solu√ß√£o universal que permita ouvir m√∫sica em navegadores igualmente bem em todos os lugares.  Em todos os lugares existem limita√ß√µes e, como mostra a pr√°tica, voc√™ pode conviver confortavelmente com elas. <br><br>  O segundo ponto, √†s vezes vale a pena verificar casos lim√≠trofes o mais r√°pido poss√≠vel, por exemplo, uma implementa√ß√£o nativa.  Encontre algum tipo de conjunto de requisitos minimamente aceit√°vel e verifique rapidamente seu desempenho, em vez de tomar qualquer biblioteca como base.  Isso dar√° mais entendimento de como essas bibliotecas s√£o organizadas internamente e por que certas fun√ß√µes funcionam ou n√£o.  Caso contr√°rio, voc√™ pode ir muito longe no projeto e depois de perceber que algo est√° errado.  E pode acontecer que abandonar a biblioteca seja bastante caro.  Uma parte significativa do c√≥digo precisar√° ser reescrita. <br><br>  O terceiro ponto, preste aten√ß√£o ao p√∫blico do seu servi√ßo - de onde s√£o os navegadores e os sistemas operacionais de seus usu√°rios.  Isso √© bastante f√°cil de rastrear usando v√°rias m√©tricas e sistemas de monitoramento de erros.  Essa abordagem ajudar√° a entender quais plataformas e navegadores √© importante oferecer suporte e quais podem ser usados ‚Äã‚Äãsem nenhum esfor√ßo. <br><br><h4>  E finalmente </h4><br>  Estou anunciando um pequeno concurso relacionado √† reprodu√ß√£o de m√∫sica no iOS usando a tecnologia HLS. <br><br>  A descri√ß√£o pode ser vista no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">link no github</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt438952/">https://habr.com/ru/post/pt438952/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt438940/index.html">Curso aberto ‚ÄúDeep Learning on the finger‚Äù</a></li>
<li><a href="../pt438942/index.html">Sombras 2D em campos de dist√¢ncia assinada</a></li>
<li><a href="../pt438946/index.html">DateTimeOffset (Strict)</a></li>
<li><a href="../pt438948/index.html">Por que precisamos de otimiza√ß√£o de baixo n√≠vel no Elbrus ou como acelerar o sistema de reconhecimento uma vez e meia</a></li>
<li><a href="../pt438950/index.html">O Banco Central lan√ßou um rob√¥ para procurar esquemas de ganhos na Internet</a></li>
<li><a href="../pt438954/index.html">Combinando campos de dist√¢ncia assinada em 2D</a></li>
<li><a href="../pt438956/index.html">Magnetite nos dentes: sequenciamento de transcriptomas do tecido da radula do molusco concha</a></li>
<li><a href="../pt438958/index.html">A ILV confirmou a exist√™ncia de sua "esta√ß√£o espacial"</a></li>
<li><a href="../pt438960/index.html">Como desisti do Ruby em favor do Python enquanto trabalhava em um back-end</a></li>
<li><a href="../pt438962/index.html">Na maioria das vezes, uma perspectiva positiva para o futuro dos chips</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>