<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üö¢ üôãüèæ ‚úçÔ∏è DNS reencaminhar em 2k19, ou como realmente suar, visitando um site porn√¥ üë©üèº‚Äçü§ù‚Äçüë®üèø üëü üñêÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ol√° pessoal! Hoje, gostar√≠amos de falar sobre um ataque antigo e quase esquecido chamado religa√ß√£o de DNS. A primeira conversa sobre o assunto come√ßou...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>DNS reencaminhar em 2k19, ou como realmente suar, visitando um site porn√¥</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/fbk_cs/blog/439522/"><p><img src="https://habrastorage.org/webt/ro/dg/v9/rodgv9iuu_71gel5eqwpydcaj9m.jpeg"></p><br><p>  Ol√° pessoal!  Hoje, gostar√≠amos de falar sobre um ataque antigo e quase esquecido chamado religa√ß√£o de DNS.  A primeira conversa sobre o assunto come√ßou em 2007, mas especialistas da √°rea de seguran√ßa da informa√ß√£o n√£o prestaram a devida aten√ß√£o em rela√ß√£o √†s peculiaridades da opera√ß√£o desse ataque, bem como com poucas consequ√™ncias tang√≠veis, como parecia ent√£o.  Hoje, tentaremos convenc√™-los do contr√°rio, e voc√™, em particular, demonstrando que no mundo moderno esse ataque encontrou um segundo vento e n√£o parece mais t√£o inofensivo. </p><a name="habracut"></a><br><h2 id="chto-takoe-dns-rebinding">  O que √© a religa√ß√£o DNS? </h2><br><p>  Considere o seguinte esquema: </p><br><p><img src="https://habrastorage.org/webt/sr/w6/i8/srw6i8sjgtnecyqfkq6sfndcvrs.png"></p><br><p>  Temos o computador de uma v√≠tima com IP 192.168.0.2 na rede local e tamb√©m possui um roteador com o endere√ßo IP 192.168.0.1.  O objetivo do invasor que gerencia o servidor com o endere√ßo 13.37.13.37 e o nome de dom√≠nio hacker.com (tamb√©m, nosso servidor DNS que cont√©m informa√ß√µes sobre o dom√≠nio est√° girando no ip-shnik) √© obter acesso ao roteador na rede local. </p><br><p>  Para usar a t√©cnica de religa√ß√£o do DNS, precisamos atrair a v√≠tima para o nosso site malicioso.  Suponha que tenhamos sucesso. </p><br><p>  Vamos agora examinar em detalhes como o ataque funciona. </p><br><p>  Primeiro de tudo, o navegador acessa os servidores DNS com uma solicita√ß√£o de registro A: </p><br><p><img src="https://habrastorage.org/webt/ry/op/4y/ryop4y_9c5m0goj-iygirncutbm.png"></p><br><p>  A cadeia de servidores DNS leva ao nosso servidor, que, por sua vez, fornece uma resposta padr√£o contendo o verdadeiro endere√ßo IP do site malicioso e tamb√©m indica o TTL necess√°rio, neste caso 59. </p><br><p><img src="https://habrastorage.org/webt/18/yt/k9/18ytk9njpok5flotf7axbydovpy.png"></p><br><p>  Em seguida, o navegador faz uma solicita√ß√£o HTTP padr√£o para o IP recebido. </p><br><p><img src="https://habrastorage.org/webt/lc/e8/xd/lce8xd7yfinhsyodhqxtpa8yerm.png"></p><br><p>  Na pr√≥xima etapa, o servidor responde com uma p√°gina HTML com c√≥digo javascript acessando nosso pr√≥prio dom√≠nio. </p><br><p><img src="https://habrastorage.org/webt/ix/r6/h1/ixr6h19bqirekyafut2tlstyfgc.png"></p><br><p>  Agora, at√© que o TTL expire e o usu√°rio esteja no site, o javascript recebido acima ser√° executado.  Quando o TTL terminar, o navegador solicitar√° novamente um registro A. </p><br><p><img src="https://habrastorage.org/webt/-n/1b/dx/-n1bdxxgxatewjyou0gdfxkiv1w.png"></p><br><p>  No momento, nosso javascript continua em execu√ß√£o, e o servidor DNS que gerenciamos responder√° com um registro A com um endere√ßo IP da rede local, onde o invasor deseja acessar. </p><br><p><img src="https://habrastorage.org/webt/mw/pg/lc/mwpglcv_8-ydxsitnzv86gugvqo.png"></p><br><p>  Como o dom√≠nio, porta e protocolo permanecem inalterados, o SOP n√£o √© violado e, como resultado, o navegador acessa o dom√≠nio pew.hacker.com, no entanto, ele j√° bate no roteador cobi√ßado e inating√≠vel. </p><br><p><img src="https://habrastorage.org/webt/-c/df/qk/-cdfqkxy1xyjp6gftrd9wmtg6wy.png"></p><br><p>  Como resultado, recebemos com calma uma resposta do roteador e a redirecionamos para n√≥s mesmos, incorporando a funcionalidade correspondente no c√≥digo javascript carregado anteriormente. </p><br><p><img src="https://habrastorage.org/webt/se/5o/wf/se5owf2cq4n0o8kzxdu-d583kno.png"></p><br><p><img src="https://habrastorage.org/webt/f4/s2/br/f4s2brt6sckd8lf6__rlrpdw5me.png"></p><br><p>  Ent√£o, vamos resumir o acima: </p><br><ul><li>  O usu√°rio visita o site, recebendo um endere√ßo IP real e um pequeno TTL </li><li>  Enquanto estiver no site, o navegador faz chamadas para o mesmo dom√≠nio em que o usu√°rio est√° localizado.  Assim que o cache expira, o navegador solicita novamente o IP do dom√≠nio. </li><li>  Al√©m disso, nosso servidor DNS emite, em vez do endere√ßo real, o endere√ßo IP do servi√ßo interno (no nosso caso, o roteador) </li><li>  Depois que a solicita√ß√£o passa pelo dom√≠nio para o roteador, e o resultado √© enviado a n√≥s pelo javascript pr√©-carregado pelo usu√°rio com anteced√™ncia. </li></ul><br><p>  N√≥s descobrimos isso!  Muitos podem ter uma pergunta razo√°vel: ‚ÄúE da√≠?‚Äù, Porque, para opera√ß√£o, voc√™ precisa conhecer os endere√ßos IP internos dos servi√ßos, manter o usu√°rio por um certo tempo, etc. </p><br><p>  Sim, no entanto, com o advento de servi√ßos de streaming, hospedagem de v√≠deo, bons sites pornogr√°ficos antigos e outras plataformas onde as pessoas permanecem por muito tempo, o invasor ter√° tempo suficiente para realizar o ataque.  Quanto aos endere√ßos, eles geralmente s√£o padr√£o ou facilmente previs√≠veis. </p><br><p>  Mas isso √© tudo na teoria, mas o que na pr√°tica?  Selecionamos as 4 √°reas mais relevantes em 2019, onde houve incidentes relacionados ao ataque de religa√ß√£o do DNS, s√£o eles: </p><br><ul><li>  IoT </li><li>  Carteiras de criptografia </li><li>  Aplicativos de desktop </li><li>  Nuvens </li></ul><br><p>  Vamos analisar cada t√≥pico em ordem e descobrir se tudo √© realmente t√£o inofensivo? </p><br><h2 id="iot">  Iot </h2><br><h3 id="google-home">  P√°gina inicial do Google </h3><br><p><img src="https://habrastorage.org/webt/xk/uj/oh/xkujohaktco1mi9aau3im3fjk7e.png"></p><br><p>  O Google home √© um assistente inteligente do Google.  Este dispositivo possui (ou possu√≠a no passado) uma API que n√£o requer autentica√ß√£o para controlar o dispositivo.  Ele fornece v√°rios recursos, como: </p><br><ul><li>  Reproduzindo conte√∫do </li><li>  Digitalizar </li><li>  Reiniciar </li><li>  Conex√£o a redes Wi-Fi, etc. </li></ul><br><p>  Exemplo de cen√°rio de ataque: um invasor pode desarmar o nome do usu√°rio obtendo as coordenadas dos pontos WIFI mais pr√≥ximos.  Obviamente, nenhuma VPN pode salv√°-lo. </p><br><h3 id="sonos-wifi-speakers">  Alto-falantes wifi Sonos </h3><br><p><img src="https://habrastorage.org/webt/mw/bo/xr/mwboxrh0zhpjewbcxgrw6kn4krg.png"></p><br><p>  Essas colunas do Sonos geram um servidor web na rede local UPnP, que d√° acesso a v√°rias p√°ginas interessantes: </p><br><ul><li>  192.168.1.76:1400/support/review - cospe a sa√≠da de alguns comandos UNIX </li><li>  192.168.1.76:1400/tools - permite executar alguns comandos UNIX </li></ul><br><p>  Nesse caso, o invasor tem a capacidade de executar o comando traceroute para verificar a topologia da rede interna. </p><br><h3 id="radio-thermostat-ct50">  Termostato de r√°dio CT50 </h3><br><p><img src="https://habrastorage.org/webt/0f/uh/b9/0fuhb9kozjqucxdf9v-qxz1rvgc.png"></p><br><p>  Este √© um dos nossos casos favoritos.  Este modelo de termostato tamb√©m possui uma API sem qualquer autoriza√ß√£o e permite alterar: </p><br><ul><li>  Modo Clima </li><li>  Temperatura </li><li>  Modo luz de fundo e outras configura√ß√µes </li></ul><br><p>  Como resultado, um atacante pode suar bastante a v√≠tima, mas falando s√©rio, esse ataque a um termostato, por exemplo, em uma instala√ß√£o m√©dica, pode levar a conseq√º√™ncias bastante desagrad√°veis. </p><br><h3 id="roku-tv">  Roku tv </h3><br><p><img src="https://habrastorage.org/webt/h3/7g/2d/h37g2dtzcz-6yiq0wqjuytjl0rw.png"></p><br><p>  As TVs Roku ainda t√™m a mesma doen√ßa - uma API sem autentica√ß√£o. </p><br><p>  A API permite que voc√™: </p><br><ul><li>  Execute v√°rios aplicativos </li><li>  Reproduzir conte√∫do </li><li>  Realize consultas de pesquisa no sistema etc. </li></ul><br><p>  Nesse caso, o m√°ximo que amea√ßa o usu√°rio √© o vazamento de dados confidenciais, o que tamb√©m √© desagrad√°vel. </p><br><h3 id="lyuboy-wi-fi-router">  Qualquer roteador WIFI </h3><br><p><img src="https://habrastorage.org/webt/c_/nk/xe/c_nkxekprqwfkc8uzoj1theepz0.png"></p><br><p>  Quase todo mundo tem esse dispositivo de IoT hoje.  N√£o √© segredo que muitos usu√°rios comuns n√£o alteram as senhas padr√£o dos pain√©is de administra√ß√£o de seus roteadores.  Com a ajuda da religa√ß√£o do DNS, nada nos impede de tentar fazer login com credenciais padr√£o e obter acesso ao painel de administra√ß√£o.  Se o IP local n√£o puder ser encontrado, o WebRTC ser√° resgatado. </p><br><h3 id="itog-po-iot">  Resumo da IoT </h3><br><p>  Destacamos alguns dos recursos que a religa√ß√£o de DNS fornece ao trabalhar com a IoT: </p><br><ul><li>  Capacidade de cancelar o anonimato do usu√°rio </li><li>  Capacidade de digitalizar uma rede local </li><li>  Zombar de usu√°rio </li><li>  Qualquer coisa, dependendo da funcionalidade do dispositivo IoT </li></ul><br><h2 id="crypto-wallets">  Carteiras de criptografia </h2><br><h3 id="geth">  Geth </h3><br><p>  Agora vamos falar sobre carteiras de criptomoedas.  O primeiro caso examinado √© um cliente para carteiras ethereum chamado Geth.  Aqui a caixa do Pandora est√° no servi√ßo JSON-RPC.  Para come√ßar, vamos descobrir o que √©.  JSON-RPC √© um protocolo de chamada de procedimento remoto no formato JSON.  Tudo se parece com isso: </p><br><p><img src="https://habrastorage.org/webt/5x/lj/0u/5xlj0ui1rjzvur8roy4oflnpsiu.png"></p><br><p> A maioria dos clientes executa esse servi√ßo no localhost: 8545 e, por sua vez, fornece um conjunto de fun√ß√µes interessantes, como <code>eth_sendTransaction</code> e assim por diante. </p><br><p>  Agora, um exemplo de como voc√™ pode obter o saldo e o endere√ßo da carteira sem o conhecimento do usu√°rio e usando o ataque de religa√ß√£o do DNS: </p><br><p><img src="https://habrastorage.org/webt/je/oj/om/jeojomqmheqktoigqvdzftukgky.png"></p><br><h3 id="eosio-keosd-wallet">  Carteira EOSIO keosd </h3><br><p>  Em seguida, temos um cliente para carteiras EOSIO.  O pr√≥prio Keosd inicia no localhost: 8900 e assina automaticamente todas as a√ß√µes do aplicativo por 15 minutos ap√≥s a inser√ß√£o dos dados de autoriza√ß√£o.  Ap√≥s se aprofundar na API, √© poss√≠vel encontrar novamente funcionalidades interessantes.  Para maior clareza, usando a solicita√ß√£o mostrada abaixo, voc√™ pode obter a chave p√∫blica do usu√°rio: </p><br><p><img src="https://habrastorage.org/webt/eu/8o/w0/eu8ow0zlacnzorfnqy_mwf1adpc.png"></p><br><h3 id="itog-po-crypto-wallets">  Resumo das carteiras de criptografia: </h3><br><ul><li>  um invasor pode roubar dinheiro do usu√°rio </li><li>  um invasor pode modificar v√°rias configura√ß√µes do usu√°rio </li><li>  a capacidade de descriptografar o usu√°rio </li></ul><br><h2 id="desktop-applications">  Aplicativos de desktop </h2><br><h3 id="transmission-client">  Cliente de transmiss√£o </h3><br><p>  Eu gostaria de iniciar o bloco de incidentes relacionados aos aplicativos da √°rea de trabalho com uma vulnerabilidade relativamente sensacional no cliente de torrent Transmission. </p><br><p>  Aqui, o problema est√° no mesmo JSON-RPC, que examinamos um pouco mais alto.  Nesse caso, permite alterar as configura√ß√µes do usu√°rio, por exemplo, alterar a pasta para baixar arquivos: </p><br><p><img src="https://habrastorage.org/webt/km/ot/fr/kmotfrugolntjfkm9l9s-obaw6g.png"></p><br><p>  Por um lado, parece nada s√©rio, mas se voc√™ especificar o compartilhamento smb controlado pelo invasor em vez da pasta (se o cliente usar o cliente Windows), poder√° interceptar o hash do usu√°rio, que poder√° ser usado no futuro. </p><br><h3 id="utorrent-web-client">  Cliente da web uTorrent </h3><br><p>  Esse camarada possui em seu arsenal o mesmo servi√ßo JSON-RPC que permite alterar os arquivos de configura√ß√£o do usu√°rio e fazer o download dos arquivos. </p><br><p>  A autentica√ß√£o √© necess√°ria neste caso, mas as credenciais est√£o dispon√≠veis em <code>http://localhost:19575/users.conf</code> .  Como isso pode ser usado? </p><br><p>  Primeiro, fa√ßa o seguinte pedido: </p><br><p><img src="https://habrastorage.org/webt/zw/hd/c5/zwhdc5xvr-guzsxhnbpddipajck.png"></p><br><p>  Ap√≥s receber o token, alteramos a pasta de download para a pasta na qual est√£o localizados os programas que s√£o executados quando o sistema √© iniciado: </p><br><p><img src="https://habrastorage.org/webt/wm/qm/ds/wmqmdsmi-zd-t4s3jhg-ehs71um.png"></p><br><p>  E, finalmente, damos o comando para baixar a carga √∫til necess√°ria: </p><br><p><img src="https://habrastorage.org/webt/z_/n7/rf/z_n7rfmj1ot8lnyc5op7yukhmn0.png"></p><br><p>  Como resultado, o <code>evil.exe</code> ser√° iniciado ap√≥s a pr√≥xima reinicializa√ß√£o. </p><br><h3 id="minikube">  Minikube </h3><br><p>  O Minikube √© um utilit√°rio de linha de comando para configurar e executar um cluster Kubernetes de modo √∫nico em uma m√°quina virtual no computador local. </p><br><p>  Ele sempre trava no 192.168.99.100 e a interface baseada na Web est√° dispon√≠vel na porta 3000.  Como resultado, um invasor tem a oportunidade de criar um cont√™iner malicioso com uma pasta compartilhada com o sistema principal. </p><br><p>  Primeiro de tudo, voc√™ precisa obter o token csrf. </p><br><p><img src="https://habrastorage.org/webt/p1/km/nr/p1kmnrq8b3wpp_gvlijlyw-dctg.png"></p><br><p>  Em seguida, voc√™ precisa criar um cont√™iner e, para isso, envie a seguinte solicita√ß√£o: </p><br><p><img src="https://habrastorage.org/webt/zo/yw/hb/zoywhbt3hwo_prfodgovvznth-e.png"></p><br><p>  Vamos ver o que ele faz.  Nele, indicamos que, ao iniciar o cont√™iner, precisamos encaminhar o shell reverso e tamb√©m montar a pasta Usu√°rios no sistema principal: </p><br><p><img src="https://habrastorage.org/webt/rr/ll/jl/rrlljlnmmi_0fsb_slpehnzpoh4.png"></p><br><h3 id="ruby-on-rails">  Ruby on Rails </h3><br><p>  Existe uma gema para a estrutura do Ruby on Rails que permite executar o c√≥digo Ruby diretamente no navegador. </p><br><p><img src="https://habrastorage.org/webt/hj/ij/yn/hjijync3otkaeg025phetqwedcm.png"></p><br><p>  Vamos tentar descobrir o que precisamos para isso? </p><br><p>  Primeiro, precisamos ir para uma p√°gina inexistente: </p><br><p><img src="https://habrastorage.org/webt/kr/tn/xh/krtnxhmsl0ebss-4smhhd2otbzq.png"></p><br><p>  Em seguida, tentamos acessar o console atrav√©s do navegador: </p><br><p><img src="https://habrastorage.org/webt/ou/bg/wp/oubgwpkdiof-enlikzm0sq0djns.png"></p><br><p>  Bem, finalmente, formamos uma solicita√ß√£o para iniciar o aplicativo da calculadora (neste exemplo, o vetor para o MAC OS X): </p><br><p><img src="https://habrastorage.org/webt/hq/kl/eg/hqklegn3xqxh-zgkhk-yv1mrrlw.png"></p><br><h3 id="blizzard-desktop-application">  Aplicativo de desktop da Blizzard </h3><br><p>  N√£o apenas desenvolvedores e usu√°rios regulares s√£o suscet√≠veis a ataques como a religa√ß√£o de DNS, mas tamb√©m jogadores.  Aqui, novamente, encontramos um problema de servi√ßo JSON-RPC ocorrendo neste caso no host local na porta 1120.  O servi√ßo possibilita fazer atualiza√ß√µes, alterar configura√ß√µes e outras v√°rias op√ß√µes de manuten√ß√£o. </p><br><p>  Nesse caso, a autentica√ß√£o √© suportada, mas pass√°-la fazendo solicita√ß√µes do host local n√£o √© dif√≠cil: </p><br><p><img src="https://habrastorage.org/webt/j-/vy/my/j-vymyf0n5t-wtfnwwl4azfjptc.png"></p><br><p>  Como resultado, voc√™ pode conseguir algo semelhante: </p><br><p><img src="https://habrastorage.org/webt/o2/iz/wk/o2izwke9cng_-db0zz2chaxpwe8.png"></p><br><p>  Mais detalhes podem ser encontrados <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> . </p><br><h3 id="itog-po-desktop-application">  Resumo de aplicativos da √°rea de trabalho: </h3><br><ul><li>  um invasor pode obter o RCE no sistema principal (tamb√©m n√£o se esque√ßa do VM Escape) </li><li>  um invasor pode obter acesso a dados confidenciais etc. </li></ul><br><h2 id="clouds">  Nuvens </h2><br><p>  Bem, e finalmente, a coisa mais interessante permanece - as nuvens.  O ponto principal √© que os servi√ßos em nuvem costumam ser usados ‚Äã‚Äãpara hospedar software que analisa os usu√°rios que acessam o site.  Por exemplo, clicando no link no cabe√ßalho do Referer com um navegador sem cabe√ßalho para rastrear o recurso a partir do qual o cliente foi ao site.  Esse vetor de ataque tamb√©m pode ser usado, porque, em ess√™ncia, um navegador sem cabe√ßa √© um navegador da Web completo sem uma interface gr√°fica, mas com suporte para DOM, JS e tudo mais. </p><br><p>  Voltando aos nossos carneiros, o que podemos fazer neste caso?  De fato, para um ataque, precisamos atrasar o usu√°rio (neste caso, o bot) na p√°gina.  Bem, para isso, podemos usar uma imagem na p√°gina que tenha um comprimento de conte√∫do mais do que realmente √©.  Como resultado, o bot pensar√° que a imagem ainda n√£o foi carregada e permanecer√° em nossa p√°gina e, em seguida, usamos nossa t√©cnica padr√£o de religa√ß√£o de DNS. </p><br><p>  Como resultado, como enviaremos solicita√ß√µes de um proxy, podemos fazer muitas coisas engra√ßadas.  Por exemplo: </p><br><ul><li>  digitalizar rede interna </li><li>  entre nos servi√ßos internos (teoricamente) </li><li>  roubar dados de autoriza√ß√£o de outros servi√ßos, etc. </li></ul><br><p>  Vamos diretamente para a Amazon.  O AWS EC2 possui recursos como o Servi√ßo de Metadados da Inst√¢ncia.  Ele permite que qualquer entidade do EC2 use a API REST localizada em 169.254.169.254, que revela informa√ß√µes sobre a inst√¢ncia. </p><br><p>  Por exemplo, aqui est√° uma pequena lista de servi√ßos semelhantes para v√°rias nuvens: </p><br><ul><li>  <strong>AWS</strong> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">http://169.254.169.254/latest/user-data</a> </li><li>  <strong>Google Cloud</strong> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">http://169.254.169.254/computeMetadata/v1/</a> </li><li>  <strong>Digital Ocean</strong> <a href="">http://169.254.169.254/metadata/v1.json</a> </li><li>  <strong>OpenStack / RackSpace</strong> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">http://169.254.169.254/openstack</a> </li><li>  <strong>Azure</strong> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">http://169.254.169.254/metadata/instance</a> </li><li>  <strong>Oracle Cloud</strong> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">http://169.254.169.254/opc/v1/instance/</a> </li></ul><br><p>  Agora, vamos ver um caso em que nos entregamos √† AWS. </p><br><p>  Primeiro, deixe o bot fazer uma solicita√ß√£o para a API: </p><br><p><img src="https://habrastorage.org/webt/z1/-o/is/z1-ois7mddxwr0p5g5uluv7r8fa.png"></p><br><p>  Na resposta, podemos obter informa√ß√µes confidenciais, por exemplo, cr√©ditos em um script que √© executado quando a m√°quina √© iniciada: </p><br><p><img src="https://habrastorage.org/webt/7j/hh/9d/7jhh9dzzznnbn6telzsx0thw4aa.png"></p><br><p>  Em seguida, podemos retirar o nome do n√≥ com o qual continuaremos trabalhando: </p><br><p><img src="https://habrastorage.org/webt/e0/30/-w/e030-wpnsjyjtp75xssqozkyreg.png"></p><br><p>  A seguir, faremos o seguinte apelo pelo nome j√° conhecido e - bingo! </p><br><p><img src="https://habrastorage.org/webt/cx/c1/x4/cxc1x4gdjj2_zmbws1n7rwmjkas.png"></p><br><p><img src="https://habrastorage.org/webt/re/cb/el/recbelcpwknvcdfx9qqcum90spw.png"></p><br><p>  Recebemos v√°rias informa√ß√µes do usu√°rio, como AccessKeyId, SecretAccessKey, Token etc. </p><br><p>  Ap√≥s receber esses dados, podemos us√°-los para autoriza√ß√£o atrav√©s do cliente do console: </p><br><p><img src="https://habrastorage.org/webt/iz/sk/oq/izskoqkfrdvdg0ovbnf578vqhhg.png"></p><br><h3 id="obschiy-itog">  O resultado total: </h3><br><p>  Vamos destacar os pontos fracos comuns que notamos ao usar um ataque de religa√ß√£o de DNS: </p><br><ul><li>  API sem autentica√ß√£o </li><li>  Servi√ßos locais sem autentica√ß√£o </li><li>  Ignorando o par√¢metro Host para solicitar </li><li>  Usando http em vez de https </li></ul><br><p>  Assim, apesar de v√°rios argumentos de especialistas no campo da seguran√ßa pr√°tica das informa√ß√µes, um ataque desse tipo nasce novamente na era da IoT, servi√ßos em nuvem, criptomoedas e assim por diante, mesmo apesar da necessidade de atrasar o cliente do lado do invasor, porque no mundo dos cinemas on-line, hospedagem de v√≠deo e outros servi√ßos que fornecem conte√∫do ao usu√°rio, n√£o √© dif√≠cil fazer isso.  Portanto, tenha cuidado ao viajar no mundo on-line, ao comprar outro assistente inteligente e ao desenvolver, √© claro. </p><br><h3 id="istochniki">  Fontes: </h3><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">https://medium.com/@brannondorsey/attacking-private-networks-from-the-internet-with-dns-rebinding-ea7098a2d325</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">https://blog.hacker.af/how-your-ethereum-can-be-stolen-using-dns-rebinding</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">https://medium.com/coinmonks/the-call-is-coming-from-inside-the-house-dns-rebinding-in-eosio-keosd-wallet-e11deae05974</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">https://github.com/transmission/transmission/pull/468</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">https://labs.mwrinfosecurity.com/advisories/minikube-rce/</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">http://benmmurphy.github.io/blog/2016/07/11/rails-webconsole-dns-rebinding/</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">https://bugs.chromium.org/p/project-zero/issues/detail?id=1471&amp;desc=3#maincol</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://labs.mwrinfosecurity.com/blog/from-">https://labs.mwrinfosecurity.com/blog/from-http-referer-to-aws-security-credentials/</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt439522/">https://habr.com/ru/post/pt439522/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt439512/index.html">A idade dos dinossauros ou resseguro legalmente verificado?</a></li>
<li><a href="../pt439514/index.html">Replica√ß√£o do Tarantool: configura√ß√£o e uso</a></li>
<li><a href="../pt439516/index.html">00110001 00110100 00101110 00110000 00110010</a></li>
<li><a href="../pt439518/index.html">GeekUniversity Atualizado Programa de Treinamento em Desenvolvimento Web: Mais Pr√°ticas e Casos de Clubes de Entrega</a></li>
<li><a href="../pt439520/index.html">Prova de jogo: novo modelo de neg√≥cios em 2019?</a></li>
<li><a href="../pt439524/index.html">Fortnite √© o futuro, mas por raz√µes inesperadas</a></li>
<li><a href="../pt439526/index.html">Operadoras de telecomunica√ß√µes conduzir√£o "testes de campo" da lei de sustentabilidade do Runet</a></li>
<li><a href="../pt439528/index.html">Sem rastreamento de chamadas de custo</a></li>
<li><a href="../pt439532/index.html">O que h√° de novo no JavaScript ES2019</a></li>
<li><a href="../pt439534/index.html">Programa√ß√£o de produ√ß√£o e uso de drones na produ√ß√£o de petr√≥leo - 10 palestras da confer√™ncia GIS Tech Russia</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>