<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üàØÔ∏è ü§öüèΩ üêú Descripci√≥n general de WCS 5.2: servidor WebRTC para desarrolladores web de transmisiones en l√≠nea y video chat üåØ üë©üèæ‚Äçüé® üëãüèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Alice es una desarrolladora de experiencia completa y es capaz de escribir un marco de proyecto SAAS en su marco favorito usando php en una semana. En...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Descripci√≥n general de WCS 5.2: servidor WebRTC para desarrolladores web de transmisiones en l√≠nea y video chat</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/flashphoner/blog/482960/"><img src="https://habrastorage.org/webt/za/go/wo/zagowolkguxr8_bdsbwjmkvyd0a.jpeg"><br><br><p>  Alice es una desarrolladora de experiencia completa y es capaz de escribir un marco de proyecto SAAS en su marco favorito usando php en una semana.  En la parte delantera, prefiere Vue.js. </p><br><p> Un cliente est√° llamando a un telegrama que, por todos los medios, necesita desarrollar un sitio web, que ser√° el lugar de reuni√≥n del empleador y el empleado para realizar una entrevista en persona.  Tiempo completo: significa contacto directo de video en tiempo real con video y voz. <br>  "¬øPor qu√© no Skype?" Usted pregunta.  Dio la casualidad de que los proyectos serios, y cada startup, sin duda se considera a s√≠ misma como tal, est√°n tratando de ofrecer un servicio de comunicaciones internas por una variedad de razones, que incluyen: <a name="habracut"></a></p><br><p>  1) No entregue a sus usuarios comunicadores de terceros (Skype, <br>  lugares de reuni√≥n, etc.).  D√©jalos en el servicio. </p><br><p>  2) Supervisar las comunicaciones: historial de llamadas, resultados de entrevistas. </p><br><p>  3) Grabar llamadas (por supuesto, notificar a ambas partes de la grabaci√≥n). </p><br><p>  4) No dependa de pol√≠ticas y actualizaciones de servicios de terceros.  Todos conocen esta historia: Skype se actualiz√≥ y comenz√≥ ... </p><br><p>  La tarea parece simple.  WebRTC es google sobre el tema y parece que puede organizar una conexi√≥n punto a punto entre dos navegadores, pero quedan preguntas: </p><br><p>  1) D√≥nde obtener servidores STUN / TURN </p><br><p>  2) ¬øEs posible prescindir de ellos? </p><br><p>  3) C√≥mo grabar una llamada WebRTC punto a punto </p><br><p>  4) Qu√© suceder√° si necesita agregar un tercero a la llamada, por ejemplo, un gerente de recursos humanos u otro especialista del empleador. </p><br><p>  Resulta que solo WebRTC y peer-to-peer no son suficientes y no est√° claro qu√© hacer con todo esto para iniciar las funciones de video requeridas del servicio. </p><br><h2>  Contenido del art√≠culo </h2><br><div class="spoiler">  <b class="spoiler_title">Tabla de contenidos</b> <div class="spoiler_text"><ul><li>  <a href="https://habr.com/ru/company/flashphoner/blog/482960/">Servidor y API</a> </li><li>  <a href="https://habr.com/ru/company/flashphoner/blog/482960/">Transmisiones entrantes</a> <br><ul><li>  <a href="https://habr.com/ru/company/flashphoner/blog/482960/">WebRTC</a> </li><li>  <a href="https://habr.com/ru/company/flashphoner/blog/482960/">RTMP</a> </li><li>  <a href="https://habr.com/ru/company/flashphoner/blog/482960/">Rtsp</a> </li><li>  <a href="https://habr.com/ru/company/flashphoner/blog/482960/">Vod</a> </li><li>  <a href="https://habr.com/ru/company/flashphoner/blog/482960/">SIP / RTP</a> </li></ul><br></li><li>  <a href="https://habr.com/ru/company/flashphoner/blog/482960/">Transmisiones salientes</a> <br><ul><li>  <a href="https://habr.com/ru/company/flashphoner/blog/482960/">WebRTC</a> </li><li>  <a href="https://habr.com/ru/company/flashphoner/blog/482960/">RTMP</a> </li><li>  <a href="https://habr.com/ru/company/flashphoner/blog/482960/">Rtsp</a> </li><li>  <a href="https://habr.com/ru/company/flashphoner/blog/482960/">MSE</a> </li><li>  <a href="https://habr.com/ru/company/flashphoner/blog/482960/">Hls</a> </li></ul><br></li><li>  <a href="https://habr.com/ru/company/flashphoner/blog/482960/">Bandeja de entrada y salida</a> </li><li>  <a href="https://habr.com/ru/company/flashphoner/blog/482960/">Manipulaci√≥n de flujo entrante</a> <br><ul><li>  <a href="https://habr.com/ru/company/flashphoner/blog/482960/">Grabaci√≥n de flujo entrante</a> </li><li>  <a href="https://habr.com/ru/company/flashphoner/blog/482960/">Eliminaci√≥n de instant√°neas</a> </li><li>  <a href="https://habr.com/ru/company/flashphoner/blog/482960/">Agregar corriente al mezclador</a> </li><li>  <a href="https://habr.com/ru/company/flashphoner/blog/482960/">Transcodificaci√≥n de flujo</a> </li><li>  <a href="https://habr.com/ru/company/flashphoner/blog/482960/">Agregar una marca de agua</a> </li><li>  <a href="https://habr.com/ru/company/flashphoner/blog/482960/">Agregar filtro FPS</a> </li><li>  <a href="https://habr.com/ru/company/flashphoner/blog/482960/">Gire la imagen 90, 180, 270 grados.</a> </li><li>  <a href="https://habr.com/ru/company/flashphoner/blog/482960/">¬øD√≥nde est√° el control de las transmisiones entrantes?</a> </li></ul><br></li><li>  <a href="https://habr.com/ru/company/flashphoner/blog/482960/">Retransmisi√≥n corriente</a> <br><ul><li>  <a href="https://habr.com/ru/company/flashphoner/blog/482960/">WebRTC</a> </li><li>  <a href="https://habr.com/ru/company/flashphoner/blog/482960/">RTMP</a> </li><li>  <a href="https://habr.com/ru/company/flashphoner/blog/482960/">SIP / RTP</a> </li></ul><br></li><li>  <a href="https://habr.com/ru/company/flashphoner/blog/482960/">Conexi√≥n de servidores a una red de procesamiento de contenido CDN</a> </li><li>  <a href="https://habr.com/ru/company/flashphoner/blog/482960/">Para resumir</a> </li><li>  <a href="https://habr.com/ru/company/flashphoner/blog/482960/">Referencias</a> </li></ul><br></div></div><br><br><h2><a name="serverapi"></a>  Servidor y API </h2><br><p>  Para cerrar todos estos puntos blancos, se utilizan soluciones de servidor y arquitectura de igual a igual.  Web Call Server 5.2 WCS es una de las soluciones de servidor: una plataforma de desarrollo que le permite agregar tales funciones de video al proyecto y no preocuparse por STUN / TURN y la estabilidad de la conexi√≥n peer-to-peer. </p><br><p>  En el nivel m√°s alto, WCS es una parte del servidor JavaScript API +.  La API se utiliza para desarrollar JavaScript normal en el lado del navegador, y el servidor procesa el tr√°fico de video, actuando como un Proxy con estado para el tr√°fico de medios. </p><br><p><img src="https://habrastorage.org/webt/7a/w0/qv/7aw0qvwyfc9tak6ij9ycdr1sju4.png"></p><br><p>  Adem√°s de la API de JavaScript, tambi√©n existe el SDK de Android y el SDK de iOS, que son necesarios para desarrollar aplicaciones m√≥viles nativas para iOS y Android, respectivamente. </p><br><p>  Por ejemplo, publicar una transmisi√≥n en un servidor (transmitir una transmisi√≥n desde una c√°mara web hacia el servidor) tiene este aspecto: </p><br><p>  SDK web </p><br><pre><code class="plaintext hljs">session.createStream({name:‚Äùstream123‚Äù}).publish();</code> </pre> <br><p>  SDK de Android </p><br><pre> <code class="plaintext hljs">publishStream = session.createStream(streamOptions) publishStream.publish();</code> </pre> <br><p>  SDK de iOS </p><br><pre> <code class="plaintext hljs">FPWCSApi2Stream *stream = [session createStream:options error:&amp;error]; if(![stream publish:&amp;error]) { //published without errors }</code> </pre> <br><p>  Como resultado, puede implementar no solo una aplicaci√≥n web, sino tambi√©n actualizaciones completas para Google Play y App Store con soporte para transmisi√≥n de video.  Agregue SDK m√≥viles a la imagen de nivel superior.  Resultar√° as√≠: </p><br><p><img src="https://habrastorage.org/webt/tf/z-/ya/tfz-yax_izaf-eyitcvd57y82h0.png"><br><br></p><h2><a name="Incomingstreams"></a>  Transmisiones entrantes </h2><br><p>  El servidor de transmisi√≥n, que es WCS, comienza con las transmisiones entrantes.  Para dar algo, necesitas tenerlo.  Para distribuir transmisiones de video a los espectadores, es necesario que estas transmisiones ingresen al servidor, pasen por su RAM y salgan por la tarjeta de red.  Por lo tanto, la primera pregunta que ser√≠a √∫til hacer al familiarizarse con un servidor de medios es: ¬øpara qu√© protocolos y formatos acepta este √∫ltimo las transmisiones?  En el caso de WCS, estas son las siguientes tecnolog√≠as: WebRTC, RTMP, RTSP, VOD, SIP / RTP. </p><br><p><img src="https://habrastorage.org/webt/du/2r/pc/du2rpcr6ihdkicklwlyusrodjog.png"></p><br><p>  Cada uno de los protocolos puede ser utilizado por diversos clientes.  Por ejemplo, a trav√©s de WebRTC, no solo puede ingresar una transmisi√≥n desde un navegador, sino tambi√©n desde otro servidor.  Mostramos las posibles fuentes de tr√°fico entrante en la tabla. </p><br><p></p><div class="scrollable-table"><table><tbody><tr><td>  <strong>WebRTC</strong> </td><td>  <strong>RTMP</strong> </td><td>  <strong>Rtsp</strong> </td><td>  <strong>Vod</strong> </td><td>  <strong>SIP / RTP</strong> </td></tr><tr><td><ul><li>  SDK web <br><ul><li>  c√°mara + micr√≥fono </li><li>  lienzo </li><li>  compartir pantalla </li></ul><br></li><li>  SDK de Android </li><li>  SDK de iOS </li><li>  WCS <br><ul><li>  empujar </li><li>  tirar </li></ul><br></li><li>  CDN </li></ul><br></td><td><ul><li>  Codificador RTMP <br><ul><li>  ffmpeg </li><li>  Obs </li><li>  Wirecast </li></ul><br></li><li>  Codificador de Adobe </li><li>  WCS <br><ul><li>  empujar </li><li>  tirar </li></ul><br></li><li>  Reproductor de flash </li></ul><br></td><td><ul><li>  C√°mara IP </li><li>  Servidor RTSP </li></ul><br></td><td><ul><li>  Sistema de archivos </li><li>  AWS S3 </li></ul><br></td><td><ul><li>  Punto final SIP </li><li>  Conferencia SIP </li></ul><br></td></tr></tbody></table></div><br><p>  Si revisa las fuentes de tr√°fico entrante, puede agregar lo siguiente: </p><br><br><h3><a name="inWebRTC"></a>  <strong>WebRTC entrante</strong> </h3><br><p>  Web SDK le permite capturar no solo la c√°mara y el micr√≥fono, sino tambi√©n usar las capacidades de la API del navegador para acceder a la pantalla: compartir pantalla.  Adem√°s, puede capturar un elemento Canvas arbitrario y todo lo que se dibuja en √©l para su posterior transmisi√≥n es la transmisi√≥n de Canvas. </p><br><p>  Android SDK y iOS SDK debido a los detalles m√≥viles tienen la capacidad de cambiar entre la c√°mara frontal y trasera del dispositivo sobre la marcha.  Esto le permite cambiar la fuente durante la transmisi√≥n sin detener la transmisi√≥n. </p><br><p>  El flujo entrante de WebRTC tambi√©n se puede obtener de otro servidor WCS por m√©todos: push, pull y CDN, que se analizar√°n un poco m√°s adelante. </p><br><p><img src="https://habrastorage.org/webt/zn/rw/5i/znrw5ikkd8vcjuexwarfzeqkhg4.jpeg"><br></p><h3><a name="inRTMP"></a>  <strong>Rtmp entrante</strong> </h3><br><p>  El protocolo RTMP se usa ampliamente en los transmisores OBS favoritos y en otros codificadores: Wirecast, Adobe Media Ensourcer, ffmpeg, etc.  Tomando uno de estos codificadores, puede capturar la transmisi√≥n y enviarla al servidor. </p><br><p>  Tambi√©n puede recoger una transmisi√≥n RTMP de otro servidor de medios o servidor WCS de <br>  utilizando m√©todos push y pull.  En el caso de push, el iniciador es el servidor remoto.  En el caso de pull, recurrimos al local para extraer el flujo del remoto. </p><br><p><img src="https://habrastorage.org/webt/3o/8x/f8/3o8xf84v5rx2apw_09n_lm2cjoe.jpeg"></p><br><br><h3><a name="inRTSP"></a>  <strong>RTSP entrante</strong> </h3><br><p>  Las fuentes de tr√°fico RTSP suelen ser c√°maras IP o servidores de medios de terceros que admiten el protocolo RTSP.  A pesar del hecho de que al iniciar una conexi√≥n RTSP, el iniciador es WCS, el tr√°fico de audio y video en la direcci√≥n de la c√°mara IP se mueve hacia el servidor WCS.  Por lo tanto, consideramos que la transmisi√≥n de la c√°mara es entrante. </p><br><p><img src="https://habrastorage.org/webt/ch/pj/qi/chpjqiof2ipgoqzmwx0zzkewrgm.jpeg"></p><br><br><h3><a name="inVOD"></a>  <strong>VOD entrante</strong> </h3><br><p>  A primera vista, puede parecer que la funci√≥n VOD (Video On Demand) est√° asociada exclusivamente con transmisiones salientes y con la reproducci√≥n del archivo por parte de los navegadores.  En nuestro caso, esto est√° un poco mal.  WCS traduce honestamente el archivo mp4 del sistema de archivos a localhost, como resultado, se crea una transmisi√≥n entrante, como si viniera de una fuente de terceros.  Adem√°s, si restringimos un visor a un archivo mp4, obtenemos el VOD cl√°sico, donde el espectador toma la transmisi√≥n y la reproduce desde el principio.  Si no est√° limitado, obtenemos VOD LIVE, una variaci√≥n de VOD, en la que los espectadores pueden reproducir el mismo archivo como una transmisi√≥n, conect√°ndose al punto de reproducci√≥n en el que se encuentran todos los dem√°s (modo de transmisi√≥n de televisi√≥n pregrabada). </p><br><p><img src="https://habrastorage.org/webt/cn/ot/tv/cnottvwwytktaxh9vnbjexlxlaq.jpeg"><br><br></p><h3><a name="inSIP-RTP"></a>  <strong>SIP / RTP entrante</strong> </h3><br><p>  Para recibir tr√°fico RTP entrante dentro de una sesi√≥n SIP, debe configurar una llamada con una puerta de enlace SIP de terceros.  Si la conexi√≥n se establece con √©xito, el tr√°fico de audio y / o video ir√° desde la puerta de enlace SIP, que se envolver√° en la transmisi√≥n entrante en el lado WCS. </p><br><p><img src="https://habrastorage.org/webt/-r/km/io/-rkmio-9lhqlfjioblwkanzuxiq.jpeg"></p><br><br><h2><a name="Outgoingstreams"></a>  Transmisiones salientes </h2><br><p>  Despu√©s de recibir la transmisi√≥n en el servidor, puede replicar la transmisi√≥n recibida a uno o varios espectadores a pedido.  El espectador solicita una transmisi√≥n del reproductor u otro dispositivo.  Tales transmisiones se denominan salientes o "transmisiones de espectadores", porque las sesiones de dichas transmisiones siempre se inician del lado del espectador / jugador.  El conjunto de tecnolog√≠as de reproducci√≥n incluye los siguientes protocolos / formatos: WebRTC, RTMP, RTSP, MSE, HLS </p><br><div class="scrollable-table"><table><thead><tr><th>  WebRTC </th><th>  RTMP </th><th>  Rtsp </th><th>  MSE </th><th>  Hls </th></tr></thead><tbody><tr><td><ul><li>  SDK web </li><li>  SDK de Android </li><li>  SDK de iOS </li><li>  WCS <br><ul><li>  tirar </li><li>  CDN </li></ul><br></li></ul><br></td><td><ul><li>  Reproductor de flash </li><li>  Jugadores RTMP </li></ul><br></td><td><ul><li>  Jugador RTSP <br><ul><li>  VLC </li><li>  WCS </li><li>  etc. </li></ul><br></li></ul><br></td><td><ul><li>  SDK web </li></ul><br></td><td><ul><li>  Jugadores HLS <br><ul><li>  hls.js </li><li>  safari nativo </li></ul><br></li></ul><br></td></tr></tbody></table></div><br><br><br><h3><a name="outWebRTC"></a>  <strong>WebRTC saliente</strong> </h3><br><p>  En este caso, Web SDK, Android SDK y iOS SDK act√∫an como API para el reproductor.  Un ejemplo de reproducci√≥n de transmisi√≥n WebRTC se ve as√≠: </p><br><p>  SDK web </p><br><pre> <code class="plaintext hljs">session.createStream({name:‚Äùstream123‚Äù}).play();</code> </pre> <br><p>  SDK de Android </p><br><pre> <code class="plaintext hljs">playStream = session.createStream(streamOptions); playStream.play();</code> </pre> <br><p>  SDK de iOS </p><br><pre> <code class="plaintext hljs">FPWCSApi2Stream *stream = [session createStream:options error:nil]; if(![stream play:&amp;error]) { //published without errors }</code> </pre> <br><p>  Esto es muy similar a la API de publicaci√≥n, con la √∫nica diferencia de que en su lugar <br>  Se llama stream.publish (), stream.play () para la reproducci√≥n. </p><br><p>  Un jugador tambi√©n puede ser un servidor WCS de terceros, al que se le indicar√° que recoja una transmisi√≥n a trav√©s de WebRTC desde otro servidor utilizando el m√©todo pull o que recoja una transmisi√≥n dentro de CDN. </p><br><br><h3> <strong><a name="outRTMP"></a></strong>  <strong>Rtmp saliente</strong> </h3><br><p><img src="https://habrastorage.org/webt/in/zq/nb/inzqnbejvsout_d4n5iiej4gozi.png"></p><br><p>  Aqu√≠ habr√° principalmente reproductores RTMP, tanto el conocido Flash Player como las aplicaciones de escritorio y m√≥viles que usan el protocolo RTMP, reciben y reproducen una transmisi√≥n RTMP.  El hecho es que a pesar del hecho de que Flash dej√≥ el navegador, dej√≥ el protocolo RTMP, que se usa ampliamente para transmisiones de video y la falta de soporte nativo en los navegadores no impide el uso de este protocolo bastante exitoso en otras aplicaciones cliente.  Se sabe que RTMP se usa ampliamente en reproductores de realidad virtual para aplicaciones m√≥viles para Android e iOS. </p><br><br><h3><a name="outRTSP"></a>  <strong>RTSP saliente</strong> </h3><br><p><img src="https://habrastorage.org/webt/ly/xu/r9/lyxur9b3gfzwsubfmrb3afmkfh0.png"></p><br><p>  El servidor WCS puede actuar como un servidor RTSP y distribuir la transmisi√≥n recibida a trav√©s de RTSP como una c√°mara IP normal.  En este caso, el reproductor debe establecer una conexi√≥n RTSP con el servidor y recoger la transmisi√≥n para reproducirla, como si fuera una c√°mara IP. </p><br><br><h3><a name="outMSE"></a>  <strong>MSE saliente</strong> </h3><br><p><img src="https://habrastorage.org/webt/lt/wh/wz/ltwhwz7b8urhlg4m5ay-blpg-d8.jpeg"></p><br><p>  En este caso, el reproductor solicita una transmisi√≥n del servidor utilizando el protocolo Websocket.  El servidor proporciona datos de audio y video en tomas web.  Los datos llegan al navegador y se convierten en fragmentos que el navegador puede reproducir gracias a la extensi√≥n MSE nativa admitida de f√°brica.  El reproductor finalmente funciona sobre la base del elemento de video HTML5. </p><br><br><h3><a name="outHLS"></a>  <strong>HLS salientes</strong> </h3><br><p><img src="https://habrastorage.org/webt/if/5l/5f/if5l5fdsrgbgaekle2edci9gyws.jpeg"></p><br><p>  Aqu√≠, WCS act√∫a como un servidor HLS o servidor web que admite HLS (HTTP Live Streaming).  Una vez que la transmisi√≥n entrante ha aparecido en el servidor, se genera una lista de reproducci√≥n HLS en formato .m3u8, que se entrega al reproductor en respuesta a una solicitud HTTP.  La lista de reproducci√≥n describe qu√© segmentos del video debe descargar y mostrar el reproductor.  El reproductor descarga segmentos de video y lo reproduce en la p√°gina del navegador, en el dispositivo m√≥vil, en el escritorio, en el decodificador de Apple TV y en cualquier lugar donde se solicite soporte HLS. </p><br><br><h2><a name="IncomingOutgoing"></a>  Bandeja de entrada y salida </h2><br><p>  Total tenemos 5 tipos de flujo entrantes y el mismo n√∫mero de salientes.  Listamos <br>  ellos en la mesa: </p><br><p></p><div class="scrollable-table"><table><thead><tr><th>  <strong>Bandeja de entrada</strong> </th><th>  <strong>Saliente</strong> </th></tr></thead><tbody><tr><td>  WebRTC </td><td>  WebRTC </td></tr><tr><td>  RTMP </td><td>  RTMP </td></tr><tr><td>  Rtsp </td><td>  Rtsp </td></tr><tr><td>  Vod </td><td>  MSE </td></tr><tr><td>  SIP / RTP </td><td>  Hls </td></tr></tbody></table></div><br><br><p>  Es decir  podemos conducir transmisiones al servidor y podemos conectarnos a ellas y reproducir reproductores adecuados para este asunto.  Para reproducir la transmisi√≥n WebRTC, use el SDK web.  Para reproducir la transmisi√≥n WebRTC como HLS, use un reproductor HLS, etc.  Una transmisi√≥n puede ser reproducida por muchos espectadores.  Las transmisiones de uno a muchos funcionan. </p><br><p>  Ahora diremos qu√© acciones se pueden realizar con las transmisiones. </p><br><br><h2><a name="manipulatingincoming"></a>  Manipulaci√≥n de flujo entrante </h2><br><p>  Las transmisiones salientes en las que se sientan los espectadores no son particularmente manipuladoras.  De hecho, si el espectador ha establecido una sesi√≥n con el servidor y ya est√° tomando alg√∫n tipo de transmisi√≥n, no hay forma de hacer cambios sin interrumpir la sesi√≥n.  Por esta raz√≥n, todas las manipulaciones y cambios tienen lugar en las transmisiones entrantes, en el punto donde a√∫n no se ha producido su replicaci√≥n.  La transmisi√≥n que ha sufrido cambios se distribuye a todos los espectadores conectados. </p><br><p>  Las operaciones en transmisiones incluyen: </p><br><ul><li>  grabar </li><li>  eliminaci√≥n de instant√°neas </li><li>  agregar corriente al mezclador </li><li>  transcodificaci√≥n de flujo </li><li>  agregar marca de agua </li><li>  agregar filtro FPS </li><li>  rotaci√≥n de imagen en 90, 180, 270 grados </li></ul><br><br><h3><a name="recording"></a>  <strong>Grabaci√≥n de flujo entrante</strong> </h3><br><p><img src="https://habrastorage.org/webt/m_/je/j8/m_jej8-gdyvh2e2urt4s75ltsse.jpeg"></p><br><p>  Quiz√°s la m√°s comprensible y frecuente de las funciones.  De hecho, las transmisiones requieren grabaci√≥n en muchos casos: seminario web, lecci√≥n de ingl√©s, consulta, etc. </p><br><p><img src="https://habrastorage.org/webt/kz/t0/_r/kzt0_rj0y1mvgb4rnob5ix4_bnk.jpeg"></p><br><p>  La grabaci√≥n se puede iniciar con el SDK web o la API REST con una solicitud especial: </p><br><pre> <code class="plaintext hljs">/stream/startRecording {}</code> </pre> <br><p>  El resultado se guarda en el sistema de archivos como un archivo mp4. </p><br><br><h3><a name="snapshot"></a>  <strong>Eliminaci√≥n de instant√°neas</strong> </h3><br><p><img src="https://habrastorage.org/webt/cg/g6/yh/cgg6yhu_d8lj4tl6tecphzvgsce.jpeg"></p><br><p>  Una tarea igualmente com√∫n es tomar fotograf√≠as de la transmisi√≥n actual para mostrar iconos en el sitio.  Por ejemplo, tiene 50 transmisiones en un sistema de videovigilancia, cada una de las cuales tiene una fuente de una c√°mara IP.  Mostrar los 50 hilos en una p√°gina no solo es problem√°tico para los recursos del navegador, sino que tambi√©n no tiene sentido.  En el caso de 30 FPS, el FPS total de la imagen cambiante ser√° de 1500 fotogramas por segundo y el ojo humano simplemente no aceptar√° esta frecuencia.  Como soluci√≥n, puede configurar instant√°neas autom√°ticas para cortar o comer a pedido, en este caso puede mostrar im√°genes en un sitio con una frecuencia arbitraria, por ejemplo, 1 fotograma en 10 segundos.  Las instant√°neas se pueden eliminar del SDK, a trav√©s de la API REST, o se pueden cortar autom√°ticamente. </p><br><p><img src="https://habrastorage.org/webt/b9/c5/hf/b9c5hfkspnmifm7wfw96aatldl8.jpeg"></p><br><p>  El servidor WCS admite el siguiente m√©todo REST para eliminar instant√°neas: </p><br><pre> <code class="plaintext hljs">/stream/snapshot</code> </pre> <br><p><img src="https://habrastorage.org/webt/5c/8z/v-/5c8zv-0i7uglnd6t5eyldejyzt0.jpeg"></p><br><br><h3><a name="mixer"></a>  <strong>Agregar corriente al mezclador</strong> </h3><br><p><img src="https://habrastorage.org/webt/o3/mx/bj/o3mxbjmxo3evugpsr5td7wko1pc.jpeg"></p><br><p>  Una imagen de dos o m√°s fuentes se puede combinar en una para mostrarla a los espectadores finales.  Este procedimiento se llama mezclar.  Ejemplos b√°sicos: 1) Videovigilancia de m√∫ltiples c√°maras en la pantalla en una sola imagen.  2) Videoconferencia, donde cada usuario recibe una secuencia para ahorrar recursos, en la que el resto se mezclan.  El mezclador se controla a trav√©s de la API REST y tiene un modo de operaci√≥n MCU para crear videoconferencias. </p><br><p>  Comando REST para agregar una secuencia al mezclador: </p><br><pre> <code class="plaintext hljs">/mixer/startup</code> </pre> <br><br><h3><a name="transcoding"></a>  <strong>Transcodificaci√≥n de flujo</strong> </h3><br><p><img src="https://habrastorage.org/webt/e8/dn/ml/e8dnmlrtcfd5dxvsnmfkrckeiqm.jpeg"></p><br><p>  A veces se requiere que las secuencias se expriman para adaptarse a ciertos grupos de dispositivos cliente por resoluci√≥n y velocidad de bits.  Para esto, se usa la transcodificaci√≥n.  La transcodificaci√≥n se puede habilitar en el lado del SDK web, a trav√©s de la API REST o autom√°ticamente a trav√©s de un nodo especial de transcodificaci√≥n en el CDN.  Por ejemplo, al ingresar un video de 1280x720, se puede transcodificar a 640x360 para su distribuci√≥n a clientes de una regi√≥n geogr√°fica con un ancho de banda tradicionalmente bajo.  ¬øD√≥nde est√°n tus compa√±eros, Elon Musk? </p><br><p><img src="https://habrastorage.org/webt/yn/t2/5g/ynt25g1_9phfzcqtptzb0e0u3gq.jpeg"></p><br><p>  M√©todo REST utilizado: </p><br><pre> <code class="plaintext hljs">/transcoder/startup</code> </pre> <br><br><br><h3><a name="watermark"></a>  <strong>Agregar una marca de agua</strong> </h3><br><p><img src="https://habrastorage.org/webt/l_/7q/-t/l_7q-td_lifwkr5aw3mn-btem1o.png"></p><br><p>  Se sabe que cualquier contenido puede ser robado y convertido en WebRip, sin importar la protecci√≥n que tenga el reproductor.  Si su contenido es realmente tan valioso, puede incrustar una marca de agua o un logotipo en √©l que complicar√° en gran medida su uso posterior y su exhibici√≥n p√∫blica.  Para agregar una marca de agua, simplemente suba una imagen PNG y se insertar√° en la transmisi√≥n de video mediante transcodificaci√≥n.  Por lo tanto, tendr√° que preparar un par de n√∫cleos de CPU en el lado del servidor en caso de que todav√≠a decida <br>  agregue una marca de agua a la secuencia.  Para no torcer la marca de agua en el servidor mediante transcodificaci√≥n, es mejor agregarla directamente al codificador / transmisor, que <br>  a menudo brindan esa oportunidad. </p><br><br><h3><a name="fpsfilter"></a>  <strong>Agregar filtro FPS</strong> </h3><br><p><img src="https://habrastorage.org/webt/27/oi/bk/27oibkbef1jtrjulbcdcpomi_ts.png"></p><br><p>  En algunos casos, se requiere que la transmisi√≥n sea con un FPS uniforme (cuadros por segundo).  Esto puede ser √∫til si transmitimos la transmisi√≥n a un recurso de terceros como Youtube o Facebook, o si la reproducimos con un reproductor HLS sensible.  Filtrar nuevamente requiere transcodificaci√≥n, as√≠ que calcule la potencia de su servidor y prep√°rese para la configuraci√≥n m√°s 2 n√∫cleos por flujo si se planea dicha operaci√≥n. </p><br><br><h3><a name="rotate"></a>  <strong>Gire la imagen 90, 180, 270 grados.</strong> </h3><br><p><img src="https://habrastorage.org/webt/ou/bh/2n/oubh2n__wt2uasdqfdgtj3rmves.png"></p><br><p>  Los dispositivos m√≥viles tienen la capacidad de cambiar la resoluci√≥n de la transmisi√≥n publicada en funci√≥n del √°ngulo de rotaci√≥n.  Por ejemplo, comenzaron a transmitir, sosteniendo el iPhone horizontalmente y luego se volvieron hacia un lado.  De acuerdo con la especificaci√≥n WebRTC, el navegador streamer del dispositivo m√≥vil, y en este caso iOS Safari, deber√≠a indicar un giro al servidor.  El servidor, a su vez, debe enviar este evento a todos los suscriptores.  De lo contrario, habr√≠a resultado <br>  para que el transmisor coloque el tel√©fono de lado, pero vea que su c√°mara a√∫n est√° en posici√≥n vertical, mientras que los espectadores se apilan de lado.  Para trabajar con giros en el lado del SDK, se incluye la extensi√≥n cvoExtension correspondiente. </p><br><br><h3><a name="manage"></a>  <strong>¬øD√≥nde est√° el control de las transmisiones entrantes?</strong> </h3><br><p>  Autom√°tico: la configuraci√≥n generalmente se establece en el lado del servidor en <br>  ajustes </p><br><div class="scrollable-table"><table><thead><tr><th>  Acci√≥n de flujo </th><th>  Web, iOS, Android SDK </th><th>  API REST </th><th>  Autom√°tico </th><th>  CDN </th></tr></thead><tbody><tr><td>  Registro </td><td>  + </td><td>  + </td><td><br></td><td><br></td></tr><tr><td>  Eliminaci√≥n de instant√°neas </td><td>  + </td><td>  + </td><td>  + </td><td><br></td></tr><tr><td>  Agregar al mezclador </td><td>  + </td><td>  + </td><td><br></td><td><br></td></tr><tr><td>  Transcodificaci√≥n de flujo </td><td>  + </td><td>  + </td><td><br></td><td>  + </td></tr><tr><td>  Agregar agua <br>  se√±al </td><td><br></td><td><br></td><td>  + </td><td><br></td></tr><tr><td>  Agregar un filtro FPS </td><td><br></td><td><br></td><td>  + </td><td><br></td></tr><tr><td>  Gire la imagen por 90, <br>  180, 270 grados </td><td>  + </td><td><br></td><td><br></td><td><br></td></tr></tbody></table></div><br><br><h2><a name="Streamrelay"></a>  Retransmisi√≥n corriente </h2><br><p>  La retransmisi√≥n tambi√©n es una opci√≥n para manipular transmisiones que ingresan al servidor y consiste en forzar la transmisi√≥n a un servidor de terceros.  Un sin√≥nimo de retransmisi√≥n es palabras como: replicaci√≥n, empuje, inyecci√≥n. </p><br><p>  El rel√© se puede implementar utilizando uno de los siguientes protocolos: WebRTC, RTMP, SIP / RTP.  La tabla muestra la direcci√≥n en la que se puede transmitir la transmisi√≥n. </p><br><br><div class="scrollable-table"><table><thead><tr><th>  WebRTC </th><th>  RTMP </th><th>  SIP / RTP </th></tr></thead><tbody><tr><td>  WCS </td><td>  Servidor RTMP WCS </td><td>  Servidor SIP </td></tr></tbody></table></div><br><br><br><h3><a name="repubWebRTC"></a>  <strong>Rel√© WebRTC</strong> </h3><br><p><img src="https://habrastorage.org/webt/d9/yf/cc/d9yfccsjz8zqvx3jo-3gas2nuu8.jpeg"></p><br><p>  Una transmisi√≥n se puede retransmitir a otro servidor WCS si por alguna raz√≥n se requiere que la transmisi√≥n est√© disponible en otro servidor.  La retransmisi√≥n se realiza a trav√©s de la API REST utilizando el m√©todo / push.  Al recibir dicha solicitud REST, WCS se conecta al servidor especificado y publica una secuencia de servidor a servidor.  Despu√©s de eso, la transmisi√≥n est√° disponible para su reproducci√≥n en otra m√°quina. </p><br><pre> <code class="plaintext hljs">/pull/push</code> </pre> <br><p>  - El m√©todo REST utilizado. </p><br><br><h3><a name="rebubRTMP"></a>  <strong>Rel√© RTMP</strong> </h3><br><p><img src="https://habrastorage.org/webt/y-/hv/tn/y-hvtne9e-vtgry-2or6nhmqzte.jpeg"></p><br><p>  Al igual que con la retransmisi√≥n WebRTC, tambi√©n es posible la retransmisi√≥n RTMP a otro servidor.  La diferencia solo estar√° en el protocolo de retransmisi√≥n.  La retransmisi√≥n RTMP tambi√©n se realiza a trav√©s de / push y le permite transferir la transmisi√≥n tanto a servidores RTMP de terceros como a servicios que admiten RTMP Ingest: transmisi√≥n de Youtube, Facebook, etc.  Por lo tanto, el flujo de WebRTC puede transmitirse a RTMP.  Con el mismo √©xito en RTMP, puede retransmitir cualquier otra transmisi√≥n que ingrese al servidor, por ejemplo, RTSP o VOD. </p><br><p>  La transmisi√≥n de video se transmite a otro servidor RTMP mediante llamadas REST </p><br><pre> <code class="plaintext hljs">/push/startup</code> </pre> <br><p>  - Llamada REST utilizada. </p><br><br><h3><a name="repubSIP-RTP"></a>  <strong>Rel√© SIP / RTP</strong> </h3><br><p><img src="https://habrastorage.org/webt/sl/tt/hj/sltthjlgwbvryka0vgpqel0hcx8.jpeg"></p><br><br><p>  Funci√≥n raramente utilizada.  Muy a menudo en la empresa.  Por ejemplo, cuando desea configurar una llamada SIP con un servidor de conferencia SIP externo y redirigir la transmisi√≥n de audio o video a esta llamada para que la audiencia de la conferencia vea alg√∫n contenido de video: "Por favor vea este video" o "Colegas, y ahora veamos la transmisi√≥n con IP c√°maras del sitio de construcci√≥n ".  Debe comprender que la conferencia en s√≠ misma existe y se administra en este caso en un servidor VKS externo con soporte SIP (recientemente probamos la soluci√≥n de Polycom DMA), simplemente conectamos y transmitimos la transmisi√≥n existente a este servidor.  La funci√≥n API REST se llama / inject y sirve solo para este caso. </p><br><p>  Comando API REST: </p><br><pre> <code class="plaintext hljs">/call/inject_stream/startup</code> </pre> <br><br><h2><a name="CDN"></a>  Conexi√≥n de servidores a una red de procesamiento de contenido CDN </h2><br><p>  Un servidor generalmente tiene una cantidad limitada de recursos.  Por lo tanto, para grandes transmisiones en l√≠nea, donde la cuenta de la audiencia llega a miles y decenas de miles, es necesario escalar.  Se pueden combinar varios servidores WCS en una red de entrega de contenido CDN.  Internamente, CDN trabajar√° a trav√©s de WebRTC para mantener una baja latencia durante la transmisi√≥n. </p><br><p><img src="https://habrastorage.org/webt/99/sx/gd/99sxgd8frahbmd2trrxsfltfmeg.jpeg"></p><br><p>  El servidor se puede configurar en una de las siguientes funciones: Origen, Edge, Transcodificador.  Servidores de tipo de origen: reciba tr√°fico y distrib√∫yalo a los nodos de borde de los servidores de borde responsables de entregar la transmisi√≥n a los espectadores.  Si es necesario preparar una secuencia en varias resoluciones, los nodos de transcodificador se incluyen en el esquema, que asume la misi√≥n que consume recursos de transcodificar secuencias. </p><br><br><h2><a name="summarize"></a>  Para resumir </h2><br><p>  WCS 5.2 es un servidor para desarrollar aplicaciones con soporte de audio y video en tiempo real para navegadores y dispositivos m√≥viles.  Se proporcionan cuatro API para el desarrollo: Web SDK, iOS SDK, Android SDK, REST API.  Puede publicar (alimentar) transmisiones de video al servidor utilizando cinco protocolos: WebRTC, RTMP, RTSP, VOD, SIP / RTP.  Desde el servidor, puede reproducir transmisiones con reproductores utilizando cinco protocolos: WebRTC, RTMP, RTSP, MSE, HLS.  Las transmisiones se pueden controlar y realizar en operaciones tales como: grabar, cortar instant√°neas, mezclar, transcodificar, agregar una marca de agua, filtrar FPS, transmitir video enciende dispositivos m√≥viles.  Las transmisiones pueden transmitirse a otros servidores a trav√©s de los protocolos WebRTC y RTMP, as√≠ como redirigirse a conferencias SIP.  Los servidores se pueden integrar en una red de entrega de contenido y escalar para procesar una cantidad arbitraria de transmisiones de video. </p><br><br><h3>  <strong>Lo que Alice debe saber para trabajar con el servidor</strong> </h3><br><p>  El desarrollador necesita poder usar Linux.  Equipos de este tipo en <br>  La l√≠nea de comando no debe causar confusi√≥n: </p><br><pre> <code class="plaintext hljs">tar -xvzf wcs5.2.tar.gz</code> </pre> <br><pre> <code class="plaintext hljs">cd wcs5.2</code> </pre> <br><pre> <code class="plaintext hljs">./install.sh</code> </pre> <br><pre> <code class="plaintext hljs">tail -f flashphoner.log</code> </pre> <br><pre> <code class="plaintext hljs">ps aux | grep WebCallServer</code> </pre> <br><pre> <code class="plaintext hljs">top</code> </pre> <br><p>  Vanilla JavaScript tambi√©n debe ser capaz de desarrollar <br>  Web </p><br><pre> <code class="plaintext hljs">//  session.createStream({name:'mystream'}).publish(); //  session.createStream({name:'mystream'}).play();</code> </pre><br><p>  La capacidad de trabajar con el backend tambi√©n es √∫til. </p><br><p><img src="https://habrastorage.org/webt/3l/0a/9s/3l0a9shqbhfy4yjheu30ocammzg.jpeg"></p><br><p>  WCS no solo puede recibir comandos de control a trav√©s de la API REST, sino tambi√©n enviar ganchos, notificaciones sobre los eventos que ocurren en √©l. <br>  Por ejemplo, cuando intente establecer una conexi√≥n desde un navegador o una aplicaci√≥n m√≥vil, WCS llamar√° al enlace / connect, y cuando intente reproducir una transmisi√≥n, llamar√° al enlace playStream.  Por lo tanto, el desarrollador tendr√° que mantenerse un poco en la zaga del back-end, que puede escribir tanto un cliente REST simple como un peque√±o servidor REST para procesar ganchos. </p><br><p>  Ejemplo de API REST </p><br><pre> <code class="plaintext hljs">/rest-api/stream/find_all</code> </pre> <br><p>  - un ejemplo de una API REST para generar una lista de secuencias en un servidor </p><br><p>  Ejemplo de gancho REST </p><br><pre> <code class="plaintext hljs">https://myback-end.com/hook/connect</code> </pre> <br><p>  - REST enganchar / conectar el procesamiento en el lado del backend. </p><br><p>  Linux, JavaScript, REST Client / Server son los tres elementos que <br>  suficiente para desarrollar un servicio de producci√≥n en la plataforma WCS que funcione <br>  con transmisiones de video. </p><br><p>  El desarrollo de aplicaciones m√≥viles requiere conocimiento de Java y Objective-C <br>  para Android e iOS respectivamente. </p><br><br><h3>  <strong>Instalaci√≥n y lanzamiento</strong> </h3><br><p>  Hay tres formas de iniciar r√°pidamente WCS hoy: </p><br><p>  1) Instale en su Centos7 o Ubuntu 16.x LTS o Ubuntu 18.x LTS, y <br>  etc.  guiado por un <a href="https://docs.flashphoner.com/pages/viewpage.action%3FpageId%3D9241019">art√≠culo de la documentaci√≥n</a> . </p><br><p>  o </p><br><p>  2) Tome la <a href="https://flashphoner.com/podderzhka-oblachnyh-serverov-amazon-ec2-v-web-call-server/%3Flang%3Dru">imagen terminada en Amazon EC2</a> . </p><br><p>  o si no </p><br><p>  3) Tome la <a href="https://flashphoner.com/podderzhka-web-call-server-v-digital-ocean-marketplace/%3Flang%3Dru">imagen del servidor terminada en DigitalOcean</a> . </p><br><p>  Y comience un emocionante desarrollo de proyecto con funciones de transmisi√≥n de video. </p><br><p>  El art√≠culo de revisi√≥n result√≥ ser bastante voluminoso.  Gracias por eso <br>  leer paciencia </p><br><p>  ¬°Que tengas una buena transmisi√≥n! </p><br><br><br><h2><a name="Links"></a>  Referencias </h2><br><p>  <a href="https://flashphoner.com/">WCS 5.2</a> - Servidor WebRTC </p><br><h3>  Instalaci√≥n y lanzamiento </h3><br><p>  <a href="https://docs.flashphoner.com/pages/viewpage.action%3FpageId%3D9241019">Instalar y ejecutar WCS</a> </p><br><p>  <a href="https://flashphoner.com/podderzhka-oblachnyh-serverov-amazon-ec2-v-web-call-server/%3Flang%3Dru">Lanzar una imagen precompilada en Amazon AWS</a> </p><br><p>  <a href="https://flashphoner.com/podderzhka-web-call-server-v-digital-ocean-marketplace/%3Flang%3Dru">Lanzar la imagen terminada en DigitalOcean</a> </p><br><h3>  SDK </h3><br><p>  <a href="https://docs.flashphoner.com/display/WCS52RU/Web%2BSDK">Documentaci√≥n del SDK web</a> </p><br><p> <a href="https://docs.flashphoner.com/display/WCS52RU/Android%2BSDK">  Android SDK</a> </p><br><p> <a href="https://docs.flashphoner.com/display/WCS52RU/iOS%2BSDK">  iOS SDK</a> </p><br><h3>  </h3><br><p> <a href="https://docs.flashphoner.com/pages/viewpage.action%3FpageId%3D9241216"> </a> </p><br><p> <a href="https://docs.flashphoner.com/pages/viewpage.action%3FpageId%3D9241448"> </a> </p><br><p> <a href="https://docs.flashphoner.com/pages/viewpage.action%3FpageId%3D9241404"> </a> </p><br><p> <a href="https://docs.flashphoner.com/pages/viewpage.action%3FpageId%3D9241533"> </a> </p><br><p> <a href="">WebRTC CDN   </a> </p><br><h3>  La documentaci√≥n </h3><br><p> <a href="https://docs.flashphoner.com/display/WCS52RU/Web%2BCall%2BServer%2B5.2%2B-%2BRU"> Web Call Server 5.2</a> </p><br><br></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/482960/">https://habr.com/ru/post/482960/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../482946/index.html">1–° DSS y estimaci√≥n de t√©rminos y costos de proyectos por el m√©todo COCOMO II</a></li>
<li><a href="../482948/index.html">"Uno, dos, tres: ¬°quema el √°rbol de Navidad!" O mi primer vistazo al peque√±o controlador CANNY 3</a></li>
<li><a href="../482950/index.html">Java: cosas que pueden parecer curiosas para un desarrollador experimentado</a></li>
<li><a href="../482956/index.html">Revisi√≥n de WCS 5.2 - Servidor WebRTC para desarrolladores de Webcast y Webcam</a></li>
<li><a href="../482958/index.html">"Reglas de crecimiento: de junior a CTO", resumen de un webinar de Fedor Borshchev</a></li>
<li><a href="../482968/index.html">Quarkus: una nueva mirada a Cloud Native Java</a></li>
<li><a href="../482970/index.html">Hack The Box - Tutorial de artesan√≠a. Profundizamos en Git, explotamos vulnerabilidades en la API, tratamos con Vault</a></li>
<li><a href="../482974/index.html">Apoyo a la salud mental con realidad virtual</a></li>
<li><a href="../482976/index.html">An√°lisis de transacciones an√≥nimas en el comercio de acciones.</a></li>
<li><a href="../482978/index.html">Analizador Blockchain con 300 l√≠neas en Python</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>