<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🗡️ 🏛️ 🤙🏽 Sauvegarde rapide et fiable des données dans le cloud 🦎 🙄 🏅</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="La sauvegarde sous Windows est l'une des tâches les plus problématiques pour l'utilisateur moyen, ce qui garantirait la fermeture des problèmes suivan...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Sauvegarde rapide et fiable des données dans le cloud</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/413467/">  La sauvegarde sous Windows est l'une des tâches les plus problématiques pour l'utilisateur moyen, ce qui garantirait la fermeture des problèmes suivants: <br><br><ul><li>  rapide (parfait en arrière-plan); </li><li>  Il conserverait à la fois la version actuelle des fichiers et les précédents; </li><li>  le stockage des fichiers ne serait pas accessible aux virus ou aux catastrophes naturelles telles que la destruction du support ou son vol; </li><li>  le contenu de la copie de sauvegarde ne serait accessible qu'à l'utilisateur, c'est-à-dire  était protégé par mot de passe. </li></ul><br>  Il existe de nombreuses suggestions à ce sujet, mais aucune ne termine la tâche.  Une copie facile et simple ne donne pas de vitesse, une sauvegarde rapide ne donne pas de fiabilité, la copie sur un disque dur externe ne garantit pas son vol. <br><br>  Cependant, il existe depuis longtemps des outils pour résoudre le problème.  L'essentiel est d'appliquer correctement la voie Unix et les fichiers batch.  Et l'option la plus simple consiste à archiver les fichiers dans une archive et à les envoyer au stockage en ligne à l'aide de la ligne de commande.  Pour accélérer le travail, la tâche est divisée en 2 étapes - tout d'abord, une archive complète est créée et envoyée au stockage en ligne, puis des archives incrémentielles sont créées si nécessaire, ce qui donne de la vitesse.  Le chiffrement des archives garantit la sécurité des données. <br><a name="habracut"></a><br>  Ce qui est nécessaire pour résoudre le problème: <br><br><ul><li>  Compte Yandex pour obtenir l'accès webdav au disque Yandex.  L'utilisation de tout autre stockage n'est pas interdite; </li><li>  7z - archiveur de console, distribué gratuitement; </li><li>  curl - un outil de console pour travailler avec Internet, distribué gratuitement. </li></ul><br>  Pour la <b>portabilité</b> , j'ai mis <b>7z.exe</b> , <b>7z.dll</b> et <b>Curl.exe</b> dans un répertoire.  Selon la façon dont <b>Curl.exe a</b> été compilé, il peut être nécessaire de placer les bibliothèques <b>libeay32.dll</b> , <b>libssh2.dll</b> , <b>msvcr100.dll</b> , <b>MSVCR110.dll à</b> proximité ou d'ajouter au système. <br><br>  Plus loin dans ce répertoire, il est souhaitable de créer un répertoire dans lequel vous souhaitez placer les fichiers et répertoires pour la future archive.  Je l'ai appelé <i>«sauvegarde»</i> et je mets des liens durs vers des fichiers ou un lien de répertoire (la fonctionnalité correspondante est en FAR en utilisant la combinaison de touches Alt + F6).  Ainsi, je peux, sans changer la structure des données existantes, créer une structure qui me convient pour la sauvegarde. <br><br>  Le répertoire suivant est <i>temp</i> .  Conçu pour stocker une archive de données avant de l'envoyer au serveur.  En même temps, il s'agira d'une copie chiffrée des données actuelles, qui fournit une sauvegarde supplémentaire en cas d'attaque virale. <br><br>  Ensuite, dans le répertoire source, vous devez créer un fichier bat (cmd) assez simple <b>«full.bat» avec le</b> contenu suivant: <br><br><pre><code class="dos hljs">@<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> off <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> filebkp=work <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> pathbkp=backup <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> srvbkp=https://user:password@webdav.yandex.ru/backup/<span class="hljs-variable"><span class="hljs-variable">%filebkp%</span></span> <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> pathtemp=temp <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> full=<span class="hljs-variable"><span class="hljs-variable">%filebkp%</span></span>-full <span class="hljs-built_in"><span class="hljs-built_in">del</span></span> /F /Q "<span class="hljs-variable"><span class="hljs-variable">%pathtemp%</span></span>"\ <span class="hljs-number"><span class="hljs-number">7</span></span>z.exe a "<span class="hljs-variable"><span class="hljs-variable">%pathtemp%</span></span>\<span class="hljs-variable"><span class="hljs-variable">%full%</span></span>".<span class="hljs-number"><span class="hljs-number">7</span></span>z -x!*.log; -r -mx1 "<span class="hljs-variable"><span class="hljs-variable">%pathbkp%</span></span>\*" -ppass_for_archive curl.exe -k -X DELETE "<span class="hljs-variable"><span class="hljs-variable">%srvbkp%</span></span>" --verbose -o .\stdout curl.exe -k -X MKCOL "<span class="hljs-variable"><span class="hljs-variable">%srvbkp%</span></span>" --verbose -o .\stdout curl.exe -k -T "<span class="hljs-variable"><span class="hljs-variable">%pathtemp%</span></span>\<span class="hljs-variable"><span class="hljs-variable">%full%</span></span>".<span class="hljs-number"><span class="hljs-number">7</span></span>z "<span class="hljs-variable"><span class="hljs-variable">%srvbkp%</span></span>"/ --progress-bar --verbose -o .\stdout</code> </pre> <br><ul><li>  <b>set filebkp = work</b> - définissez le nom commun de l'ordinateur et le chemin sur le serveur où la sauvegarde sera stockée.  Parce que  il peut y avoir plusieurs ordinateurs, alors il peut s'agir d'une copie de sauvegarde d'un ordinateur de travail (travail), d'un domicile (domicile), d'un ordinateur portable (livre), indiquant qu'un nom individuel ne permettra pas aux copies de se mélanger. </li><li>  <b>set pathbkp = backup</b> - définissant le chemin d'accès au répertoire où les données de sauvegarde sont stockées, dans ce cas, le répertoire avec les liens matériels et les liens de répertoire que vous auriez dû créer plus tôt est indiqué. </li><li>  <b>set srvbkp = https: // user: password@webdav.yandex.ru/backup/%filebkp%</b> - spécifiez le répertoire sur le serveur où la sauvegarde sera téléchargée.  utilisateur et mot de passe - mots de passe de votre compte sur Yandex; </li><li>  <b>set full =% filebkp% -full</b> - définit le nom de l'archive à l'avance. </li><li>  <b>del / F / Q "% pathtemp%" \</b> - supprimer (effacer) le répertoire temporaire </li><li>  <b>7z.exe un "% pathtemp% \% full%". 7z -x! *. Log;</b>  <b>-r -mx1 "% pathbkp% \ *" -p <u>pass_for_archive</u></b> - la ligne de lancement de l'archiveur.  <u>pass_for_archive</u> - Votre mot de passe pour l'archive. </li><li>  <b>curl.exe -k -X DELETE "% srvbkp%" --verbose -o. \ stdout</b> - supprimez le répertoire de destination sur le serveur. </li><li>  <b>curl.exe -k -X MKCOL "% srvbkp%" --verbose -o. \ stdout</b> - recrée le répertoire de destination sur le serveur. </li><li>  <b>curl.exe -k -T "% pathtemp% \% full%". 7z "% srvbkp%" / --progress-bar --verbose -o. \ stdout</b> - télécharge l'archive curl sur le serveur. </li></ul><br>  Ainsi, en exécutant le script <b>"full.bat"</b> , vous recevrez la version complète de vos fichiers dans l'archive dans le répertoire <i>"temp"</i> et la même dans le répertoire <i>"backup / work"</i> sur le serveur, cryptée avec votre mot de passe.  Cela peut prendre un certain temps et a ses limites sur le volume de l'archive, mais les données les plus importantes et changeant quotidiennement doivent être archivées de cette manière. <br><br>  Pourquoi sont importants et changent quotidiennement?  Parce que le script suivant, <b>«inc.bat»</b> , vous permet de rechercher et d'envoyer des données modifiées au serveur dans une archive incrémentielle qui diffère de la version complète: <br><br><pre> <code class="dos hljs">@<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> off <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> filebkp=work <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> pathbkp=..\backup <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> srvbkp=https://user:password@webdav.yandex.ru/backup/<span class="hljs-variable"><span class="hljs-variable">%filebkp%</span></span> <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> pathtemp=..\temp <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> full=<span class="hljs-variable"><span class="hljs-variable">%filebkp%</span></span>-full <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> inc=<span class="hljs-variable"><span class="hljs-variable">%filebkp%</span></span>-inc <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> h=<span class="hljs-variable"><span class="hljs-variable">%TIME:~0,2%</span></span> <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> m=<span class="hljs-variable"><span class="hljs-variable">%TIME:~3,2%</span></span> <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> s=<span class="hljs-variable"><span class="hljs-variable">%TIME:~6,2%</span></span> <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> ms=<span class="hljs-variable"><span class="hljs-variable">%TIME:~9,2%</span></span> <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> curtime=<span class="hljs-variable"><span class="hljs-variable">%h%</span></span>-<span class="hljs-variable"><span class="hljs-variable">%m%</span></span>-<span class="hljs-variable"><span class="hljs-variable">%s%</span></span> <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> dd=<span class="hljs-variable"><span class="hljs-variable">%DATE:~0,2%</span></span> <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> mm=<span class="hljs-variable"><span class="hljs-variable">%DATE:~3,2%</span></span> <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> yyyy=<span class="hljs-variable"><span class="hljs-variable">%DATE:~6,4%</span></span> <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> curdate=<span class="hljs-variable"><span class="hljs-variable">%yyyy%</span></span>-<span class="hljs-variable"><span class="hljs-variable">%mm%</span></span>-<span class="hljs-variable"><span class="hljs-variable">%dd%</span></span> <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> curdatetime=<span class="hljs-variable"><span class="hljs-variable">%curdate%</span></span> <span class="hljs-variable"><span class="hljs-variable">%curtime%</span></span> <span class="hljs-number"><span class="hljs-number">7</span></span>z.exe u "<span class="hljs-variable"><span class="hljs-variable">%pathtemp%</span></span>\<span class="hljs-variable"><span class="hljs-variable">%full%</span></span>".<span class="hljs-number"><span class="hljs-number">7</span></span>z -x!*.log; -u- -up3q3r2x2y2z0w2!"<span class="hljs-variable"><span class="hljs-variable">%pathtemp%</span></span>\<span class="hljs-variable"><span class="hljs-variable">%inc%</span></span>".<span class="hljs-number"><span class="hljs-number">7</span></span>z "<span class="hljs-variable"><span class="hljs-variable">%pathbkp%</span></span>\*" -ppass_for_archive <span class="hljs-built_in"><span class="hljs-built_in">ren</span></span> "<span class="hljs-variable"><span class="hljs-variable">%pathtemp%</span></span>\<span class="hljs-variable"><span class="hljs-variable">%inc%</span></span>".<span class="hljs-number"><span class="hljs-number">7</span></span>z "<span class="hljs-variable"><span class="hljs-variable">%inc%</span></span> <span class="hljs-variable"><span class="hljs-variable">%curdatetime%</span></span>".<span class="hljs-number"><span class="hljs-number">7</span></span>z curl.exe -k -T "<span class="hljs-variable"><span class="hljs-variable">%pathtemp%</span></span>\<span class="hljs-variable"><span class="hljs-variable">%inc%</span></span> <span class="hljs-variable"><span class="hljs-variable">%curdatetime%</span></span>".<span class="hljs-number"><span class="hljs-number">7</span></span>z "<span class="hljs-variable"><span class="hljs-variable">%srvbkp%</span></span>"/ --progress-bar --verbose -o .\stdout</code> </pre><br>  Je pense que vous pouvez décrypter ce fichier vous-même - en utilisant 7z, le script analyse l'archive complète et le répertoire source dans <i>le</i> répertoire <i>temporaire</i> , trouve les fichiers modifiés, les emballe dans une archive incrémentielle nommée par la date et l'heure actuelles et l'envoie au serveur.  Ainsi, si une sauvegarde complète dure environ 1 gigaoctet et 3 minutes, les fichiers modifiés prennent généralement 10 à 50 mégaoctets et volent vers le serveur en quelques secondes.  En plaçant <b>«inc.bat»</b> dans le Planificateur de tâches Windows, vous permettrez à ce processus de se produire selon un calendrier à un moment qui vous convient, ce qui vous permettra de l'oublier. <br><br>  Lorsqu'il vous semble que le temps de création de copies incrémentielles est devenu trop long, vous pouvez exécuter à nouveau <b>«full.bat»</b> - cela <b>effacera</b> tous les répertoires des archives complètes et incrémentielles et créera une nouvelle version de la version complète. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr413467/">https://habr.com/ru/post/fr413467/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr413457/index.html">Virgin Orbit - Nouvel acteur du marché du booster sous-orbite</a></li>
<li><a href="../fr413459/index.html">Le talent d'un recruteur informatique - en quoi les créateurs se distinguent-ils des artisans?</a></li>
<li><a href="../fr413461/index.html">ReactOS est devenu autosuffisant l'année de son 21e anniversaire</a></li>
<li><a href="../fr413463/index.html">API REST Magento 2 utilisant un module simple comme exemple</a></li>
<li><a href="../fr413465/index.html">AMD annonce Threadripper 2 à 32 cœurs</a></li>
<li><a href="../fr413469/index.html">Un test de mémoire tuant des ordinateurs portables est presque une histoire de détective</a></li>
<li><a href="../fr413471/index.html">Vendredi Mini Tomy Fancy Toy Retrospective</a></li>
<li><a href="../fr413473/index.html">Développement d'un interrupteur tactile Z-Wave sur la batterie avec boutons lumineux</a></li>
<li><a href="../fr413479/index.html">Nous écrivons notre protocole sur UDP</a></li>
<li><a href="../fr413481/index.html">Exporter l'arbre de test de JMeter vers le texte</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>