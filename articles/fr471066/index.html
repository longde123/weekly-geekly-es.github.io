<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üíè üéÇ üëò √Ä quoi ressemble l'archive zip et que pouvons-nous faire √† ce sujet üßê üò© üçù</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bonjour, cher Habr! 

 Au cours des six derniers mois, le chemin tortueux de mes projets d'animaux de compagnie m'a conduit dans une telle jungle, d'o...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>√Ä quoi ressemble l'archive zip et que pouvons-nous faire √† ce sujet</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/471066/"> Bonjour, cher Habr! <br><br>  Au cours des six derniers mois, le chemin tortueux de mes projets d'animaux de compagnie m'a conduit dans une telle jungle, d'o√π il n'est toujours pas possible de sortir.  Et tout a commenc√© sans danger - un site avec des images, mais un sentiment de perfectionnisme, la poursuite d'un cadeau, ainsi que certaines caract√©ristiques de mon √©tat d'esprit ont transform√© cela, comme pr√©vu √† l'origine, en une petite promenade dans un vrai long voyage.  Eh bien, d'accord, comme disait un r√©volutionnaire plut√¥t enterr√©: ¬´Apprenez, √©tudiez et √©tudiez √† nouveau¬ª, mais moi, bon gr√© mal gr√©, je dois suivre cet avertissement. <br><br>  Oh, quelque chose que nous avons √©t√© distraits du sujet principal.  Je ne vous ennuierai plus avec de longs discours, mais je passerai aux choses s√©rieuses. <br><a name="habracut"></a><br><h3>  Cr√©er une archive zip </h3><br>  En principe, je ne r√©√©crirai pas la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">sp√©cification</a> ici.  Dans l'ensemble, cela n'a pas de sens non plus de d√©crire la structure, car tout cela a √©t√© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">fait avant moi</a> . <br><br>  Pour ceux qui sont trop paresseux pour suivre les liens, je soulignerai bri√®vement que toute archive zip doit contenir: <br><br><ul><li>  Entr√©e de fichier: <ul><li>  En-t√™te de fichier local </li><li>  Donn√©es utiles </li><li>  Descripteur de donn√©es (facultatif, utilis√© lorsque nous ne connaissons pas la taille du fichier et son hachage jusqu'√† ce que nous le lisions √† la fin) </li></ul></li><li>  En-t√™te de fichier du r√©pertoire central (pour chaque fichier. C'est comme une table des mati√®res d'un livre, o√π chaque section et page sur laquelle il peut √™tre trouv√© sont indiqu√©es) </li><li>  Fin du r√©pertoire central </li></ul><br>  Sachant cela, nous pouvons essayer d'√©crire une archive simple qui ne contiendra que deux fichiers: <br><br><pre><code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-comment"><span class="hljs-comment">//        (1.txt  2.txt)   : $entries = [ '1.txt' =&gt; 'Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nunc id ante ultrices, fermentum nibh eleifend, ullamcorper nunc. Sed dignissim ut odio et imperdiet. Nunc id felis et ligula viverra blandit a sit amet magna. Vestibulum facilisis venenatis enim sed bibendum. Duis maximus felis in suscipit bibendum. Mauris suscipit turpis eleifend nibh commodo imperdiet. Donec tincidunt porta interdum. Aenean interdum condimentum ligula, vitae ornare lorem auctor in. Suspendisse metus ipsum, porttitor et sapien id, fringilla aliquam nibh. Curabitur sem lacus, ultrices quis felis sed, blandit commodo metus. Duis tincidunt vel mauris at accumsan. Integer et ipsum fermentum leo viverra blandit.', '2.txt' =&gt; 'Mauris in purus sit amet ante tempor finibus nec sed justo. Integer ac nibh tempus, mollis sem vel, consequat diam. Pellentesque ut condimentum ex. Praesent finibus volutpat gravida. Vivamus eleifend neque sit amet diam scelerisque lacinia. Nunc imperdiet augue in suscipit lacinia. Curabitur orci diam, iaculis non ligula vitae, porta pellentesque est. Duis dolor erat, placerat a lacus eu, scelerisque egestas massa. Aliquam molestie pulvinar faucibus. Quisque consequat, dolor mattis lacinia pretium, eros eros tempor neque, volutpat consectetur elit elit non diam. In faucibus nulla justo, non dignissim erat maximus consectetur. Sed porttitor turpis nisl, elementum aliquam dui tincidunt nec. Nunc eu enim at nibh molestie porta ut ac erat. Sed tortor sem, mollis eget sodales vel, faucibus in dolor.', ]; //      Lorem.zip,      cwd (      ) $destination = 'Lorem.zip'; $handle = fopen($destination, 'w'); //      ,    ,     ,   "" Central Directory File Header $written = 0; $dictionary = []; foreach ($entries as $filename =&gt; $content) { //         Local File Header,     //        ,      . $fileInfo = [ //     'versionToExtract' =&gt; 10, //   0,        - 'generalPurposeBitFlag' =&gt; 0, //      ,    0 'compressionMethod' =&gt; 0, // -    mtime ,    ,      ? 'modificationTime' =&gt; 28021, //   , ? 'modificationDate' =&gt; 20072, //      .     ,       ,   ? 'crc32' =&gt; hexdec(hash('crc32b', $content)), //     .        . //       :) 'compressedSize' =&gt; $size = strlen($content), 'uncompressedSize' =&gt; $size, //    'filenameLength' =&gt; strlen($filename), //  .    ,   0. 'extraFieldLength' =&gt; 0, ]; //      . $LFH = pack('LSSSSSLLLSSa*', ...array_values([ 'signature' =&gt; 0x04034b50, //  Local File Header ] + $fileInfo + ['filename' =&gt; $filename])); //       ,       Central Directory File Header $dictionary[$filename] = [ 'signature' =&gt; 0x02014b50, //  Central Directory File Header 'versionMadeBy' =&gt; 798, //  .    ,  -  . ] + $fileInfo + [ 'fileCommentLength' =&gt; 0, //    . No comments 'diskNumber' =&gt; 0, //     0,        'internalFileAttributes' =&gt; 0, //    'externalFileAttributes' =&gt; 2176057344, //    'localFileHeaderOffset' =&gt; $written, //      Local File Header 'filename' =&gt; $filename, //  . ]; //      $written += fwrite($handle, $LFH); //    $written += fwrite($handle, $content); } // ,     ,    . //          End of central directory record (EOCD) $EOCD = [ //  EOCD 'signature' =&gt; 0x06054b50, //  .    ,   0 'diskNumber' =&gt; 0, //      -  0 'startDiskNumber' =&gt; 0, //       . 'numberCentralDirectoryRecord' =&gt; $records = count($dictionary), //    .    ,     'totalCentralDirectoryRecord' =&gt; $records, //   Central Directory Record. //      ,      'sizeOfCentralDirectory' =&gt; 0, // ,    Central Directory Records 'centralDirectoryOffset' =&gt; $written, //     'commentLength' =&gt; 0 ]; //     !   foreach ($dictionary as $entryInfo) { $CDFH = pack('LSSSSSSLLLSSSSSLLa*', ...array_values($entryInfo)); $written += fwrite($handle, $CDFH); } // ,   .  ,    $EOCD['sizeOfCentralDirectory'] = $written - $EOCD['centralDirectoryOffset']; //     End of central directory record $EOCD = pack('LSSSSLLS', ...array_values($EOCD)); $written += fwrite($handle, $EOCD); //  . fclose($handle); echo '  : ' . $written . ' ' . PHP_EOL; echo '     `unzip -tq ' . $destination . '`' . PHP_EOL; echo PHP_EOL;</span></span></code> </pre> <br>  Essayez d'ex√©cuter ce code primitif et la sortie vous donnera un fichier Lorem.zip qui contiendra 1.txt et 2.txt. <br><br><h3>  Pourquoi? </h3><br>  Bien s√ªr, toute personne ad√©quate dira qu'√©crire des archiveurs en php est une entreprise futile, d'autant plus que pour un format tel que zip, il existe un tas d'impl√©mentations pr√™tes √† l'emploi pour tous les go√ªts et toutes les couleurs.  Et dans le m√™me php, il y a des biblioth√®ques pr√™tes √† l'emploi.  Je le dirai aussi :) <br><br>  Mais pourquoi donc tout cet article, pourquoi ai-je pass√© du temps √† l'√©crire et vous √† le lire? <br>  Et puis, que tout n'est pas si simple et savoir comment fonctionne zip, nous ouvre des possibilit√©s suppl√©mentaires. <br><br>  Tout d'abord, j'esp√®re, au moins un peu, mais cela aidera ceux qui veulent comprendre la structure du zip. <br>  Et deuxi√®mement, en cr√©ant l'archive de nos propres mains, nous avons le contr√¥le et, surtout, l'acc√®s √† ses donn√©es internes. <br><br>  Nous pouvons pr√©-calculer l'en-t√™te de fichier local et l'en-t√™te de fichier du r√©pertoire central, puis g√©n√©rer √† la demande une archive zip √† la vol√©e avec n'importe quel contenu et ordre de fichiers, en rempla√ßant simplement ces donn√©es.  Et pas de frais g√©n√©raux, sauf pour les E / S. <br><br>  Ou, nous pouvons enregistrer l'archive, la t√©l√©charger, par exemple, dans le cloud, qui prend en charge le t√©l√©chargement fragment√© et, connaissant les d√©calages pour chaque fichier, obtenir l'un des fichiers d'archive, comme s'il n'√©tait pas du tout dans l'archive, en ajoutant un seul titre de la demande.  Et puis tout cela peut √™tre mandat√© et ... <br><br>  D'accord, ne prenons pas de l'avance sur nous-m√™mes.  Si vous √™tes int√©ress√© par ce sujet, alors dans les articles suivants, j'essaierai de consid√©rer ces opportunit√©s et de montrer comment les utiliser. <br><br><hr><blockquote>  'diskNumber' =&gt; 0, // J'ai g√©n√©ralement rencontr√© 0 partout, et en particulier j'ai d√©cid√© de ne pas me plonger dans </blockquote>  Comme l'a sugg√©r√© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link">Berez</a> , le num√©ro de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link">volume</a> dans l'archive multi-volumes. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr471066/">https://habr.com/ru/post/fr471066/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr471048/index.html">React + Mobx: √† quoi √ßa sert?</a></li>
<li><a href="../fr471050/index.html">D Financement du Fonds de d√©veloppement linguistique: nouvelles plateformes et nouvelles subventions ...</a></li>
<li><a href="../fr471052/index.html">Puis-je Haz? Frapp√© par la programmation de type g√©n√©rique</a></li>
<li><a href="../fr471054/index.html">Longrid sur le r√©alisme de la menace quantique pour les crypto-monnaies et les probl√®mes de la "proph√©tie 2027"</a></li>
<li><a href="../fr471062/index.html">Comment apprendre √† Alice √† g√©rer votre maison intelligente. Rapport Yandex</a></li>
<li><a href="../fr471070/index.html">Quelle langue de serveur choisir ... pour un d√©veloppeur mobile</a></li>
<li><a href="../fr471072/index.html">Combien de grammes en t√©l√©gramme?</a></li>
<li><a href="../fr471074/index.html">Synet - un cadre pour lancer des r√©seaux de neurones pr√©-form√©s sur le CPU</a></li>
<li><a href="../fr471076/index.html">Comment la matrice a cr√©√© un h√©ritage pare-balles</a></li>
<li><a href="../fr471078/index.html">Chrome bloquera compl√®tement le contenu mixte</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>