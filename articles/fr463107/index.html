<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🎴 🐧 🏫 ShIoTiny: petite automatisation, Internet des objets, ou «six mois avant les vacances» 🧜🏾 ✔️ 🎈</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Points clés ou sujet de cet article 


 Étant donné que les intérêts des gens sont différents et que les gens ont peu de temps, parlons brièvement du ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ShIoTiny: petite automatisation, Internet des objets, ou «six mois avant les vacances»</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/463107/"><br><img src="https://habrastorage.org/webt/op/yn/2p/opyn2pdqpdygsj93bqeqbyhuv6i.jpeg"><br><br><h4 id="osnovnye-tezisy-ili-o-chem-eta-statya">  Points clés ou sujet de cet article </h4><br><p>  Étant donné que les intérêts des gens sont différents et que les gens ont peu de temps, parlons brièvement du contenu de l'article. </p><br><p>  <strong>Cet</strong> article est un aperçu du projet de contrôleur avec un prix minimum et la possibilité de <strong>programmation visuelle</strong> via un navigateur WEB. </p><br><p>  Puisqu'il s'agit d'un article de revue visant à montrer «ce qui peut être retiré d'un contrôleur de penny», vous ne devriez pas y chercher des vérités profondes et des algorithmes détaillés. </p><br><p>  <strong>La</strong> motivation, les idées et les résultats de la construction d'un contrôleur basé sur la puce WiFI ESP8266 sont pris en compte. </p><a name="habracut"></a><br><h4 id="ipreduprezhdeniei">  <i>Avertissement</i> </h4><br><p>  <i>Je ne voulais pas écrire cet article.</i>  <i>Je ne suis pas du tout fan d'écrire des articles.</i>  <i>Il faut réfléchir et en plus - beaucoup.</i>  <i>Penser comment écrire pour minimiser le nombre d'incompréhensions.</i>  <i>Penser comment ne pas aller aux extrêmes.</i>  <i>Et bien plus encore.</i> <i><br></i>  <i>Mais des amis ont dit que puisque mes efforts dans le domaine de l'IoT et d'autres petites automatisations sont intéressants pour eux, ils peuvent être intéressants pour d'autres pour le grand public.</i>  <i>Eh bien, où va le public qui s'intéresse à cela?</i>  <i>Bien sûr, sur un habr.</i>  <i>Et me voici.</i>  <i>Ancien lecteur et nouvel écrivain.</i> <i><br><br></i>  <i>Pour les erreurs, inexactitudes, fautes de frappe, style de présentation non moderne, etc. qui pourraient ne pas plaire au lecteur, je n'assume aucune responsabilité.</i>  <i>Lisez à vos risques et périls.</i> <i><br><br></i>  <i>Je préviens également immédiatement que je n'expliquerai pas ce que la multidiffusion MQTT, WiFi et UDP et d'autres choses qui ne sont pas directement liées au sujet.</i>  <i>Certains liens se trouvent à la fin de l'article.</i> </p><br><h4 id="rozhdenie-idei-ili-nemnogo-liriki">  La naissance d'une idée ou de quelques paroles </h4><br><p>  Eh bien, la vie n'est pas une chose simple, et Sa Majesté Chance y joue un rôle important.  Je veux donc partager comment les événements aléatoires, multipliés par la paresse régulière, ont abouti à une conception de contrôleur plutôt intéressante basée sur ESP8266. </p><br><p>  Tout a commencé de façon plutôt nonchalante: je voulais construire un système de contrôle du système d'alimentation en eau et arroser les parterres du jardin à la campagne. </p><br><p>  <strong>Mais à</strong> peu près, puisque je ne peux m'engager pleinement dans des camions-citernes-grues qu'en vacances, avant lesquelles il y avait encore plus de six mois - tout était limité à des discussions au travail avec des collègues et des amis-camarades dans un cadre informel. </p><br><p>  <strong>Le</strong> sujet de la «petite automatisation» ou, comme il est d'usage de le dire dans «ces écoliers hacker-hacker» - le sujet de l'IoT - l'Internet des objets - m'intéresse depuis longtemps.  Bien avant l'avènement d'Internet en tant que tel, largement utilisé. </p><br><p>  Même dans mon enfance, je voulais que les choses fassent quelque chose «elles-mêmes».  Et il est souhaitable que je puisse les contrôler à distance.  Mais à cette époque (les années 80, le début des années 90 du dernier millénaire), c'était difficile.  Internet n'était pas disponible partout dans le monde, car il n'y avait nulle part et des téléphones portables, des tablettes et même des écrans LCD et des clés USB.  J'ai donc dû me limiter aux "interrupteurs d'éclairage sur le clap" et aux télécommandes radio les plus simples.  Mais pour ces temps et cet âge, c'était agréable et intéressant. </p><br><p>  <strong>Mais</strong> c'est le passé.  Nonche dans la cour du XXIème siècle.  Et tout le monde a un smartphone dans sa poche, Internet est presque partout où il est nécessaire et non nécessaire, et la base de données des composants électroniques disponibles est maintenant telle qu'il y a 15 ans, l'habitant ordinaire de la planète Terre n'en rêvait même pas. </p><br><p>  Par conséquent, ayant décidé de mouler un contrôleur pour les affaires de l'eau dans le pays, j'ai tourné mes yeux vers la puce ESP8266. <br>  Tout d'abord, cette puce est bon marché.  Et si un contrôleur ne suffit pas - vous pouvez en mettre deux, trois ou cinq.  Deuxièmement, il dispose du WiFi à bord.  Autrement dit, vous pouvez regarder ce qui se passe via Internet et même contrôler le processus depuis n'importe quel smartphone.  Bien sûr, vous avez besoin d'un point d'accès avec accès à Internet, mais ce n'est pas un problème.  Quoi qu'il en soit, c'est presque partout, ou est sur le point de l'être, y compris - et dans ma maison de campagne. </p><br><p>  Après avoir plongé dans le monde merveilleux des projets pour ESP8266, j'ai été surpris de constater que, malgré les capacités impressionnantes de cette puce, les projets dessus, à de rares exceptions près, sont divisés en deux types: ce sont des programmes extrêmement primitifs comme «cliquez sur les rouleaux du smartphone et regardez l'état capteur de température via Internet »;  ou de bons et solides interprètes de JavaScript ou Lua, mais malheureusement, ils consomment presque toute la mémoire et ne vous permettent pas de faire quelque chose de sérieux. </p><br><p>  Ma première idée était aussi simple qu'une crêpe - écrire un programme de contrôle de pompe simple basé sur l'état des capteurs et c'est tout.  Mais, comme un kalach déchiqueté en termes de sauter sur le râteau d'introduire différents systèmes, j'ai réalisé que je ne serais certainement pas en mesure de prévoir tous les virages de l'algorithme que j'aimerais ou que je devrais redresser pendant la construction du système d'approvisionnement en eau et d'irrigation. </p><br><p>  <strong>D</strong> élaborer le programme dans le pays, dans une grange sombre - n'est pas très pratique.  Et vous devez. <br>  Quelle est la sortie?  Bien sûr, la première chose qui m'est venue à l'esprit était de rendre l'algorithme personnalisable.  Un de mes collègues a donné de nombreux conseils - quoi configurer et comment.  Avec cela, il a coupé ma première idée dans l'œuf.  Merci à lui.  S'il n'avait pas déployé sous mes yeux le nombre de paramètres que je devrais configurer, je ne refuserais probablement pas cette option: créer une page de paramètres d'algorithme. </p><br><p>  <strong>Mais</strong> une image terrifiante du nombre de paramètres de réglage, et même de s'influencer mutuellement - m'a dégrisé.  Encore une fois, je me suis rendu compte que rien ne pouvait être prévu ... </p><br><p>  Je vais réserver tout de suite: je suis paresseux.  Très paresseux!  Je suis franchement paresseux pour réécrire le programme à chaque fois.  Par conséquent, la tâche s'est posée - comment définir rapidement et facilement un algorithme, de préférence sans programmation?  De plus, cet algorithme sera assez compliqué;  aura beaucoup de paramètres;  Elle sera individuelle pour mon cas et inadaptée aux autres.  Et je veux vraiment rendre l'appareil plus ou moins universel ... </p><br><p>  Puisqu'il y avait encore environ six mois avant les vacances et toute la tuyauterie, j'ai décidé de prendre mon temps pour réfléchir: comment le rendre pratique et beau?  Comment programmer sans programmation?  Comment faire sans un billion de paramètres qui peuvent être modifiés lors de la configuration? </p><br><p>  Comme d'habitude, tout a déjà été pensé devant nous: j'ai réalisé que je voulais dessiner un algorithme sous forme de carrés d'action et les connecter avec des lignes de communication qui montrent d'où et d'où les données volent.  Eh bien, en fouillant dans la boîte, je veux pouvoir configurer certains de ses paramètres individuels. </p><br><p>  <strong>Et l'</strong> acte de définir l'algorithme, de le dessiner avec des carrés n'est pas nouveau.  Ces systèmes étaient de retour dans les années 80;  il existe un système NodeRed super populaire qui est bien connu de ceux qui ont déjà rejoint le monde de la petite automatisation / IoT. </p><br><p>  <strong>Mais</strong> ce n'est pas de chance: de tels systèmes sont conçus pour les «gros PC».  Au pire, sur le Raspberry PI.  Mais pas du tout sur l'ESP8266, qui n'a que quelques dizaines de kilo-octets de RAM et il n'y a pas de système d'exploitation! </p><br><p>  Comment être?  Et il n'y a que deux solutions: écrire et dessiner un programme sur un "grand PC" ou un ordinateur portable, puis le transférer sous une forme ou une autre sur ESP8266 ou essayer de "fourrer les indésirables" dans le contrôleur ESP8266 lui-même. </p><br><p>  Par conséquent, le programme maximum que j'avais était le suivant: pour programmer votre contrôleur, il ne devrait y avoir besoin de rien d'autre qu'un ordinateur portable avec un navigateur WEB!  C'est-à-dire, un ordinateur portable avec un navigateur WEB et mon contrôleur - cela devrait suffire pour configurer complètement et écrire des programmes de contrôle. </p><br><p>  <strong>Et</strong> , il s'est avéré qu'il était tout à fait possible de le réaliser! <br>  Je ne vous ennuierai pas avec tous les détails de l'élaboration du projet.  Je peux seulement dire que sur la base des mots qui me sont venus à l'esprit et à la langue au cours du processus de développement, il serait possible de compiler un « <em>Dictionnaire de la vulgarité des travailleurs électroniques</em> » distinct.  Mais tout est derrière.  Plus précisément, pas tous, mais la première étape, la plus difficile, quand ce n'est pas clair - votre idée sera-t-elle de vivre ou est-ce simplement un non-sens du hongre un soir de pleine lune. </p><br><p>  <strong>Je</strong> partagerai le résultat de ce qui est sorti et s'appelle le <b>«contrôleur ShIoTiny»</b> . </p><br><h4 id="i-chto-zhe-vyshlo">  Et que s'est-il passé? </h4><br><p>  <b>Le matériel du</b> contrôleur ShIoTiny est standard et simple: trois entrées conçues pour les capteurs à contact sec (boutons, interrupteurs reed, ils sont également des capteurs de niveau d'eau dans le réservoir), une entrée ADC, une entrée pour connecter un capteur de température et d'humidité comme DHT22 ou similaire .  Et enfin, trois sorties sous forme de relais de commutation pour 220V, 1 Amp.  Le relais dit 10A, mais je suis réaliste et je ne les laisserai pas passer la carte d'ampli 10A.  Et pour contrôler les démarreurs des pompes et 1 ampère suffit.  Tout cela est alimenté par une source d'alimentation avec une tension de 5 à 9 volts. </p><br><p>  Bien sûr, j'ai ajouté le capteur de température comme «Schaub était», mais sur l'ADC, on espérait mesurer la tension du secteur.  N'est-ce pas suffisant? </p><br><p>  Bien sûr, toutes les entrées, à l'exception de l'entrée pour connecter le DHT22, sont protégées contre les résistances et les diodes: je n'avais aucune envie de graver ESP8266, et les diodes et résistances ne coûtent que quelques centimes. </p><br><p>  <strong>Une photo du</strong> produit fini peut être vue au début de l'article.  J'ai commandé plusieurs de ces planches - que se passe-t-il si je les brûle ou dois-je couper les chemins et les jambes? <br>  Mais, heureusement - n'a pas eu à le faire. </p><br><p>  <strong>Le</strong> produit est, bien sûr, la beauté et la grandeur.  Mais pour plus de commodité, ce qui suit est un schéma de connexion de la carte aux simulateurs de capteurs et d'actionneurs. </p><br><br><img src="https://habrastorage.org/webt/_v/qm/_k/_vqm_kjyjzpgxqvsqzjte7ct6y8.jpeg"><br><br><p>  <strong>À la</strong> place des capteurs de niveau - boutons Input1..3, au lieu des démarreurs - LED connectées au relais Relay1..3.  Eh bien, une résistance variable sur l'ADC pour simuler la tension d'entrée. <br>  Lorsque le relais est éteint, la LED rouge est allumée.  Et lorsqu'il est allumé - vert.  J'ai donc débogué sur la table. </p><br><p>  <strong>En</strong> plus de tout cela, il y a un connecteur d'alimentation sur la gauche de la carte et deux boutons de service sur la droite: Reset et AP.  Eh bien, un interrupteur DIP qui met l'appareil en mode de programmation.  Le connecteur de programmation ESP8266 via l'adaptateur USB-UART est également disponible. </p><br><p>  <strong>Quelques explications sur les boutons.</strong>  Qu'est-ce que la <strong>réinitialisation</strong> - et c'est donc clair.  Mais le bouton <strong>AP</strong> est nécessaire pour mettre <strong>ShIoTiny</strong> en mode point d'accès ouvert (mode configuration ou mode config).  Pourquoi est-ce nécessaire?  Eh bien, par exemple, vous avez foiré les paramètres réseau et souhaitez les modifier.  Appuyez sur le bouton AP pendant quelques secondes (jusqu'à ce que la belle LED bleue s'allume).  Ensuite, prenez votre smartphone ou votre ordinateur portable, allumez le WiFi et voyez-y un point d'accès ouvert avec le nom esp_8266_xxxx et connectez-vous.  Ensuite, allez dans le navigateur de votre smartphone ou ordinateur portable et tapez dans la barre d'adresse: 192.168.4.1.  Si tout est en ordre, vous serez redirigé vers la page du contrôleur ShIoTiny et vous pourrez le configurer d'une nouvelle manière. </p><br><p>  <strong>Comme</strong> nous le voyons, le matériel n'a rien de compliqué.  Par conséquent, à propos de la <strong>partie logicielle</strong> . </p><br><p>  <strong>Dans</strong> tous les sauts d'implémentation, je décrirai, mais ensuite.  Un jour.  Et aujourd'hui, je ne considérerai le logiciel que "à l'extérieur", c'est-à-dire du point de vue de l'utilisateur - moi-même ou quelqu'un d'autre qui a osé utiliser mon métier (il y a de tels cascadeurs). </p><br><p>  <strong>Du</strong> point de vue de l'utilisateur, l'appareil est un serveur HTTP accessible via WiFi.  Tous les paramètres, la programmation et ainsi de suite - se fait à l'aide d'un navigateur WEB. </p><br><p>  <strong>Et</strong> donc, nous sommes allés à la page du contrôleur.  Que voyons-nous?  Et nous voyons l'onglet «Contrôle et état», qui montre l'état actuel des appareils utilisés: entrées, sorties, ADC, DHT22.  De plus, les paramètres de connexion au point d'accès sont affichés (si nous travaillons en mode station WiFi);  les paramètres du point d'accès (si nous travaillons en mode point d'accès WiFi) ou les deux.  Eh bien, en plus, les paramètres de connexion avec le courtier MQTT sont affichés si le protocole MQTT est utilisé. </p><br><br><img src="https://habrastorage.org/webt/lm/02/tw/lm02twe6qzwhrrby1v9jhf8alb8.jpeg"><br><br><p>  <strong>A</strong> voir, rien de spécial et d'intéressant.  Il n'y a rien à presser!  Bien que ... Il y a deux autres onglets!  Configuration des paramètres réseau <strong>Mise</strong> en <strong>réseau</strong> et schémas de schéma de l'éditeur <strong>ElDraw</strong> . </p><br><p>  Vous l'avez deviné, le <strong>réseautage</strong> est la mise en place d'un réseau, mais pas seulement cela.  Il a quelques paramètres plus intéressants.  «Poke» sur l'onglet <strong>Networking</strong> et voyez-y approximativement ce qui est montré dans la figure. <br>  Configuration du nom et du mot de passe du point d'accès pour chacun des modes - stations WiFi et points d'accès WiFi.  Tout semble clair.  En plus de l'objectif du <strong>bouton Scan WiFi,</strong> il est complètement transparent. <br>  <strong>Mais</strong> la liste déroulante <strong>"Mode ShIoTiny"</strong> nécessite une clarification.  Le fait est que je ne pouvais pas décider dans quel mode il serait plus pratique pour moi de travailler.  Et donc, prévu pour 5 modes de fonctionnement de l'appareil. </p><br><br><img src="https://habrastorage.org/webt/kd/s_/hh/kds_hhoiybre9ivtlr1kl1peh24.png"><br><br><p>  Nous listons brièvement ces modes de fonctionnement. </p><br><p>  <strong>Mode config</strong> - mode configuration.  Il s'agit du mode point d'accès ouvert avec une adresse fixe 192.168.4.1 et le nom esp_8266_xxxx. </p><br><p>  <strong>Mode Station</strong> - le mode de la station WiFi connectée à votre point d'accès. </p><br><p>  <strong>Mode AP</strong> - mode point d'accès fermé.  Vous définissez vous-même le nom et le mot de passe. </p><br><p>  <strong>Le mode AP + Station</strong> est l'inclusion simultanée du mode AP + du mode Station. </p><br><p>  <strong>Mode unique</strong> - fonctionne sans se connecter au réseau.  Un seul contrôleur portant sa lourde part ... </p><br><p>  <strong>Dans</strong> tous les modes, à l'exception du <strong>«Mode de configuration»</strong> , vous pouvez bloquer la page WEB en cochant la case <strong>«Verrouiller le Web en mode Station»</strong> .  Il s'agit d'un type pour des raisons de sécurité. </p><br><p>  <strong>Les</strong> paramètres sont évidents pour MQTT: serveur, port, mot de passe, connexion ouverte ou <strong>SSL</strong> .  Je ne m'étendrai pas ici en détail. </p><br><p>  <strong>En</strong> plus de tout le reste, le contrôleur ShIoTiny peut envoyer et recevoir des paquets dans un format spécial pour la multidiffusion.  Ses paramètres sont également évidents: l'adresse du groupe et le port. <br>  Bien sûr, si vous décrivez toutes les nuances des paramètres, vous obtenez un article séparé, mais ce n'est pas inclus dans mes plans. </p><br><p>  <strong>Et</strong> donc, avec l'onglet <strong>Réseau</strong> , tout est plus ou moins clair.  Passons à la caractéristique principale du contrôleur - l' <strong>éditeur de</strong> programme <strong>ElDraw</strong> . </p><br><p>  En appuyant sur l'onglet ElDraw, nous voyons quelque chose comme ce qui suit.  Bien sûr, si l'appareil n'a pas de circuit chargé, le champ du circuit sera vide. </p><br><br><img src="https://habrastorage.org/webt/hr/on/kc/hronkcmousbzptjr1olyag1whbk.png"><br><br><p>  <strong>À</strong> gauche, une palette d'éléments ou de nœuds (nœuds). <br>  <strong>A</strong> droite, un champ de diagramme ou simplement un «diagramme». <br>  <strong>Du</strong> haut - boutons pour le chargement et le déchargement sur le disque et sur l'appareil, ainsi que des boutons pour l'édition. </p><br><p>  <strong>Pour</strong> ceux qui ont travaillé avec des éditeurs, la gestion est généralement évidente.  Nous devons ajouter un élément au diagramme - prenez-le avec la souris et faites-le glisser de la palette vers le diagramme.  Il est nécessaire de supprimer l'élément ou le lien du diagramme - piquez dessus ou dessus avec la souris et appuyez sur la touche <strong>SUPPR</strong> .  Nous devons connecter les éléments - nous prenons l'entrée d'un élément et le connectons à la sortie d'un autre. </p><br><p>  <strong>Il y a</strong> toujours une mise à l'échelle (MAJ + molette de la souris).  Malheureusement, il n'existe aucun moyen de copier des éléments et des groupes d'éléments.  Mais cela n'interfère pas beaucoup. </p><br><p>  <strong>De</strong> plus, pour des raisons de logique, l'entrée d'un nœud ne peut être connectée qu'à une sortie d'un autre nœud.  Mais la sortie du nœud est avec plusieurs entrées d'autres nœuds.  Les entrées sont toujours à gauche des nœuds.  Les sorties sont toujours à droite. </p><br><p>  <strong>Quelles</strong> capacités avons-nous pour implémenter des algorithmes? <br>  <strong>En</strong> opportunités - assez vaste.  La palette contient des nœuds représentant tout le matériel du contrôleur <strong>ShIoTiny</strong> : entrées, relais, ADC, DHT11 / 22. </p><br><p>  Il existe des nœuds logiques et arithmétiques pour le traitement des données. </p><br><p>  Afin que nous puissions travailler avec l'appareil via Internet, il existe des nœuds pour l'abonnement et la publication des paramètres au courtier MQTT. </p><br><p>  Si nous voulons que plusieurs contrôleurs ShIoTiny échangent des informations entre eux - vous pouvez utiliser les nœuds pour transmettre et recevoir des paramètres à l'aide du protocole de multidiffusion UDP. </p><br><p>  <strong>Pour</strong> ce rhum, il y a des nœuds de temporisation;  nœuds de contrôle de gestion des événements. </p><br><p>  <strong>Je vais</strong> donner quelques exemples.  Par exemple, souhaitez-vous que les données de température et d'humidité soient publiées toutes les 30 minutes sur un serveur MQTT?  Rien de plus simple.  Dessine comme ça. </p><br><br><img src="https://habrastorage.org/webt/gf/bu/op/gfbuopoey6qqzbgtglgqm14otme.jpeg"><br><br><p>  <strong>Eh bien le</strong> bouton meme "Upload".  C’est tout! <br>  Si vous avez correctement configuré la connexion avec le courtier MQTT dans l'onglet Réseau, c'est tout! <br>  Toutes les demi-heures, la température sera publiée sur le courtier sous le sujet / T, et l'humidité - sous le sujet / H.  Ou, si vous demandez les noms de vos sujets, puis sous eux. <br>  Question: Pourquoi 18 000 30 minutes?  Parce que tous les temps sont mesurés en dixièmes de seconde. </p><br><p>  Maintenant, vous voulez ajouter à ce circuit la possibilité d'activer le relais Relay1 via Internet, et même pendant un certain temps?  Pas de problème.  Faites comme ça. </p><br><br><img src="https://habrastorage.org/webt/mb/ai/l6/mbail6skmkridba4jx6zhnvpjng.png"><br><br><p>  <strong>Environ</strong> cinq, cliquez sur le bouton "Télécharger".  C’est tout!  Désormais, en plus du fait que toutes les demi-heures, la température et l'humidité seront publiées sur le courtier MQTT, il sera possible d'activer le relais Relay1.  Oui, non seulement allumez-le, mais pendant exactement 10 minutes.  Vous pouvez activer le relais en publiant le sujet / r1cmd, défini sur 1. Et l'état réel du relais sera publié dans le sujet / r1status. </p><br><p>  <strong>Est</strong> -ce que je veux non seulement allumer, mais aussi désactiver le relais à l'avance?  Oui, comme tu dis.  La figure ci-dessous montre comment le faire! </p><br><br><img src="https://habrastorage.org/webt/nq/nm/qz/nqnmqznqcj9ia1tco5tumywbblg.png"><br><br><p>  Le principe est-il clair?  Vous dessinez simplement l'algorithme avec la souris!  Et écrivez quelques paramètres: heure, nom du sujet et tout.  C'est beaucoup plus clair que d'écrire un tas de code. </p><br><p>  <strong>Soit dit en passant</strong> , mettre en évidence des liens de différentes couleurs n'est pas un «photoshop» - c'est l'une des fonctions de l'éditeur.  Vous pouvez coloriser les liens à votre guise, afin de ne pas les confondre. </p><br><p>  <strong>Mais</strong> oh et ce n'est pas tout!  Afin de déboguer l'algorithme, il existe un bouton «Monitor start».  Aussi étrange que cela puisse paraître, il active le mode «moniteur».  Dans ce mode, l'état de toutes les sorties de tous les nœuds est lu périodiquement à partir du contrôleur <strong>ShIoTiny</strong> et affiché sur le circuit.  À peu près comme dans la figure ci-dessous. </p><br><br><img src="https://habrastorage.org/webt/av/zo/ev/avzoevodxkpmwylcw2da2tzqicq.png"><br><br><p>  Autrement dit, nous pouvons voir en «presque temps réel» ce que nous avons à l'entrée et à la sortie de chaque nœud.  Cela aide beaucoup lorsque quelque chose n'est pas clair. </p><br><p>  <strong>Il y a</strong> encore beaucoup de «puces et fonctionnalités» que je voudrais décrire, et ma conscience ne vous permettra pas d'y consacrer votre temps dans un seul article.  L'idée principale réalisée est déjà claire: un minimum de paramètres configurables - un maximum de visibilité. </p><br><h4 id="lozhka-degtya">  Voler dans la pommade </h4><br><p>  Bien sûr, je veux qu'il n'y ait pas de mouche dans la pommade, mais le monde n'est pas parfait.  Mon éditeur et mon contrôleur ne sont pas parfaits.  J'ai trouvé deux fonctionnalités principales que je n'ai pas encore pu éliminer. </p><br><p>  Premièrement, des problèmes surviennent parfois lors du mouvement de groupe d'éléments.  Mais cela n'interfère pas beaucoup avec le travail.  Plus probablement une fonctionnalité qu'un bug. </p><br><p> <strong></strong> , -,          «Upload»,  .    ,     . </p><br><h4 id="zaklyuchenie">  Conclusion </h4><br><p> <strong></strong> ,      ,  ,   .    ,         . </p><br><p> <strong></strong> , -,      .     . <br> <strong></strong>   ,                    « ». <br> <strong></strong>         —   : <strong>shiotiny@yandex.ru</strong> </p><br><p> <strong></strong>      ,  , ,  . </p><br><p> <strong></strong>   ,   . </p><br><h4 id="ssylki-otsylki-i-posylki"> ,    </h4><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">  ShIoTiny</a> </p><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ESP8266</a> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">WiFi</a> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">MQTT</a> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">UDP Multicast</a> </p><br><h4 id="po-prosbam-trudyaschihsya">    </h4><br><p> <strong></strong>      (). </p><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">https://github.com/shiotiny/ShIoTinyBin</a> </p><br><p> : <a href="">https://github.com/shiotiny/ShIoTinyBin/blob/master/bin/esp-07-shiotiny.bin</a> </p><br><p> : <a href="">https://github.com/shiotiny/ShIoTinyBin/blob/master/doc/esp-07-shiotiny.png</a> </p><br><p>  : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">https://github.com/shiotiny/ShIoTinyBin/blob/master/doc/ShIoT-esp8266-01_obzor.pdf</a> </p><br><p>  " "  . </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr463107/">https://habr.com/ru/post/fr463107/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr463095/index.html">Pourquoi pas SQL?</a></li>
<li><a href="../fr463097/index.html">Go Product Development: One Project History</a></li>
<li><a href="../fr463099/index.html">1000 et 1 rétroaction. Comment donner du feedback et enseigner aux autres, l'expérience Lamoda</a></li>
<li><a href="../fr463101/index.html">Gestion de centaines de serveurs pour les tests de charge: mise à l'échelle automatique, surveillance personnalisée, culture DevOps</a></li>
<li><a href="../fr463105/index.html">Mon quatrième jour avec Haiku: problèmes d'installation et de démarrage</a></li>
<li><a href="../fr463113/index.html">Contrôle de version des données et des modèles dans la rencontre Computer Vision</a></li>
<li><a href="../fr463115/index.html">Le problème des portes dans la conception des tireurs</a></li>
<li><a href="../fr463117/index.html">Préchargement en PHP 7.4</a></li>
<li><a href="../fr463121/index.html">Nous mangeons l'éléphant par parties. Exemple de stratégie de surveillance de l'intégrité des applications</a></li>
<li><a href="../fr463123/index.html">Bibliothèque de générateur de code assembleur pour microcontrôleurs AVR. 3e partie</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>