<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üì∏ üö∂üèΩ üñïüèø OpenGL ultramoderno. Parte 1 üëâüèΩ üîΩ üë©‚Äçüë©‚Äçüë¶</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hola a todos Todos los que conocen un poco sobre el tema de OpenGL saben que hay una gran cantidad de art√≠culos y cursos sobre este tema, pero muchos ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>OpenGL ultramoderno. Parte 1</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/456932/"><img src="https://habrastorage.org/webt/ui/wu/2k/uiwu2kjzkvznzwubjaqnk7lkoz0.jpeg"><br><br>  Hola a todos  Todos los que conocen un poco sobre el tema de OpenGL saben que hay una gran cantidad de art√≠culos y cursos sobre este tema, pero muchos no afectan la API moderna, y algunos de ellos generalmente hablan de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">glBegin</a> y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">glEnd</a> .  Intentar√© cubrir algunos de los matices de la nueva API a partir de la versi√≥n 4.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Enlace a la segunda parte del art√≠culo.</a> <br><a name="habracut"></a><br>  Esta vez intentar√© escribir un art√≠culo interesante e informativo, y lo que sucedi√≥ depende de los buenos residentes de habra para decidir.  Perd√≥neme por mi mala gram√°tica (agradecer√© las correcciones). <br><br>  Si te gusta, escribir√© sobre optimizar OpenGL y reducir DrawCalls. <br><br>  ¬°Empecemos! <br><br>  <font color="#008000">Lo que habr√° en este art√≠culo: la funcionalidad de OpenGL moderno</font> <br>  <font color="#FF0000">Lo que no estar√° en este art√≠culo: enfoques modernos para renderizar en OpenGL</font> <br><br><div class="spoiler">  <b class="spoiler_title">Contenido:</b> <div class="spoiler_text"><ul><li>  Acceso directo al estado </li><li>  Depurar </li><li>  Objetos de sombreador separados </li><li>  Matrices de texturas </li><li>  Vista de textura </li><li>  B√∫fer √∫nico para √≠ndice y v√©rtice </li><li>  Teselaci√≥n y sombreado de c√°lculo </li><li>  Representaci√≥n de ruta </li></ul><br></div></div><br><h3>  <font color="#4682B4">DSA (acceso directo al estado)</font> </h3><br>  Acceso directo al estado: acceso directo al estado.  Una herramienta para modificar objetos OpenGL sin tener que ajustarlos al contexto.  Esto le permite cambiar el estado de un objeto en un contexto local sin afectar el estado global compartido por todas las partes de la aplicaci√≥n.  Tambi√©n hace que la API est√© un poco m√°s orientada a objetos, ya que las funciones que cambian el estado de los objetos se pueden definir claramente.  Esto es lo que nos dice el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">OpenGL Wiki</a> . <br><br>  Como sabemos, OpenGL es una API con muchos botones de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">opci√≥n</a> : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">glActiveTexture</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">glBindTexture</a> , etc. <br><br>  A partir de aqu√≠ tenemos algunos <font color="#DC143C">problemas</font> : <br><br><ul><li>  El selector y los estados actuales pueden hacer un cambio m√°s profundo en el estado. </li><li>  Puede ser necesario vincular / cambiar la unidad activa para establecer un filtro para texturas </li><li>  La gesti√≥n del estado se vuelve problem√°tica como resultado de lo cual crece la complejidad de la aplicaci√≥n </li><li>  El estado desconocido conduce a configuraciones adicionales </li><li>  Los intentos de guardar / restaurar el estado pueden ser problem√°ticos </li></ul><br>  ¬øQu√© nos ofreci√≥ el grupo Khronos y c√≥mo ayuda el DSA? <br><br><ul><li>  Agrega funciones que funcionan directamente con el objeto / objetos </li><li>  Establece el filtro de textura para el objeto de textura especificado, no el actual. </li><li>  Vincula una textura a una unidad espec√≠fica, no a la activa </li><li>  Agrega una gran cantidad de nuevas caracter√≠sticas </li><li>  Cubre cosas hasta OpenGL 1.x </li><li>  Agrega caracter√≠sticas adicionales. </li></ul><br>  En teor√≠a, un DSA puede ayudar a reducir el n√∫mero de operaciones que no cambian de estado y de cambio a cero ... Pero eso no es exacto. <br><br>  Ahora repasar√© brevemente algunas de las nuevas funciones, no me detendr√© en los par√°metros en detalle, dejar√© enlaces en la wiki. <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">glCreateTextures</a> reemplaza <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">glGenTextures</a> + <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">glBindTexture</a> (inicializaci√≥n). <br>  Fue: <br><pre><code class="cpp hljs">glGenTextures(<span class="hljs-number"><span class="hljs-number">1</span></span>, &amp;name); glBindTexture(GL_TEXTURE_2D, name);</code> </pre>  Se convirti√≥ en: <br><pre> <code class="cpp hljs">glCreateTextures(GL_TEXTURE_2D, <span class="hljs-number"><span class="hljs-number">1</span></span>, &amp;name);</code> </pre> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">glTextureParameterX</a> equivalente a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">glTexParameterX</a> <pre> <code class="cpp hljs">glGenTextures(<span class="hljs-number"><span class="hljs-number">1</span></span>, &amp;name); glBindTexture(GL_TEXTURE_2D, name); glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_CLAMP); glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_CLAMP); glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_NEAREST); glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_NEAREST); glTexStorage2D(GL_TEXTURE_2D, <span class="hljs-number"><span class="hljs-number">1</span></span>, GL_RGBA8, width, height); glTexSubImage2D(GL_TEXTURE_2D, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, width, height, GL_RGBA, GL_UNSIGNED_BYTE, pixels);</code> </pre>  Ahora lo escribiremos as√≠: <br><pre> <code class="cpp hljs">glCreateTextures(GL_TEXTURE_2D, <span class="hljs-number"><span class="hljs-number">1</span></span>, &amp;name); glTextureParameteri(name, GL_TEXTURE_WRAP_S, GL_CLAMP); glTextureParameteri(name, GL_TEXTURE_WRAP_T, GL_CLAMP); glTextureParameteri(name, GL_TEXTURE_MIN_FILTER, GL_NEAREST); glTextureParameteri(name, GL_TEXTURE_MAG_FILTER, GL_NEAREST); glTextureStorage2D(name, <span class="hljs-number"><span class="hljs-number">1</span></span>, GL_RGBA8, width, height); glTextureSubImage2D(name, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, width, height, GL_RGBA, GL_UNSIGNED_BYTE, pixels);</code> </pre> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">glBindTextureUnit</a> reemplaza <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">glActiveTexture</a> + <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">glBindTexture</a> <br>  As√≠ es como lo hicimos: <br><pre> <code class="cpp hljs">glActiveTexture(GL_TEXTURE0 + <span class="hljs-number"><span class="hljs-number">3</span></span>); glBindTexture(GL_TEXTURE_2D, name);</code> </pre>  Ahora: <br><pre> <code class="cpp hljs">glBindTextureUnit(<span class="hljs-number"><span class="hljs-number">3</span></span>, name);</code> </pre> </li></ul><br>  Los cambios tambi√©n afectaron <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">glTextureImage</a> , ya no se usa, y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">he</a> aqu√≠ por qu√©: <br><br>  glTexImage es bastante inseguro, es muy f√°cil obtener texturas no v√°lidas, porque la funci√≥n no verifica los valores cuando se llama, el controlador hace esto mientras dibuja.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">GlTexStorage</a> fue agregado para <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">reemplazarlo</a> . <br><br>  glTexStorage proporciona una forma de crear texturas con comprobaciones realizadas durante una llamada, lo que minimiza los errores.  El repositorio de texturas es resuelto por la mayor√≠a, si no todos, los problemas causados ‚Äã‚Äãpor las texturas mutables, aunque las texturas inmutables son m√°s confiables. <br><br>  Los cambios tambi√©n afectaron el b√∫fer de trama: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">glCreateFramebuffers en</a> lugar de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">glGenFramebuffers</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">glNamedFramebufferTexture</a> reemplaza <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">glFramebufferTexture</a> </li></ul><br>  Estas no son todas las caracter√≠sticas modificadas.  Las siguientes en la l√≠nea son las funciones para los buffers: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">glCreateBuffers en</a> lugar de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">glGenBuffers</a> + <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">glBindBuffer</a> (inicializaci√≥n) </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">glNamedBufferData</a> reemplaza <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">glBufferData</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">glVertexAttribFormat</a> y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">glBindVertexBuffer en</a> lugar de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">glVertexAttribPointer</a> </li></ul><br>  Aqu√≠ hay una lista de lo que ahora se incluye en el soporte DSA: <br><br><ul><li>  Objetos de matriz de v√©rtices </li><li>  Objetos Framebuffer </li><li>  Programar objetos </li><li>  Objetos de amortiguaci√≥n </li><li>  Pilas de matriz </li><li>  Muchas cosas obsoletas </li></ul><br><h3>  <font color="#4682B4">Depurar</font> </h3><br>  Desde la versi√≥n 4.3, se ha agregado una nueva funcionalidad para la depuraci√≥n, en mi opini√≥n, muy √∫til y conveniente.  Ahora OpenGL llamar√° a nuestra devoluci√≥n de llamada por errores y mensajes de depuraci√≥n, cuyo nivel podemos ajustar. <br><br><img src="https://habrastorage.org/webt/t-/m7/1n/t-m71nmkhv4-khfdlpb99wekjxq.jpeg"><br><br>  Necesitamos invocar solo dos funciones para habilitar: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">glEnable</a> y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">glDebugMessageCallback</a> , en ning√∫n lugar es m√°s f√°cil. <br><br><pre> <code class="cpp hljs">glEnable(GL_DEBUG_OUTPUT); glDebugMessageCallback(message_callback, <span class="hljs-literal"><span class="hljs-literal">nullptr</span></span>);</code> </pre> <br>  Ahora escribiremos una funci√≥n de devoluci√≥n de llamada para obtener el mensaje: <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">callback</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(GLenum source, GLenum type, GLuint id, GLenum severity, GLsizei length, GLchar </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params">* message, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">void</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params">* user_param)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> source_str = [source]() -&gt; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">string</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (source) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> GL_DEBUG_SOURCE_API: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"API"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> GL_DEBUG_SOURCE_WINDOW_SYSTEM: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"WINDOW SYSTEM"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> GL_DEBUG_SOURCE_SHADER_COMPILER: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"SHADER COMPILER"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> GL_DEBUG_SOURCE_THIRD_PARTY: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"THIRD PARTY"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> GL_DEBUG_SOURCE_APPLICATION: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"APPLICATION"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> GL_DEBUG_SOURCE_OTHER: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"OTHER"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"UNKNOWN"</span></span>; } }(); <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> type_str = [type]() { <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (type) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> GL_DEBUG_TYPE_ERROR: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"ERROR"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> GL_DEBUG_TYPE_DEPRECATED_BEHAVIOR: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"DEPRECATED_BEHAVIOR"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> GL_DEBUG_TYPE_UNDEFINED_BEHAVIOR: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"UNDEFINED_BEHAVIOR"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> GL_DEBUG_TYPE_PORTABILITY: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"PORTABILITY"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> GL_DEBUG_TYPE_PERFORMANCE: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"PERFORMANCE"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> GL_DEBUG_TYPE_MARKER: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"MARKER"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> GL_DEBUG_TYPE_OTHER: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"OTHER"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"UNKNOWN"</span></span>; } }(); <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> severity_str = [severity]() { <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (severity) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> GL_DEBUG_SEVERITY_NOTIFICATION: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"NOTIFICATION"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> GL_DEBUG_SEVERITY_LOW: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"LOW"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> GL_DEBUG_SEVERITY_MEDIUM: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"MEDIUM"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> GL_DEBUG_SEVERITY_HIGH: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"HIGH"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"UNKNOWN"</span></span>; } }(); <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">cout</span></span> &lt;&lt; source_str &lt;&lt; <span class="hljs-string"><span class="hljs-string">", "</span></span> &lt;&lt; type_str &lt;&lt; <span class="hljs-string"><span class="hljs-string">", "</span></span> &lt;&lt; severity_str &lt;&lt; <span class="hljs-string"><span class="hljs-string">", "</span></span> &lt;&lt; id &lt;&lt; <span class="hljs-string"><span class="hljs-string">": "</span></span> &lt;&lt; message &lt;&lt; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">endl</span></span>; }</code> </pre> <br>  Tambi√©n podemos configurar el filtro usando <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">glDebugMessageControl</a> .  El filtro puede funcionar en modo de filtrado por fuente / tipo / importancia o un conjunto de mensajes utilizando sus identificadores. <br><br>  Filtrar mensajes en un √°mbito espec√≠fico: <br><br><pre> <code class="cpp hljs">glPushDebugGroup( GL_DEBUG_SOURCE_APPLICATION, DEPTH_FILL_ID, <span class="hljs-number"><span class="hljs-number">11</span></span>, ‚ÄúDepth Fill‚Äù); <span class="hljs-comment"><span class="hljs-comment">//  Render_Depth_Only_Pass(); //  glPopDebugGroup(); // </span></span></code> </pre> <br>  Ser√° muy √∫til deshabilitar la llamada asincr√≥nica para que podamos determinar el orden de las llamadas a funciones, as√≠ como encontrar el lugar del error en la pila al depurar.  Esto se hace simplemente: <br><br><pre> <code class="cpp hljs">glEnable(GL_DEBUG_OUTPUT_SYNCHRONOUS);</code> </pre> <br>  Vale la pena recordar que no es seguro llamar a OpenGL o funciones de ventana en una funci√≥n de llamada envuelta, as√≠ como las devoluciones de llamada no son gratuitas y no debe dejarlas incluidas en la versi√≥n de lanzamiento. <br>  M√°s detalles sobre estas y otras peque√±as cosas: trucos, puedes leer <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu√≠</a> . <br><br><h3>  <font color="#4682B4">SSO (objetos de sombreado separados)</font> </h3><br>  Una vez que OpenGL funcionaba como una "tuber√≠a fija", esto significaba que el procesamiento preprogramado se aplicaba a todos los datos transferidos para su visualizaci√≥n.  El siguiente paso fue la "tuber√≠a programable", donde la parte programable implementa sombreadores, escrito en GLSL, el programa GLSL cl√°sico consist√≠a en sombreadores de v√©rtices y fragmentos, pero en OpenGL moderno se agregaron algunos tipos nuevos de sombreadores, a saber, los sombreadores de geometr√≠a, ponderaci√≥n y c√°lculos (sobre ellos I Lo contar√© en la siguiente parte). <br><br><img src="https://habrastorage.org/webt/lg/or/rg/lgorrggfshrf8xdb6vbwu4fw-so.jpeg"><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Los SSO</a> nos permiten cambiar los pasos del sombreador sobre la marcha sin volver a vincularlos.  La creaci√≥n y configuraci√≥n de una tuber√≠a de software simple sin depuraci√≥n es la siguiente: <br><br><pre> <code class="cpp hljs">GLuint pipe = GL_NONE; <span class="hljs-comment"><span class="hljs-comment">// Create shaders GLuint fprog = glCreateShaderProgramv( GL_FRAGMENT_SHADER, 1, &amp;text); GLuint vprog = glCreateShaderProgramv( GL_VERTEX_SHADER, 1, &amp;text); // Bind pipeline glGenProgramPipelines( 1, &amp;pipe); glBindProgramPipelines( pipe); // Bind shaders glUseProgramStages( pipe, GL_FRAGMENT_SHADER_BIT, fprog); glUseProgramStages( pipe, GL_VERTEX_SHADER_BIT, vprog);</span></span></code> </pre> <br>  Como vemos, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">glCreateProgramPipelines</a> genera un descriptor e inicializa el objeto, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">glCreateShaderProgramv</a> genera, inicializa, compila y vincula el programa de sombreado utilizando las fuentes especificadas, y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">glUseProgramStages</a> adjunta los pasos del programa al objeto de canalizaci√≥n.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">glBindProgramPipeline</a> : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">asocia una</a> canalizaci√≥n con un contexto. <br><br>  Pero hay una advertencia, ahora los par√°metros de entrada y salida de los sombreadores deben coincidir.  Podemos declarar los par√°metros de entrada / salida en el mismo orden, con los mismos nombres, o hacemos que su ubicaci√≥n coincida claramente con la ayuda de calificadores. <br>  Recomiendo la √∫ltima opci√≥n, esto nos permitir√° configurar una interfaz claramente definida, as√≠ como ser flexible con respecto a los nombres y el orden. <br><br>  Para proporcionar una interfaz m√°s rigurosa, tambi√©n necesitamos declarar los bloques de entrada y salida incorporados que queremos usar para cada etapa. <br><br>  Las interfaces de bloque incorporadas se definen como ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">de una wiki</a> ): <br>  V√©rtice: <br><br><pre> <code class="cpp hljs">out gl_PerVertex { vec4 gl_Position; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> gl_PointSize; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> gl_ClipDistance[]; };</code> </pre> <br>  Control de teselaci√≥n: <br><pre> <code class="cpp hljs">out gl_PerVertex { vec4 gl_Position; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> gl_PointSize; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> gl_ClipDistance[]; } gl_out[];</code> </pre> <br>  Evaluaci√≥n de teselaci√≥n: <br><pre> <code class="cpp hljs">out gl_PerVertex { vec4 gl_Position; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> gl_PointSize; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> gl_ClipDistance[]; };</code> </pre> <br>  Geometr√≠a: <br><pre> <code class="cpp hljs">out gl_PerVertex { vec4 gl_Position; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> gl_PointSize; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> gl_ClipDistance[]; };</code> </pre> <br>  Un ejemplo de volver a declarar un m√≥dulo integrado y usar la ubicaci√≥n de atributos en un sombreador de v√©rtices regular: <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#version 450 out gl_PerVertex { vec4 gl_Position; }; layout (location = 0) in vec3 position; layout (location = 1) in vec3 color; layout (location = 0) out v_out { vec3 color; } v_out; void main() { v_out.color = color; gl_Position = vec4(position, 1.0); }</span></span></code> </pre> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/456932/">https://habr.com/ru/post/456932/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../456920/index.html">Sony Xperia 1 en Rusia - bonificaciones de precio y pre-pedido</a></li>
<li><a href="../456922/index.html">C√≥mo se dise√±an y fabrican los procesadores: los fundamentos de la arquitectura inform√°tica</a></li>
<li><a href="../456926/index.html">¬øC√≥mo hacemos Sportmaster?</a></li>
<li><a href="../456928/index.html">JMeter - Cuchillo suizo de prueba (Parte 1)</a></li>
<li><a href="../456930/index.html">Trayendo IoT a las masas: resultados del primer hackathon IoT de GeekBrains y Rostelecom</a></li>
<li><a href="../456938/index.html">Lanzamiento de una aplicaci√≥n de taxis en Tokio: ¬øC√≥mo lo hace Sony con S. Ride?</a></li>
<li><a href="../456942/index.html">El dios de muchos brazos de la fecha l√≠mite o el uso generalizado de la anal√≠tica.</a></li>
<li><a href="../456944/index.html">3 ejemplos pr√°cticos del uso de la desestructuraci√≥n en JavaScript</a></li>
<li><a href="../456946/index.html">Paneles Grafana para la administraci√≥n de Kubernetes</a></li>
<li><a href="../456948/index.html">Webinar grupal del IB el 27 de junio, "C√≥mo contrarrestar los ataques de ingenier√≠a social: ¬øC√≥mo reconocer los trucos de los piratas inform√°ticos y defenderse de ellos?"</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>