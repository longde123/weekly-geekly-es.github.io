<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üçæ üë¥üèº üâê Testez ma patience par la Check Point Security Academy üññüèæ üòá üåö</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="J'ai mentionn√© le programme Check Point Security Academy √† plusieurs reprises sur Habr√©: son essence est que la soci√©t√© Check Point a annonc√© un conco...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Testez ma patience par la Check Point Security Academy</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/430210/"> J'ai mentionn√© le programme <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Check Point Security Academy √†</a> plusieurs reprises sur Habr√©: son essence est que la soci√©t√© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Check Point</a> a annonc√© un concours au format Capture the Flag en √©t√©, o√π l'exp√©rience pass√©e du participant n'est pas importante, mais seulement sa capacit√© √† d√©m√™ler le cyber √©nigmes.  Sur la base des r√©sultats de ce concours, l'entreprise a recrut√© une vingtaine de participants pour une formation professionnelle de trois mois en cybers√©curit√©, et tous les participants d√®s le d√©but du cours re√ßoivent l'int√©gralit√© du salaire d'un sp√©cialiste en KB, dans l'obligation de travailler dans l'entreprise deux ans apr√®s la fin du cours. <br><br><img src="https://habrastorage.org/webt/vf/kb/ix/vfkbixclsmvdnirjojnsjcc5q2k.png"><br>  <i>Dans une comp√©tition de la FCE, un drapeau peut m√™me √™tre une image comme celle-ci.</i> <br><br>  La s√©lection des participants s'est termin√©e en ao√ªt, mais le site Web du concours continuera de fonctionner jusqu'√† l'√©t√© prochain, et j'invite ceux qui souhaitent s'inscrire et tenter leur chance dans l'int√©r√™t du sport.  Le concours se compose de 12 puzzles de complexit√© variable, √©valu√©s de 10 √† 150 points. <br>  Ici, je veux analyser le puzzle "Test My Patience" de la cat√©gorie "Surprise".  Elle est de difficult√© moyenne (50 points), et voici son texte int√©gral: <br><blockquote>  Salut <br>  Nous avons trouv√© <a href="">cet</a> ex√©cutable sur l'ordinateur de l'horloger local. <br>  La rumeur dit que l'horloger √©tait en quelque sorte la seule personne √† avoir r√©ussi √† le casser. <br>  Vous pensez √™tre aussi bon que l'horloger? <br>  <b>Remarque: ce fichier n'est en aucun cas malveillant</b> </blockquote> Par r√©f√©rence - un binaire 32 bits pour Windows, sur lequel <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">certains antivirus jurent</a> , mais si vous l'ex√©cutez toujours, il ressemble √† ceci: <br><br><img src="https://habrastorage.org/webt/iw/x_/_f/iwx__foij5pljrqee4346ldcgqy.png"><br><br>  L'int√©rieur du binaire est crypt√©;  Il refuse de s'ex√©cuter sous le d√©bogueur;  si vous essayez de lui connecter un d√©bogueur alors qu'il est en cours d'ex√©cution, il s'arr√™te imm√©diatement.  Probablement, les sp√©cialistes de Check Point ont envelopp√© leur puzzle dans un crypto-packer, emprunt√© √† une sorte de malvari. <br><br>  Comment deviner le num√©ro compos√© par l'horloger? <br><a name="habracut"></a><br>  Il y a deux fa√ßons.  Le premier peut √™tre appel√© conditionnellement "il y a du pouvoir, pas d'esprit": si le programme ne peut pas √™tre d√©bogu√© en direct, alors nous d√©boguerons le mort! <br><br>  Nous lan√ßons le "Gestionnaire des t√¢ches" 32 bits (\ Windows \ SysWOW64 \ taskmgr.exe), cliquez avec le bouton droit sur le processus myst√©rieux et s√©lectionnez Cr√©er un fichier de vidage.  (Le Gestionnaire des t√¢ches 64 bits pour les processus 32 bits cr√©e un vidage de l'√©mulateur wow64cpu, qui est plus difficile √† utiliser.) <br><br>  Nous regardons dans le vidage et voyons qu'au moins les lignes qu'il contient sont d√©j√† d√©chiffr√©es: <br><br><img src="https://habrastorage.org/webt/ug/fx/u-/ugfxu-y-1tgtxfjbhjb-zx7gmlg.png"><br><br>  Mais les lignes avec le num√©ro masqu√© ou le drapeau ne sont pas encore visibles. <br><br>  Nous passons √† l'arme principale de calibre: WinDbg (X86) -&gt; Open Crash Dump ... <br><br><img src="https://habrastorage.org/webt/kz/em/by/kzemby77zuk_wllg194irxj864y.png"><br><br>  O√π en m√©moire est la ligne que nous voulons voir imprim√©e - "Bon travail mon ami!"? <br>  La commande <code>lm</code> vous permet de d√©terminer que le binaire est charg√© de <code>01140000</code> √† <code>015b2000</code> ;  puis <code>sa 01140000 015b2000 "Good job my friend!"</code>  trouve la cha√Æne de recherche √† <code>0115a0d0</code> : <br><br><img src="https://habrastorage.org/webt/3g/nu/ed/3gnuedahkhiapktjyob3fsxavto.png"><br><br>  Voyons maintenant o√π cette ligne est imprim√©e: peut-√™tre qu'une commande contient des octets <code>d0 a0 15 01</code> correspondant √† l'adresse de la ligne que vous recherchez?  ( <code>sb 01140000 015b2000 d0 a0 15 01</code> ) <br><br>  Bonne chance!  - une telle √©quipe a √©t√© trouv√©e: <br><br><img src="https://habrastorage.org/webt/rm/5v/ah/rm5vah4nctvyf7bewf8uy-dkzbo.png"><br><br>  Quel est le code autour de cette commande?  ( <code>ub 011412f7; u 011412f7</code> ) <br><br><img src="https://habrastorage.org/webt/xx/oc/kx/xxockxynmnfarqsjejxdghowqk8.png"><br><br>  Nous voyons qu'en fonction du r√©sultat de la fonction <code>01141180</code> soit le message souhait√© est imprim√©, soit ¬´Mauvais ...¬ª <br><br>  Le code de fonction <code>01141180</code> occupe trois √©crans;  il est assez facile de voir qu'il s'agit d'une impl√©mentation de <code>strcmp()</code> , √† l'int√©rieur de laquelle un appel √† <code>Sleep(700)</code> a √©t√© ajout√©.  On ne sait pas encore pourquoi il y a <code>Sleep()</code> ;  mais cela n'affecte toujours pas le r√©sultat de la fonction, nous allons donc mieux comprendre ce que les cha√Ænes sont compar√©es: <br><br><img src="https://habrastorage.org/webt/kz/ie/l3/kziel3yw1_p5f74wyjngg-aam2k.png"><br><br>  Deux pointeurs √©gaux √† <code>ebp-14h</code> et <code>ebp-24h</code> <code>ebp-14h</code> ;  le second d'entre eux a √©t√© pass√© √† la fonction <code>011410b0</code> comme <code>011410b0</code> . <br>  N'est-ce pas la fonction qui demande le num√©ro cach√©?  V√©rifions la pile d'appels ( <code>k</code> ): <br><br><img src="https://habrastorage.org/webt/8t/ov/tl/8tovtlh8uebmq10eb5hwfbaa_nq.png"><br><br>  Oui, c'est elle! <br><br>  Le sch√©ma g√©n√©ral du puzzle est maintenant clair: l'intuition de l'utilisateur est stock√©e √† <code>ebp-24h</code> , le nombre <code>ebp-14h</code> √† <code>ebp-14h</code> , puis ils sont compar√©s et soit "Bon travail mon ami!" Ou "Mauvais ..." est imprim√©. <br><br>  Il ne reste plus qu'√† extraire le num√©ro cach√© du cadre de pile.  Nous connaissons d√©j√† son <code>ebp</code> de la pile des appels: <br><br><img src="https://habrastorage.org/webt/p1/eq/qo/p1eqqone8e7i_kszzwojdlq8goa.png"><br><br>  Allez, allez ... <br><br><img src="https://habrastorage.org/webt/zn/zo/yk/znzoyk99atyzq37hewnooffjvsu.png"><br><br>  Succ√®s!  Vous pouvez d√©boucher quelque chose de savoureux. <br><br>  Mais trois choses myst√©rieuses sont rest√©es sans explication: <ol><li>  Pourquoi y a-t-il un appel √† <code>Sleep(700)</code> √† l'int√©rieur du <code>strcmp()</code> <code>Sleep(700)</code> ? </li><li>  Pourquoi, lorsque nous avons entr√© le num√©ro cach√©, le programme s'est-il bloqu√© pendant dix secondes avant d'imprimer ¬´Bon travail mon ami!¬ª? </li><li>  Qu'est-ce que l'horloger a √† voir avec ce puzzle? </li></ol><br>  Ainsi, il s'av√®re qu'il existe une deuxi√®me fa√ßon - plus intelligente - de deviner le nombre devin√©.  Si vous essayez simplement au hasard les nombres 0-9, il est facile de remarquer que sur les neuf le programme "se bloque" un peu.  Si vous essayez les nombres 90-99, vous pouvez voir que sur le num√©ro 98 le programme "se bloque" deux fois plus longtemps.  (Apr√®s avoir d√©couvert ses tripes, nous comprenons d√©j√† le probl√®me: une comparaison r√©ussie de chaque paire de caract√®res entra√Æne un retard de 0,7 s.) Pour r√©soudre le puzzle sans m√™me d√©marrer le d√©bogueur, il suffisait de s√©lectionner chaque chiffre suivant pour que le d√©lai avant la r√©ponse augmente - soit manuellement avec un chronom√®tre exact ou un simple script.  Ainsi, les compilateurs ont laiss√© entendre une <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">m√©thode de longue date d'attaquer les algorithmes cryptographiques</a> , lorsque le temps jusqu'√† ce qu'un message d'erreur soit mesur√© et analys√©. <br><br>  Mais apprendre √† r√©cup√©rer des programmes envelopp√©s dans des crypto-packers inconnus est, √† mon avis, √† la fois plus int√©ressant et plus pr√©cieux :-) <br><br>  Notez que nous n'avions pas besoin de comprendre comment le binaire est crypt√©, ni comment la cha√Æne avec le num√©ro que vous voyez appara√Æt sur la pile (nous avons vu dans le vidage qu'elle ne faisait pas partie des constantes de cha√Æne) - nous avons r√©ussi √† pr√©parer et √† pr√©parer les deux, et pour cela une douzaine de commandes WinDbg suffisaient. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr430210/">https://habr.com/ru/post/fr430210/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr430200/index.html">Le prix de l'action de Nvidia baisse au milieu de l'effondrement du march√© des crypto-monnaies et de la baisse d'int√©r√™t pour l'exploitation mini√®re</a></li>
<li><a href="../fr430202/index.html">√âcriture d'un syst√®me de particules interagissant par paire en C ++ √† l'aide de DirectX 11</a></li>
<li><a href="../fr430204/index.html">Cours MIT "S√©curit√© des syst√®mes informatiques". Conf√©rence 18: ¬´Navigation Internet priv√©e¬ª, partie 1</a></li>
<li><a href="../fr430206/index.html">Cours MIT "S√©curit√© des syst√®mes informatiques". Conf√©rence 18: Navigation priv√©e sur Internet, partie 2</a></li>
<li><a href="../fr430208/index.html">Cours MIT "S√©curit√© des syst√®mes informatiques". Conf√©rence 18: ¬´Navigation Internet priv√©e¬ª, partie 3</a></li>
<li><a href="../fr430212/index.html">OpenSceneGraph: principes de base de la g√©om√©trie de sc√®ne</a></li>
<li><a href="../fr430216/index.html">Si je comprends bien, je mange beaucoup de bonbons, ou le classement des marchandises par ch√®que dans l'application</a></li>
<li><a href="../fr430218/index.html">Optimisation √©nerg√©tique STM32: un guide pratique</a></li>
<li><a href="../fr430220/index.html">Comment transformer un hub USB ¬´centenaire¬ª en un smart managed et √©conomiser 300 $</a></li>
<li><a href="../fr430222/index.html">Ing√©nieur senior en recherche de travail. Comment j'ai v√©cu 20 entretiens avec les RH et ce que j'en pense</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>