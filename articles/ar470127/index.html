<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ ๐ โ๏ธ ููุญู ูุน ุฐุงูุฑุฉ ุทูููุฉ ุงูุฃุฌู ๐ค๐ผ ๐ ๐</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ูุคูู ุงูููุณููู ุชููุงุฆููุง 

 ุจุนุฏ ุฃู ุชุนููุช ุงูุจุฑูุฌุฉ ุชูุฑูุจูุง ุ ุฃุฑุฏุช ุฅูุดุงุก ุจุฑูุงูุฌ ูุงุฏุฑ ุนูู ุชุฃููู ุงูููุณููู. 

 ูุนุฏุฉ ุณููุงุช ููุช ุจูุญุงููุงุช ุจุฏุงุฆูุฉ ูุชูููู ุงูููุณููู ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ููุญู ูุน ุฐุงูุฑุฉ ุทูููุฉ ุงูุฃุฌู</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/470127/" style=";text-align:right;direction:rtl"><h2 style=";text-align:right;direction:rtl">  ูุคูู ุงูููุณููู ุชููุงุฆููุง </h2><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/e91/f1e/b09/e91f1eb09e53ad458aaaeca5650b59aa.jpg" width="500"></div><br>  ุจุนุฏ ุฃู ุชุนููุช ุงูุจุฑูุฌุฉ ุชูุฑูุจูุง ุ ุฃุฑุฏุช ุฅูุดุงุก ุจุฑูุงูุฌ ูุงุฏุฑ ุนูู ุชุฃููู ุงูููุณููู. <br><br>  ูุนุฏุฉ ุณููุงุช ููุช ุจูุญุงููุงุช ุจุฏุงุฆูุฉ ูุชูููู ุงูููุณููู ุชููุงุฆููุง ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="noopener">Visions of Chaos</a> .  ูู ุงูุฃุณุงุณ ุ ุชู ุงุณุชุฎุฏุงู ุงูุตูุบ ุงูุฑูุงุถูุฉ ุงูุจุณูุทุฉ ุฃู ุงูุทูุฑุงุช ุงูุฌูููุฉ ููุชุชุงุจุนุงุช ุงูุนุดูุงุฆูุฉ ูู ุงูููุงุญุธุงุช.  ุจุนุฏ ุฃู ุญููุช ูุคุฎุฑูุง ูุฌุงุญูุง ูุชูุงุถุนูุง ูู ุฏุฑุงุณุฉ ูุชุทุจูู TensorFlow ูุงูุดุจูุงุช ุงูุนุตุจูุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="noopener">ููุจุญุซ ุนู automata ุงูุฎูููุฉ</a> ุ ูุฑุฑุช ุฃู ุฃุญุงูู ุงุณุชุฎุฏุงู ุงูุดุจูุงุช ุงูุนุตุจูุฉ ูุฅูุดุงุก ููุณููู. <br><br><h2 style=";text-align:right;direction:rtl">  ููู ูุนููุ </h2><br>  ุงูููุญู ูุนูู ุดุจูุฉ ุนุตุจูุฉ ูุน ุฐุงูุฑุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="noopener">ุทูููุฉ</a> ุงูุฃุฌู (LSTM).  ุดุจูุงุช LSTM ููุงุณุจุฉ ุชูุงููุง ููุชูุจุค ุจูุง ูุฃุชู ุจุนุฏ ุฐูู ูู ุชุณูุณู ุงูุจูุงูุงุช.  ูุฑุงุกุฉ ุงููุฒูุฏ ุนู LSTM <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="noopener">ููุง</a> . <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/0db/ce9/120/0dbce9120efb949af9aff64a8177c02f.png" title="LSTM - ุงููุฑ ููุญุตูู ุนูู ุงูุญุฌู ุงูุฃุตูู" width="500"></div><br>  ุชุชููู ุดุจูุฉ LSTM ุชุณูุณูุงุช ูุฎุชููุฉ ูู ุงูููุงุญุธุงุช (ูู ูุฐู ุงูุญุงูุฉ ุ ูุฐู ูู ูููุงุช midi ุฃุญุงุฏูุฉ ุงูููุงุฉ).  ุจุนุฏ ุงูุชุฏุฑูุจ ุงููุงูู ุ ุชุชุงุญ ููุง ุงููุฑุตุฉ ูุฅูุดุงุก ููุณููู ููุงุซูุฉ ููููุงุฏ ุงูุชุนููููุฉ. <br><a name="habracut"></a><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/3f1/b32/98d/3f1b3298dededa70f51a95d42727aaf0.png" title="LSTM - ุงููุฑ ููุญุตูู ุนูู ุงูุญุฌู ุงูุฃุตูู" width="500"></div><br>  ูุฏ ุชุจุฏู LSTM ุงูุฏุงุฎููุฉ ูุฎููุฉ ุ ููู ุงุณุชุฎุฏุงู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="noopener">TensorFlow</a> ู / ุฃู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="noopener">Keras</a> ูุจุณุท ุจุดูู ูุจูุฑ ุฅูุดุงุก LSTM ูุชุฌุฑูุจู. <br><br><h2 style=";text-align:right;direction:rtl">  ููุณููู ุงููุตุฏุฑ ููุชุฏุฑูุจ ุงููููุฐุฌู </h2><br>  ุจุงููุณุจุฉ ุฅูู ุดุจูุงุช LSTM ุงูุจุณูุทุฉ ุ ูููู ุฃู ุชููู ุงูุชุฑุงููุจ ุงููุตุฏุฑ ููุงุฉ ููุฏู ูุงุญุฏุฉ.  ูุจูุฑุฉ ููุฐุง ูู ูููุงุช ููุฏู ูููุฑุฏุง ุฅูู ุงูุจูุงูู.  ููุฏ ูุฌุฏุช ูููุงุช midi ูุน ุงูุจูุงูู ุงููุนุฒููุงุช ุงููููุฑุฏุฉ ุนูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="noopener">ุตูุญุฉ ุงูุจูุงูู ุงูููุงุณูููุฉ Midi</a> ู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="noopener">mfiles</a> ุ ูุงุณุชุฎุฏูุชูุง ูุชุฏุฑูุจ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="noopener">ููุงุฐุฌู</a> . <br><br>  ุฃุถุน ููุณููู ุงูููุญููู ุงููุฎุชูููู ูู ูุฌูุฏุงุช ูููุตูุฉ.  ุจูุถู ูุฐุง ุ ูููู ูููุณุชุฎุฏู ุชุญุฏูุฏ Bach ุ ุงููุฑ ููู ุงูุฒุฑ "ุฅูุดุงุก" ูุงูุญุตูู ุนูู ุฃุบููุฉ (ูุฃูู) ุฃู ุชููู ูุซู Bach. <br><br><h2 style=";text-align:right;direction:rtl">  ูููุฐุฌ LSTM </h2><br>  ุญุฏุฏ ุงููููุฐุฌ ุงูุฐู ููุช ุนูู ุฃุณุงุณู ุงูุฑูุฒ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุฐุง ุงููุซุงู</a> ูููุคูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="noopener">Sigurรฐur Skรบli Sigurgeirsson</a> ุ ุงูุฐู ููุชุจ ุนูู ุจูุฒูุฏ ูู ุงูุชูุงุตูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="noopener">ููุง</a> . <br><br>  ููุช ุจุชุดุบูู ุงูุจุฑูุงูุฌ ุงููุตู lstm.py ูุจุนุฏ 15 ุณุงุนุฉ ุฃูููุช ุงูุชุฏุฑูุจ.  ุนูุฏูุง ููุช ุฃููู ุจุชูููุน ุงูุชูุจุค. py ูุฅูุดุงุก ูููุงุช midi ุ ุดุนุฑุช ุจุฎูุจุฉ ุฃูู ูุฃููุง ูุงูุช ุชุชููู ูู ููุงุญุธุฉ ูุชูุฑุฑุฉ ูุงุญุฏุฉ.  ุชูุฑุงุฑ ุงูุชุฏุฑูุจ ูุฑุชูู ุ ุญุตูุช ุนูู ููุณ ุงููุชุงุฆุฌ. <br><br>  ูููุฐุฌ ุงููุตุฏุฑ <br><br><pre style=";text-align:right;direction:rtl"><code class="python hljs">model = Sequential() model.add(CuDNNLSTM(<span class="hljs-number"><span class="hljs-number">512</span></span>,input_shape=(network_input.shape[<span class="hljs-number"><span class="hljs-number">1</span></span>], network_input.shape[<span class="hljs-number"><span class="hljs-number">2</span></span>]),return_sequences=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)) model.add(Dropout(<span class="hljs-number"><span class="hljs-number">0.3</span></span>)) model.add(CuDNNLSTM(<span class="hljs-number"><span class="hljs-number">512</span></span>, return_sequences=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)) model.add(Dropout(<span class="hljs-number"><span class="hljs-number">0.3</span></span>)) model.add(CuDNNLSTM(<span class="hljs-number"><span class="hljs-number">512</span></span>)) model.add(Dense(<span class="hljs-number"><span class="hljs-number">256</span></span>)) model.add(Dropout(<span class="hljs-number"><span class="hljs-number">0.3</span></span>)) model.add(Dense(n_vocab)) model.add(Activation(<span class="hljs-string"><span class="hljs-string">'softmax'</span></span>)) model.compile(loss=<span class="hljs-string"><span class="hljs-string">'categorical_crossentropy'</span></span>, optimizer=<span class="hljs-string"><span class="hljs-string">'rmsprop'</span></span>,metrics=[<span class="hljs-string"><span class="hljs-string">"accuracy"</span></span>])</code> </pre> <br>  ุจุนุฏ ุฅุถุงูุฉ ุฅุฎุฑุงุฌ ุงูุฑุณู ุงูุจูุงูู ุฅูู ุงูุจุฑูุงูุฌ ุงููุตู ุ ุฑุฃูุช ููุงุฐุง ูู ูุนูู ูููุฐุฌู.  ูู ุฏูุฉ ูุง ุชููู ูุน ูุฑูุฑ ุงูููุช ุ ููุง ููุจุบู.  ุงูุธุฑ ุฃุฏูุงู ูู ุงูููุดูุฑ ููุญุตูู ุนูู ุงูุฑุณูู ุงูุจูุงููุฉ ุงูุฌูุฏุฉ ุงูุชู ุชุธูุฑ ููู ููุจุบู ุฃู ูุจุฏู ูููุฐุฌ ุงูุนูู. <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/28c/2ef/19d/28c2ef19dee58e8235a240b536162ceb.jpg" title="ุงููุฑ ููุญุตูู ุนูู ุงูุญุฌู ุงูุฃุตูู" width="500"></div><br>  ูู ููู ูุฏู ุฃู ููุฑุฉ ููุงุฐุง ุญุฏุซ ุฐูู.  ูููู ุงูุชุฎูู ุนู ูุฐุง ุงููููุฐุฌ ูุจุฏุฃ ูู ุถุจุท ุงูุฅุนุฏุงุฏุงุช. <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">model = Sequential() model.add(CuDNNLSTM(<span class="hljs-number"><span class="hljs-number">512</span></span>, input_shape=(network_input.shape[<span class="hljs-number"><span class="hljs-number">1</span></span>], network_input.shape[<span class="hljs-number"><span class="hljs-number">2</span></span>]), return_sequences=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)) model.add(Dropout(<span class="hljs-number"><span class="hljs-number">0.2</span></span>)) model.add(BatchNormalization()) model.add(CuDNNLSTM(<span class="hljs-number"><span class="hljs-number">256</span></span>)) model.add(Dropout(<span class="hljs-number"><span class="hljs-number">0.2</span></span>)) model.add(BatchNormalization()) model.add(Dense(<span class="hljs-number"><span class="hljs-number">128</span></span>, activation=<span class="hljs-string"><span class="hljs-string">"relu"</span></span>)) model.add(Dropout(<span class="hljs-number"><span class="hljs-number">0.2</span></span>)) model.add(BatchNormalization()) model.add(Dense(n_vocab)) model.add(Activation(<span class="hljs-string"><span class="hljs-string">'softmax'</span></span>)) model.compile(loss=<span class="hljs-string"><span class="hljs-string">'categorical_crossentropy'</span></span>, optimizer=<span class="hljs-string"><span class="hljs-string">'adam'</span></span>,metrics=[<span class="hljs-string"><span class="hljs-string">"accuracy"</span></span>])</code> </pre> <br>  ุฅูู ุฃูุซุฑ ุฅุญูุงูุง ููุฏูู ุทุจูุงุช LSTM ุฃูู.  ุฃุถูุช ุฃูุถุง BatchNormalization ุ ุฑุคูุชู ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="noopener">ุงูููุฏูู sentdex</a> .  ุนูู ุงูุฃุฑุฌุญ ุ ููุงู ููุงุฐุฌ ุฃูุถู ุ ููู ูุฐุง ุงููููุฐุฌ ูุฌุญ ุฌูุฏูุง ูู ุฌููุน ุฏูุฑุงุชู ุงูุชุฏุฑูุจูุฉ. <br><br>  ูุงุญุธ ุฃูู ูู ููุง ุงููููุฐุฌูู ููุช ุจุงุณุชุจุฏุงู LSTM ุจู CuDNNLSTM.  ูุฐุง ููุฏ ุญุตูุช ุนูู ุชุฏุฑูุจ ุฃุณุฑุน ุจูุซูุฑ ูู LSTM ุจูุถู ุงุณุชุฎุฏุงู Cuda.  ุฅุฐุง ูู ููู ูุฏูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="noopener">GPU ูุน ุฏุนู Cuda</a> ุ ูุนููู ุงุณุชุฎุฏุงู LSTM.  ุดูุฑุง ู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="noopener">sendtex</a> ููุฐู ุงููุตูุญุฉ.  ุชุนูู ููุงุฐุฌ ุฌุฏูุฏุฉ ูุชูููู ูููุงุช midi ุจุงุณุชุฎุฏุงู CuDNNLSTM ุฃุณุฑุน ุจูุญู ุฎูุณ ูุฑุงุช. <br><br><h2 style=";text-align:right;direction:rtl">  ูู ูู ุงูููุช ูุฌุจ ุชุฏุฑูุจ ุงููููุฐุฌ </h2><br>  ูุนุชูุฏ ุชุดุงุจู ุงููุชุงุฆุฌ ูุน ุงูููุณููู ุงูุฃุตููุฉ ุนูู ูุฏุฉ ุงูุชุฏุฑูุจ ุงููููุฐุฌู (ุนุฏุฏ ุงูุนุตูุฑ).  ุฅุฐุง ูุงู ููุงู ุนุฏุฏ ูููู ุฌุฏูุง ูู ุงูุนุตูุฑ ุ ูุณุชููู ูููุชูุฌุฉ ุงููุงุชุฌุฉ ุงููุซูุฑ ูู ุงูููุงุญุธุงุช ุงููุชูุฑุฑุฉ.  ุฅุฐุง ูุงู ููุงู ุงููุซูุฑ ูู ุงูุนุตูุฑ ุ ูุณูุชู ุฅุนุงุฏุฉ ุชุฏุฑูุจ ุงููููุฐุฌ ูุจุจุณุงุทุฉ ูุณุฎ ุงูููุณููู ุงูุฃุตููุฉ. <br><br>  ูููู ููู ููููู ุฃู ุชุนุฑู ูู ูู ุงูุนุตูุฑ ููููุ <br><br>  ูุชูุซู ุงูุญู ุงูุจุณูุท ูู ุฅุถุงูุฉ ุฑุฏ ุงุชุตุงู ูููู ุจุชุฎุฒูู ุงููููุฐุฌ ูุฏูุฉ / ุฎุณุงุฑุฉ ุงูุฑุณู ุงูุจูุงูู ูู 50 ุนุตูุฑ ูู ุฏูุฑุฉ ุชุฏุฑูุจูุฉ ูู 500 ุนุตุฑ.  ุจูุถู ูุฐุง ุ ุจุนุฏ ุงูุงูุชูุงุก ูู ุงูุชุฏุฑูุจ ุ ุณุชุญุตู ุนูู ููุงุฐุฌ ูุฑุณูู ุจูุงููุฉ ุจุฒูุงุฏุฉ ูุฏุฑูุง 50 ุนุตูุฑ ุ ุชูุถุญ ููููุฉ ุณูุฑ ุงูุชุฏุฑูุจ. <br><br>  ูููุง ููู ูุชุงุฆุฌ ุงูุฑุณูู ุงูุจูุงููุฉ ูุชุดุบูู ูุงุญุฏ ูุน ุชูููุฑ ูู 50 ุนุตุฑ ุ ูุฏูุฌุฉ ูู ุตูุฑุฉ GIF ูุชุญุฑูุฉ ูุงุญุฏุฉ. <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/e93/357/716/e933577163ece7cc7e679edec71d0b90.gif"></div><br>  ูุฐู ูู ุงูุฑุณูู ุงูุจูุงููุฉ ุงูุชู ูุฑูุฏ ุฃู ูุฑู.  ูุฌุจ ุฃู ุชุณูุท ุงูุฎุณุงุฆุฑ ูุชุจูู ููุฎูุถุฉ.  ูุฌุจ ุฒูุงุฏุฉ ุงูุฏูุฉ ูุชุจูู ูุฑูุจุฉ ูู 100 ูช. <br><br>  ูู ุงูุถุฑูุฑู ุงุณุชุฎุฏุงู ูููุฐุฌ ูุน ุนุฏุฏ ูู ุงูุญูุงุฆุจ ุงูููุงุจูุฉ ููุญุธุฉ ุงูุชู ูุตูุช ูููุง ุงูุฑุณูู ุงูุจูุงููุฉ ูุฃูู ูุฑุฉ ุฅูู ุญุฏูุฏูุง.  ุจุงููุณุจุฉ ููุฑุณู ุงูุจูุงูู ุงูููุถุญ ุฃุนูุงู ุ ุณูููู 150 ุนุตุฑูุง.  ุฅุฐุง ููุช ุชุณุชุฎุฏู ุงูููุฏููุงุช ุงููุฏููุฉ ุ ูุณูุชู ุฅุนุงุฏุฉ ุชุฏุฑูุจูุง ูุนูู ุงูุฃุฑุฌุญ ุณุชุคุฏู ุฅูู ูุณุฎ ุจุณูุทุฉ ููููุงุฏ ุงููุตุฏุฑ. <br><br>  ุชู ุชุฏุฑูุจ ุงููููุฐุฌ ุงูููุงุจู ููุฐู ุงูุฃุนูุฏุฉ ุนูู ูููุงุช midi ูู ูุฆุฉ ุงูุฃูุงุดูุฏ ุงููุฃุฎูุฐุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="noopener">ูู ููุง</a> . <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/b21/d24/c00/b21d24c00c73a214714352d2c3b1f900.png" title="ุงููุฑ ููุงุณุชูุงุน ุฅูู ููุฏู" width="26"></a> <br><br>  ุฅุฎุฑุงุฌ ุงูุจูุงูุงุช ููุฏู ูู ูููุฐุฌ ูุน 150 ุนุตูุฑ. <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/b21/d24/c00/b21d24c00c73a214714352d2c3b1f900.png" title="ุงููุฑ ููุงุณุชูุงุน ุฅูู ููุฏู" width="26"></a> <br><br>  ููุฏู ุงูุฅุฎุฑุงุฌ ูู ูููุฐุฌ 100 ุนุตุฑ. <br><br>  ุญุชู ุงููููุฐุฌ ุงูุฐู ูุญุชูู ุนูู 100 ุนุตุฑ ููููู ูุณุฎ ุงููุตุฏุฑ ุจุฏูุฉ ุดุฏูุฏุฉ.  ูุฏ ูููู ูุฐุง ุจุณุจุจ ุนููุฉ ุตุบูุฑุฉ ูุณุจูุง ูู ูููุงุช midi ููุชุฏุฑูุจ.  ูุน ูุฒูุฏ ูู ุงูููุงุญุธุงุช ุ ูุงูุชุนูู ูู ุฃูุถู. <br><br><h2 style=";text-align:right;direction:rtl">  ุนูุฏูุง ูุณูุฑ ุงูุชุนูู </h2><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/166/c17/97c/166c1797ceb0baa6894a982d55ce12ed.jpg" title="ุงููุฑ ููุญุตูู ุนูู ุงูุญุฌู ุงูุฃุตูู" width="500"></div><br>  ุชูุถุญ ุงูุตูุฑุฉ ุฃุนูุงู ูุซุงููุง ููุง ูููู ุฃู ูุญุฏุซ ููุง ูุญุฏุซ ุฃุซูุงุก ุงูุชุฏุฑูุจ.  ูุชู ุชูููู ุงูุฎุณุงุฆุฑ ุ ูุฒูุงุฏุฉ ุงูุฏูุฉ ุ ูุงููุนุชุงุฏ ุ ูููู ูุฌุฃุฉ ุชุจุฏุฃ ุจุงูุฌููู.  ูู ูุฐู ุงููุฑุญูุฉ ุ ูุฏ ูููู ูู ุงููููุฏ ุฃูุถูุง ุงูุชููู.  ูู ูุชุนูู ุงููููุฐุฌ ูุฑุฉ ุฃุฎุฑู (ุนูู ุงูุฃูู ูู ุชุฌุฑุจุชู) ุจุดูู ุตุญูุญ.  ูู ูุฐู ุงูุญุงูุฉ ุ ูุง ูุฒุงู ุงููููุฐุฌ ุงููุญููุธ ุงูุฐู ูุญุชูู ุนูู 100 ุนุตูุฑ ุนุดูุงุฆููุง ููุบุงูุฉ ุ ููุน 150 ุนุตุฑูุง ุงูุชูุช ูุญุธุฉ ูุดู ุงููููุฐุฌ ุจุงููุนู.  ุงูุขู ุ ูุชู ุญูุธู ูู ูู 25 ุนุตุฑูุง ููุนุซูุฑ ุนูู ุงููุญุธุฉ ุงููุซุงููุฉ ูููููุฐุฌ ุชูุงููุง ูุน ุฃูุถู ุชุฏุฑูุจ ุ ุญุชู ูุจู ุฅุนุงุฏุฉ ุชุฏุฑูุจูุง ูุชุนุทููุง. <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/486/65a/eea/48665aeea577e093ad0d944a4b4a3a35.jpg" title="ุงููุฑ ููุญุตูู ุนูู ุงูุญุฌู ุงูุฃุตูู" width="500"></div><br>  ูุซุงู ุขุฎุฑ ุนูู ุฎุทุฃ ุงูุชุนูู.  ุชู ุชุฏุฑูุจ ูุฐุง ุงููููุฐุฌ ุนูู ูููุงุช midi ูุฃุฎูุฐุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="noopener">ูู ููุง</a> .  ูู ูุฐู ุงูุญุงูุฉ ุ ุญุงูุธุช ุนูู ุตุญุชูุง ููุชุฑุฉ ุฃุทูู ุจูููู ูู 200 ุนุตุฑ.  ุนูุฏ ุงุณุชุฎุฏุงู ูููุฐุฌ ูุญุชูู ุนูู 200 ุนุตุฑ ุ ูุชู ุงูุญุตูู ุนูู ุงููุชูุฌุฉ ุงูุชุงููุฉ ูู Midi. <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/b21/d24/c00/b21d24c00c73a214714352d2c3b1f900.png" title="ุงููุฑ ููุงุณุชูุงุน ุฅูู ููุฏู" width="26"></a> <br><br>  ุจุฏูู ุฅูุดุงุก ุงูุฑุณูู ุงูุจูุงููุฉ ุ ูู ูุนุฑู ุฃุจุฏูุง ูุง ุฅุฐุง ูุงู ุงููููุฐุฌ ููุงุฌู ูุดุงูู ููุชู ูุดุฃุช ุ ููุฐูู ูุง ูููู ุงูุญุตูู ุนูู ูููุฐุฌ ุฌูุฏ ุฏูู ุงูุจุฏุก ูู ููุทุฉ ุงูุตูุฑ. <br><br><h2 style=";text-align:right;direction:rtl">  ุฃูุซูุฉ ุฃุฎุฑู </h2><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/b21/d24/c00/b21d24c00c73a214714352d2c3b1f900.png" title="ุงููุฑ ููุงุณุชูุงุน ุฅูู ููุฏู" width="26"></a> <br><br>  ูููุฐุฌ ูุน 75 ุนุตูุฑ ุ ุชู ุฅูุดุงุคู ุนูู ุฃุณุงุณ ุชููููุงุช <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="noopener">ุดูุจุงู</a> . <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/b21/d24/c00/b21d24c00c73a214714352d2c3b1f900.png" title="ุงููุฑ ููุงุณุชูุงุน ุฅูู ููุฏู" width="26"></a> <br><br>  ูููุฐุฌ ูู ุฎูุณูู ุนุตุฑูุง ูุณุชูุฏ ุฅูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="noopener">ูููุงุช Midi ูุชุฑููุจุงุช ุนูุฏ ุงููููุงุฏ</a> . <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/b21/d24/c00/b21d24c00c73a214714352d2c3b1f900.png" title="ุงููุฑ ููุงุณุชูุงุน ุฅูู ููุฏู" width="26"></a> <br><br>  ูููุฐุฌ 100 ุนุตุฑ ูุนุชูุฏ ุนูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="noopener">ูููุงุช Midi ูุชุฑููุจุงุช ุนูุฏ ุงููููุงุฏ</a> .  ูููู ูู ูู ุญูุง "ุนูุฏ ุงููููุงุฏ"ุ <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/b21/d24/c00/b21d24c00c73a214714352d2c3b1f900.png" title="ุงููุฑ ููุงุณุชูุงุน ุฅูู ููุฏู" width="26"></a> <br><br>  ูููุฐุฌ 300 ุนุตุฑ ูุนุชูุฏ ุนูู ูููุงุช Bach Midi ูุฃุฎูุฐุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="noopener">ูู ููุง</a> ููู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="noopener">ููุง</a> . <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/b21/d24/c00/b21d24c00c73a214714352d2c3b1f900.png" title="ุงููุฑ ููุงุณุชูุงุน ุฅูู ููุฏู" width="26"></a> <br><br>  ูููุฐุฌ 200 ุนุตุฑ ูุนุชูุฏ ุนูู ููู Midi ุงููุญูุฏ ุจุงูุงููุฑู ุงูุฐู ุชู ุงูุชูุงุทู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="noopener">ููุง</a> . <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/b21/d24/c00/b21d24c00c73a214714352d2c3b1f900.png" title="ุงููุฑ ููุงุณุชูุงุน ุฅูู ููุฏู" width="26"></a> <br><br>  ูููุฐุฌ ูุน 200 ุนุตูุฑ ุ ุงุณุชูุงุฏุง ุฅูู ุงูุชุฑุงููุจ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="noopener">ุฏูุจูุณู</a> . <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/b21/d24/c00/b21d24c00c73a214714352d2c3b1f900.png" title="ุงููุฑ ููุงุณุชูุงุน ุฅูู ููุฏู" width="26"></a> <br><br>  ูููุฐุฌ ูู ุนุตุฑ 175 ูุณุชูุฏ ุฅูู ูุคููุงุช ููุฒุงุฑุช. <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/b21/d24/c00/b21d24c00c73a214714352d2c3b1f900.png" title="ุงููุฑ ููุงุณุชูุงุน ุฅูู ููุฏู" width="26"></a> <br><br>  ูููุฐุฌ ูุน 100 ุนุตูุฑ ุนูู ุฃุณุงุณ ูุคููุงุช <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="noopener">ุดูุจุฑุช</a> . <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/b21/d24/c00/b21d24c00c73a214714352d2c3b1f900.png" title="ุงููุฑ ููุงุณุชูุงุน ุฅูู ููุฏู" width="26"></a> <br><br>  ูููุฐุฌ ูู 200 ุนุตุฑ ูุงุฆู ุนูู ูุคููุงุช <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="noopener">ุดููุงู</a> . <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/b21/d24/c00/b21d24c00c73a214714352d2c3b1f900.png" title="ุงููุฑ ููุงุณุชูุงุน ุฅูู ููุฏู" width="26"></a> <br><br>  ูููุฐุฌ ูู 200 ุนุตุฑ ูุงุฆู ุนูู ูุคููุงุช <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="noopener">ุชุดุงููููุณูู</a> . <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/b21/d24/c00/b21d24c00c73a214714352d2c3b1f900.png" title="ุงููุฑ ููุงุณุชูุงุน ุฅูู ููุฏู" width="26"></a> <br><br>  ูููุฐุฌ ูุน 175 ุนุตูุฑ ุนูู ุฃุณุงุณ ุงูุฃุบุงูู ุงูุดุนุจูุฉ. <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/b21/d24/c00/b21d24c00c73a214714352d2c3b1f900.png" title="ุงููุฑ ููุงุณุชูุงุน ุฅูู ููุฏู" width="26"></a> <br><br>  ูููุฐุฌ ูุน 100 ุนุตูุฑ ุนูู ุฃุณุงุณ ุงูุชูููุฏุงุช. <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/b21/d24/c00/b21d24c00c73a214714352d2c3b1f900.png" title="ุงููุฑ ููุงุณุชูุงุน ุฅูู ููุฏู" width="26"></a> <br><br>  ูููุฐุฌ ูู 100 ุนุตุฑ ูุนุชูุฏ ุนูู ููุณููู ุงูุฒูุงู. <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/b21/d24/c00/b21d24c00c73a214714352d2c3b1f900.png" title="ุงููุฑ ููุงุณุชูุงุน ุฅูู ููุฏู" width="26"></a> <br><br>  ูููุฐุฌ 200 ุนุตุฑ ูุนุชูุฏ ุนูู ูููุงุช ููุฏู ุงูุฎุงุตุฉ ุจู ุงููุฃุฎูุฐุฉ ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="noopener">ููุงุทุน ุงูููุฏูู</a> ุงูุฎุงุตุฉ ุจู ุนูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="noopener">YouTube</a> .  ูุฏ ูุชู ุฅุนุงุฏุฉ ุชุฏุฑูุจู ุจุนุถ ุงูุดูุก ูุฃูู ูููู ุจุดูู ุฃุณุงุณู ุจุฅูุดุงุก ูุณุฎ ูู ูููุงุช midi ุงููุตูุฑุฉ ุฐุงุช ุงูุณูุชูู ุงููุงุญุฏุฉ ูุงูุซุงููุฉ. <br><br><h2 style=";text-align:right;direction:rtl">  ุนุดุฑุงุช </h2><br>  ุจูุฌุฑุฏ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="noopener">ุงูุญุตูู ุนูู</a> ูููุงุช midi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="noopener">ุงูุฎุงุตุฉ ุจู</a> ุ ููููู ุงุณุชุฎุฏุงู ุฃุฏูุงุช ุนุจุฑ ุงูุฅูุชุฑูุช ูุซู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="noopener">SolMiRe</a> ูุชุญููููุง ุฅูู ูุชุงุฆุฌ.  ูู ูุง ููู ูุชูุฌุฉ ููู midi Softology 200-epoch ุงููุงุฑุฏ ุฃุนูุงู. <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/1e4/7fe/2cc/1e47fe2cc3cada4e27671bfe27397226.jpg" title="ุงููุฑ ููุญุตูู ุนูู ุงูุญุฌู ุงูุฃุตูู" width="500"></div><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/ccd/2ff/dff/ccd2ffdff1344ef7ad97a210dba6b17e.jpg" title="ุงููุฑ ููุญุตูู ุนูู ุงูุญุฌู ุงูุฃุตูู" width="500"></div><br><h2 style=";text-align:right;direction:rtl">  ุฃูู ูููููู ุงุฎุชุจุงุฑ ุงูููุญู </h2><br>  ูุชู ุชุถููู LSTM ุงูููุญู ุงูุขู ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="noopener">ุฑุคู ุงูููุถู</a> . <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/29c/abd/6ac/29cabd6acecf1baf6fd9f99e531d1f9e.jpg" width="500"></div><br>  ุญุฏุฏ ููุทูุง ูู ุงููุงุฆูุฉ ุงูููุณุฏูุฉ ูุงููุฑ ููู "ุฅูุดุงุก".  ุฅุฐุง ููุช ุจุชุซุจูุช ุงูุญุฏ ุงูุฃุฏูู ุงูุถุฑูุฑู ูู Python ู TensorFlow (ุงูุธุฑ ุงูุชุนูููุงุช <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="noopener">ููุง</a> ) ุ ูุณุชุชููู ูู ุบุถูู ุซูุงูู ููููุฉ (ุฅุฐุง ูุงู ูุฏูู ูุญุฏุฉ ูุนุงูุฌุฉ ุงูุฑุณููุงุช ุงูุณุฑูุนุฉ) ููููุง ุฌุฏูุฏูุง ูุชููู ูู ุขูุฉ ุ ูููููู ุงูุงุณุชูุงุน ุฅููู ูุงุณุชุฎุฏุงูู ูุฃู ุบุฑุถ ุขุฎุฑ.  ูุง ุญููู ุงูุทุจุน ูุงููุดุฑ ุ ูุง ุญููู ุงูููููุฉ.  ุฅุฐุง ูู ุชุนุฌุจู ุงููุชุงุฆุฌ ุ ูููููู ุงูููุฑ ููู "ุฅูุดุงุก" ูุฑุฉ ุฃุฎุฑู ูุจุนุฏ ุจุถุน ุซูุงูู ุ ุณุชููู ุงูุชุฑููุจุฉ ุงูุฌุฏูุฏุฉ ุฌุงูุฒุฉ. <br><br>  ูุง ูููู ุงุนุชุจุงุฑ ุงููุชุงุฆุฌ ุจุนุฏ ููุทูุนุงุช ูุงููุฉ ุ ูููู ูุฏููุง ุชุณูุณูุงุช ุตุบูุฑุฉ ููุซูุฑุฉ ููุงูุชูุงู ูู ุงูููุงุญุธุงุช ุงูุชู ุณุฃุณุชุฎุฏููุง ูุฅูุดุงุก ููุณููู ูู ุงููุณุชูุจู.  ูู ูุฐุง ุงูุตุฏุฏ ุ ูููู ุฃู ูููู ููุญู LSTM ูุตุฏุฑูุง ุฌูุฏูุง ููุฅููุงู ููููููุงุช ุงูุฌุฏูุฏุฉ. <br><br><h2 style=";text-align:right;direction:rtl">  ูุตุฏุฑ ุจุงูุซูู </h2><br>  ููุฌุฏ ุฃุฏูุงู ุฑูุฒ ุงูุจุฑูุงูุฌ ุงููุตู Python ุงูุฐู ุงุณุชุฎุฏูุชู ููุชุฏุฑูุจ ูุงูุชูุจุค ูู LSTM.  ููู ุชุนูู ูุฐู ุงูุจุฑุงูุฌ ุงููุตูุฉ ุ ููุณ ูู ุงูุถุฑูุฑู ุชุซุจูุช Visions of Chaos ุ ูุณูุนูู ุชุนูู ูุชูููุฏ midi ูู ุณุทุฑ ุงูุฃูุงูุฑ. <br><br>  ููุง ูู ุงูุณููุงุฑูู ุงูุชุฏุฑูุจ <code>lstm_music_train.py</code> <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">lstm_music_train.py</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># based on code from https://github.com/Skuldur/Classical-Piano-Composer # to use this script pass in; # 1. the directory with midi files # 2. the directory you want your models to be saved to # 3. the model filename prefix # 4. how many total epochs you want to train for # eg python -W ignore "C:\\LSTM Composer\\lstm_music_train.py" "C:\\LSTM Composer\\Bach\\" "C:\\LSTM Composer\\" "Bach" 500 import os import tensorflow as tf # ignore all info and warning messages os.environ['TF_CPP_MIN_LOG_LEVEL'] = '2' tf.compat.v1.logging.set_verbosity(tf.compat.v1.logging.ERROR) import glob import pickle import numpy import sys import keras import matplotlib.pyplot as plt from music21 import converter, instrument, note, chord from datetime import datetime from keras.models import Sequential from keras.layers.normalization import BatchNormalization from keras.layers import Dense from keras.layers import Dropout from keras.layers import CuDNNLSTM from keras.layers import Activation from keras.utils import np_utils from keras.callbacks import TensorBoard from shutil import copyfile # name of midi file directory, model directory, model file prefix, and epochs mididirectory = str(sys.argv[1]) modeldirectory = str(sys.argv[2]) modelfileprefix = str(sys.argv[3]) modelepochs = int(sys.argv[4]) notesfile = modeldirectory + modelfileprefix + '.notes' # callback to save model and plot stats every 25 epochs class CustomSaver(keras.callbacks.Callback): def __init__(self): self.epoch = 0 # This function is called when the training begins def on_train_begin(self, logs={}): # Initialize the lists for holding the logs, losses and accuracies self.losses = [] self.acc = [] self.logs = [] def on_epoch_end(self, epoch, logs={}): # Append the logs, losses and accuracies to the lists self.logs.append(logs) self.losses.append(logs.get('loss')) self.acc.append(logs.get('acc')*100) # save model and plt every 50 epochs if (epoch+1) % 25 == 0: sys.stdout.write("\nAuto-saving model and plot after {} epochs to ".format(epoch+1)+"\n"+modeldirectory + modelfileprefix + "_" + str(epoch+1).zfill(3) + ".model\n"+modeldirectory + modelfileprefix + "_" + str(epoch+1).zfill(3) + ".png\n\n") sys.stdout.flush() self.model.save(modeldirectory + modelfileprefix + '_' + str(epoch+1).zfill(3) + '.model') copyfile(notesfile,modeldirectory + modelfileprefix + '_' + str(epoch+1).zfill(3) + '.notes'); N = numpy.arange(0, len(self.losses)) # Plot train loss, train acc, val loss and val acc against epochs passed plt.figure() plt.subplots_adjust(hspace=0.7) plt.subplot(2, 1, 1) # plot loss values plt.plot(N, self.losses, label = "train_loss") plt.title("Loss [Epoch {}]".format(epoch+1)) plt.xlabel('Epoch') plt.ylabel('Loss') plt.subplot(2, 1, 2) # plot accuracy values plt.plot(N, self.acc, label = "train_acc") plt.title("Accuracy % [Epoch {}]".format(epoch+1)) plt.xlabel("Epoch") plt.ylabel("Accuracy %") plt.savefig(modeldirectory + modelfileprefix + '_' + str(epoch+1).zfill(3) + '.png') plt.close() # train the neural network def train_network(): sys.stdout.write("Reading midi files...\n\n") sys.stdout.flush() notes = get_notes() # get amount of pitch names n_vocab = len(set(notes)) sys.stdout.write("\nPreparing note sequences...\n") sys.stdout.flush() network_input, network_output = prepare_sequences(notes, n_vocab) sys.stdout.write("\nCreating CuDNNLSTM neural network model...\n") sys.stdout.flush() model = create_network(network_input, n_vocab) sys.stdout.write("\nTraining CuDNNLSTM neural network model...\n\n") sys.stdout.flush() train(model, network_input, network_output) # get all the notes and chords from the midi files def get_notes(): # remove existing data file if it exists if os.path.isfile(notesfile): os.remove(notesfile) notes = [] for file in glob.glob("{}/*.mid".format(mididirectory)): midi = converter.parse(file) sys.stdout.write("Parsing %s ...\n" % file) sys.stdout.flush() notes_to_parse = None try: # file has instrument parts s2 = instrument.partitionByInstrument(midi) notes_to_parse = s2.parts[0].recurse() except: # file has notes in a flat structure notes_to_parse = midi.flat.notes for element in notes_to_parse: if isinstance(element, note.Note): notes.append(str(element.pitch)) elif isinstance(element, chord.Chord): notes.append('.'.join(str(n) for n in element.normalOrder)) with open(notesfile,'wb') as filepath: pickle.dump(notes, filepath) return notes # prepare the sequences used by the neural network def prepare_sequences(notes, n_vocab): sequence_length = 100 # get all pitch names pitchnames = sorted(set(item for item in notes)) # create a dictionary to map pitches to integers note_to_int = dict((note, number) for number, note in enumerate(pitchnames)) network_input = [] network_output = [] # create input sequences and the corresponding outputs for i in range(0, len(notes) - sequence_length, 1): sequence_in = notes[i:i + sequence_length] # needs to take into account if notes in midi file are less than required 100 ( mod ? ) sequence_out = notes[i + sequence_length] # needs to take into account if notes in midi file are less than required 100 ( mod ? ) network_input.append([note_to_int[char] for char in sequence_in]) network_output.append(note_to_int[sequence_out]) n_patterns = len(network_input) # reshape the input into a format compatible with CuDNNLSTM layers network_input = numpy.reshape(network_input, (n_patterns, sequence_length, 1)) # normalize input network_input = network_input / float(n_vocab) network_output = np_utils.to_categorical(network_output) return (network_input, network_output) # create the structure of the neural network def create_network(network_input, n_vocab): ''' """ create the structure of the neural network """ model = Sequential() model.add(CuDNNLSTM(512, input_shape=(network_input.shape[1], network_input.shape[2]), return_sequences=True)) model.add(Dropout(0.3)) model.add(CuDNNLSTM(512, return_sequences=True)) model.add(Dropout(0.3)) model.add(CuDNNLSTM(512)) model.add(Dense(256)) model.add(Dropout(0.3)) model.add(Dense(n_vocab)) model.add(Activation('softmax')) model.compile(loss='categorical_crossentropy', optimizer='rmsprop',metrics=["accuracy"]) ''' model = Sequential() model.add(CuDNNLSTM(512, input_shape=(network_input.shape[1], network_input.shape[2]), return_sequences=True)) model.add(Dropout(0.2)) model.add(BatchNormalization()) model.add(CuDNNLSTM(256)) model.add(Dropout(0.2)) model.add(BatchNormalization()) model.add(Dense(128, activation="relu")) model.add(Dropout(0.2)) model.add(BatchNormalization()) model.add(Dense(n_vocab)) model.add(Activation('softmax')) model.compile(loss='categorical_crossentropy', optimizer='adam',metrics=["accuracy"]) return model # train the neural network def train(model, network_input, network_output): # saver = CustomSaver() # history = model.fit(network_input, network_output, epochs=modelepochs, batch_size=50, callbacks=[tensorboard]) history = model.fit(network_input, network_output, epochs=modelepochs, batch_size=50, callbacks=[CustomSaver()]) # evaluate the model print("\nModel evaluation at the end of training") train_acc = model.evaluate(network_input, network_output, verbose=0) print(model.metrics_names) print(train_acc) # save trained model model.save(modeldirectory + modelfileprefix + '_' + str(modelepochs) + '.model') # delete temp notes file os.remove(notesfile) if __name__ == '__main__': train_network()</span></span></code> </pre> </div></div><br>  ููู ูุง <code>lstm_music_predict.py</code> ุงููุต ุงูุจุฑูุฌู ููุฌูู <code>lstm_music_predict.py</code> : <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">lstm_music_predict.py</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># based on code from https://github.com/Skuldur/Classical-Piano-Composer # to use this script pass in; # 1. path to notes file # 2. path to model # 3. path to midi output # eg python -W ignore "C:\\LSTM Composer\\lstm_music_predict.py" "C:\\LSTM Composer\\Bach.notes" "C:\\LSTM Composer\\Bach.model" "C:\\LSTM Composer\\Bach.mid" # ignore all info and warning messages import os os.environ['TF_CPP_MIN_LOG_LEVEL'] = '2' import tensorflow as tf tf.compat.v1.logging.set_verbosity(tf.compat.v1.logging.ERROR) import pickle import numpy import sys import keras.models from music21 import instrument, note, stream, chord from keras.models import Sequential from keras.layers import Dense from keras.layers import Dropout from keras.layers import Activation # name of weights filename notesfile = str(sys.argv[1]) modelfile = str(sys.argv[2]) midifile = str(sys.argv[3]) # generates a piano midi file def generate(): sys.stdout.write("Loading notes data file...\n\n") sys.stdout.flush() #load the notes used to train the model with open(notesfile, 'rb') as filepath: notes = pickle.load(filepath) sys.stdout.write("Getting pitch names...\n\n") sys.stdout.flush() # Get all pitch names pitchnames = sorted(set(item for item in notes)) # Get all pitch names n_vocab = len(set(notes)) sys.stdout.write("Preparing sequences...\n\n") sys.stdout.flush() network_input, normalized_input = prepare_sequences(notes, pitchnames, n_vocab) sys.stdout.write("Loading LSTM neural network model...\n\n") sys.stdout.flush() model = create_network(normalized_input, n_vocab) sys.stdout.write("Generating note sequence...\n\n") sys.stdout.flush() prediction_output = generate_notes(model, network_input, pitchnames, n_vocab) sys.stdout.write("\nCreating MIDI file...\n\n") sys.stdout.flush() create_midi(prediction_output) # prepare the sequences used by the neural network def prepare_sequences(notes, pitchnames, n_vocab): # map between notes and integers and back note_to_int = dict((note, number) for number, note in enumerate(pitchnames)) sequence_length = 100 network_input = [] output = [] for i in range(0, len(notes) - sequence_length, 1): sequence_in = notes[i:i + sequence_length] sequence_out = notes[i + sequence_length] network_input.append([note_to_int[char] for char in sequence_in]) output.append(note_to_int[sequence_out]) n_patterns = len(network_input) # reshape the input into a format compatible with LSTM layers normalized_input = numpy.reshape(network_input, (n_patterns, sequence_length, 1)) # normalize input normalized_input = normalized_input / float(n_vocab) return (network_input, normalized_input) # create the structure of the neural network def create_network(network_input, n_vocab): model = keras.models.load_model(modelfile) return model # generate notes from the neural network based on a sequence of notes def generate_notes(model, network_input, pitchnames, n_vocab): # pick a random sequence from the input as a starting point for the prediction start = numpy.random.randint(0, len(network_input)-1) int_to_note = dict((number, note) for number, note in enumerate(pitchnames)) pattern = network_input[start] prediction_output = [] # generate 500 notes for note_index in range(500): prediction_input = numpy.reshape(pattern, (1, len(pattern), 1)) prediction_input = prediction_input / float(n_vocab) prediction = model.predict(prediction_input, verbose=0) index = numpy.argmax(prediction) result = int_to_note[index] prediction_output.append(result) pattern.append(index) pattern = pattern[1:len(pattern)] if (note_index + 1) % 50 == 0: sys.stdout.write("{} out of 500 notes generated\n".format(note_index+1)) sys.stdout.flush() return prediction_output # convert the output from the prediction to notes and create a midi file from the notes def create_midi(prediction_output): offset = 0 output_notes = [] # create note and chord objects based on the values generated by the model for pattern in prediction_output: # pattern is a chord if ('.' in pattern) or pattern.isdigit(): notes_in_chord = pattern.split('.') notes = [] for current_note in notes_in_chord: new_note = note.Note(int(current_note)) new_note.storedInstrument = instrument.Piano() notes.append(new_note) new_chord = chord.Chord(notes) new_chord.offset = offset output_notes.append(new_chord) # pattern is a note else: new_note = note.Note(pattern) new_note.offset = offset new_note.storedInstrument = instrument.Piano() output_notes.append(new_note) # increase offset each iteration so that notes do not stack offset += 0.5 midi_stream = stream.Stream(output_notes) midi_stream.write('midi', fp=midifile) if __name__ == '__main__': generate()</span></span></code> </pre> </div></div><br><h2 style=";text-align:right;direction:rtl">  ุฃุญุฌุงู ุงููููุงุช ุงููููุฐุฌูุฉ </h2><br>  ุนูุจ ุชุถููู ุงูุดุจูุงุช ุงูุนุตุจูุฉ ูู ุฑุคู ุงูููุถู ูู ุญุฌู ุงููููุงุช.  ุฅุฐุง ูุงู ุชูููุฏ ุงููููุฐุฌ ุฃุณุฑุน ุ ูุณุฃุถูู ุฒุฑูุง ุญุชู ูุชุณูู ูููุณุชุฎุฏู ุงูููุงุฆู ุชุฏุฑูุจ ุงูููุงุฐุฌ ุจููุณู.  ูููู ูุธุฑูุง ูุฃู ุจุนุถ ุงูุฏูุฑุงุช ุงูุชุฏุฑูุจูุฉ ููุนุฏูุฏ ูู ุงูููุงุฐุฌ ูุฏ ุชุณุชุบุฑู ุนุฏุฉ ุฃูุงู ุ ูุฅู ูุฐุง ููุณ ุนููููุง ุจุดูู ุฎุงุต.  ุจุฏุง ูู ุฃูู ูู ุงูุฃูุถู ุงูููุงู ุจูู ุงูุชุฏุฑูุจ ูุงุฎุชุจุงุฑ ููุณู ุ ูุฅุถุงูุฉ ููุท ุฃูุถู ุงูููุงุฐุฌ ุงูุนุงููุฉ.  ูุฐุง ูุนูู ุฃูุถูุง ุฃู ุงููุณุชุฎุฏู ุงูููุงุฆู ูุญุชุงุฌ ููุท ุฅูู ุงูุถุบุท ุนูู ุฒุฑ ุ ูุฃู ุงูููุงุฐุฌ ุงููุฏุฑุจุฉ ุณุชูุดุฆ ููุทูุนุงุช ููุณูููุฉ. <br><br>  ูุจูุบ ุญุฌู ูู ุทุฑุงุฒ 22 ููุฌุงุจุงูุช.  ูู ุธู ุธุฑูู ุงูุฅูุชุฑูุช ุงูุญุฏูุซุฉ ุ ููุณ ูุฐุง ูุซูุฑูุง ุ ูููู ุนูู ูุฏุงุฑ ุณููุงุช ุงูุชุทููุฑ ุ ุงุฒุฏุงุฏ ุญุฌู ุฑุคู Chaos ุชุฏุฑูุฌูุงู ุ ููุคุฎุฑุงู ุฒุงุฏุช ุจุดูู ููุงุฌุฆ ูู 70 ุฅูู 91 ููุบุงุจุงูุช (ุจุณุจุจ ูููุฐุฌ ุงูุจุญุซ ุนู ุงูุฃูุชููุงุชุฉ ุงูุฎูููุฉ).  ูุฐูู ุ ุฃุถูุช ุญุชู ุงูุขู ูููุฐุฌูุง ูุงุญุฏูุง ููุท ุฅูู ุฃุฏุงุฉ ุชุซุจูุช Visions of Chaos.  ุจุงููุณุจุฉ ูููุณุชุฎุฏููู ุงูุฐูู ูุฑูุฏูู ุงููุฒูุฏ ุ ููุฏ ูุดุฑุช ุฑุงุจุทูุง ูุทุฑุงุฒุงุช 1 ุบูุบุงุจุงูุช ุฃุฎุฑู.  ูููููู ุฃูุถูุง ุงุณุชุฎุฏุงู ุงูุจุฑูุงูุฌ ุงููุตู ุฃุนูุงู ูุฅูุดุงุก ููุงุฐุฌ ุฎุงุตุฉ ุจูู ุงุณุชูุงุฏูุง ุฅูู ูููุงุช midi ุงูุฎุงุตุฉ ุจูู. <br><br><h2 style=";text-align:right;direction:rtl">  ูุง ุงูุชุงููุ </h2><br>  ูู ูุฐู ุงููุฑุญูุฉ ุ ูุนุฏ ููุญู LSTM ุฃุจุณุท ูุซุงู ุนูู ุงุณุชุฎุฏุงู ุงูุดุจูุงุช ุงูุนุตุจูุฉ ูุฅูุดุงุก ุงูููุณููู. <br><br>  ููุฏ ูุฌุฏุช ุจุงููุนู ููุญููู ููุณููููู ุขุฎุฑูู ุนูู ุดุจูุงุช ุนุตุจูุฉ ุณูู ุฃุฌุฑุจูุง ูู ุงููุณุชูุจู ุ ูุฐูู ููููู ุฃู ุชุชููุน ุฃู ูู Visions of Chaos ุณุชููู ููุงู ุฅููุงููุงุช ุฌุฏูุฏุฉ ูุชุฃููู ุงูููุณููู ุชููุงุฆููุง. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar470127/">https://habr.com/ru/post/ar470127/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar470109/index.html">ุชุถููู ุงูุชุบุฑูุฏุฉPythonetc ุณุจุชูุจุฑ 2019</a></li>
<li><a href="../ar470113/index.html">ููู ุบูุฑุช ุชูููุฉ ุงูุฐุงูุฑุฉ ุฐูุงุก ุงูุฃุนูุงู</a></li>
<li><a href="../ar470121/index.html">ุดุฑูุฉ ูุฏุงุฑุณ ุงูุจุฑูุฌุฉ ุฃู ููููุฉ ุฅุฏุฎุงู ุชูููููุฌูุง ุงููุนูููุงุช</a></li>
<li><a href="../ar470123/index.html">Yandex.Money ูุฎ ูุงูู</a></li>
<li><a href="../ar470125/index.html">ูุง ุชุญูู ุนูู ุฑูุฒ ุดุฎุต ุขุฎุฑ ุจุฏูุฉ</a></li>
<li><a href="../ar470129/index.html">ุฅุฏุงุฑุฉ ุงูุฐุงูุฑุฉ ุงูุชุนุฑููู</a></li>
<li><a href="../ar470133/index.html">ููููุฉ ุฌูุน ุงูููุงููุณ ุงูุชู ูุง ุชุดูููุง ุงูุฅุดุงุฑุฉ ุงูุฒูููุฉ ูุน ุจุฑูููุซููุณ</a></li>
<li><a href="../ar470139/index.html">2 ุงุฎุชุฑุงู ุงูุญูุงุฉ: ุจุฏุงุฆู ููุจุญุซ ุงูููุงุณููู ูู Microsoft SQL Server</a></li>
<li><a href="../ar470145/index.html">"ุงุญุฐุฑ ุ FAS!": ููุงุฐุง ุชุนุชุจุฑ ุงูุชุฐุงูุฑ ุงูุนุณูุฑูุฉ ุฎุทุฑุฉ ูู ุงูุฅุนูุงู ุ ููุงุฐุง ูู ุงูููู ูุนุฑูุฉ ุงูุฑูุงุถูุงุช ููุง ุฅุฐุง ูุงูุช ููุงู ุญุงุฌุฉ ุฏุงุฆููุง ุฅูู ุงูุญูููุฉ ุงููุฌุฑุฏุฉ</a></li>
<li><a href="../ar470149/index.html">ูู ุชููู ููุงู ูุฌููุนุงุช ุซุงุจุชุฉ ูู Java - ูุง ุงูุขู ููุง ุนูู ุงูุฅุทูุงู</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>