<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘ğŸ» ğŸ‘¨ğŸ¿â€ğŸ¤â€ğŸ‘¨ğŸ¾ âœ¡ï¸ Glissez et dÃ©posez dans vos applications iOS ğŸ“ª ğŸ™ğŸ¿ ğŸ­</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Le mÃ©canisme Drag & Drop fonctionnant sur iOS 11 et iOS 12 est un moyen de copier ou de dÃ©placer graphiquement de maniÃ¨re asynchrone des donnÃ©es Ã  la ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Glissez et dÃ©posez dans vos applications iOS</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/425817/"><img src="https://habrastorage.org/webt/gb/xu/dt/gbxudtvrfs8biaj5tlzkpjjjwe4.png"><br><br>  Le mÃ©canisme <code>Drag &amp; Drop</code> fonctionnant sur <code>iOS 11</code> et <code>iOS 12</code> est un moyen de copier ou de dÃ©placer graphiquement de maniÃ¨re asynchrone des donnÃ©es Ã  la fois dans une seule application et entre diffÃ©rentes applications.  Bien que cette technologie ait environ 30 ans, elle est littÃ©ralement devenue une technologie Â«rÃ©volutionnaireÂ» sur <code>iOS</code> raison du fait que lorsque vous faites glisser quelque chose sur <code>iOS</code> , le <code>multitouch</code> vous permet d'interagir librement avec le reste du systÃ¨me et de collecter des donnÃ©es Ã  rÃ©initialiser Ã  partir de diffÃ©rentes applications. <br><a name="habracut"></a><br>  <code>iOS</code> permet de capturer plusieurs Ã©lÃ©ments Ã  la fois.  De plus, ils n'ont pas besoin d'Ãªtre dans une accessibilitÃ© pratique pour la sÃ©lection: vous pouvez prendre le premier objet, puis aller dans une autre application et saisir autre chose - tous les objets seront collectÃ©s en Â«pileÂ» sous votre doigt.  Appelez ensuite le dock universel Ã  l'Ã©cran, ouvrez-y n'importe quelle application et capturez le troisiÃ¨me objet, puis accÃ©dez Ã  l'Ã©cran avec les applications en cours d'exÃ©cution et, sans libÃ©rer les objets, videz-les dans l'un des programmes ouverts.  Une telle libertÃ© d'action est possible sur l' <code>iPad</code> , sur l' <code>iPhone</code> , la couverture <code>Drag &amp; Drop</code> dans <code>iOS</code> limitÃ©e au cadre d'une seule application. <br><br>  Les applications les plus populaires ( <code>Safary</code> , <code>Chrome</code> , <code>IbisPaint X</code> , <code>Mail</code> , <code>Photos</code> , <code>Files</code> , etc.) ont dÃ©jÃ  un mÃ©canisme <code>Drag &amp; Drop</code> .  En plus de cela, <code>Apple</code> fourni aux dÃ©veloppeurs une <code>API</code> trÃ¨s simple et intuitive pour intÃ©grer le mÃ©canisme <code>Drag &amp; Drop</code> dans votre application.  Le mÃ©canisme <code>Drag &amp; Drop</code> , tout comme les gestes, fonctionne sur <b><font color="#0000FF">UIView</font></b> et utilise le concept d' <b><font color="#0000FF">interactions</font></b> , un peu comme les gestes, de sorte que vous pouvez considÃ©rer le mÃ©canisme <code>Drag &amp; Drop</code> comme un geste vraiment puissant. <br><br>  Il, ainsi que les gestes, est trÃ¨s facile Ã  intÃ©grer dans votre application.  Surtout si votre application utilise la table <b><font color="#0000FF">UITableView</font></b> ou la collection <b><font color="#0000FF">UICollectionView</font></b> , car pour eux <code>API Drag &amp; Drop</code> amÃ©liorÃ©e et Ã©levÃ©e Ã  un niveau d'abstraction supÃ©rieur dans le sens oÃ¹ la <code>Collection View</code> elle-mÃªme vous aide avec l' <b><font color="#0000FF">indexPath</font></b> de l'Ã©lÃ©ment de collection que vous souhaitez faire glisser et dÃ©poser <code>Drag</code> .  Elle sait oÃ¹ se trouve votre doigt et l'interprÃ¨te comme l' <b><font color="#0000FF">indexPath</font></b> de l'Ã©lÃ©ment de collection que vous Â« <code>Drag</code> glisserÂ» <code>Drag</code> en ce moment, ou comme l' <b><font color="#0000FF">indexPath</font></b> de l'Ã©lÃ©ment de collection oÃ¹ vous Â«dÃ©posezÂ» <code>Drop</code> quelque chose.  La <code>Collection View</code> vous fournit donc <b><font color="#0000FF">indexPath</font></b> , mais sinon c'est absolument la mÃªme <code>API Drag &amp; Drop</code> que pour une <b><font color="#0000FF">UIView standard</font></b> . <br><br>  Le processus <code>Drag &amp; Drop</code> sur <code>iOS</code> comporte 4 phases diffÃ©rentes: <br><br><h2>  Lift </h2><br>  <b>Lift</b> (levage) - c'est lorsque l'utilisateur effectue un geste de <b><font color="#FF00FF">pression longue</font></b> , indiquant l'Ã©lÃ©ment qui sera Â«glisser-dÃ©poserÂ».  Ã€ ce moment, un soi-disant Â« <code>lift preview</code> Â» trÃ¨s lÃ©ger de l'Ã©lÃ©ment indiquÃ© est formÃ©, puis l'utilisateur commence Ã  faire glisser ses doigts. <br><br><img src="https://habrastorage.org/webt/t6/sw/tw/t6swtwdee7kasyvqq_od3ipzlxy.png" width="600" height="450"><br><br><h2>  Glisser (glisser-dÃ©poser) </h2><br>  <b>Glisser</b> (glisser-dÃ©poser) - c'est lorsque l'utilisateur dÃ©place l'objet sur la surface de l'Ã©cran.  Au cours de cette phase, l' <code>lift preview</code> de cet objet peut Ãªtre modifiÃ© (un signe Â«+Â» plus vert ou un autre signe apparaÃ®t) ... <br><br><img src="https://habrastorage.org/webt/07/yo/4x/07yo4x4yua4zelwculog6eng9aw.png" width="600" height="450"><br><br>  ... une certaine interaction avec le systÃ¨me est Ã©galement autorisÃ©e: vous pouvez cliquer sur un autre objet et l'ajouter Ã  la session "glisser-dÃ©poser" en cours: <br><br><img src="https://habrastorage.org/webt/yb/bx/wi/ybbxwiqe6-226ipfjmkzmpymkva.png" width="600" height="450"><br><br><h2>  Drop </h2><br>  <b>La chute</b> se produit lorsque l'utilisateur soulÃ¨ve un doigt.  Ã€ ce moment, deux choses peuvent se produire: soit l'objet <code>Drag</code> sera dÃ©truit, soit l'objet <code>Drop</code> sera Â«dÃ©posÃ©Â» Ã  la destination. <br><br><img src="https://habrastorage.org/webt/iv/b1/4z/ivb14zogie89jntnkfsxmuubvd0.png" width="600" height="450"><br><br><h2>  Transfert de donnÃ©es </h2><br>  Si le processus de <b>glisser</b> -dÃ©placer n'a pas Ã©tÃ© annulÃ© et que la rÃ©initialisation de Â« <b>Drop</b> Â» a eu lieu, le <b>transfert de</b> donnÃ©es (transfert de donnÃ©es) se produit, auquel cas le Â«point de dÃ©pÃ´tÂ» demande des donnÃ©es Ã  la Â«sourceÂ», et le transfert de donnÃ©es asynchrone se produit. <br><br>  Dans ce didacticiel, nous allons vous montrer comment <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">intÃ©grer</a> facilement <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">le</a> mÃ©canisme <code>Drag &amp; Drop</code> dans votre application <code>iOS</code> Ã  l'aide de l'application de dÃ©monstration Image Gallery, tirÃ©e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">du cours de devoirs CS193P de Stanford</a> . <br>  Nous doterons la <code>Collection View</code> possibilitÃ© de nous remplir d'images EXTÃ‰RIEURES, ainsi que de rÃ©organiser les Ã©lÃ©ments INTÃ‰RIEURS Ã  l'aide du mÃ©canisme <code>Drag &amp; Drop</code> .  En outre, ce mÃ©canisme sera utilisÃ© pour vider les Ã©lÃ©ments inutiles de la <code>Collection View</code> dans une Â«poubelleÂ», qui est une vue <b><font color="#0000FF">UIV</font></b> normale et reprÃ©sentÃ©e par un bouton sur le panneau de navigation.  Nous pouvons Ã©galement partager des images collectÃ©es dans notre galerie avec d'autres applications en utilisant le mÃ©canisme <code>Drag &amp; Drop</code> , par exemple, <code>Notes</code> ou <code>Notes</code> ou <code>Mail</code> ou une photothÃ¨que ( <code>Photo</code> ). <br><br>  Mais avant de me concentrer sur l'implÃ©mentation du mÃ©canisme <code>Drag &amp; Drop</code> dans l'application de dÃ©monstration Â«Image GalleryÂ», je vais passer en revue ses principaux composants trÃ¨s briÃ¨vement. <br><br><h1>  FonctionnalitÃ©s de l'application de dÃ©monstration "Image Gallery" </h1><br>  L'interface utilisateur ( <code>UI</code> ) de l'application Image Gallery est trÃ¨s simple.  Il s'agit d'un Â«extrait d'Ã©cranÂ» du <code>Image Gallery Collection View Controller</code> affichage de la <code>Image Gallery Collection View Controller</code> insÃ©rÃ© dans le <code>Navigation Controller</code> : <br><br><img src="https://habrastorage.org/webt/rz/gl/o6/rzglo69owhktzl8vcstcosf5rdi.png"><br><br>  La partie centrale de l'application est certainement <code>Image Gallery Collection View Controller</code> , qui est prise en charge par la classe <b><font color="#0000FF">ImageGalleryCollectionViewController</font></b> avec le modÃ¨le de galerie d'images en tant que variable <b><font color="#0000FF">var imageGallery = ImageGallery ()</font></b> : <br><br><img src="https://habrastorage.org/webt/na/f2/1r/naf21rpv6pxjnht1bk02mowhgoi.png"><br><br>  Le modÃ¨le est reprÃ©sentÃ© par une <b><font color="#0000FF">structure struct ImageGallery</font></b> contenant un tableau d'images <b><font color="#0000FF">images</font></b> , dans laquelle chaque image est dÃ©crite par une <b><font color="#0000FF">structure struct ImageModel</font></b> contenant l' <code>URL</code> localisation <code>URL</code> image (nous <b><font color="#0000FF">n'allons</font></b> pas stocker l'image elle-mÃªme) et son rapport d'aspect: <br><br><img src="https://habrastorage.org/webt/bp/0b/6_/bp0b6_kh3bgocgc4zlnjrocmk2q.png"><br><br>  Notre <b><font color="#0000FF">ImageGalleryCollectionViewController</font></b> implÃ©mente le protocole <b><font color="#0000FF">DataSource</font></b> : <br><br><img src="https://habrastorage.org/webt/ka/vr/gj/kavrgjqaraoqv4sva-aqhffwvhu.png"><br><br>  La cellule personnalisÃ©e de la collection de cellules contient une image <b><font color="#0000FF">imageView: UIImageView!</font></b>  et indicateur d'activitÃ© de <b><font color="#0000FF">spinner: UIActivityIndicatorView!</font></b>  et est pris en charge par la <code>subclass</code> personnalisÃ©e <b><font color="#0000FF">ImageCollectionViewCell de la</font></b> classe <b><font color="#0000FF">UICollectionViewCell</font></b> : <br><br><img src="https://habrastorage.org/webt/cu/hs/1l/cuhs1ljdvbara4u2_ndq3y_sfxw.png"><br><br>  <code>Public API</code> de la classe <b><font color="#0000FF">ImageCollectionViewCell</font></b> est l' <b><font color="#0000FF">URL de l'</font></b> image <b><font color="#0000FF">imageURL</font></b> .  DÃ¨s que nous l'installons, notre <code>UI</code> mise Ã  jour, c'est-Ã -dire que les donnÃ©es de l'image sont sÃ©lectionnÃ©es de maniÃ¨re asynchrone sur cette <b><font color="#0000FF">imageURL</font></b> et affichÃ©es dans la cellule.  Pendant que les donnÃ©es sont extraites du rÃ©seau, l'indicateur d'activitÃ© de <b><font color="#0000FF">spinner</font></b> fonctionne, indiquant que nous sommes en train de rÃ©cupÃ©rer des donnÃ©es. <br><br>  J'utilise la file d'attente globale <b><font color="#0000FF">(qos: .userInitiated)</font></b> avec l' <b><font color="#0000FF">argument de</font></b> qualitÃ© de service <b><font color="#0000FF">qos</font></b> pour obtenir des donnÃ©es Ã  une <code>URL</code> donnÃ©e, qui est dÃ©finie sur <b><font color="#0000FF">.userInitiated</font></b> , car je sÃ©lectionne les donnÃ©es Ã  la demande de l'utilisateur: <br><br><img src="https://habrastorage.org/webt/0q/aq/2-/0qaq2-uakbn1zou8ilh7pcvysxy.png"><br><br>  Chaque fois que vous utilisez vos propres variables Ã  l'intÃ©rieur d'une fermeture, dans notre cas c'est <b><font color="#0000FF">imageView</font></b> et <b><font color="#0000FF">imageURL</font></b> , le compilateur vous oblige Ã  vous mettre devant elles <b><font color="#0000FF">.</font></b>  de sorte que vous vous demandez: "Y a-t-il un" lien cyclique mÃ©moire "?"  Nous n'avons pas ici de Â« <code>memory cycle</code> Â» explicite, car le <b><font color="#0000FF">soi</font></b> lui-mÃªme n'a pas de pointeur sur cette fermeture. <br><br>  Cependant, dans le cas du multithreading, vous devez garder Ã  l'esprit que les <b><font color="#0000FF">cellules</font></b> de la <code>Collection View</code> sont rÃ©utilisables grÃ¢ce Ã  la mÃ©thode <b><font color="#0000FF">dequeueReusableCell</font></b> .  Chaque fois qu'une cellule (nouvelle ou rÃ©utilisÃ©e) apparaÃ®t Ã  l'Ã©cran, l'image est tÃ©lÃ©chargÃ©e du rÃ©seau de maniÃ¨re asynchrone (Ã  ce moment le Â« <b><font color="#0000FF">spinner</font></b> Â» de l'indicateur d'activitÃ© de <b><font color="#0000FF">spinner</font></b> tourne). <br><br>  DÃ¨s que le tÃ©lÃ©chargement est terminÃ© et que l'image est reÃ§ue, l' <code>UI</code> cette cellule de collecte est mise Ã  jour.  Mais nous n'attendons pas que l'image se charge, nous continuons Ã  faire dÃ©filer la collection et la cellule de collection que nous avons marquÃ©e quitte l'Ã©cran sans mettre Ã  jour notre <code>UI</code> .  Cependant, une nouvelle image devrait apparaÃ®tre ci-dessous et la mÃªme cellule qui a quittÃ© l'Ã©cran sera rÃ©utilisÃ©e, mais pour une autre image, qui peut rapidement charger et mettre Ã  jour l' <code>UI</code> .  Ã€ ce moment, le chargement de l'image prÃ©cÃ©demment dÃ©marrÃ© dans cette cellule reviendra et l'Ã©cran sera mis Ã  jour, ce qui conduira Ã  un rÃ©sultat incorrect.  C'est parce que nous exÃ©cutons diffÃ©rentes choses qui fonctionnent avec le rÃ©seau dans diffÃ©rents threads.  Ils reviennent Ã  des moments diffÃ©rents. <br><br>  Comment pouvons-nous rÃ©gler la situation? <br>  Dans le cadre du mÃ©canisme <b><font color="#0000FF">GCD</font></b> que nous utilisons, nous ne pouvons pas annuler le tÃ©lÃ©chargement de l'image de la cellule qui a quittÃ© l'Ã©cran, mais nous pouvons, lorsque nos donnÃ©es <b><font color="#0000FF">imageData arrivent</font></b> du rÃ©seau, vÃ©rifier l' <code>URL</code> <b><font color="#0000FF">URL</font></b> qui a provoquÃ© le chargement de ces donnÃ©es et la comparer avec celle que l'utilisateur souhaite avoir dans cette cellule pour le moment, c'est-Ã -dire <b><font color="#0000FF">imageURL</font></b> .  S'ils ne correspondent pas, nous ne mettrons pas Ã  jour la cellule d' <code>UI</code> et n'attendrons pas les donnÃ©es d'image dont nous avons besoin: <br><br><img src="https://habrastorage.org/webt/01/xl/-v/01xl-vqsde3rlqyus1f7tksacja.png"><br><br>  Cette ligne de code apparemment absurde <b><font color="#0000FF">url == self.imageURL</font></b> fait tout fonctionner correctement dans un environnement multi-thread qui nÃ©cessite une imagination non standard.  Le fait est que certaines choses dans la programmation multi-thread se produisent dans un ordre diffÃ©rent de celui Ã©crit. <br><br>  S'il n'a pas Ã©tÃ© possible de sÃ©lectionner les donnÃ©es d'image, une image est gÃ©nÃ©rÃ©e avec un message d'erreur sous la forme de la chaÃ®ne Â«ErreurÂ» et un emoji avec Â«froncer les sourcilsÂ».  Juste l'espace vide dans notre <code>Collection View</code> peut dÃ©router un peu l'utilisateur: <br><br><img src="https://habrastorage.org/webt/7m/zh/dt/7mzhdt1eo0tedkkrolp6osiidhu.png"><br><br>  Nous ne voudrions pas que l'image avec le message d'erreur rÃ©pÃ¨te <b><font color="#0000FF">aspectRatio de</font></b> cette image d'erreur, car dans ce cas, le texte avec les emoji sera Ã©tirÃ© ou compressÃ©.  Nous aimerions qu'il soit neutre - carrÃ©, c'est-Ã -dire qu'il aurait un rapport d'aspect proche de 1,0. <br><br><img src="https://habrastorage.org/webt/7b/rj/ve/7brjvesx81juxpsgnkevsnvge_u.png"><br><br>  Nous devons informer notre <code>Controller</code> de ce souhait afin qu'il corrige le rapport d'aspect <b><font color="#0000FF">aspectRatio</font></b> pour l' <b><font color="#0000FF">indexPath</font></b> correspondant dans son modÃ¨le <b><font color="#0000FF">imageGallery</font></b> .  C'est une tÃ¢che intÃ©ressante, il existe de nombreuses faÃ§ons de la rÃ©soudre, et nous choisirons la plus simple d'entre elles - en utilisant la fermeture <b><font color="#0000FF">facultative</font></b> <b><font color="#0000FF">var closAspectRatio: (() -&gt; Void)?</font></b>  .  Il peut Ãªtre Ã©gal Ã  <b><font color="#0000FF">zÃ©ro</font></b> et n'a pas besoin d'Ãªtre installÃ© si cela n'est pas nÃ©cessaire: <br><br><img src="https://habrastorage.org/webt/8v/5q/wy/8v5qwyzl2_-dju1qfotj7i9nem4.png"><br><br>  Lors de l'appel de la fermeture <b><font color="#0000FF">changeAspectRatio? ()</font></b> En cas de rÃ©cupÃ©ration de donnÃ©es erronÃ©es, j'utilise la chaÃ®ne <b><font color="#0000FF">facultative</font></b> .  DÃ©sormais, toute personne intÃ©ressÃ©e par certains types de paramÃ¨tres lors de la rÃ©ception d'une image erronÃ©e peut dÃ©finir cette fermeture sur quelque chose de spÃ©cifique.  Et c'est exactement ce que nous faisons dans notre <code>Controller</code> dans la mÃ©thode <b><font color="#0000FF">cellForItemAt</font></b> : <br><br><img src="https://habrastorage.org/webt/uv/ee/mi/uveemimakh506que35eaasanjbi.png"><br><br>  Les dÃ©tails peuvent Ãªtre trouvÃ©s <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> . <br><br>  Pour afficher les images avec le bon <b><font color="#0000FF">aspectRatio</font></b> , la mÃ©thode <b><font color="#0000FF">sizeForItemAt du</font></b> dÃ©lÃ©guÃ© <b><font color="#0000FF">UICollectionViewDelegateFlowLayout</font></b> est <b><font color="#0000FF">utilisÃ©e</font></b> : <br><br><img src="https://habrastorage.org/webt/ys/v7/nz/ysv7nzh7rus7hnowtqyocbevwai.png"><br><br>  En plus de la <code>Collection View</code> images <code>Collection View</code> , sur notre <code>UI</code> nous avons placÃ© un <code>Bar Button</code> sur le panneau de navigation avec une image <b><font color="#0000FF">GarbageView</font></b> personnalisÃ©e contenant une Â«poubelleÂ» comme sous- <b><font color="#0000FF">vue</font></b> : <br><br><img src="https://habrastorage.org/webt/1h/eo/uu/1heouudwoicj6qyjrckscada9ug.png"><br><br>  Dans cette figure, les couleurs d'arriÃ¨re-plan pour <b><font color="#0000FF">GarbageView</font></b> lui-mÃªme et le bouton <b><font color="#0000FF">UIButton</font></b> avec l'image de la Â«poubelleÂ» (en fait, il y a un arriÃ¨re-plan transparent) sont spÃ©cialement modifiÃ©s pour que vous voyiez que l'utilisateur qui Â«dÃ©chargeÂ» les images de la galerie dans la Â«poubelleÂ» beaucoup plus de marge de manÅ“uvre lors du "drop" <b>Drop</b> que l'icÃ´ne de la poubelle. <br>  La classe <b><font color="#0000FF">GarbageView a</font></b> deux initialiseurs et tous deux utilisent la mÃ©thode <b><font color="#0000FF">setup ()</font></b> : <br><br><img src="https://habrastorage.org/webt/xj/_t/es/xj_tesvqnjlk9yxbxnrvrvc_6w8.png"><br><br>  Dans la mÃ©thode <b><font color="#0000FF">setup ()</font></b> , j'ajoute Ã©galement <b><font color="#0000FF">myButton en</font></b> tant que sous- <b>vue</b> avec l'image de la Â«poubelleÂ» prise Ã  partir du <code>Bar Button</code> standard du <code>Bar Button</code> : <br><br><img src="https://habrastorage.org/webt/if/s5/3c/ifs53cvfeaggqwtrlshju1g5qwc.png"><br><br>  J'ai dÃ©fini un arriÃ¨re-plan transparent pour <b><font color="#0000FF">GarbageView</font></b> : <br><br><img src="https://habrastorage.org/webt/g_/9y/af/g_9yafe1tu_pz4vx6_wan3tarv0.png"><br><br>  La taille de la poubelle et sa position seront dÃ©terminÃ©es dans la mÃ©thode <b><font color="#0000FF">layoutSubviews ()</font></b> de la classe <b><font color="#0000FF">UIView</font></b> , en fonction des <b><font color="#0000FF">limites de l'</font></b> <b><font color="#0000FF">UIView</font></b> donnÃ©e: <br><br><img src="https://habrastorage.org/webt/zf/ll/jb/zflljbnvhfenkfx0o2ge8iy2q2k.png"><br><br>  Il s'agit de la version initiale de l'application de dÃ©monstration "Image Gallery", elle se trouve sur <b><code><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Github</a></code></b> dans le dossier <u><code>ImageGallery_beginning</code></u> .  Si vous exÃ©cutez cette version de l'application Â«Galerie d'imagesÂ», vous verrez le rÃ©sultat de l'application travaillant sur les donnÃ©es de test, que nous supprimerons ensuite et remplirons la Â«Galerie d'imagesÂ» exclusivement Ã€ L'EXTÃ‰RIEUR: <br><br><img src="https://habrastorage.org/webt/w9/jn/y4/w9jny4yxwtmeemq8cqkqhbirvoy.png"><br><br>  Le plan de mise en Å“uvre du mÃ©canisme <code>Drag &amp; Drop</code> dans notre application est le suivant: <br><br><ol><li>  tout d'abord, nous doterons notre <code>Collection View</code> possibilitÃ© de Â«faire glisserÂ» des images <b><font color="#0000FF">UIImage depuis</font></b> et vers l'extÃ©rieur, </li><li>  Ensuite, nous apprendrons Ã  notre collection d'images <code>Collection View</code> Ã  accepter le glisser- <code>Drag</code> Â«externeÂ» ou local de <b><font color="#0000FF">UIImage</font></b> , </li><li>  nous apprendrons Ã©galement Ã  notre <b><font color="#0000FF">GarbageView</font></b> avec le bouton poubelle pour accepter les images <b><font color="#0000FF">UIImage glissÃ©es</font></b> de la <code>Collection View</code> locale et les supprimer de la <code>Collection View</code> </li></ol><br><br>  Si vous allez Ã  la fin de ce didacticiel et effectuez toutes les modifications de code nÃ©cessaires, vous recevrez la version finale de l'application de dÃ©monstration Â«Image GalleryÂ», dans laquelle le mÃ©canisme <code>Drag &amp; Drop</code> a Ã©tÃ© implÃ©mentÃ©.  Il se trouve sur <b><code><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Github</a></code></b> dans le dossier <u><code>ImageGallery_finished</code></u> . <br><br>  Les performances du mÃ©canisme <code>Drag &amp; Drop</code> dans votre <code>Collection View</code> fournies par deux nouveaux dÃ©lÃ©guÃ©s. <br>  Les mÃ©thodes <u>du premier dÃ©lÃ©guÃ©, <b><font color="#0000FF">dragDelegate</font></b> , sont</u> configurÃ©es pour initialiser et personnaliser les drag and drop <code>Drags</code> . <br>  Les mÃ©thodes du deuxiÃ¨me dÃ©lÃ©guÃ©, <b><font color="#0000FF">dropDelegate</font></b> , complÃ¨tent le glisser-dÃ©poser de <code>Drags</code> et, fondamentalement, fournissent le <code>Data transfer</code> donnÃ©es et les paramÃ¨tres d'animation personnalisÃ©s lorsque <code>Drop</code> rÃ©initialisÃ©, ainsi que d'autres choses similaires. <br><br>  Il est important de noter que ces deux protocoles sont complÃ¨tement indÃ©pendants.  Vous pouvez utiliser l'un ou l'autre protocole si vous avez seulement besoin de Â«glisserÂ» <code>Drag</code> ou seulement Â«dÃ©poserÂ» <code>Drop</code> , mais vous pouvez utiliser les deux protocoles Ã  la fois et simultanÃ©ment <code>Drag</code> -dÃ©poser <code>Drag</code> et Â«dÃ©poserÂ» <code>Drop</code> , ce qui ouvre des fonctionnalitÃ©s supplÃ©mentaires MÃ©canisme <code>Drag &amp; Drop</code> pour rÃ©organiser les Ã©lÃ©ments de votre <code>Collection View</code> . <br><br><h1>  Faites glisser et <code>Drag</code> Ã©lÃ©ments de <code>Drag</code> <code>Collection View</code> </h1><br>  L'implÃ©mentation du protocole <code>Drag</code> est trÃ¨s simple, et la premiÃ¨re chose que vous devez toujours faire est de vous dÃ©finir vous- <b><font color="#0000FF">mÃªme</font></b> en tant que dÃ©lÃ©guÃ© <b><font color="#0000FF">dragDelegate</font></b> : <br><br><img src="https://habrastorage.org/webt/mt/jw/dq/mtjwdqjahnvyzwjd0hz9cra47mg.png"><br><br>  Et, bien sÃ»r, tout en haut de la classe <b><font color="#0000FF">ImageGalleryCollectionViewController,</font></b> vous devez dire Â«OuiÂ», nous implÃ©mentons le protocole <b><font color="#0000FF">UICollectionViewDragDelegate</font></b> : <br><br><img src="https://habrastorage.org/webt/ie/ue/xv/ieuexvbtxfan-uouzv4cvxpjw20.png"><br><br>  DÃ¨s que nous faisons cela, le compilateur commence Ã  "se plaindre", nous cliquons sur le cercle rouge et on nous demande: "Voulez-vous ajouter les mÃ©thodes requises du protocole <b><font color="#0000FF">UICollectionViewDragDelegate</font></b> ?" <br>  Je rÃ©ponds: "Bien sÃ»r que je veux!"  et cliquez sur le bouton <code>Fix</code> : <br><br><img src="https://habrastorage.org/webt/6d/24/it/6d24itltj_buh2uwe3fbgkh8my8.png"><br><br>  La seule mÃ©thode requise du protocole <b><font color="#0000FF">UICollectionViewDragDelegate</font></b> est la mÃ©thode <b><font color="#0000FF">itemsForBeginning</font></b> , qui indiquera au systÃ¨me <code>Drag</code> que nous Â« <b><font color="#0000FF">glissons</font></b> - <b><font color="#0000FF">dÃ©posons</font></b> Â».  La mÃ©thode <b><font color="#0000FF">itemsForBeginning est</font></b> appelÃ©e lorsque l'utilisateur commence Ã  "faire glisser" ( <code>Dragging</code> ) une cellule dans la <b><font color="#0000FF">cellule de</font></b> collection. <br><br>  Notez que dans cette mÃ©thode, la <code>Collection View</code> a ajoutÃ© <b><font color="#0000FF">indexPath</font></b> .  Cela nous dira quel Ã©lÃ©ment de la collection, quel <b><font color="#0000FF">indexPath</font></b> , nous allons Â«glisser-dÃ©poserÂ».  C'est vraiment trÃ¨s pratique pour nous, car c'est l'application qui est responsable de l'utilisation des arguments <b><font color="#0000FF">session</font></b> et <b><font color="#0000FF">indexPath</font></b> pour <b><font color="#0000FF">comprendre</font></b> comment gÃ©rer ce glisser-dÃ©poser de <code>Drag</code> . <br><br>  Si le tableau <b><font color="#0000FF">[UIDragItems] des</font></b> Ã©lÃ©ments Â« <b><font color="#0000FF">draggable</font></b> Â» est retournÃ©, le Â«dragÂ» du <code>Drag</code> initialisÃ©, si le tableau vide <b><font color="#0000FF">[] est</font></b> retournÃ©, le Â«dragÂ» du <code>Drag</code> ignorÃ©. <br><br>  Je vais crÃ©er une petite fonction <b><font color="#0000FF">dragItems</font></b> <b><font color="#0000FF">privÃ©e</font></b> <b><font color="#0000FF">(at: indexPath)</font></b> avec l'argument <b><font color="#0000FF">indexPath</font></b> .  Il renvoie le tableau <b><font color="#0000FF">[UIDragItem] dont</font></b> nous avons <b><font color="#0000FF">besoin</font></b> . <br><br><img src="https://habrastorage.org/webt/_y/iv/86/_yiv869sqaamn_ytg22fg89iez0.png"><br><br>  Ã€ quoi ressemble un <b><font color="#0000FF">UIDragItem</font></b> par glisser-dÃ©poser? <br>  Il n'a qu'une chose trÃ¨s IMPORTANTE appelÃ©e <b><font color="#0000FF">itemProvider</font></b> .  <b><font color="#0000FF">itemProvider</font></b> est juste quelque chose qui peut fournir des donnÃ©es qui seront glissÃ©es. <br><br>  Et vous avez le droit de demander: "Qu'en est-il du" glisser-dÃ©poser "d'un Ã©lÃ©ment <b><font color="#0000FF">UIDragItem</font></b> qui n'a tout simplement pas de donnÃ©es?"  L'Ã©lÃ©ment que vous souhaitez faire glisser peut ne pas contenir de donnÃ©es, par exemple, car la crÃ©ation de ces donnÃ©es est une opÃ©ration coÃ»teuse.  Il peut s'agir d'une image ou de quelque chose qui nÃ©cessite le tÃ©lÃ©chargement de donnÃ©es depuis Internet.  La grande chose est que l'opÃ©ration <code>Drag &amp; Drop</code> est complÃ¨tement asynchrone.  Lorsque vous commencez Ã  faire glisser et <code>Drag</code> , c'est vraiment un objet trÃ¨s lÃ©ger ( <code>lift preview</code> ), vous le faites glisser partout et rien ne se passe pendant ce "glisser".  Mais dÃ¨s que vous Â«dÃ©posezÂ» <code>Drop</code> quelque part votre objet, puis, en tant que <b><font color="#0000FF">fournisseur</font></b> d' <b><font color="#0000FF">articles</font></b> , il doit vraiment fournir Ã  votre objet Â«traÃ®nÃ©Â» et Â«lancÃ©Â» des donnÃ©es rÃ©elles, mÃªme si cela prend un certain temps. <br><br>  Heureusement, il existe de nombreux <b><font color="#0000FF">fournisseurs d'Ã©lÃ©ments intÃ©grÃ©s</font></b> .  Ce sont des classes qui existent dÃ©jÃ  dans <code>iOS</code> et qui sont des <b><font color="#0000FF">itemPoviders</font></b> , comme, par exemple, <code>NSString</code> , qui vous permet de faire glisser et dÃ©poser du texte sans polices.  Bien sÃ»r, il s'agit d'une image <b><font color="#0000FF">UIImage</font></b> .  Vous pouvez sÃ©lectionner et faire glisser et dÃ©poser des images <b><font color="#0000FF">UIImages tout au long</font></b> .  La classe <b><font color="#0000FF">NSURL</font></b> , ce qui est absolument merveilleux.  Vous pouvez accÃ©der Ã  la page <code>Web</code> , sÃ©lectionner l' <code>URL</code> et la Â«dÃ©poserÂ» oÃ¹ vous le souhaitez.  Cela peut Ãªtre un lien vers un article ou une <code>URL</code> pour une image, comme ce sera le cas dans notre dÃ©mo.  Ce sont les classes de couleurs de <b><font color="#0000FF">UIColor</font></b> , l' <b><font color="#0000FF">Ã©lÃ©ment de</font></b> carte <b><font color="#0000FF">MKMapItem, le</font></b> contact <b><font color="#0000FF">CNContact</font></b> depuis le carnet d'adresses, vous pouvez sÃ©lectionner et faire glisser beaucoup de choses.  Tous sont des <b><font color="#0000FF">fournisseurs d'articles</font></b> . <br><br>  Nous allons Â«glisser-dÃ©poserÂ» l'image <b><font color="#0000FF">UIImage</font></b> .  Il est situÃ© dans la cellule de la cellule <code>Collection View</code> avec <b><font color="#0000FF">indexPath</font></b> , ce qui m'aide Ã  sÃ©lectionner la cellule de <b><font color="#0000FF">cellule</font></b> , Ã  en extraire l'image <code>Outlet</code> et Ã  obtenir son <b><font color="#0000FF">image</font></b> . <br><br>  Exprimons cette idÃ©e avec quelques lignes de code. <br>  Tout d'abord, je demande ma <code>Collection View</code> sur une <b><font color="#0000FF">cellule</font></b> pour l'Ã©lÃ©ment <b><font color="#0000FF">item</font></b> correspondant Ã  cet <b><font color="#0000FF">indexPath</font></b> . <br><br><img src="https://habrastorage.org/webt/ho/zi/gp/hozigp41-y0-3cfa525umwojyu4.png"><br><br>  La <b><font color="#0000FF">mÃ©thode cellForItem (at: IndexPath)</font></b> pour la <code>Collection View</code> ne fonctionne que pour les cellules visibles, mais, bien sÃ»r, cela fonctionnera dans notre cas, car je Â«fais glisser-dÃ©poserÂ» l'Ã©lÃ©ment de collection <code>Drag</code> Ã  l'Ã©cran et il est visible. <br><br>  Donc, j'ai obtenu une cellule de <b><font color="#0000FF">cellule</font></b> "dÃ©plaÃ§able". <br>  Ensuite, j'utilise l'opÃ©rateur <b><font color="#0000FF">as?</font></b>  Ã  cette cellule afin qu'elle ait un TYPE de ma <code>subclass</code> personnalisÃ©e.  Et si cela fonctionne, je reÃ§ois une image <code>Outlet</code> , Ã  partir de laquelle je prends son <b><font color="#0000FF">image</font></b> .  Je viens de Â«capturerÂ» l'image de l' <b><font color="#0000FF">image</font></b> pour cet <b><font color="#0000FF">indexPath</font></b> . <br><br>  Maintenant que j'ai une image, je n'ai plus qu'Ã  crÃ©er l'un de ces <b><font color="#0000FF">UIDragItems en</font></b> utilisant l'image rÃ©sultante comme <b><font color="#0000FF">itemProvider</font></b> , c'est-Ã -dire la chose qui nous fournit les donnÃ©es. <br>  Je peux crÃ©er <b><font color="#0000FF">dragItem en</font></b> utilisant le constructeur <b><font color="#0000FF">UIDragItem</font></b> , qui prend <b><font color="#0000FF">itemProvider</font></b> comme argument: <br><br><img src="https://habrastorage.org/webt/to/zb/gt/tozbgtxocfrgoaqofvn9jgf9yeo.png"><br><br>  Ensuite, nous crÃ©ons un <b><font color="#0000FF">itemProvider</font></b> pour l'image <b><font color="#0000FF">image en</font></b> utilisant Ã©galement le constructeur <b><font color="#0000FF">NSItemProvider</font></b> .  Il existe plusieurs constructeurs pour <b><font color="#0000FF">NSItemProvider</font></b> , mais parmi eux il y en a un vraiment merveilleux - <b><font color="#0000FF">NSItemProvider (objet: NSItemProviderWriting)</font></b> : <br><br><img src="https://habrastorage.org/webt/ey/21/cq/ey21cq0iq5riml7pfrye4gcnmi8.png"><br><br>  Vous donnez simplement l'objet <b><font color="#0000FF">objet Ã </font></b> ce constructeur <b><font color="#0000FF">NSItemProvider</font></b> , et il sait comment en faire <b><font color="#0000FF">itemProvider</font></b> .  En tant que tel <b><font color="#0000FF">objet,</font></b> je donne Ã  l'image l'image que j'ai reÃ§ue de la <b><font color="#0000FF">cellule</font></b> et j'obtiens <b><font color="#0000FF">itemProvider</font></b> pour <b><font color="#0000FF">UIImage</font></b> . <br>  Et c'est tout.  Nous avons crÃ©Ã© <b><font color="#0000FF">dragItem</font></b> et devons le renvoyer comme un tableau ayant un Ã©lÃ©ment. <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mais avant mon retour </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dragItem</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , je vais faire une chose, Ã  </font><font style="vertical-align: inherit;">savoir, pour dÃ©finir la variable </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">localObject</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pour </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dragItem</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , Ã©gale Ã  l'image rÃ©sultante l' </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">image</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><img src="https://habrastorage.org/webt/sh/h0/cz/shh0czt4sxjd7ienvsl2slz8yju.png"><br><br>  Qu'est-ce que cela signifie? <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si vous effectuez un Â«glisser-dÃ©poserÂ» </font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">localement, c'est-Ã -dire Ã  l'intÃ©rieur de votre application, vous n'avez pas besoin de parcourir tout ce code associÃ© Ã  </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">itemProvider</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , par une rÃ©cupÃ©ration de donnÃ©es asynchrone. Vous n'avez pas besoin de le faire, il vous suffit de prendre </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">localObject</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et de l'utiliser. Il s'agit d'une sorte de Â«court-circuitÂ» avec Â«glisser-dÃ©poserÂ» local </font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le code que nous avons Ã©crit fonctionnera lors du Â«glissementÂ» </font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hors de notre collection </font></font><code>Collection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vers d'autres applications, mais si nous Â« </font><b><font color="#0000FF"><font style="vertical-align: inherit;">glissons</font></font></b><font style="vertical-align: inherit;"> Â» </font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">localement, nous pouvons utiliser </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">localObject</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Ensuite, je retourne un tableau d'un Ã©lÃ©ment </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dragItem</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Soit dit en </font><font style="vertical-align: inherit;">passant, si je ne pouvais pas obtenir pour une raison quelconque l' </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">image</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pour cette cellule </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cellule</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , je retourne un </font><font style="vertical-align: inherit;">tableau vide </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[]</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , cela signifie que le Â« glisser Â» </font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">est annulÃ©e. </font></font><br><br><img src="https://habrastorage.org/webt/4b/uk/o3/4buko3fve2swk7wr7d_oy5sflma.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En plus de l' </font><font style="vertical-align: inherit;">objet local </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">localObject</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , vous pouvez vous rappeler le contexte local </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">localContext</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pour notre </font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">session de </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">la session</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Dans notre cas , </font><font style="vertical-align: inherit;">ce sera une collection de </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CollectionView</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et il est utile de nous aprÃ¨s: </font></font><br><br><img src="https://habrastorage.org/webt/o_/gi/tk/o_gitkbwnnbcevnxwcwm6obckwk.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Avoir Â« glisser-dÃ©poser Â» </font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, vous pouvez ajouter plus d' </font><font style="vertical-align: inherit;">articles </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">articles</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ã  ce Â« glisser-dÃ©poser Â», juste faire le geste </font></font><b><font color="#FF00FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tap</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sur eux. En consÃ©quence, vous pouvez faire glisser</font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">de nombreux Ã©lÃ©ments Ã  la fois. Et cela est facile Ã  implÃ©menter avec une autre </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mÃ©thode</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dÃ©lÃ©guÃ©e </font><font style="vertical-align: inherit;">, </font><b><font color="#0000FF"><font style="vertical-align: inherit;">UICollectionViewDragDelegate</font></font></b><font style="vertical-align: inherit;"> , trÃ¨s similaire Ã  la mÃ©thode </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">itemsForeginning</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , une mÃ©thode nommÃ©e </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">itemsForAddingTo</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . La mÃ©thode </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">itemsForAddingTo</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ressemble exactement Ã  la mÃ©thode </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">itemsForeginning</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et renvoie exactement la mÃªme chose, car elle nous donne Ã©galement un </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">indexPath de</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ce que l'utilisateur a Â«enregistrÃ©Â» pendant le processus de Â«glisser </font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font><font style="vertical-align: inherit;">dÃ©poserÂ» </font><font style="vertical-align: inherit;">, et j'ai juste besoin de rÃ©cupÃ©rer l' </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">image</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de la cellule sur que l'utilisateur a Â«enregistrÃ©Â» et le retourner. </font></font><br><br><img src="https://habrastorage.org/webt/u-/hc/9d/u-hc9dnk3001qhkra-et6oycphi.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Renvoie un tableau vide </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[] Ã </font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> partir de la mÃ©thode </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">itemsForAddingTo</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">conduit au fait que le geste de </font></font><b><font color="#FF00FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tapotement</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sera interprÃ©tÃ© de la maniÃ¨re habituelle, c'est-Ã -dire comme le choix de cette cellule </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cellulaire</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Et c'est tout ce dont nous avons besoin pour glisser-dÃ©poser </font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous lanÃ§ons l'application. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Je sÃ©lectionne l'image "Venise", la maintiens pendant un moment et commence Ã  bouger ... </font></font><br><br><img src="https://habrastorage.org/webt/p7/ne/9z/p7ne9zdwnirsf2uxjogvflrqwao.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">... et nous pouvons vraiment faire glisser cette image dans l'application </font></font><code>Photos</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, comme vous voyez le signe plus vert "+" dans le coin supÃ©rieur gauche de l'image "glissable". Je peux effectuer un geste de </font></font><b><font color="#FF00FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">toucher</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sur une autre image Artika de la collection </font></font><code>Collection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">... </font></font><br><br><img src="https://habrastorage.org/webt/cg/sj/om/cgsjomxtwxyzqxg-wxvqxz4huqi.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">... et maintenant nous pouvons dÃ©poser deux images dans l'application </font></font><code>Photos</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br><br><img src="https://habrastorage.org/webt/bk/xk/ud/bkxkud6ggdorw2d1yayjmatnsf4.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Puisque le </font></font><code>Photos</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mÃ©canisme est dÃ©jÃ  intÃ©grÃ© </font><font style="vertical-align: inherit;">dans l'application</font></font><code>Drag &amp; Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">alors tout fonctionne trÃ¨s bien et c'est cool. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Donc, le "glisser </font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-dÃ©poser </font><font style="vertical-align: inherit;">" </font><font style="vertical-align: inherit;">et le "dumping" de l' </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">image </font><font style="vertical-align: inherit;">de la </font><font style="vertical-align: inherit;">Galerie dans d'autres applications </font><font style="vertical-align: inherit;">fonctionnent pour moi </font><font style="vertical-align: inherit;">, je n'ai pas eu Ã  faire grand-chose dans mon application, sauf pour livrer l' </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">image</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sous forme de tableau </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[UIDragItem]</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">C'est l'une des nombreuses fonctionnalitÃ©s intÃ©ressantes du mÃ©canisme </font></font><code>Drag &amp; Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- il est trÃ¨s facile de le faire fonctionner dans les deux sens.</font></font><br><br><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RÃ©initialiser les </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">images Ã  la collection</font></font><code>Collection View</code> </h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Maintenant, nous devons crÃ©er une </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">partie pour ma collection </font></font><code>Collection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">afin que nous puissions Â«viderÂ» </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">toutes les images Â«glissÃ©esÂ» Ã€ L'INTÃ‰RIEUR de cette collection. Une image Â«dÃ©plaÃ§ableÂ» peut Â«provenirÂ» DE L'EXTÃ‰RIEUR ou directement Ã€ L'INTÃ‰RIEUR de cette collection. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pour ce faire, nous faisons la mÃªme chose fait de dÃ©lÃ©guer </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dragDelegate</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , Ã  </font><font style="vertical-align: inherit;">savoir nous faire, </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l'auto</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , dÃ©lÃ©guÃ© </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dropDelegate</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dans la mÃ©thode de </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l'viewDidLoad</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br><br><img src="https://habrastorage.org/webt/5q/wv/mf/5qwvmfjuyh74sfxzwcw7_0gikec.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Encore une </font><font style="vertical-align: inherit;">fois, il faut monter au sommet de notre classe </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ImageGalleryCollectionViewController</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et de </font><font style="vertical-align: inherit;">vÃ©rifier l' </font><font style="vertical-align: inherit;">application du </font><font style="vertical-align: inherit;">Protocole </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UICollectionViewDropDelegate</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br><br><img src="https://habrastorage.org/webt/wc/ww/7p/wcww7pgfia3xxwe63teews1e9de.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DÃ¨s que nous avons ajoutÃ© notre nouveau protocole, le compilateur a de nouveau commencÃ© Ã  Â«se plaindreÂ» que nous n'avions pas implÃ©mentÃ© ce protocole. Nous cliquons sur le bouton </font></font><code>Fix</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et les mÃ©thodes requises de ce protocole apparaissent devant nous. Dans ce cas, nous sommes informÃ©s que nous devons implÃ©menter la mÃ©thode </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">performDrop</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br><br><img src="https://habrastorage.org/webt/ll/9t/k4/ll9tk4goht7nfa-gnifnq8iaoto.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous devons le faire, sinon une Â«rÃ©initialisationÂ» ne se produira pas </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. En fait, je vais implÃ©menter la mÃ©thode </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">performDrop en</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dernier, car il existe quelques autres </font></font><code>Apple</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mÃ©thodes </font><font style="vertical-align: inherit;">hautement recommandÃ©es </font><font style="vertical-align: inherit;">que vous devez implÃ©menter pour la </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">piÃ¨ce. C'est </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">canHandle</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dropSessionDidUpdate</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br><br><img src="https://habrastorage.org/webt/jd/ce/ve/jdcevehobhr1k7wwvc1iaem-w80.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si nous mettons en </font><font style="vertical-align: inherit;">Å“uvre ces deux mÃ©thodes, nous pouvons obtenir un peu de </font><font style="vertical-align: inherit;">billets verts signe plus Â« + Â» quand nous traÃ®nons et des </font><font style="vertical-align: inherit;">images de chute de l'extÃ©rieur de notre collection </font></font><code>ollection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, et en plus, nous ne tenterons pas de vider ce que nous ne comprenons pas. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ImplÃ©mentons </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">canHandle</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Nous devons vous pouvez </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">utiliser la version de la</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mÃ©thode </font><b><font color="#0000FF"><font style="vertical-align: inherit;">canHandle</font></font></b><font style="vertical-align: inherit;"> , qui est destinÃ©e Ã  la collecte </font></font><code>ollection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, mais cette mÃ©thode </font></font><code>ollection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ressemble exactement Ã  la mÃ©thode similaire pour </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UIView</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> normal </font><font style="vertical-align: inherit;">, il n'y a pas d' </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">indexPath lÃ </font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font><b><font color="#0000FF"><font style="vertical-align: inherit;">bas</font></font></b><font style="vertical-align: inherit;"> , nous avons juste besoin de retourner </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">session.canLoadObjects (ofClass: UIImage.self)</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , et cela signifie que j'accepte le "reset" des objets de ce cl PAS dans ma collection </font></font><code>ollection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br><br><img src="https://habrastorage.org/webt/0j/tz/ze/0jtzzen649jj7z58-3tiq_ehrvs.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mais cela ne suffit pas pour "vider" l' </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">image dans ma collection </font></font><code>Collection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EXTÃ‰RIEUR. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si le Â« reset Â» </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l'image se dÃ©roule dans la collection </font></font><code>Collection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, l'utilisateur rÃ©organise ses propres Ã©lÃ©ments d' </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ã©lÃ©ments</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ã  travers le mÃ©canisme </font></font><code>Drag &amp; Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, alors qu'une seule image </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">une UIImage</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et la </font><font style="vertical-align: inherit;">mise en </font><font style="vertical-align: inherit;">Å“uvre de la mÃ©thode </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">canHandle</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ressemblera Ã  </font><font style="vertical-align: inherit;">de la maniÃ¨re ci - </font><font style="vertical-align: inherit;">dessus. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mais si le Â«dumpingÂ» de l' </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">image se produit Ã€ L'EXTÃ‰RIEUR, alors nous ne devrions gÃ©rer que le Â«glisser-dÃ©poserÂ» </font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">qui est l'image </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UIImage</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> avec </font></font><code>URL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cette image, car nous </font><b><font color="#0000FF"><font style="vertical-align: inherit;">n'allons</font></font></b><font style="vertical-align: inherit;"> pas stocker </font><b><font color="#0000FF"><font style="vertical-align: inherit;">directement les</font></font></b><font style="vertical-align: inherit;"> images </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UIImage</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dans le modÃ¨le. Dans ce cas, je </font><font style="vertical-align: inherit;">ne </font><font style="vertical-align: inherit;">retournerai </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">true</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dans la mÃ©thode </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">canHandle que</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> si deux conditions sont remplies en mÃªme temps </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: session.canLoadObjects (ofClass: NSURL.self) &amp;&amp; session.canLoadObjects (ofClass: UIImage.self)</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br><br><img src="https://habrastorage.org/webt/yj/dt/qn/yjdtqnmmxq0olgilbz1ifa5mdt8.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">je dois dÃ©terminer si j'ai affaire Ã  une Â«rÃ©initialisationÂ» Ã€ L'EXTÃ‰RIEUR OU Ã€ L'INTÃ‰RIEUR. Je vais le faire en utilisant la constante calculÃ©e </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">isSelf</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , pour le calcul de laquelle je peux utiliser une telle chose dans une </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">session de </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">session</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> comme sa </font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">session </font><font style="vertical-align: inherit;">locale </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">localDragSession</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Cette </font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">session </font><font style="vertical-align: inherit;">locale </font><font style="vertical-align: inherit;">Ã  son tour a un contexte local </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">localContext</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si vous vous souvenez, nous dÃ©finissons ce contexte local dans la mÃ©thode</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">itemsForBeginning</font></font></font></b> <code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dÃ©lÃ©guÃ©</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> UICollectionViewDragDelegate</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font><b><font color="#0000FF"><font style="vertical-align: inherit;"> J'examinerai</font></font></b></font><br><br><img src="https://habrastorage.org/webt/o_/gi/tk/o_gitkbwnnbcevnxwcwm6obckwk.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> le contexte local</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> localContext</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pour l'Ã©galitÃ© de ma collection</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> collectionView</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Vrai, TYPE de</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> localContext</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sera</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Any</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , et je dois faire un transtypage de TYPE</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Any en</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> utilisant l'opÃ©rateur</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> as? UICollectionView</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br><br><img src="https://habrastorage.org/webt/kc/zk/nt/kczknt6xiau08k5d06xu40akoyu.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">si le contexte local</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (session.localDragSession? .LocalContext as? UICollectionView)</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est Ã©gal Ã  ma collection</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> collectionView</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , alors la variable calculÃ©e</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> isSelf</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> vraie</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et il y a une Â«rÃ©initialisationÂ» locale Ã€ L'INTÃ‰RIEUR de ma collection. Si cette Ã©galitÃ© est violÃ©e, alors nous avons affaire Ã  une "rÃ©initialisation" </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ã€ L'EXTÃ‰RIEUR. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La mÃ©thode </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">canHandle</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> indique que nous ne pouvons gÃ©rer que ce type de Â«glisser-dÃ©poserÂ» </font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sur notre collection </font></font><code>Collection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Sinon, plus loin, cela n'a aucun sens de parler de "dumping" </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si nous continuons Ã  Â« reset Â» </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, il est encore jusqu'au moment oÃ¹ l'utilisateur soulÃ¨vera vos doigts sur l'Ã©cran et il y aura un vÃ©ritable Â« remise Ã  </font><font style="vertical-align: inherit;">zÃ©ro Â» </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, nous devons signaler en </font></font><code>iOS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">utilisant la mÃ©thode </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dropSessionDidUpdate</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dÃ©lÃ©guÃ© </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UICollectionViewDropDelegate</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sur notre offre </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UIDropProposal</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pour mettre en </font><font style="vertical-align: inherit;">Å“uvre la </font><font style="vertical-align: inherit;">rÃ©initialisation </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dans cette mÃ©thode, nous devons renvoyer une </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">phrase qui peut avoir des </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">valeurs .copy</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ou </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.move</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ou </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.cancel</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ou </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.forbidden</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pour l'argument </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">opÃ©ration</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Et ce sont toutes les possibilitÃ©s que nous avons dans le cas ordinaire lorsqu'il s'agit d'une </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UIView</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> rÃ©guliÃ¨re </font><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mais la collection </font></font><code>Collection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">va plus loin et propose de renvoyer l'offre spÃ©cialisÃ©e </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UICollectionViewDropProposal</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , qui est une </font></font><code>subclass</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">classe de </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UIDropProposal</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et vous permet de </font><font style="vertical-align: inherit;">spÃ©cifier, </font><font style="vertical-align: inherit;">en plus de l' </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">opÃ©ration,</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> un paramÃ¨tre d' </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">intention</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> supplÃ©mentaire </font><font style="vertical-align: inherit;">pour la collection </font></font><code>Collection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ParamÃ¨tre</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l'intention</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> indique Ã  la collection</font></font><code>Collection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">si nous voulons que l'Ã©lÃ©ment Â«jetÃ©Â» soit placÃ© Ã  l'intÃ©rieur d'une</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> cellule</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> existante</font><b><font color="#0000FF"><font style="vertical-align: inherit;"> ,</font></font></b><font style="vertical-align: inherit;"> ou si nous voulons ajouter une nouvelle</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> cellule. Vous</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> voyez la diffÃ©rence? Dans le cas de la collecte,</font></font><code>Collection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nous devons communiquer notre</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> intention</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dans notre cas, nous voulons toujours ajouter une nouvelle cellule, vous verrez donc Ã  quoi notre paramÃ¨tre d'</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> intention</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sera Ã©gal</font><font style="vertical-align: inherit;">.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous sÃ©lectionnons le deuxiÃ¨me constructeur pour</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> UICollectionViewDropProposal</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br><br><img src="https://habrastorage.org/webt/ab/vh/-p/abvh-pb04qje37u4jjgveja3lgu.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dans notre cas, nous voulons toujours ajouter une nouvelle cellule et le paramÃ¨tre d'</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> intention</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> prendra la valeur</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .insertAtDestinationIndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> par opposition</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.insertIntoDestinationIndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><img src="https://habrastorage.org/webt/yg/t0/xi/ygt0xirvwaucl9zvuvuxvvil2cu.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">J'ai de nouveau utilisÃ© la constante calculÃ©e</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> isSelf</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , et s'il s'agit d'une</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> auto-</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> rÃ©organisation, alors je dÃ©place</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .move</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , sinon je copie</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .copy</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Dans les deux cas, nous utilisons</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .insertAtDestinationIndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , c'est-Ã -dire l'insertion de nouvelles</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> cellules</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jusqu'Ã  prÃ©sent, je n'ai pas implÃ©mentÃ© la mÃ©thode</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> performDrop</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , mais regardons ce qu'une collection peut dÃ©jÃ  faire</font></font><code>Collection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">avec cette petite information que nous lui avons fournie.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Je fais glisser l'image depuis</font></font><code>Safari</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">le moteur de recherche</font></font><code>Google</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, et un signe Â«+Â» vert apparaÃ®t au-dessus de cette image, indiquant que notre galerie d'images est non seulement prÃªte Ã  accepter et copier cette image avec elle </font></font><code>URL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, mais aussi Ã  fournir une place Ã  l'intÃ©rieur de la collection </font></font><code>Collection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br><br><img src="https://habrastorage.org/webt/ia/gy/gv/iagygvechjnwsm-tfvduwi0pc1o.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">je peux cliquer sur une autre paire d'images dans </font></font><code>Safari</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, et Il y aura dÃ©jÃ  3 images "glissÃ©es": </font></font><br><br><img src="https://habrastorage.org/webt/kd/ca/7s/kdca7sflzfrbbsbtmnk8_zbueqm.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mais si je lÃ¨ve le doigt et "dÃ©pose" </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ces images, elles ne seront pas placÃ©es dans notre Galerie, mais reviendront simplement Ã  leurs emplacements prÃ©cÃ©dents, car nous n'avons pas encore implÃ©mentÃ© la mÃ©thode </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">performDrop</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><img src="https://habrastorage.org/webt/5v/e4/me/5ve4me_unk6t-azl6fhatljzgxs.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vous pouvez voir que la collection </font></font><code>Collection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sait dÃ©jÃ  ce que je veux faire. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La collection </font></font><code>Collection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">est une chose absolument merveilleuse pour le mÃ©canisme.</font></font><code>Drag &amp; Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, elle a des fonctionnalitÃ©s trÃ¨s puissantes pour cela. Nous l'avons Ã  peine touchÃ©e en Ã©crivant 4 lignes de code, et elle a dÃ©jÃ  beaucoup avancÃ© dans la perception du "reset" </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Revenons au code et implÃ©mentons la mÃ©thode </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">performDrop</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><img src="https://habrastorage.org/webt/i0/cc/es/i0ccescpyvub0pclhjyzcbdcu7o.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dans cette mÃ©thode, nous ne pourrons pas nous dÃ©brouiller avec 4 lignes de code, car la mÃ©thode </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">performDrop est un</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> peu plus compliquÃ©e, mais pas trop. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lorsque la Â«rÃ©initialisationÂ» se produit </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, alors dans la mÃ©thode </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">performDrop</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font><font style="vertical-align: inherit;">nous devons mettre Ã  jour notre modÃ¨le, qui est la </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">galerie d'</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> images </font><b><font color="#0000FF"><font style="vertical-align: inherit;">imageGallery</font></font></b><font style="vertical-align: inherit;"> avec une liste d'images </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">images</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , et nous devons mettre Ã  jour notre collection visuelle </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">collectionView</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous avons deux scÃ©narios de Â«rÃ©initialisationÂ» diffÃ©rents </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S'il y a une Â«rÃ©initialisationÂ» </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">de ma collection </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">collectionView</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , alors je dois Â«rÃ©initialiserÂ» l' </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ã©lÃ©ment de collection dans un nouvel emplacement et le supprimer de l'ancien emplacement, car dans ce cas, je dÃ©place ( </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.move</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) cet Ã©lÃ©ment de collection. C'est une tÃ¢che insignifiante. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il y a une Â«rÃ©initialisationÂ» </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d'une autre application, alors nous devons utiliser la propriÃ©tÃ© </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">itemProvider</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de l' </font><font style="vertical-align: inherit;">Ã©lÃ©ment </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">item</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Â«glissÃ©Â» </font><font style="vertical-align: inherit;">pour sÃ©lectionner les donnÃ©es. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lorsque nous effectuons une Â«rÃ©initialisationÂ» </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dans la collection </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">collectionView</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , la collection nous fournit un coordinateur </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">coordinateur</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Tout d'abord, nous avons signalÃ© le coordonnateur </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">coordonnateur</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , il </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">destinationIndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , Ã  </font><font style="vertical-align: inherit;">savoir </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">indexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Â« -destination Â», Â« remise Ã  </font><font style="vertical-align: inherit;">zÃ©ro Â» </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, qui est oÃ¹ nous serons Â« remise Ã  </font><font style="vertical-align: inherit;">zÃ©ro Â». </font></font><br><br><img src="https://habrastorage.org/webt/mp/mt/wk/mpmtwkebx7beyw5ge72gt19xt7k.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mais </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">destinationIndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> peut Ãªtre </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nul</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , car vous pouvez faire glisser l'image Â«supprimÃ©eÂ» vers la partie de la collection </font></font><code>Collection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">qui n'est pas la place entre certaines </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cellules</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> existantes </font><font style="vertical-align: inherit;">, elle pourrait donc Ãªtre </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nulle</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Si cette situation se produit, je crÃ©e un </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> avec l'Ã©lÃ©ment </font><b><font color="#0000FF"><font style="vertical-align: inherit;">0th </font></font></b></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">item</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dans la section 0th </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">section</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><img src="https://habrastorage.org/webt/qd/ei/me/qdeimejhoj1v0pkgml2xtog1jke.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Je pourrais choisir n'importe quel autre </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">indexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , mais </font><font style="vertical-align: inherit;">j'utiliserai </font><font style="vertical-align: inherit;">cet </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">indexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> par dÃ©faut. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous savons maintenant oÃ¹ nous allons effectuer la Â«rÃ©initialisationÂ» </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Nous devons parcourir tous les Ã©lÃ©ments de </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">coordinateur</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Â«rÃ©initialisablesÂ» </font><font style="vertical-align: inherit;">fournis par le </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">coordinateur</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Chaque </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ã©lÃ©ment</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de cette liste a un TYPE </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UICollectionViewDropItem</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et peut nous fournir des informations trÃ¨s intÃ©ressantes. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Par exemple, si je peux obtenir </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sourceIndexPath Ã </font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> partir de </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">item.sourceIndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , alors je saurai avec certitude que ce Â«glisser-dÃ©poserÂ» </font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">est effectuÃ© Ã  partir de lui-mÃªme, </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">self</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, et la source du glissement </font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">est l'Ã©lÃ©ment de collection avec </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">indexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ã©gal Ã  </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sourceIndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br><br><img src="https://habrastorage.org/webt/y2/3d/2u/y23d2u0pmf1pnasfw2khu9htji4.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">je n'ai mÃªme pas besoin de regarder </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">localContext</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dans ce cas pour savoir que ce "glisser-dÃ©poser" a Ã©tÃ© effectuÃ© Ã  L'INTÃ‰RIEUR de la collection </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">collectionView</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font> Ouah! <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Maintenant, je connais le </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sourceIndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> source </font><font style="vertical-align: inherit;">et le destinationIndexPath Â« </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">destination</font></font></font></b> <font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Â» </font></font><code>Drag &amp; Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, et la tÃ¢che devient triviale. Tout ce que je dois faire est de mettre Ã  jour le modÃ¨le afin que la source et la Â«destinationÂ» soient Ã©changÃ©es, puis de mettre Ã  jour la collection </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">collectionView</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , dans laquelle vous devrez supprimer l'Ã©lÃ©ment de collection avec </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sourceIndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et l'ajouter Ã  la collection avec </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">destinationIndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Notre cas local est le plus simple, car dans ce cas, le mÃ©canisme </font></font><code>Drag &amp; Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fonctionne non seulement dans la mÃªme application, mais dans la mÃªme collection </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">collectionView</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , et je peux obtenir toutes les informations nÃ©cessaires en utilisant le coordinateur </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">coordinateur</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. ImplÃ©mentons-le dans ce cas local le plus simple: </font></font><br><br><img src="https://habrastorage.org/webt/1m/uu/4r/1muu4rnsxmehwuyybyspei14bvo.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dans notre cas, je n'ai mÃªme pas besoin de </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">localObject</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que j'ai Â«cachÃ©Â» plus tÃ´t lorsque j'ai crÃ©Ã© </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dragItem</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et que je peux maintenant emprunter Ã  l' </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ã©lÃ©ment</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Â« </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dragged</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Â» </font><font style="vertical-align: inherit;">dans la </font><font style="vertical-align: inherit;">collection d' </font><b><font color="#0000FF"><font style="vertical-align: inherit;">Ã©lÃ©ments</font></font></b><font style="vertical-align: inherit;"> sous la forme </font><b><font color="#0000FF"><font style="vertical-align: inherit;">item.localObject</font></font></b><font style="vertical-align: inherit;"> . Nous en aurons besoin lors du Â«dumpingÂ» d' </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">images dans la Â«poubelleÂ», qui se trouve dans la mÃªme application, mais qui n'est pas la mÃªme collection </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">collectionView</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Deux </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IndexPathes</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> me suffisent </font><b><font color="#0000FF"><font style="vertical-align: inherit;">maintenant</font></font></b><font style="vertical-align: inherit;"> : le source </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sourceIndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et le Â«destinationÂ» </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">destinationIndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Je reÃ§ois d'abord des informations</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imageInfo</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sur l'image Ã  l'ancien emplacement du modÃ¨le, en la supprimant de lÃ . Et puis insÃ©rez dans un tableau d'</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> images</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de mes modÃ¨les</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> imageGallery</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> informations</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ImageInfo</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> une image avec un nouvel indice</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> destinationIndexPath.item</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Voici comment j'ai mis Ã  jour mon modÃ¨le:</font></font><br><br><img src="https://habrastorage.org/webt/pk/bk/ny/pkbknyitrog4kq40dcs7sfpxk0g.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">je dois maintenant mettre Ã  jour la collection</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> collectionView</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> elle-mÃªme</font><font style="vertical-align: inherit;">. Il est trÃ¨s important de comprendre que je ne veux pas surcharger toutes les donnÃ©es de ma collection</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> collectionView</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> avec</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> reloadData ()</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> au milieu du processus de Â«glisser-dÃ©poserÂ»</font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, car il rÃ©installe tout le Â«mondeÂ» de notre galerie d'images, ce qui est trÃ¨s mauvais, NE LE FAITES PAS. Au lieu de cela, je vais ranger et insÃ©rer des Ã©lÃ©ments</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ã©lÃ©ments</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> individuellement:</font></font><br><br><img src="https://habrastorage.org/webt/1-/xa/jg/1-xajgm6ru3uwhqh53w4tf7tblu.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j'ai supprimÃ© l'Ã©lÃ©ment de collection</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> collectionView</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> avec</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sourceIndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et insÃ©rÃ© un nouvel Ã©lÃ©ment de collection avec</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> destinationIndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il semble que ce code fonctionne trÃ¨s bien, mais en rÃ©alitÃ©, ce code peut Â«planterÂ» votre application. La raison en est que vous apportez de nombreuses modifications Ã  votre collection</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> collectionView</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , et dans ce cas, chaque Ã©tape de modification de la collection doit Ãªtre synchronisÃ©e avec le modÃ¨le normalement, ce qui n'est pas observÃ© dans notre cas, car nous effectuons les deux opÃ©rations en mÃªme temps: supprimer et insÃ©rer. D'oÃ¹ la collection</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> collectionVoir</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sera Ã  un moment donnÃ© dans un Ã©tat NON synchronisÃ© avec le modÃ¨le. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mais il y a un moyen vraiment cool de contourner cela, c'est que la collection </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">collectionView</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> a une mÃ©thode appelÃ©e </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">performBatchUpdates</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> qui a une fermeture ( </font></font><code>closure</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) et Ã  l'intÃ©rieur de cette fermeture, je peux placer n'importe quel nombre de ces </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">deleteItems</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">insertItems</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">moveItems</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et tout ce que je veux: </font></font><br><br><img src="https://habrastorage.org/webt/6b/w_/6n/6bw_6nemnuzuv8xowkmmpt4yumw.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Maintenant, </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">deleteItems</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">insertItems</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> seront exÃ©cutÃ©s en une seule opÃ©ration, et il n'y aura jamais un manque de synchronisation de votre modÃ¨le avec la collection </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">collectionView</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Et enfin, la derniÃ¨re chose que nous devons faire est de demander au </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">coordinateur d'</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> implÃ©menter et d'animer le Â«resetÂ» lui </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font><font style="vertical-align: inherit;">mÃªme </font><font style="vertical-align: inherit;">: </font></font><br><br><img src="https://habrastorage.org/webt/7k/qr/1u/7kqr1uatpcgzp8vim6hsf1-o_lo.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dÃ¨s que vous soulevez votre doigt de l'Ã©cran, l'image bouge, tout se passe en mÃªme temps: Â«resetÂ», l'image disparaÃ®t dans un endroit et l'apparence dans un autre. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Essayons de dÃ©placer l'image de test Â«VeniseÂ» dans notre galerie d'images Ã  la fin de la premiÃ¨re ligne ... </font></font><br><br><img src="https://habrastorage.org/webt/gy/k4/ci/gyk4ci8msjogcvzo4hb8iqt2atq.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">... et de la Â«rÃ©initialiserÂ»: </font></font><br><br><img src="https://habrastorage.org/webt/kb/a0/mv/kba0mvrjzqyf_wf1y8b0j5h27oy.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">comme nous le voulions, elle a Ã©tÃ© placÃ©e Ã  la fin de la premiÃ¨re ligne.</font></font><br>  Hourra!<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tout fonctionne! </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Maintenant, nous ne traiterons PAS du cas local, c'est-Ã -dire lorsque l'Ã©lÃ©ment "reset" vient Ã  l'extÃ©rieur, c'est-Ã -dire d'une autre application. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pour ce faire, nous Ã©crivons </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">else</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dans le code </font><font style="vertical-align: inherit;">par rapport Ã  </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sourceIndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Si nous n'avons pas </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sourceIndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , cela signifie que l'Ã©lÃ©ment Â«rÃ©initialisableÂ» provenait de l'extÃ©rieur et nous devrons utiliser le transfert de donnÃ©es Ã  l'aide de l' </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">itemProver de l'</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ã©lÃ©ment </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">item.dragItem.itemProvider rÃ©initialisable</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br><br><img src="https://habrastorage.org/webt/wh/-9/gd/wh-9gdfe_e52v_9-wc-mf6o-7co.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">si vous Â«glissez </font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et </font><font style="vertical-align: inherit;">dÃ©posezÂ» Ã  l' </font><font style="vertical-align: inherit;">extÃ©rieur et Â«dÃ©posezÂ» "</font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, ces informations deviennent-elles disponibles instantanÃ©ment? Non, vous sÃ©lectionnez les donnÃ©es de la chose Â«traÃ®nÃ©eÂ» ASYNCHRONE. Mais que faire si l'Ã©chantillon prend 10 secondes? Que fera la collection en ce moment </font></font><code>ollection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">? De plus, les donnÃ©es peuvent ne pas arriver dans l'ordre dans lequel nous les avons demandÃ©es. Pour gÃ©rer cela n'est pas facile, et a </font></font><code>Apple</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">proposÃ© pour </font></font><code>ollection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ce cas une technologie complÃ¨tement nouvelle pour l'utilisation de substituts </font></font><code>Placeholders</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vous placez un </font></font><code>Collection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">espace rÃ©servÃ© </font><font style="vertical-align: inherit;">dans votre collection </font></font><code>Placeholder</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, et la collection </font></font><code>Collection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gÃ¨re tout cela pour vous, donc tout ce que vous avez Ã  faire lorsque les donnÃ©es sont finalement sÃ©lectionnÃ©es est de demander Ã  l'espace rÃ©servÃ© d' </font></font><code>Placeholder</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">appeler son contexte </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">placeholderContext</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et dites-lui que vous avez reÃ§u l'information. Mettez ensuite Ã  jour votre modÃ¨le et contexte </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">placeholderContext</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ã©change </font><font style="vertical-align: inherit;">AUTOMATIQUEMENT </font><font style="vertical-align: inherit;">la </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cellule</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> avec l'espace rÃ©servÃ© </font></font><code>Placeholder</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">avec l'une de vos </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cellules</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , ce qui correspond au type de donnÃ©es que vous avez reÃ§ues. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous effectuons toutes ces actions en crÃ©ant un contexte d' </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">espace rÃ©servÃ© placeholderContext</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> qui gÃ¨re l'espace rÃ©servÃ© </font></font><code>Placeholder</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et que vous obtenez du coordinateur </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">coordinateur</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , vous demandant de Â«rÃ©initialiserÂ» </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l'Ã©lÃ©ment </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">item</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dans l'espace rÃ©servÃ© </font></font><code>Placeholder</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">J'utiliserai l'initialiseur pour le contexte d' </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">espace rÃ©servÃ© placeholderContext</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">qui "jette" </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dragItem</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> vers un </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UICollectionViewDropPlaceholder</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br><br><img src="https://habrastorage.org/webt/xh/lo/gk/xhlogk8aee_nhrukgwbtq0m8nae.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l'objet que je vais "lancer" </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">est </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">item.dragItem</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , oÃ¹ </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">item</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est un Ã©lÃ©ment </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">for</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> d'une </font><font style="vertical-align: inherit;">boucle, puisque nous pouvons lancer de </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nombreux </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">coordinator.items</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Nous les Â«jetonsÂ» un par un. Donc, </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">item.dragItem</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est ce que nous Â« </font><b><font color="#0000FF"><font style="vertical-align: inherit;">glissons</font></font></b><font style="vertical-align: inherit;"> - </font><b><font color="#0000FF"><font style="vertical-align: inherit;">dÃ©posons</font></font></b></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Â» </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. L'argument suivant de cette fonction est l'espace rÃ©servÃ©, et je vais le crÃ©er Ã  l'aide de l'initialiseur </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UICollectionViewDropPlaceholder</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br><br><img src="https://habrastorage.org/webt/hg/yu/jk/hgyujkpqodrfosah0opsrwwc-t0.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pour ce faire, j'ai besoin de savoir OERE je vais insÃ©rer l'espace rÃ©servÃ©</font></font><code>Placeholder</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, c'est-Ã -dire </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">insertionIndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , ainsi que l'identifiant de la cellule rÃ©utilisÃ©e </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">reuseIdentifier</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'argument </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">insertionIndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est Ã©videmment Ã©gal Ã  </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">destinationIndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , c'est l' </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pour placer l'objet Â«glissÃ©Â», il est calculÃ© au tout dÃ©but de la mÃ©thode </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">performDropWith</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Examinons maintenant l' </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ID de</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> cellule </font><b><font color="#0000FF"><font style="vertical-align: inherit;">reuseIdentifier</font></font></b><font style="vertical-align: inherit;"> . VOUS devez dÃ©cider quel type de </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cellule est</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> votre localisateur </font></font><code>Placeholder</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Le coordinateur </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">coordinateur</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> n'a pas de </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cellule</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Â«prÃ©- </font><font style="vertical-align: inherit;">emballÃ©e </font><font style="vertical-align: inherit;">Â» </font><font style="vertical-align: inherit;">pour le localisateur</font></font><code>Placeholder</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. C'est VOUS qui devez dÃ©cider de cette cellule </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cellulaire</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Par consÃ©quent, l'identifiant de la cellule rÃ©utilisÃ©e </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">reuseIdentifiercell est demandÃ©</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> au vÃ´tre </font></font><code>storyboard</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">afin qu'il puisse Ãªtre utilisÃ© comme PROTOTYPE. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Je l'appellerai "DropPlaceholderCell", mais en gros, je pourrais le nommer. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ceci est juste la chaÃ®ne </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">String</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> que je vais utiliser sur la mienne </font></font><code>storyboard</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pour crÃ©er cette chose. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Revenez Ã  la nÃ´tre </font></font><code>storyboard</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et crÃ©ez une cellule de </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cellule</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pour l'espace rÃ©servÃ© </font></font><code>Placeholder</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Pour ce faire, il suffit de sÃ©lectionner une collection </font></font><code>Collection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et de l'inspecter. Dans le tout premier domaine, </font></font><code>Items</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">je passe </font></font><code>1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ã </font></font><code>2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Cela crÃ©e immÃ©diatement une deuxiÃ¨me cellule pour nous, qui est une copie exacte de la premiÃ¨re. </font></font><br><br><img src="https://habrastorage.org/webt/df/go/ke/dfgokefx6miugtxs8ee0_jl1zsk.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous sÃ©lectionnons notre nouvelle cellule </font></font><code>ImageCell</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, dÃ©finissons l'identifiant Â« </font></font><code>DropPlaceholderCell</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Â», en supprimons tous les </font></font><code>UI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ã©lÃ©ments, </font><font style="vertical-align: inherit;">y </font><font style="vertical-align: inherit;">compris </font></font><code>Image View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, puisque ce PROTOTYPE est utilisÃ© lorsque l'image n'est pas encore arrivÃ©e. Nous y ajoutons un nouvel indicateur d'activitÃ© Ã  partir de la palette d'objets </font></font><code>Activity Indicator</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, il tournera, permettant aux utilisateurs de savoir que j'attends des donnÃ©es de Â«rÃ©initialisationÂ». Ã‰galement modifier la couleur de fond </font></font><code>Background</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pour comprendre que lorsque Â« Reset Â» de l'image fonctionne exactement cette cellule </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cellulaire</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> comme des </font><font style="vertical-align: inherit;">prototypes: </font></font><br><br><img src="https://habrastorage.org/webt/ur/gi/72/urgi728r6j2a1d2z0tf_4k-er1a.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Outre le type de nouvelle cellule ne doit pas Ãªtre </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ImageCollectionVewCell</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, car il n'y aura pas d'images dedans. Je ferai de cette cellule une cellule rÃ©guliÃ¨re de TYPE </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UIollectionCiewCell</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , car nous n'en avons pas besoin </font></font><code>Outlets</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pour le contrÃ´le: </font></font><br><br><img src="https://habrastorage.org/webt/sg/d8/ya/sgd8ya2342bd0lgk9fl172j-8pi.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">configurons l'indicateur d'activitÃ© </font></font><code>Activity Indicator</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">afin qu'il commence Ã  s'animer dÃ¨s le dÃ©but, et je n'aurais rien Ã  Ã©crire dans le code pour le dÃ©marrer. Pour ce faire, cliquez sur l'option </font></font><code>Animating</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br><br><img src="https://habrastorage.org/webt/qm/de/hq/qmdehqmwsuzn_dt8fkbjdoclkss.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Et c'est tout. Donc, nous avons fait tous les rÃ©glages pour cette cellule </font></font><code>DropPlaceholderCell</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, nous revenons Ã  notre code. Maintenant, nous avons un excellent localisateur </font></font><code>Placeholder</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">prÃªt Ã  l'emploi. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tout ce que nous avons Ã  faire est d'obtenir les donnÃ©es, et lorsque les donnÃ©es sont reÃ§ues, nous informons simplement le </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">placeholderContext</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de ce contexte </font><font style="vertical-align: inherit;">et il Ã©changera le placeholder</font></font><code>Placeholder</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et notre cellule "native" avec des donnÃ©es, et nous apporterons des modifications au modÃ¨le. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Je vais Â«chargerÂ» UN objet, qui sera mon </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ã©lÃ©ment en</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> utilisant la </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mÃ©thode loadObject (ofClass: UIImage.self)</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (singulier). J'utilise le code </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">item.dragItem.itemProvider</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fournisseur </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ItemProvider</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , qui fournira des </font><font style="vertical-align: inherit;">Ã©lÃ©ments de donnÃ©es ont </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">produit</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de maniÃ¨re asynchrone. Il est clair que si </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">iitemProvider est</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> connectÃ© </font><font style="vertical-align: inherit;">, </font><font style="vertical-align: inherit;">nous obtenons l' </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">objet</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Â«resetÂ» </font><b><font color="#0000FF"><font style="vertical-align: inherit;">iitem en</font></font></b><font style="vertical-align: inherit;"> dehors de cette application. Ce qui suit est la </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mÃ©thode loadObject (ofClass: UIImage.self)</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (singulier): </font></font><br><br><img src="https://habrastorage.org/webt/bv/pl/fj/bvplfjtt-wlffytoqky4jxcbxco.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cette fermeture particuliÃ¨re n'est PAS effectuÃ©e sur</font></font><code>main queue</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Et, malheureusement, nous avons dÃ» passer Ã  l' </font></font><code>main queue</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">utilisation de </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DispatchQueue.main.async {}</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> afin de Â«capturerÂ» le rapport hauteur / largeur de l'image dans la variable </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aspectRatio</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> locale </font><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous avons vraiment introduit deux variables locales </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imageURL</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aspectRatio</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ... </font></font><br><br><img src="https://habrastorage.org/webt/vc/k3/vg/vck3vgqg7grejo8tj2ojbdnfdny.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">... et nous les "attraperons" lors du chargement de l'image </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">image</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et de l'URL </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">URL</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br><br><img src="https://habrastorage.org/webt/jc/ui/yk/jcuiyk3c1zcz4wmkeafkpmkdvqq.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">si les deux variables locales </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imageURL</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aspectRatio</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ne </font><b><font color="#0000FF"><font style="vertical-align: inherit;">sont</font></font></b><font style="vertical-align: inherit;"> pas </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nulles</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , nous demanderons le contexte de l' </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">espace rÃ©servÃ© placeholderContext en</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> utilisant la mÃ©thode </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">commitInsertion</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">donnez-nous la possibilitÃ© de changer notre modÃ¨le </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imageGallery</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br><br><img src="https://habrastorage.org/webt/z6/hm/8w/z6hm8w4jnyrwxgx2g8v9sfnfiuq.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dans cette expression, nous avons </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">insertionIndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - c'est l' </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">indexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ã  insÃ©rer, et nous changeons notre modÃ¨le </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imageGallery</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . C'est tout ce que nous devons faire, et cette mÃ©thode remplacera AUTOMATIQUEMENT un espace rÃ©servÃ© </font></font><code>Placeholder</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">par une </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cellule</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en appelant la mÃ©thode </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cellForItemAt</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> normale </font><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Notez que </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">insertionIndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> peut Ãªtre trÃ¨s diffÃ©rent de </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">destinationIndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font> Pourquoi?<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Parce que l'Ã©chantillonnage des donnÃ©es peut prendre 10 secondes, bien sÃ»r, c'est peu probable, mais cela peut prendre 10 secondes. Pendant ce temps, </font></font><code>Collection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">beaucoup de choses peuvent se produire </font><font style="vertical-align: inherit;">dans la collection </font><font style="vertical-align: inherit;">. PossibilitÃ© d' </font><font style="vertical-align: inherit;">ajouter de </font><font style="vertical-align: inherit;">nouvelles cellules </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cellules</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , tout se passe assez vite. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Utilisez TOUJOURS </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">insertionIndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et UNIQUEMENT </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">insertionIndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pour mettre Ã  jour votre modÃ¨le. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comment mettre Ã  jour notre modÃ¨le? </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous allons </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">insÃ©rer la</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> structure </font><b><font color="#0000FF"><font style="vertical-align: inherit;">imageModel </font></font></b></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dans le tableau imageGallery.images</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , composÃ© du rapport d'aspect de l'image </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aspectRatio</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et de l'URL de l'image </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imageURL</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> que le </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fournisseur</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> correspondant nous a renvoyÃ© </font><font style="vertical-align: inherit;">.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cela met Ã  jour notre modÃ¨le </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imageGallery</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et la mÃ©thode </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">commitInsertion</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fait le reste pour nous. Vous n'avez plus besoin de faire quoi que ce soit de plus, pas d'insertions, pas de suppressions, rien de tout cela. Et, bien sÃ»r, puisque nous sommes dans une fermeture, nous devons nous ajouter </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></font></b>  . <br><br><img src="https://habrastorage.org/webt/rm/ff/nx/rmffnxnhy_1k1ukzub6ni468z6g.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si nous sommes pour une raison de </font><font style="vertical-align: inherit;">ne pas en </font><font style="vertical-align: inherit;">mesure d'obtenir le rapport d'aspect </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aspectRatio</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et l' </font></font><code>URL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">image </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imageURL</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> du correspondant </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">par le </font><font style="vertical-align: inherit;">fournisseur</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , une erreur aurait Ã©tÃ© reÃ§u </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">erreur</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ã  la place </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">par le </font><font style="vertical-align: inherit;">fournisseur</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , nous devons leur faire connaÃ®tre le contexte </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">placeholderContext</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , vous devez dÃ©truire ce un espace rÃ©servÃ© </font></font><code>Placeholder</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, parce que nous sommes tous les mÃªmes, nous ne pouvons pas obtenir d'autres donnÃ©es: </font></font><br><br><img src="https://habrastorage.org/webt/gw/tm/jj/gwtmjjywumpq4o7czavwnrcweay.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">une chose Ã  garder Ã  l'esprit est </font></font><code>URLs</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">qu'elles proviennent de lieux comme celui-ci </font></font><code>Google</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, en rÃ©alitÃ©, elles ont besoin de transformations mineures pour Ãªtre Â«propresÂ»</font></font><code>URL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pour l'image. Comment ce problÃ¨me est rÃ©solu peut Ãªtre vu dans cette application de dÃ©monstration dans un fichier </font></font><code>Utilities.swift</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sur </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Github</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Par consÃ©quent, lorsque </font></font><code>URL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nous </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">recevons</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> une </font><font style="vertical-align: inherit;">image, nous utilisons la propriÃ©tÃ© </font><b><font color="#0000FF"><font style="vertical-align: inherit;">imageURL</font></font></b><font style="vertical-align: inherit;"> de la classe </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">URL</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br><br><img src="https://habrastorage.org/webt/v5/cq/dc/v5cqdcxzqnwybov4eiklwlkt2o8.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et c'est tout ce que vous devez faire pour accepter quelque chose Ã  l'extÃ©rieur de la collection </font></font><code>Collection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Voyons cela en action. Nous lanÃ§ons simultanÃ©ment en mode multitÃ¢che notre application de dÃ©monstration </font></font><code>ImageGallery</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et </font></font><code>Safari</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">avec un moteur de recherche </font></font><code>Google</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Comme </font></font><code>Google</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nous cherchons des images sur le thÃ¨me de Â« DawnÂ» (lever du </font><font style="vertical-align: inherit;">soleil). Dans </font></font><code>Safari</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dÃ©jÃ  construit</font></font><code>Drag &amp; Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">le mÃ©canisme, afin que nous puissions sÃ©lectionner l'une de ces images, la maintenir longtemps, la dÃ©placer un peu et la faire glisser dans notre galerie d'images. </font></font><br><br><img src="https://habrastorage.org/webt/au/t9/wk/aut9wky03l29lkgj9g7l1ulifmc.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La prÃ©sence d'un signe plus vert "+" indique que notre application est prÃªte Ã  accepter une image tierce et Ã  la copier dans votre collection Ã  l'emplacement spÃ©cifiÃ© par l'utilisateur. AprÃ¨s l'avoir Â«rÃ©initialisÃ©eÂ», il faut un certain temps pour tÃ©lÃ©charger l'image, et Ã  ce moment cela fonctionne </font></font><code>Placeholder</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: Une </font></font><br><br><img src="https://habrastorage.org/webt/ge/e-/n0/gee-n08qnm7zc5ofbgr3e4o8df8.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fois le tÃ©lÃ©chargement terminÃ©, l'image Â«rÃ©initialisÃ©eÂ» est placÃ©e au bon endroit et </font></font><code>Placeholder</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">disparaÃ®t: </font></font><br><br><img src="https://habrastorage.org/webt/m8/rb/nq/m8rbnqvi2x0s3as4w_fzpjpltae.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nous pouvons continuer Ã  Â«rÃ©initialiserÂ» les images et les placer dans notre collections d'images encore plus nombreuses: </font></font><br><br><img src="https://habrastorage.org/webt/x8/np/bq/x8npbqpkm9af1_ybkxhw13kjhug.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AprÃ¨s le travail de "rÃ©initialisation" </font></font><code>Placeholder</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br><br><img src="https://habrastorage.org/webt/b2/lq/hb/b2lqhbg6smc2mvvvjp0copbvfmu.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En consÃ©quence, notre galerie d'images est remplie de nouvelles images:</font></font><br><br><img src="https://habrastorage.org/webt/lf/jl/mq/lfjlmqca5iqv26l0woi-htqldcq.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Maintenant qu'il est clair que nous sommes en </font><font style="vertical-align: inherit;">mesure de prendre des </font><font style="vertical-align: inherit;">photos de l'extÃ©rieur, on n'a pas besoin de </font><font style="vertical-align: inherit;">l'image de test, et nous supprimerons: </font></font><br><br><img src="https://habrastorage.org/webt/bv/0t/az/bv0tazx3cjushm1rkcfalu-m1au.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Notre </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">viewDidLoad</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> devient trÃ¨s simple: il est que </font><font style="vertical-align: inherit;">nous faisons notre </font></font><code>Controller</code> <code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dÃ©lÃ©guÃ© et ajoute reconnaisseur geste de </font></font><b><font color="#FF00FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pincement</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , qui rÃ©gule le nombre d'images par ligne: </font></font><br><br><img src="https://habrastorage.org/webt/ei/fo/1b/eifo1bz0szfk12tuqfseh5fser8.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bien sÃ»r , nous pouvons ajouter un cache pour les images </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imageCache</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br><br><img src="https://habrastorage.org/webt/f4/oi/ql/f4oiql_gjnka7racbmkrts7mbja.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous remplirons l' </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imageCache</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> lors de la "rÃ©initialisation" </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dans la mÃ©thode </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">performDrop</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ... </font></font><br><br><img src="https://habrastorage.org/webt/xy/hc/bt/xyhcbtodifjiqgd5norskny9cge.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et lors de la rÃ©cupÃ©ration Ã  partir du "rÃ©seau" dans la classe </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ImageCollectionViewCell</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> personnalisÃ©e </font><font style="vertical-align: inherit;">: </font></font><br><br><img src="https://habrastorage.org/webt/nk/sl/2s/nksl2sw3dujz-_z7fmp55zixfzi.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Et </font><font style="vertical-align: inherit;">nous </font><font style="vertical-align: inherit;">utiliserons le cache </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imageCache</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> lors de la lecture d'une cellule</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cellule de</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> notre galerie d'images dans la classe personnalisÃ©e</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ImageCollectionViewCell</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br><br><img src="https://habrastorage.org/webt/-5/ar/zo/-5arzoeghtoj_ckv-ezxhpu403c.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Maintenant, nous commenÃ§ons avec une collection vide ...</font></font><br><br><img src="https://habrastorage.org/webt/rl/bq/vn/rlbqvnpsww27j5xbryp9vlgng1a.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">... puis "dÃ©posons" une nouvelle image dans notre collection ...</font></font><br><br><img src="https://habrastorage.org/webt/9j/7o/es/9j7oesf_b-rk-dj-s9ysujlkte0.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">... l'image est tÃ©lÃ©chargÃ©e et</font></font><code>Placeholder</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fonctionne ...</font></font><br><br><img src="https://habrastorage.org/webt/tg/s7/6t/tgs76tffgkarqkpzhamq97ebvio.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">... et l'image apparaÃ®t au bon endroit:</font></font><br><br><img src="https://habrastorage.org/webt/ps/uy/z8/psuyz8apr4zpulpgpl5z-hsegfy.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous continuons Ã  remplir notre collection Ã€ L'EXTÃ‰RIEUR:</font></font><br><br><img src="https://habrastorage.org/webt/it/ve/_y/itve_yuqqnffh8zyzlpmj_vvske.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vient charger des images et</font></font><code>Placeholders</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">travailler ...</font></font><br><br><img src="https://habrastorage.org/webt/li/rx/wd/lirxwd74znfsvgrtjkpg3gfvl8u.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Et les images apparaissent au bon endroit:</font></font><br><br><img src="https://habrastorage.org/webt/uq/j0/as/uqj0asiyqcpqosl8x-3akydb3x0.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Donc, nous pouvons faire beaucoup avec notre galerie d'images: remplissez-la Ã€ L'EXTÃ‰RIEUR, rÃ©organisez les Ã©lÃ©ments Ã€ L'INTÃ‰RIEUR, partagez des images avec d'autres applications niyami.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous devons juste lui apprendre Ã  se dÃ©barrasser des images inutiles en les Â«rÃ©initialisantÂ»</font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dans la "poubelle" prÃ©sentÃ©e sur la barre de navigation Ã  droite. </font><font style="vertical-align: inherit;">Comme dÃ©crit dans la section Â«CaractÃ©ristiques de l'application de dÃ©monstration d'Image GalleryÂ», la Â«poubelleÂ» est reprÃ©sentÃ©e par la classe </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GabageView</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , qui hÃ©rite de </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UIView</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et nous devons lui apprendre Ã  accepter les images de notre collection </font></font><code>ollection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br><br><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RÃ©initialisez les </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">images de la galerie dans la corbeille.</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ImmÃ©diatement de l'endroit - Ã  la carriÃ¨re. Je vais ajouter Ã  </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GabageView</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Â« interaction Â» </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Interaction</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et il sera </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UIDropInteraction</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , depuis que </font><font style="vertical-align: inherit;">je suis en </font><font style="vertical-align: inherit;">train de Â« rÃ©initialiser Â» </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">certaines choses. Tout ce dont nous avons besoin pour fournir cet </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UIDropInteraction</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est un dÃ©lÃ©guÃ© </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dÃ©lÃ©guÃ©</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , et je vais </font><b><font color="#0000FF"><font style="vertical-align: inherit;">m'attribuer</font></font></b><font style="vertical-align: inherit;"> moi- </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mÃªme</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ã  ce dÃ©lÃ©guÃ© </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dÃ©lÃ©guÃ©</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br><br><img src="https://habrastorage.org/webt/mm/tq/xn/mmtqxnmypbysaik9fjd3r2amrlg.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Naturellement, notre classe </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GabageView</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> doit confirmer que nous implÃ©mentons le protocole </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UIDropInteractionDelegate</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br><br><img src="https://habrastorage.org/webt/nv/xy/vw/nvxyvwya12ggtiznb1byxq5vorm.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tout ce que nous devons faire pour le faire fonctionner </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, il s'agit d'implÃ©menter les mÃ©thodes </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">canHandle que</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nous connaissons dÃ©jÃ  </font><font style="vertical-align: inherit;">,</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sessionDidUpdate</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> performDrop</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><img src="https://habrastorage.org/webt/jg/m9/ol/jgm9olzkrnv_fmu0mwesx91dvsq.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cependant, contrairement Ã  des mÃ©thodes similaires pour la collecte</font></font><code>Collection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, nous ne disposons d'aucune information supplÃ©mentaire sous la forme d'un</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> indexPath du</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> lieu de dumping.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ImplÃ©mentons ces mÃ©thodes.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dans la mÃ©thode</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> canHandle</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sera traitÃ©e que la Â« glisser-dÃ©poser Â»</font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, qui reprÃ©sentent l'image</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> d' un UIImage</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Par consÃ©quent, je</font><font style="vertical-align: inherit;">ne</font><font style="vertical-align: inherit;">retournerai</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> true que</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> si</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> session.canLoadObjects (ofClass: UIImage.self)</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br><br><img src="https://habrastorage.org/webt/if/z7/yo/ifz7yoibzsugla3mj7kat1cylt8.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dans la mÃ©thode</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> canHandle</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ,</font><font style="vertical-align: inherit;">vous dites essentiellement que si l'objet "dÃ©plaÃ§able" n'est pas une image</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> UIImage</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, puis en outre, cela n'a aucun sens de continuer la suppression "reset" et d'appeler les mÃ©thodes suivantes. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si l'objet Â«glissableÂ» est une image </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UIImage</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , alors nous exÃ©cuterons la mÃ©thode </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sessionDidUpdate</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Tout ce que nous devons faire dans cette mÃ©thode est de renvoyer notre </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">offre de</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Â«rÃ©initialisationÂ» </font><b><font color="#0000FF"><font style="vertical-align: inherit;">UIDropProposal</font></font></b></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Et je suis prÃªt Ã  n'accepter que l'objet LOCALEMENT Â«glissÃ©Â» du TYPE </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UIImage</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de l'image </font><font style="vertical-align: inherit;">, qui peut Ãªtre Â«dÃ©posÃ©Â» </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n'importe oÃ¹ dans mon </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GarbageView</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Mon </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GarbageView</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> n'interagira pas avec les images exportÃ©es Ã€ L'EXTÃ‰RIEUR. Donc j'analyse en utilisant la variable </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">session.localDragSession</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s'il y a une Â«rÃ©initialisationÂ» locale </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, et je renvoie la phrase Â«rÃ©initialisationÂ» sous la forme du constructeur </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UIDropProposal</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> avec l'argument </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">opÃ©ration</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> prenant la valeur </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.copy</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , car le Â«glisser-dÃ©poserÂ» TOUJOURS LOCAL </font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dans mon application proviendra de la collection </font></font><code>Collection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Si Â«glisser </font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font><font style="vertical-align: inherit;">dÃ©poserÂ» </font><font style="vertical-align: inherit;">et Â«rÃ©initialiserÂ» </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">se produisent Ã€ L'EXTÃ‰RIEUR, je renvoie la phrase Â«rÃ©initialiserÂ» sous la forme du constructeur </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UIDropProposal</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> avec l'argument d' </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">opÃ©ration</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> prenant la valeur </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.fobbiden</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , c'est-Ã -dire Â«interditÂ» et nous obtiendrons un signe d'interdiction Â«rÃ©initialiserÂ» au lieu du signe plus vert . </font></font><br><br><img src="https://habrastorage.org/webt/ii/vd/wy/iivdwy9av6cxwzjkeay9kf87lby.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Copie d'une image </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UIImage</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, nous simulerons une diminution de son Ã©chelle Ã  presque 0, et lorsque la "rÃ©initialisation" se produira, nous supprimerons cette image de la collection </font></font><code>Collection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Afin de crÃ©er l'illusion d'images Â«vidage et disparitionÂ» dans la Â«poubelleÂ» pour l'utilisateur, nous utilisons la mÃ©thode </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">previewForDropping</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font><font style="vertical-align: inherit;">nouvelle pour nous </font><font style="vertical-align: inherit;">, qui </font><font style="vertical-align: inherit;">nous </font><font style="vertical-align: inherit;">permet de rediriger le Â«vidageÂ» </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vers un autre endroit et en mÃªme temps de transformer l'objet Â«vidageÂ» lors de l'animation: </font></font><br><br><img src="https://habrastorage.org/webt/e7/ej/zb/e7ejzbhlfzjxrkxsjupt9hiewz4.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Dans cette mÃ©thode, en utilisant l'initialiseur </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UIDragPreviewTarget,</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nous obtenons une nouvelle </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">prÃ©-vue</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pour l'objet </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cible Ã  </font></font></font></b><font style="vertical-align: inherit;"><b><font color="#0000FF"><font style="vertical-align: inherit;">supprimer</font></font></b><font style="vertical-align: inherit;"> et le redirige en utilisant la mÃ©thode </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">retargetedPreview</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ã  un nouvel endroit, Ã  la "poubelle", avec son Ã©chelle jusqu'Ã  presque zÃ©ro: </font></font><br><br><img src="https://habrastorage.org/webt/bu/zp/av/buzpavo-rn6n2eoeztccvman6r0.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">si l'utilisateur lÃ¨ve le doigt, une "rÃ©initialisation" se produit </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et je </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">reÃ§ois</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (comme </font><b><font color="#0000FF"><font style="vertical-align: inherit;">GarbageView</font></font></b><font style="vertical-align: inherit;"> ) un message </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">performDrop</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Dans le message </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">performDrop,</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nous effectuons la Â«rÃ©initialisationÂ» rÃ©elle </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. HonnÃªtement, l' </font><font style="vertical-align: inherit;">image qui a Ã©tÃ© </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">transfÃ©rÃ©e</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sur </font><b><font color="#0000FF"><font style="vertical-align: inherit;">GarbageView</font></font></b><font style="vertical-align: inherit;"> lui-mÃªme </font><font style="vertical-align: inherit;">ne nous intÃ©resse plus, car nous la rendrons pratiquement invisible, le fait mÃªme de l'achÃ¨vement de la Â«rÃ©initialisationÂ» </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">signalera </font><font style="vertical-align: inherit;">probablement </font><font style="vertical-align: inherit;">que nous supprimons cette image de la collection </font></font><code>Collection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Pour ce faire, nous devons connaÃ®tre la collection elle </font><font style="vertical-align: inherit;">- </font><font style="vertical-align: inherit;">mÃªme </font><font style="vertical-align: inherit;">et la </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">collection </font></font></font></b><font style="vertical-align: inherit;"></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">indexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jetÃ© l'image en elle. D'oÃ¹ pouvons-nous les obtenir? </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Parce que le processus </font></font><code>Drag &amp; Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">se dÃ©roule dans une seule application, il est disponible pour nous tous local: locale </font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">session de </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">localDragSession</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> notre </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">session de </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">la session</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , le contexte local </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">localContext</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , qui est notre collection de </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sollectionView</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et objet local </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">localObject</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que nous pouvons faire par lui - </font><font style="vertical-align: inherit;">mÃªme est l' </font><font style="vertical-align: inherit;">image remis Ã  </font><font style="vertical-align: inherit;">zÃ©ro l' </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">image</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de Â« Galerie Â» ou </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">indexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . En </font><font style="vertical-align: inherit;">raison de cela , </font><font style="vertical-align: inherit;">nous pouvons obtenir dans la mÃ©thode </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">performDrop</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> classe </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GarbageView</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> collection </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">collection</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , et utiliser</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dataSource</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> comment</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ImageGalleryCollectionViewController</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et modÃ¨le</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> imageGallery</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> notre</font></font><code>Controller</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, nous pouvons obtenir un tableau d'images d'</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> images</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> TYPE [ImageModel]:</font></font><br><br><img src="https://habrastorage.org/webt/3t/tj/kr/3ttjkr1cuyqxh4v3islcmsofjhy.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Avec l'aide de la section locale</font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">session</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de localDragSession</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> notre</font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">session</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de la session</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , nous avons pu obtenir toutes les Â« glisser Â» sur</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> GarbageView</font></font></font></b> <code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ã©lÃ©ments des</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ã©lÃ©ments</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , et il peut y avoir beaucoup, comme nous</font><font style="vertical-align: inherit;">savons, et tous sont des images de notre</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> collection collectionView</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . CrÃ©ation</font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ã©lÃ©ments</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dragItems</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> notre collection</font></font><code>Collection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, nous avons fourni pour chaque Â« glisser Â»</font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ã©lÃ©ment</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dragItem</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> objet local</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> localObject</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , qui est l'image de</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> l' image</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , mais il est on ne vient pas</font><font style="vertical-align: inherit;">portÃ©e</font><font style="vertical-align: inherit;">main lors</font><font style="vertical-align: inherit;">collecte de rÃ©organisation interne</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> CollectionView</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , mais la Â« remise</font><font style="vertical-align: inherit;">zÃ©ro Â» Galeries d'images Â« POUBELLE Â» nous</font><font style="vertical-align: inherit;">dÃ©sespÃ©rÃ©ment besoin dans l'installation locale</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> localObject</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> objet Â« drag Â»</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dragItem</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , aprÃ¨s tout ce temps nous n'avons pas de</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> coordinateur</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , qui partage si gÃ©nÃ©reusement les informations sur ce qui se passe dans la collection</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> collectionView</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font><font style="vertical-align: inherit;">consÃ©quent, nous voulons</font><font style="vertical-align: inherit;">l'objet local</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> localObject</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> index Ã©tait</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> indexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dans le tableau d'images</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> images</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de nos modÃ¨les</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imageGallery</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Effectuez les modifications nÃ©cessaires dans la mÃ©thode</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dragItems (Ã  indexPath: indexPath)</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> classe</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ImageGalleryCollectionViewController</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br><br><img src="https://habrastorage.org/webt/le/iy/hz/leiyhzxv04brlhk6nlhpakw4bek.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Maintenant</font><font style="vertical-align: inherit;">nous pouvons prendre tous</font><font style="vertical-align: inherit;">Ã©lÃ©ments Â« pretaskivaemogo Â»</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> point</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> il</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> localObject</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , qui est l'indice</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> indexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dans le tableau d'images</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> images</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de nos modÃ¨les</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> imagegallery</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , et</font><font style="vertical-align: inherit;">envoyer aux indices de tableau</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> des index</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et tableau d'</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> indexPahes d'</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> images supprimÃ©es:</font></font><br><br><img src="https://habrastorage.org/webt/ci/cf/uo/cicfuo7gxvbmh7ddvjj2maorfog.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ConnaÃ®tre le tableau d'indexes d'</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> index</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et le tableau d'</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> indexPahes d'</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> images supprimÃ©es, dans la mÃ©thode</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> performBatchUpdates</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">collection </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">collection</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nous supprimer toutes les </font><font style="vertical-align: inherit;">images supprimÃ©es de modÃ¨les d' </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">images</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et de la collection de </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">collection</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br><br><img src="https://habrastorage.org/webt/2t/49/i4/2t49i4wwgqlz-vqqpalim8m4h4u.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ExÃ©cutez l'application, remplissez la galerie avec de </font><font style="vertical-align: inherit;">nouvelles images: </font></font><br><br><img src="https://habrastorage.org/webt/vj/kb/v5/vjkbv5nwenjhacglkmksbto5jh0.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SÃ©lectionnez une paire d'images que nous voulons retirer de notre galerie ... </font></font><br><br><img src="https://habrastorage.org/webt/cm/-e/t1/cm-et1fd2cp7pext2src2vddkmm.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">... Â« jeter Â» les sur l'icÃ´ne avec la Â« poubelle Â» ... </font></font><br><br><img src="https://habrastorage.org/webt/yw/l3/ue/ywl3ue6tusekuyqvpjv3n4pn1xy.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ils ont rÃ©duit presque Ã  0 ... </font></font><br><br><img src="https://habrastorage.org/webt/14/6r/nd/146rndccir7ou4z5zitpj9gv4ek.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">... et disparaissent de la collection </font></font><code>Collection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, se cachant dans la "poubelle":</font></font><br><br><img src="https://habrastorage.org/webt/1x/b_/zw/1xb_zw27xn-2yp7lb7tvlpgm_fc.png"><br><br><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Enregistrement d'images entre les dÃ©marrages. </font></font></h1><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pour enregistrer la galerie d'images entre les exÃ©cutions, nous utiliserons </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UserDefaults</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , aprÃ¨s avoir converti notre modÃ¨le en un </font></font><code>JSON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">format. Pour ce faire, nous allons ajouter Ã  notre </font></font><code>Controller</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">variable de </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">defailts var</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ... </font></font><br><br><img src="https://habrastorage.org/webt/wy/cg/vy/wycgvy5krdrmfiugzp9dgykaphe.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">... et dans le modÃ¨le </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ImageGallery</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ImageModel</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> protocole </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">codable</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br><br><img src="https://habrastorage.org/webt/j2/vv/w6/j2vvw62tiuud6eidtx1n9ipeq0w.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">chaÃ®ne </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">chaÃ®ne</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , des </font><font style="vertical-align: inherit;">tableaux de </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">la matrice</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l'URL</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">double</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> appliquent dÃ©jÃ  le protocole </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">codable</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , donc nous n'avons rien d' </font><font style="vertical-align: inherit;">autre Ã  faire pour se </font><font style="vertical-align: inherit;">rendre Ã  l' </font><font style="vertical-align: inherit;">encodage de travail et dÃ©codage en </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">modÃ¨les</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ImageGallery </font><font style="vertical-align: inherit;">au </font></font><code>JSON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">format.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comment obtenir la </font></font><code>JSON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">version d' </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ImageGallery</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ? </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pour ce faire, crÃ©ez une variable calculÃ©e </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">var json</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , qui renvoie le rÃ©sultat d'une tentative de conversion elle- </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mÃªme</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , en utilisant </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JSONEncoder.encode ()</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> au </font></font><code>JSON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">format: </font></font><br><br><img src="https://habrastorage.org/webt/f6/o3/hz/f6o3hzee-7hryaxadmzf--0jeym.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et c'est tout. Soit les </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">donnÃ©es</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> seront retournÃ©es </font><font style="vertical-align: inherit;">Ã  la suite de la conversion de </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">soi</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> au format </font></font><code>JSON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, soit </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nil</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> si cette conversion Ã©choue, bien que cette derniÃ¨re ne se produise jamais, car ce TYPE est 100% </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">encodable</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . La </font><font style="vertical-align: inherit;">variable </font><b><font color="#0000FF"><font style="vertical-align: inherit;">json </font></font></b></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">facultative</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est utilisÃ©e </font><font style="vertical-align: inherit;">uniquement pour des raisons de symÃ©trie.</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"></font></font></b><font style="vertical-align: inherit;"></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous avons maintenant un moyen de convertir les modÃ¨les </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ImageGallery</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> au </font><font style="vertical-align: inherit;">format </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Data</font></font></font></b><font style="vertical-align: inherit;"></font><code>JSON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> variable </font><b><font color="#0000FF"><font style="vertical-align: inherit;">json a-t-elle des </font></font></b></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">donnÃ©es</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> TYPE </font><b><font color="#0000FF"><font style="vertical-align: inherit;">?</font></font></b><font style="vertical-align: inherit;"> qui peut Ãªtre mÃ©morisÃ© dans </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UserDefaults</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Imaginez maintenant que d'une maniÃ¨re ou d'une autre nous avons rÃ©ussi Ã  obtenir les </font></font><code>JSON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">donnÃ©es </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">json</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , et j'aimerais recrÃ©er Ã  partir d'eux notre modÃ¨le, une instance de la structure </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ImageGallery</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Pour ce faire, il est trÃ¨s facile d'Ã©crire un INITIALIZER pour </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ImageGallery</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , dont l'argument d'entrÃ©e est des </font></font><code>JSON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">donnÃ©es </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">json</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Cet initialiseur sera un initialiseur "tombant" (</font></font><code>failable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) Si elle ne parvient pas Ã  initialiser, il Â« tombe Â» et retourne </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nil</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br><br><img src="https://habrastorage.org/webt/g7/0n/l4/g70nl4mxpadtrajaq7y-ec4f6bw.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Je suis juste une nouvelle valeur </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">newValue</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> par le dÃ©codeur </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JSONDecoder</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , en </font><font style="vertical-align: inherit;">essayant de dÃ©coder les donnÃ©es </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JSON</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , qui sont transfÃ©rÃ©s Ã  mon initialiseur, puis l' </font><font style="vertical-align: inherit;">affecte Ã  </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l'auto</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si j'ai rÃ©ussi Ã  le faire, alors j'obtiens une nouvelle instance d' </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ImageGallery</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , mais si ma tentative Ã©choue, je retourne </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nil</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , car mon initialisation "a Ã©chouÃ©". </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Je dois dire que nous avons ici beaucoup plus de raisons dâ€™Ã©chouer ( </font></font><code>fail</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), car il est fort possible que les </font></font><code>JSON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">donnÃ©es </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">json</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">peut Ãªtre gÃ¢tÃ© ou vide, tout cela peut conduire Ã  la Â«chuteÂ» ( </font></font><code>fail</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) de l'initialiseur. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Maintenant , </font><font style="vertical-align: inherit;">nous pouvons mettre en </font><font style="vertical-align: inherit;">Å“uvre les READ </font></font><code>JSON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">donnÃ©es et modÃ¨le de rÃ©cupÃ©ration </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imagegallery</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> la mÃ©thode </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">viewWillAppear</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> notre </font></font><code>Controller</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">... </font></font><br><br><img src="https://habrastorage.org/webt/gw/n2/u-/gwn2u-zkggggk2vuwfi-czhycdq.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">... ainsi que d' </font><font style="vertical-align: inherit;">une entrÃ©e dans l'observateur </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">didSet {}</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> propriÃ©tÃ©s </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imagegallery</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br><br><img src="https://habrastorage.org/webt/-g/bc/yz/-gbcyzh4t5innabrtcbxdmdh3wq.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LanÃ§ons l'application et remplissez notre galerie d'images: </font></font><br><br><img src="https://habrastorage.org/webt/le/t5/wr/let5wryw9nwf-ahnij7f_wltztc.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si nous fermons l'application et de l' </font><font style="vertical-align: inherit;">ouvrir Ã  </font><font style="vertical-align: inherit;">nouveau, nous pouvons voir notre galerie prÃ©cÃ©dente Images enregistrÃ©es dans </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UserDefaults</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><h1>  Conclusion </h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cet article montre Ã  quel point il est facile d'intÃ©grer la technologie </font></font><code>Drag &amp; Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dans une </font></font><code>iOS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">application en </font><font style="vertical-align: inherit;">utilisant l'exemple d'une application de dÃ©monstration trÃ¨s simple Â«Galerie d'imagesÂ» </font><font style="vertical-align: inherit;">. Cela a permis de modifier entiÃ¨rement la galerie d'images, de Â«lancerÂ» de nouvelles images Ã  partir d'autres applications, de dÃ©placer celles existantes et de supprimer celles inutiles. Et aussi de distribuer les images accumulÃ©es dans la Galerie Ã  d'autres applications. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bien sÃ»r, nous aimerions crÃ©er de nombreuses collections d'images thÃ©matiques pittoresques et les enregistrer directement sur l'iPad ou iCloud Drive. Cela peut Ãªtre fait si chacune de ces galeries est interprÃ©tÃ©e comme un </font><b><font color="#0000FF"><font style="vertical-align: inherit;">UIDocument</font></font></b><font style="vertical-align: inherit;"> stockÃ© en permanence</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Une telle interprÃ©tation nous permettra de passer au niveau d'abstraction suivant et de crÃ©er une application qui fonctionne avec des documents. </font><font style="vertical-align: inherit;">Dans une telle application, vos documents seront affichÃ©s par le composant </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DocumentBrowserViewController</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , trÃ¨s similaire Ã  l'application </font></font><code>Files</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Il vous permettra de crÃ©er des </font><font style="vertical-align: inherit;">images </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UIDocument</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de type Â«Galerie d'imagesÂ» Ã  la fois sur vous </font></font><code>iPad</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et sur </font></font><code>iCloud Drive</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, ainsi que de sÃ©lectionner le document souhaitÃ© pour l'affichage et l'Ã©dition. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mais c'est le sujet du prochain article. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PS Le code de l'application de dÃ©monstration avant l'implÃ©mentation du mÃ©canisme </font></font><code>Drag &amp; Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et aprÃ¨s est sur </font></font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Github</font></font></a></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><br></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr425817/">https://habr.com/ru/post/fr425817/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr425807/index.html">ComplexitÃ© des systÃ¨mes et mÃ©thodes de Â«lutteÂ» avec elle</a></li>
<li><a href="../fr425809/index.html">Apprentissage des langages de programmation dans le processus: dÃ©veloppeur de logiciels sur des projets complexes</a></li>
<li><a href="../fr425811/index.html">Un autre problÃ¨me d'affichage du MacBook Pro</a></li>
<li><a href="../fr425813/index.html">CICD: dÃ©ploiement transparent sur des systÃ¨mes de cluster distribuÃ©s sans temps d'arrÃªt</a></li>
<li><a href="../fr425815/index.html">Qui n'a pas besoin de rÃ©fÃ©rencement, comment choisir un optimiseur et tester son travail</a></li>
<li><a href="../fr425819/index.html">GitLab 11.3 publiÃ© avec le rÃ©fÃ©rentiel Maven et des environnements sÃ©curisÃ©s</a></li>
<li><a href="../fr425821/index.html">Comment devenir dÃ©veloppeur React en 2018</a></li>
<li><a href="../fr425823/index.html">Statistiques IPO 2018: 45 milliards de dollars levÃ©s, Dropbox a levÃ© moins d'argent que les sociÃ©tÃ©s pharmaceutiques et les vendeurs immobiliers</a></li>
<li><a href="../fr425827/index.html">LeÃ§on Google+: les projets doivent s'assurer que les frontiÃ¨res entre les intÃ©rÃªts des utilisateurs dans la vie rÃ©elle sont respectÃ©es en ligne</a></li>
<li><a href="../fr425829/index.html">Comment nous nous sommes battus avec Roskomnadzor et ce qu'il en est advenu</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>