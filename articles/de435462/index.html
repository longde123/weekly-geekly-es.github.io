<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👶🏻 🛷 🙎🏻 Testen von Node.js-Projekten. Teil 1. Testanatomie und Testtypen 🌙 👩‍👩‍👦 👩🏾‍💼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Der Autor des Materials, dessen erster Teil der Übersetzung wir heute veröffentlichen, sagt, dass er als unabhängiger Berater auf Node.js jedes Jahr m...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Testen von Node.js-Projekten. Teil 1. Testanatomie und Testtypen</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/435462/">  Der Autor des Materials, dessen erster Teil der Übersetzung wir heute veröffentlichen, sagt, dass er als unabhängiger Berater auf Node.js jedes Jahr mehr als 10 Projekte analysiert.  Seine Kunden, was durchaus gerechtfertigt ist, bitten ihn, dem Testen besondere Aufmerksamkeit zu widmen.  Vor einigen Monaten begann er, sich Notizen über wertvolle Testtechniken und die aufgetretenen Fehler zu machen.  Das Ergebnis war Material mit drei Dutzend Testempfehlungen. <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/getpro/habr/post_images/f16/1a0/3e2/f161a03e2b08ae35b31f718a083a39a0.jpg" alt="Bild"></a> <br><br>  Insbesondere wird der Schwerpunkt auf der Auswahl von Testtypen liegen, die für eine bestimmte Situation geeignet sind, auf ihrem richtigen Design, auf der Bewertung ihrer Wirksamkeit und darauf, wo genau in CI / CD-Ketten Sie sie platzieren müssen.  Einige der Beispiele hier werden mit Jest illustriert, andere mit Mocha.  Dieses Material konzentriert sich hauptsächlich nicht auf Werkzeuge, sondern auf Testmethoden. <br><br>  → <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Testen von Node.js-Projekten.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 2. Bewertung der Testleistung, kontinuierliche Integration und Analyse der Codequalität</a> <br><a name="habracut"></a><br><h3>  <font color="#3AC1EF">▍0.</font>  <font color="#3AC1EF">Goldene Regel: Tests sollten sehr einfach und unkompliziert sein</font> </h3><br>  Kennen Sie jemanden - einen Freund, ein Familienmitglied, den Helden des Films, der immer gut gelaunt ist und immer bereit ist, zu helfen, ohne dafür etwas zu verlangen?  So sollten gute Tests gestaltet werden.  Sie sollten einfach sein, nützlich sein und positive Emotionen hervorrufen.  Dies kann durch sorgfältige Auswahl der Testmethoden, Werkzeuge und Ziele erreicht werden.  Diejenigen, deren Verwendung den Zeit- und Arbeitsaufwand für die Vorbereitung und Durchführung von Tests rechtfertigt und gleichzeitig gute Ergebnisse liefert.  Sie müssen nur testen, was getestet werden muss. Sie sollten sich bemühen, sicherzustellen, dass die Tests einfach und flexibel sind. Manchmal können Sie einige Tests ablehnen, was die Zuverlässigkeit des Projekts aufgrund seiner Einfachheit und Entwicklungsgeschwindigkeit beeinträchtigt. <br><br>  Tests sollten nicht als normaler Anwendungscode betrachtet werden.  Tatsache ist, dass ein typisches Team, das an der Entwicklung eines Projekts beteiligt ist, auf jeden Fall alles in seiner Macht Stehende unternimmt, um es in einem funktionsfähigen Zustand zu halten, dh beispielsweise versucht, ein kommerzielles Produkt so zu betreiben, wie es die Benutzer erwarten.  Infolgedessen hat ein solches Team möglicherweise nicht das gute Gefühl, dass es ein weiteres komplexes „Projekt“ unterstützen muss, das durch eine Reihe von Tests dargestellt wird.  Wenn die Tests des Hauptcodes zunehmen, immer mehr Aufmerksamkeit auf sich ziehen und zu einem Grund zur ständigen Besorgnis werden, wird die Arbeit an ihnen entweder abgebrochen oder ihnen, wenn sie versuchen, ein angemessenes Niveau beizubehalten, so viel Zeit und Energie geben, dass dies die Arbeit am Hauptprojekt verlangsamt. <br><br>  Daher sollte der Testcode so einfach wie möglich sein und eine minimale Anzahl von Abhängigkeiten und Abstraktionsebenen aufweisen.  Tests sollten so aussehen, dass sie auf einen Blick verstanden werden können.  Die meisten Empfehlungen, die wir hier berücksichtigen werden, ergeben sich aus diesem Prinzip. <br><br><h2>  <font color="#3AC1EF">Abschnitt 1. Anatomie der Tests</font> </h2><br><h3>  <font color="#3AC1EF">▍1.</font>  <font color="#3AC1EF">Entwerfen Sie Ihre Tests so, dass der Bericht Ihnen sagt, was in welchem ​​Szenario getestet wird und was von den Tests erwartet wird</font> </h3><br><h4>  Empfehlungen </h4><br>  Der Testbericht sollte angeben, ob die aktuelle Version der Anwendung ihren Anforderungen entspricht.  Dies sollte in einer Form erfolgen, die für diejenigen verständlich ist, die mit dem Anwendungscode nicht vertraut sein müssen.  Dies kann ein Tester sein, ein DevOps-Spezialist, der das Projekt bereitstellt, oder der Entwickler selbst, der sich das Projekt einige Zeit nach dem Schreiben des Codes angesehen hat.  Dies kann erreicht werden, wenn beim Schreiben von Tests die Produktanforderungen im Mittelpunkt stehen.  Mit diesem Ansatz kann man sich die Struktur des Tests vorstellen, die aus drei Teilen besteht: <br><br><ol><li> Was genau wird getestet?  Zum Beispiel die <code>ProductsService.addNewProduct</code> Methode. </li><li>  In welchem ​​Szenario und unter welchen Umständen wird der Test durchgeführt?  Beispielsweise wird die Reaktion des Systems in einer Situation überprüft, in der der Preis der Waren nicht an die Methode übergeben wurde. </li><li>  Was sind die erwarteten Testergebnisse?  In einer ähnlichen Situation weigert sich das System beispielsweise, das Hinzufügen eines neuen Produkts zu bestätigen. </li></ol><br><h4>  Folgen der Abweichung von den Empfehlungen </h4><br>  Angenommen, das System konnte nicht bereitgestellt werden, und anhand des Testberichts können Sie nur feststellen, dass es den Test " <code>Add product</code> nicht bestanden hat, bei dem das Hinzufügen eines bestimmten Produkts überprüft wird.  Gibt dies Auskunft darüber, was genau schief gelaufen ist? <br><br><h4>  Richtiger Ansatz </h4><br>  Testinformationen bestehen aus drei Informationen. <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//1.   describe('Products Service', function() { //2.  describe('Add new product', function() {   // 3. ,       it('When no price is specified, then the product status is pending approval', ()=&gt; {     const newProduct = new ProductService().add(...);     expect(newProduct.status).to.equal('pendingApproval');   }); }); });</span></span></code> </pre> <br><h4>  Richtiger Ansatz </h4><br>  Der Testbericht ähnelt einem Dokument mit einer Erklärung der Produktanforderungen. <br><br>  So sieht es auf verschiedenen Ebenen aus. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1f3/172/8fb/1f31728fba16acd94c79d10fbcbb6c02.jpg"></div><br>  <i><font color="#999999">Produktanforderungsdokument, Testbenennung, Testergebnisse</font></i> <br><br><ol><li>  Ein Dokument mit Produktanforderungen kann entweder ein spezielles Dokument sein oder in Form einer E-Mail vorliegen. </li><li>  Wenn Sie Tests benennen, den Testzweck, das Szenario und die erwarteten Ergebnisse beschreiben, müssen Sie die Sprache einhalten, die zur Formulierung der Produktanforderungen verwendet wird.  Auf diese Weise können Sie den Testcode und die Produktanforderungen vergleichen. </li><li>  Die Testergebnisse sollten auch für diejenigen klar sein, die mit dem Anwendungscode nicht vertraut sind oder ihn vollständig vergessen haben.  Dies sind Tester, DevOps-Spezialisten und Entwickler, die einige Monate nach dem Schreiben wieder mit dem Code arbeiten. </li></ol><br><h3>  <font color="#3AC1EF">▍2.</font>  <font color="#3AC1EF">Beschreiben Sie, was Sie von den Tests in der Produktsprache erwarten: Verwenden Sie Anweisungen im BDD-Stil</font> </h3><br><h4>  Empfehlungen </h4><br>  Die Entwicklung von Tests in einem deklarativen Stil ermöglicht es denjenigen, die mit ihnen arbeiten, ihre Essenz sofort zu erfassen.  Wenn Tests mit einem imperativen Ansatz geschrieben werden, sind sie mit bedingten Konstrukten gefüllt, die ihr Verständnis erheblich erschweren.  Nach diesem Prinzip sollten Erwartungen in einer Sprache beschrieben werden, die dem Normalen nahe kommt.  Der deklarative BDD-Stil verwendet <code>expect</code> oder <code>should</code> Konstrukte anstelle eines speziellen Codes ihres eigenen Designs.  Wenn es in Chai oder Jest keine erforderlichen Anweisungen gibt und sich herausstellt, dass solche Anweisungen häufig benötigt werden, sollten Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Jest neue „Checks“ hinzufügen</a> oder eigene <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Plugins für Chai</a> schreiben. <br><br><h4>  Folgen der Abweichung von den Empfehlungen </h4><br>  Wenn Sie die oben beschriebenen Empfehlungen nicht befolgen, führt dies dazu, dass Mitglieder des Entwicklungsteams weniger Tests schreiben und die lästigen Überprüfungen mit der Methode <code>.skip()</code> überspringen. <br><br><h4>  Falscher Ansatz </h4><br>  Der Leser dieses Tests muss den ziemlich langen Imperativcode nur vollständig überprüfen, um zu verstehen, was genau im Test getestet wird. <br><br><pre> <code class="javascript hljs">it(<span class="hljs-string"><span class="hljs-string">"When asking for an admin, ensure only ordered admins in results"</span></span> , ()={   <span class="hljs-comment"><span class="hljs-comment">//,       — "admin1"  "admin2",   "user1"   const allAdmins = getUsers({adminOnly:true});   const admin1Found, adming2Found = false;   allAdmins.forEach(aSingleUser =&gt; {       if(aSingleUser === "user1"){           assert.notEqual(aSingleUser, "user1", "A user was found and not admin");       }       if(aSingleUser==="admin1"){           admin1Found = true;       }       if(aSingleUser==="admin2"){           admin2Found = true;       }   });   if(!admin1Found || !admin2Found ){       throw new Error("Not all admins were returned");   } });</span></span></code> </pre> <br><h4>  Richtiger Ansatz </h4><br>  Sie können diesen Test buchstäblich auf einen Blick verstehen. <br><br><pre> <code class="javascript hljs">it(<span class="hljs-string"><span class="hljs-string">"When asking for an admin, ensure only ordered admins in results"</span></span> , ()={   <span class="hljs-comment"><span class="hljs-comment">//,        const allAdmins = getUsers({adminOnly:true});     expect(allAdmins).to.include.ordered.members(["admin1" , "admin2"]) .but.not.include.ordered.members(["user1"]); });</span></span></code> </pre> <br><h3>  <font color="#3AC1EF">▍3.</font>  <font color="#3AC1EF">Führen Sie Testcode-Flusen mit speziellen Plugins durch</font> </h3><br><h4>  Empfehlungen </h4><br>  Es gibt eine Reihe von Plug-Ins für ESLint, die speziell zum Analysieren von Testcode und zum Auffinden von Problemen in diesem Code entwickelt wurden.  Beispielsweise gibt das <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">eslint-plugin-mocha-</a> Plug- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">in</a> Warnungen aus, wenn der Test auf globaler Ebene geschrieben wurde (und kein Nachkomme von <code>describe()</code> ) oder wenn sich herausstellt, dass die Tests <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">übersprungen wurden</a> , was zu falschen Hoffnungen führen kann, dass alle Tests bestanden werden.  Das <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">eslint-plugin-jest-Plugin</a> funktioniert auf ähnliche Weise, z. B. Warnung vor Tests, die keine Anweisungen enthalten, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">dh</a> vor Tests, die nichts überprüfen. <br><br><h4>  Folgen der Abweichung von den Empfehlungen </h4><br>  Der Entwickler wird sich freuen zu sehen, dass der Code zu 90% in Tests enthalten ist und 100% der Tests erfolgreich bestanden wurden.  Es bleibt jedoch nur in diesem Zustand, bis sich herausstellt, dass viele Tests tatsächlich nichts überprüfen und einige Testskripte einfach übersprungen werden.  Man kann nur hoffen, dass niemand Projekte bereitstellt, die auf diese Weise in der Produktion „getestet“ werden. <br><br><h4>  Falscher Ansatz </h4><br>  Das Testszenario ist voller Fehler, die glücklicherweise mit dem Linter erkannt werden können. <br><br><pre> <code class="javascript hljs">describe(<span class="hljs-string"><span class="hljs-string">"Too short description"</span></span>, () =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> userToken = userService.getDefaultToken() <span class="hljs-comment"><span class="hljs-comment">// *error:no-setup-in-describe, use hooks (sparingly) instead it("Some description", () =&gt; {});//* error: valid-test-description. Must include the word "Should" + at least 5 words }); it.skip("Test name", () =&gt; {// *error:no-skipped-tests, error:error:no-global-tests. Put tests only under describe or suite expect("somevalue"); // error:no-assert }); it("Test name", () =&gt; {*//error:no-identical-title. Assign unique titles to tests });</span></span></code> </pre> <br><h3>  <font color="#3AC1EF">▍4.</font>  <font color="#3AC1EF">Halten Sie sich an die Black-Box-Methode - testen Sie nur öffentliche Methoden</font> </h3><br><h4>  Empfehlungen </h4><br>  Das Testen einiger interner Codemechanismen bedeutet eine erhebliche Erhöhung der Belastung der Entwickler und bietet fast keine Vorteile.  Wenn eine bestimmte API die richtigen Ergebnisse liefert, lohnt es sich dann, mehrere Stunden damit zu verbringen, ihre internen Mechanismen zu testen und diese Tests, die sehr leicht zu brechen sind, weiterhin auf dem neuesten Stand zu halten?  Beim Testen öffentlich verfügbarer Methoden wird auch deren interne Implementierung, obwohl implizit, überprüft.  Ein solcher Test führt zu einem Fehler, wenn im System ein Problem auftritt, das zur Ausgabe falscher Daten führt.  Dieser Ansatz wird auch als "Verhaltenstest" bezeichnet.  Auf der anderen Seite konzentriert sich der Entwickler beim Testen der internen Mechanismen einer bestimmten API (dh unter Verwendung der White-Box-Technik) auf die kleinen Details der Implementierung und nicht auf das Endergebnis des Codes.  Tests, die solche Feinheiten überprüfen, können beispielsweise nach einer kleinen Umgestaltung des Codes zu Fehlern führen, obwohl das System weiterhin korrekte Ergebnisse liefert.  Infolgedessen erhöht dieser Ansatz die Belastung des Programmierers, die mit der Unterstützung von Testcode verbunden ist, erheblich. <br><br><h4>  Folgen der Abweichung von den Empfehlungen </h4><br>  Die Tests, die versuchen, die internen Mechanismen eines bestimmten Systems zu erfassen, verhalten sich wie ein Hirtenjunge aus einer <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Fabel,</a> der Bauern mit den Schreien „Hilfe!  Wolf! “Als kein Wolf in der Nähe war.  Die Leute rannten zur Hilfe, nur um herauszufinden, dass sie getäuscht worden waren.  Und als der Wolf wirklich auftauchte, kam niemand zur Rettung.  Solche Tests führen beispielsweise in den Fällen, in denen sich die Namen einiger interner Variablen ändern, zu falsch positiven Ergebnissen.  Infolgedessen ist es nicht verwunderlich, dass derjenige, der diese Tests durchführt, bald beginnt, seine "Schreie" zu ignorieren, was letztendlich dazu führt, dass ein wirklich schwerwiegender Fehler unbemerkt bleiben kann. <br><br><h4>  Falscher Ansatz </h4><br>  Dieser Test testet die internen Mechanismen einer Klasse ohne besonderen Grund für solche Überprüfungen. <br><br><pre> <code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ProductService</span></span></span></span>{ <span class="hljs-comment"><span class="hljs-comment">//      //     ,      calculateVAT(priceWithoutVAT){   return {finalPrice: priceWithoutVAT * 1.2};   //           } //  getPrice(productId){   const desiredProduct= DB.getProduct(productId);   finalPrice = this.calculateVATAdd(desiredProduct.price).finalPrice; } } it("White-box test: When the internal methods get 0 vat, it return 0 response", async () =&gt; {   //       VAT,      .  ,   ,        expect(new ProductService().calculateVATAdd(0).finalPrice).to.equal(0); });</span></span></code> </pre> <br><h3>  <font color="#3AC1EF">▍5.</font>  <font color="#3AC1EF">Wählen Sie die entsprechenden Sicherungsobjekte aus: Vermeiden Sie Mobs und bevorzugen Sie Stubs und Spione</font> </h3><br><h4>  Empfehlungen </h4><br>  Die Verwendung von Testdoppeln beim Testen ist ein notwendiges Übel, da sie mit den internen Mechanismen der Anwendung verbunden sind.  Ohne einige von ihnen ist das einfach unmöglich.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Hier finden Sie</a> nützliches Material zu diesem Thema.  Verschiedene Ansätze zur Verwendung solcher Objekte können jedoch nicht als äquivalent bezeichnet werden.  Einige von ihnen - Stummel (Stummel) und Spione (Spion) - zielen darauf ab, die Anforderungen an das Produkt zu testen, müssen jedoch in Form einer unvermeidlichen Nebenwirkung die internen Mechanismen dieses Produkts geringfügig beeinflussen.  Mocks hingegen zielen darauf ab, die internen Mechanismen des Projekts zu testen.  Daher führt ihre Verwendung zu einer enormen unnötigen Belastung für Programmierer, über die wir oben gesprochen haben, und bietet an, beim Schreiben von Tests die "Black-Box" -Methode einzuhalten. <br><br>  Stellen Sie sich vor der Verwendung doppelter Objekte eine einfache Frage: „Benutze ich sie, um die beschriebene Funktionalität zu testen, oder könnte sie in den technischen Anforderungen für das Projekt beschrieben werden?“.  Wenn die Antwort auf diese Frage negativ ist, kann dies bedeuten, dass Sie das Produkt mit dem White-Box-Ansatz testen, über den wir bereits gesprochen haben. <br><br>  Wenn Sie beispielsweise herausfinden möchten, ob Ihre Anwendung in einer Situation, in der ein Zahlungsdienst nicht verfügbar ist, ordnungsgemäß funktioniert, können Sie diesen Dienst beenden und die Anwendung etwas empfangen lassen, das darauf hinweist, dass keine Antwort vorliegt.  Auf diese Weise können Sie die Reaktion des Systems auf eine ähnliche Situation überprüfen, um festzustellen, ob es sich korrekt verhält.  Während eines solchen Tests wird das Verhalten oder die Reaktion oder das Ergebnis der Anwendung unter bestimmten Bedingungen überprüft.  In dieser Situation können Sie mit dem Spion überprüfen, ob beim Feststellen eines Rückgangs des Zahlungsdienstes eine bestimmte E-Mail gesendet wurde.  Dies ist wiederum eine Überprüfung des Verhaltens des Systems in einer bestimmten Situation, die sicher in den technischen Anforderungen dafür aufgezeichnet ist, beispielsweise in der folgenden Form: "Senden Sie eine E-Mail an den Administrator, wenn die Zahlung nicht erfolgreich ist".  Wenn Sie dagegen ein Scheinobjekt verwenden, um einen Zahlungsdienst darzustellen, und die Arbeit beim Zugriff darauf überprüfen, indem Sie übertragen, was von ihm erwartet wird, werden wir über das Testen interner Mechanismen sprechen, die nicht direkt mit der Funktionalität der Anwendung zusammenhängen, und zwar ganz kann sich vielleicht oft ändern. <br><br><h4>  Folgen der Abweichung von den Empfehlungen </h4><br>  Bei jedem Code-Refactoring müssen Sie nach allen Moki, Refactoring und deren Code suchen.  Infolgedessen wird das Testen des Supports zu einer schweren Belastung, die sie zu Feinden des Entwicklers und nicht seiner Freunde macht. <br><br><h4>  Falscher Ansatz </h4><br>  Dieses Beispiel zeigt ein Scheinobjekt, das sich auf das Testen der internen Mechanismen der Anwendung konzentriert. <br><br><pre> <code class="javascript hljs">it(<span class="hljs-string"><span class="hljs-string">"When a valid product is about to be deleted, ensure data access DAL was called once, with the right product and right config"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> () =&gt; {   <span class="hljs-comment"><span class="hljs-comment">//,        const dataAccessMock = sinon.mock(DAL);   // ,           dataAccessMock.expects("deleteProduct").once().withArgs(DBConfig, theProductWeJustAdded, true, false);   new ProductService().deletePrice(theProductWeJustAdded);   mock.verify(); });</span></span></code> </pre> <br><h4>  Richtiger Ansatz </h4><br>  Spione zielen darauf ab, Systeme auf ihre Anforderungen zu testen, beeinflussen jedoch als Nebeneffekt unweigerlich die internen Mechanismen von Systemen. <br><br><pre> <code class="javascript hljs">it(<span class="hljs-string"><span class="hljs-string">"When a valid product is about to be deleted, ensure an email is sent"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> () =&gt; {   <span class="hljs-comment"><span class="hljs-comment">//,        const spy = sinon.spy(Emailer.prototype, "sendEmail");   new ProductService().deletePrice(theProductWeJustAdded);   //  .       ? ,               (  ) });</span></span></code> </pre> <br><h3>  <font color="#3AC1EF">▍6.</font>  <font color="#3AC1EF">Verwenden Sie während des Testens realistische Eingaben, die nicht auf „foo“ beschränkt sind.</font> </h3><br><h4>  Empfehlungen </h4><br>  Oft manifestieren sich Produktionsfehler in einer sehr spezifischen und sogar überraschenden Kombination von Umständen.  Dies bedeutet, dass die Wahrscheinlichkeit einer frühzeitigen Erkennung von Fehlern umso höher ist, je realistischer die während des Tests verwendeten Eingabedaten sind.  Verwenden Sie diese Option, um Daten zu generieren, die echten, spezialisierten Bibliotheken wie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Faker</a> ähneln.  Beispielsweise generieren solche Bibliotheken zufällige, aber realistische Telefonnummern, Benutzernamen, Bankkartennummern, Firmennamen und sogar „Lorem Ipsum“ -Texte.  Erwägen Sie außerdem, Daten aus Produktionsumgebungen in Tests zu verwenden.  Wenn Sie solche Tests auf ein noch höheres Niveau bringen möchten, lesen Sie unsere nächste Empfehlung zu eigenschaftsbasierten Tests. <br><br><h4>  Folgen der Abweichung von den Empfehlungen </h4><br>  Beim Testen eines Projekts während seiner Entwicklung können alle Tests nur bestanden werden, wenn sie mit unrealistischen Daten wie den Zeilen „foo“ ausgeführt werden.  Aber in der Produktion wird das System in einer Situation ausfallen, in der der Hacker ihr so ​​etwas wie <code>@3e2ddsf . ##' 1 fdsfds . fds432 AAAA</code> <code>@3e2ddsf . ##' 1 fdsfds . fds432 AAAA</code>  <code>@3e2ddsf . ##' 1 fdsfds . fds432 AAAA</code> . <br><br><h4>  Falscher Ansatz </h4><br>  Das System besteht diese Tests nur erfolgreich, weil sie unrealistische Daten verwenden. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> addProduct = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">name, price</span></span></span><span class="hljs-function">) =&gt;</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> productNameRegexNoSpace = <span class="hljs-regexp"><span class="hljs-regexp">/^\S*$/</span></span>;<span class="hljs-comment"><span class="hljs-comment">//  if(!productNameRegexNoSpace.test(name))   return false;// , -   ,  .     //  -    return true; }; it("Wrong: When adding new product with valid properties, get successful confirmation", async () =&gt; {   // "Foo",    ,    ,    false   const addProductResult = addProduct("Foo", 5);   expect(addProductResult).to.be.true;   // :     - ,     //         });</span></span></code> </pre> <br><h4>  Richtiger Ansatz </h4><br>  Es werden randomisierte Daten verwendet, die realen Daten ähnlich sind. <br><br><pre> <code class="javascript hljs">it(<span class="hljs-string"><span class="hljs-string">"Better: When adding new valid product, get successful confirmation"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> () =&gt; {   <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> addProductResult = addProduct(faker.commerce.productName(), faker.random.number());   <span class="hljs-comment"><span class="hljs-comment">//   : {'Sleek Cotton Computer',  85481}   expect(addProductResult).to.be.true;   //  ,         ,    .   //     ,    ! });</span></span></code> </pre> <br><h3>  <font color="#3AC1EF">▍ 7.</font>  <font color="#3AC1EF">Testen Sie Systeme mit mehreren Eingabekombinationen mithilfe von eigenschaftsbasierten Tests</font> </h3><br><h4>  Empfehlungen </h4><br>  In der Regel werden bei Tests kleine Sätze von Eingabedaten verwendet.  Selbst wenn sie realen Daten ähneln (darüber haben wir im vorherigen Abschnitt gesprochen), decken solche Tests nur eine sehr begrenzte Anzahl möglicher Kombinationen von Eingaben der untersuchten Entität ab.  Zum Beispiel könnte es so aussehen: <code>(method('', true, 1), method("string" , false" , 0))</code> . Das Problem ist, dass es in der Produktions-API, die mit fünf Parametern aufgerufen wird, abgerufen werden kann die Eingabe von Tausenden verschiedener Varianten ihrer Kombinationen, von denen eine zu einem Fehler führen kann (es wäre angebracht, sich hier an das <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Fuzzing</a> zu erinnern). Was wäre, wenn Sie einen einzelnen Test schreiben könnten, der automatisch eine bestimmte Methode auf 1000 Kombinationen ihrer Eingaben überprüft und herausfindet, welche Reagiert die Methode falsch? Das Testen auf der Grundlage der Eigenschaftsüberprüfung ist genau das, was  uns in einer solchen Situation ist nützlich. Das heißt, im Laufe dieser Kontrollen Test - Modul, es mit allen möglichen Kombinationen von Eingangsdaten aufrufen, die die Wahrscheinlichkeit des Findens ein paar Fehler erhöht. Angenommen , wir haben eine Methode <code>addNewProduct(id, name, isDiscount)</code> und Bibliothek Beim Durchführen von Tests wird es mit vielen Kombinationen von Parametern vom numerischen, Zeichenfolgen- und logischen Typ aufgerufen, z. B. <code>(1, "iPhone", false)</code> , <code>(2, "Galaxy", true)</code> .  Es ist möglich, Tests basierend auf der Eigenschaftsüberprüfung unter Verwendung der üblichen Testausführungsumgebung (Mocha, Jest usw.) und unter Verwendung spezieller Bibliotheken wie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">js-verify</a> oder <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">testcheck durchzuführen</a> (diese Bibliothek verfügt über eine sehr gute Dokumentation). <br><br><h4>  Folgen der Abweichung von den Empfehlungen </h4><br>  Der Entwickler wählt unbewusst solche Testdaten aus, die nur die Teile des Codes abdecken, die ordnungsgemäß funktionieren.  Leider verringert dies die Effektivität des Testens als Mittel zum Erkennen von Fehlern. <br><br><h4>  Richtiger Ansatz </h4><br>  Testen vieler Eingabemöglichkeiten mithilfe der Mokka-Testcheck-Bibliothek. <br><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'mocha-testcheck'</span></span>).install(); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> {expect} = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'chai'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> faker = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'faker'</span></span>); describe(<span class="hljs-string"><span class="hljs-string">'Product service'</span></span>, () =&gt; { describe(<span class="hljs-string"><span class="hljs-string">'Adding new'</span></span>, () =&gt; {   <span class="hljs-comment"><span class="hljs-comment">//  100         check.it('Add new product with random yet valid properties, always successful',     gen.int, gen.string, (id, name) =&gt; {       expect(addNewProduct(id, name).status).to.equal('approved');     }); }) });</span></span></code> </pre> <br><h3>  <font color="#3AC1EF">▍8.</font>  <font color="#3AC1EF">Bemühen Sie sich, dass der Testcode autark ist, und minimieren Sie externe Hilfsmittel und Abstraktionen</font> </h3><br><h4>  Empfehlungen </h4><br>  Es ist jetzt wahrscheinlich offensichtlich, dass ich mich extrem einfachen Tests verpflichtet fühle.  Tatsache ist, dass sich das Entwicklungsteam eines bestimmten Projekts ansonsten tatsächlich mit einem anderen Projekt befassen muss.  Um seinen Code zu verstehen, müssen sie wertvolle Zeit verbringen, die sie nicht so viel haben.  Über dieses Phänomen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ist</a> sehr gut geschrieben: „Ein qualitativ hochwertiger Produktionscode ist ein gut durchdachter Code, und ein qualitativ hochwertiger Testcode ist ein vollständig verständlicher Code. Wenn Sie einen Test schreiben, überlegen Sie, wer die von ihm angezeigte Fehlermeldung sehen wird.  Diese Person möchte nicht, um die Fehlerursachen zu verstehen, den Code der gesamten Testsuite oder den Code des Vererbungsbaums der zum Testen verwendeten Dienstprogramme lesen. “ <br><br>  Damit der Leser den Test verstehen kann, ohne seinen Code zu verlassen, sollten Sie bei der Durchführung des Tests die Verwendung von Dienstprogrammen, Hooks oder externen Mechanismen minimieren.  Wenn Sie dazu zu oft auf das Kopieren und Einfügen von Code zurückgreifen müssen, können Sie bei einem externen Hilfsmechanismus anhalten, dessen Verwendung die Verständlichkeit des Tests nicht beeinträchtigt.  Wenn jedoch die Anzahl solcher Mechanismen zunimmt, verliert der Testcode an Verständlichkeit. <br><br><h4>  Folgen der Abweichung von den Empfehlungen </h4><br>  ,      4  , 2      ,         ?  !         ,           ,        . <br><br><h4>   </h4><br>       .           ? <br><br><pre> <code class="javascript hljs">test(<span class="hljs-string"><span class="hljs-string">"When getting orders report, get the existing orders"</span></span>, () =&gt; {   <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> queryObject = QueryHelpers.getQueryObject(config.DBInstanceURL);   <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> reportConfiguration = ReportHelpers.getReportConfig();<span class="hljs-comment"><span class="hljs-comment">//   ?        userHelpers.prepareQueryPermissions(reportConfiguration);//  ?         const result = queryObject.query(reportConfiguration);   assertThatReportIsValid();//  ,           -    expect(result).to.be.an('array').that.does.include({id:1, productd:2, orderStatus:"approved"});   //      ?        })</span></span></code> </pre> <br><h4>  Richtiger Ansatz </h4><br>   ,        . <br><br><pre> <code class="javascript hljs">it(<span class="hljs-string"><span class="hljs-string">"When getting orders report, get the existing orders"</span></span>, () =&gt; {   <span class="hljs-comment"><span class="hljs-comment">// ,           const orderWeJustAdded = ordersTestHelpers.addRandomNewOrder();   const queryObject = newQueryObject(config.DBInstanceURL, queryOptions.deep, useCache:false);   const result = queryObject.query(config.adminUserToken, reports.orders, pageSize:200);   expect(result).to.be.an('array').that.does.include(orderWeJustAdded); })</span></span></code> </pre> <br><h3> <font color="#3AC1EF">▍9.        :      </font> </h3><br><h4>  Empfehlungen </h4><br>     ,      ,    , ,           .               .       ,        (    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> </a> )    .   —  ,     (  ,      ).      —    ,     ,   , ,   .    ,    ,                    .       —     , ,   ,       ,      (   , , ,        ). <br><br><h4>  Folgen der Abweichung von den Empfehlungen </h4><br> ,    .   .          .       .     ,     ,            ,       . <br><br><h4>   </h4><br>       .      ,    . <br><br><pre> <code class="javascript hljs">before(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-comment"><span class="hljs-comment">//       .   ? - ,  -   json-. await DB.AddSeedDataFromJson('seed.json'); }); it("When updating site name, get successful confirmation", async () =&gt; { // ,  ,  "Portal", ,           const siteToUpdate = await SiteService.getSiteByName("Portal"); const updateNameResult = await SiteService.changeName(siteToUpdate, "newName"); expect(updateNameResult).to.be(true); }); it("When querying by site name, get the right site", async () =&gt; { // ,  ,  "Portal", ,           const siteToCheck = await SiteService.getSiteByName("Portal"); expect(siteToCheck.name).to.be.equal("Portal"); //!      :[ });</span></span></code> </pre> <br><h4>  Richtiger Ansatz </h4><br>      ,   ,         . <br><br><pre> <code class="javascript hljs">it(<span class="hljs-string"><span class="hljs-string">"When updating site name, get successful confirmation"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> () =&gt; { <span class="hljs-comment"><span class="hljs-comment">//           const siteUnderTest = await SiteService.addSite({   name: "siteForUpdateTest" }); const updateNameResult = await SiteService.changeName(siteUnderTest, "newName"); expect(updateNameResult).to.be(true); });</span></span></code> </pre> <br><h3> <font color="#3AC1EF">▍10.     ,   .      expect</font> </h3><br><h4>  Empfehlungen </h4><br>         ,  ,      <code>try-catch-finally</code>         <code>catch</code> .   ,  ,         ,         . <br><br>            Chai,    <code>expect(method).to.throw</code> .     Jest: <code>expect(method).toThrow()</code> .         ,    .   ,     ,          . <br><br><h4>  Folgen der Abweichung von den Empfehlungen </h4><br>     ,   , ,             . <br><br><h4>   </h4><br>    ,            <code>try-catch</code> . <br><br><pre> <code class="javascript hljs">it(<span class="hljs-string"><span class="hljs-string">"When no product name, it throws error 400"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">async</span></span>() =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> errorWeExceptFor = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> result = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> addNewProduct({<span class="hljs-attr"><span class="hljs-attr">name</span></span>:<span class="hljs-string"><span class="hljs-string">'nest'</span></span>});} <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (error) { expect(error.code).to.equal(<span class="hljs-string"><span class="hljs-string">'InvalidInput'</span></span>); errorWeExceptFor = error; } expect(errorWeExceptFor).not.to.be.null; <span class="hljs-comment"><span class="hljs-comment">//    ,         //  ,     null,       });</span></span></code> </pre> <br><h4>  Richtiger Ansatz </h4><br>     <code>expect</code>   ,      ,      . <br><br><pre> <code class="javascript hljs">it.only(<span class="hljs-string"><span class="hljs-string">"When no product name, it throws error 400"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">async</span></span>() =&gt; { expect(addNewProduct)).to.eventually.throw(AppError).with.property(<span class="hljs-string"><span class="hljs-string">'code'</span></span>, <span class="hljs-string"><span class="hljs-string">"InvalidInput"</span></span>); });</code> </pre> <br><h3> <font color="#3AC1EF">▍11.   ,    </font> </h3><br><h4>  Empfehlungen </h4><br>       . ,        (smoke test),      -,    ,      .           -  .  ,        ,       ,      <code>#cold</code> , <code>#api</code> , <code>#sanity</code> .                    . ,  Mocha      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="></a> <code>-g</code> ( <code>--grep</code> ). <br><br><h4>  Folgen der Abweichung von den Empfehlungen </h4><br>   ,   ,       ,   ,         ,  ,       .        . <br><br><h4>  Richtiger Ansatz </h4><br>  <code>#cold-test</code>         ,       .        ,         -,  ,      —      . <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//    ( ,    ),     // ,        //   describe('Order service', function() { describe('Add new order #cold-test #sanity', function() {   it('Scenario - no currency was supplied. Expectation - Use the default currency #sanity', function() {     //-    }); }); });</span></span></code> </pre> <br><h3> <font color="#3AC1EF">▍12.        </font> </h3><br><h4>  Empfehlungen </h4><br>       ,   Node.js-.    ,  ,    Node.js  . <br><br>      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">TDD</a> —      ,     ,          .     ,       .       ,    ,    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Red-Green-Refactor</a> .   ,      - ,       , ,   ,     ,         .  ,            .        ( —   ,  ,   ). <br><br><h4>  Folgen der Abweichung von den Empfehlungen </h4><br>    —    ,       .      . <br><br><h2> <font color="#3AC1EF"> 2.  </font> </h2><br><h3> <font color="#3AC1EF">▍13.      ,        </font> </h3><br><h4>  Empfehlungen </h4><br>  ,    ,      10 ,     .     ,   .    ,         .   ,         (,    ),  ,    ,   ,     ?        - ? <br><br> ,    . ,  2019 ,  , TDD,   —          ,     . ,        ,    ,     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> </a>    . ,   IoT-, ,   ,    -  Kafka  RabbitMQ,      .      - , ,  ,       .     ,   ,      ,     ,       ?     (,   ,     Alexa)    ,   ,        . <br><br>       ,      (    ).    , ,           , ,   ,   ,     . ,  ,  -    API   —     Consumer-Driven Contracts    .   ,     , ,  ,    .  ,  ,       ,  ,    ,  .    ,  ,     . <br><br>    ,    TDD       .  ,  TDD     ,      .         ,  ,       ,  . <br><br><h4>  Folgen der Abweichung von den Empfehlungen </h4><br>          —       ( ),       . <br><br><h4>  Richtiger Ansatz </h4><br>       .  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="></a>   .  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="></a>  , ,   Node.js,      . <br><br><h3> <font color="#3AC1EF">▍14. ,       </font> </h3><br><h4>  Empfehlungen </h4><br>        .      —  .    ,       ,        .  ,     ,    - ,   ,   -    ?    ,   .      ,          :       TDD,   —       . <br><br>      «».    API,   -      ,    (,        , ,   ,   ,    ). ,  ,    ,      (,      ).  ,    ,   ,    ,   ,  ,   . <br><br><h4>  Folgen der Abweichung von den Empfehlungen </h4><br>    , ,      , ,        20. <br><br><h4>  Richtiger Ansatz </h4><br>   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">supertest</a> ,    API,    Express,         . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/286/bd8/02d/286bd802d29e7f6eb475567c97c9429d.png"></div><br> <i><font color="#999999"> API,   Express</font></i> <br><br><h3> <font color="#3AC1EF">▍15.       ,        API,   Consumer-Driven Contracts</font> </h3><br><h4>  Empfehlungen </h4><br> ,      ,  ,   ,        .  ,   ,  - ,    ,    ,  -    .  «-22»  :       .   ,     ,       .        ,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Consumer-Driven Contracts   PACT</a> . <br><br>       .       .  PACT        ,     (  «»).           ,   ,    PACT,    ,   ,      .        ,    ,   ,    ,       . <br><br><h4>  Folgen der Abweichung von den Empfehlungen </h4><br>             . <br><br><h4>  Richtiger Ansatz </h4><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c39/0ef/dcd/c390efdcd01b24f5089bf7160fd5c5c6.png"></div><br> <i><font color="#999999"> Consumer-Driven Contracts</font></i> <br><br>     ,  ,   B  ,     .  B         . <br><br><h3> <font color="#3AC1EF">▍16.     </font> </h3><br><h4>  Empfehlungen </h4><br>       (middleware) - ,        ,  - ,      Express-.        .   ,    ,         .    ,     ,   JS-  <code>{req,res}</code> .      ,      «» (,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Sinon</a> )  ,      <code>{req,res}</code> .  ,    ,    ,   .  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://www.npmjs.com/package/node-mocks-">node-mock-http</a>   , ,      ,         . ,     ,    HTTP-,   -. <br><br><h4>  Folgen der Abweichung von den Empfehlungen </h4><br>      Express       . <br><br><h4>  Richtiger Ansatz </h4><br>                 Express-. <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// ,     const unitUnderTest = require('./middleware') const httpMocks = require('node-mocks-http'); //  Jest,     Mocha    describe()  it() test('A request without authentication header, should return http status 403', () =&gt; { const request = httpMocks.createRequest({   method: 'GET',   url: '/user/42',   headers: {     authentication: ''   } }); const response = httpMocks.createResponse(); unitUnderTest(request, response); expect(response.statusCode).toBe(403); });</span></span></code> </pre> <br><h3> <font color="#3AC1EF">▍17.         </font> </h3><br><h4>  Empfehlungen </h4><br>         ,        , ,      , ,  ,  .     ,        ,      - .    ,     ,   ,           ( , ,   ),    ,        ( —   )      .       ,    : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">SonarQube</a> ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">2600</a>   GitHub)  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Code Climate</a> ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">1500</a> ). <br><br><h4>  Folgen der Abweichung von den Empfehlungen </h4><br>  ,     ,   .      .          ,         . <br><br><h4>  Richtiger Ansatz </h4><br>         Code Climate. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/cae/1fe/d5c/cae1fed5caf16576b4001dfe0235820c.png"></div><br> <i><font color="#999999">  Code Climate</font></i> <br><br><h3> <font color="#3AC1EF">▍18.     ,      Node.js</font> </h3><br><h4>  Empfehlungen </h4><br>        ,  ,     .    ,  ,    ,  -  ,   . ,    -      ,  ,  ,  ,  ?  ,  ,    ?   ,    API    ? <br><br>           Netflix   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> -</a> .    ,        ,    ,  ,              . ,      - — <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Chaos Monkey</a> .     ,        ,       ,       .      Kubernetes — <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">kube-monkey</a> .         ,                Node.js? ,         ,   ,     V8   1.7  .            .          <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">node-chaos</a> ,     -. <br><br><h4>  Folgen der Abweichung von den Empfehlungen </h4><br>      , ,     ,         . <br><br><h4>  Richtiger Ansatz </h4><br>   npm- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">chaos-monkey</a> ,            Node.js. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d24/162/bdb/d24162bdb8c2c430f9163a7eda8c6c32.png"></div><br> <i><font color="#999999"> chaos-monkey</font></i> <br><br><h2>  <font color="#3AC1EF">Zusammenfassung</font> </h2><br>         ,   Node.js-.  ,         .             . <br><br>  <b>Liebe Leser!</b>     -    ? <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de435462/">https://habr.com/ru/post/de435462/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de435450/index.html">Frohes Neues Jahr, Frohes Neues MQTT / UDP</a></li>
<li><a href="../de435452/index.html">End-to-End-Tests von Microservices mit Catcher</a></li>
<li><a href="../de435454/index.html">AOP vs Funktionen</a></li>
<li><a href="../de435456/index.html">Ist es schädlich, nachts ein Smartphone neben sich zu lassen?</a></li>
<li><a href="../de435460/index.html">Coworkidea Coworking Fototour (Barcelona)</a></li>
<li><a href="../de435464/index.html">Testen von Node.js-Projekten. Teil 2. Bewertung der Testleistung, kontinuierliche Integration und Analyse der Codequalität</a></li>
<li><a href="../de435466/index.html">React Tutorial Teil 6: Einige Funktionen des Kurses, JSX und JavaScript</a></li>
<li><a href="../de435468/index.html">React Tutorial Teil 7: Inline-Stile</a></li>
<li><a href="../de435470/index.html">React Tutorial, Teil 8: Fortsetzung der Arbeit an einer TODO-Anwendung, Einführung in die Komponenteneigenschaften</a></li>
<li><a href="../de435476/index.html">Mkcert: gültige HTTPS-Zertifikate für localhost</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>