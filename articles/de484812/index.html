<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏾‍⚖️ 👩‍❤️‍💋‍👨 📻 Meine Erfahrung mit Plesk 🌪️ 🔦 🤟🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ich möchte einige Eindrücke über die Notwendigkeit oder Unnötigkeit eines Control Panels für ein kommerzielles Einzelserver-Webprojekt mit einem sehr ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Meine Erfahrung mit Plesk</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/484812/">  Ich möchte einige Eindrücke über die Notwendigkeit oder Unnötigkeit eines Control Panels für ein kommerzielles Einzelserver-Webprojekt mit einem sehr teilzeitbeschäftigten Administrator teilen.  Die Geschichte begann vor ein paar Jahren, als Bekannte mich baten, den Kauf eines Geschäfts - einer Nachrichtenseite - aus technischer Sicht zu begleiten.  Es war notwendig, ein wenig zu verstehen, woran gearbeitet wurde, sicherzustellen, dass alle erforderlichen Details in der richtigen Form und Menge übertragen wurden, und strategisch herauszufinden, was verbessert werden könnte. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/h_/nh/e1/h_nhe1ce2n1r02nwfk-v2coszz0.png"></div><br>  Der Deal fand statt, der Geiger wurde nicht mehr gebraucht.  Das Ende  Nicht wirklich. <br><a name="habracut"></a><br>  Die Seite drehte sich auf einem Dual-Core-VMk mit 4 Gigabyte unter Linode, auf einem moosigen Debian5 mit einer Betriebszeit von 400 Tagen und einer solchen Liste nicht aktualisierter Pakete.  Webpart auf Samopisny TsMSke, Nginx, PHP5.3 FPM, MySQL abgestimmt Percona.  Im Prinzip hat es funktioniert. <br><br>  Parallel zu den Gesprächen mit mir suchte der neue Eigentümer einen Programmierer, um das Projekt zu verwirklichen.  Hab es gefunden.  Der Programmierer bewertete den Verkehr und das Volumen und entschied, dass er in der Lage war, das Kostenmanagement zu optimieren.  Er migrierte die gesamte Site auf ein 700-Rubel-Shared-Hosting unter der Kontrolle seines üblichen IS **** er.  Ein paar Tage später noch einmal ein Anruf vom Besitzer: "Alles verlangsamt sich und es scheint, als wären wir kaputt."  Ich habe versucht, die Situation über das Panel zu korrigieren, aber nach einigen erfolglosen Versuchen, die Version des PCP oder des Handlers von fcgi auf fpm zu ändern, habe ich aufgegeben und bin in die Shell geklettert.  Dort fand ich das mitgelieferte Debug, das im gesamten Internet mit einem Passwort von einem Muskel leuchtete, 777 auf einigen Ordnern, die zu diesem Zeitpunkt von einer Flut von Malvari und ähnlichen Spielen geknackt wurden.  Der Eigentümer erkannte und entschied, dass das Sparen von Hosting, Programmierer und Administrator, die mit einem Auge darauf schauen würden, wie die Dinge laufen, falsch ist. <br><br>  Wir gehen zu RuVDS.  Etwas näher als die britische Linode und wenn Sie plötzlich persönliche Daten speichern möchten, müssen Sie nirgendwo anders hin.  Da geplant war, das Projekt zu erweitern, nutzten sie die VMKU "zum Wachsen": 4 Kerne, 8 Gigabyte Speicher, 80 GB Festplatte.  Es ist nicht so, dass ich nicht weiß, wie man Nginx-Konfigurationen mit meinen Händen benutzt. Ich hatte einfach nicht die Begeisterung, dieses Projekt so intensiv durchzuführen (siehe oben über Teilzeit).  Weil - setzen Sie Plesk (hier werde ich die Installationsdetails weglassen, weil sie im Großen und Ganzen nicht da sind: Ich habe das Installationsprogramm gestartet, das Passwort für den Administrator festgelegt, den Schlüssel eingegeben - alles), damals war es 17.0.  Die Grundeinstellungen funktionieren einigermaßen, es gibt fail2ban und die neuesten verfügbaren Versionen von PHP, nginx. <br><br>  Wahrscheinlich lohnt es sich, anzuhalten und zu erklären, warum.  Da ich solche Dinge selten mache und keine speziellen Werkzeuge und Rohlinge für jeden Fall habe, war klar, dass eine Art Automatisierung grundlegender Dinge erforderlich war, erstens, schnell, zweitens, sicher und drittens, alle Best Practices hat jemand schon umgesetzt. <br><br>  Also setzen Sie.  Er sparte anständig Zeit, und der Neustart der Site auf dem neuen Server verlief fast augenblicklich.  Es blieb, um mit der Muskelkonfiguration zu fummeln, die Hälfte des Speichers bereitzustellen und die Anzahl der Pufferpools zu erhöhen, und Nginx die Hälfte der Kerne zuzuweisen (Splash berührt keine globalen Konfigurationen), und ein paar Tage lang in die Shell zu gehen, um die mysqltuner-Statistiken anzusehen.  Ja, und ich habe ein bezahltes ImunifyAV aus dem Erweiterungskatalog gekauft, um die überfluteten Malvari loszuwerden.  Es gab 11.000 infizierte Dateien.  Das Schlimme ist, dass verschleierte Codestücke in die Statik gegossen werden und das Bürsten mit den Händen völlig langweilig wäre.  Zuerst habe ich ClamAV ausprobiert, aber es stellte sich heraus, dass er solche Dinge nicht nahm, aber ImunifyAV konnte.  Darüber hinaus bleiben die ausgehärteten Dateien in einwandfreiem Zustand, nur ein Teil der Malware wird entfernt. <br><br>  Die Rechnung ist einfach: 50 US-Dollar pro Monat für VMKu, 10 US-Dollar für Splash (eigentlich weniger, weil Sie es sofort für ein Jahr mit einem Rabatt von zwei Monaten gekauft haben) und 3 US-Dollar für ein Virenschutzprogramm.  Oder eine Menge Geldkoffer für meine Zeit, die ich zuerst auf dem Server ausgeben würde, um diese Ställe manuell zu harken.  Der Besitzer ist sehr zufrieden mit dieser Ausrichtung. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bed/f5c/257/bedf5c257f2211a4c9a20db4f3662354.png"></div><br>  Inzwischen haben sie einen neuen Programmierer gefunden.  Wir einigten uns mit ihm auf die Verteilung der Verantwortung, erstellten eine Subdomain für die Testversion und begannen mit der Arbeit.  Er hat eine neue Version der Site auf Laravel gesehen, und ich habe mir fail2ban% angeschaut. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/567/ed3/0eb/567ed30eba271841e9ba2ca1628c908c.png"></div><br>  Interessanterweise hört der Strom der Neugierigen nicht auf, und die Liste der verbotenen Adressen enthält immer etwa hundert Adressen.  Der Effekt ist interessant: Insbesondere wenn ich in die Shell gehe, sehe ich normalerweise etwa 20000 - 30000 erfolglose Versuche, bei der Begrüßung über SSH einzutreten.  Bei eingeschaltetem fail2ban ca. 70. Investierter Aufwand: 0. Leider gab es einen Teertropfen.  Standardmäßig war WAF (Modsecurity) "halb aktiviert": im Erkennungsmodus.  Das heißt, er hat verdächtige Aktivitäten in das Protokoll geschrieben, aber tatsächlich nichts unternommen.  Und fail2ban las wahllos alle Protokolle gemäß den enthaltenen Gefängnissen und tränkte alles, was sich bewegte.  So haben wir die Hälfte der Redaktion gesperrt: D.  Ich musste dieses Gefängnis deaktivieren und die erforderlichen IP-Adressen aus Gründen der Zuverlässigkeit auf die weiße Liste setzen.  Der Aufwand ist groß: zweimal mit der Maus stecken und den Redakteuren beibringen, ihre IP-Adresse zu sagen. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e2a/59f/5d9/e2a59f5d93ccd9a0345d82631cfed146.png"></div><br>  Was dem Programmierer sofort gefiel, war die Möglichkeit, Datenbanken direkt im Panel hochzuladen und schnell auf phpMyAdmin zuzugreifen <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/cca/0ef/a51/cca0efa516535e771efaa46456b891b9.png"></div><br>  Was mir gefallen hat - Protokolle und Backups.  Protokolle werden automatisch geschrieben und gedreht.  Backups werden sehr einfach konfiguriert.  In der schleppendsten Zeit wird eine vollständige Sicherung durchgeführt, und zwar in 10 Gigs und dann eine Woche lang jeden Tag in inkrementellen 200 Megabyte.  Granulare Wiederherstellung in eine bestimmte Datei oder Datenbank.  Wenn Sie eine inkrementelle Wiederherstellung durchführen müssen, müssen Sie sich nicht erst mit der vollständigen Wiederherstellung der gesamten Kette befassen. Splash erledigt alles selbst.  Sie können Backups überall hochladen: auf FTP, auf Dropbox, S3 Bucket, Google Drive und mehr. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/9f1/46d/d83/9f146dd83e49e565596513bb1b32bea2.png"></div><br>  Tag F: Der Programmierer hat endlich die neue Engine fertiggestellt, wir haben sie in das Produkt gegossen, die alten Daten importiert und uns gesetzt, um die Farbe ihres zukünftigen Maserati zu wählen.  Wir wählen immer noch. <br><br>  Die ersten Probleme begannen.  Die neue Site war erwartungsgemäß schwerer als die alte, aber der eigentliche Grund war, dass Yandex.Zen unter anderem verwendet wurde, um Verkehr anzuziehen, der die Besucher in großen Mengen einholte.  Die Seite wurde bei 150 gleichzeitigen Verbindungen gebogen (ich spreche nicht von RPS, weil ich es nicht gemessen habe).  Im php_fpm-Einstellungsbereich haben wir angefangen, Knöpfe zu drücken und Knöpfe zu drehen: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8c0/f96/3b3/8c0f963b3771a9452e8dee1ea82ac6cc.png"></div><br>  Op, hält bereits 500 Verbindungen.  Wenn die Kreditkarte auf das Werbemittel angewendet wird, werden die Verkehrswellen größer.  Der nächste Meilenstein sind 1000 gleichzeitige Verbindungen.  Hier musste ich auf den Code verzichten und auf die Muskeln in meiner Seele schauen.  Der Spritzer hat nicht geholfen, aber sie haben es nicht wirklich erwartet.  Sie haben das langsame Abfrageprotokoll aktiviert, die Indizes in der Datenbank blockiert, unnötige Abfragen aus dem Code entfernt und die mysql-Konfiguration erneut auf Anraten von mysqltuner gekämmt. <br><br>  Neue Herausforderung - 2000 Verbindungen.  Gerade ist es gelungen, die Version Plesk 17.8 herauszubringen, in der unter anderem das Nginx-Caching verschraubt wurde.  Aktualisiert (überraschend einfach).  Wir versuchen es.  Es funktioniert  Und dann traten sie leise ein, der Yandex.Zen-Feed funktionierte nicht mehr.  Die Seite funktioniert, der Feed funktioniert nicht.  Der Feed funktioniert nicht, kein Verkehr.  Die Atmosphäre erwärmt sich.  Unter dem Druck der Umstände und mangelnder Vorstellungskraft stieg ich sofort zu Nginx und fand, wonach ich suchte.  Es stellte sich heraus, dass der dumme Nginx irgendwann den 500. Fehler als Reaktion auf die Yandex-Datei get feed.xml im Cache zwischengespeichert hat.  Korrigiert durch Hinzufügen von Ausnahmen zu den Cache-Einstellungen: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8c5/168/69b/8c516869b5e3fdb0ef6c79774d829940.png"></div><br>  Es ist klar, dass der Besitzer NOCH braucht, die Wellen nehmen langsam zu.  Während wir uns damit beschäftigen, haben wir aber schon im Vorfeld angefangen, mit memcached zu experimentieren, da Laravel es fast out of the box unterstützt.  Irgendwie wollte ich memcached nicht mit meinen Händen zum „Herumspielen“ bringen, also habe ich das Docker-Image installiert.  Direkt aus dem Panel. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/07e/083/342/07e083342590e63f033747c7dfe7f013.png"></div><br>  Nun, ich lüge, ich musste in die Hülle und das Modul durch Pecl stecken.  Direkt nach <a href="https://support.plesk.com/hc/en-us/articles/115001544133-Unable-to-install-memcached-PHP-module-memcached-support-requires-libmemcached">Anleitung</a> .  Über die Durchsatzsteigerung gibt es nichts zu sagen, es gab nicht genügend große Zuströme.  Die Site-Engine hat localhost gefunden: 11211, die Statistiken werden angezeigt, die Erinnerung frisst.  Wenn es Ihnen gefällt, lassen Sie uns sehen, was als nächstes zu tun ist.  Entweder lassen Sie es so oder setzen Sie das "Reale" direkt in die Achse.  Oder versuchen Sie es erneut auf die gleiche Weise <br><br>  Dann musste ich eine Mailingliste anhängen.  Keine Relais, nur SMTP-Authentifizierung.  Ich habe eine Postanschrift bekommen, durch die Angaben über PHP machen wir den Newsletter. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/107/53e/269/10753e269e8ea0736ba771a506e04c28.png"></div><br>  Vor nicht allzu langer Zeit erschien Plesk Obsidian (18.0), aktualisiert nach den bisherigen Erfahrungen ohne Angst.  Alles verlief reibungslos, es gibt nichts, worüber man reden könnte.  Von der angenehmen - die Schnittstelle hat sich in der Qualität stark verbessert, hat sich modernisiert und ist an einigen Stellen bequemer geworden.  Cooles Stück Advanced Monitoring auf Grafana. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/921/e9d/230/921e9d230ede253edc7e479a3a435c94.png"></div><br>  Ich habe es noch nicht herausgefunden, aber Sie können beispielsweise Warnungen für jeden Parameter in der E-Mail konfigurieren.  An den Besitzer, lol. <br><br>  Da ich über die Benutzeroberfläche spreche, ist sie anpassungsfähig und funktioniert sehr gut auf dem Telefon.  In der Anfangsphase, als wir versuchten, die optimalen PHP-Einstellungen und andere Dinge zu finden, hat es sehr geholfen.  Und vor allem, wenn ein Programmierer mit einem Anfall von Arbeitsbegeisterung um 23 Uhr etwas tut und ich in einem Anfall von Arbeitsbegeisterung Wodka in einem Bad trinke und DRINGEND etwas wechseln muss. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/865/dbc/dd9/865dbcdd9b452936c3450cae4067bbc9.png"></div><br>  Ach übrigens.  Auf dem Bild erschien PHP Composer.  Wir haben noch nicht mit ihm gespielt, aber zum Beispiel kann er für denselben Laravel ein paar Logins in der Shell und einige Zeit für die Installation von Abhängigkeiten sparen.  Das gleiche System gibt es für Node.JS und Ruby. <br><br>  Mit SSL ist alles einfach.  Wenn sich die Domain ändert, wo sie sich befinden soll, wird Let's Encrypt mit einem Klick ausgeführt und von selbst weiter aktualisiert, sowohl für die Domain selbst als auch für Subdomains und sogar für Mail-Dienste. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ffe/e59/c84/ffee59c848d2cdc814028a527fbeeda7.png"></div><br>  Plesk selbst ist als Software derzeit recht angenehm und stabil.  Aktualisiert sich selbst und die Achse ist leise, verbraucht wenig Ressourcen und läuft reibungslos.  Ich kann mich nicht einmal daran erinnern, dass ich irgendwo auf etwas getreten bin, was ein klarer Mangel am Produkt wäre.  Natürlich gab es Probleme, aber sie waren entweder auf eine fehlerhafte Konfiguration zurückzuführen oder befanden sich irgendwo an der Kreuzung. Es gab also nichts zu beanstanden.  Die Eindrücke der Arbeit mit Splash sind im Allgemeinen angenehm.  Was darin fehlt, und das muss man verstehen, ist ein beliebiges Clustering.  Weder LB noch HA.  Sie können es versuchen, aber es wird so viel Aufwand geben, dass es besser ist, zunächst etwas anderes zu tun. <br><br>  Ich denke, Sie können zusammenfassen.  Für den Fall, dass es keinen Administrator gibt oder dies nicht ausreicht, wenn der Preis für das Hosting und die darauf ausgeführte (n) Site (s) 100 cu überschreitet, wenn es sich nicht um den Viehanteil von 1.500 Sites auf dem Server handelt, wenn Sie sich vor dem Entscheidungsträger befinden Es lohnt sich, einen Administrator in Teilzeit zu engagieren oder Software zu kaufen und einen Administrator für „Half-Bumps“ zu erhalten, oder es überhaupt nicht zu starten - das ist auf jeden Fall sinnvoll.  Aus Sicht des Remote-Administrators - das Gleiche.  10 $ pro Monat und spart Zeit und gibt Flexibilität bei der Arbeit für eine sehr große Menge.  Wenn ich zum Beispiel dringend gebeten werde, ein ähnliches Projekt unter die Lupe zu nehmen, werde ich auf dem Transport nach Plesk bestehen. <br><br> <a href="https://ruvds.com/ru-rub/"><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de484812/">https://habr.com/ru/post/de484812/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de484798/index.html">Warum ist das schnelle Sortieren so langsam? Neue Array-Sortiermethode</a></li>
<li><a href="../de484800/index.html">Microsoft Application Inspector-Quellcodeanalyse</a></li>
<li><a href="../de484802/index.html">Selbstzerstörungsmodus: Zersetzung der endoskopischen Kapsel durch Licht</a></li>
<li><a href="../de484804/index.html">Was muss in einem Unternehmenssystem verschlüsselt werden? Und warum das machen?</a></li>
<li><a href="../de484806/index.html">Unterschied zwischen cPanel und Plesk Obsidian</a></li>
<li><a href="../de484814/index.html">6. Fortinet Getting Started v6.0. Webfilterung und Anwendungskontrolle</a></li>
<li><a href="../de484816/index.html">Verwenden von Operations Hooks zum Sichern von Dateien unter macOS im laufenden Betrieb</a></li>
<li><a href="../de484818/index.html">Das Buch "C ++. Die Praxis der Multithread-Programmierung "</a></li>
<li><a href="../de484820/index.html">FAQ.Net - ein kostenloses Notizenprogramm für Windows mit aktualisiertem Design</a></li>
<li><a href="../de484822/index.html">Blazor: Wie verhindert man, dass eine Komponente krank wird, oder wie trennt man Code vom Markup?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>