<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🕉️ 🔧 🎌 服务网格，“数据平面”和“控制平面”（服务网格数据平面与控制平面） 👨‍👩‍👦 👨🏻‍⚖️ ◼️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="哈Ha！ 我向您介绍了Matt Klein的文章“服务网格数据平面与控制平面”的翻译。 



 这次，我想要并翻译了服务网格，数据平面和控制平面这两个组件的描述。 在我看来，这种描述是最可理解和有趣的，而且最重要的是它导致了对“是否有必要？”的理解。 

 随着“服务网格”的想法在过去两年中（20...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>服务网格，“数据平面”和“控制平面”（服务网格数据平面与控制平面）</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/462699/"> 哈Ha！ 我向您介绍了<b>Matt Klein</b>的文章<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">“服务网格数据平面与控制平面”</a>的翻译。 <br><br><img src="https://habrastorage.org/webt/oa/ar/bu/oaarbu82bai5hzqqe0l2f-qeupg.png"><br><br> 这次，我想要并翻译了服务网格，数据平面和控制平面这两个组件的描述。 在我看来，这种描述是最可理解和有趣的，而且最重要的是它导致了对“是否有必要？”的理解。 <br><br> 随着“服务网格”的想法在过去两年中（2017年10月10日的原始文章）变得越来越流行，并且太空参与者的数量在增加，我看到整个技术社区在如何比较方面的困惑也相应增加并对比不同的解决方案。 <br><a name="habracut"></a><br> 我在7月撰写的以下一系列推文中最好地描述了这种情况： <br><blockquote> 与服务网格（服务网格）的混淆1：Linkerd〜= Nginx〜= Haproxy〜=特使。 他们都不等于Istio。  Istio是完全不同的东西。  1 / </blockquote><blockquote> 第一个只是数据平面。 他们自己什么也不做。 他们需要进行更多调整。  2 / </blockquote><blockquote>  Istio是将零件链接在一起的控制平面的示例。 这是一个不同的层。  /结束 </blockquote> 在先前的推文中，提到了几个不同的项目（Linkerd，NGINX，HAProxy，Envoy和Istio），但是更重要的是，介绍了数据平面，服务网格和控制平面的一般概念。 在这篇文章中，我将退后一步，在一个非常高的层次上讲出“数据平面”和“控制平面”这两个术语的含义，然后，我将讲述这些术语与所提到的项目之间的关系。在推文中。 <br><br><h1> 什么是服务网格（真的）？ </h1><br><img src="https://habrastorage.org/webt/3q/gw/dd/3qgwdd_ljaphirr4nlb9bdcghmc.png"><br>  <b>图1：服务网格概述</b> <br><br>  <b>图1</b>从最基本的角度说明了服务网格的概念。 有四个服务群集（AD）。 每个服务实例都与一个本地代理服务器关联。 来自单个应用程序实例的所有网络流量（HTTP，REST，gRPC，Redis等）都通过本地代理服务器传输到相应的外部服务群集。 因此，应用程序实例不了解整个网络，而只了解其本地代理。 实际上，分布式系统的网络远离该服务。 <br><br><h1> 数据平面 </h1><br> 在服务网格中，位于应用程序本地的代理服务器执行以下任务： <br><br><ul><li>  <b>服务发现</b> 您的应用程序可以使用哪些服务/服务/应用程序？ </li><li>  <b>健康检查</b> 服务发现返回的服务实例是否可操作并且准备接受网络流量？ 这可以包括主动（例如，检查/运行状况检查响应）或被动（例如，使用3个连续的5xx错误作为服务不正常状态的指示）运行状况检查。 </li><li>  <b>路由选择</b> 从REST服务接收到对“ / foo”的请求后，该请求应该发送到哪个服务集群？ </li><li>  <b>负载均衡</b> 在路由过程中选择了服务集群之后，应将请求发送到哪个服务实例？ 什么超时？ 断路有哪些设置？ 如果请求失败，是否应该重复？ </li><li>  <b>认证与授权</b> 对于传入请求，可以使用mTLS或其他某种机制对呼叫服务进行加密标识/授权吗？ 如果已识别/授权，是否允许在服务中调用请求的操作（端点），还是应该返回未经身份验证的响应？ </li><li>  <b>可观察性</b> 对于每个请求，应生成详细的统计信息，日志/日志和分布式跟踪数据，以便操作员可以了解分布式流量并在出现问题时进行调试。 </li></ul><br> 对于服务网络（服务网格）中的所有先前点，数据平面负责。 实际上，服务（sidecar）本地的代理是一个数据平面。 换句话说，数据平面负责有条件广播，转发和监视发送到服务或从服务发送的每个网络数据包。 <br><br><h1> 控制平面 </h1><br> 数据平面中的本地代理提供的网络抽象是神奇的（？）。 但是，代理实际上如何知道到服务B的“ / foo”路由？ 如何使用由代理请求填充的服务发现数据？ 如何配置负载平衡，超时，断路等设置？ 如何使用蓝/绿（蓝/绿）方法或流量逐渐转移的方法部署应用程序？ 谁设置系统范围的身份验证和授权设置？ <br><br> 以上所有项目均由服务网格的控制平面管理。  <i>控制平面接受一组无状态的隔离代理服务器，并将它们转变为分布式系统</i> 。 <br><br> 我认为许多技术人员发现数据平面和控制平面的概念混淆的原因是，对于大多数人来说，数据平面是熟悉的，而控制平面却是外来的/难以理解的。 我们与物理网络路由器和交换机长期合作。 我们知道包/请求必须从A点到B点，并且我们可以为此使用硬件和软件。 新一代的软件代理仅仅是我们使用了很长时间的工具的流行版本。 <br><br><img src="https://habrastorage.org/webt/ty/xa/re/tyxareqql4_ndfv1unsjrh0fx78.png"><br>  <b>图2：人机界面</b> <br><br> 但是，尽管大多数网络运营商可能不会将系统的这一部分与任何技术组件相关联，但我们长期以来一直使用控制平面。 原因很简单： <br>  <b>今天使用的大多数控制飞机是...我们</b> 。 <br><br>  <b>图2</b>显示了我所谓的“人类控制平面”。 在这种仍然非常普遍的部署类型中，操作员（可能很脾气）可能会创建静态配置（可能使用脚本），并使用某种特殊过程在所有代理上部署它们。 然后，代理开始使用此配置，并开始使用更新的设置来处理数据平面。 <br><br><img src="https://habrastorage.org/webt/nm/tj/dt/nmtjdtcwt4e22o_ow0gjns7sv9c.png"><br>  <b>图3：高级服务网格控制平面</b> <br><br>  <b>图3</b>显示了服务网格的“扩展”控制平面。 它由以下部分组成： <br><br><ul><li>  <b>人类</b> ：仍然有一个人（希望减少生气）对整个系统做出高层决策。 </li><li>  <b>控制平面UI</b> ：一个人与某种类型的用户界面进行交互以控制系统。 它可以是Web门户，命令行应用程序（CLI）或其他界面。 使用用户界面，操作员可以访问以下全局系统配置参数： <br><ul><li> 部署管理，蓝色/绿色和/或逐步的流量转移 </li><li> 身份验证和授权设置 </li><li> 路由表规范，例如，当应用程序A请求有关“ / foo”的信息时，会发生什么情况 </li><li> 负载平衡器设置，例如超时，重试，断路参数等。 </li></ul></li><li>  <b>Workload Scheduler</b> ：通过某种类型的计划/编排系统（例如Kubernetes或Nomad）在基础架构中启动服务。 调度程序负责将服务及其本地代理服务器一起加载。 </li><li>  <b>服务发现</b> 调度程序启动和停止服务实例时，会将运行状况报告给服务发现系统。 </li><li>  <b>Sidecar代理配置API</b> ：本地代理根据“最终一致”模型从系统的各个组件动态提取状态，而无需操作员干预。 整个系统由当前正在运行的所有服务实例和本地代理服务器组成，最终融合为一个生态系统。  Envoy数据平面API是在实践中如何工作的一个示例。 </li></ul><br> 本质上，控制平面的目标是建立最终将被数据平面采用的策略。 如果它们能正常工作，那么更高级的控制平面将使操作员从某些系统上卸下更多的部件，并且需要较少的手动控制！ <br><br><h1> 数据平面和控制平面。 数据平面与控制平面摘要 </h1><br><ul><li>  <b>服务网格数据平面</b> ：影响系统中的每个数据包/请求。 负责应用程序/服务发现，运行状况检查，路由，负载平衡，身份验证/授权和可观察性。 </li><li>  <b>服务网格控制平面</b> ：为服务网络内的所有工作数据平面提供策略和配置。 请勿触摸系统中的任何数据包/请求。 控制平面将所有数据平面转换为分布式系统。 </li></ul><br><h1> 当前项目前景 </h1><br> 弄清楚上面的解释后，我们来看一下“服务网格”项目的当前状态。 <br><br><ul><li>  <b>数据平面</b> ：Linkerd，NGINX，HAProxy，Envoy，Traefik </li><li>  <b>控制平面</b> ：Istio，Nelson，SmartStack </li></ul><br> 我将不对上述每个解决方案进行深入分析，而是简要介绍一些我认为目前会造成生态系统混乱的问题。 <br><br> 在2016年初，Linkerd是用于服务网格的数据平面的首批代理服务器之一，并且在提高意识和增加对服务网格设计模型的关注方面做得非常出色。 此后约6个月，Envoy加入了Linkerd（尽管他自2015年底以来一直在Lyft工作）。  Linkerd和Envoy是讨论服务网络时最常提及的两个项目。 <br><br>  Istio于2017年5月宣布。  Istio项目的目标与<b>图3中</b>所示的扩展控制平面非常相似。  Envoy for Istio是默认的代理服务器。 因此，Istio是控制平面，Envoy是数据平面。 在很短的时间内，Istio引起了很多动荡，其他数据平面开始集成以替代Envoy（Linkerd和NGINX都展示了与Istio的集成）。 您可以在同一控制平面中使用不同的数据平面这一事实意味着，控制平面和数据平面不一定紧密相关。 诸如Envoy通用数据平面API之类的API可以在系统的两个部分之间形成桥梁。 <br><br>  Nelson和SmartStack帮助进一步说明控制平面和数据平面的分离。 纳尔逊使用Envoy作为其代理，并基于HashiCorp堆栈（即E. 游牧民族等  SmartStack也许是新一波服务网络浪潮中的第一个。  SmartStack在HAProxy或NGINX周围形成一个控制平面，展示了将控制平面与服务网格和数据平面分离的能力。 <br><br> 具有服务网格的微服务架构吸引了更多关注（对！），并且越来越多的项目和供应商开始朝这个方向努力。 在接下来的几年中，我们将在数据平面和控制平面上看到许多创新，以及各种组件的进一步融合。 最终，微服务架构对于操作员来说应该变得更加透明和神奇（？）。 <br> 希望越来越烦。 <br><br><h1> 重点（要点） </h1><br><ul><li> 服务网格（服务网格）由两个不同的部分组成：数据平面和控制平面。 这两个组件都是必需的，没有它们，系统将无法运行。 </li><li> 每个人都熟悉控制平面，现在您可以成为控制平面！ </li><li> 所有数据平面在功能，性能，可配置性和可扩展性上相互竞争。 </li><li> 所有控制平面在功能，可配置性，可扩展性和可用性方面都存在竞争。 </li><li> 单个控制平面可以包含正确的抽象和API，以便可以使用多个数据平面。 </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN462699/">https://habr.com/ru/post/zh-CN462699/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN462689/index.html">DISKOBALL：HDD投掷比赛，8月23日，莫斯科</a></li>
<li><a href="../zh-CN462691/index.html">使用Zimbra时如何从AD迁移到LDAP</a></li>
<li><a href="../zh-CN462693/index.html">以PSKOV静态站点生成器为例，在持久应用中</a></li>
<li><a href="../zh-CN462695/index.html">材质作为WebComponents</a></li>
<li><a href="../zh-CN462697/index.html">uWSGI帮助指标。 Yandex报告</a></li>
<li><a href="../zh-CN462701/index.html">AVR微控制器的汇编代码生成器库。 第二部分</a></li>
<li><a href="../zh-CN462703/index.html">俄罗斯“最便宜”旋转门由智能手机控制</a></li>
<li><a href="../zh-CN462705/index.html">我的ReactJS应用程序中的前5个错误</a></li>
<li><a href="../zh-CN462707/index.html">Kubernetes启动应用程序开发人员工具</a></li>
<li><a href="../zh-CN462709/index.html">PHP中的变异测试：对代码覆盖率的定性度量</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>