<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üïµüèæ üë®üèø‚ÄçüöÄ üëáüèº Mecanismo de Submiss√£o - Magia Cubana Especial üí£ üïµüèø üôÖüèæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Views, ou views, √© um dos conceitos da plataforma CUBA, n√£o o mais comum no mundo das estruturas da web. Entender isso significa evitar erros est√∫pido...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Mecanismo de Submiss√£o - Magia Cubana Especial</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/haulmont/blog/425765/"><p><img src="https://habrastorage.org/webt/ro/89/bc/ro89bcf9p8amjxin9ca0ksoctf8.jpeg" alt="CPAP"></p><br><p>  Views, ou views, √© um dos conceitos da plataforma CUBA, n√£o o mais comum no mundo das estruturas da web.  Entender isso significa evitar erros est√∫pidos quando, devido ao carregamento incompleto de dados, o aplicativo para de funcionar repentinamente.  Vamos ver o que s√£o representa√ß√µes (trocadilhos) e por que √© realmente conveniente. </p><br><h3 id="problema-nezagruzhennyh-dannyh">  O problema dos dados descarregados </h3><br><p>  Vamos simplificar uma √°rea de assunto e considerar o problema usando seu exemplo.  Suponha que tenhamos uma entidade <em>Customer</em> que se refira a uma entidade <em>CustomerType</em> em um relacionamento muitos-para-um, ou seja, o comprador tenha um link para um determinado tipo que a descreva: por exemplo, "cash cow", "snapper" etc.  A entidade <em>CustomerType</em> possui um atributo de <em>nome</em> no qual o nome do tipo est√° armazenado. </p><br><p>  E, provavelmente, todos os rec√©m-chegados (ou mesmo usu√°rios avan√ßados) no CUBA, mais cedo ou mais tarde, receberam este erro: </p><br><p><code>IllegalStateException: Cannot get unfetched attribute [type] from detached object com.rtcab.cev.entity.Customer-e703700d-c977-bd8e-1a40-74afd88915af [detached].</code> </p> <br><p><img src="https://habrastorage.org/webt/-x/ss/fm/-xssfm8nzwvf86jcicyrelm5nby.png" alt="N√£o √© poss√≠vel obter erro de atributo n√£o recuperado na interface do usu√°rio do CUBA"></p><br><p>  Admita, voc√™ tamb√©m viu com seus pr√≥prios olhos?  Eu - sim, em uma centena de situa√ß√µes diferentes.  Neste artigo, examinaremos a causa desse problema, por que ele existe e como resolv√™-lo. <br>  Para iniciantes, uma pequena introdu√ß√£o ao conceito de visualiza√ß√µes. </p><br><h3 id="chto-takoe-predstavlenie">  O que √© uma vis√£o? </h3><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Uma exibi√ß√£o</a> no CUBA √© essencialmente uma cole√ß√£o de colunas em um banco de dados que deve ser carregado juntos em uma √∫nica consulta. </p><a name="habracut"></a><br><p>  Suponha que desejemos criar uma interface do usu√°rio com uma tabela de clientes, em que a primeira coluna seja o nome do cliente e a segunda seja o nome do tipo do atributo <em>customerType</em> (como na captura de tela acima).  √â l√≥gico supor que nesse modelo de dados teremos duas tabelas separadas no banco de dados, uma para a entidade <em>Cliente</em> e outra para <em>CustomerType</em> .  A <code>SELECT * from CEV_CUSTOMER</code> retornar√° dados de apenas uma tabela ( <code>name</code> atributo, etc.).  Obviamente, para obter dados tamb√©m de outras tabelas, usaremos JOINs. </p><br><p>  No caso de usar consultas SQL cl√°ssicas usando JOIN, a hierarquia de associa√ß√µes (atributos de refer√™ncia) se expande do gr√°fico para uma lista simples. <br>  <em>Nota do tradutor: em</em> outras palavras, as rela√ß√µes entre as tabelas s√£o apagadas e o resultado √© apresentado em uma √∫nica matriz de dados que representa a uni√£o das tabelas. </p><br><p>  No caso do CUBA, √© utilizado o ORM, que n√£o perde informa√ß√µes sobre relacionamentos entre entidades e apresenta o resultado de consultas na forma de um gr√°fico integral dos dados solicitados.  Nesse caso, o JPQL, um an√°logo de objeto do SQL, √© usado como a linguagem de consulta. </p><br><p>  No entanto, os dados ainda precisam ser descarregados de alguma forma do banco de dados e transformados em um gr√°fico de entidade.  Para isso, o mecanismo de mapeamento objeto-relacional (que √© o JPA) possui duas abordagens principais para consultas ao banco de dados. </p><br><h3 id="lazy-loading-vs-eager-fetching">  Carregamento lento vs.  busca ansiosa </h3><br><p>  Carregamento lento e carregamento ganancioso s√£o duas estrat√©gias poss√≠veis para obter dados do banco de dados.  A diferen√ßa fundamental entre os dois √© quando os dados das tabelas vinculadas s√£o carregados.  Um pequeno exemplo para uma melhor compreens√£o: </p><br><p>  Lembra-se da cena do livro "O Hobbit, ou Viagem de ida e volta", em que um grupo de gnomos na companhia de Gandalf e Bilbo est√° tentando pedir uma noite na casa de Beorn?  Gandalf ordenou que os an√µes aparecessem estritamente e s√≥ depois que ele concordou cuidadosamente com Beorn e come√ßou a apresent√°-los um de cada vez para n√£o chocar o propriet√°rio pela necessidade de acomodar 15 convidados de uma s√≥ vez. </p><br><p><img src="https://habrastorage.org/webt/ys/pm/ql/yspmqlsytd5vmefxszi9xeqqduc.jpeg" alt="Gandalf e os an√µes na casa de Beorn"></p><br><p>  Ent√£o, Gandalf e os gnomos na casa de Beorn ... Essa provavelmente n√£o √© a primeira coisa que vem √† mente quando se pensa em downloads pregui√ßosos e gananciosos, mas h√° definitivamente semelhan√ßas.  Gandalf agiu sabiamente aqui, pois estava ciente das limita√ß√µes.  Pode-se dizer que ele escolhe conscientemente o carregamento lento dos gnomos, pois entendeu que o download de todos os dados ao mesmo tempo seria uma opera√ß√£o muito pesada para esse banco de dados.  No entanto, ap√≥s o 8¬∫ gnomo, Gandalf mudou para um carregamento ganancioso e carregou v√°rios gnomos restantes, porque percebeu que chamadas muito freq√ºentes para o banco de dados come√ßam a torn√°-lo menos irritante. </p><br><p>  A moral √© que tanto o carregamento pregui√ßoso quanto o ganancioso t√™m seus pr√≥s e contras.  O que aplicar em cada situa√ß√£o espec√≠fica, voc√™ decide. </p><br><h3 id="problema-zaprosa-n1">  Problema de solicita√ß√£o N + 1 </h3><br><p>  O problema de consulta N + 1 geralmente surge se voc√™ estiver usando o carregamento lento sem pensar em onde quer que v√°.  Para ilustrar, vejamos um peda√ßo do c√≥digo Grails.  Isso n√£o significa que no Grails tudo carregue pregui√ßosamente (na verdade, voc√™ mesmo escolhe o m√©todo de inicializa√ß√£o).  No Grails, por padr√£o, uma consulta ao banco de dados retorna inst√¢ncias de entidade com todos os atributos de sua tabela.  Essencialmente, <code>SELECT * FROM Pet</code> √© executado. </p><br><p>  Se voc√™ deseja aprofundar as rela√ß√µes entre entidades, deve faz√™-lo ap√≥s o factum.  Aqui est√° um exemplo: </p><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">function</span></span> getPetOwnerNamesForPets(String nameOfPet) { def pets = Pet.findAll(sort:"name") { <span class="hljs-type"><span class="hljs-type">name</span></span> == nameOfPet } def ownerNames = [] pets.<span class="hljs-keyword"><span class="hljs-keyword">each</span></span> { ownerNames &lt;&lt; it.<span class="hljs-keyword"><span class="hljs-keyword">owner</span></span>.name } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ownerNames.<span class="hljs-keyword"><span class="hljs-keyword">join</span></span>(", ") }</code> </pre> <br><p>  O gr√°fico √© <code>it.owner.name</code> aqui por uma √∫nica linha: <code>it.owner.name</code> .  Propriet√°rio √© um relacionamento que n√£o foi carregado na solicita√ß√£o original ( <code>Pet.findAll</code> ).  Assim, toda vez que essa linha for chamada, o GORM far√° algo como <code>SELECT * FROM Person WHERE id='‚Ä¶'</code> .  Carga pregui√ßosa em √°gua pura. </p><br><p>  Se voc√™ calcular o n√∫mero total de consultas SQL, obt√©m N (um propriet√°rio para cada chamada <code>it.owner</code> ) + 1 (para o <code>Pet.findAll</code> original).  Se voc√™ quiser se aprofundar no gr√°fico de entidades relacionadas, √© prov√°vel que seu banco de dados encontre rapidamente seus limites. </p><br><p>  Como desenvolvedor, √© improv√°vel que voc√™ perceba isso, porque, do seu ponto de vista, voc√™ est√° apenas percorrendo o gr√°fico de objetos.  Esse aninhamento oculto em uma linha curta causa problemas reais ao banco de dados e torna o carregamento lento, √†s vezes, perigoso. </p><br><p>  Desenvolvendo uma analogia de hobby, o problema do N + 1 pode se manifestar da seguinte forma: imagine que Gandalf n√£o consiga armazenar os nomes dos gnomos em sua mem√≥ria.  Portanto, apresentando os an√µes um a um, ele √© for√ßado a voltar ao seu grupo e pedir ao an√£o seu nome.  Com essas informa√ß√µes, ele volta para Beorn e representa Thorin.  Ent√£o ele repete essa manobra para Bifur, Bofur, Fili, Kili, Dori, Nori, Ori, Oin, Gloyn, Balin, Dvalin e Bombur. </p><br><p><img src="https://habrastorage.org/webt/fw/g_/vs/fwg_vscjob0zb0yzrn7dhrj2o_s.jpeg" alt="An√µes N + 1 Problema"></p><br><p>  √â f√°cil imaginar que seria improv√°vel que tal cen√°rio acontecesse: qual destinat√°rio gostaria de esperar as informa√ß√µes solicitadas por tanto tempo?  Portanto, voc√™ n√£o deve usar essa abordagem sem pensar e confiar cegamente nas configura√ß√µes padr√£o do seu mapeador de persist√™ncia. </p><br><h3 id="reshaem-problemu-zaprosov-n1-s-pomoschyu-cuba-views">  Resolvendo o problema de consultas N + 1 usando visualiza√ß√µes CUBA </h3><br><p>  No CUBA, voc√™ provavelmente nunca encontrar√° o problema de consulta N + 1, j√° que a plataforma decidiu n√£o usar carregamento oculto lento.  Em vez disso, o CUBA introduziu o conceito de representa√ß√µes.  As visualiza√ß√µes s√£o uma descri√ß√£o de quais atributos devem ser selecionados e carregados junto com as inst√¢ncias da entidade.  Algo como </p><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> pet.name, person.name <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> Pet pet <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> Person person <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> pet.owner == person.id</code> </pre> <br><p>  Por um lado, a exibi√ß√£o descreve as colunas que precisam ser carregadas da tabela principal ( <em>Pet</em> ) (em vez de carregar todos os atributos por meio de *); por outro lado, descreve as colunas que devem ser carregadas das tabelas c-JOIN. </p><br><p>  Voc√™ pode imaginar a visualiza√ß√£o CUBA como a visualiza√ß√£o SQL do OR-Mapper: o princ√≠pio de opera√ß√£o √© aproximadamente o mesmo. </p><br><p>  Na plataforma CUBA, voc√™ n√£o pode invocar uma consulta atrav√©s do DataManager sem usar a visualiza√ß√£o.  A documenta√ß√£o fornece um exemplo: </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Inject</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> DataManager dataManager; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> Book </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loadBookById</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(UUID bookId)</span></span></span><span class="hljs-function"> </span></span>{ LoadContext&lt;Book&gt; loadContext = LoadContext.create(Book.class) .setId(bookId).setView(<span class="hljs-string"><span class="hljs-string">"book.edit"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> dataManager.load(loadContext); }</code> </pre> <br><p>  Aqui queremos fazer o download do livro por seu ID.  O <code>setView("book.edit")</code> , ao criar um contexto de carregamento, indica com qual exibi√ß√£o o livro deve ser carregado no banco de dados.  Caso voc√™ n√£o seja aprovado, o gerenciador de dados usa uma das tr√™s visualiza√ß√µes padr√£o que cada entidade possui: a <em>_local view</em> .  Local aqui refere-se a atributos que n√£o fazem refer√™ncia a outras tabelas, tudo √© simples. </p><br><h3 id="reshenie-problemy-s-illegalstateexception-cherez-views">  Resolvendo o problema com IllegalStateException atrav√©s de visualiza√ß√µes </h3><br><p>  Agora que temos um pouco de compreens√£o do conceito de representa√ß√µes, voltemos ao primeiro exemplo desde o in√≠cio do artigo e tentemos evitar a exce√ß√£o. </p><br><p>  A mensagem <em>IllegalStateException: N√£o √© poss√≠vel obter o atributo n√£o recuperado [] do objeto desanexado</em> significa apenas que voc√™ est√° tentando exibir algum atributo que n√£o est√° inclu√≠do na exibi√ß√£o com a qual a entidade est√° carregada. </p><br><p>  Como voc√™ pode ver, no descritor da tela de navega√ß√£o, usei a <em>visualiza√ß√£o _local</em> , e este √© o problema: </p><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dsContext</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupDatasource</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"customersDs"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.rtcab.cev.entity.Customer"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">view</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"_local"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">query</span></span></span><span class="hljs-tag">&gt;</span></span> &lt;![CDATA[select e from cev$Customer e]]&gt; <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">query</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupDatasource</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dsContext</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Para se livrar do erro, primeiro voc√™ precisa incluir o tipo de cliente na exibi√ß√£o.  Como n√£o podemos alterar a exibi√ß√£o padr√£o de <em>_local</em> , podemos criar a nossa.  No Studio, isso pode ser feito, por exemplo, da seguinte forma (clique com o bot√£o direito do mouse em entidades&gt; criar exibi√ß√£o): </p><br><p><img src="https://habrastorage.org/webt/ki/oz/vy/kiozvyydas04xj9ypswst8afvxo.png" alt="Criando uma exibi√ß√£o no Studio"></p><br><p>  diretamente no descritor <a href="">views.xml</a> do nosso aplicativo: </p><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">view</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.rtcab.cev.entity.Customer"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">extends</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"_local"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"customer-view"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">property</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"type"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">view</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"_minimal"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">view</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Depois disso, alteramos o link para a visualiza√ß√£o na tela de navega√ß√£o, assim: </p><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupDatasource</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"customersDs"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.rtcab.cev.entity.Customer"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">view</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"customer-view"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">query</span></span></span><span class="hljs-tag">&gt;</span></span> &lt;![CDATA[select e from cev$Customer e]]&gt; <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">query</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupDatasource</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Isso resolve completamente o problema e agora os dados do link s√£o exibidos na tela de visualiza√ß√£o do cliente. </p><br><h3 id="predstavlenie-_minimal-i-ponyatie-instance-name">  _Minimal view e nome da inst√¢ncia </h3><br><p>  O que mais vale a pena mencionar no contexto de visualiza√ß√µes √© a vis√£o <em>_minimal</em> .  A visualiza√ß√£o local tem uma defini√ß√£o muito clara: inclui todos os atributos da entidade, que s√£o atributos diretos da tabela (que n√£o s√£o chaves estrangeiras). </p><br><p>  A defini√ß√£o de uma representa√ß√£o m√≠nima n√£o √© t√£o √≥bvia, mas tamb√©m bastante clara. </p><br><p>  CUBA tem o conceito de um nome de inst√¢ncia de entidade - nome da inst√¢ncia.  O nome da inst√¢ncia √© equivalente ao <code>toString()</code> no bom e velho Java.  Esta √© uma representa√ß√£o em cadeia de uma entidade para exibi√ß√£o em uma interface do usu√°rio e para uso em links.  O nome da inst√¢ncia √© definido usando a anota√ß√£o da entidade <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">NamePattern</a> . </p><br><p>  √â usado assim: <code>@NamePattern("%s (%s)|name,code")</code> .  Temos dois resultados: </p><br><h4 id="imya-ekzemplyara-opredelyaet-otobrazhenie-suschnosti-v-ui">  O nome da inst√¢ncia define o mapeamento da entidade para a interface do usu√°rio </h4><br><p>  Primeiro, o nome da inst√¢ncia determina o que e em que ordem ser√° exibida na interface do usu√°rio se uma entidade se referir a outra entidade (como <em>Customer</em> se refere a <em>CustomerType</em> ). </p><br><p>  No nosso caso, o tipo de cliente ser√° exibido como o nome da inst√¢ncia <em>CustomerType</em> , √† qual o c√≥digo √© adicionado aos colchetes.  Se o nome da inst√¢ncia n√£o estiver definido, o nome da classe da entidade e o ID da inst√¢ncia espec√≠fica ser√£o exibidos - concorde que isso n√£o √© exatamente o que o usu√°rio gostaria de ver.  Veja as capturas de tela antes e depois abaixo para ver exemplos de ambos os casos. </p><br><p><img src="https://habrastorage.org/webt/wa/gd/u8/wagdu8lfbckngwhi2swjhgj8mxe.png" alt="Refer√™ncia a uma entidade para a qual nenhum nome de inst√¢ncia foi especificado"></p><br><p><img src="https://habrastorage.org/webt/uy/7f/ok/uy7fokvhqcl9m5jx0ui1ju2v4l0.png" alt="Uma refer√™ncia de entidade com o nome da inst√¢ncia fornecida"></p><br><h4 id="imya-ekzemplyara-opredelyaet-atributy-minimalnogo-predstavleniya">  O nome da inst√¢ncia define atributos m√≠nimos de exibi√ß√£o </h4><br><p>  A segunda coisa que a anota√ß√£o NamePattern afeta √©: todos os atributos especificados ap√≥s a barra vertical formam automaticamente uma exibi√ß√£o <em>_minimal</em> .  √Ä primeira vista, isso parece √≥bvio, porque os dados de alguma forma precisam ser exibidos na interface do usu√°rio, o que significa que voc√™ deve primeiro baix√°-los do banco de dados.  Embora, para ser sincero, raramente pense nesse fato. </p><br><p>  √â importante observar aqui que a representa√ß√£o m√≠nima, se comparada com a local, pode conter refer√™ncias a outras entidades.  Por exemplo, para o comprador do exemplo acima, defino um nome de inst√¢ncia, que inclui um atributo local da entidade <em>Cliente</em> ( <code>name</code> ) e um atributo de refer√™ncia ( <code>type</code> ): </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@NamePattern</span></span>(<span class="hljs-string"><span class="hljs-string">"%s - %s|name,type"</span></span>)</code> </pre> <br><p>  A representa√ß√£o m√≠nima pode ser usada recursivamente: (Cliente [Nome da Inst√¢ncia] -&gt; CustomerType [Nome da Inst√¢ncia]) </p><br><p>  <em>Nota do tradutor:</em> desde a publica√ß√£o do artigo, outra exibi√ß√£o do sistema apareceu - <code>_base</code> view, que inclui todos os atributos locais que n√£o s√£o do sistema e atributos especificados na anota√ß√£o @NamePattern (ou seja, <code>_minimal</code> + <code>_local</code> ). </p><br><h3 id="zaklyuchenie">  Conclus√£o </h3><br><p>  Em conclus√£o, resumimos o t√≥pico mais importante.  Gra√ßas √†s visualiza√ß√µes, no CUBA, podemos indicar explicitamente o que deve ser carregado no banco de dados.  As visualiza√ß√µes determinam o que ser√° carregado com avidez, enquanto a maioria das outras estruturas realiza secretamente um carregamento lento. </p><br><p>  As representa√ß√µes podem parecer um mecanismo complicado, mas a longo prazo elas se justificam. </p><br><p>  Espero ter conseguido explicar de maneira acess√≠vel o que realmente s√£o essas vis√µes misteriosas.  Obviamente, existem cen√°rios mais avan√ßados para seu uso, bem como armadilhas ao trabalhar com representa√ß√µes em geral e com representa√ß√µes m√≠nimas em particular, mas vou escrever sobre isso em um post separado de alguma forma. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt425765/">https://habr.com/ru/post/pt425765/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt425753/index.html">RIP do Google+</a></li>
<li><a href="../pt425755/index.html">Desenvolvimento: New Generation Messenger (Parte 3). Aplicativos para desktop</a></li>
<li><a href="../pt425759/index.html">Novas aventuras de Cyborg na Alemanha</a></li>
<li><a href="../pt425761/index.html">DevDay Pro Testing: Gravando relat√≥rios</a></li>
<li><a href="../pt425763/index.html">PHP Excel Templator (mecanismo de modelos PHP para Excel) ou como escrevemos hardcode para Excel antes</a></li>
<li><a href="../pt425767/index.html">Splunk 7.2 O que h√° de novo? SmartStore, gerenciamento de carga e muito mais ...</a></li>
<li><a href="../pt425769/index.html">Como ensinar o MySQL a olhar para o passado</a></li>
<li><a href="../pt425771/index.html">O princ√≠pio da menor a√ß√£o em mec√¢nica anal√≠tica</a></li>
<li><a href="../pt425773/index.html">Como controlamos funcion√°rios remotos</a></li>
<li><a href="../pt425775/index.html">Automa√ß√£o da ind√∫stria do sexo ou servi√ßos p√∫blicos em alem√£o</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>