<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®‚Äçüë®‚Äçüë¶ üßïüèæ üßú Comment j'ai rencontr√© OpenCV ou √† la recherche de ColorChecker üç¶ üéöÔ∏è üö£üèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="J'√©tudie au centre CS de Novossibirsk pour la deuxi√®me ann√©e. Avant d'entrer, j'avais d√©j√† un emploi dans l'informatique - j'ai travaill√© comme analys...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Comment j'ai rencontr√© OpenCV ou √† la recherche de ColorChecker</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/JetBrains-education/blog/437450/">  J'√©tudie au centre CS de Novossibirsk pour la deuxi√®me ann√©e.  Avant d'entrer, j'avais d√©j√† un emploi dans l'informatique - j'ai travaill√© comme analyste chez Yandex, mais je voulais continuer √† d√©velopper, d√©couvrir quelque chose au-del√† des t√¢ches actuelles et, sur les conseils d'un coll√®gue, je suis entr√© dans le centre CS.  Dans cet article, je veux parler de la pratique que j'ai v√©cue pendant mes √©tudes. <br><br>  Au d√©but du premier semestre, on nous a propos√© plusieurs projets.  Mon attention a √©t√© imm√©diatement attir√©e par un projet intitul√© "M√©thode d'√©valuation de la couleur du grain d'une photographie".  Ce sujet a √©t√© sugg√©r√© par des sp√©cialistes de l'Institut de Cytologie et G√©n√©tique du SB RAS, mais le projet lui-m√™me √©tait plus li√© √† l'analyse et au traitement d'images qu'√† la biologie.  Je l'ai choisi parce que j'√©tais int√©ress√© par l'apprentissage automatique et la reconnaissance des formes et je voulais pratiquer dans ces domaines. <br><a name="habracut"></a><br><h3>  L'essence du projet </h3><br>  Il existe une application <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">SeedCounter</a> con√ßue pour compter et mesurer la taille des grains de bl√© d'une photographie pour lib√©rer les agronomes du travail ennuyeux et routinier de comptage et d'analyse des grains.  J'avais besoin d'√©tudier la possibilit√© de d√©terminer la couleur des grains √† partir d'une photographie et de l'impl√©menter dans l'application afin que les grains puissent √™tre divis√©s en classes significatives.  Les classes obtenues peuvent correspondre, par exemple, au contenu de substances utiles √† l'homme. <br><br>  Exemple de photo avant et apr√®s l'√©talonnage: <br><br><img src="https://habrastorage.org/webt/t8/8z/ia/t88zia1h4pnzzeapnoqxbrvodn0.jpeg"><br><br>  Il semblerait que prendre et comprendre la couleur des grains d'une photographie est une t√¢che simple, surtout s'il existe d√©j√† un algorithme pour trouver les grains eux-m√™mes.  Cependant, la couleur obtenue est tr√®s d√©pendante de l'√©clairage et la cam√©ra introduit sa propre distorsion.  En cons√©quence, la couleur obtenue a peu de rapport avec les propri√©t√©s du grain lui-m√™me.  Par cons√©quent, l'objectif principal √©tait d'obtenir des couleurs de grain calibr√©es, c'est-√†-dire  tels qu'ils seraient dans des conditions de prise de vue id√©ales. <br><br>  Pour ajuster les couleurs, nous avons utilis√© une palette de r√©f√©rence appel√©e ColorChecker.  ColorChecker est situ√© sur le m√™me cadre que les grains, ses couleurs sont connues √† l'avance.  L'application doit choisir une conversion d'image telle que les couleurs du ColorChecker soient aussi proches que possible des couleurs de r√©f√©rence connues. <br><br>  Autrement dit, la t√¢che a √©t√© divis√©e en trois sous-t√¢ches: <br><br><ul><li>  trouver ColorChecker dans l'image, </li><li>  calcul de la conversion des couleurs et application √† l'image, </li><li>  s√©paration des grains selon les couleurs obtenues. </li></ul><br><h3>  Avancement des travaux </h3><br>  Tout d'abord, nous avons recherch√© l'algorithme de recherche ColorChecker d√©j√† impl√©ment√© - il a √©t√© trouv√© dans le package gratuit macduff.  Je l'ai essay√© sur des images de test, √ßa s'est mal pass√©: m√™me avec un petit tour de ColorChecker, trop peu de carr√©s de la palette ont √©t√© reconnus, apr√®s quoi j'ai commenc√© √† chercher d'autres m√©thodes de recherche o√π l'orientation n'√©tait pas importante.  Il s'est av√©r√© qu'il existe une m√©thode utilis√©e pour une t√¢che plus g√©n√©rale de recherche d'un objet arbitraire - elle est bas√©e sur la s√©lection de points caract√©ristiques dans l'image et leur comparaison avec le mod√®le.  Tous les composants n√©cessaires sont d√©j√† dans OpenCV, il n'a donc pas √©t√© difficile de l'impl√©menter. <br><br>  Pour mettre en √©vidence les points caract√©ristiques d'OpenCV, nous avons utilis√© plusieurs algorithmes: √† la fois brevet√©s (SIFT / SURF) et gratuits (ORB / FAST).  Initialement, la m√©thode fonctionnait assez bien avec les options brevet√©es, mais elle √©tait tr√®s lente, ce qui est critique lorsqu'elle est utilis√©e sur un appareil mobile.  Ils √©taient √©galement absents de la version standard de la biblioth√®que, ce qui pouvait entra√Æner des difficult√©s lors du portage vers Android.  Lors de l'utilisation d'options plus rapides, la qualit√© de la reconnaissance a diminu√©. <br><br>  Pour augmenter la qualit√© de la reconnaissance, j'ai examin√© des exemples o√π l'algorithme √©tait incorrect.  Dans la plupart des cas, l'algorithme a trouv√© l'emplacement approximatif de ColorChecker, mais n'a pas d√©termin√© avec pr√©cision sa zone.  En raison d'une d√©termination inexacte de la zone du point √† partir de laquelle les couleurs ont √©t√© prises pour l'√©talonnage, elles ne sont pas tomb√©es dans les bons carr√©s de la palette, respectivement, les couleurs ont √©t√© restaur√©es incorrectement.  Pour r√©soudre ce probl√®me, j'ai essay√© de relancer l'algorithme, d'obtenir une approximation initiale inexacte, et √©galement de d√©placer empiriquement les points utilis√©s pour l'√©talonnage, dans le sens des carr√©s souhait√©s.  Apr√®s cela, la qualit√© de la m√©thode a augment√© et est devenue acceptable, m√™me pour des algorithmes initialement faibles mais rapides: <br><table><tbody><tr><td>  <b>Algorithme</b> </td><td>  <b>Pr√©cision</b> </td><td>  <b>Temps de travail</b> </td></tr><tr><td rowspan="2">  Surf </td><td>  75% </td><td>  2,8 s </td></tr><tr><td>  83% (+ 8%) </td><td>  14s </td></tr><tr><td rowspan="2">  SIFT </td><td>  88% </td><td>  3.4s </td></tr><tr><td>  96% (+ 8%) </td><td>  15 s </td></tr><tr><td rowspan="2">  Brisk </td><td>  65% </td><td>  0,5 s </td></tr><tr><td>  93% (+ 28%) </td><td>  1,5 s </td></tr><tr><td rowspan="2">  ORB </td><td>  56% </td><td>  0,4 s </td></tr><tr><td>  79% (+ 23%) </td><td>  1s </td></tr></tbody></table><br>  Pour l'√©talonnage, j'utilise une r√©gression simple des moindres carr√©s: √† la fois lin√©aire en couleur et dans les ordres sup√©rieurs.  En cons√©quence, la question s'est pos√©e: comment choisir le meilleur parmi plusieurs mod√®les.  Les mesures bas√©es sur la proximit√© de la couleur avec la norme ont donn√© des r√©sultats mitig√©s: une image bien calibr√©e utilisant des crit√®res formels peut sembler artificielle d'un point de vue humain.  L'image ci-dessous montre un exemple d'un tel effet.  Pour illustrer, au lieu de grains, j'ai pris une tranche de tubercule de pomme de terre, car elle est plus grande, et nous pouvons mieux voir les distorsions de couleur.  Nous avons essay√© de changer les m√©triques, mais √† la fin nous avons d√©cid√© qu'il valait mieux √©valuer le mod√®le pour l'√©talonnage par son influence sur le r√©sultat de la t√¢che finale - la s√©paration des grains. <br><br>  Tranche de tubercule de pomme de terre, de gauche √† droite: avant √©talonnage, apr√®s √©talonnage par r√©gression des premier, deuxi√®me et troisi√®me ordres. <br><br><img src="https://habrastorage.org/webt/lx/hr/yg/lxhrygyhkgpqrbamapylzsk0dqo.jpeg"><br><br>  Ensuite, il a fallu assembler un ensemble de donn√©es sur lequel v√©rifier la qualit√© de la recherche et de l'√©talonnage ColorChecker, et √©galement r√©soudre le probl√®me de la s√©paration des grains par couleur.  Pour ce faire, nous avons pr√©lev√© des √©chantillons de grains de diff√©rentes vari√©t√©s et photographi√© sur diff√©rents appareils, avec diff√©rentes sources d'√©clairage: artificielles et en plein jour.  Apr√®s cela, j'ai ex√©cut√© toutes les images √† travers l'algorithme d'√©talonnage et collect√© les couleurs des grains, l'algorithme de reconnaissance des grains m'a √©t√© pr√™t.  J'ai d√ª faire plus d'une it√©ration de ce processus: la reconnaissance sur des images de mauvaise qualit√© ne fonctionnait pas toujours bien, j'ai d√ª s√©lectionner des heuristiques suppl√©mentaires pour trier les ordures. <br><br>  En fin de compte, il s'est av√©r√© recueillir un ensemble de donn√©es, dont la qualit√© m'a satisfait.  J'ai formalis√© le probl√®me de la s√©paration des grains comme suit: neuf vari√©t√©s de grains √©taient divis√©es en trois classes (blanc, rouge et violet), chaque grain individuel devait √™tre class√© par couleur dans l'une des trois classes.  J'ai essay√© des m√©thodes de classification simples telles que KNN et les classificateurs lin√©aires, mais je n'ai pas r√©ussi √† obtenir une bonne pr√©cision.  Cependant, m√™me vu √† l'≈ìil nu, il √©tait clair que les classes se croisent fortement et qu'il n'y a aucune surface de division apparente entre elles. <br><br><h3>  R√©sum√© </h3><br>  Le r√©sultat principal du travail est l'algorithme de recherche ColorChecker, qui fonctionne rapidement et avec une bonne qualit√©, et l'√©talonnage des couleurs par celui-ci.  Il peut √™tre utile non seulement pour les c√©r√©ales.  Par exemple, il a √©t√© possible de l'appliquer pour analyser des √©pis de bl√©. <br><br>  J'ai √©galement v√©rifi√© la possibilit√© de classer les grains par couleur - je n'ai pas pu obtenir une grande pr√©cision ici, m√™me avec l'aide de l'√©talonnage. <br><br>  Mais le r√©sultat le plus important est que j'ai acquis de l'exp√©rience dans la r√©solution d'un probl√®me pour lequel aucun algorithme pr√™t √† l'emploi n'est pr√©sent√© sur les √©tag√®res, et d√©couvert pour moi-m√™me un domaine passionnant de la vision par ordinateur, que j'esp√®re que je rencontrerai √† l'avenir. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr437450/">https://habr.com/ru/post/fr437450/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr437440/index.html">Bonne journ√©e √©tudiante, programmeur</a></li>
<li><a href="../fr437442/index.html">R√©ponses du support technique 3CX: configurer le routeur pour le serveur PBX VoIP</a></li>
<li><a href="../fr437444/index.html">Un seau de goudron dans un baril de miel, ou un choc culturel potentiel pour les propri√©taires de tracteurs</a></li>
<li><a href="../fr437446/index.html">Apache Kafka et RabbitMQ: s√©mantique et garantie de livraison des messages</a></li>
<li><a href="../fr437448/index.html">28 janvier en Russie, le syst√®me de paiements rapides sans commission (par num√©ro de t√©l√©phone)</a></li>
<li><a href="../fr437454/index.html">Test de l'arithmom√®tre Felix M</a></li>
<li><a href="../fr437456/index.html">Plus jeune: Examen des t√©l√©phones IP Snom D315 et D305</a></li>
<li><a href="../fr437458/index.html">Inscription obligatoire par IMEI offre de faire pay√©</a></li>
<li><a href="../fr437460/index.html">Exemple de faux lecteur flash de 32 Go</a></li>
<li><a href="../fr437464/index.html">Prix ‚Äã‚ÄãTypeScript</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>