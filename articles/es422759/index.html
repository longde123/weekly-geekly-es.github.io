<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üò≠ üêê üë®üèª‚Äçüíº Mapa interactivo para una aplicaci√≥n web en un par de horas. ü¶í üë©üèª‚Äçüè≠ üê´</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="En un art√≠culo anterior, habl√© brevemente sobre las capacidades de kepler.gl, la nueva herramienta de c√≥digo abierto para visualizar y analizar grande...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Mapa interactivo para una aplicaci√≥n web en un par de horas.</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/422759/"><p>  En un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">art√≠culo anterior,</a> habl√© brevemente sobre las capacidades de kepler.gl, la nueva herramienta de c√≥digo abierto para visualizar y analizar grandes conjuntos de datos geogr√°ficos. </p><br><p><img src="https://habrastorage.org/webt/j7/wr/ug/j7wrugptpbwykcqm4quq-lrk72s.png" alt="Opciones para mapas creados con kepler.gl"><br>  <em>Figura 1. Opciones para mapas creados usando kepler.gl (por Uber)</em> </p><br><p> Esta aplicaci√≥n web le permite crear un mapa interactivo informativo y, lo m√°s importante, colorido basado en conjuntos arbitrarios de datos geogr√°ficos en cuesti√≥n de minutos.  Sin embargo, surge la pregunta de qu√© hacer con √©l a continuaci√≥n.  ¬øC√≥mo compartir los resultados con colegas, amigos o clientes? </p><a name="habracut"></a><br><h3 id="sravnivaem-alternativnye-varianty">  Compara alternativas </h3><br><p>  Toda la "magia" de kepler.gl ocurre en el cliente, por lo que la aplicaci√≥n ofrece solo 2 formas de compartir sus resultados con otros: </p><br><ul><li>  guardar la visualizaci√≥n como una imagen est√°tica (mientras se pierde la capacidad de interactuar con el mapa) </li><li>  exporte la configuraci√≥n y los datos creados como archivos y env√≠elos a todas las partes interesadas con instrucciones sobre c√≥mo descargar los datos recibidos a kepler.gl para ver el mapa creado </li></ul><br><p>  Afortunadamente, kepler.gl no es solo una herramienta web, sino tambi√©n un componente React, con el que puede crear r√°pidamente un sitio de demostraci√≥n con sus visualizaciones o integrarlas en una aplicaci√≥n web existente. </p><br><p>  <em><strong>Nota</strong></em>  <em>Al procesar y agregar datos sobre la marcha, kepler.gl a menudo requiere muchos recursos.</em>  <em>Por lo tanto, debe ser especialmente cuidadoso al integrarlo en aplicaciones personalizadas para dispositivos m√≥viles.</em> </p><br><p>  Este caso de uso para kepler.gl permitir√°: </p><br><ul><li>  no complique el proceso de visualizaci√≥n de visualizaci√≥n (solo env√≠e un enlace a su aplicaci√≥n) </li><li>  no d√© acceso a los conjuntos de datos originales de forma expl√≠cita (como lo requiere el caso base 2) </li><li>  restringir formatos accesibles para el usuario para interactuar con visualizaciones (por ejemplo, prohibir el autoajuste de filtros o m√©todos de visualizaci√≥n de datos) </li><li>  guarde todos los formatos deseados para interactuar con la tarjeta (informaci√≥n sobre herramientas, zoom, cambiar el modo de mapa, etc.) </li></ul><br><p>  La √∫ltima de las opciones consideradas requerir√° esfuerzos adicionales por parte del creador de la geo-visualizaci√≥n y no podr√° prescindir de la programaci√≥n.  Sin embargo, como ver√° pronto, no es dif√≠cil implementarlo de la misma manera. </p><br><h3 id="sozdaem-demo-prilozhenie">  Crea una aplicaci√≥n de demostraci√≥n </h3><br><p>  Es hora de pasar de la teor√≠a a la pr√°ctica.  Para presentarle los pasos b√°sicos para integrar kepler.gl en su c√≥digo, hice una peque√±a aplicaci√≥n de demostraci√≥n. </p><br><p>  Permite al usuario ver informaci√≥n sobre los estacionamientos pagados de Mosc√∫ en uno de los dos modos: general o agregado.  Al mismo tiempo, la aplicaci√≥n solo permite ver las visualizaciones que creamos, cambiar entre ellas y trabajar con el mapa en modo de solo lectura.  Todo el c√≥digo fuente y la versi√≥n en vivo est√°n disponibles en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">GitHub</a> . </p><br><p><img src="https://habrastorage.org/webt/sh/hb/qa/shhbqaimmmrciwal58iquhxiy08.png" alt="Solicitud de demostraci√≥n para estacionamiento pago en Mosc√∫"><br>  <em>Figura 2. Dos modos de vista de mapa proporcionados por la aplicaci√≥n de demostraci√≥n</em> </p><br><p>  Para crear esta demostraci√≥n, utilic√© mi propia plantilla de proyecto.  Sin embargo, si decide jugar con kepler.gl usted mismo, pero a√∫n no tiene preferencias personales, le recomiendo que use <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">create-react-app</a> , lo que reducir√° significativamente el tiempo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">necesario</a> para crear la base de su futura aplicaci√≥n. </p><br><h3 id="dobavlyaem-keplergl-v-proekt">  Agregue kepler.gl al proyecto </h3><br><p>  Kepler.gl es un componente React que usa Redux para almacenar y administrar su estado.  Para agregarlo al proyecto, simplemente instale el paquete npm apropiado: </p><br><pre><code class="bash hljs">npm install --save kepler.gl</code> </pre> <br><p>  Este paquete npm incluye: </p><br><ul><li>  Un conjunto de componentes y f√°bricas de interfaz de usuario que les permite redefinirse con sus propios componentes </li><li>  m√©todos predefinidos para agregar / cambiar los datos utilizados y c√≥mo mostrarlos </li><li>  Redux reductor necesario para su trabajo </li></ul><br><h3 id="nastraivaem-redux-hranilische-dlya-raboty-keplergl">  Configurar el almacenamiento de Redux para kepler.gl </h3><br><p>  Kepler.gl usa Redux para administrar su estado en el proceso de creaci√≥n y actualizaci√≥n de mapas.  Por lo tanto, antes de usar el componente KeplerGl, necesitamos agregar el reductor apropiado al reductor de la aplicaci√≥n. </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { combineReducers } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'redux'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> keplerGlReducer <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'kepler.gl/reducers'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> appReducer <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./appReducer'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> reducers = combineReducers({ <span class="hljs-attr"><span class="hljs-attr">keplerGl</span></span>: mapReducer, <span class="hljs-attr"><span class="hljs-attr">app</span></span>: appReducer, }); <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> reducers;</code> </pre> <br><p>  Es importante recordar que, de manera predeterminada, el componente KeplerGl proporcionar√° al usuario todas las opciones disponibles para autoedici√≥n, descarga, actualizaci√≥n y filtrado de datos.  Para limitar el conjunto de acciones permitidas al usuario, debe transferir informaci√≥n sobre el modo de mapa (para leer o editar) y los controles de mapa disponibles en los par√°metros de estado iniciales: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> mapReducer = keplerGlReducer .initialState({ <span class="hljs-attr"><span class="hljs-attr">uiState</span></span>: { <span class="hljs-attr"><span class="hljs-attr">readOnly</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">mapControls</span></span>: { <span class="hljs-attr"><span class="hljs-attr">visibleLayers</span></span>: { <span class="hljs-attr"><span class="hljs-attr">show</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span> }, <span class="hljs-attr"><span class="hljs-attr">toggle3d</span></span>: { <span class="hljs-attr"><span class="hljs-attr">show</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span> }, <span class="hljs-attr"><span class="hljs-attr">splitMap</span></span>: { <span class="hljs-attr"><span class="hljs-attr">show</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> }, <span class="hljs-attr"><span class="hljs-attr">mapLegend</span></span>: { <span class="hljs-attr"><span class="hljs-attr">show</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">active</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span> } } } });</code> </pre> <br><p>  Tambi√©n necesitaremos instalar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">react-palm</a> , que kepler.gl usa para controlar los efectos secundarios y agregar taskMiddleware desde este paquete npm al repositorio de Redux de su aplicaci√≥n: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> {createStore, applyMiddleware, compose} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'redux'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> {taskMiddleware} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-palm'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> reducers <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./reducers'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> initialState = { }; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> middlewares = [ taskMiddleware ]; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> enhancers = [applyMiddleware(...middlewares)]; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> createStore( reducers, initialState, compose(...enhancers) );</code> </pre> <br><p>  <em><strong>Nota</strong></em>  <em>Actualmente, el equipo de Ingenier√≠a de Uber est√° trabajando activamente en una nueva versi√≥n de kepler.gl que no depender√° de react-palm.</em> </p><br><p>  De forma predeterminada, kepler.gl espera que su objeto de estado se ubique en el nivel superior del estado de toda la aplicaci√≥n y sea accesible con el nombre keplerGl.  Si la configuraci√≥n del repositorio de Redux difiere de la esperada, entonces, para el correcto funcionamiento del componente React correspondiente, es suficiente especificar la ubicaci√≥n de su estado en la jerarqu√≠a utilizando la propiedad getState. </p><br><h3 id="vstraivaem-react-komponent-keplergl">  Incrustar el componente de reacci√≥n KeplerGl </h3><br><p>  Para la representaci√≥n r√°pida de mapas con una gran cantidad de elementos visualizados (¬°hasta millones de puntos geogr√°ficos!) Kepler.gl utiliza desk.gl - marco WebGL para visualizaci√≥n de datos, y MapBox - geo-plataforma de c√≥digo abierto, que proporciona una API conveniente y amplias posibilidades para personalizar mapas creados .  Por lo tanto, uno de los par√°metros obligatorios pasados ‚Äã‚Äãal componente KeplerGl es el token API para acceder al servicio MapBox. </p><br><p>  Para recibir un token, debe registrarse en el sitio <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">www.mapbox.com</a> .  MapBox ofrece una selecci√≥n de varios planes de tarifas diferentes, pero para peque√±as aplicaciones, una versi√≥n gratuita con 50,000 vistas por mes ser√° suficiente. </p><br><p>  Despu√©s de crear una cuenta, debe ir a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">la secci√≥n de tokens</a> y generar una clave p√∫blica para acceder al servicio. </p><br><p>  Establezca el token recibido en la variable de entorno adecuada: </p><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">export</span></span> MapboxAccessToken=&lt;your_mapBox_token&gt;</code> </pre> <br><p>  Ahora puede pasar a crear un componente Reaccionar para mostrar informaci√≥n sobre los estacionamientos pagados.  En nuestro caso, ser√° solo un contenedor sobre el componente KeplerGl, que toma las dimensiones del mapa como par√°metros: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> KeplerGl <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'kepler.gl'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> mapboxAccessToken = process.env.MapboxAccessToken; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> ParkingMap = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">props</span></span></span><span class="hljs-function">) =&gt;</span></span> ( <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">KeplerGl</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"parking_map"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">mapboxApiAccessToken</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{mapboxAccessToken}</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">width</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">props.width</span></span></span></span><span class="xml"><span class="hljs-tag"> } </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">height</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">props.height</span></span></span></span><span class="xml"><span class="hljs-tag"> } /&gt;</span></span></span><span class="xml"> ); export default ParkingMap;</span></span></code> </pre> <br><p>  Agrega ParkingMap a la aplicaci√≥n.  En esta etapa, en lugar de la informaci√≥n de estacionamiento, simplemente se muestra un mapa sin ninguna informaci√≥n, porque todav√≠a no hemos transmitido los datos en funci√≥n de los cuales se construyen nuestras visualizaciones. </p><br><h3 id="zagruzhaem-dannye-i-konfiguracii-karty">  Descargar datos y configuraciones de mapas </h3><br><p>  Para mostrar sus datos en el mapa, debe transferir a KeplerGl el conjunto de datos en funci√≥n del cual se crear√° el mapa y la configuraci√≥n deseada de la visualizaci√≥n final.  Esto se puede hacer usando uno de dos m√©todos: addDataToMap o updateVisData. </p><br><p>  El primer m√©todo le permite no solo descargar el conjunto de datos necesarios y establecer / actualizar completamente la configuraci√≥n de la instancia correspondiente del componente KeplerGl, incluida la configuraci√≥n de visualizaci√≥n (visState) y el mapa (mapState), as√≠ como el estilo del mapa utilizado (mapStyle). </p><br><p>  AddDataToMap acepta un objeto que contiene la siguiente informaci√≥n como par√°metro del m√©todo: </p><br><ul><li>  conjuntos de datos utilizados para la visualizaci√≥n de edificios </li><li>  par√°metros de configuraci√≥n adicionales (opciones) </li><li>  datos de configuraci√≥n que incluyen mapState, mapStyle, visState <br><pre> <code class="javascript hljs">addDataToMap({ <span class="hljs-attr"><span class="hljs-attr">datasets</span></span>: { ‚Ä¶ } options: { ‚Ä¶ } config: { mapState { ‚Ä¶ }, mapStyle { ‚Ä¶ }, <span class="hljs-attr"><span class="hljs-attr">visState</span></span>: { ‚Ä¶ } } });</code> </pre> </li></ul><br><p>  <em><strong>Nota</strong></em>  <em>Los datos del objeto de configuraci√≥n siempre tienen prioridad sobre la configuraci√≥n pasada en el objeto de opciones.</em> </p><br><p>  El m√©todo updateVisData permite actualizar solo los conjuntos de datos usados ‚Äã‚Äãsin cambiar completamente la configuraci√≥n del componente utilizado.  Como par√°metro, como el primer m√©todo, toma un objeto que contiene informaci√≥n sobre un nuevo conjunto o conjuntos de datos y el par√°metro "opciones" para actualizar algunas configuraciones de visualizaci√≥n del mapa. </p><br><p>  <strong>Inicializaci√≥n del mapa</strong> </p><br><p>  Por lo tanto, para la carga de datos inicial, necesitamos el m√©todo addDataToMap.  En la aplicaci√≥n de demostraci√≥n que se est√° creando, la base de datos de estacionamiento pagado en Mosc√∫ se carga cuando se accede por primera vez a la aplicaci√≥n mediante una solicitud por separado.  Los datos de origen resultantes deben estar preparados para cargarlos en KeplerGl.  Para esto, en la mayor√≠a de los casos, es suficiente uno de los procesadores predefinidos que transfieren datos csv / json al formato de datos compatible con kepler.gl. </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loadParkingData</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">mapMode</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">dispatch</span></span></span><span class="hljs-function">) =&gt;</span></span> { dispatch( requestParkingData() ); fetch(demoDataUrl) .then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">response</span></span></span><span class="hljs-function"> =&gt;</span></span> response.text()) .then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">source</span></span></span><span class="hljs-function"> =&gt;</span></span> { dispatch( getParkingData() ); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> data = Processors.processCsvData(source); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> config = getMapConfig(mapMode); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> datasets = [{ info, data }]; dispatch( wrapTo(<span class="hljs-string"><span class="hljs-string">'parking_map'</span></span>, addDataToMap({ datasets, config }) )); }); }; }</code> </pre> <br><p>  <strong>Cambiar entre modos</strong> </p><br><p>  Para cambiar entre los modos de vista del mapa, necesitamos definir otra funci√≥n de acci√≥n.  Dado que en la versi√≥n actual de KeplerGl no hay una manera f√°cil de cambiar solo la configuraci√≥n del mapa sin afectar los datos, el m√©todo addDataToMap tambi√©n ser√° el m√©todo m√°s adecuado para cambiar entre modos: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">toggleMapMode</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">mode</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">dispatch, getState</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> config = getMapConfig( mode ); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> datasets = getDatasets(getState()); dispatch( wrapTo(<span class="hljs-string"><span class="hljs-string">'parking_map'</span></span>, addDataToMap({ datasets, config }) )); dispatch( setMapMode(mode) ); }; }</code> </pre> <br><p>  El par√°metro del conjunto de datos es obligatorio, por lo tanto, cada vez que cambiemos el modo de vista del mapa, retransmitiremos el conjunto de datos original cargado al inicio de la aplicaci√≥n.  La informaci√≥n de configuraci√≥n de la tarjeta se actualizar√° cada vez.  En este art√≠culo no me detendr√© en c√≥mo se implementan los m√©todos de ayuda getMapConfig y getDatasets, cuyo c√≥digo fuente puede familiarizarse con usted en GitHub. </p><br><p>  <em><strong>Nota</strong></em>  <em>Actualmente, la API KeplerGl es muy limitada y est√° dise√±ada para los casos m√°s b√°sicos (agregar y actualizar datos).</em>  <em>Al mismo tiempo, los propios <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">desarrolladores reconocen</a> que la versi√≥n actual no proporciona un m√©todo efectivo para actualizar solo configuraciones o para actualizaciones de datos en tiempo real.</em>  <em>Sin embargo, no olvide que el proyecto se encuentra en desarrollo activo y existe la esperanza de una pronta expansi√≥n de su funcionalidad.</em> </p><br><h3 id="kastomiziruem-elementy-karty">  Personalizar elementos del mapa </h3><br><p>  KeplerGl incluye no solo un contenedor con geo-visualizaci√≥n, sino tambi√©n controles de mapas, informaci√≥n sobre herramientas, un panel lateral para administrar los datos mostrados, un cuadro de di√°logo para cargar datos en formato csv, json o geojson, etc.  Al mismo tiempo, cada uno de los componentes enumerados se puede reemplazar f√°cilmente con su propia versi√≥n utilizando el sistema de inyecci√≥n de dependencia. </p><br><p>  Para reemplazar el componente base con su versi√≥n personalizada, es suficiente: </p><br><ul><li>  importar f√°brica de componentes por defecto </li><li>  definir una nueva f√°brica que devuelva un componente personalizado </li><li>  incrustar una nueva f√°brica utilizando el m√©todo injectComponents </li></ul><br><p>  En la aplicaci√≥n de demostraci√≥n que creamos, no queremos darle al usuario la oportunidad de configurar de forma independiente el modo de visualizaci√≥n, filtrar los datos existentes o cargar nuevos datos. </p><br><p>  En teor√≠a, para esto es suficiente indicar que el componente KeplerGl est√° en modo de solo lectura, que apareci√≥ solo en la versi√≥n 0.0.27. Sin embargo, incluso en esta versi√≥n, todos los controles todav√≠a se muestran al usuario durante los primeros momentos antes de cargar el mapa, y solo luego se ocultan.  Para evitar esto, podemos reemplazar expl√≠citamente componentes no deseados con un componente nulo utilizando el m√©todo injectComponents: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { injectComponents, ModalContainerFactory, SidePanelFactory, } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'kepler.gl/components'</span></span>; <span class="hljs-comment"><span class="hljs-comment">// define null factory to don not render any unnecessary components const NullComponent = () =&gt; null; const nullComponentFactory = () =&gt; NullComponent; const KeplerGl = injectComponents([ [ModalContainerFactory, nullComponentFactory], [SidePanelFactory, nullComponentFactory], ]); export default KeplerGl;</span></span></code> </pre> <br><p>  Convenientemente, KeplerGl no solo le permite reemplazar componentes b√°sicos por otros personalizados, sino que el uso del m√©todo withState le permite agregar acciones adicionales y par√°metros de estado para nuevos componentes. </p><br><h3 id="kak-ispolzovat-neskolko-kart-odnovremenno">  C√≥mo usar varias tarjetas a la vez </h3><br><p>  Si planea usar varios componentes KeplerGL diferentes dentro de la misma aplicaci√≥n, cada uno de ellos debe establecerse en los par√°metros con una identificaci√≥n √∫nica, necesaria para agregar / actualizar datos y configuraciones de cada una de las tarjetas: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> wrapToParking = wrapTo(<span class="hljs-string"><span class="hljs-string">' parking_map'</span></span>); dispatch( wrapToParking( addDataToMap({ datasets, config }) ));</code> </pre> <br><p>  Una alternativa es utilizar la funci√≥n de conexi√≥n de Redux y la funci√≥n forwardTo de kepler.gl.  En este caso, es lo suficientemente simple como para que la funci√≥n del despachador correspondiente especifique la identificaci√≥n de la tarjeta correspondiente: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> KeplerGl <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'kepler.gl'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { forwardTo, toggleFullScreen } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'kepler.gl/actions'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> {connect} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-redux'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> MapContainer = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">props</span></span></span><span class="hljs-function"> =&gt;</span></span> ( &lt;div&gt; &lt;button onClick=() =&gt; props.keplerGlDispatch(toggleFullScreen())/&gt; &lt;KeplerGl id="foo" /&gt; &lt;/div&gt; ) const mapStateToProps = state =&gt; state const mapDispatchToProps = (dispatch, props) =&gt; ({ dispatch, keplerGlDispatch: forwardTo('foo', dispatch) });</code> </pre> <br><h3 id="zaklyuchenie">  Conclusi√≥n </h3><br><p>  KeplerGl le permite agregar coloridos mapas interactivos a su aplicaci√≥n web basada en React.  Gracias al uso del marco del componente desk.gl, puede mostrar f√°cilmente millones de puntos geogr√°ficos en un formato conveniente para verlos y analizarlos. </p><br><p>  Las amplias posibilidades para personalizar no solo las visualizaciones creadas, sino tambi√©n los estilos de mapas, as√≠ como los formatos de interacci√≥n del usuario, hacen de KeplerGl una herramienta muy atractiva para crear complejas visualizaciones cartogr√°ficas y paneles. </p><br><p>  Sin embargo, limitado solo por escenarios API b√°sicos, el procesamiento de datos en el cliente, as√≠ como el uso de MapBox sin la capacidad de seleccionar otra fuente de mapa, reducen el n√∫mero de proyectos para los que se puede utilizar esta herramienta. </p><br><p>  Pero no olvide que hoy el proyecto a√∫n es muy joven y se encuentra en la fase activa de desarrollo, por lo que muchas de estas deficiencias pueden volverse irrelevantes en el futuro cercano. </p><br><h3 id="poleznye-ssylki">  Enlaces utiles </h3><br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">C√≥digo demo completo</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Art√≠culo introductorio sobre Kepler.Gl sobre Habr</a> </li><li>  <a href="">Repositorio Kepler.gl en github</a> </li><li>  <a href="">La documentaci√≥n oficial de kepler.gl</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Kepler.gl Tutorial sobre Academia de Vis. [En]</a> </li></ol><br></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es422759/">https://habr.com/ru/post/es422759/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es422747/index.html">Posici√≥n de soporte de cifrado fuerte oficial de IEEE</a></li>
<li><a href="../es422751/index.html">10 herramientas de diagn√≥stico SSL / TLS gratuitas para webmasters</a></li>
<li><a href="../es422753/index.html">Comprender las particiones en PostgreSQL 9</a></li>
<li><a href="../es422755/index.html">¬øLa cartera proteger√° contra el hundimiento criptogr√°fico?</a></li>
<li><a href="../es422757/index.html">No pol√≠tica ¬øC√≥mo transformar permanentemente las protestas callejeras usando una aplicaci√≥n m√≥vil?</a></li>
<li><a href="../es422761/index.html">Cuatro formas de Yandex Data Analysis School</a></li>
<li><a href="../es422763/index.html">Eventos digitales en Mosc√∫ del 10 al 16 de septiembre.</a></li>
<li><a href="../es422765/index.html">OpenID Connect 1.0 en los dedos</a></li>
<li><a href="../es422767/index.html">Conferencia DEFCON 16. Fedor, InSecure.org Hacker. Escaneo NMAP en l√≠nea</a></li>
<li><a href="../es422769/index.html">Ganadores de Startup Battlefield TechCrunch Disrupt San Francisco 2018</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>