<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üò® ü¶É üéè Desde simples scripts hasta aplicaciones cliente-servidor de bricolaje en WCF: por qu√© me gusta trabajar en CM üôçüèº üõèÔ∏è ‚óªÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="El trabajo en el equipo de Gesti√≥n de la configuraci√≥n est√° asociado a garantizar la funcionalidad de los procesos de compilaci√≥n: ensamblar productos...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Desde simples scripts hasta aplicaciones cliente-servidor de bricolaje en WCF: por qu√© me gusta trabajar en CM</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/veeam/blog/417701/">  El trabajo en el equipo de Gesti√≥n de la configuraci√≥n est√° asociado a garantizar la funcionalidad de los procesos de compilaci√≥n: ensamblar productos de la empresa, verificaci√≥n preliminar del c√≥digo, an√°lisis estad√≠stico, documentaci√≥n y mucho m√°s.  Adem√°s, trabajamos constantemente para optimizar diversos procesos y, lo que es maravilloso, somos pr√°cticamente libres de elegir herramientas para este interesante trabajo.  A continuaci√≥n, hablar√© en detalle sobre c√≥mo, teniendo solo un nivel diferente de conocimiento en C # y C ++, hice un servicio WCF funcional para trabajar con colas de arreglos.  Y por qu√© decid√≠ que es muy importante. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b47/a3e/2d9/b47a3e2d9febdfd19dcde2b59d58df1b.png"><br><a name="habracut"></a><br><h2>  Automatizaci√≥n una vez o instrucci√≥n de 117 p√°ginas una y otra vez </h2><br>  Una peque√±a digresi√≥n para que entiendas por qu√© estoy tan preocupado por la automatizaci√≥n y la optimizaci√≥n de los procesos. <br><br>  Antes de Veeam, trabajaba para una gran empresa internacional: era el l√≠der del equipo del equipo de Gesti√≥n de la configuraci√≥n, estaba involucrado en la creaci√≥n de la aplicaci√≥n y su implementaci√≥n en entornos de prueba.  El programa se desarroll√≥ con √©xito, se agregaron nuevas funciones, se escribi√≥ la documentaci√≥n, cuyo soporte tambi√©n trat√©.  Pero siempre me sorprendi√≥ por qu√© un programa tan serio no tiene un sistema de configuraci√≥n de par√°metros normal, de los cuales hab√≠a muchas docenas, si no cientos. <br><br>  Habl√© con los desarrolladores sobre este tema y recib√≠ una respuesta: el cliente no pag√≥ por esta funci√≥n, no estuvo de acuerdo con su costo, por lo que la funci√≥n no se implement√≥.  Pero, de hecho, el control de calidad sufri√≥, y nosotros, el equipo de SM, fuimos directamente afectados.  La configuraci√≥n del programa y su configuraci√≥n preliminar se llev√≥ a cabo a trav√©s de muchos archivos de configuraci√≥n, cada uno de los cuales ten√≠a docenas de par√°metros. <br><br>  Cada nueva compilaci√≥n, cada nueva versi√≥n hizo sus cambios en la configuraci√≥n.  Los archivos de configuraci√≥n antiguos no se pod√≠an usar, ya que a menudo eran incompatibles con la nueva versi√≥n.  Como resultado, cada vez antes de implementar la compilaci√≥n para la prueba o en las m√°quinas de trabajo de los probadores, ten√≠a que pasar mucho tiempo configurando el programa, arreglando errores de configuraci√≥n, consultas constantes con los desarrolladores sobre el tema "¬øpor qu√© no funciona as√≠ ahora?"  En general, el proceso fue extremadamente inoportuno. <br><br>  Para ayudar con la configuraci√≥n, tuvimos una instrucci√≥n de 117 p√°ginas en tama√±o de fuente Arial 9. Tuvimos que leer muy, muy cuidadosamente.  A veces parec√≠a que era m√°s f√°cil construir un kernel de Linux con los ojos cerrados en una computadora apagada. <br><br>  Qued√≥ claro que la optimizaci√≥n no pod√≠a evitarse aqu√≠.  Comenc√© a escribir mi configurador para un programa con soporte para perfiles y la capacidad de cambiar los par√°metros en unos segundos, pero el proyecto lleg√≥ a su etapa final, y pas√© a trabajar en otro proyecto.  En √©l, analizamos muchos registros de un sistema de facturaci√≥n para detectar posibles errores en el lado del servidor.  La automatizaci√≥n de muchas acciones usando el lenguaje Python me salv√≥ de la monstruosa cantidad de trabajo manual.  Realmente me gust√≥ este lenguaje de secuencias de comandos, y con su ayuda hicimos un conjunto de secuencias de comandos de an√°lisis para todas las ocasiones.  Esas tareas que requirieron varios d√≠as de an√°lisis reflexivo de acuerdo con el "cat logfile123 |  grep something_special ‚Äù, tom√≥ unos minutos.  Todo fue genial ... y aburrido. <br><br><h2>  Gesti√≥n de configuraci√≥n - Nuevas aventuras </h2><br>  Vine a Veeam como l√≠der de equipo para un peque√±o equipo de CM.  Muchos procesos requieren automatizaci√≥n, optimizaci√≥n y replanteamiento.  ¬°Pero hab√≠a total libertad para elegir herramientas!  El desarrollador debe usar un lenguaje de programaci√≥n espec√≠fico, estilo de c√≥digo, un conjunto espec√≠fico de bibliotecas.  SM, por otro lado, puede no usar nada para resolver la tarea, si tiene suficiente tiempo, coraje y paciencia para esto. <br><br>  Veeam, como muchas otras compa√±√≠as, tiene la tarea de reunir actualizaciones de productos.  La actualizaci√≥n incluy√≥ cientos de archivos, y fue necesario cambiar solo aquellos que cambiaron, teniendo en cuenta una serie de condiciones importantes.  Para hacer esto, creamos un voluminoso script de PowerShell que podr√≠a subir a TFS, seleccionar archivos, ordenarlos en las carpetas necesarias.  La funcionalidad del script se complement√≥, gradualmente se hizo enorme, tom√≥ mucho tiempo depurar y constantemente algunas muletas para arrancar.  Era urgente hacer algo. <br><br><h2>  ¬øQu√© quer√≠an los desarrolladores? </h2><br>  Aqu√≠ est√°n las principales quejas: <br><br><ul><li>  No se pueden poner en cola las correcciones.  Debe verificar constantemente la p√°gina web para ver cu√°ndo finaliza el ensamblaje del arreglo privado y puede comenzar a construir el suyo. <br></li><li>  No hay notificaciones sobre errores: para ver los errores en la GUI de la aplicaci√≥n de ensamblaje, debe ir al servidor y observar muchos registros voluminosos. <br></li><li>  No hay historial de compilaci√≥n para arreglos privados. <br></li></ul><br>  Era necesario ocuparse de estas tareas y agregar peque√±as cosas agradables que los desarrolladores no rechazar√≠an. <br><br><h2>  ¬øQu√© son arreglos privados? </h2><br>  Una soluci√≥n privada en el contexto de nuestro desarrollo es un cierto conjunto de correcciones en el c√≥digo, que se almacena en la plataforma del Team Foundation Server para la rama de lanzamiento.  Una peque√±a aclaraci√≥n para aquellos que no est√°n demasiado familiarizados con la terminolog√≠a de TFS: <br><br><ul><li>  check-in: un conjunto de cambios locales en el c√≥digo fuente, que se realiza en el c√≥digo almacenado en TFS.  Esta verificaci√≥n puede verificarse mediante los procesos de Integraci√≥n continua / Verificaci√≥n cerrada que le permiten omitir solo el c√≥digo correcto y rechazar todas las verificaciones que violen la recopilaci√≥n del proyecto final. <br></li><li>  shelveset: un conjunto de cambios locales en el c√≥digo fuente que no se realiza directamente en el c√≥digo fuente ubicado en TFS, pero que es accesible por su nombre.  El shellset se puede implementar en la m√°quina local del desarrollador o sistema de compilaci√≥n para trabajar con c√≥digo modificado que no est√° incluido en TFS.  Adem√°s, el shellset se puede agregar a TFS como una comprobaci√≥n despu√©s de la implementaci√≥n, cuando se completa todo el trabajo con √©l.  Por ejemplo, el verificador de puerta funciona de esta manera.  Primero, se marca el shellset en el constructor.  Si la verificaci√≥n es exitosa, el shellset se convierte en una verificaci√≥n <br></li></ul><br>  Esto es lo que hace el constructor de arreglos privados: <br><br><ol><li>  Obtiene el nombre (n√∫mero) del conjunto de shell y lo implementa en el generador de arreglos privados.  Como resultado, obtenemos el c√≥digo fuente del producto de lanzamiento m√°s los cambios / arreglos del shellset.  La rama de liberaci√≥n permanece sin cambios. <br></li><li>  En un generador de arreglos privados, se va a ejecutar un proyecto o una serie de proyectos para los que se ha realizado un arreglo privado. <br></li><li>  El conjunto de archivos binarios compilados se copia en el directorio de red del arreglo privado.  El cat√°logo contiene el nombre del shellset, que es una secuencia de n√∫meros. <br></li><li>  El c√≥digo fuente en el generador de arreglos privados se restaura a su forma original. <br></li></ol><br>  Para comodidad de los desarrolladores, se utiliza una interfaz web donde puede especificar el producto para el que desea recopilar un arreglo privado, especificar el n√∫mero de shellset, seleccionar los proyectos para los que desea recopilar un arreglo privado y agregar el conjunto de arreglos a la cola.  La captura de pantalla siguiente muestra la versi√≥n final de trabajo de la aplicaci√≥n web, que muestra el estado actual de la compilaci√≥n, la cola de arreglos privados y el historial de su ensamblaje.  En nuestro ejemplo, solo se considera la cola para ensamblar arreglos privados. <br><br><h2>  Lo que era mio </h2><br><ul><li>  Un generador de arreglos privados que recopil√≥ arreglos privados del conjunto de shell TFS al iniciar una aplicaci√≥n de consola con los par√°metros de l√≠nea de comandos dados. <br></li><li>  Veeam.Builder.Agent: un servicio WCF escrito por Veeam que inicia la aplicaci√≥n con par√°metros en modo consola bajo el usuario actual y devuelve el estado actual de la aplicaci√≥n. <br></li><li>  El servicio web IIS es una aplicaci√≥n en formularios Windows Forms que le permite ingresar el nombre del shellset, los par√°metros especificados y comenzar el proceso de creaci√≥n de una soluci√≥n privada. <br></li><li>  Un conocimiento de programaci√≥n muy superficial es C ++, un poco de C # en la universidad, y escribe peque√±as aplicaciones para la automatizaci√≥n, agregando nuevas funciones a los procesos de construcci√≥n actuales y como un pasatiempo. <br></li><li>  Los colegas con experiencia, Google y los art√≠culos indios de MSDN son fuentes de respuestas a todas las preguntas. <br></li></ul><br><h2>  Que haremos </h2><br>  En este art√≠culo contar√© c√≥mo implement√© la puesta en cola del ensamblaje de arreglos y su lanzamiento secuencial en el generador.  Aqu√≠ est√°n las partes de la soluci√≥n: <br><br><ul><li>  QBuilder.AppQueue es mi servicio WCF que proporciona trabajo con la cola de compilaci√≥n y llama al servicio Veeam.Builder.Agent para ejecutar el programa de compilaci√≥n. <br></li><li>  dummybuild.exe es un programa de c√≥digo auxiliar utilizado para la depuraci√≥n y como una ayuda visual.  Necesario para visualizar los par√°metros transferidos. <br></li><li>  QBuilder.AppLauncher: servicio WCF que ejecuta aplicaciones en la consola del usuario actual y funciona en modo interactivo.  Este es un an√°logo significativamente simplificado del programa Veeam.Builder.Agent escrito espec√≠ficamente para este art√≠culo.  El servicio original puede funcionar como un servicio de Windows y ejecutar aplicaciones en la consola, lo que requiere un trabajo adicional con la API de Windows.  Para describir todos los trucos, se requerir√≠a un art√≠culo separado.  Mi ejemplo funciona como un simple servicio de consola interactiva y usa dos funciones: iniciar un proceso con par√°metros y verificar su estado. <br></li></ul><br>  Adem√°s, creamos una nueva aplicaci√≥n web conveniente que puede trabajar con varios constructores y mantener registros de eventos.  Para no sobrecargar el art√≠culo, tampoco hablaremos de √©l en detalle.  Adem√°s, este art√≠culo no describe el trabajo con TFS, con el historial de almacenamiento de arreglos privados recopilados y varias clases y funciones auxiliares. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d3c/c13/6b9/d3cc136b9f661a26314f2a44eff3a4b3.jpg"><br><br><h2>  Crear servicios WCF </h2><br>  Hay muchos art√≠culos detallados que describen la creaci√≥n de servicios WCF.  Me gust√≥ sobre todo el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">material del sitio de Microsoft</a> .  Lo tom√© como base para el desarrollo.  Para facilitar mi conocimiento del proyecto, tambi√©n present√© los <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">binarios</a> .  ¬°Empecemos! <br><br><h3>  Cree el servicio QBuilder.AppLauncher </h3><br>  Aqu√≠ solo tendremos el disco primario del servicio.  En esta etapa, debemos asegurarnos de que el servicio se inicie y funcione.  Adem√°s, el c√≥digo es id√©ntico para QBuilder.AppLauncher y QBuilder.AppQueue, por lo que este proceso deber√° repetirse dos veces. <br><br><ol><li>  Cree una nueva aplicaci√≥n de consola llamada QBuilder.AppLauncher <br></li><li>  Cambiar el nombre de Program.cs a Service.cs <br></li><li>  Cambiar el nombre del espacio de nombres a QBuilder.AppLauncher <br></li><li>  Agregue las siguientes referencias al proyecto: <br>  a.  System.ServiceModel.dll <br>  b.  System.ServiceProcess.dll <br>  c.  System.Configuration.Install.dll <br></li><li>  Agregue las siguientes definiciones a Service.cs <br><br><pre><code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.ComponentModel; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.ServiceModel; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.ServiceProcess; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Configuration; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Configuration.Install;</code> </pre> <br>  Durante el montaje posterior, tambi√©n se necesitar√°n las siguientes definiciones: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Reflection; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Xml.Linq; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Xml.XPath;</code> </pre> </li><li>  Definimos la interfaz IAppLauncher y agregamos funciones para trabajar con la cola: <br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">//    [ServiceContract(Namespace = "http://QBuilder.AppLauncher")]   public interface IAppLauncher   {    //             [OperationContract]       bool TestConnection();   }</span></span></code> </pre></li><li>  En la clase AppLauncherService, implementamos la interfaz y la funci√≥n de prueba TestConnection: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">AppLauncherService</span></span> : <span class="hljs-title"><span class="hljs-title">IAppLauncher</span></span>   {       <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TestConnection</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>       {           <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>;       }   }</code> </pre></li><li>  Cree una nueva clase AppLauncherWindowsService que herede la clase ServiceBase.  Agregue la variable local serviceHost, un enlace a ServiceHost.  Definimos el m√©todo Main, que llama a ServiceBase.Run (nuevo AppLauncherWindowsService ()): <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">AppLauncherWindowsService</span></span> : <span class="hljs-title"><span class="hljs-title">ServiceBase</span></span>   {       <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> ServiceHost serviceHost = <span class="hljs-literal"><span class="hljs-literal">null</span></span>;       <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AppLauncherWindowsService</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>       {           <span class="hljs-comment"><span class="hljs-comment">// Name the Windows Service           ServiceName = "QBuilder App Launcher";       }       public static void Main()       {           ServiceBase.Run(new AppLauncherWindowsService());       }</span></span></code> </pre></li><li>  Anule la funci√≥n OnStart () que crea la nueva instancia de ServiceHost: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnStart</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] args</span></span></span><span class="hljs-function">)</span></span>       {           <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (serviceHost != <span class="hljs-literal"><span class="hljs-literal">null</span></span>)           {               serviceHost.Close();           }           <span class="hljs-comment"><span class="hljs-comment">// Create a ServiceHost for the CalculatorService type and           // provide the base address.           serviceHost = new ServiceHost(typeof(AppLauncherService));           // Open the ServiceHostBase to create listeners and start           // listening for messages.           serviceHost.Open();       }</span></span></code> </pre></li><li>  Anule la funci√≥n onStop que cierra la instancia de ServiceHost: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnStop</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>       {           <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (serviceHost != <span class="hljs-literal"><span class="hljs-literal">null</span></span>)           {               serviceHost.Close();               serviceHost = <span class="hljs-literal"><span class="hljs-literal">null</span></span>;           }       }   }</code> </pre></li><li>  Cree una nueva clase ProjectInstaller, heredada del instalador y marcada con RunInstallerAttribute, que se establece en True.  Esto le permite instalar el servicio de Windows utilizando el programa installutil.exe: <br><br><pre> <code class="cs hljs">[<span class="hljs-meta"><span class="hljs-meta">RunInstaller(true)</span></span>]   <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">ProjectInstaller</span></span> : <span class="hljs-title"><span class="hljs-title">Installer</span></span>   {       <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> ServiceProcessInstaller process;       <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> ServiceInstaller service;       <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ProjectInstaller</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>       {           process = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ServiceProcessInstaller();           process.Account = ServiceAccount.LocalSystem;           service = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ServiceInstaller();           service.ServiceName = <span class="hljs-string"><span class="hljs-string">"QBuilder App Launcher"</span></span>;           Installers.Add(process);           Installers.Add(service);       }   }</code> </pre></li><li>  Cambie el contenido del archivo app.config: <br><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8" ?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">configuration</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">system.serviceModel</span></span></span><span class="hljs-tag">&gt;</span></span>   <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">services</span></span></span><span class="hljs-tag">&gt;</span></span>     <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">service</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"QBuilder.AppLauncher.AppLauncherService"</span></span></span><span class="hljs-tag">              </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">behaviorConfiguration</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"AppLauncherServiceBehavior"</span></span></span><span class="hljs-tag">&gt;</span></span>       <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">host</span></span></span><span class="hljs-tag">&gt;</span></span>         <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">baseAddresses</span></span></span><span class="hljs-tag">&gt;</span></span>           <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">add</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">baseAddress</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://localhost:8000/QBuilderAppLauncher/service"</span></span></span><span class="hljs-tag">/&gt;</span></span>         <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">baseAddresses</span></span></span><span class="hljs-tag">&gt;</span></span>       <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">host</span></span></span><span class="hljs-tag">&gt;</span></span>       <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">endpoint</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">address</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag">                 </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">binding</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wsHttpBinding"</span></span></span><span class="hljs-tag">                 </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">contract</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"QBuilder.AppLauncher.IAppLauncher"</span></span></span><span class="hljs-tag"> /&gt;</span></span>       <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">endpoint</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">address</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"mex"</span></span></span><span class="hljs-tag">                 </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">binding</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"mexHttpBinding"</span></span></span><span class="hljs-tag">                 </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">contract</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"IMetadataExchange"</span></span></span><span class="hljs-tag"> /&gt;</span></span>     <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">service</span></span></span><span class="hljs-tag">&gt;</span></span>   <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">services</span></span></span><span class="hljs-tag">&gt;</span></span>   <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">behaviors</span></span></span><span class="hljs-tag">&gt;</span></span>     <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">serviceBehaviors</span></span></span><span class="hljs-tag">&gt;</span></span>       <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">behavior</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"AppLauncherServiceBehavior"</span></span></span><span class="hljs-tag">&gt;</span></span>         <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">serviceMetadata</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">httpGetEnabled</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag">/&gt;</span></span>         <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">serviceDebug</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">includeExceptionDetailInFaults</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"False"</span></span></span><span class="hljs-tag">/&gt;</span></span>       <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">behavior</span></span></span><span class="hljs-tag">&gt;</span></span>     <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">serviceBehaviors</span></span></span><span class="hljs-tag">&gt;</span></span>   <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">behaviors</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">system.serviceModel</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">configuration</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> </li></ol><br><h3>  Comprobaci√≥n de la capacidad de servicio del servicio. </h3><br><ol><li>  Recopilamos el servicio. <br></li><li>  Inst√°lelo con el comando installutil.exe <br>  1) Vaya a la carpeta donde se encuentra el archivo de servicio compilado <br>  2) Ejecute el comando de instalaci√≥n: <br>  C: \ Windows \ Microsoft.NET \ Framework64 \ v4.0.30319 \ InstallUtil.exe </li><li>  Entramos en el complemento services.msc, verificamos la disponibilidad del servicio QBuilder App Launcher y lo ejecutamos. <br></li><li>  Verificamos la capacidad de servicio del servicio utilizando el programa WcfTestClient.exe, que se incluye con VisualStudio: <br><br>  1) Ejecute WcfTestClient <br>  2) Agregue la direcci√≥n del servicio: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">http: // localhost: 8000 / QBuilderAppLauncher / service</a> <br>  3) Se abre la interfaz de servicio: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f32/d38/35e/f32d3835e5b7ddcb399f7e48b3028df9.png"><br><br>  4) Llamamos a la funci√≥n de prueba TestConnection, verificamos que todo funcione y la funci√≥n devuelve un valor: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/00e/96a/460/00e96a46098ebee72c99b32357930759.png"></li></ol><br>  Ahora que tenemos un disco funcional del servicio, agregamos las funciones que necesitamos. <br><br><h3>  ¬øPor qu√© necesito una funci√≥n de prueba que no hace nada? </h3><br>  Cuando comenc√© a aprender a escribir un servicio WCF desde cero, le√≠ un mont√≥n de art√≠culos sobre este tema.  Sobre la mesa ten√≠a una docena o dos hojas impresas en las que pod√≠a averiguar qu√© y c√≥mo.  Admito que no logr√© iniciar el servicio de inmediato.  Pas√© mucho tiempo y llegu√© a la conclusi√≥n de que es realmente importante hacer un disco de servicio.  Con √©l estar√°s seguro de que todo funciona y podr√°s comenzar a implementar las funciones necesarias.  El enfoque puede parecer un desperdicio, pero facilitar√° la vida si un mont√≥n de c√≥digo escrito no funciona como deber√≠a. <br><br><h3>  Agregue la capacidad de ejecutar desde la consola </h3><br>  De vuelta a la aplicaci√≥n.  En la etapa de depuraci√≥n y en otros casos, es necesario iniciar el servicio en forma de una aplicaci√≥n de consola sin registrarse como servicio.  Esta es una caracter√≠stica muy √∫til que le permite prescindir del uso tedioso de depuradores.  Es en este modo que funciona el servicio QBuilder.AppLauncher.  Aqu√≠ se explica c√≥mo implementarlo: <br><br><ol><li>  Agregue el procedimiento RunInteractive a la clase AppLauncherWindowsService, que proporciona el servicio en modo consola: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RunInteractive</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">ServiceBase[] services</span></span></span><span class="hljs-function">)</span></span> {   Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"Service is running in interactive mode."</span></span>);   Console.WriteLine();   <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> start = <span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(ServiceBase).GetMethod(<span class="hljs-string"><span class="hljs-string">"OnStart"</span></span>, BindingFlags.Instance | BindingFlags.NonPublic);   <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> service <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> services)   {       Console.Write(<span class="hljs-string"><span class="hljs-string">"Starting {0}..."</span></span>, service.ServiceName);       start.Invoke(service, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">object</span></span>[] { <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>[] { } });       Console.Write(<span class="hljs-string"><span class="hljs-string">"Started {0}"</span></span>, service.ServiceName);   }   Console.WriteLine();   Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"Press any key to stop the services and end the process..."</span></span>);   Console.ReadKey();   Console.WriteLine();   <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> stop = <span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(ServiceBase).GetMethod(<span class="hljs-string"><span class="hljs-string">"OnStop"</span></span>, BindingFlags.Instance | BindingFlags.NonPublic);   <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> service <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> services)   {       Console.Write(<span class="hljs-string"><span class="hljs-string">"Stopping {0}..."</span></span>, service.ServiceName);       stop.Invoke(service, <span class="hljs-literal"><span class="hljs-literal">null</span></span>);       Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"Stopped {0}"</span></span>, service.ServiceName);   }   Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"All services stopped."</span></span>); }</code> </pre></li><li>  Realizamos cambios en el procedimiento Principal: agregue el procesamiento de los par√°metros de la l√≠nea de comandos.  Con la opci√≥n / console y una sesi√≥n de usuario activa abierta, lanzamos el programa en modo interactivo.  De lo contrario, lo lanzamos como un servicio. <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Main</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] args</span></span></span><span class="hljs-function">)</span></span> {   <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> services = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ServiceBase[]   {       <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> AppLauncherWindowsService()   };   <span class="hljs-comment"><span class="hljs-comment">//           ,      /console   if (args.Length == 1 &amp;&amp; args[0] == "/console" &amp;&amp; Environment.UserInteractive)   {       //            RunInteractive(services);   }   else   {       //          ServiceBase.Run(services);   } }</span></span></code> </pre></li></ol><br><h3>  Agregue funciones para iniciar la aplicaci√≥n y verificar su estado </h3><br>  El servicio se hace extremadamente simple, no hay controles adicionales.  Solo puede ejecutar aplicaciones en la versi√≥n de consola y en nombre del administrador.  Tambi√©n puede iniciarlos como un servicio, pero no los ver√°, girar√°n en segundo plano y solo podr√° verlos a trav√©s del Administrador de tareas.  Todo esto se puede implementar, pero este es un tema para un art√≠culo separado.  Lo principal para nosotros aqu√≠ es un claro ejemplo de trabajo. <br><br><ol><li>  Primero, agregue la variable global appProcess, que almacena el proceso actualmente en ejecuci√≥n. <br><br>  <code>public class AppLauncherService : IAppLauncher</code> a la <code>public class AppLauncherService : IAppLauncher</code> : <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">AppLauncherService</span></span> : <span class="hljs-title"><span class="hljs-title">IAppLauncher</span></span>   {       Process appProcess;</code> </pre></li><li>  Agregue una funci√≥n a la misma clase que verifica el estado del proceso en ejecuci√≥n: <br><br><pre> <code class="cs hljs">   <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">IsStarted</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>       {           <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (appProcess!=<span class="hljs-literal"><span class="hljs-literal">null</span></span>)           {               <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (appProcess.HasExited)               {                   <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>;               }               <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>               {                   <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>;               }           }           <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>           {               <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>;           }       }</code> </pre><br>  La funci√≥n devuelve falso si el proceso no existe o no se est√° ejecutando, y verdadero si el proceso est√° activo. <br></li><li>  Agregue la funci√≥n para iniciar la aplicaci√≥n: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Start</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> fileName, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> arguments, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> workingDirectory, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> domain, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> userName, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> timeoutInMinutes</span></span></span><span class="hljs-function">)</span></span>       {           ProcessStartInfo processStartInfo = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ProcessStartInfo();           processStartInfo.FileName = fileName;           processStartInfo.Arguments = arguments;           processStartInfo.Domain = domain;           processStartInfo.UserName = userName;           processStartInfo.CreateNoWindow = <span class="hljs-literal"><span class="hljs-literal">false</span></span>;           processStartInfo.UseShellExecute = <span class="hljs-literal"><span class="hljs-literal">false</span></span>;           <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>           {               <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (appProcess!=<span class="hljs-literal"><span class="hljs-literal">null</span></span>)               {                   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!appProcess.HasExited)                   {                       Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"Process is still running. Waiting..."</span></span>);                       <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>;                   }               }           }           <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Exception ex)           {               Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"Error while checking process: {0}"</span></span>, ex);           }           <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>           {               appProcess = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Process();               appProcess.StartInfo = processStartInfo;               appProcess.Start();           }           <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Exception ex)           {               Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"Error while starting process: {0}"</span></span>,ex);           }           <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>;                          }</code> </pre></li></ol><br>  La funci√≥n inicia cualquier aplicaci√≥n con par√°metros.  Los par√°metros de dominio y nombre de usuario no se utilizan en este contexto y pueden estar vac√≠os, ya que el servicio inicia la aplicaci√≥n desde la sesi√≥n de la consola con derechos de administrador. <br><br><h3>  Lanzamiento del servicio QBuilder.AppLauncher </h3><br>  Como se describi√≥ anteriormente, este servicio funciona de manera interactiva y le permite ejecutar aplicaciones en la sesi√≥n actual del usuario, verifica si el proceso se est√° ejecutando o si ya se complet√≥. <br><br><ol><li>  Para trabajar, necesita los archivos QBuilder.AppLauncher.exe y QBuilder.AppLauncher.exe.config, que se encuentran en el archivo en el enlace de arriba.  El c√≥digo fuente de esta aplicaci√≥n para el autoensamblaje tambi√©n se encuentra all√≠. <br></li><li>  Iniciamos el servicio con derechos de administrador. <br></li><li>  Se abrir√° la ventana de la consola del servicio: <br></li></ol><br><img src="https://habrastorage.org/getpro/habr/post_images/981/e79/eb4/981e79eb4757690818462d72cbba5cc4.png"><br><br>  Cualquier pulsaci√≥n en la consola de servicio la cierra, tenga cuidado. <br><br><ol><li>  Para las pruebas, ejecute wcftestclient.exe, que se incluye con Visual Studio.  Verificamos la disponibilidad del servicio en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">http: // localhost: 8000 / QBuilderAppLauncher / service</a> o abrimos el enlace en Internet Explorer. <br></li></ol><br>  Si todo funciona, vaya al siguiente paso. <br><br><h3>  Crear el servicio QBuilder.AppQueue </h3><br>  ¬°Y ahora pasemos al servicio m√°s importante, para el que se escribi√≥ todo el art√≠culo!  Repetimos la secuencia de acciones en el cap√≠tulo "Creaci√≥n del servicio QBuilder.AppLauncher" y en el cap√≠tulo "Agregar el lanzamiento desde la consola", reemplazando AppLauncher con AppQueue en el c√≥digo. <br><br><h3>  Agregue un enlace al servicio QBuilder.AppLauncher para usar en el servicio de cola </h3><br><ol><li>  En el Explorador de soluciones para nuestro proyecto, seleccione Agregar referencia de servicio y especifique la direcci√≥n: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">localhost</a> : 8000 / QBuilderAppLauncher / service <br></li><li>  Seleccione el espacio de nombres: AppLauncherService. <br></li></ol><br>  Ahora podemos acceder a la interfaz de servicio desde nuestro programa. <br><br><h3>  Crear una estructura para almacenar elementos de cola </h3><br>  En el espacio de nombres de QBuilder.AppQueue, agregue la clase QBuildRecord: <br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">// ,     public class QBuildRecord { // ID  public string BuildId { get; set; } // ID  public string IssueId { get; set; } //   public string IssueName { get; set; } //    public DateTime StartDate { get; set; } //    public DateTime FinishDate { get; set; } //    C# public bool Build_CSharp { get; set; } //    C++ public bool Build_Cpp { get; set; } }</span></span></code> </pre> <br><h3>  Implementaci√≥n de la clase de cola CXmlQueue </h3><br>  Agregamos la clase CXmlQueue.cs a nuestro proyecto, donde se ubicar√°n varios procedimientos para trabajar con el archivo XML: <br><br><ul><li>  Constructor CXmlQueue: establece el nombre inicial del archivo donde se almacena la cola. <br></li><li>  SetCurrentBuild: escribe informaci√≥n sobre la compilaci√≥n actual en el archivo XML de la cola.  Este es un elemento que no est√° en la cola; almacena informaci√≥n sobre el proceso actualmente en ejecuci√≥n.  Puede estar vacio <br></li><li>  GetCurrentBuild: obtiene los par√°metros del proceso en ejecuci√≥n del archivo XML de cola.  Puede estar vacio <br></li><li>  ClearCurrentBuild: borra el elemento de construcci√≥n actual en el archivo XML de cola si el proceso finaliza. <br></li><li>  OpenXmlQueue: funci√≥n para abrir el archivo XML donde se almacena la cola.  Si falta el archivo, se crea uno nuevo. <br></li><li>  GetLastQueueBuildNumber: cada compilaci√≥n en la cola tiene su propio n√∫mero de serie √∫nico.  Esta funci√≥n devuelve su valor, que se almacena en el atributo ra√≠z. <br></li><li>  IncrementLastQueueBuildNumber: aumenta el valor del n√∫mero de compilaci√≥n al poner en cola una nueva compilaci√≥n. <br></li><li>  GetCurrentQueue: devuelve una lista de elementos QBuildRecord del archivo XML de la cola. <br></li></ul><br>  En el c√≥digo original, todos estos procedimientos se colocaron en la clase principal, pero para mayor claridad, hice una clase separada CXmlQueue.  La clase se crea en el espacio de nombres QBuilder.AppQueue, verifique que se hayan especificado todas las definiciones necesarias: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections.Generic; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Linq; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Text; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Threading.Tasks; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Xml.Linq; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Xml.XPath; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.IO; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">QBuilder.AppQueue</span></span> { . . . }</code> </pre> <br>  Entonces, estamos implementando.  La clase CXmlQueue en s√≠ misma: <br><br><div class="spoiler">  <b class="spoiler_title">Haga clic para expandir el spoiler con c√≥digo</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">//      XML  public class CXmlQueue { //  ,    string xmlBuildQueueFile; public CXmlQueue(string _xmlQueueFile) { xmlBuildQueueFile = _xmlQueueFile; } public string GetQueueFileName() { return xmlBuildQueueFile; } // ,       xml (   xml) public QBuildRecord GetCurrentBuild() { QBuildRecord qBr; XElement xRoot = OpenXmlQueue(); XElement xCurrentBuild = xRoot.XPathSelectElement("currentbuild"); if (xCurrentBuild != null) { qBr = new QBuildRecord(); qBr.BuildId = xCurrentBuild.Attribute("BuildId").Value; qBr.IssueId = xCurrentBuild.Attribute("IssueId").Value; qBr.StartDate = Convert.ToDateTime(xCurrentBuild.Attribute("StartDate").Value); return qBr; } return null; } // ,       xml (   xml) public void SetCurrentBuild(QBuildRecord qbr) { XElement xRoot = OpenXmlQueue(); XElement newXe = (new XElement( "currentbuild", new XAttribute("BuildId", qbr.BuildId), new XAttribute("IssueId", qbr.IssueId), new XAttribute("StartDate", DateTime.Now.ToString()) )); XElement xCurrentBuild = xRoot.XPathSelectElement("currentbuild"); if (xCurrentBuild != null) { xCurrentBuild.Remove(); // remove old value } xRoot.Add(newXe); xRoot.Save(xmlBuildQueueFile); } // ,       xml,  ,    public void ClearCurrentBuild() { XElement xRoot = OpenXmlQueue(); try { XElement xCurrentBuild = xRoot.XPathSelectElement("currentbuild"); if (xCurrentBuild != null) { Console.WriteLine("Clearing current build information."); xCurrentBuild.Remove(); } } catch (Exception ex) { Console.WriteLine("XML queue doesn't have running build yet. Nothing to clear!"); } xRoot.Save(xmlBuildQueueFile); } //   XML           public XElement OpenXmlQueue() { XElement xRoot; if (File.Exists(xmlBuildQueueFile)) { xRoot = XElement.Load(xmlBuildQueueFile, LoadOptions.None); } else { Console.WriteLine("Queue file {0} not found. Creating...", xmlBuildQueueFile); XElement xE = new XElement("BuildsQueue", new XAttribute("BuildNumber", 0)); xE.Save(xmlBuildQueueFile); xRoot = XElement.Load(xmlBuildQueueFile, LoadOptions.None); } return xRoot; } //       public int GetLastQueueBuildNumber() { XElement xRoot = OpenXmlQueue(); if (xRoot.HasAttributes) return int.Parse(xRoot.Attribute("BuildNumber").Value); return 0; } //              public int IncrementLastQueueBuildNumber() { int buildIndex = GetLastQueueBuildNumber(); buildIndex++; XElement xRoot = OpenXmlQueue(); xRoot.Attribute("BuildNumber").Value = buildIndex.ToString(); xRoot.Save(xmlBuildQueueFile); return buildIndex; } //    xml     QBuildRecord public List&lt;QBuildRecord&gt; GetCurrentQueue() { List&lt;QBuildRecord&gt; qList = new List&lt;QBuildRecord&gt;(); XElement xRoot = OpenXmlQueue(); if (xRoot.XPathSelectElements("build").Any()) { List&lt;XElement&gt; xBuilds = xRoot.XPathSelectElements("build").ToList(); foreach (XElement xe in xBuilds) { qList.Add(new QBuildRecord { BuildId = xe.Attribute("BuildId").Value, IssueId = xe.Attribute("IssueId").Value, IssueName = xe.Attribute("IssueName").Value, StartDate = Convert.ToDateTime(xe.Attribute("StartDate").Value), Build_CSharp = bool.Parse(xe.Attribute("Build_CSharp").Value), Build_Cpp = bool.Parse(xe.Attribute("Build_Cpp").Value) }); } } return qList; } }</span></span></code> </pre> <br></div></div><br>  La cola en el archivo XML es la siguiente: <br><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">BuildsQueue</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">BuildNumber</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"23"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">build</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">BuildId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"14"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IssueId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"26086"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IssueName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"TestIssueName"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">StartDate</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2018-06-13T16:49:50.515238+02:00"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Build_CSharp</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Build_Cpp</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">build</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">BuildId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"15"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IssueId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"59559"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IssueName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"TestIssueName"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">StartDate</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2018-06-13T16:49:50.6880927+02:00"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Build_CSharp</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Build_Cpp</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">build</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">BuildId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"16"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IssueId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"45275"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IssueName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"TestIssueName"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">StartDate</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2018-06-13T16:49:50.859937+02:00"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Build_CSharp</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Build_Cpp</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">build</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">BuildId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"17"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IssueId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"30990"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IssueName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"TestIssueName"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">StartDate</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2018-06-13T16:49:51.0321322+02:00"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Build_CSharp</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Build_Cpp</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">build</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">BuildId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"18"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IssueId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"16706"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IssueName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"TestIssueName"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">StartDate</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2018-06-13T16:49:51.2009904+02:00"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Build_CSharp</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Build_Cpp</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">build</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">BuildId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"19"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IssueId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"66540"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IssueName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"TestIssueName"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">StartDate</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2018-06-13T16:49:51.3581274+02:00"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Build_CSharp</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Build_Cpp</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">build</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">BuildId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"20"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IssueId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"68618"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IssueName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"TestIssueName"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">StartDate</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2018-06-13T16:49:51.5087854+02:00"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Build_CSharp</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Build_Cpp</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">build</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">BuildId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"21"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IssueId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"18453"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IssueName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"TestIssueName"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">StartDate</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2018-06-13T16:49:51.6713477+02:00"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Build_CSharp</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Build_Cpp</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">build</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">BuildId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"22"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IssueId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"68288"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IssueName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"TestIssueName"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">StartDate</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2018-06-13T16:49:51.8277942+02:00"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Build_CSharp</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Build_Cpp</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">build</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">BuildId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"23"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IssueId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"89884"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IssueName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"TestIssueName"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">StartDate</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2018-06-13T16:49:52.0151294+02:00"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Build_CSharp</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Build_Cpp</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">currentbuild</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">BuildId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"13"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IssueId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"4491"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">StartDate</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"13.06.2018 16:53:16"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">BuildsQueue</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Cree un archivo BuildQueue.xml con este contenido y p√≥ngalo en el directorio con el archivo ejecutable.  Este archivo se utilizar√° en la depuraci√≥n de prueba para que coincida con los resultados de la prueba. <br><br><h3>  Agregar clase de funciones auxiliares </h3><br>  En esta clase, coloco funciones de ayuda.  En este momento solo hay una funci√≥n, FormatParameters, que realiza el formateo de los par√°metros para pasarlos a la aplicaci√≥n de consola para su lanzamiento.  Listado del archivo AuxFunctions.cs: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections.Generic; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Linq; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Text; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Threading.Tasks; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">QBuilder.AppQueue</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">AuxFunctions</span></span> { <span class="hljs-comment"><span class="hljs-comment">//       public static string FormatParameters(string fileName, IDictionary&lt;string, string&gt; parameters) { if (String.IsNullOrWhiteSpace(fileName)) { throw new ArgumentNullException("fileName"); } if (parameters == null) { throw new ArgumentNullException("parameters"); } var macros = String.Join(" ", parameters.Select(parameter =&gt; String.Format("\"{0}={1}\"", parameter.Key, parameter.Value.Replace(@"""", @"\""")))); return String.Format("{0} /b \"{1}\"", macros, fileName); } } }</span></span></code> </pre> <br><h3>  Agregar nuevas funciones a la interfaz de servicio </h3><br>  La funci√≥n de prueba TestConnection se puede eliminar en esta etapa.  Para implementar el trabajo de la cola, necesitaba el siguiente conjunto de funciones: <br><br><ul><li>  PushBuild (QBuildRecord): nulo.  Esta es una funci√≥n que agrega un nuevo valor al archivo XML de cola con los par√°metros QBuildRecord <br></li><li>  TestPushBuild (): nulo.  Esta es una funci√≥n de prueba que agrega datos de prueba a una cola en un archivo XML. <br></li><li>  PullBuild: QBuildRecord.  Esta es una funci√≥n que recupera el valor QBuildRecord del archivo XML de la cola.  Puede estar vacio. <br></li></ul><br>  La interfaz ser√° as√≠: <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> <span class="hljs-title"><span class="hljs-title">IAppQueue</span></span> { <span class="hljs-comment"><span class="hljs-comment">//     [OperationContract] void PushBuild(QBuildRecord qBRecord); //     [OperationContract] void TestPushBuild(); //      [OperationContract] QBuildRecord PullBuild(); }</span></span></code> </pre><br><h3>  Implementamos funciones en la clase AppQueueService: IAppQueue: </h3><br><br><div class="spoiler">  <b class="spoiler_title">Haga clic para expandir el spoiler con c√≥digo</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">AppQueueService</span></span> : <span class="hljs-title"><span class="hljs-title">IAppQueue</span></span> { <span class="hljs-comment"><span class="hljs-comment">//  ,    public AppLauncherClient buildAgent; // ,      private string _xmlQueueFile; public AppQueueService() { //       .     ,  . _xmlQueueFile = ConfigurationManager.AppSettings["QueueFileName"]; } public QBuildRecord PullBuild() { QBuildRecord qBr; CXmlQueue xmlQueue = new CXmlQueue(_xmlQueueFile); XElement xRoot = xmlQueue.OpenXmlQueue(); if (xRoot.XPathSelectElements("build").Any()) { qBr = new QBuildRecord(); XElement xe = xRoot.XPathSelectElements("build").FirstOrDefault(); qBr.BuildId = xe.Attribute("BuildId").Value; qBr.IssueId = xe.Attribute("IssueId").Value; qBr.IssueName = xe.Attribute("IssueName").Value; qBr.StartDate = Convert.ToDateTime(xe.Attribute("StartDate").Value); qBr.Build_CSharp = bool.Parse(xe.Attribute("Build_CSharp").Value); qBr.Build_Cpp = bool.Parse(xe.Attribute("Build_Cpp").Value); xe.Remove(); // Remove first element xRoot.Save(xmlQueue.GetQueueFileName()); return qBr; } return null; } public void PushBuild(QBuildRecord qBRecord) { CXmlQueue xmlQueue = new CXmlQueue(_xmlQueueFile); XElement xRoot = xmlQueue.OpenXmlQueue(); xRoot.Add(new XElement( "build", new XAttribute("BuildId", qBRecord.BuildId), new XAttribute("IssueId", qBRecord.IssueId), new XAttribute("IssueName", qBRecord.IssueName), new XAttribute("StartDate", qBRecord.StartDate), new XAttribute("Build_CSharp", qBRecord.Build_CSharp), new XAttribute("Build_Cpp", qBRecord.Build_Cpp) )); xRoot.Save(xmlQueue.GetQueueFileName()); } public void TestPushBuild() { CXmlQueue xmlQueue = new CXmlQueue(_xmlQueueFile); Console.WriteLine("Using queue file: {0}",xmlQueue.GetQueueFileName()); int buildIndex = xmlQueue.IncrementLastQueueBuildNumber(); Random rnd = new Random(); PushBuild (new QBuildRecord { Build_CSharp = true, Build_Cpp = true, BuildId = buildIndex.ToString(), StartDate = DateTime.Now, IssueId = rnd.Next(100000).ToString(), IssueName = "TestIssueName" } ); } }</span></span></code> </pre> <br></div></div><br><h3>  Realizar cambios en AppQueueWindowsService: clase ServiceBase </h3><br>  Agregue nuevas variables al cuerpo de la clase: <br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">// ,         private System.Timers.Timer timer; // ,       public QBuildRecord currentBuild; //public QBuildRecord processingBuild; // ,       public bool clientStarted; //    public string xmlBuildQueueFileName; //   public CXmlQueue xmlQueue; //         public string btWorkingDir; public string btLocalDomain; public string btUserName; public string buildToolPath; public string btScriptPath; public int agentTimeoutInMinutes; //  public AppQueueService buildQueueService;</span></span></code> </pre><br>  En el constructor AppQueueWindowsService (), agregue funciones para leer el archivo de configuraci√≥n, inicializar servicios y clases de cola: <br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">//          try { xmlBuildQueueFileName = ConfigurationManager.AppSettings["QueueFileName"]; buildToolPath = ConfigurationManager.AppSettings["BuildToolPath"]; btWorkingDir = ConfigurationManager.AppSettings["BuildToolWorkDir"]; btLocalDomain = ConfigurationManager.AppSettings["LocalDomain"]; btUserName = ConfigurationManager.AppSettings["UserName"]; btScriptPath = ConfigurationManager.AppSettings["ScriptPath"]; agentTimeout= 30000; //    buildQueueService = new AppQueueService(); //    xmlQueue = new CXmlQueue(xmlBuildQueueFileName); } catch (Exception ex) { Console.WriteLine("Error while loading configuration: {0}", ex); }</span></span></code> </pre> <br>  AgentTimeout: frecuencia de respuesta del temporizador.  Indicado en milisegundos.  Aqu√≠ establecemos que el temporizador debe disparar cada 30 segundos.  En el original, este par√°metro est√° en el archivo de configuraci√≥n.  Para el art√≠culo, decid√≠ establecerlo en c√≥digo. <br><br>  Agregue la funci√≥n para verificar el proceso de compilaci√≥n en ejecuci√≥n a la clase: <br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">//        public bool BuildIsStarted() { IAppLauncher builderAgent; try { builderAgent = new AppLauncherClient(); return builderAgent.IsStarted(); } catch (Exception ex) { return false; } }</span></span></code> </pre><br>  Agregue el procedimiento para trabajar con el temporizador: <br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TimerTick</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> sender, System.Timers.ElapsedEventArgs e</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-comment"><span class="hljs-comment">//     if (!BuildIsStarted()) { //     clientStarted,     if (clientStarted) { //     ,  clientStarted  false      currentBuild.FinishDate = DateTime.Now; clientStarted = false; } else { //       clientStarted=false ( ) -      xmlQueue.ClearCurrentBuild(); } //        currentBuild = buildQueueService.PullBuild(); //    ,     if (currentBuild != null) { //     true -    clientStarted = true; //   currentbuild -     xml            xmlQueue.SetCurrentBuild(currentBuild); //      var parameters = new Dictionary&lt;string, string&gt;(StringComparer.OrdinalIgnoreCase) { {"BUILD_ID", currentBuild.BuildId}, {"ISSUE_ID", currentBuild.IssueId}, {"ISSUE_NAME", currentBuild.IssueName}, {"BUILD_CSHARP", currentBuild.Build_CSharp ? "1" : "0"}, {"BUILD_CPP", currentBuild.Build_Cpp ? "1" : "0"} }; //       var arguments = AuxFunctions.FormatParameters(btScriptPath, parameters); try { //          AppLauncher IAppLauncher builderAgent = new AppLauncherClient(); builderAgent.Start(buildToolPath, arguments, btWorkingDir, btLocalDomain, btUserName, agentTimeout); } catch (Exception ex) { Console.WriteLine(ex); } } } } catch (Exception ex) { Console.WriteLine(ex); } }</span></span></code> </pre> <br>     OnStart,     : <br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">//     OnStart protected override void OnStart(string[] args) { if (serviceHost != null) { serviceHost.Close(); } //      this.timer = new System.Timers.Timer(agentTimeout); //    this.timer.AutoReset = true; this.timer.Elapsed += new System.Timers.ElapsedEventHandler(this.TimerTick); this.timer.Start(); //  ServiceHost   AppQueueService serviceHost = new ServiceHost(typeof(AppQueueService)); //  ServiceHostBase      serviceHost.Open(); }</span></span></code> </pre> <br><h3>     </h3><br>      : <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections.Generic; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Linq; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Text; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.ComponentModel; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.ServiceModel; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.ServiceProcess; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Configuration; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Configuration.Install; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Reflection; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Xml.Linq; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Xml.XPath; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> QBuilder.AppQueue.AppLauncherService;</code> </pre><br><h3>     App.config </h3><br>      : <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">appSettings</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">add</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">key</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"QueueFileName"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"BuildQueue.xml"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">add</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">key</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"BuildToolPath"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"c:\temp\dummybuild.exe"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">add</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">key</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"BuildToolWorkDir"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"c:\temp\"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">add</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">key</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"LocalDomain"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"."</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">add</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">key</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"UserName"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"username"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">add</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">key</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ScriptPath"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"C:\Temp\BuildSample.bld"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">appSettings</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><br><h2>    </h2><br><ol><li>   QBuilder.AppLauncher.zip.        <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="></a> . <br></li><li>   dummybuild.exe     binaries  , ,  c:\temp.           ,     .     ,     BuildToolPath  BuildToolWorkDir   . <br></li><li>    \QBuilder.AppLauncher\binaries\QBuilder.AppLauncher\    QBuilder.AppLauncher.exe   .        . <br></li><li>       QBuilder.AppQueue.exe /console   . <br></li><li> ,     : <br><br><img src="https://habrastorage.org/getpro/habr/post_images/18b/e4a/b17/18be4ab1798effcc29cfa113f6b75452.png"><br></li><li>   .    ,   30    : <br><br><img src="https://habrastorage.org/getpro/habr/post_images/251/681/2a0/2516812a03c79a5c9b2d9811fbbdb0a0.png"><br></li><li>   BuildQueue.xml  ,       currentbuild: <br><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">BuildsQueue</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">BuildNumber</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"23"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">build</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">BuildId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"19"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IssueId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"66540"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IssueName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"TestIssueName"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">StartDate</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2018-06-13T16:49:51.3581274+02:00"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Build_CSharp</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Build_Cpp</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">build</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">BuildId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"20"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IssueId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"68618"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IssueName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"TestIssueName"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">StartDate</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2018-06-13T16:49:51.5087854+02:00"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Build_CSharp</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Build_Cpp</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">build</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">BuildId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"21"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IssueId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"18453"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IssueName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"TestIssueName"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">StartDate</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2018-06-13T16:49:51.6713477+02:00"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Build_CSharp</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Build_Cpp</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">build</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">BuildId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"22"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IssueId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"68288"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IssueName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"TestIssueName"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">StartDate</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2018-06-13T16:49:51.8277942+02:00"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Build_CSharp</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Build_Cpp</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">build</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">BuildId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"23"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IssueId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"89884"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IssueName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"TestIssueName"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">StartDate</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2018-06-13T16:49:52.0151294+02:00"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Build_CSharp</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Build_Cpp</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">currentbuild</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">BuildId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"18"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IssueId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"16706"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">StartDate</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"13.06.2018 23:20:06"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">BuildsQueue</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br></li><li>     dummy   ,       : <br><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">BuildsQueue</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">BuildNumber</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"23"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">build</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">BuildId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"21"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IssueId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"18453"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IssueName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"TestIssueName"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">StartDate</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2018-06-13T16:49:51.6713477+02:00"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Build_CSharp</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Build_Cpp</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">build</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">BuildId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"22"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IssueId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"68288"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IssueName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"TestIssueName"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">StartDate</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2018-06-13T16:49:51.8277942+02:00"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Build_CSharp</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Build_Cpp</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">build</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">BuildId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"23"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IssueId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"89884"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IssueName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"TestIssueName"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">StartDate</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2018-06-13T16:49:52.0151294+02:00"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Build_CSharp</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Build_Cpp</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">currentbuild</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">BuildId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"20"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IssueId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"68618"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">StartDate</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"13.06.2018 23:24:25"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">BuildsQueue</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> </li></ol><br>  ! <br><br><h2>  Resultados </h2><br>   powershell-    .      C#.      rulesets ‚Äî ,                setup-.                ‚Äî  ,          .          ‚Äî     MD5-   -,            . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/dea/641/fbe/dea641fbea68d0be6417a2e757928d6b.png"><br> <i>  ,      </i> <br><br>      ,        ‚Äî             .    ,         ,    .      -    . <br><br>     ,    XML,   ,   .       ,       .        ,     ,    . <br><br> ,        WCF-,          XML-.         : <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/U4rXSbt_OMo" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br> <b>PS</b>     ,          .  ,        ,       . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es417701/">https://habr.com/ru/post/es417701/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es417687/index.html">Asimetr√≠a de la vida</a></li>
<li><a href="../es417689/index.html">Mobio habla con el CEO de Appnext sobre el mercado CPI y las tendencias de aplicaciones m√≥viles</a></li>
<li><a href="../es417691/index.html">Nuestra estanter√≠a es un programador de C #. Que hay de ti</a></li>
<li><a href="../es417697/index.html">Editor de im√°genes simple en VueJS</a></li>
<li><a href="../es417699/index.html">Western Digital cierra otra f√°brica de HDD debido a la menor demanda</a></li>
<li><a href="../es417703/index.html">C√≥digo de red Age of Empires: 1,500 arqueros por m√≥dem de 28.8 kbps</a></li>
<li><a href="../es417705/index.html">C√≥mo un fabricante de tarjetas gr√°ficas afecta la rentabilidad de la miner√≠a de GPU</a></li>
<li><a href="../es417707/index.html">CSS-in-JS - mitos y realidad (componentes con estilo como ejemplo)</a></li>
<li><a href="../es417709/index.html">¬øD√≥nde y c√≥mo califican los desarrolladores a sus empleadores? Servicios de valoraci√≥n de empresas en la industria de TI.</a></li>
<li><a href="../es417711/index.html">¬øQu√© leer en Swift en ruso?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>