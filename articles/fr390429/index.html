<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üéΩ ‚õ±Ô∏è üëï Faire un simple bateau a√©rodynamique RC üö∂üèø üí≠ üíÉ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Parfois, sur Internet, je vois des questions de d√©butants qui veulent construire un quadricopt√®re √† partir de z√©ro et √©crire un firmware pour cela. Je...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Faire un simple bateau a√©rodynamique RC</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/390429/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Parfois, sur Internet, je vois des questions de d√©butants qui veulent construire un quadricopt√®re √† partir de z√©ro et √©crire un firmware pour cela. </font><font style="vertical-align: inherit;">Je le suis moi-m√™me et pour m'exercer √† cr√©er des mod√®les RC, j'ai d√©cid√© de commencer avec quelque chose de plus simple. </font></font><br>
<br>
<img src="https://habrastorage.org/files/7dd/6f2/46e/7dd6f246e98e47b8b5f3eda1ccdd14b0.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans l'article en d√©tail pour le plus petit, il a d√©crit l'algorithme du bateau, le panneau de commande et le choix des composants.</font></font><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pourquoi bateau a√©rien?</font></font></h2><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Simple;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bon march√©;</font></font></li>
<li>     ;</li>
<li>     ,  -.</li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voler des v√©hicules est g√©nial, mais difficile. </font><font style="vertical-align: inherit;">Vous ne pouvez pas simplement d√©sactiver les vis en l'air en cas de probl√®me. </font><font style="vertical-align: inherit;">Oui, et une pouss√©e sp√©cifique est n√©cessaire tr√®s d√©cente, m√™me pour les avions, sans parler des multicopt√®res. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Plateformes comme celle-ci </font></font><br>
<br>
<img src="https://habrastorage.org/files/2ea/857/305/2ea8573051be4afcbe6aaf40c94a753d.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">il</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y a une description plus d√©taill√©e ici). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ils ne peuvent se d√©placer que dans la plupart des cas sur une surface lisse artificielle et leur contr√¥le est tr√®s diff√©rent. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais sur l'eau, nous pouvons naviguer n'importe o√π, ce qui nous donnera √† l'avenir la possibilit√© de faire un pilote automatique √† l'aide du GPS. </font><font style="vertical-align: inherit;">La conception classique avec une h√©lice est compliqu√©e pour moi par l'unit√© de sortie d'arbre du bo√Ætier - je ne peux pas imaginer comment l'√©tancher. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Plus d'avantages d'un syst√®me de propulsion pneumatique:</font></font><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il peut √™tre pos√© sur diff√©rentes plateformes: un bateau, un tra√Æneau, un morceau de polystyr√®ne ...</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il n'attrape pas le fond ni les algues.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il est n√©cessaire que l'appareil puisse tourner. </font><font style="vertical-align: inherit;">Il y a 3 options:</font></font><br>
<ol>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Une vis + volant pour les virages</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Une vis + son syst√®me de tournage</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Deux vis fixes. </font><font style="vertical-align: inherit;">Tourner en changeant leurs envies est le moyen le plus simple. </font><font style="vertical-align: inherit;">Il l'a utilis√©.</font></font></li>
</ol><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T√©l√©commande</font></font></h2><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Principe de fonctionnement</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1 joystick + plusieurs interrupteurs. </font><font style="vertical-align: inherit;">La t√©l√©commande a pour t√¢che d'envoyer des donn√©es sur la position de la poign√©e du joystick et des commutateurs plusieurs fois par seconde.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Que faire</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout d'abord, vous avez besoin d'un √©metteur radio. L'option la moins ch√®re est NRF24L01 +, co√ªte </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,85 $</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Deuxi√®mement, vous avez besoin d'un joystick. Un autre </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 $</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Plusieurs commutateurs - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,12 $</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eh bien, tout cela est fix√© sur un morceau de PCB pour </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,13 $</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
D√©j√† compt√© 2,1 $, mais j'ai encore besoin de MK et de nourriture. Tout n'est pas si clair ici. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour l'avenir, je dirai que ATmega8 ou STM8S103F3P6 est assez suffisant, mais depuis que j'ai commenc√© ce projet depuis longtemps et qu'il y avait peu d'exp√©rience, je l'ai claqu√© dans le panneau de contr√¥le Arduino Pro Mini et dans le bateau Arduino Nano (ATmega32P partout). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans la t√©l√©commande encore n√©cessaire:</font></font><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Convertisseur de puissance 0,9 - 5 V -&gt; 5 V pour alimenter Arduino pour </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,35 $</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (le connecteur USB, avec un morceau de la carte, peut √™tre rompu pour plus de compacit√©);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Stabilisateur 3,3 V AMS1117-3,3 pour alimenter le module radio, ils co√ªtent </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,03 $ par unit√©</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Compartiment √† piles pour une pile √† un doigt pour </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,15 $</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Total plus 0,53 $. </font><font style="vertical-align: inherit;">Mis √† part le contr√¥leur, une paire de condensateurs et de fils, le co√ªt des composants de la console est de 2,63 $.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Remplissage du mod√®le RC</font></font></h2><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Composants</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout vient des moteurs. </font><font style="vertical-align: inherit;">Quels moteurs vous achetez, l'√©lectronique devra √™tre install√©e avec une telle puissance, et la base (navire, tra√Æneau) sera n√©cessaire pour la capacit√© de charge correspondante. </font><font style="vertical-align: inherit;">Et id√©ologiquement, tout le reste n'est n√©cessaire que pour faire tourner les vis √† la bonne vitesse. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai achet√© ces moteurs avec des h√©lices </font></font><br>
<br>
<img src="https://habrastorage.org/files/02a/811/047/02a8110476e840e68848408e6fcc4872.jpg"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
pour </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2,88 $ la paire</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il a pris le L293D comme conducteur de moteur - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,35 $ de plus</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Et ici un tas de probl√®mes</font></font></b><div class="spoiler_text"> L293D         .                             ,   .<br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La nourriture. </font><font style="vertical-align: inherit;">Nous aurons besoin de jusqu'√† trois tensions d'alimentation:</font></font><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5 V pour tous les appareils √©lectroniques sauf le module radio;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3,3 V pour le module radio;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pour les moteurs autant qu'ils en ont besoin (le mien 4,2 V).</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1 et 2, nous obtenons les m√™mes que dans le panneau de commande, et pour les moteurs, nous mettons MT3608 pour </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,86 $</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, pour la partie amusante: le gyroscope. </font><font style="vertical-align: inherit;">Le module MPU-6050 </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">co√ªte 1,53 $</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Il y avait un d√©sir d'utiliser √©galement l'acc√©l√©rom√®tre, de sorte que lorsque le joystick se d√©place sur le c√¥t√©, le navire se d√©plie en place. </font><font style="vertical-align: inherit;">Mais au final, il a abandonn√© cette id√©e: une l√©g√®re pente de tangage, et le syst√®me commence √† penser qu'il acc√©l√®re vers l'avant ou vers l'arri√®re. </font><font style="vertical-align: inherit;">Il s'est av√©r√© plus facile de mettre le navire en place simplement en compensant le mouvement avant / arri√®re avec le joystick. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ajoutez √† cela 0,4 $ pour le compartiment de la batterie pour 2 piles AA et obtenez 6,4 $ de composants sans contr√¥leur ni fils.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le programme</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et encore une fois, allons des moteurs. </font><font style="vertical-align: inherit;">Chacun des deux moteurs entra√Æn√©s par le L293D peut </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ou non creuser</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tournez en avant;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Retournez;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ne tordez pas.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour faciliter la lecture du code, √©crivez </font></font><div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6 fonctions</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">inline</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">motLeftStop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{<font></font>
  PORTD &amp;= ~(<span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; MOT_LEFT_PLUS);<font></font>
  PORTD &amp;= ~(<span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; MOT_LEFT_MINUS);<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">inline</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">motLeftForward</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{    <font></font>
  PORTD |= <span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; MOT_LEFT_PLUS;<font></font>
  PORTD &amp;= ~(<span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; MOT_LEFT_MINUS);<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">inline</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">motLeftBackward</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{<font></font>
  PORTD &amp;= ~(<span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; MOT_LEFT_PLUS);<font></font>
  PORTD |= <span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; MOT_LEFT_MINUS;<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">inline</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">motRightStop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{<font></font>
  PORTD &amp;= ~(<span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; MOT_RIGHT_PLUS);<font></font>
  PORTD &amp;= ~(<span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; MOT_RIGHT_MINUS);<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">inline</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">motRightForward</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{<font></font>
  PORTD |= <span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; MOT_RIGHT_PLUS;<font></font>
  PORTD &amp;= ~(<span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; MOT_RIGHT_MINUS);<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">inline</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">motRightBackward</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{<font></font>
  PORTD &amp;= ~(<span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; MOT_RIGHT_PLUS);<font></font>
  PORTD |= <span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; MOT_RIGHT_MINUS;<font></font>
}<font></font>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, nous voulons contr√¥ler la vitesse de rotation des vis. </font><font style="vertical-align: inherit;">Bien s√ªr, nous le ferons en utilisant PWM. </font><font style="vertical-align: inherit;">Je ne sais pas si un tel PWM peut √™tre fait dans le mat√©riel ... Je l'ai fait interrompre par programme. </font><font style="vertical-align: inherit;">D√©clarez une paire de variables globales</font></font><br>
<pre><code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">int8_t</span></span> motLeft = <span class="hljs-number"><span class="hljs-number">0</span></span>, motRight = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-comment"><span class="hljs-comment">// -127..+127</span></span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Laissez les valeurs de ces variables &lt;0 signifier que vous devez tourner en arri√®re, les valeurs&gt; 0 - en avant, et si elles sont 0, alors vous n'avez pas besoin de tordre.</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous allons √©crire des gestionnaires d'interruption de minuterie</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs">ISR(TIMER2_OVF_vect)<font></font>
{<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(motLeft &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>)<font></font>
    motLeftForward();<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(motLeft &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>)<font></font>
    motLeftBackward();<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(motRight &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>)<font></font>
    motRightForward();<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(motRight &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>)<font></font>
    motRightBackward();<font></font>
}<font></font>
<font></font>
ISR(TIMER2_COMPA_vect)<font></font>
{<font></font>
  motLeftStop();<font></font>
}<font></font>
<font></font>
ISR(TIMER2_COMPB_vect)<font></font>
{<font></font>
  motRightStop();<font></font>
}<font></font>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, pour changer la vitesse de rotation de l'h√©lice, nous devons faire 2 actions:</font></font><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√âcrivez une valeur positive, n√©gative ou nulle dans motLeft / motRight (le module n'est pas important);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Enregistrez la "vitesse de rotation" dans OCR2A / OCR2B.</font></font></li>
</ol><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√âcrivons quelques fonctions suppl√©mentaires pour cela</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setMotLeft</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int8_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> v)</span></span></span></span>{ <span class="hljs-comment"><span class="hljs-comment">// -127..+127</span></span>
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">abs</span></span>(v) &lt; <span class="hljs-number"><span class="hljs-number">5</span></span>) v = <span class="hljs-number"><span class="hljs-number">0</span></span>;<font></font>
  motLeft = v;  <font></font>
  OCR2A = <span class="hljs-built_in"><span class="hljs-built_in">abs</span></span>(v) * <span class="hljs-number"><span class="hljs-number">2</span></span>;<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setMotRight</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int8_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> v)</span></span></span></span>{ <span class="hljs-comment"><span class="hljs-comment">// -127..+127</span></span>
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">abs</span></span>(v) &lt; <span class="hljs-number"><span class="hljs-number">5</span></span>) v = <span class="hljs-number"><span class="hljs-number">0</span></span>;<font></font>
  motRight = v;<font></font>
  OCR2B = <span class="hljs-built_in"><span class="hljs-built_in">abs</span></span>(v) * <span class="hljs-number"><span class="hljs-number">2</span></span>;<font></font>
}<font></font>
</code></pre><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">abs</span></span>(v) &lt; <span class="hljs-number"><span class="hljs-number">5</span></span>) v = <span class="hljs-number"><span class="hljs-number">0</span></span>;
</code></pre><br>
            OCR2x   5 (      ).<br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Reste maintenant √† configurer les broches MK et la minuterie</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">motInit</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{<font></font>
  DDRD |= (<span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; MOT_LEFT_PLUS) | (<span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; MOT_LEFT_MINUS) | (<span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; MOT_RIGHT_PLUS) | (<span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; MOT_RIGHT_MINUS);
  <span class="hljs-comment"><span class="hljs-comment">//TCCR2B |= (1 &lt;&lt; CS22)|(1 &lt;&lt; CS21)|(1 &lt;&lt; CS20); // set up timer with prescaler = 1024.   16 </span></span>
  <span class="hljs-comment"><span class="hljs-comment">//TCCR2B |= (1 &lt;&lt; CS22)|(0 &lt;&lt; CS21)|(0 &lt;&lt; CS20); // set up timer with prescaler = 64.   1 </span></span>
  TCCR2B |= (<span class="hljs-number"><span class="hljs-number">0</span></span> &lt;&lt; CS22)|(<span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; CS21)|(<span class="hljs-number"><span class="hljs-number">0</span></span> &lt;&lt; CS20); <span class="hljs-comment"><span class="hljs-comment">// set up timer with prescaler = 8.  128 </span></span>
  <span class="hljs-comment"><span class="hljs-comment">//TCCR2B |= (0 &lt;&lt; CS22)|(0 &lt;&lt; CS21)|(1 &lt;&lt; CS20); // set up timer with prescaler = 1.  16 </span></span>
  TIMSK2 |= (<span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; TOIE2)|(<span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; OCIE2A)|(<span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; OCIE2B); <span class="hljs-comment"><span class="hljs-comment">// enable overflow interrupt</span></span>
  TCCR2A &amp;= ~(<span class="hljs-number"><span class="hljs-number">3</span></span>); <span class="hljs-comment"><span class="hljs-comment">// set WGM20 = 0, WGM21 = 0</span></span>
  TCCR2B &amp;= ~(<span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; <span class="hljs-number"><span class="hljs-number">3</span></span>); <span class="hljs-comment"><span class="hljs-comment">// set WGM22 = 0</span></span>
  setMotLeft(<span class="hljs-number"><span class="hljs-number">0</span></span>);<font></font>
  setMotRight(<span class="hljs-number"><span class="hljs-number">0</span></span>);<font></font>
  sei();<font></font>
}<font></font>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et vous pouvez contr√¥ler les moteurs simplement en appelant les fonctions setMotLeft (int8_t v) et setMotRight (int8_t v). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais nous voulons mal contr√¥ler le bateau! </font><font style="vertical-align: inherit;">Nous voulons donner des commandes comme "avant / arri√®re" et "droite / gauche"! </font><font style="vertical-align: inherit;">Et laissez-la comprendre quelles h√©lices elle doit tourner pour cela. </font><font style="vertical-align: inherit;">De plus, je veux que le bateau lui-m√™me compense l'effet de rotation du vent, des courants et ... des h√©lices tordues! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Allons maintenant de l‚Äôautre c√¥t√©. </font><font style="vertical-align: inherit;">De la t√©l√©commande. </font><font style="vertical-align: inherit;">Dans le cas le plus simple, l'algorithme de son fonctionnement est le suivant:</font></font><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lors de la mise sous tension, rappelez-vous la position initiale du joystick;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Au cours du cycle, lisez la position du joystick, soustrayez-en la position z√©ro et envoyez des donn√©es au bateau.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Notre module radio prend en charge des paquets jusqu'√† 32 octets. </font><font style="vertical-align: inherit;">Afin de ne pas m√©moriser les d√©calages, nous utiliserons l'enregistrement</font></font><br>
<pre><code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ControlStatus</span></span></span><span class="hljs-class">{</span></span>
  <span class="hljs-keyword"><span class="hljs-keyword">int16_t</span></span> x,y;<font></font>
}  controlStatus;<font></font>
</code></pre><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comme suit</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs">    <span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span> packet[MAX_BUFF]; 
    <span class="hljs-built_in"><span class="hljs-built_in">memset</span></span>(packet, <span class="hljs-number"><span class="hljs-number">0</span></span>, MAX_BUFF);    <font></font>
    controlStatus.x = (<span class="hljs-keyword"><span class="hljs-keyword">int16_t</span></span>)analogRead(<span class="hljs-number"><span class="hljs-number">1</span></span>) - x0;<font></font>
    controlStatus.y = (<span class="hljs-keyword"><span class="hljs-keyword">int16_t</span></span>)analogRead(<span class="hljs-number"><span class="hljs-number">0</span></span>) - y0;
    <span class="hljs-built_in"><span class="hljs-built_in">memcpy</span></span>(packet, &amp;controlStatus, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(controlStatus));<font></font>
    Mirf.send(packet);<font></font>
    <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(Mirf.isSending()){;};
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C√¥t√© r√©cepteur, nous d√©clarerons exactement le m√™me record et </font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nous le remplirons</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs">  <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (Mirf.dataReady()) { 
    <span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span> data[MAX_BUFF];<font></font>
    Mirf.getData(data);<font></font>
    <span class="hljs-built_in"><span class="hljs-built_in">memcpy</span></span>(&amp;controlStatus, data, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(controlStatus));<font></font>
    setMotRot(-controlStatus.x);<font></font>
    setMotForward(controlStatus.y); <font></font>
  }<font></font>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans les fonctions setMotRot et setMotForward</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√©crire les valeurs dans les variables globales motRot et motForward</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setMotRot</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int16_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> v)</span></span></span></span>{
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">abs</span></span>(v)&lt;<span class="hljs-number"><span class="hljs-number">10</span></span>) v = <span class="hljs-number"><span class="hljs-number">0</span></span>;<font></font>
  motRot = (<span class="hljs-keyword"><span class="hljs-keyword">int32_t</span></span>)v;<font></font>
}<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setMotForward</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int16_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> v)</span></span></span></span>{
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">abs</span></span>(v)&lt;<span class="hljs-number"><span class="hljs-number">10</span></span>) v = <span class="hljs-number"><span class="hljs-number">0</span></span>;<font></font>
  motForward = (<span class="hljs-keyword"><span class="hljs-keyword">int32_t</span></span>)v;<font></font>
}<font></font>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et passons au plus int√©ressant. </font><font style="vertical-align: inherit;">Pour savoir comment convertir "tourner √† gauche √† une vitesse de 5 degr√©s par seconde et avancer un peu!" </font><font style="vertical-align: inherit;">"moteur gauche 10% en arri√®re, 20% droit en avant!". </font><font style="vertical-align: inherit;">Beaucoup a √©t√© √©crit </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
sur ce que </font><font style="vertical-align: inherit;">sont les </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">contr√¥leurs PID</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">J'ai utilis√© seulement deux composants pour la rotation:</font></font><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Proportionnelle;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Int√©grale.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et pour aller et venir, le r√©gulateur ne l'a pas utilis√©. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Prenons un exemple:</font></font><br>
<pre><code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">int32_t</span></span> iDeltaRot = <span class="hljs-number"><span class="hljs-number">0</span></span>;
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">motTick</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{
  <span class="hljs-keyword"><span class="hljs-keyword">int32_t</span></span> rot = getRotAvg(); <span class="hljs-comment"><span class="hljs-comment">//     </span></span>
  <span class="hljs-keyword"><span class="hljs-keyword">int32_t</span></span> deltaRot = rot - motRot * rotMaxSpeed / <span class="hljs-number"><span class="hljs-number">512</span></span>;<font></font>
  iDeltaRot += deltaRot;<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">int32_t</span></span> motRight = (<span class="hljs-keyword"><span class="hljs-keyword">int32_t</span></span>)motForward * forwardMult - deltaRot * rotMult - iDeltaRot * iDeltaRotMult, <font></font>
          motLeft  = (<span class="hljs-keyword"><span class="hljs-keyword">int32_t</span></span>)motForward * forwardMult + deltaRot * rotMult + iDeltaRot * iDeltaRotMult;  <font></font>
<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">int32_t</span></span> motMax = max(<span class="hljs-built_in"><span class="hljs-built_in">abs</span></span>(motRight), <span class="hljs-built_in"><span class="hljs-built_in">abs</span></span>(motLeft));
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(motMax &gt; <span class="hljs-number"><span class="hljs-number">127</span></span>){<font></font>
    motRight = (<span class="hljs-keyword"><span class="hljs-keyword">int32_t</span></span>)motRight * <span class="hljs-number"><span class="hljs-number">127</span></span> / motMax;<font></font>
    motLeft  = (<span class="hljs-keyword"><span class="hljs-keyword">int32_t</span></span>)motLeft  * <span class="hljs-number"><span class="hljs-number">127</span></span> / motMax;<font></font>
  }<font></font>
  <font></font>
  setMotRight(motRight);<font></font>
  setMotLeft(motLeft);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le code a √©t√© simplifi√© afin de se concentrer sur les parties importantes; l'archive aura la version compl√®te. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Que faisons-nous ici?</font></font><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous calculons la diff√©rence entre la vitesse r√©elle de rotation du bateau (pourriture) et celle souhait√©e (motRot * rotMaxSpeed);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous calculons les vitesses de rotation souhait√©es des vis motRight et motLeft;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si les vitesses de rotation souhait√©es d√©passent le maximum possible, on les r√©duit tout en conservant le rapport entre elles;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous appelons setMotRight / setMotLeft que nous connaissons d√©j√†.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C‚Äôest tout! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ceci est l'algorithme de contr√¥le de bateau entier! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Est-ce difficile? </font><font style="vertical-align: inherit;">Je pense que non. </font><font style="vertical-align: inherit;">Mais, n√©anmoins, au cours des tests et des r√©glages, tout un tas de probl√®mes ont surgi qui entra√Æneraient de nombreux accidents s'il s'agissait d'un avion. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il y a 4 coefficients dans la fonction d√©crite:</font></font><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">forwardMult - sensibilit√© au mouvement du joystick vers l'avant / vers l'arri√®re;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rotMaxSpeed ‚Äã‚Äã- la vitesse de rotation souhait√©e lors de l'inclinaison compl√®te du joystick vers la droite / gauche;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rotMult - coefficient de la composante proportionnelle (dans quelle mesure l'√©cart de la vitesse de rotation actuelle par rapport √† la vitesse souhait√©e affecte la rotation);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">iDeltaRotMult - coefficient de la composante int√©grale (dans quelle mesure l'√©cart de l'angle de rotation actuel par rapport √† l'angle souhait√© affecte la rotation).</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ces coefficients sont r√©gl√©s exp√©rimentalement, et la r√©action du bateau au joystick et aux influences de d√©ploiement externes en d√©pendra.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Indication d'√©tat</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lors du d√©bogage / r√©glage, il y aura de la confusion dans la s√©rie "pourquoi le bateau r√©agit-il au joystick pas comme je le veux?". </font><font style="vertical-align: inherit;">Certains points peuvent √™tre d√©bogu√©s en affichant des informations de d√©bogage sur un PC, mais il serait plus pratique de comprendre ce qui se passe sur place. </font><font style="vertical-align: inherit;">Au d√©but, j'ai envisag√© 2 options:</font></font><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ordinateur portable;</font></font></li>
<li><div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LCD Nokia 5110</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/files/a23/fc5/65d/a23fc565d564418bad9c2ad6a1144f0c.jpg"><br>
</div></div></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les inconv√©nients des deux sont compr√©hensibles: l'ordinateur portable est grand et inconfortable √† transporter avec vous, et l'√©cran du Nokia 5110 ne vous permettra pas d'afficher simultan√©ment un grand nombre de param√®tres d'√©tat du bateau. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai pris un croisement entre eux: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nextion Enhanced NX4827K043 - √âcran tactile HMI g√©n√©rique de 4,3 pouces</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Gr√¢ce √† l'√©cran tactile, vous pouvez ajuster rapidement et facilement les param√®tres du bateau lors de vos d√©placements. </font><font style="vertical-align: inherit;">Il s'agit d'une sorte d'ordinateur compos√© de:</font></font><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Microcontr√¥leur GD32F103R8T6;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SDRAM Winbond W9864G6KH-6 (8 Mo);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M√©moire flash Winbond W25Q256FVFG (32 Mo, 100 000 cycles de r√©√©criture, ce qui est tr√®s bon);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FPGA Altera MAX II EPM570T144C5N.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout dans l'assemblage ressemble √† ceci (cliquable): </font><font style="vertical-align: inherit;">
Cet ordinateur / √©cran est une bo√Æte noire et est con√ßu pour interagir avec une personne. M√™me le GPIO existant est affin√© pour connecter les boutons et les indicateurs. Leur </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">carte d'extension le</font></a><font style="vertical-align: inherit;"> confirme. Ainsi, l'utilisation du contr√¥leur int√©gr√© comme t√©l√©commande pour le bateau (pour lire le joystick, pour √©changer des donn√©es avec le module radio NRF24L01 +) √©chouera. Pour interagir avec le microcontr√¥leur, il y a UART et ... c'est tout. </font><font style="vertical-align: inherit;">
√Ä propos de comment et de ce que vous pouvez faire avec cet affichage, vous pouvez le faire, il est √©crit un tas de + il y a des vid√©os sur Youtube. Voir, par exemple, </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">ce</font></a></font><br>
<br>
<a href=""><img src="https://habrastorage.org/files/b78/b67/ad2/b78b67ad2ffd4f00a0e82daae979dad8.JPG"></a><br>
<br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- tout y est clairement montr√©. </font><font style="vertical-align: inherit;">Mais comme cet affichage est plus cher que tous les autres composants du bateau et de la console combin√©s, je d√©crirai plus en d√©tail mes impressions de travailler avec lui. </font><font style="vertical-align: inherit;">Cela aidera peut-√™tre quelqu'un √† comprendre si cette option lui convient ou si l'ordinateur portable / √©cran Nokia 5110 sera pr√©f√©rable. </font><font style="vertical-align: inherit;">Avantages du Nextion Enhanced NX4827K043:</font></font><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tr√®s simple d'utilisation. </font><font style="vertical-align: inherit;">Il y a une documentation simple, des exemples, des vid√©os sur Youtube, ... En quelques heures, vous pouvez le comprendre √† partir de z√©ro. </font><font style="vertical-align: inherit;">Presque tout ce que vous devez savoir sur lui se trouve sur deux pages: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">page wiki</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jeu d'instructions</font></font></a></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D√©veloppement tr√®s rapide. </font><font style="vertical-align: inherit;">Un √©diteur visuel comme Visual Studio (seulement plus facile). </font><font style="vertical-align: inherit;">J'ai jet√© des composants et tout fonctionne.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Composants de haute qualit√©. </font><font style="vertical-align: inherit;">La m√™me m√©moire flash pour 100 000 cycles de r√©√©criture.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un d√©bogueur qui peut simuler un affichage √† l'aide d'un PC et communiquer avec votre MK via un port COM. </font><font style="vertical-align: inherit;">Vous permet de d√©velopper compl√®tement l'appareil, de d√©boguer et d'acheter un √©cran, uniquement si tout fonctionne.</font></font><div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bien qu'il y ait un probl√®me avec lui</font></font></b><div class="spoiler_text">            .    . ,         ,         .<br>
</div></div></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Capteur r√©sistif </font><font style="vertical-align: inherit;">Vous pouvez cr√©er des commandes assez petites et les pousser avec votre ongle ou n'importe quel stylet.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Inconv√©nients:</font></font><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Prix </font><font style="vertical-align: inherit;">50 $, c'est encore beaucoup pour un √©cran de 4,3 pouces.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il y a peu de composants existants, peu de param√®tres de composants, comment cr√©er le v√¥tre n'est pas clair. </font><font style="vertical-align: inherit;">Ceci est partiellement compens√© par les fonctions de dessin des primitives (lignes, rectangles, cercles, ...).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le composant Gauge standard scintille lors de la mise √† niveau.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Non (du moins je n'ai pas trouv√©) de transparence.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exigences d'alimentation: 4.75-7 V et courant moyen 250 mA. </font><font style="vertical-align: inherit;">Lorsque la tension baisse, l'affichage commence √† clignoter.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UART uniquement. </font><font style="vertical-align: inherit;">Pourrait communiquer avec lui sur SPI et I¬≤C.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sortie GPIO uniquement pour une boucle (pas de peigne 2,54 mm), pas d'ADC.</font></font></li>
</ol><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En g√©n√©ral, l'affichage donne l'impression d'un produit de tr√®s haute qualit√©, facile et agr√©able √† travailler. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'√©cran peut effectuer deux t√¢ches √† la fois:</font></font><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Indication d'√©tat. </font><font style="vertical-align: inherit;">Je suis principalement int√©ress√© par:</font></font><br>
 <ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Vitesses de rotation" des vis;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La valeur de la variable iDeltaRot est la diff√©rence entre l'angle de braquage souhait√© et l'angle souhait√©;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vitesse de rotation du bateau;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Angle de rotation du bateau;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fr√©quence de r√©ception des paquets de la t√©l√©commande;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La fr√©quence des appels √† la fonction motTick.</font></font></li>
</ul><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D√©finition des param√®tres, √† savoir ceux d√©crits ci-dessus forwardMult, rotMaxSpeed, rotMult, iDeltaRotMult.</font></font></li>
</ol><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cr√©ation de 2 pages (cliquables pour l'√©valuation de la qualit√©):</font></font><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Indications:</font></font><br>
 <br>
<a href=""><img src="https://habrastorage.org/files/6f7/aaa/571/6f7aaa57152e48a5b92e6555d230d863.JPG"></a><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R√©glages des param√®tres: </font><font style="vertical-align: inherit;">
4 premi√®res colonnes de gauche √† droite: forwardMult, rotMult, iDeltaRotMult, rotMaxSpeed.</font></font><br>
 <br>
<a href=""><img src="https://habrastorage.org/files/256/9f6/22d/2569f622dc234426b0dc8d4352a8488e.JPG"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
</li>
</ol><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bateau d'essai vid√©o au sol:</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/kwHMI4QUjIs" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La r√©action du bateau √† un effet de d√©pliage externe √† divers iDeltaRotMult (coefficients int√©graux):</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/3numZhKZnic" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
D√©monstration de l'influence des param√®tres sur l'eau:</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/QuOtIunGEME" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La vid√©o en eau libre n'a pas pu √™tre captur√©e. </font><font style="vertical-align: inherit;">Vous pouvez croire que sa tenue de route est bonne et que la vitesse maximale n'est pas tr√®s √©lev√©e.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CARACT√âRISTIQUES</font></font></h2><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Baguette 9 g;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Poids 115 g, dont les batteries p√®sent 52 g;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'acc√©l√©ration maximale est de 0,77 m / s ^ 2. </font><font style="vertical-align: inherit;">Pour l'homme √† 5 km / h, s'il n'y avait pas de r√©sistance √† l'eau, le bateau acc√©l√©rerait en 1,8 s;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le co√ªt des composants est d'environ 15 $ si vous utilisez l'Arduino Nano √† la fois dans la t√©l√©commande et dans le bateau (sans √©cran ni piles).</font></font></li>
</ul><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusion</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour ceux qui souhaitent r√©cup√©rer quelque chose de radiocommand√©, je recommande de commencer par un navire avec deux h√©lices fixes. </font><font style="vertical-align: inherit;">√Ä mon avis, c'est la chose la plus simple qui puisse √™tre faite dans ce domaine. </font></font><br>
<br>
<a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Archiver avec des projets</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Et enfin, pour qu'il y ait quelque chose √† rechercher, voici une vid√©o d'un appareil incroyable:</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/_iqqHAWJq_0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr390429/">https://habr.com/ru/post/fr390429/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr390419/index.html">Connectez la matrice LED au Raspberry pi</a></li>
<li><a href="../fr390421/index.html">Radio stick DVB √† 8 $ - Explorer la SDR avec GNURadio</a></li>
<li><a href="../fr390423/index.html">La clause d'apocalypse zombie d'Amazon a √©t√© ajout√©e aux politiques de services Web d'Amazon</a></li>
<li><a href="../fr390425/index.html">Les robots ont appris √† cuisiner des ramen, √† changer leur couleur et leur taille</a></li>
<li><a href="../fr390427/index.html">D√©bogage de code Arduino (AVR). Partie 1. D√©bogage virtuel</a></li>
<li><a href="../fr390431/index.html">Projecteurs Epson EH-TW5210, EH-TW5300 et EH-TW5350 - meilleurs, plus rapides, plus lumineux</a></li>
<li><a href="../fr390435/index.html">Les math√©maticiens ont construit une carte des connexions dans l'univers de Star Wars</a></li>
<li><a href="../fr390437/index.html">Altim√®tre-variom√®tre √©lectronique fait maison avec signaux sonores et lumineux</a></li>
<li><a href="../fr390439/index.html">Reflets interbandes Andreev sur les contacts de van der Waals entre le graph√®ne et le s√©l√©niure de niobium</a></li>
<li><a href="../fr390441/index.html">Eclipse #include <Arduino.h></a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>