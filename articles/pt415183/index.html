<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§ΩüèΩ üë®üèº‚Äçüíº üßëüèø Extens√£o da Web entre navegadores para scripts personalizados Parte 1 ‚èπÔ∏è üë∞üèæ üëßüèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Nesta s√©rie de artigos, quero falar sobre minha experi√™ncia em escrever uma extens√£o da web para navegadores. Eu j√° tinha experi√™ncia na cria√ß√£o de um...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Extens√£o da Web entre navegadores para scripts personalizados Parte 1</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/415183/"> Nesta s√©rie de artigos, quero falar sobre minha experi√™ncia em escrever uma extens√£o da web para navegadores.  Eu j√° tinha experi√™ncia na cria√ß√£o de uma extens√£o da Web, instalada por cerca de 100.000 usu√°rios do Chrome, que funcionavam de forma aut√¥noma, mas nesta s√©rie de artigos eu decidi me aprofundar no processo de desenvolvimento da extens√£o da Web, integrando-a firmemente ao lado do servidor. <br><br><img width="65" src="https://habrastorage.org/getpro/habr/post_images/188/09a/2d6/18809a2d60126c22c85f0dbb38c188dc.png" alt="imagem"><img width="65" src="https://habrastorage.org/getpro/habr/post_images/474/b37/7c9/474b377c9fd5df452ee6b2ae849c2891.png" alt="imagem"><img width="65" src="https://habrastorage.org/getpro/habr/post_images/804/cc0/c91/804cc0c91bd30f83537540bd6aca22df.png" alt="imagem"><img width="65" src="https://habrastorage.org/getpro/habr/post_images/94e/097/462/94e097462cb7f3af3b482312f6fd2ee9.png" alt="imagem"><img width="65" src="https://habrastorage.org/getpro/habr/post_images/4bf/d73/6f6/4bfd736f6830e4396071afedad261bfd.png" alt="imagem"><br><br><a name="habracut"></a><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 2</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 3</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 4</a> <br><br><h1>  Ideia para extens√£o da web </h1><br>  Cada desenvolvedor √© confrontado com as tarefas de automatizar processos no navegador.  Uma vez para mim, a tarefa era reunir membros de grupos de um determinado assunto no LinkedIn e no Facebook. <br><br>  Antes disso, eu tinha experi√™ncia em escrever solu√ß√µes de analisador de web em php, mas esses sites usam muitos elementos din√¢micos e o foco da solu√ß√£o para essa tarefa mudou especificamente para interagir com os recursos da web por meio de um navegador. <br><br>  Obviamente, eu n√£o violaria o acordo sobre a presta√ß√£o de servi√ßos (Termos e condi√ß√µes), portanto, o que √© descrito abaixo √© uma pura inven√ß√£o da minha imagina√ß√£o e n√£o √© recomendado para implementa√ß√£o. <br><br>  Foi poss√≠vel abrir rapidamente o console do desenvolvedor e escrever um script javascript que simulasse as a√ß√µes do usu√°rio, ap√≥s o qual eu poderia coletar dados.  Essa abordagem trabalhou parcialmente com o Facebook, onde os membros do grupo e suas informa√ß√µes podem ser coletados em uma p√°gina.  Mas n√£o funcionou no LinkedIn, onde voc√™ precisa abrir a p√°gina de cada membro. <br><br>  Depois de procurar solu√ß√µes de terceiros, escolhi o iMacros para esta tarefa.  Esta extens√£o tem seu pr√≥prio idioma para escrever macros.  De alguma forma, eu o adaptei para resolver o problema do LinkedIn.  Eu tive que baixar a vers√£o antiga do Mozilla Firefox, pois a extens√£o n√£o funcionou para a implementa√ß√£o multithread deste navegador. <br><br>  Enquanto procurava solu√ß√µes de terceiros, deparei-me com muitas varia√ß√µes de analisador da Web, rastreador da Web, raspador da Web, etc. Muitos estavam focados em sites com navega√ß√£o p√°gina a p√°gina e n√£o em conte√∫do din√¢mico.  Algumas solu√ß√µes sugeriram a instala√ß√£o de uma solu√ß√£o de software para o sistema operacional e o uso de uma extens√£o da Web para esse complexo.  Me deparei com coisas muito altamente especializadas, por exemplo, para coletar participantes apenas no Facebook. <br><br>  Depois de todo o tormento, tive a ideia de "inventar minha bicicleta" para automatizar tarefas no navegador.  Entre os requisitos obrigat√≥rios para minha extens√£o da web, destaquei: <br><br><ol><li>  Trabalhe no n√∫mero m√°ximo de navegadores da web, incluindo dispositivos m√≥veis. </li><li>  O uso da linguagem de script padr√£o para navegadores √© javascript. </li><li>  Usando seus pr√≥prios arquivos de dados em scripts. </li><li>  A capacidade de salvar dados recebidos do script em um arquivo. </li><li>  Os scripts devem ser p√∫blicos ou privados.  Se o script for p√∫blico, a equipe de seguran√ßa precisar√° verificar esse script. </li></ol><br>  Mais adiante nesta lista, observei coisas mais espec√≠ficas para cada item. <br><br><ol><li>  Voc√™ precisa usar uma estrutura para escrever extens√µes da Web para minimizar os esfor√ßos para desenvolver solu√ß√µes entre navegadores. </li><li>  Javascript √© suportado por todos os navegadores, mas voc√™ precisa escrever sua pr√≥pria biblioteca para interagir com a extens√£o da web.  Essa biblioteca deve ter fun√ß√µes para salvar dados, recuperar dados de arquivos baixados etc. </li><li>  Geralmente √© necess√°rio usar a entrada para executar o script.  Por exemplo, dados para autoriza√ß√£o, chaves para a API, uma lista de p√°ginas a serem rastreadas etc. Esses dados devem ser enviados diretamente para a extens√£o da Web e armazenados na nuvem. </li><li>  Salvar dados do script √© uma das fun√ß√µes mais necess√°rias para automa√ß√£o.  Os dados armazenados devem ser enviados ao csv diretamente da extens√£o da web ou enviados para o e-mail do usu√°rio quando o limite de dados para upload for excedido.  Por exemplo, se o upload de membros do grupo for superior a 10.000, o download de uma extens√£o da Web poder√° demorar.  Isso deve ser evitado gerando um arquivo no servidor. </li><li>  Voc√™ deve ter uma interface administrativa da web para a equipe de seguran√ßa verificar os scripts dos usu√°rios que eles marcaram como p√∫blicos. </li></ol><br>  De tempos em tempos, eu encontrava mais e mais solu√ß√µes para o mesmo problema - executando scripts personalizados em um navegador.  Todas essas solu√ß√µes n√£o atendiam aos meus requisitos, pois eu queria ter uma extens√£o da web capaz de remover an√∫ncios em todas as p√°ginas;  transformar a p√°gina e me mostrar apenas seu conte√∫do, sem marca√ß√£o desnecess√°ria;  coletar dados de qualquer p√°gina e convert√™-los em um formato conveniente para uso futuro;  coletar dados ap√≥s um certo per√≠odo de tempo;  etc. <br><br>  Portanto, furiosamente "peguei fogo", criando uma extens√£o para executar scripts personalizados para o intervalo m√°ximo de tarefas. <br><br><h1>  Escolhendo uma estrutura de extens√£o da web </h1><br>  Como eu visava inicialmente o n√∫mero m√°ximo de navegadores da web, precisava de uma estrutura para criar extens√µes entre navegadores.  Podemos notar imediatamente o fato de que simplesmente n√£o existe tal estrutura.  Como muitos navegadores, embora funcionem dessa maneira e forne√ßam extens√µes da Web com uma API semelhante para intera√ß√£o, s√£o fundamentalmente diferentes. <br><br>  Fui for√ßado a abandonar a vers√£o inicial do suporte ao navegador m√≥vel quase imediatamente.  Como nenhum desses navegadores n√£o oferece a capacidade de usar extens√µes da web.  Encontrei apenas uma men√ß√£o de suporte a extens√µes da Web no navegador Dolphin, mas n√£o consegui encontrar informa√ß√µes detalhadas no site oficial.  Foi decidido abandonar essa id√©ia brilhante. <br><br>  Ao escrever minha extens√£o antiga, usei o framework kango.  Em 2013, foi o mais conveniente poss√≠vel.  Embora sem o suporte do Internet Explorer. <br><br>  Como minha extens√£o poderia funcionar como um bookmarklet, n√£o prestei aten√ß√£o a esse fato e escolhi essa estrutura, que por sua vez era apenas a solu√ß√£o perfeita para o desenvolvimento entre navegadores. <br><br>  Desde ent√£o, surgiram outros projetos que se propuseram ao objetivo de desenvolvimento de extens√µes da Web em v√°rios navegadores.  Encontrei todos esses projetos em um est√°gio inicial de desenvolvimento.  A tarefa deles foi simplificada desde que o Mozilla Firefox come√ßou a usar a API WebExtensions, que tornou poss√≠vel transformar facilmente extens√µes do Chrome em extens√µes do Firefox. <br><br>  As extens√µes para o navegador Opera em 2013 eram compat√≠veis com as extens√µes para o Chrome.  Agora, as extens√µes para o Safari funcionam apenas para MacOs, porque o suporte √† plataforma Windows do pr√≥prio navegador Safari cessou h√° muito tempo. <br><br>  O navegador Tor roda no antigo mecanismo Mozilla Firefox e, portanto, suporta extens√µes da web xpi, que a Mozilla Foundation abandonou em favor da tecnologia de extens√£o da Web. <br><br>  Em ess√™ncia, a estrutura do kango est√° quase cumprindo sua fun√ß√£o at√© hoje, pois gera extens√µes da web para todos os navegadores, exceto o Internet Explorer.  Mas como j√° passou muito tempo e o Firefox agora trabalha em um mecanismo semelhante ao Chrome, o kango gera o mesmo pacote para dois navegadores.  Eu tive que modificar um pouco a gera√ß√£o do Firefox e adicionar a gera√ß√£o do Tor. <br><br>  Como o status do projeto de estrutura do kango n√£o √© claro, assim como a licen√ßa do c√≥digo, n√£o posso postar minhas altera√ß√µes no dom√≠nio p√∫blico.  Se os detentores de direitos autorais permitirem o lan√ßamento da vers√£o 1.9.0 com c√≥digo-fonte aberto, terei prazer em ajudar nessa tarefa. <br><br>  Todas as extens√µes da Web t√™m dois pontos para trabalhar com dados.  O arquivo content.js permite manipular o DOM, enquanto background.html permite trabalhar com dados em segundo plano e intera√ß√£o com o servidor.  A comunica√ß√£o entre esses dois pontos ocorre atrav√©s do mecanismo da mensagem. <br><br>  Portanto, para modificar o DOM com dados do lado do servidor, precisamos obt√™-los em background.html e us√°-los em content.js atrav√©s do mecanismo de transmiss√£o de mensagens <br><br>  Esse mecanismo ideal n√£o funcionou para o meu caso por v√°rias raz√µes.  Portanto, deixei no background.js apenas a l√≥gica de trabalhar com pop-up e o bot√£o de extens√£o da web no navegador. <br>  A l√≥gica de qualquer extens√£o da web com uma janela pop-up √© a mesma.  Ao clicar no bot√£o, apenas mostramos pop-up; no segundo clique, feche. <br><br>  A estrutura do Kango oferece ao desenvolvedor uma interface unificada para intera√ß√£o e, em seguida, converte o c√≥digo da extens√£o da Web escrita na extens√£o da Web para um navegador da Web espec√≠fico e, portanto, economiza muito tempo desenvolvendo extens√µes da Web para v√°rios navegadores. <br><br>  No pr√≥ximo artigo, falarei sobre a escolha da <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">"Estrutura para o lado do servidor da extens√£o da web e da interface da extens√£o da web"</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt415183/">https://habr.com/ru/post/pt415183/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt415169/index.html">Compacta√ß√£o e desduplica√ß√£o: reduza o tamanho do arquivo morto e backup usando o inverno ZxPowerstore</a></li>
<li><a href="../pt415171/index.html">Leis de reflex√£o em Go</a></li>
<li><a href="../pt415175/index.html">Entrevista com o membro da Augmented World Expo</a></li>
<li><a href="../pt415177/index.html">Bem-vindo</a></li>
<li><a href="../pt415181/index.html">[Yekaterinburg, an√∫ncio] Mitap de analistas - sobre os primeiros analistas e o CBAP, sobre m√©tricas, sobre o setor p√∫blico e tipos de analistas</a></li>
<li><a href="../pt415185/index.html">3CX WebMeeting - Videoconfer√™ncia Gratuita: Vis√£o Geral dos Recursos</a></li>
<li><a href="../pt415187/index.html">O primeiro √© r√°pido. Mas tamb√©m muito bonito! Testando a RAM RGB HyperX Predator</a></li>
<li><a href="../pt415189/index.html">Pensamento funcional. Parte 1</a></li>
<li><a href="../pt415191/index.html">Novo Campeonato ML Boot Camp VI. Previs√£o da resposta do p√∫blico √† pesquisa on-line</a></li>
<li><a href="../pt415193/index.html">Tradu√ß√£o: Por que o FI √© importante mesmo para programadores de POO?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>