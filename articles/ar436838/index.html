<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ โฝ๏ธ ๐ผ๐ฟ ููู ุงูุดุจูุงุช ุงูุนุตุจูุฉ ุงูุชูุงููููุฉ ูู ุฎูุงู ุงูุชุตูุฑุงุช ูู PyTorch ๐ ๐ ๐๏ธ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ูู ุนุตุฑูุง ุ ุญููุช ุงูุขูุงุช ุจูุฌุงุญ 99 ูช ูู ุงูุฏูุฉ ูู ููู ูุชุญุฏูุฏ ุงูููุฒุงุช ูุงููุงุฆูุงุช ูู ุงูุตูุฑ. ููุงุฌู ูุฐุง ูู ููู ุ ุนูู ุณุจูู ุงููุซุงู: ุงูุชุนุฑู ุนูู ุงููุฌูู ูู ูุงููุฑุง ุง...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ููู ุงูุดุจูุงุช ุงูุนุตุจูุฉ ุงูุชูุงููููุฉ ูู ุฎูุงู ุงูุชุตูุฑุงุช ูู PyTorch</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/436838/" style=";text-align:right;direction:rtl">  ูู ุนุตุฑูุง ุ ุญููุช ุงูุขูุงุช ุจูุฌุงุญ 99 ูช ูู ุงูุฏูุฉ ูู ููู ูุชุญุฏูุฏ ุงูููุฒุงุช ูุงููุงุฆูุงุช ูู ุงูุตูุฑ.  ููุงุฌู ูุฐุง ูู ููู ุ ุนูู ุณุจูู ุงููุซุงู: ุงูุชุนุฑู ุนูู ุงููุฌูู ูู ูุงููุฑุง ุงููุงุชู ุงูุฐูู ุ ูุงููุฏุฑุฉ ุนูู ุงูุจุญุซ ุนู ุงูุตูุฑ ุนูู google ุ ููุณุญ ุงููุตูุต ูู ุงูุฑูุฒ ุงูุดุฑูุทู ุฃู ุงููุชุจ ุจุณุฑุนุฉ ุฌูุฏุฉ ุ ููุง ุฅูู ุฐูู. ุฅู ููุงุกุฉ ุงูุฌูุงุฒ ูุฐู ููููุฉ ุจูุถู ููุน ุฎุงุต ูู ุงูุดุจูุงุช ุงูุนุตุจูุฉ ุชุฏุนู convolutional neural ุงูุดุจูุฉ.  ุฅุฐุง ููุช ูู ุนุดุงู ุงูุชุนูู ุงูุนููู ุ ูุฑุจูุง ุชููู ูุฏ ุณูุนุช ุนูู ุ ูููููู ุชุทููุฑ ุนุฏุฉ ูุตููุงุช ููุตูุฑ.  ุชุนูู ุฃุทุฑ ุงูุชุนูู ุงูุนูููุฉ ุงูุญุฏูุซุฉ ูุซู Tensorflow ู PyTorch ุนูู ุชุจุณูุท ุนูููุฉ ุงูุชุนูู ูู ุขูุฉ ุงูุตูุฑุฉ.  ููุน ุฐูู ุ ูุจูู ุงูุณุคุงู: ููู ุชูุฑ ุงูุจูุงูุงุช ุนุจุฑ ุทุจูุงุช ุงูุดุจูุฉ ุงูุนุตุจูุฉ ูููู ูุชุนูู ุงูููุจููุชุฑ ูููุงุ  ููุญุตูู ุนูู ุฑุคูุฉ ูุงุถุญุฉ ูู ููุทุฉ ุงูุตูุฑ ุ ูุบุฑู ูู ุงูุงูุชูุงุก ููุฑู ุตูุฑุฉ ูู ุทุจูุฉ. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/859/2c6/958/8592c6958985979587858374abd08f98.png" alt="ุงูุตูุฑุฉ"><br><a name="habracut"></a><br><h2 style=";text-align:right;direction:rtl">  ุงูุดุจูุงุช ุงูุนุตุจูุฉ ุงูุชูุงููููุฉ </h2><br>  ูุจู ุฃู ุชุจุฏุฃ ูู ุฏุฑุงุณุฉ ุงูุดุจูุงุช ุงูุนุตุจูุฉ ุงูุชูุงููููุฉ (SNA) ุ ุชุญุชุงุฌ ุฅูู ูุนุฑูุฉ ููููุฉ ุงูุนูู ูุน ุงูุดุจูุงุช ุงูุนุตุจูุฉ.  ุชุญุงูู ุงูุดุจูุงุช ุงูุนุตุจูุฉ ุงูุนูู ุงูุจุดุฑู ูุญู ุงููุดููุงุช ุงููุนูุฏุฉ ูุงูุจุญุซ ุนู ุฃููุงุท ูู ุงูุจูุงูุงุช.  ุนูู ูุฏุงุฑ ุงูุณููุงุช ุงูููููุฉ ุงููุงุถูุฉ ุ ุงุณุชุจุฏููุง ุงูุนุฏูุฏ ูู ุฎูุงุฑุฒููุงุช ุงูุชุนูู ุงูุขูู ูุฑุคูุฉ ุงูููุจููุชุฑ.  ูุชููู ุงููููุฐุฌ ุงูุฃุณุงุณู ููุดุจูุฉ ุงูุนุตุจูุฉ ูู ุฎูุงูุง ุนุตุจูุฉ ููุธูุฉ ูู ุทุจูุงุช.  ุชุญุชูู ูู ุดุจูุฉ ุนุตุจูุฉ ุนูู ุทุจูุฉ ุฅุฏุฎุงู ูุฅุฎุฑุงุฌ ูุงูุนุฏูุฏ ูู ุงูุทุจูุงุช ุงููุฎููุฉ ุชุถุงู ุฅูููุง ุงุนุชูุงุฏูุง ุนูู ุชุนููุฏ ุงููุดููุฉ.  ุนูุฏ ููู ุงูุจูุงูุงุช ุนุจุฑ ุงูุทุจูุงุช ุ ูุชู ุชุฏุฑูุจ ุงูุฎูุงูุง ุงูุนุตุจูุฉ ูุงูุชุนุฑู ุนูู ุงูุนูุงูุงุช.  ูุณูู ูุฐุง ุงูุชูุซูู ููุดุจูุฉ ุงูุนุตุจูุฉ ูููุฐุฌูุง.  ุจุนุฏ ุชุฏุฑูุจ ุงููููุฐุฌ ุ ูุทูุจ ูู ุงูุดุจูุฉ ุนูู ุชูุจุคุงุช ุจูุงุกู ุนูู ุจูุงูุงุช ุงูุงุฎุชุจุงุฑ. <br><br>  SNS ูู ููุน ุฎุงุต ูู ุงูุดุจูุงุช ุงูุนุตุจูุฉ ุงูุชู ุชุนูู ุจุดูู ุฌูุฏ ูุน ุงูุตูุฑ.  ุงูุชุฑุญูู ุฅูุงู ููููู ูู ุนุงู 1998 ุ ุญูุซ ุฃุฏุฑููุง ุงูุนุฏุฏ ุงูููุฌูุฏ ูู ุตูุฑุฉ ุงูุฅุฏุฎุงู.  ูุณุชุฎุฏู SNA ุฃูุถูุง ูู ุงูุชุนุฑู ุนูู ุงูููุงู ูุชุฌุฒุฆุฉ ุงูุตูุฑ ููุนุงูุฌุฉ ุงููุตูุต.  ูุจู ุฅูุดุงุก ุงูุดุจูุงุช ุงูุนุตุจูุฉ ุงูุชูุงููููุฉ ุ ุชู ุงุณุชุฎุฏุงู ุงูุฅุฏุฑุงู ุงูุญุณู ูุชุนุฏุฏ ุงูุทุจูุงุช ูู ุจูุงุก ูุตููุงุช ุงูุตูุฑ.  ูุดูุฑ ุชุตููู ุงูุตูุฑุฉ ุฅูู ูููุฉ ุงุณุชุฎุฑุงุฌ ุงูุทุจูุงุช ูู ุตูุฑุฉ ููุทูุฉ ูุชุนุฏุฏุฉ ุงููููุงุช (ููููุฉ ุ ุจุงูุฃุณูุฏ ูุงูุฃุจูุถ).  ูุณุชุบุฑู ุงูุฅุฏุฑุงู ุงูุญุณู ูุชุนุฏุฏ ุงูุทุจูุงุช ููุชูุง ุทูููุงู ููุจุญุซ ุนู ุงููุนูููุงุช ูู ุงูุตูุฑ ุ ุญูุซ ูุฌุจ ุฃู ูุฑุชุจุท ูู ุฅุฏุฎุงู ุจูู ุฎููุฉ ุนุตุจูุฉ ูู ุงูุทุจูุฉ ุงูุชุงููุฉ.  ุฐูุจ SNA ุญูููู ุจุงุณุชุฎุฏุงู ููููู ูุณูู ุงูุงุชุตุงู ุงููุญูู.  ูุฐุง ูุนูู ุฃููุง ุณูุฑุจุท ูู ุฎููุฉ ุนุตุจูุฉ ููุท ุจููุทูุฉ ุงูุฅุฏุฎุงู ุงููุญููุฉ.  ูุฐุง ูููู ูู ุนุฏุฏ ุงููุนููุงุช ุ ููุง ูุณูุญ ูุฃุฌุฒุงุก ูุฎุชููุฉ ูู ุงูุดุจูุฉ ุจุงูุชุฎุตุต ูู ุณูุงุช ุนุงููุฉ ุงููุณุชูู ูุซู ุงููููุณ ุฃู ููุท ุงูุชูุฑุงุฑ.  ุญุงุฆุฑุฉุ  ุฏุนููุง ููุงุฑู ููููุฉ ููู ุงูุตูุฑ ูู ุฎูุงู ุงูุฅุฏุฑุงู ุงูุญุณู ูุชุนุฏุฏ ุงูุทุจูุงุช (MPs) ูุงูุดุจูุงุช ุงูุนุตุจูุฉ ุงูุชูุงููููุฉ. <br><br><h2 style=";text-align:right;direction:rtl">  ููุงุฑูุฉ ุงููุงุฆุจ ู SNA </h2><br>  ุณูููู ุฅุฌูุงูู ุนุฏุฏ ุงูุฅุฏุฎุงูุงุช ูู ุทุจูุฉ ุงูุฅุฏุฎุงู ูู perceptron ูุชุนุฏุฏ ุงูุทุจูุงุช 784 ุ ูุธุฑูุง ูุฃู ุญุฌู ุตูุฑุฉ ุงูุฅุฏุฎุงู 28x28 = 784 (ูุชู ุงุนุชุจุงุฑ ูุฌููุนุฉ ุจูุงูุงุช MNIST).  ูุฌุจ ุฃู ุชููู ุงูุดุจูุฉ ูุงุฏุฑุฉ ุนูู ุงูุชูุจุค ุจุงูุฑูู ุงูููุฌูุฏ ูู ุตูุฑุฉ ุงูุฅุฏุฎุงู ุ ููุง ูุนูู ุฃู ุงูุฅุฎุฑุงุฌ ูููู ุฃู ููุชูู ุฅูู ุฃู ูู ุงููุฆุงุช ุงูุชุงููุฉ ูู ุงููุทุงู ูู 0 ุฅูู 9. ูู ุทุจูุฉ ุงููุฎุฑุฌุงุช ุ ูุฑุฌุน ุชูุฏูุฑุงุช ุงููุฆุฉ ุ ุนูู ุณุจูู ุงููุซุงู ุ ุฅุฐุง ูุงู ูุฐุง ุงูุฅุฏุฎุงู ูู ุงูุตูุฑุฉ ุฐุงุช ุงูุฑูู "3" ุ ุซู ูู ุทุจูุฉ ุงูุฎุฑุฌ ุชุชูุชุน ุงูุฎููุฉ ุงูุนุตุจูุฉ ุงูููุงุจูุฉ "3" ุจูููุฉ ุฃุนูู ููุงุฑูุฉ ุจุงูุฎูุงูุง ุงูุนุตุจูุฉ ุงูุฃุฎุฑู.  ูุฑุฉ ุฃุฎุฑู ุ ูุทุฑุญ ุงูุณุคุงู: "ูู ุนุฏุฏ ุงูุทุจูุงุช ุงููุฎููุฉ ุงูุชู ูุญุชุงุฌูุง ูุนุฏุฏ ุงูุฎูุงูุง ุงูุนุตุจูุฉ ุงูุชู ูุฌุจ ุฃู ุชููู ูู ูู ูููุงุ"  ุนูู ุณุจูู ุงููุซุงู ุ ุฎุฐ ุดูุฑุฉ MP ุงูุชุงููุฉ: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3f8/efc/e14/3f8efce14418a7df0be2e813399def5d.png" alt="ุงูุตูุฑุฉ"><br><br>  ูุชู ุชูููุฐ ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุฃุนูุงู ุจุงุณุชุฎุฏุงู ุฅุทุงุฑ ูุณูู Keras.  ุชุญุชูู ุงูุทุจูุฉ ุงููุฎููุฉ ุงูุฃููู ุนูู 512 ุฎููุฉ ุนุตุจูุฉ ูุชุตูุฉ ุจุทุจูุฉ ุฅุฏุฎุงู 784 ุฎููุฉ ุนุตุจูุฉ.  ุงูุทุจูุฉ ุงููุฎููุฉ ุงูุชุงููุฉ: ุทุจูุฉ ุงูุงุณุชุจุนุงุฏ ุ ูุงูุชู ุชุญู ูุดููุฉ ุฅุนุงุฏุฉ ุงูุชุฏุฑูุจ.  0.2 ุชุนูู ุฃู ููุงู ูุฑุตุฉ ุจูุณุจุฉ 20ูช ูุนุฏู ูุฑุงุนุงุฉ ุงูุฎูุงูุง ุงูุนุตุจูุฉ ูู ุงูุทุจูุฉ ุงููุฎููุฉ ุงูุณุงุจูุฉ.  ููุฏ ุฃุถููุง ูุฑุฉ ุฃุฎุฑู ุทุจูุฉ ูุฎููุฉ ุซุงููุฉ ุจููุณ ุนุฏุฏ ุงูุฎูุงูุง ุงูุนุตุจูุฉ ููุง ูู ุงูุทุจูุฉ ุงููุฎููุฉ ุงูุฃููู (512) ุ ุซู ุทุจูุฉ ุฃุฎุฑู ุญุตุฑูุฉ.  ุฃุฎูุฑูุง ุ ุฅููุงุก ูุฌููุนุฉ ุงูุทุจูุงุช ูุฐู ุจุทุจูุฉ ุฅุฎุฑุงุฌ ุชุชููู ูู 10 ูุฆุงุช.  ุงููุฆุฉ ุงูุฃูุซุฑ ุฃูููุฉ ูู ุงูุฑูู ุงูุฐู ุชูุจุฃ ุจู ุงููููุฐุฌ.  ูุฐู ูู ุงูุทุฑููุฉ ุงูุชู ุชุนุชูู ุจูุง ุดุจูุฉ ูุชุนุฏุฏุฉ ุงูุทุจูุงุช ุจุนุฏ ุชุญุฏูุฏ ุฌููุน ุงูุทุจูุงุช.  ุฃุญุฏ ุนููุจ ุฌูุงุฒ ุงูุฅุฏุฑุงู ุงูุญุณู ูุชุนุฏุฏ ุงููุณุชููุงุช ูู ุฃูู ูุชุตู ุจุดูู ูุงูู ุ ุงูุฃูุฑ ุงูุฐู ูุณุชุบุฑู ุงููุซูุฑ ูู ุงูููุช ูุงููุณุงุญุฉ. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/db3/df6/605/db3df6605d0ddb868eb14b347227b963.png" alt="ุงูุตูุฑุฉ"><br><br>  ูุง ุชุณุชุฎุฏู ุงููุชุณุงุจูุงุช ุทุจูุงุช ูุชุฑุงุจุทุฉ ุจุงููุงูู.  ูุณุชุฎุฏููู ุทุจูุงุช ูุชูุงุซุฑุฉ ุ ูุงูุชู ุชุฃุฎุฐ ุงููุตูููุงุช ููุฏุฎูุงุช ุ ูุงูุชู ุชุนุทู ููุฒุฉ ุนูู MP.  ูู MP ุ ูู ุนูุฏุฉ ูุณุคููุฉ ุนู ููู ุงูุตูุฑุฉ ูุงููุฉ.  ูู ูุธุงู ุงูุญุณุงุจุงุช ุงูููููุฉ ุ ูููู ุจุชูุณูู ุงูุตูุฑุฉ ุฅูู ููุงุทู (ููุงุทู ูุญููุฉ ุตุบูุฑุฉ ูู ูุญุฏุงุช ุงูุจูุณู).  ุชุฌูุน ุทุจูุฉ ุงููุฎุฑุฌุงุช ุงูุจูุงูุงุช ุงููุณุชููุฉ ูู ูู ุนูุฏุฉ ูุฎููุฉ ููุนุซูุฑ ุนูู ุงูุฃููุงุท.  ููุฌุฏ ุฃุฏูุงู ุตูุฑุฉ ูููููุฉ ุชูุตูู ุงูุทุจูุงุช. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ae6/f7f/d61/ae6f7fd618d5296a0deecabdd2e06e77.png" alt="ุงูุตูุฑุฉ"><br><br>  ุงูุขู ุฏุนููุง ูุฑู ููู ูุฌุฏ SNA ูุนูููุงุช ูู ุงูุตูุฑ.  ูุจู ุฐูู ุ ูุญู ุจุญุงุฌุฉ ุฅูู ููู ููููุฉ ุงุณุชุฎุฑุงุฌ ุงูุนูุงูุงุช.  ูู ูุธุงู ุงูุญุณุงุจุงุช ุงูููููุฉ ุ ูุณุชุฎุฏู ุทุจูุงุช ูุฎุชููุฉ ุ ุชุญุงูุธ ูู ุทุจูุฉ ุนูู ุนูุงูุงุช ุงูุตูุฑุฉ ุ ุนูู ุณุจูู ุงููุซุงู ุ ุชุฃุฎุฐ ูู ุงูุงุนุชุจุงุฑ ุตูุฑุฉ ุงูููุจ ุ ุนูุฏูุง ุชุญุชุงุฌ ุงูุดุจูุฉ ุฅูู ุชุตููู ุงูููุจ ุ ูุฌุจ ุฃู ุชุญุฏุฏ ุฌููุน ุงูุนูุงูุงุช ุ ูุซู ุงูุนููู ูุงูุฃุฐููู ูุงููุณุงู ูุงูุณุงููู ุ ุฅูุฎ.  ูุฐู ุงูุนูุงูุงุช ููุณูุฑุฉ ููุนุชุฑู ุจูุง ุนูู ูุณุชููุงุช ุงูุดุจูุฉ ุงููุญููุฉ ุจุงุณุชุฎุฏุงู ุงููุฑุดุญุงุช ูุงูููู. <br><br><h2 style=";text-align:right;direction:rtl">  ููู ุชูุธุฑ ุฃุฌูุฒุฉ ุงูููุจููุชุฑ ุฅูู ุตูุฑุฉุ </h2><br>  ุงูุดุฎุต ุงูุฐู ููุธุฑ ุฅูู ุงูุตูุฑุฉ ูููู ูุนูุงูุง ูุจุฏู ูุนูููุงู ููุบุงูุฉ.  ุฏุนูุง ูููู ุฃูู ุชูุดู ุ ููุงุญุธ ุงูุนุฏูุฏ ูู ุงูููุงุธุฑ ุงูุทุจูุนูุฉ ูู ุญููู.  ููู ูููู ุงูุทุจูุนุฉ ูู ูุฐู ุงูุญุงูุฉุ  ููุชูุท ุตูุฑูุง ููุจูุฆุฉ ุจุงุณุชุฎุฏุงู ุนุถููุง ุงูุญุณู ุงูุฑุฆูุณู - ุงูุนูู ุ ุซู ูุฑุณููุง ุฅูู ุดุจููุฉ ุงูุนูู.  ูู ุดูุก ูุจุฏู ูุซูุฑุง ููุงูุชูุงู ุ ุฃููุณ ูุฐููุ  ุงูุขู ุฏุนูุง ูุชุฎูู ุฃู ุงูููุจููุชุฑ ููุนู ููุณ ุงูุดูุก.  ูู ุฃุฌูุฒุฉ ุงูููุจููุชุฑ ุ ูุชู ุชูุณูุฑ ุงูุตูุฑ ุจุงุณุชุฎุฏุงู ูุฌููุนุฉ ูู ููู ุงูุจููุณู ุงูุชู ุชุชุฑุงูุญ ูู 0 ุฅูู 255. ูุจุญุซ ุงูููุจููุชุฑ ูู ููู ุงูุจููุณู ูุฐู ููููููุง.  ูููููุฉ ุงูุฃููู ุ ูุง ูุนุฑู ุงูุฃุดูุงุก ูุงูุฃููุงู.  ุฅูู ุจุจุณุงุทุฉ ูุชุนุฑู ุนูู ููู ุงูุจููุณู ุ ูุงูุตูุฑุฉ ููุงูุฆุฉ ููุฌููุนุฉ ูู ููู ุงูุจููุณู ููููุจููุชุฑ.  ูู ููุช ูุงุญู ุ ูู ุฎูุงู ุชุญููู ููู ุงูุจููุณู ุ ูุชุนูู ุชุฏุฑูุฌูุงู ูุง ุฅุฐุง ูุงูุช ุงูุตูุฑุฉ ุฑูุงุฏูุฉ ุฃู ููููุฉ.  ุชุญุชูู ุงูุตูุฑ ุฐุงุช ุงูุชุฏุฑุฌ ุงูุฑูุงุฏู ุนูู ููุงุฉ ูุงุญุฏุฉ ููุท ุ ุญูุซ ููุซู ูู ุจูุณู ูุซุงูุฉ ููู ูุงุญุฏ.  0 ุชุนูู ุงูุฃุณูุฏ ุ ู 255 ุชุนูู ุงูุฃุจูุถ ุ ูุงููุชุบูุฑุงุช ุงูุฃุฎุฑู ูู ุงูุฃุณูุฏ ูุงูุฃุจูุถ ุ ุฃู ุงูุฑูุงุฏู ุ ูู ุจููููุง. <br><br>  ุงูุตูุฑ ุงูููููุฉ ููุง ุซูุงุซ ูููุงุช ุ ุงูุฃุญูุฑ ูุงูุฃุฎุถุฑ ูุงูุฃุฒุฑู.  ุฅููุง ุชูุซู ุดุฏุฉ 3 ุฃููุงู (ูุตูููุฉ ุซูุงุซูุฉ ุงูุฃุจุนุงุฏ) ุ ูุนูุฏูุง ุชุชุบูุฑ ุงูููู ูู ููุช ูุงุญุฏ ุ ูุฅู ูุฐุง ูุนุทู ูุฌููุนุฉ ูุจูุฑุฉ ูู ุงูุฃููุงู ุ ูู ุงูุญูููุฉ ููุญุฉ ุฃููุงู!  ุจุนุฏ ุฐูู ุ ูุชุนุฑู ุงูููุจููุชุฑ ุนูู ููุญููุงุช ููุญูุท ุงููุงุฆูุงุช ูู ุงูุตูุฑุฉ.  ูู ูุฐุง ูููู ุฏุฑุงุณุชู ูู ุงูุดุจูุฉ ุงูุนุตุจูุฉ ุงูุชูุงููููุฉ.  ููุฐุง ุ ุณูู ูุณุชุฎุฏู PyTorch ูุชุญููู ูุฌููุนุฉ ุงูุจูุงูุงุช ูุชุทุจูู ุงููุฑุดุญุงุช ุนูู ุงูุตูุฑ.  ูุง ููู ูู ููุชุทู ูู ุงูุดูุฑุฉ. <br><br><pre style=";text-align:right;direction:rtl"><code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># Load the libraries import torch import numpy as np from torchvision import datasets import torchvision.transforms as transforms # Set the parameters num_workers = 0 batch_size = 20 # Converting the Images to tensors using Transforms transform = transforms.ToTensor() train_data = datasets.MNIST(root='data', train=True, download=True, transform=transform) test_data = datasets.MNIST(root='data', train=False, download=True, transform=transform) # Loading the Data train_loader = torch.utils.data.DataLoader(train_data, batch_size=batch_size, num_workers=num_workers) test_loader = torch.utils.data.DataLoader(test_data, batch_size=batch_size, num_workers=num_workers) import matplotlib.pyplot as plt %matplotlib inline dataiter = iter(train_loader) images, labels = dataiter.next() images = images.numpy() # Peeking into dataset fig = plt.figure(figsize=(25, 4)) for image in np.arange(20): ax = fig.add_subplot(2, 20/2, image+1, xticks=[], yticks=[]) ax.imshow(np.squeeze(images[image]), cmap='gray') ax.set_title(str(labels[image].item()))</span></span></code> </pre> <br><img src="https://habrastorage.org/getpro/habr/post_images/304/163/1ad/3041631ad58d7300a35af90b39b94584.png" alt="ุงูุตูุฑุฉ"><br><br>  ุงูุขู ุฏุนููุง ูุฑู ููู ูุชู ุชุบุฐูุฉ ุตูุฑุฉ ูุงุญุฏุฉ ูู ุดุจูุฉ ุงูุนุตุจูุฉ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">img = np.squeeze(images[<span class="hljs-number"><span class="hljs-number">7</span></span>]) fig = plt.figure(figsize = (<span class="hljs-number"><span class="hljs-number">12</span></span>,<span class="hljs-number"><span class="hljs-number">12</span></span>)) ax = fig.add_subplot(<span class="hljs-number"><span class="hljs-number">111</span></span>) ax.imshow(img, cmap=<span class="hljs-string"><span class="hljs-string">'gray'</span></span>) width, height = img.shape thresh = img.max()/<span class="hljs-number"><span class="hljs-number">2.5</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> x <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(width): <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> y <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(height): val = round(img[x][y],<span class="hljs-number"><span class="hljs-number">2</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> img[x][y] !=<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> ax.annotate(str(val), xy=(y,x), color=<span class="hljs-string"><span class="hljs-string">'white'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> img[x][y]&lt;thresh <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-string"><span class="hljs-string">'black'</span></span>)</code> </pre><br><img src="https://habrastorage.org/getpro/habr/post_images/264/f15/bff/264f15bffe653ae237f3e2fa1fc5c868.png" alt="ุงูุตูุฑุฉ"><br><br>  ููุฐุง ูุชู ุชูุณูู ุงูุฑูู "3" ุฅูู ูุญุฏุงุช ุจูุณู.  ูู ูุฌููุนุฉ ุงูุฃุฑูุงู ุงูููุชูุจุฉ ุจุฎุท ุงููุฏ ุ ูุชู ุชุญุฏูุฏ "3" ุจุดูู ุนุดูุงุฆู ุ ุญูุซ ูุชู ุนุฑุถ ููู ุงูุจููุณู.  ููุง ToTensor () ุชุทุจูุน ููู ุจูุณู ุงููุนููุฉ (0-255) ูููุตุฑูุง ุนูู ูุทุงู ูู 0 ุฅูู 1. ููุงุฐุง ูุฐุงุ  ูุฃูู ูุณูู ุงูุนูููุงุช ุงูุญุณุงุจูุฉ ูู ุงูุฃูุณุงู ุงูุชุงููุฉ ุ ุฅูุง ูุชูุณูุฑ ุงูุตูุฑ ุ ุฃู ูุฅูุฌุงุฏ ุฃููุงุท ุดุงุฆุนุฉ ููุฌูุฏุฉ ูููุง. <br><br><h2 style=";text-align:right;direction:rtl">  ูู ุจุฅูุดุงุก ุงูููุชุฑ ุงูุฎุงุต ุจู </h2><br>  ุงููุฑุดุญุงุช ุ ููุง ููุญู ุงูุงุณู ุ ุชุตููุฉ ุงููุนูููุงุช.  ูู ุญุงูุฉ ุงูุดุจูุงุช ุงูุนุตุจูุฉ ุงูุชูุงููููุฉ ุ ุนูุฏ ุงูุนูู ูุน ุงูุตูุฑ ุ ูุชู ุชุตููุฉ ุงููุนูููุงุช ุงููุชุนููุฉ ุจุงูุจูุณู.  ููุงุฐุง ูุฌุจ ุนูููุง ุชุตููุฉ ุนูู ุงูุฅุทูุงูุ  ุชุฐูุฑ ุฃู ุงูููุจููุชุฑ ูุฌุจ ุฃู ููุฑ ุจุนูููุฉ ุชุนููููุฉ ูููู ุงูุตูุฑ ุ ูุดุงุจููุง ุฌุฏูุง ูููููุฉ ููุงู ุงูุทูู ุจุฐูู.  ูู ูุฐู ุงูุญุงูุฉ ุ ูู ูุญุชุงุฌ ุฅูู ุณููุงุช ุนุฏูุฏุฉ!  ุจุงุฎุชุตุงุฑ ุ ูุชุนูู ูู ุงูุตูุฑ ุซู ูุชูุฏู ุฅูู ุงููู. <br><br>  ูุฐูู ุ ูุฌุจ ุฃู ุชุนุฑู ุงูุดุจูุฉ ูู ุงูุจุฏุงูุฉ ุฌููุน ุงูุฃุฌุฒุงุก ุงูุฎุดูุฉ ูู ุงูุตูุฑุฉ ุ ุฃู ุงูุญูุงู ูุงูุฎุทูุท ุงูุนุฑูุถุฉ ูุงูุนูุงุตุฑ ุงูุฃุฎุฑู ุฐุงุช ุงููุณุชูู ุงูููุฎูุถ.  ุจูุฌุฑุฏ ุงูุชุดุงููุง ุ ูุชู ุชูููุฏ ูุณุงุฑ ุงูุฃุนุฑุงุถ ุงููุนูุฏุฉ.  ูููุตูู ุฅูููู ุ ูุฌุจ ุฃููุงู ุงุณุชุฎุฑุงุฌ ุงูุณูุงุช ุฐุงุช ุงููุณุชูู ุงูููุฎูุถ ุ ุซู ุงููุณุท ุ ุซู ุงูุณูุงุช ุฐุงุช ุงููุณุชูู ุงูุฃุนูู.  ุชุนุชุจุฑ ุงูููุงุชุฑ ุทุฑููุฉ ูุงุณุชุฎุฑุงุฌ ุงููุนูููุงุช ุงูุชู ูุญุชุงุฌูุง ุงููุณุชุฎุฏู ุ ูููุณ ููุท ููู ุงูุจูุงูุงุช ุงูุฃุนูู ุ ุจุณุจุจ ุนุฏู ููู ุงูููุจููุชุฑ ูููููุฉ ุงูุตูุฑ.  ูู ุงูุจุฏุงูุฉ ุ ูููู ุงุณุชุฎุฑุงุฌ ุงููุธุงุฆู ุฐุงุช ุงููุณุชูู ุงูููุฎูุถ ุจูุงุกู ุนูู ูุฑุดุญ ูุนูู.  ูุนุฏ ุนุงูู ุงูุชุตููุฉ ููุง ุฃูุถูุง ูุฌููุนุฉ ูู ููู ุงูุจูุณู ุ ุชุดุจู ุงูุตูุฑุฉ.  ูููู ูููู ุนูู ุฃูู ุงูุฃูุฒุงู ุงูุชู ุชุฑุจุท ุงูุทุจูุงุช ูู ุงูุดุจูุฉ ุงูุนุตุจูุฉ ุงูุชูุงููููุฉ.  ูุชู ุถุฑุจ ูุฐู ุงูุฃูุฒุงู ุฃู ุงููุฑุดุญุงุช ุจููู ุงูุฅุฏุฎุงู ูุฅูุชุงุฌ ุตูุฑ ูุณูุทุฉ ุชูุซู ููู ุงูููุจููุชุฑ ููุตูุฑุฉ.  ุซู ูุชู ุถุฑุจูู ุจูุงุณุทุฉ ุนุฏุฏ ูููู ูู ุงููุฑุดุญุงุช ูุชูุณูุน ุงูุนุฑุถ.  ุซู ููุชุดู ุงูุฃุนุถุงุก ุงููุฑุฆูุฉ ููุดุฎุต (ุจุดุฑุท ุฃู ูููู ุงูุดุฎุต ููุฌูุฏูุง ูู ุงูุตูุฑุฉ).  ูููุง ุจุนุฏ ุ ูุน ุชุถููู ุงูุนุฏูุฏ ูู ุงููุฑุดุญุงุช ูุนุฏุฉ ุทุจูุงุช ุ ุตุฑุฎ ุงูููุจููุชุฑ: "ุฃูู ุ ูุนู!  ูุฐุง ุฑุฌู ". <br><br>  ุฅุฐุง ุชุญุฏุซูุง ุนู ุงููุฑุดุญุงุช ุ ููุฏููุง ุงูุนุฏูุฏ ูู ุงูุฎูุงุฑุงุช.  ูุฏ ุชุฑุบุจ ูู ุทูุณ ุงูุตูุฑุฉ ุ ุซู ุชุทุจูู ูุฑุดุญ ุทูุณ ุ ุฅุฐุง ููุช ุจุญุงุฌุฉ ุฅูู ุฅุถุงูุฉ ุญุฏุฉ ุ ูุณูุฃุชู ูุฑุดุญ ุงูุญุฏุฉ ุฅูู ุนูููุฉ ุงูุฅููุงุฐ ุ ุฅูุฎ. <br><br>  ููููู ูุธุฑุฉ ุนูู ููุชุทูุงุช ุจุฑูุฌูุฉ ููููุฉ ูููู ูุธููุฉ ุงููุฑุดุญุงุช. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/679/6a4/bb4/6796a4bb4830bda29c6d14212274a286.png" alt="ุงูุตูุฑุฉ"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/752/a89/805/752a89805fba54b5d0f9e90073ca9fde.png" alt="ุงูุตูุฑุฉ"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/84f/8a1/f9c/84f8a1f9c92b1996b0e4eed4a2a7dd5b.png" alt="ุงูุตูุฑุฉ"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/142/635/038/142635038ecef3606d53d5d9c85b26f8.png" alt="ุงูุตูุฑุฉ"><br><br>  ููุฐุง ุชุจุฏู ุงูุตูุฑุฉ ุจุนุฏ ุชุทุจูู ุงููุฑุดุญ ุ ููู ูุฐู ุงูุญุงูุฉ ุงุณุชุฎุฏููุง ูุฑุดุญ Sobel. <br><br><h2 style=";text-align:right;direction:rtl">  ุงูุดุจูุงุช ุงูุนุตุจูุฉ ุงูุชูุงููููุฉ </h2><br>  ููุฏ ุฑุฃููุง ุญุชู ุงูุขู ููููุฉ ุงุณุชุฎุฏุงู ุงููุฑุดุญุงุช ูุงุณุชุฎุฑุงุฌ ููุฒุงุช ูู ุงูุตูุฑ.  ุงูุขู ุ ูุงุณุชููุงู ุงูุดุจูุฉ ุงูุนุตุจูุฉ ุงูุชูุงููููุฉ ุจุฃููููุง ุ ูุญุชุงุฌ ุฅูู ูุนุฑูุฉ ุฌููุน ุงูุทุจูุงุช ุงูุชู ูุณุชุฎุฏููุง ูุชุตููููุง.  ุงูุทุจูุงุช ุงููุณุชุฎุฏูุฉ ูู ูุธุงู ุงูุญุณุงุจุงุช ุงูููููุฉ ุ <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุทุจูุฉ ุชูุงููููุฉ </li><li style=";text-align:right;direction:rtl">  ุชุฌูุน ุทุจูุฉ </li><li style=";text-align:right;direction:rtl">  ุทุจูุฉ ุงููุณุชุนุจุฏูู ุจุงููุงูู </li></ol><br>  ูุน ุงูุทุจูุงุช ุงูุซูุงุซ ุ ูุจุฏู ูุตูู ุงูุตูุฑ ุงูุชูุงูููู ููุง ููู: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/8b4/927/c31/8b4927c31b5f951d7026b30d68695bea.png" alt="ุงูุตูุฑุฉ"><br><br>  ุงูุขู ุฏุนููุง ูุฑู ูุง ููุนูู ูู ุทุจูุฉ. <br><br>  <b>ุชุณุชุฎุฏู ุงูุทุจูุฉ ุงูุชูุงููููุฉ (CONV)</b> ุงููุฑุดุญุงุช ุงูุชู ุชุคุฏู ุนูููุงุช ุงูุงูุชูุงุก ุนู ุทุฑูู ูุณุญ ุตูุฑุฉ ุงูุฅุฏุฎุงู.  ุชุชุถูู ุงููุนููุงุช ุงููุงุฆูุฉ ุญุฌู ูุฑุดุญ ุ ูุงูุฐู ูููู ุฃู ูููู 2x2 ุ 3x3 ุ 4x4 ุ 5x5 (ูููู ููุณ ุนูู ุณุจูู ุงูุญุตุฑ) ูุงูุฎุทูุฉ S. ูุชุณูู ุงููุชูุฌุฉ O ุฎุฑูุทุฉ ุงููุนุงูู ุฃู ุฎุฑูุทุฉ ุงูุชูุดูุท ุงูุชู ูุชู ูููุง ุญุณุงุจ ุฌููุน ุงูููุฒุงุช ุจุงุณุชุฎุฏุงู ุทุจูุงุช ุงูุฅุฏุฎุงู ููุฑุดุญุงุช.  ูููุง ููู ุตูุฑุฉ ูุชูููุฏ ุฎุฑุงุฆุท ุงููุนุงูู ุนูุฏ ุชุทุจูู ุงูุฅูุชูุงุก ุ <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a2a/14d/aab/a2a14daab68c91f8d92ba0c54509493b.png" alt="ุงูุตูุฑุฉ"><br><br>  <b>ูุชู ุงุณุชุฎุฏุงู ุทุจูุฉ ุงูุฏูุฌ (POOL)</b> ูุถุบุท ุงูููุฒุงุช ุงููุณุชุฎุฏูุฉ ุนุงุฏุฉ ุจุนุฏ ุทุจูุฉ ุงูุงูุชูุงุก.  ููุงู ููุนุงู ูู ุนูููุงุช ุงูุงุชุญุงุฏ - ูุฐุง ูู ุงูุงุชุญุงุฏ ุงูุฃูุตู ูุงููุชูุณุท โโุ ุญูุซ ูุชู ุฃุฎุฐ ุงูููู ุงููุตูู ูุงููุชูุณุท โโููุฎุตุงุฆุต ุ ุนูู ุงูุชูุงูู.  ูุง ููู ูู ุชุดุบูู ุนูููุงุช ุฏูุฌ ุ <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c2d/03f/2f8/c2d03f2f8734efade8cbc80d44d3767e.png" alt="ุงูุตูุฑุฉ"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/01a/e5c/558/01ae5c558fa6647bfb9c19b9edabbb37.png" alt="ุงูุตูุฑุฉ"><br><br>  ุชุนูู <b>ุงูุทุจูุงุช ุงููุชุตูุฉ ุจุงููุงูู (FCs)</b> ูุน ุฅุฏุฎุงู ูุณุทุญ ุ ุญูุซ ูุชู ุชูุตูู ูู ุฅุฏุฎุงู ุจุฌููุน ุงูุฎูุงูุง ุงูุนุตุจูุฉ.  ูุชู ุงุณุชุฎุฏุงููุง ุนุงุฏุฉู ูู ููุงูุฉ ุงูุดุจูุฉ ูุชูุตูู ุงูุทุจูุงุช ุงููุฎููุฉ ุจุทุจูุฉ ุงูุฅุฎุฑุงุฌ ุ ููุง ูุณุงุนุฏ ุนูู ุชุญุณูู ูุชุงุฆุฌ ุงูุตู. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d28/558/188/d285581882fa97824cdc0ad6ecb31873.png" alt="ุงูุตูุฑุฉ"><br><br><h3 style=";text-align:right;direction:rtl">  ุงูุชุตูุฑ SNA ูู PyTorch </h3><br>  ุงูุขู ููุฏ ุฃุตุจุญ ูุฏููุง ุงูุฅูุฏููููุฌูุฉ ุงููุงููุฉ ูุจูุงุก ูุธุงู ุงูุญุณุงุจุงุช ุงูููููุฉ ุ ูููููุฐ ูุธุงู ุงูุญุณุงุจุงุช ุงูููููุฉ ุจุงุณุชุฎุฏุงู ุฅุทุงุฑ ุนูู PyTorch ูู Facebook. <br><br>  <b>ุงูุฎุทูุฉ 1</b> : ูู ุจุชูุฒูู ุตูุฑุฉ ุงูุฅุฏุฎุงู ุงููุฑุงุฏ ุฅุฑุณุงููุง ุนุจุฑ ุงูุดุจูุฉ.  (ููุง ููุนู ุฐูู ูุน Numpy ู OpenCV) <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> cv2 <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> matplotlib.pyplot <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> plt %matplotlib inline img_path = <span class="hljs-string"><span class="hljs-string">'dog.jpg'</span></span> bgr_img = cv2.imread(img_path) gray_img = cv2.cvtColor(bgr_img, cv2.COLOR_BGR2GRAY) <span class="hljs-comment"><span class="hljs-comment"># Normalise gray_img = gray_img.astype("float32")/255 plt.imshow(gray_img, cmap='gray') plt.show()</span></span></code> </pre><br><img src="https://habrastorage.org/getpro/habr/post_images/291/d0f/3d2/291d0f3d28f3091716c3aba41dc35c59.png" alt="ุงูุตูุฑุฉ"><br><br>  <b>ุงูุฎุทูุฉ 2</b> : ุชูุฏูู ุงููุฑุดุญุงุช <br><br>  ุฏุนูุง ูุชุตูุฑ ุงููุฑุดุญุงุช ูููู ุงููุฑุดุญุงุช ุงูุชู ุณูุณุชุฎุฏููุง ุจุดูู ุฃูุถู ุ <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np filter_vals = np.array([ [<span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>], [<span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>], [<span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>], [<span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>] ]) print(<span class="hljs-string"><span class="hljs-string">'Filter shape: '</span></span>, filter_vals.shape) <span class="hljs-comment"><span class="hljs-comment"># Defining the Filters filter_1 = filter_vals filter_2 = -filter_1 filter_3 = filter_1.T filter_4 = -filter_3 filters = np.array([filter_1, filter_2, filter_3, filter_4]) # Check the Filters fig = plt.figure(figsize=(10, 5)) for i in range(4): ax = fig.add_subplot(1, 4, i+1, xticks=[], yticks=[]) ax.imshow(filters[i], cmap='gray') ax.set_title('Filter %s' % str(i+1)) width, height = filters[i].shape for x in range(width): for y in range(height): ax.annotate(str(filters[i][x][y]), xy=(y,x), color='white' if filters[i][x][y]&lt;0 else 'black')</span></span></code> </pre><br><img src="https://habrastorage.org/getpro/habr/post_images/4c7/75f/1fc/4c775f1fc19bd461679d5a45831f1e2e.png" alt="ุงูุตูุฑุฉ"><br><br>  <b>ุงูุฎุทูุฉ 3</b> : ุชุญุฏูุฏ SNA <br><br>  ูุญุชูู ูุธุงู ุงูุญุณุงุจุงุช ุงูููููุฉ ูุฐุง ุนูู ุทุจูุฉ ุชูุงููููุฉ ูุทุจูุฉ ุชุฌููุน ุฐุงุช ูุธููุฉ ูุตูู ุ ูุชุชู ุชููุฆุฉ ุงูุฃูุฒุงู ุจุงุณุชุฎุฏุงู ุงููุฑุดุญุงุช ุงูููุถุญุฉ ุฃุนูุงู ุ <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> torch <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> torch.nn <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> nn <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> torch.nn.functional <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> F <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Net</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(nn.Module)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, weight)</span></span></span><span class="hljs-function">:</span></span> super(Net, self).__init__() <span class="hljs-comment"><span class="hljs-comment"># initializes the weights of the convolutional layer to be the weights of the 4 defined filters k_height, k_width = weight.shape[2:] # assumes there are 4 grayscale filters self.conv = nn.Conv2d(1, 4, kernel_size=(k_height, k_width), bias=False) # initializes the weights of the convolutional layer self.conv.weight = torch.nn.Parameter(weight) # define a pooling layer self.pool = nn.MaxPool2d(2, 2) def forward(self, x): # calculates the output of a convolutional layer # pre- and post-activation conv_x = self.conv(x) activated_x = F.relu(conv_x) # applies pooling layer pooled_x = self.pool(activated_x) # returns all layers return conv_x, activated_x, pooled_x # instantiate the model and set the weights weight = torch.from_numpy(filters).unsqueeze(1).type(torch.FloatTensor) model = Net(weight) # print out the layer in the network print(model)</span></span></code> </pre><br><blockquote style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">Net( (conv): Conv2d(1, 4, kernel_size=(4, 4), stride=(1, 1), bias=False) (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False) )</code> </pre> </blockquote>  <b>ุงูุฎุทูุฉ 4</b> : ุชูุฏูู ุงููุฑุดุญุงุช <br>  ูุธุฑุฉ ุณุฑูุนุฉ ุนูู ุงููุฑุดุญุงุช ุงููุณุชุฎุฏูุฉ ุ <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">viz_layer</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(layer, n_filters= </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">4</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> fig = plt.figure(figsize=(<span class="hljs-number"><span class="hljs-number">20</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(n_filters): ax = fig.add_subplot(<span class="hljs-number"><span class="hljs-number">1</span></span>, n_filters, i+<span class="hljs-number"><span class="hljs-number">1</span></span>) ax.imshow(np.squeeze(layer[<span class="hljs-number"><span class="hljs-number">0</span></span>,i].data.numpy()), cmap=<span class="hljs-string"><span class="hljs-string">'gray'</span></span>) ax.set_title(<span class="hljs-string"><span class="hljs-string">'Output %s'</span></span> % str(i+<span class="hljs-number"><span class="hljs-number">1</span></span>)) fig = plt.figure(figsize=(<span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>)) fig.subplots_adjust(left=<span class="hljs-number"><span class="hljs-number">0</span></span>, right=<span class="hljs-number"><span class="hljs-number">1.5</span></span>, bottom=<span class="hljs-number"><span class="hljs-number">0.8</span></span>, top=<span class="hljs-number"><span class="hljs-number">1</span></span>, hspace=<span class="hljs-number"><span class="hljs-number">0.05</span></span>, wspace=<span class="hljs-number"><span class="hljs-number">0.05</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">4</span></span>): ax = fig.add_subplot(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, i+<span class="hljs-number"><span class="hljs-number">1</span></span>, xticks=[], yticks=[]) ax.imshow(filters[i], cmap=<span class="hljs-string"><span class="hljs-string">'gray'</span></span>) ax.set_title(<span class="hljs-string"><span class="hljs-string">'Filter %s'</span></span> % str(i+<span class="hljs-number"><span class="hljs-number">1</span></span>)) gray_img_tensor = torch.from_numpy(gray_img).unsqueeze(<span class="hljs-number"><span class="hljs-number">0</span></span>).unsqueeze(<span class="hljs-number"><span class="hljs-number">1</span></span>)</code> </pre><br>  ูุฑุดุญุงุช: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/885/5c9/cac/8855c9cace448bed1d831c3dc4731828.png" alt="ุงูุตูุฑุฉ"><br><br>  <b>ุงูุฎุทูุฉ 5</b> : ุชุตููุฉ ุงููุชุงุฆุฌ ุญุณุจ ุงูุทุจูุฉ <br><br>  ูุชู ุนุฑุถ ุงูุตูุฑ ุงูุชู ุชุธูุฑ ูู ุทุจูุฉ CONV ู POOL ุฃุฏูุงู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">viz_layer(activated_layer) viz_layer(pooled_layer)</code> </pre><br>  ุทุจูุงุช ุชูุงููููุฉ <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6bb/4c8/1bc/6bb4c81bc6ef16044dfc22e9e36bbaa6.png" alt="ุงูุตูุฑุฉ"><br><br>  ุชุฌูุน ุทุจูุงุช <br><br><img src="https://habrastorage.org/getpro/habr/post_images/789/278/823/78927882302ae10f6403ba3a498669fd.png" alt="ุงูุตูุฑุฉ"><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงููุตุฏุฑ</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar436838/">https://habr.com/ru/post/ar436838/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar436822/index.html">Android Robotics ุญุชู 2019: ุงููุตุฉ ุงูุญููููุฉ ุ ูู 5 ุฃุฌุฒุงุก ุ ุงูุฌุฒุก 3</a></li>
<li><a href="../ar436826/index.html">Android Robotics ุญุชู 2019: ุงููุตุฉ ุงูุญููููุฉ ุ ูู 5 ุฃุฌุฒุงุก ุ ุงูุฌุฒุก 4</a></li>
<li><a href="../ar436828/index.html">ุงูุงูุชูุงู ุฅูู Boost-1.65.1 ูุงูุฃุฎุทุงุก ุงูุชู ุธูุฑุช</a></li>
<li><a href="../ar436830/index.html">Android Robotics ุญุชู 2019: ุงููุตุฉ ุงูุญููููุฉ ุ ูู 5 ุฃุฌุฒุงุก ุ ุงูุฌุฒุก 5</a></li>
<li><a href="../ar436836/index.html">ููุงุฆุฏ ุชุญููู ุชุทุจููุงุช ุงููุณุชูู 7 ูู ุฌุฏุฑุงู ุงูุญูุงูุฉ. ุงูุฌุฒุก 2. ุงูุฃูู</a></li>
<li><a href="../ar436840/index.html">ุงูุทุฑูู ูู ุงูููุนุงู ุฅูู ุงูุนููู ุงูุนุตุจูุฉ: ุจูุฏูุงุณุช ููุงุถูุนู ุนู ูุธุงุฆู ูู ูุฌุงู ุงูุฅุนูุงู ูุชุณููู ุงููุญุชูู</a></li>
<li><a href="../ar436842/index.html">ุญู Veeam ูููุณุฎ ุงูุงุญุชูุงุทู ูุงุณุชุฑุฏุงุฏ ุงูุฃุฌูุฒุฉ ุงูุงูุชุฑุงุถูุฉ ุนูู ููุตุฉ Nutanix AHV. ุงูุฌุฒุก 2</a></li>
<li><a href="../ar436846/index.html">ููุฎุต ุงูููุงุฏ ุงูุทุงุฒุฌุฉ ูู ุนุงูู ุงููุงุฌูุฉ ุงูุฃูุงููุฉ ููุฃุณุจูุน ุงููุงุถู ุฑูู 348 (14-20 ููุงูุฑ 2019)</a></li>
<li><a href="../ar436848/index.html">NSA ุชุนูู ุนู ุฅุทูุงู ุฃุฏุงุฉ ุฏุงุฎููุฉ ููููุฏุณุฉ ุงูุนูุณูุฉ</a></li>
<li><a href="../ar436850/index.html">ุงูุฃุฎุทุงุก ุงูุดุงุฆุนุฉ ุนูุฏ ูุชุงุจุฉ ุงุฎุชุจุงุฑุงุช ุงููุญุฏุฉ. ูุญุงุถุฑุฉ ูุงูุฏูุณ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>