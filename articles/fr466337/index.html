<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üè¥Û†ÅßÛ†Å¢Û†Å∑Û†Å¨Û†Å≥Û†Åø üêÜ üè¢ De quelle couleur est ta fonction? üéå üßëüèø üéê</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Je ne sais pas pour vous, mais pour moi il n'y a pas de meilleur d√©but de journ√©e que de se soucier de la programmation. Le sang bouillonne √† la vue d...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>De quelle couleur est ta fonction?</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/466337/"><p>  Je ne sais pas pour vous, mais pour moi il n'y a pas de meilleur d√©but de journ√©e que de se soucier de la programmation.  Le sang bouillonne √† la vue d'une critique r√©ussie de l'une des langues "audacieuses" utilis√©es par les pl√©b√©iens, tourment√©e avec elle pendant la journ√©e de travail entre les visites timides √† StackOverflow. </p><br><p>  (En attendant, vous et moi n'utilisons que le langage le plus √©clair√© et des outils sophistiqu√©s con√ßus pour les mains habiles de ma√Ætres comme nous). </p><br><p>  Bien s√ªr, en tant qu'auteur du sermon, je prends des risques.  Vous aimerez peut-√™tre la langue dont je me moque!  Une brochure imprudente aurait pu par inadvertance amener sur mon blog une foule furieuse de mobiles avec des fourches et des torches √† port√©e de main. </p><br><p>  Afin de me prot√©ger du feu juste et de ne pas offenser vos sentiments (probablement d√©licats), je vais parler de la langue ... </p><a name="habracut"></a><br><p>  ... qui vient d'arriver.  A propos d'une effigie de paille, dont le seul r√¥le est de br√ªler les critiques sur le b√ªcher. </p><br><p>  Je sais que cela semble idiot, mais croyez-moi, √† la fin nous verrons dont le visage (ou les visages) ont √©t√© peints sur une t√™te de paille. </p><br><h1 id="novyy-yazyk">  Nouvelle langue </h1><br><p> Ce sera exag√©r√© d'apprendre une langue compl√®tement nouvelle (et excitante) uniquement pour un article de blog, alors disons qu'elle est tr√®s similaire √† la langue que nous connaissons d√©j√†.  Par exemple Javascript.  Bretelles et points-virgules boucl√©s.  <code>if</code> , <code>while</code> , etc.  - <em>Lingua franca de</em> notre foule. </p><br><p>  Je n'ai pas choisi JS parce que cet article parle de lui.  C'est juste une langue dans laquelle le lecteur moyen est susceptible de se familiariser.  Voila: </p><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">thisIsAFunction</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"!"</span></span>; }</code> </pre> <br><p>  Puisque notre animal en peluche est un langage <em>cool</em> (lu - mauvais), il a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">des fonctions de premi√®re classe</a> .  Vous pouvez donc √©crire quelque chose comme ceci: </p><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//  ,     , //    function filter(collection, predicate) { var result = []; for (var i = 0; i &lt; collection.length; i++) { if (predicate(collection[i])){ result.push(collection[i]); } } return result; }</span></span></code> </pre> <br><p>  C'est l'une des toutes <em>premi√®res</em> fonctionnalit√©s de <em>classe</em> , et comme son nom l'indique, elles sont cool et super utiles.  Vous avez probablement l'habitude de transformer les collections de donn√©es avec leur aide, mais d√®s que vous comprenez le concept, vous commencez √† les utiliser partout, bon sang. </p><br><p>  Peut-√™tre lors des tests: </p><br><pre> <code class="javascript hljs">describe(<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ it(<span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ expect(<span class="hljs-string"><span class="hljs-string">""</span></span>).not.toBe(<span class="hljs-string"><span class="hljs-string">""</span></span>); }); };</code> </pre> <br><p>  Ou lorsque vous devez analyser (analyser) les donn√©es: </p><br><pre> <code class="javascript hljs">tokens.match(Token.LEFT_BRACKET, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">token</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-comment"><span class="hljs-comment">// Parse a list literal... tokens.consume(Token.RIGHT_BRACKET); });</span></span></code> </pre> <br><p>  Ensuite, apr√®s avoir acc√©l√©r√©, vous √©crivez toutes sortes de biblioth√®ques et d'applications r√©utilisables qui tournent autour des fonctions, des appels de fonction, des retours de fonction des fonctions - une cabine fonctionnelle. </p><br><blockquote>  traducteur: dans l'original "Functapalooza".  Le pr√©fixe <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">-a-palooza</a> est tellement cool que vous souhaitez le partager avec tout le monde. </blockquote><br><h1 id="kakogo-cveta-vasha-funkciya">  De quelle couleur est ta fonction? </h1><br><p>  Et ici les bizarreries commencent.  Notre langue a une particularit√©: </p><br><h3 id="1-kazhdaya-funkciya-imeet-cvet">  1. Chaque fonction a une couleur. </h3><br><p>  Chaque fonction - un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">rappel</a> anonyme ou une fonction r√©guli√®re avec un nom - est soit rouge soit bleue.  √âtant donn√© que la mise en √©vidence du code dans notre blog ne met pas en √©vidence la couleur diff√©rente des fonctions, admettons que la syntaxe est: </p><br><pre> <code class="javascript hljs">blue*<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doSomethingAzure</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-comment"><span class="hljs-comment">//   ... } red*function doSomethingCarnelian(){ //    ... }</span></span></code> </pre> <br><p>  Notre langue n'a pas de fonctions incolores.  Vous voulez cr√©er une fonctionnalit√©?  - doit choisir une couleur.  Ce sont les r√®gles.  Et il y a quelques r√®gles suppl√©mentaires que vous devez suivre: </p><br><h3 id="2-cvet-vliyaet-na-sposob-vyzova-funkcii">  2. La couleur affecte la fa√ßon dont la fonction est appel√©e </h3><br><p>  Imaginez qu'il existe deux syntaxes pour appeler des fonctions - ¬´bleu¬ª et ¬´rouge¬ª.  Quelque chose comme: </p><br><pre> <code class="javascript hljs">doSomethingAzure(...)*blue; doSomethingCarnelian()*red;</code> </pre> <br><p>  Lorsque vous appelez une fonction, vous devez utiliser un appel qui correspond √† sa couleur.  Si vous n'avez pas devin√© - ils ont appel√© la fonction rouge avec <code>*blue</code> apr√®s les crochets (ou vice versa) - quelque chose de tr√®s grave se produira.  Un cauchemar d'enfance oubli√© depuis longtemps, comme un clown avec des serpents au lieu de mains qui se cachaient sous votre lit.  Il va sauter du moniteur et vous sucer les yeux. </p><br><p>  R√®gle stupide, non?  Oh, mais encore une chose: </p><br><h3 id="3-tolko-krasnaya-funkciya-mozhet-vyzvat-krasnuyu-funkciyu">  3. Seule la fonction rouge peut provoquer la fonction rouge. </h3><br><p>  Vous <em>pouvez</em> appeler la fonction bleue depuis le rouge.  C'est casher: </p><br><pre> <code class="javascript hljs">red*<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doSomethingCarnelian</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ doSomethingAzure()*blue; }</code> </pre> <br><p>  Mais pas l'inverse.  Si vous essayez: </p><br><pre> <code class="javascript hljs">blue*<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doSomethingAzure</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ doSomethingCarnelian()*red; }</code> </pre> <br><p>  - vous serez visit√© par l'ancien Clown Spider Maw. </p><br><p>  Cela rend plus difficile l'√©criture de fonctions sup√©rieures telles que <code>filter()</code> partir de l'exemple.  Nous devons choisir une couleur pour chaque nouvelle fonction et cela affecte la couleur des fonctions que nous pouvons lui transmettre.  La solution √©vidente est de rendre le <code>filter()</code> rouge.  Ensuite, nous pouvons appeler au moins des fonctions rouges, au moins bleues.  Mais alors nous nous blessons √† propos de la prochaine √©pine dans la couronne d'√©pines, qui est la langue donn√©e: </p><br><h3 id="4-krasnye-funkcii-bolnee-vyzyvat">  4. Les fonctions rouges provoquent de la douleur </h3><br><p>  Nous ne mettrons pas en √©vidence cette ¬´douleur¬ª, imaginons simplement que le programmeur doit sauter √† travers le cerceau chaque fois qu'il appelle la fonction rouge.  L'appel peut √™tre trop polysyllabique ou vous ne pouvez pas ex√©cuter la fonction dans certaines expressions.  Ou vous ne pouvez acc√©der √† la fonction rouge qu'√† partir de lignes impaires. </p><br><p>  Peu importe ce que c'est, mais si vous d√©cidez de rendre la fonction rouge, tous ceux qui utilisent votre API voudront cracher dans votre caf√© ou faire pire. </p><br><p>  La solution √©vidente dans ce cas est de ne jamais utiliser de fonctions rouges.  Faites tout bleu, et vous √™tes de retour dans le monde normal, o√π toutes les fonctions sont de la m√™me couleur, ce qui √©quivaut au fait qu'elles n'ont pas de couleur et que notre langage n'est pas compl√®tement stupide. </p><br><p>  H√©las, les sadiques qui ont d√©velopp√© ce langage (tout le monde sait que les auteurs des langages de programmation sont sadiques, non?) Collez la derni√®re √©pine en nous: </p><br><h3 id="5-nekotorye-funkcii-yadra-yazyka----krasnye">  5. Certaines des fonctions essentielles du langage sont en rouge. </h3><br><p>  Certaines fonctions int√©gr√©es √† la plateforme, fonctions que nous <em>devons</em> utiliser et qui ne peuvent pas √™tre √©crites par nous-m√™mes, sont disponibles uniquement en rouge.  √Ä ce stade, une personne intelligente peut commencer √† soup√ßonner que cette langue nous d√©teste. </p><br><h1 id="eto-vse-vina-funkcionalnyh-yazykov">  Tout cela est la faute des langages fonctionnels! </h1><br><p>  Vous pourriez penser que le probl√®me est que nous essayons d'utiliser des fonctions d'ordre sup√©rieur.  Si nous arr√™tons de jouer avec toutes ces b√™tises fonctionnelles et commen√ßons √† √©crire des fonctions bleues normales du <em>premier ordre</em> (fonctions qui ne fonctionnent pas avec d'autres fonctions - environ Translator), comme pr√©vu par Dieu - nous nous d√©barrasserons de toute cette douleur. </p><br><p>  Si nous n'appelons que des fonctions bleues, nous rendons toutes nos fonctions bleues.  Sinon, nous faisons du rouge.  Jusqu'√† ce que nous cr√©ons des fonctions qui acceptent des fonctions, nous n'avons pas besoin de nous soucier du ¬´polymorphisme de la couleur de la fonction¬ª (polychromatique?) Ou de tout autre non-sens. </p><br><p>  Mais h√©las, les fonctions d'ordre sup√©rieur ne sont qu'un exemple.  Le probl√®me se pose chaque fois que nous voulons diviser notre programme en fonctions pour r√©utilisation. </p><br><p>  Par exemple, nous avons un joli petit morceau de code qui, eh bien, je ne sais pas, impl√©mente l'algorithme de Dijkstra sur un graphique repr√©sentant √† quel point vos relations sociales se mettent la pression les unes sur les autres.  (J'ai pass√© beaucoup de temps √† essayer de d√©cider ce que le r√©sultat signifierait. Ind√©sirable transitoire?) </p><br><p>  Plus tard, vous deviez utiliser cet algorithme ailleurs.  Naturellement, vous encapsulez le code dans une fonction distincte.  Appelez-la de l'ancien et du nouveau.  Mais de quelle couleur devrait √™tre la fonction?  Vous allez probablement essayer de le rendre bleu, mais que se passe-t-il s'il utilise l'une de ces m√©chantes fonctions "uniquement rouges" de la biblioth√®que du noyau? </p><br><p>  Disons que le nouvel endroit √† partir duquel vous souhaitez appeler la fonction est bleu?  Mais maintenant, vous devez r√©√©crire le code d'appel en rouge.  Et puis refaites la fonction qui appelle ce code.  Ouf  De toute fa√ßon, vous devrez constamment vous souvenir de la couleur.  Ce sera le sable dans votre maillot de bain sur une programmation de vacances √† la plage. </p><br><h1 id="cvetnaya-allegoriya">  All√©gorie des couleurs </h1><br><p>  En fait, je ne parle pas de couleur.  Il s'agit d'une all√©gorie, d'un dispositif litt√©raire.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Putain</a> - ce n'est pas sur les <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">√©toiles sur le ventre</a> , c'est sur la course.  Vous soup√ßonnez probablement d√©j√† ... </p><br><h3 id="krasnye-funkcii---asinhronnye">  Fonctions rouges - asynchrone </h3><br><p>  Si vous programmez en JavaScript ou Node.js, chaque fois que vous d√©finissez une fonction qui appelle <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">une fonction de</a> rappel (rappel) pour ¬´retourner¬ª le r√©sultat, vous √©crivez une fonction rouge.  Regardez cette liste de r√®gles et notez comment elles s'int√®grent dans ma m√©taphore: </p><br><ol><li>  Les fonctions synchrones renvoient un r√©sultat, les fonctions asynchrones non; en retour, elles appellent un rappel. </li><li>  Les fonctions synchrones renvoient le r√©sultat sous forme de valeur de retour, les fonctions asynchrones le renvoient, provoquant le rappel que vous leur avez transmis. </li><li>  Vous ne pouvez pas appeler une fonction asynchrone √† partir d'une fonction synchrone, car vous ne pouvez pas conna√Ætre le r√©sultat tant que la fonction asynchrone n'est pas ex√©cut√©e ult√©rieurement. </li><li>  Les fonctions asynchrones ne sont pas compil√©es en expressions en raison de rappels, n√©cessitent que leurs erreurs soient trait√©es diff√©remment et ne peuvent pas √™tre utilis√©es dans un bloc <code>try/catch</code> ou dans un certain nombre d'autres expressions qui contr√¥lent le programme. </li><li>  tout ce qui concerne Node.js est que la biblioth√®que du noyau est tout asynchrone.  (Bien qu'ils aient donn√© en retour et commenc√© √† ajouter des versions de <code>_Sync()</code> √† beaucoup de choses.) </li></ol><br><p>  Quand les gens parlent de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">¬´l'enfer du rappel¬ª</a> , ils parlent de la g√™ne d'avoir des fonctions ¬´rouges¬ª dans leur langue.  Quand ils cr√©ent <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">4089 biblioth√®ques pour la programmation asynchrone</a> (en 2019 d√©j√† 11217 - environ Traducteur), ils essaient de faire face au probl√®me au niveau de la biblioth√®que qu'ils ont √©t√© coinc√©s avec le langage. </p><br><h1 id="i-promise-the-future-is-better">  Je promets que l'avenir est meilleur </h1><br><blockquote>  en traduction: "Je promets que l'avenir est meilleur" le jeu des mots du titre et du contenu de la section est perdu </blockquote><p>  Les gens de Node.js ont depuis longtemps r√©alis√© que les rappels faisaient mal et cherchaient des solutions.  L'une des techniques qui a inspir√© de nombreuses personnes est la <code>promises</code> , que vous connaissez peut-√™tre √©galement dans le <code>futures</code> surnoms. </p><br><blockquote>  en russe IT, au lieu de traduire "promesses" par "promesses", du papier calque de l'anglais - "promesses" a √©t√© √©tabli.  Le mot "Futures" est utilis√© tel quel, probablement parce que les "futures" sont d√©j√† occup√©s par l'argot financier. </blockquote><p>  Promis est un wrapper pour le rappel et le gestionnaire d'erreurs.  Si vous songez √† passer un rappel pour le r√©sultat et un autre rappel pour l'erreur, alors l' <code>future</code> est l'incarnation de cette id√©e.  Il s'agit d'un objet de base qui est une op√©ration asynchrone. </p><br><p>  Je viens de recevoir un tas de libell√©s fantaisistes et cela peut sembler une excellente solution, mais c'est surtout de l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">huile de serpent</a> .  Les promesses facilitent vraiment l'√©criture de code asynchrone.  Ils sont plus faciles √† composer en expressions, donc la r√®gle 4 est un peu moins stricte. </p><br><p>  Mais pour √™tre honn√™te, c'est comme la diff√©rence entre un coup √† l'estomac ou √† l'aine.  Oui, cela ne fait pas trop mal, mais personne ne sera ravi d'un tel choix. </p><br><p>  Vous ne pouvez toujours pas utiliser de promesses avec gestion des exceptions ou autres <br>  gestion des op√©rateurs.  Vous ne pouvez pas appeler une fonction qui renvoie <code>future</code> partir d'un code synchrone.  (vous <em>pouvez</em> , mais le prochain responsable de votre code inventera une machine √† remonter le temps, reviendra au moment o√π vous l'avez fait et vous mettra un crayon dans le visage pour la raison n ¬∞ 2). </p><br><p>  Les promesses divisent toujours votre monde en deux moiti√©s asynchrones et synchrones avec toutes les souffrances qui en d√©coulent.  Donc, m√™me si votre langue prend en charge les <code>promises</code> ou les <code>futures</code> , elle ressemble toujours beaucoup √† ma langue. </p><br><p>  (Oui, cela inclut m√™me le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Dart</a> que j'utilise. Par cons√©quent, je suis tellement heureux qu'une partie de l'√©quipe <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">essaie d'autres approches du parall√©lisme</a> ) </p><br><blockquote>  lien de projet officiellement abandonn√© </blockquote><br><h1 id="im-awaiting-a-solution">  J'attends une solution </h1><br><p>  Les programmeurs C # se sentent probablement complaisants (la raison pour laquelle ils deviennent de plus en plus des victimes est que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Halesberg</a> et la soci√©t√© saupoudrent tout et saupoudrent le langage de sucre syntaxique).  En C #, vous pouvez utiliser le mot cl√© <code>await</code> pour appeler une fonction asynchrone. </p><br><p>  Cela rend les appels asynchrones aussi faciles que synchrones, avec l'ajout d'un petit mot-cl√© mignon.  Vous pouvez ins√©rer un appel en <code>await</code> dans des expressions, les utiliser dans la gestion des exceptions, dans le flux d'instructions.  Tu peux devenir fou.  Attendons la pluie comme de l'argent pour votre nouvel album de rappeur. </p><br><p>  L'attente asynchrone est agr√©able, nous l'ajoutons donc √† Dart.  Il est beaucoup plus facile <em>d'√©crire du</em> code asynchrone avec lui.  Mais, comme toujours, il y a un ¬´Mais¬ª.  √áa y est.  <em>Mais ...</em> vous divisez toujours le monde en deux.  Les fonctions asynchrones sont d√©sormais plus faciles √† √©crire, mais <em>ce sont toujours des fonctions asynchrones.</em> </p><br><p>  Vous avez encore deux couleurs.  L'attente asynchrone r√©sout le probl√®me ennuyeux # 4 - ils rendent l'appel des fonctions rouges pas plus difficile que l'appel des fonctions bleues.  Mais le reste des r√®gles est toujours l√†: </p><br><ol><li>  Les fonctions synchrones renvoient des valeurs, les fonctions asynchrones renvoient un wrapper ( <code>Task&lt;T&gt;</code> en C # ou <code>Future&lt;T&gt;</code> dans Dart) autour de la valeur. </li><li>  Synchrone vient d'appeler, le besoin asynchrone <code>await</code> . </li><li>  En appelant une fonction asynchrone, vous obtenez un objet wrapper lorsque vous voulez vraiment une valeur.  Vous ne pouvez pas d√©velopper la valeur jusqu'√† ce que vous rendiez <em>votre</em> fonction asynchrone et l'appeliez avec <code>await</code> (mais consultez le paragraphe suivant). </li><li>  En plus d'un peu de d√©coration attendue, au moins nous avons r√©solu ce probl√®me. </li><li>  La biblioth√®que de base C # est plus ancienne que l'asynchronie, donc je pense qu'ils n'ont jamais eu ce probl√®me. </li></ol><br><p>  <code>Async</code> <em>vraiment</em> mieux.  Je pr√©f√®re attendre asynchrone aux rappels nus n'importe quel jour de la semaine.  Mais nous nous mentons si nous pensons que tous les probl√®mes sont r√©solus.  D√®s que vous commencez √† √©crire des fonctions d'ordre sup√©rieur ou √† r√©utiliser du code, vous vous rendez compte √† nouveau que la couleur est toujours l√†, saignant √† travers tout votre code source. </p><br><h1 id="kakoy-yazyk-_ne_-cvetnoy">  Quelle langue n'est <em>pas la</em> couleur? </h1><br><p>  JS, Dart, C # et Python ont donc ce probl√®me.  CoffeeScript et la plupart des autres langages se compilent √©galement en JS (et Dart h√©rit√©).  Je pense que m√™me ClojureScript a ce pi√®ge, malgr√© leurs efforts actifs avec <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">core.async</a> </p><br><p>  Vous voulez savoir lequel ne fonctionne pas?  <em>Java</em>  Ai-je raison  √Ä quelle fr√©quence dites-vous: ¬´Oui, Java seul le fait correctement¬ª?  Et c'est arriv√©.  Pour leur d√©fense, ils essaient activement de corriger leur oubli en promouvant les <code>futures</code> et les IO asynchrones.  C'est comme une course pire que pire. </p><br><blockquote>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">tout</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">est</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">d√©j√†</a> en Java </blockquote><p>  C #, en fait, <em>peut</em> √©galement contourner ce probl√®me.  Ils ont <em>choisi d'</em> avoir de la couleur.  Avant d'ajouter async-wait et toutes ces ordures <code>Task&lt;T&gt;</code> , vous pouvez simplement utiliser des appels API synchrones r√©guliers.  Trois autres langues qui n'ont pas de probl√®me de ¬´couleur¬ª: Go, Lua et Ruby. </p><br><p>  Devinez ce qu'ils ont en commun? </p><br><p>  <em>Streams.</em>  Ou plus pr√©cis√©ment: de nombreuses <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">piles d'appels</a> ind√©pendants <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">pouvant basculer</a> .  Ce ne sont pas n√©cessairement des threads du syst√®me d'exploitation.  Les coroutines dans Go, les coroutines dans Lua et les fils dans Ruby sont tous ad√©quats. </p><br><p>  (C'est pourquoi il y a cette petite mise en garde pour C # - vous pouvez √©viter la douleur asynchrone en C # en utilisant des threads.) </p><br><h1 id="pamyat-o-proshlyh-operaciyah">  M√©moire des op√©rations pass√©es </h1><br><p>  Le probl√®me fondamental est "comment continuer √† partir du m√™me endroit lorsque l'op√©ration (asynchrone) est termin√©e"?  Vous avez plong√© dans l'ab√Æme de la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">pile des appels</a> , puis appel√© une sorte d'op√©ration d'E / S.  Pour des raisons d'acc√©l√©ration, cette op√©ration utilise l'API asynchrone sous-jacente de votre syst√®me d'exploitation.  Vous <em>ne pouvez pas</em> attendre qu'il se termine.  Vous devez revenir √† <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">la boucle d'√©v√©nements de</a> votre langue et donner au syst√®me d'exploitation le temps de terminer l'op√©ration. </p><br><p>  Une fois que cela se produit, vous devez reprendre ce que vous faisiez.  Habituellement, la langue ¬´se souvient de l'endroit o√π elle √©tait¬ª via <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">la pile d'appels</a> .  Il suit √† travers toutes les fonctions qui ont √©t√© appel√©es en ce moment, et regarde o√π le compteur de commandes dans chacun d'eux montre. </p><br><p>  Mais pour effectuer des E / S asynchrones, vous devez vous d√©tendre, supprimer la pile d'appels enti√®re en C. Type Trick-22.  Vous avez des E / S super rapides, mais vous ne pouvez pas utiliser le r√©sultat!  Toutes les langues avec des E / S asynchrones sous le capot - ou, dans le cas de JS, la boucle d'√©v√©nements du navigateur - sont oblig√©es de g√©rer cela d'une mani√®re ou d'une autre. </p><br><p>  Node, avec ses rappels en marche pour toujours, place tous ces appels dans des fermetures.  Lorsque vous √©crivez: </p><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">makeSundae</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">callback</span></span></span><span class="hljs-function">) </span></span>{ scoopIceCream(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">iceCream</span></span></span><span class="hljs-function">) </span></span>{ warmUpCaramel(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">caramel</span></span></span><span class="hljs-function">) </span></span>{ callback(pourOnIceCream(iceCream, caramel)); }); }); }</code> </pre> <br><p>  Chacune de ces expressions fonctionnelles <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><em>ferme</em></a> tout son contexte environnant.  Cela transf√®re des param√®tres, tels que <code>iceCream</code> et <code>caramel</code> , de la pile d'appels vers le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">tas</a> .  Quand une fonction externe renvoie un r√©sultat et que la pile d'appels est d√©truite, c'est cool.  Les donn√©es sont toujours quelque part sur le tas. </p><br><p>  Le probl√®me est que vous devez ressusciter chacun de ces fichus appels.  Il y a m√™me un nom sp√©cial pour cette conversion: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">style passant-continuation</a> </p><br><blockquote>  lier une fonctionnalit√© f√©roce </blockquote><p>  Cela a √©t√© invent√© par les hackers linguistiques dans les ann√©es 70, comme repr√©sentation interm√©diaire √† utiliser sous le capot des compilateurs.  C'est une fa√ßon tr√®s bizarre d'introduire du code qui facilite l'ex√©cution de certaines optimisations du compilateur. </p><br><p>  Personne n'a jamais pens√© qu'un programmeur pourrait <em>√©crire un tel code</em> .  Et puis Node est apparu, et soudain, nous pr√©tendons tous √©crire un backend de compilateur.  O√π avons-nous tourn√© dans le mauvais sens? </p><br><p>  Notez que les promesses et les <code>futures</code> n'aident pas vraiment beaucoup.  Si vous les utilisez, vous savez que vous accumulez toujours des couches g√©antes d' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">expressions fonctionnelles</a> .  Vous les passez simplement √† <code>.then()</code> au lieu de la fonction asynchrone elle-m√™me. </p><br><h1 id="awaiting-a-generated-solution">  En attente d'une solution g√©n√©r√©e </h1><br><p>  L'attente <em>asynchrone</em> aide <em>vraiment</em> .  Si vous regardez sous le capot du compilateur lorsqu'il <code>await</code> , vous verrez qu'il effectue r√©ellement la conversion CPS.  C'est <em>pourquoi</em> vous devez utiliser l' <code>await</code> en C # - c'est un indice pour le compilateur - "arr√™tez la fonction au milieu ici".  Tout apr√®s <code>await</code> devient une nouvelle fonction que le compilateur synth√©tise en votre nom. </p><br><p>  C'est pourquoi async-wait n'a pas besoin de prise en charge d' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ex√©cution</a> dans le cadre .NET.  Le compilateur compile cela en une cha√Æne de fermetures associ√©es, qu'il sait d√©j√† g√©rer.  (Fait int√©ressant, les fermetures ne n√©cessitent pas non plus de prise en charge d'ex√©cution. Elles sont compil√©es en classes anonymes. En C #, les fermetures ne sont que des objets.) </p><br><p>  Vous vous demandez probablement quand je parle des g√©n√©rateurs.  Y a-t-il du <code>yield</code> dans votre langue?  Ensuite, il peut faire quelque chose de tr√®s similaire. </p><br><p>  (Je crois que les g√©n√©rateurs et l'attente asynchrone sont en fait isomorphes. Quelque part dans les coins et recoins poussi√©reux de mon disque dur se trouve un morceau de code qui impl√©mente la boucle de jeu sur les g√©n√©rateurs utilisant uniquement l'attente asynchrone.) </p><br><p>  Alors o√π suis-je?  Ah oui.  Ainsi, avec les rappels, les promesses, l'attente asynchrone et les g√©n√©rateurs, vous finissez par prendre votre fonction asynchrone et la diviser en un tas de fermetures qui vivent sur le tas. </p><br><p>  Votre fonction appelle external lors de l'ex√©cution.  Lorsque la boucle d'√©v√©nement ou l'op√©ration d'E / S est termin√©e, votre fonction est appel√©e et continue √† l'endroit o√π elle se trouvait.  Mais cela signifie que tout ce qui est au-dessus de votre fonction devrait <em>√©galement</em> revenir.  Vous devez toujours restaurer la pile enti√®re. </p><br><p>  C‚Äôest de l√† que vient la r√®gle ¬´il est possible d‚Äôappeler la fonction rouge uniquement √† partir de la fonction rouge¬ª.  Vous devez enregistrer l'int√©gralit√© de la pile d'appels dans des fermetures vers <code>main()</code> - <code>main()</code> ou le gestionnaire d'√©v√©nements. </p><br><h1 id="realizaciya-steka-vyzovov">  Impl√©mentation de la pile d'appels </h1><br><p>  Mais en utilisant des threads (niveau <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">vert</a> ou OS), vous n'avez pas besoin de le faire.  Vous pouvez simplement mettre en pause l'int√©gralit√© du thread et passer au syst√®me d'exploitation ou √† la boucle d'√©v√©nements <em>sans avoir √† revenir de toutes ces fonctions</em> . </p><br><p>  La langue de Go, √† ma connaissance, le fait parfaitement.  D√®s que vous effectuez une op√©ration d'E / S, Go garera cette coroutine et continuera toute autre qui n'est pas bloqu√©e par les E / S. </p><br><p>  Si vous regardez les op√©rations d'E / S dans la biblioth√®que standard de Golang, elles semblent synchrones.  En d'autres termes, ils fonctionnent et retournent le r√©sultat lorsqu'ils sont pr√™ts.  Mais cette synchronisation ne signifie pas la m√™me chose qu'en Javascript.  Go-  ,    IO .  Go       . </p><br><p>   Go ‚Äî   <em></em>    ,        .       ,   ,    . </p><br><p>     ,               API,   ,     .           . </p><br><hr><br><h1 id="ot-perevodchika">   </h1><br><p>  ,           ,          .       ,        . ,      50%          . </p><br><p> ,      ,      ,                 . </p><br><p>  Javascript   -,   , ,   JS   ,    JS   ,          .   ,    JS   . </p><br><p>      ,      (     )   ‚Äî  ,     ,   ,        <code>async</code>         .     <code>import threading</code>      (  ,          AsyncIO, Twisted  Tornado,    ). </p><br><p>     ,             ,     ,     ,        ,                  ,      . </p><br><p>       ,     Go,     Go . </p><br><p>  ,        ,  ,  ( -    )          ,          "async-await  ".      . </p><br><p>    ,       . </p><br><p> ,       ,     . </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr466337/">https://habr.com/ru/post/fr466337/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr466319/index.html">Deal: VMware ach√®te une startup bas√©e sur le cloud</a></li>
<li><a href="../fr466323/index.html">Nous cr√©ons un jeu de plateforme portable sur le microcontr√¥leur Cortex M0 +</a></li>
<li><a href="../fr466329/index.html">Carte √©lectronique de la vinification en Russie. Conception et contenu</a></li>
<li><a href="../fr466333/index.html">Comment organiser un lieu de travail pour vous</a></li>
<li><a href="../fr466335/index.html">Cr√©ation d'une application Slack √† l'aide des fonctionnalit√©s 8base</a></li>
<li><a href="../fr466339/index.html">Comment dans Microsoft SQL Server pour obtenir des donn√©es de Google Analytics en utilisant R</a></li>
<li><a href="../fr466341/index.html">Formation Cisco 200-125 CCNA v3.0. Jour 33. Pr√©paration √† l'examen ICND1</a></li>
<li><a href="../fr466345/index.html">M√©thode d'onde de construction d'un jeu de couleurs</a></li>
<li><a href="../fr466347/index.html">Formation Cisco 200-125 CCNA v3.0. Jour 34. Concept VLAN avanc√©</a></li>
<li><a href="../fr466349/index.html">Comment effectuer des tests A / B dans 15 000 magasins hors ligne</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>