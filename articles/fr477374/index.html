<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üèº üë©üèæ‚Äçüöí üéÖüèº Machines Z √† fuzzing üå≤ ü§ûüèª ‚õπüèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Machines Z √† fuzzing 
 Jouer √† des jeux d'aventure texte est un pur plaisir, mais le plaisir est assez consommateur de cerveau. Mais aujourd'hui, nous...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Machines Z √† fuzzing</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/477374/"><h1>  <a href="https://8bitworkshop.com/blog/misc/fuzzing-the-z-machine.md.html">Machines Z √† fuzzing</a> </h1><br>  Jouer √† des jeux d'aventure texte est un pur plaisir, mais le plaisir est assez consommateur de cerveau.  Mais aujourd'hui, nous avons toutes ces capacit√©s de processeur inactives. <br><br>  Que se passe-t-il si nous faisons passer l'ordinateur par le jeu par nous-m√™mes et que nous devons simplement nous pencher en arri√®re sur la chaise et regarder?  Nous n'avons m√™me pas besoin de tous ces r√©seaux de neurones de nouvelle g√©n√©ration, plut√¥t d'une simple force brute. <br><br>  Nous d√©posons juste un tas de texte semi-al√©atoire √† l'entr√©e du jeu de texte et voyons ce qui se passe.  Dans le monde de la s√©curit√© de l'information, on parle de fuzzing. <br><br>  L'objectif sera la Z-Machine, un interpr√®te de machine virtuelle d√©velopp√© par Joel Berez et Mark Blanck en 1979, au c≈ìur des Jeux Infocom.  C'est une cible id√©ale pour le fuzzing d'aventure, car il est bien document√© et dispose de nombreux outils et biblioth√®ques de support. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/883/408/615/883408615f5e4ed5964aef089ba74a5d.jpg" title="Lancement de Zork sur l'Atari 800XL (Sebastian Grunwald, CC 3.0)"><br><br>  <em>Lancement de Zork sur l'Atari 800XL (Sebastian Grunwald, CC 3.0)</em> <br><br><h1>  Mini Zork </h1><br>  Le jeu que nous allons <em>jouer</em> - <em>MINI-ZORK-1: The Great Underground Empire</em> .  Il s'agit d'une version de d√©monstration du premier Zorka d'Infokomovsky, con√ßue pour d√©marrer √† partir d'une cassette et non √† partir d'une disquette.  Il s‚Äôagissait essentiellement d‚Äôune publicit√© publi√©e dans le suppl√©ment des ann√©es 1990 au magazine britannique des utilisateurs de Commodore, <strong>Zzap! 64</strong> . <br><br>  Pour ceux qui n'ont pas jou√© √† Zork, voici ce que vous voyez apr√®s avoir charg√© le jeu: <br><a name="habracut"></a><br><pre><code class="plaintext hljs">MINI-ZORK I: The Great Underground Empire Copyright (c) 1988 Infocom, Inc. All rights reserved. ZORK is a registered trademark of Infocom, Inc. Release 34 / Serial number 871124 West of House You are standing in an open field west of a white house, with a boarded front door. You could circle the house to the north or south. There is a small mailbox here. &gt;</code> </pre> <br>  Astuce&gt; invite l'utilisateur √† entrer des commandes comme OPEN MAILBOX ou GO NORTH pour avancer dans le jeu.  Le but est de ¬´trouver les tr√©sors du Grand Empire Souterrain et de les collecter dans votre bo√Æte √† butin¬ª tout en r√©solvant des √©nigmes et en plongeant les ennemis. <br><br><h1>  Jouons √† la chasse aux verbes (et aux noms) </h1><br>  Le guide de l'utilisateur complet avec Zork donne des exemples de commandes possibles, telles que OUVRIR LA PORTE EN BOIS et WARLOCK, PRENDRE LE SORTIE D√âFILER PUIS SUIVEZ-MOI.  Cependant, les utilisateurs devaient deviner ind√©pendamment comment r√©soudre une √©nigme particuli√®re. <br><br>  Les verbes tels que GET et DROP (GET / DROP) sont assez √©vidents, tout comme les huit points cardinaux standard et haut / bas (UP / DOWN), et en m√™me temps in and out (IN / OUT).  Mais les utilisateurs devaient √©galement utiliser ATTACK, POOL et PRAY, ainsi que prononcer des mots magiques qui n'√©taient pas dans le manuel.  La situation o√π le jeu ne donnait pas suffisamment d'indices aux joueurs, ils appelaient moqueusement la ¬´chasse aux verbes¬ª. <br><br>  Pour g√©n√©rer des commandes, fuzzer aura besoin d'une liste de mots accept√©s par le jeu, son vocabulaire.  La Z-machine s√©lectionne cette liste comme dictionnaire de jeu (elle se trouve √† un emplacement standard dans le fichier de chaque jeu). <br><br>  (C'est une sorte d'arnaque, oui! Mais il n'y a vraiment pas d'autre moyen d'expliquer √† l'ordinateur quels mots utiliser, car certains verbes ne sont mentionn√©s nulle part dans le texte.) <br><br>  La fa√ßon la plus simple de g√©n√©rer des commandes est de prendre au hasard un ou plusieurs mots, dans notre cas, un ou deux.  Nous ne savons pas quels mots sont des verbes et quels noms, donc nous g√©n√©rons beaucoup de commandes √©tranges comme "SEE OOPS" et "DRIVER BELOW". <br><br>  √âvidemment, cela est assez inefficace, car nous devons trier N * N combinaisons (o√π N est la taille du vocabulaire) pour trouver la commande m√™me comme "KILL TROLL". <br><br>  Cependant, nous pouvons tricher un peu.  Nous scannerons tous les mots sur la sortie texte du jeu et choisirons ceux qui se trouvent dans notre dictionnaire.  Et choisissez un mot dans cette liste (au lieu d'un dictionnaire complet).  Par exemple, si nous voyons NORTH, WEST, HOUSE et MAILBOX dans le texte, nous sommes plus susceptibles d'utiliser ces mots. <br><br><h1>  Recherche de marqueurs d'histoire </h1><br>  En donnant simplement des commandes al√©atoires, nous obtenons beaucoup de b√™tises que l'analyseur jurera: <br><br><pre> <code class="plaintext hljs">&gt;about painti [    !] &gt;leathe guideb [   "leathe" ,    .]</code> </pre> <br>  (Les mots de vocabulaire ne d√©passent pas six caract√®res dans la Z-Machine, nous g√©n√©rons donc des mots comme ¬´leathe¬ª.) <br><br>  Cependant, un tel pi√©tinement sur place prendra une √©ternit√©.  Comment d√©terminer quelles voies sont plus prometteuses que d'autres?  Nous chercherons des marqueurs pour promouvoir l'histoire. <br><br>  La Z-Machine poss√®de une instruction PRINT qui imprime du texte sur la console.  Ce sont souvent des fragments de descriptions, comme ¬´Ouest de la maison¬ª et ¬´bouteille bris√©e¬ª.  Nous enregistrerons chacun d'eux comme marqueur. <br><br>  Chaque fois que nous voyons un nouveau marqueur, nous enregistrons le passage actuel - une liste des √©quipes que nous avons ex√©cut√©es dans le jeu en cours. <br><br>  Nous associons cette liste au marqueur actuel, afin que nous puissions (esp√©rons-le) obtenir le m√™me texte dans la sortie apr√®s avoir relu les m√™mes commandes. <br><br>  Chaque lancement du jeu s√©lectionne un marqueur cible sp√©cifique, et donc le passage qui lui est associ√©.  L'algorithme de recherche s√©lectionne les nouveaux marqueurs plus souvent que les anciens. <br><br>  Nous ne rejouerons pas les √©quipes textuellement dans chaque partie, mais nous ajouterons quelques √©quipes al√©atoires et m√©langerons l'ordre.  Lorsque nous verrons un nouveau marqueur, nous augmenterons le param√®tre ¬´succ√®s¬ª, dont la croissance montrera qu'il est possible de changer moins souvent la liste des commandes.  Lorsque ce param√®tre augmente suffisamment, nous marquons ce marqueur comme ¬´stable¬ª, car nous avons un passage pr√©visible qui y m√®ne. <br><br><h1>  Vous cherchez un court chemin </h1><br>  Les fa√ßons dont nous traversons le jeu sont souvent inefficaces.  Voici la liste des commandes qui ont √©t√© utilis√©es pour g√©n√©rer le marqueur ¬´Wheeeeeeeeee !!!!!¬ª: <br><br><pre> <code class="plaintext hljs">curse, art, body gate, incant count, the, the egg, repent, from the, the consum, what, leathe, trap- see, breath here, what intnum, about here, leathe guideb, about, about here, pot, here, see, here about, about, self, here about, mangle, see, rug, the, reply, elvish, say, stilet beetle, say toss, pray, gate about, what bolt, guideb, wooden, say knock, say sit, trail and, here, pray leathe, intnum, one, pray one, jump</code> </pre> <br>  Tout ce que nous devons vraiment faire est d'entrer la derni√®re commande: JUMP (ou DIVE).  Mais l'algorithme de recherche ne sait pas laquelle des commandes pr√©c√©dentes est n√©cessaire pour afficher "Wheeeeeeeeee !!!!!" <br><br>  Nous devons r√©duire le passage - pour les rendre aussi courts que possible.  Lorsque nous voyons un marqueur, nous rempla√ßons le passage associ√© par une liste de commandes plus courte, si possible.  Cela nous am√®ne plus rapidement au marqueur cible, nous donnant plus de mouvements √† exp√©rimenter apr√®s avoir atteint l'objectif. <br><br>  De nombreux marqueurs, tels que "Wheeeeeeeeee !!!!!", ne sont pas int√©ressants, car nous pouvons les r√©aliser en un tour au tout d√©but du jeu.  En r√©duisant leur liste de commandes, nous pourrons √©ventuellement confirmer que c'est le cas, et ainsi les supprimer de la liste des marqueurs cibles potentiels. <br><br><h1>  Plus que des mots </h1><br>  Puisque nous avons un acc√®s direct √† l'√©tat interne de la machine Z, nous pouvons utiliser autre chose que la sortie de texte pour contr√¥ler notre recherche.  Par exemple, nous pouvons corriger lorsqu'un objet s'est d√©plac√© d'une pi√®ce √† l'autre, ou lorsque d'autres propri√©t√©s et indicateurs ont chang√© sur l'objet.  Appelez-le marqueurs VM (marqueurs de machine virtuelle) et corrigez-les en parall√®le avec les marqueurs de texte: <br><br><pre> <code class="plaintext hljs">@mv_30_15  (#30)      #15 @f_176_10_1    "" (10)   ""(#176)</code> </pre> <br>  Nous en avons besoin parce que la sortie de texte ne nous raconte pas toute l'histoire.  Par exemple, en ramassant une √©p√©e ou une lampe, nous atteindrons le m√™me marqueur ¬´Pris¬ª. Et le marqueur VM indiquera √† l'algorithme de recherche quand un nouvel √©tat de la machine virtuelle est atteint, par exemple, lorsqu'un joueur se d√©place dans une nouvelle salle, ou qu'un objet a √©t√© ramass√© ou jet√©. <br><br><h1>  Briser une machine virtuelle </h1><br>  L'enqu√™te sur l'√©tat du jeu est un processus assez lent.  L'une des premi√®res t√¢ches du jeu est de tuer le troll, ce qui ne vous permet pas d'aller plus loin.  Cependant, avant cela, le joueur doit trouver une √©p√©e dans la maison un peu plus haut. <br><br>  Afin d'acc√©l√©rer le processus de recherche, nous allons casser la Z-machine et ramener l'√©tat du jeu √† ce que nous avons vu plus t√¥t.  Par exemple, nous avons accidentellement d√©plac√© une √©p√©e dans la main d‚Äôun joueur, ce qui a permis d‚Äôex√©cuter avec succ√®s la commande ¬´STAB¬ª (stab).  ("ATTACK TROLL" ne fonctionnera que si nous ajoutons "WITH SWORD", mais "STAB" (coup de couteau) implique d√©j√† la pr√©sence d'un objet pointu et fonctionne donc.) <br><br>  Nous ne casserons que des marqueurs stables, donc si nous pouvons r√©p√©ter le jeu de mani√®re fiable et que les mains du joueur se r√©v√®lent √™tre une √©p√©e, nous autoriserons le piratage de cet √©tat: "l'√©p√©e est entre les mains du joueur".  Ensuite, nous pouvons combiner les √©quipes utilis√©es pour lever l'√©p√©e avec les √©quipes utilis√©es pour descendre le donjon, d√©couvrant en cours de route que nous devons attaquer le troll. <br><br>  L'exemple du troll est particuli√®rement j√©suite, car, en r√®gle g√©n√©rale, il faut plusieurs coups pour le terminer, et chaque attaque donne un r√©sultat al√©atoire.  √âtant donn√© que notre algorithme pr√©f√®re les passes plus courtes, il est pr√©f√©rable d'adh√©rer √† une pr√©vision optimiste concernant nos capacit√©s de combat. <br><br>  Apr√®s 530 000 soluces et 10 600 000 √©quipes (200 √©quipes par match), nous avons enfin compris comment attaquer le troll: <br><br><pre> <code class="plaintext hljs">north, east, open window, into, west, light, lift trap, small hi, get, west, light, tug large, lift trap, down, north, stab</code> </pre> <br>  Il y a encore quelques commandes inutiles, et nous ne comprenons toujours pas que nous devons le frapper plusieurs fois, mais nous pouvons le g√©rer. <br><br><h1>  Passe-temps fatal </h1><br>  L'algorithme de recherche ne conna√Æt pas la diff√©rence entre collecter des objets, lancer des objets et d√©placer un joueur d'une pi√®ce √† l'autre.  La seule fa√ßon dont il d√©finit le progr√®s est de voir les marqueurs de l'histoire progresser. <br><br>  Cela d√©veloppe rapidement dans l'algorithme de recherche un go√ªt pour ... le meurtre!  Pour tuer un joueur, en particulier, parce qu'il est si facile et simple: entrez "ATTACK": <br><br><pre> <code class="plaintext hljs">&gt;attack [  ] ,  ! ****   **** , ,     .      ,       .          c-.  ,      .</code> </pre> <br>  Dans Mini Zorka, la premi√®re mort n'est pas la fin du jeu, le joueur se t√©l√©porte vers un autre endroit et vos affaires sont dispers√©es.  Pour un algorithme de recherche, la mort est simplement un objet se d√©pla√ßant d'une pi√®ce √† l'autre, cr√©ant des marqueurs pour d√©placer l'histoire en cours de route.  Ce passe-temps entra√Æne l'exposition d'autres bugs amusants dans le jeu, tels que la capacit√© du joueur √† jeter ses mains dans la rivi√®re. <br><br>  Le jeu marque de 0 √† 350 points, bas√© sur la r√©solution d'√©nigmes et la collecte de tr√©sors.  Lorsqu'un joueur meurt, il est r√©duit de 10 points.  Nous pouvons utiliser le compte comme une heuristique, mais cela peut r√©duire excessivement les comportements √† risque - l'amour d'errer dans des endroits sombres ou de combattre des trolls. <br><br>  L'algorithme de recherche s'int√©resse √©galement vivement √† ce que le joueur ne voit pas, comme les PNJ se d√©pla√ßant entre les pi√®ces.  Par exemple, le marqueur @ mv_112_37 indique le mouvement d'un voleur vers une pi√®ce sp√©cifique.  L'algorithme de recherche parvient √† reproduire ce marqueur en ex√©cutant √† plusieurs reprises des commandes Z ou WAIT, s'attendant essentiellement √† ce que le voleur atteigne la pi√®ce cible. <br><br>  Il aime aussi ramasser et jeter des objets √† diff√©rents endroits, car chaque mouvement de l'objet est un nouveau marqueur.  Qui sait  Peut-√™tre que jeter cette feuille sur un chemin forestier m√®nera √† la victoire dans le jeu!  (Narrateur: non, ce ne sera pas le cas.) <br><br>  Le fuzzing identifie invariablement les erreurs dans le programme, et ce jeu n'est pas diff√©rent, bien qu'il persiste.  Il a compris comment g√©n√©rer le mot ¬´Clrthatrqdc¬ª au tout d√©but du jeu: <br><br><pre> <code class="plaintext hljs">&gt;tie up [  ] With a Clrthatrqdc!?!</code> </pre> <br>  Cela semble √™tre une variable non initialis√©e indiquant des donn√©es non textuelles.  Le codage du texte compress√© dans la machine Z est principalement alphab√©tique, car vous ne voyez pas autant de d√©chets al√©atoires que lorsque vous essayez d'imprimer un fichier binaire en ASCII.  (Actuellement, ce mot <a href="https://www.google.com/search%3Fq%3DClrthatrqdc">n'est que deux fois sur Google</a> ( <em>d√©j√† quatre fois, environ. Trad.</em> ).) <br><br><h1>  Proc√©dure pas √† pas </h1><br>  Pour gagner le jeu, nous devrons ramener nos biens pill√©s dans la bo√Æte √† butin et y fourrer chaque objet.  Notre algorithme de recherche simple mettra beaucoup de temps √† tomber sur ce comportement, en particulier compte tenu de sa tendance √† gaspiller de l'√©nergie et √† d√©placer des objets d'une pi√®ce √† l'autre. <br><br>  La complication d'un algorithme de recherche al√©atoire prend du temps, nous devons donc √™tre s√©lectifs lors de l'ajout de nouvelles fonctionnalit√©s.  Nous voulons √©galement √©viter les connaissances a priori dans le jeu - en d'autres termes, nous voulons seulement tricher un peu. <br><br>  Si vous voulez exp√©rimenter, <a href="">consultez le code source sur GitHub</a> , qui utilise <a href="https://github.com/DLehenbauer/jszm">JSZM</a> (l'interpr√©teur de Z-Machine Daniel Legenbauer). De nombreux <a href="http://www.ifarchive.org/indexes/if-archiveXgamesXzcode.html">jeux sont disponibles</a> (seules les versions jusqu'√† 3 sont prises en charge.) <br><br>  Le document Graham Nelson <a href="https://www.inform-fiction.org/zmachine/standards/z1point1/index.html">Z-Machine Standards</a> , qui traite de la machine Z depuis deux d√©cennies, est √©galement disponible. <br><br>  Et dois-je ajouter le support Z-Machine sur <a href="https://8bitworkshop.com/">8bitworkshop</a> ?  Faites le moi savoir! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr477374/">https://habr.com/ru/post/fr477374/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr477362/index.html">Plus qu'un anti-spam: comment tirer le meilleur parti de votre passerelle de messagerie √©lectronique de s√©curit√©</a></li>
<li><a href="../fr477364/index.html">Comment devenir d√©veloppeur Java? Ou peut-√™tre choisir Python?</a></li>
<li><a href="../fr477366/index.html">Cinq questions sur la conception de langages de programmation</a></li>
<li><a href="../fr477370/index.html">PHP sans serveur</a></li>
<li><a href="../fr477372/index.html">Amazon perd la guerre contre les contrefa√ßons</a></li>
<li><a href="../fr477378/index.html">Agile mixte - approche Waterfall lors de la mise en ≈ìuvre d'applications m√©tier (aka Agile-like)</a></li>
<li><a href="../fr477382/index.html">Esports - faire du profit: Mercedes, m√©gaphone, paris et image de marque pour les esports</a></li>
<li><a href="../fr477384/index.html">Conf√©rence ¬´S√©curit√© de l'information. Menaces du pr√©sent et du futur ¬ª</a></li>
<li><a href="../fr477386/index.html">Semaine de s√©curit√© 48: fuite de donn√©es gigantesque et vuln√©rabilit√© dans Whatsapp</a></li>
<li><a href="../fr477388/index.html">NILFS2 - syst√®me de fichiers pare-balles pour / home</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>