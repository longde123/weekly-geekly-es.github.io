<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ…¿ï¸ ğŸš´ğŸ¿ â• ä½¿ç”¨Joiè¿›è¡ŒTypeScriptæ¥å£éªŒè¯ ğŸ›¸ ğŸ‘¦ğŸ» ğŸ“›</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="å¦‚ä½•èŠ±ä¸¤å¤©æ—¶é—´å¤šæ¬¡é‡å†™åŒä¸€ä»£ç çš„æ•…äº‹ã€‚ 



 å‚èµ›ä½œå“ 


åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†çœç•¥æœ‰å…³Hapiï¼ŒJoiï¼Œè·¯ç”±å’Œvalidate: { payload: ... }è¯¦ç»†ä¿¡æ¯validate: { payload: ... } ï¼Œè¿™æ„å‘³ç€æ‚¨å·²ç»äº†è§£å®ƒçš„å«ä¹‰ä»¥åŠæœ¯è¯­ï¼Œä¾‹å¦‚â€œæ¥å£â€ï¼Œâ€œç±»å‹â€ç­‰ã€‚ ã€‚ åœ¨è¿™...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ä½¿ç”¨Joiè¿›è¡ŒTypeScriptæ¥å£éªŒè¯</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/450238/"><p> å¦‚ä½•èŠ±ä¸¤å¤©æ—¶é—´å¤šæ¬¡é‡å†™åŒä¸€ä»£ç çš„æ•…äº‹ã€‚ </p><br><p><img src="https://habrastorage.org/webt/kv/do/eq/kvdoeq2qi2shhsd1gtl76hjorvs.png" alt="Joi &amp; TypeScript. A love story" title="Joiå’ŒTypeScriptã€‚ä¸€ä¸ªçˆ±æƒ…æ•…äº‹"></p><a name="habracut"></a><br><h1 id="vstuplenie"> å‚èµ›ä½œå“ </h1><br><p>åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†çœç•¥æœ‰å…³Hapiï¼ŒJoiï¼Œè·¯ç”±å’Œ<code>validate: { payload: ... }</code>è¯¦ç»†ä¿¡æ¯<code>validate: { payload: ... }</code> ï¼Œè¿™æ„å‘³ç€æ‚¨å·²ç»äº†è§£å®ƒçš„å«ä¹‰ä»¥åŠæœ¯è¯­ï¼Œä¾‹å¦‚â€œæ¥å£â€ï¼Œâ€œç±»å‹â€ç­‰ã€‚ ã€‚ åœ¨è¿™äº›æ–¹é¢çš„è®­ç»ƒï¼Œæˆ‘åªä¼šå‘Šè¯‰æ‚¨ä¸€ä¸ªå›åˆåˆ¶ç­–ç•¥ï¼Œè€Œä¸æ˜¯æœ€æˆåŠŸçš„ç­–ç•¥ã€‚ </p><br><h2 id="nemnogo-predystorii"> ä¸€ç‚¹èƒŒæ™¯ </h2><br><p> ç°åœ¨ï¼Œæˆ‘æ˜¯è¯¥é¡¹ç›®ä¸Šå”¯ä¸€çš„åç«¯å¼€å‘äººå‘˜ï¼ˆå³ï¼Œç¼–å†™ä»£ç ï¼‰ã€‚ åŠŸèƒ½ä¸æ˜¯æœ¬è´¨ï¼Œä½†æ˜¯å…³é”®æœ¬è´¨æ˜¯å¯¹ä¸ªäººæ•°æ®çš„è¾ƒé•¿æè¿°ã€‚ ä»£ç çš„é€Ÿåº¦å’Œè´¨é‡æ˜¯åŸºäºæˆ‘å¾ˆå°‘ä»å¤´å¼€å§‹ç‹¬ç«‹å¤„ç†é¡¹ç›®çš„ç»éªŒï¼Œç”šè‡³æ²¡æœ‰ä½¿ç”¨JSçš„ç»éªŒï¼ˆä»…ç¬¬4ä¸ªæœˆï¼‰ï¼Œå¹¶ä¸”ä¸€è·¯èµ°æ¥éå¸¸æ­ªæ–œï¼Œæˆ‘æ˜¯ç”¨TypeScriptç¼–å†™çš„ï¼ˆä»¥ä¸‹ç®€ç§°TSï¼‰ã€‚ æ—¥æœŸè¢«å‹ç¼©ï¼Œæ»šåŠ¨è¢«å‹ç¼©ï¼Œç¼–è¾‘ä¸æ–­åˆ°è¾¾ï¼Œç»“æœè¯æ˜é¦–å…ˆè¦ç¼–å†™ä¸šåŠ¡é€»è¾‘ä»£ç ï¼Œç„¶åæ˜¯æœ€ä¸Šé¢çš„æ¥å£ã€‚ ç„¶è€Œï¼ŒæŠ€æœ¯è´£ä»»èƒ½å¤Ÿèµ¶ä¸Šå¹¶æ•²å‡»ç“¶ç›–ï¼Œè¿™å¤§çº¦å‘ç”Ÿåœ¨æˆ‘ä»¬èº«ä¸Šã€‚ </p><br><p> åœ¨è¿›è¡Œäº†3ä¸ªæœˆçš„é¡¹ç›®å·¥ä½œåï¼Œæˆ‘ç»ˆäºä¸åŒäº‹ä»¬åŒæ„åˆ‡æ¢åˆ°å•ä¸ªè¯å…¸ï¼Œä»¥ä¾¿è¯¥å¯¹è±¡çš„å±æ€§åœ¨ä»»ä½•åœ°æ–¹éƒ½è¢«å‘½åå’Œç¼–å†™ç›¸åŒçš„å†…å®¹ã€‚ å½“ç„¶ï¼Œåœ¨è¿™é¡¹å·¥ä½œä¸‹ï¼Œæˆ‘æ‰¿è¯ºç¼–å†™ä¸€ä¸ªç•Œé¢ï¼Œå¹¶ç´§ç´§åœ°åšæŒäº†ä¸¤ä¸ªå·¥ä½œæ—¥ã€‚ </p><br><h1 id="problema"> é—®é¢˜ </h1><br><p> ä¸€ä¸ªç®€å•çš„ç”¨æˆ·é…ç½®æ–‡ä»¶å°†æ˜¯ä¸€ä¸ªæŠ½è±¡ç¤ºä¾‹ã€‚ </p><br><ul><li><del>  <strong>é¦–å…ˆ</strong> </del>  <strong>ä¼˜ç§€å¼€å‘äººå‘˜çš„é›¶æ­¥éª¤ï¼š</strong> <del> æè¿°æ•°æ® </del> ç¼–å†™æµ‹è¯•ï¼› </li><li>  <strong>ç¬¬ä¸€æ­¥ï¼š</strong> <del> ç¼–å†™æµ‹è¯• </del> æè¿°æ•°æ® </li><li> ç­‰ç­‰ã€‚ </li></ul><br><p> å‡è®¾å·²ç»ä¸ºè¯¥ä»£ç ç¼–å†™äº†æµ‹è¯•ï¼Œä½†ä»ç„¶éœ€è¦æè¿°æ•°æ®ï¼š </p><br><pre> <code class="javascript hljs">interface IUser { <span class="hljs-attr"><span class="hljs-attr">name</span></span>: string; age: number; phone: string | number; } <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> aleg: IUser = { <span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">'Aleg'</span></span>, <span class="hljs-attr"><span class="hljs-attr">age</span></span>: <span class="hljs-number"><span class="hljs-number">45</span></span>, <span class="hljs-attr"><span class="hljs-attr">phone</span></span>: <span class="hljs-string"><span class="hljs-string">'79001231212'</span></span> };</code> </pre> <br><p> å¥½å§ï¼Œè¿™é‡Œçš„æ‰€æœ‰å†…å®¹éƒ½å¾ˆæ¸…æ¥šè€Œä¸”éå¸¸ç®€å•ã€‚ æˆ‘ä»¬è®°å¾—ï¼Œæ‰€æœ‰è¿™äº›ä»£ç éƒ½æ˜¯åœ¨åç«¯ï¼Œæˆ–è€…åœ¨apiä¸­ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œç”¨æˆ·æ˜¯åŸºäºç½‘ç»œä¸Šçš„æ•°æ®åˆ›å»ºçš„ã€‚ å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦éªŒè¯ä¼ å…¥çš„æ•°æ®å¹¶åœ¨ä»¥ä¸‹æ–¹é¢å¸®åŠ©Joiï¼š </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> joiUserValidator = { <span class="hljs-attr"><span class="hljs-attr">name</span></span>: Joi.string(), <span class="hljs-attr"><span class="hljs-attr">age</span></span>: Joi.number(), <span class="hljs-attr"><span class="hljs-attr">phone</span></span>: Joi.alternatives([Joi.string(), Joi.number()]) };</code> </pre> <br><p> è§£å†³æ–¹æ¡ˆâ€œåœ¨é¢å¤´ä¸Šâ€å·²å‡†å¤‡å°±ç»ªã€‚ è¿™ç§æ–¹æ³•çš„æ˜æ˜¾ç¼ºç‚¹æ˜¯éªŒè¯å™¨ä¸æ¥å£å®Œå…¨åˆ†ç¦»ã€‚ å¦‚æœåœ¨åº”ç”¨ç¨‹åºçš„ç”Ÿå‘½å‘¨æœŸä¸­å­—æ®µæ›´æ”¹/æ·»åŠ æˆ–å­—æ®µç±»å‹æ›´æ”¹ï¼Œåˆ™éœ€è¦æ‰‹åŠ¨è·Ÿè¸ªæ­¤æ›´æ”¹å¹¶åœ¨éªŒè¯å™¨ä¸­æŒ‡å‡ºã€‚ æˆ‘è®¤ä¸ºï¼Œé™¤éæœ‰ä»»ä½•é—®é¢˜ï¼Œå¦åˆ™ä¸ä¼šæœ‰è¿™æ ·è´Ÿè´£ä»»çš„å¼€å‘äººå‘˜ã€‚ æ­¤å¤–ï¼Œåœ¨æˆ‘ä»¬çš„é¡¹ç›®ä¸­ï¼Œè°ƒæŸ¥é—®å·ç”±ä¸‰ä¸ªåµŒå¥—çº§åˆ«çš„50å¤šä¸ªå­—æ®µç»„æˆï¼Œè¦äº†è§£è¿™ä¸€ç‚¹éå¸¸å›°éš¾ï¼Œå³ä½¿æ˜¯å…¨å¿ƒå…¨æ„åœ°äº†è§£ã€‚ </p><br><p> æˆ‘ä»¬æ ¹æœ¬æ— æ³•æŒ‡å®š<code>const joiUserValidator: IUser</code> ï¼Œå› ä¸º<code>Joi</code>ä½¿ç”¨å…¶æ•°æ®ç±»å‹ï¼Œå½“ç¼–è¯‘ç±»å‹<code>Type 'NumberSchema' is not assignable to type 'number'</code>ç±»å‹æ—¶ï¼Œå®ƒä¼šäº§ç”Ÿé”™è¯¯ã€‚ ä½†æ˜¯å¿…é¡»æœ‰ä¸€ç§åœ¨æ¥å£ä¸Šæ‰§è¡ŒéªŒè¯çš„æ–¹æ³•å—ï¼Ÿ <br><img src="https://habrastorage.org/getpro/habr/post_images/c86/32b/ef0/c8632bef03e0bc08cb00b9040e05dd8c.jpg" alt="      " title="æˆ‘ä¸Šç½‘é—®äº†è¿™ä¸ªé—®é¢˜"></p><br><p> ä¹Ÿè®¸æˆ‘æ²¡æœ‰æ­£ç¡®æœç´¢å®ƒï¼Œæˆ–è€…å¯¹ç­”æ¡ˆçš„ç ”ç©¶ä¸åŠ›ï¼Œä½†æ˜¯æ‰€æœ‰çš„å†³å®šéƒ½<code>extractTypes</code>äº<code>extractTypes</code>å’ŒæŸç§å‡¶çŒ›çš„è‡ªè¡Œè½¦ï¼Œä¾‹å¦‚ï¼š </p><br><pre> <code class="javascript hljs">type ValidatedValueType&lt;T extends joi.Schema&gt; = T extends joi.StringSchema ? string : T extends joi.NumberSchema ? number : T extends joi.BooleanSchema ? boolean : T extends joi.ObjectSchema ? ValidatedObjectType&lt;T&gt; : <span class="hljs-comment"><span class="hljs-comment">/* ... more schemata ... */</span></span> never;</code> </pre> <br><h1 id="reshenie"> è§£å†³æ–¹æ¡ˆ </h1><br><h2 id="ispolzovat-storonnie-biblioteki"> ä½¿ç”¨ç¬¬ä¸‰æ–¹åº“ </h2><br><p> ä¸ºä»€ä¹ˆä¸å‘¢ å½“æˆ‘å‘äººä»¬è¯¢é—®æˆ‘çš„ä»»åŠ¡æ—¶ï¼Œæˆ‘æ”¶åˆ°äº†ä¸€ä¸ªç­”æ¡ˆï¼Œåæ¥åˆåœ¨è¿™é‡Œçš„è¯„è®ºä¸­ï¼ˆæ„Ÿè°¢<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" class="user_link">keenondrums</a> ï¼‰é“¾æ¥åˆ°è¿™äº›åº“ï¼š <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">https://github.com/typestack/class-validator</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">https://github.com/typestack/class-transformer</a> </p><br><p> ä½†æ˜¯ï¼Œæœ‰å…´è¶£è‡ªå·±å¼„æ¸…æ¥šï¼Œä»¥æ›´å¥½åœ°ç†è§£TSçš„å·¥ä½œï¼Œå¹¶ä¸”æ²¡æœ‰äººæ•¦ä¿ƒç«‹å³è§£å†³é—®é¢˜ã€‚ </p><br><h2 id="poluchit-vse-svoystva"> è·å–æ‰€æœ‰å±æ€§ </h2><br><p> ç”±äºæˆ‘ä»¥å‰æ²¡æœ‰ä½¿ç”¨è¿‡é™æ€å‡½æ•°ï¼Œå› æ­¤ä»¥ä¸Šä»£ç åœ¨ç±»å‹ä¸­ä½¿ç”¨ä¸‰å…ƒè¿ç®—ç¬¦æ–¹é¢å‘ç°äº†Americaã€‚ å¹¸è¿çš„æ˜¯ï¼Œä¸å¯èƒ½å°†å…¶åº”ç”¨åˆ°é¡¹ç›®ä¸­ã€‚ ä½†æ˜¯æˆ‘å‘ç°äº†å¦ä¸€è¾†æœ‰è¶£çš„è‡ªè¡Œè½¦ï¼š </p><br><pre> <code class="javascript hljs">interface IUser { <span class="hljs-attr"><span class="hljs-attr">name</span></span>: string; age: number; phone: string | number; } type UserKeys&lt;T&gt; = { [key <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> keyof T]; } <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> evan: UserKeys&lt;IUser&gt; = { <span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">'Evan'</span></span>, <span class="hljs-attr"><span class="hljs-attr">age</span></span>: <span class="hljs-number"><span class="hljs-number">32</span></span>, <span class="hljs-attr"><span class="hljs-attr">phone</span></span>: <span class="hljs-number"><span class="hljs-number">791234567890</span></span> }; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> joiUser: UserKeys&lt;IUser&gt; = { <span class="hljs-attr"><span class="hljs-attr">name</span></span>: Joi.string(), <span class="hljs-attr"><span class="hljs-attr">age</span></span>: Joi.number(), <span class="hljs-attr"><span class="hljs-attr">phone</span></span>: Joi.alternatives([Joi.string(), Joi.number()]) };</code> </pre> <br><p> åœ¨ç›¸å½“æ£˜æ‰‹å’Œç¥ç§˜çš„æ¡ä»¶ä¸‹ï¼Œ <code>TypeScript</code>å…è®¸æ‚¨ä»æ¥å£ä¸­è·å–é”®ï¼Œå°±å¥½åƒå®ƒæ˜¯æ™®é€šçš„JSå¯¹è±¡ä¸€æ ·ï¼Œä½†æ˜¯ï¼Œåªèƒ½åœ¨<code>type</code>æ„é€ ä¸­ä»¥åŠé€šè¿‡<code>key in keyof T</code>ä»¥åŠä»…é€šè¿‡æ³›å‹æ¥è·å–ã€‚ ä½œä¸º<code>UserKeys</code>ç±»å‹çš„ç»“æœï¼Œå®ç°æ¥å£çš„æ‰€æœ‰å¯¹è±¡åº”å…·æœ‰ç›¸åŒçš„å±æ€§é›†ï¼Œä½†æ˜¯å€¼çš„ç±»å‹å¯ä»¥æ˜¯ä»»æ„çš„ã€‚ è¿™åŒ…æ‹¬IDEä¸­çš„æç¤ºï¼Œä½†ä»æœªæ˜ç¡®æŒ‡ç¤ºå€¼çš„ç±»å‹ã€‚ </p><br><p> è¿™æ˜¯å¦ä¸€ä¸ªæˆ‘æ— æ³•ä½¿ç”¨çš„æœ‰è¶£æ¡ˆä¾‹ã€‚ ä¹Ÿè®¸æ‚¨å¯ä»¥å‘Šè¯‰æˆ‘ä¸ºä»€ä¹ˆè¿™æ ·åšæ˜¯æœ‰å¿…è¦çš„ï¼ˆå°½ç®¡æˆ‘éƒ¨åˆ†çŒœæµ‹ï¼Œä½†æ˜¯æ²¡æœ‰è¶³å¤Ÿçš„åº”ç”¨ç¤ºä¾‹ï¼‰ï¼š </p><br><pre> <code class="javascript hljs">interface IUser { <span class="hljs-attr"><span class="hljs-attr">name</span></span>: string; age: number; phone: string | number; } interface IUserJoi { <span class="hljs-attr"><span class="hljs-attr">name</span></span>: Joi.StringSchema, <span class="hljs-attr"><span class="hljs-attr">age</span></span>: Joi.NumberSchema, <span class="hljs-attr"><span class="hljs-attr">phone</span></span>: Joi.AlternativesSchema } type UserKeys&lt;T&gt; = { [key <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> keyof T]: T[key]; } <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> evan: UserKeys&lt;IUser&gt; = { <span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">'Evan'</span></span>, <span class="hljs-attr"><span class="hljs-attr">age</span></span>: <span class="hljs-number"><span class="hljs-number">32</span></span>, <span class="hljs-attr"><span class="hljs-attr">phone</span></span>: <span class="hljs-number"><span class="hljs-number">791234567890</span></span> }; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> userJoiValidator: UserKeys&lt;IUserJoi&gt; = { <span class="hljs-attr"><span class="hljs-attr">name</span></span>: Joi.string(), <span class="hljs-attr"><span class="hljs-attr">age</span></span>: Joi.number(), <span class="hljs-attr"><span class="hljs-attr">phone</span></span>: Joi.alternatives([Joi.string(), Joi.number()]) };</code> </pre> <br><h2 id="ispolzovat-variativnye-tipy"> ä½¿ç”¨å˜é‡ç±»å‹ </h2><br><p> æ‚¨å¯ä»¥æ˜¾å¼è®¾ç½®ç±»å‹ï¼Œå¹¶ä½¿ç”¨â€œ ORâ€å¹¶æå–å±æ€§ï¼Œä»¥è·å–æœ¬åœ°å·¥ä½œä»£ç ï¼š </p><br><pre> <code class="javascript hljs">type TString = string | Joi.StringSchema; type TNumber = number | Joi.NumberSchema; type TStdAlter = TString | TNumber; type TAlter = TStdAlter | Joi.AlternativesSchema; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> interface IUser { <span class="hljs-attr"><span class="hljs-attr">name</span></span>: TString; age: TNumber; phone: TAlter; } type UserKeys&lt;T&gt; = { [key <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> keyof T]; } <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> olex: UserKeys&lt;IUser&gt; = { <span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">'Olex'</span></span>, <span class="hljs-attr"><span class="hljs-attr">age</span></span>: <span class="hljs-number"><span class="hljs-number">67</span></span>, <span class="hljs-attr"><span class="hljs-attr">phone</span></span>: <span class="hljs-string"><span class="hljs-string">'79998887766'</span></span> }; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> joiUser: UserKeys&lt;IUser&gt; = { <span class="hljs-attr"><span class="hljs-attr">name</span></span>: Joi.string(), <span class="hljs-attr"><span class="hljs-attr">age</span></span>: Joi.number(), <span class="hljs-attr"><span class="hljs-attr">phone</span></span>: Joi.alternatives([Joi.string(), Joi.number()]) };</code> </pre> <br><p> å½“æˆ‘ä»¬æƒ³ä»æ•°æ®åº“ä¸­æ‹¾å–æœ‰æ•ˆå¯¹è±¡æ—¶ï¼Œå°±ä¼šå‡ºç°æ­¤ä»£ç çš„é—®é¢˜ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼ŒTSäº‹å…ˆä¸çŸ¥é“å“ªç§ç±»å‹çš„æ•°æ®å°†æ˜¯ç®€å•æ•°æ®è¿˜æ˜¯Joiã€‚ å°è¯•åœ¨æœŸæœ›ä¸º<code>number</code>çš„å­—æ®µä¸Šæ‰§è¡Œæ•°å­¦è¿ç®—æ—¶ï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´é”™è¯¯ï¼š </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> someUser: IUser = getUserFromDB({ <span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">'Aleg'</span></span> }); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> someWeirdMath = someUser.age % <span class="hljs-number"><span class="hljs-number">10</span></span>; <span class="hljs-comment"><span class="hljs-comment">// error TS2362: The left-hand side of an arithmetic operation must be of type'any', 'number', 'bigint' or an enum type</span></span></code> </pre> <br><p> æ­¤é”™è¯¯æ¥è‡ª<code>Joi.NumberSchema</code>å› ä¸ºageä¸ä»…å¯ä»¥æ˜¯<code>number</code> ã€‚ ä»–ä»¬ä¸ºä¹‹å¥‹æ–—å¹¶é‡åˆ°çš„ã€‚ </p><br><h2 id="soedinit-dva-resheniya-v-odno"> å°†ä¸¤ç§è§£å†³æ–¹æ¡ˆåˆäºŒä¸ºä¸€å—ï¼Ÿ </h2><br><p> åœ¨è¿™ä¸€ç‚¹ä¸Šï¼Œå·¥ä½œæ—¥æ­£åœ¨æ¥è¿‘å…¶é€»è¾‘ç»“è®ºã€‚ æˆ‘å±ä½å‘¼å¸ï¼Œå–äº†å’–å•¡ï¼ŒæŠ¹å»äº†ä»–å¦ˆçš„ã€‚ æœ‰å¿…è¦å°‘è¯»è¿™äº›ä¹¦ï¼Œä»¥å‡å°‘æ‚¨çš„äº’è”ç½‘ï¼ æ—¶é—´åˆ°äº† <del>  aå¼¹æª </del> æ´—è„‘ï¼š </p><br><ol><li> ä¸€ä¸ªå¯¹è±¡å¿…é¡»ç”±æ˜¾å¼çš„å€¼ç±»å‹ç»„æˆã€‚ </li><li> æ‚¨å¯ä»¥ä½¿ç”¨æ³›å‹å°†ç±»å‹æ”¾å…¥å•ä¸ªæ¥å£ä¸­ã€‚ </li><li> æ³›å‹æ”¯æŒé»˜è®¤ç±»å‹ï¼› </li><li>  <code>type</code>æ„é€ æ˜¾ç„¶å…·æœ‰å…¶ä»–åŠŸèƒ½ã€‚ </li></ol><br><p> æˆ‘ä»¬ä½¿ç”¨é»˜è®¤ç±»å‹ç¼–å†™é€šç”¨æ¥å£ï¼š </p><br><pre> <code class="javascript hljs">interface IUser &lt; TName = string, TAge = number, TAlt = string | number &gt; { <span class="hljs-attr"><span class="hljs-attr">name</span></span>: TName; age: TAge; phone: TAlt; }</code> </pre> <br><p> å¯¹äºJoiï¼Œæ‚¨å¯ä»¥åˆ›å»ºç¬¬äºŒä¸ªæ¥å£ï¼Œä»¥è¿™ç§æ–¹å¼ç»§æ‰¿ä¸»è¦æ¥å£ï¼š </p><br><pre> <code class="javascript hljs">interface IUserJoi extends IUser &lt; Joi.StringSchema, Joi.NumberSchema, Joi.AlternativesSchema &gt; {}</code> </pre> <br><p> è¿™è¿˜ä¸å¤Ÿå¥½ï¼Œå› ä¸ºä¸‹ä¸€ä¸ªå¼€å‘äººå‘˜å¯ä»¥è½»æ¾åœ°æ‰©å±•<code>IUserJoi</code>æˆ–æ›´ç³Ÿã€‚ ä¸€ä¸ªæ›´æœ‰é™çš„é€‰æ‹©æ˜¯è·å¾—ç±»ä¼¼çš„è¡Œä¸ºï¼š </p><br><pre> <code class="javascript hljs">type IUserJoi = IUser&lt;Joi.StringSchema, Joi.NumberSchema, Joi.AlternativesSchema&gt;;</code> </pre> <br><p> æˆ‘ä»¬å°è¯•ï¼š </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> aleg: IUser = { <span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">'Aleg'</span></span>, <span class="hljs-attr"><span class="hljs-attr">age</span></span>: <span class="hljs-number"><span class="hljs-number">45</span></span>, <span class="hljs-attr"><span class="hljs-attr">phone</span></span>: <span class="hljs-string"><span class="hljs-string">'79001231212'</span></span> }; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> joiUser: IUserJoi = { <span class="hljs-attr"><span class="hljs-attr">name</span></span>: Joi.string(), <span class="hljs-attr"><span class="hljs-attr">age</span></span>: Joi.number(), <span class="hljs-attr"><span class="hljs-attr">phone</span></span>: Joi.alternatives([Joi.string(), Joi.number()]) };</code> </pre> <br><p>  <strong>UPDï¼š</strong> <br> è¦ç»“æŸåœ¨<code>Joi.object</code>æˆ‘å¿…é¡»è§£å†³é”™è¯¯<code>TS2345</code> ï¼Œå¹¶ä¸”æœ€ç®€å•çš„è§£å†³æ–¹æ¡ˆæ˜¯<code>as any</code> ã€‚ æˆ‘è®¤ä¸ºè¿™ä¸æ˜¯ä¸€ä¸ªå…³é”®çš„å‡è®¾ï¼Œå› ä¸ºä¸Šè¿°å¯¹è±¡ä»åœ¨ç•Œé¢ä¸Šã€‚ </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> joiUserInfo = { <span class="hljs-attr"><span class="hljs-attr">info</span></span>: Joi.object(joiUser <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> any).required() };</code> </pre> <br><p> å®ƒå¯ä»¥ç¼–è¯‘ï¼Œåœ¨ä½¿ç”¨ä½ç½®çœ‹èµ·æ¥å¾ˆæ•´æ´ï¼Œå¹¶ä¸”åœ¨æ²¡æœ‰ç‰¹æ®Šæ¡ä»¶çš„æƒ…å†µä¸‹å§‹ç»ˆä¼šè®¾ç½®é»˜è®¤ç±»å‹ï¼ ç¾å¥³... <br><img src="https://habrastorage.org/getpro/habr/post_images/f8c/4c4/96b/f8c4c496b545e0d6bd4a249feda9095f.jpg" alt="-" title="æ‚²ä¼¤çš„éº»çƒ¦"><br>  ...æˆ‘èŠ±äº†ä¸¤ä¸ªå·¥ä½œæ—¥ </p><br><h1 id="rezyumirovanie"> æ€»ç»“ </h1><br><p>  <strong>ä»è¿™ä¸€åˆ‡å¯ä»¥å¾—å‡ºä»€ä¹ˆç»“è®ºï¼š</strong> </p><br><ol><li> æ˜¾ç„¶ï¼Œæˆ‘æ²¡æœ‰å­¦ä¹ å¦‚ä½•æ‰¾åˆ°é—®é¢˜çš„ç­”æ¡ˆã€‚ å½“ç„¶ï¼Œæœ‰äº†æˆåŠŸçš„è¯·æ±‚ï¼Œæ­¤è§£å†³æ–¹æ¡ˆï¼ˆç”šè‡³æ›´å¥½ï¼‰å°†å‡ºç°åœ¨æœç´¢å¼•æ“çš„å‰5ké“¾æ¥ä¸­ï¼› </li><li> ä»åŠ¨æ€è½¬å˜ä¸ºé™æ€æ€ç»´å¹¶éæ˜“äº‹ï¼Œæ›´å¤šçš„æ˜¯ï¼Œæˆ‘åªæ˜¯å¯¹è¿™ç§èœ‚æ‹¥è€Œè‡³ã€‚ </li><li> æ³›å‹å¾ˆé…·ã€‚ åœ¨Habrå’Œstackoverflowå·²æ»¡ <del> è‡ªè¡Œè½¦ </del> åœ¨è¿è¡Œæ—¶ä¹‹å¤–æ„å»ºå¼ºç±»å‹çš„éæ˜¾è€Œæ˜“è§çš„è§£å†³æ–¹æ¡ˆã€‚ </li></ol><br><p>  <strong>æˆ‘ä»¬èµ¢äº†ï¼š</strong> </p><br><ol><li> æ›´æ”¹æ¥å£æ—¶ï¼ŒåŒ…æ‹¬éªŒè¯ç¨‹åºåœ¨å†…çš„æ‰€æœ‰ä»£ç éƒ½ä¼šä¸¢å¤±ï¼› </li><li> åœ¨ç¼–è¾‘å™¨ä¸­ï¼Œæœ‰å…³ç¼–å†™éªŒè¯å™¨çš„å±æ€§åç§°å’Œå¯¹è±¡å€¼ç±»å‹çš„æç¤ºï¼› </li><li> å‡ºäºç›¸åŒç›®çš„ï¼Œç¼ºä¹æ™¦æ¶©çš„ç¬¬ä¸‰æ–¹åº“ï¼› </li><li>  Joiè§„åˆ™ä»…åœ¨å¿…è¦æ—¶æ‰é€‚ç”¨ï¼Œåœ¨å…¶ä»–æƒ…å†µä¸‹ä¸ºé»˜è®¤ç±»å‹ï¼› </li><li> å¦‚æœæŸäººæƒ³æ›´æ”¹å±æ€§çš„å€¼ç±»å‹ï¼Œåˆ™ä½¿ç”¨æ­£ç¡®çš„ä»£ç ç»„ç»‡ï¼Œä»–å°†å»åˆ°ä¸è¯¥å±æ€§å…³è”çš„æ‰€æœ‰ç±»å‹éƒ½èšé›†åœ¨ä¸€èµ·çš„åœ°æ–¹ã€‚ </li><li> æˆ‘ä»¬å­¦ä¼šäº†å°†ç¾ä¸½çš„æ³›å‹ç®€å•åœ°éšè—åœ¨<code>type</code>æŠ½è±¡çš„åé¢ï¼Œä»è§†è§‰ä¸Šä»æ€ªå¼‚çš„ç»“æ„ä¸­å¸è½½ä»£ç ã€‚ </li></ol><br><p>  <strong>é“å¾·ï¼š</strong>ç»éªŒæ˜¯æ— ä»·çš„ï¼›åœ¨å…¶ä»–æ–¹é¢ï¼Œæœ‰ä¸€å¼ ä¸–ç•Œåœ°å›¾ã€‚ </p><br><p> æ‚¨å¯ä»¥çœ‹åˆ°ï¼Œè§¦æ‘¸å¹¶è¿è¡Œæœ€ç»ˆç»“æœï¼š <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">https://repl.it/@Melodyn/Joi-by-interface</a> <br><img src="https://i01.fotocdn.net/s27/157/public_pin_m/250/2670655900.jpg" alt="" title="t"></p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN450238/">https://habr.com/ru/post/zh-CN450238/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN450228/index.html">å…³äºç‹‚çŠ¬ç—…çš„10ä¸ªç¥è¯</a></li>
<li><a href="../zh-CN450230/index.html">ä½ ä¸æ˜¯è°·æ­Œ</a></li>
<li><a href="../zh-CN450232/index.html">åæ¸—é€å‡€æ°´ç³»ç»Ÿ-å¾ˆå¥½è¿˜æ˜¯ä¸å¥½ï¼Ÿ</a></li>
<li><a href="../zh-CN450234/index.html">æœºå™¨å¦‚ä½•é€šä¿¡ï¼šModbusåè®®</a></li>
<li><a href="../zh-CN450236/index.html">æˆ‘å¦‚ä½•ä¸å†æ‹…å¿ƒï¼Œå¯¹æ—¶é—´è·Ÿè¸ªç³»ç»Ÿæœ‰äº†ä¸åŒçš„çœ‹æ³•</a></li>
<li><a href="../zh-CN450240/index.html">æ²ƒå°”ç›å¼€è®¾äº†ç¬¬ä¸€å®¶AIé©±åŠ¨å•†åº—</a></li>
<li><a href="../zh-CN450242/index.html">ä¸ºä»€ä¹ˆéœ€è¦å¦ä¸€ä¸ªPHPæ¡†æ¶ï¼Ÿ</a></li>
<li><a href="../zh-CN450244/index.html">å¦‚ä½•æ’°å†™å’Œå®£ä¼ ç™½çš®ä¹¦ï¼Ÿ</a></li>
<li><a href="../zh-CN450246/index.html">æ¥è‡ªIBM 705è®¡ç®—æœºçš„ç”µå­ç®¡åå¼¹æŠ‘åˆ¶æ¨¡å—ï¼Œå¦‚æœå°è¯•å°†å…¶æ‰“å¼€ä¼šæ€æ ·ï¼Ÿ</a></li>
<li><a href="../zh-CN450248/index.html">å°†é¡¹ç›®é¢œè‰²ä¿å­˜åœ¨Navisworksæ•°æ®åº“ä¸­</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>