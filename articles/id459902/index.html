<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🚣🏼 🙎🏾 📁 Peta interaktif wilayah Rusia untuk pemula. Kesalahan yang saya buat dan yang tidak boleh Anda lakukan 🤹🏿 🧝🏽 ☯️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dalam artikel ini saya akan memberi tahu Anda bagaimana kami menemukan kesalahan tipikal ketika membuat peta interaktif, dan yang paling penting, saya...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Peta interaktif wilayah Rusia untuk pemula. Kesalahan yang saya buat dan yang tidak boleh Anda lakukan</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/459902/"><p>  Dalam artikel ini saya akan memberi tahu Anda bagaimana kami menemukan kesalahan tipikal ketika membuat peta interaktif, dan yang paling penting, saya akan memberi Anda tautan ke peta normal saat ini dari entitas konstituen Federasi Rusia. </p><br><img src="https://habrastorage.org/webt/fr/zl/1t/frzl1tzsb5rukh8hezpfrjo6o1s.png"><br><p>  Tantangan kita.  Buat peta interaktif sehingga saat Anda mengarahkan kursor ke suatu wilayah, seorang pawang acara akan menembak dan menampilkan beberapa data berdasarkan wilayah (misalnya, namanya). <br>  Sekilas ini kelihatannya sangat sederhana, tetapi kemudian dalam artikel ini saya akan memberi tahu Anda bagaimana kami menghabiskan lebih dari 3 hari untuk memperbaikinya, dan yang paling penting, untuk mengidentifikasi bug. </p><a name="habracut"></a><br><p>  Jadi, kami memulai proyek.  Untuk memulainya, kita perlu, pada kenyataannya, peta itu sendiri: pergi ke Google kita mendapatkan sejumlah besar format data peta yang berbeda. </p><br><p>  Karena kami bukan ahli geoanalisis profesional, pada prinsipnya, kami tidak peduli tentang format - hal utama adalah bekerja, jadi kami tidak akan mempertimbangkan segala sesuatu di sini, tetapi menyoroti dua kelompok utama. </p><br><ul><li>  Kartu vektor </li><li>  Peta dengan metadata </li></ul><br><p>  Peta vektor adalah poligon vektor reguler yang mengulangi bentuk objek, misalnya, sebuah negara.  Format utama untuk kartu jenis ini adalah SVG.  Dan saya akan segera mengatakan mengapa itu buruk untuk proyek kami dan mengapa itu tidak boleh digunakan dalam peta interaktif sama sekali.  Ini hanyalah angka geometris tanpa data, bahkan tanpa nama.  Jika Anda bukan seorang masokis, maka Anda tidak akan secara manual mengacaukan event handler untuk setiap poligon dan secara manual memasukkan semua informasi tentang objek, dari akronim dalam bahasa yang berbeda ke status administrasi.  Jika Anda dapat melakukan ini dengan peta distrik federal, maka di tingkat distrik Anda akan mati. </p><br><p>  Peta dengan metadata.  Peta dengan metadata, jika dalam bahasa yang sangat sederhana, adalah poligon vektor yang sama, hanya dengan informasi yang terhubung.  Ada banyak format, saya akan mencantumkan yang utama: GeoJSON, SHP, GeoTIFF, MIF, TAB, KML.  Secara umum, ada banyak dari mereka, masing-masing dari mereka memiliki karakteristik sendiri, tentang yang hanya orang yang berpengetahuan luas dalam sistem GIS dapat memberi tahu Anda. </p><br><p>  Artikel ini hanya membahas GeoJSON karena fakta bahwa proyek memutuskan untuk hanya menggunakan format ini dengan metadata.  Semua peta di bawah ini berisi nama wilayah, deskripsi, populasi, dll. </p><br><p>  Kami menemukan formatnya dan mencari data dengan ekstensi tertentu.  Dan kemudian kesenangan dimulai.  Apakah Anda pikir mudah untuk menemukan peta Federasi Rusia yang berfungsi dengan baik?  Pff, itu tidak ada di sana, banyak petualangan menunggu Anda.  Jadi, Anda mengunduh peta, mengonfigurasi semuanya, meluncurkannya dan ... </p><br><img src="https://habrastorage.org/webt/3n/fe/l_/3nfel_fnki8v27zf60-64noffsq.jpeg"><br><p>  Krimea  Tautan pertama di google pergi ke gis-lab.  Dan pada peta-peta ini tidak ada semenanjung.  Semuanya sederhana di sini.  Kartu utama Rusia dibuat pada tahun 2000 dan 2010, yaitu, sebelum Krimea dimasukkan dalam Federasi Rusia, dan banyak layanan Barat tidak mengenali aksesi dan tidak menambahkan semenanjung ke kartu mereka.  Dan jika Anda memasukkan peta tanpa Krimea ke dalam proyek Anda, sementara di Rusia, Anda sendiri mengerti apa yang bisa terjadi.  Karena itu, membuat peta tanpa wilayah ini bukanlah suatu pilihan. <br>  Solusi: Cari rakitan kartu amatir lebih dari 2014 atau layanan asing yang masih menambahkan Crimea ke kartu Rusia.  Tetapi kemungkinan besar Anda tidak akan menemukannya. </p><br><p>  Mari kita melihat lebih jauh.  Kami pergi ke Google, mengemudi di "unduh subjek geojson dari Federasi Rusia", temukan, unduh peta dari mydata.biz dan ... Semuanya membengkak bersama kami. </p><br><img src="https://habrastorage.org/webt/a-/da/te/a-datejv8bvoune008mr2u6sprm.jpeg"><br><p>  Perbatasan mengambang.  Dalam beberapa peta, perairan teritorial dimasukkan dalam mata pelajaran.  Karena kenyataan bahwa wilayah semua mata pelajaran yang berbatasan dengan laut bertambah 24 km, peta terlihat “melayang”, terutama daerah dengan garis pantai dan pulau-pulau.  Jika Anda bersahaja, maka Anda mungkin dapat menggunakan kartu ini, tetapi untuk proyek saya ini tidak dapat diterima. <br>  Solusi  Cari lebih jauh untuk peta tidak termasuk perairan teritorial. </p><br><p>  Silakan.  Di kedalaman Internet di situs yang ditinggalkan Anda menemukan peta, seperti dengan Krimea dan tidak "mengambang", unduh dan ... </p><br><img src="https://habrastorage.org/webt/hc/xf/28/hcxf28bpg0uid2xd4ikhfihbbuo.jpeg"><br><p>  Batas-batas subjek bertemu satu sama lain. </p><br><p>  Masalah ini sering ditemukan dalam kartu amatir, batas-batas subjek saling bertemu dan karena itu, tampilan elemen yang salah dimungkinkan.  Mungkin juga muncul karena kompresi yang tidak tepat atau penyederhanaan peta. </p><br><p>  Titik merah adalah perpotongan poligon satu sama lain. </p><br><p>  Ini tidak selalu memberikan artefak di layar, tetapi dengan sejumlah besar kesalahan, gambar berikut dapat terjadi: </p><br><img src="https://habrastorage.org/webt/3y/a1/vj/3ya1vjn8xjxpquswm104_owfe7a.jpeg"><br><p>  Solusi: Cari peta tanpa saling memukul poligon. </p><br><p>  Kami mencari lebih jauh.  Di suatu tempat, dengan mukjizat, Anda menemukan peta yang bagus - dengan Krimea, tanpa perairan teritorial, tanpa mengenai tempat pembuangan sampah satu sama lain dan ... </p><br><p>  Semuanya membeku.  Kartu ini memiliki berat 35MB karena detail yang berlebihan, dan komputer yang lemah mulai melambat saat ditampilkan. </p><br><p>  Solusi: Cari peta dengan sedikit detail atau kompres peta.  Untuk geojson saya sarankan mapshaper.org. </p><br><p>  Itu saja, Anda melewati sembilan lingkaran neraka, menemukan peta yang sempurna, unduh keduanya dan ....  Bagian dari Chukotka idealnya terputus dari sisa Rusia. </p><br><p><img src="https://habrastorage.org/webt/zg/ho/jm/zghojmp433ydfvg1sajlejjh6aq.jpeg" alt="gambar"></p><br><p>  Chukotka  Chukotka  Chukotka  Kata ini layak diulang berkali-kali, karena jika Anda seorang pemula, maka Anda akan terjebak dengan masalah ini untuk waktu yang lama.  Tidak mudah bagi Anda untuk memahami bahwa ini bukan kartu yang rusak, ini bukan kesalahan, dan itu tidak semudah diperbaiki seperti yang Anda pikirkan pada pandangan pertama.  Anda tidak akan dapat memotong bagian ini dan menempel ke seluruh Rusia, Anda tidak akan dapat mentransfer semua objek ke pusat tanpa bug, dll.  Dan jika berhasil, itu akan menjadi kruk terburuk, dan kami tidak menyetujui metode tersebut. </p><br><h4 id="razrezannaya-chukotka">  Irisan Chukotka </h4><br><p>  Saya tidak akan merinci, tetapi akan segera mengungkapkan kartu. </p><br><p>  Ini bukan kesalahan.  Masalahnya adalah bahwa secara default di layanan peta ada proyeksi (ya, Anda harus memahami apa itu proyeksi dan apa itu) CRS84 yang, secara kasar, asal koordinat berasal dari 180 meridian, mis. Peta dimulai dan berakhir pada Chukotka.  Bayangkan Anda memotong dan memperluas bola bumi di sepanjang garis ini. </p><br><p>  Dari sudut pandang proyeksi CRS84, semuanya ditampilkan dengan benar. </p><br><p>  Proyeksi adalah topik besar dan kompleks.  Saya tidak berpikir bahwa perlu menghabiskan banyak waktu untuk mempelajarinya, jika Anda hanya perlu membuat peta interaktif di proyek Anda.  Juga, saya tidak akan mengunyah secara detail, tetapi saya hanya akan memberi tahu tentang proyeksi yang akan membantu menampilkan peta Federasi Rusia dengan benar. </p><br><p>  Proyeksi konformal konformasi lambert Asia akan mengembalikan Chukotka ke tempatnya.  Tetapi, seperti yang saya pahami, ini adalah proyeksi non-standar dan banyak layanan, misalnya, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">http://geojson.io</a> , tidak mendukung keberangkatan dari standar. </p><br><p>  Dengan proyeksi area sama Conic, semuanya bekerja untuk kami setelah sedikit revisi. </p><br><p>  Setelah meletakkan proyeksi berbentuk kerucut, Anda akan melihat gambar berikut: Rusia jatuh miring dan setengah tenggelam. </p><br><p><img src="https://habrastorage.org/webt/cf/tf/9z/cftf9zuptqjlc2yvh0sq-cc6bku.jpeg" alt="gambar"></p><br><p>  Sekali lagi ini bukan bug - peta ditampilkan dengan benar, tetapi secara default ada sudut seperti itu.  Ini dipecahkan dengan membalik secara mudah dan memperbesar kartu: </p><br><pre><code class="django hljs"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">ComposableMap</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">projection</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{()</span></span></span></span><span class="xml"><span class="hljs-tag"> =&gt;</span></span></span><span class="xml"> geoConicEqualArea() .scale(690) .center([100, 100]) .parallels([40, 80]) .rotate([265].translate([130, 5]) }&gt; </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">ZoomableGroup</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Geographies</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">geography</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{map}</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> {(geographies, proj) =&gt; geographies.map(geo =&gt; ( </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Geography</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">projection</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{proj}</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">geography</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{geo}</span></span></span></span><span class="xml"><span class="hljs-tag"> /&gt;</span></span></span><span class="xml"> )) } </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Geographies</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">ZoomableGroup</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">ComposableMap</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></code> </pre> <br><p>  Hasilnya, Anda mendapatkan kartu berikut: </p><br><img src="https://habrastorage.org/webt/ka/gd/xp/kagdxpkw7xplsbekoquncdvpudg.jpeg"><br><p>  ... yang semuanya baik-baik saja, dia tanpa stok dan cantik.  Hampir.  Namun demikian, tetap ada "bekas luka Chukchi" yang tidak bisa kita hapus.  Ini tidak terlalu terlihat dan tidak sangat merusak komposisi.  Kami tidak menemukan cara bagaimana menghapusnya, dan, jujur ​​saja, kami tidak mencarinya - kami terlalu tersiksa oleh kesalahan sebelumnya dan memutuskan untuk meninggalkan semuanya apa adanya. </p><br><img src="https://habrastorage.org/webt/gc/ue/tj/gcuetjnlyxhr6bdwlsebrjzvwa8.jpeg"><br><p>  Jadi, kami telah menyortir kesalahan tipikal ketika merancang peta interaktif.  Jika kami memiliki artikel seperti itu sebulan yang lalu, itu akan menghemat banyak kegelisahan bagi tim kami dan, saya harap, akan menyelamatkan Anda juga. </p><br><p>  Kami memeriksa masalah-masalah berikut: </p><br><ul><li>  Krimea Hilang </li><li>  Subjek termasuk perairan teritorial </li><li>  Perbatasan subjek bertemu satu sama lain </li><li>  Kartu terlalu berat </li><li>  Chukotka memotong 180 meridian </li></ul><br><h4 id="zametka-ot-razrabotchika-iz-komandy">  Catatan dari pengembang dari tim </h4><br><p>  Kesulitan lain adalah menemukan komponen untuk merender peta yang tidak akan bergantung pada sisi klien, seperti  peta diberikan di server.  Kami menggunakan kerangka kerja Next.js, yang didasarkan pada React, jadi d3-geo tidak berfungsi, kami harus menemukan komponen Bereaksi. </p><br><p>  PS: Artikel itu ditulis hanya supaya muda dan hijau seperti kita tidak menghabiskan 2-3 hari menyiksa dengan kartu, dan belajar dari kesalahan orang lain.  Itu ditulis bukan oleh seorang programmer, bukan seorang geoanalyst, bukan seorang kartografer, tetapi oleh sebuah proyek sederhana, jadi untuk semua klaim dan ketidakakuratan saya sarankan untuk menulis artikel Anda di segmen berbahasa Rusia, di mana Anda menjelaskan secara rinci bagaimana melakukannya, karena saya tidak menemukan sumber informasi normal. </p><br><p>  Kartu: </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Pada Juni 2019, peta Rusia terbaik</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Bank kartu besar dari seluruh dunia dengan kualitas sedang</a> </p><br><p>  Layanan: </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Tampilan peta online dan alat untuk mengompres mereka</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">proyeksi</a> </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Proyeksi</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Bereaksi komponen rendering peta</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id459902/">https://habr.com/ru/post/id459902/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id459890/index.html">Mobil listrik bukan untuk saya</a></li>
<li><a href="../id459892/index.html">Acara digital di Moskow dari 15 Juli hingga 21 Juli</a></li>
<li><a href="../id459894/index.html">Jika Anda tidak merespons, kami akan menulis ... ke Sportloto</a></li>
<li><a href="../id459898/index.html">Rencananya telah kembali ke ekonomi</a></li>
<li><a href="../id459900/index.html">Memvisualisasikan kolom dari DataFrame menggunakan perpustakaan Seaborn</a></li>
<li><a href="../id459906/index.html">Tic Tac Toe, bagian 3: Undo / Redo dengan penyimpanan perintah</a></li>
<li><a href="../id459910/index.html">Situasi: perusahaan tidak terburu-buru untuk mengembangkan layanan untuk asisten suara - apa risikonya</a></li>
<li><a href="../id459914/index.html">SQL Index Manager - alat gratis untuk mendefrag dan mempertahankan indeks</a></li>
<li><a href="../id459918/index.html">Pemecahan masalah dengan pwnable.kr 03 - bof. Buffer overflow pada stack</a></li>
<li><a href="../id459922/index.html">Menghapus kebisingan frekuensi tinggi dari sinyal sensor getaran selama diagnostik getaran bantalan</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>