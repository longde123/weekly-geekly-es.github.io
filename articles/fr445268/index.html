<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ˜‹ ğŸ‘‡ğŸ» ğŸ¥“ DÃ©tails GraphQL: quoi, comment et pourquoi ğŸ‘¨â€ğŸ« ğŸ£ ğŸ§¢</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="GraphQL est maintenant, sans exagÃ©ration, c'est le dernier coup d'oeil du mode informatique. Et si vous ne savez pas encore de quel type de technologi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>DÃ©tails GraphQL: quoi, comment et pourquoi</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/445268/">  GraphQL est maintenant, sans exagÃ©ration, c'est le dernier coup d'oeil du mode informatique.  Et si vous ne savez pas encore de quel type de technologie il s'agit, comment l'utiliser et pourquoi elle peut vous Ãªtre utile, l'article que nous publions aujourd'hui est Ã©crit pour vous.  Nous allons ici passer en revue les bases de GraphQL en utilisant un exemple d'implÃ©mentation d'un schÃ©ma de donnÃ©es pour l'API d'une entreprise de pop-corn.  Parlons en particulier des types de donnÃ©es, des requÃªtes et des mutations. <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/c7/oq/a1/c7oqa1w2b00akzatd2womwb_daw.png"></a> <br><a name="habracut"></a><br><h2>  <font color="#3AC1EF">Qu'est-ce que GraphQL?</font> </h2><br>  GraphQL est un langage de requÃªte utilisÃ© par les applications clientes pour travailler avec les donnÃ©es.  GraphQL est associÃ© Ã  un concept tel que Â«schÃ©maÂ» - c'est ce qui vous permet d'organiser la crÃ©ation, la lecture, la mise Ã  jour et la suppression de donnÃ©es dans votre application (c'est-Ã -dire que nous avons quatre fonctions de base utilisÃ©es lorsque nous travaillons avec des entrepÃ´ts de donnÃ©es, qui sont gÃ©nÃ©ralement dÃ©signÃ©s par l'acronyme CRUD - crÃ©er, lire, mettre Ã  jour, supprimer). <br><br>  Il a Ã©tÃ© dit plus haut que GraphQL est utilisÃ© pour travailler avec des donnÃ©es dans Â«votre applicationÂ», et non Â«dans votre base de donnÃ©esÂ».  Le fait est que GraphQL est un systÃ¨me indÃ©pendant des sources de donnÃ©es, c'est-Ã -dire qu'il importe peu oÃ¹ il est organisÃ© pour organiser son travail. <br><br>  Si vous regardez, sans rien savoir de GraphQL, sur le nom de cette technologie, il peut sembler que nous sommes confrontÃ©s Ã  quelque chose de trÃ¨s compliquÃ© et dÃ©routant.  Le nom de la technologie a le mot Â«graphiqueÂ».  Est-ce Ã  dire que pour le maÃ®triser, il faut apprendre Ã  travailler avec des bases de donnÃ©es graphiques?  Et le fait que le nom contienne Â«QLÂ» (qui peut signifier Â«langage de requÃªteÂ», c'est-Ã -dire Â«langage de requÃªteÂ»), cela signifie-t-il que ceux qui veulent utiliser GraphQL devront apprendre un tout nouveau langage de programmation? <br><br>  Ces craintes ne sont pas entiÃ¨rement justifiÃ©es.  Afin de vous rassurer - c'est la cruelle vÃ©ritÃ© sur cette technologie: il s'agit simplement d'embellir des requÃªtes <code>GET</code> ou <code>POST</code> .  Alors que GraphQL, en gÃ©nÃ©ral, introduit de nouveaux concepts liÃ©s Ã  l'organisation des donnÃ©es et Ã  leur interaction, les mÃ©canismes internes de cette technologie reposent sur les bonnes vieilles requÃªtes HTTP. <br><br><h2>  <font color="#3AC1EF">Repenser la technologie REST</font> </h2><br>  La flexibilitÃ© est ce qui distingue la technologie GraphQL de la technologie REST bien connue.  Lorsque vous utilisez REST, si tout est fait correctement, les noeuds finaux sont gÃ©nÃ©ralement crÃ©Ã©s en tenant compte des caractÃ©ristiques d'un certain type de donnÃ©es de ressource ou d'application. <br><br>  Par exemple, lors de l'exÃ©cution d'une demande <code>GET</code> vers le point de terminaison <code>/api/v1/flavors</code> il est prÃ©vu qu'il envoie une rÃ©ponse qui ressemble Ã  ceci: <br><br><pre> <code class="plaintext hljs">[ {  "id": 1,   "name": "The Lazy Person's Movie Theater",   "description": "That elusive flavor that you begrudgingly carted yourself to the theater for, now in the comfort of your own home, you slob!" }, {   "id": 2,   "name": "What's Wrong With You Caramel",   "description": "You're a crazy person that likes sweet popcorn. Congratulations." }, {   "id": 3,   "name": "Gnarly Chili Lime",   "description": "The kind of popcorn you make when you need a good smack in the face."} ]</code> </pre> <br>  Il n'y a rien de catastrophique dans cette rÃ©ponse, mais rÃ©flÃ©chissons Ã  l'interface utilisateur, ou plutÃ´t Ã  la faÃ§on dont nous avons l'intention de consommer ces donnÃ©es. <br><br>  Si nous voulons afficher une simple liste dans l'interface qui ne contient que les noms des types de pop-corn disponibles (et rien d'autre), cette liste peut ressembler Ã  celle illustrÃ©e ci-dessous. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a89/0fd/c56/a890fdc56389815233584327e76011c1.png"></div><br>  <i><font color="#999999">Liste des types de pop-corn</font></i> <br><br>  On peut voir que nous sommes ici dans une situation difficile.  Nous pouvons bien dÃ©cider de ne pas utiliser le champ de <code>description</code> , mais allons-nous nous asseoir et prÃ©tendre que nous n'avons pas envoyÃ© ce champ au client?  Que pouvons-nous faire d'autre?  Et quand, au bout de quelques mois, ils nous demanderont pourquoi l'application est si lente pour les utilisateurs, il suffit de laisser le gars et de ne plus rencontrer la direction de l'entreprise pour laquelle nous avons fait cette application. <br><br>  En fait, le fait que le serveur envoie des donnÃ©es inutiles en rÃ©ponse Ã  une demande client n'est pas entiÃ¨rement de notre faute.  REST est un mÃ©canisme d'acquisition de donnÃ©es qui peut Ãªtre comparÃ© Ã  un restaurant dans lequel le serveur demande au visiteur: "Qu'est-ce que tu veux?" . <br><br>  Si nous mettons de cÃ´tÃ© les blagues, dans les applications rÃ©elles, cela peut conduire Ã  des situations problÃ©matiques.  Par exemple, nous pouvons afficher diverses informations supplÃ©mentaires sur chaque type de pop-corn, telles que des informations sur les prix, des informations sur le fabricant ou des informations nutritionnelles (Â«Popcorn vÃ©gÃ©talien!Â»).  Dans le mÃªme temps, les points de terminaison REST rigides rendent trÃ¨s difficile l'obtention de donnÃ©es spÃ©cifiques sur des types spÃ©cifiques de pop-corn, ce qui conduit Ã  une charge dÃ©raisonnablement Ã©levÃ©e sur les systÃ¨mes et au fait que les solutions qui en rÃ©sultent sont loin de celles dont les dÃ©veloppeurs pourraient Ãªtre fiers. <br><br><h2>  <font color="#3AC1EF">Comment la technologie GraphQL amÃ©liore l'utilisation de la technologie REST</font> </h2><br>  Une analyse superficielle de la situation dÃ©crite ci-dessus peut sembler que nous ne sommes qu'un problÃ¨me mineur.  "Quel est le problÃ¨me avec l'envoi au client de donnÃ©es inutiles?"  Afin de comprendre dans quelle mesure les Â«donnÃ©es inutilesÂ» peuvent Ãªtre un gros problÃ¨me, n'oubliez pas que GraphQL a Ã©tÃ© dÃ©veloppÃ© par Facebook.  Cette entreprise doit rÃ©pondre Ã  des millions de demandes par seconde. <br><br>  Qu'est-ce que cela signifie?  Et le fait qu'avec de tels volumes, chaque petite chose compte. <br><br>  GraphQL, si nous continuons l'analogie avec un restaurant, au lieu de Â«porterÂ» au visiteur Â«ce qui estÂ», apporte exactement ce que le visiteur commande. <br><br>  Nous pouvons obtenir une rÃ©ponse de GraphQL qui se concentre sur le contexte dans lequel les donnÃ©es sont utilisÃ©es.  Dans ce cas, nous n'avons pas besoin d'ajouter des points d'accÃ¨s Â«uniquesÂ» au systÃ¨me, d'effectuer de nombreuses demandes ou d'Ã©crire des structures conditionnelles Ã  plusieurs Ã©tages. <br><br><h2>  <font color="#3AC1EF">Comment fonctionne GraphQL?</font> </h2><br>  Comme nous l'avons dÃ©jÃ  dit, GraphQL s'appuie sur de simples requÃªtes <code>GET</code> ou <code>POST</code> pour transmettre des donnÃ©es au client et les recevoir de lui.  Si nous considÃ©rons cette idÃ©e plus en dÃ©tail, il s'avÃ¨re qu'il existe deux types de requÃªtes dans GraphQL.  Le premier type comprend les demandes de lecture de donnÃ©es, qui dans la terminologie GraphQL sont simplement appelÃ©es requÃªtes et font rÃ©fÃ©rence Ã  la lettre R (lecture, lecture) de l'acronyme CRUD.  Les requÃªtes du deuxiÃ¨me type sont des demandes de modification de donnÃ©es, appelÃ©es mutations dans GraphQL.  Ils concernent les boÃ®tes d'essieux C, U et D de l'acronyme CRUD, c'est-Ã -dire qu'ils les utilisent pour crÃ©er, crÃ©er, mettre Ã  jour et supprimer des enregistrements. <br><br>  Toutes ces requÃªtes et mutations sont envoyÃ©es Ã  l'URL du serveur GraphQL, qui peut par exemple ressembler Ã  <code>https://myapp.com/graphql</code> , sous forme de requÃªtes <code>GET</code> ou <code>POST</code> .  Nous en parlerons plus loin ci-dessous. <br><br><h2>  <font color="#3AC1EF">RequÃªtes GraphQL</font> </h2><br>  Les requÃªtes GraphQL sont des entitÃ©s reprÃ©sentant une demande au serveur de recevoir certaines donnÃ©es.  Par exemple, nous avons une certaine interface utilisateur que nous voulons remplir de donnÃ©es.  Pour ces donnÃ©es, nous nous tournons vers le serveur, exÃ©cutant la demande.  Lorsque vous utilisez des API REST traditionnelles, notre demande prend la forme d'une demande GET.  Lorsque vous travaillez avec GraphQL, une nouvelle syntaxe de requÃªte est utilisÃ©e: <br><br><pre> <code class="plaintext hljs">{ flavors {   name } }</code> </pre> <br>  Est-ce JSON?  Ou un objet JavaScript?  Ni l'un ni l'autre.  Comme nous l'avons dÃ©jÃ  dit, au nom de la technologie GraphQL, les deux derniÃ¨res lettres, QL, signifient Â«langage de requÃªteÂ», c'est-Ã -dire le langage de requÃªte.  C'est, littÃ©ralement, un nouveau langage pour Ã©crire des demandes de donnÃ©es.  Tout cela ressemble Ã  une description de quelque chose de plutÃ´t compliquÃ©, mais en fait il n'y a rien de compliquÃ© ici.  Analysons la requÃªte ci-dessus: <br><br><pre> <code class="plaintext hljs">{ //    ,   . }</code> </pre> <br>  Toutes les demandes commencent par une Â«demande racineÂ» et ce que vous devez obtenir lors de l'exÃ©cution de la demande s'appelle un champ.  Afin de vous Ã©viter la confusion, il est prÃ©fÃ©rable d'appeler ces entitÃ©s Â«champs de requÃªte dans le schÃ©maÂ».  Si un tel nom vous semble incomprÃ©hensible - attendez un peu - ci-dessous, nous parlerons davantage du schÃ©ma.  Ici, dans la requÃªte racine, nous demandons le champ des <code>flavors</code> . <br><br><pre> <code class="plaintext hljs">{ flavors {   //  ,        flavor. } }</code> </pre> <br>  Lors de la demande d'un certain champ, nous devons Ã©galement indiquer les champs imbriquÃ©s qui doivent Ãªtre reÃ§us pour chaque objet qui vient en rÃ©ponse Ã  la demande (mÃªme s'il est prÃ©vu qu'un seul objet viendra en rÃ©ponse Ã  la demande). <br><br><pre> <code class="plaintext hljs">{ flavors {   name } }</code> </pre> <br>  Quel sera le rÃ©sultat?  AprÃ¨s avoir envoyÃ© une telle demande au serveur GraphQL, nous obtiendrons une rÃ©ponse nette et bien formÃ©e, comme la suivante: <br><br><pre> <code class="plaintext hljs">{ "data": {   "flavors": [     { "name": "The Lazy Person's Movie Theater" },     { "name": "What's Wrong With You Caramel" },     { "name": "Gnarly Chili Lime" }   ] } }</code> </pre> <br>  Veuillez noter qu'il n'y a rien de superflu.  Afin de le rendre plus clair, voici une autre requÃªte qui est exÃ©cutÃ©e pour obtenir des donnÃ©es sur une autre page de l'application: <br><br><pre> <code class="plaintext hljs">{ flavors {   id   name   description } }</code> </pre> <br>  En rÃ©ponse Ã  cette demande, nous obtenons ce qui suit: <br><br><pre> <code class="plaintext hljs">{ "data": {   "flavors": [     { "id": 1, "name": "The Lazy Person's Movie Theater", description: "That elusive flavor that you begrudgingly carted yourself to the theater for, now in the comfort of your own home, you slob!" },     { "id": 2, "name": "What's Wrong With You Caramel", description: "You're a crazy person that likes sweet popcorn. Congratulations." },     { "id": 3, "name": "Gnarly Chili Lime", description: "A friend told me this would taste good. It didn't. It burned my kernels. I haven't had the heart to tell him." }   ] } }</code> </pre> <br>  Comme vous pouvez le voir, GraphQL est une technologie trÃ¨s puissante.  Nous nous tournons vers le mÃªme point de terminaison, et les rÃ©ponses aux demandes correspondent exactement Ã  ce qui est nÃ©cessaire pour remplir la page Ã  partir de laquelle ces demandes sont exÃ©cutÃ©es. <br><br>  Si nous devons obtenir un seul objet de <code>flavor</code> , nous pouvons profiter du fait que GraphQL peut fonctionner avec des arguments: <br><br><pre> <code class="plaintext hljs">{ flavors(id: "1") {   id   name   description } }</code> </pre> <br>  Ici, nous dÃ©finissons de maniÃ¨re rigide l'identifiant spÃ©cifique ( <code>id</code> ) de l'objet dans le code, les informations dont nous avons besoin, mais dans de tels cas, nous pouvons utiliser des identifiants dynamiques: <br><br><pre> <code class="plaintext hljs">query getFlavor($id: ID) { flavors(id: $id) {   id   name   description } }</code> </pre> <br>  Ici, dans la premiÃ¨re ligne, nous donnons un nom Ã  la demande (le nom est choisi arbitrairement, <code>getFlavor</code> peut Ãªtre remplacÃ© par quelque chose comme <code>pizza</code> , et la demande restera opÃ©rationnelle) et dÃ©clarons les variables que la demande attend.  Dans ce cas, on suppose que l'identifiant ( <code>id</code> ) de l' <code>ID</code> type scalaire sera transmis Ã  la requÃªte (nous parlerons des types ci-dessous). <br><br>  Peu importe si un <code>id</code> statique ou dynamique <code>id</code> utilisÃ© lors de l'exÃ©cution d'une demande, voici Ã  quoi ressemblera la rÃ©ponse Ã  une demande similaire: <br><br><pre> <code class="plaintext hljs">{ "data": {   "flavors": [     { "id": 1, "name": "The Lazy Person's Movie Theater", description: "That elusive flavor that you begrudgingly carted yourself to the theater for, now in the comfort of your own home, you slob!" }   ] } }</code> </pre> <br>  Comme vous pouvez le voir, tout est arrangÃ© de maniÃ¨re trÃ¨s pratique.  Vous commencez probablement Ã  penser Ã  utiliser GraphQL dans votre propre projet.  Et, bien que ce dont nous avons dÃ©jÃ  parlÃ© soit magnifique, la beautÃ© de GraphQL se manifeste vraiment lÃ  oÃ¹ il fonctionne avec des champs imbriquÃ©s.  Supposons que dans notre schÃ©ma, il existe un autre domaine appelÃ© <code>nutrition</code> qui contient des informations sur la valeur nutritionnelle de diffÃ©rents types de pop-corn: <br><br><pre> <code class="plaintext hljs">{ flavors {   id   name   nutrition {     calories     fat     sodium   } } }</code> </pre> <br>  Il peut sembler que dans notre entrepÃ´t de donnÃ©es, chaque objet de <code>flavor</code> contiendra un objet <code>nutrition</code> imbriquÃ©.  Mais ce n'est pas tout Ã  fait vrai.  Ã€ l'aide de GraphQL, vous pouvez combiner des appels Ã  des sources de donnÃ©es indÃ©pendantes mais liÃ©es dans une seule requÃªte, ce qui vous permet de recevoir des rÃ©ponses qui offrent la commoditÃ© de travailler avec des donnÃ©es incorporÃ©es sans avoir besoin de dÃ©normaliser la base de donnÃ©es: <br><br><pre> <code class="plaintext hljs">{ "data": {   "flavors": [     {       "id": 1,       "name": "The Lazy Person's Movie Theater",       "nutrition": {         "calories": 500,         "fat": 12,         "sodium": 1000       }     },     ...   ] } }</code> </pre> <br>  Cela peut augmenter considÃ©rablement la productivitÃ© du programmeur et la vitesse du systÃ¨me. <br><br>  Jusqu'Ã  prÃ©sent, nous avons parlÃ© des demandes de lecture.  Qu'en est-il des demandes de mise Ã  jour des donnÃ©es?  Les utiliser nous donne-t-il la mÃªme commoditÃ©? <br><br><h2>  <font color="#3AC1EF">Mutations GraphQL</font> </h2><br>  Tandis que les requÃªtes GraphQL chargent des donnÃ©es, les mutations sont responsables d'apporter des modifications aux donnÃ©es.  Les mutations peuvent Ãªtre utilisÃ©es sous la forme du mÃ©canisme de base RPC (Remote Procedure Call) pour rÃ©soudre diverses tÃ¢ches, telles que l'envoi de donnÃ©es utilisateur Ã  une API tierce. <br><br>  Lors de la description des mutations, une syntaxe similaire Ã  celle utilisÃ©e lors de la gÃ©nÃ©ration des requÃªtes est utilisÃ©e: <br><br><pre> <code class="plaintext hljs">mutation updateFlavor($id: ID!, $name: String, $description: String) { updateFlavor(id: $id, name: $name, description: $description) {   id   name   description } }</code> </pre> <br>  Ici, nous dÃ©clarons la mutation <code>updateFlavor</code> , en spÃ©cifiant certaines variables - <code>id</code> , <code>name</code> et <code>description</code> .  En agissant selon le mÃªme schÃ©ma que celui utilisÃ© pour dÃ©crire les requÃªtes, nous Â«Ã©tablissonsÂ» des champs de variables (mutation racine) Ã  l'aide du mot-clÃ© <code>mutation</code> , suivis d'un nom dÃ©crivant la mutation et d'un ensemble de variables nÃ©cessaires pour former la demande de changement de donnÃ©es correspondante. <br><br>  Ces variables incluent ce que nous essayons de changer ou quelle mutation nous voulons provoquer.  Veuillez Ã©galement noter qu'aprÃ¨s la mutation, nous pouvons demander le retour de certains champs. <br><br>  Dans ce cas, nous devons obtenir, aprÃ¨s avoir modifiÃ© l'enregistrement, les champs <code>id</code> , <code>name</code> et <code>description</code> .  Cela peut Ãªtre utile lors du dÃ©veloppement de quelque chose comme des interfaces optimistes, Ã©liminant ainsi la nÃ©cessitÃ© de rÃ©pondre Ã  une demande de rÃ©ception de donnÃ©es modifiÃ©es aprÃ¨s les avoir modifiÃ©es. <br><br><h2>  <font color="#3AC1EF">Concevoir un schÃ©ma et le connecter Ã  un serveur GraphQL</font> </h2><br>  Jusqu'Ã  prÃ©sent, nous avons parlÃ© du fonctionnement de GraphQL sur le client et de la faÃ§on dont ils exÃ©cutent les requÃªtes.  Voyons maintenant comment rÃ©pondre Ã  ces demandes. <br><br><h3>  <font color="#3AC1EF">Server Serveur GraphQL</font> </h3><br>  Pour exÃ©cuter une requÃªte GraphQL, vous avez besoin d'un serveur GraphQL auquel vous pouvez envoyer une telle requÃªte.  Un serveur GraphQL est un serveur HTTP standard (si vous Ã©crivez en JavaScript, il peut s'agir d'un serveur crÃ©Ã© en utilisant Express ou Hapi), auquel un diagramme GraphQL est attachÃ©. <br><br><pre> <code class="plaintext hljs">import express from 'express' import graphqlHTTP from 'express-graphql' import schema from './schema' const app = express() app.use('/graphql', graphqlHTTP({ schema: schema, graphiql: true })) app.listen(4000)</code> </pre> <br>  Par Â«rejoindreÂ» un schÃ©ma, nous entendons un mÃ©canisme qui transmet les demandes reÃ§ues du client via le schÃ©ma et y renvoie des rÃ©ponses.  C'est comme un filtre Ã  air Ã  travers lequel l'air pÃ©nÃ¨tre dans la piÃ¨ce. <br><br>  Le processus de "filtrage" est associÃ© aux requÃªtes ou mutations envoyÃ©es par le client au serveur.  Les requÃªtes et les mutations sont rÃ©solues Ã  l'aide de fonctions liÃ©es aux champs dÃ©finis dans la requÃªte racine ou dans la mutation racine du schÃ©ma. <br><br>  Ce qui prÃ©cÃ¨de est un exemple d'infrastructure de serveur HTTP crÃ©Ã© Ã  l'aide de la bibliothÃ¨que JavaScript Express.  En utilisant la fonction <code>express-graphql</code> de Facebook, nous Â«attachonsÂ» le schÃ©ma (on suppose qu'il est dÃ©crit dans un fichier sÃ©parÃ©) et exÃ©cutons le serveur sur le port 4000. Autrement dit, les clients, parlant de l'utilisation locale de ce serveur, pourront envoyer des requÃªtes via adresse <code>http://localhost:4000/graphql</code> . <br><br><h3>  <font color="#3AC1EF">â– Types de donnÃ©es et rÃ©solveurs</font> </h3><br>  Afin d'assurer le fonctionnement du serveur GraphQL, vous devez prÃ©parer le schÃ©ma et le joindre Ã  celui-ci. <br><br>  Rappelons que nous avons parlÃ© de dÃ©clarer des champs dans une requÃªte racine ou dans une mutation racine ci-dessus. <br><br><pre> <code class="plaintext hljs">import gql from 'graphql-tag' import mongodb from '/path/to/mongodb' //  -  . ,  `mongodb`     MongoDB. const schema = { typeDefs: gql`   type Nutrition {     flavorId: ID     calories: Int     fat: Int     sodium: Int   }   type Flavor {     id: ID     name: String     description: String     nutrition: Nutrition   }   type Query {     flavors(id: ID): [Flavor]   }   type Mutation {     updateFlavor(id: ID!, name: String, description: String): Flavor   } `, resolvers: {   Query: {     flavors: (parent, args) =&gt; {       // ,  args  ,  { id: '1' }       return mongodb.collection('flavors').find(args).toArray()     },   },   Mutation: {     updateFlavor: (parent, args) =&gt; {       // ,  args    { id: '1', name: 'Movie Theater Clone', description: 'Bring the movie theater taste home!' }       //  .       mongodb.collection('flavors').update(args)       //  flavor  .       return mongodb.collection('flavors').findOne(args.id)     },   },   Flavor: {     nutrition: (parent) =&gt; {       return mongodb.collection('nutrition').findOne({         flavorId: parent.id,       })     }   }, }, } export default schema</code> </pre> <br>  La dÃ©finition des champs dans un schÃ©ma GraphQL se compose de deux parties - Ã  partir des dÃ©clarations de type ( <code>typeDefs</code> ) et des <code>resolver</code> .  L' <code>typeDefs</code> contient des dÃ©clarations de type pour les donnÃ©es utilisÃ©es dans l'application.  Par exemple, plus tÃ´t, nous avons parlÃ© d'une demande pour obtenir une liste d'objets de <code>flavor</code> du serveur.  Afin de faire une demande similaire Ã  notre serveur, vous devez effectuer les trois Ã©tapes suivantes: <br><br><ol><li>  Indiquez au schÃ©ma Ã  quoi ressemblent les donnÃ©es de l'objet de <code>flavor</code> (dans l'exemple ci-dessus, elles ressemblent Ã  une annonce de <code>type Flavor</code> ). </li><li>  DÃ©clarez le champ dans le champ racine de <code>type Query</code> (il s'agit de la propriÃ©tÃ© <code>flavors</code> de la valeur de <code>type Query</code> ). </li><li>  DÃ©clarez une fonction de reconnaissance d'objet <code>resolvers.Query</code> Ã©crite conformÃ©ment aux champs dÃ©clarÃ©s dans le champ racine de <code>type Query</code> . </li></ol><br>  <code>typeDefs</code> maintenant attention Ã  <code>typeDefs</code> .  Ici, nous donnons les informations de schÃ©ma sur la forme de nos donnÃ©es.  En d'autres termes, nous informons GraphQL des diffÃ©rentes propriÃ©tÃ©s qui peuvent Ãªtre contenues dans des entitÃ©s du type correspondant. <br><br><pre> <code class="plaintext hljs">type Flavor { id: ID name: String description: String nutrition: Nutrition }</code> </pre> <br>  Une dÃ©claration de <code>type Flavor</code> indique qu'un objet <code>type Flavor</code> peut contenir un champ <code>id</code> de type <code>ID</code> , un champ de <code>name</code> de type <code>String</code> , un champ de <code>description</code> de type <code>String</code> et un champ de <code>nutrition</code> de type <code>Nutrition</code> . <br><br>  Dans le cas de la <code>nutrition</code> nous utilisons ici le nom d'un type diffÃ©rent dÃ©clarÃ© dans <code>typeDefs</code> .  Ici, le <code>type Nutrition</code> construction <code>type Nutrition</code> dÃ©crit la forme de donnÃ©es nutritionnelles du pop-corn. <br><br>  Faites attention au fait qu'ici, comme au tout dÃ©but de ce document, nous parlons d'une Â«applicationÂ» et non d'une Â«base de donnÃ©esÂ».  Dans l'exemple ci-dessus, on suppose que nous avons une base de donnÃ©es, mais les donnÃ©es de l'application peuvent provenir de n'importe quelle source.  Il peut mÃªme s'agir d'une API tierce ou d'un fichier statique. <br><br>  Tout comme nous l'avons fait dans la dÃ©claration de <code>type Flavor</code> , nous indiquons ici les noms des champs qui seront contenus dans les objets de <code>nutrition</code> , en utilisant, comme types de donnÃ©es de ces champs (propriÃ©tÃ©s), ce qui dans GraphQL est appelÃ© types de donnÃ©es scalaires.  Au moment d'Ã©crire ces lignes, GraphQL supportait <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">5 types de donnÃ©es scalaires intÃ©grÃ©s</a> : <br><br><ul><li>  <code>Int</code> : entier 32 bits signÃ©. </li><li>  <code>Float</code> : un nombre Ã  virgule flottante double prÃ©cision avec un signe. </li><li>  <code>String</code> : une sÃ©quence de caractÃ¨res encodÃ©s en UTF-8. </li><li>  <code>Boolean</code> : Boolean <code>true</code> or <code>false</code> . </li><li>  <code>ID</code> : identifiant unique souvent utilisÃ© pour charger Ã  plusieurs reprises des objets ou comme clÃ© dans le cache.  Les valeurs de type <code>ID</code> sÃ©rialisÃ©es de la mÃªme maniÃ¨re que les chaÃ®nes, cependant, une indication qu'un type d' <code>ID</code> a une valeur est soulignÃ©e par le fait que cette valeur n'est pas destinÃ©e Ã  Ãªtre affichÃ©e aux gens, mais Ã  Ãªtre utilisÃ©e dans des programmes. </li></ul><br>  En plus de ces types scalaires, nous pouvons Ã©galement attribuer des propriÃ©tÃ©s aux types que nous dÃ©finissons nous-mÃªmes.  C'est exactement ce que nous avons fait en attribuant la propriÃ©tÃ© <code>nutrition</code> dÃ©crite dans le <code>type Flavor</code> , type <code>Nutrition</code> . <br><br><pre> <code class="plaintext hljs">type Query { flavors(id: ID): [Flavor] }</code> </pre> <br>  Dans la construction de <code>type Query</code> , qui dÃ©crit le type racine de <code>Query</code> (la Â«requÃªte racineÂ» dont nous avons parlÃ© plus tÃ´t), nous dÃ©clarons le nom du champ qui peut Ãªtre demandÃ©.  En dÃ©clarant ce champ, nous spÃ©cifions, en plus du type de donnÃ©es que nous attendons, les arguments qui peuvent venir dans la demande. <br><br>  Dans cet exemple, nous attendons une rÃ©ception possible de l'argument <code>id</code> d'un <code>ID</code> type scalaire.  En rÃ©ponse Ã  une telle demande, un tableau d'objets est attendu dont le pÃ©riphÃ©rique ressemble Ã  un pÃ©riphÃ©rique de type <code>Flavor</code> . <br><br><h3>  <font color="#3AC1EF">â–Connexion du module de reconnaissance des requÃªtes</font> </h3><br> ,    <code>type Query</code>    <code>field</code> ,    ,   -. <br><br>  â€”  ,  GraphQL,   , Â«Â».      <code>resolvers</code> ,     <code>Query</code> ,   ,      <code>flavors</code> ,   .        <code>flavors</code> ,     <code>type Query</code> . <br><br><pre> <code class="plaintext hljs">typeDefs: gql`â€¦`, resolvers: { Query: {   flavors: (parent, args) =&gt; {     // ,  args    { id: '1' }     return mongodb.collection('flavors').find(args).toArray()   }, }, â€¦ },</code> </pre> <br>  -   .  <code>parent</code> â€”   ,   ,  <code>args</code>      ,   .      <code>context</code> ,      .       Â«Â»  ( â€”        ,       ). <br><br>     ,    ,   .   GraphQL Â« Â»          . , ,      . <br><br>  GraphQL      ,      ,    .    JSON-,  JSON-,  (  GraphQL   ). <br><br>    -   <code>flavors</code>   MongoDB,  <code>args</code> (    )   <code>.find()</code>   ,        ,   . <br><br><h3> <font color="#3AC1EF">â–    </font> </h3><br>     -,   GraphQL,  , ,   ,      <code>nutrition</code> .   ,  ,   <code>Nutrition</code> , ,   ,      ,   <code>flavor</code> .      ,       /  . <br><br>    GraphQL  ,  <code>type Flavor</code>      <code>nutrition</code>   <code>type Nutrition</code> ,          .  ,    ,      <code>flavor</code> . <br><br><pre> <code class="plaintext hljs">typeDefs: gql`   type Nutrition {     flavorId: ID     calories: Int     fat: Int     sodium: Int   }   type Flavor {     [â€¦]     nutrition: Nutrition   }   type Query {â€¦}   type Mutation {â€¦} `, resolvers: {   Query: {     flavors: (parent, args) =&gt; {â€¦},   },   Mutation: {â€¦},   Flavor: {     nutrition: (parent) =&gt; {       return mongodb.collection('nutrition').findOne({         flavorId: parent.id,       })     }   }, },</code> </pre> <br>      <code>resolvers</code>  ,   ,      <code>Query</code> , <code>Mutation</code>  <code>Flavor</code> .   ,      <code>typeDefs</code> . <br><br>     <code>Flavors</code> ,  ,   <code>nutrition</code>     -.       ,        <code>Flavor</code> .  ,   : Â« ,     <code>nutrition</code>     ,  <code>type Flavor</code> Â». <br><br>         MongoDB,      ,     <code>parent</code> ,  -. ,     <code>parent</code> ,   ,    ,   <code>flavors</code> . ,      <code>flavor</code> ,    : <br><br><pre> <code class="plaintext hljs">{ flavors {   id   name   nutrition {     calories   } } }</code> </pre> <br>   <code>flavor</code> ,   <code>flavors</code> ,     <code>nutrition</code> ,        <code>parent</code> .     ,  ,  ,    MongoDB,   <code>parent.id</code> ,    <code>id</code>  <code>flavor</code> ,       . <br><br>  <code>parent.id</code>      ,     <code>nutrition</code>   <code>flavorId</code> ,     <code>flavor</code> . <br><br><h3> <font color="#3AC1EF">â– </font> </h3><br> ,      ,     .   ,          .      <code>type Mutation</code> ,   ,       <code>updateFlavor</code> ,  ,   . <br><br><pre> <code class="plaintext hljs">type Mutation { updateFlavor(id: ID!, name: String, description: String): Flavor }</code> </pre> <br>     : Â« ,   <code>updateFlavor</code>  <code>id</code>  <code>ID</code> ( , <code>!</code> ,  GraphQL  ,    ), <code>name</code>  <code>String</code>  <code>description</code>  <code>String</code> Â».  ,         ,     <code>Flavor</code> (  â€” ,    <code>id</code> , <code>name</code> , <code>description</code> , , , <code>nutrition</code> ). <br><br><pre> <code class="plaintext hljs">{ typeDefs: gql`â€¦`, resolvers: {   Mutation: {     updateFlavor: (parent, args) =&gt; {       // ,  args    { id: '1', name: 'Movie Theater Clone', description: 'Bring the movie theater taste home!' }       //  .       mongodb.collection('flavors').update(         { id: args.id },         {           $set: {             ...args,           },         },       )       //  flavor  .       return mongodb.collection('flavors').findOne(args.id)     },   }, }, }</code> </pre> <br>  -   <code>updateFlavor</code>    ,      :       ,    ,   â€” ,      <code>flavor</code> . <br><br>    ,               ,       <code>flavor</code>     .   ? <br><br>   ,          ,        .     ,     <code>flavor</code> ,     . <br><br>      <code>args</code> ? , . ,          ,   ,      100%   ,         .       ,    ,  ,     ,      ,    . <br><br><h2> <font color="#3AC1EF">    GraphQL?</font> </h2><br>  ,      ,    ,     ,   , GraphQL-API. <br><br>        ,     GraphQL      ,      .  ,         .        ,    .  , ,   ,   GraphQL      REST      .  ,   ,           ,     GraphQL. <br><br><h3> <font color="#3AC1EF">â–    ,   </font> </h3><br>     ,       HTTP-,  ,      ,   ,   â€”  .       GraphQL       ,  ,    ,     ,     (            ). <br><br>        ,  ,     ( â€”         ),  GraphQL      . <br><br><h3> <font color="#3AC1EF">â–    ,    ,       </font> </h3><br>  ,       ,    Â« Â».      , ,   ,   .        .   GraphQL         . <br><br><h3> <font color="#3AC1EF">â–     ,       </font> </h3><br>          REST API,          :  ,    . ,      -,   iOS  Android,   API  .    ,  , ,   , Â«   Â»    . <br><br>    ,   ,   ,   HTTP,              API (, ,   ). <br><br><h3> <font color="#3AC1EF">â–   GraphQL â€”   ?        REST API    GraphQL?</font> </h3><br> , .   . ,  ,   GraphQL     .       GraphQL,     .       ,      ,      ,           .     ,      ,     . <br><br> ,  GraphQL  ,  ,      ,  .    GraphQL    ,      Apollo  Relay,       . <br><br> GraphQL â€” ,  ,   .   <code>graphql</code> (     <code>express-graphql</code> ,    ) â€”      .  ,   GraphQL      -  .      ,     -,   ,  ,     ,    . <br><br><h2>  <font color="#3AC1EF">RÃ©sumÃ©</font> </h2><br>   ,   GraphQL    ,           . GraphQL      ,    , ,  .  , ,       ,        ,       GraphQL. <br><br> ,       : GraphQL   .              GraphQL  . ,     GraphQL,      ,  , ,  ,  ,  ,  . <br><br>  â€”   ,  GraphQL â€” ,   ,   .  GraphQL       ,   .    ,  GraphQL â€”  ,  , ,  .           .  ,       ,      ,   ,     ,      ,      GraphQL. <br><br>  <b>Chers lecteurs!</b>        GraphQL â€”     ,         . <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr445268/">https://habr.com/ru/post/fr445268/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr445258/index.html">Comment supprimer en toute sÃ©curitÃ© vos donnÃ©es de votre smartphone Android avant de les vendre</a></li>
<li><a href="../fr445260/index.html">Les robots se reconnaÃ®tront-ils jamais vraiment? Les scientifiques s'orientent dans cette direction.</a></li>
<li><a href="../fr445262/index.html">GeekUniversity ouvre le recrutement au dÃ©partement Big Data d'Analytics</a></li>
<li><a href="../fr445264/index.html">PrÃ©chargement, prÃ©lecture et autres balises</a></li>
<li><a href="../fr445266/index.html">GeekBrains et Rostelecom organiseront un IoT Hackathon</a></li>
<li><a href="../fr445270/index.html">[signet] Bash pour les dÃ©butants: 21 commandes utiles</a></li>
<li><a href="../fr445272/index.html">JavaScript est le meilleur langage de programmation pour les dÃ©butants. C'est vrai ou pas?</a></li>
<li><a href="../fr445274/index.html">Lorsque "ZoÃ«"! == "ZoÃ«", ou pourquoi vous devez normaliser les chaÃ®nes Unicode</a></li>
<li><a href="../fr445276/index.html">Guide d'utilisation complet</a></li>
<li><a href="../fr445278/index.html">Comment crÃ©er un jeu si vous n'Ãªtes jamais artiste</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>