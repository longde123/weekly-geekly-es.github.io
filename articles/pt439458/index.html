<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üè¥‚Äç‚ò†Ô∏è üèùÔ∏è üë©üèº‚Äçüé® Como traduzimos o site da Rep√∫blica em Kubernetes üå∏ ‚ö∞Ô∏è üê≤</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Materiais escandalosos, importantes e simplesmente muito legais n√£o s√£o publicados na m√≠dia todos os dias, e nenhum editor se comprometer√° a prever o ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Como traduzimos o site da Rep√∫blica em Kubernetes</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/itsumma/blog/439458/"><img src="https://habrastorage.org/webt/w6/od/az/w6odaz9seym3nomzxkvoekqzbms.png"><br><br>  Materiais escandalosos, importantes e simplesmente muito legais n√£o s√£o publicados na m√≠dia todos os dias, e nenhum editor se comprometer√° a prever o sucesso de um artigo com 100% de precis√£o.  O m√°ximo que a equipe tem √© no n√≠vel do instinto de dizer material "forte" ou "comum".  S√≥ isso.  Em seguida, come√ßa a m√°gica imprevis√≠vel da m√≠dia, gra√ßas √† qual o artigo pode chegar ao topo dos resultados de pesquisa com dezenas de links de outras publica√ß√µes ou o material afundar√° no esquecimento.  E apenas no caso da publica√ß√£o de artigos interessantes, os sites de m√≠dia periodicamente sofrem um influxo monstruoso de usu√°rios, que modestamente chamamos de "efeito habitual". <br><br>  Neste ver√£o, o site de publica√ß√£o da <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Rep√∫blica</a> se tornou v√≠tima do profissionalismo de seus pr√≥prios autores: artigos sobre reforma previdenci√°ria, educa√ß√£o escolar e nutri√ß√£o adequada reuniram uma audi√™ncia de v√°rios milh√µes de leitores.  A publica√ß√£o de cada um dos materiais mencionados levou a cargas t√£o altas que, at√© a queda do site da Rep√∫blica, havia "um pouco de espa√ßo".  A administra√ß√£o percebeu que algo precisava ser mudado: era necess√°rio mudar a estrutura do projeto para que ele pudesse reagir vigorosamente √†s mudan√ßas nas condi√ß√µes de trabalho (principalmente carga externa), mantendo-se totalmente funcional e acess√≠vel aos leitores, mesmo em momentos de saltos muito acentuados.  E um grande b√¥nus seria a interven√ß√£o manual m√≠nima da equipe t√©cnica da Rep√∫blica nesses momentos. <br><br>  Com base nos resultados de uma discuss√£o conjunta com especialistas da Rep√∫blica sobre v√°rias op√ß√µes para implementar a Lista de Desejos dublada, decidimos transferir o site da publica√ß√£o para o Kubernetes *.  Sobre o que tudo isso nos custou, e ser√° a hist√≥ria de hoje. <br><br>  <i>* Durante a mudan√ßa, nenhum especialista t√©cnico republicano ficou ferido</i> <br><a name="habracut"></a><br><h3>  Como parecia em termos gerais </h3><br>  Tudo come√ßou, √© claro, com negocia√ß√µes sobre como tudo vai acontecer "agora" e "depois".  Infelizmente, o paradigma moderno no mercado de TI implica que, assim que uma empresa escolhe algum tipo de solu√ß√£o de infraestrutura, ela a coloca em uma lista de pre√ßos de servi√ßos chave na m√£o.  Parece que o trabalho √© "chave na m√£o" - o que poderia ser melhor e mais agrad√°vel do que um diretor condicional ou propriet√°rio de uma empresa?  Paguei e minha cabe√ßa n√£o d√≥i: planejamento, desenvolvimento, suporte - tudo est√° l√°, do lado do contratante, a empresa s√≥ pode ganhar dinheiro para pagar por um servi√ßo t√£o agrad√°vel. <br><br>  No entanto, a transfer√™ncia completa da infraestrutura de TI nem sempre √© adequada para o cliente a longo prazo.  √â mais correto, de todos os pontos de vista, trabalhar como uma grande equipe, para que, ap√≥s a conclus√£o do projeto, o cliente entenda como conviver mais com a nova infraestrutura, e os colegas da loja n√£o tenham a pergunta "oh, o que aconteceu aqui?"  ap√≥s a assinatura do certificado de conclus√£o e demonstra√ß√£o dos resultados.  Os caras da Rep√∫blica eram da mesma opini√£o.  Como resultado, por dois meses, desembarcamos quatro pessoas para o cliente, que n√£o apenas perceberam nossa ideia, mas tamb√©m especialistas tecnicamente treinados do lado da Rep√∫blica para mais trabalho e exist√™ncia nas realidades de Kubernetes. <br><br>  E todos os lados se beneficiaram com isso: conclu√≠mos rapidamente o trabalho, mantemos nossos especialistas prontos para novas conquistas e obtivemos a Republic como cliente em suporte consultivo com nossos pr√≥prios engenheiros.  A publica√ß√£o, por outro lado, recebeu uma nova infraestrutura adaptada aos ‚Äúhabraeffects‚Äù, sua pr√≥pria equipe de especialistas t√©cnicos e a capacidade de procurar ajuda, se necess√°rio. <br><br><h3>  Estamos preparando uma ponte </h3><br>  "Destrua - n√£o construa."  Este ditado se aplica a qualquer coisa.  Obviamente, a solu√ß√£o mais simples parece ser o ref√©m mencionado anteriormente, que captura a infraestrutura do cliente e o acorrenta, o cliente a si mesmo, ou faz um overclock da equipe existente e a exig√™ncia de contratar um guru em novas tecnologias.  Fomos o terceiro, n√£o o caminho mais popular hoje, e come√ßamos com o treinamento de engenheiros da Rep√∫blica. <br><br>  No in√≠cio, vimos uma solu√ß√£o desse tipo para garantir a opera√ß√£o do site: <br><img src="https://habrastorage.org/webt/lh/tu/dx/lhtudxfxmjai0dymprwmpctjmr8.png"><br><br>  Ou seja, a Republic tinha apenas dois servidores de ferro - o principal e o backup, backup.  O mais importante para n√≥s foi conseguir uma mudan√ßa de paradigma no pensamento dos especialistas t√©cnicos do cliente, porque antes eles lidavam com um grupo muito simples de NGINX, PHP-fpm e PostgreSQL.  Agora eles enfrentavam a arquitetura de cont√™iner escal√°vel do Kubernetes.  Ent√£o, primeiro, mudamos o desenvolvimento da Rep√∫blica local para o ambiente de composi√ß√£o de encaixe.  E este foi apenas o primeiro passo. <br><br>  Antes do desembarque, os desenvolvedores da Republic mantinham o ambiente de trabalho local em m√°quinas virtuais configuradas via Vagrant ou trabalhavam diretamente com o servidor de desenvolvimento via sftp.  Com base na imagem b√°sica geral de uma m√°quina virtual, cada desenvolvedor "pr√©-configurou" sua m√°quina "para si mesmo", o que deu origem a todo um conjunto de configura√ß√µes diferentes.  Como resultado dessa abordagem, a inclus√£o de novas pessoas na equipe aumentou exponencialmente o tempo em que entraram no projeto. <br><br>  Nas novas realidades, oferecemos √† equipe uma estrutura mais transparente do ambiente de trabalho.  Descreveu declarativamente qual software e quais vers√µes s√£o necess√°rias para o projeto, a ordem das conex√µes e intera√ß√µes entre os servi√ßos (aplicativos).  Essa descri√ß√£o foi carregada em um reposit√≥rio git separado para que ele possa ser gerenciado centralmente de maneira conveniente. <br><br>  Todos os aplicativos necess√°rios come√ßaram a ser executados em cont√™ineres de docker separados - e este √© um site php comum com nginx, muitas estat√≠sticas, servi√ßos para trabalhar com imagens (redimensionamento, otimiza√ß√£o etc.) e ... um servi√ßo separado para soquetes da Web, escrito em D Todos os arquivos de configura√ß√£o (nginx-conf, php-conf ...) tamb√©m se tornaram parte da base de c√≥digo do projeto. <br><br>  Consequentemente, o ambiente local foi completamente "recriado", completamente id√™ntico √† infraestrutura atual do servidor.  Assim, o tempo necess√°rio para manter o mesmo ambiente nas m√°quinas locais dos desenvolvedores e no produto foi reduzido.  O que, por sua vez, ajudou bastante a evitar problemas completamente desnecess√°rios causados ‚Äã‚Äãpelas configura√ß√µes locais auto-escritas de cada desenvolvedor. <br><br>  Como resultado, os seguintes servi√ßos foram criados no ambiente de composi√ß√£o de encaixe: <br><br><ul><li>  Web para aplica√ß√£o php-fpm; </li><li>  nginx; </li><li>  impproxy e cairosvg (servi√ßos para trabalhar com imagens); </li><li>  postgres </li><li>  redis; </li><li>  busca el√°stica; </li><li>  trompete (o mesmo servi√ßo para os soquetes da web em D). </li></ul><br>  Do ponto de vista dos desenvolvedores, o trabalho com a base de c√≥digo permaneceu inalterado - ele foi montado nos servi√ßos necess√°rios de um diret√≥rio separado (o reposit√≥rio base com o c√≥digo do site) nos servi√ßos necess√°rios: o diret√≥rio p√∫blico no servi√ßo nginx, todo o c√≥digo do aplicativo php no servi√ßo php-fpm.  No diret√≥rio separado (que cont√©m todas as configura√ß√µes do ambiente de composi√ß√£o), os arquivos de configura√ß√£o correspondentes s√£o montados nos servi√ßos nginx e php-fpm.  Diret√≥rios com postgres de dados, elasticsearch e redis tamb√©m s√£o montados na m√°quina local do desenvolvedor, de modo que, se todos os cont√™ineres precisarem ser reconstru√≠dos / exclu√≠dos, os dados nesses servi√ßos n√£o ser√£o perdidos. <br><br>  Para trabalhar com os logs de aplicativos - tamb√©m no ambiente de docker-compose - os servi√ßos da pilha ELK foram aumentados.  Anteriormente, parte dos logs do aplicativo era gravada no padr√£o / var / log / ..., os logs e execu√ß√µes do aplicativo php eram escritos no Sentry, e essa op√ß√£o de armazenamento de logs "descentralizado" era extremamente inconveniente para trabalhar.  Agora, aplicativos e servi√ßos foram configurados e refinados para interagir com a pilha ELK.  O uso de logs ficou muito mais f√°cil; os desenvolvedores agora t√™m uma interface conveniente para pesquisar e filtrar logs.  No futuro (j√° no cubo) - voc√™ pode assistir os logs de uma vers√£o espec√≠fica do aplicativo (por exemplo, um kronzhoba lan√ßado anteontem). <br><br>  Al√©m disso, a equipe da Rep√∫blica iniciou um curto per√≠odo de adapta√ß√£o.  A equipe precisava entender e aprender a trabalhar no novo paradigma de desenvolvimento, no qual o seguinte deve ser considerado: <br><br><ol><li>  Os aplicativos ficam sem estado e podem perder dados a qualquer momento; portanto, o trabalho com bancos de dados, sess√µes e arquivos est√°ticos deve ser criado de maneira diferente.  As sess√µes PHP devem ser armazenadas centralmente e compartilhadas entre todas as inst√¢ncias de aplicativos.  Pode continuar a ser arquivos, mas o redis √© usado com mais frequ√™ncia para esses fins, devido √† sua maior facilidade de gerenciamento.  Os cont√™ineres para bancos de dados devem "montar" um datadir ou o banco de dados deve ser executado fora da infraestrutura do cont√™iner. </li><li>  Um armazenamento de arquivos de cerca de 50 a 60 GB de imagens n√£o deve estar "dentro do aplicativo da web".  Para tais fins, √© necess√°rio usar algum armazenamento externo, sistemas cdn etc. </li><li>  Todos os aplicativos (bancos de dados, servidores de aplicativos ...) agora s√£o "servi√ßos" separados, e a intera√ß√£o entre eles deve ser configurada em rela√ß√£o ao novo espa√ßo para nome. </li></ol><br>  Depois que a equipe de desenvolvimento da Rep√∫blica se acostumou √†s inova√ß√µes, come√ßamos a transferir a infraestrutura de vendas da publica√ß√£o para o Kubernetes. <br><br><h3>  E aqui est√° o Kubernetes </h3><br>  Com base no ambiente docker-compondo criado para o desenvolvimento local, come√ßamos a traduzir o projeto em um "cubo".  Todos os servi√ßos em que o projeto √© constru√≠do localmente, "empacotamos em cont√™ineres": organizamos um procedimento linear e compreens√≠vel para a cria√ß√£o de aplicativos, armazenamento de configura√ß√µes, compila√ß√£o de est√°tica.  Do ponto de vista do desenvolvimento, eles removeram os par√¢metros de configura√ß√£o necess√°rios em vari√°veis ‚Äã‚Äãde ambiente, come√ßaram a armazenar sess√µes n√£o em arquivos, mas em rabanetes.  Criamos o ambiente de teste, onde implantamos uma vers√£o vi√°vel do site. <br><br>  Como esse √© um projeto monol√≠tico anterior, √© √≥bvio que havia um relacionamento dif√≠cil entre as vers√µes front-end e back-end, respectivamente, e esses dois componentes foram implantados ao mesmo tempo.  Portanto, decidimos criar os pods do aplicativo Web de forma que dois cont√™ineres girassem em um pod: php-fpm e nginx. <br><br>  Tamb√©m constru√≠mos o dimensionamento autom√°tico para que os aplicativos da Web dimensionados para um m√°ximo de 12 no pico do tr√°fego, definam certos testes de disponibilidade / disponibilidade, porque o aplicativo leva pelo menos 2 minutos para ser executado (j√° que voc√™ precisa aquecer o cache, gerar configura√ß√µes ...) <br><br>  Imediatamente, √© claro, havia todos os tipos de cardumes e nuances.  Por exemplo: a estat√≠stica est√°tica compilada era necess√°ria tanto para o servidor da web que a distribuiu quanto para o servidor de aplicativos no fpm, que em algum lugar em tempo real gerava algum tipo de imagem, em algum lugar o svg fornecia diretamente ao c√≥digo.  Percebemos que, para n√£o se levantar duas vezes, precisamos criar um cont√™iner de constru√ß√£o intermedi√°rio e contornar a montagem final por meio de v√°rios est√°gios.  Para fazer isso, criamos v√°rios cont√™ineres intermedi√°rios, em cada um dos quais as depend√™ncias s√£o extra√≠das separadamente, as estat√≠sticas (css e js) s√£o coletadas separadamente e, em seguida, em dois cont√™ineres - no nginx e no fpm - elas s√£o copiadas do cont√™iner de constru√ß√£o intermedi√°rio. <br><br><h3>  Come√ßamos </h3><br>  Para trabalhar com arquivos na primeira itera√ß√£o, criamos um diret√≥rio comum sincronizado com todas as m√°quinas em funcionamento.  Com a palavra "sincronizado", quero dizer aqui exatamente o que voc√™ pode pensar com horror em primeiro lugar - sincronizar em c√≠rculo.  Obviamente, uma m√° decis√£o.  Como resultado, obtivemos todo o espa√ßo em disco no GlusterFS, configuramos o trabalho com imagens para que elas estivessem sempre acess√≠veis em qualquer m√°quina e nada diminu√≠sse a velocidade.  Para a intera√ß√£o de nossos aplicativos com sistemas de armazenamento (postgres, elasticsearch, redis), os servi√ßos externalName foram criados no k8s, de modo que, por exemplo, no caso de uma mudan√ßa urgente para o banco de dados de backup, atualize os par√¢metros de conex√£o em um √∫nico local. <br><br>  Todo o trabalho com crones foi levado para as novas entidades do k8s - cronjob, que podem ser executadas de acordo com uma programa√ß√£o espec√≠fica. <br><br>  Como resultado, obtivemos esta arquitetura: <br><br> <a href=""><img src="https://habrastorage.org/webt/q4/-1/f9/q4-1f9u514-psd-2yfkn5pg74j0.jpeg"></a> <br>  <i>Clic√°vel</i> <br><br><h3>  Oh dif√≠cil </h3><br>  Este foi o lan√ßamento da primeira vers√£o, pois, paralelamente √† completa reestrutura√ß√£o da infraestrutura, o site ainda estava passando por uma reformula√ß√£o.  Parte do site foi constru√≠da com alguns par√¢metros - para est√°tica e tudo mais, e parte - com outros.  L√° era necess√°rio ... para dizer o m√≠nimo ... perverter com todos esses cont√™ineres de v√°rios est√°gios, copiar dados deles em uma ordem diferente, etc. <br><br>  Tamb√©m tivemos que dan√ßar com pandeiros em todo o sistema CI \ CD para ensinar tudo isso a implantar e controlar de diferentes reposit√≥rios e de diferentes ambientes.  Afinal, √© necess√°rio controle constante sobre as vers√µes do aplicativo para que voc√™ possa entender quando um servi√ßo ou outro servi√ßo foi implantado e com qual vers√£o do aplicativo um ou outro erro foi iniciado.  Para fazer isso, configuramos o sistema de registro correto (bem como a pr√≥pria cultura de registro) e implementamos o ELK.  Os colegas aprenderam a definir certos seletores, ver qual cron gera quais erros, como geralmente √© executado, porque no "cubo" ap√≥s a execu√ß√£o do cont√™iner de cron, voc√™ n√£o mais entrar√° nele. <br><br>  Mas a coisa mais dif√≠cil para n√≥s foi refazer e revisar toda a base de c√≥digo. <br><br>  Deixe-me lembr√°-lo, Republic √© um projeto que agora tem 10 anos.  Come√ßou com uma equipe, outra est√° se desenvolvendo agora e √© realmente dif√≠cil colocar todos os c√≥digos-fonte para poss√≠veis bugs e erros.  √â claro que, neste momento, nossa equipe de desembarque de quatro homens conectou os recursos do restante da equipe: clicamos e testamos o site inteiro com testes, mesmo nas se√ß√µes que vivem pessoas que n√£o visitavam desde 2016. <br><br><h3>  N√£o falha em nenhum lugar </h3><br>  Na segunda-feira, de manh√£ cedo, quando as pessoas foram ao correio em massa com um resumo, todos n√≥s temos uma estaca.  O culpado foi encontrado rapidamente: o cronjob come√ßou e come√ßou a enviar cartas freneticamente a todos que queriam receber uma sele√ß√£o de not√≠cias na semana passada, devorando os recursos de todo o cluster ao longo do caminho.  Como n√£o suportamos esse comportamento, colocamos rapidamente limites r√≠gidos em todos os recursos: quanto processador e mem√≥ria um cont√™iner pode consumir e assim por diante. <br><br><h3>  Como lidou a equipe de desenvolvedores da Rep√∫blica </h3><br>  Nossas atividades trouxeram muitas mudan√ßas e n√≥s entendemos isso.  De fato, n√£o apenas redesenhamos a infraestrutura da publica√ß√£o, em vez do pacote habitual de "servidor de backup principal", implementamos uma solu√ß√£o de cont√™iner que conecta recursos adicionais conforme necess√°rio, mas alteramos completamente a abordagem para desenvolvimento adicional. <br><br>  Depois de algum tempo, os caras come√ßaram a entender que isso n√£o est√° funcionando diretamente com o c√≥digo, mas com um aplicativo abstrato.  Dado os processos de CI \ CD (criados no Jenkins), eles come√ßaram a escrever testes, obtiveram ambientes completos para desenvolvedores de est√°gio em desenvolvimento, onde podem testar novas vers√µes de seus aplicativos em tempo real, ver onde tudo cai e aprender a viver. novo mundo ideal. <br><br><h3>  O que o cliente recebeu </h3><br>  Primeiro de tudo, a Republic finalmente conseguiu um processo de implanta√ß√£o controlado!  Costumava ser: na Rep√∫blica, uma pessoa respons√°vel foi ao servidor, iniciou tudo manualmente, depois coletou est√°tica, verificou com as m√£os que nada havia ca√≠do ... Agora, o processo de implanta√ß√£o √© constru√≠do para que os desenvolvedores se envolvam no desenvolvimento e n√£o percam tempo com mais nada .  E a pessoa respons√°vel agora tem uma tarefa - monitorar como foi o lan√ßamento em geral. <br><br>  Depois que ocorre um envio para a filial principal, automaticamente ou por uma implanta√ß√£o de "bot√£o" (periodicamente, devido a certos requisitos de neg√≥cios, a implanta√ß√£o autom√°tica √© desativada), Jenkins entra em conflito: a montagem do projeto come√ßa.  Primeiro, todos os cont√™ineres do docker s√£o montados: depend√™ncias (compositor, fio, npm) s√£o instaladas nos cont√™ineres preparat√≥rios, o que permite acelerar o processo de constru√ß√£o se a lista de bibliotecas necess√°rias n√£o tiver sido alterada durante a implanta√ß√£o;  depois, os cont√™ineres para php-fpm, nginx e outros servi√ßos s√£o coletados, nos quais, por analogia com o ambiente de composi√ß√£o de encaixe, apenas as partes necess√°rias da base de c√≥digo s√£o copiadas.  Depois disso, os testes s√£o iniciados e, no caso de aprova√ß√£o bem-sucedida, h√° um envio de imagens para o armazenamento particular e, de fato, implementando implanta√ß√µes no cubador. <br><br>  Gra√ßas √† transfer√™ncia da Rep√∫blica para o k8s, obtivemos uma arquitetura usando um cluster de tr√™s m√°quinas reais nas quais at√© doze c√≥pias do aplicativo da web podem "girar" ao mesmo tempo.  Ao mesmo tempo, o pr√≥prio sistema, com base nas cargas atuais, decide quantas c√≥pias ele precisa no momento.  Tiramos a Republic da loteria ‚Äúfunciona - n√£o funciona‚Äù com servidores est√°ticos e de backup e constru√≠mos um sistema flex√≠vel para eles, pronto para um aumento semelhante √† avalanche na carga no site. <br><br>  Nesse momento, pode surgir a pergunta: "pessoal, voc√™s trocaram dois peda√ßos de ferro pelos mesmos peda√ßos de ferro, mas com a virtualiza√ß√£o, qual √© o ganho, voc√™s est√£o bem a√≠?"  E, claro, ser√° l√≥gico.  Mas apenas em parte.  Como resultado, n√£o temos apenas pe√ßas de hardware com virtualiza√ß√£o.  Temos um ambiente de trabalho est√°vel, o mesmo em alimentos e virgem.  Um ambiente gerenciado centralmente para todos os participantes do projeto.  Temos um mecanismo para montar o projeto inteiro e lan√ßar lan√ßamentos, novamente, o mesmo para todos.  Temos um sistema de orquestra√ß√£o de projeto conveniente.  Assim que a equipe da Republic percebe que geralmente deixa de ter recursos atuais suficientes e os riscos de cargas ultra-altas (ou quando isso j√° aconteceu e tudo se acalmou), eles apenas pegam outro servidor, em 10 minutos implementam a fun√ß√£o de um n√≥ de cluster e op-op tudo √© lindo e bom de novo.  A estrutura anterior do projeto n√£o sugeria tal abordagem; n√£o havia solu√ß√µes lentas nem r√°pidas para esses problemas. <br><br>  Em segundo lugar, uma implanta√ß√£o perfeita apareceu: o visitante acessar√° a vers√£o antiga do aplicativo ou uma nova.  E n√£o como antes, quando o conte√∫do poderia ser novo, mas os estilos s√£o antigos. <br>  Como resultado, os neg√≥cios est√£o satisfeitos: todo tipo de coisa nova agora pode ser feita mais rapidamente e com mais frequ√™ncia. <br>  No total, de "mas vamos tentar" a "pronto", o trabalho no projeto levou 2 meses.  A equipe de nossa parte √© um desembarque her√≥ico de quatro pessoas + suporte para a "base" durante a verifica√ß√£o de c√≥digo e testes. <br><br><h3>  O que os usu√°rios obtiveram </h3><br>  E os visitantes, em princ√≠pio, n√£o viram as mudan√ßas.  O processo de implanta√ß√£o da estrat√©gia do RollingUpdate √© constru√≠do "perfeitamente".  A implanta√ß√£o de uma nova vers√£o do site n√£o prejudica os usu√°rios, a nova vers√£o do site, at√© que os testes sejam aprovados e os testes de disponibilidade / disponibilidade, n√£o estar√£o dispon√≠veis.  Eles apenas veem que o site est√° funcionando e n√£o vai cair depois de publicar artigos legais.  Qual, em geral, √© o que qualquer projeto precisa. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt439458/">https://habr.com/ru/post/pt439458/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt439446/index.html">O que voc√™ precisa saber sobre o JavaScript Engine Switcher 3.0</a></li>
<li><a href="../pt439448/index.html">Que perguntas sobre virtualiza√ß√£o voc√™ espera uma resposta de um graduado?</a></li>
<li><a href="../pt439450/index.html">RS-485 em microcontroladores dom√©sticos da empresa Milander</a></li>
<li><a href="../pt439454/index.html">Programa como Arte - Um Novo Paradigma de Gerenciamento de Software</a></li>
<li><a href="../pt439456/index.html">Hipster Podcasts # 2</a></li>
<li><a href="../pt439460/index.html">Como os profissionais de marketing da Maksidoma perdem milh√µes por exibir o marketing de crescimento: auditoria independente de usabilidade</a></li>
<li><a href="../pt439462/index.html">Civiliza√ß√£o da Primavera, 5/5</a></li>
<li><a href="../pt439464/index.html">VXinspect: controle de qualidade da pe√ßa em 10 minutos</a></li>
<li><a href="../pt439466/index.html">A sonda em √≥rbita lunar da NASA tirou as primeiras fotos da esta√ß√£o chinesa Chang'e-4 - dois pixels de luz</a></li>
<li><a href="../pt439468/index.html">Onde a busca pelo SCADA perfeito leva</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>