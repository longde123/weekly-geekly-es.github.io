<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü¶ì üë©üèø‚Äçüç≥ ü•ï Shadowplay LED Watch en la plataforma Arduino Uno ‚ôªÔ∏è ‚õ±Ô∏è üë®üèΩ‚Äçüé®</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="En lugar de unirse
 
 
 Entonces, nuestro equipo de tres personas ten√≠a la tarea: armar un peque√±o proyecto de hardware en muy poco tiempo, preferible...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Shadowplay LED Watch en la plataforma Arduino Uno</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/394107/"><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En lugar de unirse</font></font></h3><br>
<img src="https://habrastorage.org/files/48b/451/4a6/48b4514a6fd144ba8e19798a1588bd87.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Entonces, nuestro equipo de tres personas ten√≠a la tarea: armar un peque√±o proyecto de hardware en muy poco tiempo, preferiblemente en la plataforma Arduino. </font><font style="vertical-align: inherit;">Vale la pena mencionar que hasta ese momento est√°bamos familiarizados con los circuitos, en su mayor parte, en teor√≠a. </font><font style="vertical-align: inherit;">Y esto significa: ni experiencia con un soldador (pr√°cticamente), ni, especialmente, experiencia con Arduino. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De repente nos topamos con </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">un art√≠culo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dedicado al proyecto Shadowplay Clock. </font><font style="vertical-align: inherit;">Este es un reloj de pared dise√±ado por un equipo de dise√±adores vieneses, el momento en el que puedes ver tocando un dedo en su centro. </font><font style="vertical-align: inherit;">Los LED se iluminan de tal manera que la sombra del dedo en el centro muestra la hora. </font><font style="vertical-align: inherit;">Se decidi√≥ crear lo mismo (o muy similar), pero en casa. </font><font style="vertical-align: inherit;">El art√≠culo anterior, como puede ver, no contiene una descripci√≥n detallada del proyecto. </font><font style="vertical-align: inherit;">De todo esto se dedujo que nosotros mismos ten√≠amos que descubrir c√≥mo funciona este dispositivo y darle vida. </font><font style="vertical-align: inherit;">Lo que, de hecho, hicimos.</font></font><br>
<a name="habracut"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Materiales</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para crear un reloj necesitas:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> espacios en blanco de fibra de madera</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Tira de 60 diodos LED</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Arduino uno</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> M√≥dulo de reloj de tiempo real RTC DS1307</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> bot√≥n</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> protoboard</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> registro de desplazamiento 74HC595 (x2)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Pestillo de registro de 8 bits 74HC573N (x8)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> decodificador 4-16 K155ID3 </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> inversor de drenaje abierto IN74HC05AN (x10)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> unidad de potencia </font></font></li>
</ul><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Empecemos</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Entonces, el algoritmo del dispositivo:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cuando se aplica energ√≠a, los LED se encienden en una combinaci√≥n predeterminada. </font><font style="vertical-align: inherit;">En el Shadowplay original, todos los LED se encendieron, pero nos pareci√≥ que ser√≠a m√°s interesante lanzar alguna combinaci√≥n como protector de pantalla.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cuando se presiona el bot√≥n (s√≠, tambi√©n nos alejamos del original e insertamos un peque√±o bot√≥n en el centro), el tiempo se lee desde el m√≥dulo RTC.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El tiempo de lectura se convierte en c√≥digo binario (m√°scara) y se ingresa en los registros.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dependiendo de la m√°scara, se enciende el diodo requerido.</font></font></li>
</ol><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hardware</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cuando finalmente decidimos la idea del proyecto, lo primero que intentamos fue esbozar mentalmente versiones aproximadas de los esquemas para su implementaci√≥n. La pregunta principal era c√≥mo abordar 60 LED. De hecho, la respuesta a esta pregunta determin√≥ el m√©todo de construcci√≥n de casi todo el esquema. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La primera opci√≥n que me vino a la mente fue el uso de decodificadores. El circuito compilado era una cascada de cuatro decodificadores 4-16 y un decodificador 2-4, ambos con entradas habilitadas para descifrado. Tal cascada permiti√≥ el direccionamiento a 64 salidas, lo que fue m√°s que suficiente para conectar 60 LED.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sin embargo, surgi√≥ la pregunta de c√≥mo hacer que m√°s de un LED funcione (direcci√≥n) al mismo tiempo (despu√©s de todo, necesit√°bamos proporcionar al reloj al menos las manecillas de los minutos y del reloj). Aqu√≠ se manifest√≥ el principal inconveniente de este esquema: el decodificador no puede, por definici√≥n, abordar m√°s de una salida a la vez. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Este defecto nos oblig√≥ a abandonar la idea con una cascada de decodificadores. Adem√°s, ahora tenemos otro requisito para el futuro circuito: soporte para la operaci√≥n simult√°nea de un n√∫mero diferente de LED.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para satisfacer este requisito, pensamos que es posible habilitar cada LED para almacenar su estado. Los registros son adecuados para este prop√≥sito, donde cada descarga individual corresponde al estado de uno de los LED. Decidimos usar registros de 8 bits, ya que son m√°s comunes y m√°s pr√°cticos. En consecuencia, en nuestro circuito necesitaremos 8 de estos registros para proporcionar soporte para 60 LED.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Luego, pensamos en c√≥mo controlar el estado de los LED con Arduino a trav√©s de registros. Cada registro para el funcionamiento normal debe recibir los 8 bits en su totalidad. Arduino Uno, por supuesto, proporciona suficientes salidas para transmitir varios bits a la vez, pero este enfoque no ser√° racional. Adem√°s, el esquema contiene solo 8 registros, lo que significa que debe abordarlos de alguna manera. Para este prop√≥sito, agregamos un decodificador y dos registros de desplazamiento de 8 bits conectados en cascada al circuito. Un registro de desplazamiento almacena una m√°scara de estado de 8 bits, que se cargar√° en uno de los 8 registros regulares, cuyo n√∫mero se almacena en el segundo registro de desplazamiento. En consecuencia, un decodificador est√° conectado al segundo registro de desplazamiento. Para estos fines, un decodificador de 3 por 8 es suficiente.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para eliminar la inversi√≥n del n√∫mero requerido de salidas, utilizamos dos circuitos inversores KR1533LN1. Esto, por supuesto, complica un poco el esquema. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Otra tarea era el voltaje de funcionamiento de los LED igual a 12 voltios en comparaci√≥n con los 5 voltios de los circuitos l√≥gicos. La soluci√≥n propuesta fue utilizar un inversor de drenaje abierto. Tal microcircuito desempe√±a el papel de una tecla que cierra (con 1 l√≥gico) o abre (con 0 l√≥gico) uno de los contactos del LED con la tierra, por lo que enciende o apaga el LED. El circuito asume una operaci√≥n de 12 voltios, de acuerdo con el voltaje de funcionamiento de los LED, por lo que para obtener 5 voltios para circuitos l√≥gicos, se agreg√≥ al circuito el estabilizador KR142EN5A con dos condensadores.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Algunas entradas de ciertos microcircuitos implican un valor constante en la entrada, por lo que se conectaron a tierra o a una fuente de alimentaci√≥n. </font><font style="vertical-align: inherit;">En este caso, estas son las siguientes entradas:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La entrada inversa de restablecimiento de MR en ambos registros de desplazamiento est√° conectada a trav√©s del registro de carga a la salida del estabilizador a 5 voltios.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La entrada de habilitaci√≥n de salida de OE inversa en ambos registros de desplazamiento est√° conectada directamente a tierra.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Decodificador inverso habilitar entrada E0 conectado a tierra</font></font></li>
</ul><br>
<br>
<img src="https://habrastorage.org/files/994/7dc/3c6/9947dc3c61754b44b034f4670f846fbc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El circuito est√° controlado por cuatro entradas (E1, SH, ST, DS). </font><font style="vertical-align: inherit;">El prop√≥sito y los niveles de se√±al de cada uno de ellos se analizan con m√°s detalle a continuaci√≥n:</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La entrada E1 est√° dise√±ada para habilitar el decodificador. En nuestro caso, inicialmente en el decodificador hay dos entradas de control E1, E0, y ambas son inversas. Habr√° suficiente una salida, por lo que la segunda (E0) puede llevarse al suelo. El estado del decodificador "predeterminado" es operativo hasta que se aplique un nivel de se√±al alto a E1. Para hacer lo contrario, conectamos esta entrada al inversor. Sin esto, el decodificador puede dar se√±ales de control incorrectas a los registros, por ejemplo, al momento de actualizar los datos en el registro de desplazamiento. Como ya se mencion√≥, se puede usar un decodificador de 3 por 8 en el circuito, que puede tener una entrada de control no inversa, lo que facilitar√° la resoluci√≥n de todos los problemas descritos anteriormente sin cables adicionales y un soldador.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cuando se aplica un solo nivel de se√±al a E1, el decodificador decodifica la direcci√≥n de registro ubicada en el registro de desplazamiento correspondiente y env√≠a una se√±al a la salida deseada. Despu√©s de eso, el decodificador se apaga nuevamente aplicando un nivel de se√±al bajo a E1. Tal interruptor del decodificador genera una se√±al en la salida deseada, cuyo borde y decaimiento sirve como un pulso de reloj de registro para ajustar en s√≠ mismo los datos almacenados en el bus.</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Las siguientes tres entradas ya est√°n destinadas a controlar los registros de desplazamiento. Vale la pena comenzar con lo m√°s simple: la entrada de datos DS. Esta entrada, como su nombre lo indica, est√° destinada a la transmisi√≥n de datos. Dado que los registros de desplazamiento en el circuito est√°n conectados en cascada, el DS representa la salida correspondiente de uno de ellos. La entrada del segundo registro de desplazamiento est√° conectada a la salida del √∫ltimo bit del primer registro. El resultado es un registro de desplazamiento para 16 bits, de los cuales solo se utilizan 12 bits. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La entrada SH es una entrada de reloj. Se alimenta una onda cuadrada a esta entrada, que es responsable de cargar y cambiar los datos en cada uno de los registros, respectivamente, este contacto del circuito est√° conectado a los pines SHCP de ambos registros.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El √∫ltimo pin ST sirve como un pestillo de datos en las salidas del registro. Se da un impulso a esta entrada, sin embargo, solo se suministra cuando los datos en el registro de desplazamiento se cargan finalmente y se requiere fijarlos en la salida de los registros. Solo despu√©s de dar esta se√±al, los datos descargados dentro del registro en la primera fila de disparadores llegan a la segunda fila de disparadores y est√°n disponibles en el bus. ST es un pin conectado a los pines STcp de ambos registros. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Queda por explicar el cableado de los dos pines de los registros de desplazamiento MR y OE. La primera entrada (MR) es responsable de descargar los datos dentro del registro. En este circuito, no se requiere dicha oportunidad, por lo tanto, se suministra un alto nivel de se√±al a esta salida a trav√©s de la carga.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La segunda entrada de registro (OE) es responsable de desconectar la segunda fila de disparadores dentro del registro de desplazamiento del bus, es decir, la entrada de habilitaci√≥n. </font><font style="vertical-align: inherit;">Esta funci√≥n tampoco es necesaria, por lo tanto, la salida se enrolla en el suelo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Otro contacto no descrito anteriormente est√° dise√±ado para eliminar el nivel de se√±al del bot√≥n en el centro del reloj, el diagrama de botones es t√≠pico y representa una carga y una tecla, dependiendo de la posici√≥n de la cual se env√≠a un nivel de se√±al bajo o alto al Arduino. </font><font style="vertical-align: inherit;">Dependiendo del estado del bot√≥n, el reloj funciona en modo de protector de pantalla o en modo de visualizaci√≥n de la hora.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La conexi√≥n al Arduino no tiene caracter√≠sticas especiales, excepto que el pin SH est√° idealmente conectado al pin digital SCK. </font><font style="vertical-align: inherit;">El resto de las salidas del circuito se pueden conectar a cualquiera de las entradas digitales de uso general disponibles. </font><font style="vertical-align: inherit;">En nuestro caso, la conexi√≥n tiene la siguiente forma:</font></font><br>
<br>
<ul>
<li>Arduino pin13 (SCK) ‚Äì   SH</li>
<li>Arduino pin 11 ‚Äì   ST Arduino pin 8 ‚Äì   DS Arduino pin 5 ‚Äì   E1 Arduino pin 3 ‚Äì   Arduino pin GND ‚Äì   (      )<br>
       ,      .<br>
<br>
    :   36  ‚Äî   ;    36  ( ) \ 26  ( ) ‚Äî  .   Shadowplay    72 ,     36.     ,    60  ( + ).     .   ,   ,     ,      .<br>
<br>
<img src="https://habrastorage.org/files/c46/3ff/f0b/c463fff0b95e402eaf9b4274301f04ba.jpg"><br>
<br>
  ,     .      ,    .   ,      .      ,  ¬´¬ª    50 ‚Äî 60,        . , 60   .  :      ‚Äî   .<br>
<br>
<img src="https://habrastorage.org/files/871/643/435/87164343503642ba802ead947d81ab6a.JPG"><br>
<br>
   ,  ,    ,  .      ‚Äî     . ,         ,    .  ,   ‚Äî  .<br>
<br>
<div class="spoiler"><b class="spoiler_title">      .</b><div class="spoiler_text"><img src="https://habrastorage.org/files/f95/9cc/f6d/f959ccf6d1c34b58ac31411eb3477a99.jpg"><br>
</div></div><br>
-,  .<br>
<br>
     Shadowplay.  ,       ,    . ,    ,       .      , ..     .        ,  ,       100% .    ,       .       .     ,         .  ,               .<br>
<br>
 ,      (       ),     ,    ‚Äî    . ,  ,   !    .   ,  - -   . ,   ,    .             ,     ,           .   ,     ,    ,   .     .,     -         .    ,      ,   , ,   ,     . <br>
<br>
<iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://www.youtube.com/embed/uy-cLHOz-5M%3Ffeature%3Doembed&amp;usg=ALkJrhh0-2guFtoCKHl-zh1qEc25k1CWNw" frameborder="0" allowfullscreen=""></iframe><br>
<br>
 ,     .         . ..   ,     , ( ,      ,         ),      . <br>
<br>
<h4> </h4><br>
,     ().      Arduino.  ,    RTC,   ‚Äî    .      DS1307,   ‚Äî I2C.       2100     .          .     RTC  Arduino,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="> </a>.         RTC.<br>
<br>
<img src="https://habrastorage.org/files/c76/129/084/c761290840164f52a699e8f7d0c23a50.jpg"><br>
<br>
     ,      RTC,         .<br>
<br>
<div class="spoiler"><b class="spoiler_title"></b><div class="spoiler_text"> <pre><code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;Time.h&gt;</span></span></span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;DS1307RTC.h&gt;</span></span></span></span><font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">char</span></span> REG [<span class="hljs-number"><span class="hljs-number">8</span></span>];<font></font>
tmElements_t te;<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> c,reset=<span class="hljs-number"><span class="hljs-number">1</span></span>;<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setup</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{<font></font>
  pinMode(<span class="hljs-number"><span class="hljs-number">13</span></span>, OUTPUT); <font></font>
  pinMode(<span class="hljs-number"><span class="hljs-number">11</span></span>, OUTPUT); <font></font>
  pinMode(<span class="hljs-number"><span class="hljs-number">8</span></span>, OUTPUT);  <font></font>
  pinMode(<span class="hljs-number"><span class="hljs-number">5</span></span>, OUTPUT);  <font></font>
  pinMode(<span class="hljs-number"><span class="hljs-number">3</span></span>, INPUT);   <font></font>
  Serial.begin(<span class="hljs-number"><span class="hljs-number">57600</span></span>);<font></font>
  <font></font>
  <span class="hljs-comment"><span class="hljs-comment">//      RTC  </span></span>
  <span class="hljs-comment"><span class="hljs-comment">//te.Hour = 18;</span></span>
  <span class="hljs-comment"><span class="hljs-comment">//te.Minute = 50;</span></span>
  <span class="hljs-comment"><span class="hljs-comment">//te.Second = 0;</span></span>
  <span class="hljs-comment"><span class="hljs-comment">//te.Day = 20; //</span></span>
  <span class="hljs-comment"><span class="hljs-comment">//te.Month = 4; // </span></span>
  <span class="hljs-comment"><span class="hljs-comment">//te.Year = CalendarYrToTm(2016); </span></span>
  <span class="hljs-comment"><span class="hljs-comment">//RTC.write(te);</span></span><font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">
</span></span>{ 
<span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(digitalRead(<span class="hljs-number"><span class="hljs-number">3</span></span>))                    <span class="hljs-comment"><span class="hljs-comment">// ,     </span></span><font></font>
  {RTC.read(te);<font></font>
   SetShadowTime(te.Hour,te.Minute,te.Second,<span class="hljs-number"><span class="hljs-number">2</span></span>);        <span class="hljs-comment"><span class="hljs-comment">//         </span></span>
   delay(<span class="hljs-number"><span class="hljs-number">900</span></span>);<font></font>
   reset=<span class="hljs-number"><span class="hljs-number">1</span></span>;<font></font>
  }<font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">else</span></span>                                   <span class="hljs-comment"><span class="hljs-comment">//    ,  </span></span><font></font>
  {wait1();<font></font>
   reset=<span class="hljs-number"><span class="hljs-number">1</span></span>;<font></font>
  }<font></font>
                                         <span class="hljs-comment"><span class="hljs-comment">//  </span></span>
  <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> j = <span class="hljs-number"><span class="hljs-number">0</span></span>; j&lt;<span class="hljs-number"><span class="hljs-number">8</span></span> ; j++) SetUpLightByMask(j,<span class="hljs-number"><span class="hljs-number">0</span></span>); <font></font>
   <font></font>
 <font></font>
}<font></font>
<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//======================================================================= </span></span><font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SetUpLightByMask</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> RegNum, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> LightMask)</span></span></span><span class="hljs-function"> </span><span class="hljs-comment"><span class="hljs-function"><span class="hljs-comment">//         </span></span></span><span class="hljs-function">
</span></span>{<font></font>
  <font></font>
  digitalWrite(<span class="hljs-number"><span class="hljs-number">5</span></span>, LOW);<font></font>
  digitalWrite(<span class="hljs-number"><span class="hljs-number">11</span></span>, LOW);<font></font>
  shiftOut(<span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, MSBFIRST, LightMask);<font></font>
  shiftOut(<span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, LSBFIRST, RegNum);<font></font>
  digitalWrite(<span class="hljs-number"><span class="hljs-number">11</span></span>, HIGH);<font></font>
  digitalWrite(<span class="hljs-number"><span class="hljs-number">5</span></span>, HIGH);<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">digitalClockDisplay</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{  <span class="hljs-comment"><span class="hljs-comment">//    RTC  ,    RTC  </span></span><font></font>
  RTC.read(te);<font></font>
  Serial.print(te.Hour);<font></font>
  Serial.print(<span class="hljs-string"><span class="hljs-string">" : "</span></span>);<font></font>
  Serial.print(te.Minute);<font></font>
  Serial.print(<span class="hljs-string"><span class="hljs-string">" :"</span></span>);<font></font>
  Serial.print(te.Second);<font></font>
  Serial.print(<span class="hljs-string"><span class="hljs-string">" "</span></span>);<font></font>
  Serial.print(te.Day);<font></font>
  Serial.print(<span class="hljs-string"><span class="hljs-string">" "</span></span>);<font></font>
  Serial.print(te.Month);<font></font>
  Serial.print(<span class="hljs-string"><span class="hljs-string">" "</span></span>);<font></font>
  Serial.print(tmYearToCalendar(te.Year));<font></font>
  Serial.println();<font></font>
}<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//     ,     , ,        :</span></span>
<span class="hljs-comment"><span class="hljs-comment">//0 -  ,1 -   , 2 -    </span></span><font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SetShadowTime</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Hours, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Minutes, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Seconds, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> param)</span></span></span></span>{   
  <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> h,hshift,m,s;
  <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> j = <span class="hljs-number"><span class="hljs-number">0</span></span>; j&lt;<span class="hljs-number"><span class="hljs-number">8</span></span> ; j++) REG[j] = <span class="hljs-number"><span class="hljs-number">0</span></span>;<font></font>
<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(Hours &gt;= <span class="hljs-number"><span class="hljs-number">12</span></span>) Hours -= <span class="hljs-number"><span class="hljs-number">12</span></span>;<font></font>
  h = Hours + <span class="hljs-number"><span class="hljs-number">6</span></span>;
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(h &gt;= <span class="hljs-number"><span class="hljs-number">12</span></span>) h -= <span class="hljs-number"><span class="hljs-number">12</span></span>;<font></font>
    <font></font>
  hshift = (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>) Minutes / <span class="hljs-number"><span class="hljs-number">12</span></span>;<font></font>
  <font></font>
  REG[(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)(((h*<span class="hljs-number"><span class="hljs-number">5</span></span>)+hshift)/<span class="hljs-number"><span class="hljs-number">8</span></span>)] = REG[(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)(((h*<span class="hljs-number"><span class="hljs-number">5</span></span>)+hshift)/<span class="hljs-number"><span class="hljs-number">8</span></span>)] | <span class="hljs-number"><span class="hljs-number">1</span></span>&lt;&lt;(((h*<span class="hljs-number"><span class="hljs-number">5</span></span>)+hshift)%<span class="hljs-number"><span class="hljs-number">8</span></span>);<font></font>
             <font></font>
   <font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(param == <span class="hljs-number"><span class="hljs-number">1</span></span>)<font></font>
  {m = Minutes + <span class="hljs-number"><span class="hljs-number">30</span></span>;
   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(m &gt;= <span class="hljs-number"><span class="hljs-number">60</span></span>) m -= <span class="hljs-number"><span class="hljs-number">60</span></span>;<font></font>
   REG[(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)(m/<span class="hljs-number"><span class="hljs-number">8</span></span>)] = REG[(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)(m/<span class="hljs-number"><span class="hljs-number">8</span></span>)] | <span class="hljs-number"><span class="hljs-number">1</span></span>&lt;&lt;(m%<span class="hljs-number"><span class="hljs-number">8</span></span>);<font></font>
   }<font></font>
<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(param == <span class="hljs-number"><span class="hljs-number">2</span></span>)<font></font>
  {m = Minutes + <span class="hljs-number"><span class="hljs-number">30</span></span>;
   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(m &gt;= <span class="hljs-number"><span class="hljs-number">60</span></span>) m -= <span class="hljs-number"><span class="hljs-number">60</span></span>;<font></font>
   REG[(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)(m/<span class="hljs-number"><span class="hljs-number">8</span></span>)] = REG[(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)(m/<span class="hljs-number"><span class="hljs-number">8</span></span>)] | <span class="hljs-number"><span class="hljs-number">1</span></span>&lt;&lt;(m%<span class="hljs-number"><span class="hljs-number">8</span></span>);<font></font>
     <font></font>
   s = Seconds + <span class="hljs-number"><span class="hljs-number">30</span></span>;
   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(s &gt;= <span class="hljs-number"><span class="hljs-number">60</span></span>) s -= <span class="hljs-number"><span class="hljs-number">60</span></span>;<font></font>
   REG[(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)(s/<span class="hljs-number"><span class="hljs-number">8</span></span>)] = REG[(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)(s/<span class="hljs-number"><span class="hljs-number">8</span></span>)] | <span class="hljs-number"><span class="hljs-number">1</span></span>&lt;&lt;(s%<span class="hljs-number"><span class="hljs-number">8</span></span>);<font></font>
  }<font></font>
<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> j = <span class="hljs-number"><span class="hljs-number">0</span></span>; j&lt;<span class="hljs-number"><span class="hljs-number">8</span></span> ; j++) SetUpLightByMask(j,REG[j]);<font></font>
  }<font></font>
  <font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">wait1</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-comment"><span class="hljs-function"><span class="hljs-comment">//    </span></span></span><span class="hljs-function">
</span></span>{<span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> a = <span class="hljs-number"><span class="hljs-number">0</span></span>; a &lt; <span class="hljs-number"><span class="hljs-number">8</span></span>; a++)<font></font>
    {c=<span class="hljs-number"><span class="hljs-number">0</span></span>;
     <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> b = <span class="hljs-number"><span class="hljs-number">0</span></span>; b &lt; <span class="hljs-number"><span class="hljs-number">8</span></span>; b++)<font></font>
      {c = c &lt;&lt; <span class="hljs-number"><span class="hljs-number">1</span></span>;<font></font>
       c = c | <span class="hljs-number"><span class="hljs-number">1</span></span>;<font></font>
       SetUpLightByMask(a, c);  <font></font>
       delay(<span class="hljs-number"><span class="hljs-number">10</span></span>);   <font></font>
      }<font></font>
   }<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> a = <span class="hljs-number"><span class="hljs-number">0</span></span>; a &lt; <span class="hljs-number"><span class="hljs-number">8</span></span>; a++)<font></font>
    {c=<span class="hljs-number"><span class="hljs-number">255</span></span>;
      <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> b = <span class="hljs-number"><span class="hljs-number">0</span></span>; b &lt; <span class="hljs-number"><span class="hljs-number">8</span></span>; b++)<font></font>
      {c = c &lt;&lt; <span class="hljs-number"><span class="hljs-number">1</span></span>;<font></font>
       SetUpLightByMask(a, c);<font></font>
       delay(<span class="hljs-number"><span class="hljs-number">10</span></span>);     <font></font>
      }<font></font>
    }  <font></font>
}<font></font>
</code></pre> <br>
</div></div><br>
<h4></h4><br>
    .         .      (Arduino, RTC)     .      ,   .       ,    ¬´- ¬ª.   ‚Äî   .  :<br>
<br>
    .<br>
<br>
<div class="slideshow"><iframe src="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://www.slideshare.net/slideshow/embed_code/61634811&amp;usg=ALkJrhimKIy72ZB18PQuC8Z-hXEq-6N9TQ" width="425" height="355" frameborder="0" marginwidth="0" marginheight="0" scrolling="no"></iframe></div><br>
<br>
   ,       ¬´¬ª:<br>
<br>
<iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://www.youtube.com/embed/KbbakER89U0%3Ffeature%3Doembed&amp;usg=ALkJrhgUD2f4yBBBlzprnBQ-7N91a3nAHA" frameborder="0" allowfullscreen=""></iframe><br>
<br>
 , ,    :<br>
<br>
<iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://www.youtube.com/embed/SIPI6ug_dls%3Ffeature%3Doembed&amp;usg=ALkJrhgimcMW-oXIBAlF2nw6U3tgFn3n5g" frameborder="0" allowfullscreen=""></iframe><br>
<br>
    ,  ,   ,   . <br>
<br>
 ,  ,     .   ,    ?      .     :         ( ,     ,  ..). ,   ,  ,         .        . ,     .<br>
<br>
<h4></h4><br>
  ?<br>
<br>
<ul>
<li>,    ,   .</li>
<li>       .</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La capacidad de cambiar f√°cilmente mediante programaci√≥n la secuencia de LED parpadeantes, lo que proporciona una variedad infinita de combinaciones.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No reclamamos la exactitud absoluta de nuestros circuitos y soluciones de software. </font><font style="vertical-align: inherit;">Como ya se mencion√≥, la experiencia negativa tambi√©n es experiencia. </font><font style="vertical-align: inherit;">Quiz√°s este art√≠culo ayude a alguien a evitar nuestros errores. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gracias por su atencion!</font></font></li>
</ul></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es394107/">https://habr.com/ru/post/es394107/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es394095/index.html">C√≥mo los escolares de Hackathon de la NASA realizan ingenier√≠a inversa en un brazalete de ejercicios para controlar un dron</a></li>
<li><a href="../es394097/index.html">[ODIO] Dolor. Format RusMARC</a></li>
<li><a href="../es394101/index.html">Encuesta: qu√© idioma se utiliza en su sistema operativo</a></li>
<li><a href="../es394103/index.html">Viento y hielo en Marte</a></li>
<li><a href="../es394105/index.html">El hisopo Bluetooth inteligente le indica cu√°ndo es el momento de cambiar</a></li>
<li><a href="../es394111/index.html">Cu√°nto tiempo o d√≥nde almacenar r√°pidamente informaci√≥n en el disco</a></li>
<li><a href="../es394113/index.html">AOC y Jide lanzaron PC todo en uno en Remix OS</a></li>
<li><a href="../es394115/index.html">¬øCu√°nto cuesta tu idea?</a></li>
<li><a href="../es394123/index.html">Minecraft Gameband: una pulsera para jugadores</a></li>
<li><a href="../es394125/index.html">Windows 7 instalado en tel√©fonos inteligentes LG G Watch</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>