<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëï üìÆ üîç Vereinfachung der Analyse von Windows-Speicherabbildern oder eine weitere Optimierung des Kontextmen√ºs üòè üòì ü§∂üèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Viele Benutzer von Windows-Betriebssystemen m√ºssen fr√ºher oder sp√§ter herausfinden, warum ihr Lieblingsbetriebssystem "in BSOD f√§llt". 

 Es wurde ber...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Vereinfachung der Analyse von Windows-Speicherabbildern oder eine weitere Optimierung des Kontextmen√ºs</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/409397/"> Viele Benutzer von Windows-Betriebssystemen m√ºssen fr√ºher oder sp√§ter herausfinden, warum ihr Lieblingsbetriebssystem "in BSOD f√§llt". <br><br>  Es wurde bereits viel dar√ºber geschrieben, wie man im Internet nach einer Ursache sucht und diese (je nach Situation) behebt. Was kann ich jedoch tun, wenn ich die Ursache so schnell wie m√∂glich herausfinden muss und dies regelm√§√üig tun muss, z. B. Servicemitarbeiter oder Stammg√§ste in Computerforen? <br><br><img src="https://habrastorage.org/webt/wi/jn/hp/wijnhp9o-s4sdaveb37ylkhpvbi.png"><br><br>  Die ber√ºchtigten √Ñnderungen des Kontextmen√ºs k√∂nnen die Aufgabe vereinfachen, da sie ganz einfach vorgenommen werden. <a name="habracut"></a><br><br><div class="spoiler">  <b class="spoiler_title">Vorbereitung</b> <div class="spoiler_text">  Zuerst m√ºssen Sie das Paket mit dem Debugger windbg.exe, der Konsolenversion von kd.exe und anderen erforderlichen Inhalten installieren. <br><br>  Dies sind die Pakete <b>X64 Debugger und Tools-x64_en-us.msi</b> oder <b>X86 Debugger und Tools-x86_en-us.msi</b> , die je nach Bittiefe des verwendeten Betriebssystems und / oder pers√∂nlichen <b>Einstellungen ausgew√§hlt</b> werden k√∂nnen. <br><br>  Auf der Microsoft-Website finden Sie keine einzelnen Links. Diese Pakete sind jedoch Teil des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Windows-Treiberkits</a> . Sie k√∂nnen sie herunterladen, ohne sie zu installieren, indem Sie den entsprechenden Installationsmodus ausw√§hlen. Die Pakete befinden sich nach Abschluss des Downloads im Ordner <b>\ Windows Kits \ 10 \ WDK \ Installers</b> . <br><br>  Wenn jemand es braucht, habe ich es separat auf I hochgeladen. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">X64-Debugger und -Tools-x64_en-us.msi</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">X86-Debugger und -Tools-x86_de-us.msi</a> <br><br>  Ich habe beschlossen, den Debugger nicht zu installieren, sondern nur msi zu entpacken: <br><br><pre><code class="dos hljs">msiexec /a "D:\Desktop\X64 Debuggers And Tools-x64_en-us.msi" /qb targetdir="D:\Desktop\Temp"</code> </pre> <br>  Diese "tragbare" Option ist mehr als genug.  Nachdem ich den gew√ºnschten Inhalt aus mehreren Unterordnern nach <b>C: \ Portable \ Debug</b> verschoben habe, stellte sich <b>Folgendes</b> heraus: <br><br> <code>C:\Portable\Debug\windbg.exe <br> C:\Portable\Debug\kd.exe</code> <br> <br>  + alles andere.  Wir werden in Zukunft auf diesem Pfad aufbauen (und ich habe ihn der Einfachheit halber erneut zu% PATH% hinzugef√ºgt). <br><br>  Dabei k√∂nnen die vorbereitenden Ma√ünahmen als abgeschlossen betrachtet werden und der Prozess der Erstellung einer Optimierung beschrieben werden. </div></div><br>  Da meine Aufgabe davon ausgeht, dass es viele und h√§ufig Dumps gibt, muss ich den Prozess so weit wie m√∂glich beschleunigen und ihn gleichzeitig informativ genug f√ºr eine schnelle Analyse machen. <br><br><h4>  Umgang mit Schl√ºsseln und Debugger-Befehlen </h4><br>  Nehmen wir als Grundlage f√ºr die zuk√ºnftige Optimierung eine solche Batch-Datei, auf die es ausreicht, den gew√ºnschten Speicherauszug zu ziehen. <br><br>  Zur besseren Wahrnehmung von Informationen habe ich nach meinem Verst√§ndnis die Farben der Konsole invertiert und die Gr√∂√üe des Konsolenfensters gr√∂√üer eingestellt. <br><br><pre> <code class="dos hljs">@<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> off <span class="hljs-built_in"><span class="hljs-built_in">title</span></span> text %<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-built_in"><span class="hljs-built_in">mode</span></span> <span class="hljs-built_in"><span class="hljs-built_in">con</span></span>: cols=<span class="hljs-number"><span class="hljs-number">170</span></span> <span class="hljs-built_in"><span class="hljs-built_in">color</span></span> F0 <span class="hljs-built_in"><span class="hljs-built_in">title</span></span> "%<span class="hljs-number"><span class="hljs-number">1</span></span>" kd.exe -nosqm -sup -z "%<span class="hljs-number"><span class="hljs-number">1</span></span>" ^ -y srv*"C:\Symbols"*http://msdl.microsoft.com/download/symbols -i srv*"C:\Symbols"*http://msdl.microsoft.com/download/symbols -c ^ "!analyze -v; !cpuid; !sysinfo cpuinfo; !sysinfo cpuspeed; !sysinfo machineid; q"" <span class="hljs-built_in"><span class="hljs-built_in">pause</span></span> <span class="hljs-keyword"><span class="hljs-keyword">exit</span></span> /b</code> </pre> <br>  Hier sehen Sie die von kd.exe √ºbertragenen Parameter wie <b>-y</b> , <b>-i</b> und <b>-z</b> , die von allen gesehen wurden, die sich mit <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">kdfe.cmd auskennen und</a> in engen Kreisen weithin bekannt sind. <br><br><pre> <code class="hljs pgsql">-i !ImagePath! specifies the <span class="hljs-keyword"><span class="hljs-keyword">location</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> the executables that <span class="hljs-keyword"><span class="hljs-keyword">generated</span></span> the fault (see _NT_EXECUTABLE_IMAGE_PATH) -y !SymbolsPath! specifies the symbol <span class="hljs-keyword"><span class="hljs-keyword">search</span></span> path (see _NT_SYMBOL_PATH) -z !CrashDmpFile! specifies the <span class="hljs-type"><span class="hljs-type">name</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> a crash dump file <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-keyword"><span class="hljs-keyword">debug</span></span></code> </pre> <br>  Wenn wir es analog zu allgemeinen Anweisungen nehmen, gibt es geringf√ºgige Unterschiede: <b>-nosqm</b> und <b>-sup werden</b> zus√§tzlich als Argumente √ºbergeben. <br><br><pre> <code class="hljs powershell"><span class="hljs-literal"><span class="hljs-literal">-nosqm</span></span> disables SQM <span class="hljs-keyword"><span class="hljs-keyword">data</span></span> collection/upload. <span class="hljs-literal"><span class="hljs-literal">-sup</span></span> enables full public symbol searches</code> </pre> <br>  Als Teams: <br><br><pre> <code class="hljs erlang-repl">!cpuid !sysinfo cpuinfo !sysinfo cpuspeed !sysinfo machineid</code> </pre> <br>  Ich werde sie nicht malen, weil zu viele Copy-Paste herauskommen werden.  Interessenten finden die detaillierte Hilfe von debugger.chm in einer der beiden oben genannten * .msi oder unter docs.microsoft.com <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">-cpuid</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">-sysinfo</a> .  Kurz gesagt, grundlegende Informationen √ºber die Dr√ºse des Opfers. <br><br>  Die Skriptausgabe mit kd.exe entspricht fast derjenigen, die bei der direkten Arbeit mit windbg erzielt worden w√§re. Das Ergebnis wird jedoch viel schneller erzielt, da Sie nichts √∂ffnen, Ordner konfigurieren, den Speicherauszug √ºber das Men√º √∂ffnen und Befehle in den Debugger eingeben m√ºssen. <br><br><h4>  Filtern der M√ºllausgabe von der Konsole </h4><br>  Nehmen wir f√ºr das erste Beispiel einen Speicherauszug eines zuf√§lligen Benutzers.  Es gibt ein kleines Problem mit dem M√ºll in der Ausgabe: <br><br><div class="spoiler">  <b class="spoiler_title">Screenshot einer Konsolenausgabe</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/ps/w-/kl/psw-klw_94reyoephkfeilg4k-m.png"></div></div><br>  Dies findet sich beispielsweise in Dumps von Benutzern, die den Odin-Aktivator verwenden, den wir in diesem Beispiel sehen. <br><br>  Die vollst√§ndige Ausgabe ist aufgrund des Links zum <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Pastebin</a> ziemlich umfangreich. <br><br>  Es ist erforderlich, unn√∂tige Zeilen "herauszufiltern" und nur n√ºtzliche Informationen zu hinterlassen. <br>  Ich habe <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">findstr verwendet</a> , es stellte sich als so h√§ssliche, aber funktionierende L√∂sung heraus: <br><br><pre> <code class="dos hljs"><span class="hljs-built_in"><span class="hljs-built_in">findstr</span></span> /r /v /c:"^\*\*\* .* \*\*\*" /c:"^\*\*\*\*\*\*\*\*\*\*\*\*\*\*.*"</code> </pre> <br>  Hier verwendet findstr zwei Stammg√§ste: Eine sucht nach Zeilen, die mit drei Sternchen, einem Leerzeichen beginnen und mit einem Leerzeichen und drei Sternchen enden.  Die zweite sucht nach Zeilen, die mit 14 Sternen beginnen.  Mit findstr k√∂nnte ich nichts Verst√§ndlicheres machen. <br><br>  (Ich empfehle nicht, Zeilenabschlusszeichen in den Findst-Routinen auf dem kd.exe-Auspuff zu verwenden. Es kann Probleme mit der Art der von kd.exe angezeigten Zeilenenden geben. Anstelle von <font color="#cc0000">\ r \ n k√∂nnen</font> Sie <font color="#cc0000">\ n erhalten,</font> dass findstr das Zeilenende nicht ber√ºcksichtigt. Ein solcher Rechen f√ºr sich selbst.) <br><br>  Der gesamte Code der vorl√§ufigen Batchdatei mit dem "Filter" stellte sich wie folgt heraus: <br><br><pre> <code class="dos hljs">@<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> off <span class="hljs-built_in"><span class="hljs-built_in">title</span></span> text %<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-built_in"><span class="hljs-built_in">mode</span></span> <span class="hljs-built_in"><span class="hljs-built_in">con</span></span>: cols=<span class="hljs-number"><span class="hljs-number">170</span></span> <span class="hljs-built_in"><span class="hljs-built_in">color</span></span> F0 <span class="hljs-built_in"><span class="hljs-built_in">title</span></span> "%<span class="hljs-number"><span class="hljs-number">1</span></span>" kd.exe -nosqm -sup -z "%<span class="hljs-number"><span class="hljs-number">1</span></span>" ^ -y srv*"C:\Symbols"*http://msdl.microsoft.com/download/symbols -i srv*"C:\Symbols"*http://msdl.microsoft.com/download/symbols ^ -c "!analyze -v; !cpuid; !sysinfo cpuinfo; !sysinfo cpuspeed; !sysinfo machineid; q" | <span class="hljs-built_in"><span class="hljs-built_in">findstr</span></span> /r /v /c:"^\*\*\* .* \*\*\*" /c:"^\*\*\*\*\*\*\*\*\*\*\*\*\*\*.*" <span class="hljs-built_in"><span class="hljs-built_in">pause</span></span> <span class="hljs-keyword"><span class="hljs-keyword">exit</span></span> /b</code> </pre> <br>  Die vollst√§ndige Ausgabe der gefilterten Version befindet sich ebenfalls im <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Pastebin</a> . <br><br>  Das Ergebnis ist √§hnlich, aber ohne ‚ÄûM√ºll‚Äú.  290 Textzeilen gegen√ºber 894.  Schon besser, aber nicht alle. <br><br><h4>  Schnelle Erstellung des Debugger-Protokolls </h4><br>  Der n√§chste Schritt ist das Hinzuf√ºgen eines Protokolls, das ver√∂ffentlicht oder irgendwohin gesendet werden kann. <br><br>  √úbergeben Sie dazu kd.exe das Argument -loga &lt;"P: \ to the \ log.log"&gt; <br>  Der Code hat folgende Form: <br><br><pre> <code class="dos hljs">@<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> off <span class="hljs-built_in"><span class="hljs-built_in">title</span></span> text %<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-built_in"><span class="hljs-built_in">mode</span></span> <span class="hljs-built_in"><span class="hljs-built_in">con</span></span>: cols=<span class="hljs-number"><span class="hljs-number">170</span></span> <span class="hljs-built_in"><span class="hljs-built_in">color</span></span> F0 <span class="hljs-built_in"><span class="hljs-built_in">title</span></span> "%<span class="hljs-number"><span class="hljs-number">1</span></span>" <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> "D=%<span class="hljs-number"><span class="hljs-number">1</span></span>" <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> L=<span class="hljs-variable"><span class="hljs-variable">%D:.dmp=.LOG%</span></span> kd.exe -nosqm -sup -loga "<span class="hljs-variable"><span class="hljs-variable">%L%</span></span>" -z "<span class="hljs-variable"><span class="hljs-variable">%D%</span></span>" ^ -y srv*"C:\Symbols"*http://msdl.microsoft.com/download/symbols -i srv*"C:\Symbols"*http://msdl.microsoft.com/download/symbols ^ -c "!analyze -v; !cpuid; !sysinfo cpuinfo; !sysinfo cpuspeed; !sysinfo machineid; q" | <span class="hljs-built_in"><span class="hljs-built_in">findstr</span></span> /r /v /c:"^\*\*\* .* \*\*\*" /c:"^\*\*\*\*\*\*\*\*\*\*\*\*\*\*.*" <span class="hljs-built_in"><span class="hljs-built_in">pause</span></span> <span class="hljs-keyword"><span class="hljs-keyword">exit</span></span> /b</code> </pre> <br>  Ein Protokoll <b>102516-21949-01.LOG</b> wird f√ºr die Datei <b>102516-21949-01.dmp</b> im selben Ordner wie der <b>Speicherauszug</b> selbst generiert. <br><br>  In diesem Fall wird die Ausgabe von "Garbage" in das Protokoll nicht gefiltert, sondern nur die Ausgabe in die Konsole. In meinem Fall ist dies jedoch nicht wichtig, obwohl Sie dies beheben k√∂nnen, indem Sie das Protokoll nach der Erstellung l√∂schen: <br><br><pre> <code class="dos hljs">@<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> off <span class="hljs-built_in"><span class="hljs-built_in">title</span></span> text %<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-built_in"><span class="hljs-built_in">mode</span></span> <span class="hljs-built_in"><span class="hljs-built_in">con</span></span>: cols=<span class="hljs-number"><span class="hljs-number">170</span></span> <span class="hljs-built_in"><span class="hljs-built_in">color</span></span> F0 <span class="hljs-built_in"><span class="hljs-built_in">title</span></span> "%<span class="hljs-number"><span class="hljs-number">1</span></span>" <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> "D=%<span class="hljs-number"><span class="hljs-number">1</span></span>" <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> L=<span class="hljs-variable"><span class="hljs-variable">%D:.dmp=.LOG%</span></span> kd.exe -nosqm -sup -loga "<span class="hljs-variable"><span class="hljs-variable">%L%</span></span>" -z "<span class="hljs-variable"><span class="hljs-variable">%D%</span></span>" ^ -y srv*"C:\Symbols"*http://msdl.microsoft.com/download/symbols -i srv*"C:\Symbols"*http://msdl.microsoft.com/download/symbols ^ -c "!analyze -v; !cpuid; !sysinfo cpuinfo; !sysinfo cpuspeed; !sysinfo machineid; q" | <span class="hljs-built_in"><span class="hljs-built_in">findstr</span></span> /r /v /c:"^\*\*\* .* \*\*\*" /c:"^\*\*\*\*\*\*\*\*\*\*\*\*\*\*.*" <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> CL=<span class="hljs-variable"><span class="hljs-variable">%L:.LOG=_CLEAN.LOG%</span></span> <span class="hljs-built_in"><span class="hljs-built_in">type</span></span> "<span class="hljs-variable"><span class="hljs-variable">%L%</span></span>" | <span class="hljs-built_in"><span class="hljs-built_in">findstr</span></span> /r /v /c:"^\*\*\* .* \*\*\*" /c:"^\*\*\*\*\*\*\*\*\*\*\*\*\*\*.*" &gt;&gt; "<span class="hljs-variable"><span class="hljs-variable">%CL%</span></span>" <span class="hljs-built_in"><span class="hljs-built_in">del</span></span> /f /q "<span class="hljs-variable"><span class="hljs-variable">%L%</span></span>" <span class="hljs-built_in"><span class="hljs-built_in">pause</span></span> <span class="hljs-keyword"><span class="hljs-keyword">exit</span></span> /b</code> </pre> <br><h3>  √ñffnen einer M√ºllkippe in Windbg </h3><br>  Jetzt der letzte Schritt in der richtigen Reihenfolge, aber nicht wichtig: Sie m√ºssen in der Lage sein, den Speicherauszug direkt an windbg.exe zu √ºbertragen und sofort Befehle an ihn zu √ºbergeben, die Sie h√∂chstwahrscheinlich eingeben m√ºssen.  Alles geschieht analog zu kd.exe, die von windbg.exe empfangenen Argumente und Befehle sind fast identisch mit kd.exe <br><br><pre> <code class="dos hljs">@<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> off windbg.exe -z "%<span class="hljs-number"><span class="hljs-number">1</span></span>" -sup -y ^ "srv*C:\Symbols*http://msdl.microsoft.com/download/symbols" -i "srv*C:\Symbols*http://msdl.microsoft.com/download/symbols" -c "!analyze -v; !cpuid; !sysinfo cpuinfo; !sysinfo cpuspeed; !sysinfo machineid" <span class="hljs-keyword"><span class="hljs-keyword">exit</span></span> /b</code> </pre> <br>  Infolgedessen wird der Speicherauszug sofort im Debugger ge√∂ffnet und die im Schl√ºssel <b>-c</b> aufgef√ºhrten Befehle werden automatisch darin ausgef√ºhrt. <br><br>  Die Schlussfolgerung √§hnelt der allerersten Option mit dem Unterschied, dass der Speicherauszug sofort in windbg ge√∂ffnet wird. Aufgrund des Fehlens des Befehls <b>q</b> in der Liste der √ºbertragenen Befehle k√∂nnen Befehle zur weiteren Analyse eingegeben werden. <br><br>  (Wenn Sie in fr√ºheren Versionen des Skripts mit kd.exe den Befehl <b>q</b> entfernen, der in der Befehlsliste √ºber das Argument <b>-c √ºbergeben wird</b> , wird dort die M√∂glichkeit angezeigt, mit dem Speicherauszug weiterzuarbeiten, einschlie√ülich der Aufzeichnung des Protokolls direkt im Prozess.) <br><br><h3>  Kreation optimieren </h3><br>  Jetzt muss all dies ge√§ndert werden, damit Sie * .dmp-Dateien mit dem Kontextmen√º verkn√ºpfen k√∂nnen.  Eigentlich f√ºr das, was es vorhatte. <br><br>  Hier sind die folgenden "Einzeiler": <br><br>  <b>F√ºr die Option mit Konsolenausgangsfilterung</b> <br><br><pre> <code class="dos hljs"><span class="hljs-built_in"><span class="hljs-built_in">cmd</span></span> /d /k <span class="hljs-built_in"><span class="hljs-built_in">mode</span></span> <span class="hljs-built_in"><span class="hljs-built_in">con</span></span>: cols=<span class="hljs-number"><span class="hljs-number">170</span></span> &amp; <span class="hljs-built_in"><span class="hljs-built_in">color</span></span> F0 &amp; <span class="hljs-built_in"><span class="hljs-built_in">title</span></span> "%<span class="hljs-number"><span class="hljs-number">1</span></span>" &amp; kd.exe -nosqm -sup -z "%<span class="hljs-number"><span class="hljs-number">1</span></span>" -y srv*"C:\Symbols"*http://msdl.microsoft.com/download/symbols -i srv*"C:\Symbols"*http://msdl.microsoft.com/download/symbols -c "!analyze -v; !cpuid; !sysinfo cpuinfo; !sysinfo cpuspeed; !sysinfo machineid; q" | <span class="hljs-built_in"><span class="hljs-built_in">findstr</span></span> /r /v /c:"^\*\*\* .* \*\*\*" /c:"^\*\*\*\*\*\*\*\*\*\*\*\*\*\*.*"</code> </pre> <br>  <b>F√ºr die Option zum Filtern der Konsolenausgabe und Erstellen einer Protokolldatei</b> <br>  (musste eine <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">verz√∂gerte Variablenerweiterung verwenden</a> ) <br><br><pre> <code class="dos hljs"><span class="hljs-built_in"><span class="hljs-built_in">cmd</span></span> /d /v /k <span class="hljs-built_in"><span class="hljs-built_in">mode</span></span> <span class="hljs-built_in"><span class="hljs-built_in">con</span></span>: cols=<span class="hljs-number"><span class="hljs-number">170</span></span> &amp; <span class="hljs-built_in"><span class="hljs-built_in">color</span></span> F0 &amp; <span class="hljs-built_in"><span class="hljs-built_in">title</span></span> "%<span class="hljs-number"><span class="hljs-number">1</span></span>" &amp; <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> "D=%<span class="hljs-number"><span class="hljs-number">1</span></span>"&amp; <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> L=<span class="hljs-variable"><span class="hljs-variable">!D:.dmp=.LOG!</span></span> &amp; kd.exe -nosqm -sup -loga "<span class="hljs-variable"><span class="hljs-variable">!L!</span></span>" -z "<span class="hljs-variable"><span class="hljs-variable">!D!</span></span>" -y srv*"C:\Symbols"*http://msdl.microsoft.com/download/symbols -i srv*"C:\Symbols"*http://msdl.microsoft.com/download/symbols -c "!analyze -v; !cpuid; !sysinfo cpuinfo; !sysinfo cpuspeed; !sysinfo machineid; q" | <span class="hljs-built_in"><span class="hljs-built_in">findstr</span></span> /r /v /c:"^\*\*\* .* \*\*\*" /c:"^\*\*\*\*\*\*\*\*\*\*\*\*\*\*.*"</code> </pre> <br>  <b>So √∂ffnen Sie einen Speicherauszug direkt in windbg.exe</b> <br><br><pre> <code class="dos hljs">"C:\Portable\Debug\windbg.exe" -z "%<span class="hljs-number"><span class="hljs-number">1</span></span>" -sup -y "srv*C:\Symbols*http://msdl.microsoft.com/download/symbols" -i "srv*C:\Symbols*http://msdl.microsoft.com/download/symbols" -c "!analyze -v; !cpuid; !sysinfo cpuinfo; !sysinfo cpuspeed; !sysinfo machineid"</code> </pre> <br>  In der Registrierung habe ich die folgende Partitionsstruktur erstellt: <br><br><img src="https://habrastorage.org/webt/ln/8e/n8/ln8en8yk3dh6h3-6fp2zdmit1qg.png"><br><br>  In den Registrierungsschl√ºsseln, an denen √Ñnderungen vorgenommen wurden, wurde ein <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">separater Dateityp</a> <b>dmp_geek erstellt</b> .  Dateien mit der Erweiterung * .dmp wurden Dateien vom Typ <b>dmp_geek</b> zugewiesen. <br><br>  In jedem Befehlsabschnitt wurden dem Zeichenfolgenparameter standardm√§√üig die entsprechende einzeilige + Sch√∂nheit in Form von Symbolen und praktischen Namen f√ºr die im Kontextmen√º angezeigten Elementnamen hinzugef√ºgt. <br><br><img src="https://habrastorage.org/webt/et/2p/zd/et2pzduo7gx7fl0dtpsrdsppylm.png"><br><br>  Es stellte sich heraus, dass eine Optimierung die M√∂glichkeit bietet, die im Ordner ausgew√§hlten Speicherausz√ºge sowohl in der Konsole als auch im Debugger massiv zu √∂ffnen, indem nach "M√ºll" gefiltert und bei Bedarf Protokolle f√ºr jeden Speicherauszug erstellt werden.  Das spart viel Zeit. <br><br>  Exportieren Sie nach dem K√§mmen der Registrierung alles in die endg√ºltige REG-Datei, die zur Verwendung bereit ist. <br><br><div class="spoiler">  <b class="spoiler_title">Der Inhalt der REG-Datei</b> <div class="spoiler_text"><pre> <code class="hljs powershell">Windows Registry Editor Version <span class="hljs-number"><span class="hljs-number">5.00</span></span> [<span class="hljs-type"><span class="hljs-type">HKEY_CLASSES_ROOT</span></span>\<span class="hljs-type"><span class="hljs-type">.dmp</span></span>] <span class="hljs-selector-tag"><span class="hljs-selector-tag">@</span></span>=<span class="hljs-string"><span class="hljs-string">"dmp_geek"</span></span> [<span class="hljs-type"><span class="hljs-type">HKEY_CLASSES_ROOT</span></span>\<span class="hljs-type"><span class="hljs-type">dmp_geek</span></span>] <span class="hljs-selector-tag"><span class="hljs-selector-tag">@</span></span>=<span class="hljs-string"><span class="hljs-string">"dmp_geek"</span></span> <span class="hljs-string"><span class="hljs-string">"FriendlyTypeName"</span></span>=<span class="hljs-string"><span class="hljs-string">" "</span></span> [<span class="hljs-type"><span class="hljs-type">HKEY_CLASSES_ROOT</span></span>\<span class="hljs-type"><span class="hljs-type">dmp_geek</span></span>\<span class="hljs-type"><span class="hljs-type">DefaultIcon</span></span>] <span class="hljs-selector-tag"><span class="hljs-selector-tag">@</span></span>=<span class="hljs-string"><span class="hljs-string">"imageres.dll,142"</span></span> [<span class="hljs-type"><span class="hljs-type">HKEY_CLASSES_ROOT</span></span>\<span class="hljs-type"><span class="hljs-type">dmp_geek</span></span>\<span class="hljs-type"><span class="hljs-type">shell</span></span>] [<span class="hljs-type"><span class="hljs-type">HKEY_CLASSES_ROOT</span></span>\<span class="hljs-type"><span class="hljs-type">dmp_geek</span></span>\<span class="hljs-type"><span class="hljs-type">shell</span></span>\<span class="hljs-type"><span class="hljs-type">kd.exe</span></span>] <span class="hljs-string"><span class="hljs-string">"MUIVerb"</span></span>=<span class="hljs-string"><span class="hljs-string">"Kd.exe"</span></span> <span class="hljs-string"><span class="hljs-string">"Icon"</span></span>=<span class="hljs-string"><span class="hljs-string">"C:\\Portable\\Debug\\windbg.exe,6"</span></span> [<span class="hljs-type"><span class="hljs-type">HKEY_CLASSES_ROOT</span></span>\<span class="hljs-type"><span class="hljs-type">dmp_geek</span></span>\<span class="hljs-type"><span class="hljs-type">shell</span></span>\<span class="hljs-type"><span class="hljs-type">kd.exe</span></span>\<span class="hljs-type"><span class="hljs-type">command</span></span>] <span class="hljs-selector-tag"><span class="hljs-selector-tag">@</span></span>=<span class="hljs-string"><span class="hljs-string">"cmd /d /k mode con: cols=170 &amp; color F0 &amp; title \"</span></span>%<span class="hljs-number"><span class="hljs-number">1</span></span>\<span class="hljs-string"><span class="hljs-string">" &amp; \"</span></span>C:\\Portable\\Debug\\kd.exe\<span class="hljs-string"><span class="hljs-string">" -nosqm -sup -z \"</span></span>%<span class="hljs-number"><span class="hljs-number">1</span></span>\<span class="hljs-string"><span class="hljs-string">" -y srv*\"</span></span>C:\\Symbols\<span class="hljs-string"><span class="hljs-string">"*http://msdl.microsoft.com/download/symbols -i srv*\"</span></span>C:\\Symbols\<span class="hljs-string"><span class="hljs-string">"*http://msdl.microsoft.com/download/symbols -c \"</span></span>!analyze <span class="hljs-literal"><span class="hljs-literal">-v</span></span>; !cpuid; !sysinfo cpuinfo; !sysinfo cpuspeed; !sysinfo machineid; q\<span class="hljs-string"><span class="hljs-string">" | findstr /r /v /c:\"</span></span>^\\*\\*\\* .* \\*\\*\\*\<span class="hljs-string"><span class="hljs-string">" /c:\"</span></span>^\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*.*\<span class="hljs-string"><span class="hljs-string">""</span></span> [<span class="hljs-type"><span class="hljs-type">HKEY_CLASSES_ROOT</span></span>\<span class="hljs-type"><span class="hljs-type">dmp_geek</span></span>\<span class="hljs-type"><span class="hljs-type">shell</span></span>\<span class="hljs-type"><span class="hljs-type">kd.exe_</span></span>-<span class="hljs-type"><span class="hljs-type">loga</span></span>] <span class="hljs-string"><span class="hljs-string">"MUIVerb"</span></span>=<span class="hljs-string"><span class="hljs-string">"Kd.exe -loga"</span></span> <span class="hljs-string"><span class="hljs-string">"Icon"</span></span>=<span class="hljs-string"><span class="hljs-string">"C:\\Portable\\Debug\\windbg.exe,6"</span></span> [<span class="hljs-type"><span class="hljs-type">HKEY_CLASSES_ROOT</span></span>\<span class="hljs-type"><span class="hljs-type">dmp_geek</span></span>\<span class="hljs-type"><span class="hljs-type">shell</span></span>\<span class="hljs-type"><span class="hljs-type">kd.exe_</span></span>-<span class="hljs-type"><span class="hljs-type">loga</span></span>\<span class="hljs-type"><span class="hljs-type">command</span></span>] <span class="hljs-selector-tag"><span class="hljs-selector-tag">@</span></span>=<span class="hljs-string"><span class="hljs-string">"cmd /d /v /k mode con: cols=170 &amp; color F0 &amp; title \"</span></span>%<span class="hljs-number"><span class="hljs-number">1</span></span>\<span class="hljs-string"><span class="hljs-string">" &amp; set \"</span></span>D=%<span class="hljs-number"><span class="hljs-number">1</span></span>\<span class="hljs-string"><span class="hljs-string">"&amp; set L=!D:.dmp=.LOG! &amp; \"</span></span>C:\\Portable\\Debug\\kd.exe\<span class="hljs-string"><span class="hljs-string">" -nosqm -sup -loga \"</span></span>!L!\<span class="hljs-string"><span class="hljs-string">" -z \"</span></span>!D!\<span class="hljs-string"><span class="hljs-string">" -y srv*\"</span></span>C:\\Symbols\<span class="hljs-string"><span class="hljs-string">"*http://msdl.microsoft.com/download/symbols -i srv*\"</span></span>C:\\Symbols\<span class="hljs-string"><span class="hljs-string">"*http://msdl.microsoft.com/download/symbols -c \"</span></span>!analyze <span class="hljs-literal"><span class="hljs-literal">-v</span></span>; !cpuid; !sysinfo cpuinfo; !sysinfo cpuspeed; !sysinfo machineid; q\<span class="hljs-string"><span class="hljs-string">" | findstr /r /v /c:\"</span></span>^\\*\\*\\* .* \\*\\*\\*\<span class="hljs-string"><span class="hljs-string">" /c:\"</span></span>^\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*.*\<span class="hljs-string"><span class="hljs-string">""</span></span> [<span class="hljs-type"><span class="hljs-type">HKEY_CLASSES_ROOT</span></span>\<span class="hljs-type"><span class="hljs-type">dmp_geek</span></span>\<span class="hljs-type"><span class="hljs-type">shell</span></span>\<span class="hljs-type"><span class="hljs-type">Open</span></span>] <span class="hljs-string"><span class="hljs-string">"MUIVerb"</span></span>=<span class="hljs-string"><span class="hljs-string">"Windbg"</span></span> <span class="hljs-string"><span class="hljs-string">"Icon"</span></span>=<span class="hljs-string"><span class="hljs-string">"C:\\Portable\\Debug\\windbg.exe,6"</span></span> [<span class="hljs-type"><span class="hljs-type">HKEY_CLASSES_ROOT</span></span>\<span class="hljs-type"><span class="hljs-type">dmp_geek</span></span>\<span class="hljs-type"><span class="hljs-type">shell</span></span>\<span class="hljs-type"><span class="hljs-type">Open</span></span>\<span class="hljs-type"><span class="hljs-type">command</span></span>] <span class="hljs-selector-tag"><span class="hljs-selector-tag">@</span></span>=<span class="hljs-string"><span class="hljs-string">"\"</span></span>C:\\Portable\\Debug\\windbg.exe\<span class="hljs-string"><span class="hljs-string">" -z \"</span></span>%<span class="hljs-number"><span class="hljs-number">1</span></span>\<span class="hljs-string"><span class="hljs-string">" -sup -y \"</span></span>srv*C:\\Symbols*http://msdl.microsoft.com/download/symbols\<span class="hljs-string"><span class="hljs-string">" -i \"</span></span>srv*C:\\Symbols*http://msdl.microsoft.com/download/symbols\<span class="hljs-string"><span class="hljs-string">" -c \"</span></span>!analyze <span class="hljs-literal"><span class="hljs-literal">-v</span></span>; !cpuid; !sysinfo cpuinfo; !sysinfo cpuspeed; !sysinfo machineid\<span class="hljs-string"><span class="hljs-string">""</span></span></code> </pre></div></div><br>  ‚Üí Download von Ya.Disk <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">GEEK_DMP.reg</a> <br><br>  Das ist alles  Jetzt k√∂nnen Sie schnell, wenn auch oberfl√§chlich, sofort eine Reihe von Dumps analysieren. <br><br><div class="spoiler">  <b class="spoiler_title">Verwendete Materialien, Quellen, n√ºtzliche Links zum Thema:</b> <div class="spoiler_text">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Debugging-Tools f√ºr Windows</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Computerwerkstatt</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Windows-Registrierung</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Windows Administration - Forum f√ºr Programmierer und Systemadministratoren</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">WinDbg-Spickzettel f√ºr die Crash-Dump-Analyse</a> <br></div></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de409397/">https://habr.com/ru/post/de409397/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de409385/index.html">Was ist die St√§rke von IoT, Bruder? In Blockchain</a></li>
<li><a href="../de409387/index.html">In Deutschland fielen die Strompreise mehr als 100 Mal im Jahr auf negative Werte</a></li>
<li><a href="../de409389/index.html">Wie k√∂nnen Sie Ihre Gesundheit verfolgen? N√ºtzliche mHealth-Anwendungen auf einem Smartphone</a></li>
<li><a href="../de409393/index.html">Lamptest: Weihnachtswunder, Update, gro√üe Pl√§ne</a></li>
<li><a href="../de409395/index.html">Algorithmischer Ansatz zur Behandlung von Schlaflosigkeit</a></li>
<li><a href="../de409399/index.html">Die Wahrheit √ºber die Saturn-5-Mondrakete (Kritik an der Spekulation des Doktors f√ºr Physik und Mathematik Popov)</a></li>
<li><a href="../de409401/index.html">Design mit Simulation: Wie funktioniert es?</a></li>
<li><a href="../de409403/index.html">Formnext 2017 Additive Technology Messe√ºbersicht</a></li>
<li><a href="../de409405/index.html">Die Konferenz von 1970 zur Vorhersage der Zukunft der Arbeit</a></li>
<li><a href="../de409407/index.html">Solard√§cher von Tesla wurden f√ºr Kunden installiert</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>