<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üÖøÔ∏è üòà ü§∞üèæ regra de regra: verifica√ß√µes din√¢micas para Go üíæ üê≥ üéª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Neste artigo, falarei sobre a nova biblioteca de an√°lise est√°tica go-ruleguard (e utilit√°rio) que adapta o gogrep para uso dentro de linters. 


 Cara...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>regra de regra: verifica√ß√µes din√¢micas para Go</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/481696/"><p><img src="https://habrastorage.org/webt/b5/p-/sq/b5p-sqgr-9b1e5mimtxaftmryau.png"></p><br><p> Neste artigo, falarei sobre a nova biblioteca de an√°lise est√°tica <a href="https://github.com/quasilyte/go-ruleguard"><code>go-ruleguard</code></a> (e utilit√°rio) que adapta o <a href="https://github.com/mvdan/gogrep"><code>gogrep</code></a> para uso dentro de linters. </p><br><p>  Caracter√≠stica distintiva: voc√™ descreve as regras da an√°lise est√°tica em uma DSL tipo Go especial, que no in√≠cio da <code>ruleguard</code> de <code>ruleguard</code> transforma em um conjunto de diagn√≥sticos.  Talvez essa seja uma das ferramentas mais facilmente configur√°veis ‚Äã‚Äãpara implementar inspe√ß√µes personalizadas no Go. </p><br><p>  Como b√¥nus, falaremos sobre <a href="https://godoc.org/golang.org/x/tools/go/analysis"><code>go/analysis</code></a> e seus <a href="https://github.com/go-lintpack/lintpack">antecessores</a> . </p><a name="habracut"></a><br><h1 id="rasshiryaemost-staticheskogo-analiza">  Extensibilidade da an√°lise est√°tica </h1><br><p>  Existem <a href="https://github.com/golangci/awesome-go-linters">muitos</a> linters para o Go, alguns dos quais podem ser expandidos.  Geralmente, para estender o linter, voc√™ precisa escrever o c√≥digo Go usando a API especial do linter. </p><br><p>  Existem duas maneiras principais: <a href="https://golang.org/pkg/plugin/">Ir plugins</a> e mon√≥lito.  O mon√≥lito implica que todas as verifica√ß√µes (incluindo as pessoais) est√£o dispon√≠veis no est√°gio de compila√ß√£o. </p><br><p>  <a href="https://github.com/mgechev/revive"><code>revive</code></a> requer que novas verifica√ß√µes sejam inclu√≠das em seu kernel para expans√£o.  Al√©m disso, os plug-ins <a href="https://github.com/go-critic/go-critic"><code>go-critic</code></a> Crit, que permitem coletar extens√µes, independentemente do c√≥digo principal.  Ambas as abordagens implicam que voc√™ implemente manipula√ß√µes <a href="https://golang.org/pkg/go/ast/"><code>go/ast</code></a> e <a href="https://golang.org/pkg/go/types/"><code>go/types</code></a> no Go usando a API do linter.  Mesmo verifica√ß√µes simples exigem <a href="">muito c√≥digo</a> . </p><br><p>  <a href="https://godoc.org/golang.org/x/tools/go/analysis"><code>go/analysis</code></a> visa simplificar a imagem pelo fato de que a "estrutura" do linter se torna quase id√™ntica, mas n√£o resolve o problema da complexidade da implementa√ß√£o t√©cnica dos pr√≥prios diagn√≥sticos. </p><br><div class="spoiler">  <b class="spoiler_title">Digress√£o em `loader` e` go / packages`</b> <div class="spoiler_text"><hr><br><p>  Quando voc√™ escreve um analisador para o Go, seu objetivo final √© interagir com o AST e os tipos, mas antes que voc√™ possa fazer isso, o c√≥digo-fonte precisa ser "carregado" da maneira correta.  Para simplificar, o conceito de carregamento inclui <a href="https://golang.org/pkg/go/parser/">an√°lise</a> , verifica√ß√£o de tipo e <a href="https://golang.org/pkg/go/importer/">importa√ß√£o de depend√™ncias</a> . </p><br><p>  A primeira etapa na simplifica√ß√£o desse pipeline foi o pacote <a href="https://godoc.org/golang.org/x/tools/go/loader"><code>go/loader</code></a> , que permitir√° que voc√™ "baixe" tudo o que precisa atrav√©s de algumas chamadas.  Tudo estava quase bem, e ent√£o ele se tornou obsoleto em favor de <a href="https://godoc.org/golang.org/x/tools/go/packages"><code>go/packages</code></a> .  <code>go/packages</code> possui uma API ligeiramente aprimorada e, em teoria, funciona bem com os m√≥dulos. </p><br><p>  Agora, √© melhor n√£o usar nenhuma das op√ß√µes acima diretamente para escrever analisadores, porque <a href="https://godoc.org/golang.org/x/tools/go/analysis"><code>go/analysis</code></a> deu <code>go/packages</code> algo que nenhuma das solu√ß√µes anteriores possu√≠a - uma estrutura para o seu programa.  Agora podemos usar o paradigma de <code>go/analysis</code> ditado e reutilizar os analisadores com mais efici√™ncia.  Esse paradigma tem pontos controversos, por exemplo, <code>go/analysis</code> adequado para an√°lises no n√≠vel de um pacote e suas depend√™ncias, mas n√£o ser√° f√°cil fazer uma an√°lise global sobre ele sem truques de engenharia astutos. </p><br><p>  <code>go/analysis</code> tamb√©m simplifica os <a href="https://godoc.org/golang.org/x/tools/go/analysis/analysistest">testes do analisador</a> . </p><br><hr></div></div><br><h1 id="chto-zhe-takoe-ruleguard">  O que √© regra? </h1><br><p><img src="https://habrastorage.org/webt/zp/ym/rj/zpymrjjb8zkqa_c069ccd-yf3xg.png"></p><br><p>  <a href="https://github.com/quasilyte/go-ruleguard"><code>go-ruleguard</code></a> √© um utilit√°rio de an√°lise est√°tica que, por padr√£o, n√£o inclui uma √∫nica verifica√ß√£o. </p><br><p>  As regras de regras de regras <code>ruleguard</code> carregadas no in√≠cio, a partir de um arquivo <code>gorules</code> especial que descreve declarativamente os padr√µes de c√≥digo nos quais os avisos devem ser emitidos.  Este arquivo pode ser editado livremente por usu√°rios de <code>ruleguard</code> . </p><br><p>  N√£o √© necess√°rio <code>gorules</code> programa de controle para conectar novas verifica√ß√µes, para que as regras dos <code>gorules</code> possam ser chamadas <a href="https://habr.com/ru/company/vk/blog/473718/">din√¢micas</a> . </p><br><p>  O programa de controle de <code>ruleguard</code> √© mais ou menos assim: </p><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> main <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ( <span class="hljs-string"><span class="hljs-string">"github.com/quasilyte/go-ruleguard/analyzer"</span></span> <span class="hljs-string"><span class="hljs-string">"golang.org/x/tools/go/analysis/singlechecker"</span></span> ) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { singlechecker.Main(analyzer.Analyzer) }</code> </pre> <br><p>  Ao mesmo tempo, o <code>analyzer</code> implementado por meio do pacote <a href="https://godoc.org/github.com/quasilyte/go-ruleguard/ruleguard"><code>ruleguard</code></a> , que voc√™ deve usar se quiser us√°-lo como uma biblioteca. </p><br><h1 id="ruleguard-vs-revive">  ruleguard VS revive </h1><br><p>  Pegue um exemplo simples, mas do mundo real: suponha que desejamos evitar chamadas em tempo de <a href="https://golang.org/pkg/runtime/"><code>runtime.GC()</code></a> em nossos programas.  No revive, j√° existe um diagn√≥stico separado para isso, chamado <code>"call-to-gc"</code> . </p><br><div class="spoiler">  <b class="spoiler_title">Implementa√ß√£o de call-to-gc (70 linhas no Elven)</b> <div class="spoiler_text"><hr><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> rule <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ( <span class="hljs-string"><span class="hljs-string">"go/ast"</span></span> <span class="hljs-string"><span class="hljs-string">"github.com/mgechev/revive/lint"</span></span> ) <span class="hljs-comment"><span class="hljs-comment">// CallToGCRule lints calls to the garbage collector. type CallToGCRule struct{} // Apply applies the rule to given file. func (r *CallToGCRule) Apply(file *lint.File, _ lint.Arguments) []lint.Failure { var failures []lint.Failure onFailure := func(failure lint.Failure) { failures = append(failures, failure) } var gcTriggeringFunctions = map[string]map[string]bool{ "runtime": map[string]bool{"GC": true}, } w := lintCallToGC{onFailure, gcTriggeringFunctions} ast.Walk(w, file.AST) return failures } // Name returns the rule name. func (r *CallToGCRule) Name() string { return "call-to-gc" } type lintCallToGC struct { onFailure func(lint.Failure) gcTriggeringFunctions map[string]map[string]bool } func (w lintCallToGC) Visit(node ast.Node) ast.Visitor { ce, ok := node.(*ast.CallExpr) if !ok { return w // nothing to do, the node is not a call } fc, ok := ce.Fun.(*ast.SelectorExpr) if !ok { return nil // nothing to do, the call is not of the form pkg.func(...) } id, ok := fc.X.(*ast.Ident) if !ok { return nil // in case X is not an id (it should be!) } fn := fc.Sel.Name pkg := id.Name if !w.gcTriggeringFunctions[pkg][fn] { return nil // it isn't a call to a GC triggering function } w.onFailure(lint.Failure{ Confidence: 1, Node: node, Category: "bad practice", Failure: "explicit call to the garbage collector", }) return w }</span></span></code> </pre> <br><hr></div></div><br><p>  Agora compare com como isso √© feito no <a href="https://github.com/quasilyte/go-ruleguard"><code>go-ruleguard</code></a> : </p><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> gorules <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">"github.com/quasilyte/go-ruleguard/dsl/fluent"</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">callToGC</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(m fluent.Matcher)</span></span></span></span> { m.Match(<span class="hljs-string"><span class="hljs-string">`runtime.GC()`</span></span>).Report(<span class="hljs-string"><span class="hljs-string">`explicit call to the garbage collector`</span></span>) }</code> </pre> <br><p>  Nada mais, exatamente o que realmente importa - <code>runtime.GC</code> e a mensagem que precisa ser emitida caso a regra seja acionada. </p><br><p>  Voc√™ pode perguntar: isso √© tudo?  Comecei especificamente com um exemplo t√£o simples para mostrar quanto c√≥digo pode ser necess√°rio para um diagn√≥stico muito trivial no caso da abordagem tradicional.  Eu prometo que haver√° exemplos mais emocionantes. </p><br><h1 id="quick-start">  In√≠cio r√°pido </h1><br><p>  <code>go-critic</code> possui um diagn√≥stico <a href="https://go-critic.github.io/overview"><code>rangeExprCopy</code></a> que localiza c√≥pias de matriz potencialmente inesperadas no c√≥digo. </p><br><p>  Este c√≥digo √© iterado sobre uma <strong>c√≥pia da</strong> matriz: </p><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> xs [<span class="hljs-number"><span class="hljs-number">2048</span></span>]<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> _, x := <span class="hljs-keyword"><span class="hljs-keyword">range</span></span> xs { <span class="hljs-comment"><span class="hljs-comment">// Copies 2048 bytes // Loop body. }</span></span></code> </pre> <br><p>  A corre√ß√£o para esse problema √© adicionar um caractere: </p><br><pre> <code class="diff hljs"> var xs [2048]byte - for _, x := range xs { // Copies 2048 bytes + for _, x := range &amp;xs { // No copy // Loop body. }</code> </pre> <br><p>  Provavelmente, voc√™ n√£o precisa dessa c√≥pia, e o desempenho da vers√£o corrigida √© sempre melhor.  Voc√™ pode esperar at√© que o compilador Go melhore, ou pode detectar esses lugares no c√≥digo e corrigi-los hoje usando o mesmo <code>go-critic</code> . </p><br><p>  Esse diagn√≥stico pode ser implementado no idioma dos <code>gorules</code> (arquivo <code>rules.go</code> ): </p><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> gorules <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">"github.com/quasilyte/go-ruleguard/dsl/fluent"</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> _</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(m fluent.Matcher)</span></span></span></span> { m.Match(<span class="hljs-string"><span class="hljs-string">`for $_, $_ := range $x { $*_ }`</span></span>, <span class="hljs-string"><span class="hljs-string">`for $_, $_ = range $x { $*_ }`</span></span>). Where(m[<span class="hljs-string"><span class="hljs-string">"x"</span></span>].Addressable &amp;&amp; m[<span class="hljs-string"><span class="hljs-string">"x"</span></span>].Type.Size &gt;= <span class="hljs-number"><span class="hljs-number">128</span></span>). Report(<span class="hljs-string"><span class="hljs-string">`$x copy can be avoided with &amp;$x`</span></span>). At(m[<span class="hljs-string"><span class="hljs-string">"x"</span></span>]). Suggest(<span class="hljs-string"><span class="hljs-string">`&amp;$x`</span></span>) }</code> </pre> <br><p>  A regra localiza todos <code>for-range</code> loops de <code>for-range</code> que ambas as vari√°veis ‚Äã‚Äãiter√°veis ‚Äã‚Äãs√£o usadas (este √© o caso que leva √† c√≥pia).  A express√£o iter√°vel <code>$x</code> deve ser <a href="https://golang.org/ref/spec"><code>addressable</code></a> e deve ser maior que o limite selecionado em bytes. </p><br><p>  <a href="https://godoc.org/github.com/quasilyte/go-ruleguard/dsl/fluent"><code>Report()</code></a> define a mensagem a ser emitida para o usu√°rio, e <a href="https://godoc.org/github.com/quasilyte/go-ruleguard/dsl/fluent"><code>Suggest()</code></a> descreve um modelo de <code>quickfix</code> que pode ser usado em seu editor via <a href="https://github.com/golang/tools/tree/master/gopls">gopls</a> (LSP), bem como interativamente se a <code>ruleguard</code> chamada com o argumento <code>ruleguard</code> (retornaremos a isso).  <a href="https://godoc.org/github.com/quasilyte/go-ruleguard/dsl/fluent"><code>At()</code></a> anexa o aviso <strong>e o</strong> <code>quickfix</code> a uma parte espec√≠fica do modelo.  Precisamos disso para substituir <code>$x</code> por <code>&amp;$x</code> , em vez de reescrever o loop inteiro. </p><br><p>  <code>Report()</code> e <code>Suggest()</code> aceitam uma sequ√™ncia na qual as express√µes capturadas pelo modelo de <code>Match()</code> podem ser interpoladas.  A vari√°vel predefinida <code>$$</code> significa "todo o fragmento capturado" (como <code>$0</code> em express√µes regulares). </p><br><p>  Crie o arquivo <code>rangecopy.go</code> : </p><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> example <span class="hljs-comment"><span class="hljs-comment">// sizeof(builtins[...]) = 240 on x86-64 var builtins = [...]string{ "append", "cap", "close", "complex", "copy", "delete", "imag", "len", "make", "new", "panic", "print", "println", "real", "recover", } func builtinID(name string) int { for i, s := range builtins { if s == name { return i } } return -1 }</span></span></code> </pre> <br><p>  Agora podemos executar o <code>ruleguard</code> : </p><br><pre> <code class="bash hljs">$ ruleguard -rules rules.go -fix rangecopy.go rangecopy.go:12:20: builtins copy can be avoided with &amp;builtins</code> </pre> <br><p>  Se depois analisarmos <code>rangecopy.go</code> , veremos uma vers√£o fixa, porque o <code>ruleguard</code> foi chamado com o par√¢metro <code>ruleguard</code> . </p><br><p>  As regras mais simples podem ser depuradas sem criar um arquivo <code>gorules</code> : </p><br><pre> <code class="plaintext hljs">$ ruleguard -c 1 -e 'm.Match(`return -1`)' rangecopy.go rangecopy.go:17:2: return -1 16 } 17 return -1 18 }</code> </pre> <br><p>  Gra√ßas ao uso de <a href="https://godoc.org/golang.org/x/tools/go/analysis/singlechecker"><code>go/analysis/singlechecker</code></a> , temos a op√ß√£o <code>-c</code> , que nos permite exibir as linhas de contexto especificadas junto com o pr√≥prio aviso.  Controlar esse par√¢metro √© um pouco contra-intuitivo: o valor padr√£o √© <code>-c=-1</code> , que significa "sem contexto", e <code>-c=0</code> produzir√° uma linha de contexto (a indicada pelo diagn√≥stico). </p><br><p>  Aqui est√£o algumas <code>gorules</code> mais interessantes dos <code>gorules</code> : </p><br><ul><li>  <a href="">Modelos de tipo</a> que permitem especificar os tipos esperados.  Por exemplo, o <code>map[$t]$t</code> express√£o <code>map[$t]$t</code> descreve todos os mapas com o tipo de valor correspondente ao tipo de chave e <code>*[$len]$elem</code> captura todos os ponteiros para matrizes. </li><li>  Pode haver v√°rias regras dentro de uma fun√ß√£o, <br>  e as pr√≥prias fun√ß√µes devem ser chamadas de <a href="">grupos de regras</a> . </li><li>  As regras no grupo s√£o aplicadas uma ap√≥s a outra, na ordem em que s√£o definidas.  A primeira regra acionada cancela a compara√ß√£o com as regras restantes.  Isso √© importante n√£o apenas para otimiza√ß√£o, mas tamb√©m para regras especializadas para casos espec√≠ficos.  Um exemplo em que isso √© √∫til √© a regra de reescrever <code>$x=$x+$y</code> para <code>$x+=$y</code> , para o caso com <code>$y=1</code> voc√™ deseja oferecer <code>$x++</code> , n√£o <code>$x+=1</code> . </li></ul><br><p>  Mais informa√ß√µes sobre o DSL usado podem ser encontradas em <a href=""><code>docs/gorules.md</code></a> . </p><br><h1 id="eschyo-bolshe-primerov">  Mais exemplos </h1><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> gorules <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">"github.com/quasilyte/go-ruleguard/dsl/fluent"</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">exampleGroup</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(m fluent.Matcher)</span></span></span></span> { <span class="hljs-comment"><span class="hljs-comment">//     json.Decoder. // . http://golang.org/issue/36225 m.Match(`json.NewDecoder($_).Decode($_)`). Report(`this json.Decoder usage is erroneous`) //   unconvert,    . m.Match(`time.Duration($x) * time.Second`). Where(m["x"].Const). Suggest(`$x * time.Second`) //   fmt.Sprint()    String(), //   $x  . m.Match(`fmt.Sprint($x)`). Where(m["x"].Type.Implements(`fmt.Stringer`)). Suggest(`$x.String()`) //   . m.Match(`!($x != $y)`).Suggest(`$x == $y`) m.Match(`!($x == $y)`).Suggest(`$x != $y`) }</span></span></code> </pre> <br><p>  Se n√£o houver uma chamada <a href="https://godoc.org/github.com/quasilyte/go-ruleguard/dsl/fluent"><code>Report()</code></a> para a regra, a mensagem de <a href="https://godoc.org/github.com/quasilyte/go-ruleguard/dsl/fluent"><code>Suggest()</code></a> ser√° usada.  Isso permite, em alguns casos, evitar duplica√ß√£o. </p><br><p>  Filtros de tipo e subexpress√µes podem verificar v√°rias propriedades.  Por exemplo, as propriedades <code>Pure</code> e <code>Const</code> s√£o √∫teis: </p><br><ul><li>  <a href="https://godoc.org/github.com/quasilyte/go-ruleguard/dsl/fluent"><code>Var.Pure</code></a> significa que a express√£o n√£o tem efeitos colaterais. </li><li>  <a href="https://godoc.org/github.com/quasilyte/go-ruleguard/dsl/fluent"><code>Var.Const</code></a> significa que a express√£o pode ser usada em um contexto constante (por exemplo, a dimens√£o de uma matriz). </li></ul><br><p>  Para nomes <code>package-qualified</code> para <code>package-qualified</code> nas condi√ß√µes <a href="https://godoc.org/github.com/quasilyte/go-ruleguard/dsl/fluent"><code>Where()</code></a> , voc√™ precisa usar o m√©todo <a href="https://godoc.org/github.com/quasilyte/go-ruleguard/dsl/fluent"><code>Import()</code></a> .  Por conveni√™ncia, todos os pacotes padr√£o foram importados para voc√™; portanto, no exemplo acima, n√£o precisamos fazer importa√ß√µes adicionais. </p><br><h1 id="goanalysis-quickfix-actions">  a√ß√µes de corre√ß√£o r√°pida <code>go/analysis</code> </h1><br><p>  O suporte para o <code>quickfix</code> por <code>go/analysis</code> para n√≥s. </p><br><p>  No modelo de <code>go/analysis</code> , o analisador gera <a href="https://godoc.org/golang.org/x/tools/go/analysis">diagn√≥sticos</a> e <a href="https://godoc.org/golang.org/x/tools/go/analysis">fatos</a> .  Os diagn√≥sticos s√£o enviados aos usu√°rios e os fatos devem ser usados ‚Äã‚Äãpor outros analisadores. </p><br><p>  O diagn√≥stico pode ter um conjunto de <a href="https://godoc.org/golang.org/x/tools/go/analysis">corre√ß√µes sugeridas</a> , cada uma descrevendo como alterar os c√≥digos-fonte no intervalo especificado para corrigir o problema encontrado pelo diagn√≥stico. </p><br><p>  A descri√ß√£o oficial est√° dispon√≠vel em <a href=""><code>go/analysis/doc/suggested_fixes.md</code></a> . </p><br><h1 id="zaklyuchenie">  Conclus√£o </h1><br><p><img src="https://habrastorage.org/webt/m3/bs/zw/m3bszwzp2nwkxrnxdnenypatyjk.png"></p><br><p>  Experimente a <code>ruleguard</code> de <code>ruleguard</code> em seus projetos e, se encontrar um erro ou desejar solicitar um novo recurso, <a href="https://github.com/quasilyte/go-ruleguard/issues/new">abra um problema</a> . </p><br><p>  Se voc√™ ainda acha dif√≠cil criar um aplicativo de <code>ruleguard</code> , aqui est√£o alguns exemplos: </p><br><ul><li>  Implemente seu pr√≥prio diagn√≥stico para o Go. </li><li>  Atualize ou refatore automaticamente o c√≥digo com <code>-fix</code> . </li><li>  Coleta de estat√≠sticas de c√≥digo com o processamento <a href=""><code>-json</code></a> do resultado do <a href=""><code>-json</code></a> . </li></ul><br><p>  Planos de desenvolvimento para <code>ruleguard</code> de <code>ruleguard</code> em um futuro pr√≥ximo: </p><br><ul><li>  <code>ruleguard</code> ao <a href="https://github.com/go-critic/go-critic"><code>go-critic</code></a> como uma maneira de expandi-la. </li><li>  Experimente as id√©ias da <a href="https://github.com/quasilyte/talks/tree/master/2019-7-Oct-moscow">an√°lise de similaridade de c√≥digo Applied Go</a> . </li><li>  Adicione novos recursos ao DSL.  <a href="https://github.com/quasilyte/go-ruleguard/issues/28">sub-correspond√™ncias</a> podem ser uma adi√ß√£o √∫til. </li></ul><br><h1 id="poleznye-ssylki-i-resursy">  Links e recursos √∫teis </h1><br><ul><li>  Arquivo de regras de exemplo recomendado: <a href=""><code>rules.go</code></a> </li><li> <a href="https://godoc.org/github.com/quasilyte/go-ruleguard/dsl/fluent"><code> dsl/fluent</code></a> </li> <li> <a href="https://godoc.org/github.com/quasilyte/go-ruleguard/ruleguard"><code> ruleguard</code></a> </li> <li>  <a href="https://github.com/mvdan/gogrep"><code>mvdan/gogrep</code></a> AST usado: <a href="https://github.com/mvdan/gogrep"><code>mvdan/gogrep</code></a> </li><li>  <a href="https://habr.com/ru/company/vk/blog/473718/">Verifica√ß√µes din√¢micas no NoVerify</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt481696/">https://habr.com/ru/post/pt481696/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt481680/index.html">Escrevendo TodoMVC no dap. Parte 2</a></li>
<li><a href="../pt481684/index.html">Um laptop da Powerbank?</a></li>
<li><a href="../pt481688/index.html">Por que aprender Java e como faz√™-lo com efici√™ncia. Relat√≥rio Yandex</a></li>
<li><a href="../pt481692/index.html">Usando o rastreamento do processador Intel para rastrear o c√≥digo do modo de gerenciamento do sistema</a></li>
<li><a href="../pt481694/index.html">Meu caminho para particionar no PostgreSQL</a></li>
<li><a href="../pt481698/index.html">Transmiss√£o WebRTC dentro e ao redor da realidade virtual</a></li>
<li><a href="../pt481700/index.html">Sobre uma tia</a></li>
<li><a href="../pt481702/index.html">Da torradeira ao drone. Como surgiu a Internet das coisas e por que ela disparou apenas 30 anos depois</a></li>
<li><a href="../pt481704/index.html">Esta √© a norma - 2: como mapas normais s√£o criados</a></li>
<li><a href="../pt481706/index.html">Computadores qu√¢nticos perdidos na corrida e seus erros fatais</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>