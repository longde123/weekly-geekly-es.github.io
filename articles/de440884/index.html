<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üç® ‚òùüèø üë∞üèΩ Die Verarbeitung nicht behebbarer Fehler in Swift ‚õàÔ∏è ‚ö°Ô∏è ‚òòÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Vorwort 


 Dieser Artikel ist ein Beispiel daf√ºr, wie wir das Verhalten von Swift Standard Library-Funktionen untersuchen k√∂nnen, indem wir unser Wis...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Die Verarbeitung nicht behebbarer Fehler in Swift</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/440884/"><h2 id="preface">  Vorwort </h2><br><p>  Dieser Artikel ist ein Beispiel daf√ºr, wie wir das Verhalten von Swift Standard Library-Funktionen untersuchen k√∂nnen, indem wir unser Wissen nicht nur auf der Bibliotheksdokumentation, sondern auch auf dem Quellcode aufbauen. </p><br><h2 id="unrecoverable-errors">  Nicht behebbare Fehler </h2><br><p>  Alle Ereignisse, die Programmierer als "Fehler" bezeichnen, k√∂nnen in zwei Typen unterteilt werden. </p><br><ul><li>  Ereignisse, die durch externe Faktoren wie einen Netzwerkverbindungsfehler verursacht werden. </li><li>  Ereignisse, die durch einen Fehler eines Programmierers verursacht wurden, z. B. das Erreichen eines Switch-Operator-Falls, der nicht erreichbar sein sollte. </li></ul><a name="habracut"></a><br><p>  Die Ereignisse des ersten Typs werden in einem regul√§ren Kontrollfluss verarbeitet.  Zum Beispiel reagieren wir auf Netzwerkfehler, indem wir einem Benutzer eine Nachricht anzeigen und eine App so einstellen, dass sie auf die Wiederherstellung der Netzwerkverbindung wartet. </p><br><p>  Wir versuchen, Ereignisse des zweiten Typs so fr√ºh wie m√∂glich herauszufinden und zu beseitigen, bevor der Code in Produktion geht.  Einer der Ans√§tze hier besteht darin, einige <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Laufzeitpr√ºfungen</a> durchzuf√ºhren <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">, die die Programmausf√ºhrung</a> in einem debuggbaren Zustand beenden, und eine Nachricht mit einer Angabe zu drucken, wo im Code der Fehler aufgetreten ist. </p><br><p>  Beispielsweise kann ein Programmierer die Ausf√ºhrung beenden, wenn der erforderliche Initialisierer nicht bereitgestellt, sondern aufgerufen wurde.  Dies wird beim ersten Testlauf immer bemerkt und behoben. </p><br><pre><code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">required</span></span> <span class="hljs-keyword"><span class="hljs-keyword">init</span></span>?(coder aDecoder: <span class="hljs-type"><span class="hljs-type">NSCoder</span></span>) { <span class="hljs-built_in"><span class="hljs-built_in">fatalError</span></span>(<span class="hljs-string"><span class="hljs-string">"init(coder:) has not been implemented"</span></span>) }</code> </pre> <br><p>  Ein weiteres Beispiel ist das Umschalten zwischen Indizes (nehmen wir an, dass Sie aus irgendeinem Grund keine Aufz√§hlung verwenden k√∂nnen). </p><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> index { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>: <span class="hljs-comment"><span class="hljs-comment">// something is done here case 1: // other thing is done here case 2: // and other thing is done here default: assertionFailure("Impossible index") }</span></span></code> </pre> <br><p>  Auch hier wird ein Programmierer beim Debuggen einen Absturz verursachen, um unweigerlich einen Fehler bei der Indizierung zu bemerken. </p><br><p>  Es gibt f√ºnf Abschlussfunktionen aus der Swift Standard Library (wie bei Swift 4.2). </p><br><pre> <code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">precondition</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> condition: @autoclosure </span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">()</span></span></span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Bool</span></span>, <span class="hljs-number"><span class="hljs-number">_</span></span> message: <span class="hljs-meta"><span class="hljs-meta">@autoclosure</span></span> () -&gt; <span class="hljs-type"><span class="hljs-type">String</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>, file: <span class="hljs-type"><span class="hljs-type">StaticString</span></span> = #file, line: <span class="hljs-type"><span class="hljs-type">UInt</span></span> = #line)</code> </pre> <br><pre> <code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">preconditionFailure</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> message: @autoclosure </span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">()</span></span></span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">String</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>, file: <span class="hljs-type"><span class="hljs-type">StaticString</span></span> = #file, line: <span class="hljs-type"><span class="hljs-type">UInt</span></span> = #line) -&gt; <span class="hljs-type"><span class="hljs-type">Never</span></span></code> </pre> <br><pre> <code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">assert</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> condition: @autoclosure </span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">()</span></span></span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Bool</span></span>, <span class="hljs-number"><span class="hljs-number">_</span></span> message: <span class="hljs-meta"><span class="hljs-meta">@autoclosure</span></span> () -&gt; <span class="hljs-type"><span class="hljs-type">String</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>, file: <span class="hljs-type"><span class="hljs-type">StaticString</span></span> = #file, line: <span class="hljs-type"><span class="hljs-type">UInt</span></span> = #line)</code> </pre> <br><pre> <code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">assertionFailure</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> message: @autoclosure </span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">()</span></span></span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">String</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>, file: <span class="hljs-type"><span class="hljs-type">StaticString</span></span> = #file, line: <span class="hljs-type"><span class="hljs-type">UInt</span></span> = #line)</code> </pre> <br><pre> <code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fatalError</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> message: @autoclosure </span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">()</span></span></span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">String</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>, file: <span class="hljs-type"><span class="hljs-type">StaticString</span></span> = #file, line: <span class="hljs-type"><span class="hljs-type">UInt</span></span> = #line) -&gt; <span class="hljs-type"><span class="hljs-type">Never</span></span></code> </pre> <br><p>  <strong>Welche der f√ºnf Abschlussfunktionen sollten wir bevorzugen?</strong> </p><br><h2 id="source-code-vs-documentation">  Quellcode vs Dokumentation </h2><br><p>  Schauen wir uns den <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Quellcode an</a> .  Folgendes k√∂nnen wir sofort sehen: </p><br><ol><li>  Jede dieser f√ºnf Funktionen beendet entweder die Programmausf√ºhrung oder f√ºhrt nichts aus. </li><li>  Eine m√∂gliche K√ºndigung erfolgt auf zwei Arten. <br><ul><li>  Beim Drucken einer praktischen Debug-Nachricht durch Aufrufen von <code>_assertionFailure(_:_:file:line:flags:)</code> . </li><li>  Ohne die Debug-Nachricht nur durch Aufrufen von <code>Builtin.condfail(error._value)</code> oder <code>Builtin.int_trap()</code> . </li></ul></li><li>  Der Unterschied zwischen den f√ºnf Abschlussfunktionen liegt in den Bedingungen, unter denen all dies geschieht. </li><li>  <code>fatalError(_:file:line)</code> ruft <code>_assertionFailure(_:_:file:line:flags:)</code> . </li><li>  Die anderen vier Abschlussfunktionen bewerten die Bedingungen durch Aufrufen der folgenden Konfigurationsbewertungsfunktionen.  (Sie beginnen mit einem Unterstrich, was bedeutet, dass sie intern sind und nicht direkt von einem Programmierer aufgerufen werden sollen, der die Swift Standard Library verwendet.) <br><ul><li> <code>_isReleaseAssertConfiguration()</code> </li> <li> <code>_isDebugAssertConfiguration()</code> </li> <li> <code>_isFastAssertConfiguration()</code> </li> </ul></li></ol><br><p>  Schauen wir uns nun die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Dokumentation an</a> .  Wir k√∂nnen das Folgende sofort sehen. </p><br><ol><li>  <code>fatalError(_:file:line)</code> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">druckt bedingungslos eine bestimmte Nachricht und stoppt die Ausf√ºhrung</a> . </li><li>  Die Auswirkungen der anderen vier Beendigungsfunktionen variieren je nach verwendetem Build-Flag: <code>-Onone</code> , <code>-O</code> , <code>-Ounchecked</code> .  Schauen Sie sich zum Beispiel die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Dokumentation</a> zu <code>preconditionFailure(_:file:line:)</code> . </li><li>  Wir k√∂nnen diese Build-Flags in Xcode √ºber <code>SWIFT_OPTIMIZATION_LEVEL</code> Compiler-Build-Einstellung <code>SWIFT_OPTIMIZATION_LEVEL</code> setzen. </li><li>  Aus der Xcode 10- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Dokumentation</a> wissen wir auch, dass ein weiteres Optimierungsflag - <code>-Osize</code> - eingef√ºhrt wird. </li><li>  Daher m√ºssen wir die vier Optimierungs-Build-Flags ber√ºcksichtigen. <br><ul><li>  <code>-Onone</code> (nicht optimieren) </li><li>  <code>-O</code> (Geschwindigkeit optimieren) </li><li>  <code>-Osize</code> (Gr√∂√üe optimieren) </li><li>  <code>-Ounchecked</code> (viele Compilerpr√ºfungen ausschalten) </li></ul></li></ol><br><p>  Wir k√∂nnen daraus schlie√üen, dass die in den vier Abschlussfunktionen ausgewertete Konfiguration durch diese Build-Flags festgelegt wird. </p><br><h2 id="running-configuration-evaluation-functions">  Ausf√ºhren von Konfigurationsbewertungsfunktionen </h2><br><p>  Obwohl Konfigurationsbewertungsfunktionen f√ºr den internen Gebrauch konzipiert sind, sind einige von ihnen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">zu Testzwecken √∂ffentlich</a> , und wir k√∂nnen sie √ºber die CLI <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">testen</a> und die folgenden Befehle in Bash eingeben. </p><br><pre> <code class="bash hljs">$ <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">'print(_isFastAssertConfiguration())'</span></span> &gt;conf.swift $ swift conf.swift <span class="hljs-literal"><span class="hljs-literal">false</span></span> $ swift -Onone conf.swift <span class="hljs-literal"><span class="hljs-literal">false</span></span> $ swift -O conf.swift <span class="hljs-literal"><span class="hljs-literal">false</span></span> $ swift -Osize conf.swift <span class="hljs-literal"><span class="hljs-literal">false</span></span> $ swift -Ounchecked conf.swift <span class="hljs-literal"><span class="hljs-literal">true</span></span></code> </pre> <br><pre> <code class="bash hljs">$ <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">'print(_isDebugAssertConfiguration())'</span></span> &gt;conf.swift $ swift conf.swift <span class="hljs-literal"><span class="hljs-literal">true</span></span> $ swift -Onone conf.swift <span class="hljs-literal"><span class="hljs-literal">true</span></span> $ swift -O conf.swift <span class="hljs-literal"><span class="hljs-literal">false</span></span> $ swift -Osize conf.swift <span class="hljs-literal"><span class="hljs-literal">false</span></span> $ swift -Ounchecked conf.swift <span class="hljs-literal"><span class="hljs-literal">false</span></span></code> </pre> <br><p>  Diese Tests und die √úberpr√ºfung des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Quellcodes</a> f√ºhren uns zu den folgenden groben Schlussfolgerungen. </p><br><p>  Es gibt drei sich gegenseitig ausschlie√üende Konfigurationen. </p><br><ul><li>  <em>Die Release-</em> Konfiguration wird festgelegt, indem entweder ein <code>-Osize</code> oder ein <code>-Osize</code> Build-Flag <code>-Osize</code> . </li><li>  <em>Die Debug-</em> Konfiguration wird festgelegt, indem entweder ein <code>-Onone</code> Build-Flag oder gar keine Optimierungsflags <code>-Onone</code> . </li><li>  <code>_isFastAssertConfiguration()</code> wird als <code>true</code> ausgewertet, wenn ein Build-Flag <code>-Ounchecked</code> gesetzt ist.  Obwohl diese Funktion ein Wort "schnell" im Namen hat, hat sie nichts mit der Optimierung f√ºr das Geschwindigkeit <code>-O</code> Build-Flag zu tun. </li></ul><br><p>  <strong>NB:</strong> Diese Schlussfolgerungen sind nicht die strikte Definition, wann <em>Debug-</em> oder <em>Release-</em> Builds stattfinden.  Es ist ein komplexeres Thema.  Diese Schlussfolgerungen sind jedoch f√ºr den Kontext der Beendigung der Funktionsnutzung richtig. </p><br><h2 id="simplifying-the-picture">  Das Bild vereinfachen </h2><br><h3 id="-ounchecked"> <code>-Ounchecked</code> </h3> <br><p>  Schauen wir uns nicht an, <strong>wof√ºr das Flag <code>-Ounchecked</code> ist</strong> (hier ist es irrelevant), sondern <strong>welche Rolle es</strong> im Zusammenhang mit der Beendigung der Funktionsnutzung spielt. </p><br><ul><li>  In der Dokumentation f√ºr die <code>precondition(_:_:file:line:)</code> und <code>assert(_:_:file:line:)</code> hei√üt es: "In <code>-Ounchecked</code> Builds wird die Bedingung nicht ausgewertet, aber das Optimierungsprogramm kann davon ausgehen, dass sie immer als true ausgewertet wird. Die Nichterf√ºllung dieser Annahme ist ein schwerwiegender Programmierfehler. " </li><li>  In der Dokumentation f√ºr <code>preconditionFailure(_:file:line)</code> und <code>assertionFailure(_:file:line:)</code> hei√üt es: "In <code>-Ounchecked</code> Builds kann der Optimierer davon ausgehen, dass diese Funktion niemals aufgerufen wird. Die <code>-Ounchecked</code> dieser Annahme ist ein schwerwiegender Programmierfehler. "" </li><li>  Wir k√∂nnen dem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Quellcode</a> <code>_isFastAssertConfiguration()</code> dass die Auswertung von <code>_isFastAssertConfiguration()</code> zu <code>true</code> <strong>nicht erfolgen sollte</strong> .  (In diesem Fall wird das seltsame <code>_conditionallyUnreachable()</code> aufgerufen. Siehe <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Zeilen 136 und</a> <code>_conditionallyUnreachable()</code> ) </li></ul><br><p>  Wenn Sie direkter sprechen, d√ºrfen Sie <strong>nicht zulassen, dass</strong> die folgenden vier Beendigungsfunktionen mit dem f√ºr Ihr Programm gesetzten Flag <code>-Ounchecked</code> Build erreichbar sind. </p><br><ul><li> <code>precondition(_:_:file:line:)</code> </li> <li> <code>preconditionFailure(_:file:line)</code> </li> <li> <code>assert(_:_:file:line:)</code> </li> <li> <code>assertionFailure(_:file:line:)</code> </li> </ul><br><p>  Verwenden <code>fatalError(_:file:line)</code> beim Anwenden von <code>-Ounchecked</code> nur <code>fatalError(_:file:line)</code> und lassen Sie gleichzeitig zu, dass der Punkt Ihres Programms mit der <code>fatalError(_:file:line)</code> erreichbar ist. </p><br><h3 id="the-role-of-a-condition-check">  Die Rolle einer Zustandspr√ºfung </h3><br><p>  Mit zwei der Abschlussfunktionen k√∂nnen wir die Bedingungen √ºberpr√ºfen.  Durch die √úberpr√ºfung des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Quellcodes</a> k√∂nnen wir feststellen, dass das Funktionsverhalten bei einem fehlgeschlagenen Zustand dem Verhalten des jeweiligen Cousins ‚Äã‚Äãentspricht: </p><br><ul><li>  <code>precondition(_:_:file:line:)</code> wird <code>preconditionFailure(_:file:line)</code> , </li><li>  <code>assert(_:_:file:line:)</code> wird zu <code>assertionFailure(_:file:line:)</code> . </li></ul><br><p>  Dieses Wissen erleichtert die weitere Analyse. </p><br><h3 id="release-vs-debug-configurations">  Release vs Debug-Konfigurationen </h3><br><p>  Durch weitere Dokumentation und √úberpr√ºfung des Quellcodes k√∂nnen wir schlie√ülich die folgende Tabelle formulieren. </p><br><p><img src="https://habrastorage.org/webt/x3/tq/vs/x3tqvsckgpqpyxso3flqfhyyddo.png" alt="Funktionen beenden"></p><br><p>  Es ist jetzt klar, dass die wichtigste Wahl f√ºr einen Programmierer ist, wie das Programmverhalten <strong>in der <em>Version</em></strong> aussehen sollte, wenn eine Laufzeitpr√ºfung einen Fehler aufdeckt. </p><br><p>  Der Schl√ºssel zum Erfolg ist, dass <code>assert(_:_:file:line:)</code> und <code>assertionFailure(_:file:line:)</code> die Auswirkungen von Programmfehlern weniger schwerwiegend machen.  Beispielsweise hat eine iOS-App m√∂glicherweise die Benutzeroberfl√§che besch√§digt (da einige wichtige Laufzeitpr√ºfungen fehlgeschlagen sind), st√ºrzt jedoch nicht ab. </p><br><p>  Aber dieses Szenario ist m√∂glicherweise nicht das, das Sie wollten.  Sie haben die Wahl. </p><br><h2 id="never-return-type">  <code>Never</code> Typ zur√ºck </h2><br><p>  <code>Never</code> wird als R√ºckgabefunktion verwendet, die bedingungslos einen Fehler ausl√∂st, abf√§ngt oder auf andere Weise nicht normal beendet wird.  Diese Arten von Funktionen kehren nicht zur√ºck, sie kehren <strong>niemals</strong> zur√ºck. </p><br><p>  Unter den f√ºnf Abschlussfunktionen geben nur <code>preconditionFailure(_:file:line)</code> und <code>fatalError(_:file:line)</code> <code>Never</code> da nur diese beiden Funktionen die Programmausf√ºhrung bedingungslos stoppen und daher niemals zur√ºckkehren. </p><br><p>  Hier ist ein sch√∂nes Beispiel f√ºr die Verwendung von <code>Never</code> type in einer Befehlszeilen-App.  (Obwohl in diesem Beispiel keine Abschlussfunktionen der Swift Standard Library verwendet werden, sondern stattdessen die Standardfunktion C <code>exit()</code> ). </p><br><pre> <code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">printUsagePromptAndExit</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Never</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">print</span></span>(<span class="hljs-string"><span class="hljs-string">"Usage: command directory"</span></span>) exit(<span class="hljs-number"><span class="hljs-number">1</span></span>) } <span class="hljs-keyword"><span class="hljs-keyword">guard</span></span> <span class="hljs-type"><span class="hljs-type">CommandLine</span></span>.argc == <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { printUsagePromptAndExit() } <span class="hljs-comment"><span class="hljs-comment">// ...</span></span></code> </pre> <br><p>  Wenn <code>printUsagePromptAndExit()</code> <code>Void</code> anstelle von <code>Never</code> zur√ºckgibt, wird ein Buildtime-Fehler mit der Meldung " <em>'guard' body darf nicht</em> durchfallen, verwenden Sie <em>'return' oder 'throw', um den Bereich zu verlassen</em> " erhalten.  Wenn Sie <code>Never</code> , sagen Sie im Voraus, dass Sie den Bereich <strong>niemals</strong> verlassen und der Compiler Ihnen daher keinen Buildtime-Fehler gibt.  Andernfalls sollten Sie am Ende des Guard-Code-Blocks <code>return</code> hinzuf√ºgen, was nicht gut aussieht. </p><br><h2 id="takeaways">  Imbissbuden </h2><br><ul><li>  Es spielt keine Rolle, welche Abschlussfunktion verwendet werden soll, wenn Sie sicher sind, dass alle Ihre Laufzeitpr√ºfungen nur f√ºr die <em>Debug-</em> Konfiguration relevant sind. </li><li>  Verwenden <code>fatalError(_:file:line)</code> beim Anwenden von <code>-Ounchecked</code> nur <code>fatalError(_:file:line)</code> und lassen Sie gleichzeitig zu, dass der Punkt Ihres Programms mit der <code>fatalError(_:file:line)</code> erreichbar ist. </li><li>  Verwenden Sie <code>assert(_:_:file:line:)</code> und <code>assertionFailure(_:file:line:)</code> wenn Sie bef√ºrchten, dass Laufzeitpr√ºfungen in der Version fehlschlagen k√∂nnten.  Zumindest st√ºrzt Ihre App nicht ab. </li><li>  Verwenden Sie <code>Never</code> , um Ihren Code ordentlich aussehen zu lassen. </li></ul><br><h2 id="useful-links">  N√ºtzliche Links </h2><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">WWDC-Video "Was ist neu in Swift</a> <code>SWIFT_OPTIMIZATION_LEVEL</code> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">" Mit</a> <code>SWIFT_OPTIMIZATION_LEVEL</code> Build-Einstellung <code>SWIFT_OPTIMIZATION_LEVEL</code> (ab 11 Minuten). </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Wie nie intern in Swift funktioniert</a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><code>NSHipster's article about nature of Never</code></a> </li> <li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Diskussion in den Swift-Foren</a> √ºber Vorschl√§ge zur <code>-Ounchecked</code> . </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de440884/">https://habr.com/ru/post/de440884/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de440872/index.html">PostGIS und JPA</a></li>
<li><a href="../de440874/index.html">Implementierung der freien Partikelbewegung auf ReactJS</a></li>
<li><a href="../de440878/index.html">Webanalyse f√ºr Unternehmen</a></li>
<li><a href="../de440880/index.html">Top 10 IoT-Sensoren im Jahr 2019</a></li>
<li><a href="../de440882/index.html">Entfliehen Sie Crypto Pro. GOST 34.10-2012 Ausgabe</a></li>
<li><a href="../de440886/index.html">Soft Delete in der REST-API</a></li>
<li><a href="../de440888/index.html">Unabh√§ngige Tests von Baikal-T1 - dem ersten russischen 28-nm-SoC - und BFK 3.1 Evaluation Board</a></li>
<li><a href="../de440890/index.html">Patriotismus in Computerspielen: die Meinung eines ehemaligen Spielers</a></li>
<li><a href="../de440892/index.html">Die unerwartete Effizienz quasi zuf√§lliger Sequenzen</a></li>
<li><a href="../de440894/index.html">Sound f√ºr Pathfinder entwerfen: Kingmaker</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>