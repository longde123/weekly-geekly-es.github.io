<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🙊 👀 👨‍🎓 Raspberry Pi NES墨盒 😔 💅🏼 🌡️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="你好 这是基于Raspberry Pi的复古游戏机。 在NES游戏机的墨盒中。 可以将集成屏幕用于游戏。 通过HDMI输出视频时，它会显示游戏封面的图像以及核心温度，请参见照片。 我建议您稍作思索，并阅读有关此类设备的组装和配置的信息。 注意，然后会有大量流量和照片。 

 怀旧 
 在童年时代，我...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Raspberry Pi NES墨盒</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/422005/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/sc/kd/6i/sckd6ialjgjcnygsp6mgbbarxqo.jpeg"></div><br> 你好 这是基于Raspberry Pi的复古游戏机。 在NES游戏机的墨盒中。 可以将集成屏幕用于游戏。 通过HDMI输出视频时，它会显示游戏封面的图像以及核心温度，请参见照片。 我建议您稍作思索，并阅读有关此类设备的组装和配置的信息。 注意，然后会有大量流量和照片。 <br><a name="habracut"></a><br><h3> 怀旧 </h3><br> 在童年时代，我们（年龄在25-35岁之间）喜欢玩游戏机。 然后，控制台没有新词了，所以我将其称为。 我对游戏机的了解始于Dandy（NES克隆）。 超级马里奥兄弟（Super Mario Bros），魂斗罗（Contra），鸭子故事（Ducktales），巴特蟾蜍（Battletoads）只是<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">当时的热门歌曲</a> 。 然后整个院子将与我的朋友Sega（Sega Mega Drive）一起玩，如Sonic，Ultimate Mortal Combat 3，Contra Hard Corps等。 当Play Station推出时，我必须说，它并没有立即传给我们，《生化危机》系列给我们带来了真正令人恐惧的喜悦。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/s0/gf/wa/s0gfwacncy42u8kgyh-covaswb0.jpeg"></div><br> 这张照片帮助我消除了怀旧的眼泪。 我必须说，我不是第一个在NES墨盒中配备Raspberry Pi的人。 是的，这不是我的设备。 这款墨盒小巧美观，几乎是这些目的的理想之选。 里面有很多空间。 自己判断。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/xd/lj/rg/xdljrg9nhjqinlh68r08_ipb29g.jpeg"></div><br> 在Raspberry Pi Zero内，有一个USB集线器和一对延长线。 所有的棍棒都放在热熔胶上。 <br><br><h3> 组装方式 </h3><br> 我想收集相同或相似的东西。 选择了来自NES的相同墨盒。 其他选项很小，或者看起来不是很好。  Raspberry Pi 3B是复古车的炽热心脏。 在Ali上也购买了带有方便焊接针脚的USB连接器。 仅此而已。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/vp/pf/mt/vppfmtvulbrixf9fyl_k4s35lbc.jpeg"></div><br> 哦，是的，您将重复这个项目，不要带上损坏的墨盒。 他们很少。 采取一些更普遍或更鲜为人知的东西。 也可以选择与Ali一起使用墨盒，但是原装墨盒却能使人心旷神怡。 我的1986年发行。 <br><br> 如果将墨盒<i>固定</i>在三颗螺钉上，则还需要使用特殊的螺丝刀。 也有早期的墨盒选件，带有五个螺钉；它们用普通的平头螺丝刀拧开。 我只有一个。 <br><br> 用办公刀和钢锯条从刀片上切下所有干扰零件，并从中锯掉。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/eb/v2/99/ebv299uc5rqf8hnmpa8ixpplslc.jpeg"></div><br> 突出的连接器焊接到Raspberry Pi。 专家说，如果您先用焊钳小心地拆下连接器，然后一次焊接一根脚，就可以不用焊台。 全部粘到热熔胶上。 在USB连接器和覆盆子之间放置了一个由非消耗性塑料制成的绝缘子。 不要忘记将GND Raspberry Pi和USB连接器的主体连接起来（上图中未显示）。 否则，某些操纵杆将无法工作。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/la/jq/n8/lajqn8luf0sfi4jrqlhfsfvtvxu.jpeg"></div><br> 最后一个<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Retropie</a>安装在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">树莓上</a> 。 起初有<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Recalbox</a> ，但我拒绝了它，因为它不支持Playstation 1上的操纵杆振动。但是我必须说，就开箱即用的功能而言，Recalbox更为方便，您无需进行任何配置。 在Retropie一堆设置中，您可以无休止地进行自定义。 这就是我喜欢的东西。 <br> 这是发生了什么事。 任何带有xinput的操纵杆都已连接。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/4y/8k/rt/4y8krts6wihpqs0ki5gnd17cxbk.jpeg"></div><br><br><h3> 萤幕 </h3><br> 食欲与进食有关。 如何将屏幕嵌入墨盒中？ 播放或显示游戏的封面图像。  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">这样的屏幕</a>是有序的。 这是一个800 * 480 3.5英寸并行DPI屏幕，几乎使用了所有GPIO Raspberry Pi。 它在120 Hz模式下对我有效（但渲染仍为60 Hz），响应是即时的。 唯一的负面因素是6位矩阵。 仅262,144种颜色。 尽管总的来说，这并不是特别明显，但请自行判断。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/bs/lh/qa/bslhqal3q5wbgn7lvlisrcktvqk.jpeg"></div>  <i>游戏《 Comix Zone》中的屏幕截图（可点击）</i> <i><br></i> <br> 屏幕和Raspberry Pi的所有支脚均已焊接。 屏幕由破旧的IDE电缆中的两根电缆焊接而成。 屏幕下方安装了5毫米抵押贷款，它不接触墨盒的底壁。 绝缘带被粘在显示器的周围，以免侧面闪烁。 一切都粘在热胶上。 在顶盖上，我切开一个窗户并粘贴了2毫米厚的玻璃。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/cm/st/zo/cmstzo941-fnue36c5sz2k46o38.jpeg"></div><br> 为了开始在该屏幕上显示图像，您需要修复<i>/boot/config.txt</i>配置。 我为Windows所有者推荐<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">WinSCP</a> ，当通过SSH连接到Raspberry Pi时， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">WinSCP</a>可以像Total Commander中那样显示文件。 很舒服 特别是如果您在<i>shell</i>模式下<i>sudo su-</i>运行它，则可以访问所有文件。 <br><br> 不幸的是，当DPI屏幕打开时，HDMI视频输出不起作用。 因此，我在<i>/ boot /</i>文件夹中创建了两个<i>配置文件</i> ，一个是<i>config_hdmi.txt</i> ，另一个是<i>config_dpi.txt</i> 。  <i>config_hdmi.txt</i>配置将分辨率设置为1080p60Hz，并删除了过扫描。  <i>config_dpi.txt</i>包含屏幕的DPI设置。 <br><br><div class="spoiler">  <b class="spoiler_title">config_dpi.txt</b> <div class="spoiler_text"><pre><code class="hljs pgsql"># uncomment <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> you <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> <span class="hljs-keyword"><span class="hljs-keyword">no</span></span> picture <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> HDMI <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> a <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> "safe" mode #hdmi_safe=<span class="hljs-number"><span class="hljs-number">1</span></span> disable_overscan=<span class="hljs-number"><span class="hljs-number">1</span></span> # uncomment <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> force a specific HDMI mode (this will force VGA) #hdmi_group=<span class="hljs-number"><span class="hljs-number">1</span></span> #hdmi_mode=<span class="hljs-number"><span class="hljs-number">1</span></span> # Sound output. <span class="hljs-keyword"><span class="hljs-keyword">Set</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> <span class="hljs-keyword"><span class="hljs-keyword">comment</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> autodetect, <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> DVI, <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> force HDMI. #hdmi_drive=<span class="hljs-number"><span class="hljs-number">2</span></span> # <span class="hljs-keyword"><span class="hljs-keyword">Using</span></span> /etc/modules <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> deprecated <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-keyword"><span class="hljs-keyword">no</span></span> longer supported <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> <span class="hljs-number"><span class="hljs-number">4.4</span></span> kernel # So manually <span class="hljs-keyword"><span class="hljs-keyword">enable</span></span> audio dtparam=audio=<span class="hljs-keyword"><span class="hljs-keyword">on</span></span> config_hdmi_boost=<span class="hljs-number"><span class="hljs-number">0</span></span> # force hdmi <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> the tv can take <span class="hljs-type"><span class="hljs-type">time</span></span> <span class="hljs-keyword"><span class="hljs-keyword">before</span></span> sending the signal <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> the hdmi output hdmi_force_hotplug=<span class="hljs-number"><span class="hljs-number">1</span></span> # uncomment <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> composite PAL #sdtv_mode=<span class="hljs-number"><span class="hljs-number">2</span></span> # uncomment <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> lirc-rpi #dtoverlay=lirc-rpi #<span class="hljs-number"><span class="hljs-number">3.5</span></span> HD tft screen <span class="hljs-number"><span class="hljs-number">800</span></span>x480 dtoverlay=dpi24 overscan_left=<span class="hljs-number"><span class="hljs-number">0</span></span> overscan_right=<span class="hljs-number"><span class="hljs-number">0</span></span> overscan_top=<span class="hljs-number"><span class="hljs-number">0</span></span> overscan_bottom=<span class="hljs-number"><span class="hljs-number">0</span></span> #Banggood framebuffer_width=<span class="hljs-number"><span class="hljs-number">800</span></span> framebuffer_height=<span class="hljs-number"><span class="hljs-number">480</span></span> dtparam=spi=<span class="hljs-keyword"><span class="hljs-keyword">off</span></span> dtparam=i2c_arm=<span class="hljs-keyword"><span class="hljs-keyword">off</span></span> enable_dpi_lcd=<span class="hljs-number"><span class="hljs-number">1</span></span> display_default_lcd=<span class="hljs-number"><span class="hljs-number">1</span></span> dpi_output_format=<span class="hljs-number"><span class="hljs-number">0x6f015</span></span> dpi_group=<span class="hljs-number"><span class="hljs-number">2</span></span> dpi_mode=<span class="hljs-number"><span class="hljs-number">87</span></span> hdmi_timings=<span class="hljs-number"><span class="hljs-number">480</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">16</span></span> <span class="hljs-number"><span class="hljs-number">16</span></span> <span class="hljs-number"><span class="hljs-number">24</span></span> <span class="hljs-number"><span class="hljs-number">800</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">120</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">46080000</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span> display_rotate=<span class="hljs-number"><span class="hljs-number">3</span></span> # <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> you plug your tv at the same <span class="hljs-type"><span class="hljs-type">time</span></span> <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> your rpi <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> that the rpi switches <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> the hdmi <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> give a low resolution because tv had <span class="hljs-keyword"><span class="hljs-keyword">no</span></span> enough <span class="hljs-type"><span class="hljs-type">time</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> initialize it boot_delay=<span class="hljs-number"><span class="hljs-number">3</span></span> # uncomment <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> you don<span class="hljs-string"><span class="hljs-string">'t want the rainbow at startup #disable_splash=1 # default CEC name #cec_osd_name=recalbox dtparam=spi=off # Overclock gpu_mem_256=128 gpu_mem_512=256 gpu_mem_1024=256 overscan_scale=1 gpu_mem=256 start_x=0 enable_uart=0 avoid_safe_mode=1 kernel=zImage</span></span></code> </pre> <br></div></div><div class="spoiler">  <b class="spoiler_title">config_hdmi.txt</b> <div class="spoiler_text"><pre> <code class="hljs vhdl"># <span class="hljs-keyword"><span class="hljs-keyword">For</span></span> more options <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> information see # http://rpf.io/configtxt # Some settings may impact device functionality. See link above <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> details # uncomment <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> you get no picture <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> HDMI <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> a <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-string"><span class="hljs-string">"safe"</span></span> mode #hdmi_safe=<span class="hljs-number"><span class="hljs-number">1</span></span> # uncomment this <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> your display has a black border <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> unused pixels visible # <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> your display can output without overscan disable_overscan=<span class="hljs-number"><span class="hljs-number">1</span></span> # uncomment the following <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> adjust overscan. <span class="hljs-keyword"><span class="hljs-keyword">Use</span></span> <span class="hljs-built_in"><span class="hljs-built_in">positive</span></span> numbers <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> console # goes off screen, <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> negative <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> there <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> too much border #overscan_left=<span class="hljs-number"><span class="hljs-number">16</span></span> #overscan_right=<span class="hljs-number"><span class="hljs-number">16</span></span> #overscan_top=<span class="hljs-number"><span class="hljs-number">16</span></span> #overscan_bottom=<span class="hljs-number"><span class="hljs-number">16</span></span> # uncomment <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-keyword"><span class="hljs-keyword">force</span></span> a console size. By <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> it will be display<span class="hljs-symbol"><span class="hljs-symbol">'s</span></span> size minus # overscan. #framebuffer_width=<span class="hljs-number"><span class="hljs-number">1280</span></span> #framebuffer_height=<span class="hljs-number"><span class="hljs-number">720</span></span> # uncomment <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> hdmi display <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> detected <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> composite <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> being output hdmi_force_hotplug=<span class="hljs-number"><span class="hljs-number">1</span></span> # uncomment <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-keyword"><span class="hljs-keyword">force</span></span> a specific HDMI mode (this will <span class="hljs-keyword"><span class="hljs-keyword">force</span></span> VGA) hdmi_group=<span class="hljs-number"><span class="hljs-number">1</span></span> #<span class="hljs-number"><span class="hljs-number">1080</span></span>p60fps hdmi_mode=<span class="hljs-number"><span class="hljs-number">16</span></span> # uncomment <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-keyword"><span class="hljs-keyword">force</span></span> a HDMI mode rather than DVI. This can make audio work <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> # DMT (computer monitor) modes #hdmi_drive=<span class="hljs-number"><span class="hljs-number">2</span></span> # uncomment <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> increase <span class="hljs-keyword"><span class="hljs-keyword">signal</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> HDMI, <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> you have interference, blanking, <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> # no display #config_hdmi_boost=<span class="hljs-number"><span class="hljs-number">4</span></span> # uncomment <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> composite PAL #sdtv_mode=<span class="hljs-number"><span class="hljs-number">2</span></span> #uncomment <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> overclock the arm. <span class="hljs-number"><span class="hljs-number">700</span></span> MHz <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> the <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>. #arm_freq=<span class="hljs-number"><span class="hljs-number">800</span></span> # Uncomment some <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> <span class="hljs-keyword"><span class="hljs-keyword">all</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> these <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> enable the optional hardware interfaces #dtparam=i2c_arm=<span class="hljs-keyword"><span class="hljs-keyword">on</span></span> #dtparam=i2s=<span class="hljs-keyword"><span class="hljs-keyword">on</span></span> dtparam=spi=off # Uncomment this <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> enable the lirc-rpi module #dtoverlay=lirc-rpi # Additional overlays <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> parameters are documented /boot/overlays/README # Enable audio (loads snd_bcm2835) dtparam=audio=<span class="hljs-keyword"><span class="hljs-keyword">on</span></span> gpu_mem_256=<span class="hljs-number"><span class="hljs-number">128</span></span> gpu_mem_512=<span class="hljs-number"><span class="hljs-number">256</span></span> gpu_mem_1024=<span class="hljs-number"><span class="hljs-number">256</span></span> overscan_scale=<span class="hljs-number"><span class="hljs-number">1</span></span> gpu_mem=<span class="hljs-number"><span class="hljs-number">256</span></span> start_x=<span class="hljs-number"><span class="hljs-number">0</span></span> enable_uart=<span class="hljs-number"><span class="hljs-number">0</span></span></code> </pre> <br></div></div><br> 切换配置将是我们在网络上可用的自动脚本 <br>  \\ 192.168.x.xxx \ configs \ all \ autostart.sh或设备上的文件夹/opt/retropie/configs/all/autostart.sh <br><br><div class="spoiler">  <b class="spoiler_title">autostart.sh</b> <div class="spoiler_text"><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># Check to see if display is not connected _NOHDMI=$(tvservice -n ) || true # Check to make sure it's not already in LCD mode _ISLCD=$(tvservice -s | grep "LCD") || true # HDMI is connected - turn off backlight LCD _HDMI=$(tvservice -s | grep "0x12000a") || true if [ -z "$_NOHDMI" ]; then if [ "$_ISLCD" ]; then printf "NO HDMI connected, LCD DPI display config already active\n" #do nothing else printf "NO HDMI connected, Switching to LCD DPI display\n" #change config to Hyperpixel and reboot since no display detected sudo cp /boot/config_dpi.txt /boot/config.txt sudo reboot now fi elif [ "$_NOHDMI" ]; then if [ "$_ISLCD" ]; then printf "HDMI is connected, but LCD DPI config is being used\n" #we need to switch to HDMI display config and reboot sudo cp /boot/config_hdmi.txt /boot/config.txt sudo reboot now elif [ "$_HDMI" ]; then printf "HDMI is connected, HDMI config detected, so turning off LCD BL\n" #we need to shut off the backlight on the Hyperpixel display since we aren't using it #don't panic, a reboot automatically resets this - it isn't a persistent value #also to do this the config.txt file needs to load the backlight module on startup #to control it even if you aren't loading the overlay driver for the display # this comment #echo 1 | sudo tee /sys/class/backlight/rpi_backlight/bl_power else #debugging catchall - shouldn't happen since we expect 0x12000a - but you never know... printf "HDMI is connected, HDMI config detected, your tv might not like 1920x1080 resolution\n" fi else #do nothing - based on previous if statements - you either have HDMI or you don't have it... printf "Debug catchall point - sorry I can't help you out - I haven't run into the error state yet!\n" fi emulationstation #auto</span></span></code> </pre><br></div></div><br> 还编写了<i>switchscreen.sh</i>脚本，该脚本必须放在<i>/ home / pi / RetroPie / retropiemenu /中</i> 。 该脚本可手动切换配置，可从Retropie设置主菜单访问。 启动后，您需要拔出HDMI电缆，否则重新启动后，所有内容都会自动切换回原来的状态。 不要忘记注册脚本 <br><br><pre> <code class="bash hljs">chmod +x /home/pi/RetroPie/retropiemenu/switchscreen.sh</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">switchscreen.sh</b> <div class="spoiler_text"><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash # Check to see if display is dpi _DPI=$(grep dpi /boot/config.txt) || true if [ "$_DPI" ]; then printf "Switch to HDMI\n" sudo cp /boot/config_hdmi.txt /boot/config.txt sudo reboot now else printf "Switch to DPI LCD\n" sudo cp /boot/config_dpi.txt /boot/config.txt sudo reboot now fi exit 0</span></span></code> </pre> <br></div></div><br> 当HDMI打开时， <i>Autostart.sh</i>显示的代码跟踪将禁用屏幕的DPI。 我将此脚本复制到了Internet上，因此无法在我们的屏幕上使用。 我们可能会与晶体管混淆以关闭屏幕电源，但为什么呢，如果我们需要显示当前正在运行的游戏的封面图像。 您只需要弄清楚什么是DPI。 <br><br><h4> 并行显示接口（DPI） </h4><br> 如前所述，DPI是屏幕的并行接口。 此接口上的信息<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">一次</a> ， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">两次</a>且<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">计算错误</a> 。 好吧，现在这里是俄语。 <br><br> 在HDMI操作期间，使用控制台命令启用DPI的所有尝试均失败。 也许他做错了什么。 采用了计划B：将图像显示在小屏幕上，以编程方式拉动GPIO脚。 <br><br>  DPI的特征在于，在时钟信号的每个时钟周期将一个像素传输到显示器。 由于我们有一个6位矩阵，因此它们是18种用于三种颜色的引脚，并且还具有显示使能（指示有效日期），h_sync（在显示控制器中将水平行地址设置为零），v_sync（在显示控制器中将垂直行地址设置为零） ） 数据捕捉发生在时钟信号的下降沿。 如果我们根据此术语从config_dpi.txt中解密“ dpi_output_format = 0x6f015”行，这是已知的。 <br><br><div class="spoiler">  <b class="spoiler_title">dpi_output_format</b> <div class="spoiler_text"><pre> <code class="hljs pgsql">output_format = (dpi_output_format &gt;&gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0xf</span></span>; rgb_order = (dpi_output_format &gt;&gt; <span class="hljs-number"><span class="hljs-number">4</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0xf</span></span>; output_enable_mode = (dpi_output_format &gt;&gt; <span class="hljs-number"><span class="hljs-number">8</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x1</span></span>; invert_pixel_clock = (dpi_output_format &gt;&gt; <span class="hljs-number"><span class="hljs-number">9</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x1</span></span>; hsync_disable = (dpi_output_format &gt;&gt; <span class="hljs-number"><span class="hljs-number">12</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x1</span></span>; vsync_disable = (dpi_output_format &gt;&gt; <span class="hljs-number"><span class="hljs-number">13</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x1</span></span>; output_enable_disable = (dpi_output_format &gt;&gt; <span class="hljs-number"><span class="hljs-number">14</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x1</span></span>; hsync_polarity = (dpi_output_format &gt;&gt; <span class="hljs-number"><span class="hljs-number">16</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x1</span></span>; vsync_polarity = (dpi_output_format &gt;&gt; <span class="hljs-number"><span class="hljs-number">17</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x1</span></span>; output_enable_polarity = (dpi_output_format &gt;&gt; <span class="hljs-number"><span class="hljs-number">18</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x1</span></span>; hsync_phase = (dpi_output_format &gt;&gt; <span class="hljs-number"><span class="hljs-number">20</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x1</span></span>; vsync_phase = (dpi_output_format &gt;&gt; <span class="hljs-number"><span class="hljs-number">21</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x1</span></span>; output_enable_phase = (dpi_output_format &gt;&gt; <span class="hljs-number"><span class="hljs-number">22</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x1</span></span>; output_format: <span class="hljs-number"><span class="hljs-number">1</span></span>: DPI_OUTPUT_FORMAT_9BIT_666 <span class="hljs-number"><span class="hljs-number">2</span></span>: DPI_OUTPUT_FORMAT_16BIT_565_CFG1 <span class="hljs-number"><span class="hljs-number">3</span></span>: DPI_OUTPUT_FORMAT_16BIT_565_CFG2 <span class="hljs-number"><span class="hljs-number">4</span></span>: DPI_OUTPUT_FORMAT_16BIT_565_CFG3 <span class="hljs-number"><span class="hljs-number">5</span></span>: DPI_OUTPUT_FORMAT_18BIT_666_CFG1 <span class="hljs-number"><span class="hljs-number">6</span></span>: DPI_OUTPUT_FORMAT_18BIT_666_CFG2 <span class="hljs-number"><span class="hljs-number">7</span></span>: DPI_OUTPUT_FORMAT_24BIT_888 rgb_order: <span class="hljs-number"><span class="hljs-number">1</span></span>: DPI_RGB_ORDER_RGB <span class="hljs-number"><span class="hljs-number">2</span></span>: DPI_RGB_ORDER_BGR <span class="hljs-number"><span class="hljs-number">3</span></span>: DPI_RGB_ORDER_GRB <span class="hljs-number"><span class="hljs-number">4</span></span>: DPI_RGB_ORDER_BRG output_enable_mode: <span class="hljs-number"><span class="hljs-number">0</span></span>: DPI_OUTPUT_ENABLE_MODE_DATA_VALID <span class="hljs-number"><span class="hljs-number">1</span></span>: DPI_OUTPUT_ENABLE_MODE_COMBINED_SYNCS invert_pixel_clock: <span class="hljs-number"><span class="hljs-number">0</span></span>: RGB Data changes <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> rising edge <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">stable</span></span> at falling edge <span class="hljs-number"><span class="hljs-number">1</span></span>: RGB Data changes <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> falling edge <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">stable</span></span> at rising edge. hsync/vsync/output_enable_polarity: <span class="hljs-number"><span class="hljs-number">0</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> HDMI mode <span class="hljs-number"><span class="hljs-number">1</span></span>: inverted hsync/vsync/oe phases: <span class="hljs-number"><span class="hljs-number">0</span></span>: DPI_PHASE_POSEDGE <span class="hljs-number"><span class="hljs-number">1</span></span>: DPI_PHASE_NEGEDGE</code> </pre><br></div></div><br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/hn/ve/im/hnveimuds5y8a8yxdypngnbntjs.png"></div><br> 比特序列如上图所示。 对于以VSYNC开头的每条线，都有一个完整的HSYNC线测量周期。 这是一帧。 后廊和前廊是显示屏的所谓缩进，它们位于控制器的内存中，但不在屏幕上。 <br><br> 现在，从我们的config_dpi.txt中解码“ hdmi_timings = 480 0 16 16 24 800 0 4 2 2 0 0 0 120 0 46080000 6”行。 这里没有什么复杂的，只需按顺序编写参数即可。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/nn/nl/0n/nnnl0nnvr3b6-vhjhhyaarfkck8.png"></div><br> 该图片显示了哪些GPIO脚用于彩色渲染。 我们有模式5。注意，这些不是按顺序排列的，即GPIO表示法！ 其他信号时钟-GPIO 0，DE-GPIO 1，VSYNC-GPIO 2，HSYNC-GPIO 3。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/xj/vi/ni/xjvinid6ghfjkuk4mz8rsyzoevo.png"></div><br> 快速安装了python，必要的GPIO库，并编写了一个hello脚本，至少将屏幕涂成蓝色。 当Windows上的Notepad ++没有显示缩进处的缩进时，我也出现了认知失调，而换行时我做了制表符，而不是空格。 顺便说一句，VSCode犯了同样的错误，如何解决它，我没有找到。 <br><br><div class="spoiler">  <b class="spoiler_title">Python脚本</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> gpiozero <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> LED <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> time <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> sleep sleep_time = <span class="hljs-number"><span class="hljs-number">0.0</span></span> clock = LED(<span class="hljs-number"><span class="hljs-number">0</span></span>) de = LED(<span class="hljs-number"><span class="hljs-number">1</span></span>) vsync = LED(<span class="hljs-number"><span class="hljs-number">2</span></span>) hsync = LED(<span class="hljs-number"><span class="hljs-number">3</span></span>) red2 = LED(<span class="hljs-number"><span class="hljs-number">16</span></span>) red3 = LED(<span class="hljs-number"><span class="hljs-number">17</span></span>) red4 = LED(<span class="hljs-number"><span class="hljs-number">18</span></span>) red5 = LED(<span class="hljs-number"><span class="hljs-number">19</span></span>) red6 = LED(<span class="hljs-number"><span class="hljs-number">20</span></span>) red7 = LED(<span class="hljs-number"><span class="hljs-number">21</span></span>) green2 = LED(<span class="hljs-number"><span class="hljs-number">10</span></span>) green3 = LED(<span class="hljs-number"><span class="hljs-number">11</span></span>) green4 = LED(<span class="hljs-number"><span class="hljs-number">12</span></span>) green5 = LED(<span class="hljs-number"><span class="hljs-number">13</span></span>) green6 = LED(<span class="hljs-number"><span class="hljs-number">14</span></span>) green7 = LED(<span class="hljs-number"><span class="hljs-number">15</span></span>) blue2 = LED(<span class="hljs-number"><span class="hljs-number">4</span></span>) blue3 = LED(<span class="hljs-number"><span class="hljs-number">5</span></span>) blue4 = LED(<span class="hljs-number"><span class="hljs-number">6</span></span>) blue5 = LED(<span class="hljs-number"><span class="hljs-number">7</span></span>) blue6 = LED(<span class="hljs-number"><span class="hljs-number">8</span></span>) blue7 = LED(<span class="hljs-number"><span class="hljs-number">9</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">v_sync</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(frame)</span></span></span><span class="hljs-function">:</span></span> vsync.on() <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> n <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(frame): clock.on() <span class="hljs-comment"><span class="hljs-comment">#sleep(sleep_time) clock.off() #sleep(sleep_time) #print("vsync") vsync.off() pass def h_sync(frame): hsync.on() for n in range(frame): clock.on() #sleep(sleep_time) clock.off() #sleep(sleep_time) #print("hsync") hsync.off() pass def clc(frame): for n in range(frame): clock.on() #sleep(sleep_time) clock.off() #sleep(sleep_time) pass red2.off() red3.off() red4.off() red5.off() red6.off() red7.off() green2.off() green3.off() green4.off() green5.off() green6.off() green7.off() blue2.on() blue3.on() blue4.on() blue5.on() blue6.on() blue7.on() clock.off() de.off() #de.on() sleep(sleep_time) v_sync(2) clc(2) for row in range(5): v_sync(2) # v_back_porch(2) clc(2) for column in range(800): h_sync(16) # h_back_porch(16) clc(16) # LCD column de.on() clc(480) de.off() # h_front_porch(24) clc(24) # v_front_porch(4) clc(4) de.off() red2.off() red3.off() red4.off() red5.off() red6.off() red7.off() green2.off() green3.off() green4.off() green5.off() green6.off() green7.off() blue2.off() blue3.off() blue4.off() blue5.off() blue6.off() blue7.off()</span></span></code> </pre><br></div></div><br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/fs/tn/6t/fstn6tcvy0uylvjdjwncu1eztq0.gif"></div><br> 太慢了，Python。 令我惊讶的是，已经渲染的像素消失了。 尽管我的期望很明显。 <br><br> 决定用C重写所有内容。它的工作速度更快，大约每秒几帧。 屏幕像旧的CRT显示器或雷达上一样起伏不定。 您需要什么。 复古！ 该代码发布在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">GitHub上</a> 。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/q0/t_/jp/q0t_jphffgafbdwhtez0by7fmrs.gif"></div><br>  GPIO可通过BCM2837 SoC寄存器直接访问。 我在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">这里</a>举了代码示例。 <br><br> 一切始于一个很小的程序，但是现在也以小滚动条的形式显示处理器和内存的负载。 处理器温度以这种字体绘制。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/l-/g7/uk/l-g7uktr0ivlgmwzky-jgi0_690.png"></div><br> 要运行代码，您需要将存储库的内容复制到文件夹/ home / pi / lcd_screen /（谁知道如何在nix下写相对于二进制文件的路径而不是C中的工作文件夹？因此，到目前为止只写到该文件夹​​）并执行以下命令。 <br><br><pre> <code class="bash hljs">gcc ./lcd_screen/lcd.c -o ./lcd_screen/lcd chmod +x ./lcd_screen/lcd</code> </pre> <br> 或立即从发行版下载二进制文件。 要开始，您需要输入以下内容。  SUDO是访问GPIO所必需的。 <br><br><pre> <code class="bash hljs">sudo ./lcd_screen/lcd path/file.bmp usec_per_frame</code> </pre> <br> 其中“ path / file.bmp”是图像文件的路径，仅适用于BMP格式，“ usec_per_frame”是指帧之间的延迟（以微秒为单位），以免徒劳地加载处理器。 <br><br> 我们将自动启动LCD程序，以便在游戏运行时显示所需的封面。 当然，Retropie使用内置的刮刀装载封面。 <br> 安装图像转换器。 它将所有格式转换为程序支持的bmp。 同时，并调整大小，以使图像全屏显示。 <br><br><pre> <code class="bash hljs">sudo apt-get install imagemagick</code> </pre> <br> 在<i>/ opt / retropie / configs / all /</i>目录中，创建两个文件： <i>runco​​mmand-onstart.sh</i>和<i>runco​​mmand-onend.sh</i> 。 当加载/结束任何游戏时，Retropie会自动执行这些脚本。 请记住为每个文件分配chmod + x。 <br><br><div class="spoiler">  <b class="spoiler_title">runco​​mmand-onstart.sh</b> <div class="spoiler_text"><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/sh system="$1" emulator="$2" romname="$3" #with path #echo $system # LCD programm here: #find current config: dpi or hdmi _DPI=$(grep dpi /boot/config.txt) || true if ! [ "$_DPI" ]; #if hdmi then sudo killall lcd # remove path filename=$(basename "$romname") # remove extension filename="${filename%.*}" # add image path file_png="/home/pi/.emulationstation/downloaded_images/$system/$filename-image.png" file_jpg="/home/pi/.emulationstation/downloaded_images/$system/$filename-image.jpg" #if system snes and n64 then rotate image 270 degree if [ "$system" = "snes" ] || [ "$system" = "n64" ] then if test -f "$file_png"; #fing file then convert "$file_png" -resize '800x480' -type TrueColor -alpha Remove -rotate 270 /home/pi/lcd_screen/work.bmp elif test -f "$file_jpg"; then convert "$file_jpg" -resize '800x480' -type TrueColor -alpha Remove -rotate 270 /home/pi/lcd_screen/work.bmp else convert "/opt/retropie/configs/$system/launching.png" -resize '480x800' -type TrueColor -alpha Remove -rotate 180 /home/pi/lcd_screen/work.bmp fi else if test -f "$file_png"; then convert "$file_png" -resize '480x800' -type TrueColor -alpha Remove -rotate 180 /home/pi/lcd_screen/work.bmp elif test -f "$file_jpg"; then convert "$file_jpg" -resize '480x800' -type TrueColor -alpha Remove -rotate 180 /home/pi/lcd_screen/work.bmp else convert "/opt/retropie/configs/$system/launching.png" -resize '480x800' -type TrueColor -alpha Remove -rotate 180 /home/pi/lcd_screen/work.bmp fi fi #launch my lcd project sudo /home/pi/lcd_screen/lcd /home/pi/lcd_screen/work.bmp 400000 &amp; fi</span></span></code> </pre><br></div></div><div class="spoiler">  <b class="spoiler_title">runco​​mmand-onend.sh</b> <div class="spoiler_text"><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/sh _DPI=$(sudo grep dpi /boot/config.txt) || true if ! [ "$_DPI" ]; then sudo killall lcd sudo /home/pi/lcd_screen/lcd /home/pi/lcd_screen/retropie.bmp 50000 &amp; # cp /home/pi/lcd_screen/retropie.bmp /home/pi/lcd_screen/work.bmp fi</span></span></code> </pre> <br></div></div><br> 在开始脚本中，首先检查DPI连接的存在，然后搜索jpeg或png格式的图像，将其旋转到所需的角度，更改其大小并转换为bmp格式，然后我的程序以必要的参数开始。 <br><br><h3> 冷却方式 </h3><br>  Raspberry Pi 3B比Zero强大，并且需要良好的散热。 特别是在这种封闭的情况下。 在照片中可见一个小的散热器，在任何模拟器上玩了半个小时之后，核心温度达到80度并开始小跑。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/e6/kk/er/e6kkerc14t-yzonbam_vhkmjwwc.jpeg"></div><br> 订购了40 * 30 * 10毫米的离心风扇，但是直到它到达之前，我只是试图用3毫米的铝切成一块80 * 30毫米的小板。 到那时，我已经卸下了所有GPIO引脚，因此它们不再干扰板的安装。 另外，我还切出一块20 * 10mm的小片与芯片接触，并用板子做一个三明治。 这超出了我的所有期望，核心最高为65度。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/g2/wa/mz/g2wamz-kibms_rwlc-mfvec4ilq.jpeg"></div><br> 所以它看起来在里面。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/wu/is/5-/wuis5-glvpqtphs9dca4t1ro0us.jpeg"></div><br><br><h3> 到底是什么 </h3><br> 这是怎么玩的？ 太好了！ 伴随着尖叫声，击败游戏手柄，相互指责。 就像一次。 <br><br> 没有发现延迟或滞后。 <br><br> 屏幕当然很小，只有三英寸半。 五英寸智能手机宠坏了我们，但您可以玩。 文字可读，甚至很小。 我更喜欢HDMI。 <br><br> 您可以来找朋友，玩，便携性允许。 相关附件：电缆，电缆，操纵杆，充电装置要比控制台本身占用更多的空间。 <br><br><h3> 音效 </h3><br> 不幸的是，Raspberry Pi的标准声音令人无法满足。 带有无源滤波的PWM调制被用作声音系统。 因此，在PCM2704上购买了USB DAC。 主要是因为它的大小。 <br><br> 在小液晶显示屏上播放时，确实没有足够的声音输出，所以我还购买了NS8002上的3W微型放大器，并从8欧姆平板电脑上接了一个扬声器。 <br><br><div class="spoiler">  <b class="spoiler_title">USB DAC和NS8002</b> <div class="spoiler_text"><div style="text-align:center;"><img src="https://habrastorage.org/webt/-e/kz/cq/-ekzcqqsoepridapkfdlyqyosdy.jpeg"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/n3/fd/vl/n3fdvlnjxigbmpxkcrs7p_zf9a8.jpeg"></div><br></div></div><br> 所有这些都适合LCD屏幕。 会来，我会放。 <br><br><h3> 文件追溯 </h3><br> 组装完成。 以下是一些不太有趣的用于娱乐阅读的Retropie设置。 <br><br><div class="spoiler">  <b class="spoiler_title">着色器</b> <div class="spoiler_text"> 大多数能够模拟Raspberry Pi的控制台，其分辨率均为320x240像素。 按照今天的标准，这很小。 所有游戏在现代屏幕上均具有明显的像素化。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/3w/-b/_5/3w-b_5-_zrprhg8fevmnljwfjhm.png"></div><br> 作为Retropie的一部分的Retroarch的创建者解决了这个问题，并增加了对着色器的支持。 例如，我真的很喜欢预装的<i>xbr-lv1-noblend.glslp</i> 。 他从字面上拉出了细节。 见下文。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/v-/m9/ae/v-m9aedomgloew3mkbnrbaf52zo.png"></div>  <i>游戏《恶魔城：夜晚的交响曲》的屏幕截图，我建议你玩</i> <br><br> 要安装着色器，请转到菜单Retropie-&gt; <i>Configuration editor</i> 。 选择“ <i>配置基本的libretro模拟器选项”</i> ，然后选择“ <i>为所有libretro模拟器配置默认选项”</i> 。 然后将“ <i>Video Shader Enable</i> ”设置为“ true”，并将“ <i>Video Shader File”</i>设置为所需的着色器。 同样，将“ <i>视频模糊度</i> ”也设置为“ false”，因为它只会模糊图像。 您甚至可以选择诸如扫描线着色器之类的东西来发出CRT电视的效果。 但这并不适合所有人。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/0b5/699/a6f/0b5699a6ffc3ebebf5d3d88f9583bab8.png"></div><br> 渲染着色器是一项相当昂贵的操作。 分辨率等于或高于720p时，RPi 3B上会出现明显的卡纸。 因此，在同一菜单中，选择<i>渲染分辨率</i> “ 800x600”。 不用担心，如果您<i>之前</i>对<i>/boot/config.txt</i>文件<i>进行</i>了更改（如本文中所述），HDMI电缆上的屏幕分辨率将为1080p，但是仿真器将以800x600的分辨率渲染图像并将其拉伸到全屏。 而且他做得还不错。 至少使用着色器要好于没有着色器，并且1080p渲染是无用的，因为仍然以320x240的分辨率绘制游戏的视频数据。 <br></div></div><br><div class="spoiler">  <b class="spoiler_title">游戏杆设置</b> <div class="spoiler_text"> 如果您有任何xinput游戏手柄（Micro $ oft标准），它将可以。 它是在Retropie的第一次启动时配置的，也可以通过开始按钮-配置输入进行配置。 但是令人头疼。 为了不因专利诉讼而落伍，狡猾的海外人士用A和B，X和Y交换了按钮。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/um/9l/eo/um9leos1thydayxdflxs3ty4cf0.jpeg"></div><br> 如果您有xbox或类似产品的游戏手柄，则需要使用反转按钮进行配置，例如NES。 然后转到Retropie-&gt; <i>Retropie Setup</i> ，选择<i>Configuration / tools</i> ，然后选择<i>emulationstation</i> ，将“ Swapped” <i>放入ES</i>中的<i>Swap A / B Buttons中</i> 。 然后重新配置操纵杆。 <br><br> 另外，我不喜欢Retropie开发人员如何管理按钮式基金。 用于拍摄屏幕快照的按钮组合在哪里？ 为什么每次按下重置按钮都需要重置按钮？ 倒带和时间加速按钮在哪里？ <br><br> 要解决此问题，您需要在<i>/ opt / retropie / configs / all / retroarch-joypads /中使用</i>操纵杆名称编辑文件。 它也可以在<i>\\ 192.168.x.xxx \ configs \ all \ retroarch-joypads \</i>网络上使用。 通过更新程序对Retropie进行每次更新后，绑定的编号就会消失，因此我将不会上传整个配置。 我写道，我只更改了这些按钮。 当与热键（通常是操纵杆中间带有徽标的按钮）同时按下时，将执行它们。 <br><br><div class="spoiler">  <b class="spoiler_title">按钮配置</b> <div class="spoiler_text"><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">input_screenshot_btn</span></span> = <span class="hljs-string"><span class="hljs-string">"0"</span></span> input_rewind_btn = <span class="hljs-string"><span class="hljs-string">"h0left"</span></span> input_hold_fast_forward_btn = <span class="hljs-string"><span class="hljs-string">"h0right"</span></span> input_state_slot_increase_btn = <span class="hljs-string"><span class="hljs-string">"h0up"</span></span> input_state_slot_decrease_btn = <span class="hljs-string"><span class="hljs-string">"h0down"</span></span></code> </pre> <br></div></div><br> 此处分配了屏幕截图按钮，而不是重置按钮。 快进和快退（快退）在交叉按钮上配置：前进和后退。 向上和向下十字按钮更改保存槽。 <br><br> 必须在<i>/opt/retropie/configs/all/retroarch.cfg</i>配置中启用倒带。 只是不要在psx模拟器上启用Rewind，一切都会开始缓慢地变慢。  psx配置中默认情况下禁用倒带。 <br><br> 我也想补充一下蓝牙。 我自己不喜欢无线操纵杆，并且总是玩电缆。 老学校了。 对于喜欢无线游戏杆的人，您需要购买蓝牙加密狗并将其插入USB端口。 会更好，不会有任何问题。 我自己没有检查，但是有知识的人写。 <br><br><h3>  Xboxdrv </h3><br> 但这还不是全部。 在<i>程序</i>包管理器的<i>Retropie设置</i>中，您可以放置​​各种端口，例如，Openttd，Doom甚至是DOS Dosbox仿真器。 但是您将无法控制其中的操纵杆。 只有键盘和鼠标。 要解决此问题，您需要在包管理器中安装xboxdrv驱动程序，该驱动程序可以模拟击键。 只是从源头上讲，不需要执行自动运行，它不适合所有操纵杆。 <br><br> 我们将为游戏手柄编写启动脚本。 将以<i>下行</i>添加到<i>/opt/retropie/configs/all/runco​​mmand-onstart.sh</i>中的文件<i>末尾</i> 。 <br><br><div class="spoiler">  <b class="spoiler_title">runco​​mmand-onstart.sh</b> <div class="spoiler_text"><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># xboxdrv sudo killall &gt; /dev/null 2&gt;&amp;1 xboxdrv if [ "$1" = "pc" ] || [ "$1" = "openttd" ] || [ "$1" = "doom" ] || [ "$1" = "kodi" ]; then sudo /opt/retropie/supplementary/xboxdrv/bin/xboxdrv &gt; /dev/shm/runcommand.log 2&gt;&amp;1 \ --evdev /dev/input/event0 \ --silent \ --detach-kernel-driver \ --force-feedback \ --mimic-xpad \ --trigger-as-button \ --evdev-no-grab \ --evdev-absmap ABS_X=x1,ABS_Y=y1,ABS_RX=x2,ABS_RY=y2,ABS_HAT0X=dpad_x,ABS_HAT0Y=dpad_y \ --evdev-keymap KEY_#304=a,KEY_#305=b,KEY_#307=x,KEY_#308=y,KEY_#312=lt,KEY_#313=rt,KEY_#310=lb,KEY_#311=rb,KEY_#317=tl,KEY_#318=tr,KEY_#314=back,KEY_#315=start,KEY_#316=guide \ --axismap -Y1^deadzone:3000=Y1,-Y2^deadzone:3000=Y2 \ --ui-axismap x2^deadzone:3000=KEY_LEFT:KEY_RIGHT,y2=KEY_UP:KEY_DOWN \ --ui-axismap x1^deadzone:3000=REL_X:06,y1=REL_Y:06 \ --ui-axismap dpad_x^deadzone:0=KEY_LEFT:KEY_RIGHT,dpad_y^deadzone:0=KEY_UP:KEY_DOWN \ --ui-buttonmap rt=BTN_LEFT,lt=BTN_RIGHT,start=KEY_ENTER,back=KEY_ESC,tl=KEY_4,tr=KEY_5,lb=KEY_2,rb=KEY_3,a=KEY_SPACE,b=KEY_M,x=KEY_3,y=KEY_LEFTCTRL,guide=KEY_Y \ &amp; fi</span></span></code> </pre> <br></div></div><br>  $ 1是xboxdrv启动的目标系统。 您可以类推添加。  --evdev-absmap --evdev-keymap行负责将轴和按钮绑定到游戏杆。 上面的脚本是为Xbox One S控制器提供的，要找出与操纵杆的编号或名称相对应的轴和按钮，您需要在控制台中键入<i>evtest</i>命令。 同时，您可以看到哪个事件与我们的操纵杆相对应。 我在--evdev参数中有这个/ dev / input / event0。 <br><br>  --ui-axismap选项模拟鼠标轴和--ui-buttonmap键盘按钮。 在此示例中，触发器是鼠标按钮，左操纵杆是鼠标，右操纵杆是光标键。 单击开始，分别选择-输入和esc。 键盘数字附加在其余按钮上。 不幸的是，不可能使用键盘按钮下方的叉号。 由于某种原因，Xbox One S游戏杆拒绝工作。 <br><br> 像主题医院，OpenTTD等策略使用这种配置播放，但在射击游戏中播放情况稍差一些，但是您可以通过更改$ 1参数在同一文件中为射击游戏创建类似的启动脚本。 <br><br> 为了确保emulationstation中操纵杆的正常运行，您需要在退出游戏后完成xboxdrv。 为此，请将以下内容添加到<i>/opt/retropie/configs/all/runco​​mmand-onend.sh</i>文件的末尾。 <br><br><div class="spoiler">  <b class="spoiler_title">runco​​mmand-onend.sh</b> <div class="spoiler_text"><pre> <code class="bash hljs">sudo killall &gt; /dev/null 2&gt;&amp;1 xboxdrv</code> </pre> <br></div></div><br></div></div><br><div class="spoiler">  <b class="spoiler_title">如果更新Retropie时出现问题</b> <div class="spoiler_text"> 一次，我启动了Retropie更新，然后在解压缩内核时，内置的Wi-Fi掉线了。 设备启动，但未响应任何按钮，包括连接的键盘。 没有SSH，因为没有Wi-Fi，它无法响应键盘，因此您无法获得SD卡... <br><br> 我注意到键盘在启动时可以工作。 我按了Ctrl + C很多次，哦，控制台！ 但是，现在如何恢复Wi-Fi？ 这个词根本没有wlan0接口。 运行更新程序无济于事，因为它会从Internet提取文件。 <br><br>  /opt/retropie/configs/all/autostart.sh中的第一件事评论了emulationstation的启动和重新引导。<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">重新启动后，控制台加载，键盘开始工作。</font><font style="vertical-align: inherit;">进一步的谷歌如何返回WLAN给了这个。</font><font style="vertical-align: inherit;">该命令将重新配置所有已安装的软件包。</font><font style="vertical-align: inherit;">它有帮助。</font></font><br><br><pre> <code class="bash hljs">sudo dpkg --configure -a</code> </pre> <br></div></div><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使Retropie看起来不像Linux工作站</font></font></b> <div class="spoiler_text"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">加载控制台时，我不想查看Linux启动日志。</font><font style="vertical-align: inherit;">它破坏了90年代前缀的整个精神。</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">删除Linux启动日志</font></font></b> <div class="spoiler_text">     Linux,    <i>/boot/cmdline.txt</i>   .    . <br><br><div class="spoiler"> <b class="spoiler_title">cmdline.txt</b> <div class="spoiler_text"><pre> <code class="hljs pgsql">dwc_otg.lpm_enable=<span class="hljs-number"><span class="hljs-number">0</span></span> console=tty3 root=PARTUUID=f2d3cb4f<span class="hljs-number"><span class="hljs-number">-02</span></span> rootfstype=ext4 elevator=deadline fsck.repair=yes rootwait loglevel=<span class="hljs-number"><span class="hljs-number">3</span></span> consoleblank=<span class="hljs-number"><span class="hljs-number">0</span></span> plymouth.<span class="hljs-keyword"><span class="hljs-keyword">enable</span></span>=<span class="hljs-number"><span class="hljs-number">0</span></span> quiet vt.global_cursor_default=<span class="hljs-number"><span class="hljs-number">0</span></span> plymouth.<span class="hljs-keyword"><span class="hljs-keyword">enable</span></span>=<span class="hljs-number"><span class="hljs-number">0</span></span> plymouth.ignore-<span class="hljs-type"><span class="hljs-type">serial</span></span>-consoles splash</code> </pre> <br></div></div><br> ,   ,     ,   . <br>      motd. <br><br><pre> <code class="bash hljs">nano /etc/motd</code> </pre> <br>   . <br><br><pre> <code class="bash hljs">sudo nano /etc/systemd/system/autologin@.service</code> </pre> <br>       <br><br><pre> <code class="hljs powershell">ExecStart=-/sbin/agetty -<span class="hljs-literal"><span class="hljs-literal">-autologin</span></span> pi -<span class="hljs-literal"><span class="hljs-literal">-noclear</span></span> %I <span class="hljs-variable"><span class="hljs-variable">$TERM</span></span></code> </pre> <br>  <br><br><pre> <code class="hljs powershell">ExecStart=-/sbin/agetty -<span class="hljs-literal"><span class="hljs-literal">-skip</span></span><span class="hljs-literal"><span class="hljs-literal">-login</span></span> -<span class="hljs-literal"><span class="hljs-literal">-noclear</span></span> -<span class="hljs-literal"><span class="hljs-literal">-noissue</span></span> -<span class="hljs-literal"><span class="hljs-literal">-login</span></span><span class="hljs-literal"><span class="hljs-literal">-options</span></span> <span class="hljs-string"><span class="hljs-string">"-f pi"</span></span> %I <span class="hljs-variable"><span class="hljs-variable">$TERM</span></span></code> </pre> <br>      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="></a> . <br></div></div><br> ,        — splashscreen.   ,       .         \\192.168.x.xxx\splashscreens,      Retropie -&gt; <i>SPLASH SCREEN</i> -&gt; <i>Append Splashscreen to list</i> . <br><br> , ,     . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/er/n9/g6/ern9g6nb3z_5vcr5-3ussmqlk74.jpeg"></div><br>   Retropie  runcommand,           .         . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/fm/lk/9u/fmlk9ukwossgbtgjbpfvuy5lza4.png"></div><br>  ,   ,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="></a> . <br></div></div><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 还有什么可以做的 </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您可以不断改善。</font><font style="vertical-align: inherit;">我会给您几个可以完成的链接。</font><font style="vertical-align: inherit;">写一些您可以添加的有趣的东西。</font></font>谢谢您的关注。 <br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">安装</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dosbox</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和各种</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">端口</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">放置各种emulationstation主题。</font></font></a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">共享屏幕截图文件夹。</font></font></a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">安装网络浏览器。</font></font></a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">安装Retropie Web Manager</font></font></a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从主计算机的Steam链接Raspberry Pi。</font></font></a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最后安装残酷末日。</font></font></a> </li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 他值得。 </font></font><br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/iZ9WrEzyq3o" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN422005/">https://habr.com/ru/post/zh-CN422005/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN421991/index.html">在Amazon Web Services上托管Web应用程序。 便宜 这可能吗？</a></li>
<li><a href="../zh-CN421993/index.html">Python有趣而有用</a></li>
<li><a href="../zh-CN421995/index.html">编译网站和Web应用程序之间的差异</a></li>
<li><a href="../zh-CN422001/index.html">二氧化碳计</a></li>
<li><a href="../zh-CN422003/index.html">软件开发中的固定成本和可变成本</a></li>
<li><a href="../zh-CN422007/index.html">我如何进行在线互动式UPS（第1部分）</a></li>
<li><a href="../zh-CN422009/index.html">匈牙利算法，或数学如何帮助分配作业</a></li>
<li><a href="../zh-CN422011/index.html">青年物理学家比赛</a></li>
<li><a href="../zh-CN422013/index.html">微软眼镜追踪血压</a></li>
<li><a href="../zh-CN422015/index.html">人工智能-从实用仪器到人的进化</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>