<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®üèø‚Äçüè´ ‚òëÔ∏è üë©‚ÄçüöÄ Automation VS Chaos üè∏ üññüèª üìö</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="L'√©volution des technologies informatiques a permis de contr√¥ler d'√©normes flux de donn√©es. Les entreprises ont beaucoup de solutions informatiques: C...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Automation VS Chaos</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/436240/"><img src="https://habrastorage.org/webt/hj/s8/mq/hjs8mq4n1zefsd8fipawzx7j6ok.jpeg" alt="image"><br><br>  L'√©volution des technologies informatiques a permis de contr√¥ler d'√©normes flux de donn√©es.  Les entreprises ont beaucoup de solutions informatiques: CRM, ERP, BPM, syst√®mes comptables ou au moins juste Excel et Word.  Les entreprises sont √©galement diff√©rentes.  Certaines entreprises sont compos√©es de nombreuses succursales.  Appelons par exemple ¬´Pyramide¬ª.  Les pyramides ont un probl√®me de synchronisation des donn√©es pour une pile de syst√®mes informatiques.  Les √©diteurs de logiciels et les versions diff√®rent consid√©rablement pour les succursales.  De plus, la soci√©t√© de gestion modifie en permanence les exigences en mati√®re de rapports, ce qui provoque des attaques de frustration dans les succursales.  Il s'agit d'une histoire sur le projet o√π j'ai rencontr√© un chaos qui devait √™tre syst√©matis√© et automatis√©.  Le faible budget et les d√©lais serr√©s ont limit√© l'utilisation de la plupart des solutions industrielles existantes mais ont ouvert la voie √† la cr√©ativit√©. <br><a name="habracut"></a><br><h2>  Format √† usage g√©n√©ral </h2><br>  L'entreprise cliente a d√©fini une t√¢che pour collecter les donn√©es des rapports de toutes les succursales.  Permettez-moi d'expliquer l'ampleur du d√©fi - il existe des dizaines de syst√®mes, y compris les deux: self-made et des monstres tels que SAP. <br><br>  Un rapport pourrait contenir des donn√©es de: comptables, r√©parateurs, responsables des relations publiques, EMERCOM, m√©t√©orologues. <br><br>  Avant le d√©marrage du projet, une grande partie des donn√©es √©tait envoy√©e par e-mail √† la soci√©t√© m√®re sous forme de pi√®ces jointes Word / Excel.  √Ä partir de l√†, cela ressemblait √† un coucher de soleil fait manuellement: les donn√©es √©taient trait√©es manuellement par du personnel sp√©cialement √©tudi√© et plac√©es dans quelques syst√®mes.  Au final, des dizaines de rapports ont constitu√© la base des d√©cisions de gestion. <br><br>  Le choix de l'approche a √©t√© demand√© par les formats de fichiers utilis√©s - xlsx / docx.  M√™me le logiciel h√©rit√© prend en charge le t√©l√©chargement de donn√©es vers ces formats.  Au moins le copier-coller peut √™tre un dernier support pour les branches. <br><br>  Notre plan d'opinion √©tait donc: <br><br><ol><li>  D√©crivez la structure et le calendrier de chaque rapport. </li><li>  Fournir aux succursales des r√®glements sur les rapports.  Les succursales devraient utiliser le logiciel existant pour envoyer des rapports par e-mail.  S'il n'y a pas de logiciel - envoyez les rapports manuellement comme auparavant. </li><li>  D√©velopper le syst√®me, qui: </li></ol><br><ul><li>  prend les bons documents de la bo√Æte de r√©ception de courrier √©lectronique; </li><li>  extrait les donn√©es des documents; </li><li>  √©crit les donn√©es extraites dans la base de donn√©es et p√©nalise les contrevenants aux r√©glementations. </li></ul><br><img src="https://habrastorage.org/webt/is/7j/jm/is7jjmttswxfhyiieqcz5cepmha.png" alt="image"><br><h2>  Impl√©mentation </h2><br><h3>  Probl√®mes non li√©s au d√©veloppement </h3><br>  Lors de la collecte des exigences, il s'est av√©r√© qu'il n'y avait pas de description de la structure des rapports.  Rien du tout.  La structure du rapport a √©t√© stock√©e dans la t√™te de certains employ√©s et transf√©r√©e verbalement sous forme de contes populaires.  Ce probl√®me a √©t√© r√©solu avec quelques efforts, mais le v√©ritable d√©fi a commenc√© plus tard lors de la mise en place de la phase d'√©change de donn√©es. <br><br><h3>  Premier num√©ro </h3><br>  Quelques jours apr√®s la sortie de la version b√™ta, nous avons r√©v√©l√© un √©cart entre la structure des documents et le mod√®le de document.  Mauvaise qualit√© des donn√©es: les rapports pr√©sentaient des divergences de montants, les colonnes √©taient m√©lang√©es ou avaient une d√©nomination incorrecte.  Ces probl√®mes se sont principalement produits dans les succursales o√π les donn√©es ont √©t√© collect√©es et envoy√©es manuellement. <br><br>  Solution - mise en ≈ìuvre de la v√©rification en trois √©tapes: <br><br><ol><li>  Fournir aux branches des exemples xlsx dont la structure est fix√©e par les outils Excel.  Seules les cellules disponibles dans ces √©chantillons ont √©t√© saisies.  Certaines cellules font l'objet d'une v√©rification suppl√©mentaire: type, convergence des sommes, etc. </li><li>  V√©rification des donn√©es lors de l'extraction.  Par exemple, comparer la date et la date actuelles dans le paragraphe Word, v√©rification de l'arithm√©tique des donn√©es pour les documents Excel (s'il n'est pas possible de les d√©finir avec les outils xlsx). </li><li>  Analyse approfondie des donn√©es apr√®s extraction.  Par exemple, d√©tection d'√©carts significatifs par des indicateurs cl√©s par rapport aux p√©riodes pr√©c√©dentes. </li></ol><br><h3>  Deuxi√®me num√©ro </h3><br>  Une violation syst√©matique du calendrier de transfert de donn√©es ou des tentatives de sabotage sans scrupules: "Nous n'envoyons jamais de donn√©es √† personne, et vous voici avec votre ceci ...", "J'ai tout envoy√©!  √Ä l'heure!  Vous ne l'avez probablement pas obtenu en raison d'une mauvaise latence. " <br><br>  Le feedback est devenu une solution.  Le logiciel avertit automatiquement les personnes responsables de l'agence en cas de non-respect du planning. <br><br>  Quelque temps plus tard, le module de r√©troaction a √©t√© connect√© au module de v√©rification de la qualit√© des donn√©es et au module de g√©n√©ration des rapports finaux.  De cette fa√ßon, la branche re√ßoit imm√©diatement un r√©sum√© de ses propres donn√©es et une comparaison avec les ¬´branches voisines¬ª.  Il serait donc clair pour une succursale, pourquoi elle a √©t√© r√©primand√©e. <br><br><h2>  Modules d√©velopp√©s </h2><br>  Outil de configuration des mod√®les de rapport, qui d√©crit: <br><br><ul><li>  des attributs pour identifier un rapport; </li><li>  r√®glements de transmission; </li><li>  algorithme d'extraction de donn√©es; </li><li>  d'autres attributs tels que le chemin d'acc√®s au code qui valide et stocke les donn√©es. </li></ul><br>  Une application de messagerie √©lectronique qui d√©place les pi√®ces jointes vers un stockage isol√© (bac √† sable) et stocke les informations associ√©es aux lettres; <br><br>  Un analyseur de pi√®ces jointes qui identifie le rapport et extrait les donn√©es. <br><br><img src="https://habrastorage.org/webt/ym/iu/c5/ymiuc5d4tevhe9cnbkslpuj9fu8.png" alt="image"><br><br><h3>  Outil de configuration </h3><br>  Historiquement, les lettres contenant des rapports sont envoy√©es √† l'adresse e-mail commune, ainsi que de nombreuses autres lettres importantes ou sans importance.  C'est pourquoi nous avions besoin d'attributs pour identifier les types de pi√®ces jointes de rapport.  L'utilisation d'un certain nom ou texte de document dans le corps de l'e-mail n'est pas fiable et inconfortable pour l'exp√©diteur.  C'est pourquoi nous avons d√©cid√© que l'identification du rapport ne serait d√©termin√©e que par un contenu. <br><br>  Le brainstorming a abouti √† un tas d'attributs pour identifier le type de rapport par contenu: couleur du texte de la cellule, police, etc.  Mais le moyen le plus appropri√© est une pr√©sence de sous-cha√Æne dans une certaine cellule - ¬´slot¬ª, ou dans un tableau de cellules pour Excel.  Pour Word, nous avons utilis√© un paragraphe ou un titre. <br><br>  Nous avons ajout√© une logique de comparaison simple pour le ¬´cr√©neau¬ª: ¬´√©gal¬ª, ¬´in√©gal¬ª, ¬´plus¬ª, ¬´moins¬ª, etc.  Exemple de rapport Excel: dans la plage A2-E4, le texte de la cellule doit √™tre √©gal √† ¬´Rapport de chargement d'√©quipement quotidien¬ª. <br><br><img src="https://habrastorage.org/webt/r6/qf/qq/r6qfqqfzfos5m--nb5wnkucwu0g.png" alt="image"><br><br>  De la m√™me mani√®re, nous avons configur√© la zone de recherche pour le d√©but et la fin des donn√©es. <br><br>  Voici un exemple de condition de recherche pour la fin des donn√©es: ¬´2 lignes vides d'affil√©e¬ª. <br><br><img src="https://habrastorage.org/webt/jc/pu/ok/jcpuokqbs80ari66rbcfs82pljw.png" alt="image"><br><br>  Quelques autres param√®tres: une liste d'exp√©diteurs autoris√©s, un type de document (Excel / Word), un chemin pour l'exportation des donn√©es. <br><br>  La sortie est une structure JSON (mod√®le) qui d√©crit le rapport. <br><br><h3>  Application de messagerie </h3><br>  Cette application est un lecteur de bo√Æte de r√©ception de courrier √©lectronique qui place toutes les pi√®ces jointes dans le bac √† sable, enregistre les attributs de courrier √©lectronique, d√©finit les pi√®ces jointes dans la file d'attente d'analyse. <br><br>  Nous avons rencontr√© 2 probl√®mes de s√©curit√©: <br><br><ol><li>  que se passe-t-il si le nom de la branche dans le rapport est accidentellement (ou non) remplac√© par un autre nom de branche? </li><li>  que faire si le rapport est envoy√© par des intrus? </li></ol><br>  Le premier probl√®me est r√©solu en v√©rifiant l'adresse e-mail de l'exp√©diteur de la branche et le nom de la branche sp√©cifi√© dans le corps du rapport. <br><br>  Le deuxi√®me probl√®me est r√©solu √† l'aide de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">SPF</a> . <br><br><h3>  Analyseur de pi√®ces jointes </h3><br>  Presque toutes les biblioth√®ques d'analyse Word et Excel ne prennent en charge que certaines versions / extensions.  C'est pourquoi nous avons d√©cid√© d'utiliser la conversion ¬´Libre Office¬ª pour amener les fichiers dans un seul format.  Par exemple entr√©es: odt, doc, docx (2007, 2010, 2013) ... convertir en docx (2016). <br><br>  Apr√®s la conversion: <br><br><ol><li>  nous filtrons un tableau de mod√®les de rapport en fonction des attributs de base comme est-ce Word ou Excel, l'exp√©diteur appartient √† la liste autoris√©e; </li><li>  menacer le rapport avec les mod√®les restants; </li><li>  si un mod√®le correspond √† un rapport - extrayez les donn√©es et transf√©rez-les dans le r√©f√©rentiel. </li></ol><br><h2>  Reprendre </h2><br>  Nous l'avons fait! <br><br>  Apr√®s deux mois de travail minutieux, le si√®ge social a commenc√© √† recevoir r√©guli√®rement des donn√©es pour les rapports de toutes les succursales. <br><br>  La qualit√© et l'exhaustivit√© des donn√©es deviennent meilleures sans pr√©c√©dent par rapport √† ce qu'elles √©taient auparavant.  Le logiciel mis en ≈ìuvre a lib√©r√© des ressources humaines qui ont rembours√© les co√ªts du projet d'ici la fin de l'ann√©e. <br><br>  Pour nous, nous avons appris que le processus d'int√©gration n'est pas toujours douloureux et avons identifi√© les principaux aspects de la r√©ussite: <br><br><ol><li>  nous n'avons pas p√©n√©tr√© dans les syst√®mes des succursales; </li><li>  nous avons officialis√© et approuv√© une structure de rapport et un calendrier de transfert unifi√©s; </li><li>  nous avons fait des √©chantillons de sortie pour chaque type de rapport avec v√©rification int√©gr√©e; </li><li>  nous avons utilis√© le moyen le plus courant pour transmettre des donn√©es: un e-mail. </li></ol><br>  Enfin, cette approche pr√©sente deux inconv√©nients principaux: <br><br><ol><li>  faible vitesse de livraison des donn√©es; </li><li>  la taille du package de donn√©es ne doit pas √™tre sup√©rieure √† la pi√®ce jointe moyenne d'un e-mail </li></ol></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr436240/">https://habr.com/ru/post/fr436240/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr436230/index.html">Comment prendre le contr√¥le de votre infrastructure r√©seau. Chapitre Trois S√©curit√© du r√©seau. Deuxi√®me partie</a></li>
<li><a href="../fr436232/index.html">Strat√©gie de t√©l√©pathie</a></li>
<li><a href="../fr436234/index.html">Analyseurs applicatifs Haskell</a></li>
<li><a href="../fr436236/index.html">Nous utilisons la science des donn√©es pour d√©terminer le cycle de vie d'un client</a></li>
<li><a href="../fr436238/index.html">Authentification dans Kubernetes avec GitHub OAuth et Dex</a></li>
<li><a href="../fr436242/index.html">YOLO et autres m√©thodologies l√¢ches</a></li>
<li><a href="../fr436244/index.html">Le nouveau cerveau du professeur Lawrence</a></li>
<li><a href="../fr436246/index.html">Ing√©nierie automobile moderne - 02. Tr√®s th√®se sur OS</a></li>
<li><a href="../fr436248/index.html">Filtre de Kalman</a></li>
<li><a href="../fr436250/index.html">Patrons suceurs de sang hors de leur contexte ou pourquoi ils √©chouent toujours</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>