<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üè¥ üëãüèø ‚ôëÔ∏è Contribua para Ir com o analisador de cr√≠ticas cr√≠ticas üë©üèø‚Äç‚öïÔ∏è üòá üöµ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Voc√™ deve se lembrar do recente an√∫ncio de um novo analisador est√°tico para Go chamado go-critical . 


 Eu verifiquei o projeto golang / go com ele e...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Contribua para Ir com o analisador de cr√≠ticas cr√≠ticas</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/416903/"><p><img src="https://habrastorage.org/webt/fp/k0/rn/fpk0rncwtlo5ozovjev4yi_gok8.png"></p><br><p>  Voc√™ deve se lembrar do recente <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">an√∫ncio de um novo analisador est√°tico para Go</a> chamado <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">go-critical</a> . </p><br><p>  Eu verifiquei o projeto <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">golang / go</a> com ele e enviei alguns patches que corrigem alguns problemas encontrados l√°. </p><br><p>  Neste artigo, analisaremos o c√≥digo corrigido e tamb√©m estaremos motivados a enviar ainda mais altera√ß√µes ao Go. </p><br><p>  Para os mais impacientes: uma <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">lista atualizada de trof√©us</a> . </p><a name="habracut"></a><br><div class="spoiler">  <b class="spoiler_title">Ir lista de an√°lise</b> <div class="spoiler_text"><ol><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">net: combinar anexar chamadas em reverseaddr</a> <code>appendCombine</code> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">cmd / link / internal / ld: evite c√≥pias Reloc em loops de intervalo</a> <code>rangeValCopy</code> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">cmd / compile / internal / ssa: corrija o m√©todo</a> <code>dupSubExpr</code> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">tempo de execu√ß√£o: remova o deref expl√≠cito redundante no trace.go</a> <code>underef</code> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">cmd / link / internal / sym: c√≥digo de coment√°rio para casos de ELF em RelocName</a> <code>commentedOutCode</code> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">tempo de execu√ß√£o: simplifique a express√£o de fatia para o pr√≥prio valor</a> <code>unslice</code> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">html / template: use consts nomeados em vez de seus valores</a> <code>namedConst</code> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">cmd / internal / obj / arm64: simplifica algumas express√µes bool</a> <code>boolExprSimplify</code> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">math, net: omita a</a> <code>switchTrue</code> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">verdadeira expl√≠cita expr no switch</a> <code>switchTrue</code> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">archive / tar: remete par√™nteses redundantes nas express√µes de tipo</a> <code>typeUnparen</code> </li></ol></div></div><br><h1 id="dupsubexpr">  dupSubExpr </h1><br><p>  Todos cometemos erros e, muitas vezes, por desaten√ß√£o.  Go, sendo um idioma no qual voc√™ √†s vezes precisa escrever c√≥digo chato e clich√™, √†s vezes contribui para erros de digita√ß√£o e / ou erros de copiar / colar. </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">CL122776</a> cont√©m uma corre√ß√£o para um erro encontrado pelo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">dupSubExpr</a> : </p><br><pre> <code class="diff hljs">func (a partsByVarOffset) Less(i, j int) bool { - return varOffset(a.slots[a.slotIDs[i]]) &lt; varOffset(a.slots[a.slotIDs[i]]) + return varOffset(a.slots[a.slotIDs[i]]) &lt; varOffset(a.slots[a.slotIDs[j]]) // ^__________________________________^ }</code> </pre> <br><p>  Preste aten√ß√£o ao √≠ndice √† esquerda e √† direita.  Antes da corre√ß√£o, o LHS e o RHS do operador <code>&lt;</code> eram id√™nticos e o <code>dupSubExpr</code> trabalhava para <code>dupSubExpr</code> . </p><br><h1 id="commentedoutcode">  commentedOutCode </h1><br><p>  Se o seu projeto √© patrocinado <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">por um sistema de controle de vers√£o</a> , em vez de desabilitar o c√≥digo envolvendo-o em um coment√°rio, vale a pena exclu√≠-lo completamente.  Existem exce√ß√µes, mas com mais freq√º√™ncia esse c√≥digo "morto" interfere, confunde e pode ocultar erros. </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">commentedOutCode</a> p√¥de encontrar um fragmento t√£o interessante ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">CL122896</a> ): </p><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> arch.Family { <span class="hljs-comment"><span class="hljs-comment">// ...  case clause. case sys.I386: return elf.R_386(nr).String() case sys.MIPS, sys.MIPS64: // return elf.R_MIPS(nr).String() // &lt;- 1 case sys.PPC64: // return elf.R_PPC64(nr).String() // &lt;- 2 case sys.S390X: // return elf.R_390(nr).String() // &lt;- 3 default: panic("unreachable") }</span></span></code> </pre> <br><p>  H√° um coment√°rio um pouco mais alto: </p><br><pre> <code class="go hljs"><span class="hljs-comment"><span class="hljs-comment">// We didn't have some relocation types at Go1.4. // Uncomment code when we include those in bootstrap code.</span></span></code> </pre> <br><p>  Se voc√™ alternar para a ramifica√ß√£o <code>go1.4</code> e remover essas 3 linhas do coment√°rio, o c√≥digo n√£o ser√° compilado; no entanto, se voc√™ descoment√°-las no assistente, tudo funcionar√°. </p><br><p>  Normalmente, o c√≥digo oculto em um coment√°rio requer exclus√£o ou ativa√ß√£o reversa. </p><br><p>  De tempos em tempos, √© √∫til visitar esses ecos do passado em seu c√≥digo. </p><br><div class="spoiler">  <b class="spoiler_title">Sobre as dificuldades de detec√ß√£o</b> <div class="spoiler_text"><p>  Esse √© um dos meus cheques favoritos, mas √© um dos mais "barulhentos". </p><br><p>  Muitos falsos positivos para pacotes que usam <code>math/big</code> e dentro do compilador.  No primeiro caso, esses s√£o geralmente coment√°rios explicativos sobre as opera√ß√µes executadas e, no segundo, uma descri√ß√£o do c√≥digo que descreve o fragmento AST.  Distinguir esses coment√°rios do c√≥digo "morto" real sem introduzir falsos negativos n√£o √© trivial. </p><br><p>  Isso d√° origem √† id√©ia: e se concordarmos de alguma forma especializar o c√≥digo dentro dos coment√°rios, o que √© explicativo?  Ent√£o a an√°lise est√°tica ser√° simplificada.  Isso pode ser um pouco que facilitar√° a defini√ß√£o de um coment√°rio explicativo ou o c√≥digo Go inv√°lido (por exemplo, se voc√™ adicionar um sinal de cerquilha, <code>#</code> no in√≠cio da linha). </p><br><p>  Outra categoria s√£o coment√°rios com <code>TODO</code> expl√≠citos.  Se o c√≥digo for removido para comentar, mas houver uma descri√ß√£o clara de por que isso √© feito e quando est√° planejado corrigir esse trecho de c√≥digo, √© melhor n√£o dar um aviso.  Isso j√° foi implementado, mas poderia funcionar de maneira mais confi√°vel. </p></div></div><br><h1 id="boolexprsimplify">  boolExprSimplify </h1><br><p>  √Äs vezes as pessoas escrevem c√≥digo estranho.  Talvez me pare√ßa, mas express√µes l√≥gicas ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">booleanas</a> ) √†s vezes parecem especialmente estranhas. </p><br><p>  O Go possui um excelente back-end do montador x86 (aqui uma l√°grima caiu), mas o ARM realmente fez errado: </p><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> !(o1 != <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">break</span></span> }</code> </pre> <br><p>  ‚ÄúSe n√£o o1 n√£o for igual a 0‚Äù ... A dupla nega√ß√£o √© um cl√°ssico.  Se voc√™ gostou, eu convido voc√™ a se familiarizar com o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">CL123377</a> .  L√° voc√™ pode ver a vers√£o corrigida. </p><br><div class="spoiler">  <b class="spoiler_title">Op√ß√£o corrigida (para aqueles que n√£o podem ser atra√≠dos para a revis√£o)</b> <div class="spoiler_text"><pre> <code class="diff hljs"><span class="hljs-deletion"><span class="hljs-deletion">- if !(o1 != 0) { + if o1 == 0 {</span></span></code> </pre> </div></div><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">O boolExprSimplify</a> visa simplifica√ß√µes que aumentam a legibilidade (e o otimizador Go teria de lidar com a quest√£o do desempenho sem ele). </p><br><h1 id="underef">  underef </h1><br><p>  Se voc√™ usar o Go a partir de suas vers√µes anteriores, poder√° se lembrar dos pontos e v√≠rgulas obrigat√≥rios, da falta de desreferencia√ß√£o autom√°tica de ponteiros e de outros recursos que hoje s√£o quase imposs√≠veis de serem vistos no novo c√≥digo. </p><br><p>  No c√≥digo antigo, voc√™ ainda pode ver algo assim: </p><br><pre> <code class="go hljs"><span class="hljs-comment"><span class="hljs-comment">// -    : buf := (*bufp).ptr() // ...     : buf := bufp.ptr()</span></span></code> </pre> <br><p>  V√°rios <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">gatilhos do</a> analisador <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">underef foram</a> corrigidos no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">CL122895</a> . </p><br><h1 id="appendcombine">  appendCombine </h1><br><p>  Voc√™ pode saber que o <code>append</code> pode levar v√°rios argumentos como elementos para adicionar √† fatia de destino.  Em algumas situa√ß√µes, isso pode melhorar um pouco a legibilidade do c√≥digo, mas, o que pode ser mais interessante, tamb√©m pode acelerar o seu programa, j√° que o compilador n√£o suprime as chamadas <code>append</code> compat√≠veis ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">cmd / compile: combine append calls</a> ). </p><br><p>  No Go, a verifica√ß√£o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">appendCombine</a> encontrou a seguinte se√ß√£o: </p><br><pre> <code class="diff hljs"><span class="hljs-deletion"><span class="hljs-deletion">- for i := len(ip) - 1; i &gt;= 0; i-- { - v := ip[i] - buf = append(buf, hexDigit[v&amp;0xF]) - buf = append(buf, '.') - buf = append(buf, hexDigit[v&gt;&gt;4]) - buf = append(buf, '.') - } + for i := len(ip) - 1; i &gt;= 0; i-- { + v := ip[i] + buf = append(buf, hexDigit[v&amp;0xF], + '.', + hexDigit[v&gt;&gt;4], + '.') + }</span></span></code> </pre> <br><pre> <code class="hljs pgsql"><span class="hljs-type"><span class="hljs-type">name</span></span> <span class="hljs-built_in"><span class="hljs-built_in">old</span></span> <span class="hljs-type"><span class="hljs-type">time</span></span>/op <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> <span class="hljs-type"><span class="hljs-type">time</span></span>/op delta ReverseAddress<span class="hljs-number"><span class="hljs-number">-8</span></span> <span class="hljs-number"><span class="hljs-number">4.10</span></span>¬µs ¬± <span class="hljs-number"><span class="hljs-number">3</span></span>% <span class="hljs-number"><span class="hljs-number">3.94</span></span>¬µs ¬± <span class="hljs-number"><span class="hljs-number">1</span></span>% <span class="hljs-number"><span class="hljs-number">-3.81</span></span>% (p=<span class="hljs-number"><span class="hljs-number">0.000</span></span> n=<span class="hljs-number"><span class="hljs-number">10</span></span>+<span class="hljs-number"><span class="hljs-number">9</span></span>)</code> </pre> <br><p>  Detalhes no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">CL117615</a> . </p><br><h1 id="rangevalcopy">  rangeValCopy </h1><br><p>  N√£o √© segredo que os valores iterados em um loop de <code>range</code> s√£o copiados.  Para objetos pequenos, digamos, com menos de 64 bytes, voc√™ pode nem perceber isso.  No entanto, se esse ciclo estiver em um caminho "quente", ou, sobre o qual voc√™ iterar, contiver um n√∫mero muito grande de elementos, a sobrecarga poder√° ser tang√≠vel. </p><br><p>  O Go possui um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">vinculador</a> bastante lento (cmd / link) e, sem altera√ß√µes significativas em sua arquitetura, n√£o √© poss√≠vel obter um forte ganho de desempenho.  Mas voc√™ pode reduzir um pouco sua inefici√™ncia com a ajuda de microoptimiza√ß√µes.  Cada porcentagem ou duas contagens. </p><br><p>  A verifica√ß√£o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">rangeValCopy</a> encontrou v√°rios ciclos com c√≥pia de dados indesejados de uma s√≥ vez.  Aqui est√£o os mais interessantes deles: </p><br><pre> <code class="diff hljs"><span class="hljs-deletion"><span class="hljs-deletion">- for _, r := range exports.R { - d.mark(r.Sym, nil) - } + for i := range exports.R { + d.mark(exports.R[i].Sym, nil) + }</span></span></code> </pre> <br><p>  Em vez de copiar o pr√≥prio <code>R[i]</code> a cada itera√ß√£o, recorremos apenas ao √∫nico membro de seu interesse, <code>Sym</code> . </p><br><pre> <code class="hljs pgsql"><span class="hljs-type"><span class="hljs-type">name</span></span> <span class="hljs-built_in"><span class="hljs-built_in">old</span></span> <span class="hljs-type"><span class="hljs-type">time</span></span>/op <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> <span class="hljs-type"><span class="hljs-type">time</span></span>/op delta Linker<span class="hljs-number"><span class="hljs-number">-4</span></span> <span class="hljs-number"><span class="hljs-number">530</span></span>ms ¬± <span class="hljs-number"><span class="hljs-number">2</span></span>% <span class="hljs-number"><span class="hljs-number">521</span></span>ms ¬± <span class="hljs-number"><span class="hljs-number">3</span></span>% <span class="hljs-number"><span class="hljs-number">-1.80</span></span>% (p=<span class="hljs-number"><span class="hljs-number">0.000</span></span> n=<span class="hljs-number"><span class="hljs-number">17</span></span>+<span class="hljs-number"><span class="hljs-number">20</span></span>)</code> </pre> <br><p>  A vers√£o completa do patch est√° dispon√≠vel em: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">CL113636</a> . </p><br><h1 id="namedconst">  namedConst </h1><br><p>  No Go, infelizmente, as constantes nomeadas, mesmo montadas em grupos, n√£o s√£o interconectadas e n√£o formam uma enumera√ß√£o ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">proposta: spec: add typed enum support</a> ). </p><br><p>  Um problema √© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">converter constantes sem</a> tipo para o tipo que voc√™ deseja usar como enumera√ß√£o. </p><br><p>  Suponha que voc√™ defina um tipo de <code>Color</code> , que tenha o valor <code>const ColDefault Color = 0</code> . <br>  Qual desses dois trechos de c√≥digo voc√™ gosta mais? </p><br><pre> <code class="go hljs"><span class="hljs-comment"><span class="hljs-comment">// (A) if color == 0 { return colorBlack } // (B) if color == colorDefault { return colorBlack }</span></span></code> </pre> <br><p>  Se <code>(B)</code> parecer mais apropriado, a verifica√ß√£o de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">namedConst</a> ajudar√° a rastrear o uso de valores constantes nomeados, ignorando a pr√≥pria constante nomeada. </p><br><p>  √â assim que o m√©todo <a href=""><code>context.mangle</code></a> do pacote <code>html/template</code> foi transformado: </p><br><pre> <code class="diff hljs"> s := templateName + "$htmltemplate_" + c.state.String() - if c.delim != 0 { + if c.delim != delimNone { s += "_" + c.delim.String() } - if c.urlPart != 0 { + if c.urlPart != urlPartNone { s += "_" + c.urlPart.String() } - if c.jsCtx != 0 { + if c.jsCtx != jsCtxRegexp { s += "_" + c.jsCtx.String() } - if c.attr != 0 { + if c.attr != attrNone { s += "_" + c.attr.String() } - if c.element != 0 { + if c.element != elementNone { s += "_" + c.element.String() } return s</code> </pre> <br><p>  A prop√≥sito, √†s vezes nos links para os patches voc√™ encontra discuss√µes interessantes ... <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">CL123376</a> √© um desses casos. </p><br><h1 id="unslice">  desagrad√°vel </h1><br><p>  Um recurso da <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">express√£o</a> de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">fatia</a> √© que <code>x[:]</code> sempre id√™ntico a <code>x</code> se o tipo <code>x</code> for uma fatia ou sequ√™ncia.  No caso de fatias, isso funciona para qualquer tipo de elemento <code>[]T</code> </p><br><p>  Tudo na lista abaixo √© o mesmo ( <code>x</code> - fatia): </p><br><ul><li> <code>x</code> </li> <li> <code>x[:]</code> </li> <li> <code>x[:][:]</code> </li> <li>  ... </li></ul><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">unslice</a> encontra express√µes de fatia redundantes semelhantes.  Essas express√µes s√£o prejudiciais, em primeiro lugar, com uma carga cognitiva extra.  <code>x[:]</code> possui sem√¢ntica bastante significativa no caso de obter uma fatia da matriz.  Uma fatia com intervalos padr√£o n√£o faz nada, exceto ru√≠dos. </p><br><p>  Pe√ßo um patch no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">CL123375</a> . </p><br><h1 id="switchtrue">  switchTrue </h1><br><p>  No <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">CL123378</a> , " <code>switch true {...}</code> " √© substitu√≠do por " <code>switch {...}</code> ". <br>  Ambas as formas s√£o equivalentes, mas a segunda √© mais idiom√°tica. <br>  Encontrado verificando <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">switchTrue</a> . </p><br><p>  A maioria das verifica√ß√µes estil√≠sticas revela precisamente os casos em que as duas op√ß√µes s√£o aceit√°veis, mas uma delas √© mais comum e familiar para mais programadores do Go.  Pr√≥xima verifica√ß√£o da mesma s√©rie. </p><br><h1 id="typeunparen">  typeUnparen </h1><br><p>  Go, como muitas outras linguagens de programa√ß√£o, adora par√™nteses.  Tanto √© assim que estou pronto para aceitar qualquer n√∫mero deles: </p><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">type</span></span> ( t0 <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> t1 (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>) t2 ((<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)) <span class="hljs-comment"><span class="hljs-comment">// ... ,  . )</span></span></code> </pre> <br><p>  Mas o que acontece se voc√™ executar o <code>gofmt</code> ? </p><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">type</span></span> ( t0 <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> t1 (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>) <span class="hljs-comment"><span class="hljs-comment">// &lt;- !   . t2 (int) // &lt;-    ... )</span></span></code> </pre> <br><p>  √â por isso que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">typeUnparen</a> existe.  Ele encontra no programa todas as express√µes de tipo nas quais voc√™ pode reduzir o n√∫mero de colchetes.  Tentei enviar o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">CL123379</a> , vamos ver como a comunidade o aceitar√°. </p><br><div class="spoiler">  <b class="spoiler_title">Lisp n√£o gosta de aparelho</b> <div class="spoiler_text"><p>  Ao contr√°rio dos idiomas do tipo C, no Lisp n√£o √© t√£o f√°cil inserir colchetes in√∫teis em qualquer lugar.  Portanto, em idiomas cuja sintaxe √© baseada em <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">express√µes S</a> , escrever um programa que n√£o faz nada al√©m de ter um grande n√∫mero de colchetes √© mais dif√≠cil do que em outros idiomas. </p></div></div><br><h1 id="go-critic-na-sluzhbe-go">  cr√≠tico em movimento </h1><br><p> <a href="" title="Clique para ampliar"><img src="https://habrastorage.org/webt/bq/0a/ig/bq0aigrftmrocldewkgzuhiycdo.jpeg"></a> </p><br><p>  Examinamos apenas uma pequena parte das verifica√ß√µes implementadas.  Ao mesmo tempo, sua quantidade e qualidade s√≥ evoluir√£o com o tempo, inclusive gra√ßas √†s pessoas que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">ingressaram no desenvolvimento</a> . </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">O go-critical √©</a> totalmente gratuito para qualquer uso ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">licen√ßa MIT</a> ) e tamb√©m est√° aberto para sua participa√ß√£o no desenvolvimento do projeto.  Envie-nos ideias para verifica√ß√µes, voc√™ pode imediatamente com a implementa√ß√£o, relatar bugs e defici√™ncias encontradas, compartilhar suas impress√µes.  Voc√™ tamb√©m pode propor projetos para auditoria ou relat√≥rio sobre sua revis√£o do c√≥digo Go, essa experi√™ncia √© inestim√°vel para n√≥s. </p><br><h2 id="tema-kontribyutinga-v-go">  Ir contribuindo tema </h2><br><p>  Voc√™ j√° viu o artigo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Ir workshop de contribui√ß√£o na R√∫ssia</a> ?  Esta queda ser√° a segunda rodada.  E desta vez, al√©m de um formato e patrocinadores mais bem-sucedidos, teremos uma arma secreta - um analisador est√°tico maravilhoso.  Haver√° contribui√ß√µes suficientes! </p><br><p>  Mas, na verdade, voc√™ pode come√ßar agora (embora seja melhor - um pouco mais tarde, ap√≥s o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">congelamento do c√≥digo</a> ).  Se voc√™ se sentir confort√°vel antes do pr√≥ximo workshop, ser√° muito legal, porque temos muito pouco mentores na R√∫ssia. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt416903/">https://habr.com/ru/post/pt416903/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt416891/index.html">Nos Estados Unidos, eles ainda podiam distribuir modelos 3D e desenhos digitais para armas de bricolage.</a></li>
<li><a href="../pt416893/index.html">Vaadin Flow - um estranho cervo</a></li>
<li><a href="../pt416897/index.html">Como criar um sistema de pagamento fa√ßa voc√™ mesmo</a></li>
<li><a href="../pt416899/index.html">Dizemos ao prefeito para onde ir (usando o Open Street Map)</a></li>
<li><a href="../pt416901/index.html">Como os profissionais de TI e seguran√ßa se protegem: casos reais com Cisco Connect, BlackHat, RSAC e MWC</a></li>
<li><a href="../pt416905/index.html">Apresenta√ß√£o do Boston Dynamics SpotMini</a></li>
<li><a href="../pt416907/index.html">Teoria da felicidade. A lei da zebra e fila alien√≠gena</a></li>
<li><a href="../pt416909/index.html">Hist√≥rico de sess√µes ativas do PostgreSQL - nova extens√£o pgsentinel</a></li>
<li><a href="../pt416911/index.html">Os chatbots deveriam ser o pr√≥ximo avan√ßo: o que deu errado?</a></li>
<li><a href="../pt416913/index.html">O que o administrador deve esquecer ao mudar para a nuvem - e o que aprender</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>