<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>❕ 🧑🏿‍🤝‍🧑🏼 😔 Lebih banyak statistik situs di repositori kecil Anda 🔊 🗿 💂🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dengan menganalisis statistik situs, kami mendapat gambaran tentang apa yang terjadi dengannya. Kami membandingkan hasilnya dengan pengetahuan lain te...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Lebih banyak statistik situs di repositori kecil Anda</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/463493/"> Dengan menganalisis statistik situs, kami mendapat gambaran tentang apa yang terjadi dengannya.  Kami membandingkan hasilnya dengan pengetahuan lain tentang produk atau layanan dan dengan demikian meningkatkan pengalaman kami. <br><br>  Ketika analisis hasil pertama selesai, informasi telah dipahami dan kesimpulan diambil, tahap selanjutnya dimulai.  Muncul ide: apa yang akan terjadi jika Anda melihat data dari perspektif lain? <br><br>  Pada titik ini, ada keterbatasan pada alat analisis.  Ini adalah salah satu alasan mengapa alat Google Analytics tidak cukup bagi saya, yaitu karena kemampuan terbatas untuk melihat dan memanipulasi data saya. <br><br>  Saya selalu ingin memuat data dasar (data master) dengan cepat, menambahkan level agregasi lain, atau menafsirkan nilai yang ada. <br><br>  Ini mudah dilakukan di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">repositori kecil Anda</a> berdasarkan file access.log dan bahasa SQL sudah cukup untuk ini. <a name="habracut"></a><br><br>  Jadi, pertanyaan apa yang ingin saya temukan jawabannya? <br><br><h4>  Apa dan kapan telah berubah di situs </h4><br>  Sejarah perubahan dalam data yang mendasarinya (data master) selalu menarik. <br><br><img src="https://habrastorage.org/webt/ew/p4/yd/ewp4yd4bsspfxtobssjrfg7tp6g.png" alt="gambar"><br><br><div class="spoiler">  <b class="spoiler_title">Permintaan laporan SQL</b> <div class="spoiler_text"><pre><code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-string"><span class="hljs-string">'SideStackedBar: Content Updates by Months'</span></span>, strftime(<span class="hljs-string"><span class="hljs-string">'%m/%Y'</span></span>, datetime(UPDATE_DT, <span class="hljs-string"><span class="hljs-string">'unixepoch'</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> <span class="hljs-string"><span class="hljs-string">'Day'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">COUNT</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">CASE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> PAGE_TITLE != <span class="hljs-string"><span class="hljs-string">'na'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> DIM_REQUEST_ID <span class="hljs-keyword"><span class="hljs-keyword">END</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> <span class="hljs-string"><span class="hljs-string">'Web page updates'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">COUNT</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">CASE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> PAGE_DESCR = <span class="hljs-string"><span class="hljs-string">'IMAGES'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> DIM_REQUEST_ID <span class="hljs-keyword"><span class="hljs-keyword">END</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> <span class="hljs-string"><span class="hljs-string">'Image uploads'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">COUNT</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">CASE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> PAGE_DESCR = <span class="hljs-string"><span class="hljs-string">'VIDEO'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> DIM_REQUEST_ID <span class="hljs-keyword"><span class="hljs-keyword">END</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> <span class="hljs-string"><span class="hljs-string">'Video uploads'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">COUNT</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">CASE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> PAGE_DESCR = <span class="hljs-string"><span class="hljs-string">'AUDIO'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> DIM_REQUEST_ID <span class="hljs-keyword"><span class="hljs-keyword">END</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> <span class="hljs-string"><span class="hljs-string">'Audio uploads'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> DIM_REQUEST <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> PAGE_TITLE != <span class="hljs-string"><span class="hljs-string">'na'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OR</span></span> PAGE_DESCR != <span class="hljs-string"><span class="hljs-string">'na'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GROUP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> strftime(<span class="hljs-string"><span class="hljs-string">'%m/%Y'</span></span>, datetime(UPDATE_DT, <span class="hljs-string"><span class="hljs-string">'unixepoch'</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> UPDATE_DT</code> </pre> <br></div></div><br>  Misalnya, pada beberapa titik, optimasi mesin pencari dilakukan atau konten baru ditambahkan ke situs, dalam hal ini, peningkatan lalu lintas diharapkan. <br><br><h4>  Grup pengguna </h4><br>  Contoh paling sederhana dari grup adalah agen pengguna atau nama sistem operasi. <br><br>  Dimensi agen pengguna telah mengumpulkan sekitar seribu catatan, dan saya tertarik untuk melihat dinamika distribusi agen di dalam grup. <br><br><img src="https://habrastorage.org/webt/jf/5t/e8/jf5te8lwo8aig--witfbv71c0jy.png" alt="gambar"><br><br><div class="spoiler">  <b class="spoiler_title">Permintaan laporan SQL</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> <span class="hljs-string"><span class="hljs-string">'SideStackedBar: User Agents'</span></span>, AGENT_OS <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> <span class="hljs-string"><span class="hljs-string">'OS'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">SUM</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">CASE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> AGENT_BOT = <span class="hljs-string"><span class="hljs-string">'na'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ELSE</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">END</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> <span class="hljs-string"><span class="hljs-string">'User Agent of Users'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">SUM</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">CASE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> AGENT_BOT != <span class="hljs-string"><span class="hljs-string">'na'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ELSE</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">END</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> <span class="hljs-string"><span class="hljs-string">'User Agent of Bots'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> DIM_USER_AGENT <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> DIM_USER_AGENT_ID != <span class="hljs-number"><span class="hljs-number">-1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GROUP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> AGENT_OS <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DESC</span></span></code> </pre> <br></div></div><br>  Sebagian besar berbagai kombinasi agen datang ke situs dari dunia Windows.  Di antara yang tidak pasti adalah seperti WhatsApp, PocketImageCache, PlayStation, SmartTV, dll. <br><br><h4>  Aktivitas grup pengguna mingguan </h4><br>  Dengan menggabungkan beberapa kelompok, kita dapat mengamati distribusi kegiatan mereka. <br><br>  Sebagai contoh, pengguna cluster Linux mengkonsumsi lebih banyak lalu lintas di situs daripada orang lain. <br><br><img src="https://habrastorage.org/webt/ei/vq/60/eivq60u6x7mp2plf5xqgrbv5rnq.png" alt="gambar"><br><br><div class="spoiler">  <b class="spoiler_title">Permintaan laporan SQL</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-string"><span class="hljs-string">'StackedBar: Traffic Volume by User OS and by Week'</span></span>, strftime(<span class="hljs-string"><span class="hljs-string">'%W week'</span></span>, datetime(FCT.EVENT_DT, <span class="hljs-string"><span class="hljs-string">'unixepoch'</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> <span class="hljs-string"><span class="hljs-string">'Week'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">SUM</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">CASE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> USG.AGENT_OS <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> (<span class="hljs-string"><span class="hljs-string">'Android'</span></span>, <span class="hljs-string"><span class="hljs-string">'Linux'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> FCT.BYTES <span class="hljs-keyword"><span class="hljs-keyword">ELSE</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">END</span></span>)/<span class="hljs-number"><span class="hljs-number">1000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> <span class="hljs-string"><span class="hljs-string">'Android/Linux Users'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">SUM</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">CASE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> USG.AGENT_OS <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> (<span class="hljs-string"><span class="hljs-string">'Windows'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> FCT.BYTES <span class="hljs-keyword"><span class="hljs-keyword">ELSE</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">END</span></span>)/<span class="hljs-number"><span class="hljs-number">1000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> <span class="hljs-string"><span class="hljs-string">'Windows Users'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">SUM</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">CASE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> USG.AGENT_OS <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> (<span class="hljs-string"><span class="hljs-string">'Macintosh'</span></span>, <span class="hljs-string"><span class="hljs-string">'iOS'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> FCT.BYTES <span class="hljs-keyword"><span class="hljs-keyword">ELSE</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">END</span></span>)/<span class="hljs-number"><span class="hljs-number">1000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> <span class="hljs-string"><span class="hljs-string">'Mac/iOS Users'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">SUM</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">CASE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> USG.AGENT_OS <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> (<span class="hljs-string"><span class="hljs-string">'na'</span></span>, <span class="hljs-string"><span class="hljs-string">'BlackBerry'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> FCT.BYTES <span class="hljs-keyword"><span class="hljs-keyword">ELSE</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">END</span></span>)/<span class="hljs-number"><span class="hljs-number">1000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> <span class="hljs-string"><span class="hljs-string">'Other'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> FCT_ACCESS_USER_AGENT_DD FCT, DIM_USER_AGENT USG, DIM_HTTP_STATUS HST <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> FCT.DIM_USER_AGENT_ID=USG.DIM_USER_AGENT_ID <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> FCT.DIM_HTTP_STATUS_ID = HST.DIM_HTTP_STATUS_ID <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> USG.AGENT_BOT = <span class="hljs-string"><span class="hljs-string">'na'</span></span> <span class="hljs-comment"><span class="hljs-comment">/* users only */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> HST.STATUS_GROUP <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> (<span class="hljs-string"><span class="hljs-string">'Successful'</span></span>) <span class="hljs-comment"><span class="hljs-comment">/* good pages */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> datetime(FCT.EVENT_DT, <span class="hljs-string"><span class="hljs-string">'unixepoch'</span></span>) &gt; <span class="hljs-built_in"><span class="hljs-built_in">date</span></span>(<span class="hljs-string"><span class="hljs-string">'now'</span></span>, <span class="hljs-string"><span class="hljs-string">'-3 month'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">GROUP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> strftime(<span class="hljs-string"><span class="hljs-string">'%W week'</span></span>, datetime(FCT.EVENT_DT, <span class="hljs-string"><span class="hljs-string">'unixepoch'</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> FCT.EVENT_DT</code> </pre> <br></div></div><br><h4>  Konsumsi lalu lintas yang padat </h4><br>  Tabel menunjukkan grup pengguna paling aktif dan hari aktivitas mereka. <br>  Yang paling aktif adalah milik cluster Linux. <br><br><img src="https://habrastorage.org/webt/np/tx/3f/nptx3flvgdvq2rooddxfxjg6xx4.png" alt="gambar"><br><br><div class="spoiler">  <b class="spoiler_title">Permintaan laporan SQL</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> <span class="hljs-string"><span class="hljs-string">'Table: User Agent with Havy Usage'</span></span>, strftime(<span class="hljs-string"><span class="hljs-string">'%d.%m.%Y'</span></span>, datetime(FCT.EVENT_DT, <span class="hljs-string"><span class="hljs-string">'unixepoch'</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> <span class="hljs-string"><span class="hljs-string">'Day'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span>(<span class="hljs-number"><span class="hljs-number">1.0</span></span>*<span class="hljs-keyword"><span class="hljs-keyword">SUM</span></span>(FCT.BYTES)/<span class="hljs-number"><span class="hljs-number">1000000</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> <span class="hljs-string"><span class="hljs-string">'Traffic MB'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span>(<span class="hljs-number"><span class="hljs-number">1.0</span></span>*<span class="hljs-keyword"><span class="hljs-keyword">SUM</span></span>(FCT.IP_CNT)/<span class="hljs-keyword"><span class="hljs-keyword">SUM</span></span>(<span class="hljs-number"><span class="hljs-number">1</span></span>), <span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> <span class="hljs-string"><span class="hljs-string">'IPs'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span>(<span class="hljs-number"><span class="hljs-number">1.0</span></span>*<span class="hljs-keyword"><span class="hljs-keyword">SUM</span></span>(FCT.REQUEST_CNT)/<span class="hljs-keyword"><span class="hljs-keyword">SUM</span></span>(<span class="hljs-number"><span class="hljs-number">1</span></span>), <span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> <span class="hljs-string"><span class="hljs-string">'Requests'</span></span>, USA.DIM_USER_AGENT_ID <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> <span class="hljs-string"><span class="hljs-string">'ID'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">MAX</span></span>(USA.USER_AGENT_NK) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> <span class="hljs-string"><span class="hljs-string">'User Agent'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">MAX</span></span>(USA.AGENT_BOT) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> <span class="hljs-string"><span class="hljs-string">'Bot'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> FCT_ACCESS_USER_AGENT_DD FCT, DIM_USER_AGENT USA <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> FCT.DIM_USER_AGENT_ID = USA.DIM_USER_AGENT_ID <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> datetime(FCT.EVENT_DT, <span class="hljs-string"><span class="hljs-string">'unixepoch'</span></span>) &gt;= <span class="hljs-built_in"><span class="hljs-built_in">date</span></span>(<span class="hljs-string"><span class="hljs-string">'now'</span></span>, <span class="hljs-string"><span class="hljs-string">'-30 day'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">GROUP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> USA.DIM_USER_AGENT_ID, strftime(<span class="hljs-string"><span class="hljs-string">'%d.%m.%Y'</span></span>, datetime(FCT.EVENT_DT, <span class="hljs-string"><span class="hljs-string">'unixepoch'</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SUM</span></span>(FCT.BYTES) <span class="hljs-keyword"><span class="hljs-keyword">DESC</span></span>, FCT.EVENT_DT <span class="hljs-keyword"><span class="hljs-keyword">LIMIT</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span></code> </pre> <br></div></div><br>  Menggunakan hari atribut dan ID agen, Anda dapat dengan cepat menemukan dan melacak statistik pada hari masing-masing grup pengguna.  Jika perlu, Anda dapat dengan cepat menemukan informasi terperinci di tabel panggung. <br><br><h4>  Bagaimana cara mendapatkan informasi? </h4><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Informasi dari file access.log</a> dapat dibuat lebih efektif dengan mengintegrasikan sumber data tambahan dan memperkenalkan tingkat agregasi dan pengelompokan baru. <br><br><h4>  Data dan entitas dasar </h4><br>  Data dasar mencakup informasi tentang entitas: halaman web, gambar, konten video dan audio, dalam hal toko, produk. <br><br>  Entitas sendiri memainkan peran dimensi, dan proses menyimpan perubahan atribut disebut historisisasi.  Dalam database, proses ini sering diimplementasikan dalam bentuk dimensi yang berubah perlahan (SCD). <br><br>  Berbagai sistem dapat menjadi sumber data dasar, sehingga hampir selalu perlu diintegrasikan. <br><br><h4>  Dimensi berubah perlahan </h4><br>  Dimensi DIM_REQUEST akan berisi informasi tentang kueri di situs dalam bentuk historis. <br><br><div class="spoiler">  <b class="spoiler_title">Tabel SCD2</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> DIM_REQUEST ( <span class="hljs-comment"><span class="hljs-comment">/* scd table for user requests */</span></span> DIM_REQUEST_ID <span class="hljs-built_in"><span class="hljs-built_in">INTEGER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> PRIMARY <span class="hljs-keyword"><span class="hljs-keyword">KEY</span></span> AUTOINCREMENT, DIM_REQUEST_ID_HIST <span class="hljs-built_in"><span class="hljs-built_in">INTEGER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-number"><span class="hljs-number">-1</span></span>, REQUEST_NK <span class="hljs-built_in"><span class="hljs-built_in">TEXT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-string"><span class="hljs-string">'na'</span></span>, <span class="hljs-comment"><span class="hljs-comment">/* request without ?parameters */</span></span> PAGE_TITLE <span class="hljs-built_in"><span class="hljs-built_in">TEXT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-string"><span class="hljs-string">'na'</span></span>, PAGE_DESCR <span class="hljs-built_in"><span class="hljs-built_in">TEXT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-string"><span class="hljs-string">'na'</span></span>, PAGE_KEYWORDS <span class="hljs-built_in"><span class="hljs-built_in">TEXT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-string"><span class="hljs-string">'na'</span></span>, DELETE_FLAG <span class="hljs-built_in"><span class="hljs-built_in">INTEGER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>, UPDATE_DT <span class="hljs-built_in"><span class="hljs-built_in">INTEGER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">UNIQUE</span></span> (REQUEST_NK, DIM_REQUEST_ID_HIST) ); <span class="hljs-keyword"><span class="hljs-keyword">INSERT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INTO</span></span> DIM_REQUEST (DIM_REQUEST_ID) <span class="hljs-keyword"><span class="hljs-keyword">VALUES</span></span> (<span class="hljs-number"><span class="hljs-number">-1</span></span>);</code> </pre> <br></div></div><br>  Selain itu, buat satu tampilan yang selalu menampilkan semua catatan di status terakhir.  Perlu memuat pengukuran itu sendiri. <br><br><img src="https://habrastorage.org/webt/l_/mx/f7/l_mxf7tivchzxir_wwhxd_smeq8.png" alt="gambar"><br><br><div class="spoiler">  <b class="spoiler_title">Tampilan SCD2 saat ini</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-comment"><span class="hljs-comment">/* Content: actual view on scd table */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> HI.DIM_REQUEST_ID, HI.DIM_REQUEST_ID_HIST, HI.REQUEST_NK, HI.PAGE_TITLE, HI.PAGE_DESCR, HI.PAGE_KEYWORDS, NK.CNT <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> HIST_CNT, HI.DELETE_FLAG, strftime(<span class="hljs-string"><span class="hljs-string">'%d.%m.%Y %H:%M'</span></span>, datetime(HI.UPDATE_DT, <span class="hljs-string"><span class="hljs-string">'unixepoch'</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> UPDATE_DT <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> ( <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> REQUEST_NK, <span class="hljs-keyword"><span class="hljs-keyword">MAX</span></span>(DIM_REQUEST_ID) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> DIM_REQUEST_ID, <span class="hljs-keyword"><span class="hljs-keyword">SUM</span></span>(<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> CNT <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> DIM_REQUEST <span class="hljs-keyword"><span class="hljs-keyword">GROUP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> REQUEST_NK ) NK, DIM_REQUEST HI <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> = <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> NK.REQUEST_NK = HI.REQUEST_NK <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> NK.DIM_REQUEST_ID = HI.DIM_REQUEST_ID;</code> </pre> <br></div></div><br>  Dan pandangan di mana informasi historis dikumpulkan untuk setiap catatan.  Penting untuk membangun koneksi historis yang benar dengan fakta. <br><br><img src="https://habrastorage.org/webt/pm/12/d1/pm12d1iahjmnaq8yebudgzv7ayi.png" alt="gambar"><br><br><div class="spoiler">  <b class="spoiler_title">Pandangan historis tentang SCD2</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-comment"><span class="hljs-comment">/* Content: actual view on scd table */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> SCD.DIM_REQUEST_ID, SCD.DIM_REQUEST_ID_HIST, SCD.REQUEST_NK, SCD.PAGE_TITLE, SCD.PAGE_DESCR, SCD.PAGE_KEYWORDS, SCD.DELETE_FLAG, <span class="hljs-keyword"><span class="hljs-keyword">CASE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> HIS.UPDATE_DT <span class="hljs-keyword"><span class="hljs-keyword">IS</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ELSE</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">END</span></span> ACTIVE_FLAG, SCD.DIM_REQUEST_ID_HIST <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> ID_FROM, SCD.DIM_REQUEST_ID <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> ID_TO, <span class="hljs-keyword"><span class="hljs-keyword">CASE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> SCD.DIM_REQUEST_ID_HIST=<span class="hljs-number"><span class="hljs-number">-1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> <span class="hljs-number"><span class="hljs-number">3600</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ELSE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IFNULL</span></span>(SCD.UPDATE_DT,<span class="hljs-number"><span class="hljs-number">3600</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">END</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> TIME_FROM, <span class="hljs-keyword"><span class="hljs-keyword">CASE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> HIS.UPDATE_DT <span class="hljs-keyword"><span class="hljs-keyword">IS</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> <span class="hljs-number"><span class="hljs-number">253370764800</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ELSE</span></span> HIS.UPDATE_DT <span class="hljs-keyword"><span class="hljs-keyword">END</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> TIME_TO, <span class="hljs-keyword"><span class="hljs-keyword">CASE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> SCD.DIM_REQUEST_ID_HIST=<span class="hljs-number"><span class="hljs-number">-1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> STRFTIME(<span class="hljs-string"><span class="hljs-string">'%d.%m.%Y %H:%M'</span></span>, DATETIME(<span class="hljs-number"><span class="hljs-number">3600</span></span>, <span class="hljs-string"><span class="hljs-string">'unixepoch'</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">ELSE</span></span> STRFTIME(<span class="hljs-string"><span class="hljs-string">'%d.%m.%Y %H:%M'</span></span>, DATETIME(<span class="hljs-keyword"><span class="hljs-keyword">IFNULL</span></span>(SCD.UPDATE_DT,<span class="hljs-number"><span class="hljs-number">3600</span></span>), <span class="hljs-string"><span class="hljs-string">'unixepoch'</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">END</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> ACTIVE_FROM, <span class="hljs-keyword"><span class="hljs-keyword">CASE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> HIS.UPDATE_DT <span class="hljs-keyword"><span class="hljs-keyword">IS</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> STRFTIME(<span class="hljs-string"><span class="hljs-string">'%d.%m.%Y %H:%M'</span></span>, DATETIME(<span class="hljs-number"><span class="hljs-number">253370764800</span></span>, <span class="hljs-string"><span class="hljs-string">'unixepoch'</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">ELSE</span></span> STRFTIME(<span class="hljs-string"><span class="hljs-string">'%d.%m.%Y %H:%M'</span></span>, DATETIME(HIS.UPDATE_DT, <span class="hljs-string"><span class="hljs-string">'unixepoch'</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">END</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> ACTIVE_TO <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> DIM_REQUEST SCD <span class="hljs-keyword"><span class="hljs-keyword">LEFT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OUTER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> DIM_REQUEST HIS <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> SCD.REQUEST_NK = HIS.REQUEST_NK <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> SCD.DIM_REQUEST_ID = HIS.DIM_REQUEST_ID_HIST;</code> </pre> <br></div></div><br><h4>  Agregasi data </h4><br>  Kompresi (agregasi) memungkinkan Anda untuk mengevaluasi data di tingkat yang lebih tinggi dan mendeteksi anomali dan tren yang tidak terlihat dalam laporan terperinci. <br><br>  Misalnya, dalam dimensi dengan kode status permintaan DIM_HTTP_STATUS, tambahkan grup: <br><blockquote>  STATUS / KELOMPOK <br>  0xx / na <br>  1xx / Informasi <br>  2xx / Berhasil <br>  3xx / pengalihan <br>  4xx / Kesalahan Klien <br>  5xx / Kesalahan Server </blockquote>  Dimensi agen pengguna DIM_USER_AGENT akan berisi atribut AGENT_OS dan AGENT_BOT untuk grup.  Mereka dapat diisi selama proses ETL: <br><br><div class="spoiler">  <b class="spoiler_title">Unduh DIM_USER_AGENT</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-comment"><span class="hljs-comment">/* Propagate the user agent from access log */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INSERT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INTO</span></span> DIM_USER_AGENT (USER_AGENT_NK, AGENT_OS, AGENT_ENGINE, AGENT_DEVICE, AGENT_BOT, UPDATE_DT) <span class="hljs-keyword"><span class="hljs-keyword">WITH</span></span> CLS <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> ( <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> BROWSER <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> STG_ACCESS_LOG <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">LENGTH</span></span>(BROWSER)&gt;<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GROUP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> BROWSER ) <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> CLS.BROWSER <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> USER_AGENT_NK, <span class="hljs-keyword"><span class="hljs-keyword">CASE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INSTR</span></span>(CLS.BROWSER,<span class="hljs-string"><span class="hljs-string">'Macintosh'</span></span>)&gt;<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> <span class="hljs-string"><span class="hljs-string">'Macintosh'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INSTR</span></span>(CLS.BROWSER,<span class="hljs-string"><span class="hljs-string">'iPhone'</span></span>)&gt;<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INSTR</span></span>(CLS.BROWSER,<span class="hljs-string"><span class="hljs-string">'iPad'</span></span>)&gt;<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INSTR</span></span>(CLS.BROWSER,<span class="hljs-string"><span class="hljs-string">'iPod'</span></span>)&gt;<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INSTR</span></span>(CLS.BROWSER,<span class="hljs-string"><span class="hljs-string">'Apple TV'</span></span>)&gt;<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INSTR</span></span>(CLS.BROWSER,<span class="hljs-string"><span class="hljs-string">'Darwin'</span></span>)&gt;<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> <span class="hljs-string"><span class="hljs-string">'iOS'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INSTR</span></span>(CLS.BROWSER,<span class="hljs-string"><span class="hljs-string">'Android'</span></span>)&gt;<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> <span class="hljs-string"><span class="hljs-string">'Android'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INSTR</span></span>(CLS.BROWSER,<span class="hljs-string"><span class="hljs-string">'X11;'</span></span>)&gt;<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INSTR</span></span>(CLS.BROWSER,<span class="hljs-string"><span class="hljs-string">'Wayland;'</span></span>)&gt;<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INSTR</span></span>(CLS.BROWSER,<span class="hljs-string"><span class="hljs-string">'linux-gnu'</span></span>)&gt;<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> <span class="hljs-string"><span class="hljs-string">'Linux'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INSTR</span></span>(CLS.BROWSER,<span class="hljs-string"><span class="hljs-string">'BB10;'</span></span>)&gt;<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INSTR</span></span>(CLS.BROWSER,<span class="hljs-string"><span class="hljs-string">'BlackBerry'</span></span>)&gt;<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> <span class="hljs-string"><span class="hljs-string">'BlackBerry'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INSTR</span></span>(CLS.BROWSER,<span class="hljs-string"><span class="hljs-string">'Windows'</span></span>)&gt;<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> <span class="hljs-string"><span class="hljs-string">'Windows'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ELSE</span></span> <span class="hljs-string"><span class="hljs-string">'na'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">END</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> AGENT_OS, <span class="hljs-comment"><span class="hljs-comment">-- OS CASE WHEN INSTR(CLS.BROWSER,'AppleCoreMedia')&gt;0 THEN 'AppleWebKit' WHEN INSTR(CLS.BROWSER,') ')&gt;1 AND LENGTH(CLS.BROWSER)&gt;INSTR(CLS.BROWSER,') ') THEN COALESCE(SUBSTR(CLS.BROWSER, INSTR(CLS.BROWSER,') ')+2, LENGTH(CLS.BROWSER) - INSTR(CLS.BROWSER,') ')-1), 'N/A') ELSE 'na' END AS AGENT_ENGINE, -- Engine CASE WHEN INSTR(CLS.BROWSER,'iPhone')&gt;0 THEN 'iPhone' WHEN INSTR(CLS.BROWSER,'iPad')&gt;0 THEN 'iPad' WHEN INSTR(CLS.BROWSER,'iPod')&gt;0 THEN 'iPod' WHEN INSTR(CLS.BROWSER,'Apple TV')&gt;0 THEN 'Apple TV' WHEN INSTR(CLS.BROWSER,'Android ')&gt;0 AND INSTR(CLS.BROWSER,'Build')&gt;0 THEN COALESCE(SUBSTR(CLS.BROWSER, INSTR(CLS.BROWSER,'Android '), INSTR(CLS.BROWSER,'Build')-INSTR(CLS.BROWSER,'Android ')), 'na') WHEN INSTR(CLS.BROWSER,'Android ')&gt;0 AND INSTR(CLS.BROWSER,'MIUI')&gt;0 THEN COALESCE(SUBSTR(CLS.BROWSER, INSTR(CLS.BROWSER,'Android '), INSTR(CLS.BROWSER,'MIUI')-INSTR(CLS.BROWSER,'Android ')), 'na') ELSE 'na' END AS AGENT_DEVICE, -- Device CASE WHEN INSTR(LOWER(CLS.BROWSER),'yandex.com')&gt;0 THEN 'yandex' WHEN INSTR(LOWER(CLS.BROWSER),'googlebot')&gt;0 THEN 'google' WHEN INSTR(LOWER(CLS.BROWSER),'bingbot')&gt;0 THEN 'microsoft' WHEN INSTR(LOWER(CLS.BROWSER),'ahrefsbot')&gt;0 THEN 'ahrefs' WHEN INSTR(LOWER(CLS.BROWSER),'jobboersebot')&gt;0 OR INSTR(LOWER(CLS.BROWSER),'jobkicks')&gt;0 THEN 'job.de' WHEN INSTR(LOWER(CLS.BROWSER),'mail.ru')&gt;0 THEN 'mail.ru' WHEN INSTR(LOWER(CLS.BROWSER),'baiduspider')&gt;0 THEN 'baidu' WHEN INSTR(LOWER(CLS.BROWSER),'mj12bot')&gt;0 THEN 'majestic-12' WHEN INSTR(LOWER(CLS.BROWSER),'duckduckgo')&gt;0 THEN 'duckduckgo' WHEN INSTR(LOWER(CLS.BROWSER),'bytespider')&gt;0 THEN 'bytespider' WHEN INSTR(LOWER(CLS.BROWSER),'360spider')&gt;0 THEN 'so.360.cn' WHEN INSTR(LOWER(CLS.BROWSER),'compatible')&gt;0 OR INSTR(LOWER(CLS.BROWSER),'http')&gt;0 OR INSTR(LOWER(CLS.BROWSER),'libwww')&gt;0 OR INSTR(LOWER(CLS.BROWSER),'spider')&gt;0 OR INSTR(LOWER(CLS.BROWSER),'java')&gt;0 OR INSTR(LOWER(CLS.BROWSER),'python')&gt;0 OR INSTR(LOWER(CLS.BROWSER),'robot')&gt;0 OR INSTR(LOWER(CLS.BROWSER),'curl')&gt;0 OR INSTR(LOWER(CLS.BROWSER),'wget')&gt;0 THEN 'other' ELSE 'na' END AS AGENT_BOT, -- Bot STRFTIME('%s','now') AS UPDATE_DT FROM CLS LEFT OUTER JOIN DIM_USER_AGENT TRG ON CLS.BROWSER = TRG.USER_AGENT_NK WHERE TRG.DIM_USER_AGENT_ID IS NULL</span></span></code> </pre> <br></div></div><br><h4>  Integrasi data </h4><br>  Ini mencakup pengaturan transfer data dari sistem operasi ke sistem pelaporan.  Untuk melakukan ini, buat tabel panggung dengan struktur yang mirip dengan sumbernya. <br><br>  Informasi tentang halaman web sampai ke tahap dari cadangan CMS dalam bentuk permintaan memasukkan. <br><br>  Memuat tabel DIM_REQUEST historis dengan data dasar membutuhkan tiga langkah: memuat kunci dan atribut baru, memperbarui yang sudah ada dan memperbaiki catatan yang dihapus. <br><br><div class="spoiler">  <b class="spoiler_title">Unduh entri SCD2 baru</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-comment"><span class="hljs-comment">/* Load request table SCD from master data */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INSERT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INTO</span></span> DIM_REQUEST (DIM_REQUEST_ID_HIST, REQUEST_NK, PAGE_TITLE, PAGE_DESCR, PAGE_KEYWORDS, DELETE_FLAG, UPDATE_DT) <span class="hljs-keyword"><span class="hljs-keyword">WITH</span></span> CLS <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> ( <span class="hljs-comment"><span class="hljs-comment">-- prepare keys SELECT '/' || NAME AS REQUEST_NK, TITLE AS PAGE_TITLE, CASE WHEN DESCRIPTION = '' OR DESCRIPTION IS NULL THEN 'na' ELSE DESCRIPTION END AS PAGE_DESCR, CASE WHEN KEYWORDS = '' OR KEYWORDS IS NULL THEN 'na' ELSE KEYWORDS END AS PAGE_KEYWORDS FROM STG_CMS_MENU WHERE CONTENT_TYPE != 'folder' -- only web pages AND PAGE_TITLE != 'na' -- master data which make sense ) /* new records from stage: CLS */ SELECT -1 AS DIM_REQUEST_ID_HIST, CLS.REQUEST_NK, CLS.PAGE_TITLE, CLS.PAGE_DESCR, CLS.PAGE_KEYWORDS, 0 AS DELETE_FLAG, STRFTIME('%s','now') AS UPDATE_DT FROM CLS LEFT OUTER JOIN ( SELECT DIM_REQUEST_ID, REQUEST_NK, PAGE_TITLE, PAGE_DESCR, PAGE_KEYWORDS FROM DIM_REQUEST_V_ACT ) TRG ON CLS.REQUEST_NK = TRG.REQUEST_NK WHERE TRG.REQUEST_NK IS NULL -- no such record in data mart</span></span></code> </pre> <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Perbarui Atribut SCD2</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-comment"><span class="hljs-comment">/* Load request table SCD from master data */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INSERT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INTO</span></span> DIM_REQUEST (DIM_REQUEST_ID_HIST, REQUEST_NK, PAGE_TITLE, PAGE_DESCR, PAGE_KEYWORDS, DELETE_FLAG, UPDATE_DT) <span class="hljs-keyword"><span class="hljs-keyword">WITH</span></span> CLS <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> ( <span class="hljs-comment"><span class="hljs-comment">-- prepare keys SELECT '/' || NAME AS REQUEST_NK, TITLE AS PAGE_TITLE, CASE WHEN DESCRIPTION = '' OR DESCRIPTION IS NULL THEN 'na' ELSE DESCRIPTION END AS PAGE_DESCR, CASE WHEN KEYWORDS = '' OR KEYWORDS IS NULL THEN 'na' ELSE KEYWORDS END AS PAGE_KEYWORDS FROM STG_CMS_MENU WHERE CONTENT_TYPE != 'folder' -- only web pages AND PAGE_TITLE != 'na' -- master data which make sense ) /* updated records from stage: CLS and build reference to history: HIST */ SELECT HIST.DIM_REQUEST_ID AS DIM_REQUEST_ID_HIST, HIST.REQUEST_NK, CLS.PAGE_TITLE, CLS.PAGE_DESCR, CLS.PAGE_KEYWORDS, 0 AS DELETE_FLAG, STRFTIME('%s','now') AS UPDATE_DT FROM CLS, DIM_REQUEST_V_ACT TRG, DIM_REQUEST HIST WHERE CLS.REQUEST_NK = TRG.REQUEST_NK AND TRG.DIM_REQUEST_ID = HIST.DIM_REQUEST_ID AND ( CLS.PAGE_TITLE != HIST.PAGE_TITLE /* changes only */ OR CLS.PAGE_DESCR != HIST.PAGE_DESCR OR CLS.PAGE_KEYWORDS != HIST.PAGE_KEYWORDS )</span></span></code> </pre> <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Entri SCD2 yang dihapus</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-comment"><span class="hljs-comment">/* Load request table SCD from master data */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INSERT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INTO</span></span> DIM_REQUEST (DIM_REQUEST_ID_HIST, REQUEST_NK, PAGE_TITLE, PAGE_DESCR, PAGE_KEYWORDS, DELETE_FLAG, UPDATE_DT) <span class="hljs-keyword"><span class="hljs-keyword">WITH</span></span> CLS <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> ( <span class="hljs-comment"><span class="hljs-comment">-- prepare keys SELECT '/' || NAME AS REQUEST_NK, TITLE AS PAGE_TITLE FROM STG_CMS_MENU WHERE CONTENT_TYPE != 'folder' -- only web pages AND PAGE_TITLE != 'na' -- master data which make sense ) /* deleted records in data mart: TRG */ SELECT TRG.DIM_REQUEST_ID AS DIM_REQUEST_ID_HIST, TRG.REQUEST_NK, TRG.PAGE_TITLE, TRG.PAGE_DESCR, TRG.PAGE_KEYWORDS, 1 AS DELETE_FLAG, STRFTIME('%s','now') AS UPDATE_DT FROM ( SELECT DIM_REQUEST_ID, REQUEST_NK, PAGE_TITLE, PAGE_DESCR, PAGE_KEYWORDS FROM DIM_REQUEST_V_ACT WHERE PAGE_TITLE != 'na' -- track master data only AND DELETE_FLAG = 0 -- not already deleted ) TRG LEFT OUTER JOIN CLS ON TRG.REQUEST_NK = CLS.REQUEST_NK WHERE CLS.REQUEST_NK IS NULL -- no such record in stage</span></span></code> </pre> <br></div></div><br>  Setiap sumber data harus disertai dengan deskripsi formal, misalnya, dalam file readme.txt: <br><blockquote>  Penerima secara formal / teknis: nama, alamat email <br>  Penyedia Data Secara Resmi / Teknis: Nama, Email <br>  Sumber data: jalur file, nama layanan <br>  Informasi Akses Data: Pengguna dan Kata Sandi </blockquote><br>  Skema perpindahan data akan membantu dalam proses pemeliharaan dan pembaruan, misalnya, dalam bentuk teks: <br><blockquote>  Memindahkan file.  Sumber: ftp.domain.net: /logs/access.log Target: /var/www/access.log <br>  Membaca di panggung.  Target: STG_ACCESS_LOG <br>  Pengunduhan dan transformasi.  Target: FCT_ACCESS_REQUEST_REF_HH <br>  Pengunduhan dan transformasi.  Target: FCT_ACCESS_USER_AGENT_DD <br>  Laporkan.  Target: /var/www/report.html </blockquote><h4>  Kesimpulan </h4><br>  Dengan demikian, artikel tersebut menjelaskan mekanisme seperti integrasi data dasar dan pengenalan tingkat agregasi baru.  Mereka diperlukan saat membangun gudang data untuk mendapatkan pengetahuan tambahan dan meningkatkan kualitas informasi. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id463493/">https://habr.com/ru/post/id463493/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id463477/index.html">Damai dan tenang: penyumbat telinga dBud dengan dua tingkat pengurangan kebisingan</a></li>
<li><a href="../id463481/index.html">Matematika diskrit untuk WMS: algoritma untuk mengompresi barang dalam sel (bagian 1)</a></li>
<li><a href="../id463483/index.html">Kolaborasi dokumen, obrolan perusahaan yang diperbarui dan aplikasi seluler: Apa yang Baru di Zextras Suite 3.0</a></li>
<li><a href="../id463489/index.html">Heavy metal berbohong: pada kenyataannya, musik berat memiliki efek positif pada kesehatan para penggemarnya</a></li>
<li><a href="../id463491/index.html">Kisah terjemahan bahasa Inggris yang aneh dari Metal Gear Solid</a></li>
<li><a href="../id463495/index.html">Cache Laravel: dasar-dasar ditambah kiat & trik</a></li>
<li><a href="../id463497/index.html">Kalkulator Efisiensi Saham dan 5 Alasan Mengapa Sesuatu Menjadi Salah</a></li>
<li><a href="../id463499/index.html">Kantor yang nyaman - membantu bekerja atau mengganggu dan mengalihkan perhatian? Sidenis, Alternativa Games, dan FunBox akan menjawab</a></li>
<li><a href="../id463503/index.html">Mengapa pengembangan web modern begitu rumit? Bagian 1</a></li>
<li><a href="../id463505/index.html">Mengapa administrator sistem harus menjadi insinyur DevOps</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>