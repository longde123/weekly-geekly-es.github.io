<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ฆ ๐ท๏ธ ๐๏ธ ุงูุชุนูู ุงูุขูู: ุชููุน ุฃุณุนุงุฑ ุงูุฃุณูู ูู ุณูู ุงูุฃุณูู โ ๐ง ๐ฑ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ูุงูุช ุงููุชุฑุฌูุฉ ุจููููุง ูุงุจูุฑููุง ุฎุตูุตูุง ูู Netologia ุจุชุนุฏูู ููุงู ุจููู ูููุฏุณ ุฌุงูุนุฉ ูุงูุจุฑูุฏุฌ ููููู ุจุงูุงููุงุจุงู ุญูู ููููุฉ ุฅูุดุงุก ูููุฐุฌ ุจุงุณุชุฎุฏุงู ุงูุดุจูุงุช ุงูุนุตุจู...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ุงูุชุนูู ุงูุขูู: ุชููุน ุฃุณุนุงุฑ ุงูุฃุณูู ูู ุณูู ุงูุฃุณูู</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/netologyru/blog/428227/" style=";text-align:right;direction:rtl">  <i>ูุงูุช ุงููุชุฑุฌูุฉ ุจููููุง ูุงุจูุฑููุง ุฎุตูุตูุง ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Netologia ุจุชุนุฏูู</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุงู</a> ุจููู ูููุฏุณ ุฌุงูุนุฉ ูุงูุจุฑูุฏุฌ ููููู ุจุงูุงููุงุจุงู ุญูู ููููุฉ ุฅูุดุงุก ูููุฐุฌ ุจุงุณุชุฎุฏุงู ุงูุดุจูุงุช ุงูุนุตุจูุฉ ุงูุชู ูููููุง ุงูุชูุจุค ุจุฃุณุนุงุฑ ุงูุฃุณูู ูู ุงูุจูุฑุตุฉ.</i> <br><br>  ุฃุตุจุญ ุงูุชุนูู ุงูุขูู ูุงูุชุนููู ุงูุนููู ุงุณุชุฑุงุชูุฌูุฉ ุฌุฏูุฏุฉ ูุนุงูุฉ ุชุณุชุฎุฏููุง ุงูุนุฏูุฏ ูู ุตูุงุฏูู ุงูุงุณุชุซูุงุฑ ูุฒูุงุฏุฉ ุงูุฏุฎู.  ูู ุงูููุงูุฉ ุ ุณุฃุดุฑุญ ููู ุชุณุงุนุฏ ุงูุดุจูุงุช ุงูุนุตุจูุฉ ูู ุงูุชูุจุค ุจุงููุถุน ูู ุณูู ุงูุฃุณูู - ุนูู ุณุจูู ุงููุซุงู ุ ุณุนุฑ ุงูุฃุณูู (ุฃู ุงููุคุดุฑ).  ูุณุชูุฏ ุงููุต ุฅูู ูุดุฑูุนู ุงูููุชูุจ ุจูุบุฉ Python.  ูููู ุงูุนุซูุฑ ุนูู ุงูููุฏ ุงููุงูู ูุฏููู ุงูุจุฑูุงูุฌ ุนูู GitHub.  ุงูุฑุฃ ููุงูุงุช ุฃุฎุฑู ุฐุงุช ุตูุฉ ุนูู ูุฏููุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Medium</a> . <br><a name="habracut"></a><br><h2 style=";text-align:right;direction:rtl">  ุงูุดุจูุงุช ุงูุนุตุจูุฉ ูู ุงูุงูุชุตุงุฏ </h2><br>  ุงูุชุบููุฑุงุช ูู ูุฌุงู ุงูุชูููู ููุณุช ุฎุทูุฉ ุ ูุฃุญูุงููุง ูุฏ ูุจุฏู ุฃู ุฃุณุนุงุฑ ุงูุฃุณูู ุชุชุดูู ุจุดูู ุนุดูุงุฆู ุชูุงููุง.  ุชุนุชุจุฑ ุทุฑู ุงูุณูุงุณู ุงูุฒูููุฉ ุงูุชูููุฏูุฉ ุ ูุซู ููุงุฐุฌ ARIMA ู GARCH ุ ูุนุงูุฉ ุนูุฏูุง ุชููู ุงูุณูุณูุฉ ุซุงุจุชุฉ - ููุง ุชุชุบูุฑ ุฎุตุงุฆุตูุง ุงูุฃุณุงุณูุฉ ุจูุฑูุฑ ุงูููุช.  ููุชุทูุจ ูุฐุง ุฃู ุชููู ุงูุณูุณูุฉ ูุฏ ุชูุช ูุนุงูุฌุชูุง ูุณุจููุง ุจุงุณุชุฎุฏุงู ุนูููุงุช <code>log returns</code> ุฃู ุฌูุจูุง ุฅูู ุงูุณูุฉ ุงููุฎุชููุฉ ุจุดูู ูุฎุชูู.  ููุน ุฐูู ุ ุชุจุฑุฒ ุงููุดููุฉ ุงูุฑุฆูุณูุฉ ุนูุฏูุง ูุชู ุชูููุฐ ูุฐู ุงูููุงุฐุฌ ูู ูุธุงู ุชุฏุงูู ุญูููู ุ ุญูุซ ูุง ูุชู ุถูุงู ุงูุชูุงุฒู ุนูุฏ ุฅุถุงูุฉ ุจูุงูุงุช ุฌุฏูุฏุฉ. <br><br>  ูููู ุฃู ูููู ุงูุญู ููุฐู ุงููุดููุฉ ูู ุงูุดุจูุงุช ุงูุนุตุจูุฉ ุงูุชู ูุง ุชุชุทูุจ ุงูุงุณุชูุงูุฉ.  ุงูุดุจูุงุช ุงูุนุตุจูุฉ ูุนุงูุฉ ูู ุงูุจุฏุงูุฉ ูู ุฅูุฌุงุฏ ุงูุนูุงูุงุช ุจูู ุงูุจูุงูุงุช ููู ูุงุฏุฑุฉ ุนูู ุงูุชูุจุค (ุฃู ุชุตููู) ุงูุจูุงูุงุช ุงูุฌุฏูุฏุฉ ุจูุงุกู ุนูููุง. <br><br>  ุนุงุฏุฉู ูุง ูุชููู ูุดุฑูุน ุนููู ุงูุจูุงูุงุช ูู ุงูุนูููุงุช ุงูุชุงููุฉ: <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุฌูุน ุงูุจูุงูุงุช - ูููุฑ ูุฌููุนุฉ ูู ุงูุฎุตุงุฆุต ุงูุถุฑูุฑูุฉ. </li><li style=";text-align:right;direction:rtl">  ุบุงูุจูุง ูุง ุชููู ุงููุนุงูุฌุฉ ุงููุณุจูุฉ ููุจูุงูุงุช ุฎุทูุฉ ูุฎููุฉ ูููููุง ุถุฑูุฑูุฉ ูุจู ุงุณุชุฎุฏุงู ุงูุจูุงูุงุช. </li><li style=";text-align:right;direction:rtl">  ุชุทููุฑ ูุชูููุฐ ุงููููุฐุฌ ูู ุงุฎุชูุงุฑ ููุน ุงูุดุจูุฉ ุงูุนุตุจูุฉ ููุนููุงุชูุง. </li><li style=";text-align:right;direction:rtl">  ููุงุฐุฌ ุงูุงุฎุชุจุงุฑ ุงูุฎููู (ุงูุงุฎุชุจุงุฑ ุนูู ุงูุจูุงูุงุช ุงูุชุงุฑูุฎูุฉ) ูู ุฎุทูุฉ ุฑุฆูุณูุฉ ูู ุฃู ุงุณุชุฑุงุชูุฌูุฉ ุชุฏุงูู. </li><li style=";text-align:right;direction:rtl">  ุงูุชุญุณูู - ุงุจุญุซ ุนู ุงููุนููุงุช ุงูููุงุณุจุฉ. </li></ol><br>  ูุฏุฎูุงุช ูุดุจูุชูุง ุงูุนุตุจูุฉ - ุจูุงูุงุช ุนู ุฃุณุนุงุฑ ุงูุฃุณูู ุฎูุงู ุงูุฃูุงู ุงูุนุดุฑุฉ ุงูุฃุฎูุฑุฉ.  ุจูุณุงุนุฏุชูู ุ ุณูู ูุชููุน ุงูุฃุณุนุงุฑ ูู ุงูููู ุงูุชุงูู. <br><br><h2 style=";text-align:right;direction:rtl">  ุฌูุน ุงูุจูุงูุงุช </h2><br>  ูุญุณู ุงูุญุธ ุ ูููู ุงูุนุซูุฑ ุนูู ุงูุจูุงูุงุช ุงููุงุฒูุฉ ููุฐุง ุงููุดุฑูุน ุนูู Yahoo Finance.  ูููู ุฌูุน ุงูุจูุงูุงุช ุจุงุณุชุฎุฏุงู Python API <code>pdr.get_yahoo_data(ticker, start_date, end_date)</code> ุฃู ูุจุงุดุฑุฉ ูู ุงููููุน. <br><br><h2 style=";text-align:right;direction:rtl">  ูุนุงูุฌุฉ ุงูุจูุงูุงุช </h2><br>  ูู ุญุงูุชูุง ุ ูุฌุจ ุชูุณูู ุงูุจูุงูุงุช ุฅูู ูุฌููุนุงุช ุชุฏุฑูุจ ุชุชููู ูู 10 ุฃุณุนุงุฑ ุณุงุจูุฉ ูุฃุณุนุงุฑ ุงูููู ุงูุชุงูู.  ููููุงู ุจุฐูู ุ ุญุฏุฏุช ูุฆุฉ <code>Preprocessing</code> ุ ูุงูุชู ุณุชุนูู ูุน ุจูุงูุงุช ุงูุชุฏุฑูุจ ูุงูุงุฎุชุจุงุฑ.  ุฏุงุฎู ุงููุตู ุ ููุช ุจุชุนุฑูู ุทุฑููุฉ <code>get_train(self, seq_len)</code> ุ ูุงูุชู ุชุญูู ูุฏุฎูุงุช ุงูุชุฏุฑูุจ ูุจูุงูุงุช ุงููุฎุฑุฌุงุช ุฅูู ูุตูููุงุช <code>NumPy</code> ุ ูุน ุชุญุฏูุฏ ุทูู ูุงูุฐุฉ ูุนููุฉ (ูู ุญุงูุชูุง 10).  ูุจุฏู ุงูุฑูุฒ ุจุงููุงูู ููุง ููู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">gen_train</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, seq_len)</span></span></span><span class="hljs-function">:</span></span>  <span class="hljs-string"><span class="hljs-string">"""  Generates training data  :param seq_len: length of window  :return: X_train and Y_train  """</span></span>  <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range((len(self.stock_train)//seq_len)*seq_len - seq_len - <span class="hljs-number"><span class="hljs-number">1</span></span>):      x = np.array(self.stock_train.iloc[i: i + seq_len, <span class="hljs-number"><span class="hljs-number">1</span></span>])      y = np.array([self.stock_train.iloc[i + seq_len + <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>]], np.float64)      self.input_train.append(x)      self.output_train.append(y)  self.X_train = np.array(self.input_train)  self.Y_train = np.array(self.output_train)</code> </pre> <br>  ูุจุงููุซู ุ ุญุฏุฏุช ุทุฑููุฉ ุชุญูู ุจูุงูุงุช ุงูุงุฎุชุจุงุฑ <code>X_test</code> ู <code>Y_test</code> . <br><br><h2 style=";text-align:right;direction:rtl">  ููุงุฐุฌ ุงูุดุจูุงุช ุงูุนุตุจูุฉ </h2><br>  ุจุงููุณุจุฉ ูููุดุฑูุน ุ ุงุณุชุฎุฏูุช ูููุฐุฌูู ููุดุจูุงุช ุงูุนุตุจูุฉ: Multilayer Perceptron (MLP) ู Long Short Term Model (LSTM).  ุณุฃุชุญุฏุซ ุจุงุฎุชุตุงุฑ ุนู ููููุฉ ุนูู ูุฐู ุงูููุงุฐุฌ.  ุงูุฑุฃ ุงููุฒูุฏ ุนู MLP ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุงู ุขุฎุฑ</a> ุ ูุนู ุนูู LSTM ูู Jacob Aungiers. <br><br>  MLP ูู ุฃุจุณุท ุดูู ูู ุฃุดูุงู ุงูุดุจูุงุช ุงูุนุตุจูุฉ.  ุชูุน ุจูุงูุงุช ุงูุฅุฏุฎุงู ูู ุงููููุฐุฌ ูุจุงุณุชุฎุฏุงู ุฃูุฒุงู ูุนููุฉ ุ ูุชู ุฅุฑุณุงู ุงูููู ูู ุฎูุงู ุทุจูุงุช ูุฎููุฉ ููุญุตูู ุนูู ุจูุงูุงุช ุงูุฅุฎุฑุงุฌ.  ูุฃุชู ุชุนูู ุงูุฎูุงุฑุฒููุฉ ูู ุงูุงูุชุดุงุฑ ุงูุฎููู ูู ุฎูุงู ุทุจูุงุช ูุฎููุฉ ูุชุบููุฑ ููู ุงููุฒู ููู ุฎููุฉ ุนุตุจูุฉ.  ุงููุดููุฉ ูู ูุฐุง ุงููููุฐุฌ ูู ููุต "ุงูุฐุงูุฑุฉ".  ูู ุงููุณุชุญูู ุชุญุฏูุฏ ูุงููุฉ ุงูุจูุงูุงุช ุงูุณุงุจูุฉ ูููู ูููู ูููุจุบู ุฃู ุชุคุซุฑ ุนูู ุงูุจูุงูุงุช ุงูุฌุฏูุฏุฉ.  ูู ุณูุงู ูููุฐุฌูุง ุ ูุฏ ุชูู ุงูุงุฎุชูุงูุงุช ููุฏุฉ 10 ุฃูุงู ุจูู ุจูุงูุงุช ูุฌููุนุชู ุจูุงูุงุช ุ ููู MLPs ุบูุฑ ูุงุฏุฑุฉ ุนูู ุชุญููู ูุฐู ุงูุนูุงูุงุช. <br><br>  ููููุงู ุจุฐูู ุ ุงุณุชุฎุฏู LSTM ุฃู ุงูุดุจูุงุช ุงูุนุตุจูุฉ ุงููุชูุฑุฑุฉ (RNN).  ุชุฎุฒู ุดุจูุงุช RNN ูุนูููุงุช ูุนููุฉ ููุจูุงูุงุช ูุงุณุชุฎุฏุงููุง ูุงุญููุง ุ ููุฐุง ูุณุงุนุฏ ุงูุดุจูุฉ ุงูุนุตุจูุฉ ุนูู ุชุญููู ุงููููู ุงููุนูุฏ ููุนูุงูุงุช ุจูู ุจูุงูุงุช ุฃุณุนุงุฑ ุงูุฃุณูู.  ูููู ูุน RNN ุ ุชูุดุฃ ูุดููุฉ ุงูุชุฏุฑุฌ ุงููุชูุงุดู.  ููุฎูุถ โโุงูุชุฏุฑุฌ ูุฃู ุนุฏุฏ ุงูุทุจูุงุช ูุฒุฏุงุฏ ููุชุถุงุนู ูุณุชูู ุงูุชุฏุฑูุจ (ูููุฉ ุฃูู ูู ุงููุญุฏุฉ) ุนุฏุฉ ูุฑุงุช.  ุญู ูุดููุฉ LSTM ุนู ุทุฑูู ุฒูุงุฏุฉ ุงูููุงุกุฉ. <br><br><h2 style=";text-align:right;direction:rtl">  ุชูููุฐ ุงููููุฐุฌ </h2><br>  ูุชูููุฐ ุงููููุฐุฌ ุ ุงุณุชุฎุฏูุช <code>Keras</code> ุ ูุฃูู ุชุชู ุฅุถุงูุฉ ุทุจูุงุช ุชุฏุฑูุฌููุง ุ ููุง ุชุญุฏุฏ ุงูุดุจูุฉ ุจุงููุงูู ูุฑุฉ ูุงุญุฏุฉ.  ุญุชู ูุชููู ูู ุชุบููุฑ ุนุฏุฏ ูููุน ุงูุทุจูุงุช ุจุณุฑุนุฉ ุ ูุชุญุณูู ุงูุดุจูุฉ ุงูุนุตุจูุฉ. <br><br>  ูุนุฏ ุชุทุจูุน ุงูุจูุงูุงุช ุฎุทูุฉ ูููุฉ ูู ุงูุนูู ูุน ุฃุณุนุงุฑ ุงูุฃุณูู.  ุนุงุฏุฉ ูุง ุชููู ุจุทุฑุญ ูุชูุณุท โโุงูุฎุทุฃ ูุชูุณููู ุนูู ุงูุฎุทุฃ ุงูููุงุณู.  ููููุง ูุญุชุงุฌ ุฅูู ุงุณุชุฎุฏุงู ูุฐุง ุงููุธุงู ูู ุงูุชุฏุงูู ุงูุญูููู ููุชุฑุฉ ุฒูููุฉ ูุนููุฉ.  ูุจุงูุชุงูู ุ ูุฏ ูุง ูููู ุงุณุชุฎุฏุงู ุงูุฅุญุตุงุกุงุช ุงูุทุฑููุฉ ุงูุฃูุซุฑ ุฏูุฉ ูุชุทุจูุน ุงูุจูุงูุงุช.  ูุฐูู ููุช ููุท ุจุชูุณูู ุฌููุน ุงูุจูุงูุงุช ุฅูู 200 (ุฑูู ุนุดูุงุฆู ููุงุฑูุฉ ุจุฌููุน ุงูุฃุฑูุงู ุงูุฃุฎุฑู ุตุบูุฑุฉ).  ูุนูู ุงูุฑุบู ูู ุฃูู ูุจุฏู ุฃู ูุซู ูุฐุง ุงูุชุทุจูุน ููุณ ูู ูุง ูุจุฑุฑู ููุง ูุนูู ูู ุ ููู ุงููุนุงู ุงูุชุฃูุฏ ูู ุฃู ุงูุฃูุฒุงู ูู ุงูุดุจูุฉ ุงูุนุตุจูุฉ ูุง ุชุตุจุญ ูุจูุฑุฉ ุฌุฏูุง. <br><br>  ููุจุฏุฃ ุจูููุฐุฌ ุฃุจุณุท - MLP.  Keras ูุจูู ุชุณูุณู ููุถูู ุทุจูุงุช ูุซููุฉ ูููู.  ูุจุฏู ุงูุฑูุฒ ุงููุงูู ููุง ููู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">model = tf.keras.models.Sequential() model.add(tf.keras.layers.Dense(<span class="hljs-number"><span class="hljs-number">100</span></span>, activation=tf.nn.relu)) model.add(tf.keras.layers.Dense(<span class="hljs-number"><span class="hljs-number">100</span></span>, activation=tf.nn.relu)) model.add(tf.keras.layers.Dense(<span class="hljs-number"><span class="hljs-number">1</span></span>, activation=tf.nn.relu)) model.compile(optimizer=<span class="hljs-string"><span class="hljs-string">"adam"</span></span>, loss=<span class="hljs-string"><span class="hljs-string">"mean_squared_error"</span></span>)</code> </pre> <br>  ุจุงุณุชุฎุฏุงู Keras ูู ุฎูุณุฉ ุฃุณุทุฑ ูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุ ุฃูุดุฃูุง MLP ูุน ุทุจูุงุช ูุฎููุฉ ุ ูุงุฆุฉ ุนุตุจูู ูู ูู ูููุง.  ูุงูุขู ููููุงู ุนู ุงููุญุณู.  ุชูุชุณุจ ุทุฑููุฉ Adam (ุชูุฏูุฑ ุงููุญุธุฉ ุงูุชููููุฉ) ุดุนุจูุฉ - ุฎูุงุฑุฒููุฉ ุชุญุณูู ุฃูุซุฑ ููุงุกุฉ ููุงุฑูุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุจูุณุจ ุงูุชุฏุฑุฌ ุงูุนุดูุงุฆู</a> .  ููุงู ููุนุงู ูู ุงูุงูุชุฏุงุฏุงุช ุงูุฃุฎุฑู ููุณุจ ุงูุชุฏุฑุฌ ุงูุนุดูุงุฆู - ุชุธูุฑ ูุฒุงูุง ุขุฏู ุนูู ุงูููุฑ ุนูู ุฎูููุชูู: <br><br>  <b>AdaGrad</b> - ูุญุงูุธ ุนูู ุณุฑุนุฉ ุชุนูู ูุญุฏุฏุฉ ุ ููุง ูุญุณู ุงููุชุงุฆุฌ ุนูุฏ ุงุฎุชูุงู ุงูุชุฏุฑุฌุงุช (ุนูู ุณุจูู ุงููุซุงู ุ ูุน ูุดุงูู ูู ุงููุบุฉ ุงูุทุจูุนูุฉ ูุฑุคูุฉ ุงูููุจููุชุฑ). <br><br>  <b>RMSProp</b> - ูุญุงูุธ ุนูู ุณุฑุนุฉ ุชุฏุฑูุจ ูุญุฏุฏุฉ ุ ูุงูุชู ูููู ุฃู ุชุฎุชูู ุงุนุชูุงุฏูุง ุนูู ูุชูุณุท โโููู ุงูุชุฏุฑุฌุงุช ุงูุญุฏูุซุฉ ูููุฒู (ุนูู ุณุจูู ุงููุซุงู ุ ูุฏู ุณุฑุนุฉ ุชุบููุฑู).  ูุฐุง ูุนูู ุฃู ุงูุฎูุงุฑุฒููุฉ ุชุชููู ุจุดูู ุฌูุฏ ูุน ุงููุดุงูู ุบูุฑ ุงูุซุงุจุชุฉ (ุนูู ุณุจูู ุงููุซุงู ุ ุงูุถูุถุงุก). <br><br>  ูุฌูุน ุขุฏู ุจูู ููุงุฆุฏ ูุฐู ุงูุงูุชุฏุงุฏุงุช ุ ูุฐูู ุงุฎุชุฑุช ุฐูู. <br><br>  ุงูุขู ููุงุณุจ ุงููููุฐุฌ ูุน ุจูุงูุงุช ุงูุชุฏุฑูุจ ูุฏููุง.  ูุจุณุท Keras ุงููููุฉ ูุฑุฉ ุฃุฎุฑู ุ ููุท ุงูุฑูุฒ ุงูุชุงูู ูุทููุจ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">model.fit(X_train, Y_train, epochs=<span class="hljs-number"><span class="hljs-number">100</span></span>)</code> </pre> <br>  ุนูุฏูุง ูููู ุงููููุฐุฌ ุฌุงูุฒูุง ุ ุชุญุชุงุฌ ุฅูู ุงูุชุญูู ููู ุนูู ุจูุงูุงุช ุงูุงุฎุชุจุงุฑ ูุชุญุฏูุฏ ูุฏู ูุฌุงุญู.  ูุชู ุฐูู ุนูู ุงููุญู ุงูุชุงูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">model.evaluate(X_test, Y_test)</code> </pre> <br>  ูููู ุงุณุชุฎุฏุงู ุงููุนูููุงุช ุงูุชู ุชู ุงูุญุตูู ุนูููุง ูู ุงูุชุญูู ูุชูููู ูุฏุฑุฉ ุงููููุฐุฌ ุนูู ุงูุชูุจุค ุจุฃุณุนุงุฑ ุงูุฃุณูู. <br><br>  ูุชู ุงุณุชุฎุฏุงู ุฅุฌุฑุงุก ููุงุซู ููููุฐุฌ LSTM ุ ูุฐูู ุณุฃุนุฑุถ ุงูููุฏ ูุฃุดุฑุญู ููููุงู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">model = tf.keras.Sequential() model.add(tf.keras.layers.LSTM(<span class="hljs-number"><span class="hljs-number">20</span></span>, input_shape=(<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>), return_sequences=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)) model.add(tf.keras.layers.LSTM(<span class="hljs-number"><span class="hljs-number">20</span></span>)) model.add(tf.keras.layers.Dense(<span class="hljs-number"><span class="hljs-number">1</span></span>, activation=tf.nn.relu)) model.compile(optimizer=<span class="hljs-string"><span class="hljs-string">"adam"</span></span>, loss=<span class="hljs-string"><span class="hljs-string">"mean_squared_error"</span></span>) model.fit(X_train, Y_train, epochs=<span class="hljs-number"><span class="hljs-number">50</span></span>) model.evaluate(X_test, Y_test)</code> </pre> <br>  ูุฑุฌู ููุงุญุธุฉ ุฃู Keras ุชุญุชุงุฌ ุฅูู ุจูุงูุงุช ุจุญุฌู ูุนูู ุ ุงุนุชูุงุฏูุง ุนูู ุทุฑุงุฒู.  ูู ุงูููู ุฌุฏูุง ุชุบููุฑ ุดูู ุงูุตููู ุจุงุณุชุฎุฏุงู NumPy. <br><br><h2 style=";text-align:right;direction:rtl">  ููุงุฐุฌ ุงูุงุฎุชุจุงุฑ ุงูุฎููู </h2><br>  ุนูุฏูุง ูููุง ุจุฅุนุฏุงุฏ ููุงุฐุฌูุง ุจุงุณุชุฎุฏุงู ุจูุงูุงุช ุงูุชุฏุฑูุจ ูุงุฎุชุจุฑูุงูุง ุนูู ุจูุงูุงุช ุงูุงุฎุชุจุงุฑ ุ ูููููุง ุงุฎุชุจุงุฑ ุงููููุฐุฌ ุนูู ุงูุจูุงูุงุช ุงูุชุงุฑูุฎูุฉ.  ูุชู ุฐูู ุนูู ุงููุญู ุงูุชุงูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">back_test</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(strategy, seq_len, ticker, start_date, end_date, dim)</span></span></span><span class="hljs-function">:</span></span>  <span class="hljs-string"><span class="hljs-string">"""  A simple back test for a given date period  :param strategy: the chosen strategy. Note to have already formed the model, and fitted with training data.  :param seq_len: length of the days used for prediction  :param ticker: company ticker  :param start_date: starting date  :type start_date: "YYYY-mm-dd"  :param end_date: ending date  :type end_date: "YYYY-mm-dd"  :param dim: dimension required for strategy: 3dim for LSTM and 2dim for MLP  :type dim: tuple  :return: Percentage errors array that gives the errors for every test in the given date range  """</span></span>  data = pdr.get_data_yahoo(ticker, start_date, end_date)  stock_data = data[<span class="hljs-string"><span class="hljs-string">"Adj Close"</span></span>]  errors = []  <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range((len(stock_data)//<span class="hljs-number"><span class="hljs-number">10</span></span>)*<span class="hljs-number"><span class="hljs-number">10</span></span> - seq_len - <span class="hljs-number"><span class="hljs-number">1</span></span>):      x = np.array(stock_data.iloc[i: i + seq_len, <span class="hljs-number"><span class="hljs-number">1</span></span>]).reshape(dim) / <span class="hljs-number"><span class="hljs-number">200</span></span>      y = np.array(stock_data.iloc[i + seq_len + <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>]) / <span class="hljs-number"><span class="hljs-number">200</span></span>      predict = strategy.predict(x)      <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> predict == <span class="hljs-number"><span class="hljs-number">0</span></span>:          predict = strategy.predict(x)      error = (predict - y) / <span class="hljs-number"><span class="hljs-number">100</span></span>      errors.append(error)      total_error = np.array(errors)  print(<span class="hljs-string"><span class="hljs-string">f"Average error = </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{total_error.mean()}</span></span></span><span class="hljs-string">"</span></span>)</code> </pre> <br>  ููุน ุฐูู ุ ูุฐู ูุณุฎุฉ ูุจุณุทุฉ ูู ุงูุงุฎุชุจุงุฑ.  ุจุงููุณุจุฉ ููุธุงู ุงูุงุฎุชุจุงุฑ ุงูุฎููู ุงููุงูู ุ ูุฌุจ ูุฑุงุนุงุฉ ุนูุงูู ูุซู "ุชุญูุฒ ุงูุจูุงุก ุนูู ููุฏ ุงูุญูุงุฉ" ุ ูุงูุชุญูุฒ (ุงูุชุทูุน ุฅูู ุงููุณุชูุจู) ุ ูุธุฑูู ุงูุณูู ุงููุชุบูุฑุฉ ูุชูุงููู ุงููุนุงููุงุช.  ูุธุฑูุง ูุฃู ูุฐุง ูุฌุฑุฏ ูุดุฑูุน ุชุนูููู ุ ูุฅู ุงูุงุฎุชุจุงุฑ ุงูุฎููู ุงูุจุณูุท ูููู. <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/qw/_9/hy/qw_9hyxncpkhgxv_rvsxxtxrhlk.png"></div><br>  <i>ุชููุนุงุช ูููุฐุฌ LSTM ุงูุฎุงุต ุจู ูุฃุณุนุงุฑ ุฃุณูู Apple ูู ูุจุฑุงูุฑ</i> <br><br>  ุจุงููุณุจุฉ ุฅูู ูููุฐุฌ LSTM ุงูุจุณูุท ุจุฏูู ุชุญุณูู ุ ูุฐู ูุชูุฌุฉ ุฌูุฏุฉ ุฌุฏูุง.  ููุจูู ุฃู ุงูุดุจูุงุช ุงูุนุตุจูุฉ ูููุงุฐุฌ ุงูุชุนูู ุงูุขูู ูุงุฏุฑุฉ ุนูู ุจูุงุก ุงุชุตุงูุงุช ูุนูุฏุฉ ููุณุชูุฑุฉ ุจูู ุงููุนููุงุช. <br><br><h2 style=";text-align:right;direction:rtl">  ุชุญุณูู ุงููุนููุงุช </h2><br>  ุบุงูุจูุง ูุง ุชููู ููุงู ุญุงุฌุฉ ุฅูู ุงูุชุญุณูู ูุชุญุณูู ูุชุงุฆุฌ ุงููููุฐุฌ ุจุนุฏ ุงูุงุฎุชุจุงุฑ.  ูู ุฃูู ุจุชุถููููุง ูู ุฅุตุฏุงุฑ ููุชูุญ ุงููุตุฏุฑ ุจุญูุซ ูููู ูููุฑุงุก ูุญุงููุฉ ุชุญุณูู ุงููููุฐุฌ ุจุฃููุณูู.  ุณูุชุนูู ุนูู ุฃููุฆู ุงูุฐูู ูุง ูุนุฑููู ููููุฉ ุงูุชุญุณูู ุงูุนุซูุฑ ุนูู ูุนููุงุช ููุฑุทุฉ ูู ุดุฃููุง ุชุญุณูู ุฃุฏุงุก ุงููููุฐุฌ.  ููุงู ุงูุนุฏูุฏ ูู ุงูุทุฑู ููุนุซูุฑ ุนูู ุงููุนููุงุช ุงูููุฑุทุฉ: ูู ุชุญุฏูุฏ ุงููุนููุงุช ุนูู ุงูุดุจูุฉ ุฅูู ุงูุฃุณุงููุจ ุงูุนุดูุงุฆูุฉ. <br><br>  ุฃูุง ูุชุฃูุฏ ูู ุฃูู ูุน ุชุญุณูู ุงูููุงุฐุฌ ุ ุชูุชูู ุงููุนุฑูุฉ ูู ูุฌุงู ุงูุชุนูู ุงูุขูู ุฅูู ูุณุชูู ุฌุฏูุฏ.  ุญุงูู ุชุญุณูู ุงููููุฐุฌ ุจุญูุซ ูุนูู ุจุดูู ุฃูุถู ูู ุงููููุฐุฌ ุงูุฎุงุต ุจู.  ูุงุฑู ุงููุชูุฌุฉ ุจุงูุฑุณู ุงูุจูุงูู ุฃุนูุงู. <br><br><h2 style=";text-align:right;direction:rtl">  ุงูุฎูุงุตุฉ </h2><br>  ูุชุทูุฑ ุงูุชุนูู ุงูุขูู ุจุงุณุชูุฑุงุฑ - ุชุธูุฑ ุทุฑู ุฌุฏูุฏุฉ ูู ููู ุ ูุฐูู ูู ุงูููู ุฌุฏูุง ุงูุชุนูู ุจุงุณุชูุฑุงุฑ.  ุฃูุถู ุทุฑููุฉ ููููุงู ุจุฐูู ูู ุฅูุดุงุก ูุดุงุฑูุน ูุซูุฑุฉ ููุงูุชูุงู ุ ุนูู ุณุจูู ุงููุซุงู ุ ุจูุงุก ููุงุฐุฌ ููุชูุจุค ุจุฃุณุนุงุฑ ุงูุฃุณูู.  ูุนูู ุงูุฑุบู ูู ุฃู ูููุฐุฌ LSTM ุงูุฎุงุต ุจู ููุณ ุฌูุฏูุง ุจูุง ูููู ููุงุณุชุฎุฏุงู ูู ุงูุชุฏุงูู ุงูุญูููู ุ ุฅูุง ุฃู ุงูุฃุณุงุณ ุงูุฐู ุชู ูุถุนู ูู ุชุทููุฑ ูุซู ูุฐุง ุงููููุฐุฌ ูุฏ ูุณุงุนุฏ ูู ุงููุณุชูุจู. <br><br><h2 style=";text-align:right;direction:rtl">  ูู ุงููุญุฑุฑูู </h2><br>  ุฏูุฑุงุช Netology ุญูู ูุฐุง ุงูููุถูุน: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูููุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุญูู ุงูุจูุงูุงุช</a> ุนุจุฑ ุงูุฅูุชุฑูุช </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุนุงูู ุงูุจูุงูุงุช</a> ุงููููุฉ </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar428227/">https://habr.com/ru/post/ar428227/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar428217/index.html">ููููู ููุงููุฉ ููุฏูู ูู ุงูููู ุฃู "Call mom!"</a></li>
<li><a href="../ar428219/index.html">ูู ุฃูู ุฃุชุช ููุงุฑุณุฉ ุงูููู ุงูุฌูุงุนู ููููุธููู ุงููุคููููุ</a></li>
<li><a href="../ar428221/index.html">ุฌูู ููุธูุฉ ุงูุนูู ุงูุฏูููุฉ ูู ุงููุฌูู ุงููุงูุนูุฉ</a></li>
<li><a href="../ar428223/index.html">ุงููุฏู ูุจูุงูุงุชูุง ุงูุถุฎูุฉ</a></li>
<li><a href="../ar428225/index.html">ููููุฉ ุฅุฌุฑุงุก ุชุญูููุงุช ุงูููุจ ูู SaaS ูู ุฎูุงู Google Analytics: ุชูุฏูู ูุชุชุจุน ูุณุงุฑ ุงูุชุญููู</a></li>
<li><a href="../ar428229/index.html">ููู ุฃุตุจุญุช ููุณุจ ูุบุฉ ุจุฑูุฌุฉ ููู</a></li>
<li><a href="../ar428231/index.html">ุฌูููุฉ ููุธููุฉ: ุงูุฃุฏูุงุช ุงูุชู ุชุณุงุนุฏู ุนูู ุชุญููู ููุฏ ุดุจู ูุซุงูู</a></li>
<li><a href="../ar428233/index.html">ุฎูุณุฉ ุฃุณุจุงุจ ุชุญุจ ุฃุทุฑุงู ุชูููููุฌูุง ุงููุนูููุงุช ุงูุฅูููููุฉ</a></li>
<li><a href="../ar428235/index.html">ููุงุฐุง ุงุชุตููุง ุจู ูู ููุงูุฉ ุงูุฃูู ุงููููู ูู ููุชุตู ุงูููู ูุทูุจูุง ุงููุตุฏุฑ</a></li>
<li><a href="../ar428237/index.html">Scrum-mitap ูุน ูุนุจุฉ ุงูููุญุฉ: ุฏุนูุฉ ุฅูู ูุนุจุฉ Scrum Values</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>