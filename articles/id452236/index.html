<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘©ğŸ¾â€ğŸ¤â€ğŸ‘©ğŸ¼ ğŸ§‘ğŸ½â€ğŸ¤â€ğŸ§‘ğŸ» ğŸ” Harmoni skrip di dalam aplikasi Android ğŸ¦ ğŸ¥§ ğŸ›€ğŸ¾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Saya pikir banyak pembaca hub pengembangan android telah mendengar bahwa Java memungkinkan Anda untuk memodifikasi dex dari aplikasi yang sudah diinst...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Harmoni skrip di dalam aplikasi Android</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/funcorp/blog/452236/"><img src="https://habrastorage.org/webt/fg/1f/cu/fg1fcuyoiy9d4xo479hy2jx4fwu.jpeg"><br><br>  Saya pikir banyak pembaca hub pengembangan android telah mendengar bahwa Java memungkinkan Anda untuk memodifikasi dex dari aplikasi yang sudah diinstal dalam <i>runtime</i> melalui <i>ClassLoader</i> .  Dengan ini, Anda dapat memuat kode yang dikompilasi dalam runtime dan menggunakannya.  Tetapi Google memperlakukan penipuan semacam itu, dengan kata lain, tidak terlalu loyal dan melarang mereka yang tertangkap dalam aplikasi semacam itu. <br><br>  Namun, ada cara alternatif untuk mengunduh dan menjalankan skrip pada perangkat seluler.  Untuk detail di bawah kucing! <br><a name="habracut"></a><br>  Jadi, meskipun kami tidak dapat memperbarui aplikasi dex di runtime, kami dapat menggunakan penerjemah bahasa scripting yang sepenuhnya ditulis dalam Java.  Jadi Oracle, dimulai dengan versi 6, termasuk mesin jhascript Badak di JVM.  Ini terjadi berkat implementasi spesifikasi JSR-223, yang menyatakan dukungan Java untuk bahasa pemrograman scripting. <br><br>  Saat ini, ada beberapa mesin built-in untuk bahasa pemrograman populer seperti: Lua (Luaj), Python (Jython), Ruby (Jruby) dan java-script (Rhino, ...).  Masing-masing memungkinkan Anda untuk menjalankan skrip dan fungsi akses yang ditulis dalam Java. <br>  Sebagai demonstrasi kemungkinan, saya mengusulkan untuk menerapkan "lingkungan" pembangunan.  Saya akan meninggalkan tautan ke sumber di akhir artikel.  Agar tidak mengacaukan contoh, saya akan fokus pada Lua, meskipun tidak ada yang menghentikan Anda menghubungkan semua mesin pada saat yang sama dan beralih di antara mereka.  Versi JLua saat ini pada saat penulisan tersedia di mvnrepository: <i>org.luaj: luaj-jse: 3.0.1</i> . <br>  Setiap lingkungan pengembangan yang menghargai diri sendiri harus memiliki bidang untuk memasukkan skrip, bidang untuk menampilkan hasilnya, dan tombol yang memungkinkan Anda untuk melengkapi gagasan Anda. <br><br>  UI lingkungan pengembangan yang menghargai diri sendiri: <br><br><pre><code class="kotlin hljs">&lt;?xml version=<span class="hljs-string"><span class="hljs-string">"1.0"</span></span> encoding=<span class="hljs-string"><span class="hljs-string">"utf-8"</span></span>?&gt; &lt;androidx.constraintlayout.widget.ConstraintLayout xmlns:android=<span class="hljs-string"><span class="hljs-string">"http://schemas.android.com/apk/res/android"</span></span> xmlns:app=<span class="hljs-string"><span class="hljs-string">"http://schemas.android.com/apk/res-auto"</span></span> android:layout_width=<span class="hljs-string"><span class="hljs-string">"match_parent"</span></span> android:layout_height=<span class="hljs-string"><span class="hljs-string">"match_parent"</span></span>&gt; &lt;EditText android:id=<span class="hljs-string"><span class="hljs-string">"@+id/scriptInput"</span></span> android:layout_width=<span class="hljs-string"><span class="hljs-string">"0dp"</span></span> android:layout_height=<span class="hljs-string"><span class="hljs-string">"0dp"</span></span> android:gravity=<span class="hljs-string"><span class="hljs-string">"top|start"</span></span> android:hint=<span class="hljs-string"><span class="hljs-string">"@string/write_script"</span></span> android:inputType=<span class="hljs-string"><span class="hljs-string">"textMultiLine"</span></span> android:padding=<span class="hljs-string"><span class="hljs-string">"4dp"</span></span> android:textColor=<span class="hljs-string"><span class="hljs-string">"#000000"</span></span> app:layout_constraintBottom_toTopOf=<span class="hljs-string"><span class="hljs-string">"@id/scriptOutput"</span></span> app:layout_constraintEnd_toEndOf=<span class="hljs-string"><span class="hljs-string">"parent"</span></span> app:layout_constraintStart_toStartOf=<span class="hljs-string"><span class="hljs-string">"parent"</span></span> app:layout_constraintTop_toTopOf=<span class="hljs-string"><span class="hljs-string">"parent"</span></span> /&gt; &lt;TextView android:id=<span class="hljs-string"><span class="hljs-string">"@+id/scriptOutput"</span></span> android:layout_width=<span class="hljs-string"><span class="hljs-string">"0dp"</span></span> android:layout_height=<span class="hljs-string"><span class="hljs-string">"0dp"</span></span> android:hint=<span class="hljs-string"><span class="hljs-string">"@string/script_output"</span></span> android:padding=<span class="hljs-string"><span class="hljs-string">"4dp"</span></span> android:textColor=<span class="hljs-string"><span class="hljs-string">"#000000"</span></span> app:layout_constraintBottom_toTopOf=<span class="hljs-string"><span class="hljs-string">"@id/executeButton"</span></span> app:layout_constraintEnd_toEndOf=<span class="hljs-string"><span class="hljs-string">"parent"</span></span> app:layout_constraintStart_toStartOf=<span class="hljs-string"><span class="hljs-string">"parent"</span></span> app:layout_constraintTop_toBottomOf=<span class="hljs-string"><span class="hljs-string">"@id/scriptInput"</span></span> /&gt; &lt;Button android:id=<span class="hljs-string"><span class="hljs-string">"@+id/executeButton"</span></span> android:layout_width=<span class="hljs-string"><span class="hljs-string">"0dp"</span></span> android:layout_height=<span class="hljs-string"><span class="hljs-string">"48dp"</span></span> android:text=<span class="hljs-string"><span class="hljs-string">"@string/run_script"</span></span> app:layout_constraintBottom_toBottomOf=<span class="hljs-string"><span class="hljs-string">"parent"</span></span> app:layout_constraintEnd_toEndOf=<span class="hljs-string"><span class="hljs-string">"parent"</span></span> app:layout_constraintStart_toStartOf=<span class="hljs-string"><span class="hljs-string">"parent"</span></span> /&gt; &lt;/androidx.constraintlayout.widget.ConstraintLayout&gt;</code> </pre> <br>  Untuk mengeksekusi skrip Lua, kita perlu mendapatkan lingkungan global di mana ia akan dieksekusi - <i>Global</i> .  Luaj memungkinkan Anda untuk menyesuaikannya, misalnya, dengan mengatur variabel atau menambahkan binder ke kelas Java.  Peluang penting bagi kami di sini adalah mengatur aliran keluaran pesan, karena <i>java.lang.System.out</i> , <i>java.lang.System.err</i> digunakan secara default, yang sangat tidak nyaman ketika Anda perlu menampilkan hasil eksekusi di TextView.  Untuk mengubah ini, Anda perlu mendefinisikan kembali nilai-nilai <i>Globals # STDOUT</i> dan <i>Globals # STDERR</i> . <br><br>  Jadi, sekarang kita hanya perlu memuat derit ke lingkungan dan menjalankannya. <br><br>  Inilah yang terlihat dalam contoh saya: <br><br><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">runLua</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(script: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> charset = StandardCharsets.UTF_8 <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> globals = JsePlatform.standardGlobals() <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> outStream = ByteArrayOutputStream() <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> outPrintStream = PrintStream(outStream, <span class="hljs-literal"><span class="hljs-literal">true</span></span>, charset.name()) globals.STDOUT = outPrintStream globals.STDERR = outPrintStream <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { globals.load(script).call() scriptOutput.setTextColor(Color.BLACK) scriptOutput.text = String(outStream.toByteArray(), charset) } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (e: LuaError) { scriptOutput.setTextColor(Color.RED) scriptOutput.text = e.message } <span class="hljs-keyword"><span class="hljs-keyword">finally</span></span> { outPrintStream.close() } }</code> </pre><br>  Sekarang mari kita mencoba untuk memperluas set fungsi yang tersedia dengan kemampuan untuk menunjukkan <i>Toast</i> menggunakan pengikatan kelas Java di atas.  Permudah menggunakan <i>CoerceJavaToLua</i> : <br><br><pre> <code class="kotlin hljs">globals.<span class="hljs-keyword"><span class="hljs-keyword">set</span></span>(<span class="hljs-string"><span class="hljs-string">"bubble"</span></span>, CoerceJavaToLua.coerce(Bubble(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>))) ... <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Bubble</span></span></span></span>(<span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> context: Context) { <span class="hljs-comment"><span class="hljs-comment">// called from lua fun show(message: String) { Toast.makeText(context, message, Toast.LENGTH_SHORT).show() } }</span></span></code> </pre><br>  Hasil yang saya dapatkan adalah ini: <br><br><img src="https://habrastorage.org/webt/ka/4k/x7/ka4kx7owdil0ydsd4c1ne8f8thy.png"><br><br>  Jadi, dengan contoh kecil, kami mempertimbangkan kemungkinan menjalankan skrip di dalam aplikasi seluler.  Pembaca yang ingin tahu dapat menebak bahwa skrip dapat diunduh dari aset, sumber daya aplikasi, atau dari server.  Apa yang bisa bermanfaat, misalnya, dalam game.  Untungnya, luaj kompatibel dengan salah satu kerangka kerja game java yang paling populer - Libgdx.  Secara umum, ruang lingkup di sini hanya dibatasi oleh imajinasi pengembang. <br><br>  â†’ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Sumber sampel</a> <br>  â†’ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Luaj</a> <br>  â†’ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Jython</a> <br>  â†’ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Jruby</a> <br>  â†’ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Badak</a> ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">bungkus android</a> ) </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id452236/">https://habr.com/ru/post/id452236/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id452226/index.html">Judulnya akan berbeda</a></li>
<li><a href="../id452228/index.html">Anna Boyarkina, Miro (sebelumnya RealtimeBoard): tentang pemikiran produk, budaya tim, keterampilan masa depan</a></li>
<li><a href="../id452230/index.html">Kami mempelajari dioda terowongan pada contoh 3I306M</a></li>
<li><a href="../id452232/index.html">ObjectRepository - .NET dalam memori repositori pola untuk proyek-proyek rumah Anda</a></li>
<li><a href="../id452234/index.html">Termometer & Hygrometer pada ATMEGA 328P-MU - Meningkatkan Level Pengembangan Arduino</a></li>
<li><a href="../id452240/index.html">Apa yang umum antara orgasme dan Wi-Fi</a></li>
<li><a href="../id452244/index.html">PHPUnit. Manajer Entitas Doktrin Menangis</a></li>
<li><a href="../id452246/index.html">Wawancara dengan Vitaly Bragilevsky: â€œDunia di mana semua orang akan memprogram di Haskell bukan dunia yang baikâ€</a></li>
<li><a href="../id452248/index.html">Kami memompa pengembangan pada Vue menggunakan pola: HOC</a></li>
<li><a href="../id452252/index.html">Keamanan bergaya Google</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>