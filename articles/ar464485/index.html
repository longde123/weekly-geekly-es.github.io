<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧠 🤜🏽 👩🏾‍⚕️ ShIoTiny: تهوية الغرفة الرطبة (مثال على ذلك المشروع) 👨‍👩‍👧‍👦 🎴 🐦</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="النقاط الرئيسية أو ماذا عن هذه المقالة؟ 
 نواصل سلسلة المقالات على ShIoTiny - وحدة تحكم قابلة للبرمجة بصريًا تستند إلى شريحة ESP8266 . 

 توضح هذه الم...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ShIoTiny: تهوية الغرفة الرطبة (مثال على ذلك المشروع)</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/464485/" style=";text-align:right;direction:rtl"><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/ue/so/ox/uesoox7zwrguyei6o5m_ndp2ufw.jpeg"></div><br><h4 style=";text-align:right;direction:rtl">  النقاط الرئيسية أو ماذا عن هذه المقالة؟ </h4><br>  نواصل سلسلة المقالات على <b>ShIoTiny</b> - وحدة تحكم قابلة للبرمجة بصريًا تستند إلى شريحة <b>ESP8266</b> . <br><br>  توضح هذه المقالة مثالًا لمشروع التحكم في التهوية في الحمام أو في غرفة رطبة أخرى حول كيفية إنشاء برنامج لـ <b>ShIoTiny</b> . <br><br><h4 style=";text-align:right;direction:rtl">  المقالات السابقة في السلسلة. </h4><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ShIoTiny: أتمتة صغيرة ، إنترنت الأشياء ، أو "ستة أشهر قبل الإجازات"</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ShIoTiny: العقد والروابط والأحداث أو ميزات برامج الرسم</a> <br><br><h4 style=";text-align:right;direction:rtl">  مراجع </h4><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><b>موقع</b> مشروع <b>ShIoTiny</b></a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">البرامج الثابتة الثنائية ، دائرة التحكم والوثائق</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">تعليمات ووصف العقد</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">إعداد وسيط MQTT cloudmqtt.com</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">لوحة التحكم MQTT لوحة القيادة لالروبوت</a> <br><a name="habracut"></a><br><h4 style=";text-align:right;direction:rtl">  مقدمة </h4><br>  لا يوجد فهم خارج التجربة.  هذه هي الحقيقة التي اختبرها الزمن والأجيال.  لذلك ، لا يوجد شيء أفضل لتعلم المهارات العملية من محاولة القيام بشيء بنفسك.  والأمثلة التي توضح ما يمكن القيام به وما لا يستحق المحاولة ، هنا ستكون مفيدة.  لا يمكن لأخطاء الآخرين ، بالطبع ، أن تمنع حدوث أخطاء خاصة بهم ، ولكن يمكن أن تساعد في تقليل عدد هذه الأخطاء. <br><br>  دفعتني الأسئلة والرسائل من قراء المقالات السابقة إلى عمل مشروع صغير ، كمثال على التحكم في التهوية ، لإظهار كيفية عمل عقد ShIoTiny. <br><br>  الفكرة الأولية ، التي <b>ظهرت</b> على <b>أساسها</b> وحدة التحكم <b>ShIoTiny</b> - محطة <b>الضخ</b> والري - ليست مناسبة للجميع وستكون مثيرة للاهتمام.  لذلك ، أخذت للجميع نظامًا مفهومًا ومفيدًا للتحكم في التهوية كمثال. <br><br>  سأقول إن فكرة المشروع ليست فكرتي ، <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">لكنني حصلت عليها من هنا</a> ثم عدّلت إلى <b>ShIoTiny</b> . <br><br><h4 style=";text-align:right;direction:rtl">  أولا فهم ما تريد </h4><br>  عملية زراعة لا حصر لها.  وكان هذا العقار الذي دمر الكثير من الأفكار والمشاريع الجيدة.  المطور ، بدلاً من الإصدار ، إن لم يكن مثاليًا ، ولكنه شيء عملي ، واصل تحسينه.  لقد أتقن ذلك حتى تحايل المنافسون عليه ، وأطلقوا سراحهم ، إن لم يكن مثاليًا (وغالبًا ما يكونون بائسين بصراحة) ، ولكنهم حل عملي. <br><br>  لذلك ، من المهم جدًا معرفة مكان وضع حد للمشروع.  أو بعبارة أخرى ، من الضروري تحديد ما نريد الحصول عليه في نهاية المشروع مما لدينا في البداية.  باللغة الروسية ، فيما يتعلق بوثيقة تم وضعها فقط لوصف طريقة إنشاء شيء ما ، هناك كلمة "خطة" جميلة قصيرة وواسعة ، بدأ المترجمون المتخلفون عقلياً والمديرين المعاقين في استدعاء "خارطة الطريق" لسبب ما.  حسنا ، رضي الله عنهم. <br><br>  خطتنا ستكون هكذا.  لنفترض أن هناك مساحة يمكن أن تزداد فيها الرطوبة بشكل كبير في بعض الأحيان.  على سبيل المثال ، مثل الحمام أو المطبخ.  الرطوبة شيء غير سارة والطريقة للتعامل معها قديمة قدم العالم: تهوية الغرفة.  هناك عدد لا بأس به من أساليب البث.  لكننا ، ربما ، سوف نرفض الطرق الغريبة والقديمة مثل السود مع الشبكات والتوقف عند المروحة المعتادة.  المراوح أرخص ، والعثور عليها في منطقتنا أسهل. <br><br>  باختصار ، نريد التحكم في المروحة: قم بتشغيلها وإيقافها ، على التوالي.  بتعبير أدق ، نريد تشغيله وإيقافه عند الضرورة. <br><br>  يبقى تحديد: تحت أي ظروف يجب تشغيل المروحة وتحت أي ظروف - إيقاف. <br><br>  كل شيء واضح هنا: إذا كانت الرطوبة أعلى من الحد المحدد مسبقًا ، فإن المروحة تعمل وتوجه الهواء ؛  عادت الرطوبة إلى طبيعتها - تنطفئ المروحة. <br><br>  سوف يراقب القارئ اليقظ على الفور كلمة "معين".  من هو المعطى؟  كيف مسبقا؟ <br><br>  هناك عدة طرق لتعيين الرطوبة العتبة.  سننظر في اثنين منهم: الأول - بمساعدة المقاومة المتغيرة والثاني - عبر الشبكة عبر بروتوكول MQTT.  كل من هذه الطرق لها مزايا وعيوب ، والتي سيتم مناقشتها لاحقًا. <br><br>  بالنسبة لأولئك الذين لا يفهمون ، سوف أشرح أن "الرطوبة العتبة" هي مستوى الرطوبة ، والتي تتطلب إدراج مروحة. <br><br>  والسؤال التالي هو ما إذا كان ينبغي منح المستخدم الحق في تشغيل المروحة مباشرة؟  هذا هو ، بغض النظر عن مستوى الرطوبة ، في لمسة زر واحدة؟  سوف نقدم لمثل هذه الفرصة.  بعد كل شيء ، قد تكون هناك حاجة إلى مروحة ليس فقط مع رطوبة عالية ، ولكن أيضًا للإزالة من الغرفة ، على سبيل المثال ، رائحة كريهة ، يشار إليها على أنها "رائحة كريهة". <br><br>  لذلك ، فهمنا ما نريد وحتى قليلاً كيف ستعمل.  نحن ندرج باختصار جميع وظائف نظام التحكم في التهوية لدينا: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  تحديد مستوى الرطوبة عتبة (خياران) ؛ </li><li style=";text-align:right;direction:rtl">  قياس الرطوبة ؛ </li><li style=";text-align:right;direction:rtl">  إدراج التلقائي للمروحة. </li><li style=";text-align:right;direction:rtl">  الاغلاق التلقائي للمروحة. </li><li style=";text-align:right;direction:rtl">  التضمين اليدوي للمروحة (في لمسة زر واحدة). </li></ul><br>  لذلك ، الخطة واضحة.  من الضروري تنفيذ جميع الوظائف المذكورة أعلاه في برنامجنا.  على أساس هذه "الخطة" سنتصرف.  للبدء ، ارسم رسم تخطيطي للجهاز. <br><br><h4 style=";text-align:right;direction:rtl">  مخطط كتلة الجهاز </h4><br>  بشكل عام ، سيكون لدينا اثنين من هذه المخططات.  الأول هو للخيار الذي يتم فيه تعيين مستوى رطوبة العتبة بواسطة مقاومة متغيرة.  المخطط الثاني هو للخيار الذي يتم فيه تعيين مستوى رطوبة العتبة عبر الشبكة عبر بروتوكول MQTT. <br><br>  ولكن نظرًا لأن هذه الدوائر ستختلف بعنصر واحد فقط - المقاوم المتغير "يحدد مستوى الرطوبة العتبة" ، فإننا سنرسم رسم تخطيطي واحد فقط.  بالطبع ، يبدو المخطط الهيكلي وفقًا لـ GOST مختلفًا.  لكننا لا نركز على المهندسين البيسون ، ولكن على الجيل الأصغر سنا.  لذلك ، الرؤية أكثر أهمية. <br><br><img src="https://habrastorage.org/webt/ut/qh/db/utqhdblfgdlmsv0rkcgqxaztvo8.jpeg"><br><br>  إذن ماذا نرى في الصورة؟  المروحة متصلة بترحيل <b>Relay1 بوحدة</b> التحكم <b>ShIoTiny</b> .  أود أن ألفت انتباهكم إلى حقيقة أن المروحة هي وسيلة منعشة تعيش تحت الجهد العالي.  لذلك ، إذا كان أي شخص سوف يفعل هذا بنفسه - كن حذرا.  هذا ، على الأقل ، قبل لصق أصابعك أو أدوات القياس في الدائرة - افصل المروحة على الأقل.  والنقطة الثانية.  إذا كانت المعجبين لديك أقوى من <b>250 واط</b> ، فعليك عدم توصيلها مباشرة بـ <b>ShIoTiny</b> - فقط من خلال البداية. <br><br>  اكتشفنا المروحة.  الآن زر "التشغيل اليدوي" للمروحة.  كان متصلا المدخلات <b>Input1</b> .  لا يوجد شيء أكثر لشرح. <br><br>  استشعار درجة الحرارة والرطوبة <b>DHT-11</b> (أو <b>DHT-22</b> أو نظائرها).  لتوصيله ، يتم توفير مدخلات خاصة على وحدة تحكم <b>ShIoTiny</b> .  كما ترون في الشكل ، فإن توصيل مثل هذا المستشعر لا يمثل مشكلة أيضًا. <br><br>  وأخيراً ، مقاومة متغيرة تحدد مستوى رطوبة العتبة.  بتعبير أدق ، مقسم يتكون من مقاومات متغيرة وثابتة.  لا توجد مشاكل في اتصاله ، لكنني <b>سأوضح</b> أن ADC المدمج على <b>ESP8266</b> مصمم بحد أقصى 1 فولت.  لذلك ، هناك حاجة إلى مقسم الجهد حوالي 5 مرات. <br><br>  ومرة أخرى ، أذكركم بأن هذا الفاصل ليس ضروريًا إذا كان مستوى عتبة الرطوبة معينًا عبر الشبكة باستخدام بروتوكول MQTT. <br><br>  سنبدأ في إعداد خوارزمية الجهاز في محرر ElDraw ShIoTiny.  كيفية الوصول إلى هناك ، في هذا المحرر ، يمكنك أن تقرأ في المقالات في وقت سابق أو في الإرشادات ، وهو رابط في بداية المقال. <br><br><h4 style=";text-align:right;direction:rtl">  الخيار الأول ، أبسط </h4><br>  لنبدأ <b>بتعبير</b> بسيط: قم بتشغيل مرحل <b>Relay1 عندما</b> يتم تجاوز مستوى الرطوبة للعتبة لفترة معينة. <br><br><img src="https://habrastorage.org/webt/un/8e/kd/un8ekdrb8cy8zvbc6e_ae2ygwyw.png"><br><br>  كما ترون ، لا يوجد شيء معقد: أربع عقد فقط ، وليس حساب نقاط التعليق.  <b>DHT11</b> هو في الواقع مستشعر درجة الحرارة والرطوبة (يمكن تغييره إلى <b>DHT22</b> ). <br><br>  <b>ثابت CONST</b> هو مستوى الرطوبة العتبة ، في المئة. <br><br>  المقارنة - عقدة تقارن رقمين وتعيين الإخراج 1 إذا تم استيفاء الشرط المحدد و 0 إذا لم يتم استيفاء الشرط. <br><br>  في حالتنا ، ستكون هذه الحالة <b>A&gt; B</b> ، حيث <b>A</b> هو مستوى الرطوبة الذي يقاسه المستشعر ، و <b>B</b> هو المستوى الأدنى لنفس الرطوبة. <br><br>  بمجرد أن يتجاوز مستوى الرطوبة المقاسة ( <b>A</b> ) مستوى الرطوبة ( <b>B</b> ) ، يظهر 1 على الفور عند إخراج المقارنة <b>A&gt; B</b> وسيتم تشغيل التتابع.  على العكس ، بمجرد عودة مستوى الرطوبة إلى طبيعته (أي ، <b>&lt;&lt;B</b> ) ، على الفور عند إخراج المقارنة <b>A&gt; B ،</b> ستظهر 0 وسيتم إيقاف تشغيل التتابع. <br><br>  هل كل شيء واضح؟  بالنسبة لأولئك الذين لا يفعلون ذلك ، فعليك قراءتها مرة أخرى أو إلقاء نظرة على وصف تشغيل العقد في التعليمات. <br><br>  ألاحظ أنه <b>يتم</b> تحديث البيانات من جهاز استشعار <b>DHT11</b> مرة واحدة كل 10 ثوانٍ تقريبًا.  لذلك ، لن يكون بإمكان التتابع تشغيله وإيقافه أكثر من مرة كل 10 ثوانٍ. <br><br>  سيكون كل شيء على ما يرام ، لكننا نرغب في تعيين مستوى الرطوبة العتبة باستخدام المقاوم المتغير.  لا شيء أسهل! <br><br><img src="https://habrastorage.org/webt/ez/qe/oi/ezqeoioucwwf0nm90o2sibwizj0.png"><br><br>  فقط استبدل العقدة الثابتة بالعقدة ADC.  بعد كل شيء ، لقد قمنا بتوصيل مقسم الجهد بمقاوم متغير إلى ADC. <br><br>  يختلف الجهد عند مدخل ADC من 0 إلى 1 فولت.  لكن الرطوبة عند إخراج المستشعر - تتراوح من 0 إلى 100٪.  كيف نقارنهم؟  كل شيء بسيط.  العقدة ADC في <b>ShIoTiny</b> لا تقيس فقط جهد الدخل ، ولكنها تعرف أيضًا كيفية <b>قياسه وتحويله</b> . <br><br>  أي عند إخراج عقدة ADC1 (ADC) سيكون هناك قيمة <b>X</b> تحسب بواسطة الصيغة <p style=";text-align:right;direction:rtl"></p><p style=";text-align:right;direction:rtl"><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>X</mi><mo>=</mo><mi>k</mi><mtext>&amp;#xA0;</mtext><mi>c</mi><mi>d</mi><mi>o</mi><mi>t</mi><msub><mi>u</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mi>n</mi></mrow></msub><mo>+</mo><mi>b</mi></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="18.014ex" height="2.419ex" viewBox="0 -780.1 7755.9 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/464485/&amp;usg=ALkJrhjXYNmX7CQjz8yVAInLpfhRyGvXgQ#MJMATHI-58" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/464485/&amp;usg=ALkJrhjXYNmX7CQjz8yVAInLpfhRyGvXgQ#MJMAIN-3D" x="1130" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/464485/&amp;usg=ALkJrhjXYNmX7CQjz8yVAInLpfhRyGvXgQ#MJMATHI-6B" x="2186" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/464485/&amp;usg=ALkJrhjXYNmX7CQjz8yVAInLpfhRyGvXgQ#MJMATHI-63" x="2958" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/464485/&amp;usg=ALkJrhjXYNmX7CQjz8yVAInLpfhRyGvXgQ#MJMATHI-64" x="3391" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/464485/&amp;usg=ALkJrhjXYNmX7CQjz8yVAInLpfhRyGvXgQ#MJMATHI-6F" x="3915" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/464485/&amp;usg=ALkJrhjXYNmX7CQjz8yVAInLpfhRyGvXgQ#MJMATHI-74" x="4400" y="0"></use><g transform="translate(4762,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/464485/&amp;usg=ALkJrhjXYNmX7CQjz8yVAInLpfhRyGvXgQ#MJMATHI-75" x="0" y="0"></use><g transform="translate(572,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/464485/&amp;usg=ALkJrhjXYNmX7CQjz8yVAInLpfhRyGvXgQ#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/464485/&amp;usg=ALkJrhjXYNmX7CQjz8yVAInLpfhRyGvXgQ#MJMATHI-6E" x="345" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/464485/&amp;usg=ALkJrhjXYNmX7CQjz8yVAInLpfhRyGvXgQ#MJMAIN-2B" x="6325" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/464485/&amp;usg=ALkJrhjXYNmX7CQjz8yVAInLpfhRyGvXgQ#MJMATHI-62" x="7326" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>X</mi><mo>=</mo><mi>k</mi><mtext>&nbsp;</mtext><mi>c</mi><mi>d</mi><mi>o</mi><mi>t</mi><msub><mi>u</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>n</mi></mrow></msub><mo>+</mo><mi>b</mi></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-1"> X = k \ cdot u_ {in} + b </script></p>  حيث <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>u</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mi>n</mi></mrow></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.116ex" height="1.817ex" viewBox="0 -520.7 1341.4 782.1" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/464485/&amp;usg=ALkJrhjXYNmX7CQjz8yVAInLpfhRyGvXgQ#MJMATHI-75" x="0" y="0"></use><g transform="translate(572,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/464485/&amp;usg=ALkJrhjXYNmX7CQjz8yVAInLpfhRyGvXgQ#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/464485/&amp;usg=ALkJrhjXYNmX7CQjz8yVAInLpfhRyGvXgQ#MJMATHI-6E" x="345" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>u</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>n</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-2"> u_ {in} </script>  - الجهد عند مدخل ADC (من 0 إلى 1V) ؛  <b>k</b> - المدى (مدى ADC) والإزاحة <b>ب</b> (إزاحة ADC).  وبالتالي ، إذا قمت بتعيين <b>k = 100</b> و <b>b = 0</b> ، فعند التغيير <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>u</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mi>n</mi></mrow></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.116ex" height="1.817ex" viewBox="0 -520.7 1341.4 782.1" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/464485/&amp;usg=ALkJrhjXYNmX7CQjz8yVAInLpfhRyGvXgQ#MJMATHI-75" x="0" y="0"></use><g transform="translate(572,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/464485/&amp;usg=ALkJrhjXYNmX7CQjz8yVAInLpfhRyGvXgQ#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/464485/&amp;usg=ALkJrhjXYNmX7CQjz8yVAInLpfhRyGvXgQ#MJMATHI-6E" x="345" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>u</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>n</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-3"> u_ {in} </script>  في النطاق من 0 إلى 1 ، ستختلف قيمة <b>X</b> عند إخراج وحدة ADC في المدى من 0 إلى 100. وهذا يعني ، مساوياً عدديًا لنطاق الرطوبة يتغير من 0 إلى 100٪. <br><br>  أو ، ببساطة ، عن طريق تشغيل محرك المقاومة المتغيرة ، يمكنك تعيين مستوى الرطوبة الحد من 0 إلى 100. الإزعاج الوحيد هو أنه لا توجد أجهزة عرض.  لكن في الممارسة العملية ، إذا كان محرك المقاومة المتغيرة يجعل 6 أقسام 0٪ ​​، 20٪ ، 40٪ ، 60٪ ، 80٪ ، 100٪) ، فهذا يكفي لتعيين مستوى الرطوبة. <br><br>  كيف يمكننا ضبط معاملات <b>k</b> -range (نطاق ADC) والإزاحة <b>b</b> (إزاحة ADC)؟  نعم ، إنه أسهل من اللفت على البخار!  انقر بمؤشر الماوس في عقدة <b>ADC1</b> وعلى الفور سترى نافذة الإعدادات.  في ذلك يمكنك تعيين كل ما تحتاجه.  بالنسبة لحالتنا ، ستكون هذه نافذة ، كما في الشكل. <br><br><img src="https://habrastorage.org/webt/cn/so/ub/cnsoubc9q_rhu-2p6hlffcd_1ig.png"><br><br>  لذلك ، لدينا أبسط حل العمل.  لنبدأ تحسينه. <br>  بالمناسبة ، الحل الأبسط له ميزة واحدة - فهو لا يحتاج إلى الإنترنت.  انها مستقلة تماما. <br><br><h4 style=";text-align:right;direction:rtl">  الخيار الثاني ، قم بتوصيل الزر </h4><br>  كل شيء يعمل والجميع سعداء.  لكن من حسن الحظ ، لا يمكننا تشغيل التهوية بقوة.  لقد اتفقنا بالفعل على أنه سيتم توصيل زر <b>بالإدخال 1</b> ، والذي سيؤدي إلى تشغيل المروحة وإيقافها بالقوة ، دون الانتباه إلى مستشعر الرطوبة. <br>  حان الوقت لمعالجة هذا الزر في برنامج الدوائر لدينا. <br><br><img src="https://habrastorage.org/webt/rn/9h/p8/rn9hp8-41uqwkms65uqiwynd_-k.png"><br><br>  يتم تمييز وحدة معالجة النقر فوق الزر بخط برتقالي.  إنه عداد نقرات على زر تتم إعادة تعيينه إلى صفر عندما تتجاوز القيمة في ناتجها واحدًا (الخط الأخضر ، خرج العقدة <b>CT</b> ). <br><br>  كل شيء يعمل هنا بشكل عادي كما كان من قبل: يحسب عداد <b>CT</b> نقرات الزر المتصل بـ <b>Input1</b> .  بمعنى أن القيمة في إخراج هذا العداد تزيد بمقدار 1 مع كل نقرة زر. <br><br>  بمجرد أن تصبح هذه القيمة مساوية لاثنين (أي أكثر من 1) ، يظهر على الفور عند إخراج المقارنة <b>A&gt; B</b> 1. وسيؤدي هذا 1 إلى إعادة تعيين العداد <b>CT</b> إلى صفر.  وهذا يعني المقارنة ، واحدة أقل وفقا للمخطط! <br><br>  وبالتالي ، يحتوي زرنا على حالتين - 0 و 1. إذا كنا بحاجة إلى المزيد من الحالات (3 أو 4 أو حتى أكثر) - فسيكون ذلك كافياً لتغيير ثابت <b>CONST</b> من قيمة إلى أخرى. <br><br>  لذلك ، لدينا شرطين لتشغيل المروحة: تجاوز مستوى الرطوبة المحدد والضغط على الزر مرة واحدة.  إذا تم استيفاء أي من الشروط ، سيتم تشغيل المروحة.  وسوف يعمل حتى يتم الضغط على الزر مرة أخرى ويعود مستوى الرطوبة إلى طبيعته. <br><br>  يمكنك بالطبع تعقيد الخوارزمية أكثر ، لكننا لن نفعل ذلك - سنترك مجالًا للإبداع لأولئك الذين يرغبون. <br><br><h4 style=";text-align:right;direction:rtl">  الخيار الثالث ، الاتصال بالإنترنت </h4><br>  كل ما وصفناه وظيفي للغاية.  ولكن ماذا عن التباهي؟  بعد كل شيء ، سوف يضحك أي مفرقع محب للقراصنة على شخص يقوم بلف القلم والضغط على زر ، ولا يتحكم فيه من هاتف ذكي!  تحريف المقبض "غير عصري".  لكن لتزحف بإصبعك على الهاتف الذكي ، ومحو هذه الإصبع في الدم - ها هي ذروة رغبات محطم القراصنة (لا يمكنني التمييز بينها جميعًا - لذلك إذا ارتكبت خطأً ، فأنا آسف). <br><br>  لكننا سوف نتنازل لهؤلاء الأفراد.  إدارة الإنترنت لها مزايا حقيقية.  أولاً وقبل كل شيء ، إنه مرئي.  هناك الكثير من التطبيقات لجميع المنصات التي تسمح لبضع نقرات بإنشاء لوحة تحكم قابلة للاستخدام بالكامل لوحدة التحكم في Carlson الخاصة بنا.  ثانياً ، إنها فرصة لمراقبة حالة الرطوبة عن بعد في الغرفة.  وثالثا ، يمكنك أن ترى ليس فقط ما تفعله المروحة - الغزل أم لا ، ولكن أيضًا مستوى عتبة الرطوبة المحدد.  وبعد ذلك - تم تشغيل المروحة تلقائيًا أو يدويًا.  بشكل عام ، كل ما تريد. <br><br>  بالطبع ، هناك الكثير من الاهتمام لبعض المعجبين - الكثير من الاهتمام.  لكن هذا مجرد مثال. <br><br>  لذلك ، للاتصال بالإنترنت ، سوف نستخدم تقنية <b>MQTT</b> والبروتوكول الذي يحمل نفس الاسم. <br>  لاستخدام هذه التكنولوجيا ، نحتاج إلى <b>وسيط MQTT</b> .  هذا خادم خاص يخدم <b>عملاء MQTT</b> ، على سبيل المثال ، <b>ShIoTIny وهاتفك</b> الذكي. <br><br>  إن جوهر تقنية <b>MQTT</b> هو أن ينشر أي عميل بيانات عشوائية تحت اسم معين (يسمى <b>الموضوع</b> في مصطلحات <b>MQTT</b> ) على وسيط MQTT (خادم).  يمكن للعملاء الآخرين الاشتراك في بيانات عشوائية حسب اسمهم ( <b>الموضوع</b> ) واستلام البيانات المنشورة حديثًا.  وهذا هو ، تبادل البيانات بأكمله على مبدأ العميل وسيط العميل. <br><br>  <i><b>لن</b></i> أركز على التفاصيل.  هناك العديد من المقالات والبرامج التعليمية على الإنترنت حول كيفية عمل <b>MQTT</b> ونوع البرامج الموجودة لإنشاء لوحات التحكم.  سأريك فقط كيفية تلقي البيانات ونشرها باستخدام <b>ShIoTiny</b> . <br><br>  بصفتي وسيطًا ، استخدمت <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">www.cloudmqtt.com</a> ، لكن المبدأ هو نفسه في كل مكان. <br><br>  لذلك ، سوف نفترض أنك قمت بالتسجيل لدى <b>وسيط MQTT</b> .  بشكل عام ، سيمنحك الوسيط (أو يطلب اختراع) اسم مستخدم وكلمة مرور (للترخيص) ، بالإضافة إلى منفذ للاتصال.  <b>هناك</b> طريقتان لتوصيل <b>ShIoTiny بسمسار</b> <b>MQTT</b> - اتصال منتظم و <b>TLS</b> ( <b>SSL</b> ). <br><br>  يتم إدخال جميع هذه المعلمات في <b>ShIoTiny</b> في علامة التبويب " <b>الشبكة"</b> ، قسم <b>MQTT Connection to server</b> . <br><br><img src="https://habrastorage.org/webt/97/6j/kb/976jkbemm294uso3-pjdcb4wx_4.png"><br><br>  إذا كان <b>وسيط MQTT</b> لا يحتاج إلى إذن ، فلا تدخل اسم المستخدم وكلمة المرور (اترك هذه الحقول فارغة). <br><br>  تتطلب المعلمة <b>بادئة موضوع MQTT</b> شرحاً منفصلاً. <br><br>  بادئة معلمات MQTT عبارة عن سطر يضاف إلى عنوان الموضوع عند النشر والاشتراك في وسيط MQTT.  لتعيين <b>بادئة MQTT</b> لوحدة التحكم الخاصة بك ، تحتاج فقط إلى إدخالها في حقل الإدخال " <b>بادئة موضوع MQTT</b> " (" <b>بادئة موضوع MQTT</b> ").  البادئة تبدأ دائمًا بشرطة مائلة ( <b>"/"</b> )!  إذا لم تقم بإدخال شرطة مائلة في حقل الإدخال ، فستتم إضافته تلقائيًا.  لا يمكن استخدام الأحرف <b>"#"</b> و <b>"+"</b> في البادئة.  لا توجد قيود أخرى. <br><br>  على سبيل المثال ، إذا نشرت المعلمة " <b>الحالة</b> " (أو اشتركت فيها) ، وتم تعيين البادئة على " <b>/ shiotiny /</b> " ، فسيتم نشر هذه المعلمة على الوسيط تحت اسم " <b>/ shiotiny / status</b> ".  إذا كان لديك مجموعة بادئة فارغة ، فستبدأ جميع المعلمات على الوسيط بشرطة مائلة ( <b>"/"</b> ): سيتم نشر " <b>الحالة</b> " كـ " <b>/ الحالة</b> ". <br><br>  لذلك ، نعتقد أنك قمت بالتسجيل لدى <b>وسيط MQTT</b> وتلقيت معلومات تسجيل الدخول وكلمة المرور والمنفذ.  ثم قمت بتعيين هذه المعلمات في علامة تبويب " <b>الشبكة"</b> ، قسم <b>MQTT Connection بملقم</b> وحدة تحكم <b>ShIoTiny</b> . <br><br>  نعتقد أن البادئة مضبوطة على " <b>/ room /</b> ". <br><br>  بادئ ذي بدء ، سنقوم بنشر حالة جميع المعلمات الرئيسية: <b>Realay1</b> relay ، دليل على الحالة ، تلقائي على الحالة ، وأخيراً ، مستويات الرطوبة الحالية والعتبة.  حسنا ومكافأة - درجة الحرارة في الغرفة.  كيفية القيام بذلك ، انظر الشكل. <br><br><img src="https://habrastorage.org/webt/tq/xj/la/tqxjla44g3klhb_apkinf7yudka.png"><br><br>  كما ترون ، فإن الفرق عن الإصدار السابق هو فقط عقد <b>نشر MQTT</b> .  بالنظر إلى البادئة ، يتم نشر المعلمات التالية: <br><img src="https://habrastorage.org/webt/hr/9c/wd/hr9cwdccjlb3tnpkgm2g7grdyhe.jpeg"><br><br>  كما ترون ، فإن حالة النظام بالكامل في مرأى ومسمع! <br><br>  لكننا نريد أن نرى ليس فقط ، ولكن أيضا السيطرة.  كيف تكون  بسيط جدا  سوف نرفض تعيين مستوى الرطوبة العتبة باستخدام <b>ADC</b> ومقاوم متغير وسنقوم بتعيين مستوى الرطوبة هذا من خلال <b>MQTT</b> مباشرة من الهاتف الذكي! <br><br><img src="https://habrastorage.org/webt/dr/e3/yw/dre3ywd0uyw_cjtw8tnzr-doicq.png"><br><br>  نقوم بإزالة عقدة ADC من الدائرة وتشمل ثلاث عقد جديدة هناك: <b>متجر</b> <b>FLASH واستعادة FLASH</b> <b>ووصف MQTT</b> . <br><br>  إن وظيفة <b>وصف</b> العقدة <b>MQTT</b> واضحة: فهي تستقبل <b>المعلمة / room / trigHset</b> (مستوى رطوبة العتبة) من <b>وسيط MQTT</b> .  لكن ماذا يفعل بالبيانات التالية؟  إنها ببساطة تمنحهم عقدة عقدة <b>FLASH</b> ، والتي بدورها تخزن هذه البيانات في ذاكرة غير متقلبة تحت اسم <b>trigH</b> .  بعد ذلك ، تقوم عقدة <b>استعادة FLASH</b> بقراءة البيانات الموجودة تحت الاسم <b>trigH</b> من الذاكرة غير المتطايرة ، ونعلم بالفعل ما سيحدث بعد ذلك. <br><br>  لماذا هذه الصعوبات؟  لماذا لا يمكنني على الفور إرسال البيانات المستلمة إلى إدخال المقارنة؟ <br><br>  كما اعتاد الرفيق س. هولمز أن يقول ، <i>هذا أمر أساسي</i> !  لا أحد يضمن أنه بعد تشغيل جهازك ، سينضم إلى <b>وسيط MQTT</b> .  والرطوبة يجب أن تقاس.  ويجب تشغيل المروحة.  ولكن بدون معلومات عن مستوى الرطوبة العتبة ، هذا مستحيل!  لذلك ، عند تشغيله ، يستخرج الجهاز مستوى رطوبة عتبة مخزّن مسبقًا من ذاكرة غير متطايرة ويستخدمه لاتخاذ القرارات.  وعندما يتم تأسيس الاتصال مع <b>وسيط MQTT</b> ويقوم شخص ما بنشر قيمة جديدة <b>/ غرفة / trigHset</b> ، سيتم استخدام هذه القيمة الجديدة. <br><br>  ثم يمكنك اختراع أي شيء تريده.  على سبيل المثال ، بالإضافة إلى الرطوبة ، أدخل أيضًا سجل درجة الحرارة.  أو أضف عنصر تحكم "ذكي" في الإضاءة (ما زلنا نترك مرحلتين غير مستخدمين ومدخلين)  كل شيء في يديك! <br><br><h4 style=";text-align:right;direction:rtl">  استنتاج </h4><br>  لذلك نظرنا إلى عدة أمثلة على تطبيق أبسط وحدة تحكم في الجوهر استنادًا إلى ShIoTiny.  ربما سيكون من المفيد لشخص ما. <br><br>  كما هو الحال دائمًا ، الاقتراحات ، والرغبات ، والأسئلة ، والأخطاء المطبعية ، وما إلى ذلك ، عن طريق البريد الإلكتروني: <b>shiotiny@yandex.ru</b> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar464485/">https://habr.com/ru/post/ar464485/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar464465/index.html">كيف ولماذا هاجرنا Preply إلى Kubernetes</a></li>
<li><a href="../ar464467/index.html">تعلم تحليلات الويب من نقطة الصفر. اختيار كبير</a></li>
<li><a href="../ar464471/index.html">snmp رصد الطابعة في المتأنق</a></li>
<li><a href="../ar464479/index.html">"بيان من المبرمجين المبتدئين من التخصصات ذات الصلة" أو كيف جئت إلى مثل هذه الحياة</a></li>
<li><a href="../ar464481/index.html">كيف بنينا نظام التدريب والتحفيز في الاستوديو</a></li>
<li><a href="../ar464487/index.html">نحن نبني واجهة لإدخال الوثائق من خلال الاختيار</a></li>
<li><a href="../ar464489/index.html">Buildbot في الأمثلة</a></li>
<li><a href="../ar464491/index.html">فيفالدي 2.7 - حياة مكثفة في صمت</a></li>
<li><a href="../ar464495/index.html">تطوير فريق والتفكير والاتصال الإداري لقائد الفريق</a></li>
<li><a href="../ar464497/index.html">جيرا كعلاج للأرق والانهيارات العصبية</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>