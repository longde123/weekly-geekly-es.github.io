<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>💠 🛅 🤹🏾 التعلم العميق لتحديد اللوحات 🍮 🚅 👩‍💻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="مرحبا يا هبر! أريد اليوم أن أتحدث عن كيف يساعدنا التعلم العميق على فهم الفن بشكل أفضل. تنقسم المقالة إلى أجزاء وفقًا للمهام التي قمنا بحلها: 


1. الب...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>التعلم العميق لتحديد اللوحات</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/singularis/blog/421187/" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl">  مرحبا يا هبر!  أريد اليوم أن أتحدث عن كيف يساعدنا التعلم العميق على فهم الفن بشكل أفضل.  تنقسم المقالة إلى أجزاء وفقًا للمهام التي قمنا بحلها: </p><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  البحث عن صورة في قاعدة البيانات من صورة تم التقاطها بواسطة هاتف محمول ؛ </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">تحديد نمط ونوع الصورة غير الموجودة في قاعدة البيانات.</a> </li></ol><br><p style=";text-align:right;direction:rtl">  كل هذا أصبح جزءًا من <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">خدمة قواعد البيانات Arthive</a> وتطبيقاتها المحمولة. </p><br><p style=";text-align:right;direction:rtl">  كانت مهمة تحديد اللوحات هي العثور على الصورة المقابلة من الصورة القادمة من تطبيق الهاتف المحمول في قاعدة البيانات ، وإنفاق أقل من ثانية واحدة على ذلك.  تم استبعاد المعالجة بالكامل في الجهاز المحمول في مرحلة الدراسة السابقة للتصميم.  بالإضافة إلى ذلك ، اتضح أنه <s>من المستحيل</s> إجراء أداء مضمون على جهاز محمول لفصل الصورة عن الخلفية في ظروف التصوير الحقيقية.  لذلك ، قررنا أن خدمتنا ستقبل الصورة الكاملة من الهاتف المحمول كمدخل ، مع كل التشوهات والضوضاء والتداخل الجزئي المحتمل. </p><br><img src="https://habrastorage.org/webt/cn/if/2y/cnif2ycyblx3ytn1e66pngunngq.jpeg"><br><p style=";text-align:right;direction:rtl">  هل سنساعد داشا في العثور على هذه اللوحات في قاعدة بيانات تضم أكثر من 200000 صورة؟ </p><a name="habracut"></a><br><p style=";text-align:right;direction:rtl">  تتضمن <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">قاعدة</a> الفن <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Arthive</a> ما يقرب من 250،000 صورة ، جنبًا إلى جنب مع البيانات الوصفية المختلفة.  يتم تحديث القاعدة باستمرار - من عشرات إلى مئات الصور يوميًا.  حتى عند ضخها بدقة محدودة (لا تزيد عن 1400 بكسل في معظم الجوانب) ، تشغل الصور أكثر من 80 غيغابايت.  لسوء الحظ ، فإن قاعدة البيانات "قذرة": هناك ملفات مكسورة أو صغيرة جدًا ، صور غير منحازة وغير معالجة ، صور مكررة.  ومع ذلك ، بشكل عام هذه بيانات جيدة. </p><br><h2 style=";text-align:right;direction:rtl">  مقارنة اللوحات </h2><br><p style=";text-align:right;direction:rtl">  دعونا نرى كيف تبدو الصور في قاعدة البيانات: <br></p><table style=";text-align:right;direction:rtl"><tbody><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><img src="https://habrastorage.org/webt/sz/1q/rz/sz1qrz48kric62h7miqopl9lj1u.jpeg"><br></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">مارك روثكو</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><br></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">البرتقالي والأحمر والأصفر</a> <br></td><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><img src="https://habrastorage.org/webt/2s/2j/fi/2s2jfinlqycohujkfvv9khkcv2q.jpeg"><br></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ايليا ريبين</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><br></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">نون</a> <br></td><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><img src="https://habrastorage.org/webt/9l/ri/v0/9lriv0ga3emv589y3yrsbkxzwji.jpeg"><br></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ديفيد بورليوك</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><br></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">نساء من المناطق الاستوائية</a> <br></td></tr></tbody></table><br><p style=";text-align:right;direction:rtl">  في الأساس ، تتم محاذاة الصور في قاعدة البيانات ، ويتم اقتصاصها إلى حدود اللوحة ، ويتم الحفاظ على الألوان. </p><br><p style=";text-align:right;direction:rtl">  وإليك ما قد تبدو عليه الطلبات من الأجهزة المحمولة: </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/1p/iv/ej/1pivejjuiwsrqmhrh1yjonxeu-c.jpeg"></p><br><p style=";text-align:right;direction:rtl">  الألوان مشوهة دائمًا تقريبًا - تم العثور على إضاءة معقدة ، وهج موجود ، حتى تم العثور على انعكاسات لوحات أخرى في الزجاج.  الصور نفسها مشوهة من المنظور ، يمكن اقتصاصها جزئيًا ، أو على العكس ، تحتل أقل من نصف الصورة ، يمكن إغلاقها جزئيًا ، على سبيل المثال ، من قبل الناس. </p><br><p style=";text-align:right;direction:rtl">  لتحديد الصور ، يجب أن تكون قادرًا على مقارنة الصور من الاستعلامات بالصور في قاعدة البيانات. </p><br><p style=";text-align:right;direction:rtl">  لمقارنة الصور المعرضة لتشويه المنظور وتشويه الألوان ، نستخدم مطابقة النقاط الرئيسية.  للقيام بذلك ، نجد نقاطًا رئيسية مع واصفات على الصور ، ونعثر على مراسلاتها ، ثم نعرض النقاط المقابلة باستخدام طريقة RANSAC.  يتم ذلك بشكل عام بنفس الطريقة الموضحة في مثال <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">OpenCV</a> .  إذا كان عدد النقاط "المتتالية" التي عثرت عليها RANSAC كبيرًا بما فيه الكفاية ، والتحول الهوموغرافي الذي تم العثور عليه يبدو معقولًا (ليس لديه تحجيم أو دوران قوي) ، عندئذ يمكننا أن نفترض أن الصور المطلوبة هي واحدة ونفس الصورة تخضع لتشوهات المنظور . </p><br><p style=";text-align:right;direction:rtl">  مثال على تعيين النقاط الرئيسية: </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/jg/vq/df/jgvqdfnkcmhe9-ohvbubeyajiua.jpeg"></p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">مثال المطابقة السلبية</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/q_/8b/yz/q_8byzpsh8rizjhgsol2z1nye4g.jpeg"></div></div><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">مقارنة اللوحات من المثال أعلاه</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/df/qb/ff/dfqbffq4ibpvjz1qh4_xhjhejvm.jpeg"><br><img src="https://habrastorage.org/webt/l4/b9/5a/l4b95adleete923jqu8leqc_gr4.jpeg"><br><img src="https://habrastorage.org/webt/sw/zc/os/swzcosr49hcjkuqc98lux5cwces.jpeg"><br><img src="https://habrastorage.org/webt/cn/hi/rr/cnhirrksz5srhe81bc3i0mc1exc.jpeg"><br><img src="https://habrastorage.org/webt/4r/y5/uf/4ry5ufekvsefkbba9allszpesro.jpeg"><br><img src="https://habrastorage.org/webt/70/oj/jy/70ojjy-ovr6eouymbnx7h0jel9i.jpeg"></div></div><br><p style=";text-align:right;direction:rtl">  بالطبع ، عادةً ما يكون البحث عن النقاط الرئيسية عملية بطيئة إلى حد ما ، ولكن للبحث في قاعدة البيانات ، يمكنك العثور على النقاط الرئيسية لجميع الصور مقدمًا وحفظ بعضها.  في تجاربنا ، توصلنا إلى استنتاج مفاده أن أقل من 1000 نقطة كافية للبحث الموثوق عن اللوحات.  عند استخدام 64 بايت لكل نقطة (الإحداثيات + واصف AKAZE) لتخزين 1024 نقطة ، يكفي 64 كيلوبايت لكل صورة أو حوالي 15 جيجابايت لكل قاعدة. </p><br><p style=";text-align:right;direction:rtl">  استغرق مقارنة الصور بالنقاط الرئيسية في حالتنا حوالي 15 مللي ثانية ، أي للحصول على تعداد كامل لقاعدة بيانات تحتوي على 250000 صورة ، يستغرق حوالي ساعة واحدة.  هذا كثير. </p><br><p style=";text-align:right;direction:rtl">  من ناحية أخرى ، إذا تعلمنا أن نختار بسرعة من قاعدة البيانات بأكملها عدة (على سبيل المثال ، 100) من المرشحين الأكثر احتمالاً ، فسوف نفي بالوقت المستهدف وهو ثانية واحدة لكل طلب. </p><br><h2 style=";text-align:right;direction:rtl">  ترتيب التشابه </h2><br><p style=";text-align:right;direction:rtl">  أثبتت شبكات الالتفاف العميقة نفسها كوسيلة جيدة للبحث عن صور مماثلة.  يتم استخدام الشبكة لاستخراج الميزات وحساب واصف يحتوي على أساسه على أن المسافة (إقليدية ، جيب التمام أو غيرها) بين واصفات الصور المماثلة ستكون أقل من الصور المختلفة. </p><br><p style=";text-align:right;direction:rtl">  يمكنك تدريب الشبكة بطريقة تجعل صورة الصورة من القاعدة وصورتها المشوهة من الصورة تنتج واصفات قريبة ، ولصور مختلفة - صور أكثر بعدًا.  علاوة على ذلك ، يتم استخدام هذه الشبكة لحساب واصفات جميع الصور في قاعدة البيانات واصفات الصور في الطلبات.  يمكنك تحديد أقرب الصور بسرعة وترتيبها وفقًا للمسافة بين الواصفات. <br></p><p style=";text-align:right;direction:rtl">  الطريقة الأساسية لتدريب شبكة لحساب واصف هي استخدام شبكة سيامية. </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/eh/1l/xi/eh1lxi3gh88kjrqucs6kc2a4lpq.png"><br><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x60C;</mo></mrow><mi>b</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.843ex" height="2.298ex" viewBox="0 -780.1 1224 989.6" role="img" focusable="false" style="vertical-align: -0.487ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhip_2Ta4Bx0-ZGnWKnr6Z6-2CEhXQ#MJMATHI-61" x="0" y="0"></use><g transform="translate(529,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">،</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhip_2Ta4Bx0-ZGnWKnr6Z6-2CEhXQ#MJMATHI-62" x="794" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo>،</mo></mrow><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-1"> a، b </script>  - إدخال الصور <br><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi><mo>=</mo><mn>1</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.416ex" height="2.298ex" viewBox="0 -728.2 2332.1 989.6" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhip_2Ta4Bx0-ZGnWKnr6Z6-2CEhXQ#MJMATHI-79" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhip_2Ta4Bx0-ZGnWKnr6Z6-2CEhXQ#MJMAIN-3D" x="775" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhip_2Ta4Bx0-ZGnWKnr6Z6-2CEhXQ#MJMAIN-31" x="1831" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi><mo>=</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-2"> y = 1 </script>  إذا <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.23ex" height="1.455ex" viewBox="0 -520.7 529.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhip_2Ta4Bx0-ZGnWKnr6Z6-2CEhXQ#MJMATHI-61" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-3"> a </script>  و <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>b</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.998ex" height="2.057ex" viewBox="0 -780.1 429.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhip_2Ta4Bx0-ZGnWKnr6Z6-2CEhXQ#MJMATHI-62" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-4"> b </script>  - فصل واحد <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>0</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.162ex" height="1.937ex" viewBox="0 -728.2 500.5 834" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhip_2Ta4Bx0-ZGnWKnr6Z6-2CEhXQ#MJMAIN-30" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-5"> 0 </script>  إذا كانت مختلفة <br><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x60C;</mo></mrow><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>b</mi><mo stretchy=&quot;false&quot;>)</mo><mi>D</mi><mtext>&amp;#xA0;</mtext><mi>i</mi><mi>n</mi><msup><mi>R</mi><mi>d</mi></msup></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="16.577ex" height="2.901ex" viewBox="0 -935.7 7137.2 1249" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhip_2Ta4Bx0-ZGnWKnr6Z6-2CEhXQ#MJMATHI-66" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhip_2Ta4Bx0-ZGnWKnr6Z6-2CEhXQ#MJMAIN-28" x="550" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhip_2Ta4Bx0-ZGnWKnr6Z6-2CEhXQ#MJMATHI-61" x="940" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhip_2Ta4Bx0-ZGnWKnr6Z6-2CEhXQ#MJMAIN-29" x="1469" y="0"></use><g transform="translate(1859,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">،</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhip_2Ta4Bx0-ZGnWKnr6Z6-2CEhXQ#MJMATHI-66" x="2124" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhip_2Ta4Bx0-ZGnWKnr6Z6-2CEhXQ#MJMAIN-28" x="2674" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhip_2Ta4Bx0-ZGnWKnr6Z6-2CEhXQ#MJMATHI-62" x="3064" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhip_2Ta4Bx0-ZGnWKnr6Z6-2CEhXQ#MJMAIN-29" x="3493" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhip_2Ta4Bx0-ZGnWKnr6Z6-2CEhXQ#MJMATHI-44" x="3883" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhip_2Ta4Bx0-ZGnWKnr6Z6-2CEhXQ#MJMATHI-69" x="4961" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhip_2Ta4Bx0-ZGnWKnr6Z6-2CEhXQ#MJMATHI-6E" x="5307" y="0"></use><g transform="translate(5907,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhip_2Ta4Bx0-ZGnWKnr6Z6-2CEhXQ#MJMATHI-52" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhip_2Ta4Bx0-ZGnWKnr6Z6-2CEhXQ#MJMATHI-64" x="1074" y="513"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mi>a</mi><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo>،</mo></mrow><mi>f</mi><mo stretchy="false">(</mo><mi>b</mi><mo stretchy="false">)</mo><mi>D</mi><mtext>&nbsp;</mtext><mi>i</mi><mi>n</mi><msup><mi>R</mi><mi>d</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-6"> f (a)، f (b) D \ in R ^ d </script>  - واصفات الصور <br><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>d</mi><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x60C;</mo></mrow><mi>b</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>d</mi><mo stretchy=&quot;false&quot;>(</mo><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x60C;</mo></mrow><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>b</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="21.01ex" height="2.66ex" viewBox="0 -832 9046.1 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhip_2Ta4Bx0-ZGnWKnr6Z6-2CEhXQ#MJMATHI-64" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhip_2Ta4Bx0-ZGnWKnr6Z6-2CEhXQ#MJMAIN-28" x="523" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhip_2Ta4Bx0-ZGnWKnr6Z6-2CEhXQ#MJMATHI-61" x="913" y="0"></use><g transform="translate(1442,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">،</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhip_2Ta4Bx0-ZGnWKnr6Z6-2CEhXQ#MJMATHI-62" x="1707" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhip_2Ta4Bx0-ZGnWKnr6Z6-2CEhXQ#MJMAIN-29" x="2137" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhip_2Ta4Bx0-ZGnWKnr6Z6-2CEhXQ#MJMAIN-3D" x="2804" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhip_2Ta4Bx0-ZGnWKnr6Z6-2CEhXQ#MJMATHI-64" x="3860" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhip_2Ta4Bx0-ZGnWKnr6Z6-2CEhXQ#MJMAIN-28" x="4384" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhip_2Ta4Bx0-ZGnWKnr6Z6-2CEhXQ#MJMATHI-66" x="4773" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhip_2Ta4Bx0-ZGnWKnr6Z6-2CEhXQ#MJMAIN-28" x="5324" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhip_2Ta4Bx0-ZGnWKnr6Z6-2CEhXQ#MJMATHI-61" x="5713" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhip_2Ta4Bx0-ZGnWKnr6Z6-2CEhXQ#MJMAIN-29" x="6243" y="0"></use><g transform="translate(6632,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">،</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhip_2Ta4Bx0-ZGnWKnr6Z6-2CEhXQ#MJMATHI-66" x="6897" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhip_2Ta4Bx0-ZGnWKnr6Z6-2CEhXQ#MJMAIN-28" x="7448" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhip_2Ta4Bx0-ZGnWKnr6Z6-2CEhXQ#MJMATHI-62" x="7837" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhip_2Ta4Bx0-ZGnWKnr6Z6-2CEhXQ#MJMAIN-29" x="8267" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhip_2Ta4Bx0-ZGnWKnr6Z6-2CEhXQ#MJMAIN-29" x="8656" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><mo stretchy="false">(</mo><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo>،</mo></mrow><mi>b</mi><mo stretchy="false">)</mo><mo>=</mo><mi>d</mi><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">(</mo><mi>a</mi><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo>،</mo></mrow><mi>f</mi><mo stretchy="false">(</mo><mi>b</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-7"> d (a، b) = d (f (a)، f (b)) </script>  - المسافة بين زوج من المتجهات المميزة <br><math></math><img src="https://habrastorage.org/getpro/habr/formulas/63b/8f4/f84/63b8f4f84776027fa9aa4310cd0736a5.svg" alt="خسارة $ = y \ cdot d (a، b) + (1 - y) \ cdot max (0، margin - d (a، b)) $" data-tex="inline">  - الوظيفة الموضوعية </p><br><p style=";text-align:right;direction:rtl">  لبناء مثل هذه البنية ، يتم استخدام شبكة تحسب واصفًا (مستخرج الميزة) في النموذج مرتين مع الأوزان الشائعة.  يتم تغذية صورتين لإدخال الشبكة.  تقوم شبكة ميزة استخلاص الميزات بحساب واصفات الصور ، ثم تقوم الشبكة بحساب المسافة وفقًا للمقياس المحدد (عادةً ما يتم استخدام مسافة إقليدية أو جيب التمام).  يتم إنشاء الوظيفة المستهدفة للتدريب على الشبكة بطريقة تؤدي إلى تقليل المسافة بالنسبة للأزواج الإيجابية (صور صورة واحدة) ، وتزداد المسافة السلبية (صور الصور المختلفة).  لتقليل تأثير الأزواج السالبة ، يتم تحديد المسافة بينهما بقيمة الهامش. </p><br><p style=";text-align:right;direction:rtl">  وهكذا ، يمكننا أن نقول أنه في عملية التعلم ، تسعى الشبكة إلى حساب واصفات صور مماثلة داخل نطاق فائق مع نصف قطر الهامش ، واصفات مختلفة - للدفع خارج هذا المجال. </p><br><p style=";text-align:right;direction:rtl">  على سبيل المثال ، قد يبدو هذا وكأنه تدريب واصف ثنائي الأبعاد باستخدام شبكة سيامي على مجموعة بيانات MNIST. </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/vs/5y/7n/vs5y7nggt4cvqls3ohka9v8qmqi.jpeg"></p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">الرسوم المتحركة للتدريب</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/hl/-u/fv/hl-ufvknsfliuuxpfvaqrynkusm.gif"></div></div><br><p style=";text-align:right;direction:rtl">  لتدريب شبكة سيامي ، تحتاج إلى إدخال أزواج من الصور وتسمية تساوي 1 إذا كانت الصور تنتمي إلى نفس الفئة ، أو 0 إذا كانت مختلفة.  هناك مشكلة في اختيار نسبة الأزواج الإيجابية والسلبية.  من الناحية المثالية ، بطبيعة الحال ، سيكون من الضروري أن تقدم إلى الشبكة تدريب جميع المجموعات الممكنة من أزواج من مجموعة التدريب ، ولكن هذا مستحيل من الناحية التقنية.  وعدد الأزواج السلبية في هذه الحالة يتجاوز بشكل كبير عدد الأزواج الإيجابية ، والتي لن يكون لها أيضًا تأثير جيد جدًا على عملية التعلم. </p><br><p style=";text-align:right;direction:rtl">  يتم حل جزء من مشكلة اختيار نسبة الأزواج للتدريب باستخدام بنية ثلاثية. </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/u4/a5/yz/u4a5yzgvxnum6zlvbugpj9japvm.png"><br><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x60C;</mo></mrow><mi>p</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x60C;</mo></mrow><mi>n</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.025ex" height="2.419ex" viewBox="0 -780.1 2163.6 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhip_2Ta4Bx0-ZGnWKnr6Z6-2CEhXQ#MJMATHI-61" x="0" y="0"></use><g transform="translate(529,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">،</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhip_2Ta4Bx0-ZGnWKnr6Z6-2CEhXQ#MJMATHI-70" x="794" y="0"></use><g transform="translate(1298,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">،</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhip_2Ta4Bx0-ZGnWKnr6Z6-2CEhXQ#MJMATHI-6E" x="1563" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo>،</mo></mrow><mi>p</mi><mrow class="MJX-TeXAtom-ORD"><mo>،</mo></mrow><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-8"> a، p، n </script>  - صور الإدخال: <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x60C;</mo></mrow><mi>p</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.015ex" height="2.419ex" viewBox="0 -780.1 1298 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhip_2Ta4Bx0-ZGnWKnr6Z6-2CEhXQ#MJMATHI-61" x="0" y="0"></use><g transform="translate(529,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">،</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhip_2Ta4Bx0-ZGnWKnr6Z6-2CEhXQ#MJMATHI-70" x="794" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo>،</mo></mrow><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-9"> a، p </script>  - صورة واحدة ، <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>n</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.395ex" height="1.455ex" viewBox="0 -520.7 600.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhip_2Ta4Bx0-ZGnWKnr6Z6-2CEhXQ#MJMATHI-6E" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-10"> n </script>  - آخر <br><math></math><img src="https://habrastorage.org/getpro/habr/formulas/f13/7e8/9db/f137e89db08c3e76370b39a8e29407d8.svg" alt="خسارة $ = الحد الأقصى (d (a، p) - d (a، n) + margin، 0) $" data-tex="inline">  - الوظيفة الموضوعية </p><br><p style=";text-align:right;direction:rtl">  عند إدخال مثل هذه الشبكة ، يتم تشكيل 3 صور على الفور ، لتشكيل زوج إيجابي وسالب. </p><p style=";text-align:right;direction:rtl"></p><p style=";text-align:right;direction:rtl">  بالإضافة إلى ذلك ، يتفق جميع الباحثين تقريبًا على أن اختيار الأزواج السلبية أمر بالغ الأهمية للتعلم عبر الشبكة.  وتبين أن الوظيفة الموضوعية للعديد من العينات (أزواج سيامي وثلاثية ثلاثية) هي 0 إذا لم تنتهك حد الهامش ، وبالتالي فإن هذه العينات لا تشارك في تدريب الشبكة.  بمرور الوقت ، تتباطأ عملية التعلم أكثر ، نظرًا لوجود عينات أقل وأقل مع قيمة غير صفرية للوظيفة الهدف.  لحل هذه المشكلة ، يتم اختيار الأزواج السلبية ليس عن طريق الصدفة ، ولكن عن طريق البحث عن التعدين في الحالات الصعبة.  من الناحية العملية ، يتم اختيار العديد من المرشحين السلبيين لهذا ، ويتم حساب كل واصف باستخدام أحدث إصدار من أوزان الشبكة (من عصر سابق أو حتى من العصر الحالي).  إذا كان لديك واصف ، يمكنك تحديد سلبي في كل ثلاثة مثل هذه ينتج عنها خسارة غير صفرية معروفة. </p><br><p style=";text-align:right;direction:rtl">  للبحث عن صور مشابهة ، يتم فصل ميزة Extractor عن الشبكة وتستخدم لحساب الواصفات.  للصور في قاعدة البيانات ، يتم حساب الواصفات مقدمًا عند إضافتها.  وبالتالي ، فإن مهمة العثور على صور مماثلة هي حساب واصف الصورة في الاستعلام والبحث عن الواصفات الأقرب إلى المقياس المحدد في قاعدة البيانات. </p><br><p style=";text-align:right;direction:rtl">  يعتمد مستخرج ميزات الشبكة على بنية Inception v3.  تم اختيار إحدى الطبقات المتوسطة تجريبياً ، بناءً على الناتج الذي تم حسابه واصفًا من 512 رقم حقيقي. </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/0q/w2/mz/0qw2mzgdztu_zyr9fxxsijznzrw.png"></p><br><h2 style=";text-align:right;direction:rtl">  زيادة البيانات </h2><br><p style=";text-align:right;direction:rtl">  سيكون من اللطيف لو تمكنا من وضع كل صورة في إطارات مختلفة ، على جدران مختلفة والتقاط صور في كل مرة من زاوية مختلفة على هواتف مختلفة.  عمليًا ، هذا مستحيل بالطبع.  لذلك ، من الضروري إنشاء بيانات التدريب. </p><br><p style=";text-align:right;direction:rtl">  لتوليد البيانات ، تم جمع حوالي 500 صورة من لوحات مختلفة بخلفيات مختلفة في ظروف إضاءة مختلفة.  لكل صورة ، تم تحديد 4 نقاط تتوافق مع زوايا لوحة الصورة.  لأربع نقاط ، يمكننا احتواء أي صورة بشكل تعسفي في الإطار ، وبالتالي استبدال الصورة والحصول على تشويه منظور عشوائي للصورة من قاعدة البيانات.  استكمالًا لهذه العملية بالمحصول العشوائي والضوضاء وتشويه الألوان ، نحصل على الفرصة لإنشاء صور مناسبة تمامًا تحاكي الصور الفوتوغرافية للوحات. </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/fi/ad/wg/fiadwgwcbv0bqqgbfiphnthicm8.jpeg" alt="فن"></p><br><h2 style=";text-align:right;direction:rtl">  فصل صورة عن الخلفية </h2><br><p style=";text-align:right;direction:rtl">  تعتمد جودة العمل ونماذج تحديد اللوحات والنماذج لتصنيف الأنواع / الأنماط إلى حد كبير على مدى جودة فصل الصورة عن الخلفية.  من الناحية المثالية ، قبل أن تغذي صورة في نموذج ، تحتاج إلى العثور على الزوايا الأربع من قماشها وعرض منظورها في مربع.  من الناحية العملية ، اتضح أنه من الصعب جدًا تنفيذ خوارزمية تضمن ذلك.  من ناحية ، هناك مجموعة متنوعة كبيرة من الخلفيات والإطارات والكائنات التي يمكن أن تقع في الإطار بالقرب من الصورة.  من ناحية أخرى ، هناك لوحات بداخلها خطوط ملحوظة للغاية للأشكال المستطيلة (النوافذ ، واجهات المباني ، صورة داخل صورة).  ونتيجة لذلك ، غالبًا ما يكون من الصعب جدًا تحديد أين تنتهي الصورة وتبدأ بيئتها. </p><br><p style=";text-align:right;direction:rtl">  في النهاية ، استقرنا على تنفيذ بسيط يعتمد على الأساليب الكلاسيكية للرؤية الحاسوبية (الكشف عن الحدود + التصفية المورفولوجية + تحليل المكونات المتصلة) ، مما يسمح لك بقطع الخلفيات أحادية الصوت بثقة ، ولكن لا تفقد بعض الصورة. </p><br><h2 style=";text-align:right;direction:rtl">  سرعة العمل </h2><br><p style=";text-align:right;direction:rtl">  تتكون خوارزمية معالجة الاستعلام من الخطوات الرئيسية التالية: </p><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  التحضير - في الواقع ، يتم تنفيذ كاشف بسيط للصورة ، يعمل بشكل جيد إذا كانت الصورة تحتوي على خلفية واضحة ؛ </li><li style=";text-align:right;direction:rtl">  حساب واصف الصورة باستخدام شبكة عميقة ؛ </li><li style=";text-align:right;direction:rtl">  ترتيب الصور حسب المسافة إلى الواصفات في قاعدة البيانات ؛ </li><li style=";text-align:right;direction:rtl">  البحث عن النقاط الرئيسية في الصورة ؛ </li><li style=";text-align:right;direction:rtl">  فحص المرشحين بترتيب التصنيف. </li></ol><br><p style=";text-align:right;direction:rtl">  لقد اختبرنا سرعة الشبكة على 200 طلب ، وتم الحصول على وقت المعالجة التالي لكل مرحلة (الوقت بالثواني): <br></p><table style=";text-align:right;direction:rtl"><thead><tr><th>  المرحلة </th><th>  دقيقة </th><th>  ماكس </th><th>  متوسط </th></tr></thead><tbody><tr><td>  التحضير (بحث عن صورة) </td><td>  0.008 </td><td>  0.011 </td><td>  0.016 </td></tr><tr><td>  حساب الواصف (GPU) </td><td>  0.082 </td><td>  0.092 </td><td>  0.088 </td></tr><tr><td>  KNN (k &lt;500 ، وحدة المعالجة المركزية ، القوة الغاشمة) </td><td>  0.199 </td><td>  <strong>0.820</strong> </td><td>  0.394 </td></tr><tr><td>  مفتاح البحث </td><td>  0.031 </td><td>  0.432 </td><td>  0.156 </td></tr><tr><td>  تحقق من النقاط الرئيسية </td><td>  0.007 </td><td>  <strong>9.844</strong> </td><td>  2.585 </td></tr><tr><td>  <strong>إجمالي وقت الطلب</strong> </td><td>  0.358 </td><td>  10.386 </td><td>  3.239 </td></tr></tbody></table><br><p style=";text-align:right;direction:rtl">  نظرًا لأن التحقق من المرشحين يتوقف فورًا ، حيث تم العثور على الصورة بثقة كافية ، يمكننا أن نفترض أن الحد الأدنى لوقت معالجة الطلبات يتوافق مع الصور الموجودة بين المرشحين الأوائل.  يتم الحصول على الحد الأقصى لوقت الطلب للوحات التي لم يتم العثور عليها على الإطلاق - يتوقف الشيك بعد 500 مرشح. </p><br><p style=";text-align:right;direction:rtl">  يمكن ملاحظة أن معظم الوقت يقضي في اختيار المرشحين والتحقق منهم.  وتجدر الإشارة إلى أن تنفيذ هذه الخطوات قد جعل من غير الأمثل للغاية ولديه إمكانات كبيرة للتسريع. </p><br><h2 style=";text-align:right;direction:rtl">  بحث مكرر </h2><br><p style=";text-align:right;direction:rtl">  بعد بناء الفهرس الكامل لقاعدة اللوحات ، استخدمناه للبحث عن التكرارات في قاعدة البيانات.  بعد حوالي 3 ساعات من عرض قاعدة البيانات ، تبين أن 13657 صورة على الأقل تتكرر في قاعدة البيانات مرتين (وثلاث صور). </p><br><p style=";text-align:right;direction:rtl">  علاوة على ذلك ، تم العثور على حالات مثيرة للاهتمام للغاية ليست مكررة. </p><br><img src="https://habrastorage.org/webt/hj/nh/kr/hjnhkregrx0th9cdshhzvf79b9y.jpeg"><br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">واحد</a> ، <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">اثنان</a> .  يبدو أن هاتين المرحلتين من نفس العمل. <br><br><img src="https://habrastorage.org/webt/eo/0o/qd/eo0oqdq2yip70qungxv6gttad3k.jpeg"><br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">واحد</a> ، <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">اثنان</a> ، <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ثلاثة</a> .  لا تنتبه للاسم - كل الصور الثلاث مختلفة. <br><br>  بالإضافة إلى مثال على تحديد إيجابي كاذب بالنقاط الرئيسية. <br><br><img src="https://habrastorage.org/webt/5t/gr/cr/5tgrcrmewazx_lqxd_po9cqd5v4.jpeg"><br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">واحد</a> ، <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">اثنان</a> . <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">تعيين النقطة الرئيسية</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/y1/ug/7i/y1ug7idfof7szcvsbmsbr64h7fy.jpeg"></div></div><br><h2 style=";text-align:right;direction:rtl">  بدلا من الاستنتاج </h2><br><p style=";text-align:right;direction:rtl">  بشكل عام ، نحن راضون عن نتيجة الخدمة. </p><br><p style=";text-align:right;direction:rtl">  في مجموعات الاختبار ، تم تحقيق دقة تحديد أكثر من 80٪.  من الناحية العملية ، غالبًا ما يتبين أنه إذا لم يتم العثور على الصورة في المرة الأولى ، فهذا يكفي لتصويرها من زاوية مختلفة ، وهي موجودة.  أخطاء عند العثور على صورة خاطئة ، لا تحدث أبدًا. </p><br><p style=";text-align:right;direction:rtl">  معًا ، تم تغليف الحل في حاوية عامل ميناء وإعطاؤه للعميل.  الآن التعرف على اللوحات بالصور متاح في التطبيقات التي تستخدم خدمة Arthive ، على سبيل المثال ، متحف Pushkin ، المتاح في سوق Play (ومع ذلك ، فإنه يفصل اللوحة عن الخلفية ، مما يتطلب أن تكون الخلفية خفيفة ، مما يجعل التصوير الفوتوغرافي صعبًا في بعض الأحيان). </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar421187/">https://habr.com/ru/post/ar421187/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar421173/index.html">عرض بحث Google المخصص</a></li>
<li><a href="../ar421175/index.html">مراقبة مجموعة Kubernetes باستخدام بروميثيوس</a></li>
<li><a href="../ar421177/index.html">كيفية جذب متخصص تحليل البيانات عندما لا تمتلك شركتك موقعًا على الويب</a></li>
<li><a href="../ar421179/index.html">HashMap الداخلية في جافا</a></li>
<li><a href="../ar421183/index.html">براءات اختراع لشركة آي بي إم تميز العواطف وتجلب القهوة للناس. وماذا عن الكتابة يوم الجمعة؟</a></li>
<li><a href="../ar421189/index.html">ترحيل قاعدة بيانات إلى إصدار أقدم من MS SQL Server</a></li>
<li><a href="../ar421191/index.html">ما مدى سهولة أن يحلم الحرفي بنواة ثلاثية الأبعاد</a></li>
<li><a href="../ar421193/index.html">أودي PB18 e-tron</a></li>
<li><a href="../ar421195/index.html">الذكاء الاصطناعي</a></li>
<li><a href="../ar421197/index.html">في روسيا ، يتم تطوير سماعة عصبية للأشخاص الذين يعانون من إعاقات في الكلام والحركة</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>