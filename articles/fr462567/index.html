<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üôÜüèø üç¶ üöµüèø Sodinokibi Ransomware: une √©tude d√©taill√©e üö£üèø üíî üí≠</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Le ransomware Sodinokibi a √©t√© r√©cemment √©voqu√© dans les actualit√©s, mais peu se plongent dans les d√©tails de ce malware. Aujourd'hui, nous allons ess...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Sodinokibi Ransomware: une √©tude d√©taill√©e</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/acronis/blog/462567/">  Le ransomware Sodinokibi a √©t√© r√©cemment √©voqu√© dans les actualit√©s, mais peu se plongent dans les d√©tails de ce malware.  Aujourd'hui, nous allons essayer de mieux conna√Ætre Sodinokibi, consid√©rer les principes du ransomware pour identifier les vecteurs prioritaires pour prot√©ger les syst√®mes d'information d'une nouvelle menace. <br><br><img src="https://habrastorage.org/webt/ow/o7/r6/owo7r6oqzz6yfcvxv_g0b7dpzs0.png"><br><a name="habracut"></a><br>  Auteurs du texte: Ravikant Tiwari et Alexander Koshelev <br><br><h3>  Que savons-nous de Sodinokibi? </h3><br>  Sodinokibi est tr√®s probablement propag√© par les m√™mes attaquants qui √©taient connus pour les attaques de ransomwares de la famille GandCrab, qui, √† en juger par les rapports sur les forums clandestins, ne se d√©velopperont plus. <br><br>  Sodinokibi utilise la vuln√©rabilit√© Oracle WebLogic (CVE-2019-2725) pour acc√©der √† l'ordinateur de la victime.  Une fois dans le syst√®me, le malware essaie de s'ex√©cuter avec des droits √©tendus afin d'acc√©der √† tous les fichiers et ressources du PC sans restriction ... <br>  Sodinokibi essaie de ne pas infecter les ordinateurs en Iran, en Russie et dans d'autres pays de l'ex-URSS. <br><br>  Le programme de ran√ßongiciel utilise les algorithmes AES et Salsa20 pour crypter les fichiers utilisateur.  AES est utilis√© pour crypter les cl√©s de session, ainsi que les donn√©es envoy√©es au serveur de gestion. <br><br>  Les fichiers utilisateur sont crypt√©s √† l'aide de Salsa20. <br><br>  Pour g√©n√©rer et distribuer des cl√©s, Sodinokibi utilise l'algorithme Diffie-Hellman sur les courbes elliptiques. <br><br>  Une fois sur la machine, le virus supprime instantan√©ment tous les fichiers du dossier de sauvegarde. <br><br>  √Ä l'heure actuelle, le ransomware demande 0,32806964 BTC (‚âà 2 500 $) pour restaurer l'acc√®s aux fichiers crypt√©s.  De plus, si la ran√ßon n'est pas vers√©e dans les 4 jours, les extorqueurs promettent de doubler le montant ... <br><br><h3>  Comment fonctionne Sodinokibi? </h3><br>  Nous avons √©tudi√© une instance de Sodinokibi dans notre laboratoire.  Le ransomware a √©t√© emball√© par un packer personnalis√©.  Dans le m√™me temps, m√™me apr√®s un d√©ballage r√©ussi, il n'y avait pas de lignes lisibles dans le code.  De plus, le logiciel n‚Äôimporte aucune biblioth√®que syst√®me ni API.  Par cons√©quent, les antivirus statiques qui utilisent des signatures bas√©es sur des cha√Ænes lisibles et des tables d'API import√©es auront beaucoup de mal √† le d√©tecter. <br><br>  Les noms d'API et d'autres param√®tres ont √©t√© d√©chiffr√©s pendant que le logiciel s'ex√©cutait √† l'aide de l'algorithme RC4.  Afin de rendre la d√©tection encore plus difficile pour les antivirus, ce ransomware ex√©cute des op√©rations sur les cha√Ænes √† l'aide d'un hachage DJB plut√¥t que sur les cha√Ænes elles-m√™mes ... <br><br><h3>  Initialisation </h3><br>  Sodinokibi commence par cr√©er une table d'importation dynamique.  Tout d'abord, le programme est convaincu qu'il s'agit de la seule copie du syst√®me utilisant la m√©thode de v√©rification mutex.  Apr√®s v√©rification, il d√©chiffre la configuration JSON √† l'aide de RC4, qui est stock√©e dans le fichier programme et v√©rifie la valeur bool√©enne de la cl√© ¬´exp¬ª.  Si sa valeur est ¬´vraie¬ª, Sodinokibi tente de lancer un exploit.  Il en √©tait ainsi dans notre √©chantillon, il a donc rempli la fonction d'exploitation des vuln√©rabilit√©s <br><br><img src="https://habrastorage.org/webt/zg/jl/1-/zgjl1-mazfcbijmbdjy-xzgwffw.png"><br><br><img src="https://habrastorage.org/webt/a3/mf/2d/a3mf2do1b2kblyq6nbu3us-vopi.png"><br>  <i><font color="#999999">Configuration JSON d√©chiffr√©e</font></i> <br><br>  Le code qui ex√©cute les v√©rifications d'exploit pour voir si la mise √† jour du 11 septembre 2018 (KB4457138) a √©t√© install√©e sur l'ordinateur.  Ce correctif corrige de nombreuses vuln√©rabilit√©s ci-dessous.  Et s'il ne se trouve pas sur la machine, Ransomware proc√®de au lancement du shellcode 32 ou 64 bits, selon la plateforme sur laquelle le malware est ex√©cut√©.  Nous pensons que le ransomware essaie d'√©lever les privil√®ges d'un administrateur √† l'aide de CVE-2018-8440. <br><br><img src="https://habrastorage.org/webt/ge/cd/uk/gecduk1m7ga29wiioqmee4k-sjk.png"><br>  <i><font color="#999999">Extrait 1</font></i> <br><br>  La liste des vuln√©rabilit√©s qui corrige KB4457138 corrige: <br><br>  Le correctif KB4457138 corrige les vuln√©rabilit√©s: <br><br><ul><li>  CVE-2018-8457, CVE-2018-8335, CVE-2018-8424, CVE-2018-8455, CVE-2018-8468, CVE-2018-8447, CVE-2018-8475, CVE-2018-8271, CVE- 2018-8440, CVE-2018-8464, CVE-2018-8469, CVE-2018-8421, CVE-2018-8442, CVE-2018-8367, CVE-2018-8443, CVE-2018-8465, CVE-2018- 8419, CVE-2018-8466, CVE-2018-8410, CVE-2018-8467, CVE-2018-8462, CVE-2018-8452, CVE-2018-8446, CVE-2018-8449, CVE-2018-8420, CVE-2018-8433, CVE-2018-8438, CVE-2018-8435, CVE-2018-8456, CVE-2018-8354, CVE-2018-8434, CVE-2018-8470, CVE-2018-8332, CVE- 2018-0965, CVE-2018-8315, CVE-2018-8439, CVE-2018-8392, CVE-2018-8425, CVE-2018-8393. </li></ul><br><br>  Si une vuln√©rabilit√© n'est pas d√©tect√©e dans le syst√®me et que le processus continue de fonctionner en tant qu'utilisateur normal, la commande RUNAS sera utilis√©e pour d√©marrer une autre instance, mais avec des droits administratifs, et celle qui fonctionne actuellement avec des privil√®ges limit√©s sera termin√©e.  Le pseudocode complet est montr√© dans la capture d'√©cran ci-dessous. <br><br><img src="https://habrastorage.org/webt/ge/cd/uk/gecduk1m7ga29wiioqmee4k-sjk.png"><br><br>  Apr√®s que Sodinokibi a d√©marr√© avec succ√®s en mode administrateur, le logiciel effectue une v√©rification pr√©liminaire suppl√©mentaire et clarifie la valeur de la cl√© ¬´bro¬ª dans la configuration JSON et d√©couvre le pays de l'emplacement.  Il n'essaiera pas d'infecter les ordinateurs des pays suivants, si ces param√®tres d'emplacement ont √©t√© d√©finis dans les param√®tres de l'ordinateur. <br><br><img src="https://habrastorage.org/webt/i5/yv/2m/i5yv2m2hqz8lpaztizkchsrek-4.png"><br>  <i><font color="#999999">Affiner les ID de langue</font></i> <br><br>  Liste des pays d'exception <br><br><ul><li>  Roumanie, Russie, Ukraine, Bi√©lorussie, Estonie, Lettonie, Lituanie, Tadjikistan, Iran, Arm√©nie, Azerba√Ødjan, G√©orgie, Kazakhstan, Kirghizistan, Turkm√©nistan, Ouzb√©kistan, Tatarstan </li></ul> <br>  * Note de l'√©diteur: pour une raison inconnue, les auteurs soulignent sp√©cifiquement les param√®tres r√©gionaux tatares en Russie <br><br>  Apr√®s avoir r√©ussi le test, le malware termine le processus mysql.exe (s'il √©tait en cours d'ex√©cution) afin d'acc√©der aux fichiers MySQL et de les crypter.  Apr√®s cela, le ransomware supprime les clich√©s instantan√©s de Windows √† l'aide de vssadmin et d√©sactive √©galement le syst√®me de r√©cup√©ration Windows √† l'aide de bcdedit: <br><br> <code>vssadmin.exe Delete Shadows /All /Quiet &amp; bcedit /set {default} <br> recoveryenabled No &amp; bcedit /set {default} bootstatuspolice ignorealfailures</code> <br> <br>  Avant de crypter les fichiers utilisateur, Sodinokibi recherche tous les syst√®mes de fichiers, y compris les dossiers r√©seau, pour trouver les r√©pertoires portant le nom de ¬´sauvegarde¬ª et les supprime d√©finitivement.  Il est int√©ressant de noter qu'avant de supprimer le r√©pertoire lui-m√™me, le malware remplace d'abord le contenu de tous ces dossiers par un ensemble al√©atoire d'octets pour rendre la r√©cup√©ration impossible en principe.  Heureusement, les fichiers Acronis Backup ne peuvent pas √™tre supprim√©s si facilement, car ils sont prot√©g√©s au niveau du noyau, sp√©cifiquement pour emp√™cher les ransomwares de prendre de telles actions. <br><br><h3>  G√©n√©ration de cl√©s </h3><br>  Sodinokibi utilise le protocole Diffie-Hellman Elliptic Curve Generation and Exchange (ECDH).  Les cl√©s de session g√©n√©r√©es sont utilis√©es dans des algorithmes de chiffrement sym√©triques, et diff√©rents types de donn√©es sont chiffr√©s √† l'aide de diff√©rentes m√©thodes - AES et Salsa20. <br><br>  AES est utilis√© pour crypter une cl√© priv√©e √† partir d'une paire de cl√©s priv√©es et publiques g√©n√©r√©es localement sur la machine utilisateur.  Il crypte √©galement les donn√©es lors de la transmission sur le r√©seau.  Salsa20 est utilis√© pour crypter les fichiers utilisateur. <br><br>  Sodinokibi contient deux cl√©s publiques diff√©rentes, dont l'une fait partie de la configuration JSON et la seconde est int√©gr√©e au binaire.  Ces cl√©s publiques seront utilis√©es pour crypter la cl√© priv√©e cr√©√©e sur la machine.  Les √©tapes sp√©cifiques de la g√©n√©ration et du chiffrement des cl√©s sont les suivantes: <br><br>  <b>√âtape 1.</b> G√©n√©ration d'une paire de sessions √† partir d'une cl√© priv√©e (secr√®te, al√©atoire) et publique sur la machine locale. <br><br><img src="https://habrastorage.org/webt/ss/o7/s_/sso7s_-kmgvl8z8tqqecaufm7va.png"><br>  <i><font color="#999999">G√©n√©ration de cl√©s priv√©es et publiques locales</font></i> <br><br>  Le chiffrement de la cl√© priv√©e de l'√©tape 1 se produit √† l'aide de la cl√© publique de la configuration JSON <br><br>  <b>√âtape 2.</b> G√©n√©rez une autre paire de cl√©s priv√©es et publiques. <br><br>  <b>√âtape 3.</b> En utilisant la cl√© priv√©e de l'√©tape 2 et la cl√© publique (valeur de cl√© pk), une cl√© publique est g√©n√©r√©e √† partir de JSON, et apr√®s le hachage, une cl√© sym√©trique est obtenue. <br><br><img src="https://habrastorage.org/webt/lo/sp/af/lospafrq5cwhv1ucx8rq3cc6nem.png"><br>  <i><font color="#999999">G√©n√©rer une cl√© sym√©trique √† l'aide d'une cl√© partag√©e</font></i> <br><br>  <b>√âtape 4.</b> G√©n√©ration d'un IV 16 bits (vecteur d'initialisation). <br><br>  <b>√âtape 5.</b> Chiffrez la cl√© priv√©e g√©n√©r√©e √† l'√©tape 1 √† l'aide d'AES avec la cl√© et IV, qui ont √©t√© obtenues au cours des √©tapes 3 et 4. <br><br>  <b>√âtape 6.</b> Calcul de CRC32 pour la cl√© priv√©e chiffr√©e, qui s'est av√©r√© √† l'√©tape 5. <br><br>  <b>√âtape 7.</b> Ajout de IV et CRC32 √† la fin du tampon contenant la cl√© priv√©e chiffr√©e de l'√©tape 5. <br><br>  <b>√âtape 8.</b> Sauvegarde du tampon dans le fichier associ√© avec l'offset (marqu√© ¬´sk_key¬ª). <br><br><img src="https://habrastorage.org/webt/au/tu/tp/aututpoxj74jy0shog3h30cms4m.png"><br>  <i><font color="#999999">Chiffrez la cl√© priv√©e de l'√©tape 1 √† l'aide des cl√©s publiques de l'attaquant</font></i> <i><font color="#999999"><br><br></font></i>  <i><font color="#999999">Chiffrez la cl√© priv√©e de l'√©tape 1 √† l'aide de la cl√© publique contenue dans le fichier binaire.</font></i> <br><br>  <b>√âtape 9.</b> R√©p√©tez les √©tapes 2 √† 7 en utilisant une autre cl√© publique qui a √©t√© incorpor√©e dans le fichier binaire √† l'√©tape 3. <br><br>  <b>√âtape 10.</b> Enregistrement du tampon dans un fichier mapp√© avec un d√©calage en m√©moire (marque ¬´0_key¬ª) <br>  sk_key, 0_key et pk_key sont √©crits dans le registre en cons√©quence, en fonction des droits d'acc√®s re√ßus par le programme ... <br><br>  HKLM \ SOFTWARE \ recfg \ sk_key ou HKCU \ SOFTWARE \ recfg \ sk_key <br>  HKLM \ SOFTWARE \ recfg \ 0_key ou HKCU \ SOFTWARE \ recfg \ 0_key <br>  HKLM \ SOFTWARE \ recfg \ pk_key ou HKCU \ SOFTWARE \ recfg \ pk_key <br><br><img src="https://habrastorage.org/webt/ey/la/os/eylaoslusems6caly5ma0gwgez8.png">  <i><font color="#999999">Cl√© secr√®te chiffr√©e dans le registre</font></i> <i><font color="#999999"><br></font></i>  <i><font color="#999999">G√©n√©ration de cl√©s pour des fichiers individuels avec Salsa20</font></i> <br><br>  <b>√âtape 11.</b> G√©n√©rez une nouvelle paire √† partir de la cl√© publique et priv√©e. <br><br>  <b>√âtape 12.</b> G√©n√©rez une cl√© partag√©e en utilisant la cl√© publique de session cr√©√©e √† l'√©tape 2 et hachez pour obtenir la cl√© sym√©trique suivante n√©cessaire pour g√©n√©rer les cl√©s dans Salsa20. <br><br>  <b>√âtape 13.</b> Installation d'une cl√© de 256 bits (32 octets) dans Salsa20 <br><br>  <b>√âtape 14.</b> G√©n√©rez un IV 8 bits pour les cl√©s Salsa20 <br><br>  <b>√âtape 15.</b> G√©n√©ration de cl√©s Salsa20 <br><br>  <b>√âtape 16.</b> Utilisation de Salsa20 key_state pour crypter les fichiers utilisateur avec Salsa20. <br><br><img src="https://habrastorage.org/webt/ej/xs/yq/ejxsyqwuteyfomfybfsrsdyolvc.png"><br>  <i><font color="#999999">G√©n√©ration de cl√©s Salsa20 pour chaque fichier</font></i> <i><font color="#999999"><br></font></i>  <i><font color="#999999">R√©p√©tez les √©tapes 11 √† 16 pour chaque fichier chiffr√©.</font></i> <br><br><h3>  Illustration du chiffrement et du d√©chiffrement </h3><br>  Pour mieux comprendre comment les cl√©s sont g√©n√©r√©es et transmises entre les ordinateurs de l'attaquant et de la victime, vous devez comprendre comment fonctionne l'algorithme Diffie Hellman - cela est facile √† faire par l'illustration. <br><br><h3>  Processus de cryptage </h3><br><img src="https://habrastorage.org/webt/h4/wy/v1/h4wyv1ghwh-gvjedkpk8r5efoa4.png"><br>  <i><font color="#999999">√âchange de cl√©s de courbe elliptique Diffie-Hellman (ECDH)</font></i> <br><br><img src="https://habrastorage.org/webt/_w/jh/j-/_wjhj-xhi3xqpklm437g5eicadu.png"><br>  <i><font color="#999999">Une description d√©taill√©e du processus de cryptage √† Sodinokibi</font></i> <br><br>  Afin de d√©crypter les donn√©es, les cl√©s priv√©es de l'attaquant seront n√©cessaires.  Mais ils ne sont publi√©s nulle part et il est donc impossible de restaurer des fichiers. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/155/103/aed/155103aedec3a0a2df481b585b12e0e5.png" alt="image"><br>  <i><font color="#999999">Processus de d√©cryptage (le secret de l'attaquant est sa cl√© priv√©e)</font></i> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/533/3be/cc1/5333becc1ca07074b35d708cc402796f.png" alt="image"><br>  <i><font color="#999999">Le processus simplifi√© de d√©cryptage des fichiers utilisateur est illustr√© ci-dessous.</font></i> <br><br><h3>  Cryptage de fichiers sur les disques durs locaux et les dossiers r√©seau </h3><br>  Pour crypter les fichiers utilisateur, Sodinokibi utilise des ports d'ach√®vement d'E / S et lance plusieurs flux de cryptage, mais pas plus de deux fois le nombre de c≈ìurs de processeur sur la machine, associant ces flux √† un port d'E / S sp√©cialement cr√©√©.  Ces threads utilisent la fonction API GetQueuedCompletionStatus Win pour attendre qu'un paquet arrive sur le port d'E / S avant de d√©marrer le chiffrement de fichiers. <br><br>  D√®s que les flux sont cr√©√©s et attendent que les paquets d'E / S arrivent, Sodinokibi commence √† trier les fichiers utilisateur sur tous les lecteurs locaux et dans tous les dossiers r√©seau, √† l'exception des CD-ROM et RAMDISK et √† les affecter aux ports d'ach√®vement d'E / S correspondants.  Pour tous les fichiers qui ne tombent pas dans la liste des exceptions dans les noms des dossiers, fichiers et extensions, la fonction AddFileToIoCompletionPort est appel√©e, puis PostQueuedCompletionStatus.Cela transmet l'ex√©cution au flux de chiffrement, qui attend des informations sur le port d'ach√®vement d'E / S pour d√©marrer le chiffrement des fichiers. <br><br>  La fonction AddFileToIoCompletionPort g√©n√®re √©galement une cl√© Salsa20 unique pour chaque fichier √† chiffrer et transmet la cl√© Salsa20 au flux de chiffrement avec d'autres m√©tadonn√©es qui doivent √™tre enregistr√©es apr√®s le chiffrement √† l'aide du param√®tre lpOverlapped de la fonction API PostQueuedCompletionStatus Win. <br><br>  Apr√®s avoir trait√© les fichiers dans chaque r√©pertoire, √† l'exception de l'exception, un fichier est cr√©√© avec une demande de ran√ßon.  Lorsque les fichiers √† chiffrer sont √©puis√©s, les threads entrent en boucle et attendent que le nombre total de fichiers chiffr√©s et renomm√©s atteigne le nombre total de fichiers transf√©r√©s vers le port d'ach√®vement des E / S. <br><br>  Enfin, le syst√®me d√©finit un indicateur qui indique qu'il n'y a plus de fichiers √† chiffrer et envoie plusieurs paquets d'E / S signalant la fin du processus.  Gr√¢ce √† cela, l'arr√™t des flux de chiffrement suppl√©mentaires qui attendaient des donn√©es est atteint. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3ba/7a2/e30/3ba7a2e309a6402db2e6dd37adf44acc.png" alt="image"><br><br>  Liste des dossiers d'exception <br><br><ul><li>  "$ windows. ~ bt" </li><li>  "Intel" </li><li>  "Fichiers programme (x86)" </li><li>  "Fichiers programme" </li><li>  "Msocache" </li><li>  "$ recycle.bin" </li><li>  "$ windows. ~ ws" </li><li>  "Navigateur Tor" </li><li>  "Boot" </li><li>  "Informations sur le volume du syst√®me" </li><li>  "Perflogs" </li><li>  Google </li><li>  "Donn√©es d'application" </li><li>  "Windows" </li><li>  "Programdata" </li><li>  "Windows.old" </li><li>  "Appdata" </li><li>  "Mozilla" </li><li>  Exceptions de fichier </li><li>  "Bootfont.bin" </li><li>  "Boot.ini" </li><li>  "Ntuser.dat" </li><li>  "Desktop.ini" </li><li>  "Iconcache.db" </li><li>  Ntldr </li><li>  "Ntuser.dat.log" </li><li>  "Thumbs.db" </li><li>  "Bootsect.bak" </li><li>  "Ntuser.ini" </li><li>  "Autorun.inf" </li><li>  Exceptions d'extension </li><li>  "Themepack" </li><li>  Ldf </li><li>  Scr </li><li>  Icl </li><li>  "386" </li><li>  "Cmd" </li><li>  "Ani" </li><li>  "Adv" </li><li>  "Th√®me" </li><li>  "Msi" </li><li>  "Rtp" </li><li>  "Diagcfg" </li><li>  "Msstyles" </li><li>  "Bin" </li><li>  Hlp </li><li>  Shs </li><li>  Drv </li><li>  "Wpx" </li><li>  "Deskthemepack" </li><li>  "Bat" </li><li>  "Rom" </li><li>  "Msc" </li><li>  "Lnk" </li><li>  Cabine </li><li>  "Spl" </li><li>  "Ps1" </li><li>  "Msu" </li><li>  Ics </li><li>  "Cl√©" </li><li>  "Msp" </li><li>  "Com" </li><li>  Sys </li><li>  "Diagpkg" </li><li>  "Nls" </li><li>  "Diagcab" </li><li>  Ico </li><li>  "Lock" </li><li>  "Ocx" </li><li>  "Mpa" </li><li>  "Cur" </li><li>  Cpl </li><li>  "Mod" </li><li>  Hta </li><li>  "Exe" </li><li>  "Icns" </li><li>  "Prf" </li><li>  "Dll" </li><li>  "Nomedia" </li><li>  Idx </li></ul><br>  Le flux de cryptage suppose la lecture du contenu du fichier, le cryptage, la r√©√©criture dans le m√™me fichier, l'ajout de m√©tadonn√©es, y compris la cl√© priv√©e de session crypt√©e, avec la partie publique d'ECDH pour chaque fichier et le vecteur d'initialisation Salsa20 utilis√© pour crypter le fichier. <br><br>  Apr√®s cela, le flux renomme le fichier, en ajoutant au nom un nom g√©n√©r√© de mani√®re al√©atoire.  Les fichiers sont chiffr√©s avec l'algorithme Salsa20 √† l'aide de la fonction EncryptAndWrite. <br><br>  Voici un exemple d'appel de la fonction EncryptingThreadRoutine. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/585/d44/fab/585d44fab868f9461a5963dc1f6a9f72.png" alt="image"><br>  <i><font color="#999999">Structure des fichiers apr√®s cryptage</font></i> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1ce/0a1/c4a/1ce0a1c4acd810503e66c32de66c0a93.png" alt="image"><br>  <i><font color="#999999">Structure de fichiers crypt√©s</font></i> <br><br><h3>  Activit√© r√©seau </h3><br>  Une fois le processus de cryptage termin√©, le ransomware pr√©pare les donn√©es √† envoyer au serveur de gestion.  Les donn√©es incluent divers champs de la configuration JSON, des informations syst√®me et des cl√©s de chiffrement.  Les donn√©es pr√©par√©es sont √©galement √©crites dans le registre sous la cl√© "[HKLM | HKCU] \ SOFTWARE \ recfg \ stat" avant d'√™tre chiffr√©es par AES et envoy√©es au serveur de l'attaquant ... <br><br><img src="https://habrastorage.org/getpro/habr/post_images/177/c79/75b/177c7975bd8ed873554686cd35085dee.png" alt="image"><br><br>  Donn√©es r√©seau <br><br><img src="https://habrastorage.org/webt/_e/7-/nt/_e7-ntfpxprjff32wylpvkqbwou.jpeg"><br><br>  Le nom de domaine se compose de: sochi-okna23 [.] Ru + une partie de l'adresse 1 <br><br><ul><li>  "Wp-content" </li><li>  "Statique" </li><li>  "Contenu" </li><li>  "Inclure" </li><li>  "T√©l√©chargements" </li><li>  "Nouvelles" </li><li>  "Donn√©es" </li><li>  "Admin" </li></ul><br>  et une partie de l'adresse 2 <br><br><ul><li>  "Images" </li><li>  "Images" </li><li>  "Image" </li><li>  "Temp" </li><li>  "Tmp" </li><li>  "Graphique" </li><li>  "Atouts" </li><li>  Photos </li><li>  "Jeu" </li></ul><br><img src="https://habrastorage.org/getpro/habr/post_images/114/8c0/080/1148c0080da59e15820170215234c139.png" alt="image"><br>  <i><font color="#999999">G√©n√©ration d'URL</font></i> <br><br><h3>  Demande de ran√ßon </h3><br>  Sodinokibi dispose d'un mod√®le pour cr√©er une demande de rachat, qui laisse de la place aux donn√©es des utilisateurs.  Ils remplacent automatiquement le nom, l'ID utilisateur (uid - description ci-dessus) et la cl√©.  La demande de ran√ßon est plac√©e dans chaque r√©pertoire, sans compter les exceptions. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/386/32b/bd6/38632bbd6f4f0aee82221e912141f581.png" alt="image"><br><br><h3>  D√©cryptage </h3><br><img src="https://habrastorage.org/getpro/habr/post_images/125/d73/54d/125d7354d290e43946bfdb96a5694c79.png" alt="image"><br><br>  Il n'existe aucun moyen gratuit de d√©crypter les donn√©es de ce ransomware, et la seule fa√ßon de r√©cup√©rer les donn√©es est d'utiliser le service de d√©cryptage fourni par l'attaquant.  Allez-y en suivant les instructions de la demande de ran√ßon ... <br><br><img src="https://habrastorage.org/getpro/habr/post_images/707/55b/adf/70755badfcf4a2f59b23e72cffc4cbec.png" alt="image"><br><br><h3>  Conclusion </h3><br>  Nous vous recommandons d'utiliser une protection anti-ransomware avanc√©e et de maintenir vos syst√®mes antivirus √† jour.  Tous les produits Acronis contiennent une protection renforc√©e contre les ransomwares et peuvent vous prot√©ger contre une telle attaque, minimisant le risque de perte de donn√©es. <br><br>  La cyberprotection est contenue dans la solution personnelle Acronis True Image 2019, ainsi que dans les syst√®mes d'entreprise Acronis Backup, qui sont accompagn√©s d'un module anti-malware bas√© sur l'intelligence artificielle appel√© Acronis Active Protection.  Gr√¢ce √† cela, les deux syst√®mes sont en mesure de prot√©ger les utilisateurs de Sodinokibi. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr462567/">https://habr.com/ru/post/fr462567/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr462551/index.html">Questions fr√©quentes des d√©veloppeurs sur les tests</a></li>
<li><a href="../fr462553/index.html">Un peu simple. Conception de test. Partie 1</a></li>
<li><a href="../fr462555/index.html">Discussion: que faire si vous travaillez sans cookies - nous vous disons quelles sont les alternatives</a></li>
<li><a href="../fr462563/index.html">Webinaire ¬´Comment survivre √† la conformit√©?¬ª La meilleure approche pour r√©pondre aux exigences r√©glementaires ¬ª</a></li>
<li><a href="../fr462565/index.html">Comment pr√©parer les donn√©es pour SAP Process Mining by Celonis</a></li>
<li><a href="../fr462569/index.html">Le syst√®me de transport avec nous et avec eux ou ¬´Gares routi√®res contre agr√©gateurs 2¬ª</a></li>
<li><a href="../fr462571/index.html">Les aventures des Malvari insaisissables: d√©fense polyvalente (pens√©es finales)</a></li>
<li><a href="../fr462573/index.html">Concours de projets: quoi, pourquoi et pourquoi?</a></li>
<li><a href="../fr462575/index.html">Security Week 32: trou dans iMessage, confidentialit√© de l'entr√©e vocale</a></li>
<li><a href="../fr462577/index.html">Mon exp√©rience de d√©veloppement Nim</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>