<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🎐 💡 👩🏾‍⚖️ Tout ce que vous vouliez savoir sur l'adresse MAC 🥡 🔖 😺</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Tout le monde sait que ce sont six octets, généralement affichés au format hexadécimal, attribués à une carte réseau en usine, et à première vue, ils ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Tout ce que vous vouliez savoir sur l'adresse MAC</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/483670/"><p><img src="https://habrastorage.org/webt/so/w5/21/sow5218j24fiojm2deevv3xnko8.jpeg" align="right">  Tout le monde sait que ce sont six octets, généralement affichés au format hexadécimal, attribués à une carte réseau en usine, et à première vue, ils sont aléatoires.  Certaines personnes savent que les trois premiers octets de l'adresse sont l'identifiant du fabricant et que les trois octets restants leur sont attribués.  Il est également connu que vous pouvez vous fixer <em>une</em> adresse <em>arbitraire</em> .  Beaucoup ont entendu parler des «adresses aléatoires» du Wi-Fi. </p><br><p>  Voyons ce que c'est. </p><br><p> Adresse MAC (adresse de contrôle d'accès aux médias) - identifiant unique attribué à une carte réseau; il est utilisé dans les réseaux standard IEEE 802, principalement Ethernet, Wi-Fi et Bluetooth.  Officiellement, il est appelé «identifiant de type EUI-48».  Il est évident d'après le nom que l'adresse est de 48 bits, c'est-à-dire  6 octets.  Il n'y a pas de norme généralement acceptée pour écrire une adresse (par opposition à une adresse IPv4, où les octets sont toujours séparés par des points). Elle est généralement écrite sous la forme de six nombres hexadécimaux, séparés par deux points: 00: AB: CD: EF: 11: 22, bien que certains fabricants d'équipement préfèrent écrire comme 00 -AB-CD-EF-11-22 et même 00ab.cdef.1122. </p><a name="habracut"></a><br><p>  Historiquement, les adresses étaient cousues dans la ROM du chipset de la carte réseau sans possibilité de modification sans programmeur flash, mais à l'heure actuelle l'adresse peut être modifiée par programme, à partir du système d'exploitation.  Vous pouvez définir manuellement l'adresse MAC de la carte réseau sous Linux et MacOS (toujours), Windows (presque toujours, si le pilote le permet), Android (uniquement root);  avec iOS (sans root), une astuce similaire est impossible. </p><br><h3>  Structure d'adresse </h3><br><p>  L'adresse se compose d'une partie de l'identifiant du fabricant, OUI, et de l'identifiant attribué par le fabricant.  L'OUI (Organizationally Unique Identifier) <a href="https://standards.ieee.org/products-services/regauth/oui/index.html" rel="nofollow">est</a> attribué par l'IEEE.  En fait, sa longueur peut être non seulement de 3 octets (24 bits), mais de 28 ou 36 bits, à partir desquels sont formés les blocs MAC Address Block (MA) de types Large (MA-L), Medium (MA-M) et Small. (MA-S) respectivement.  La taille du bloc émis, dans ce cas, sera de 24, 20, 12 bits ou 16 millions, 1 million, 4 000 morceaux d'adresses.  À l'heure actuelle, environ 38 000 blocs sont distribués, ils peuvent être consultés avec de nombreux outils en ligne, par exemple <a href="https://regauth.standards.ieee.org/standards-ra-web/pub/view.html" rel="nofollow">IEEE</a> ou <a href="https://www.wireshark.org/tools/oui-lookup.html" rel="nofollow">Wireshark</a> . </p><br><h3>  À qui appartiennent les adresses </h3><br><p>  Le simple traitement de la <a href="https://code.wireshark.org/review/gitweb%3Fp%3Dwireshark.git%3Ba%3Dblob_plain%3Bf%3Dmanuf%3Bhb%3DHEAD" rel="nofollow">base de données de téléchargement</a> IEEE accessible au public fournit de nombreuses informations.  Par exemple, certaines organisations ont pris beaucoup de blocs OUI.  Voici nos héros: </p><br><div class="scrollable-table"><table><thead><tr><th>  Vendeur </th><th>  Le nombre de blocs / enregistrements </th><th>  Le nombre d'adresses, en millions </th></tr></thead><tbody><tr><td>  Cisco Systems Inc </td><td>  888 </td><td>  14208 </td></tr><tr><td>  Apple </td><td>  772 </td><td>  12352 </td></tr><tr><td>  Samsung </td><td>  636 </td><td>  10144 </td></tr><tr><td>  Huawei Technologies Co. Ltd </td><td>  606 </td><td>  9696 </td></tr><tr><td>  Intel Corporation </td><td>  375 </td><td>  5776 </td></tr><tr><td>  Groupe ARRIS Inc. </td><td>  319 </td><td>  5104 </td></tr><tr><td>  Nokia Corporation </td><td>  241 </td><td>  3856 </td></tr><tr><td>  Privé </td><td>  232 </td><td>  2704 </td></tr><tr><td>  Texas Instruments </td><td>  212 </td><td>  3392 </td></tr><tr><td>  zte corporation </td><td>  198 </td><td>  3168 </td></tr><tr><td>  Autorité d'enregistrement IEEE </td><td>  194 </td><td>  3072 </td></tr><tr><td>  Hewlett packard </td><td>  149 </td><td>  2384 </td></tr><tr><td>  Hon Hai Precision </td><td>  136 </td><td>  2176 </td></tr><tr><td>  TP-LINK </td><td>  134 </td><td>  2144 </td></tr><tr><td>  Dell Inc. </td><td>  123 </td><td>  1968 </td></tr><tr><td>  Juniper Networks </td><td>  110 </td><td>  1760 </td></tr><tr><td>  Sagemcom Broadband SAS </td><td>  97 </td><td>  1552 </td></tr><tr><td>  Fiberhome Telecommunication Technologies Co.  LTD </td><td>  97 </td><td>  1552 </td></tr><tr><td>  Xiaomi Communications Co Ltd </td><td>  88 </td><td>  1408 </td></tr><tr><td>  Guangdong Oppo Mobile Telecommunications Corp.Ltd </td><td>  82 </td><td>  1312 </td></tr></tbody></table></div><br><p>  Google n'en a que 40, ce qui n'est pas surprenant: ils ne produisent pas eux-mêmes autant de périphériques réseau. </p><br><p>  Les blocs MA ne sont pas fournis gratuitement, ils peuvent être achetés à un prix raisonnable (sans frais mensuels) pour 3000 $, 1800 $ ou 755 $, respectivement.  Il est intéressant de noter que pour l'argent supplémentaire (par an), vous pouvez acheter la "dissimulation" des informations publiques sur le bloc alloué.  Il y en a maintenant 232, comme on peut le voir ci-dessus. </p><br><h3 id="kogda-zakonchatsya-mas-adresa">  Quand l'adresse MAC sera-t-elle épuisée? </h3><br><p>  Nous sommes tous fatigués de l'histoire vieille de dix ans selon laquelle "les adresses IPv4 sont sur le point de s'épuiser".  Oui, les nouveaux blocs IPv4 ne sont plus faciles à obtenir.  Il est également connu que les adresses IP sont <a href="https://habr.com/ru/company/globalsign/blog/355006/">distribuées de manière extrêmement inégale</a> ;  il y a cependant des blocs gigantesques et peu utilisés appartenant à de grandes sociétés et au gouvernement américain, sans grand espoir de leur redistribution en faveur de ceux qui en ont besoin.  La prolifération de NAT, CG-NAT et IPv6 a rendu le problème du manque d'adresses publiques moins aigu. </p><br><p>  Il y a 48 bits dans l'adresse MAC, dont 46 peuvent être considérés comme «utiles» (pourquoi? Lire la suite), ce qui donne 2 <sup>46</sup> ou 10 <sup>14</sup> adresses, soit 2 <sup>14</sup> fois l'espace d'adressage IPv4. <br>  À l'heure actuelle, environ un demi-billion d'adresses sont distribuées, soit seulement 0,73% du volume total.  L'épuisement des adresses MAC est encore très, très loin. </p><br><h3 id="sluchaynost-bit">  Bit aléatoire </h3><br><p>  On peut supposer que les OUI sont distribuées de manière aléatoire, et le fournisseur attribue ensuite également des adresses à des périphériques réseau individuels.  En est-il ainsi?  Examinons la distribution des bits dans les bases MAC des adresses dont j'ai à ma disposition pour les appareils 802.11 collectés par les systèmes d'autorisation de travail dans les réseaux sans fil <a href="https://www.netams.com/wnam/" rel="nofollow">WNAM</a> .  Les adresses appartiennent à de vrais appareils connectés au Wi-Fi depuis plusieurs années dans trois pays.  En outre, il existe une petite base de périphériques LAN câblés 802.3. </p><br><p>  Nous divisons chaque adresse MAC (six octets) de chacun des échantillons en bits par octets, et examinons la fréquence d'occurrence du bit "1" dans chacune des 48 positions.  Si le bit est défini de manière complètement arbitraire, la probabilité d'obtenir "1" devrait être de 50%. </p><br><div class="scrollable-table"><table><thead><tr><th></th><th>  Échantillon Wi-Fi n ° 1 (RF) </th><th>  Échantillon Wi-Fi n ° 2 (Bélarus) </th><th>  Échantillon Wi-Fi n ° 3 (Ouzbékistan) </th><th>  Échantillon LAN (RF) </th></tr></thead><tbody><tr><td>  Le nombre d'enregistrements dans la base de données </td><td>  5929000 </td><td>  1274000 </td><td>  366000 </td><td>  1000 </td></tr><tr><td>  Numéro de bit: </td><td>  % bit "1" </td><td>  % bit "1" </td><td>  % bit "1" </td><td>  % bit "1" </td></tr><tr><td>  1 </td><td>  48,6% </td><td>  49,2% </td><td>  50,7% </td><td>  28,7% </td></tr><tr><td>  2 </td><td>  44,8% </td><td>  49,1% </td><td>  47,7% </td><td>  30,7% </td></tr><tr><td>  3 </td><td>  46,7% </td><td>  48,3% </td><td>  46,8% </td><td>  35,8% </td></tr><tr><td>  4 </td><td>  48,0% </td><td>  48,6% </td><td>  49,8% </td><td>  37,1% </td></tr><tr><td>  5 </td><td>  45,7% </td><td>  46,9% </td><td>  47,0% </td><td>  32,3% </td></tr><tr><td>  6 </td><td>  46,6% </td><td>  46,7% </td><td>  47,8% </td><td>  27,1% </td></tr><tr><td>  7 </td><td>  <strong>0,3%</strong> </td><td>  <strong>0,3%</strong> </td><td>  <strong>0,2%</strong> </td><td>  <strong>0,7%</strong> </td></tr><tr><td>  8 </td><td>  <strong>0,0%</strong> </td><td>  <strong>0,0%</strong> </td><td>  <strong>0,0%</strong> </td><td>  <strong>0,0%</strong> </td></tr><tr><td></td></tr><tr><td>  9 </td><td>  48,1% </td><td>  50,6% </td><td>  49,4% </td><td>  38,1% </td></tr><tr><td>  10 </td><td>  49,1% </td><td>  50,2% </td><td>  47,4% </td><td>  42,7% </td></tr><tr><td>  11 </td><td>  50,8% </td><td>  50,0% </td><td>  50,6% </td><td>  42,9% </td></tr><tr><td>  12 </td><td>  49,0% </td><td>  48,4% </td><td>  48,2% </td><td>  53,7% </td></tr><tr><td>  13 </td><td>  47,6% </td><td>  47,0% </td><td>  46,3% </td><td>  48,5% </td></tr><tr><td>  14 </td><td>  47,5% </td><td>  47,4% </td><td>  51,7% </td><td>  46,8% </td></tr><tr><td>  15 </td><td>  48,3% </td><td>  47,5% </td><td>  48,7% </td><td>  46,1% </td></tr><tr><td>  16 </td><td>  50,6% </td><td>  50,4% </td><td>  51,2% </td><td>  45,3% </td></tr><tr><td></td></tr><tr><td>  17 </td><td>  49,4% </td><td>  50,4% </td><td>  54,3% </td><td>  38,2% </td></tr><tr><td>  18 </td><td>  49,8% </td><td>  50,5% </td><td>  51,5% </td><td>  51,9% </td></tr><tr><td>  19 </td><td>  51,6% </td><td>  53,3% </td><td>  53,9% </td><td>  42,6% </td></tr><tr><td>  20 </td><td>  46,6% </td><td>  46,1% </td><td>  45,5% </td><td>  48,4% </td></tr><tr><td>  21 </td><td>  51,7% </td><td>  52,9% </td><td>  47,7% </td><td>  48,9% </td></tr><tr><td>  22 </td><td>  49,2% </td><td>  49,6% </td><td>  41,6% </td><td>  49,8% </td></tr><tr><td>  23 </td><td>  51,2% </td><td>  50,9% </td><td>  47,0% </td><td>  41,9% </td></tr><tr><td>  24 </td><td>  49,5% </td><td>  50,2% </td><td>  50,1% </td><td>  47,5% </td></tr><tr><td></td></tr><tr><td>  25 </td><td>  47,1% </td><td>  47,3% </td><td>  47,7% </td><td>  44,2% </td></tr><tr><td>  26 </td><td>  48,6% </td><td>  48,6% </td><td>  49,2% </td><td>  43,9% </td></tr><tr><td>  27 </td><td>  49,8% </td><td>  49,0% </td><td>  49,7% </td><td>  48,9% </td></tr><tr><td>  28 </td><td>  49,3% </td><td>  49,3% </td><td>  49,7% </td><td>  55,1% </td></tr><tr><td>  29 </td><td>  49,5% </td><td>  49,4% </td><td>  49,8% </td><td>  49,8% </td></tr><tr><td>  30 </td><td>  49,8% </td><td>  49,8% </td><td>  49,7% </td><td>  52,1% </td></tr><tr><td>  31 </td><td>  49,5% </td><td>  49,7% </td><td>  49,6% </td><td>  46,6% </td></tr><tr><td>  32 </td><td>  49,4% </td><td>  49,7% </td><td>  49,5% </td><td>  47,5% </td></tr><tr><td></td></tr><tr><td>  33 </td><td>  49,4% </td><td>  49,8% </td><td>  49,7% </td><td>  48,3% </td></tr><tr><td>  34 </td><td>  49,7% </td><td>  50,0% </td><td>  49,6% </td><td>  44,9% </td></tr><tr><td>  35 </td><td>  49,9% </td><td>  50,0% </td><td>  50,0% </td><td>  50,6% </td></tr><tr><td>  36 </td><td>  49,9% </td><td>  49,9% </td><td>  49,8% </td><td>  49,1% </td></tr><tr><td>  37 </td><td>  49,8% </td><td>  50,0% </td><td>  49,9% </td><td>  51,4% </td></tr><tr><td>  38 </td><td>  50,0% </td><td>  50,0% </td><td>  49,8% </td><td>  51,8% </td></tr><tr><td>  39 </td><td>  49,9% </td><td>  50,0% </td><td>  49,9% </td><td>  55,7% </td></tr><tr><td>  40 </td><td>  50,0% </td><td>  50,0% </td><td>  50,0% </td><td>  49,5% </td></tr><tr><td></td></tr><tr><td>  41 </td><td>  49,9% </td><td>  50,0% </td><td>  49,9% </td><td>  52,2% </td></tr><tr><td>  42 </td><td>  50,0% </td><td>  50,0% </td><td>  50,0% </td><td>  53,9% </td></tr><tr><td>  43 </td><td>  50,1% </td><td>  50,0% </td><td>  50,3% </td><td>  56,1% </td></tr><tr><td>  44 </td><td>  50,1% </td><td>  50,0% </td><td>  50,1% </td><td>  45,8% </td></tr><tr><td>  45 </td><td>  50,0% </td><td>  50,0% </td><td>  50,1% </td><td>  50,1% </td></tr><tr><td>  46 </td><td>  50,0% </td><td>  50,0% </td><td>  50,1% </td><td>  49,5% </td></tr><tr><td>  47 </td><td>  49,2% </td><td>  49,4% </td><td>  49,7% </td><td>  45,2% </td></tr><tr><td>  48 </td><td>  49,9% </td><td>  50,1% </td><td>  50,7% </td><td>  54,6% </td></tr></tbody></table></div><br><p>  D'où vient cette injustice dans les bits 7 et 8?  Il y a presque toujours des zéros. </p><br><p>  En effet, la norme définit ces bits comme spéciaux ( <a href="https://ru.wikipedia.org/wiki/MAC-%25D0%25B0%25D0%25B4%25D1%2580%25D0%25B5%25D1%2581" rel="nofollow">Wikipedia</a> ): <br><img src="https://habrastorage.org/webt/0-/oc/jk/0-ocjkovhfyalpqzrsjdecvg7na.png"></p><br><p>  Le huitième bit (depuis le début) du premier octet de l'adresse MAC est appelé bit Unicast / Multicast et détermine quel type de trame (trame) est transmis avec cette adresse, normal (0) ou broadcast (1) (multicast ou broadcast).  Pour une interaction de carte réseau unicast normale, ce bit est défini sur «0» dans tous les paquets qui lui sont envoyés. </p><br><p>  Le septième bit (depuis le début) du premier octet de l'adresse MAC est appelé le bit U / L (universel / local) et détermine si l'adresse est globalement unique (0) ou localement unique (1).  Par défaut, toutes les adresses "assemblées par le fabricant" sont globalement uniques, par conséquent le nombre écrasant d'adresses MAC collectées contient le septième bit défini sur "0".  Dans le tableau des identifiants OUI attribués, seules environ 130 entrées ont un bit U / L de "1", et apparemment ce sont des blocs d'adresses MAC pour des besoins spéciaux. </p><br><p>  Du sixième au premier bit du premier octet, les bits des deuxième et troisième octets dans les identifiants OUI, et plus encore les bits en 4-6 octets de l'adresse attribuée par le constructeur, sont répartis plus ou moins uniformément. </p><br><p>  Ainsi, dans l'adresse MAC réelle de la carte réseau, les bits sont pratiquement équivalents et n'ont pas de signification technologique, à l'exception de deux bits de service de l'octet de poids fort. </p><br><h3 id="rasprostranennost">  Prévalence </h3><br><p>  Je me demande quels fabricants d'équipements sans fil sont les plus populaires?  Combinez la recherche OUI avec des exemples de données n ° 1. </p><br><div class="scrollable-table"><table><thead><tr><th>  Vendeur </th><th>  La part des appareils,% </th></tr></thead><tbody><tr><td>  Apple </td><td>  26.09 </td></tr><tr><td>  Samsung </td><td>  19,79 </td></tr><tr><td>  Huawei Technologies Co.  Ltd </td><td>  7,80 </td></tr><tr><td>  Xiaomi Communications Co Ltd </td><td>  6,83 </td></tr><tr><td>  Sony Mobile Communications Inc </td><td>  3.29 </td></tr><tr><td>  LG Electronics (communications mobiles) </td><td>  2,76 </td></tr><tr><td>  ORDINATEUR ASUSTek INC. </td><td>  2,58 </td></tr><tr><td>  TCT mobile ltd </td><td>  2.13 </td></tr><tr><td>  zte corporation </td><td>  2,00 </td></tr><tr><td>  introuvable dans la base de données IEEE </td><td>  1,92 </td></tr><tr><td>  Lenovo Mobile Communication Technology Ltd. </td><td>  1,71 </td></tr><tr><td>  HTC Corporation </td><td>  1,68 </td></tr><tr><td>  Murata Manufactuaring </td><td>  1,31 </td></tr><tr><td>  Inpro comm </td><td>  1,26 </td></tr><tr><td>  Microsoft Corporation </td><td>  1,11 </td></tr><tr><td>  Shenzhen TINNO Mobile Technology Corp. </td><td>  1,02 </td></tr><tr><td>  Motorola (Wuhan) Mobility Technologies Communication Co.  Ltd. </td><td>  0,93 </td></tr><tr><td>  Nokia Corporation </td><td>  0,88 </td></tr><tr><td>  Shanghai Wind Technologies Co.  Ltd </td><td>  0,74 </td></tr><tr><td>  Lenovo Mobile Communication (Wuhan) Company Limited </td><td>  0,71 </td></tr></tbody></table></div><br><p>  La pratique montre que plus le contingent d'abonnés sans fil de cet endroit est prospère, plus la proportion d'appareils Apple est élevée. </p><br><h3 id="unikalnost">  Unicité </h3><br><p>  Les adresses MAC sont-elles uniques?  En théorie, oui, car chacun des fabricants d'appareils (propriétaires de l'unité MA) est tenu de fournir une adresse unique pour chacun de ses adaptateurs réseau.  Cependant, certains fabricants de puces, à savoir: </p><br><ul><li>  00: 0A: F5 Airgo Networks, Inc.  (maintenant Qualcomm) </li><li>  00:08:22 InPro Comm (maintenant MediaTek) </li></ul><br><p>  définissez les trois derniers octets de l'adresse MAC sur un nombre aléatoire, apparemment après chaque redémarrage de l'appareil.  Il y avait 82 000 de ces adresses dans mon échantillon n ° 1. </p><br><p>  Vous pouvez vous définir comme un étranger, pas comme une adresse unique, bien sûr, en la configurant délibérément «comme un voisin», en la définissant comme un renifleur ou en choisissant au hasard.  Il est également possible de se définir accidentellement une adresse non unique en effectuant, par exemple, la restauration d'une configuration de sauvegarde d'un routeur comme Mikrotik ou OpenWrt. </p><br><p>  Que se passe-t-il si deux appareils avec la même adresse MAC sont présents sur le réseau?  Tout dépend de la logique de l'équipement réseau (routeur filaire, contrôleur réseau sans fil).  Très probablement, les deux appareils ne fonctionneront pas ou fonctionneront par intermittence.  Du point de vue des normes IEEE, il est proposé de résoudre la protection contre la falsification des adresses MAC en utilisant, par exemple, MACsec ou 802.1X. </p><br><p>  Que se passe-t-il si vous vous mettez un MAC avec le septième ou le huitième bit réglé sur "1", c.-à-d.  adresse locale ou multidiffusion?  Très probablement, votre réseau n'y fera pas attention, mais formellement, une telle adresse ne sera pas conforme à la norme, et il vaut mieux ne pas le faire. </p><br><h3 id="kak-rabotaet-randomizaciya">  Comment fonctionne la randomisation </h3><br><p>  Nous savons que pour éviter de suivre les mouvements des personnes en balayant l'air et en collectant les systèmes d'exploitation MAC des smartphones, nous utilisons la technologie de randomisation depuis plusieurs années.  Théoriquement, lors de l'analyse de l'air à la recherche de réseaux connus, le smartphone envoie un paquet (groupe de paquets) de type sonde 802.11 avec l'adresse MAC comme source: </p><br><p><img src="https://habrastorage.org/webt/ys/xx/sp/ysxxspu7y2giwvvdflhwrgiar-m.gif"></p><br><p>  La randomisation incluse vous permet de spécifier non pas «flashé», mais une autre adresse source du paquet, changeant à chaque cycle de scan, dans le temps ou d'une manière ou d'une autre.  Est-ce que cela fonctionne?  Regardons les statistiques des adresses MAC collectées depuis les airs avec le soi-disant "Radar Wi-Fi": </p><br><div class="scrollable-table"><table><thead><tr><th></th><th>  Échantillon entier </th><th>  Échantillonnage avec seulement 7 m de bits </th></tr></thead><tbody><tr><td>  Le nombre d'enregistrements dans la base de données </td><td>  3920000 </td><td>  305 000 </td></tr><tr><td>  Numéro de bit: </td><td>  % bit "1" </td><td>  % bit "1" </td></tr><tr><td>  1 </td><td>  66,1% </td><td>  43,3% </td></tr><tr><td>  2 </td><td>  66,5% </td><td>  43,4% </td></tr><tr><td>  3 </td><td>  31,7% </td><td>  43,8% </td></tr><tr><td>  4 </td><td>  66,6% </td><td>  46,4% </td></tr><tr><td>  5 </td><td>  66,7% </td><td>  45,7% </td></tr><tr><td>  6 </td><td>  31,9% </td><td>  46,4% </td></tr><tr><td>  7 </td><td>  <strong>92,2%</strong> </td><td>  0,0% </td></tr><tr><td>  8 </td><td>  0,0% </td><td>  0,0% </td></tr><tr><td></td><td></td><td></td></tr><tr><td>  9 </td><td>  67,2% </td><td>  47,5% </td></tr><tr><td>  10 </td><td>  32,3% </td><td>  45,6% </td></tr><tr><td>  11 </td><td>  66,9% </td><td>  45,3% </td></tr><tr><td>  12 </td><td>  32,3% </td><td>  46,8% </td></tr><tr><td>  13 </td><td>  32,6% </td><td>  50,1% </td></tr><tr><td>  14 </td><td>  33,0% </td><td>  56,1% </td></tr><tr><td>  15 </td><td>  32,5% </td><td>  45,0% </td></tr><tr><td>  16 </td><td>  67,2% </td><td>  48,3% </td></tr><tr><td></td><td></td><td></td></tr><tr><td>  17 </td><td>  33,2% </td><td>  56,9% </td></tr><tr><td>  18 </td><td>  33,3% </td><td>  56,8% </td></tr><tr><td>  19 </td><td>  33,3% </td><td>  56,3% </td></tr><tr><td>  20 </td><td>  66,8% </td><td>  43,2% </td></tr><tr><td>  21 </td><td>  67,0% </td><td>  46,4% </td></tr><tr><td>  22 </td><td>  32,6% </td><td>  50,1% </td></tr><tr><td>  23 </td><td>  32,9% </td><td>  51,2% </td></tr><tr><td>  24 </td><td>  67,6% </td><td>  52,2% </td></tr><tr><td></td><td></td><td></td></tr><tr><td>  25 </td><td>  49,8% </td><td>  47,8% </td></tr><tr><td>  26 </td><td>  50,0% </td><td>  50,0% </td></tr><tr><td>  27 </td><td>  50,0% </td><td>  50,2% </td></tr><tr><td>  28 </td><td>  50,0% </td><td>  49,8% </td></tr><tr><td>  29 </td><td>  50,0% </td><td>  49,4% </td></tr><tr><td>  30 </td><td>  50,0% </td><td>  50,0% </td></tr><tr><td>  31 </td><td>  50,0% </td><td>  49,7% </td></tr><tr><td>  32 </td><td>  50,0% </td><td>  49,9% </td></tr><tr><td></td><td></td><td></td></tr><tr><td>  33 </td><td>  50,0% </td><td>  49,7% </td></tr><tr><td>  34 </td><td>  50,0% </td><td>  49,6% </td></tr><tr><td>  35 </td><td>  50,0% </td><td>  50,1% </td></tr><tr><td>  36 </td><td>  50,0% </td><td>  49,5% </td></tr><tr><td>  37 </td><td>  50,0% </td><td>  49,9% </td></tr><tr><td>  38 </td><td>  50,0% </td><td>  49,8% </td></tr><tr><td>  39 </td><td>  50,0% </td><td>  49,9% </td></tr><tr><td>  40 </td><td>  50,0% </td><td>  50,1% </td></tr><tr><td></td><td></td><td></td></tr><tr><td>  41 </td><td>  50,0% </td><td>  50,2% </td></tr><tr><td>  42 </td><td>  50,0% </td><td>  50,2% </td></tr><tr><td>  43 </td><td>  50,0% </td><td>  50,1% </td></tr><tr><td>  44 </td><td>  50,0% </td><td>  50,1% </td></tr><tr><td>  45 </td><td>  50,0% </td><td>  50,0% </td></tr><tr><td>  46 </td><td>  50,0% </td><td>  49,8% </td></tr><tr><td>  47 </td><td>  50,0% </td><td>  49,8% </td></tr><tr><td>  48 </td><td>  50,1% </td><td>  50,9% </td></tr></tbody></table></div><br><p>  L'image est complètement différente. </p><br><p>  Le 8e bit du premier octet de l'adresse MAC correspond toujours à la nature Unicast de l'adresse SRC dans le paquet de demande de sonde. </p><br><p>  Le 7e bit dans 92,2% des cas est réglé sur Local, c'est-à-dire  avec une certaine certitude, nous pouvons supposer qu'autant d'adresses collectées sont aléatoires et moins de 8% sont réelles.  De plus, la distribution des bits dans l'OUI pour de telles adresses réelles coïncide approximativement avec les données du tableau précédent. </p><br><p>  Selon OUI, à quel fabricant appartiennent les adresses randomisées (c'est-à-dire avec le 7e bit en «1»)? </p><br><div class="scrollable-table"><table><thead><tr><th>  Fabricant par OUI </th><th>  Partager entre toutes les adresses </th></tr></thead><tbody><tr><td>  introuvable dans la base de données IEEE </td><td>  62,45% </td></tr><tr><td>  Google Inc. </td><td>  37,54% </td></tr><tr><td>  le reste </td><td>  0,01% </td></tr></tbody></table></div><br><p>  De plus, toutes les adresses randomisées attribuées à Google appartiennent à une OUI avec le préfixe <strong>DA: A1: 19</strong> .  Quel est ce préfixe?  Regardons le <a href="" rel="nofollow">code source pour Android</a> . </p><br><pre><code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> MacAddress BASE_GOOGLE_MAC = MacAddress.fromString(<span class="hljs-string"><span class="hljs-string">"da:a1:19:0:0:0"</span></span>);</code> </pre> <br><p>  L'Android stock utilise une OUI spéciale et enregistrée, l'une des rares avec le septième bit défini, dans la recherche de réseaux sans fil. </p><br><h3 id="vychislit-realnyy-mas-iz-randomnogo">  Calculer le MAC réel à partir du hasard </h3><br><p>  Regardons là-bas: </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> VALID_LONG_MASK = (<span class="hljs-number"><span class="hljs-number">1L</span></span> &lt;&lt; <span class="hljs-number"><span class="hljs-number">48</span></span>) - <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> LOCALLY_ASSIGNED_MASK = MacAddress.fromString(<span class="hljs-string"><span class="hljs-string">"2:0:0:0:0:0"</span></span>).mAddr; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> MULTICAST_MASK = MacAddress.fromString(<span class="hljs-string"><span class="hljs-string">"1:0:0:0:0:0"</span></span>).mAddr; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-meta"><span class="hljs-meta">@NonNull</span></span> <span class="hljs-function"><span class="hljs-function">MacAddress </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createRandomUnicastAddress</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(MacAddress base, Random r)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> addr; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (base == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { addr = r.nextLong() &amp; VALID_LONG_MASK; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { addr = (base.mAddr &amp; OUI_MASK) | (NIC_MASK &amp; r.nextLong()); } addr |= LOCALLY_ASSIGNED_MASK; addr &amp;= ~MULTICAST_MASK; MacAddress mac = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MacAddress(addr); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (mac.equals(DEFAULT_MAC_ADDRESS)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> createRandomUnicastAddress(base, r); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> mac; }</code> </pre><br><p>  L'adresse entière, ou ses trois octets au moins, est pure <em>Random.nextLong ()</em> .  «Récupération brevetée d'un véritable MAS» - une fraude.  Avec un haut degré de certitude, on peut s'attendre à ce que les fabricants de téléphones Android utilisent d'autres OUI non enregistrés.  Nous n'avons pas de sources iOS, mais un algorithme similaire y est probablement utilisé. </p><br><p>  Ce qui précède n'annule pas le fonctionnement d'autres mécanismes de désanonymisation des abonnés Wi-Fi, sur la base de l'analyse d'autres champs de la trame de demande de sonde, ou de la corrélation de la fréquence relative des demandes envoyées par l'appareil.  Cependant, le suivi fiable d'un abonné par des moyens externes est extrêmement problématique.  Les données collectées sont plus adaptées à l'analyse de la charge moyenne / maximale par emplacement et par heure, sur la base d'un grand nombre, sans référence à des appareils et des personnes spécifiques.  Des données précises ne sont destinées qu'à ceux qui sont "à l'intérieur", les fabricants d'OS mobiles eux-mêmes, les applications installées. </p><br><p>  Qu'est-ce qui pourrait être dangereux si quelqu'un d'autre découvre l'adresse MAC de votre appareil?  Pour les réseaux câblés et sans fil, une attaque par déni de service peut être organisée.  Pour un appareil sans fil, en outre, avec une certaine probabilité, il est possible de fixer le moment d'apparition à l'endroit où le capteur est installé.  En usurpant l'adresse, vous pouvez essayer de «faire semblant» d'être votre appareil, ce qui ne peut fonctionner que si des mesures de sécurité supplémentaires ne sont pas appliquées (autorisation et / ou cryptage).  99,9% des gens d'ici n'ont rien à craindre. </p><br><p>  L'adresse MAC est plus complexe qu'il n'y paraît, mais plus simple qu'elle ne pourrait l'être. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr483670/">https://habr.com/ru/post/fr483670/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr483656/index.html">Tableau au détail, vraiment?</a></li>
<li><a href="../fr483662/index.html">Intégration de Cisco Threat Response et de Cisco Stealthwatch Enterprise</a></li>
<li><a href="../fr483664/index.html">API fonctionnelle Keras dans TensorFlow</a></li>
<li><a href="../fr483666/index.html">À propos de Volodya et de l'ozoniseur</a></li>
<li><a href="../fr483668/index.html">Le condensé de matières fraîches du monde du front-end de la dernière semaine n ° 397 (6-12 janvier 2020)</a></li>
<li><a href="../fr483674/index.html">Comment fonctionnent les réseaux de neurones binaires et pourquoi ils seront populaires en 2020</a></li>
<li><a href="../fr483676/index.html">Évaluation de l'efficacité et du coût de la mise en œuvre d'un système d'analyse marketing de bout en bout</a></li>
<li><a href="../fr483678/index.html">Développement de programmes Python extrêmement rapides</a></li>
<li><a href="../fr483680/index.html">Défauts de programmation courants à éviter</a></li>
<li><a href="../fr483684/index.html">PHP Digest n ° 171 (1 - 13 janvier 2020)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>