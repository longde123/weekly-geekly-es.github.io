<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üíÜüèª üßïüèΩ ‚öΩÔ∏è Java Eastern European Conference 2018: relat√≥rios e impress√µes üë®üèæ‚Äçüíª ü§πüèæ üà∏</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Postado por Igor Masternaya, Desenvolvedor S√™nior, DataArt Java Community Leader 

 De 18 a 19 de maio, o JEE√ëonf foi realizado em Kiev, um dos evento...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Java Eastern European Conference 2018: relat√≥rios e impress√µes</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/dataart/blog/412941/"><img src="https://habrastorage.org/webt/yg/-q/5j/yg-q5j1vqjcwmaqigggiuqll1yk.jpeg"><br><br>  <i>Postado por Igor Masternaya, Desenvolvedor S√™nior, DataArt Java Community Leader</i> <br><br>  De 18 a 19 de maio, o JEE√ëonf foi realizado em Kiev, um dos eventos mais esperados para toda a comunidade Java da Europa Oriental.  A DataArt fez parceria com a confer√™ncia.  Oradores de todo o mundo falaram em quatro est√°gios: Volker Simonis, representante da SAP na <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">JCP</a> e colaborador do OpenJDK, J√ºrgen H√∂ller, engenheiro-chefe da Pivotal, pai do amado Spring Framework, Klaus Ibsen, criador do Apache Camel, e Hugh McKee, evangelista da Lightbend. <br><br>  A programa√ß√£o foi muito movimentada: em dois dias, mais de 50 apresenta√ß√µes, 45 minutos cada.  10 minutos de intervalo - e corra para um novo relat√≥rio.  Levar√° muito tempo para assistir a todos os v√≠deos quando eles aparecerem na rede.  Portanto, descreverei brevemente os relat√≥rios que achei mais interessantes e que visitei pessoalmente. <a name="habracut"></a><br><br><h3>  15 anos de primavera </h3><br>  A confer√™ncia foi aberta por J√ºrgen H√∂ller.  Ele falou sobre a hist√≥ria de 15 anos (!) Do Spring Framework, desde as configura√ß√µes XML ‚Äúfavoritas‚Äù na vers√£o 0.9 at√© o reativo Spring WebFlux, que surgiu de projetos de pesquisa influenciados pelo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Manifesto Reativo</a> .  J√ºrgen falou sobre a coexist√™ncia do Spring MVC e Spring WebFlux no Spring WEB, explicou por que eles decidiram n√£o integr√°-los.  O fato √© que a principal abstra√ß√£o do Spring MVC √© a API Servlet 3.0 e o IO de bloqueio, enquanto o Spring WebFlux usa a abstra√ß√£o de Streams Reativos e o IO sem bloqueio.  Voc√™ pode executar seu servi√ßo no SpringWebFlux em qualquer servidor que suporte IO sem bloqueio: Netty, novas vers√µes do Tomcat (&gt; 8.5), Jetty.  Criar controladores WebFlux reativos n√£o √© muito diferente de cri√°-los usando o Spring MVC, mas ainda existem diferen√ßas.  Ao processar uma solicita√ß√£o do usu√°rio, o controlador reativo n√£o a processa no sentido usual, mas cria um pipeline para processar a solicita√ß√£o.  O distribuidor chama o m√©todo do controlador, que cria um pipeline e o fornece imediatamente como um fluxo do editor.  O fluxo do editor no Reactive Spring √© apresentado como duas abstra√ß√µes: Flux / Mono.  O fluxo retorna um fluxo de objetos, enquanto o Mono sempre retorna um √∫nico objeto. <br><br>  J√ºrgen tamb√©m mencionou a conveni√™ncia de usar o estilo Java 8 ao trabalhar com o Spring 5.0 e prometeu um candidato ao lan√ßamento do Spring 5.1 em julho de 2018 e um lan√ßamento em setembro, que oferecer√° suporte ao Java 11 e funcionar√° no ajuste fino dos novos recursos do Spring 5.0 <br><br><h3>  Integra√ß√£o Python / Java </h3><br>  Havia muitos relat√≥rios, e escolher o mais interessante no pr√≥ximo slot era dif√≠cil.  As descri√ß√µes eram igualmente interessantes, por isso confiei em meus instintos e decidi ouvir Tamas Rozman, vice-presidente da BlackRock da Hungria.  Mas seria melhor se eu escutasse novamente sobre o Sourcing de Eventos e o CQRS.  A julgar pela descri√ß√£o, a empresa est√° envolvida na Data Science para um grande fundo de investimento.  O objetivo do relat√≥rio era mostrar como eles criaram um sistema escal√°vel e est√°vel, igualmente conveniente para analistas de dados com seu Python e para desenvolvedores Java do sistema principal.  No entanto, parecia-me duvidoso que o sistema constru√≠do realmente se mostrasse conveniente.  Para fazer amizade com Python e Java, os engenheiros da BlackRock tiveram a id√©ia de iniciar um int√©rprete Python como um processo a partir de um aplicativo Java.  Eles chegaram a isso por v√°rias raz√µes: <br><ul><li>  O Jython (Python na JVM) n√£o se encaixou devido √† base de c√≥digo desatualizada 2.7 vs CPython 3.6. </li><li>  Eles consideraram a op√ß√£o de reescrever a l√≥gica da Ci√™ncia de Dados em Java como um processo muito longo. </li><li>  O Apache Spark decidiu n√£o aceitar, porque, como o orador explicou, voc√™ n√£o pode misturar cargas de trabalho escritas em Java e Python.  Embora n√£o esteja claro por que a UDF e a UDFA n√£o se encaixam [ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">2</a> ].  Al√©m disso, o Spark n√£o se encaixava, porque eles j√° tinham algum tipo de estrutura de trabalho e realmente n√£o queriam introduzir uma nova.  E, como se viu, eles tamb√©m n√£o t√™m Big Data e todo o processamento se resume a estat√≠sticas de pat√©ticos arquivos de 100 MB. </li></ul><br><br>  A comunica√ß√£o do Java com o processo Python foi organizada usando arquivos mapeados na mem√≥ria (um arquivo √© usado como arquivo de dados de entrada) e comandos (o segundo arquivo √© a sa√≠da do processo Python).  Assim, a comunica√ß√£o era algo na forma de: <br><br><pre>  Java: calcExr |  1 + javaFunc (sqrt (36))
 Python: 1 + javaFunct | 6
 Java: 1 + sucesso | 64
 Python: sucesso |  65 </pre><br><br>  Os principais problemas dessa integra√ß√£o, Tamas chamou de sobrecarga durante a serializa√ß√£o e desserializa√ß√£o dos par√¢metros de entrada / sa√≠da. <br><br><img src="https://habrastorage.org/webt/zz/l9/vt/zzl9vtuqxaff5kn7rvdqtpgsbey.jpeg"><br><br><h3>  CDS do aplicativo Java 10 </h3><br>  Ap√≥s uma apresenta√ß√£o sobre os meandros da execu√ß√£o do Python, eu realmente queria ouvir algo profundamente t√©cnico do mundo Java.  Ent√£o, fui ao relat√≥rio de Volker Simonis, no qual ele falou sobre o recurso de compartilhamento de dados da classe Application do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Java 10+</a> .  No mundo moderno, constru√≠do em microsservi√ßos no Docker, a capacidade de compartilhar Java Codecache e Metaspace acelera o lan√ßamento do aplicativo e economiza mem√≥ria.  A imagem mostra os resultados do lan√ßamento de tomates dockerized com um arquivo compartilhado / compartilhado das classes Tomcat.  Como voc√™ pode ver, para o segundo processo, algumas p√°ginas na mem√≥ria j√° est√£o marcadas como shared_clean - o que significa que o processo atual e pelo menos um processo (o segundo tomcat em execu√ß√£o) se refere a eles. <br><br><img src="https://habrastorage.org/webt/4b/wf/hc/4bwfhctgsicnp_ulp-r0fo08opm.png"><br><br>  Detalhes sobre como jogar com o CDS no OpenJDK 10 podem ser encontrados em: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">App CDS</a> .  Al√©m de dividir as classes de aplicativos entre os processos, no futuro est√° planejado o compartilhamento de cadeias <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">internas</a> no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">JEP-250</a> . <br>  Principais limita√ß√µes do AppCDS: <br><br>  N√£o funciona com classes de at√© 1,5. <br><ul><li>  Voc√™ n√£o pode usar classes carregadas de arquivos (apenas arquivos .jar). </li><li>  Classes modificadas pelo carregador de classes n√£o podem ser usadas. </li><li>  Classes carregadas por v√°rios carregadores de classe podem ser reutilizadas apenas uma vez. </li><li>  A reescrita do c√≥digo de bytes n√£o funciona, o que pode levar a quedas de desempenho de at√© 2%.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">JDK-8074345</a> </li></ul><br><br><img src="https://habrastorage.org/webt/ql/id/ll/qlidll3gw8_b91uclq8onav6s3g.jpeg"><br><br><h3>  Pipeline de processamento de idioma natural com Apache Spark </h3><br>  O relat√≥rio sobre a PNL e o Apache Spark foi apresentado por Vitaliy Kotlyarenko - engenheiro da Grammarly.  Vitaliy mostrou como a Grammarly prot√≥tipo de NLP-Jobs no Apache Zeppelin.  Um exemplo foi a constru√ß√£o de um pipeline simples para modelagem tem√°tica com base no algoritmo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">LDA</a> do arquivo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">comum da</a> Internet de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">rastreamento</a> .  Os resultados da modelagem de t√≥picos foram usados ‚Äã‚Äãpara filtrar sites com conte√∫do inadequado, como um exemplo da fun√ß√£o de controle dos pais.  Para criar o pipeline, usamos os scripts Terraform e o cluster do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">AWS EMR</a> Spark, que permitem implantar o Spark Cluster com o YARN na Amazon.  Esquematicamente, o pipeline fica assim: <br><br><img src="https://habrastorage.org/webt/p6/m7/wp/p6m7wpmj43z9dyesvyjfptjf3z4.png"><br><br>  O objetivo do relat√≥rio era mostrar que o uso de estruturas modernas para criar um prot√≥tipo para tarefas de ML √© bastante simples; no entanto, usando bibliotecas padr√£o, voc√™ ainda encontra dificuldades.  Por exemplo: <br><ul><li>  Na primeira etapa da leitura dos arquivos WARC usando a biblioteca <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">HadoopInputFormat</a> , o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">IllegalStateExceptions</a> √†s vezes <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">travava</a> devido a cabe√ßalhos de arquivo incorretos, a biblioteca precisava ser reescrita e os arquivos incorretos ignorados. </li><li>  As depend√™ncias da goiaba - a biblioteca de defini√ß√£o de linguagem - colidiram com as depend√™ncias que o Spark arrasta consigo mesma.  O Java 8 ajudou, com a ajuda da qual foi poss√≠vel lan√ßar depend√™ncias na goiaba na biblioteca usada. </li></ul><br><br>  Durante a demonstra√ß√£o, monitoramos a execu√ß√£o da tarefa usando a interface do usu√°rio padr√£o do Spark e o subsistema de monitoramento <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Ganglia</a> , que fica automaticamente dispon√≠vel quando implantado no AWS EMR.  O autor concentrou-se no Server Load Distribution, que mostra a distribui√ß√£o de carga entre os n√≥s no cluster, e deu conselhos gerais sobre como otimizar o trabalho do Spark Job: aumentar o n√∫mero de parti√ß√µes, otimizar a serializa√ß√£o de dados e analisar os logs do GC.  Voc√™ pode ler mais sobre como otimizar trabalhos do Spark <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> .  Os arquivos de origem da demonstra√ß√£o podem ser encontrados no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">github do</a> autor do relat√≥rio. <br><br><h3>  Graal, Truffle, SubstrateVM e outras vantagens: o que s√£o e por que voc√™ precisa deles </h3><br>  O mais esperado para mim foi um relat√≥rio de Oleg Chirukhin do JUG.ru.  Ele contou como otimizar o c√≥digo finalizado usando o Graal.  O que √© o Graal?  The Grail √© uma marca do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Oracle Labs</a> que combina o compilador JIT (just-in-time), a estrutura para escrever linguagens DSL - Truffle - e a JVM especial ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">SubstrateVM</a> ) - uma m√°quina virtual universal <a href="">de mundo fechado</a> na qual voc√™ pode escrever em JavaScript, Ruby, Python, Java, Scala.  O relat√≥rio enfocou o compilador JIT e seus testes em produ√ß√£o. <br><br>  Primeiro, lembre-se do processo de execu√ß√£o de c√≥digo pela m√°quina Java e observe que o Java j√° possui dois compiladores: C1 (compilador do cliente) e C2 (compilador do servidor).  Graal pode ser usado como um compilador C2. <br><br><img src="https://habrastorage.org/webt/3k/qk/lt/3kqklt1q02gtnej89a0wa2ttou0.png"><br><br>  Quando perguntado por que precis√°vamos de outro compilador, um dos funcion√°rios do Oracle Labs, Dr. Chris Seaton, respondeu muito bem no artigo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Entendendo como Graal Funciona</a> .  Em resumo, a id√©ia original do projeto Graal, bem como do projeto <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Metropolis</a> , √© reescrever partes do c√≥digo da JVM escrito em C ++ em Java.  Isso tornar√° poss√≠vel no futuro complementar convenientemente o c√≥digo.  Por exemplo, uma das otimiza√ß√µes - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">An√°lise de escape artificial</a> - j√° est√° no Graal, mas n√£o no Hotspot - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">porque expandir o c√≥digo Graal √© muito mais f√°cil do que o c√≥digo C2</a> . <br><br>  Parece √≥timo, mas como isso funcionar√° na pr√°tica no meu projeto, voc√™ pergunta?  Graal √© adequado para projetos: <br><br><ul><li>  Que desarrumam muito, criando muitos objetos pequenos. </li><li>  Escrito no estilo do Java 8, com um monte de fluxos e lambdas. </li><li>  Usando linguagens diferentes: Ruby, Java, R. </li></ul><br><br>  Um dos primeiros em produ√ß√£o, o Graal come√ßou a ser usado no Twitter.  Voc√™ pode ler mais sobre isso em uma entrevista com Christian Talinger, publicada em Habr√© ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">entrevista_1</a> e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">entrevista_2</a> ).  L√°, ele explica que, ao substituir o C2 pelo Graal, o Twitter come√ßou a economizar cerca de 8% da utiliza√ß√£o da CPU, o que √© bastante bom, considerando o tamanho da organiza√ß√£o. <br><br>  Na confer√™ncia, tamb√©m pudemos verificar a velocidade do Graal lan√ßando um dos pontos de refer√™ncia da Scala - o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Scala DaCapo</a> .  Como resultado, no Graal, a refer√™ncia passou em ~ 7000 ms e em uma JVM regular em ~ 14000 ms!  Por que isso aconteceu, voc√™ pode ver olhando para os testes do gclog.  O n√∫mero de falhas na Aloca√ß√£o ao usar o Graal √© significativamente menor que o do Hotspot.  No entanto, voc√™ ainda n√£o pode dizer que o Graal ser√° a solu√ß√£o para os problemas de desempenho do seu aplicativo Java.  Oleg tamb√©m mostrou uma hist√≥ria de fracasso em seu relat√≥rio, comparando o trabalho do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Apache Ignite</a> sob o Graal e sem ele - n√£o houve altera√ß√£o percept√≠vel no desempenho. <br><br><img src="https://habrastorage.org/webt/wg/a9/9i/wga99iykqcg8ubellwz6_upyy9o.jpeg"><br><br><h3>  Projetando microsservi√ßos tolerantes a falhas </h3><br>  Outro relat√≥rio sobre arquitetura de microsservi√ßo √† prova de falhas foi lido por Orkhan Gasimov do AppsFlyer.  Ele introduziu padr√µes de design populares para criar aplicativos distribu√≠dos.  Podemos muito bem conhecer muitos deles, mas andar por a√≠ e relembrar cada um deles n√£o vai doer nada. <br><br>  Os principais problemas de toler√¢ncia a falhas de servi√ßos com os quais os padr√µes descritos no relat√≥rio s√£o chamados a combater s√£o: rede, picos de carga, mecanismos RPC de comunica√ß√£o entre servi√ßos. <br>  Para resolver problemas com a rede, quando um dos servi√ßos n√£o estiver mais dispon√≠vel, precisamos da capacidade de substitu√≠-lo rapidamente por outro.  Na pr√°tica, isso pode ser conseguido com v√°rias inst√¢ncias do mesmo servi√ßo e uma descri√ß√£o de caminhos alternativos para essas inst√¢ncias, que √© um padr√£o de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">descoberta de servi√ßo</a> .  Envolver-se em servi√ßos de <b>pulsa√ß√£o</b> e registrar novos servi√ßos ser√° uma inst√¢ncia separada - Service Registry.  √â costume usar o conhecido <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">tratador</a> ou <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">c√¥nsul</a> como registro de servi√ßo.  Os quais, por sua vez, tamb√©m t√™m uma natureza distribu√≠da e suportam toler√¢ncia a falhas. <br><br>  Tendo resolvido os problemas com a rede, passamos ao problema de picos de carga quando alguns servi√ßos est√£o sob carga e processam solicita√ß√µes muito mais lentamente do que o modo normal.  Para resolv√™-lo, voc√™ pode usar o padr√£o de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">dimensionamento autom√°tico</a> .  Ele assumir√° n√£o apenas a tarefa de dimensionar automaticamente servi√ßos altamente carregados, mas tamb√©m interromper√° as inst√¢ncias ap√≥s o per√≠odo de pico de carregamento. <br><br>  O cap√≠tulo final do relat√≥rio do autor era uma descri√ß√£o de poss√≠veis problemas de comunica√ß√£o interna entre servi√ßos da RPC.  Urahan prestou aten√ß√£o especial √† tese "O usu√°rio n√£o deve esperar por uma mensagem de erro por muito tempo".  Essa situa√ß√£o pode surgir se sua solicita√ß√£o for processada pela cadeia de servi√ßos e o problema estiver no final da cadeia: consequentemente, o usu√°rio pode esperar que a solicita√ß√£o seja processada por cada um dos servi√ßos da cadeia e apenas no √∫ltimo est√°gio receber um erro.  O pior de tudo √© que, se o servi√ßo final estiver sobrecarregado e, ap√≥s uma longa espera, o cliente receber√° um HTTP-ERROR: 500 sem sentido. <br><br>  Para combater essas situa√ß√µes, voc√™ pode usar <b>Timeout</b> s, no entanto, solicita√ß√µes que ainda podem ser processadas corretamente podem cair no tempo limite.  Para fazer isso, a l√≥gica de tempo limite pode ser complicada e um valor limite especial para o n√∫mero de erros de servi√ßo por intervalo de tempo pode ser adicionado.  Quando o n√∫mero de erros excede o valor limite, entendemos que o servi√ßo est√° sob carga e o consideramos indispon√≠vel, proporcionando o tempo necess√°rio para lidar com as tarefas atuais.  Esta abordagem descreve o padr√£o do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">disjuntor</a> .  Voc√™ tamb√©m pode usar o CircuitBreaker.html "&gt; Circuit Beaker como uma m√©trica adicional para o monitoramento, o que permite responder rapidamente a poss√≠veis problemas e identificar claramente quais cadeias de servi√ßo est√£o enfrentando. Para fazer isso, cada chamada de servi√ßo deve estar envolvida no disjuntor. <br><br>  Tamb√©m no relat√≥rio, o autor lembrou o padr√£o de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">redund√¢ncia N-Modular</a> , projetado para "processar solicita√ß√µes mais rapidamente, se poss√≠vel", e forneceu um belo exemplo de seu uso para validar o endere√ßo de um cliente.  A solicita√ß√£o em seu sistema atrav√©s do cache de endere√ßos foi enviada imediatamente a v√°rios provedores de mapas geogr√°ficos, como resultado da qual a resposta mais r√°pida venceu. <br><br>  Al√©m dos padr√µes descritos, foram mencionados os seguintes: <br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Padr√£o <b>Fast Path</b></a> , que pode ser aplicado, por exemplo, ao armazenar em cache os resultados da consulta.  O acesso ao cache √© o caminho r√°pido. </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><b>Error Kernel</b> pattern</a> - um padr√£o do mundo de Akka que envolve dividir uma tarefa em subtarefas e delegar subtarefas a atores posteriores.  Dessa maneira, a flexibilidade de processar erros de execu√ß√£o de subtarefa √© alcan√ßada. </li><li>  <b>Instance Healer</b> , que assume a exist√™ncia de um servi√ßo especial - um supervisor que gerencia outros servi√ßos e responde a mudan√ßas em seu estado.  Por exemplo, em caso de erros no servi√ßo, o supervisor pode reiniciar o servi√ßo problem√°tico. </li></ul><br><br><img src="https://habrastorage.org/webt/am/ik/kr/amikkrgoxhuaajndqk1zgfhv12u.jpeg"><br><br><h3>  Fornecimento de Eventos em Cluster e CQRS com Akka e Java </h3><br>  O √∫ltimo relat√≥rio que quero chamar sua aten√ß√£o foi lido por um dos arquitetos e evangelistas de Lightbend Hugh McKee.  Lightbend (anteriormente Typesafe) √© algo como Oracle, mas para a linguagem Scala.  A empresa tamb√©m est√° desenvolvendo ativamente a estrutura <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Akka.io.</a>  Em um relat√≥rio, Hugh falou sobre a implementa√ß√£o da popular abordagem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">CQRS</a> (Command Query Responsibility Commands / SEGREGATION) na estrutura Akka.  Esquematicamente, a arquitetura do sistema CQRS fica assim: <br><br><img src="https://habrastorage.org/webt/n-/jy/in/n-jyin0xfhmrsqxlixxwh478ot0.png"><br><br>  Hugh tomou o prot√≥tipo de um banco como exemplo de sistema em funcionamento.  Um cliente na arquitetura CQRS executa duas opera√ß√µes: consulta, comando.  Cada equipe (por exemplo, uma transa√ß√£o banc√°ria que transfere dinheiro de uma conta para outra) gera um evento (um fato consumado) que ser√° registrado na EventStore (por exemplo: Cassandra).  A agrega√ß√£o da cadeia (depositar dinheiro em uma conta, transferir conta a conta, sacar em um caixa eletr√¥nico) de eventos forma o estado atual do cliente, seu saldo de dinheiro na conta.  As solicita√ß√µes para o estado atual v√£o para um reposit√≥rio separado, uma captura instant√¢nea do reposit√≥rio de eventos, pois n√£o faz sentido manter um hist√≥rico completo de uma conta banc√°ria.  √â suficiente atualizar periodicamente o elenco de status para cada usu√°rio. <br><br>  Essa abordagem possibilita a recupera√ß√£o autom√°tica quando ocorrem erros: para isso, precisamos obter a √∫ltima convers√£o do estado do usu√°rio e aplicar a ele todos os eventos que ocorreram antes do erro.  Devido √† presen√ßa de dois armazenamentos, a arquitetura do CQRS tolera bem os picos de carga (picos) emergentes.  Um grande n√∫mero de eventos carregar√° o Armazenamento de Eventos, mas n√£o afetar√° o Armazenamento de Leitura, e os usu√°rios ainda poder√£o atender √†s consultas no banco de dados. <br><br>  Vamos voltar √† cria√ß√£o de prot√≥tipos do sistema banc√°rio no Akka e no CQRS.  Cada cliente do banco / conta / equipe poss√≠vel no sistema ser√° representado por um (!) <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Ator</a> .  Um grande banco pode suportar centenas de milhares de contas, e isso n√£o ser√° um problema para a Akka.  A estrutura pronta para uso suporta cluster e pode ser executada em centenas de JVMs.  Se uma das m√°quinas do cluster falhar, a Akka fornecer√° mecanismos especiais que respondem automaticamente a essas situa√ß√µes: no nosso caso, o ator do cliente pode ser recriado novamente em qualquer m√°quina dispon√≠vel no cluster e seu status ser√° lido novamente no reposit√≥rio. <br><br>  Um encadeamento separado n√£o √© criado para um ator - isso possibilita suportar dezenas de milhares de atores em uma √∫nica JVM.  Ao mesmo tempo, o ator garante que cada solicita√ß√£o seja processada separadamente (!) Na ordem de recebimento das solicita√ß√µes.  Essa garantia elimina automaticamente poss√≠veis condi√ß√µes de corrida ao processar solicita√ß√µes.  Voc√™ pode entender o prot√≥tipo do sistema em mais detalhes, abrindo seu c√≥digo usando os links no GitHub.  Cada subprojeto mostra a implementa√ß√£o dos est√°gios mais complexos da constru√ß√£o de um prot√≥tipo: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Atores distribu√≠dos O clustering akka</a> √© um exemplo simples de cria√ß√£o do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">cluster Akka '</a> a. </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">O singleton do cluster Akka</a> mostra como implementar um padr√£o singleton em um ambiente Akka distribu√≠do. </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Sharding distribu√≠do por entidade O shark de cluster akka</a> √© um exemplo de gerenciamento da distribui√ß√£o de entidades em um cluster e do roteamento de solicita√ß√µes de clientes. </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">CQRS - Write side akka persistence</a> - registra eventos no reposit√≥rio. </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">CQRS - Consulta de persist√™ncia akka do lado da leitura</a> - processando solicita√ß√µes do cliente </li></ul>  vespas. <br><br>  Os registros de todos os relat√≥rios aparecer√£o online dentro de algumas semanas.  Espero que este artigo o ajude a determinar a ordem de exibi√ß√£o, principalmente porque acho que vale a pena assistir √†s apresenta√ß√µes. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt412941/">https://habr.com/ru/post/pt412941/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt412927/index.html">O que ver no fim de semana: 5 filmes sobre hackers</a></li>
<li><a href="../pt412929/index.html">Resumo da Fintech: as leis de criptomoeda aprovadas pela DG que n√£o s√£o consistentes com os especialistas, as solu√ß√µes da fintech est√£o se tornando mais populares</a></li>
<li><a href="../pt412933/index.html">Tesla abriu parcialmente o c√≥digo-fonte para o Modelo S / X 2018.12</a></li>
<li><a href="../pt412937/index.html">Demo hack: O PenTest Show mostrar√° como √© f√°cil invadir a rede do escrit√≥rio e os sistemas de seguran√ßa para roubar qualquer coisa</a></li>
<li><a href="../pt412939/index.html">Testadores contra testes</a></li>
<li><a href="../pt412945/index.html">Gerentes de depend√™ncia</a></li>
<li><a href="../pt412947/index.html">Carregar teste na nuvem do Azure. Como testar uma grande loja online em condi√ß√µes pr√≥ximas ao real?</a></li>
<li><a href="../pt412949/index.html">Astr√≥logos anunciam semana de desenvolvimento iOS no Avito</a></li>
<li><a href="../pt412951/index.html">DotVVM - Comunica√ß√£o entre cliente e servidor</a></li>
<li><a href="../pt412953/index.html">Calibra√ß√£o da c√¢mera Intel RealSense d435 usando OpenCV2 e ROS</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>