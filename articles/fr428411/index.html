<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üé∑ ‚úäüèΩ üïµüèΩ Radar technologique: une liste de langages, d'outils et de plateformes qui sont pass√©s entre les mains de Lamoda üë©üèº‚Äçü§ù‚Äçüë®üèª ‚ôàÔ∏è ‚õ©Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dans les commentaires sur notre dernier article , il y avait beaucoup de questions sur les technologies que nous utilisons. Dans cet article, je - Igo...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Radar technologique: une liste de langages, d'outils et de plateformes qui sont pass√©s entre les mains de Lamoda</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/lamoda/blog/428411/">  Dans les commentaires <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">sur notre dernier article</a> , il y avait beaucoup de questions sur les technologies que nous utilisons.  Dans cet article, je - Igor Mosyagin, d√©veloppeur R&amp;D de Lamoda - je vais vous en parler.  Sous la coupe, vous trouverez une liste exhaustive des langages, outils, plateformes et technologies qui sont pass√©s entre nos mains.  Le frontend, le backend, la base de donn√©es, les courtiers de messages, les caches et la surveillance, le d√©veloppement et l'√©quilibrage sont une histoire d√©taill√©e de ce que nous utilisons aujourd'hui et de ce que nous avons abandonn√©. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/631/247/aab/631247aab11173978faf7c3f35cf4c74.png"><br><br>  Mes coll√®gues et moi sommes pr√™ts √† discuter dans les commentaires ou sur le stand de l'entreprise √† HighLoad ++ 2018. <br><a name="habracut"></a><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://radar.thoughtworks.com/%3FsheetId%3D">Voir le radar en grand et d√©taill√© ici.</a> <br><br>  Comme nous l'avons d√©j√† dit, un grand nombre de technologies et d'outils diff√©rents sont impliqu√©s dans Lamoda.  Et ce n'est pas un hasard.  Sinon, nous ne pouvons pas faire face √† la charge!  Nous avons un grand entrep√¥t automatis√©.  Notre centre d'appels est desservi par 500 employ√©s, et les processus que nous avons construits nous permettent de rappeler le client dans les 5 minutes apr√®s avoir pass√© la commande.  Notre service de livraison fonctionne √† des intervalles de 15 minutes.  Mais en plus de nos propres syst√®mes, nous avons une int√©gration B2B avec d'autres magasins en ligne.  Avec une telle vari√©t√© de t√¢ches et les exigences d'une entreprise aussi dynamique que le commerce √©lectronique, la croissance de la pile technique est in√©vitable, car nous voulons r√©soudre chaque probl√®me avec les technologies les plus adapt√©es.  La diversit√© est in√©vitable.  Nous parlerons des principaux repr√©sentants de notre pile ci-dessous.  Mais commen√ßons par des m√©canismes qui nous permettent de ne pas nous perdre dans cette vari√©t√©. <br><br><h2>  Les bases de l'architecture </h2><br>  Nous √©voluons activement vers une architecture de microservices.  La plupart des syst√®mes ont d√©j√† √©t√© construits conform√©ment √† cette id√©ologie - il y a deux ans, nous avons travers√© une phase de transition avec nos probl√®mes et leurs solutions.  Mais nous ne nous attarderons pas sur les d√©tails de ce processus - un rapport d'Andrey Evsyukov " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Caract√©ristiques des microservices sur l'exemple d'une plate-forme e-Com</a> " en dira beaucoup plus √† ce sujet. <br><br>  Afin de ne pas aggraver la diversit√© technologique, nous avons introduit une ¬´dictature des pratiques √©prouv√©es¬ª, selon laquelle il est recommand√© aux cr√©ateurs de nouvelles puces d'utiliser les technologies et outils d√©j√† utilis√©s quelque part dans l'entreprise.  La plupart des services communiquent entre eux via l'API (nous utilisons notre modification de la deuxi√®me version de la norme JSONRPC), mais lorsque la logique m√©tier le permet, nous utilisons √©galement le bus de donn√©es pour l'interaction. <br><br>  L'utilisation d'autres technologies n'est pas interdite.  Cependant, toute nouvelle id√©e doit √™tre test√©e dans un comit√© d'architecture sp√©cialement cr√©√©, qui comprend des dirigeants des principaux domaines. <br><br>  Compte tenu de la proposition suivante, le comit√© donne le feu vert √† l'exp√©rience ou propose une sorte de remplacement de la pile existante.  Soit dit en passant, cette d√©cision d√©pend en grande partie des circonstances actuelles de l'entreprise.  Par exemple, si une √©quipe arrive la veille de la vente du Black Friday et annonce qu'elle introduira une technologie dans la production dont le comit√© n'avait jamais entendu parler auparavant, elle sera tr√®s probablement refus√©e.  D'un autre c√¥t√©, la m√™me exp√©rience peut recevoir le feu vert si une nouvelle technologie ou un nouvel outil est introduit dans des circonstances commerciales moins critiques, et la mise en ≈ìuvre commencera par des tests en dehors de la production. <br><br>  Le comit√© d'architecture est √©galement responsable de la maintenance du radar technologique, en effectuant les changements n√©cessaires tous les 2-3 mois.  L'un des objectifs de cette ressource est de donner aux √©quipes une id√©e du type d'expertise dont l'entreprise dispose d√©j√†. <br><br>  Mais passons au plus int√©ressant - √† l'analyse des secteurs de notre radar. <br><br>  Il convient de noter que nous utilisons une interpr√©tation l√©g√®rement non standard des cat√©gories d'adoption des technologies: <br><br><ul><li>  ADOPTER - technologies et outils qui sont mis en ≈ìuvre et activement utilis√©s; <br></li><li>  TRIAL - technologies et outils qui ont d√©j√† pass√© la phase de test et se pr√©parent √† travailler avec la production (ou m√™me y travaillent d√©j√†); <br></li><li>  √âVALUER - outils d'essai qui sont en cours d'√©valuation et qui n'affectent pas encore la production.  Avec leur participation, seuls des projets tests sont mis en ≈ìuvre; <br></li><li>  HOLD - dans cette cat√©gorie, nous avons une expertise, mais les outils mentionn√©s ne sont utilis√©s qu'avec le soutien de syst√®mes existants - de nouveaux projets ne sont pas lanc√©s sur eux. <br></li></ul><br><h2>  D√©veloppement </h2><br><img src="https://habrastorage.org/getpro/habr/post_images/486/47d/0e7/48647d0e7dd4e562c7802a04854c4247.png"><br><br><h3>  PHP - Python - Aller </h3><br>  Le premier langage sur lequel nous voulons nous attarder est PHP.  Aujourd'hui, il ne r√©sout qu'une partie des t√¢ches de backend du magasin, et au d√©part, tout le backend fonctionnait sur PHP.  Alors que l'entreprise se d√©veloppait sur le front-end, un manque de vitesse et de productivit√© est devenu perceptible - √† l'√©poque, nous utilisions PHP 5, donc Python l'a remplac√© (d'abord 2.x, puis 3.x).  Cependant, PHP vous permet d'√©crire des mod√®les commerciaux riches, donc ce langage est rest√© dans le back-office pour automatiser divers processus op√©rationnels, en particulier l'int√©gration avec des magasins en ligne tiers ou des services de livraison, ainsi que l'automatisation d'un studio de contenu qui √©tablit des fiches produits.  Maintenant, nous utilisons d√©j√† PHP 7. En PHP, nous avons √©crit de nombreuses biblioth√®ques √† usage interne: int√©gration et wrappers sur notre infrastructure, couche d'int√©gration entre les services, divers helpers r√©utilis√©s.  Le premier lot de biblioth√®ques a d√©j√† √©t√© mis en open source sur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">notre github.com</a> , et le reste, le plus "m√ªri", arrivera bient√¥t.  L'une des premi√®res √©tait une machine √† √©tats, qui, pr√©sente dans presque toutes les applications, s'assure qu'avec la commande avant d'envoyer toutes les actions n√©cessaires. <br><br>  Au fil du temps, Python est √©galement devenu insuffisant pour un backend de magasin.  Maintenant, nous pr√©f√©rons un Go plus productif et plus l√©ger. <br><br>  Peut-√™tre que la transition vers Go a √©t√© un changement important, car elle a permis d'√©conomiser beaucoup de mat√©riel et de ressources humaines - l'efficacit√© a consid√©rablement augment√©.  Les premiers √† avoir r√©alis√© les premiers projets sur Go √©taient RnD, ils ne voulaient pas g√©rer les limitations techniques de Python.  Ensuite, dans l'√©quipe de d√©veloppement mobile, il y avait des gens qui le connaissaient et l'avaient promu √† la production.  D'apr√®s leur soumission, nous avons effectu√© des tests et avons √©t√© plus que satisfaits du r√©sultat.  Dans des cas distincts, apr√®s qu'une partie du projet a √©t√© r√©√©crite de Python to Go, le chargement des n≈ìuds de cluster a consid√©rablement diminu√©.  Par exemple, la r√©√©criture du moteur de calcul de remise pour le panier de Python to Go nous a permis de traiter 8 fois plus de demandes avec les m√™mes capacit√©s mat√©rielles, et le temps de r√©ponse moyen de l'API a √©t√© r√©duit de 25 fois.  C'est-√†-dire  Go s'est av√©r√© √™tre plus efficace que Python (si vous l'√©crivez correctement), m√™me si ce n'est pas si pratique pour le d√©veloppeur. <br><br>  Le d√©veloppement mobile devant interagir avec des dizaines d'API internes, un g√©n√©rateur de code a √©t√© cr√©√© qui, selon la description du service API (selon la sp√©cification Swagger), un client peut g√©n√©rer sur Go.  Ainsi, Go a progressivement commenc√© √† correspondre aux services et outils existants, en particulier ceux qui ont cr√©√© le ¬´goulot d'√©tranglement¬ª pour la charge.  En plus de faciliter la vie du d√©veloppeur de backend mobile, nous avons simplifi√© les conventions internes suivantes sur la fa√ßon de d√©velopper des API, comment nommer des m√©thodes, comment passer des param√®tres, etc.  Cette standardisation a facilit√© le d√©veloppement et la mise en ≈ìuvre de nouveaux services pour toutes les √©quipes. <br><br>  Aujourd'hui, Go est d√©j√† utilis√© presque partout - dans toutes les interactions en temps r√©el avec les utilisateurs - dans le backend du site et des applications mobiles, ainsi que les services auxquels ils sont associ√©s.  Et l√† o√π il n'y a pas besoin de traitement et de r√©ponse rapides, par exemple dans les t√¢ches d'interaction avec l'entrep√¥t de donn√©es, Python reste, car il n'a pas d'√©gal pour les t√¢ches de traitement des donn√©es (bien qu'il y ait une p√©n√©tration de Go ici). <br><br>  Comme vous pouvez le voir sur le radar, nous avons Java dans l'actif.  Il est utilis√© dans le syst√®me de gestion d'entrep√¥t (WMS), aidant √† r√©cup√©rer rapidement les commandes.  Jusqu'√† pr√©sent, nous avons une pile assez ancienne et un ancien mod√®le d'architecture - un monolithe tournant sur Wildfly 10 et 8 Hotspot Java, et il y a √©galement un client distant et riche sur la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">plate-forme d'application Netbeans</a> (maintenant cette fonctionnalit√© est transf√©r√©e sur le Web).  Ici, dans notre arsenal, nous avons des stockages standard pour l'entreprise et m√™me notre propre surveillance.  Malheureusement, nous n'avons pas trouv√© d'outil permettant de bien visualiser le fonctionnement de l'entrep√¥t et les processus importants sur celui-ci (lorsqu'une section est surcharg√©e, par exemple), et nous en avons fait un nous-m√™mes. <br><br>  Nous utilisons Python comme langage principal pour l'apprentissage automatique: nous construisons des syst√®mes de recommandation et classons le catalogue, corrige les fautes de frappe dans les requ√™tes de recherche et r√©solvons √©galement d'autres probl√®mes en conjonction avec Spark sur un cluster Hadoop (PySpark).  Python nous aide √† automatiser le calcul des m√©triques internes et les tests AB. <br><br><h3>  D√©veloppement frontend et mobile </h3><br>  L'interface de la boutique en ligne de bureau, ainsi que des sites mobiles, est √©crite en JavaScript.  Maintenant, le frontend passe progressivement √† la sp√©cification ES6, cr√©ant de nouveaux projets conform√©ment √† celle-ci.  Nous utilisons vue.js comme framework principal, mais nous y reviendrons plus en d√©tail dans la section outils. <br><br>  Le d√©veloppement d'applications pour les plates-formes mobiles est une unit√© distincte de l'entreprise, qui comprend des groupes backend, ainsi que des applications Android et iOS avec leurs propres piles et outils technologiques, qui, en raison des diff√©rences de plate-forme, sont loin d'√™tre toujours possibles d'unifier √† travers l'ensemble de l'unit√©. <br><br>  Depuis deux ans maintenant, tout nouveau d√©veloppement Android est en cours sur Kotlin, ce qui nous permet d'√©crire du code plus concis et compr√©hensible.  Parmi les fonctionnalit√©s les plus couramment utilis√©es, nos d√©veloppeurs appellent: smartcast, classes scell√©es, fonctions d'extension, constructeurs typesafe (DSL), fonctionnalit√© stdlib. <br><br>  Le d√©veloppement iOS est en cours sur Swift, qui a remplac√© Objective-C. <br><br><h2>  Langues sp√©ciales </h2><br>  La gamme de t√¢ches de Lamoda ne se limite pas au d√©veloppement d'une "vitrine" pour diff√©rentes plates-formes, respectivement, nous avons un certain nombre de langues qui sont utilis√©es uniquement dans leurs syst√®mes, fonctionnent bien l√†-bas, mais ne seront pas impl√©ment√©es dans d'autres parties de l'infrastructure: <br><br><ul><li>  R - utilis√© pour le traitement des donn√©es et les scripts de reporting dans le cadre de la Business Intelligence (BI).  Il n'est pas en production et il n'est plus utilis√© pour de nouvelles t√¢ches, mais nous avons encore un certain nombre de ces scripts.  En r√©solvant les probl√®mes avec R, nous avons r√©alis√© que ce langage n'est pas destin√© aux applications tr√®s charg√©es.  Dans de nouvelles t√¢ches, nous utilisons Python et d'autres technologies incompatibles avec R. <br></li><li>  Scala - utilis√© par le bureau de d√©veloppement de Vilnius pour d√©velopper un syst√®me d'automatisation de centre d'appels.  Initialement, ce syst√®me a √©t√© √©crit en PHP, mais lors de la transition vers une architecture de microservice, un certain nombre de composants ont √©t√© r√©√©crits en Scala.  √âgalement l√†-dessus, l'√©quipe d'ing√©nierie des donn√©es √©crit des travaux Spark. <br></li><li>  TypeScript que nous examinons.  La livraison est d√©j√† impl√©ment√©e avec son aide, et √† l'avenir, nous utiliserons TypeScript + vue.js sur le frontend. <br></li><li>  Lua est utilis√© pour configurer nginx (via l'API nginx), dans d'autres projets il ne l'est pas et ne le sera jamais. <br></li><li>  Nous sommes une entreprise de mode et suivons la mode de la programmation fonctionnelle.  Par exemple, un √©mulateur de dispositif de tri dans l'un de nos entrep√¥ts est √©crit en Haskell. <br></li></ul><br><h2>  Gestion des donn√©es </h2><br><img src="https://habrastorage.org/getpro/habr/post_images/4b3/e03/071/4b3e03071fbd703b0a21b6c6bd6ea380.png"><br><br><h3>  SGBD, recherche et analyse de donn√©es </h3><br>  Comme beaucoup, les bases de donn√©es les plus diverses que nous avons mises en ≈ìuvre sur PostgreSQL - elles sont utilis√©es partout o√π des bases de donn√©es relationnelles sont n√©cessaires, par exemple, pour stocker un r√©pertoire.  Il est assez facile de trouver des sp√©cialistes de cette technologie, de plus, de nombreux services diff√©rents sont disponibles. <br><br>  Bien s√ªr, PostgreSQL n'est pas le seul SGBD que l'on puisse trouver dans notre infrastructure informatique.  Sur certains syst√®mes plus anciens, par exemple, MySQL est utilis√©, tandis que WMS a un peu de MongoDB.  Cependant, pour des charges et une mise √† l'√©chelle √©lev√©es (en tenant compte du reste de notre pile technologique), nous ne les utilisons pas pour de nouveaux projets.  En g√©n√©ral, PostgreSQL est notre tout. <br><br>  L'Aerospike est √©galement visible sur le radar.  Nous l'avons utilis√© assez activement, mais le contrat de licence a chang√© pour le produit, donc la version ¬´notre¬ª s'est av√©r√©e un peu coup√©e.  Cependant, maintenant nous l'avons de nouveau regard√©.  Peut-√™tre allons-nous reconsid√©rer notre attitude vis-√†-vis de l'instrument et l'utiliser plus activement.  D√©sormais, Aerospike est utilis√© dans le service d'agr√©gation d'√©v√©nements de visualisation de pages et le travail de l'utilisateur avec le panier, ainsi que dans le service de protection sociale (¬´5 personnes ont ajout√© ce produit aux favoris cette semaine¬ª).  Maintenant, nous faisons des recommandations encore plus fortes √† ce sujet. <br><br>  Apache Solr est utilis√© pour rechercher des donn√©es de production.  En parall√®le, nous utilisons √©galement ElasticSearch.  Les deux solutions sont open source, mais si plus t√¥t, lorsque nous impl√©mentions simplement la recherche, Apache Solr poss√©dait d√©j√† la troisi√®me ou la quatri√®me version et √©tait en d√©veloppement actif, et ElasticSearch n'avait m√™me pas la premi√®re version stable - il √©tait trop t√¥t pour l'utiliser en production.  Maintenant, les r√¥les ont chang√© - il est beaucoup plus facile de trouver des solutions pour ElasticSearch, et de nouvelles personnes sont venues vers nous qui sont capables de le pr√©parer.  Cependant, dans le prod, nous avons Solr, et nous ne passerons pas √† une autre solution au moins avant le Black Friday 2018. <br><br><img src="https://habrastorage.org/webt/e-/zv/yt/e-zvytvyg9cp2fnsux3xiwvec8c.png"><br>  <i>Comparaison de la dynamique des requ√™tes de recherche Apache Solr (bleu) et ElasticSearch (rouge), selon Google Trends</i> <br><br>  L'analyse des donn√©es se produit dans plusieurs syst√®mes, en particulier, nous utilisons activement Apache Hadoop.  Dans le m√™me temps, le SGBD de la colonne Vertica est utilis√© pour stocker des data marts (avec un volume total d'environ 4 To).  Sur ces vitrines, des rapports financiers, op√©rationnels et commerciaux sont construits.  Pour bon nombre de nos t√¢ches ETL, nous utilisions auparavant Luigi, mais nous passons maintenant √† Apache Airflow.  Nous utilisons √©galement Pentaho pour le stockage relationnel, dans lequel il y a environ un millier de t√¢ches ETL r√©guli√®res. <br><br>  Une partie de l'analyse et de la pr√©paration des donn√©es pour d'autres syst√®mes est effectu√©e dans Spark.  √Ä certains endroits, il s'agit non seulement d'un outil d'analyse, mais √©galement d'une partie de notre architecture lambda. <br><br>  Les syst√®mes ERP jouent un r√¥le important dans l'infrastructure informatique: Microsoft Dynamics AX et 1C.  En tant que SGBD, Microsoft SQL Server est utilis√©.  Et pour le reporting, ses composants, tels que les services d'analyse et les services de reporting. <br><br><h3>  Mise en cache </h3><br>  Pour la mise en cache, nous utilisons Redis.  Auparavant, cette t√¢che √©tait effectu√©e par MemCached, elle ne pouvait pas √™tre utilis√©e comme stockage de valeur de cl√© avec un vidage p√©riodique sur le disque, nous l'avons donc abandonn√©e. <br><br><h3>  Files d'attente de messages </h3><br>  En tant que courtier d'√©v√©nements, nous utilisons deux outils √† la fois - Apache Kafka et RabbitMQ. <br>  Apache Kafka est un outil qui nous permet de traiter des dizaines de milliers de messages dans divers syst√®mes o√π la messagerie est n√©cessaire.  Des clusters Kafka distincts sont d√©ploy√©s pour certaines parties tr√®s charg√©es du syst√®me - par exemple, pour les √©v√©nements utilisateur ou la journalisation (nous avions un bon <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">rapport sur la journalisation √† Highload ++ 2017</a> ).  Kafka vous permet de faire face √† 6000 mille messages en vrac par seconde avec une utilisation minimale de fer. <br><br>  Dans les syst√®mes internes, nous utilisons RabbitMQ pour les actions diff√©r√©es. <br><br><h2>  Plateformes et infrastructure </h2><br><img src="https://habrastorage.org/getpro/habr/post_images/7f3/766/c97/7f3766c97395b3578d4375f441c1d1ce.png"><br><br><h3>  Livraison continue </h3><br>  Pour le d√©ploiement, Kubernetes est utilis√©, qui a remplac√© le bundle Nomad + Consul de Hashicorp.  La pile pr√©c√©dente fonctionnait tr√®s mal avec les mises √† niveau mat√©rielles.  Lorsque notre √©quipe Ops a chang√© les serveurs physiques sur lesquels les n≈ìuds tournaient et les conteneurs ont √©t√© stock√©s, il s'est r√©guli√®rement cass√© et s'est √©cras√©, ne voulant pas augmenter.  Il n'y avait pas de version stable √† l'√©poque.  De plus, nous n‚Äôutilisions pas la derni√®re version en date, la 0.5.6, qui devait encore √™tre mise √† jour.  La mise √† niveau vers la derni√®re version b√™ta a n√©cessit√© quelques travaux.  Par cons√©quent, il a √©t√© d√©cid√© de l'abandonner et de passer aux Kubernetes les plus populaires. <br><br>  D√©sormais, Nomad et Consul sont toujours utilis√©s en assurance qualit√©, mais √† l'avenir, il devrait √©galement d√©m√©nager √† Kubernetes. <br><br>  Pour impl√©menter la livraison continue, des conteneurs Docker sont utilis√©s, vers lesquels nous avons migr√© il y a deux ans.  Pour nos services tr√®s charg√©s (panier, catalogue, site Web, syst√®me de gestion des commandes), la capacit√© de r√©cup√©rer rapidement plusieurs conteneurs suppl√©mentaires d'un service est importante, nous avons donc des conteneurs partout.  Et Docker est l'une des m√©thodes de conteneurisation les plus populaires, donc sa pr√©sence sur le radar est assez logique. <br><br>  En tant que serveur de g√©n√©ration et int√©gration continue, Bamboo est d√©ploy√©, utilis√© en conjonction avec Jira et Bitbucket (pile standard). <br><br>  Jenkins est √©galement mentionn√© dans le radar.  Nous l'avons exp√©riment√©, mais nous ne le tra√Ænerons pas dans de nouveaux projets.  C'est un excellent outil, mais il ne tient tout simplement pas dans notre pile car nous avons d√©j√† Bamboo. <br><br>  Les conteneurs dockers collect√©s en bambou sont stock√©s dans le r√©f√©rentiel sous le contr√¥le d'Artifactory. <br><br><h3>  Gestion et √©quilibrage des processus </h3><br>  Nous utilisons NGINX Plus, mais pas en termes d'√©quilibrage, car ses m√©triques ne sont pas suffisantes pour nos t√¢ches.  Il ne peut pas dire, par exemple, quelle demande est le plus souvent achemin√©e ou bloqu√©e.  Par cons√©quent, HAProxy est utilis√© pour √©quilibrer la charge.  Il peut fonctionner rapidement et efficacement en conjonction avec nginx, sans charger le processeur et la m√©moire.  De plus, les mesures dont nous avons besoin sont ici pr√™tes √† l'emploi - HAproxy peut afficher des statistiques par n≈ìuds, par le nombre de connexions √† l'heure actuelle, par la fa√ßon dont la bande passante est occup√©e et bien plus encore. <br><br>  UWSGI est utilis√© pour ex√©cuter des applications Python synchrones.  Php-fpm a √©t√© utilis√© comme gestionnaire de processus sur tous les services PHP. <br><br><h3>  Suivi </h3><br>  Nous utilisons Prometheus pour collecter des m√©triques de nos applications et machines h√¥tes (machines virtuelles), ainsi que de la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">base de donn√©es de s√©ries chronologiques pour l'application</a> .  Nous collectons des journaux, pour cela, nous utilisons la pile ELK, en tant que syst√®me d'alerte, nous utilisons Icinga, qui est configur√© pour ELK et Prometheus.  Elle envoie des alertes par mail et SMS.  Le service d'assistance 6911 re√ßoit les m√™mes alertes et d√©cide d'attirer des ing√©nieurs de garde. <br><br>  Prometheus est impliqu√© presque partout, et pour cela, nous avons des biblioth√®ques pour tous les langages, qui permettent d'utiliser seulement quelques lignes de code pour connecter ses m√©triques au projet.  Par exemple, une biblioth√®que pour PHP <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">est disponible en Open Source</a> ). <br><br>  Pour afficher visuellement les r√©sultats de la surveillance sous la forme de magnifiques tableaux de bord, Grafana est utilis√©.  Fondamentalement, nous collectons tous les tableaux de bord de Prometheus, bien que parfois d'autres syst√®mes puissent √©galement servir de sources. <br><br>  Pour d√©tecter et agr√©ger automatiquement les erreurs, nous utilisons Sentry, qui est int√©gr√© √† Jira et facilite le d√©marrage d'un traqueur de t√¢ches pour chacun des probl√®mes de production.  Il sait comment capturer l'erreur avec un retour en arri√®re et des informations suppl√©mentaires, il est donc pratique de commencer. <br><br>  Les statistiques sur le code des demandes d'extraction cr√©√©es sont collect√©es √† l'aide de SonarQube. <br><br><h2>  Cadres et outils </h2><br><img src="https://habrastorage.org/getpro/habr/post_images/e26/88a/e33/e2688ae33a6efe4be82eee1bea2d1384.png"><br><br>  Lors du d√©veloppement de l'infrastructure informatique de Lamoda, nous avons exp√©riment√© pr√®s de trois douzaines d'outils diff√©rents, cette cat√©gorie est donc la plus ¬´√† grande √©chelle¬ª de notre radar.  √Ä ce jour, sont activement utilis√©s: <br><br><ul><li>  Symfony 3.x, et plus r√©cemment - Symfony 4.x - pour le d√©veloppement en PHP; <br></li><li>  Django et le moteur de mod√®le Jinja pour le d√©veloppement Python.  Soit dit en passant, Jinja est utilis√©, y compris, pour la configuration dans Ansible; <br></li><li>  Flask - pour les services internes (avec Django), mais en production, nous ne le faisons pas glisser; <br></li><li>  Spring - dans le d√©veloppement Java; <br></li><li>  Bootstrap - pour une vari√©t√© d'outils internes dans le d√©veloppement Web (panneau d'administration, tableaux de bord faits maison, etc.); <br></li><li>  jQuery - pour le d√©veloppement js; <br></li><li>  OpenAPI (Swagger) - pour la documentation de tous les services API, y compris  qui sont utilis√©s pour la g√©n√©ration de code ci-dessus sur Go; <br></li><li>  Webpack - pour empaqueter JS et minimiser CSS; <br></li><li>  S√©l√©nium - pour tester le frontend; <br></li><li>  WireMock, JMeter, Allure et autres sont √©galement utilis√©s dans les tests; <br></li><li>  Ansible - pour la gestion de la configuration; <br></li><li>  Kibana - pour visualiser les r√©sultats de recherche dans ElasticSearch. <br></li></ul><br>  Je voudrais parler s√©par√©ment du d√©veloppement JavaScript.  Nous, comme beaucoup, avons tout un champ d'exp√©riences.    JavaScript   .               ‚Äî Angular, ReactJS, vue.js.   ¬´ ¬ª, ,  vue.js,        ,     . <br><br><h2>    </h2><br>         ,     GO, PHP, Java, JavaScript,    PostgreSQL,    Docker  Kubernetes. <br><br> ,       .   ,         ,       .   -,        .      ,     ,   ,    . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr428411/">https://habr.com/ru/post/fr428411/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr428395/index.html">Le livre ¬´Minimum th√©orique pour le Big Data. Tout ce que vous devez savoir sur le Big Data ¬ª</a></li>
<li><a href="../fr428401/index.html">Processus de d√©veloppement √† travers les yeux de l'exploitation. Un regard de l'autre c√¥t√© de la barricade</a></li>
<li><a href="../fr428403/index.html">Le condens√© des √©v√©nements pour les professionnels des RH dans le domaine des TI pour novembre 2018</a></li>
<li><a href="../fr428407/index.html">6 parcelles typiques de la litt√©rature mondiale</a></li>
<li><a href="../fr428409/index.html">Analyse des incidents du 21 octobre sur Github</a></li>
<li><a href="../fr428413/index.html">Syst√®mes de refroidissement dans les centres de donn√©es Selectel</a></li>
<li><a href="../fr428415/index.html">Pr√©sentation du contr√¥leur cloud TP-Link Omada OC200</a></li>
<li><a href="../fr428417/index.html">Apprentissage automatique dans MatLab / Octave: exemples d'algorithmes pris en charge par les formules</a></li>
<li><a href="../fr428419/index.html">Faites glisser et faites glisser dans RecyclerView. Partie 2: glisser-d√©poser des contr√¥leurs, des grilles et des animations personnalis√©es</a></li>
<li><a href="../fr428421/index.html">Syst√®me flexible pour tester et collecter des m√©triques de programme en utilisant la suite de tests LLVM comme exemple</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>