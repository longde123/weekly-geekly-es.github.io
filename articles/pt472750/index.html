<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üòÖ üî≤ üôáüèº OK, eu realmente preciso do Kubernetes? ü•â üöÅ üèùÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Em uma grande empresa, muitas vezes √© muito dif√≠cil coordenar a aloca√ß√£o de recursos para tarefas de trabalho. Todo o Agile esmagando a parede de um c...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>OK, eu realmente preciso do Kubernetes?</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/croccloudteam/blog/472750/"><img src="https://habrastorage.org/webt/hy/2c/vl/hy2cvliq-ytpomgzdyw0qwnm7uk.png"><br><br>  Em uma grande empresa, muitas vezes √© muito dif√≠cil coordenar a aloca√ß√£o de recursos para tarefas de trabalho.  Todo o Agile esmagando a parede de um contrato de tr√™s semanas com o IS da nova infraestrutura.  Portanto, geralmente recebemos solicita√ß√µes para transferir a infraestrutura para cont√™ineres, a fim de implementar as altera√ß√µes n√£o uma vez a cada tr√™s meses e quando a empresa precisar.  Ao mesmo tempo, eles pedem para configurar / implementar o Kubernetes como o instrumento mais popular de orquestra√ß√£o, embora, como mostra a pr√°tica, de 10 projetos, sejam necess√°rios no m√°ximo tr√™s.  Mas, na verdade, vale a pena usar o Kubernetes, mas o OpenShift, ou trabalhar com ele n√£o em sua infraestrutura, mas em uma nuvem p√∫blica, por exemplo.  Vou tentar falar sobre os casos reais de neg√≥cios que decidimos, descreverei as principais diferen√ßas entre o Kubernetes e o OpenShift.  E tamb√©m sobre como reduzimos a coordena√ß√£o da seguran√ßa da informa√ß√£o para 30 minutos e todos continuamos vivos. <br><br>  Tivemos v√°rias implementa√ß√µes interessantes nas quais resolvemos os problemas acumulados do cliente.  Por exemplo, uma empresa de varejo veio at√© n√≥s e precisava lan√ßar novos chips continuamente.  A competi√ß√£o √© louca!  E eles s√≥ t√™m infraestrutura para desenvolvimento cada vez que leva de seis a dez dias, o que causa tempo de inatividade.  Resolver o problema comprando um novo hardware para teste e desenvolvimento √© caro e o caminho para lugar nenhum.  Como resultado, transferimos a infraestrutura de TI para a virtualiza√ß√£o de cont√™ineres.  Como resultado, gra√ßas aos cont√™ineres, a carga foi reduzida em 40% e a infraestrutura para o novo desenvolvimento agora est√° sendo preparada de uma a quatro horas.  O b√¥nus √© a economia, uma vez que todos os processos podem continuar sendo conduzidos com base nas capacidades existentes sem a compra de novas. <a name="habracut"></a><br><br><h3>  O que vamos fazer com seguran√ßa da informa√ß√£o? </h3><br>  IB s√£o pessoas muito necess√°rias.  Eles costumam ir um pouco longe demais em seus requisitos internos para projetos, mas isso √© muito melhor do que ver uma vez que seu servidor SFTP externo foi cercado por hackers romenos. <br><br>  Mas h√° um problema com eles.  Se considerarmos o processo de neg√≥cios como um transportador, sua divis√£o geralmente se torna o gargalo em que todos os demais se baseiam.  Por um lado, eles s√£o respons√°veis ‚Äã‚Äãpor todos os riscos associados √† seguran√ßa, por outro, eles simplesmente n√£o conseguem visualizar fisicamente manualmente o c√≥digo e todos os detalhes da arquitetura do novo produto. <br><br>  A situa√ß√£o √© muito semelhante aos servi√ßos de seguran√ßa em √°reas com um grande fluxo de pessoas.  Podemos organizar uma inspe√ß√£o total de cada passageiro no metr√¥, enfiando-o nos scanners, revirando os bolsos e inspecionando o telefone.  Como resultado, no entanto, em vez de seguran√ßa, voc√™ obter√° um colapso total do transporte e uma paralisia do sistema.  A √∫nica op√ß√£o nessa situa√ß√£o √© a organiza√ß√£o de sistemas automatizados que responder√£o, digamos, a indiv√≠duos, identificando pessoas procuradas ou reagindo a algum comportamento anormal. <br><br>  Em nosso contexto, esses sistemas automatizados s√£o processos de CI / CD adequadamente organizados com analisadores de c√≥digo em est√°gios intermedi√°rios, solu√ß√µes como o JFrog Xray for Artifactory e porcas Kubernetes / OpenShift corretamente apertadas que n√£o permitem abordagens inseguras, como o lan√ßamento de um cont√™iner pelo usu√°rio raiz.  Agora estamos preparando uma solu√ß√£o in a box que fornecer√° tudo isso. <br><br>  O objetivo √© passar do conceito de "n√£o entrar√° na venda at√© examinarmos" para "se n√£o houver obje√ß√µes, ele ser√° implantado automaticamente".  N√£o h√° sentido em automa√ß√£o se os processos organizacionais permanecerem os mesmos. <br><br>  Em um dos projetos, conseguimos reduzir o tempo de falha de SI para 30 minutos.  Em outras palavras, se em meia hora o "guarda de seguran√ßa" n√£o rejeitar a a√ß√£o, ser√° automaticamente acordado e as altera√ß√µes ser√£o lan√ßadas em produ√ß√£o.  Agora, estamos tentando atingir um prazo de 60 minutos para todos os coordenadores do projeto sem comprometer a seguran√ßa. <br><br><h3>  Qual √© a diferen√ßa entre sistemas de gerenciamento de cont√™ineres? </h3><br>  Kubernetes e OpenShift s√£o as principais solu√ß√µes para orquestra√ß√£o de cont√™ineres.  Vamos analisar as principais diferen√ßas e vantagens para os neg√≥cios. <br><br>  <b>Abertura</b> <br><br>  O Kubernetes √© um produto totalmente aberto que pode ser implantado de forma independente e atendido por conta pr√≥pria ou com suporte externo.  A situa√ß√£o no mercado de trabalho j√° est√° mais ou menos estabilizada, e encontrar especialistas nesse t√≥pico n√£o √© mais um problema. <br><br>  O OpenShift √© um produto semi-fechado com um sofisticado sistema de licenciamento da RedHat.  De fato, ele cont√©m Kubernetes, mas possui v√°rias liga√ß√µes adicionais que simplificam muitas tarefas.  O fornecedor fornece suporte pago integral ao seu produto. <br><br>  Aqui, a escolha depende do que melhor lhe convier - apoio das for√ßas de seus especialistas ou fornecedores. <br><br>  <b>Plataformas</b> <br><br>  O Kubernetes funciona em quase qualquer plataforma Linux e na maioria dos provedores de nuvem. <br><br>  O OpenShift n√£o funciona em nenhum lugar, exceto no RHEL, Red Hat Atomic, Red Hat CoreOS.  Existe uma vers√£o da comunidade - OKD, mas est√° fortemente ligada √†s distribui√ß√µes.  A √∫nica exce√ß√£o √© que ele pode ser instalado no CentOS.  E lembre-se de que oficialmente a Red Hat n√£o garante suporte pago. <br><br>  <b>Pol√≠ticas de seguran√ßa</b> <br><br>  O OpenShift pronto para uso possui configura√ß√µes de seguran√ßa mais r√≠gidas.  Essa √© uma vantagem ao implantar a infraestrutura do zero, mas pode ser um problema devido √† incompatibilidade de algumas imagens com os pol√≠ticos.  Por exemplo, no OpenShift, √© proibido executar o cont√™iner a partir da raiz, o que quebra a compatibilidade com imagens antigas.  Por outro lado, essa abordagem, combinada com a integra√ß√£o conveniente com o AD, o registro conveniente com base na pilha EFK (ElasticSearch, Fluentd, Kibana) nos oferece a seguran√ßa imediata necess√°ria para descarregar a unidade IS. <br><br>  O Kubernetes tamb√©m pode ser finalizado para esse n√≠vel, mas exigir√° muito esfor√ßo e tempo da parte dos engenheiros. <br><br>  <b>Padr√µes</b> <br><br>  Os modelos do OpenShift s√£o menos flex√≠veis que os gr√°ficos do Kubernetes Helm.  Devido a pol√≠ticas de seguran√ßa mais rigorosas, a Red Hat n√£o pode fornecer a flexibilidade dos gr√°ficos Helm no momento.  No entanto, no OpenShift 4, a situa√ß√£o se estabilizou gra√ßas ao <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">OperatorHub</a> integrado. <br><br>  Ter modelos bem projetados prontos para uso facilita a vida.  De fato, essa √© uma op√ß√£o do gerenciador de pacotes para criar e configurar v√°rios servi√ßos. <br><br>  Um comando condicional ‚Äúhelm install prometheus-operator‚Äù implementa um sistema bastante complexo, que leva muito tempo para ser implementado.  Kubernetes est√° liderando o caminho. <br><br>  <b>Conclus√µes gerais</b> <br><br>  Como a maioria dos produtos, o Red Hat OpenShift √© uma solu√ß√£o mais in a box, mas arquiteturalmente mais dif√≠cil.  Exige menos funcion√°rios de olhos vermelhos e mais experientes para trabalhar.  Cen√°rios de implanta√ß√£o mais convenientes, excelente integra√ß√£o com solu√ß√µes de CI / CD, em particular com Jenkins.  O OpenShift √© √≥timo para empresas que s√£o mais f√°ceis de pagar para oferecer suporte a um produto acabado do que contratar seus pr√≥prios especialistas. <br><br>  Para empresas com fortes especialistas neste campo, o Kubernetes pode ser uma solu√ß√£o mais flex√≠vel e interessante.  Tamb√©m pode ser adequado para uma empresa relativamente pequena que deseja economizar nas licen√ßas da Red Hat, mas n√£o possui tarefas complexas que exigem especialistas altamente qualificados. <br><br><h2>  Casos reais </h2><br>  Vou tentar mostrar como as tecnologias de cont√™ineres ajudaram a resolver problemas de neg√≥cios, salvaram licen√ßas e garantiram a suaviza√ß√£o do pico de cargas durante ataques em massa a usu√°rios. <br><br><h4>  Estudo de caso: Com√©rcio eletr√¥nico </h4><br>  <b>O problema</b> <br><br>  O cliente tinha mais de 100 servi√ßos ativos executando a base de nuvem da VMware.  E todo esse parque teve v√°rios problemas diferentes: <br><br><ol><li>  12 servi√ßos que exigem recursos e sem margem foram lan√ßados no VMware, consumindo um or√ßamento de aproximadamente US $ 408.000 por ano. </li><li>  Tr√™s servi√ßos (um portal e dois aplicativos m√≥veis) come√ßaram a se desenvolver ativamente: ao longo de sete meses, a quantidade de recursos necess√°rios para o trabalho aumentou 4,5 vezes e continua a crescer. </li><li>  V√°rios servi√ßos ao cliente t√™m picos de carga, durante os quais os recursos s√£o necess√°rios seis a sete vezes mais do que nos per√≠odos normais.  Consequentemente, os equipamentos foram alocados para a opera√ß√£o correta, que na maioria das vezes era utilizada em menos de 15%. </li></ol><br>  Al√©m de tudo isso, o cliente deseja evitar a vincula√ß√£o a um fornecedor de virtualiza√ß√£o. <br><br>  <b>Nossa decis√£o</b> <br><br>  A primeira e mais simples solu√ß√£o: transferimos servi√ßos com picos para a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">nuvem p√∫blica do CROC</a> .  Com cobran√ßa por recursos consumidos.  Tudo √© o mais simples e chato poss√≠vel.  A mudan√ßa do VMware de algu√©m para o nosso KVM √© um dos casos mais frequentes para engenheiros de nuvem. <br><br>  Como o hardware para dimensionamento j√° foi adquirido pelo cliente, tivemos que calcular apenas as licen√ßas.  Para novos hosts da VMware, eles custam cerca de US $ 2.100.000, o que n√£o agradou muito ao cliente.  Propusemos transferir alguns dos servi√ßos para o KVM executando o OpenStack.  E para n√£o se perder, integre o gerenciamento de ambas as infra-estruturas pelo CloudForms (e ao mesmo tempo OpenShift). <br><br>  Como resultado, o cliente recebeu o segundo ombro de uma nuvem privada baseada no OpenStack, que encerrou a pergunta do fornecedor.  Ao mudar alguns dos servi√ßos que consomem muitos recursos para um novo local, reduziu o custo das licen√ßas VMware (o suporte 24x7 da CROC era mais barato). <br><br><h4>  Caso: Varejo </h4><br>  <b>O problema</b> <br><br>  Durante a auditoria, aconteceu que algo terr√≠vel estava acontecendo com o cliente em rela√ß√£o √† aloca√ß√£o de infraestrutura.  Projetos - mais de 250, equipes de desenvolvimento - mais de 150, meio cont√™ineres no Kubernetes.  Os recursos para cada novo projeto s√£o adquiridos e permanecem atribu√≠dos a ele sem a capacidade de selecionar, mesmo que n√£o sejam usados.  N√£o h√° cobran√ßa, n√£o existe um portal √∫nico.  Custos enormes para ambientes de teste e pr√©-produ√ß√£o, pois eles tamb√©m usam o VMware. <br><br>  Ao mesmo tempo, o cliente n√£o deseja mudar completamente para uma nova plataforma e deseja montar tudo em um √∫nico portal de gerenciamento.  Al√©m disso, ‚Äútudo‚Äù n√£o √© apenas VMware, mas tamb√©m PaaS, cont√™ineres e um √∫nico faturamento. <br><br>  <b>Nossa decis√£o</b> <br><br>  Como resultado, o interior da solu√ß√£o acabou sendo bastante amontoado, mas, para o cliente, tudo parece extremamente simples. <br><br>  O diret√≥rio em que o usu√°rio seleciona os par√¢metros da m√°quina virtual e o circuito necess√°rio: DevTest, PreProd, Prod.  E o CloudForms escolhe onde implantar o recurso solicitado: no VMware ou no OpenShift.  Ainda estamos trabalhando no faturamento √∫nico, pois a solu√ß√£o h√≠brida VMware + OpenShift √© bastante dif√≠cil de montar. <br><br>  De fato, dessa maneira, colocamos as coisas em ordem na infraestrutura, separando os escombros que o cliente empilhava. <br><br><h4>  Caso: Ind√∫stria </h4><br>  <b>O problema</b> <br><br>  A c√≥pia de VMs para v√°rios ambientes (Teste, Desenvolvimento, Produ√ß√£o, Pr√©-produ√ß√£o) leva mais de tr√™s dias e requer a execu√ß√£o manual de 15 opera√ß√µes diferentes, cada uma levando at√© 30 minutos.  Uma auditoria mais profunda mostrou que, anteriormente, eram necess√°rias duas semanas para alocar recursos para um novo projeto, e havia de 10 a 20 solicita√ß√µes por m√™s.  Agora, existem mais de dez solicita√ß√µes de recursos por dia, o que, sem automa√ß√£o, levou ao colapso. <br><br>  <b>Nossa decis√£o</b> <br><br>  De fato, o cliente precisava transferir a infraestrutura de TI para o modelo de servi√ßo, reconstruir e automatizar o processo de fazer altera√ß√µes na infraestrutura, criar um portal de autoatendimento, preench√™-lo com um cat√°logo de servi√ßos e implementar um ambiente para gerenciar aplicativos em cont√™iner.  Automatizamos o processo de c√≥pia da VM, mas ainda demorou muito tempo: 40 a 60 minutos, isso n√£o era adequado ao cliente.  Como resultado, propusemos a mudan√ßa para cont√™ineres, o que reduziu o tempo de c√≥pia para tr√™s a cinco minutos. <br><br><h3>  Conclus√µes </h3><br>  Cont√™iner e microsservi√ßos n√£o s√£o indulg√™ncias por c√≥digos incorretos que ser√£o gravados com o p√© esquerdo e voar√£o imediatamente para a produ√ß√£o.  Pelo contr√°rio, este √© um conceito completo, envolvendo v√°rias melhorias devido √† profunda automa√ß√£o de todos os processos: <br><br><ul><li>  O c√≥digo fica mais limpo: linter, analisadores de c√≥digo, testes automatizados. </li><li>  O c√≥digo e a arquitetura est√£o se tornando mais seguros: ferramentas de seguran√ßa com amplos recursos, at√© o bloqueio autom√°tico da implanta√ß√£o de c√≥digo n√£o seguro. </li><li>  Os servi√ßos est√£o se tornando mais flex√≠veis e m√≥veis: os ciclos de desenvolvimento agora s√£o extremamente curtos e respondem rapidamente √†s mudan√ßas. </li><li>  Escalonamento autom√°tico sob carga: seu recurso n√£o diminui mais na hora do rush, perdendo vendas e clientes. </li><li>  Aloca√ß√£o simples de recursos para novos projetos, redu√ß√£o do tempo gasto na coordena√ß√£o. </li><li>  Freq√ºentemente, a conteineriza√ß√£o pode reduzir significativamente o tempo de coloca√ß√£o no mercado. </li></ul><br>  E, √†s vezes, a conteineriza√ß√£o n√£o √© necess√°ria e o problema pode ser resolvido pela migra√ß√£o para uma nuvem externa.  Mas, para tomar uma decis√£o, em qualquer caso, precisamos de uma boa auditoria externa e an√°lise do que est√° acontecendo.  Em suma, os cont√™ineres s√£o apenas uma das ferramentas para resolver problemas de neg√≥cios, embora muito legais. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt472750/">https://habr.com/ru/post/pt472750/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt472736/index.html">Semin√°rio on-line aberto "Introdu√ß√£o √† automa√ß√£o de teste de aplicativos m√≥veis no Selenium e Appium"</a></li>
<li><a href="../pt472738/index.html">Como atualizar um projeto existente do ASP.NET MVC para o ASP.NET Core. Guia pr√°tico</a></li>
<li><a href="../pt472744/index.html">O MRP n√£o funciona ... Qual √© a alternativa?</a></li>
<li><a href="../pt472746/index.html">Servidor de terminal para administrador; Nem uma √∫nica lacuna SSH</a></li>
<li><a href="../pt472748/index.html">Navegador sem√¢ntico ou vida sem sites</a></li>
<li><a href="../pt472752/index.html">CSE: Kubernetes para qualquer pessoa no vCloud</a></li>
<li><a href="../pt472754/index.html">Como falar ingl√™s em um m√™s. 9 etapas f√°ceis e comprovadas</a></li>
<li><a href="../pt472758/index.html">Proposta: try - fun√ß√£o de verifica√ß√£o de erro integrada</a></li>
<li><a href="../pt472760/index.html">Reduza o tempo de computa√ß√£o de alguns anos para minutos. Compreendendo o aprendizado de m√°quina qu√¢ntica</a></li>
<li><a href="../pt472762/index.html">An√°lise t√©cnica da explora√ß√£o checkm8</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>