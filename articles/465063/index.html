<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üî® üòñ üòÄ Los 10 errores m√°s comunes al trabajar con la plataforma Spring. Parte 2 üë©üèæ‚Äçüç≥ üë©üèæ‚Äçü§ù‚Äçüë®üèª üëèüèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Saludo, Khabrovsk. Entonces, la traducci√≥n de la segunda parte de un art√≠culo preparado especialmente para los estudiantes del curso "Desarrollador en...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Los 10 errores m√°s comunes al trabajar con la plataforma Spring. Parte 2</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/465063/">  <i>Saludo, Khabrovsk.</i>  <i>Entonces, la traducci√≥n de la segunda parte de un art√≠culo preparado especialmente para los estudiantes del curso <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">"Desarrollador en el Marco de Primavera"</a> lleg√≥ a tiempo.</i>  <i>La primera parte se puede leer <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu√≠</a> .</i> <br><br><img src="https://habrastorage.org/webt/-i/va/66/-iva66o8uvrummnptqda3getv_i.png"><br><br><p>  <font color="gray">Spring es quiz√°s una de las plataformas de desarrollo de Java m√°s populares.</font>  <font color="gray">Esta es una herramienta poderosa, pero bastante dif√≠cil de aprender.</font>  <font color="gray">Sus conceptos b√°sicos son bastante f√°ciles de entender y aprender, pero lleva tiempo y esfuerzo convertirse en un desarrollador experimentado de Spring.</font> <font color="gray"><br><br></font>  <font color="gray">En este art√≠culo, veremos algunos de los errores m√°s comunes cometidos al trabajar en Spring y, en particular, relacionados con el desarrollo de aplicaciones web y el uso de la plataforma Spring Boot.</font>  <font color="gray">Como se se√±al√≥ en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">el sitio web de Spring Boot</a> , Spring Boot adopta un enfoque <i>estandarizado</i> para crear aplicaciones listas para usar, y este art√≠culo seguir√° este enfoque.</font>  <font color="gray">Dar√° una serie de recomendaciones que se pueden utilizar de manera efectiva en el desarrollo de aplicaciones web est√°ndar basadas en Spring Boot.</font> <font color="gray"><br><br></font>  <font color="gray">En caso de que no est√© muy familiarizado con la plataforma Spring Boot, pero quiera experimentar con los ejemplos de este art√≠culo, cre√© un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">repositorio de GitHub con materiales adicionales para este art√≠culo</a> .</font>  <font color="gray">Si en alg√∫n momento est√° un poco confundido mientras lee este art√≠culo, le aconsejar√≠a que cree un clon de este repositorio y experimente con el c√≥digo en su computadora.</font> </p><a name="habracut"></a><br><hr><br><h2>  Error com√∫n n. ¬∞ 6: no utilizar la validaci√≥n de datos basada en anotaciones </h2><br>  Imaginemos que nuestro servicio TopTalent de los ejemplos anteriores necesita un punto final para agregar nuevos datos TopTalent.  Adem√°s, supongamos que por alguna raz√≥n realmente importante, cada nombre que agregue debe tener exactamente 10 caracteres de longitud.  Esto se puede implementar, por ejemplo, de la siguiente manera: <br><br><pre><code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@RequestMapping</span></span>(<span class="hljs-string"><span class="hljs-string">"/put"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">addTopTalent</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(@RequestBody TopTalentData topTalentData)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">boolean</span></span> nameNonExistentOrHasInvalidLength = Optional.ofNullable(topTalentData) .map(TopTalentData::getName) .map(name -&gt; name.length() == <span class="hljs-number"><span class="hljs-number">10</span></span>) .orElse(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (nameNonExistentOrInvalidLength) { <span class="hljs-comment"><span class="hljs-comment">//   } topTalentService.addTopTalent(topTalentData); }</span></span></code> </pre> <br>  Sin embargo, el c√≥digo anterior no solo est√° mal estructurado, sino que en realidad no es una soluci√≥n "limpia".  Realizamos varios tipos de validaci√≥n de datos (es decir, verificamos que el objeto <code>TopTalentData</code> no <code>TopTalentData</code> nulo, que el valor del campo TopTalentData.name no es nulo y que la longitud del campo <code>TopTalentData.name</code> es de 10 caracteres), y tambi√©n lanzamos una excepci√≥n si los datos son incorrectos. <br><br>  Todo esto se puede hacer con mayor precisi√≥n utilizando el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">validador de Hibernate</a> en Spring.  Primero reescribamos el m√©todo <code>addTopTalent</code> , agregando soporte para la validaci√≥n de datos: <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@RequestMapping</span></span>(<span class="hljs-string"><span class="hljs-string">"/put"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">addTopTalent</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(@Valid @NotNull @RequestBody TopTalentData topTalentData)</span></span></span><span class="hljs-function"> </span></span>{ topTalentService.addTopTalent(topTalentData); } <span class="hljs-meta"><span class="hljs-meta">@ExceptionHandler</span></span> <span class="hljs-meta"><span class="hljs-meta">@ResponseStatus</span></span>(HttpStatus.BAD_REQUEST) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> ErrorResponse </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">handleInvalidTopTalentDataException</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(MethodArgumentNotValidException methodArgumentNotValidException)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//    }</span></span></code> </pre> <br>  Adem√°s, debemos indicar qu√© validaci√≥n de propiedad queremos realizar en la clase <code>TopTalentData</code> : <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TopTalentData</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Length</span></span>(min = <span class="hljs-number"><span class="hljs-number">10</span></span>, max = <span class="hljs-number"><span class="hljs-number">10</span></span>) <span class="hljs-meta"><span class="hljs-meta">@NotNull</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String name; }</code> </pre> <br>  Spring ahora interceptar√° la solicitud y la verificar√° antes de llamar al m√©todo, por lo que no se requerir√°n verificaciones manuales adicionales. <br><br>  El objetivo deseado tambi√©n se puede lograr creando sus propias anotaciones.  En condiciones reales, generalmente tiene sentido usar sus propias anotaciones solo cuando sus necesidades exceden las capacidades del <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">conjunto incorporado de restricciones de Hibernate</a> , pero para este ejemplo, imaginemos que <code>@Length</code> anotaciones <code>@Length</code> no existen.  Puede crear un validador de datos que verifique la longitud de una cadena creando dos clases adicionales: una para la validaci√≥n y otra para las propiedades de anotaci√≥n: <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Target</span></span>({ElementType.METHOD, ElementType.FIELD, ElementType.PARAMETER}) <span class="hljs-meta"><span class="hljs-meta">@Retention</span></span>(RetentionPolicy.RUNTIME) <span class="hljs-meta"><span class="hljs-meta">@Documented</span></span> <span class="hljs-meta"><span class="hljs-meta">@Constraint</span></span>(validatedBy = { MyAnnotationValidator.class }) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-meta"><span class="hljs-meta">@interface</span></span> MyAnnotation { <span class="hljs-function"><span class="hljs-function">String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">message</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">default</span></span></span><span class="hljs-function"> "String length does not match expected"</span></span>; Class&lt;?&gt;[] groups() <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> {}; Class&lt;? extends Payload&gt;[] payload() <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> {}; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">value</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; } <span class="hljs-meta"><span class="hljs-meta">@Component</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyAnnotationValidator</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ConstraintValidator</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyAnnotation</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">String</span></span></span><span class="hljs-class">&gt; </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> expectedLength; <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">initialize</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(MyAnnotation myAnnotation)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.expectedLength = myAnnotation.value(); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isValid</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String s, ConstraintValidatorContext constraintValidatorContext)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> s == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> || s.length() == <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.expectedLength; } }</code> </pre> <br><br>  Tenga en cuenta que en estos casos, la aplicaci√≥n correcta del principio de separaci√≥n de responsabilidad requiere marcar la propiedad como v√°lida si su valor es nulo <code>(s == null</code> en el m√©todo <code>isValid</code> ), y luego usar la anotaci√≥n <code>@NotNull</code> si esto es adicionalmente necesario para esta propiedad: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TopTalentData</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@MyAnnotation</span></span>(value = <span class="hljs-number"><span class="hljs-number">10</span></span>) <span class="hljs-meta"><span class="hljs-meta">@NotNull</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String name; }</code> </pre> <br><h2>  Error com√∫n n. ¬∞ 7: uso de configuraciones heredadas basadas en XML </h2><br>  El uso de XML era una necesidad cuando se trabajaba con versiones anteriores de Spring, pero ahora la mayor√≠a de las tareas de configuraci√≥n se pueden implementar utilizando c√≥digo Java y anotaciones.  Las configuraciones XML ahora act√∫an como c√≥digo de plantilla adicional y opcional. <br><br>  En este art√≠culo (as√≠ como en los materiales complementarios del repositorio de GitHub), las anotaciones se usan para configurar Spring, y Spring sabe qu√© componentes JavaBean deben vincularse porque el paquete ra√≠z se anota usando la anotaci√≥n compuesta @SpringBootApplication, de esta manera: <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@SpringBootApplication</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Application</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String[] args)</span></span></span><span class="hljs-function"> </span></span>{ SpringApplication.run(Application.class, args); } }</code> </pre> <br>  Esta anotaci√≥n compuesta (consulte la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">documentaci√≥n de Spring para obtener</a> m√°s informaci√≥n al respecto) simplemente le dice a la plataforma Spring qu√© paquetes escanear para extraer los componentes JavaBean.  En nuestro caso particular, esto significa que se utilizar√°n los siguientes subpaquetes de co.kukurin para la uni√≥n: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" class="user_link">Componente</a> (TopTalentConverter, MyAnnotationValidator) </li><li>  @RestController (TopTalentController) </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" class="user_link">Repositorio</a> (TopTalentRepository) </li><li>  Clases de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" class="user_link">servicio</a> (TopTalentService) </li></ul><br>  Si tenemos clases adicionales que tienen la anotaci√≥n <code>@Configuration</code> , tambi√©n se comprobar√° la configuraci√≥n de Java. <br><br><h2>  Error com√∫n # 8: no usar perfiles de configuraci√≥n </h2><br>  Cuando se desarrollan sistemas de servidor, un problema com√∫n es cambiar entre diferentes configuraciones (como regla, estas son configuraciones para los entornos operativos y de desarrollo).  En lugar de cambiar manualmente varios par√°metros en cada transici√≥n entre los modos de prueba y funcionamiento, es m√°s eficiente usar perfiles de configuraci√≥n. <br><br>  Imagine el caso cuando en el entorno de desarrollo local utiliza la base de datos en RAM, y en el entorno de la operaci√≥n real de su aplicaci√≥n, se utiliza la base de datos MySQL.  Esto significa esencialmente que utilizar√° diferentes URL y, presumiblemente, diferentes credenciales para acceder a cada una de estas bases de datos.  Veamos c√≥mo se puede implementar esto usando dos archivos de configuraci√≥n: <br><br>  <b>APLICACI√ìN DE ARCHIVO. YAML</b> <br><br><pre> <code class="java hljs"># set <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> profile to <span class="hljs-string"><span class="hljs-string">'dev'</span></span> spring.profiles.active: dev # production database details spring.datasource.url: <span class="hljs-string"><span class="hljs-string">'jdbc:mysql://localhost:3306/toptal'</span></span> spring.datasource.username: root spring.datasource.password:</code> </pre> <br><br>  <b>APLICACI√ìN DE ARCHIVO-DEV.YAML</b> <br><br><pre> <code class="java hljs">spring.datasource.url: <span class="hljs-string"><span class="hljs-string">'jdbc:h2:mem:'</span></span> spring.datasource.platform: h2</code> </pre> <br><br>  Debe suponerse que al trabajar con c√≥digo, no querr√° realizar algunas acciones aleatorias con una base de datos destinada al entorno operativo, por lo que tiene sentido seleccionar el perfil para el entorno de desarrollo (DEV) como el perfil predeterminado.  Posteriormente, puede anular manualmente el perfil de configuraci√≥n en el servidor especificando <code>-Dspring.profiles.active=prod</code> para la JVM.  Adem√°s, el perfil de configuraci√≥n predeterminado se puede especificar en la variable de entorno del sistema operativo. <br><br><h2>  Error com√∫n n√∫mero 9. Falla en el uso del mecanismo de inyecci√≥n de dependencia </h2><br>  El uso adecuado del mecanismo de inyecci√≥n de dependencias en Spring significa que Spring puede vincular todos sus objetos escaneando todas las clases de configuraci√≥n necesarias.  Esto es √∫til para aflojar las interdependencias y facilita enormemente las pruebas.  En lugar de vincular estrechamente las clases, algo como esto: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TopTalentController</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> TopTalentService topTalentService; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TopTalentController</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.topTalentService = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TopTalentService(); } }</code> </pre> <br>  ... permitimos que la plataforma Spring se una: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TopTalentController</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> TopTalentService topTalentService; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TopTalentController</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(TopTalentService topTalentService)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.topTalentService = topTalentService; } }</code> </pre> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">La conferencia de Mishko Hevery sobre el canal Google Tech Talks</a> explica en detalle por qu√© deber√≠a usarse la inyecci√≥n de dependencia, pero aqu√≠ veremos c√≥mo se usa este mecanismo en la pr√°ctica.  En la divisi√≥n de responsabilidad ("Error com√∫n # 3"), creamos las clases de servicio y controlador.  Supongamos que queremos probar un controlador, suponiendo que la clase <code>TopTalentService</code> funciona correctamente.  Podemos insertar un objeto simulador en lugar de la implementaci√≥n del servicio actual creando una clase de configuraci√≥n separada: <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Configuration</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SampleUnitTestConfig</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Bean</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> TopTalentService </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">topTalentService</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ TopTalentService topTalentService = Mockito.mock(TopTalentService.class); Mockito.when(topTalentService.getTopTalent()).thenReturn( Stream.of(<span class="hljs-string"><span class="hljs-string">"Mary"</span></span>, <span class="hljs-string"><span class="hljs-string">"Joel"</span></span>).map(TopTalentData::<span class="hljs-keyword"><span class="hljs-keyword">new</span></span>).collect(Collectors.toList())); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> topTalentService; } }</code> </pre> <br>  Despu√©s de eso, podemos implementar el objeto simulador <code>SampleUnitTestConfig</code> plataforma Spring que necesitamos usar <code>SampleUnitTestConfig</code> como fuente de configuraci√≥n: <br> <code>@ContextConfiguration(classes = { SampleUnitTestConfig.class })</code> <br> <br>  Posteriormente, esto nos permitir√° usar la configuraci√≥n contextual para incrustar el componente JavaBean personalizado en una prueba unitaria. <br><br><h2>  Error com√∫n n√∫mero 10. Falta de prueba o prueba incorrecta </h2><br>  A pesar de que la idea de las pruebas unitarias no es en absoluto nueva, parece que muchos desarrolladores ‚Äúse olvidan‚Äù (especialmente si no es <i>obligatorio</i> ) o la pasan demasiado tarde.  Obviamente, esto est√° mal, porque las pruebas no solo le permiten verificar el funcionamiento correcto del c√≥digo, sino que tambi√©n sirven como documentaci√≥n que muestra c√≥mo debe comportarse la aplicaci√≥n en diversas situaciones. <br>  Cuando prueba servicios web, rara vez ejecuta pruebas unitarias excepcionalmente "limpias", porque para una conexi√≥n HTTP generalmente necesita usar el servlet Spring <code>DispatcherServlet</code> y ver qu√© sucede cuando recibe una solicitud <code>HttpServletRequest</code> real (es decir, resulta una prueba de <i>integraci√≥n</i> que usa validaci√≥n, serializaci√≥n, etc.).  Una soluci√≥n elegante y probada es utilizar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">REST Assured</a> , una biblioteca Java para probar convenientemente los servicios REST, con MockMVC.  Considere el siguiente fragmento de c√≥digo con inyecci√≥n de dependencia: <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@RunWith</span></span>(SpringJUnit4ClassRunner.class) <span class="hljs-meta"><span class="hljs-meta">@ContextConfiguration</span></span>(classes = { Application.class, SampleUnitTestConfig.class }) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RestAssuredTestDemonstration</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Autowired</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> TopTalentController topTalentController; <span class="hljs-meta"><span class="hljs-meta">@Test</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">shouldGetMaryAndJoel</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> Exception </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// given MockMvcRequestSpecification givenRestAssuredSpecification = RestAssuredMockMvc.given() .standaloneSetup(topTalentController); // when MockMvcResponse response = givenRestAssuredSpecification.when().get("/toptal/get"); // then response.then().statusCode(200); response.then().body("name", hasItems("Mary", "Joel")); } }</span></span></code> </pre> <br>  <code>SampleUnitTestConfig</code> vincula la implementaci√≥n sustitutiva de la clase <code>TopTalentService</code> al <code>TopTalentController</code> , y todas las dem√°s clases se enlazan utilizando la configuraci√≥n est√°ndar obtenida escaneando paquetes basados ‚Äã‚Äãen el paquete de la clase Aplicaci√≥n.  <code>RestAssuredMockMvc</code> usa simplemente para configurar un entorno ligero y enviar una solicitud <code>GET</code> al <code>/toptal/get</code> . <br><br><h3>  Use Spring profesionalmente </h3><br>  Spring es una plataforma poderosa con la que es f√°cil comenzar, pero lleva tiempo y un poco de esfuerzo dominarla por completo.  Si se toma el tiempo para familiarizarse con esta plataforma, al final, sin duda, aumentar√° la eficiencia de su trabajo, lo ayudar√° a crear un c√≥digo m√°s limpio y aumentar√° sus calificaciones como desarrollador. <br><br>  Le recomiendo que preste atenci√≥n a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Spring In Action</a> : este es un buen libro orientado a la aplicaci√≥n que analiza muchos temas importantes relacionados con la plataforma Spring. <br><br>  En este punto, la traducci√≥n de este art√≠culo lleg√≥ a su fin. <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Lee la primera parte</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/465063/">https://habr.com/ru/post/465063/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../465049/index.html">10 libros sobre gesti√≥n √°gil de proyectos que vale la pena llevar contigo en 2020</a></li>
<li><a href="../465055/index.html">Seis habilidades para llevar tu carrera de ciencia de datos al siguiente nivel.</a></li>
<li><a href="../465057/index.html">Contenedores y Ventanas. De Hello World a Kubernetes. Primera parte, introductoria</a></li>
<li><a href="../465059/index.html">PoE a una distancia de m√°s de 200 metros. Monitoreo y reinicio autom√°tico de clientes PoE</a></li>
<li><a href="../465061/index.html">¬øPor qu√©, en lugar de una semana laboral de cuatro d√≠as, es mejor pensar en un d√≠a laboral de seis horas?</a></li>
<li><a href="../465069/index.html">Nuevo en Hadoop: Conozca los diversos formatos de archivo en Hadoop</a></li>
<li><a href="../465071/index.html">TechTrain 2019 IT festival: c√≥mo participaron JUG.ru, JUGNsk y JUG.MSK</a></li>
<li><a href="../465073/index.html">¬°No aparezcas! Transiciones interrumpibles en iOS</a></li>
<li><a href="../465075/index.html">En la cabina del conductor del tren</a></li>
<li><a href="../465077/index.html">Inseguro.AsSpan: Span <T> ¬øC√≥mo reemplazar los punteros?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>