<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üñêüèæ ‚¨ÖÔ∏è üí∑ El juego Arduino m√°s simple con una pantalla 1602 - Parte # 1 üíé üë®üèæ‚Äçüé§ üöõ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Eso es lo que tenemos que conseguir, bueno, √©l todav√≠a sabe c√≥mo saltar, caminar y vencer a los cactus malvados que lo atacan, pero iremos paso a paso...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>El juego Arduino m√°s simple con una pantalla 1602 - Parte # 1</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/424859/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/ad/t5/fh/adt5fhpeoqsk4ulxwnrx-lihi60.gif"></div><br>  Eso es lo que tenemos que conseguir, bueno, √©l todav√≠a sabe c√≥mo saltar, caminar y vencer a los cactus malvados que lo atacan, pero iremos paso a paso :) <br><br><h1>  PARTE # 1 conceptos b√°sicos </h1><br>  Me orden√© un arduino, "un juguete regular", pens√©, un peque√±o kit (para probar), que luego lament√©.  Quer√≠a liberar el potencial, pero debido a la falta de m√≥dulos adicionales esto no funcion√≥, tuve que experimentar, puse el arduino en el sistema de seguridad y vi c√≥mo los sensores hacen su trabajo, luego decid√≠ hacer una alarma de audio (usando el chirrido pr√°ctico del kit), as√≠ que destete a los perros en voz alta o de repente ladrando :) y luego mis manos llegaron a la pantalla 1602. "Hmm ... esta es una pantalla real", pens√©, pero me decepcion√≥ descubrir que se come casi la mitad de todos los contactos del arduino.  Rebusqu√© y encontr√© un tablero extra√±o en el kit "i2C" y ¬°sospechaba mucho de eso!  Que el n√∫mero de agujeros coincidi√≥ con el n√∫mero de proxenetas en la pantalla.  "Hmm, no es f√°cil ..." pens√©, y decid√≠ soldarlos.  Un poco m√°s tarde, me di cuenta de que hab√≠a hecho lo correcto y ahora mi pantalla solo consume dos canales.  Comenz√≥ a estudiar qu√© tipo de exhibici√≥n era y qu√© pod√≠a hacer.  Habiendo estudiado suficiente material, descubr√≠ que la pantalla es puramente textual, ¬°pero he aqu√≠!  Puede manejar 8 nuevos caracteres con dimensiones de 5x8 p√≠xeles.  Bueno, entonces, ¬°comencemos a escribir un juego!  Primero, debes averiguar qu√© tipo de juego ser√°, decid√≠ hacerlo parecer un dinosaurio gugl chrome, pero con un par de fichas, por as√≠ decirlo, para empezar, creo que funcionar√° :) <a name="habracut"></a>  pero a√∫n tiene que administrar algo, y los botones m√∫ltiples no tuvieron que pensar mucho.  Tom√© el control remoto IR del kit. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1cc/b5e/3ea/1ccb5e3ea03b39d52759980be2176c40.jpg" alt="imagen"><br><br>  "Esa es la palanca de mando", murmur√© sospechosamente por lo bajo, pensando en el retraso del control remoto, la claridad del sensor de infrarrojos y, en general, sobre la idoneidad de esta idea, pero no hab√≠a nada que hacer, pude entrenar a Arduino para que trabajara con el teclado de la computadora, pero fue realmente pereza para hacerlo  Entonces comenc√© a escribir los c√≥digos de control remoto, para poder trabajar con ellos en el futuro.  El c√≥digo para el microcontrolador es el m√°s simple aqu√≠: <br><br><pre><code class="hljs pgsql">"--------------------------------------------------------------------------" //   IRremote #<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> &lt;IRremote.h&gt; decode_results results; IRrecv irrecv (A0); //      <span class="hljs-type"><span class="hljs-type">void</span></span> setup () { <span class="hljs-type"><span class="hljs-type">Serial</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">begin</span></span>(<span class="hljs-number"><span class="hljs-number">9600</span></span>); //   com  irrecv.enableIRIn(); //    } <span class="hljs-type"><span class="hljs-type">void</span></span> <span class="hljs-keyword"><span class="hljs-keyword">loop</span></span> () { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (irrecv.decode( &amp;results )) //      ,    { <span class="hljs-type"><span class="hljs-type">Serial</span></span>.println( results.<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>, HEX ); //          irrecv.resume(); //            } } "--------------------------------------------------------------------------"</code> </pre> <br>  El c√≥digo de la se√±al del control remoto se ve as√≠: "FF18E7" sus c√≥digos ser√°n diferentes, pero debe comprender la esencia, y cuando apela a este c√≥digo, agregamos "0x" al principio y obtenemos (0xFF18E7). <br><br>  Despu√©s de llenar esto en arduino y conectarlo como deber√≠a, podemos comenzar a grabar desde el puerto de registro de la tsiforka, despu√©s de hacer clic en los botones del dispositivo IR.  Pero aqu√≠ solo quiero aclararle c√≥mo conectar el sensor IR. <br><br>  Si miramos el sensor, vemos tres patas, izquierda (se√±al anal√≥gica), media (tierra), derecha (m√°s 5V). <br><br><img src="https://arduino-info.wikispaces.com/file/view/IR-pinout.jpg/264668350/IR-pinout.jpg" alt="imagen"><br><br>  Como todav√≠a ten√≠a poca idea de c√≥mo funcionar√≠a, comenc√© a experimentar.  Al principio hice el c√≥digo del boceto paso a paso, a trav√©s de (retraso (tiempo)) al principio no sospech√© que era una mala idea :) <br>  ¬øCu√°l es la jamba principal?  Este microcontrolador no puede realizar multitareas.  Considera el c√≥digo de arriba a abajo, pasando por todas las ramas y funciones, y despu√©s de completarlo, comienza de nuevo.  Y ahora, cuando tenemos muchos de estos "retrasos" en el c√≥digo, comenzamos a notar retrasos obvios.  Por cierto, s√≠, ¬øpor qu√© necesitamos tanto "retraso"?  Cuando hacemos un juego, el n√∫mero de controles e interacciones comienza a crecer.  Por ejemplo, un enemigo se mueve hacia nosotros y quiero saltar sobre √©l, presiono el "salto" y de acuerdo con el plan, tengo que colgar en el aire por ejemplo 0.8f segundos en el aire, y este es todo el juego y se congela durante estos 0.8f segundos.  "Cant" pens√© y comenc√© a pensar en una soluci√≥n.  La soluci√≥n se encontr√≥ r√°pidamente.  El microcontrolador mismo puede leer r√°pidamente el c√≥digo de principio a fin (si no le molesta) y tambi√©n sabe c√≥mo contar el tiempo desde el principio de su inclusi√≥n.  Esto es lo que necesitamos.  Ahora solo creamos variables que almacenar√°n el tiempo para esta o aquella acci√≥n y una variable que compara la diferencia de qu√© hora es ahora y cu√°nto se tarda en activar el c√≥digo.  Arduino por segundo, lleva 1000 milisegundos, bastante conveniente.  Aqu√≠ hay un fragmento cuando se vuelve m√°s claro: <br><br><pre> <code class="hljs ruby"><span class="hljs-string"><span class="hljs-string">"--------------------------------------------------------------------------"</span></span> /<span class="hljs-regexp"><span class="hljs-regexp">/    ,  ,        /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/  long ClearTime = 150; /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/ 150 = 0.15f   ~6    long ClearTimeCheck = 0; /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/ ,       long currentMillis = 0; /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/   void loop () { currentMillis = millis(); /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/   =    } void clearscreen () /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/   { /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/ if (currentMillis - ClearTimeCheck &gt;= ClearTime) /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/  (  -     0.15f    { ClearTimeCheck = currentMillis; /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/       lcd.clear(); /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/   ,     } } "--------------------------------------------------------------------------"</span></span></code> </pre> <br>  No es dif√≠cil, ¬øverdad? <br><br>  Despu√©s de reescribir todo el c√≥digo de una manera nueva, el juego comenz√≥ a funcionar r√°pida y claramente, para simular acciones multitarea :) Recorr√≠ un largo camino.  Despu√©s de todo, a√∫n necesitamos crear un personaje, una especie de interfaz y animaci√≥n.  Dado que solo podemos crear ocho nuevos personajes, necesitamos de alguna manera desordenarlo de manera inteligente.  No planeo hacer muchos objetos en la pantalla hasta ahora, por lo tanto, se puede hacer para tener solo ocho objetos activos en la pantalla en un procesamiento de c√≥digo.  Que sera  Bueno, naturalmente el personaje principal, un golpe, un villano, un coraz√≥n y un indicador de salud.  Para empezar, esto es suficiente.  S√≠, y tengo tres objetos √∫nicos m√°s en stock. <br><br>  El personaje principal se ver√° as√≠: <br><br><img src="https://habrastorage.org/webt/ea/rk/ha/earkhaarqwcke8t6qmgvuhtxhhw.jpeg"><br><br>  El proceso de ingresar un nuevo personaje, lo produzco en c√≥digo binario (me siento muy c√≥modo) <br>  se ver√° as√≠: <br><br>  01110 <br>  01110 <br>  00100 <br>  01110 <br>  10101 <br>  00100 <br>  01110 <br>  01010 <br><br>  Si miras de cerca, entonces, desde uno, veremos a nuestro personaje, pero para que no permanezca inactivo, hag√°moslo una animaci√≥n. <br><br><img src="https://habrastorage.org/webt/lm/zy/s-/lmzys-m1civhaydvisjrsomhtiy.jpeg"><br><br>  Ahora a nuestro c√≥digo, se agrega un conjunto m√°s de n√∫meros binarios, a saber, este: <br><br>  00000 <br>  01110 <br>  01110 <br>  00100 <br>  11111 <br>  00100 <br>  01110 <br>  01010 <br><br>  C√≥mo hacer animaci√≥n en esta pantalla, indiqu√© la l√≥gica anterior, y ahora practiquemos, por el momento, col√≥quelo en el centro de la pantalla y d√©jelo quieto, y recuerde, nuestra tarea es usar solo una celda de memoria para dos sprites de animaci√≥n.  Esto es m√°s f√°cil de lo que parece: <br><br><pre> <code class="hljs pgsql">"--------------------------------------------------------------------------" #<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> &lt;Wire.h&gt; #<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> &lt;LiquidCrystal_I2C.h&gt; LiquidCrystal_I2C lcd(<span class="hljs-number"><span class="hljs-number">0x3F</span></span>,<span class="hljs-number"><span class="hljs-number">16</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>); //   long AnimatedTime = <span class="hljs-number"><span class="hljs-number">300</span></span>; //     long AnimatedTimeCheck = <span class="hljs-number"><span class="hljs-number">0</span></span>; //   (    ) <span class="hljs-type"><span class="hljs-type">int</span></span> AnimPlayer = <span class="hljs-number"><span class="hljs-number">1</span></span>; //    <span class="hljs-type"><span class="hljs-type">int</span></span> GGpozX = <span class="hljs-number"><span class="hljs-number">8</span></span>; //   <span class="hljs-type"><span class="hljs-type">int</span></span> GGpozY = <span class="hljs-number"><span class="hljs-number">1</span></span>; //   <span class="hljs-number"><span class="hljs-number">1</span></span>  <span class="hljs-number"><span class="hljs-number">2</span></span>   <span class="hljs-number"><span class="hljs-number">0</span></span>    long currentMillis = <span class="hljs-number"><span class="hljs-number">0</span></span>; //   //   ,     ,    :) enum { SYMBOL_HEIGHT = <span class="hljs-number"><span class="hljs-number">8</span></span> }; byte Player_1[SYMBOL_HEIGHT] = {B01110,B01110,B00100,B01110,B10101,B00100,B01110,B01010,}; //  <span class="hljs-number"><span class="hljs-number">1</span></span> byte Player_2[SYMBOL_HEIGHT] = {B00000,B01110,B01110,B00100,B11111,B00100,B01110,B01010,}; //  <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-type"><span class="hljs-type">void</span></span> setup() { lcd.init(); lcd.backlight();//    <span class="hljs-keyword"><span class="hljs-keyword">loop</span></span>(); PlAn(); } <span class="hljs-type"><span class="hljs-type">void</span></span> <span class="hljs-keyword"><span class="hljs-keyword">loop</span></span>() { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (AnimPlayer != <span class="hljs-number"><span class="hljs-number">50</span></span>) { //    ,       :) // <span class="hljs-comment"><span class="hljs-comment">--------------------------- Animated -&gt; // -------------------- Player -&gt; if (AnimPlayer == 1){lcd.createChar(0, Player_1);} //  1   1 //(lcd.createChar(    0  7,   )) if (AnimPlayer == 2){lcd.createChar(0, Player_2);} //  2   2 } // --------------------------- &lt;- Animated currentMillis = millis(); //   =    PlAn(); } void PlAn () { if (AnimPlayer == 1) //   1  { lcd.setCursor(GGpozX, GGpozY); //  ""      lcd.write(0); //          "" } if (AnimPlayer == 2) //  ‚Ññ1 { lcd.setCursor(GGpozX, GGpozY); lcd.write(0); } if (currentMillis - AnimatedTimeCheck &gt;= AnimatedTime) //       { AnimatedTimeCheck = currentMillis; //     if (AnimPlayer == 2){AnimPlayer = 1; return;} //  2   1      if (AnimPlayer == 1){AnimPlayer = 2;} // 1  2           ,         } } "--------------------------------------------------------------------------"</span></span></code> </pre> <br>  Despu√©s de comenzar, vemos al hombrecillo, que est√° en el centro de la pantalla, en la segunda l√≠nea y se balancea, por as√≠ decirlo. <br><br>  Conclusi√≥n: hoy habl√© sobre c√≥mo encontrar datos a trav√©s del puerto de infrarrojos, c√≥mo evitar el retraso del c√≥digo del microcontrolador y c√≥mo hacer la animaci√≥n inicial. <br><br>  El resto llegar√° pronto :) Todav√≠a tengo mucho que escribir, as√≠ que ver√© c√≥mo ser√° interesante para ustedes y, de ser as√≠, ma√±ana comenzar√© a escribir una secuela. <br><br>  ¬°Gracias a todos por su atenci√≥n, chao cacao! <br><br>  La segunda parte del art√≠culo -&gt; <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">habr.com/post/425367</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es424859/">https://habr.com/ru/post/es424859/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es424849/index.html">Lo que hace que el nuevo UCS C480 ML M5 sea interesante: servidor de aprendizaje autom√°tico de Cisco</a></li>
<li><a href="../es424851/index.html">¬øQu√© hay de malo en contratar a TI?</a></li>
<li><a href="../es424853/index.html">La historia de un controlador de vista que quer√≠a lucir bien</a></li>
<li><a href="../es424855/index.html">Aprendizaje autom√°tico: Scramble with a Room Elephant</a></li>
<li><a href="../es424857/index.html">Soporte de SNI cifrado implementado en CloudFlare</a></li>
<li><a href="../es424861/index.html">Una serpiente en el buz√≥n y qu√© hace F #</a></li>
<li><a href="../es424865/index.html">Part√≠culas de dise√±o elemental descubiertas</a></li>
<li><a href="../es424867/index.html">Desarrollo de hex√°podos desde cero (parte 1) - dise√±o</a></li>
<li><a href="../es424869/index.html">C√≥mo la nueva caracter√≠stica de iOS 12 me record√≥ que es hora de sanar</a></li>
<li><a href="../es424871/index.html">Elon Musk y Tesla resuelven un litigio con la Comisi√≥n de Bolsa y Valores de EE. UU.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>