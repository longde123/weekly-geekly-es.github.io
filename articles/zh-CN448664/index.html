<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘ª ğŸ¤µğŸ¿ ğŸ›ŒğŸ¾ åœ¨Swiftä¸ŠåƒTinderä¸€æ ·åˆ›å»ºå¡ç‰‡ ğŸ¥© âœ³ï¸ ğŸ™ğŸ¼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Tinder-æˆ‘ä»¬éƒ½çŸ¥é“è¿™æ˜¯ä¸€ä¸ªçº¦ä¼šåº”ç”¨ç¨‹åºï¼Œæ‚¨å¯ä»¥é€šè¿‡å‘å·¦æˆ–å‘å³æ»‘åŠ¨æ¥æ‹’ç»æˆ–æ¥å—æŸäººã€‚ ç°åœ¨ï¼Œè¿™ç§è¯»å¡å™¨çš„æƒ³æ³•å·²ç”¨äºä¼—å¤šåº”ç”¨ä¸­ã€‚ å¦‚æœæ‚¨å·²ç»åŒå€¦äº†ä½¿ç”¨è¡¨è§†å›¾å’Œé›†åˆè§†å›¾ï¼Œåˆ™è¿™ç§æ˜¾ç¤ºæ•°æ®çš„æ–¹æ³•é€‚åˆæ‚¨ã€‚ å…³äºè¿™ä¸ªä¸»é¢˜çš„æ•™ç§‘ä¹¦å¾ˆå¤šï¼Œä½†æ˜¯è¿™ä¸ªé¡¹ç›®èŠ±äº†æˆ‘å¾ˆå¤šæ—¶é—´ã€‚ 

 æ‚¨å¯ä»¥åœ¨æˆ‘çš„githubä¸Šçœ‹åˆ°å®Œæ•´çš„é¡¹...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>åœ¨Swiftä¸ŠåƒTinderä¸€æ ·åˆ›å»ºå¡ç‰‡</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/448664/"><img src="https://habrastorage.org/getpro/habr/post_images/2b7/15f/817/2b715f8176b64a1ccc7ec9afd35f7028.png" alt="å›¾ç‰‡"><br><br>  Tinder-æˆ‘ä»¬éƒ½çŸ¥é“è¿™æ˜¯ä¸€ä¸ªçº¦ä¼šåº”ç”¨ç¨‹åºï¼Œæ‚¨å¯ä»¥é€šè¿‡å‘å·¦æˆ–å‘å³æ»‘åŠ¨æ¥æ‹’ç»æˆ–æ¥å—æŸäººã€‚ ç°åœ¨ï¼Œè¿™ç§è¯»å¡å™¨çš„æƒ³æ³•å·²ç”¨äºä¼—å¤šåº”ç”¨ä¸­ã€‚ å¦‚æœæ‚¨å·²ç»åŒå€¦äº†ä½¿ç”¨è¡¨è§†å›¾å’Œé›†åˆè§†å›¾ï¼Œåˆ™è¿™ç§æ˜¾ç¤ºæ•°æ®çš„æ–¹æ³•é€‚åˆæ‚¨ã€‚ å…³äºè¿™ä¸ªä¸»é¢˜çš„æ•™ç§‘ä¹¦å¾ˆå¤šï¼Œä½†æ˜¯è¿™ä¸ªé¡¹ç›®èŠ±äº†æˆ‘å¾ˆå¤šæ—¶é—´ã€‚ <br><a name="habracut"></a><br> æ‚¨å¯ä»¥åœ¨æˆ‘çš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">github</a>ä¸Šçœ‹åˆ°å®Œæ•´çš„é¡¹ç›®ã€‚ <br><br> é¦–å…ˆï¼Œæˆ‘æƒ³èµæ‰¬Phill Farrugiaåœ¨æ­¤é—®é¢˜ä¸Šçš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">èŒä½</a> ï¼Œç„¶ååœ¨Big Mountainå·¥ä½œå®¤çš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">YouTube</a>ç³»åˆ—ä¸Šå°±è¿™ä¸€ä¸»é¢˜è¿›è¡Œè‡´æ•¬ã€‚ é‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•åˆ¶ä½œè¿™ä¸ªç•Œé¢å‘¢ï¼Ÿ æˆ‘åœ¨å‡ºç‰ˆæœ‰å…³æ­¤ä¸»é¢˜çš„Philæ–¹é¢è·å¾—äº†å¸®åŠ©ã€‚ æœ¬è´¨ä¸Šï¼Œè¿™ä¸ªæƒ³æ³•æ˜¯åˆ›å»ºUIViewså¹¶å°†å®ƒä»¬ä½œä¸ºå­è§†å›¾æ’å…¥åˆ°å®¹å™¨è§†å›¾ä¸­ã€‚ ç„¶åï¼Œä½¿ç”¨ç´¢å¼•ï¼Œæˆ‘ä»¬å°†ä¸ºæ¯ä¸ªUIViewè¿›è¡Œæ°´å¹³å’Œå‚ç›´æ’å…¥ï¼Œå¹¶ç¨å¾®æ”¹å˜å…¶å®½åº¦ã€‚ æ­¤å¤–ï¼Œå½“æˆ‘ä»¬åœ¨ä¸€å¼ åœ°å›¾ä¸Šæ‹–åŠ¨æ‰‹æŒ‡æ—¶ï¼Œå°†æ ¹æ®æ–°çš„ç´¢å¼•å€¼é‡æ–°æ’åˆ—è§†å›¾çš„æ‰€æœ‰å¸§ã€‚ <br><br> æˆ‘ä»¬å°†ä»åœ¨ä¸€ä¸ªç®€å•çš„ViewControllerä¸­åˆ›å»ºä¸€ä¸ªå®¹å™¨è§†å›¾å¼€å§‹ã€‚ <br><br><pre><code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ViewController</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UIViewController</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//MARK: - Properties var viewModelData = [CardsDataModel(bgColor: UIColor(red:0.96, green:0.81, blue:0.46, alpha:1.0), text: "Hamburger", image: "hamburger"), CardsDataModel(bgColor: UIColor(red:0.29, green:0.64, blue:0.96, alpha:1.0), text: "Puppy", image: "puppy"), CardsDataModel(bgColor: UIColor(red:0.29, green:0.63, blue:0.49, alpha:1.0), text: "Poop", image: "poop"), CardsDataModel(bgColor: UIColor(red:0.69, green:0.52, blue:0.38, alpha:1.0), text: "Panda", image: "panda"), CardsDataModel(bgColor: UIColor(red:0.90, green:0.99, blue:0.97, alpha:1.0), text: "Subway", image: "subway"), CardsDataModel(bgColor: UIColor(red:0.83, green:0.82, blue:0.69, alpha:1.0), text: "Robot", image: "robot")] var stackContainer : StackContainerView! //MARK: - Init override func loadView() { view = UIView() view.backgroundColor = UIColor(red:0.93, green:0.93, blue:0.93, alpha:1.0) stackContainer = StackContainerView() view.addSubview(stackContainer) configureStackContainer() stackContainer.translatesAutoresizingMaskIntoConstraints = false configureNavigationBarButtonItem() } override func viewDidLoad() { super.viewDidLoad() title = "Expense Tracker" stackContainer.dataSource = self } //MARK: - Configurations func configureStackContainer() { stackContainer.centerXAnchor.constraint(equalTo: view.centerXAnchor).isActive = true stackContainer.centerYAnchor.constraint(equalTo: view.centerYAnchor, constant: -60).isActive = true stackContainer.widthAnchor.constraint(equalToConstant: 300).isActive = true stackContainer.heightAnchor.constraint(equalToConstant: 400).isActive = true }</span></span></code> </pre> <br> å¦‚æ‚¨æ‰€è§ï¼Œæˆ‘åˆ›å»ºäº†è‡ªå·±çš„åä¸ºSwipeContainerViewçš„ç±»ï¼Œå¹¶ä½¿ç”¨è‡ªåŠ¨çº¦æŸé…ç½®äº†stackViewContainerã€‚ ä¸ç”¨æ‹…å¿ƒã€‚  SwipeContainerViewçš„å¤§å°å°†ä¸º300x400ï¼Œå¹¶ä¸”å°†åœ¨Xè½´ä¸Šå±…ä¸­ï¼Œå¹¶ä¸”ä»…åœ¨Yè½´ä¸­éƒ¨ä¸Šæ–¹60åƒç´ ã€‚ <br><br> ç°åœ¨æˆ‘ä»¬å·²ç»é…ç½®äº†stackContainerï¼Œæˆ‘ä»¬å°†è½¬åˆ°StackContainerViewçš„å­ç±»å¹¶å°†å„ç§æ˜ å°„åŠ è½½åˆ°å…¶ä¸­ã€‚ åœ¨æ­¤ä¹‹å‰ï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªåŒ…å«ä¸‰ç§æ–¹æ³•çš„åè®®ï¼š <br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">protocol</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SwipeCardsDataSource</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">numberOfCardsToShow</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Int</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">card</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(at index: Int)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">SwipeCardView</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">emptyView</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">UIView?</span></span> }</code> </pre> <br> å°†æ­¤åè®®è§†ä¸ºTableViewDataSourceã€‚ æˆ‘ä»¬çš„ViewControllerç±»ç¬¦åˆæ­¤åè®®ï¼Œå°†å…è®¸å°†æœ‰å…³æˆ‘ä»¬çš„æ•°æ®çš„ä¿¡æ¯ä¼ è¾“åˆ°SwipeCardContainerç±»ã€‚ å®ƒå…·æœ‰ä¸‰ç§æ–¹æ³•ï¼š <br><br><ol><li>  <code>numberOfCardsToShow () -&gt; Int</code> ï¼šè¿”å›æˆ‘ä»¬éœ€è¦æ˜¾ç¤ºçš„å¡æ•°ã€‚ å®ƒåªæ˜¯ä¸€ä¸ªæ•°æ®æ•°ç»„è®¡æ•°å™¨ã€‚ </li><li>  <code>card(at index: Int) -&gt; SwipeCardView</code> ï¼šè¿”å›SwipeCardViewï¼ˆæˆ‘ä»¬å°†åœ¨ç¨ååˆ›å»ºæ­¤ç±»ï¼‰ </li><li>  <code>EmptyView</code> &gt;æˆ‘ä»¬å°†ä¸å¯¹å…¶æ‰§è¡Œä»»ä½•æ“ä½œï¼Œä½†æ˜¯ä¸€æ—¦æ‰€æœ‰å¡è¢«åˆ é™¤ï¼Œè°ƒç”¨æ­¤å§”æ‰˜æ–¹æ³•å°†è¿”å›å¸¦æœ‰æŸäº›æ¶ˆæ¯çš„ç©ºè§†å›¾ï¼ˆåœ¨æœ¬è¯¾ç¨‹ä¸­ï¼Œæˆ‘å°†ä¸ä¼šå®ç°ï¼Œè¯·è‡ªè¡Œå°è¯•ï¼‰ </li></ol><br> å°†è§†å›¾æ§åˆ¶å™¨ä¸æ­¤åè®®å¯¹é½ï¼š <br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extension</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ViewController</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SwipeCardsDataSource</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">numberOfCardsToShow</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Int</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> viewModelData.<span class="hljs-built_in"><span class="hljs-built_in">count</span></span> } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">card</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(at index: Int)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">SwipeCardView</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> card = <span class="hljs-type"><span class="hljs-type">SwipeCardView</span></span>() card.dataSource = viewModelData[index] <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> card } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">emptyView</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">UIView?</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">nil</span></span> } }</code> </pre> <br> ç¬¬ä¸€ç§æ–¹æ³•å°†è¿”å›æ•°æ®æ•°ç»„ä¸­çš„å…ƒç´ æ•°ã€‚ åœ¨ç¬¬äºŒç§æ–¹æ³•ä¸­ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„SwipeCardViewï¼ˆï¼‰å®ä¾‹å¹¶å‘é€è¯¥ç´¢å¼•çš„æ•°ç»„æ•°æ®ï¼Œç„¶åè¿”å›SwipeCardViewå®ä¾‹ã€‚ <br><br>  SwipeCardViewæ˜¯UIViewçš„å­ç±»ï¼Œå®ƒå…·æœ‰UIImageï¼ŒUILabelå’Œæ‰‹åŠ¿è¯†åˆ«å™¨ã€‚ ç¨åå†è¯¦ç»†ä»‹ç»ã€‚ æˆ‘ä»¬å°†ä½¿ç”¨æ­¤åè®®ä¸å®¹å™¨çš„è¡¨ç¤ºè¿›è¡Œé€šä¿¡ã€‚ <br><br><pre> <code class="swift hljs">stackContainer.dataSource = <span class="hljs-keyword"><span class="hljs-keyword">self</span></span></code> </pre> <br> ä¸Šé¢çš„ä»£ç è§¦å‘æ—¶ï¼Œå°†è°ƒç”¨reloadDataå‡½æ•°ï¼Œç„¶åè°ƒç”¨è¿™äº›æ•°æ®æºå‡½æ•°ã€‚ <br><br><pre> <code class="swift hljs"><span class="hljs-type"><span class="hljs-type">Class</span></span> <span class="hljs-type"><span class="hljs-type">StackViewContainer</span></span>: <span class="hljs-type"><span class="hljs-type">UIView</span></span> { . . <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> dataSource: <span class="hljs-type"><span class="hljs-type">SwipeCardsDataSource?</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">didSet</span></span> { reloadData() } } ....</code> </pre> <br>  ReloadDataå‡½æ•°ï¼š <br><br><pre> <code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">reloadData</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">guard</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> datasource = dataSource <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> } setNeedsLayout() layoutIfNeeded() numberOfCardsToShow = datasource.numberOfCardsToShow() remainingcards = numberOfCardsToShow <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>..&lt;<span class="hljs-built_in"><span class="hljs-built_in">min</span></span>(numberOfCardsToShow,cardsToBeVisible) { addCardView(cardView: datasource.card(at: i), atIndex: i ) } }</code> </pre> <br> åœ¨reloadDataå‡½æ•°ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆè·å–çº¸ç‰Œæ•°å¹¶å°†å…¶å­˜å‚¨åœ¨å˜é‡numberOfCardsToShowä¸­ã€‚ ç„¶åï¼Œæˆ‘ä»¬å°†å…¶åˆ†é…ç»™å¦ä¸€ä¸ªåä¸ºå‰©ä½™å¡ç‰‡çš„å˜é‡ã€‚ åœ¨forå¾ªç¯ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ç´¢å¼•å€¼åˆ›å»ºä¸€ä¸ªæ˜ å°„ï¼Œè¯¥æ˜ å°„æ˜¯SwipeCardViewçš„å®ä¾‹ã€‚ <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>..&lt;<span class="hljs-built_in"><span class="hljs-built_in">min</span></span>(numberOfCardsToShow,cardsToBeVisible) { addCardView(cardView: datasource.card(at: i), atIndex: i ) }</code> </pre> <br> å®é™…ä¸Šï¼Œæˆ‘ä»¬å¸Œæœ›ä¸€æ¬¡å‡ºç°å°‘äº3å¼ å¡ç‰‡ã€‚ å› æ­¤ï¼Œæˆ‘ä»¬ä½¿ç”¨minå‡½æ•°ã€‚  CardsToBeVisibleæ˜¯ç­‰äº3çš„å¸¸æ•°ã€‚å¦‚æœnumberOfToShowå¤§äº3ï¼Œåˆ™å°†ä»…æ˜¾ç¤ºä¸‰å¼ å¡ã€‚ æˆ‘ä»¬æ ¹æ®åè®®åˆ›å»ºä»¥ä¸‹å¡ï¼š <br><br><pre> <code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">card</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(at index: Int)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">SwipeCardView</span></span></code> </pre> <br>  addCardViewï¼ˆï¼‰å‡½æ•°ä»…ç”¨äºå°†åœ°å›¾ä½œä¸ºå­è§†å›¾æ’å…¥ã€‚ <br><br><pre> <code class="swift hljs"> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">addCardView</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(cardView: SwipeCardView, atIndex index: Int)</span></span></span></span> { cardView.delegate = <span class="hljs-keyword"><span class="hljs-keyword">self</span></span> addCardFrame(index: index, cardView: cardView) cardViews.append(cardView) insertSubview(cardView, at: <span class="hljs-number"><span class="hljs-number">0</span></span>) remainingcards -= <span class="hljs-number"><span class="hljs-number">1</span></span> }</code> </pre> <br> åœ¨æ­¤åŠŸèƒ½ä¸­ï¼Œæˆ‘ä»¬å°†cardViewæ·»åŠ åˆ°è§†å›¾çš„å±‚æ¬¡ç»“æ„ä¸­ï¼Œå¹¶å°†å¡æ·»åŠ ä¸ºå­è§†å›¾ï¼Œå°†å‰©ä½™çš„å¡å‡å°‘1ã€‚ä¸€æ—¦å°†cardViewæ·»åŠ ä¸ºå­è§†å›¾ï¼Œæˆ‘ä»¬ä¾¿è®¾ç½®äº†è¿™äº›å¡çš„æ¡†æ¶ã€‚ ä¸ºæ­¤ï¼Œæˆ‘ä»¬ä½¿ç”¨å¦ä¸€ä¸ªå‡½æ•°addCardFrameï¼ˆï¼‰ï¼š <br><br><pre> <code class="swift hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">addCardFrame</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(index: Int, cardView: SwipeCardView)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> cardViewFrame = bounds <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> horizontalInset = (<span class="hljs-type"><span class="hljs-type">CGFloat</span></span>(index) * <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.horizontalInset) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> verticalInset = <span class="hljs-type"><span class="hljs-type">CGFloat</span></span>(index) * <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.verticalInset cardViewFrame.size.width -= <span class="hljs-number"><span class="hljs-number">2</span></span> * horizontalInset cardViewFrame.origin.x += horizontalInset cardViewFrame.origin.y += verticalInset cardView.frame = cardViewFrame }</code> </pre> <br> è¿™ä¸ªaddCardFrameï¼ˆï¼‰é€»è¾‘ç›´æ¥å–è‡ªPhilçš„å¸–å­ã€‚ åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬æ ¹æ®åœ°å›¾çš„ç´¢å¼•è®¾ç½®åœ°å›¾æ¡†æ¶ã€‚ ç´¢å¼•ä¸º0çš„ç¬¬ä¸€å¼ å¡ç‰‡å°†å…·æœ‰ä¸€ä¸ªæ¡†æ¶ï¼Œå°±åƒä¸€ä¸ªå®¹å™¨ä¸€æ ·ã€‚ ç„¶åï¼Œæ ¹æ®æ’å…¥å†…å®¹æ›´æ”¹æ¡†æ¶çš„åŸç‚¹å’Œåœ°å›¾çš„å®½åº¦ã€‚ å› æ­¤ï¼Œæˆ‘ä»¬å°†å¡æ·»åŠ åˆ°ä¸Šæ–¹å¡çš„å³ä¾§ä¸€ç‚¹å¤„ï¼Œå‡å°å…¶å®½åº¦ï¼Œå¹¶ä¸”è¿˜å¿…é¡»å°†å¡å‘ä¸‹æ‹‰ä»¥äº§ç”Ÿå¡å †å åœ¨ä¸€èµ·çš„æ„Ÿè§‰ã€‚ <br><br> å®Œæˆæ­¤æ“ä½œåï¼Œæ‚¨å°†çœ‹åˆ°å¡å †å åœ¨ä¸€èµ·ã€‚ è¿˜ä¸é”™ï¼ <br><br><img src="https://habrastorage.org/getpro/habr/post_images/bee/8f0/83e/bee8f083e7dfc5e9dbc70ed6a95d398a.png" alt="å›¾ç‰‡"><br><br> ä½†æ˜¯ï¼Œç°åœ¨æˆ‘ä»¬éœ€è¦å‘åœ°å›¾è§†å›¾æ·»åŠ æ»‘åŠ¨æ‰‹åŠ¿ã€‚ ç°åœ¨è®©æˆ‘ä»¬å°†æ³¨æ„åŠ›è½¬å‘SwipeCardViewç±»ã€‚ <br><br><h3> åˆ·å¡è§†å›¾ </h3><br>  swipeCardViewç±»æ˜¯UIViewçš„å¸¸è§„å­ç±»ã€‚ ä½†æ˜¯ï¼Œç”±äºåªæœ‰Appleå·¥ç¨‹å¸ˆæ‰çŸ¥é“çš„åŸå› ï¼Œå¾ˆéš¾ä¸ºå¸¦æœ‰åœ†è§’çš„UIViewæ·»åŠ é˜´å½±ã€‚ ä¸ºäº†å‘åœ°å›¾è§†å›¾æ·»åŠ é˜´å½±ï¼Œæˆ‘åˆ›å»ºäº†ä¸¤ä¸ªUIViewã€‚ å…¶ä¸­ä¹‹ä¸€æ˜¯shadowViewï¼Œç„¶åå¯¹å…¶è¿›è¡ŒswipeViewã€‚ æœ¬è´¨ä¸Šï¼ŒshadowViewå…·æœ‰é˜´å½±ï¼Œä»…æ­¤è€Œå·²ã€‚  SwipeViewå…·æœ‰åœ†è§’ã€‚ åœ¨swipeViewä¸Šï¼Œæˆ‘æ·»åŠ äº†UIImageViewï¼ˆUILabelï¼‰ä»¥å±•ç¤ºæ•°æ®å’Œå›¾åƒã€‚ <br><br><pre> <code class="swift hljs"> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> swipeView : <span class="hljs-type"><span class="hljs-type">UIView!</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> shadowView : <span class="hljs-type"><span class="hljs-type">UIView!</span></span></code> </pre> <br> è®¾ç½®shadowViewå’ŒswipeViewï¼š <br><br><pre> <code class="swift hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">configureShadowView</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { shadowView = <span class="hljs-type"><span class="hljs-type">UIView</span></span>() shadowView.backgroundColor = .clear shadowView.layer.shadowColor = <span class="hljs-type"><span class="hljs-type">UIColor</span></span>.black.cgColor shadowView.layer.shadowOffset = <span class="hljs-type"><span class="hljs-type">CGSize</span></span>(width: <span class="hljs-number"><span class="hljs-number">0</span></span>, height: <span class="hljs-number"><span class="hljs-number">0</span></span>) shadowView.layer.shadowOpacity = <span class="hljs-number"><span class="hljs-number">0.8</span></span> shadowView.layer.shadowRadius = <span class="hljs-number"><span class="hljs-number">4.0</span></span> addSubview(shadowView) shadowView.translatesAutoresizingMaskIntoConstraints = <span class="hljs-literal"><span class="hljs-literal">false</span></span> shadowView.leftAnchor.constraint(equalTo: leftAnchor).isActive = <span class="hljs-literal"><span class="hljs-literal">true</span></span> shadowView.rightAnchor.constraint(equalTo: rightAnchor).isActive = <span class="hljs-literal"><span class="hljs-literal">true</span></span> shadowView.bottomAnchor.constraint(equalTo: bottomAnchor).isActive = <span class="hljs-literal"><span class="hljs-literal">true</span></span> shadowView.topAnchor.constraint(equalTo: topAnchor).isActive = <span class="hljs-literal"><span class="hljs-literal">true</span></span> } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">configureSwipeView</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { swipeView = <span class="hljs-type"><span class="hljs-type">UIView</span></span>() swipeView.layer.cornerRadius = <span class="hljs-number"><span class="hljs-number">15</span></span> swipeView.clipsToBounds = <span class="hljs-literal"><span class="hljs-literal">true</span></span> shadowView.addSubview(swipeView) swipeView.translatesAutoresizingMaskIntoConstraints = <span class="hljs-literal"><span class="hljs-literal">false</span></span> swipeView.leftAnchor.constraint(equalTo: shadowView.leftAnchor).isActive = <span class="hljs-literal"><span class="hljs-literal">true</span></span> swipeView.rightAnchor.constraint(equalTo: shadowView.rightAnchor).isActive = <span class="hljs-literal"><span class="hljs-literal">true</span></span> swipeView.bottomAnchor.constraint(equalTo: shadowView.bottomAnchor).isActive = <span class="hljs-literal"><span class="hljs-literal">true</span></span> swipeView.topAnchor.constraint(equalTo: shadowView.topAnchor).isActive = <span class="hljs-literal"><span class="hljs-literal">true</span></span> }</code> </pre> <br> ç„¶åï¼Œæˆ‘å‘è¿™ç§ç±»å‹çš„å¡æ·»åŠ äº†æ‰‹åŠ¿è¯†åˆ«å™¨ï¼Œå¹¶åœ¨è¯†åˆ«æ—¶è°ƒç”¨äº†é€‰æ‹©å™¨åŠŸèƒ½ã€‚ è¯¥é€‰æ‹©å™¨åŠŸèƒ½å…·æœ‰å¾ˆå¤šç”¨äºæ»šåŠ¨ï¼Œå€¾æ–œç­‰çš„é€»è¾‘ã€‚ è®©æˆ‘ä»¬çœ‹çœ‹ï¼š <br><br><pre> <code class="swift hljs"> <span class="hljs-meta"><span class="hljs-meta">@objc</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">handlePanGesture</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(sender: UIPanGestureRecognizer)</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> card = sender.view <span class="hljs-keyword"><span class="hljs-keyword">as</span></span>! <span class="hljs-type"><span class="hljs-type">SwipeCardView</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> point = sender.translation(<span class="hljs-keyword"><span class="hljs-keyword">in</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> centerOfParentContainer = <span class="hljs-type"><span class="hljs-type">CGPoint</span></span>(x: <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.frame.width / <span class="hljs-number"><span class="hljs-number">2</span></span>, y: <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.frame.height / <span class="hljs-number"><span class="hljs-number">2</span></span>) card.center = <span class="hljs-type"><span class="hljs-type">CGPoint</span></span>(x: centerOfParentContainer.x + point.x, y: centerOfParentContainer.y + point.y) <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> sender.state { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> .ended: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (card.center.x) &gt; <span class="hljs-number"><span class="hljs-number">400</span></span> { delegate?.swipeDidEnd(on: card) <span class="hljs-type"><span class="hljs-type">UIView</span></span>.animate(withDuration: <span class="hljs-number"><span class="hljs-number">0.2</span></span>) { card.center = <span class="hljs-type"><span class="hljs-type">CGPoint</span></span>(x: centerOfParentContainer.x + point.x + <span class="hljs-number"><span class="hljs-number">200</span></span>, y: centerOfParentContainer.y + point.y + <span class="hljs-number"><span class="hljs-number">75</span></span>) card.alpha = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.layoutIfNeeded() } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> }<span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> card.center.x &lt; -<span class="hljs-number"><span class="hljs-number">65</span></span> { delegate?.swipeDidEnd(on: card) <span class="hljs-type"><span class="hljs-type">UIView</span></span>.animate(withDuration: <span class="hljs-number"><span class="hljs-number">0.2</span></span>) { card.center = <span class="hljs-type"><span class="hljs-type">CGPoint</span></span>(x: centerOfParentContainer.x + point.x - <span class="hljs-number"><span class="hljs-number">200</span></span>, y: centerOfParentContainer.y + point.y + <span class="hljs-number"><span class="hljs-number">75</span></span>) card.alpha = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.layoutIfNeeded() } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> } <span class="hljs-type"><span class="hljs-type">UIView</span></span>.animate(withDuration: <span class="hljs-number"><span class="hljs-number">0.2</span></span>) { card.transform = .identity card.center = <span class="hljs-type"><span class="hljs-type">CGPoint</span></span>(x: <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.frame.width / <span class="hljs-number"><span class="hljs-number">2</span></span>, y: <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.frame.height / <span class="hljs-number"><span class="hljs-number">2</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.layoutIfNeeded() } <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> .changed: <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> rotation = tan(point.x / (<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.frame.width * <span class="hljs-number"><span class="hljs-number">2.0</span></span>)) card.transform = <span class="hljs-type"><span class="hljs-type">CGAffineTransform</span></span>(rotationAngle: rotation) <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">break</span></span> } }</code> </pre> <br> ä¸Šé¢çš„ä»£ç çš„å‰å››è¡Œï¼š <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> card = sender.view <span class="hljs-keyword"><span class="hljs-keyword">as</span></span>! <span class="hljs-type"><span class="hljs-type">SwipeCardView</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> point = sender.translation(<span class="hljs-keyword"><span class="hljs-keyword">in</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> centerOfParentContainer = <span class="hljs-type"><span class="hljs-type">CGPoint</span></span>(x: <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.frame.width / <span class="hljs-number"><span class="hljs-number">2</span></span>, y: <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.frame.height / <span class="hljs-number"><span class="hljs-number">2</span></span>) card.center = <span class="hljs-type"><span class="hljs-type">CGPoint</span></span>(x: centerOfParentContainer.x + point.x, y: centerOfParentContainer.y + point.y)</code> </pre> <br> é¦–å…ˆï¼Œæˆ‘ä»¬å¾—åˆ°ä¿æŒæ‰‹åŠ¿çš„æƒ³æ³•ã€‚ æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä½¿ç”¨è½¬ç§»æ–¹æ³•æ¥æ‰¾å‡ºç”¨æˆ·å‡»ä¸­å¡çš„æ¬¡æ•°ã€‚ ç¬¬ä¸‰è¡Œæœ¬è´¨ä¸Šæ˜¯çˆ¶å®¹å™¨çš„ä¸­ç‚¹ã€‚ æˆ‘ä»¬å®‰è£…card.centerçš„æœ€åä¸€è¡Œã€‚ å½“ç”¨æˆ·åœ¨å¡ä¸Šæ»‘åŠ¨æ‰‹æŒ‡æ—¶ï¼Œå¡çš„ä¸­å¿ƒå°†å¢åŠ xçš„è½¬æ¢å€¼å’Œyçš„è½¬æ¢å€¼ã€‚ ä¸ºäº†è·å¾—è¿™ç§æ•æ‰è¡Œä¸ºï¼Œæˆ‘ä»¬ä»å›ºå®šåæ ‡ä¸Šå¤§å¤§æ”¹å˜äº†åœ°å›¾çš„ä¸­å¿ƒç‚¹ã€‚ æ‰‹åŠ¿ç¿»è¯‘ç»“æŸåï¼Œæˆ‘ä»¬å°†å…¶è¿”å›ç»™card.centerã€‚ <br><br> å¯¹äºstate.endedï¼š <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (card.center.x) &gt; <span class="hljs-number"><span class="hljs-number">400</span></span> { delegate?.swipeDidEnd(on: card) <span class="hljs-type"><span class="hljs-type">UIView</span></span>.animate(withDuration: <span class="hljs-number"><span class="hljs-number">0.2</span></span>) { card.center = <span class="hljs-type"><span class="hljs-type">CGPoint</span></span>(x: centerOfParentContainer.x + point.x + <span class="hljs-number"><span class="hljs-number">200</span></span>, y: centerOfParentContainer.y + point.y + <span class="hljs-number"><span class="hljs-number">75</span></span>) card.alpha = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.layoutIfNeeded() } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> }<span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> card.center.x &lt; -<span class="hljs-number"><span class="hljs-number">65</span></span> { delegate?.swipeDidEnd(on: card) <span class="hljs-type"><span class="hljs-type">UIView</span></span>.animate(withDuration: <span class="hljs-number"><span class="hljs-number">0.2</span></span>) { card.center = <span class="hljs-type"><span class="hljs-type">CGPoint</span></span>(x: centerOfParentContainer.x + point.x - <span class="hljs-number"><span class="hljs-number">200</span></span>, y: centerOfParentContainer.y + point.y + <span class="hljs-number"><span class="hljs-number">75</span></span>) card.alpha = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.layoutIfNeeded() } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> }</code> </pre> <br> æˆ‘ä»¬æ£€æŸ¥card.center.xæ˜¯å¦å¤§äº400æˆ–card.center.xå°äº-65ã€‚ å¦‚æœæ˜¯è¿™æ ·ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°†ä¸¢å¼ƒè¿™äº›å¡ï¼Œå¹¶æ›´æ”¹ä¸­å¿ƒã€‚ <br><br> å¦‚æœå‘å³æ»‘åŠ¨ï¼š <br><br><pre> <code class="plaintext hljs">card.center = CGPoint(x: centerOfParentContainer.x + point.x + 200, y: centerOfParentContainer.y + point.y + 75)</code> </pre> <br> å¦‚æœå‘å·¦æ»‘åŠ¨ï¼š <br><br><pre> <code class="plaintext hljs">card.center = CGPoint(x: centerOfParentContainer.x + point.x - 200, y: centerOfParentContainer.y + point.y + 75)</code> </pre> <br> å¦‚æœç”¨æˆ·åœ¨400åˆ°-65ä¹‹é—´çš„ä¸­é—´ä½ç½®ç»“æŸæ‰‹åŠ¿ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°†é‡ç½®åœ°å›¾çš„ä¸­å¿ƒã€‚ æ»‘åŠ¨ç»“æŸåï¼Œæˆ‘ä»¬è¿˜å°†è°ƒç”¨å§”æ‰˜æ–¹æ³•ã€‚ ç¨åå†è¯¦ç»†ä»‹ç»ã€‚ <br><br> æ»‘åŠ¨åœ°å›¾æ—¶è¦è·å¾—è¿™ç§å€¾æ–œï¼› æˆ‘ä¼šå¾ˆæ®‹é…·çš„è¯šå®ã€‚ æˆ‘ä½¿ç”¨äº†ä¸€äº›å‡ ä½•å›¾å½¢ï¼Œå¹¶ä½¿ç”¨äº†ä¸åŒçš„å‚çº¿å’Œåº•çº¿å€¼ï¼Œç„¶åä½¿ç”¨äº†tanå‡½æ•°æ¥è·å–æ—‹è½¬è§’åº¦ã€‚ åŒæ ·ï¼Œè¿™åªæ˜¯åå¤è¯•éªŒã€‚ ä½¿ç”¨point.xå’Œå®¹å™¨çš„å®½åº¦ä½œä¸ºä¸¤ä¸ªå‘¨é•¿ä¼¼ä¹å¾ˆå¥½ã€‚ éšæ„å°è¯•è¿™äº›å€¼ã€‚ <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">case</span></span> .changed: <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> rotation = tan(point.x / (<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.frame.width * <span class="hljs-number"><span class="hljs-number">2.0</span></span>)) card.transform = <span class="hljs-type"><span class="hljs-type">CGAffineTransform</span></span>(rotationAngle: rotation)</code> </pre> <br> ç°åœ¨è®©æˆ‘ä»¬è°ˆè°ˆå§”æ‰˜å‡½æ•°ã€‚ æˆ‘ä»¬å°†ä½¿ç”¨å§”æ‰˜å‡½æ•°åœ¨SwipeCardViewå’ŒContainerViewä¹‹é—´è¿›è¡Œé€šä¿¡ã€‚ <br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">protocol</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SwipeCardsDelegate</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">swipeDidEnd</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(on view: SwipeCardView)</span></span></span></span> }</code> </pre> <br> æ­¤åŠŸèƒ½å°†è€ƒè™‘åˆ·å¡å‘ç”Ÿçš„ç±»å‹ï¼Œæˆ‘ä»¬å°†é‡‡å–å‡ ä¸ªæ­¥éª¤å°†å…¶ä»å­è§†å›¾ä¸­åˆ é™¤ï¼Œç„¶åé‡åšå…¶ä¸‹æ–¹å¡ç‰‡çš„æ‰€æœ‰æ¡†æ¶ã€‚ æ–¹æ³•å¦‚ä¸‹ï¼š <br><br><pre> <code class="swift hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">swipeDidEnd</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(on view: SwipeCardView)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">guard</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> datasource = dataSource <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> } view.removeFromSuperview() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> remainingcards &gt; <span class="hljs-number"><span class="hljs-number">0</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> newIndex = datasource.numberOfCardsToShow() - remainingcards addCardView(cardView: datasource.card(at: newIndex), atIndex: <span class="hljs-number"><span class="hljs-number">2</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (cardIndex, cardView) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> visibleCards.reversed().enumerated() { <span class="hljs-type"><span class="hljs-type">UIView</span></span>.animate(withDuration: <span class="hljs-number"><span class="hljs-number">0.2</span></span>, animations: { cardView.center = <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.center <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.addCardFrame(index: cardIndex, cardView: cardView) <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.layoutIfNeeded() }) } }<span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (cardIndex, cardView) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> visibleCards.reversed().enumerated() { <span class="hljs-type"><span class="hljs-type">UIView</span></span>.animate(withDuration: <span class="hljs-number"><span class="hljs-number">0.2</span></span>, animations: { cardView.center = <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.center <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.addCardFrame(index: cardIndex, cardView: cardView) <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.layoutIfNeeded() }) } } }</code> </pre> <br> é¦–å…ˆä»è¶…çº§è§†å›¾ä¸­åˆ é™¤è¯¥è§†å›¾ã€‚ å®Œæˆæ­¤æ“ä½œåï¼Œæ£€æŸ¥æ˜¯å¦è¿˜æœ‰å‰©ä½™çš„å¡ã€‚ å¦‚æœæœ‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°†ä¸ºè¦åˆ›å»ºçš„å¡åˆ›å»ºä¸€ä¸ªæ–°ç´¢å¼•ã€‚ æˆ‘ä»¬å°†å‡å»è¦ä¸å…¶ä»–å¡ä¸€èµ·æ˜¾ç¤ºçš„å¡æ€»æ•°æ¥åˆ›å»ºnewIndexã€‚ ç„¶åï¼Œæˆ‘ä»¬å°†åœ°å›¾æ·»åŠ ä¸ºå­è§†å›¾ã€‚ ä½†æ˜¯ï¼Œæ­¤æ–°å¡å°†æ˜¯æœ€ä½çš„ï¼Œå› æ­¤æˆ‘ä»¬å‘é€çš„2å¡å°†åŸºæœ¬ä¸Šä¿è¯æ·»åŠ çš„å¸§ä¸ç´¢å¼•2æˆ–æœ€ä½çš„å¡åŒ¹é…ã€‚ <br><br> è¦ä¸ºå‰©ä½™å¡ç‰‡çš„å¸§è®¾ç½®åŠ¨ç”»ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨å­è§†å›¾ç´¢å¼•ã€‚ ä¸ºæ­¤ï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªæ•°ç»„visibleCardsï¼Œè¯¥æ•°ç»„å°†å®¹å™¨çš„æ‰€æœ‰å­è§†å›¾åŒ…å«ä¸ºä¸€ä¸ªæ•°ç»„ã€‚ <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> visibleCards: [<span class="hljs-type"><span class="hljs-type">SwipeCardView</span></span>] { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> subviews <span class="hljs-keyword"><span class="hljs-keyword">as</span></span>? [<span class="hljs-type"><span class="hljs-type">SwipeCardView</span></span>] ?? [] }</code> </pre> <br> ä½†æ˜¯ï¼Œé—®é¢˜åœ¨äºvisibleCardsæ•°ç»„å°†å…·æœ‰åå‘çš„å­è§†å›¾ç´¢å¼•ã€‚ å› æ­¤ï¼Œç¬¬ä¸€å¼ ç‰Œå°†æ’åœ¨ç¬¬ä¸‰ä½ï¼Œç¬¬äºŒå¼ ç‰Œå°†ä¿æŒåœ¨ç¬¬äºŒä½ï¼Œç¬¬ä¸‰å¼ ç‰Œå°†å¤„äºç¬¬ä¸€ä½ã€‚ ä¸ºäº†é˜²æ­¢è¿™ç§æƒ…å†µçš„å‘ç”Ÿï¼Œæˆ‘ä»¬å°†ä»¥ç›¸åçš„é¡ºåºè¿è¡ŒvisibleCardsæ•°ç»„ï¼Œä»¥è·å–å®é™…çš„å­è§†å›¾ç´¢å¼•ï¼Œè€Œä¸æ˜¯å®ƒä»¬åœ¨visibleCardsæ•°ç»„ä¸­çš„ä½ç½®ã€‚ <br><br><pre> <code class="swift hljs"> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (cardIndex, cardView) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> visibleCards.reversed().enumerated() { <span class="hljs-type"><span class="hljs-type">UIView</span></span>.animate(withDuration: <span class="hljs-number"><span class="hljs-number">0.2</span></span>, animations: { cardView.center = <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.center <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.addCardFrame(index: cardIndex, cardView: cardView) <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.layoutIfNeeded() }) }</code> </pre> <br> å› æ­¤ï¼Œç°åœ¨æˆ‘ä»¬å°†æ›´æ–°å…¶ä½™cardViewsçš„æ¡†æ¶ã€‚ <br><br> ä»…æ­¤è€Œå·²ã€‚ è¿™æ˜¯å‘ˆç°å°‘é‡æ•°æ®çš„ç†æƒ³æ–¹æ³•ã€‚ </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN448664/">https://habr.com/ru/post/zh-CN448664/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN448648/index.html">å¦‚ä½•è®©æ¯ä¸ªäººéƒ½åä¸Šç§‘å­¦ï¼Œè€Œä¸æ˜¯å°†åŠå…¬å®¤å˜æˆä»‡æ¨çš„æ¸©åºŠ</a></li>
<li><a href="../zh-CN448652/index.html">Raspberry Piä¸Šçš„Mozilla WebThings-å…¥é—¨</a></li>
<li><a href="../zh-CN448654/index.html">Mozilla WebThings-ç½‘å…³è®¾ç½®</a></li>
<li><a href="../zh-CN448656/index.html">è€å¤§å“¥æ­£åœ¨æ³¨è§†ç€â€¦â€¦ä»–è‡ªå·±æˆ–ä¸€å¼ å¸¦æœ‰HomeAssistantè¿åŠ¨å†å²çš„åœ°å›¾</a></li>
<li><a href="../zh-CN448658/index.html">é€šè¿‡æ±½è½¦ä¸­çš„OBDè¿æ¥å™¨å¯ä»¥åšä»€ä¹ˆ</a></li>
<li><a href="../zh-CN448666/index.html">æˆ‘ä»¬å¦‚ä½•é€‰æ‹©ä¸å®¢æˆ·è¿›è¡Œç”µå­æ–‡æ¡£ç®¡ç†çš„æœåŠ¡</a></li>
<li><a href="../zh-CN448668/index.html">æ•æ·ï¼šITä¸­æœ€å¤§çš„æ€æƒ³é—®é¢˜</a></li>
<li><a href="../zh-CN448670/index.html">åµŒå…¥å¼æ¥å£è®¾è®¡</a></li>
<li><a href="../zh-CN448672/index.html">ç½‘ç»œç ”è®¨ä¼š-ä½¿ç”¨äº§å“Aladdin R.D.çš„VMware Horizoâ€‹â€‹n ViewåŸºç¡€æ¶æ„ä¸­çš„ä¸¤å› ç´ èº«ä»½éªŒè¯å’ŒESã€‚</a></li>
<li><a href="../zh-CN448674/index.html">è‹”è—“å’ŒçŒ›mmè±¡ï¼ˆç¬¬2éƒ¨åˆ†ï¼‰</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>