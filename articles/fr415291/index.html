<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🏇🏽 🤕 💩 Radio: radio FM basée sur Atmega328-P et RDA5807M ☘️ 🍹 🍟</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bonjour, cher harazhiteli! 

 Mon nom est Mikhail Matveev, et je voudrais porter à votre attention un projet de «concepteur radio» moderne basé sur la...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Radio: radio FM basée sur Atmega328-P et RDA5807M</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/415291/"> Bonjour, cher harazhiteli! <br><br>  Mon nom est Mikhail Matveev, et je voudrais porter à votre attention un projet de «concepteur radio» moderne basé sur la puce Atmega328 MK et RDA5807M. <br><br><h2>  Contexte </h2><br>  Je pense que beaucoup d'entre vous ont non seulement entendu parler, mais aussi rencontré directement une plate-forme telle que Arduino.  Et comme mes statistiques personnelles le montrent, très peu vont plus loin que les LED clignotantes.  Lorsque j'ai rencontré Arduino pour la première fois, j'ai été arrêté par le fait qu'il n'y avait aucune idée de la façon dont je pouvais utiliser toutes les fonctionnalités du même UNO dans la «mesure la plus complète».  De quoi assembler un simple robot sur deux roues et une alarme.  Cependant, je voulais faire quelque chose de plus approfondi. <a name="habracut"></a><br><br>  Puis je me suis souvenu de mon enfance, où il y avait des soi-disant «concepteurs de radio».  Un kit de bricolage soviétique sévère, qui, avec un assemblage et une soudure appropriés, a même commencé à fonctionner et a capturé des stations de radio dans diverses gammes: Youth, Electron-M et autres. <br><br><img src="https://habrastorage.org/webt/g2/is/hc/g2ishchig43dyihdouakzc4kspq.jpeg"><br><br>  Aucun de ces Kit'ov je n'ai pas eu, mais j'ai obtenu ECON-1: <br><br><img src="https://habrastorage.org/webt/3r/nu/k3/3rnuk3lqxypldc7utz_exr3mlas.jpeg"><br><br>  Le principal «truc» de ce concepteur était qu'avec son aide, il était possible d'assembler rapidement et simplement un grand nombre d'appareils différents, des simples «tweeters» à un récepteur radio à part entière. <br>  ECON-1 est l'une des nombreuses raisons pour lesquelles je me suis retrouvé dans le domaine informatique.  Et il m'est venu à l'esprit qu'il serait bien de créer une version moderne d'un tel designer, afin que tout le monde puisse profiter de l'appareil assemblé de ses propres mains. <br><br><h2>  Prototype sur circuit imprimé </h2><br>  Mon ami, un ingénieur talentueux Konstantin Tomarevsky, a soutenu l'idée, et nous avons commencé à réfléchir à la façon de fabriquer le premier prototype. <br><br>  L'idée était de créer un récepteur FM qui pourrait être contrôlé via MK. <br>  Le premier prototype a été assemblé sur le site d'installation, et il est devenu clair que cela fonctionne :) <br><br><img src="https://habrastorage.org/webt/mx/37/d_/mx37d_ip32bxh5iskl8we4fvsd8.jpeg"><br><br>  Pour la toute première version, les composants suivants ont été sélectionnés: <br><br>  1. MK Atmega328P-PU <br>  2. RDA5807M <br>  3. Écran du Nokia 5110 <br><br>  Un tel microcontrôleur est utilisé dans Arduino UNO, respectivement, notre appareil est compatible avec UNO au niveau matériel. <br><br>  Le RDA5807M est le «cœur» de notre designer.  Ce tuner a les caractéristiques suivantes: <br><br>  - Technologie CMOS <br>  - Boîtier monolithique, ne nécessite pas (presque) de composants externes <br>  - Bande de fréquence: 50-115 MHz <br>  - Pas entre les canaux - de 200 à 25 kHz <br>  - RDS / RBDS <br>  - ADC et synthétiseur de fréquence intégré <br>  - Réduction adaptative du bruit <br>  - Interface numérique (I2C) <br>  - Force du signal (RSSI) <br>  - Amplificateur <br>  - Réglage du volume sonore <br><br>  L'écran de Nokia est en noir et blanc, 84x48 pixels.  Il est très facile de se connecter et de gérer. <br><br>  Après avoir soudé sur la carte de circuit imprimé, il s'est avéré quelque chose comme ceci: <br><br><img src="https://habrastorage.org/webt/xh/2z/iq/xh2ziqa5kbwdzrczgj0d_buxc3q.jpeg"><br><br>  Il a été décidé d'utiliser le Bootloader d'Arduino, cela nous a permis de maintenir la compatibilité avec toutes les nombreuses bibliothèques et de réduire considérablement le seuil d'entrée pour ceux qui avaient déjà une expérience avec la plate-forme. <br>  L'interface d'interaction utilisateur est implémentée comme suit.  Trois boutons connectés à l'entrée analogique du MK via des résistances sont utilisés pour changer de mode et contrôler le récepteur.  Un autre bouton sert à redémarrer le MK.  L'écran affiche en conséquence des informations sur le volume, la station, etc. <br><br><h2>  LUT, photorésist et débogage </h2><br>  Après des tests réussis sur le circuit imprimé, nous avons décidé de créer plusieurs autres prototypes en utilisant la méthode LUT (et à l'avenir, en utilisant la résine photosensible).  Nous avons également décidé d'améliorer le récepteur en y ajoutant un autre amplificateur de son pour connecter non seulement un casque, mais aussi un haut-parleur externe.  Le choix s'est porté sur le PAM8403, c'est un amplificateur simple et peu coûteux qui nécessite une puissance de 5V. <br><br>  Le premier prototype fabriqué par la méthode LUT se présente comme suit: <br><br><img src="https://habrastorage.org/webt/fn/ji/jo/fnjijodeszqegs5iffb6egidcmo.jpeg"><br><br>  La LUT est une bonne chose pour un prototypage relativement rapide à la maison, mais quand il s'agit de cartes double face, les difficultés commencent.  Le nombre de composants sur la carte a augmenté - par exemple, nous avons décidé de placer un connecteur pour le programmateur sur la carte afin qu'il ne soit pas nécessaire de retirer le MK à chaque fois pour le clignotement.  Ainsi, le prototype suivant est devenu bilatéral, a été fabriqué par la méthode de la résine photosensible et a commencé à être beaucoup plus joli: <br><br><img src="https://habrastorage.org/webt/5f/wf/dk/5fwfdkhw4vfrv85qfcldmzgtx8i.jpeg"><br><br>  En montage: <br><br><img src="https://habrastorage.org/webt/li/zw/yt/lizwytnutcsp25hppt4ekhlvik0.jpeg"><br><br>  L'étape suivante a été le rejet des composants «articulés» que nous avons placés sur la carte à l'aide de codes PIN à une rangée.  Il a donc été décidé de remplacer l'amplificateur par un LM386N, d'installer un convertisseur de niveau CD4050BE.  Tout cela a compliqué la conception, mais l'appareil a commencé à paraître beaucoup mieux. <br><br>  Le prototype final que nous avons fabriqué à la maison ressemblait à ceci: <br><br><img src="https://habrastorage.org/webt/ba/0k/bv/ba0kbvebxojxd2jhnatgbhetrhs.jpeg"><br><br><h2>  Commande de PCB </h2><br>  En Chine, vous pouvez commander des circuits imprimés fabriqués de manière industrielle.  Le coût est relativement faible, même avec de petites séries, et le temps d'attente (y compris la livraison) ne dépasse généralement pas 2-3 semaines. <br><br>  Le premier "lot" de cartes commandées sur PCBWay.  Elle a donc regardé: <br><br><img src="https://habrastorage.org/webt/kd/uk/bw/kdukbwgr9upfot-ygn61o0r860c.jpeg"><br><br>  L'un des problèmes que nous avons rencontrés à cause de l'inexpérience: la métallisation «mange» une partie importante de la taille du trou lui-même, de sorte que certains composants «s'insèrent» difficilement dans les trous désirés.  Lors de la conception d'un circuit, ce point doit être pris en compte. <br><br>  Sur la base des résultats des tests, nous avons affiné la conception en ajoutant plusieurs condensateurs pour un fonctionnement plus stable de l'appareil.  Nous avons collecté un autre prototype: <br><br><img src="https://habrastorage.org/webt/8s/-h/3y/8s-h3y55bje7nttvkmj_z_zyvjk.jpeg"><br><br>  Le port USB est utilisé pour alimenter le récepteur.  L'alimentation est également fournie lorsque le programmateur est connecté. <br><br>  Tout fonctionne! <br><br><h2>  Firmware </h2><br>  Il faut aussi s'attarder sur le firmware.  Il est écrit en C ++ et nous le distribuons sous la licence GPLv3: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">https://github.com/xtremespb/fm_receiver.</a> Je n'ai pratiquement pas développé en C / C ++, donc (probablement) le code est loin d'être idéal et peut contenir des erreurs, mais la GPL ne et la GPL pour qu'elle puisse être développée par la communauté :) <br><br>  Les fonctionnalités actuelles du firmware comprendront: <br><br>  - Réglage manuel et automatique des stations <br>  - RDS <br>  - Contrôle du volume <br>  - Activation du mode de basse amélioré <br>  - Activer ou désactiver le rétroéclairage de l'écran <br>  - Affichage et visualisation dynamique du niveau du signal <br><br>  Dans la quatrième révision suivante, nous ferons des «puces» plus utiles: nous connecterons les canaux gauche et droit aux entrées analogiques du MK, ce qui nous permettra de «visualiser» le signal audio entrant. <br><br>  Soit dit en passant, les capacités de l'appareil ne se limitent pas à la radio!  Personne ne se soucie, par exemple, d'écrire un jeu (par intérêt, j'ai fait le bon vieux Arkanoid) ou un autre programme qui utilise les capacités de la carte. <br><br><h2>  La production </h2><br>  Le développement de l'appareil de l'idée à la mise en œuvre a pris environ 6 mois, ce qui, avec un manque d'expérience presque complet dans ce domaine, n'est pas si mal. <br><br>  À l'heure actuelle, nous avons environ 10 kits entièrement assemblés qui comprennent tout ce dont vous avez besoin pour construire votre propre appareil: <br><br>  - MK Atmega328P-PU <br>  - Convertisseur de niveau CD4050BE <br>  - Afficher Nokia 5110 <br>  - Récepteur RDA5807M <br>  - Programmeur USBasp <br>  - Amplificateur opérationnel LM386N <br>  - Connecteurs pour MK et programmeur <br>  - USB B, Audio Jack 3.5, trois boutons, fils, connecteurs à une rangée <br>  - 11 résistances et 12 condensateurs, 4 inductances, quartz, une diode zener et une LED <br>  - conférencier <br>  - circuit imprimé <br><br>  Pour l'assemblage, vous avez besoin de soudure, de flux et d'un fer à souder, rien d'autre n'est nécessaire. <br>  Tous les composants sont emballés dans une petite boîte en carton «artisanal»: <br><br><img src="https://habrastorage.org/webt/mr/b3/5c/mrb35cyc1fyt3lgxmrh1zdykqxs.jpeg"><br><br>  Les sources du firmware ont déjà été publiées sur Github;  Le fichier Gerber, le diagramme schématique et les instructions d'assemblage seront également publiés ultérieurement. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr415291/">https://habr.com/ru/post/fr415291/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr415279/index.html">Pourquoi marteler les ongles avec un microscope si vous avez Alpine Linux?</a></li>
<li><a href="../fr415283/index.html">Projet OWASP TOP 10: Introduction</a></li>
<li><a href="../fr415285/index.html">MBLT DEV 2018: premiers intervenants et derniers billets pour les lève-tôt</a></li>
<li><a href="../fr415287/index.html">Classification des propriétés des volumes spatio-temporels (défense aérienne)</a></li>
<li><a href="../fr415289/index.html">Test de foule, ou Où acquérir de l'expérience pour le premier travail de test</a></li>
<li><a href="../fr415297/index.html">Xbox Underground. Jeune et insouciant</a></li>
<li><a href="../fr415299/index.html">Meetup Zabbix Moscou 2018 à Badoo: revue et matériel</a></li>
<li><a href="../fr415301/index.html">Notions de base sur le code: didacticiels gratuits pour débutants</a></li>
<li><a href="../fr415303/index.html">La langue des Rolling Stones: comment dessiner un logo pour toujours? Entretien avec le créateur</a></li>
<li><a href="../fr415305/index.html">Rapport 2018 du Club de Rome, chapitre 3.15: Leadership collectif</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>