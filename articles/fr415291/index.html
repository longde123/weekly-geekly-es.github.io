<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üèáüèΩ ü§ï üí© Radio: radio FM bas√©e sur Atmega328-P et RDA5807M ‚òòÔ∏è üçπ üçü</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bonjour, cher harazhiteli! 

 Mon nom est Mikhail Matveev, et je voudrais porter √† votre attention un projet de ¬´concepteur radio¬ª moderne bas√© sur la...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Radio: radio FM bas√©e sur Atmega328-P et RDA5807M</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/415291/"> Bonjour, cher harazhiteli! <br><br>  Mon nom est Mikhail Matveev, et je voudrais porter √† votre attention un projet de ¬´concepteur radio¬ª moderne bas√© sur la puce Atmega328 MK et RDA5807M. <br><br><h2>  Contexte </h2><br>  Je pense que beaucoup d'entre vous ont non seulement entendu parler, mais aussi rencontr√© directement une plate-forme telle que Arduino.  Et comme mes statistiques personnelles le montrent, tr√®s peu vont plus loin que les LED clignotantes.  Lorsque j'ai rencontr√© Arduino pour la premi√®re fois, j'ai √©t√© arr√™t√© par le fait qu'il n'y avait aucune id√©e de la fa√ßon dont je pouvais utiliser toutes les fonctionnalit√©s du m√™me UNO dans la ¬´mesure la plus compl√®te¬ª.  De quoi assembler un simple robot sur deux roues et une alarme.  Cependant, je voulais faire quelque chose de plus approfondi. <a name="habracut"></a><br><br>  Puis je me suis souvenu de mon enfance, o√π il y avait des soi-disant ¬´concepteurs de radio¬ª.  Un kit de bricolage sovi√©tique s√©v√®re, qui, avec un assemblage et une soudure appropri√©s, a m√™me commenc√© √† fonctionner et a captur√© des stations de radio dans diverses gammes: Youth, Electron-M et autres. <br><br><img src="https://habrastorage.org/webt/g2/is/hc/g2ishchig43dyihdouakzc4kspq.jpeg"><br><br>  Aucun de ces Kit'ov je n'ai pas eu, mais j'ai obtenu ECON-1: <br><br><img src="https://habrastorage.org/webt/3r/nu/k3/3rnuk3lqxypldc7utz_exr3mlas.jpeg"><br><br>  Le principal ¬´truc¬ª de ce concepteur √©tait qu'avec son aide, il √©tait possible d'assembler rapidement et simplement un grand nombre d'appareils diff√©rents, des simples ¬´tweeters¬ª √† un r√©cepteur radio √† part enti√®re. <br>  ECON-1 est l'une des nombreuses raisons pour lesquelles je me suis retrouv√© dans le domaine informatique.  Et il m'est venu √† l'esprit qu'il serait bien de cr√©er une version moderne d'un tel designer, afin que tout le monde puisse profiter de l'appareil assembl√© de ses propres mains. <br><br><h2>  Prototype sur circuit imprim√© </h2><br>  Mon ami, un ing√©nieur talentueux Konstantin Tomarevsky, a soutenu l'id√©e, et nous avons commenc√© √† r√©fl√©chir √† la fa√ßon de fabriquer le premier prototype. <br><br>  L'id√©e √©tait de cr√©er un r√©cepteur FM qui pourrait √™tre contr√¥l√© via MK. <br>  Le premier prototype a √©t√© assembl√© sur le site d'installation, et il est devenu clair que cela fonctionne :) <br><br><img src="https://habrastorage.org/webt/mx/37/d_/mx37d_ip32bxh5iskl8we4fvsd8.jpeg"><br><br>  Pour la toute premi√®re version, les composants suivants ont √©t√© s√©lectionn√©s: <br><br>  1. MK Atmega328P-PU <br>  2. RDA5807M <br>  3. √âcran du Nokia 5110 <br><br>  Un tel microcontr√¥leur est utilis√© dans Arduino UNO, respectivement, notre appareil est compatible avec UNO au niveau mat√©riel. <br><br>  Le RDA5807M est le ¬´c≈ìur¬ª de notre designer.  Ce tuner a les caract√©ristiques suivantes: <br><br>  - Technologie CMOS <br>  - Bo√Ætier monolithique, ne n√©cessite pas (presque) de composants externes <br>  - Bande de fr√©quence: 50-115 MHz <br>  - Pas entre les canaux - de 200 √† 25 kHz <br>  - RDS / RBDS <br>  - ADC et synth√©tiseur de fr√©quence int√©gr√© <br>  - R√©duction adaptative du bruit <br>  - Interface num√©rique (I2C) <br>  - Force du signal (RSSI) <br>  - Amplificateur <br>  - R√©glage du volume sonore <br><br>  L'√©cran de Nokia est en noir et blanc, 84x48 pixels.  Il est tr√®s facile de se connecter et de g√©rer. <br><br>  Apr√®s avoir soud√© sur la carte de circuit imprim√©, il s'est av√©r√© quelque chose comme ceci: <br><br><img src="https://habrastorage.org/webt/xh/2z/iq/xh2ziqa5kbwdzrczgj0d_buxc3q.jpeg"><br><br>  Il a √©t√© d√©cid√© d'utiliser le Bootloader d'Arduino, cela nous a permis de maintenir la compatibilit√© avec toutes les nombreuses biblioth√®ques et de r√©duire consid√©rablement le seuil d'entr√©e pour ceux qui avaient d√©j√† une exp√©rience avec la plate-forme. <br>  L'interface d'interaction utilisateur est impl√©ment√©e comme suit.  Trois boutons connect√©s √† l'entr√©e analogique du MK via des r√©sistances sont utilis√©s pour changer de mode et contr√¥ler le r√©cepteur.  Un autre bouton sert √† red√©marrer le MK.  L'√©cran affiche en cons√©quence des informations sur le volume, la station, etc. <br><br><h2>  LUT, photor√©sist et d√©bogage </h2><br>  Apr√®s des tests r√©ussis sur le circuit imprim√©, nous avons d√©cid√© de cr√©er plusieurs autres prototypes en utilisant la m√©thode LUT (et √† l'avenir, en utilisant la r√©sine photosensible).  Nous avons √©galement d√©cid√© d'am√©liorer le r√©cepteur en y ajoutant un autre amplificateur de son pour connecter non seulement un casque, mais aussi un haut-parleur externe.  Le choix s'est port√© sur le PAM8403, c'est un amplificateur simple et peu co√ªteux qui n√©cessite une puissance de 5V. <br><br>  Le premier prototype fabriqu√© par la m√©thode LUT se pr√©sente comme suit: <br><br><img src="https://habrastorage.org/webt/fn/ji/jo/fnjijodeszqegs5iffb6egidcmo.jpeg"><br><br>  La LUT est une bonne chose pour un prototypage relativement rapide √† la maison, mais quand il s'agit de cartes double face, les difficult√©s commencent.  Le nombre de composants sur la carte a augment√© - par exemple, nous avons d√©cid√© de placer un connecteur pour le programmateur sur la carte afin qu'il ne soit pas n√©cessaire de retirer le MK √† chaque fois pour le clignotement.  Ainsi, le prototype suivant est devenu bilat√©ral, a √©t√© fabriqu√© par la m√©thode de la r√©sine photosensible et a commenc√© √† √™tre beaucoup plus joli: <br><br><img src="https://habrastorage.org/webt/5f/wf/dk/5fwfdkhw4vfrv85qfcldmzgtx8i.jpeg"><br><br>  En montage: <br><br><img src="https://habrastorage.org/webt/li/zw/yt/lizwytnutcsp25hppt4ekhlvik0.jpeg"><br><br>  L'√©tape suivante a √©t√© le rejet des composants ¬´articul√©s¬ª que nous avons plac√©s sur la carte √† l'aide de codes PIN √† une rang√©e.  Il a donc √©t√© d√©cid√© de remplacer l'amplificateur par un LM386N, d'installer un convertisseur de niveau CD4050BE.  Tout cela a compliqu√© la conception, mais l'appareil a commenc√© √† para√Ætre beaucoup mieux. <br><br>  Le prototype final que nous avons fabriqu√© √† la maison ressemblait √† ceci: <br><br><img src="https://habrastorage.org/webt/ba/0k/bv/ba0kbvebxojxd2jhnatgbhetrhs.jpeg"><br><br><h2>  Commande de PCB </h2><br>  En Chine, vous pouvez commander des circuits imprim√©s fabriqu√©s de mani√®re industrielle.  Le co√ªt est relativement faible, m√™me avec de petites s√©ries, et le temps d'attente (y compris la livraison) ne d√©passe g√©n√©ralement pas 2-3 semaines. <br><br>  Le premier "lot" de cartes command√©es sur PCBWay.  Elle a donc regard√©: <br><br><img src="https://habrastorage.org/webt/kd/uk/bw/kdukbwgr9upfot-ygn61o0r860c.jpeg"><br><br>  L'un des probl√®mes que nous avons rencontr√©s √† cause de l'inexp√©rience: la m√©tallisation ¬´mange¬ª une partie importante de la taille du trou lui-m√™me, de sorte que certains composants ¬´s'ins√®rent¬ª difficilement dans les trous d√©sir√©s.  Lors de la conception d'un circuit, ce point doit √™tre pris en compte. <br><br>  Sur la base des r√©sultats des tests, nous avons affin√© la conception en ajoutant plusieurs condensateurs pour un fonctionnement plus stable de l'appareil.  Nous avons collect√© un autre prototype: <br><br><img src="https://habrastorage.org/webt/8s/-h/3y/8s-h3y55bje7nttvkmj_z_zyvjk.jpeg"><br><br>  Le port USB est utilis√© pour alimenter le r√©cepteur.  L'alimentation est √©galement fournie lorsque le programmateur est connect√©. <br><br>  Tout fonctionne! <br><br><h2>  Firmware </h2><br>  Il faut aussi s'attarder sur le firmware.  Il est √©crit en C ++ et nous le distribuons sous la licence GPLv3: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">https://github.com/xtremespb/fm_receiver.</a> Je n'ai pratiquement pas d√©velopp√© en C / C ++, donc (probablement) le code est loin d'√™tre id√©al et peut contenir des erreurs, mais la GPL ne et la GPL pour qu'elle puisse √™tre d√©velopp√©e par la communaut√© :) <br><br>  Les fonctionnalit√©s actuelles du firmware comprendront: <br><br>  - R√©glage manuel et automatique des stations <br>  - RDS <br>  - Contr√¥le du volume <br>  - Activation du mode de basse am√©lior√© <br>  - Activer ou d√©sactiver le r√©tro√©clairage de l'√©cran <br>  - Affichage et visualisation dynamique du niveau du signal <br><br>  Dans la quatri√®me r√©vision suivante, nous ferons des ¬´puces¬ª plus utiles: nous connecterons les canaux gauche et droit aux entr√©es analogiques du MK, ce qui nous permettra de ¬´visualiser¬ª le signal audio entrant. <br><br>  Soit dit en passant, les capacit√©s de l'appareil ne se limitent pas √† la radio!  Personne ne se soucie, par exemple, d'√©crire un jeu (par int√©r√™t, j'ai fait le bon vieux Arkanoid) ou un autre programme qui utilise les capacit√©s de la carte. <br><br><h2>  La production </h2><br>  Le d√©veloppement de l'appareil de l'id√©e √† la mise en ≈ìuvre a pris environ 6 mois, ce qui, avec un manque d'exp√©rience presque complet dans ce domaine, n'est pas si mal. <br><br>  √Ä l'heure actuelle, nous avons environ 10 kits enti√®rement assembl√©s qui comprennent tout ce dont vous avez besoin pour construire votre propre appareil: <br><br>  - MK Atmega328P-PU <br>  - Convertisseur de niveau CD4050BE <br>  - Afficher Nokia 5110 <br>  - R√©cepteur RDA5807M <br>  - Programmeur USBasp <br>  - Amplificateur op√©rationnel LM386N <br>  - Connecteurs pour MK et programmeur <br>  - USB B, Audio Jack 3.5, trois boutons, fils, connecteurs √† une rang√©e <br>  - 11 r√©sistances et 12 condensateurs, 4 inductances, quartz, une diode zener et une LED <br>  - conf√©rencier <br>  - circuit imprim√© <br><br>  Pour l'assemblage, vous avez besoin de soudure, de flux et d'un fer √† souder, rien d'autre n'est n√©cessaire. <br>  Tous les composants sont emball√©s dans une petite bo√Æte en carton ¬´artisanal¬ª: <br><br><img src="https://habrastorage.org/webt/mr/b3/5c/mrb35cyc1fyt3lgxmrh1zdykqxs.jpeg"><br><br>  Les sources du firmware ont d√©j√† √©t√© publi√©es sur Github;  Le fichier Gerber, le diagramme sch√©matique et les instructions d'assemblage seront √©galement publi√©s ult√©rieurement. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr415291/">https://habr.com/ru/post/fr415291/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr415279/index.html">Pourquoi marteler les ongles avec un microscope si vous avez Alpine Linux?</a></li>
<li><a href="../fr415283/index.html">Projet OWASP TOP 10: Introduction</a></li>
<li><a href="../fr415285/index.html">MBLT DEV 2018: premiers intervenants et derniers billets pour les l√®ve-t√¥t</a></li>
<li><a href="../fr415287/index.html">Classification des propri√©t√©s des volumes spatio-temporels (d√©fense a√©rienne)</a></li>
<li><a href="../fr415289/index.html">Test de foule, ou O√π acqu√©rir de l'exp√©rience pour le premier travail de test</a></li>
<li><a href="../fr415297/index.html">Xbox Underground. Jeune et insouciant</a></li>
<li><a href="../fr415299/index.html">Meetup Zabbix Moscou 2018 √† Badoo: revue et mat√©riel</a></li>
<li><a href="../fr415301/index.html">Notions de base sur le code: didacticiels gratuits pour d√©butants</a></li>
<li><a href="../fr415303/index.html">La langue des Rolling Stones: comment dessiner un logo pour toujours? Entretien avec le cr√©ateur</a></li>
<li><a href="../fr415305/index.html">Rapport 2018 du Club de Rome, chapitre 3.15: Leadership collectif</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>