<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üì∞ üç¨ üçõ Est-il possible d'utiliser Tibero au lieu d'Oracle. Et est-ce n√©cessaire üë®‚Äçüé® üìù üõ¨</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dans cet article, je vais vous dire comment j'ai s√©rieusement pens√© √† une alternative √† Oracle. Mais qu'en est-il de Postgre, dites-vous? Oui, mais il...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Est-il possible d'utiliser Tibero au lieu d'Oracle. Et est-ce n√©cessaire</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/413147/">  Dans cet article, je vais vous dire comment j'ai s√©rieusement pens√© √† une alternative √† Oracle.  Mais qu'en est-il de Postgre, dites-vous?  Oui, mais il y a des nuances.  Nous allons d'abord traiter de la question "Pourquoi Oracle?" <br>  Logique m√©tier dans notre base de donn√©es.  Dans le livre Oracle pour les professionnels, Tom Kite √©crit <br><blockquote>  Lors du d√©veloppement d'applications de base de donn√©es, j'utilise un mantra tr√®s simple: <br><br>  si possible, faites-le avec une seule instruction SQL; <br>  si cela ne peut pas √™tre fait avec une seule instruction SQL, faites-le en PL / SQL; <br>  si cela ne peut pas √™tre fait en PL / SQL, essayez d'utiliser une proc√©dure stock√©e Java; <br>  si cela ne peut pas √™tre fait en Java, faites-le comme une proc√©dure externe en C; <br>  si cela ne peut pas √™tre impl√©ment√© en tant que proc√©dure externe en C, vous devez s√©rieusement r√©fl√©chir √† la raison pour laquelle cela est g√©n√©ralement fait ... </blockquote>  et dans la conception du syst√®me, je respecte cette r√®gle.  Les types d'objets dans Oracle sont particuli√®rement agr√©ables; avec leur aide, une logique m√©tier complexe est magnifiquement et commod√©ment impl√©ment√©e selon tous les canons de la POO. <br><br>  Oracle co√ªte cher.  L'acheter et ne pas utiliser tout ce qu'il contient sera une erreur. <br>  Et pourtant, il y a toujours un facteur d'√©quipe et de comp√©tences.  Si votre √©quipe a tout d√©velopp√© chez Oracle depuis dix ans, la publication de Postgre peut √™tre p√©nible. <br><br>  Oracle co√ªte cher.  Si cher que vous pouvez √©crire plusieurs fois √† ce sujet et ne pas penser √† la n√©cessit√© d'Oracle dans un nouveau projet sera une erreur. <br><br>  Plusieurs fois d√©j√†, je suis tomb√© sur des publications sur le produit cor√©en Tibero, soi-disant cr√©√© pour remplacer Oracle.  Et maintenant, ils ont un attrait d'une g√©n√©rosit√© sans pr√©c√©dent - Les licences standard sont distribu√©es presque gratuitement aux d√©veloppeurs, pour un dollar pour un socket.  Donc, nous comprenons: ce que les Cor√©ens peuvent offrir en ce moment.  Avec les voitures, apr√®s tout, ils ont d√©j√† (presque) r√©ussi! <br><a name="habracut"></a><br><h3>  Description de l'exp√©rience </h3><br>  Les repr√©sentants de TMaxSoft disent que Tibero est presque 100% compatible avec Oracle et qu'il existe un utilitaire pour la migration de la base de donn√©es.  J'ai d√©cid√© de prendre ma base de produits, avec une logique m√©tier dans Oracle, en utilisant tout le charme de la POO en PL \ SQL, et de la transf√©rer vers Tibero.  Dans cette publication, nous ne consid√©rons pas la migration des donn√©es elle-m√™me, elle est moins int√©ressante, et je n'ai pas encore essay√© une migration compl√®te. <br><br>  La t√¢che est la suivante: <br><br>  1. Tables de transfert. <br>  2. Transfert d'index, de cl√©s, etc. <br>  3. Transf√©rez les paquets et les d√©clencheurs. <br>  4. Transfert des types d'objets. <br><br>  Mais d'abord, parlons des outils. <br><br><h3>  Les outils </h3><br>  Google en sait peu sur Tibero.  Nous avons t√©l√©charg√© la base de donn√©es elle-m√™me sous la forme d'une machine virtuelle sur laquelle tout a d√©j√† √©t√© d√©ploy√©.  Il n'y a que deux outils: un utilitaire pour migrer T-UP et un IDE pour DBA et le d√©veloppeur tbAdmin.  Tout se fait en Java, s'ex√©cute n'importe o√π, en th√©orie. <br><br>  T-UP ressemble √† ceci: <br><br><img src="https://habrastorage.org/webt/oi/gn/_a/oign_ablqrxbbwtiutwczw6adi0.jpeg"><br>  <i>Fen√™tre principale: connexions √† la base de donn√©es.</i> <br><br><img src="https://habrastorage.org/webt/yz/3f/cx/yz3fcxrlhslegdkikvd_9iv5qx4.jpeg"><br>  <i>Si vous cliquez sur Options, vous pouvez configurer quelque chose.</i> <br><br><img src="https://habrastorage.org/webt/vt/rb/9a/vtrb9a6od2ep0tjh_mhczcd9zv8.jpeg"><br>  <i>Plus important encore, vous pouvez s√©lectionner les types d'objets √† migrer.</i> <br><br>  Aucune instruction, aide, astuces n'a pu √™tre trouv√©e. <br>  Cela donne l'impression d'un utilitaire fait maison.  Parfois, elle s'envolait avec des ex√©cutions, mais elle travaillait au besoin. <br><br>  Le deuxi√®me outil est l'IDE Tibero Admin.  Il peut √™tre t√©l√©charg√© √† partir du site Web de TMaxSoft si vous vous y inscrivez d'abord.  Vous pouvez √©galement y obtenir une licence de d√©monstration. <br><br><img src="https://habrastorage.org/webt/7n/fh/py/7nfhpypymbdibdgxbntldsa0jrm.jpeg"><br>  <i>Tibero Admin ressemble √† un ancien IDE typique</i> <br><br>  Je suis habitu√© √† l'excellent outil de d√©veloppement PL / SQL d'Allround Automations.  Dans Tibero Admin, oubliez les invites contextuelles, rien n'appara√Ætra sur votre √©cran apr√®s avoir cliqu√© sur le ¬´point¬ª, il ne vous ajoutera pas les noms des tables et des objets.  Tapez simplement le code, vous les programmeurs.  Aide, documentation?  Non.  Il existe une documentation sur le SGBD sur le site Web du fabricant, un tel int√©ressant ... sans recherche.  Aucune documentation n'a √©t√© trouv√©e pour l'IDE.  Cependant, il n'y a rien de compliqu√©.  Il y a eu des probl√®mes d'autorisation - il s'est av√©r√© que l'utilisateur devait se voir accorder des droits DBA pour acc√©der √† tbAdmin.  Et int√©ressant avec les ports <b>, 8630 est pour SYS, pour tous les autres 8629</b> . <br><br>  Bugs IDE.  De temps en temps, lorsque vous piquez quelque part, l' <i>index des</i> messages <i>hors des limites</i> s'envole, un message comme <b>java.lang.Exception: engagement Succeeded est</b> tr√®s effrayant.  Il est n√©cessaire de prendre en compte diff√©rents types de fen√™tres SQL et PSM: dans le premier, il est peu probable que vous compiliez du code programme, dans le second, vous n'ex√©cuterez pas la demande.  Apr√®s PL / SQL Developer - un mis√©rable semblant de main gauche ... <br><br>  Se rendre √† l'exp√©rience. <br><br><h3>  Migration de table </h3><br>  Nous s√©lectionnons le sch√©ma dans T-UP, cliquez sur Migrer, s√©lectionnez d'abord les ¬´tables¬ª dans les options et le processus de transfert commence.  J'ai rencontr√© deux probl√®mes. <br><br>  TABLESPACES.  J'ai d√©cid√© de les transf√©rer sur des tables, mais Tibero semble avoir essay√© de leur r√©server autant d'espace qu'ils occupent dans la base de donn√©es source.  Et c'est beaucoup, et il ne pouvait pas.  J'ai cr√©√© les espaces table manuellement, puis tout s'est bien pass√©. <br><br>  En plus des tableaux avec des valeurs de date par d√©faut de type '31 .12.2019 '.  Dans les param√®tres Oracle, nous avons ce format enregistr√©, pour Tibero cela aide <pre><code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">alter</span></span> <span class="hljs-keyword"><span class="hljs-keyword">session</span></span> <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> nls_date_format=<span class="hljs-string"><span class="hljs-string">'DD.MM.YYYY'</span></span>;</code> </pre>  mais il n'y a nulle part o√π T-UP peut le faire.  Des coll√®gues de TMaxSoft ont conseill√© de d√©finir la variable TB_NLS_DATE_FORMAT = "DD.MM.YYYY", mais cela ne m'a pas aid√© personnellement.  J'ai peut-√™tre fait quelque chose de mal.  J'ai d√ª cr√©er des tableaux avec de tels param√®tres manuellement, il n'y en a pas beaucoup. <br><br>  R√©sultat de la premi√®re √©tape: le d√©placement de la structure de table d'Oracle vers Tibero fonctionne bien. <br><br><h3>  Cl√©s et index. </h3><br>  Nous s√©lectionnons les cases INDEX, CONSTRAINT dans T-UP et forward. Des probl√®mes sont survenus avec CHECK en raison de la m√™me situation avec la date.  En g√©n√©ral, les index, cl√©s primaires, contr√¥les - ont √©t√© cr√©√©s.  Mais je n'ai pas pu trouver de cl√©s √©trang√®res dans la base de donn√©es fra√Æchement cr√©√©e.  Et la migration des constantes se termine dans le journal T-UP avec le message <b><i>"√âchec de la migration: java.lang.NullPointerException".</i></b>  Co√Øncidence?  Je ne pense pas ... <br><br><h3>  Packages et d√©clencheurs. </h3><br>  Dans les triggers je n'ai rien de compliqu√©, ils ont √©t√© cr√©√©s parfaitement.  Certes, je n'ai pas v√©rifi√© comment ils fonctionnent, ce sera une histoire distincte. <br><br>  Parlons des proc√©dures et des fonctions qui impl√©mentent une partie de la logique.  Ici, malheureusement, tout ne s'est pas parfaitement d√©roul√©. <br><br>  D'un simple: dans l' <s>arm√©e de</s> Tibero il n'y a pas de mot <b>NOUVEAU</b> .  La construction o: = NEW t_my_type () ne se compilera pas.  Dans Oracle, c'est vrai, pas obligatoire, mais j'ai toujours √©crit pour une raison quelconque.  J'ai d√ª supprimer. <br><br>  Le r√¥le DBA permet √† SQL Window d'acc√©der √† toutes les tables.  Cependant, lors de la compilation d'un package ou d'une proc√©dure dans un sch√©ma avec un tel r√¥le, lorsque vous utilisez des tables et des objets d'un autre sch√©ma, vous devez attribuer l'autorisation correspondante √† l'objet.  La magie du r√¥le DBA n'aide pas ici. <br><br>  Du sp√©cifique.  J'ai un √©trange FORALL dans ma base de donn√©es, qui fonctionne cependant. <br><br><pre> <code class="sql hljs"><span class="hljs-comment"><span class="hljs-comment">--     PROCEDURE save_tar_test AS TYPE number_table IS TABLE OF NUMBER INDEX BY BINARY_INTEGER; TYPE date_table IS TABLE OF DATE INDEX BY BINARY_INTEGER; TYPE varchar50_table IS TABLE OF VARCHAR2(50) INDEX BY BINARY_INTEGER; TYPE char1_table IS TABLE OF CHAR(1) INDEX BY BINARY_INTEGER; TYPE t_tar_det_out_upd_rec_test IS RECORD ( --   cmr_tar_det_id number_table, in_stamp date_table, err_code_id number_table ); tdou_rec t_tar_det_out_upd_rec_test; BEGIN --   ,  tdou_rec  :      Oracle FORALL j IN 1 .. tdou_rec.cmr_tar_det_id.COUNT UPDATE cmr_tar_det dd SET err_code_id = tdou_rec.err_code_id(j) WHERE dd.cmr_tar_det_id = tdou_rec.cmr_tar_det_id(j) AND in_stamp = tdou_rec.in_stamp(j); END;</span></span></code> </pre><br>  Tibero dit que <i>"la d√©claration dml doit avoir un param√®tre d'</i> entr√©e en <i>bloc pour toute fermeture"</i> .  Et je le comprends au fond, mais ce code a d√ª √™tre refait dans un cycle r√©gulier. <br><br>  La situation avec des tables contenant des objets est pire. <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">REPLACE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TYPE</span></span> S1.TYPE_PAY_HIST <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OBJECT</span></span> ( pay_status_id <span class="hljs-built_in"><span class="hljs-built_in">NUMBER</span></span>(<span class="hljs-number"><span class="hljs-number">1</span></span>), stamp <span class="hljs-built_in"><span class="hljs-built_in">DATE</span></span> ); <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">REPLACE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TYPE</span></span> S1.TABLE_PAY_HIST <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">VARRAY</span></span>(<span class="hljs-number"><span class="hljs-number">10</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">OF</span></span> type_pay_hist; <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> S2.RECEIPT ( receipt_id <span class="hljs-built_in"><span class="hljs-built_in">NUMBER</span></span>(<span class="hljs-number"><span class="hljs-number">8</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>, pay_sum <span class="hljs-built_in"><span class="hljs-built_in">NUMBER</span></span>(<span class="hljs-number"><span class="hljs-number">12</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>, receipt_hist S1.TABLE_PAY_HIST ); FUNCTION receipt_status_change(p_cmr_receipt_id NUMBER, p_new_status NUMBER) RETURN NUMBER AS l_receipt_hist s1.table_pay_hist; l_type_pay_hist s1.type_pay_hist; l_status NUMBER; <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> receipt_hist <span class="hljs-keyword"><span class="hljs-keyword">INTO</span></span> l_receipt_hist <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> receipt p <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> p.receipt_id = p_cmr_receipt_id <span class="hljs-keyword"><span class="hljs-keyword">FOR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">UPDATE</span></span>; EXCEPTION WHEN NO_DATA_FOUND THEN RETURN c_err_not_find_status; <span class="hljs-keyword"><span class="hljs-keyword">END</span></span>; ... <span class="hljs-keyword"><span class="hljs-keyword">END</span></span>;</code> </pre><br>  Nous avons une erreur de compilation, tapez mistmatch. <br><br>  Les gars de TMaxSoft ont propos√© cette version du code: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> <span class="hljs-keyword"><span class="hljs-keyword">replace</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FUNCTION</span></span> .... <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> l_receipt_hist table_pay_hist; l_type_pay_hist type_pay_hist; l_status NUMBER; cmr_receipt_row cmr_receipt%rowtype; <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">INTO</span></span> cmr_receipt_row <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> cmr_receipt p <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> p.cmr_receipt_id = p_cmr_receipt_id <span class="hljs-keyword"><span class="hljs-keyword">FOR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">UPDATE</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> TYPE_PAY_HIST(r.pay_status_id,r.stamp) <span class="hljs-keyword"><span class="hljs-keyword">bulk</span></span> <span class="hljs-keyword"><span class="hljs-keyword">collect</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INTO</span></span> l_receipt_hist <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> cmr_receipt p,<span class="hljs-keyword"><span class="hljs-keyword">table</span></span>(p.receipt_hist) r <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> p.cmr_receipt_id = p_cmr_receipt_id; EXCEPTION WHEN NO_DATA_FOUND THEN dbms_output.put_line('NO_DATA_FOUND'); RETURN null;<span class="hljs-comment"><span class="hljs-comment">--c_err_not_find_status; END; ... END;</span></span></code> </pre><br>  √áa marche √ßa marche probablement.  Mais pas si pratique, et il faut refaire le code. <br><br>  Le reste est compil√© normalement, sauf pour des choses sp√©cifiques comme SDO_GEOM.  Et en passant, Tibero a un analogue.  Ses mains n'avaient pas encore atteint son bureau. <br><br><h3>  Les types </h3><br>  Dans l'un des projets, nous utilisons la puissance de OOP by Oracle hollow. <br>  La question la plus excitante pour Tibero √©tait √† ce sujet. <br><br>  Nous cr√©ons un certain type, qui est basique pour un ensemble d'autres types. <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">REPLACE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TYPE</span></span> t_tar_object <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OBJECT</span></span> ( <span class="hljs-keyword"><span class="hljs-keyword">id</span></span> <span class="hljs-built_in"><span class="hljs-built_in">NUMBER</span></span>(<span class="hljs-number"><span class="hljs-number">12</span></span>), smth <span class="hljs-built_in"><span class="hljs-built_in">NUMBER</span></span>(<span class="hljs-number"><span class="hljs-number">12</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">CONSTRUCTOR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FUNCTION</span></span> t_tar_object <span class="hljs-keyword"><span class="hljs-keyword">RETURN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SELF</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">RESULT</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">MEMBER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FUNCTION</span></span> target(param <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> <span class="hljs-built_in"><span class="hljs-built_in">NUMBER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">RETURN</span></span> <span class="hljs-built_in"><span class="hljs-built_in">NUMBER</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">MEMBER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FUNCTION</span></span> inside(o t_tar_object) <span class="hljs-keyword"><span class="hljs-keyword">RETURN</span></span> <span class="hljs-built_in"><span class="hljs-built_in">NUMBER</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">MEMBER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FUNCTION</span></span> <span class="hljs-keyword"><span class="hljs-keyword">clone</span></span> <span class="hljs-keyword"><span class="hljs-keyword">RETURN</span></span> t_tar_object ) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FINAL</span></span>; <span class="hljs-comment"><span class="hljs-comment">--  CREATE OR REPLACE TYPE BODY t_tar_object AS CONSTRUCTOR FUNCTION t_tar_object RETURN SELF AS RESULT AS BEGIN RETURN; END; MEMBER FUNCTION target(param IN NUMBER DEFAULT NULL) RETURN NUMBER AS BEGIN RETURN id; END; MEMBER FUNCTION clone RETURN t_tar_object AS BEGIN RETURN NULL ; END; END;</span></span></code> </pre><br>  Et maintenant, nous essayons de lui cr√©er un digne h√©ritier. <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">REPLACE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TYPE</span></span> t_tar_service <span class="hljs-keyword"><span class="hljs-keyword">UNDER</span></span> t_tar_object ( is_virtual <span class="hljs-built_in"><span class="hljs-built_in">NUMBER</span></span>(<span class="hljs-number"><span class="hljs-number">1</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">CONSTRUCTOR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FUNCTION</span></span> t_tar_service (p_serv_obj t_tar_object, p_main_id <span class="hljs-built_in"><span class="hljs-built_in">NUMBER</span></span>, p_pack_id <span class="hljs-built_in"><span class="hljs-built_in">NUMBER</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">RETURN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SELF</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">RESULT</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">OVERRIDING</span></span> <span class="hljs-keyword"><span class="hljs-keyword">MEMBER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FUNCTION</span></span> target(param <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> <span class="hljs-built_in"><span class="hljs-built_in">NUMBER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">RETURN</span></span> <span class="hljs-built_in"><span class="hljs-built_in">NUMBER</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">OVERRIDING</span></span> <span class="hljs-keyword"><span class="hljs-keyword">MEMBER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FUNCTION</span></span> <span class="hljs-keyword"><span class="hljs-keyword">clone</span></span> <span class="hljs-keyword"><span class="hljs-keyword">RETURN</span></span> t_tar_object ) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FINAL</span></span>;</code> </pre><br>  Le compilateur refusera de remplacer la fonction cible.  Cependant, il n'y a pas de questions sur la fonction clone.  Il s'est av√©r√© que Tibero n'aimait pas OVERRIDING lorsque la m√©thode a des param√®tres.  D'accord, supprimez le mot OVERRIDING.  Mais c'est alarmant, et nous √©crivons des scripts de test.  Jusqu'ici avec le type parent. <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">declare</span></span> o1 t_tar_object; i1 number := 100; <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> o1 := t_tar_object; o1.id := 1; i1 := o1.target; <span class="hljs-comment"><span class="hljs-comment">-- dbms_output.put_line (i1)   . --      ,  ,     i1   -- if i1 &gt; 0 then dbms_output.put_line ('big'); end if; if i1 &lt; 0 then dbms_output.put_line ('small'); end if; if i1 = 0 then dbms_output.put_line ('zero'); end if; if i1 is null then dbms_output.put_line ('null'); end if; end;</span></span></code> </pre> <br>  Il semble que nous n'ayons pas laiss√© de choix au programme, quelle que soit la valeur de la variable i1, quelque chose devrait appara√Ætre en sortie.  Mais ... rien n'appara√Æt! <br><br><img src="https://habrastorage.org/webt/tx/bf/he/txbfhe1mekorl0o6ormecblpbj8.jpeg"><br>  <i>Je me suis imm√©diatement souvenu d'un grand film</i> <br><br>  Cette bizarrerie ne s'arr√™te pas l√†.  Aggraver l'exp√©rience <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">declare</span></span> o1 t_tar_object; i1 number := 100; <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> o1 := t_tar_object; o1.id := 1; i1 := o1.target; <span class="hljs-comment"><span class="hljs-comment">--  ,      -    i1 := 2; if i1 &gt; 0 then dbms_output.put_line ('big'); end if; if i1 &lt; 0 then dbms_output.put_line ('small'); end if; if i1 = 0 then dbms_output.put_line ('zero'); end if; if i1 is null then dbms_output.put_line ('null'); end if; end;</span></span></code> </pre> <br>  M√™me le fait qu'apr√®s toutes les manipulations avec les m√©thodes de l'objet, nous fixons de mani√®re rigide la valeur de la variable, ne change rien - la sortie est vide. <br><br>  Exp√©rience de contr√¥le, testez-vous pour la folie: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">declare</span></span> o1 t_tar_object; i1 number ; <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> o1 := t_tar_object; o1.id := 1; <span class="hljs-comment"><span class="hljs-comment">--i1 := o1.target;    i1 := 2; if i1 &gt; 0 then dbms_output.put_line ('big'); end if; if i1 &lt; 0 then dbms_output.put_line ('small'); end if; if i1 = 0 then dbms_output.put_line ('zero'); end if; if i1 is null then dbms_output.put_line ('null'); end if; end;</span></span></code> </pre><br>  Le ¬´grand¬ª ch√©ri appara√Æt dans la sortie.  Flippant, n'est-ce pas?  En utilisant un coup scientifique, les gars de TMaxSoft ont d√©couvert que si vous supprimez la nuance "NOT FINAL" de la sp√©cification t_tar_object, alors l'objet se comportera de mani√®re appropri√©e.  Mais alors pourquoi avons-nous besoin d'un tel ... sans h√©ritiers. <br><br>  Il est inutile de parler davantage de la POO √† Tibero.  Comme, en fait, le POO √† Tibero.  Apr√®s cela, une autre question se pose: et le code de proc√©dures et de fonctions qui a compil√© - fonctionne-t-il correctement?  Je ne sais pas encore.  Une √©norme quantit√© de code a immigr√© et compil√©.  Pour un projet qui ne contient pas les types d'exercices ci-dessus, c'est un succ√®s certain.  Mais tester la bonne ex√©cution du code est une t√¢che s√©rieuse.  Et pour √™tre honn√™te, je ne m'attendais pas √† la rencontrer.  Je ne serai pas pr√™t √† dire si j'aurai un projet sur ce SGBD.  Mais si c'est le cas, le d√©veloppement se fera sur Oracle, √† l'aide d'outils normaux et avec une migration r√©guli√®re vers Tibero.  √âcrire du code dans l'EDI sans invites contextuelles et avec des erreurs p√©riodiques de l'interface elle-m√™me est un plaisir en dessous de la moyenne. <br><br><h3>  Conclusions </h3><br>  Tibero a-t-il un avenir dans son √©tat actuel?  Pas s√ªr.  Apr√®s tout, si vous regardez le co√ªt des licences hors m√©gascale, un socket standard co√ªte environ 800 000. Ce qui est moins cher qu'Oracle, mais pas parfois.  Et comme j'√©tais convaincu de ma propre exp√©rience, jusqu'√† pr√©sent, ce n'est m√™me pas pr√®s d'Oracle. <br><br>  Est-il judicieux d'utiliser le Tibero presque gratuit qui est offert maintenant?  Peut-√™tre que oui.  Ils disent que lors du paiement du co√ªt du support technique (99 000 roubles par an pour une prise), il est permis d'utiliser cette base dans des projets commerciaux.  Si vous avez une √©quipe d'oracleistes disponibles et que vous devez cr√©er et placer quelque chose de pas trop compliqu√© sur votre serveur, mais moins cher et plus rapide - une option int√©ressante.  Vous pouvez toujours jouer la carte des sanctions, en disant aux clients en difficult√© que la Cor√©e n'est pas les √âtats-Unis. <br><br>  Dois-je traduire des projets existants d'Oracle vers Tibero?  Pas question.  Il n'y a aucune raison de rechercher une telle aventure.  Il est plus facile de renoncer au support technique Oracle et de ne rien payer √† personne. <br><br>  Et si vous devez cr√©er une nouvelle instance d'un ancien projet ex√©cut√© sur Oracle?  Et par cons√©quent, acheter de nouvelles licences?  Pensez-y ici.  Il est possible que votre base migre et fonctionne de mani√®re qualitative.  Mais pensez imm√©diatement √† soutenir deux domaines du projet, ou traduisez tout en Tibero.  Nous consid√©rons les co√ªts de main-d'≈ìuvre, les risques et les avantages des licences moins ch√®res.  Comparez, d√©cidez. <br><br>  Peut-√™tre que dans la prochaine version de Tibero, tout sera diff√©rent.  Il suffit de terminer les types, de faire un IDE normal, peut-√™tre de changer la politique de prix.  Et si le SGBD est le m√™me qu'avec les voitures, alors apr√®s 5 ans, les Cor√©ens peuvent occuper une part de march√© importante et supplanter l'h√©g√©monie.  On verra. <br><br><h3>  PS </h3><br>  Un s√©rieux avantage lors du choix d'un SGBD pour un nouveau projet peut √™tre le travail du support technique de TMaxSoft.  Je n'ai m√™me pas achet√© de licence pour un dollar, et les gars m'ont r√©pondu tr√®s rapidement, clairement int√©ress√©s.  Ils ont aid√© √† la fois avec des questions stupides et celles d√©crites ici.  Le retour est excellent. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr413147/">https://habr.com/ru/post/fr413147/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr413137/index.html">Classer de grandes quantit√©s de donn√©es sur Apache Spark √† l'aide de mod√®les d'apprentissage automatique arbitraires</a></li>
<li><a href="../fr413139/index.html">Voitures √©lectriques: la r√©volution arrive</a></li>
<li><a href="../fr413141/index.html">Classer de grandes quantit√©s de donn√©es sur Apache Spark √† l'aide de mod√®les d'apprentissage automatique arbitraires</a></li>
<li><a href="../fr413143/index.html">Bobby Urban Lite: le nouveau sac √† dos urbain de XD Design</a></li>
<li><a href="../fr413145/index.html">Un analyste aide les entreprises √† gagner de l'argent</a></li>
<li><a href="../fr413149/index.html">Entrep√¥t de donn√©es distribu√© dans le concept Data Lake: par o√π commencer</a></li>
<li><a href="../fr413151/index.html">La NSA a propos√© une norme de chiffrement pour les appareils IoT, mais l'ISO l'a rejet√©e</a></li>
<li><a href="../fr413155/index.html">Google Shell Style Guide (en russe)</a></li>
<li><a href="../fr413157/index.html">√Ä propos du stockage des mots de passe dans la base de donn√©es</a></li>
<li><a href="../fr413159/index.html">Interface sombre ou claire? Conseils pour choisir un jeu de couleurs pour votre interface</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>