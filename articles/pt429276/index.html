<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üòü ‚Ü©Ô∏è üë©üèº‚ÄçüöÄ Auto-codificadores variacionais: teoria e c√≥digo de funcionamento üß¢ üîÇ üë®üèª‚Äçüîß</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Um codificador autom√°tico variacional (codificador autom√°tico) √© um modelo generativo que aprende a exibir objetos em um determinado espa√ßo oculto. 

...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Auto-codificadores variacionais: teoria e c√≥digo de funcionamento</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/429276/"><img src="https://habrastorage.org/webt/oj/04/18/oj04189ynqaberjqtksdmbjefmy.jpeg"><br><br>  <i><font color="gray">Um codificador autom√°tico variacional (codificador autom√°tico) √© um modelo generativo que aprende a exibir objetos em um determinado espa√ßo oculto.</font></i> <br><br>  Voc√™ j√° se perguntou como funciona um modelo de codificador autom√°tico variacional (VAE)?  Deseja saber como o VAE gera novos exemplos, como o conjunto de dados em que foi treinado?  Depois de ler este artigo, voc√™ obter√° uma compreens√£o te√≥rica do funcionamento interno do VAE e tamb√©m poder√° implement√°-lo.  Em seguida, mostrarei o c√≥digo VAE de trabalho treinado em um conjunto de d√≠gitos escritos √† m√£o e nos divertiremos, gerando novos d√≠gitos! <br><a name="habracut"></a><br><h1>  Modelos Generativos </h1><br>  O VAE √© um modelo generativo - estima a densidade de probabilidade (PDF) dos dados de treinamento.  Se esse modelo for treinado em imagens naturais, ele atribuir√° um valor de alta probabilidade √† imagem do le√£o e um valor baixo √† imagem de besteira aleat√≥ria. <br><br>  O modelo VAE tamb√©m pode obter exemplos de PDF treinado, que √© a parte mais interessante, pois pode gerar novos exemplos semelhantes ao conjunto de dados original! <br><br>  Explicarei o VAE usando o conjunto de n√∫meros manuscritos <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">MNIST</a> .  Os dados de entrada para o modelo s√£o figuras no formato <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1"><span class="MJXp-mtext" id="MJXp-Span-2">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-8">b</span><span class="MJXp-msubsup" id="MJXp-Span-9"><span class="MJXp-mrow" id="MJXp-Span-10" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-11">R</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-12" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-13">28</span><span class="MJXp-mo" id="MJXp-Span-14">√ó</span><span class="MJXp-mn" id="MJXp-Span-15">28</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14.587ex" height="2.539ex" viewBox="0 -987.6 6280.6 1093.4" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-6D" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-61" x="1128" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-74" x="1658" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-68" x="2019" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-62" x="2596" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-62" x="3025" y="0"></use><g transform="translate(3455,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-52" x="0" y="0"></use><g transform="translate(759,410)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMAIN-32"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMAIN-38" x="500" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMAIN-D7" x="1001" y="0"></use><g transform="translate(1258,0)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMAIN-32"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMAIN-38" x="500" y="0"></use></g></g></g></g></svg></span><script type="math/tex" id="MathJax-Element-1"> \ mathbb {R} ^ {28 √ó 28} </script>  .  O modelo deve avaliar a probabilidade de quanto a entrada se parece com um d√≠gito. <br><br><h1>  Tarefa de modelagem de imagem </h1><br>  A intera√ß√£o entre pixels √© uma tarefa dif√≠cil.  Se os pixels forem independentes um do outro, voc√™ precisar√° estudar o PDF de cada pixel de forma independente, o que √© f√°cil.  A sele√ß√£o tamb√©m √© simples - pegamos cada pixel separadamente. <br><br>  Mas nas imagens digitais, existem claras depend√™ncias entre os pixels.  Se voc√™ vir o in√≠cio dos quatro na metade esquerda, ficar√° surpreso se a metade direita for a conclus√£o de zero.  Mas porque? <br><br><h1>  Espa√ßo oculto </h1><br>  Voc√™ sabe que cada imagem tem um n√∫mero.  Entrada para <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-16"><span class="MJXp-mtext" id="MJXp-Span-17">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-18">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-19">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-20">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-21">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-22">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-23">b</span><span class="MJXp-msubsup" id="MJXp-Span-24"><span class="MJXp-mrow" id="MJXp-Span-25" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-26">R</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-27" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-28">28</span><span class="MJXp-mo" id="MJXp-Span-29">√ó</span><span class="MJXp-mn" id="MJXp-Span-30">28</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14.587ex" height="2.539ex" viewBox="0 -987.6 6280.6 1093.4" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-6D" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-61" x="1128" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-74" x="1658" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-68" x="2019" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-62" x="2596" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-62" x="3025" y="0"></use><g transform="translate(3455,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-52" x="0" y="0"></use><g transform="translate(759,410)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMAIN-32"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMAIN-38" x="500" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMAIN-D7" x="1001" y="0"></use><g transform="translate(1258,0)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMAIN-32"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMAIN-38" x="500" y="0"></use></g></g></g></g></svg></span><script type="math/tex" id="MathJax-Element-2"> \ mathbb {R} ^ {28 √ó 28} </script>  claramente n√£o cont√©m essas informa√ß√µes.  Mas deve estar em algum lugar ... Esse "lugar" √© um espa√ßo oculto. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/85b/f1f/a9f/85bf1fa9f3d48d24d98dfe5b61de55c1.jpg"><br><br>  Voc√™ pode pensar no espa√ßo oculto como <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-31"><span class="MJXp-mtext" id="MJXp-Span-32">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-33">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-34">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-35">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-36">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-37">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-38">b</span><span class="MJXp-msubsup" id="MJXp-Span-39"><span class="MJXp-mrow" id="MJXp-Span-40" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-41">R</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-42" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-43">k</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.877ex" height="2.539ex" viewBox="0 -987.6 4683.3 1093.4" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-6D" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-61" x="1128" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-74" x="1658" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-68" x="2019" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-62" x="2596" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-62" x="3025" y="0"></use><g transform="translate(3455,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-52" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-6B" x="1074" y="581"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-3"> \ mathbb {R} ^ {k} </script>  onde cada vetor cont√©m <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-44"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-45">k</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.211ex" height="2.057ex" viewBox="0 -780.1 521.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-6B" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-4"> k </script>  informa√ß√µes necess√°rias para renderizar uma imagem.  Suponha que a primeira dimens√£o contenha um n√∫mero representado por um d√≠gito.  A segunda dimens√£o pode ser largura.  O terceiro √© o √¢ngulo, e assim por diante. <br><br>  Podemos imaginar o processo de desenhar uma pessoa em duas etapas.  Primeiro, uma pessoa determina - conscientemente ou n√£o - todos os atributos do n√∫mero que ser√° exibido.  Em seguida, essas decis√µes s√£o transformadas em tra√ßos no papel. <br><br>  O VAE est√° tentando simular esse processo: para uma determinada imagem <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-46"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-47">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.455ex" viewBox="0 -520.7 572.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-78" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-5"> x </script>  queremos encontrar pelo menos um vetor oculto que possa descrev√™-lo;  um vetor contendo instru√ß√µes para gerar <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-48"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-49">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.455ex" viewBox="0 -520.7 572.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-78" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-6"> x </script>  .  Formulando-o pela <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">f√≥rmula da probabilidade total</a> , obtemos <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-50"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-51">P</span><span class="MJXp-mo" id="MJXp-Span-52" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-53">x</span><span class="MJXp-mo" id="MJXp-Span-54" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-55" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-56">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-57">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-58">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-59">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-60">P</span><span class="MJXp-mo" id="MJXp-Span-61" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-62">x</span><span class="MJXp-mrow" id="MJXp-Span-63"><span class="MJXp-mo" id="MJXp-Span-64" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-65">z</span><span class="MJXp-mo" id="MJXp-Span-66" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-67">P</span><span class="MJXp-mo" id="MJXp-Span-68" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-69">z</span><span class="MJXp-mo" id="MJXp-Span-70" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-71">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-72">z</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="25.167ex" height="2.66ex" viewBox="0 -832 10835.6 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-50" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMAIN-28" x="751" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-78" x="1141" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMAIN-29" x="1713" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMAIN-3D" x="2380" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-69" x="3687" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-6E" x="4032" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-74" x="4633" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-50" x="4994" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMAIN-28" x="5746" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-78" x="6135" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMAIN-7C" x="6708" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-7A" x="6986" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMAIN-29" x="7455" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-50" x="7844" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMAIN-28" x="8596" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-7A" x="8985" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMAIN-29" x="9454" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-64" x="9843" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-7A" x="10367" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-7"> P (x) = \ int P (x | z) P (z) dz </script>  . <br><br>  Vamos colocar algum sentido razo√°vel nessa equa√ß√£o: <br><br><ul><li>  Integral significa que os candidatos devem ser procurados em todo o espa√ßo oculto. </li><li>  Para cada candidato <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-73"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-74">z</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.088ex" height="1.455ex" viewBox="0 -520.7 468.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-7A" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-8"> z </script>  fazemos a pergunta: √© poss√≠vel gerar <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-75"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-76">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.455ex" viewBox="0 -520.7 572.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-78" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-9"> x </script>  usando instru√ß√µes <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-77"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-78">z</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.088ex" height="1.455ex" viewBox="0 -520.7 468.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-7A" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-10"> z </script>  ?  √â grande o suficiente <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-79"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-80">P</span><span class="MJXp-mo" id="MJXp-Span-81" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-82">x</span><span class="MJXp-mrow" id="MJXp-Span-83"><span class="MJXp-mo" id="MJXp-Span-84" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-85">z</span><span class="MJXp-mo" id="MJXp-Span-86" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.619ex" height="2.66ex" viewBox="0 -832 2850 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-50" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMAIN-28" x="751" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-78" x="1141" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMAIN-7C" x="1713" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-7A" x="1992" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMAIN-29" x="2460" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-11"> P (x | z) </script>  ?  Por exemplo, se <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-87"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-88">z</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.088ex" height="1.455ex" viewBox="0 -520.7 468.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-7A" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-12"> z </script>  codifica informa√ß√µes sobre o d√≠gito 7, a imagem 8 n√£o √© poss√≠vel.  No entanto, a imagem 1 √© aceit√°vel porque 1 e 7 s√£o semelhantes. </li><li>  Encontramos uma boa. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-89"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-90">z</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-13-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.088ex" height="1.455ex" viewBox="0 -520.7 468.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-7A" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-13"> z </script>  ?  √ìtimo!  Mas espere um segundo ... quanto custa <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-91"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-92">z</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-14-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.088ex" height="1.455ex" viewBox="0 -520.7 468.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-7A" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-14"> z </script>  provavelmente? <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-93"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-94">P</span><span class="MJXp-mo" id="MJXp-Span-95" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-96">z</span><span class="MJXp-mo" id="MJXp-Span-97" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-15-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.643ex" height="2.66ex" viewBox="0 -832 1999 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-50" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMAIN-28" x="751" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-7A" x="1141" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMAIN-29" x="1609" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-15"> P (z) </script>  grande o suficiente?  Considere a imagem do n√∫mero invertido 7. Uma correspond√™ncia ideal seria um vetor oculto que descreve a vista 7, em que o tamanho do √¢ngulo √© definido em 180 ¬∞.  No entanto, tais <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-98"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-99">z</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-16-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.088ex" height="1.455ex" viewBox="0 -520.7 468.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-7A" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-16"> z </script>  √â improv√°vel, porque geralmente os n√∫meros n√£o s√£o escritos em um √¢ngulo de 180 ¬∞. </li></ul><br>  O objetivo do treinamento da VAE √© maximizar <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-100"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-101">P</span><span class="MJXp-mo" id="MJXp-Span-102" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-103">x</span><span class="MJXp-mo" id="MJXp-Span-104" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-17-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.884ex" height="2.66ex" viewBox="0 -832 2103 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-50" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMAIN-28" x="751" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-78" x="1141" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMAIN-29" x="1713" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-17"> P (x) </script>  .  Modelaremos <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-105"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-106">P</span><span class="MJXp-mo" id="MJXp-Span-107" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-108">x</span><span class="MJXp-mrow" id="MJXp-Span-109"><span class="MJXp-mo" id="MJXp-Span-110" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-111">z</span><span class="MJXp-mo" id="MJXp-Span-112" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-18-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.619ex" height="2.66ex" viewBox="0 -832 2850 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-50" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMAIN-28" x="751" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-78" x="1141" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMAIN-7C" x="1713" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-7A" x="1992" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMAIN-29" x="2460" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-18"> P (x | z) </script>  usando distribui√ß√£o gaussiana multidimensional <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-113"><span class="MJXp-mtext" id="MJXp-Span-114">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-115">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-116">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-117">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-118">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-119">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-120">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-121">l</span><span class="MJXp-mrow" id="MJXp-Span-122"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-123">N</span></span><span class="MJXp-mo" id="MJXp-Span-124" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-125">f</span><span class="MJXp-mo" id="MJXp-Span-126" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-127">z</span><span class="MJXp-mo" id="MJXp-Span-128" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-129" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-130">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-131">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-132">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-133">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-134">m</span><span class="MJXp-msubsup" id="MJXp-Span-135"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-136" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-137" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mtext" id="MJXp-Span-138">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-139">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-140">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-141">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-142">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-143">I</span><span class="MJXp-mo" id="MJXp-Span-144" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-19-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="31.899ex" height="2.901ex" viewBox="0 -935.7 13734.1 1249" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-6D" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-61" x="1128" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-74" x="1658" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-68" x="2019" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-63" x="2596" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-61" x="3029" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-6C" x="3559" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-4E" x="3857" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMAIN-28" x="4746" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-66" x="5135" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMAIN-28" x="5686" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-7A" x="6075" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMAIN-29" x="6544" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMAIN-2C" x="6933" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-73" x="7628" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-69" x="8098" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-67" x="8443" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-6D" x="8924" y="0"></use><g transform="translate(9802,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMAIN-32" x="748" y="513"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-63" x="11036" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-64" x="11469" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-6F" x="11993" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-74" x="12478" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-49" x="12840" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMAIN-29" x="13344" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-19"> \ mathcal {N} (f (z), \ sigma ^ 2 \ cdot I) </script>  . <br><br><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-145"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-146">f</span><span class="MJXp-mo" id="MJXp-Span-147" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-148">z</span><span class="MJXp-mo" id="MJXp-Span-149" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-20-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.176ex" height="2.66ex" viewBox="0 -832 1798 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-66" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMAIN-28" x="550" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-7A" x="940" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMAIN-29" x="1408" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-20"> f (z) </script>  modelado usando uma rede neural. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-150"><span class="MJXp-mtext" id="MJXp-Span-151">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-152">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-153">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-154">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-155">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-156">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-21-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.86ex" height="2.298ex" viewBox="0 -728.2 2953.5 989.6" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-73" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-69" x="719" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-67" x="1065" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-6D" x="1545" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-61" x="2424" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-21"> \ sigma </script>  √â um hiperpar√¢metro para multiplicar a matriz de identidade <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-157"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-158">I</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-22-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.172ex" height="2.057ex" viewBox="0 -780.1 504.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-49" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-22"> I </script>  . <br><br>  Tenha em mente que <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-159"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-160">f</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-23-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.279ex" height="2.419ex" viewBox="0 -780.1 550.5 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-66" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-23"> f </script>  - √© isso que usaremos para gerar novas imagens usando um modelo treinado.  A sobreposi√ß√£o de uma distribui√ß√£o gaussiana √© apenas para fins educacionais.  Se usarmos a fun√ß√£o delta Dirac (ou seja, determin√≠stica <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-161"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-162">x</span><span class="MJXp-mo" id="MJXp-Span-163" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-164">f</span><span class="MJXp-mo" id="MJXp-Span-165" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-166">z</span><span class="MJXp-mo" id="MJXp-Span-167" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-24-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.604ex" height="2.66ex" viewBox="0 -832 3704.6 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-78" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMAIN-3D" x="850" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-66" x="1906" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMAIN-28" x="2457" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMATHI-7A" x="2846" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/429276/&amp;usg=ALkJrhiz4jsG-HK8UgDBqgjMQQQP6kgPjA#MJMAIN-29" x="3315" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-24"> x = f (z) </script>  ), n√£o poderemos treinar o modelo usando descida gradiente! <br><br><h1>  As maravilhas do espa√ßo oculto </h1><br>  A abordagem do espa√ßo oculto tem dois grandes problemas: <br><br><ol><li>  Quais informa√ß√µes cada dimens√£o cont√©m?  Algumas dimens√µes podem estar relacionadas a elementos abstratos, como estilo.  Mesmo se fosse f√°cil interpretar todas as dimens√µes, n√£o queremos atribuir r√≥tulos ao conjunto de dados.  Essa abordagem n√£o se ajusta a outros conjuntos de dados. </li><li>  O espa√ßo oculto pode ser confundido quando h√° uma correla√ß√£o entre as dimens√µes.  Por exemplo, um n√∫mero muito rapidamente desenhado pode levar ao aparecimento de tra√ßos angulares e mais finos.  Definir essas depend√™ncias √© dif√≠cil. </li></ol><br><h1>  O aprendizado profundo vem em socorro </h1><br>  Acontece que cada distribui√ß√£o pode ser gerada aplicando uma fun√ß√£o bastante complexa √† distribui√ß√£o gaussiana multidimensional padr√£o. <br><br>  Escolha <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-168"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-169">P</span><span class="MJXp-mo" id="MJXp-Span-170" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-171">z</span><span class="MJXp-mo" id="MJXp-Span-172" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-25-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-25"> P (z) </script>  como uma distribui√ß√£o gaussiana multidimensional padr√£o.  Assim modelado por uma rede neural <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-173"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-174">f</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-26-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-26"> f </script>  pode ser dividido em duas fases: <br><br><ol><li>  As primeiras camadas mapeiam a distribui√ß√£o gaussiana na verdadeira distribui√ß√£o no espa√ßo oculto.  N√£o podemos interpretar as medidas, mas isso n√£o importa. </li><li>  Camadas subsequentes ser√£o exibidas do espa√ßo oculto no <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-175"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-176">P</span><span class="MJXp-mo" id="MJXp-Span-177" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-178">x</span><span class="MJXp-mrow" id="MJXp-Span-179"><span class="MJXp-mo" id="MJXp-Span-180" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-181">z</span><span class="MJXp-mo" id="MJXp-Span-182" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-27-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-27"> P (x | z) </script>  . </li></ol><br><h1>  Ent√£o, como treinamos essa fera? </h1><br>  F√≥rmula para <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-183"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-184">P</span><span class="MJXp-mo" id="MJXp-Span-185" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-186">x</span><span class="MJXp-mo" id="MJXp-Span-187" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-28-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-28"> P (x) </script>  insol√∫vel, portanto, o aproximamos pelo m√©todo de Monte Carlo: <br><br><ol><li>  Selec√ß√£o <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-188"><span class="noError" id="MJXp-Span-189" style="display: inline-block;">\&nbsp;{z_i&nbsp;\}&nbsp;_&nbsp;{i&nbsp;=&nbsp;1}&nbsp;^&nbsp;n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-29-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-29"> \ {z_i \} _ {i = 1} ^ n </script>  do anterior <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-190"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-191">P</span><span class="MJXp-mo" id="MJXp-Span-192" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-193">z</span><span class="MJXp-mo" id="MJXp-Span-194" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-30-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-30"> P (z) </script></li><li>  Aproxima√ß√£o com <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-195"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-196">P</span><span class="MJXp-mo" id="MJXp-Span-197" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-198">x</span><span class="MJXp-mo" id="MJXp-Span-199" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-200">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-201">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-202">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-203">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-204">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-205">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-206">x</span><span class="MJXp-mtext" id="MJXp-Span-207">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-208">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-209">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-210">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-211">c</span><span class="MJXp-mrow" id="MJXp-Span-212"><span class="MJXp-mn" id="MJXp-Span-213">1</span></span><span class="MJXp-mrow" id="MJXp-Span-214"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-215">n</span></span><span class="MJXp-mtext" id="MJXp-Span-216">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-217">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-218">u</span><span class="MJXp-msubsup" id="MJXp-Span-219"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-220" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-225">n</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-221"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-222">i</span><span class="MJXp-mo" id="MJXp-Span-223">=</span><span class="MJXp-mn" id="MJXp-Span-224">1</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-226">P</span><span class="MJXp-mo" id="MJXp-Span-227" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-228">x</span><span class="MJXp-mrow" id="MJXp-Span-229"><span class="MJXp-mo" id="MJXp-Span-230" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-231"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-232" style="margin-right: 0.05em;">z</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-233" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-234" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-31-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-31"> P (x) \ approx \ frac {1} {n} \ sum_ {i = 1} ^ n P (x | z_i) </script></li></ol><br>  √ìtimo!  Ent√£o, tente v√°rias coisas diferentes <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-235"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-236">z</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-32-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-32"> z </script>  e inicie a festa de propaga√ß√£o de bugs! <br><br>  Infelizmente desde <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-237"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-238">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-33-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-33"> x </script>  muito multidimensional, para obter uma aproxima√ß√£o razo√°vel, s√£o necess√°rias muitas amostras.  Quero dizer, se voc√™ tentar <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-239"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-240">z</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-34-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-34"> z </script>  , quais s√£o as chances de obter uma imagem parecida com <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-241"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-242">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-35-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-35"> x </script>  ?  A prop√≥sito, isso explica por que <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-243"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-244">P</span><span class="MJXp-mo" id="MJXp-Span-245" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-246">x</span><span class="MJXp-mrow" id="MJXp-Span-247"><span class="MJXp-mo" id="MJXp-Span-248" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-249">z</span><span class="MJXp-mo" id="MJXp-Span-250" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-36-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-36"> P (x | z) </script>  deve atribuir um valor de probabilidade positivo a qualquer imagem poss√≠vel; caso contr√°rio, o modelo n√£o poder√° aprender: amostragem <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-251"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-252">z</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-37-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-37"> z </script>  resultar√° em uma imagem quase certamente diferente de <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-253"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-254">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-38-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-38"> x </script>  e se a probabilidade for 0, os gradientes n√£o poder√£o se propagar. <br><br>  Como resolver este problema? <br><br><h1>  Corte o caminho! </h1><br><img src="https://habrastorage.org/getpro/habr/post_images/6cd/5ec/950/6cd5ec950b20f02602c83e7ed4c90ae4.jpg"><br><br>  Maioria das amostras <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-255"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-256">z</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-39-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-39"> z </script>  nada ser√° adicionado da sele√ß√£o para <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-257"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-258">P</span><span class="MJXp-mo" id="MJXp-Span-259" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-260">x</span><span class="MJXp-mo" id="MJXp-Span-261" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-40-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-40"> P (x) </script>  - Eles est√£o muito al√©m de suas fronteiras.  Agora, se voc√™ soubesse com anteced√™ncia de onde lev√°-los ... <br><br>  Pode entrar <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-262"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-263">Q</span><span class="MJXp-mo" id="MJXp-Span-264" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-265">z</span><span class="MJXp-mrow" id="MJXp-Span-266"><span class="MJXp-mo" id="MJXp-Span-267" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-268">x</span><span class="MJXp-mo" id="MJXp-Span-269" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-41-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-41"> Q (z | x) </script>  .  Dado <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-270"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-271">Q</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-42-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-42"> Q </script>  ser√° treinado para atribuir altos valores de probabilidade a <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-272"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-273">z</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-43-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-43"> z </script>  que provavelmente geram <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-274"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-275">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-44-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-44"> x </script>  .  Agora voc√™ pode fazer uma avalia√ß√£o usando o m√©todo Monte Carlo, colhendo muito menos amostras de <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-276"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-277">Q</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-45-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-45"> Q </script>  . <br><br>  Infelizmente, um novo problema surge!  Em vez de maximizar <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-278"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-279">P</span><span class="MJXp-mo" id="MJXp-Span-280" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-281">x</span><span class="MJXp-mo" id="MJXp-Span-282" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-283" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-284">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-285">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-286">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-287">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-288">P</span><span class="MJXp-mo" id="MJXp-Span-289" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-290">x</span><span class="MJXp-mrow" id="MJXp-Span-291"><span class="MJXp-mo" id="MJXp-Span-292" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-293">z</span><span class="MJXp-mo" id="MJXp-Span-294" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-295">P</span><span class="MJXp-mo" id="MJXp-Span-296" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-297">z</span><span class="MJXp-mo" id="MJXp-Span-298" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-299">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-300">z</span><span class="MJXp-mo" id="MJXp-Span-301" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-302">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-303">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-304">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-305">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-306">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-307">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-308">b</span><span class="MJXp-msubsup" id="MJXp-Span-309"><span class="MJXp-mrow" id="MJXp-Span-310" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-311">E</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-312" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-313">z</span><span class="MJXp-mtext" id="MJXp-Span-314">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-315">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-316">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-317">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-318">P</span><span class="MJXp-mo" id="MJXp-Span-319">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-320">z</span><span class="MJXp-mo" id="MJXp-Span-321">)</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-322">P</span><span class="MJXp-mo" id="MJXp-Span-323" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-324">x</span><span class="MJXp-mrow" id="MJXp-Span-325"><span class="MJXp-mo" id="MJXp-Span-326" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-327">z</span><span class="MJXp-mo" id="MJXp-Span-328" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-46-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-46"> P (x) = \ int P (x | z) P (z) dz = \ mathbb {E} _ {z \ sim P (z)} P (x | z) </script>  n√≥s maximizamos <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-329"><span class="MJXp-mtext" id="MJXp-Span-330">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-331">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-332">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-333">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-334">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-335">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-336">b</span><span class="MJXp-msubsup" id="MJXp-Span-337"><span class="MJXp-mrow" id="MJXp-Span-338" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-339">E</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-340" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-341">z</span><span class="MJXp-mtext" id="MJXp-Span-342">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-343">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-344">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-345">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-346">Q</span><span class="MJXp-mo" id="MJXp-Span-347">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-348">z</span><span class="MJXp-mrow" id="MJXp-Span-349"><span class="MJXp-mo" id="MJXp-Span-350">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-351">x</span><span class="MJXp-mo" id="MJXp-Span-352">)</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-353">P</span><span class="MJXp-mo" id="MJXp-Span-354" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-355">x</span><span class="MJXp-mrow" id="MJXp-Span-356"><span class="MJXp-mo" id="MJXp-Span-357" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-358">z</span><span class="MJXp-mo" id="MJXp-Span-359" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-47-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-47"> \ mathbb {E} _ {z \ sim Q (z | x)} P (x | z) </script>  .  Como eles se relacionam? <br><br><h1>  Conclus√£o variacional </h1><br>  A conclus√£o variacional √© o t√≥pico de um artigo separado, por isso n√£o vou me debru√ßar sobre isso aqui em detalhes.  S√≥ posso dizer que essas distribui√ß√µes est√£o relacionadas por esta equa√ß√£o: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-360"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-361">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-362">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-363">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-364">P</span><span class="MJXp-mo" id="MJXp-Span-365" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-366">X</span><span class="MJXp-mo" id="MJXp-Span-367" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-368" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-369">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-370">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-371">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-372">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-373">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-374">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-375">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-376">l</span><span class="MJXp-mrow" id="MJXp-Span-377"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-378">K</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-379">L</span></span><span class="MJXp-mo" id="MJXp-Span-380" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-381">Q</span><span class="MJXp-mo" id="MJXp-Span-382" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-383">z</span><span class="MJXp-mrow" id="MJXp-Span-384"><span class="MJXp-mo" id="MJXp-Span-385" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-386">x</span><span class="MJXp-mo" id="MJXp-Span-387" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mrow" id="MJXp-Span-388"><span class="MJXp-mo" id="MJXp-Span-389" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-390"><span class="MJXp-mo" id="MJXp-Span-391" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-392">P</span><span class="MJXp-mo" id="MJXp-Span-393" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-394">z</span><span class="MJXp-mrow" id="MJXp-Span-395"><span class="MJXp-mo" id="MJXp-Span-396" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-397">x</span><span class="MJXp-mo" id="MJXp-Span-398" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-399" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-400" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-401">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-402">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-403">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-404">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-405">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-406">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-407">b</span><span class="MJXp-msubsup" id="MJXp-Span-408"><span class="MJXp-mrow" id="MJXp-Span-409" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-410">E</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-411" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-412">z</span><span class="MJXp-mtext" id="MJXp-Span-413">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-414">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-415">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-416">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-417">Q</span><span class="MJXp-mo" id="MJXp-Span-418">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-419">z</span><span class="MJXp-mrow" id="MJXp-Span-420"><span class="MJXp-mo" id="MJXp-Span-421">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-422">x</span><span class="MJXp-mo" id="MJXp-Span-423">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-424" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-425">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-426">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-427">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-428">P</span><span class="MJXp-mo" id="MJXp-Span-429" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-430">x</span><span class="MJXp-mrow" id="MJXp-Span-431"><span class="MJXp-mo" id="MJXp-Span-432" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-433">z</span><span class="MJXp-mo" id="MJXp-Span-434" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-435" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-436" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-437">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-438">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-439">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-440">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-441">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-442">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-443">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-444">l</span><span class="MJXp-mrow" id="MJXp-Span-445"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-446">K</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-447">L</span></span><span class="MJXp-mo" id="MJXp-Span-448" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-449">Q</span><span class="MJXp-mo" id="MJXp-Span-450" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-451">z</span><span class="MJXp-mrow" id="MJXp-Span-452"><span class="MJXp-mo" id="MJXp-Span-453" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-454">x</span><span class="MJXp-mo" id="MJXp-Span-455" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mrow" id="MJXp-Span-456"><span class="MJXp-mo" id="MJXp-Span-457" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-458"><span class="MJXp-mo" id="MJXp-Span-459" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-460">P</span><span class="MJXp-mo" id="MJXp-Span-461" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-462">z</span><span class="MJXp-mo" id="MJXp-Span-463" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-464" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-48-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-48"> log P (X) - \ mathcal {KL} [Q (z | x) || P (z | x)] = \ mathbb {E} _ {z \ sim Q (z | x)} [log P (x | z)] - \ mathcal {KL} [Q (z | x) || P (z)] </script></p><br><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-465"><span class="MJXp-mtext" id="MJXp-Span-466">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-467">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-468">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-469">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-470">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-471">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-472">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-473">l</span><span class="MJXp-mrow" id="MJXp-Span-474"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-475">K</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-476">L</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-49-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-49"> \ mathcal {KL} </script>  √© a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">dist√¢ncia Kullback - Leibler</a> , que avalia intuitivamente a semelhan√ßa das duas distribui√ß√µes. <br><br>  Em um momento, voc√™ ver√° como maximizar o lado direito da equa√ß√£o.  Nesse caso, o lado esquerdo tamb√©m √© maximizado: <br><br><ul><li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-477"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-478">P</span><span class="MJXp-mo" id="MJXp-Span-479" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-480">x</span><span class="MJXp-mo" id="MJXp-Span-481" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-50-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-50"> P (x) </script>  maximizado. </li><li>  a que dist√¢ncia <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-482"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-483">Q</span><span class="MJXp-mo" id="MJXp-Span-484" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-485">z</span><span class="MJXp-mrow" id="MJXp-Span-486"><span class="MJXp-mo" id="MJXp-Span-487" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-488">x</span><span class="MJXp-mo" id="MJXp-Span-489" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-51-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-51"> Q (z | x) </script>  de <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-490"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-491">P</span><span class="MJXp-mo" id="MJXp-Span-492" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-493">z</span><span class="MJXp-mrow" id="MJXp-Span-494"><span class="MJXp-mo" id="MJXp-Span-495" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-496">x</span><span class="MJXp-mo" id="MJXp-Span-497" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-52-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-52"> P (z | x) </script>  - <i>real a</i> priori desconhecido - ser√° minimizado. </li></ul><br>  O significado do lado direito da equa√ß√£o √© que temos tens√£o aqui: <br><br><ol><li>  Por um lado, queremos maximizar o qu√£o bem <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-498"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-499">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-53-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-53"> x </script>  deve ser decodificado de <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-500"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-501">z</span><span class="MJXp-mtext" id="MJXp-Span-502">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-503">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-504">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-505">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-506">Q</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-54-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-54"> z \ sim Q </script>  . </li><li>  Por outro lado, queremos <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-507"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-508">Q</span><span class="MJXp-mo" id="MJXp-Span-509" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-510">z</span><span class="MJXp-mrow" id="MJXp-Span-511"><span class="MJXp-mo" id="MJXp-Span-512" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-513">x</span><span class="MJXp-mo" id="MJXp-Span-514" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-55-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-55"> Q (z | x) </script>  ( <i>codificador</i> ) foi semelhante ao anterior <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-515"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-516">P</span><span class="MJXp-mo" id="MJXp-Span-517" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-518">z</span><span class="MJXp-mo" id="MJXp-Span-519" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-56-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-56"> P (z) </script>  (distribui√ß√£o gaussiana multidimensional).  Isso pode ser visto como regulariza√ß√£o. </li></ol><br>  Minimiza√ß√£o de diverg√™ncia <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-520"><span class="MJXp-mtext" id="MJXp-Span-521">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-522">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-523">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-524">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-525">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-526">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-527">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-528">l</span><span class="MJXp-mrow" id="MJXp-Span-529"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-530">K</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-531">L</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-57-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-57"> \ mathcal {KL} </script>  executado facilmente com a sele√ß√£o certa de distribui√ß√µes.  Vamos simular <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-532"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-533">Q</span><span class="MJXp-mo" id="MJXp-Span-534" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-535">z</span><span class="MJXp-mrow" id="MJXp-Span-536"><span class="MJXp-mo" id="MJXp-Span-537" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-538">x</span><span class="MJXp-mo" id="MJXp-Span-539" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-58-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-58"> Q (z | x) </script>  como uma rede neural, cuja sa√≠da s√£o os par√¢metros de uma distribui√ß√£o gaussiana multidimensional: <br><br><ul><li>  m√©dia <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-540"><span class="MJXp-mtext" id="MJXp-Span-541">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-542">m</span><span class="MJXp-msubsup" id="MJXp-Span-543"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-544" style="margin-right: 0.05em;">u</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-545" style="vertical-align: -0.4em;">Q</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-59-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-59"> \ mu_Q </script></li><li>  matriz de covari√¢ncia diagonal <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-546"><span class="MJXp-mtext" id="MJXp-Span-547">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-548">S</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-549">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-550">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-551">m</span><span class="MJXp-msubsup" id="MJXp-Span-552"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-553" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-554" style="vertical-align: -0.4em;">Q</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-60-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-60"> \ Sigma_Q </script></li></ul><br>  Ent√£o diverg√™ncia <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-555"><span class="MJXp-mtext" id="MJXp-Span-556">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-557">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-558">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-559">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-560">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-561">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-562">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-563">l</span><span class="MJXp-mrow" id="MJXp-Span-564"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-565">K</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-566">L</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-61-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-61"> \ mathcal {KL} </script>  torna-se analiticamente solucion√°vel, o que √© √≥timo para n√≥s (e para gradientes). <br><br>  A parte do <i>decodificador</i> √© um pouco mais complicada.  √Ä primeira vista, gostaria de afirmar que esse problema √© insol√∫vel pelo m√©todo de Monte Carlo.  Mas a amostra <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-567"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-568">z</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-62-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-62"> z </script>  de <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-569"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-570">Q</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-63-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-63"> Q </script>  n√£o permitir√° que os gradientes se propaguem atrav√©s <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-571"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-572">Q</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-64-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-64"> Q </script>  , porque a sele√ß√£o n√£o √© uma opera√ß√£o diferenci√°vel.  Isso √© um problema, desde ent√£o os pesos das camadas que emitem <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-573"><span class="MJXp-mtext" id="MJXp-Span-574">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-575">S</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-576">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-577">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-578">m</span><span class="MJXp-msubsup" id="MJXp-Span-579"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-580" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-581" style="vertical-align: -0.4em;">Q</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-65-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-65"> \ Sigma_Q </script>  e <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-582"><span class="MJXp-mtext" id="MJXp-Span-583">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-584">m</span><span class="MJXp-msubsup" id="MJXp-Span-585"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-586" style="margin-right: 0.05em;">u</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-587" style="vertical-align: -0.4em;">Q</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-66-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-66"> \ mu_Q </script>  . <br><br><h1>  Novo truque de parametriza√ß√£o </h1><br>  N√≥s podemos substituir <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-588"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-589">Q</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-67-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-67"> Q </script>  transforma√ß√£o parametrizada determin√≠stica de uma vari√°vel aleat√≥ria n√£o param√©trica: <br><br><ol><li>  Uma amostra da distribui√ß√£o gaussiana padr√£o (sem par√¢metros). </li><li>  Multiplicando a amostra pela raiz quadrada <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-590"><span class="MJXp-mtext" id="MJXp-Span-591">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-592">S</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-593">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-594">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-595">m</span><span class="MJXp-msubsup" id="MJXp-Span-596"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-597" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-598" style="vertical-align: -0.4em;">Q</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-68-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-68"> \ Sigma_Q </script>  . </li><li>  Adicionando ao resultado <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-599"><span class="MJXp-mtext" id="MJXp-Span-600">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-601">m</span><span class="MJXp-msubsup" id="MJXp-Span-602"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-603" style="margin-right: 0.05em;">u</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-604" style="vertical-align: -0.4em;">Q</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-69-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-69"> \ mu_Q </script>  . </li></ol><br>  Como resultado, obtemos uma distribui√ß√£o igual a <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-605"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-606">Q</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-70-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-70"> Q </script>  .  Agora, a opera√ß√£o de busca vem da distribui√ß√£o Gaussiana padr√£o.  Consequentemente, os gradientes podem se propagar atrav√©s de <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-607"><span class="MJXp-mtext" id="MJXp-Span-608">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-609">S</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-610">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-611">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-612">m</span><span class="MJXp-msubsup" id="MJXp-Span-613"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-614" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-615" style="vertical-align: -0.4em;">Q</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-71-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-71"> \ Sigma_Q </script>  e <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-616"><span class="MJXp-mtext" id="MJXp-Span-617">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-618">m</span><span class="MJXp-msubsup" id="MJXp-Span-619"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-620" style="margin-right: 0.05em;">u</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-621" style="vertical-align: -0.4em;">Q</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-72-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-72"> \ mu_Q </script>  j√° que agora esses s√£o caminhos determin√≠sticos. <br><br>  Resultado?  O modelo poder√° aprender como ajustar os par√¢metros <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-622"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-623">Q</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-73-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-73"> Q </script>  : ela vai se concentrar em torno do bem <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-624"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-625">z</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-74-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-74"> z </script>  que s√£o capazes de produzir <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-626"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-627">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-75-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-75"> x </script>  . <br><br><h1>  Juntando tudo </h1><br>  O modelo VAE pode ser dif√≠cil de entender.  Examinamos aqui muito material que √© dif√≠cil de digerir. <br><br>  Deixe-me resumir todas as etapas para a implementa√ß√£o do VAE. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f9a/d5e/84a/f9ad5e84a0ad478de43edffaeb85997d.png"><br><br>  √Ä esquerda, temos uma defini√ß√£o de modelo: <br><br><ol><li>  A imagem de entrada √© transmitida atrav√©s da rede do codificador. </li><li>  O codificador fornece par√¢metros de distribui√ß√£o <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-628"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-629">Q</span><span class="MJXp-mo" id="MJXp-Span-630" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-631">z</span><span class="MJXp-mrow" id="MJXp-Span-632"><span class="MJXp-mo" id="MJXp-Span-633" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-634">x</span><span class="MJXp-mo" id="MJXp-Span-635" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-76-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-76"> Q (z | x) </script>  . </li><li>  Vetor oculto <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-636"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-637">z</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-77-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-77"> z </script>  tirado de <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-638"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-639">Q</span><span class="MJXp-mo" id="MJXp-Span-640" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-641">z</span><span class="MJXp-mrow" id="MJXp-Span-642"><span class="MJXp-mo" id="MJXp-Span-643" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-644">x</span><span class="MJXp-mo" id="MJXp-Span-645" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-78-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-78"> Q (z | x) </script>  .  Se o codificador estiver bem treinado, na maioria dos casos <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-646"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-647">z</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-79-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-79"> z </script>  cont√©m uma descri√ß√£o <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-648"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-649">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-80-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-80"> x </script>  . </li><li>  Decodificador decodifica <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-650"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-651">z</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-81-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-81"> z </script>  na imagem. </li></ol><br>  No lado direito, temos uma fun√ß√£o de perda: <br><br><ol><li>  Erro de recupera√ß√£o: a sa√≠da deve ser semelhante √† entrada. </li><li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-652"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-653">Q</span><span class="MJXp-mo" id="MJXp-Span-654" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-655">z</span><span class="MJXp-mrow" id="MJXp-Span-656"><span class="MJXp-mo" id="MJXp-Span-657" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-658">x</span><span class="MJXp-mo" id="MJXp-Span-659" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-82-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-82"> Q (z | x) </script>  deve ser semelhante ao anterior, ou seja, uma distribui√ß√£o normal padr√£o multidimensional. </li></ol><br>  Para criar novas imagens, voc√™ pode selecionar diretamente o vetor oculto da distribui√ß√£o anterior e decodific√°-lo em uma imagem. <br><br><h1>  C√≥digo de trabalho </h1><br>  Agora vamos estudar o VAE em mais detalhes e considerar o c√≥digo de trabalho.  Voc√™ entender√° todos os detalhes t√©cnicos necess√°rios para implementar o VAE.  Como b√¥nus, mostrarei um truque interessante: como atribuir fun√ß√µes especiais a algumas dimens√µes do vetor oculto para que o modelo comece a gerar imagens dos n√∫meros indicados. <br><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> tensorflow <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> tf <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> tensorflow.examples.tutorials.mnist <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> input_data <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> matplotlib.pyplot <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> plt np.random.seed(<span class="hljs-number"><span class="hljs-number">42</span></span>) tf.set_random_seed(<span class="hljs-number"><span class="hljs-number">42</span></span>) %matplotlib inline</code> </pre> <br>  Lembro que os modelos s√£o treinados no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">MNIST</a> - um conjunto de n√∫meros manuscritos.  As imagens de entrada v√™m no formato <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-660"><span class="MJXp-mtext" id="MJXp-Span-661">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-662">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-663">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-664">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-665">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-666">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-667">b</span><span class="MJXp-msubsup" id="MJXp-Span-668"><span class="MJXp-mrow" id="MJXp-Span-669" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-670">R</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-671" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-672">28</span><span class="MJXp-mo" id="MJXp-Span-673">√ó</span><span class="MJXp-mn" id="MJXp-Span-674">28</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-83-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-83"> \ mathbb {R} ^ {28 √ó 28} </script>  . <br><br><pre> <code class="python hljs">mnist = input_data.read_data_sets(<span class="hljs-string"><span class="hljs-string">'MNIST_data'</span></span>) input_size = <span class="hljs-number"><span class="hljs-number">28</span></span> * <span class="hljs-number"><span class="hljs-number">28</span></span> num_digits = <span class="hljs-number"><span class="hljs-number">10</span></span></code> </pre> <br>  Em seguida, definimos hiperpar√¢metros. <br><br>  Sinta-se livre para jogar com valores diferentes para ter uma id√©ia de como eles afetam o modelo. <br><br><pre> <code class="python hljs">params = { <span class="hljs-string"><span class="hljs-string">'encoder_layers'</span></span>: [<span class="hljs-number"><span class="hljs-number">128</span></span>], <span class="hljs-comment"><span class="hljs-comment">#       'decoder_layers': [128], #    (CNN ,     ) 'digit_classification_layers': [128], #   ,   'activation': tf.nn.sigmoid, #      'decoder_std': 0.5, #   P(x|z)   'z_dim': 10, #    'digit_classification_weight': 10.0, #   ,   'epochs': 20, 'batch_size': 100, 'learning_rate': 0.001 }</span></span></code> </pre> <br><h1>  Modelo </h1><br><img src="https://habrastorage.org/getpro/habr/post_images/b4c/517/a64/b4c517a642595b511407c91c2f2b50e8.jpg"><br><br>  O modelo consiste em tr√™s sub-redes: <br><br><ol><li>  Obt√©m <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-675"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-676">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-84-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-84"> x </script>  (imagem), codifica-o em uma distribui√ß√£o <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-677"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-678">Q</span><span class="MJXp-mo" id="MJXp-Span-679" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-680">z</span><span class="MJXp-mrow" id="MJXp-Span-681"><span class="MJXp-mo" id="MJXp-Span-682" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-683">x</span><span class="MJXp-mo" id="MJXp-Span-684" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-85-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-85"> Q (z | x) </script>  no espa√ßo escondido. </li><li>  Obt√©m <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-685"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-686">z</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-86-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-86"> z </script>  no espa√ßo oculto (representa√ß√£o de c√≥digo da imagem), decodifica-a na imagem correspondente <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-687"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-688">f</span><span class="MJXp-mo" id="MJXp-Span-689" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-690">z</span><span class="MJXp-mo" id="MJXp-Span-691" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-87-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-87"> f (z) </script>  . </li><li>  Obt√©m <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-692"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-693">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-88-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-88"> x </script>  e determina o n√∫mero por compara√ß√£o com a camada 10-dimensional, onde o i-√©simo valor cont√©m a probabilidade do i-√©simo n√∫mero. </li></ol><br>  As duas primeiras sub-redes s√£o a base do VAE puro. <br><br>  A terceira √© uma <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">tarefa auxiliar</a> que usa algumas das dimens√µes ocultas para codificar os n√∫meros encontrados na imagem.  Vou explicar o porqu√™: discutimos anteriormente que n√£o nos importamos com as informa√ß√µes que cada dimens√£o do espa√ßo oculto cont√©m.  Um modelo pode aprender a codificar qualquer informa√ß√£o que considere valiosa para sua tarefa.  Como estamos familiarizados com o conjunto de dados, sabemos a import√¢ncia da dimens√£o, que cont√©m o tipo de d√≠gito (ou seja, seu valor num√©rico).  E agora queremos ajudar o modelo, fornecendo a ela essas informa√ß√µes. <br><br>  Para um determinado tipo de d√≠gito, n√≥s o codificamos diretamente, ou seja, usamos um vetor de tamanho 10. Esses dez n√∫meros est√£o associados a um vetor oculto; portanto, ao decodificar esse vetor em uma imagem, o modelo utilizar√° informa√ß√µes digitais. <br><br>  Existem duas maneiras de fornecer modelos vetoriais de codifica√ß√£o direta: <br><br><ol><li>  Inclua-o como entrada no modelo. </li><li>  Adicione-o como um r√≥tulo, para que o pr√≥prio modelo calcule a previs√£o: adicionaremos outra sub-rede que prev√™ um vetor 10-dimensional, onde a fun√ß√£o de perda √© a entropia cruzada com o vetor de codifica√ß√£o direta esperado. </li></ol><br>  Escolha a segunda op√ß√£o.  Porque  Bem, ao testar, voc√™ pode usar o modelo de duas maneiras: <br><br><ol><li>  Especifique a imagem como entrada e exiba um vetor oculto. </li><li>  Especifique um vetor oculto como entrada e gere uma imagem. </li></ol><br>  Como queremos oferecer suporte √† primeira op√ß√£o, n√£o podemos fornecer um d√≠gito ao modelo como entrada, porque n√£o queremos conhec√™-lo durante o teste.  Portanto, o modelo deve aprender a prever. <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">encoder</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x, layers)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> layer <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> layers: x = tf.layers.dense(x, layer, activation=params[<span class="hljs-string"><span class="hljs-string">'activation'</span></span>]) mu = tf.layers.dense(x, params[<span class="hljs-string"><span class="hljs-string">'z_dim'</span></span>]) var = <span class="hljs-number"><span class="hljs-number">1e-5</span></span> + tf.exp(tf.layers.dense(x, params[<span class="hljs-string"><span class="hljs-string">'z_dim'</span></span>])) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> mu, var <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">decoder</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(z, layers)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> layer <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> layers: z = tf.layers.dense(z, layer, activation=params[<span class="hljs-string"><span class="hljs-string">'activation'</span></span>]) mu = tf.layers.dense(z, input_size) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> tf.nn.sigmoid(mu) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">digit_classifier</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x, layers)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> layer <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> layers: x = tf.layers.dense(x, layer, activation=params[<span class="hljs-string"><span class="hljs-string">'activation'</span></span>]) logits = tf.layers.dense(x, num_digits) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> logits</code> </pre> <br><pre> <code class="python hljs">images = tf.placeholder(tf.float32, [<span class="hljs-keyword"><span class="hljs-keyword">None</span></span>, input_size]) digits = tf.placeholder(tf.int32, [<span class="hljs-keyword"><span class="hljs-keyword">None</span></span>]) <span class="hljs-comment"><span class="hljs-comment">#        encoder_mu, encoder_var = encoder(images, params['encoder_layers']) #     ,  #     eps = tf.random_normal(shape=[tf.shape(images)[0], params['z_dim']], mean=0.0, stddev=1.0) z = encoder_mu + tf.sqrt(encoder_var) * eps # classify the digit digit_logits = digit_classifier(images, params['digit_classification_layers']) digit_prob = tf.nn.softmax(digit_logits) #     ,  #    decoded_images = decoder(tf.concat([z, digit_prob], axis=1), params['decoder_layers'])</span></span></code> </pre> <br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#    ,    #    loss_reconstruction = -tf.reduce_sum( tf.contrib.distributions.Normal( decoded_images, params['decoder_std'] ).log_prob(images), axis=1 ) #         . #      , #         #  ,  KL-   # ,    loss_prior = -0.5 * tf.reduce_sum( 1 + tf.log(encoder_var) - encoder_mu ** 2 - encoder_var, axis=1 ) loss_auto_encode = tf.reduce_mean( loss_reconstruction + loss_prior, axis=0 ) # digit_classification_weight      , #      loss_digit_classifier = params['digit_classification_weight'] * tf.reduce_mean( tf.nn.sparse_softmax_cross_entropy_with_logits(labels=digits, logits=digit_logits), axis=0 ) loss = loss_auto_encode + loss_digit_classifier train_op = tf.train.AdamOptimizer(params['learning_rate']).minimize(loss)</span></span></code> </pre> <br><h1>  Treinamento </h1><br><img src="https://habrastorage.org/getpro/habr/post_images/8ee/8ff/109/8ee8ff10924b6d1cefd27567e49f3a9f.jpg"><br><br>  Treinaremos um modelo para otimizar duas fun√ß√µes de perda - VAE e classifica√ß√£o - usando <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">SGD</a> . <br><br>  No final de cada √©poca, selecionamos vetores ocultos e os decodificamos em imagens para observar visualmente como o poder generativo do modelo melhora ao longo das √©pocas.  O m√©todo de amostragem √© o seguinte: <br><br><ol><li>  Defina explicitamente as dimens√µes usadas para classificar pelo d√≠gito que queremos gerar.  Por exemplo, se queremos criar uma imagem do n√∫mero 2, definimos as medidas <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-694"><span class="MJXp-mo" id="MJXp-Span-695" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-696">0010000000</span><span class="MJXp-mo" id="MJXp-Span-697" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-89-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-89"> [0010000000] </script>  . </li><li>  Selecione aleatoriamente dentre outras dimens√µes da distribui√ß√£o normal multidimensional.  Estes s√£o os valores para os diferentes n√∫meros que s√£o gerados nesta √©poca.  Ent√£o, temos uma id√©ia do que √© codificado em outras dimens√µes, por exemplo, estilo de escrita √† m√£o. </li></ol><br>  O significado da etapa 1 √© que, ap√≥s a converg√™ncia, o modelo deve ser capaz de classificar a figura na imagem de entrada por essas configura√ß√µes de medi√ß√£o.  No entanto, eles tamb√©m s√£o usados ‚Äã‚Äãna fase de decodifica√ß√£o para criar uma imagem.  Ou seja, a sub-rede do decodificador sabe: quando as medi√ß√µes correspondem ao n√∫mero 2, deve gerar uma imagem com esse n√∫mero.  Portanto, se definirmos manualmente as medidas para o n√∫mero 2, obteremos uma imagem gerada dessa figura. <br><br><pre> <code class="python hljs">samples = [] losses_auto_encode = [] losses_digit_classifier = [] <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> tf.Session() <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> sess: sess.run(tf.global_variables_initializer()) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> epoch <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> xrange(params[<span class="hljs-string"><span class="hljs-string">'epochs'</span></span>]): <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> _ <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> xrange(mnist.train.num_examples / params[<span class="hljs-string"><span class="hljs-string">'batch_size'</span></span>]): batch_images, batch_digits = mnist.train.next_batch(params[<span class="hljs-string"><span class="hljs-string">'batch_size'</span></span>]) sess.run(train_op, feed_dict={images: batch_images, digits: batch_digits}) train_loss_auto_encode, train_loss_digit_classifier = sess.run( [loss_auto_encode, loss_digit_classifier], {images: mnist.train.images, digits: mnist.train.labels}) losses_auto_encode.append(train_loss_auto_encode) losses_digit_classifier.append(train_loss_digit_classifier) sample_z = np.tile(np.random.randn(<span class="hljs-number"><span class="hljs-number">1</span></span>, params[<span class="hljs-string"><span class="hljs-string">'z_dim'</span></span>]), reps=[num_digits, <span class="hljs-number"><span class="hljs-number">1</span></span>]) gen_samples = sess.run(decoded_images, feed_dict={z: sample_z, digit_prob: np.eye(num_digits)}) samples.append(gen_samples)</code> </pre> <br>  Vamos verificar se as duas fun√ß√µes de perda ficam bem, ou seja, elas diminuem: <br><br><pre> <code class="python hljs">plt.subplot(<span class="hljs-number"><span class="hljs-number">121</span></span>) plt.plot(losses_auto_encode) plt.title(<span class="hljs-string"><span class="hljs-string">'VAE loss'</span></span>) plt.subplot(<span class="hljs-number"><span class="hljs-number">122</span></span>) plt.plot(losses_digit_classifier) plt.title(<span class="hljs-string"><span class="hljs-string">'digit classifier loss'</span></span>) plt.tight_layout()</code> </pre> <br><img src="https://habrastorage.org/webt/tv/qy/qo/tvqyqo9chfeudddlg2hzqtmlcea.png"><br><br>  Al√©m disso, vamos exibir as imagens geradas e ver se o modelo realmente pode criar imagens com n√∫meros manuscritos: <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">plot_samples</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(samples)</span></span></span><span class="hljs-function">:</span></span> IMAGE_WIDTH = <span class="hljs-number"><span class="hljs-number">0.7</span></span> plt.figure(figsize=(IMAGE_WIDTH * num_digits, len(samples) * IMAGE_WIDTH)) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> epoch, images <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> enumerate(samples): <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> digit, image <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> enumerate(images): plt.subplot(len(samples), num_digits, epoch * num_digits + digit + <span class="hljs-number"><span class="hljs-number">1</span></span>) plt.imshow(image.reshape((<span class="hljs-number"><span class="hljs-number">28</span></span>, <span class="hljs-number"><span class="hljs-number">28</span></span>)), cmap=<span class="hljs-string"><span class="hljs-string">'Greys_r'</span></span>) plt.gca().xaxis.set_visible(<span class="hljs-keyword"><span class="hljs-keyword">False</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> digit == <span class="hljs-number"><span class="hljs-number">0</span></span>: plt.gca().yaxis.set_ticks([]) plt.ylabel(<span class="hljs-string"><span class="hljs-string">'epoch {}'</span></span>.format(epoch + <span class="hljs-number"><span class="hljs-number">1</span></span>), verticalalignment=<span class="hljs-string"><span class="hljs-string">'center'</span></span>, horizontalalignment=<span class="hljs-string"><span class="hljs-string">'right'</span></span>, rotation=<span class="hljs-number"><span class="hljs-number">0</span></span>, fontsize=<span class="hljs-number"><span class="hljs-number">14</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: plt.gca().yaxis.set_visible(<span class="hljs-keyword"><span class="hljs-keyword">False</span></span>) plot_samples(samples)</code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/nq/uo/sm/nquosmxgman_ehoi6pbbnmdcgqc.png"></div><br><h1>  Conclus√£o </h1><br>  √â bom ver que uma rede de distribui√ß√£o direta simples (sem convuls√µes sofisticadas) gera belas imagens em apenas 20 √©pocas.  O modelo aprendeu rapidamente a usar medidas especiais para n√∫meros: na 9¬™ era, j√° vemos a sequ√™ncia de n√∫meros que est√°vamos tentando gerar. <br><br>  Cada √©poca usava valores aleat√≥rios diferentes para outras dimens√µes; portanto, o estilo √© diferente entre as √©pocas, mas √© semelhante entre elas: pelo menos em algumas.  Por exemplo, no dia 18, todos os n√∫meros s√£o mais gordos em compara√ß√£o ao dia 20. <br><br><h4>  Anota√ß√µes </h4><br>  O artigo √© baseado na minha experi√™ncia e nas seguintes fontes: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Conclus√£o variacional e aprendizado profundo: uma nova s√≠ntese</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Guia do codificador autom√°tico de varia√ß√£o</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt429276/">https://habr.com/ru/post/pt429276/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt429266/index.html">Quais sal√°rios para os especialistas em TI s√£o oferecidos pelos empregadores do My Circle, dados de maio a outubro de 2018</a></li>
<li><a href="../pt429268/index.html">Aranha gigante e minotauro nas ruas de Toulouse</a></li>
<li><a href="../pt429270/index.html">Jornalismo adulto: da R√∫ssia ao Kremlin</a></li>
<li><a href="../pt429272/index.html">Um breve aperto de um livro React e desenvolvimento funcional da Web do Redux: Cap√≠tulo 1. Bem-vindo ao React</a></li>
<li><a href="../pt429274/index.html">Inicializa√ß√£o: como viver a rodada</a></li>
<li><a href="../pt429278/index.html">Prospectiva tecnologia de grava√ß√£o magn√©tica MAMR: o que nos espera no futuro pr√≥ximo?</a></li>
<li><a href="../pt429280/index.html">Como uma vulnerabilidade no REG.RU permitiu obter dados de registro de qualquer dom√≠nio</a></li>
<li><a href="../pt429286/index.html">Como acelerar o aprendizado de m√°quina GPU - nova plataforma de c√≥digo aberto introduzida</a></li>
<li><a href="../pt429288/index.html">Desenvolvedor! Pare de se considerar um especialista n√£o suficientemente bom, isso n√£o √© verdade</a></li>
<li><a href="../pt429290/index.html">Tesla vai construir outra bateria gigante na Austr√°lia</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>