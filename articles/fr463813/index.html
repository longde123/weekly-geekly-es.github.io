<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧝🏽 👨🏾‍🤝‍👨🏻 👨🏼‍🚒 Multivan et routage sur Mikrotik RouterOS 🍩 👨🏻‍💼 💚</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Avec corrections et ajouts du 02/11/2020 
 Présentation 
 Outre la vanité, la fréquence déprimante des questions sur ce sujet dans les groupes concern...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Multivan et routage sur Mikrotik RouterOS</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/463813/">  Avec corrections et ajouts du 02/11/2020 <br><h4>  Présentation </h4><br>  Outre la vanité, la fréquence déprimante des questions sur ce sujet dans les groupes concernés de la communauté des télégrammes russophones m'a incité à reprendre l'article.  Cet article est destiné aux administrateurs novices de Mikrotik RouterOS (ci-après ROS).  Il ne considère qu'un multivan, avec un accent sur le routage.  Le bonus comprend des paramètres minimalement suffisants pour assurer un fonctionnement sûr et pratique.  Ceux qui recherchent la divulgation de ces files d'attente, l'équilibrage de charge, le vlan, les ponts, l'analyse approfondie en plusieurs étapes de l'état du canal et similaires - ne peuvent pas perdre de temps et d'efforts pour lire. <br><a name="habracut"></a><br><h4>  Données source </h4><br>  En tant que sujet de test, un routeur Mikrotik à cinq ports avec ROS version 6.45+ a été sélectionné.  Il acheminera le trafic entre deux réseaux locaux (LAN1 et LAN2) et trois fournisseurs (ISP1, ISP2, ISP3).  Le canal vers ISP1 a une adresse statique «grise», ISP2 est «blanc» reçu via DHCP, ISP3 est «blanc» avec authentification PPPoE.  Le schéma de connexion est illustré dans la figure: <br><br><img src="https://habrastorage.org/webt/pd/di/mv/pddimv_vbwqmityow2oe2oxngam.jpeg"><br><br>  La tâche consiste à configurer le routeur MTK en fonction du schéma afin que: <br><br><ol><li>  Fournit une commutation automatique vers le fournisseur de sauvegarde.  Le principal fournisseur est ISP2, la première réserve est ISP1, la deuxième réserve est ISP3. </li><li>  Pour organiser l'accès LAN1 à Internet uniquement via ISP1. </li><li>  Permet d'acheminer le trafic des réseaux locaux vers Internet via le fournisseur sélectionné en fonction de la liste d'adresses. </li><li>  Fournir la possibilité de publier des services d'un réseau local sur Internet (DSTNAT) </li><li>  Configurez un filtre pare-feu pour fournir la sécurité minimale suffisante à partir d'Internet. </li><li>  Le routeur peut émettre son propre trafic via l'un des trois fournisseurs, en fonction de l'adresse source sélectionnée. </li><li>  Fournissez le routage des paquets de réponse vers le canal d'où ils proviennent (y compris le LAN). </li></ol><br>  <i><b>Remarque.</b></i>  <i>Nous allons configurer le routeur «à partir de zéro» afin de garantir qu'il n'y a pas de surprise à démarrer des configurations «prêtes à l'emploi» changeant de version en version.</i>  <i>Winbox a été choisi comme outil de configuration, où les modifications seront affichées visuellement.</i>  <i>Les paramètres eux-mêmes seront définis par des commandes dans le terminal Winbox.</i>  <i>La connexion physique pour la configuration se fait via une connexion directe à l'interface Ether5.</i> <br><br><h4>  Une petite discussion sur ce qu'est un multivan, que ce soit un problème ou que des gens astucieux et astucieux tissent des réseaux de conspirations </h4><br>  Un administrateur curieux et attentif, mettant en place tel ou tel schéma par lui-même, se rend soudain compte qu'il fonctionne normalement.  Oui, oui, sans ces tables de routage personnalisées et autres règles de routage, qui regorgent de la plupart des articles sur ce sujet.  Vérifiez-le? <br><br>  Peut-on configurer l'adressage sur les interfaces et les passerelles par défaut?  Oui: <br><br>  L'adresse et la passerelle avec <b>distance = 2</b> et <b>check-gateway = ping</b> ont été enregistrées sur ISP1 <b>.</b> <br>  Sur ISP2, le paramètre DHCP par défaut pour le client est la distance, respectivement, égale à un. <br>  Sur ISP3 dans les paramètres pppoe du client avec <b>add-default-route = yes</b> set <b>default-route-distance = 3</b> . <br><br>  N'oubliez pas d'enregistrer NAT pour la sortie: <br><br>  <b>/ ip firewall nat add action = chaîne de mascarade = srcnat out-interface-list = WAN</b> <br><br>  En conséquence, les utilisateurs des réseaux locaux ont du plaisir à charger les scellés via le fournisseur principal ISP2 et il y a une réservation du canal à l'aide du mécanisme de <b>passerelle de vérification</b> <sup>.</sup> <br><br>  Le point 1 de la tâche est mis en œuvre.  Où est le multivan avec ses étiquettes?  Non ... <br><br>  Plus loin.  Vous devez libérer des clients spécifiques du LAN via ISP1: <br><br>  <b>/ ip firewall mangle add action = route chain = préroutage dst-address-list =! BOGONS \</b> <b><br></b>  <b>passthrough = oui route-dst = 100.66.66.1 src-address-list = Via_ISP1</b> <b><br></b>  <b>/ ip firewall mangle add action = route chain = préroutage dst-address-list =! BOGONS \</b> <b><br></b>  <b>passthrough = no route-dst = 100.66.66.1 src-address = 192.168.88.0 / 24</b> <br><br>  Les points 2 et 3 de la tâche sont mis en œuvre.  Tags, tampons, règles de parcours, où êtes-vous?! <br><br>  Besoin de donner accès à votre serveur OpenVPN préféré avec l'adresse 172.17.17.17 pour les clients Internet?  SVP: <br><br>  <b>/ ip cloud set ddns-enabled = yes</b> <br><br>  Nous donnons le résultat de sortie aux clients comme un festin: " <b>: put [ip cloud get dns-name]</b> " <br><br>  Nous enregistrons la redirection de port depuis Internet: <br><br>  <b>/ ip firewall nat add action = dst-nat chain = dstnat dst-port = 1194 \</b> <b><br></b>  <b>in-interface-list = protocole WAN = adresses udp = 172.17.17.17</b> <br><br>  Le point 4 est prêt. <br><br>  Nous avons mis en place un pare-feu et d'autres éléments de sécurité pour le point 5, en même temps, nous sommes heureux que tout fonctionne pour les utilisateurs et atteignons un conteneur avec une boisson préférée ... <br>  Ah!  Les tunnels sont encore oubliés. <br><br>  Le client l2tp configuré selon l'article googlé est passé au VDS néerlandais bien-aimé?  Oui <br>  l2tp-server avec IPsec rose et les clients par nom DNS depuis IP Cloud (voir ci-dessus) s'accrochent?  Oui <br>  En nous penchant en arrière, en buvant une gorgée de boisson, nous examinons paresseusement les points 6 et 7 du problème.  Nous pensons - en avons-nous besoin?  Tout fonctionne comme ça (s) ... Donc si ce n'est pas nécessaire, alors c'est tout.  Multivan implémenté. <br><br>  <b>Qu'est-ce qu'un multivan?</b>  <b>Il s'agit de la connexion de plusieurs canaux Internet à un routeur.</b> <br><br>  Vous ne pouvez pas lire l'article plus loin, car que peut-il y avoir en plus d'une démonstration d'applicabilité douteuse? <br><br>  Avec ceux qui restent, qui sont intéressés par les points 6 et 7 de la tâche, et ressentent également les démangeaisons du perfectionnisme, nous plongeons plus profondément. <br><br>  La tâche la plus importante de la mise en œuvre de multivans est le routage correct du trafic.  A savoir: quel que soit (ou lequel) <sup>Voir la note 3,</sup> le ou les canaux du fournisseur regardent la route par défaut sur notre routeur, il devrait retourner la réponse exactement au canal d'où provient le paquet.  La tâche est claire.  Où est le problème?  En effet, dans un simple réseau local, la tâche est la même, mais personne ne dérange avec des paramètres supplémentaires et ne ressent aucun problème.  La différence est que tout nœud routé sur Internet est accessible via chacun de nos canaux, et non via un canal strictement spécifique, comme dans un simple LAN.  Mais le «problème» est que si nous recevons une demande d'adresse IP d'ISP3, alors dans notre cas la réponse passera par le canal ISP2, puisque la passerelle par défaut y est dirigée.  Il partira et sera rejeté par le fournisseur comme étant incorrect.  Nous avons décidé du problème.  Comment le résoudre? <br><br>  La solution est divisée en trois étapes: <br><br><ol><li>  <b>Préconfiguration</b>  À ce stade, les paramètres de base du routeur seront définis: réseau local, pare-feu, listes d'adresses, épingle à cheveux NAT, etc. </li><li>  <b>Multivan.</b>  À ce stade, les connexions nécessaires seront marquées et triées en fonction des tables de routage. </li><li>  <b>Connexion au FAI.</b>  A ce stade, les interfaces fournissant la connexion Internet seront configurées, le routage et le mécanisme de réservation des canaux Internet seront impliqués. </li></ol><br>  <i><b>Remarque.</b></i>  <i>Trois types différents de connexion au FAI ont été choisis spécifiquement pour montrer qu'il n'y a rien d'insoluble dans la configuration de multivans avec des adresses dynamiques et démontrer l'une des options de la solution.</i> <br>  <u><b>Important!</b></u>  Pour commuter les canaux selon l'algorithme spécifié en utilisant le coût des itinéraires à <b>distance</b> , le mécanisme de <b>passerelle de vérification</b> est utilisé <b>.</b>  <sup>Voir note 1</sup> <br>  Les scripts donnés dans l'article n'ont rien à voir avec la réservation de chaîne. <br><br><h4>  1. Préréglage </h4><br>  1.1.  Nous effaçons la configuration du routeur avec la commande: <br><br><pre><code class="plaintext hljs">/system reset-configuration skip-backup=yes no-defaults=yes</code> </pre> <br>  d'accord avec " <b>Dangereux!</b>  <b>Réinitialiser quand même?</b>  <b>[y / N]:</b> ”et, après le redémarrage, nous nous connectons à Winbox via MAC.  À ce stade, la configuration et la base d'utilisateurs sont effacées. <br><br>  1.2.  Créez un nouvel utilisateur: <br><br><pre> <code class="plaintext hljs">/user add group=full name=knight password=ultrasecret comment="Not horse"</code> </pre> <br>  connectez-vous en dessous et supprimez la valeur par défaut: <br><br><pre> <code class="plaintext hljs">/user remove admin</code> </pre> <br>  <i><b>Remarque.</b></i>  <i>C'est la suppression et non la déconnexion de l'utilisateur par défaut que l'auteur considère plus sûr et recommande d'utiliser.</i> <br><br>  1.3.  Nous créons des listes d'interfaces de base pour la commodité de fonctionner dans un pare-feu, des paramètres de découverte et d'autres serveurs MAC: <br><br><pre> <code class="plaintext hljs">/interface list add name=WAN comment="For Internet" /interface list add name=LAN comment="For Local Area"</code> </pre> <br>  Nous signons des interfaces avec des commentaires <br><br><pre> <code class="plaintext hljs">/interface ethernet set ether1 comment="to ISP1" /interface ethernet set ether2 comment="to ISP2" /interface ethernet set ether3 comment="to ISP3" /interface ethernet set ether4 comment="to LAN1" /interface ethernet set ether5 comment="to LAN2"</code> </pre> <br>  et remplissez les listes d'interfaces: <br><br><pre> <code class="plaintext hljs">/interface list member add interface=ether1 list=WAN comment=ISP1 /interface list member add interface=ether2 list=WAN comment=ISP2 /interface list member add interface=ether3 list=WAN comment="to ISP3" /interface list member add interface=ether4 list=LAN comment="LAN1" /interface list member add interface=ether5 list=LAN comment="LAN2"</code> </pre><br>  <i><b>Remarque.</b></i>  <i>Écrire des commentaires clairs vaut le temps consacré à cela, ce qui facilite grandement le dépannage et la compréhension de la configuration.</i> <i><br><br></i>  <i>L'auteur considère qu'il est nécessaire, pour des raisons de sécurité, d'ajouter l'interface ether3 à la liste d'interfaces «WAN», malgré le fait que le protocole ip ne le traversera pas.</i> <i><br><br></i>  <i>N'oubliez pas qu'une fois l'interface PPP augmentée sur ether3, elle devra également être ajoutée à la liste des interfaces «WAN»</i> <br><br>  1.4.  Nous cachons le routeur de la détection de proximité et du contrôle des réseaux des fournisseurs par MAC: <br><br><pre> <code class="plaintext hljs">/ip neighbor discovery-settings set discover-interface-list=!WAN /tool mac-server set allowed-interface-list=LAN /tool mac-server mac-winbox set allowed-interface-list=LAN</code> </pre> <br>  1.5.  Nous créons un ensemble minimum suffisant de règles de filtrage du pare-feu pour protéger le routeur: <br><br><pre> <code class="plaintext hljs">/ip firewall filter add action=accept chain=input \ comment="Related Established Untracked Allow" \ connection-state=established,related,untracked</code> </pre> <br>  (la règle autorise les connexions établies et connexes initiées à la fois à partir des réseaux connectés et par le routeur lui-même) <br><br><pre> <code class="plaintext hljs">/ip firewall filter add action=accept chain=input \ comment="ICMP from ALL" protocol=icmp</code> </pre> <br>  (ping et pas seulement ping. Tout icmp est autorisé à entrer. Il est très utile pour trouver des problèmes avec MTU) <br><br><pre> <code class="plaintext hljs">/ip firewall filter add action=drop chain=input comment="All other WAN Drop" \ in-interface-list=WAN</code> </pre> <br>  (la règle de fermeture de la chaîne d'entrée interdit tout ce qui arrive d'Internet) <br><br><pre> <code class="plaintext hljs">/ip firewall filter add action=accept chain=forward \ comment="Established, Related, Untracked allow" \ connection-state=established,related,untracked</code> </pre> <br>  (la règle autorise les connexions établies et connexes qui transitent par le routeur) <br><br><pre> <code class="plaintext hljs">/ip firewall filter add action=drop chain=forward comment="Invalid drop" \ connection-state=invalid</code> </pre> <br>  (la règle supprime les connexions, avec connection-state = invalide, passant par le routeur. Elle est fortement recommandée par Mikrotik, mais dans certaines situations rares, elle peut bloquer le trafic utile) <br><br><pre> <code class="plaintext hljs">/ip firewall filter add action=drop chain=forward \ comment="Drop all from WAN not DSTNATed" connection-nat-state=!dstnat \ connection-state=new in-interface-list=WAN</code> </pre> <br>  (la règle interdit les paquets qui transitent par Internet et qui n'ont pas suivi la procédure dstnat via le routeur. Cela protégera les réseaux locaux des intrus qui, étant dans le même domaine de diffusion avec nos réseaux externes, enregistreront nos adresses IP externes en tant que passerelle et, par conséquent, essaieront «Explorez» nos réseaux locaux.) <br><br>  <i><b>Remarque.</b></i>  <i>Supposons que LAN1 et LAN2 sont des réseaux de confiance et que le trafic entre eux et à partir d'eux ne soit pas filtré.</i> <br><br>  1.6.  Créez une liste avec une liste de réseaux non routables: <br><br><pre> <code class="plaintext hljs">/ip firewall address-list add address=0.0.0.0/8 comment="\"This\" Network" list=BOGONS add address=10.0.0.0/8 comment="Private-Use Networks" list=BOGONS add address=100.64.0.0/10 comment="Shared Address Space. RFC 6598" list=BOGONS add address=127.0.0.0/8 comment=Loopback list=BOGONS add address=169.254.0.0/16 comment="Link Local" list=BOGONS add address=172.16.0.0/12 comment="Private-Use Networks" list=BOGONS add address=192.0.0.0/24 comment="IETF Protocol Assignments" list=BOGONS add address=192.0.2.0/24 comment=TEST-NET-1 list=BOGONS add address=192.168.0.0/16 comment="Private-Use Networks" list=BOGONS add address=198.18.0.0/15 comment="Network Interconnect Device Benchmark Testing"\ list=BOGONS add address=198.51.100.0/24 comment=TEST-NET-2 list=BOGONS add address=203.0.113.0/24 comment=TEST-NET-3 list=BOGONS add address=224.0.0.0/4 comment=Multicast list=BOGONS add address=192.88.99.0/24 comment="6to4 Relay Anycast" list=BOGONS add address=240.0.0.0/4 comment="Reserved for Future Use" list=BOGONS add address=255.255.255.255 comment="Limited Broadcast" list=BOGONS</code> </pre> <br>  (Il s'agit d'une liste d'adresses et de réseaux qui ne sont pas acheminés vers Internet et, par conséquent, nous suivrons également cela.) <br><br>  <i><b>Remarque.</b></i>  <i>La liste peut changer, je vous conseille donc de vérifier périodiquement la pertinence.</i> <br><br>  1.7.  Configurez DNS pour le routeur lui-même: <br><br><pre> <code class="plaintext hljs">/ip dns set servers=1.1.1.1,8.8.8.8</code> </pre> <br>  <i><b>Remarque.</b></i>  <i>Dans la version actuelle de ROS, les serveurs dynamiques ont priorité sur ceux définis statiquement.</i>  <i>Une demande de résolution de nom est envoyée au premier serveur dans l'ordre de la liste.</i>  <i>La transition vers le serveur suivant se produit lorsque le serveur actuel n'est pas disponible.</i>  <i>Big timeout - plus de 5 secondes.</i>  <i>Le retour lorsque le «serveur tombé en panne» est repris ne se produit pas automatiquement.</i>  <i>Compte tenu de cet algorithme et de la présence d'un multivan, l'auteur recommande de ne pas utiliser de serveurs émis par des fournisseurs.</i> <br><br>  1.8.  Configurez le réseau local. <br>  1.8.1.  Configurez les adresses IP statiques sur les interfaces LAN: <br><br><pre> <code class="plaintext hljs">/ip address add interface=ether4 address=192.168.88.254/24 comment="LAN1 IP" /ip address add interface=ether5 address=172.16.1.0/23 comment="LAN2 IP"</code> </pre> <br>  1.8.2.  Nous définissons les règles pour les itinéraires vers nos réseaux locaux via la table de routage principale: <br><br><pre> <code class="plaintext hljs">/ip route rule add dst-address=192.168.88.0/24 table=main comment="to LAN1" /ip route rule add dst-address=172.16.0.0/23 table=main comment="to LAN2"</code> </pre> <br>  <i><b>Remarque.</b></i>  <i>C'est l'un des moyens les plus simples et les plus rapides d'accéder aux adresses de réseau local avec des adresses IP externes des interfaces de routeur par lesquelles la route par défaut ne passe pas.</i> <br><br>  1.8.3.  Si nécessaire, activez Hairpin NAT pour LAN1 et LAN2: <br><br><pre> <code class="plaintext hljs">/ip firewall nat add action=src-nat chain=srcnat comment="Hairpin to LAN1" \ out-interface=ether4 src-address=192.168.88.0/24 to-addresses=192.168.88.254 /ip firewall nat add action=src-nat chain=srcnat comment="Hairpin to LAN2" \ out-interface=ether5 src-address=172.16.0.0/23 to-addresses=172.16.1.0</code> </pre> <br>  <i><b>Remarque.</b></i>  <i>Cela permet aux utilisateurs de LAN1 et LAN2 d'accéder via une IP externe (dstnat) à des serveurs situés avec des utilisateurs sur le même segment de réseau.</i> <br><br><h4>  2. En fait, la mise en œuvre des multivans corrects </h4><br>  Pour résoudre le problème de «répondre d'où ils l'ont demandé», nous utiliserons deux outils ROS: la <b>marque de connexion</b> et la <b>marque de routage</b> .  <b>La marque de connexion</b> vous permet de marquer la connexion souhaitée et de continuer à travailler avec cette étiquette comme condition pour appliquer la <b>marque de routage</b> .  Et déjà avec la <b>marque de routage,</b> il est possible de travailler sur les <b>routes IP</b> et les <b>règles de route</b> .  Nous avons compris les outils, maintenant nous devons décider quelles connexions marquer - un, où exactement marquer - deux. <br><br>  Avec le premier, tout est simple - nous devons marquer toutes les connexions qui arrivent au routeur depuis Internet via le canal approprié.  Dans notre cas, il s'agira de trois labels (selon le nombre de canaux): "conn_isp1", "conn_isp2" et "conn_isp3". <br><br>  La nuance avec la seconde est que les connexions entrantes seront de deux types: transit et celles qui sont destinées au routeur lui-même.  Le mécanisme de marque de connexion fonctionne dans la table <b>mangle</b> .  Considérez le déplacement du colis sur un schéma simplifié, aimablement collecté par les spécialistes de la ressource mikrotik-trainings.com (non publicitaire): <br><br><img src="https://habrastorage.org/webt/gg/yc/u4/ggycu4_z4ps93z-crahvri9pshw.jpeg"><br><br>  En suivant les flèches, nous voyons que le paquet arrivant à « <b>l'interface d'entrée</b> » passe par la chaîne « <b>Préroutage</b> » et seulement alors il est divisé en transit et local dans le bloc « <b>Décision de routage</b> ».  Par conséquent, pour tuer deux oiseaux avec une pierre, utilisez la <b>marque de connexion</b> dans la table de <b>pré</b> - <b>routage Mangle</b> de la chaîne de <b>pré</b> - <b>routage</b> . <br><br>  <i><b>Remarque</b> .</i>  <i>Dans ROS, les étiquettes «Routing mark» sont indiquées dans la section Ip / Routes / Rules comme «Table», et dans les autres sections comme «Routing Mark».</i>  <i>Cela peut entraîner une certaine confusion dans la compréhension, mais, en fait, c'est la même chose, et c'est l'analogue de rt_tables dans iproute2 sur linux.</i> <br><br>  2.1.  Nous marquons les connexions entrantes de chacun des fournisseurs: <br><br><pre> <code class="plaintext hljs">/ip firewall mangle add action=mark-connection chain=prerouting \ comment="Connmark in from ISP1" connection-mark=no-mark in-interface=ether1 \ new-connection-mark=conn_isp1 passthrough=no /ip firewall mangle add action=mark-connection chain=prerouting \ comment="Connmark in from ISP2" connection-mark=no-mark in-interface=ether2 \ new-connection-mark=conn_isp2 passthrough=no /ip firewall mangle add action=mark-connection chain=prerouting \ comment="Connmark in from ISP3" connection-mark=no-mark in-interface=pppoe-isp3 \ new-connection-mark=conn_isp3 passthrough=no</code> </pre> <br>  <i><b>Remarque.</b></i> <i><br></i>  <i>Les lecteurs qui tentent de répéter littéralement et dans l'ordre de lecture le paramètre suggéré dans l'article, lors de la saisie de la troisième commande, ils rencontreront l'erreur: "l'entrée ne correspond à aucune valeur d'interface".</i>  <i>Cela est dû à l'absence de l'interface «pppoe-isp3», qui sera configurée dans la section 3.3.2.</i>  <i>À ce stade, vous pouvez entrer «ether3» au lieu de «pppoe-isp3».</i>  <i>Après avoir terminé le paragraphe 3.3.2, vous devez revenir en arrière et mettre le nom actuel de l'interface.</i> <i><br><br></i>  <i>Afin de ne pas marquer les connexions déjà marquées, j'utilise la condition connection-mark = no-mark au lieu de connection-state = new.</i> <i><br><br></i>  <i>passthrough = no - car dans cette méthode d'implémentation, le re-marquage est exclu, et pour accélérer, vous pouvez interrompre l'énumération des règles après la première correspondance.</i> <br><br>  Il convient de garder à l'esprit que nous n'interférons toujours pas avec le routage.  Maintenant, il n'y a que des étapes de préparation.  La prochaine étape de mise en œuvre sera le traitement du trafic de transit, qui est retourné via une connexion régulière du destinataire dans le réseau local.  C'est-à-dire  ces paquets qui (voir schéma) ont traversé le routeur en cours de route: <br><br>  <b>"Input Interface" =&gt; "Prerouting" =&gt; "Routing Decision" =&gt; "Forward" =&gt; "Post Routing" =&gt; "Output Interface"</b> et arrivé à destination sur le réseau local. <br><br>  <u><b>Important!</b></u>  Dans ROS, il n'y a pas de division logique entre les interfaces externes et internes.  Si nous suivons le chemin du paquet de réponse dans le diagramme ci-dessous, il suivra le même chemin logique que la demande: <br><br>  <b>"Input Interface" =&gt; "Prerouting" =&gt; "Routing Decision" =&gt; "Forward" =&gt; "Post Routing" =&gt; "Output Interface"</b> juste pour la requête " <b>Input Interface</b> " il y avait une interface ISP, et pour la réponse - LAN <br><br>  2.2.  Nous dirigeons le trafic de retour vers les tables de routage correspondantes: <br><br><pre> <code class="plaintext hljs">/ip firewall mangle add action=mark-routing chain=prerouting \ comment="Routemark transit out via ISP1" connection-mark=conn_isp1 \ dst-address-type=!local in-interface-list=!WAN new-routing-mark=to_isp1 passthrough=no /ip firewall mangle add action=mark-routing chain=prerouting \ comment="Routemark transit out via ISP2" connection-mark=conn_isp2 \ dst-address-type=!local in-interface-list=!WAN new-routing-mark=to_isp2 passthrough=no /ip firewall mangle add action=mark-routing chain=prerouting \ comment="Routemark transit out via ISP3" connection-mark=conn_isp3 \ dst-address-type=!local in-interface-list=!WAN new-routing-mark=to_isp3 passthrough=no</code> </pre> <br>  <i><b>Remarque.</b></i>  <i><b>in-interface-list =! WAN - nous travaillons uniquement avec le trafic provenant du réseau local et dst-address-type =! local sans l'adresse de destination des adresses d'interface du routeur lui-même.</b></i> <i><b><br></b></i> <br><br>  La même chose pour les paquets locaux qui sont arrivés au routeur en cours de route: <br><br>  <b>"Interface d'entrée" =&gt; "Préroutage" =&gt; "Décision de routage" =&gt; "Entrée" =&gt; "Processus local"</b> <br><br>  <u><b>Important!</b></u>  La réponse ira dans le sens suivant: <br><br>  <b>"Processus local" =&gt; "Décision de routage" =&gt; "Sortie" =&gt; "Post-routage" =&gt; "Interface de sortie"</b> <b><br></b> <br>  2.3.  Nous dirigeons le trafic local de réponse vers les tables de routage correspondantes: <br><br><pre> <code class="plaintext hljs">/ip firewall mangle add action=mark-routing chain=output \ comment="Routemark local out via ISP1" connection-mark=conn_isp1 \ dst-address-type=!local new-routing-mark=to_isp1 passthrough=no /ip firewall mangle add action=mark-routing chain=output \ comment="Routemark local out via ISP2" connection-mark=conn_isp2 \ dst-address-type=!local new-routing-mark=to_isp2 passthrough=no /ip firewall mangle add action=mark-routing chain=output \ comment="Routemark local out via ISP3" connection-mark=conn_isp3 \ dst-address-type=!local new-routing-mark=to_isp3 passthrough=no</code> </pre> <br>  À ce stade, la tâche de préparer l'envoi d'une réponse au canal Internet d'où provient la demande peut être considérée comme résolue.  Tout est balisé, balisé et prêt à être acheminé. <br>  Un excellent effet «secondaire» de cette configuration est la possibilité de transférer des ports DSNAT à partir des deux fournisseurs (ISP2, ISP3) en même temps.  Pas du tout, car sur ISP1, nous n'avons pas d'adresse routable.  Cet effet est important, par exemple, pour un serveur de messagerie avec deux MX qui regardent différents canaux Internet. <br><br>  Pour éliminer les nuances du fonctionnement des réseaux locaux avec des routeurs IP externes, nous utilisons les solutions des paragraphes.  1.8.2 et 3.1.2.6. <br><br>  De plus, vous pouvez utiliser l'outil avec des marquages ​​et pour résoudre le paragraphe 3 du problème.  Nous l'implémentons comme ceci: <br><br>  2.4.  Nous dirigeons le trafic des clients locaux des listes de routage vers les tables correspondantes: <br><br><pre> <code class="plaintext hljs">/ip firewall mangle add action=mark-routing chain=prerouting \ comment="Address List via ISP1" dst-address-list=!BOGONS new-routing-mark=to_isp1 \ passthrough=no src-address-list=Via_ISP1 /ip firewall mangle add action=mark-routing chain=prerouting \ comment="Address List via ISP2" dst-address-list=!BOGONS new-routing-mark=to_isp2 \ passthrough=no src-address-list=Via_ISP2 /ip firewall mangle add action=mark-routing chain=prerouting \ comment="Address List via ISP3" dst-address-list=!BOGONS new-routing-mark=to_isp3 \ passthrough=no src-address-list=Via_ISP3</code> </pre> <br>  En conséquence, cela ressemble à ceci (l'image est cliquable): <br><br> <a href="" rel="nofollow"><img src="https://habrastorage.org/webt/jw/bt/of/jwbtofiohmdeunznqgpnamyuhrm.jpeg"></a> <br><br><h4>  3. Configurer la connectivité ISP et activer le routage basé sur la marque </h4><br>  3.1.  Configurez la connexion à ISP1: <br>  3.1.1.  Configurez une adresse IP statique: <br><br><pre> <code class="plaintext hljs">/ip address add interface=ether1 address=100.66.66.2/30 comment="ISP1 IP"</code> </pre> <br>  3.1.2.  Configurer le routage statique: <br>  3.1.2.1.  Ajoutez un itinéraire d'urgence par défaut: <br><br><pre> <code class="plaintext hljs">/ip route add comment="Emergency route" distance=254 type=blackhole</code> </pre> <br>  <i><b>Remarque.</b></i>  <i>Cette route permet au trafic provenant des processus locaux de passer par l'étape Route Decision, quel que soit l'état des canaux de l'un des fournisseurs.</i>  <i>La nuance du trafic local sortant est que pour que le paquet se déplace au moins quelque part, le routage actif vers la passerelle par défaut doit être présent dans la table de routage principale.</i>  <i>Sinon, le colis sera simplement détruit.</i> <br><br>  En tant qu'extension de l'outil de <b>passerelle de contrôle</b> pour une analyse plus approfondie de l'état du canal, je propose d'utiliser la méthode de l'itinéraire récursif.  L'essence de la méthode est que nous demandons au routeur de rechercher le chemin vers sa passerelle non pas directement, mais via une passerelle intermédiaire.  En tant que telles passerelles de «test», 4.2.2.1, 4.2.2.2 et 4.2.2.3 seront sélectionnées respectivement pour ISP1, ISP2 et ISP3. <br><br>  3.1.2.2.  Itinéraire vers l'adresse de «vérification»: <br><br><pre> <code class="plaintext hljs">/ip route add check-gateway=ping comment="For recursion via ISP1" \ distance=1 dst-address=4.2.2.1 gateway=100.66.66.1 scope=10</code> </pre> <br>  <i><b>Remarque.</b></i>  <i>La valeur d'étendue est réduite par défaut dans l'étendue cible ROS, afin d'utiliser davantage 4.2.2.1 comme passerelle récursive.</i>  <i>Je souligne: la portée de la route vers l'adresse de «vérification» doit être inférieure ou égale à la portée cible de la route qui référencera la vérification.</i> <br><br>  3.1.2.3.  Route récursive par défaut pour le trafic sans marque de routage: <br><br><pre> <code class="plaintext hljs">/ip route add check-gateway=ping comment="Unmarked via ISP1" \ distance=2 gateway=4.2.2.1</code> </pre> <br>  <i><b>Remarque.</b></i>  <i>La valeur distance = 2 est utilisée car ISP1 est déclaré comme le premier en attente selon les termes de la tâche.</i> <br><br>  3.1.2.4.  Route récursive par défaut pour le trafic avec la marque de routage "to_isp1": <br><br><pre> <code class="plaintext hljs">/ip route add comment="Marked via ISP1 Main" distance=1 gateway=4.2.2.1 \ routing-mark=to_isp1</code> </pre> <br>  <i><b>Remarque.</b></i>  <i>En fait, nous commençons enfin ici à utiliser les fruits des travaux préparatoires menés au paragraphe 2.</i> <i><br><br></i>  <i>Sur cette route, tout le trafic qui a marqué la route «to_isp1» sera dirigé vers la passerelle du premier fournisseur, quelle que soit la passerelle par défaut pour la table principale actuellement active.</i> <br><br>  3.1.2.5.  La première route récursive par défaut de secours pour le trafic étiqueté des fournisseurs ISP2 et ISP3: <br><br><pre> <code class="plaintext hljs">/ip route add comment="Marked via ISP2 Backup1" distance=2 gateway=4.2.2.1 \ routing-mark=to_isp2 /ip route add comment="Marked via ISP3 Backup1" distance=2 gateway=4.2.2.1 \ routing-mark=to_isp3</code> </pre> <br>  <i><b>Remarque.</b></i>  <i>Ces routes sont également nécessaires pour réserver le trafic provenant des réseaux locaux, qui sont membres de la liste d'adresses «to_isp *» »</i> <br><br>  3.1.2.6.  Nous écrivons l'itinéraire pour le trafic du routeur local vers Internet via ISP1: <br><br><pre> <code class="plaintext hljs">/ip route rule add comment="From ISP1 IP to Inet" src-address=100.66.66.2 table=to_isp1</code> </pre> <br>  <i><b>Remarque.</b></i>  <i>En combinaison avec les règles de la clause 1.8.2, une sortie vers le canal souhaité avec une source donnée est fournie.</i>  <i>Ceci est essentiel pour la construction de tunnels dans lesquels l'adresse IP du côté local (EoIP, IP-IP, GRE) est spécifiée.</i>  <i>Étant donné que les règles des règles de routage ip sont exécutées de haut en bas, jusqu'à ce que les conditions correspondent pour la première fois, cette règle doit être postérieure aux règles du paragraphe 1.8.2.</i> <br><br>  3.1.3.  Nous écrivons la règle NAT pour le trafic sortant: <br><br><pre> <code class="plaintext hljs">/ip firewall nat add action=src-nat chain=srcnat comment="NAT via ISP1" \ ipsec-policy=out,none out-interface=ether1 to-addresses=100.66.66.2</code> </pre> <br>  <i><b>Remarque.</b></i>  <i>NAT est tout ce qui va, sauf qu'il tombe dans les politiques IPsec.</i>  <i>J'essaie de ne pas utiliser action = masquerade à moins que cela ne soit absolument nécessaire.</i>  <i>Il est plus lent et plus gourmand en ressources que src-nat car il calcule une adresse pour NAT pour chaque nouvelle connexion.</i> <br><br>  3.1.4.  Nous envoyons les clients de la liste auxquels il est interdit de quitter via d'autres fournisseurs directement à la passerelle du fournisseur ISP1. <br><br><pre> <code class="plaintext hljs">/ip firewall mangle add action=route chain=prerouting \ comment="Address List via ISP1 only" dst-address-list=!BOGONS passthrough=no \ route-dst=100.66.66.1 src-address-list=Via_only_ISP1 place-before=0</code> </pre> <br>  <i><b>Remarque.</b></i>  <i>action = la route a une priorité plus élevée et est appliquée plus tôt que les autres règles de routage.</i> <i><br><br></i>  <i>place-before = 0 - place notre règle en premier dans la liste.</i> <br><br>  3.2.  Nous configurons la connexion à ISP2. <br><br>  Étant donné que le fournisseur ISP2 nous donne les paramètres via DHCP, il est raisonnable d'effectuer les modifications nécessaires avec un script qui démarre lorsque le client DHCP est déclenché: <br><br><pre> <code class="plaintext hljs">/ip dhcp-client add add-default-route=no disabled=no interface=ether2 script=":if (\$bound=1) do={\r\ \n /ip route remove [ find gateway=\"4.2.2.2\" ]; /ip route remove \ [ find where dst-address ~\"4.2.2.2\" ]\r\ \n /ip route add check-gateway=ping comment=\"For recursion via ISP2\" \ distance=1 dst-address=4.2.2.2/32 gateway=\$\"gateway-address\" scope=10\r\ \n /ip route add check-gateway=ping comment=\"Unmarked via ISP2\" \ distance=1 gateway=4.2.2.2\r\ \n /ip route add comment=\"Marked via ISP2 Main\" distance=1 gateway=4.2.2.2 \ routing-mark=to_isp2\r\ \n /ip route add comment=\"Marked via ISP1 Backup1\" distance=2 \ gateway=4.2.2.2 routing-mark=to_isp1\r\ \n /ip route add comment=\"Marked via ISP3 Backup2\" distance=3 \ gateway=4.2.2.2 routing-mark=to_isp3\r\ \n /ip firewall nat add action=src-nat chain=srcnat ipsec-policy=out,none \ out-interface=\$\"interface\" to-addresses=\$\"lease-address\" \ comment=\"NAT via ISP2\"\r\ \n /ip route rule add comment=\"From ISP2 IP to Inet\" \ src-address=\$\"lease-address\" table=to_isp2 \r\ \n} else={\r\ \n /ip route remove [ find gateway=\"4.2.2.2\" ]; /ip route remove \ [ find where dst-address ~\"4.2.2.2\" ]\r\ \n /ip firewall nat remove [find comment=\"NAT via ISP2\"]\r\ \n /ip route rule remove [find comment=\"From ISP2 IP to Inet\"]\r\ \n}\r\ \n" use-peer-dns=no use-peer-ntp=no</code> </pre> <br>  Le script lui-même dans la fenêtre Winbox (cliquable): <br><br> <a href="" rel="nofollow"><img src="https://habrastorage.org/webt/dz/_f/hh/dz_fhhyltpdet5oush5wqwpud2e.jpeg"></a> <br>  <i><b>Remarque.</b></i>  <i>La première partie du script est déclenchée lorsque le bail est reçu avec succès, la seconde - après la libération du bail.</i>  <sup>Voir note 2</sup> <br><br>  3.3.  Nous configurons la connexion au fournisseur ISP3. <br><br>  Puisque le fournisseur de configuration nous donne de la dynamique, il est raisonnable de faire les changements nécessaires avec des scripts qui démarrent après la montée et la chute de l'interface ppp. <br><br>  <i><b>Remarque.</b></i>  <i>L'interface ppp peut être spécifiée comme passerelle au lieu d'une adresse IP.</i>  <i>Cependant, dans ce cas, la route récursive ne peut pas être activée.</i>  <i>Par conséquent, nous obtenons l'adresse IP du côté fournisseur dans la variable et nous l'utilisons plus loin de la même manière que pour les autres fournisseurs</i> <br><br>  3.3.1.  Tout d'abord, configurez le profil: <br><br><pre> <code class="plaintext hljs">/ppp profile add comment="for PPPoE to ISP3" interface-list=WAN name=isp3_client \ on-down="/ip route remove [ find gateway=\"4.2.2.3\" ]\r\ \n/ip route remove [ find where dst-address ~\"4.2.2.3\" ]\r\ \n/ip firewall nat remove [find comment=\"NAT via ISP3\"]\r\ \n/ip route rule remove [find comment=\"From ISP3 IP to Inet\"]" \ on-up="/ip route remove [ find gateway=\"4.2.2.3\" ]; /ip route remove \ [ find where dst-address ~\"4.2.2.3\" ]\r\ \n/ip route add check-gateway=ping comment=\"For recursion via ISP3\" distance=1 \ dst-address=4.2.2.3/32 gateway=\$\"remote-address\" scope=10\r\ \n/ip route add check-gateway=ping comment=\"Unmarked via ISP3\" distance=3 \ gateway=4.2.2.3\r\ \n/ip route add comment=\"Marked via ISP3 Main\" distance=1 gateway=4.2.2.3 \ routing-mark=to_isp3\r\ \n/ip route add comment=\"Marked via ISP1 Backup2\" distance=3 gateway=4.2.2.3 \ routing-mark=to_isp1\r\ \n/ip route add comment=\"Marked via ISP2 Backup2\" distance=3 gateway=4.2.2.3 \ routing-mark=to_isp2\r\ \n/ip firewall mangle set [find comment=\"Connmark in from ISP3\"] \ in-interface=\$\"interface\"\r\ \n/ip firewall nat add action=src-nat chain=srcnat ipsec-policy=out,none \ out-interface=\$\"interface\" to-addresses=\$\"local-address\" \ comment=\"NAT via ISP3\"\r\ \n/ip route rule add comment=\"From ISP3 IP to Inet\" \ src-address=\$\"local-address\" table=to_isp3 "</code> </pre><br>  Le script lui-même dans la fenêtre Winbox (cliquable): <br><br> <a href="" rel="nofollow"><img src="https://habrastorage.org/webt/oz/tz/it/oztzitzzxgl5jz0g9jxskvtf3us.jpeg"></a> <br>  <i><b>Remarque.</b></i>  <i>String</i> <i><br></i>  <i><b>/ ip firewall mangle set [find comment = "Connmark in from ISP3"] in-interface = $ "interface";</b></i> <i><br></i>  <i>Vous permet de traiter correctement le changement de nom de l'interface, car il fonctionne avec son code et non le nom d'affichage.</i> <br><br>  3.3.2.  Maintenant, en utilisant le profil, créez une connexion ppp: <br><br><pre> <code class="plaintext hljs">/interface pppoe-client add allow=mschap2 comment="to ISP3" disabled=no \ interface=ether3 name=pppoe-isp3 password=isp3_pass profile=isp3_client \ user=isp3_client</code> </pre> <br><br>  <i><b>Remarque.</b></i>  <i>Certains fournisseurs "oublient" de donner le paramètre "remote-address".</i>  <i>Dans ce cas, une fois connecté, le script de configuration ne fonctionnera pas correctement et dans le journal, vous verrez l'erreur suivante:</i> <i><br></i>  <i>pppoe, ppp, info pppoe-isp3: impossible de déterminer l'adresse distante, en utilisant xxx.xxx.xxx.xxx</i> <i><br></i>  <i>Pour résoudre ce problème, vous devez définir manuellement l'adresse dans le profil ppp (n'importe quel mannequin):</i> <i><br></i> <pre> <i><code class="plaintext hljs">/ppp profile set isp3_client remote-address=169.254.69.96</code></i> </pre> <i><br></i>  <i>String</i> <i><br></i>  <i><b>/ ip firewall mangle set [find comment = "Connmark in from ISP3"] in-interface = $ "interface";</b></i> <i><br></i>  <i>Vous permet de traiter correctement le changement de nom de l'interface, car il fonctionne avec son code et non le nom d'affichage.</i> <br><br>  En touche finale, réglez l'horloge: <br><br><pre> <code class="plaintext hljs">/system ntp client set enabled=yes \ server-dns-names=0.pool.ntp.org,1.pool.ntp.org,2.pool.ntp.org</code> </pre> <br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Pour ceux qui lisent jusqu'au bout </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La méthode proposée pour implémenter les multivans est la préférence personnelle de l'auteur et n'est pas la seule possible. </font><font style="vertical-align: inherit;">La boîte à outils ROS est vaste et flexible, ce qui, d'une part, cause des difficultés aux débutants, d'autre part - la raison de la popularité. </font><font style="vertical-align: inherit;">Explorez, essayez, découvrez de nouveaux outils et solutions. </font><font style="vertical-align: inherit;">Par exemple, en application des connaissances acquises, il est possible dans cette implémentation du </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">multivan</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de remplacer l'outil </font><b><font style="vertical-align: inherit;">check-gateway</font></b><font style="vertical-align: inherit;"> par des routes récursives avec </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Netwatch</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Remarques </font></font></h4><br><ol><li> <i><b>Check-gateway</b> — ,             .     10 ,   . ,       20-30 .       —     <b>Netwatch</b> ,      . <br>  <b>Check-gateway</b>        . <br><br> <u><b>!</b></u>          ,    .     <b>check-gateway=ping</b>  .</i> </li><li> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il arrive qu'une défaillance se produise dans le mécanisme d'opération DHP, qui ressemble à un client suspendu dans un état de renouvellement. </font><font style="vertical-align: inherit;">Dans ce cas, la deuxième partie du script ne fonctionnera pas, mais le trafic ne fera pas de mal à marcher correctement, car l'état surveille l'itinéraire récursif correspondant.</font></font></i> </li><li> <i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ECMP (Equal Cost Multi-Path)</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - ROS a la possibilité de spécifier un itinéraire avec plusieurs passerelles et la même distance. </font><font style="vertical-align: inherit;">Dans ce cas, les connexions seront réparties sur les canaux à l'aide de l'algorithme round robin, proportionnellement au nombre de passerelles spécifié.</font></font></i> </li></ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pour que l'élan pour écrire l'article aide à façonner sa structure et à mettre l'accent - merci personnel à Eugene </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@jscar</font></font></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr463813/">https://habr.com/ru/post/fr463813/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr463799/index.html">Ce que je n'aime pas dans Windows 10</a></li>
<li><a href="../fr463801/index.html">3 qualités clés pour un chef de produit performant: Anton Stozhko</a></li>
<li><a href="../fr463803/index.html">Mon cinquième jour avec Haiku: portons quelques programmes</a></li>
<li><a href="../fr463805/index.html">Sept livres pour ceux qui veulent devenir game designer</a></li>
<li><a href="../fr463811/index.html">Préparation de l'application pour Android Q. Partie 1</a></li>
<li><a href="../fr463815/index.html">Pourquoi une banque étrangère s'intéresse-t-elle à la source de vos fonds?</a></li>
<li><a href="../fr463817/index.html">20 chefs de produits et la structure matricielle la plus multidimensionnelle de tous. Conversation avec Skyeng</a></li>
<li><a href="../fr463819/index.html">Verrous PostgreSQL: 2. Verrous de chaîne</a></li>
<li><a href="../fr463821/index.html">AMO, Bitrix, 1C et autres: comment choisir par où commencer?</a></li>
<li><a href="../fr463823/index.html">Version Rust 1.37.0: optimisation guidée par le profil, constantes sans nom et fournisseur de fret</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>