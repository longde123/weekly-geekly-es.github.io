<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üìπ ü§≥üèΩ üôé Wenn "Zo√´"! == "Zo√´" oder warum Sie Unicode-Strings normalisieren m√ºssen ü¶â üà∂ üèûÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Schon mal was von Unicode-Normalisierung geh√∂rt? Du bist nicht allein. Aber jeder muss dar√ºber Bescheid wissen. Die Normalisierung kann Ihnen viele Pr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Wenn "Zo√´"! == "Zo√´" oder warum Sie Unicode-Strings normalisieren m√ºssen</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/445274/">  Schon mal was von Unicode-Normalisierung geh√∂rt?  Du bist nicht allein.  Aber jeder muss dar√ºber Bescheid wissen.  Die Normalisierung kann Ihnen viele Probleme ersparen.  Fr√ºher oder sp√§ter passiert bei jedem Entwickler etwas √Ñhnliches wie in der folgenden Abbildung. <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/aed/667/54c/aed66754c254c8eb6c077d2a418f1db6.png"></div>  <i><font color="#999999">Zo√´ ist nicht Zo√´</font></i> <br><a name="habracut"></a><br>  Und dies ist √ºbrigens kein Beispiel f√ºr ein anderes <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">seltsames</a> JavaScript.  Der Autor des Materials, dessen √úbersetzung wir heute ver√∂ffentlichen, sagt, dass er zeigen kann, wie sich das gleiche Problem manifestiert, wenn fast jede vorhandene Programmiersprache verwendet wird.  Insbesondere sprechen wir √ºber Python, Go und sogar Shell-Skripte.  Wie gehe ich damit um? <br><br><h2>  <font color="#3AC1EF">Hintergrund</font> </h2><br>  Das Unicode-Problem trat vor vielen Jahren zum ersten Mal auf, als ich eine Anwendung (in Objective-C) schrieb, die eine Kontaktliste aus dem Adressbuch des Benutzers und aus seinen sozialen Netzwerken importierte. Danach entfernte ich Duplikate.  In bestimmten Situationen stellte sich heraus, dass einige Personen zweimal auf der Liste stehen.  Dies geschah aufgrund der Tatsache, dass ihre Namen laut Programm nicht dieselbe Zeichenfolge waren. <br><br>  Obwohl im obigen Beispiel die beiden Zeilen genau gleich aussehen, unterscheiden sich die Bytes, in denen sie auf der Festplatte gespeichert sind, in der Art und Weise, wie sie im System dargestellt werden.  Im Vornamen <code>"Zo√´"</code> das Zeichen √´ (e mit Umlaut) f√ºr einen einzelnen Unicode-Codepunkt.  Im zweiten Fall besch√§ftigen wir uns mit der Zerlegung, mit dem Ansatz, Zeichen mit mehreren Zeichen darzustellen.  Wenn Sie in Ihrer Anwendung mit Unicode-Zeichenfolgen arbeiten, m√ºssen Sie ber√ºcksichtigen, dass dieselben Zeichen auf unterschiedliche Weise dargestellt werden k√∂nnen. <br><br><h2>  <font color="#3AC1EF">Wie wir zu Emoji kamen: Kurz gesagt zur Zeichenkodierung</font> </h2><br>  Computer arbeiten mit Bytes, die nur Zahlen sind.  Um Texte auf Computern verarbeiten zu k√∂nnen, einigten sich die Menschen auf die Entsprechung von Zeichen und Zahlen und einigten sich darauf, wie die visuelle Darstellung von Zeichen aussehen sollte. <br><br>  Die erste derartige Vereinbarung wurde durch ASCII-Codierung (American Standard Code for Information Interchange) dargestellt.  Diese Codierung verwendete 7 Bit und konnte 128 Zeichen darstellen, einschlie√ülich des lateinischen Alphabets (Gro√ü- und Kleinbuchstaben), Zahlen und grundlegenden Satzzeichen.  ASCII enthielt auch viele "nicht druckbare" Zeichen, wie z. B. einen Zeilenvorschub, Registerkarten, Zeilenumbr√ºche und andere.  Beispielsweise wird in ASCII der lateinische Buchstabe M (Gro√übuchstabe m) als 77 (4D in hexadezimaler Notation) codiert. <br><br>  Das Problem mit ASCII ist, dass 128 Zeichen zwar ausreichen k√∂nnen, um alle Zeichen darzustellen, die normalerweise mit englischen Texten verwendet werden, diese Anzahl von Zeichen jedoch nicht ausreicht, um Texte in anderen Sprachen und verschiedene Sonderzeichen wie Emojis darzustellen. <br><br>  Die L√∂sung f√ºr dieses Problem war die √úbernahme des Unicode-Standards, der darauf abzielte, jedes in allen modernen und alten Texten verwendete Zeichen darzustellen, einschlie√ülich Zeichen wie Emojis.  Im neuesten Unicode 12.0-Standard sind beispielsweise mehr als 137.000 Zeichen enthalten. <br><br>  Der Unicode-Standard kann unter Verwendung einer Vielzahl von Zeichenkodierungsmethoden implementiert werden.  Am h√§ufigsten sind UTF-8 und UTF-16.  Es ist zu beachten, dass im Webspace der Standard f√ºr die Codierung von Texten UTF-8 am h√§ufigsten verwendet wird. <br><br>  Der UTF-8-Standard verwendet 1 bis 4 Bytes zur Darstellung von Zeichen.  UTF-8 ist eine Obermenge von ASCII, sodass die ersten 128 Zeichen mit den in der ASCII-Codetabelle dargestellten Zeichen √ºbereinstimmen.  Der UTF-16-Standard verwendet dagegen 2 bis 4 Bytes, um 1 Zeichen darzustellen. <br><br>  Warum gibt es beide Standards?  Tatsache ist, dass Texte in westlichen Sprachen normalerweise am effizientesten mit dem UTF-8-Standard codiert werden (da die meisten Zeichen in solchen Texten als Codes mit einer Gr√∂√üe von 1 Byte dargestellt werden k√∂nnen).  Wenn wir √ºber orientalische Sprachen sprechen, k√∂nnen wir sagen, dass Dateien, in denen in diesen Sprachen geschriebene Texte gespeichert sind, bei Verwendung von UTF-16 normalerweise weniger werden. <br><br><h2>  <font color="#3AC1EF">Unicode-Codepunkte und Zeichenkodierung</font> </h2><br>  Jedem Zeichen im Unicode-Standard wird eine Identifikationsnummer zugewiesen, die als Codepunkt bezeichnet wird.  Zum Beispiel ein Codepunkt Emoji <img src="https://habrastorage.org/webt/j9/wk/dp/j9wkdpjar2e6a4ixmkb6oo4upii.png">  ist <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">U + 1F436</a> . <br><br>  Bei der Codierung dieses Symbols kann es als verschiedene Folge von Bytes dargestellt werden: <br><br><ul><li>  UTF-8: 4 Bytes, <code>0xF0 0x9F 0x90 0xB6</code> </li><li>  UTF-16: 4 Bytes, <code>0xD83D 0xDC36</code> </li></ul><br>  Im folgenden JavaScript-Code drucken alle drei Befehle dasselbe Zeichen an die Browserkonsole. <br><br> <code>//         <br> console.log(' <img src="https://habrastorage.org/webt/j9/wk/dp/j9wkdpjar2e6a4ixmkb6oo4upii.png"> ') // =&gt; <img src="https://habrastorage.org/webt/j9/wk/dp/j9wkdpjar2e6a4ixmkb6oo4upii.png"> <br> //     Unicode (ES2015+) <br> console.log('\u{1F436}') // =&gt; <img src="https://habrastorage.org/webt/j9/wk/dp/j9wkdpjar2e6a4ixmkb6oo4upii.png"> <br> //        UTF-16 <br> //      ( 2  ) <br> console.log('\uD83D\uDC36') // =&gt; <img src="https://habrastorage.org/webt/j9/wk/dp/j9wkdpjar2e6a4ixmkb6oo4upii.png"></code> <br><br>  Die internen Mechanismen der meisten JavaScript-Interpreter (einschlie√ülich Node.js und moderner Browser) verwenden UTF-16.  Dies bedeutet, dass das von uns betrachtete Hundesymbol mit zwei UTF-16-Codeeinheiten (jeweils 16 Bit) gespeichert wird.  Daher sollten Ihnen die folgenden Code-Ausgaben nicht unverst√§ndlich erscheinen: <br><br> <code>console.log(' <img src="https://habrastorage.org/webt/j9/wk/dp/j9wkdpjar2e6a4ixmkb6oo4upii.png"> '.length) // =&gt; 2</code> <br> <br><h2>  <font color="#3AC1EF">Zeichenkombination</font> </h2><br>  Zur√ºck zu unserem Ausgangspunkt, lassen Sie uns dar√ºber sprechen, warum die Symbole, die f√ºr eine Person gleich aussehen, eine andere interne Darstellung haben. <br><br>  Einige Unicode-Zeichen dienen zum √Ñndern anderer Zeichen.  Sie werden als Kombinieren von Zeichen bezeichnet.  Sie gelten f√ºr Basiszeichen. Zum Beispiel: <br><br><ul><li> <code>n + Àú = √±</code> </li> <li> <code>u + ¬® = √º</code> </li> <li> <code>e + ¬¥ = √©</code> </li> </ul><br>  Wie Sie aus dem vorherigen Beispiel sehen k√∂nnen, k√∂nnen Sie mit kombinierbaren Zeichen den Basiszeichen diakritische Zeichen hinzuf√ºgen.  Die Zeichenumwandlungsfunktionen von Unicode sind jedoch nicht darauf beschr√§nkt.  Zum Beispiel k√∂nnen einige Zeichenfolgen als Ligaturen dargestellt werden (so kann ae zu √¶ werden). <br><br>  Das Problem ist, dass Sonderzeichen auf verschiedene Arten dargestellt werden k√∂nnen. <br><br>  Beispielsweise kann der Buchstabe √© auf zwei Arten dargestellt werden: <br><br><ul><li>  Verwenden eines einzelnen Codepunkts <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">U + 00E9</a> . </li><li>  Verwenden Sie eine Kombination aus dem Buchstaben e und dem Akutzeichen, dh zwei Codepunkte - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">U + 0065</a> und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">U + 0301</a> . </li></ul><br>  Die Zeichen, die sich aus einer dieser Darstellungsweisen f√ºr den Buchstaben √© ergeben, sehen gleich aus, aber im Vergleich stellt sich heraus, dass die Zeichen unterschiedlich sind.  Die Linien, die sie enthalten, haben unterschiedliche L√§ngen.  Sie k√∂nnen dies √ºberpr√ºfen, indem Sie den folgenden Code in der Browserkonsole ausf√ºhren. <br><br><pre> <code class="plaintext hljs">console.log('\u00e9') // =&gt; √© console.log('\u0065\u0301') // =&gt; √© console.log('\u00e9' == '\u0065\u0301') // =&gt; false console.log('\u00e9'.length) // =&gt; 1 console.log('\u0065\u0301'.length) // =&gt; 2</code> </pre> <br>  Dies kann zu unerwarteten Fehlern f√ºhren.  Sie k√∂nnen beispielsweise dadurch ausgedr√ºckt werden, dass das Programm aus unbekannten Gr√ºnden einige Eintr√§ge in der Datenbank nicht finden kann, indem sich der Benutzer, der das richtige Kennwort eingibt, nicht beim System anmelden kann. <br><br><h2>  <font color="#3AC1EF">Leitungsnormalisierung</font> </h2><br>  Die obigen Probleme haben eine einfache L√∂sung, die darin besteht, die Zeichenfolgen zu normalisieren und sie zur "kanonischen Darstellung" zu bringen. <br><br>  Es gibt vier Standardformen (Algorithmen) der Normalisierung: <br><br><ul><li>  NFC: Normalisierungsform Canonical Composition. </li><li>  NFD: Normalisierungsform Kanonische Zerlegung. </li><li>  NFKC: Kompatibilit√§tszusammensetzung f√ºr Normalisierungsformulare. </li><li>  NFKD: Kompatibilit√§tszerlegung f√ºr Normalisierungsformulare. </li></ul><br>  Die am h√§ufigsten verwendete Form der Normalisierung ist NFC.  Bei Verwendung dieses Algorithmus werden zuerst alle Zeichen zerlegt, wonach alle Kombinationssequenzen in der vom Standard festgelegten Reihenfolge neu zusammengesetzt werden.  F√ºr den praktischen Gebrauch k√∂nnen Sie ein beliebiges Formular ausw√§hlen.  Die Hauptsache ist, es konsequent anzuwenden.  Infolgedessen f√ºhrt der Empfang derselben Daten am Programmeingang immer zu demselben Ergebnis. <br><br>  In JavaScript gibt es ab dem Standard ES2015 (ES6) eine integrierte Methode zum Normalisieren von Zeichenfolgen - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">String.prototype.normalize ([form])</a> .  Sie k√∂nnen es in der Node.js-Umgebung und in fast allen modernen Browsern verwenden.  Das <code>form</code> dieser Methode ist die Zeichenfolgenkennung des Normalisierungsformulars.  Der Standardwert ist das NFC-Formular. <br><br>  Wir kehren zum zuvor betrachteten Beispiel zur√ºck und wenden diesmal die Normalisierung an: <br><br><pre> <code class="plaintext hljs">const str = '\u0065\u0301' console.log(str == '\u00e9') // =&gt; false const normalized = str.normalize('NFC') console.log(normalized == '\u00e9') // =&gt; true console.log(normalized.length) // =&gt; 1</code> </pre> <br><h2>  <font color="#3AC1EF">Zusammenfassung</font> </h2><br>  Wenn Sie eine Webanwendung entwickeln und das verwenden, was der Benutzer eingibt, normalisieren Sie immer die empfangenen Textdaten.  In JavaScript k√∂nnen Sie die Standardzeichenfolgenmethode <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">normalize () verwenden</a> , um die Normalisierung durchzuf√ºhren. <br><br>  <b>Liebe Leser!</b>  Haben Sie Probleme mit Zeichenfolgen festgestellt, die mit der Normalisierung gel√∂st werden k√∂nnen? <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de445274/">https://habr.com/ru/post/de445274/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de445264/index.html">Preload, Prefetch und andere Tags</a></li>
<li><a href="../de445266/index.html">GeekBrains wird zusammen mit Rostelecom den IoT Hackathon durchf√ºhren</a></li>
<li><a href="../de445268/index.html">GraphQL-Details: Was, wie und warum</a></li>
<li><a href="../de445270/index.html">[Lesezeichen] Bash f√ºr Anf√§nger: 21 n√ºtzlicher Befehl</a></li>
<li><a href="../de445272/index.html">JavaScript ist die beste Programmiersprache f√ºr Anf√§nger. So ist es oder nicht?</a></li>
<li><a href="../de445276/index.html">Vollst√§ndiges UseEffect-Handbuch</a></li>
<li><a href="../de445278/index.html">So erstellen Sie ein Spiel, wenn Sie noch nie K√ºnstler sind</a></li>
<li><a href="../de445280/index.html">Rentabilit√§t von Websites und Dienstleistungen</a></li>
<li><a href="../de445284/index.html">ClickHouse Product Analytics VKontakte</a></li>
<li><a href="../de445286/index.html">Fu√üst√ºtze f√ºr das Gehirn: Hedera Hashgraph Distributed Registry Platform</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>