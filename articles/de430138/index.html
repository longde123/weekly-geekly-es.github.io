<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🚳 🏘️ 🔰 Optimierung eines Handelsroboters: ein genetischer Algorithmus 🎯 🌖 ⛱️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In einem früheren Artikel habe ich begonnen, Methoden zur parametrischen Optimierung zu vergleichen, d. H. Parameter auszuwählen und die Rentabilität ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Optimierung eines Handelsroboters: ein genetischer Algorithmus</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/430138/"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/webt/bz/_0/v9/bz_0v9pphiv-9bi1gtg5b65riy8.png"></a> <br><br>  In einem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">früheren Artikel habe</a> ich begonnen, Methoden zur parametrischen Optimierung zu vergleichen, d. H. Parameter auszuwählen und die Rentabilität des Handels mit einem Roboter während des nachfolgenden <abbr title="Handelsrobotertest für historische Daten">Backtests zu</abbr> bewerten.  Es stellte sich heraus, dass die banale Monte-Carlo-Methode - die Erzeugung zufälliger unkorrelierter Kombinationen von Roboterparametern - recht gut funktioniert.  Jetzt möchte ich einen beliebten Algorithmus testen, einschließlich eines in der Community der Programmierhändler: den <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">genetischen Optimierungsalgorithmus</a> . <br><a name="habracut"></a><br><h1>  Genetischer Algorithmus zur Optimierung einer Handelsstrategie </h1><br>  Wir werden diesen Algorithmus als Beispiel für die Optimierung von 2 Parametern betrachten.  Die optimierten Parameter unseres Roboters sind die Periode des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">gleitenden Durchschnitts</a> und <abbr title="Gewinnziel einer einzelnen Robotertransaktion">TakeProfit</abbr> .  Lassen Sie uns für ein besseres Eintauchen in die „Genetik“ vereinbaren, die Periode des gleitenden Durchschnitts das für „Wachstum“ verantwortliche Gen und TakeProfit - das Gen für „Augenfarbe“ - zu nennen. <br><br>  Im Raum der zulässigen Parameterwerte beschreibt jeder Punkt, jedes Koordinatenpaar - "Höhe / Augenfarbe" - theoretisch ein "Individuum".  Angenommen, wir haben zufällig 10 Personen erstellt.  Dies war der <b>erste Schritt des</b> genetischen Optimierungsalgorithmus - um die erste Generation zu erstellen: <br><br><img src="https://habrastorage.org/webt/wo/mx/1s/womx1s6e3gde2yk04asr9rzaqzs.png"><br><br>  Im Koordinatenraum M - T werden Punkte zufällig ausgewählt.  Zum Beispiel sind zwei mit einem roten Rahmen markierte Punkte „Individuen“ mit geschlechtsneutralen Namen (dies ist ein wichtiger Punkt!) Zhenya und Sasha.  Sashas "Wachstum" (in der anfänglichen Formulierung des Problems ist der Zeitraum des gleitenden Durchschnitts) beträgt 11 Einheiten, "Augenfarbe" ist 0,6 (grün-blaue Augen).  Zhenya unterscheidet sich geringfügig in den Parametern.  Die gleichen Merkmale beschreiben die 8 verbleibenden Personen. <br><br><h2>  <font color="3030cc">Der zweite Schritt ist die Reproduktion</font> </h2><br>  Aus der gesamten ersten Generation bestimmen wir eine bestimmte Anzahl der „erfolgreichsten“ Personen.  Das Kriterium ist offensichtlich der Wert von <abbr title="Zielfunktion (Gewinn)">CF.</abbr>  Diese Individuen züchten zufällig gebildete Paare (aus diesem Grund erhielten sie geschlechtsneutrale Namen).  Im Allgemeinen kann eine Reihe von Regeln für übereinstimmende Paare festgelegt werden.  Zum Beispiel, um Individuen auszuwählen, deren Eigenschaften den Individuen nahe kommen (d. H. Im Koordinatenraum buchstäblich am nächsten liegen) - Inzucht.  Sie können im Gegenteil nach Gegensätzen suchen (Auszucht).  Ich konnte keine Argumente für eine dieser Optionen finden - in meiner Implementierung werden die Paare rein zufällig gebildet ... Zum Beispiel haben Zhenya und Sasha die Qualifikation bestanden und beschlossen, einen Nachkommen zur Welt zu bringen.  Was bedeutet das in unserem Kontext: <br><br><img src="https://habrastorage.org/webt/mv/ad/i9/mvadi9zl8mv_gfhtnhsadcyul20.png"><br><br>  Von zwei "elterlichen" Individuen erhalten wir das dritte Individuum, das einen Teil der Merkmale eines Elternteils, einen Teil des anderen, erbt.  Zum Beispiel haben Zhenya und Sasha einen einzelnen Nikita geboren (Nikita, Nikita?): <br><br><ul><li>  Nikita erbte das Zeichen „Augenfarbe“ (TakeProfit-Parameter des Roboters) von einem seiner Eltern - „Zhenya“, </li><li>  "Wachstum" (die Periode des Roboters mit gleitendem Durchschnitt) Nikita erbte von "Sasha" ... aber leicht angepasst in Richtung eines anderen Elternteils, Zhenya. </li></ul><br>  Tatsache ist, dass die Nachkommen umso „näher“ sind, je kleiner die Dimension des Optimierungsraums ist (in unserem Fall gleich 2).  Der genetische Optimierungsalgorithmus legt die Regeln für die „Vererbung“ von Genen für eine Tochter nicht streng fest.  Daher lieh sich Nikita zufällig die Farbe seiner Augen ohne Änderungen aus, aber es stellte sich heraus, dass er sich in der Mitte zwischen beiden Elternteilen befand, näher an einem von ihnen.  In meiner Implementierung konnte Nikita mit dem gleichen Erfolg die ursprünglichen Parameter von beiden Elternteilen ausleihen. <br><br><h2>  <font color="3030cc">Der dritte Schritt ist die Zucht</font> </h2><br>  Beweger des Evolutionsprozesses, natürliche Auslese.  4 der 10 besten Personen gaben 10 weitere Nachkommen.  Jetzt haben wir 20 Personen.  Der genetische Optimierungsalgorithmus beinhaltet die Aufrechterhaltung einer konstanten Populationsgröße.  10 Personen müssen „sterben“.  Bei dieser Implementierung „sterben“ die meisten Personen der ersten Generation von 80% bis 100%. <br>  Dementsprechend wird in unserem Beispiel die neue Generation aus 0 ... 2 Eltern und 8 - 10 ihrer Nachkommen bestehen.  Mit anderen Worten, wenn Sie den Text weglassen, werden die neuen Vektoren der Parameter des Handelsroboters aus den Vektoren berechnet, die im vorherigen Schritt "Ausbreitung" (Kombination) der 4 besten besten Tests erhalten wurden.  Die meisten „alten Leute“ akzeptieren keine Teilnahme an der neuen Iteration der Auswahl (andere Optionen zur Implementierung der Auswahl sind möglich). <br><br><h2>  <font color="3030cc">Vervollständigung des Algorithmus</font> </h2><br>  Reproduktion und Auswahl werden N-mal wiederholt.  In unserem Beispiel werden zum Vergleich mit drei zuvor getesteten Algorithmen 4 Generationen von 10 Personen getestet, insgesamt 40 Tests. <br>  Es kann jedoch vorkommen, dass eine andere Bevölkerung zusammenbricht.  Mit anderen Worten, alle Tests befinden sich in der Nähe mehrerer Punkte.  Um diese Situation zu vermeiden, werden verschiedene Mechanismen verwendet, insbesondere: <br><br><ul><li>  Infusion von „frischem Blut“ in die Bevölkerung.  Zu den Nachkommen der gegenwärtigen Bevölkerung kommen mehrere neue Individuen hinzu, die zufällig erhalten wurden, genauso wie die ursprüngliche Bevölkerung gebildet wurde. </li><li>  Mutationsmechanismus: Ein Nachwuchs kann einige der Merkmale (Koordinaten) aufweisen, die sich geringfügig von den Merkmalen seiner Eltern unterscheiden: </li></ul><br><img src="https://habrastorage.org/webt/zq/me/o7/zqmeo7nqe2qijovrbmhzf7idh14.png"><br><br>  in diesem Beispiel <br><br><ul><li>  Die Eigenschaften der Nachkommen Jane und Joss - "Wachstum" und "Augenfarbe" - sind von jedem Elternteil entlehnt. </li><li>  Die Merkmale der Nachkommen von Sam und Siri unterscheiden sich etwas von den entsprechenden Merkmalen beider Eltern. </li></ul><br>  In meiner Implementierung musste die Bevölkerung trotz Mutationen und „frischen Individuen“ regelmäßig aktualisiert werden, um eine vorzeitige Konvergenz und Lokalisierung der gesamten Bevölkerung auf engstem Raum zu vermeiden. <br><br>  Wenn wir zu den ursprünglichen Daten zurückkehren, an denen wir die Monte-Carlo-Algorithmen, den Gradientenabstieg und den Algorithmus mit dem Arbeitsnamen „Seeschlacht“ getestet haben, kann der Optimierungsprozess durch die folgende Animation veranschaulicht werden: <br><br><img src="https://habrastorage.org/webt/2a/bn/y_/2abny__yrjhqoscv1jzbircputc.gif"><br><br>  Wie Sie der Animation entnehmen können, ist die Anordnung der Punkte zunächst chaotisch, tendiert jedoch bei nachfolgenden Generationen zu Bereichen mit höheren DF-Werten. <br><br>  Vergleichen Sie nun die Algorithmen auf derselben Oberfläche: <abbr title="Gewinn">P</abbr> = f ( <abbr title="gleitender Durchschnitt">M</abbr> , <abbr title="TakeProfit, Zielgewinn aus dem Geschäft">T</abbr> ): <br><br><img src="https://habrastorage.org/webt/hc/pm/v8/hcpmv86zitukibrq2urge2errz4.png"><br><br><table><tbody><tr><th>  Monte Carlo </th><th>  Gefälle Abstieg </th><th>  "Seeschlacht" </th><th>  <font color="3030cc">genetischer Algorithmus</font> </th></tr><tr><td>  95,7% </td><td>  92,1% </td><td>  97,0% </td><td>  <font color="3030cc">96,8%</font> </td></tr></tbody></table><br>  Der Durchschnittswert des gefundenen Extremums der CF als Prozentsatz des globalen Werts. <br><br>  Natürlich ist es zu früh, um anhand eines Satzes von Eingabedaten zu beurteilen, aber bisher ist die GA in Bezug auf unseren Handelsroboter dem Algorithmus „Seeschlacht“ unterlegen: <br><br><ul><li>  ganz unbedeutend - nach dem Durchschnitt des gefundenen quasi-optimalen Wertes der CF, </li><li>  liefert die schlechteste Schätzung der parametrischen Stabilität des Handelsalgorithmus, da er die Umgebung der quasi-optimalen Parametertupel, die zu wenig detailliert gefunden wurden, nicht „untersucht“. </li></ul><br><h1>  Abschließender Test von 4 Optimierungsalgorithmen </h1><br>  Der abschließende Test wurde an 4 Sätzen von Eingabedaten durchgeführt - den Ergebnissen des Backtests der Handelsstrategie für 4 verschiedene Segmente der Preisentwicklung ( <abbr title="Euro zu US-Dollar">EURUSD</abbr> : 2016, EURUSD: 2017, <abbr title="Feinunze Gold pro US-Dollar">XAUUSD</abbr> : 2016, XAUUSD: 2017). <br><br><img src="https://habrastorage.org/webt/ko/in/wg/koinwgtirx7wsytk8ilu5ferro0.gif"><br><br>  (Beispiele für digitale Filter als Funktionen von <b>zwei</b> Parametern für 4 Zeitreihen von Preisen) <br><br>  Diesmal wurde die Optimierung anhand von 3 Parametern durchgeführt: <br><br><ol><li>  Zeitraum des „schnellen“ gleitenden Durchschnitts </li><li>  Zeitraum des „langsamen“ gleitenden Durchschnitts </li><li>  TakeProfit (Gewinn aus der Transaktion in Prozent, nach Erreichen der Transaktion). </li></ol><br>  Jeder der Parameter nahm 20 verschiedene Werte an.  Insgesamt, um die Tabelle zu erstellen <br>  P = F (Mf, Ms, T) <br>  wobei P der Gewinn ist, Mf die Periode des "schnellen" gleitenden Durchschnitts ist, Ms die Periode des "langsamen" gleitenden Durchschnitts ist, T TakeProfit ist, <br>  20 * 20 * 20 = 8.000 Testiterationen wurden durchgeführt. <br><br>  Die Optimierung wurde mit einer Einschränkung von 160, 400 und 800 Tests durchgeführt (DF-Berechnungen in ausgewählten Koordinaten).  Jedes Mal wurden die Ergebnisse für 1.000 Optimierungsiterationen gemittelt.  Der durchschnittliche DF-Wert für den gefundenen quasi-optimalen Parametervektor war: <br><table><tbody><tr><th>  Monte Carlo </th><th>  Gefälle Abstieg </th><th>  "Seeschlacht" </th><th>  genetischer Algorithmus </th></tr><tr><td>  84,1% </td><td>  83,9% </td><td>  77,0% </td><td>  92,6% </td></tr></tbody></table><br>  Unabhängig davon ist anzumerken, dass GA auch bei einem kleinen Prozentsatz der Tests der insgesamt möglichen Anzahl von Optionen ein gutes Ergebnis zeigt: <br><table><tbody><tr><th>  Tests </th><th>  Monte Carlo </th><th>  Gefälle Abstieg </th><th>  "Seeschlacht" </th><th>  genetischer Algorithmus </th></tr><tr><td>  160 von 8.000 </td><td>  79,1% </td><td>  76,7% </td><td>  73,1% </td><td>  87,7% </td></tr><tr><td>  400 von 8.000 </td><td>  84,7% </td><td>  85,0% </td><td>  77,4% </td><td>  93,7% </td></tr><tr><td>  800 von 8.000 </td><td>  88,6% </td><td>  90,1% </td><td>  80,4% </td><td>  96,3% </td></tr></tbody></table><br><h1>  Anstelle einer Schlussfolgerung </h1><br>  Ich war etwas überrascht von dem Ergebnis, das einen genetischen Optimierungsalgorithmus zeigte.  Ich glaube nicht, dass ihm das „genetische Paradigma“ der Methode den ersten Platz in der Liste verschafft hat.  In gewisser Weise ähnelte es gemäß der Logik der Wahl der Koordinaten den Methoden der Dichotomie / des Goldenen Schnitts.  Es lohnt sich wahrscheinlich, einen dieser Algorithmen auszuprobieren und die GA damit zu vergleichen. <br><br>  Zurück zum Handelsroboter: Es ist erwähnenswert, wie sich das durch das CF (Gewinn) gebildete „Relief“ der Oberfläche von Jahr zu Jahr ändert.  Das heißt, nachdem der Roboter in der Geschichte von 2017 „optimiert“ wurde, ist <b>es nicht sinnvoll, diese Einstellungen im Jahr 2018</b> (erstes Quartal, Monat, Woche ... 2018) <b>anzuwenden</b> . <br><br>  Künstliche, dogmatische und hilflose Handelsstrategien wie unsere (Kauf an der Schnittstelle des gleitenden Durchschnitts) werden wahrscheinlich nicht bald aus der Mode kommen.  Leider hatte ich keine anderen Strategien.  Dementsprechend schreibe ich den Gewinn oder Verlust von Handelsrobotern eher dem Glück als den Vor- / Nachteilen des Algorithmus zu.  Daher ist die Aufgabe der parametrischen Optimierung eines Handelsroboters für mich persönlich ausschließlich von akademischem Interesse. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de430138/">https://habr.com/ru/post/de430138/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de430126/index.html">Eine weitere Liste von Projekten zum Üben</a></li>
<li><a href="../de430128/index.html">Entwicklung durch Testen: Verbesserung der Fähigkeiten</a></li>
<li><a href="../de430132/index.html">Was wir in den letzten Jahren über die Sicherheit von Intel ME gelernt haben: 7 Fakten über das mysteriöse Subsystem</a></li>
<li><a href="../de430134/index.html">Algorithmen zur Optimierung eines Handelsroboters: eine effektive Möglichkeit, eine Million rückwirkend zu handeln</a></li>
<li><a href="../de430136/index.html">Wie sie Starlink - Satelliten-Internet von Ilona Mask starten</a></li>
<li><a href="../de430140/index.html">Fünf Gründe für das Scheitern von SEO. Analyse erfolgloser Werbeerfahrungen anhand von Beispielen</a></li>
<li><a href="../de430142/index.html">Ist dein Windows so alt?</a></li>
<li><a href="../de430144/index.html">Wir simulieren einen realistischen Fluss in Houdini und Unreal Engine 4</a></li>
<li><a href="../de430146/index.html">Mathe in Gamedev ist einfach. Vektoren und Integrale</a></li>
<li><a href="../de430148/index.html">Verlust personenbezogener Daten aus Moskauer MFCs</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>