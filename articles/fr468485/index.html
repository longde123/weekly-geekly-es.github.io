<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧔🏼 👰🏿 🐄 Lorsque vous voulez une belle interface graphique, mais le GPU n'est pas 🤖 🔯 🔅</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="En règle générale, les utilitaires de travail ne nécessitent pas une interface utilisateur saine, avec des boutons, des listes, des fenêtres, la prise...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Lorsque vous voulez une belle interface graphique, mais le GPU n'est pas</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/468485/">  En règle générale, les utilitaires de travail ne nécessitent pas une interface utilisateur saine, avec des boutons, des listes, des fenêtres, la prise en charge de la souris et d'autres petites choses, la plupart des listes de souhaits peuvent être regroupées dans des scripts et parfois les exécuter avec le paramètre --help, et cela sera encore plus correct du point de vue de la configuration et mise à l'échelle.  Tout empire lorsque non seulement l'équipe de développement, mais aussi des tiers commencent à utiliser les outils.  Et ils ne sont pas toujours prêts à se plonger dans les pensées harmonieuses énoncées dans les lignes de code.  Et puis vous devez faire toute une histoire avec l'interface utilisateur, et les développeurs l'obtiennent généralement simple, carré, fonctionnel et complètement ennuyeux.  Il y a quelque temps, je travaillais sur un petit système de contrôle de ventilation / chauffage / caméra et aussi «ce que l'oncle dans un casque jaune va trouver» pour un parking souterrain. <br><br><div style="text-align:center;"><img width="600" src="https://habrastorage.org/webt/la/mh/qc/lamhqcsmhwd6aqcypqlumod45ry.png"></div><br><a name="habracut"></a><br>  (Voici une image du système d'interface utilisateur, mais le développeur a demandé de la supprimer. Si vous ne voulez pas lire les promenades sur le champ de râteau, puis des liens vers le github à la fin de l'article) <br><br>  Le système a été construit sur le SoC chinois non nominatif, pour lequel le fabricant a décidé de porter le cadre SDL de la première version.  Les outils et scripts internes ont été finalisés à un point tel qu'ils se sont transformés en une mise en page lourde et «belle» avec des onglets, des listes, des popups, des ombres, un dégradé, la transparence et d'autres goodies. <br><br>  Pour réaliser toutes les beautés, nanogui a été choisie, simple et sans prétention, et en même temps «puissante» tout ce qu'il fallait.  C'était exactement sur papier, mais les <s>ravins ont</s> oublié OpenGL.  Les systèmes de contrôle d'interface utilisateur presque complètement implémentés ont commencé à fonctionner sur le matériel, et là un écran noir, toutes les initialisations OpenGL3 se passent sans erreurs, les tampons sont définis et les shaders sont compilés, mais pas ... d'écran noir, sous quel angle ne pas regarder. <br><br>  Au début, ils ont péché sur mes mains tordues, puis sur les mains du développeur Antokha responsable du pilote et du matériel, puis ils ont lancé un exemple de test de rendu triangulaire à partir du SDC SoC, et encore l'écran noir, la documentation et les exemples sont généralement lus en dernier. <br><br>  Mon collègue et moi avons pensé que quelque chose n'allait pas et nous sommes d'abord rendus sur le forum chinois, et n'ayant pas encore trouvé de réponses claires pour le développeur, la réponse était décevante, il n'y avait pas d'implémentation opengl, et très probablement pas, car la ligne était interrompue. <br>  - Mais qu'en est-il du cadre SDL?  - nous avons demandé <br>  - Nous attirons pixel par pixel dans la mémoire vidéo.  - Nos amis chinois nous ont répondu. <br><br>  Ce jour-là, j'ai vu les yeux tristes d'un programmeur qui calcule la quantité de LoC qu'il enverra à / dev / null.  Mais lancer une solution prête à l'emploi a été très décevant <s>(sur Internet, il y a tout),</s> il s'avère que vous pouvez vivre sans OpenGL dans nanogui sur un logiciel de rendu. <br><br>  Seule la vie se révèle très lentement, sur un grand PC quelques secondes par image, dans le miracle de l'ingénierie chinoise, il faut déjà environ 20-25 secondes pour dessiner.  Ensuite, ils ont décidé de ne pas rendre l'intégralité de l'interface utilisateur à la fois, mais uniquement les parties nécessaires (modifiées) des widgets, mais même dans ce mode, avec tous les hacks et optimisations, cela a pris plus de 10 secondes par image, non viable ... <br><br>  Après avoir fumé quelques exemples de SDK, nous avons découvert que la copie de textures prêtes à l'emploi dans la mémoire vidéo est "instantanée" (par rapport à 10 secondes bien sûr), et cela prend environ 1 ms à 512 x 512 sans transparence et 2 ms pour la même chose avec transparence, si vous copiez plusieurs de ces textures l'une après l'autre, puis le temps augmente de façon non linéaire catastrophique, cela s'est avéré être dû à la quantité limitée de tampon de mémoire vidéo, dont le débordement a conduit à vider le tampon et à rendre ce qui était à l'écran (pas le mien, il était déjà là), c'est-à-dire  pour une interface pas tout à fait morte, nous ne pouvons pas copier plus de 50-100 textures par image et pas immédiatement, mais seulement après avoir attendu que le pilote vidéo collecte les données du tampon. <br><br>  L'itération suivante a été le rendu du widget dans sa propre texture dans le flux, et au moment où la texture a été créée, le widget était dessiné à peu près de la même manière que le résultat final, uniquement de manière carrée, pour dessiner toutes sortes de lignes, les formes pouvaient être immédiatement dans la mémoire vidéo gratuitement. <br><br>  Vaincre presque le miracle de la pensée chinoise «sans» un GPU, vous ne pouvez toujours pas appeler les 20 FPS un résultat décent, et après avoir presque terminé le projet, j'ai demandé au client la permission de reprendre une partie de l'expérience en open source.  Le premier SDL n'est plus très à la mode maintenant, il a donc été décidé d'utiliser le rendu nanogui en mode logiciel sur SDL2 et de le mettre sur le github.  Peut-être que quelqu'un aura besoin :) <br><br>  Après avoir lu l'article jusqu'au bout,% habruiser% a le droit de se demander pourquoi il était nécessaire de bloquer ce tas de code <br>  pour les coins arrondis et les ombres?  Premièrement, c'est beau (s), deuxièmement, «cet oncle dans un casque jaune» a déjà payé pour le développement du système et les coins arrondis là-bas, malheureusement (ou heureusement) ont fini dans la liste des tâches, il reste à les faire avec un dégradé et à ajouter des ombres. <br><br>  C'était l'été original de 2017 sous le soleil de Sotchi. <br><br>  <b>Voici comment OpenGL rend</b> <br><br><div style="text-align:center;"><img width="600" src="https://habrastorage.org/webt/07/fn/gp/07fngpg0alfxkwm_uyaasgepssa.png"></div><br><br>  <b>Voici comment le logiciel s'affiche sur un PC</b> <br><br><div style="text-align:center;"><img width="600" src="https://habrastorage.org/webt/ni/sg/a2/nisga2_fzvja7pmnfci5qja-xqk.png"></div><br><br>  <b>Références</b> : <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Original wjakob / nanogui</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Rendu logiciel NanoVG</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Rendu logiciel NanoGUI + SDL +</a> <br><br>  PS Ne croyez pas que les développeurs <s>chinois</s> parlent de la présence d'OpenGL dans le système, vérifiez les performances de tous les composants, pour savoir comment :) </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr468485/">https://habr.com/ru/post/fr468485/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr468463/index.html">Amélioration des performances de Zabbix + PostgreSQL avec le partitionnement et l'indexation</a></li>
<li><a href="../fr468465/index.html">Le point de vue d'un avocat: comment les sociétés informatiques peuvent-elles résilier un contrat avec un client gouvernemental toxique</a></li>
<li><a href="../fr468471/index.html">Présentation d'AngularConnect 2019. Partie 1</a></li>
<li><a href="../fr468479/index.html">«Les gens pensent que la gratuité ne vaut rien. Il m'a semblé que je pouvais les convaincre »- Yuri Yartsev à propos de l'école Russol</a></li>
<li><a href="../fr468481/index.html">Comment S7 a été le premier en Russie à vendre des billets d'avion en ligne</a></li>
<li><a href="../fr468487/index.html">Que peut-il arriver (vecteurs d'attaque typiques)</a></li>
<li><a href="../fr468489/index.html">Contrebande de requêtes HTTP - nouvelles approches</a></li>
<li><a href="../fr468491/index.html">Malédiction karmique d'Habra</a></li>
<li><a href="../fr468493/index.html">La structure de la vue aérienne du projet Data Science</a></li>
<li><a href="../fr468497/index.html">Minuterie de brossage minutée de 3 minutes</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>