<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏻‍🤝‍👨🏾 📴 ☝🏻 Wir kündigen die Unterstützung für ECMAScript-Module in Node.js an 🧑🏿‍🤝‍🧑🏾 ☀️ 👛</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Node.js 13.2.0 bietet ECMAScript- Unterstützung für Module, die für ihre Import- und Exportsyntax bekannt sind. Bisher stand diese Funktionalität hint...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Wir kündigen die Unterstützung für ECMAScript-Module in Node.js an</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/477168/"><p> Node.js 13.2.0 bietet <a href="https://hacks.mozilla.org/2018/03/es-modules-a-cartoon-deep-dive/" rel="nofollow">ECMAScript-</a> Unterstützung für <a href="https://hacks.mozilla.org/2018/03/es-modules-a-cartoon-deep-dive/" rel="nofollow">Module,</a> die für ihre Import- und Exportsyntax bekannt sind.  Bisher stand diese Funktionalität hinter dem <code>--experimental-modules</code> , das nicht mehr benötigt wird.  Die Implementierung ist jedoch noch experimentell und kann sich ändern. </p><br><p>  <em>Von einem Übersetzer: Mit dieser lang erwarteten Funktion können wir endlich die standardmäßige modulare Syntax verwenden, die bereits in modernen Browsern und jetzt auch in Node.js ohne Flags und Transpiler verfügbar ist</em> </p><a name="habracut"></a><br><h2 id="aktivaciya">  Aktivierung </h2><br><p>  Node.js verarbeitet den Code in den folgenden Fällen als ES-Module: </p><br><ul><li>  Dateien mit der Erweiterung <code>.mjs</code> </li><li>  Dateien mit der Erweiterung <code>.js</code> oder ohne die Erweiterung überhaupt, vorausgesetzt, die nächstgelegene übergeordnete <code>package.json</code> enthält den Wert <code>"type": "module"</code> </li><li>  Code, der zusammen mit dem Flag <code>—-input-type=module</code> über das Argument <code>—-eval</code> oder STDIN übergeben wurde </li></ul><br><p>  In allen anderen Fällen wird der Code als CommonJS betrachtet.  Dies gilt für <code>.js</code> Dateien ohne <code>"type": "module"</code> in der nächsten <code>package.json</code> und für den Code, der über die Befehlszeile ohne Angabe von <code>--input-type</code> .  Dies geschieht, um die Abwärtskompatibilität zu gewährleisten.  Da wir jetzt zwei Arten von Modulen haben, CommonJS und ES, ist es besser, den Modultyp explizit anzugeben. </p><br><p>  Sie können Ihren Code mit den folgenden Funktionen explizit als CommonJS kennzeichnen: </p><br><ul><li>  Dateien mit der Erweiterung <code>.cjs</code> </li><li>  Dateien mit der Erweiterung <code>.js</code> oder überhaupt ohne Erweiterung, vorausgesetzt, das nächste übergeordnete <code>package.json</code> enthält den Wert <code>"type": "“commonjs”"</code> </li><li>  Code, der über das Argument <code>--eval</code> oder STDIN mit dem expliziten Flag <code>--input-type=commonjs</code> </li></ul><br><p>  Weitere <a href="https://nodejs.org/api/esm.html" rel="nofollow"><code>  --input-type</code></a> diesen Funktionen finden Sie in den Dokumentationsabschnitten <a href="https://nodejs.org/api/esm.html" rel="nofollow">"</a> <a href="https://nodejs.org/api/esm.html" rel="nofollow"><code>  --input-type</code></a> und <a href="https://nodejs.org/api/esm.html" rel="nofollow"><code>  --input-type</code></a> <a href="https://nodejs.org/api/esm.html" rel="nofollow">"</a> und unter <a href="https://nodejs.org/api/esm.html" rel="nofollow"><code>  --input-type</code></a> </p><br><h2 id="sintaksis-import-i-export">  Import und Export von Syntax </h2><br><p>  Im Kontext des ES-Moduls können Sie den <code>import</code> und auf andere Javascript-Dateien verweisen.  Sie können in einem der folgenden Formate angegeben werden: </p><br><ul><li>  Relative URL: <code>"./file.mjs"</code> </li><li>  Absolute URL c- <code>file://</code> , z. B. <code>"file:///opt/app/file.mjs"</code> </li><li>  <code>"es-module-package"</code> : <code>"es-module-package"</code> </li><li>  Der Pfad zu der Datei im Paket: <code>"es-module-package/lib/file.mjs"</code> </li></ul><br><p>  Bei Importen können Sie Standardwerte ( <code>import _ from "es-module-package"</code> <code>import { shuffle } from "es-module-package"</code> ) und benannte Werte ( <code>import { shuffle } from "es-module-package"</code> importieren) sowie alles als einen Namespace <code>import * as fs from "fs"</code> ( <code>import * as fs from "fs"</code> ).  Alle integrierten Node.js-Pakete, wie z. B. <code>fs</code> oder <code>path</code> , unterstützen alle drei Arten von Importen. </p><br><p>  Importe, die auf CommonJS-Code verweisen ( <a href="https://nodejs.org/api/modules.html" rel="nofollow"><code>module.exports</code></a> alle aktuellen JavaScript- <a href="https://nodejs.org/api/modules.html" rel="nofollow"><code>module.exports</code></a> die für Node.js <a href="https://nodejs.org/api/modules.html" rel="nofollow"><code> require</code> und <code>module.exports</code></a> ), können nur die Standardoption verwenden ( <code>import _ from "commonjs-package"</code> ). </p><br><p>  Das Importieren anderer Dateiformate wie JSON und WASM bleibt experimentell und erfordert die Flags <a href="https://nodejs.org/api/esm.html" rel="nofollow"><code>--experimental-json-modules</code></a> und <a href="https://nodejs.org/api/esm.html" rel="nofollow"><code>--experimental-wasm-modules</code></a> .  Sie können diese Dateien jedoch mithilfe der <a href="https://nodejs.org/api/modules.html" rel="nofollow"><code>module.createRequire</code></a> API herunterladen, die ohne zusätzliche Flags verfügbar ist. </p><br><p>  In Ihren ES-Modulen können Sie das Schlüsselwort export verwenden, um Standardwerte und benannte Werte zu exportieren. </p><br><p>  Dynamische Ausdrücke mit <code>import()</code> können zum Laden von ES-Modulen aus CommonJS- oder ES-Code verwendet werden.  Beachten Sie, dass <code>import()</code> kein Modul zurückgibt, sondern dessen Versprechen (Promise). </p><br><p>  <a href="https://nodejs.org/api/esm.html" rel="nofollow"><code>import.meta.url</code></a> ist <a href="https://nodejs.org/api/esm.html" rel="nofollow"><code>import.meta.url</code></a> in den Modulen verfügbar, die die absolute URL des aktuellen ES-Moduls enthalten. </p><br><h2 id="fayly-i-novoe-pole-type-v-packagejson">  Dateien und das neue Feld "Typ" in package.json </h2><br><p>  Fügen Sie <code>"type": "module"</code> zur package.json Ihres Projekts hinzu, und Node.js beginnt, alle <code>.js</code> Dateien Ihres Projekts als ES-Module zu erkennen. </p><br><p>  Wenn einige Dateien Ihres Projekts weiterhin CommonJS verwenden und Sie nicht das gesamte Projekt auf einmal migrieren können, können Sie entweder die Erweiterung <code>.cjs</code> für diesen Code verwenden oder sie in ein separates Verzeichnis stellen und <code>package.json</code> mit dem <code>{ "type": "commonjs" }</code> hinzufügen <code>{ "type": "commonjs" }</code> , was Node.js mitteilt, dass es als CommonJS behandelt werden soll. </p><br><p>  Für jede heruntergeladene Datei <code>package.json</code> Node.js <code>package.json</code> in dem Verzeichnis, in dem es sich befindet, und dann eine Ebene <code>package.json</code> usw., bis es das Stammverzeichnis erreicht.  Dieser Mechanismus ähnelt der Arbeitsweise von <a href="https://babeljs.io/docs/en/config-files" rel="nofollow"><code> Babel  .babelrc</code> Dateien</a> .  Dieser Ansatz ermöglicht es Node.js, <code>package.json</code> als Quelle für verschiedene Metadaten zum Paket und zur Konfiguration zu verwenden, ähnlich wie es bereits in Babel und anderen Tools funktioniert. </p><br><p>  Wir empfehlen allen <code>commonjs</code> , ein <code>commonjs</code> anzugeben, auch wenn dort <code>commonjs</code> geschrieben <code>commonjs</code> . </p><br><h2 id="vhodnye-tochki-paketa-i-pole-exports-v-packagejson">  Die Paketeintrittspunkte und das Feld "Exporte" in package.json </h2><br><p>  Jetzt haben wir zwei Felder, um den <a href="https://nodejs.org/api/esm.html" rel="nofollow">Einstiegspunkt</a> in das Paket festzulegen: <code>main</code> und <a href="https://nodejs.org/api/esm.html" rel="nofollow"><code>exports</code></a> .  Das Hauptfeld wird von allen Versionen von Node.js unterstützt, seine Funktionen sind jedoch begrenzt: Damit können Sie nur einen Haupteinstiegspunkt im Paket definieren.  Im neuen <code>exports</code> können Sie auch den Haupteinstiegspunkt sowie zusätzliche Pfade definieren.  Dies bietet eine zusätzliche Kapselung für Pakete, bei denen nur die expliziten <code>exports</code> für den Import von außerhalb des Pakets verfügbar sind.  <code>exports</code> gelten für beide Modultypen, CommonJS und ES, unabhängig davon, ob sie über <code>require</code> oder <code>import</code> . </p><br><p>  Mit dieser Funktionalität können Importe vom Typ <code>pkg/feature</code> <code>./node_modules/pkg/esm/feature.js</code> auf einen realen Pfad wie <code>./node_modules/pkg/esm/feature.js</code> .  Außerdem gibt Node.js einen Fehler aus, wenn der Import auf <code>pkg/esm/feature.js</code> verweist, das in den <code>exports</code> nicht angegeben ist. </p><br><p>  Ein zusätzlicher, noch experimenteller, funktionsbedingter <a href="https://nodejs.org/api/esm.html" rel="nofollow">Export</a> bietet die Möglichkeit, verschiedene Dateien für verschiedene Umgebungen zu exportieren.  Auf diese Weise kann das Paket CommonJS-Code für den Aufruf von <code>require("pkg")</code> und den ES-Modulcode für den Import durch <code>import "pkg"</code> , obwohl das Schreiben eines solchen Pakets nicht ohne <a href="https://nodejs.org/api/esm.html" rel="nofollow">weitere Probleme ist</a> .  Sie können bedingte Exporte mit dem <code>—-experimental-conditional-exports</code> . </p><br><h2 id="osnovnye-grabli-novyh-moduley">  Das Hauptkriterium der neuen Module </h2><br><h3 id="obyazatelnoe-ukazanie-rasshireniy-faylov">  Erforderliche Dateierweiterungen </h3><br><p>  Bei der Verwendung von Importen müssen Sie die Dateierweiterung angeben.  Wenn Sie eine Indexdatei aus einem Verzeichnis importieren, müssen Sie auch den Pfad zur Datei vollständig angeben, dh "./startup/index.js". </p><br><p>  Dieses Verhalten stimmt mit der Funktionsweise von Importen in Browsern überein, wenn auf einen regulären Server ohne zusätzliche Konfiguration zugegriffen wird. </p><br><h3 id="bolshe-nedostupny-require-exports-moduleexports-__filename-__dirname">  <code>module.exports</code> , <code>exports</code> , <code>module.exports</code> , <code>__filename</code> , <code>__dirname</code> </h3><br><p>  Diese Werte von CommonJS sind im Kontext von ES-Modulen nicht verfügbar.  <a href="https://nodejs.org/api/modules.html" rel="nofollow"><code>module.createRequire()</code></a> kann jedoch über <a href="https://nodejs.org/api/modules.html" rel="nofollow"><code>module.createRequire()</code></a> in das ES-Modul importiert werden.  Die Entsprechungen <code>__filename</code> und <code>__dirname</code> erhalten Sie unter <a href="https://nodejs.org/api/esm.html" rel="nofollow"><code>import.meta.url</code></a> . </p><br><h2 id="sozdanie-paketov">  Pakete erstellen </h2><br><p>  Momentan empfehlen wir Paketautoren, für ihre Node.js-Projekte entweder vollständig CommonJS- oder vollständig ES-Module zu verwenden.  Die Modularbeitsgruppe für Node.js sucht weiterhin nach Möglichkeiten, die Unterstützung für doppelte Pakete zu verbessern, mit CommonJS für ältere Benutzer und ES-Modulen für neue.  <a href="https://nodejs.org/api/esm.html" rel="nofollow">Bedingte Exporte</a> sind jetzt experimentell und wir hoffen, diese Funktionalität oder ihre Alternative bis Ende Januar 2020 oder noch früher einführen zu können. </p><br><p>  Weitere <a href="https://nodejs.org/api/esm.html" rel="nofollow">Informationen</a> hierzu finden Sie in unseren Beispielen und Empfehlungen zum Erstellen von <a href="https://nodejs.org/api/esm.html" rel="nofollow">dualen CommonJS / ES-Modulpaketen.</a> </p><br><h2 id="chto-budet-dalshe">  Was wird als nächstes passieren? </h2><br><p>  <strong>Lader.</strong>  Die Arbeit an der API zum Schreiben benutzerdefinierter Loader, zum Implementieren der Modultranspiration zur Laufzeit, zum Neudefinieren von Importpfaden (Pakete oder einzelne Dateien) und zum Instrumentieren des Codes wird fortgesetzt.  Die experimentelle API, die unter dem <a href="https://nodejs.org/api/esm.html" rel="nofollow"><code>—-experimental-loader</code></a> verfügbar ist, unterliegt erheblichen Änderungen, bevor wir sie vom Flag entfernen. </p><br><p>  <strong>Dual CommonJS / ES-Modulpakete.</strong>  Wir möchten eine Standardmethode zum Veröffentlichen eines Pakets bereitstellen, die sowohl über <code>require</code> in CommonJS als auch über <code>import</code> in ES-Module verwendet werden kann.  Weitere Informationen hierzu finden Sie <a href="https://nodejs.org/api/esm.html" rel="nofollow">in der Dokumentation</a> .  Wir planen, die Arbeiten abzuschließen und uns bis Ende Januar 2020 von der Fahne zurückzuziehen, wenn nicht früher. </p><br><p>  Das ist alles!  Wir hoffen, dass die ECMAScript-Unterstützung für Module Node.js den JavaScript-Standards näher bringt und neue Funktionen für die Kompatibilität im gesamten JavaScript-Ökosystem bietet.  Der Workflow zur Verbesserung der Modulunterstützung wird hier öffentlich durchgeführt: <a href="https://github.com/nodejs/modules" rel="nofollow">https://github.com/nodejs/modules</a> . </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de477168/">https://habr.com/ru/post/de477168/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de477156/index.html">„Where to go for Knowledge“: wissenschaftliche Vorträge und Technologiekonferenzen an der ITMO University</a></li>
<li><a href="../de477158/index.html">Epigenetische Stunden des Alterns - und doch ticken sie! ...</a></li>
<li><a href="../de477160/index.html">Ein kurzes Handbuch für Schüler einer Fremdsprache</a></li>
<li><a href="../de477164/index.html">„Wissenswertes zu Rhythmus-Spielen“: Welche Projekte haben den Sound verstärkt und ihn in das Genre aufgenommen?</a></li>
<li><a href="../de477166/index.html">Nachrichten aus der Welt von OpenStreetMap Nr. 486 (11/05/2019 - 11/11/2019)</a></li>
<li><a href="../de477170/index.html">Wie ich zu einem Treffen in der Schule gegangen bin 21</a></li>
<li><a href="../de477176/index.html">Welche Tools helfen bei der Erfüllung der DSGVO?</a></li>
<li><a href="../de477178/index.html">Modernes Programmieren: Ein Blick nach 25 Jahren Pause oder wie ich den Bot für Telegram geschrieben habe</a></li>
<li><a href="../de477180/index.html">Hintergrund: Was ist QoE und warum sollte ein Anbieter damit arbeiten?</a></li>
<li><a href="../de477182/index.html">[An den Docks] Flattern. Teil 2. Für iOS-Entwickler</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>