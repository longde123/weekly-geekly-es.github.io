<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Ⓜ️ 👂🏻 ✌🏿 Visualisasi jumlah kemenangan untuk tim NBA menggunakan grafik batang animasi di R 🏝️ 👈🏼 🧖🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Pertama, beberapa informasi latar belakang. Nama saya Vladislav dan kenalan saya dengan R terjadi pada Agustus tahun lalu. Saya memutuskan untuk belaj...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Visualisasi jumlah kemenangan untuk tim NBA menggunakan grafik batang animasi di R</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/458904/"><p>  Pertama, beberapa informasi latar belakang.  Nama saya Vladislav dan kenalan saya dengan R terjadi pada Agustus tahun lalu.  Saya memutuskan untuk belajar bahasa pemrograman karena sifat terapannya.  Sejak kecil, saya suka menyimpan statistik olahraga.  Dengan bertambahnya usia, hobi ini berubah menjadi keinginan untuk entah bagaimana menganalisis angka-angka ini dan, berdasarkan analisis data, memberikan, jika mungkin, pikiran cerdas.  Masalahnya adalah bahwa dalam beberapa tahun terakhir, olahraga telah tersapu oleh gelombang data, puluhan perusahaan bersaing di antara mereka sendiri, mencoba untuk menghitung, menggambarkan, dan mendorong ke neuron setiap tindakan pemain sepak bola, pemain bola basket, pemain baseball di lapangan.  Dan Excel tidak cocok untuk analisis.  Jadi saya memutuskan untuk belajar R sehingga analisis yang paling sederhana tidak akan memakan waktu setengah hari.  Sudah dalam perjalanan studi, minat dalam pemrograman seperti itu telah ditambahkan, tetapi ini sudah lirik. </p><a name="habracut"></a><br><p>  Saya ingin segera memperhatikan bahwa banyak dari apa yang akan saya tulis di masa depan <del>  sudah ada di simpsons </del>  ada di Habr dalam artikel <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Kami membuat histogram animasi menggunakan R.</a> Artikel ini, pada gilirannya, adalah terjemahan dari artikel <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Buat Trending Animated Bar Charts menggunakan R</a> dari Medium.  Oleh karena itu, agar berbeda dari artikel di atas, saya akan mencoba untuk lebih lengkap menggambarkan apa yang saya lakukan, serta momen-momen yang tidak ada dalam artikel asli.  Sebagai contoh, untuk mengisi kolom, saya menggunakan warna dari perintah NBA, bukan palet <code>ggplot2</code> standar, tetapi dalam data yang memproses paket <code>data.table</code> , bukan <code>dplyr</code> .  Saya telah melakukan semua pekerjaan ini sebagai fungsi, jadi sekarang cukup menulis nama tim dan tahun-tahun di mana Anda perlu menghitung jumlah kemenangan. </p><br><h2 id="dannye">  Data </h2><br><p>  Untuk membangun jadwal, saya menggunakan data tentang jumlah kemenangan untuk masing-masing dari 30 tim NBA dalam 15 musim terakhir.  Mereka dikumpulkan dari <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">stats.nba.com</a> menggunakan ekstensi <strong>NBA Data Retriever</strong> , yang, melalui penggunaan NBA API, menghasilkan file csv dengan statistik yang diperlukan.  Berikut ini rincian lengkap dari proyek saya <a href="">di Github</a> . </p><br><h2 id="ispolzuemye-biblioteki">  Perpustakaan digunakan </h2><br><pre> <code class="plaintext hljs">library(data.table) library(tidyverse) library(gganimate)</code> </pre> <br><p>  Untuk pemrosesan data, saya menggunakan <code>data.table</code> (hanya karena saya telah memenuhi paket ini sebelumnya).  Saya juga mengunduh satu set paket yang <code>tidyverse</code> , dan bukan <code>ggplot2</code> terpisah sehingga tidak perlu khawatir, jika selama analisis beberapa ide muncul yang memerlukan pemuatan tambahan paket dari set ini.  Dalam kasus khusus ini, <code>ggplot2</code> dapat ditiadakan, paket set lainnya tidak terlibat.  Nah, <code>gganimate</code> membuat grafik bergerak. </p><br><h2 id="rabota-s-dannymi">  Bekerja dengan data </h2><br><p>  Pertama, Anda perlu mengatur data.  Pada dasarnya, untuk membuat grafik, kita membutuhkan 2 dari 79 kolom tabel dengan data mentah.  Anda dapat memilih kolom yang diperlukan terlebih dahulu, Anda dapat mengganti beberapa nilai terlebih dahulu.  Saya pergi ke jalan kedua. </p><br><p>  Tabel di <code>data.table</code> memiliki bentuk <code>dt[i, j, by]</code> , di mana oleh "bertanggung jawab" untuk pengelompokan elemen.  Saya akan mengelompokkan berdasarkan kolom TeamName.  Dan ada halangan.  Kolom ini menampilkan nama-nama tim: Lakers, Celtics, Heat, dll.  Tetapi selama periode yang ditinjau (dari musim 2004/05) beberapa tim mengubah nama mereka: New Orleans Hornets menjadi New Orleans Pelicans, Charlotte Bobcats mengembalikan nama historis Charlotte Hornets, dan Seattle Supersonics menjadi Oklahoma City Thunder.  Ini dapat menyebabkan kebingungan.  Konversi berikut membantu menghindari ini: </p><br><pre> <code class="plaintext hljs">table1 &lt;- table[TeamCity == "New Orleans" &amp; TeamName == "Hornets", TeamName := "Pelicans"][ TeamCity == "New Orleans/Oklahoma City" &amp; TeamName == "Hornets", TeamName := "Pelicans"][ TeamName == "Bobcats", TeamName := "Hornets"][ TeamName == "SuperSonics", TeamName := "Thunder"]</code> </pre> <br><p>  Untuk periode ini, perubahannya minimal, tetapi jika Anda mengembangkannya, akan sangat sulit untuk dikelompokkan berdasarkan TeamName dan Anda harus menggunakan kolom yang lebih dapat diandalkan.  Dalam data ini, ini adalah TeamID. </p><br><p>  Untuk memulai, kami menyingkirkan informasi "ekstra", hanya menyisakan kolom yang kami perlukan untuk bekerja: </p><br><pre> <code class="plaintext hljs">table1 &lt;- table1[ , .(TeamName, WINS)]</code> </pre> <br><p>  Dalam <code>data.table</code> the. () Membangun menggantikan fungsi <code>list</code> .  Opsi yang lebih "klasik" untuk memilih kolom adalah <code>table1 &lt;- table1[, c("TeamName", "WINS")]</code> .  Setelah itu, tabel mengambil bentuk berikut: </p><br><div class="scrollable-table"><table><thead><tr><th>  Nama tim </th><th>  MENANG </th></tr></thead><tbody><tr><td>  Suns </td><td>  62 </td></tr><tr><td>  Panas </td><td>  59 </td></tr><tr><td>  Taji </td><td>  59 </td></tr><tr><td>  Piston </td><td>  54 </td></tr></tbody></table></div><br><p>  Untuk animasi untuk setiap musim secara terpisah, ini sudah cukup, tetapi untuk menghitung jumlah total kemenangan untuk periode yang dipilih, Anda perlu menghitung total kemenangan kumulatif. </p><br><p> <code>table1 &lt;- table1[, CumWins := cumsum(WINS), by = "TeamName"]</code> </p> <br><p>  Menggunakan fungsi <code>cumsum</code> kita mendapatkan angka yang kita butuhkan.  Menggunakan: = bukannya = memungkinkan Anda menambahkan kolom baru ke tabel; Saya tidak menimpanya dengan kolom CumWins yang sama.  <code>by = "TeamName"</code> mengelompokkan data berdasarkan nama tim dan jumlah kumulatif <code>by = "TeamName"</code> untuk masing-masing dari 30 tim secara terpisah. </p><br><p>  Selanjutnya, saya menambahkan kolom dengan tahun ketika setiap musim dimulai.  Musim NBA berlangsung dari Oktober hingga Mei, sehingga jatuh ke dalam dua tahun kalender.  Dalam penunjukan musim, tahun dimulainya, mis.  Musim: 2018 pada grafik adalah musim 2018/19 pada kenyataannya. </p><br><p>  Tabel asli memiliki data ini.  Kolom SeasonID menunjukkan angka dalam bentuk 2 (tahun dimulainya musim), misalnya, 22004. Anda dapat menghapus dua yang pertama menggunakan paket <code>stringr</code> atau fungsi R dasar, tetapi saya menggunakan cara yang sedikit berbeda.  Ternyata saya pertama kali menggunakan kolom ini untuk menunjukkan musim yang diperlukan, lalu hapus dan buat kolom dengan tanggal lagi.  Tindakan ekstra. </p><br><p>  Saya melakukannya sebagai berikut: </p><br><p> <code>table1 &lt;- table1[,year := rep(seq(2004, 2018), each = length(unique(table1$TeamName)))]</code> </p> <br><p>  Saya “beruntung” bahwa untuk periode waktu yang dipilih jumlah tim di NBA tidak berubah, jadi saya hanya mengulangi angka dari 2004 hingga 2018 sebanyak 30 kali.  Sekali lagi, jika Anda mencatat dalam sejarah, maka metode ini akan merepotkan karena fakta bahwa jumlah tim di setiap musim akan berbeda, sehingga lebih baik menggunakan opsi dengan menghapus kolom SeasonID. </p><br><p>  Kemudian tambahkan kolom cumrank. </p><br><p> <code>table1 &lt;- table1[, cumrank := frank(-CumWins, ties.method = "random"), by = "year"]</code> </p> <br><p>  Ini mewakili peringkat tim di setiap musim dengan jumlah kemenangan dan akan digunakan sebagai nilai dari sumbu X. <code>frank</code> yang lebih cepat. <code>data.table</code> analog dari <code>rank</code> dasar, minus berarti peringkat dalam urutan menurun (ini juga dapat dilakukan dengan menggunakan argumen <code>decreasing = TRUE</code> . apa urutan tim dengan jumlah kemenangan yang sama akan pergi, oleh karena itu <code>ties.method = "random"</code> . <code>ties.method = "random"</code> Nah, semua ini dikelompokkan dalam satu tahun. </p><br><p>  Dan konversi tabel terakhir adalah menambahkan kolom <code>value_rel</code> . </p><br><p> <code>table1 &lt;- table1[, value_rel := CumWins/CumWins[cumrank==1], by = "year"]</code> </p> <br><p>  Kolom ini mempertimbangkan rasio jumlah kemenangan masing-masing tim dengan indikator tertinggi untuk tahun tersebut.  Untuk tim terbaik, indikator ini adalah 1, sisanya kurang, tergantung pada keberhasilan musim. </p><br><p>  Setelah semua penambahan, tabel memiliki bentuk berikut: </p><br><div class="scrollable-table"><table><thead><tr><th>  Nama tim </th><th>  MENANG </th><th>  Cumwins </th><th>  tahun </th><th>  cumrank </th><th>  value_rel </th></tr></thead><tbody><tr><td>  Taji </td><td>  59 </td><td>  59 </td><td>  2004 </td><td>  3 </td><td>  0.9516129 </td></tr><tr><td>  Taji </td><td>  63 </td><td>  122 </td><td>  2005 </td><td>  1 </td><td>  1,0000000 </td></tr><tr><td>  Taji </td><td>  58 </td><td>  180 </td><td>  2006 </td><td>  2 </td><td>  0,9729730 </td></tr><tr><td>  Taji </td><td>  56 </td><td>  236 </td><td>  2007 </td><td>  1 </td><td>  1,0000000 </td></tr></tbody></table></div><br><p>  Hanya satu tim yang disajikan dalam tabel untuk menggambarkan kumulativeness.  Semua tindakan ini dilakukan, seperti dalam perubahan nama, dengan rangkai tanda kurung </p><br><pre> <code class="plaintext hljs">table1 &lt;- table1[ ,.(TeamName, WINS)][ , CumWins := cumsum(WINS), by = "TeamName"][ ,year := rep(seq(2004, 2018), each = length(unique(table1$TeamName)))][ , cumrank := frank(-CumWins, ties.method = "random"), by = "year"][ , value_rel := CumWins/CumWins[cumrank==1], by = "year"]</code> </pre> <br><h2 id="izmenenie-zalivki-stolbcov-so-standartnoy-na-cveta-komand">  Ubah isian kolom dari standar ke warna tim. </h2><br><p>  Anda dapat langsung melanjutkan ke pembuatan grafik, tetapi menurut saya ada satu poin penting: warna kolom dalam grafik.  Anda dapat meninggalkan palet <code>ggplot2</code> standar, tetapi ini adalah opsi yang buruk.  Pertama, menurut saya dia jelek.  Dan kedua, sulit untuk menemukan tim di grafik.  Untuk penggemar NBA, setiap tim dikaitkan dengan warna tertentu: Boston adalah hijau, Chicago adalah merah, Sacramento adalah ungu, dll.  Oleh karena itu, menggunakan warna perintah di kolom isian membantu mengidentifikasinya dengan lebih cepat, meskipun terdapat banyak warna biru dan merah. </p><br><p>  Untuk melakukan ini, buat <code>table_color</code> table dengan nama perintah dan warna utamanya.  Warna diambil dari <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">teamcolorcodes.com</a> . </p><br><div class="scrollable-table"><table><thead><tr><th>  Nama tim </th><th>  TEAM_color </th></tr></thead><tbody><tr><td>  Elang </td><td>  # E03A3E </td></tr><tr><td>  Celtics </td><td>  # 007A33 </td></tr><tr><td>  Jaring </td><td>  # 000000 </td></tr></tbody></table></div><br><p>  Dengan tabel warna, Anda perlu melakukan satu manipulasi lagi.  Karena  ketika merencanakan faktor digunakan, maka urutan tim berubah.  Yang pertama dalam daftar adalah Philadelphia 76, sebagai satu-satunya pemilik nama "digital", dan kemudian sesuai dengan alfabet.  Jadi kita perlu mengatur warna dalam urutan yang sama, dan kemudian mengekstrak vektor yang mengandungnya dari tabel.  Saya melakukannya sebagai berikut: </p><br><pre> <code class="plaintext hljs"> table_color &lt;- table_color[order(TeamName)] cols &lt;- table_color[, "TEAM_color"]</code> </pre> <br><h2 id="postroenie-grafika">  Merencanakan </h2><br><p>  Kami benar-benar membangun hanya satu bagan, yang berisi semua 450 (15 musim * 30 tim) indikator kemenangan, dan kemudian "membaginya" dengan variabel yang diperlukan (dalam kasus kami, berdasarkan tahun) menggunakan fungsi dari paket <code>gganimate</code> . </p><br><pre> <code class="plaintext hljs">gg &lt;- ggplot(table1, aes(cumrank, group = TeamName, fill = as.factor(TeamName), color = as.factor(TeamName))) + geom_tile(aes(y = CumWins/2, height = CumWins, width = 0.7), color = NA, alpha = 0.8)</code> </pre> <br><p>  Pertama, kita membuat grafik menggunakan fungsi <code>ggplot</code> .  Dalam argumen <code>aes</code> , tentukan bagaimana variabel dari tabel akan ditampilkan pada grafik.  Kami mengelompokkannya berdasarkan Nama Tim, <code>fill</code> , dan <code>color</code> akan bertanggung jawab atas warna kolom. </p><br><p>  Kolom sejati menyebutnya tidak sepenuhnya benar.  Menggunakan <code>geom_tile</code> kami "membagi" data pada bagan menjadi empat persegi panjang.  Berikut adalah contoh bagan jenis ini: <br><img src="https://habrastorage.org/getpro/habr/post_images/210/405/916/2104059165b8000275951025c2020b5b.jpg"><br>  Dapat dilihat bagaimana grafik "dibagi" menjadi kotak (mereka diperoleh dari persegi panjang menggunakan layer <code>coord_equal()</code> ), tiga di setiap kolom.  Namun berkat <code>width</code> argumen kurang dari satu, ubin kami mengambil bentuk kolom. </p><br><pre> <code class="plaintext hljs"> geom_text(aes(y = 0, label = paste(TeamName, " ")), vjust = 0.2, hjust = 1, size = 6) + geom_text(aes(y = CumWins, label = paste0(" ",round(CumWins))), hjust = 0, size = 7) + coord_flip(clip = "off", expand = FALSE) + scale_fill_manual(values = cols) + scale_color_manual(values = cols) + scale_y_continuous(labels = scales::comma) + scale_x_reverse() + guides(color = FALSE, fill = FALSE) +</code> </pre> <br><p>  Selanjutnya, saya menambahkan dua tanda tangan menggunakan <code>geom_text</code> : nama tim dan jumlah kemenangan.  <code>coord_flip</code> menukar sumbu, <code>scale_fill_manual</code> dan <code>scale_color_manual</code> mengubah warna kolom, <code>scale_x_reverse</code> "memperluas" sumbu X. Perhatikan bahwa kami mengambil warna dari vektor <code>cols</code> dibuat sebelumnya. </p><br><p>  Lapisan <code>theme</code> menentukan opsi untuk menyesuaikan tampilan grafik.  Di sini ditunjukkan bagaimana tajuk dan label sumbu harus ditampilkan (sama sekali tidak apa yang <code>element_blank</code> katakan pada kita di sisi kanan kesetaraan).  Kami menghapus legenda, latar belakang, bingkai, garis-garis kisi di sepanjang sumbu Y. <code>plot.title</code> argumen <code>plot.title</code> , <code>plot.subtitle</code> , <code>plot.caption</code> , kami menetapkan opsi tampilan untuk judul, subtitle, dan tanda tangan bagan.  Untuk detail lebih lanjut tentang arti semua parameter, lihat <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">gglot2</a> </p><br><pre> <code class="plaintext hljs">theme(axis.line=element_blank(), axis.text.x=element_blank(), axis.text.y=element_blank(), axis.ticks=element_blank(), axis.title.x=element_blank(), axis.title.y=element_blank(), legend.position="none", panel.background=element_blank(), panel.border=element_blank(), panel.grid.major=element_blank(), panel.grid.minor=element_blank(), panel.grid.major.x = element_line( size=.1, color="grey" ), panel.grid.minor.x = element_line( size=.1, color="grey" ), plot.title=element_text(size=25, hjust=0.5, face="bold", colour="black", vjust=-1), plot.subtitle = element_text(size = 15), plot.caption =element_text(size=15, hjust=0.5, color="black"), plot.background=element_blank(), plot.margin = margin(2,2, 2, 4, "cm"))</code> </pre> <br><h2 id="sozdanie-animacii">  Buat animasi </h2><br><p>  Saya tidak akan berkutat menggunakan fungsi <code>transition_states</code> , bagian ini identik dengan publikasi saya sebelumnya tentang Habré.  Adapun <code>labs</code> itu menciptakan judul, subtitle dan tanda tangan dari bagan.  Menggunakan <code>{closest_state}</code> memungkinkan Anda menampilkan setiap tahun tertentu pada bagan, kolom yang saat ini kami lihat. </p><br><pre> <code class="plaintext hljs"> anim &lt;- gg + transition_states(year, transition_length = 4, state_length = 1) + view_follow(fixed_x = TRUE) + labs(title = "Cumulative Wins by teams in seasons", subtitle = "Season: {closest_state}", caption = "Telegram: @NBAatlantic, Twitter: @vshufiskiy\n Data sourse: stats.nba.com")</code> </pre> <br><h2 id="funkciya-nba_cumulative_wins-dlya-sozdaniya-grafikov">  <code>nba_cumulative_wins</code> berfungsi untuk membuat grafik. </h2><br><p>  Fungsi penulisan menyederhanakan dan mempercepat proses mendapatkan hasil jika Anda perlu menggunakan kode lebih dari sekali.  Biasanya, fungsi dalam R memiliki bentuk berikut: </p><br><pre> <code class="plaintext hljs">_ &lt;- function( ) { _ }</code> </pre> <br><p>  Pertama, Anda perlu memahami parameter apa yang ingin Anda ubah menggunakan fungsi, argumennya akan tergantung pada ini.  Argumen pertama adalah nama tabel data yang sedang diinput.  Ini memungkinkan Anda untuk mengganti nama jika keinginan seperti itu muncul, sementara tidak mengubah apa pun dalam fungsi itu sendiri.  Saya juga ingin sejumlah perintah ditampilkan di grafik: dari satu (yang tidak ada gunanya) hingga 30 (tidak ada lagi).  Saya juga ingin dapat mempertimbangkan periode waktu dalam 15 tahun yang saya miliki datanya.  Semua ini diimplementasikan dalam bentuk fungsi ini: </p><br><pre> <code class="plaintext hljs">nba_cumulative_wins &lt;- function(table, elements, first_season, last_season){ ... }</code> </pre> <br><p>  di mana <code>table</code> adalah nama tabel dengan data input, <br>  <code>elements</code> - nama-nama tim yang harus ditampilkan pada grafik <br>  <code>first_season</code> - musim pertama yang ditampilkan pada grafik <br>  <code>last_season</code> - musim terakhir untuk ditampilkan pada grafik. </p><br><p>  Jika argumen tersebut sangat sering digunakan dengan nilai tertentu, maka Anda dapat mengaturnya secara default.  Kemudian, jika dihilangkan di antara argumen fungsi, maka nilai ini akan diganti.  Misalnya, jika Anda mendaftar </p><br><p> <code>nba_cumulative_wins &lt;- function(table, elements, first_season, last_season = 2018)</code> </p> <br><p>  maka jadwal akan dibangun hingga musim 2018/19, kecuali dinyatakan sebaliknya. </p><br><h2 id="rabota-s-argumentami-elements-first_season-last_season">  Bekerja dengan <code>elements</code> argumen, <code>first_season</code> , <code>last_season</code> </h2><br><p>  Menggunakan argumen <code>elements</code> , kita dapat menentukan nama tim yang ingin kita lihat pada tabel.  Ini sangat nyaman ketika ada 2 atau 3 tim seperti itu, tetapi jika kita ingin menampilkan seluruh liga kita harus menulis <code>elements = c()</code> dan nama semua 30 tim dalam tanda kurung. </p><br><p>  Jadi saya memutuskan untuk "membagi" nilai input untuk argumen <code>elements</code> ke dalam beberapa grup. <br>  Fungsi <code>nba_cumulative_wins</code> dapat membuat grafik untuk masing-masing tim, divisi, konferensi, atau NBA secara keseluruhan.  Untuk ini, saya menggunakan konstruksi berikut: </p><br><pre> <code class="plaintext hljs"> select_teams &lt;- unique(table1$TeamName) select_div &lt;- unique(table1$Division) select_conf &lt;- unique(table1$Conference) select_nba &lt;- "NBA" table1 &lt;- if(elements %in% select_teams){ table1[TeamName %in% elements] } else if (elements %in% select_div){ table1[Division %in% elements] } else if(elements %in% select_conf){ table1[Conference %in% elements] } else if(elements == "NBA"){ table1 } else { NULL }</code> </pre> <br><p>  <code>select_</code> vektor simbolis berisi nama-nama dari semua 30 tim, 6 divisi, 2 konferensi dan NBA, dan fungsi <code>unique</code> hanya menyisakan satu nama unik, bukan 15 (dengan jumlah tahun dalam data). </p><br><p>  Kemudian, dengan menggunakan <code>if...else</code> , argumen <code>elements</code> dimasukkan diverifikasi milik salah satu kelas ( <code>%in%</code> digunakan untuk menentukan apakah elemen tersebut milik vektor), dan tabel data dimodifikasi sesuai.  Sekarang, jika saya ingin melihat hasil tim bermain di Divisi Barat Daya sebagai gantinya </p><br><p> <code>elements = c("Mavericks", "Spurs", "Rockets", "Grillies", "Pelicans")</code> </p> <br><p>  cukup masukkan </p><br><p>  <code>elements = "Southwest"</code> , yang jauh lebih cepat dan lebih nyaman. </p><br><p>  Karena kemungkinan memilih musim, pekerjaan dengan tanggal juga berubah.  Pada awalnya, baris ditambahkan: </p><br><pre> <code class="plaintext hljs">table1 &lt;- table1[SeasonID &gt;= as.numeric(paste(2, first_season, sep = "")) &amp; SeasonID &lt;= as.numeric(paste(2, last_season, sep = ""))]</code> </pre> <br><p>  Jadi saya tinggalkan tabel hanya baris-baris yang termasuk dalam interval waktu pilihan kami.  Kode untuk membuat kolom <code>year</code> juga berubah.  Sekarang terlihat seperti ini: </p><br><pre> <code class="plaintext hljs">table1 &lt;- table1[ ,year := rep(seq(first_season, last_season), each = length(unique(table1$TeamName)))]</code> </pre> <br><p>  Sehubungan dengan pengelompokan elemen, prosedur untuk mendapatkan warna yang diinginkan rumit.  Faktanya adalah bahwa dalam tabel <code>table_color</code> hanya nama-nama perintah.  Karena itu, kita perlu "mengerahkan" kontraksi kita kembali.  Untuk melakukan ini, gunakan konstruksi <code>if...else</code> lagi. </p><br><pre> <code class="plaintext hljs"> elements1 &lt;- if (elements == "NBA"){ c("Hawks", "Celtics", "Nets", "Hornets", "Bulls", "Cavaliers", "Mavericks", "Nuggets", "Pistons", "Warriors", "Rockets", "Pacers", "Clippers", "Lakers", "Grizzlies", "Heat", "Bucks", "Timberwolves", "Pelicans", "Knicks", "Thunder", "Magic", "76ers", "Suns", "Trail Blazers","Kings", "Spurs", "Raptors", "Jazz", "Wizards") } else if (elements == "West") { c("Mavericks","Nuggets", "Warriors", "Rockets", "Clippers", "Lakers", "Grizzlies","Timberwolves", "Pelicans", "Thunder", "Suns", "Trail Blazers","Kings", "Spurs", "Jazz") } else if (elements == "East") { c("Hawks", "Celtics", "Nets", "Hornets", "Bulls", "Cavaliers","Pistons", "Pacers", "Heat", "Bucks", "Knicks", "Magic", "76ers", "Raptors", "Wizards") } else if (elements == "Pacific") { c("Warriors", "Clippers", "Lakers", "Suns", "Kings") } else if (elements == "Southeast") { c("Magic", "Hornets", "Heat", "Hawks", "Wizards") } else if (elements == "Southwest") { c("Mavericks", "Grizzlies", "Pelicans", "Rockets", "Spurs") } else if (elements == "Central") { c("Bucks", "Pacers", "Pistons", "Bulls", "Cavaliers") } else if (elements == "Atlantic") { c("Knicks", "Nets", "Celtics", "Raptors", "76ers") } else if (elements == "Northwest") { c("Nuggets", "Trail Blazers", "Jazz", "Thunder", "Suns") } else { elements }</code> </pre> <br><p>  Selanjutnya, buat tabel dengan nama-nama perintah yang kita butuhkan, hubungkan tabel ini ke <code>table_color</code> menggunakan fungsi <code>inner_join</code> dari paket <code>dplyr</code> .  <code>inner_join</code> hanya menyertakan kasus yang cocok di kedua tabel. </p><br><pre> <code class="plaintext hljs"> table_elements1 &lt;- data.table(TeamName = elements1) table_color &lt;- table_color[order(TeamName)] inner_table_color &lt;- inner_join(table_color, table_elements1) cols &lt;- inner_table_color[, "TEAM_color"]</code> </pre> <br><p>  Fungsi ini mengubah ejaan judul dan subtitle.  Mereka mengambil tampilan ini: </p><br><pre> <code class="plaintext hljs">anim &lt;- gg + transition_states(year, transition_length = 4, state_length = 1) + view_follow(fixed_x = TRUE) + labs(title = paste("Cumulative Wins by teams in seasons", first_season, "-", last_season, sep = " "), subtitle = paste(if (elements %in% select_div ){ paste(elements, "Division", sep = " ") } else if (elements %in% select_conf ){ paste("Conference", elements, sep = " ") }, "Season: {closest_state}", sep = " "), caption = "Telegram: @NBAatlantic, Twitter: @vshufiskiy\nData sourse: stats.nba.com")</code> </pre> <br><h2 id="rendering">  Rendering </h2><br><p>  Selanjutnya, semua ini divisualisasikan. </p><br><pre> <code class="plaintext hljs">animate(anim, nframes = (last_season - first_season + 1) * (length(unique(table1$TeamName)) + 20), fps = 20, width = 1200, height = 1000, renderer = gifski_renderer(paste(elements[1], "cumwins.gif", sep = "_")))</code> </pre> <br><p>  Saya memilih angka dalam <code>nframes</code> secara empiris, sehingga tergantung pada jumlah perintah yang dipilih, kecepatan bertambah / berkurang. </p><br><h2 id="grafik">  Grafik </h2><br><p><img src="https://habrastorage.org/getpro/habr/post_images/e15/803/11d/e1580311d19d5f814b201c32237a3ed5.gif"></p><br><p>  Saya harap posting saya menarik.  Kode proyek <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Github</a> . </p><br><p>  Jika Anda tertarik pada komponen olahraga dari visualisasi ini, Anda dapat mengunjungi blog saya di sports.ru "Di kedua sisi Atlantik" </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id458904/">https://habr.com/ru/post/id458904/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id458892/index.html">Saran untuk Kerentanan dan Perlindungan Model Pembelajaran Mesin</a></li>
<li><a href="../id458894/index.html">Orang-orang biasa dan jaringan tempat mereka tinggal</a></li>
<li><a href="../id458896/index.html">JavaScript Fungsional: apa fungsi tingkat tinggi dan mengapa diperlukan?</a></li>
<li><a href="../id458900/index.html">Kartrid konsol sebagai modem</a></li>
<li><a href="../id458902/index.html">5 Kesalahan Umum Pemula Python</a></li>
<li><a href="../id458906/index.html">[Yekaterinburg, pengumuman] Flutteron - sebuah lokakarya tentang pengembangan Flutter</a></li>
<li><a href="../id458908/index.html">Memindai dokumen melalui jaringan</a></li>
<li><a href="../id458910/index.html">Benchmarking PostgreSQL dengan halaman Linux yang besar</a></li>
<li><a href="../id458912/index.html">Bermigrasi ke Zimbra dengan imapsync</a></li>
<li><a href="../id458914/index.html">Apa (tidak) yang perlu Anda ketahui untuk membuat game di Unity</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>