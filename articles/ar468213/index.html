<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🖐🏾 🏴󠁧󠁢󠁳󠁣󠁴󠁿 ⚽️ tinc-boot - شبكة كاملة بدون ألم 🧜🏿 🖖🏼 🖕</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="تلقائي وآمن وموزع ، مع اتصالات متعدية (مثل إعادة توجيه الرسائل عندما لا يكون هناك وصول مباشر بين المشتركين) ، دون نقطة واحدة من الفشل ، نظير ، تم اختب...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>tinc-boot - شبكة كاملة بدون ألم</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/468213/" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/hi/bi/xp/hibixpblgmg9-ctqwsnijobvxvc.png"></p><br><p style=";text-align:right;direction:rtl">  تلقائي وآمن وموزع ، مع اتصالات متعدية (مثل إعادة توجيه الرسائل عندما لا يكون هناك وصول مباشر بين المشتركين) ، دون نقطة واحدة من الفشل ، نظير ، تم اختباره على مدار الوقت ، استهلاك منخفض للموارد ، شبكة VPN كاملة الشبكات مع القدرة على "التثقيب" NAT - هل هو ممكن؟ </p><a name="habracut"></a><br><p style=";text-align:right;direction:rtl">  الإجابات الصحيحة هي: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  نعم ، مع الألم إذا كنت تستخدم الخندق. </li><li style=";text-align:right;direction:rtl">  نعم ، من السهل إذا كنت تستخدم tinc + tinc-boot </li></ul><br><p style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">تمهيد تخطي الارتباط</a> </p><br><h1 id="opisanie-tinc" style=";text-align:right;direction:rtl">  وصف تينك </h1><br><p style=";text-align:right;direction:rtl">  لسوء الحظ ، تم نشر <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">القليل من</a> المعلومات حول <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Tinc VPN</a> على <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Habré</a> ، ولكن لا يزال من الممكن العثور على مقالتين ذات صلة: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">وصفتنا لخادم VPN آمن من الفشل على أساس tinc ، OpenVPN ، Linux</a> من Flant </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">قائمة شبكة VPN للحلول الكاملة</a> من <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" class="user_link">ValdikSS</a> المحترم </li></ul><br><p style=";text-align:right;direction:rtl">  من المقالات باللغة الإنجليزية يمكن تمييزها: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">كيفية تثبيت Tinc وإعداد VPN أساسي على Ubuntu 14.04</a> من Digital Ocean </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">كيفية إعداد tinc ، VPN نظير إلى نظير</a> من Linode </li></ul><br><p style=";text-align:right;direction:rtl">  المصدر الأصلي هو الأفضل للنظر في وثائق <a href="">رجل Tinc</a> الأصلي </p><br><p style=";text-align:right;direction:rtl"> لذلك (إعادة طبع مجانية من الموقع الرسمي) ، Tinc VPN هي خدمة ( <code>tincd</code> daemon) تضمن تشغيل شبكة خاصة عن طريق حفر وتشفير حركة المرور بين العقد.  شفرة المصدر مفتوحة ومتاحة بموجب ترخيص GPL2.  مثل الحل الكلاسيكي (OpenVPN) ، تتوفر الشبكة الافتراضية التي تم إنشاؤها على مستوى IP (OSI 3) ، مما يعني ، في الحالة العامة ، إجراء تغييرات على التطبيقات غير مطلوب. </p><br><p style=";text-align:right;direction:rtl">  الميزات الرئيسية: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  تشفير وتوثيق وضغط حركة المرور ؛ </li><li style=";text-align:right;direction:rtl">  حل شبكة كاملة تلقائيًا ، والذي يتضمن إنشاء اتصالات لعقد الشبكة في وضع الكل مع الكل أو إعادة توجيه الرسائل بين المضيفين الوسيطين ، إذا لم يكن ذلك ممكنًا ؛ </li><li style=";text-align:right;direction:rtl">  لكمة NAT. </li><li style=";text-align:right;direction:rtl">  القدرة على توصيل الشبكات المعزولة على مستوى الإيثرنت (التبديل الظاهري) ؛ </li><li style=";text-align:right;direction:rtl">  دعم أنظمة تشغيل متعددة: Linux ، FreeBSD ، OS X ، Solaris ، Windows ، إلخ. </li></ul><br><p style=";text-align:right;direction:rtl">  هناك نوعان من فروع تطوير القصدير: 1.0.x (في جميع المستودعات تقريبًا) و 1.1 (تجريبي أبدي).  يستخدم المقال الإصدار 1.0.x في كل مكان. </p><br><blockquote style=";text-align:right;direction:rtl">  يوفر Tinc 1.1x العديد من الميزات الرئيسية الجديدة: أمان أمامي مثالي واتصال عميل مبسط (يستبدل فعليًا <code>tinc-boot</code> ) وتصميم أكثر <code>tinc-boot</code> بشكل عام. <br><br>  ومع ذلك ، في الوقت الحالي ، تتم الإشارة إلى إصدار ثابت - 1.0.x وتمييزه على الموقع الرسمي ، لذلك عند استخدام جميع مزايا الفرع 1.1 ، يجب عليك تقييم جميع مزايا وعيوب استخدام إصدار غير نهائي. </blockquote><p style=";text-align:right;direction:rtl">  من وجهة نظري ، أحد أقوى الاحتمالات هو إعادة توجيه الرسائل عندما يكون الاتصال المباشر غير ممكن.  في الوقت نفسه ، يتم إنشاء جداول التوجيه تلقائيًا.  حتى العقد بدون عنوان عام يمكن أن تمر حركة المرور من خلال أنفسهم. </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/po/ls/gk/polsgk0pdev-rayy9tkqd74mrss.png"></p><br><p style=";text-align:right;direction:rtl">  النظر في الموقف مع ثلاثة خوادم (الصين وروسيا وسنغافورة) وثلاثة عملاء (روسيا والصين والفلبين): </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  خوادم لديها عنوان عام ، عملاء وراء NAT. </li><li style=";text-align:right;direction:rtl">  ILV خلال الحظر التالي للوكيلين المحتملين قامت Telegram بحظر جميع المضيفين باستثناء الصين "الودية" ؛ </li><li style=";text-align:right;direction:rtl">  حدود شبكة الصين &lt;-&gt; RF غير مستقرة وقد تقع (بسبب ILV و / أو بسبب الرقابة الصينية) ؛ </li><li style=";text-align:right;direction:rtl">  الاتصالات إلى سنغافورة مستقرة مشروطة (تجربة شخصية) ؛ </li><li style=";text-align:right;direction:rtl">  مانيلا (الفلبين) ليست تهديدًا لأحد ، وبالتالي فهي مسموح للجميع (بسبب المسافة من الجميع وكل شيء). </li></ul><br><p style=";text-align:right;direction:rtl">  على سبيل المثال ، تبادل الحركة بين شنغهاي وموسكو ، خذ بعين الاعتبار سيناريوهات Tinc (تقريبًا): </p><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  الوضع الأصلي: موسكو &lt;-&gt; russia-srv &lt;-&gt; china-srv &lt;-&gt; Shanghai </li><li style=";text-align:right;direction:rtl">  اتصال ILV مغلق مع الصين: موسكو &lt;-&gt; russia-srv &lt;-&gt; Manila &lt;-&gt; Singapore &lt;-&gt; Shanghai </li><li style=";text-align:right;direction:rtl">  (بعد 2) في حالة فشل الخادم في سنغافورة ، يتم نقل حركة المرور إلى الخادم في الصين والعكس. </li></ol><br><p style=";text-align:right;direction:rtl">  كلما كان ذلك ممكنًا ، يحاول Tinc تأسيس اتصال مباشر بين العقدتين خلف NAT عن طريق التثقيب. </p><br><h1 id="kratkaya-vvodnaya-v-konfigurirovanie-tinc" style=";text-align:right;direction:rtl">  مقدمة موجزة لتكوين الخندق </h1><br><p style=";text-align:right;direction:rtl">  يتم وضع Tinc كخدمة سهلة التكوين.  ومع ذلك ، حدث خطأ ما - لإنشاء عقدة جديدة ، فمن الضروري الحد الأدنى: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  وصف تكوين المضيف (النوع ، الاسم) ( <code>tinc.conf</code> ) ؛ </li><li style=";text-align:right;direction:rtl">  وصف ملف التكوين (الشبكات الفرعية المقدمة والعناوين العامة) ( <code>hosts/</code> ) ؛ </li><li style=";text-align:right;direction:rtl">  إنشاء مفتاح ؛ </li><li style=";text-align:right;direction:rtl">  إنشاء برنامج نصي يحدد عنوان العقدة والمعلمات ذات الصلة ( <code>tinc-up</code> ) ؛ </li><li style=";text-align:right;direction:rtl">  من المستحسن إنشاء برنامج نصي يقوم بمسح المعلمات التي تم إنشاؤها بعد التوقف ( <code>tinc-down</code> ). </li></ul><br><p style=";text-align:right;direction:rtl">  بالإضافة إلى ذلك ، عند الاتصال بشبكة حالية ، يجب عليك الحصول على مفاتيح المضيف الحالية وتوفير مفاتيحك الخاصة. </p><br><p style=";text-align:right;direction:rtl">  أي: للعقدة الثانية </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/o7/nk/x8/o7nkx80o15rsuzphmncldc2ywek.png"></p><br><p style=";text-align:right;direction:rtl">  للثالث </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/_p/ag/sf/_pagsfvg-lspeyvn-s0b2unhcha.png"></p><br><p style=";text-align:right;direction:rtl">  عند استخدام المزامنة ثنائية الاتجاه (على سبيل المثال ، <code>unison</code> ) ، يزيد عدد العمليات الإضافية إلى N pieces ، حيث N هو عدد العقد العامة. </p><br><blockquote style=";text-align:right;direction:rtl">  يجب أن نشيد بمطوري Tinc - لتضمينهم في الشبكة ، فقط تبادل المفاتيح <br>  مع واحد فقط من العقد (bootnode).  بعد بدء الخدمة والاتصال بالمشارك ، ستحصل على خصلة طوبولوجيا <br>  شبكة وسوف تكون قادرة على العمل مع جميع المشتركين. <br><br>  <strong>ومع ذلك</strong> ، إذا أصبح مضيف التمهيد غير متوفر ، وتم إعادة تشغيل tinc ، فلن تكون هناك طريقة لذلك <br>  سيتم الاتصال بالشبكة الافتراضية. </blockquote><p style=";text-align:right;direction:rtl">  علاوة على ذلك ، فإن الإمكانيات الهائلة للخيام ، إلى جانب الوثائق الأكاديمية لهذا (الموصوفة جيدًا ، ولكن أمثلة قليلة) ، توفر مجالًا واسعًا للأخطاء. </p><br><h1 id="prichiny-sozdaniya-tinc-boot" style=";text-align:right;direction:rtl">  أسباب إنشاء tinc-boot </h1><br><p style=";text-align:right;direction:rtl">  إذا قمنا بتعميم المشكلات الموضحة أعلاه وصياغةها كمهام ، فسنحصل على: </p><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  هناك حاجة إلى إنشاء موقع جديد بأقل جهد ممكن ؛ <br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  يحتمل أن يكون من الضروري إتاحة الفرصة للمتخصص المتوسط ​​(enikey) لخط صغير واحد لإنشاء عقدة جديدة والاتصال بالشبكة ؛ </li></ul></li><li style=";text-align:right;direction:rtl">  من الضروري توفير التوزيع التلقائي للمفاتيح بين جميع العقد النشطة ؛ </li><li style=";text-align:right;direction:rtl">  من الضروري توفير إجراء تبادل مفتاح مبسط بين bootnod والعميل الجديد. </li></ol><br><blockquote style=";text-align:right;direction:rtl">  bootnode - عقدة ذات عنوان عام (انظر أعلاه) ؛ </blockquote><p style=";text-align:right;direction:rtl">  بسبب متطلبات المطالبة 2 ، يمكن القول أنه بعد تبادل المفاتيح بين bootnode والعقدة الجديدة ، وبعد <br>  عند توصيل العقدة بالشبكة ، سيتم توزيع المفتاح الجديد تلقائيًا. </p><br><p style=";text-align:right;direction:rtl">  هذه هي المهام التي <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">يؤديها tinc-boot</a> . </p><br><p style=";text-align:right;direction:rtl">  <strong>tinc-boot</strong> هو تطبيق مفتوح المصدر <code>tinc</code> بذاته ، بصرف النظر عن <code>tinc</code> ، يوفر: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  إنشاء بسيط لعقدة جديدة ؛ </li><li style=";text-align:right;direction:rtl">  اتصال تلقائي إلى شبكة موجودة ؛ </li><li style=";text-align:right;direction:rtl">  وضع غالبية المعلمات بشكل افتراضي ؛ </li><li style=";text-align:right;direction:rtl">  التوزيع الرئيسي للعقد العسل. </li></ul><br><h1 id="arhitektura" style=";text-align:right;direction:rtl">  هندسة معمارية </h1><br><p style=";text-align:right;direction:rtl">  يتكون الملف القابل للتنفيذ <code>tinc-boot</code> من أربعة مكونات: خادم bootnode ، خادم إدارة التوزيع الرئيسي وأوامر إدارة RPC الخاصة به ، بالإضافة إلى وحدة إنشاء عقدة. </p><br><h2 id="modul-generacii-uzla" style=";text-align:right;direction:rtl">  وحدة توليد العقدة </h2><br><p style=";text-align:right;direction:rtl">  تقوم وحدة إنشاء العقدة ( <code>tinc-boot gen</code> ) بإنشاء جميع الملفات اللازمة لتشغيل tinc بنجاح. </p><br><p style=";text-align:right;direction:rtl">  مبسطة ، ويمكن وصف خوارزمية لها على النحو التالي: </p><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  حدد اسم المضيف ، الشبكة ، معلمات IP ، المنفذ ، قناع الشبكة الفرعية ، إلخ. </li><li style=";text-align:right;direction:rtl">  تطبيعها (القصدير له حد على بعض القيم) وإنشاء القيم المفقودة </li><li style=";text-align:right;direction:rtl">  تحقق المعلمات </li><li style=";text-align:right;direction:rtl">  إذا لزم الأمر ، قم بتثبيت tinc-boot على النظام (غير قابل للتخصيص) </li><li style=";text-align:right;direction:rtl">  قم <code>tinc-up</code> و <code>tinc-down</code> و <code>subnet-up</code> و <code>subnet-down</code> </li><li style=";text-align:right;direction:rtl">  إنشاء <code>tinc.conf</code> التكوين <code>tinc.conf</code> </li><li style=";text-align:right;direction:rtl">  إنشاء <code>hosts/</code> </li><li style=";text-align:right;direction:rtl">  أداء جيل المفتاح </li><li style=";text-align:right;direction:rtl">  إجراء تبادل المفتاح مع bootnode <br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  تشفير ملف المضيف الخاص بك وتوقيعه باستخدام مفتاح عمومي ، وموجه التهيئة العشوائي (nounce) واسم المضيف باستخدام xchacha20poly1305 ، حيث يكون مفتاح التشفير هو نتيجة وظيفة sha256 من الرمز المميز </li><li style=";text-align:right;direction:rtl">  إرسال البيانات عبر بروتوكول HTTP إلى bootnode </li><li style=";text-align:right;direction:rtl">  فك تشفير الإجابة المتلقاة ورأس <code>X-Node</code> يحتوي على اسم عقدة التمهيد باستخدام nounce الأصلي والخوارزمية نفسها </li><li style=";text-align:right;direction:rtl">  إذا نجحت ، فاحفظ المفتاح المستلم في <code>hosts/</code> وأضف إدخال <code>ConnectTo</code> إلى ملف التكوين (مثل التوصية التي يجب الاتصال بها) </li><li style=";text-align:right;direction:rtl">  وإلا ، استخدم العنوان التالي في قائمة عقدة التمهيد وكرر من الخطوة 2 </li></ol></li><li style=";text-align:right;direction:rtl">  عرض التوصيات بشأن بدء الخدمة </li></ol><br><blockquote style=";text-align:right;direction:rtl">  يتم استخدام التحويل عبر SHA-256 فقط لتطبيع المفتاح إلى 32 بايت </blockquote><p style=";text-align:right;direction:rtl">  بالنسبة للعقدة الأولى (أي عندما لا يوجد شيء لتحديده كعنوان التمهيد) ، يتم تخطي الخطوة 9.  العلم - <code>--standalone</code> . </p><br><p style=";text-align:right;direction:rtl">  <strong>مثال 1 - إنشاء أول موقع عام</strong> </p><br><p style=";text-align:right;direction:rtl">  العنوان العام هو <code>1.2.3.4</code> </p><br><p style=";text-align:right;direction:rtl"> <code>sudo tinc-boot gen --standalone -a 1.2.3.4</code> </p> <br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  يسمح لك العلم <code>-a</code> بتحديد العناوين المتاحة للجمهور </li></ul><br><p style=";text-align:right;direction:rtl">  <strong>مثال 1 - إضافة عقدة غير عامة إلى الشبكة</strong> </p><br><p style=";text-align:right;direction:rtl">  سيتم أخذ عقدة التمهيد من المثال أعلاه.  يجب أن يكون لدى المضيف bootnode tinc-boot (الموصوف لاحقًا). </p><br><p style=";text-align:right;direction:rtl"> <code>sudo tinc-boot gen --token "MY TOKEN" http://1.2.3.4:8655</code> </p> <br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  علامة - العلامة تعيين رمز التفويض </li></ul><br><h2 id="modul-nachalnoy-zagruzki" style=";text-align:right;direction:rtl">  وحدة التمهيد </h2><br><p style=";text-align:right;direction:rtl">  تثير <code>tinc-boot bootnode</code> خادم HTTP مع API لتبادل المفاتيح الأساسية مع عملاء جدد. </p><br><p style=";text-align:right;direction:rtl">  افتراضيًا ، <code>8655</code> المنفذ <code>8655</code> . </p><br><p style=";text-align:right;direction:rtl">  المبسطة ، يمكن وصف الخوارزمية على النحو التالي: </p><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  قبول طلب من عميل </li><li style=";text-align:right;direction:rtl">  فك تشفير والتحقق من الطلب باستخدام xchacha20poly1305 ، باستخدام متجه التهيئة الذي تم تمريره أثناء الطلب ، وحيث يكون مفتاح التشفير هو نتيجة وظيفة sha256 من الرمز المميز </li><li style=";text-align:right;direction:rtl">  تحقق الاسم </li><li style=";text-align:right;direction:rtl">  احفظ الملف إذا لم يكن هناك ملف يحمل نفس الاسم حتى الآن </li><li style=";text-align:right;direction:rtl">  تشفير وتوقيع ملف المضيف الخاص بك واسم باستخدام الخوارزمية المذكورة أعلاه </li><li style=";text-align:right;direction:rtl">  العودة إلى البند 1 </li></ol><br><p style=";text-align:right;direction:rtl">  معًا ، تكون عملية تبادل المفاتيح الأساسية كما يلي: </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/ui/_p/sq/ui_psqswkeazp6yjeggbekuz58m.png"></p><br><p style=";text-align:right;direction:rtl">  <strong>مثال 1 - بدء عقدة التنزيل</strong> </p><br><p style=";text-align:right;direction:rtl">  من المفترض أن التهيئة الأولية للعقدة تم تنفيذها ( <code>tinc-boot gen</code> ) </p><br><p style=";text-align:right;direction:rtl"> <code>tinc-boot bootnode --token "MY TOKEN"</code> </p> <br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  علامة - العلامة تعيين رمز التفويض.  يجب أن تكون هي نفسها للعملاء المتصلين بالمضيف. </li></ul><br><p style=";text-align:right;direction:rtl">  <strong>مثال 2 - بدء عقدة التنزيل كخدمة</strong> </p><br><p style=";text-align:right;direction:rtl"> <code>tinc-boot bootnode --service --token "MY TOKEN"</code> </p> <br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <code>--service</code> علامة <code>--service</code> إلى إنشاء خدمة systemd (بشكل افتراضي ، على سبيل المثال ، <code>tinc-boot-dnet.service</code> ) </li><li style=";text-align:right;direction:rtl">  علامة - العلامة تعيين رمز التفويض.  يجب أن تكون هي نفسها للعملاء المتصلين بالمضيف. </li></ul><br><h2 id="modul-raspredeleniya-klyuchey" style=";text-align:right;direction:rtl">  وحدة التوزيع الرئيسية </h2><br><p style=";text-align:right;direction:rtl">  تقوم وحدة توزيع المفاتيح ( <code>tinc-boot monitor</code> ) برفع خادم HTTP مع واجهة برمجة التطبيقات لتبادل المفاتيح مع العقد الأخرى <strong>داخل VPN</strong> .  تم إصلاحه على العنوان الصادر عن الشبكة (المنفذ الافتراضي هو <code>1655</code> ، ولن يكون هناك أي تعارض مع العديد من الشبكات ، لأن كل شبكة لها / يجب أن يكون لها عنوانها الخاص). </p><br><p style=";text-align:right;direction:rtl">  تبدأ الوحدة وتعمل تلقائيًا بالكامل: لا تحتاج إلى العمل معها في الوضع اليدوي. </p><br><p style=";text-align:right;direction:rtl">  تبدأ هذه الوحدة تلقائيًا عندما تكون الشبكة في وضع التشغيل (في البرنامج النصي <code>tinc-up</code> ) وتتوقف تلقائيًا عند توقفها (في البرنامج النصي <code>tinc-down</code> ). </p><br><p style=";text-align:right;direction:rtl">  يدعم العمليات: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <code>GET /</code> - إعطاء ملف العقدة الخاص بك </li><li style=";text-align:right;direction:rtl">  <code>POST /rpc/watch?node=&lt;&gt;&amp;subnet=&lt;&gt;</code> - التقط ملفًا من عقدة أخرى ، مع افتراض وجود خدمة مماثلة تعمل عليه.  بشكل افتراضي ، يتم إنهاء المحاولات في 10 ثوانٍ ، كل 30 ثانية حتى النجاح أو الإلغاء. </li><li style=";text-align:right;direction:rtl">  <code>POST /rpc/forget?node=&lt;&gt;</code> - اترك محاولات (إن وجدت) لالتقاط الملف من عقدة أخرى </li><li style=";text-align:right;direction:rtl">  <code>POST /rpc/kill</code> - ينهي الخدمة </li></ul><br><p style=";text-align:right;direction:rtl">  بالإضافة إلى ذلك ، كل دقيقة (بشكل افتراضي) وعندما يتم استلام ملف تكوين جديد ، يتم فهرسة العقد المحفوظة للعقد العامة الجديدة.  عند اكتشاف العقد ذات علامة <code>Address</code> ، تتم إضافة إدخال إلى ملف تكوين <code>tinc.conf</code> للتوصية بالاتصال عند إعادة التشغيل. </p><br><h2 id="modul-raspredeleniya-klyuchey-upravlenie" style=";text-align:right;direction:rtl">  وحدة توزيع المفاتيح (الإدارة) </h2><br><p style=";text-align:right;direction:rtl">  يتم تنفيذ أوامر الطلب ( <code>tinc-boot watch</code> ) وإلغاء طلب ( <code>tinc-boot forget</code> ) لملف التكوين من العقد الأخرى تلقائيًا عند اكتشاف عقدة جديدة (البرنامج النصي <code>subnet-up</code> ) وإيقافها (البرنامج النصي <code>subnet-down</code> ) ، على التوالي. </p><br><p style=";text-align:right;direction:rtl">  في عملية إيقاف الخدمة ، يتم <code>tinc-down</code> البرنامج النصي <code>tinc-down</code> والذي يتوقف فيه الأمر <code>tinc-boot kill</code> عن وحدة توزيع المفاتيح. </p><br><h1 id="vmesto-itogo" style=";text-align:right;direction:rtl">  بدلا من المجموع </h1><br><p style=";text-align:right;direction:rtl">  تم إنشاء هذه الأداة تحت تأثير التنافر المعرفي بين عبقرية مطوري Tinc والتعقيد الخطي المتزايد لإنشاء عقد جديدة. </p><br><p style=";text-align:right;direction:rtl">  كانت الأفكار الرئيسية في عملية التطوير: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  إذا كان هناك شيء يمكن أن يكون آليا ، يجب أن يكون آليا ؛ </li><li style=";text-align:right;direction:rtl">  يجب أن تغطي القيم الافتراضية 80٪ على الأقل من الاستخدام (مبدأ باريتو) ؛ </li><li style=";text-align:right;direction:rtl">  يمكن إعادة تعريف أي قيمة باستخدام كل من الأعلام ومتغيرات البيئة ؛ </li><li style=";text-align:right;direction:rtl">  يجب أن تساعد الأداة المساعدة ، ولا تتسبب في الرغبة في استدعاء كل عقوبة السماء على الخالق ؛ </li><li style=";text-align:right;direction:rtl">  يعد استخدام رمز التفويض للتهيئة الأولية مخاطرة واضحة ، ومع ذلك ، فقد تم تصغيره إلى الحد الأدنى نظرًا للتشفير الكلي والمصادقة (لا يمكن استبدال اسم العقدة في رأس الاستجابة). </li></ul><br><p style=";text-align:right;direction:rtl">  القليل من التسلسل الزمني: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  أول مرة اعتدت فيها على الخندق منذ أكثر من 4 سنوات.  درس كمية كبيرة من المواد.  قم بإعداد شبكة مثالية (في رأيي) </li><li style=";text-align:right;direction:rtl">  بعد نصف عام ، تم استبدال القصدير لصالح zerotier ، كأداة أكثر ملاءمة / مرونة </li><li style=";text-align:right;direction:rtl">  منذ عامين ، قدمت كتاب قواعد اللعبة ansible لنشر tinc </li><li style=";text-align:right;direction:rtl">  بعد شهر ، تعطل البرنامج النصي الخاص بي عند النشر التزايدي (أي عندما يكون من المستحيل الوصول إلى جميع عقد الشبكة ، مما يعني توزيع المفاتيح) </li><li style=";text-align:right;direction:rtl">  قبل أسبوعين ، كتبت نصًا نصيًا عن bash-script كان النموذج الأولي لـ <code>tinc-boot</code> </li><li style=";text-align:right;direction:rtl">  قبل 3 أيام من التكرار الثاني ، وُلدت النسخة الأولى (0.0.1 على وجه الدقة) من الأداة </li><li style=";text-align:right;direction:rtl">  منذ يوم واحد ، قمت بتخفيض تثبيت عقدة جديدة إلى سطر واحد: <code>curl -L https://github.com/reddec/tinc-boot/releases/latest/download/tinc-boot_linux_amd64.tar.gz | sudo tar -xz -C /usr/local/bin/ tinc-boot</code> <code>curl -L https://github.com/reddec/tinc-boot/releases/latest/download/tinc-boot_linux_amd64.tar.gz | sudo tar -xz -C /usr/local/bin/ tinc-boot</code> </li><li style=";text-align:right;direction:rtl">  قريباً ، ستتم إضافة إمكانية اتصال أبسط بالشبكة (دون التضحية بالأمان) </li></ul><br><p style=";text-align:right;direction:rtl">  أثناء التطوير ، قمت باختبار فعال على خوادم حقيقية وعملاء (الصورة مأخوذة من وصف tinc أعلاه مأخوذة من الحياة الحقيقية).  يعمل النظام الآن بلا عيوب ، ويتم الآن تعطيل جميع خدمات VPN التابعة لجهات أخرى. </p><br><p style=";text-align:right;direction:rtl">  رمز التطبيق مكتوب في <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">GO وهو مفتوح</a> تحت رخصة MPL 2.0.  يسمح الترخيص (ترجمة مجانية) للاستخدام التجاري (إذا احتاج شخص ما فجأة) دون فتح المنتج المصدر.  الشرط الوحيد هو أنه يجب نقل التغييرات إلى المشروع. </p><br><p style=";text-align:right;direction:rtl">  تجمع الطلبات هي موضع ترحيب. </p><br><h1 id="poleznye-ssylki" style=";text-align:right;direction:rtl">  روابط مفيدة </h1><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">مستودع</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">وثائق تينك</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar468213/">https://habr.com/ru/post/ar468213/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar468195/index.html">لماذا تعتمد أموالي على الخط المباشر؟</a></li>
<li><a href="../ar468197/index.html">كيف نفعل أتمتة شبكة قديمة كبيرة</a></li>
<li><a href="../ar468203/index.html">الألغاز على السعي للحصول على فرصة مثالية</a></li>
<li><a href="../ar468205/index.html">حصلت من الداخل: مقدمة (ترجمة)</a></li>
<li><a href="../ar468207/index.html">كيف قمنا بتحديث Zabbix</a></li>
<li><a href="../ar468217/index.html">الدكتور جيكيل والسيد هايد ثقافة الشركات</a></li>
<li><a href="../ar468219/index.html">آليات القابلية للتوسعة في JavaScript</a></li>
<li><a href="../ar468223/index.html">Habr Weekly # 19 / BT-door للقطط ، لماذا تغش الذكاء الاصطناعى ، ماذا تطلب من صاحب العمل المستقبلي ، يوم واحد مع iPhone 11 Pro</a></li>
<li><a href="../ar468227/index.html">تسريع instagram.com. الجزء 1</a></li>
<li><a href="../ar468229/index.html">ملاحظة على باطلة في جافا سكريبت و TypeScript</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>