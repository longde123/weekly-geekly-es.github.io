<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👳 🧤 👨🏼‍🔧 Bagaimana Saluran Pusher Mengirimkan 10.000.000.000.000 Pesan Sudah 🖐🏾 🚑 ⏯️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hai Baru-baru ini saya menemukan deskripsi yang agak menarik tentang arsitektur Saluran Pusher dan memutuskan untuk menerjemahkannya untuk Anda. Menur...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Bagaimana Saluran Pusher Mengirimkan 10.000.000.000.000 Pesan Sudah</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/415337/"><p> <em>Hai</em>  <em>Baru-baru ini saya menemukan deskripsi yang agak menarik tentang arsitektur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Saluran Pusher</a> dan memutuskan untuk menerjemahkannya untuk Anda.</em>  <em>Menurut pendapat saya, penulis sangat mudah menggambarkan pendekatan untuk membangun arsitektur yang sangat dimuat dan terukur.</em>  <em>Kemungkinan besar, artikel ini akan bermanfaat bagi pemula, serta spesialis dari bidang terkait.</em> </p><br><p>  Di kantor Pusher, kami memiliki loket kecil dengan jumlah yang terus meningkat.  Ini menunjukkan jumlah pesan yang dikirim untuk seluruh keberadaan Saluran Pusher.  Pada hari Jumat pukul 22.20 UTC, jumlahnya meningkat satu kategori dan mencapai 10.000.000.000.000.  Ini memiliki 13 nol - 10 triliun. </p><br><p><img src="https://habrastorage.org/webt/za/kb/dw/zakbdwmmhgz5p8hg5oxvhbi-jdc.jpeg"></p><br><p>  Anda mungkin berpikir bahwa jumlah total pesan adalah metrik bengkak yang tidak berguna.  Tetapi angka itu adalah indikator kunci keberhasilan Pusher Channels, produk komunikasi waktu-nyata kami.  Pertama, penghitung ini mencerminkan kepercayaan yang diberikan kepada kami oleh pengguna.  Kedua, ini mengukur skalabilitas sistem kami.  Untuk menambah jumlahnya, kami di Pusher harus memastikan bahwa pengguna memercayai pengiriman pesan ke layanan kami, dan kami harus yakin bahwa sistem kami mampu memproses pesan-pesan ini.  Tapi apa yang harus kita sampaikan 10 triliun pesan?  Ayo lihat. </p><a name="habracut"></a><br><p>  Sekitar 200.000 pesan dikirim per detik melalui Saluran Pusher, dan jutaan di waktu puncak.  Misalnya, ketika New York Times menggunakan layanan ini untuk memberi informasi kepada para pembacanya tentang kemajuan pemilihan presiden AS. </p><br><p>  Mari pertama-tama kita melihat Pusher Channels sebagai kotak hitam besar tempat semua pesan ini dikirimkan: </p><br><p><img src="https://habrastorage.org/webt/q8/ly/tt/q8lyttjmuao2gkkgkfbjavnx120.png"></p><br><p>  Saluran Pusher adalah sistem tipe publish-subscribe.  Klien berlangganan saluran (misalnya, "btc-usd" atau "private-user-jim"), sementara klien lain mengirim pesan kepada mereka.  Jika satu juta orang berlangganan saluran "btc-usd" dan seseorang mengirim biaya bitcoin sebenarnya di sana, maka Saluran Pusher perlu mengirimkan sejuta pesan.  Kami melakukan ini dalam beberapa milidetik. </p><br><p>  Satu server tidak dapat mengirimkan begitu banyak pesan dalam waktu yang singkat.  Oleh karena itu, kami menggunakan tiga teknik yang telah teruji waktu: fan-out, sharding, dan load balancing.  Mari kita lihat apa yang ada di kotak hitam. </p><br><p><img src="https://habrastorage.org/webt/fe/vx/rx/fevxrxzehjg1squjlnjqoa473sq.png"></p><br><p>  Jutaan pelanggan didistribusikan di sekitar 170 server canggih, yang masing-masing memiliki sekitar 20.000 koneksi.  Setiap server seperti itu mengingat daftar saluran yang menarik bagi pelanggannya dan berlangganan mereka di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">layanan Redis</a> pusat.  Bahkan jika 2000 klien tertarik pada "btc-usd" di server tepi, ia hanya perlu berlangganan sekali.  Dengan demikian, ketika pesan baru tiba di saluran, Redis mengirim 170 pesan ke server tepi, yang sudah mengirim 20.000 pesan ke pelanggan mereka.  Pendekatan ini disebut fan-out. </p><br><p>  Tetapi hanya fan-out saja tidak cukup bagi kami, karena masih ada satu komponen Redis sentral yang melaluinya semua yang mengirim pesan pergi.  Sentralisasi ini membatasi jumlah pesan yang dikirim per detik.  Untuk mengatasi keterbatasan ini, layanan Redis pusat terdiri dari banyak pecahan Redis.  Setiap saluran, pada gilirannya, dilampirkan ke Redis-shard dengan mencantumkan namanya.  Ketika klien ingin mengirim pesan, ia pergi ke layanan sisanya.  Yang terakhir hash nama saluran dan, berdasarkan hasilnya, menentukan Redis shard yang diperlukan untuk mana pesan harus dikirim.  Pendekatan ini disebut sharding. </p><br><p>  Sepertinya kami baru saja memindahkan sentralisasi dari layanan Redis ke layanan lainnya.  Tetapi tidak demikian, karena layanan sisanya itu sendiri terdiri dari sekitar 90 server yang melakukan pekerjaan yang sama: mereka menerima permintaan untuk publikasi, menghitung Redis-shard dan mengirim pesan kepada mereka.  Ketika penerbit ingin mengirim pesan, ia pergi ke salah satu dari banyak server lainnya.  Pendekatan ini disebut load balancing. </p><br><p>  Bersama fan-out, sharding dan load balancing memungkinkan sistem memiliki satu komponen utama.  Properti ini adalah kunci untuk mencapai skalabilitas horizontal, yang memungkinkan pengiriman jutaan pesan per detik. </p><br><p>  Kami memeriksa komponen utama layanan Pusher Channels, tetapi ada bagian lain, seperti metrik (bagaimana kami mendapatkan jumlah 10 triliun ini), webhooks (bagaimana kami memberi tahu pelanggan tentang peristiwa menarik), otorisasi (membatasi akses ke saluran), data aktif pengguna, pembatasan tingkat (bagaimana kami memastikan bahwa pelanggan kami menggunakan sumber daya persis sebanyak yang mereka bayar, dan bahwa mereka tidak mengganggu pelanggan lain).  Semua fungsi tambahan ini harus dilaksanakan tanpa mengorbankan bandwidth, waktu pengiriman pesan dan ketersediaan layanan kami secara keseluruhan. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id415337/">https://habr.com/ru/post/id415337/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id415327/index.html">Teorema Pythagoras digunakan oleh pembangun Stonehenge 2000 tahun sebelum kelahiran Pythagoras sendiri</a></li>
<li><a href="../id415329/index.html">Seluruh kebenaran tentang RTOS dari Colin Walls. Artikel # 3. Tugas dan Perencanaan</a></li>
<li><a href="../id415331/index.html">Printer konstruksi untuk percetakan 5-6 lantai diproduksi di Yaroslavl</a></li>
<li><a href="../id415333/index.html">Arduino - pemancar siaran AM berkemampuan mikro</a></li>
<li><a href="../id415335/index.html">Tutorial latar belakang Android. Bagian 5: Coroutine di Kotlin</a></li>
<li><a href="../id415341/index.html">Kursus Administrasi PostgreSQL</a></li>
<li><a href="../id415343/index.html"># 2HACKATON untuk profesional muda di Perm</a></li>
<li><a href="../id415345/index.html">Kiat untuk memutuskan menjadi pengembang iOS</a></li>
<li><a href="../id415347/index.html">2. Berdasarkan Meyers “C ++ Efektif dan Modern” - detail inferensi tipe template untuk array</a></li>
<li><a href="../id415349/index.html">Kubernetes 1.11: ikhtisar inovasi utama</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>