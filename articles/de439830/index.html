<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👏🏾 🛃 📭 Inside Quake: Immer Alternativen in Betracht ziehen 🙎🏿 📄 🎗️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Der Programmierer Michael Abrash, der Mitte der 90er Jahre von John Carmack eingeladen wurde, am Motor des ersten Bebens zu arbeiten, schrieb während ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Inside Quake: Immer Alternativen in Betracht ziehen</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/439830/"><div style="text-align:center;"><img src="https://steemitimages.com/p/USgKopgPmA7SYpFB96Gheb9tK3fTW7Ck3gsGQ8tb7V8UbQnEKC6SXDMMhx5idgb5LV6sCECsXeG3Sjto2AXKzN" alt="Bild"></div><br>  <i>Der Programmierer Michael Abrash, der Mitte der 90er Jahre von John Carmack eingeladen wurde, am Motor des ersten Bebens zu arbeiten, schrieb während des Entwicklungsprozesses eine Reihe von Artikeln.</i>  <i>Dies ist die zweite Spalte in dieser Reihe.</i>  <i>Die Übersetzung des ersten ist <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> .</i> <br><br>  Ich muss zugeben: Ich habe den klassischen Rock satt.  Das letzte Mal vor ungefähr 20 Jahren war ich glücklich, etwas von Cars oder Boston zu hören.  Außerdem hat mich Bob Seager und Queen, ganz zu schweigen von Elvis, nie besonders angezogen, so wenig hat sich geändert.  Aber ich erkannte, dass sich etwas änderte, als ich das Radio umschalten wollte, als ich Allman Brothers oder Steely Dan oder Pink Floyd oder, Gott, vergib mir, die Beatles hörte (aber nur bei Dingen wie „Hallo Auf Wiedersehen“ und „Ich werde Weinen Sie stattdessen, nicht Ticket to Ride oder Ein Tag im Leben; so weit bin ich noch nicht gegangen).  Es dauerte nicht lange, die Gründe dafür zu finden;  Ich habe ein Vierteljahrhundert lang dieselben Songs gehört und bin einfach müde geworden. <br><br>  Ich erzähle es so, denn als meine Tochter und ich eines Abends aus dem Café fuhren, wurde der Radiosender „Es gibt keine Alternative“ zum ersten Mal im Auto eingeschaltet. <br><br>  Wir sprechen von einem zehnjährigen Mädchen, das mit einer ständigen Diät alter Hits aufgewachsen ist.  Sie mag Melodien, eingängige Lieder und gute Sänger.  Sie werden nichts davon finden, wenn Sie eine alternative Rockstation hören.  Daher ist es nicht verwunderlich, dass sie beim Einschalten des Radios zuerst sagte: "Fu!" <br><br>  Aber Folgendes hat mich überrascht: Nachdem sie eine Weile zugehört hatte, sagte sie: "Weißt du, Papa, aber das ist wirklich interessant." <br><br>  Dies deutete mich nicht nur darauf hin, welche Art von Musik im ganzen Haus rumpeln würde, wenn sie ein Teenager wurde.  Ihre schnelle Übernahme von Alternative Rock (verglichen mit meiner Faszination für die Musik meiner eigenen Jugend seit zehn Jahren) erinnerte mich an etwas, das leicht vergessen wird, wenn man älter wird und sich der Lebensstil festsetzt.  Dies erinnerte mich daran, dass es notwendig war, offen zu bleiben und darauf vorbereitet zu sein, neue Dinge auszuprobieren. <a name="habracut"></a>  Programmierer neigen dazu, an vertraute Ansätze gebunden zu sein, und neigen dazu, sie zu verwenden, wenn sie die Aufgaben angemessen bewältigen.  Aber es gibt immer Alternativen zur Programmierung, und ich finde, dass es sich oft lohnt, sie zu erkunden. <br><br>  Aber angesichts der sich ständig ändernden Natur von <u>Quake</u> sollte ich eine solche Erinnerung wirklich nicht brauchen. <br><br><h2>  Kreativer Stream </h2><br>  Im Januar habe ich einen kreativen Stream beschrieben, der John Carmack dazu veranlasste, vorberechnete PVS-Polygone (Potential Visible Set) für jeden möglichen Standpunkt in <u>Quake</u> (einem Spiel, das wir gemeinsam in id Software entwickeln) zu verwenden.  Vorläufige Berechnung von PVS bedeutet, dass wir nicht viel Zeit damit verbringen müssen, die Datenbank der Polygone zu durchsuchen, die aus der aktuellen Sicht in der Weltdatenbank sichtbar ist, sondern einfach alle Polygone in der PVS von hinten nach vorne zeichnen können (die Reihenfolge aus dem BSP-Baum der Welt übernehmen; Diskussion über BSP- Sehen Sie sich die Bäume in unseren Spalten für Mai, Juli und November 1995 an und lassen Sie die Szene vollständig korrekt rendern, ohne zu suchen. Dadurch kann der letzte Schritt der Entfernung versteckter Oberflächen (HSR) rückwärts gerendert werden.  Es war eine großartige Idee, aber für die Quake-Architektur ist der Pfad noch nicht abgeschlossen. <br><br><h2>  Bewegte Objekte zeichnen </h2><br>  Zum Beispiel gab es immer noch eine Frage, wie sich bewegende Objekte richtig sortiert und gezeichnet werden können.  Tatsächlich wurde diese Frage nach der Januar-Kolumne am meisten gestellt, also werde ich ihr Zeit geben.  Das Hauptproblem besteht darin, dass ein sich bewegendes Modell in mehrere BSP-Blätter fallen kann. Wenn sich das Modell bewegt, ändern sich diese Blätter.  Zusammen mit der Möglichkeit, mehrere Modelle in einem Blatt zu finden, bedeutet dies, dass es keine einfache Möglichkeit gibt, die BSP-Reihenfolge zu verwenden, um Modelle in einer korrekt sortierten Reihenfolge zu zeichnen.  Als ich die Januar-Kolumne schrieb, zeichneten wir Sprites (wie Explosionen), bewegliche BSP-Modelle (wie Türen) und polygonale Modelle (wie Monster), schnitten sie mit den Blättern ab, die sie berührten, und zeichneten dann die entsprechenden Teile, wenn jedes BSP-Blatt erreicht war Sie sind dran, wenn Sie von hinten nach vorne gehen.  Dies löste jedoch nicht das Problem, mehrere sich bewegende Modelle in einem Blatt relativ zueinander zu sortieren, und hinterließ auch unangenehme Probleme bei komplexen polygonalen Modellen. <br><br>  John hat das Sortierproblem für Sprites und Polygonmodelle auf überraschend einfache Weise gelöst: Jetzt schreiben wir sie in den Z-Puffer.  (Das heißt, bevor wir jedes Pixel zeichnen, vergleichen wir den Abstand oder z mit dem z-Wert des bereits auf dem Bildschirm angezeigten Pixels. Ein neues Pixel wird nur gezeichnet, wenn es näher als das vorhandene Pixel ist.) Zuerst zeichnen wir die Hauptwelt - Wände, Decken usw. so.  Zu diesem Zeitpunkt wird kein <u>Test des</u> Z-Puffers verwendet (wie wir bald sehen werden, wird die Definition der sichtbaren Oberflächen der Welt auf andere Weise durchgeführt);  Wir <u>füllen den</u> Z-Puffer jedoch <u>mit</u> Z-Werten (tatsächlich 1 / Z-Werte, wie unten beschrieben) für alle Pixel auf der Welt.  Das Füllen eines Z-Puffers ist ein viel schnellerer Prozess als das Z-Puffern der ganzen Welt, da es kein Lesen, keine Vergleiche, nur das Schreiben von Z-Werten gibt.  Nachdem wir das Zeichnen abgeschlossen und den Z-Puffer der Welt ausgefüllt haben, können wir einfach Sprites und polygonale Modelle mit Z-Puffer zeichnen und die perfekte Sortierung erhalten. <br><br>  Bei Verwendung des Z-Puffers stellen sich zwangsläufig Fragen: Wie wirkt sich dies auf den belegten Speicher und die Leistung aus?  Bei einer Auflösung von 320 x 200 werden 128 KB Speicher benötigt, was nicht trivial ist, aber nicht so sehr für ein Spiel, für dessen Funktion 8 MB erforderlich sind.  Auswirkungen auf die Leistung: ca. 10% beim Füllen des Z-Puffers der Welt und ca. 20% (Indikatoren variieren stark) beim Rendern von Sprites und polygonalen Modellen.  Im Gegenzug erhalten wir eine perfekt sortierte Welt sowie die Möglichkeit, zusätzliche Effekte zu erzielen, z. B. Explosionen und Rauch von Partikeln, da Sie mit dem Z-Puffer diese Effekte einfach in der Welt sortieren können.  Im Allgemeinen hat die Verwendung von Z-Buffer die visuelle Qualität und Flexibilität der Quake-Engine erheblich verbessert und den Code auf Kosten angemessener Speicherkosten und Leistung erheblich vereinfacht. <br><br><h2>  Nivellierung und Steigerung der Produktivität </h2><br>  Wie ich oben sagte, zeichnet die <u>Quake-</u> Architektur zuerst die Welt selbst, ohne den Z-Puffer zu lesen oder zu vergleichen, und füllt den Z-Puffer nur mit den Werten der Polygone der Welt in z.  Danach werden sich bewegende Objekte mit vollständiger Z-Pufferung über die Welt gezeichnet.  Bisher habe ich nur darüber gesprochen, wie man sich bewegende Objekte zeichnet.  Im Rest der Spalte werde ich über einen anderen Teil der Rendering-Gleichung sprechen - das Zeichnen der Welt selbst, wenn die ganze Welt als ein BSP-Baum gespeichert ist und sich nie bewegt. <br><br>  Wie Sie sich aus der Januar-Kolumne erinnern können, waren wir sowohl über die Rohleistung als auch über die Mittelung besorgt.  Das heißt, wir wollten, dass der Rendering-Code so schnell wie möglich und gleichzeitig ausgeführt wird, damit der Unterschied zwischen der Rendergeschwindigkeit der mittleren Szene und der langsamsten beim Rendern der Szene so gering wie möglich ist.  Es gibt nichts Gutes in den durchschnittlichen 30 Bildern pro Sekunde, wenn 10% der Szenen mit 5 fps gezeichnet werden, da das Ruckeln in solchen Szenen im Vergleich zur durchschnittlichen Szene extrem auffällig ist.  In 100% der Fälle ist es besser, die Frequenz mit 15 Bildern pro Sekunde zu mitteln, obwohl die durchschnittliche Rendergeschwindigkeit halb so hoch ist. <br><br>  Vorberechnete PVS waren ein wichtiger Schritt in Richtung einer höheren und ausgewogeneren Leistung, da keine sichtbaren Polygone mehr bestimmt werden mussten - eine eher langsame Phase, die sich in den komplexesten Szenen am schlechtesten zeigte.  Trotzdem enthalten vorberechnete PVS an einigen Orten mit realen Spielstufen fünfmal mehr Polygone als tatsächlich gesehen wird.  In Verbindung mit der Entfernung von rückwärts versteckten Oberflächen (HSR) wurden „heiße Zonen“ geschaffen, in denen die Bildrate spürbar reduziert wurde.  Hunderte von Polygonen wurden von hinten nach vorne gezogen, und die meisten von ihnen wurden sofort von engeren Polygonen neu gezeichnet.  Die Rohleistung insgesamt verringerte sich ebenfalls um durchschnittlich 50% der Neuzeichnung, die durch das Rendern aller Elemente im PVS verursacht wurde.  Obwohl das Rendern von Rückwärts-PVS-Sets als letzte Stufe des HSR fungierte und eine Verbesserung gegenüber der vorherigen Architektur darstellte, war es daher nicht ideal.  John dachte, es gäbe wahrscheinlich einen besseren Weg, PVS zu verwenden, als von vorne nach hinten zu zeichnen. <br><br>  Und er wurde tatsächlich gefunden. <br><br><h2>  Sortierte Intervalle </h2><br>  Die ideale letzte HSR-Stufe für Quake bestand darin, alle Polygone im PVS zu verwerfen, die sich tatsächlich als unsichtbar herausstellten, und nur die sichtbaren Pixel der verbleibenden Polygone zu zeichnen, ohne sie neu zu zeichnen.  Das heißt, jedes Pixel würde natürlich genau einmal und ohne Leistungsverlust gezeichnet.  Eine Lösung (die jedoch Kosten erfordert) besteht darin, von vorne nach hinten zu zeichnen, den Bereich zu speichern, der die aktuell überlappenden Teile des Bildschirms beschreibt, und jedes Polygon vor dem Rendern mit den Rändern dieses Bereichs abzuschneiden.  Es klingt vielversprechend, erinnert aber in etwa an die Bündelbaumlösung, die ich in der Januar-Kolumne beschrieben habe.  Wie wir herausgefunden haben, erfordert dieser Ansatz eine Verschwendung zusätzlicher Ressourcen und hat ernsthafte Probleme mit dem Lastausgleich. <br><br>  Sie können es viel besser machen, wenn Sie den letzten HSR-Schritt von der Polygonebene auf die Intervallebene verschieben und die Lösung mit sortierten Intervallen verwenden.  Im Wesentlichen besteht dieser Ansatz darin, jedes Polygon in eine Reihe von Intervallen umzuwandeln, wie in Abbildung 1 gezeigt, und anschließend die Intervalle relativ zueinander zu sortieren und abzuschneiden, bis nur noch sichtbare Teile der sichtbaren Intervalle zum Rendern übrig bleiben, wie in Abbildung 2 dargestellt Sehr ähnlich der Z-Pufferung (die, wie oben erwähnt, zu langsam ist, um beim Rendern der Welt verwendet zu werden, obwohl sie für kleinere sich bewegende Objekte geeignet ist), aber es gibt wichtige Unterschiede.  Im Gegensatz zur Z-Pufferung werden nur die sichtbaren Teile der sichtbaren Intervalle Pixel für Pixel gescannt (obwohl alle Kanten der Polygone noch gerastert werden müssen).  Noch besser ist, dass die durch Z-Pufferung für jedes Pixel durchgeführte Sortierung zu einer Intervalloperation mit sortierten Intervallen wird, und da eine integrale Eigenschaft der Intervallliste die Verbundenheit ist, wird jede Kante nur relativ zu einigen Intervallen in derselben Zeile sortiert und nur um einige Intervalle abgeschnitten, wenn horizontale Überlagerung.  Obwohl die Verarbeitung komplexer Szenen immer noch länger dauerte als einfache, waren die schlimmsten Fälle nicht so schlimm wie bei der Verwendung von Beam-Bäumen oder beim Sortieren von hinten nach vorne, da keine Neuzeichnung und Suche nach versteckten Pixeln erfolgt, die Komplexität durch die Pixelauflösung begrenzt ist und die Intervallkonnektivität die Sortierung der schlimmsten begrenzt Fälle in einem beliebigen Bereich des Bildschirms.  Als Bonus erfolgt die Ausgabe sortierter Intervalle in der Form, die ein Rasterizer auf niedriger Ebene benötigt: im Format einer Reihe von Intervalldeskriptoren, von denen jede aus einer Koordinate des Anfangs und der Länge besteht. <br><br><img src="https://www.bluesnews.com/abrash/images/66_fig1.gif"><br><br>  <i>Intervallgenerierung</i> <br><br>  Kurz gesagt, die Lösung mit sortierten Intervallen liegt ziemlich nahe an unseren ursprünglichen Kriterien.  Obwohl es keine Kosten spart, sind sie immer noch nicht ganz schrecklich.  Das Neuzeichnen und Scannen von Pixeln der überlappenden Teile der Polygone wird vollständig eliminiert, und im schlimmsten Fall kann die Leistung ausgeglichen werden.  Wir würden uns nicht nur auf sortierte Intervalle als Mechanismus zur Beseitigung verborgener Oberflächen verlassen, sondern vorberechnete PVS reduzieren die Anzahl der Polygone auf ein Niveau, das sortierte Intervalle gut genug handhaben. <br><br>  Wir haben also den Ansatz gefunden, den wir brauchen.  es bleibt nur der Code zu schreiben und das ist vorbei, oder?  Ja und nein.  Der konzeptionelle Ansatz mit sortierten Intervallen ist einfach, aber überraschend schwer zu implementieren: Sie müssen einige wichtige Entwurfsentscheidungen treffen, es erfordert ein wenig Mathematik und es gibt listige Fallstricke.  Schauen wir uns zuerst die Designlösungen an. <br><br><h2>  Rippen gegen Intervalle </h2><br>  Die erste Entscheidung besteht darin, auszuwählen, was sortiert werden soll: Intervalle oder Kanten (beide Konzepte gehören zur allgemeinen Kategorie der „sortierten Intervalle“).  Obwohl die Ergebnisse in beiden Fällen gleich sind (eine Liste von Intervallen, die ohne erneutes Zeichnen gezeichnet werden müssen), sind Implementierungen und Auswirkungen auf die Leistung sehr unterschiedlich, da Sortieren und Abschneiden durch sehr unterschiedliche Datenstrukturen durchgeführt werden. <br><br>  Beim Sortieren von Intervallen werden diese Intervalle in Speichersegmenten gespeichert, die nach x verknüpften Listen sortiert sind, normalerweise ein Segment pro Rasterzeile.  Jedes Polygon wird wiederum in Intervalle gerastert, wie in Abbildung 1 gezeigt. Jedes Intervall wird sortiert und in das Speichersegment der Rasterzeile abgeschnitten, in der sich das Intervall befindet, wie in Abbildung 2 dargestellt, sodass zu jedem Zeitpunkt jedes Segment die nächsten angetroffenen Intervalle enthält , immer ohne Überlagerungen.  Bei diesem Ansatz müssen nacheinander alle Intervalle für jedes Polygon generiert werden, und jedes Intervall wird sofort sortiert, abgeschnitten und dem entsprechenden Speichersegment hinzugefügt. <br><br><img src="https://www.bluesnews.com/abrash/images/66_fig2.gif"><br><br>  <i>Abbildung 2: Die Intervalle von Polygon A aus Abbildung 1 werden in Intervallen von Polygon B sortiert und abgeschnitten, während sich Polygon A entlang der Z-Achse in einem konstanten Abstand von 100 und Polygon B entlang der Z-Achse in einem konstanten Abstand von 50 befindet (Polygon B befindet sich näher an der Kamera )</i> <br><br>  Beim Sortieren von Kanten werden diese Kanten in Speichersegmenten gespeichert, die nach x verknüpften Listen entsprechend ihrer anfänglichen Rasterzeile sortiert sind.  Jedes Polygon ist wiederum in Kanten unterteilt, wodurch zusammen eine Liste aller Kanten in der Szene erstellt wird.  Wenn alle Kanten aller Polygone in der Sichtbarkeitspyramide zur Kantenliste hinzugefügt werden, wird die gesamte Liste in einem Durchgang von oben nach unten von links nach rechts gescannt.  Eine Liste der aktiven Kantenlisten (AEL) wird gespeichert.  Bei jedem Schritt zu einer neuen Rasterlinie werden die Kanten, die auf dieser Rasterlinie angezeigt werden, aus dem AEL entfernt, die aktiven Kanten werden zu ihren neuen x-Koordinaten verschoben, die Kanten ab der neuen Rasterlinie werden zum AEL hinzugefügt und die Kanten werden nach der aktuellen x-Koordinate sortiert. <br><br>  Für jede Rasterzeile wird eine nach z sortierte aktive Polygonliste (APL) gespeichert.  Es geht in der Reihenfolge sortiert nach x AEL.  Beim Treffen mit jeder neuen Kante (dh wenn jedes Polygon beginnt oder endet, wenn es sich von links nach rechts bewegt) wird das ihm zugeordnete Polygon aktiviert und in APL sortiert (im Fall einer Startkante), wie in Abbildung 3 gezeigt, oder deaktiviert und aus APL gelöscht ( im Fall einer Hinterkante), wie in Abbildung 4 gezeigt. Wenn sich das nächstgelegene Polygon geändert hat (dh das nächste ist ein neues Polygon oder das nächstgelegene Polygon ist zu Ende), wird für das gerade nicht mehr am nächsten liegende Polygon ein Intervall ab dem Punkt erstellt, an dem sich das Polygon befindet  vym, weil es die am nächsten und enden x-Koordinate der aktuellen Kanten und die aktuellen x-Koordinate in der Deponie aufgenommen, die jetzt in der Nähe.  Diese gespeicherte Koordinate wird später als Beginn des Intervalls verwendet, das erstellt wird, wenn das neue nächste Polygon nicht mehr vorne liegt. <br><br><img src="https://www.bluesnews.com/abrash/images/66_fig3.gif"><br><br>  <i>Abbildung 3: Polygonaktivierung, wenn eine Startkante in AEL erkannt wird.</i> <br><br><img src="https://www.bluesnews.com/abrash/images/66_fig4.gif"><br><br>  <i>Abbildung 4: Deaktivierung des Polygons, wenn in AEL eine Hinterkante erkannt wird.</i> <br><br>  Machen Sie sich keine Sorgen, wenn Sie die oben genannten Punkte nicht vollständig verstehen.  Dies ist nur eine kurze Übersicht über das Sortieren von Kanten, damit der Rest der Spalte klarer wird.  Eine ausführliche Erklärung finden Sie in der nächsten Spalte. <br><br>  Die durch Sortieren von Kanten erzeugten Intervalle scheinen genau die gleichen Intervalle zu sein, die sich aus dem Sortieren der Intervalle ergeben würden.  Der Unterschied liegt in den Zwischendatenstrukturen, die zum Sortieren der Intervalle in der Szene verwendet werden.  Beim Sortieren von Kanten werden die Intervalle innerhalb der Kanten gespeichert, bis der endgültige Satz sichtbarer Intervalle generiert wird. Daher wird das Sortieren, Trimmen und Erstellen von Intervallen durchgeführt, wenn jede Kante ein Polygon hinzufügt oder entfernt, basierend auf dem Status des durch die Kante definierten Intervalls und des Satzes aktiver Polygone.  Beim Sortieren von Intervallen werden die Intervalle sofort sichtbar, wenn jedes Polygon gerastert wird, und diese Zwischenintervalle werden dann sortiert und relativ zu den Intervallen in der Rasterlinie abgeschnitten, um die endgültigen Intervalle zu erstellen.  Daher werden die Zustände der Intervalle ständig explizit festgelegt, und alle Arbeiten werden direkt in Intervallen ausgeführt. <br><br>  Sowohl die Intervallsortierung als auch die Kantensortierung funktionieren gut und wurden erfolgreich in kommerziellen Projekten eingesetzt.  Für Quake haben wir uns für die Kantensortierung entschieden, auch weil sie effizienter zu sein scheint und eine hervorragende horizontale Konnektivität aufweist, die die minimale Sortierzeit bietet, im Gegensatz zu der möglicherweise kostspieligen Sortierung in verknüpfte Listen, die beim Sortieren von Intervallen erforderlich sein kann.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ein wichtigerer Grund war jedoch, dass wir beim Sortieren von Kanten die Kanten zwischen benachbarten Polygonen aufteilen können. Dies reduziert das Sortieren, Trimmen und Rastern von Kanten um etwa die Hälfte und reduziert auch die Weltdatenbank erheblich, da die Kanten häufig werden. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der letzte Vorteil beim Sortieren von Kanten besteht darin, dass nicht zwischen konvexen und konkaven Polygonen unterschieden wird. Für die meisten Grafik-Engines ist dies kein sehr wichtiger Aspekt, aber bei Quake ist das Trimmen, Transformieren, Projizieren und Sortieren von Kanten zum Hauptengpass geworden. Daher tun wir alles, um die Anzahl der Polygone und Kanten zu verringern, und konkave Polygone sind in dieser Hinsicht sehr hilfreich. Konkave Polygone können zwar auch durch Sortierintervalle verarbeitet werden, dies führt jedoch zu einer erheblichen Leistungsminderung.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Es gibt jedoch keine endgültige Antwort auf den besten Ansatz. </font><font style="vertical-align: inherit;">Am Ende erfüllen Sortierintervalle und Sortierkanten eine Funktion, und die Auswahl zwischen ihnen ist eine Frage der Benutzerfreundlichkeit. </font><font style="vertical-align: inherit;">In der nächsten Spalte werde ich mehr über das Sortieren von Kanten mit ihrer vollständigen Implementierung sprechen. </font><font style="vertical-align: inherit;">Im Rest dieser Spalte werde ich den Grundstein für die nächste legen, indem ich über die Sortierschlüssel und die Berechnung von 1 / z spreche. </font><font style="vertical-align: inherit;">Dabei werde ich einige Verweise auf die Aspekte des Sortierens von Kanten machen, die noch nicht im Detail besprochen wurden. </font><font style="vertical-align: inherit;">Ich entschuldige mich, aber das ist unvermeidlich und alles wird erst am Ende der nächsten Spalte klar.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Rippensortiertasten </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nachdem wir nun wissen, dass wir die Sortierung der Kanten auswählen und daraus die Intervalle der Polygone erstellen, die dem Betrachter am nächsten liegen, stellt sich die Frage: Woher wissen Sie, ob diese Polygone am nächsten sind? Im Idealfall speichern wir einfach den Sortierschlüssel jedes Polygons. Wenn eine neue Kante angezeigt wird, vergleichen wir den Schlüssel seiner Oberfläche mit den Schlüsseln anderer aktiver aktiver Polygone, um leicht zu bestimmen, welches der Polygone am nächsten liegt.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Das klingt zu gut, ist aber möglich. Wenn Ihre Weltdatenbank beispielsweise als BSP-Baum gespeichert ist und alle Polygone in BSP-Blätter abgeschnitten sind, ist die BSP-Durchquerungsreihenfolge die richtige Renderreihenfolge. Wenn Sie beispielsweise BSP von vorne nach hinten umgehen und jedem Polygon bei Erreichen einen inkrementell größeren Schlüsselwert zuweisen, werden Polygone mit höheren Schlüsselwerten garantiert vor Polygonen mit kleineren Schlüsseln angezeigt. Dieser Ansatz wird in Quake seit einiger Zeit verwendet, aber jetzt wird aus Gründen, die ich kurz erläutern werde, eine andere Lösung angewendet.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wenn Sie kein BSP oder eine ähnliche Datenstruktur haben oder wenn Sie viele sich bewegende Polygone haben (BSP verarbeitet sich bewegende Polygone nicht sehr effizient), besteht eine andere Möglichkeit, Ziele zu erreichen, darin, alle Polygone relativ zueinander zu sortieren, bevor Sie die Szene rendern und die entsprechenden Schlüssel entsprechend ihrer räumlichen Zuordnung zuweisen Beziehungen im Ansichtsfenster. Leider ist dies im allgemeinen Fall eine extrem langsame Aufgabe, da jedes Polygon miteinander verglichen werden muss. Es gibt Techniken zur Verbesserung der Leistung beim Sortieren von Polygonen, aber ich kenne niemanden, der das allgemeine Sortieren von Polygonen auf einem PC in Echtzeit durchführen würde.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eine Alternative besteht darin, im Bildschirmbereich nach dem Abstand z vom Betrachter zu sortieren. Diese Lösung passt gut zur überlegenen räumlichen Konnektivität von Sortierkanten. Wenn Sie sich mit jeder neuen Kante auf der Rasterlinie treffen, können Sie den Abstand z des entsprechenden Polygons berechnen und mit den Abständen anderer Polygone vergleichen. Danach kann das Polygon in APL gespeichert werden.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Das Erhalten von Abständen entlang z kann jedoch eine schwierige Aufgabe sein. Vergessen Sie nicht, dass wir in der Lage sein müssen, z an einem beliebigen Punkt des Polygons zu berechnen, da eine Kante auftreten und das Polygon in der APL an einer beliebigen Stelle auf dem Bildschirm sortieren kann. Wir können z direkt aus den Bildschirmkoordinaten x und y und den Gleichungen der Ebene des Polygons berechnen, aber dies kann leider nicht sehr schnell erfolgen, da sich z für die Ebene im Bildschirmraum nicht linear ändert. 1 / z </font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">variiert jedoch</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> linear, daher verwenden wir diesen Wert. (Eine Diskussion der Linearität im Bildschirmbereich und der Verläufe für 1 / z finden Sie in Chris Heckers Serie über Textur-Mapping im </font><u><font style="vertical-align: inherit;">Game Developer-</font></u><font style="vertical-align: inherit;"> Magazin des letzten Jahres</font></font><u><font style="vertical-align: inherit;"></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.) Ein weiterer Vorteil der Verwendung von 1 / z besteht darin, dass die Auflösung mit abnehmendem Abstand zunimmt, dh mit 1 / z haben wir immer die beste Tiefenauflösung für nahe Objekte, die am wichtigsten sind. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der naheliegende Weg, um den 1 / z-Wert an einem beliebigen Punkt im Polygon zu erhalten, besteht darin, 1 / z an den Eckpunkten zu berechnen, sie über beide Kanten des Polygons zu interpolieren und zwischen den Kanten zu interpolieren, um den Wert am gewünschten Punkt zu erhalten. Leider erfordert dies viel Arbeit entlang jeder Rippe; Schlimmer noch, dies erfordert eine Division, um den 1 / z-Schritt pro Pixel in jedem Intervall zu berechnen. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Es wäre besser, 1 / z direkt aus der Gleichung der Ebene und dem Bildschirm x und y des für uns interessanten Pixels zu berechnen. Die Gleichung hat die folgende Form:</font></font><br><br><p><math> <span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mn>1</mn><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><mi>z</mi><mo>=</mo><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><mi>d</mi><mo stretchy=&quot;false&quot;>)</mo><msup><mi>x</mi><mo>&amp;#x2032;</mo></msup><mo>&amp;#x2212;</mo><mo stretchy=&quot;false&quot;>(</mo><mi>b</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><mi>d</mi><mo stretchy=&quot;false&quot;>)</mo><msup><mi>y</mi><mo>&amp;#x2032;</mo></msup><mo>+</mo><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><mi>d</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="30.04ex" height="2.78ex" viewBox="0 -883.9 12933.7 1197.1" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMAIN-31" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMAIN-2F" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMATHI-7A" x="1001" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMAIN-3D" x="1747" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMAIN-28" x="2803" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMATHI-61" x="3193" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMAIN-2F" x="3722" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMATHI-64" x="4223" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMAIN-29" x="4746" y="0"></use><g transform="translate(5136,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMAIN-2032" x="809" y="583"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMAIN-2212" x="6225" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMAIN-28" x="7226" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMATHI-62" x="7615" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMAIN-2F" x="8045" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMATHI-64" x="8545" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMAIN-29" x="9069" y="0"></use><g transform="translate(9458,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMATHI-79" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMAIN-2032" x="706" y="583"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMAIN-2B" x="10475" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMATHI-63" x="11476" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMAIN-2F" x="11909" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMATHI-64" x="12410" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mn>1</mn><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mi>z</mi><mo>=</mo><mo stretchy="false">(</mo><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mi>d</mi><mo stretchy="false">)</mo><msup><mi>x</mi><mo>′</mo></msup><mo>−</mo><mo stretchy="false">(</mo><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mi>d</mi><mo stretchy="false">)</mo><msup><mi>y</mi><mo>′</mo></msup><mo>+</mo><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mi>d</mi></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-1">1/z = (a/d)x' - (b/d)y' + c/d</script> </math></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dabei ist z die Koordinate im Ansichtsfenster z des Punkts auf der Ebene, der in die Bildschirmkoordinaten (x ', y') projiziert wird (der Ursprung der Koordinaten für diese Berechnungen ist das Projektionszentrum, der Punkt auf dem Bildschirm direkt vor dem Ansichtspunkt), [abc] normal zur Ebene im Ansichtsfenster, und d ist der Abstand vom Ursprung des Ansichtsfensters zur Ebene entlang der Normalen. </font><font style="vertical-align: inherit;">Die Division wird für jede Ebene nur einmal durchgeführt, da a, b, c und d Konstanten für Ebenen sind.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eine vollständige 1 / z-Berechnung erfordert zwei Multiplikationen und zwei Additionen, und jede Operation muss mit einem Gleitkomma ausgeführt werden, um Bereichsfehler zu vermeiden. </font><font style="vertical-align: inherit;">Ein solches Volumen an Gleitkommaberechnungen scheint teuer zu sein, aber tatsächlich ist es insbesondere bei Pentium-Prozessoren nicht so, dass der Wert der 1 / z-Ebene an jedem Punkt in Assemblersprache in nur sechs Zyklen berechnet werden kann. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wenn Sie interessiert sind, finden Sie hier eine schnelle Ableitung der 1 / z-Gleichung. </font><font style="vertical-align: inherit;">Die Ebenengleichung für die Ebene hat die folgende Form:</font></font><br><br><p><math> <span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>a</mi><mi>x</mi><mo>+</mo><mi>b</mi><mi>y</mi><mo>+</mo><mi>c</mi><mi>z</mi><mo>&amp;#x2212;</mo><mi>d</mi><mo>=</mo><mn>0</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="20.805ex" height="2.419ex" viewBox="0 -780.1 8957.9 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMATHI-61" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMATHI-78" x="529" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMAIN-2B" x="1324" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMATHI-62" x="2324" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMATHI-79" x="2754" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMAIN-2B" x="3474" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMATHI-63" x="4474" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMATHI-7A" x="4908" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMAIN-2212" x="5599" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMATHI-64" x="6599" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMAIN-3D" x="7401" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMAIN-30" x="8457" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>a</mi><mi>x</mi><mo>+</mo><mi>b</mi><mi>y</mi><mo>+</mo><mi>c</mi><mi>z</mi><mo>−</mo><mi>d</mi><mo>=</mo><mn>0</mn></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-2">ax + by + cz - d = 0</script> </math></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wobei x und y die Koordinaten des Ansichtsraums sind, sind a, b, c, d und z oben definiert. </font><font style="vertical-align: inherit;">Wenn wir die Substitution machen</font></font><math> <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi><mo>=</mo><msup><mi>x</mi><mo>&amp;#x2032;</mo></msup><mi>z</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.531ex" height="2.178ex" viewBox="0 -832 3242.4 937.7" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMATHI-78" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMAIN-3D" x="850" y="0"></use><g transform="translate(1906,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMAIN-2032" x="809" y="513"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMATHI-7A" x="2773" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo>=</mo><msup><mi>x</mi><mo>′</mo></msup><mi>z</mi></math></span></span><script type="math/tex" id="MathJax-Element-3">x=x'z</script> </math>  und <math> <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi><mo>=</mo><mo>&amp;#x2212;</mo><msup><mi>y</mi><mo>&amp;#x2032;</mo></msup><mi>z</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.995ex" height="2.539ex" viewBox="0 -832 3873 1093.4" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMATHI-79" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMAIN-3D" x="775" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMAIN-2212" x="1831" y="0"></use><g transform="translate(2610,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMATHI-79" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMAIN-2032" x="706" y="513"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMATHI-7A" x="3404" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi><mo>=</mo><mo>−</mo><msup><mi>y</mi><mo>′</mo></msup><mi>z</mi></math></span></span><script type="math/tex" id="MathJax-Element-4">y=-y'z</script> </math><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(Aus der Definition der perspektivischen Projektion; y ändert das Vorzeichen, weil es im Ansichtsfenster nach oben, aber im Bildschirmbereich nach unten zunimmt). </font><font style="vertical-align: inherit;">Wenn wir eine Permutation durchführen, erhalten wir:</font></font><br><br><p><math> <span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>z</mi><mo>=</mo><mi>d</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><msup><mi>x</mi><mo>&amp;#x2032;</mo></msup><mo>&amp;#x2212;</mo><mi>b</mi><msup><mi>y</mi><mo>&amp;#x2032;</mo></msup><mo>+</mo><mi>c</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="21.149ex" height="2.78ex" viewBox="0 -883.9 9105.7 1197.1" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMATHI-7A" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMAIN-3D" x="746" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMATHI-64" x="1802" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMAIN-2F" x="2326" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMAIN-28" x="2826" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMATHI-61" x="3216" y="0"></use><g transform="translate(3745,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMAIN-2032" x="809" y="583"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMAIN-2212" x="4835" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMATHI-62" x="5835" y="0"></use><g transform="translate(6265,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMATHI-79" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMAIN-2032" x="706" y="583"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMAIN-2B" x="7281" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMATHI-63" x="8282" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMAIN-29" x="8716" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>z</mi><mo>=</mo><mi>d</mi><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mo stretchy="false">(</mo><mi>a</mi><msup><mi>x</mi><mo>′</mo></msup><mo>−</mo><mi>b</mi><msup><mi>y</mi><mo>′</mo></msup><mo>+</mo><mi>c</mi><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-5">z = d / (ax' - by' + c)</script> </math></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Durch Invertieren und Erweitern der Gleichung erhalten wir: </font></font><br><br><p><math> <span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mn>1</mn><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><mi>z</mi><mo>=</mo><mi>a</mi><msup><mi>x</mi><mo>&amp;#x2032;</mo></msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><mi>d</mi><mo>&amp;#x2212;</mo><mi>b</mi><msup><mi>y</mi><mo>&amp;#x2032;</mo></msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><mi>d</mi><mo>+</mo><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><mi>d</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="26.421ex" height="2.78ex" viewBox="0 -883.9 11375.7 1197.1" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMAIN-31" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMAIN-2F" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMATHI-7A" x="1001" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMAIN-3D" x="1747" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMATHI-61" x="2803" y="0"></use><g transform="translate(3333,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMAIN-2032" x="809" y="583"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMAIN-2F" x="4200" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMATHI-64" x="4700" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMAIN-2212" x="5446" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMATHI-62" x="6447" y="0"></use><g transform="translate(6876,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMATHI-79" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMAIN-2032" x="706" y="583"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMAIN-2F" x="7671" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMATHI-64" x="8171" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMAIN-2B" x="8917" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMATHI-63" x="9918" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMAIN-2F" x="10351" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhhN69fd9hl3O7Zwj7ePeyHQkDFUTg#MJMATHI-64" x="10852" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mn>1</mn><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mi>z</mi><mo>=</mo><mi>a</mi><msup><mi>x</mi><mo>′</mo></msup><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mi>d</mi><mo>−</mo><mi>b</mi><msup><mi>y</mi><mo>′</mo></msup><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mi>d</mi><mo>+</mo><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mi>d</mi></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-6">1/z = ax'/d - by'/d + c/d</script> </math></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Später werde ich die 1 / z-Sortierung in Aktion zeigen. </font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Beben und sortieren nach z </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ich habe oben erwähnt, dass Quake die BSP-Reihenfolge nicht mehr als Sortierschlüssel verwendet. Tatsächlich wird jetzt 1 / z als Schlüssel angewendet. Trotz der Eleganz der Verläufe ist die Berechnung von 1 / z aus ihnen offensichtlich langsamer als der einfache Vergleich mit dem BSP-Bestellschlüssel. Warum haben wir in Quake auf 1 / z umgestellt?</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der Hauptgrund ist die Abnahme der Anzahl der Polygone. Für das Rendern in BSP-Reihenfolge müssen bestimmte Regeln befolgt werden, einschließlich Polygonen, wenn Schnittpunkte mit BSP-Ebenen geteilt werden sollen. Diese Trennung erhöht die Anzahl der Polygone und Kanten erheblich. Dank der Sortierung nach 1 / z können wir die Polygone ungeteilt lassen, erhalten aber dennoch die richtige Zeichenreihenfolge, sodass wir viel weniger Kanten verarbeiten müssen. während das Rendern im Allgemeinen beschleunigt wird, trotz der zusätzlichen Kosten für das Sortieren um 1 / z.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ein weiterer Vorteil der 1 / z-Sortierung besteht darin, dass die am Anfang dieses Artikels erwähnten Sortierprobleme gelöst werden: Verschieben von Modellen, die selbst kleine BSP-Bäume sind. Das Sortieren in der BSP-Weltordnung funktioniert hier nicht, da diese Modelle separate BSPs sind und es keine einfachen Möglichkeiten gibt, sie in die sequentielle Reihenfolge der BSP-Welt einzubetten. Wir möchten für diese Modelle keine Z-Pufferung verwenden, da es sich häufig um große Objekte handelt (z. B. Türen), und wir möchten nicht die Vorteile der Reduzierung des Neuzeichnens verlieren, das geschlossene Türen beim Rendern durch die Kantenliste bieten. Bei Verwendung sortierter Intervalle werden die Kanten der sich bewegenden BSP-Modelle einfach in die Liste der Kanten eingefügt (zuerst werden die Polygone abgeschnitten, damit sie sich nicht mit festen Oberflächen der Welt schneiden, um Komplexität zu vermeiden.)bezogen auf die gegenseitige Durchdringung) anstelle aller Ränder der Welt, und der Rest ist nach 1 / z sortiert.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Weitermachen </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der Artikel enthält zweifellos eine große Menge an Informationen, und vieles ist Ihnen noch nicht in den Sinn gekommen. </font><font style="vertical-align: inherit;">Der Code und die Erklärung aus dem nächsten Artikel helfen dabei. </font><font style="vertical-align: inherit;">Wenn Sie im Voraus einen Blick darauf werfen möchten, sollte der Code zum Zeitpunkt des Lesens dieses Artikels unter ftp.idsoftware.com/mikeab/ddjsort.zip verfügbar sein. </font><font style="vertical-align: inherit;">Es lohnt sich auch, einen Blick auf </font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Computergrafik</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Foley und Van Dam oder </font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Verfahrenselemente für Computergrafik</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Rogers zu </font><font style="vertical-align: inherit;">werfen </font><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Es ist derzeit nicht klar, wie das Ergebnis von </font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quake ist</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">muss die Kanten sortieren - in BSP-Reihenfolge oder 1 / z. </font><font style="vertical-align: inherit;">Tatsächlich gibt es keine Garantie dafür, dass sortierte Intervalle in irgendeiner Form die endgültige Lösung sind. </font><font style="vertical-align: inherit;">Manchmal scheint es so, als würden wir die Grafik-Engines so oft wechseln, wie sie Elvis auf die Radiosender setzen, die den Hits der 50er Jahre gewidmet sind (aber hoffentlich mit viel ästhetischeren Ergebnissen!), Und wir werden zweifellos Alternativen bis zum Veröffentlichungsdatum in Betracht ziehen die Spiele.</font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de439830/">https://habr.com/ru/post/de439830/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de439812/index.html">Kaggle-Ansätze für CV in Prod: Sie können nicht implementieren, um zu schneiden</a></li>
<li><a href="../de439818/index.html">Merkmale von Designansätzen im realen Fertigungssektor</a></li>
<li><a href="../de439822/index.html">Erstellen einer alternativen Anzeige für den Ensoniq EPS16 + und ASR10 Synthesizer / Sampler</a></li>
<li><a href="../de439824/index.html">Wann verschwinden JavaScript-Frameworks?</a></li>
<li><a href="../de439826/index.html">Analog deaktivieren. Was wird mit dem Fernsehen passieren?</a></li>
<li><a href="../de439834/index.html">IPMI-Technologieübersicht</a></li>
<li><a href="../de439838/index.html">Honigarithmetik: Addition und Subtraktion durch Bienen</a></li>
<li><a href="../de439840/index.html">DUMP-2019-Konferenz: Wir laden Sie ein, in den Abschnitten Design, Management und Test zu sprechen</a></li>
<li><a href="../de439844/index.html">Warum machen Dodo Pizza 250 Entwickler?</a></li>
<li><a href="../de439848/index.html">Kein einziges VPN. Spickzettel, wie Sie sich und Ihre Daten schützen können</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>