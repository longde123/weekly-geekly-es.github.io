<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚è© üö¶ üéá Mises √† jour du backend MSVC dans Visual Studio 2019 Preview 2: nouvelles optimisations, am√©liorations OpenMP et Build Throughput üö™ üßôüèΩ üëú</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dans Visual Studio 2019 Preview 2, nous avons continu√© d'am√©liorer le backend C ++ avec de nouvelles fonctionnalit√©s, des optimisations nouvelles et a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Mises √† jour du backend MSVC dans Visual Studio 2019 Preview 2: nouvelles optimisations, am√©liorations OpenMP et Build Throughput</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/microsoft/blog/437670/"><img width="140" align="left" src="https://habrastorage.org/webt/gq/ke/xi/gqkexi_dekwffzpjqtx04zp7ee8.png"><br><p>  Dans Visual Studio 2019 Preview 2, nous avons continu√© d'am√©liorer le backend C ++ avec de nouvelles fonctionnalit√©s, des optimisations nouvelles et am√©lior√©es, des am√©liorations de d√©bit de construction et des changements de qualit√© de vie. </p><a name="habracut"></a><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Original dans le blog</a> <br><br><h3>  De nouvelles fonctionnalit√©s </h3><br><ul><li>  Ajout d'un nouveau commutateur de ligne de commande en ligne: -Ob3.  -Ob3 est une version plus agressive de -Ob2.  -O2 (optimiser le binaire pour la vitesse) implique toujours -Ob2 par d√©faut, mais cela pourrait changer √† l'avenir.  Si vous trouvez que le compilateur est insignifiant, pensez √† passer -O2 -Ob3. </li><li>  Ajout de la prise en charge de base de la vectorisation OpenMP SIMD, qui est la fonctionnalit√© OpenMP la plus utilis√©e dans les biblioth√®ques d'apprentissage automatique (ML).  Notre √©tude de cas est la biblioth√®que Intel MKL-DNN, qui est utilis√©e comme bloc de construction pour d'autres biblioth√®ques ML open source bien connues, y compris Tensor Flow.  Cela peut √™tre activ√© avec un nouveau commutateur CL -openmp: experimental.  Cela permet aux boucles annot√©es avec ¬´#pragma omp simd¬ª d'√™tre potentiellement vectoris√©es.  La vectorisation n'est pas garantie et les boucles annot√©es mais non vectoris√©es recevront un avertissement.  Aucune clause SIMD n'est prise en charge, elles seront simplement ignor√©es avec un avertissement signal√©. </li><li>  Ajout d'un nouveau gestionnaire d'exceptions C ++ __CxxFrameHandler4 qui r√©duit de 66% la surcharge des m√©tadonn√©es de gestion des exceptions.  Cela fournit jusqu'√† 15% d'am√©lioration de la taille binaire totale sur les binaires qui utilisent de grandes quantit√©s de gestion des exceptions C ++.  Actuellement d√©sactiv√© par d√©faut, essayez-le en passant ¬´/ d2FH4¬ª lors de la compilation avec cl.exe.  Notez que / d2FH4 est autrement non document√© et non pris en charge √† long terme.  Ce n'est pas actuellement pris en charge sur les applications UWP car le runtime UWP n'a pas encore cette fonctionnalit√©. </li><li>  Pour prendre en charge la vectorisation manuelle des boucles contenant des appels aux fonctions de biblioth√®que math√©matique et certaines autres op√©rations telles que la division enti√®re, MSVC prend d√©sormais en charge les fonctions intrins√®ques SVML (Short Vector Math Library) qui calculent les √©quivalents vectoriels.  La prise en charge des vecteurs 128 bits, 256 bits et 512 bits est disponible pour la plupart des fonctions, avec les exceptions r√©pertori√©es ci-dessous.  Notez que ces fonctions ne d√©finissent pas errno.  Voir le Guide Intel Intrinsic pour les d√©finitions des fonctions prises en charge. <br>  Les exceptions comprennent: <br><ul><li>  La division et le reste combin√©s des entiers vectoriels ne sont disponibles que pour les √©l√©ments 32 bits et les longueurs vectorielles 128 bits et 256 bits.  Utilisez des fonctions de division et de reste distinctes pour d'autres tailles d'√©l√©ments et longueurs de vecteur. </li><li>  La racine carr√©e SVML n'est disponible qu'en longueurs vectorielles 128 bits et 256 bits.  Vous pouvez utiliser les fonctions <em>_mm512_sqrt_pd</em> ou <em>_mm512_sqrt_ps</em> pour les vecteurs 512 bits. </li><li>  Seules les versions vectorielles 512 bits des fonctions <em>rint</em> et √† <em>proximit√©int</em> sont disponibles.  Dans de nombreux cas, vous pouvez utiliser des fonctions rondes √† la place, par exemple, utilisez <em>_mm256_round_ps (x, _MM_FROUND_CUR_DIRECTION) en</em> tant que version vectorielle 256 bits de <em>rint</em> , ou <em>_mm256_round_ps (x, _MM_FROUND_TO_NEAREST_INT)</em> pour la <em>valeur</em> √† <em>proximit√©</em> . </li><li>  Seule la r√©ciproque de 512 bits est fournie.  Vous pouvez calculer l'√©quivalent en utilisant les fonctions set1 et div, par exemple la r√©ciproque 256 bits peut √™tre calcul√©e comme <em>_mm256_div_ps (_mm256_set1_ps (1.0f), (x))</em> . </li><li>  Il existe des fonctions SVML pour la racine carr√©e complexe simple pr√©cision, le logarithme et l'exponentiation uniquement dans les longueurs vectorielles de 128 bits et 256 bits. </li></ul></li></ul><br><h3>  Optimisations nouvelles et am√©lior√©es </h3><br><ul><li>  Les memsets non d√©roul√©s et les initialisations de bloc utiliseront d√©sormais les instructions SSE2 (ou les instructions AVX si elles sont autoris√©es).  Le seuil de taille pour ce qui sera d√©roul√© a augment√© en cons√©quence (compilation pour la taille avec SSE2: le seuil de d√©roulement passe de 31 √† 63 octets, compilation pour la vitesse avec SSE2: le seuil passe de 79 √† 159 octets). </li><li>  Optimisation du code-gen pour les petits ensembles de mems, principalement destin√©s aux fonctions <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">prot√©g√©es</a> par <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">initall</a> . </li><li>  Am√©liorations apport√©es √† l'√©limination des magasins redondants de l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">optimiseur SSA</a> : meilleure analyse des √©chappements et meilleure gestion des boucles </li><li>  Le compilateur reconna√Æt memmove () comme une fonction intrins√®que et optimise en cons√©quence.  Cela am√©liore la g√©n√©ration de code pour les op√©rations bas√©es sur memmove (), y compris std :: copy () et d'autres codes de biblioth√®que de niveau sup√©rieur tels que std :: vector et std :: string construction </li><li>  L'optimiseur optimise les op√©rations memmove (), memcpy () et memcmp () courtes et de longueur fixe. </li><li>  Optimisation de la duplication des commutateurs impl√©ment√©e pour de meilleures performances des commutateurs dans les boucles chaudes.  Nous avons dupliqu√© les sauts de commutateur pour am√©liorer la pr√©cision de la pr√©diction de branche et, par cons√©quent, les performances d'ex√©cution. </li><li>  Ajout de simplifications √† pliage constant et arithm√©tiques pour les expressions utilisant SIMD (vector) intrins√®que, pour les formes flottantes et enti√®res.  La plupart des optimisations d'expression habituelles g√®rent d√©sormais les intrins√®ques SSE2 et AVX2, soit √† partir du code utilisateur, soit √† la suite d'une vectorisation automatique. </li><li> Plusieurs nouveaux mod√®les scalaires fusionn√©s √† multiplication-addition (FMA) sont identifi√©s avec / arch: AVX2 / fp: fast.  Il s'agit notamment des expressions courantes suivantes: <code>(x + 1.0) * y; (x ‚Äì 1.0) * y; (1.0 ‚Äì x) * y; (-1.0 ‚Äì x) * y</code> <code>(x + 1.0) * y; (x ‚Äì 1.0) * y; (1.0 ‚Äì x) * y; (-1.0 ‚Äì x) * y</code> </li><li>  Les s√©quences de code qui initialisent une valeur __m128 SIMD (vecteur) √©l√©ment par √©l√©ment sont identifi√©es et remplac√©es par un intrins√®que <em>_mm_set_ps</em> .  Cela permet aux nouvelles optimisations SIMD de consid√©rer la valeur comme faisant partie des expressions, particuli√®rement utile si la valeur n'a que des √©l√©ments constants.  Une future mise √† jour prendra en charge plus de types de valeur. </li><li>  L'√©limination de la sous-expression commune (ESC) est plus efficace en pr√©sence de variables qui peuvent √™tre modifi√©es de mani√®re indirecte car elles ont leur adresse prise. </li><li>  Des copies de structure / classe inutiles sont supprim√©es dans plusieurs autres cas, y compris des copies de param√®tres de sortie et de fonctions renvoyant un objet.  Cette optimisation est particuli√®rement efficace dans les programmes C ++ qui transmettent des objets par valeur. </li><li>  Ajout d'une analyse plus puissante pour extraire des informations sur les variables du flux de contr√¥le (instructions if / else / switch), utilis√©e pour supprimer les branches dont on peut prouver qu'elles sont toujours vraies ou fausses et pour am√©liorer l'estimation de la plage de variables.  Le code utilisant gsl :: span voit des am√©liorations, certaines v√©rifications de plage inutiles √©tant maintenant supprim√©es. </li><li>  L'optimisation de la d√©virtualisation aura d√©sormais des opportunit√©s suppl√©mentaires, comme lorsque les classes sont d√©finies dans des espaces de noms anonymes. </li></ul><br><h3>  Am√©liorations du d√©bit de g√©n√©ration </h3><br><ul><li>  Filtrez les informations de d√©bogage pendant la compilation en fonction des symboles et types r√©f√©renc√©s pour r√©duire la taille de la section de d√©bogage et am√©liorer le d√©bit de l'√©diteur de liens.  La mise √† jour de 15,9 √† 16,0 peut r√©duire la taille d'entr√©e de l'√©diteur de liens jusqu'√† 40%. </li><li>  Am√©lioration du temps de liaison dans la fusion et la cr√©ation de type PDB. </li><li>  La mise √† jour vers 16.0 √† partir de 15.9 peut am√©liorer les temps de liaison jusqu'√† une acc√©l√©ration 2X.  Par exemple, la liaison de Chrome a entra√Æn√© une acc√©l√©ration de la liaison de 1,75 X lors de l'utilisation de / DEBUG: complet et une acc√©l√©ration de la liaison de 1,4 X lors de l'utilisation de / DEBUG: fastlink. </li></ul><br><h3>  Am√©liorations de la qualit√© de vie </h3><br><ul><li>  Le compilateur affiche les noms et les chemins d'acc√®s aux fichiers √† l'aide de la casse fournie par l'utilisateur, o√π auparavant le compilateur affichait les noms et les chemins d'acc√®s aux fichiers inf√©rieurs. </li><li>  Le nouvel √©diteur de liens signalera d√©sormais les symboles potentiellement correspondants pour les symboles non r√©solus, comme: </li></ul><br><pre> <code class="cpp hljs">main.obj : error LNK2019: unresolved external symbol _foo referenced in function _main Hint on symbols that are defined <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> could potentially match: <span class="hljs-string"><span class="hljs-string">"int __cdecl foo(int)"</span></span> (?foo@@YAHH@Z) <span class="hljs-string"><span class="hljs-string">"bool __cdecl foo(double)"</span></span> (?foo@@YA_NN@Z) @foo@<span class="hljs-number"><span class="hljs-number">0</span></span> foo@@<span class="hljs-number"><span class="hljs-number">4</span></span> main.exe : fatal error LNK1120: <span class="hljs-number"><span class="hljs-number">1</span></span> unresolved externals</code> </pre> <ul><li>  Lors de la g√©n√©ration d'une biblioth√®que statique, il n'est plus n√©cessaire de passer l'indicateur / LTCG √† LIB.exe. </li><li>  Ajout d'une option de l'√©diteur de liens / LINKREPROTARGET: [nom_binaire] pour g√©n√©rer uniquement une reproduction de lien pour le binaire sp√©cifi√©.  Cela permet √†% LINK_REPRO% ou / LINKREPRO: [nom_r√©pertoire] d'√™tre d√©fini dans une grande construction avec plusieurs liaisons, et l'√©diteur de liens ne g√©n√©rera que la repro pour le binaire sp√©cifi√© dans / linkreprotarget. </li></ul><br><p>  Nous aimerions que vous <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">t√©l√©chargiez Visual Studio 2019</a> et que vous l'essayiez.  Comme toujours, nous appr√©cions vos commentaires.  Nous pouvons √™tre contact√©s via les commentaires ci-dessous ou par e-mail ( <a href="">visualcpp@microsoft.com</a> ).  Si vous rencontrez des probl√®mes avec Visual Studio ou MSVC, ou si vous avez une suggestion √† nous faire, veuillez nous en informer via <strong>Aide&gt; Envoyer des commentaires&gt; Signaler un probl√®me / Fournir une suggestion</strong> dans le produit ou via la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">communaut√© des d√©veloppeurs</a> .  Vous pouvez √©galement nous trouver sur Twitter ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">@VisualC</a> ) et Facebook (msftvisualcpp). </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr437670/">https://habr.com/ru/post/fr437670/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr437656/index.html">√âl√©phant dans une boutique de porcelaine: imprimantes 3D avec un immense champ d'impression</a></li>
<li><a href="../fr437658/index.html">Guide: Thymeleaf + Spring. 3e partie</a></li>
<li><a href="../fr437660/index.html">Mise √† jour du profil √† vie dans Visual Studio 2019 Preview 2</a></li>
<li><a href="../fr437664/index.html">R√©cup√©ration du compos√©</a></li>
<li><a href="../fr437666/index.html">Annonce de l'aper√ßu de F # 4.6</a></li>
<li><a href="../fr437672/index.html">cyberd: Calculer les connaissances du web3</a></li>
<li><a href="../fr437674/index.html">M√©thodes de reconnaissance d'objets 3D pour les v√©hicules sans pilote. Rapport Yandex</a></li>
<li><a href="../fr437676/index.html">Les universit√©s et les acc√©l√©rateurs d'entreprise comme levier pour lancer une start-up B2B aux √âtats-Unis</a></li>
<li><a href="../fr437680/index.html">Ma collection de bricolage sur Youtube</a></li>
<li><a href="../fr437682/index.html">√âcriture d'un autre outil de cr√©ation de mod√®les Kubernetes</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>