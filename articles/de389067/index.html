<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏾‍🔧 🙋🏿 💘 NooLite Wireless-Geräte und Smart Home (Teil 1). Arduino 🔣 😦 🤩</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hallo liebe Leser von Geektimes! Dieses Mal möchte ich Sie auf eine Reihe von Artikeln zur Integration von nooLite- Funkgeräten in Hausautomationssyst...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>NooLite Wireless-Geräte und Smart Home (Teil 1). Arduino</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/389067/"><img src="https://habrastorage.org/files/d8c/f00/38e/d8cf0038e7a040fe8e07446481c0a1a0.jpg" alt="nooLite"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hallo liebe Leser von Geektimes! </font><font style="vertical-align: inherit;">Dieses Mal möchte ich Sie auf eine Reihe von Artikeln zur Integration von </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nooLite-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Funkgeräten </font><font style="vertical-align: inherit;">in Hausautomationssysteme aufmerksam machen. </font><font style="vertical-align: inherit;">Dieser Zyklus ähnelt der bereits veröffentlichten Artikelserie ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">eins</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zwei</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">drei</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) zur Integration von Laurent-Modulen in Smart Home-Systeme. Nur wird über das nooLite-System gesprochen, und nach dem Lesen dieses Zyklus haben Sie keine Fragen zur Verwaltung von nooLite-Geräten von Ihrem Smart aus zu Hause.</font></font><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Über die Artikelserie</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Zyklus ist in drei Teile gegliedert. Im ersten Teil lernen Sie die Funktionsprinzipien der drahtlosen nooLite-Geräte und deren Verwaltung in Ihren Arduino-Projekten kennen. Der </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zweite</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Teil beschreibt ausführlich die Integration des MT1132-Steuermoduls in den Arduino Mega Server und die Möglichkeiten zur Verwaltung eines Smart Home, die sich in diesem Zusammenhang eröffnen. Der </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dritte</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Artikel der Reihe widmet sich einem sehr interessanten Thema - dem Konzept der Erstellung von 100-in-1-Geräten auf der Basis des Arduino Mega Servers. Ein Beispiel für die Erstellung einer drahtlosen Lötstation auf AMS wird im Detail untersucht, buchstäblich aus dem Nichts - basierend auf nur einem drahtlosen nooLite-Dimer. Es wird auch einen </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vierten</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Teil geben, aus dem Sie lernen, wie man einen magischen Kristall erzeugt.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Lötstation, auf die im dritten Artikel eingegangen wird, ist übrigens bereits in der neuesten </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arduino Mega Server-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Baugruppe </font><font style="vertical-align: inherit;">unter der Nummer 0.14 vorhanden. </font><font style="vertical-align: inherit;">Und die neugierigsten Leser können nicht auf den dritten Artikel warten, sondern sofort das Distributionskit herunterladen und selbst herausfinden, wie das alles funktioniert. </font></font><br>
<br>
<img src="https://habrastorage.org/files/428/a18/eeb/428a18eeb1f84623bc6c9f8d59e08974.jpg" alt="Lötstation"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und das Tolle ist, dass es in AMS Hunderte solcher Geräte gleichzeitig geben kann. </font><font style="vertical-align: inherit;">Zum Beispiel eine Lötstation, eine Wetterstation, eine Sicherheitseinheit, eine Gewächshaussteuerung usw. Und all dies kann gleichzeitig funktionieren oder durch Laden einer Webseite oder sogar einer ganzen Site, die einem bestimmten Gerät gewidmet ist, „gestartet“ werden.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aber lasst uns nicht weiterkommen, lasst uns am Ende das Interessanteste verlassen, aber jetzt werden wir die notwendigen theoretischen Vorbereitungen treffen. </font><font style="vertical-align: inherit;">Ich verspreche, dass alles auf einfachste und verständlichste Weise ausgedrückt wird. </font><font style="vertical-align: inherit;">Also fangen wir an.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NooLite-Ausrüstung</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
NooLite-Geräte sind bereits ein bekanntes und beliebtes System, und im Internet gibt es zahlreiche Informationen dazu. </font><font style="vertical-align: inherit;">Ich werde versuchen, die wichtigsten Punkte hier zusammenzufassen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Konzept ist sehr einfach: Es gibt Aggregate zur Steuerung von Licht und verschiedenen Lasten sowie Bedienfelder, die Befehle an diese Aggregate senden. </font><font style="vertical-align: inherit;">Und das alles natürlich ohne die Teilnahme von Kabelverbindungen. </font><font style="vertical-align: inherit;">Eigentlich alles. </font><font style="vertical-align: inherit;">Das Schöne am System ist, dass alle Komponenten durchdacht und gut verarbeitet sind und genau das tun, was es verspricht - sie steuern die angeschlossenen Geräte zuverlässig. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es gibt auch drahtlose Sensoren, Gerätesteuerung von einem Smartphone und vieles mehr, aber in einem Artikel ist es unmöglich, alles abzudecken. Hier konzentrieren wir uns nur auf die Integration von nooLite in die beliebte DIY-Plattform - Arduino.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Von dem gesamten breiten Spektrum an nooLite-Geräten werden wir uns für das MT1132-Steuermodul interessieren, da es für den Anschluss an Arduino- und Single-Board-Computer wie den Raspberry Pi ausgelegt ist. Und es funktioniert auf einer einfachen seriellen Schnittstelle. Mit Blick auf die Zukunft werde ich sagen, dass mir das Modul wegen seiner Einfachheit, Vorhersehbarkeit und zuverlässigen Bedienung gefallen hat. Und ich konnte diese Eigenschaften nach einem Monat erfolglosen Kampfes mit dem Netzwerkmodul auf dem W5500-Chip schätzen, das nicht normal funktionieren wollte. </font></font><br>
<br>
<img src="https://habrastorage.org/files/af4/5a9/4dc/af45a94dc2684467920e9191ebcafc83.jpg" alt="MT1132-Modul"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Besonders gut hat mir gefallen, dass das Modul (abgesehen von der Stromversorgung) mit nur einem (!) Wire (RX) an das Arduino angeschlossen ist. Die zweite (TX) kann ganz weggelassen werden. Das Modul ist "Einweg", dh es ist nur zum Senden von Steuersignalen vorgesehen. Die Pläne der Firma Nootehnika beinhalten die Entwicklung und Veröffentlichung einer Zwei-Wege-Version des Moduls.</font></font><br>
<br>
<img src="https://habrastorage.org/files/60c/dfb/d07/60cdfbd0709b41b88b19a00638637d59.jpg" alt="SU111-300"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das zweite Element, das wir von nooLite-Geräten benötigen, ist ein Leistungssteuergerät, z. B. SU111-300. Der Anschluss des Geräts ist elementar und in der Abbildung zu sehen. Zwei Drähte sind an ein 220-Volt-Netzwerk angeschlossen, die anderen beiden an die Last. Das einzige, worauf ich achten möchte, ist, dass die Module mit einem Jumper geliefert werden, der den Dimmmodus blockiert. Wenn Sie die Leistung anpassen möchten, müssen Sie diesen Jumper abschneiden (und daran denken, die resultierenden blanken Drähte zu isolieren).</font></font><br>
<br>
<img src="https://habrastorage.org/files/acf/cd5/4ad/acfcd54ad9ab4c57bf6409799dd3a133.jpg" alt="PU311-2"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich werde nicht auf die Fernbedienungen eingehen, da dies eine "manuelle" Steuerung ist und wir im Zusammenhang mit der Automatisierung mehr an der Automatik interessiert sind. </font><font style="vertical-align: inherit;">Ich kann nur sagen, dass die Experimente mit der PU311-2-Fernbedienung durchgeführt wurden, die in Form eines Wandschalters hergestellt wurde und sich am besten zeigte, dh das Licht klar und fehlerfrei ein- und ausschaltete. </font><font style="vertical-align: inherit;">Was in der Tat eine gute Ausrüstung ist und sich von einer schlechten unterscheidet - man merkt einfach nichts Gutes.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arbeitskonzept. </font><font style="vertical-align: inherit;">Binden und Aufheben der Verknüpfung</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bevor Sie Elektrogeräte mit dem nooLite-System ein- und ausschalten können, müssen Sie die Steuermodule mit den entsprechenden Netzteilen „verbinden“. Dies geschieht nach dem sogenannten Verfahren. "Bindungen" und "Lösen", ausführlich beschrieben in der nooLite-Dokumentation. Kurz gesagt, es kommt alles auf das Drücken von zwei Tasten an den verknüpften Blöcken an und bereitet keine Schwierigkeiten. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn anstelle der Fernbedienung das Steuermodul MT1132 verwendet wird, erfolgt die Vorgehensweise etwas anders. Das heißt, da das Modul keine Tasten hat, müssen Sie programmgesteuert einen Steuerbefehl auf dem gewünschten Kanal generieren und senden und dann die Taste am Netzteil drücken, um das "Binden" oder "Lösen" zu bestätigen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kanäle sind „Steuerleitungen“ und es gibt 32 davon im MT1132-Modul, wie die letzten beiden Ziffern im Namen belegen. </font><font style="vertical-align: inherit;">Dies bedeutet, dass Sie mit diesem Modul 32 separate Gerätegruppen verwalten können, was für eine Wohnung oder ein kleines Haus mehr als ausreichend ist. </font><font style="vertical-align: inherit;">Wenn Sie ein großes Haus haben, können die Module zusammenarbeiten und auf eine beliebige Anzahl von Kanälen skaliert werden.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Protokollbeschreibung</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Auf </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">der</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Website des Unternehmens Nootehnika befindet sich ein wunderbares </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">Dokument, das die</font></a><font style="vertical-align: inherit;"> Modulverbindung </font><font style="vertical-align: inherit;">und </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">das</font></a><font style="vertical-align: inherit;"> Steuerprotokoll </font><font style="vertical-align: inherit;">umfassend und detailliert beschreibt. </font><font style="vertical-align: inherit;">Ich werde den Artikel nicht mit unnötigen technischen Details überladen, jeder kann dieses Dokument lesen, ich werde nur die Hauptpunkte beschreiben. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um das Modul zu steuern, müssen wir einen Steuerbefehl bilden, der aus 12 Bytes besteht. </font><font style="vertical-align: inherit;">Die Grundsätze für die Bildung dieses Teams sind im obigen Dokument beschrieben. </font><font style="vertical-align: inherit;">Und wie Sie unten sehen werden, sind alle diese Regeln bereits in den Steuerfunktionen programmiert, und wir müssen sie nur verwenden, um Befehle an das Modul auszugeben.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Testteams</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
nooLite verfügt über ein ziemlich entwickeltes Befehlssystem, aus dem wir die einfachsten und gebräuchlichsten auswählen und das System anhand ihres Beispiels veranschaulichen.</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Schnappen</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Löse die Bindung</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Einbeziehung</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aus</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Leistungseinstellung (Dimmen)</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie wissen, wie die Basisteams arbeiten, können Sie problemlos andere verwenden.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anschließen des MT1132-Moduls</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie ich bereits sagte, ist das MT1132-Modul buchstäblich mit einem Draht verbunden (außer Strom). </font><font style="vertical-align: inherit;">Das Modul kann sowohl mit einer Spannung von 5 Volt als auch mit einer Spannung von 3,3 Volt betrieben werden. </font><font style="vertical-align: inherit;">Daher gab es keine Probleme beim Anschluss an das 5-Volt-Arduino Mega oder das 3,3-Volt-Arduino Due. </font><font style="vertical-align: inherit;">Der einzige Punkt ist, dass mit reduzierter Leistung der Bereich des zuverlässigen Betriebs des Systems abnimmt. </font><font style="vertical-align: inherit;">Dies muss berücksichtigt werden, wenn Sie das Modul mit einer Spannung von 3,3 Volt versorgen möchten.</font></font><br>
<br>
<img src="https://habrastorage.org/files/fb8/2a4/d76/fb82a4d769cb49bda099e57591c13157.jpg" alt="Arduino"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Modul verfügt über RX- und TX-Pins zum Empfangen und Senden von Signalen über die serielle Schnittstelle. </font><font style="vertical-align: inherit;">Entscheidend für den Betrieb des Moduls ist der Anschluss von RX zum Empfang von Steuerbefehlen von der Steuerung. </font><font style="vertical-align: inherit;">Dementsprechend ist der RX-Pin auf der Modulseite mit dem TX-Pin (18) auf der Arduino-Seite verbunden. </font><font style="vertical-align: inherit;">Diese Pinbelegung gilt sowohl für Arduino Mega als auch für Arduino Due.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Software-Teil</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lassen Sie uns nun anhand von Skizzen auf Arduino herausfinden, wie Sie mit all dieser Wirtschaft umgehen können. </font><font style="vertical-align: inherit;">Initialisieren Sie zunächst Serial1, an das wir das MT1132-Modul angeschlossen haben (dies erfolgt mit der Standardfrequenz 9600):</font></font><br>
<br>
<pre><code class="java hljs">Serial1.begin(<span class="hljs-number"><span class="hljs-number">9600</span></span>);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nun der Code der Hauptsteuerfunktion:</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nooSendCommand</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params"> channel, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params"> command, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params"> data, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params"> format)</span></span></span><span class="hljs-function"> </span></span>{
  <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> buf[<span class="hljs-number"><span class="hljs-number">12</span></span>];<font></font>
<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-number"><span class="hljs-number">12</span></span>; i++) {<font></font>
    buf[i] = <span class="hljs-number"><span class="hljs-number">0</span></span>;<font></font>
  }<font></font>
<font></font>
  buf[<span class="hljs-number"><span class="hljs-number">0</span></span>] = <span class="hljs-number"><span class="hljs-number">85</span></span>;<font></font>
  buf[<span class="hljs-number"><span class="hljs-number">1</span></span>] = B01010000;<font></font>
  buf[<span class="hljs-number"><span class="hljs-number">2</span></span>] = command;<font></font>
  buf[<span class="hljs-number"><span class="hljs-number">3</span></span>] = format;<font></font>
  buf[<span class="hljs-number"><span class="hljs-number">5</span></span>] = channel;<font></font>
  buf[<span class="hljs-number"><span class="hljs-number">6</span></span>] = data;<font></font>
<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> checkSum = <span class="hljs-number"><span class="hljs-number">0</span></span>;
  <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-number"><span class="hljs-number">10</span></span>; i++) {<font></font>
    checkSum += buf[i];<font></font>
  }<font></font>
<font></font>
  buf[<span class="hljs-number"><span class="hljs-number">10</span></span>] = lowByte(checkSum);<font></font>
  buf[<span class="hljs-number"><span class="hljs-number">11</span></span>] = <span class="hljs-number"><span class="hljs-number">170</span></span>;<font></font>
<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; (<span class="hljs-number"><span class="hljs-number">12</span></span>); i++) {<font></font>
    Serial1.write(buf[i]);<font></font>
  }<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im Prinzip müssen wir nicht einmal wissen, wie es funktioniert, wir können es im "Black Box" -Modus oder in einer Art API verwenden, wobei eine bestimmte Schnittstelle hervorsteht. </font><font style="vertical-align: inherit;">Wir müssen nur wissen, wie man diese Schnittstelle benutzt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie Sie sehen können, gibt es nur vier Parameter - Kanal, Befehl, Daten und Format. </font><font style="vertical-align: inherit;">Sie können das Prinzip lesen, nach dem Anforderungen an diese API im oben genannten Dokument generiert werden können. Wir werden unsere Aufgabe jedoch noch weiter vereinfachen und diese Schnittstelle in einfache nooLite-Gerätesteuerungsbefehle einbinden.</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nooBind</span></span></span><span class="hljs-function">  </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ch)</span></span></span><span class="hljs-function">         </span></span>{nooSendCommand(ch, <span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>);}
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nooUnbind</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ch)</span></span></span><span class="hljs-function">         </span></span>{nooSendCommand(ch,  <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>);}
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nooOn</span></span></span><span class="hljs-function">    </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ch)</span></span></span><span class="hljs-function">         </span></span>{nooSendCommand(ch,  <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>);}
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nooOff</span></span></span><span class="hljs-function">   </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ch)</span></span></span><span class="hljs-function">         </span></span>{nooSendCommand(ch,  <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>);}
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nooValue</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ch, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params"> v)</span></span></span><span class="hljs-function"> </span></span>{nooSendCommand(ch,  <span class="hljs-number"><span class="hljs-number">6</span></span>, v, <span class="hljs-number"><span class="hljs-number">1</span></span>);}
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Relativ komplexes Team ist nur das letzte, dort wird neben dem Kanal auch der Leistungspegel eingestellt. </font><font style="vertical-align: inherit;">Es gibt auch Teams in der Skizze, auf die wir jetzt nicht näher eingehen werden, die sich aber genauso leicht bilden lassen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eigentlich ... das war's! </font><font style="vertical-align: inherit;">Nirgendwo ist es einfacher. </font><font style="vertical-align: inherit;">Im Code sehen die Steuerbefehle folgendermaßen aus:</font></font><br>
<br>
<pre><code class="java hljs">nooBind(ch);<font></font>
nooUnbind(ch);<font></font>
nooOn(ch);<font></font>
nooOff(ch);<font></font>
nooValue(ch, v);<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lassen Sie uns nun das Üben der Verwaltung von nooLite-Leistungsmodulen üben. </font><font style="vertical-align: inherit;">Also binden wir den Powerblock auf den Nullkanal:</font></font><br>
<br>
<pre><code class="java hljs">nooBind(<span class="hljs-number"><span class="hljs-number">0</span></span>);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die LED am Netzteil beginnt zu blinken. </font><font style="vertical-align: inherit;">Drücken Sie die Taste am Block - die LED hört auf zu blinken - der Netzblock ist angebracht. </font><font style="vertical-align: inherit;">Anstelle des Nullkanals können Sie auch einen anderen verwenden. </font><font style="vertical-align: inherit;">Und Sie können die Kanalnummer im Skizzencode ganz einfach nach Ihren Wünschen generieren. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Schalten Sie die Lampe ein (wenn wir die Lampe auf den Nullkanal gebunden haben, müssen die Befehle dafür auf diesem Kanal gesendet werden):</font></font><br>
<br>
<pre><code class="java hljs">nooOn(<span class="hljs-number"><span class="hljs-number">0</span></span>);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Stellen Sie die Leistung (Helligkeit der Lampe) ein:</font></font><br>
<br>
<pre><code class="java hljs">nooValue(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier müssen Sie ein wenig über die Regeln für die Bildung eines Teams sagen, das die Leistungsstufe festlegt. Der Leistungswert ändert sich nicht von 0 auf 255, wie man meinen könnte, sondern von 35 auf 155. Wenn der Wert mehr als 155 beträgt, ist die Leistung maximal. Wenn sie 0 ist, entspricht dies einem Befehl zum Herunterfahren. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier (nur für den Fall) eine Formel, die "Standard" -Werte von 0 bis 100 in ein Format übersetzt, das vom nooLite-Modul verstanden wird:</font></font><br>
<br>
<pre><code class="java hljs">v = x * <span class="hljs-number"><span class="hljs-number">1.2</span></span> + <span class="hljs-number"><span class="hljs-number">34</span></span>;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mit dieser Formel können Sie die Helligkeit der Lampe auf den üblichen Prozentsatz der Leistung einstellen. </font><font style="vertical-align: inherit;">Und wenn Sie die Leistung nichtlinear anpassen müssen, können Sie natürlich eine Variable v nach einem beliebigen Gesetz erstellen oder einfach nur feste Werte auswählen. </font><font style="vertical-align: inherit;">Dies wird im dritten Teil des Zyklus besprochen, wenn wir die Heiztemperatur der Lötstation einstellen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Schalten Sie das Gerät aus:</font></font><br>
<br>
<pre><code class="java hljs">nooOff(<span class="hljs-number"><span class="hljs-number">0</span></span>);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Löse:</font></font><br>
<br>
<pre><code class="java hljs">nooUnbind(<span class="hljs-number"><span class="hljs-number">0</span></span>);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die LED am Netzteil beginnt zu blinken. </font><font style="vertical-align: inherit;">Wir bestätigen die Entkopplung durch Drücken der Taste am Netzteil. </font><font style="vertical-align: inherit;">Das war's, jetzt reagiert das Netzteil nicht mehr auf unsere Befehle und wir können es auf jedem der 32 Kanäle des nooLite MT1132-Moduls erneut „einrasten“. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier ist die vollständige Skizze.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vollständiger Skizzencode</font></font></b><div class="spoiler_text">byte const PIN_TX = 18; // TX PIN (to RX noolite)<br>
byte const PIN_RX = 19; // RX PIN (to TX noolite)<br>
<br>
void nooSendCommand(byte channel, byte command, byte data, byte format) {<br>
 byte buf[12];<br>
<br>
for (byte i = 0; i &lt; 12; i++) {<br>
 buf[i] = 0;<br>
 }<br>
<br>
buf[0] = 85;<br>
 buf[1] = B01010000;<br>
 buf[2] = command;<br>
 buf[3] = format;<br>
 buf[5] = channel;<br>
 buf[6] = data;<br>
<br>
int checkSum = 0;<br>
 for (byte i = 0; i &lt; 10; i++) {<br>
 checkSum += buf[i];<br>
 }<br>
<br>
buf[10] = lowByte(checkSum);<br>
 buf[11] = 170;<br>
<br>
for (byte i = 0; i &lt; (12); i++) {<br>
 Serial1.write(buf[i]);<br>
 }<br>
}<br>
<br>
void nooBind (byte ch) {nooSendCommand(ch, 15, 0, 0);}<br>
void nooUnbind (byte ch) {nooSendCommand(ch, 9, 0, 0);}<br>
<br>
void nooOn (byte ch) {nooSendCommand(ch, 2, 0, 0);}<br>
void nooOff (byte ch) {nooSendCommand(ch, 0, 0, 0);}<br>
void nooTrigger(byte ch) {nooSendCommand(ch, 4, 0, 0);}<br>
void nooCancel (byte ch) {nooSendCommand(ch, 10, 0, 0);}<br>
<br>
void nooUp (byte ch) {nooSendCommand(ch, 3, 0, 0);}<br>
void nooDown (byte ch) {nooSendCommand(ch, 1, 0, 0);}<br>
void nooRevers (byte ch) {nooSendCommand(ch, 5, 0, 0);}<br>
<br>
void nooValue (byte ch, byte v) {nooSendCommand(ch, 6, v, 1);}<br>
<br>
void setup() {<br>
 Serial1.begin(9600);<br>
<br>
/*     <br>
      loop(),    */<br>
<br>
//nooBind(0);<br>
<br>
//nooOn(0);<br>
 //nooOff(0);<br>
 //nooValue(0, 100);<br>
<br>
//nooUnbind(0); <br>
}<br>
<br>
void loop(){<br>
<br>
}<br>
</div></div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zwischensumme</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie Sie sehen, </font><font style="vertical-align: inherit;">ist die </font><font style="vertical-align: inherit;">Steuerung von </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nooLite-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Leistungsmodulen </font><font style="vertical-align: inherit;">mit Arduino nicht kompliziert, </font><font style="vertical-align: inherit;">im </font><font style="vertical-align: inherit;">Gegenteil, die Steuerung ist phänomenal einfach: Das Modul ist mit einem Draht verbunden, und die Befehle sind fast eine natürliche menschliche Sprache - "Kanal 0 einschalten", "Kanal 1 ausschalten", "Die Leistung von 50% auf Kanal 3 einzustellen" ist wirklich nirgendwo einfacher.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bonus für diejenigen, die bis zum Ende gelesen haben</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Erst neulich wurde eine neue Version von </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arduino Mega Server</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mit der Nummer 0.14 veröffentlicht, in der alle Kinderkrankheiten der Technologie überwunden wurden und die schnell und stabil funktioniert. </font><font style="vertical-align: inherit;">Dieselbe Version enthält den integrierten nooLite-Instrumentensteuerungskern. Wie alles funktioniert, erfahren Sie im nächsten Artikel in der Reihe „nooLite Wireless Equipment and Smart Home“ (Teil 2). </font><font style="vertical-align: inherit;">Arduino Mega Server. " </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der zweite</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dritte</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vierte</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Teil des Zyklus.</font></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de389067/">https://habr.com/ru/post/de389067/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de389051/index.html">CNET Smart Home: Testfeld für Gadgets</a></li>
<li><a href="../de389053/index.html">Smart Home. Gehirne</a></li>
<li><a href="../de389057/index.html">CES 2016: Ankündigungen von LG und Samsung für Smart Home</a></li>
<li><a href="../de389063/index.html">Wie quadratische Autos der 80er Jahre in den 90er Jahren gestrafft wurden</a></li>
<li><a href="../de389065/index.html">Dawn Probe schickte detaillierte Bilder von Ceres-Kratern</a></li>
<li><a href="../de389069/index.html">Remix OS, ein Android-basiertes Multi-Window-Betriebssystem, ist jetzt für den PC verfügbar</a></li>
<li><a href="../de389071/index.html">Eingriffe in globale Navigationssatellitensysteme</a></li>
<li><a href="../de389073/index.html">Branto ORB: Ein fast magischer Ball, mit dem Sie Ihr Zuhause kontrollieren können</a></li>
<li><a href="../de389075/index.html">Распродажа в Старый Новый год</a></li>
<li><a href="../de389077/index.html">Gründer von Oculus: Low-Power-PC ist das Haupthindernis für die Popularisierung der virtuellen Realität</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>