<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßïüèº ‚è≠Ô∏è üë©üèæ‚Äçüé§ Controladores de terceros peligrosos en su sistema o LOLDrivers üè¥Û†ÅßÛ†Å¢Û†Å∑Û†Å¨Û†Å≥Û†Åø üöâ ‚úèÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="¬øSab√≠a que un controlador completamente leg√≠timo puede darle a un atacante la oportunidad de registrarse en su sistema durante mucho tiempo, permaneci...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Controladores de terceros peligrosos en su sistema o LOLDrivers</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/dsec/blog/468691/"><p><img src="https://habrastorage.org/webt/jo/vj/6b/jovj6bremrnesqprdgan6fibwqu.jpeg"></p><br><p>  ¬øSab√≠a que un controlador completamente leg√≠timo puede darle a un atacante la oportunidad de registrarse en su sistema durante mucho tiempo, permaneciendo dentro incluso despu√©s de reinstalarlo?  ¬øO convertir tu computadora en un ladrillo?  Por ejemplo, algunos controladores inofensivos aparentemente confiables (firmados) son herramientas incidentales para sobrescribir el BIOS.  Despu√©s de tal ataque, solo el programador guardar√°. </p><br><p>  En Windows, hay <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aplicaciones / scripts / bibliotecas</a> confiables con adicionales <del>  interesante </del>  funcionalidad peligrosa como ejecutar c√≥digo arbitrario, descargar archivos, omitir UAC, etc.  Si dicha funcionalidad adicional se encuentra en un componente del n√∫cleo, se vuelve a√∫n m√°s interesante. </p><a name="habracut"></a><br><p>  A partir de Windows Vista x64, se aplica la pol√≠tica de cumplimiento de firma de controlador (DSE): todos los controladores de nivel de n√∫cleo deben estar firmados.  Si un atacante (con derechos de usuario / administrador) despu√©s de penetrar en el sistema desea obtener el nivel m√°ximo de acceso (instalar kernel rootkit / bootkit / SMM-rootkit / BIOS-rootkit), tendr√° que omitir de alguna manera el requisito de firma para el controlador.  La capacidad de llamar a ciertas funciones o instrucciones desde el modo kernel en modo kernel puede brindarle al atacante una herramienta para elevar privilegios, revelar informaci√≥n o causar una denegaci√≥n de servicio.  Llamamos a esta funcionalidad una funcionalidad de doble prop√≥sito (en algunos casos, esto puede llamarse vulnerabilidades o puertas traseras, sin embargo, la discusi√≥n sobre la definici√≥n correcta est√° m√°s all√° del alcance de este art√≠culo). </p><br><h2 id="sposoby-obhoda-dse">  <strong>Soluciones alternativas de DSE</strong> </h2><br><p>  Veamos qu√© opciones tiene generalmente un atacante para evitar DSE (de alguna manera debe penetrar ring0).  La siguiente tabla resume las formas de eludir DSE con sus ventajas y desventajas (para el atacante y los guardias de seguridad tomen nota).  Vale la pena se√±alar que esta informaci√≥n se aplica a Windows x64, comenzando con Vista. </p><br><div class="scrollable-table"><table><thead><tr><th>  Camino </th><th>  Los beneficios </th><th>  Desventajas </th></tr></thead><tbody><tr><td>  Configuraci√≥n de datos de configuraci√≥n de arranque (modo de prueba) </td><td>  Simplicidad </td><td><ul><li>  No funciona para todas las aplicaciones. </li><li>  Aparece una marca de agua en el escritorio </li><li>  Reinicio requerido </li></ul></td></tr><tr><td>  Usar una clave privada comprometida </td><td>  Posibilidad de instalar cualquier controlador </td><td><ul><li>  Si se detecta una fuga, el certificado se agrega a la Lista de revocaci√≥n de certificados (CRL) </li></ul></td></tr><tr><td>  Uso de la vulnerabilidad en la implementaci√≥n del control DSE </td><td>  No detectado por los sistemas antivirus y de seguridad de Windows </td><td><ul><li>  Dificultad para encontrar tales vulnerabilidades </li><li>  Depende de la versi√≥n del sistema operativo </li></ul></td></tr><tr><td>  Modificaci√≥n de los mecanismos de comprobaci√≥n de controladores (bootmgr, winload.exe, winresume.exe, ci.dll) </td><td>  Posibilidad de instalar cualquier controlador sin verificaciones OC </td><td><ul><li>  Complejidad de modificaci√≥n </li><li>  Requiere una forma de evitar el arranque seguro (si est√° habilitado) </li><li>  Reinicio requerido </li><li>  Depende de la versi√≥n del sistema operativo </li><li>  Otros controles de archivo </li></ul></td></tr><tr><td>  Usar un controlador firmado con vulnerabilidad </td><td>  Dificultad de detecci√≥n de ataque </td><td><ul><li>  Dificultad para encontrar tales vulnerabilidades </li><li>  Bloqueo de seguridad de detecci√≥n </li></ul></td></tr><tr><td>  Usar un controlador firmado con funcionalidad de doble prop√≥sito </td><td>  No detectado por los sistemas antivirus y de seguridad de Windows </td><td><ul><li>  La complejidad de la b√∫squeda (para un atacante) de un controlador con la funcionalidad de doble prop√≥sito requerida </li></ul></td></tr></tbody></table></div><br><p>  Como puede ver en la tabla, un controlador firmado con funcionalidad de doble prop√≥sito es la forma m√°s atractiva de evitar DSE para un atacante. </p><br><h2 id="opasnaya-funkcionalnost-ili-funkcionalnost-dvoynogo-naznacheniya">  <strong>Funcionalidad peligrosa o de doble prop√≥sito.</strong> </h2><br><p>  Veamos ejemplos de capacidades maliciosas en las que aparece un atacante en presencia de un controlador con funciones peligrosas de doble prop√≥sito. </p><br><ul><li> Escalada de privilegios a nivel de administrador / SISTEMA.  Lectura / escritura de memoria f√≠sica requerida.  Este ataque puede llevarse a cabo, por ejemplo, utilizando el controlador ASMMAP de ASUS.  Para hacer esto, lea la memoria f√≠sica y encuentre la estructura EPROCESS (es un elemento de una lista enlazada), luego revise la lista en busca del proceso cuyo nivel de privilegio queremos aumentar, as√≠ como alg√∫n proceso conocido con el nivel SYSTEM (por ejemplo, lsass, wininit).  Luego copie el valor del campo Token de la estructura del proceso del sistema en la estructura del proceso de destino.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Aqu√≠</a> se da una descripci√≥n m√°s detallada del ataque. </li><li>  Desactivar SMEP.  Para hacer esto, debe escribir en el registro de control cr4 (m√°s precisamente, restablecer su bit 20).  Por ejemplo, el controlador bandainamcoonline.sys no solo deshabilita SMEP, sino que tambi√©n ejecuta √∫tilmente el c√≥digo de acuerdo con el puntero que le pas√≥ el usuario.  Para aquellos interesados, hay <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">un art√≠culo</a> con una descripci√≥n detallada del controlador. </li><li><p>  Ejecuci√≥n de c√≥digo arbitrario en modo kernel.  Se requiere memoria f√≠sica de lectura / escritura y MSR.  El significado es reemplazar la direcci√≥n (ubicada en uno de los MSR), a la que se realizar√° la transici√≥n al hacer una llamada al sistema, a la direcci√≥n de la ubicaci√≥n del c√≥digo del atacante.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Aqu√≠</a> puede encontrar m√°s informaci√≥n sobre esto.  PatchGuard interferir√° en el camino, pero puedes resolverlo si lo deseas. </p><br><blockquote>  Dado que el controlador y PatchGuard se ejecutan en el Anillo 0, nada impide que el controlador desactive las revisiones de PatchGuard (hasta, por supuesto, hasta que Microsoft escuche a Intel y vaya m√°s all√° del modelo con dos anillos de protecci√≥n).  Los desarrolladores del kernel de Microsoft son conscientes de este hecho y realizan diversas acciones para ocultar la ubicaci√≥n de este c√≥digo, ofuscar sus acciones y las estructuras internas utilizadas.  En otras palabras, debido a la incapacidad de evitar que modifiques el c√≥digo PatchGuard, hacen todo lo posible para ocultarlo. <br><br>  - <em>Blunden B. El arsenal de Rootkit: escape y evasi√≥n en los rincones oscuros del sistema.</em> </blockquote><br><div class="spoiler">  <b class="spoiler_title">El original</b> <div class="spoiler_text"><blockquote>  Dado que el c√≥digo del controlador y el c√≥digo de PatchGuard se ejecutan en el Anillo 0, no hay nada que evite que un KMD desactive las comprobaciones de PatchGuard (a menos, por supuesto, que Microsoft siga el ejemplo de Intel y vaya m√°s all√° de un modelo de privilegio de dos anillos).  Los ingenieros de kernel de Microsoft son muy conscientes de este hecho y realizan todo tipo de acrobacias de programaci√≥n para ofuscar d√≥nde reside el c√≥digo, qu√© hace y las estructuras internas de datos que manipula.  En otras palabras, no pueden evitar que modifiques el c√≥digo de PatchGuard, por lo que intentar√°n ocultarlo. <br><br>  - <em>Blunden B. El arsenal de Rootkit: escape y evasi√≥n en los rincones oscuros del sistema.</em> </blockquote><br></div></div><br></li></ul><br><ul><li>  Entrada de BIOS.  Un ejemplo en la naturaleza es <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Lojax</a> .  Los atacantes tomaron el conocido RwDrv.sys y lo usaron para sus prop√≥sitos sucios: leyeron el BIOS, modificaron y escribieron de nuevo.  Reinstalar Windows no ayudar√° aqu√≠, ya que el c√≥digo malicioso se encuentra en el firmware en SPI-flash.  Si la sobrescritura del BIOS no tiene √©xito (o se sobrescribe especialmente), entonces tambi√©n ser√° desagradable.  En cualquier caso, tendr√° que conducir despu√©s del programador para solucionar las molestas consecuencias. </li><li>  Llame al manejador de SMI.  En primer lugar, no todos los BIOS son igualmente indefensos contra el c√≥digo en modo ring0: existen varios mecanismos para la protecci√≥n de lectura / escritura, por lo que puede haber una situaci√≥n en la que deba descender al modo SMM (el m√°s privilegiado).  Una forma de llegar desde el modo kernel es extraer el controlador SMI (a menudo hay algunos vulnerables entre ellos).  Para llamar al controlador SMI, debe poder escribir en el puerto de E / S, y esto solo se puede hacer con privilegios ring0.  Es decir, un controlador con la capacidad de escribir en puertos de E / S puede detectar un controlador SMI vulnerable que puede permitir que un atacante ejecute c√≥digo en modo SMM.  En el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">ejemplo, el</a> autor usa el controlador RwDrv.sys. </li><li>  Informaci√≥n sobre el sistema.  Lectura de la memoria del n√∫cleo (a trav√©s de la lectura de la memoria f√≠sica), lectura del BIOS, informaci√≥n sobre la configuraci√≥n del sistema, dispositivos conectados y mecanismos de protecci√≥n habilitados / deshabilitados (a trav√©s de la lectura de MSR, registros de control, acceso a puertos de entrada / salida), en algunos casos, se puede detectar un hipervisor conocido ( como VirtualBox a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">trav√©s de MSR</a> ).  Para esta tarea, incluso un controlador que solo puede leer, no necesariamente escribir, a menudo es adecuado.  Por ejemplo, RamCaptureDriver64.sys de Belkasoft es adecuado para leer memoria f√≠sica. </li></ul><br><p>  Si analizamos varios art√≠culos y notas sobre CVE, podemos distinguir algunas clasificaciones de potencialmente peligrosas al acceder desde las funciones ring3 en los controladores.  La siguiente tabla enumera las funciones peligrosas y las fuentes de informaci√≥n sobre ellas. </p><br><div class="scrollable-table"><table><thead><tr><th>  Funciones peligrosas identificadas </th><th>  Fuentes de informaci√≥n sobre pr√°cticas de seguridad. </th></tr></thead><tbody><tr><td>  Leer / escribir registros MSR </td><td>  CVE-2018-10711, CVE-2018-18535, CVE-2018-19323, CVE-2007-5633, CVE-2007-5761 </td></tr><tr><td>  Lectura / escritura de puertos de E / S </td><td>  CVE-2018-10712, CVE-2018-18536, CVE-2018-19322 </td></tr><tr><td>  Leer / escribir memoria f√≠sica </td><td>  CVE-2018-16712, CVE-2018-10710, CVE-2017-15302, CVE-2017-15303, CVE-2018-19321 </td></tr><tr><td>  Registros de control de lectura / escritura </td><td>  CVE-2018-10709, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Eset - Explotaci√≥n de Windows en 2016</a> </td></tr><tr><td>  Acceso a rendimiento / contadores de reloj </td><td>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Leif Uhsadel, Andy Georges, Ingrid Verbauwhed - Explotaci√≥n de contadores de rendimiento de hardware</a> </td></tr><tr><td>  Leer / escribir registro de bandera </td><td>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Wojtczuk R., Rutkowska J. Siguiendo al Conejo Blanco: ataques de software contra la tecnolog√≠a Intel VT-d</a> </td></tr><tr><td>  Instrucciones de acceso a cach√© </td><td>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Detecci√≥n de ataques de canal lateral basados ‚Äã‚Äãen cach√© a trav√©s de la tecnolog√≠a de monitoreo de cach√© Intel y contadores de rendimiento de hardware</a> </td></tr></tbody></table></div><br><p>  Y esta no es la lista completa de posibles funciones peligrosas.  Tambi√©n puede hablar sobre lectura / escritura de memoria virtual del n√∫cleo, lectura / escritura de MMIO, acceso a dispositivos PCI, etc. </p><br><p>  Las tres primeras funciones son de gran inter√©s, as√≠ como el mayor peligro (y es m√°s probable que encuentre un controlador con tales funciones): leer / escribir registros MSR, leer / escribir puertos de E / S, leer / escribir memoria f√≠sica.  Al usar los registros de control, puede omitir algunos mecanismos de protecci√≥n, escribir en el registro de banderas le permite habilitar los puertos de entrada / salida de lectura / escritura en ring3 (por cierto, se menciona en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">este</a> art√≠culo en Habr√©), el √©xito de los ataques en canales de terceros (accediendo a la cach√©, monitoreando contadores rendimiento / ciclos) es muy poco probable. </p><br><p>  En el proceso de creaci√≥n de este material en la conferencia DEFCON 27 en Las Vegas, los investigadores Jesse Michael y Mickey Shkatov presentaron el trabajo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">"Salga del n√∫cleo si no puede conducir"</a> , que tambi√©n analiza este problema, y ‚Äã‚Äãle recomendamos que estudie este material para completar la imagen.  Los escenarios para usar dichos controladores son muy simples y claros, y se presentan ejemplos de secciones de c√≥digo responsables de la funcionalidad m√°s cr√≠tica.  Y tambi√©n proporciona <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">c√≥digo</a> para trabajar y encontrar controladores similares. </p><br><p>  En general, vale la pena se√±alar que este tema siempre ha estado preocupado por los investigadores de seguridad.  En 2018, el investigador Alexander Matrosov en su art√≠culo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">"¬øQu√© hace que los controladores del sistema operativo sean peligrosos para el BIOS?"</a>  plante√≥ esta pregunta y demostr√≥ lo simple que es explotar el BIOS. </p><br><h2 id="drayvery-s-funkciyami-dvoynogo-naznacheniya">  <strong>Controladores de doble funci√≥n</strong> </h2><br><p>  A continuaci√≥n se muestran los representantes m√°s famosos de controladores con funciones de doble prop√≥sito. </p><br><ul><li><p>  RwDrv.sys es un controlador muy popular (viene con la utilidad <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">RWeverything</a> ).  Lee y escribe memoria f√≠sica, puertos de E / S, MSR y registros de control.  Se us√≥ repetidamente en varios PoC y luego en el rootkit Lojax mencionado anteriormente.  Se escribe una <a href="">interfaz para √©l</a> en C ++, y tambi√©n se usa en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">chipsec</a> . </p><br></li><li><p>  cpuz / gpuz </p><br><div class="oembed"><twitter-widget class="twitter-tweet twitter-tweet-rendered" id="twitter-widget-0" style="position: absolute; visibility: hidden; display: block; transform: rotate(0deg); max-width: 100%; width: 500px; min-width: 220px; margin-top: 10px; margin-bottom: 10px;" data-tweet-id="561208359383097346"></twitter-widget><blockquote class="twitter-tweet" data-lang="en_US" data-twitter-extracted-i1582099016258291086="true"><p lang="en" dir="ltr">  Haciendo [V] HW IO fuzzing?  Echa un vistazo a GPU-Z.sys (firmado).  Wraps in / out / MmMapIoSpace / wrmsr / etc a trav√©s de IOCTLs :) - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">http://t.co/VwCYsm97rr</a> </p>  - Kostya Kortchinsky (@ crypt0ad) <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">30 de enero de 2015</a> </blockquote><script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script></div><br><p>  Lee y escribe memoria f√≠sica, puertos y MSR.  Hay varias utilidades de PoC que lo usan ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu√≠</a> y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu√≠</a> ). </p><br></li><li><p>  pcdsrvc_x64: controlador de Dell; para obtener m√°s informaci√≥n, comun√≠quese con <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">esta</a> publicaci√≥n.  Le permite leer / escribir memoria f√≠sica en puertos de E / S. </p><br></li><li><p>  AsIO64.sys <br><img src="https://habrastorage.org/webt/nt/lv/kt/ntlvkt0qhmrs_otokd_exel9bqw.png" alt="imagen"><br>  Proporciona la capacidad de leer / escribir memoria f√≠sica y puertos de E / S, y tambi√©n viene con un dll conveniente para realizar estas solicitudes. </p><br></li><li><p>  Asmmap64.sys es otro controlador de ASUS que le permite leer / escribir memoria f√≠sica, puertos de E / S y MSR.  Ser√≠a especialmente agradable para un atacante, ya que el acceso al controlador puede hacerse desde un usuario normal sin derechos de administrador.  Las personas curiosas pueden recurrir a la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">fuente</a> . </p><br></li><li><p>  ntiolib_x64.sys / winio64.sys: controladores de MSI, se describen en detalle en el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">art√≠culo</a> mencionado anteriormente.  Usando ntiolib_x64.sys puede leer / escribir memoria f√≠sica, puertos de E / S y MSR, winio64.sys proporciona todas estas funciones excepto MSR. </p><br></li></ul><br><p>  Por lo general, las funciones peligrosas descritas se reconocen como vulnerabilidades si el usuario puede acceder al controlador sin derechos de administrador (ACL incorrecta) o cuando permite ejecutar c√≥digo arbitrario directamente (como en bandainamcoonline.sys).  En otros casos, esto es solo funcionalidad, y dado que el usuario tiene derechos de administrador, puede usar todas las funciones del controlador y esta es la norma. </p><br><p>  Si crees que no hay m√°s de una docena de esos controladores, est√°s muy equivocado.  Puedes ver <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">esta selecci√≥n de</a> controladores interesantes.  Esta lista contiene controladores de ASUS, AVAST, Razer, LG, American Megatrends y otras compa√±√≠as conocidas.  As√≠ que hay muchos, solo necesitas buscar.  Por lo tanto, representan una amenaza real. </p><br><p>  Los empleados de Microsoft tambi√©n entienden esta amenaza.  Y estar√°n agradecidos por la informaci√≥n sobre tales controladores;) <br><img src="https://habrastorage.org/webt/ch/cd/pt/chcdptm1b5s848omknbcd0sr-im.png" alt="imagen"></p><br><h2 id="rekomendacii">  <strong>Recomendaciones</strong> </h2><br><p>  Para usuarios: </p><br><ul><li>  No debe sentarse innecesariamente bajo la cuenta de administrador y deshabilitar UAC (aunque no es dif√≠cil <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">evitarlo</a> ). </li><li>  Puede instalar el detector intentando instalar controladores (por ejemplo, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu√≠</a> ). </li><li>  Si es necesario utilizar utilidades con dichos controladores (diagn√≥stico, para actualizar el BIOS, etc.), elimine los controladores despu√©s de su uso. </li><li>  Configure <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Device Guard</a> (si es un feliz propietario de Windows 10).  Con esta tecnolog√≠a, puede crear su propia pol√≠tica de integridad de c√≥digo y agregar listas blancas de programas y certificados.  Por ejemplo, agregue a la pol√≠tica el requisito de que cualquier controlador en modo kernel debe tener una firma WHQL de Microsoft.  En <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">esta</a> publicaci√≥n, puede familiarizarse mejor con la configuraci√≥n de Device Guard para este prop√≥sito. </li></ul><br><p>  Es mejor que los fabricantes no firmen dichos controladores.  Si el usuario necesita actualizar el BIOS, verifique si hay vulnerabilidades en el sistema (hola, chipsec), mida el rendimiento o realice otras manipulaciones que requieran la instalaci√≥n de dichos controladores, entonces muy bien puede ingresar al Modo de prueba, hacer todo esto y luego salir.  La usabilidad disminuir√°, pero la seguridad aumentar√°. </p><br><h2 id="vyvody">  <strong>Conclusiones</strong> </h2><br><p>  Si algo est√° firmado, entonces no puedes confiar en √©l de todos modos.  En primer lugar, puede firmar algo as√≠ y, en segundo lugar, un atacante puede aprovechar este firmado (incluso si es de un fabricante de confianza). </p><br><p>  Los especialistas en seguridad de la informaci√≥n no deben excluir del modelo de amenazas situaciones en las que un atacante requiere un controlador con funcionalidad peligrosa para realizar un ataque.  Hay suficientes controladores de este tipo; es bastante simple hacer esto.  Si el ataque no se lleva a cabo con un controlador pop como RwEverything, pero con uno menos conocido, ser√° a√∫n m√°s dif√≠cil detectarlo.  Por lo tanto, debe estar alerta, monitorear tales cosas y no permitir que cada controlador arranque en el sistema. </p><br><p>  Autor: Elizaveta Khomenko </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/468691/">https://habr.com/ru/post/468691/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../468677/index.html">El anuncio del tel√©fono inteligente Xiaomi Mi Mix Alpha</a></li>
<li><a href="../468679/index.html">El ABC de la seguridad en Kubernetes: autenticaci√≥n, autorizaci√≥n, auditor√≠a</a></li>
<li><a href="../468683/index.html">Teor√≠a y pr√°ctica de la estandarizaci√≥n de los servicios de Docker.</a></li>
<li><a href="../468687/index.html">Analizamos las nuevas iniciativas del Banco Central para regular el mercado de valores: 3 grupos de inversores, restricciones para principiantes</a></li>
<li><a href="../468689/index.html">Registrar su negocio de TI en Singapur: ¬øqu√© debo hacer?</a></li>
<li><a href="../468693/index.html">C√≥mo la automatizaci√≥n destruye a los empleados de Walmart</a></li>
<li><a href="../468703/index.html">¬øC√≥mo puede un programador ganar a√∫n m√°s?</a></li>
<li><a href="../468705/index.html">Videollamada en el navegador en PeerJS. Inicio r√°pido</a></li>
<li><a href="../468707/index.html">Open PostgreSQL Meetup UPD Grabaci√≥n Difusi√≥n y presentaci√≥n</a></li>
<li><a href="../468713/index.html">Proyecto de intercambio de criptomonedas legales</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>