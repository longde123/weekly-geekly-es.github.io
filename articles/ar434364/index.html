<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ช๐ฟ ๐ฉ๐พโ๐พ โ ุฏุนู ูุงุฆูุฉ ุงูุชุธุงุฑ Hangfire โ๏ธ โ๏ธ ๐ธ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hangfire ูู ููุชุจุฉ ู. net (ุงูุฃุณุงุณูุฉ) ุ ูุงูุชู ุชุณูุญ ุจุชูููุฐ ุบูุฑ ูุชุฒุงูู ูุจุนุถ ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุนูู ูุจุฏุฃ "ุงููุงุฑ ููุณูุงู". ูุซุงู ุนูู ูุฐุง ุงูุฑูุฒ ูููู ุฃู ูููู ุฅุฑ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ุฏุนู ูุงุฆูุฉ ุงูุชุธุงุฑ Hangfire</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/434364/" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl">  Hangfire ูู ููุชุจุฉ ู. net (ุงูุฃุณุงุณูุฉ) ุ ูุงูุชู ุชุณูุญ ุจุชูููุฐ ุบูุฑ ูุชุฒุงูู ูุจุนุถ ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุนูู ูุจุฏุฃ "ุงููุงุฑ ููุณูุงู".  ูุซุงู ุนูู ูุฐุง ุงูุฑูุฒ ูููู ุฃู ูููู ุฅุฑุณุงู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ุ ููุนุงูุฌุฉ ุงูููุฏูู ุ ูุงููุฒุงููุฉ ูุน ูุธุงู ุขุฎุฑ ุ ุงูุฎ  ุจุงูุฅุถุงูุฉ ุฅูู "ุฅุทูุงู ุงููุงุฑ ููุณูุงู" ุ ููุงู ุฏุนู ููููุงู ุงููุคุฌูุฉ ุ ููุฐูู ุงูููุงู ุงููุฌุฏููุฉ ุจุชูุณูู Cron. </p><br><p style=";text-align:right;direction:rtl">  ุญุงููุง ุ ููุงู ุงูุนุฏูุฏ ูู ูุฐู ุงูููุชุจุงุช.  ุจุนุถ ููุงุฆุฏ Hangfire ูู: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุงูุชูููู ุจุณูุท ุ API ูุฑูุญุฉ </li><li style=";text-align:right;direction:rtl">  ุงูููุซูููุฉ  ูุถูู Hangfire ุฃู ุงููููุฉ ุงูุชู ุชู ุฅูุดุงุคูุง ุณูุชู ุชูููุฐูุง ูุฑุฉ ูุงุญุฏุฉ ุนูู ุงูุฃูู </li><li style=";text-align:right;direction:rtl">  ุงููุฏุฑุฉ ุนูู ุฃุฏุงุก ุงูููุงู ูู ุฃุฏุงุก ูุชูุงุฒู ูููุชุงุฒ </li><li style=";text-align:right;direction:rtl">  ุงููุงุจููุฉ ููุชูุณุนุฉ (ุณูุณุชุฎุฏููุง ุฃุฏูุงู) </li><li style=";text-align:right;direction:rtl">  ูุซุงุฆู ูุงููุฉ ุฅูู ุญุฏ ูุง ููููููุฉ </li><li style=";text-align:right;direction:rtl">  ููุญุฉ ุงูููุงุฏุฉ ุงูุชู ููููู ุฃู ุชุฑู ุฌููุน ุงูุฅุญุตุงุกุงุช ุญูู ุงูููุงู </li></ul><br><p style=";text-align:right;direction:rtl">  ูู ุฃุฎูุถ ูู ุงููุซูุฑ ูู ุงูุชูุงุตูู ุ ูุธุฑูุง ููุฌูุฏ ุงูุนุฏูุฏ ูู ุงูููุงูุงุช ุงูุฌูุฏุฉ ุญูู Hangfire ูููููุฉ ุงุณุชุฎุฏุงููุง.  ุณุฃูุงูุด ูู ูุฐู ุงูููุงูุฉ ููููุฉ ุงุณุชุฎุฏุงู ุฏุนู ุงูุนุฏูุฏ ูู ููุงุฆู ุงูุงูุชุธุงุฑ (ุฃู ุชุฌูุนุงุช ุงูููุงู) ุ ูููููุฉ ุฅุตูุงุญ ูุธููุฉ ุฅุนุงุฏุฉ ุงููุญุงููุฉ ุงูููุงุณูุฉ ูุฌุนู ูู ูุงุฆูุฉ ุงูุชุธุงุฑ ููุง ุชูููู ูุฑุฏู. </p><a name="habracut"></a><br><h3 id="suschestvuyuschaya-podderzhka-psevdo-ocheredey" style=";text-align:right;direction:rtl">  ุงูุฏุนู ุงูุญุงูู ูููุงุฆู ุงูุงูุชุธุงุฑ (ุงูุฒุงุฆูุฉ) </h3><br><p style=";text-align:right;direction:rtl">  ููุงุญุธุฉ ูููุฉ: ูู ุงูุนููุงู ุ ุงุณุชุฎุฏูุช ุนุจุงุฑุฉ "ูุงุฆูุฉ ุงูุงูุชุธุงุฑ ุงูุฒุงุฆูุฉ" ูุฃู Hangfire ูุง ูุถูู ุชูููุฐ ุงูููุงู ุจุชุฑุชูุจ ูุนูู.  ุฃู  ูุง ููุทุจู ูุจุฏุฃ "First In First Out" ููู ูุนุชูุฏ ุนููู.  ุนูุงูุฉ ุนูู ุฐูู ุ ููุตู ูุคูู ุงูููุชุจุฉ ุจุฌุนู ุงูููุงู ุบูุฑ ููุงุณุจุฉ ุ ุฃู  ุซุงุจุช ุถุฏ ุชูููุฐ ูุชุนุฏุฏุฉ ุบูุฑ ูุชููุนุฉ.  ูุฐูู ุณูู ุชุณุชุฎุฏู ูููุฉ "ูุงุฆูุฉ ุงูุงูุชุธุงุฑ" ููุท ุ ูุฃูู  ูุณุชุฎุฏู Hangfire ูุตุทูุญ "ูุงุฆูุฉ ุงูุงูุชุธุงุฑ". </p><br><p style=";text-align:right;direction:rtl">  Hangfire ูุฏูู ุฏุนู ูุงุฆูุฉ ุงูุชุธุงุฑ ุจุณูุทุฉ.  ุนูู ุงูุฑุบู ูู ุฃูู ูุง ูููุฑ ูุฑููุฉ ูุฃูุธูุฉ ูุงุฆูุฉ ุงูุชุธุงุฑ ุงูุฑุณุงุฆู ูุซู rabbitMQ ุฃู Azure Service Bus ุ ุฅูุง ุฃูู ุบุงูุจูุง ูุง ูููู ูุญู ูุฌููุนุฉ ูุงุณุนุฉ ูู ุงูููุงู. </p><br><p style=";text-align:right;direction:rtl">  ุชุญุชูู ูู ูููุฉ ุนูู ุฎุงุตูุฉ "ูุงุฆูุฉ ุงูุงูุชุธุงุฑ" ุ ุฃู ุงุณู ูุงุฆูุฉ ุงูุงูุชุธุงุฑ ุงูุชู ูุฌุจ ุชูููุฐูุง ูููุง.  ุจุดูู ุงูุชุฑุงุถู ุ ูุชู ุฅุฑุณุงู ุงููููุฉ ุฅูู ูุงุฆูุฉ ุงูุงูุชุธุงุฑ ุจุงุณู "ุงูุงูุชุฑุงุถู" ุ ูุง ูู ููุต ุนูู ุฎูุงู ุฐูู.  ููุงู ุญุงุฌุฉ ุฅูู ุฏุนู ููุงุฆู ุงูุงูุชุธุงุฑ ุงููุชุนุฏุฏุฉ ูู ุฃุฌู ุฅุฏุงุฑุฉ ูููุตูุฉ ูุชูููุฐ ุงูููุงู ูู ุฃููุงุน ูุฎุชููุฉ.  ุนูู ุณุจูู ุงููุซุงู ุ ูุฏ ููุฏ ุฃู ุชูุน ููุงู ูุนุงูุฌุฉ ุงูููุฏูู ูู ูุงุฆูุฉ ุงูุชุธุงุฑ "video_queue" ุ ูุชุฑุณู ุฑุณุงุฆู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ุฅูู ูุงุฆูุฉ ุงูุชุธุงุฑ "email_queue".  ูุจุงูุชุงูู ุ ูุญู ูุงุฏุฑูู ุนูู ุฃุฏุงุก ูุฐูู ุงูููุนูู ูู ุงูููุงู ุจุดูู ูุณุชูู.  ุฅุฐุง ููุง ูุฑูุฏ ููู ูุนุงูุฌุฉ ุงูููุฏูู ุฅูู ุฎุงุฏู ูุฎุตุต ุ ููููููุง ุงูููุงู ุจุฐูู ุจุณูููุฉ ุนู ุทุฑูู ุชุดุบูู ุฎุงุฏู Hangfire ูููุตู ูุชุทุจูู ูุญุฏุฉ ุชุญูู ุณูููู ุจูุนุงูุฌุฉ ูุงุฆูุฉ ุงูุชุธุงุฑ "video_queue". </p><br><h3 id="pereydem-k-praktike" style=";text-align:right;direction:rtl">  ุฏุนูุง ููุชูู ุฅูู ุงูููุงุฑุณุฉ </h3><br><p style=";text-align:right;direction:rtl">  ุฅุนุฏุงุฏ ุฎุงุฏู Hangfire ูู asp.net core ูู ููุง ููู: </p><br><pre style=";text-align:right;direction:rtl"><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Configure</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">IApplicationBuilder app</span></span></span><span class="hljs-function">)</span></span> { app.UseHangfireServer(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BackgroundJobServerOptions { WorkerCount = <span class="hljs-number"><span class="hljs-number">2</span></span>, Queues = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span>[] { <span class="hljs-string"><span class="hljs-string">"email_queue"</span></span>, <span class="hljs-string"><span class="hljs-string">"video_queue"</span></span> } }); }</code> </pre> <br><h3 id="problema-1---zadachi-pri-povtore-popadayut-v-ochered-default" style=";text-align:right;direction:rtl">  ุงููุดููุฉ 1 - ุชูุน ููุงู ุฅุนุงุฏุฉ ุงูุชุดุบูู ูู ูุงุฆูุฉ ุงูุงูุชุธุงุฑ ุงูุงูุชุฑุงุถูุฉ </h3><br><p style=";text-align:right;direction:rtl">  ููุง ุฐูุฑุช ุฃุนูุงู ุ ููุงู ูุงุฆูุฉ ุงูุชุธุงุฑ ุงูุชุฑุงุถูุฉ ูู Hangfire ุชุณูู "ุงูุงูุชุฑุงุถู".  ุฅุฐุง ูุดูุช ุงููููุฉ ุงูููุถูุนุฉ ูู ูุงุฆูุฉ ุงูุงูุชุธุงุฑ ุ ุนูู ุณุจูู ุงููุซุงู ุ "video_queue" ูุชุญุชุงุฌ ุฅูู ุฅุนุงุฏุฉ ุงููุญุงููุฉ ุ ูุณูุชู ุฅุฑุณุงููุง ุฅูู ูุงุฆูุฉ ุงูุงูุชุธุงุฑ "ุงูุงูุชุฑุงุถูุฉ" ูุฑุฉ ุฃุฎุฑู ูููุณ "video_queue" ุ ููุชูุฌุฉ ูุฐูู ุ ูู ูุชู ุชูููุฐ ุงููููุฉ ุนูู ุงูุฅุทูุงู ูุซูู ุฎุงุฏู Hangfire ุงูุฐู ููุฏ ุ ุนูู ูู ุญุงู.  ุชู ุฅูุดุงุก ูุฐุง ุงูุณููู ุจูุงุณุทุชู ุจุดูู ุชุฌุฑูุจู ูุฑุจูุง ูููู ุฎุทุฃ ูู Hangfire ููุณูุง. </p><br><h4 id="job-filters" style=";text-align:right;direction:rtl">  ูุฑุดุญุงุช ุงููุธููุฉ </h4><br><p style=";text-align:right;direction:rtl">  ูููุฑ ููุง Hangfire ุฅููุงููุฉ ุชูุณูุน ุงููุธููุฉ ุจูุณุงุนุฏุฉ ุงููุฑุดุญุงุช ุงููุณูุงุฉ (ูุฑุดุญุงุช <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงููุธููุฉ</a> ) ุ ูุงูุชู ุชุดุจู ูู ุญูุซ ุงููุจุฏุฃ ุนูุงูู ุชุตููุฉ ุงูุฅุฌุฑุงุกุงุช ูู ASP.NET MVC.  ุงูุญูููุฉ ูู ุฃู ุงูููุทู ุงูุฏุงุฎูู ูู Hangfire ูุชู ุชูููุฐู ูุขูุฉ ุญููููุฉ.  ูุฐุง ูู ุงููุญุฑู ุงูุฐู ูููู ุงูููุงู ูู ุงูุชุฌูุน ุจุดูู ูุชุชุงุจุน ูู ุญุงูุฉ ุฅูู ุฃุฎุฑู (ุนูู ุณุจูู ุงููุซุงู ุ ุชู ุฅูุดุงุคู -&gt; enqueued -&gt; ูุนุงูุฌุฉ -&gt; ูุฌุญ) ุ ูุชุชูุญ ููุง ุนูุงูู ุงูุชุตููุฉ "ุงุนุชุฑุงุถ" ุงููููุฉ ุงูุชู ูุชู ุชูููุฐูุง ูู ูู ูุฑุฉ ุชุชุบูุฑ ุญุงูุชูุง ูุงูุชุนุงูู ูุนูุง.  ูุชู ุชุทุจูู ุนุงูู ุงูุชุตููุฉ ูุณูุฉ ูููู ุชุทุจูููุง ุนูู ุทุฑููุฉ ูุงุญุฏุฉ ุฃู ูุฆุฉ ุฃู ุนูู ูุณุชูู ุนุงููู. </p><br><h4 id="job-parameters" style=";text-align:right;direction:rtl">  ูุนููุงุช ุงููุธููุฉ </h4><br><p style=";text-align:right;direction:rtl">  ูุชู ุชูุฑูุฑ ุงููุงุฆู ElectStateContext ููุณูุทุฉ ุฅูู ุฃุณููุจ ุนุงูู ุงูุชุตููุฉ.  ูุญุชูู ูุฐุง ุงููุงุฆู ุนูู ูุนูููุงุช ูุงููุฉ ุญูู ุงููููุฉ ุงูุญุงููุฉ.  ูู ุจูู ุฃุดูุงุก ุฃุฎุฑู ุ ูุญุชูู ุนูู ุฃุณุงููุจ GetJobParameter &lt;&gt; (...) ู SettJobParameter &lt;&gt; (...).  ุชุชูุญ ูู ูุนููุงุช ุงููููุฉ ุญูุธ ุงููุนูููุงุช ุงููุชุนููุฉ ุจุงููููุฉ ูู ูุงุนุฏุฉ ุจูุงูุงุช.  ูู ูุนููุงุช ุงููุธููุฉ ุ ูุชู ุชุฎุฒูู ุงุณู ูุงุฆูุฉ ุงูุงูุชุธุงุฑ ุงูุชู ุชู ุฅุฑุณุงู ุงููููุฉ ุฅูููุง ูู ุงูุฃุตู ุ ูุฐูู ููุท ูุณุจุจ ูู ุงูุฃุณุจุงุจ ุชู ุชุฌุงูู ูุฐู ุงููุนูููุงุช ุฃุซูุงุก ุฅุนุงุฏุฉ ุงููุญุงููุฉ ุงูุชุงููุฉ. </p><br><h3 id="reshenie" style=";text-align:right;direction:rtl">  ุงูุญู </h3><br><p style=";text-align:right;direction:rtl">  ูุฐูู ุ ูุฏููุง ูููุฉ ุงูุชูุช ุจุงูุฎุทุฃ ููุฌุจ ุฅุฑุณุงููุง ูุฅุนุงุฏุฉ ุชูููุฐูุง ูู ูุงุฆูุฉ ุงูุงูุชุธุงุฑ ุงูุตุญูุญุฉ (ูู ููุณ ุงููููุฉ ุงูุชู ุชู ุชุนููููุง ููุง ูู ููุช ุงูุฅูุดุงุก ุงูุฃููู).  ุชูุฑุงุฑ ุงููููุฉ ุงูุชู ุฃูููุช ุจุฎุทุฃ ูุง ูู ุงูุงูุชูุงู ูู ุงูุญุงูุฉ "ุงููุงุดูุฉ" ุฅูู ุงูุญุงูุฉ "ุงููุญุตูุฉ".  ูุญู ุงููุดููุฉ ุ ูู ุจุฅูุดุงุก ุนุงูู ุชุตููุฉ ุ ุนูุฏูุง ุชุฏุฎู ุงููููุฉ ูู ุงูุญุงูุฉ "enqueued" ุ ูุงูุชู ุชุญูู ูู ูุงุฆูุฉ ุงูุงูุชุธุงุฑ ุงูุชู ุชู ุฅุฑุณุงู ุงููููุฉ ูู ุงูุจุฏุงูุฉ ููุถุน ุงููุนููุฉ "QueueName" ูู ุงููููุฉ ุงููุทููุจุฉ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">HangfireUseCorrectQueueFilter</span></span> : <span class="hljs-title"><span class="hljs-title">JobFilterAttribute</span></span>, <span class="hljs-title"><span class="hljs-title">IElectStateFilter</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnStateElection</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">ElectStateContext context</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (context.CandidateState <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> EnqueuedState enqueuedState) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> queueName = context.GetJobParameter&lt;<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>&gt;(<span class="hljs-string"><span class="hljs-string">"QueueName"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.IsNullOrWhiteSpace(queueName)) { context.SetJobParameter(<span class="hljs-string"><span class="hljs-string">"QueueName"</span></span>, enqueuedState.Queue); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { enqueuedState.Queue = queueName; } } } }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุชุทุจูู ุงูููุชุฑ ุงูุงูุชุฑุงุถู ุนูู ุฌููุน ุงูููุงู (ุฃู ุนูู ุงูุตุนูุฏ ุงูุนุงููู) ุ ุฃุถู ุงูููุฏ ุงูุชุงูู ุฅูู ุงูุชูููู ุงูุฎุงุต ุจูุง: </p><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs">GlobalJobFilters.Filters.Add(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HangfireUseCorrectQueueFilter { Order = <span class="hljs-number"><span class="hljs-number">1</span></span> });</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุงูุตูุฏ ุงูุตุบูุฑุฉ ุงูุฃุฎุฑู ูู ุฃู ูุฌููุนุฉ GlobalJobFilters ุงูุชุฑุงุถูุงู ุชุญุชูู ุนูู ูุซูู ููุฆุฉ AutomaticRetryAttribute.  ูุฐุง ุนุงูู ุชุตููุฉ ููุงุณู ูุณุคูู ุนู ุฅุนุงุฏุฉ ุชูููุฐ ุงูููุงู ุงููุงุดูุฉ.  ููุง ูุฑุณู ุงููููุฉ ุฅูู ูุงุฆูุฉ ุงูุงูุชุธุงุฑ "ุงูุงูุชุฑุงุถูุฉ" ุ ูุชุฌุงููุงู ูุงุฆูุฉ ุงูุงูุชุธุงุฑ ุงูุฃุตููุฉ.  ูู ุฃุฌู ุฑููุจ ุงูุฏุฑุงุฌุฉ ุงูุฎุงุตุฉ ุจูุง ุ ุชุญุชุงุฌ ุฅูู ุฅุฒุงูุฉ ูุฐุง ุงูููุชุฑ ูู ุงููุฌููุนุฉ ูุชุฑู ูุฑุดุญูุง ูุชุญูู ูุณุคูููุฉ ุงูููุงู ุงููุชูุฑุฑุฉ.  ูุชูุฌุฉ ูุฐูู ุ ุณูุจุฏู ุฑูุฒ ุงูุชูููู ููุง ููู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> defaultRetryFilter = GlobalJobFilters.Filters .FirstOrDefault(f =&gt; f.Instance <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> AutomaticRetryAttribute); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (defaultRetryFilter != <span class="hljs-literal"><span class="hljs-literal">null</span></span> &amp;&amp; defaultRetryFilter.Instance != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { GlobalJobFilters.Filters.Remove(defaultRetryFilter.Instance); } GlobalJobFilters.Filters.Add(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HangfireUseCorrectQueueFilter { Order = <span class="hljs-number"><span class="hljs-number">1</span></span> });</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุชุฌุฏุฑ ุงูุฅุดุงุฑุฉ ุฅูู ุฃู AutomaticRetryAttribute ุชููุฐ ููุทู ุฒูุงุฏุฉ ุงููุงุตู ุงูุฒููู ุจูู ุงููุญุงููุงุช ุชููุงุฆููุง (ูุฒูุฏ ุงููุงุตู ุงูุฒููู ูุน ูู ูุญุงููุฉ ูุงุญูุฉ) ุ ูุฅุฒุงูุฉ AutomaticRetryAttribute ูู ูุฌููุนุฉ GlobalJobFilters ุ ูุฅููุง ูุชุฎูู ุนู ูุฐู ุงููุธููุฉ (ุงูุธุฑ ุชุทุจูู ุฃุณููุจ <a href="">ScheduleAgainLater</a> ) </p><br><p style=";text-align:right;direction:rtl">  ูุฐูู ุ ููุฏ ุญูููุง ุฃูู ูููู ุชูููุฐ ููุงููุง ูู ุทูุงุจูุฑ ูุฎุชููุฉ ุ ููุฐุง ูุณูุญ ููุง ุจุฅุฏุงุฑุฉ ุชูููุฐูุง ุจุดูู ูุณุชูู ุ ุจูุง ูู ุฐูู ูุนุงูุฌุฉ ุทูุงุจูุฑ ูุฎุชููุฉ ุนูู ุฃุฌูุฒุฉ ูุฎุชููุฉ.  ุงูุขู ููุท ูุง ูุนุฑู ุนุฏุฏ ุงููุฑุงุช ูุงููุชุฑุฉ ุงูุฒูููุฉ ุงูุชู ุณูุชู ูููุง ุชูุฑุงุฑ ููุงููุง ูู ุญุงูุฉ ุญุฏูุซ ุฎุทุฃ ุ ูุฃููุง ุฃุฒููุง AutomaticRetryAttribute ูู ูุฌููุนุฉ ุงููุฑุดุญุงุช. </p><br><h3 id="problema-2---individualnye-nastroyki-dlya-kazhdoy-ocheredi" style=";text-align:right;direction:rtl">  ุงููุดููุฉ 2 - ุงูุฅุนุฏุงุฏุงุช ุงููุฑุฏูุฉ ููู ูุงุฆูุฉ ุงูุชุธุงุฑ </h3><br><p style=";text-align:right;direction:rtl">  ูุฑูุฏ ุฃู ูููู ูุงุฏุฑูู ุนูู ุชูููู ุงููุงุตู ุงูุฒููู ูุนุฏุฏ ุงูุชูุฑุงุฑุงุช ุจุดูู ูููุตู ููู ูุงุฆูุฉ ุงูุชุธุงุฑ ุ ูุฃูุถูุง ุ ุฅุฐุง ูู ูุญุฏุฏ ุจุนุถ ุงูููู ุตุฑุงุญุฉ ุ ูุฅููุง ูุฑูุฏ ุชุทุจูู ุงูููู ุงูุงูุชุฑุงุถูุฉ.  ููููุงู ุจุฐูู ุ ูููู ุจุชุทุจูู ูุฑุดุญ ุขุฎุฑ ููุทูู ุนููู <code>HangfireRetryJobFilter</code> . </p><br><p style=";text-align:right;direction:rtl">  ูู ุงููุงุญูุฉ ุงููุซุงููุฉ ุ ูุฌุจ ุฃู ูุจุฏู ุฑูุฒ ุงูุชูููู ูุซู ูุฐุง: </p><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs">GlobalJobFilters.Filters.Add(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HangfireRetryJobFilter { Order = <span class="hljs-number"><span class="hljs-number">2</span></span>, [<span class="hljs-string"><span class="hljs-string">"email_queue"</span></span>] = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HangfireQueueSettings { DelayInSeconds = <span class="hljs-number"><span class="hljs-number">120</span></span>, RetryAttempts = <span class="hljs-number"><span class="hljs-number">3</span></span> }, [<span class="hljs-string"><span class="hljs-string">"video_queue"</span></span>] = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HangfireQueueSettings { DelayInSeconds = <span class="hljs-number"><span class="hljs-number">60</span></span>, RetryAttempts = <span class="hljs-number"><span class="hljs-number">5</span></span> } });</code> </pre> <br><h3 id="reshenie-1" style=";text-align:right;direction:rtl">  ุงูุญู </h3><br><p style=";text-align:right;direction:rtl">  ููููุงู ุจุฐูู ุ ูู ุฃููุงู ุจุฅุถุงูุฉ ูุฆุฉ <code>HangfireQueueSettings</code> ุ ูุงูุชู ุณุชููู ุจูุซุงุจุฉ ุญุงููุฉ ูุฅุนุฏุงุฏุงุชูุง. </p><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">sealed</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">HangfireQueueSettings</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> RetryAttempts { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> DelayInSeconds { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุซู ูุถูู ุชุทุจูู ุงููุฑุดุญ ููุณู ุ ูุงูุฐู ุ ุนูุฏ ุชูุฑุงุฑ ุงูููุงู ุจุนุฏ ุญุฏูุซ ุฎุทุฃ ุ ุณูุชู ุชุทุจูู ุงูุฅุนุฏุงุฏุงุช ุญุณุจ ุชูููู ูุงุฆูุฉ ุงูุงูุชุธุงุฑ ููุฑุงูุจุฉ ุนุฏุฏ ูุฑุงุช ุฅุนุงุฏุฉ ุงููุญุงููุฉ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">HangfireRetryJobFilter</span></span> : <span class="hljs-title"><span class="hljs-title">JobFilterAttribute</span></span>, <span class="hljs-title"><span class="hljs-title">IElectStateFilter</span></span>, <span class="hljs-title"><span class="hljs-title">IApplyStateFilter</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> HangfireQueueSettings _defaultQueueSettings = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HangfireQueueSettings { RetryAttempts = <span class="hljs-number"><span class="hljs-number">3</span></span>, DelayInSeconds = <span class="hljs-number"><span class="hljs-number">10</span></span> }; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> IDictionary&lt;<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>, HangfireQueueSettings&gt; _settings = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Dictionary&lt;<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>, HangfireQueueSettings&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> HangfireQueueSettings <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>[<span class="hljs-keyword"><span class="hljs-keyword">string</span></span> queueName] { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _settings.TryGetValue(queueName, <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> HangfireQueueSettings queueSettings) ? queueSettings : _defaultQueueSettings; } <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> { _settings[queueName] = <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>; } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnStateElection</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">ElectStateContext context</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!(context.CandidateState <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> FailedState failedState)) { <span class="hljs-comment"><span class="hljs-comment">// This filter accepts only failed job state. return; } var retryAttempt = context.GetJobParameter&lt;int&gt;("RetryCount") + 1; var queueName = context.GetJobParameter&lt;string&gt;("QueueName"); if (retryAttempt &lt;= this[queueName].RetryAttempts) { ScheduleAgainLater(context, retryAttempt, failedState, queueName); } else { TransitionToDeleted(context, failedState, queueName); } } public void OnStateApplied( ApplyStateContext context, IWriteOnlyTransaction transaction) { if (context.NewState is ScheduledState &amp;&amp; context.NewState.Reason != null &amp;&amp; context.NewState.Reason.StartsWith("Retry attempt")) { transaction.AddToSet("retries", context.BackgroundJob.Id); } } public void OnStateUnapplied( ApplyStateContext context, IWriteOnlyTransaction transaction) { if (context.OldStateName == ScheduledState.StateName) { transaction.RemoveFromSet("retries", context.BackgroundJob.Id); } } private void ScheduleAgainLater( ElectStateContext context, int retryAttempt, FailedState failedState, string queueName) { context.SetJobParameter("RetryCount", retryAttempt); var delay = TimeSpan.FromSeconds(this[queueName].DelayInSeconds); const int maxMessageLength = 50; var exceptionMessage = failedState.Exception.Message.Length &gt; maxMessageLength ? failedState.Exception.Message.Substring(0, maxMessageLength - 1) + "โฆ" : failedState.Exception.Message; // If attempt number is less than max attempts, we should // schedule the job to run again later. var reason = $"Retry attempt {retryAttempt} of {this[queueName].RetryAttempts}: {exceptionMessage}"; context.CandidateState = delay == TimeSpan.Zero ? (IState)new EnqueuedState { Reason = reason } : new ScheduledState(delay) { Reason = reason }; } private void TransitionToDeleted( ElectStateContext context, FailedState failedState, string queueName) { context.CandidateState = new DeletedState { Reason = this[queueName].RetryAttempts &gt; 0 ? "Exceeded the maximum number of retry attempts." : "Retries were disabled for this job." }; } }</span></span></code> </pre> <br><blockquote style=";text-align:right;direction:rtl">  ููุงุญุธุฉ ุฅูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ: ุนูุฏ ุชุทุจูู ูุฆุฉ <code>HangfireRetryJobFilter</code> ุ ุชู ุฃุฎุฐ ูุฆุฉ <code>AutomaticRetryAttribute</code> ูู <code>HangfireRetryJobFilter</code> ูุฃุณุงุณ ุ ูุจุงูุชุงูู ูุฅู ุชุทุจูู ุจุนุถ ุงูุทุฑู ูุชุฒุงูู ุฌุฒุฆููุง ูุน ุงูุทุฑู ุงูููุงุจูุฉ ููุฐู ุงููุฆุฉ. </blockquote><br><h3 id="problema-3---kak-otpravit-zadachu-na-vypolnenie-v-konkretnuyu-ochered" style=";text-align:right;direction:rtl">  ุงููุดููุฉ 3 - ููููุฉ ุฅุฑุณุงู ูููุฉ ุฅูู ูุงุฆูุฉ ุงูุชุธุงุฑ ูุญุฏุฏุฉุ </h3><br><p style=";text-align:right;direction:rtl">  ุชูููุช ูู ุงูุนุซูุฑ ุนูู ุทุฑููุชูู ูุชุนููู ุงููููุฉ ุฅูู ูุงุฆูุฉ ุงูุงูุชุธุงุฑ: ููุซูุฉ ู - ูุง. </p><br><p style=";text-align:right;direction:rtl">  <strong>ุงูุทุฑููุฉ ุงูุฃููู</strong> - ุชุนููู ุงูุณูุฉ ุงูููุงุจูุฉ ุนูู ุงูุทุฑููุฉ </p><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs">[<span class="hljs-meta"><span class="hljs-meta">Queue(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"video_queue"</span></span></span><span class="hljs-meta">)</span></span>] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SomeMethod</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { } BackgroundJob.Enqueue(() =&gt; SomeMethod());</code> </pre> <br><p style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">http://docs.hangfire.io/en/latest/background-processing/configuring-queues.html</a> </p><br><p style=";text-align:right;direction:rtl">  <strong>ุงูุทุฑููุฉ ุงูุซุงููุฉ</strong> (ุจุฏูู ูุซุงุฆู) - ุงุณุชุฎุฏู ุงููุฆุฉ <code>BackgroundJobClient</code> </p><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> client = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BackgroundJobClient(); client.Create(() =&gt; MyMethod(), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> EnqueuedState(<span class="hljs-string"><span class="hljs-string">"video_queue"</span></span>));</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุชุชูุซู ููุฒุฉ ุงูุทุฑููุฉ ุงูุซุงููุฉ ูู ุฃููุง ูุง ุชูุดุฆ ุชุจุนูุงุช ุบูุฑ ุถุฑูุฑูุฉ ุนูู Hangfire ูุชุณูุญ ูู ุจุชุญุฏูุฏ ุฃู ุนูููุฉ ูุฌุจ ุฃู ุชุณุชูุฑ ุงููููุฉ ุฎูุงููุง.  ูุณูุก ุงูุญุธ ุ ูู ุงููุซุงุฆู ุงูุฑุณููุฉ ุ ูู ุฃุฌุฏ ุฐูุฑูุง ููุฆุฉ <code>BackgroundJobClient</code> ูููููุฉ ุชุทุจูููุง.  ููุฏ ุงุณุชุฎุฏูุช ุงูุทุฑููุฉ ุงูุซุงููุฉ ูู ุญู ุจูุฏู ุ ูุฐูู ูุชู ุงุฎุชุจุงุฑู ูู ุงูููุงุฑุณุฉ ุงูุนูููุฉ. </p><br><h3 id="zaklyuchenie" style=";text-align:right;direction:rtl">  ุงูุฎุงุชูุฉ </h3><br><p style=";text-align:right;direction:rtl">  ูู ูุฐู ุงูููุงูุฉ ุ ุงุณุชุฎุฏููุง ุฏุนู ููุงุฆู ุงูุชุธุงุฑ ูุชุนุฏุฏุฉ ูู Hangfire ููุตู ูุนุงูุฌุฉ ุฃููุงุน ูุฎุชููุฉ ูู ุงูููุงู.  ุทุจููุง ุขููุชูุง ูุชูุฑุงุฑ ุงูููุงู ุงูููุชููุฉ ุบูุฑ ุงููุงุฌุญุฉ ูุน ุฅููุงููุฉ ุงูุชูููู ุงููุฑุฏู ููู ูุงุฆูุฉ ุงูุชุธุงุฑ ุ ูุชูุณูุน ูุธููุฉ Hangfire ุจุงุณุชุฎุฏุงู Job Filters ุ ูุชุนูููุง ุฃูุถูุง ููููุฉ ุฅุฑุณุงู ุงูููุงู ุฅูู ูุงุฆูุฉ ุงูุงูุชุธุงุฑ ุงููุทููุจุฉ ููุชูููุฐ. </p><br><p style=";text-align:right;direction:rtl">  ุขูู ุฃู ูููู ูุฐุง ุงูููุงู ูููุฏูุง ูุดุฎุต ูุง.  ุณุฃููู ุณุนูุฏุง ููุชุนููู. </p><br><h3 id="poleznye-ssylki" style=";text-align:right;direction:rtl">  ุฑูุงุจุท ูููุฏุฉ </h3><br><p style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุซุงุฆู Hangfire</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุตุฏุฑ ุดูุฑุฉ Hangfire</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Scott Hanselman - ููููุฉ ุชุดุบูู ููุงู ุงูุฎูููุฉ ูู ASP.NET</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar434364/">https://habr.com/ru/post/ar434364/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar434354/index.html">ุฅูุดุงุก ูููุฐุฌ ุงูุชุนุฑู ุนูู ุงููุฌูู ุจุงุณุชุฎุฏุงู ุงูุชุนูู ุงูุนููู ูู ุจูุซูู</a></li>
<li><a href="../ar434356/index.html">ุจูุซูู ุณุชููุฑ ูุน ุงูุจุฑูุฏ ุงูุฅููุชุฑููู</a></li>
<li><a href="../ar434358/index.html">ุงุณุชูุฑุงุฏ ุจุฏูู ูุฃูุธูุฉ ุงูุชุดุบูู. ููู ุฃุฑู ูุธุงู ุงูุชุดุบูู ุงููุญูู</a></li>
<li><a href="../ar434360/index.html">ุดุฑุญ ุงูุญุฏูุซ ุนู ุงูุจุฑูุฌุฉ ุบูุฑ ุงููุชุฒุงููุฉ ูู ุฌุงูุง ุณูุฑูุจุช</a></li>
<li><a href="../ar434362/index.html">ูุง ูุชููุน ูุนุงู 2019</a></li>
<li><a href="../ar434368/index.html">ุชุนูู ุงูุขูุฉ ููุนุซูุฑ ุนูู ุงูุฃุฎุทุงุก ูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ: ููู ุฃูุง ูุชุฏุฑุจ ูู JetBrains ุงูุจุญูุซ</a></li>
<li><a href="../ar434370/index.html">ูุงุชุญ ุธู ุขุฎุฑ ูู Phaser ุ ุฃู ุงุณุชุฎุฏุงู ุงูุฏุฑุงุฌุงุช</a></li>
<li><a href="../ar434374/index.html">ุงูุชุญูู ูู RBAC ูู Kubernetes</a></li>
<li><a href="../ar434380/index.html">ุฃุณุงุณูุงุช ุญูู ุงูุชุจุนูุฉ</a></li>
<li><a href="../ar434382/index.html">ุชุฑููุฉ Alpine Linux ุฅูู RISC-V</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>