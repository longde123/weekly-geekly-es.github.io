<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>â¬œï¸ ğŸ ğŸ’ƒ CrÃ©ation d'une application de coloration sur Unity3D ğŸ‘©ğŸ»â€ğŸ¤ ğŸ‘©ğŸ¾â€ğŸ¤â€ğŸ‘¨ğŸ½ ğŸ§œğŸ¼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Cette histoire a commencÃ© un soir de printemps glacial, lorsque la question m'est venue Ã  l'esprit: existe-t-il un moyen de dÃ©terminer le degrÃ© de rem...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>CrÃ©ation d'une application de coloration sur Unity3D</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/412971/"><img src="https://habrastorage.org/webt/1n/wt/6k/1nwt6kpf53h7tdyd_ez0-j3f5ds.jpeg" alt="image"><br><br>  Cette histoire a commencÃ© un soir de printemps glacial, lorsque la question m'est venue Ã  l'esprit: existe-t-il un moyen de dÃ©terminer le <b>degrÃ© de remplissage d'une forme gÃ©omÃ©trique arbitraire avec de la peinture</b> (c'est-Ã -dire, par combien de pourcentage elle est actuellement peinte)?  Oui, afin qu'il ne ralentisse pas seulement, mais <i>vole Ã  60 ips</i> sur les appareils mobiles les plus faibles. <br><br>  Pour ceux qui n'ont pas immÃ©diatement compris de quoi je parlais, je vais expliquer: une approche raster est possible pour le problÃ¨me, ainsi que ... pas une approche raster. <br><a name="habracut"></a><br>  Dans le premier cas, tout est simple, le thÃ¨me du <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">remblayage</a> et des algorithmes associÃ©s a Ã©tÃ© Ã©tudiÃ© et mis en Å“uvre avec succÃ¨s dans le <abbr title="Langages de programmation">PJ</abbr> pour tous les goÃ»ts.  Il y a un tableau de pixels Ã  remplir, il y a leurs bordures.  Nous comptons le nombre de points inondÃ©s, divisons par le nombre total, et le tour est jouÃ© - nous avons le pourcentage chÃ©ri Ã  la sortie.  Mais - avec un grand nombre de pixels (et ppi sur les appareils modernes, vous savez vous-mÃªme lequel), plus - s'il y a beaucoup de tels chiffres, nous rencontrons un tas de calculs dans chaque image qui rÃ©chauffent agrÃ©ablement l'appareil, mais pas l'Ã¢me. <br><br>  Quoi qu'il en soit, travailler avec le raster semblait antisportif.  Le regard Ã©tait tournÃ© vers les dÃ©charges omnipotentes.  Plusieurs heures passionnantes de codage dÃ©tendu et persistant ont prouvÃ© l'hypothÃ¨se: vous pouvez utiliser une chose telle que Â« <i>couleur de sommet</i> Â» - couleur de sommet. <br><br><div class="spoiler">  <b class="spoiler_title">Un peu sur la couleur des sommets</b> <div class="spoiler_text">  Le canal d'informations supplÃ©mentaires natif disponible dans la structure de donnÃ©es triangulaire est le mÃªme <i>mesh.colors</i> .  ThÃ©oriquement, il peut Ãªtre utilisÃ© Ã  n'importe quelle fin, en fonction de ce qui est Ã©crit dans le shader, mais dans ce cas, l'octet prÃ©cieux stockera exactement la valeur actuelle du remplissage de couleur pour chaque sommet.  Son shader l'utilise lors du rendu, puis avec Unity one material, vous pouvez crÃ©er un nombre illimitÃ© de maillages multicolores avec un seul matÃ©riau pour tous.  La chose la plus intÃ©ressante est que les valeurs de couleur des sommets sont interpolÃ©es par le matÃ©riel entre elles, ce qui vous permet de crÃ©er des dÃ©gradÃ©s de lumiÃ¨re. <br></div></div><br>  Je pense qu'il vaut la peine de mentionner pourquoi le pourcentage notoire d'ombrage, avec lequel l'article a commencÃ©, Ã©tait nÃ©cessaire.  L'idÃ©e principale de l'application de coloration Ã©tait la suivante: l'image finale consiste en un ensemble de polygones.  L'application supprimera <b>sÃ©quentiellement et automatiquement l'Ã©lÃ©ment utilisateur par Ã©lÃ©ment</b> .  En consÃ©quence, jusqu'Ã  ce que vous ayez fini de peindre une piÃ¨ce jusqu'Ã  la fin, vous ne passerez pas Ã  la suivante.  Une telle dÃ©cision m'a semblÃ© trÃ¨s Ã©lÃ©gante, attrayante et, Ã  la lumiÃ¨re de la domination mondiale des colorations Â«pixelÂ» dans les histoires, elle Ã©tait Ã©galement fraÃ®che. <br><br><h1>  Premiers pas </h1><br>  Bien sÃ»r, pour crÃ©er une coloration Ã  part entiÃ¨re, il Ã©tait nÃ©cessaire de crÃ©er de nombreuses solutions intrigantes.  Tout d'abord, je voulais que, malgrÃ© toute la nature polygonale de l'application, la coloration soit perÃ§ue comme la plus tramÃ©e, c'est-Ã -dire que la <b>peinture se rÃ©pande sous le doigt</b> et ait un aspect plus ou moins rÃ©aliste.  L'exigence initiale de performances maximales n'a disparu nulle part et a continuÃ© de suspendre un formidable nuage de cumulus sur l'ensemble du processus. <br><br>  La premiÃ¨re Ã©tape a Ã©tÃ© de crÃ©er une <b>tessellation</b> humaine (briser un grand polygone composÃ© d'un ensemble de triangles en un tas stochastique de petits triangles).  En effet, si nous obtenons un tableau de sommets et y Ã©crivons la couleur des sommets au fur et Ã  mesure que nous remplissons, nous pouvons dÃ©terminer par un passage normal Ã  travers le tableau si la figure est complÃ¨tement remplie et quelles autres piÃ¨ces restent non peintes - <i>similaire Ã  l'algorithme de pixel, mais avec beaucoup plus de libertÃ©</i> . <br><br><img src="https://habrastorage.org/webt/hd/ki/0c/hdki0cypjlbrmfhokpfho7y0qv4.jpeg" alt="image"><br><br>  Puis a commencÃ© un voyage passionnant dans le monde des shaders.  Comme vous le comprenez, je ne peux pas dÃ©couvrir pleinement toutes les trouvailles et tous les secrets, mais je dirai qu'en interagissant avec la carte du bruit et les vieux rayons Unity Ã©mettant de mes doigts, l'effet de pinceau a Ã©tÃ© obtenu, et mÃªme avec une certaine dispersion de peinture le long des triangles adjacents au doigt.  L'utilisation de la couleur des sommets a permis de se passer d' <b>un matÃ©riau Unity</b> sur absolument toutes les parties constitutives de la figure et donc de dessiner des appels dans le programme fini ne dÃ©passant pas 5-7 (selon la prÃ©sence de menus et de particules). <br><br>  Le coup est fait par le Renderer Unity Line habituel, qui pÃ©pine perfidement sur certaines figures, se dÃ©plaÃ§ant et montrant des dÃ©fauts au niveau des articulations.  Cela n'a pas pu Ãªtre vaincu, par consÃ©quent, la tÃ¢che prioritaire est de rÃ©Ã©crire le composant Ã  partir de zÃ©ro.  Une empreinte digitale est Ã©galement un rendu de piste standard, mais son shader utilise un z-check afin que les oligo-Ã©lÃ©ments ne se chevauchent pas, crÃ©ant des artefacts moches.  La texture Â«en damierÂ» du fond permet, entre autres, <b>d'Ã©valuer la taille de l'Ã©lÃ©ment Ã  peindre</b> : plus il est grand, plus la taille des cellules sera petite. <br><br><img src="https://habrastorage.org/webt/tq/oa/-3/tqoa-3wwdoc-fg23wqk_mcgnpqc.gif" alt="image"><br><br><h1>  FonctionnalitÃ© non attendue </h1><br>  Au cours des tests, il s'est avÃ©rÃ© que souvent, quelque part dans les coins de la figure, il y avait des pics vides, ce qui Ã©tait difficile Ã  dÃ©terminer visuellement.  MalgrÃ© le fait que le dÃ©clencheur pour passer Ã  l'Ã©lÃ©ment suivant ait fonctionnÃ© lorsque le niveau de remplissage Ã©tait de 97%, la situation est Â« <i>que faire ensuite?</i>  Â»- avec un taux d'occupation de 90% Ã  97% - ils sont apparus assez souvent et ont dÃ©routÃ© les utilisateurs (qui n'avaient fondamentalement pas plus de 12 ans).  Je ne voulais pas dÃ©finir un dÃ©clencheur de moins de 97%, car alors l'effet " <i>Je ne l'avais pas encore terminÃ©, mais il avait dÃ©jÃ  sautÃ©</i> " est apparu. <br><br>  J'ai donc rencontrÃ© Ã  contrecÅ“ur <b>Madame Clusterization</b> .  Imaginez: un polygone, un tas de points Ã  l'intÃ©rieur, il y en a des "spÃ©ciaux", parfois sÃ©parÃ©ment, parfois en groupes.  Il faut trouver et dÃ©signer le plus grand Â«groupeÂ».  Il s'agit d'un problÃ¨me mathÃ©matique courant.  Aucun des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">algorithmes traditionnels que</a> j'ai trouvÃ©s n'est venu pour diverses raisons, j'ai dÃ» faire le mien.  Hackez le hack, mais cela a fonctionnÃ© - et les zones non peintes ont commencÃ© Ã  se dÃ©marquer dans un beau cercle dynamique.  Afin d'optimiser, cet algorithme fonctionne toutes les 3 secondes, et seulement aprÃ¨s que l'utilisateur est perplexe pour lever son doigt de l'Ã©cran dans le style de "quoi faire ensuite".  Il semble assez organique. <br><br><img src="https://habrastorage.org/webt/h_/qc/-d/h_qc-dlrdx_2aqol8nbqioqivzq.gif" alt="image"><br><br>  AprÃ¨s un tel brainstorming, faire une <b>Â«ligne de colorationÂ»</b> variÃ©e selon les exigences des testeurs - Ã  savoir, donner Ã  l'utilisateur la possibilitÃ© de choisir dans quelle sÃ©quence il veut colorer les Ã©lÃ©ments - Ã©tait l'affaire d'une soirÃ©e.  Tout ce dont vous avez besoin est de dÃ©terminer les centres gÃ©omÃ©triques de chaque maillage et de les construire comme nous en avons besoin: de gauche Ã  droite, de haut en bas, etc. Pour plus de clartÃ©, les particules ont Ã©tÃ© implÃ©mentÃ©es sur le fond, qui indiquent la direction de la file d'attente. <br><br><div class="spoiler">  <b class="spoiler_title">Illustration de la file d'attente</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/vg/kt/ij/vgktijp2haaqb6ij0gi6jemuqjo.gif" alt="image"><br><br>  La file d'attente par dÃ©faut est affichÃ©e ici (comme l'artiste l'a voulu).  Si vous activez le mode " <i>tour par tour</i> " en cliquant sur l'un des boutons ci-dessous, la file d'attente de colorisation changera et les particules se dÃ©placeront dans la direction indiquÃ©e. <br></div></div><br><h1>  UX &amp; UI </h1><br>  J'aime gÃ©nÃ©ralement l'idÃ©e de l'automatisme contrÃ´lÃ© dans les applications, et donc chaque Ã©lÃ©ment est centrÃ© et mis Ã  l'Ã©chelle afin qu'il puisse Ãªtre peint avec votre doigt <b>sans avoir Ã  faire dÃ©filer l'Ã©cran</b> .  L'inconvÃ©nient de cette approche Ã©tait qu'il n'est pas toujours clair quelle partie de la figure est maintenant Ã  l'Ã©cran.  Il s'est avÃ©rÃ© que les utilisateurs aiment mÃªme un si petit dÃ©fi, car il entraÃ®ne la mÃ©moire Ã  court terme et la corrÃ©lation des informations - vous devez garder Ã  l'esprit la vue d'ensemble.  Eh bien, il existe deux faÃ§ons d'accÃ©der Ã  la Â«vue plongeante de la figureÂ» - avec un geste de pincement ou en appuyant sur le bouton de zoom. <br><br><img src="https://habrastorage.org/webt/9_/ej/ic/9_ejic4dyydfoljrxzxdqjl9xos.gif" alt="image"><br><br>  En suivant les prÃ©ceptes des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">directives d'interface Apple</a> , il a Ã©tÃ© dÃ©cidÃ© de rÃ©duire au minimum le nombre de boutons sur l'Ã©cran.  En plus du bouton de <b>zoom avant / arriÃ¨re</b> et du bouton de sortie Ã©vident dans le menu, il existe Ã©galement un appel de palette - vous pouvez peindre comme la couleur Â«par dÃ©fautÂ» dÃ©finie par l'artiste, ou de votre choix. <br><br>  De plus, en mode Â«Å“il d'oiseauÂ», vous pouvez modifier le dÃ©gradÃ© d'arriÃ¨re-plan (chaque clic est gÃ©nÃ©rÃ© de maniÃ¨re alÃ©atoire) ou entrer dans le mode Â«repeindreÂ», qui vous permet de corriger un Ã©lÃ©ment dÃ©jÃ  peint.  Oui, j'ai dÃ» cacher cette fonctionnalitÃ©, mais elle est justifiÃ©e - pour tous les tests, personne n'a jamais demandÃ© comment le faire. <br><br><h4>  Ã€ propos de la palette </h4><br>  La palette elle-mÃªme a Ã©tÃ© refaite deux fois.  Au dÃ©but, j'ai simplement placÃ© un certain nombre de carrÃ©s avec des couleurs sur l'Ã©cran, mais les utilisateurs ont demandÃ© plus de couleurs.  Je ne voulais pas faire dÃ©filer l'interface, et le schÃ©ma de <b>Â«teinte de couleurÂ»</b> est apparu, c'est-Ã -dire que l'utilisateur sÃ©lectionne d'abord la couleur de base en appuyant sur, puis sur l'une de ses nuances.  La palette est supprimÃ©e Ã  l'aide d'un bouton ou d'un imposant balayage vers le bas.  De plus, lorsquâ€™il apparaÃ®t Ã  lâ€™Ã©cran, lâ€™espace de travail de lâ€™artiste est rÃ©duit de 1/3, ce qui nÃ©cessite une Â«mise Ã  lâ€™Ã©chelleÂ» de la figure actuelle Ã  la taille de la fenÃªtre modifiÃ©e. <br><br><img src="https://habrastorage.org/webt/-b/7l/mc/-b7lmcif2fozsmqquhrifrisyqo.gif" alt="image"><br><br><h1>  Pour sucrÃ© </h1><br>  Le lien manquant dans toute l'image Ã©tait la <b>rÃ©compense</b> - une sorte de rÃ©compense psychologique visuelle que l'utilisateur reÃ§oit Ã  la fin du processus de coloration.  L'idÃ©e a <s>Ã©tÃ© espionnÃ©e</s> Ã  la surface: la figure a Ã©tÃ© peinte automatiquement et Ã  nouveau, en mode accÃ©lÃ©rÃ©, et exactement comme l'a fait l'utilisateur - en d'autres termes, un <b>timelapse pendant 15-20 secondes</b> .  Ceci est mis en Å“uvre en enregistrant la sÃ©quence dans laquelle l'utilisateur a touchÃ© les sommets des figures, puis en lisant ensuite les donnÃ©es au moteur de dessin avec des retards (via des coroutines).  Chaque maillage est dupliquÃ© plusieurs fois pour obtenir les effets de Â«manifestationÂ» et Â«d'attÃ©nuationÂ». <br><br><img src="https://habrastorage.org/webt/1m/q7/dg/1mq7dg-rgkjl0r5hamxlci7vq94.gif" alt="image"><br><br>  Bien sÃ»r, le timelapse pendant la lecture est <b>enregistrÃ© dans le fichier vidÃ©o</b> , et aprÃ¨s l'extravagance visuelle, l'utilisateur est invitÃ© Ã  enregistrer / partager un chef-d'Å“uvre fraÃ®chement crÃ©Ã©.  Heureusement, juste au printemps, un plug-in est apparu dans Asset Store qui vous permet de capturer entiÃ¨rement et multi-plate-forme des vidÃ©os Ã  partir de l'Ã©cran (aprÃ¨s une certaine personnalisation), car Ã©crire un tel outil Ã  partir de zÃ©ro va bien au-delÃ  de mes compÃ©tences en programmation, <s>mais en gÃ©nÃ©ral je suis concepteur</s> . <br><br><div class="spoiler">  <b class="spoiler_title">Au lieu d'une conclusion</b> <div class="spoiler_text">  Sur ce millier de mots allouÃ©s par moi au premier opus se termine.  Dans les parties suivantes, il est prÃ©vu de parler des batailles hÃ©roÃ¯ques avec Unity UI lors du dÃ©veloppement de la deuxiÃ¨me partie de l'application - le menu de sÃ©lection des images, ainsi que de compter les bosses encombrÃ©es dans les affaires difficiles d'ASO. <br></div></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr412971/">https://habr.com/ru/post/fr412971/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr412959/index.html">A la question de l'AVR et des records du monde</a></li>
<li><a href="../fr412961/index.html">Partage de l'Ã©conomie dans les tÃ©lÃ©communications</a></li>
<li><a href="../fr412963/index.html">Nouveau Fallout: que sait-on du Vault 76?</a></li>
<li><a href="../fr412967/index.html">Faire un joli widget de rÃ©glage de la luminositÃ©</a></li>
<li><a href="../fr412969/index.html">Des systÃ¨mes de reconnaissance faciale apparaissent dans les Ã©coles amÃ©ricaines, mais leur efficacitÃ© est remise en question</a></li>
<li><a href="../fr412975/index.html">Smartphones Ã  boutons en 2018</a></li>
<li><a href="../fr412977/index.html">L'insatisfaction annule le niveau de bonheur: pourquoi il est impossible d'Ãªtre toujours heureux</a></li>
<li><a href="../fr412979/index.html">Demandez Ã  Ethan: si la matiÃ¨re noire est partout, pourquoi ne l'avons-nous pas trouvÃ©e dans le systÃ¨me solaire?</a></li>
<li><a href="../fr412983/index.html">Insider Dev Tour: diffusion en direct</a></li>
<li><a href="../fr412985/index.html">La rÃ©volution de la messagerie instantanÃ©e? L'UE a proposÃ© d'introduire une loi sur une norme de messagerie unifiÃ©e</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>