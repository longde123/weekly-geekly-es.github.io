<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üï∫üèæ üöì üî£ Terremoto interior: definici√≥n de superficies visibles üßëüèø‚Äçü§ù‚Äçüßëüèæ üë®‚Äçüë®‚Äçüëß üå©Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="El veterano de la programaci√≥n de gr√°ficos tridimensionales Michael Abrash, usando el ejemplo del desarrollo del primer Quake, habla sobre la necesida...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Terremoto interior: definici√≥n de superficies visibles</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/435760/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/tr/43/0h/tr430h9jofgiadwjb0nh59bltoc.png" alt="imagen"></div><br>  <i>El veterano de la programaci√≥n de gr√°ficos tridimensionales Michael Abrash, usando el ejemplo del desarrollo del primer Quake, habla sobre la necesidad de un pensamiento creativo en la programaci√≥n.</i> <br><br>  Hace muchos a√±os, trabaj√© para la difunta compa√±√≠a de adaptadores de video Video Seven.  All√≠ ayud√© a desarrollar un clon de VGA.  Mi colega Tom Wilson, que trabaj√≥ durante muchos meses durante todo el d√≠a para desarrollar el chip Video Seven VGA, trat√≥ de hacer VGA lo m√°s r√°pido posible y estaba seguro de que su rendimiento se optimiz√≥ casi al m√°ximo.  Sin embargo, cuando Tom ya estaba introduciendo los toques finales al dise√±o del chip, escuchamos rumores de que nuestro competidor Paradise hab√≠a logrado un rendimiento a√∫n mayor en su clon de desarrollo al agregar FIFO. <br><br>  Este fue el final de los rumores: no sab√≠amos qu√© era FIFO, ni cu√°nto ayud√≥, nada m√°s.  Sin embargo, Tom, generalmente una persona amable y relajada, se convirti√≥ en un fan√°tico activo y obsesionado con demasiada cafe√≠na en la sangre.  Basado en estos fragmentos de informaci√≥n, trat√≥ de descubrir qu√© pod√≠a hacer Paradise.  Al final, lleg√≥ a la conclusi√≥n de que Paradise probablemente insert√≥ un b√∫fer de escritura FIFO entre el bus del sistema y VGA, de modo que cuando la CPU estaba grabando en la memoria de video, los datos que se escrib√≠an ir√≠an inmediatamente a FIFO, y esto permitir√≠a que la CPU contin√∫e procesando en lugar de permanecer inactiva cada vez cuando estaba escribiendo en la memoria de la pantalla. <br><br>  Tom no ten√≠a elementos l√≥gicos ni tiempo suficiente para implementar una FIFO completa, pero logr√≥ implementar FIFO con una sola profundidad de operaci√≥n, lo que permiti√≥ que el procesador superara el chip VGA en una operaci√≥n de escritura.  Tom no estaba seguro de que esto dar√≠a buenos resultados, pero eso era lo √∫nico que pod√≠a hacer, por lo que implement√≥ este sistema y transfiri√≥ el chip a producci√≥n. <br><a name="habracut"></a><br>  Result√≥ que FIFO para una operaci√≥n funciona incre√≠blemente genial: en ese momento los chips Video Seven VGA eran los m√°s r√°pidos del mercado;  se convirtieron en evidencia del genio de Tom y evidencia de lo que el creador es capaz bajo la presi√≥n de las circunstancias.  Sin embargo, lo mejor de esta historia es que el dise√±o Paradise FIFO no tuvo nada que ver con el dise√±o de Tom, y <u>no funcion√≥ en absoluto</u> .  Paradise insert√≥ un b√∫fer de <u>lectura</u> FIFO entre la memoria de la pantalla y la etapa de salida de video del chip VGA, lo que le permiti√≥ leer previamente la salida de video para que cuando la CPU necesitara acceder a la memoria de la pantalla, los p√≠xeles pudieran tomarse de FIFO y el comando de la CPU se ejecutara instant√°neamente.  Esto realmente mejor√≥ el rendimiento, pero no tanto como el b√∫fer de escritura FIFO de Tom. <br><br>  Y este caso puede considerarse una buena par√°bola sobre la naturaleza misma del proceso creativo que una persona puede lograr.  Las noticias sobre el chip Paradise casi no conten√≠an ninguna informaci√≥n objetiva, pero obligaron a Tom a ir m√°s all√° de los l√≠mites que √©l subconscientemente estableci√≥, desarrollando el dise√±o inicial del chip.  Creo que este es el elemento m√°s importante de cualquier dise√±o ingenioso, ya sea en el campo del hardware, el software o cualquier otra esfera creativa, y fue √©l quien naci√≥ en las noticias de Tom sobre Paradise: la capacidad de detectar los l√≠mites que construiste en el proceso de trabajar en el proyecto y superarlos. fronteras <br><br>  El problema, por supuesto, es c√≥mo superar las fronteras, cuya existencia ni siquiera se conoce.  No existe una f√≥rmula para el √©xito, pero dos principios pueden servir bien a este prop√≥sito: en primer lugar, simplificar, en segundo lugar, probar constantemente algo nuevo. <br><br>  Por lo general, cuando siente que el c√≥digo se est√° complicando, comienza a realizar cambios menores en la estructura congelada, y existe una alta probabilidad de que pueda aumentar la productividad y reducir la cantidad de c√≥digo inventando nuevamente el dise√±o.  Una estructura realmente buena deber√≠a brindar un momento de profunda satisfacci√≥n cuando todo encaja, y le sorprende lo peque√±a que es la cantidad de c√≥digo que se necesita y lo bien que funcionan todos los casos l√≠mite. <br><br>  En el proceso de revisar la estructura, es importante estudiar cualquier idea que se le ocurra, sin importar cu√°n locas puedan parecer.  Muchas de las ideas realmente grandiosas que escuch√© al principio parec√≠an absurdas porque no encajaban en mi imagen actual del mundo.  A menudo, estas ideas son realmente locas, pero al igual que las noticias de Paradise Chip estimularon la imaginaci√≥n de Tom, la exploraci√≥n agresiva de ideas aparentemente delirantes puede abrir nuevas posibilidades para usted. <br><br>  Buena ilustraci√≥n: la evoluci√≥n del motor gr√°fico Quake 3D. <br><br><h2>  La tarea de gr√°ficos 3D m√°s compleja del mundo. </h2><br>  Pas√© los √∫ltimos siete meses trabajando en Quake, el heredero de DOOM de id Software, y supongo que tres meses m√°s tarde, cuando lea este art√≠culo, Quake se lanzar√° como shareware. <br><br>  En t√©rminos de gr√°ficos, Quake ser√° para DOOM lo que DOOM fue para su predecesor, Wolfenstein 3D.  Quake agrega 3D arbitrario real (el jugador puede mirar hacia arriba y hacia abajo, inclinarse hacia los lados e incluso caer hacia un lado), luces y sombras detalladas, monstruos y personajes en 3D en lugar de sprites DOOM.  Pronto hablar√© de todo esto con m√°s detalle, pero este mes quiero hablar sobre la tarea, que en mi libro llamo la m√°s dif√≠cil en los gr√°ficos tridimensionales: determinar las superficies visibles (dibujar la superficie correspondiente para cada p√≠xel) y sobre una tarea muy cercana a ella, sobre recorte (lo m√°s r√°pido posible descartando pol√≠gonos invisibles como una forma de acelerar la determinaci√≥n de superficies visibles).  En aras de la brevedad, utilizar√© la abreviatura VSD para denotar la definici√≥n de determinaci√≥n de superficie visible y eliminaci√≥n. <br><br>  ¬øPor qu√© considero VSD la tarea m√°s dif√≠cil de los gr√°ficos 3D?  Aunque las tareas de rasterizaci√≥n, por ejemplo, el mapeo de texturas, son igual de sorprendentes e importantes, su alcance es bastante limitado y, despu√©s del advenimiento de los aceleradores 3D, su soluci√≥n se transferir√° al hardware;  Adem√°s, su escala depende solo de la resoluci√≥n de la pantalla, es decir, son bastante modestos. <br><br>  Por el contrario, VSD es una tarea ilimitada y se est√°n utilizando docenas de enfoques para resolverlo.  Pero lo que es m√°s importante, el rendimiento de VSD en una soluci√≥n ingenua aumenta seg√∫n la complejidad de la escena, que generalmente aumenta como una funci√≥n cuadr√°tica o c√∫bica, y por lo tanto se convierte r√°pidamente en el factor limitante para crear mundos realistas.  Creo que en los pr√≥ximos a√±os, VSD se convertir√° en un problema cada vez m√°s dominante en los gr√°ficos 3D en tiempo real para PC, porque los detalles de los mundos 3D aumentar√°n constantemente.  Ya hoy, un nivel de tama√±o s√≥lido de Quake puede contener aproximadamente 10,000 pol√≠gonos, es decir, casi tres veces m√°s que un nivel de DOOM comparable en tama√±o. <br><br><h2>  Estructura de nivel de terremoto </h2><br>  Antes de profundizar en el VSD, perm√≠tanme mencionar que cada nivel de Quake se almacena como un gran √°rbol BSP tridimensional.  Este √°rbol BSP, como cualquier otro BSP, divide el espacio, en este caso, a lo largo de los planos de los pol√≠gonos.  Sin embargo, a diferencia del √°rbol BSP que demostr√© anteriormente, el √°rbol Quake BSP no almacena pol√≠gonos en los nodos del √°rbol como parte de los planos divisorios, sino en hojas vac√≠as (sin llenar), como se muestra en la Figura 1 en la vista superior. <br><br><div style="text-align:center;"><img src="https://www.bluesnews.com/abrash/images/fig1.gif"></div><br>  <i>Figura 1. En Quake, los pol√≠gonos se almacenan en hojas vac√≠as.</i>  <i>Las √°reas oscuras son hojas rellenas (vol√∫menes rellenos, como el interior de las paredes)</i> <br><br>  El orden correcto de renderizado se puede obtener renderizando las hojas en el orden BSP "de adelante hacia atr√°s" o "de atr√°s hacia adelante".  Adem√°s, dado que las hojas BSP son siempre convexas, y los pol√≠gonos son los l√≠mites de las hojas BSP que miran hacia adentro, los pol√≠gonos de cualquier hoja nunca pueden superponerse y pueden dibujarse en cualquier orden.  (Esta es una propiedad general de los poliedros convexos). <br><br><h2>  Recorte y definici√≥n de superficies visibles </h2><br>  Idealmente, el proceso VSD deber√≠a funcionar de la siguiente manera: primero, debe descartar todos los pol√≠gonos que est√°n fuera de la pir√°mide de visibilidad, y tambi√©n cortar todas las partes invisibles de los pol√≠gonos que son parcialmente visibles.  Luego, debe dibujar solo los p√≠xeles de cada pol√≠gono que son realmente visibles desde el punto de vista actual, como se muestra en la Figura 2 en la vista superior, sin perder el tiempo redibujando repetidamente los p√≠xeles;  observe cu√°ntos pol√≠gonos en la Figura 2 necesita dibujar.  Y, por √∫ltimo, en un mundo ideal, verificar la visibilidad de las partes de los pol√≠gonos deber√≠a ser econ√≥mico, y el tiempo de procesamiento deber√≠a ser el mismo para todos los puntos de vista posibles, para que el juego funcione sin problemas. <br><br><div style="text-align:center;"><img src="https://www.bluesnews.com/abrash/images/fig2.gif"></div><br>  <i>Figura 2. La arquitectura VSD ideal representa solo las partes visibles de los pol√≠gonos visibles.</i> <br><br>  En el proceso de lograr esta tarea, es f√°cil determinar cu√°les de los pol√≠gonos est√°n completamente fuera del alcance de la pir√°mide de visibilidad o parcialmente cortados, y es completamente posible averiguar exactamente qu√© p√≠xeles dibujar.  Por desgracia, el mundo est√° lejos de ser ideal, y todas estas comprobaciones son costosas, por lo que el truco es acelerar u omitir diferentes comprobaciones, creando el resultado necesario. <br><br>  Como expliqu√© en detalle en art√≠culos anteriores, con un BSP, puede dar la vuelta al mundo de manera f√°cil y econ√≥mica en orden frontal o posterior.  La soluci√≥n VSD m√°s simple es simplemente atravesar el √°rbol de atr√°s hacia adelante, truncar cada pol√≠gono con una pir√°mide de visibilidad y dibujarlo si su cara se dirige a la c√°mara y no se corta por completo (algoritmo del artista).  ¬øPero es esta una soluci√≥n adecuada? <br><br>  Para mundos relativamente simples, es bastante aplicable.  Sin embargo, no escala bien.  Uno de los problemas es que cuando se agregan nuevos pol√≠gonos al mundo para cortar pol√≠gonos invisibles, se requieren m√°s y m√°s transformaciones y controles;  despu√©s de cierto umbral, esto comenzar√° a disminuir significativamente el rendimiento. <br><br>  Afortunadamente, este problema en particular tiene una buena soluci√≥n.  Como se mencion√≥ anteriormente, cada hoja en el √°rbol BSP describe un subespacio convexo, y los nodos conectados a la hoja limitan el espacio.  Menos obvio es que cada nodo en el √°rbol BSP tambi√©n describe un subespacio, un subespacio que consiste en todos los elementos secundarios del nodo, como se muestra en la Figura 3. Puede tomarlo de esta manera: cada nodo divide en dos partes el subespacio creado por los nodos ubicados arriba en √°rbol, y los elementos secundarios del nodo enmarcan a√∫n m√°s este subespacio en todas las hojas que provienen del nodo. <br><br><div style="text-align:center;"><img src="https://www.bluesnews.com/abrash/images/fig3.gif"></div><br>  <i>Figura 3: El nodo E describe un subespacio oscuro que contiene las hojas 5, 6, 7 y el nodo F.</i> <br><br>  Dado que el subespacio del nodo es acotado y convexo, podemos verificar si est√° completamente fuera de la pir√°mide de visibilidad.  Si es as√≠, <u>todos los elementos</u> secundarios del nodo definitivamente se cortar√°n por completo y se pueden descartar sin procesamiento adicional.  Dado que la parte principal del mundo generalmente se encuentra fuera de la pir√°mide de visibilidad, muchos pol√≠gonos del mundo se pueden cortar casi sin costo por enormes fragmentos de subespacios de nodos.  Realizar una verificaci√≥n ideal para los subespacios de recorte es bastante costoso, por lo tanto, generalmente para cada nodo, se utilizan paralelogramos o esferas de restricci√≥n para las verificaciones de recorte. <br><br>  Es decir, el recorte a lo largo de la pir√°mide de visibilidad no es un problema, y ‚Äã‚Äãpuede usar BSP para retroceder.  Entonces, ¬øcu√°l es el problema? <br><br><h2>  Redibujando </h2><br>  El problema que enfrent√≥ el autor principal de las tecnolog√≠as DOOM y Quake John Carmack al desarrollar Quake fue que en un mundo complejo, muchas escenas en la pir√°mide de visibilidad tienen una gran cantidad de pol√≠gonos.  La mayor√≠a de estos pol√≠gonos se superponen parcial o completamente con otros pol√≠gonos, pero el algoritmo del artista descrito anteriormente requiere dibujar cada p√≠xel de cada pol√≠gono en la pir√°mide de visibilidad.  Sin embargo, a menudo solo se vuelven a dibujar para que otros los vuelvan a dibujar.  Con un nivel de terremoto de 10,000 pol√≠gonos, es f√°cil obtener el peor caso de volver a dibujar cuando los p√≠xeles se dibujan 10 o m√°s veces;  es decir, en algunos cuadros, cada p√≠xel en promedio se dibujar√° 10 o m√°s veces.  Ning√∫n rasterizador es lo suficientemente r√°pido como para compensar el orden de magnitud necesario para representar una escena;  peor a√∫n, el algoritmo del artista crea grandes diferencias de rendimiento entre el mejor y el peor de los casos, lo que conduce a un cambio significativo en la velocidad de fotogramas al mover al espectador. <br><br>  Entonces, John se enfrent√≥ al problema de reducir la cantidad de redibujos a niveles aceptables.  Idealmente, cada p√≠xel debe dibujarse solo una vez, pero no m√°s de dos o tres veces en el peor de los casos.  En cuanto al recorte a trav√©s de la pir√°mide de visibilidad, idealmente se requer√≠a que todos los pol√≠gonos invisibles en la pir√°mide se cortaran casi sin costo adicional.  Una ventaja tambi√©n ser√≠a que ser√≠a posible dibujar solo las partes visibles de pol√≠gonos parcialmente visibles, pero al mismo tiempo se deber√≠a mantener un equilibrio: la operaci√≥n deber√≠a gastar menos que volver a dibujar. <br><br>  Cuando llegu√© a la identificaci√≥n a principios de marzo, John ya ten√≠a un prototipo del motor y un plan general, por lo que asum√≠ que nuestro trabajo ser√≠a simplemente completar y optimizar este motor.  Sin embargo, si supiera la historia de la identificaci√≥n, podr√≠a descubrir qu√© es qu√©.  John cre√≥ no solo DOOM, sino tambi√©n motores para Wolf 3D y varios otros juegos anteriores, y durante el proceso de desarrollo realiz√≥ varias versiones diferentes de cada motor (una vez que cre√≥ cuatro motores en cuatro semanas), es decir, en cuatro a√±os escribi√≥ alrededor de 20 motores .  El deseo infatigable de John de obtener cada vez m√°s tecnolog√≠as nuevas y de alta calidad del motor Quake terminar√° solo despu√©s del lanzamiento del juego. <br><br>  Tres meses despu√©s de mi llegada, solo quedaba un elemento de la estructura VSD original en el motor, y el deseo de John de "probar cosas nuevas" lleg√≥ tan lejos que nunca antes hab√≠a visto algo as√≠. <br><br><h2>  Manojo de √°rboles </h2><br>  En el proyecto Quake original de John, el renderizado se realiz√≥ de adelante hacia atr√°s utilizando un segundo √°rbol BSP que rastrea las partes de la pantalla ya dibujadas y a√∫n vac√≠as que deb√≠an llenarse con los pol√≠gonos restantes.  L√≥gicamente, este √°rbol BSP puede considerarse un √°rea bidimensional que describe las partes llenas y vac√≠as de la pantalla, como se muestra en la Figura 4, pero de hecho es un √°rbol tridimensional, conocido como el "√°rbol de vigas".  Un √°rbol de vigas es un conjunto de sectores 3D (grupos) delimitados por planos proyectados desde alg√∫n punto central (en nuestro caso, el punto de vista), como se muestra en la Figura 5. <br><br><div style="text-align:center;"><img src="https://www.bluesnews.com/abrash/images/fig4.gif"></div><br>  <i>Figura 4. El √°rbol de vigas de Quake divide efectivamente la pantalla en un √°rea 2D</i> <br><br><div style="text-align:center;"><img src="https://www.bluesnews.com/abrash/images/fig5.gif"></div><br>  <i>Figura 5. El √°rbol de vigas Quake consiste en sectores 3D, o vigas, proyectadas desde el punto de vista a los bordes de los pol√≠gonos.</i> <br><br>  En el proyecto de John, un √°rbol de gavilla inicialmente consiste en una gavilla √∫nica que describe la pir√°mide de visibilidad;  todo lo que est√° fuera de este paquete se considera lleno (es decir, no es necesario dibujar nada all√≠), y todo lo que est√° dentro del paquete se considera vac√≠o.  Al alcanzar un nuevo pol√≠gono dando la vuelta al √°rbol BSP del mundo de adelante hacia atr√°s, este pol√≠gono se transform√≥ en una viga dibujando planos desde sus bordes a trav√©s del punto de vista, y todas las partes de la viga que cruzan vigas vac√≠as en el √°rbol de vigas se consideraron dibujadas y agregadas al √°rbol de vigas como una viga llena.  Esto continu√≥, hasta que los pol√≠gonos terminaron o hasta que el √°rbol de la gavilla se llen√≥ por completo.  Despu√©s de completar el √°rbol de vigas, se dibujaron las partes visibles de los pol√≠gonos atrapados en el √°rbol de vigas. <br><br>  La ventaja de trabajar con un √°rbol de haz tridimensional en lugar de la regi√≥n 2D fue que para determinar en qu√© lado del plano de haz est√° el v√©rtice del pol√≠gono, es suficiente verificar el signo del producto vectorial del rayo hacia el v√©rtice y lo normal al plano, porque todos los planos de haz pasan por el principio coordenadas (punto de vista).  Adem√°s, dado que el plano del haz est√° completamente descrito por una sola normal, para generar un haz desde el borde del pol√≠gono, solo el producto escalar del borde y el haz desde este borde hasta el punto de vista es suficiente.  Finalmente, para el recorte de grupo por la pir√°mide de visibilidad descrita anteriormente, se pueden usar las esferas delimitadoras de los nodos BSP. <br><br>  Al principio, la propiedad del √°rbol de paquetes (que finaliza cuando el √°rbol de paquetes se llena) parec√≠a atractiva porque parec√≠a que limitar√≠a el rendimiento en los peores casos.  Desafortunadamente, todav√≠a eran posibles las escenas en las que se pod√≠a ver todo hasta el cielo o la pared del fondo del mundo, por lo que en el peor de los casos, a√∫n ten√≠a que verificar todos los pol√≠gonos en la pir√°mide de visibilidad con respecto al √°rbol de racimos.  Tambi√©n pueden ocurrir problemas similares con peque√±as grietas debido a limitaciones en la precisi√≥n num√©rica.  Se pasa mucho tiempo recortando el √°rbol de vigas y, por ejemplo, en escenas con un alto rango de visibilidad, visto desde la parte superior del nivel, el costo total de procesamiento de las vigas redujo la velocidad de fotogramas de Quake a la velocidad de las tortugas.  Es decir, al final result√≥ que la soluci√≥n con los paquetes de √°rboles padece casi las mismas enfermedades que el algoritmo del artista: el peor de los casos es mucho peor que el caso promedio, y no se adapta bien con la creciente complejidad del nivel. <br><br><h2>  Nuevo motor 3D todos los d√≠as </h2><br>  Despu√©s de que el √°rbol de vigas comenz√≥ a funcionar, John trabaj√≥ incansablemente para acelerar el motor 3D, tratando constantemente de mejorar su estructura, en lugar de hacer cambios en la implementaci√≥n.      ,     ,       : ¬´     ,    ...¬ª,   ,       .       ,    ,        ,   .     ,        .         ,      .     .       , ,       ,  FIFO-  Paradise    . <br><br> <b> raycast</b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: los rayos se emiten en una pantalla dividida en una cuadr√≠cula de 8x8; Esta es una operaci√≥n muy efectiva porque la primera intersecci√≥n con la superficie se puede encontrar simplemente restringiendo el haz al √°rbol BSP, comenzando desde el punto de vista, hasta llegar a la hoja llena. Si los rayos vecinos no caen en la misma superficie, se emite un haz en el medio entre ellos, y esto contin√∫a hasta que todos los rayos vecinos caen en una superficie o est√°n en p√≠xeles vecinos; entonces se dibuja un bloque alrededor de cada rayo del pol√≠gono en el que cay√≥ el rayo. Este enfoque escala muy bien y est√° limitado por el n√∫mero de p√≠xeles, y no se vuelve a dibujar. Su problema se est√° cayendo: existe una alta probabilidad de que aparezcan peque√±os pol√≠gonos entre los rayos y desaparezcan. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Superficies sin pico</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: El mundo se representa como un conjunto de planos de superficie. Los pol√≠gonos aparecen indirectamente en las intersecciones de los planos y se eliminan de los planos en la √∫ltima etapa antes del renderizado. Esto proporciona un recorte r√°pido y una cantidad muy peque√±a de datos (en comparaci√≥n con los pol√≠gonos, los planos se describen de manera mucho m√°s compacta), pero lleva mucho tiempo extraer los pol√≠gonos de los planos. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Draw buffer</font></font></b> :   z-,       , ,     .   ,       ,      ,    ,     .   :              ,          256      0-8 ;         x86        8 . <br><br> <b>   </b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: Los pol√≠gonos se rasterizan en intervalos, que se agregan a la lista global de intervalos y se cortan de esta lista para que solo quede el intervalo m√°s cercano en cada p√≠xel. Se necesita un poco de clasificaci√≥n yendo de adelante hacia atr√°s, porque si hay intersecciones, el intervalo que ya est√° en la lista est√° m√°s cerca. Esto elimina la necesidad de volver a dibujar, pero a costa de los intervalos de c√°lculo aritm√©ticos; Adem√°s, cada pol√≠gono debe convertirse a intervalos. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Portales</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: se rastrean agujeros en los que no hay pol√≠gonos en las superficies, porque el rango de visibilidad solo se puede expandir a trav√©s de dichos portales. </font><font style="vertical-align: inherit;">El renderizado se realiza de adelante hacia atr√°s, y cuando se detecta un portal, los pol√≠gonos y portales detr√°s de √©l se limitan a sus l√≠mites hasta que no haya pol√≠gonos y portales visibles. </font><font style="vertical-align: inherit;">Con la aplicaci√≥n recursiva de este principio, le permite dibujar solo las partes visibles de los pol√≠gonos visibles, pero a costa de una cantidad significativa de recorte a trav√©s de los portales.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Avance </font></font></h2><br>     ,    ‚Äî    ,  ,     BSP- ,             BSP- .     ,       DOOM (2D),      BSP- DOOM  2D-   .       3D     ,                 .      BSP      ,       ,        .        ,    ,          BSP. <br><br>        ,    ,    ,   -  .          BSP,     ,      ,    .  3:30   ,         ,    ,            ,    ,                ,      ,     . <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La complejidad estaba en tama√±o: el conjunto inicialmente no comprimido de conjunto potencialmente visible (PVS) tom√≥ varios megabytes. Sin embargo, PVS podr√≠a almacenarse como un vector de bits con 1 bit por hoja. Es muy f√°cil comprimir dicha estructura con una simple compresi√≥n de cero bytes. John tambi√©n sugiri√≥ cambiar la heur√≠stica de BSP para que genere menos hojas. Esto fue lo opuesto a lo que propuse hace varios meses, a saber, la elecci√≥n del pr√≥ximo separador de pol√≠gonos, separando la menor cantidad de otros pol√≠gonos, y seg√∫n los √∫ltimos datos, result√≥ ser la mejor heur√≠stica. El enfoque de John permiti√≥ limitar el espacio fuera del nivel para que el controlador BSP pudiera eliminar superficies externas que el jugador nunca ver√≠a,como resultado, reduciendo el tama√±o de PVS para un nivel suficientemente grande a 20 kilobytes.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A cambio de estos 20 kilobytes, se acelera el recorte de las hojas fuera del alcance de la pir√°mide de visibilidad (porque solo se tienen en cuenta las hojas en el PVS), y para el recorte dentro de la pir√°mide de visibilidad, solo necesita un peque√±o redibujo (el PVS para la hoja contiene todas las hojas visibles desde cualquier parte de la hoja, por lo tanto un peque√±o redibujo, generalmente del orden del 50%, pero capaz de alcanzar hasta el 150%). A√∫n mejor, calcular previamente el PVS resulta en una ecualizaci√≥n del rendimiento; el peor de los casos ahora no es mucho peor que el mejor, porque ya no necesita procesamiento VSD adicional, solo m√°s pol√≠gonos y quiz√°s un poco de redise√±o adicional en el caso de escenas complejas. Cuando John me mostr√≥ por primera vez su prototipo funcional, lanc√© especialmente la escena m√°s dif√≠cil: el lugar donde la velocidad de fotogramas disminuy√≥ a n√∫meros de un solo d√≠gito, y funcion√≥ sin problemas,Sin desaceleraciones notables.</font></font><br><br>  ,   PVS    ,   ,    ¬´¬ª  .   ,     ,   ,           ,   ,     ¬´¬ª ,     . <br><br><h2>    -  </h2><br>  ¬øQu√© significa esto?<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exactamente lo que dije al principio: simplificar y probar algo nuevo. </font><font style="vertical-align: inherit;">Los PVS precalculados son m√°s simples que cualquier otro esquema que revisamos anteriormente (aunque precalcular los PVS es una tarea interesante que discutiremos en otro momento). </font><font style="vertical-align: inherit;">En esencia, los PVS precalculados son solo una versi√≥n limitada del algoritmo del artista durante la ejecuci√≥n del programa. </font><font style="vertical-align: inherit;">¬øSignifica esto que este enfoque no es particularmente profundo?</font></font><br><br>  En absoluto<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Todas las estructuras realmente excelentes parecen simples e incluso obvias, pero solo despu√©s de que se inventan. </font><font style="vertical-align: inherit;">Pero el proceso de invenci√≥n en s√≠ mismo requiere una incre√≠ble perseverancia y disposici√≥n para probar muchas ideas diferentes hasta encontrar la correcta, como sucedi√≥ en este caso.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mi amigo Chris Hecker tiene la teor√≠a de que todos los enfoques finalmente se reducen a uno, porque todos reflejan el mismo estado interno y funcionalidad. Desde el punto de vista de las teor√≠as subyacentes, esto es cierto: no importa c√≥mo calcules el mapeo de texturas en perspectiva: usando c√°lculos hiperb√≥licos incrementales o de divisi√≥n, los n√∫meros realizan la misma tarea. Sin embargo, cuando se trata de la implementaci√≥n, se puede hacer una gran diferencia con un simple cambio de la soluci√≥n en el tiempo o una mejora en la optimizaci√≥n de las capacidades de hardware o el almacenamiento en cach√©. A mi amigo Terje Mathisen le gusta repetir que "casi toda la programaci√≥n puede verse como ejercicios de almacenamiento en cach√©"; eso es exactamente lo que hizo John. No importa cu√°n r√°pido haga sus c√°lculos de VSD, nunca ser√≠an tan r√°pidos como la precomputaci√≥n y la b√∫squeda de visibilidad.Su movimiento m√°s inteligente fue que se alej√≥ de la mentalidad de "aceleraci√≥n de c√≥digo" y se dio cuenta de que, de hecho, puede calcular previamente (esencialmente cach√©) PVS y buscarlos.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lo m√°s dif√≠cil del mundo es alejarse de la soluci√≥n habitual y bastante buena para un problema complejo e intentar encontrar otra soluci√≥n mejor. </font><font style="vertical-align: inherit;">Me parece que para esto es mejor probar nuevas ideas locas y siempre, siempre tratar de simplificar. </font><font style="vertical-align: inherit;">Uno de los objetivos de John era tener menos c√≥digo en cada juego 3D posterior que en el anterior; </font><font style="vertical-align: inherit;">cre√≠a que si aprende m√°s, podr√° resolver problemas de manera m√°s eficiente en una cantidad menor de c√≥digo. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Y aunque este sistema est√° funcionando bastante bien para √©l.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Aprende ahora, paga por adelantado </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hay una cosa m√°s que me gustar√≠a mencionar al final del art√≠culo. ¬øCu√°nto recuerdo, Dr. El Dobb's Journal siempre ha dicho que compartir informaci√≥n de programaci√≥n es una bendici√≥n. Conozco a muchos programadores que dieron un salto en su desarrollo gracias a Tiny C Hendrix o D-Flat Stevens, o simplemente por leer la </font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">carpeta</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> anual de </font><u><font style="vertical-align: inherit;">DDJ</font></u><font style="vertical-align: inherit;"> . (Entre ellos, por ejemplo, lo estoy). Muchas compa√±√≠as consideran el intercambio de informaci√≥n de una manera completamente diferente, como una posible p√©rdida de ganancias, y esto es lo que hace que </font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DDJ</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sea </font><font style="vertical-align: inherit;">tan valioso para la comunidad de programadores.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gracias a esta filosof√≠a, id Software me permiti√≥ decir en este art√≠culo c√≥mo funciona Quake incluso antes de su lanzamiento. Y es por eso que id public√≥ el c√≥digo fuente completo de Wolfenstein 3D en ftp.idsoftware.com/idstuff/source </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[aprox. traducci√≥n: ahora los c√≥digos fuente se presentan en </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">github</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ; no puedes simplemente recompilar el c√≥digo y venderlo, sino que puedes descubrir c√≥mo funciona un juego exitoso a gran escala; examine el archivo wolfsrc.txt del directorio anterior para obtener detalles sobre c√≥mo se puede usar el c√≥digo.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Por lo tanto, recuerde: cuando es legal, a la larga, el intercambio de informaci√≥n nos beneficia a todos. Puede pagar la deuda por adelantado por la informaci√≥n recibida aqu√≠ y en otros lugares, compartiendo todo lo que pueda escribiendo un art√≠culo o un libro, o publicando conocimientos en la Web. Ninguno de nosotros aprende en el vac√≠o; Todos estamos sobre los hombros de gigantes: Wirth, Knut y miles de otros. ¬°Sustituye tus hombros para construir el futuro!</font></font><br><br><h2>  Referencias </h2><br> Foley, James D., <u>et al.</u> , <u>Computer Graphics: Principles and Practice</u> , Addison Wesley, 1990, ISBN 0-201-12110-7 (, BSP-, VSD). <br><br> Teller, Seth, <u>Visibility Computations in Densely Occluded Polyhedral Environments</u> (),   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">http://theory.lcs.mit.edu/~seth/</a>       . <br><br> Teller, Seth, <u>Visibility Preprocessing for Interactive Walkthroughs</u> , SIGGRAPH 91 proceedings, pp. 61-69. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es435760/">https://habr.com/ru/post/es435760/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es435746/index.html">Generaci√≥n DAG din√°mica en flujo de aire</a></li>
<li><a href="../es435748/index.html">Metasploit Framework 5.0 lanzado</a></li>
<li><a href="../es435750/index.html">Resumen de eventos de TI de enero</a></li>
<li><a href="../es435752/index.html">Moscow Python Conf ++ 2019 - la primera conferencia donde preparamos algunos oradores desde cero</a></li>
<li><a href="../es435756/index.html">Venta de a√±o nuevo antiguo</a></li>
<li><a href="../es435764/index.html">Hola mundo O Habr en ingl√©s, v1.0</a></li>
<li><a href="../es435766/index.html">Hola mundo O Habr de habla inglesa, v1.0</a></li>
<li><a href="../es435770/index.html">Hacks secretos VS Code</a></li>
<li><a href="../es435774/index.html">Isla del Pico: c√≥mo hacer un acogedor Tussent del infierno bas√°ltico</a></li>
<li><a href="../es435776/index.html">Video a bordo de los procesos de preparaci√≥n y aterrizaje, as√≠ como un panorama del reverso de la luna desde Chang'e-4</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>