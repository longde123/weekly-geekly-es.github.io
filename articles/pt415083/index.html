<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëà üë®üèæ‚Äçüéì ü§≤üèΩ 5. Marque Ponto ao m√°ximo. IPS Parte 1 ü§ûüèæ ü•ô ü¶ä</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Continuando nossa s√©rie de tutoriais da Check Point. Desta vez, discutiremos um dos meus t√≥picos favoritos, a saber, o IPS (Sistema de Preven√ß√£o de In...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>5. Marque Ponto ao m√°ximo. IPS Parte 1</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/tssolution/blog/415083/"><img src="https://habrastorage.org/webt/3a/dd/2t/3add2tmx4aj28yvsjr2yjkuokq8.png"><br><br>  Continuando nossa s√©rie de tutoriais da Check Point.  Desta vez, discutiremos um dos meus t√≥picos favoritos, a saber, o <b>IPS (Sistema de Preven√ß√£o de Intrus√µes)</b> em russo - um sistema de preven√ß√£o de intrus√µes.  Al√©m disso, a √™nfase est√° na preven√ß√£o (ou seja, preven√ß√£o)!  Um dos principais credos da Check Point √©: " <i>Prevenimos, n√£o detectamos!</i>  "  Pessoalmente, eu concordo com esta posi√ß√£o.  Para que serve a detec√ß√£o se voc√™ foi atacado por um criptografador, por exemplo?  Um computador criptografado informa que houve um ataque.  Nas realidades atuais, √© necess√°rio cuidar do Prevent.  E o IPS aqui pode ajudar muito bem. <br><br>  No entanto, recentemente houve alguma neglig√™ncia nessa classe de prote√ß√£o, dizendo "O <i>IPS n√£o √© mais relevante e n√£o faz sentido us√°-lo</i> ".  Na minha opini√£o, esta opini√£o √© um erro imperdo√°vel.  Na verdade, nesta li√ß√£o, tentarei descrever os principais equ√≠vocos existentes sobre o IPS.  Em seguida, como parte do laborat√≥rio, mostrarei como o IPS ajuda a fortalecer a seguran√ßa da sua rede.  E, √© claro, tentarei explicar como tirar o m√°ximo proveito dessa ferramenta √∫til, quais configura√ß√µes procurar e o que voc√™ precisa lembrar, incluindo o IPS. <br><br>  A li√ß√£o acabou sendo muito longa, ent√£o eu a dividi em duas partes.  A primeira parte ser√° puramente te√≥rica e a segunda j√° est√° totalmente dedicada √† pr√°tica na forma de trabalho de laborat√≥rio.  Espero que seja interessante. <br><br>  <i>Spoiler - No final do artigo, uma v√≠deo aula, se for mais conveniente para algu√©m assistir, em vez de ler.</i> <a name="habracut"></a><br><br><h3>  Uma breve hist√≥ria da IPS </h3><br><img src="https://habrastorage.org/webt/vy/kf/ra/vykfraotwx8zq1mrshjrlgzkp5i.png"><br><br>  Eu gostaria de come√ßar com algumas caracter√≠sticas hist√≥ricas.  De fato, o IPS √© um caso especial de <b>IDS</b> ( <b>Sistema de Detec√ß√£o de Intrus√£o</b> - <b>Sistema de Detec√ß√£o de Intrus√£o</b> ou SOV, como √© chamado brevemente na R√∫ssia). <br><br>  A id√©ia de criar um IDS surgiu ap√≥s a publica√ß√£o do artigo ‚Äú <b>Monitoramento e vigil√¢ncia de amea√ßas √† seguran√ßa de computadores</b> ‚Äù por James Anderson, j√° em <b>1980</b> !  Um artigo bastante divertido e mais importante at√© hoje. <br><br>  Ap√≥s 6 anos, em <b>1986</b> , Dorothy Denning e Peter Neumann publicaram o primeiro <b>modelo te√≥rico do IDS</b> , que provavelmente ainda √© a base dos sistemas modernos.  Al√©m disso, houve alguns desenvolvimentos diferentes, mas todos se resumiram a usar tr√™s m√©todos de detec√ß√£o de intrus√£o: <br><br><ul><li>  An√°lise de assinatura </li><li>  An√°lise heur√≠stica; </li><li>  Detec√ß√£o de anomalias. </li></ul><br>  Talvez um dos momentos-chave no desenvolvimento do IDS tenha sido o surgimento da biblioteca <b>libpcap</b> em <b>1998</b> .  Desenvolvido por seus colegas do Laborat√≥rio Nacional.  Lawrence em Berkeley.  No mesmo ano, o <b>APE</b> packet sniffer foi desenvolvido usando o pacote libpcap.  Um m√™s depois, a APE foi renomeada como o famoso <b>Snort</b> .  O autor de Snort √© <b>Martin R√∂sch</b> . <br><br>  <b>O Sourcefire</b> foi fundado mais tarde (em 2001) e o projeto Snort continuou seu r√°pido desenvolvimento como parte do Sourcefire e tornou-se praticamente o padr√£o entre as solu√ß√µes IDS.  O Snort √© de c√≥digo aberto, usado pelos fabricantes mais modernos de solu√ß√µes de seguran√ßa da informa√ß√£o (especialmente empresas dom√©sticas). <br><br>  Em <b>2003</b> , o Gartner observou a inefici√™ncia do IDS e a necessidade de mudar para os sistemas IPS (ou seja, alterar o detector para evitar).  Depois disso, os desenvolvedores do IDS come√ßaram a equipar suas solu√ß√µes com o modo IPS.  O Snort pode funcionar naturalmente no modo IDS e no IPS (ou seja, para impedir). <br><br>  √â claro, tamb√©m vale a pena notar o r√°pido crescimento de outro projeto de c√≥digo aberto - <b>Suricata</b> .  Este projeto foi fundado por imigrantes de Snort.  A primeira vers√£o beta foi em <b>2009</b> .  Respons√°vel pelo desenvolvimento √© a Open Information Security Foundation (OISF).  No momento, Suricata √© uma solu√ß√£o muito popular (embora ainda seja inferior √† popularidade do Snort).  De fato, eles s√£o frequentemente usados ‚Äã‚Äãjuntos. <br><br>  Em <b>2013</b> , o Sourcefire foi adquirido pela <b>Cisco</b> .  Ao mesmo tempo, o Snort continua sendo um projeto de c√≥digo aberto, e sua vers√£o comercial √© vendida sob a marca Cisco FirePower.  Com sua permiss√£o, n√£o falaremos sobre as diferen√ßas entre as vers√µes gratuita e propriet√°ria.  Um ponto interessante.  Em 2005, a Check Point tentou comprar o SourceFire por US $ 225 milh√µes, mas o governo dos EUA n√£o aprovou esse acordo.  E, como eu disse anteriormente, a Cisco comprou o SourceFire em 2013 por at√© US $ 2,7 bilh√µes.  Bom aumento de pre√ßo por 8 anos) mais de 12 vezes. <br><br>  Naturalmente, listei apenas uma pequena parte das solu√ß√µes.  Ao mesmo tempo, um grande n√∫mero de solu√ß√µes comerciais propriet√°rias foi desenvolvido (a Check Point √© uma delas).  Na maioria das vezes, o IPS fazia parte de uma solu√ß√£o UTM ou NGFW, menos frequentemente como uma pe√ßa de hardware independente (o Cisco IPS √© um excelente exemplo). <br><br><h3>  IPS em redes corporativas </h3><br>  Agora, se voc√™ tocar no hist√≥rico da distribui√ß√£o de solu√ß√µes IPS em redes corporativas, ter√° a seguinte imagem: <br><br><img src="https://habrastorage.org/webt/pq/nm/oy/pqnmoyki-iid8w9dszbgygm5iuw.png"><br><br>  No in√≠cio dos anos 2000, as empresas estavam muito c√©ticas em rela√ß√£o a essa nova classe de solu√ß√µes de seguran√ßa.  A maioria das pessoas pensava que o IPS era algum tipo de coisa ex√≥tica que n√£o era realmente necess√°ria. <br>  Ap√≥s 2005, a maioria percebeu os benef√≠cios e a necessidade do IPS.  O boom de implementa√ß√µes em todo o mundo j√° come√ßou. <br><br>  Em 2010, o IPS havia se tornado a ferramenta padr√£o essencial de fato para proteger a rede corporativa. <br><br>  Mais pr√≥ximo de 2015, o mercado de IPS esfriou relativamente.  O IPS era padr√£o em quase todas as solu√ß√µes UTM / NGFW.  Todos mudaram para o SIEM, prote√ß√£o contra ataques direcionados, sandboxes, honpots etc.  Ao mesmo tempo, esquecendo completamente a import√¢ncia do IPS.  Mas discutiremos isso um pouco mais. <br><br>  Agora que temos um pouco de conhecimento atualizado sobre a hist√≥ria da IPS, gostaria de discutir mais um ponto.  Ou seja, classes IPS.  Em uma aproxima√ß√£o aproximada, todas as solu√ß√µes IPS podem ser divididas em duas classes: <br><br><ul><li>  <b>O NIPS</b> funciona no n√≠vel da rede, ou seja,  varre o tr√°fego de passagem / tr√¢nsito. </li><li>  <b>O HIPS</b> opera no n√≠vel do computador do usu√°rio, ou seja,  com o tr√°fego destinado diretamente a este computador, bem, o pr√≥prio host gera. </li></ul><br>  Hoje vamos discutir exatamente a primeira op√ß√£o. <br><br><h3>  Duas op√ß√µes para usar o NIPS </h3><br>  Vejamos o uso arquitet√¥nico do IPS.  Tamb√©m aqui tudo √© bastante simples, existem duas op√ß√µes para usar o IPS de rede: <br><br><img src="https://habrastorage.org/webt/el/sj/qk/elsjqkumb2qvw_dqycyrc2o1k5y.png"><br><br><ol><li>  <b>Modo embutido</b> .  Em russo, chamamos de "na brecha".  I.e.  o tr√°fego de rede real passa pelo IPS.  O IPS, nesse caso, funciona como uma ponte comum (ou seja, no segundo n√≠vel do modelo OSI).  Este modo √© o mais ideal em termos de prote√ß√£o.  No caso de um ataque, o IPS pode bloquear imediatamente a sess√£o e o computador do invasor.  Obviamente, existem aspectos negativos na forma de respostas falso-positivas, ou seja,  falsos positivos quando o IPS bloqueia o tr√°fego normal.  Mas esta √© uma quest√£o separada, discutiremos um pouco mais tarde. </li><li>  <b>Modo prom√≠scuo</b> .  Mais uma vez, no russo - modo de monitoramento.  Como regra, nesse modo, o IPS √© "travado" na porta SPAN, que "reflete" o dispositivo COPY!  tr√°fego.  Nesta op√ß√£o, o IPS se transforma automaticamente em IDS, como  n√£o funciona mais com tr√°fego real e n√£o tem como bloquear rapidamente ataques.  I.e.  essa √© uma op√ß√£o ruim quando a seguran√ßa m√°xima √© necess√°ria. </li></ol><br>  N√£o consideraremos detalhadamente os recursos da aplica√ß√£o de um regime espec√≠fico.  Este √© um t√≥pico bastante amplo que vai al√©m do escopo de nossa li√ß√£o.  Vamos nos concentrar melhor no modo embutido, como  √© ele quem na maioria dos casos √© usado no Check Point. <br><br><h3>  IPS em dispositivos UTM.  Fluxo de pacotes </h3><br><img src="https://habrastorage.org/webt/n2/ae/bd/n2aebdexigphzibvuqhvrqjmopq.png"><br><br>  Do ponto de vista do processamento de tr√°fego, os pacotes s√£o verificados primeiro pelo firewall e, se s√£o permitidos pelas listas de acesso correspondentes, somente ent√£o o IPS √© ativado e come√ßa a verificar o tr√°fego que passa.  Na verdade, esse algoritmo de processamento de tr√°fego revela a diferen√ßa conceitual entre o Firewall e o Sistema de Preven√ß√£o de Intrus√µes. <br><br>  ‚ÄúO <i>firewall procura impedir a passagem de um tr√°fego.</i>  <i>O IPS trabalha com o tr√°fego j√° passado</i> . ‚Äù <br><br>  Isso √© l√≥gico n√£o apenas em termos de seguran√ßa, mas tamb√©m em termos de desempenho.  Por que investigar o tr√°fego que pode ser eliminado rapidamente por um firewall com custos m√≠nimos de recursos.  Esta √© a quest√£o de colocar o IPS na frente do firewall.  Definitivamente n√£o!  Imagine quanto tr√°fego "restante" ser√° transmitido para ele a partir de diferentes bots que analisam tudo na Internet. <br><br>  Bem, √© a√≠ que terminamos nossa digress√£o l√≠rica prolongada.  Vamos para os conceitos errados t√≠picos de IPS.  Vou tentar desmascar√°-los usando o Check Point como exemplo. <br><br><h3>  Equ√≠vocos t√≠picos de IPS </h3><br><h4>  1. O IPS protege apenas contra ataques da camada de rede </h4><br>  Talvez este seja o mito mais comum.  Historicamente, √© claro, o IPS protegia principalmente contra ataques √† rede, como varreduras de portas, for√ßa bruta, alguns tipos de Ddos e, √© claro, a luta contra anomalias.  No entanto!  Muitos ainda n√£o sabem que o IPS pode verificar os arquivos baixados!  E se o arquivo contiver explora√ß√£o, o IPS bloquear√° seu download mais rapidamente que o Anti-Virus, porque  O IPS funciona em um fluxo de tr√°fego e o Antiv√≠rus √© for√ßado a esperar at√© que o arquivo inteiro seja baixado no buffer.  I.e.  O IPS verifica arquivos como pdf, doc, xls e muito mais.  Definitivamente vou mostr√°-lo no laborat√≥rio.  Portanto, o IPS inclu√≠do aumentar√° significativamente a prote√ß√£o de seus usu√°rios que baixam v√°rios arquivos da Internet.  N√£o negligencie esse n√≠vel adicional de prote√ß√£o! <br><br><h4>  2. O IPS n√£o √© mais relevante e n√£o protege contra nada </h4><br>  Outro mito popular.  Obviamente, hackers profissionais recentemente tentaram n√£o usar ferramentas cl√°ssicas de ataque, como varredura de portas, for√ßa bruta etc.  E tudo porque esses ataques s√£o imediatamente vis√≠veis e geram um grande n√∫mero de alertas nas defesas cl√°ssicas.  No entanto!  Isso ocorre apenas em ataques muito complexos e direcionados, quando um profissional real aborda o assunto.  99% de todos os ataques bem-sucedidos s√£o bots automatizados que examinam a rede em busca de vulnerabilidades conhecidas, que eles exploram.  A IPS v√™ tudo!  Al√©m disso, lembrando novamente o wannacry, depois de descobrir essa vulnerabilidade, a Check Point emitiu uma assinatura IPS em apenas alguns dias.  A Microsoft lan√ßou o patch muito mais tarde (em algumas semanas, pelo que me lembro).  O IPS inclu√≠do com assinaturas atuais reflete perfeitamente tais ataques automatizados que ainda prevalecem (e √© improv√°vel que algo mude no futuro pr√≥ximo). <br><br><h4>  3. O IPS n√£o precisa ser atualizado com frequ√™ncia </h4><br>  Na verdade, no par√°grafo anterior, afirmei que o IPS inclu√≠do com assinaturas ACTUAIS oferece prote√ß√£o contra ataques automatizados.  Por alguma raz√£o, muitos acreditam que apenas os bancos de dados antiv√≠rus devem ser atualizados regularmente, esquecendo completamente o IPS.  Mas as assinaturas para IPS aparecem ou s√£o atualizadas literalmente todos os dias.  Por exemplo, voc√™ pode usar o recurso <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Check Point</a> .  Como voc√™ pode ver, apenas nos √∫ltimos dois dias v√°rias novas assinaturas foram liberadas.  Ou os criados anteriormente foram atualizados. <br>  O IPS com bancos de dados atualizados √© muito importante.  Como eu disse anteriormente, as assinaturas de IPS saem mais rapidamente do que as corre√ß√µes dos fornecedores.  Se voc√™ possui assinaturas antigas, seu IPS simplesmente reduz o tr√°fego e desperdi√ßa recursos do sistema.  E n√£o acredite nos fabricantes nacionais de OWL, que dizem que a atualiza√ß√£o uma vez por m√™s √© normal (como regra, eles definem esse per√≠odo e, provavelmente, isso se deve ao fato de usarem bancos de dados snort, que s√£o atualizados com um atraso de 30 dias para a vers√£o gratuita) . <br><br><h4>  4. IPS reduz significativamente o desempenho do dispositivo </h4><br>  O que posso dizer sobre esse mito?  Sim e n√£o  Obviamente, a inclus√£o do IPS aumenta a carga no processador e na RAM.  Mas nem tudo √© t√£o dram√°tico quanto se acredita.  Um grande aumento na carga quando o IPS est√° ativado geralmente se manifesta em dois casos: <br><br><ol><li>  Voc√™ (ou voc√™) selecionou incorretamente a solu√ß√£o.  Seja uplining de hardware ou solu√ß√£o virtual.  Esta √© a quest√£o de que tudo precisa ser testado antes de comprar.  Mais uma vez, depende muito de quem seleciona a solu√ß√£o.  Preste aten√ß√£o especial a isso.  Use com cuidado folhas de dados nos dispositivos.  Indica necessariamente a largura de banda do dispositivo quando o IPS est√° ativado.  Bem, novamente, a Check Point tem uma ferramenta de dimensionamento que fornece recomenda√ß√µes muito realistas para um modelo adequado.  Certifique-se de usar o tamanho!  Se voc√™ n√£o tem acesso a essa ferramenta, pergunte aos seus parceiros. </li><li>  O segundo e mais comum motivo de aumento de carga devido ao IPS √© que muitas assinaturas est√£o inclu√≠das.  Esse √© um dos extremos do uso do IPS quando absolutamente todas as assinaturas dispon√≠veis est√£o ativadas, porque, inicialmente, n√£o est√° claro quais s√£o necess√°rias.  Esse erro muito grave leva a um dispositivo de inicializa√ß√£o simplesmente selvagem e a muitos falsos positivos.  Tendo encontrado isso, muitos administradores decidem desativar o IPS, porque  com ele, o gateway de fronteira simplesmente ‚Äúse dobra‚Äù.  Como ser  Bem, primeiro voc√™ precisa determinar o que exatamente vai proteger.  √â l√≥gico supor que, se voc√™ possui um servidor de correio baseado em Linux em sua DMZ, provavelmente n√£o deve incluir assinaturas nesse segmento relacionadas √†s vulnerabilidades da Microsoft, MacOS, Android, Wordpress etc.  Eu acho que o significado geral √© claro.  <b>Trilhar o tr√°fego com todas as assinaturas indiscriminadamente √© muito caro</b> .  Para que o IPS use recursos com efici√™ncia, √© necess√°rio ativar apenas as assinaturas necess√°rias e desativar as desnecess√°rias.  Isso parece f√°cil.  Mas a implementa√ß√£o parece muito complicada.  A partir daqui, o seguinte mito cresce. </li></ol><br><h4>  5. IPS √© dif√≠cil de configurar </h4><br>  Esta √© parcialmente a opini√£o justa que ocorreu.  De fato, muitas solu√ß√µes de IPS ainda s√£o muito dif√≠ceis de aprender.  Mas n√£o se trata de Chess Point.  Vamos em ordem.  Como √© geralmente uma assinatura?  Isso geralmente √© algo como: <br><br>  <i>IGSS SCADA ListAll Fun√ß√£o Buffer Overflow</i> <i><br></i>  <i>Estouro de buffer de pilha WESPMonitor de m√∫ltiplos produtos WebGate</i> <br><br>  E tente descobrir que tipo de assinatura √©, para que serve, quanto o gateway a ativar√° e qual a sua import√¢ncia.  Felizmente, o Check Point tem uma descri√ß√£o detalhada de cada assinatura.  A descri√ß√£o √© vis√≠vel diretamente no SmartConsole e voc√™ n√£o precisa pesquisar no google cada nome.  Al√©m disso, por conveni√™ncia, o Check Point atribuiu v√°rias tags a cada assinatura: <br><br><ul><li>  <b>Gravidade</b> (ou seja, o n√≠vel de perigo que essa assinatura pode fechar); </li><li>  <b>N√≠vel de confian√ßa</b> (o n√≠vel de confiabilidade da assinatura, ou seja, qual √© a probabilidade de adequa√ß√£o da opera√ß√£o dessa assinatura. Essa √© uma caracter√≠stica muito importante, especialmente para an√°lises comportamentais) </li><li>  <b>Impacto no desempenho</b> (essa tag mostra quanto uma assinatura fortemente ativada carregar√° o dispositivo) </li><li>  <b>Fornecedor</b> - voc√™ pode filtrar assinaturas por Fornecedor (por exemplo, vulnerabilidades associadas a todos os produtos Adobe ou Microsoft) </li><li>  <b>Produto</b> - √© poss√≠vel filtrar por produto (por exemplo, Microsoft Office ou WordPress). </li></ul><br>  Tags Fornecedor e Produto √†s vezes se cruzam, porque  Com frequ√™ncia, uma empresa possui apenas um produto. <br><br>  Usando essas tags, voc√™ pode gerar rapidamente uma lista de assinaturas que deseja incluir.  E para isso voc√™ n√£o precisa ter sete v√£os na testa.  Bem, √© claro, antes disso, voc√™ precisa fazer uma pequena auditoria na rede e entender qual software seus funcion√°rios usam. <br>  Discutiremos o trabalho com essas tags com mais detalhes no laborat√≥rio. <br><br><h4>  6. Trabalhar com o IPS √© um trabalho tedioso e rotineiro. </h4><br>  Eu j√° disse muitas vezes que a seguran√ßa da informa√ß√£o n√£o √© um resultado, mas um processo cont√≠nuo.  Voc√™ n√£o pode configurar o sistema uma vez e esquec√™-lo.  Precisa de aperfei√ßoamento sistem√°tico e cont√≠nuo.  O mesmo vale para o IPS.  E aqui geralmente surgem dificuldades.  Quase qualquer sistema IPS mais ou menos adequado gera um grande n√∫mero de logs.  Eles geralmente se parecem com isso: <br><br><img src="https://habrastorage.org/webt/ou/9n/it/ou9nitvretgmdziruunlzteqkbs.png"><br><br>  Agora imagine que esses logs acumularam v√°rios milhares em uma semana.  Como voc√™ os analisa?  Como entender quais eventos ocorrem com mais frequ√™ncia?  Quais assinaturas podem precisar ser desativadas ou quais hosts podem estar bloqueados no n√≠vel do firewall? <br><br>  Obviamente, os logs do ponto de verifica√ß√£o parecem mais atraentes e claros: <br><br><img src="https://habrastorage.org/webt/l6/jy/8e/l6jy8ehf8ehy6oerims44-wr_ac.png"><br><br>  Aqui voc√™ pode ver <b>N√≠vel de confian√ßa</b> e <b>impacto de</b> <b>gravidade</b> e <b>desempenho</b> .  No entanto, isso n√£o resolve o problema de analisar um n√∫mero t√£o grande de eventos.  Como regra, os sistemas SIEM projetados para agregar, correlacionar e executar uma an√°lise inicial de eventos s√£o lembrados aqui.  Felizmente, a Check Point possui um sistema SIEM embutido - <b>Smart Event</b> .  Esse blade permite que voc√™ veja os logs IPS de forma processada e agregada: <br><br><img src="https://habrastorage.org/webt/eg/is/up/egisupog0fn_qord5qc7z7urad8.png"><br><br>  Como voc√™ sabe, isso j√° √© muito mais f√°cil de se trabalhar.  O principal valor do SIEM √© que esse sistema permite que voc√™ "veja" sua seguran√ßa em termos quantitativos.  Em qualquer trabalho, voc√™ precisa ver o resultado e aqui √© muito mais f√°cil se concentrar nos n√∫meros.  Em nosso exemplo, vemos que h√° um n√∫mero bastante grande de logs com <b>gravidade do n√≠vel cr√≠tico</b> .  √â com eles que voc√™ precisa come√ßar a trabalhar.  Al√©m disso, vemos que o maior n√∫mero de eventos est√° relacionado √† assinatura de <b>execu√ß√£o remota de c√≥digo</b> do <b>GNU Bash</b> .  A an√°lise deve come√ßar com esses eventos.  Tendo ca√≠do ainda mais, podemos determinar: <br><br><ul><li>  Quais hosts est√£o atacando? </li><li>  Qual host est√° atacando? </li><li>  De que pa√≠s vem o ataque? </li></ul><br>  Pode acontecer que a assinatura seja acionada pelo tr√°fego gerado por nosso n√≥ interno.  Esta √© uma ocasi√£o para julgamento.  Ou ele est√° realmente infectado ou √© um falso positivo.  Em seguida, tratamos o host ou desativamos essa assinatura especificamente para esse host. <br><br>  Se o ataque vier de uma rede externa, talvez todos esses logs sejam criados por apenas um n√≥ atacante (provavelmente esse √© algum tipo de bot) e por algumas cidades de Cingapura.  Nesse caso, podemos adicionar esse host (ou toda a rede de Cingapura) √† lista de bloqueios para que ele seja bloqueado no n√≠vel do firewall e n√£o alcance o processamento de tr√°fego IPS. <br><br>  Tamb√©m podemos notar que a assinatura captura ataques para distribui√ß√µes linux, enquanto o host do Windows pode ser atacado.  Nesse caso, tamb√©m seria l√≥gico desativar assinaturas linux especificamente para este host. <br><br>  Como voc√™ pode ver, o processo se assemelha a uma determinada investiga√ß√£o.  Ap√≥s essa otimiza√ß√£o constante, a carga no gateway diminuir√° significativamente, porque: <br><br><ol><li>  Parte dos hosts atacantes ser√° bloqueada no n√≠vel do firewall; </li><li>  Assinaturas desnecess√°rias que consomem recursos ser√£o desativadas. </li></ol><br>  Ao mesmo tempo, o SmartEvent permite que voc√™ veja imediatamente o resultado na forma de um n√∫mero decrescente de logs.  Esta √© apenas a caracter√≠stica quantitativa que mostra a efic√°cia do nosso trabalho realizado.  Idealmente, devemos nos livrar do chamado "ru√≠do" e ver apenas eventos IPS realmente importantes (ou seja, ataques reais) nos logs. <br><br>  Al√©m disso, todo o processo de investiga√ß√£o e adi√ß√£o de hosts √† lista de bloqueios pode ser automatizado!  O R80.10 introduziu uma API completa que permite a integra√ß√£o com solu√ß√µes de terceiros.  Eu j√° escrevi um artigo no hub sobre a pr√≥pria API - API do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Check Point R80.10.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Gerenciamento atrav√©s de CLI, scripts e muito mais.</a> <br>  Al√©m disso, meu colega Gleb Ryaskin publicou instru√ß√µes detalhadas sobre a integra√ß√£o do Check Point e do Splunk - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">API do Check Point + Splunk.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Automa√ß√£o de prote√ß√£o contra ataques √† rede</a> . <br><br>  N√£o h√° apenas uma parte te√≥rica, mas tamb√©m uma parte pr√°tica, com um exemplo de ataque e adi√ß√£o autom√°tica de um host √† lista de bloqueios.  N√£o seja pregui√ßoso, olhe. <br><br>  Sobre isso, proponho terminar nossa parte te√≥rica.  Na pr√≥xima li√ß√£o, muito trabalho de laborat√≥rio nos espera. <br><br><h3>  Parte te√≥rica em formato de v√≠deo tutorial </h3><br><iframe width="560" height="315" src="https://www.youtube.com/embed/T05pm2J7Mbc" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br>  Se voc√™ estiver interessado em outros materiais no Check Point, aqui voc√™ encontrar√° uma grande sele√ß√£o ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Check Point. Uma sele√ß√£o de materiais √∫teis da TS Solution</a> ).  Voc√™ tamb√©m pode se inscrever em nossos canais ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">YouTube</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">VK</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Telegram</a> ) para n√£o perder novos artigos, cursos e semin√°rios. <br><br>  Mais informa√ß√µes sobre os modelos de switch Extreme podem ser <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">encontradas aqui</a> . <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Voc√™ pode realizar uma auditoria gratuita das configura√ß√µes de seguran√ßa do Check Point </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aqui.</font></font></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt415083/">https://habr.com/ru/post/pt415083/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt415069/index.html">Outra busca de um sonho. M√£os do aluno RTS + eyetracker</a></li>
<li><a href="../pt415071/index.html">A meta √© mais importante que o c√≥digo</a></li>
<li><a href="../pt415073/index.html">Como o sal√£o de produ√ß√£o mudou para a energia livre do sol</a></li>
<li><a href="../pt415075/index.html">A terceira vers√£o do reCAPTCHA funciona em segundo plano despercebida pelos usu√°rios</a></li>
<li><a href="../pt415079/index.html">Uma m√©trica para governar todos - Existe uma √∫nica m√©trica universal?</a></li>
<li><a href="../pt415085/index.html">O que √© o CISSP, como obt√™-lo, n√£o perd√™-lo e por que n√£o √© necess√°rio</a></li>
<li><a href="../pt415087/index.html">[CASE] Impress√£o 3D SLA em uma f√°brica de eletr√¥nicos para navios</a></li>
<li><a href="../pt415091/index.html">Rust 1.27 Release</a></li>
<li><a href="../pt415093/index.html">PVP: por que injetar cola por via intravenosa</a></li>
<li><a href="../pt415153/index.html">Os requisitos ideais est√£o voltando</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>