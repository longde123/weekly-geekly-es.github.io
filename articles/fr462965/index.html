<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>📉 💃🏼 👨🏼‍💼 Relever le serveur 1c avec la publication de la base de données et des services web sous Linux 🤷🏾 🤷🏼 🎚️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Aujourd'hui, je voudrais dire comment augmenter le serveur 1c sur Linux Debian 9 avec la publication de services Web. 

 Que sont les services Web 1s?...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Relever le serveur 1c avec la publication de la base de données et des services web sous Linux</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/462965/"><img src="https://habrastorage.org/webt/rl/ug/jg/rlugjgsbzt_idwrlr_gpbyu1go4.png" alt="image"><br><br>  Aujourd'hui, je voudrais dire comment augmenter le serveur 1c sur Linux Debian 9 avec la publication de services Web. <br><br>  Que sont les services Web 1s? <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Les services Web</a> sont l'un des mécanismes de plate-forme utilisés pour l'intégration avec d'autres systèmes d'information.  C'est un moyen de prendre en charge SOA (Service-Oriented Architecture), une architecture orientée services qui est une norme moderne pour l'intégration des applications et des systèmes d'information.  En substance, c'est la possibilité de créer une page html avec des données, auxquelles vous pouvez ensuite accéder avec n'importe quelle autre application et les récupérer. <br><br>  Avantages - cela fonctionne rapidement (même avec une quantité de données suffisamment importante), relativement pratique. <br><br>  Inconvénients - votre programmeur 1s se plaindra de vous beaucoup et pendant longtemps en écrivant un service Web pour votre base de données.  La chose est très particulière par écrit. <br><br>  Je ne dirai pas comment écrire un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">service Web</a> ... Je dirai comment le publier sur Linux à partir de la console du serveur, ainsi qu'un peu d’installation du serveur 1s sur Linux. <br><a name="habracut"></a><br>  Et donc, nous avons debian 9 netinst, procédez comme suit: <br><br>  Installez PostgresPro (veuillez noter qu'il n'est pas gratuit et n'est distribué que dans le cadre de la familiarisation avec les fonctionnalités): <br><br><pre><code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># apt-get update -y</span></span></code> </pre> <br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># apt-get install -y wget gnupg2 || apt-get install -y gnupg</span></span></code> </pre> <br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># wget -O - http://repo.postgrespro.ru/keys/GPG-KEY-POSTGRESPRO | apt-key add -</span></span></code> </pre> <br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># echo deb http://repo.postgrespro.ru/pgpro-archive/pgpro-11.4.1/debian stretch main &gt; /etc/apt/sources.list.d/postgrespro-std.list</span></span></code> </pre> <br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># apt-get update -y</span></span></code> </pre> <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># apt-get install -y postgrespro-std-11-server</span></span></code> </pre> <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># /opt/pgpro/std-11/bin/pg-setup initdb</span></span></code> </pre> <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># /opt/pgpro/std-11/bin/pg-setup service enable</span></span></code> </pre> <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># service postgrespro-std-11 start</span></span></code> </pre> <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># su - postgres</span></span></code> </pre> <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># /opt/pgpro/std-11/bin/psql -U postgres -c "alter user postgres with password '';"</span></span></code> </pre> <br>  Disons que postgresql écoute toutes les adresses et pas seulement localhost <br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># nano /var/lib/pgpro/std-11/data/postgresql.conf</span></span></code> </pre> <br><br>  Décommentez et changez les adresses à écouter: <br><blockquote>  ... <br>  #listen_addresses = 'localhost' <br>  ... <br></blockquote><br>  Sur <br><blockquote>  ... <br>  listen_addresses = '*' <br>  ... <br></blockquote><br><br>  Ensuite, autorisons les utilisateurs de notre réseau <br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># nano /var/lib/pgpro/std-11/data/pg_hba.conf</span></span></code> </pre> <br>  Changement: <br><blockquote>  # Connexions locales IPv4: <br>  héberger tous tous 127.0.0.1/32 md5 <br></blockquote><br>  sur <br><blockquote>  héberger tous tous 192.168.188.0/24 md5 <br>  héberger tous tous 127.0.0.1/32 md5 <br></blockquote><br><br>  Vous pouvez en savoir plus sur les différentes installations Postgres pour 1 <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> . <br><br>  Ensuite, nous mettons le serveur 1s. <br><br>  Nous téléchargeons sur le serveur l'archive téléchargée depuis le site 1c (dans mon cas deb64_8_3_15_1534.tar.gz) <br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># tar -xzf deb64_8_3_15_1534.tar.gz</span></span></code> </pre><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># dpkg -i *.deb</span></span></code> </pre> <br>  quelques petites choses: <br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># apt install imagemagick unixodbc libgsf-bin</span></span></code> </pre> <br><br>  Installez maintenant Apache2 <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># apt install apache2</span></span></code> </pre> <br><br>  Via la console d'administration ou via le client 1c, nous créons la base de données et remplissons notre configuration ... <br><br>  Maintenant, nous publions la base: <br><br>  allez dans le dossier avec 1s. <br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># cd /opt/1C/v8.3/x86_64/</span></span></code> </pre> <br><br><pre> <code class="bash hljs">./webinst -publish -apache24 -wsdir Test -dir /var/www/<span class="hljs-built_in"><span class="hljs-built_in">test</span></span>/ -connstr <span class="hljs-string"><span class="hljs-string">"Srvr=10.7.12.108;Ref=test;"</span></span> -confPath /etc/apache2/apache2.conf</code> </pre> <br><br>  Nous montons dans var / www / test / et regardons ce qui y est apparu. <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># cd /var/www/test</span></span></code> </pre> <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># nano default.vrd</span></span></code> </pre> <br><br><blockquote>  " <br>  &lt;? xml version = "1.0" encoding = "UTF-8"?&gt; <br>  &lt;point xmlns = " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">v8.1c.ru/8.2/virtual-resource-system</a> " <br>  xmlns: xs = " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">www.w3.org/2001/XMLSchema</a> " <br>  xmlns: xsi = " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">www.w3.org/2001/XMLSchema-instance</a> " <br>  base = "/ Test" <br>  ib = "Srvr = 192.168.188.150; Ref = Test;"&gt; <br>  &lt;standardOdata enable = "false" <br>  reuseSessions = "autouse" <br>  sessionMaxAge = "20" <br>  poolSize = "10" <br>  poolTimeout = "5" /&gt; <br></blockquote>  " <br><br>  Ce sont les schémas qui sont nécessaires pour démarrer le client Web 1s ... maintenant vous pouvez aller dans notre base de données de test à partir du navigateur à l'adresse "http: // ServerAddress / Test" (le registre est important! C'est Linux) ou spécifiez l'adresse " http: // ServerAddress / Test ”, et le client travaillera avec la base de données publiée. <br><br>  MAIS <br><br>  Et qu'en est-il des services Web?  (il y en a deux dans ma configuration de test: WebBuh pour l'échange de données avec la comptabilité et l'intégration toplog avec le système wms de la même entreprise). <br><br>  Eh bien, ajoutez quelques lignes à notre fichier vrd ... <br><br><blockquote>  &lt;? xml version = "1.0" encoding = "UTF-8"?&gt; <br>  &lt;point xmlns = " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">v8.1c.ru/8.2/virtual-resource-system</a> " <br>  xmlns: xs = " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">www.w3.org/2001/XMLSchema</a> " <br>  xmlns: xsi = " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">www.w3.org/2001/XMLSchema-instance</a> " <br>  base = "/ TestWeb" <br>  ib = "Srvr = IP_addres; Ref = TestWebServ"&gt; <br>  &lt;standardOdata enable = "false" <br>  reuseSessions = "autouse" <br>  sessionMaxAge = "20" <br>  poolSize = "10" <br>  poolTimeout = "5" /&gt; <br> <code><b><br> #       - <br> &lt;point name="WebBuh" #  -   <br> alias="Web_buh.1cws" # Web_buh.1cws -  -   <br> enable="true" #        <br> reuseSessions="autouse" <br> sessionMaxAge="20" <br> poolSize="10" <br> poolTimeout="5"/&gt; <br> &lt;point name="TopLog" #    <br> alias="toplog.1cws" # toplog.1cws <br> enable="true" <br> reuseSessions="autouse" <br> sessionMaxAge="20" <br> poolSize="10" <br> poolTimeout="5"/&gt; <br></b></code> <br></blockquote><br>  enregistrer. <br><br>  Et maintenant, notre service Web est disponible à l'adresse "http: //AddressServer/Test/Web_buh.1cws?" <br><br>  Pourquoi avez-vous dû le faire avec vos mains? <br><br>  Étant donné que notre serveur n'a pas de shell graphique, l'exécution du configurateur sur celui-ci échouera et, par conséquent, la publication à l'aide d'outils standard.  Le configurateur distant qui se trouve sur le client ne publie pas de services Web sur le serveur.  Par conséquent, nous devons modifier la configuration manuellement selon le modèle décrit ci-dessus. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Script pour générer .vrd</a> - merci <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">TihonV</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr462965/">https://habr.com/ru/post/fr462965/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr462955/index.html">Transformation numérique de la formation et de la certification du personnel de terrain</a></li>
<li><a href="../fr462957/index.html">Avantages et inconvénients: le seuil de prix pour .org est toujours annulé</a></li>
<li><a href="../fr462959/index.html">Traitement du langage naturel des chèques en ligne: un cours de leçons magiques pour un chat ordinaire et d'autres problèmes</a></li>
<li><a href="../fr462961/index.html">Data Science Digest (août 2019)</a></li>
<li><a href="../fr462963/index.html">Utilisation de l'API contextuelle dans React pour créer un thème d'application global</a></li>
<li><a href="../fr462967/index.html">Hacks lors de l'utilisation d'un grand nombre de petits fichiers</a></li>
<li><a href="../fr462969/index.html">Comment les autorités kazakhes tentent de couvrir leur échec avec l'introduction du certificat</a></li>
<li><a href="../fr462971/index.html">Utilisation des déclarations let des variables et des fonctionnalités des fermetures résultantes en JavaScript</a></li>
<li><a href="../fr462977/index.html">Accélérez les processus RH de routine avec RPA et BluePrism</a></li>
<li><a href="../fr462979/index.html">Aide-mémoire pour un stagiaire: résolution de problèmes étape par étape lors d'un entretien avec Google</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>