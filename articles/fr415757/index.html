<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üï¥Ô∏è üéÅ üë©üèº‚Äçüéì Comment fonctionne BitSignature dans Bitcoin ü§£ ‚≠êÔ∏è üë®üèæ‚Äçüíª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dans cet article, nous verrons comment fonctionne la multi-signature dans le protocole Bitcoin. Veuillez noter que dans d'autres crypto-monnaies et mo...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Comment fonctionne BitSignature dans Bitcoin</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/distributedlab/blog/415757/">  Dans cet article, nous verrons comment fonctionne la multi-signature dans le protocole Bitcoin.  Veuillez noter que dans d'autres crypto-monnaies et monnaies num√©riques, ces m√©canismes peuvent √™tre mis en ≈ìuvre diff√©remment - cela d√©pend du mod√®le de transaction.  Nous donnerons une d√©finition de la multi-signature, nous analyserons sch√©matiquement sa structure √† l'aide d'un exemple de transaction, envisagerons des options pour son utilisation et des pr√©cautions lors de son utilisation.  Nous essaierons de divulguer ouvertement le sujet des am√©liorations propos√©es, P2SH, et √©galement sur le diagramme nous analyserons le m√©canisme d'envoi d'un paiement √† une adresse avec une multi-signature.  Nous pensons que le mat√©riel pr√©sent√© int√©ressera les lecteurs dont l'activit√© ou le domaine d'int√©r√™t concerne les monnaies num√©riques. <br><a name="habracut"></a><br><h2>  Adresse multisignature </h2><br>  L'adresse multisignature (adresse multisig, pour faire court) est une adresse Bitcoin √† laquelle plusieurs paires de cl√©s ECDSA sont attach√©es √† la fois.  Chaque paire se compose de cl√©s priv√©es et publiques.  Les mod√®les de combinaison selon lesquels ces touches peuvent √™tre utilis√©es peuvent √™tre diff√©rents.  De plus, il est possible d'√©tablir des conditions dans lesquelles il sera n√©cessaire de fournir plusieurs signatures pour d√©penser des pi√®ces de l'adresse. <br><br><h2>  Transaction Bitcoin utilisant plusieurs signatures </h2><br>  Plus en d√©tail, il peut √™tre affich√© sch√©matiquement.  Pour l'instant, il suffit d'imaginer au figur√© qu'une adresse multisignature est form√©e en hachant simultan√©ment plusieurs cl√©s publiques concat√©n√©es.  Nous examinerons cela plus en d√©tail un peu plus loin.  Le diagramme montre une transaction qui passe avec une adresse multisignature. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/024/757/d7b/024757d7bbb5989ec70c59030efbea9e.png" alt="image"><br><br>  Le gris indique la zone de titre.  Il contient deux champs.  Deux entr√©es sont indiqu√©es en bleu et deux sorties en vert.  La premi√®re entr√©e contient les champs remplis: la valeur de hachage de la transaction pr√©c√©dente est √©crite, qui d√©pense les donn√©es de la pi√®ce, le num√©ro de sortie, etc. Le champ scriptSig contient la cl√© publique et la signature, ce qui est typique d'une transaction normale. <br><br>  Faites attention √† la deuxi√®me entr√©e de la transaction.  Le champ scriptSig contient une autre combinaison de donn√©es: deux cl√©s publiques et deux signatures sont r√©pertori√©es.  Ils doivent √™tre v√©rifi√©s respectivement par ces cl√©s publiques.  Il s'agit de l'entr√©e de transaction qui d√©pense des pi√®ces avec une adresse multisignature.  Voil√† √† quoi ressemblera la preuve de propri√©t√© des pi√®ces. <br><br><h2>  Options de combinaison de touches </h2><br>  Il existe diff√©rentes combinaisons de touches lors de l'utilisation de l'adresse multisignature.  Les options les plus utilis√©es sont 2 sur 2, 2 sur 3 et 3 sur 3.  L'option maximale possible est de 15 sur 15. <br><br>  La combinaison la plus simple est 2 sur 2.  Cela implique qu'il existe une adresse multisignature √† laquelle deux paires de cl√©s sont li√©es, en fait, deux cl√©s publiques sont hach√©es d'affil√©e et une certaine adresse est re√ßue.  Pour d√©penser des pi√®ces de cette adresse, vous devez fournir deux signatures qui seront v√©rifi√©es par deux cl√©s publiques disponibles, dont la concat√©nation et le hachage dans le bon ordre devraient donner la m√™me valeur de l'adresse.  En r√©sum√©, il y a deux cl√©s pr√©install√©es et vous avez besoin de deux signatures, qui seront v√©rifi√©es par ces cl√©s, respectivement. <br><br>  L'utilisation de l'adresse multisignature 2-de-3 implique que deux des trois cl√©s pr√©d√©finies doivent √™tre utilis√©es pour v√©rifier les deux signatures pr√©sent√©es comme preuve de propri√©t√© des pi√®ces.  En d'autres termes, pour d√©penser des pi√®ces, vous devez fournir deux signatures qui seront v√©rifi√©es par deux cl√©s publiques parmi les trois pr√©d√©finies. <br><br>  La combinaison de 3 sur 3, comme vous l'avez d√©j√† compris, n√©cessite trois signatures, qui seront v√©rifi√©es par trois cl√©s pr√©install√©es.  Le nombre maximal de signatures et de cl√©s publiques requises sera le sch√©ma 15 sur 15. <br><br>  Passons en revue les options d'utilisation de ces combinaisons. <br><br><h3>  2 sur 2 </h3><br>  Imaginez qu'un mari et une femme voulaient maintenir un budget commun. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6c2/5d3/5e3/6c25d35e327e97eefbac833083f76481.png" alt="image"><br><br>  Ils conviennent que ce n'est qu'avec le consentement de chacun d'eux que les fonds du budget seront d√©pens√©s pour certains besoins.  Avec Bitcoin, cela peut √™tre mis en ≈ìuvre tout simplement.  Ils cr√©ent une adresse multisignature selon ce sch√©ma, o√π la femme contr√¥le une cl√© et le mari contr√¥le la seconde.  Ensuite, la famille recevra tous les revenus √† ces adresses et l'argent ne pourra √™tre d√©pens√© que d'un commun accord. <br><br>  Pr√©dire votre question sur le sc√©nario lorsque le mari et la femme ne sont pas d'accord, imaginez que la femme juge n√©cessaire d'acheter une machine √† laver, car elle est fatigu√©e de se laver les mains, et le mari pense que ce n'est pas un travail si dur, et il sera plus judicieux de d√©penser toutes les pi√®ces de monnaie pour le dernier mod√®le PlayStation et passez ainsi votre temps libre.  L'√©pouse s'offusque de son mari et mange un morceau de papier avec sa cl√© priv√©e, ce qui rend les d√©penses de cette adresse impossibles du tout. <br><br>  Comment √©viter une telle situation et prot√©ger les pi√®ces de la perte finale de pi√®ces? <br><br>  Il est possible de cr√©er une transaction qui d√©pensera tous les fonds de l'adresse souhait√©e, malgr√© le fait que le montant n'est pas connu √† l'avance.  L'entr√©e n'est pas le montant, mais un lien vers la transaction, d'o√π ces pi√®ces peuvent √™tre d√©pens√©es.  Il existe un <b>type de hachage</b> , qui est un moyen de couvrir avec une signature de transaction.  Il vous permet de cr√©er une signature √† l'avance et certaines donn√©es de transaction, telles que la saisie, peuvent √™tre remplac√©es ult√©rieurement.  Ainsi, vous pouvez cr√©er une transaction qui d√©pensera des pi√®ces d'une transaction qui n'existe pas encore, et l'appliquer plus tard, c'est-√†-dire lorsqu'elle sera n√©cessaire. <br><br>  De plus, vous pouvez mettre une restriction LockTime sur cette transaction.  Il vous permet de ne pas confirmer la transaction imm√©diatement, mais de la reporter pour un certain temps.  Ainsi, le mari et la femme imm√©diatement apr√®s avoir cr√©√© une adresse multisignature, avant m√™me de recevoir des paiements, peuvent cr√©er deux transactions LockTime dans lesquelles toutes les futures pi√®ces seront redirig√©es vers les adresses habituelles du mari et de la femme, qu'ils contr√¥lent ind√©pendamment.  Dans le m√™me temps, les transactions seront diff√©r√©es et ne pourront √™tre confirm√©es, par exemple, qu'apr√®s deux mois.  Ces transactions peuvent √™tre imprim√©es sur papier et stock√©es individuellement dans un coffre-fort.  Si une situation se produit lorsque les pi√®ces se trouvent sur le solde de l'adresse multisignature et que les cl√©s sont perdues (une ou les deux), les pi√®ces deviennent gel√©es.  Mais il y a une transaction LockTime.  Quiconque publie une telle transaction pourra retirer ces fonds vers une adresse externe valide.  Les pi√®ces seront enregistr√©es.  Il s'agit d'un exemple simplifi√©, mais des m√©canismes plus complexes sont possibles. <br><br><h3>  2 sur 3 </h3><br>  Supposons qu'il y ait un groupe de personnes qui ont un budget commun. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/841/bf6/ef4/841bf6ef4bc002b52cd87954139542fc.png" alt="image"><br><br>  Ils cr√©ent une adresse multisignature dans laquelle il y a trois cl√©s, mais deux signatures suffisent pour signer la transaction.  Avec le consentement des participants qui constituent la majorit√© du groupe, ces fonds peuvent √™tre d√©pens√©s.  En d'autres termes, deux participants sur trois peuvent d√©penser des pi√®ces.  Pour ce faire, il suffit de r√©partir la transaction sur le r√©seau. <br><br><h3>  Exemple de service de portefeuille </h3><br>  Il existe une fa√ßon plus int√©ressante d'utiliser la combinaison 2 sur 3 et elle est utilis√©e dans les services dits de portefeuille.  Dans ce contexte, le service de portefeuille ne doit pas √™tre confondu avec le portefeuille Bitcoin habituel, que l'utilisateur contr√¥le ind√©pendamment.  Le service ne fournit pas de stockage complet pour les pi√®ces et ne les poss√®de pas, mais fournit uniquement des services pour un travail pratique. <br><br>  Si vous imaginez cette situation de mani√®re sch√©matique, alors une cl√© appartient directement au service, la seconde est g√©n√©r√©e uniquement par l'utilisateur (et lui seul le sait), la troisi√®me cl√© est g√©n√©r√©e et stock√©e par l'utilisateur √©galement, mais s√©par√©ment.  Apr√®s cela, les cl√©s publiques correspondant √† ces cl√©s personnelles sont calcul√©es et une adresse multisignature est compil√©e.  Les pi√®ces y arrivent et maintenant les conditions de d√©penses sont limit√©es. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d8a/e30/d30/d8ae30d30c32d7a204d6c2cd0452a8ac.png" alt="image"><br><br>  Imaginez que nous avons affaire √† un certain service Web et que vous pouvez entrer sa ressource via un navigateur.  Le navigateur t√©l√©charge le code du portefeuille Bitcoin, qui √† cette adresse re√ßoit une liste des pi√®ces non d√©pens√©es, calcule leur solde et est pr√™t √† d√©penser.  Si l'utilisateur souhaite d√©penser des pi√®ces, il effectue une transaction directement dans le navigateur et la signe avec sa signature (l'une des n√©cessaires). <br><br>  Notez que l'utilisateur peut recevoir la cl√© priv√©e soit √† partir de son mot de passe, soit la cl√© peut √™tre g√©n√©r√©e de mani√®re al√©atoire, chiffr√©e avec le mot de passe de l'utilisateur et stock√©e sur le service.  Ensuite, l'utilisateur envoie une demande au service, re√ßoit un conteneur avec une cl√© chiffr√©e, le d√©chiffre avec son mot de passe et a d√©j√† acc√®s √† sa cl√© priv√©e. <br><br>  Lorsqu'un utilisateur signe une transaction, celle-ci est envoy√©e du c√¥t√© du service afin qu'elle place la deuxi√®me signature n√©cessaire et envoie la transaction.  Le service clarifie le fait de la n√©cessit√© de signer la transaction via le deuxi√®me canal d'authentification, c'est-√†-dire via un canal diff√©rent d√©fini √† l'avance, qui peut √™tre un appel vers un t√©l√©phone mobile, un SMS, un e-mail et d'autres m√©thodes de communication alternatives (jusqu'√† une visite personnelle, si le niveau de s√©curit√© l'exige) .  Lorsque le service a v√©rifi√© que l'utilisateur enregistr√© initie r√©ellement la demande de signature de transaction, il place la signature manquante √† l'aide de sa cl√©.  Apr√®s cela, la transaction devient valide et peut √™tre distribu√©e au r√©seau pour confirmation. <br><br>  La troisi√®me cl√© est utilis√©e lorsque le service se voit refuser le service.  Le logiciel g√©n√®re cette cl√© et propose de l'enregistrer d'une mani√®re qui vous convient.  L'utilisateur le stocke g√©n√©ralement dans un endroit s√ªr.  Si le service est refus√©, l'utilisateur peut signer la transaction avec ses propres cl√©s (deuxi√®me et troisi√®me).  Si la deuxi√®me cl√© a √©t√© stock√©e c√¥t√© service, un conteneur prot√©g√© avec cette cl√© sera envoy√© √† l'avance √† l'utilisateur via un autre canal de donn√©es, par exemple par e-mail.  L'utilisateur d√©chiffre le conteneur avec la cl√© √† l'aide de son mot de passe. <br><br>  L'utilisateur re√ßoit deux cl√©s priv√©es n√©cessaires et entre dans le logiciel sp√©cial que le service a fourni √† l'avance.  De plus, ce logiciel fonctionne de mani√®re autonome sur l'ordinateur de l'utilisateur, sans la participation du service.  Il convient de noter que ce logiciel ne doit √™tre utilis√© que dans des cas extr√™mes, lorsque le service refuse le service (c'est-√†-dire qu'il a √©t√© pirat√©, endommag√© ou a cess√© d'exister).  Ensuite, l'utilisateur signe la transaction avec ses cl√©s et transf√®re les pi√®ces si n√©cessaire. <br><br><h2>  Avantages des services de portefeuille 2 sur 3 </h2><br>  Nous nous attarderons plus en d√©tail sur les avantages de ces services Google Wallet.  C'est un moyen s√ªr de stocker, car le service ne poss√®de pas tout le jeu de cl√©s n√©cessaire - il ne poss√®de qu'une seule partie, ce qui n'est pas suffisant pour prendre possession des fonds.  De plus, ni le service lui-m√™me ni le pirate informatique qui peut le pirater n'ont acc√®s √† des fonds. <br><br>  La commodit√© de cette approche est que l'utilisateur n'a pas besoin d'avoir un acc√®s s√©curis√© √† ce service.  Il peut avoir un appareil ordinaire qui peut √™tre infect√© par des virus ou contr√¥l√© par des escrocs, et les donn√©es peuvent √™tre compromises ou remplac√©es.  Mais il ne suffit pas qu'un attaquant ne poss√®de que cet appareil, car une seule des deux signatures peut en √™tre obtenue. <br><br>  Un autre avantage est que si le service refuse le service, l'utilisateur ne perd pas l'acc√®s √† ses pi√®ces.  Ce ne sont l√† que quelques-uns des sch√©mas possibles d'utilisation des adresses multisignatures, qui sont suffisants pour la datation. <br><br><h2>  <b>Pr√©cautions concernant les signatures multiples</b> </h2><br>  Et maintenant, il vaut la peine de parler des pr√©cautions concernant la multi-signature.  Dans le cas de 2 sur 2, vous devez cr√©er des transactions LockTime qui peuvent transf√©rer des fonds bloqu√©s vers une adresse sp√©cifique.  Cela est vrai en cas de perte de cl√©. <br><br>  Si vous utilisez une adresse multisignature 2 sur 3, il est tr√®s important de conserver les cl√©s en lieu s√ªr.  En cas de perte de l'une des trois cl√©s, vous devez imm√©diatement transf√©rer des fonds et ne pas attendre le moment o√π 2 des 3 cl√©s n√©cessaires sont perdues. <br><br><h2>  Comment fonctionne le script Bitcoin (par exemple) </h2><br>  Afin de comprendre plus en d√©tail le fonctionnement de la multi-signature, nous devons parler un peu du fonctionnement du script Bitcoin: comment les r√®gles de d√©pense des pi√®ces sont d√©finies, comment les satisfaire, quelles sont les op√©rations de description des r√®gles, qu'est-ce que le script Bitcoin et comment est-il ex√©cut√©. <br><br>  Prenons un exemple de cas simple de d√©pense de pi√®ces, o√π il existe une adresse r√©guli√®re √† laquelle un hachage d'une cl√© publique est associ√©, un script correspondant qui d√©finit les conditions de d√©penses et un script qui remplit ces conditions. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/4d3/d70/de7/4d3d70de77efa70bb73849ee4ee58b7d.png" alt="image"><br><br>  Dans le diagramme √† gauche, nous voyons la pile de donn√©es et √† droite le script lui-m√™me.  Les deux premi√®res parties de la ligne de script sont la signature et la cl√© publique, le soi-disant script de d√©verrouillage, c'est-√†-dire le script qui est indiqu√© dans l'entr√©e de la transaction qui d√©pense des pi√®ces.  Ceci est suivi par l'ensemble de donn√©es qui est indiqu√© dans la sortie de transaction - c'est ce qu'on appelle un script de verrouillage.  En d'autres termes, la concat√©nation de deux scripts est pr√©sent√©e ici: un script qui d√©verrouille les pi√®ces et un script qui verrouille les pi√®ces.  Dans le cas o√π la transaction sera d√©j√† valid√©e par le n≈ìud de r√©seau, ces deux scripts sont combin√©s pour v√©rifier les conditions de d√©pense des pi√®ces.  Ainsi, le script de d√©verrouillage vient en premier, suivi du script de verrouillage. <br><br>  Apr√®s cela, l'ex√©cution s√©quentielle d'un ensemble complet d'op√©randes et de donn√©es.  Le point d'ex√©cution s'ex√©cute s√©quentiellement pour chaque op√©rande et chaque √©l√©ment de donn√©es.  Si le point d'ex√©cution atteint un √©l√©ment de donn√©es, il est pouss√© sur la pile.  Comme nous le voyons dans le diagramme, le curseur d'ex√©cution de script en haut indique les donn√©es de signature, qui sont ensuite pouss√©es sur la pile. <br><br>  De plus, le curseur d'ex√©cution pointe vers la cl√© publique - elle est √©galement pouss√©e sur la pile. <br><br>  La troisi√®me √©tape consiste √† effectuer l'op√©ration de duplication, ce qui signifie copier le haut de la pile et remettre ces donn√©es sur la pile. <br><br>  Apr√®s cela, le hachage est effectu√© √† l'aide de la fonction de hachage Hash-160.  Cela signifie que le haut de la pile est hach√© d'abord par l'algorithme SHA-2 √† une longueur de 256 bits, puis par la fonction RIPEMD-160 √† une longueur de 160 bits.  L'op√©ration est exactement la m√™me que lors du hachage de la cl√© publique et de l'obtention de l'adresse.  En fait, c'est √ßa. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/aaf/912/e9c/aaf912e9cf2b416fe8c7874ba64869cc.png" alt="image"><br><br>  Nous avons une pile, une signature, une cl√© publique et une valeur de hachage de la cl√© publique.  Le curseur d'ex√©cution du script pointe vers l'adresse qui a √©t√© sp√©cifi√©e dans la sortie de la transaction, c'est-√†-dire la valeur de hachage de la cl√© publique, qui a √©t√© indiqu√©e lors de l'envoi des pi√®ces.  Cette donn√©e se retrouve √©galement sur la pile. <br><br>  L'op√©ration suivante est √©gale √† v√©rifier. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d6b/1ae/2a7/d6b1ae2a7cfe776aa117493830f7dd30.png" alt="image"><br><br>  Les deux premiers √©l√©ments de la pile sont compar√©s.  S'ils ont exactement le m√™me octet, ces donn√©es sont supprim√©es de la pile et l'on pense que la v√©rification a r√©ussi.  Apr√®s cela, la signature et la cl√© publique restent sur la pile.  En cons√©quence, l'op√©ration de v√©rification de signature prend ces deux op√©randes et v√©rifie la signature avec la cl√© publique.  Si la signature est correcte par rapport √† la transaction, qui est actuellement en cours de v√©rification, car la signature couvre une partie de la transaction, vous devez donc prendre la valeur de hachage de certains champs de cette transaction.  Ceci est d√©fini par un octet distinct de la structure de type hachage, c'est-√†-dire qu'une valeur de hachage est prise et envoy√©e √† l'entr√©e de v√©rification de signature avec la signature elle-m√™me et la cl√© publique.  Si la v√©rification se produit correctement, le r√©sultat de la v√©rification est vrai, cette valeur est pouss√©e sur la pile.  Ceci termine l'ex√©cution du script.  Les donn√©es sont transmises √† la fonction appelante et v√©rifi√©es √† cet endroit.  Si la pile est vraie, la v√©rification de cette entr√©e de transaction √©tait correcte.  Si toutes les entr√©es de transaction ont √©t√© correctement v√©rifi√©es, alors la transaction enti√®re est consid√©r√©e comme correcte. <br><br>  Nous avons appris comment Bitcoin Script fonctionne pour v√©rifier les entr√©es et sorties simples d'une transaction.  Nous allons maintenant parler de l'organisation de la multisignature et de son fonctionnement lors de l'utilisation du script Bitcoin. <br><br><h2>  P2SH </h2><br>  Le BIP16 a √©t√© propos√© une fois, ce qui d√©finit un nouveau concept dans le protocole Bitcoin - le soi-disant hash pay to script (P2SH).  C'est l'occasion de d√©finir les r√®gles pour d√©penser des pi√®ces non dans un script ouvert, o√π vous √©crivez des op√©randes et des donn√©es d'affil√©e, qui sont ensuite ex√©cut√©s de la mani√®re que nous avons examin√©e, mais sous la forme d'une valeur de hachage du script dont vous avez besoin, c'est-√†-dire une somme de contr√¥le de ces op√©randes.  Cela a permis √† la sortie de la transaction de fixer des conditions importantes et complexes pour d√©penser des pi√®ces, mais la sortie elle-m√™me est rest√©e courte. <br><br>  Afin de d√©penser ces pi√®ces dans de telles conditions, √† l'entr√©e de la transaction, vous devez sp√©cifier les donn√©es qui satisfont ce script, et le script entier pour prouver que vous savez quelles conditions ont √©t√© d√©finies lors de l'envoi de pi√®ces, de sorte que la valeur de hachage du script source corresponde aux adresses auxquelles des pi√®ces ont √©t√© envoy√©es.  En d'autres termes, prouvez que vous connaissez les conditions et que vous remplissez ces conditions. <br><br>  Cette proposition visant √† am√©liorer le Bitcoin a √©t√© accept√©e le 3 janvier 2012.  En fait, l'anniversaire de Bitcoin.  Maintenant, il est activement utilis√© pour impl√©menter une adresse multisignature. <br><br><h2>  Comment fonctionne P2SH? </h2><br>  Regardons un exemple de comment cela fonctionne.  Pour cr√©er une transaction, nous devons avoir une compr√©hension des concepts tels que Redeem Script, Locking Script et Unlocking Script. <br><br>  Redeem Script contient les cl√©s publiques auxquelles l'adresse multisignature sera li√©e.  Dans ce cas, nous envisageons une combinaison de touches ¬´2 sur 5¬ª.  Vient d'abord la valeur 2, c'est-√†-dire que nous indiquons que 2 signatures seront n√©cessaires, qui seront v√©rifi√©es par les cl√©s publiques correspondantes.  Ceci est suivi par les cl√©s publiques, dans notre cas il y en a 5. Ensuite, nous indiquons la valeur 5, puisque nous avons sp√©cifi√© 5 cl√©s publiques, et lorsque les donn√©es sont lues dans l'ordre inverse, cette valeur est n√©cessaire pour comprendre combien de cl√©s vous devez lire.  Apr√®s cela, le contr√¥le de fonctionnement multisignature est indiqu√©. <br><br>  Script de verrouillage - un script qui est indiqu√© dans la sortie d'une transaction qui paie pour une adresse multisignature.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ici, l'op√©ration d'obtention d'une valeur de hachage sera effectu√©e, avec laquelle nous avons d√©j√† pris connaissance en d√©tail. Ensuite, la valeur de hachage Redeem Script, qui prend 20 octets. Apr√®s cela, une op√©ration est effectu√©e pour v√©rifier que les donn√©es correspondent √† la valeur de hachage r√©elle. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Unlocking Script est une concat√©nation de scripts √† l'entr√©e de la transaction avec des scripts √† la sortie de la transaction qui a pay√© √† cette adresse. Il y a deux signatures n√©cessaires pour d√©penser des pi√®ces, et le script de rachat complet, qui sera plus tard hach√© et v√©rifi√© pour v√©rifier la conformit√© avec l'adresse √† laquelle les pi√®ces ont √©t√© envoy√©es. Apr√®s cela, le script sera ex√©cut√© dans son int√©gralit√©, y compris pour v√©rifier la multi-signature.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il est important qu'il y ait des restrictions sur la taille maximale pour chacun des scripts r√©pertori√©s, ce qui repr√©sente 520 octets. Ce nombre a √©t√© calcul√© sur la base que Unlocking Script peut contenir un maximum de 15 signatures et 15 cl√©s publiques correspondantes, ainsi que plusieurs op√©rations pour v√©rifier ces valeurs. C'est ainsi qu'un certain nombre a √©t√© obtenu, ce qui, lors de l'arrondi, a donn√© 520 octets. Il faut dire que ce nombre a √©t√© obtenu dans l'espoir que l'adresse multisignature de type "15 sur 15" soit une limite suffisamment raisonnable pour une utilisation pratique. Utiliser le script lorsque vous utilisez un grand nombre de signatures devient tr√®s volumineux. L'utilisateur qui utilise l'adresse multisignature ou d'autres adresses P2SH, lors de la d√©pense de pi√®ces, a de tr√®s grandes transactions. Cela signifieque pour confirmer ses transactions, il devra payer des commissions importantes.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Avantages de P2SH </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous consid√©rerons s√©par√©ment les avantages de P2SH. </font><font style="vertical-align: inherit;">La premi√®re est que ces adresses peuvent √™tre encod√©es sous la forme famili√®re √† l'aide de Base58, dans lequel leur longueur est de 34 caract√®res. </font><font style="vertical-align: inherit;">Conform√©ment au BIP13, qui d√©finit les r√®gles de d√©finition de l'octet de version pour les adresses Bitcoin cod√©es par Base58Check, l'adresse commencera par un triple, c'est-√†-dire qu'un octet de version sp√©cifique y est ins√©r√©. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Par exemple, vous pouvez voir l'adresse P2SH. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3P14159f73E4gFr7JterCCQh9QjiTjiZrG</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Il ne s'agit peut-√™tre pas d'une adresse multisignature. </font><font style="vertical-align: inherit;">Redeem Script peut d√©crire non seulement une adresse multisignature, mais aussi d'autres r√®gles complexes pour d√©penser des pi√®ces.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous ajoutons que ce n'est pas le seul moyen d'organiser la multi-signature en Bitcoin. Vous ne pouvez pas utiliser P2SH, mais dans la sortie qui paiera pour l'adresse multisignature, pas la valeur de hachage du script, mais le script lui-m√™me, c'est-√†-dire r√©pertorier toutes les cl√©s publiques directement dans la sortie et d√©finir l'op√©ration sur multisignature. Cependant, lorsque vous envoyez des pi√®ces √† cette adresse, vous divulguez imm√©diatement les cl√©s publiques, car elles seront dans le domaine public et √† ce moment-l√†, les pi√®ces y seront stock√©es.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Et un autre inconv√©nient est que l'exp√©diteur de pi√®ces √† l'adresse multisignature a une grosse transaction, pour laquelle vous devrez payer une grosse commission. Il est peu probable que l'exp√©diteur veuille surpayer le fait que le destinataire souhaite utiliser la multisignature. P2SH vous permet de transf√©rer les frais de commission au destinataire. Si le destinataire souhaite accepter des pi√®ces √† l'adresse multisignature, il paiera lui-m√™me les transactions importantes, ce qui est une approche plus √©quitable. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous ajoutons que P2SH vous permet d'impl√©menter diff√©rentes combinaisons de telles multisignatures (2-sur-2, 2-sur-3 et autres). </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Envisagez sch√©matiquement l'envoi √† une adresse multisignature.</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/7a7/34a/285/7a734a285e901f5710c15b2b9e365354.png" alt="image"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Supposons qu'Alice veuille payer Bob, qui n'utilise que des adresses multisignatures. Pour ce faire, Bob localement sur son ordinateur (√† propos, il peut y avoir une sorte d'organisation au lieu de Bob) g√©n√®re plusieurs cl√©s priv√©es, re√ßoit d'eux les cl√©s publiques correspondantes, qui sont concat√©n√©es d'une certaine mani√®re. Le plus souvent, les cl√©s publiques sont d'abord encod√©es avec Base58Check, puis elles sont tri√©es par ordre alphab√©tique, puis concat√©n√©es.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cette approche est payante lorsqu'un recalcul des cl√©s publiques √† partir des cl√©s personnelles est requis. Ils doivent √™tre concat√©n√©s exactement dans le m√™me ordre, car l'√©tape suivante consiste √† cr√©er un script de rachat et √† le hacher. Si les m√™mes cl√©s exactes entrent dans Redeem Script, mais dans un ordre diff√©rent, nous obtiendrons une valeur de hachage diff√©rente et une adresse diff√©rente. Cela entra√Ænera certains malentendus. Par cons√©quent, avant la concat√©nation, les cl√©s publiques doivent √™tre tri√©es selon une r√®gle. Et le plus souvent, ils utilisent le tri alphab√©tique dans le syst√®me num√©rique Base58.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bob a donc calcul√© la valeur de hachage √† partir de Redeem Script. Il peut le repr√©senter comme 20 octets et l'envoyer √† Alice, en disant qu'il s'agit d'une adresse multisignature utilisant P2SH. Cependant, Bob peut le coder avec un octet de version, comme une adresse r√©guli√®re, et l'envoyer simplement √† Alice. Alice comprendra √† partir de l'octet de version qu'il s'agit d'une adresse multisignature, composera une transaction et remplira sa sortie en cons√©quence afin que Bob re√ßoive ses pi√®ces. Il propage ensuite la transaction au r√©seau. Ils attendent la confirmation et Bob accepte le paiement d'Alice. Bob de remplacement, par exemple, fournit un service ou transf√®re des marchandises.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il arrive un moment o√π Bob veut d√©penser ces pi√®ces. Il faut comprendre que le script de rachat complet n'a pas √©t√© rendu public alors que les pi√®ces √©taient √† son adresse multisignature. Et m√™me Alice n'a pas vu exactement quelles cl√©s publiques Bob a utilis√©es, combien il y en avait, etc. Elle ne sait pas du tout par quelles r√®gles cette adresse P2SH est compos√©e, adresse multisignature ou non, etc. En cons√©quence, les attaques contre les appareils √©lectroniques Une signature num√©rique (sur une courbe elliptique) n'est toujours pas possible. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Disons que Bob veut envoyer un paiement √† Eve.</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/c20/432/91c/c2043291cb2bb81e317e418b47c98645.png" alt="image"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Elle g√©n√®re une nouvelle adresse et la donne √† Bob. Il cr√©e une transaction vierge dans l'entr√©e dont il indique la transaction dans laquelle il a re√ßu des pi√®ces d'Alice, et la sortie est l'adresse d'Eva. Maintenant, il doit fournir la preuve de la propri√©t√© des pi√®ces qu'il d√©pense. Pour ce faire, il prend deux de ses cl√©s priv√©es (nous avons mentionn√© ci-dessus que son adresse multisignature suppose l'option ¬´2 sur 5¬ª), √† partir de laquelle il calcule deux signatures pour cette transaction. Ensuite, il prend le script de rachat complet et l'ajoute √† l'entr√©e de transaction.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Veuillez noter que ce script d'√©change doit √™tre enti√®rement stock√© sur l'ordinateur de Bob ou il doit se souvenir de l'ordre dans lequel il a utilis√© les cl√©s publiques pour composer ce script. S'il a appliqu√© certaines r√®gles de tri, il doit s'en souvenir. Il doit √©galement se rappeler qu'une adresse multisignature est li√©e √† certaines cl√©s priv√©es. Sans cette connaissance, Bob n'aurait pas su sur laquelle de ses cl√©s priv√©es op√©rer et dans quel ordre elles devaient √™tre hach√©es pour obtenir l'adresse souhait√©e. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il a donc deux signatures et un script de rachat complet. La transaction est consid√©r√©e comme correcte et Bob la distribue au r√©seau, puis attend sa confirmation. C'est l'essentiel des d√©penses avec une adresse multisignature.</font></font><br><br><h2>  Des questions </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous arrivons maintenant √† vos questions. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Est-il possible d'ex√©cuter le m√™me portefeuille simultan√©ment sur trois ordinateurs diff√©rents et de d√©marrer la synchronisation?</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il s'agit tr√®s probablement d'une sorte de n≈ìud de r√©seau: soit un n≈ìud SPV, soit un n≈ìud complet. Plusieurs ordinateurs diff√©rents et le m√™me portefeuille ont √©t√© utilis√©s. Et un portefeuille signifie des cl√©s priv√©es. Il existe plusieurs n≈ìuds complets qui impl√©mentent la fonctionnalit√© de portefeuille. Sur ces n≈ìuds, nous ins√©rons les m√™mes cl√©s priv√©es et commen√ßons la synchronisation. Tr√®s probablement, avec une synchronisation compl√®te avec le r√©seau, nous verrons le m√™me √©quilibre sur chaque portefeuille qui utilise son propre n≈ìud. Si vous voyez des changements sur un n≈ìud, alors apr√®s la synchronisation avec le r√©seau, vous verrez exactement les m√™mes changements sur tous les autres n≈ìuds. La transaction n'est pas gard√©e secr√®te, elle est distribu√©e √† tous les n≈ìuds qui la v√©rifient et affichent les modifications correspondantes, s'il s'agit de leurs adresses. En fait, oui, vous pouvez utiliser les m√™mes cl√©s sur plusieurs n≈ìuds,mais toutes les transactions seront √©galement synchronis√©es automatiquement. Les bitcoins ne doubleront certainement pas de cela et, en outre, ne tripleront pas.</font></font><br><br> <i>‚Äî  P2SH   Segregated Witness?</i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le t√©moin distinct est une telle structure de transaction o√π la preuve de la propri√©t√© des pi√®ces est transf√©r√©e dans une structure distincte, elles ne tombent pas dans la blockchain, mais lors de la validation des transactions, elles sont distribu√©es ensemble, c'est-√†-dire que tous les validateurs v√©rifient l'exactitude des transactions dans une structure s√©par√©e avec une preuve. Une fois la transaction confirm√©e, les preuves ne sont pas enregistr√©es, car elles n'ont aucun sens. Il existe √©galement des avantages √† construire de telles cha√Ænes de transactions dans lesquelles certaines pi√®ces sans confirmation r√©elle dans la transaction en cours sont d√©j√† d√©pens√©es dans la suivante construite sur sa base, mais elles ne sont pas distribu√©es au r√©seau. Ainsi, des cha√Ænes de transactions se forment qui ne r√©v√®lent pas de preuve de propri√©t√© des pi√®ces. Cela facilite le transfert de donn√©es et ajoute de la confidentialit√©. Un type d'adresse diff√©rent a √©t√© utilis√© pour le t√©moin isol√©,il contient des op√©randes l√©g√®rement diff√©rents. Il est possible d'envoyer des pi√®ces stock√©es √† des adresses r√©guli√®res, y compris des adresses P2SH, √† des adresses de t√©moins P2SH.</font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Les adresses des trois premiers commencent-elles dans le r√©seau d'√©clairage?</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> BIP13 d√©finit les r√®gles selon lesquelles un octet de version est s√©lectionn√© pour les adresses Bitcoin dans le r√©seau de test, d'autres devises, etc. Oui, Lighting Network utilise des adresses multisignatures, qui utilisent √©galement la m√©thode P2SH pour d√©finir les conditions. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Pourquoi est-il impossible de personnaliser un portefeuille, c'est-√†-dire de le lier √† une personne sp√©cifique?</font></font></i> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le bitcoin en tant que protocole d'un syst√®me de paiement ne n√©cessite pas l'identification de l'identit√© d'un portefeuille, car il fonctionne selon les lois des math√©matiques et les math√©matiques ne permettent pas de d√©crire une personne comme une personne. De plus, ce n'est pas une condition pr√©alable √† la v√©rification des transactions. Il y a suffisamment de signature num√©rique. Celui qui peut g√©n√©rer de telles signatures est leur propri√©taire - cela ne s'applique pas au protocole Bitcoin. Par cons√©quent, une signature peut √™tre d√©tenue par une personne, un groupe de plusieurs personnes, un robot, etc. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En ce qui concerne la personnalisation, si vous √©tablissez une connexion entre une adresse sp√©cifique et une personne sp√©cifique, vous violez la confidentialit√© et pouvez deanonymiser une partie du r√©seau avec un certain degr√© de probabilit√©. En g√©n√©ral, la base de donn√©es est ouverte, mais elle ne contient aucune donn√©e d'identit√©.</font></font><br><br> <i>‚Äî    ,    70-80%,    ?</i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il est bien √©crit qu'il s'agit d'une monnaie, pas d'une crypto-monnaie, car la crypto-monnaie fonctionne selon les m√™mes principes que Bitcoin, c'est-√†-dire que tous les processus sont d√©centralis√©s au maximum: √©mission, v√©rification des transactions, stockage des donn√©es, acceptation des modifications, etc. Mais il existe de telles devises , nous les appellerons des monnaies num√©riques, dans lesquelles tous les processus r√©pertori√©s ne sont pas d√©centralis√©s. L'une des options peut √™tre un probl√®me centralis√©, c'est-√†-dire qu'il n'y a rien de tel que l'exploitation mini√®re, l'exploitation mini√®re, c'est-√†-dire qu'il n'y a pas de solution √† un probl√®me complexe. Selon ce principe, Ripple, Stellar, la monnaie num√©rique NXT, Cardano fonctionnent. D'autres principes de distribution de pi√®ces entre les utilisateurs y ont √©t√© appliqu√©s, par exemple via les ICO, la preuve d'identit√©, etc. En raison du fait que tous les processus ne peuvent pas √™tre d√©centralis√©s et ind√©pendants, vous ne pouvez nommer aucune monnaie num√©rique</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">crypto-monnaie</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">De plus, la question de la confiance dans une devise particuli√®re est de nature personnelle. </font><font style="vertical-align: inherit;">Vous d√©cidez du montant de cette fiducie. </font><font style="vertical-align: inherit;">Il est n√©cessaire de prendre en compte les finalit√©s pour lesquelles la devise est utilis√©e, ainsi que ses risques et limites.</font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr415757/">https://habr.com/ru/post/fr415757/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr415745/index.html">Des ench√®res aux berceuses: comment et o√π la voix humaine ¬´fonctionne¬ª</a></li>
<li><a href="../fr415747/index.html">Aristote avait raison. Les gens n'ont pas besoin de la vie √©ternelle et du bonheur absolu</a></li>
<li><a href="../fr415749/index.html">Comment apprendre une langue √©trang√®re sans professeur. Partie 2. "Strat√©gie au tour par tour"</a></li>
<li><a href="../fr415753/index.html">Brave browser s'int√®gre √† Tor</a></li>
<li><a href="../fr415755/index.html">D√©riv√©s de la blockchain: r√©soudre le probl√®me pour 500 billions de dollars et remporter le hackathon Consensus 2018</a></li>
<li><a href="../fr415759/index.html">La NSA a commenc√© √† supprimer les m√©tadonn√©es enregistr√©es en raison d'un "probl√®me"</a></li>
<li><a href="../fr415761/index.html">Quoi, comment et pourquoi sur les publicit√©s jouables</a></li>
<li><a href="../fr415763/index.html">Le gouvernement am√©ricain discute de la possibilit√© de reprendre le contr√¥le de l'IANA [mais cela est peu probable]</a></li>
<li><a href="../fr415765/index.html">Pourquoi VMware a d√©cid√© de cr√©er une plate-forme pour d√©velopper des cha√Ænes de blocs d'entreprise</a></li>
<li><a href="../fr415767/index.html">Tesla Inc a ouvert la possibilit√© de commander une Tesla Model 3 pour les r√©sidents du Canada et des √âtats-Unis</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>