<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëÉüèΩ üë©‚Äçüåæ ‚ò∫Ô∏è Nous vainquons le module GPRS d'Amperka üë± üé† ü§∑üèæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Avant de pouvoir vaincre le bus CAN , nous avons d√ª vaincre le prochain √©l√©ment mat√©riel, √† savoir le module GPRS. C'est sa vie de d√©veloppeur - tout ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Nous vainquons le module GPRS d'Amperka</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/401721/"><img src="https://habrastorage.org/files/f8d/d05/ce9/f8dd05ce94d24dc283d1abcbffdb5906.jpg" alt="image"><br>  Avant de pouvoir vaincre <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">le bus CAN</a> , nous avons d√ª vaincre le prochain √©l√©ment mat√©riel, √† savoir le module GPRS.  C'est sa vie de d√©veloppeur - tout le temps elle doit gagner quelqu'un (il devrait y avoir un sourire interdit). <br><br>  Pour l'un des projets personnalis√©s, j'avais besoin d'ajouter la possibilit√© de contr√¥ler et de recevoir la t√©l√©m√©trie via GSM √† l'aide de SMS.  J'ai regard√© la liste des options disponibles et j'ai opt√© pour le bouclier GPRS d'Amperka.  Pourquoi pas?  Il a l'air d√©cent, est produit par une soci√©t√© bien connue, dispose d'un support technique, le prix n'est pas tr√®s diff√©rent de ses concurrents et fait g√©n√©ralement une tr√®s bonne impression. <br><br>  Mais √ßa y √©tait.  Vous pouvez en apprendre davantage sur cette qu√™te et les incroyables cours de formation continue que j'ai d√ª suivre, en int√©grant ce module GPRS au <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Arduino Mega Server</a> en cliquant sur le bouton ci-dessous. <br><a name="habracut"></a><br><h2>  Module lui-m√™me </h2><br>  Comme je l'ai dit, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">le module lui-m√™me</a> fait une tr√®s bonne impression avec sa pr√©cision d'ex√©cution et sa relation avec une entreprise bien connue.  Encore une fois, le site Web du fabricant contient des exemples d'utilisation et une biblioth√®que native.  √âtant donn√© que le module est de marque, il existe un espoir de soutien ad√©quat en cas de probl√®me avec celui-ci. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/332/bf2/2b2/332bf22b21a64277b46f78d65e580b13.jpg" alt="image"></div><br>  √Ä l'avenir, je dirai que le support technique a r√©pondu correctement √† mes questions pendant deux semaines, a recherch√© des bogues dans ma biblioth√®que et a m√™me publi√© une nouvelle version bas√©e sur la raison de la communication avec moi.  Mais ... je devais encore faire fonctionner le module par moi-m√™me. <br><br><h2>  Projet </h2><br>  Quelques mots sur le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">projet GSM Coop,</a> qui n√©cessitait un module GPRS.  Il a fallu d√©velopper l'automatisation de la gestion du poulailler.  En effet, √† une √©poque incroyable, nous vivons, maintenant le poulailler doit √™tre contr√¥l√© via un navigateur Web, des capteurs intelligents sans fil et la t√©l√©m√©trie GSM.  C‚Äôest un objet strat√©gique quelconque, pas un poulailler. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/a91/e3a/6a4/a91e3a6a4cd94a2cabc35ca7ebb381b1.png" alt="image"></div><br>  Mais si c'est n√©cessaire, alors c'est n√©cessaire.  Nous achetons des composants, dont le module GPRS, et proc√©dons. <br><br><h2>  Talon d'Achille </h2><br>  Maintenant sur les fonctionnalit√©s du module.  Fondamentalement, cela fonctionne.  Il travaille avec des exemples pr√©sent√©s sur le site Web du fabricant et sur sa base, vous pouvez m√™me cr√©er des croquis simples.  Mais il y a trois ¬´mais¬ª. <br><br>  <i><strong>Remarque</strong></i>  <i>Deux cartes m√®res ont √©t√© utilis√©es dans le projet: <strong>Arduino Mega 2560</strong> et <strong>Arduino Due,</strong> et tout ce qui suit s'applique sp√©cifiquement √† elles et uniquement √† elles.</i> <br><br>  <strong>Le premier "mais", le mat√©riel.</strong>  Le module ne fonctionne pas avec Arduino Due.  Pas question.  M√™me une correspondance de plusieurs jours avec le support technique d'Amperka n'a pas aid√©.  Ni moi ni les sp√©cialistes de l'entreprise n'avons r√©ussi √† faire fonctionner le bouclier GPRS avec Arduino Due.  Et c'est tr√®s d√©cevant car Due est un excellent contr√¥leur avec de grandes capacit√©s et aimerait pouvoir l'utiliser avec GPRS Shield. <br><br>  <strong>Le deuxi√®me ¬´mais¬ª est syst√©mique.</strong>  Le module n√©cessite la biblioth√®que SoftwareSerial pour fonctionner.  Lorsque j'ai commenc√© ma conversation avec GPRS Shield et le support technique d'Amperka, il s'agissait d'une solution non alternative.  Apr√®s nos travaux, une version r√©vis√©e de la biblioth√®que avec prise en charge du travail sur le fer Serial a √©t√© publi√©e, mais ... elle n'a jamais gagn√© ni Due ni Mega.  Qu'est-ce qui est g√©n√©ralement difficile √† expliquer - si un module fonctionne sur SoftSerial, qu'est-ce qui l'emp√™che de fonctionner sur Iron Serial? <br><br>  <strong>Le troisi√®me ¬´mais¬ª, conceptuel.</strong>  Ce n'est pas tout.  L'embuscade principale r√©side dans le principe de la biblioth√®que de modules.  Il fonctionne en mode ferm√©, c'est-√†-dire qu'il bloque le fonctionnement du contr√¥leur pendant qu'il attend l'arriv√©e de SMS (qui est 99% du temps) et pendant toutes les autres op√©rations du module.  Qu'est-ce que cela signifie?  Cela signifie que sur la biblioth√®que standard du fabricant, vous ne pouvez pas construire autre chose qu'une esquisse de test.  Le poulailler strat√©gique ne brille pas pour vous, car des milliers d'autres applications int√©ressantes comme les syst√®mes de s√©curit√©, la gestion des serres, le contr√¥le de la maison intelligente via GSM, etc., etc. ne brillent pas. <br><br><h2>  En savoir plus sur SoftwareSerial </h2><br>  Le module ne fonctionne pas sur Arduino Due, nous allons donc parler d'Arduino Mega.  Le piquant de la situation est qu'ayant Mega a trois ports mat√©riels libres Serial1, Serial2 et Seria3, nous sommes oblig√©s de nous connecter et d'utiliser la biblioth√®que SoftwareSerial.  En aucune mani√®re imaginable et inconcevable, y compris le r√©arrangement des cavaliers sur le module et l'interrogation avec l'addiction du support technique d'Amperka, n'a pas r√©ussi √† faire fonctionner le bouclier GPRS avec les ports mat√©riels d'Arduino Mega. <br><br>  D'accord ... Nous utilisons SoftwareSerial, mais ici, nous attendons une embuscade.  SoftwareSerial peut fonctionner sur de nombreuses broches Arduino Mega, mais pour une raison quelconque, il ne fonctionne que sur les broches 62 et 63.  Pourquoi seulement sur eux?  Cette √©nigme est g√©niale.  √Ä toutes les apparences, nous ne conna√Ætrons jamais la r√©ponse √† cette question. <br><br><h2>  Farine de choix </h2><br>  Et maintenant, comme d'habitude, nous comprenons que la biblioth√®que standard n'est pas adapt√©e √† une utilisation pratique.  En bloquant le contr√¥leur pendant qu'il attend de recevoir une r√©ponse du module GPRS, la biblioth√®que bloque √©galement tous les autres processus.  Le contr√¥leur tombe simplement hors de la r√©alit√© 99% du temps, attendant qu'une demande ou une r√©ponse arrive ou que le d√©lai expire. <br><br>  Cela met fin √† toute application de GPRS Shield, √† l'exception de celle de test: envoy√© une demande pour activer le socket - il s'est allum√©, a envoy√© une demande pour l'√©teindre - il s'est √©teint.  Il ne peut √™tre question d'aucun travail sur le serveur Web, de travail avec des capteurs, de contr√¥le des actionneurs et d'autres choses; rien de tout cela ne fonctionnera simplement. <br><br>  La question s'est pos√©e - soit nous abandonnons la biblioth√®que du fabricant et √©crivons notre code de contr√¥le GPRS Shield (facile √† dire), soit nous abandonnons le module lui-m√™me et cherchons une solution alternative.  Mais le module est d√©j√† l√†, il a donc √©t√© d√©cid√© d'abandonner la biblioth√®que et d'√©crire le code de contr√¥le de votre module. <br><br><h2>  La conqu√™te de l'Everest </h2><br>  Je saute tout le processus de cr√©ation du code qui remplace la biblioth√®que standard d'Amperka, je note seulement que c'√©tait tr√®s, tr√®s difficile et exigeait un travail de recherche consid√©rable, la compilation d'un algorithme sophistiqu√© et des efforts consid√©rables pour tester la solution r√©sultante. <br><br>  Tout sera simple pour vous - un peu de magie et le code de travail pr√™t √† l'emploi du module AMS pour la prise en charge de GPRS Shield est pr√™t. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/557/a58/157/557a58157e7b45589395e0a9d867ee52.jpg" alt="image"></div><br><div class="spoiler">  <b class="spoiler_title">Code de module AMS complet rempla√ßant la biblioth√®que standard</b> <div class="spoiler_text"><pre><code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">/* Modul GPRS part of Arduino Mega Server project */</span></span> #ifdef GPRS_FEATURE #include &lt;SoftwareSerial.h&gt; #define ALWAYS <span class="hljs-number"><span class="hljs-number">1</span></span> #define GPRS_ON_PIN <span class="hljs-number"><span class="hljs-number">2</span></span> #define GPRS_STATE_PIN <span class="hljs-number"><span class="hljs-number">3</span></span> #define GPRS_RX_PIN <span class="hljs-number"><span class="hljs-number">62</span></span> #define GPRS_TX_PIN <span class="hljs-number"><span class="hljs-number">63</span></span> #define MASTER <span class="hljs-string"><span class="hljs-string">"+7yyyxxxxxxx"</span></span> #define MESSAGE <span class="hljs-string"><span class="hljs-string">"Hello"</span></span> #define CHECK_ERROR <span class="hljs-number"><span class="hljs-number">0</span></span> #define CHECK_MARKER <span class="hljs-number"><span class="hljs-number">1</span></span> #define CHECK_OK <span class="hljs-number"><span class="hljs-number">2</span></span> #define NO_CHECK <span class="hljs-number"><span class="hljs-number">3</span></span> #define MARKER_OK <span class="hljs-string"><span class="hljs-string">"OK"</span></span> #define MARKER_NO_CHECK <span class="hljs-string"><span class="hljs-string">"-"</span></span> <span class="hljs-comment"><span class="hljs-comment">// GPRS commands #define DATA_TEMP1 "temp1" #define DATA_CONT1 "cont1" #define DATA_LEAK1 "leak1" #define DATA_SMOKE1 "smoke1" #define DATA_ALL "all" #define DATA_RELAY1 "relay1" #define DATA_SERVO1 "servo1" #define DATA_PERIOD "period" #define CMD_RELAY1 "relay1=" #define CMD_SERVO1 "servo1=" #define CMD_PERIOD "period=" byte gprsPeriod = 24; SoftwareSerial GPRS(GPRS_RX_PIN, GPRS_TX_PIN); #define MAX_SOFT_SERIAL 128 char bufferGprs[MAX_SOFT_SERIAL]; int curBuf = 0; #define MESSAGE_LENGTH 20 char message[MESSAGE_LENGTH]; char phone[16]; char datetime[24]; void gprsInit() { initStart("GPRS", true); GPRS.begin(9600); gprsOnOff(); gprsStart(); sendGprs("AT+CFUN=1", "OK"); sendGprs("AT+CNMI=2,1", "OK"); sendGprs("AT+CMGF=1", "OK"); sendGprs("AT+CLIP=1", "OK"); modulGprs = MODUL_ENABLE; initDone(true); } void clearBufferGprs() { for (int i = 0; i &lt; curBuf; i++) { bufferGprs[i] = 0; } } void gprsStart() { while (ALWAYS) { delay(1000); curBuf = 0; GPRS.println("AT"); if (GPRS.available() &gt; 0) { while (GPRS.available() &gt; 0) { bufferGprs[curBuf++] = GPRS.read(); } bufferGprs[curBuf] = '\0'; if (strcmp(bufferGprs, "AT\r\n\r\nOK\r\n") == 0) { timeStamp(); Serial.println(" GPRS ON"); break; } else { Serial.print("."); } } clearBufferGprs(); } } // gprsStart() void gprsOnOff() { pinMode(GPRS_ON_PIN, OUTPUT); if (digitalRead(GPRS_STATE_PIN) != HIGH) { digitalWrite(GPRS_ON_PIN, HIGH); delay(3000); } digitalWrite(GPRS_ON_PIN, LOW); } bool clearSoftwareSerial() { if (GPRS.available() &gt; 0) { while (GPRS.available() &gt; 0) { char c = GPRS.read(); } } } #define DELAY_GPRS_COMMAND 2000 byte sendGprs(String command, char marker[]) { unsigned long timer = millis(); bool success = false; clearSoftwareSerial(); clearBufferGprs(); Serial.print(F("Send command: ")); //Serial.println(command); while (ALWAYS) { if (millis() - timer &gt; DELAY_GPRS_COMMAND) { Serial.print(F("Send error: ")); Serial.println(command); //clearBufferGprs(); return CHECK_ERROR; } curBuf = 0; GPRS.println(command); delay(280); if (GPRS.available() &gt; 0) { while (GPRS.available() &gt; 0) { char c = GPRS.read(); if (curBuf &gt; MAX_SOFT_SERIAL - 2) {break;} bufferGprs[curBuf++] = c; Serial.print(c); } Serial.println(); bufferGprs[curBuf] = '\0'; if (marker == MARKER_NO_CHECK) { Serial.print(F("Send no check, ")); Serial.println(millis() - timer); return NO_CHECK; } else if (StrContains(bufferGprs, marker)) { Serial.print(F("Send success, ")); Serial.println(millis() - timer); return CHECK_MARKER; } else if (StrContains(bufferGprs, MARKER_OK)) { Serial.print(F("Send success, ")); Serial.println(millis() - timer); return CHECK_OK; } else { Serial.println("."); } } // if (GPRS.available() &gt; 0) delay(500); } // while (ALWAYS) } // sendGprs( ) // +CMGR: "REC READ", "XXXXXXXXXXX", "", "16/10/01,10:00:00+12" // SMS text void parseSms(char *message, char *phone, char *datetime) { int i = 0; int j = 0; while (bufferGprs[i] != '\"') {i++;} i++; while (bufferGprs[i] != '\"') {i++;} i++; while (bufferGprs[i] != '\"') {i++;} i++; while (bufferGprs[i] != '\"') {phone[j++] = bufferGprs[i++];} phone[j] = '\0'; i++; while (bufferGprs[i] != '\"') {i++;} i++; while (bufferGprs[i] != '\"') {i++;} i++; while (bufferGprs[i] != '\"') {i++;} i++; j = 0; while (bufferGprs[i] != '\"') {datetime[j++] = bufferGprs[i++];} datetime[j] = '\0'; i++; while (bufferGprs[i] != '\n') {i++;} i++; j = 0; //Serial.print(F("strlen(bufferGprs): ")); Serial.println(strlen(bufferGprs)); while (i &lt; strlen(bufferGprs) - 1) { if (j &gt; MESSAGE_LENGTH - 1) {break;} if ((byte)bufferGprs[i] == 13) {break;} message[j++] = bufferGprs[i++]; } Serial.print(F("strlen(message1): ")); Serial.println(strlen(message)); message[j] = '\0'; Serial.print(F("strlen(message2): ")); Serial.println(strlen(message)); for (int z = 0; z &lt; strlen(message); z++) { Serial.print((byte)message[z]); Serial.print(F(" ")); } Serial.println(); } void deleteSms() { if (sendGprs("AT+CMGDA=\"DEL ALL\"", "OK")) { Serial.println(F("All SMS deleted")); } else { Serial.println(F("Error delete all SMS")); } } String stringSens(byte v) { String s = ""; switch (v) { case 0: s = (F("OFF")); break; case 1: s = (F("ON")); break; default: s = (F("?")); } return s; } String stringLeak(byte v) { String s = ""; switch (v) { case 0: s = (F("LEAK!")); break; case 1: s = (F("OK")); break; default: s = (F("?")); } return s; } String stringSmoke(byte v) { String s = ""; switch (v) { case 0: s = (F("OK")); break; case 1: s = (F("SMOKE!")); break; default: s = (F("?")); } return s; } String mkTemp1() {String s = DATA_TEMP1; s += '='; s += String(lpTempTemp); s += '\n'; return s;} String mkCont1() {String s = DATA_CONT1; s += '='; s += stringSens(lpContCont1); s += '\n'; return s;} String mkLeak1() {String s = DATA_LEAK1; s += '='; s += stringLeak(lpLeakLeak1); s += '\n'; return s;} String mkSmoke1() {String s = DATA_SMOKE1; s += '='; s += stringSmoke(smokeSmoke); s += '\n'; return s;} String mkRelay1() {String s = DATA_RELAY1; s += '='; s += stringSens(relayRelay); s += '\n'; return s;} String mkServo1() {String s = DATA_SERVO1; s += '='; s += stringSens(servoState); s += '\n'; return s;} String mkPeriod() {String s = DATA_PERIOD; s += '='; s += String(gprsPeriod); s += '\n'; return s;} String mkAll() { String s = ""; s += mkTemp1(); s += mkCont1(); s += mkLeak1(); s += mkSmoke1(); s += mkRelay1(); s += mkServo1(); s += mkPeriod(); return s; } void gprsSetRelay(byte v) { switch (v) { case 0: if (relayRelay) { relayRelay = STATE_OFF; } break; case 1: if (!relayRelay) { relayRelay = STATE_ON; } break; } } void gprsSetServo(byte v) { switch (v) { case 0: servoState = STATE_OFF; break; case 1: servoState = STATE_ON; break; } } void gprsAnswer() { String s = ""; String mess = String(message); String data = ""; if (mess == DATA_TEMP1) {s += mkTemp1();} else if (mess == DATA_CONT1) {s += mkCont1();} else if (mess == DATA_LEAK1) {s += mkLeak1();} else if (mess == DATA_SMOKE1) {s += mkSmoke1();} else if (mess == DATA_RELAY1) {s += mkRelay1();} else if (mess == DATA_SERVO1) {s += mkServo1();} else if (mess == DATA_PERIOD) {s += mkPeriod();} else if (mess == DATA_ALL) {s += mkAll();} else if (mess.indexOf(F("=")) &gt;= 0) { byte p = mess.indexOf(F("=")); if (mess.indexOf(CMD_RELAY1) &gt;= 0) {data = mess.substring(p + 1); gprsSetRelay(data.toInt()); s += DATA_RELAY1; s += '='; s += stringSens(relayRelay);} else if (mess.indexOf(CMD_SERVO1) &gt;= 0) {data = mess.substring(p + 1); gprsSetServo(data.toInt()); s += DATA_SERVO1; s += '='; s += stringSens(servoState);} else if (mess.indexOf(CMD_PERIOD) &gt;= 0) {data = mess.substring(p + 1); gprsPeriod = data.toInt(); s += DATA_PERIOD; s += '='; s += String(gprsPeriod);} } else { Serial.println(F("Not command!")); } //Serial.print(F("mess: ")); Serial.println(mess); //Serial.print(F("answ: ")); Serial.println(s); if (s == "") {s = "Error";} Serial.println(F("Send answer... ")); if (sendSms(MASTER, s)) { Serial.println(F("success")); } else { Serial.println(F("error")); } } void readSms() { byte result = sendGprs("AT+CMGR=1,1", "+CMGR:"); if (result == CHECK_MARKER) { parseSms(message, phone, datetime); Serial.print(F("Number: ")); Serial.println(phone); Serial.print(F("Datetime: ")); Serial.println(datetime); Serial.print(F("Message: ")); Serial.println(message); deleteSms(); if (String(phone) == String(MASTER)) { Serial.println(F("Message from MASTER!")); gprsAnswer(); } } else if (result == CHECK_OK) { Serial.println(F("No SMS")); } else { Serial.println(F("Error read SMS")); } } bool sendSms(char *number, String data) { String numstr = "AT+CMGS=\"" + String(number) + "\""; String messtr = data + String((char)26); if (sendGprs(numstr, "&gt;")) { if (sendGprs(messtr, MARKER_NO_CHECK)) { return true; } } return false; } void sendPeriod() { Serial.println(F("Send period SMS... ")); if (sendSms(MASTER, mkAll())) { Serial.println(F("success")); } else { Serial.println(F("error")); } } void gprsWorks() { if (cycle20s) { readSms(); } switch (gprsPeriod) { case 1: if (cycle1h) {sendPeriod();} break; case 6: if (cycle6h) {sendPeriod();} break; case 12: if (cycle12h) {sendPeriod();} break; default: if (cycle24h) {sendPeriod();} break; } } #endif // GPRS_FEATURE</span></span></code> </pre> <br></div></div><br>  Le module a √©t√© d√©velopp√© et test√© sur AMS version 0.16 pour Arduino Mega.  Les tests ont montr√© un fonctionnement absolument stable et fiable du bouclier GPRS sous le contr√¥le de ce module. <br><br><h2>  Connectez-vous au module de support AMS GPRS Shield </h2><br>  Afin de connecter le module GPRS Shield au Arduino Mega Server, vous devez effectuer quelques √©tapes simples.  Tout d'abord, ajoutez les lignes suivantes au fichier principal AMS <br><br><pre> <code class="java hljs">#define GPRS_FEATURE</code> </pre><br>  et <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> modulGprs = MODUL_NOT_COMPILLED;</code> </pre><br>  dans les sections appropri√©es.  L√†, vous devez ajouter des variables de test qui, dans votre projet r√©el, seront responsables des param√®tres contr√¥l√©s (temp√©rature, √©tat des contacts, etc.). <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">float</span></span> lpTempTemp; <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> lpContCont1; <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> lpLeakLeak1; <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> smokeSmoke; <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> relayRelay; <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> servoState;</code> </pre><br><h2>  Explication des fonctionnalit√©s prises en charge </h2><br>  Le module contient un ensemble de base de requ√™tes et de commandes, mais vous pouvez remplacer ces commandes par d'autres et / ou d√©velopper l'ensemble de base de commandes et de requ√™tes dont vous avez besoin. <br><br><h3>  Demandes </h3><br>  Les demandes sont envoy√©es par SMS, le syst√®me envoie des r√©ponses (√©galement par SMS) contenant des informations sur le param√®tre demand√©.  Tr√®s simple: nous envoyons la demande ¬´temp1¬ª depuis le t√©l√©phone, le syst√®me en r√©ponse envoie la valeur de temp√©rature actuelle <code>temp1=20.50</code> . <br><br><blockquote>  <strong>temp1</strong> - demande de temp√©rature <br>  <strong>cont1</strong> - demande le statut du contact <br>  <strong>fuite1</strong> - demande l'√©tat du capteur de fuite <br>  <strong>smoke1</strong> - interroge l'√©tat du d√©tecteur de fum√©e <br>  <strong>relay1</strong> - demande d'√©tat du relais (cl√©) <br>  <strong>servo1</strong> - demande le statut du servo-chargeur <br>  <strong>p√©riode</strong> - demande pour la p√©riode de forfaits de t√©l√©m√©trie automatique <br>  <strong>all</strong> - demande tous les param√®tres du syst√®me </blockquote><br>  En r√©ponse √† la demande ¬´tous¬ª, le syst√®me envoie une liste de tous les param√®tres.  Dans le cas de l'envoi d'une commande non enregistr√©e, le syst√®me enverra une r√©ponse ¬´Erreur¬ª.  Si les param√®tres surveill√©s sont en dehors de la plage normale, le syst√®me lui-m√™me peut envoyer des messages d'alarme au smartphone de l'op√©rateur. <br><br>  Afin de g√©rer le syst√®me, seul un op√©rateur enregistr√© pourrait le faire, le syst√®me est prot√©g√© contre les acc√®s non autoris√©s - il ne r√©pond qu'aux commandes d'un ou de plusieurs num√©ros de t√©l√©phone sp√©cifiques. <br><br><h3>  √âquipes </h3><br>  Les commandes sont envoy√©es par SMS, apr√®s avoir accept√© la commande, le syst√®me change son √©tat et envoie des r√©ponses avec des informations sur le nouvel √©tat de ses actionneurs ou param√®tres. <br><br><blockquote>  <strong>relay1 =</strong> - commande de commande de relais (touche) <br>  <strong>servo1 =</strong> - commande de contr√¥le du chargeur <br>  <strong>period =</strong> - commande pour modifier la p√©riode d'envoi automatique de la t√©l√©m√©trie </blockquote><br>  Un exemple.  Commande <code>relay1=1</code> , r√©ponse <code>relay1=ON</code> .  Commande <code>relay1=0</code> , r√©ponse <code>relay1=OFF</code> . <br><br><h2>  Explications du code </h2><br>  Initialisation du module GPRS.  Initialisation standard du module AMS, lancement de SoftwareSerial, et un peu de magie des commandes GSM AT.  Le but de ce bloc est de donner vie au module GPRS et de le renvoyer du nirvana si √† ce moment il l'avait laiss√© pour une raison ind√©pendante de notre volont√©. <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">gprsInit</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ initStart(<span class="hljs-string"><span class="hljs-string">"GPRS"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); GPRS.begin(<span class="hljs-number"><span class="hljs-number">9600</span></span>); gprsOnOff(); gprsStart(); sendGprs(<span class="hljs-string"><span class="hljs-string">"AT+CFUN=1"</span></span>, <span class="hljs-string"><span class="hljs-string">"OK"</span></span>); sendGprs(<span class="hljs-string"><span class="hljs-string">"AT+CNMI=2,1"</span></span>, <span class="hljs-string"><span class="hljs-string">"OK"</span></span>); sendGprs(<span class="hljs-string"><span class="hljs-string">"AT+CMGF=1"</span></span>, <span class="hljs-string"><span class="hljs-string">"OK"</span></span>); sendGprs(<span class="hljs-string"><span class="hljs-string">"AT+CLIP=1"</span></span>, <span class="hljs-string"><span class="hljs-string">"OK"</span></span>); modulGprs = MODUL_ENABLE; initDone(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); }</code> </pre><br>  La principale fonction de travail du module.  Toutes les 20 secondes, l'Arduino Mega Server v√©rifie les SMS entrants et, en cas de demande ou de commande, les ex√©cute.  Il en r√©sulte que le d√©lai moyen d'ex√©cution de la commande est de 10 secondes (hors d√©lai d'envoi de SMS par l'op√©rateur t√©l√©com).  Cet intervalle peut √™tre configur√©, 20 secondes sont s√©lectionn√©es comme compromis entre la vitesse de r√©action aux commandes SMS et le d√©marrage du syst√®me. <br><br>  Dans ces 20 secondes, AMS peut faire tout ce dont il a besoin et le SMS qui arrive pendant cette p√©riode n'est pas perdu.  Lorsque vous utilisez la biblioth√®que standard, le syst√®me ne peut rien faire mais attendre que le SMS arrive, sinon il les perd (et le contr√¥leur ne peut rien faire pour le moment non plus). <br><br>  Il existe √©galement un code d'envoi de t√©l√©m√©trie avec un intervalle sp√©cifi√© de 1 heure, 6 heures, 12 heures ou 24 heures.  Cet intervalle peut √™tre modifi√© en envoyant la commande appropri√©e par SMS. <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">gprsWorks</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (cycle20s) { readSms(); } <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (gprsPeriod) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (cycle1h) {sendPeriod();} <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (cycle6h) {sendPeriod();} <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">12</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (cycle12h) {sendPeriod();} <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (cycle24h) {sendPeriod();} <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } }</code> </pre><br>  L'interaction du module GPRS et du contr√¥leur est effectu√©e √† l'aide de commandes AT sp√©ciales et les fonctions suivantes forment les commandes du module GPRS dans des codes qui lui sont compr√©hensibles. <br><br>  Fonction d'envoi de SMS.  Dans les param√®tres de la fonction, le num√©ro de t√©l√©phone de destination et la commande ou la requ√™te sont transmis sous forme de texte. <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-function">bool </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sendSms</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *number, String data)</span></span></span><span class="hljs-function"> </span></span>{ String numstr = <span class="hljs-string"><span class="hljs-string">"AT+CMGS=\""</span></span> + String(number) + <span class="hljs-string"><span class="hljs-string">"\""</span></span>; String messtr = data + String((<span class="hljs-keyword"><span class="hljs-keyword">char</span></span>)<span class="hljs-number"><span class="hljs-number">26</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (sendGprs(numstr, <span class="hljs-string"><span class="hljs-string">"&gt;"</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (sendGprs(messtr, MARKER_NO_CHECK)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; }</code> </pre><br>  Fonction de lecture SMS.  Les valeurs accept√©es sont plac√©es dans les variables message, phone et datetime, qui contiennent respectivement la commande re√ßue, le num√©ro de t√©l√©phone et l'heure d'envoi. <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">readSms</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> result = sendGprs(<span class="hljs-string"><span class="hljs-string">"AT+CMGR=1,1"</span></span>, <span class="hljs-string"><span class="hljs-string">"+CMGR:"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (result == CHECK_MARKER) { parseSms(message, phone, datetime); Serial.print(F(<span class="hljs-string"><span class="hljs-string">"Number: "</span></span>)); Serial.println(phone); Serial.print(F(<span class="hljs-string"><span class="hljs-string">"Datetime: "</span></span>)); Serial.println(datetime); Serial.print(F(<span class="hljs-string"><span class="hljs-string">"Message: "</span></span>)); Serial.println(message); deleteSms(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (String(phone) == String(MASTER)) { Serial.println(F(<span class="hljs-string"><span class="hljs-string">"Message from MASTER!"</span></span>)); gprsAnswer(); } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (result == CHECK_OK) { Serial.println(F(<span class="hljs-string"><span class="hljs-string">"No SMS"</span></span>)); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { Serial.println(F(<span class="hljs-string"><span class="hljs-string">"Error read SMS"</span></span>)); } }</code> </pre><br>  La fonction de former une r√©ponse aux requ√™tes et commandes SMS.  Cette fonction est sp√©cifique √† chaque projet et vous pouvez la modifier dans vos projets selon la logique de votre syst√®me. <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">gprsAnswer</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ String s = <span class="hljs-string"><span class="hljs-string">""</span></span>; String mess = String(message); String data = <span class="hljs-string"><span class="hljs-string">""</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (mess == DATA_TEMP1) {s += mkTemp1();} <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (mess == DATA_CONT1) {s += mkCont1();} <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (mess == DATA_LEAK1) {s += mkLeak1();} <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (mess == DATA_SMOKE1) {s += mkSmoke1();} <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (mess == DATA_RELAY1) {s += mkRelay1();} <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (mess == DATA_SERVO1) {s += mkServo1();} <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (mess == DATA_PERIOD) {s += mkPeriod();} <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (mess == DATA_ALL) {s += mkAll();} <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (mess.indexOf(F(<span class="hljs-string"><span class="hljs-string">"="</span></span>)) &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> p = mess.indexOf(F(<span class="hljs-string"><span class="hljs-string">"="</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (mess.indexOf(CMD_RELAY1) &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span>) {data = mess.substring(p + <span class="hljs-number"><span class="hljs-number">1</span></span>); gprsSetRelay(data.toInt()); s += DATA_RELAY1; s += <span class="hljs-string"><span class="hljs-string">'='</span></span>; s += stringSens(relayRelay);} <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (mess.indexOf(CMD_SERVO1) &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span>) {data = mess.substring(p + <span class="hljs-number"><span class="hljs-number">1</span></span>); gprsSetServo(data.toInt()); s += DATA_SERVO1; s += <span class="hljs-string"><span class="hljs-string">'='</span></span>; s += stringSens(servoState);} <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (mess.indexOf(CMD_PERIOD) &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span>) {data = mess.substring(p + <span class="hljs-number"><span class="hljs-number">1</span></span>); gprsPeriod = data.toInt(); s += DATA_PERIOD; s += <span class="hljs-string"><span class="hljs-string">'='</span></span>; s += String(gprsPeriod);} } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { Serial.println(F(<span class="hljs-string"><span class="hljs-string">"Not command!"</span></span>)); } <span class="hljs-comment"><span class="hljs-comment">//Serial.print(F("mess: ")); Serial.println(mess); //Serial.print(F("answ: ")); Serial.println(s); if (s == "") {s = "Error";} Serial.println(F("Send answer... ")); if (sendSms(MASTER, s)) { Serial.println(F("success")); } else { Serial.println(F("error")); } }</span></span></code> </pre><br>  Fonctions de formation de r√©ponses.  Ce sont des fonctions qui forment les r√©ponses que le syst√®me envoie par SMS au smartphone de l'utilisateur en r√©ponse √† une demande ou √† sa discr√©tion, conform√©ment au programme d√©fini. <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-function">String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">stringSens</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params"> v)</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">stringLeak</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params"> v)</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">stringSmoke</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params"> v)</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mkTemp1</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mkCont1</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mkLeak1</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mkSmoke1</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mkRelay1</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mkServo1</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mkPeriod</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mkAll</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span></code> </pre><br>  Et les fonctions d'ex√©cution des commandes.  Ce sont des fonctions qui sont ex√©cut√©es par des commandes SMS et changent l'√©tat du syst√®me, c'est-√†-dire modifient ses param√®tres ou activent ou d√©sactivent des actionneurs. <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">gprsSetRelay</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params"> v)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">gprsSetServo</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params"> v)</span></span></span></span></code> </pre><br>  Les fonctions restantes sont purement techniques, faisant tout le travail de maintenance de l'interaction entre le bouclier GPRS et le microcontr√¥leur. <br><br><h2>  Un peu plus sur SoftwareSerial </h2><br>  Tout ce qui pr√©c√®de n'est pas suffisant pour que GPRS Shield fonctionne en mode transparent et arr√™te de bloquer les autres processus en cours d'ex√©cution sur le microcontr√¥leur.  Il est √©galement n√©cessaire de modifier le code de la biblioth√®que SoftwareSerial.  Le fait est que sa m√©moire tampon standard de 64 octets n'est pas suffisante pour dig√©rer la plupart des commandes AT GSM et maintenir une interaction dynamique entre le module et le contr√¥leur. <br><br>  Vous devez augmenter ce tampon √† au moins 128 octets, et seulement apr√®s cela, la magie fonctionnera et le bouclier GPRS commencera √† fonctionner normalement en mode transparent.  Cela se fait dans le fichier <code>SoftwareSerial.h</code> .  Ligne <br><br><pre> <code class="java hljs">#define _SS_MAX_RX_BUFF <span class="hljs-number"><span class="hljs-number">64</span></span> <span class="hljs-comment"><span class="hljs-comment">// RX buffer size</span></span></code> </pre><br>  besoin de changer pour <br><br><pre> <code class="java hljs">#define _SS_MAX_RX_BUFF <span class="hljs-number"><span class="hljs-number">128</span></span> <span class="hljs-comment"><span class="hljs-comment">// RX buffer size</span></span></code> </pre><br><h2>  Conclusion </h2><br>  Vous voyez l'√©change des commandes de l'op√©rateur et des r√©ponses du syst√®me sur l'√©cran du smartphone.  Et tandis que le syst√®me effectue des dizaines de processus en mode pseudo-multit√¢che.  Et GPRS Shield a commenc√© √† occuper moins de 1% du temps processeur, au lieu de 99% comme auparavant, lib√©rant ainsi le reste du temps pour le serveur Web et d'autres t√¢ches de gestion du poulailler. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/2e1/615/a08/2e1615a08e2a4a29802805066509d3e4.png" alt="image"></div><br>  C'est tout, nous avons int√©gr√© GPRS Shield dans <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">AMS</a> , surmont√© tous les obstacles, l'avons fait fonctionner en mode transparent, sans bloquer d'autres processus comme un serveur Web, le fonctionnement de capteurs et actionneurs sans fil, et cela ouvre des perspectives int√©ressantes pour la construction d'un grand nombre de syst√®mes avec contr√¥le SMS GSM et contr√¥le bas√© sur AMS - serres, syst√®mes de s√©curit√© et de chauffage, diverses options pour une maison intelligente, etc., etc. presque √† l'infini. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr401721/">https://habr.com/ru/post/fr401721/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr401709/index.html">Lin Industrial n'abandonne pas</a></li>
<li><a href="../fr401711/index.html">Valve –æ–±—É—á–∞–µ—Ç –ò–ò –≤—ã—è–≤–ª—è—Ç—å —á–∏—Ç–µ—Ä–æ–≤ –≤ CS:GO</a></li>
<li><a href="../fr401713/index.html">Que faire lorsque vous vous ennuyez dans l'avion - ex√©cutez Google Chrome sur le dossier de la chaise</a></li>
<li><a href="../fr401715/index.html">La p√™che dans l'espace par Robert Winglee (NASA)</a></li>
<li><a href="../fr401719/index.html">Cyclone 10 - FPGA de marque Intel</a></li>
<li><a href="../fr401723/index.html">R√©novation artistique d'anciens √©quipements informatiques</a></li>
<li><a href="../fr401725/index.html">L'histoire de la technologie implantable. Dentiers</a></li>
<li><a href="../fr401727/index.html">Choisir un cadeau Geek pour le 23 f√©vrier: Guide Madrobots</a></li>
<li><a href="../fr401729/index.html">Quel est le ¬´bruit¬ª utile (et dangereux) qui nous entoure</a></li>
<li><a href="../fr401735/index.html">Apprendre l'int√©rieur des enceintes vibro mobiles PartyFon Max</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>