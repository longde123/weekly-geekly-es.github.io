<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🎌 🌋 👨🏻‍🎓 耐心和劳动将摘录全文 🤱 🥕 🧑🏻‍🤝‍🧑🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="在培训课程中（5月至6月和12月至1月），用户要求我们每分钟检查最多500份文档的借阅。 文档以各种格式出现，使用每种格式的复杂性都不同。 要检查文档是否借用，我们首先需要从文件中提取其文本，并同时处理格式。 任务是实现每分钟格式化的半文本的高质量提取，而很少出现（或者最好完全不掉下来），消耗很少的...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>耐心和劳动将摘录全文</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/antiplagiat/blog/458842/"><p> 在培训课程中（5月至6月和12月至1月），用户要求我们每分钟检查最多500份文档的借阅。 文档以各种格式出现，使用每种格式的复杂性都不同。 要检查文档是否借用，我们首先需要从文件中提取其文本，并同时处理格式。 任务是实现每分钟格式化的半文本的高质量提取，而很少出现（或者最好完全不掉下来），消耗很少的资源，并且不为最终构想的开发和操作付出银河预算的一半。 </p><br><p> 是的，是的，当然，我们知道在三件事中-快速，廉价和高效-您需要选择任意两项。 但最讨厌的是我们无法删除任何内容。 问题是我们做得如何... </p><br><p><img src="https://habrastorage.org/webt/us/nu/t4/usnut4dlt0wwlqzbkwhnmlud1uo.png"></p><br><p>  <sub><em>图片来源： <a href="">Wikipedia</a></em></sub> <br></p><p><a name="habracut"></a></p><br><p> 人们经常被告知，人的命运取决于我们工作的质量。 因此，您必须教育自己的完美主义者。 当然，由于不道德的作者提出了新的解决方法，因此我们（在各个方面）都在不断提高系统的质量。 我希望这一天即将到来，一方面，欺骗的复杂性，另一方面，对做得好的工作的满足感，将促使绝大多数学生放弃他们心爱的四处游荡的愿望。 同时，我们了解到，如果我们突然伪造错误，错误的代价可能是无辜者可能遭受的痛苦。 </p><br><p> 我为什么 如果我们是完美主义者，我们将以深思熟虑的方式撰写<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">有关反Anti窃制度</a>工作<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">的</a>一系列文章。 我们将努力制定出版计划，以最合乎逻辑和预期的方式向读者陈述所有内容： </p><br><ul><li> 首先，我们将讨论系统的结构（哈布雷的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">第五本出版物</a> ），并描述检查借入文件时处理文件的三个主要阶段： <br><ol><li> 提取文档的文本（您在这里！）； </li><li> 搜索贷款（ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">我们的几篇文章</a>中已经介绍<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">了这些内容</a> ）； </li><li> 在文档上生成报告（在计划中）。 </li></ol></li><li> 此外，我们将开始为读者提供有趣的辅助机制，例如寻找可转让借款（ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">第一篇文章</a> ），释义的定义（ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">第四篇</a> ）和主题分类（ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">第二篇</a> ）。 </li><li> 最后，我们进入了搜索引擎-带状疱疹的索引（ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">第七篇文章</a> ）。 </li></ul><br><p>细心的读者一定已经注意到，我们仍然不会遭受过度的完美主义困扰，因此现在该进入第一个阶段了-提取文本和格式化文档。 这就是我们今天要做的事情：思考生命的死亡和隧道尽头的光明，不存在任何理想事物，追求卓越，制定计划并遵循计划以及生活总是使我们趋于妥协的妥协。 </p><br><h1> 一开始是这个词 </h1><br><p> 首先，我们仅从文档中提取了检查借阅所需的最必要文档，即文档本身的文本。 支持的主要格式-docx，doc，txt，pdf，rtf，html。 然后添加了较不常见的ppt，pptx，odt，epub，fb2，djvu，但是，将来有<abbr title="由于需求量非常低，因此无法证明为支持这些格式而付出的努力">必要拒绝</abbr>与它们<abbr title="由于需求量非常低，因此无法证明为支持这些格式而付出的努力">中的</abbr>大多数<abbr title="由于需求量非常低，因此无法证明为支持这些格式而付出的努力">一起</abbr>工作。 它们中的每一个都以自己的方式处理-在单独的库中的某个地方，在其自己的解析器中的某个地方。 平均而言，文本提取持续约数百毫秒。 似乎提取文本的主要困难，而且几乎是唯一的困难是格式本身的“解析”，这对于二进制pdf和doc格式尤其如此（后者的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">专有性</a>使其使用起来更加成问题）。 但是，已经在现阶段，当我们的愿望仅限于提取文本时，很明显，任何读取所需格式的方式都带有许多令人不愉快的功能。 其中最重要的： </p><br><ul><li> 即使在处理某些有效文档时也是如此，更不用说对格式错误的“损坏”文档的处理了。 造成更多问题的是<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">本机代码</a>可能崩溃，并且很难在.net代码中处理这种情况； </li><li> 内存消耗不足，可能会损害相邻进程以及当前处理“问题”文档的当前进程（托管或非托管代码中的内存不足）； </li><li> 文档处理时间过长，大多数图书馆都缺乏取消机制，有时还需要从托管对象中取消非托管代码调用的复杂性（阅读：几乎不可能），这加剧了该文档的处理； </li><li>  “从文档中提取文本。” 生成pdf文档的文本（这种格式是我们的关键），与预期相反，已经进行了解析，这是一项艰巨的任务。 事实是<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">pdf格式</a>最初主要是为印刷材料的电子表示而开发的。  pdf中的文本是位于文档页面上的一组文本块。 此外，块可以是一段文字或单个字符。 从这组块中还原原始形式的文本的任务在于读取文档的库（代码/程序）。 是的，从某种版本开始的格式可以指定块的顺序，但是不幸的是，带有标记的文本块序列的文档很少。 因此，pdf文本阅读库包含许多启发式方法（嗯，这是这里的标准：机器学习，大数据， <s>区块链</s>等），可让您以一种或另一种程度的正确形式还原文本，并且正如所期望的，每个库获得的结果不同。 </li></ul><br><p><img src="https://habrastorage.org/webt/nr/hu/jb/nrhujbad4ji9xkwm5qzajzmvq24.png"></p><br><p>  <sub><em>底部图片来源： <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">文章</a></em></sub> </p><br><p>  <sub><em>热门图片来源： <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">嗯...</a></em></sub> </p><br><h1> 需要更多数据！ </h1><br><p> 如果对于分析一个要借用的文档来说，文档的文本背景足以满足我们的需要，那么不从文档中提取其他数据就不可能或很难实现许多新功能。 今天，除了文本背景之外，我们还提取文档格式并<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">渲染</a>页面图像。 我们将后者用于光学文本识别（ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">OCR</a> ）以及识别某些类型的旁路。 </p><br><p> 格式化文档包括页面上所有单词和字符的几何排列以及所有字符的字体大小。 此信息使我们能够： </p><br><ul><li> 精美显示文件验证报告，将检测到的借款直接画在原始文件上； <br><img src="https://habrastorage.org/webt/hk/uo/am/hkuoamt7hjscszy6lcgoc4vjeoy.png"><br></li><li> 确定文档块（标题页， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">书目</a> ）的准确性更高，并检索其元数据（作者，职称，工作年份和地点等）； </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">检测系统旁路尝试。</a> </li></ul><br><p> 为了统一处理文档和一组提取的数据，我们将支持的所有格式的文档转换为pdf。 因此，提取文档数据的过程分为两个阶段： </p><br><ul><li> 将文件转换为pdf； </li><li> 从pdf中提取数据。 </li></ul><br><h1> 转换为pdf。 图书馆选择 </h1><br><p> 由于将文档转换为pdf文件并不容易，因此我们决定不重新发明轮子，而是探索现成的解决方案，选择最适合我们的解决方案。 那是在2017年。 </p><br><p> 选择候选人的标准： </p><br><ul><li>  .net上的库，最好是.net核心和跨平台 <div class="spoiler">  <b class="spoiler_title">剧透！</b> <div class="spoiler_text"> 结果，那时候理想是无法实现的 </div></div></li><li> 支持所需格式-doc，docx，rtf，odf，ppt，pptx </li><li> 稳定度 </li><li> 性能表现 </li><li> 技术支持质量 </li><li> 发行价 </li></ul><br><p> 我们分析了可用的解决方案，从中选择了最适合我们任务的6种解决方案： </p><br><div class="scrollable-table"><table><tbody><tr><th> 图书馆 </th><th> 表面问题 </th></tr><tr><td>  MS Word。 互操作 </td><td>  <b>需要：</b> MS Word。 通过COM调用Microsoft Word。 该方法有许多缺点：需要安装MS Word，不稳定，性能差。 有许可限制。 </td></tr><tr><td>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">DevExpress（17）</a> </td><td> 不支持ppt，pptx </td></tr><tr><td>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">群组文档</a> </td><td>  -- </td></tr><tr><td>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">融合</a> </td><td> 不支持ppt，pptx，odt </td></tr><tr><td>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Neevia文件转换器Pro</a> </td><td> 需要：MS Word。 不支持odt </td></tr><tr><td>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">动态PDF</a> </td><td> 需要：MS Word，Internet Explorer。 不支持odt </td></tr></tbody></table></div><br><p>  MS Word Interop，Neevia Document Converter Pro和DynamicPdf要求在生产环境中安装MS Office，这最终可能使我们与Windows紧密结合。 因此，我们不再考虑这些选项。 </p><br><p> 因此，我们剩下三个主要的候选者，其中只有一个完全支持我们需要的所有格式。 好了，是时候看看他们的能力了。 </p><br><p> 为了测试这些库，我们形成了一个12万真实用户文档的样本，其中格式的比例大约对应于我们每天在生产中看到的内容。 </p><br><p> 所以第一轮。 让我们看看可以考虑将多大比例的文档成功转换为pdf库。 在我们的情况下，成功不要抛出异常，满足3分钟的超时时间并返回非空文本。 </p><br><div class="scrollable-table"><table><tbody><tr><th rowspan="2"> 转换器 </th><th rowspan="2"> 成功（％） </th><th colspan="5"> 不成功（％） </th></tr><tr><th> 合计 </th><th> 空白文字 </th><th> 例外情况 </th><th> 超时（3分钟） </th><th> 流程下降 </th></tr><tr><td> 群组文档 </td><td>  99.012 </td><td>  0.988 </td><td>  0.039 </td><td>  0.873 </td><td>  0.076 </td><td>  0 </td></tr><tr><td> 开发快递 </td><td>  99.819 </td><td>  0.181 </td><td>  0.123 </td><td>  0.019 </td><td>  0.039 </td><td>  0 </td></tr><tr><td> 融合 </td><td>  98.358 </td><td>  1.632 </td><td>  0.039 </td><td>  0.848 </td><td>  0.745 </td><td>  0.01 </td></tr></tbody></table></div><br><p>  Syncfusion立即脱颖而出，不仅能够成功处理最少数量的文档，而且还可以将整个过程转储到某些文档上（生成诸如OutOfMemoryException之类的异常或来自本机代码的异常，这些异常是未经手鼓跳舞才被捕获的）。 </p><br><p>  GroupDocs无法处理的文档数量是DevExpress的<b>5.5</b>倍（所有内容都可以在上面的板上看到）。 尽管有这样一个事实，即GroupDocs的单个开发者许可证比DevExpress的单个开发者许可证贵大约9倍。 顺便说一句，就是这样。 </p><br><p> 第二个严格的测试是转换时间，相同的12万个文档： </p><br><div class="scrollable-table"><table><tbody><tr><th> 转换器 </th><th> 平均值（秒） </th><th> 中位数（秒） </th><th> 标准（秒） </th></tr><tr><td> 群组文档 </td><td>  1.301966 </td><td>  0.328000 </td><td>  6.401197 </td></tr><tr><td> 开发快递 </td><td>  0.523453 </td><td>  0.252000 </td><td>  1.781898 </td></tr><tr><td> 融合 </td><td>  8.922892 </td><td>  4.987000 </td><td>  12.929588 </td></tr></tbody></table></div><br><img src="https://habrastorage.org/webt/g5/2h/3k/g52h3klfh-leliffdwmrtmgapxy.png"><br><br><p> 请注意，DevExpress不仅平均可以更快地处理文档，而且显示的处理时间要稳定得多。 </p><br><p> 但是，如果输出的pdf不好，稳定性和处理速度将毫无意义。 也许DevExpress跳过了一半的文字？ 我们检查。 因此，相同的12万个文档，这次我们将计算提取的文本的总容量和字典单词的平均份额（字典中提取的单词越多，垃圾/错误提取的文本越少）： </p><br><div class="scrollable-table"><table><tbody><tr><th> 转换器 </th><th> 文字总数（以字符为单位） </th><th> 词汇平均比例 </th></tr><tr><td> 群组文档 </td><td>  6321145966 </td><td>  0.949172 </td></tr><tr><td> 开发快递 </td><td>  6135668416 </td><td>  0.950629 </td></tr><tr><td> 融合 </td><td>  5,995,008,572 </td><td>  0.938693 </td></tr></tbody></table></div><br><p> 该假设在某种程度上是正确的。 事实证明，与DevExpress不同，GroupDocs可以使用脚注。 在将文档转换为pdf时，DevExpress只是跳过它们。 顺便说一句，是的，在所有情况下都使用DevExpress'a从收到的pdf'ok中提取文本。 </p><br><p> 因此，我们研究了相关库的速度和稳定性，现在我们仔细评估pdf文档转换的质量。 为此，我们将不仅分析要提取的文本的数量和其中词典词的比例，还要将从接收的pdf中提取的文本与使用MS Word获得的pdf文本进行比较。 我们接受使用MS Word作为<i>参考pdf</i>转换文档的结果。 为该测试准备了大约4,500对“ <i>文档，参考pdf'ka</i> ”。 </p><br><div class="scrollable-table"><table><tbody><tr><th rowspan="2"> 转换器 </th><th rowspan="2">  <abbr title="图书馆能够提取的文件百分比">提取文字（％）</abbr> </th><th colspan="3"> 接近文字长度 </th><th colspan="3"> 字频接近度 </th></tr><tr><th> 平均值 </th><th> 中位数 </th><th>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">斯科</a> </th><th> 平均值 </th><th> 中位数 </th><th>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">斯科</a> </th></tr><tr><td> 群组文档 </td><td>  99.131 </td><td>  0.985472 </td><td>  0.999756 </td><td>  0.095304 </td><td>  0.979952 </td><td>  1.000000 </td><td>  0.102316 </td></tr><tr><td> 开发快递 </td><td>  99.726 </td><td>  0.971326 </td><td>  0.996647 </td><td>  0.075951 </td><td>  0.965686 </td><td>  0.996101 </td><td>  0.082192 </td></tr><tr><td> 融合 </td><td>  89.336 </td><td>  0.880229 </td><td>  0.996845 </td><td>  0.306920 </td><td>  0.815760 </td><td>  0.998206 </td><td>  0.348621 </td></tr></tbody></table></div><br><p> 对于每对“ <i>参考pdf，转换结果</i> ”，我们计算了提取文本的长度和提取词的频率之间的相似度。 当然，仅在转换成功的情况下才能获得这些指标。 因此，我们在这里不考虑Syncfusion的结果。  DevExpress和GroupDocs表现出大致相同的性能。 在DevExpress方面，成功转换的百分比要高得多，而在GD方面，有脚注的正确工作就可以了。 </p><br><p> 根据结果​​，选择是显而易见的。 到目前为止，我们正在使用DevExpress的解决方案，并将很快计划升级到其第19版。 </p><br><h1> 有pdf格式的文本提取 </h1><br><p> 因此，我们可以将文档转换为pdf。 现在，我们还有另一个任务：使用DevExpress提取文本，了解每个单词的所有所需信息。 即： </p><br><ul><li> 这个词在哪一页上？ </li><li> 单词在页面上的位置（框住一个矩形）； </li><li> 单词的字体大小（单词字符）。 </li></ul><br><p> 该图像显示了将文本细分为页面的过程，还显示了文本单词与页面区域的对应关系。 </p><br><p><img src="https://habrastorage.org/webt/sv/zy/ja/svzyjafy1nmstmlbblte4uhdpwg.png"></p><br><p>  <sub><em>图像来源： <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">从科学文献中提取标头元数据</a></em></sub> </p><br><p> 似乎一切都应该很简单。 我们看一下API DevExpress为我们提供的内容： </p><br><ul><li> 我们有一个返回整个文档文本的方法。 普通<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">弦</a> ; </li><li> 我们有能力根据文档进行迭代。 对于每个单词，我们可以获得： <br><ul><li> 文字； </li><li> 单词所在的页面； </li><li> 单词的框架矩形； </li><li> 有关单词各个字符的信息（构成矩形的字符的含义，字体大小等）。 </li></ul><br></li></ul><br><p> 好吧，一切似乎都在那里。 仅在这里，如何获取DevExpress返回的文档文本中每个单词的必要数据？ 我们实际上并不希望自己从单词中收集文档的文本，因为例如，我们不知道单词之间只有空格以及换行符在哪里。 我们将不得不根据单词的位置提出启发式方法。。。文本是-在我们面前，这已经是汇编。 </p><br><p><img src="https://habrastorage.org/webt/ti/d9/ru/tid9ruengnw06fe0krbvfqbpfle.jpeg"></p><br><p>  <sub><em>图片来源： <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">尤里卡！</a></em></sub> </p><br><p> 显而易见的解决方案是使单词与文档的文本匹配。 我们看-实际上，在文档的文本中，单词的排列顺序与迭代器根据文档的单词返回的顺序相同。 </p><br><p> 我们迅速实现了一种简单的算法，用于将单词与文档的文本进行匹配，添加检查内容是否正确匹配，然后开始... </p><br><p><img src="https://habrastorage.org/webt/uc/xw/ks/ucxwkst9qdybxsrwsgrxi4qncyk.png"></p><br><p> 实际上，所有内容在绝大多数页面上都可以正常运行，但是不幸的是，并非在所有页面上都可以正常工作。 </p><br><img src="https://habrastorage.org/webt/mm/sc/gb/mmscgb1gygbne-ail3tsccjs_ik.png"><br><p>  <sub><em>热门图片来源： <a href="">确定吗？</a></em></sub> </p><br><p> 在文档的一部分上，我们看到文本中的单词在遍历文档的单词时并没有按照它们的顺序排列。 此外，可以看出，单词列表中文本的开头方括号表示为结束括号，并且在另一个“单词”中。 通过在MS Word中打开文档，可以看到此文本片段的正确显示。 更有趣的是，如果您不将文档转换为pdf，而是直接从doc中提取文本，那么我们将获得文本片段的第三个版本，该版本与从库中收到的正确顺序或其他两个顺序都不匹配。 在此片段中，就像在其余大多数片段中一样，也会出现类似的问题，重点是不可见的“ RTL”字符，这些字符会更改相邻字符/单词的顺序。 </p><br><p> 这里值得回顾的是，在选择库时，我们称技术支持的质量很重要。 如实践所示，在这方面，与DevExpress的交互非常有效。 创建相应的票证后，提交的文档问题很快得到解决。 与异常/高内存消耗/长文档处理有关的许多其他问题也已修复。 </p><br><p> 但是，尽管DevExpress没有提供直接的方法来获取每个单词具有必要信息的文本，但有时我们会继续进行比较。 如果我们无法在单词和文本之间建立精确的匹配，我们将使用许多启发式方法，允许单词的小的排列。 如果没有帮助，文档将保持不变而不会格式化。 很少，但是这种情况会发生。 </p><br><p> 再见:) </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN458842/">https://habr.com/ru/post/zh-CN458842/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN458830/index.html">Dell Technologies网络研讨会：我们教程的所有详细信息</a></li>
<li><a href="../zh-CN458832/index.html">五名学生和三个分布式键值存储</a></li>
<li><a href="../zh-CN458834/index.html">保罗·艾伦（Paul Allen）个性的一面，关于这个问题，我想知道的人并不多</a></li>
<li><a href="../zh-CN458836/index.html">罗宋汤指数。 评估，比较，确定价格/质量比的系统方法</a></li>
<li><a href="../zh-CN458840/index.html">我们如何刺穿中国大防火墙（第2部分）</a></li>
<li><a href="../zh-CN458844/index.html">通过VeriSM™适应方法进行筒仓破坏</a></li>
<li><a href="../zh-CN458846/index.html">如何使用Unity开发另一个平台游戏。 另一个教程</a></li>
<li><a href="../zh-CN458848/index.html">Rust 1.36.0版本：未来特性，分配稳定和MaybeUninit <T></a></li>
<li><a href="../zh-CN458850/index.html">廉价而高效地学习英语。 第二部分</a></li>
<li><a href="../zh-CN458854/index.html">MotionLayout：动画效果更好，代码更少</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>