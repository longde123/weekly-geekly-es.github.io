<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>â­ï¸ ğŸ”˜ ğŸ¤ŸğŸ¾ Bagaimana Alice mengenali negara dari foto. Penelitian Yandex ğŸ”ƒ ğŸš’ ğŸš‡</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hai Nama saya Evgeny Kashin, dan saya bekerja di laboratorium intelijen mesin Yandex. Kami baru-baru ini meluncurkan game di mana pengguna bersaing de...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Bagaimana Alice mengenali negara dari foto. Penelitian Yandex</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yandex/blog/473056/"> Hai  Nama saya Evgeny Kashin, dan saya bekerja di laboratorium intelijen mesin Yandex.  Kami baru-baru ini meluncurkan game di mana pengguna bersaing dengan Alice di negara-negara yang menebak dari foto. <br><br>  Bagaimana orang bertindak dapat dimengerti: mereka mengenali tempat yang telah mereka lihat dalam perjalanan atau dalam film, bergantung pada pengetahuan dan akal sehat.  Jaringan saraf tidak memiliki ini.  Kami bertanya-tanya detail apa dalam gambar yang memberikan jawabannya.  Kami melakukan penelitian, yang hasilnya hari ini akan kami bagikan dengan Habr. <br><br>  Posting ini akan menarik baik untuk spesialis di bidang visi komputer, dan untuk semua orang yang ingin melihat ke dalam "kecerdasan buatan" dan memahami logika kerjanya. <br><br><img src="https://habrastorage.org/webt/yr/_o/ww/yr_oww7tnonz-ow4eos1dil0eom.png"><br><a name="habracut"></a><br>  Beberapa kata tentang permainan " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Tebak negara dengan foto</a> ."  Singkatnya, kami mengambil foto dari Yandex.Maps dan membaginya menjadi dua kelompok.  Kelompok pertama ditunjukkan oleh jaringan saraf, mengatakan di mana masing-masing tembakan diambil.  Setelah meninjau ribuan foto, jaringan saraf membuat ide masing-masing negara - yaitu, secara independen mengidentifikasi kombinasi tanda-tanda yang dapat dikenali.  Kami menggunakan kelompok gambar kedua dalam permainan, Alice tidak melihat mereka dan tidak mengingatnya selama pertandingan.  Alice bermain dengan baik, tetapi orang-orang memiliki keuntungan: kami tidak melatih jaringan saraf untuk mengenali nomor mesin, teks tanda dan tanda, bendera negara. <br><br><img src="https://habrastorage.org/webt/wl/ch/1k/wlch1kqg7uzoapthamc-pwtvatc.jpeg"><br><br>  Untuk permainan, kami melatih model untuk memprediksi negara dari satu foto.  Kami mengambil model visi komputer <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">SE-ResNeXt-101</a> , yang sudah <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">dilatih</a> sebelumnya pada banyak tugas.  Tanda-tanda yang diperoleh dari gambar menggunakan jaringan saraf convolutional ini cukup universal, jadi untuk pengelompokan negara itu perlu menambahkan hanya beberapa lapisan tambahan (yang disebut kepala).  Data Yandex.Mart digunakan untuk pelatihan: sekitar 2,5 juta foto.  Banyak gambar yang tidak sesuai dengan permainan sesuai dengan kriteria keindahan dan disaring.  Keindahan dipahami sebagai kombinasi faktor: kualitas foto, keberadaan orang, teks, hutan, laut.  Gambar yang sama dihapus dari tempat yang sama sehingga model tidak ingat pemandangan tertentu.  Setelah semua pemfilteran, sekitar 1 juta foto tetap ada.  Setelah melatih model tentang data ini, kami mendapat penggolong yang cukup akurat, yang menentukan negara hanya dengan foto, tanpa menggunakan informasi tambahan. <br><br>  Karena klasifikasi dilakukan dengan menggunakan jaringan saraf, kami tidak dapat dengan mudah memperoleh interpretasi prediksi, berbeda dengan model linier sederhana atau pohon keputusan.  Tetapi kami ingin mengetahui bagaimana jaringan saraf menentukan dari foto jalan atau rumah negara mana itu.  Dan kasus yang paling menarik adalah tanpa atraksi dalam bingkai. <br><br>  Untuk melakukan ini, kami melatih jaringan saraf dari awal, memberi makan tidak seluruh gambar, tetapi hanya potongan kecil (sehingga model tidak mengingat tempat atau objek besar tertentu). <br><br>  Dengan demikian, tugas untuk model menjadi terasa lebih sulit (coba tebak negara dengan sepotong langit), akurasi pengakuan telah sangat menurun.  Tetapi di sisi lain, jaringan saraf harus lebih memperhatikan detail kecil: pasangan bata yang tidak biasa, pola khusus, jenis atap, tanaman.  Ukuran krop yang diterapkan pada model berubah, dan diperoleh berbagai model yang memandang foto pada berbagai tingkat abstraksi: semakin kecil krop, semakin sulit tugas dan semakin penuh perhatian model pada detail. <br><br><img src="https://habrastorage.org/webt/-l/mq/og/-lmqognmqibnu46jxgyptkcojpk.jpeg"><br><br>  Algoritma untuk menafsirkan prediksi dapat diterapkan pada model yang dilatih tentang ukuran krop dengan ukuran yang berbeda.  Saya ingin menafsirkan prediksi dalam sumber foto.  Sebagian besar jaringan konvolusi modern menggunakan <a href="">Global Average Pooling</a> (GAP) sebelum lapisan terakhir - ini memungkinkan untuk melatih jaringan pada satu ukuran dan menerapkannya pada yang lain.  Ini disebabkan oleh fakta bahwa sebelum lapisan terakhir, fitur spasial, didistribusikan dalam lebar dan tinggi, dirata-rata menjadi satu nomor untuk setiap saluran (peta fitur).  Oleh karena itu, model yang dilatih saat panen (misalnya, 160 Ã— 160 piksel) dapat digunakan pada gambar asli berukuran besar (800 Ã— 800). <br><br>  Bahkan, lapisan GAP diperlukan tidak hanya untuk menggunakan model pada resolusi yang berbeda atau untuk regularisasi.  Ini juga membantu jaringan saraf untuk menyimpan informasi tentang posisi objek hingga lapisan terakhir (hanya yang kita butuhkan). <br><br>  Metode pertama yang kami coba adalah <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Pemetaan Aktivasi Kelas</a> (CAM). <br><br><img src="https://habrastorage.org/webt/5e/_j/_x/5e_j_xaziz1xmlvkerszzc2xjxm.jpeg"><br><br>  Ketika gambar diumpankan ke input jaringan saraf, maka pada lapisan kedua dari belakang, "gambar" berkurang diperoleh (pada kenyataannya, tensor aktivasi) dengan fitur yang paling penting untuk setiap kelas yang diprediksi.  Menggunakan metode CAM, Anda dapat mengubah lapisan terakhir sehingga output adalah probabilitas setiap kelas di setiap wilayah.  Sebagai contoh, jika Anda ingin memprediksi 60 kelas (negara), untuk gambar input 800 Ã— 800, gambar akhir akan terdiri dari 60 kartu aktivasi dengan ukuran 25 Ã— 25. Ini digambarkan dengan baik dalam publikasi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">asli</a> . <br><br>  Diagram di atas menunjukkan model yang biasa dengan GAP: fitur spasial dikompresi ke satu nomor untuk setiap saluran (peta fitur), setelah itu ada lapisan yang sepenuhnya terhubung yang memprediksi kelas yang menemukan bobot optimal untuk setiap saluran.  Berikut ini menunjukkan cara mengubah arsitektur untuk mendapatkan metode CAM: lapisan GAP dihapus, dan bobot lapisan yang terhubung sepenuhnya terakhir diperoleh selama pelatihan dengan GAP (di atas dalam diagram) digunakan untuk setiap saluran di setiap titik.  Untuk setiap gambar, peta aktivasi N diperoleh untuk semua kelas prediksi.  Untuk setiap negara, semakin terang area pada â€œpetaâ€, semakin besar kontribusi bagian gambar ini pada keputusan untuk memilih negara tertentu.  Yang menarik: jika setelah operasi ini kami rata-rata setiap peta aktivasi (pada dasarnya, menerapkan GAP), maka kami hanya mendapatkan prediksi awal untuk setiap kelas. <br><br><img src="https://habrastorage.org/webt/i5/21/-i/i521-iavyhhn6bxnf_xpbfwjkvy.png"><br><br>  Pada gambar Anda melihat peta aktivasi untuk kelas yang paling mungkin (menurut model).  Itu diperoleh dengan meregangkan peta aktivasi 25 Ã— 25 dengan ukuran gambar asli 800 Ã— 800. <br><br><div class="spoiler">  <b class="spoiler_title">Contoh lainnya</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/gy/7l/aq/gy7laq5f399atjwit-doxjarj_8.png"><br><img src="https://habrastorage.org/webt/s4/t1/hq/s4t1hqhmregz0f8xjgpsg6n721m.png"><br><img src="https://habrastorage.org/webt/_6/hz/h1/_6hzh1z6clmb7grbi5eesyo3_4k.png"><br><img src="https://habrastorage.org/webt/v0/zd/fd/v0zdfdpxpluft88d08hgmda2v7e.png"><br><img src="https://habrastorage.org/webt/sy/sf/on/sysfonqdv39cdp63ptmxv0w1_f4.png"><br><img src="https://habrastorage.org/webt/v-/o2/b3/v-o2b39ub3svzr504y0h57wos94.png"><br><img src="https://habrastorage.org/webt/on/09/cg/on09cgziwxi6ppgdxbtheoxehd4.png"><br><img src="https://habrastorage.org/webt/ti/8g/ki/ti8gkignbirkrsctvruho9-tl3g.png"><br></div></div><br>  Setelah menerima peta seperti itu untuk setiap gambar, kami dapat mengumpulkan hasil panen paling penting untuk negara-negara dari gambar yang berbeda.  Ini memungkinkan Anda untuk melihat koleksi tanaman, menggambarkan negara dengan cara terbaik. <br><br>  Metode kedua, dengan mana kami memutuskan untuk membandingkan yang pertama, adalah pencarian lengkap sederhana.  Bagaimana jika kita mengambil model yang dilatih pada tanaman kecil (misalnya, 160 Ã— 160 piksel) dan memprediksi masing-masing bagian pada gambar 800 Ã— 800 besar dengan itu?  Melewati jendela geser yang menutupi setiap area pada gambar, kami mendapatkan versi lain dari peta aktivasi, yang menunjukkan seberapa besar kemungkinan masing-masing bagian dari gambar termasuk dalam kelas negara yang diprediksi. <br><br><img src="https://habrastorage.org/webt/vr/d0/ig/vrd0igxkijgsltioftiqregvjhw.png"><br><br>  Gambar dipotong menjadi tanaman kecil dengan tumpang tindih 160 Ã— 160. Untuk setiap tanam, jaringan saraf membuat prediksi, jumlah di atas tanam adalah kemungkinan milik kelas yang akhirnya diprediksi oleh model. <br><br><div class="spoiler">  <b class="spoiler_title">Lebih banyak contoh</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/aj/zw/nd/ajzwndf0duu_djxkacgbx5fffbg.png"><br><img src="https://habrastorage.org/webt/_j/vk/ma/_jvkma67rsgmxjcgh_ht4t26u0e.png"><br><img src="https://habrastorage.org/webt/q5/uf/kj/q5ufkjpvlcut51tjvonfvz8oc-a.png"><br><img src="https://habrastorage.org/webt/be/al/av/bealavhehhhen23lv_gc-3nz3vi.png"><br></div></div><br>  Seperti pada metode pertama, kita dapat kembali memilih potongan yang paling mungkin untuk masing-masing negara.  Tetapi gambar yang diperoleh oleh kedua metode untuk negara tersebut dapat seragam (misalnya, bangunan dari sudut yang berbeda atau satu versi tekstur).  Oleh karena itu, hasil panen terbaik untuk negara juga dikelompokkan - maka sebagian besar gambar yang sama akan dikumpulkan dalam satu cluster.  Setelah itu, akan cukup untuk mengambil satu gambar dari masing-masing cluster dengan probabilitas maksimum - untuk setiap negara akan ada banyak gambar karena ada cluster yang ditentukan.  Kami melakukan pengelompokan berdasarkan karakteristik yang diperoleh dari lapisan classifier terakhir.  Pengelompokan aglomeratif dalam kasus kami terbukti menjadi yang terbaik. <br><br><img src="https://habrastorage.org/webt/01/bl/dt/01bldtbu2pk2tlegwiahkrfbyls.png"><br><br><div class="spoiler">  <b class="spoiler_title">Cina</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/0j/3t/e1/0j3te1fos-feivrx72damea3rdu.png"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Italia</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/tp/xa/hy/tpxahykascxpynkfngesl3mojsc.png"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Jerman</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/q4/na/3e/q4na3ea9i6t_cm2kchkvst9yass.png"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Meksiko</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/jv/zc/hg/jvzchgdvxyigsmgujk8ydmqo4v4.png"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Amerika Serikat</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/hy/t2/pb/hyt2pbota0isw955unsxnpn8wym.png"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Turki</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/47/nk/mk/47nkmkhl0didrcmsimstecwo1ye.png"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Australia</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/z3/kg/br/z3kgbr5eqy6rfxbf23f-rcwljyo.png"><br></div></div><br>  Setelah menerima jalur pipa yang cukup mirip untuk kedua metode ini, Anda dapat beralih pada parameter algoritma untuk menemukan kombinasi optimal.  Misalnya, kami memilih ukuran pemangkasan dan menetapkan dua opsi: 160 dan 256 piksel.  Tanaman yang kurang dari 160 memberi tanda terlalu kecil, yang menurutnya seseorang sering tidak mengerti apa yang digambarkan.  Dan crop lebih dari 256 terkadang mengandung beberapa objek sekaligus.  Berbagai parameter perlu dipilih pada tahap pengelompokan: pilihan algoritma utama, serta fitur yang digunakan pengelompokan.  Untuk banyak kombinasi parameter, segera jelas bahwa mereka memberikan tanaman yang "menarik" tidak cukup.  Tetapi untuk memilih algoritme terakhir, kami melakukan eksperimen berdampingan di Tolok untuk memahami opsi mana, menurut orang-orang, yang mendeskripsikan negara tertentu lebih â€œtepatâ€. <br><br>  Ternyata tidak intuitif bahwa metode yang lebih sederhana untuk menemukan krop dalam gambar (pencarian normal) menemukan objek yang lebih "menarik".  Ini mungkin disebabkan oleh fakta bahwa dalam metode kedua (enumerasi) jaringan saraf tidak melihat bagian tetangga dari gambar, dan dalam metode CAM, lingkungan titik mempengaruhi hasil.  Hasilnya, kami menerima visualisasi fitur karakteristik masing-masing negara dalam mode otomatis. <br><br>  Jadi sekarang kita tahu bagian mana dari bingkai yang sangat penting untuk jaringan saraf, dan kita bisa melihat apa yang menimpa mereka.  Misalnya, Belanda mengakui jaringan saraf dengan kombinasi dinding bata gelap dan kontur jendela putih, UEA - oleh gedung pencakar langit khusus dengan latar belakang pohon-pohon palem, dan Iran - dengan lengkungan dan ornamen khas pada fasad. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id473056/">https://habr.com/ru/post/id473056/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id473042/index.html">Pro dan Kontra Django</a></li>
<li><a href="../id473044/index.html">Cara membuat tangkapan layar yang efektif untuk aplikasi di App Store</a></li>
<li><a href="../id473046/index.html">Gelombang, angin, dan kemauan keras: bagaimana tablet Dell yang kasar membantu Rusia memenangkan regattas internasional</a></li>
<li><a href="../id473050/index.html">AMD memaksa Intel untuk mengurangi harga tidak hanya pada yang baru, tetapi juga pada model CPU yang lebih lama. Ini adalah awal dari perang harga lainnya</a></li>
<li><a href="../id473054/index.html">Final WorldSkills, pengembangan solusi-TI untuk bisnis - apa itu, bagaimana itu, dan mengapa 1C-programer menang di sana</a></li>
<li><a href="../id473058/index.html">Sergey Sinitsyn: â€œOSM lebih dari sekadar menggambar rumah atau trek. Ini lebih banyak cerita! â€</a></li>
<li><a href="../id473060/index.html">Hubungan informal dalam tim: mengapa dan bagaimana mengelolanya</a></li>
<li><a href="../id473062/index.html">User.js yang subyektif untuk Mozilla Firefox dan tidak hanya</a></li>
<li><a href="../id473064/index.html">Air mata Batavia, mobil dan Gorilla Glass: tentang beberapa jenis kaca yang diperkuat</a></li>
<li><a href="../id473070/index.html">Redux - Tidak diperlukan! Ganti dengan useContext dan useReducer in React?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>