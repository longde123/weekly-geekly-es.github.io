<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🏏 👨🏿‍💻 👌🏽 Menyiapkan server cetak CUPS dari awal dengan dan tanpa otorisasi domain di jaringan dengan sistem operasi yang berbeda 👩🏼‍🌾 🏚️ 👨🏿‍🏫</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Menyiapkan server cetak CUPS dari awal dengan dan tanpa otorisasi domain di jaringan dengan sistem operasi yang berbeda 
 Entri 


 Jadi Agaknya, laya...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Menyiapkan server cetak CUPS dari awal dengan dan tanpa otorisasi domain di jaringan dengan sistem operasi yang berbeda</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/443094/"><h2 id="nastroyka-s-nulya-printservera-cups-s-domennoy-avtorizaciey-i-bez-nee-v-seti-s-raznymi-os">  Menyiapkan server cetak CUPS dari awal dengan dan tanpa otorisasi domain di jaringan dengan sistem operasi yang berbeda </h2><br><h3 id="vstuplenie">  Entri </h3><br><p>  Jadi  Agaknya, layanan pencetakan CUPS adalah solusi kuat yang memungkinkan Anda untuk mengatur manajemen printer terpusat di perusahaan.  Begitulah, tetapi selama proses pengaturan Anda perlu meluangkan waktu mencari solusi untuk banyak masalah kecil yang tidak terlihat oleh Google, terutama jika kebutuhan Anda melampaui manual pengaturan standar. </p><br><p>  Artikel ini akan menjelaskan pemasangan server cetak CUPS di Ubuntu Server pada jaringan dengan domain Active Directory yang berfungsi, meskipun keberadaannya sepenuhnya opsional dan Anda dapat dengan aman melewati petunjuk untuk mengatur interaksi dengannya, mengaturnya, serta mengatur mesin klien Linux dan Windows untuk berinteraksi dengan server cetak ini. </p><a name="habracut"></a><br><p>  Dalam instruksi, domain akan dinamai <strong>example.com</strong> , server cetak itu sendiri akan menjadi <strong>cupsserver</strong> ( <strong>cupsserver.example.com</strong> ) dengan alamat IP 10.10.100.50, dan mesin klien <strong>linux1</strong> , <strong>linux2</strong> , <strong>linux3</strong> , dll., Untuk mesin klien Linux dan <strong>windows1</strong> , <strong>windows2</strong> , <strong>windows3</strong> dan dll.  untuk mesin klien Windows, masing-masing. </p><br><h3 id="nastroyka-printservera">  Menyiapkan server cetak </h3><br><p>  Pertama-tama, kita akan mengkonfigurasi server cetak, atau lebih tepatnya, mengkonfigurasi akses administratif di atasnya, kemudian mengkonfigurasi pencetakan di atasnya, dan kemudian menjelaskan konfigurasi mesin klien. </p><br><p>  Kami pergi ke server cetak dengan cara yang mudah dan memperbarui paket di dalamnya: </p><br><pre><code class="plaintext hljs">root@cupsserver:~# apt update &amp;&amp; apt uprgrade -y</code> </pre> <br><p>  Selanjutnya, periksa apakah CUPS diinstal di server: </p><br><pre> <code class="plaintext hljs">root@cupsserver:~# which cupsd</code> </pre> <br><p>  Jika outputnya terlihat seperti ini: </p><br><pre> <code class="plaintext hljs">/usr/bin/cupsd</code> </pre> <br><p>  kemudian CUPS diinstal, jika tidak ada output, instal CUPS: </p><br><pre> <code class="plaintext hljs">root@cupsserver:~# apt install cups -y</code> </pre> <br><p>  Sekarang konfigurasikan akses administratif ke antarmuka web CUPS.  Semua file konfigurasi terletak di jalur <em>/ etc / cups /</em> .  Untuk mulai dengan, untuk berjaga-jaga, kami akan membuat cadangan file konfigurasi CUPS utama: </p><br><pre> <code class="plaintext hljs">root@cupsserver:~# cp /etc/cups/cupsd.conf /etc/cups/cupsd.conf.original root@cupsserver:~# cp /etc/cups/cups-files.conf /etc/cups/cups-files.conf.original root@cupsserver:~# cp /etc/cups/cups-browsed.conf /etc/cups/cups-browsed.conf.original</code> </pre> <br><p>  Namun, jika Anda tidak melakukan ini - itu tidak masalah, secara default, file data sampel berada di sepanjang jalur <em>/ usr / share / cangkir</em> .  Perlu juga disebutkan bahwa Anda dapat memeriksa opsi yang ditambahkan di file konfigurasi CUPS menggunakan perintah: </p><br><pre> <code class="plaintext hljs">root@cupsserver:~# cupsd -t</code> </pre> <br><p>  Jika Anda mengacaukan sesuatu, menyegelnya, atau menggunakan opsi yang tidak lagi didukung oleh CUPS, output dari perintah akan mencerminkan kesalahan ini. </p><br><p>  Tapi akhirnya, mari kita mulai menyiapkan.  Setelah ada perubahan pada file di folder <em>/ etc / cups /</em> , Anda perlu me-restart layanan CUPS untuk mendapatkan efek: </p><br><pre> <code class="plaintext hljs">root@cupsserver:~# service cups restart  root@cupsserver:~# systemctl restart cups  root@cupsserver:~# /etc/init.d/cups restart</code> </pre> <br><p>  Dan jika Anda mengedit file <em>/etc/cups/cups-browsed.conf</em> , maka layanan terpisah yang <strong>menggunakan browser</strong> harus bertanggung jawab untuk itu, yang juga harus dimulai ulang: </p><br><pre> <code class="plaintext hljs">root@cupsserver:~# service cups-browsed restart  root@cupsserver:~# systemctl restart cups-browsed  root@cupsserver:~# /etc/init.d/cups-browsed restart</code> </pre> <br><p>  Jalankan perintah </p><br><pre> <code class="plaintext hljs">root@cupsserver:~# nano /etc/cups/cupsd.conf</code> </pre> <br><p>  Opsi tanpa komentar pertama adalah </p><br><pre> <code class="plaintext hljs">LogLevel warn</code> </pre> <br><p>  Ini menentukan konten informasi minimum log CUPS.  File log CUPS terletak di <em>/ var / log / cups /</em> .  Pada saat instalasi, konfigurasi dan debugging server cetak, akan lebih bijaksana untuk memasukkan logging ke mode debug.  Untuk melakukan ini, ubah peringatan ke debug2: </p><br><pre> <code class="plaintext hljs">LogLevel debug2</code> </pre> <br><p>  Secara default, CUPS hanya mendengarkan koneksi masuk dari <strong>localhost</strong> , yaitu pada antarmuka loopback.  Untuk memastikan ini, Anda dapat menjalankan perintah </p><br><pre> <code class="plaintext hljs">root@cupsserver:~# netstat -plutn</code> </pre> <br><p>  Salah satu baris akan terlihat seperti ini: </p><br><pre> <code class="plaintext hljs">tcp 0 0 127.0.0.1:631 0.0.0.0:* LISTEN 737/cupsd</code> </pre> <br><p>  Tindakan lebih lanjut tergantung pada tingkat paranoia Anda.  Anda dapat menambahkan di blok, yang secara kondisional dimulai dengan komentar <strong>#Hanya dengarkan koneksi dari mesin lokal,</strong> beberapa baris yang menunjukkan alamat IP atau subnet, dari mana CUPS akan diizinkan untuk mendengarkan koneksi. </p><br><pre> <code class="plaintext hljs"># Only listen for connections from the local machine. Listen localhost:631 Listen /run/cups/cups.sock #    IP  Listen 10.10.100.67:631 #     Listen 172.16.0.0:631</code> </pre> <br><p>  Atau Anda dapat mengizinkan CUPS untuk mendengarkan koneksi dari semua alamat </p><br><pre> <code class="plaintext hljs"># Only listen for connections from the local machine. Listen /run/cups/cups.sock Port 631</code> </pre> <br><p>  Titik konfigurasi berikutnya adalah penemuan jaringan dan printer bersama. </p><br><pre> <code class="plaintext hljs"># Show shared printers on the local network. Browsing Off BrowseLocalProtocols dnssd</code> </pre> <br><p>  Menurut pendapat saya, opsi ini harus tetap dimatikan, karena menentukan apakah informasi siaran akan dikirim melalui jaringan tentang printer yang terhubung ke server cetak.  Tetapi mereka semua akan terhubung dengannya.  Dan karenanya, semua mesin klien akan segera menampilkan semua printer.  Server cetak kami harus mencari dan mendeteksi semua printer di jaringan, tetapi tidak mengirimnya tanpa berpikir ke seluruh jaringan. </p><br><p>  Berikut ini adalah pengaturan otentikasi: </p><br><pre> <code class="plaintext hljs"># Default authentication type, when authentication is required... DefaultAuthType Basic</code> </pre> <br><p>  Menentukan hak akses ke antarmuka web CUPS, serta bagian administratifnya.  Agar <strong>pengguna dapat</strong> memiliki hak untuk mengelola CUPS, ia harus ditambahkan ke grup sistem <strong>lpadmin</strong> : </p><br><pre> <code class="plaintext hljs">root@cupsserver:~# usermod -a -G lpadmin user</code> </pre> <br><p>  Secara umum, grup yang diizinkan akses administratif ke CUPS ditentukan dalam file konfigurasi <em>cups-files.conf</em> di blok </p><br><pre> <code class="plaintext hljs"># Administrator user group, used to match @SYSTEM in cupsd.conf policy rules... # This cannot contain the Group value for security reasons... SystemGroup lpadmin</code> </pre> <br><p>  Jika Anda ingin menambahkan hak untuk mengelola server cetak, misalnya <strong>printadmin</strong> , ke grup pengguna Linux tertentu, tambahkan saja mereka dengan spasi ke <strong>lpadmin</strong> .  Jika grup tersebut adalah domain, maka itu sedikit lebih rumit dan akan dijelaskan nanti. </p><br><p>  Sekarang mari kita beralih ke blok <strong>&lt;Lokasi /&gt;</strong> : </p><br><pre> <code class="plaintext hljs"># Restrict access to the server... &lt;Location /&gt; Order allow,deny &lt;/Location&gt;</code> </pre> <br><p>  <strong>Orde mengizinkan, menolak</strong> berarti bahwa koneksi dari mana-mana dilarang kecuali izin secara khusus ditunjukkan.  Artinya, Anda perlu menambahkan alamat IP, subnet, host atau host dengan mask ( <em><strong>.example.com</strong> ) dalam bentuk "</em> Izinkan dari [alamat yang dibolehkan] *": </p><br><pre> <code class="plaintext hljs"># Restrict access to the server... &lt;Location /&gt; Order allow,deny Allow from cupsserver #         Allow from cupsserver.example.com #       FQDN Allow from localhost #       loopback  Allow from 10.10.100.* #    Allow from linux4.example.com #     Allow from 172.168.5.125 #  , IP   &lt;/Location&gt;</code> </pre> <br><p>  Untuk kepercayaan diri penuh dan debugging, Anda bisa pergi, sampai Anda mengkonfigurasi segalanya, desain yang memungkinkan pencetakan dari mana saja: </p><br><pre> <code class="plaintext hljs"># Restrict access to the server... &lt;Location /&gt; Order allow,deny Allow from all &lt;/Location&gt;</code> </pre> <br><p>  Mari mengatur akses administratif ke CUPS di server cetak.  Tentukan IP dan / atau subnet mana yang akan Anda hubungkan dari CUPS, dan tambahkan secara analogi dengan blok <strong>&lt;Lokasi /&gt;</strong> : </p><br><pre> <code class="plaintext hljs"># Restrict access to the admin pages... &lt;Location /admin&gt; Order allow,deny Allow from localhost Allow from 10.10.100.* Allow from admin.example.com &lt;/Location&gt; # Restrict access to configuration files... &lt;Location /admin/conf&gt; Order allow,deny Allow from localhost Allow from 10.10.100.* Allow from admin.example.com &lt;/Location&gt; # Restrict access to log files... &lt;Location /admin/log&gt; Order allow,deny Allow from localhost Allow from 10.10.100.* Allow from admin.example.com &lt;/Location&gt;</code> </pre> <br><p>  Secara opsional, Anda dapat menambahkan bahasa antarmuka default.  Daftar bahasa yang tersedia dapat dilihat menggunakan perintah: </p><br><pre> <code class="plaintext hljs">root@cupsserver:~# ls /usr/share/cups/locale</code> </pre> <br><p>  Jika lokalisasi yang Anda butuhkan, misalnya <strong>ru</strong> , adalah, tambahkan baris ke <em>/etc/cups/cupsd.conf</em> : </p><br><pre> <code class="plaintext hljs">DefaultLanguage ru</code> </pre> <br><p>  Agar server cetak Anda <strong>cupsserver.example.com</strong> diakses oleh host-nya (nama host), Anda perlu membuat file <em>client.conf</em> di folder <em>/ etc / cups /</em> dengan konten berikut: </p><br><pre> <code class="plaintext hljs">ServerName _</code> </pre> <br><p>  Cara termudah untuk melakukan ini adalah dengan melakukan ini: </p><br><pre> <code class="plaintext hljs">root@cupsserver:/etc/cups# echo "ServerName $(cat /etc/hostname)" &gt; /etc/cups/client.conf</code> </pre> <br><p>  Karena kami berasumsi bahwa ada server DNS di jaringan, akan lebih baik Anda dapat mengakses server cetak dengan nama domainnya ( <strong>cupsserver.example.com</strong> ).  Server juga dapat diberi alias CNAME di server DNS, seperti <strong>cetak</strong> atau <strong>cangkir</strong> .  Agar server cetak dapat menerima koneksi pada panggilan tersebut, Anda harus menambahkan baris berikut ke file <em>/etc/cups/cupsd.conf</em> : </p><br><pre> <code class="plaintext hljs">ServerAlias cupsserver.example.com print cups</code> </pre> <br><p>  Jika Anda ingin server cetak menerima panggilan apa pun, atau tidak ingin repot, maka Anda dapat menambahkan ini: </p><br><pre> <code class="plaintext hljs">ServerAlias *</code> </pre> <br><p>  Anda juga perlu mencari di dalam file <em>/etc/cups/cups-browsed.conf</em> .  File ini mengontrol cara server cetak mencari printer di jaringan dan menyiarkan printernya.  Saya sarankan untuk sepenuhnya menonaktifkan opsi buletin.  Server cetak akan mencari printer di jaringan, tetapi dari itu printer ke mesin klien akan terhubung secara manual.  Di bawah ini akan dijelaskan alasannya.  Sementara itu, kami menemukan baris <strong>dnssd cangkir BrowseRemoteProtocols</strong> : </p><br><pre> <code class="plaintext hljs"># Which protocols will we use to discover printers on the network? # Can use DNSSD and/or CUPS and/or LDAP, or 'none' for neither. BrowseRemoteProtocols dnssd cups</code> </pre> <br><p>  Berkat opsi ini, server cetak mencari printer bersama di jaringan.  Kami membiarkannya dihidupkan, karena kepentingan kami bahwa server cetak mencari printer di jaringan.  Tetapi kita benar-benar tidak perlu server cetak untuk mengirim semua printer yang terhubung, jika tidak akan ada banyak kebingungan.  Untuk mencegah skenario ini, temukan opsi <strong>#BrowseLocalProtocols</strong> berikut ini dan batalkan komentar: </p><br><pre> <code class="plaintext hljs"># Which protocols will we use to broadcast shared local printers to the network? # Can use DNSSD and/or CUPS, or 'none' for neither. # Only CUPS is actually supported, as DNSSD is done by CUPS itself (we ignore DNSSD in this directive). BrowseLocalProtocols none</code> </pre> <br><p>  Mengenai hal ini, kami menangguhkan konfigurasi server cetak dan melanjutkan ke konfigurasi mesin klien Windows dan Linux.  Persyaratan untuk mereka adalah seperti memungkinkan pengiriman pekerjaan cetak ke server cetak, dan mengirim pekerjaan cetak ke (dan hanya) server cetak jika perlu mencetak ke printer jaringan. </p><br><p>  Sebagai contoh, kami akan mengkonfigurasi pencetakan melalui server cetak antara dua mesin klien dengan Linux (hostname <strong>linux1</strong> ) dan Windows 8, masing-masing (hostname <strong>windows1</strong> ).  Mari kita mulai dengan mengkonfigurasi <strong>windows1</strong> sebagai penerima cetak dari server cetak.  Saya memiliki printer Canon i-SENSYS MF4410 yang terhubung dan berfungsi secara normal.  Nama printer adalah Canon-MF4400.  Cara termudah, pada kenyataannya, untuk memastikan pencetakan dari server cetak pada <strong>windows1</strong> adalah dengan pergi ke <em>Control Panel&gt; Program&gt; Program dan Fitur&gt; Mengaktifkan atau menonaktifkan Fitur Windows</em> .  Di sana kami mengaktifkan <em>Layanan Cetak dan Dokumen&gt;</em> komponen <em>Layanan Cetak LPD</em> .  Ini memungkinkan Anda untuk menghubungkan printer ini ke server cetak menggunakan alamat <em>lpd: // windows1 / Canon-MF4400</em> .  Tentu saja, pertanyaannya adalah pematangan, mengapa tidak terhubung menggunakan SMB?  Tidak ada yang melarang.  Jika Anda telah men-debug metode ini, Anda dapat membagikan printer dengan cara ini dan menghubungkannya ke server cetak menggunakan protokol SMB.  Instruksi untuk koneksi ini, menurut pendapat saya, berada di luar cakupan artikel ini, yang sudah cukup banyak.  Sementara itu, kami percaya bahwa pembaca berhasil pergi ke alamat <code>http://cupsserver:631/admin</code> mengklik tombol "Tambahkan printer baru", dan setelah intuisi, logika, dan manual yang dibaca sebelumnya, ia berhasil menghubungkan printer dengan <strong>windows1</strong> melalui protokol <strong>LPD</strong> ke <strong>server gelas [contoh. com]</strong> dan halaman printer tersedia di <code>http://cupsserver:631/printers/Canon-MF4400</code> . </p><br><p>  Sekarang kami melakukan operasi serupa pada mesin klien Linux dengan nama host <strong>linux1</strong> .  Secara umum, bagian ini akan jauh lebih besar, karena mesin klien memiliki layanan CUPS sendiri dan juga perlu dikonfigurasi dengan cara yang sama seperti server cetak, kecuali untuk peran bawahannya dalam mengatur pencetakan. </p><br><h3 id="ispravlenie-oshibki-obrascheniya-k-cups-cherez-loopback-po-imeni-hosta">  Koreksi kesalahan mengakses CUPS melalui loopback dengan nama host </h3><br><p>  Ada momen yang tidak menyenangkan.  Jika Anda memasukkan <strong>linux1</strong> ke dalam domain, konfigurasikan CUPS di atasnya sesuai dengan petunjuk ini, Anda mungkin melihat situasi yang tidak masuk akal ketika Anda dapat mengakses <strong>antarmuka</strong> WEB <strong>linux1</strong> dari luar, tetapi Anda tidak dapat melakukan ini di host itu sendiri!  Dan aplikasi grafis untuk printer konfigurasi lokal, seperti aplikasi <strong>sistem-konfigurasi-sistem sistem</strong> Linux di Linux Mint, menolak untuk bekerja.  Jika Anda mencoba terhubung ke CUPS Anda sendiri di alamat <code>http://linux1:631/</code> akan ada pesan "Forbidden" atau "Bad Request".  Ini adalah masalah yang terkenal dan tidak benar-benar terselesaikan di banyak forum Internet. </p><br><p>  Pada sebagian besar instruksi tentang memperkenalkan Linux ke dalam domain, salah satu poinnya adalah membuat file <em>/ etc / hosts</em> terlihat seperti ini: </p><br><pre> <code class="plaintext hljs">127.0.0.1 localhost 127.0.1.1 linux1.example.com linux1 # The following lines are desirable for IPv6 capable hosts ::1 ip6-localhost ip6-loopback fe02::2 ip6-localnet ff00::0 ip6-mcastprefix ff02::1 ip6-allnodes ff02::2 ip6-allrouters</code> </pre> <br><p>  Untuk beberapa alasan, CUPS tidak dapat mengaitkan panggilan melalui 127.0.1.1, yaitu, melalui antarmuka Loopback, dengan nama host. </p><br><p>  Kesalahan ini diperbaiki dengan dua cara.  Jika alamat IP jaringan Anda statis, maka di file <em>/ etc / hosts,</em> perbaiki 127.0.1.1 untuk alamat IP dari antarmuka jaringan eksternal mesin klien, misalnya: </p><br><pre> <code class="plaintext hljs">127.0.0.1 localhost 192.168.1.50 linux1.example.com linux1</code> </pre> <br><p>  Atau, sejak Anda memasukkan Linux ke dalam domain, diasumsikan bahwa DHCP dan server DNS Direktori Aktif berjalan di jaringan Anda.  Dalam hal ini, cukup komentari baris ini: </p><br><pre> <code class="plaintext hljs">127.0.0.1 localhost # 127.0.1.1 linux1.example.com linux1</code> </pre> <br><p>  Perbedaan kinerja atau masalah dari tindakan ini belum terdeteksi. </p><br><h3 id="nastroyka-adresov-proslushivaniya-podklyucheniy-k-cups-u-klientskih-mashin-linux">  Menyetel Alamat Pendengaran Koneksi CUPS di Mesin Klien Linux </h3><br><p>  Kami pergi ke <strong>linux1</strong> dengan cara apa pun yang nyaman.  Mengedit file <em>/etc/cups/cupsd.conf</em> : </p><br><pre> <code class="plaintext hljs">user@linux1:~$ sudo nano /etc/cups/cupsd.conf</code> </pre> <br><p>  Kami menemukan, menambah atau memodifikasi baris di dalamnya: </p><br><pre> <code class="plaintext hljs">DefaultLanguage ru #      /usr/share/cups/locale ServerAlias linux1.example.com linux1 [CNAME    DNS ]  ServerAlias * #      Listen /run/cups/cups.sock Listen localhost:631 #  localhost Listen 10.10.100.50:631 # IP   . Listen cupsserver:631 #   .    IP  ,    Listen linux1:631 #  Port 631 #       Listen /run/cups/cups.sock Browsing off # .       DefaultAuthType Basic #  .     Kerberos,     </code> </pre> <br><h3 id="nastroyka-adresov-proslushivaniya-podklyucheniy-k-cups">  Mengatur CUPS Connection Listinges Addresses </h3><br><p>  Di blok sebelumnya, kami mengonfigurasi kemampuan untuk terhubung ke CUPS.  Sekarang mari kita beralih ke pengaturan izin untuk mencetak, serta ke halaman administrasi layanan CUPS pada host <strong>linux1</strong> .  Kami membuka kembali, jika ditutup, file <em>/etc/cups/cupsd.conf</em> dan melanjutkan untuk mengedit <strong>&lt;Lokasi /&gt;</strong> , <strong>&lt;Lokasi / admin&gt;</strong> , <strong>&lt;Lokasi / admin / conf&gt;</strong> , <strong>&lt;Lokasi / admin / log&gt;</strong> blok: </p><br><pre> <code class="plaintext hljs"># Restrict access to the server... &lt;Location /&gt; Order allow,deny #    "  ,  " Allow from localhost #    linux1 Allow from linux1 #     .      Allow from cupsserver #  CUPS    DNS,  . ,     Allow from cupsserver.example.com # FQDN  Allow from 10.10.100.50 #     IP  **cupsserver** &lt;/Location&gt; # Restrict access to the admin pages... &lt;Location /admin&gt; Order allow,deny #   Allow from localhost #      Allow from linux1 #   Allow from 10.10.101.71 # ,  IP  Allow from 10.20.50.* # ,    IT  AuthType Default #   CUPS    .   Require user @SYSTEM #     CUPS &lt;/Location&gt; # Restrict access to configuration files... &lt;Location /admin/conf&gt; #   Order allow,deny #   Allow from localhost #      Allow from linux1 #   Allow from 10.10.101.71 # ,  IP  Allow from 10.20.50.* # ,    IT  AuthType Default #   CUPS    .   Require user @SYSTEM #     CUPS &lt;/Location&gt; # Restrict access to log files... &lt;Location /admin/log&gt; #   Order allow,deny #   Allow from localhost #      Allow from linux1 #   Allow from 10.10.101.71 # ,  IP  Allow from 10.20.50.* # ,    IT  AuthType Default #   CUPS    .   Require user @SYSTEM #     CUPS &lt;/Location&gt;</code> </pre> <br><h3 id="nastroyka-razdachi-i-polucheniya-shirokoveschatelnoy-rassylki-setevyh-printerov">  Mengkonfigurasi distribusi dan penyiaran printer jaringan </h3><br><p>  Bahkan pada mesin klien Linux, dalam hal ini <strong><em>linux1</em></strong> , Anda perlu mengedit file <em>/etc/cups/cups-browsed.conf</em> : </p><br><pre> <code class="plaintext hljs">user@linux1:~$ sudo nano /etc/cups/cups-browsed.conf BrowseRemoteProtocols none #  none      . BrowseLocalProtocols cups #     . DNSSD   ,    cupsd.conf BrowseOrder Allow,Deny #   Order  cupsd.conf -   ,        BrowseAllow 10.10.100.50 # IP  BrowseAllow cupsserver #    BrowseAllow cupsserver.example.com #    </code> </pre> <br><h3 id="nastroyka-administrativnogo-dostupa">  Konfigurasikan Akses Administratif </h3><br><p>  Beberapa kata tentang akses administratif, baik pada antarmuka WEB CUPS pada server cetak dan pada mesin klien Linux apa pun.  Bahkan jika Anda memiliki 30-50 komputer, Anda perlu menyatukan otorisasi pada CUPS, dan tidak mengingatnya atau di mana pun kata sandi setiap mesin.  Dan ini penting pada semua mesin Linux, karena untuk menambahkan printer ke server, Anda harus menginstalnya terlebih dahulu secara lokal.  Saya melihat beberapa cara. </p><br><p>  Yang pertama adalah membuat pengguna <strong>printeradmin</strong> pada setiap sistem Linux (misalnya) dan menambahkan <strong>lpadmin</strong> ke grup: </p><br><pre> <code class="plaintext hljs">user@linux1:~$ sudo usermod -a -G lpamin printeradmin</code> </pre> <br><p>  dan masuk ke <code>http://_:631/admin</code> menggunakan kredensinya. </p><br><p>  Opsi kedua hampir identik dan menyarankan untuk membuat grup dalam sistem, misalnya ,admin <strong>printer</strong> , menambahkan administrator CUPS yang diperlukan ( <strong>printeradmin</strong> , <strong>pengguna</strong> ) di sana: </p><br><pre> <code class="plaintext hljs">user@linux1:~$ sudo groupadd printersadmins user@linux1:~$ sudo usermod -a -G printersadmins printeradmin user@linux1:~$ sudo usermod -a -G printersadmins user</code> </pre> <br><p>  Maka Anda perlu menemukan baris di file <em>/etc/cups/cups-files.conf</em> </p><br><pre> <code class="plaintext hljs"># Administrator user group, used to match @SYSTEM in cupsd.conf policy rules... # This cannot contain the Group value for security reasons... SystemGroup lpadmin</code> </pre> <br><p>  dan tambahkan satu atau lebih grup pengguna dengan hak untuk mengelola CUPS melalui spasi. </p><br><pre> <code class="plaintext hljs"># Administrator user group, used to match @SYSTEM in cupsd.conf policy rules... # This cannot contain the Group value for security reasons... SystemGroup lpadmin printersadmins somegroup</code> </pre> <br><p>  Dan akhirnya, opsi ketiga.  Jadikan administrator server cetak dan CUPS mesin klien sebagai grup pengguna domain.  Untuk melakukan ini, server cetak dan mesin klien Linux harus bergabung ke domain AD.  Ada beberapa metode untuk menghubungkan Linux ke domain Windows, tetapi sejauh yang saya tahu, yang utama menghubungkan menggunakan winbind dan menggunakan SSSD (realmd).  Deskripsi metode ini tidak termasuk dalam artikel, jadi saya akan fokus hanya pada poin yang berhubungan khusus dengan CUPS. </p><br><h3 id="nastroyka-ispolzovaniya-domennyh-grupp-polzovateley-dlya-administrirovaniya-cups">  Mengkonfigurasi Penggunaan Grup Pengguna Domain untuk Administrasi CUPS </h3><br><p>  Setiap metode bergabung dengan sistem otorisasi pusat di Linux membuat file "pipa" khusus di mana aplikasi dapat melihat daftar pengguna domain.  Agar CUPS dapat melakukan ini, Anda harus mengizinkannya menggunakan pipa di AppArmor untuk mengautentikasi pengguna.  AppArmor adalah modul kontrol akses keamanan Linux.  Batasi program tertentu hingga kumpulan file yang tercantum dalam kebijakannya.  Untuk menambahkan CUPS hak untuk menggunakan pengguna dan grup domain melalui winbindd, tambahkan baris berikut ke file <em>/etc/apparmod.d/local/usr.sbin.cupsd</em> : </p><br><pre> <code class="plaintext hljs">/var/lib/samba/winbindd_privileged/pipe rw</code> </pre> <br><p>  Jika Linux dimasukkan ke domain melalui SSSD, maka Anda harus menentukan lokasi pipanya di <em>/etc/apparmod.d/local/usr.sbin.cupsd</em> , menambahkan baris di sana: </p><br><pre> <code class="plaintext hljs">/var/lib/sss/pipes/private/pam rw</code> </pre> <br><p>  Selain itu, dalam kasus SSSD, ini memungkinkan otentikasi (untuk mencari tahu siapa yang masuk), tetapi untuk mengotentikasi (mengetahui apakah pengguna memiliki hak untuk mengelola CUPS), Anda juga harus menambahkan baris ke file konfigurasi <em>SSSD /etc/sssd/sssd.conf</em> : </p><br><pre> <code class="plaintext hljs">ad_gpo_map_interactive = +cups</code> </pre> <br><p>  Ini, secara kondisional, memberi CUPS hak untuk "melihat" ke SSSD. </p><br><p>  Selain itu, karena fakta bahwa CUPS sekarang tergantung pada layanan SSSD, Anda harus memberi tahu CUPS bahwa itu harus dimulai setelah SSSD, jika tidak, CUPS akan jatuh ketika dinyalakan dan perlu dinyalakan secara manual setiap kali. </p><br><p>  Tambahkan instruksi CUPS untuk boot setelah SSSD.  Edit <em>file</em> layanan <em>cups.service di</em> sepanjang jalur <em>/ lib / systemd / system /</em> , tambahkan pernyataan <strong>Setelah</strong> ke bagian <strong>[Unit]</strong> : </p><br><pre> <code class="plaintext hljs">[Unit] Description=CUPS Scheduler Documentation=man:cupsd(8) After=sssd.service</code> </pre> <br><p>  Dengan demikian, CUPS dikonfigurasi untuk otorisasi Dasar melalui domain, yaitu otorisasi dengan memasukkan login dan kata sandi pengguna domain dengan hak istimewa administrasi CUPS. </p><br><p>  Otorisasi dapat dikonfigurasi secara berbeda, tetapi prinsipnya (file pipa) secara umum bersifat universal dan ada peluang untuk mengonfigurasinya untuk LDAP, FreeIPA, dan layanan direktori lainnya dengan analogi. </p><br><h3 id="ustanovka-printera-v-linux">  Menginstal printer di Linux </h3><br><p>  Menginstal printer di Linux seringkali merupakan tugas khusus, berbeda untuk berbagai merek dan bahkan model.  Oleh karena itu, saya tidak melihat alasan untuk menjelaskan pemasangan printer dan menganggap bahwa host <strong>linux1 memiliki</strong> printer Kyocera-1024FP dengan nama <strong>Kyocera-1024FP yang diinstal</strong> , dan halaman printer tersedia di <code>http://linux1:631/printers/Kyocera-1024FP</code> . </p><br><p>  Sekarang setelah server Linux dan mesin klien dikonfigurasikan, printer terpasang pada beberapa dari mereka, dan ada juga mesin Windows yang dapat digunakan untuk mencetak, dan seluruh sistem ini harus stabil bahkan jika perlu untuk mengganti printer pada salah satu PC. , maka ini seharusnya tidak memerlukan konfigurasi ulang sebagian yang baik dari semua PC, jika tidak semua.  Selain itu, Anda perlu sesedikit mungkin masalah dengan driver.  Dan itu sangat mungkin. </p><br><h3 id="gruppy-printerov-classes">  Grup Printer (Kelas) </h3><br><p>     <strong>Canon-MF4400</strong> c  <strong>windows1</strong>   LPD.            <code>http://cupsserver:631/printers/Canon-MF4400</code> .          <strong>cupsserver</strong> <code>http://cupsserver:631/admin</code> .      " " [Add Class].   .      "", "", "",       .            .  <strong>Canon-MF4400</strong>    ,    "" ,  <strong>printer-windows1</strong> , ""  ""   ,   " ". </p><br><p>      <strong>printer-windows1</strong>   <strong>Canon-MF4400</strong>  .           <strong>Canon-MF4400</strong>       — <code>http://cupsserver:631/classes/printer-windows1</code> . </p><br><p>         <strong>linux1</strong>  Kyocera-1024FP.      HTTP.    "   (http)" [Internet Printing Protocol (http)],      "Generic",  "IPP Everywhere".    ,        <strong>linux1</strong> — <strong>Kyocera-1024FP</strong> .        <code>http://cupsserver:631/printers/Kyocera-1024FP</code> .    <strong>printer-windows1</strong>   <strong>printer-linux1</strong> c  <strong>Kyocera-1024FP</strong>  .    <code>http://cupsserver:631/classes/printer-linux1</code> . </p><br><p>    <strong>Kyocera-1024FP</strong>   <strong>linux1</strong>   <strong>cupsserver</strong>   <strong>windows1</strong>   Windows 8      (!)  .        "    ".  <strong></strong>    <code>http://_c:631/classes/_</code> .     — <code>http://cupsserver:631/classes/printer-linux1</code> .        "Generic",  — "MS Publisher Imagesetter".   ,        <code>printer-linux1  http://cupsserver:631</code> .             ,          Kyocera-1024FP. </p><br><p>    <strong>Canon-MF4400</strong>   <strong>windows1</strong>   <strong>cupsserver</strong>   <strong>linux1</strong>   Linux      (!)  .         ,   <strong>Kyocera-1024FP</strong>   <strong>cupsserver</strong> .       <strong>linux1</strong>    "   (http)",     ( <strong>Canon-MF4400</strong> )       — <code>http://cupsserver:631/classes/printer-windows1</code> .        "Generic",  — "IPP Everywhere".    ,       — <strong>printer-windows1</strong> .     <strong>linux1</strong>   <code>http://linux1:631/printers/printer-windows1</code> ,        . </p><br><p>      ,        ,   ,     ,       ,         .      —     ,   ,     ,  ,       .        ,          .  "IPP Everywhere"  "MS Publisher Imagesetter"     ,   ..,          . </p><br><h3 id="zaklyuchenie">  Kesimpulan </h3><br><p>   ,   - ,       .  ,   ,    ,      ,           . </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id443094/">https://habr.com/ru/post/id443094/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id443082/index.html">Mengapa Anda tidak melihat orang lain saat mempelajari satu bahasa</a></li>
<li><a href="../id443084/index.html">Facebook menolak untuk mentransfer server ke negara-negara dengan pelanggaran kebebasan berbicara dan memperkenalkan enkripsi ujung-ke-ujung</a></li>
<li><a href="../id443086/index.html">Intisari Desain Makanan, Februari 2019</a></li>
<li><a href="../id443090/index.html">Wisata ke PLTN Rostov</a></li>
<li><a href="../id443092/index.html">Sensor ultrasonik baru memungkinkan Anda untuk "mendengarkan" bakteri - cara kerjanya</a></li>
<li><a href="../id443096/index.html">Perancang bukan jurnalis. Cara melakukan wawancara dengan pengguna</a></li>
<li><a href="../id443098/index.html">Data ditulis ke disk menggunakan magnet dan laser</a></li>
<li><a href="../id443100/index.html">Menghitung bug di kalkulator Windows</a></li>
<li><a href="../id443102/index.html">Perubahan perilaku sebagai produk: mengapa Marie Kondo mengumpulkan $ 40 juta dengan Sequoia Capital?</a></li>
<li><a href="../id443104/index.html">Hitung ekspresi simbolik dengan angka segitiga fuzzy dalam python</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>