<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üïµüèø üòö üßùüèº Como a portabilidade de um jogo para o PSVita melhorou o desempenho geral ‚ö±Ô∏è üèÇüèø üì∂</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="No n√≠vel pode haver milhares de inimigos. 

 A miss√£o do defensor: Valley of the Forgotten DX sempre teve problemas de longa data com velocidade, e fi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Como a portabilidade de um jogo para o PSVita melhorou o desempenho geral</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/414135/"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/937/148/2a1/9371482a13b17c628afe9e994e6df76f.jpg" alt="imagem"></div><br>  <i>No n√≠vel pode haver milhares de inimigos.</i> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">A miss√£o do defensor: Valley of the Forgotten DX</a> sempre teve problemas de longa data com velocidade, e finalmente consegui resolv√™-los.  O principal incentivo para um aumento maci√ßo de velocidade foi o nosso <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">porto no PlayStation Vita</a> .  O jogo j√° foi lan√ßado no PC e funcionou bem, se n√£o perfeitamente, no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Xbox One</a> com o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">PS4</a> .  Mas sem uma grande melhoria no jogo, nunca poder√≠amos lan√ß√°-lo no Vita. <br><br>  Quando um jogo fica mais lento, os comentaristas da Internet geralmente culpam uma linguagem ou mecanismo de programa√ß√£o.  √â verdade que linguagens como C # e Java s√£o mais caras que C e C ++, e ferramentas como Unity t√™m problemas insol√∫veis, como coleta de lixo.  De fato, as pessoas apresentam essas explica√ß√µes porque a linguagem e o mecanismo s√£o as propriedades mais √≥bvias do software.  Mas os verdadeiros assassinos do desempenho podem ser pequenos detalhes est√∫pidos que n√£o t√™m nada a ver com arquitetura. <br><a name="habracut"></a><br><h1>  0. Ferramentas de cria√ß√£o de perfil </h1><br>  Existe apenas uma maneira real de tornar o jogo mais r√°pido - realizar perfis.  Descubra em que o computador gasta muito tempo e fa√ßa com que gaste menos tempo ou, melhor ainda, n√£o perca tempo. <br><br>  A ferramenta de cria√ß√£o de perfil mais simples √© o monitor do sistema Windows padr√£o (monitor de desempenho): <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ea3/b29/a69/ea3b29a690d6fe0ce9c6014abb6a9a62.png"></div><br>  De fato, essa √© uma ferramenta bastante flex√≠vel e √© muito f√°cil trabalhar com ela.  Basta pressionar Ctrl + Alt + Delete, abra o "Gerenciador de tarefas" e clique na guia "Desempenho".  No entanto, n√£o execute muitos outros programas.  Se voc√™ observar atentamente, poder√° detectar facilmente picos no uso da CPU e at√© mesmo vazamentos de mem√≥ria.  Essa √© uma maneira pouco informativa, mas pode ser o primeiro passo para encontrar locais lentos. <br><br>  O Defender's Quest est√° escrito na linguagem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Haxe de</a> alto n√≠vel, compilada em outros idiomas (meu principal objetivo era C ++).  Isso significa que qualquer ferramenta capaz de criar um perfil do C ++ tamb√©m pode criar um perfil do meu c√≥digo C ++ gerado pelo Haxe.  Ent√£o, quando eu queria entender as causas dos problemas, iniciei o Performance Explorer no Visual Studio: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/999/a24/932/999a24932b41cd329e28bcb6c5076725.png"></div><br>  Al√©m disso, diferentes consoles t√™m suas pr√≥prias ferramentas de cria√ß√£o de perfil, o que √© muito conveniente, mas por causa do NDA, n√£o posso dizer nada sobre eles.  Mas se voc√™ tiver acesso a eles, n√£o deixe de us√°-los! <br><br>  Em vez de escrever um tutorial terr√≠vel sobre como usar ferramentas de cria√ß√£o de perfil como o Performance Explorer, deixo um link para a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">documenta√ß√£o oficial</a> e passo para o t√≥pico principal - coisas incr√≠veis que levaram a um enorme aumento de produtividade e como consegui encontr√°-las ! <br><br><h1>  1. Detec√ß√£o de Problemas </h1><br>  O desempenho do jogo n√£o √© apenas a velocidade em si, mas tamb√©m a sua percep√ß√£o.  O Defender's Quest √© um jogo de g√™nero de defesa de torre que √© renderizado a 60 FPS, mas com velocidade de jogo vari√°vel na faixa de 1 / 4x a 16x.  Independentemente da velocidade do jogo, a simula√ß√£o usa um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">carimbo de data / hora fixo</a> com 60 atualiza√ß√µes por segundo do tempo de simula√ß√£o 1x.  Ou seja, se voc√™ executar o jogo a uma velocidade de 16x, a l√≥gica de atualiza√ß√£o funcionar√° na verdade com uma frequ√™ncia de <em>960 FPS</em> .  Honestamente, esses s√£o pedidos muito altos para o jogo!  Mas fui eu quem criou esse modo e, se for lento, os jogadores definitivamente o perceber√£o. <br><br>  E no jogo existe <em>esse</em> n√≠vel: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ed9/5e1/694/ed95e16941a18fe9a71b7333d537f1d9.png"></div><br>  Esta √© a batalha final de b√¥nus "Endless 2", tamb√©m √© "meu pesadelo pessoal".  A captura de tela foi feita no modo Novo Jogo +, no qual os inimigos n√£o s√£o apenas muito mais fortes, mas tamb√©m t√™m recursos como restaurar a sa√∫de.  A estrat√©gia favorita do jogador aqui √© bombear os drag√µes para o n√≠vel m√°ximo de Rugido (ataque AOE que atordoa os inimigos), e por tr√°s deles, v√°rios cavaleiros com Knockback bombeado ao m√°ximo para empurrar todos os que passam os drag√µes de volta √† sua √°rea de a√ß√£o.  O efeito cumulativo √© que um enorme grupo de monstros fica interminavelmente em um s√≥ lugar, muito mais do que os jogadores teriam que sobreviver se eles realmente os matassem.  Como os jogadores precisam <em>esperar pelas</em> ondas e n√£o <em>mat√°-</em> las para receber recompensas e conquistas, essa estrat√©gia √© absolutamente eficaz e brilhante - esse √© exatamente o comportamento dos jogadores que eu estimulei. <br><br>  Infelizmente, isso tamb√©m acaba sendo um caso <em>patol√≥gico</em> para o desempenho, <em>especialmente</em> quando os jogadores querem jogar em velocidades de 16x ou 8x.  √â claro que apenas os jogadores mais hardcore tentar√£o obter a conquista ‚ÄúHundredth Wave‚Äù no New Game + no n√≠vel Endless 2, mas eles s√£o apenas aqueles que falam o jogo mais alto, ent√£o eu queria que eles fossem felizes. <br><br>  √â apenas um jogo 2D com um monte de sprites, o que poderia estar errado com ele? <br><br>  E de fato.  Vamos acertar. <br><br><h1>  2. Resolu√ß√£o de colis√£o </h1><br>  D√™ uma olhada nesta captura de tela: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/098/bd2/116/098bd2116180a0b3ea3c9a66339b7fa3.png"></div><br>  V√™ este bagel ao redor do guarda florestal?  Essa √© a sua √°rea de impacto - observe que tamb√©m h√° uma zona morta na qual ela <em>n√£o pode</em> atingir alvos.  Cada classe tem sua pr√≥pria √°rea de ataque e cada defensor tem uma √°rea de tamanho diferente, dependendo do n√≠vel de refor√ßo e dos par√¢metros pessoais.  E todo defensor em teoria pode apontar para qualquer inimigo no campo de seu alcance.  O mesmo vale para certos tipos de inimigos.  Pode haver at√© 36 defensores no mapa (n√£o incluindo o personagem principal Azru), mas n√£o h√° limite superior no n√∫mero de inimigos.  Cada defensor e inimigo tem uma lista de alvos poss√≠veis, criados com base em chamadas para verificar a √°rea a cada etapa da atualiza√ß√£o (menos o corte l√≥gico daqueles que n√£o podem atacar no momento, e assim por diante). <br><br>  Hoje, os processadores de v√≠deo s√£o muito r√°pidos - se voc√™ n√£o os exercitar demais, eles podem processar quase qualquer n√∫mero de pol√≠gonos.  Mas mesmo as CPUs mais r√°pidas com facilidade t√™m ‚Äúgargalos‚Äù em procedimentos simples, especialmente aqueles que crescem exponencialmente.  √â por isso que um jogo em 2D pode se tornar mais lento que um jogo em 3D muito mais bonito - n√£o porque o programador n√£o possa lidar (talvez isso tamb√©m seja, pelo menos no meu caso), mas em princ√≠pio porque a l√≥gica √†s vezes pode ser mais cara, do que desenhar!  A quest√£o n√£o √© quantos objetos est√£o na tela, mas o que eles <em>fazem</em> . <br><br>  Vamos explorar e acelerar o reconhecimento de colis√µes.  Para compara√ß√£o, direi que, antes da otimiza√ß√£o, o reconhecimento de colis√£o levou at√© 50% do tempo da CPU no principal ciclo de batalha.  Ap√≥s a otimiza√ß√£o, menos de 5%. <br><br><h2>  √â tudo sobre √°rvores quadrante </h2><br>  A principal solu√ß√£o para o problema do reconhecimento lento de colis√µes √© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">dividir o espa√ßo</a> - e desde o in√≠cio usamos uma implementa√ß√£o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">de</a> alta qualidade <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">da √°rvore do quadrante</a> .  Essencialmente, ele efetivamente separa o espa√ßo para que muitas verifica√ß√µes opcionais de colis√£o possam ser ignoradas. <br><br>  Em cada quadro, atualizamos a √°rvore inteira dos quadrantes (QuadTree) para rastrear a posi√ß√£o de cada objeto e, quando o inimigo ou o defensor deseja mirar em algu√©m, ele pede ao QuadTree uma lista de objetos pr√≥ximos.  Mas o criador de perfil nos disse que essas duas opera√ß√µes s√£o muito mais lentas do que deveriam ser. <br><br>  O que h√° de errado aqui? <br><br>  Como se viu - muito. <br><br><h2>  Digita√ß√£o de string </h2><br>  Como mantive inimigos e defensores em uma √°rvore do quadrante, tive que indicar o que estava procurando, e isso foi feito assim: <br><br> <code>var things:Array&lt;XY&gt; = _qtree.queryRange(zone.bounds, "e"); //"e" -   "enemy"</code> <br> <br>  No jarg√£o dos programadores, isso √© chamado de c√≥digo de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">digita√ß√£o de string</a> e, entre outros motivos, √© ruim porque as compara√ß√µes de string s√£o sempre mais lentas que as compara√ß√µes inteiras. <br><br>  Eu rapidamente peguei constantes inteiras e substitu√≠ o c√≥digo por este: <br><br> <code>var things:Array&lt;XY&gt; = _qtree.queryRange(zone.bounds, QuadTree.ENEMY);</code> <br> <br>  (Sim, provavelmente valeu a pena usar o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Enum Abstract</a> para seguran√ßa m√°xima do tipo, mas eu estava com pressa e precisava fazer o trabalho primeiro.) <br><br>  Somente essa mudan√ßa deu uma <em>enorme</em> contribui√ß√£o, porque essa fun√ß√£o √© chamada de forma <em>constante</em> e recursiva, toda vez que algu√©m precisa de uma nova lista de objetivos. <br><br><h2>  Vetor vs matriz </h2><br>  D√™ uma olhada nisso: <br><br> <code>var things:Array&lt;XY&gt;</code> <br> <br>  As matrizes Haxe s√£o muito semelhantes √†s matrizes ActionScript e JS, pois s√£o cole√ß√µes de objetos redimension√°veis, mas no Haxe elas s√£o fortemente tipadas. <br><br>  No entanto, h√° outra estrutura de dados que √© mais eficiente com linguagens de destino est√°ticas, como o cpp, a saber <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">haxe.ds.Vector</a> .  Os vetores Haxe s√£o essencialmente os mesmos que os arrays, exceto que, quando criados, obt√™m um tamanho fixo. <br><br>  Como minhas √°rvores do quadrante j√° tinham um volume fixo, substitu√≠ as matrizes por vetores para obter um aumento not√°vel da velocidade. <br><br><h2>  Solicite apenas o que voc√™ precisa </h2><br>  Anteriormente, minha fun√ß√£o <code>queryRange</code> retornava uma lista de objetos, inst√¢ncias <code>XY</code> .  Eles continham as coordenadas x / y do objeto de jogo referenciado e seu identificador inteiro exclusivo (√≠ndice de pesquisa na matriz principal).  O objeto do jogo que executava a solicita√ß√£o recebeu esses XYs, extraiu um identificador inteiro para obter seu destino e depois esqueceu o resto. <br><br>  Ent√£o, por que devo passar todas essas refer√™ncias aos objetos XY para cada n√≥ QuadTree <em>recursivamente</em> e at√© <em>960 vezes por quadro?</em>  √â o suficiente para eu retornar uma lista de identificadores inteiros. <br><br>  <strong><em>DICA PROFISSIONAL: n√∫meros inteiros s√£o muito mais r√°pidos para transmitir do que quase todos os outros tipos de dados!</em></strong> <br><br>  Comparado a outras corre√ß√µes, isso era bastante simples, mas o crescimento do desempenho ainda era percept√≠vel, porque esse loop interno era usado de maneira muito ativa. <br><br><h2>  Otimiza√ß√£o da recurs√£o da cauda </h2><br>  H√° uma coisa elegante <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">chamada otimiza√ß√£o de</a> chamada de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">cauda</a> .  √â dif√≠cil de explicar, ent√£o √© melhor mostrar um exemplo. <br><br>  Foi: <br><br> <code>nw.queryRange(Range, -1, result); <br> ne.queryRange(Range, -1, result); <br> sw.queryRange(Range, -1, result); <br> se.queryRange(Range, -1, result); <br> return result;</code> <br> <br>  Tornou-se: <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">return</span></span> se.queryRange(Range, <span class="hljs-keyword"><span class="hljs-keyword">filter</span></span>, sw.queryRange(Range, <span class="hljs-keyword"><span class="hljs-keyword">filter</span></span>, ne.queryRange(Range, <span class="hljs-keyword"><span class="hljs-keyword">filter</span></span>, nw.queryRange(Range, <span class="hljs-keyword"><span class="hljs-keyword">filter</span></span>, result))));</code> </pre> <br>  O c√≥digo retorna os mesmos resultados l√≥gicos, mas, de acordo com o criador de perfil, a segunda op√ß√£o √© mais r√°pida, pelo menos ao traduzir para cpp.  Os dois exemplos executam exatamente a mesma l√≥gica - eles fazem altera√ß√µes na estrutura de dados "resultado" e a passam para a pr√≥xima fun√ß√£o antes de retornar.  Quando fazemos isso recursivamente, podemos evitar que o compilador gere refer√™ncias tempor√°rias, porque ele pode simplesmente retornar o resultado da fun√ß√£o anterior imediatamente, em vez de cumpri-lo em uma etapa extra.  Ou algo assim.  Eu n√£o entendo completamente como isso funciona, ent√£o leia o post no link acima. <br><br>  (A julgar pelo que sei, a vers√£o atual do compilador Haxe n√£o possui uma fun√ß√£o de otimiza√ß√£o de recurs√£o de cauda, ‚Äã‚Äãou seja, provavelmente √© o trabalho do compilador C ++ - portanto, n√£o se surpreenda se esse truque n√£o funcionar ao traduzir o c√≥digo Haxe que n√£o est√° no cpp.) <br><br><h2>  Pool de Objetos </h2><br>  Se eu precisar de resultados precisos, devo destruir e reconstruir o QuadTree novamente a cada chamada de atualiza√ß√£o.  Criar novas inst√¢ncias do QuadTree √© uma tarefa bastante comum, mas com um grande n√∫mero de novos objetos AABB e XY, os QuadTrees que dependem deles levaram a uma sobrecarga grave de mem√≥ria.  Como esses objetos s√£o muito simples, seria l√≥gico alocar muitos desses objetos com anteced√™ncia e apenas reutiliz√°-los constantemente.  Isso √© chamado de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">pool de objetos</a> . <br><br>  Eu costumava fazer algo assim: <br><br> <code>nw = new QuadTree( new AABB( cx - hs2x, cy - hs2y, hs2x, hs2y) ); <br> ne = new QuadTree( new AABB( cx + hs2x, cy - hs2y, hs2x, hs2y) ); <br> sw = new QuadTree( new AABB( cx - hs2x, cy + hs2y, hs2x, hs2y) ); <br> se = new QuadTree( new AABB( cx + hs2x, cy + hs2y, hs2x, hs2y) );</code> <br> <br>  Mas ent√£o substitu√≠ o c√≥digo por este: <br><br> <code>nw = new QuadTree( AABB.get( cx - hs2x, cy - hs2y, hs2x, hs2y) ); <br> ne = new QuadTree( AABB.get( cx + hs2x, cy - hs2y, hs2x, hs2y) ); <br> sw = new QuadTree( AABB.get( cx - hs2x, cy + hs2y, hs2x, hs2y) ); <br> se = new QuadTree( AABB.get( cx + hs2x, cy + hs2y, hs2x, hs2y) );</code> <br> <br>  Utilizamos a estrutura <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">HaxeFlixel de</a> c√≥digo-fonte aberto, ent√£o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">implementamos</a> isso usando a classe <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">FlxPool</a> HaxeFlixel.  No caso de otimiza√ß√µes altamente especializadas, geralmente substituo alguns elementos b√°sicos do Flixel (por exemplo, reconhecimento de colis√£o) por minha pr√≥pria implementa√ß√£o (como fiz com o QuadTrees), mas o FlxPool √© melhor do que tudo o que escrevi e faz exatamente o que precisa. <br><br><h2>  Especializa√ß√£o se necess√°rio </h2><br>  Um objeto <code>XY</code> √© uma classe simples que possui as propriedades <code>x</code> , <code>y</code> <code>int_id</code> .  Como foi usado em um loop interno particularmente usado ativamente, pude salvar muitos comandos e opera√ß√µes de aloca√ß√£o de mem√≥ria movendo todos esses dados para uma estrutura de dados especial que fornece a mesma funcionalidade do <code>Vector&lt;XY&gt;</code> .  Chamei essa nova classe de <code>XYVector</code> e o resultado pode ser visto <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> .  Este √© um aplicativo altamente especializado e n√£o √© flex√≠vel ao mesmo tempo, mas nos forneceu algumas melhorias de velocidade. <br><br><h2>  Fun√ß√µes incorporadas </h2><br>  Agora, depois de concluirmos a ampla fase do reconhecimento de colis√£o, precisamos fazer muitas verifica√ß√µes para descobrir quais objetos realmente colidem.  Sempre que poss√≠vel, tento comparar pontos e figuras, n√£o figuras e figuras, mas √†s vezes tenho que fazer o √∫ltimo.  De qualquer forma, tudo isso requer suas pr√≥prias verifica√ß√µes especiais: <br><br><pre> <code class="hljs kotlin"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> static function _collide_circleCircle(a:Zone, b:Zone):Bool { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> dx:<span class="hljs-built_in"><span class="hljs-built_in">Float</span></span> = a.centerX - b.centerX; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> dy:<span class="hljs-built_in"><span class="hljs-built_in">Float</span></span> = a.centerY - b.centerY; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> d2:<span class="hljs-built_in"><span class="hljs-built_in">Float</span></span> = (dx * dx) + (dy * dy); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> r2:<span class="hljs-built_in"><span class="hljs-built_in">Float</span></span> = (a.radius2) + (b.radius2); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> d2 &lt; r2; }</code> </pre> <br><br>  Tudo isso pode ser aprimorado com uma √∫nica <code>inline</code> - <code>inline</code> : <br><br><pre> <code class="hljs kotlin"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> static <span class="hljs-keyword"><span class="hljs-keyword">inline</span></span> function _collide_circleCircle(a:Zone, b:Zone):Bool { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> dx:<span class="hljs-built_in"><span class="hljs-built_in">Float</span></span> = a.centerX - b.centerX; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> dy:<span class="hljs-built_in"><span class="hljs-built_in">Float</span></span> = a.centerY - b.centerY; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> d2:<span class="hljs-built_in"><span class="hljs-built_in">Float</span></span> = (dx * dx) + (dy * dy); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> r2:<span class="hljs-built_in"><span class="hljs-built_in">Float</span></span> = (a.radius2) + (b.radius2); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> d2 &lt; r2; }</code> </pre> <br><br>  Quando adicionamos inline a uma fun√ß√£o, dizemos ao compilador que copie e cole esse c√≥digo e cole as vari√°veis ‚Äã‚Äãquando ele for usado, e n√£o fa√ßa uma chamada externa para uma fun√ß√£o separada, o que gera custos desnecess√°rios.  A incorpora√ß√£o nem sempre √© aplic√°vel (por exemplo, aumenta a quantidade de c√≥digo), mas √© ideal para situa√ß√µes em que pequenas fun√ß√µes s√£o chamadas repetidamente. <br><br><h2>  Trazemos √† mente conflitos </h2><br>  A verdadeira li√ß√£o aqui √© que, no mundo real, as otimiza√ß√µes nem sempre s√£o do mesmo tipo.  Essas corre√ß√µes s√£o uma mistura de t√©cnicas avan√ßadas, hacks baratos, aplica√ß√£o de recomenda√ß√µes l√≥gicas e elimina√ß√£o de erros est√∫pidos.  Tudo isso em geral nos d√° um aumento de desempenho. <br><br>  Mas ainda assim - <em>me√ßa sete vezes, corte uma!</em> <br><br>  Duas horas de otimiza√ß√£o pedante da fun√ß√£o, chamada uma vez a cada seis quadros e com 0,001 ms, n√£o valem o esfor√ßo, apesar da feiura e estupidez do c√≥digo. <br><br><h1>  3. Classifique tudo </h1><br>  Na verdade, foi uma das minhas √∫ltimas melhorias, mas acabou sendo t√£o vantajosa que merece seu pr√≥prio t√≠tulo.  Al√©m disso, era o mais simples e provou-se repetidamente.  O criador de perfil me mostrou um procedimento que eu n√£o pude melhorar - o loop principal draw (), que levou muito tempo.  O motivo foi a fun√ß√£o que classificou todos os elementos da tela antes da renderiza√ß√£o - ou seja, <em>classificar</em> todos os sprites levou muito mais tempo do que desenh√°-los! <br><br>  Se voc√™ olhar as capturas de tela do jogo, ver√° que todos os inimigos e defensores s√£o classificados primeiro por <code>y</code> e depois por <code>x</code> , para que os elementos se sobreponham de tr√°s para frente, da esquerda para a direita, quando passamos do canto superior esquerdo para o canto inferior direito da tela. <br><br>  Uma maneira de superar a classifica√ß√£o √© simplesmente passar a classifica√ß√£o de renderiza√ß√£o pelo quadro.  Este √© um truque √∫til para algumas fun√ß√µes caras, mas imediatamente levou a erros visuais muito vis√≠veis, por isso n√£o nos convinha. <br><br>  Finalmente, a decis√£o veio de um dos mantenedores da HaxeFlixel, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Jens Fisher</a> .  Ele perguntou: "Voc√™ se certificou de usar um algoritmo de classifica√ß√£o r√°pido para matrizes quase ordenadas?" <br><br>  N√£o!  Acabou que n√£o.  Eu usei a classifica√ß√£o de matriz da biblioteca padr√£o Haxe (acho que foi a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">classifica√ß√£o por mesclagem</a> - uma boa op√ß√£o para casos gerais. Mas eu tive um caso muito <em>especial</em> . Ao classificar em cada quadro, a posi√ß√£o de classifica√ß√£o altera apenas um n√∫mero muito pequeno de sprites, mesmo se houver muitos. Substitu√≠ a chamada de classifica√ß√£o antiga <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">pela classifica√ß√£o por inser√ß√µes</a> e <em>boom!</em> - a velocidade aumentou instantaneamente. <br><br><h1>  4. Outros problemas t√©cnicos </h1><br>  O reconhecimento e a classifica√ß√£o de colis√µes foram grandes vit√≥rias na l√≥gica de <code>update()</code> e <code>draw()</code> , mas muitas outras armadilhas foram ocultadas nos loops internos usados ‚Äã‚Äãativamente. <br><br><h2>  Std.is () e elenco </h2><br>  Em diferentes loops internos "quentes", eu tinha um c√≥digo semelhante: <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(Std.<span class="hljs-keyword"><span class="hljs-keyword">is</span></span>(something,<span class="hljs-keyword"><span class="hljs-keyword">Type</span></span>)) { var typed:<span class="hljs-keyword"><span class="hljs-keyword">Type</span></span> = cast(something,<span class="hljs-keyword"><span class="hljs-keyword">Type</span></span>); }</code> </pre> <br><br>  Na linguagem Haxe, <code>Std.is()</code> nos diz se um objeto pertence a um tipo espec√≠fico (Tipo) ou a uma classe (Classe), e o <code>cast</code> tenta convert√™-lo em um tipo espec√≠fico durante a execu√ß√£o do programa. <br><br>  Existem vers√µes seguras e desprotegidas de <code>cast</code> com <code>cast</code> seguro, resultando em desempenho reduzido, mas elencos desprotegidos n√£o. <br><br>  Seguro: <code>cast(something, Type);</code> <br><br>  Desprotegido: <code>var typed:Type = cast something;</code> <br><br>  Quando uma tentativa de convers√£o insegura falha, obtemos nulo, enquanto uma transmiss√£o segura gera uma exce√ß√£o.  Mas se n√£o vamos capturar uma exce√ß√£o, ent√£o qual √© o sentido de fazer um elenco seguro?  Sem captura, a opera√ß√£o ainda falha, mas funciona mais lentamente. <br><br>  Al√©m disso, n√£o faz sentido preceder uma <code>Std.is()</code> segura com a verifica√ß√£o <code>Std.is()</code> .  O √∫nico motivo para usar um elenco seguro √© uma exce√ß√£o garantida, mas se verificarmos o tipo antes do elenco, j√° garantimos que o elenco n√£o falhar√°! <br><br>  Posso acelerar um pouco as <code>Std.is()</code> com um elenco <code>Std.is()</code> depois de verificar <code>Std.is()</code> .  Mas por que precisamos reescrever a mesma coisa, se eu n√£o preciso verificar o tipo de classe? <br><br>  Suponha que eu tenha um <code>CreatureSprite</code> , que pode ser uma inst√¢ncia de uma subclasse de <code>DefenderSprite</code> ou <code>EnemySprite</code> .  Em vez de chamar <code>Std.is(this,DefenderSprite)</code> podemos criar um campo inteiro no <code>CreatureSprite</code> com valores como <code>CreatureType.DEFENDER</code> ou <code>CreatureType.ENEMY</code> , que s√£o verificados ainda mais rapidamente. <br><br>  Repito, vale a pena corrigi-lo apenas nos locais em que uma desacelera√ß√£o significativa √© claramente registrada. <br><br>  A prop√≥sito, voc√™ pode ler mais sobre o elenco <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">seguro</a> e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">desprotegido</a> no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">manual Haxe</a> . <br><br><h2>  Serializa√ß√£o / desserializa√ß√£o do universo </h2><br>  Foi chato encontrar esses lugares no c√≥digo: <br><br><pre> <code class="hljs actionscript"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">copy</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:SomeClass </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> SomeClass.fromXML(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.toXML()); }</code> </pre> <br>  Sim  Para copiar um objeto, n√≥s o <em>serializamos em XML</em> e, em seguida, <em>analisamos todo esse XML</em> , ap√≥s o qual descartamos instantaneamente o XML e retornamos um novo objeto.  Essa √© provavelmente a maneira mais lenta de copiar um objeto, al√©m disso, sobrecarrega a mem√≥ria.  Inicialmente, escrevi chamadas XML para salvar e carregar do disco e acho que estava com pregui√ßa de escrever os procedimentos de c√≥pia corretos. <br><br>  Provavelmente, tudo estaria em ordem se essa fun√ß√£o raramente fosse usada, mas essas chamadas surgissem em locais inadequados no meio da jogabilidade.  Ent√£o me sentei e comecei a escrever e testar a fun√ß√£o de c√≥pia correta. <br><br><h2>  Diga n√£o ao Nulo </h2><br>  A verifica√ß√£o de igualdade para nulo √© usada com bastante frequ√™ncia, mas, ao converter o Haxe em cpp, um objeto que permite um valor indefinido gera custos desnecess√°rios que n√£o surgem se o compilador puder assumir que o objeto nunca ser√° nulo.  Isso √© especialmente verdadeiro para tipos de base como <code>Int</code> - Haxe implementa a validade de um valor indefinido para eles no sistema de destino est√°tico por sua "embalagem", o que ocorre n√£o apenas para vari√°veis ‚Äã‚Äãdeclaradas explicitamente como nulas ( <code>var myVar:Null&lt;Int&gt;</code> ), mas tamb√©m para coisas como op√ß√µes de ajuda ( <code>?myParam:Int</code> ).  Al√©m disso, as verifica√ß√µes nulas causam desperd√≠cio desnecess√°rio. <br><br>  Consegui corrigir alguns desses problemas apenas olhando o c√≥digo e pensando em alternativas - posso fazer uma verifica√ß√£o mais simples, que sempre ser√° verdadeira quando o objeto for nulo?  Posso capturar nulo muito antes na cadeia de chamadas de fun√ß√£o e passar um simples sinalizador inteiro ou booleano para chamadas filho?  Posso estruturar tudo para que <em>nunca</em> seja garantido que o valor se torne nulo?  E assim por diante  N√£o podemos eliminar completamente verifica√ß√µes e valores nulos, mas tir√°-los das fun√ß√µes me ajudou muito. <br><br><h1>  5. Tempo de download </h1><br>  No PSVita, tivemos problemas s√©rios com o tempo de carregamento de algumas cenas.  Ao criar um perfil, os motivos se resumem principalmente √† rasteriza√ß√£o de texto, renderiza√ß√£o desnecess√°ria de software, renderiza√ß√£o cara de bot√µes e outras coisas. <br><br><h2>  Text </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">O HaxeFlixel √©</a> baseado no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">OpenFL</a> , que possui um TextField incr√≠vel e confi√°vel.  Mas usei objetos FlxText de maneira imperfeita - os objetos FlxText t√™m um campo de texto OpenFL interno que √© rasterizado.  No entanto, descobriu-se que eu n√£o precisava da maioria dessas fun√ß√µes complexas de texto, mas, devido √† maneira est√∫pida de configurar meu sistema de interface do usu√°rio, os campos de texto precisavam ser renderizados antes que todos os outros objetos fossem localizados.  Isso levou a saltos pequenos, mas percept√≠veis, por exemplo, ao carregar uma janela pop-up. <br><br>  Aqui fiz tr√™s corre√ß√µes - primeiro, substitu√≠ o m√°ximo de texto poss√≠vel por fontes raster.  O Flixel tem suporte interno para v√°rios formatos de fonte raster, incluindo o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">BMFont do AngelCode</a> , o que facilita o trabalho com Unicode, estilo e kerning, mas a API de texto raster √© um pouco diferente da API de texto sem formata√ß√£o, ent√£o eu tive que escrever uma pequena classe de wrapper para simplifique a transi√ß√£o.  (Eu dei um nome adequado para <code>FlxUITextHack</code> ). <br><br>  Isso melhorou levemente o trabalho - as fontes de bitmap renderizam muito rapidamente - mas aumentou ligeiramente a complexidade: tive que preparar especialmente conjuntos de caracteres separados e adicionar l√≥gica de comuta√ß√£o, dependendo da localidade, em vez de apenas configurar uma caixa de texto que fizesse todo o trabalho. <br><br>  A segunda corre√ß√£o foi criar um novo objeto de interface do usu√°rio que fosse um <em>espa√ßo reservado</em> simples para o texto, mas tivesse as mesmas propriedades p√∫blicas do texto.  Eu o chamei de ‚Äú√°rea de texto‚Äù e criei uma nova classe para ela na minha biblioteca da interface do usu√°rio, para que meu sistema de interface do usu√°rio possa usar essas √°reas de texto da mesma maneira que os campos de texto reais, mas ele n√£o renderiza nada at√© calcular o tamanho e a posi√ß√£o de todo o resto.  Ent√£o, quando minha cena foi preparada, iniciei o procedimento de substitui√ß√£o dessas √°reas de texto por campos de texto reais (ou campos de texto de fontes de bitmap). <br><br>  A terceira corre√ß√£o dizia respeito √† percep√ß√£o.  Se houver pausas entre a entrada e a rea√ß√£o, mesmo em meio segundo, o jogador percebe isso como uma frenagem.  Portanto, tentei encontrar todas as cenas nas quais h√° um atraso na entrada at√© a pr√≥xima transi√ß√£o e adicionei uma camada transl√∫cida com a palavra "Carregando ..." ou apenas uma camada sem texto.  Uma corre√ß√£o t√£o simples melhorou bastante a <em>percep√ß√£o de</em> capacidade <em>de</em> resposta do jogo, pois algo acontece imediatamente ap√≥s o jogador tocar no controle, mesmo que demore algum tempo para exibir o menu. <br><br><h2>  Renderiza√ß√£o de software </h2><br>  A maioria dos menus usa uma combina√ß√£o de escala de software e composi√ß√£o de 9 fatias.  Isso aconteceu porque na vers√£o para PC havia uma interface do usu√°rio independente da resolu√ß√£o que poderia funcionar com uma propor√ß√£o de 4: 3 e 16: 9, dimensionada de acordo.  Mas no PSVita j√° <em>sabemos a</em> resolu√ß√£o, ou seja, n√£o precisamos de todos esses recursos extras de alta resolu√ß√£o e algoritmos de dimensionamento em tempo real.  Podemos simplesmente pr√©-renderizar os recursos para a resolu√ß√£o exata e coloc√°-los na tela. <br><br>  Primeiro, entrei na marca√ß√£o da interface do usu√°rio para as condi√ß√µes do Vita que mudaram o jogo para o uso de um conjunto paralelo de recursos.  Ent√£o eu precisava criar esses recursos preparados para uma permiss√£o.  O <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">depurador HaxeFlixel</a> acabou sendo muito √∫til <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> - adicionei meu script a ele para que ele simplesmente libere o cache de varredura no disco.  Em seguida, criei uma configura√ß√£o de compila√ß√£o especial para Windows que simula a permiss√£o para o Vita, abri todos os menus do jogo, alternei para o depurador e iniciei o comando de exporta√ß√£o para as vers√µes em escala dos recursos como PNGs prontos.  Depois, apenas os renomeei e os usei como recursos para o Vita. <br><br><h2>  Renderiza√ß√£o de bot√£o </h2><br>  Meu sistema de interface do usu√°rio tinha um problema real com os bot√µes - quando eles foram criados, os bot√µes renderizaram o conjunto de recursos padr√£o e, instantes depois, redimensionaram (e renderizaram novamente) o c√≥digo de inicializa√ß√£o da interface do usu√°rio, e √†s vezes at√© a <em>terceira</em> vez, antes do carregamento de toda a interface do usu√°rio. .  Resolvi esse problema adicionando op√ß√µes que atrasavam a renderiza√ß√£o dos bot√µes para o √∫ltimo est√°gio. <br><br><h2>  Digitaliza√ß√£o de texto opcional </h2><br>  A revista estava carregando especialmente devagar.  No come√ßo, pensei que o problema estava nos campos de texto, mas n√£o.  O texto da revista pode conter links para outras p√°ginas, indicadas por caracteres especiais incorporados no pr√≥prio texto bruto.  Esses caracteres foram posteriormente cortados e usados ‚Äã‚Äãpara calcular a localiza√ß√£o do link. <br><br>  Acabou.  que eu digitalizei <em>todos os campos de texto</em> para encontrar e substituir esses caracteres por links formatados corretamente, sem verificar primeiro se h√° algum caractere especial nesse campo de texto!  Pior, de acordo com o design, os links eram usados <em>apenas</em> na p√°gina de conte√∫do, mas eu os marquei em todas as caixas de texto em todas as p√°ginas. <br><br>  Consegui contornar todas essas verifica√ß√µes usando a constru√ß√£o if do formul√°rio "Esta caixa de texto usa links?".  A resposta para essa pergunta geralmente era n√£o.  Finalmente, a p√°gina que demorou mais para carregar acabou sendo a p√°gina de √≠ndice.  Como nunca muda no menu do di√°rio, por que n√£o o armazenamos em cache? <br><br><h1> 6.   </h1><br>  ‚Äî    .     ,      Vita.        ,                . <br><br>   ¬´  ¬ª?     :   ,    ,   ,   .        ,   ,       : <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7fc/d66/464/7fcd664644c9d2b8bbfe3ac82d60ae2b.png"></div><br><br><h2>   </h2><br>     ,       ,    .    <em></em>    ,       ‚Äî  PC     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="> </a> ,           .       (  ) ‚Äî   ,        .   ,               ! <br><br>  Haxe  ,    open source,        ,    ,     Unity.   hxcpp         API! <br><br>          ,     : <br><br> <code>cpp.vm.Gc.run(false); //   (true/false - /  )</code> <br> <br>     ,   ,   ,  ,    ,   . <br><br><h1> 7.      </h1><br>        ,     PC,         PSVita,        Nintendo Switch,          . <br><br>    ¬´ ¬ª,         ,        <em></em> . <br><br><h2>      </h2><br>   16x     ,      .       ‚Äî         ,     AOE- ‚Äî .              . <br><br>   ,   -   16x      <em></em>  8x,       ,               8x  4x.          Endless Battle 2.       ,    . <br><br>       .  Vita    ,      ,     . <br><br><h2>   </h2><br>           Endless Battle 2 ‚Äî        <em></em> ,    .          ,      ? <br><br>    ,   ,      ,   . <br><br>       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="> </a> ‚Äî       ,   . <br><br>     ,   ¬´ ¬ª  ,    .    ¬´¬ª  8  ¬´¬ª (   )     ,    .   <em></em>          ¬´¬ª   ,  ¬´¬ª   1   ¬´¬ª,     .     ¬´¬ª ,     .  ,  ,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="></a>       . <br><br>      ,      ¬´¬ª,     ‚Äî  ,    ,   ,     ,     . <br><br> (,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="></a>  .) <br><br>    ,      .     ,         ,    ‚Äî           .    ,    ,      ‚Äî    - ,  <em>   </em> ! <br><br><h2>   ,   </h2><br>      , ,    ,    .   ,    .   ,        ,    ,        ,  <em>   </em> . ,    -   ,  ,    ¬´¬ª    .        ,   ,             .       ,             ,           . <br><br><h2>     </h2><br>        ,        ‚Äî      ,        .   ,     ,      ¬´¬ª. <br><br>      ‚Äî       ,     PSVita,    ‚Äî        !            ! <br><br>  !    ()          <em></em>    ,     ,           . ,    ,                ,      ! <br><br><h2>   ,    </h2><br>     PSVita,    ,    ,     . -        HD-  ,        .             (     ). <br><br>       ‚Äî  PC           ,    .       ,  Vita         ,       . <br><br>         , ,   ,      , <em>      </em> .       UI,     <em> </em> . <br><br>       ,   -  ¬´¬ª ,      .          ,     . <br><br><h2> NaN </h2><br>    .  ,       .   Haxe   C++  : <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4f4/387/7d5/4f43877d538fc9c44c34e5bfaa72bd45.jpg"></div><br>    , ,     <code>-90</code>    <code>270</code> .     <code>-724</code> ,       <code>4</code> . <br><br> -     <code>-2147483648</code> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7d8/6bc/9c8/7d86bc9c84d9e75a345b898ff44940a1.jpg"></div><br>  .         -2147483648  360,    5 965 233 ,      0    . ,       (   <em></em> ‚Äî   <em>update</em> !) ‚Äî  ,   ( - )   . <br><br> ,    ,      <code>NaN</code> ‚Äî  ,  ¬´Not a number¬ª ( ),     ,    .         ,     . <br><br>        <code>Math.isNan()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, que redefinem o √¢ngulo quando esse evento (bastante raro, mas inevit√°vel) ocorre. </font><font style="vertical-align: inherit;">Ao mesmo tempo, continuei pesquisando a causa raiz do erro, encontrei-o e o atraso desapareceu imediatamente. </font><font style="vertical-align: inherit;">Acontece que, se voc√™ n√£o executar 6 milh√µes de itera√ß√µes sem sentido, poder√° obter um grande aumento de velocidade! </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(Uma corre√ß√£o para esse erro foi </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">inserida</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> no pr√≥prio HaxeFlixel).</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> N√£o se engane </font></font></h2><br>  OpenFL,  HaxeFlixel    .  ,     ,          ,      .    ,     . <br><br>    -   :  ,     <em></em>  ,       ,  ,    ¬´ ¬ª  .    ¬´¬ª            ,      ,   ¬´¬ª,   . <br><br><h1> 8.  ,       Endless Battle 2 </h1><br> , ,          .  ,      ,         ,        .  ,        ,  ,       . Endless Battle 2      ,     <em>   </em> . <br><br>        PSVita         Endless 2,          XB1  PS4,       Endless 2.    ,    ,       .  ,  PSVita      ,     ,       PS4  XB1.     ¬´endurance¬ª -     .    PC   Endless Batlte 2  . <br><br>     ,      Defender's Quest II ‚Äî             ! , ¬´¬ª     Tower Defense,        ,      -,        ,      ?          ,                  ‚Äî       ,    .. <br><br><h1> 9.    </h1><br>   ‚Äî   ,      ,    ,         .   ,        ,    ,      ,  ,        . <br><br>   ,       ,   ,   ¬´¬ª      <em></em> .             .      ‚Äî       . <br><br>  ,         Defender's Quest II.  ,        PSVita,           .         PSVita,      ,     Defender's Quest. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt414135/">https://habr.com/ru/post/pt414135/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt414125/index.html">Como testamos o VMware vSAN ‚Ñ¢: por que ele funciona na pr√°tica</a></li>
<li><a href="../pt414127/index.html">Instale o 3CX em uma hospedagem por 2,99 euros / m√™s. em 10 minutos</a></li>
<li><a href="../pt414129/index.html">Mestre em Ci√™ncia da Computa√ß√£o Te√≥rica na Universidade Estadual de S√£o Petersburgo</a></li>
<li><a href="../pt414131/index.html">O efeito da frequ√™ncia do sinal na energia dos links de r√°dio no espa√ßo livre</a></li>
<li><a href="../pt414133/index.html">Design de jogos de quebra-cabe√ßa com o exemplo de In The Shadows</a></li>
<li><a href="../pt414137/index.html">Experi√™ncia de desenvolvimento de SPA no VueJS + Nuxt</a></li>
<li><a href="../pt414139/index.html">Lan√ßamento do proxy MTProto n√£o oficial em Python, recursos de protocolo</a></li>
<li><a href="../pt414141/index.html">7 regras para projetar placas de circuito impresso</a></li>
<li><a href="../pt414149/index.html">As raz√µes para o som ruim da maioria dos smartphones Android</a></li>
<li><a href="../pt414151/index.html">Fintech-digest: bancos reportar√£o danos de ataques de hackers, Western Union se recusa a trabalhar com criptomoedas</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>