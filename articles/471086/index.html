<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§∂üèª üÜé üö¥üèº Generador de portadas de m√∫sica Python en Blender üêñ üë©üèø‚Äçü§ù‚Äçüë©üèΩ üç°</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="En este art√≠culo hablar√© sobre mi complemento en la licuadora, sobre las razones que me llevaron a crearlo, el proceso de desarrollo y el "√©xito" en Y...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Generador de portadas de m√∫sica Python en Blender</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/471086/">  En este art√≠culo hablar√© sobre mi complemento en la licuadora, sobre las razones que me llevaron a crearlo, el proceso de desarrollo y el "√©xito" en YouTube. <br><br><img src="https://habrastorage.org/webt/se/0l/3z/se0l3z14g4hz9us38mpb1yetci0.jpeg"><br><a name="habracut"></a><br><br><h3>  Antecedentes </h3><br>  Todo comenz√≥ con el hecho de que hace aproximadamente un a√±o (en noviembre de 2018) vi en la oferta de YouTube una portada tan inusual en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">The Ultimate Canon</a> <br><br>  El chico grab√≥ las muestras de cada nota de la canci√≥n y, a trav√©s de una minuciosa edici√≥n, reuni√≥ toda la canci√≥n a partir de ellas.  Para qui√©n es, pero creo que es al menos divertido.  Y el n√∫mero de visitas (en ese momento un poco m√°s de 1,000,000) indic√≥ que el tema ( <i>1% de habilidad de guitarra y 99% de habilidad de edici√≥n</i> ) era popular. <br><br>  Estoy seguro de que aquellos que al menos estuvieron un poco involucrados en la mezcla de canciones saben que a veces es m√°s f√°cil cortar y mover ligeramente la pista que pedirle al guitarrista descuidado que reproduzca la parte.  Tambi√©n sol√≠a hacer portadas cl√°sicas, e incluso entonces tuve la idea de arrastrarme y crear una portada exactamente como lo hizo el tipo del video.  Y ahora veo que "mi idea fue robada descaradamente" y obtuve un buen escape.  Me molest√≥ que mi tren se fuera, pero de repente me di cuenta de que pod√≠a hacer lo mismo, pero a un nivel diferente, agregando un nuevo paso: <i>1% guitarra 1% edici√≥n 98% habilidades de programaci√≥n</i> . <br><br>  Adem√°s, esto le permitir√° crear composiciones mucho m√°s complejas que, cuando se editan manualmente, pocas personas tienen paciencia. <br><br><h3>  Desarrollo </h3><br>  Entonces, la tarea era automatizar el proceso de cortar muestras de sonido en una composici√≥n musical. <br><br>  En primer lugar, era necesario transmitir de alguna manera al programa del futuro datos sobre la composici√≥n, sus notas, pistas, instrumentos.  Inmediatamente pens√© en GuitarPro y sus opciones de exportaci√≥n de datos: MusicXML y MIDI. <br><br>  Las b√∫squedas me llevaron a elegir un analizador de archivos midi en Python <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">music21</a> .  Esto no es solo un analizador, sino que adem√°s de esto, no necesito nada del m√≥dulo.  Y los an√°logos ten√≠an una documentaci√≥n terrible o no pod√≠an hacer lo que necesitaba tan f√°cilmente como la m√∫sica21. <br><br>  Genial, ahora puedo obtener datos de archivos midi sobre pistas, sus notas, su posici√≥n y duraci√≥n.  Vamos m√°s lejos <br><br>  Ahora, en base a estos datos, debe cortar de archivos de video / audio.  Entonces eleg√≠ lo suficientemente r√°pido.  Definitivamente Blender, incluso a pesar de sus modestas capacidades como editor de video.  Tengo experiencia trabajando con Adobe PremierePro, After Effects, pero existe mi propio dialecto de secuencias de comandos, que no es √∫til en ning√∫n otro lugar, y sus capacidades son desconocidas para m√≠.  En Blender, casi cualquier acci√≥n se puede realizar a trav√©s de un script de Python.  Y eso ya coincide con el lenguaje de la m√∫sica21.  Vale la pena explicar que en ese momento no estaba familiarizado con Python, por lo tanto, tambi√©n consider√© este proyecto como una excelente ocasi√≥n para familiarizarme con este lenguaje popular.  Bingo! <br><br>  Poco a poco, comenc√© a profundizar en el lenguaje, envi√© notas de archivos midi a la consola a trav√©s de music21, r√°pidamente examin√© c√≥mo hacer complementos para la licuadora y proced√≠ a la primera tarea pr√°ctica: generar datos de muestra.  Grab√≥ cada nota √∫nica en la guitarra y comenz√≥ a cortar, pero pronto se detuvo.  Mi programador interno protest√≥ contra este trabajo minucioso (y puede haber muchas notas para cada instrumento: 30-50).  Y esto tendr√≠a que cortar las notas y renderizarlas individualmente en archivos separados, y para hacer esto, ajustar cada nota de pista en longitud al comienzo de la l√≠nea de tiempo ... En general, este proceso tuvo que simplificarse. <br><br>  La soluci√≥n fue usar algo as√≠ en Blender como marcadores.  Estos son esencialmente puntos con informaci√≥n textual que se puede establecer en un marco espec√≠fico.  La l√≥gica era esta: el usuario organiza su video y audio (si el audio se grab√≥ en una pista separada), los conduce entre s√≠ y marca con los marcadores el comienzo de cada nota en el video, y en el texto del marcador indica qu√© tipo de nota es (A #, D, C y etc.) y su duraci√≥n m√°xima en el registro.  Luego, la informaci√≥n sobre los marcadores se registra en un archivo y ya se utiliza al cortar notas individuales. <br><br><img src="https://habrastorage.org/webt/hj/nh/sp/hjnhspqu2nigpktwpavzf5pk-as.png"><br><br>  El siguiente punto fue el "n√∫cleo" real de lo funcional: notas de corte y su posicionamiento en la l√≠nea de tiempo.  Ir√≥nicamente, no hay nada especial que decir: hab√≠a mucha documentaci√≥n de lectura, la documentaci√≥n de Blender estaba lejos de ser siempre bastante detallada, pero gradualmente logr√© lo que quer√≠a.  Cuando vi (y escuch√©) el primer resultado (era una composici√≥n corta del grupo Epidemic - Frodo), la felicidad no conoc√≠a l√≠mites.  Creo que todos conocen el sentimiento cuando finalmente sale algo. <br><br><img src="https://habrastorage.org/webt/tj/c9/eu/tjc9euayeaoekq8pan04okdssl4.png"><br><br>  La calidad del c√≥digo es pobre.  Trat√© de hacerlo a toda prisa, porque  Me imagin√© que no era el √∫nico que pensaba en tal cosa, y que no querr√≠a adelantarme aqu√≠ (¬°spoiler! ¬°Qu√© ingenuo era!).  Por lo tanto, no hab√≠a tiempo para adherirse al estilo y reflexionar sobre la estructura, intent√© obtener un prototipo que funcionara m√°s r√°pido. <br><br><h3>  Matices </h3><br>  Ahora por los matices de la implementaci√≥n.  Blender tiene un l√≠mite en las capas del editor, m√°ximo 32. De la imagen se puede ver que las muestras de audio y video (verde y morado) ocupan 14 capas cada una y se forman en orden ascendente, luego nuevamente al comienzo de su sector.  Esto se debe al hecho de que Blender no le permitir√° generar una muestra encima de otra.  Y en la m√∫sica a menudo sucede que la siguiente nota comienza incluso antes del final del sonido anterior.  Por lo tanto, para evitar la superposici√≥n, decid√≠ generar la siguiente nota en una capa m√°s alta que la anterior, y cuando las capas del sector terminen, comience nuevamente desde la primera capa (es poco probable que la primera nota suene hasta 14 capas hacia adelante).  S√≠, esto podr√≠a hacerse de manera m√°s inteligente guardando capas, pero como dije, ten√≠a prisa. <br><br>  El m√°s atento podr√≠a notar que todo el sector es de 2 por 14 capas, esto es 28, y el m√°ximo en Blender es 32. El hecho es que para generar notas, debe generar 2 pistas originales (video y audio) a trav√©s de un gui√≥n y luego cortarlas. nota  Y no puedes generar encima de otra pista, as√≠ que reserv√© las capas 31 y 32 para este negocio.  Los d√≠as 29 y 30 se utilizan para el almacenamiento intermedio de pistas ya generadas: la generaci√≥n se produce bajo una pista del archivo midi, luego las notas se agrupan en una pista, se transfieren a la capa 29/30, generamos la siguiente pista, etc. <br><br>  Tambi√©n hay un matiz: en las puntuaciones midi existe una propiedad como la velocidad de reproducci√≥n.  Y puede cambiar muchas veces dentro de la composici√≥n.  En music21, nunca encontr√© la oportunidad de seguir estos cambios de velocidad.  Por lo tanto, la velocidad de las notas generadas coincidir√° con la primera velocidad especificada en el archivo midi.  Hay 2 soluciones: <br><br><ol><li>  para cada secci√≥n con una nueva velocidad, cree un nuevo archivo midi solo con ella; </li><li>  generar notas de secci√≥n nuevamente con el modificador de velocidad Tempo (factor multiplicativo a la velocidad inicial). </li></ol><br><img src="https://habrastorage.org/webt/ul/8s/1j/ul8s1jkhijfs4uebefv9losylik.png"><br><br>  Prefiero agregar mis propias pistas para cada velocidad en GuitarPro, luego en Blender, es suficiente generarlas solo con un modificador de velocidad, es m√°s r√°pido y m√°s dif√≠cil confundirse. <br><br><h3>  Utilidades de editor de video </h3><br>  Ahora que tiene un borrador de pistas generadas, debe montar una cubierta que se pueda ver.  Es decir  Posicione las pistas en las esquinas del video, cambie seg√∫n la m√∫sica, etc.  En una licuadora, esto es bastante malo.  Para aplicar el efecto a la pista, debe "pegar" otra pista desde arriba, que se representar√° al renderizar, y colocarla en la posici√≥n correcta. <br><br>  De particular inter√©s son los acordes.  Esto es cuando suenan varias notas al mismo tiempo, es decir  al renderizar un video, solo se mostrar√° la nota m√°s alta del acorde.  La soluci√≥n fue agregar el mismo efecto (afortunadamente, no se rompen cuando se superponen entre s√≠).  Si durante la edici√≥n normal de las pistas generadas pude hacer todo manualmente, entonces editar cada nota del acorde es demasiado.  Como saben, tambi√©n automatic√© este matiz.  Ahora, con solo tocar un bot√≥n "Chordify strips", las muestras seleccionadas se transformar√°n seg√∫n sea necesario y se dibujar√° cada nota del acorde. <br><br><img src="https://habrastorage.org/webt/ft/3y/gg/ft3yggjgwv4_na3gaycf8kxtnma.png"><br><br><img src="https://habrastorage.org/webt/7y/ak/fy/7yakfyj859n2xayjhj5ehl9xvm8.png"><br><br>  Y un punto m√°s de automatizaci√≥n: a veces las muestras generadas tienen partes vac√≠as entre ellas.  Esto se debe al hecho de que las puntuaciones en estos lugares son de repente lugares vac√≠os.  En GuitarPro, esto suena normal, debido a varios efectos, el sonido de la nota se mantiene en el medio.  Sin embargo, se forman vac√≠os en la licuadora.  Deben rellenarse estirando la nota anterior antes de la siguiente.  Exactamente esta tarea se realiza mediante el bot√≥n "Rellenar huecos". <br><br>  La funcionalidad para trabajar con volumen, as√≠ como la capacidad de reemplazar una nota ausente por una diferente, pero con un valor diferente del tono, tambi√©n se escribi√≥ para peque√±as cosas, lo que le permite ir m√°s all√° de los l√≠mites del rango del instrumento (aunque en la pr√°ctica no es m√°s de 1 octava). <br><br><h3>  Gloria en youtube </h3><br>  Entonces, el complemento est√° listo.  Aproximadamente un mes y medio se gast√≥ desde el comienzo de la idea, trabaj√≥ por las tardes, en su tiempo libre.  Es hora de hacer una tapa que supere la tapa de la mano de ese tipo.  Eleg√≠ la misma canci√≥n, pero en un arreglo de rock: Canon Rock.  Es mucho m√°s mel√≥dico y m√°s complicado que el original, y demostrar√° claramente el nuevo nivel de mi enfoque.  S√≠, y como respuesta a un video ya popular, puede atraer la atenci√≥n de una audiencia. <br><br>  En el texto anterior, enga√±√© un poco, porque  Comenc√© a trabajar en la portada en el proceso de escribir el complemento, de modo que, usando su ejemplo, entiendo qu√© funcionalidad se necesita e implementarlo. <br><br>  ¬°Y ahora la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">cubierta est√° lista y pulida</a> !  Film√≥ la introducci√≥n y el final, en el que, en un ingl√©s quebrado, trat√≥ de explicar la inclinaci√≥n de mi respuesta.  √âl pronunci√≥ algunas palabras deliberadamente con errores (cumplido, doble y ef), con la esperanza de que los espectadores modifiquen sus comentarios.  Prepar√≥ una vista previa.  Con la respiraci√≥n contenida, en previsi√≥n del triunfo esperado, subi√≥ y public√≥ el video.  Los envi√© en grupos de portadas y abr√≠ el enlace en Instagram a ese tipo.  √âl, por cierto, tiene un apodo muy triunfante: Ralph Jay Triumfo. <br><br>  El tiempo paso  No hubo triunfo.  El primer d√≠a obtuve alrededor de 100 visitas, la mitad de las cuales eran m√≠as y de mis amigos.  Luego hubo una pausa.  Con cada nuevo d√≠a me decepcion√© m√°s y m√°s en toda esta empresa.  ¬øLa gente realmente no entiende lo genial que lo hice?  ¬øPor qu√© el boca a boca no funciona?  ¬øO tal vez la idea en s√≠ era genial solo en mi cabeza? <br><br>  Sea como fuere, me gust√≥ el resultado, y gradualmente comenc√© a hacer m√°s y m√°s portadas nuevas. <br>  En ese momento, particip√© en la filmaci√≥n del programa "Brain Modeling" en la televisi√≥n local, y una vez mencion√© mi oficio en una conversaci√≥n con el anfitri√≥n.  El resultado fue un peque√±o informe sobre m√≠.  Mam√°, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">estoy en la televisi√≥n</a> ! <br><br>  Entend√≠ perfectamente que los pensionistas ven principalmente la televisi√≥n local, por lo que no hab√≠a expectativas de esto. <br><br>  Incluso entonces, quer√≠a traer a mi mente el c√≥digo del complemento, optimizar la generaci√≥n y poner el complemento en el dominio p√∫blico, pero el fracaso del triunfo disminuy√≥ mi ardor.  Adem√°s, se estaba preparando el lanzamiento completo de la nueva versi√≥n de Blender y la API estaba cambiando.  Quer√≠a esperar su lanzamiento en el verano y transferir el complemento a la nueva versi√≥n, y luego sacarlo, pero nuevamente, no hab√≠a un deseo particular. <br><br>  Y ahora, despu√©s de casi un a√±o, cuando las vistas del primer video apenas superaron los 600, decid√≠ poner un complemento en el p√∫blico y escribir este art√≠culo, tal vez al menos alegrar√° mi tiempo libre, pero al mismo tiempo reprend√≠. <br><br>  Por supuesto, intent√© transferir el complemento a la nueva versi√≥n 2.80, pero result√≥ que el editor de video no solo no mejor√≥, sino que incluso empeor√≥.  El rendimiento es mucho peor, a veces se bloquea al generar pistas pesadas.  El editor mismo comenz√≥ a disminuir la velocidad.  La incapacidad de amortiguar ciertas pistas de audio (espero que esto sea un error, y se solucionar√°n en la pr√≥xima versi√≥n menor).  Mientras tanto, el complemento necesita la buena versi√≥n anterior 2.79 <br><br>  Aqu√≠ hay un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">enlace al complemento</a> , no olvide poner music21 en el int√©rprete de Python blender.  Espero con ansias la aparici√≥n masiva de portadas sintetizadas de usted. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/471086/">https://habr.com/ru/post/471086/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../471074/index.html">Synet: un marco para lanzar redes neuronales pre-entrenadas en la CPU</a></li>
<li><a href="../471076/index.html">C√≥mo Matrix cre√≥ un legado a prueba de balas</a></li>
<li><a href="../471078/index.html">Chrome bloquear√° completamente el contenido mixto</a></li>
<li><a href="../471080/index.html">¬øQui√©n es responsable de la calidad de probar la aplicaci√≥n? 10 razones para obtener errores en la producci√≥n</a></li>
<li><a href="../471084/index.html">Patrones de procedimiento que se pueden usar con fichas</a></li>
<li><a href="../471088/index.html">Burn Out IT-especialistas: 4 historias del gerente, desarrollador, producto y administrador. Y la receta de Southbridge.</a></li>
<li><a href="../471090/index.html">[No] use CDN</a></li>
<li><a href="../471092/index.html">Comando cp: copiar carpetas de archivos a * nix correctamente</a></li>
<li><a href="../471094/index.html">Tutu.ru y el Club de Programadores de Mosc√∫ est√°n invitados a una reuni√≥n de fondo el 17 de octubre</a></li>
<li><a href="../471096/index.html">Prueba p√∫blica: soluci√≥n para privacidad y escalabilidad en Ethereum</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>