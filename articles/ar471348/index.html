<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ฅ๏ธ ๐ฉ๐ปโ๐คโ๐จ๐ฟ ๐ง ููุฏุณ ุชุทุจููุงุช TypeScript ๐ฆ ๐ฅ ๐ฉ๐พโ๐ณ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ูุฑุญุจุง ูุง ูุจุฑ! ุฃูุฏู ุฅูููู ุชุฑุฌูุฉ ุงูููุงู "ุชุทุจููุงุช Full-Stack TypeScript - ุงูุฌุฒุก 1: ุชุทููุฑ ูุงุฌูุงุช ุจุฑูุฌุฉ ุงูุชุทุจููุงุช ูููุงุฌูุฉ ุงูุฎูููุฉ ูุน Nest.js" ูุขูุง ุฑูุจูุฑู ....">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ููุฏุณ ุชุทุจููุงุช TypeScript</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/471348/" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl">  ูุฑุญุจุง ูุง ูุจุฑ!  ุฃูุฏู ุฅูููู ุชุฑุฌูุฉ ุงูููุงู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">"ุชุทุจููุงุช Full-Stack TypeScript - ุงูุฌุฒุก 1: ุชุทููุฑ ูุงุฌูุงุช ุจุฑูุฌุฉ ุงูุชุทุจููุงุช ูููุงุฌูุฉ ุงูุฎูููุฉ ูุน Nest.js"</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุขูุง ุฑูุจูุฑู</a> . </p><br><h2 id="chast-1-razrabotka-servernogo-api-s-pomoschyu-nestjs" style=";text-align:right;direction:rtl">  ุงูุฌุฒุก 1: ุชุทููุฑ ุฎุงุฏู API ุจุงุณุชุฎุฏุงู Nest.JS </h2><br><p style=";text-align:right;direction:rtl">  TL ุ DR: ูุฐู ุณูุณูุฉ ูู ุงูููุงูุงุช ุญูู ููููุฉ ุฅูุดุงุก ุชุทุจูู ููุจ ูู TypeScript ุจุงุณุชุฎุฏุงู Angular ู Nest.JS.  ูู ุงูุฌุฒุก ุงูุฃูู ุ ุณููุชุจ ูุงุฌูุฉ ุจุฑูุฌุฉ ุชุทุจููุงุช ุฎุงุฏู ุจุณูุท ุจุงุณุชุฎุฏุงู Nest.JS.  ุงูุฌุฒุก ุงูุซุงูู ูู ูุฐู ุงูุณูุณูุฉ ูุฎุตุต ูุชุทุจูู ุงููุงุฌูุฉ ุงูุฃูุงููุฉ ุจุงุณุชุฎุฏุงู ุงูุฒุงูู.  ููููู ุงูุนุซูุฑ ุนูู ุงูุฑูุฒ ุงูููุงุฆู ุงูุฐู ุชู ุชุทููุฑู ูู ูุฐู ุงูููุงูุฉ ูู <a href="">ูุณุชูุฏุน ุฌูุซุจ</a> ูุฐุง <a href="">.</a> </p><br><h3 id="chto-takoe-nestjs-i-pochemu-imenno-angular" style=";text-align:right;direction:rtl">  ูุง ูู Nest.Js ูููุงุฐุง ุงูุฒุงููุ </h3><br><p style=";text-align:right;direction:rtl">  Nest.js ูู ุฅุทุงุฑ ุนูู ูุฅูุดุงุก ุชุทุจููุงุช ุฎุงุฏู ุงูููุจ Node.js. </p><br><p style=";text-align:right;direction:rtl">  ุงูููุฒุฉ ุงููููุฒุฉ ูู ุฃูู ูุญู ูุดููุฉ ูุง ูุญููุง ุฅุทุงุฑ ุนูู ุขุฎุฑ: ุจููุฉ ูุดุฑูุน node.js. <a name="habracut"></a>  ุฅุฐุง ููุช ูุฏ ุชุทูุฑุช ูู ุฃู ููุช ูุถู ุชุญุช node.js ุ ูุฃูุช ุชุนูู ุฃูู ููููู ุงูููุงู ุจุงููุซูุฑ ุจุงุณุชุฎุฏุงู ูุญุฏุฉ ูุงุญุฏุฉ (ุนูู ุณุจูู ุงููุซุงู ุ ูููู ููุจุฑุงูุฌ ุงููุณูุทุฉ Express ุฃู ุชูุนู ูู ุดูุก ูู ุงููุตุงุฏูุฉ ุฅูู ุงูุชุญูู ูู ุงูุตุญุฉ) ุ ููุง ูุฏ ูุคุฏู ูู ุงูููุงูุฉ ุฅูู "ููุถู" ุบูุฑ ูุฏุนููุฉ .  ููุง ุณุชุฑู ุฃุฏูุงู ุ ุณุชุณุงุนุฏูุง nest.js ูู ุฐูู ูู ุฎูุงู ุชูููุฑ ูุตูู ูุชุฎุตุตุฉ ูู ุงูุนุฏูุฏ ูู ุงููุถุงูุง. </p><br><p style=";text-align:right;direction:rtl">  ูุณุชูุญุงุฉ ุจุดุฏุฉ Nest.js ุจูุงุณุทุฉ ุงูุฒุงูู.  ุนูู ุณุจูู ุงููุซุงู <cut></cut>  ูุณุชุฎุฏู ููุง ุงููุธุงููู ุฃุฏูุงุช ุญูุงูุฉ ููุณูุงุญ ุจุงููุตูู ุฅูู ุจุนุถ ุฃุฌุฒุงุก ุชุทุจููุงุชู ุฃู ุชููุน ุงููุตูู ุฅูููุง ุ ููููุฑ ููุง ุงููุธุงููู ูุงุฌูุฉ CanActivate ูุชูููุฐ ูุฐู ุงูุฃุฌูุฒุฉ.  ููุน ุฐูู ุ ูู ุงูููู ููุงุญุธุฉ ุฃูู ุนูู ุงูุฑุบู ูู ุจุนุถ ุงูููุงููู ุงูููุงุซูุฉ ุ ูุฅู ููุง ุงููููููู ูุณุชููุงู ุนู ุจุนุถููุง ุงูุจุนุถ.  ูุฐุง ูู ุ ูู ูุฐู ุงูููุงูุฉ ุ ุณูููู ุจุฅูุดุงุก ูุงุฌูุฉ ุจุฑูุฌุฉ ุชุทุจููุงุช ูุณุชููุฉ ูููุงุฌูุฉ ุงูุฃูุงููุฉ ูุฏููุง ุ ูุงูุชู ูููู ุงุณุชุฎุฏุงููุง ูุน ุฃู ุฅุทุงุฑ ุขุฎุฑ (React ุ Vue.JS ููุง ุฅูู ุฐูู). </p><br><h3 id="veb-prilozhenie-dlya-on-layn-zakazov" style=";text-align:right;direction:rtl">  ุชุทุจูู ุงูููุจ ููุทูุจุงุช ุนุจุฑ ุงูุฅูุชุฑูุช </h3><br><p style=";text-align:right;direction:rtl">  ูู ูุฐุง ุงูุฏููู ุ ุณููุดุฆ ุชุทุจูููุง ุจุณูุทูุง ูููู ูููุณุชุฎุฏููู ูู ุฎูุงูู ูุถุน ุงูุทูุจุงุช ูู ูุทุนู.  ุณูู ูููุฐ ูุฐุง ุงูููุทู: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูููู ูุฃู ูุณุชุฎุฏู ุนุฑุถ ุงููุงุฆูุฉ ุ </li><li style=";text-align:right;direction:rtl">  ุงููุณุชุฎุฏู ุงููุตุฑุญ ูู ููุท ููููู ุฅุถุงูุฉ ุงูุจุถุงุฆุน ุฅูู ุงูุณูุฉ (ุฅุตุฏุงุฑ ุฃูุฑ) </li><li style=";text-align:right;direction:rtl">  ูููู ูููุณุคูู ููุท ุฅุถุงูุฉ ุนูุงุตุฑ ูุงุฆูุฉ ุฌุฏูุฏุฉ. </li></ul><br><p style=";text-align:right;direction:rtl">  ููุจุณุงุทุฉ ุ ูู ูุชูุงุนู ูุน ูุงุนุฏุฉ ุจูุงูุงุช ุฎุงุฑุฌูุฉ ููู ูุทุจู ูุธุงุฆู ุณูุฉ ุงููุชุฌุฑ ุงูุฎุงุตุฉ ุจูุง. </p><cut></cut><br><h3 id="sozdanie-faylovoy-struktury-proekta-nestjs" style=";text-align:right;direction:rtl">  ุฅูุดุงุก ุจููุฉ ููู ุงููุดุฑูุน Nest.js </h3><br><p style=";text-align:right;direction:rtl">  ูุชุซุจูุช Nest.js ุ ูุญุชุงุฌ ุฅูู ุชุซุจูุช Node.js (v.8.9.x ุฃู ุฃุนูู) ู NPM.  ูู ุจุชูุฒูู Node.js ูุชุซุจูุชู ููุธุงู ุงูุชุดุบูู ุงูุฎุงุต ุจู ูู ุงููููุน ุงูุฑุณูู (ูุชู ุชุถููู NPM).  ุนูุฏ ุชุซุจูุช ูู ุดูุก ุ ุชุญูู ูู ุงูุฅุตุฏุงุฑุงุช: </p><br><pre style=";text-align:right;direction:rtl"><code class="bash hljs">node -v <span class="hljs-comment"><span class="hljs-comment"># v12.11.1 npm -v # 6.11.3</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ููุงู ุทุฑู ูุฎุชููุฉ ูุฅูุดุงุก ูุดุฑูุน ูุน Nest.jsุ  ูููู ุงูุนุซูุฑ ุนูููุง ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงููุซุงุฆู</a> .  ุณูู ูุณุชุฎุฏู <code>nest-cli</code> .  ุชุซุจูุชู: </p><br><p style=";text-align:right;direction:rtl"> <code>npm i -g @nestjs/cli</code> </p> <br><p style=";text-align:right;direction:rtl">  ุจุนุฏ ุฐูู ุ ูู ุจุฅูุดุงุก ูุดุฑูุนูุง ุจุงุณุชุฎุฏุงู ุฃูุฑ ุจุณูุท: </p><br><p style=";text-align:right;direction:rtl"> <code>nest new nest-restaurant-api</code> </p> <br><p style=";text-align:right;direction:rtl">  ูู ูุฐู ุงูุนูููุฉ ุ ุณูุทูุจ ููุง ุงูุนุด ุงุฎุชูุงุฑ ูุฏูุฑ ุงูุญุฒู: <code>npm</code> ุฃู <code>yarn</code> </p><br><p style=";text-align:right;direction:rtl">  ุฅุฐุง ุณุงุฑุช ุงูุฃููุฑ ุนูู ูุง ูุฑุงู ุ ูุณุชููู <code>nest</code> ุจุฅูุดุงุก ุจููุฉ ุงูููู ุงูุชุงููุฉ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">nest-restaurant-api โโโ src โ โโโ app.controller.spec.ts โ โโโ app.controller.ts โ โโโ app.module.ts โ โโโ app.service.ts โ โโโ main.ts โโโ test โ โโโ app.e2e-spec.ts โ โโโ jest-e2e.json โโโ .gitignore โโโ .prettierrc โโโ nest-cli.json โโโ package.json โโโ package-lock.json โโโ README.md โโโ tsconfig.build.json โโโ tsconfig.json โโโ tslint.json</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุงูุชูู ุฅูู ุงูุฏููู ุงูุฐู ุชู ุฅูุดุงุคู ูุงุจุฏุฃ ุฎุงุฏู ุงูุชุทููุฑ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs"> <span class="hljs-comment"><span class="hljs-comment">#    cd nest-restaurant-api #   npm run start:dev</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ุงูุชุญ ูุชุตูุญูุง ูุฃุฏุฎู <code>http://localhost:3000</code> .  ุนูู ุงูุดุงุดุฉ ุณูู ูุฑู: <br><img src="https://habrastorage.org/webt/xl/pk/tl/xlpktlb_nkwfh6-akeba7wtnmjc.png"></p><br><p style=";text-align:right;direction:rtl">  ูุฌุฒุก ูู ูุฐุง ุงูุจุฑูุงูุฌ ุงูุชุนูููู ุ ูู ูุฎุชุจุฑ ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช (ุนูู ุงูุฑุบู ูู ุฃูู ูุฌุจ ุนููู ูุชุงุจุฉ ุงุฎุชุจุงุฑุงุช ูุฃู ุชุทุจูู ุฌุงูุฒ ููุงุณุชุฎุฏุงู).  ูุจูุฐู ุงูุทุฑููุฉ ููููู ูุณุญ ุฏููู <code>test</code> ูุญุฐู <code>src/app.controller.spec.ts</code> (ููู ุงูุงุฎุชุจุงุฑ ุงูุฃูู).  ูุชูุฌุฉ ูุฐูู ุ ูุญุชูู ูุฌูุฏ ุงููุตุฏุฑ ุนูู ุงููููุงุช ุงูุชุงููุฉ: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <code>src/app.controller.ts</code> ู <code>src/app.module.ts</code> : ูุฐู ุงููููุงุช ูุณุคููุฉ ุนู ุฅูุดุงุก ุฑุณุงูุฉ <code>Hello world</code> ุนูู ุทูู <code>/</code> route.  ูุฃู  ููุทุฉ ุงูุฏุฎูู ูุฐู ููุณุช ูููุฉ ููุฐุง ุงูุชุทุจูู ูููู ุจุญุฐููุง.  ูุฑูุจุง ุณูู ุชุชุนูู ุจูุฒูุฏ ูู ุงูุชูุงุตูู ูุง ูู <strong>ูุญุฏุงุช ุงูุชุญูู</strong> <strong>ูุงูุฎุฏูุงุช</strong> . </li><li style=";text-align:right;direction:rtl">  <code>src/app.module.ts</code> : ูุญุชูู ุนูู ูุตู ููุฆุฉ ููุน <strong>ุงููุญุฏุฉ ุงูููุทูุฉ</strong> ุ ุงููุณุคููุฉ ุนู ุงูุฅุนูุงู ุนู ุงุณุชูุฑุงุฏ ูุชุตุฏูุฑ ูุญุฏุงุช ุงูุชุญูู ูุงููููุฑูู ุฅูู ุชุทุจูู nest.js.  ูุญุชูู ูู ุชุทุจูู ุนูู ูุญุฏุฉ ููุทูุฉ ูุงุญุฏุฉ ุนูู ุงูุฃูู ุ ูููู ููููู ุฅูุดุงุก ุฃูุซุฑ ูู ูุญุฏุฉ ููุทูุฉ ูุชุทุจููุงุช ุฃูุซุฑ ุชุนููุฏูุง (ุงููุฒูุฏ ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงููุซุงุฆู</a> . ุณูุญุชูู ุชุทุจูููุง ุนูู ูุญุฏุฉ ููุทูุฉ ูุงุญุฏุฉ ููุท </li><li style=";text-align:right;direction:rtl">  <code>src/main.ts</code> : ูุฐุง ูู ุงูููู ุงููุณุคูู ุนู ุจุฏุก ุชุดุบูู ุงูุฎุงุฏู. </li></ul><br><blockquote style=";text-align:right;direction:rtl"><cut text=""></cut>  ููุงุญุธุฉ: ุจุนุฏ ุฅุฒุงูุฉ <code>src/app.controller.ts</code> ู <code>src/app.module.ts</code> ูู ุชุชููู ูู ุจุฏุก ุชุทุจูููุง.  ูุง ุชููู ุ ุณูู ูุตูุญูุง ูุฑูุจูุง. </blockquote><br><h3 id="sozdanie-tochek-vhoda-endpoints" style=";text-align:right;direction:rtl">  ุฅูุดุงุก ููุงุท ุฏุฎูู (ููุงุท ุงูููุงูุฉ) </h3><br><br><p style=";text-align:right;direction:rtl">  ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช (API) ุงูุฎุงุตุฉ ุจูุง ุณุชููู ูุชุงุญุฉ ุนูู ูุณุงุฑ <code>/items</code> .  ูู ุฎูุงู ููุทุฉ ุงูุฅุฏุฎุงู ูุฐู ุ ูููู ูููุณุชุฎุฏููู ุชููู ุงูุจูุงูุงุช ุ ููููู ุงููุณุคูููู ุจุฅุฏุงุฑุฉ ุงููุงุฆูุฉ.  ูููู ุจุฅูุดุงุฆู. </p><br><p style=";text-align:right;direction:rtl">  ููููุงู ุจุฐูู ุ ูู ุจุฅูุดุงุก ุฏููู ูุณูู <code>items</code> ุฏุงุฎู <code>src</code> .  ุณูุชู ุชุฎุฒูู ุฌููุน ุงููููุงุช ุงููุฑุชุจุทุฉ ุจูุณุงุฑ <code>/items</code> ูู ูุฐุง ุงูุฏููู ุงูุฌุฏูุฏ. </p><br><h4 id="sozdanie-kontrollerov" style=";text-align:right;direction:rtl">  ุฅูุดุงุก ูุญุฏุงุช ุชุญูู </h4><br><p style=";text-align:right;direction:rtl">  ูู <code>nest.js</code> ุ ููุง ูู ุงูุญุงู ูู ุงูุนุฏูุฏ ูู ุงูุฃูุทูุฑ ุงูุฃุฎุฑู ุ ุชููู ูุญุฏุงุช ุงูุชุญูู ูุณุคููุฉ ุนู ุชุนููู ุงููุณุงุฑุงุช ูุน ุงููุธุงุฆู.  ูุฅูุดุงุก ูุญุฏุฉ ุชุญูู ูู <code>nest.js</code> ุงุณุชุฎุฏู ุฃุฏุงุฉ <code>nest.js</code> ููุง ููู: <code>@Controller(${ENDPOINT})</code> .  ุนูุงูุฉ ุนูู ุฐูู ุ ูู ุฃุฌู ุชุนููู ุทุฑู <code>HTTP</code> ุงููุฎุชููุฉ ุ ูุซู <code>GET</code> ู <code>POST</code> ุ ูุชู ุงุณุชุฎุฏุงู ุงูุฏูููุฑุงุช <code>@Get</code> ู <code>@Post</code> ู <code>@Delete</code> ููุง ุฅูู ุฐูู. </p><br><p style=";text-align:right;direction:rtl">  ูู ุญุงูุชูุง ุ ูุญุชุงุฌ ุฅูู ุฅูุดุงุก ูุญุฏุฉ ุชุญูู ุชููู ุจุฅุฑุฌุงุน ุงูุฃุทุจุงู ุงููุชููุฑุฉ ูู ุงููุทุนู ุ ูุงูุชู ูุณุชุฎุฏููุง ุงููุณุคูููู ูุฅุฏุงุฑุฉ ูุญุชููุงุช ุงููุงุฆูุฉ.  ูููู ุจุฅูุดุงุก ููู ูุณูู <code>items.controller.tc</code> ูู ุฏููู <code>src/items</code> ุจุงููุญุชููุงุช ุงูุชุงููุฉ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> import { Get, Post, Controller } from '@nestjs/common'; @Controller('items') export class ItemsController { @Get() async findAll(): Promise&lt;string[]&gt; { return ['Pizza', 'Coke']; } @Post() async create() { return 'Not yet implemented'; } }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูู ุฃุฌู ุฅุชุงุญุฉ ูุญุฏุฉ ุงูุชุญูู ุงูุฌุฏูุฏุฉ ูุฏููุง ูู ุชุทุจูููุง ุ ูู ุจุชุณุฌูููุง ูู ุงููุญุฏุฉ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> import { Module } from '@nestjs/common'; import { ItemsController } from './items/items.controller'; @Module({ imports: [], controllers: [ItemsController], providers: [], }) export class AppModule {}</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูู <code>npm run start:dev</code> : <code>npm run start:dev</code> ููุชุญ ูู ุงููุณุชุนุฑุถ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">http: // localhost: 3000 / ุนูุตุฑ</a> ุ ุฅุฐุง ูุนูุช ูู ุดูุก ุจุดูู ุตุญูุญ ุ ูุนูููุง ุฃู ูุฑู ุฅุฌุงุจุฉ ุทูุจ ุงูุญุตูู ุนูู: <code>['Pizza', 'Coke']</code> . </p><br><p style=";text-align:right;direction:rtl">  <em>ููุงุญุธุฉ ุงููุชุฑุฌู: ูุฅูุดุงุก ูุญุฏุงุช ุชุญูู ุฌุฏูุฏุฉ ุ ุจุงูุฅุถุงูุฉ ุฅูู ุนูุงุตุฑ ุฃุฎุฑู ูู <code>nest.js</code> : ุงูุฎุฏูุงุช ุ ูููุฏูู ุงูุฎุฏูุงุช ุ ููุง ุฅูู ุฐูู ุ ูู ุงูุฃูุณุจ ุงุณุชุฎุฏุงู ุงูุฃูุฑ <code>nest-cli</code> .</em>  <em>ุนูู ุณุจูู ุงููุซุงู ุ ูุฅูุดุงุก ูุญุฏุฉ ุงูุชุญูู ุงูููุถุญุฉ ุฃุนูุงู ุ ููููู ุงุณุชุฎุฏุงู ุงูุฃูุฑ <code>nest generate controller items</code> ุ ููุชูุฌุฉ ูุฐูู ุ ุณูููู ุงูุนุด ุจุฅูุดุงุก <code>src/items/items.controller.tc</code> ุจุงููุญุชููุงุช ุงูุชุงููุฉ:</em> </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> import { Get, Post, Controller } from '@nestjs/common'; @Controller('items') export class ItemsController {}</code> </pre> <br><p style=";text-align:right;direction:rtl">  <em>ูุชุณุฌููู ูู <code>app.molule.tc</code></em> </p><br><h4 id="dobavlenie-servisa-service" style=";text-align:right;direction:rtl">  ุฅุถุงูุฉ ุฎุฏูุฉ </h4><br><p style=";text-align:right;direction:rtl">  ุงูุขู ุ ุนูุฏ ุงููุตูู ุฅูู <code>/items</code> ุชุทุจูููุง ุงูุตููู ููุณู ููู ุทูุจ ุ ููู ูุง ูุง ูููููุง ุชุบููุฑู.  ูุง ุชุนุฏ ูุนุงูุฌุฉ ุงูุจูุงูุงุช ูุญูุธูุง ูู ุฃุนูุงู ูุญุฏุฉ ุงูุชุญูู ุ ูููุฐุง ุงูุบุฑุถ ุ ูุฅู ุงูุฎุฏูุงุช ููุฌูุฉ ุฅูู nest.js <br>  ุงูุฎุฏูุงุช ูู ุงูุนุด ูู <code>@Injectable</code> <br>  ูุชุญุฏุซ ุงุณู ุงูุฏูููุฑ ุนู ููุณู ุ ูุถูููุง ุฃู ุฅุถุงูุฉ ูุฐุง ุงูุฏูููุฑ ุฅูู ุงููุตู ูุฌุนูู ูุงุจูุงู ููุญูู ูู ููููุงุช ุฃุฎุฑู ุ ูุซู ูุญุฏุงุช ุงูุชุญูู. <br>  ุฏุนููุง ุฅูุดุงุก ุฎุฏูุชูุง.  ูู <code>items.service.ts</code> ููู <code>items.service.ts</code> ูู ุงููุฌูุฏ <code>items.service.ts</code> ุจุงููุญุชููุงุช ุงูุชุงููุฉ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> import { Injectable } from '@nestjs/common'; @Injectable() export class ItemsService { private readonly items: string[] = ['Pizza', 'Coke']; findAll(): string[] { return this.items; } create(item: string) { this.items.push(item); } }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุชุบููุฑ ูุญุฏุฉ ุชุญูู <code>ItemsController</code> (ุงููุนููุฉ ูู <code>items.controller.ts</code> ) ูุงุณุชุฎุฏุงู ุฎุฏูุชูุง: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> import { Get, Post, Body, Controller } from '@nestjs/common'; import { ItemsService } from './items.service'; @Controller('items') export class ItemsController { constructor(private readonly itemsService: ItemsService) {} @Get() async findAll(): Promise&lt;string[]&gt; { return this.itemsService.findAll(); } @Post() async create(@Body() item: string) { this.itemsService.create(item); } }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูู ุงูุฅุตุฏุงุฑ ุงูุฌุฏูุฏ ูู ูุญุฏุฉ ุงูุชุญูู ุ ูููุง ุจุชุทุจูู <code>@Body</code> decorator ุนูู ูุณูุทุฉ ุทุฑููุฉ <code>create</code> .  ูุชู ุงุณุชุฎุฏุงู ูุฐู ุงููุณูุทุฉ ููุทุงุจูุฉ ุงูุจูุงูุงุช ุงูุชู ูุชู ุชูุฑูุฑูุง ุนุจุฑ <code>req.body ['item']</code> ุชููุงุฆููุง ูุน ุงููุณูุทุฉ ููุณูุง (ูู ูุฐู ุงูุญุงูุฉ ุ <code>item</code> ). <br>  ููุง ุชุชููู ูุญุฏุฉ ุงูุชุญูู ุงูุฎุงุตุฉ ุจูุง <code>ItemsService</code> ูุฆุฉ <code>ItemsService</code> ุ ูุชู ุญููู ุนู ุทุฑูู ุงูููุดุฆ.  ุงูุชุตุฑูุญ <code>ItemsService</code> <code>private readonly</code> ูุฌุนู ูุซูู ุซุงุจุช ูุบูุฑ ูุฑุฆู ููุท ุฏุงุฎู ุงููุตู. <br>  ููุง ุชูุณ ุชุณุฌูู ุฎุฏูุชูุง ูู <code>app.module.ts</code> : </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> import { Module } from '@nestjs/common'; import { ItemsController } from './items/items.controller'; import { ItemsService } from './items/items.service'; @Module({ imports: [], controllers: [ItemsController], providers: [ItemsService], }) export class AppModule {}</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุจุนุฏ ูู ุงูุชุบููุฑุงุช ุ ุฏุนูุง ูุฑุณู ุทูุจ HTTP POST ุฅูู ุงููุงุฆูุฉ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs"> curl -X POST -H <span class="hljs-string"><span class="hljs-string">'content-type: application/json'</span></span> -d <span class="hljs-string"><span class="hljs-string">'{"item": "Salad"}'</span></span> localhost:3000/items</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุจุนุฏ ุฐูู ุ ุณูู ูุชุญูู ููุง ุฅุฐุง ูุงูุช ุงูุฃุทุจุงู ุงูุฌุฏูุฏุฉ ูุฏ ุธูุฑุช ูู ูุงุฆูุชูุง ุนู ุทุฑูู ุชูุฏูู ุทูุจ GET (ุฃู ุนู ุทุฑูู ูุชุญ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">http: // localhost: 3000 / ุนูุงุตุฑ</a> ูู ูุชุตูุญ) </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs"> curl localhost:3000/items</code> </pre> <br><h4 id="sozdanie-marshruta-dlya-korziny-pokupok" style=";text-align:right;direction:rtl">  ุฅูุดุงุก ุทุฑูู ุนุฑุจุฉ ุงูุชุณูู </h4><br><p style=";text-align:right;direction:rtl">  ุงูุขู ุจุนุฏ ุฃู ุฃุตุจุญ ูุฏููุง ุงูุฅุตุฏุงุฑ ุงูุฃูู ูู ููุทุฉ ุงูุฏุฎูู <code>/items</code> ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช ุ ุฏุนููุง ูููุฐ ูุธููุฉ ุนุฑุจุฉ ุงูุชุณูู.  ูุง ุชุฎุชูู ุนูููุฉ ุฅูุดุงุก ูุฐู ุงููุธููุฉ ุนู ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช ุงูุชู ุชู ุฅูุดุงุคูุง ุจุงููุนู.  ูุฐูู ุ ูู ุฃุฌู ุนุฏู ุชุฌููุน ุงูุฏููู ุ ุณูููู ุจุฅูุดุงุก ูููู ูุณุชุฌูุจ ุจุญุงูุฉ "ููุงูู" ุนูุฏ ุงููุตูู. </p><br><p style=";text-align:right;direction:rtl">  ุฃููุงู ุ ูู ุงููุฌูุฏ <code>./src/shopping-cart/</code> ุฃูุดุฆ <code>shoping-cart.controller.ts</code> : </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> import { Post, Controller } from '@nestjs/common'; @Controller('shopping-cart') export class ShoppingCartController { @Post() async addItem() { return 'This is a fake service :D'; } }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุชุณุฌูู ูุญุฏุฉ ุงูุชุญูู ูุฐู ูู ุงููุญุฏุฉ ุงูููุทูุฉ ูุฏููุง ( <code>app.module.ts</code> ): </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> import { Module } from '@nestjs/common'; import { ItemsController } from './items/items.controller'; import { ShoppingCartController } from './shopping-cart/shopping-cart.controller'; import { ItemsService } from './items/items.service'; @Module({ imports: [], controllers: [ItemsController, ShoppingCartController], providers: [ItemsService], }) export class AppModule {}</code> </pre> <br><p style=";text-align:right;direction:rtl">  ููุชุญูู ูู ููุทุฉ ุงูุฅุฏุฎุงู ูุฐู ุ ูู ุจุชุดุบูู ุงูุฃูุฑ ุงูุชุงูู ุ ุจุนุฏ ุงูุชุฃูุฏ ูู ุชุดุบูู ุงูุชุทุจูู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs"> curl -X POST localhost:3000/shopping-cart</code> </pre> <br><h4 id="dobavlenie-opisaniya--interface-typescript-dlya-items" style=";text-align:right;direction:rtl">  ุฅุถุงูุฉ Typescript ูุงุฌูุฉ ููุนูุงุตุฑ </h4><br><p style=";text-align:right;direction:rtl">  ุงูุนูุฏุฉ ุฅูู ุฎุฏูุฉ <code>items</code> .  ุงูุขู ูุง ูููุฑ ุณูู ุงุณู ุงูุทุจู ุ ููู ูุฐุง ูุง ูููู ุจูุถูุญ ุ ูุณูุฑูุฏ ุจุงูุชุฃููุฏ ุงูุญุตูู ุนูู ูุฒูุฏ ูู ุงููุนูููุงุช (ุนูู ุณุจูู ุงููุซุงู ุ ุชูููุฉ ุงูุทุจู).  ุฃุนุชูุฏ ุฃูู ุณุชูุงูู ุนูู ุฃู ุชุฎุฒูู ูุฐู ุงูุจูุงูุงุช ููุฌููุนุฉ ูู ุงูุณูุงุณู ููุณุช ููุฑุฉ ุฌูุฏุฉุ <br>  ูุญู ูุฐู ุงููุดููุฉ ุ ูููููุง ุฅูุดุงุก ูุฌููุนุฉ ูู ุงููุงุฆูุงุช.  ููู ููู ุชุญูุธ ุจููุฉ ุงูุฃุฌุณุงูุ  ููุง ุณุชุณุงุนุฏูุง ูุงุฌูุฉ TypeScript ูู ุชุญุฏูุฏ ุจููุฉ ูุงุฆู <code>items</code> .  ูู ุจุฅูุดุงุก ููู ุฌุฏูุฏ ุจุงุณู <code>item.interface.ts</code> ูู ูุฌูุฏ <code>src/items</code> : </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> export interface Items { readonly name: string; readonly price: number; }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุซู ูู <code>items.service.ts</code> ููู <code>items.service.ts</code> : </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">import { Injectable } from '@nestjs/common'; import { Item } from './item.interface'; @Injectable() export class ItemsService { private readonly items: Item[] = []; findAll(): Item[] { return this.items; } create(item: Item) { this.items.push(item); } }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ููุฐูู ูู <code>items.controller.ts</code> : </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">import { Get, Post, Body, Controller } from '@nestjs/common'; import { ItemsService } from './items.service'; import { Item } from './item.interface'; @Controller('items') export class ItemsController { constructor(private readonly itemsService: ItemsService) {} @Get() async findAll(): Promise&lt;Item[]&gt; { return this.itemsService.findAll(); } @Post() async create(@Body() item: Item) { this.itemsService.create(item); } }</code> </pre> <br><h4 id="validaciya-vhodnyh-dannyh-v-nestjs" style=";text-align:right;direction:rtl">  ุงูุชุญูู ูู ุตุญุฉ ุงููุฏุฎูุงุช ูู Nest.js </h4><br><p style=";text-align:right;direction:rtl">  ุนูู ุงูุฑุบู ูู ุฃููุง ุญุฏุฏูุง ุจููุฉ ูุงุฆู <code>item</code> ุ ููู ููุฑุฌุน ุชุทุจูููุง ุฎุทุฃู ุฅุฐุง ุฃุฑุณููุง ุทูุจ POST ุบูุฑ ุตุงูุญ (ุฃู ููุน ูู ุงูุจูุงูุงุช ุบูุฑ ูุนุฑู ูู ุงููุงุฌูุฉ).  ุนูู ุณุจูู ุงููุซุงู ุ ููุซู ูุฐุง ุงูุทูุจ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs"> curl -H <span class="hljs-string"><span class="hljs-string">'Content-Type: application/json'</span></span> -d <span class="hljs-string"><span class="hljs-string">'{ "name": 3, "price": "any" }'</span></span> http://localhost:3000/items</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุฌุจ ุฃู ูุณุชุฌูุจ ุงูุฎุงุฏู ุจุญุงูุฉ 400 (ุทูุจ ุบูุฑ ุตุญูุญ) ุ ูููู ุจุฏูุงู ูู ุฐูู ุ ุณูู ูุณุชุฌูุจ ุชุทุจูููุง ุจุญุงูุฉ 200 (ููุงูู). </p><br><p style=";text-align:right;direction:rtl">  ูุญู ูุฐู ุงููุดููุฉ ุ ูู ุจุฅูุดุงุก <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">DTO (ูุงุฆู ููู ุงูุจูุงูุงุช)</a> ููููู ุชูุฌูู ุงูุฅุฎุฑุงุฌ (ููุงุฉ). </p><br><p style=";text-align:right;direction:rtl">  DTO ูู ูุงุฆู ูุญุฏุฏ ููููุฉ ููู ุงูุจูุงูุงุช ุจูู ุงูุนูููุงุช.  ูุตููุง DTO ูู ููู <code>src/items/create-item.dto.ts</code> : </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> import { IsString, IsInt } from 'class-validator'; export class CreateItemDto { @IsString() readonly name: string; @IsInt() readonly price: number; }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุงูุฃูุงุจูุจ ูู <code>Nest.js</code> ูู ุงูููููุงุช ุงููุณุชุฎุฏูุฉ ููุชุญูู ูู ุงูุตุญุฉ.  ููุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช ูุฏููุง ุ ูู ุจุฅูุดุงุก ููุงุฉ ุชุชุญูู ููุง ุฅุฐุง ูุงูุช ุงูุจูุงูุงุช ุงููุฑุณูุฉ ุฅูู ุงูุทุฑููุฉ ุชุชุทุงุจู ูุน DTO.  ูููู ุงุณุชุฎุฏุงู ููุงุฉ ูุงุญุฏุฉ ุจูุงุณุทุฉ ูุญุฏุงุช ุชุญูู ูุฎุชููุฉ ุ ูุฐุง ูู ุจุฅูุดุงุก <code>src/common/</code> directory ุจุงุณุชุฎุฏุงู <code>validation.pipe.ts</code> ููููู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> import { ArgumentMetadata, BadRequestException, Injectable, PipeTransform, } from '@nestjs/common'; import { validate } from 'class-validator'; import { plainToClass } from 'class-transformer'; @Injectable() export class ValidationPipe implements PipeTransform&lt;any&gt; { async transform(value, metadata: ArgumentMetadata) { const { metatype } = metadata; if (!metatype || !this.toValidate(metatype)) { return value; } const object = plainToClass(metatype, value); const errors = await validate(object); if (errors.length &gt; 0) { throw new BadRequestException('Validation failed'); } return value; } private toValidate(metatype): boolean { const types = [String, Boolean, Number, Array, Object]; return !types.find(type =&gt; metatype === type); } }</code> </pre> <br><blockquote style=";text-align:right;direction:rtl">  ููุงุญุธุฉ: ูุญุชุงุฌ ุฅูู ุชุซุจูุช ูุญุฏุชูู: <code>class-validator</code> <code>class-transformer</code> .  ููููุงู ุจุฐูู ุ ูู ุจุชุดุบูู <code>npm install class-validator class-transformer</code> ูู ูุญุฏุฉ ุงูุชุญูู ูุฃุนุฏ ุชุดุบูู ุงูุฎุงุฏู. </blockquote><p style=";text-align:right;direction:rtl">  ุงูุชููู ูุน <code>items.controller.ts</code> ููุงุณุชุฎุฏุงู ูุน ุฃูุงุจูุจ ุฌุฏูุฏุฉ ูุฏููุง ู DTO: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> import { Get, Post, Body, Controller, UsePipes } from '@nestjs/common'; import { CreateItemDto } from './create-item.dto'; import { ItemsService } from './items.service'; import { Item } from './item.interface'; import { ValidationPipe } from '../common/validation.pipe'; @Controller('items') export class ItemsController { constructor(private readonly itemsService: ItemsService) {} @Get() async findAll(): Promise&lt;Item[]&gt; { return this.itemsService.findAll(); } @Post() @UsePipes(new ValidationPipe()) async create(@Body() createItemDto: CreateItemDto) { this.itemsService.create(createItemDto); } }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุฏุนููุง ูุชุญูู ูู ููุฏูุง ูุฑุฉ ุฃุฎุฑู ุ ูุงูุขู ููุจู ุงูุฅุฏุฎุงู <code>/items</code> ุงูุจูุงูุงุช ููุท ุฅุฐุง ูุงูุช ูุญุฏุฏุฉ ูู DTO.  ุนูู ุณุจูู ุงููุซุงู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs"> curl -H <span class="hljs-string"><span class="hljs-string">'Content-Type: application/json'</span></span> -d <span class="hljs-string"><span class="hljs-string">'{ "name": "Salad", "price": 3 }'</span></span> http://localhost:3000/items</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุงูุตู ุงูุจูุงูุงุช ุบูุฑ ุงูุตุงูุญุฉ (ุงูุจูุงูุงุช ุงูุชู ูุง ูููู ุงูุชุญูู ูููุง ูู <code>ValidationPipe</code> ) ุ ููุชูุฌุฉ ูุฐูู ุญุตููุง ุนูู ุงูุฅุฌุงุจุฉ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> {"statusCode":400,"error":"Bad Request","message":"Validation failed"}</code> </pre> <br><h5 id="sozdanie-middleware" style=";text-align:right;direction:rtl">  ุฎูู ุงููุณูุทุฉ </h5><br><p style=";text-align:right;direction:rtl">  ููููุง <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุตูุญุฉ ุฏููู ุงูุจุฏุก ุงูุณุฑูุน Auth0</a> ุ ูุฅู ุงูุทุฑููุฉ ุงูููุตู ุจูุง ููุชุญูู ูู ุงูุฑูุฒ ุงููููุฒ ูู JWT ุงูุตุงุฏุฑ ุนู Auth0 ูู ุงุณุชุฎุฏุงู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงููุณูุทุฉ Express</a> ุงูุชู ุชูุฏููุง <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Express</a> <code>express-jwt</code> .  ูุฐู ุงููุณูุทุฉ ุจุฃุชูุชุฉ ุฌุฒุก ูุจูุฑ ูู ุงูุนูู. </p><br><p style=";text-align:right;direction:rtl">  ุฏุนูุง ููุดุฆ ููู <code>src / common</code> ุฏุงุฎู ุงูุฏููู <code>src / common</code> ุจุงูุดูุฑุฉ ุงูุชุงููุฉ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> import { NestMiddleware } from '@nestjs/common'; import * as jwt from 'express-jwt'; import { expressJwtSecret } from 'jwks-rsa'; export class AuthenticationMiddleware implements NestMiddleware { use(req, res, next) { jwt({ secret: expressJwtSecret({ cache: true, rateLimit: true, jwksRequestsPerMinute: 5, jwksUri: 'https://${DOMAIN}/.well-known/jwks.json', }), audience: 'http://localhost:3000', issuer: 'https://${DOMAIN}/', algorithm: 'RS256', })(req, res, err =&gt; { if (err) { const status = err.status || 500; const message = err.message || 'Sorry, we were unable to process your request.'; return res.status(status).send({ message, }); } next(); }); }; }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุงุณุชุจุฏู <code>${DOMAIN}</code> ุจูููุฉ <em>ุงููุฌุงู</em> ูู ุฅุนุฏุงุฏุงุช ุชุทุจูู Auth0 </p><br><blockquote style=";text-align:right;direction:rtl">  ููุงุญุธุฉ ุงููุชุฑุฌู: ูู ุชุทุจูู ุญูููู ุ ุฃุฎุฑุฌ <code>DOMAIN</code> ุฅูู ุซุงุจุช ุ ูุญุฏุฏ ูููุชู ุนุจุฑ <code>env</code> (ุจูุฆุฉ ุงูุชุฑุงุถูุฉ) </blockquote><p style=";text-align:right;direction:rtl">  ูู ุจุชุซุจูุช <code>express-jwt</code> ู <code>jwks-rsa</code> : </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs"> npm install express-jwt jwks-rsa</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูู ุงูุถุฑูุฑู ุชูุตูู ุงููุณูุทุฉ ุงูุชู ุชู ุฅูุดุงุคูุง (ูุนุงูุฌ) ุจุชุทุจูููุง.  ููููุงู ุจุฐูู ุ ูู ููู <code>./src/app.module.ts</code> : </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> import { Module, MiddlewareConsumer, RequestMethod } from '@nestjs/common'; import { AuthenticationMiddleware } from './common/authentication.middleware'; import { ItemsController } from './items/items.controller'; import { ShoppingCartController } from './shopping-cart/shopping-cart.controller'; import { ItemsService } from './items/items.service'; @Module({ imports: [], controllers: [ItemsController, ShoppingCartController], providers: [ItemsService], }) export class AppModule { public configure(consumer: MiddlewareConsumer) { consumer .apply(AuthenticationMiddleware) .forRoutes( { path: '/items', method: RequestMethod.POST }, { path: '/shopping-cart', method: RequestMethod.POST }, ); } }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุดูุฑ ุงูุฑูุฒ ุฃุนูุงู ุฅูู ุฃู ุทูุจุงุช POST ุฅูู <code>/items</code> ู <code>/shopping-cart</code> ุทุฑู ูุญููุฉ ุจูุงุณุทุฉ <em>ุงููุณูุทุฉ Express</em> ุงูุชู ุชุชุญูู ูู ุฑูุฒ ุงููุตูู ุงููููุฒ ูู ุงูุทูุจ. </p><br><p style=";text-align:right;direction:rtl">  ุฃุนุฏ ุชุดุบูู ุฎุงุฏู ุงูุชุทููุฑ ( <code>npm run start:dev</code> ) ูุงุชุตู ุจู Nest.js API: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs"> <span class="hljs-comment"><span class="hljs-comment">#     curl -X POST http://localhost:3000/shopping-cart #      TOKEN="eyJ0eXAiO...Mh0dpeNpg" # and issue a POST request with it curl -X POST -H 'authorization: Bearer '$TOKEN http://localhost:3000/shopping-cart</span></span></code> </pre> <br><h5 id="upravlenie-rolyami-s-auth0" style=";text-align:right;direction:rtl">  ุฅุฏุงุฑุฉ ุงูุฏูุฑ ูุน Auth0 </h5><br><p style=";text-align:right;direction:rtl">  ูู ุงูููุช ุงูุญุงูู ุ ูููู ูุฃู ูุณุชุฎุฏู ูุญูู ุฑูุฒูุง ุชู ุงูุชุญูู ููู ูุดุฑ ุนูุตุฑ ูู API ุงูุฎุงุตุฉ ุจูุง.  ููุน ุฐูู ุ ููุฏ ุฃู ูุชููู ุงููุณุชุฎุฏููู ุงูุฐูู ูุฏููู ุญููู ุงููุณุคูู ููุท ูู ุงูููุงู ุจุฐูู.  ูุชูููุฐ ูุฐู ุงููุธููุฉ ุ ูุณุชุฎุฏู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูููุงุนุฏ (ุงูููุงุนุฏ) Auth0</a> . </p><br><p style=";text-align:right;direction:rtl">  ูุฐุง ุ ุงูุชูู ุฅูู ููุญุฉ ุงูุชุญูู Auth0 ุ ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุณู <em>ุงูููุงุนุฏ</em></a> .  ููุงู ุ ุงููุฑ ููู <code>+ CREATE RULE</code> ูุญุฏุฏ "ุชุนููู ุงูุฃุฏูุงุฑ ุฅูู ูุณุชุฎุฏู" ููููุฐุฌ ุงููุงุนุฏุฉ. </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/qa/bz/6m/qabz6mavaqzu_qfeh9vxn8xkn4w.png"></p><br><p style=";text-align:right;direction:rtl">  ุจุนุฏ ุงูููุงู ุจุฐูู ุ ูุญุตู ุนูู ููู JavaScript ุจู ูุงูุจ ูุงุนุฏุฉ ูุถูู ุฏูุฑ ุงููุณุคูู ูุฃู ูุณุชุฎุฏู ูุฏูู ุจุฑูุฏ ุฅููุชุฑููู ููุชูู ุฅูู ูุฌุงู ูุนูู.  ุฏุนูุง ูุบูุฑ ุจุนุถ ุงูุชูุงุตูู ูู ูุฐุง ุงููุงูุจ ููุญุตูู ุนูู ูุซุงู ูุธููู.  ุจุงููุณุจุฉ ูุทูุจูุง ุ ุณูููุญ ุงููุณุคูู ุญู ุงููุตูู ุฅูู ุนููุงู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ุงูุฎุงุต ุจูุง ููุท.  ุณูุญุชุงุฌ ุฃูุถูุง ุฅูู ุชุบููุฑ ูููุน ุชุฎุฒูู ูุนูููุงุช ุญุงูุฉ ุงููุณุคูู. </p><br><p style=";text-align:right;direction:rtl">  ูู ุงูููุช ุงูุญุงูู ุ ูุชู ุชุฎุฒูู ูุฐู ุงููุนูููุงุช ูู ุฑูุฒ ุชุนุฑูู (ูุณุชุฎุฏู ูุชูููุฑ ูุนูููุงุช ุญูู ุงููุณุชุฎุฏู) ุ ูููู ูุฌุจ ุงุณุชุฎุฏุงู ุฑูุฒ ูุตูู ูููุตูู ุฅูู ุงูููุงุฑุฏ ูู ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช.  ูุฌุจ ุฃู ูุจุฏู ุงูุฑูุฒ ุจุนุฏ ุงูุชุบููุฑุงุช ููุง ููู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">user, context, callback</span></span></span><span class="hljs-function">) </span></span>{ user.app_metadata = user.app_metadata || {}; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (user.email &amp;&amp; user.email === <span class="hljs-string"><span class="hljs-string">'${YOUR_EMAIL}'</span></span>) { user.app_metadata.roles = [<span class="hljs-string"><span class="hljs-string">'admin'</span></span>]; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { user.app_metadata.roles = [<span class="hljs-string"><span class="hljs-string">'user'</span></span>]; } auth0.users .updateAppMetadata(user.user_id, user.app_metadata) .then(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ context.accessToken[<span class="hljs-string"><span class="hljs-string">'http://localhost:3000/roles'</span></span>] = user.app_metadata.roles; callback(<span class="hljs-literal"><span class="hljs-literal">null</span></span>, user, context); }) .catch(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">err</span></span></span><span class="hljs-function">) </span></span>{ callback(err); }); }</code> </pre> <br><blockquote style=";text-align:right;direction:rtl">  ููุงุญุธุฉ: <code>${YOUR_EMAIL}</code> ุจุนููุงู ุจุฑูุฏู ุงูุฅููุชุฑููู.  ูู ุงูููู ุงูุฅุดุงุฑุฉ ุฅูู ุฃูู ุ ููุงุนุฏุฉ ุนุงูุฉ ุ ุนูุฏูุง ุชุชุนุงูู ูุน ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ูู ููุงุนุฏ Auth0 ุ ููู ุงููุซุงูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุฑุถ ุงูุชุญูู ูู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู</a> .  ูู ูุฐู ุงูุญุงูุฉ ุ ูุฐุง ุบูุฑ ูุทููุจ ูุฃููุง ูุณุชุฎุฏู ุนููุงู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ุงูุฎุงุต ุจูุง. <br><br>  ููุงุญุธุฉ ุงููุชุฑุฌู: ูุชู ุฅุฏุฎุงู ุฌุฒุก ุงูุดูุฑุฉ ุฃุนูุงู ูู ุงููุณุชุนุฑุถ ูู ุตูุญุฉ ุชูููู ูุงุนุฏุฉ Auth0 </blockquote><p style=";text-align:right;direction:rtl">  ููุชุญูู ููุง ุฅุฐุง ูุงู ุงูุฑูุฒ ุงููููุฒ ุงูุฐู ุชู ุชูุฑูุฑู ุฅูู API ูู ุฑูุฒ ุงููุณุคูู ุ ูุญุชุงุฌ ุฅูู ุฅูุดุงุก <em>ุญุงุฑุณ</em> Nest.js.  ูู ุงููุฌูุฏ <code>src/common</code> ุ ูู ุจุฅูุดุงุก ููู <code>admin.guard.ts</code> </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> import { Injectable, CanActivate, ExecutionContext } from '@nestjs/common'; @Injectable() export class AdminGuard implements CanActivate { canActivate(context: ExecutionContext): boolean { const user = context.getArgs()[0].user['http://localhost:3000/roles'] || ''; return user.indexOf('admin') &gt; -1; } }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุงูุขู ุ ุฅุฐุง <code>access_token</code> ุนูููุฉ ุชุณุฌูู ุงูุฏุฎูู ุงูููุถุญุฉ ุฃุนูุงู <code>access_token</code> ุนููุงู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ุงููุญุฏุฏ ูู ุงููุงุนุฏุฉ ุ <code>access_token</code> ุฌุฏูุฏ.  ููุชุญูู ูู ูุญุชููุงุช ูุฐุง <code>access_token</code> ุ ุงูุณุฎ ูุงูุตู ุงูุฑูุฒ ุงููููุฒ ูู ุงูุญูู <code>Encoded</code> ูููููุน <code>https://jwt.io/</code> .  ุณูุฑู ุฃู ูุณู ุงูุญูููุฉ ุงููุงูุนุฉ ููุฐุง ุงูุฑูุฒ ุงููููุฒ ูุญุชูู ุนูู ุงูุตููู ุงูุชุงูู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> "http://localhost:3000/roles": [ "admin" ]</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุฅุฐุง ูุงู ุฑูุฒูุง ูุชุถูู ูุฐู ุงููุนูููุงุช ุญููุง ุ ูุฅููุง ููุงุตู ุงูุชูุงูู ูุน Auth0.  ูุฐูู ุ ุงูุชุญ <code>items.controller.ts</code> ูุฃุถู ุงูุญุงุฑุณ ุงูุฌุฏูุฏ ุฅูู ููุงู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> import { Get, Post, Body, Controller, UsePipes, UseGuards, } from '@nestjs/common'; import { CreateItemDto } from './create-item.dto'; import { ItemsService } from './items.service'; import { Item } from './item.interface'; import { ValidationPipe } from '../common/validation.pipe'; import { AdminGuard } from '../common/admin.guard'; @Controller('items') export class ItemsController { constructor(private readonly itemsService: ItemsService) {} @Get() async findAll(): Promise&lt;Item[]&gt; { return this.itemsService.findAll(); } @Post() @UseGuards(new AdminGuard()) @UsePipes(new ValidationPipe()) async create(@Body() createItemDto: CreateItemDto) { this.itemsService.create(createItemDto); } }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุงูุขู ุ ูุน ุงูุฑูุฒ ุงููููุฒ ุงูุฌุฏูุฏ ุ ูููููุง ุฅุถุงูุฉ ุนูุงุตุฑ ุฌุฏูุฏุฉ ูู ุฎูุงู ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs"> <span class="hljs-comment"><span class="hljs-comment">#    npm run start:dev #  POST       curl -X POST -H 'Content-Type: application/json' \ -H 'authorization: Bearer '$TOKEN -d '{ "name": "Salad", "price": 3 }' http://localhost:3000/items</span></span></code> </pre> <br><blockquote style=";text-align:right;direction:rtl">  ููุงุญุธุฉ ุงููุชุฑุฌู: ููุชุญูู ุ ููููู ุฃู ุชุฑู ูุง ูุฏููุง ูู ุงูุนูุงุตุฑ: <br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">curl -X GET http://localhost:3000/items</code> </pre> <br></blockquote><br><h4 id="itogi" style=";text-align:right;direction:rtl">  ุงููุชุงุฆุฌ </h4><br><p style=";text-align:right;direction:rtl">  ุชูุงูููุง!  ููุฏ ุงูุชูููุง ููุชู ูู ุจูุงุก ูุงุฌูุฉ ุจุฑูุฌุฉ ุชุทุจููุงุช Nest.JS ุงูุฎุงุตุฉ ุจูุง ูุงูุขู ูููููุง ุงูุชุฑููุฒ ุนูู ุชุทููุฑ ุงูุฌุฒุก ุงูุฃูุงูู ูู ุชุทุจูููุง!  ุชุฃูุฏ ูู ุฅุทูุงุนู ุนูู ุงูุฌุฒุก ุงูุซุงูู ูู ูุฐู ุงูุณูุณูุฉ: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุชุทุจููุงุช Full-Stack TypeScript - ุงูุฌุฒุก 2: ุชุทููุฑ ุชุทุจููุงุช Frontend Angular.</a> </p><br><blockquote style=";text-align:right;direction:rtl">  ููุงุญุธุฉ ุงููุชุฑุฌู: ุชุฑุฌูุฉ ุงูุฌุฒุก ุงูุซุงูู ููุฏ ุงูุชูุฏู. </blockquote><p style=";text-align:right;direction:rtl">  ูุชูุฎูุต ุ ุงุณุชุฎุฏููุง ูู ูุฐู ุงูููุงูุฉ ููุฒุงุช ูุชููุนุฉ ูู Nest.js ู TypeScript: ุงููุญุฏุงุช ุงูููุทูุฉ ููุญุฏุงุช ุงูุชุญูู ูุงูุฎุฏูุงุช ูุงููุงุฌูุงุช ูุงูุฃูุงุจูุจ ูุงูุจุฑุงูุฌ ุงููุณูุทุฉ ูุงูุญุฑุงุณุฉ ูุฅูุดุงุก API.  ุฃุชููู ุฃู ุชููู ูุฏูู ุชุฌุฑุจุฉ ุฌูุฏุฉ ูุฃู ุชููู ูุณุชุนุฏูุง ูููุงุตูุฉ ุชุทููุฑ ุชุทุจูููุง.  ุฅุฐุง ูุงู ููุงู ุดูุก ุบูุฑ ูุงุถุญ ูู ุ ูุฅู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุซุงุฆู nest.js ุงูุฑุณููุฉ</a> ูู ูุตุฏุฑ ุฌูุฏ ุจุงูุฅุฌุงุจุงุช </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar471348/">https://habr.com/ru/post/ar471348/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar471336/index.html">Holivar. ุชุงุฑูุฎ Runet. ุงูุฌุฒุก 6. ุฃููุงู: ูุงููุฉ ุ ุงูุดุฑูุท ุ 282 ูุงูุตูููุฉ ุงููุณุงุฑ</a></li>
<li><a href="../ar471340/index.html">Drimsim ุถุฏ ูุงุชู 20 ุจุฑู ุฌููุฉ! ููู ูููุ</a></li>
<li><a href="../ar471342/index.html">ุฃููู ุฃูุงููููุง</a></li>
<li><a href="../ar471344/index.html">ูุฑุฉ ุฃุฎุฑู ุญูู ImmutableList ูู ุฌุงูุฉ</a></li>
<li><a href="../ar471346/index.html">ููุฎุต ุงูููุงุฏ ุงูุทุงุฒุฌุฉ ูู ุนุงูู ุงููุงุฌูุฉ ุงูุฃูุงููุฉ ููุฃุณุจูุน ุงููุงุถู ุฑูู 384 (7 - 13 ุฃูุชูุจุฑ 2019)</a></li>
<li><a href="../ar471350/index.html">ุงูููุฏุณุฉ ุงูุนูุณูุฉ ูููุถุฎูุงุช ุงูุชุดุบูููุฉ ููุฎูุถุฉ ุงูุถูุถุงุก ูู ุฌูุงุฒ ููุจููุชุฑ ุชูุซููู ูู ุนุงู 1969</a></li>
<li><a href="../ar471352/index.html">ูุชุงุจุฉ ุงูุนุฑูุถ ุงูุชูุฏูููุฉ ูู LaTeX</a></li>
<li><a href="../ar471358/index.html">ููููุฉ ูุชุงุจุฉ ุนูุฏ ุฐูู ูุน ุจูุซูู ุนูู ุงูุฃูุทูููุฌูุงุ ุงูุฌุฒุก 4: API ุงูุฃุตูู</a></li>
<li><a href="../ar471360/index.html">ุทุฑููุฉ ุงูุงุฒุฏูุงุฌูุฉ. 11 ุฃูุซูุฉ ูู ุชุตููู ICE</a></li>
<li><a href="../ar471364/index.html">ุฅุฏุงุฑุฉ ุงูุงุฎุชุจุงุฑ ุงูุขูู ูุน Telegram</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>