<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ค ๐ โ ุงูุชูุงุนู ุ ููุท ุงูุนูููุฉ โ๏ธ ๐ฉ ๐จ๐พโ๐</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ูุฐุง ุงููุต ุนุจุงุฑุฉ ุนู ุชุนุฏูู ูุฌุฒุก ูู ุฏููู ุฅุทุงุฑ ุนูู Hanami ูุฅุทุงุฑ Laravel. ูุง ุณุจุจ ุงูุงูุชูุงู ุจูุฐู ุงููุงุฏุฉ ุงููุนููุฉุ ูููุฑ ูุตููุง ุฎุทูุฉ ุจุฎุทูุฉ ูุน ุนุฑุถ ุชูุถูุญู ููุฃุดูุงุก ุง...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ุงูุชูุงุนู ุ ููุท ุงูุนูููุฉ</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/438052/" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl">  ูุฐุง ุงููุต ุนุจุงุฑุฉ ุนู ุชุนุฏูู ูุฌุฒุก ูู ุฏููู ุฅุทุงุฑ ุนูู Hanami ูุฅุทุงุฑ Laravel.  ูุง ุณุจุจ ุงูุงูุชูุงู ุจูุฐู ุงููุงุฏุฉ ุงููุนููุฉุ  ูููุฑ ูุตููุง ุฎุทูุฉ ุจุฎุทูุฉ ูุน ุนุฑุถ ุชูุถูุญู ููุฃุดูุงุก ุงูุดุงุฆุนุฉ ุงูุฎุงุตุฉ ุจูุบุงุช ุงูุจุฑูุฌุฉ ูุงูุฃุทุฑ ูุซู: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุจุงุณุชุฎุฏุงู ููุท ุงูุชูุงุนูุงุช. </li><li style=";text-align:right;direction:rtl">  ูุธุงูุฑุฉ TDD \ BDD. </li></ul><br><p style=";text-align:right;direction:rtl">  ุชุฌุฏุฑ ุงูุฅุดุงุฑุฉ ุฅูู ุฃู ูุฐู ููุณุช ูุฌุฑุฏ ุฃุทุฑ ุนูู ูุฎุชููุฉ ูุน ุฃูุฏููููุฌูุงุช ูุฎุชููุฉ (ุนูู ูุฌู ุงูุฎุตูุต ุ ูููุง ูุชุนูู ORM) ุ ูููู ุฃูุถูุง ูุบุงุช ุจุฑูุฌุฉ ูุฎุชููุฉ ุ ููู ูููุง ุซูุงูุชู ุงูุฎุงุตุฉ ู "ุฃูุถู ุงูููุงุฑุณุงุช" ุงูุฑุงุณุฎุฉ ูุฃุณุจุงุจ ุชุงุฑูุฎูุฉ.  ุชููู ูุบุงุช ูุฃุทุฑ ุงูุจุฑูุฌุฉ ุงููุฎุชููุฉ ุฅูู ุงุณุชุนุงุฑุฉ ุงูุญููู ุงูุฃูุซุฑ ูุฌุงุญูุง ูู ุจุนุถูุง ุงูุจุนุถ ุ ูุฐูู ุ ุนูู ุงูุฑุบู ูู ุงูุงุฎุชูุงูุงุช ูู ุงูุชูุงุตูู ุ ูุง ุชุฎุชูู ุงูุฃุดูุงุก ุงูุฃุณุงุณูุฉ ุ ูุง ูู ูุฃุฎุฐ ุจุงูุทุจุน PL ูุน ูููุฐุฌ ูุฎุชูู ูู ุงูุจุฏุงูุฉ.  ูู ุงููุซูุฑ ููุงูุชูุงู ุฃู ููุงุฑู ููู ูุชู ุญู ูุดููุฉ ูุงุญุฏุฉ ูููุณ ุงููุดููุฉ ูู ุฃูุธูุฉ ุจูุฆูุฉ ูุฎุชููุฉ. </p><br><p style=";text-align:right;direction:rtl">  ูุฐูู ุ ูู ุงูุจุฏุงูุฉ ูุฏููุง ุฅุทุงุฑ ุนูู ูุงูุงูู (ุฑูุจู) - ุฅุทุงุฑ ุฌุฏูุฏ ุฅูู ุญุฏ ูุง ููุฌุฐุจ ุฃูุซุฑ ุฃูุฏููููุฌููุง ุฅูู Symfony ุ ูุน ORM "ุนูู ุงููุณุชูุฏุนุงุช".  ูุงููุฏู ุงููุฏู Laravel \ Lumen (php) ูุน ุงูุณุฌู ุงููุดุท. </p><a name="habracut"></a><br><p style=";text-align:right;direction:rtl">  ูู ุนูููุฉ ุงูุชููู ุ ุชู ูุทุน ุงูุฒูุงูุง ุงูุฃูุซุฑ ุญุฏุฉ: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุชู ุญุฐู ุงูุฌุฒุก ุงูุฃูู ูู ุงูุฏููู ุจุชููุฆุฉ ุงููุดุฑูุน ููุตููุง ูููุฒุงุช ุงูุฅุทุงุฑ ูุฃุดูุงุก ูุญุฏุฏุฉ ููุงุซูุฉ. </li><li style=";text-align:right;direction:rtl">  ูุชู ุณุญุจ ORM Eloquent ุนูู ุงููุฑุฉ ุงูุฃุฑุถูุฉ ููุนูู ุฃูุถูุง ููุณุชูุฏุน. </li><li style=";text-align:right;direction:rtl">  ุฎุทูุงุช ูุฅูุดุงุก ุฑูุฒ ูููุงูุจ ูุฅุฑุณุงู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู. </li></ul><br><p style=";text-align:right;direction:rtl">  ุชู ุงูุญูุธ ูุงูุชุฃููุฏ ุนูู: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุงููุชูุงุนูุงุช - ุชู ุฅุฌุฑุงุก ุชุทุจูู ููุงุณุจ ุนูู ุงููุงุฌูุฉ. </li><li style=";text-align:right;direction:rtl">  ุงุฎุชุจุงุฑุงุช ุ ุฎุทูุฉ ุจุฎุทูุฉ ุงูุชูููุฉ ูู ุฎูุงู TDD. </li></ul><br><p style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุฌุฒุก ุงูุฃูู ูู ุงูุจุฑูุงูุฌ ุงูุชุนูููู Hanami ุงูุฃุตูู ุ ูุงูุฐู ุณูุชู ุงูุฑุฌูุน ุฅููู ูู ุงููุต ุฃุฏูุงู.</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงููุต ุงูุชุนูููู ุงูุชูุงุนูู ุงูุฃุตูู</a> <br>  ุฑุจุท ุฅูู ูุณุชูุฏุน ูุน ุฑูุฒ php ุชูููููุง ูู ููุงูุฉ ุงููุต. </p><br><h3 id="interaktory" style=";text-align:right;direction:rtl">  ุงูุชูุงุนูุงุช </h3><br><h4 id="novaya-ficha-uvedomleniya-po-elektronnoy-pochte" style=";text-align:right;direction:rtl">  ููุฒุฉ ุฌุฏูุฏุฉ: ุฅุฎุทุงุฑุงุช ุงูุจุฑูุฏ ุงูุฅููุชุฑููู </h4><br><p style=";text-align:right;direction:rtl">  ุณููุงุฑูู ุงูููุฒุงุช: ููุณุคูู ุ ุนูุฏูุง ุฃุถูู ูุชุงุจูุง ุ ุฃุฑุบุจ ูู ุชููู ุฅุนูุงูุงุช ุจุงูุจุฑูุฏ ุงูุฅููุชุฑููู. </p><br><p style=";text-align:right;direction:rtl">  ูุธุฑูุง ูุฃู ุงูุชุทุจูู ูุง ูุญุชูู ุนูู ูุตุงุฏูุฉ ุ ูููู ูุฃู ุดุฎุต ุฅุถุงูุฉ ูุชุงุจ ุฌุฏูุฏ.  ุณูุญุฏุฏ ุนููุงู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ูููุณุคูู ูู ุฎูุงู ูุชุบูุฑุงุช ุงูุจูุฆุฉ. </p><br><p style=";text-align:right;direction:rtl">  ูุฐุง ูุฌุฑุฏ ูุซุงู ููุถุญ ููุช ุงุณุชุฎุฏุงู ุงููุชูุงุนููู ุ ูุฎุงุตุฉ ููููุฉ ุงุณุชุฎุฏุงู ุงููุชูุงุนู Hanami. </p><br><p style=";text-align:right;direction:rtl">  <em>ูููู ุฃู ูููู ูุฐุง ุงููุซุงู ุจูุซุงุจุฉ ุฃุณุงุณ ููุธุงุฆู ุฃุฎุฑู ุ ูุซู ุชุฃููุฏ ุงููุณุคูู ูููุชุจ ุงูุฌุฏูุฏุฉ ูุจู ูุดุฑูุง.</em>  <em>ุฃู ููุญ ุงููุณุชุฎุฏููู ุงููุฏุฑุฉ ุนูู ุชุญุฏูุฏ ุนููุงู ุจุฑูุฏ ุฅููุชุฑููู ูุชุญุฑูุฑ ุงููุชุงุจ ูู ุฎูุงู ุฑุงุจุท ุฎุงุต.</em> </p><br><p style=";text-align:right;direction:rtl">  ูู ุงูููุงุฑุณุฉ ุงูุนูููุฉ ุ ููููู ุงุณุชุฎุฏุงู ุงููุชูุงุนููู ูุชูููุฐ ุฃู ููุทู ุฃุนูุงู ูุณุชุฎูุต ูู ุทุจูุฉ ุงูุดุจูุฉ.  ูุฐุง ูููุฏ ุจุดูู ุฎุงุต ุนูุฏูุง ุชุฑูุฏ ุงูุฌูุน ุจูู ุนุฏุฉ ุฃุดูุงุก ูู ุฃุฌู ุงูุชุญูู ูู ุชุนููุฏ ูุงุนุฏุฉ ุงูุดูุฑุฉ. </p><br><p style=";text-align:right;direction:rtl">  ูุชู ุงุณุชุฎุฏุงููุง ูุนุฒู ููุทู ุงูุฃุนูุงู ุบูุฑ ุงูุชุงููุฉ ุจุงุชุจุงุน ูุจุฏุฃ ุงููุณุคูููุฉ ุงููุฑุฏูุฉ. </p><br><p style=";text-align:right;direction:rtl">  ูู ุชุทุจููุงุช ุงูููุจ ุ ูุชู ุงุณุชุฎุฏุงููุง ุนุงุฏุฉู ูู ุฎูุงู ุฅุฌุฑุงุกุงุช ุงูุชุญูู.  ูุจูุฐู ุงูุทุฑููุฉ ุชููู ุจูุตู ุงูููุงู ุ ููุงุฆูุงุช ููุทู ุงูุฃุนูุงู ุ ูุงููุชูุงุนููู ุ ููู ูุง ูุนุฑููู ุดูุฆูุง ุนู ุทุจูุฉ ุดุจูุฉ ุงูุชุทุจูู. </p><br><h4 id="kolbeki-oni-nam-ne-nuzhny" style=";text-align:right;direction:rtl">  ุงูุงุณุชุฑุฌุงุนุงุชุ  ูุญู ูุณูุง ุจุญุงุฌุฉ ููู! </h4><br><p style=";text-align:right;direction:rtl">  ุฃุณูู ุทุฑููุฉ ูุชูููุฐ ุฅุดุนุงุฑ ุจุฑูุฏ ุฅููุชุฑููู ูู ุฅุถุงูุฉ ุฑุฏ ุงุชุตุงู. </p><br><p style=";text-align:right;direction:rtl">  ุฃู ุจุนุฏ ุฅูุดุงุก ุฅุฏุฎุงู ูุชุงุจ ุฌุฏูุฏ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุ ูุชู ุฅุฑุณุงู ุจุฑูุฏ ุฅููุชุฑููู. </p><br><p style=";text-align:right;direction:rtl">  ูู ุงููุงุญูุฉ ุงููุนูุงุฑูุฉ ุ ูุง ูููุฑ ูุงูุงูู ูุซู ูุฐู ุงูุขููุฉ.  ูุฐุง ูุฃููุง ูุนุชุจุฑ ุนูููุงุช ุงูุงุณุชุฑุฌุงุนุงุช ุงููููุฐุฌูุฉ ููุทูุง ูุถุงุฏูุง ููููุท.  ุฃููุง ุชูุชูู ูุจุฏุฃ ุงููุณุคูููุฉ ูุญุฏูุง.  ูู ุญุงูุชูุง ุ ูููููู ุจุฎูุท ุทุจูุฉ ุงูุซุจุงุช ุจุดูู ุบูุฑ ุตุญูุญ ูุน ุฅุดุนุงุฑุงุช ุงูุจุฑูุฏ ุงูุฅููุชุฑููู. </p><br><p style=";text-align:right;direction:rtl">  ุฃุซูุงุก ุงูุงุฎุชุจุงุฑ (ูุนูู ุงูุฃุฑุฌุญ ูู ุจุนุถ ุงูุญุงูุงุช ุงูุฃุฎุฑู) ุ ุณุชุญุชุงุฌ ุฅูู ุชุฎุทู ุฑุฏ ุงูุงุชุตุงู.  ูุฐุง ูุฑุจููุง ุจุณุฑุนุฉ ุ ุญูุซ ูููู ุชุดุบูู ุนูููุงุช ุฑุฏ ุงูุงุชุตุงู ุงููุชุนุฏุฏุฉ ูุญุฏุซ ูุงุญุฏ ุจุชุฑุชูุจ ูุนูู.  ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ููููู ุชุฎุทู ุจุนุถ ุนูููุงุช ุงูุงุณุชุฑุฌุงุนุงุช.  ุชุฌุนู ุนูููุงุช ุงูุงุณุชุฑุฌุงุนุงุช ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ูุดุฉ ููุตุนุจ ููููุง. </p><br><p style=";text-align:right;direction:rtl">  ุจุฏูุงู ูู ุฐูู ุ ููุตู ุตุฑุงุญุฉ ุจุฏูุงู ูู ุถููู. </p><br><p style=";text-align:right;direction:rtl">  ุงููุชูุงุนู ูู ูุงุฆู ููุซู ุญุงูุฉ ุงุณุชุฎุฏุงู ูุญุฏุฏุฉ. </p><br><p style=";text-align:right;direction:rtl">  ุฃููุง ุชุณูุญ ููู ูุฆุฉ ุฃู ุชุชุญูู ูุณุคูููุฉ ูุงุญุฏุฉ.  ูุณุคูููุฉ ุงููุชูุงุนู ุงููุญูุฏ ูู ุงูุฌูุน ุจูู ูุงุฆูุงุช ูุทุฑููุฉ ุฏุนูุงุช ูุชุญููู ูุชูุฌุฉ ูุญุฏุฏุฉ. </p><br><h4 id="ideya" style=";text-align:right;direction:rtl">  ููุฑุฉ </h4><br><p style=";text-align:right;direction:rtl">  ุชุชูุซู ุงูููุฑุฉ ุงูุฑุฆูุณูุฉ ูููุชูุงุนููู ูู ุงุณุชุฎุฑุงุฌ ุงูุฃุฌุฒุงุก ุงููุนุฒููุฉ ูู ุงููุธููุฉ ุฅูู ูุตู ุฌุฏูุฏ. </p><br><p style=";text-align:right;direction:rtl"> ูุฌุจ ุฃู ุชูุชุจ ุทุฑููุชูู <code>__construct</code> ููุท: <code>__construct</code> <code>call</code> . <br>  <em>ูู ุชุทุจูู php <code>__invoke</code> ุ <code>__invoke</code> ุทุฑููุฉ ุงูุงุชุตุงู ุนูู ุงููุนุฏู ุงููุญูู ูุชุณูู ุนุจุฑ <code>__invoke</code> .</em> </p><br><p style=";text-align:right;direction:rtl">  ูุฐุง ูุนูู ุฃู ูุซู ูุฐู ุงูุฃุดูุงุก ุณููุฉ ุงูุชูุณูุฑ ุ ุญูุซ ูุง ููุฌุฏ ุณูู ุทุฑููุฉ ูุงุญุฏุฉ ูุชุงุญุฉ ูุงุณุชุฎุฏุงููุง. </p><br><p style=";text-align:right;direction:rtl">  ุฅู ุชุบููู ุงูุณููู ูู ูุงุฆู ูุงุญุฏ ูุฌุนู ูู ุงูุณูู ุงุฎุชุจุงุฑู.  ููุง ุฃูู ูุฌุนู ูู ุงูุฃุณูู ููู ูุงุนุฏุฉ ุงูููุฏ ุงูุฎุงุตุฉ ุจู ุ ูููุณ ููุท ุชุฑู ุงูุชุนููุฏ ุงูุฎูู ุถููููุง. </p><br><h4 id="podgotovka" style=";text-align:right;direction:rtl">  ุงูุชุญุถูุฑ </h4><br><p style=";text-align:right;direction:rtl">  ูููุชุฑุถ ุฃู ูุฏููุง ุชุทุจูู Bookshelf " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุจุฏุก ุงูุงุณุชุฎุฏุงู</a> " ุ ููุฑูุฏ ุฅุถุงูุฉ ููุฒุฉ "ุฅุดุนุงุฑ ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ูููุชุงุจ ุงูููุถุงู". </p><br><h4 id="pishem-interaktor" style=";text-align:right;direction:rtl">  ูุชุงุจุฉ ุงููุชูุงุนู </h4><br><p style=";text-align:right;direction:rtl">  ูููู ุจุฅูุดุงุก ูุฌูุฏ ูููุชูุงุนููู ูุฏููุง ููุฌูุฏ ูุงุฎุชุจุงุฑุงุชูู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">$ mkdir lib/bookshelf/interactors $ mkdir tests/bookshelf/interactors</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุถุนูุง ูู <code>lib/bookshelf</code> ูุฃููุง ููุณุช ุฐุงุช ุตูุฉ ุจุชุทุจูู ุงูููุจ.  ููููู ุฅุถุงูุฉ ูุชุจ ูุงุญููุง ูู ุฎูุงู ุจูุงุจุฉ ุงููุดุฑู ุฃู ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช ุฃู ุญุชู ุฃุฏุงุฉ ูุณุงุนุฏุฉ ูุณุทุฑ ุงูุฃูุงูุฑ. </p><br><p style=";text-align:right;direction:rtl">  ุฃุถู <code>AddBook</code> ูุงูุชุจ <code>tests/bookshelf/interactors/AddBookTest.php</code> ุงุฎุชุจุงุฑ ุฌุฏูุฏุฉ <code>tests/bookshelf/interactors/AddBookTest.php</code> : </p><br><pre style=";text-align:right;direction:rtl"> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment"># tests/bookshelf/interactors/AddBookTest.php &lt;?php use Lib\Bookshelf\Interactors\AddBook; class AddBookTest extends TestCase { private function interactor() { return $this-&gt;app-&gt;make(AddBook::class); } private function bookAttributes() { return [ "author" =&gt; "James Baldwin", 'title' =&gt; "The Fire Next Time", ]; } private function subjectCall() { return $this-&gt;interactor()($this-&gt;bookAttributes()); } public function testSucceeds() { $result = $this-&gt;subjectCall(); $this-&gt;assertTrue($result-&gt;successful()); } }</span></span></code> </pre><br><p style=";text-align:right;direction:rtl">  ุชุดุบูู ูุฌููุนุฉ ุงุฎุชุจุงุฑ <code>AddBook</code> ุงููุตู ุงูุฏุฑุงุณู <code>Class does not exist</code> ุจุณุจุจ ุนุฏู ูุฌูุฏ ูุฆุฉ ูู <code>AddBook</code> .  ูููู ุจุฅูุดุงุก ูุฐู ุงููุฆุฉ ูู ููู <code>lib/bookshelf/interactors/AddBook.php</code> : </p><br><pre style=";text-align:right;direction:rtl"> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">Lib</span></span>\<span class="hljs-title"><span class="hljs-title">Bookshelf</span></span>\<span class="hljs-title"><span class="hljs-title">Interactors</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Lib</span></span>\<span class="hljs-title"><span class="hljs-title">Interactor</span></span>\<span class="hljs-title"><span class="hljs-title">Interactor</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AddBook</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Interactor</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__construct</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ } <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">call</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ } }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ููุงู ุทุฑููุชุงู ููุท ูุฌุจ ุฃู <code>__construct</code> ูุฐู ุงููุฆุฉ: <code>__construct</code> ูุฅุนุฏุงุฏ ุงูุจูุงูุงุช <code>call</code> ูุชุทุจูู ุงูุจุฑูุงูุฌ ุงููุตู. </p><br><p style=";text-align:right;direction:rtl">  ูุฌุจ ุฃู ุชุณุชุฏุนู ูุฐู ุงูุทุฑู ุ ุฎุงุตุฉู <code>call</code> ุ ุงูุฃุณุงููุจ ุงูุฎุงุตุฉ ุงูุชู ุชูุชุจูุง. </p><br><p style=";text-align:right;direction:rtl">  ุจุดูู ุงูุชุฑุงุถู ุ ุชุนุชุจุฑ ุงููุชูุฌุฉ ูุงุฌุญุฉ ุ ูุฃููุง ูู ููุถุญ ุตุฑุงุญุฉ ูุดู ุงูุนูููุฉ. </p><br><p style=";text-align:right;direction:rtl">  ุฏุนูุง ูุฌุฑู ุงูุงุฎุชุจุงุฑ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">$ phpunit</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุฌุจ ุฃู ุชูุฑ ุฌููุน ุงูุงุฎุชุจุงุฑุงุช! </p><br><p style=";text-align:right;direction:rtl">  ุงูุขู ุ ุฏุนููุง ูุฌุนู <code>AddBook</code> ูุฏููุง ููุนู ุดูุฆูุง ุญููุง! </p><br><h3 id="sozdanie-knigi" style=";text-align:right;direction:rtl">  ุฎูู ูุชุงุจ </h3><br><p style=";text-align:right;direction:rtl">  ุชุบููุฑ <code>tests/bookshelf/interactors/AddBookTest.php</code> : </p><br><pre style=";text-align:right;direction:rtl"> <code class="php hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">testCreateBook</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ $result = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;subjectCall(); <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;assertEquals(<span class="hljs-string"><span class="hljs-string">"The Fire Next Time"</span></span>, $result-&gt;book-&gt;title); <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;assertEquals(<span class="hljs-string"><span class="hljs-string">"James Baldwin"</span></span>, $result-&gt;book-&gt;author); }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุฅุฐุง <code>phpunit</code> ุงุฎุชุจุงุฑุงุช <code>phpunit</code> ุ ูุณุชุฑู ุฎุทุฃ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">Exception: Undefined property Lib\Interactor\InteractorResult::$book</code> </pre> <br><p style=";text-align:right;direction:rtl">  ููููุฃ ููุงุนููุง ุ ุซู ุงุดุฑุญ ูุง ูุนููุงู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">Lib</span></span>\<span class="hljs-title"><span class="hljs-title">Bookshelf</span></span>\<span class="hljs-title"><span class="hljs-title">Interactors</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Lib</span></span>\<span class="hljs-title"><span class="hljs-title">Interactor</span></span>\<span class="hljs-title"><span class="hljs-title">Interactor</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Lib</span></span>\<span class="hljs-title"><span class="hljs-title">Bookshelf</span></span>\<span class="hljs-title"><span class="hljs-title">Book</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AddBook</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Interactor</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> $expose = [<span class="hljs-string"><span class="hljs-string">"book"</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> $book = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__construct</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ } <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">call</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($bookAttributes)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;book = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Book($bookAttributes); } }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุดูุฆุงู ูููุงู ูุฌุจ ููุงุญุธุชููุง ููุง: </p><br><p style=";text-align:right;direction:rtl">  String <code>protected static $expose = ["book"];</code>  ูุถูู ุฎุงุตูุฉ <code>book</code> ุฅูู ูุงุฆู ุงููุชูุฌุฉ ุงูุฐู ุณูุชู ุฅุฑุฌุงุนู ุนูุฏ ุงุณุชุฏุนุงุก ุงููุชูุงุนู. </p><br><p style=";text-align:right;direction:rtl">  ุชุนููู ุทุฑููุฉ <code>call</code> ุทุฑุงุฒ <code>Book</code> ุฅูู ุฎุงุตูุฉ <code>book</code> ุ ูุงูุชู ุณุชููู ูุชุงุญุฉ ููุชูุฌุฉ ูุฐูู. </p><br><p style=";text-align:right;direction:rtl">  ุงูุขู ูุฌุจ ุฃู ุชูุฑ ุงูุงุฎุชุจุงุฑุงุช. </p><br><p style=";text-align:right;direction:rtl">  ููุฏ ูููุง ุจุชููุฆุฉ ูููุฐุฌ <code>Book</code> ุ ููู ูู ูุชู ุชุฎุฒููู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช. </p><br><h4 id="sohranenie-knigi" style=";text-align:right;direction:rtl">  ุญูุธ ุงููุชุงุจ </h4><br><p style=";text-align:right;direction:rtl">  ูุฏููุง ูุชุงุจ ุฌุฏูุฏ ุ ุชู ุงูุญุตูู ุนููู ูู ุงูุนููุงู ูุงููุคูู ุ ูููู ูู ูุฏุฎู ุจุนุฏ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช. </p><br><p style=";text-align:right;direction:rtl">  ูุญู ุจุญุงุฌุฉ ุฅูู ุงุณุชุฎุฏุงู <code>BookRepository</code> ูุฏููุง ูุญูุธู. </p><br><pre style=";text-align:right;direction:rtl"> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">// tests/bookshelf/interactors/AddBookTest.php public function testPersistsBook() { $result = $this-&gt;subjectCall(); $this-&gt;assertNotNull($result-&gt;book-&gt;id); }</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ุฅุฐุง ููุช ุจุฅุฌุฑุงุก ุงูุงุฎุชุจุงุฑุงุช ุ ุณุชุฑู ุฎุทุฃู ุฌุฏูุฏุงู ูู ุงูุฑุณุงูุฉ " <code>Failed asserting that null is not null</code> . </p><br><p style=";text-align:right;direction:rtl">  ูุฐุง ูุฃู ุงููุชุงุจ ุงูุฐู ุฃูุดุฃูุงู ููุณ ูู ูุนุฑู ุ ูุฃูู ูู ูุณุชููู ุฅูุง ุนูุฏูุง ูุชู ุญูุธู. </p><br><p style=";text-align:right;direction:rtl">  ููู ููุฌุญ ุงูุงุฎุชุจุงุฑ ุ ูุญุชุงุฌ ุฅูู ุฅูุดุงุก ูุชุงุจ ูุญููุธ.  ููุงู ุทุฑููุฉ ุฃุฎุฑู ููุณุช ุฃูู ุตุญุฉ ููู ุญูุธ ุงููุชุงุจ ุงูุฐู ูุฏููุง ุจุงููุนู. </p><br><p style=";text-align:right;direction:rtl">  ูู ุจุชุญุฑูุฑ ุทุฑููุฉ <code>call</code> ูู <code>lib/bookshelf/interactors/AddBook.php</code> : </p><br><pre style=";text-align:right;direction:rtl"> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">call</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($bookAttributes)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;book = Book::create($bookAttributes); }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุจุฏูุงู ูู ุงุณุชุฏุนุงุก <code>new Book</code> ุ ูููู <code>Book::create</code> ุจุณูุงุช ุงููุชุงุจ. </p><br><p style=";text-align:right;direction:rtl">  ูุง ุชุฒุงู ุงูุทุฑููุฉ ุชูุฑุฌุน ุงููุชุงุจ ุ ููุง ุชุญูุธ ูุฐุง ุงูุณุฌู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช. </p><br><p style=";text-align:right;direction:rtl">  ุฅุฐุง ููุช ุจุฅุฌุฑุงุก ุงูุงุฎุชุจุงุฑุงุช ุงูุขู ุ ุณุชุฑู ุฃู ุฌููุน ุงูุงุฎุชุจุงุฑุงุช ุชูุฑ. </p><br><h4 id="vnedrenie-zavisimostey-dependency-injection" style=";text-align:right;direction:rtl">  ุญูู ุงูุชุจุนูุฉ </h4><br><p style=";text-align:right;direction:rtl">  ุฏุนููุง refactor ูุงุณุชุฎุฏุงู ุญูู ุงูุชุจุนูุฉ. </p><br><p style=";text-align:right;direction:rtl">  ูุง ุชุฒุงู ุงูุงุฎุชุจุงุฑุงุช ุชุนูู ุ ููููุง ุชุนุชูุฏ ุนูู ููุฒุงุช ุงูุญูุธ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช (ูุชู ุชุญุฏูุฏ ุฎุงุตูุฉ ุงููุนุฑู ุจุนุฏ ุงูุญูุธ ุงููุงุฌุญ).  ูุฐู ูู ุชูุงุตูู ุงูุชูููุฐ ูููููุฉ ุนูู ุงูุญูุธ.  ุนูู ุณุจูู ุงููุซุงู ุ ุฅุฐุง ููุช ุชุฑุบุจ ูู ุฅูุดุงุก UUID ูุจู ุญูุธู ูุงูุฅุดุงุฑุฉ ุฅูู ุฃู ุงูุญูุธ ูุงู ูุงุฌุญูุง ุจุทุฑููุฉ ุฃุฎุฑู ุบูุฑ ููุก ุนููุฏ ุงููุนุฑู ุ ูุณูุชุนูู ุนููู ุชุบููุฑ ูุฐุง ุงูุงุฎุชุจุงุฑ. </p><br><p style=";text-align:right;direction:rtl">  ูููููุง ุชุนุฏูู ุงุฎุชุจุงุฑูุง ูุงููุชูุงุนู ูุฌุนูู ุฃูุซุฑ ููุซูููุฉ: ุณูููู ุฃูู ุนุฑุถุฉ ูููุณุฑ ุจุณุจุจ ุงูุชุบููุฑุงุช ุฎุงุฑุฌ ูููู. </p><br><p style=";text-align:right;direction:rtl">  ุฅููู ููููุฉ ุงุณุชุฎุฏุงู ุญูู ุงูุชุจุนูุฉ ูู ุงูุชูุงุนู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">// lib/bookshelf/interactors/AddBook.php public function __construct(Book $repository) { $this-&gt;repository = $repository; } protected function call($bookAttributes) { $this-&gt;book = $this-&gt;repository-&gt;create($bookAttributes); }</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ูู ุงูุฃุณุงุณ ุ ูุฐุง ูู ููุณู ุ ูุน ุฑูุฒ ุฃูุซุฑ ููููุงู ุ ูุฅูุดุงุก ุฎุงุตูุฉ <code>repository</code> . </p><br><p style=";text-align:right;direction:rtl">  ูู ุงูููุช ุงูุญุงูู ุ ูุชุญูู ุงูุงุฎุชุจุงุฑ ูู ุณููู ุทุฑููุฉ <code>create</code> ููุชุฃูุฏ ูู ุฃู ูุนุฑูู ูููุก ุจู <code>$this-&gt;assertNotNull($result-&gt;book-&gt;id)</code> . </p><br><p style=";text-align:right;direction:rtl">  ูุฐู ูู ุชูุงุตูู ุงูุชูููุฐ. </p><br><p style=";text-align:right;direction:rtl">  ุจุฏูุงู ูู ุฐูู ุ ูููููุง ุชุนุฏูู ุงูุงุฎุชุจุงุฑ ููุชุฃูุฏ ููุท ูู ุงุณุชุฏุนุงุก ุทุฑููุฉ <code>create</code> ุนูู ุงููุณุชูุฏุน ุ ูุงูุซูุฉ ูู ุฃู ุงููุณุชูุฏุน ุณูุญูุธ ุงููุงุฆู (ูุฃู ูุฐุง ูู ูุณุคูููุชู). </p><br><p style=";text-align:right;direction:rtl">  ุฏุนูุง ูุบูุฑ ุงุฎุชุจุงุฑ <code>testPersistsBook</code> : </p><br><pre style=";text-align:right;direction:rtl"> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">// tests/bookshelf/interactors/AddBookTest.php public function testPersistsBook() { $repository = Mockery::mock(Book::class); $this-&gt;app-&gt;instance(Book::class, $repository); $attributes = [ "author" =&gt; "James Baldwin", 'title' =&gt; "The Fire Next Time", ]; $repository-&gt;expects()-&gt;create($attributes); $this-&gt;subjectCall($attributes); }</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ุงูุขู ุงุฎุชุจุงุฑูุง ูุง ููุชูู ุญุฏูุฏ ููุทูุชู. </p><br><p style=";text-align:right;direction:rtl">  ูู ูุง ูุนููุงู ูู ุฅุถุงูุฉ ุงูุชุจุนูุฉ ูููุชูุงุนู ุนูู ุงููุณุชูุฏุน. </p><br><h4 id="uvedomlenie-na-elektronnuyu-pochtu" style=";text-align:right;direction:rtl">  ุฅุดุนุงุฑ ุงูุจุฑูุฏ ุงูุฅููุชุฑููู </h4><br><p style=";text-align:right;direction:rtl">  ุฏุนููุง ูุถูู ุฅุดุนุงุฑ ุงูุจุฑูุฏ ุงูุฅููุชุฑููู! </p><br><p style=";text-align:right;direction:rtl">  <em>ููููู ุฃูุถูุง ุงูููุงู ุจุฃู ุดูุก ููุง ุ ุนูู ุณุจูู ุงููุซุงู ุ ุฅุฑุณุงู ุฑุณุงูุฉ ูุตูุฉ ูุตูุฑุฉ ุฃู ุฅุฑุณุงู ุฑุณุงูุฉ ุฏุฑุฏุดุฉ ุฃู ุชูุดูุท ุฑุจุท ุงูููุจ.</em> </p><br><p style=";text-align:right;direction:rtl">  ุณูุชุฑู ูุต ุงูุฑุณุงูุฉ ูุงุฑุบูุง ุ ูููู ูู ุญูู ุงูููุถูุน ุณูุดูุฑ ุฅูู "ุฅุถุงูุฉ ูุชุงุจ!". </p><br><p style=";text-align:right;direction:rtl">  ุฅูุดุงุก <code>tests/bookshelf/mail/BookAddedNotificationTest.php</code> ุงุฎุชุจุงุฑ ุงูุฅุฎุทุงุฑ <code>tests/bookshelf/mail/BookAddedNotificationTest.php</code> : </p><br><pre style=";text-align:right;direction:rtl"> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Lib</span></span>\<span class="hljs-title"><span class="hljs-title">Bookshelf</span></span>\<span class="hljs-title"><span class="hljs-title">Mail</span></span>\<span class="hljs-title"><span class="hljs-title">BookAddedNotification</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Illuminate</span></span>\<span class="hljs-title"><span class="hljs-title">Support</span></span>\<span class="hljs-title"><span class="hljs-title">Facades</span></span>\<span class="hljs-title"><span class="hljs-title">Mail</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BookAddedNotificationTest</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TestCase</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setUp</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">parent</span></span>::setUp(); Mail::fake(); <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;mail = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BookAddedNotification(); } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">testCorrectAttributes</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;mail-&gt;build(); <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;assertEquals(<span class="hljs-string"><span class="hljs-string">'no-reply@example.com'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;mail-&gt;from[<span class="hljs-number"><span class="hljs-number">0</span></span>][<span class="hljs-string"><span class="hljs-string">'address'</span></span>]); <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;assertEquals(<span class="hljs-string"><span class="hljs-string">'admin@example.com'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;mail-&gt;to[<span class="hljs-number"><span class="hljs-number">0</span></span>][<span class="hljs-string"><span class="hljs-string">'address'</span></span>]); <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;assertEquals(<span class="hljs-string"><span class="hljs-string">'Book added!'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;mail-&gt;subject); } }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุฃุถู ูุฆุฉ ุงูุฅุดุนุงุฑุงุช <code>lib/Bookshelf/Mail/BookAddedNotification.php</code> : </p><br><pre style=";text-align:right;direction:rtl"> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">Lib</span></span>\<span class="hljs-title"><span class="hljs-title">Bookshelf</span></span>\<span class="hljs-title"><span class="hljs-title">Mail</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Illuminate</span></span>\<span class="hljs-title"><span class="hljs-title">Mail</span></span>\<span class="hljs-title"><span class="hljs-title">Mailable</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Illuminate</span></span>\<span class="hljs-title"><span class="hljs-title">Queue</span></span>\<span class="hljs-title"><span class="hljs-title">SerializesModels</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BookAddedNotification</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Mailable</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">SerializesModels</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">build</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;from(<span class="hljs-string"><span class="hljs-string">'no-reply@example.com'</span></span>) -&gt;to(<span class="hljs-string"><span class="hljs-string">'admin@example.com'</span></span>) -&gt;subject(<span class="hljs-string"><span class="hljs-string">'Book added!'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;view(<span class="hljs-string"><span class="hljs-string">'emails.book_added_notification'</span></span>); } }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุงูุขู ูู ุงุฎุชุจุงุฑุงุชูุง ุชูุฑ! </p><br><p style=";text-align:right;direction:rtl">  ููู ุงูุฅุฎุทุงุฑ ูู ูุชู ุฅุฑุณุงูู ุจุนุฏ.  ูุญู ุจุญุงุฌุฉ ุฅูู ุงูุงุชุตุงู ุจุฅุฑุณุงู ูู ุงูุชูุงุนู <code>AddBook</code> ูุฏููุง. </p><br><p style=";text-align:right;direction:rtl">  <code>AddBook</code> ุงุฎุชุจุงุฑ <code>AddBook</code> ููุชุฃูุฏ ูู ุฃูู ุณูุชู ุงุณุชุฏุนุงุก <code>AddBook</code> ุงูุจุฑูุฏ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">testSendMail</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ Mail::fake(); <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;subjectCall(); Mail::assertSent(BookAddedNotification::class, <span class="hljs-number"><span class="hljs-number">1</span></span>); }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุฅุฐุง ุฃุฌุฑููุง ุงูุงุฎุชุจุงุฑุงุช ุ ููุฏ ุญุตููุง ุนูู ุงูุฎุทุฃ: <code>The expected [Lib\Bookshelf\Mail\BookAddedNotification] mailable was sent 0 times instead of 1 times.</code>  . </p><br><p style=";text-align:right;direction:rtl">  ูุญู ุงูุขู ุฏูุฌ ุงูุฅุฎุทุงุฑ ุฅุฑุณุงู ูู ุงูุชูุงุนู. </p><br><pre style=";text-align:right;direction:rtl"> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__construct</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Book $repository, BookAddedNotification $mail)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;repository = $repository; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;mail = $mail; } <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">call</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($bookAttributes)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;book = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;repository-&gt;create($bookAttributes); Mail::send(<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;mail); }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุชูุฌุฉ ูุฐูู ุ ุณูุฑุณู ุงููุชูุงุนู ุฅุดุนุงุฑูุง ุญูู ุฅุถุงูุฉ ุงููุชุงุจ ุฅูู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู. </p><br><h4 id="integraciya-s-kontrollerom" style=";text-align:right;direction:rtl">  ุงูุชูุงูู ุชุญูู </h4><br><p style=";text-align:right;direction:rtl">  ุฃุฎูุฑูุง ุ ูุญุชุงุฌ ุฅูู ุงุณุชุฏุนุงุก ุงููุชูุงุนู ูู ุงูุฅุฌุฑุงุก. </p><br><p style=";text-align:right;direction:rtl">  ุชุญุฑูุฑ <code>app/Http/Controllers/BooksCreateController.php</code> ููู ุงูุฅุฌุฑุงุก <code>app/Http/Controllers/BooksCreateController.php</code> : </p><br><pre style=";text-align:right;direction:rtl"> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">App</span></span>\<span class="hljs-title"><span class="hljs-title">Http</span></span>\<span class="hljs-title"><span class="hljs-title">Controllers</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Lib</span></span>\<span class="hljs-title"><span class="hljs-title">Bookshelf</span></span>\<span class="hljs-title"><span class="hljs-title">Interactors</span></span>\<span class="hljs-title"><span class="hljs-title">AddBook</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Illuminate</span></span>\<span class="hljs-title"><span class="hljs-title">Http</span></span>\<span class="hljs-title"><span class="hljs-title">Request</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Illuminate</span></span>\<span class="hljs-title"><span class="hljs-title">Http</span></span>\<span class="hljs-title"><span class="hljs-title">Response</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BooksCreateController</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Controller</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/** * Create a new controller instance. * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> void */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__construct</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(AddBook $addBook)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;addBook = $addBook; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">call</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Request $request)</span></span></span><span class="hljs-function"> </span></span>{ $input = $request-&gt;all(); (<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;addBook)($input); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Response(<span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-number"><span class="hljs-number">201</span></span>)); } }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุงุฎุชุจุงุฑุงุชูุง ุชูุฑ ุ ูููู ููุงู ูุดููุฉ ุตุบูุฑุฉ. </p><br><p style=";text-align:right;direction:rtl">  ูุญู ุงุฎุชุจุงุฑ ุฑูุฒ ุฅูุดุงุก ุงููุชุงุจ ูุฑุชูู. </p><br><p style=";text-align:right;direction:rtl">  ุนุงุฏุฉ ูุง ุชููู ูุฐู ููุงุฑุณุฉ ุณูุฆุฉ ุ ููููููุง ุฅุตูุงุญูุง ูู ุฎูุงู ุชูุถูุญ ููุฒุฉ ุฃุฎุฑู ูููุชูุงุนููู. </p><br><p style=";text-align:right;direction:rtl">  ุณูููู ุจุฅุฒุงูุฉ ุงูุฅุดุงุฑุฉ ุนูู <code>BookRepository</code> ูู ุงูุงุฎุชุจุงุฑุงุช ููุณุชุฎุฏู <code>AddBook</code> ุงููุชูุงุนู ูุน <code>AddBook</code> ุงูุฎุงุต ุจูุง: </p><br><pre style=";text-align:right;direction:rtl"> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Lib</span></span>\<span class="hljs-title"><span class="hljs-title">Bookshelf</span></span>\<span class="hljs-title"><span class="hljs-title">Interactors</span></span>\<span class="hljs-title"><span class="hljs-title">AddBook</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BooksCreateControllerTest</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TestCase</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">testCallsInteractor</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ $attributes = [<span class="hljs-string"><span class="hljs-string">'title'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'1984'</span></span>, <span class="hljs-string"><span class="hljs-string">'author'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'George Orwell'</span></span>]; $addBook = Mockery::mock(AddBook::class); <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;app-&gt;instance(AddBook::class, $addBook); $addBook-&gt;expects()-&gt;__invoke($attributes); $response = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;call(<span class="hljs-string"><span class="hljs-string">'POST'</span></span>, <span class="hljs-string"><span class="hljs-string">'/books'</span></span>, $attributes); } }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุงูุขู ุงุฎุชุจุงุฑุงุชูุง ุชูุฑ ูุฃููุง ุฃูุซุฑ ููุซูููุฉ! </p><br><p style=";text-align:right;direction:rtl">  ูุฃุฎุฐ ุงูุฅุฌุฑุงุก ูุฏุฎูุงุช (ูู ูุนููุงุช ุทูุจ http) ููุณุชุฏุนู ุงููุชูุงุนู ููููุงู ุจูููุชู.  ุงููุณุคูููุฉ ุงููุญูุฏุฉ ููุนูู ูู ุงูุนูู ูุน ุงูุดุจูุฉ.  ููุนูู ุงููุชูุงุนู ูุน ููุทู ุนูููุง ุงูุญูููู. </p><br><p style=";text-align:right;direction:rtl">  ูุฐุง ูุจุณุท ุงูุฅุฌุฑุงุกุงุช ูุงุฎุชุจุงุฑุงุชูุง ุฅูู ุญุฏ ูุจูุฑ. </p><br><p style=";text-align:right;direction:rtl">  ุงูุฅุฌุฑุงุกุงุช ูุนูุงุฉ ุนูููุง ูู ููุทู ุงูุฃุนูุงู. </p><br><p style=";text-align:right;direction:rtl">  ุนูุฏูุง ูููู ุจุชุนุฏูู ุงูุชูุงุนู ุ ูู ูุนุฏ ุจุญุงุฌุฉ ุฅูู ุชุบููุฑ ุงูุฅุฌุฑุงุก ุฃู ุงุฎุชุจุงุฑู. </p><br><p style=";text-align:right;direction:rtl">  <em>ูุงุญุธ ุฃูู ูู ุชุทุจูู ุญูููู ุ ุฑุจูุง ุชุฑุบุจ ูู ุงูููุงู ุจุฃูุซุฑ ูู ุงูููุทู ุฃุนูุงู ุ ุนูู ุณุจูู ุงููุซุงู ููุชุฃูุฏ ูู ูุฌุงุญ ุงููุชูุฌุฉ.</em>  <em>ูุฅุฐุง ุญุฏุซ ูุดู ุ ูุฃูุช ุชุฑูุฏ ุฅุฑุฌุงุน ุงูุฃุฎุทุงุก ูู ุงูุชูุงุนู.</em> </p><br><p style=";text-align:right;direction:rtl">  <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุณุชูุฏุน ูุน ุฑูุฒ</a></strong> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar438052/">https://habr.com/ru/post/ar438052/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar438028/index.html">ูุง ุชุญุชุงุฌ ุฅูู blockchain: 8 ุญุงูุงุช ูุณุชุฎุฏู ุดููุฑุฉ ูููุงุฐุง ูุง ุชุนูู</a></li>
<li><a href="../ar438034/index.html">Android ู Rx ู Kotlin ุ ุฃู ููููุฉ ุฌุนู ูุฎูุจ Lego ูุชููุต. ุงูุฌุฒุก 1</a></li>
<li><a href="../ar438036/index.html">3blue1brown ู MIT ุจุงููุบุฉ ุงูุฑูุณูุฉ</a></li>
<li><a href="../ar438044/index.html">ูุฑุญุจุง ุงูุนุงูู ุงูุชุญููู</a></li>
<li><a href="../ar438046/index.html">ููููุฉ ุงูุชุฑููุฒ ุงูุฌุบุฑุงูู ููููู ููุทุฉ ุนูู ุณุจุงุฑู ุจุทุฑููุฉ ุณุฑูุนุฉุ</a></li>
<li><a href="../ar438058/index.html">"ุชุญููู ุงูุจูุงูุงุช ูู ุจูุซูู" ูู ุฌุฒุฃูู</a></li>
<li><a href="../ar438060/index.html">ุชูุฏูุฑ ุงูุงุชุฌุงู ุงูููุงูู ุ ุฃู ููู ูุง ุชุฎุงููุง ูู ูุฑุดุญุงุช ูุงูููู ููุงุฌููู</a></li>
<li><a href="../ar438062/index.html">ุนููุงูู ููุณ ููุฒู ุฃู ุดุงุฑุน ุ ุนููุงูู ูู ุงูุงุชุญุงุฏ ุงูุณูููุชูุ</a></li>
<li><a href="../ar438064/index.html">ูุงุฆูุฉ ุงูุชุญูู: ูุง ุงูุฐู ูุฌุจ ุงูููุงู ุจู ูุจู ุจุฏุก ุฎุฏูุงุช micros ูู ููุฒ</a></li>
<li><a href="../ar438066/index.html">10 ูููุงุช ููุชููุจ ุงูุชุนููููุฉ ุจุงููุบุฉ ุงูุฅูุฌููุฒูุฉ ุงูุชู ูู ูุณูุน ุจูุง ูู ูุจู</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>