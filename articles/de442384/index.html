<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëµüèæ üëºüèø ‚û∞ Erweiterung der Funktionalit√§t des Standard-Audiosystems üöì üë´ ü§ß</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hallo an alle. Ich bin der Besitzer eines zehnj√§hrigen Japaners, bei dem bis auf das Standard-Audiosystem alles zu mir passte - es war kein Bluetooth ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Erweiterung der Funktionalit√§t des Standard-Audiosystems</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/442384/">  Hallo an alle.  Ich bin der Besitzer eines zehnj√§hrigen Japaners, bei dem bis auf das Standard-Audiosystem alles zu mir passte - es war kein Bluetooth darin.  Es gibt drei M√∂glichkeiten, um dieses Problem zu l√∂sen: <br><br>  1. Kaufen Sie einen Stecker im Zigarettenanz√ºnder und zeigen Sie nicht. <br><br>  Nachteile: <br><br><ul><li>  Klangqualit√§t </li><li>  Kein Management </li><li>  Keine Songtitelausgabe </li></ul><br>  Es gibt keine Pluspunkte. <br><br>  2. Um bei einem Showdown f√ºr viel Geld ein normales Bluetooth-Ger√§t + einen neueren Kopf zu kaufen. <br><br>  Nachteile: <br><br><ul><li>  Blockieren Sie Kompatibilit√§tsprobleme </li><li>  Mono-Audioausgang (bei einigen Ger√§ten) </li><li>  Der Preis mit dem Austausch des Kopfes und der Verkabelung entspricht fast dem Notfunkger√§t </li><li>  Neben dem lateinischen Alphabet gibt es keine Unterst√ºtzung </li></ul><br>  Vorteile: <br><br><ul><li>  Serienausstattung </li></ul><br>  3. Machen Sie etwas selbst, aber um die vorhandene Funktionalit√§t nicht einzuschr√§nken. <br><br>  Nachteile: <br><br><ul><li>  Brauche Zeit </li><li>  Es wurde mehr Geld ausgegeben, als die ersten beiden Optionen zusammen zu w√§hlen </li></ul><br>  Vorteile: <br><br><ul><li>  Arbeitszufriedenheit </li><li>  Verlustfreie Audio-Unterst√ºtzung </li><li>  Kyrillische Unterst√ºtzung, obwohl transliteriert, als  Der Bildschirm wei√ü nicht wie. </li></ul><br>  Wie Sie aus dem Namen verstanden haben, habe ich Pfad Nummer 3 gew√§hlt. <br><a name="habracut"></a><br>  Ausgangsdaten. <br><br>  Das native Audiosystem, das aus einer Headunit und einem Panel besteht, das so aussieht: <br><br><img src="https://habrastorage.org/webt/4v/sk/5e/4vsk5evoi6jnzafseqly1stypdu.jpeg" alt="Bild"><br><br>  Es verf√ºgt √ºber den AUX-Modus, mit dem Sie externe Ger√§te anschlie√üen k√∂nnen, um Musik zu h√∂ren.  Warum nicht f√ºr eigene Zwecke nutzen?  Stellen Sie sicher, dass mit einer bestimmten Tastenkombination der AUX-Modus startet, gleichzeitig jedoch alle Daten auf dem Bildschirm vollst√§ndig von uns gesteuert werden und der Ton in AUX vom Bluetooth-Modul umgeleitet wird. <br>  Gl√ºcklicherweise finden Sie im √∂ffentlichen Bereich ein Handbuch mit einer Schaltung, aus dem hervorgeht, dass die Schnittstelle zwischen Kopf und Bedienfeld ein normaler UART ist. <br><br><img src="https://habrastorage.org/webt/sy/0z/oc/sy0zoczxvww01fma26rdsxi3-d8.png" alt="Bild"><br><br>  Unter Verwendung eines Logikanalysators wurden die Geschwindigkeit und das Protokoll des Austauschs zwischen dem Kopf und der Platte bestimmt.  (Bildschirmaktualisierungsrate von 10 Bildern pro Sekunde, Klickfrequenz 30 ms, 14400E2).  Zusammen mit der Arduinka wurde ein Ergebnis in Form von Hello World erzielt. <br><br><img src="https://habrastorage.org/webt/vs/gg/p2/vsggp28tpcikb1vprsgfsbuv0aq.jpeg" alt="Bild"><br><br>  Der n√§chste Schritt war die Auswahl eines Mikrocontrollers f√ºr die Implementierung.  Die Wahl fiel auf den STM32F103, an Bord von bis zu 3 UART wird der CAN-Bus unterst√ºtzt (warum nicht hinzuf√ºgen).  CSR8645 wurde urspr√ºnglich als Bluetooth-Modul gekauft, die erste Version war mit dabei, aber es konnte die Namen der Tracks nicht anzeigen (oder ich habe es nicht vollst√§ndig herausgefunden) und hatte auch keine digitale Bussteuerung, so dass ein Modul namens Bluegiga direkt aus den USA gekauft wurde WT32i, in dem alles vorhanden war und noch mehr - Unterst√ºtzung f√ºr digitale Audioausgabe und den AptX-Codec.  F√ºr ein paar Monate, wenn es Freizeit gab, wurde die Entwicklung eines Prototyps durchgef√ºhrt.  Alle Schrecken von HAL und die Reize von SPL waren bekannt.  Gr√ºndlich studiert UART und DMA im Mikrocontroller, weil  es war notwendig, alles zusammenzubinden, damit es ohne Bremsen und Ausf√§lle funktionierte. <br><br><div class="spoiler">  <b class="spoiler_title">Einige Fotos des Prozesses</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/_h/kd/n2/_hkdn2sdmrg4sbs9nt-hbfj3_gs.jpeg" alt="Bild"><br><img src="https://habrastorage.org/webt/ma/vx/cn/mavxcnga0mh5nyo4tjabxhddeoq.jpeg" alt="Bild"><br></div></div><br>  Dann wurde all dieses Zeug in die Haupteinheit eingef√ºhrt, aber damit es ohne Probleme zur √úberarbeitung geflasht und entfernt werden konnte.  Als Schnittstelle wurden ein HDMI-Kabel und ein Anschluss eines toten Laptops verwendet. <br><br><div class="spoiler">  <b class="spoiler_title">Fotos zum Zeitpunkt des Debuggens ist es besser, nicht hinzuschauen</b> <div class="spoiler_text">  Innenansicht: <br><br><img src="https://habrastorage.org/webt/sv/dn/hg/svdnhgx22mh2ud4joto7-kp2rby.jpeg" alt="Bild"><br><br>  Au√üenansicht: <br><br><img src="https://habrastorage.org/webt/go/fl/ff/goflffoe8hbevkscvrrg3g_pfpy.jpeg" alt="Bild"><br><br>  Der Fall wurde von einem alten Laptop-Netzteil gemacht. <br></div></div><br>  Es ist an der Zeit, die Leiterplatte unter dieses Gesch√§ft zu stellen und alles aus dem Kopf zu nehmen, damit Sie diese Sammelfarm jederzeit entfernen und den Betrieb der Maschine nicht st√∂ren k√∂nnen.  Das Ergebnis war so sch√∂n: <br><br><img src="https://habrastorage.org/webt/iw/ln/k4/iwlnk4u8lbrludjqjuphd79imbe.jpeg" alt="Bild"><br><br>  Ich habe das Board zum ersten Mal in meinem Leben gez√ºchtet, das kann man kritisieren, aber in Ma√üen.  Der Abend war verl√∂tet und es hat beim ersten Mal funktioniert, was mich sehr √ºberrascht hat. <br><br><img src="https://habrastorage.org/webt/ys/qq/sc/ysqqscjostb7asl5h7l955idgo4.jpeg" alt="Bild"><br><br>  Als n√§chstes wurde der CAN-Transceiver TJA1051 hinzugef√ºgt, mit dem Sie eine Reihe interessanter und nicht sehr genauer Daten vom CAN-Bus des Fahrzeugs abrufen k√∂nnen.  Im Moment verwende ich nur die Ausgabe des Kraftstoffverbrauchs pro Stunde, weil  regul√§res bk hat eine solche Funktion nicht. <br><br><img src="https://habrastorage.org/webt/9t/4u/pz/9t4upz_0ggt3iwkn3_sro19la34.jpeg" alt="Bild"><br><br>  Video wie es funktioniert: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/7zL-TJ1qteM" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Wie Sie vielleicht bemerkt haben, wird der russische Text mehr oder weniger intelligent in Transliteration angezeigt.  Zum Beispiel wird der Buchstabe <b>h</b> durch ch usw. ersetzt, was mit regul√§ren Mitteln nicht erreicht werden konnte.  Nun, zus√§tzlich Unterst√ºtzung f√ºr verlustfreies Audio. <br><br>  F√ºr diejenigen, die sich nach Details sehnen.  Alle 3 UARTs sind beteiligt.  Eine auf dem Display, eine auf den Tasten und eine auf dem Bluetooth-Modul.  Der Schallstrom wird von einem analogen Multiplexer geschaltet.  CAN wird auch von STM32 verwendet.  Es gibt einen externen DAC PCM5102, der Sound ist sehr gut.  Verbindet zwischen dem Kopf und der Verkabelung des Autos.  Die Steckverbinder wurden bei der Demontage gefunden. <br><br>  Es stellte sich als teurer heraus als der Kauf eines normalen Bluetooth-Systems, brachte aber viel mehr Freude an der Entwicklung. <br><br>  Es ist geplant, die Funktionen der Fahrzeuganpassung anzupassen (Besitzer von Mitsubishi 2008+ werden verstehen, worum es geht), das Protokoll ist bereits vorhanden, alles wird √ºberpr√ºft, es muss noch in der Firmware implementiert werden. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Den Code erhalten Sie hier.</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de442384/">https://habr.com/ru/post/de442384/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de442372/index.html">Zuverl√§ssige Programmierung im Kontext von Sprachen. Teil 2 - Herausforderer</a></li>
<li><a href="../de442374/index.html">Entwicklung eines Aufw√§rtswandlers auf DSP: Funktionsprinzip, Berechnungen, Prototyping</a></li>
<li><a href="../de442376/index.html">Einzelhandelsgrundst√ºcksdichte</a></li>
<li><a href="../de442378/index.html">Ein Klick in der Benutzeroberfl√§che von Booking com kann einen Urlaub ruinieren oder warum ein funktionierendes Bewertungssystem wichtig ist</a></li>
<li><a href="../de442380/index.html">Chaos sortieren</a></li>
<li><a href="../de442386/index.html">Thymeleaf: Dialektlayout + Spring Boot 2</a></li>
<li><a href="../de442392/index.html">NodeJS-Protokollierung richtig gemacht</a></li>
<li><a href="../de442396/index.html">Digitale Veranstaltungen in Moskau vom 04. bis 10. M√§rz</a></li>
<li><a href="../de442402/index.html">Das Wichtigste. Integration mit externen Diensten</a></li>
<li><a href="../de442404/index.html">Das Wichtigste. Integration mit externen Diensten (Teil 2)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>