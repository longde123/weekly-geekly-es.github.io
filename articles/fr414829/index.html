<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚ôæ üëì ‚óΩÔ∏è Mon chemin: comment j'ai refus√© d'acheter une passerelle Noolite et l'ai remplac√©e par mon v√©lo üë≤üèª üêî üå¥</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Cette histoire a commenc√© il y a un an et demi, lorsque des unit√©s de contr√¥le d'√©clairage ¬´noolite¬ª sont tomb√©es entre mes mains (enfin, comme je l'a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Mon chemin: comment j'ai refus√© d'acheter une passerelle Noolite et l'ai remplac√©e par mon v√©lo</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/414829/"><img src="https://habrastorage.org/webt/ws/kw/xk/wskwxkd5zxzru5vksii2n16rwpi.jpeg" width="800"><br><br>  Cette histoire a commenc√© il y a un an et demi, lorsque des unit√©s de contr√¥le d'√©clairage ¬´noolite¬ª sont tomb√©es entre mes mains (enfin, comme je l'ai eu, je l'ai achet√© moi-m√™me, j'ai une faiblesse pour toutes sortes de mat√©riel int√©ressant).  Puis √† ma disposition √©taient deux blocs de la s√©rie SB et l'adaptateur MTRF-64.  Les blocs de cette s√©rie m'ont attir√© par le fait qu'ils peuvent √™tre int√©gr√©s dans le c√¢blage domestique sans refaire de mani√®re significative: j'ai sorti un interrupteur et ins√©r√© un bloc √† sa place, et j'ai suspendu l'interrupteur sur des fils sp√©cialement retir√©s du bloc.  Dans cette configuration, la lumi√®re peut √™tre contr√¥l√©e √† la fois √† partir d'un canal radio et, selon les classiques, d'un interrupteur.  Il y a bien s√ªr un inconv√©nient: les blocs de cette s√©rie ne prennent pas en charge le feedback, mais j'aimerais bien, car dans le MTRF-64, c'est le cas, mais eh bien.  Mais ensuite j'ai refus√© d'acheter une passerelle au profit d'un adaptateur, son potentiel est plus large que celui d'une passerelle. <br><a name="habracut"></a><br>  Ayant beaucoup clign√© des yeux avec le lustre, il y avait un d√©sir de tout ramener √† un d√©nominateur commun, mais, apparemment, d'autres pi√®ces de fer int√©ressantes ont √©clips√© ce d√©sir, car les blocs ont √©t√© envoy√©s dans une bo√Æte √©loign√©e.  Ils auraient donc √©t√© l√† si, jusqu'√† r√©cemment, je n'avais pas fait attention √† eux <s>plus pr√©cis√©ment sur la couche de poussi√®re ind√©cemment √©paisse sur eux</s> . <br><br><img src="https://habrastorage.org/webt/fh/2i/9p/fh2i9p91tww9bse_zpghssh91sy.jpeg"><br>  <i>Bloc d'alimentation SB-1-150 et MTRF-64</i> <br><br>  Imm√©diatement, une image est apparue dans ma t√™te dans laquelle j'√©teins la lumi√®re avant d'aller me coucher sans sortir du lit, ou j'utilise le script "Je pars" en un seul clic pour d√©sactiver tout ce qui devrait √™tre √©teint en mon absence. <br><br>  Enfin, il a √©t√© d√©cid√© d'agir.  Pourquoi ai-je commenc√© √† riveter mon v√©lo et n'ai pas achet√© le syst√®me fini tout de suite?  Juste parce que je voulais faire quelque chose de mes propres mains.  Vous connaissez ce sentiment lorsque vous assemblez quelque chose, et cela fonctionne.  De plus, je commence enfin √† apprendre un langage orient√© objet en utilisant un exemple de vrai projet (j'ai choisi python 3). <br><br><h3>  <b>Id√©e</b> </h3><br>  C'est simple - contr√¥lez les lumi√®res et les appareils de n'importe o√π dans la maison.  En tant que dispositif de contr√¥le principal, le Raspberry Pi mod√®le B + en conjonction avec le MTRF-64.  En raison du manque d'exp√©rience dans le d√©veloppement de telles applications, il a √©t√© d√©cid√© de commencer par quelque chose de simple.  Je suis donc venu √† la mise en ≈ìuvre du bot Telegram. <br><br><img src="https://habrastorage.org/webt/uf/yb/zs/ufybzsoaag50snrbeosyotbq9lk.jpeg" width="550"><br>  <i>Raspberry Pi B + et MTRF-64</i> <br><br>  Pour ma part, j'ai d√©cid√© que pour la premi√®re fois les fonctions de bot suivantes me suffiraient: <br><br><ul><li>  Contr√¥le de la lumi√®re et des appareils √©lectrom√©nagers; </li><li>  Prise en charge des appareils √† intensit√© variable (lumi√®re, hotte, etc.); </li><li>  La r√©partition des appareils par pi√®ce; </li><li>  Prise en charge de scripts pour g√©rer rapidement un groupe d'appareils; </li><li>  Ajouter des utilisateurs et les r√©partir en groupes: propri√©taires (peuvent contr√¥ler les appareils dans la maison, avoir acc√®s aux param√®tres de la maison), invit√©s (peuvent contr√¥ler les appareils dans la maison, n'ont pas acc√®s aux param√®tres de la maison), abonn√©s (attendez que le propri√©taire les invite √† la maison) . </li></ul><br><h3>  <b>L'installation</b> </h3><br>  Pour commencer, t√©l√©chargez le syst√®me d'exploitation de notre tarte aux framboises.  Je pr√©f√®re le fonctionnaire pour ce <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ch√¢le Raspbian</a> .  Il est pratique de t√©l√©charger une image sur un CD √† l'aide de l'utilitaire Win32DiskImager. <br><br><div class="spoiler">  <b class="spoiler_title">Ici j'attendais une petite prise</b> <div class="spoiler_text">  Le fait est que je suis habitu√© √† travailler avec la framboise √† distance, mais √©tant donn√© que dans les versions r√©centes de Raspbian SSH, l'acc√®s est d√©sactiv√© par d√©faut, j'ai d√ª <s>me rapprocher de l'</s> utilisation de cet adaptateur USB-UART <br><br><img src="https://habrastorage.org/webt/8w/vo/pf/8wvopf1oe-x0e_jjeell9qznmfo.jpeg" width="300"><br></div></div><br>  1. Connectez le tout et connectez-vous: <br><br><pre><code class="bash hljs">login: pi password: raspberry</code> </pre> <br>  2. Pour commencer, il est conseill√© de s'assurer que vous utilisez les derni√®res versions des programmes.  Vous pourriez penser: nous venons de t√©l√©charger le kit de distribution, o√π est-il frais?  Mais non ... <br><br><pre> <code class="bash hljs">sudo apt-get update sudo apt-get -y dist-upgrade</code> </pre> <br>  3. Nous installons le gestionnaire de paquets pip3 et git: <br><br><pre> <code class="bash hljs">sudo apt-get install -y python3-pip git</code> </pre> <br>  4.T√©l√©chargez les biblioth√®ques n√©cessaires au fonctionnement du bot.  J'utilise la biblioth√®que pyTelegramBotAPI, qui s'occupe de toutes les nuances d'envoi et de r√©ception de requ√™tes HTTP, me permettant de me concentrer directement sur la logique: <br><br><pre> <code class="bash hljs">sudo pip3 install pytelegrambotapi pyserial</code> </pre> <br>  5. T√©l√©chargez le bot: <br><br><pre> <code class="bash hljs">sudo git <span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> https://github.com/DZimasik/nooBot.git</code> </pre> <br>  Avant de d√©marrer le bot, vous devez l'enregistrer, c'est-√†-dire  obtenir son identifiant unique (jeton).  Un autre bot sp√©cial nous aidera √† le faire - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">@BotFather</a> .  Envoyez-lui <b>simplement / newbot</b> et il demande de trouver un nom pour notre nouveau bot, ce nom sera affich√© dans la liste de contacts du t√©l√©gramme.  De plus, BotFather propose de cr√©er un nom d'utilisateur de bot unique.  La seule limitation est que le nom d'utilisateur doit se terminer par "bot".  Le nom d'utilisateur est √©galement utilis√© pour rechercher un bot parmi beaucoup d'autres. <br><br>  En principe, cela suffit pour commencer.  Certains perfectionnistes ici peuvent demander au bot un avatar ou √©crire un message de bienvenue.  Une fois que tout est entr√©, BotFather retournera le jeton: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/bb/0j/v_/bb0jv_84fi5o3caqqrgweyk2j6i.png" width="200"></div><br><br>  6. Ajoutez le jeton au fichier config.py <br><br><pre> <code class="bash hljs">sudo nano /home/pi/nooBot/config.py</code> </pre> <br><pre> <code class="python hljs">token = <span class="hljs-string"><span class="hljs-string">'_'</span></span> <span class="hljs-comment"><span class="hljs-comment"># Insert your token from BotFather</span></span></code> </pre> <br>  7. Enfin, vous pouvez d√©marrer le bot: <br><br><pre> <code class="bash hljs">sudo python3 /home/pi/nooBot/noobot.py</code> </pre> <br>  Envoyez √† notre bot <b>/ start</b> .  Si le jeton est entr√© correctement, le clavier appara√Ætra et nous verrons un message: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/na/2u/8i/na2u8igmpwxb5bxnnqy6t9w2wze.png" width="200"></div><br><h3>  <b>Planifier l'avenir</b> </h3><br>  √Ä ce stade, je contr√¥le la lumi√®re dans la chambre et le couloir, mais √† l'avenir, je pr√©vois d'acheter plus d'unit√©s de puissance (cette fois avec r√©troaction) et de passer tout mon √©clairage en t√©l√©commande.  Il est √©galement pr√©vu d'ajouter un support de r√©troaction au bot afin qu'il soit possible de conna√Ætre l'√©tat des appareils et les param√®tres des capteurs dans la maison, en dehors de celui-ci. <br><br>  C'est tout pour l'instant.  Je serai ravi d'entendre votre avis.  Bon √† tous! <br><br>  Liens utiles: <br><br><ul><li>  <a href="">D√©p√¥t Github</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">API de t√©l√©gramme bot</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">MTRF-64</a> et son <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">API</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr414829/">https://habr.com/ru/post/fr414829/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr414817/index.html">Cyber ‚Äã‚Äãgrand-m√®re, ou comment nous avons pirat√© une journ√©e</a></li>
<li><a href="../fr414819/index.html">Bienvenue au Meetup Unreal Engine 4 ce samedi √† Saint-P√©tersbourg</a></li>
<li><a href="../fr414821/index.html">Cours vid√©o pratique de l'√âcole de s√©curit√© de l'information</a></li>
<li><a href="../fr414825/index.html">Les seules √©motions que je ressens sont la col√®re et la peur</a></li>
<li><a href="../fr414827/index.html">D'ici 2050, 50% de la production mondiale d'√©nergie proviendra de sources renouvelables.</a></li>
<li><a href="../fr414831/index.html">Entrep√¥t de donn√©es distribu√© dans Data Lake Concept: installation de CDH</a></li>
<li><a href="../fr414833/index.html">Fintech Digest: PayPal va acheter Hyperwallet pour 400 millions de dollars, Samsung lance un projet de blockchain</a></li>
<li><a href="../fr414835/index.html">Les douches atmosph√©riques entra√Ænent la d√©faillance des supercalculateurs: que faire pour y rem√©dier</a></li>
<li><a href="../fr414837/index.html">Autoriser l'acc√®s au serveur Web uniquement via CloudFlare (iptables)</a></li>
<li><a href="../fr414839/index.html">La production en usine de modules r√©sidentiels aidera-t-elle √† combler les p√©nuries de logements</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>