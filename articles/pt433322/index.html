<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üíê üèáüèº üïå API JSON - trabalhamos de acordo com a especifica√ß√£o üë©üèø‚Äçüíº ‚ùå üßï</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Recentemente, o desenvolvimento web foi dividido. Agora n√£o somos todos programadores de pilha cheia - somos front-end e back-end. E a coisa mais dif√≠...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>API JSON - trabalhamos de acordo com a especifica√ß√£o</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/oleg-bunin/blog/433322/">  Recentemente, o desenvolvimento web foi dividido.  Agora n√£o somos todos programadores de pilha cheia - somos front-end e back-end.  E a coisa mais dif√≠cil sobre isso, como em outros lugares, √© o problema de intera√ß√£o e integra√ß√£o. <br><br>  O front-end com o back-end interage atrav√©s da API.  E todo o resultado do desenvolvimento depende de qual API √©, qu√£o bom ou ruim o back-end e o front-end concordaram entre si.  Se todos come√ßarmos a discutir juntos como fazer a atualiza√ß√£o e passarmos o dia inteiro reformulando-a, talvez n√£o possamos realizar tarefas comerciais. <br><br>  Para n√£o derrapar e criar holivares sobre os nomes das vari√°veis, voc√™ precisa de uma boa especifica√ß√£o.  Vamos falar sobre como deve tornar a vida mais f√°cil para todos.  Ao mesmo tempo, nos tornaremos especialistas em galp√µes de bicicletas. <br><br><img src="https://habrastorage.org/webt/o4/me/1u/o4me1uwmahvlwsnvqxyf_rzwa1i.jpeg"><br><a name="habracut"></a><br>  Vamos come√ßar de longe - com o problema que estamos resolvendo. <br><br>  H√° muito tempo, em 1959, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Cyril Parkinson</a> (que n√£o deve ser confundido com a doen√ßa, √© escritor e figura econ√¥mica) apresentou v√°rias leis interessantes.  Por exemplo, essas despesas aumentam com a renda etc.  Um deles √© chamado de Lei da Trivialidade: <br><br><blockquote>  O tempo gasto discutindo o item √© inversamente proporcional ao valor considerado. <br></blockquote><br>  Parkinson era economista, ent√£o explicou suas leis em termos econ√¥micos, algo assim.  Se voc√™ for ao conselho de administra√ß√£o e disser que precisa de US $ 10 milh√µes para construir uma usina nuclear, provavelmente essa quest√£o ser√° discutida muito menos do que a aloca√ß√£o de 100 libras para uma bicicleta que √© usada pelos funcion√°rios.  Como todo mundo sabe construir um galp√£o para bicicletas, todo mundo tem sua pr√≥pria opini√£o, todo mundo se sente importante e quer participar, e a usina nuclear √© algo abstrato e distante, 10 milh√µes tamb√©m nunca foram vistos - h√° menos perguntas. <br><br>  Em 1999, a lei da trivialidade de Parkinson apareceu na programa√ß√£o, que foi ent√£o ativamente desenvolvida.  Na programa√ß√£o, essa lei foi encontrada principalmente na literatura em ingl√™s e soou como uma met√°fora.  Foi chamado de <strong>efeito Bikeshed</strong> (o efeito de um galp√£o de bicicleta), mas a ess√™ncia √© a mesma - estamos prontos para um galp√£o de bicicleta e queremos discutir muito mais do que a constru√ß√£o de uma usina. <br><br>  Este termo foi cunhado pelo desenvolvedor dinamarqu√™s Poul-Henning Kamp, que esteve envolvido na cria√ß√£o do FreeBSD.  Durante o processo de design, a equipe passou muito tempo discutindo como a fun√ß√£o do sono deveria funcionar.  Esta √© uma cita√ß√£o de uma <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">carta de</a> Poul-Henning Kamp (o desenvolvimento foi realizado em correspond√™ncia por e-mail): <br><br><blockquote>  Foi uma proposta para adormecer (1) DTRT Se dado um argumento n√£o inteiro que desencadeou esse inc√™ndio em particular, n√£o vou dizer mais nada sobre isso, porque √© um item muito menor do que se poderia dizer. esperar do comprimento do segmento, e ele j√° recebeu muito mais aten√ß√£o do que alguns dos * problemas * que temos por aqui. <br></blockquote><br>  Nesta carta, ele diz que existem muitos problemas n√£o resolvidos muito mais importantes: "N√£o vamos lidar com o barrac√£o de bicicleta, faremos algo com isso e seguiremos em frente!" <br><br>  Assim, Poul-Henning Kamp, em 1999, introduziu o termo efeito ciclado na literatura em ingl√™s, que pode ser reformulado como: <br><br><blockquote>  A quantidade de ru√≠do criada pela altera√ß√£o no c√≥digo √© inversamente proporcional √† complexidade da altera√ß√£o. <br></blockquote><br>  Quanto mais simples a adi√ß√£o ou altera√ß√£o que fazemos, mais opini√µes precisamos ouvir sobre isso.  Eu acho que muitos j√° encontraram isso.  Se resolvermos uma pergunta simples, por exemplo, como nomear vari√°veis, isso n√£o importa para uma m√°quina - essa pergunta causar√° um grande n√∫mero de holivares.  Por√©m, problemas s√©rios e realmente importantes para os neg√≥cios n√£o s√£o discutidos e v√£o em segundo plano. <br><br>  O que voc√™ acha mais importante: como nos comunicamos entre o back-end e o front-end, ou as tarefas de neg√≥cios que realizamos?  Todo mundo pensa de maneira diferente, mas qualquer cliente, uma pessoa que espera que voc√™ traga dinheiro para ele, dir√°: "Realize minhas tarefas de neg√≥cios!"  Ele absolutamente n√£o se importa como voc√™ transfere dados entre o back-end e o front-end.  Talvez ele nem saiba o que √© um back-end e front-end. <br><br>  Para resumir a introdu√ß√£o, eu gostaria de dizer: <strong>API √© um galp√£o de bicicleta.</strong> <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/1cJVwn44iSc" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  <em><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Link de</a></em> <em>apresenta√ß√£o</em> <br><br>  <strong>Sobre o palestrante:</strong> Alexey Avdeev ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link">Avdeev</a> ) trabalha para a empresa Neuron.Digital, que lida com neur√¥nios e cria uma interface interessante para eles.  Alex tamb√©m presta aten√ß√£o ao OpenSource e aconselha a todos.  Ele est√° envolvido no desenvolvimento h√° muito tempo - desde 2002, ele encontrou a Internet antiga, quando os computadores eram grandes, a Internet era pequena e a falta de JS n√£o incomodava ningu√©m e todos criavam sites nas mesas. <br><br><h2>  Como lidar com barrac√µes de bicicleta? <br></h2><br>  Depois que o respeitado Cyril Parkinson deduziu a lei da trivialidade, ele foi muito discutido.  Acontece que o efeito de um galp√£o de bicicleta aqui pode ser facilmente evitado: <br><br><ol><li>  <strong>N√£o d√™ ouvidos a conselhos.</strong>  Eu acho que a id√©ia √© mais ou menos. Se voc√™ n√£o ouvir as dicas, poder√° fazer isso, especialmente na programa√ß√£o e, principalmente, se for um desenvolvedor iniciante. <br></li><li>  <strong>Fa√ßa como quiser.</strong>  "Eu sou um artista, pelo visto!"  - sem efeito de bicicleta, tudo o que voc√™ precisa est√° pronto, mas coisas muito estranhas aparecem na sa√≠da.  Isso geralmente √© encontrado em freelancers.  Certamente, voc√™ se deparou com tarefas que tinha que concluir para outros desenvolvedores e cuja implementa√ß√£o causou confus√£o. <br></li><li>  <strong>√â importante se perguntar?</strong>  Caso contr√°rio, voc√™ simplesmente n√£o pode discutir o assunto, mas √© uma quest√£o de consci√™ncia pessoal. <br></li><li>  <strong>Use crit√©rios objetivos.</strong>  Vou falar sobre este ponto no relat√≥rio.  Para evitar o efeito de um galp√£o de bicicleta, voc√™ pode usar crit√©rios que digam objetivamente qual √© o melhor.  Eles existem. <br></li><li>  <strong>N√£o fale sobre o que voc√™ n√£o quer ouvir conselhos.</strong>  Em nossa empresa, os desenvolvedores de back-end iniciantes s√£o introvertidos, ent√£o acontece que eles fazem algo que n√£o contam aos outros.  Como resultado, encontramos surpresas.  Este m√©todo funciona, mas na programa√ß√£o n√£o √© a melhor op√ß√£o. <br></li><li>  Se voc√™ n√£o se importa com o problema, pode simplesmente <strong>deix√°-</strong> lo <strong>ir ou escolher qualquer uma das op√ß√µes propostas</strong> que surgiram no processo de holivarov. <br></li></ol><br><h2>  Ferramenta anti-ciclismo <br></h2><br>  Quero falar sobre <strong>ferramentas objetivas</strong> para resolver o problema de um barrac√£o de bicicleta.  Para demonstrar o que √© uma ferramenta anti-ciclismo, vou contar uma pequena hist√≥ria. <br><br>  Imagine que temos um desenvolvedor iniciante de back-end.  Ele veio recentemente √† empresa e foi instru√≠do a criar um pequeno servi√ßo, por exemplo, um blog, para o qual voc√™ precisa escrever um protocolo REST. <br><br><img src="https://habrastorage.org/webt/zn/9m/uk/zn9muk80uvsd_yuragws16ms70c.png">  <em>Roy Fielding, autor de REST</em> <br><br>  Na foto, Roy Fielding, que em 2000 defendeu sua tese "Estilos arquitet√¥nicos e design de arquiteturas de software de rede" e, assim, introduziu o termo REST.  Al√©m disso, ele inventou o HTTP e, de fato, √© um dos fundadores da Internet. <br><br>  REST √© um conjunto de princ√≠pios de arquitetura que dizem como projetar protocolos REST, APIs REST, servi√ßos RESTful.  Estes s√£o princ√≠pios arquitet√¥nicos bastante abstratos e complexos.  Estou certo de que nenhum de voc√™s jamais viu uma API feita completamente de acordo com todos os princ√≠pios RESTful. <br><br><h2>  Requisitos de arquitetura REST <br></h2><br>  Vou dar alguns requisitos para os protocolos <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">REST</a> , dos quais vou me referir e confiar.  Existem muitos deles, voc√™ pode ler mais sobre isso na Wikipedia. <br><br>  1. <strong>O modelo cliente-servidor.</strong> <br>  O princ√≠pio mais importante do REST, ou seja, nossa intera√ß√£o com o back-end.  De acordo com o REST, o back-end √© um servidor, o front-end √© um cliente e nos comunicamos em um formato cliente-servidor.  Os dispositivos m√≥veis tamb√©m s√£o um cliente.  Desenvolvedores de rel√≥gios, geladeiras e outros servi√ßos - tamb√©m desenvolvem a parte do cliente.  A API RESTful √© o servidor que o cliente acessa. <br><br>  2. <strong>Falta de condi√ß√£o.</strong> <br>  N√£o deve haver estado no servidor, ou seja, tudo o que √© necess√°rio para uma resposta vem na solicita√ß√£o.  Quando uma sess√£o √© armazenada no servidor e, dependendo dessa sess√£o, surgem respostas diferentes, isso √© uma viola√ß√£o do princ√≠pio REST. <br><br>  3. <strong>Uniformidade da interface.</strong> <br>  Esse √© um dos principais princ√≠pios subjacentes nos quais a API REST deve ser constru√≠da.  Inclui o seguinte: <br><br><ul><li>  A identifica√ß√£o de recursos √© como devemos construir uma URL.  No REST, recorremos ao servidor para algum tipo de recurso. </li><li>  Manipula√ß√£o de recursos atrav√©s da apresenta√ß√£o.  O servidor nos retorna uma vis√£o diferente da que est√° no banco de dados.  N√£o importa se voc√™ armazena as informa√ß√µes no MySQL ou PostgreSQL - temos uma vis√£o. </li><li>  Mensagens autoexplicativas - ou seja, a mensagem cont√©m identifica√ß√£o, links onde voc√™ pode obter essa mensagem novamente - tudo o que √© necess√°rio para trabalhar com esse recurso novamente. </li><li>  Hiperm√≠dia √© um link para as seguintes a√ß√µes com um recurso.  Parece-me que nem uma √∫nica API REST faz isso, mas √© descrita por Roy Fielding. </li></ul><br>  Existem mais tr√™s princ√≠pios que n√£o cito porque n√£o s√£o importantes para a minha hist√≥ria. <br><br><h2>  Blog RESTful <br></h2><br>  De volta ao desenvolvedor de back-end inicial, que foi solicitado a fazer um servi√ßo para o blog no RESTful.  Abaixo est√° um exemplo de um prot√≥tipo. <br><br><img src="https://habrastorage.org/webt/op/wi/6l/opwi6l_tbihj0tvef8tu4feyoo4.png"><br><br>  Este √© um site no qual existem artigos, voc√™ pode comentar sobre eles, o artigo e os coment√°rios t√™m um autor - uma hist√≥ria padr√£o.  Nosso desenvolvedor iniciante de back-end far√° uma API RESTful para este blog. <br><br>  Trabalhamos com todos os dados do blog com base no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">CRUD</a> . <br><img src="https://habrastorage.org/webt/4i/rk/hm/4irkhm7dcicexgmqomprfdraisu.png"><br>  Deve ser poss√≠vel criar, ler, atualizar e excluir qualquer recurso.  Vamos tentar pedir ao nosso desenvolvedor de back-end para criar um AP RESTful com base no princ√≠pio do CRUD.  Ou seja, escreva m√©todos para criar artigos, obtenha uma lista de artigos ou um √∫nico artigo, atualize e exclua. <br><br>  Vamos ver como ele conseguiu. <br><img src="https://habrastorage.org/webt/m2/i2/ua/m2i2uadak8sdzbge_pvqlnpu55s.png"><br><br>  <strong>Tudo est√° errado aqui em rela√ß√£o a todos os princ√≠pios do REST</strong> .  O mais interessante √© que funciona.  Na verdade, eu tenho APIs que se parecem com isso.  Para o cliente, √© um galp√£o de bicicleta, para os desenvolvedores √© uma ocasi√£o para relaxar e discutir, e para um desenvolvedor iniciante, √© apenas um mundo novo enorme e corajoso, no qual ele trope√ßa toda vez, cai e esmaga sua cabe√ßa.  Ele precisa refaz√™-lo repetidamente. <br><img src="https://habrastorage.org/webt/k1/nj/lm/k1njlm8egbrcguim8am6juym76s.png"><br><br>  Esta √© uma op√ß√£o REST.  Com base nos princ√≠pios de identifica√ß√£o de recursos, trabalhamos com recursos - com artigos e usamos os m√©todos HTTP propostos por Roy Fielding.  Ele n√£o p√¥de deixar de usar seu trabalho anterior em seu pr√≥ximo trabalho. <br><br>  Para atualizar artigos, muitos usam o m√©todo PUT, que possui sem√¢ntica ligeiramente diferente.  O m√©todo PATCH atualiza os campos que foram passados ‚Äã‚Äãe o PUT simplesmente substitui um artigo por outro.  Por sem√¢ntica, PATCH √© mesclagem e PUT √© substitu√≠da. <br><br>  Nosso desenvolvedor iniciante de back-end caiu, eles pegaram e disseram: "Est√° tudo em ordem, fa√ßa assim", e ele honestamente o refez.  Mas ent√£o ele encontrar√° um longo caminho atrav√©s dos espinhos. <br><br>  <strong>Por que isso √© t√£o certo?</strong> <br><br><ul><li>  porque Roy Fielding disse isso; </li><li>  porque √© REST; </li><li>  porque esses s√£o os princ√≠pios arquitet√¥nicos nos quais nossa profiss√£o se baseia agora. </li></ul><br>  No entanto, este √© um "dep√≥sito de bicicletas" e o m√©todo anterior funcionar√°.  Os computadores se comunicaram antes do REST e tudo funcionou.  Mas agora um padr√£o apareceu no setor. <br><br><h2>  Excluir o artigo <br></h2><br>  Considere o exemplo de exclus√£o de um artigo.  Suponha que exista um m√©todo de recurso normal DELETE / articles, que remova o artigo pelo ID.  HTTP cont√©m cabe√ßalhos.  O cabe√ßalho Accept aceita o tipo de dados que o cliente deseja receber em resposta.  Nosso junior escreveu um servidor que retorna 200 OK, Content-Type: application / json, e passa um corpo vazio: <br><br> <code>01. <b><font color="#c6e90e">DELETE /articles/</font></b> 1 /1.1 <br> 02. Accept: <b><font color="#c6e90e">application/json</font></b></code> <br> <br> <code>01. HTTP/1.1 200 OK <br> 02. Content-Type: <b><font color="#c6e90e">application/json</font></b> <br> 03. null <br></code> <br>  Um <strong>erro</strong> muito <strong>comum foi cometido aqui - um corpo vazio</strong> .  Tudo parece l√≥gico - o artigo foi exclu√≠do, 200 OK, o cabe√ßalho application / json est√° presente, mas o cliente provavelmente cair√°.  Ir√° gerar um erro porque um corpo vazio n√£o √© v√°lido.  Se voc√™ j√° tentou analisar uma string vazia, se depara com o fato de que qualquer analisador json trope√ßa e trava com isso. <br><br>  Como consertar essa situa√ß√£o?  Provavelmente a melhor op√ß√£o √© passar json.  Se declaramos: ‚ÄúAceite, nos d√™ json‚Äù, o servidor diz: ‚ÄúTipo de conte√∫do, eu te dou json‚Äù, d√™ json.  Um objeto vazio, uma matriz vazia - coloque algo l√° - esta ser√° a solu√ß√£o e funcionar√°. <br><br>  Ainda existe uma solu√ß√£o.  Al√©m de 200 OK, h√° um c√≥digo de resposta 204 - sem conte√∫do.  Com ele, voc√™ n√£o pode transmitir o corpo.  Nem todo mundo sabe disso. <br><br>  Ent√£o eu levei aos tipos de m√≠dia. <br><br><h3>  Tipos de m√≠mica <br></h3><br>  Os tipos de m√≠dia s√£o como uma extens√£o de arquivo, apenas na web.  Quando transmitimos dados, devemos informar ou solicitar que tipo de resposta queremos receber. <br><br><ul><li>  Por padr√£o, isso √© texto / sem formata√ß√£o - apenas texto. </li><li>  Se nada for especificado, o navegador provavelmente significar√° application / octet-stream - apenas um bit stream. </li></ul><br>  Voc√™ pode especificar apenas um tipo espec√≠fico: <br><br><ul><li>  application / pdf; </li><li>  imagem / png; </li><li>  application / json; </li><li>  application / xml; </li><li>  application / vnd.ms-excel. </li></ul><br>  Os cabe√ßalhos Content-Type e Accept s√£o e s√£o importantes. <br><br><blockquote>  A API e o cliente devem passar os cabe√ßalhos Content-Type e Accept. <br></blockquote><br>  Se sua API for constru√≠da em JSON, sempre passe Accept: application / json e application-Type application / json. <br><br>  Tipos de arquivo de exemplo. <br><img src="https://habrastorage.org/webt/jd/v_/aa/jdv_aarpo9qnevtro5ddqbgw5ic.png"><br><br>  Os tipos de m√≠dia s√£o semelhantes a esses tipos de arquivos, apenas na Internet. <br><br><h3>  C√≥digos de resposta <br></h3><br>  O pr√≥ximo exemplo das aventuras de nosso desenvolvedor j√∫nior s√£o os c√≥digos de resposta. <br><br><img src="https://habrastorage.org/webt/o4/tc/ci/o4tcci6wnmokubjjdecsy5vwclm.png"><br><br>  A taxa de resposta mais engra√ßada √© 200 OK.  Todo mundo o ama - significa que tudo deu certo.  Eu at√© tive um caso - recebi <strong>erros 200 OK</strong> .  Algo realmente caiu no servidor; em resposta √† resposta, surge uma p√°gina HTML na qual um erro HTML foi compilado.  Solicitei um aplicativo json com o c√≥digo 200 OK e pensei em como trabalhar com ele?  Voc√™ responde, procura a palavra "erro", acha que isso √© um erro. <br><br>  Isso funciona, no entanto, no HTTP, existem muitos outros c√≥digos que voc√™ pode usar e o REST recomenda que voc√™ os use no REST.  Por exemplo, a cria√ß√£o de uma entidade (artigo) pode ser respondida: <br><br><ul><li>  <strong>201 Criado</strong> √© um c√≥digo bem-sucedido.  O artigo √© criado. Em resposta, voc√™ precisa retornar o artigo criado. </li><li>  <strong>202 Aceito</strong> significa que a solicita√ß√£o foi aceita, mas seu resultado ser√° posterior.  Essas s√£o opera√ß√µes de execu√ß√£o longa.  Em Aceito, nenhum corpo pode ser devolvido.  Ou seja, se voc√™ n√£o fornecer o Tipo de Conte√∫do na resposta, o corpo tamb√©m poder√° n√£o ser.  Ou texto / plano de tipo de conte√∫do - isso √© tudo, sem perguntas.  Uma sequ√™ncia vazia √© um texto / plano v√°lido. </li><li>  <strong>204 Sem conte√∫do</strong> - o corpo pode estar completamente ausente. </li><li>  <strong>403 Proibido</strong> - Voc√™ n√£o tem permiss√£o para criar este artigo. </li><li>  <strong>404 N√£o encontrado</strong> - voc√™ subiu em algum lugar errado, n√£o existe, por exemplo. </li><li>  <strong>409 Conflito</strong> √© um caso extremo que poucas pessoas usam.  √Äs vezes, √© necess√°rio se voc√™ estiver gerando um ID no cliente, e n√£o no back-end, e naquele momento algu√©m j√° conseguiu criar este artigo.  Conflito √© a resposta certa neste caso. </li></ul><br><h3>  Cria√ß√£o de Entidades <br></h3><br>  O exemplo a seguir: criamos uma entidade, digamos Content-Type: application / json, e passamos esse aplicativo / json.  Isso torna o cliente - nosso front-end.  Vamos criar este mesmo artigo: <br><br> <code>01. POST /articles /1.1 <br> 02. Content-Type: application/json <br> 03. { "id": 1, "title": " JSON API"}</code> <br> <br>  O c√≥digo pode vir em resposta: <br><br><ul><li>  422 Entidade n√£o process√°vel - Uma entidade n√£o processada.  Tudo parece √≥timo - sem√¢ntica, h√° c√≥digo; </li><li>  403 Proibido </li><li>  500 Erro interno do servidor. </li></ul><br>  Mas √© absolutamente incompreens√≠vel o que exatamente aconteceu: que tipo de entidade n√£o √© processada, por que n√£o devo ir at√© l√° e o que finalmente aconteceu com o servidor? <br><br><h3>  Retornar erros <br></h3><br>  Certifique-se (e os juniores n√£o sabem disso) em resposta, retorne erros.  Isso √© sem√¢ntico e correto.  A prop√≥sito, Fielding n√£o escreveu sobre isso, ou seja, foi inventado mais tarde e constru√≠do sobre o REST. <br><br>  O back-end pode retornar uma matriz com erros de resposta, pode haver v√°rios. <br><br> <code>01. HTTP/1.1 422 Unprocessable Entity <br> 02. Content-Type: application/json <br> 03. <br> 04. { "errors": [{ <br> 05.   "status": "422", <br> 06. <b><font color="#c6e90e">"title": "Title already exist",</font></b> <br> 07. }]}</code> <br> <br>  Cada erro pode ter seu pr√≥prio status e t√≠tulo.  Isso √© √≥timo, mas j√° est√° no n√≠vel da conven√ß√£o, al√©m do REST.  Essa pode ser a nossa ferramenta anti-bikeshedding para parar de discutir e criar uma API correta e imediata. <br><br><h2>  Adicionar pagina√ß√£o <br></h2><br>  O exemplo a seguir: os designers chegam ao nosso desenvolvedor de back-end e dizem: ‚ÄúTemos muitos artigos, precisamos de pagina√ß√£o.  N√≥s desenhamos este. <br><img src="https://habrastorage.org/webt/fn/6l/9t/fn6l9tjzotvgzehwpbezkd0vcf4.png"><br><br>  Vamos considerar com mais detalhes.  Primeiro de tudo, 336 p√°ginas s√£o impressionantes.  Quando vi isso, pensei em como obter esse valor.  Onde obter 336, porque quando solicito uma lista de artigos, recebo uma lista de artigos.  Por exemplo, existem 10 mil deles, ou seja, eu preciso baixar todos os artigos, dividir pelo n√∫mero de p√°ginas e descobrir esse n√∫mero.  Durante muito tempo, carregarei esses artigos, preciso de uma maneira de obter o n√∫mero de entradas rapidamente.  Por√©m, se nossa API retornar uma lista, onde colocar esse n√∫mero de registros em geral, porque uma variedade de artigos vem em resposta.  Acontece que, como o n√∫mero de registros n√£o √© colocado em lugar algum, ele deve ser adicionado a cada artigo para que cada artigo diga: "E h√° tantos de todos n√≥s!" <br><br>  No entanto, existe uma conven√ß√£o na parte superior da API REST que resolve esse problema. <br><br><h3>  Solicita√ß√£o de lista <br></h3><br>  Para tornar a API extens√≠vel, voc√™ pode usar imediatamente os par√¢metros GET para pagina√ß√£o: o tamanho da p√°gina atual e seu n√∫mero, para que exatamente a parte da p√°gina solicitada nos seja devolvida.  Isso √© conveniente.  Em resposta, voc√™ n√£o pode fornecer imediatamente uma matriz, mas adicionar aninhamento adicional.  Por exemplo, a chave de dados conter√° uma matriz, os dados solicitados e a meta-chave, que n√£o existia antes, conter√° o total. <br><br> <code>01. GET /articles? <b><font color="#c6e90e">page[size]=30&amp;page[number]=2</font></b> <br> 02. Content-Type: application/json <br></code> <br> <code>01. HTTP/1.1 200 OK <br> 02. { <br> 03.   "data": [{ "id": 1, "title": "JSONAPI"}, ...], <br> 04.   "meta": { <b><font color="#c6e90e">"count": 10080</font></b> } <br> 05. } <br></code> <br>  Dessa maneira, a API pode retornar informa√ß√µes adicionais.  Al√©m da contagem, pode haver outras informa√ß√µes - elas s√£o extens√≠veis.  Agora, se o j√∫nior n√£o fez isso imediatamente, e somente depois que ele foi solicitado a fazer a pajiniza√ß√£o, ele <strong>fez a altera√ß√£o incompat√≠vel</strong> com a vers√£o <strong>anterior</strong> , quebrou a API e todos os clientes tiveram que refaz√™-la - geralmente d√≥i muito. <br><br>  Pajiniza√ß√£o √© diferente.  Eu ofere√ßo v√°rios hacks que voc√™ pode usar. <br><br><h4>  [deslocamento] ... [limite] <br></h4><br> <code>01. GET /articles? <b><font color="#c6e90e">page[offset]=30&amp;page[limit]=30</font></b> <br> 02. Content-Type: application/json <br></code> <br> <code>01. HTTP/1.1 200 OK <br> 02. { <br> 03.   "data": [{ "id": 1, "title": "JSONAPI"}, ...], <br> 04.   "meta": { "count": 10080 } <br> 05. } <br></code> <br>  Quem trabalha com bancos de dados j√° pode ter um subc√≥rtex [deslocamento] ... [limite].  Us√°-lo em vez do tamanho da p√°gina ... p√°gina [n√∫mero] ser√° mais f√°cil.  Essa √© uma abordagem um pouco diferente. <br><br><h4>  Posicionamento do cursor <br></h4><br> <code>01. GET /articles? <b><font color="#c6e90e">page[published_at]=1538332156</font></b> <br> 02. Content-Type: application/json</code> <br> <br> <code>01. HTTP/1.1 200 OK <br> 02. { <br> 03.    "data": [{ "id": 1, "title": "JSONAPI"}, ...], <br> 04.    "meta": { "count": 10080 } <br> 05. }</code> <br> <br>  A localiza√ß√£o do cursor usa um ponteiro para a entidade com a qual iniciar o carregamento de registros.  Por exemplo, √© muito conveniente quando voc√™ usa pagina√ß√£o ou carregamento em listas que mudam frequentemente.  Digamos que novos artigos sejam constantemente escritos em nosso blog.  A terceira p√°gina agora n√£o √© a mesma terceira p√°gina em um minuto, mas se formos para a quarta p√°gina, obteremos alguns registros da terceira p√°gina, porque a lista inteira ser√° movida. <br><br>  Esse problema √© resolvido pela pagina√ß√£o do cursor.  Dizemos: ‚ÄúCarregue os artigos que v√™m depois do artigo publicado naquele momento‚Äù - n√£o pode haver mais mudan√ßa puramente tecnol√≥gica, e isso √© legal. <br><br><h2>  Problema N +1 <br></h2><br>  O pr√≥ximo problema que nosso desenvolvedor j√∫nior definitivamente encontrar√° √© o problema N + 1 (os backenders entender√£o).  Suponha que voc√™ queira listar uma lista de 10 artigos.  Carregamos uma lista de artigos, cada artigo tem um autor e, para cada um, voc√™ precisa fazer o download de um autor.  N√≥s enviamos: <br><br><ul><li>  1 pedido de uma lista de artigos; </li><li>  10 pedidos para os autores de cada artigo. </li></ul><br>  Total: 11 consultas para exibir uma pequena lista. <br><br><h3>  Adicionar links <br></h3><br>  No back-end, esse problema √© resolvido em todos os ORMs - voc√™ s√≥ precisa se lembrar de adicionar esta conex√£o.  Essas conex√µes tamb√©m podem ser usadas no front-end.  Isso √© feito da seguinte maneira: <br><br> <code>01. GET /articles? <b><font color="#c6e90e">include =author</font></b> <br> 02. Content-Type: application/json <br></code> <br>  Voc√™ pode usar um par√¢metro GET especial, chame-o de incluir (como no back-end), dizendo quais links precisamos carregar junto com os artigos.  Suponha que fa√ßamos o upload de artigos e queremos que o autor entre imediatamente com os artigos.  A resposta √© assim: <br><br> <code>01. /1.1 200  <br> 02. { "data": [{ <br> 03.  { attributes: { "id": 1, "title": "JSON API" }, <br> 04.  { relationships: { <br> 05. <b><font color="#c6e90e">"author": { "id": 1, "name": "Avdeev" } }</font></b> <br> 06.  }, ... <br> 07. }]}</code> <br> <br>  Os pr√≥prios atributos do artigo foram transferidos para os dados e os principais relacionamentos foram adicionados.  Colocamos todas as conex√µes nessa chave.  Assim, com uma solicita√ß√£o, recebemos todos os dados que recebiam 11 solicita√ß√µes anteriormente.  Este √© um truque interessante que resolve o problema com o N + 1 no front end. <br><br><h2>  O problema da duplica√ß√£o de dados <br></h2><br>  Suponha que voc√™ queira exibir 10 artigos indicando o autor, todos os artigos t√™m um autor, mas o objeto com o autor √© muito grande (por exemplo, um sobrenome muito longo, com um megabyte).  Um autor √© inclu√≠do na resposta 10 vezes e 10 inclus√µes do mesmo autor na resposta ter√£o 10 MB. <br><br>  Como todos os objetos s√£o iguais, o problema de um autor ser inclu√≠do 10 vezes (10 MB) √© resolvido com a ajuda da normaliza√ß√£o, usada em bancos de dados.  No front-end, voc√™ tamb√©m pode usar a normaliza√ß√£o ao trabalhar com a API - isso √© muito legal. <br><br> <code>01. /1.1 200  <br> 02. { "data": [{ <br> 03. "id": "1‚Ä≥, <b><font color="#c6e90e">"type": "article",</font></b> <br> 04. "attributes": { "title": "JSON API" }, <br> 05. "relationships": { ... } <br> 06.  "author": { "id": 1, <b><font color="#c6e90e">"type": "people"</font></b> } } <br> 07. }, ... ] <br> 08. }</code> <br> <br>  Marcamos todas as entidades com algum tipo (este √© um tipo de representa√ß√£o, um tipo de recurso).  Roy Fielding introduziu o conceito de recurso, ou seja, eles solicitaram artigos - receberam um "artigo".  Nos relacionamentos, colocamos um link para o tipo de pessoas, ou seja, ainda temos o recurso de pessoas em outro lugar.  E o pr√≥prio recurso que utilizamos em uma chave separada inclu√≠da, que fica no mesmo n√≠vel dos dados. <br><br> <code>01. /1.1 200  <br> 02. { <br> 03. "data": [ ... ], <br> 04. <b><font color="#c6e90e">"included":</font></b> [{ <br> 05.  "id": 1, "type": "people", <br> 06.  "attributes": { "name": "Avdeev" } <br> 07. }] <br> 08. }</code> <br> <br>  Assim, todas as entidades relacionadas em uma √∫nica inst√¢ncia caem na chave especial inclu√≠da.  Armazenamos apenas links e as pr√≥prias entidades s√£o armazenadas em inclu√≠das. <br><br>  O tamanho da solicita√ß√£o diminuiu.  Este √© um truque de vida sobre o qual o back-end inicial n√£o sabe.  Ele descobrir√° mais tarde quando precisar quebrar a API. <br><br><h3>  Nem todos os campos de recursos s√£o necess√°rios <br></h3><br>  O seguinte truque de vida pode ser aplicado quando nem todos os campos de recursos s√£o necess√°rios.  Isso √© feito usando um par√¢metro GET especial, que lista os atributos a serem retornados, separados por v√≠rgulas.  Por exemplo, o artigo √© grande e pode haver megabytes no campo de conte√∫do, e precisamos exibir apenas a lista de cabe√ßalhos - n√£o precisamos do conte√∫do na resposta. <br><br> <code>GET /articles <b><font color="#c6e90e">?fields[article]=title /1.1</font></b></code> <br> <br> <code>01. /1.1 200 OK <br> 02. { "data": [{ <br> 03.  "id": "1‚Ä≥, "type": "article", <br> 04.  "attributes": { <b><font color="#c6e90e">"title": " JSON API"</font></b> }, <br> 05.  }, ... ] <br> 06. }</code> <br> <br>  Se voc√™ precisar, por exemplo, tamb√©m da data de publica√ß√£o, poder√° escrever uma "data publicada" separada por v√≠rgula.  Em resposta, dois campos vir√£o em atributos.  Esta √© uma conven√ß√£o que pode ser usada como uma ferramenta anti-ciclismo. <br><br><h3>  Pesquisa por artigos <br></h3><br>  Muitas vezes, precisamos de pesquisas e filtros.  Existem conven√ß√µes para isso - filtros especiais par√¢metros GET: <br><br>  ‚óè <code>GET /articles <b><font color="#c6e90e">?filters[search]=api</font></b> HTTP/1.1</code> - pesquisa; <br>  ‚óè <code>GET /articles <b><font color="#c6e90e">?fiIters[from_date]=1538332156</font></b> HTTP/1.1</code> - fa√ßa o download de artigos a partir de uma data espec√≠fica; <br>  ‚óè <code>GET /articles <b><font color="#c6e90e">?filters[is_published]=true</font></b> HTTP/1.1</code> - baixar artigos que acabam de ser publicados; <br>  ‚óè <code>GET /articles <b><font color="#c6e90e">?fiIters[author]=1</font></b> HTTP/1.1</code> - fa√ßa o download de artigos com o primeiro autor. <br><br><h3>  Classificando artigos <br></h3><br>  ‚óè <code>GET /articles <b><font color="#c6e90e">?sort=title</font></b> /1.1</code> - por t√≠tulo; <br>  ‚óè <code>GET /articles <b><font color="#c6e90e">?sort=published_at</font></b> HTTP/1.1</code> - por data de publica√ß√£o; <br>  ‚óè <code>GET /articles <b><font color="#c6e90e">?sort=-published_at</font></b> HTTP/1.1</code> - por data de publica√ß√£o na dire√ß√£o oposta; <br>  ‚óè <code>GET /articles <b><font color="#c6e90e">?sort=author,-publisbed_at</font></b> HTTP/1.1</code> - primeiro pelo autor, depois pela data de publica√ß√£o na dire√ß√£o oposta, se os artigos forem do mesmo autor. <br><br><h2>  Precisa alterar URLs <br></h2><br>  Solu√ß√£o: a hiperm√≠dia, que eu j√° mencionei, pode ser feita da seguinte maneira.  Se quisermos que o objeto (recurso) seja auto-descritivo, o cliente poder√° entender por meio da hiperm√≠dia o que pode ser feito com ele e o servidor poder√° desenvolver-se independentemente do cliente. Em seguida, voc√™ poder√° adicionar links √† lista de artigos, ao pr√≥prio artigo usando chaves de links especiais : <br><br> <code><code>01. GET /articles /1.1 <br> 02. { <br> 03. "data": [{ <br> 04.  ... <br> 05. <b><font color="#c6e90e">"links": { "self": "http://localhost/articles/1"</font></b></code> }, <br> 06.  "relationships": { ... } <br> 07. }], <br> 08. <b><font color="#c6e90e">"links": { "self": " <code>http://localhost/articles</code> " }</font></b> <br> 09. } <br></code> <br>  Ou relacionado, se quisermos dizer ao cliente como fazer upload de um coment√°rio neste artigo: <br><br> <code><code>01. ... <br> 02. "relationships": { <br> 03. "comments": { <br> 04.  "links": { <br> 05. <b><font color="#c6e90e">"self": "http://localhost/articles/l/relationships/comments</font></b></code> ", <br> 06. <b><font color="#c6e90e">"related": " <code>http://localhost/articles/l/comments</code> "</font></b> <br> 07.  } <br> 08. } <br> 09. }</code> <br>  O cliente v√™ que existe um link, segue-o, carrega um coment√°rio.  Se n√£o houver link, n√£o haver√° coment√°rios.  Isso √© conveniente, mas poucos o fazem.  Fielding apresentou os princ√≠pios do REST, mas nem todos eles entraram em nosso setor.  N√≥s usamos principalmente dois ou tr√™s. <br><br>  Em 2013, todos os hacks que eu contei, Steve Klabnik foram combinados com a especifica√ß√£o da API JSON e registrados como um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">novo tipo de m√≠dia, al√©m do JSON</a> .  Portanto, nosso desenvolvedor j√∫nior de back-end, evoluindo gradualmente, chegou √† API JSON. <br><br><h2>  API JSON <br></h2><br>  Tudo √© descrito em detalhes em <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">http://jsonapi.org/implementations/</a> : h√° at√© uma lista de 170 implementa√ß√µes de especifica√ß√µes diferentes para 32 linguagens de programa√ß√£o - e elas s√£o adicionadas apenas ao cat√°logo.  Bibliotecas, analisadores, serializadores etc. j√° foram gravados. <br><br>  Como essa especifica√ß√£o √© de c√≥digo aberto, todos est√£o investindo nela.  Entre outras coisas, eu mesmo escrevi algo.  Estou certo de que existem muitas dessas pessoas.  Voc√™ pode participar deste projeto voc√™ mesmo. <br><br><h4>  Profissionais da API JSON <br></h4><br>  A especifica√ß√£o da API JSON resolve v√°rios problemas - um <strong>acordo comum para todos</strong> .  Como existe um acordo geral, n√£o discutimos <strong>dentro da equipe</strong> - o dep√≥sito de bicicletas est√° documentado.  N√≥s temos um acordo sobre quais materiais fabricar uma bicicleta e como pint√°-la. <br><br>  Agora, quando o desenvolvedor faz algo errado e eu o vejo, n√£o inicio a discuss√£o, mas digo: "N√£o pela API JSON!"  e mostrar no lugar na especifica√ß√£o.  Eles me odeiam na empresa, mas gradualmente se acostumam e todos come√ßaram a gostar da API JSON.  Criamos novos servi√ßos padr√£o de acordo com esta especifica√ß√£o.  Temos uma chave de data, estamos prontos para adicionar meta, incluir chaves.  H√° um filtro de par√¢metro GET reservado para filtros.  N√£o discutimos o que chamar de filtro - usamos essa especifica√ß√£o.  Ele descreve como criar um URL. <br><br>  Como n√£o estamos discutindo, mas realizando tarefas de neg√≥cios, a <strong>produtividade do desenvolvimento √© maior</strong> .  Temos as especifica√ß√µes descritas, o desenvolvedor leu o back-end, criou a API, n√≥s estragamos tudo - o cliente est√° feliz. <br><br>  <strong>Problemas populares j√° foram resolvidos</strong> , por exemplo, com pagina√ß√£o.  H√° muitas dicas nas especifica√ß√µes. <br><br>  Como √© JSON (gra√ßas a Douglas Crockford por esse formato), √© mais conciso que XML, √© bastante <strong>f√°cil de ler e entender</strong> . <br><br>  O fato de ser um <strong>c√≥digo aberto</strong> pode ser um sinal de mais e de menos, mas eu amo o c√≥digo aberto. <br><br><h4>  Contras API JSON <br></h4><br>  O objeto cresceu (data, atributos, inclu√≠dos etc.) - o <strong>front</strong> - <strong>end precisa analisar as respostas:</strong> seja capaz de iterar sobre matrizes, caminhar ao redor do objeto e saber como reduzir funciona.  Nem todos os desenvolvedores iniciantes sabem essas coisas complexas.  Existem bibliotecas de serializadores / desserializadores, voc√™ pode us√°-los.  Em geral, isso √© apenas trabalhar com dados, mas os objetos s√£o grandes. <br><br>  E o <strong>back-end tem</strong> dor: <br><br><ul><li>  Controle de aninhamento - incluir pode ser escalado muito longe; </li><li>  A complexidade das consultas ao banco de dados - elas √†s vezes s√£o criadas automaticamente e se tornam muito dif√≠ceis; </li><li>  Seguran√ßa - voc√™ pode subir na selva, principalmente se conectar algum tipo de biblioteca; </li><li>  A especifica√ß√£o √© dif√≠cil de ler.  Ela est√° em ingl√™s, e isso assustou alguns, mas gradualmente todos se acostumaram; </li><li>  Nem todas as bibliotecas implementam bem a especifica√ß√£o - esse √© um problema de c√≥digo aberto. </li></ul><br><h4>  API JSON de armadilhas <br></h4><br>  Um pouco de hardcore. <br><br>  <strong>O n√∫mero de relacionamentos no problema n√£o √© limitado.</strong>  Se incluirmos, solicitarmos artigos, adicionar coment√°rios a eles, em resposta, receberemos todos os coment√°rios deste artigo.  Existem 10.000 coment√°rios - obtenha todos os 10.000 coment√°rios: <br><br> <code>GET /articles/1?include=comments /1.1</code> <br> <br> <code>01. ... <br> 02. "relationships": { <br> 03. "comments": { <br> 04.  "data": <b><font color="#c6e90e">[0 ... ‚àû]</font></b> <br> 05. } <br> 06. }</code> <br> <br>  Assim, na verdade, 5 MB chegaram ao nosso pedido em resposta: ‚ÄúEst√° escrito na especifica√ß√£o - √© necess√°rio reformular o pedido corretamente: <br><br> <code>GET /comments? <b><font color="#c6e90e">filters[article]=1&amp;</font></b> page[size]=30 HTTP/1.1</code> <br> <br> <code>01. { <br> 02. "data": <b><font color="#c6e90e">[0 ... 29]</font></b> <br> 03. }</code> <br> <br>  Solicitamos coment√°rios com um filtro por artigo, digamos: "30 pe√ßas, por favor" e recebemos 30 coment√°rios.  Isso √© ambiguidade. <br><br>  <strong>As mesmas coisas podem ser formuladas de forma amb√≠gua</strong> : <br><br>  ‚óè <code>GET /articles/1 <b><font color="#c6e90e">?include=comments</font></b> HTTP/1.1</code> - solicita um artigo com coment√°rios; <br>  ‚óè <code>GET /articles/1/comments HTTP/1.1</code> - solicita coment√°rios sobre o artigo; <br>  ‚óè <code>GET /comments <b><font color="#c6e90e">?filters[article]=1</font></b> HTTP/1.1</code> - solicita coment√°rios com um filtro por artigo. <br><br>  √â o mesmo - os mesmos dados, obtidos de maneiras diferentes, h√° alguma ambiguidade.  Esta armadilha n√£o √© imediatamente vis√≠vel. <br><br>  <strong>Um-para-muitos relacionamentos polim√≥rficos</strong> rastejam no REST muito rapidamente. <br><br> <code>01. GET /comments?include=commentable /1.1 <br> 02. <br> 03. ... <br> 04. "relationships": { <br> 05. <b><font color="#c6e90e">"commentable"</font></b> : { <br> 06.  "data": { "type": "article", "id": "1‚Ä≥ } <br> 07. } <br> 08. }</code> <br> <br>  H√° uma conex√£o polim√≥rfica coment√°vel no back-end - ela rastreia para o REST.  Ent√£o isso deve acontecer, mas pode ser disfar√ßado.  Voc√™ n√£o pode disfar√ßar a API JSON - ela ser√° lan√ßada. <br><br>  <strong>Relacionamentos muitos para muitos complexos com op√ß√µes avan√ßadas</strong> .  Al√©m disso, todas as tabelas de conex√£o s√£o exibidas: <br><br> <code>01. GET /users?include <b><font color="#c6e90e">=users_comments</font></b> /1.1 <br> 02. <br> 03. ... <br> 04. "relationships": { <br> 05. "users_comments": { <br> 06.  "data": [{ "type": "users_comments", "id": "1‚Ä≥ }, ...] <br> 07. }, <br> 08. }</code> <br> <br><h2>  Swagger <br></h2><br>  O Swagger √© uma ferramenta de escrita de documenta√ß√£o on-line. <br><br>  Digamos que nosso desenvolvedor de back-end foi convidado a escrever a documenta√ß√£o para sua API e ele a escreveu.  Isso √© f√°cil se a API for simples.  Se essa √© uma API JSON, o Swagger n√£o pode ser gravado t√£o facilmente. <br><br>  <strong>Exemplo:</strong> loja de animais Swagger.  Cada m√©todo pode ser aberto, consulte resposta e exemplos. <br><br><img src="https://habrastorage.org/webt/ul/lj/yk/ulljykpo7bhyw85r9ru69k2nuxe.png"><br><br>  Este √© um exemplo de um modelo de animal de estima√ß√£o.  Aqui est√° uma interface legal, tudo √© f√°cil de ler. <br><br><img src="https://habrastorage.org/webt/i9/rg/ir/i9rgirjcdxgm16ogmtopu6dnjrq.png"><br><br>  E √© assim que a cria√ß√£o do modelo da API JSON se parece: <br><br><img src="https://habrastorage.org/webt/ty/14/kn/ty14knt_laxzsr2ozusbo0xkk0c.png"><br><br>  Isso n√£o √© t√£o bom.  Precisamos de dados, em dados com relacionamentos, inclu√≠dos 5 tipos de modelos, etc.  Voc√™ pode escrever o Swagger, a API aberta √© uma coisa poderosa, mas complicada. <br><br><h2>  Alternativa <br></h2><br>  Existe uma especifica√ß√£o OData, que apareceu um pouco mais tarde - em 2015.  Esta √© "a melhor maneira de descansar", como garante o site oficial.  √â assim: <br><br>  <code>01. GET http://services.odata.org/v4/TripRW/People HTTP/1.1</code> - solicita√ß√£o GET; <br>  <code>02. OData-Version: 4.0</code> - cabe√ßalho especial com vers√£o; <br>  <code>03. OData-MaxVersion: 4.0</code> - Segundo cabe√ßalho da vers√£o especial <br><br>  A resposta √© assim: <br><br> <code>01. HTTP/1.1 200 OK <br> 02. Content-Type: application/json; odata.metadata=minimal <br> 03. OData-Version: 4.0 <br> 04. { <br> 05. '@odata.context': 'http://services.odata.org/V4/ <br> 06. '@odata.nextLink' : 'http://services.odata.org/V4/ <br> 07. 'value': [{ <br> 08.  '@odata.etag': 1W/108D1D5BD423E51581‚Ä≤, <br> 09.  'UserName': 'russellwhyte', <br> 10.  ... <br></code> <br>  Aqui est√° o aplicativo / json e o objeto estendidos. <br><br>  Primeiro, n√£o usamos o OData, pois √© o mesmo que a API JSON, mas n√£o √© conciso.  Existem objetos enormes e me parece que tudo √© muito pior.  O OData tamb√©m saiu em c√≥digo aberto, mas √© mais complicado. <br><br><h2>  E o GraphQL? <br></h2><br>  Naturalmente, quando procur√°vamos um novo formato de API, encontramos esse hype. <br><br>  ‚óè <strong>Limiar alto de entrada.</strong> <br><br>  Do ponto de vista do frontend, tudo parece legal, mas voc√™ n√£o pode fazer o novo desenvolvedor escrever o GraphQL, porque voc√™ precisa estud√°-lo primeiro.  √â como o SQL - voc√™ n√£o pode escrever o SQL imediatamente, voc√™ deve pelo menos ler o que √©, seguir os tutoriais, ou seja, o limite de entrada aumenta. <br><br>  ‚óè <strong>O efeito do big bang.</strong> <br><br>  Se n√£o havia API no projeto e come√ßamos a usar o GraphQL, depois de um m√™s percebemos que isso n√£o nos convinha, ser√° tarde demais.  Tem que escrever muletas.  Voc√™ pode evoluir com a API JSON ou OData - o RESTful mais simples, que melhora progressivamente, se transforma em uma API JSON. <br><br>  ‚óè <strong>Inferno no back-end.</strong> <br><br>  O GraphQL chama o inferno no back-end - um a um, assim como a API JSON totalmente implementada, porque o GraphQL obt√©m controle total sobre as consultas, e essa √© uma biblioteca, e voc√™ precisar√° resolver v√°rias perguntas: <br><br><ul><li>  controle de aninhamento; </li><li>  recurs√£o </li><li>  limita√ß√£o de frequ√™ncia; </li><li>  controle de acesso. </li></ul><br><h2>  Em vez de conclus√µes <br></h2><br>  Eu recomendo parar de discutir sobre o galp√£o da bicicleta e usar a ferramenta anti-ciclismo como uma especifica√ß√£o e apenas fazer uma API com uma boa especifica√ß√£o. <br><br>  Para encontrar seu padr√£o para resolver o problema de um galp√£o de bicicleta, voc√™ pode olhar para estes links: <br><br>  ‚óè <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">http://jsonapi.org</a> <br>  ‚óè <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">http://www.odata.org</a> <br>  ‚óè <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">https://graphgl.org</a> <br> ‚óè <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">http://xmlrpc.scripting.com</a> <br> ‚óè <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">https://www.jsonrpc.org</a> <br><br> <strong>   :</strong> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">alexey-avdeev.com</a>    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">github</a> . <br><br><blockquote> ,  <strong>  </strong>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Frontend Conf</a> ,   27  28    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">++</a> .     ,        . <br><br> <strong>   ?</strong>      ?        ?    ,        ? <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="> </a> ! <br><br>      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="></a> ,  ,   ,    ,      . <br></blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt433322/">https://habr.com/ru/post/pt433322/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt433306/index.html">Visual studio 2019</a></li>
<li><a href="../pt433308/index.html">Transferindo a configura√ß√£o do PBX para o servi√ßo 3CX PBX Express</a></li>
<li><a href="../pt433316/index.html">Resumo do projeto: integra√ß√£o, feedback, busca de id√©ias e tomada de decis√£o</a></li>
<li><a href="../pt433318/index.html">garbage.collect ()</a></li>
<li><a href="../pt433320/index.html">Layout da grade como base dos layouts modernos</a></li>
<li><a href="../pt433324/index.html">Coletando o pacote de sonhos com o Webpack</a></li>
<li><a href="../pt433326/index.html">Qualidade do c√≥digo</a></li>
<li><a href="../pt433328/index.html">Melhor perder um dia</a></li>
<li><a href="../pt433330/index.html">Resolver palavras cruzadas em japon√™s com o SAT Solver</a></li>
<li><a href="../pt433332/index.html">Suporte de Python nas fun√ß√µes do Azure</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>