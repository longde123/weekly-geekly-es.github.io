<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚õ¥Ô∏è üåÅ üë®‚Äç‚öñÔ∏è C√≥mo reestructuramos los pron√≥sticos pobres en pron√≥sticos ligeramente mejores (continuaci√≥n) üõ∏ üöö üõçÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="En un art√≠culo anterior, habl√© sobre c√≥mo, con el prop√≥sito de pronosticar ingresos, las personas crearon un archivo de Excel grande y complejo ( pued...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>C√≥mo reestructuramos los pron√≥sticos pobres en pron√≥sticos ligeramente mejores (continuaci√≥n)</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/424933/"><p>  En un art√≠culo anterior, habl√© sobre c√≥mo, con el prop√≥sito de pronosticar ingresos, las personas crearon un archivo de Excel grande y complejo ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">puede leerlo aqu√≠</a> ).  Decidimos intervenir en esta verg√ºenza y propusimos rehacer el modelo de pron√≥stico para que hubiera menos errores, una operaci√≥n m√°s f√°cil y una flexibilidad en el ajuste. </p><br><h3 id="kakie-klyuchevye-problemy-v-opisannoy-modeli">  ¬øCu√°les son los problemas clave en el modelo descrito? </h3><br><ol><li>  Los datos, el modelo y las vistas se mezclan en una sola entidad.  Debido a esto, un cambio en al menos un elemento destruye todo este monolito. </li><li>  C√°lculo excesivo para el procesamiento manual, lo que da lugar a errores y errores tipogr√°ficos en grandes cantidades. </li></ol><br><h3 id="chto-my-predlozhili">  Lo que sugerimos: </h3><br><ol><li>  En el modelo inicial, los datos iniciales sobre los que se construy√≥ no aparec√≠an en ninguna parte.  Propusimos ingresar estos datos en el formato de la segunda forma normal en el archivo Excel en 2 hojas separadas (ventas y n√∫mero de clientes).  Afortunadamente, los datos de ventas en nuestra agregaci√≥n por mes son solo decenas de miles de l√≠neas, no millones.  Tambi√©n configuramos para recibir estos datos usando Power Query directamente desde la base de datos. <a name="habracut"></a></li><li>  Creamos una hoja de modelado, que consta de 3 bloques: <br><ul><li>  Tabla de pivote de ingresos </li><li>  Tabla resumen del n√∫mero de clientes. </li><li>  Tabla de liquidaci√≥n de cheques promedio <br>  Cada tabla din√°mica es una tabla din√°mica construida sobre los datos de origen en los detalles requeridos para la simulaci√≥n actual por departamentos y unidades, en los detalles requeridos sobre per√≠odos (meses). <br><img src="https://habrastorage.org/webt/uv/3z/mh/uv3zmh-wl4awfrj6rfexngymb5q.png"></li></ul></li><li>  En la Hoja de simulaci√≥n, creamos modelos de pron√≥stico simples basados ‚Äã‚Äãen series de tiempo hist√≥ricas.  Ampliamos el n√∫mero de clientes y la factura promedio, y los ingresos totales previstos se consideraron como un producto de estos valores.  Despu√©s de revisar los datos, se nos ocurrieron 3 modelos de pron√≥stico: mediana para per√≠odos pasados, suavizado exponencial triple y reducci√≥n a cero (cuando necesitamos 0 pron√≥stico). <br><img src="https://habrastorage.org/webt/xn/-e/x7/xn-ex79q2h2-u1ntngvxiavkr0m.png"></li><li>  El c√°lculo del recibo promedio (hecho) y los ingresos (pron√≥stico) no se hace haciendo referencia a las celdas, sino usando VLR y marca de desplazamiento, lo que hace que los c√°lculos sean resistentes a los cambios en los datos iniciales. <br><img src="https://habrastorage.org/webt/gn/y7/sw/gny7swii7rerdwbdgdswbbbllps.png"></li><li>  Est√° claro que ahora el usuario no puede leer el modelo, porque  Hay demasiados significados.  Para hacer esto, construimos hojas de unidades separadas.  Cada hoja tiene una celda que selecciona qu√© datos deben resumirse en esta hoja.  Seg√∫n VLOOKUP, extraemos datos de la hoja del modelo a la hoja. </li><li>  La creaci√≥n de 30 hojas por unidades se realiz√≥ de acuerdo con un procedimiento especial.  Primero, se crea la primera hoja, una de las unidades, que contiene todos los nombres posibles de los departamentos.  Si no hay un departamento en una subdivisi√≥n, entonces las f√≥rmulas los devuelven a 0. Para hacer las 30 subdivisiones, creamos duplicados y cambiamos los nombres en la celda de control (se usa para generar la clave BUSCARV) y tenemos los datos necesarios en el formulario de presentaci√≥n.  VLOOKUP puede usar m√°s de 1 celda como clave, si usa el truco: combine las celdas que necesita en una usando la concatenaci√≥n (la funci√≥n CLIP o el s√≠mbolo &amp;). </li><li>  Se ha agregado un elemento al formulario de presentaci√≥n que le permite controlar el modelo: un simple multiplicador de los valores pronosticados de la verificaci√≥n y el n√∫mero promedio.  Este elemento se recopila en una hoja t√©cnica especial utilizando la funci√≥n INDIRECTA, que le permite utilizar el enlace generado.  Desde esta hoja t√©cnica, todas estas correcciones se transfieren utilizando la BUSCARV a la hoja modelo. <br><img src="https://habrastorage.org/webt/nn/pw/zv/nnpwzvykp3sqghpaimfbouefgkk.png"></li><li>  Las hojas de generalizaci√≥n ya no son una suma de hojas de presentaci√≥n, sino que se construyen exactamente de la misma manera que todas las dem√°s hojas, sumando los datos en una hoja con un modelo.  Como resultado, las representaciones son representaciones puras y no tienen dependencias entre ellas. </li></ol><br><h3 id="chto-my-poluchili">  Lo que tenemos </h3><br><ol><li>  Siempre est√° claro de qu√© d√≠gitos obtuvimos los datos (porque se guard√≥ la consulta Power Query). </li><li>  Podemos cambiar los datos sin romper el modelo. </li><li>  Los cambios en la estructura y la jerarqu√≠a requerir√°n modificaciones menores (solo necesita cambiar los nombres en 1 hoja de la presentaci√≥n y luego hacer que se duplique). </li><li>  Redujimos dr√°sticamente la cantidad de posibles errores, porque  La mayor√≠a de los datos se completan con f√≥rmulas, enlaces y claves. </li><li>  El cliente recibi√≥ un pron√≥stico interactivo, en el que puede cambiar los valores √©l mismo e inmediatamente recibir un pron√≥stico. </li><li>  Pudimos satisfacer simult√°neamente los requisitos de que necesitamos datos tanto en t√©rminos anuales como mensuales. </li><li>  Se puede usar en el pr√≥ximo per√≠odo presupuestario. </li><li>  Puede cambiar los modelos de pron√≥stico si nos parecen inapropiados. </li></ol><br><h3 id="pochemu-my-reshili-ostatsya-v-eksele-a-ne-peredelali-eto-na-kakie-to-drugie-tehnologii">  ¬øPor qu√© decidimos quedarnos en Excel y no rehacerlo en otras tecnolog√≠as? </h3><br><ol><li>  Necesit√°bamos dejar este archivo en la operaci√≥n de los empleados actuales.  Dentro de Excel, es m√°s f√°cil para nosotros mostrar c√≥mo funciona todo esto y qu√© pueden solucionar. </li><li>  Excel hace frente a la tarea y a otras soluciones: entidades superfluas. </li><li>  El cliente est√° acostumbrado a este formulario y a "reentrenar" ciertos costos laborales que no pod√≠amos pagar. </li></ol><br><p>  Cu√°nto tiempo nos llev√≥: alrededor de 5 d√≠as h√°biles, donde 1 persona pas√≥ de 2 a 4 horas al d√≠a, y al final del d√≠a hicimos una revisi√≥n de los resultados. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es424933/">https://habr.com/ru/post/es424933/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es424921/index.html">C√≥mo las matem√°ticas de la red pueden ayudarte a hacer amigos</a></li>
<li><a href="../es424923/index.html">Conoce a los anarquistas automedicados</a></li>
<li><a href="../es424925/index.html">Wi-Fi es m√°s seguro: todo lo que necesita saber sobre WPA3</a></li>
<li><a href="../es424927/index.html">A la sombra del gran cosmos</a></li>
<li><a href="../es424929/index.html">Milagro asi√°tico Shimano: la historia del legendario fabricante de equipos para bicicletas</a></li>
<li><a href="../es424935/index.html">Food Design Digest, septiembre de 2018</a></li>
<li><a href="../es424937/index.html">Eventos digitales en Mosc√∫ del 1 al 7 de octubre</a></li>
<li><a href="../es424939/index.html">Quine polim√≥rfico</a></li>
<li><a href="../es424941/index.html">Transmisi√≥n de datos desde un servicio REST a una cola MQ</a></li>
<li><a href="../es424945/index.html">Smartphone est√° conduciendo un autom√≥vil de juguete.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>