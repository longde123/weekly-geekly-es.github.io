<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßòüèæ üéê üéá ATmega16 + DS18B20 + LED + Matlab / Simulink = AR üëú #‚É£ üßõüèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="J'ai pens√© √† jouer avec les capteurs DS18B20 . Oui, non seulement pour obtenir les valeurs de temp√©rature (ce que tout le monde peut faire), mais auss...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ATmega16 + DS18B20 + LED + Matlab / Simulink = AR</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/390985/"><img align="left" src="https://habrastorage.org/files/e2a/4a8/d70/e2a4a8d7092845e082baee85d185ebd2.bmp"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">J'ai pens√© √† jouer avec les capteurs </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DS18B20</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Oui, non seulement pour obtenir les valeurs de temp√©rature (ce que tout le monde peut faire), mais aussi pour les visualiser. </font><font style="vertical-align: inherit;">Il y avait une id√©e simple. </font><font style="vertical-align: inherit;">Nous avons mis la webcam. </font><font style="vertical-align: inherit;">Nous allumons la lumi√®re sur un cadre pair, sur un cadre impair nous l'√©teignons. </font><font style="vertical-align: inherit;">Soustrayez l'image - il ne reste que le flash. </font><font style="vertical-align: inherit;">Sur celui-ci, nous recherchons l'emplacement du capteur, qui est physiquement attach√© √† la LED dans l'espace. </font><font style="vertical-align: inherit;">Et puis le traitement math√©matique. </font><font style="vertical-align: inherit;">Eh bien, tout cela dans simulinka. </font><font style="vertical-align: inherit;">Sous katom, il est d√©crit comment recevoir de belles images. </font><font style="vertical-align: inherit;">Et pour ceux qui ne veulent pas comprendre, je sugg√®re de regarder les exp√©riences √† la fin de l'article.</font></font><br>
<a name="habracut"></a><br>
<br clear="left">
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Circuits</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le circuit est extr√™mement simple. </font><font style="vertical-align: inherit;">Le c≈ìur est l'ATmega16. </font><font style="vertical-align: inherit;">Tous les capteurs DS18B20 sont accroch√©s √† une broche (dans mon cas, sur PB0 du port PORTB). </font><font style="vertical-align: inherit;">La broche elle-m√™me est tir√©e √† la tension d'alimentation via une r√©sistance de 4,7 kŒ©. </font><font style="vertical-align: inherit;">Le sch√©ma est √©volutif. </font><font style="vertical-align: inherit;">L'image est cliquable.</font></font><br>
<br>
<a href=""><img src="https://habrastorage.org/files/1d6/87f/7dd/1d687f7ddbbc4e29858d20b4ceebcfe7.bmp"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Toutes les LED sont connect√©es au port PORTA via des r√©sistances de terminaison. </font><font style="vertical-align: inherit;">Un polygone gris signifie que cette LED est physiquement connect√©e au DS18B20. </font><font style="vertical-align: inherit;">La broche de r√©initialisation est tir√©e haut √† travers une r√©sistance de 10 kŒ© pour √©viter une r√©initialisation accidentelle due √† des interf√©rences. </font><font style="vertical-align: inherit;">Le microcontr√¥leur est cadenc√© √† quartz 16 MHz. </font><font style="vertical-align: inherit;">Mettez le plus pr√®s possible des conclusions. </font><font style="vertical-align: inherit;">Les r√©servoirs de charge sont utilis√©s en interne. </font><font style="vertical-align: inherit;">Configur√© via un fusible. </font><font style="vertical-align: inherit;">Connecter s√©par√©ment les connecteurs ICP (pour t√©l√©charger le firmware) et UART pour la "communication". </font><font style="vertical-align: inherit;">Capacit√©s C1 (√©lectrolyte 10 ŒºF) et C2 (c√©ramique 100 nF). </font><font style="vertical-align: inherit;">Rapprochez-vous le plus possible des broches d'alimentation du microcontr√¥leur. </font><font style="vertical-align: inherit;">Utilis√© pour √©viter les d√©charges accidentelles pendant le transfert de charge.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ensemble de circuits</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/files/20a/9b3/6fa/20a9b36fade242d9b70e10be068168ad.jpg"></div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Qu'est-ce qu'un polygone gris?</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/files/d61/bca/b30/d61bcab30e4041e6977ff8d55687d58a.jpg"></div></div><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Firmware + algorithme de travail</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le firmware a √©t√© √©crit en C dans </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Atmel Studio 7</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> IDE. </font><font style="vertical-align: inherit;">Les sources sont publi√©es sur </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GitHub</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Le code est document√© au maximum. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le projet est divis√© en plusieurs niveaux d'abstraction:</font></font><br>
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mat√©riel</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - niveau le plus bas, liaison maximale au mat√©riel. </font><font style="vertical-align: inherit;">Travaillez avec la p√©riph√©rie du microcontr√¥leur.</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le middleware</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est le juste milieu entre le mat√©riel et les pilotes. </font><font style="vertical-align: inherit;">Par exemple, la mise en ≈ìuvre du protocole 1-Wire.</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pilotes</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - niveau pilote. </font><font style="vertical-align: inherit;">Par exemple, travailler avec la puce DS18B20.</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Application</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - le plus haut niveau d'abstraction. </font><font style="vertical-align: inherit;">Par exemple, recevoir et transmettre la temp√©rature via UART.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un coup d'≈ìil rapide sur la fonction principale. </font><font style="vertical-align: inherit;">Vient d'abord le tableau des adresses ROM. </font><font style="vertical-align: inherit;">Il est n√©cessaire que l'adresse du capteur physiquement connect√©e √† la LED z√©ro (accroch√©e au PA0 du port PORTA) soit en position z√©ro, etc. </font><font style="vertical-align: inherit;">Pour obtenir la ROM, il existe une fonction </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sendROMToUART</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Vous devez juste vous rappeler que le capteur doit √™tre sur le bus seul, sinon il y aura une collision d'adresses.</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">principal</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">void</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">
</span></span>{	
	<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span> ROM[][<span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(ROM_T)] = <span class="hljs-comment"><span class="hljs-comment">/* ROM array */</span></span><font></font>
	{<font></font>
		{<span class="hljs-number"><span class="hljs-number">0x26</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x04</span></span>, <span class="hljs-number"><span class="hljs-number">0x4B</span></span>, <span class="hljs-number"><span class="hljs-number">0x15</span></span>, <span class="hljs-number"><span class="hljs-number">0x89</span></span>, <span class="hljs-number"><span class="hljs-number">0x28</span></span>}, <span class="hljs-comment"><span class="hljs-comment">// 0</span></span>
		{<span class="hljs-number"><span class="hljs-number">0x71</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x04</span></span>, <span class="hljs-number"><span class="hljs-number">0x4A</span></span>, <span class="hljs-number"><span class="hljs-number">0xC0</span></span>, <span class="hljs-number"><span class="hljs-number">0x65</span></span>, <span class="hljs-number"><span class="hljs-number">0x28</span></span>}, <span class="hljs-comment"><span class="hljs-comment">// 1</span></span>
		{<span class="hljs-number"><span class="hljs-number">0xA5</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x04</span></span>, <span class="hljs-number"><span class="hljs-number">0x4A</span></span>, <span class="hljs-number"><span class="hljs-number">0xCB</span></span>, <span class="hljs-number"><span class="hljs-number">0xCE</span></span>, <span class="hljs-number"><span class="hljs-number">0x28</span></span>}, <span class="hljs-comment"><span class="hljs-comment">// 2</span></span>
		{<span class="hljs-number"><span class="hljs-number">0x41</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x04</span></span>, <span class="hljs-number"><span class="hljs-number">0x4A</span></span>, <span class="hljs-number"><span class="hljs-number">0xAC</span></span>, <span class="hljs-number"><span class="hljs-number">0x65</span></span>, <span class="hljs-number"><span class="hljs-number">0x28</span></span>}, <span class="hljs-comment"><span class="hljs-comment">// 3</span></span>
		{<span class="hljs-number"><span class="hljs-number">0x22</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x04</span></span>, <span class="hljs-number"><span class="hljs-number">0x4B</span></span>, <span class="hljs-number"><span class="hljs-number">0x06</span></span>, <span class="hljs-number"><span class="hljs-number">0x0D</span></span>, <span class="hljs-number"><span class="hljs-number">0x28</span></span>}, <span class="hljs-comment"><span class="hljs-comment">// 4</span></span>
		{<span class="hljs-number"><span class="hljs-number">0x86</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x04</span></span>, <span class="hljs-number"><span class="hljs-number">0x4A</span></span>, <span class="hljs-number"><span class="hljs-number">0xF6</span></span>, <span class="hljs-number"><span class="hljs-number">0x46</span></span>, <span class="hljs-number"><span class="hljs-number">0x28</span></span>}  <span class="hljs-comment"><span class="hljs-comment">// 5</span></span><font></font>
	};<font></font>
	<font></font>
	<span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span> nDevices = <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(ROM) / <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(ROM_T); <span class="hljs-comment"><span class="hljs-comment">/* Number of DS18B20 devices */</span></span><font></font>
	<font></font>
	initUART(MYUBRR); <span class="hljs-comment"><span class="hljs-comment">/* Initialization of UART with appropriate baudrate */</span></span>
	initTimer0(); <span class="hljs-comment"><span class="hljs-comment">/* Initialization of Timer/counter0 */</span></span>
	initLED(nDevices); <span class="hljs-comment"><span class="hljs-comment">/* Initialization of LEDs */</span></span><font></font>
	<font></font>
	{ <span class="hljs-comment"><span class="hljs-comment">/* DS18B20s initialization */</span></span>
		<span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span> nDevices = <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(ROM) / <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(ROM_T); <span class="hljs-comment"><span class="hljs-comment">/* Number of DS18B20 devices */</span></span>
		ROM_T *pROM = (ROM_T *)&amp;ROM; <span class="hljs-comment"><span class="hljs-comment">/* Pointer to ROM array */</span></span><font></font>
		<font></font>
		initDQ(); <span class="hljs-comment"><span class="hljs-comment">/* Initialization of DQ pin */</span></span><font></font>
		<font></font>
		<span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (nDevices--) <span class="hljs-comment"><span class="hljs-comment">/* For all DS18B20 */</span></span>
			initDS18B20(pROM++, RESOLUTION_11BIT); <span class="hljs-comment"><span class="hljs-comment">/* Initialization of DS18B20 with appropriate resolution */</span></span><font></font>
	}<font></font>
	<font></font>
	sei(); <span class="hljs-comment"><span class="hljs-comment">/* Global enable interrupts */</span></span><font></font>
	<font></font>
	<span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-comment"><span class="hljs-comment">/* Infinite loop */</span></span><font></font>
	{<font></font>
		sendTemperatureToUART((ROM_T *)&amp;ROM, nDevices); <span class="hljs-comment"><span class="hljs-comment">/* Execute function routine */</span></span><font></font>
	}<font></font>
}<font></font>
</code></pre></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vient ensuite l'initialisation des p√©riph√©riques et du DS-ok eux-m√™mes avec la r√©solution appropri√©e. </font><font style="vertical-align: inherit;">La p√©riode d'√©chantillonnage de la temp√©rature en d√©pend. </font><font style="vertical-align: inherit;">Pour 11 bits, cela correspond √† 375 ms. </font><font style="vertical-align: inherit;">Dans une boucle infinie, le programme lit en continu la temp√©rature de chaque capteur et l'envoie via UART. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le travail avec les LED est bas√© sur des interruptions. </font><font style="vertical-align: inherit;">Par UART, l'ID LED vient 2 fois de suite sur un cadre pair et impair. </font><font style="vertical-align: inherit;">Au d√©but, la LED s'allume. </font><font style="vertical-align: inherit;">La minuterie s'√©teint apr√®s un certain temps (dans mon cas, 15 ms). </font><font style="vertical-align: inherit;">La deuxi√®me fois est simplement ignor√©e. </font><font style="vertical-align: inherit;">Le temporisateur est configur√© en mode CTC de sorte qu'une interruption se produit toutes les 1 ms.</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">code</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">volatile</span></span> <span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span> ledID = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-comment"><span class="hljs-comment">/* Current ledID value */</span></span>
<span class="hljs-keyword"><span class="hljs-keyword">volatile</span></span> <span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span> ledID_prev = <span class="hljs-number"><span class="hljs-number">255</span></span>;  <span class="hljs-comment"><span class="hljs-comment">/* Previous ledID value */</span></span>
<span class="hljs-keyword"><span class="hljs-keyword">volatile</span></span> <span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span> duration = FLASH_DURATION; <span class="hljs-comment"><span class="hljs-comment">/* Flash duration value */</span></span><font></font>
<font></font>
ISR(USART_RXC_vect) <span class="hljs-comment"><span class="hljs-comment">/* UART interrupt handler */</span></span><font></font>
{<font></font>
	ledID = UDR; <span class="hljs-comment"><span class="hljs-comment">/* Assign ledID to receive via UART value */</span></span>
	<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ledID != ledID_prev) <span class="hljs-comment"><span class="hljs-comment">/* If current ledID equal to previous value */</span></span><font></font>
	{<font></font>
		turnOnLED(ledID); <span class="hljs-comment"><span class="hljs-comment">/* Turn on the ledID LED */</span></span>
		timer0Start(); <span class="hljs-comment"><span class="hljs-comment">/* Start Timer0 */</span></span>
		ledID_prev = ledID; <span class="hljs-comment"><span class="hljs-comment">/* Previous ledID assign to current */</span></span>
		duration = FLASH_DURATION; <span class="hljs-comment"><span class="hljs-comment">/* Update LED flash duration */</span></span><font></font>
	}<font></font>
}<font></font>
<font></font>
ISR(TIMER0_COMP_vect) <span class="hljs-comment"><span class="hljs-comment">/* Timer0 compare interrupt handler */</span></span><font></font>
{<font></font>
	<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (--duration == <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-comment"><span class="hljs-comment">/* Decrement Duration value each 1ms and if it reach to 0 */</span></span><font></font>
	{<font></font>
		timer0Stop(); <span class="hljs-comment"><span class="hljs-comment">/* Stop Timer0 */</span></span>
		turnOffAllLED(); <span class="hljs-comment"><span class="hljs-comment">/* Turn off all LEDs */</span></span>
		timer0Clear(); <span class="hljs-comment"><span class="hljs-comment">/* Clear Timer0 counter register */</span></span><font></font>
	}<font></font>
}<font></font>
</code></pre></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les sections de code sensibles au temps, qui sont des signaux 1-Wire, sont envelopp√©es dans une </font><font style="vertical-align: inherit;">construction </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ATOMIC_BLOCK</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Tous les param√®tres de base sont </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d√©finis</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dans </font><b><font style="vertical-align: inherit;">global.h</font></b><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">L'UART fonctionne √† une vitesse de 250 000. Rapide et sans erreur pour le quartz 16 MHz. </font><font style="vertical-align: inherit;">Le pilote DS18B20 dispose des fonctionnalit√©s minimales n√©cessaires √† ce projet. </font><font style="vertical-align: inherit;">Le reste - voir le code. </font><font style="vertical-align: inherit;">Il y aura des questions - demandez, ne soyez pas timide. </font><font style="vertical-align: inherit;">Je voudrais √©galement vous rappeler les r√©glages des fusibles. </font><font style="vertical-align: inherit;">Ils doivent r√©gler la capacit√© de synchronisation √† partir du quartz externe, sinon ce sera du g√©n√©rateur interne (et il est √† un maximum de 8 MHz et pas tr√®s stable). </font><font style="vertical-align: inherit;">Eh bien, programmez le bit CKOPT, sinon le quartz au-dessus de 8 MHz ne d√©marre pas. </font><font style="vertical-align: inherit;">J'ai un </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fusible haut = 0xD9</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , un </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fusible bas = 0xFF</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mod√®le Simulink + algorithme de fonctionnement</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Version de </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Matlab R2015b</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">En </font><font style="vertical-align: inherit;">plus de la biblioth√®que int√©gr√©e, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Simulink a</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> principalement utilis√© la </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bo√Æte √† outils du syst√®me de vision par ordinateur</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et la </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bo√Æte √† outils d'acquisition d'images</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Le mod√®le complet et les fichiers associ√©s sont t√©l√©charg√©s sur </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GitHub</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Vous trouverez ci-dessous une description d√©taill√©e avec des exemples illustratifs. </font><font style="vertical-align: inherit;">Toutes les photos sont cliquables.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Module WebCamTemp</font></font></h2><br>
<a href=""><img align="left" src="https://habrastorage.org/files/f1d/b35/8bb/f1db358bbf3f4bb4b9b31dc3724daf27.bmp"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les blocs jaunes indiquent les blocs de port COM. √âmetteur, r√©cepteur et configurateur s√©par√©s. Les param√®tres du port doivent correspondre exactement √† ceux du microcontr√¥leur (vitesse, parit√©, nombre de bits, etc.). Le r√©cepteur prend la temp√©rature en la regroupant dans un tableau unidimensionnel de taille </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[n 1] de</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> type </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">int16</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , o√π </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est le nombre de DS18B20 (j'en ai 6). Chaque √©l√©ment de ce tableau est divis√© par </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">16</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Cela provient de la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fiche technique √† la</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> page 6. L'√©metteur envoie la valeur actuelle du compteur au </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">compteur</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Il allume simplement une LED particuli√®re. Cochez de </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √† </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">√âchantillons de la p√©riode 2. </font><font style="vertical-align: inherit;">Les blocs responsables de l'affichage / sauvegarde du flux vid√©o sont regroup√©s en bleu. </font><font style="vertical-align: inherit;">Vert - blocs pour recevoir des informations vid√©o. </font><font style="vertical-align: inherit;">En fait, la webcam elle-m√™me. </font><font style="vertical-align: inherit;">Il existe de nombreux param√®tres, diff√©rents selon le fabricant. </font><font style="vertical-align: inherit;">L'image est affich√©e dans des tons gris. </font><font style="vertical-align: inherit;">Tellement int√©ressant. </font><font style="vertical-align: inherit;">Le bloc </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Diff</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fait la diff√©rence entre les images pr√©c√©dentes et actuelles. </font><font style="vertical-align: inherit;">Le bloc </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">impair du sous-√©chantillon</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ne met en √©vidence que la diff√©rence allum√©e - pas une LED allum√©e, mais pas l'inverse. </font><font style="vertical-align: inherit;">Le bloc </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Downsample m√™me</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ne saute que les images o√π la LED est √©teinte.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Img diff</font></font></b><div class="spoiler_text"> ,  ‚Äî  .        (  ).    ,       .    0.25.<br>
<br>
<iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://www.youtube.com/embed/tbpDALqIc0g%3Ffeature%3Doembed&amp;usg=ALkJrhiYN2sj4VZ2Ho1tefLo1-p3rGSoEA" frameborder="0" allowfullscreen=""></iframe><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Img gris</font></font></b><div class="spoiler_text"> ,  ‚Äî ,     .      ,    .    .<br>
<br>
<iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://www.youtube.com/embed/ATGUUmG77eo%3Ffeature%3Doembed&amp;usg=ALkJrhjNGLQX43dwwASB4twuKzGt_UABIg" frameborder="0" allowfullscreen=""></iframe><br>
</div></div><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'affichage de la fr√©quence d'images</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> affiche le FPS actuel. </font><font style="vertical-align: inherit;">Tout le traitement est dans les </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LED de</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> bloc </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Nous allons l'examiner comme suit.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Module LEDs</font></font></h2><br>
<a href=""><img align="left" src="https://habrastorage.org/files/636/73d/92d/63673d92d053459c9c0c226edded2d13.bmp"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Violet a regroup√© des blocs d'obtention de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gaussiens 2D</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Nous en avons besoin de deux: l' </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">interf√©rence</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et l' </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">opacit√©</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Ils diff√®rent par leur sigma. </font><font style="vertical-align: inherit;">Leur centre est au point maximum (o√π la LED √©tait allum√©e). </font><font style="vertical-align: inherit;">Les coordonn√©es sont situ√©es dans le bloc </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Maximum</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Au lieu de g√©n√©rer constamment de tels gaussiens (et l'exposant est une op√©ration math√©matique tr√®s longue), il a √©t√© d√©cid√© de les supprimer. </font><font style="vertical-align: inherit;">Pour ce faire, dans le m-fichier g√©n√©r√© par deux </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Int</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Op</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tailles en 2 fois plus que le centre au milieu duquel, plus loin, griffonn√© simplement les dates, les </font><font style="vertical-align: inherit;">unit√©s </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">interf√©rence des cultures</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">la culture de </font><font style="vertical-align: inherit;">l'opacit√©</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exemple de travail</font></font></b><div class="spoiler_text">  ‚Äî   .   ‚Äî         .   ‚Äî      .   ‚Äî     .     0.25.<br>
<br>
<iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://www.youtube.com/embed/wGYyoVUJ8nQ%3Ffeature%3Doembed&amp;usg=ALkJrhgTDmbyy8I-NQLkuhTIWxeBWZdtmQ" frameborder="0" allowfullscreen=""></iframe><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les blocs de m√©moire sont entour√©s de vert. Leur but est de stocker les coordonn√©es et les gaussiennes pour chaque LED. Nous consid√©rons plus en d√©tail ci-dessous. Le bloc de </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">couleur To</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est </font><font style="vertical-align: inherit;">destin√© √† cr√©er une distribution de temp√©rature et une carte de couleurs. Sera √©galement discut√© ci-dessous. unit√© de composition de </font><font style="vertical-align: inherit;">signal </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Compositing</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> m√©langes des </font><font style="vertical-align: inherit;">deux images </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Image1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Image2</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de la mani√®re suivante:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/files/84a/62d/3d6/84a62d3d604b42c5b0923eb74d8d58d4.gif"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le bloc </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ins√©rer du texte</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> impose du texte format√© (dans ce cas, la temp√©rature) √† l'image. </font><font style="vertical-align: inherit;">Il accepte </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> variables et coordonn√©es au format </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[XY]</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Vous pouvez s√©lectionner la police et sa taille. </font><font style="vertical-align: inherit;">Les blocs √† l'int√©rieur du rectangle rouge impl√©mentent </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l'algorithme de moyenne mobile</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Les transitions deviennent moins nerveuses, ce qui pr√©serve les nerfs et pla√Æt √† l'≈ìil.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exemple</font></font></b><div class="spoiler_text"> ,  ‚Äî    8- .            (  )     .<br>
<br>
<iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://www.youtube.com/embed/Z8NgbGUZS50%3Ffeature%3Doembed&amp;usg=ALkJrhhdi3NshPmzxe4TuOOFkM0rbtYU9g" frameborder="0" allowfullscreen=""></iframe><br>
</div></div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Modules de m√©moire</font></font></h2><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les interf√©rences de m√©moire</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et l' </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">opacit√© de la m√©moire</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> stockent des ensembles gaussiens 2D, des points de </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m√©moire</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - coordonn√©es pour chaque LED.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Interf√©rence m√©moire et opacit√© m√©moire</font></font></b><div class="spoiler_text"><a href=""><img align="left" src="https://habrastorage.org/files/06d/f15/23e/06df1523e1d245f7b824b151f7dfa0e3.bmp"></a>   .   <b>Address</b>       .   .     .  <b>Delay</b>  <b>LEDs</b>     (  ,    ).      .  <b>Enable</b>  .   ,      (  <b>Maximum</b>  <b>Threshold</b>  <b>LEDs</b>).    ‚Äî    .       .      <b>[H W n]</b>,  <b>HxW</b> ‚Äî  -,   <b>n</b> ‚Äî  /.<br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Points m√©moire</font></font></b><div class="spoiler_text"><a href=""><img align="left" src="https://habrastorage.org/files/f25/02b/441/f2502b4415bd4badad2de75142a84044.bmp"></a>     .           .   <b>Permute Matrix</b>    ,     <b>[Y X]</b>,   <b>[X Y]</b>.<br>
</div></div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pour colorier le module</font></font></h2><br>
<a href=""><img align="left" src="https://habrastorage.org/files/ff4/661/f73/ff4661f7313342bc87aab6257d405ee9.bmp"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vert - Traitement de l' </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">opacit√©</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . R√©sumez le tableau d'entr√©e dans la troisi√®me dimension. Nous le normalisons au maximum. Multipliez par la valeur de </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gain</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (de 0 √† 1) </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(1)</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Au total, nous avons un tableau avec des Gaussiens superpos√©s et un </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gain</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> maximum </font><font style="vertical-align: inherit;">. Utilis√© comme </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">facteur</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de m√©lange d'images. Rouge - recevoir une carte en couleur des temp√©ratures. Voici des math√©matiques un peu diff√©rentes, toutes les m√™mes gaussiennes. Il est d√©crit par la formule </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(2)</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . En gros, la temp√©rature √† un point arbitraire est la moyenne pond√©r√©e de tous les capteurs. Mais l'influence de chaque capteur dans un rapport en pourcentage est proportionnelle √† la valeur du gaussien qu'il contient. La somme de tous est consid√©r√©e comme 100%.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/files/87a/e2d/4a3/87ae2d4a31ba4759bb9cf4d093fff846.gif"></div><br>
<a href=""><img align="left" src="https://habrastorage.org/files/c51/f48/e29/c51f48e29b614eb28a0134f517ee49e8.bmp"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Reste √† voir comment la distribution des temp√©ratures se transforme en carte couleur. </font><font style="vertical-align: inherit;">Ce qui est entour√© en bleu transforme la temp√©rature sp√©cifique en une valeur comprise entre 0 et 1. Dans la zone rouge, le bloc </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Prelookup</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> calcule l'indice par lequel la valeur du rouge, du vert et du bleu est recherch√©e. </font><font style="vertical-align: inherit;">Le tableau de couleurs contient 64 valeurs. </font><font style="vertical-align: inherit;">Les interm√©diaires sont calcul√©s par interpolation. </font><font style="vertical-align: inherit;">Parmi les fonctionnalit√©s, il existe deux modes: relatif et absolu. </font><font style="vertical-align: inherit;">√Ä l'endroit le plus froid et le plus chaud, le minimum et le maximum du tableau d'entr√©e correspondent. </font><font style="vertical-align: inherit;">En absolu, il existe des valeurs constantes. </font><font style="vertical-align: inherit;">Dans le premier, il est plus pratique de regarder le profil de distribution de temp√©rature. </font><font style="vertical-align: inherit;">Dans l'autre, ses changements absolus.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fichier m</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il est ex√©cut√© au d√©but, avant la simulation, en introduisant des variables dans l'espace de travail.</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">code</font></font></b><div class="spoiler_text"><pre><code class="matlab hljs">H = <span class="hljs-number"><span class="hljs-number">480</span></span>; <span class="hljs-comment"><span class="hljs-comment">% Height of image</span></span>
W = <span class="hljs-number"><span class="hljs-number">640</span></span>; <span class="hljs-comment"><span class="hljs-comment">% Width of image</span></span>
minT = <span class="hljs-number"><span class="hljs-number">20</span></span>; <span class="hljs-comment"><span class="hljs-comment">% Min temperature</span></span>
maxT = <span class="hljs-number"><span class="hljs-number">25</span></span>; <span class="hljs-comment"><span class="hljs-comment">% Max temperature</span></span>
sigmaInt = <span class="hljs-number"><span class="hljs-number">40</span></span>; <span class="hljs-comment"><span class="hljs-comment">% Sigma interference</span></span>
sigmaOp = <span class="hljs-number"><span class="hljs-number">80</span></span>; <span class="hljs-comment"><span class="hljs-comment">% Sigma opacity</span></span>
gain = <span class="hljs-number"><span class="hljs-number">1.0</span></span>; <span class="hljs-comment"><span class="hljs-comment">% Gain value</span></span>
T = <span class="hljs-number"><span class="hljs-number">0.3</span></span>; <span class="hljs-comment"><span class="hljs-comment">% Threshold value</span></span>
nAvr = <span class="hljs-number"><span class="hljs-number">8</span></span>; <span class="hljs-comment"><span class="hljs-comment">% number of means</span></span>
<span class="hljs-comment"><span class="hljs-comment">% ------------------------------------------------------</span></span>
[M,N] = <span class="hljs-built_in"><span class="hljs-built_in">meshgrid</span></span>(-W:W, -H:H); <span class="hljs-comment"><span class="hljs-comment">% Meshgrid function</span></span><font></font>
<font></font>
R = <span class="hljs-built_in"><span class="hljs-built_in">sqrt</span></span>(M.^<span class="hljs-number"><span class="hljs-number">2</span></span> + N.^<span class="hljs-number"><span class="hljs-number">2</span></span>); <span class="hljs-comment"><span class="hljs-comment">% Distance from the center</span></span><font></font>
<font></font>
Int = normpdf(R, <span class="hljs-number"><span class="hljs-number">0</span></span>, sigmaInt); <span class="hljs-comment"><span class="hljs-comment">% 2D gaussian for interference</span></span>
Op = normpdf(R, <span class="hljs-number"><span class="hljs-number">0</span></span>, sigmaOp); <span class="hljs-comment"><span class="hljs-comment">% 2D gaussian for opacity</span></span><font></font>
<font></font>
Int = Int/<span class="hljs-built_in"><span class="hljs-built_in">max</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">max</span></span>(Int)); <span class="hljs-comment"><span class="hljs-comment">% Normalization of interference gaussian</span></span>
Op = Op/<span class="hljs-built_in"><span class="hljs-built_in">max</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">max</span></span>(Op)); <span class="hljs-comment"><span class="hljs-comment">% Normalization of opacity gaussian</span></span><font></font>
<font></font>
clear M N R sigmaInt sigmaOp <span class="hljs-comment"><span class="hljs-comment">% Delete unused variables from memory</span></span><font></font>
<font></font>
load(<span class="hljs-string"><span class="hljs-string">'MyColormaps'</span></span>,<span class="hljs-string"><span class="hljs-string">'mycmap'</span></span>); <span class="hljs-comment"><span class="hljs-comment">% Load colormap</span></span>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Contient les principales variables de contr√¥le parmi lesquelles:</font></font><br>
<ul>
<li><b>H</b> ‚Äî    .</li>
<li><b>W</b> ‚Äî    .</li>
<li><b>minT</b> ‚Äî   .</li>
<li><b>maxT</b> ‚Äî   .</li>
<li><b>sigmaInt</b> ‚Äî   Interference.</li>
<li><b>sigmaOp</b> ‚Äî   Opacity.</li>
<li><b>gain</b> ‚Äî   Factor.</li>
<li><b>T</b> ‚Äî    .</li>
<li><b>nAvr</b> ‚Äî     .</li>
</ul><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">W</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> doivent correspondre au courant dans le bloc WebCamera. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">minT</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">maxT</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> affectent la carte des couleurs en mode de temp√©rature absolue. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T est</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> r√©gl√© de 0 √† 1. Parfois, le port COM et la webcam ne sont pas synchronis√©s. </font><font style="vertical-align: inherit;">La phase de l'image diff√©rentielle peut changer de 180 ¬∞. </font><font style="vertical-align: inherit;">Et l√† o√π il devrait y avoir un maximum - il y a un minimum. </font><font style="vertical-align: inherit;">Et le syst√®me peut choisir une coordonn√©e arbitraire qui ne correspond pas √† la r√©alit√©. </font><font style="vertical-align: inherit;">Pour cela, il existe un syst√®me de seuil. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nAvr est le</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nombre de moyennes dans la moyenne mobile. </font><font style="vertical-align: inherit;">Plus il est grand, plus les transitions sont fluides, mais la pertinence est perdue (un d√©calage temporel appara√Æt). </font><font style="vertical-align: inherit;">Pour comprendre l'effet des variables restantes, on ne peut pas le comprendre sans exemples illustratifs.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Effet SigmaInt</font></font></b><div class="spoiler_text"> <img src="https://habrastorage.org/files/dd4/52e/fa0/dd452efa07f74879864a7da50c880f39.gif">      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="> </a>.  <img src="https://habrastorage.org/files/5de/994/dd0/5de994dd0e834600b8fff948ae13eb07.gif">       ,   , .   ‚Äî    .<br>
<br>
<iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://www.youtube.com/embed/cZV_ayNrWgE%3Ffeature%3Doembed&amp;usg=ALkJrhgzPl58-4Wizehf956u2mJqOLeBEQ" frameborder="0" allowfullscreen=""></iframe><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Effet SigmaOp</font></font></b><div class="spoiler_text">     .<br>
<br>
<iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://www.youtube.com/embed/S8R4A9AKFZU%3Ffeature%3Doembed&amp;usg=ALkJrhhtlntXRpUgN2CihlHFiGt1hGGbLg" frameborder="0" allowfullscreen=""></iframe><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Effet gain</font></font></b><div class="spoiler_text">-   .    ¬´¬ª  ¬´ ¬ª  .<br>
<br>
<iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://www.youtube.com/embed/mvKfUSIw3rI%3Ffeature%3Doembed&amp;usg=ALkJrhhVgFcAxbCstEg3av7xvL3HRX67Gg" frameborder="0" allowfullscreen=""></iframe><br>
</div></div><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les exp√©riences</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voici quelques exp√©riences.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fen√™tre ouverte</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Des capteurs sont dispers√©s sur le lit par la fen√™tre. </font><font style="vertical-align: inherit;">La fen√™tre s'ouvre et se ferme apr√®s un certain temps. </font><font style="vertical-align: inherit;">Un bon exemple de la diff√©rence entre les modes relatif (gauche) et absolu (droite). </font><font style="vertical-align: inherit;">En utilisant le premier, il est commode de consid√©rer la distribution, et le second, comment le froid est distribu√© ou la chaleur est r√©tablie.</font></font><br>
<br>
<iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://www.youtube.com/embed/AlDT9XyCSeo%3Ffeature%3Doembed&amp;usg=ALkJrhizdlxSdO-Spvr_qeQU1FEgxi9thg" frameborder="0" allowfullscreen=""></iframe><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Appui de fen√™tre</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les capteurs sont situ√©s le long du rebord de la fen√™tre. </font><font style="vertical-align: inherit;">La fen√™tre s'ouvre - le profil change. </font><font style="vertical-align: inherit;">Les zones les plus froides et les plus chaudes sont clairement visibles.</font></font><br>
<br>
<iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://www.youtube.com/embed/OX8_0pjPLZg%3Ffeature%3Doembed&amp;usg=ALkJrhi0aD3n3y5IvvQgG7NVIhIgZYSUXQ" frameborder="0" allowfullscreen=""></iframe><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Est-il plus chaud sur le dessus?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ils disent que le haut est plus chaud. </font><font style="vertical-align: inherit;">Cette exp√©rience en est une confirmation compl√®te. </font><font style="vertical-align: inherit;">√Ä la 10e seconde, la fen√™tre s'ouvre, √† la 30e - elle se ferme.</font></font><br>
<br>
<iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://www.youtube.com/embed/pUDan07bd-E%3Ffeature%3Doembed&amp;usg=ALkJrhgQaX-JVQy2VCBJog2ozASuP3-vZg" frameborder="0" allowfullscreen=""></iframe><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusion</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un tel sch√©ma ne remplacera pas un imageur thermique √† part enti√®re. </font><font style="vertical-align: inherit;">Mais il n'est pas en mesure de voir la propagation des masses d'air. </font><font style="vertical-align: inherit;">Et √† un prix ce design est incomparablement plus bas. </font><font style="vertical-align: inherit;">Vous pouvez utiliser une carte de couleurs diff√©rente. </font><font style="vertical-align: inherit;">Vous pouvez prendre d'autres fonctions √† la place des gaussiens. </font><font style="vertical-align: inherit;">Vous pouvez m√™me changer les lois de la construction. </font><font style="vertical-align: inherit;">Ou r√©√©crivez sur OpenCV + QT pour plus de rapidit√© et de commodit√©. </font><font style="vertical-align: inherit;">Mais c'est ce que j'ai con√ßu - j'ai r√©alis√©. </font><font style="vertical-align: inherit;">Juste </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pour le plaisir</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr390985/">https://habr.com/ru/post/fr390985/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr390975/index.html">Pr√©visions pour 2016: trois tendances majeures dans l'industrie des semi-conducteurs</a></li>
<li><a href="../fr390977/index.html">Sony News au MWC 2016: Xperia X, Xperia X Performance et Xperia XA</a></li>
<li><a href="../fr390979/index.html">Lenovo Ideacentre Stick 300: petit oui</a></li>
<li><a href="../fr390981/index.html">Comment Motorika fabrique des proth√®ses dentaires pour les enfants</a></li>
<li><a href="../fr390983/index.html">Loups et moutons, zombies et casiers √† homard: bref dictionnaire d'argot</a></li>
<li><a href="../fr390987/index.html">Sony a achet√© une vid√©o d'un artiste russe et l'a bloqu√©e sur YouTube (encore)</a></li>
<li><a href="../fr390989/index.html">Le t√©l√©phone modulaire Fairphone 2 est maintenant disponible</a></li>
<li><a href="../fr390993/index.html">L'≈ìil papillon est devenu un mod√®le pour les rect√®nes de graph√®ne avec une absorption de lumi√®re record</a></li>
<li><a href="../fr390995/index.html">MasterCard pr√©pare les options de v√©rification du client en utilisant des selfies, des tonalit√©s vocales et la fr√©quence cardiaque</a></li>
<li><a href="../fr390997/index.html">9 drones qui n'ont pas besoin d'enregistrement</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>