<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩‍❤️‍💋‍👩 👨🏻‍🏫 😀 BlessRNG或RNG检查是否诚实 🚣🏻 👈 🙍🏽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="在gamedev中，您经常需要在随机的房子上绑一些东西：Unity为此具有自己的Random，而System.Random与之并行存在。 从前，在一个项目中似乎两个项目的工作方式可能有所不同（尽管它们应该具有统一的分布）。 

 然后他们没有详细介绍-过渡到System.Random就足以解决所有问...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>BlessRNG或RNG检查是否诚实</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/playgendary/blog/473880/"><img src="https://habrastorage.org/webt/l7/la/vl/l7lavlbtdajd-exhq5l43oeur6i.png"><br><br> 在gamedev中，您经常需要在随机的房子上绑一些东西：Unity为此具有自己的Random，而System.Random与之并行存在。 从前，在一个项目中似乎两个项目的工作方式可能有所不同（尽管它们应该具有统一的分布）。 <br><br> 然后他们没有详细介绍-过渡到System.Random就足以解决所有问题。 现在，我们决定更详细地理解并进行一些研究：RNG的“偏向”或可预测性如何，以及选择哪种。 此外，我经常听到关于他们的“诚实”的相互矛盾的看法-让我们尝试找出实际结果与陈述结果之间的关系。 <br><a name="habracut"></a><br><h2> 简短的教育计划或RNG实际上是PRNG </h2><br>  <i>如果您已经熟悉随机数生成器，则可以立即进入“测试”部分。</i> <br><br> 随机数（MF）是使用某种随机（混沌）过程（熵的来源）生成的数字序列。 也就是说，这是一个序列，其元素不受任何数学法则连接-它们没有因果关系。 <br><br> 产生中音的原因称为随机数生成器（RNG）。 似乎一切都是基本的，但是如果我们从理论上转到实践上，那么实际上实现生成这种序列的软件算法并不是那么简单。 <br><br> 原因在于现代消费电子产品缺乏随机性。 没有它，随机数就不再是随机的，它们的生成器变成了故意确定参数的普通函数。 对于IT领域的许多专业而言，这是一个严重的问题（例如，对于密码学而言），而对于其他领域，则存在一个完全可以接受的解决方案。 <br><br> 我们需要编写一种算法，即使它不是真正的随机数，但也要返回尽可能近的算法-所谓的伪随机数（PSN）。 这种情况下的算法称为伪随机数生成器（PRNG）。 <br><br> 有多种创建PRNG的选项，但对于所有这些而言，以下都是相关的： <br><br><ol><li> 需要预先初始化。 <br><br>  PRNG没有熵源，因此，在使用它之前，有必要指出初始状态。 它被指定为数字（或向量），并称为种子（种子，随机种子）。 通常，将处理器时钟计数器或系统时间的数值等效项用作种子。 </li><li> 序列的可重复性。 <br><br>  PRNG是完全确定性的，因此在初始化过程中指定的种子将唯一确定整个将来的数字序列。 这意味着使用相同种子（在不同时间，在不同程序中，在不同设备上）初始化的单个PRSP将生成相同序列。 </li></ol><br> 您还需要知道PRNG的概率分布-它将生成什么数字以及以何种概率生成。 通常，这是正态分布或均匀分布。 <br><img src="https://habrastorage.org/webt/f7/2x/j9/f72xj9mz2s52w-ahiwp5uiuqzs0.png"><br>  <i>正态分布（左）和均匀分布（右）</i> <br><br> 假设我们有一个24张面孔的诚实骰子。 如果您将其删除，则单位掉出的概率为1/24（以及其他任何数字掉出的概率）。 如果您进行大量投掷并记录结果，您会发现所有面孔的掉落频率大致相同。 实际上，该骰子可以被认为是具有均匀分布的RNG。 <br><br> 如果您立即扔出10根这样的骨头并计算总点数？ 会为她保持统一性吗？ 不行 通常，金额接近125点，即某个平均值。 结果-即使在抛出之前，您也可以粗略估计未来的结果。 <br><br> 原因是要获得平均点数，组合的数量最多。 离它越远，组合越少-因此损失的机会也就越少。 如果您可视化此数据，它将在远程上类似于钟形。 因此，在一定程度上可以将具有10个骨骼的系统称为具有正态分布的RNG。 <br><br> 另一个例子，只有已经在飞机上的目标射击。 射击者将是生成一对数字（x，y）的RNG，该数字将显示在图形上。 <br><img src="https://habrastorage.org/webt/hs/o8/t3/hso8t3u11xkoyrp2slwjo4jvpic.png"><br> 同意左侧的选项更接近现实生活-这是具有正态分布的RNG。 但是，如果您需要在黑暗的天空中散布星星，那么在具有均匀分布的RNG的帮助下，正确的选择会更好。 通常，根据任务选择一个生成器。 <br><br> 现在让我们谈谈PSP序列的熵。 例如，有一个序列是这样开始的： <br><br>  89、93、33、32、82、21、4、42、11、8、60、95、53、30、42、19、34、35、62、23、44、38、74、36、52， 18、58、79、65、45、99、90、82、20、41、13、88、76、82、24、5、54、72、19、80、2、74、36、71、9 ... <br><br> 这些数字乍一看有多随机？ 让我们从检查分布开始。 <br><img src="https://habrastorage.org/webt/pg/6h/nw/pg6hnwtyc2v9e8xx2-zurotlnsq.png"><br> 看起来接近统一，但是如果您读取两个数字的序列并将其解释为平面上的坐标，则会得到以下信息： <br><img src="https://habrastorage.org/webt/vd/3_/y2/vd3_y2eijwkjq47tbjsut-els-y.png"><br> 模式清晰可见。 而且由于序列中的数据是以某种方式排序的（也就是说，它们的熵很低），所以这可能导致非常“偏见”。 至少，这样的PRNG不太适合在平面上生成坐标。 <br><br> 另一个顺序： <br><br>  42、72、17、0、30、0、15、9、47、19、35、86、40、54、97、42、69、19、20、88、4、3、67、27、42 56，17，14，14，20，40，80，97，1，31，69，13，88，89，76，9，4，85，17，88，70，10，42，98，96，53 ... <br><br> 即使在飞机上，这里似乎一切都很好： <br><img src="https://habrastorage.org/webt/ou/kh/ec/oukhecshx_b1qwjmt73micdukry.png"><br> 让我们来看看数量（我们读了三个数字）： <br><img src="https://habrastorage.org/webt/ly/sy/08/lysy08ezn_tfyljmvlgjygp_xks.gif"><br> 再次是模式。 无法在四个维度上构建可视化文件。 但是模式既可以在此维度上存在，也可以在较大的维度上同时存在。 <br><br> 在对PRNG施加最严格要求的同一密码学中，这种情况绝对是不可接受的。 因此，为了评估它们的质量，已经开发了特殊算法，我们现在不再赘述。 该主题涉及广泛，并在另一篇文章中进行介绍。 <br><br><h2> 测试中 </h2><br> 如果我们不确定，那么该如何使用呢？ 如果您不知道允许什么交通信号，过马路值得吗？ 结果可能有所不同。 <br><br>  Unity中臭名昭著的随机性也是如此。 好吧，如果文档中揭示了必要的细节，但是在本文开头提到的故事只是由于缺少所需的细节而发生的。 <br><br> 而且，在不知道该工具如何工作的情况下，您将无法正确应用它。 通常，现在是检查和进行实验以确保至少以分发为代价的时候了。 <br><br> 该解决方案简单有效，可以收集统计数据，获取客观数据并查看结果。 <br><br><h3> 研究课题 </h3><br> 在Unity中有几种生成随机数的方法-我们测试了五种。 <br><br><ol><li>  System.Random.Next（）。 在给定的值范围内生成整数。 </li><li>  System.Random.NextDouble（）。 生成范围从[0;  1）。 </li><li>  UnityEngine.Random.Range（）。 在给定的值范围内生成单精度数字（浮点数）。 </li><li>  UnityEngine.Random.value。 生成单精度数字（浮点数），范围为[0;  1）。 </li><li>  Unity.Mathematics.Random.NextFloat（）。 新的Unity.Mathematics库的一部分。 在给定的值范围内生成单精度数字（浮点数）。 </li></ol><br> 除了UnityEngine.Random.value（未指定分布，但与UnityEngine.Random.Range（）类似，它也应该是统一的）和Unity.Mathematics.Random.NextFloat（）（在其中，基础是xorshift算法，这意味着您再次需要等待均匀分布）。 <br><br> 默认情况下，将文档中预期的结果用于预期的结果。 <br><br><h3> 方法论 </h3><br> 我们编写了一个小应用程序，该应用程序在每种提出的方​​法中都生成了随机数序列，并将结果保存下来以便进一步处理。 <br><br> 每个序列的长度为100,000个数字。 <br> 随机数的范围是[0，100）。 <br><br> 数据是从几个目标平台收集的： <br><br><ul><li> 窗户 <br>  -Unity v2018.3.14f1，编辑器模式，Mono，.NET Standard 2.0 </li><li> 操作系统 <br>  -Unity v2018.3.14f1，编辑器模式，Mono，.NET Standard 2.0 <br>  -Unity v5.6.4p4，编辑器模式，Mono，.NET Standard 2.0 </li><li> 安卓系统 <br>  -Unity v2018.3.14f1，在设备上组装，Mono，.NET Standard 2.0 </li><li> 的iOS <br>  -Unity v2018.3.14f1，构建到设备，il2cpp，.NET Standard 2.0 </li></ul><br><h3> 实作 </h3><br> 我们有几种不同的方法来生成随机数。 对于它们中的每一个，我们将编写一个单独的包装器类，该类应提供： <br><br><ol><li> 能够设置值的范围[最小/最大）。 将通过构造函数进行设置。 </li><li> 方法返回中端。 我们将选择float作为类型，作为更通用的类型。 </li><li> 用于标记结果的生成方法的名称。 为了方便起见，我们将返回完整的类名+用于生成中间值的方法的名称作为值。 </li></ol><br> 首先，声明一个抽象，它将由IRandomGenerator接口表示： <br><br><pre><code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">RandomDistribution</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> <span class="hljs-title"><span class="hljs-title">IRandomGenerator</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> Name { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">float</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Generate</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>; } }</code> </pre> <br><h4>  System.Random.Next的实现 </h4><br> 此方法允许您指定值的范围，但它返回整数，并且需要浮点数。 您可以简单地将整数解释为浮点数，也可以将值的范围扩大几个数量级，每次生成中间范围时都对其进行补偿。 它将得出具有指定精度的定点之类的东西。 我们将使用此选项，因为它更接近实际浮点值。 <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">RandomDistribution</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">SystemIntegerRandomGenerator</span></span> : <span class="hljs-title"><span class="hljs-title">IRandomGenerator</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> DefaultFactor = <span class="hljs-number"><span class="hljs-number">100000</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> Random _generator = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Random(); <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> _min; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> _max; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> _factor; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> Name =&gt; <span class="hljs-string"><span class="hljs-string">"System.Random.Next()"</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SystemIntegerRandomGenerator</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> min, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> max, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> factor = DefaultFactor</span></span></span><span class="hljs-function">)</span></span> { _min = (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)min * factor; _max = (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)max * factor; _factor = factor; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">float</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Generate</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> =&gt; (<span class="hljs-keyword"><span class="hljs-keyword">float</span></span>)_generator.Next(_min, _max) / _factor; } }</code> </pre> <br><h4>  System.Random.NextDouble的实现 </h4><br> 此处的固定值范围为[0;  1）。 要将其投影到构造函数中指定的那个，我们使用简单的算法：X *（max-min）+ min。 <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">RandomDistribution</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">SystemDoubleRandomGenerator</span></span> : <span class="hljs-title"><span class="hljs-title">IRandomGenerator</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> Random _generator = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Random(); <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> _factor; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> _min; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> Name =&gt; <span class="hljs-string"><span class="hljs-string">"System.Random.NextDouble()"</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SystemDoubleRandomGenerator</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> min, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> max</span></span></span><span class="hljs-function">)</span></span> { _factor = max - min; _min = min; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">float</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Generate</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> =&gt; (<span class="hljs-keyword"><span class="hljs-keyword">float</span></span>)(_generator.NextDouble() * _factor) + _min; } }</code> </pre> <br><h4>  UnityEngine.Random.Range（）实现 </h4><br>  UnityEngine.Random静态类的此方法使您可以指定值的范围并返回float类型的中间范围。 无需其他转换。 <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEngine; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">RandomDistribution</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">UnityRandomRangeGenerator</span></span> : <span class="hljs-title"><span class="hljs-title">IRandomGenerator</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> _min; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> _max; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> Name =&gt; <span class="hljs-string"><span class="hljs-string">"UnityEngine.Random.Range()"</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">UnityRandomRangeGenerator</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> min, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> max</span></span></span><span class="hljs-function">)</span></span> { _min = min; _max = max; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">float</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Generate</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> =&gt; Random.Range(_min, _max); } }</code> </pre> <br><h4>  UnityEngine.Random.value实现 </h4><br> 静态类UnityEngine.Random的value属性从固定值范围[0;  1）。 我们将其投射到给定范围内的方式与实现System.Random.NextDouble（）时相同。 <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEngine; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">RandomDistribution</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">UnityRandomValueGenerator</span></span> : <span class="hljs-title"><span class="hljs-title">IRandomGenerator</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> _factor; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> _min; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> Name =&gt; <span class="hljs-string"><span class="hljs-string">"UnityEngine.Random.value"</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">UnityRandomValueGenerator</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> min, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> max</span></span></span><span class="hljs-function">)</span></span> { _factor = max - min; _min = min; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">float</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Generate</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> =&gt; (<span class="hljs-keyword"><span class="hljs-keyword">float</span></span>)(Random.<span class="hljs-keyword"><span class="hljs-keyword">value</span></span> * _factor) + _min; } }</code> </pre> <br><h4>  Unity.Mathematics.Random.NextFloat（）实现 </h4><br>  Unity.Mathematics.Random类的NextFloat（）方法返回float类型的中间范围，并允许您指定值的范围。 唯一的区别是，每个Unity.Mathematics.Random实例都必须使用一些种子进行初始化-这样，我们将避免生成重复的序列。 <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Unity.Mathematics; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">RandomDistribution</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">UnityMathematicsRandomValueGenerator</span></span> : <span class="hljs-title"><span class="hljs-title">IRandomGenerator</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Random _generator; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> _min; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> _max; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> Name =&gt; <span class="hljs-string"><span class="hljs-string">"Unity.Mathematics.Random.NextFloat()"</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">UnityMathematicsRandomValueGenerator</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> min, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> max</span></span></span><span class="hljs-function">)</span></span> { _min = min; _max = max; _generator = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Random(); _generator.InitState(<span class="hljs-keyword"><span class="hljs-keyword">unchecked</span></span>((<span class="hljs-keyword"><span class="hljs-keyword">uint</span></span>)System.DateTime.Now.Ticks)); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">float</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Generate</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> =&gt; _generator.NextFloat(_min, _max); } }</code> </pre> <br><h4>  MainController的实现 </h4><br> 几个IRandomGenerator实现已准备就绪。 接下来，您需要生成序列并保存生成的数据集以进行处理。 为此，请在Unity和一个小的脚本MainController中创建一个场景，该场景将执行所有必要的工作，并同时负责与UI交互。 <br><br> 我们设置了数据集的大小和中值的范围，并且还获得了一种方法，该方法返回已调优且随时可用的生成器数组。 <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">RandomDistribution</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">MainController</span></span> : <span class="hljs-title"><span class="hljs-title">MonoBehaviour</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> DefaultDatasetSize = <span class="hljs-number"><span class="hljs-number">100000</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> MinValue = <span class="hljs-number"><span class="hljs-number">0f</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> MaxValue = <span class="hljs-number"><span class="hljs-number">100f</span></span>; ... <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> IRandomGenerator[] </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CreateRandomGenerators</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> IRandomGenerator[] { <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SystemIntegerRandomGenerator(MinValue, MaxValue), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SystemDoubleRandomGenerator(MinValue, MaxValue), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> UnityRandomRangeGenerator(MinValue, MaxValue), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> UnityRandomValueGenerator(MinValue, MaxValue), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> UnityMathematicsRandomValueGenerator(MinValue, MaxValue) }; } ... } }</code> </pre> <br> 现在我们正在形成一个数据集。 在这种情况下，数据生成将与结果记录以文本流（csv格式）结合在一起。 为了存储每个IRandomGenerator的值，分配了一个单独的列，第一行包含生成器的名称。 <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">RandomDistribution</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">MainController</span></span> : <span class="hljs-title"><span class="hljs-title">MonoBehaviour</span></span> { ... <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GenerateCsvDataSet</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">TextWriter writer, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> dataSetSize, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">params</span></span></span></span><span class="hljs-function"><span class="hljs-params"> IRandomGenerator[] generators</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> separator = <span class="hljs-string"><span class="hljs-string">','</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> lastIdx = generators.Length - <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-comment"><span class="hljs-comment">// write header for (int j = 0; j &lt;= lastIdx; j++) { writer.Write(generators[j].Name); if (j != lastIdx) writer.Write(separator); } writer.WriteLine(); // write data for (int i = 0; i &lt;= dataSetSize; i++) { for (int j = 0; j &lt;= lastIdx; j++) { writer.Write(generators[j].Generate()); if (j != lastIdx) writer.Write(separator); } if (i != dataSetSize) writer.WriteLine(); } } ... } }</span></span></code> </pre> <br> 仍然需要调用GenerateCsvDataSet方法并将结果保存到文件中，或者立即通过网络将数据从终端设备传输到接收服务器。 <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">RandomDistribution</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">MainController</span></span> : <span class="hljs-title"><span class="hljs-title">MonoBehaviour</span></span> { ... <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GenerateCsvDataSet</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> path, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> dataSetSize, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">params</span></span></span></span><span class="hljs-function"><span class="hljs-params"> IRandomGenerator[] generators</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> writer = File.CreateText(path)) { GenerateCsvDataSet(writer, dataSetSize, generators); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GenerateCsvDataSet</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> dataSetSize, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">params</span></span></span></span><span class="hljs-function"><span class="hljs-params"> IRandomGenerator[] generators</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> (StringWriter writer = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringWriter(CultureInfo.InvariantCulture)) { GenerateCsvDataSet(writer, dataSetSize, generators); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> writer.ToString(); } } ... } }</code> </pre> <br> 项目来源在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">GitLab上</a> 。 <br><br><h2> 结果 </h2><br> 没有奇迹发生。 他们期望的是，他们得到了-在所有情况下，均一地分发，没有丝毫阴谋。 我看不到在平台上应用单独的图形的意义-它们都显示出大致相同的结果。 <br><br> 现实是： <br><img src="https://habrastorage.org/webt/yr/cb/io/yrcbio95sz22zrzhszi1syge7o8.gif"><br><br> 所有五种生成方法在平面上的序列可视化： <br><img src="https://habrastorage.org/webt/zk/0s/lf/zk0slfejixlez-fp2x9prd19u_c.gif"><br><br> 以及3D可视化。 我将只保留System.Random.Next（）的结果，以免产生大量相同的内容。 <br><img src="https://habrastorage.org/webt/ao/pw/ud/aopwud2ll4sjvtcpj69p-v8or8s.gif"><br><br> 简介中讲述的有关UnityEngine正态分布的故事并没有重复：Random最初是错误的，或者此后引擎发生了变化。 但是现在我们可以确定了。 </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN473880/">https://habr.com/ru/post/zh-CN473880/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN473862/index.html">新的Netology课程-深度学习：机器学习</a></li>
<li><a href="../zh-CN473864/index.html">根据功能测试生成OpenAPI规范</a></li>
<li><a href="../zh-CN473868/index.html">我们来看看中国芯片新星NT78820</a></li>
<li><a href="../zh-CN473872/index.html">Java开发人员面试准备计划</a></li>
<li><a href="../zh-CN473874/index.html">11月的IT事件摘要（第一部分）</a></li>
<li><a href="../zh-CN473882/index.html">功能依赖简介</a></li>
<li><a href="../zh-CN473884/index.html">如何使用Google Analytics（分析）自定义参数的示例从Google BigQuery中以嵌套结构卸载数据</a></li>
<li><a href="../zh-CN473886/index.html">基于公钥标准的密码工作站。 解析和查看ASN1结构的函数</a></li>
<li><a href="../zh-CN473888/index.html">OpenStreetMap第483号世界新闻（10/15/2019-10/21/2019）</a></li>
<li><a href="../zh-CN473890/index.html">卡里普索行动：新的APT集团袭击全球政府机关</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>