<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🕍 💇🏿 🧝🏿 Kiat Praktis, Contoh, dan Terowongan SSH 🥘 ⛹🏿 💃🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Contoh praktis SSH yang akan membawa keterampilan administrator sistem jarak jauh Anda ke tingkat berikutnya. Perintah dan tip akan membantu tidak han...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Kiat Praktis, Contoh, dan Terowongan SSH</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/435546/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/oz/pn/4x/ozpn4xuna3odpakxmdgnlwqxwto.jpeg"></div><br>  Contoh praktis <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">SSH</a> yang akan membawa keterampilan administrator sistem jarak jauh Anda ke tingkat berikutnya.  Perintah dan tip akan membantu tidak hanya menggunakan <code>SSH</code> , tetapi juga menavigasi jaringan dengan lebih kompeten. <br><br>  Mengetahui beberapa trik <code>ssh</code> berguna untuk administrator sistem, insinyur jaringan, atau spesialis keamanan apa pun. <br><a name="habracut"></a><br><h3>  Contoh SSH Praktis </h3><br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">SSH membuat proksi kaus kaki</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Terowongan SSH (Port Forwarding)</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Terowongan SSH ke host ketiga</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">SSH membalikkan terowongan</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Proxy balik SSH</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Menginstal VPN melalui SSH</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Salin kunci SSH (ssh-copy-id)</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Eksekusi perintah jarak jauh (non-interaktif)</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Pengambilan dan melihat paket jarak jauh di Wireshark</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Menyalin folder lokal ke server jauh melalui SSH</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Remote SSH X11 Aplikasi Penerusan GUI</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Menyalin file jarak jauh menggunakan rsync dan SSH</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">SSH melalui jaringan Tor</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">SSH ke EC2 Instance</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Mengedit file teks menggunakan VIM melalui ssh / scp</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Memasang SSH jarak jauh sebagai folder lokal dengan SSHFS</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">SSH Multiplexing dengan ControlPath</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Streaming video SSH menggunakan VLC dan SFTP</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Otentikasi dua faktor</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Host Jumping dengan SSH dan -J</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Memblokir upaya brute force SSH dengan iptables</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">SSH Escape untuk mengubah penerusan port</a> </li></ol><br><h1>  Dasar-dasarnya dulu </h1><br><h4>  Penguraian baris perintah SSH </h4><br>  Contoh berikut menggunakan parameter biasa yang sering ditemukan saat menghubungkan ke server <code>SSH</code> jarak jauh. <br><br><pre> <code class="bash hljs">localhost:~$ ssh -v -p 22 -C neo@remoteserver</code> </pre> <br><ul><li>  <code>-v</code> : output debugging sangat berguna saat menganalisis masalah otentikasi.  Anda dapat menggunakannya beberapa kali untuk menampilkan informasi tambahan. </li><li>  <code>- p 22</code> : <b>port untuk menghubungkan</b> ke server SSH jarak jauh.  22 tidak perlu ditentukan, karena ini adalah nilai default, tetapi jika protokolnya ada pada port lain, maka kita tentukan menggunakan parameter <code>-p</code> .  Port mendengarkan ditentukan dalam file <code>sshd_config</code> dalam format <code>Port 2222</code> . </li><li>  <code>-C</code> : kompresi untuk koneksi.  Jika Anda memiliki umpan lambat atau sedang melihat banyak teks, ini dapat mempercepat koneksi. </li><li>  <code>neo@</code> : baris sebelum simbol @ menunjukkan nama pengguna untuk otentikasi di server jauh.  Jika Anda tidak menentukannya, maka secara default nama pengguna akun yang sedang Anda masuki akan digunakan (~ $ whoami).  Pengguna juga dapat ditentukan dengan opsi <code>-l</code> . </li><li>  <code>remoteserver</code> : nama host yang <code>ssh</code> hubungkan, itu bisa berupa nama domain yang sepenuhnya memenuhi syarat, alamat IP, atau host apa pun di file host lokal.  Untuk menghubungkan ke host yang mendukung IPv4 dan IPv6, Anda dapat menambahkan opsi <code>-4</code> atau <code>-6</code> ke baris perintah untuk resolusi yang tepat. </li></ul><br>  Semua opsi di atas adalah opsional kecuali <code>remoteserver</code> . <br><br><h4>  Menggunakan file konfigurasi </h4><br>  Meskipun banyak yang akrab dengan file <code>sshd_config</code> , ada juga file konfigurasi klien untuk perintah <code>ssh</code> .  Nilai default adalah <code>~/.ssh/config</code> , tetapi dapat didefinisikan sebagai parameter untuk opsi <code>-F</code> . <br><br><pre> <code class="bash hljs">Host * Port 2222 Host remoteserver HostName remoteserver.thematrix.io User neo Port 2112 IdentityFile /home/<span class="hljs-built_in"><span class="hljs-built_in">test</span></span>/.ssh/remoteserver.private_key</code> </pre> <br>  Contoh file konfigurasi ssh di atas memiliki dua entri host.  Yang pertama menunjukkan semua host, parameter konfigurasi Port 2222 digunakan untuk <b>semua.Yang</b> kedua mengatakan bahwa untuk host <b>remote</b> , gunakan nama pengguna yang berbeda, port, FQDN dan IdentityFile. <br><br>  File konfigurasi dapat menghemat banyak waktu pengetikan karakter, memungkinkan Anda untuk secara otomatis menerapkan konfigurasi lanjutan saat menghubungkan ke host tertentu. <br><br><h4>  Salin file melalui SSH menggunakan SCP </h4><br>  Klien SSH dilengkapi dengan dua alat lain yang sangat nyaman untuk menyalin file melalui <b>koneksi ssh terenkripsi</b> .  Lihat di bawah untuk contoh penggunaan standar perintah scp dan sftp.  Perhatikan bahwa banyak opsi untuk ssh juga berlaku untuk perintah ini. <br><br><pre> <code class="bash hljs">localhost:~$ scp mypic.png neo@remoteserver:/media/data/mypic_2.png</code> </pre> <br>  Dalam contoh ini, file <b>mypic.png</b> disalin ke <b>server remote</b> <b>/</b> folder <b>/ data</b> dan diubah namanya menjadi <b>mypic_2.png</b> . <br><br>  Jangan lupa tentang perbedaan dalam parameter port.  Ini datang di banyak yang menjalankan <code>scp</code> dari baris perintah.  Di sini parameter port <code>-P</code> , bukan <code>-p</code> , seperti pada klien ssh!  Anda akan lupa, tetapi jangan khawatir, semua orang akan lupa. <br><br>  Bagi mereka yang terbiasa dengan konsol <code>ftp</code> , banyak dari perintah serupa di <code>sftp</code> .  Anda dapat melakukan <b>push</b> , <b>put</b> dan <b>ls</b> sesuai keinginan hati Anda. <br><br><pre> <code class="bash hljs">sftp neo@remoteserver</code> </pre> <br><h1>  Contoh-contoh praktis </h1><br>  Dalam banyak contoh ini, hasilnya dapat dicapai dengan berbagai metode.  Seperti halnya semua <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">buku pelajaran</a> dan contoh kami, preferensi diberikan pada contoh-contoh praktis yang hanya melakukan pekerjaan mereka. <br><br><a name="1"></a><h3>  1. SSH kaus kaki proxy </h3><br>  SSH Proxy di nomor 1 untuk alasan yang bagus.  Ini lebih kuat daripada yang banyak diasumsikan, dan memberi Anda akses ke sistem apa pun yang server jarak jauh memiliki akses untuk menggunakan hampir semua aplikasi.  Klien ssh dapat melakukan tunnel traffic melalui proxy SOCKS dengan satu perintah sederhana.  Penting untuk dipahami bahwa lalu lintas ke sistem jarak jauh akan berasal dari server jarak jauh, seperti yang akan ditunjukkan dalam log server web. <br><br><pre> <code class="bash hljs">localhost:~$ ssh -D 8888 user@remoteserver localhost:~$ netstat -pan | grep 8888 tcp 0 0 127.0.0.1:8888 0.0.0.0:* LISTEN 23880/ssh</code> </pre> <br>  Di sini kita menjalankan proxy kaus kaki pada port TCP 8888, perintah kedua memeriksa apakah port aktif dalam mode mendengarkan.  127.0.0.1 menunjukkan bahwa layanan hanya berjalan di localhost.  Kita dapat menggunakan perintah yang sedikit berbeda untuk mendengarkan semua antarmuka, termasuk ethernet atau wifi, ini akan memungkinkan aplikasi lain (browser, dll.) Di jaringan kami untuk terhubung ke layanan proxy melalui ssh socks proxy. <br><br><pre> <code class="bash hljs">localhost:~$ ssh -D 0.0.0.0:8888 user@remoteserver</code> </pre> <br>  Sekarang kita dapat mengkonfigurasi browser untuk terhubung ke proksi kaus kaki.  Di Firefox, pilih <b>Pengaturan |</b>  <b>Sorotan |</b>  <b>Pengaturan Jaringan</b>  Tentukan alamat IP dan port yang akan dihubungkan. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/daa/f8b/545/daaf8b54515ce6eee864c8416d41eef9.png"><br><br>  Perhatikan opsi di bagian bawah formulir sehingga permintaan DNS peramban juga melalui proxy SOCKS.  Jika Anda menggunakan server proxy untuk mengenkripsi lalu lintas web di jaringan lokal, maka Anda mungkin ingin memilih opsi ini sehingga permintaan DNS disalurkan melalui koneksi SSH. <br><br><h4>  Socks aktivasi proxy di Chrome </h4><br>  Menjalankan Chrome dengan opsi baris perintah tertentu mengaktifkan proksi kaus kaki, serta menyalurkan kueri DNS dari browser.  Percaya, tapi verifikasi.  Gunakan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">tcpdump</a> untuk memverifikasi bahwa permintaan DNS tidak lagi terlihat. <br><br><pre> <code class="bash hljs">localhost:~$ google-chrome --proxy-server=<span class="hljs-string"><span class="hljs-string">"socks5://192.168.1.10:8888"</span></span></code> </pre> <br><h4>  Menggunakan aplikasi proxy lain </h4><br>  Perlu diingat bahwa banyak aplikasi lain juga dapat menggunakan proksi kaus kaki.  Browser web adalah yang paling populer.  Beberapa aplikasi memiliki opsi konfigurasi untuk mengaktifkan server proxy.  Yang lain membutuhkan sedikit bantuan dengan program pembantu.  Misalnya, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">proxychains</a> memungkinkan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Anda</a> untuk menjalankan Microsoft RDP, dll. Melalui socks-proxy. <br><br><pre> <code class="bash hljs">localhost:~$ proxychains rdesktop <span class="hljs-variable"><span class="hljs-variable">$RemoteWindowsServer</span></span></code> </pre> <br>  Parameter konfigurasi proxy kaus kaki diatur dalam file konfigurasi proxykunci. <br><br><blockquote>  Petunjuk: jika Anda menggunakan desktop jarak jauh dari Linux pada Windows?  Coba klien <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">FreeRDP</a> .  Ini adalah implementasi yang lebih modern daripada <code>rdesktop</code> , dengan interaksi yang lebih lancar. </blockquote><br><h4>  Opsi SSH melalui proxy kaus kaki </h4><br>  Anda sedang duduk di kafe atau hotel - dan terpaksa menggunakan WiFi yang agak tidak dapat diandalkan.  Dari laptop, luncurkan ssh proxy secara lokal dan instal ssh tunnel ke jaringan rumah di Rasberry Pi lokal.  Dengan menggunakan browser atau aplikasi lain yang dikonfigurasi untuk proxy kaus kaki, kita dapat mengakses layanan jaringan apa pun di jaringan rumah kami atau mengakses Internet melalui koneksi rumah.  Segala sesuatu antara laptop Anda dan server rumah Anda (melalui Wi-Fi dan Internet ke rumah Anda) dienkripsi di terowongan SSH. <br><br><a name="2"></a><h3>  2. Terowongan SSH (port forwarding) </h3><br>  Dalam bentuknya yang paling sederhana, terowongan SSH hanya membuka port pada sistem lokal Anda yang terhubung ke port lain di ujung tunnel. <br><br><pre> <code class="bash hljs">localhost:~$ ssh -L 9999:127.0.0.1:80 user@remoteserver</code> </pre> <br>  Mari kita periksa opsi <code>-L</code> .  Itu dapat direpresentasikan sebagai sisi lokal dari mendengarkan.  Jadi, dalam contoh di atas, port 9999 didengarkan di sisi localhost dan diteruskan melalui port 80 ke remote server.  Harap dicatat bahwa 127.0.0.1 merujuk ke localhost di server jarak jauh! <br><br>  Mari naik satu langkah.  Dalam contoh berikut, port mendengarkan berkomunikasi dengan node lain di jaringan lokal. <br><br><pre> <code class="bash hljs">localhost:~$ ssh -L 0.0.0.0:9999:127.0.0.1:80 user@remoteserver</code> </pre> <br>  Dalam contoh ini, kami terhubung ke port di server web, tetapi itu bisa berupa server proxy atau layanan TCP lainnya. <br><br><a name="3"></a><h3>  3. Terowongan SSH ke host pihak ketiga </h3><br>  Kita dapat menggunakan parameter yang sama untuk menghubungkan terowongan dari server jauh ke layanan lain yang berjalan pada sistem ketiga. <br><br><pre> <code class="bash hljs">localhost:~$ ssh -L 0.0.0.0:9999:10.10.10.10:80 user@remoteserver</code> </pre> <br>  Dalam contoh ini, kami mengarahkan ulang terowongan dari remote ke server web yang berjalan pada 10.10.10.10.  Lalu lintas dengan remote server pada 10.10.10.10 <b>tidak lagi ada di terowongan SSH</b> .  Pada 10.10.10.10, server web akan mempertimbangkan remoteer sebagai sumber permintaan web. <br><br><a name="4"></a><h3>  4. Membalikkan terowongan SSH </h3><br>  Di sini kita mengkonfigurasi port mendengarkan pada server jarak jauh, yang akan terhubung kembali ke port lokal di localhost kami (atau sistem lain). <br><br><pre> <code class="bash hljs">localhost:~$ ssh -v -R 0.0.0.0:1999:127.0.0.1:902 192.168.1.100 user@remoteserver</code> </pre> <br>  Dalam sesi SSH ini, koneksi dibuat dari port 1999 pada remote control ke port 902 pada klien lokal kami. <br><br><a name="5"></a><h3>  5. Membalikkan proxy SSH </h3><br>  Dalam hal ini, kami memasang proxy kaus kaki pada koneksi ssh kami, namun proxy mendengarkan di ujung server.  Koneksi ke proxy jarak jauh ini sekarang muncul dari terowongan sebagai lalu lintas dari localhost kami. <br><br><pre> <code class="bash hljs">localhost:~$ ssh -v -R 0.0.0.0:1999 192.168.1.100 user@remoteserver</code> </pre> <br><h4>  Memecahkan masalah Terowongan SSH Jarak Jauh </h4><br>  Jika Anda memiliki masalah dengan opsi SSH jarak jauh, periksa dengan <code>netstat</code> apa antarmuka lain yang terhubung ke port mendengarkan.  Meskipun kami menetapkan 0.0.0.0 dalam contoh, tetapi jika nilai <b>GatewayPorts</b> di <b>sshd_config</b> diatur ke <b>no</b> , maka pendengar hanya akan terikat ke localhost (127.0.0.1). <br><br><blockquote><h4>  Peringatan keamanan </h4><br>  Harap dicatat bahwa ketika membuka proksi terowongan dan kaus kaki, sumber daya jaringan internal mungkin tersedia untuk jaringan yang tidak terpercaya (misalnya, Internet!).  Ini bisa menjadi risiko keamanan yang serius, jadi pastikan Anda memahami apa yang pendengarnya dan apa yang ia miliki. </blockquote><br><a name="6"></a><h3>  6. Menginstal VPN melalui SSH </h3><br>  Istilah umum di antara spesialis dalam metode serangan (pentester, dll.) Adalah "titik tumpu jaringan."  Setelah membuat koneksi dalam satu sistem, sistem ini menjadi gateway untuk akses lebih lanjut ke jaringan.  Titik tumpu yang memungkinkan Anda bergerak dengan luas. <br><br>  Untuk titik tumpu seperti itu, kita dapat menggunakan proxy SSH dan proxy, tetapi ada beberapa batasan.  Misalnya, Anda tidak akan dapat bekerja secara langsung dengan soket, jadi kami tidak akan dapat memindai port di dalam jaringan melalui <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Nmap</a> <code>SYN</code> . <br><br>  Menggunakan opsi VPN yang lebih canggih ini, koneksi turun ke <b>level 3</b> .  Kemudian kita cukup merutekan traffic melalui tunnel menggunakan routing jaringan standar. <br><br>  Metode ini menggunakan <code>ssh</code> , <code>iptables</code> , <code>tun interfaces</code> dan routing. <br><br>  Pertama, Anda perlu mengatur parameter ini di <code>sshd_config</code> .  Karena kami membuat perubahan pada antarmuka sistem remote dan klien, kami <b>membutuhkan hak akses root di kedua sisi</b> . <br><br><pre> <code class="bash hljs">PermitRootLogin yes PermitTunnel yes</code> </pre> <br>  Kemudian buat koneksi ssh menggunakan parameter yang meminta inisialisasi perangkat tun. <br><br><pre> <code class="bash hljs">localhost:~<span class="hljs-comment"><span class="hljs-comment"># ssh -v -w any root@remoteserver</span></span></code> </pre> <br>  Sekarang kita harus memiliki perangkat tun ketika menampilkan antarmuka ( <code># ip a</code> ).  Langkah selanjutnya akan menambahkan alamat IP ke antarmuka terowongan. <br><br>  Sisi Klien SSH: <br><br><pre> <code class="bash hljs">localhost:~<span class="hljs-comment"><span class="hljs-comment"># ip addr add 10.10.10.2/32 peer 10.10.10.10 dev tun0 localhost:~# ip tun0 up</span></span></code> </pre> <br>  Sisi Server SSH: <br><br><pre> <code class="bash hljs">remoteserver:~<span class="hljs-comment"><span class="hljs-comment"># ip addr add 10.10.10.10/32 peer 10.10.10.2 dev tun0 remoteserver:~# ip tun0 up</span></span></code> </pre> <br>  Sekarang kita memiliki rute langsung ke host lain ( <code>route -n</code> dan <code>ping 10.10.10.10</code> ). <br><br>  Anda dapat merutekan subnet apa pun melalui host di sisi lain. <br><br><pre> <code class="bash hljs">localhost:~<span class="hljs-comment"><span class="hljs-comment"># route add -net 10.10.10.0 netmask 255.255.255.0 dev tun0</span></span></code> </pre> <br>  Di sisi jarak jauh, Anda harus mengaktifkan <code>ip_forward</code> dan <code>iptables</code> . <br><br><pre> <code class="bash hljs">remoteserver:~<span class="hljs-comment"><span class="hljs-comment"># echo 1 &gt; /proc/sys/net/ipv4/ip_forward remoteserver:~# iptables -t nat -A POSTROUTING -s 10.10.10.2 -o enp7s0 -j MASQUERADE</span></span></code> </pre> <br>  Boom!  <b>VPN over SSH tunnel pada lapisan jaringan 3</b> .  Ini sudah merupakan kemenangan. <br><br>  Jika Anda mengalami masalah, gunakan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">tcpdump</a> dan <code>ping</code> untuk menentukan penyebabnya.  Karena kami bermain di level 3, paket icmp kami akan melewati terowongan ini. <br><br><a name="7"></a><h3>  7. Menyalin kunci SSH (ssh-copy-id) </h3><br>  Ada beberapa cara, tetapi perintah ini menghemat waktu agar tidak menyalin file secara manual.  Ini hanya menyalin ~ / .ssh / id_rsa.pub (atau kunci default) dari sistem Anda ke <code>~/.ssh/authorized_keys</code> di server jarak jauh. <br><br><pre> <code class="bash hljs">localhost:~$ ssh-copy-id user@remoteserver</code> </pre> <br><a name="8"></a><h3>  8. Eksekusi perintah jarak jauh (non-interaktif) </h3><br>  Perintah <code>ssh</code> dapat dikaitkan dengan perintah lain untuk antarmuka yang mudah digunakan.  Cukup tambahkan perintah yang ingin Anda jalankan pada host jarak jauh sebagai parameter terakhir dalam tanda kutip. <br><br><pre> <code class="bash hljs">localhost:~$ ssh remoteserver <span class="hljs-string"><span class="hljs-string">"cat /var/log/nginx/access.log"</span></span> | grep badstuff.php</code> </pre> <br>  Dalam contoh ini, <code>grep</code> berjalan pada sistem lokal setelah log diunduh melalui saluran ssh.  Jika file berukuran besar, lebih mudah untuk menjalankan <code>grep</code> di sisi jarak jauh, cukup lampirkan kedua perintah dalam tanda kutip ganda. <br><br>  Contoh lain menjalankan fungsi yang sama dengan <code>ssh-copy-id</code> dari contoh 7. <br><br><pre> <code class="bash hljs">localhost:~$ cat ~/.ssh/id_rsa.pub | ssh remoteserver <span class="hljs-string"><span class="hljs-string">'cat &gt;&gt; .ssh/authorized_keys'</span></span></code> </pre> <br><a name="9"></a><h3>  9. Pengambilan dan melihat paket jarak jauh di Wireshark </h3><br>  Saya mengambil salah satu <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">contoh tcpdump</a> kami.  Gunakan untuk mencegat paket dengan hasil secara langsung di GUI Wireshark lokal. <br><br><pre> <code class="bash hljs">:~$ ssh root@remoteserver <span class="hljs-string"><span class="hljs-string">'tcpdump -c 1000 -nn -w - not port 22'</span></span> | wireshark -k -i -</code> </pre> <br><a name="10"></a><h3>  10. Menyalin folder lokal ke server jauh melalui SSH </h3><br>  Trik yang indah yang mengkompres folder menggunakan <code>bzip2</code> (ini adalah opsi -j dalam perintah <code>tar</code> ) dan kemudian mengekstrak aliran <code>bzip2</code> di sisi lain, membuat duplikat folder di server jauh. <br><br><pre> <code class="bash hljs">localhost:~$ tar -cvj /datafolder | ssh remoteserver <span class="hljs-string"><span class="hljs-string">"tar -xj -C /datafolder"</span></span></code> </pre> <br><a name="11"></a><h3>  11. Remote SSH X11 Penerusan Aplikasi GUI </h3><br>  Jika klien dan server jarak jauh telah menginstal X, maka Anda dapat mengeksekusi perintah GUI dari jarak jauh, dengan jendela di desktop lokal Anda.  Fitur ini sudah ada sejak lama, tetapi masih sangat bermanfaat.  Luncurkan browser web jarak jauh atau bahkan konsol VMWawre Workstation, seperti yang saya lakukan dalam contoh ini. <br><br><pre> <code class="bash hljs">localhost:~$ ssh -X remoteserver vmware</code> </pre> <br>  Membutuhkan baris <code>X11Forwarding yes</code> di file <code>sshd_config</code> . <br><br><a name="12"></a><h3>  12. Menyalin file jarak jauh menggunakan rsync dan SSH </h3><br>  <code>rsync</code> jauh lebih nyaman daripada <code>scp</code> jika Anda perlu membuat cadangan direktori, sejumlah besar file, atau file yang sangat besar secara berkala.  Ada fungsi untuk memulihkan dari kegagalan transmisi dan hanya menyalin file yang dimodifikasi, yang menghemat lalu lintas dan waktu. <br><br>  Contoh ini menggunakan kompresi <code>gzip</code> (-z) dan mode arsip (-a), yang memungkinkan penyalinan rekursif. <br><br><pre> <code class="bash hljs">:~$ rsync -az /home/testuser/data remoteserver:backup/</code> </pre> <br><a name="13"></a><h3>  13. SSH melalui jaringan Tor </h3><br>  Jaringan Tor anonim dapat menyalurkan lalu lintas SSH menggunakan <code>torsocks</code> .  Perintah berikut ini akan membuang proxy ssh melalui Tor. <br><br><pre> <code class="bash hljs">localhost:~$ torsocks ssh myuntracableuser@remoteserver</code> </pre> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Torsocks</a> akan menggunakan port 9050 untuk proxy di localhost.  Seperti biasa, ketika menggunakan Tor, Anda perlu secara serius memeriksa lalu lintas apa yang sedang disalurkan dan masalah keamanan operasional lainnya (opsec).  <b>Ke mana perginya pertanyaan DNS Anda?</b> <br><br><a name="14"></a><h3>  14. SSH ke EC2 Instance </h3><br>  Diperlukan kunci pribadi untuk terhubung ke instance EC2.  Unduh (ekstensi .pem) dari panel kontrol Amazon EC2 dan ubah izinnya ( <code>chmod 400 my-ec2-ssh-key.pem</code> ).  Simpan kunci di tempat yang aman atau letakkan di folder <code>~/.ssh/</code> . <br><br><pre> <code class="bash hljs">localhost:~$ ssh -i ~/.ssh/my-ec2-key.pem ubuntu@my-ec2-public</code> </pre> <br>  <b>Opsi -i</b> hanya memberi tahu klien ssh untuk menggunakan sakelar ini.  File <code>~/.ssh/config</code> ideal untuk mengonfigurasi penggunaan kunci secara otomatis saat menghubungkan ke host ec2. <br><br><pre> <code class="bash hljs">Host my-ec2-public Hostname ec2???.compute-1.amazonaws.com User ubuntu IdentityFile ~/.ssh/my-ec2-key.pem</code> </pre> <br><a name="15"></a><h3>  15. Mengedit file teks menggunakan VIM melalui ssh / scp </h3><br>  Untuk semua pecinta <code>vim</code> , tip ini akan menghemat sedikit waktu.  Menggunakan <code>vim</code> file diedit menggunakan scp dengan satu perintah.  Metode ini hanya membuat file secara lokal di <code>/tmp</code> dan kemudian menyalinnya kembali setelah kami menyimpannya dari <code>vim</code> . <br><br><pre> <code class="bash hljs">localhost:~$ vim scp://user@remoteserver//etc/hosts</code> </pre> <br>  Catatan: formatnya sedikit berbeda dari <code>scp</code> biasa.  Setelah tuan rumah, kita memiliki double <code>//</code> .  Ini adalah tautan ke jalur absolut.  Satu garis miring akan berarti jalur relatif ke folder beranda <code>users</code> . <br><br><pre> <code class="bash hljs">**warning** (netrw) cannot determine method (format: protocol://[user@]hostname[:port]/[path])</code> </pre> <br>  Jika Anda melihat kesalahan ini, periksa kembali format perintah.  Ini biasanya berarti kesalahan sintaksis. <br><br><a name="16"></a><h3>  16. Memasang SSH jarak jauh sebagai folder lokal dengan SSHFS </h3><br>  Menggunakan <code>sshfs</code> , klien sistem file <code>ssh</code> , kita dapat menghubungkan direktori lokal ke lokasi jauh dengan semua interaksi file dalam sesi <code>ssh</code> terenkripsi. <br><br><pre> <code class="bash hljs">localhost:~$ apt install sshfs</code> </pre> <br>  Kami menginstal paket <code>sshfs</code> di Ubuntu dan Debian, dan kemudian hanya me-mount lokasi remote pada sistem kami. <br><br><pre> <code class="bash hljs">localhost:~$ sshfs user@remoteserver:/media/data ~/data/</code> </pre> <br><a name="17"></a><h3>  17. SSH Multiplexing dengan ControlPath </h3><br>  Secara default, jika Anda memiliki koneksi yang ada ke server jauh menggunakan <code>ssh</code> koneksi kedua menggunakan <code>ssh</code> atau <code>scp</code> membuat sesi baru dengan otentikasi tambahan.  Opsi <code>ControlPath</code> memungkinkan Anda untuk menggunakan sesi yang ada untuk semua koneksi berikutnya.  Ini akan mempercepat proses secara signifikan: efeknya terlihat bahkan pada jaringan lokal, dan bahkan lebih lagi ketika terhubung ke sumber daya jarak jauh. <br><br><pre> <code class="bash hljs">Host remoteserver HostName remoteserver.example.org ControlMaster auto ControlPath ~/.ssh/control/%r@%h:%p ControlPersist 10m</code> </pre> <br>  ControlPath memberitahu soket untuk memeriksa koneksi baru untuk sesi <code>ssh</code> aktif.  Opsi terakhir berarti bahwa bahkan setelah keluar dari konsol, sesi yang ada akan tetap terbuka selama 10 menit, jadi selama waktu ini Anda dapat menyambung kembali ke soket yang ada.  Lihat bantuan <code>ssh_config man</code> untuk informasi lebih lanjut. <br><br><a name="18"></a><h3>  18. Streaming video melalui SSH menggunakan VLC dan SFTP </h3><br>  Bahkan pengguna lama <code>ssh</code> dan <code>vlc</code> (Video Lan Client) tidak selalu tahu tentang opsi yang mudah ini ketika Anda benar-benar perlu menonton video di jaringan.  Dalam pengaturan <b>File |</b>  Program <b>Open Network Stream</b> <code>vlc</code> dapat memasukkan lokasi sebagai <code>sftp://</code> .  Jika kata sandi diperlukan, sebuah prompt muncul. <br><br><pre> <code class="bash hljs">sftp://remoteserver//media/uploads/myvideo.mkv</code> </pre> <br><a name="19"></a><h3>  19. Otentikasi dua faktor </h3><br>  Otentikasi dua faktor yang sama dengan rekening bank atau akun Google Anda berlaku untuk layanan SSH. <br><br>  Tentu saja, <code>ssh</code> pada awalnya memiliki fungsi otentikasi dua faktor, yang berarti kata sandi dan kunci SSH.  Keuntungan dari token perangkat keras atau aplikasi Google Authenticator adalah biasanya itu adalah perangkat fisik yang berbeda. <br><br>  Lihat panduan 8 menit kami tentang <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">penggunaan Google Authenticator dan SSH</a> . <br><br><a name="20"></a><h3>  20. Host jumping dengan ssh dan -J </h3><br>  Jika, karena segmentasi jaringan, Anda harus melewati beberapa host ssh untuk mencapai jaringan tujuan akhir, pintasan -J akan menghemat waktu Anda. <br><br><pre> <code class="bash hljs">localhost:~$ ssh -J host1,host2,host3 user@host4.internal</code> </pre> <br>  Hal utama yang harus dipahami di sini adalah bahwa ini tidak analog dengan perintah <code>ssh host1</code> , kemudian <code>user@host1:~$ ssh host2</code> , dll. Parameter -J secara cerdik menggunakan penerusan sehingga localhost membuat sesi dengan host berikutnya dalam rantai.  Jadi, dalam contoh di atas, localhost kami mengautentikasi ke host4.  Yaitu, kunci localhost kami digunakan, dan sesi dari localhost ke host4 sepenuhnya dienkripsi. <br><br>  Untuk melakukan ini, tentukan opsi konfigurasi <b>proxyJump</b> di <b>ssh_config</b> .  Jika Anda secara teratur harus melalui beberapa host, maka otomatisasi melalui konfigurasi akan menghemat banyak waktu. <br><br><a name="21"></a><h3>  21. Memblokir upaya brute force SSH menggunakan iptables </h3><br>  Siapa pun yang telah menjalankan layanan SSH dan melihat log tahu tentang jumlah upaya kekerasan yang terjadi setiap jam setiap hari.  Cara cepat untuk mengurangi noise dalam log adalah dengan memigrasikan SSH ke port non-standar.  Buat perubahan pada file <code>sshd_config</code> menggunakan parameter konfigurasi <b>Port ##</b> . <br><br>  Menggunakan <code>iptables</code> , Anda juga dapat dengan mudah memblokir upaya untuk terhubung ke port setelah mencapai batas tertentu.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cara mudah untuk melakukan ini adalah dengan menggunakan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OSSEC</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , karena tidak hanya memblokir SSH, tetapi melakukan banyak langkah-langkah deteksi intrusi berbasis host (HIDS).</font></font><br><br><a name="22"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 22. SSH Escape untuk mengubah penerusan port </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dan contoh terakhir kami </font></font><code>ssh</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">adalah untuk mengubah port forwarding on the fly dalam sesi yang ada </font></font><code>ssh</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Bayangkan skenario seperti itu. </font><font style="vertical-align: inherit;">Anda online mendalam; </font><font style="vertical-align: inherit;">Anda mungkin telah melompati lebih dari setengah lusin host dan Anda memerlukan port lokal pada workstation yang dialihkan ke Microsoft SMB dari sistem Windows 2003 lama (apakah ada yang ingat ms08-67?). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dengan mengklik </font></font><code>enter</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, coba ketikkan konsol </font></font><code>~C</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Ini adalah urutan kontrol dalam sesi yang memungkinkan Anda untuk membuat perubahan pada koneksi yang ada.</font></font><br><br><pre> <code class="bash hljs">localhost:~$ ~C ssh&gt; -h Commands: -L[bind_address:]port:host:hostport Request <span class="hljs-built_in"><span class="hljs-built_in">local</span></span> forward -R[bind_address:]port:host:hostport Request remote forward -D[bind_address:]port Request dynamic forward -KL[bind_address:]port Cancel <span class="hljs-built_in"><span class="hljs-built_in">local</span></span> forward -KR[bind_address:]port Cancel remote forward -KD[bind_address:]port Cancel dynamic forward ssh&gt; -L 1445:remote-win2k3:445 Forwarding port.</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Di sini Anda dapat melihat bahwa kami mengalihkan port lokal 1445 kami ke host Windows 2003 yang kami temukan di jaringan internal. </font><font style="vertical-align: inherit;">Sekarang jalankan </font></font><code>msfconsole</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">saja dan Anda dapat melanjutkan (dengan asumsi Anda berencana untuk menggunakan host ini).</font></font><br><br><h1>  Penyelesaian </h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Contoh, tip, dan perintah ini </font></font><code>ssh</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">harus menyediakan titik awal; </font><font style="vertical-align: inherit;">Informasi lebih lanjut tentang masing-masing perintah dan fitur yang tersedia pada halaman bantuan ( </font></font><code>man ssh</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>man ssh_config</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>man sshd_config</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Saya selalu terpesona oleh kemampuan untuk mengakses sistem dan menjalankan perintah di mana saja di dunia. </font><font style="vertical-align: inherit;">Mengembangkan keterampilan Anda dalam bekerja dengan alat-alat seperti </font></font><code>ssh</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anda akan menjadi lebih efektif dalam permainan apa pun yang Anda mainkan.</font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id435546/">https://habr.com/ru/post/id435546/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id435536/index.html">Robot humanoid: manfaat dan masalah mekanisme antropomorfik</a></li>
<li><a href="../id435538/index.html">Pada 2018, lebih banyak energi "hijau" diterima di Jerman daripada listrik dari pembakaran batu bara</a></li>
<li><a href="../id435540/index.html">Kata kunci baru di Jawa</a></li>
<li><a href="../id435542/index.html">Pengembangan game dan pertahanan diploma, atau "Bagaimana saya membunuh dua burung dengan satu pancake batu pertama"</a></li>
<li><a href="../id435544/index.html">Karyawan Universitas Innopolis menerima hibah Facebook</a></li>
<li><a href="../id435548/index.html">Meretas layanan publik - mungkin, jika benar-benar diperlukan</a></li>
<li><a href="../id435550/index.html">GitLab 11.6 dirilis dengan fitur serverless dan cluster Kubernetes untuk grup</a></li>
<li><a href="../id435552/index.html">Substitusi impor - epitaf dari digitalisasi</a></li>
<li><a href="../id435556/index.html">Pindah ke pusat data: bagaimana itu</a></li>
<li><a href="../id435558/index.html">Menguji PostgreSQL dengan HugePages di Linux</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>