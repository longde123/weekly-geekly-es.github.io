<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üêøÔ∏è üçõ üëàüèæ ClickHouse-Datenbank f√ºr Menschen oder Alien-Technologie üë± üêå ‚úäüèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Alexey Lizunov, Leiter des Kompetenzzentrums f√ºr Remote-Service-Kan√§le der Direktion f√ºr Informationstechnologien des ICD 



 Als Alternative zum ELK...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ClickHouse-Datenbank f√ºr Menschen oder Alien-Technologie</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/mkb/blog/472912/"> <b>Alexey Lizunov, Leiter des Kompetenzzentrums f√ºr Remote-Service-Kan√§le der Direktion f√ºr Informationstechnologien des ICD</b> <br><br><img src="https://habrastorage.org/webt/bs/gu/k0/bsguk03an99lspkpmtkoks2bkvg.png"><br><br>  Als Alternative zum ELK-Stack (ElasticSearch, Logstash, Kibana) untersuchen wir die Verwendung der ClickHouse-Datenbank als Data Warehouse f√ºr Protokolle. <br><br>  In diesem Artikel m√∂chten wir √ºber unsere Erfahrungen mit der ClickHouse-Datenbank und √ºber vorl√§ufige Ergebnisse des Pilotbetriebs sprechen.  Es sollte sofort angemerkt werden, dass die Ergebnisse beeindruckend waren. <br><br><a name="habracut"></a><br><img src="https://habrastorage.org/webt/uy/mc/ip/uymcipeis_jm2piqsaqdjmu9_l8.jpeg"><br><br>  Als n√§chstes werden wir detaillierter beschreiben, wie unser System konfiguriert ist und aus welchen Komponenten es besteht.  Aber jetzt m√∂chte ich ein wenig √ºber diese Datenbank als Ganzes sprechen und warum Sie darauf achten sollten.  Die ClickHouse-Datenbank ist eine leistungsstarke analytische Spaltendatenbank von Yandex.  Es wird in Yandex-Diensten verwendet und ist zun√§chst das Haupt-Data-Warehouse f√ºr Yandex.Metrica.  Das Open-Source-System ist kostenlos.  Aus Sicht des Entwicklers war ich immer daran interessiert, wie sie es implementiert haben, weil es fantastisch gro√üe Datenmengen gibt.  Und die metrische Benutzeroberfl√§che selbst ist sehr flexibel und schnell.  Bei der ersten Bekanntschaft mit dieser Datenbank der Eindruck: ‚ÄûNun, endlich!  Gemacht "f√ºr Menschen"!  Beginnend mit dem Installationsprozess und endend mit dem Senden von Anforderungen. " <br><br>  Diese Datenbank hat eine sehr niedrige Eintragsschwelle.  Selbst ein durchschnittlicher erfahrener Entwickler kann diese Datenbank in wenigen Minuten installieren und verwenden.  Alles funktioniert klar.  Selbst Linux-Neulinge k√∂nnen die Installation schnell durchf√ºhren und einfache Vorg√§nge ausf√ºhren.  Fr√ºher, als das Wort Big Data, Hadoop, Google BigTable, HDFS, der √ºbliche Entwickler die Idee hatte, dass es sich um Terabyte, Petabyte handelte, dass einige √úbermenschen an den Einstellungen und der Entwicklung f√ºr diese Systeme beteiligt waren, kamen wir mit dem Aufkommen der ClickHouse-Datenbank Ein einfaches, verst√§ndliches Werkzeug, mit dem Sie den bisher unerreichbaren Aufgabenbereich l√∂sen k√∂nnen.  Nur ein ziemlich durchschnittliches Auto und f√ºnf Minuten zu installieren.  Das hei√üt, wir haben eine Datenbank wie zum Beispiel MySql, aber nur zum Speichern von Milliarden von Datens√§tzen!  Eine Art SQL-Supervisor.  Es ist, als w√ºrden Menschen Waffen von Au√üerirdischen gegeben. <br><br><h4>  √úber unser Protokollsammelsystem </h4><br>  Zum Sammeln von Informationen werden IIS-Protokolldateien von Webanwendungen eines Standardformats verwendet (wir analysieren auch Anwendungsprotokolle, aber das Hauptziel in der Phase des Pilotbetriebs mit uns ist das Sammeln von IIS-Protokollen). <br><br>  Aus verschiedenen Gr√ºnden konnten wir den ELK-Stack nicht vollst√§ndig aufgeben und verwenden weiterhin die Komponenten LogStash und Filebeat, die sich bew√§hrt haben und recht zuverl√§ssig und vorhersehbar funktionieren. <br><br>  Das allgemeine Protokollierungsschema ist in der folgenden Abbildung dargestellt: <br><br><img src="https://habrastorage.org/webt/ah/kr/qg/ahkrqgjij-tfce_455jhjikjfg8.jpeg"><br><br>  Eine Funktion zum Schreiben von Daten in die ClickHouse-Datenbank ist das seltene (einmal pro Sekunde) Einf√ºgen von Datens√§tzen in gro√üen Stapeln.  Dies ist anscheinend der ‚Äûproblematischste‚Äú Teil, auf den Sie sto√üen, wenn Sie zum ersten Mal mit der ClickHouse-Datenbank arbeiten: Das Schema ist etwas kompliziert. <br>  Das LogStash-Plugin hat hier sehr geholfen, da es Daten direkt in ClickHouse einf√ºgt.  Diese Komponente wird auf demselben Server wie die Datenbank selbst bereitgestellt.  Im Allgemeinen wird daher nicht empfohlen, dies zu tun, sondern aus praktischer Sicht, um keine separaten Server zu erstellen, w√§hrend diese auf demselben Server bereitgestellt werden.  Wir haben keine Fehler oder Ressourcenkonflikte mit der Datenbank festgestellt.  Zus√§tzlich sollte beachtet werden, dass das Plugin im Fehlerfall einen Retray-Mechanismus hat.  Und im Fehlerfall schreibt das Plugin ein Datenpaket auf die Festplatte, das nicht eingef√ºgt werden konnte (das Dateiformat ist praktisch: Nach der Bearbeitung k√∂nnen Sie das korrigierte Paket einfach mit dem Clickhouse-Client einf√ºgen). <br><br>  Die vollst√§ndige Liste der im Schema verwendeten Software ist in der Tabelle dargestellt: <br><br><div class="spoiler">  <b class="spoiler_title">Liste der verwendeten Software</b> <div class="spoiler_text"><div class="scrollable-table"><table><tbody><tr><td>  <b>Titel</b> <br></td><td>  <b>Beschreibung</b> <br></td><td>  <b>Verteilungslink</b> <br></td></tr><tr><td><p>  Nginx </p><br></td><td><p>  Reverse-Proxy, um den Portzugriff und die Autorisierung einzuschr√§nken </p><br><br><p>  Wird derzeit nicht in der Schaltung verwendet. </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://nginx.org/en/download.html</a> </p><br></td><td><p>  <a href="">https://nginx.org/download/nginx-1.16.0.tar.gz</a> </p><br></td></tr><tr><td><p>  Filebeat </p><br></td><td><p>  Dateiprotokolle √ºbertragen. </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://www.elastic.co/downloads/beats/filebeat</a> (Distribution f√ºr Windows 64bit). </p><br></td><td><p>  <a href="">https://artifacts.elastic.co/downloads/beats/filebeat/filebeat-7.3.0-windows-x86_64.zip</a> </p><br></td></tr><tr><td><p>  Logstash </p><br></td><td><p>  Protokollsammler. </p><br><br><p>  Wird zum Sammeln von Protokollen aus FileBeat sowie zum Sammeln von Protokollen aus der RabbitMQ-Warteschlange (f√ºr Server in der DMZ) verwendet. </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://www.elastic.co/products/logstash</a> </p><br></td><td><p>  <a href="">https://artifacts.elastic.co/downloads/logstash/logstash-7.0.1.rpm</a> </p><br></td></tr><tr><td><p>  Logstash-Ausgabe-Clickhouse </p><br></td><td><p>  Loagstash-Plugin zum stapelweisen √úbertragen von Protokollen in die ClickHouse-Datenbank </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://github.com/mikechris/logstash-output-clickhouse</a> </p><br></td><td><p>  / usr / share / logstash / bin / logstash-plugin installiere logstash-output-clickhouse </p><br><p>  / usr / share / logstash / bin / logstash-plugin installiere logstash-filter-prune </p><br><p>  / usr / share / logstash / bin / logstash-plugin installiere logstash-filter-multiline </p><br></td></tr><tr><td><p>  Clickhouse </p><br></td><td><p>  Protokoll-Repository <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://clickhouse.yandex/docs/ru/</a> </p><br></td><td><p>  <a href="">https://packagecloud.io/Altinity/clickhouse/packages/el/7/clickhouse-server-19.5.3.8-1.el7.x86_64.rpm</a> </p><br><p>  <a href="">https://packagecloud.io/Altinity/clickhouse/packages/el/7/clickhouse-client-19.5.3.8-1.el7.x86_64.rpm</a> </p><br><p>  Hinweis  Seit August 2018 werden die ‚Äûnormalen‚Äú RPM-Baugruppen f√ºr RHEL im Yandex-Repository angezeigt, sodass Sie versuchen k√∂nnen, sie zu verwenden.  Zum Zeitpunkt der Installation haben wir von Altinity kompilierte Pakete verwendet. </p><br></td></tr><tr><td><p>  Grafana </p><br></td><td><p>  Protokollvisualisierung.  Konfigurieren Sie Dashboards </p><br><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://grafana.com/</a> </p><br></td><td><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://grafana.com/grafana/download</a> </p><br><br><p>  Redhat &amp; Centos (64 Bit) - Neueste Version </p><br></td></tr><tr><td><p>  ClickHouse-Datenquelle f√ºr Grafana 4.6+ </p><br></td><td><p>  Grafana-Plugin mit ClickHouse-Datenquelle </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://grafana.com/plugins/vertamedia-clickhouse-datasource</a> </p><br></td><td><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://grafana.com/api/plugins/vertamedia-clickhouse-datasource/versions/1.8.1/download</a> </p><br></td></tr><tr><td><p>  Logstash </p><br></td><td><p>  Protokollieren Sie den Router von FileBeat in der RabbitMQ-Warteschlange. </p><br><p>  Hinweis  Leider hat FileBeat keine Ausgabe direkt in RabbitMQ, so dass ein Zwischenlink in Form von Logstash erforderlich ist </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://www.elastic.co/products/logstash</a> </p><br></td><td><p>  <a href="">https://artifacts.elastic.co/downloads/logstash/logstash-7.0.1.rpm</a> </p><br></td></tr><tr><td><p>  Rabbitmq </p><br></td><td><p>  Nachrichtenwarteschlange  Dies ist ein Protokolleintragspuffer in der DMZ </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://www.rabbitmq.com/download.html</a> </p><br></td><td><p>  <a href="">https://github.com/rabbitmq/rabbitmq-server/releases/download/v3.7.14/rabbitmq-server-3.7.14-1.el7.noarch.rpm</a> </p><br></td></tr><tr><td><p>  Erlang Runtime (Erforderlich f√ºr RabbitMQ) </p><br></td><td><p>  Erlang Laufzeit.  Erforderlich, damit RabbitMQ funktioniert </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">http://www.erlang.org/download.html</a> </p><br></td><td><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://www.rabbitmq.com/install-rpm.html#install-erlang</a> <a href="">http://www.erlang.org/downloads/21.3</a> </p><br></td></tr></tbody></table></div><br></div></div><br>  Die Serverkonfiguration mit der ClickHouse-Datenbank ist in der folgenden Tabelle dargestellt: <br><div class="scrollable-table"><table><tbody><tr><td>  <b>Titel</b> <br></td><td>  <b>Wert</b> <br></td><td>  <b>Hinweis</b> <br></td></tr><tr><td><p>  Konfiguration </p><br></td><td><p>  Festplatte: 40 GB <br>  RAM: 8 GB <br>  Prozessor: Core 2 2 GHz </p><br></td><td><p>  Beachten Sie die Tipps zum Betrieb der ClickHouse-Datenbank ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://clickhouse.yandex/docs/ru/operations/tips/</a> ). </p><br></td></tr><tr><td><p>  Systemweite Software </p><br></td><td><p>  Betriebssystem: Red Hat Enterprise Linux Server (Maipo) </p><br><p>  JRE (Java 8) </p><br></td><td><p></p><br></td></tr></tbody></table></div><br>  Wie Sie sehen k√∂nnen, ist dies eine normale Workstation. <br><br>  Die Tabelle zum Speichern von Protokollen ist wie folgt aufgebaut: <br><br><div class="spoiler">  <b class="spoiler_title">log_web.sql</b> <div class="spoiler_text"><pre><code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> log_web ( logdate <span class="hljs-built_in"><span class="hljs-built_in">Date</span></span>, logdatetime DateTime CODEC(Delta, LZ4HC), fld_log_file_name LowCardinality( <span class="hljs-keyword"><span class="hljs-keyword">String</span></span> ), fld_server_name LowCardinality( <span class="hljs-keyword"><span class="hljs-keyword">String</span></span> ), fld_app_name LowCardinality( <span class="hljs-keyword"><span class="hljs-keyword">String</span></span> ), fld_app_module LowCardinality( <span class="hljs-keyword"><span class="hljs-keyword">String</span></span> ), fld_website_name LowCardinality( <span class="hljs-keyword"><span class="hljs-keyword">String</span></span> ), serverIP LowCardinality( <span class="hljs-keyword"><span class="hljs-keyword">String</span></span> ), method LowCardinality( <span class="hljs-keyword"><span class="hljs-keyword">String</span></span> ), uriStem <span class="hljs-keyword"><span class="hljs-keyword">String</span></span>, uriQuery <span class="hljs-keyword"><span class="hljs-keyword">String</span></span>, port UInt32, username LowCardinality( <span class="hljs-keyword"><span class="hljs-keyword">String</span></span> ), clientIP <span class="hljs-keyword"><span class="hljs-keyword">String</span></span>, clientRealIP <span class="hljs-keyword"><span class="hljs-keyword">String</span></span>, userAgent <span class="hljs-keyword"><span class="hljs-keyword">String</span></span>, referer <span class="hljs-keyword"><span class="hljs-keyword">String</span></span>, response <span class="hljs-keyword"><span class="hljs-keyword">String</span></span>, subresponse <span class="hljs-keyword"><span class="hljs-keyword">String</span></span>, win32response <span class="hljs-keyword"><span class="hljs-keyword">String</span></span>, timetaken UInt64 , uriQuery__utm_medium <span class="hljs-keyword"><span class="hljs-keyword">String</span></span> , uriQuery__utm_source <span class="hljs-keyword"><span class="hljs-keyword">String</span></span> , uriQuery__utm_campaign <span class="hljs-keyword"><span class="hljs-keyword">String</span></span> , uriQuery__utm_term <span class="hljs-keyword"><span class="hljs-keyword">String</span></span> , uriQuery__utm_content <span class="hljs-keyword"><span class="hljs-keyword">String</span></span> , uriQuery__yclid <span class="hljs-keyword"><span class="hljs-keyword">String</span></span> , uriQuery__region <span class="hljs-keyword"><span class="hljs-keyword">String</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">Engine</span></span> = MergeTree() <span class="hljs-keyword"><span class="hljs-keyword">PARTITION</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> toYYYYMM(logdate) <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> (fld_app_name, fld_app_module, logdatetime) <span class="hljs-keyword"><span class="hljs-keyword">SETTINGS</span></span> index_granularity = <span class="hljs-number"><span class="hljs-number">8192</span></span>;</code> </pre> <br></div></div><br>  Wir verwenden Standardwerte f√ºr die Partitionierung (nach Monaten) und die Granularit√§t des Index.  Alle Felder entsprechen praktisch IIS-Protokolleintr√§gen zum Registrieren von http-Anforderungen.  Separate separate Felder zum Speichern von utm-Tags (sie werden beim Einf√ºgen in die Tabelle aus dem Feld f√ºr die Abfragezeichenfolge analysiert). <br><br>  Au√üerdem werden in der Tabelle mehrere Systemfelder zum Speichern von Informationen zu Systemen, Komponenten und Servern hinzugef√ºgt.  In der folgenden Tabelle finden Sie eine Beschreibung dieser Felder.  In einer Tabelle speichern wir Protokolle f√ºr mehrere Systeme. <br><br><div class="scrollable-table"><table><tbody><tr><td>  <b>Titel</b> <br></td><td>  <b>Beschreibung</b> <br></td><td>  <b>Beispiel</b> <br></td></tr><tr><td><p>  fld_app_name </p><br></td><td><p>  Anwendungs- / Systemname <br>  G√ºltige Werte: </p><br><ul><li>  site1.domain.com Externe Site 1 </li><li>  site2.domain.com Externe Site 2 </li><li>  internal-site1.domain.local Interne Site 1 </li></ul><br></td><td>  site1.domain.com <br></td></tr><tr><td><p>  fld_app_module </p><br></td><td><p>  Systemmodul <br>  G√ºltige Werte: </p><br><ul><li>  Web - Website </li><li>  svc - Website-Service </li><li>  intgr - Web Integration Service </li><li>  bo - Admin (BackOffice) </li></ul><br></td><td><p>  Web </p><br></td></tr><tr><td><p>  fld_website_name </p><br></td><td><p>  Name der Website in IIS </p><br><p>  Auf einem Server k√∂nnen mehrere Systeme oder sogar mehrere Instanzen eines Systemmoduls bereitgestellt werden </p><br></td><td><p>  Web-Main </p><br></td></tr><tr><td><p>  fld_server_name </p><br></td><td><p>  Servername </p><br></td><td><p>  web1.domain.com </p><br></td></tr><tr><td><p>  fld_log_file_name </p><br></td><td><p>  Der Pfad zur Protokolldatei auf dem Server </p><br></td><td>  C: \ inetpub \ logs \ LogFiles <br>  \ W3SVC1 \ u_ex190711.log <br></td></tr></tbody></table></div><br>  Auf diese Weise k√∂nnen Sie Grafiken in Grafana effektiv erstellen.  Zeigen Sie beispielsweise Anforderungen vom Frontend eines bestimmten Systems an.  Dies √§hnelt dem Site-Z√§hler in Yandex.Metrica. <br><br>  Hier finden Sie einige Statistiken zur Nutzung der Datenbank f√ºr zwei Monate. <br><br><div class="spoiler">  <b class="spoiler_title">Anzahl der Datens√§tze nach System und Komponente</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> fld_app_name, fld_app_module, <span class="hljs-keyword"><span class="hljs-keyword">count</span></span>(fld_app_name) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> rows_count <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> log_web <span class="hljs-keyword"><span class="hljs-keyword">GROUP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> fld_app_name, fld_app_module <span class="hljs-keyword"><span class="hljs-keyword">WITH</span></span> TOTALS <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> fld_app_name <span class="hljs-keyword"><span class="hljs-keyword">ASC</span></span>, rows_count <span class="hljs-keyword"><span class="hljs-keyword">DESC</span></span> ‚îå‚îÄfld_app_name‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄfld_app_module‚îÄ‚î¨‚îÄrows_count‚îÄ‚îê ‚îÇ site1.domain.ru ‚îÇ web ‚îÇ <span class="hljs-number"><span class="hljs-number">131441</span></span> ‚îÇ ‚îÇ site2.domain.ru ‚îÇ web ‚îÇ <span class="hljs-number"><span class="hljs-number">1751081</span></span> ‚îÇ ‚îÇ site3.domain.ru ‚îÇ web ‚îÇ <span class="hljs-number"><span class="hljs-number">106887543</span></span> ‚îÇ ‚îÇ site3.domain.ru ‚îÇ svc ‚îÇ <span class="hljs-number"><span class="hljs-number">44908603</span></span> ‚îÇ ‚îÇ site3.domain.ru ‚îÇ intgr ‚îÇ <span class="hljs-number"><span class="hljs-number">9813911</span></span> ‚îÇ ‚îÇ site4.domain.ru ‚îÇ web ‚îÇ <span class="hljs-number"><span class="hljs-number">772095</span></span> ‚îÇ ‚îÇ site5.domain.ru ‚îÇ web ‚îÇ <span class="hljs-number"><span class="hljs-number">17037221</span></span> ‚îÇ ‚îÇ site5.domain.ru ‚îÇ intgr ‚îÇ <span class="hljs-number"><span class="hljs-number">838559</span></span> ‚îÇ ‚îÇ site5.domain.ru ‚îÇ bo ‚îÇ <span class="hljs-number"><span class="hljs-number">7404</span></span> ‚îÇ ‚îÇ site6.domain.ru ‚îÇ web ‚îÇ <span class="hljs-number"><span class="hljs-number">595877</span></span> ‚îÇ ‚îÇ site7.domain.ru ‚îÇ web ‚îÇ <span class="hljs-number"><span class="hljs-number">27778858</span></span> ‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò Totals: ‚îå‚îÄfld_app_name‚îÄ‚î¨‚îÄfld_app_module‚îÄ‚î¨‚îÄrows_count‚îÄ‚îê ‚îÇ ‚îÇ ‚îÇ <span class="hljs-number"><span class="hljs-number">210522593</span></span> ‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò <span class="hljs-number"><span class="hljs-number">11</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> set. Elapsed: <span class="hljs-number"><span class="hljs-number">4.874</span></span> sec. Processed <span class="hljs-number"><span class="hljs-number">210.52</span></span> million <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>, <span class="hljs-number"><span class="hljs-number">421.67</span></span> MB (<span class="hljs-number"><span class="hljs-number">43.19</span></span> million <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>/s., <span class="hljs-number"><span class="hljs-number">86.51</span></span> MB/s.)</code> </pre> <br></div></div><div class="spoiler">  <b class="spoiler_title">Die Datenmenge auf der Festplatte</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> formatReadableSize(<span class="hljs-keyword"><span class="hljs-keyword">sum</span></span>(data_uncompressed_bytes)) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> uncompressed, formatReadableSize(<span class="hljs-keyword"><span class="hljs-keyword">sum</span></span>(data_compressed_bytes)) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> compressed, <span class="hljs-keyword"><span class="hljs-keyword">sum</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> total_rows <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> system.parts <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> = <span class="hljs-string"><span class="hljs-string">'log_web'</span></span> ‚îå‚îÄuncompressed‚îÄ‚î¨‚îÄcompressed‚îÄ‚î¨‚îÄtotal_rows‚îÄ‚îê ‚îÇ <span class="hljs-number"><span class="hljs-number">54.50</span></span> GiB ‚îÇ <span class="hljs-number"><span class="hljs-number">4.86</span></span> GiB ‚îÇ <span class="hljs-number"><span class="hljs-number">211427094</span></span> ‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> set. Elapsed: <span class="hljs-number"><span class="hljs-number">0.035</span></span> sec.</code> </pre> <br></div></div><div class="spoiler">  <b class="spoiler_title">Der Grad der Datenkomprimierung in Spalten</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">name</span></span>, formatReadableSize(data_uncompressed_bytes) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> uncompressed, formatReadableSize(data_compressed_bytes) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> compressed, data_uncompressed_bytes / data_compressed_bytes <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> compress_ratio <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> system.columns <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> = <span class="hljs-string"><span class="hljs-string">'log_web'</span></span> ‚îå‚îÄ<span class="hljs-keyword"><span class="hljs-keyword">name</span></span>‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄuncompressed‚îÄ‚î¨‚îÄcompressed‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄcompress_ratio‚îÄ‚îê ‚îÇ logdate ‚îÇ <span class="hljs-number"><span class="hljs-number">401.53</span></span> MiB ‚îÇ <span class="hljs-number"><span class="hljs-number">1.80</span></span> MiB ‚îÇ <span class="hljs-number"><span class="hljs-number">223.16665968777315</span></span> ‚îÇ ‚îÇ logdatetime ‚îÇ <span class="hljs-number"><span class="hljs-number">803.06</span></span> MiB ‚îÇ <span class="hljs-number"><span class="hljs-number">35.91</span></span> MiB ‚îÇ <span class="hljs-number"><span class="hljs-number">22.363966401202305</span></span> ‚îÇ ‚îÇ fld_log_file_name ‚îÇ <span class="hljs-number"><span class="hljs-number">220.66</span></span> MiB ‚îÇ <span class="hljs-number"><span class="hljs-number">2.60</span></span> MiB ‚îÇ <span class="hljs-number"><span class="hljs-number">84.99905736932571</span></span> ‚îÇ ‚îÇ fld_server_name ‚îÇ <span class="hljs-number"><span class="hljs-number">201.54</span></span> MiB ‚îÇ <span class="hljs-number"><span class="hljs-number">50.63</span></span> MiB ‚îÇ <span class="hljs-number"><span class="hljs-number">3.980924816977078</span></span> ‚îÇ ‚îÇ fld_app_name ‚îÇ <span class="hljs-number"><span class="hljs-number">201.17</span></span> MiB ‚îÇ <span class="hljs-number"><span class="hljs-number">969.17</span></span> KiB ‚îÇ <span class="hljs-number"><span class="hljs-number">212.55518183686877</span></span> ‚îÇ ‚îÇ fld_app_module ‚îÇ <span class="hljs-number"><span class="hljs-number">201.17</span></span> MiB ‚îÇ <span class="hljs-number"><span class="hljs-number">968.60</span></span> KiB ‚îÇ <span class="hljs-number"><span class="hljs-number">212.67805817411906</span></span> ‚îÇ ‚îÇ fld_website_name ‚îÇ <span class="hljs-number"><span class="hljs-number">201.54</span></span> MiB ‚îÇ <span class="hljs-number"><span class="hljs-number">1.24</span></span> MiB ‚îÇ <span class="hljs-number"><span class="hljs-number">162.7204926761546</span></span> ‚îÇ ‚îÇ serverIP ‚îÇ <span class="hljs-number"><span class="hljs-number">201.54</span></span> MiB ‚îÇ <span class="hljs-number"><span class="hljs-number">50.25</span></span> MiB ‚îÇ <span class="hljs-number"><span class="hljs-number">4.010824061219731</span></span> ‚îÇ ‚îÇ method ‚îÇ <span class="hljs-number"><span class="hljs-number">201.53</span></span> MiB ‚îÇ <span class="hljs-number"><span class="hljs-number">43.64</span></span> MiB ‚îÇ <span class="hljs-number"><span class="hljs-number">4.617721053304486</span></span> ‚îÇ ‚îÇ uriStem ‚îÇ <span class="hljs-number"><span class="hljs-number">5.13</span></span> GiB ‚îÇ <span class="hljs-number"><span class="hljs-number">832.51</span></span> MiB ‚îÇ <span class="hljs-number"><span class="hljs-number">6.311522291936919</span></span> ‚îÇ ‚îÇ uriQuery ‚îÇ <span class="hljs-number"><span class="hljs-number">2.58</span></span> GiB ‚îÇ <span class="hljs-number"><span class="hljs-number">501.06</span></span> MiB ‚îÇ <span class="hljs-number"><span class="hljs-number">5.269731450124478</span></span> ‚îÇ ‚îÇ port ‚îÇ <span class="hljs-number"><span class="hljs-number">803.06</span></span> MiB ‚îÇ <span class="hljs-number"><span class="hljs-number">3.98</span></span> MiB ‚îÇ <span class="hljs-number"><span class="hljs-number">201.91673864241824</span></span> ‚îÇ ‚îÇ username ‚îÇ <span class="hljs-number"><span class="hljs-number">318.08</span></span> MiB ‚îÇ <span class="hljs-number"><span class="hljs-number">26.93</span></span> MiB ‚îÇ <span class="hljs-number"><span class="hljs-number">11.812513794583598</span></span> ‚îÇ ‚îÇ clientIP ‚îÇ <span class="hljs-number"><span class="hljs-number">2.35</span></span> GiB ‚îÇ <span class="hljs-number"><span class="hljs-number">82.59</span></span> MiB ‚îÇ <span class="hljs-number"><span class="hljs-number">29.132328640073343</span></span> ‚îÇ ‚îÇ clientRealIP ‚îÇ <span class="hljs-number"><span class="hljs-number">2.49</span></span> GiB ‚îÇ <span class="hljs-number"><span class="hljs-number">465.05</span></span> MiB ‚îÇ <span class="hljs-number"><span class="hljs-number">5.478382297052563</span></span> ‚îÇ ‚îÇ userAgent ‚îÇ <span class="hljs-number"><span class="hljs-number">18.34</span></span> GiB ‚îÇ <span class="hljs-number"><span class="hljs-number">764.08</span></span> MiB ‚îÇ <span class="hljs-number"><span class="hljs-number">24.57905114484208</span></span> ‚îÇ ‚îÇ referer ‚îÇ <span class="hljs-number"><span class="hljs-number">14.71</span></span> GiB ‚îÇ <span class="hljs-number"><span class="hljs-number">1.37</span></span> GiB ‚îÇ <span class="hljs-number"><span class="hljs-number">10.736792723669906</span></span> ‚îÇ ‚îÇ response ‚îÇ <span class="hljs-number"><span class="hljs-number">803.06</span></span> MiB ‚îÇ <span class="hljs-number"><span class="hljs-number">83.81</span></span> MiB ‚îÇ <span class="hljs-number"><span class="hljs-number">9.582334090987247</span></span> ‚îÇ ‚îÇ subresponse ‚îÇ <span class="hljs-number"><span class="hljs-number">399.87</span></span> MiB ‚îÇ <span class="hljs-number"><span class="hljs-number">1.83</span></span> MiB ‚îÇ <span class="hljs-number"><span class="hljs-number">218.4831068635027</span></span> ‚îÇ ‚îÇ win32response ‚îÇ <span class="hljs-number"><span class="hljs-number">407.86</span></span> MiB ‚îÇ <span class="hljs-number"><span class="hljs-number">7.41</span></span> MiB ‚îÇ <span class="hljs-number"><span class="hljs-number">55.050315514606815</span></span> ‚îÇ ‚îÇ timetaken ‚îÇ <span class="hljs-number"><span class="hljs-number">1.57</span></span> GiB ‚îÇ <span class="hljs-number"><span class="hljs-number">402.06</span></span> MiB ‚îÇ <span class="hljs-number"><span class="hljs-number">3.9947395692010637</span></span> ‚îÇ ‚îÇ uriQuery__utm_medium ‚îÇ <span class="hljs-number"><span class="hljs-number">208.17</span></span> MiB ‚îÇ <span class="hljs-number"><span class="hljs-number">12.29</span></span> MiB ‚îÇ <span class="hljs-number"><span class="hljs-number">16.936148912472955</span></span> ‚îÇ ‚îÇ uriQuery__utm_source ‚îÇ <span class="hljs-number"><span class="hljs-number">215.18</span></span> MiB ‚îÇ <span class="hljs-number"><span class="hljs-number">13.00</span></span> MiB ‚îÇ <span class="hljs-number"><span class="hljs-number">16.548367623199912</span></span> ‚îÇ ‚îÇ uriQuery__utm_campaign ‚îÇ <span class="hljs-number"><span class="hljs-number">381.46</span></span> MiB ‚îÇ <span class="hljs-number"><span class="hljs-number">37.94</span></span> MiB ‚îÇ <span class="hljs-number"><span class="hljs-number">10.055156353418509</span></span> ‚îÇ ‚îÇ uriQuery__utm_term ‚îÇ <span class="hljs-number"><span class="hljs-number">231.82</span></span> MiB ‚îÇ <span class="hljs-number"><span class="hljs-number">10.78</span></span> MiB ‚îÇ <span class="hljs-number"><span class="hljs-number">21.502540454070672</span></span> ‚îÇ ‚îÇ uriQuery__utm_content ‚îÇ <span class="hljs-number"><span class="hljs-number">441.34</span></span> MiB ‚îÇ <span class="hljs-number"><span class="hljs-number">87.60</span></span> MiB ‚îÇ <span class="hljs-number"><span class="hljs-number">5.038260760449327</span></span> ‚îÇ ‚îÇ uriQuery__yclid ‚îÇ <span class="hljs-number"><span class="hljs-number">216.88</span></span> MiB ‚îÇ <span class="hljs-number"><span class="hljs-number">16.58</span></span> MiB ‚îÇ <span class="hljs-number"><span class="hljs-number">13.07721335008116</span></span> ‚îÇ ‚îÇ uriQuery__region ‚îÇ <span class="hljs-number"><span class="hljs-number">204.35</span></span> MiB ‚îÇ <span class="hljs-number"><span class="hljs-number">9.49</span></span> MiB ‚îÇ <span class="hljs-number"><span class="hljs-number">21.52661903446796</span></span> ‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò <span class="hljs-number"><span class="hljs-number">28</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> set. Elapsed: <span class="hljs-number"><span class="hljs-number">0.005</span></span> sec.</code> </pre> <br></div></div><br><h4>  Beschreibung der verwendeten Komponenten <br><br>  FileBeat.  Datei Protokoll√ºbertragung </h4><br>  Diese Komponente √ºberwacht √Ñnderungen in den Protokolldateien auf der Festplatte und √ºbertr√§gt Informationen an LogStash.  Es wird auf allen Servern installiert, auf denen Protokolldateien geschrieben werden (normalerweise IIS).  Es funktioniert im Endmodus (d. H. √úbertr√§gt nur hinzugef√ºgte Datens√§tze in eine Datei).  Sie k√∂nnen jedoch separat die gesamte Datei√ºbertragung konfigurieren.  Dies ist n√ºtzlich, wenn Sie Daten aus fr√ºheren Monaten herunterladen m√ºssen.  Legen Sie einfach die Protokolldatei in einen Ordner und er wird sie vollst√§ndig lesen. <br><br>  Wenn der Dienst beendet wird, werden die Daten nicht mehr weiter in den Speicher √ºbertragen. <br><br>  Eine Beispielkonfiguration lautet wie folgt: <br><br><div class="spoiler">  <b class="spoiler_title">filebeat.yml</b> <div class="spoiler_text"><pre> <code class="sql hljs">filebeat.inputs: - type: log enabled: true paths: - C:/inetpub/logs/LogFiles/W3SVC1<span class="hljs-comment"><span class="hljs-comment">/*.log exclude_files: ['.gz$','.zip$'] tail_files: true ignore_older: 24h fields: fld_server_name: "site1.domain.ru" fld_app_name: "site1.domain.ru" fld_app_module: "web" fld_website_name: "web-main" - type: log enabled: true paths: - C:/inetpub/logs/LogFiles/__Import/access_log-* exclude_files: ['.gz$','.zip$'] tail_files: false fields: fld_server_name: "site2.domain.ru" fld_app_name: "site2.domain.ru" fld_app_module: "web" fld_website_name: "web-main" fld_logformat: "logformat__apache" filebeat.config.modules: path: ${path.config}/modules.d/*.yml reload.enabled: false reload.period: 2s output.logstash: hosts: ["log.domain.com:5044"] ssl.enabled: true ssl.certificate_authorities: ["C:/filebeat/certs/ca.pem", "C:/filebeat/certs/ca-issuing.pem"] ssl.certificate: "C:/filebeat/certs/site1.domain.ru.cer" ssl.key: "C:/filebeat/certs/site1.domain.ru.key" #================================ Processors ===================================== processors: - add_host_metadata: ~ - add_cloud_metadata: ~</span></span></code> </pre> <br></div></div><br><h4>  LogStash  Protokollsammler </h4><br>  Diese Komponente dient zum Empfangen von Protokolleintr√§gen von FileBeat (oder √ºber die RabbitMQ-Warteschlange), zum Parsen und Einf√ºgen von Bundles in die ClickHouse-Datenbank. <br><br>  Zum Einf√ºgen in ClickHouse wird das Plugin Logstash-output-clickhouse verwendet.  Das Logstash-Plugin verf√ºgt √ºber einen Mechanismus zum Abrufen von Anforderungen. Bei einem regelm√§√üigen Herunterfahren ist es jedoch besser, den Dienst selbst zu stoppen.  Wenn Sie anhalten, sammeln sich Nachrichten in der RabbitMQ-Warteschlange an. Wenn Sie also l√§ngere Zeit anhalten, ist es besser, Filebeats auf Servern zu stoppen.  In einem Schema, in dem RabbitMQ nicht verwendet wird (im lokalen Netzwerk sendet Filebeat Protokolle direkt an Logstash), funktionieren Filebeats recht akzeptabel und sicher, sodass f√ºr sie die Unzug√§nglichkeit der Ausgabe keine Konsequenzen hat. <br><br>  Eine Beispielkonfiguration lautet wie folgt: <br><br><div class="spoiler">  <b class="spoiler_title">log_web__filebeat_clickhouse.conf</b> <div class="spoiler_text"><pre> <code class="sql hljs">input { beats { port =&gt; 5044 type =&gt; 'iis' ssl =&gt; true ssl_certificate_authorities =&gt; ["/etc/logstash/certs/ca.cer", "/etc/logstash/certs/ca-issuing.cer"] ssl_certificate =&gt; "/etc/logstash/certs/server.cer" ssl_key =&gt; "/etc/logstash/certs/server-pkcs8.key" ssl_verify_mode =&gt; "peer" add_field =&gt; { "fld_server_name" =&gt; "%{[fields][fld_server_name]}" "fld_app_name" =&gt; "%{[fields][fld_app_name]}" "fld_app_module" =&gt; "%{[fields][fld_app_module]}" "fld_website_name" =&gt; "%{[fields][fld_website_name]}" "fld_log_file_name" =&gt; "%{source}" "fld_logformat" =&gt; "%{[fields][fld_logformat]}" } } rabbitmq { host =&gt; "queue.domain.com" port =&gt; 5671 user =&gt; "q-reader" password =&gt; "password" queue =&gt; "web_log" heartbeat =&gt; 30 durable =&gt; true ssl =&gt; true <span class="hljs-comment"><span class="hljs-comment">#ssl_certificate_path =&gt; "/etc/logstash/certs/server.p12" #ssl_certificate_password =&gt; "password" add_field =&gt; { "fld_server_name" =&gt; "%{[fields][fld_server_name]}" "fld_app_name" =&gt; "%{[fields][fld_app_name]}" "fld_app_module" =&gt; "%{[fields][fld_app_module]}" "fld_website_name" =&gt; "%{[fields][fld_website_name]}" "fld_log_file_name" =&gt; "%{source}" "fld_logformat" =&gt; "%{[fields][fld_logformat]}" } } } filter { if [message] =~ "^#" { drop {} } if [fld_logformat] == "logformat__iis_with_xrealip" { grok { match =&gt; ["message", "%{TIMESTAMP_ISO8601:log_timestamp} %{IP:serverIP} %{WORD:method} %{NOTSPACE:uriStem} %{NOTSPACE:uriQuery} %{NUMBER:port} %{NOTSPACE:username} %{IPORHOST:clientIP} %{NOTSPACE:userAgent} %{NOTSPACE:referer} %{NUMBER:response} %{NUMBER:subresponse} %{NUMBER:win32response} %{NUMBER:timetaken} %{NOTSPACE:xrealIP} %{NOTSPACE:xforwarderfor}"] } } else { grok { match =&gt; ["message", "%{TIMESTAMP_ISO8601:log_timestamp} %{IP:serverIP} %{WORD:method} %{NOTSPACE:uriStem} %{NOTSPACE:uriQuery} %{NUMBER:port} %{NOTSPACE:username} %{IPORHOST:clientIP} %{NOTSPACE:userAgent} %{NOTSPACE:referer} %{NUMBER:response} %{NUMBER:subresponse} %{NUMBER:win32response} %{NUMBER:timetaken}"] } } date { match =&gt; [ "log_timestamp", "YYYY-MM-dd HH:mm:ss" ] timezone =&gt; "Etc/UTC" remove_field =&gt; [ "log_timestamp", "@timestamp" ] target =&gt; [ "log_timestamp2" ] } ruby { code =&gt; "tstamp = event.get('log_timestamp2').to_i event.set('logdatetime', Time.at(tstamp).strftime('%Y-%m-%d %H:%M:%S')) event.set('logdate', Time.at(tstamp).strftime('%Y-%m-%d'))" } if [bytesSent] { ruby { code =&gt; "event['kilobytesSent'] = event['bytesSent'].to_i / 1024.0" } } if [bytesReceived] { ruby { code =&gt; "event['kilobytesReceived'] = event['bytesReceived'].to_i / 1024.0" } } ruby { code =&gt; "event.set('clientRealIP', event.get('clientIP'))" } if [xrealIP] { ruby { code =&gt; "event.set('clientRealIP', event.get('xrealIP'))" } } if [xforwarderfor] { ruby { code =&gt; "event.set('clientRealIP', event.get('xforwarderfor'))" } } mutate { convert =&gt; ["bytesSent", "integer"] convert =&gt; ["bytesReceived", "integer"] convert =&gt; ["timetaken", "integer"] convert =&gt; ["port", "integer"] add_field =&gt; { "clientHostname" =&gt; "%{clientIP}" } } useragent { source=&gt; "useragent" prefix=&gt; "browser" } kv { source =&gt; "uriQuery" prefix =&gt; "uriQuery__" allow_duplicate_values =&gt; false field_split =&gt; "&amp;" include_keys =&gt; [ "utm_medium", "utm_source", "utm_campaign", "utm_term", "utm_content", "yclid", "region" ] } mutate { join =&gt; { "uriQuery__utm_source" =&gt; "," } join =&gt; { "uriQuery__utm_medium" =&gt; "," } join =&gt; { "uriQuery__utm_campaign" =&gt; "," } join =&gt; { "uriQuery__utm_term" =&gt; "," } join =&gt; { "uriQuery__utm_content" =&gt; "," } join =&gt; { "uriQuery__yclid" =&gt; "," } join =&gt; { "uriQuery__region" =&gt; "," } } } output { #stdout {codec =&gt; rubydebug} clickhouse { headers =&gt; ["Authorization", "Basic abcdsfks..."] http_hosts =&gt; ["http://127.0.0.1:8123"] save_dir =&gt; "/etc/logstash/tmp" table =&gt; "log_web" request_tolerance =&gt; 1 flush_size =&gt; 10000 idle_flush_time =&gt; 1 mutations =&gt; { "fld_log_file_name" =&gt; "fld_log_file_name" "fld_server_name" =&gt; "fld_server_name" "fld_app_name" =&gt; "fld_app_name" "fld_app_module" =&gt; "fld_app_module" "fld_website_name" =&gt; "fld_website_name" "logdatetime" =&gt; "logdatetime" "logdate" =&gt; "logdate" "serverIP" =&gt; "serverIP" "method" =&gt; "method" "uriStem" =&gt; "uriStem" "uriQuery" =&gt; "uriQuery" "port" =&gt; "port" "username" =&gt; "username" "clientIP" =&gt; "clientIP" "clientRealIP" =&gt; "clientRealIP" "userAgent" =&gt; "userAgent" "referer" =&gt; "referer" "response" =&gt; "response" "subresponse" =&gt; "subresponse" "win32response" =&gt; "win32response" "timetaken" =&gt; "timetaken" "uriQuery__utm_medium" =&gt; "uriQuery__utm_medium" "uriQuery__utm_source" =&gt; "uriQuery__utm_source" "uriQuery__utm_campaign" =&gt; "uriQuery__utm_campaign" "uriQuery__utm_term" =&gt; "uriQuery__utm_term" "uriQuery__utm_content" =&gt; "uriQuery__utm_content" "uriQuery__yclid" =&gt; "uriQuery__yclid" "uriQuery__region" =&gt; "uriQuery__region" } } }</span></span></code> </pre> <br></div></div><div class="spoiler">  <b class="spoiler_title">pipelines.yml</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-comment"><span class="hljs-comment"># This file is where you define your pipelines. You can define multiple. # For more information on multiple pipelines, see the documentation: # https://www.elastic.co/guide/en/logstash/current/multiple-pipelines.html - pipeline.id: log_web__filebeat_clickhouse path.config: "/etc/logstash/log_web__filebeat_clickhouse.conf"</span></span></code> </pre> <br></div></div><br><h4>  ClickHouse.  Protokollspeicher </h4><br>  Protokolle f√ºr alle Systeme werden in einer Tabelle gespeichert (siehe Anfang des Artikels).  Es dient zum Speichern von Informationen zu Anforderungen: Alle Parameter sind f√ºr verschiedene Formate √§hnlich, z. B. IIS-Protokolle, Apache- und Nginx-Protokolle.  F√ºr Anwendungsprotokolle, in denen beispielsweise Fehler, Informationsmeldungen und Warnungen aufgezeichnet werden, wird eine separate Tabelle mit der entsprechenden Struktur bereitgestellt (jetzt in der Entwurfsphase). <br><br>  Beim Entwerfen einer Tabelle ist es sehr wichtig, den Prim√§rschl√ºssel zu bestimmen (nach dem die Daten w√§hrend der Speicherung sortiert werden).  Der Grad der Datenkomprimierung und die Abfragegeschwindigkeit h√§ngen davon ab.  In unserem Beispiel ist der Schl√ºssel <br>  ORDER BY (fld_app_name, fld_app_module, logdatetime) <br>  Das hei√üt, durch den Namen des Systems, den Namen der Systemkomponente und das Datum des Ereignisses.  Das urspr√ºngliche Datum der Veranstaltung stand an erster Stelle.  Nachdem es an den letzten Ort verschoben wurde, begannen die Abfragen etwa zweimal schneller zu arbeiten.  Zum √Ñndern des Prim√§rschl√ºssels m√ºssen Sie die Tabelle neu erstellen und die Daten neu laden, damit ClickHouse die Daten auf der Festplatte neu sortiert.  Dies ist eine schwierige Operation, daher ist es ratsam, im Voraus zu √ºberlegen, was im Sortierschl√ºssel enthalten sein soll. <br><br>  Es sollte auch beachtet werden, dass relativ in neueren Versionen der Datentyp LowCardinality aufgetreten ist.  Bei Verwendung wird die Gr√∂√üe der komprimierten Daten f√ºr Felder mit geringer Kardinalit√§t (wenige Optionen) stark reduziert. <br><br>  Jetzt wird Version 19.6 verwendet, und wir planen, die Version auf den neuesten Stand zu bringen.  Dazu geh√∂rten beispielsweise wunderbare Funktionen wie Adaptive Granularity, √úberspringen von Indizes und der DoubleDelta-Codec. <br><br>  Standardm√§√üig wird die Protokollstufe der Ablaufverfolgung w√§hrend der Konfiguration festgelegt.  Protokolle werden gedreht und archiviert, aber auf ein Gigabyte erweitert.  Wenn dies nicht erforderlich ist, k√∂nnen Sie die Warnstufe festlegen. Die Gr√∂√üe des Protokolls nimmt dann stark ab.  Die Protokollierungseinstellungen werden in der Datei config.xml festgelegt: <br><br><pre> <code class="xml hljs"><span class="hljs-comment"><span class="hljs-comment">&lt;!-- Possible levels: https://github.com/pocoproject/poco/blob/develop/Foundation/include/Poco/Logger. h#L105 --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">level</span></span></span><span class="hljs-tag">&gt;</span></span>warning<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">level</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Einige n√ºtzliche Befehle</b> <div class="spoiler_text"><pre> <code class="sql hljs">      Debian,     Linux      Altinity.           : https://www.altinity.com/blog/2017/12/18/logstash-<span class="hljs-keyword"><span class="hljs-keyword">with</span></span>-clickhouse sudo yum <span class="hljs-keyword"><span class="hljs-keyword">search</span></span> clickhouse-<span class="hljs-keyword"><span class="hljs-keyword">server</span></span> sudo yum <span class="hljs-keyword"><span class="hljs-keyword">install</span></span> clickhouse-server.noarch <span class="hljs-number"><span class="hljs-number">1.</span></span>   sudo systemctl <span class="hljs-keyword"><span class="hljs-keyword">status</span></span> clickhouse-<span class="hljs-keyword"><span class="hljs-keyword">server</span></span> <span class="hljs-number"><span class="hljs-number">2.</span></span>   sudo systemctl <span class="hljs-keyword"><span class="hljs-keyword">stop</span></span> clickhouse-<span class="hljs-keyword"><span class="hljs-keyword">server</span></span> <span class="hljs-number"><span class="hljs-number">3.</span></span>   sudo systemctl <span class="hljs-keyword"><span class="hljs-keyword">start</span></span> clickhouse-<span class="hljs-keyword"><span class="hljs-keyword">server</span></span>        (   <span class="hljs-string"><span class="hljs-string">";"</span></span>) clickhouse-<span class="hljs-keyword"><span class="hljs-keyword">client</span></span> <span class="hljs-comment"><span class="hljs-comment">--multiline clickhouse-client --multiline --host 127.0.0.1 --password pa55w0rd clickhouse-client --multiline --host 127.0.0.1 --port 9440 --secure --user default --password pa55w0rd                /tmp/log_web_failed.json            : clickhouse-client --host 127.0.0.1 --password password --query="INSERT INTO log_web FORMAT JSONEachRow" &lt; /tmp/log_web_failed__fixed.json sudo mv /etc/logstash/tmp/log_web_failed.json /etc/logstash/tmp/log_web_failed__fixed.json sudo chown user_dev /etc/logstash/tmp/log_web_failed__fixed.json sudo clickhouse-client --host 127.0.0.1 --password password --query="INSERT INTO log_web FORMAT JSONEachRow" &lt; /etc/logstash/tmp/log_web_failed__fixed.json sudo mv /etc/logstash/tmp/log_web_failed__fixed.json /etc/logstash/tmp/log_web_failed__fixed_.json     quit; ##  TLS https://www.altinity.com/blog/2019/3/5/clickhouse-networking-part-2 openssl s_client -connect log.domain.com:9440 &lt; /dev/null</span></span></code> </pre> <br></div></div><br><h4>  LogStash  FileBeat-Protokollrouter zur RabbitMQ-Warteschlange </h4><br>  Diese Komponente wird verwendet, um von FileBeat kommende Protokolle an die RabbitMQ-Warteschlange weiterzuleiten.  Es gibt zwei Punkte: <br><br><ol><li>  Leider verf√ºgt FileBeat nicht √ºber ein Ausgabe-Plugin zum direkten Schreiben in RabbitMQ.  Und eine solche Funktionalit√§t ist nach dem ish auf ihrem Github nicht f√ºr die Implementierung geplant.  Es gibt ein Plugin f√ºr Kafka, aber aus irgendeinem Grund k√∂nnen wir es zu Hause nicht verwenden. </li><li>  Es gibt Anforderungen f√ºr das Sammeln von Protokollen in der DMZ.  Basierend darauf m√ºssen die Protokolle zuerst zur Warteschlange hinzugef√ºgt werden, und dann liest LogStash von au√üen die Eintr√§ge aus der Warteschlange. </li></ol><br>  Daher m√ºssen Sie genau f√ºr den Fall des Serverstandorts in der DMZ ein derart etwas kompliziertes Schema verwenden.  Eine Beispielkonfiguration lautet wie folgt: <br><br><div class="spoiler">  <b class="spoiler_title">iis_w3c_logs__filebeat_rabbitmq.conf</b> <div class="spoiler_text"><pre> <code class="sql hljs">input { beats { port =&gt; 5044 type =&gt; 'iis' ssl =&gt; true ssl_certificate_authorities =&gt; ["/etc/pki/tls/certs/app/ca.pem", "/etc/pki/tls/certs/app/ca-issuing.pem"] ssl_certificate =&gt; "/etc/pki/tls/certs/app/queue.domain.com.cer" ssl_key =&gt; "/etc/pki/tls/certs/app/queue.domain.com-pkcs8.key" ssl_verify_mode =&gt; "peer" } } output { <span class="hljs-comment"><span class="hljs-comment">#stdout {codec =&gt; rubydebug} rabbitmq { host =&gt; "127.0.0.1" port =&gt; 5672 exchange =&gt; "monitor.direct" exchange_type =&gt; "direct" key =&gt; "%{[fields][fld_app_name]}" user =&gt; "q-writer" password =&gt; "password" ssl =&gt; false } }</span></span></code> </pre> <br></div></div><br><h4>  RabbitMQ.  Nachrichtenwarteschlange </h4><br>  Diese Komponente wird verwendet, um Protokolleintr√§ge in der DMZ zu puffern.  Die Aufnahme erfolgt √ºber eine Reihe von Filebeat ‚Üí LogStash.  Das Lesen erfolgt von au√üerhalb der DMZ √ºber LogStash.  Beim Betrieb √ºber RabboitMQ werden ungef√§hr 4.000 Nachrichten pro Sekunde verarbeitet. <br><br>  Das Nachrichtenrouting wird gem√§√ü dem Namen des Systems konfiguriert, d. H. Basierend auf FileBeat-Konfigurationsdaten.  Alle Nachrichten fallen in eine Warteschlange.  Wenn der Warteschlangendienst aus irgendeinem Grund gestoppt wird, f√ºhrt dies nicht zum Verlust von Nachrichten: FileBeats empf√§ngt Verbindungsfehler und setzt das tempor√§re Senden aus.  Und LogStash, das aus der Warteschlange liest, empf√§ngt auch Netzwerkfehler und wartet, bis die Verbindung wieder aufgenommen wird.  Die Daten werden in diesem Fall nat√ºrlich nicht mehr in die Datenbank geschrieben. <br><br>  Die folgenden Anweisungen werden zum Erstellen und Konfigurieren von Warteschlangen verwendet: <br><br><pre> <code class="sql hljs">sudo /usr/local/bin/rabbitmqadmin/rabbitmqadmin <span class="hljs-keyword"><span class="hljs-keyword">declare</span></span> <span class="hljs-keyword"><span class="hljs-keyword">exchange</span></span> <span class="hljs-comment"><span class="hljs-comment">--vhost=/ name=monitor.direct type=direct sudo /usr/local/bin/rabbitmqadmin/rabbitmqadmin declare queue --vhost=/ name=web_log durable=true sudo /usr/local/bin/rabbitmqadmin/rabbitmqadmin --vhost="/" declare binding source="monitor.direct" destination_type="queue" destination="web_log" routing_key="site1.domain.ru" sudo /usr/local/bin/rabbitmqadmin/rabbitmqadmin --vhost="/" declare binding source="monitor.direct" destination_type="queue" destination="web_log" routing_key="site2.domain.ru"</span></span></code> </pre> <br><h4>  Grafana  Dashboards </h4><br>  Diese Komponente wird zur Visualisierung von √úberwachungsdaten verwendet.  In diesem Fall m√ºssen Sie die ClickHouse-Datenquelle f√ºr das Grafana 4.6+ Plugin installieren.  Wir mussten es ein wenig optimieren, um die Effizienz der Verarbeitung von SQL-Filtern in einem Dashboard zu erh√∂hen. <br><br>  Zum Beispiel verwenden wir Variablen, und wenn sie nicht im Filterfeld festgelegt sind, m√∂chten wir, dass keine Bedingung in der WHERE-Form generiert wird (uriStem = `` AND uriStem! = '').  In diesem Fall liest ClickHouse die uriStem-Spalte.  Im Allgemeinen haben wir verschiedene Optionen ausprobiert und schlie√ülich das Plugin (Makro $ valueIfEmpty) so korrigiert, dass bei einem leeren Wert 1 zur√ºckgegeben wird, ohne die Spalte selbst zu erw√§hnen. <br><br>  Und jetzt k√∂nnen Sie diese Abfrage f√ºr das Diagramm verwenden <br><br><pre> <code class="sql hljs">$columns(response, count(*) c) from $table where $adhoc and $valueIfEmpty($fld_app_name, 1, fld_app_name = '$fld_app_name') and $valueIfEmpty($fld_app_module, 1, fld_app_module = '$fld_app_module') and $valueIfEmpty($fld_server_name, 1, fld_server_name = '$fld_server_name') and $valueIfEmpty($uriStem, 1, uriStem like '%$uriStem%') and $valueIfEmpty($clientRealIP, 1, clientRealIP = '$clientRealIP')</code> </pre> <br>  Dies wird in eine solche SQL konvertiert (beachten Sie, dass leere uriStem-Felder in nur 1 konvertiert wurden). <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> t, groupArray((response, c)) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> groupArr <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> ( <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> (intDiv(toUInt32(logdatetime), <span class="hljs-number"><span class="hljs-number">60</span></span>) * <span class="hljs-number"><span class="hljs-number">60</span></span>) * <span class="hljs-number"><span class="hljs-number">1000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> t, response, <span class="hljs-keyword"><span class="hljs-keyword">count</span></span>(*) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> c <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> default.log_web <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> (logdate &gt;= toDate(<span class="hljs-number"><span class="hljs-number">1565061982</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> (logdatetime &gt;= toDateTime(<span class="hljs-number"><span class="hljs-number">1565061982</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> (fld_app_name = <span class="hljs-string"><span class="hljs-string">'site1.domain.ru'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> (fld_app_module = <span class="hljs-string"><span class="hljs-string">'web'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GROUP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> t, response <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> t <span class="hljs-keyword"><span class="hljs-keyword">ASC</span></span>, response <span class="hljs-keyword"><span class="hljs-keyword">ASC</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">GROUP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> t <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> t <span class="hljs-keyword"><span class="hljs-keyword">ASC</span></span></code> </pre> <br><h4>  Fazit </h4><br>  Das Erscheinen der ClickHouse-Datenbank ist zu einem Meilenstein auf dem Markt geworden.  Es war kaum vorstellbar, dass wir sofort kostenlos mit einem leistungsstarken und praktischen Tool f√ºr die Arbeit mit Big Data ausgestattet waren.  Mit zunehmenden Anforderungen (z. B. Sharding und Replikation auf mehrere Server) wird das Schema nat√ºrlich komplexer.  Aber auf den ersten Blick ist die Arbeit mit dieser Datenbank sehr sch√∂n.  Es ist ersichtlich, dass das Produkt "f√ºr Menschen" hergestellt wird. <br><br>  Im Vergleich zu ElasticSearch reduzieren sich die Kosten f√ºr das Speichern und Verarbeiten von Protokollen nach vorl√§ufigen Sch√§tzungen von f√ºnf auf das Zehnfache.  Mit anderen Worten, wenn wir f√ºr die aktuelle Datenmenge einen Cluster aus mehreren Computern konfigurieren m√ºssten, ben√∂tigen wir bei Verwendung von ClickHouse nur einen Computer mit geringem Stromverbrauch.  Ja, ElasticSearch verf√ºgt nat√ºrlich auch √ºber Mechanismen zum Komprimieren von Daten auf der Festplatte und andere Funktionen, die den Ressourcenverbrauch erheblich reduzieren k√∂nnen. Im Vergleich zu ClickHouse ist dies jedoch kostspielig. <br><br>  Ohne spezielle Optimierungen funktioniert das Laden von Daten und das Abrufen von Daten aus der Datenbank in den Standardeinstellungen mit erstaunlicher Geschwindigkeit.  Bisher haben wir ein paar Daten (ungef√§hr 200 Millionen Datens√§tze), aber der Server selbst ist schwach.  In Zukunft k√∂nnen wir dieses Tool f√ºr andere Zwecke verwenden, die nicht mit der Speicherung von Protokollen zusammenh√§ngen.  Zum Beispiel f√ºr End-to-End-Analysen im Bereich Sicherheit, maschinelles Lernen. <br><br>  Am Ende ein wenig √ºber die Vor- und Nachteile. <br><br><h4>  Nachteile </h4><br><ol><li>  Herunterladen von Datens√§tzen in gro√üen Paketen.  Dies ist einerseits eine Funktion, aber Sie m√ºssen immer noch zus√§tzliche Komponenten verwenden, um Datens√§tze zu puffern.  Diese Aufgabe ist nicht immer einfach, aber dennoch l√∂sbar.  Und ich m√∂chte das Schema vereinfachen. </li><li>  Einige exotische Funktionen oder neue Funktionen werden h√§ufig in neuen Versionen verwendet.  Dies wirft Bedenken auf und verringert den Wunsch nach einem Upgrade auf eine neue Version.  Beispielsweise ist die Kafka-Tabellen-Engine eine sehr n√ºtzliche Funktion, mit der Sie Ereignisse aus Kafka direkt lesen k√∂nnen, ohne dass Verbraucher implementiert werden m√ºssen.  Gemessen an der Anzahl der Probleme auf dem Github sind wir jedoch immer noch vorsichtig, diesen Motor in der Produktion einzusetzen.  Wenn Sie jedoch keine scharfen Bewegungen zur Seite ausf√ºhren und die Grundfunktionalit√§t verwenden, funktioniert dies stabil. </li></ol><br><h4>  Vorteile </h4><br><ol><li>  Es verlangsamt sich nicht. </li><li>  Niedrige Eintrittsschwelle. </li><li>  Open Source </li><li>  Es ist kostenlos. </li><li>  Skaliert gut (Out-of-Box-Sharding / Replikation) </li><li>  Es ist in dem vom Ministerium f√ºr Kommunikation empfohlenen Register russischer Software enthalten. </li><li>  Das Vorhandensein offizieller Unterst√ºtzung von Yandex. </li></ol></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de472912/">https://habr.com/ru/post/de472912/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de472896/index.html">Hubschrauber von einem Drucker: Zum ersten Mal haben Wissenschaftler einen gro√üen Koffer eines Hubschraubermotors ‚Äûgedruckt‚Äú</a></li>
<li><a href="../de472902/index.html">Windows for IoT: Verbesserte Hardwareunterst√ºtzung und neue Funktionen f√ºr intelligente Ger√§te</a></li>
<li><a href="../de472904/index.html">Wie Amazon Stock Work in ein Spiel verwandelte</a></li>
<li><a href="../de472908/index.html">Dagaz: Episoden (Teil 2)</a></li>
<li><a href="../de472910/index.html">Suchen Sie mit einem Smartphone nach Text auf Schildern und Paketen</a></li>
<li><a href="../de472914/index.html">Wolfram Function Repository: Open Access-Plattform f√ºr Wolfram-Spracherweiterungen</a></li>
<li><a href="../de472916/index.html">Backend, maschinelles Lernen und Serverless sind die interessantesten auf der Juli-Habr-Konferenz</a></li>
<li><a href="../de472918/index.html">ZX Spectrum in Russland und der GUS: Wie sich das Streben nach Online offline ver√§ndert hat</a></li>
<li><a href="../de472922/index.html">Defender-Programmierer st√§rker als Entropie</a></li>
<li><a href="../de472926/index.html">Das Gesetz der Beschleunigung der Rendite (Teil 1)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>