<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üöä üîú üë®üèæ‚Äçüíª Contr√¥le LCD F-51543NFU-LW-ADN / PWB51543C-2-V0 (de la biblioth√®que de bandes) ‚èØÔ∏è üì™ üîé</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bonjour encore, Habr! Ayant traduit l' article sur la gestion du module LCD avec un pilote, mais sans ma propre RAM vid√©o, j'ai d√©cid√© de traduire une...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Contr√¥le LCD F-51543NFU-LW-ADN / PWB51543C-2-V0 (de la biblioth√®que de bandes)</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/444912/"><img src="https://habrastorage.org/webt/yz/yf/la/yzyflade5gq71l7xiakjzym4utg.jpeg"><br><br>  Bonjour encore, Habr!  Ayant <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">traduit l'</a> article sur la gestion du module LCD avec un pilote, mais sans ma propre RAM vid√©o, j'ai d√©cid√© de traduire une autre publication sur le m√™me sujet.  Ici le module est d√©j√† plus simple, monochrome, mais pour ¬´faire revivre¬ª il n'en est pas moins int√©ressant. <a name="habracut"></a><br><br><h1>  Contr√¥le LCD avec pilote, mais sans contr√¥leur </h1><br>  L'affichage avec lequel l'auteur va travailler provient d'une ancienne biblioth√®que de bandes.  Le contr√¥leur n'a pas surv√©cu, mais une recherche de tout ce qui concerne ¬´263645-001¬ª a montr√© qu'il y avait un FPGA.  On pense que contr√¥ler directement ces modules LCD depuis Arduino, etc.  impossible, vous avez besoin d'un lien interm√©diaire - le contr√¥leur de la s√©rie SEDxxxxx, qui n'est pas ¬´convivial¬ª avec la carte d'exp√©rimentation et qui a plus d'entr√©es que le module lui-m√™me.  Mais ce n'est pas le cas.  Voici jusqu'√† quatre projets similaires: <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Sur l'ATmega8515</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Dessus</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">En photo</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Sur ESP32</a> <br><br>  Et certains contr√¥lent g√©n√©ralement les moniteurs AVR VGA 8 bits ... <br><br>  En g√©n√©ral, l'auteur a r√©ussi, le logiciel sous licence MIT est <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> . <br><br><h1>  Image fixe </h1><br>  Pour vous assurer que tout fonctionne, vous devez d'abord essayer de sortir une image raster √† un bit √† partir de la m√©moire flash du microcontr√¥leur.  Pour obtenir une tension n√©gative, trois ¬´Crones¬ª ont √©t√© pr√©lev√©s, la tension du diviseur, qui a √©t√© utilis√©e comme r√©sistance d'accord, a √©t√© appliqu√©e √† la borne V0.  Et ici sur l'√©cran est Lenna: <br><br><img src="https://habrastorage.org/webt/yb/7-/fg/yb7-fgxw6yf64l_ylhqaccnhq-g.jpeg"><br><br>  L'auteur ne comprend toujours pas comment il a r√©ussi √† retourner l'image (regardez de quel c√¥t√© se trouve le c√¢ble).  Dans tous les cas, il y a cet exemple sur la page du projet sur GitHub. <br><br><h1>  Mode texte </h1><br>  Mais la ROM vid√©o est de peu d'utilit√©, et il n'y a pas 9600 octets pour la RAM vid√©o dans l'Arduino.  Le mode texte vient √† la rescousse, dans lequel la ROM du g√©n√©rateur de caract√®res et la RAM vid√©o combin√©e sont plus petites que la RAM vid√©o en mode graphique.  Les partisans de la R√©publique du Kazakhstan et le ¬´sp√©cialiste¬ª peuvent briser les lances sans fin sur ce sujet. <br><br><img src="https://habrastorage.org/webt/yz/yf/la/yzyflade5gq71l7xiakjzym4utg.jpeg"><br><br>  Un petit exemple en langage assembleur AVR: <br><br><pre><code class="plaintext hljs">... lpm r24, Z ;---------- (CL2 rising edge) out %[data_port], r24 ld r30, X+ swap r24; (CL2 rising edge) out %[data_port], r24 lpm r24, Z ;---------- (CL2 rising edge) out %[data_port], r24 ...</code> </pre> <br><h1>  Mat√©riel requis </h1><br><img src="https://habrastorage.org/webt/85/p_/52/85p_52apzq0nmbzcnde9vaphrxy.jpeg"><br><br>  Pour le module F-51543NFU-LW-ADN / PWB51543C-2-V0, l'auteur a appliqu√©: <br><br>  Arduino sur AVR avec une fr√©quence d'horloge de 16 MHz (test√© sur Uno, Leonardo et un clone similaire √† ProMicro). <br><br>  Source de tension n√©gative.  Pour l'auteur, il s'agit d'un convertisseur DC-DC non stabilis√© A0524S-1W avec isolation d'entr√©e et de sortie.  Les convertisseurs pour le MC34063 conviennent √©galement (cette puce est tr√®s facile √† trouver - il suffit de d√©monter le chargeur USB le moins cher pour un allume-cigare) ou le MAX749.  La stabilisation n'est pas requise, la plage de tensions admissibles √† cette entr√©e pour le module utilis√© ici est assez large.  La valeur nominale est de moins 24 V, le maximum est de moins 30 par rapport au fil commun et de 35 entre Vdd et Vee.  La consommation de courant est de 6 mA. <br><br>  Deux transistors MOS √† canal N avec contr√¥le de niveau logique.  L'auteur a utilis√© IRL530n, le stock, bien s√ªr, est grand, mais il ne br√ªlera certainement pas.  Un transistor contr√¥le le r√©tro-√©clairage, l'autre une source de tension n√©gative. <br><br>  R√©sistance de coupure de 250 kŒ© pour fournir la tension √† l'entr√©e V0.  R√©glez de sorte que -16,8 V √† une temp√©rature de +25 ¬∞ C sur le contact mobile.  Cela provient d'une fiche technique, et donc, bien s√ªr, une telle pr√©cision n'est pas n√©cessaire. <br><br>  Plusieurs r√©sistances de 10 kilos pour la descente. <br><br>  Disposition et cavaliers. <br><br>  Que feriez-vous maintenant?  Montre QR?  Demandez √† Kote: <br><br><img src="https://habrastorage.org/webt/lw/yv/qp/lwyvqp84jo4uvj5byzropcuzf7k.jpeg"><br><br>  Kote propose d'impl√©menter une simulation de certains LCD courants avec un contr√¥leur.  Pour qu'une autre ¬´r√©flexion¬ª qui fonctionne avec l'√©cran du HD44780, seulement grand, puisse √™tre connect√©e √† cet Arduino. <br><br><h1>  Police - √©galement en RAM </h1><br>  Nous prenons un exemple avec EGA et VGA - l√†, lorsque vous travaillez en mode texte, c'est exactement ce que vous avez fait.  Seulement ici, il y avait 64 caract√®res au total, mais au moins tout est entr√© dans la RAM, contrairement au mode graphique.  Certes, le cycle principal des √©v√©nements a ralenti, mais vous pouvez essayer les graphiques en mosa√Øque: <br><br><img src="https://habrastorage.org/webt/ie/5w/qa/ie5wqaezqkvosxnzrjhvu3bzpaa.jpeg"><br><br><h1>  Mode graphique et demi-teintes </h1><br>  Dans Arduino sur AVR, il n'y a pas tellement de RAM, et c'est le point.  M√™me en Mega.  320x240 m√™me avec un bit par pixel - c'est d√©j√† 9600 octets.  Seulement quatre demi-teintes exigeront deux fois plus.  Avec la RAM externe, par exemple, 23LC512 en mode SQI, vous pouvez essayer d'impl√©menter quelque chose de similaire au DMA, mais il est plus simple et plus rentable de tout refaire sur ESP32, o√π il y a plus de RAM statique et le DMA est plus facile. <br><br>  Si vous souhaitez simplement connecter un tel √©cran √† un PC via USB, vous pouvez essayer d'utiliser ATmega32u4 pour cela - il y aura suffisamment de ressources m√™me pour les gradations de luminosit√© (en utilisant FRC, ce que cela est d√©crit dans ma traduction pr√©c√©dente).  Mais pas avec le ¬´m√©ga¬ª utilis√© comme convertisseur d'interface, mais avec un PC qui va lui-m√™me scanner l'√©cran LCD √† la vol√©e √† une vitesse de 5,4 m√©gabits par seconde. <br><br>  Lorsque le module √©tait toujours dans la biblioth√®que de bandes, il y avait une interface graphique et des gradations de luminosit√© - tout √©tait l√†. <br><br>  Les mises √† jour seront.  En attendant ... <br><br><img src="https://habrastorage.org/webt/9z/cu/p9/9zcup9llwkpyuzyzxky3wghu_hs.jpeg"><br><br>  Et ce n'est pas un montage photo, mais le r√©sultat d'un contr√¥le depuis un PC.  Et nous passerons de Hackaday.io √† GitHub - il y a encore beaucoup de choses int√©ressantes dans README.md. <br><br><h1>  Signaux pour contr√¥ler ces modules </h1><br>  FLM - First Line Marker - marqueur de premi√®re ligne, peut √©galement √™tre appel√© FRAME, VSYNC, etc. <br>  CL1 - Impulsion de verrouillage de ligne - impulsion de cha√Æne d'√©criture, peut √©galement √™tre appel√©e.  CHARGE, HSYNC, etc. <br>  CL2 - Horloge de d√©calage de pixel - impulsion de changement de pixel, peut √©galement √™tre appel√©e.  CP (changement de pixel), etc. <br>  M - signal alternatif, gr√¢ce auquel les pixels sont contr√¥l√©s par une tension alternative, peut √©galement √™tre appel√© BIAS (offset), etc. <br><br>  D0-D3 est un bus de donn√©es parall√®le √† quatre bits. <br><br>  Fils pour fil commun, alimentation du r√©tro√©clairage (par exemple VLED ¬±), alimentation du module (VEE et V0) <br><br>  Ne n√©gligez pas les fiches techniques.  Le module peut n√©cessiter une autre tension n√©gative, ou il peut s'av√©rer positif, ou le convertisseur peut √™tre int√©gr√©.  La logique peut diff√©rer, par exemple, avec une unit√© sur CL1, il n'y aura pas de r√©action sur CL2.  Il peut y avoir un r√©tro-√©clairage diff√©rent (CCFL (attention, l'onduleur est une "morsure") au lieu des LED), ou il n'y a pas de brochage sur la carte, alors vous ne le saurez pas sans fiche technique.  Vous ne pouvez rien connecter au hasard. <br><br><h1>  Que faire </h1><br>  Transmettez la cha√Æne en morceaux de quatre bits, l'enregistrement s'effectue sur le d√©clin sur la ligne CL2.  Apr√®s avoir pass√© la ligne, notez la r√©cession sur la ligne CL1 (oui, apr√®s tout, un peu de RAM dans le module est sur une seule ligne).  La ligne suivante sera s√©lectionn√©e automatiquement.  Apr√®s avoir transmis la trame enti√®re, revenez au d√©but en utilisant le signal FLM.  Dans une fiche technique sur LC79401, il y a un exemple.  Enregistrez √† une vitesse suffisante, appliquez r√©guli√®rement des impulsions √† CL1.  Le contr√¥leur h√©sita un peu - l'√©cran cligna moche. <br><br>  Apr√®s chaque image, changez le niveau logique √† l'entr√©e M √† l'oppos√©, de sorte que les pixels soient contr√¥l√©s par une tension alternative.  Sinon, l'affichage se d√©t√©riore: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/ZP0KxZl5N2o" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Vous ne pouvez pas confier cette op√©ration au microcontr√¥leur, mais mettez un d√©clencheur d√©nombrable.  L'entr√©e √† FLM, la sortie √† M - en g√©n√©ral, est compr√©hensible. <br><br>  Un exemple de sortie d'images √† partir de la m√©moire flash (voir le d√©but de l'article) est appel√© clglcd_simple dans ce r√©f√©rentiel. <br><br>  Comme d√©j√† mentionn√©, il est impossible de faire de m√™me avec la RAM en Arduino sur AVR - ce ne sera donc pas suffisant ... <br><br><h1>  Et encore - mode texte </h1><br>  Selon la fiche technique, vous pouvez transmettre des donn√©es sur un bus √† quatre bits et ¬´tirer¬ª CL2 avec une fr√©quence allant jusqu'√† 6 MHz.  Par cons√©quent, vous pouvez rapidement et rapidement transf√©rer la ligne, puis le microcontr√¥leur r√©sout un peu les autres t√¢ches, et comme le temporisateur le ¬´dit¬ª, il ¬´tire¬ª CL1 et r√©p√®te le cycle. <br><br>  Lors de la g√©n√©ration de caract√®res pour une r√©solution horizontale de 320 pixels, tout cela peut se faire en 20 Œºs (320 pixels / 4 bits = 80 impulsions, CL2 "pull" avec une fr√©quence de 4 MHz).  Pour les t√¢ches restantes, il reste 39,5 Œºs.  CL1 "jerk" toutes les 59,5 Œºs et obtenez une fr√©quence d'images de 70 Hz.  Eh bien, il y aura plus de proc√©dures pour g√©rer les interruptions et ainsi de suite, en g√©n√©ral, le microcontr√¥leur sera occup√© √† contr√¥ler l'affichage 45% du temps.  ¬´Entier¬ª 45 ou ¬´total¬ª 45?  Probablement la seconde: l'√©crasement des donn√©es dans la RAM vid√©o peut √™tre assez rapide. <br><br>  Voulez-vous que le microcontr√¥leur passe moins de temps √† g√©rer l'indicateur, et plus sur d'autres t√¢ches?  Vous pouvez r√©duire la fr√©quence d'images √† 50 Hz, vous pouvez overclocker le microcontr√¥leur √† 20 MHz.  Avec l'une de ces m√©thodes, davantage de cycles d'horloge auront lieu entre les routines d'interruption. <br><br>  Un temporisateur de comparaison de sortie commute la ligne CL2 toutes les quatre impulsions d'horloge avec un rapport cyclique de 50%.  Dans le m√™me temps, les donn√©es vont aux sorties du port PORTB, connect√©es au bus de donn√©es √† quatre bits du module de telle mani√®re qu'elles changent au moment o√π le niveau monte √† CL2, et au moment de la baisse elles restent inchang√©es.  Bien s√ªr, cela ne peut se faire sans assembleur: <br><br><pre> <code class="plaintext hljs">... lpm r24, Z ;---------- (CL2 rising edge) out %[data_port], r24 ld r30, X+ swap r24; (CL2 rising edge) out %[data_port], r24 lpm r24, Z ;---------- (CL2 rising edge) out %[data_port], r24 ...</code> </pre> <br>  8 cycles - et quatre grignotages sont transmis.  Et quoi transmettre exactement d√©pend du symbole qui se trouve dans la cellule RAM vid√©o correspondante, des pixels correspondant √† ce symbole qui doivent √™tre transf√©r√©s de la ROM du g√©n√©rateur de caract√®res et de ce qui est stock√© dans les cellules correspondantes de cette ROM. <br><br>  La chose la plus g√™nante ici est la n√©cessit√© d'arr√™ter la minuterie apr√®s exactement 80 impulsions.  Certains temporisateurs, comme Timer4 en 32u4, ne le peuvent pas. <br><br>  Pour obtenir le signal fourni √† la ligne CL1, l'auteur a appliqu√© une sortie diff√©rente du microcontr√¥leur, destin√©e √† la fois au temporisateur et au PWM rapide.  Ce qui est appliqu√© ici est compr√©hensible.  Il commute toutes les 952 mesures.  Ou si vous comptez apr√®s le diviseur d'horloge par 8 - il se produit toutes les 119 impulsions.  √Ä ce stade, le sous-programme de traitement d'interruption d√©marre et force le microcontr√¥leur √† soumettre √† CL1 de nouvelles donn√©es qui seront n√©cessaires lors de la prochaine impulsion.  Eh bien, le niveau sur la ligne M change avec la moiti√© de la fr√©quence.  Et l'√©cran LCD ne se d√©t√©riore pas.  Tous les signaux ressemblent √† ceci: <br><br><img src="https://habrastorage.org/webt/yt/_0/dh/yt_0dhpk4km7w-yml5spdz5ukl8.png"><br><br>  Le g√©n√©rateur de caract√®res se compose de 256 caract√®res - assez pour 866, KOI-8R ou 1251. 40xN caract√®res sont plac√©s dans la RAM vid√©o, o√π N est le nombre de lignes en fonction de la hauteur du caract√®re.  La largeur du symbole est toujours de 8 pixels et la hauteur peut √™tre de 6, 8, 10, 12, 15, 16. Plus il est petit, moins il faut de ROM pour le g√©n√©rateur de caract√®res et plus de RAM vid√©o.  Avec une police 8x8 (40 caract√®res pour 30 lignes), vous avez besoin de 1200 octets de RAM et 2048 octets de ROM.  Avec une police 8x16 (cela semble mieux sur ce module), la RAM a besoin de 600 octets et la ROM 4096. Du traducteur: vous pouvez stocker la police sous la forme 8x8, la redimensionner verticalement deux fois par logiciel et co√ªter 600 octets de RAM et 2048 ROM.  Pour stocker plusieurs polices dans la ROM, vous devez conserver l'adresse de d√©but de police non pas dans une constante, mais dans une variable, mais cela ne fonctionnera pas pour imprimer le texte dans plusieurs polices √† la fois, sauf, bien s√ªr, si vous modifiez cette adresse √† la vol√©e par la proc√©dure de traitement d'interruption directement pendant le transfert des pixels √† l'√©cran. <br><br>  La police est stock√©e comme ceci: d'abord les premi√®res lignes des 256 caract√®res, puis une ligne en dessous, etc.  Il existe un script Python dans le dossier misc du r√©f√©rentiel, qui convertit automatiquement la police TTF en fichier d'en-t√™te clglcd_font.h avec le tableau PROGMEM au format requis.  Les polices pixel classiques pour CC-BY-SA 4.0 peuvent √™tre trouv√©es <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> . <br><br><h1>  Et encore - prenez un exemple avec EGA et VGA </h1><br>  Mais cette fois avec des d√©tails.  Le g√©n√©rateur de caract√®res dans la RAM, comme indiqu√© ci-dessus, contient un total de 64 caract√®res, ils peuvent √™tre identifi√©s par des nombres de 0 √† n ou de 255-n √† 255. Ils sont stock√©s de la m√™me mani√®re: les premi√®res lignes de tous les caract√®res, puis les suivantes, et ainsi de suite.  Seul tout cela est align√© en tenant compte du fait que les caract√®res ne sont pas 256, mais 64. Pour les caract√®res de taille 8x16 pixels, 16 * 64 = 1024 octets sont requis.  Le r√©f√©rentiel a un exemple de travail avec le g√©n√©rateur de caract√®res en RAM. <br><br>  Si les deux g√©n√©rateurs de caract√®res sont utilis√©s en m√™me temps - 256 caract√®res en ROM et 64 caract√®res en RAM, vous devrez accepter que non seulement il y aura moins de RAM, mais aussi que la vitesse de transfert des donn√©es des lignes du module diminuera - au lieu de 8 cycles d'horloge, deux quartets auront besoin de 12, c'est-√†-dire, non pas 20 microsecondes, mais 30, et au lieu de 45% du temps pour le contr√¥le LCD, cela prendra 60. <br><br><h1>  Mode graphique en demi-teintes </h1><br>  Comme indiqu√© ci-dessus, dans ce cas, le microcontr√¥leur fonctionne simplement comme un convertisseur d'interface.  Vous aurez besoin d'ATmega32u4, et ce qu'il faut faire est d√©crit <a href="">ici</a> .  Veuillez noter que le module peut √™tre endommag√© en raison du gel du programme sur le PC. <br><br>  Alors, quelle est cette boucle √† quatre fils - √† partir du capteur r√©sistif, il s'av√®re. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/mMqvBnYOjEQ" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><h1>  O√π se connecter </h1><br>  Comme indiqu√© ci-dessus, une tension n√©gative est requise, qui dans les premi√®res exp√©riences peut √™tre retir√©e de trois ¬´Crones¬ª, puis assembler le convertisseur, par exemple, sur le MAX749.  Les signaux de contr√¥le de puissance, ainsi que le signal DISPOFF (c'est un signal inverse, le module est allum√© √† un), abaissent les r√©sistances.  Lors du flashage et de la r√©initialisation du microcontr√¥leur, l'apparition d'unit√©s logiques y est inacceptable. <br><br>  Appliquer une tension n√©gative apr√®s tension + 5 V et une unit√© logique √† la ligne DISPOFF - lorsque des donn√©es sont d√©j√† pr√©sentes sur les lignes de contr√¥le: au moins une unit√© sur le bus de donn√©es, une unit√© sur CL1.  Sinon, le module peut √©chouer. <br><br>  Les entr√©es D0-D3 peuvent √™tre connect√©es aux sorties du m√™me port du microcontr√¥leur, par exemple Px4-Px7, tandis que les sorties Px0-Px3 ne peuvent pas √™tre utilis√©es comme GPIO.  Vous pouvez leur affecter d'autres fonctions, par exemple, les utiliser comme sorties de temporisations, interfaces s√©rie, etc.  Si vous les utilisez comme entr√©es, soyez prudent: les r√©sistances de pull-up int√©gr√©es peuvent commuter arbitrairement si elles ne sont pas d√©sactiv√©es (PUD - pull-up disable). <br><br>  Entr√©e M - √† la sortie du temporisateur de comparaison ou PWM. <br><br>  Entr√©e CL1 - vers une autre sortie du m√™me temporisateur. <br><br>  Entr√©e CL2 - √† la sortie d'un autre temporisateur de comparaison. <br><br>  FLM - vers n'importe quelle sortie num√©rique. <br><br>  DISPOFF - vers toute autre sortie num√©rique. <br><br>  Le reste d√©pend de la fa√ßon dont vous allumez le module.  L'auteur pr√©f√®re contr√¥ler le r√©tro-√©clairage et le Vee s√©par√©ment. <br><br><h1>  Comment utiliser le firmware </h1><br>  Placez les fichiers clglcd.h et clglcd.cpp dans l'esquisse <br><br>  Faites une copie de sauvegarde du fichier clglcd_config.h et √©ditez-le en tenant compte de ce qui est connect√©, ainsi que des fonctions dont vous avez besoin: un g√©n√©rateur de caract√®res en RAM, etc.  Attention, le code n'indique pas les noms des broches Arduino, mais les noms des broches du microcontr√¥leur selon la fiche technique.  Les noms des sorties des dompteurs de comparaison sont d√©chiffr√©s comme suit: par exemple, 2, B est OC2B, ce qui sur l'Arduino Uno correspond √† PD3.  Les exemples montrent les options de connexion obtenues par l'auteur. <br><br>  G√©n√©rez le fichier de police clglcd_font.h avec un script Python dans le dossier misc (voir ci-dessus). <br><br>  Voir dans les exemples comment initialiser, allumer et √©teindre l'√©cran.  Mettez dans le tableau d'√©cran le texte que vous souhaitez afficher pour v√©rification. <br><br>  Compilez et remplissez l'esquisse.  V√©rifiez avec un analyseur logique que les signaux corrects iront √† l'√©cran et avec un voltm√®tre que toutes les tensions d'alimentation sont normales.  Ensuite, connectez l'√©cran. <br><br>  Ajoutez un code √† l'esquisse qui fera quelque chose, par exemple, recevra du texte sur un port s√©rie et l'affichera. <br><br><h1>  Afficher les interruptions </h1><br>  L'affichage doit √™tre constamment mis √† jour, ce que font les proc√©dures de gestion des interruptions.  Si les interruptions s'arr√™tent pendant plus de 30 microsecondes, l'affichage clignote et si plus de 60 microsecondes pour une unit√© sur la ligne FLM, il peut √©chouer.  Si vous devez arr√™ter les interruptions pendant une longue p√©riode, √©teignez d'abord l'affichage avec le signal DISPOFF (je le r√©p√®te, c'est un signal inverse, le module est allum√© √† un).  Bien s√ªr, s'il s'√©teint pendant deux secondes √† chaque fois que vous avez besoin de traiter les donn√©es d'un capteur d'humidit√© et de temp√©rature, peu de gens l'aimeront, mais c'est mieux que de ruiner le module.  Mieux encore, chargez le reste sur un microcontr√¥leur s√©par√©.  L'√©change d'informations par le m√™me microcontr√¥leur avec des appareils fonctionnant sur le protocole 1 fil et des LED d'adresse est particuli√®rement inacceptable.  Les clones Arduino Pro Micro sont assez peu co√ªteux pour en acheter deux. <br><br><h1>  La communication </h1><br>  Mais les interfaces mat√©riellement impl√©ment√©es fonctionneront parfaitement: ports s√©rie, bus I <sup>2</sup> C, SPI en mode ma√Ætre.  Dans l'esclave - uniquement si le ma√Ætre permet un ¬´roll-off¬ª p√©riodique de l'esclave de 25 √† 35 Œºs.  Bien s√ªr, cela d√©pend toujours du nombre de ¬´jambes¬ª qui restent inoccup√©es apr√®s avoir connect√© l'√©cran. <br><br>  L'USB sur 32u4 fonctionne tr√®s bien si vous n'interrogez pas trop souvent le point de terminaison de gestion (code de routine d'interruption lente).  Le pilote CDC et ses API √©taient assez rapides. <br><br>  Ensuite, dans le fichier README.md sur GitHub, la liste des projets similaires est r√©p√©t√©e, la m√™me que sur la page du projet sur Hackaday.io <br><br>  Merci de votre attention! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr444912/">https://habr.com/ru/post/fr444912/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr444902/index.html">Optimisation de la conception par des m√©thodes de la th√©orie de la commande automatique</a></li>
<li><a href="../fr444904/index.html">R√©cup√©ration d'un mot de passe principal √† partir d'un gestionnaire de mots de passe verrouill√©s SafeInCloud</a></li>
<li><a href="../fr444906/index.html">Lire ind√©sirable</a></li>
<li><a href="../fr444908/index.html">O√π cultiver les smartphones</a></li>
<li><a href="../fr444910/index.html">La stimulation sonore et lumineuse aide √† combattre la maladie d'Alzheimer, chez la souris, mais les r√©sultats sont encourageants</a></li>
<li><a href="../fr444916/index.html">N'a pas achet√© de DLC: une fonction qui sauverait le 737 tomb√©, Boeing vendu en option</a></li>
<li><a href="../fr444918/index.html">O√π les smartphones grandissent: une feuille de route pour devenir un ordinateur √† part enti√®re</a></li>
<li><a href="../fr444920/index.html">Le nouvel algorithme acc√©l√®re 200 fois la conception automatique des r√©seaux de neurones</a></li>
<li><a href="../fr444922/index.html">Comment vous prot√©ger contre l'hypnovirus</a></li>
<li><a href="../fr444924/index.html">Le premier WIAD √† Moscou: comment √ßa s'est pass√© et ce dont ils ont parl√©</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>