<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏻‍🌾 🕒 🚛 Segmentation automatique des organes respiratoires 🎄 🗃️ 🧑🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="La segmentation manuelle des poumons prend environ 10 minutes et nécessite une certaine habileté pour obtenir le même résultat de haute qualité qu'ave...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Segmentation automatique des organes respiratoires</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/inobitec/blog/461329/"><p>  La segmentation manuelle des poumons prend environ 10 minutes et nécessite une certaine habileté pour obtenir le même résultat de haute qualité qu'avec la segmentation automatique.  La segmentation automatique prend environ 15 secondes. </p><br><p>  J'ai supposé que sans réseau neuronal, il serait possible d'obtenir une précision ne dépassant pas 70%.  J'ai également supposé que les opérations morphologiques ne sont que la préparation d'une image pour des algorithmes plus complexes.  Mais à la suite du traitement de ces 40 échantillons de données tomographiques, bien que peu nombreux, l'algorithme a segmenté les poumons sans erreur.  De plus, après avoir testé dans les cinq premiers cas, l'algorithme n'a pas changé de manière significative et a correctement fonctionné sur les 35 autres études sans modifier les paramètres. </p><br><p>  De plus, les réseaux de neurones ont un inconvénient - pour leur entraînement, nous avons besoin de centaines d'échantillons d'entraînement de poumons, qui doivent être balisés manuellement. </p><br><p><img src="https://habrastorage.org/webt/fg/uv/-r/fguv-r_mn7ybraf34p_1ybbphwa.jpeg"></p><a name="habracut"></a><br><h1>  Le contenu </h1><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Structure du système respiratoire</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Échelle de Haunsfield</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Morphologie mathématique</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Algorithme de Lee et compression RLE</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Transformation de seuil du volume de base</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Élimination de l'air extérieur</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Segmentation de l'objet volume maximum</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Fermer les vaisseaux à l'intérieur des poumons</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Algorithme de segmentation des organes respiratoires</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Implémentation d'algorithmes dans MATLAB</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Conclusion</a> </li></ul><br><h1 id="paragraph1">  Structure du système respiratoire </h1><br><p>  Le système respiratoire comprend les voies respiratoires et les poumons.  Les voies respiratoires sont divisées en voies aériennes supérieures et inférieures.  Le point de séparation entre les voies respiratoires inférieures et supérieures est le point d'intersection de l'œsophage et des voies respiratoires.  Tous les organes qui sont au-dessus du larynx sont les voies supérieures et le larynx et les organes en dessous sont les voies inférieures. </p><br><p>  Liste des organes respiratoires: </p><br><p>  <strong>La cavité nasale</strong> est une cavité remplie d'air entre le nez et le pharynx. <br>  <strong>Le pharynx</strong> est un canal par lequel la nourriture et l'air voyagent. <br>  <strong>La trachée</strong> est un tube relié au larynx et aux bronches. <br>  <strong>Le larynx</strong> est responsable de la formation de la voix.  C'est au niveau des vertèbres cervicales C4-C6. <br>  <strong>Les bronches</strong> sont les canaux respiratoires, dont la partie principale est située à l'intérieur des poumons. <br>  <strong>Les poumons</strong> sont le principal organe respiratoire. </p><br><p><img src="https://habrastorage.org/webt/kf/jv/kj/kfjvkjeioihehmpbzprc5bvgf8y.png"></p><br><h1 id="paragraph2">  Échelle de Haunsfield </h1><br><p> Godfrey Hounsfield était un ingénieur électricien anglais qui, avec le théoricien américain Allan Cormack, a développé la tomodensitométrie, pour laquelle il a partagé le prix Nobel en 1979. </p><br><p><img src="https://habrastorage.org/webt/jv/bl/ho/jvblho_x-0woitx02gbfjuxxhju.jpeg"></p><br><p>  L'échelle de Hounsfield - est une échelle quantitative pour décrire la radiodensibilité, qui est mesurée en unités de Hounsfield, notée HU. </p><br><p>  La radiodensité est calculée sur la base du coefficient d'atténuation du rayonnement.  Le coefficient d'atténuation caractérise la facilité avec laquelle un volume de matériau peut être pénétré par le rayonnement. </p><br><p>  La radiodensité est calculée par la formule: </p><br><p><math> </math> $$ afficher $$ {μ_ {X} -μ_ {eau} \ sur μ_ {eau} -μ_ {air}} \ fois 1000 $$ afficher $$ </p><br><p>  où <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x3BC;</mo></mrow><mi>X</mi></msub><mo>,</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x3BC;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>e</mi><mi>a</mi><mi>u</mi></mrow></msub><mo>,</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x3BC;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>a</mi><mi>i</mi><mi>r</mi></mrow></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="13.124ex" height="2.057ex" viewBox="0 -520.7 5650.7 885.9" role="img" focusable="false" style="vertical-align: -0.848ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/inobitec/blog/461329/&amp;usg=ALkJrhgFsQSfTKVU7hXcy7jQrkOwYM9M1g#MJMATHI-3BC" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/inobitec/blog/461329/&amp;usg=ALkJrhgFsQSfTKVU7hXcy7jQrkOwYM9M1g#MJMATHI-58" x="853" y="-357"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/inobitec/blog/461329/&amp;usg=ALkJrhgFsQSfTKVU7hXcy7jQrkOwYM9M1g#MJMAIN-2C" x="1306" y="0"></use><g transform="translate(1751,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/inobitec/blog/461329/&amp;usg=ALkJrhgFsQSfTKVU7hXcy7jQrkOwYM9M1g#MJMATHI-3BC" x="0" y="0"></use><g transform="translate(603,-253)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/inobitec/blog/461329/&amp;usg=ALkJrhgFsQSfTKVU7hXcy7jQrkOwYM9M1g#MJMATHI-65" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/inobitec/blog/461329/&amp;usg=ALkJrhgFsQSfTKVU7hXcy7jQrkOwYM9M1g#MJMATHI-61" x="466" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/inobitec/blog/461329/&amp;usg=ALkJrhgFsQSfTKVU7hXcy7jQrkOwYM9M1g#MJMATHI-75" x="995" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/inobitec/blog/461329/&amp;usg=ALkJrhgFsQSfTKVU7hXcy7jQrkOwYM9M1g#MJMAIN-2C" x="3564" y="0"></use><g transform="translate(4009,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/inobitec/blog/461329/&amp;usg=ALkJrhgFsQSfTKVU7hXcy7jQrkOwYM9M1g#MJMATHI-3BC" x="0" y="0"></use><g transform="translate(603,-253)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/inobitec/blog/461329/&amp;usg=ALkJrhgFsQSfTKVU7hXcy7jQrkOwYM9M1g#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/inobitec/blog/461329/&amp;usg=ALkJrhgFsQSfTKVU7hXcy7jQrkOwYM9M1g#MJMATHI-69" x="529" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/inobitec/blog/461329/&amp;usg=ALkJrhgFsQSfTKVU7hXcy7jQrkOwYM9M1g#MJMATHI-72" x="874" y="0"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mo>μ</mo></mrow><mi>X</mi></msub><mo>,</mo><msub><mrow class="MJX-TeXAtom-ORD"><mo>μ</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi>e</mi><mi>a</mi><mi>u</mi></mrow></msub><mo>,</mo><msub><mrow class="MJX-TeXAtom-ORD"><mo>μ</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi>a</mi><mi>i</mi><mi>r</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-2"> μ_X, μ_ {eau}, μ_ {air} </script>  sont des coefficients d'atténuation linéaires pour le matériau mesuré, l'eau et l'air. </p><br><p>  La radiodensité peut être négative car une radiodensibilité nulle correspond à l'eau.  Cela signifie que tous les matériaux ayant un coefficient d'atténuation plus faible que le coefficient d'atténuation de l'eau (par exemple, le tissu pulmonaire, l'air) auront une radiodensibilité négative. </p><br><p>  Les radiodensités approximatives pour divers tissus sont énumérées ci-dessous: </p><br><ul><li>  Air: -1000 HU. </li><li>  Organes respiratoires: de -950 à -300 HU. </li><li>  Sang (sans contraste des vaisseaux): de 0 à 100 HU. </li><li>  Os: 100 à 1000 HU. </li></ul><br><p><img src="https://habrastorage.org/webt/zv/zz/v_/zvzzv_n2koandwhyv-nw1ciunou.png"></p><br><p>  Liens vers Wikipedia: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">échelle de Hounsfield</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Godfrey Hounsfield</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">coefficient d'atténuation</a> . </p><br><h1 id="paragraph3">  Morphologie mathématique </h1><br><p>  <strong>Les opérations morphologiques</strong> sont les principaux outils qui ont été utilisés dans l'algorithme. <br>  Dans le domaine de la vision par ordinateur, les opérations morphologiques sont appelées un groupe d'algorithmes pour la transformation de la forme des objets.  Le plus souvent, les opérations morphologiques sont appliquées aux images binarisées où les unités correspondent aux voxels d'objets et les zéros à vider. <br>  Les principales opérations morphologiques comprennent: </p><br><p>  <strong>La dilatation morphologique</strong> est l'ajout de nouveaux voxels à tous les voxels de bord des objets.  En d'autres termes, l'algorithme scanne tous les voxels correspondant au bord de l'objet et les agrandit en utilisant un noyau avec une forme donnée (sphère, cube, croix etc).  Le noyau a son propre rayon (pour la sphère), ou la largeur du côté (pour le cube).  Cette opération est souvent utilisée pour fusionner plusieurs objets voisins en un seul objet. </p><br><p>  <strong>L'érosion morphologique</strong> est la coupure de tous les voxels se trouvant à la frontière (limite) des objets.  Cette opération est inverse à la dilatation.  Cette opération est utile pour éliminer le bruit qui a la forme de nombreux petits objets interconnectés.  Cependant, cette méthode d'élimination du bruit ne doit être utilisée que si l'objet d'intérêt a une épaisseur bien supérieure au rayon d'érosion.  Sinon, les informations utiles seront perdues. </p><br><p>  <strong>La fermeture morphologique</strong> est une dilatation suivie d'une érosion.  Il est utilisé pour fermer les trous à l'intérieur des objets et pour fusionner les objets voisins. </p><br><p>  <strong>L'ouverture morphologique</strong> est une érosion suivie d'une dilatation.  Il est utilisé pour supprimer les petits objets bruyants et pour séparer les objets en plusieurs objets. </p><br><p><img src="https://habrastorage.org/webt/7n/tt/ux/7nttuxnqs66djkmrav1amhg4mei.gif"></p><br><h1 id="paragraph4">  Algorithme de Lee et compression RLE </h1><br><p>  Pour sélectionner des objets dans un volume de voxel binarisé, l'algorithme de Lie est utilisé.  À l'origine, cet algorithme a été inventé pour trouver le moyen le plus court de sortir du labyrinthe.  Nous l'utilisons pour sélectionner l'objet et le déplacer d'un tableau tridimensionnel de voxels à un autre.  L'idée de base de l'algorithme consiste en un mouvement parallèle dans toutes les directions possibles à partir du point de départ.  Pour un cas tridimensionnel, il est possible de se déplacer dans 26 ou 6 directions à partir d'un voxel. </p><br><p>  Pour optimiser les performances, l'algorithme de codage de longueur d'exécution a été appliqué.  L'idée principale de l'algorithme est que la séquence de uns et de zéros est remplacée par un chiffre égal au nombre d'éléments dans la séquence.  Par exemple, la chaîne «00110111» peut être remplacée par: «2;  2;  1;  3 ".  Cela réduit le nombre d'accès à la mémoire. </p><br><p><img src="https://habrastorage.org/webt/if/kr/h6/ifkrh6br6sgi65g8sowexfxxsis.gif"><img src="https://habrastorage.org/webt/9f/rr/nc/9frrncdin9axwhdwgad8vndnlqy.gif"></p><br><p>  Liens Wikipedia: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">algorithme Lee, algorithme</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">RLE</a> . </p><br><h1 id="paragraph5">  Transformation de seuil du volume de base </h1><br><p>  En utilisant le tomographe, on a obtenu les données sur une radiodensibilité à chaque point de l'espace balayé.  Les voxels aériens ont une radio-densité dans la plage de -1100 à -900 HU, et les voxels des organes respiratoires ont une radio-densité de -900 à -300 HU.  Par conséquent, nous pouvons supprimer tous les voxels inutiles avec une radiodensibilité supérieure à -300 HU.  En conséquence, nous obtenons un volume de voxel binarisé contenant uniquement les organes respiratoires et l'air. </p><br><p><img src="https://habrastorage.org/webt/di/lv/ss/dilvssyv2do2rvjlbb3xov798rw.gif"></p><br><h1 id="paragraph6">  Élimination de l'air extérieur </h1><br><p>  Pour segmenter l'air interne du corps, nous supprimons tous les objets adjacents aux coins du volume 3D.  Ainsi, nous éliminons l'air extérieur. </p><br><p><img src="https://habrastorage.org/webt/_b/ol/mh/_bolmh5kdpm65pt0ysosn-zk4iu.png"></p><br><p>  Cependant, dans tous les cas, l'air à l'intérieur de la table du tomographe ne sera pas supprimé, car il peut ne pas avoir de connexion avec les coins du volume 3D. </p><br><p><img src="https://habrastorage.org/webt/mu/m1/bi/mum1bidj1at0nvceitxh5jtzqs4.png"></p><br><p>  Par conséquent, nous scannerons non seulement les coins, mais également tous les voxels se trouvant sur l'un des plans de bord du f.  Mais, comme nous pouvons le voir sur l'image ci-dessous, les poumons ont également été retirés.  Il s'avère que la trachée avait également une connexion avec le plan supérieur du volume 3D. </p><br><p><img src="https://habrastorage.org/webt/fu/zb/3b/fuzb3bzxnvxvofjz-mxoelly5w4.gif"></p><br><p>  Nous devrons exclure le plan supérieur de la zone de numérisation.  Il existe également des études dans lesquelles les poumons n'ont pas été entièrement capturés et le plan inférieur est connecté aux poumons. <br>  Donc, si vous le souhaitez, vous pouvez également exclure le plan inférieur. </p><br><p><img src="https://habrastorage.org/webt/uf/ja/mb/ufjambvoavwiks-09hms7wc02lg.png"></p><br><p>  Mais cette méthode n'affecte que les études thoraciques.  Dans le cas de la capture de tout le volume du corps, la connexion de l'air interne et externe à travers la cavité nasale apparaîtra Par conséquent, il est nécessaire d'appliquer une érosion morphologique pour séparer l'air interne et externe. </p><br><p><img src="https://habrastorage.org/webt/zf/za/ej/zfzaejokke75l8wiqqj20ma_mjs.gif"></p><br><p>  Après avoir appliqué l'érosion, nous pouvons revenir à la méthode de segmentation de l'air extérieur précédemment obtenue qui est basée sur la connectivité de l'air extérieur avec les plans latéraux du volume 3D. </p><br><p><img src="https://habrastorage.org/webt/yj/i7/nh/yji7nhiveqpxbky3_qgj9b6n0zq.png"></p><br><p>  Après la segmentation de l'air externe, nous pourrions immédiatement soustraire l'air externe de tout le volume de l'air et des poumons et obtenir l'air interne du corps et des poumons.  Mais il y a un problème.  Après l'érosion, certaines informations sur l'air extérieur ont été perdues.  Pour le restaurer, nous appliquons une dilatation de l'air extérieur. </p><br><p><img src="https://habrastorage.org/webt/vn/tu/ns/vntunsho-og3pm1at7dqi3_ltna.gif"></p><br><p>  Ensuite, nous soustrayons l'air extérieur de l'air entier et des organes respiratoires et obtenons l'air intérieur et les organes respiratoires. </p><br><p><img src="https://habrastorage.org/webt/fr/hx/df/frhxdfz7ax9fz-ps7x9zjrlgiqo.png"></p><br><p><img src="https://habrastorage.org/webt/mw/d6/qc/mwd6qcn4xkuj5m5xsp-trc0usk4.png"></p><br><h1 id="paragraph7">  Segmentation de l'objet volume maximum </h1><br><p>  Ensuite, nous segmentons les organes respiratoires en tant qu'objet maximal en volume.  Les organes respiratoires n'ont aucun lien avec l'air à l'intérieur du tractus gastro-intestinal. </p><br><p><img src="https://habrastorage.org/webt/7l/gt/bd/7lgtbdfvf0st73wqzlacvax1r-0.png"><img src="https://habrastorage.org/webt/5d/ce/8u/5dce8urp2qvopyat905ex9y_qqs.png"></p><br><p>  Il convient de noter que le choix correct du seuil de radiodensibilité à l'étape initiale est important.  Sinon, dans certains cas, il peut n'y avoir aucun lien entre les deux poumons en raison d'une faible résolution.  Par exemple, si nous supposons que les voxels des organes respiratoires ont une radio-densité de -500 HU et moins, alors dans le cas ci-dessous, la segmentation des organes respiratoires en tant que plus grand objet en volume entraînera une erreur, car il n'y a aucun lien entre les deux poumons.  Par conséquent, le seuil devrait être augmenté à -300 HU. </p><br><p><img src="https://habrastorage.org/webt/jr/mi/m2/jrmim2de5siht6zo2nhoz8l1e5e.png"></p><br><h1 id="paragraph8">  Fermer les vaisseaux à l'intérieur des poumons </h1><br><p>  Pour capturer les vaisseaux à l'intérieur des poumons, nous utiliserons une fermeture morphologique, c'est-à-dire une dilatation suivie d'une érosion de même rayon.  La radiodensité des vaisseaux (sans contraste) est d'environ 0..100 HU. </p><br><p><img src="https://habrastorage.org/webt/po/1a/nz/po1anz0m9em66lsawok9fuwncvo.png"></p><br><p>  Sur l'image, nous pouvons voir que les grands canaux sanguins ne sont pas fermés.  Mais ce n'est pas nécessaire.  Le but de cette opération était de détruire les nombreux petits trous à l'intérieur des poumons pour simplifier le processus de segmentation pulmonaire dans les étapes suivantes. </p><br><h1 id="paragraph9">  Algorithme de segmentation des organes respiratoires </h1><br><p>  En conséquence, nous obtenons l'algorithme de segmentation des organes respiratoires suivant: </p><br><ol><li>  Transformation de seuil du volume de base avec le seuil "&lt;-300 HU". </li><li>  Érosion morphologique avec un rayon de 3 mm pour la séparation de l'air extérieur et intérieur. </li><li>  Segmentation de l'air extérieur basée sur la connectivité de l'air extérieur avec les plans latéraux limites du volume 3D. </li><li>  Dilatation morphologique de l'air extérieur pour restituer les informations perdues après l'érosion. </li><li>  Soustraction de l'air extérieur de l'air entier et des organes respiratoires pour obtenir l'air intérieur et les organes respiratoires. </li><li>  Segmentation de l'objet de volume maximum. </li><li>  Fermeture morphologique des vaisseaux à l'intérieur des poumons. </li></ol><br><p><img src="https://habrastorage.org/webt/pv/xf/ee/pvxfee1i06siq8wa66ynzbuxku0.png"></p><br><h1 id="paragraph10">  Implémentation d'algorithmes dans MATLAB </h1><br><h3 id="function-getrespiratoryorgans">  Fonction "getRespiratoryOrgans" </h3><br><pre><code class="matlab hljs"><span class="hljs-comment"><span class="hljs-comment">% Returns the whole respiratory organs volume (lung and airway volume) % without separating of the left and right lung. % V = base volume with radiodensity data in Hounsfield units. % cr = radius of vessels morphological closing. % ci = iteration count of vessels morphological closing (fe 3-times % make dilation and after that 3-times make erosion. function RO = getRespiratoryOrgans(V,cr,ci) % Threshold transform of the base volume with the threshold level "&lt;-300 HU". AL=~imbinarize(V,-300); % Morphological erosion with the 3 mm radius for the separation of external % and internal air. SE=strel('sphere',3); EAL=imerode(AL,SE); % Segmentation of external air based on external air connectivity with the % boundary side planes of the 3D volume. EA=getExternalAir(EAL); % Morphological dilation of the external air to restore the information lost % after the erosion. DEA=EA; for i=1:4 DEA=imdilate(DEA,SE); DEA=DEA&amp;AL; end % Subtraction of the external air from the whole air and respiratory organs to % obtain the internal air and respiratory organs. IAL=AL-DEA; % Segmentation of the maximum volume object. RO=getMaxObject(IAL); Morphological closing of the vessels inside the lungs. RO=closeVoxelVolume(RO,3,2);</span></span></code> </pre> <br><h3 id="function-getexternalair">  Fonction "getExternalAir" </h3><br><pre> <code class="matlab hljs"><span class="hljs-comment"><span class="hljs-comment">% Returns the volume which is connected with the edge surfaces of % the voxel scene (except the top surface, because lungs can have % a connection with the top surface). % EAL = eroded lung-and-air binarized volume. function EA = getExternalAir(EAL) % The “bwlabeln” function segments objects: voxels of a one object % equates to 1, and of another one - to 2, etc. V=bwlabeln(EAL); % We request such characteristics of the objects as bounding box and % list of all object voxels. R=regionprops3(V,'BoundingBox','VoxelList'); n=height(R); % Create a 3D matrix for storing external air voxels. s=size(EAL); EA=zeros(s,'logical'); % Scan all the objects to find objects belonging to the external air. for i=1:n % Define the minimum and maximum x and y coordinates of the object. x0=R(i,1).BoundingBox(1); y0=R(i,1).BoundingBox(2); x1=x0+R(i,1).BoundingBox(4); y1=y0+R(i,1).BoundingBox(5); % If the edge voxels of the object are in contact with the side planes of % the 3D volume, then copy all the voxels of this object into the matrix EA. if (x0 &lt; 1 || x1 &gt; s(1)-1 || y0 &lt; 1 || y1 &gt; s(2)-1) % Convert the object voxel coordinates data to the matrix type: % [[x1 y1 z1] [x2 y2 z3] ... [xn yn zn]]. mat=cell2mat(R(i,2).VoxelList); ms=size(mat); % Fill the matrix containing the voxels of the external air. for j=1:ms(1) x=mat(j,2); y=mat(j,1); z=mat(j,3); EA(x,y,z)=1; end end end</span></span></code> </pre> <br><h3 id="function-getmaxobject">  Fonction "getMaxObject" </h3><br><pre> <code class="matlab hljs"><span class="hljs-comment"><span class="hljs-comment">% Returns the largest object in the voxel volume V. % O = the voxels of the largest object. % m = the volume of the largest object. function [O,m] = getMaxObject(V) % Segment the objects. V=bwlabeln(V); % Reqiest the information about the objects volume and objects voxel coordinates. R=regionprops3(V,'Volume','VoxelList'); % Determine the index of the maximum volume object. v=R(:,1).Volume; [m,i]=max(v); % Create the 3D matrix for storing the largest object voxels. s=size(V); O=zeros(s,'logical'); % Copy the largest object voxels to the new matrix. mat=cell2mat(R(i,2).VoxelList); ms=size(mat); for j=1:ms(1) x=mat(j,2); y=mat(j,1); z=mat(j,3); O(x,y,z)=1; end</span></span></code> </pre> <br><p>  Le code source peut être téléchargé par la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">référence</a> . </p><br><h1 id="paragraph11">  Conclusion </h1><br><p>  Les articles suivants vont être: </p><br><ol><li>  segmentation de la trachée et des bronches; </li><li>  segmentation pulmonaire; </li><li>  segmentation des lobes pulmonaires. </li></ol><br><p>  Les algorithmes suivants seront considérés: </p><br><ol><li>  transformation de distance; </li><li>  la transformation du plus proche voisin, également appelée transformation d'entité; </li><li>  calcul des valeurs propres de la matrice de Hesse pour la segmentation d'objets 3D plats; </li><li>  segmentation des bassins versants. </li></ol></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr461329/">https://habr.com/ru/post/fr461329/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr461319/index.html">Que fait un game designer?</a></li>
<li><a href="../fr461321/index.html">Modèles génériques et de métaprogrammation: Go, Rust, Swift, D et autres</a></li>
<li><a href="../fr461323/index.html">Une explication accessible de l'algorithme d'effondrement de la fonction d'onde</a></li>
<li><a href="../fr461325/index.html">Victoire aux PHDays 9. Nous partageons les hacks de vie en trois parties. 3e partie</a></li>
<li><a href="../fr461327/index.html">Crise frontale?</a></li>
<li><a href="../fr461333/index.html">ITX5 mitap: JAVA en direct, magie Kotlin et amadou tomate</a></li>
<li><a href="../fr461339/index.html">Comment être piloté par les données. Dès le début</a></li>
<li><a href="../fr461341/index.html">Développement mobile hh.ru et où il vit</a></li>
<li><a href="../fr461345/index.html">Comment nous avons converti la chaleur humaine en électricité</a></li>
<li><a href="../fr461351/index.html">Kaléidoscope comme dans l'enfance</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>