<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚õµÔ∏è ‚úãüèª üç† "Eh bien, encore une fois, la station m√©t√©o"? Pas vraiment üíÉüèº üéÖ üë®‚Äçüé§</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="La station m√©t√©o propos√©e est bas√©e sur un ordinateur PIDP11 fait maison , compos√© d'une framboise avec un √©mulateur PDP-11 et d'un bo√Ætier avec un pa...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>"Eh bien, encore une fois, la station m√©t√©o"? Pas vraiment</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/446370/"><img src="https://habrastorage.org/webt/aw/wy/yu/awwyyuan47fvnwenytungq8clu8.jpeg"><br><br>  La station m√©t√©o propos√©e est bas√©e sur un ordinateur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">PIDP11</a> fait <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">maison</a> , compos√© d'une framboise avec un √©mulateur PDP-11 et d'un bo√Ætier avec un panneau avant avec des LED et des commutateurs actifs.  Mais malgr√© cela, la "framboise" a suffisamment de GPIO inoccup√©s pour connecter √©galement un capteur de pression et de temp√©rature. <br><br>  L'√©mulateur ex√©cute OS 2.11BSD, dans lequel le logiciel de la station m√©t√©o ¬´tourne¬ª.  Les donn√©es sont sorties vers deux √©mulateurs de terminal.  L'un d'eux - cool-retro-term - affiche des informations textuelles en gros caract√®res en utilisant l'art ASCII.  Le second - un √©mulateur de terminal graphique Tektronix 4010 avec un tube de stockage - affiche les courbes de pression et de temp√©rature. <a name="habracut"></a><br><br>  La m√©thode de connexion du capteur BME280 est d√©crite <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> : <br><br><pre><code class="plaintext hljs"> |  | GPIO    | | Raspberry Pi  | | ------------+--------------+-------------- VCC | 3,3  | P1-01 GND |  | P1-06 SCL | SCL  I2C | P1-05 SDA | SDA  I2C | P1-03</code> </pre> <br>  L'√©cran OLED illustr√© sur la photo ci-dessous est connect√© en parall√®le avec le capteur, mais une adresse diff√©rente lui est attribu√©e sur le bus I <sup>2</sup> C.  Si vous le souhaitez, vous n'avez pas du tout besoin d'installer un √©cran.  L'auteur a √©galement d√©fini un bouton pour l'arr√™t correct du syst√®me d'exploitation avant de couper l'alimentation. <br><br><img src="https://habrastorage.org/webt/zn/uj/p6/znujp611prwu14vttig0mwsiawy.jpeg"><br><br>  Pour faire fonctionner l'appareil, vous devez d'abord ajouter un nouvel utilisateur √† l'utilisateur en cours d'ex√©cution dans l'√©mulateur 2.11BSD comme <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ceci</a> : <br><br>  Connectez-vous en tant qu'utilisateur root.  Entrez la commande vipw pour d√©marrer l'√©diteur vi avec le fichier / etc / passwd <br><br>  Mettez la ligne dans le fichier: <br><br><pre> <code class="plaintext hljs">firstname::201:20:fullname:/home/firstname:/bin/tcsh</code> </pre> <br>  o√π pr√©nom et nom complet sont les noms d'utilisateur courts et complets. <br><br>  Quittez l'√©diteur, cr√©ez le dossier de d√©part de l'utilisateur: <br><br><pre> <code class="plaintext hljs">cd /home mkdir firstname chown firstname firstname</code> </pre> <br>  Copiez les fichiers .login et .cshrc dans ce dossier ' <br><br><pre> <code class="plaintext hljs"> cd /home/user cp .* /home/firstname cd /home/firstname chown firstname .*</code> </pre> <br>  Tapez vi .login et modifiez l'invite de ligne de commande en rempla√ßant la ligne correspondante par: <br><br><pre> <code class="plaintext hljs">set prompt='%n@%m:%c$ '</code> </pre> <br>  Quittez l'√©diteur.  D√©connectez-vous avec la commande logout, changez le mot de passe du nouvel utilisateur avec la commande passwd sous la racine, vous pouvez maintenant vous connecter en utilisant le nom d'utilisateur et le mot de passe du nouvel utilisateur. <br><br>  Apr√®s cela, il est n√©cessaire de d√©finir automatiquement la date et l'heure dans le syst√®me au d√©marrage (pour les informations ci-dessous, l'auteur remercie Jason Vanick et Johnny Billquist): <br><br>  Configurez d'abord le r√©seau et assurez-vous que le ping fonctionne.  Ensuite, juste avant la ligne ntpt dans le fichier /etc/rc.local, mettez la ligne: <br><br><pre> <code class="plaintext hljs">ntp -sf pool.ntp.org</code> </pre> <br>  Remplacez la derni√®re ligne du fichier /etc/ntp.conf par: <br><br><pre> <code class="plaintext hljs">server pool.ntp.org</code> </pre> <br>  Vous pouvez s√©lectionner n'importe quel autre serveur NTP.  Pour d√©finir le fuseau horaire, consultez la liste des fuseaux dans le fichier / usr / share / zoneinfo et y trouvez le nom de votre fuseau.  Connectez-vous en tant qu'utilisateur root et entrez les commandes: <br><br><pre> <code class="plaintext hljs">cd /etc mv localtime localtime.old ln -s /usr/share/zoneinfo/timezone localtime</code> </pre> <br>  L'op√©ration suivante consiste √† installer et configurer un programme qui vous permettra de transf√©rer la ligne de commande Raspbian s'ex√©cutant sur un v√©ritable "malink" vers la ligne de commande 2.11BSD ex√©cut√©e dans l'√©mulateur, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">comme ceci</a> : <br><br>  Dans Raspbian sous root, entrez la commande: <br><br><pre> <code class="plaintext hljs">sudo apt-get install rsh-server</code> </pre> <br>  Cr√©ez un fichier .rhosts dans le dossier de d√©part avec le contenu suivant: <br><br><pre> <code class="plaintext hljs">bsd_ip_address bsd_user_name</code> </pre> <br>  o√π bsd_ip_address est l'adresse IP de la machine virtuelle avec 2.11 BSD, et bsd_user_name est le nom de l'utilisateur en 2.11 BSD qui peut ex√©cuter des commandes sur une vraie ¬´framboise¬ª, par exemple: <br><br><pre> <code class="plaintext hljs">192.168.1.99 rene</code> </pre> <br>  D√©finissez les autorisations pour ce fichier, sinon rien ne fonctionnera: <br><br><pre> <code class="plaintext hljs">chmod 600 .rhosts</code> </pre> <br>  Allez dans l'√©mulateur, entrez 2.11 BSD en tant qu'utilisateur root et √©ditez / etc / hosts - ajoutez la ligne: <br><br><pre> <code class="plaintext hljs">remote_ip_address remote_full_name remote_nick_name</code> </pre> <br>  o√π remote_ip_address est l'adresse IP de la vraie ¬´framboise¬ª, et remote_full_name et remote_nick_name sont son nom de domaine et son alias, par exemple: <br><br><pre> <code class="plaintext hljs">192.168.1.103 pizerow.home.lan pizerow</code> </pre> <br>  Connectez-vous en utilisant le nom pr√©c√©demment d√©fini (bsd_user_name) et v√©rifiez si tout a fonctionn√©: <br><br><pre> <code class="plaintext hljs">rsh remote_nick_name -l pi -n ‚Äúls‚Äù</code> </pre> <br>  Vous venez d'ex√©cuter la commande ls de l'√©mulateur sur un vrai malink.  Si, au lieu de cela, un formulaire de saisie de mot de passe est apparu devant vous, cela signifie que quelque chose s'est mal pass√©. <br><br>  Essayez maintenant quelque chose de plus compliqu√©.  Entrez la commande: <br><br><pre> <code class="plaintext hljs">rsh remote_nick_name -l pi -n ‚Äúcat /sys/class/thermal/thermal_zone0/temp‚Äù</code> </pre> <br>  Dans le dossier rtest de ce r√©f√©rentiel, il y a un petit programme C qui montre comment utiliser popen pour obtenir des informations d'un programme particulier et les traiter de mani√®re √† obtenir une sortie lisible par l'homme dans 2.11BSD: <br><br><pre> <code class="plaintext hljs">rene@pdp11:rtest$ rtest **************************************************** * The CPU temperature on the pizerow is 42.2 deg C * **************************************************** rene@pdp11:rtest$</code> </pre> <br>  Vous venez de voir dans l'√©mulateur la temp√©rature du v√©ritable processeur sur lequel cet √©mulateur "tourne". <br><br>  T√©l√©chargez le script Python depuis le dossier weather / sensor de ce r√©f√©rentiel. <br><br>  Assurez-vous que le script fonctionne correctement dans pizerow distant et placez-le dans le dossier / home / pi / bin <br><br>  Ex√©cutez cool-retro-term et l'√©mulateur, entrez 2.11BSD en tant qu'utilisateur que vous venez de cr√©er et entrez les commandes: <br><br><pre> <code class="plaintext hljs">mkdir weather cd weather</code> </pre> <br>  D'une mani√®re ou d'une autre (par exemple, en utilisant FileZilla), faites glisser et d√©posez des fichiers du dossier weather / BSD du r√©f√©rentiel dans le dossier weather du syst√®me d'exploitation ex√©cut√© dans l'√©mulateur.  Entrez la commande m√©t√©o et le programme extraira les donn√©es du capteur et les affichera sous cette forme: <br><br><pre> <code class="plaintext hljs"> rene@pdp11:weather$ weather Contacting remote sensor... Data received, analyzing ... ************************************** The sensor reports the following data: Temperature 7.0 C Pressure 969.8 hPa Humidity 66.8 % ************************************** rene@pdp11:weather$</code> </pre> <br>  Si tout a fonctionn√©, cr√©ez le dossier dats dans le dossier ~ / weather, o√π weather2 peut stocker le journal: <br><br><pre> <code class="plaintext hljs">cd cd weather mkdir data weather2</code> </pre> <br>  Weather2 J'ai commenc√© chaque jour √† cr√©er dans le dossier ~ / weather / data par le fichier avec le nom correspondant √† la date, et √† y ajouter une ligne avec les donn√©es toutes les minutes.  Et sur le terminal, il affichera en continu les √©l√©ments suivants, mettant √† jour l'√©cran √©galement une fois par minute: <br><br><img src="https://habrastorage.org/webt/pp/bt/zk/ppbtzkw1rmufumlfz-ciivd1ffc.jpeg"><br><br>  Eh bien, Weather3 fonctionne de la m√™me mani√®re, n'affiche plus de temps et de pression.  Il utilise la biblioth√®que de mal√©dictions pour d√©placer le curseur. <br><br><img src="https://habrastorage.org/webt/vl/tv/a8/vltva8sjlqvyuq6byh3arhdhhye.jpeg"><br><br>  Essayez √©galement d'afficher les valeurs de temp√©rature et de pression des jours pr√©c√©dents de la m√™me mani√®re, et √©crivez √©galement un script pour obtenir des pr√©visions m√©t√©orologiques bas√©es sur ces donn√©es.  Bonne chance! <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Annexe 1</a> - installer et configurer cool-retro-term <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Annexe 2</a> - installation et configuration de l'√©mulateur de terminal graphique Tektronix 4010 </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr446370/">https://habr.com/ru/post/fr446370/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr446352/index.html">Protection sans protection</a></li>
<li><a href="../fr446354/index.html">Semaine de la s√©curit√© 14: ShadowHammer et cha√Æne d'approvisionnement</a></li>
<li><a href="../fr446362/index.html">3 qualit√©s cl√©s pour un chef de produit r√©ussi: Dmitry Orlov, chef de produit senior</a></li>
<li><a href="../fr446364/index.html">Blagues et r√©f√©rences des Simpsons en anglais √† expliquer</a></li>
<li><a href="../fr446366/index.html">ZX Spectrum 128k faites-le vous-m√™me. 2e partie</a></li>
<li><a href="../fr446372/index.html">Aimer les qu√™tes, aimer et retrouver vos donn√©es personnelles en public</a></li>
<li><a href="../fr446378/index.html">Le probl√®me du passage √† l'heure d'hiver et d'√©t√© pour une seule √©cole Skype</a></li>
<li><a href="../fr446380/index.html">H2 evolution - fonctions de fen√™tre, CTE, JSON / XML dans une base de donn√©es embarqu√©e</a></li>
<li><a href="../fr446384/index.html">Conseils pour d√©velopper de tr√®s gros projets dans Revit</a></li>
<li><a href="../fr446388/index.html">L'industrie p√©troli√®re et gazi√®re comme exemple pour les syst√®mes de cloud p√©riph√©riques</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>