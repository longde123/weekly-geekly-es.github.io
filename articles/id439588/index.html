<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üé• üßöüèº üë£ ESET menemukan versi baru dari DanaBot Trojan üèÜ üëèüèª üòû</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Trojan DanaBot modular yang berkembang pesat telah mengalami perubahan baru. Versi yang dirilis pada akhir Januari 2019 mengimplementasikan protokol k...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ESET menemukan versi baru dari DanaBot Trojan</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/eset/blog/439588/"> Trojan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">DanaBot</a> modular yang berkembang <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">pesat telah</a> mengalami perubahan baru.  Versi yang dirilis pada akhir Januari 2019 mengimplementasikan protokol komunikasi yang sama sekali baru yang menambahkan beberapa tingkat enkripsi pada komunikasi Trojan dan server C&amp;C-nya.  Selain itu, arsitektur DanaBot dan ID kampanye telah diubah. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/2r/-x/j0/2r-xj085tr128-hi_nkl5xix_fk.jpeg"></div><a name="habracut"></a><br><h4>  Evolusi DanaBot </h4><br>  Setelah <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">ditemukan</a> pada Mei 2018 sebagai bagian dari kampanye spam yang menargetkan Australia, DanaBot muncul dalam sejumlah serangan lain, termasuk kampanye spam di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Polandia, Italia, Jerman, Austria dan Ukraina</a> , serta <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Amerika Serikat</a> .  Dalam kampanye Eropa, fungsionalitas Trojan telah ditingkatkan dengan plugins baru dan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">kemampuan spamming</a> . <br><br>  Pada 25 Januari, kami menemukan file yang tidak dapat dieksekusi terkait dengan DanaBot dalam data telemetri.  Pemeriksaan lebih lanjut mengungkapkan bahwa file-file biner ini memang versi DanaBot, tetapi mereka menggunakan protokol komunikasi yang berbeda untuk berkomunikasi dengan server C&amp;C.  Sejak 26 Januari, operator Trojan telah berhenti merakit file biner dengan protokol lama. <br><br>  Pada saat penulisan, versi baru DanaBot didistribusikan dalam dua skenario: <br><br><ol><li>  sebagai "pembaruan" dikirim ke korban DanaBot; </li><li>  via email spam (di Polandia). </li></ol><br><h4>  Protokol komunikasi baru </h4><br>  Dalam protokol, yang digunakan hingga 25 Januari, paket tidak dienkripsi, seperti yang ditunjukkan pada Gambar 1. <br><br><img src="https://habrastorage.org/webt/b-/gk/hh/b-gkhhs8ao2zo0hc8f-gkegxw70.png"><br>  <i>Gambar 1. Paket capture menunjukkan protokol lama dengan data dalam bentuk tidak terenkripsi</i> <br><br>  Setelah selesai, DanaBot menggunakan algoritma enkripsi AES dan RSA dalam komunikasi dengan server C&amp;C.  Protokol komunikasi baru lebih kompleks karena menggunakan beberapa tingkat enkripsi, seperti yang ditunjukkan pada gambar di bawah ini. <br><br><img src="https://habrastorage.org/webt/yw/0g/p2/yw0gp28vvzyyhwda2docdtdlpsm.png"><br>  <i>Gambar 2. Skema protokol komunikasi DanaBot baru</i> <br><br>  Perubahan ini menghindari deteksi menggunakan tanda tangan jaringan yang ada dan membuatnya sulit untuk menulis aturan baru untuk deteksi intrusi dan sistem pencegahan.  Selain itu, tanpa akses ke kunci RSA yang sesuai, tidak mungkin untuk memecahkan kode paket yang dikirim atau diterima;  dengan demikian, file RSAP dari sistem analisis berbasis cloud (seperti <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">ANY.RUN</a> ) tidak cocok untuk penelitian. <br><br><img src="https://habrastorage.org/webt/un/et/ax/unetaxozodao8hdqd4b7rknum8s.png"><br>  <i>Gambar 3. Menangkap paket dengan protokol komunikasi baru</i> <br><br>  Setiap paket yang dikirim oleh klien memiliki header 24 (0x18) -byte: <br><br><img src="https://habrastorage.org/webt/td/ey/gk/tdeygk9my0uhayelwswdqx_bvhg.png"><br><br>  Untuk setiap paket, header diikuti oleh data paket yang dienkripsi oleh AES, kemudian nilai 4-byte yang menunjukkan ukuran shift AES, dan kemudian kunci AES, dienkripsi oleh RSA.  Semua paket dienkripsi dengan kunci AES yang berbeda. <br><br>  Respons server menggunakan format yang sama.  Tidak seperti versi sebelumnya, data paket di respons server tidak sesuai dengan struktur tertentu (dengan beberapa pengecualian). <br><br><h4>  Struktur paket data </h4><br>  Struktur data paket sebelumnya dijelaskan secara rinci oleh <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Proofpoint</a> pada Oktober 2018.  Dalam versi terbaru DanaBot, skema ini sedikit dimodifikasi, seperti yang ditunjukkan pada gambar di bawah ini. <br><br><img src="https://habrastorage.org/webt/hc/7c/y4/hc7cy4kstqughqsadg1vff-xdue.png"><br>  <i>Gambar 4. Perbandingan struktur data paket dalam versi lama dan baru DanaBot</i> <br><br><h4>  Perubahan Arsitektur DanaBot </h4><br>  Selain protokol komunikasi, DanaBot memiliki arsitektur yang sedikit berubah.  Versi trojan sebelumnya termasuk komponen yang mengunduh dan menjalankan modul utama.  Kemudian modul utama mengunduh dan menjalankan plugin dan konfigurasi. <br><br>  Pada versi terbaru, fungsi-fungsi ini dilakukan oleh bootloader baru, yang digunakan untuk mengunduh semua plugin bersama dengan modul utama.  Kegigihan dipastikan dengan mendaftarkan komponen bootloader sebagai layanan. <br><br><img src="https://habrastorage.org/webt/c2/by/_p/c2by_pcvcbrnmqztjyxwlcgqps8.png"><br>  <i>Gambar 5. Perbandingan arsitektur DanaBot versi lama dan baru</i> <br><br><h4>  Tim </h4><br>  Menurut analisis, komponen pemuat menggunakan perintah berikut: <br><br><ul><li>  0x12C - Halo.  Perintah pertama dikirim dari klien ke server </li><li>  0x12D - memuat komponen peluncur 32/64-bit </li><li>  0x12E - meminta daftar plugin dan file konfigurasi </li><li>  0x12F - memuat plugins / file konfigurasi </li></ul><br>  Plugin yang diunduh dan file konfigurasi dienkripsi dengan kunci AES yang diperoleh dari ID klien.  Selain itu, plugin diarsipkan dalam format ZIP menggunakan kompresi LZMA, sementara file konfigurasi diarsipkan menggunakan zlib. <br>  Perintah dengan ID 0x130-0x134 dikirim oleh modul utama: <br><br><ul><li>  0x130 - mentransfer informasi yang dikumpulkan ke server C &amp; C (misalnya, tangkapan layar komputer korban; data sistem) </li><li>  0x131 - mentransfer informasi yang dikumpulkan ke server C &amp; C (misalnya, daftar file di hard disk komputer yang terinfeksi) </li><li>  0x132 - meminta perintah lebih lanjut dari server C&amp;C.  Ada sekitar 30 perintah khas backdoors, termasuk meluncurkan plugin, mengumpulkan informasi sistem dan mengubah file dalam sistem klien </li><li>  0x133 - perbarui daftar server C&amp;C melalui proxy Tor </li><li>  0x134 - tujuan pastinya tidak diketahui, kemungkinan besar digunakan untuk komunikasi antara plug-in dan server C&amp;C </li></ul><br><h4>  Ubah ID Kampanye </h4><br>  Penelitian sebelumnya menunjukkan bahwa DanaBot didistribusikan di bawah ID yang berbeda. <br><br>  Dalam versi sebelumnya dari DanaBot, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sekitar 20 pengidentifikasi kampanye digunakan</a> .  Dalam versi terbaru, pengidentifikasi telah sedikit berubah.  Pada 5 Februari 2019, kami mengamati ID berikut: <br><br><ul><li>  ID = 2 tampaknya, versi uji yang melayani sejumlah kecil file konfigurasi, tanpa suntikan web </li><li>  ID = 3 didistribusikan secara aktif, ditargetkan pada pengguna di Polandia dan Italia, melayani semua file konfigurasi dan suntikan web untuk keperluan Polandia dan Italia </li><li>  ID = 5 melayani file konfigurasi untuk keperluan Australia </li><li>  ID = 7 hanya berlaku untuk Polandia, melayani suntikan web untuk tujuan Polandia </li><li>  ID = 9, ternyata, juga merupakan versi uji dengan distribusi terbatas dan tanpa penargetan khusus, ia melayani sejumlah file konfigurasi, tanpa suntikan web </li></ul><br><h4>  Kesimpulan </h4><br>  Pada tahun 2018, kami mengamati perkembangan DanaBot dalam hal <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">distribusi</a> dan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">fungsionalitas</a> .  Pada awal 2019, Trojan mengalami perubahan "internal", yang menunjukkan karya aktif penciptanya.  Pembaruan terbaru menunjukkan bahwa pencipta DanaBot berusaha untuk menghindari penemuan tingkat jaringan.  Ada kemungkinan bahwa penulis Trojan memperhatikan studi yang diterbitkan untuk segera membuat perubahan pada kode, di depan pengembang produk untuk keamanan. <br><br>  Produk ESET mendeteksi dan memblokir semua komponen dan plugin DanaBot.  Nama deteksi diberikan di bagian selanjutnya. <br><br><h4>  Indikator Kompromi (IoC) </h4><br>  <b>Server C&amp;C digunakan oleh versi baru DanaBot</b> <br><br> <code>84.54.37[.]102 <br> 89.144.25[.]243 <br> 89.144.25[.]104 <br> 178.209.51[.]211 <br> 185.92.222[.]238 <br> 192.71.249[.]51</code> <br> <br>  <b>Server untuk injeksi dan redirect web</b> <br><br> <code>47.74.249[.]106 <br> 95.179.227[.]160 <br> 185.158.249[.]144</code> <br> <br>  <b>Contoh Hash</b> <br><br>  Bangunan DanaBot baru dirilis secara berkala, sehingga kami hanya dapat memberikan sebagian hash: <br>  <code>98C70361EA611BA33EE3A79816A88B2500ED7844</code> Win32 / TrojanDropper.Danabot.O <br>  Bootloader (x86), ID = 3 <code>0DF17562844B7A0A0170C9830921C3442D59C73C</code> Win32 / Spy.Danabot.L <br>  Bootloader (x64), ID = 3 <code>B816E90E9B71C85539EA3BB897E4F234A0422F85</code> Win64 / Spy.Danabot.G <br>  Bootloader (x86), ID = 9 <code>5F085B19657D2511A89F3172B7887CE29FC70792</code> Win32 / Spy.Danabot.I <br>  Bootloader (x64), ID = 9 <code>4075375A08273E65C223116ECD2CEF903BA97B1E</code> Win64 / Spy.Danabot.F <br>  Modul utama (x86) <code>28139782562B0E4CAB7F7885ECA75DFCA5E1D570</code> Win32 / Spy.Danabot.K <br>  Modul utama (x64) <code>B1FF7285B49F36FE8D65E7B896FCCDB1618EAA4B</code> Win64 / Spy.Danabot.C <br><br>  <b>Plugin</b> <br><br>  RDPWrap <code>890B5473B419057F89802E0B6DA011B315F3EF94</code> Win32 / Spy.Danabot.H <br>  Stealer (x86) <code>E50A03D12DDAC6EA626718286650B9BB858B2E69</code> Win32 / Spy.Danabot.C <br>  Stealer (x64) <code>9B0EC454401023DF6D3D4903735301BA669AADD1</code> Win64 / Spy.Danabot.E <br>  Sniffer <code>DBFD8553C66275694FC4B32F9DF16ADEA74145E6</code> Win32 / Spy.Danabot.B <br>  VNC <code>E0880DCFCB1724790DFEB7DFE01A5D54B33D80B6</code> Win32 / Spy.Danabot.D <br>  TOR <code>73A5B0BEE8C9FB4703A206608ED277A06AA1E384</code> Win32 / Spy.Danabot.G </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id439588/">https://habr.com/ru/post/id439588/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id439576/index.html">Tinjauan luas wawancara Python. Kiat & Trik</a></li>
<li><a href="../id439578/index.html">Untuk pertanyaan transformasi dan operasi lainnya</a></li>
<li><a href="../id439580/index.html">Membuat Git untuk Windows berfungsi di ReactOS</a></li>
<li><a href="../id439584/index.html">Proyek energi sebagai memikirkan kembali pasokan daya portabel</a></li>
<li><a href="../id439586/index.html">Protokol SPBm sebagai dasar Extreme Automated Campus</a></li>
<li><a href="../id439590/index.html">Quals: Keamanan Cyber ‚Äã‚ÄãNasional Saudi dan Oman CTF 2019. WriteUp</a></li>
<li><a href="../id439592/index.html">Otomatisasi Kegiatan Etis</a></li>
<li><a href="../id439594/index.html">Anotasi Musim Semi: AOP Magic</a></li>
<li><a href="../id439596/index.html">Bagaimana saya mempercepat pemrosesan gambar di Android 15 kali</a></li>
<li><a href="../id439598/index.html">Microsoft berbicara tentang biaya dukungan berbayar untuk Windows 7</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>