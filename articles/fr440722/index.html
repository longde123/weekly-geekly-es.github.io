<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßì üöÑ üöµ Un peu de pratique de la programmation fonctionnelle dans Swift pour les d√©butants üéå üòå üë®üèΩ‚Äçü§ù‚Äçüë®üèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Je voudrais pr√©senter le concept de programmation fonctionnelle aux d√©butants de la mani√®re la plus simple, en soulignant certains de ses avantages pa...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Un peu de pratique de la programmation fonctionnelle dans Swift pour les d√©butants</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/440722/"><img src="https://habrastorage.org/webt/r4/cx/wi/r4cxwi9bjlhswlncf4ru1uslm4q.png"><br><br>  Je voudrais pr√©senter le concept de <i>programmation fonctionnelle aux</i> d√©butants de la mani√®re la plus simple, en soulignant certains de ses avantages parmi les nombreux autres qui rendront vraiment le code plus lisible et expressif.  J'ai ramass√© pour vous quelques d√©mos int√©ressantes qui sont sur le <code>Playground</code> sur <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">Github</a></b> . <br><br><h2>  Programmation fonctionnelle: d√©finition </h2><br>  Tout d'abord, la <i>programmation fonctionnelle</i> n'est pas un langage ou une syntaxe, mais tr√®s probablement un moyen de r√©soudre des probl√®mes en divisant des processus complexes en processus plus simples et leur composition ult√©rieure.  Comme son nom l'indique, ¬´ <i>Programmation fonctionnelle</i> ¬ª, l'unit√© de composition de cette approche est une <i>fonction</i> ;  et le but d'une telle <i>fonction</i> est d'√©viter de changer d'√©tat ou de valeurs en dehors de sa <code>scope)</code> . <br><br>  Dans <code>Swift</code> World, il y a toutes les conditions pour cela, car les <i>fonctions</i> sont ici des participants √† part enti√®re au processus de programmation comme des <i>objets,</i> et le probl√®me de la <code>mutation</code> est r√©solu au niveau du concept de <code>value</code> TYPES ( <code><font color="#0000FF">struct</font></code> structures et <code><font color="#0000FF">enum</font></code> √©num√©rations) qui aident √† g√©rer la mutabilit√© ( <code>mutation</code> ) et communiquer clairement comment et quand cela peut se produire. <br><br>  Cependant, <code>Swift</code> pas au sens plein du langage de <i>programmation fonctionnelle</i> , il ne vous oblige pas √† la <i>programmation fonctionnelle</i> , bien qu'il reconnaisse les avantages des approches <i>fonctionnelles</i> et trouve des moyens de les int√©grer. <br><br>  Dans cet article, nous allons nous concentrer sur l'utilisation des √©l√©ments int√©gr√©s de la <i>programmation fonctionnelle</i> dans <code>Swift</code> (c'est-√†-dire ¬´pr√™ts √† l'emploi¬ª) et comprendre comment vous pouvez les utiliser confortablement dans votre application. <br><a name="habracut"></a><br><h2>  Approches imp√©ratives et fonctionnelles: comparaison </h2><br>  Pour √©valuer l'approche <i>fonctionnelle</i> , comparons les solutions √† un probl√®me simple de deux mani√®res diff√©rentes.  La premi√®re solution est ¬´ <i>imp√©rative</i> ¬ª, dans laquelle le code change l'√©tat √† l'int√©rieur du programme. <br><br><pre> <code class="swift hljs"><span class="hljs-comment"><span class="hljs-comment">//Imperative Approach var numbers = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10] for i in 0..&lt;numbers.count { let timesTen = numbers[i] * 10 numbers[i] = timesTen } print(numbers) //[10, 20, 30, 40, 50, 60, 70, 80, 90, 100]</span></span></code> </pre><br>  Notez que nous manipulons les valeurs √† l'int√©rieur du tableau mutable nomm√© <code><font color="#0000FF">numbers</font></code> , puis l'imprimons sur la console.  En regardant ce code, essayez de r√©pondre aux questions suivantes dont nous discuterons dans un proche avenir: <br><br><ol><li>  Qu'essayez-vous de r√©aliser avec votre code? </li><li>  Que se passe-t-il si un autre <code>thread</code> tente d'acc√©der au tableau de <code><font color="#0000FF">numbers</font></code> pendant l'ex√©cution de votre code? </li><li>  Que se passe-t-il si vous souhaitez avoir acc√®s aux valeurs d'origine dans le tableau des <code><font color="#0000FF">numbers</font></code> ? </li><li>  Dans quelle mesure ce code peut-il √™tre test√©? </li></ol><br>  Examinons maintenant une approche alternative " <i>fonctionnelle</i> ": <br><br><pre> <code class="swift hljs"><span class="hljs-comment"><span class="hljs-comment">//Functional Approach let numbers = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10] extension Array where Element == Int { func timesTen() -&gt; [Int] { var output = [Int]() for num in self { output.append(num * 10) } return output } } let result = numbers.timesTen() print(numbers) //[1, 2, 3, 4, 5, 6, 7, 8, 9, 10] print(result) //[10, 20, 30, 40, 50, 60, 70, 80, 90, 100]</span></span></code> </pre><br>  Dans ce morceau de code, nous obtenons le m√™me r√©sultat sur la console, en abordant la solution au probl√®me d'une mani√®re compl√®tement diff√©rente.  Notez que cette fois notre tableau de <code><font color="#0000FF">numbers</font></code> est immuable gr√¢ce au mot cl√© <code><font color="#0000FF">let</font></code> .  Nous avons d√©plac√© le processus de multiplication des nombres du tableau de <code><font color="#0000FF">numbers</font></code> vers la m√©thode <code><font color="#0000FF">timesTen()</font></code> , qui se trouve dans l'extension d' <code><font color="#0000FF">extension</font></code> <code><font color="#0000FF">Array</font></code> .  Nous utilisons toujours une boucle <code><font color="#0000FF">for</font></code> et modifions une variable appel√©e <code><font color="#0000FF">output</font></code> , mais la <code>scope</code> cette variable n'est limit√©e que par cette m√©thode.  De m√™me, notre argument d'entr√©e <code><font color="#0000FF">self</font></code> est pass√© √† la m√©thode <code><font color="#0000FF">timesTen()</font></code> par valeur ( <code>by value</code> ), ayant la m√™me port√©e que la sortie variable de <code><font color="#0000FF">output</font></code> .  La m√©thode <code><font color="#0000FF">timesTen()</font></code> est appel√©e et nous pouvons imprimer sur la console √† la fois le tableau de <code><font color="#0000FF">numbers</font></code> origine et le r√©sultat du tableau de <code><font color="#0000FF">result</font></code> . <br>  Revenons √† nos 4 questions. <br><br>  <i>1. Qu'essayez-vous de r√©aliser avec votre code?</i> <br><br>  Dans notre exemple, nous effectuons une t√¢che tr√®s simple en multipliant les nombres dans le tableau de <code><font color="#0000FF">numbers</font></code> par <code><font color="#0000FF">10</font></code> . <br><br>  Avec une approche <i>imp√©rative</i> , pour obtenir une sortie, vous devez penser comme un ordinateur, en suivant les instructions de la boucle <code><font color="#0000FF">for</font></code> .  Dans ce cas, le code indique <code></code> vous obtenez le r√©sultat.  Avec l'approche <i>fonctionnelle</i> , ¬´ <code></code> ¬ª est ¬´ <code><font color="#0000FF">timesTen()</font></code> ¬ª dans la m√©thode <code><font color="#0000FF">timesTen()</font></code> .  √Ä condition que cette m√©thode ait √©t√© impl√©ment√©e ailleurs, vous ne pouvez vraiment voir que l'expression <code><font color="#0000FF">numbers.timesTen()</font></code> .  Un tel code montre clairement ce qui <code></code> r√©alis√© par ce code, et non <code></code> la t√¢che est r√©solue.  C'est ce qu'on appelle la <i>programmation d√©clarative</i> , et il est facile de deviner pourquoi une telle approche est int√©ressante.  <i>L'</i> approche <i>imp√©rative</i> permet au d√©veloppeur de comprendre le <code></code> code afin de d√©terminer <code></code> qu'il doit faire.  <i>L'</i> approche <i>fonctionnelle</i> par rapport √† l'approche <i>imp√©rative</i> est beaucoup plus ¬´expressive¬ª et offre au d√©veloppeur une occasion luxueuse de simplement supposer que la m√©thode fait ce qu'elle pr√©tend faire!  (√âvidemment, cette hypoth√®se ne s'applique qu'au code pr√©-v√©rifi√©). <br><br>  <i>2. Que se passe-t-il si un autre <code>thread</code> essaie d'acc√©der au tableau de <code><font color="#0000FF">numbers</font></code> pendant l'ex√©cution de votre code?</i> <br><br>  Les exemples pr√©sent√©s ci-dessus existent dans un espace compl√®tement isol√©, bien que dans un environnement multithread complexe, il est tout √† fait possible que deux <code>threads</code> tentent d'acc√©der simultan√©ment aux m√™mes ressources.  Dans le cas de l'approche <i>imp√©rative</i> , il est facile de voir que lorsqu'un autre <code>thread</code> a acc√®s au tableau de <code><font color="#0000FF">numbers</font></code> en cours d'utilisation, le r√©sultat sera dict√© par l'ordre dans lequel les <code>threads</code> acc√®dent au tableau de <code><font color="#0000FF">numbers</font></code> .  Cette situation est appel√©e <code>race condition</code> et peut entra√Æner un comportement impr√©visible et m√™me une instabilit√© et un crash de l'application. <br><br>  En comparaison, l'approche <i>fonctionnelle</i> n'a pas ¬´d'effets secondaires¬ª.  En d'autres termes, la sortie de la m√©thode de <code><font color="#0000FF">output</font></code> ne modifie aucune valeur stock√©e dans notre syst√®me et est d√©termin√©e uniquement par l'entr√©e.  Dans ce cas, tout thread ( <code>threads</code> ) ayant acc√®s au tableau de <code><font color="#0000FF">numbers</font></code> recevra TOUJOURS les m√™mes valeurs et son comportement sera stable et pr√©visible. <br><br>  3. Que se passe-t-il si vous souhaitez avoir acc√®s aux valeurs d'origine stock√©es dans le tableau de <code><font color="#0000FF">numbers</font></code> ? <br><br>  Il s'agit d'une continuation de notre discussion sur les ¬´effets secondaires¬ª.  De toute √©vidence, les changements d'√©tat ne sont pas suivis.  Par cons√©quent, avec l'approche <i>imp√©rative</i> , nous perdons l'√©tat initial de notre tableau de <code><font color="#0000FF">numbers</font></code> pendant le processus de conversion.  Notre solution, bas√©e sur l'approche <i>fonctionnelle</i> , enregistre le tableau de <code><font color="#0000FF">numbers</font></code> origine et g√©n√®re un nouveau tableau de <code><font color="#0000FF">result</font></code> avec les propri√©t√©s souhait√©es en sortie.  Il laisse le tableau de <code><font color="#0000FF">numbers</font></code> origine intact et adapt√© pour un traitement ult√©rieur. <br><br>  4. Dans quelle mesure ce code peut-il √™tre test√©? <br><br>  Puisque l'approche <i>fonctionnelle</i> d√©truit tous les ¬´effets secondaires¬ª, la fonctionnalit√© test√©e est compl√®tement √† l'int√©rieur de la m√©thode.  L'entr√©e de cette m√©thode ne sera JAMAIS modifi√©e, vous pouvez donc la tester plusieurs fois en utilisant la boucle autant de fois que vous le souhaitez, et vous obtiendrez TOUJOURS le m√™me r√©sultat.  Dans ce cas, le test est tr√®s simple.  En comparaison, tester la solution <i>Imperative</i> en boucle changera le d√©but de l'entr√©e et vous obtiendrez des r√©sultats compl√®tement diff√©rents apr√®s chaque it√©ration. <br><br><h2>  R√©sum√© des avantages </h2><br>  Comme nous l'avons vu √† partir d'un exemple tr√®s simple, l'approche <i>fonctionnelle</i> est une bonne chose si vous avez affaire √† un mod√®le de donn√©es car: <br><br><ul><li>  C'est d√©claratif </li><li>  Il corrige les probl√®mes li√©s aux threads comme les <code>race condition</code> concurrence et les blocages </li><li>  Il laisse l'√©tat inchang√©, qui peut √™tre utilis√© pour des transformations ult√©rieures. </li><li>  C'est facile √† tester. </li></ul><br>  Allons un peu plus loin dans l'apprentissage de la programmation <i>fonctionnelle</i> dans <code>Swift</code> .  Il suppose que les principaux ¬´acteurs¬ª sont des fonctions, et ils devraient √™tre principalement des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">objets de premi√®re classe</a> . <br><br><h2>  Fonctions de premi√®re classe et fonctions d'ordre sup√©rieur </h2><br>  Pour qu'une fonction soit de premi√®re classe, elle doit pouvoir √™tre d√©clar√©e comme variable.  Cela vous permet de g√©rer la fonction comme un TYPE normal de donn√©es et de l'ex√©cuter en m√™me temps.  Heureusement, dans <code>Swift</code> fonctions sont des objets de premi√®re classe, c'est-√†-dire qu'elles sont prises en charge en les passant comme arguments √† d'autres fonctions, en les renvoyant √† la suite d'autres fonctions, en les affectant √† des variables ou en les stockant dans des structures de donn√©es. <br><br>  Pour cette raison, nous avons d'autres fonctions dans <code>Swift</code> - des fonctions d'ordre sup√©rieur qui sont d√©finies comme des fonctions qui prennent une autre fonction en argument ou retournent une fonction.  Il y en a beaucoup: <code><font color="#0000FF">map</font></code> , <code><font color="#0000FF">filter</font></code> , <code><font color="#0000FF">reduce</font></code> , <code><font color="#0000FF">forEach</font></code> , <code><font color="#0000FF">flatMap</font></code> , <code><font color="#0000FF">compactMap</font></code> , <code><font color="#0000FF">sorted</font></code> , etc.  Les exemples les plus courants de fonctions d'ordre sup√©rieur sont <code><font color="#0000FF">map</font></code> , <code><font color="#0000FF">filter</font></code> et <code><font color="#0000FF">reduce</font></code> .  Ils ne sont pas globaux, ils sont tous ¬´attach√©s¬ª √† certains TYPES.  Ils fonctionnent sur tous les TYPES de <code><font color="#0000FF">Sequence</font></code> , y compris la <code><font color="#0000FF">Collection</font></code> , qui est repr√©sent√©e par des structures de donn√©es <code>Swift</code> telles qu'un <code><font color="#0000FF">Array</font></code> , un <code><font color="#0000FF">Dictionary</font></code> et un <code><font color="#0000FF">Set</font></code> .  Dans <code>Swift 5</code> , les fonctions d'ordre sup√©rieur fonctionnent √©galement avec un tout nouveau TYPE - <code><font color="#0000FF">Result</font></code> . <br><br><h2> <code><font color="#0000FF">map(_:)</font></code> </h2> <br>  Dans <code>Swift</code> <code><font color="#0000FF">map(_:)</font></code> prend une fonction comme param√®tre et convertit les valeurs d'un certain <code></code> fonction de cette fonction.  Par exemple, en appliquant <code><font color="#0000FF">map(_:)</font></code> √† un tableau de valeurs de <code><font color="#0000FF">Array</font></code> , nous appliquons une fonction de param√®tre √† chaque √©l√©ment du tableau d'origine et nous obtenons un tableau de <code><font color="#0000FF">Array</font></code> , mais √©galement les valeurs converties. <br><br><pre> <code class="swift hljs"><span class="hljs-comment"><span class="hljs-comment">//Functional Approach let numbers = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10] func timesTen(_ x:Int) -&gt; Int { return x * 10 } let result = numbers.map (timesTen) print(numbers) //[1, 2, 3, 4, 5, 6, 7, 8, 9, 10] print(result) //[10, 20, 30, 40, 50, 60, 70, 80, 90, 100]</span></span></code> </pre><br>  Dans le code ci-dessus, nous avons cr√©√© la fonction <code><font color="#0000FF">timesTen (_:Int)</font></code> , qui prend une valeur enti√®re <code><font color="#0000FF">Int</font></code> et renvoie la valeur enti√®re <code><font color="#0000FF">Int</font></code> multipli√©e par <code><font color="#0000FF">10</font></code> , et l'avons utilis√©e comme param√®tre d'entr√©e de notre fonction de <code><font color="#0000FF">map(_:)</font></code> ordre sup√©rieur <code><font color="#0000FF">map(_:)</font></code> , en l'appliquant √† notre tableau <code><font color="#0000FF">numbers</font></code> .  Nous avons obtenu le r√©sultat dont nous avons besoin dans le tableau de <code><font color="#0000FF">result</font></code> . <br><br>  Le nom de la fonction de param√®tre <code><font color="#0000FF">timesTen</font></code> pour les fonctions d'ordre sup√©rieur comme <code><font color="#0000FF">map(_:)</font></code> n'a pas d'importance, le <code></code> param√®tre d'entr√©e et la valeur de retour sont importants, c'est-√†-dire la signature <code><font color="#0000FF">(Int) -&gt; Int</font></code> param√®tre d'entr√©e de fonction.  Par cons√©quent, nous pouvons utiliser des fonctions anonymes dans <code><font color="#0000FF">map(_:)</font></code> - fermetures - sous n'importe quelle forme, y compris celles avec des noms d'arguments raccourcis <code><font color="#0000FF">$0</font></code> , <code><font color="#0000FF">$1</font></code> , etc. <br><br><pre> <code class="swift hljs"><span class="hljs-comment"><span class="hljs-comment">//Functional Approach let numbers = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10] let result = numbers.map { $0 * 10 } print(numbers) //[1, 2, 3, 4, 5, 6, 7, 8, 9, 10] print(result) //[10, 20, 30, 40, 50, 60, 70, 80, 90, 100]</span></span></code> </pre><br>  Si nous regardons la fonction <code><font color="#0000FF">map(_ :)</font></code> pour un <code><font color="#0000FF">Array</font></code> , cela pourrait ressembler √† ceci: <br><br><pre> <code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">map</span></span></span><span class="hljs-function">&lt;T&gt;</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> transform: </span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">(Element)</span></span></span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">T</span></span>) -&gt; [<span class="hljs-type"><span class="hljs-type">T</span></span>] { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> returnValue = [<span class="hljs-type"><span class="hljs-type">T</span></span>]() <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> item <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span> { returnValue.append(transform(item)) } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> returnValue }</code> </pre><br>  C'est un code imp√©ratif qui nous est familier, mais ce n'est plus un probl√®me de d√©veloppeur, c'est un probl√®me <code>Apple</code> , un probl√®me <code>Swift</code> .  L'impl√©mentation de la fonction <code><font color="#0000FF">map(_:)</font></code> sup√©rieur est optimis√©e par <code>Apple</code> en termes de performances, et nous, les d√©veloppeurs, avons la garantie de la fonctionnalit√© <code><font color="#0000FF">map(_:)</font></code> , de sorte que nous ne pouvons exprimer correctement avec l'argument de la fonction de <code><font color="#0000FF">transform</font></code> <code></code> nous voulons sans nous soucier de <code></code> il sera mis en ≈ìuvre.  En cons√©quence, nous obtenons du code parfaitement lisible sous la forme d'une seule ligne, qui fonctionnera mieux et plus rapidement. <br><br><pre> <code class="swift hljs"><span class="hljs-comment"><span class="hljs-comment">//Functional Approach let possibleNumbers = ["1", "2", "three", "///4///", "5"] let mapped = possibleNumbers.map {str in Int(str) } print (mapped) // [Optional(1), Optional(2), nil, nil, Optional(5)]</span></span></code> </pre><br>  Le <code></code> renvoy√© par la fonction de param√®tre peut ne pas co√Øncider avec le <code></code> √©l√©ments de la collection d'origine. <br><br>  Dans le code ci-dessus, nous avons des entiers <code><font color="#0000FF">possibleNumbers</font></code> , repr√©sent√©s sous forme de cha√Ænes, et nous voulons les convertir en entiers de <code></code> <code><font color="#0000FF">Int</font></code> , en utilisant l'initialiseur disponible <code><font color="#0000FF">Int(_ :String)</font></code> repr√©sent√© par la fermeture <code><font color="#0000FF">{ str in Int(str) }</font></code> .  Nous faisons cela en utilisant <code><font color="#0000FF">map(_:)</font></code> et obtenons un tableau <code><font color="#0000FF">mapped</font></code> de <code></code> <code><font color="#0000FF">Optional</font></code> comme sortie: <br><br><img src="https://habrastorage.org/webt/43/mg/hd/43mghd5aphvgnytu06eos4zhxos.png"><br><br>  Nous n'avons <code></code> convertir <code></code> √©l√©ments de notre tableau <code><font color="#0000FF">possibleNumbers</font></code> en nombres entiers.En cons√©quence, une partie a re√ßu la valeur <code><font color="#0000FF">nil</font></code> , indiquant l'impossibilit√© de convertir la <code><font color="#0000FF">String</font></code> en un entier <code><font color="#0000FF">Int</font></code> , et l'autre partie transform√©e en <code><font color="#0000FF">Optionals</font></code> , qui ont des valeurs: <br><br><pre> <code class="swift hljs"><span class="hljs-built_in"><span class="hljs-built_in">print</span></span> (mapped) <span class="hljs-comment"><span class="hljs-comment">// [Optional(1), Optional(2), nil, nil, Optional(5)]</span></span></code> </pre><br><h2> <code><font color="#0000FF">compactMap(_ :)</font></code> </h2> <br>  Si la fonction de param√®tre transmise √† la fonction d'ordre sup√©rieur a une valeur <code><font color="#0000FF">Optional</font></code> √† la sortie, il peut √™tre plus utile d'utiliser une autre fonction d'un ordre sup√©rieur, de signification similaire - <code><font color="#0000FF">compactMap(_ :)</font></code> , qui fait la m√™me chose que <code><font color="#0000FF">map(_:)</font></code> , mais ¬´√©tend¬ª en outre les valeurs re√ßues √† la sortie <code><font color="#0000FF">Optional</font></code> et supprime les valeurs <code><font color="#0000FF">nil</font></code> de la collection. <br><br><img src="https://habrastorage.org/webt/ie/a8/ls/iea8lshgmocoqytj8horz--kx0k.png"><br><br>  Dans ce cas, nous obtenons un tableau de TYPE <code><font color="#0000FF">compactMapped</font></code> <code><font color="#0000FF">[Int]</font></code> , mais peut-√™tre plus petit: <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> possibleNumbers = [<span class="hljs-string"><span class="hljs-string">"1"</span></span>, <span class="hljs-string"><span class="hljs-string">"2"</span></span>, <span class="hljs-string"><span class="hljs-string">"three"</span></span>, <span class="hljs-string"><span class="hljs-string">"///4///"</span></span>, <span class="hljs-string"><span class="hljs-string">"5"</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> compactMapped = possibleNumbers.compactMap(<span class="hljs-type"><span class="hljs-type">Int</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>) <span class="hljs-built_in"><span class="hljs-built_in">print</span></span> (compactMapped) <span class="hljs-comment"><span class="hljs-comment">// [1, 2, 5]</span></span></code> </pre><br><img src="https://habrastorage.org/webt/wl/wf/ae/wlwfaep3tzyxrennftqqdtwezb8.png"><br><br>  Chaque fois que vous utilisez l' <code><font color="#0000FF">init?()</font></code> Comme fonction de transformation, vous devrez utiliser <code><font color="#0000FF">compactMap(_ :)</font></code> : <br><br><pre> <code class="swift hljs"><span class="hljs-comment"><span class="hljs-comment">// Validate URLs let strings = ["https://demo0989623.mockable.io/car/1", "https://i.imgur.com/Wm1xcNZ.jpg"] let validateURLs = strings.compactMap(URL.init) // Separate Numbers and Operations let mathString: String = "12-37*2/5+44" let numbers1 = mathString.components(separatedBy: ["-", "*", "+", "/"]).compactMap(Int.init) print(numbers1) // [12, 37, 2, 5, 44]</span></span></code> </pre><br>  Je dois dire qu'il y a plus qu'assez de raisons d'utiliser la fonction <code><font color="#0000FF">compactMap(_ :)</font></code> ordre <code><font color="#0000FF">compactMap(_ :)</font></code> .  <code>Swift</code> ¬´loves¬ª Valeurs <code><font color="#0000FF">Optional</font></code> , elles peuvent √™tre obtenues non seulement en utilisant l' <code>failable</code> ¬´ <code>failable</code> ¬ª <code><font color="#0000FF">init?()</font></code> , Mais aussi en utilisant le <code><font color="#0000FF">as?</font></code>  <code></code> "Casting": <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> views = [innerView,shadowView,logoView] <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> imageViews = views.compactMap{$<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">as</span></span>? <span class="hljs-type"><span class="hljs-type">UIImageView</span></span>}</code> </pre><br>  ... et l' <code><font color="#0000FF">try?</font></code>  lors du traitement des erreurs lanc√©es par certaines m√©thodes.  Je dois dire <code>Apple</code> craint que l'utilisation d' <code><font color="#0000FF">try?</font></code>  conduit tr√®s souvent au double <code><font color="#0000FF">Optional</font></code> et dans <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Swift 5</a> ne laisse plus qu'un seul niveau <code><font color="#0000FF">Optional</font></code> apr√®s avoir appliqu√© l' <code><font color="#0000FF">try?</font></code>  . <br><br>  Il existe une autre fonction similaire au nom du <code><font color="#0000FF">flatMap(_ :)</font></code> ordre <code><font color="#0000FF">flatMap(_ :)</font></code> , dont un peu plus bas. <br><br>  Parfois, pour utiliser la <code><font color="#0000FF">map(_:)</font></code> fonction d'ordre sup√©rieur <code><font color="#0000FF">map(_:)</font></code> , il est utile d'utiliser la m√©thode <code><font color="#0000FF">zip (_:, _:)</font></code> pour cr√©er une s√©quence de paires √† partir de deux s√©quences diff√©rentes. <br><br>  Supposons que nous ayons une <code><font color="#0000FF">view</font></code> sur laquelle plusieurs points sont repr√©sent√©s, reli√©s entre eux et formant une ligne bris√©e: <br><br><img src="https://habrastorage.org/webt/gj/ut/_3/gjut_3xu92asnbvjvibucndse5o.png"><br><br>  Nous devons construire une autre ligne bris√©e reliant les points m√©dians des segments de la ligne bris√©e d'origine: <br><br><img src="https://habrastorage.org/webt/zv/hr/ke/zvhrkexsungckflo4orcpnkkm7e.png"><br><br>  Pour calculer le milieu d'un segment, nous devons avoir les coordonn√©es de deux points: le courant et le suivant.  Pour ce faire, nous pouvons cr√©er une s√©quence compos√©e de paires de points - le courant et le suivant - en utilisant la m√©thode <code><font color="#0000FF">zip (_:, _:)</font></code> <code><font color="#0000FF">points.dropFirst()</font></code> <code><font color="#0000FF">zip (_:, _:)</font></code> , dans laquelle nous utiliserons le tableau de points de d√©part et le tableau des <code><font color="#0000FF">points</font></code> suivants.dropFirst <code><font color="#0000FF">points.dropFirst()</font></code> : <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> pairs = <span class="hljs-built_in"><span class="hljs-built_in">zip</span></span> (points,points.<span class="hljs-built_in"><span class="hljs-built_in">dropFirst</span></span>()) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> averagePoints = pairs.<span class="hljs-built_in"><span class="hljs-built_in">map</span></span> { <span class="hljs-type"><span class="hljs-type">CGPoint</span></span>(x: ($<span class="hljs-number"><span class="hljs-number">0</span></span>.x + $<span class="hljs-number"><span class="hljs-number">1</span></span>.x) / <span class="hljs-number"><span class="hljs-number">2</span></span>, y: ($<span class="hljs-number"><span class="hljs-number">0</span></span>.y + $<span class="hljs-number"><span class="hljs-number">1</span></span>.y) / <span class="hljs-number"><span class="hljs-number">2</span></span> )}</code> </pre><br>  Avec une telle s√©quence, nous calculons tr√®s facilement les points m√©dians √† l'aide de la <code><font color="#0000FF">map(_:)</font></code> fonction d'ordre sup√©rieur <code><font color="#0000FF">map(_:)</font></code> et les affichons sur le graphique. <br><br><h2> <code><font color="#0000FF">filter (_:)</font></code> </h2> <br>  Dans <code>Swift</code> , le <code><font color="#0000FF">filter (_:)</font></code> fonction d'ordre sup√©rieur <code><font color="#0000FF">filter (_:)</font></code> est disponible pour la plupart des <code></code> lesquels la fonction <code><font color="#0000FF">map(_:)</font></code> est disponible.  Vous pouvez filtrer toutes les <code><font color="#0000FF">Sequence</font></code> s√©quences avec un <code><font color="#0000FF">filter (_:)</font></code> , c'est √©vident!  La m√©thode <code><font color="#0000FF">filter (_:)</font></code> prend une autre fonction comme param√®tre, qui est une condition pour chaque √©l√©ment de la s√©quence, et si la condition est remplie, alors l'√©l√©ment est inclus dans le r√©sultat et sinon, il n'est pas inclus.  Cette "autre fonction" prend une seule valeur - un √©l√©ment de la s√©quence <code><font color="#0000FF">Sequence</font></code> - et renvoie un <code><font color="#0000FF">Bool</font></code> , le soi-disant pr√©dicat. <br><br>  Par exemple, pour les tableaux matriciels, le <code><font color="#0000FF">filter (_:)</font></code> fonction d'ordre sup√©rieur <code><font color="#0000FF">filter (_:)</font></code> applique la fonction de pr√©dicat et renvoie un autre tableau compos√© uniquement des √©l√©ments du tableau d'origine pour lesquels la fonction de pr√©dicat d'entr√©e renvoie <code><font color="#0000FF">true</font></code> . <br><br><pre> <code class="swift hljs"><span class="hljs-comment"><span class="hljs-comment">//Functional Approach let numbers = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10] let filted = numbers.filter{$0 % 2 == 0} //[2, 4, 6, 8, 10]</span></span></code> </pre><br>  Ici, le <code><font color="#0000FF">filter (_:)</font></code> fonction d'ordre sup√©rieur <code><font color="#0000FF">filter (_:)</font></code> prend chaque √©l√©ment du tableau de <code><font color="#0000FF">numbers</font></code> (repr√©sent√© par <code><font color="#0000FF">$0</font></code> ) et v√©rifie si cet √©l√©ment est un nombre pair.  S'il s'agit d'un nombre pair, les √©l√©ments du tableau de <code><font color="#0000FF">numbers</font></code> tombent dans le nouveau tableau <code><font color="#0000FF">filted</font></code> , sinon non.  Dans une forme d√©clarative, nous avons inform√© le programme <code></code> nous voulons obtenir au lieu de nous soucier de <code></code> nous devons le faire. <br><br>  Je vais donner un autre exemple d'utilisation du <code><font color="#0000FF">filter (_:)</font></code> fonction d'ordre sup√©rieur <code><font color="#0000FF">filter (_:)</font></code> pour obtenir uniquement les <code><font color="#0000FF">20</font></code> premiers nombres de Fibonacci pairs avec des valeurs <code><font color="#0000FF">&lt; 4000</font></code> : <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> fibonacci = sequence(first: (<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>), next: { ($<span class="hljs-number"><span class="hljs-number">1</span></span>, $<span class="hljs-number"><span class="hljs-number">0</span></span> + $<span class="hljs-number"><span class="hljs-number">1</span></span>) }) .<span class="hljs-keyword"><span class="hljs-keyword">prefix</span></span>(<span class="hljs-number"><span class="hljs-number">20</span></span>).<span class="hljs-built_in"><span class="hljs-built_in">map</span></span>{$<span class="hljs-number"><span class="hljs-number">0.0</span></span>} .<span class="hljs-built_in"><span class="hljs-built_in">filter</span></span> {$<span class="hljs-number"><span class="hljs-number">0</span></span> % <span class="hljs-number"><span class="hljs-number">2</span></span> == <span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; $<span class="hljs-number"><span class="hljs-number">0</span></span> &lt; <span class="hljs-number"><span class="hljs-number">4000</span></span>} <span class="hljs-built_in"><span class="hljs-built_in">print</span></span> (fibonacci) <span class="hljs-comment"><span class="hljs-comment">// [0, 2, 8, 34, 144, 610, 2584]</span></span></code> </pre><br>  Nous obtenons une s√©quence de tuples compos√©e de deux √©l√©ments de la s√©quence de Fibonacci: le n-√®me et (n + 1) -th: <br><br><pre> <code class="swift hljs">(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>), (<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>), (<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>), (<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>), (<span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>) ‚Ä¶</code> </pre><br>  Pour un traitement ult√©rieur, nous limitons le nombre d'√©l√©ments aux vingt et uni√®mes √©l√©ments en utilisant le <code><font color="#0000FF">prefix (20)</font></code> et prenons le <code><font color="#0000FF">0</font></code> √©l√©ment du tuple g√©n√©r√© en utilisant la <code><font color="#0000FF">map {$0.0 }</font></code> , qui correspondra √† la s√©quence de Fibonacci commen√ßant par <code><font color="#0000FF">0</font></code> : <br><br><pre> <code class="swift hljs"><span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, <span class="hljs-number"><span class="hljs-number">21</span></span>, <span class="hljs-number"><span class="hljs-number">34</span></span>, <span class="hljs-number"><span class="hljs-number">55</span></span>, <span class="hljs-number"><span class="hljs-number">89</span></span>, <span class="hljs-number"><span class="hljs-number">144</span></span>, <span class="hljs-number"><span class="hljs-number">233</span></span>, <span class="hljs-number"><span class="hljs-number">377</span></span>, <span class="hljs-number"><span class="hljs-number">610</span></span>, <span class="hljs-number"><span class="hljs-number">987</span></span>, <span class="hljs-number"><span class="hljs-number">1597</span></span>, <span class="hljs-number"><span class="hljs-number">2584</span></span>,...</code> </pre><br>  Nous pourrions prendre le <code><font color="#0000FF">1</font></code> √©l√©ment du tuple form√© en utilisant la <code><font color="#0000FF">map {$0.1 }</font></code> , ce qui correspondrait √† la s√©quence de Fibonacci commen√ßant par <code><font color="#0000FF">1</font></code> : <br><br><pre> <code class="swift hljs"><span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, <span class="hljs-number"><span class="hljs-number">21</span></span>, <span class="hljs-number"><span class="hljs-number">34</span></span>, <span class="hljs-number"><span class="hljs-number">55</span></span>, <span class="hljs-number"><span class="hljs-number">89</span></span>, <span class="hljs-number"><span class="hljs-number">144</span></span>, <span class="hljs-number"><span class="hljs-number">233</span></span>, <span class="hljs-number"><span class="hljs-number">377</span></span>, <span class="hljs-number"><span class="hljs-number">610</span></span>, <span class="hljs-number"><span class="hljs-number">987</span></span>, <span class="hljs-number"><span class="hljs-number">1597</span></span>, <span class="hljs-number"><span class="hljs-number">2584</span></span>,...</code> </pre><br>  Nous obtenons les √©l√©ments dont nous avons besoin en utilisant le <code><font color="#0000FF">filter {$0 % 2 == 0 &amp;&amp; $0 &lt; 4000}</font></code> fonction d'ordre sup√©rieur <code><font color="#0000FF">filter {$0 % 2 == 0 &amp;&amp; $0 &lt; 4000}</font></code> , qui retourne un tableau d'√©l√©ments de s√©quence qui satisfont le pr√©dicat donn√©.  Dans notre cas, ce sera un tableau d'entiers <code><font color="#0000FF">[Int]</font></code> : <br><br><pre> <code class="swift hljs">[<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">34</span></span>, <span class="hljs-number"><span class="hljs-number">144</span></span>, <span class="hljs-number"><span class="hljs-number">610</span></span>, <span class="hljs-number"><span class="hljs-number">2584</span></span>]</code> </pre><br>  Il existe un autre exemple utile d'utilisation du <code><font color="#0000FF">filter (_:)</font></code> pour une <code><font color="#0000FF">Collection</font></code> . <br><br>  J'√©tais confront√© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">√† un vrai probl√®me</a> , lorsque vous avez un tableau d' <code><font color="#0000FF">images</font></code> qui s'affiche √† l'aide de <code><font color="#0000FF">CollectionView</font></code> , et en utilisant la technologie <code>Drag &amp; Drop</code> , vous pouvez collecter un tas d'images et les d√©placer partout, y compris en les d√©posant dans " poubelle. " <br><br><img src="https://habrastorage.org/webt/0s/-u/ks/0s-ukstskzfumukk9geirokdl-w.png"><br><br>  Dans ce cas, le tableau d'index <code><font color="#0000FF">removedIndexes</font></code> d√©vers√©es dans la ¬´poubelle¬ª est fixe, et vous devez cr√©er un nouveau tableau d'images, √† l'exclusion de ceux dont les index sont dans le tableau <code><font color="#0000FF">removedIndexes</font></code> .  Supposons que nous ayons un tableau d' <code><font color="#0000FF">images</font></code> entiers qui imite les images, et un tableau d'indices de ces entiers <code><font color="#0000FF">removedIndexes</font></code> qui doivent √™tre supprim√©s.  Nous utiliserons le <code><font color="#0000FF">filter (_:)</font></code> pour r√©soudre notre probl√®me: <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> images = [<span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">22</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-number"><span class="hljs-number">16</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> removedIndexes = [<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">5</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">6</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> images1 = images .enumerated() .<span class="hljs-built_in"><span class="hljs-built_in">filter</span></span> { !removedIndexes.<span class="hljs-built_in"><span class="hljs-built_in">contains</span></span>($<span class="hljs-number"><span class="hljs-number">0</span></span>.offset) } .<span class="hljs-built_in"><span class="hljs-built_in">map</span></span> { $<span class="hljs-number"><span class="hljs-number">0</span></span>.element } <span class="hljs-built_in"><span class="hljs-built_in">print</span></span> (images1) <span class="hljs-comment"><span class="hljs-comment">// [22, 14, 16, 9]</span></span></code> </pre><br>  La m√©thode <code><font color="#0000FF">enumerated()</font></code> renvoie une s√©quence de tuples compos√©e d'index de <code><font color="#0000FF">offset</font></code> et de valeurs d' <code><font color="#0000FF">element</font></code> d'un tableau.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ensuite, nous appliquons un filtre </font></font><code><font color="#0000FF">filter</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√† la s√©quence r√©sultante de tuples, ne laissant que ceux dont l'index n'est </font></font><code><font color="#0000FF">$0.offset</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pas contenu dans le tableau </font></font><code><font color="#0000FF">removedIndexes</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. L'√©tape suivante, nous s√©lectionnons la valeur dans le tuple </font></font><code><font color="#0000FF">$0.element</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et obtenons le tableau dont nous avons besoin </font></font><code><font color="#0000FF">images1</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br><br><h2> <code><font color="#0000FF">reduce (_:, _:)</font></code> </h2> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La m√©thode est </font></font><code><font color="#0000FF">reduce (_:, _:)</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√©galement disponible pour la plupart des </font></font><code></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">personnes </font></font><code><font color="#0000FF">map(_:)</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et des </font><font style="vertical-align: inherit;">m√©thodes disponibles </font></font><code><font color="#0000FF">filter (_:)</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">La m√©thode </font></font><code><font color="#0000FF">reduce (_:, _:)</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬´r√©duit¬ª la s√©quence </font></font><code><font color="#0000FF">Sequence</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√† une seule valeur cumul√©e et a deux param√®tres. </font><font style="vertical-align: inherit;">Le premier param√®tre est la valeur d'accumulation de d√©part et le deuxi√®me param√®tre est une fonction qui combine la valeur d'accumulation avec l'√©l√©ment de s√©quence </font></font><code><font color="#0000FF">Sequence</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pour obtenir une nouvelle valeur d'accumulation. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La fonction de param√®tre d'entr√©e est appliqu√©e √† chaque √©l√©ment de la s√©quence </font></font><code><font color="#0000FF">Sequence</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, l'un apr√®s l'autre, jusqu'√† ce qu'il atteigne la fin et cr√©e la valeur cumul√©e finale.</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> sum = <span class="hljs-type"><span class="hljs-type">Array</span></span> (<span class="hljs-number"><span class="hljs-number">1</span></span>...<span class="hljs-number"><span class="hljs-number">100</span></span>).<span class="hljs-built_in"><span class="hljs-built_in">reduce</span></span>(<span class="hljs-number"><span class="hljs-number">0</span></span>, +)</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ceci est un exemple trivial classique d'utilisation d'une fonction d'ordre sup√©rieur </font></font><code><font color="#0000FF">reduce (_:, _:)</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- compter la somme des √©l√©ments d'un tableau </font></font><code><font color="#0000FF">Array</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br><br><pre> <code class="swift hljs">    <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> +<span class="hljs-number"><span class="hljs-number">1</span></span> = <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> + <span class="hljs-number"><span class="hljs-number">1</span></span> = <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> + <span class="hljs-number"><span class="hljs-number">3</span></span> = <span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> + <span class="hljs-number"><span class="hljs-number">6</span></span> = <span class="hljs-number"><span class="hljs-number">10</span></span> . . . . . . . . . . . . . . . . . . . <span class="hljs-number"><span class="hljs-number">100</span></span> <span class="hljs-number"><span class="hljs-number">4950</span></span> <span class="hljs-number"><span class="hljs-number">100</span></span> <span class="hljs-number"><span class="hljs-number">4950</span></span> + <span class="hljs-number"><span class="hljs-number">100</span></span> = <span class="hljs-number"><span class="hljs-number">5050</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En utilisant la fonction, </font></font><code><font color="#0000FF">reduce (_:, _:)</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nous pouvons tr√®s simplement calculer la somme des nombres de Fibonacci qui satisfont une certaine condition:</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> fibonacci = sequence(first: (<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>), next: { ($<span class="hljs-number"><span class="hljs-number">1</span></span>, $<span class="hljs-number"><span class="hljs-number">0</span></span> + $<span class="hljs-number"><span class="hljs-number">1</span></span>) }) .<span class="hljs-keyword"><span class="hljs-keyword">prefix</span></span>(<span class="hljs-number"><span class="hljs-number">20</span></span>).<span class="hljs-built_in"><span class="hljs-built_in">map</span></span>{$<span class="hljs-number"><span class="hljs-number">0.0</span></span>} .<span class="hljs-built_in"><span class="hljs-built_in">filter</span></span> {$<span class="hljs-number"><span class="hljs-number">0</span></span> % <span class="hljs-number"><span class="hljs-number">2</span></span> == <span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; $<span class="hljs-number"><span class="hljs-number">0</span></span> &lt; <span class="hljs-number"><span class="hljs-number">4000</span></span>} <span class="hljs-built_in"><span class="hljs-built_in">print</span></span> (fibonacci) <span class="hljs-comment"><span class="hljs-comment">// [0, 2, 8, 34, 144, 610, 2584] print(fibonacci.reduce(0,+)) // 3382</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mais il existe des applications plus int√©ressantes d'une fonction d'ordre sup√©rieur </font></font><code><font color="#0000FF">reduce (_:, _:)</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Par exemple, nous pouvons d√©terminer tr√®s simplement et de mani√®re concise un param√®tre tr√®s important pour </font></font><code><font color="#0000FF">UIScrollView</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- la taille de la zone "scrollable" </font></font><code><font color="#0000FF">contentSize</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- en fonction de sa taille </font></font><code><font color="#0000FF">subviews</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> scrollView = <span class="hljs-type"><span class="hljs-type">UIScrollView</span></span>() scrollView.addSubview(<span class="hljs-type"><span class="hljs-type">UIView</span></span>(frame: <span class="hljs-type"><span class="hljs-type">CGRect</span></span>(x: <span class="hljs-number"><span class="hljs-number">300.0</span></span>, y: <span class="hljs-number"><span class="hljs-number">0.0</span></span>, width: <span class="hljs-number"><span class="hljs-number">200</span></span>, height: <span class="hljs-number"><span class="hljs-number">300</span></span>))) scrollView.addSubview(<span class="hljs-type"><span class="hljs-type">UIView</span></span>(frame: <span class="hljs-type"><span class="hljs-type">CGRect</span></span>(x: <span class="hljs-number"><span class="hljs-number">100.0</span></span>, y: <span class="hljs-number"><span class="hljs-number">0.0</span></span>, width: <span class="hljs-number"><span class="hljs-number">300</span></span>, height: <span class="hljs-number"><span class="hljs-number">600</span></span>))) scrollView.contentSize = scrollView.subviews .<span class="hljs-built_in"><span class="hljs-built_in">reduce</span></span>(<span class="hljs-type"><span class="hljs-type">CGRect</span></span>.zero,{$<span class="hljs-number"><span class="hljs-number">0</span></span>.union($<span class="hljs-number"><span class="hljs-number">1</span></span>.frame)}) .size <span class="hljs-comment"><span class="hljs-comment">// (500.0, 600.0)</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dans cette d√©mo, la valeur accumul√©e est </font></font><code></code> <code><font color="#0000FF">GCRect</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, et l'op√©ration d'accumulation est l'op√©ration de combinaison des </font></font><code><font color="#0000FF">union</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rectangles qui sont les </font></font><code><font color="#0000FF">frame</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n√¥tres </font></font><code><font color="#0000FF">subviews</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Malgr√© le fait qu'une fonction d'ordre sup√©rieur </font></font><code><font color="#0000FF">reduce (_:, _:)</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">assume un caract√®re cumulatif, elle peut √™tre utilis√©e dans une perspective compl√®tement diff√©rente. </font><font style="vertical-align: inherit;">Par exemple, pour diviser un tuple en parties dans un tableau de tuples:</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-comment"><span class="hljs-comment">// Separate Tuples let arr = [("one", 1), ("two", 2), ("three", 3), ("four", 4)] let (arr1, arr2) = arr.reduce(([], [])) { ($0.0 + [$1.0], $0.1 + [$1.1]) } print(arr1) // ["one", "two", "three", "four"] print(arr2) // [1, 2, 3, 4]</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Swift a </font></font><code>4.2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">introduit un nouveau type de fonction d'ordre sup√©rieur </font></font><code><font color="#0000FF">reduce (into:, _:)</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">La m√©thode </font></font><code><font color="#0000FF">reduce (into:, _:)</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">est pr√©f√©rable en termes d'efficacit√© par rapport √† la m√©thode </font></font><code><font color="#0000FF">reduce (:, :)</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">si </font></font><code>COW (copy-on-write)</code> <code></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, par exemple, </font></font><code><font color="#0000FF">Array</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ou est </font><font style="vertical-align: inherit;">utilis√©e comme structure r√©sultante </font></font><code><font color="#0000FF">Dictionary</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il peut √™tre utilis√© efficacement pour supprimer les valeurs correspondantes dans un tableau d'entiers:</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-comment"><span class="hljs-comment">// Remove duplicates let arrayInt = [1,1,2,6,6,7,2,9,7].reduce(into: []) { !$0.contains($1) ? $0.append($1) : () } // [1, 2, 6, 7, 9]</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ... ou lors du comptage du nombre d'√©l√©ments diff√©rents dans un tableau: </font></font><br><br><pre> <code class="swift hljs"><span class="hljs-comment"><span class="hljs-comment">// Count equal elements in array let arrayIntCount = [1,1,2,2,6,6,7,2,9,7].reduce(into: [:]) { counts, letter in counts[letter, default: 0] += 1 } // [6: 2, 9: 1, 1: 2, 2: 3, 7: 2]</span></span></code> </pre><br><h2> <code><font color="#0000FF">flatMap (_:)</font></code> </h2> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Avant de passer √† cette fonction d'ordre sup√©rieur, regardons une d√©monstration tr√®s simple. </font></font><br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> maybeNumbers = [<span class="hljs-string"><span class="hljs-string">"42"</span></span>, <span class="hljs-string"><span class="hljs-string">"7"</span></span>, <span class="hljs-string"><span class="hljs-string">"three"</span></span>, <span class="hljs-string"><span class="hljs-string">"///4///"</span></span>, <span class="hljs-string"><span class="hljs-string">"5"</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> firstNumber = maybeNumbers.<span class="hljs-built_in"><span class="hljs-built_in">map</span></span> (<span class="hljs-type"><span class="hljs-type">Int</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>).first</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si nous ex√©cutons ce code pour l'ex√©cuter </font></font><code>Playground</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, alors tout semble bon, et le n√¥tre </font></font><code><font color="#0000FF">firstNumber</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">est √©gal </font></font><code><font color="#0000FF">42</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br><br><img src="https://habrastorage.org/webt/ld/wu/t6/ldwut6x-1iu4yxapphmpzcyamj4.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mais, si vous ne le savez pas, il </font></font><code>Playground</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cache souvent le vrai </font></font><code></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, en particulier les </font></font><code></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">constantes </font></font><code><font color="#0000FF">firstNumber</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. En fait, la constante </font></font><code><font color="#0000FF">firstNumber</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font><code></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">deux </font><font style="vertical-align: inherit;">choses </font></font><code><font color="#0000FF">Optional</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: en </font></font><br><br><img src="https://habrastorage.org/webt/v9/0k/xy/v90kxymnnsd_cxv-y4pznc0yj5s.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">effet, </font></font><code><font color="#0000FF">map (Int.init)</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√† la sortie, elle forme un tableau </font></font><code><font color="#0000FF">Optional</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">de valeurs TYPE </font></font><code><font color="#0000FF">[Int?]</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, car toutes les lignes </font></font><code><font color="#0000FF">String</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ne peuvent pas √™tre converties </font></font><code><font color="#0000FF">Int</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et l'initialiseur </font></font><code><font color="#0000FF">Int.int</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬´tombe¬ª ( </font></font><code>failable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">). Ensuite, nous prenons le premier √©l√©ment du tableau form√© en utilisant la fonction </font></font><code><font color="#0000FF">first</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">du tableau </font></font><code><font color="#0000FF">Array</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, qui forme √©galement la sortie</font></font><code><font color="#0000FF">Optional</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, car le tableau peut √™tre vide et nous ne pourrons pas obtenir le premier √©l√©ment du tableau. </font><font style="vertical-align: inherit;">En cons√©quence, nous avons un double </font></font><code><font color="#0000FF">Optional</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, c'est-√†-dire</font></font><code><font color="#0000FF">Int??</font></code>  . <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous avons une structure imbriqu√©e </font></font><code><font color="#0000FF">Optional</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dans </font></font><code><font color="#0000FF">Optional</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">laquelle il est vraiment plus difficile de travailler et que nous ne voulons naturellement pas avoir. </font><font style="vertical-align: inherit;">Afin de tirer le meilleur parti de cette structure imbriqu√©e, nous devons ¬´plonger¬ª dans deux niveaux. </font><font style="vertical-align: inherit;">De plus, toute transformation suppl√©mentaire peut approfondir le niveau </font></font><code><font color="#0000FF">Optional</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">encore plus bas. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Obtenir la valeur du double imbriqu√© est </font></font><code><font color="#0000FF">Optional</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vraiment p√©nible. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous avons 3 options et toutes n√©cessitent une connaissance approfondie de la langue </font></font><code>Swift</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br><br><ul><li>      <code><font color="#0000FF">if let</font></code> ,       ;    ¬´¬ª ¬´¬ª <code><font color="#0000FF">Optional</font></code> ,    ‚Äî  ¬´¬ª <code><font color="#0000FF">Optional</font></code> : <br><br><img src="https://habrastorage.org/webt/dp/wa/qh/dpwaqh4oebq7cjcwy35777cnno0.png"></li><li>       <code><font color="#0000FF">if case let</font></code>      ( <code>pattern match</code> )  : <br><br><img src="https://habrastorage.org/webt/v8/a6/tg/v8a6tg2npzwpktlvjpvqxf1pa0q.png"><br><br>       <code><font color="#0000FF">??</font></code>     : <br><br><img src="https://habrastorage.org/webt/a6/ny/ia/a6nyiaeq5bds4kiewmcugwomppq.png"></li><li> ,      <code><font color="#0000FF">switch</font></code>     : <br><br><img src="https://habrastorage.org/webt/oq/dx/1s/oqdx1siedfr6cxs2lug7zasq4qg.png"></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pire encore, de tels probl√®mes d'imbrication </font></font><code></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">surviennent dans toutes les situations impliquant des </font></font><code>generic</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">conteneurs </font><font style="vertical-align: inherit;">generalized ( </font><font style="vertical-align: inherit;">) pour lesquels une op√©ration est d√©finie </font></font><code><font color="#0000FF">map</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Par exemple, pour les tableaux </font></font><code><font color="#0000FF">Array</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Prenons un autre exemple de code. </font><font style="vertical-align: inherit;">Supposons que nous ayons un texte sur plusieurs lignes </font></font><code><font color="#0000FF">multilineString</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">que nous voulons diviser en mots √©crits en minuscules:</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> multilineString = <span class="hljs-string"><span class="hljs-string">"""  ,  ,   ;     , ‚Äî  ,   :  ‚Äî   ,   .   ,   ,   .    .  ,        ,  ¬´ ¬ª  .  ,  ,   ! """</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> words = multilineString.lowercased() .<span class="hljs-built_in"><span class="hljs-built_in">split</span></span>(separator: <span class="hljs-string"><span class="hljs-string">"\n"</span></span>) .<span class="hljs-built_in"><span class="hljs-built_in">map</span></span>{$<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-built_in"><span class="hljs-built_in">split</span></span>(separator: <span class="hljs-string"><span class="hljs-string">" "</span></span>)}</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Afin d'obtenir un tableau de mots </font></font><code><font color="#0000FF">words</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, nous faisons d'abord des lettres majuscules (grandes) en minuscules (petites) en utilisant la m√©thode </font></font><code><font color="#0000FF">lowercased()</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, puis nous divisons le texte en </font></font><code><font color="#0000FF">split(separatot: "\n")</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lignes en </font><font style="vertical-align: inherit;">utilisant la m√©thode </font><font style="vertical-align: inherit;">et obtenons un tableau de cha√Ænes, puis nous l'utilisons </font></font><code><font color="#0000FF">map {$0.split(separator: " ")}</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pour s√©parer chaque ligne en mots distincts. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En cons√©quence, nous obtenons des tableaux imbriqu√©s:</font></font><br><br><pre> <code class="swift hljs">[[<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">","</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">","</span></span>], [<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">";"</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">","</span></span>, <span class="hljs-string"><span class="hljs-string">"‚Äî"</span></span>], [<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">","</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">":"</span></span>], [<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"‚Äî"</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">","</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"."</span></span>], [<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">","</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">","</span></span>], [<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"."</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>], [<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"."</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">","</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>], [<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>], [<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">","</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"¬´"</span></span>, <span class="hljs-string"><span class="hljs-string">"¬ª"</span></span>], [<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"."</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">","</span></span>], [<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">","</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"!"</span></span>]]</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">... et cela </font></font><code><font color="#0000FF">words</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font><code></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">deux choses </font></font><code><font color="#0000FF">Array</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br><br><img src="https://habrastorage.org/webt/b0/kc/y3/b0kcy3vh-dkhtw6ytrmk7fe_cbk.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nous avons √† nouveau obtenu une structure de donn√©es "imbriqu√©e", mais cette fois, nous ne l'avons pas fait </font></font><code><font color="#0000FF">Optional</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, mais </font></font><code><font color="#0000FF">Array</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Si nous voulons continuer √† traiter les mots re√ßus </font></font><code><font color="#0000FF">words</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, par exemple, pour trouver le spectre des lettres de ce texte √† plusieurs lignes, nous devrons d'abord ¬´redresser¬ª le tableau du double </font></font><code><font color="#0000FF">Array</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et le transformer en un seul tableau </font></font><code><font color="#0000FF">Array</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Ceci est similaire √† ce que nous avons fait avec double </font></font><code><font color="#0000FF">Optional</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pour une d√©mo au d√©but de cette section sur </font></font><code><font color="#0000FF">flatMap</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> maybeNumbers = [<span class="hljs-string"><span class="hljs-string">"42"</span></span>, <span class="hljs-string"><span class="hljs-string">"7"</span></span>, <span class="hljs-string"><span class="hljs-string">"three"</span></span>, <span class="hljs-string"><span class="hljs-string">"///4///"</span></span>, <span class="hljs-string"><span class="hljs-string">"5"</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> firstNumber = maybeNumbers.<span class="hljs-built_in"><span class="hljs-built_in">map</span></span> (<span class="hljs-type"><span class="hljs-type">Int</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>).first</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Heureusement, </font></font><code>Swift</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nous n'avons pas √† recourir √† des constructions syntaxiques complexes. </font></font><code>Swift</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nous fournit une solution toute faite pour les baies </font></font><code><font color="#0000FF">Array</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et </font></font><code><font color="#0000FF">Optional</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Il s'agit d'une fonction d'ordre sup√©rieur </font></font><code><font color="#0000FF">flatMap</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">! Il est tr√®s similaire √† </font></font><code><font color="#0000FF">map</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, mais il poss√®de des fonctionnalit√©s suppl√©mentaires associ√©es au "redressement" ult√©rieur des "pi√®ces jointes" qui apparaissent lors de l'ex√©cution </font></font><code><font color="#0000FF">map</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Et c'est pourquoi on l'appelle </font></font><code><font color="#0000FF">flatMap</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, √ßa ¬´redresse¬ª ( </font></font><code>flattens</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) le r√©sultat </font></font><code><font color="#0000FF">map</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Essayons d'appliquer </font></font><code><font color="#0000FF">flatMap</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√† </font></font><code><font color="#0000FF">firstNumber</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br><br><img src="https://habrastorage.org/webt/l7/1g/ag/l71gagrp7qtfvn-9nae3ofbmlb0.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous avons vraiment obtenu la sortie avec un seul niveau </font></font><code><font color="#0000FF">Optional</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Fonctionne </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">encore plus int√©ressant </font></font><code><font color="#0000FF">flatMap</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pour un tableau </font></font><code><font color="#0000FF">Array</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Dans notre expression pour, </font></font><code><font color="#0000FF">words</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nous rempla√ßons simplement </font></font><code><font color="#0000FF">map</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">par</font></font><code><font color="#0000FF">flatMap</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br><br><img src="https://habrastorage.org/webt/zh/t9/bm/zht9bmajklq5ybm4xxpigddrrma.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">... et nous obtenons juste un tableau de mots </font></font><code><font color="#0000FF">words</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sans "imbrication":</font></font><br><br><pre> <code class="swift hljs">[<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">","</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">","</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">";"</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">","</span></span>, <span class="hljs-string"><span class="hljs-string">"‚Äî"</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">","</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">":"</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"‚Äî"</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">","</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"."</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">","</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">","</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"."</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"."</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">","</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">","</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"¬´"</span></span>, <span class="hljs-string"><span class="hljs-string">"¬ª"</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"."</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">","</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">","</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"!"</span></span>]</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous pouvons maintenant continuer le traitement dont nous avons besoin du tableau de mots r√©sultant </font></font><code><font color="#0000FF">words</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, mais soyez prudent. </font><font style="vertical-align: inherit;">Si nous l'appliquons √† nouveau </font></font><code><font color="#0000FF">flatMap</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√† chaque √©l√©ment du tableau </font></font><code><font color="#0000FF">words</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, nous obtiendrons, peut-√™tre, un r√©sultat inattendu, mais tout √† fait compr√©hensible. </font></font><br><br><img src="https://habrastorage.org/webt/vw/iq/jd/vwiqjd_y3ambrq0w8e-r9dnjpl4.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous obtenons un tableau unique et non ¬´imbriqu√©¬ª de lettres et de symboles </font></font><code><font color="#0000FF">[Character]</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">contenu dans notre phrase √† plusieurs lignes:</font></font><br><br><pre> <code class="swift hljs">[<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">","</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">","</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">";"</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, ...]</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le fait est que la cha√Æne </font></font><code><font color="#0000FF">String</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">est une collection de </font></font><code><font color="#0000FF">Collection</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">caract√®res </font></font><code><font color="#0000FF">[Character]</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et, en appliquant </font></font><code><font color="#0000FF">flatMap</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√† chaque mot individuel, nous abaissons une fois de plus le niveau de "nidification" et arrivons √† un tableau de caract√®res </font></font><code><font color="#0000FF">flattenCharacters</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Peut-√™tre que c'est exactement ce que vous voulez, ou peut-√™tre pas. </font><font style="vertical-align: inherit;">Faites attention √† cela.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Mettre tout cela ensemble: r√©soudre certains probl√®mes </font></font></h2><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> T√ÇCHE 1 </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous pouvons continuer le traitement du tableau de mots obtenu dans la section pr√©c√©dente dont nous avons besoin </font></font><code><font color="#0000FF">words</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et calculer la fr√©quence d'apparition des lettres dans notre phrase multiligne. </font><font style="vertical-align: inherit;">Pour commencer, ¬´collons¬ª tous les mots du tableau </font></font><code><font color="#0000FF">words</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sur une seule grande ligne et en excluons tous les signes de ponctuation, c'est-√†-dire ne laissons que les lettres:</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> wordsString = words.<span class="hljs-built_in"><span class="hljs-built_in">reduce</span></span> (<span class="hljs-string"><span class="hljs-string">""</span></span>,+).<span class="hljs-built_in"><span class="hljs-built_in">filter</span></span> { <span class="hljs-string"><span class="hljs-string">""</span></span> .<span class="hljs-built_in"><span class="hljs-built_in">contains</span></span>($<span class="hljs-number"><span class="hljs-number">0</span></span>)} <span class="hljs-comment"><span class="hljs-comment">// </span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous avons donc obtenu toutes les lettres dont nous avons besoin. </font><font style="vertical-align: inherit;">Maintenant, faisons-en un dictionnaire, o√π la cl√© </font></font><code><font color="#0000FF">key</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">est la lettre et la valeur </font></font><code><font color="#0000FF">value</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">est la fr√©quence de son occurrence dans le texte. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous pouvons le faire de deux mani√®res. </font></font><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La premi√®re m√©thode</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est associ√©e √† l'utilisation d'une nouvelle </font></font><code>Swift 4.2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vari√©t√© d'une fonction d'ordre sup√©rieur </font><font style="vertical-align: inherit;">qui est apparue dans </font></font><code><font color="#0000FF">reduce (into:, _:)</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Cette m√©thode nous convient tout √† fait pour organiser un dictionnaire </font></font><code><font color="#0000FF">letterCount</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">avec la fr√©quence d'apparition des lettres dans notre phrase multiligne:</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> letterCount = wordsString.<span class="hljs-built_in"><span class="hljs-built_in">reduce</span></span>(into: [:]) { counts, letter <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> counts[letter, <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>] += <span class="hljs-number"><span class="hljs-number">1</span></span>} <span class="hljs-built_in"><span class="hljs-built_in">print</span></span> (letterCount) <span class="hljs-comment"><span class="hljs-comment">// ["": 1, "": 18, "": 2, "": 2, "": 5, "": 7, "": 17, "": 4, "": 23, ...]</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En cons√©quence, nous obtiendrons un dictionnaire </font></font><code><font color="#0000FF">letterCount</font></code> <code></code> <code><font color="#0000FF">[Character : Int]</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dans lequel les cl√©s </font></font><code><font color="#0000FF">key</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sont les caract√®res trouv√©s dans la phrase √† l'√©tude, et comme la valeur </font></font><code><font color="#0000FF">value</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">est le nombre de ces caract√®res. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La deuxi√®me m√©thode</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> consiste √† initialiser le dictionnaire √† l'aide du regroupement, ce qui donne le m√™me r√©sultat:</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> letterCountDictionary = <span class="hljs-type"><span class="hljs-type">Dictionary</span></span>(grouping: wordsString ){ $<span class="hljs-number"><span class="hljs-number">0</span></span>}.mapValues {$<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-built_in"><span class="hljs-built_in">count</span></span>} letterCount == letterCountDictionary <span class="hljs-comment"><span class="hljs-comment">// true</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous souhaitons trier le dictionnaire </font></font><code><font color="#0000FF">letterCount</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">par ordre alphab√©tique:</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> lettersStat = letterCountDictionary .sorted(by: &lt;) .<span class="hljs-built_in"><span class="hljs-built_in">map</span></span>{<span class="hljs-string"><span class="hljs-string">"\($0.0):\($0.1)"</span></span>} <span class="hljs-built_in"><span class="hljs-built_in">print</span></span> (lettersStat) <span class="hljs-comment"><span class="hljs-comment">// [":17", ":5", ":18", ":4", ":8", ":35", ":3", ":4", ":18", ":5", ":2", ":10", ":4", ":26", ":34", ":5", ":7", ":23", ":25", ":4", ":2", ":3", ":4", ":2", ":1", ":14", ":2", ":4"]</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mais nous ne pouvons pas trier directement le dictionnaire </font></font><code><font color="#0000FF">Dictionary</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, car ce n'est fondamentalement pas une structure de donn√©es ordonn√©e. Si nous appliquons la fonction </font></font><code><font color="#0000FF">sorted (by:)</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">au dictionnaire </font></font><code><font color="#0000FF">Dictionary</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, elle nous renverra les √©l√©ments de la s√©quence tri√©s avec le pr√©dicat donn√© sous la forme d'un tableau de tuples nomm√©s, que </font></font><code><font color="#0000FF">map</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nous transformerons en un tableau de cha√Ænes </font></font><code><font color="#0000FF">[":17", ":5", ":18", ...]</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">refl√©tant la fr√©quence d'occurrence de la lettre correspondante. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous voyons que cette fois, </font></font><code><font color="#0000FF">sorted (by:)</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">juste l'op√©rateur " </font></font><code><font color="#0000FF">&lt;</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">" </font><font style="vertical-align: inherit;">est pass√© </font><font style="vertical-align: inherit;">comme pr√©dicat √† une fonction d' </font><font style="vertical-align: inherit;">ordre </font><font style="vertical-align: inherit;">sup√©rieur </font><font style="vertical-align: inherit;">. La fonction </font></font><code><font color="#0000FF">sorted (by:)</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">attend une ¬´fonction de comparaison¬ª comme seul argument √† l'entr√©e. Il est utilis√© pour comparer deux valeurs adjacentes et d√©cider si elles sont correctement ordonn√©es (dans ce cas, renvoie</font></font><code><font color="#0000FF">true</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) ou non (retourne </font></font><code><font color="#0000FF">false</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">). </font><font style="vertical-align: inherit;">On peut donner √† cette "fonction de comparaison" des fonctions </font></font><code><font color="#0000FF">sorted (by:)</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sous forme de fermeture anonyme:</font></font><br><br><pre> <code class="swift hljs">sorted(by: {$<span class="hljs-number"><span class="hljs-number">0</span></span>.key &lt; $<span class="hljs-number"><span class="hljs-number">1</span></span>.key}</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Et nous pouvons simplement lui donner l'op√©rateur " </font></font><code><font color="#0000FF">&lt;</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">", qui a la signature dont nous avons besoin, comme cela a √©t√© fait ci-dessus. </font><font style="vertical-align: inherit;">Il s'agit √©galement d'une fonction et le tri par cl√© est en cours </font></font><code><font color="#0000FF">key</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si nous voulons trier le dictionnaire par valeurs </font></font><code><font color="#0000FF">value</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et savoir quelles lettres se trouvent le plus souvent dans cette phrase, nous devrons utiliser la fermeture de la fonction </font></font><code><font color="#0000FF">sorted (by:)</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> countsStat = letterCountDictionary .sorted(by: {$<span class="hljs-number"><span class="hljs-number">0</span></span>.value &gt; $<span class="hljs-number"><span class="hljs-number">1</span></span>.value}) .<span class="hljs-built_in"><span class="hljs-built_in">map</span></span>{<span class="hljs-string"><span class="hljs-string">"\($0.0):\($0.1)"</span></span>} <span class="hljs-built_in"><span class="hljs-built_in">print</span></span> (countsStat ) <span class="hljs-comment"><span class="hljs-comment">//[":35", ":34", ":26", ":25", ":23", ":18", ":18", ":17", ":14", ":10", ":8", ":7", ":5", ":5", ":5", ":4", ":4", ":4", ":4", ":4", ":4", ":3", ":3", ":2", ":2", ":2", ":2", ":1"]</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Si nous examinons la solution au probl√®me de la d√©termination du spectre des lettres d'une phrase multiligne dans son ensemble ... </font></font><br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> multilineString = <span class="hljs-string"><span class="hljs-string">"""  ,  ,   ;     , ‚Äî  ,   :  ‚Äî   ,   .   ,   ,   .    .  ,        ,  ¬´ ¬ª  .  ,  ,   ! """</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> words = multilineString.lowercased() .<span class="hljs-built_in"><span class="hljs-built_in">split</span></span>(separator: <span class="hljs-string"><span class="hljs-string">"\n"</span></span>) .flatMap{$<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-built_in"><span class="hljs-built_in">split</span></span>(separator: <span class="hljs-string"><span class="hljs-string">" "</span></span>)} <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> wordsString = words.<span class="hljs-built_in"><span class="hljs-built_in">reduce</span></span> (<span class="hljs-string"><span class="hljs-string">""</span></span>,+).<span class="hljs-built_in"><span class="hljs-built_in">filter</span></span> { <span class="hljs-string"><span class="hljs-string">""</span></span> .<span class="hljs-built_in"><span class="hljs-built_in">contains</span></span>($<span class="hljs-number"><span class="hljs-number">0</span></span>)} <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> letterCount = wordsString.<span class="hljs-built_in"><span class="hljs-built_in">reduce</span></span>(into: [:]) { counts, letter <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> counts[letter, <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>] += <span class="hljs-number"><span class="hljs-number">1</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> lettersStat = letterCountDictionary .sorted(by: &lt;) .<span class="hljs-built_in"><span class="hljs-built_in">map</span></span>{<span class="hljs-string"><span class="hljs-string">"\($0.0):\($0.1)"</span></span>} <span class="hljs-built_in"><span class="hljs-built_in">print</span></span> (lettersStat) <span class="hljs-comment"><span class="hljs-comment">// [":17", ":5", ":18", ":4", ":8", ":35", ":3", ":4", ":18", ":5", ":2", ":10", ":4", ":26", ":34", ":5", ":7", ":23", ":25", ":4", ":2", ":3", ":4", ":2", ":1", ":14", ":2", ":4"] let countsStat = letterCountDictionary .sorted(by: {$0.value &gt; $1.value}) .map{"\($0.0):\($0.1)"} print (countsStat ) //[":35", ":34", ":26", ":25", ":23", ":18", ":18", ":17", ":14", ":10", ":8", ":7", ":5", ":5", ":5", ":4", ":4", ":4", ":4", ":4", ":4", ":3", ":3", ":2", ":2", ":2", ":2", ":1"]</span></span></code> </pre><br> ‚Ä¶   ,         ( <code><font color="#0000FF">var</font></code> ,  <code><font color="#0000FF">let)</font></code>        ()   ,     ,    : <br><br> <code><font color="#0000FF">split</font></code> - , <br> <code><font color="#0000FF">map</font></code> ‚Äî  <br> <code><font color="#0000FF">flatMap</font></code> -    (   ), <br> <code><font color="#0000FF">filter</font></code> - , <br> <code><font color="#0000FF">sorted</font></code> - , <br> <code><font color="#0000FF">reduce</font></code> -          <br><br>          ,   .     ¬´¬ª ,   <code><font color="#0000FF">map</font></code> ,         ,   <code><font color="#0000FF">flatMap</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, si nous voulons s√©lectionner uniquement certaines donn√©es, nous les utilisons </font></font><code><font color="#0000FF">filter</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, etc. Toutes ces fonctions de ¬´l'ordre le plus √©lev√©¬ª sont con√ßues et test√©es </font></font><code>Apple</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">en tenant compte de l'optimisation des performances. Donc, ce morceau de code est tr√®s fiable et concis - nous n'avions pas besoin de plus de 5 phrases pour r√©soudre notre probl√®me. Ceci est un exemple de programmation fonctionnelle. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le seul inconv√©nient de l'application de l'approche fonctionnelle dans cette d√©mo est que, pour des raisons d'immuabilit√©, de testabilit√© et de lisibilit√©, nous poursuivons notre texte √† plusieurs reprises √† travers diverses fonctions d'ordre sup√©rieur. Dans le cas d'un grand nombre d'articles de collection, les </font></font><code><font color="#0000FF">Collection</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">performances peuvent chuter. Par exemple, si nous utilisons d'abord </font></font><code><font color="#0000FF">filter(_:)</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et, puis - </font></font><code><font color="#0000FF">first</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dans</font></font><code>Swift 4</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> De nouvelles options de fonctionnalit√©s ont √©t√© ajout√©es pour am√©liorer les performances, et voici quelques conseils pour √©crire du code plus rapidement. </font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1. Utilisez </font></font><code><font color="#0000FF">contains</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, PAS</font></font><code><font color="#0000FF">first( where: ) != nil</font></code> </h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La v√©rification de la pr√©sence d'un objet dans une collection </font></font><code><font color="#0000FF">Collection</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">peut √™tre effectu√©e de plusieurs mani√®res. </font><font style="vertical-align: inherit;">La meilleure performance est fournie par la fonction </font></font><code><font color="#0000FF">contains</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CODE CORRECT</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> numbers = [<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>] numbers.<span class="hljs-built_in"><span class="hljs-built_in">contains</span></span>(<span class="hljs-number"><span class="hljs-number">1</span></span>)</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> CODE INCORRECT </font></font><br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> numbers = [<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>] numbers.<span class="hljs-built_in"><span class="hljs-built_in">filter</span></span> { number <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> number == <span class="hljs-number"><span class="hljs-number">1</span></span> }.isEmpty == <span class="hljs-literal"><span class="hljs-literal">false</span></span> numbers.first(<span class="hljs-keyword"><span class="hljs-keyword">where</span></span>: { number <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> number == <span class="hljs-number"><span class="hljs-number">1</span></span> }) != <span class="hljs-literal"><span class="hljs-literal">nil</span></span></code> </pre><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2. Utilisez la validation </font></font><code><font color="#0000FF">isEmpty</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, PAS une comparaison </font></font><code><font color="#0000FF">count</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">avec z√©ro</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√âtant donn√© que pour certaines collections, l'acc√®s √† la propri√©t√© </font></font><code><font color="#0000FF">count</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s'effectue en it√©rant sur tous les √©l√©ments de la collection. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CODE CORRECT</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> numbers = [] numbers.isEmpty</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> CODE INCORRECT </font></font><br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> numbers = [] numbers.<span class="hljs-built_in"><span class="hljs-built_in">count</span></span> == <span class="hljs-number"><span class="hljs-number">0</span></span></code> </pre><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3. V√©rifiez la cha√Æne vide </font></font><code><font color="#0000FF">String</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">avec</font></font><code><font color="#0000FF">isEmpty</font></code> </h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">String </font></font><code><font color="#0000FF">String</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in </font></font><code>Swift</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">est une collection de caract√®res </font></font><code><font color="#0000FF">[Character]</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Cela signifie que pour les cha√Ænes, il est </font></font><code><font color="#0000FF">String</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√©galement pr√©f√©rable d'utiliser </font></font><code><font color="#0000FF">isEmpty</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CODE CORRECT</font></font><br><br><pre> <code class="swift hljs">myString.isEmpty</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> CODE INCORRECT </font></font><br><br><pre> <code class="swift hljs">myString == <span class="hljs-string"><span class="hljs-string">""</span></span> myString.<span class="hljs-built_in"><span class="hljs-built_in">count</span></span> == <span class="hljs-number"><span class="hljs-number">0</span></span></code> </pre><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 4. Obtention du premier √©l√©ment qui remplit certaines conditions </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'it√©ration sur l'ensemble de la collection afin d'obtenir le premier objet qui remplit certaines conditions peut √™tre effectu√©e √† l'aide d'une m√©thode </font></font><code><font color="#0000FF">filter</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">suivie d'une m√©thode </font></font><code><font color="#0000FF">first</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, mais la </font><font style="vertical-align: inherit;">m√©thode </font><font style="vertical-align: inherit;">est la meilleure en termes de vitesse </font></font><code><font color="#0000FF">first (where:)</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Cette m√©thode cesse d'it√©rer sur la collection d√®s qu'elle remplit la condition n√©cessaire. </font><font style="vertical-align: inherit;">La m√©thode </font></font><code><font color="#0000FF">filter</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">continuera d'it√©rer sur l'ensemble de la collection, qu'elle rencontre ou non les √©l√©ments n√©cessaires. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√âvidemment, il en va de m√™me pour la m√©thode </font></font><code><font color="#0000FF">last (where:)</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CODE CORRECT</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> numbers = [<span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, -<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, -<span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> firstNegative = numbers.first(<span class="hljs-keyword"><span class="hljs-keyword">where</span></span>: { $<span class="hljs-number"><span class="hljs-number">0</span></span> &lt; <span class="hljs-number"><span class="hljs-number">0</span></span> })</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> CODE INCORRECT </font></font><br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> numbers = [<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> allEven = numbers.<span class="hljs-built_in"><span class="hljs-built_in">filter</span></span> { $<span class="hljs-number"><span class="hljs-number">0</span></span> % <span class="hljs-number"><span class="hljs-number">2</span></span> != <span class="hljs-number"><span class="hljs-number">0</span></span> }.isEmpty</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Parfois, lorsque la collection </font></font><code><font color="#0000FF">Collection</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">est tr√®s importante et que les performances sont essentielles pour vous, il vaut la peine de revenir √† comparer les approches imp√©ratives et fonctionnelles et √† choisir celle qui vous convient.</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> T√ÇCHE 2 </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il y a un autre excellent exemple d'une utilisation tr√®s concise d'une fonction d'ordre sup√©rieur </font></font><code><font color="#0000FF">reduce (_:, _:)</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">que j'ai rencontr√©. Ceci est un jeu </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SET</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Voici ses r√®gles de base. Le nom du jeu </font></font><code>SET</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vient du mot anglais "set" - "set". Le jeu </font></font><code>SET</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">comprend 81 cartes, chacune avec une image unique: </font></font><br><br><img src="https://habrastorage.org/webt/ho/tg/rr/hotgrrs2vjmbgdyuxo0l4if6fai.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chaque carte a 4 attributs, √©num√©r√©s ci-dessous: </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quantit√©</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : chaque carte a un, deux ou trois caract√®res. </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Type de personnages</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : ovales, losanges ou vagues. </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Couleur</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : les symboles peuvent √™tre rouges, verts ou violets. </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Remplissage</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : les caract√®res peuvent √™tre vides, ombr√©s ou ombr√©s. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">But du jeu</font></font><code>SET</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: Parmi les 12 cartes pr√©sent√©es sur la table, vous devez trouver </font></font><code>SET</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(un ensemble) compos√© de 3 cartes, dans lesquelles chacun des signes co√Øncide compl√®tement ou diff√®re compl√®tement sur les 3 cartes. Tous les panneaux doivent respecter pleinement cette r√®gle. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Par exemple, le nombre de caract√®res sur les 3 cartes doit √™tre identique ou diff√©rent, la couleur sur les 3 cartes doit √™tre identique ou diff√©rente, et ainsi de suite ... </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dans cet exemple, nous ne nous int√©resserons qu'au mod√®le de carte </font></font><code>SET</code> <code><font color="#0000FF">struct SetCard</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et √† l'algorithme pour d√©terminer </font></font><code>SET</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">par 3e cartes </font></font><code><font color="#0000FF">isSet( cards:[SetCard])</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SetCard</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Equatable</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> number: <span class="hljs-type"><span class="hljs-type">Variant</span></span> <span class="hljs-comment"><span class="hljs-comment">// number - 1, 2, 3 let color: Variant // color - 1, 2, 3 (, , , ) let shape: Variant // symbol - 1, 2, 3 (, , , ) let fill: Variant // fill - 1, 2, 3 (, , , ) enum Variant: Int, CaseIterable { case v1 = 1 case v2 case v3 } static func isSet(cards: [SetCard]) -&gt; Bool { guard cards.count == 3 else {return false} let sums = [ cards.reduce(0, { $0 + $1.number.rawValue }), cards.reduce(0, { $0 + $1.color.rawValue }), cards.reduce(0, { $0 + $1.shape.rawValue }), cards.reduce(0, { $0 + $1.fill.rawValue }) ] return sums.reduce(true, { $0 &amp;&amp; ($1 % 3 == 0) }) } }</span></span></code> </pre><br>     ‚Äî <i></i> <code><font color="#0000FF">number</font></code> , <i> </i> <code><font color="#0000FF">shape</font></code> , <i></i> <code><font color="#0000FF">color</font></code>  <i></i> <code><font color="#0000FF">fill</font></code> ‚Äî   <code><font color="#0000FF">Variant</font></code> ,  3  : <code><font color="#0000FF">var1</font></code> , <code><font color="#0000FF">var2</font></code>  <code><font color="#0000FF">var3</font></code> ,   3-   <code><font color="#0000FF">rawValue</font></code> ‚Äî <code><font color="#0000FF">1,2,3</font></code> .     <code><font color="#0000FF">rawValue</font></code>  .    - , , <code><font color="#0000FF">color</font></code> ,    <code><font color="#0000FF">rawValue</font></code>  <code><font color="#0000FF">colors</font></code> 3- ,  ,   <code><font color="#0000FF">colors</font></code>   3-  ,     <code><font color="#0000FF">3</font></code> , <code><font color="#0000FF">6</font></code>  <code><font color="#0000FF">9</font></code> ,      ,     <code><font color="#0000FF">6</font></code> .           3-  <code><font color="#0000FF">rawValue</font></code>  <code><font color="#0000FF">colors</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">les 3 cartes. Nous savons que c'est une condition pr√©alable √† la composition de 3 cartes </font></font><code>SET</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Pour que 3 cartes deviennent vraiment </font></font><code>SET</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n√©cessaires, pour tous les signes </font></font><code><font color="#0000FF">SetCard</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Quantit√© </font></font><code><font color="#0000FF">number</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, Type de symbole </font></font><code><font color="#0000FF">shape</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, Couleur </font></font><code><font color="#0000FF">color</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et Remplissage </font></font><code><font color="#0000FF">fill</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- leur somme doit </font></font><code><font color="#0000FF">rawValue</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√™tre un multiple de la 3e. Par </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cons√©quent, dans la </font></font><code><font color="#0000FF">static</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m√©thode, </font></font><code><font color="#0000FF">isSet( cards:[SetCard])</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nous avons d' </font><font style="vertical-align: inherit;">abord calculer le tableau </font></font><code><font color="#0000FF">sums</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">des sommes </font></font><code><font color="#0000FF">rawValue</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pour les 3 cartes pour toutes les </font><font style="vertical-align: inherit;">carte 4 performances en </font><font style="vertical-align: inherit;">utilisant la </font><font style="vertical-align: inherit;">fonction d'ordre sup√©rieur </font></font><code><font color="#0000FF">reduce</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">avec une valeur initiale √©gale √† </font></font><code><font color="#0000FF">0</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, et l' </font><font style="vertical-align: inherit;">accumulation de </font><font style="vertical-align: inherit;">fonctions </font></font><code><font color="#0000FF">{$0 + $1.number.rawValue}</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code><font color="#0000FF">{$0 + $1.color.rawValue}</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code><font color="#0000FF">{$0 + $1.shape.rawValue}</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code><font color="#0000FF">{ {$0 + $1.fill.rawValue}</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Chaque √©l√©ment du tableau </font></font><code><font color="#0000FF">sums</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">doit √™tre un multiple de 3e, et encore une fois, nous utilisons la fonction</font></font><code><font color="#0000FF">reduce</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, mais cette fois avec une valeur initiale √©gale </font></font><code><font color="#0000FF">true</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et cumulant la fonction logique " </font></font><code>AND</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">" </font></font><code><font color="#0000FF">{$0 &amp;&amp; ($1 % 3) == 0}</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Dans </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Swift 5,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pour tester la multiplicit√© d'un nombre pour un autre, une fonction est introduite √† la </font></font><code><font color="#0000FF">isMultiply(of:)</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">place de l'op√©rateur </font></font><code><font color="#0000FF">%</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">restant. Il permettra √©galement d' </font><font style="vertical-align: inherit;">am√©liorer la lisibilit√© du code: </font></font><code><font color="#0000FF">{ $0 &amp;&amp; ($1.isMultiply(of:3) }</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ce code incroyablement court pour savoir si les 3 </font></font><code><font color="#0000FF">SetCard</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cartes sont les </font></font><code>SET</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i est obtenu gr√¢ce √† l' </font><font style="vertical-align: inherit;">approche </font><font style="vertical-align: inherit;">" </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fonctionnelle</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ", et nous pouvons nous assurer qu'il fonctionne sur </font></font><code>Playground</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br><br><img src="https://habrastorage.org/webt/9y/cg/6e/9ycg6e0hzi_kfdc4kvsnd0cnjsy.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comment </font></font><code>SET</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">construire l'interface utilisateur ( </font></font><code>UI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font><font style="vertical-align: inherit;">sur ce mod√®le de jeu </font></font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ici</font></font></a></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ici</font></font></a></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ici</font></font></a></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Fonctionnalit√©s pures et effets secondaires </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Une fonction pure remplit deux conditions. </font><font style="vertical-align: inherit;">Il renvoie toujours le m√™me r√©sultat avec les m√™mes param√®tres d'entr√©e. </font><font style="vertical-align: inherit;">Et le calcul du r√©sultat ne provoque pas d'effets secondaires associ√©s √† la sortie de donn√©es √† l'ext√©rieur (par exemple, sur disque) ou √† l'emprunt de donn√©es source √† l'ext√©rieur (par exemple, le temps). </font><font style="vertical-align: inherit;">Cela vous permet d'optimiser consid√©rablement le code. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ce sujet est </font></font><code>Swift</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">parfaitement expos√© sur </font></font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">point.free</font></font></a></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dans les tout premiers √©pisodes de </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">" </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fonctions</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> "</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">" </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Effets secondaires</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> "</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , qui sont traduits en russe et pr√©sent√©s comme </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">" </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fonctions</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> "</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Effets secondaires"</font></font></a></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Composition des fonctions </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dans un sens math√©matique, cela signifie appliquer une fonction au r√©sultat d'une autre fonction. Dans une </font></font><code>Swift</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fonction, ils peuvent renvoyer une valeur que vous pouvez utiliser comme entr√©e pour une autre fonction. Il s'agit d'une pratique de programmation courante. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Imaginez que nous avons un tableau d'entiers et que nous voulons obtenir un tableau de carr√©s de nombres pairs uniques √† la sortie. Habituellement, nous le r√©impl√©mentons comme suit:</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> integerArray = [<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">unique</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> array: [Int])</span></span></span></span> -&gt; [<span class="hljs-type"><span class="hljs-type">Int</span></span>] { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> array.<span class="hljs-built_in"><span class="hljs-built_in">reduce</span></span>(into: [], { (results, element) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> !results.<span class="hljs-built_in"><span class="hljs-built_in">contains</span></span>(element) { results.append(element) } }) } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">even</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> array: [Int])</span></span></span></span> -&gt; [<span class="hljs-type"><span class="hljs-type">Int</span></span>] { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> array.<span class="hljs-built_in"><span class="hljs-built_in">filter</span></span>{ $<span class="hljs-number"><span class="hljs-number">0</span></span>%<span class="hljs-number"><span class="hljs-number">2</span></span> == <span class="hljs-number"><span class="hljs-number">0</span></span>} } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">square</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> array: [Int])</span></span></span></span> -&gt; [<span class="hljs-type"><span class="hljs-type">Int</span></span>] { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> array.<span class="hljs-built_in"><span class="hljs-built_in">map</span></span>{ $<span class="hljs-number"><span class="hljs-number">0</span></span>*$<span class="hljs-number"><span class="hljs-number">0</span></span> } } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> array = square(even(unique(integerArray))) <span class="hljs-comment"><span class="hljs-comment">// it returns [4, 16, 36, 64]</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ce code nous donne le r√©sultat correct, mais vous voyez que la lisibilit√© de la derni√®re ligne de code n'est pas si facile. La s√©quence de fonctions (de droite √† gauche) est l'oppos√© de celle √† laquelle nous sommes habitu√©s (de gauche √† droite) et que nous aimerions voir ici. Nous devons d'abord diriger notre logique vers la partie la plus interne de multiples plongements - vers le tableau </font></font><code><font color="#0000FF">inegerArray</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, puis vers la fonction externe √† ce tableau </font></font><code><font color="#0000FF">unique</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, puis nous montons d'un autre niveau - la fonction </font></font><code><font color="#0000FF">even</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, et enfin, la fonction dans la conclusion </font></font><code><font color="#0000FF">square</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Et ici la ¬´composition¬ª des fonctions </font></font><code><font color="#0000FF">&gt;&gt;&gt;</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et des </font><font style="vertical-align: inherit;">op√©rateurs vient √† notre aide </font></font><code><font color="#0000FF">|&gt;</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, ce qui nous permet d'√©crire le code d'une mani√®re tr√®s pratique, repr√©sentant le traitement du tableau d'origine </font></font><code><font color="#0000FF">integerArray</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">comme un ¬´convoyeur¬ª de fonctions:</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> array1 = integerArray |&gt; unique &gt;&gt;&gt; even &gt;&gt;&gt; square</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Presque toutes les </font><font style="vertical-align: inherit;">langues sp√©cialis√©es telles que la </font><font style="vertical-align: inherit;">programmation fonctionnelle </font></font><code>F#</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>Elixir</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et </font></font><code>Elm</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">utiliser ces op√©rateurs pour les </font><font style="vertical-align: inherit;">fonctions ¬´ de composition ¬ª. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il </font></font><code>Swift</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n'y a pas d'op√©rateurs int√©gr√©s de la ¬´composition¬ª des fonctions </font></font><code><font color="#0000FF">&gt;&gt;&gt;</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et </font></font><code><font color="#0000FF">|&gt;</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, mais nous pouvons tr√®s facilement les obtenir √† l'aide de </font></font><code>Generics</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">closures ( </font></font><code>closure</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) et de l' </font></font><code><font color="#0000FF">infix</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">op√©rateur:</font></font><br><br><pre> <code class="swift hljs">precedencegroup <span class="hljs-type"><span class="hljs-type">ForwardComposition</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">associativity</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">left</span></span> higherThan: <span class="hljs-type"><span class="hljs-type">ForwardApplication</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">infix</span></span> <span class="hljs-keyword"><span class="hljs-keyword">operator</span></span> &gt;&gt;&gt; : <span class="hljs-type"><span class="hljs-type">ForwardComposition</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> &gt;&gt;&gt; &lt;A, B, C&gt;</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">left</span></span></span></span><span class="hljs-function"><span class="hljs-params">: @escaping </span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">(A)</span></span></span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">B</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">right</span></span>: @escaping (<span class="hljs-type"><span class="hljs-type">B</span></span>) -&gt; <span class="hljs-type"><span class="hljs-type">C</span></span>) -&gt; (<span class="hljs-type"><span class="hljs-type">A</span></span>) -&gt; <span class="hljs-type"><span class="hljs-type">C</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">right</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">left</span></span>($<span class="hljs-number"><span class="hljs-number">0</span></span>)) } } precedencegroup <span class="hljs-type"><span class="hljs-type">ForwardApplication</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">associativity</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">left</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">infix</span></span> <span class="hljs-keyword"><span class="hljs-keyword">operator</span></span> |&gt; : <span class="hljs-type"><span class="hljs-type">ForwardApplication</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> |&gt; &lt;A, B&gt;</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(a: A, f: </span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">(A)</span></span></span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">B</span></span>) -&gt; <span class="hljs-type"><span class="hljs-type">B</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> f(a) }</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Malgr√© les co√ªts suppl√©mentaires, cela peut dans certains cas augmenter consid√©rablement les performances, la lisibilit√© et la testabilit√© de votre code. </font><font style="vertical-align: inherit;">Par exemple, √† l'int√©rieur, </font></font><code><font color="#0000FF">map</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vous placez toute une cha√Æne de fonctions en utilisant l'op√©rateur ¬´composition¬ª </font></font><code><font color="#0000FF">&gt;&gt;&gt;</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">au lieu de courir apr√®s un tableau √† travers de nombreux </font></font><code><font color="#0000FF">map</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> integerArray1 = [<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> b = integerArray1.<span class="hljs-built_in"><span class="hljs-built_in">map</span></span>( { $<span class="hljs-number"><span class="hljs-number">0</span></span> + <span class="hljs-number"><span class="hljs-number">1</span></span> } &gt;&gt;&gt; { $<span class="hljs-number"><span class="hljs-number">0</span></span> * <span class="hljs-number"><span class="hljs-number">3</span></span> } &gt;&gt;&gt; <span class="hljs-type"><span class="hljs-type">String</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>) <span class="hljs-built_in"><span class="hljs-built_in">print</span></span> (b) <span class="hljs-comment"><span class="hljs-comment">// ["6", "9", "12", "15", "18", "21", "24", "27", "30", "6", "15", "18"]</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mais pas toujours une approche fonctionnelle donne un effet positif. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Au d√©but, quand il est apparu </font></font><code>Swift</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">en 2014, tout le monde s'est pr√©cipit√© pour √©crire des biblioth√®ques avec des op√©rateurs pour la ¬´composition¬ª des fonctions et pour r√©soudre une t√¢che difficile √† l'√©poque comme l'analyse syntaxique √† l' </font></font><code>JSON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aide d'op√©rateurs de programmation fonctionnelle au lieu d'utiliser des constructions infiniment imbriqu√©es </font></font><code><font color="#0000FF">if let</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. J'ai moi-m√™me traduit l' </font></font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">article sur l'analyse fonctionnelle JSON qui</font></font></a></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> m'a ravi de sa solution √©l√©gante </font><font style="vertical-align: inherit;">et √©tait un fan de la biblioth√®que </font></font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Argo</font></font></a></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mais les d√©veloppeurs sont </font></font><code>Swift</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">all√©s d'une mani√®re compl√®tement diff√©rente et ont propos√©, sur la base d'une technologie orient√©e protocole, une mani√®re beaucoup plus concise d'√©crire du code. Afin de ¬´livrer¬ª les </font></font><code>JSON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">donn√©es directement √†</font></font><code></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Assez pour ce faire </font></font><code></code> <code><font color="#0000FF">Codable</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, qui met automatiquement en </font><font style="vertical-align: inherit;">≈ìuvre ce protocole, si votre mod√®le est </font><font style="vertical-align: inherit;">constitu√© des connus </font></font><code>Swift</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">structures de donn√©es: </font></font><code><font color="#0000FF">String</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code><font color="#0000FF">Int</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code><font color="#0000FF">URL</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code><font color="#0000FF">Array</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code><font color="#0000FF">Dictionary</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, etc.</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Blog</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Codable</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> id: <span class="hljs-type"><span class="hljs-type">Int</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> name: <span class="hljs-type"><span class="hljs-type">String</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> url: <span class="hljs-type"><span class="hljs-type">URL</span></span> }</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Avoir des </font></font><code>JSON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">donn√©es de ce </font></font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c√©l√®bre article</font></font></a></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ...</font></font><br><pre> <code class="swift hljs">[ { <span class="hljs-string"><span class="hljs-string">"id"</span></span> : <span class="hljs-number"><span class="hljs-number">73</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span> : <span class="hljs-string"><span class="hljs-string">"Bloxus test"</span></span>, <span class="hljs-string"><span class="hljs-string">"url"</span></span> : <span class="hljs-string"><span class="hljs-string">"http://remote.bloxus.com/"</span></span> }, { <span class="hljs-string"><span class="hljs-string">"id"</span></span> : <span class="hljs-number"><span class="hljs-number">74</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span> : <span class="hljs-string"><span class="hljs-string">"Manila Test"</span></span>, <span class="hljs-string"><span class="hljs-string">"url"</span></span> : <span class="hljs-string"><span class="hljs-string">"http://flickrtest1.userland.com/"</span></span> } ]</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">... pour le moment, vous n'avez besoin que d'une ligne de code pour obtenir un √©ventail de blogs </font></font><code><font color="#0000FF">blogs</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> blogs = <span class="hljs-type"><span class="hljs-type">Bundle</span></span>.main.path(forResource: <span class="hljs-string"><span class="hljs-string">"blogs"</span></span>, ofType: <span class="hljs-string"><span class="hljs-string">"json"</span></span>) .<span class="hljs-built_in"><span class="hljs-built_in">map</span></span>(<span class="hljs-type"><span class="hljs-type">URL</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>(fileURLWithPath:)) .flatMap { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>? <span class="hljs-type"><span class="hljs-type">Data</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>(contentsOf: $<span class="hljs-number"><span class="hljs-number">0</span></span>) } .flatMap { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>? <span class="hljs-type"><span class="hljs-type">JSONDecoder</span></span>().decode([<span class="hljs-type"><span class="hljs-type">Blog</span></span>].<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>, from: $<span class="hljs-number"><span class="hljs-number">0</span></span>) } <span class="hljs-built_in"><span class="hljs-built_in">print</span></span> (<span class="hljs-string"><span class="hljs-string">"\(blogs!)"</span></span>) <span class="hljs-comment"><span class="hljs-comment">// [id: 73 name: Bloxus test url: http://remote.bloxus.com/, // id: 74 name: Manila Test url: http://flickrtest1.userland.com/]</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tout le monde a oubli√© en toute s√©curit√© d'utiliser les op√©rateurs de ¬´composition¬ª des fonctions pour l'analyse </font></font><code>JSON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, s'il existe un autre moyen plus compr√©hensible et plus simple de le faire en utilisant des protocoles. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si tout est si simple, alors nous pouvons ¬´t√©l√©charger¬ª des </font></font><code>JSON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">donn√©es vers des mod√®les plus complexes. </font><font style="vertical-align: inherit;">Supposons que nous ayons un fichier de </font></font><code>JSON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">donn√©es qui porte un nom </font></font><code>user.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et se trouve dans notre r√©pertoire </font></font><code>Resources.</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Il contient des donn√©es sur un certain utilisateur:</font></font><br><br><pre> <code class="swift hljs">{ <span class="hljs-string"><span class="hljs-string">"email"</span></span>: <span class="hljs-string"><span class="hljs-string">"blob@pointfree.co"</span></span>, <span class="hljs-string"><span class="hljs-string">"id"</span></span>: <span class="hljs-number"><span class="hljs-number">42</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"Blob"</span></span> }</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Et nous avons un </font></font><code><font color="#0000FF">Codable</font></code> <code></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">utilisateur </font></font><code><font color="#0000FF">User</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">avec un initialiseur √† partir des donn√©es </font></font><code><font color="#0000FF">json</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">User</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Codable</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> email: <span class="hljs-type"><span class="hljs-type">String</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> id: <span class="hljs-type"><span class="hljs-type">Int</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> name: <span class="hljs-type"><span class="hljs-type">String</span></span> <span class="hljs-keyword"><span class="hljs-keyword">init</span></span>?(json: <span class="hljs-type"><span class="hljs-type">Data</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> newValue = <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>? <span class="hljs-type"><span class="hljs-type">JSONDecoder</span></span>().decode(<span class="hljs-type"><span class="hljs-type">User</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>, from: json) { <span class="hljs-keyword"><span class="hljs-keyword">self</span></span> = newValue } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">nil</span></span> } } }</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous pouvons tr√®s facilement obtenir un nouvel utilisateur </font></font><code><font color="#0000FF">newUser</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">avec un code fonctionnel encore plus simple:</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> newUser = <span class="hljs-type"><span class="hljs-type">Bundle</span></span>.main.path(forResource: <span class="hljs-string"><span class="hljs-string">"user"</span></span>, ofType: <span class="hljs-string"><span class="hljs-string">"json"</span></span>) .<span class="hljs-built_in"><span class="hljs-built_in">map</span></span>(<span class="hljs-type"><span class="hljs-type">URL</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>(fileURLWithPath:)) .flatMap { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>? <span class="hljs-type"><span class="hljs-type">Data</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>(contentsOf: $<span class="hljs-number"><span class="hljs-number">0</span></span>) } .flatMap { <span class="hljs-type"><span class="hljs-type">User</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>(json: $<span class="hljs-number"><span class="hljs-number">0</span></span>) }</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">De toute √©vidence, le TYPE </font></font><code><font color="#0000FF">newUser</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sera </font></font><code><font color="#0000FF">Optional</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, c'est-√†-dire</font></font><code><font color="#0000FF">User?</font></code>  : <br><br><img src="https://habrastorage.org/webt/ws/hp/ba/wshpbajpp-wrpb00sxusmhycttk.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Supposons que nous </font></font><code>Resources</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ayons un autre fichier avec un nom </font><font style="vertical-align: inherit;">dans l'annuaire </font></font><code>invoices.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et qui contienne des informations sur les factures de cet utilisateur.</font></font><br><br><pre> <code class="swift hljs">[ { <span class="hljs-string"><span class="hljs-string">"amountPaid"</span></span>: <span class="hljs-number"><span class="hljs-number">1000</span></span>, <span class="hljs-string"><span class="hljs-string">"amountDue"</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">"closed"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-string"><span class="hljs-string">"id"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span> }, { <span class="hljs-string"><span class="hljs-string">"amountPaid"</span></span>: <span class="hljs-number"><span class="hljs-number">500</span></span>, <span class="hljs-string"><span class="hljs-string">"amountDue"</span></span>: <span class="hljs-number"><span class="hljs-number">500</span></span>, <span class="hljs-string"><span class="hljs-string">"closed"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"id"</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span> } ]</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous pouvons charger ces donn√©es exactement comme nous l'avons fait avec </font></font><code><font color="#0000FF">User</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">D√©finissons la structure comme un mod√®le de facture </font></font><code><font color="#0000FF">struct Invoice</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">...</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Invoice</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Codable</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> amountDue: <span class="hljs-type"><span class="hljs-type">Int</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> amountPaid: <span class="hljs-type"><span class="hljs-type">Int</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> closed: <span class="hljs-type"><span class="hljs-type">Bool</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> id: <span class="hljs-type"><span class="hljs-type">Int</span></span> }</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">... et d√©codez le </font></font><code>JSON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tableau de factures </font><font style="vertical-align: inherit;">pr√©sent√© ci </font></font><code><font color="#0000FF">invoices</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font><font style="vertical-align: inherit;">dessus </font><font style="vertical-align: inherit;">, en ne modifiant que le chemin d'acc√®s au fichier et la logique de d√©codage </font></font><code><font color="#0000FF">decode</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> invoices = <span class="hljs-type"><span class="hljs-type">Bundle</span></span>.main.path(forResource: <span class="hljs-string"><span class="hljs-string">"invoices"</span></span>, ofType: <span class="hljs-string"><span class="hljs-string">"json"</span></span>) .<span class="hljs-built_in"><span class="hljs-built_in">map</span></span>( <span class="hljs-type"><span class="hljs-type">URL</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>(fileURLWithPath:) ) .flatMap { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>? <span class="hljs-type"><span class="hljs-type">Data</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>(contentsOf: $<span class="hljs-number"><span class="hljs-number">0</span></span>) } .flatMap { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>? <span class="hljs-type"><span class="hljs-type">JSONDecoder</span></span>().decode([<span class="hljs-type"><span class="hljs-type">Invoice</span></span>].<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>, from: $<span class="hljs-number"><span class="hljs-number">0</span></span>) }</code> </pre><br> <code></code> <code><font color="#0000FF">invoices</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sera </font></font><code><font color="#0000FF">[Invoice]?</font></code>  : <br><br><img src="https://habrastorage.org/webt/rk/-s/l0/rk-sl0uz-jcgqfdxuqlrzhpbrby.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Maintenant, nous souhaitons connecter l'utilisateur </font></font><code><font color="#0000FF">user</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√† ses factures </font></font><code><font color="#0000FF">invoices</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, si elles ne sont pas √©gales </font></font><code><font color="#0000FF">nil</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, et enregistrer, par exemple, dans la structure de l'enveloppe </font></font><code><font color="#0000FF">UserEnvelope</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">qui est envoy√©e √† l'utilisateur avec ses factures:</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UserEnvelope</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> user: <span class="hljs-type"><span class="hljs-type">User</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> invoices: [<span class="hljs-type"><span class="hljs-type">Invoice</span></span>] }</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Au lieu de jouer deux fois </font></font><code><font color="#0000FF">if let</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">...</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> newUser = newUser, <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> invoices = invoices { }</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">... √©crivons un analogue fonctionnel du double </font></font><code><font color="#0000FF">if let</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">comme </font></font><code>Generic</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fonction </font><font style="vertical-align: inherit;">auxiliaire </font></font><code><font color="#0000FF">zip</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">qui convertit deux </font></font><code><font color="#0000FF">Optional</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">valeurs en un </font></font><code><font color="#0000FF">Optional</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tuple:</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">zip</span></span></span><span class="hljs-function">&lt;A, B&gt;</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> a: A?, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> b: B?)</span></span></span></span> -&gt; (<span class="hljs-type"><span class="hljs-type">A</span></span>, <span class="hljs-type"><span class="hljs-type">B</span></span>)? { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> a = a, <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> b = b { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (a, b) } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">nil</span></span> }</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Maintenant, nous n'avons aucune raison d'assigner quelque chose aux variables </font></font><code><font color="#0000FF">newUser</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et </font></font><code><font color="#0000FF">invoices</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, nous construisons tout simplement dans notre nouvelle fonction </font></font><code><font color="#0000FF">zip</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, utilisons l'initialiseur </font></font><code><font color="#0000FF">UserEnvelope.init</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et tout fonctionnera!</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> userEnv = <span class="hljs-built_in"><span class="hljs-built_in">zip</span></span>( <span class="hljs-type"><span class="hljs-type">Bundle</span></span>.main.path(forResource: <span class="hljs-string"><span class="hljs-string">"user"</span></span>, ofType: <span class="hljs-string"><span class="hljs-string">"json"</span></span>) .<span class="hljs-built_in"><span class="hljs-built_in">map</span></span>(<span class="hljs-type"><span class="hljs-type">URL</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>(fileURLWithPath:)) .flatMap { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>? <span class="hljs-type"><span class="hljs-type">Data</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>(contentsOf: $<span class="hljs-number"><span class="hljs-number">0</span></span>) } .flatMap { <span class="hljs-type"><span class="hljs-type">User</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>(json: $<span class="hljs-number"><span class="hljs-number">0</span></span>) }, <span class="hljs-type"><span class="hljs-type">Bundle</span></span>.main.path(forResource: <span class="hljs-string"><span class="hljs-string">"invoices"</span></span>, ofType: <span class="hljs-string"><span class="hljs-string">"json"</span></span>) .<span class="hljs-built_in"><span class="hljs-built_in">map</span></span>(<span class="hljs-type"><span class="hljs-type">URL</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>(fileURLWithPath:)) .flatMap { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>? <span class="hljs-type"><span class="hljs-type">Data</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>(contentsOf: $<span class="hljs-number"><span class="hljs-number">0</span></span>) } .flatMap { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>? <span class="hljs-type"><span class="hljs-type">JSONDecoder</span></span>().decode([<span class="hljs-type"><span class="hljs-type">Invoice</span></span>].<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>, from: $<span class="hljs-number"><span class="hljs-number">0</span></span>) } ).flatMap (<span class="hljs-type"><span class="hljs-type">UserEnvelope</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>) <span class="hljs-built_in"><span class="hljs-built_in">print</span></span> (<span class="hljs-string"><span class="hljs-string">"\(userEnv!)"</span></span>) <span class="hljs-comment"><span class="hljs-comment">// UserEnvelope(user: id: 42 name: Blob , // invoices: [id: 1 amountDue: 0 amountPaid: 1000 closed: true, // id: 2 amountDue: 500 amountPaid: 500 closed: false])</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dans une seule expression, un algorithme complet pour fournir des </font></font><code>JSON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">donn√©es √† une forme complexe </font></font><code></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sous la forme d'une structure est </font><font style="vertical-align: inherit;">emball√© </font></font><code><font color="#0000FF">struct UserEnvelope</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br><br><ul><li>    <code><font color="#0000FF">zip</font></code> ,  ,         .     <code><font color="#0000FF">user</font></code> , <code>JSON</code>   ,    <code><font color="#0000FF">invoices</font></code> ,      <code>JSON</code> .         . </li><li>    <code><font color="#0000FF">map</font></code> ,  ,   ¬´¬ª       . </li><li>    <code><font color="#0000FF">flatMap</font></code> ,  ,        ,     . </li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Op√©rations </font></font><code><font color="#0000FF">zip</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code><font color="#0000FF">map</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et </font></font><code><font color="#0000FF">flatMap</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">repr√©sentent une sorte de </font></font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">langage sp√©cifique au domaine (DSL)</font></font></a></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pour la conversion des donn√©es. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous pouvons d√©velopper cette d√©monstration pour repr√©senter la lecture asynchrone du contenu d'un fichier comme une fonction sp√©ciale que vous pouvez voir sur </font></font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pointfree.co</font></font></a></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Je ne suis pas un fanatique de la </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">programmation fonctionnelle</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> partout et en tout, mais une utilisation mod√©r√©e me semble souhaitable.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Conclusion </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">J'ai donn√© des </font><font style="vertical-align: inherit;">exemples de divers programmes fonctionnels caract√©ristiques </font></font><code>Swf</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t ¬´hors de la bo√Æte ¬ª, bas√©e sur l'utilisation des fonctions d'ordre sup√©rieur </font></font><code><font color="#0000FF">map</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code><font color="#0000FF">flatMap</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code><font color="#0000FF">reduce</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code><font color="#0000FF">filter</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et l'autre pour les s√©quences </font></font><code><font color="#0000FF">Sequence</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code><font color="#0000FF">Optional</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et </font></font><code><font color="#0000FF">Result</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Ils peuvent √™tre les ¬´chevaux de bataille¬ª de la cr√©ation de code, </font></font><code>,</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">surtout si des </font></font><code></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">structures de </font><font style="vertical-align: inherit;">valeur </font></font><code><font color="#0000FF">struct</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et des √©num√©rations y sont </font><font style="vertical-align: inherit;">impliqu√©es </font></font><code><font color="#0000FF">enum</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Un d√©veloppeur d' </font></font><code>iOS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">application doit poss√©der cet outil. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Toutes les d√©mos compil√©es </font></font><code>Playground</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">peuvent √™tre trouv√©es sur </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Github</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Si vous avez des probl√®mes avec le lancement </font></font><code>Playground</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, vous pouvez voir cet article:</font></font><br><br> <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comment se d√©barrasser des erreurs de ¬´gel¬ª de Xcode Playground avec les messages ¬´Launching Simulator¬ª et ¬´Running Playground¬ª.</font></font></a></b> <br><br>  R√©f√©rences: <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">Functional Programming in Swift: An Introduction.</a> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">An Introduction to Functional Programming in Swift.</a> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">The Many Faces of Flat-Map: Part 3</a> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">Inside the Standard Library: Sequence.map()</a> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">Practical functional programming in Swift</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr440722/">https://habr.com/ru/post/fr440722/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr440712/index.html">Le cloud n'est que l'ordinateur de quelqu'un</a></li>
<li><a href="../fr440714/index.html">Comment la baisse du taux d'acquisition nous affecte (titulaires de carte)</a></li>
<li><a href="../fr440716/index.html">Mise en place du plus grand IDCS pr√©-assembl√© pour les pouvoirs publics √† Volgograd</a></li>
<li><a href="../fr440718/index.html">Transfert de donn√©es inter-sc√®nes dans Unity - Application de plusieurs valeurs √† un d√©veloppement de jeu simple</a></li>
<li><a href="../fr440720/index.html">Nous impl√©mentons l'interface utilisateur dans iOS: nous am√©liorons, acc√©l√©rons, √©voluons</a></li>
<li><a href="../fr440724/index.html">S√©lection: 4 services utiles pour les immigrants potentiels aux √âtats-Unis, en Europe et dans d'autres pays</a></li>
<li><a href="../fr440726/index.html">Le jeu des arch√©types: comment la narration fonctionne pour les marques technologiques</a></li>
<li><a href="../fr440728/index.html">D√©veloppement mobile: de l'id√©e √† l'estimation des co√ªts</a></li>
<li><a href="../fr440732/index.html">Mettre √† niveau une carte de d√©bogage avec un processeur Baikal-T1: ajoutez une carte SD</a></li>
<li><a href="../fr440734/index.html">Session ouverte en vue dans Spring Boot: The Phantom Menace</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>