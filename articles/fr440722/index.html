<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧓 🚄 🚵 Un peu de pratique de la programmation fonctionnelle dans Swift pour les débutants 🎌 😌 👨🏽‍🤝‍👨🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Je voudrais présenter le concept de programmation fonctionnelle aux débutants de la manière la plus simple, en soulignant certains de ses avantages pa...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Un peu de pratique de la programmation fonctionnelle dans Swift pour les débutants</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/440722/"><img src="https://habrastorage.org/webt/r4/cx/wi/r4cxwi9bjlhswlncf4ru1uslm4q.png"><br><br>  Je voudrais présenter le concept de <i>programmation fonctionnelle aux</i> débutants de la manière la plus simple, en soulignant certains de ses avantages parmi les nombreux autres qui rendront vraiment le code plus lisible et expressif.  J'ai ramassé pour vous quelques démos intéressantes qui sont sur le <code>Playground</code> sur <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">Github</a></b> . <br><br><h2>  Programmation fonctionnelle: définition </h2><br>  Tout d'abord, la <i>programmation fonctionnelle</i> n'est pas un langage ou une syntaxe, mais très probablement un moyen de résoudre des problèmes en divisant des processus complexes en processus plus simples et leur composition ultérieure.  Comme son nom l'indique, « <i>Programmation fonctionnelle</i> », l'unité de composition de cette approche est une <i>fonction</i> ;  et le but d'une telle <i>fonction</i> est d'éviter de changer d'état ou de valeurs en dehors de sa <code>scope)</code> . <br><br>  Dans <code>Swift</code> World, il y a toutes les conditions pour cela, car les <i>fonctions</i> sont ici des participants à part entière au processus de programmation comme des <i>objets,</i> et le problème de la <code>mutation</code> est résolu au niveau du concept de <code>value</code> TYPES ( <code><font color="#0000FF">struct</font></code> structures et <code><font color="#0000FF">enum</font></code> énumérations) qui aident à gérer la mutabilité ( <code>mutation</code> ) et communiquer clairement comment et quand cela peut se produire. <br><br>  Cependant, <code>Swift</code> pas au sens plein du langage de <i>programmation fonctionnelle</i> , il ne vous oblige pas à la <i>programmation fonctionnelle</i> , bien qu'il reconnaisse les avantages des approches <i>fonctionnelles</i> et trouve des moyens de les intégrer. <br><br>  Dans cet article, nous allons nous concentrer sur l'utilisation des éléments intégrés de la <i>programmation fonctionnelle</i> dans <code>Swift</code> (c'est-à-dire «prêts à l'emploi») et comprendre comment vous pouvez les utiliser confortablement dans votre application. <br><a name="habracut"></a><br><h2>  Approches impératives et fonctionnelles: comparaison </h2><br>  Pour évaluer l'approche <i>fonctionnelle</i> , comparons les solutions à un problème simple de deux manières différentes.  La première solution est « <i>impérative</i> », dans laquelle le code change l'état à l'intérieur du programme. <br><br><pre> <code class="swift hljs"><span class="hljs-comment"><span class="hljs-comment">//Imperative Approach var numbers = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10] for i in 0..&lt;numbers.count { let timesTen = numbers[i] * 10 numbers[i] = timesTen } print(numbers) //[10, 20, 30, 40, 50, 60, 70, 80, 90, 100]</span></span></code> </pre><br>  Notez que nous manipulons les valeurs à l'intérieur du tableau mutable nommé <code><font color="#0000FF">numbers</font></code> , puis l'imprimons sur la console.  En regardant ce code, essayez de répondre aux questions suivantes dont nous discuterons dans un proche avenir: <br><br><ol><li>  Qu'essayez-vous de réaliser avec votre code? </li><li>  Que se passe-t-il si un autre <code>thread</code> tente d'accéder au tableau de <code><font color="#0000FF">numbers</font></code> pendant l'exécution de votre code? </li><li>  Que se passe-t-il si vous souhaitez avoir accès aux valeurs d'origine dans le tableau des <code><font color="#0000FF">numbers</font></code> ? </li><li>  Dans quelle mesure ce code peut-il être testé? </li></ol><br>  Examinons maintenant une approche alternative " <i>fonctionnelle</i> ": <br><br><pre> <code class="swift hljs"><span class="hljs-comment"><span class="hljs-comment">//Functional Approach let numbers = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10] extension Array where Element == Int { func timesTen() -&gt; [Int] { var output = [Int]() for num in self { output.append(num * 10) } return output } } let result = numbers.timesTen() print(numbers) //[1, 2, 3, 4, 5, 6, 7, 8, 9, 10] print(result) //[10, 20, 30, 40, 50, 60, 70, 80, 90, 100]</span></span></code> </pre><br>  Dans ce morceau de code, nous obtenons le même résultat sur la console, en abordant la solution au problème d'une manière complètement différente.  Notez que cette fois notre tableau de <code><font color="#0000FF">numbers</font></code> est immuable grâce au mot clé <code><font color="#0000FF">let</font></code> .  Nous avons déplacé le processus de multiplication des nombres du tableau de <code><font color="#0000FF">numbers</font></code> vers la méthode <code><font color="#0000FF">timesTen()</font></code> , qui se trouve dans l'extension d' <code><font color="#0000FF">extension</font></code> <code><font color="#0000FF">Array</font></code> .  Nous utilisons toujours une boucle <code><font color="#0000FF">for</font></code> et modifions une variable appelée <code><font color="#0000FF">output</font></code> , mais la <code>scope</code> cette variable n'est limitée que par cette méthode.  De même, notre argument d'entrée <code><font color="#0000FF">self</font></code> est passé à la méthode <code><font color="#0000FF">timesTen()</font></code> par valeur ( <code>by value</code> ), ayant la même portée que la sortie variable de <code><font color="#0000FF">output</font></code> .  La méthode <code><font color="#0000FF">timesTen()</font></code> est appelée et nous pouvons imprimer sur la console à la fois le tableau de <code><font color="#0000FF">numbers</font></code> origine et le résultat du tableau de <code><font color="#0000FF">result</font></code> . <br>  Revenons à nos 4 questions. <br><br>  <i>1. Qu'essayez-vous de réaliser avec votre code?</i> <br><br>  Dans notre exemple, nous effectuons une tâche très simple en multipliant les nombres dans le tableau de <code><font color="#0000FF">numbers</font></code> par <code><font color="#0000FF">10</font></code> . <br><br>  Avec une approche <i>impérative</i> , pour obtenir une sortie, vous devez penser comme un ordinateur, en suivant les instructions de la boucle <code><font color="#0000FF">for</font></code> .  Dans ce cas, le code indique <code></code> vous obtenez le résultat.  Avec l'approche <i>fonctionnelle</i> , « <code></code> » est « <code><font color="#0000FF">timesTen()</font></code> » dans la méthode <code><font color="#0000FF">timesTen()</font></code> .  À condition que cette méthode ait été implémentée ailleurs, vous ne pouvez vraiment voir que l'expression <code><font color="#0000FF">numbers.timesTen()</font></code> .  Un tel code montre clairement ce qui <code></code> réalisé par ce code, et non <code></code> la tâche est résolue.  C'est ce qu'on appelle la <i>programmation déclarative</i> , et il est facile de deviner pourquoi une telle approche est intéressante.  <i>L'</i> approche <i>impérative</i> permet au développeur de comprendre le <code></code> code afin de déterminer <code></code> qu'il doit faire.  <i>L'</i> approche <i>fonctionnelle</i> par rapport à l'approche <i>impérative</i> est beaucoup plus «expressive» et offre au développeur une occasion luxueuse de simplement supposer que la méthode fait ce qu'elle prétend faire!  (Évidemment, cette hypothèse ne s'applique qu'au code pré-vérifié). <br><br>  <i>2. Que se passe-t-il si un autre <code>thread</code> essaie d'accéder au tableau de <code><font color="#0000FF">numbers</font></code> pendant l'exécution de votre code?</i> <br><br>  Les exemples présentés ci-dessus existent dans un espace complètement isolé, bien que dans un environnement multithread complexe, il est tout à fait possible que deux <code>threads</code> tentent d'accéder simultanément aux mêmes ressources.  Dans le cas de l'approche <i>impérative</i> , il est facile de voir que lorsqu'un autre <code>thread</code> a accès au tableau de <code><font color="#0000FF">numbers</font></code> en cours d'utilisation, le résultat sera dicté par l'ordre dans lequel les <code>threads</code> accèdent au tableau de <code><font color="#0000FF">numbers</font></code> .  Cette situation est appelée <code>race condition</code> et peut entraîner un comportement imprévisible et même une instabilité et un crash de l'application. <br><br>  En comparaison, l'approche <i>fonctionnelle</i> n'a pas «d'effets secondaires».  En d'autres termes, la sortie de la méthode de <code><font color="#0000FF">output</font></code> ne modifie aucune valeur stockée dans notre système et est déterminée uniquement par l'entrée.  Dans ce cas, tout thread ( <code>threads</code> ) ayant accès au tableau de <code><font color="#0000FF">numbers</font></code> recevra TOUJOURS les mêmes valeurs et son comportement sera stable et prévisible. <br><br>  3. Que se passe-t-il si vous souhaitez avoir accès aux valeurs d'origine stockées dans le tableau de <code><font color="#0000FF">numbers</font></code> ? <br><br>  Il s'agit d'une continuation de notre discussion sur les «effets secondaires».  De toute évidence, les changements d'état ne sont pas suivis.  Par conséquent, avec l'approche <i>impérative</i> , nous perdons l'état initial de notre tableau de <code><font color="#0000FF">numbers</font></code> pendant le processus de conversion.  Notre solution, basée sur l'approche <i>fonctionnelle</i> , enregistre le tableau de <code><font color="#0000FF">numbers</font></code> origine et génère un nouveau tableau de <code><font color="#0000FF">result</font></code> avec les propriétés souhaitées en sortie.  Il laisse le tableau de <code><font color="#0000FF">numbers</font></code> origine intact et adapté pour un traitement ultérieur. <br><br>  4. Dans quelle mesure ce code peut-il être testé? <br><br>  Puisque l'approche <i>fonctionnelle</i> détruit tous les «effets secondaires», la fonctionnalité testée est complètement à l'intérieur de la méthode.  L'entrée de cette méthode ne sera JAMAIS modifiée, vous pouvez donc la tester plusieurs fois en utilisant la boucle autant de fois que vous le souhaitez, et vous obtiendrez TOUJOURS le même résultat.  Dans ce cas, le test est très simple.  En comparaison, tester la solution <i>Imperative</i> en boucle changera le début de l'entrée et vous obtiendrez des résultats complètement différents après chaque itération. <br><br><h2>  Résumé des avantages </h2><br>  Comme nous l'avons vu à partir d'un exemple très simple, l'approche <i>fonctionnelle</i> est une bonne chose si vous avez affaire à un modèle de données car: <br><br><ul><li>  C'est déclaratif </li><li>  Il corrige les problèmes liés aux threads comme les <code>race condition</code> concurrence et les blocages </li><li>  Il laisse l'état inchangé, qui peut être utilisé pour des transformations ultérieures. </li><li>  C'est facile à tester. </li></ul><br>  Allons un peu plus loin dans l'apprentissage de la programmation <i>fonctionnelle</i> dans <code>Swift</code> .  Il suppose que les principaux «acteurs» sont des fonctions, et ils devraient être principalement des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">objets de première classe</a> . <br><br><h2>  Fonctions de première classe et fonctions d'ordre supérieur </h2><br>  Pour qu'une fonction soit de première classe, elle doit pouvoir être déclarée comme variable.  Cela vous permet de gérer la fonction comme un TYPE normal de données et de l'exécuter en même temps.  Heureusement, dans <code>Swift</code> fonctions sont des objets de première classe, c'est-à-dire qu'elles sont prises en charge en les passant comme arguments à d'autres fonctions, en les renvoyant à la suite d'autres fonctions, en les affectant à des variables ou en les stockant dans des structures de données. <br><br>  Pour cette raison, nous avons d'autres fonctions dans <code>Swift</code> - des fonctions d'ordre supérieur qui sont définies comme des fonctions qui prennent une autre fonction en argument ou retournent une fonction.  Il y en a beaucoup: <code><font color="#0000FF">map</font></code> , <code><font color="#0000FF">filter</font></code> , <code><font color="#0000FF">reduce</font></code> , <code><font color="#0000FF">forEach</font></code> , <code><font color="#0000FF">flatMap</font></code> , <code><font color="#0000FF">compactMap</font></code> , <code><font color="#0000FF">sorted</font></code> , etc.  Les exemples les plus courants de fonctions d'ordre supérieur sont <code><font color="#0000FF">map</font></code> , <code><font color="#0000FF">filter</font></code> et <code><font color="#0000FF">reduce</font></code> .  Ils ne sont pas globaux, ils sont tous «attachés» à certains TYPES.  Ils fonctionnent sur tous les TYPES de <code><font color="#0000FF">Sequence</font></code> , y compris la <code><font color="#0000FF">Collection</font></code> , qui est représentée par des structures de données <code>Swift</code> telles qu'un <code><font color="#0000FF">Array</font></code> , un <code><font color="#0000FF">Dictionary</font></code> et un <code><font color="#0000FF">Set</font></code> .  Dans <code>Swift 5</code> , les fonctions d'ordre supérieur fonctionnent également avec un tout nouveau TYPE - <code><font color="#0000FF">Result</font></code> . <br><br><h2> <code><font color="#0000FF">map(_:)</font></code> </h2> <br>  Dans <code>Swift</code> <code><font color="#0000FF">map(_:)</font></code> prend une fonction comme paramètre et convertit les valeurs d'un certain <code></code> fonction de cette fonction.  Par exemple, en appliquant <code><font color="#0000FF">map(_:)</font></code> à un tableau de valeurs de <code><font color="#0000FF">Array</font></code> , nous appliquons une fonction de paramètre à chaque élément du tableau d'origine et nous obtenons un tableau de <code><font color="#0000FF">Array</font></code> , mais également les valeurs converties. <br><br><pre> <code class="swift hljs"><span class="hljs-comment"><span class="hljs-comment">//Functional Approach let numbers = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10] func timesTen(_ x:Int) -&gt; Int { return x * 10 } let result = numbers.map (timesTen) print(numbers) //[1, 2, 3, 4, 5, 6, 7, 8, 9, 10] print(result) //[10, 20, 30, 40, 50, 60, 70, 80, 90, 100]</span></span></code> </pre><br>  Dans le code ci-dessus, nous avons créé la fonction <code><font color="#0000FF">timesTen (_:Int)</font></code> , qui prend une valeur entière <code><font color="#0000FF">Int</font></code> et renvoie la valeur entière <code><font color="#0000FF">Int</font></code> multipliée par <code><font color="#0000FF">10</font></code> , et l'avons utilisée comme paramètre d'entrée de notre fonction de <code><font color="#0000FF">map(_:)</font></code> ordre supérieur <code><font color="#0000FF">map(_:)</font></code> , en l'appliquant à notre tableau <code><font color="#0000FF">numbers</font></code> .  Nous avons obtenu le résultat dont nous avons besoin dans le tableau de <code><font color="#0000FF">result</font></code> . <br><br>  Le nom de la fonction de paramètre <code><font color="#0000FF">timesTen</font></code> pour les fonctions d'ordre supérieur comme <code><font color="#0000FF">map(_:)</font></code> n'a pas d'importance, le <code></code> paramètre d'entrée et la valeur de retour sont importants, c'est-à-dire la signature <code><font color="#0000FF">(Int) -&gt; Int</font></code> paramètre d'entrée de fonction.  Par conséquent, nous pouvons utiliser des fonctions anonymes dans <code><font color="#0000FF">map(_:)</font></code> - fermetures - sous n'importe quelle forme, y compris celles avec des noms d'arguments raccourcis <code><font color="#0000FF">$0</font></code> , <code><font color="#0000FF">$1</font></code> , etc. <br><br><pre> <code class="swift hljs"><span class="hljs-comment"><span class="hljs-comment">//Functional Approach let numbers = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10] let result = numbers.map { $0 * 10 } print(numbers) //[1, 2, 3, 4, 5, 6, 7, 8, 9, 10] print(result) //[10, 20, 30, 40, 50, 60, 70, 80, 90, 100]</span></span></code> </pre><br>  Si nous regardons la fonction <code><font color="#0000FF">map(_ :)</font></code> pour un <code><font color="#0000FF">Array</font></code> , cela pourrait ressembler à ceci: <br><br><pre> <code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">map</span></span></span><span class="hljs-function">&lt;T&gt;</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> transform: </span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">(Element)</span></span></span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">T</span></span>) -&gt; [<span class="hljs-type"><span class="hljs-type">T</span></span>] { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> returnValue = [<span class="hljs-type"><span class="hljs-type">T</span></span>]() <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> item <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span> { returnValue.append(transform(item)) } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> returnValue }</code> </pre><br>  C'est un code impératif qui nous est familier, mais ce n'est plus un problème de développeur, c'est un problème <code>Apple</code> , un problème <code>Swift</code> .  L'implémentation de la fonction <code><font color="#0000FF">map(_:)</font></code> supérieur est optimisée par <code>Apple</code> en termes de performances, et nous, les développeurs, avons la garantie de la fonctionnalité <code><font color="#0000FF">map(_:)</font></code> , de sorte que nous ne pouvons exprimer correctement avec l'argument de la fonction de <code><font color="#0000FF">transform</font></code> <code></code> nous voulons sans nous soucier de <code></code> il sera mis en œuvre.  En conséquence, nous obtenons du code parfaitement lisible sous la forme d'une seule ligne, qui fonctionnera mieux et plus rapidement. <br><br><pre> <code class="swift hljs"><span class="hljs-comment"><span class="hljs-comment">//Functional Approach let possibleNumbers = ["1", "2", "three", "///4///", "5"] let mapped = possibleNumbers.map {str in Int(str) } print (mapped) // [Optional(1), Optional(2), nil, nil, Optional(5)]</span></span></code> </pre><br>  Le <code></code> renvoyé par la fonction de paramètre peut ne pas coïncider avec le <code></code> éléments de la collection d'origine. <br><br>  Dans le code ci-dessus, nous avons des entiers <code><font color="#0000FF">possibleNumbers</font></code> , représentés sous forme de chaînes, et nous voulons les convertir en entiers de <code></code> <code><font color="#0000FF">Int</font></code> , en utilisant l'initialiseur disponible <code><font color="#0000FF">Int(_ :String)</font></code> représenté par la fermeture <code><font color="#0000FF">{ str in Int(str) }</font></code> .  Nous faisons cela en utilisant <code><font color="#0000FF">map(_:)</font></code> et obtenons un tableau <code><font color="#0000FF">mapped</font></code> de <code></code> <code><font color="#0000FF">Optional</font></code> comme sortie: <br><br><img src="https://habrastorage.org/webt/43/mg/hd/43mghd5aphvgnytu06eos4zhxos.png"><br><br>  Nous n'avons <code></code> convertir <code></code> éléments de notre tableau <code><font color="#0000FF">possibleNumbers</font></code> en nombres entiers.En conséquence, une partie a reçu la valeur <code><font color="#0000FF">nil</font></code> , indiquant l'impossibilité de convertir la <code><font color="#0000FF">String</font></code> en un entier <code><font color="#0000FF">Int</font></code> , et l'autre partie transformée en <code><font color="#0000FF">Optionals</font></code> , qui ont des valeurs: <br><br><pre> <code class="swift hljs"><span class="hljs-built_in"><span class="hljs-built_in">print</span></span> (mapped) <span class="hljs-comment"><span class="hljs-comment">// [Optional(1), Optional(2), nil, nil, Optional(5)]</span></span></code> </pre><br><h2> <code><font color="#0000FF">compactMap(_ :)</font></code> </h2> <br>  Si la fonction de paramètre transmise à la fonction d'ordre supérieur a une valeur <code><font color="#0000FF">Optional</font></code> à la sortie, il peut être plus utile d'utiliser une autre fonction d'un ordre supérieur, de signification similaire - <code><font color="#0000FF">compactMap(_ :)</font></code> , qui fait la même chose que <code><font color="#0000FF">map(_:)</font></code> , mais «étend» en outre les valeurs reçues à la sortie <code><font color="#0000FF">Optional</font></code> et supprime les valeurs <code><font color="#0000FF">nil</font></code> de la collection. <br><br><img src="https://habrastorage.org/webt/ie/a8/ls/iea8lshgmocoqytj8horz--kx0k.png"><br><br>  Dans ce cas, nous obtenons un tableau de TYPE <code><font color="#0000FF">compactMapped</font></code> <code><font color="#0000FF">[Int]</font></code> , mais peut-être plus petit: <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> possibleNumbers = [<span class="hljs-string"><span class="hljs-string">"1"</span></span>, <span class="hljs-string"><span class="hljs-string">"2"</span></span>, <span class="hljs-string"><span class="hljs-string">"three"</span></span>, <span class="hljs-string"><span class="hljs-string">"///4///"</span></span>, <span class="hljs-string"><span class="hljs-string">"5"</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> compactMapped = possibleNumbers.compactMap(<span class="hljs-type"><span class="hljs-type">Int</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>) <span class="hljs-built_in"><span class="hljs-built_in">print</span></span> (compactMapped) <span class="hljs-comment"><span class="hljs-comment">// [1, 2, 5]</span></span></code> </pre><br><img src="https://habrastorage.org/webt/wl/wf/ae/wlwfaep3tzyxrennftqqdtwezb8.png"><br><br>  Chaque fois que vous utilisez l' <code><font color="#0000FF">init?()</font></code> Comme fonction de transformation, vous devrez utiliser <code><font color="#0000FF">compactMap(_ :)</font></code> : <br><br><pre> <code class="swift hljs"><span class="hljs-comment"><span class="hljs-comment">// Validate URLs let strings = ["https://demo0989623.mockable.io/car/1", "https://i.imgur.com/Wm1xcNZ.jpg"] let validateURLs = strings.compactMap(URL.init) // Separate Numbers and Operations let mathString: String = "12-37*2/5+44" let numbers1 = mathString.components(separatedBy: ["-", "*", "+", "/"]).compactMap(Int.init) print(numbers1) // [12, 37, 2, 5, 44]</span></span></code> </pre><br>  Je dois dire qu'il y a plus qu'assez de raisons d'utiliser la fonction <code><font color="#0000FF">compactMap(_ :)</font></code> ordre <code><font color="#0000FF">compactMap(_ :)</font></code> .  <code>Swift</code> «loves» Valeurs <code><font color="#0000FF">Optional</font></code> , elles peuvent être obtenues non seulement en utilisant l' <code>failable</code> « <code>failable</code> » <code><font color="#0000FF">init?()</font></code> , Mais aussi en utilisant le <code><font color="#0000FF">as?</font></code>  <code></code> "Casting": <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> views = [innerView,shadowView,logoView] <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> imageViews = views.compactMap{$<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">as</span></span>? <span class="hljs-type"><span class="hljs-type">UIImageView</span></span>}</code> </pre><br>  ... et l' <code><font color="#0000FF">try?</font></code>  lors du traitement des erreurs lancées par certaines méthodes.  Je dois dire <code>Apple</code> craint que l'utilisation d' <code><font color="#0000FF">try?</font></code>  conduit très souvent au double <code><font color="#0000FF">Optional</font></code> et dans <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Swift 5</a> ne laisse plus qu'un seul niveau <code><font color="#0000FF">Optional</font></code> après avoir appliqué l' <code><font color="#0000FF">try?</font></code>  . <br><br>  Il existe une autre fonction similaire au nom du <code><font color="#0000FF">flatMap(_ :)</font></code> ordre <code><font color="#0000FF">flatMap(_ :)</font></code> , dont un peu plus bas. <br><br>  Parfois, pour utiliser la <code><font color="#0000FF">map(_:)</font></code> fonction d'ordre supérieur <code><font color="#0000FF">map(_:)</font></code> , il est utile d'utiliser la méthode <code><font color="#0000FF">zip (_:, _:)</font></code> pour créer une séquence de paires à partir de deux séquences différentes. <br><br>  Supposons que nous ayons une <code><font color="#0000FF">view</font></code> sur laquelle plusieurs points sont représentés, reliés entre eux et formant une ligne brisée: <br><br><img src="https://habrastorage.org/webt/gj/ut/_3/gjut_3xu92asnbvjvibucndse5o.png"><br><br>  Nous devons construire une autre ligne brisée reliant les points médians des segments de la ligne brisée d'origine: <br><br><img src="https://habrastorage.org/webt/zv/hr/ke/zvhrkexsungckflo4orcpnkkm7e.png"><br><br>  Pour calculer le milieu d'un segment, nous devons avoir les coordonnées de deux points: le courant et le suivant.  Pour ce faire, nous pouvons créer une séquence composée de paires de points - le courant et le suivant - en utilisant la méthode <code><font color="#0000FF">zip (_:, _:)</font></code> <code><font color="#0000FF">points.dropFirst()</font></code> <code><font color="#0000FF">zip (_:, _:)</font></code> , dans laquelle nous utiliserons le tableau de points de départ et le tableau des <code><font color="#0000FF">points</font></code> suivants.dropFirst <code><font color="#0000FF">points.dropFirst()</font></code> : <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> pairs = <span class="hljs-built_in"><span class="hljs-built_in">zip</span></span> (points,points.<span class="hljs-built_in"><span class="hljs-built_in">dropFirst</span></span>()) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> averagePoints = pairs.<span class="hljs-built_in"><span class="hljs-built_in">map</span></span> { <span class="hljs-type"><span class="hljs-type">CGPoint</span></span>(x: ($<span class="hljs-number"><span class="hljs-number">0</span></span>.x + $<span class="hljs-number"><span class="hljs-number">1</span></span>.x) / <span class="hljs-number"><span class="hljs-number">2</span></span>, y: ($<span class="hljs-number"><span class="hljs-number">0</span></span>.y + $<span class="hljs-number"><span class="hljs-number">1</span></span>.y) / <span class="hljs-number"><span class="hljs-number">2</span></span> )}</code> </pre><br>  Avec une telle séquence, nous calculons très facilement les points médians à l'aide de la <code><font color="#0000FF">map(_:)</font></code> fonction d'ordre supérieur <code><font color="#0000FF">map(_:)</font></code> et les affichons sur le graphique. <br><br><h2> <code><font color="#0000FF">filter (_:)</font></code> </h2> <br>  Dans <code>Swift</code> , le <code><font color="#0000FF">filter (_:)</font></code> fonction d'ordre supérieur <code><font color="#0000FF">filter (_:)</font></code> est disponible pour la plupart des <code></code> lesquels la fonction <code><font color="#0000FF">map(_:)</font></code> est disponible.  Vous pouvez filtrer toutes les <code><font color="#0000FF">Sequence</font></code> séquences avec un <code><font color="#0000FF">filter (_:)</font></code> , c'est évident!  La méthode <code><font color="#0000FF">filter (_:)</font></code> prend une autre fonction comme paramètre, qui est une condition pour chaque élément de la séquence, et si la condition est remplie, alors l'élément est inclus dans le résultat et sinon, il n'est pas inclus.  Cette "autre fonction" prend une seule valeur - un élément de la séquence <code><font color="#0000FF">Sequence</font></code> - et renvoie un <code><font color="#0000FF">Bool</font></code> , le soi-disant prédicat. <br><br>  Par exemple, pour les tableaux matriciels, le <code><font color="#0000FF">filter (_:)</font></code> fonction d'ordre supérieur <code><font color="#0000FF">filter (_:)</font></code> applique la fonction de prédicat et renvoie un autre tableau composé uniquement des éléments du tableau d'origine pour lesquels la fonction de prédicat d'entrée renvoie <code><font color="#0000FF">true</font></code> . <br><br><pre> <code class="swift hljs"><span class="hljs-comment"><span class="hljs-comment">//Functional Approach let numbers = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10] let filted = numbers.filter{$0 % 2 == 0} //[2, 4, 6, 8, 10]</span></span></code> </pre><br>  Ici, le <code><font color="#0000FF">filter (_:)</font></code> fonction d'ordre supérieur <code><font color="#0000FF">filter (_:)</font></code> prend chaque élément du tableau de <code><font color="#0000FF">numbers</font></code> (représenté par <code><font color="#0000FF">$0</font></code> ) et vérifie si cet élément est un nombre pair.  S'il s'agit d'un nombre pair, les éléments du tableau de <code><font color="#0000FF">numbers</font></code> tombent dans le nouveau tableau <code><font color="#0000FF">filted</font></code> , sinon non.  Dans une forme déclarative, nous avons informé le programme <code></code> nous voulons obtenir au lieu de nous soucier de <code></code> nous devons le faire. <br><br>  Je vais donner un autre exemple d'utilisation du <code><font color="#0000FF">filter (_:)</font></code> fonction d'ordre supérieur <code><font color="#0000FF">filter (_:)</font></code> pour obtenir uniquement les <code><font color="#0000FF">20</font></code> premiers nombres de Fibonacci pairs avec des valeurs <code><font color="#0000FF">&lt; 4000</font></code> : <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> fibonacci = sequence(first: (<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>), next: { ($<span class="hljs-number"><span class="hljs-number">1</span></span>, $<span class="hljs-number"><span class="hljs-number">0</span></span> + $<span class="hljs-number"><span class="hljs-number">1</span></span>) }) .<span class="hljs-keyword"><span class="hljs-keyword">prefix</span></span>(<span class="hljs-number"><span class="hljs-number">20</span></span>).<span class="hljs-built_in"><span class="hljs-built_in">map</span></span>{$<span class="hljs-number"><span class="hljs-number">0.0</span></span>} .<span class="hljs-built_in"><span class="hljs-built_in">filter</span></span> {$<span class="hljs-number"><span class="hljs-number">0</span></span> % <span class="hljs-number"><span class="hljs-number">2</span></span> == <span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; $<span class="hljs-number"><span class="hljs-number">0</span></span> &lt; <span class="hljs-number"><span class="hljs-number">4000</span></span>} <span class="hljs-built_in"><span class="hljs-built_in">print</span></span> (fibonacci) <span class="hljs-comment"><span class="hljs-comment">// [0, 2, 8, 34, 144, 610, 2584]</span></span></code> </pre><br>  Nous obtenons une séquence de tuples composée de deux éléments de la séquence de Fibonacci: le n-ème et (n + 1) -th: <br><br><pre> <code class="swift hljs">(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>), (<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>), (<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>), (<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>), (<span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>) …</code> </pre><br>  Pour un traitement ultérieur, nous limitons le nombre d'éléments aux vingt et unièmes éléments en utilisant le <code><font color="#0000FF">prefix (20)</font></code> et prenons le <code><font color="#0000FF">0</font></code> élément du tuple généré en utilisant la <code><font color="#0000FF">map {$0.0 }</font></code> , qui correspondra à la séquence de Fibonacci commençant par <code><font color="#0000FF">0</font></code> : <br><br><pre> <code class="swift hljs"><span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, <span class="hljs-number"><span class="hljs-number">21</span></span>, <span class="hljs-number"><span class="hljs-number">34</span></span>, <span class="hljs-number"><span class="hljs-number">55</span></span>, <span class="hljs-number"><span class="hljs-number">89</span></span>, <span class="hljs-number"><span class="hljs-number">144</span></span>, <span class="hljs-number"><span class="hljs-number">233</span></span>, <span class="hljs-number"><span class="hljs-number">377</span></span>, <span class="hljs-number"><span class="hljs-number">610</span></span>, <span class="hljs-number"><span class="hljs-number">987</span></span>, <span class="hljs-number"><span class="hljs-number">1597</span></span>, <span class="hljs-number"><span class="hljs-number">2584</span></span>,...</code> </pre><br>  Nous pourrions prendre le <code><font color="#0000FF">1</font></code> élément du tuple formé en utilisant la <code><font color="#0000FF">map {$0.1 }</font></code> , ce qui correspondrait à la séquence de Fibonacci commençant par <code><font color="#0000FF">1</font></code> : <br><br><pre> <code class="swift hljs"><span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, <span class="hljs-number"><span class="hljs-number">21</span></span>, <span class="hljs-number"><span class="hljs-number">34</span></span>, <span class="hljs-number"><span class="hljs-number">55</span></span>, <span class="hljs-number"><span class="hljs-number">89</span></span>, <span class="hljs-number"><span class="hljs-number">144</span></span>, <span class="hljs-number"><span class="hljs-number">233</span></span>, <span class="hljs-number"><span class="hljs-number">377</span></span>, <span class="hljs-number"><span class="hljs-number">610</span></span>, <span class="hljs-number"><span class="hljs-number">987</span></span>, <span class="hljs-number"><span class="hljs-number">1597</span></span>, <span class="hljs-number"><span class="hljs-number">2584</span></span>,...</code> </pre><br>  Nous obtenons les éléments dont nous avons besoin en utilisant le <code><font color="#0000FF">filter {$0 % 2 == 0 &amp;&amp; $0 &lt; 4000}</font></code> fonction d'ordre supérieur <code><font color="#0000FF">filter {$0 % 2 == 0 &amp;&amp; $0 &lt; 4000}</font></code> , qui retourne un tableau d'éléments de séquence qui satisfont le prédicat donné.  Dans notre cas, ce sera un tableau d'entiers <code><font color="#0000FF">[Int]</font></code> : <br><br><pre> <code class="swift hljs">[<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">34</span></span>, <span class="hljs-number"><span class="hljs-number">144</span></span>, <span class="hljs-number"><span class="hljs-number">610</span></span>, <span class="hljs-number"><span class="hljs-number">2584</span></span>]</code> </pre><br>  Il existe un autre exemple utile d'utilisation du <code><font color="#0000FF">filter (_:)</font></code> pour une <code><font color="#0000FF">Collection</font></code> . <br><br>  J'étais confronté <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">à un vrai problème</a> , lorsque vous avez un tableau d' <code><font color="#0000FF">images</font></code> qui s'affiche à l'aide de <code><font color="#0000FF">CollectionView</font></code> , et en utilisant la technologie <code>Drag &amp; Drop</code> , vous pouvez collecter un tas d'images et les déplacer partout, y compris en les déposant dans " poubelle. " <br><br><img src="https://habrastorage.org/webt/0s/-u/ks/0s-ukstskzfumukk9geirokdl-w.png"><br><br>  Dans ce cas, le tableau d'index <code><font color="#0000FF">removedIndexes</font></code> déversées dans la «poubelle» est fixe, et vous devez créer un nouveau tableau d'images, à l'exclusion de ceux dont les index sont dans le tableau <code><font color="#0000FF">removedIndexes</font></code> .  Supposons que nous ayons un tableau d' <code><font color="#0000FF">images</font></code> entiers qui imite les images, et un tableau d'indices de ces entiers <code><font color="#0000FF">removedIndexes</font></code> qui doivent être supprimés.  Nous utiliserons le <code><font color="#0000FF">filter (_:)</font></code> pour résoudre notre problème: <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> images = [<span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">22</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-number"><span class="hljs-number">16</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> removedIndexes = [<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">5</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">6</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> images1 = images .enumerated() .<span class="hljs-built_in"><span class="hljs-built_in">filter</span></span> { !removedIndexes.<span class="hljs-built_in"><span class="hljs-built_in">contains</span></span>($<span class="hljs-number"><span class="hljs-number">0</span></span>.offset) } .<span class="hljs-built_in"><span class="hljs-built_in">map</span></span> { $<span class="hljs-number"><span class="hljs-number">0</span></span>.element } <span class="hljs-built_in"><span class="hljs-built_in">print</span></span> (images1) <span class="hljs-comment"><span class="hljs-comment">// [22, 14, 16, 9]</span></span></code> </pre><br>  La méthode <code><font color="#0000FF">enumerated()</font></code> renvoie une séquence de tuples composée d'index de <code><font color="#0000FF">offset</font></code> et de valeurs d' <code><font color="#0000FF">element</font></code> d'un tableau.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ensuite, nous appliquons un filtre </font></font><code><font color="#0000FF">filter</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">à la séquence résultante de tuples, ne laissant que ceux dont l'index n'est </font></font><code><font color="#0000FF">$0.offset</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pas contenu dans le tableau </font></font><code><font color="#0000FF">removedIndexes</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. L'étape suivante, nous sélectionnons la valeur dans le tuple </font></font><code><font color="#0000FF">$0.element</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et obtenons le tableau dont nous avons besoin </font></font><code><font color="#0000FF">images1</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br><br><h2> <code><font color="#0000FF">reduce (_:, _:)</font></code> </h2> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La méthode est </font></font><code><font color="#0000FF">reduce (_:, _:)</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">également disponible pour la plupart des </font></font><code></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">personnes </font></font><code><font color="#0000FF">map(_:)</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et des </font><font style="vertical-align: inherit;">méthodes disponibles </font></font><code><font color="#0000FF">filter (_:)</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">La méthode </font></font><code><font color="#0000FF">reduce (_:, _:)</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">«réduit» la séquence </font></font><code><font color="#0000FF">Sequence</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">à une seule valeur cumulée et a deux paramètres. </font><font style="vertical-align: inherit;">Le premier paramètre est la valeur d'accumulation de départ et le deuxième paramètre est une fonction qui combine la valeur d'accumulation avec l'élément de séquence </font></font><code><font color="#0000FF">Sequence</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pour obtenir une nouvelle valeur d'accumulation. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La fonction de paramètre d'entrée est appliquée à chaque élément de la séquence </font></font><code><font color="#0000FF">Sequence</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, l'un après l'autre, jusqu'à ce qu'il atteigne la fin et crée la valeur cumulée finale.</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> sum = <span class="hljs-type"><span class="hljs-type">Array</span></span> (<span class="hljs-number"><span class="hljs-number">1</span></span>...<span class="hljs-number"><span class="hljs-number">100</span></span>).<span class="hljs-built_in"><span class="hljs-built_in">reduce</span></span>(<span class="hljs-number"><span class="hljs-number">0</span></span>, +)</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ceci est un exemple trivial classique d'utilisation d'une fonction d'ordre supérieur </font></font><code><font color="#0000FF">reduce (_:, _:)</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- compter la somme des éléments d'un tableau </font></font><code><font color="#0000FF">Array</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br><br><pre> <code class="swift hljs">    <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> +<span class="hljs-number"><span class="hljs-number">1</span></span> = <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> + <span class="hljs-number"><span class="hljs-number">1</span></span> = <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> + <span class="hljs-number"><span class="hljs-number">3</span></span> = <span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> + <span class="hljs-number"><span class="hljs-number">6</span></span> = <span class="hljs-number"><span class="hljs-number">10</span></span> . . . . . . . . . . . . . . . . . . . <span class="hljs-number"><span class="hljs-number">100</span></span> <span class="hljs-number"><span class="hljs-number">4950</span></span> <span class="hljs-number"><span class="hljs-number">100</span></span> <span class="hljs-number"><span class="hljs-number">4950</span></span> + <span class="hljs-number"><span class="hljs-number">100</span></span> = <span class="hljs-number"><span class="hljs-number">5050</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En utilisant la fonction, </font></font><code><font color="#0000FF">reduce (_:, _:)</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nous pouvons très simplement calculer la somme des nombres de Fibonacci qui satisfont une certaine condition:</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> fibonacci = sequence(first: (<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>), next: { ($<span class="hljs-number"><span class="hljs-number">1</span></span>, $<span class="hljs-number"><span class="hljs-number">0</span></span> + $<span class="hljs-number"><span class="hljs-number">1</span></span>) }) .<span class="hljs-keyword"><span class="hljs-keyword">prefix</span></span>(<span class="hljs-number"><span class="hljs-number">20</span></span>).<span class="hljs-built_in"><span class="hljs-built_in">map</span></span>{$<span class="hljs-number"><span class="hljs-number">0.0</span></span>} .<span class="hljs-built_in"><span class="hljs-built_in">filter</span></span> {$<span class="hljs-number"><span class="hljs-number">0</span></span> % <span class="hljs-number"><span class="hljs-number">2</span></span> == <span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; $<span class="hljs-number"><span class="hljs-number">0</span></span> &lt; <span class="hljs-number"><span class="hljs-number">4000</span></span>} <span class="hljs-built_in"><span class="hljs-built_in">print</span></span> (fibonacci) <span class="hljs-comment"><span class="hljs-comment">// [0, 2, 8, 34, 144, 610, 2584] print(fibonacci.reduce(0,+)) // 3382</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mais il existe des applications plus intéressantes d'une fonction d'ordre supérieur </font></font><code><font color="#0000FF">reduce (_:, _:)</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Par exemple, nous pouvons déterminer très simplement et de manière concise un paramètre très important pour </font></font><code><font color="#0000FF">UIScrollView</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- la taille de la zone "scrollable" </font></font><code><font color="#0000FF">contentSize</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- en fonction de sa taille </font></font><code><font color="#0000FF">subviews</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> scrollView = <span class="hljs-type"><span class="hljs-type">UIScrollView</span></span>() scrollView.addSubview(<span class="hljs-type"><span class="hljs-type">UIView</span></span>(frame: <span class="hljs-type"><span class="hljs-type">CGRect</span></span>(x: <span class="hljs-number"><span class="hljs-number">300.0</span></span>, y: <span class="hljs-number"><span class="hljs-number">0.0</span></span>, width: <span class="hljs-number"><span class="hljs-number">200</span></span>, height: <span class="hljs-number"><span class="hljs-number">300</span></span>))) scrollView.addSubview(<span class="hljs-type"><span class="hljs-type">UIView</span></span>(frame: <span class="hljs-type"><span class="hljs-type">CGRect</span></span>(x: <span class="hljs-number"><span class="hljs-number">100.0</span></span>, y: <span class="hljs-number"><span class="hljs-number">0.0</span></span>, width: <span class="hljs-number"><span class="hljs-number">300</span></span>, height: <span class="hljs-number"><span class="hljs-number">600</span></span>))) scrollView.contentSize = scrollView.subviews .<span class="hljs-built_in"><span class="hljs-built_in">reduce</span></span>(<span class="hljs-type"><span class="hljs-type">CGRect</span></span>.zero,{$<span class="hljs-number"><span class="hljs-number">0</span></span>.union($<span class="hljs-number"><span class="hljs-number">1</span></span>.frame)}) .size <span class="hljs-comment"><span class="hljs-comment">// (500.0, 600.0)</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dans cette démo, la valeur accumulée est </font></font><code></code> <code><font color="#0000FF">GCRect</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, et l'opération d'accumulation est l'opération de combinaison des </font></font><code><font color="#0000FF">union</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rectangles qui sont les </font></font><code><font color="#0000FF">frame</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nôtres </font></font><code><font color="#0000FF">subviews</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Malgré le fait qu'une fonction d'ordre supérieur </font></font><code><font color="#0000FF">reduce (_:, _:)</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">assume un caractère cumulatif, elle peut être utilisée dans une perspective complètement différente. </font><font style="vertical-align: inherit;">Par exemple, pour diviser un tuple en parties dans un tableau de tuples:</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-comment"><span class="hljs-comment">// Separate Tuples let arr = [("one", 1), ("two", 2), ("three", 3), ("four", 4)] let (arr1, arr2) = arr.reduce(([], [])) { ($0.0 + [$1.0], $0.1 + [$1.1]) } print(arr1) // ["one", "two", "three", "four"] print(arr2) // [1, 2, 3, 4]</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Swift a </font></font><code>4.2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">introduit un nouveau type de fonction d'ordre supérieur </font></font><code><font color="#0000FF">reduce (into:, _:)</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">La méthode </font></font><code><font color="#0000FF">reduce (into:, _:)</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">est préférable en termes d'efficacité par rapport à la méthode </font></font><code><font color="#0000FF">reduce (:, :)</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">si </font></font><code>COW (copy-on-write)</code> <code></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, par exemple, </font></font><code><font color="#0000FF">Array</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ou est </font><font style="vertical-align: inherit;">utilisée comme structure résultante </font></font><code><font color="#0000FF">Dictionary</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il peut être utilisé efficacement pour supprimer les valeurs correspondantes dans un tableau d'entiers:</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-comment"><span class="hljs-comment">// Remove duplicates let arrayInt = [1,1,2,6,6,7,2,9,7].reduce(into: []) { !$0.contains($1) ? $0.append($1) : () } // [1, 2, 6, 7, 9]</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ... ou lors du comptage du nombre d'éléments différents dans un tableau: </font></font><br><br><pre> <code class="swift hljs"><span class="hljs-comment"><span class="hljs-comment">// Count equal elements in array let arrayIntCount = [1,1,2,2,6,6,7,2,9,7].reduce(into: [:]) { counts, letter in counts[letter, default: 0] += 1 } // [6: 2, 9: 1, 1: 2, 2: 3, 7: 2]</span></span></code> </pre><br><h2> <code><font color="#0000FF">flatMap (_:)</font></code> </h2> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Avant de passer à cette fonction d'ordre supérieur, regardons une démonstration très simple. </font></font><br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> maybeNumbers = [<span class="hljs-string"><span class="hljs-string">"42"</span></span>, <span class="hljs-string"><span class="hljs-string">"7"</span></span>, <span class="hljs-string"><span class="hljs-string">"three"</span></span>, <span class="hljs-string"><span class="hljs-string">"///4///"</span></span>, <span class="hljs-string"><span class="hljs-string">"5"</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> firstNumber = maybeNumbers.<span class="hljs-built_in"><span class="hljs-built_in">map</span></span> (<span class="hljs-type"><span class="hljs-type">Int</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>).first</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si nous exécutons ce code pour l'exécuter </font></font><code>Playground</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, alors tout semble bon, et le nôtre </font></font><code><font color="#0000FF">firstNumber</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">est égal </font></font><code><font color="#0000FF">42</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br><br><img src="https://habrastorage.org/webt/ld/wu/t6/ldwut6x-1iu4yxapphmpzcyamj4.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mais, si vous ne le savez pas, il </font></font><code>Playground</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cache souvent le vrai </font></font><code></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, en particulier les </font></font><code></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">constantes </font></font><code><font color="#0000FF">firstNumber</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. En fait, la constante </font></font><code><font color="#0000FF">firstNumber</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font><code></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">deux </font><font style="vertical-align: inherit;">choses </font></font><code><font color="#0000FF">Optional</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: en </font></font><br><br><img src="https://habrastorage.org/webt/v9/0k/xy/v90kxymnnsd_cxv-y4pznc0yj5s.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">effet, </font></font><code><font color="#0000FF">map (Int.init)</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">à la sortie, elle forme un tableau </font></font><code><font color="#0000FF">Optional</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">de valeurs TYPE </font></font><code><font color="#0000FF">[Int?]</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, car toutes les lignes </font></font><code><font color="#0000FF">String</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ne peuvent pas être converties </font></font><code><font color="#0000FF">Int</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et l'initialiseur </font></font><code><font color="#0000FF">Int.int</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">«tombe» ( </font></font><code>failable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">). Ensuite, nous prenons le premier élément du tableau formé en utilisant la fonction </font></font><code><font color="#0000FF">first</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">du tableau </font></font><code><font color="#0000FF">Array</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, qui forme également la sortie</font></font><code><font color="#0000FF">Optional</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, car le tableau peut être vide et nous ne pourrons pas obtenir le premier élément du tableau. </font><font style="vertical-align: inherit;">En conséquence, nous avons un double </font></font><code><font color="#0000FF">Optional</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, c'est-à-dire</font></font><code><font color="#0000FF">Int??</font></code>  . <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous avons une structure imbriquée </font></font><code><font color="#0000FF">Optional</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dans </font></font><code><font color="#0000FF">Optional</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">laquelle il est vraiment plus difficile de travailler et que nous ne voulons naturellement pas avoir. </font><font style="vertical-align: inherit;">Afin de tirer le meilleur parti de cette structure imbriquée, nous devons «plonger» dans deux niveaux. </font><font style="vertical-align: inherit;">De plus, toute transformation supplémentaire peut approfondir le niveau </font></font><code><font color="#0000FF">Optional</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">encore plus bas. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Obtenir la valeur du double imbriqué est </font></font><code><font color="#0000FF">Optional</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vraiment pénible. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous avons 3 options et toutes nécessitent une connaissance approfondie de la langue </font></font><code>Swift</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br><br><ul><li>      <code><font color="#0000FF">if let</font></code> ,       ;    «» «» <code><font color="#0000FF">Optional</font></code> ,    —  «» <code><font color="#0000FF">Optional</font></code> : <br><br><img src="https://habrastorage.org/webt/dp/wa/qh/dpwaqh4oebq7cjcwy35777cnno0.png"></li><li>       <code><font color="#0000FF">if case let</font></code>      ( <code>pattern match</code> )  : <br><br><img src="https://habrastorage.org/webt/v8/a6/tg/v8a6tg2npzwpktlvjpvqxf1pa0q.png"><br><br>       <code><font color="#0000FF">??</font></code>     : <br><br><img src="https://habrastorage.org/webt/a6/ny/ia/a6nyiaeq5bds4kiewmcugwomppq.png"></li><li> ,      <code><font color="#0000FF">switch</font></code>     : <br><br><img src="https://habrastorage.org/webt/oq/dx/1s/oqdx1siedfr6cxs2lug7zasq4qg.png"></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pire encore, de tels problèmes d'imbrication </font></font><code></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">surviennent dans toutes les situations impliquant des </font></font><code>generic</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">conteneurs </font><font style="vertical-align: inherit;">generalized ( </font><font style="vertical-align: inherit;">) pour lesquels une opération est définie </font></font><code><font color="#0000FF">map</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Par exemple, pour les tableaux </font></font><code><font color="#0000FF">Array</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Prenons un autre exemple de code. </font><font style="vertical-align: inherit;">Supposons que nous ayons un texte sur plusieurs lignes </font></font><code><font color="#0000FF">multilineString</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">que nous voulons diviser en mots écrits en minuscules:</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> multilineString = <span class="hljs-string"><span class="hljs-string">"""  ,  ,   ;     , —  ,   :  —   ,   .   ,   ,   .    .  ,        ,  « »  .  ,  ,   ! """</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> words = multilineString.lowercased() .<span class="hljs-built_in"><span class="hljs-built_in">split</span></span>(separator: <span class="hljs-string"><span class="hljs-string">"\n"</span></span>) .<span class="hljs-built_in"><span class="hljs-built_in">map</span></span>{$<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-built_in"><span class="hljs-built_in">split</span></span>(separator: <span class="hljs-string"><span class="hljs-string">" "</span></span>)}</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Afin d'obtenir un tableau de mots </font></font><code><font color="#0000FF">words</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, nous faisons d'abord des lettres majuscules (grandes) en minuscules (petites) en utilisant la méthode </font></font><code><font color="#0000FF">lowercased()</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, puis nous divisons le texte en </font></font><code><font color="#0000FF">split(separatot: "\n")</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lignes en </font><font style="vertical-align: inherit;">utilisant la méthode </font><font style="vertical-align: inherit;">et obtenons un tableau de chaînes, puis nous l'utilisons </font></font><code><font color="#0000FF">map {$0.split(separator: " ")}</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pour séparer chaque ligne en mots distincts. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En conséquence, nous obtenons des tableaux imbriqués:</font></font><br><br><pre> <code class="swift hljs">[[<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">","</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">","</span></span>], [<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">";"</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">","</span></span>, <span class="hljs-string"><span class="hljs-string">"—"</span></span>], [<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">","</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">":"</span></span>], [<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"—"</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">","</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"."</span></span>], [<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">","</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">","</span></span>], [<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"."</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>], [<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"."</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">","</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>], [<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>], [<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">","</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"«"</span></span>, <span class="hljs-string"><span class="hljs-string">"»"</span></span>], [<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"."</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">","</span></span>], [<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">","</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"!"</span></span>]]</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">... et cela </font></font><code><font color="#0000FF">words</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font><code></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">deux choses </font></font><code><font color="#0000FF">Array</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br><br><img src="https://habrastorage.org/webt/b0/kc/y3/b0kcy3vh-dkhtw6ytrmk7fe_cbk.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nous avons à nouveau obtenu une structure de données "imbriquée", mais cette fois, nous ne l'avons pas fait </font></font><code><font color="#0000FF">Optional</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, mais </font></font><code><font color="#0000FF">Array</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Si nous voulons continuer à traiter les mots reçus </font></font><code><font color="#0000FF">words</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, par exemple, pour trouver le spectre des lettres de ce texte à plusieurs lignes, nous devrons d'abord «redresser» le tableau du double </font></font><code><font color="#0000FF">Array</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et le transformer en un seul tableau </font></font><code><font color="#0000FF">Array</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Ceci est similaire à ce que nous avons fait avec double </font></font><code><font color="#0000FF">Optional</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pour une démo au début de cette section sur </font></font><code><font color="#0000FF">flatMap</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> maybeNumbers = [<span class="hljs-string"><span class="hljs-string">"42"</span></span>, <span class="hljs-string"><span class="hljs-string">"7"</span></span>, <span class="hljs-string"><span class="hljs-string">"three"</span></span>, <span class="hljs-string"><span class="hljs-string">"///4///"</span></span>, <span class="hljs-string"><span class="hljs-string">"5"</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> firstNumber = maybeNumbers.<span class="hljs-built_in"><span class="hljs-built_in">map</span></span> (<span class="hljs-type"><span class="hljs-type">Int</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>).first</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Heureusement, </font></font><code>Swift</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nous n'avons pas à recourir à des constructions syntaxiques complexes. </font></font><code>Swift</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nous fournit une solution toute faite pour les baies </font></font><code><font color="#0000FF">Array</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et </font></font><code><font color="#0000FF">Optional</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Il s'agit d'une fonction d'ordre supérieur </font></font><code><font color="#0000FF">flatMap</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">! Il est très similaire à </font></font><code><font color="#0000FF">map</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, mais il possède des fonctionnalités supplémentaires associées au "redressement" ultérieur des "pièces jointes" qui apparaissent lors de l'exécution </font></font><code><font color="#0000FF">map</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Et c'est pourquoi on l'appelle </font></font><code><font color="#0000FF">flatMap</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, ça «redresse» ( </font></font><code>flattens</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) le résultat </font></font><code><font color="#0000FF">map</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Essayons d'appliquer </font></font><code><font color="#0000FF">flatMap</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">à </font></font><code><font color="#0000FF">firstNumber</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br><br><img src="https://habrastorage.org/webt/l7/1g/ag/l71gagrp7qtfvn-9nae3ofbmlb0.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous avons vraiment obtenu la sortie avec un seul niveau </font></font><code><font color="#0000FF">Optional</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Fonctionne </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">encore plus intéressant </font></font><code><font color="#0000FF">flatMap</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pour un tableau </font></font><code><font color="#0000FF">Array</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Dans notre expression pour, </font></font><code><font color="#0000FF">words</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nous remplaçons simplement </font></font><code><font color="#0000FF">map</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">par</font></font><code><font color="#0000FF">flatMap</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br><br><img src="https://habrastorage.org/webt/zh/t9/bm/zht9bmajklq5ybm4xxpigddrrma.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">... et nous obtenons juste un tableau de mots </font></font><code><font color="#0000FF">words</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sans "imbrication":</font></font><br><br><pre> <code class="swift hljs">[<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">","</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">","</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">";"</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">","</span></span>, <span class="hljs-string"><span class="hljs-string">"—"</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">","</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">":"</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"—"</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">","</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"."</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">","</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">","</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"."</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"."</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">","</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">","</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"«"</span></span>, <span class="hljs-string"><span class="hljs-string">"»"</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"."</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">","</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">","</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"!"</span></span>]</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous pouvons maintenant continuer le traitement dont nous avons besoin du tableau de mots résultant </font></font><code><font color="#0000FF">words</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, mais soyez prudent. </font><font style="vertical-align: inherit;">Si nous l'appliquons à nouveau </font></font><code><font color="#0000FF">flatMap</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">à chaque élément du tableau </font></font><code><font color="#0000FF">words</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, nous obtiendrons, peut-être, un résultat inattendu, mais tout à fait compréhensible. </font></font><br><br><img src="https://habrastorage.org/webt/vw/iq/jd/vwiqjd_y3ambrq0w8e-r9dnjpl4.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous obtenons un tableau unique et non «imbriqué» de lettres et de symboles </font></font><code><font color="#0000FF">[Character]</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">contenu dans notre phrase à plusieurs lignes:</font></font><br><br><pre> <code class="swift hljs">[<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">","</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">","</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">";"</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, ...]</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le fait est que la chaîne </font></font><code><font color="#0000FF">String</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">est une collection de </font></font><code><font color="#0000FF">Collection</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">caractères </font></font><code><font color="#0000FF">[Character]</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et, en appliquant </font></font><code><font color="#0000FF">flatMap</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">à chaque mot individuel, nous abaissons une fois de plus le niveau de "nidification" et arrivons à un tableau de caractères </font></font><code><font color="#0000FF">flattenCharacters</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Peut-être que c'est exactement ce que vous voulez, ou peut-être pas. </font><font style="vertical-align: inherit;">Faites attention à cela.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Mettre tout cela ensemble: résoudre certains problèmes </font></font></h2><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> TÂCHE 1 </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous pouvons continuer le traitement du tableau de mots obtenu dans la section précédente dont nous avons besoin </font></font><code><font color="#0000FF">words</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et calculer la fréquence d'apparition des lettres dans notre phrase multiligne. </font><font style="vertical-align: inherit;">Pour commencer, «collons» tous les mots du tableau </font></font><code><font color="#0000FF">words</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sur une seule grande ligne et en excluons tous les signes de ponctuation, c'est-à-dire ne laissons que les lettres:</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> wordsString = words.<span class="hljs-built_in"><span class="hljs-built_in">reduce</span></span> (<span class="hljs-string"><span class="hljs-string">""</span></span>,+).<span class="hljs-built_in"><span class="hljs-built_in">filter</span></span> { <span class="hljs-string"><span class="hljs-string">""</span></span> .<span class="hljs-built_in"><span class="hljs-built_in">contains</span></span>($<span class="hljs-number"><span class="hljs-number">0</span></span>)} <span class="hljs-comment"><span class="hljs-comment">// </span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous avons donc obtenu toutes les lettres dont nous avons besoin. </font><font style="vertical-align: inherit;">Maintenant, faisons-en un dictionnaire, où la clé </font></font><code><font color="#0000FF">key</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">est la lettre et la valeur </font></font><code><font color="#0000FF">value</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">est la fréquence de son occurrence dans le texte. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous pouvons le faire de deux manières. </font></font><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La première méthode</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est associée à l'utilisation d'une nouvelle </font></font><code>Swift 4.2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">variété d'une fonction d'ordre supérieur </font><font style="vertical-align: inherit;">qui est apparue dans </font></font><code><font color="#0000FF">reduce (into:, _:)</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Cette méthode nous convient tout à fait pour organiser un dictionnaire </font></font><code><font color="#0000FF">letterCount</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">avec la fréquence d'apparition des lettres dans notre phrase multiligne:</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> letterCount = wordsString.<span class="hljs-built_in"><span class="hljs-built_in">reduce</span></span>(into: [:]) { counts, letter <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> counts[letter, <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>] += <span class="hljs-number"><span class="hljs-number">1</span></span>} <span class="hljs-built_in"><span class="hljs-built_in">print</span></span> (letterCount) <span class="hljs-comment"><span class="hljs-comment">// ["": 1, "": 18, "": 2, "": 2, "": 5, "": 7, "": 17, "": 4, "": 23, ...]</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En conséquence, nous obtiendrons un dictionnaire </font></font><code><font color="#0000FF">letterCount</font></code> <code></code> <code><font color="#0000FF">[Character : Int]</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dans lequel les clés </font></font><code><font color="#0000FF">key</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sont les caractères trouvés dans la phrase à l'étude, et comme la valeur </font></font><code><font color="#0000FF">value</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">est le nombre de ces caractères. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La deuxième méthode</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> consiste à initialiser le dictionnaire à l'aide du regroupement, ce qui donne le même résultat:</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> letterCountDictionary = <span class="hljs-type"><span class="hljs-type">Dictionary</span></span>(grouping: wordsString ){ $<span class="hljs-number"><span class="hljs-number">0</span></span>}.mapValues {$<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-built_in"><span class="hljs-built_in">count</span></span>} letterCount == letterCountDictionary <span class="hljs-comment"><span class="hljs-comment">// true</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous souhaitons trier le dictionnaire </font></font><code><font color="#0000FF">letterCount</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">par ordre alphabétique:</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> lettersStat = letterCountDictionary .sorted(by: &lt;) .<span class="hljs-built_in"><span class="hljs-built_in">map</span></span>{<span class="hljs-string"><span class="hljs-string">"\($0.0):\($0.1)"</span></span>} <span class="hljs-built_in"><span class="hljs-built_in">print</span></span> (lettersStat) <span class="hljs-comment"><span class="hljs-comment">// [":17", ":5", ":18", ":4", ":8", ":35", ":3", ":4", ":18", ":5", ":2", ":10", ":4", ":26", ":34", ":5", ":7", ":23", ":25", ":4", ":2", ":3", ":4", ":2", ":1", ":14", ":2", ":4"]</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mais nous ne pouvons pas trier directement le dictionnaire </font></font><code><font color="#0000FF">Dictionary</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, car ce n'est fondamentalement pas une structure de données ordonnée. Si nous appliquons la fonction </font></font><code><font color="#0000FF">sorted (by:)</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">au dictionnaire </font></font><code><font color="#0000FF">Dictionary</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, elle nous renverra les éléments de la séquence triés avec le prédicat donné sous la forme d'un tableau de tuples nommés, que </font></font><code><font color="#0000FF">map</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nous transformerons en un tableau de chaînes </font></font><code><font color="#0000FF">[":17", ":5", ":18", ...]</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">reflétant la fréquence d'occurrence de la lettre correspondante. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous voyons que cette fois, </font></font><code><font color="#0000FF">sorted (by:)</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">juste l'opérateur " </font></font><code><font color="#0000FF">&lt;</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">" </font><font style="vertical-align: inherit;">est passé </font><font style="vertical-align: inherit;">comme prédicat à une fonction d' </font><font style="vertical-align: inherit;">ordre </font><font style="vertical-align: inherit;">supérieur </font><font style="vertical-align: inherit;">. La fonction </font></font><code><font color="#0000FF">sorted (by:)</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">attend une «fonction de comparaison» comme seul argument à l'entrée. Il est utilisé pour comparer deux valeurs adjacentes et décider si elles sont correctement ordonnées (dans ce cas, renvoie</font></font><code><font color="#0000FF">true</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) ou non (retourne </font></font><code><font color="#0000FF">false</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">). </font><font style="vertical-align: inherit;">On peut donner à cette "fonction de comparaison" des fonctions </font></font><code><font color="#0000FF">sorted (by:)</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sous forme de fermeture anonyme:</font></font><br><br><pre> <code class="swift hljs">sorted(by: {$<span class="hljs-number"><span class="hljs-number">0</span></span>.key &lt; $<span class="hljs-number"><span class="hljs-number">1</span></span>.key}</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Et nous pouvons simplement lui donner l'opérateur " </font></font><code><font color="#0000FF">&lt;</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">", qui a la signature dont nous avons besoin, comme cela a été fait ci-dessus. </font><font style="vertical-align: inherit;">Il s'agit également d'une fonction et le tri par clé est en cours </font></font><code><font color="#0000FF">key</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si nous voulons trier le dictionnaire par valeurs </font></font><code><font color="#0000FF">value</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et savoir quelles lettres se trouvent le plus souvent dans cette phrase, nous devrons utiliser la fermeture de la fonction </font></font><code><font color="#0000FF">sorted (by:)</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> countsStat = letterCountDictionary .sorted(by: {$<span class="hljs-number"><span class="hljs-number">0</span></span>.value &gt; $<span class="hljs-number"><span class="hljs-number">1</span></span>.value}) .<span class="hljs-built_in"><span class="hljs-built_in">map</span></span>{<span class="hljs-string"><span class="hljs-string">"\($0.0):\($0.1)"</span></span>} <span class="hljs-built_in"><span class="hljs-built_in">print</span></span> (countsStat ) <span class="hljs-comment"><span class="hljs-comment">//[":35", ":34", ":26", ":25", ":23", ":18", ":18", ":17", ":14", ":10", ":8", ":7", ":5", ":5", ":5", ":4", ":4", ":4", ":4", ":4", ":4", ":3", ":3", ":2", ":2", ":2", ":2", ":1"]</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Si nous examinons la solution au problème de la détermination du spectre des lettres d'une phrase multiligne dans son ensemble ... </font></font><br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> multilineString = <span class="hljs-string"><span class="hljs-string">"""  ,  ,   ;     , —  ,   :  —   ,   .   ,   ,   .    .  ,        ,  « »  .  ,  ,   ! """</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> words = multilineString.lowercased() .<span class="hljs-built_in"><span class="hljs-built_in">split</span></span>(separator: <span class="hljs-string"><span class="hljs-string">"\n"</span></span>) .flatMap{$<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-built_in"><span class="hljs-built_in">split</span></span>(separator: <span class="hljs-string"><span class="hljs-string">" "</span></span>)} <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> wordsString = words.<span class="hljs-built_in"><span class="hljs-built_in">reduce</span></span> (<span class="hljs-string"><span class="hljs-string">""</span></span>,+).<span class="hljs-built_in"><span class="hljs-built_in">filter</span></span> { <span class="hljs-string"><span class="hljs-string">""</span></span> .<span class="hljs-built_in"><span class="hljs-built_in">contains</span></span>($<span class="hljs-number"><span class="hljs-number">0</span></span>)} <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> letterCount = wordsString.<span class="hljs-built_in"><span class="hljs-built_in">reduce</span></span>(into: [:]) { counts, letter <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> counts[letter, <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>] += <span class="hljs-number"><span class="hljs-number">1</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> lettersStat = letterCountDictionary .sorted(by: &lt;) .<span class="hljs-built_in"><span class="hljs-built_in">map</span></span>{<span class="hljs-string"><span class="hljs-string">"\($0.0):\($0.1)"</span></span>} <span class="hljs-built_in"><span class="hljs-built_in">print</span></span> (lettersStat) <span class="hljs-comment"><span class="hljs-comment">// [":17", ":5", ":18", ":4", ":8", ":35", ":3", ":4", ":18", ":5", ":2", ":10", ":4", ":26", ":34", ":5", ":7", ":23", ":25", ":4", ":2", ":3", ":4", ":2", ":1", ":14", ":2", ":4"] let countsStat = letterCountDictionary .sorted(by: {$0.value &gt; $1.value}) .map{"\($0.0):\($0.1)"} print (countsStat ) //[":35", ":34", ":26", ":25", ":23", ":18", ":18", ":17", ":14", ":10", ":8", ":7", ":5", ":5", ":5", ":4", ":4", ":4", ":4", ":4", ":4", ":3", ":3", ":2", ":2", ":2", ":2", ":1"]</span></span></code> </pre><br> …   ,         ( <code><font color="#0000FF">var</font></code> ,  <code><font color="#0000FF">let)</font></code>        ()   ,     ,    : <br><br> <code><font color="#0000FF">split</font></code> - , <br> <code><font color="#0000FF">map</font></code> —  <br> <code><font color="#0000FF">flatMap</font></code> -    (   ), <br> <code><font color="#0000FF">filter</font></code> - , <br> <code><font color="#0000FF">sorted</font></code> - , <br> <code><font color="#0000FF">reduce</font></code> -          <br><br>          ,   .     «» ,   <code><font color="#0000FF">map</font></code> ,         ,   <code><font color="#0000FF">flatMap</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, si nous voulons sélectionner uniquement certaines données, nous les utilisons </font></font><code><font color="#0000FF">filter</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, etc. Toutes ces fonctions de «l'ordre le plus élevé» sont conçues et testées </font></font><code>Apple</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">en tenant compte de l'optimisation des performances. Donc, ce morceau de code est très fiable et concis - nous n'avions pas besoin de plus de 5 phrases pour résoudre notre problème. Ceci est un exemple de programmation fonctionnelle. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le seul inconvénient de l'application de l'approche fonctionnelle dans cette démo est que, pour des raisons d'immuabilité, de testabilité et de lisibilité, nous poursuivons notre texte à plusieurs reprises à travers diverses fonctions d'ordre supérieur. Dans le cas d'un grand nombre d'articles de collection, les </font></font><code><font color="#0000FF">Collection</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">performances peuvent chuter. Par exemple, si nous utilisons d'abord </font></font><code><font color="#0000FF">filter(_:)</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et, puis - </font></font><code><font color="#0000FF">first</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dans</font></font><code>Swift 4</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> De nouvelles options de fonctionnalités ont été ajoutées pour améliorer les performances, et voici quelques conseils pour écrire du code plus rapidement. </font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1. Utilisez </font></font><code><font color="#0000FF">contains</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, PAS</font></font><code><font color="#0000FF">first( where: ) != nil</font></code> </h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La vérification de la présence d'un objet dans une collection </font></font><code><font color="#0000FF">Collection</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">peut être effectuée de plusieurs manières. </font><font style="vertical-align: inherit;">La meilleure performance est fournie par la fonction </font></font><code><font color="#0000FF">contains</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CODE CORRECT</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> numbers = [<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>] numbers.<span class="hljs-built_in"><span class="hljs-built_in">contains</span></span>(<span class="hljs-number"><span class="hljs-number">1</span></span>)</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> CODE INCORRECT </font></font><br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> numbers = [<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>] numbers.<span class="hljs-built_in"><span class="hljs-built_in">filter</span></span> { number <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> number == <span class="hljs-number"><span class="hljs-number">1</span></span> }.isEmpty == <span class="hljs-literal"><span class="hljs-literal">false</span></span> numbers.first(<span class="hljs-keyword"><span class="hljs-keyword">where</span></span>: { number <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> number == <span class="hljs-number"><span class="hljs-number">1</span></span> }) != <span class="hljs-literal"><span class="hljs-literal">nil</span></span></code> </pre><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2. Utilisez la validation </font></font><code><font color="#0000FF">isEmpty</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, PAS une comparaison </font></font><code><font color="#0000FF">count</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">avec zéro</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Étant donné que pour certaines collections, l'accès à la propriété </font></font><code><font color="#0000FF">count</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s'effectue en itérant sur tous les éléments de la collection. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CODE CORRECT</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> numbers = [] numbers.isEmpty</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> CODE INCORRECT </font></font><br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> numbers = [] numbers.<span class="hljs-built_in"><span class="hljs-built_in">count</span></span> == <span class="hljs-number"><span class="hljs-number">0</span></span></code> </pre><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3. Vérifiez la chaîne vide </font></font><code><font color="#0000FF">String</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">avec</font></font><code><font color="#0000FF">isEmpty</font></code> </h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">String </font></font><code><font color="#0000FF">String</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in </font></font><code>Swift</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">est une collection de caractères </font></font><code><font color="#0000FF">[Character]</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Cela signifie que pour les chaînes, il est </font></font><code><font color="#0000FF">String</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">également préférable d'utiliser </font></font><code><font color="#0000FF">isEmpty</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CODE CORRECT</font></font><br><br><pre> <code class="swift hljs">myString.isEmpty</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> CODE INCORRECT </font></font><br><br><pre> <code class="swift hljs">myString == <span class="hljs-string"><span class="hljs-string">""</span></span> myString.<span class="hljs-built_in"><span class="hljs-built_in">count</span></span> == <span class="hljs-number"><span class="hljs-number">0</span></span></code> </pre><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 4. Obtention du premier élément qui remplit certaines conditions </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'itération sur l'ensemble de la collection afin d'obtenir le premier objet qui remplit certaines conditions peut être effectuée à l'aide d'une méthode </font></font><code><font color="#0000FF">filter</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">suivie d'une méthode </font></font><code><font color="#0000FF">first</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, mais la </font><font style="vertical-align: inherit;">méthode </font><font style="vertical-align: inherit;">est la meilleure en termes de vitesse </font></font><code><font color="#0000FF">first (where:)</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Cette méthode cesse d'itérer sur la collection dès qu'elle remplit la condition nécessaire. </font><font style="vertical-align: inherit;">La méthode </font></font><code><font color="#0000FF">filter</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">continuera d'itérer sur l'ensemble de la collection, qu'elle rencontre ou non les éléments nécessaires. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Évidemment, il en va de même pour la méthode </font></font><code><font color="#0000FF">last (where:)</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CODE CORRECT</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> numbers = [<span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, -<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, -<span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> firstNegative = numbers.first(<span class="hljs-keyword"><span class="hljs-keyword">where</span></span>: { $<span class="hljs-number"><span class="hljs-number">0</span></span> &lt; <span class="hljs-number"><span class="hljs-number">0</span></span> })</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> CODE INCORRECT </font></font><br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> numbers = [<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> allEven = numbers.<span class="hljs-built_in"><span class="hljs-built_in">filter</span></span> { $<span class="hljs-number"><span class="hljs-number">0</span></span> % <span class="hljs-number"><span class="hljs-number">2</span></span> != <span class="hljs-number"><span class="hljs-number">0</span></span> }.isEmpty</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Parfois, lorsque la collection </font></font><code><font color="#0000FF">Collection</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">est très importante et que les performances sont essentielles pour vous, il vaut la peine de revenir à comparer les approches impératives et fonctionnelles et à choisir celle qui vous convient.</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> TÂCHE 2 </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il y a un autre excellent exemple d'une utilisation très concise d'une fonction d'ordre supérieur </font></font><code><font color="#0000FF">reduce (_:, _:)</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">que j'ai rencontré. Ceci est un jeu </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SET</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Voici ses règles de base. Le nom du jeu </font></font><code>SET</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vient du mot anglais "set" - "set". Le jeu </font></font><code>SET</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">comprend 81 cartes, chacune avec une image unique: </font></font><br><br><img src="https://habrastorage.org/webt/ho/tg/rr/hotgrrs2vjmbgdyuxo0l4if6fai.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chaque carte a 4 attributs, énumérés ci-dessous: </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quantité</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : chaque carte a un, deux ou trois caractères. </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Type de personnages</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : ovales, losanges ou vagues. </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Couleur</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : les symboles peuvent être rouges, verts ou violets. </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Remplissage</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : les caractères peuvent être vides, ombrés ou ombrés. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">But du jeu</font></font><code>SET</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: Parmi les 12 cartes présentées sur la table, vous devez trouver </font></font><code>SET</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(un ensemble) composé de 3 cartes, dans lesquelles chacun des signes coïncide complètement ou diffère complètement sur les 3 cartes. Tous les panneaux doivent respecter pleinement cette règle. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Par exemple, le nombre de caractères sur les 3 cartes doit être identique ou différent, la couleur sur les 3 cartes doit être identique ou différente, et ainsi de suite ... </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dans cet exemple, nous ne nous intéresserons qu'au modèle de carte </font></font><code>SET</code> <code><font color="#0000FF">struct SetCard</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et à l'algorithme pour déterminer </font></font><code>SET</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">par 3e cartes </font></font><code><font color="#0000FF">isSet( cards:[SetCard])</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SetCard</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Equatable</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> number: <span class="hljs-type"><span class="hljs-type">Variant</span></span> <span class="hljs-comment"><span class="hljs-comment">// number - 1, 2, 3 let color: Variant // color - 1, 2, 3 (, , , ) let shape: Variant // symbol - 1, 2, 3 (, , , ) let fill: Variant // fill - 1, 2, 3 (, , , ) enum Variant: Int, CaseIterable { case v1 = 1 case v2 case v3 } static func isSet(cards: [SetCard]) -&gt; Bool { guard cards.count == 3 else {return false} let sums = [ cards.reduce(0, { $0 + $1.number.rawValue }), cards.reduce(0, { $0 + $1.color.rawValue }), cards.reduce(0, { $0 + $1.shape.rawValue }), cards.reduce(0, { $0 + $1.fill.rawValue }) ] return sums.reduce(true, { $0 &amp;&amp; ($1 % 3 == 0) }) } }</span></span></code> </pre><br>     — <i></i> <code><font color="#0000FF">number</font></code> , <i> </i> <code><font color="#0000FF">shape</font></code> , <i></i> <code><font color="#0000FF">color</font></code>  <i></i> <code><font color="#0000FF">fill</font></code> —   <code><font color="#0000FF">Variant</font></code> ,  3  : <code><font color="#0000FF">var1</font></code> , <code><font color="#0000FF">var2</font></code>  <code><font color="#0000FF">var3</font></code> ,   3-   <code><font color="#0000FF">rawValue</font></code> — <code><font color="#0000FF">1,2,3</font></code> .     <code><font color="#0000FF">rawValue</font></code>  .    - , , <code><font color="#0000FF">color</font></code> ,    <code><font color="#0000FF">rawValue</font></code>  <code><font color="#0000FF">colors</font></code> 3- ,  ,   <code><font color="#0000FF">colors</font></code>   3-  ,     <code><font color="#0000FF">3</font></code> , <code><font color="#0000FF">6</font></code>  <code><font color="#0000FF">9</font></code> ,      ,     <code><font color="#0000FF">6</font></code> .           3-  <code><font color="#0000FF">rawValue</font></code>  <code><font color="#0000FF">colors</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">les 3 cartes. Nous savons que c'est une condition préalable à la composition de 3 cartes </font></font><code>SET</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Pour que 3 cartes deviennent vraiment </font></font><code>SET</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nécessaires, pour tous les signes </font></font><code><font color="#0000FF">SetCard</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Quantité </font></font><code><font color="#0000FF">number</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, Type de symbole </font></font><code><font color="#0000FF">shape</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, Couleur </font></font><code><font color="#0000FF">color</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et Remplissage </font></font><code><font color="#0000FF">fill</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- leur somme doit </font></font><code><font color="#0000FF">rawValue</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">être un multiple de la 3e. Par </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">conséquent, dans la </font></font><code><font color="#0000FF">static</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">méthode, </font></font><code><font color="#0000FF">isSet( cards:[SetCard])</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nous avons d' </font><font style="vertical-align: inherit;">abord calculer le tableau </font></font><code><font color="#0000FF">sums</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">des sommes </font></font><code><font color="#0000FF">rawValue</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pour les 3 cartes pour toutes les </font><font style="vertical-align: inherit;">carte 4 performances en </font><font style="vertical-align: inherit;">utilisant la </font><font style="vertical-align: inherit;">fonction d'ordre supérieur </font></font><code><font color="#0000FF">reduce</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">avec une valeur initiale égale à </font></font><code><font color="#0000FF">0</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, et l' </font><font style="vertical-align: inherit;">accumulation de </font><font style="vertical-align: inherit;">fonctions </font></font><code><font color="#0000FF">{$0 + $1.number.rawValue}</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code><font color="#0000FF">{$0 + $1.color.rawValue}</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code><font color="#0000FF">{$0 + $1.shape.rawValue}</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code><font color="#0000FF">{ {$0 + $1.fill.rawValue}</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Chaque élément du tableau </font></font><code><font color="#0000FF">sums</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">doit être un multiple de 3e, et encore une fois, nous utilisons la fonction</font></font><code><font color="#0000FF">reduce</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, mais cette fois avec une valeur initiale égale </font></font><code><font color="#0000FF">true</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et cumulant la fonction logique " </font></font><code>AND</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">" </font></font><code><font color="#0000FF">{$0 &amp;&amp; ($1 % 3) == 0}</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Dans </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Swift 5,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pour tester la multiplicité d'un nombre pour un autre, une fonction est introduite à la </font></font><code><font color="#0000FF">isMultiply(of:)</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">place de l'opérateur </font></font><code><font color="#0000FF">%</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">restant. Il permettra également d' </font><font style="vertical-align: inherit;">améliorer la lisibilité du code: </font></font><code><font color="#0000FF">{ $0 &amp;&amp; ($1.isMultiply(of:3) }</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ce code incroyablement court pour savoir si les 3 </font></font><code><font color="#0000FF">SetCard</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cartes sont les </font></font><code>SET</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i est obtenu grâce à l' </font><font style="vertical-align: inherit;">approche </font><font style="vertical-align: inherit;">" </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fonctionnelle</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ", et nous pouvons nous assurer qu'il fonctionne sur </font></font><code>Playground</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br><br><img src="https://habrastorage.org/webt/9y/cg/6e/9ycg6e0hzi_kfdc4kvsnd0cnjsy.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comment </font></font><code>SET</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">construire l'interface utilisateur ( </font></font><code>UI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font><font style="vertical-align: inherit;">sur ce modèle de jeu </font></font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ici</font></font></a></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ici</font></font></a></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ici</font></font></a></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Fonctionnalités pures et effets secondaires </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Une fonction pure remplit deux conditions. </font><font style="vertical-align: inherit;">Il renvoie toujours le même résultat avec les mêmes paramètres d'entrée. </font><font style="vertical-align: inherit;">Et le calcul du résultat ne provoque pas d'effets secondaires associés à la sortie de données à l'extérieur (par exemple, sur disque) ou à l'emprunt de données source à l'extérieur (par exemple, le temps). </font><font style="vertical-align: inherit;">Cela vous permet d'optimiser considérablement le code. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ce sujet est </font></font><code>Swift</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">parfaitement exposé sur </font></font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">point.free</font></font></a></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dans les tout premiers épisodes de </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">" </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fonctions</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> "</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">" </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Effets secondaires</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> "</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , qui sont traduits en russe et présentés comme </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">" </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fonctions</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> "</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Effets secondaires"</font></font></a></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Composition des fonctions </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dans un sens mathématique, cela signifie appliquer une fonction au résultat d'une autre fonction. Dans une </font></font><code>Swift</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fonction, ils peuvent renvoyer une valeur que vous pouvez utiliser comme entrée pour une autre fonction. Il s'agit d'une pratique de programmation courante. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Imaginez que nous avons un tableau d'entiers et que nous voulons obtenir un tableau de carrés de nombres pairs uniques à la sortie. Habituellement, nous le réimplémentons comme suit:</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> integerArray = [<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">unique</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> array: [Int])</span></span></span></span> -&gt; [<span class="hljs-type"><span class="hljs-type">Int</span></span>] { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> array.<span class="hljs-built_in"><span class="hljs-built_in">reduce</span></span>(into: [], { (results, element) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> !results.<span class="hljs-built_in"><span class="hljs-built_in">contains</span></span>(element) { results.append(element) } }) } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">even</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> array: [Int])</span></span></span></span> -&gt; [<span class="hljs-type"><span class="hljs-type">Int</span></span>] { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> array.<span class="hljs-built_in"><span class="hljs-built_in">filter</span></span>{ $<span class="hljs-number"><span class="hljs-number">0</span></span>%<span class="hljs-number"><span class="hljs-number">2</span></span> == <span class="hljs-number"><span class="hljs-number">0</span></span>} } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">square</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> array: [Int])</span></span></span></span> -&gt; [<span class="hljs-type"><span class="hljs-type">Int</span></span>] { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> array.<span class="hljs-built_in"><span class="hljs-built_in">map</span></span>{ $<span class="hljs-number"><span class="hljs-number">0</span></span>*$<span class="hljs-number"><span class="hljs-number">0</span></span> } } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> array = square(even(unique(integerArray))) <span class="hljs-comment"><span class="hljs-comment">// it returns [4, 16, 36, 64]</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ce code nous donne le résultat correct, mais vous voyez que la lisibilité de la dernière ligne de code n'est pas si facile. La séquence de fonctions (de droite à gauche) est l'opposé de celle à laquelle nous sommes habitués (de gauche à droite) et que nous aimerions voir ici. Nous devons d'abord diriger notre logique vers la partie la plus interne de multiples plongements - vers le tableau </font></font><code><font color="#0000FF">inegerArray</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, puis vers la fonction externe à ce tableau </font></font><code><font color="#0000FF">unique</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, puis nous montons d'un autre niveau - la fonction </font></font><code><font color="#0000FF">even</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, et enfin, la fonction dans la conclusion </font></font><code><font color="#0000FF">square</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Et ici la «composition» des fonctions </font></font><code><font color="#0000FF">&gt;&gt;&gt;</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et des </font><font style="vertical-align: inherit;">opérateurs vient à notre aide </font></font><code><font color="#0000FF">|&gt;</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, ce qui nous permet d'écrire le code d'une manière très pratique, représentant le traitement du tableau d'origine </font></font><code><font color="#0000FF">integerArray</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">comme un «convoyeur» de fonctions:</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> array1 = integerArray |&gt; unique &gt;&gt;&gt; even &gt;&gt;&gt; square</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Presque toutes les </font><font style="vertical-align: inherit;">langues spécialisées telles que la </font><font style="vertical-align: inherit;">programmation fonctionnelle </font></font><code>F#</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>Elixir</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et </font></font><code>Elm</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">utiliser ces opérateurs pour les </font><font style="vertical-align: inherit;">fonctions « de composition ». </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il </font></font><code>Swift</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n'y a pas d'opérateurs intégrés de la «composition» des fonctions </font></font><code><font color="#0000FF">&gt;&gt;&gt;</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et </font></font><code><font color="#0000FF">|&gt;</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, mais nous pouvons très facilement les obtenir à l'aide de </font></font><code>Generics</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">closures ( </font></font><code>closure</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) et de l' </font></font><code><font color="#0000FF">infix</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">opérateur:</font></font><br><br><pre> <code class="swift hljs">precedencegroup <span class="hljs-type"><span class="hljs-type">ForwardComposition</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">associativity</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">left</span></span> higherThan: <span class="hljs-type"><span class="hljs-type">ForwardApplication</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">infix</span></span> <span class="hljs-keyword"><span class="hljs-keyword">operator</span></span> &gt;&gt;&gt; : <span class="hljs-type"><span class="hljs-type">ForwardComposition</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> &gt;&gt;&gt; &lt;A, B, C&gt;</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">left</span></span></span></span><span class="hljs-function"><span class="hljs-params">: @escaping </span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">(A)</span></span></span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">B</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">right</span></span>: @escaping (<span class="hljs-type"><span class="hljs-type">B</span></span>) -&gt; <span class="hljs-type"><span class="hljs-type">C</span></span>) -&gt; (<span class="hljs-type"><span class="hljs-type">A</span></span>) -&gt; <span class="hljs-type"><span class="hljs-type">C</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">right</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">left</span></span>($<span class="hljs-number"><span class="hljs-number">0</span></span>)) } } precedencegroup <span class="hljs-type"><span class="hljs-type">ForwardApplication</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">associativity</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">left</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">infix</span></span> <span class="hljs-keyword"><span class="hljs-keyword">operator</span></span> |&gt; : <span class="hljs-type"><span class="hljs-type">ForwardApplication</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> |&gt; &lt;A, B&gt;</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(a: A, f: </span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">(A)</span></span></span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">B</span></span>) -&gt; <span class="hljs-type"><span class="hljs-type">B</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> f(a) }</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Malgré les coûts supplémentaires, cela peut dans certains cas augmenter considérablement les performances, la lisibilité et la testabilité de votre code. </font><font style="vertical-align: inherit;">Par exemple, à l'intérieur, </font></font><code><font color="#0000FF">map</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vous placez toute une chaîne de fonctions en utilisant l'opérateur «composition» </font></font><code><font color="#0000FF">&gt;&gt;&gt;</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">au lieu de courir après un tableau à travers de nombreux </font></font><code><font color="#0000FF">map</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> integerArray1 = [<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> b = integerArray1.<span class="hljs-built_in"><span class="hljs-built_in">map</span></span>( { $<span class="hljs-number"><span class="hljs-number">0</span></span> + <span class="hljs-number"><span class="hljs-number">1</span></span> } &gt;&gt;&gt; { $<span class="hljs-number"><span class="hljs-number">0</span></span> * <span class="hljs-number"><span class="hljs-number">3</span></span> } &gt;&gt;&gt; <span class="hljs-type"><span class="hljs-type">String</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>) <span class="hljs-built_in"><span class="hljs-built_in">print</span></span> (b) <span class="hljs-comment"><span class="hljs-comment">// ["6", "9", "12", "15", "18", "21", "24", "27", "30", "6", "15", "18"]</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mais pas toujours une approche fonctionnelle donne un effet positif. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Au début, quand il est apparu </font></font><code>Swift</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">en 2014, tout le monde s'est précipité pour écrire des bibliothèques avec des opérateurs pour la «composition» des fonctions et pour résoudre une tâche difficile à l'époque comme l'analyse syntaxique à l' </font></font><code>JSON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aide d'opérateurs de programmation fonctionnelle au lieu d'utiliser des constructions infiniment imbriquées </font></font><code><font color="#0000FF">if let</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. J'ai moi-même traduit l' </font></font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">article sur l'analyse fonctionnelle JSON qui</font></font></a></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> m'a ravi de sa solution élégante </font><font style="vertical-align: inherit;">et était un fan de la bibliothèque </font></font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Argo</font></font></a></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mais les développeurs sont </font></font><code>Swift</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">allés d'une manière complètement différente et ont proposé, sur la base d'une technologie orientée protocole, une manière beaucoup plus concise d'écrire du code. Afin de «livrer» les </font></font><code>JSON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">données directement à</font></font><code></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Assez pour ce faire </font></font><code></code> <code><font color="#0000FF">Codable</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, qui met automatiquement en </font><font style="vertical-align: inherit;">œuvre ce protocole, si votre modèle est </font><font style="vertical-align: inherit;">constitué des connus </font></font><code>Swift</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">structures de données: </font></font><code><font color="#0000FF">String</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code><font color="#0000FF">Int</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code><font color="#0000FF">URL</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code><font color="#0000FF">Array</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code><font color="#0000FF">Dictionary</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, etc.</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Blog</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Codable</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> id: <span class="hljs-type"><span class="hljs-type">Int</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> name: <span class="hljs-type"><span class="hljs-type">String</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> url: <span class="hljs-type"><span class="hljs-type">URL</span></span> }</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Avoir des </font></font><code>JSON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">données de ce </font></font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">célèbre article</font></font></a></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ...</font></font><br><pre> <code class="swift hljs">[ { <span class="hljs-string"><span class="hljs-string">"id"</span></span> : <span class="hljs-number"><span class="hljs-number">73</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span> : <span class="hljs-string"><span class="hljs-string">"Bloxus test"</span></span>, <span class="hljs-string"><span class="hljs-string">"url"</span></span> : <span class="hljs-string"><span class="hljs-string">"http://remote.bloxus.com/"</span></span> }, { <span class="hljs-string"><span class="hljs-string">"id"</span></span> : <span class="hljs-number"><span class="hljs-number">74</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span> : <span class="hljs-string"><span class="hljs-string">"Manila Test"</span></span>, <span class="hljs-string"><span class="hljs-string">"url"</span></span> : <span class="hljs-string"><span class="hljs-string">"http://flickrtest1.userland.com/"</span></span> } ]</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">... pour le moment, vous n'avez besoin que d'une ligne de code pour obtenir un éventail de blogs </font></font><code><font color="#0000FF">blogs</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> blogs = <span class="hljs-type"><span class="hljs-type">Bundle</span></span>.main.path(forResource: <span class="hljs-string"><span class="hljs-string">"blogs"</span></span>, ofType: <span class="hljs-string"><span class="hljs-string">"json"</span></span>) .<span class="hljs-built_in"><span class="hljs-built_in">map</span></span>(<span class="hljs-type"><span class="hljs-type">URL</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>(fileURLWithPath:)) .flatMap { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>? <span class="hljs-type"><span class="hljs-type">Data</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>(contentsOf: $<span class="hljs-number"><span class="hljs-number">0</span></span>) } .flatMap { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>? <span class="hljs-type"><span class="hljs-type">JSONDecoder</span></span>().decode([<span class="hljs-type"><span class="hljs-type">Blog</span></span>].<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>, from: $<span class="hljs-number"><span class="hljs-number">0</span></span>) } <span class="hljs-built_in"><span class="hljs-built_in">print</span></span> (<span class="hljs-string"><span class="hljs-string">"\(blogs!)"</span></span>) <span class="hljs-comment"><span class="hljs-comment">// [id: 73 name: Bloxus test url: http://remote.bloxus.com/, // id: 74 name: Manila Test url: http://flickrtest1.userland.com/]</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tout le monde a oublié en toute sécurité d'utiliser les opérateurs de «composition» des fonctions pour l'analyse </font></font><code>JSON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, s'il existe un autre moyen plus compréhensible et plus simple de le faire en utilisant des protocoles. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si tout est si simple, alors nous pouvons «télécharger» des </font></font><code>JSON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">données vers des modèles plus complexes. </font><font style="vertical-align: inherit;">Supposons que nous ayons un fichier de </font></font><code>JSON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">données qui porte un nom </font></font><code>user.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et se trouve dans notre répertoire </font></font><code>Resources.</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Il contient des données sur un certain utilisateur:</font></font><br><br><pre> <code class="swift hljs">{ <span class="hljs-string"><span class="hljs-string">"email"</span></span>: <span class="hljs-string"><span class="hljs-string">"blob@pointfree.co"</span></span>, <span class="hljs-string"><span class="hljs-string">"id"</span></span>: <span class="hljs-number"><span class="hljs-number">42</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"Blob"</span></span> }</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Et nous avons un </font></font><code><font color="#0000FF">Codable</font></code> <code></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">utilisateur </font></font><code><font color="#0000FF">User</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">avec un initialiseur à partir des données </font></font><code><font color="#0000FF">json</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">User</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Codable</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> email: <span class="hljs-type"><span class="hljs-type">String</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> id: <span class="hljs-type"><span class="hljs-type">Int</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> name: <span class="hljs-type"><span class="hljs-type">String</span></span> <span class="hljs-keyword"><span class="hljs-keyword">init</span></span>?(json: <span class="hljs-type"><span class="hljs-type">Data</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> newValue = <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>? <span class="hljs-type"><span class="hljs-type">JSONDecoder</span></span>().decode(<span class="hljs-type"><span class="hljs-type">User</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>, from: json) { <span class="hljs-keyword"><span class="hljs-keyword">self</span></span> = newValue } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">nil</span></span> } } }</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous pouvons très facilement obtenir un nouvel utilisateur </font></font><code><font color="#0000FF">newUser</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">avec un code fonctionnel encore plus simple:</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> newUser = <span class="hljs-type"><span class="hljs-type">Bundle</span></span>.main.path(forResource: <span class="hljs-string"><span class="hljs-string">"user"</span></span>, ofType: <span class="hljs-string"><span class="hljs-string">"json"</span></span>) .<span class="hljs-built_in"><span class="hljs-built_in">map</span></span>(<span class="hljs-type"><span class="hljs-type">URL</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>(fileURLWithPath:)) .flatMap { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>? <span class="hljs-type"><span class="hljs-type">Data</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>(contentsOf: $<span class="hljs-number"><span class="hljs-number">0</span></span>) } .flatMap { <span class="hljs-type"><span class="hljs-type">User</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>(json: $<span class="hljs-number"><span class="hljs-number">0</span></span>) }</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">De toute évidence, le TYPE </font></font><code><font color="#0000FF">newUser</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sera </font></font><code><font color="#0000FF">Optional</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, c'est-à-dire</font></font><code><font color="#0000FF">User?</font></code>  : <br><br><img src="https://habrastorage.org/webt/ws/hp/ba/wshpbajpp-wrpb00sxusmhycttk.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Supposons que nous </font></font><code>Resources</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ayons un autre fichier avec un nom </font><font style="vertical-align: inherit;">dans l'annuaire </font></font><code>invoices.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et qui contienne des informations sur les factures de cet utilisateur.</font></font><br><br><pre> <code class="swift hljs">[ { <span class="hljs-string"><span class="hljs-string">"amountPaid"</span></span>: <span class="hljs-number"><span class="hljs-number">1000</span></span>, <span class="hljs-string"><span class="hljs-string">"amountDue"</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">"closed"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-string"><span class="hljs-string">"id"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span> }, { <span class="hljs-string"><span class="hljs-string">"amountPaid"</span></span>: <span class="hljs-number"><span class="hljs-number">500</span></span>, <span class="hljs-string"><span class="hljs-string">"amountDue"</span></span>: <span class="hljs-number"><span class="hljs-number">500</span></span>, <span class="hljs-string"><span class="hljs-string">"closed"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"id"</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span> } ]</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous pouvons charger ces données exactement comme nous l'avons fait avec </font></font><code><font color="#0000FF">User</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Définissons la structure comme un modèle de facture </font></font><code><font color="#0000FF">struct Invoice</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">...</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Invoice</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Codable</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> amountDue: <span class="hljs-type"><span class="hljs-type">Int</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> amountPaid: <span class="hljs-type"><span class="hljs-type">Int</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> closed: <span class="hljs-type"><span class="hljs-type">Bool</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> id: <span class="hljs-type"><span class="hljs-type">Int</span></span> }</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">... et décodez le </font></font><code>JSON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tableau de factures </font><font style="vertical-align: inherit;">présenté ci </font></font><code><font color="#0000FF">invoices</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font><font style="vertical-align: inherit;">dessus </font><font style="vertical-align: inherit;">, en ne modifiant que le chemin d'accès au fichier et la logique de décodage </font></font><code><font color="#0000FF">decode</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> invoices = <span class="hljs-type"><span class="hljs-type">Bundle</span></span>.main.path(forResource: <span class="hljs-string"><span class="hljs-string">"invoices"</span></span>, ofType: <span class="hljs-string"><span class="hljs-string">"json"</span></span>) .<span class="hljs-built_in"><span class="hljs-built_in">map</span></span>( <span class="hljs-type"><span class="hljs-type">URL</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>(fileURLWithPath:) ) .flatMap { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>? <span class="hljs-type"><span class="hljs-type">Data</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>(contentsOf: $<span class="hljs-number"><span class="hljs-number">0</span></span>) } .flatMap { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>? <span class="hljs-type"><span class="hljs-type">JSONDecoder</span></span>().decode([<span class="hljs-type"><span class="hljs-type">Invoice</span></span>].<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>, from: $<span class="hljs-number"><span class="hljs-number">0</span></span>) }</code> </pre><br> <code></code> <code><font color="#0000FF">invoices</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sera </font></font><code><font color="#0000FF">[Invoice]?</font></code>  : <br><br><img src="https://habrastorage.org/webt/rk/-s/l0/rk-sl0uz-jcgqfdxuqlrzhpbrby.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Maintenant, nous souhaitons connecter l'utilisateur </font></font><code><font color="#0000FF">user</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">à ses factures </font></font><code><font color="#0000FF">invoices</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, si elles ne sont pas égales </font></font><code><font color="#0000FF">nil</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, et enregistrer, par exemple, dans la structure de l'enveloppe </font></font><code><font color="#0000FF">UserEnvelope</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">qui est envoyée à l'utilisateur avec ses factures:</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UserEnvelope</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> user: <span class="hljs-type"><span class="hljs-type">User</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> invoices: [<span class="hljs-type"><span class="hljs-type">Invoice</span></span>] }</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Au lieu de jouer deux fois </font></font><code><font color="#0000FF">if let</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">...</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> newUser = newUser, <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> invoices = invoices { }</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">... écrivons un analogue fonctionnel du double </font></font><code><font color="#0000FF">if let</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">comme </font></font><code>Generic</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fonction </font><font style="vertical-align: inherit;">auxiliaire </font></font><code><font color="#0000FF">zip</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">qui convertit deux </font></font><code><font color="#0000FF">Optional</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">valeurs en un </font></font><code><font color="#0000FF">Optional</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tuple:</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">zip</span></span></span><span class="hljs-function">&lt;A, B&gt;</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> a: A?, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> b: B?)</span></span></span></span> -&gt; (<span class="hljs-type"><span class="hljs-type">A</span></span>, <span class="hljs-type"><span class="hljs-type">B</span></span>)? { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> a = a, <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> b = b { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (a, b) } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">nil</span></span> }</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Maintenant, nous n'avons aucune raison d'assigner quelque chose aux variables </font></font><code><font color="#0000FF">newUser</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et </font></font><code><font color="#0000FF">invoices</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, nous construisons tout simplement dans notre nouvelle fonction </font></font><code><font color="#0000FF">zip</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, utilisons l'initialiseur </font></font><code><font color="#0000FF">UserEnvelope.init</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et tout fonctionnera!</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> userEnv = <span class="hljs-built_in"><span class="hljs-built_in">zip</span></span>( <span class="hljs-type"><span class="hljs-type">Bundle</span></span>.main.path(forResource: <span class="hljs-string"><span class="hljs-string">"user"</span></span>, ofType: <span class="hljs-string"><span class="hljs-string">"json"</span></span>) .<span class="hljs-built_in"><span class="hljs-built_in">map</span></span>(<span class="hljs-type"><span class="hljs-type">URL</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>(fileURLWithPath:)) .flatMap { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>? <span class="hljs-type"><span class="hljs-type">Data</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>(contentsOf: $<span class="hljs-number"><span class="hljs-number">0</span></span>) } .flatMap { <span class="hljs-type"><span class="hljs-type">User</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>(json: $<span class="hljs-number"><span class="hljs-number">0</span></span>) }, <span class="hljs-type"><span class="hljs-type">Bundle</span></span>.main.path(forResource: <span class="hljs-string"><span class="hljs-string">"invoices"</span></span>, ofType: <span class="hljs-string"><span class="hljs-string">"json"</span></span>) .<span class="hljs-built_in"><span class="hljs-built_in">map</span></span>(<span class="hljs-type"><span class="hljs-type">URL</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>(fileURLWithPath:)) .flatMap { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>? <span class="hljs-type"><span class="hljs-type">Data</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>(contentsOf: $<span class="hljs-number"><span class="hljs-number">0</span></span>) } .flatMap { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>? <span class="hljs-type"><span class="hljs-type">JSONDecoder</span></span>().decode([<span class="hljs-type"><span class="hljs-type">Invoice</span></span>].<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>, from: $<span class="hljs-number"><span class="hljs-number">0</span></span>) } ).flatMap (<span class="hljs-type"><span class="hljs-type">UserEnvelope</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>) <span class="hljs-built_in"><span class="hljs-built_in">print</span></span> (<span class="hljs-string"><span class="hljs-string">"\(userEnv!)"</span></span>) <span class="hljs-comment"><span class="hljs-comment">// UserEnvelope(user: id: 42 name: Blob , // invoices: [id: 1 amountDue: 0 amountPaid: 1000 closed: true, // id: 2 amountDue: 500 amountPaid: 500 closed: false])</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dans une seule expression, un algorithme complet pour fournir des </font></font><code>JSON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">données à une forme complexe </font></font><code></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sous la forme d'une structure est </font><font style="vertical-align: inherit;">emballé </font></font><code><font color="#0000FF">struct UserEnvelope</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br><br><ul><li>    <code><font color="#0000FF">zip</font></code> ,  ,         .     <code><font color="#0000FF">user</font></code> , <code>JSON</code>   ,    <code><font color="#0000FF">invoices</font></code> ,      <code>JSON</code> .         . </li><li>    <code><font color="#0000FF">map</font></code> ,  ,   «»       . </li><li>    <code><font color="#0000FF">flatMap</font></code> ,  ,        ,     . </li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Opérations </font></font><code><font color="#0000FF">zip</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code><font color="#0000FF">map</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et </font></font><code><font color="#0000FF">flatMap</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">représentent une sorte de </font></font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">langage spécifique au domaine (DSL)</font></font></a></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pour la conversion des données. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous pouvons développer cette démonstration pour représenter la lecture asynchrone du contenu d'un fichier comme une fonction spéciale que vous pouvez voir sur </font></font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pointfree.co</font></font></a></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Je ne suis pas un fanatique de la </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">programmation fonctionnelle</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> partout et en tout, mais une utilisation modérée me semble souhaitable.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Conclusion </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">J'ai donné des </font><font style="vertical-align: inherit;">exemples de divers programmes fonctionnels caractéristiques </font></font><code>Swf</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t «hors de la boîte », basée sur l'utilisation des fonctions d'ordre supérieur </font></font><code><font color="#0000FF">map</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code><font color="#0000FF">flatMap</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code><font color="#0000FF">reduce</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code><font color="#0000FF">filter</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et l'autre pour les séquences </font></font><code><font color="#0000FF">Sequence</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code><font color="#0000FF">Optional</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et </font></font><code><font color="#0000FF">Result</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Ils peuvent être les «chevaux de bataille» de la création de code, </font></font><code>,</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">surtout si des </font></font><code></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">structures de </font><font style="vertical-align: inherit;">valeur </font></font><code><font color="#0000FF">struct</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et des énumérations y sont </font><font style="vertical-align: inherit;">impliquées </font></font><code><font color="#0000FF">enum</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Un développeur d' </font></font><code>iOS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">application doit posséder cet outil. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Toutes les démos compilées </font></font><code>Playground</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">peuvent être trouvées sur </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Github</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Si vous avez des problèmes avec le lancement </font></font><code>Playground</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, vous pouvez voir cet article:</font></font><br><br> <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comment se débarrasser des erreurs de «gel» de Xcode Playground avec les messages «Launching Simulator» et «Running Playground».</font></font></a></b> <br><br>  Références: <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">Functional Programming in Swift: An Introduction.</a> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">An Introduction to Functional Programming in Swift.</a> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">The Many Faces of Flat-Map: Part 3</a> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">Inside the Standard Library: Sequence.map()</a> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">Practical functional programming in Swift</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr440722/">https://habr.com/ru/post/fr440722/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr440712/index.html">Le cloud n'est que l'ordinateur de quelqu'un</a></li>
<li><a href="../fr440714/index.html">Comment la baisse du taux d'acquisition nous affecte (titulaires de carte)</a></li>
<li><a href="../fr440716/index.html">Mise en place du plus grand IDCS pré-assemblé pour les pouvoirs publics à Volgograd</a></li>
<li><a href="../fr440718/index.html">Transfert de données inter-scènes dans Unity - Application de plusieurs valeurs à un développement de jeu simple</a></li>
<li><a href="../fr440720/index.html">Nous implémentons l'interface utilisateur dans iOS: nous améliorons, accélérons, évoluons</a></li>
<li><a href="../fr440724/index.html">Sélection: 4 services utiles pour les immigrants potentiels aux États-Unis, en Europe et dans d'autres pays</a></li>
<li><a href="../fr440726/index.html">Le jeu des archétypes: comment la narration fonctionne pour les marques technologiques</a></li>
<li><a href="../fr440728/index.html">Développement mobile: de l'idée à l'estimation des coûts</a></li>
<li><a href="../fr440732/index.html">Mettre à niveau une carte de débogage avec un processeur Baikal-T1: ajoutez une carte SD</a></li>
<li><a href="../fr440734/index.html">Session ouverte en vue dans Spring Boot: The Phantom Menace</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>