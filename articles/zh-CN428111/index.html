<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ¶ ğŸ‘¢ ğŸ˜” Erlangä¸­ä»»æ„ç²¾åº¦çš„ç®—æœ¯ âœï¸ ğŸ–¼ï¸ ğŸ•›</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="@rawpixel 


 ç”šè‡³å­¦ç«¥ä¹Ÿæ„è¯†åˆ°å­˜åœ¨å„ç§æ•°å­—ç³»ç»Ÿï¼Œå¹¶ä¸”åœ¨äºŒè¿›åˆ¶æ•°å­—ç³»ç»Ÿä¸­å¹¶éæ¯ä¸ªæœ‰é™çš„å°æ•°éƒ¨åˆ†éƒ½æ˜¯æœ‰é™çš„äº‹å®ã€‚ å¾ˆå°‘æœ‰äººè®¤ä¸ºç”±äºè¿™ä¸ªäº‹å®ï¼Œå¯¹floatå’Œdoubleçš„è¿ç®—æ˜¯ä¸ç²¾ç¡®çš„ã€‚ 


 å¦‚æœæˆ‘ä»¬è°ˆè®ºErlangï¼Œåˆ™ä¸è®¸å¤šå…¶ä»–è¯­è¨€ä¸€æ ·ï¼Œå®ƒå®ç°äº†floatçš„IEEE754æ ‡å‡†ï¼Œè€ŒErl...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Erlangä¸­ä»»æ„ç²¾åº¦çš„ç®—æœ¯</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/428111/"><p><img src="https://habrastorage.org/webt/h6/vn/cg/h6vncgl-xdc_8d5peworwhnrg4a.jpeg"><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">@rawpixel</a> </p><br><p> ç”šè‡³å­¦ç«¥ä¹Ÿæ„è¯†åˆ°å­˜åœ¨å„ç§æ•°å­—ç³»ç»Ÿï¼Œå¹¶ä¸”åœ¨äºŒè¿›åˆ¶æ•°å­—ç³»ç»Ÿä¸­å¹¶éæ¯ä¸ªæœ‰é™çš„å°æ•°éƒ¨åˆ†éƒ½æ˜¯æœ‰é™çš„äº‹å®ã€‚ å¾ˆå°‘æœ‰äººè®¤ä¸ºç”±äºè¿™ä¸ªäº‹å®ï¼Œå¯¹floatå’Œdoubleçš„è¿ç®—æ˜¯ä¸ç²¾ç¡®çš„ã€‚ </p><br><p> å¦‚æœæˆ‘ä»¬è°ˆè®ºErlangï¼Œåˆ™ä¸è®¸å¤šå…¶ä»–è¯­è¨€ä¸€æ ·ï¼Œå®ƒå®ç°äº†floatçš„IEEE754æ ‡å‡†ï¼Œè€ŒErlangä¸­çš„æ ‡å‡†Integerç±»å‹æ˜¯ä½¿ç”¨ä»»æ„ç²¾åº¦ç®—æ³•å®ç°çš„ã€‚ ä½†æ˜¯ï¼Œæˆ‘ä¸ä»…å¸Œæœ›æœ‰bigintï¼Œè€Œä¸”è¿˜å¸Œæœ›èƒ½å¤Ÿä»¥å¿…è¦çš„ç²¾åº¦ä½¿ç”¨æœ‰ç†æ•°ï¼Œå¤æ•°å’Œæµ®ç‚¹æ•°è¿›è¡Œè¿ç®—ã€‚ </p><br><p>æœ¬æ–‡ä»…å¯¹æµ®ç‚¹æ•°çš„ç¼–ç ç†è®ºè¿›è¡Œäº†ç®€è¦ä»‹ç»ï¼Œå¹¶ç»™å‡ºäº†æ–°å…´æ•ˆæœçš„æœ€é†’ç›®çš„ä¾‹å­ã€‚ é€šè¿‡è¿‡æ¸¡åˆ°å®šç‚¹è¡¨ç¤ºæ¥æä¾›å¿…è¦çš„æ“ä½œç²¾åº¦çš„è§£å†³æ–¹æ¡ˆè¢«è®¾è®¡ä¸ºEAPAåº“ï¼ˆErlangä»»æ„ç²¾åº¦ç®—æ³•ï¼‰ï¼Œæ—¨åœ¨æ»¡è¶³åœ¨Erlang / Elixirä¸Šå¼€å‘çš„é‡‘èåº”ç”¨ç¨‹åºçš„éœ€æ±‚ã€‚ </p><a name="habracut"></a><br><hr><br><h2 id="standarty-standarty-standarty"> æ ‡å‡†ï¼Œæ ‡å‡†ï¼Œæ ‡å‡†... </h2><br><p> å¦‚ä»Šï¼ŒäºŒè¿›åˆ¶æµ®ç‚¹ç®—æœ¯çš„ä¸»è¦æ ‡å‡†æ˜¯IEEE754ï¼Œè¯¥æ ‡å‡†å¹¿æ³›ç”¨äºå·¥ç¨‹å’Œç¼–ç¨‹ä¸­ã€‚ å®ƒå®šä¹‰äº†å››ç§æ¼”ç¤ºæ ¼å¼ï¼š </p><br><ul><li> å•ç²¾åº¦32ä½ </li><li> åŒç²¾åº¦64ä½ </li><li> å•æ‰©å±•ç²¾åº¦&gt; = 43ä½ï¼ˆå¾ˆå°‘ä½¿ç”¨ï¼‰ </li><li> åŒæ‰©å±•ç²¾åº¦&gt; = 79ä½ï¼ˆé€šå¸¸ä½¿ç”¨80ä½ï¼‰ <br> å’Œå››ç§èˆå…¥æ¨¡å¼ï¼š </li><li> å››èˆäº”å…¥ï¼Œè¶‹äºæœ€æ¥è¿‘çš„æ•´æ•°ã€‚ </li><li> èˆå…¥è¶‹äºé›¶ã€‚ </li><li> èˆå…¥è¶‹äº+âˆ </li><li> å‘-âˆèˆå…¥ </li></ul><br><p> å¤§å¤šæ•°ç°ä»£å¾®å¤„ç†å™¨éƒ½æ˜¯ä½¿ç”¨IEEE754æ ¼å¼çš„å®æ•°è¡¨ç¤ºå½¢å¼çš„ç¡¬ä»¶å®ç°æ¥åˆ¶é€ çš„ã€‚ è¡¨ç¤ºæ ¼å¼é™åˆ¶äº†æ•°å­—çš„å¤§å°é™åˆ¶ï¼Œå¹¶ä¸”èˆå…¥æ¨¡å¼ä¼šå½±å“å‡†ç¡®æ€§ã€‚ ç¨‹åºå‘˜é€šå¸¸æ— æ³•æ›´æ”¹ç¡¬ä»¶çš„è¡Œä¸ºå¹¶æ— æ³•å®ç°ç¼–ç¨‹è¯­è¨€ã€‚ ä¾‹å¦‚ï¼Œæ­£å¼çš„Erlangå®ç°åœ¨64ä½è®¡ç®—æœºä¸Šä»¥3ä¸ªå­—å­˜å‚¨æµ®ç‚¹æ•°ï¼Œåœ¨32ä½è®¡ç®—æœºä¸Šä»¥4ä¸ªå­—å­˜å‚¨æµ®ç‚¹æ•°ã€‚ </p><br><p> å¦‚ä¸Šæ‰€è¿°ï¼ŒIEEE754æ ¼å¼çš„æ•°å­—æ˜¯ä¸€ä¸ªæœ‰é™é›†ï¼Œæ— é™çš„å®æ•°é›†æ˜ å°„åˆ°è¯¥æœ‰é™é›†ï¼Œå› æ­¤åŸå§‹æ•°å­—å¯èƒ½ä¼šä»¥IEEE754æ ¼å¼å‡ºç°é”™è¯¯ã€‚ </p><br><p> å½“æ˜¾ç¤ºåœ¨æœ‰é™é›†åˆä¸Šæ—¶ï¼Œå¤§å¤šæ•°æ•°å­—å…·æœ‰ç¨³å®šä¸”ç›¸å¯¹è¾ƒå°çš„è¯¯å·®ã€‚ å› æ­¤ï¼Œå¯¹äºæµ®ç‚¹æ•°ï¼Œå®ƒæ˜¯11.920928955078125e-6ï¼…ï¼Œè€Œå¯¹äºä¸¤å€æ•°-2.2204460492503130808472633361816e-14ï¼…ã€‚ åœ¨ç¨‹åºå‘˜çš„ç”Ÿæ´»ä¸­ï¼Œè¦è§£å†³çš„å¤§å¤šæ•°æ—¥å¸¸ä»»åŠ¡ä½¿æˆ‘ä»¬å¯ä»¥å¿½ç•¥æ­¤é”™è¯¯ï¼Œå°½ç®¡åº”è¯¥æ³¨æ„çš„æ˜¯ï¼Œå³ä½¿åœ¨ç®€å•çš„ä»»åŠ¡ä¸­ï¼Œæ‚¨ä¹Ÿå¯ä»¥è¸©è¸è€™å­ï¼Œå› ä¸ºå¯¹äºæµ®ç‚¹æ•°å’Œä¸¤å€æ•°ï¼Œç»å¯¹è¯¯å·®çš„å¤§å°åˆ†åˆ«å¯ä»¥è¾¾åˆ°10 <sup>31</sup>å’Œ10 <sup>292</sup> ï¼Œä»è€Œå¯¼è‡´è®¡ç®—å›°éš¾ã€‚ </p><br><h2 id="illyustraciya-effektov"> æ•ˆæœå›¾ </h2><br><p> ä»ä¸€èˆ¬ä¿¡æ¯åˆ°ä¸šåŠ¡ã€‚ è®©æˆ‘ä»¬å°è¯•é‡ç°Erlangä¸­æ–°å…´çš„æ•ˆæœã€‚ </p><br><p> ä»¥ä¸‹æ‰€æœ‰ç¤ºä¾‹å‡è®¾è®¡ä¸ºctæµ‹è¯•ã€‚ </p><br><h3 id="okruglenie-i-poterya-tochnosti"> èˆå…¥å’Œç²¾åº¦æŸå¤± </h3><br><p> è®©æˆ‘ä»¬ä»ç»å…¸å¼€å§‹-ä¸¤ä¸ªæ•°å­—ç›¸åŠ ï¼š0.1 + 0.2 = ?ï¼š </p><br><pre><code class="erlang hljs"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">t30000000000000004</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(_)</span></span></span><span class="hljs-function">-&gt;</span></span> [<span class="hljs-string"><span class="hljs-string">"0.30000000000000004"</span></span>] = io_lib:format(<span class="hljs-string"><span class="hljs-string">"~w"</span></span>, [<span class="hljs-number"><span class="hljs-number">0.1</span></span> + <span class="hljs-number"><span class="hljs-number">0.2</span></span>]).</code> </pre> <br><p> æ·»åŠ çš„ç»“æœä¸ç›´è§‚é¢„æœŸçš„ç»“æœç•¥æœ‰ä¸åŒï¼Œå¹¶ä¸”æµ‹è¯•æˆåŠŸé€šè¿‡ã€‚ è®©æˆ‘ä»¬å°è¯•è·å¾—æ­£ç¡®çš„ç»“æœã€‚ ä½¿ç”¨EAPAé‡å†™æµ‹è¯•ï¼š </p><br><pre> <code class="erlang hljs"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">t30000000000000004_eapa</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(_)</span></span></span><span class="hljs-function">-&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">%% prec = 1 symbols after coma X = eapa_int:with_val(1, &lt;&lt;"0.1"&gt;&gt;), Y = eapa_int:with_val(1, &lt;&lt;"0.2"&gt;&gt;), &lt;&lt;"0.3"&gt;&gt; = eapa_int:to_float(1, eapa_int:add(X, Y)).</span></span></code> </pre> <br><p> æ­¤æµ‹è¯•ä¹ŸæˆåŠŸï¼Œè¡¨æ˜é—®é¢˜å·²è§£å†³ã€‚ <br> è®©æˆ‘ä»¬ç»§ç»­å®éªŒï¼Œä¸º1.0æ·»åŠ ä¸€ä¸ªéå¸¸å°çš„å€¼ï¼š </p><br><pre> <code class="erlang hljs"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">tiny</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(_)</span></span></span><span class="hljs-function">-&gt;</span></span> X = <span class="hljs-number"><span class="hljs-number">1.0</span></span>, Y = <span class="hljs-number"><span class="hljs-number">0.0000000000000000000000001</span></span>, <span class="hljs-number"><span class="hljs-number">1.0</span></span> = X + Y.</code> </pre> <br><p> å¦‚æ‚¨æ‰€è§ï¼Œæˆ‘ä»¬çš„å¢é•¿æ²¡æœ‰å¼•èµ·æ³¨æ„ã€‚ æˆ‘ä»¬æ­£åœ¨å°è¯•è§£å†³è¯¥é—®é¢˜ï¼ŒåŒæ—¶è¯´æ˜è¯¥åº“çš„åŠŸèƒ½ä¹‹ä¸€-è‡ªåŠ¨ç¼©æ”¾ï¼š </p><br><pre> <code class="erlang hljs"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">tiny_eapa</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(_)</span></span></span><span class="hljs-function">-&gt;</span></span> X1 = eapa_int:with_val(<span class="hljs-number"><span class="hljs-number">1</span></span>, &lt;&lt;<span class="hljs-string"><span class="hljs-string">"1.0"</span></span>&gt;&gt;), X2 = eapa_int:with_val(<span class="hljs-number"><span class="hljs-number">25</span></span>, &lt;&lt;<span class="hljs-string"><span class="hljs-string">"0.0000000000000000000000001"</span></span>&gt;&gt;), &lt;&lt;<span class="hljs-string"><span class="hljs-string">"1.0000000000000000000000001"</span></span>&gt;&gt; = eapa_int:to_float(eapa_int:add(X1, X2)).</code> </pre> <br><h3 id="perepolnenie-razryadnoy-setki"> ä½ç½‘æ ¼æº¢å‡º </h3><br><p> é™¤äº†ä¸å°æ•°ç›¸å…³çš„é—®é¢˜å¤–ï¼Œæº¢å‡ºä¹Ÿæ˜¯ä¸€ä¸ªæ˜¾è€Œæ˜“è§çš„é‡è¦é—®é¢˜ã€‚ </p><br><pre> <code class="erlang hljs"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">float_overflow</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(_)</span></span></span><span class="hljs-function"> -&gt;</span></span> <span class="hljs-number"><span class="hljs-number">1.0</span></span> = <span class="hljs-number"><span class="hljs-number">9007199254740991.0</span></span> - <span class="hljs-number"><span class="hljs-number">9007199254740990.0</span></span>, <span class="hljs-number"><span class="hljs-number">1.0</span></span> = <span class="hljs-number"><span class="hljs-number">9007199254740992.0</span></span> - <span class="hljs-number"><span class="hljs-number">9007199254740991.0</span></span>, <span class="hljs-number"><span class="hljs-number">0.0</span></span> = <span class="hljs-number"><span class="hljs-number">9007199254740993.0</span></span> - <span class="hljs-number"><span class="hljs-number">9007199254740992.0</span></span>, <span class="hljs-number"><span class="hljs-number">2.0</span></span> = <span class="hljs-number"><span class="hljs-number">9007199254740994.0</span></span> - <span class="hljs-number"><span class="hljs-number">9007199254740993.0</span></span>.</code> </pre> <br><p> ä»æµ‹è¯•ä¸­å¯ä»¥çœ‹åˆ°ï¼Œåœ¨æŸäº›æ—¶å€™ï¼Œå·®å¼‚ä¸å†ç­‰äº1.0ï¼Œè¿™æ˜¾ç„¶æ˜¯ä¸€ä¸ªé—®é¢˜ã€‚  EAPAä¹Ÿè§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼š </p><br><pre> <code class="erlang hljs"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">float_overflow_eapa</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(_)</span></span></span><span class="hljs-function">-&gt;</span></span> X11 = eapa_int:with_val(<span class="hljs-number"><span class="hljs-number">1</span></span>, &lt;&lt;<span class="hljs-string"><span class="hljs-string">"9007199254740992.0"</span></span>&gt;&gt;), X21 = eapa_int:with_val(<span class="hljs-number"><span class="hljs-number">1</span></span>, &lt;&lt;<span class="hljs-string"><span class="hljs-string">"9007199254740991.0"</span></span>&gt;&gt;), &lt;&lt;<span class="hljs-string"><span class="hljs-string">"1.0"</span></span>&gt;&gt; = eapa_int:to_float(<span class="hljs-number"><span class="hljs-number">1</span></span>, eapa_int:sub(X11, X21)), X12 = eapa_int:with_val(<span class="hljs-number"><span class="hljs-number">1</span></span>, &lt;&lt;<span class="hljs-string"><span class="hljs-string">"9007199254740993.0"</span></span>&gt;&gt;), X22 = eapa_int:with_val(<span class="hljs-number"><span class="hljs-number">1</span></span>, &lt;&lt;<span class="hljs-string"><span class="hljs-string">"9007199254740992.0"</span></span>&gt;&gt;), &lt;&lt;<span class="hljs-string"><span class="hljs-string">"1.0"</span></span>&gt;&gt; = eapa_int:to_float(<span class="hljs-number"><span class="hljs-number">1</span></span>, eapa_int:sub(X12, X22)), X13 = eapa_int:with_val(<span class="hljs-number"><span class="hljs-number">1</span></span>, &lt;&lt;<span class="hljs-string"><span class="hljs-string">"9007199254740994.0"</span></span>&gt;&gt;), X23 = eapa_int:with_val(<span class="hljs-number"><span class="hljs-number">1</span></span>, &lt;&lt;<span class="hljs-string"><span class="hljs-string">"9007199254740993.0"</span></span>&gt;&gt;), &lt;&lt;<span class="hljs-string"><span class="hljs-string">"1.0"</span></span>&gt;&gt; = eapa_int:to_float(<span class="hljs-number"><span class="hljs-number">1</span></span>, eapa_int:sub(X13, X23)).</code> </pre> <br><h3 id="opasnaya-redukciya"> å±é™©å‡å°‘ </h3><br><p> ä»¥ä¸‹æµ‹è¯•è¡¨æ˜å±é™©å‡å°‘çš„å‘ç”Ÿã€‚ åœ¨æ­¤è¿‡ç¨‹ä¸­ï¼Œç»“æœå€¼è¿œå°äºè¾“å…¥å€¼çš„æ“ä½œçš„è®¡ç®—ç²¾åº¦å°†å‘ç”Ÿç¾éš¾æ€§çš„ä¸‹é™ã€‚ åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œå‡æ³•çš„ç»“æœä¸º1ã€‚ </p><br><p> æˆ‘ä»¬æ˜¾ç¤ºåœ¨Erlangä¸­å­˜åœ¨æ­¤é—®é¢˜ï¼š </p><br><pre> <code class="erlang hljs"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">reduction</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(_)</span></span></span><span class="hljs-function">-&gt;</span></span> X = float(<span class="hljs-number"><span class="hljs-number">87654321098765432</span></span>), Y = float(<span class="hljs-number"><span class="hljs-number">87654321098765431</span></span>), <span class="hljs-number"><span class="hljs-number">16.0</span></span> = XY. <span class="hljs-comment"><span class="hljs-comment">%% has to be 1.0</span></span></code> </pre> <br><p> ç»“æœæ˜¯16.0ï¼Œè€Œä¸æ˜¯é¢„æœŸçš„1.0ã€‚ è®©æˆ‘ä»¬å°è¯•è§£å†³è¿™ç§æƒ…å†µï¼š </p><br><pre> <code class="erlang hljs"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">reduction_eapa</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(_)</span></span></span><span class="hljs-function">-&gt;</span></span> X = eapa_int:with_val(<span class="hljs-number"><span class="hljs-number">1</span></span>, &lt;&lt;<span class="hljs-string"><span class="hljs-string">"87654321098765432"</span></span>&gt;&gt;), Y = eapa_int:with_val(<span class="hljs-number"><span class="hljs-number">1</span></span>, &lt;&lt;<span class="hljs-string"><span class="hljs-string">"87654321098765431"</span></span>&gt;&gt;), &lt;&lt;<span class="hljs-string"><span class="hljs-string">"1.0"</span></span>&gt;&gt; = eapa_int:to_float(eapa_int:sub(X, Y)).</code> </pre> <br><h3 id="drugie-osobennosti-arifmetiki-s-plavayuschey-tochkoy-v-erlang">  Erlangä¸­æµ®ç‚¹è¿ç®—çš„å…¶ä»–åŠŸèƒ½ </h3><br><p> è®©æˆ‘ä»¬ä»å¿½ç•¥è´Ÿé›¶å¼€å§‹ã€‚ </p><br><pre> <code class="erlang hljs"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">eq</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(_)</span></span></span><span class="hljs-function">-&gt;</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span> = list_to_float(<span class="hljs-string"><span class="hljs-string">"0.0"</span></span>) =:= list_to_float(<span class="hljs-string"><span class="hljs-string">"-0.0"</span></span>).</code> </pre> <br><p> åªæƒ³è¯´EAPAä¿ç•™äº†è¿™ç§è¡Œä¸ºï¼š </p><br><pre> <code class="erlang hljs"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">eq_eapa</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(_)</span></span></span><span class="hljs-function">-&gt;</span></span> X = eapa_int:with_val(<span class="hljs-number"><span class="hljs-number">1</span></span>, &lt;&lt;<span class="hljs-string"><span class="hljs-string">"0.0"</span></span>&gt;&gt;), Y = eapa_int:with_val(<span class="hljs-number"><span class="hljs-number">1</span></span>, &lt;&lt;<span class="hljs-string"><span class="hljs-string">"-0.0"</span></span>&gt;&gt;), <span class="hljs-literal"><span class="hljs-literal">true</span></span> = eapa_int:eq(X, Y).</code> </pre> <br><p> å› ä¸ºå®ƒæ˜¯æœ‰æ•ˆçš„  Erlangæ²¡æœ‰æ¸…æ™°çš„è¯­æ³•å’ŒNaNå’Œæ— ç©·çš„å¤„ç†æ–¹å¼ï¼Œå› æ­¤äº§ç”Ÿäº†è®¸å¤šåŠŸèƒ½ï¼Œä¾‹å¦‚ï¼š </p><br><pre> <code class="hljs erlang-repl"><span class="hljs-meta"><span class="hljs-meta">1&gt; </span></span>math:sqrt(list_to_float(<span class="hljs-string"><span class="hljs-string">"-0.0"</span></span>)). <span class="hljs-number"><span class="hljs-number">0.0</span></span></code> </pre> <br><p> æ¥ä¸‹æ¥çš„ä¸€ç‚¹æ˜¯å¤„ç†å¤§å°æ•°å­—çš„åŠŸèƒ½ã€‚ è®©æˆ‘ä»¬å°è¯•ä¸ºå°å­©å­å¤åˆ¶ï¼š </p><br><pre> <code class="hljs erlang-repl"><span class="hljs-meta"><span class="hljs-meta">2&gt; </span></span>list_to_float(<span class="hljs-string"><span class="hljs-string">"0."</span></span>++lists:duplicate(<span class="hljs-number"><span class="hljs-number">322</span></span>, $<span class="hljs-number"><span class="hljs-number">0</span></span>)++<span class="hljs-string"><span class="hljs-string">"1"</span></span>). <span class="hljs-number"><span class="hljs-number">1.0e-323</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span>&gt; list_to_float(<span class="hljs-string"><span class="hljs-string">"0."</span></span>++lists:duplicate(<span class="hljs-number"><span class="hljs-number">323</span></span>, $<span class="hljs-number"><span class="hljs-number">0</span></span>)++<span class="hljs-string"><span class="hljs-string">"1"</span></span>). <span class="hljs-number"><span class="hljs-number">0.0</span></span></code> </pre> <br><p> å¯¹äºå¤§é‡ï¼š </p><br><pre> <code class="hljs erlang-repl"><span class="hljs-meta"><span class="hljs-meta">4&gt; </span></span>list_to_float(<span class="hljs-string"><span class="hljs-string">"1"</span></span>++lists:duplicate(<span class="hljs-number"><span class="hljs-number">308</span></span>, $<span class="hljs-number"><span class="hljs-number">0</span></span>)++<span class="hljs-string"><span class="hljs-string">".0"</span></span>). <span class="hljs-number"><span class="hljs-number">1.0e308</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span>&gt; list_to_float(<span class="hljs-string"><span class="hljs-string">"1"</span></span>++lists:duplicate(<span class="hljs-number"><span class="hljs-number">309</span></span>, $<span class="hljs-number"><span class="hljs-number">0</span></span>)++<span class="hljs-string"><span class="hljs-string">".0"</span></span>). ** exception error: bad argument</code> </pre> <br><p> ä»¥ä¸‹æ˜¯ä¸€äº›æœ‰å…³å°æ•°å­—çš„ç¤ºä¾‹ï¼š </p><br><pre> <code class="hljs erlang-repl"><span class="hljs-meta"><span class="hljs-meta">6&gt; </span></span>list_to_float(<span class="hljs-string"><span class="hljs-string">"0."</span></span>++lists:duplicate(<span class="hljs-number"><span class="hljs-number">322</span></span>, $<span class="hljs-number"><span class="hljs-number">0</span></span>)++<span class="hljs-string"><span class="hljs-string">"123456789"</span></span>). <span class="hljs-number"><span class="hljs-number">1.0e-323</span></span> <span class="hljs-number"><span class="hljs-number">7</span></span>&gt; list_to_float(<span class="hljs-string"><span class="hljs-string">"0."</span></span>++lists:duplicate(<span class="hljs-number"><span class="hljs-number">300</span></span>, $<span class="hljs-number"><span class="hljs-number">0</span></span>)++<span class="hljs-string"><span class="hljs-string">"123456789"</span></span>). <span class="hljs-number"><span class="hljs-number">1.23456789e-301</span></span></code> </pre> <br><pre> <code class="hljs erlang-repl"><span class="hljs-meta"><span class="hljs-meta">8&gt; </span></span><span class="hljs-number"><span class="hljs-number">0.123456789e-100</span></span> * <span class="hljs-number"><span class="hljs-number">0.123456789e-100</span></span>. <span class="hljs-number"><span class="hljs-number">1.524157875019052e-202</span></span> <span class="hljs-number"><span class="hljs-number">9</span></span>&gt; <span class="hljs-number"><span class="hljs-number">0.123456789e-200</span></span> * <span class="hljs-number"><span class="hljs-number">0.123456789e-200</span></span>. <span class="hljs-number"><span class="hljs-number">0.0</span></span></code> </pre> <br><p> ä¸Šé¢çš„ä¾‹å­è¯å®äº†Erlangé¡¹ç›®çš„çœŸå®æ€§ï¼šåœ¨IEEE754ä¸­ä¸èƒ½ç®—é’±ã€‚ </p><br><h2 id="eapa-erlang-arbitrary-precision-arithmetic">  EAPAï¼ˆErlangä»»æ„ç²¾åº¦ç®—æ³•ï¼‰ </h2><br><p>  EAPAæ˜¯ç”¨Rustç¼–å†™çš„NIFæ‰©å±•ã€‚ ç›®å‰ï¼ŒEAPAå­˜å‚¨åº“æä¾›äº†æœ€ç®€å•æ–¹ä¾¿çš„eapa_intæ¥å£æ¥å¤„ç†å®šç‚¹æ•°å­—ã€‚  eapa_intçš„åŠŸèƒ½åŒ…æ‹¬ï¼š </p><br><ol><li> ç¼ºä¹IEEE754ç¼–ç çš„å½±å“ </li><li> å¤§é‡æ”¯æŒ </li><li> å¯é…ç½®çš„ç²¾åº¦é«˜è¾¾126ä½å°æ•°ã€‚  ï¼ˆåœ¨å½“å‰å®æ–½ä¸­ï¼‰ </li><li> è‡ªåŠ¨ç¼©æ”¾ </li><li> æ”¯æŒæ‰€æœ‰æ•°å­—åŸºæœ¬æ“ä½œ </li><li> æˆ–å¤šæˆ–å°‘çš„å®Œæ•´æµ‹è¯•ï¼ŒåŒ…æ‹¬åŸºäºå±æ€§çš„æµ‹è¯•ã€‚ </li></ol><br><p>  <code>eapa_int</code>æ¥å£ï¼š </p><br><ul><li>  <code>with_val/2</code>å°†æµ®ç‚¹æ•°è½¬æ¢ä¸ºå›ºå®šè¡¨ç¤ºï¼Œå¯ä»¥å®‰å…¨åœ°åœ¨jsonï¼Œxmlä¸­ä½¿ç”¨ã€‚ </li><li>  <code>to_float/2</code>ä»¥ç»™å®šçš„ç²¾åº¦å°†å®šç‚¹æ•°è½¬æ¢ä¸ºæµ®ç‚¹æ•°ã€‚ </li><li>  <code>to_float/1</code>å°†å®šç‚¹æ•°è½¬æ¢ä¸ºæµ®ç‚¹æ•°ã€‚ </li><li>  <code>add/2</code>ä¸¤ä¸ªæ•°å­—çš„å’Œ </li><li>  <code>sub/2</code>å·®å¼‚ </li><li>  <code>mul/2</code>ä¹˜æ³• </li><li>  <code>divp/2</code>é™¤æ³• </li><li>  <code>min/2</code>æœ€å°å€¼ </li><li>  <code>max/2</code>æœ€å¤§å€¼ </li><li>  <code>eq/2</code>æ£€æŸ¥æ•°å­—æ˜¯å¦ç›¸ç­‰ </li><li>  <code>lt/2</code>æ£€æŸ¥æ•°å­—æ˜¯å¦å°‘äº </li><li>  <code>lte/2</code>æ£€æŸ¥å°äºç­‰äº </li><li>  <code>gt/2</code>æ£€æŸ¥æ•°å­—æ˜¯å¦æ›´å¤§ </li><li>  <code>gte/2</code>æ£€æŸ¥å¤§äºç­‰äº </li></ul><br><p>  EAPAä»£ç å¯åœ¨å­˜å‚¨åº“<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">https://github.com/Vonmo/eapaä¸­</a>æ‰¾åˆ° </p><br><p> ä»€ä¹ˆæ—¶å€™åº”è¯¥ä½¿ç”¨eapa_intï¼Ÿ ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨çš„åº”ç”¨ç¨‹åºéœ€è¦èŠ±é’±ï¼Œæˆ–è€…æ‚¨éœ€è¦æ–¹ä¾¿ï¼Œå‡†ç¡®åœ°å¯¹92233720368547758058079223372054754775807.92233720368547758079223372036854775807ç­‰æ•°å­—æ‰§è¡Œè®¡ç®—æ“ä½œï¼Œåˆ™å¯ä»¥å®‰å…¨åœ°ä½¿ç”¨EAPAã€‚ </p><br><p> åƒä»»ä½•è§£å†³æ–¹æ¡ˆä¸€æ ·ï¼ŒEAPAæ˜¯ä¸€ç§æŠ˜è¡·æ–¹æ¡ˆã€‚ æˆ‘ä»¬é€šè¿‡ç‰ºç‰²å†…å­˜å’Œè®¡ç®—é€Ÿåº¦æ¥è·å¾—å¿…è¦çš„ç²¾åº¦ï¼Œåœ¨å®é™…ç³»ç»Ÿä¸Šæ”¶é›†çš„æ€§èƒ½æµ‹è¯•å’Œç»Ÿè®¡æ•°æ®è¡¨æ˜ï¼Œå¤§å¤šæ•°æ“ä½œéƒ½åœ¨3-30Î¼sçš„èŒƒå›´å†…æ‰§è¡Œã€‚ é€‰æ‹©EAPAå›ºå®šç‚¹æ¥å£æ—¶ï¼Œä¹Ÿå¿…é¡»è€ƒè™‘è¿™ä¸€ç‚¹ã€‚ </p><br><h2 id="zaklyuchenie"> ç»“è®º </h2><br><p> å½“ç„¶ï¼Œåœ¨Erlangæˆ–Elixirä¸Šè§£å†³æ­¤ç±»é—®é¢˜å¹¶éæ€»æ˜¯å¿…è¦çš„ï¼Œä½†æ˜¯å½“å‡ºç°é—®é¢˜ä¸”æ‰¾ä¸åˆ°åˆé€‚çš„å·¥å…·æ—¶ï¼Œæ‚¨å¿…é¡»å‘æ˜è§£å†³æ–¹æ¡ˆã€‚ <br> æœ¬æ–‡æ—¨åœ¨ä¸ç¤¾åŒºåˆ†äº«è¯¥å·¥å…·å’Œç»éªŒï¼Œå¸Œæœ›è¯¥åº“å¯¹äºæŸäº›äººæœ‰ç”¨å¹¶æœ‰åŠ©äºèŠ‚çœæ—¶é—´ã€‚ <br> æ‚¨å¦‚ä½•çœ‹å¾…Erlangçš„é’±ï¼Ÿ </p><br><p>  PSå°†å¤„ç†æœ‰ç†æ•°å’Œå¤æ•°ï¼Œä»¥åŠå¯¹ä»»æ„ç²¾åº¦çš„æ•´æ•°ï¼Œæµ®ç‚¹æ•°ï¼Œå¤æ•°ï¼Œæœ‰ç†ç±»å‹çš„æœ¬æœºè®¿é—®ï¼Œå°†åœ¨ä»¥ä¸‹å‡ºç‰ˆç‰©ä¸­ä»‹ç»ã€‚ ä¸è¦åˆ‡æ¢ï¼ </p><br><hr><br><p> ç›¸å…³èµ„æ–™ï¼š </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ¯ä½è®¡ç®—æœºç§‘å­¦å®¶éƒ½åº”äº†è§£çš„æµ®ç‚¹è¿ç®—æ³•åˆ™</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ‚¨éœ€è¦äº†è§£çš„æœ‰å…³æµ®ç‚¹è¿ç®—çš„çŸ¥è¯†</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">IEEEæ ‡å‡†754æµ®ç‚¹æ•°</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">IEEE 754-äºŒè¿›åˆ¶ç®—æœ¯æ ‡å‡†</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><br></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æµ®ç‚¹æ•°</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">0.30000000000000004</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN428111/">https://habr.com/ru/post/zh-CN428111/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN428101/index.html">å¦‚ä½•ä½¿ç”¨Jenkinsæ„å»ºå’Œæ»šåŠ¨å­˜å‚¨åº“ä¸­è¡¨çš„å…ƒæ•°æ®æ¨¡å‹å·¥ä»¶çš„å·¥ä»¶</a></li>
<li><a href="../zh-CN428103/index.html">åœ£å½¼å¾—å ¡çš„Mitapï¼šæ•°æ®å·¥ç¨‹åŠæ›´å¤š</a></li>
<li><a href="../zh-CN428105/index.html">Bloggerå»ºè®®ï¼šå½±å“è¥é”€</a></li>
<li><a href="../zh-CN428107/index.html">Angular 6 SPAæ¨¡æ¿ASP .NET Core 2.1åº”ç”¨ç¨‹åºçš„å®¹å™¨åŒ–</a></li>
<li><a href="../zh-CN428109/index.html">ä¼ä¸šå¢™</a></li>
<li><a href="../zh-CN428113/index.html">å…³äºè´å¡å°”æ›²çº¿ï¼ŒArduinoé€Ÿåº¦å’Œä¸€ä¸ªæœ‰è¶£çš„ç«™ç‚¹ï¼Œæˆ–è€…æˆ‘å¦‚ä½•åº¦è¿‡å‘¨æœ«çš„é—®é¢˜</a></li>
<li><a href="../zh-CN428115/index.html">ç”µå­å•†åŠ¡çš„ç½‘ç»œå¼€å‘ï¼š2019å¹´çš„5ç§æŠ€æœ¯è¶‹åŠ¿</a></li>
<li><a href="../zh-CN428117/index.html">Googleåœ¨åä½œäº‘ä¸­æä¾›å…è´¹çš„å¼ é‡å¤„ç†å™¨</a></li>
<li><a href="../zh-CN428119/index.html">â€œ Class-fields-proposalâ€æˆ–â€œ tc39 commitå‡ºäº†ä»€ä¹ˆé—®é¢˜â€</a></li>
<li><a href="../zh-CN428121/index.html">æ–¯å¦Â·å¾·æ‹‰æ™®é‡‘ï¼ˆStan Drapkinï¼‰ã€‚ .NETä¸­çš„é«˜çº§å¯†ç é™·é˜±</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>