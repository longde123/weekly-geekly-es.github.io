<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üè¥Û†ÅßÛ†Å¢Û†Å∑Û†Å¨Û†Å≥Û†Åø üë®üèª‚Äçüç≥ üèñÔ∏è Automatizaci√≥n de Android Gu√≠a s√∫per f√°cil para crear tu primera prueba de Espresso üõÄüèø üßëüèæ‚Äçü§ù‚Äçüßëüèæ üê∏</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hola amigos En previsi√≥n del inicio del curso Mobile QA Engineer , queremos compartir con usted una traducci√≥n de material interesante. 



 ¬øQu√© es e...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Automatizaci√≥n de Android Gu√≠a s√∫per f√°cil para crear tu primera prueba de Espresso</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/472372/">  Hola amigos  En previsi√≥n del inicio del curso <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Mobile QA Engineer</a> , queremos compartir con usted una traducci√≥n de material interesante. <br><br><img src="https://habrastorage.org/webt/he/52/7b/he527bnnfyevgfpavom-jhtt-c8.png"><br><hr><br><h3>  ¬øQu√© es el espresso? </h3><br>  No, esta no es una bebida que bebes todos los d√≠as para alegrarte.  Espresso es un marco de prueba de c√≥digo abierto desarrollado por Google.  Le permite realizar pruebas complejas de interfaz de usuario en un dispositivo o emulador real.  ¬øTomar√° tiempo comenzar a escribir pruebas complejas para Android? <br><br>  Posiblemente  Pero nada le impide dar el primer paso y aprender a escribir casos de prueba simples para Android usando el marco Espresso en este momento. <br><a name="habracut"></a><br><h3>  ¬øCu√©ntanos m√°s sobre la automatizaci√≥n? </h3><br>  Por supuesto  La automatizaci√≥n es una forma de acelerar las pruebas, hacerlas m√°s eficientes y escalables.  Las pruebas manuales son muy importantes, pero tener pruebas automatizadas es una opci√≥n mucho mejor en el futuro. <br><br>  B√°sicamente hay dos tipos de marcos de prueba: <br><br><ol><li>  Marcos que no necesitan acceso al c√≥digo fuente y que no est√°n integrados como parte del proyecto.  Por ejemplo, <b>WebDriver, Appium, QTP</b> . </li><li>  Marcos que necesitan acceso al c√≥digo fuente.  Por ejemplo, <b>Espresso, KIF (Keep It Functional)</b> . </li></ol><br>  Espresso es un marco que necesita acceso al c√≥digo fuente, por lo que para la automatizaci√≥n necesitamos acceso al c√≥digo del proyecto.  Como necesitamos un proyecto para trabajar, ¬°cre√©moslo! <br><br><h3>  Componentes principales de espresso </h3><br>  Hay tres tipos de m√©todos disponibles en Espresso: <br><br><ol><li>  <b>ViewMatchers</b> : le permite encontrar un objeto en la jerarqu√≠a actual de vistas </li><li>  <b>ViewAssertions</b> : le permite verificar el estado del objeto y confirmar que el estado cumple con los criterios </li><li>  <b>ViewActions</b> : estos m√©todos le permiten realizar diversas acciones con objetos. </li></ol><br>  Profundicemos y veamos c√≥mo funciona todo con un ejemplo real. <br><br><h4>  Crea una aplicaci√≥n de automatizaci√≥n simple </h4><br>  Lo primero que debemos hacer es crear una aplicaci√≥n que automaticemos.  Creemos un proyecto en Android Studio.  Para esto, por supuesto, necesita Android Studio instalado en su computadora. <br><br>  <b>1. Abra Android Studio y cree una Actividad de navegaci√≥n inferior.</b> <br><br><img src="https://habrastorage.org/webt/xg/uo/n8/xguon8rdo7fubabo4t6v-l2r5o4.png"><br>  <i>Android Studio.</i>  <i>Crear nueva ventana de proyecto</i> <br><br>  <b>2. Asigne un nombre al proyecto y seleccione un lenguaje de programaci√≥n.</b> <br><br><img src="https://habrastorage.org/webt/uh/ua/lq/uhualqvx5pe7nd5qsrqfogx9z00.png"><br>  <i>Android Studio.</i>  <i>Nombre del proyecto</i> <br><br>  <b>3. Vaya a la carpeta androidTest</b> <br><br><img src="https://habrastorage.org/webt/ay/ha/j4/ayhaj4hexlnyhsfj4vhgiy5mkv0.png"><br>  <i>Android Studio.</i>  <i>Prueba instrumental</i> <br><br>  Como puede ver, solo se escribe una prueba all√≠, y esta no es una prueba de IU, sino una prueba JUnit. <br><br>  Ahora necesitamos agregar una prueba de interfaz de usuario simple.  Para hacer esto, primero cree una regla para abrir <i>MainActivity</i> . <br><br>  <b>Agreguemos</b> una importaci√≥n de anotaci√≥n de regla <b>JUnit</b> : <br><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.junit.Rule;</code> </pre> <br>  Lo siguiente que debe hacer es agregar la siguiente l√≠nea de c√≥digo para complementar la anotaci√≥n <b>RunWith</b> : <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">@Rule public ActivityTestRule&lt;MainActivity&gt; activityActivityTestRule = new ActivityTestRule&lt;&gt;(MainActivity.class);</span></span></code> </pre> <br><img src="https://habrastorage.org/webt/sp/qo/mv/spqomvmsf_qcyud5wvqhnkaautq.png"><br><br>  Ahora vemos que <b>ActivityTestRule est√°</b> resaltado en rojo.  Esto significa que necesitamos importar la funci√≥n <b>ActivityTestRule</b> .  Pero primero, necesitamos agregar una biblioteca que pueda hacer esto.  En pocas palabras, para esta tarea necesitamos la ayuda de <b>Gradle</b> , un sistema de automatizaci√≥n de ensamblaje creado espec√≠ficamente para este prop√≥sito. <br><br>  Vayamos al archivo de configuraci√≥n de <b>Gradle</b> y agreguemos esta biblioteca.  Abra un archivo llamado <b>build.gradle (M√≥dulo: aplicaci√≥n)</b> y agregue la siguiente l√≠nea: <br><br><pre> <code class="python hljs">androidTestImplementation <span class="hljs-string"><span class="hljs-string">'com.android.support.test:rules:1.0.2'</span></span></code> </pre> <br><img src="https://habrastorage.org/webt/u0/j0/db/u0j0dbsn9nfp0ch1kzc2ls1kg44.png"><br>  <i>Android Studio.</i>  <i>A√±adir dependencia.</i> <br><br>  Despu√©s de agregar, debe hacer clic en el bot√≥n para sincronizar el proyecto y luego regresar al archivo con la implementaci√≥n de prueba. <br><br>  Ahora que se ha agregado la biblioteca, el siguiente paso es importarla al archivo con la prueba instrumental: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> androidx.test.rule.ActivityTestRule;</code> </pre><br><img src="https://habrastorage.org/webt/y0/2n/in/y02ninubbghtx5-satkczvbchaa.png"><br>  <i>Android Studio.</i>  <i>Importar ActivityTestRule.</i> <br><br>  Ok, ahora estamos listos para agregar nuestra primera prueba.  Ingrese este c√≥digo en <b>ExampleInstrumentedTest</b> : <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">@Test public void clickButtonHome(){ onView(withId(R.id.navigation_home)).perform(click()).check(matches(isDisplayed())); }</span></span></code> </pre> <br><img src="https://habrastorage.org/webt/wx/mx/sc/wxmxscovvmszyncpeloi3adugzm.png"><br>  <i>Android Studio.</i>  <i>Agregar una prueba e importar elementos adicionales</i> <br><br>  Para nuestra prueba, necesitamos importar elementos adicionales antes de que comience a funcionar.  ¬°Haga clic en <b>el bot√≥n Aceptar</b> y, de hecho, estamos listos para lanzar nuestra prueba! <br><br><h3>  Ejecuci√≥n de pruebas de espresso </h3><br>  Haga clic derecho en nuestra prueba a la izquierda y seleccione <b>"Ejecutar ejemplo de prueba instrumentada"</b> . <br><br><img src="https://habrastorage.org/webt/wf/lt/kr/wfltkr-p33ettdkkjwyufp4gf0u.png"><br><br>  Dado que esta es una <b>prueba de IU</b> , no una prueba <b>unitaria</b> , veremos una ventana con una opci√≥n de dispositivo en el que nos gustar√≠a ejecutarla.  Ya tengo "Nexus 5X" como dispositivo, as√≠ que solo necesito seleccionarlo. <br><br><img src="https://habrastorage.org/webt/gu/ix/7r/guix7ri_bswxzv0jqytwa59lrr0.png"><br><br>  En su caso, si nunca ha implementado un proyecto de Android, seleccione su dispositivo Android real o haga clic en <b>"Crear nuevo dispositivo virtual"</b> y cree un nuevo dispositivo emulado para ejecutar las pruebas.  Este puede ser cualquier dispositivo de la lista en la que le gustar√≠a ejecutar pruebas. <br><br>  ¬°Haz clic en <b>Aceptar</b> y prep√°rate para ver la magia! <br><br><img src="https://habrastorage.org/webt/4r/b5/ad/4rb5adnhp7rbv4vr1ji9zuvpw68.png"><br>  <i>Android Studio.</i>  <i>Resultados de la prueba</i> <br><br>  Como puede ver, tenemos un conjunto de dos pruebas aprobadas: la prueba unitaria, que ya estaba all√≠ despu√©s de que se cre√≥ el proyecto, y nuestra prueba <i>clickHomeButton</i> , que acabamos de escribir. <br><br><img src="https://habrastorage.org/webt/9a/rr/we/9arrwejmr_cf7edvwh8uojyt5qu.png"><br>  <i>Android Studio.</i>  <i>La prueba completada.</i> <br><br>  Como su nombre lo indica, solo hicimos clic en un bot√≥n en la barra de navegaci√≥n inferior, que se llama <b>"navigation_home"</b> en la jerarqu√≠a <b>MainActivity</b> . <br><br>  Analicemos lo que hicimos en esta cadena de m√©todos: <br><br><pre> <code class="python hljs">public void clickButtonHome(){ onView(withId(R.id.navigation_home)).perform(click()).check(matches(isDisplayed())); }</code> </pre> <br><ol><li>  1. Llame a <b>onView</b> .  Este m√©todo es un m√©todo de tipo <b>ViewMatchers</b> .  Encontramos un objeto en nuestra Actividad para hacer algo. </li><li>  2. A continuaci√≥n, llamamos a <b>realizar (clic ())</b> .  Este m√©todo es un m√©todo de tipo <b>ViewActions</b> .  Indicamos la acci√≥n espec√≠fica que debe realizarse en este caso: hacer un clic (clic).  Hay muchos m√°s m√©todos de acci√≥n disponibles en Espresso, por ejemplo: </li><li>  3. Lo √∫ltimo que debemos hacer es confirmar que la acci√≥n que realizamos realmente coincide con nuestros criterios, y para esto ejecutamos el m√©todo <b>check (isDisplayed ())</b> , que es un m√©todo de tipo <b>ViewAssertions</b> .  En este caso, verificamos que este objeto (vista) se haya mostrado en la pantalla despu√©s de que se realiz√≥ la acci√≥n de hacer clic. </li></ol><br><h3>  Jerarqu√≠a de vista de Android </h3><br>  Estimado lector, espero haber podido explicarle c√≥mo escribir <b>pruebas</b> b√°sicas de <b>IU para Android</b> con Espresso. <br><br>  Sin embargo, probablemente no sea tan simple entender qu√© sucedi√≥ exactamente aqu√≠ si no sabe d√≥nde se encuentran todos estos botones y de d√≥nde provienen.  Para averiguarlo, debemos ir a la carpeta <b>"res"</b> en el lado izquierdo, abrir la carpeta <b>"men√∫"</b> y seleccionar <b>"bottom_nav_menu.xml"</b> . <br>  Esto es lo que veremos all√≠: <br><br><img src="https://habrastorage.org/webt/yc/fe/a8/ycfea8uzwehgirzskb2cn8ysszc.png"><br>  <i>Android Studio.</i>  <i>Jerarqu√≠a de presentaci√≥n del men√∫ de navegaci√≥n inferior.</i> <br>  Como puede ver, esta es la l√≠nea que asigna un nombre al elemento del men√∫: <br><br><pre> <code class="plaintext hljs">android:id="@+id/navigation_home"</code> </pre> <br>  Eso es lo que usamos en nuestro c√≥digo para ejecutar las pruebas.  Tambi√©n hay botones de men√∫ <b>"navigation_dashboard"</b> y <b>"navigation_notifications"</b> , disponibles en la parte inferior, as√≠ que continuemos y us√©moslos en nuestras pruebas. <br><br><h3>  M√°s pruebas de espresso </h3><br>  Necesitamos volver al archivo <b>ExampleInstrumentedTest</b> y agregar un par de funciones de prueba m√°s: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">@Test public void clickButtonDashboard(){ onView(withId(R.id.navigation_dashboard)).perform(click()).check(matches(isDisplayed())); } @Test public void clickButtonNotification(){ onView(withId(R.id.navigation_notifications)).perform(click()).check(matches(isDisplayed())); }</span></span></code> </pre> <br>  Lo √∫nico que agregamos fue verificar varios elementos m√°s del men√∫: <b>"navigation_dashboard"</b> y <b>"navigation_notifications"</b> . <br><br><img src="https://habrastorage.org/webt/e9/0o/zf/e90ozfefjwmrpzurm8i0958jllk.png"><br>  <i>Android Studio.</i>  <i>Agrega dos pruebas m√°s.</i> <br><br>  Por supuesto, estas pruebas podr√≠an simplificarse a√∫n m√°s, pero para mostrar c√≥mo funciona todo esto, supongamos que son perfectamente adecuadas para nuestros prop√≥sitos. <br><br>  Continuemos y ejecutemos estas pruebas nuevamente.  Haz clic en <b>el</b> bot√≥n <b>Ejecutar</b> . <br><br><img src="https://habrastorage.org/webt/2s/nm/19/2snm19yru3-sthnx3rs9q6v24oc.png"><br>  <i>Android Studio.</i>  <i>Resultados de la prueba</i> <br><br>  Las 4 pruebas pasaron.  Todas las vistas se encontraron, se hicieron clic y se confirmaron en la jerarqu√≠a de vistas. <br><br><h3>  Conclusi√≥n </h3><br>  Espresso es una soluci√≥n poderosa para ejecutar pruebas de IU.  Ahora que sabe c√≥mo se crean, est√° listo para escribir pruebas mucho m√°s potentes y complejas. <br><br>  Que tengas una buena prueba! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/472372/">https://habr.com/ru/post/472372/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../472360/index.html">Escaneando el c√≥digo de Orchard CMS en busca de errores</a></li>
<li><a href="../472362/index.html">Buscamos y analizamos errores en el c√≥digo Orchard CMS</a></li>
<li><a href="../472364/index.html">PostgreSQL y configuraci√≥n de consistencia de registro para cada conexi√≥n particular</a></li>
<li><a href="../472366/index.html">Nuevo algoritmo de Path Finder en Factorio</a></li>
<li><a href="../472368/index.html">Speech fishing: analizamos los m√©todos de ataque y los m√©todos de protecci√≥n contra ellos.</a></li>
<li><a href="../472374/index.html">¬øPor qu√© mudamos servidores a Islandia?</a></li>
<li><a href="../472378/index.html">Fiabilidad de flash: esperada e inesperada. Parte 2. XIV conferencia de la asociaci√≥n USENIX. Tecnolog√≠as de almacenamiento de archivos</a></li>
<li><a href="../472380/index.html">MIRO: una plataforma robotizada de interior abierta</a></li>
<li><a href="../472384/index.html">Una mirada a las actualizaciones de Android desde la perspectiva de un desarrollador</a></li>
<li><a href="../472386/index.html">ZIO y Efecto Gatos: una alianza exitosa</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>