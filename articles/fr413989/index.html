<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👱 🐏 📯 Le livre «Hacking: The Art of Exploit. 2e éd. " 👨🏿‍🎓 👦🏼 📰</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Chaque programmeur est essentiellement un hacker. Après tout, le piratage s'appelait initialement la recherche d'une solution habile et non évidente. ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Le livre «Hacking: The Art of Exploit. 2e éd. "</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/piter/blog/413989/"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/v1/y_/wo/v1y_wo0l3qbzeakw1hmembve6lk.jpeg" align="left" alt="image"></a>  Chaque programmeur est essentiellement un hacker.  Après tout, le piratage s'appelait initialement la recherche d'une solution habile et non évidente.  La compréhension de la programmation vous aide à trouver les vulnérabilités et les compétences de détection des vulnérabilités vous aident à créer des programmes, de nombreux pirates font les deux en même temps.  Il existe des mouvements non standard intéressants à la fois dans les techniques d'écriture de programmes élégants et dans les techniques de recherche de points faibles. <br><br>  Par où commencer?  Pour écraser la mémoire à l'aide de débordements de tampon, accéder à un serveur distant et intercepter les connexions, vous devez programmer en C et assembleur, utiliser le code shell et les registres de processeur, vous familiariser avec les interactions réseau et le cryptage, et bien plus encore. <br><br>  Peu importe à quel point nous voulons croire aux miracles, les logiciels et les réseaux informatiques dont dépendent notre vie quotidienne présentent des vulnérabilités. <br><br>  Un monde sans hackers est un monde sans curiosité et sans solutions innovantes.  (John Erickson) <br><a name="habracut"></a><br><h3>  <b>Contre-mesures</b> </h3><br>  Il y a une telle grenouille - une terrible listolaz (Phyllobates terribilis).  Ses glandes cutanées contiennent le poison le plus puissant.  Il suffit de le toucher pour obtenir un empoisonnement fatal.  Un remède aussi puissant s'explique par le fait que ces grenouilles se nourrissent de certains types de serpents qui ont développé une immunité au poison.  Progressivement, le poison des grenouilles est devenu de plus en plus fort.  À la suite d'une telle évolution conjointe, les terribles grimpeurs de feuilles n'ont plus d'autres ennemis naturels.  Quelque chose de similaire se produit avec les pirates.  Les techniques qu'ils ont inventées sont connues depuis longtemps, donc l'émergence de contre-mesures est assez naturelle.  En réponse, les pirates cherchent des moyens de contourner et de détruire les mécanismes de défense, ce qui conduit à la création de nouvelles techniques défensives. <br><br>  Ce cycle de recherche de mesures et de contre-mesures est très utile.  Les virus et les vers deviennent la cause de nombreux problèmes et entraînent de lourdes pertes pour les entreprises, mais en même temps, ils forcent les développeurs à prendre des mesures de rétorsion pour résoudre les problèmes qui sont survenus.  Les vers s'auto-répliquent à l'aide de vulnérabilités logicielles de faible qualité.  Les erreurs passent souvent inaperçues au fil des ans, et des vers relativement inoffensifs tels que CodeRed ou Sasser forcent les développeurs à les corriger.  Ce processus peut être comparé à la varicelle, qui est préférable pour tomber malade dans l'enfance, et non à l'âge adulte, lorsqu'elle peut entraîner des conséquences désastreuses.  Si les vers Internet n'avaient pas attiré l'attention universelle sur les failles de sécurité, ces failles resteraient ouvertes à des attaques à des fins bien plus malveillantes que la simple auto-reproduction.  De cette façon, les vers et les virus contribuent à la sécurité à long terme.  Mais il existe des méthodes plus actives: des techniques qui tentent d'annuler les résultats d'une attaque ou de la rendre complètement impossible.  Le concept de «contre-mesures» est assez vague, ces mots peuvent signifier des moyens techniques de sécurité, un ensemble de règles, un programme ou tout simplement un administrateur système attentif.  Les contre-mesures sont conditionnellement divisées en deux groupes: essayer de détecter une attaque et essayer de protéger la vulnérabilité. <br><br><h3>  Outil de détection d'attaque 0x610 </h3><br>  Les contre-mesures du premier groupe se résument à des tentatives de remarquer l'intrusion dans le temps et d'y réagir d'une manière ou d'une autre.  Le processus de reconnaissance peut être mis en œuvre de n'importe quelle manière - de l'administrateur lisant les journaux système aux programmes analysant le trafic réseau.  Parfois, la réaction à une invasion revient à déconnecter automatiquement la connexion ou à fermer le processus, et parfois l'administrateur doit étudier attentivement tout le contenu de la console. <br><br>  Les méthodes connues d'exploitation des vulnérabilités ne sont pas aussi dangereuses pour l'administrateur système que celles qu'il ne connaît pas encore.  Plus tôt une intrusion peut être détectée, plus le travail commencera tôt et plus elle sera localisée.  Une intrusion ignorée depuis des mois est un grave sujet de préoccupation. <br><br>  Pour reconnaître l'intrusion, vous devez anticiper ce que l'attaquant va faire.  Cela fournit des informations sur ce qui doit être surveillé exactement.  Les détecteurs recherchent des modèles d'attaque familiers dans les journaux, les paquets réseau et même dans la mémoire du programme.  Lorsqu'une intrusion est détectée, vous pouvez priver le pirate de l'accès à la machine, restaurer le système de fichiers endommagé à l'aide d'une sauvegarde et identifier et corriger le trou de sécurité.  Avec les capacités de sauvegarde et de restauration disponibles aujourd'hui, les contre-mesures qui se réduisent à la détection des attaques sont assez efficaces. <br><br>  Pour un attaquant, la détection signifie contrer tout ce qu'il fait.  Bien sûr, il est loin d'être toujours possible de remarquer immédiatement une attaque, il existe donc un certain nombre de scénarios «grab and run» dans lesquels le fait de la détection n'est pas important, mais même dans ces cas, il vaut mieux ne pas laisser de traces.  Le secret est l'une des qualités les plus précieuses des pirates.  L'accès au shell de commandes avec des droits d'administrateur en exploitant les vulnérabilités permet de faire quoi que ce soit sur le système, et si vous parvenez à éviter la détection, personne ne sera au courant de votre présence.  C'est la combinaison de la permissivité et de l'invisibilité qui rend les pirates informatiques dangereux.  Ils peuvent facilement intercepter les mots de passe et les données sur le réseau, ajouter des signets aux programmes pour un accès non autorisé ultérieur et attaquer d'autres nœuds du réseau.  Pour rester dans l'ombre, le pirate doit comprendre quelles méthodes de reconnaissance sont utilisées dans un cas particulier.  Si vous savez exactement ce qu'ils recherchent, vous pouvez éviter certains modèles d'exploitation de la vulnérabilité ou masquer vos actions comme valides.  Le facteur moteur du cycle d'évolution conjointe des outils et des techniques de détection qui permettent de passer inaperçu sont des idées qui ne sont pas encore apparues de l'autre côté. <br><br><h3>  Démons système 0x620 </h3><br>  Cependant, les contre-mesures contre les pirates et leurs solutions de contournement sont mieux discutées à l'aide d'un exemple pratique.  Nous allons maintenant considérer une attaque contre un programme serveur qui accepte les connexions entrantes.  Sur les systèmes d'exploitation de type UNIX, les démons système conviennent à ces critères.  Un démon est un programme fonctionnant en arrière-plan et d'une certaine manière séparé du terminal de contrôle.  Le terme a été inventé dans les années 1960 par des pirates du Massachusetts Institute of Technology.  Le prototype était une créature mythique triant les molécules d'une expérience mentale du physicien James Maxwell.  Le démon Maxwell possédait une capacité surnaturelle pour effectuer facilement des tâches complexes, violant la deuxième loi de la thermodynamique.  De même, les démons système Linux exécutent inlassablement des tâches telles que l'octroi de l'accès à SSH et la maintenance des journaux système.  Les noms de démon se terminent généralement par d, ce qui souligne leur nature: par exemple, sshd ou syslogd. <br><br>  Une petite modification transformera tinyweb.c de la section 0x427 en une ressemblance réaliste avec un démon système.  La nouvelle version du code contient la fonction daemon (), qui engendre un nouveau processus d'arrière-plan.  Il est utilisé par de nombreux processus de démon système Linux.  Voici la page qui lui est dédiée dans l'annuaire: <br><br>  DAEMON (3) Référence du programmeur Linux DAEMON (3) <br><br>  NOM <br>  démon - exécuté en arrière-plan <br>  Syntaxe <br><br><pre><code class="hljs vbscript">#include &lt;unistd.h&gt; <span class="hljs-built_in"><span class="hljs-built_in">int</span></span> daemon(<span class="hljs-built_in"><span class="hljs-built_in">int</span></span> nochdir, <span class="hljs-built_in"><span class="hljs-built_in">int</span></span> noclose);</code> </pre> <br>  DESCRIPTION <br><br>  La fonction daemon () déconnecte le programme du terminal de commande et démarre <br>  elle en arrière-plan en tant que démon système. <br>  Avec un argument différent de zéro, nochdir, daemon () change le répertoire de travail courant <br>  à la racine ("/"). <br>  Avec nullose, la fonction daemon () redirige les threads <br>  entrée standard, sortie standard et erreurs dans / dev / null. <br>  VALEUR DE RETOUR <br><br>  (Cette fonction génère une copie du processus, et si fork () réussit <br>  le parent exécute _exit (0) de sorte que d'autres erreurs ne soient visibles que <br>  processus enfant.) En cas de succès, renvoie zéro.  En cas d'erreur, la fonction <br>  daemon () renvoie -1 et assigne le numéro d'erreur à la variable globale errno <br>  à partir de la bibliothèque de fonctions fork (2) et setsid (2). <br><br>  Les démons système n'ont pas de terminal de contrôle, donc le code du nouveau démon tinywebd sera affiché dans le journal de bord.  Les démons sont généralement contrôlés par des signaux.  La nouvelle version de tinyweb devrait pouvoir recevoir un signal d'achèvement afin de sortir correctement. <br><br><h3>  Présentation du signal 0x621 </h3><br>  Les signaux fournissent une communication interprocessus sous UNIX.  Une fois qu'un signal est reçu par un processus, le système d'exploitation interrompt son exécution pour appeler le gestionnaire de signaux.  Chaque signal a son propre numéro et son propre gestionnaire.  Par exemple, lorsque vous appuyez sur la combinaison de touches Ctrl + C, un signal d'interruption est envoyé, dont le gestionnaire termine le programme ouvert sur le terminal de commande, même s'il est entré dans une boucle infinie. <br><br>  Vous pouvez créer vos propres gestionnaires de signaux et les enregistrer à l'aide de la fonction signal ().  Regardons un code dans lequel plusieurs gestionnaires sont enregistrés pour certains signaux, et dans la partie principale il y a une boucle infinie. <br><br><pre> <code class="hljs smalltalk">signal_example.c <span class="hljs-symbol"><span class="hljs-symbol">#include</span></span> &lt;stdio.h&gt; <span class="hljs-symbol"><span class="hljs-symbol">#include</span></span> &lt;stdlib.h&gt; <span class="hljs-symbol"><span class="hljs-symbol">#include</span></span> &lt;signal.h&gt; /*    signal.h * <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">SIGHUP</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>  * <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">SIGINT</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>  (<span class="hljs-type"><span class="hljs-type">Ctrl</span></span>+<span class="hljs-type"><span class="hljs-type">C</span></span>) * <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">SIGQUIT</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span>  (<span class="hljs-type"><span class="hljs-type">Ctrl</span></span>+\) * <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">SIGILL</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span>   * <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">SIGTRAP</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span>   * <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">SIGABRT</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span>  * <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">SIGBUS</span></span> <span class="hljs-number"><span class="hljs-number">7</span></span>   * <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">SIGFPE</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span>     * <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">SIGKILL</span></span> <span class="hljs-number"><span class="hljs-number">9</span></span>   * <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">SIGUSR1</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span>   <span class="hljs-number"><span class="hljs-number">1</span></span> * <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">SIGSEGV</span></span> <span class="hljs-number"><span class="hljs-number">11</span></span>   * <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">SIGUSR2</span></span> <span class="hljs-number"><span class="hljs-number">12</span></span>   <span class="hljs-number"><span class="hljs-number">2</span></span> * <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">SIGPIPE</span></span> <span class="hljs-number"><span class="hljs-number">13</span></span>    ,    * <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">SIGALRM</span></span> <span class="hljs-number"><span class="hljs-number">14</span></span>   ,  alarm() * <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">SIGTERM</span></span> <span class="hljs-number"><span class="hljs-number">15</span></span>  (  kill) * <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">SIGCHLD</span></span> <span class="hljs-number"><span class="hljs-number">17</span></span>    * <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">SIGCONT</span></span> <span class="hljs-number"><span class="hljs-number">18</span></span> ,    * <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">SIGSTOP</span></span> <span class="hljs-number"><span class="hljs-number">19</span></span>  (  ) * <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">SIGTSTP</span></span> <span class="hljs-number"><span class="hljs-number">20</span></span>   [] (<span class="hljs-type"><span class="hljs-type">Ctrl</span></span>+<span class="hljs-type"><span class="hljs-type">Z</span></span>) * <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">SIGTTIN</span></span> <span class="hljs-number"><span class="hljs-number">21</span></span>       * <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">SIGTTOU</span></span> <span class="hljs-number"><span class="hljs-number">22</span></span>       */ /*   */ void signal_handler(int signal) { printf(<span class="hljs-comment"><span class="hljs-comment">"  %d\t"</span></span>, signal); if (signal == <span class="hljs-type"><span class="hljs-type">SIGTSTP</span></span>) printf(<span class="hljs-comment"><span class="hljs-comment">"SIGTSTP (Ctrl-Z)"</span></span>); else if (signal == <span class="hljs-type"><span class="hljs-type">SIGQUIT</span></span>) printf(<span class="hljs-comment"><span class="hljs-comment">"SIGQUIT (Ctrl-\\)"</span></span>); else if (signal == <span class="hljs-type"><span class="hljs-type">SIGUSR1</span></span>) printf(<span class="hljs-comment"><span class="hljs-comment">"SIGUSR1"</span></span>); else if (signal == <span class="hljs-type"><span class="hljs-type">SIGUSR2</span></span>) printf(<span class="hljs-comment"><span class="hljs-comment">"SIGUSR2"</span></span>); printf(<span class="hljs-comment"><span class="hljs-comment">"\n"</span></span>); } void sigint_handler(int x) { printf(<span class="hljs-comment"><span class="hljs-comment">" Ctrl-C (SIGINT)   \nExiting.\n"</span></span>); exit(<span class="hljs-number"><span class="hljs-number">0</span></span>); } int main() { /* <span class="hljs-type"><span class="hljs-type">Registering</span></span> signal handlers */ signal(<span class="hljs-type"><span class="hljs-type">SIGQUIT</span></span>, signal_handler); //  signal_handler() signal(<span class="hljs-type"><span class="hljs-type">SIGTSTP</span></span>, signal_handler); //    signal(<span class="hljs-type"><span class="hljs-type">SIGUSR1</span></span>, signal_handler); signal(<span class="hljs-type"><span class="hljs-type">SIGUSR2</span></span>, signal_handler); signal(<span class="hljs-type"><span class="hljs-type">SIGINT</span></span>, sigint_handler); //  sigint_handler()  <span class="hljs-type"><span class="hljs-type">SIGINT</span></span> while(<span class="hljs-number"><span class="hljs-number">1</span></span>) {} //   }</code> </pre> <br>  Lorsqu'un programme compilé est exécuté, les gestionnaires de signaux sont enregistrés, puis le programme entre dans une boucle sans fin.  Mais, malgré cela, les signaux entrants interrompent son exécution et se tournent vers les gestionnaires enregistrés.  Voici des exemples d'application de signaux pouvant être activés à partir du terminal de commande.  Une fois la fonction signal_handler () terminée, le contrôle retourne à la boucle interrompue, tandis que la fonction sigint_handler () termine le programme. <br><br><pre> <code class="hljs ruby">reader@hacking<span class="hljs-symbol"><span class="hljs-symbol">:~/booksrc</span></span> $ gcc -o signal_example signal_example.c reader@hacking<span class="hljs-symbol"><span class="hljs-symbol">:~/booksrc</span></span> $ ./signal_example   <span class="hljs-number"><span class="hljs-number">20</span></span> SIGTSTP (Ctrl-Z)   <span class="hljs-number"><span class="hljs-number">3</span></span> SIGQUIT (Ctrl-\)  Ctrl-C (SIGINT)    Exiting. reader@hacking<span class="hljs-symbol"><span class="hljs-symbol">:~/booksrc</span></span> $</code> </pre> <br>  La commande kill vous permet d'envoyer un ensemble complet de signaux à un processus.  Par défaut, il envoie un signal d'achèvement (SIGTERM).  L'ajout de l'option -l affiche une liste de tous les signaux possibles.  Voyons comment le programme signal_example exécuté sur un autre terminal envoie les signaux SIGUSR1 et SIGUSR2. <br><br><pre> <code class="hljs powershell">reader@hacking:~/booksrc <span class="hljs-variable"><span class="hljs-variable">$</span></span> kill <span class="hljs-literal"><span class="hljs-literal">-l</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>) SIGHUP       <span class="hljs-number"><span class="hljs-number">2</span></span>) SIGINT       <span class="hljs-number"><span class="hljs-number">3</span></span>) SIGQUIT      <span class="hljs-number"><span class="hljs-number">4</span></span>) SIGILL <span class="hljs-number"><span class="hljs-number">5</span></span>) SIGTRAP      <span class="hljs-number"><span class="hljs-number">6</span></span>) SIGABRT      <span class="hljs-number"><span class="hljs-number">7</span></span>) SIGBUS       <span class="hljs-number"><span class="hljs-number">8</span></span>) SIGFPE <span class="hljs-number"><span class="hljs-number">9</span></span>) SIGKILL     <span class="hljs-number"><span class="hljs-number">10</span></span>) SIGUSR1     <span class="hljs-number"><span class="hljs-number">11</span></span>) SIGSEGV     <span class="hljs-number"><span class="hljs-number">12</span></span>) SIGUSR2 <span class="hljs-number"><span class="hljs-number">13</span></span>) SIGPIPE     <span class="hljs-number"><span class="hljs-number">14</span></span>) SIGALRM     <span class="hljs-number"><span class="hljs-number">15</span></span>) SIGTERM     <span class="hljs-number"><span class="hljs-number">16</span></span>) SIGSTKFLT <span class="hljs-number"><span class="hljs-number">17</span></span>) SIGCHLD     <span class="hljs-number"><span class="hljs-number">18</span></span>) SIGCONT     <span class="hljs-number"><span class="hljs-number">19</span></span>) SIGSTOP     <span class="hljs-number"><span class="hljs-number">20</span></span>) SIGTSTP <span class="hljs-number"><span class="hljs-number">21</span></span>) SIGTTIN     <span class="hljs-number"><span class="hljs-number">22</span></span>) SIGTTOU     <span class="hljs-number"><span class="hljs-number">23</span></span>) SIGURG      <span class="hljs-number"><span class="hljs-number">24</span></span>) SIGXCPU <span class="hljs-number"><span class="hljs-number">25</span></span>) SIGXFSZ     <span class="hljs-number"><span class="hljs-number">26</span></span>) SIGVTALRM   <span class="hljs-number"><span class="hljs-number">27</span></span>) SIGPROF     <span class="hljs-number"><span class="hljs-number">28</span></span>) SIGWINCH <span class="hljs-number"><span class="hljs-number">29</span></span>) SIGIO       <span class="hljs-number"><span class="hljs-number">30</span></span>) SIGPWR      <span class="hljs-number"><span class="hljs-number">31</span></span>) SIGSYS      <span class="hljs-number"><span class="hljs-number">34</span></span>) SIGRTMIN <span class="hljs-number"><span class="hljs-number">35</span></span>) SIGRTMIN+<span class="hljs-number"><span class="hljs-number">1</span></span>  <span class="hljs-number"><span class="hljs-number">36</span></span>) SIGRTMIN+<span class="hljs-number"><span class="hljs-number">2</span></span>  <span class="hljs-number"><span class="hljs-number">37</span></span>) SIGRTMIN+<span class="hljs-number"><span class="hljs-number">3</span></span>  <span class="hljs-number"><span class="hljs-number">38</span></span>) SIGRTMIN+<span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">39</span></span>) SIGRTMIN+<span class="hljs-number"><span class="hljs-number">5</span></span>  <span class="hljs-number"><span class="hljs-number">40</span></span>) SIGRTMIN+<span class="hljs-number"><span class="hljs-number">6</span></span>  <span class="hljs-number"><span class="hljs-number">41</span></span>) SIGRTMIN+<span class="hljs-number"><span class="hljs-number">7</span></span>  <span class="hljs-number"><span class="hljs-number">42</span></span>) SIGRTMIN+<span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-number"><span class="hljs-number">43</span></span>) SIGRTMIN+<span class="hljs-number"><span class="hljs-number">9</span></span>  <span class="hljs-number"><span class="hljs-number">44</span></span>) SIGRTMIN+<span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-number"><span class="hljs-number">45</span></span>) SIGRTMIN+<span class="hljs-number"><span class="hljs-number">11</span></span> <span class="hljs-number"><span class="hljs-number">46</span></span>) SIGRTMIN+<span class="hljs-number"><span class="hljs-number">12</span></span> <span class="hljs-number"><span class="hljs-number">47</span></span>) SIGRTMIN+<span class="hljs-number"><span class="hljs-number">13</span></span> <span class="hljs-number"><span class="hljs-number">48</span></span>) SIGRTMIN+<span class="hljs-number"><span class="hljs-number">14</span></span> <span class="hljs-number"><span class="hljs-number">49</span></span>) SIGRTMIN+<span class="hljs-number"><span class="hljs-number">15</span></span> <span class="hljs-number"><span class="hljs-number">50</span></span>) SIGRTMAX<span class="hljs-literal"><span class="hljs-literal">-14</span></span> <span class="hljs-number"><span class="hljs-number">51</span></span>) SIGRTMAX<span class="hljs-literal"><span class="hljs-literal">-13</span></span> <span class="hljs-number"><span class="hljs-number">52</span></span>) SIGRTMAX<span class="hljs-literal"><span class="hljs-literal">-12</span></span> <span class="hljs-number"><span class="hljs-number">53</span></span>) SIGRTMAX<span class="hljs-literal"><span class="hljs-literal">-11</span></span> <span class="hljs-number"><span class="hljs-number">54</span></span>) SIGRTMAX<span class="hljs-literal"><span class="hljs-literal">-10</span></span> <span class="hljs-number"><span class="hljs-number">55</span></span>) SIGRTMAX<span class="hljs-literal"><span class="hljs-literal">-9</span></span>  <span class="hljs-number"><span class="hljs-number">56</span></span>) SIGRTMAX<span class="hljs-literal"><span class="hljs-literal">-8</span></span>  <span class="hljs-number"><span class="hljs-number">57</span></span>) SIGRTMAX<span class="hljs-literal"><span class="hljs-literal">-7</span></span>  <span class="hljs-number"><span class="hljs-number">58</span></span>) SIGRTMAX<span class="hljs-literal"><span class="hljs-literal">-6</span></span> <span class="hljs-number"><span class="hljs-number">59</span></span>) SIGRTMAX<span class="hljs-literal"><span class="hljs-literal">-5</span></span>  <span class="hljs-number"><span class="hljs-number">60</span></span>) SIGRTMAX<span class="hljs-literal"><span class="hljs-literal">-4</span></span>  <span class="hljs-number"><span class="hljs-number">61</span></span>) SIGRTMAX<span class="hljs-literal"><span class="hljs-literal">-3</span></span>  <span class="hljs-number"><span class="hljs-number">62</span></span>) SIGRTMAX<span class="hljs-literal"><span class="hljs-literal">-2</span></span> <span class="hljs-number"><span class="hljs-number">63</span></span>) SIGRTMAX<span class="hljs-literal"><span class="hljs-literal">-1</span></span>  <span class="hljs-number"><span class="hljs-number">64</span></span>) SIGRTMAX reader@hacking:~/booksrc <span class="hljs-variable"><span class="hljs-variable">$</span></span> ps a | grep signal_example <span class="hljs-number"><span class="hljs-number">24491</span></span> pts/<span class="hljs-number"><span class="hljs-number">3</span></span>    R+     <span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">17</span></span> ./signal_example <span class="hljs-number"><span class="hljs-number">24512</span></span> pts/<span class="hljs-number"><span class="hljs-number">1</span></span>    S+     <span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span> grep signal_example reader@hacking:~/booksrc <span class="hljs-variable"><span class="hljs-variable">$</span></span> kill <span class="hljs-literal"><span class="hljs-literal">-10</span></span> <span class="hljs-number"><span class="hljs-number">24491</span></span> reader@hacking:~/booksrc <span class="hljs-variable"><span class="hljs-variable">$</span></span> kill <span class="hljs-literal"><span class="hljs-literal">-12</span></span> <span class="hljs-number"><span class="hljs-number">24491</span></span> reader@hacking:~/booksrc <span class="hljs-variable"><span class="hljs-variable">$</span></span> kill <span class="hljs-literal"><span class="hljs-literal">-9</span></span> <span class="hljs-number"><span class="hljs-number">24491</span></span> reader@hacking:~/booksrc <span class="hljs-variable"><span class="hljs-variable">$</span></span></code> </pre> <br>  À la fin, la commande kill -9 envoie un signal SIGKILL.  Le gestionnaire de signaux ne peut pas être modifié, donc la commande kill -9 est toujours utilisée pour tuer les processus.  Le programme signal_example lancé sur un autre terminal montre que les signaux ont été interceptés et que le processus a été détruit. <br><br><pre> <code class="hljs ruby">reader@hacking<span class="hljs-symbol"><span class="hljs-symbol">:~/booksrc</span></span> $ ./signal_example   <span class="hljs-number"><span class="hljs-number">10</span></span>       SIGUSR1   <span class="hljs-number"><span class="hljs-number">12</span></span>       SIGUSR2 Killed reader@hacking<span class="hljs-symbol"><span class="hljs-symbol">:~/booksrc</span></span> $</code> </pre> <br>  Les signaux eux-mêmes sont très simples, mais l'interaction entre les processus peut rapidement se transformer en un réseau complexe de dépendances.  Heureusement, dans notre démon tinyweb, les signaux sont utilisés uniquement pour l'arrêt correct, et tout est mis en œuvre très simplement. <br><br><h3>  Démon Tinyweb 0x622 </h3><br>  La nouvelle version de tinywebd est un démon système lancé en arrière-plan sans terminal de contrôle.  Les données de sortie sont écrites dans le journal de bord avec des horodatages et le programme lui-même attend que le signal SIGTERM termine correctement le travail. <br><br>  Les modifications apportées à l'original ne sont pas très importantes, mais elles permettent une étude plus réaliste du processus d'exploitation de la vulnérabilité.  Les nouveaux fragments de code sont en gras. <br><br><pre> <code class="hljs pgsql">tinywebd.c #<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> &lt;sys/stat.h&gt; #<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> &lt;sys/socket.h&gt; #<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> &lt;netinet/<span class="hljs-keyword"><span class="hljs-keyword">in</span></span>.h&gt; #<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> &lt;arpa/<span class="hljs-type"><span class="hljs-type">inet</span></span>.h&gt; #<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> &lt;sys/<span class="hljs-keyword"><span class="hljs-keyword">types</span></span>.h&gt; #<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> &lt;sys/stat.h&gt; #<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> &lt;fcntl.h&gt; #<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> &lt;<span class="hljs-type"><span class="hljs-type">time</span></span>.h&gt; #<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> &lt;signal.h&gt; #<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> "hacking.h" #<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> "hacking-network.h" #define PORT <span class="hljs-number"><span class="hljs-number">80</span></span> // ,     #define WEBROOT "./webroot" //   - #define LOGFILE "/var/log/tinywebd.log" //    <span class="hljs-type"><span class="hljs-type">int</span></span> logfd, sockfd; //       <span class="hljs-type"><span class="hljs-type">void</span></span> handle_connection(<span class="hljs-type"><span class="hljs-type">int</span></span>, struct sockaddr_in *, <span class="hljs-type"><span class="hljs-type">int</span></span>); <span class="hljs-type"><span class="hljs-type">int</span></span> get_file_size(<span class="hljs-type"><span class="hljs-type">int</span></span>); //         //  <span class="hljs-type"><span class="hljs-type">void</span></span> <span class="hljs-type"><span class="hljs-type">timestamp</span></span>(<span class="hljs-type"><span class="hljs-type">int</span></span>); //        //       <span class="hljs-type"><span class="hljs-type">void</span></span> handle_shutdown(<span class="hljs-type"><span class="hljs-type">int</span></span> signal) { <span class="hljs-type"><span class="hljs-type">timestamp</span></span>(logfd); <span class="hljs-keyword"><span class="hljs-keyword">write</span></span>(logfd, " .\n", <span class="hljs-number"><span class="hljs-number">16</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">close</span></span>(logfd); <span class="hljs-keyword"><span class="hljs-keyword">close</span></span>(sockfd); <span class="hljs-keyword"><span class="hljs-keyword">exit</span></span>(<span class="hljs-number"><span class="hljs-number">0</span></span>); } <span class="hljs-type"><span class="hljs-type">int</span></span> main(<span class="hljs-type"><span class="hljs-type">void</span></span>) { <span class="hljs-type"><span class="hljs-type">int</span></span> new_sockfd, yes=<span class="hljs-number"><span class="hljs-number">1</span></span>; struct sockaddr_in host_addr, client_addr; //    socklen_t sin_size; logfd = <span class="hljs-keyword"><span class="hljs-keyword">open</span></span>(LOGFILE, O_WRONLY|O_CREAT|O_APPEND, S_IRUSR|S_IWUSR); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(logfd == <span class="hljs-number"><span class="hljs-number">-1</span></span>) fatal("  ");  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((sockfd = socket(PF_INET, SOCK_STREAM, <span class="hljs-number"><span class="hljs-number">0</span></span>)) == <span class="hljs-number"><span class="hljs-number">-1</span></span>)        fatal(" "); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (setsockopt(sockfd, SOL_SOCKET, SO_REUSEADDR, &amp;yes, sizeof(<span class="hljs-type"><span class="hljs-type">int</span></span>)) == <span class="hljs-number"><span class="hljs-number">-1</span></span>) fatal("   SO_REUSEADDR"); printf("  tiny web.\n"); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(daemon(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) == <span class="hljs-number"><span class="hljs-number">-1</span></span>) //    fatal("   "); signal(SIGTERM, handle_shutdown);   //    handle_shutdown signal(SIGINT, handle_shutdown);   //    handle_shutdown <span class="hljs-type"><span class="hljs-type">timestamp</span></span>(logfd); <span class="hljs-keyword"><span class="hljs-keyword">write</span></span>(logfd, ".\n", <span class="hljs-number"><span class="hljs-number">15</span></span>); host_addr.sin_family = AF_INET;       //    host_addr.sin_port = htons(PORT);     //  ,    host_addr.sin_addr.s_addr = INADDR_ANY; //    IP memset(&amp;(host_addr.sin_zero), <span class="hljs-string"><span class="hljs-string">'\0'</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>); //    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (bind(sockfd, (struct sockaddr *)&amp;host_addr, sizeof(struct sockaddr)) == <span class="hljs-number"><span class="hljs-number">-1</span></span>) fatal("  "); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">listen</span></span>(sockfd, <span class="hljs-number"><span class="hljs-number">20</span></span>) == <span class="hljs-number"><span class="hljs-number">-1</span></span>) fatal("   "); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(<span class="hljs-number"><span class="hljs-number">1</span></span>) { //   accept sin_size = sizeof(struct sockaddr_in); new_sockfd = accept(sockfd, (struct sockaddr *)&amp;client_addr, &amp;sin_size); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(new_sockfd == <span class="hljs-number"><span class="hljs-number">-1</span></span>) fatal(" "); handle_connection(new_sockfd, &amp;client_addr, logfd); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>; } <span class="hljs-comment"><span class="hljs-comment">/*         *         FD. *    -,    *   .     . */</span></span> <span class="hljs-type"><span class="hljs-type">void</span></span> handle_connection(<span class="hljs-type"><span class="hljs-type">int</span></span> sockfd, struct sockaddr_in *client_addr_ptr, <span class="hljs-type"><span class="hljs-type">int</span></span> logfd) { unsigned <span class="hljs-type"><span class="hljs-type">char</span></span> *ptr, request[<span class="hljs-number"><span class="hljs-number">500</span></span>], resource[<span class="hljs-number"><span class="hljs-number">500</span></span>], log_buffer[<span class="hljs-number"><span class="hljs-number">500</span></span>]; <span class="hljs-type"><span class="hljs-type">int</span></span> fd, length; length = recv_line(sockfd, request); sprintf(log_buffer, " %s:%d \"%s\"\t", inet_ntoa(client_addr_ptr-&gt;sin_addr), ntohs(client_addr_ptr-&gt;sin_port), request); ptr = strstr(request, " HTTP/"); //    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(ptr == <span class="hljs-keyword"><span class="hljs-keyword">NULL</span></span>) { //    HTTP  strcat(log_buffer, "  HTTP!\n"); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { *ptr = <span class="hljs-number"><span class="hljs-number">0</span></span>; //      URL ptr = <span class="hljs-keyword"><span class="hljs-keyword">NULL</span></span>; //  ptr  <span class="hljs-keyword"><span class="hljs-keyword">NULL</span></span> (           //  ) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(strncmp(request, "GET ", <span class="hljs-number"><span class="hljs-number">4</span></span>) == <span class="hljs-number"><span class="hljs-number">0</span></span>) //  <span class="hljs-keyword"><span class="hljs-keyword">GET</span></span> ptr = request+<span class="hljs-number"><span class="hljs-number">4</span></span>; // ptr -  URL <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(strncmp(request, "HEAD ", <span class="hljs-number"><span class="hljs-number">5</span></span>) == <span class="hljs-number"><span class="hljs-number">0</span></span>) //  HEAD ptr = request+<span class="hljs-number"><span class="hljs-number">5</span></span>; // ptr -  URL <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(ptr == <span class="hljs-keyword"><span class="hljs-keyword">NULL</span></span>) { //     strcat(log_buffer, "  !\n"); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { //    ptr,     <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ptr[strlen(ptr) - <span class="hljs-number"><span class="hljs-number">1</span></span>] == <span class="hljs-string"><span class="hljs-string">'/'</span></span>)   //  ,                                        //  <span class="hljs-string"><span class="hljs-string">'/'</span></span>, strcat(ptr, "index.html");   //    <span class="hljs-string"><span class="hljs-string">'index.html'</span></span> strcpy(resource, WEBROOT);   //  resource                                            //  strcat(resource, ptr);   //      fd = <span class="hljs-keyword"><span class="hljs-keyword">open</span></span>(resource, O_RDONLY, <span class="hljs-number"><span class="hljs-number">0</span></span>);  //    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(fd == <span class="hljs-number"><span class="hljs-number">-1</span></span>) { //     strcat(log_buffer, " 404 Not Found\n");           send_string(sockfd, "HTTP/1.0 404 NOT FOUND\r\n");                send_string(sockfd, "Server: Tiny webserver\r\n\r\n");                send_string(sockfd, "&lt;html&gt;&lt;head&gt;&lt;title&gt;404 Not Found&lt;/title&gt;                                     &lt;/head&gt;");            send_string(sockfd, "&lt;body&gt;&lt;h1&gt;URL not found&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;                                     \r\n"); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> {       //      strcat(log_buffer, " 200 OK\n");             send_string(sockfd, "HTTP/1.0 200 OK\r\n");           send_string(sockfd, "Server: Tiny webserver\r\n\r\n");            <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(ptr == request + <span class="hljs-number"><span class="hljs-number">4</span></span>) { //    <span class="hljs-keyword"><span class="hljs-keyword">GET</span></span>     <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( (length = get_file_size(fd)) == <span class="hljs-number"><span class="hljs-number">-1</span></span>)          fatal("     ");     <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( (ptr = (unsigned <span class="hljs-type"><span class="hljs-type">char</span></span> *) malloc(length)) == <span class="hljs-keyword"><span class="hljs-keyword">NULL</span></span>)          fatal("      ");          <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>(fd, ptr, length);  //              send(sockfd, ptr, length, <span class="hljs-number"><span class="hljs-number">0</span></span>);  //              free(ptr);  //      } <span class="hljs-keyword"><span class="hljs-keyword">close</span></span>(fd); //   } //   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>  /        } //   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>     } //   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>    HTTP <span class="hljs-type"><span class="hljs-type">timestamp</span></span>(logfd); length = strlen(log_buffer); <span class="hljs-keyword"><span class="hljs-keyword">write</span></span>(logfd, log_buffer, length); //    shutdown(sockfd, SHUT_RDWR); //    } <span class="hljs-comment"><span class="hljs-comment">/*         *    .    -1. */</span></span> <span class="hljs-type"><span class="hljs-type">int</span></span> get_file_size(<span class="hljs-type"><span class="hljs-type">int</span></span> fd) { struct stat stat_struct; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(fstat(fd, &amp;stat_struct) == <span class="hljs-number"><span class="hljs-number">-1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">-1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (<span class="hljs-type"><span class="hljs-type">int</span></span>) stat_struct.st_size; } <span class="hljs-comment"><span class="hljs-comment">/*          *   . */</span></span> <span class="hljs-type"><span class="hljs-type">void</span></span> <span class="hljs-type"><span class="hljs-type">timestamp</span></span>(fd) { time_t now; struct tm *time_struct; <span class="hljs-type"><span class="hljs-type">int</span></span> length; <span class="hljs-type"><span class="hljs-type">char</span></span> time_buffer[<span class="hljs-number"><span class="hljs-number">40</span></span>]; <span class="hljs-type"><span class="hljs-type">time</span></span>(&amp;now); //       time_struct = <span class="hljs-built_in"><span class="hljs-built_in">localtime</span></span>((const time_t *)&amp;now); //    tm length = strftime(time_buffer, <span class="hljs-number"><span class="hljs-number">40</span></span>, "%m/%d/%Y %H:%M:%S&gt; ", time_struct); <span class="hljs-keyword"><span class="hljs-keyword">write</span></span>(fd, time_buffer, length); //       }</code> </pre> <br>  Ce programme crée un processus en double qui s'exécute en arrière-plan, écrit dans le fichier journal avec les horodatages et se termine correctement après avoir reçu le signal correspondant.  Le descripteur de fichier journal et le socket acceptant la connexion sont déclarés en tant que variables globales afin que la fonction handle_shutdown () puisse terminer leur travail correctement.  Il est défini comme un gestionnaire de rappel pour les signaux d'achèvement et d'interruption, ce qui garantit que le programme est terminé par la commande kill. <br><br>  Voici le résultat de la compilation, de l'exécution et de l'achèvement du programme.  Faites attention aux horodatages dans le journal et au message de fin qui est apparu après que le programme a reçu le signal correspondant et a appelé la fonction handle_shutdown (). <br><br><pre> <code class="hljs ruby">reader@hacking<span class="hljs-symbol"><span class="hljs-symbol">:~/booksrc</span></span> $ gcc -o tinywebd tinywebd.c reader@hacking<span class="hljs-symbol"><span class="hljs-symbol">:~/booksrc</span></span> $ sudo chown root ./tinywebd reader@hacking<span class="hljs-symbol"><span class="hljs-symbol">:~/booksrc</span></span> $ sudo chmod u+s ./tinywebd reader@hacking<span class="hljs-symbol"><span class="hljs-symbol">:~/booksrc</span></span> $ ./tinywebd   tiny web. reader@hacking<span class="hljs-symbol"><span class="hljs-symbol">:~/booksrc</span></span> $ ./webserver_id <span class="hljs-number"><span class="hljs-number">127.0</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span> The web server <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-number"><span class="hljs-number">127.0</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span> is Tiny webserver reader@hacking<span class="hljs-symbol"><span class="hljs-symbol">:~/booksrc</span></span> $ ps ax <span class="hljs-params"><span class="hljs-params">| grep tinywebd 25058 ? Ss 0:00 ./tinywebd 25075 pts/3 R+ 0:00 grep tinywebd reader@hacking:~/booksrc $ kill 25058 reader@hacking:~/booksrc $ ps ax |</span></span> grep tinywebd <span class="hljs-number"><span class="hljs-number">25121</span></span> pts/<span class="hljs-number"><span class="hljs-number">3</span></span> R+ <span class="hljs-number"><span class="hljs-number">0</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">00</span></span> grep tinywebd reader@hacking<span class="hljs-symbol"><span class="hljs-symbol">:~/booksrc</span></span> $ cat /var/log/tinywebd.log <span class="hljs-symbol"><span class="hljs-symbol">cat:</span></span> /var/log/tinywebd.<span class="hljs-symbol"><span class="hljs-symbol">log:</span></span> Permission denied reader@hacking<span class="hljs-symbol"><span class="hljs-symbol">:~/booksrc</span></span> $ sudo cat /var/log/tinywebd.log <span class="hljs-number"><span class="hljs-number">07</span></span>/<span class="hljs-number"><span class="hljs-number">22</span></span>/<span class="hljs-number"><span class="hljs-number">2007</span></span> <span class="hljs-number"><span class="hljs-number">17</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">55</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">45</span></span>&gt; . <span class="hljs-number"><span class="hljs-number">07</span></span>/<span class="hljs-number"><span class="hljs-number">22</span></span>/<span class="hljs-number"><span class="hljs-number">2007</span></span> <span class="hljs-number"><span class="hljs-number">17</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">57</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">00</span></span>&gt;  <span class="hljs-number"><span class="hljs-number">127.0</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">38127</span></span> <span class="hljs-string"><span class="hljs-string">"HEAD / HTTP/1.0"</span></span> <span class="hljs-number"><span class="hljs-number">200</span></span> OK <span class="hljs-number"><span class="hljs-number">07</span></span>/<span class="hljs-number"><span class="hljs-number">22</span></span>/<span class="hljs-number"><span class="hljs-number">2007</span></span> <span class="hljs-number"><span class="hljs-number">17</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">57</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">21</span></span>&gt;  . reader@hacking<span class="hljs-symbol"><span class="hljs-symbol">:~/booksrc</span></span> $</code> </pre> <br>  Le nouveau programme tinywebd traite le contenu HTTP, comme le tinyweb d'origine, mais se comporte comme un démon système car il n'a pas de terminal de contrôle et la sortie est vers un fichier journal.  Les deux programmes sont vulnérables au même débordement de tampon - mais ce n'est que le début de cette vulnérabilité.  Maintenant que nous avons choisi tinywebd comme cible de l'attaque, je vais vous montrer comment éviter la détection après être entré sur une autre machine. <br><br>  »Plus d'informations sur le livre sont disponibles sur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">le site Web de l'éditeur</a> <br>  » <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Contenu</a> <br>  » <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Extrait</a> <br><br>  20% de réduction sur le coupon pour Habrozhitel - <b>Hacking</b> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr413989/">https://habr.com/ru/post/fr413989/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr413977/index.html">Création d'un système de protection antivirus étendu pour une petite entreprise. 3e partie</a></li>
<li><a href="../fr413979/index.html">Mitap "Comment gérer des guildes et des communautés?" de Tutu.ru et AgileVerse</a></li>
<li><a href="../fr413981/index.html">Security Week 21: des centaines de vulnérabilités Adobe Flash</a></li>
<li><a href="../fr413983/index.html">Évaluation de Cavium ThunderX2: le rêve du serveur Arm se réalise (partie 3)</a></li>
<li><a href="../fr413987/index.html">Poudlard rouge. Série 7. Étudiants</a></li>
<li><a href="../fr413991/index.html">Corrigez-moi si vous le pouvez: comment nous déboguons sur la production. 2e partie</a></li>
<li><a href="../fr413995/index.html">Conférences techniques pour nous-mêmes: notre expérience, nos erreurs et nos réalisations</a></li>
<li><a href="../fr413997/index.html">Processeurs Intel 32 bits: 3 à 4 - Vendredi long inutile</a></li>
<li><a href="../fr413999/index.html">Ce qui s'est passé avec la tarification du cloud ces dernières années</a></li>
<li><a href="../fr414001/index.html">Comment survivre dans un monde en développement en évolution</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>