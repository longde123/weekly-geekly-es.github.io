<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë± üêè üìØ Le livre ¬´Hacking: The Art of Exploit. 2e √©d. " üë®üèø‚Äçüéì üë¶üèº üì∞</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Chaque programmeur est essentiellement un hacker. Apr√®s tout, le piratage s'appelait initialement la recherche d'une solution habile et non √©vidente. ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Le livre ¬´Hacking: The Art of Exploit. 2e √©d. "</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/piter/blog/413989/"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/v1/y_/wo/v1y_wo0l3qbzeakw1hmembve6lk.jpeg" align="left" alt="image"></a>  Chaque programmeur est essentiellement un hacker.  Apr√®s tout, le piratage s'appelait initialement la recherche d'une solution habile et non √©vidente.  La compr√©hension de la programmation vous aide √† trouver les vuln√©rabilit√©s et les comp√©tences de d√©tection des vuln√©rabilit√©s vous aident √† cr√©er des programmes, de nombreux pirates font les deux en m√™me temps.  Il existe des mouvements non standard int√©ressants √† la fois dans les techniques d'√©criture de programmes √©l√©gants et dans les techniques de recherche de points faibles. <br><br>  Par o√π commencer?  Pour √©craser la m√©moire √† l'aide de d√©bordements de tampon, acc√©der √† un serveur distant et intercepter les connexions, vous devez programmer en C et assembleur, utiliser le code shell et les registres de processeur, vous familiariser avec les interactions r√©seau et le cryptage, et bien plus encore. <br><br>  Peu importe √† quel point nous voulons croire aux miracles, les logiciels et les r√©seaux informatiques dont d√©pendent notre vie quotidienne pr√©sentent des vuln√©rabilit√©s. <br><br>  Un monde sans hackers est un monde sans curiosit√© et sans solutions innovantes.  (John Erickson) <br><a name="habracut"></a><br><h3>  <b>Contre-mesures</b> </h3><br>  Il y a une telle grenouille - une terrible listolaz (Phyllobates terribilis).  Ses glandes cutan√©es contiennent le poison le plus puissant.  Il suffit de le toucher pour obtenir un empoisonnement fatal.  Un rem√®de aussi puissant s'explique par le fait que ces grenouilles se nourrissent de certains types de serpents qui ont d√©velopp√© une immunit√© au poison.  Progressivement, le poison des grenouilles est devenu de plus en plus fort.  √Ä la suite d'une telle √©volution conjointe, les terribles grimpeurs de feuilles n'ont plus d'autres ennemis naturels.  Quelque chose de similaire se produit avec les pirates.  Les techniques qu'ils ont invent√©es sont connues depuis longtemps, donc l'√©mergence de contre-mesures est assez naturelle.  En r√©ponse, les pirates cherchent des moyens de contourner et de d√©truire les m√©canismes de d√©fense, ce qui conduit √† la cr√©ation de nouvelles techniques d√©fensives. <br><br>  Ce cycle de recherche de mesures et de contre-mesures est tr√®s utile.  Les virus et les vers deviennent la cause de nombreux probl√®mes et entra√Ænent de lourdes pertes pour les entreprises, mais en m√™me temps, ils forcent les d√©veloppeurs √† prendre des mesures de r√©torsion pour r√©soudre les probl√®mes qui sont survenus.  Les vers s'auto-r√©pliquent √† l'aide de vuln√©rabilit√©s logicielles de faible qualit√©.  Les erreurs passent souvent inaper√ßues au fil des ans, et des vers relativement inoffensifs tels que CodeRed ou Sasser forcent les d√©veloppeurs √† les corriger.  Ce processus peut √™tre compar√© √† la varicelle, qui est pr√©f√©rable pour tomber malade dans l'enfance, et non √† l'√¢ge adulte, lorsqu'elle peut entra√Æner des cons√©quences d√©sastreuses.  Si les vers Internet n'avaient pas attir√© l'attention universelle sur les failles de s√©curit√©, ces failles resteraient ouvertes √† des attaques √† des fins bien plus malveillantes que la simple auto-reproduction.  De cette fa√ßon, les vers et les virus contribuent √† la s√©curit√© √† long terme.  Mais il existe des m√©thodes plus actives: des techniques qui tentent d'annuler les r√©sultats d'une attaque ou de la rendre compl√®tement impossible.  Le concept de ¬´contre-mesures¬ª est assez vague, ces mots peuvent signifier des moyens techniques de s√©curit√©, un ensemble de r√®gles, un programme ou tout simplement un administrateur syst√®me attentif.  Les contre-mesures sont conditionnellement divis√©es en deux groupes: essayer de d√©tecter une attaque et essayer de prot√©ger la vuln√©rabilit√©. <br><br><h3>  Outil de d√©tection d'attaque 0x610 </h3><br>  Les contre-mesures du premier groupe se r√©sument √† des tentatives de remarquer l'intrusion dans le temps et d'y r√©agir d'une mani√®re ou d'une autre.  Le processus de reconnaissance peut √™tre mis en ≈ìuvre de n'importe quelle mani√®re - de l'administrateur lisant les journaux syst√®me aux programmes analysant le trafic r√©seau.  Parfois, la r√©action √† une invasion revient √† d√©connecter automatiquement la connexion ou √† fermer le processus, et parfois l'administrateur doit √©tudier attentivement tout le contenu de la console. <br><br>  Les m√©thodes connues d'exploitation des vuln√©rabilit√©s ne sont pas aussi dangereuses pour l'administrateur syst√®me que celles qu'il ne conna√Æt pas encore.  Plus t√¥t une intrusion peut √™tre d√©tect√©e, plus le travail commencera t√¥t et plus elle sera localis√©e.  Une intrusion ignor√©e depuis des mois est un grave sujet de pr√©occupation. <br><br>  Pour reconna√Ætre l'intrusion, vous devez anticiper ce que l'attaquant va faire.  Cela fournit des informations sur ce qui doit √™tre surveill√© exactement.  Les d√©tecteurs recherchent des mod√®les d'attaque familiers dans les journaux, les paquets r√©seau et m√™me dans la m√©moire du programme.  Lorsqu'une intrusion est d√©tect√©e, vous pouvez priver le pirate de l'acc√®s √† la machine, restaurer le syst√®me de fichiers endommag√© √† l'aide d'une sauvegarde et identifier et corriger le trou de s√©curit√©.  Avec les capacit√©s de sauvegarde et de restauration disponibles aujourd'hui, les contre-mesures qui se r√©duisent √† la d√©tection des attaques sont assez efficaces. <br><br>  Pour un attaquant, la d√©tection signifie contrer tout ce qu'il fait.  Bien s√ªr, il est loin d'√™tre toujours possible de remarquer imm√©diatement une attaque, il existe donc un certain nombre de sc√©narios ¬´grab and run¬ª dans lesquels le fait de la d√©tection n'est pas important, mais m√™me dans ces cas, il vaut mieux ne pas laisser de traces.  Le secret est l'une des qualit√©s les plus pr√©cieuses des pirates.  L'acc√®s au shell de commandes avec des droits d'administrateur en exploitant les vuln√©rabilit√©s permet de faire quoi que ce soit sur le syst√®me, et si vous parvenez √† √©viter la d√©tection, personne ne sera au courant de votre pr√©sence.  C'est la combinaison de la permissivit√© et de l'invisibilit√© qui rend les pirates informatiques dangereux.  Ils peuvent facilement intercepter les mots de passe et les donn√©es sur le r√©seau, ajouter des signets aux programmes pour un acc√®s non autoris√© ult√©rieur et attaquer d'autres n≈ìuds du r√©seau.  Pour rester dans l'ombre, le pirate doit comprendre quelles m√©thodes de reconnaissance sont utilis√©es dans un cas particulier.  Si vous savez exactement ce qu'ils recherchent, vous pouvez √©viter certains mod√®les d'exploitation de la vuln√©rabilit√© ou masquer vos actions comme valides.  Le facteur moteur du cycle d'√©volution conjointe des outils et des techniques de d√©tection qui permettent de passer inaper√ßu sont des id√©es qui ne sont pas encore apparues de l'autre c√¥t√©. <br><br><h3>  D√©mons syst√®me 0x620 </h3><br>  Cependant, les contre-mesures contre les pirates et leurs solutions de contournement sont mieux discut√©es √† l'aide d'un exemple pratique.  Nous allons maintenant consid√©rer une attaque contre un programme serveur qui accepte les connexions entrantes.  Sur les syst√®mes d'exploitation de type UNIX, les d√©mons syst√®me conviennent √† ces crit√®res.  Un d√©mon est un programme fonctionnant en arri√®re-plan et d'une certaine mani√®re s√©par√© du terminal de contr√¥le.  Le terme a √©t√© invent√© dans les ann√©es 1960 par des pirates du Massachusetts Institute of Technology.  Le prototype √©tait une cr√©ature mythique triant les mol√©cules d'une exp√©rience mentale du physicien James Maxwell.  Le d√©mon Maxwell poss√©dait une capacit√© surnaturelle pour effectuer facilement des t√¢ches complexes, violant la deuxi√®me loi de la thermodynamique.  De m√™me, les d√©mons syst√®me Linux ex√©cutent inlassablement des t√¢ches telles que l'octroi de l'acc√®s √† SSH et la maintenance des journaux syst√®me.  Les noms de d√©mon se terminent g√©n√©ralement par d, ce qui souligne leur nature: par exemple, sshd ou syslogd. <br><br>  Une petite modification transformera tinyweb.c de la section 0x427 en une ressemblance r√©aliste avec un d√©mon syst√®me.  La nouvelle version du code contient la fonction daemon (), qui engendre un nouveau processus d'arri√®re-plan.  Il est utilis√© par de nombreux processus de d√©mon syst√®me Linux.  Voici la page qui lui est d√©di√©e dans l'annuaire: <br><br>  DAEMON (3) R√©f√©rence du programmeur Linux DAEMON (3) <br><br>  NOM <br>  d√©mon - ex√©cut√© en arri√®re-plan <br>  Syntaxe <br><br><pre><code class="hljs vbscript">#include &lt;unistd.h&gt; <span class="hljs-built_in"><span class="hljs-built_in">int</span></span> daemon(<span class="hljs-built_in"><span class="hljs-built_in">int</span></span> nochdir, <span class="hljs-built_in"><span class="hljs-built_in">int</span></span> noclose);</code> </pre> <br>  DESCRIPTION <br><br>  La fonction daemon () d√©connecte le programme du terminal de commande et d√©marre <br>  elle en arri√®re-plan en tant que d√©mon syst√®me. <br>  Avec un argument diff√©rent de z√©ro, nochdir, daemon () change le r√©pertoire de travail courant <br>  √† la racine ("/"). <br>  Avec nullose, la fonction daemon () redirige les threads <br>  entr√©e standard, sortie standard et erreurs dans / dev / null. <br>  VALEUR DE RETOUR <br><br>  (Cette fonction g√©n√®re une copie du processus, et si fork () r√©ussit <br>  le parent ex√©cute _exit (0) de sorte que d'autres erreurs ne soient visibles que <br>  processus enfant.) En cas de succ√®s, renvoie z√©ro.  En cas d'erreur, la fonction <br>  daemon () renvoie -1 et assigne le num√©ro d'erreur √† la variable globale errno <br>  √† partir de la biblioth√®que de fonctions fork (2) et setsid (2). <br><br>  Les d√©mons syst√®me n'ont pas de terminal de contr√¥le, donc le code du nouveau d√©mon tinywebd sera affich√© dans le journal de bord.  Les d√©mons sont g√©n√©ralement contr√¥l√©s par des signaux.  La nouvelle version de tinyweb devrait pouvoir recevoir un signal d'ach√®vement afin de sortir correctement. <br><br><h3>  Pr√©sentation du signal 0x621 </h3><br>  Les signaux fournissent une communication interprocessus sous UNIX.  Une fois qu'un signal est re√ßu par un processus, le syst√®me d'exploitation interrompt son ex√©cution pour appeler le gestionnaire de signaux.  Chaque signal a son propre num√©ro et son propre gestionnaire.  Par exemple, lorsque vous appuyez sur la combinaison de touches Ctrl + C, un signal d'interruption est envoy√©, dont le gestionnaire termine le programme ouvert sur le terminal de commande, m√™me s'il est entr√© dans une boucle infinie. <br><br>  Vous pouvez cr√©er vos propres gestionnaires de signaux et les enregistrer √† l'aide de la fonction signal ().  Regardons un code dans lequel plusieurs gestionnaires sont enregistr√©s pour certains signaux, et dans la partie principale il y a une boucle infinie. <br><br><pre> <code class="hljs smalltalk">signal_example.c <span class="hljs-symbol"><span class="hljs-symbol">#include</span></span> &lt;stdio.h&gt; <span class="hljs-symbol"><span class="hljs-symbol">#include</span></span> &lt;stdlib.h&gt; <span class="hljs-symbol"><span class="hljs-symbol">#include</span></span> &lt;signal.h&gt; /*    signal.h * <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">SIGHUP</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>  * <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">SIGINT</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>  (<span class="hljs-type"><span class="hljs-type">Ctrl</span></span>+<span class="hljs-type"><span class="hljs-type">C</span></span>) * <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">SIGQUIT</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span>  (<span class="hljs-type"><span class="hljs-type">Ctrl</span></span>+\) * <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">SIGILL</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span>   * <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">SIGTRAP</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span>   * <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">SIGABRT</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span>  * <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">SIGBUS</span></span> <span class="hljs-number"><span class="hljs-number">7</span></span>   * <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">SIGFPE</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span>     * <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">SIGKILL</span></span> <span class="hljs-number"><span class="hljs-number">9</span></span>   * <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">SIGUSR1</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span>   <span class="hljs-number"><span class="hljs-number">1</span></span> * <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">SIGSEGV</span></span> <span class="hljs-number"><span class="hljs-number">11</span></span>   * <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">SIGUSR2</span></span> <span class="hljs-number"><span class="hljs-number">12</span></span>   <span class="hljs-number"><span class="hljs-number">2</span></span> * <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">SIGPIPE</span></span> <span class="hljs-number"><span class="hljs-number">13</span></span>    ,    * <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">SIGALRM</span></span> <span class="hljs-number"><span class="hljs-number">14</span></span>   ,  alarm() * <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">SIGTERM</span></span> <span class="hljs-number"><span class="hljs-number">15</span></span>  (  kill) * <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">SIGCHLD</span></span> <span class="hljs-number"><span class="hljs-number">17</span></span>    * <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">SIGCONT</span></span> <span class="hljs-number"><span class="hljs-number">18</span></span> ,    * <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">SIGSTOP</span></span> <span class="hljs-number"><span class="hljs-number">19</span></span>  (  ) * <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">SIGTSTP</span></span> <span class="hljs-number"><span class="hljs-number">20</span></span>   [] (<span class="hljs-type"><span class="hljs-type">Ctrl</span></span>+<span class="hljs-type"><span class="hljs-type">Z</span></span>) * <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">SIGTTIN</span></span> <span class="hljs-number"><span class="hljs-number">21</span></span>       * <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">SIGTTOU</span></span> <span class="hljs-number"><span class="hljs-number">22</span></span>       */ /*   */ void signal_handler(int signal) { printf(<span class="hljs-comment"><span class="hljs-comment">"  %d\t"</span></span>, signal); if (signal == <span class="hljs-type"><span class="hljs-type">SIGTSTP</span></span>) printf(<span class="hljs-comment"><span class="hljs-comment">"SIGTSTP (Ctrl-Z)"</span></span>); else if (signal == <span class="hljs-type"><span class="hljs-type">SIGQUIT</span></span>) printf(<span class="hljs-comment"><span class="hljs-comment">"SIGQUIT (Ctrl-\\)"</span></span>); else if (signal == <span class="hljs-type"><span class="hljs-type">SIGUSR1</span></span>) printf(<span class="hljs-comment"><span class="hljs-comment">"SIGUSR1"</span></span>); else if (signal == <span class="hljs-type"><span class="hljs-type">SIGUSR2</span></span>) printf(<span class="hljs-comment"><span class="hljs-comment">"SIGUSR2"</span></span>); printf(<span class="hljs-comment"><span class="hljs-comment">"\n"</span></span>); } void sigint_handler(int x) { printf(<span class="hljs-comment"><span class="hljs-comment">" Ctrl-C (SIGINT)   \nExiting.\n"</span></span>); exit(<span class="hljs-number"><span class="hljs-number">0</span></span>); } int main() { /* <span class="hljs-type"><span class="hljs-type">Registering</span></span> signal handlers */ signal(<span class="hljs-type"><span class="hljs-type">SIGQUIT</span></span>, signal_handler); //  signal_handler() signal(<span class="hljs-type"><span class="hljs-type">SIGTSTP</span></span>, signal_handler); //    signal(<span class="hljs-type"><span class="hljs-type">SIGUSR1</span></span>, signal_handler); signal(<span class="hljs-type"><span class="hljs-type">SIGUSR2</span></span>, signal_handler); signal(<span class="hljs-type"><span class="hljs-type">SIGINT</span></span>, sigint_handler); //  sigint_handler()  <span class="hljs-type"><span class="hljs-type">SIGINT</span></span> while(<span class="hljs-number"><span class="hljs-number">1</span></span>) {} //   }</code> </pre> <br>  Lorsqu'un programme compil√© est ex√©cut√©, les gestionnaires de signaux sont enregistr√©s, puis le programme entre dans une boucle sans fin.  Mais, malgr√© cela, les signaux entrants interrompent son ex√©cution et se tournent vers les gestionnaires enregistr√©s.  Voici des exemples d'application de signaux pouvant √™tre activ√©s √† partir du terminal de commande.  Une fois la fonction signal_handler () termin√©e, le contr√¥le retourne √† la boucle interrompue, tandis que la fonction sigint_handler () termine le programme. <br><br><pre> <code class="hljs ruby">reader@hacking<span class="hljs-symbol"><span class="hljs-symbol">:~/booksrc</span></span> $ gcc -o signal_example signal_example.c reader@hacking<span class="hljs-symbol"><span class="hljs-symbol">:~/booksrc</span></span> $ ./signal_example   <span class="hljs-number"><span class="hljs-number">20</span></span> SIGTSTP (Ctrl-Z)   <span class="hljs-number"><span class="hljs-number">3</span></span> SIGQUIT (Ctrl-\)  Ctrl-C (SIGINT)    Exiting. reader@hacking<span class="hljs-symbol"><span class="hljs-symbol">:~/booksrc</span></span> $</code> </pre> <br>  La commande kill vous permet d'envoyer un ensemble complet de signaux √† un processus.  Par d√©faut, il envoie un signal d'ach√®vement (SIGTERM).  L'ajout de l'option -l affiche une liste de tous les signaux possibles.  Voyons comment le programme signal_example ex√©cut√© sur un autre terminal envoie les signaux SIGUSR1 et SIGUSR2. <br><br><pre> <code class="hljs powershell">reader@hacking:~/booksrc <span class="hljs-variable"><span class="hljs-variable">$</span></span> kill <span class="hljs-literal"><span class="hljs-literal">-l</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>) SIGHUP       <span class="hljs-number"><span class="hljs-number">2</span></span>) SIGINT       <span class="hljs-number"><span class="hljs-number">3</span></span>) SIGQUIT      <span class="hljs-number"><span class="hljs-number">4</span></span>) SIGILL <span class="hljs-number"><span class="hljs-number">5</span></span>) SIGTRAP      <span class="hljs-number"><span class="hljs-number">6</span></span>) SIGABRT      <span class="hljs-number"><span class="hljs-number">7</span></span>) SIGBUS       <span class="hljs-number"><span class="hljs-number">8</span></span>) SIGFPE <span class="hljs-number"><span class="hljs-number">9</span></span>) SIGKILL     <span class="hljs-number"><span class="hljs-number">10</span></span>) SIGUSR1     <span class="hljs-number"><span class="hljs-number">11</span></span>) SIGSEGV     <span class="hljs-number"><span class="hljs-number">12</span></span>) SIGUSR2 <span class="hljs-number"><span class="hljs-number">13</span></span>) SIGPIPE     <span class="hljs-number"><span class="hljs-number">14</span></span>) SIGALRM     <span class="hljs-number"><span class="hljs-number">15</span></span>) SIGTERM     <span class="hljs-number"><span class="hljs-number">16</span></span>) SIGSTKFLT <span class="hljs-number"><span class="hljs-number">17</span></span>) SIGCHLD     <span class="hljs-number"><span class="hljs-number">18</span></span>) SIGCONT     <span class="hljs-number"><span class="hljs-number">19</span></span>) SIGSTOP     <span class="hljs-number"><span class="hljs-number">20</span></span>) SIGTSTP <span class="hljs-number"><span class="hljs-number">21</span></span>) SIGTTIN     <span class="hljs-number"><span class="hljs-number">22</span></span>) SIGTTOU     <span class="hljs-number"><span class="hljs-number">23</span></span>) SIGURG      <span class="hljs-number"><span class="hljs-number">24</span></span>) SIGXCPU <span class="hljs-number"><span class="hljs-number">25</span></span>) SIGXFSZ     <span class="hljs-number"><span class="hljs-number">26</span></span>) SIGVTALRM   <span class="hljs-number"><span class="hljs-number">27</span></span>) SIGPROF     <span class="hljs-number"><span class="hljs-number">28</span></span>) SIGWINCH <span class="hljs-number"><span class="hljs-number">29</span></span>) SIGIO       <span class="hljs-number"><span class="hljs-number">30</span></span>) SIGPWR      <span class="hljs-number"><span class="hljs-number">31</span></span>) SIGSYS      <span class="hljs-number"><span class="hljs-number">34</span></span>) SIGRTMIN <span class="hljs-number"><span class="hljs-number">35</span></span>) SIGRTMIN+<span class="hljs-number"><span class="hljs-number">1</span></span>  <span class="hljs-number"><span class="hljs-number">36</span></span>) SIGRTMIN+<span class="hljs-number"><span class="hljs-number">2</span></span>  <span class="hljs-number"><span class="hljs-number">37</span></span>) SIGRTMIN+<span class="hljs-number"><span class="hljs-number">3</span></span>  <span class="hljs-number"><span class="hljs-number">38</span></span>) SIGRTMIN+<span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">39</span></span>) SIGRTMIN+<span class="hljs-number"><span class="hljs-number">5</span></span>  <span class="hljs-number"><span class="hljs-number">40</span></span>) SIGRTMIN+<span class="hljs-number"><span class="hljs-number">6</span></span>  <span class="hljs-number"><span class="hljs-number">41</span></span>) SIGRTMIN+<span class="hljs-number"><span class="hljs-number">7</span></span>  <span class="hljs-number"><span class="hljs-number">42</span></span>) SIGRTMIN+<span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-number"><span class="hljs-number">43</span></span>) SIGRTMIN+<span class="hljs-number"><span class="hljs-number">9</span></span>  <span class="hljs-number"><span class="hljs-number">44</span></span>) SIGRTMIN+<span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-number"><span class="hljs-number">45</span></span>) SIGRTMIN+<span class="hljs-number"><span class="hljs-number">11</span></span> <span class="hljs-number"><span class="hljs-number">46</span></span>) SIGRTMIN+<span class="hljs-number"><span class="hljs-number">12</span></span> <span class="hljs-number"><span class="hljs-number">47</span></span>) SIGRTMIN+<span class="hljs-number"><span class="hljs-number">13</span></span> <span class="hljs-number"><span class="hljs-number">48</span></span>) SIGRTMIN+<span class="hljs-number"><span class="hljs-number">14</span></span> <span class="hljs-number"><span class="hljs-number">49</span></span>) SIGRTMIN+<span class="hljs-number"><span class="hljs-number">15</span></span> <span class="hljs-number"><span class="hljs-number">50</span></span>) SIGRTMAX<span class="hljs-literal"><span class="hljs-literal">-14</span></span> <span class="hljs-number"><span class="hljs-number">51</span></span>) SIGRTMAX<span class="hljs-literal"><span class="hljs-literal">-13</span></span> <span class="hljs-number"><span class="hljs-number">52</span></span>) SIGRTMAX<span class="hljs-literal"><span class="hljs-literal">-12</span></span> <span class="hljs-number"><span class="hljs-number">53</span></span>) SIGRTMAX<span class="hljs-literal"><span class="hljs-literal">-11</span></span> <span class="hljs-number"><span class="hljs-number">54</span></span>) SIGRTMAX<span class="hljs-literal"><span class="hljs-literal">-10</span></span> <span class="hljs-number"><span class="hljs-number">55</span></span>) SIGRTMAX<span class="hljs-literal"><span class="hljs-literal">-9</span></span>  <span class="hljs-number"><span class="hljs-number">56</span></span>) SIGRTMAX<span class="hljs-literal"><span class="hljs-literal">-8</span></span>  <span class="hljs-number"><span class="hljs-number">57</span></span>) SIGRTMAX<span class="hljs-literal"><span class="hljs-literal">-7</span></span>  <span class="hljs-number"><span class="hljs-number">58</span></span>) SIGRTMAX<span class="hljs-literal"><span class="hljs-literal">-6</span></span> <span class="hljs-number"><span class="hljs-number">59</span></span>) SIGRTMAX<span class="hljs-literal"><span class="hljs-literal">-5</span></span>  <span class="hljs-number"><span class="hljs-number">60</span></span>) SIGRTMAX<span class="hljs-literal"><span class="hljs-literal">-4</span></span>  <span class="hljs-number"><span class="hljs-number">61</span></span>) SIGRTMAX<span class="hljs-literal"><span class="hljs-literal">-3</span></span>  <span class="hljs-number"><span class="hljs-number">62</span></span>) SIGRTMAX<span class="hljs-literal"><span class="hljs-literal">-2</span></span> <span class="hljs-number"><span class="hljs-number">63</span></span>) SIGRTMAX<span class="hljs-literal"><span class="hljs-literal">-1</span></span>  <span class="hljs-number"><span class="hljs-number">64</span></span>) SIGRTMAX reader@hacking:~/booksrc <span class="hljs-variable"><span class="hljs-variable">$</span></span> ps a | grep signal_example <span class="hljs-number"><span class="hljs-number">24491</span></span> pts/<span class="hljs-number"><span class="hljs-number">3</span></span>    R+     <span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">17</span></span> ./signal_example <span class="hljs-number"><span class="hljs-number">24512</span></span> pts/<span class="hljs-number"><span class="hljs-number">1</span></span>    S+     <span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span> grep signal_example reader@hacking:~/booksrc <span class="hljs-variable"><span class="hljs-variable">$</span></span> kill <span class="hljs-literal"><span class="hljs-literal">-10</span></span> <span class="hljs-number"><span class="hljs-number">24491</span></span> reader@hacking:~/booksrc <span class="hljs-variable"><span class="hljs-variable">$</span></span> kill <span class="hljs-literal"><span class="hljs-literal">-12</span></span> <span class="hljs-number"><span class="hljs-number">24491</span></span> reader@hacking:~/booksrc <span class="hljs-variable"><span class="hljs-variable">$</span></span> kill <span class="hljs-literal"><span class="hljs-literal">-9</span></span> <span class="hljs-number"><span class="hljs-number">24491</span></span> reader@hacking:~/booksrc <span class="hljs-variable"><span class="hljs-variable">$</span></span></code> </pre> <br>  √Ä la fin, la commande kill -9 envoie un signal SIGKILL.  Le gestionnaire de signaux ne peut pas √™tre modifi√©, donc la commande kill -9 est toujours utilis√©e pour tuer les processus.  Le programme signal_example lanc√© sur un autre terminal montre que les signaux ont √©t√© intercept√©s et que le processus a √©t√© d√©truit. <br><br><pre> <code class="hljs ruby">reader@hacking<span class="hljs-symbol"><span class="hljs-symbol">:~/booksrc</span></span> $ ./signal_example   <span class="hljs-number"><span class="hljs-number">10</span></span>       SIGUSR1   <span class="hljs-number"><span class="hljs-number">12</span></span>       SIGUSR2 Killed reader@hacking<span class="hljs-symbol"><span class="hljs-symbol">:~/booksrc</span></span> $</code> </pre> <br>  Les signaux eux-m√™mes sont tr√®s simples, mais l'interaction entre les processus peut rapidement se transformer en un r√©seau complexe de d√©pendances.  Heureusement, dans notre d√©mon tinyweb, les signaux sont utilis√©s uniquement pour l'arr√™t correct, et tout est mis en ≈ìuvre tr√®s simplement. <br><br><h3>  D√©mon Tinyweb 0x622 </h3><br>  La nouvelle version de tinywebd est un d√©mon syst√®me lanc√© en arri√®re-plan sans terminal de contr√¥le.  Les donn√©es de sortie sont √©crites dans le journal de bord avec des horodatages et le programme lui-m√™me attend que le signal SIGTERM termine correctement le travail. <br><br>  Les modifications apport√©es √† l'original ne sont pas tr√®s importantes, mais elles permettent une √©tude plus r√©aliste du processus d'exploitation de la vuln√©rabilit√©.  Les nouveaux fragments de code sont en gras. <br><br><pre> <code class="hljs pgsql">tinywebd.c #<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> &lt;sys/stat.h&gt; #<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> &lt;sys/socket.h&gt; #<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> &lt;netinet/<span class="hljs-keyword"><span class="hljs-keyword">in</span></span>.h&gt; #<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> &lt;arpa/<span class="hljs-type"><span class="hljs-type">inet</span></span>.h&gt; #<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> &lt;sys/<span class="hljs-keyword"><span class="hljs-keyword">types</span></span>.h&gt; #<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> &lt;sys/stat.h&gt; #<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> &lt;fcntl.h&gt; #<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> &lt;<span class="hljs-type"><span class="hljs-type">time</span></span>.h&gt; #<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> &lt;signal.h&gt; #<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> "hacking.h" #<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> "hacking-network.h" #define PORT <span class="hljs-number"><span class="hljs-number">80</span></span> // ,     #define WEBROOT "./webroot" //   - #define LOGFILE "/var/log/tinywebd.log" //    <span class="hljs-type"><span class="hljs-type">int</span></span> logfd, sockfd; //       <span class="hljs-type"><span class="hljs-type">void</span></span> handle_connection(<span class="hljs-type"><span class="hljs-type">int</span></span>, struct sockaddr_in *, <span class="hljs-type"><span class="hljs-type">int</span></span>); <span class="hljs-type"><span class="hljs-type">int</span></span> get_file_size(<span class="hljs-type"><span class="hljs-type">int</span></span>); //         //  <span class="hljs-type"><span class="hljs-type">void</span></span> <span class="hljs-type"><span class="hljs-type">timestamp</span></span>(<span class="hljs-type"><span class="hljs-type">int</span></span>); //        //       <span class="hljs-type"><span class="hljs-type">void</span></span> handle_shutdown(<span class="hljs-type"><span class="hljs-type">int</span></span> signal) { <span class="hljs-type"><span class="hljs-type">timestamp</span></span>(logfd); <span class="hljs-keyword"><span class="hljs-keyword">write</span></span>(logfd, " .\n", <span class="hljs-number"><span class="hljs-number">16</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">close</span></span>(logfd); <span class="hljs-keyword"><span class="hljs-keyword">close</span></span>(sockfd); <span class="hljs-keyword"><span class="hljs-keyword">exit</span></span>(<span class="hljs-number"><span class="hljs-number">0</span></span>); } <span class="hljs-type"><span class="hljs-type">int</span></span> main(<span class="hljs-type"><span class="hljs-type">void</span></span>) { <span class="hljs-type"><span class="hljs-type">int</span></span> new_sockfd, yes=<span class="hljs-number"><span class="hljs-number">1</span></span>; struct sockaddr_in host_addr, client_addr; //    socklen_t sin_size; logfd = <span class="hljs-keyword"><span class="hljs-keyword">open</span></span>(LOGFILE, O_WRONLY|O_CREAT|O_APPEND, S_IRUSR|S_IWUSR); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(logfd == <span class="hljs-number"><span class="hljs-number">-1</span></span>) fatal("  ");  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((sockfd = socket(PF_INET, SOCK_STREAM, <span class="hljs-number"><span class="hljs-number">0</span></span>)) == <span class="hljs-number"><span class="hljs-number">-1</span></span>)        fatal(" "); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (setsockopt(sockfd, SOL_SOCKET, SO_REUSEADDR, &amp;yes, sizeof(<span class="hljs-type"><span class="hljs-type">int</span></span>)) == <span class="hljs-number"><span class="hljs-number">-1</span></span>) fatal("   SO_REUSEADDR"); printf("  tiny web.\n"); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(daemon(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) == <span class="hljs-number"><span class="hljs-number">-1</span></span>) //    fatal("   "); signal(SIGTERM, handle_shutdown);   //    handle_shutdown signal(SIGINT, handle_shutdown);   //    handle_shutdown <span class="hljs-type"><span class="hljs-type">timestamp</span></span>(logfd); <span class="hljs-keyword"><span class="hljs-keyword">write</span></span>(logfd, ".\n", <span class="hljs-number"><span class="hljs-number">15</span></span>); host_addr.sin_family = AF_INET;       //    host_addr.sin_port = htons(PORT);     //  ,    host_addr.sin_addr.s_addr = INADDR_ANY; //    IP memset(&amp;(host_addr.sin_zero), <span class="hljs-string"><span class="hljs-string">'\0'</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>); //    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (bind(sockfd, (struct sockaddr *)&amp;host_addr, sizeof(struct sockaddr)) == <span class="hljs-number"><span class="hljs-number">-1</span></span>) fatal("  "); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">listen</span></span>(sockfd, <span class="hljs-number"><span class="hljs-number">20</span></span>) == <span class="hljs-number"><span class="hljs-number">-1</span></span>) fatal("   "); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(<span class="hljs-number"><span class="hljs-number">1</span></span>) { //   accept sin_size = sizeof(struct sockaddr_in); new_sockfd = accept(sockfd, (struct sockaddr *)&amp;client_addr, &amp;sin_size); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(new_sockfd == <span class="hljs-number"><span class="hljs-number">-1</span></span>) fatal(" "); handle_connection(new_sockfd, &amp;client_addr, logfd); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>; } <span class="hljs-comment"><span class="hljs-comment">/*         *         FD. *    -,    *   .     . */</span></span> <span class="hljs-type"><span class="hljs-type">void</span></span> handle_connection(<span class="hljs-type"><span class="hljs-type">int</span></span> sockfd, struct sockaddr_in *client_addr_ptr, <span class="hljs-type"><span class="hljs-type">int</span></span> logfd) { unsigned <span class="hljs-type"><span class="hljs-type">char</span></span> *ptr, request[<span class="hljs-number"><span class="hljs-number">500</span></span>], resource[<span class="hljs-number"><span class="hljs-number">500</span></span>], log_buffer[<span class="hljs-number"><span class="hljs-number">500</span></span>]; <span class="hljs-type"><span class="hljs-type">int</span></span> fd, length; length = recv_line(sockfd, request); sprintf(log_buffer, " %s:%d \"%s\"\t", inet_ntoa(client_addr_ptr-&gt;sin_addr), ntohs(client_addr_ptr-&gt;sin_port), request); ptr = strstr(request, " HTTP/"); //    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(ptr == <span class="hljs-keyword"><span class="hljs-keyword">NULL</span></span>) { //    HTTP  strcat(log_buffer, "  HTTP!\n"); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { *ptr = <span class="hljs-number"><span class="hljs-number">0</span></span>; //      URL ptr = <span class="hljs-keyword"><span class="hljs-keyword">NULL</span></span>; //  ptr  <span class="hljs-keyword"><span class="hljs-keyword">NULL</span></span> (           //  ) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(strncmp(request, "GET ", <span class="hljs-number"><span class="hljs-number">4</span></span>) == <span class="hljs-number"><span class="hljs-number">0</span></span>) //  <span class="hljs-keyword"><span class="hljs-keyword">GET</span></span> ptr = request+<span class="hljs-number"><span class="hljs-number">4</span></span>; // ptr -  URL <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(strncmp(request, "HEAD ", <span class="hljs-number"><span class="hljs-number">5</span></span>) == <span class="hljs-number"><span class="hljs-number">0</span></span>) //  HEAD ptr = request+<span class="hljs-number"><span class="hljs-number">5</span></span>; // ptr -  URL <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(ptr == <span class="hljs-keyword"><span class="hljs-keyword">NULL</span></span>) { //     strcat(log_buffer, "  !\n"); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { //    ptr,     <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ptr[strlen(ptr) - <span class="hljs-number"><span class="hljs-number">1</span></span>] == <span class="hljs-string"><span class="hljs-string">'/'</span></span>)   //  ,                                        //  <span class="hljs-string"><span class="hljs-string">'/'</span></span>, strcat(ptr, "index.html");   //    <span class="hljs-string"><span class="hljs-string">'index.html'</span></span> strcpy(resource, WEBROOT);   //  resource                                            //  strcat(resource, ptr);   //      fd = <span class="hljs-keyword"><span class="hljs-keyword">open</span></span>(resource, O_RDONLY, <span class="hljs-number"><span class="hljs-number">0</span></span>);  //    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(fd == <span class="hljs-number"><span class="hljs-number">-1</span></span>) { //     strcat(log_buffer, " 404 Not Found\n");           send_string(sockfd, "HTTP/1.0 404 NOT FOUND\r\n");                send_string(sockfd, "Server: Tiny webserver\r\n\r\n");                send_string(sockfd, "&lt;html&gt;&lt;head&gt;&lt;title&gt;404 Not Found&lt;/title&gt;                                     &lt;/head&gt;");            send_string(sockfd, "&lt;body&gt;&lt;h1&gt;URL not found&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;                                     \r\n"); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> {       //      strcat(log_buffer, " 200 OK\n");             send_string(sockfd, "HTTP/1.0 200 OK\r\n");           send_string(sockfd, "Server: Tiny webserver\r\n\r\n");            <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(ptr == request + <span class="hljs-number"><span class="hljs-number">4</span></span>) { //    <span class="hljs-keyword"><span class="hljs-keyword">GET</span></span>     <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( (length = get_file_size(fd)) == <span class="hljs-number"><span class="hljs-number">-1</span></span>)          fatal("     ");     <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( (ptr = (unsigned <span class="hljs-type"><span class="hljs-type">char</span></span> *) malloc(length)) == <span class="hljs-keyword"><span class="hljs-keyword">NULL</span></span>)          fatal("      ");          <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>(fd, ptr, length);  //              send(sockfd, ptr, length, <span class="hljs-number"><span class="hljs-number">0</span></span>);  //              free(ptr);  //      } <span class="hljs-keyword"><span class="hljs-keyword">close</span></span>(fd); //   } //   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>  /        } //   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>     } //   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>    HTTP <span class="hljs-type"><span class="hljs-type">timestamp</span></span>(logfd); length = strlen(log_buffer); <span class="hljs-keyword"><span class="hljs-keyword">write</span></span>(logfd, log_buffer, length); //    shutdown(sockfd, SHUT_RDWR); //    } <span class="hljs-comment"><span class="hljs-comment">/*         *    .    -1. */</span></span> <span class="hljs-type"><span class="hljs-type">int</span></span> get_file_size(<span class="hljs-type"><span class="hljs-type">int</span></span> fd) { struct stat stat_struct; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(fstat(fd, &amp;stat_struct) == <span class="hljs-number"><span class="hljs-number">-1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">-1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (<span class="hljs-type"><span class="hljs-type">int</span></span>) stat_struct.st_size; } <span class="hljs-comment"><span class="hljs-comment">/*          *   . */</span></span> <span class="hljs-type"><span class="hljs-type">void</span></span> <span class="hljs-type"><span class="hljs-type">timestamp</span></span>(fd) { time_t now; struct tm *time_struct; <span class="hljs-type"><span class="hljs-type">int</span></span> length; <span class="hljs-type"><span class="hljs-type">char</span></span> time_buffer[<span class="hljs-number"><span class="hljs-number">40</span></span>]; <span class="hljs-type"><span class="hljs-type">time</span></span>(&amp;now); //       time_struct = <span class="hljs-built_in"><span class="hljs-built_in">localtime</span></span>((const time_t *)&amp;now); //    tm length = strftime(time_buffer, <span class="hljs-number"><span class="hljs-number">40</span></span>, "%m/%d/%Y %H:%M:%S&gt; ", time_struct); <span class="hljs-keyword"><span class="hljs-keyword">write</span></span>(fd, time_buffer, length); //       }</code> </pre> <br>  Ce programme cr√©e un processus en double qui s'ex√©cute en arri√®re-plan, √©crit dans le fichier journal avec les horodatages et se termine correctement apr√®s avoir re√ßu le signal correspondant.  Le descripteur de fichier journal et le socket acceptant la connexion sont d√©clar√©s en tant que variables globales afin que la fonction handle_shutdown () puisse terminer leur travail correctement.  Il est d√©fini comme un gestionnaire de rappel pour les signaux d'ach√®vement et d'interruption, ce qui garantit que le programme est termin√© par la commande kill. <br><br>  Voici le r√©sultat de la compilation, de l'ex√©cution et de l'ach√®vement du programme.  Faites attention aux horodatages dans le journal et au message de fin qui est apparu apr√®s que le programme a re√ßu le signal correspondant et a appel√© la fonction handle_shutdown (). <br><br><pre> <code class="hljs ruby">reader@hacking<span class="hljs-symbol"><span class="hljs-symbol">:~/booksrc</span></span> $ gcc -o tinywebd tinywebd.c reader@hacking<span class="hljs-symbol"><span class="hljs-symbol">:~/booksrc</span></span> $ sudo chown root ./tinywebd reader@hacking<span class="hljs-symbol"><span class="hljs-symbol">:~/booksrc</span></span> $ sudo chmod u+s ./tinywebd reader@hacking<span class="hljs-symbol"><span class="hljs-symbol">:~/booksrc</span></span> $ ./tinywebd   tiny web. reader@hacking<span class="hljs-symbol"><span class="hljs-symbol">:~/booksrc</span></span> $ ./webserver_id <span class="hljs-number"><span class="hljs-number">127.0</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span> The web server <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-number"><span class="hljs-number">127.0</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span> is Tiny webserver reader@hacking<span class="hljs-symbol"><span class="hljs-symbol">:~/booksrc</span></span> $ ps ax <span class="hljs-params"><span class="hljs-params">| grep tinywebd 25058 ? Ss 0:00 ./tinywebd 25075 pts/3 R+ 0:00 grep tinywebd reader@hacking:~/booksrc $ kill 25058 reader@hacking:~/booksrc $ ps ax |</span></span> grep tinywebd <span class="hljs-number"><span class="hljs-number">25121</span></span> pts/<span class="hljs-number"><span class="hljs-number">3</span></span> R+ <span class="hljs-number"><span class="hljs-number">0</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">00</span></span> grep tinywebd reader@hacking<span class="hljs-symbol"><span class="hljs-symbol">:~/booksrc</span></span> $ cat /var/log/tinywebd.log <span class="hljs-symbol"><span class="hljs-symbol">cat:</span></span> /var/log/tinywebd.<span class="hljs-symbol"><span class="hljs-symbol">log:</span></span> Permission denied reader@hacking<span class="hljs-symbol"><span class="hljs-symbol">:~/booksrc</span></span> $ sudo cat /var/log/tinywebd.log <span class="hljs-number"><span class="hljs-number">07</span></span>/<span class="hljs-number"><span class="hljs-number">22</span></span>/<span class="hljs-number"><span class="hljs-number">2007</span></span> <span class="hljs-number"><span class="hljs-number">17</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">55</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">45</span></span>&gt; . <span class="hljs-number"><span class="hljs-number">07</span></span>/<span class="hljs-number"><span class="hljs-number">22</span></span>/<span class="hljs-number"><span class="hljs-number">2007</span></span> <span class="hljs-number"><span class="hljs-number">17</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">57</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">00</span></span>&gt;  <span class="hljs-number"><span class="hljs-number">127.0</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">38127</span></span> <span class="hljs-string"><span class="hljs-string">"HEAD / HTTP/1.0"</span></span> <span class="hljs-number"><span class="hljs-number">200</span></span> OK <span class="hljs-number"><span class="hljs-number">07</span></span>/<span class="hljs-number"><span class="hljs-number">22</span></span>/<span class="hljs-number"><span class="hljs-number">2007</span></span> <span class="hljs-number"><span class="hljs-number">17</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">57</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">21</span></span>&gt;  . reader@hacking<span class="hljs-symbol"><span class="hljs-symbol">:~/booksrc</span></span> $</code> </pre> <br>  Le nouveau programme tinywebd traite le contenu HTTP, comme le tinyweb d'origine, mais se comporte comme un d√©mon syst√®me car il n'a pas de terminal de contr√¥le et la sortie est vers un fichier journal.  Les deux programmes sont vuln√©rables au m√™me d√©bordement de tampon - mais ce n'est que le d√©but de cette vuln√©rabilit√©.  Maintenant que nous avons choisi tinywebd comme cible de l'attaque, je vais vous montrer comment √©viter la d√©tection apr√®s √™tre entr√© sur une autre machine. <br><br>  ¬ªPlus d'informations sur le livre sont disponibles sur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">le site Web de l'√©diteur</a> <br>  ¬ª <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Contenu</a> <br>  ¬ª <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Extrait</a> <br><br>  20% de r√©duction sur le coupon pour Habrozhitel - <b>Hacking</b> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr413989/">https://habr.com/ru/post/fr413989/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr413977/index.html">Cr√©ation d'un syst√®me de protection antivirus √©tendu pour une petite entreprise. 3e partie</a></li>
<li><a href="../fr413979/index.html">Mitap "Comment g√©rer des guildes et des communaut√©s?" de Tutu.ru et AgileVerse</a></li>
<li><a href="../fr413981/index.html">Security Week 21: des centaines de vuln√©rabilit√©s Adobe Flash</a></li>
<li><a href="../fr413983/index.html">√âvaluation de Cavium ThunderX2: le r√™ve du serveur Arm se r√©alise (partie 3)</a></li>
<li><a href="../fr413987/index.html">Poudlard rouge. S√©rie 7. √âtudiants</a></li>
<li><a href="../fr413991/index.html">Corrigez-moi si vous le pouvez: comment nous d√©boguons sur la production. 2e partie</a></li>
<li><a href="../fr413995/index.html">Conf√©rences techniques pour nous-m√™mes: notre exp√©rience, nos erreurs et nos r√©alisations</a></li>
<li><a href="../fr413997/index.html">Processeurs Intel 32 bits: 3 √† 4 - Vendredi long inutile</a></li>
<li><a href="../fr413999/index.html">Ce qui s'est pass√© avec la tarification du cloud ces derni√®res ann√©es</a></li>
<li><a href="../fr414001/index.html">Comment survivre dans un monde en d√©veloppement en √©volution</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>