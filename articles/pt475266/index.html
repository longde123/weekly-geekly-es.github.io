<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚úÖ üè™ üßëüèø‚Äçü§ù‚Äçüßëüèª Revertemos 1s m√≥veis no Android. Como adicionar um pouco de funcionalidade e abandonar algumas noites üí™ üõ∏ üë©‚Äçüé®</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Devo dizer imediatamente que, apesar do t√≠tulo alto do artigo, como algu√©m poderia pensar, n√£o haver√° nenhum hardcore direto. Al√©m disso, apesar do fa...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Revertemos 1s m√≥veis no Android. Como adicionar um pouco de funcionalidade e abandonar algumas noites</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/475266/"><p>  Devo dizer imediatamente que, apesar do t√≠tulo alto do artigo, como algu√©m poderia pensar, n√£o haver√° nenhum hardcore direto.  Al√©m disso, apesar do fato de a revers√£o estar frequentemente associada √† seguran√ßa da informa√ß√£o, novamente n√£o haver√° nada assim, porque n√£o havia necessidade de ignorar nenhuma prote√ß√£o (com exce√ß√£o de uma pequena minifica√ß√£o).  N√£o h√° nenhum deles.  O Mobile 1s √© um produto gratuito no qual n√£o h√° cheques, prote√ß√µes e fun√ß√µes pagas. </p><br><p>  Portanto, apelo para aqueles que esperam ver o uso de desofuscadores, o uso do Frida / Xposed, outro software complicado - voc√™ n√£o encontrar√° nada interessante para si.  Aqui vamos usar apenas apktool, baksmali, apksigner, adb, jadx, console, editor de texto, javac, d8 e tudo. </p><br><p> Tamb√©m quero decepcionar antecipadamente aqueles que aguardavam uma an√°lise profunda da plataforma ou sua forte modifica√ß√£o.  Apenas pequenas edi√ß√µes ser√£o feitas em apenas alguns arquivos e, na verdade, mesmo esses poucos arquivos que eu n√£o fiz completamente, todos no topo. </p><a name="habracut"></a><br><h1 id="s-chego-vse-nachalos">  Como tudo come√ßou </h1><br><p>  Vou falar um pouco sobre por que de repente tive a ideia de entrar no celular por 1s.  No momento, estou desenvolvendo nativamente o Android h√° um ano, mas antes trabalhei como programador por 4 anos e, no √∫ltimo ano e meio, trabalhamos especificamente com a plataforma m√≥vel.  Apesar de ter atendido √†s necessidades b√°sicas, ela tamb√©m teve muitos desvantagens (al√©m da linguagem de programa√ß√£o).  Em particular, era imposs√≠vel incorporar humanamente qualquer biblioteca externa, pelo menos por meios regulares e com nosso estoque de conhecimento.  Tudo tamb√©m foi muito triste, por exemplo, com a funcionalidade de exibir etiquetas em um mapa.  Toda a possibilidade de sua configura√ß√£o era especificar texto para etiquetas quando voc√™ as toca.  Naquela √©poca, a √∫nica maneira de contornar isso era usar o objeto especial ‚ÄúHTML Document Field‚Äù, mas havia problemas com ele.  No momento em que trabalhei com 1s, todo o meu conhecimento no desenvolvimento nativo para Android estava em um par HelloWorld, ent√£o nem pensei em reverter o telefone celular com 1s, n√£o resolvemos v√°rias perguntas dos clientes com a extens√£o n√£o padr√£o de 1s ou vimos nativas muito simples os aplicativos que foram colocados pr√≥ximos a ele e integrados de maneira obl√≠qua / obl√≠qua com 1s (e o contrato de licen√ßa 1s parece proibir edi√ß√µes na pr√≥pria plataforma). </p><br><p>  Portanto, a primeira raz√£o para fazer a revers√£o 1c foi o interesse e o que posso fazer com a base de conhecimento atual.  Devo dizer imediatamente que a experi√™ncia do desenvolvimento nativo n√£o foi dizer o que √© necess√°rio; no trabalho cotidiano, quase nada do que ser√° descrito abaixo n√£o √© encontrado.  Portanto, em princ√≠pio, provavelmente qualquer 1snik m√©dio sentado por v√°rios dias / semanas seria capaz de descobrir tudo. </p><br><p>  A segunda raz√£o √© que eu s√≥ queria escolher o apk de outras pessoas, porque antes eu estava perdendo essa camada bastante ampla de conhecimento e, como eu tinha que come√ßar em algum lugar, ocorreu-me apenas 1s. </p><br><h1 id="pervye-shagi">  Primeiros passos </h1><br><p>  A primeira coisa que fiz, mesmo quando a ideia de reverter 1s vagou vagamente na minha cabe√ßa, simplesmente arrastei o arquivo apk do aplicativo para a janela do AndroidStudio com o mouse.  Quero dizer imediatamente que fiquei um pouco triste, porque a maior parte do c√≥digo 1c est√° escrita em C ++ e est√° em bibliotecas .so, e √© mais dif√≠cil revert√™-las, e isso n√£o foi interessante.  Mas o arquivo classes.dex chamou minha aten√ß√£o completamente, especialmente porque seu tamanho modesto me deu a oportunidade de supor que seria f√°cil revert√™-lo.  Em geral, ficou assim.  A prop√≥sito, uma conseq√º√™ncia interessante do fato de que a maior parte do c√≥digo em C ++ √© que muitos m√©todos e classes evitaram o processamento com o ProGuard.  √â dif√≠cil fazer uma interoperabilidade com um c√≥digo minificado;). </p><br><div class="spoiler">  <b class="spoiler_title">Aqui est√° o que eu vi na janela do est√∫dio (desmontou a vers√£o x86 para trabalhar com o emulador e n√£o com o dispositivo real)</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/ry/dx/6l/rydx6lnrt7oix0nqa63bftv2-8y.png"></p></div></div><br><p>  Como voc√™ pode ver na captura de tela acima, o aplicativo dificilmente foi minificado (em termos de renomea√ß√£o de classes e m√©todos).  Al√©m disso, voc√™ pode ver que h√° muito pouco c√≥digo em java e, portanto, as bibliotecas ocupam quase todo o espa√ßo. </p><br><p>  Depois de empurrar a lista de classes por algum tempo, vi uma curiosa classe MapImpl, que desconfia que foi ele quem foi respons√°vel por uma situa√ß√£o t√£o triste com a personaliza√ß√£o da exibi√ß√£o de r√≥tulos. </p><br><div class="spoiler">  <b class="spoiler_title">Estrutura MapImpl</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/ya/rl/xh/yarlxho_dqjalx6euv2g57bddn8.png"></p></div></div><br><p>  A lista de m√©todos e suas assinaturas inspirou a esperan√ßa de que tudo seria muito simples, e eu decidi examinar o c√≥digo smali, ap√≥s o qual fiquei muito tenso e fui ler a lista de comandos smali e como ler / escrever.  No entanto, foi nesse ponto que decidi que o assunto promete ser simples e de vida curta e, portanto, aqui est√°, uma ocasi√£o para brincar com a invers√£o.  Tendo decidido dedicar algumas noites a isso (qu√£o cruelmente eu estava enganado), fui para a cama com uma alma calma. </p><br><h1 id="stroyu-plany">  Fazendo planos </h1><br><p>  Depois de acordar de manh√£, decidi que, at√© o momento, nunca havia me envolvido em substituir recursos em aplicativos, n√£o como mudan√ßas na l√≥gica, n√£o tinha nada para me enganar imediatamente ao substituir a atividade por um cart√£o, era melhor abordar a solu√ß√£o do problema com pequenas etapas.  Depois disso, fiz uma pequena lista de etapas que deveriam me levar ao ponto final da minha jornada na forma de uma plataforma m√≥vel funcional com minhas edi√ß√µes.  Essa lista era a seguinte: </p><br><ol><li>  Prepare a configura√ß√£o 1c para a plataforma m√≥vel, cuja funcionalidade √© exibir dois r√≥tulos no mapa. </li><li>  Descompacte o apk da plataforma m√≥vel, fa√ßa as malas sem altera√ß√µes, verifique se a configura√ß√£o est√° funcionando. </li><li>  Fa√ßa pequenas altera√ß√µes nos arquivos smali que n√£o mudam quase nada, mas que podem ser vistas nos logs ou alteram a l√≥gica do trabalho, monte e certifique-se de que funcione. </li><li>  Para ultrapassar a atividade smali com um mapa em java ou gravar atividade com a mesma interface, substitua a atividade no aplicativo sem alterar a funcionalidade.  Como alternativa, se o primeiro for muito pregui√ßoso ou complicado, escreva uma classe que far√° parte do trabalho do MapImpl e adicione uma chamada aos seus m√©todos no smali MapImpl. </li><li>  Escreva este artigo (h√° muito tempo eu queria escrever algo, mas outras id√©ias ainda est√£o surgindo na minha cabe√ßa, mas ent√£o parecia que esse era finalmente um t√≥pico bastante interessante) </li></ol><br><p>  Bem, pelo menos no primeiro par√°grafo n√£o tive problemas.  Eu baixei a vers√£o educacional gratuita da plataforma, baixei a plataforma m√≥vel, implantei tudo no meu computador (1C, voc√™ j√° possui a vers√£o educacional para linux, s√≥ tenho outro impulso para sair do Windows e agora tenho que trabalhar nela).  A configura√ß√£o √© muito simples, na inicializa√ß√£o, ele chama a fun√ß√£o ShowOnMap (), que transmite dois pontos no mapa.  S√≥ isso. </p><br><p>  Mas com o segundo ponto, ficou mais triste por causa do meu analfabetismo.  Mas o que houve, os problemas estavam com todos os pontos, exceto o primeiro. </p><br><h1 id="perepakovyvayu-prilozhenie-bez-izmeneniy-koda">  Reempacoto o aplicativo sem alterar o c√≥digo </h1><br><p>  O Google imediatamente me disse que existe uma excelente ferramenta apktool que permite literalmente dois comandos analisar o apk em arquivos .smali e mont√°-los novamente.  Eu decidi us√°-lo.  Descompactei o apk com o seguinte comando (a seguir, apesar de, √†s vezes, fazer parte do trabalho no linux, darei todos os comandos para o windows): </p><br><pre><code class="plaintext hljs">apktool.bat d .\sourceApk\1cem-x86.apk -o .\build\unpacked</code> </pre> <br><p>  e conseguiu o diret√≥rio descompactado no qual havia um monte de arquivos, para trabalhar com eles no futuro.  Apk embalado de volta com o comando </p><br><pre> <code class="plaintext hljs">apktool.bat b .\build\unpacked -o .\build\1cem-x86.apk</code> </pre> <br><p>  Tentando instal√°-lo em um emulador </p><br><pre> <code class="plaintext hljs">adb install .\build\1cem-x86.apk</code> </pre> <br><p>  Eu recebi o seguinte erro: </p><br><pre> <code class="plaintext hljs">Performing Streamed Install adb: failed to install .\build\1cem-x86.apk: Failure [INSTALL_PARSE_FAILED_NO_CERTIFICATES: Failed to collect certificates from /data/app/vmdl1115375036.tmp/base.apk: Attempt to get length of null array]</code> </pre> <br><p>  Em geral, era necess√°rio prestar mais aten√ß√£o √† base.  Obviamente, eu sabia que existem assinaturas e que elas s√£o divididas em vendas e lan√ßamentos, mas n√£o sabia que os aplicativos n√£o s√£o instalados sem assinaturas.  Decidi usar minha assinatura de d√©bito e assinar a equipe do apk </p><br><pre> <code class="plaintext hljs">apksigner.bat sign --ks C:\Users\neikist\.android\debug.keystore .\build\1cem-x86.apk</code> </pre> <br><p>  Eu consegui executar o aplicativo.  √â verdade que em vez de um mapa com dois pontos, uma tela cinza com uma assinatura do Google abaixo estava esperando por mim.  Depois de riscar o nabo, decidi que o fato √© que a chave do Google maps do 1s √© usada, o que n√£o funciona com a minha assinatura.  Portanto, indo ao console do desenvolvedor no site do google, criei um novo projeto para trabalhar com a API do google maps no android, recebi uma chave da api, especificada em res / values ‚Äã‚Äã/ strings.xml na linha google_maps_key, e tamb√©m adicionei minha chave de compartilhamento √†s permiss√µes do projeto .  Eu reembalei e reescrevi o apk, o iniciei e, finalmente, tudo funcionou novamente. </p><br><h1 id="dobavlyayu-svoi-logi">  Eu adiciono meus logs </h1><br><p>  A pr√≥xima coisa que eu queria fazer era automatizar o lan√ßamento do aplicativo e adicionar a configura√ß√£o 1c √† plataforma.  Manualmente, ap√≥s cada edi√ß√£o, isso ainda seria uma bagun√ßa. </p><br><p>  No come√ßo, pesquisei no Google e tentei usar os utilit√°rios jadx ou dex2jar, para n√£o incomodar a leitura de smali, mas para ler o c√≥digo java mais familiar, mas por algum motivo eles n√£o funcionaram (mais tarde, o jadx conseguiu entrar em algum tipo de xamanismo).  Eu tive que desmontar o smali, pois acabou n√£o sendo t√£o terr√≠vel quanto eu tinha medo. </p><br><p>  Para entender como a plataforma m√≥vel recebe um comando da plataforma de desktop para iniciar a configura√ß√£o ao se conectar via adb, decidi examinar os pontos de entrada do aplicativo e adicionar sa√≠da aos logs de inten√ß√µes e outras informa√ß√µes √∫teis.  Decidi come√ßar com o aplicativo ( <code>com.e1c.mobile.E1cApplication</code> ) e a atividade com <code>android.intent.action.MAIN</code> no filtro de inten√ß√£o ( <code>com.e1c.mobile.App</code> ).  Tamb√©m estava interessado em <code>com.e1c.mobile.Starter</code> com um filtro de inten√ß√£o interessante em <code>com.e1c.mobile.START_TEMPLATE</code> e <code>com.e1c.mobile.START_CMD</code> .  √â muito semelhante ao fato de ele aceitar inten√ß√µes com os comandos 1s, e √© ele quem inicia a configura√ß√£o a partir do modelo. </p><br><p>  Infelizmente, n√£o encontrei nada de interessante no <code>E1cApplication</code> , tudo o que acontece √© instalar o manipulador em caches. </p><br><p>  Mas nas outras duas classes, <code>Starter</code> e <code>App</code> , havia muito mais informa√ß√µes e isso acabou sendo bastante √∫til.  O <code>App.onCreate(Landroid/os/Bundle;)V</code> √© bastante grande, por isso n√£o o darei por inteiro, apenas as partes que me interessam. </p><br><div class="spoiler">  <b class="spoiler_title">Fatia do m√©todo onCreate do aplicativo</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">invoke-virtual {p0}, Lcom/e1c/mobile/App;-&gt;getIntent()Landroid/content/Intent; #     p1 move-result-object p1 new-instance v0, Ljava/lang/StringBuilder; invoke-direct {v0}, Ljava/lang/StringBuilder;-&gt;&lt;init&gt;()V invoke-virtual {v0, p0}, Ljava/lang/StringBuilder;-&gt;append(Ljava/lang/Object;)Ljava/lang/StringBuilder; const-string v1, ".onCreate() " invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;-&gt;append(Ljava/lang/String;)Ljava/lang/StringBuilder; invoke-virtual {v0, p1}, Ljava/lang/StringBuilder;-&gt;append(Ljava/lang/Object;)Ljava/lang/StringBuilder; invoke-virtual {v0}, Ljava/lang/StringBuilder;-&gt;toString()Ljava/lang/String; move-result-object v0 # ,  ? invoke-static {v0}, Lcom/e1c/mobile/Utils;-&gt;V(Ljava/lang/String;)V</code> </pre> </div></div><br><p>  Pode ser visto na se√ß√£o de c√≥digo acima que o aplicativo recebe a inten√ß√£o, coloca um link para ele no registro <code>p1</code> , anexa a <code>StringBuilder</code> ao nome e m√©todo da classe via <code>StringBuilder</code> e passa <code>V(Ljava/lang/String;)V</code> da classe <code>Utils</code> para o m√©todo est√°tico.  Aparentemente, algum tipo de seu pr√≥prio logger.  Depois disso, a inten√ß√£o √© verificada para obter dados adicionais e, se dispon√≠vel, <code>Uri</code> obtido a partir dela, a partir da qual, por sua vez, uma sequ√™ncia √© obtida pelo m√©todo <code>getQuery()</code> e passada para a classe <code>Starter</code> .  N√£o vi nenhum estudo adicional sobre o <code>onCreate</code> , dei uma olhada e verifiquei se as a√ß√µes eram bastante padr√£o.  A menos que a exibi√ß√£o pare√ßa ser criada programaticamente por uma classe completamente diferente, em vez de usar o <code>LayoutInflater</code> , mas eu n√£o me aprofundava muito, ent√£o tudo √© poss√≠vel e n√£o como eu pensava.  A pr√≥xima aula para onde eu fui √© <code>Starter</code> .  Felizmente, ele foi mencionado no ativismo e me interessou no manifesto. </p><br><p>  Infelizmente, o m√©todo que foi chamado a partir da atividade acabou sendo nativo ( <code>.method static native startCmd(Ljava/lang/String;)V</code> ), portanto prestei aten√ß√£o no m√©todo <code>onRecieve</code> (no qual o aplicativo aceita os eventos nos quais est√° inscrito).  N√£o vou dar o c√≥digo, estava interessado nele que a inten√ß√£o tamb√©m √© registrada usando o m√©todo <code>V(Ljava/lang/String;)V</code> da classe <code>Utils</code> .  Acontece que basta adicionar um pouco de c√≥digo smali a esse m√©todo - e eu receberei meus logs nos locais nos quais os desenvolvedores da plataforma pretendiam.  Indo para a classe Utils, vi imediatamente 2 m√©todos vazios, V e W. Aparentemente, eles est√£o vazios porque, ao compilar a vers√£o de lan√ßamento, eles foram cortados.  Acabei de adicionar um registro da sequ√™ncia passada ao <code>android.utils.Log</code> padr√£o.  Para fazer isso, altere o n√∫mero de registros locais necess√°rios de 0 para 1 (para a linha de tag), coloque essa sequ√™ncia no registro <code>v0</code> e tamb√©m registrou a chamada nos m√©todos <code>Log</code> </p><br><div class="spoiler">  <b class="spoiler_title">Implementa√ß√£o dos m√©todos W e V</b> <div class="spoiler_text"><pre> <code class="plaintext hljs"> .method public static V(Ljava/lang/String;)V .locals 1 const-string v0, "neikist_V" invoke-static {v0, p0}, Landroid/util/Log;-&gt;v(Ljava/lang/String;Ljava/lang/String;)I return-void .end method .method public static W(Ljava/lang/String;)V .locals 1 const-string v0, "neikist_W" invoke-static {v0, p0}, Landroid/util/Log;-&gt;w(Ljava/lang/String;Ljava/lang/String;)I return-void .end method</code> </pre> </div></div><br><p>  Lancei o celular a partir do 1s 1s desktop e recebi os seguintes logs </p><br><div class="spoiler">  <b class="spoiler_title">Resultados do Lan√ßamento</b> <div class="spoiler_text"><pre> <code class="plaintext hljs"> 2019-10-25 19:21:31.537 29960-29960/? V/neikist_V: com.e1c.mobile.Starter@139df1c.onReceive( android.app.ReceiverRestrictedContext@346b725, Intent { act=com.e1c.mobile.START_TEMPLATE flg=0x400010 cmp=com.e1c.mobile/.Starter (has extras) } ) 2019-10-25 19:21:31.537 29960-29960/? V/neikist_V: context.getPackageName() = com.e1c.mobile 2019-10-25 19:21:31.537 29960-29960/? V/neikist_V: intent.getAction() = com.e1c.mobile.START_TEMPLATE 2019-10-25 19:21:31.537 29960-29960/? V/neikist_V: App.sActivity = null 2019-10-25 19:21:31.537 29960-29960/? V/neikist_V: templatePath = /sdcard/Download/mobilegeoMA/1cema.xml 2019-10-25 19:21:31.537 29960-29960/? V/neikist_V: debugUrl = tcp://127.0.0.1:1560 2019-10-25 19:21:42.216 29960-29960/com.e1c.mobile V/neikist_V: com.e1c.mobile.App@423609b.onCreate() Intent { act=android.intent.action.MAIN cat=[android.intent.category.LAUNCHER] flg=0x10200000 cmp=com.e1c.mobile/.App bnds=[35,252][237,505] } 2019-10-25 19:21:42.651 29960-29960/com.e1c.mobile V/neikist_V: com.e1c.mobile.App$4@4c70381.run() adMobAppId = ca-app-pub-3940256099942544~3347511713 2019-10-25 19:21:42.687 29960-30009/com.e1c.mobile V/neikist_V: App.requestPermission() shouldShowRequestPermissionRationale = false 2019-10-25 19:21:46.138 29960-30009/com.e1c.mobile V/neikist_V: App.isLowBattery() sLastBatteryPercent = 1.0</code> </pre> </div></div><br><p>  Como voc√™ pode ver, h√° todas as informa√ß√µes necess√°rias para automatizar o lan√ßamento do aplicativo por meio do adb.  √â verdade que, nesse ponto, peguei um rosto palpado duplo.  Primeiramente, finalmente peguei as chaves com as quais o jadx dominava a tradu√ß√£o em java (√© claro que eu teria que escrever em smali de qualquer maneira, mas ainda assim).  E o segundo facespalm acabou sendo o fato de que eu percebi que estava atormentando a plataforma do desenvolvedor em v√£o (necess√°ria apenas para o desenvolvimento e a depura√ß√£o de configura√ß√µes), seria mais correto reverter a compila√ß√£o do release dos aplicativos 1s e existem projetos gradle semi-prontos para montagem, h√° um arquivo com uma lista de depend√™ncias e outros p√£es.  Fiquei um pouco triste com isso - e ainda decidi terminar o que comecei.  Enfim, pelo bem do f√£, estou fazendo tudo isso, e n√£o pelo benef√≠cio pr√°tico. </p><br><h1 id="zapusk-platformy-cherez-adb">  Lan√ßamento da plataforma atrav√©s do adb </h1><br><p>  Decidi automatizar a instala√ß√£o e iniciar o aplicativo adb usando gradle.  De qualquer forma, naquela √©poca, eu j√° tinha uma pequena lista de shuffles gravados (descompactando, copiando recursos modificados e arquivos smali para o diret√≥rio com o aplicativo descompactado, empacotamento, assinatura, de fato, todas as tarefas s√£o apenas corredores para os comandos do console).  Nas tarefas existentes, foram adicionados os seguintes comandos </p><br><pre> <code class="plaintext hljs"> adb install ./build/1cem-x86.apk adb shell pm grant com.e1c.mobile android.permission.READ_EXTERNAL_STORAGE adb push src/1cConfiguration /storage/emulated/0/Download adb shell am start -n com.e1c.mobile/.App -a android.intent.action.MAIN -c android.intent.category.LAUNCHER adb shell am broadcast -n com.e1c.mobile/.Starter -a com.e1c.mobile.START_TEMPLATE -e templatepath /storage/emulated/0/Download/1cConfiguration/1cema.xml</code> </pre> <br><p>  Pela sequ√™ncia de comandos acima, instalamos o apk, concedemos ao aplicativo instalado permiss√£o para ler o disco, copia a configura√ß√£o 1s para o dispositivo e comandos para iniciar 1s e carregar a configura√ß√£o.  Isso n√£o funciona a prop√≥sito em todas as vers√µes do Android, mas eu testei na API 28 e, portanto, essa sequ√™ncia faz tudo corretamente.  Nas vers√µes mais novas, pode haver problemas com a emiss√£o de direitos. </p><br><h1 id="vnedryayus-v-obrabotku-dannyh-ot-1s-i-modificiruyu-metki">  Estou envolvido no processamento de dados de 1s e modifico tags </h1><br><p>  Aqui eu tinha v√°rias op√ß√µes para o desenvolvimento futuro de eventos. </p><br><ol><li>  Eu domino diretamente o MapImpl.smali, que prometeu ser uma tarefa bastante dif√≠cil, considerando que a biblioteca para trabalhar com o Google Maps √© minimamente seriamente reduzida, e eu teria que escrever tudo na sintaxe smali. </li><li>  Uso o arquivo MapImpl.java obtido gra√ßas ao jadx, fa√ßo altera√ß√µes nele, uso as classes que utilizo para substitu√≠-lo por stubs, destilar em smali, substituir o arquivo e compact√°-lo.  A op√ß√£o me pareceu tensa, pois realmente do√≠a ter muitos plugues, al√©m de alguns problemas que eu n√£o queria escolher. </li><li>  Combino as abordagens 1 e 2, insiro as chamadas de uma classe de extens√£o especial MapImplExtenstion.java no c√≥digo smali que estende uma parte da l√≥gica - como resultado, escolhi essa op√ß√£o, simplesmente porque √© mais simples que a primeira e a segunda op√ß√µes e me pareceu um pouco mais complicada do que a op√ß√£o 4, mas menos trabalhoso (sim, sonho, ing√™nuo). </li><li>  Em geral, substitua o Google Maps por outra coisa, por exemplo, Yandex.  Para fazer todo o trabalho em outro projeto, simplesmente repetindo as assinaturas MapImpl, minimize a descompacta√ß√£o e solte os arquivos smali finalizados antes de compactar o aplicativo nos locais apropriados.  N√£o h√° problemas com bibliotecas minificadas, mas eu precisaria me registrar para obter uma chave para cart√µes, criar um projeto separado, me preocupar com a conex√£o de recursos e muito mais. </li><li>  Igual √† op√ß√£o 4, mas substitua o Google por ....  Mas aqui eu suspeitava que seria poss√≠vel reduzir 1 em 1 mapas sdk, e n√£o havia desejo de experimentar. </li></ol><br><p>  Ap√≥s a terceira op√ß√£o, criei 2 subdiret√≥rios no src: java, para MapImplExtenstion.java e stubJava para arquivos necess√°rios apenas para compila√ß√£o.  Desde que decidi ajustar um pouco os r√≥tulos, fiquei interessado nos dois campos a seguir: </p><br><div class="spoiler">  <b class="spoiler_title">Campos Xj: Ljava / util / ArrayList e Xk: Ljava / util / ArrayList</b> <div class="spoiler_text"><pre> <code class="plaintext hljs"> .field private final Xj:Ljava/util/ArrayList; .annotation system Ldalvik/annotation/Signature; value = { "Ljava/util/ArrayList&lt;", "Lcom/google/android/gms/maps/model/LatLng;", "&gt;;" } .end annotation .end field .field private Xk:Ljava/util/ArrayList; .annotation system Ldalvik/annotation/Signature; value = { "Ljava/util/ArrayList&lt;", "Lcom/google/android/gms/maps/model/MarkerOptions;", "&gt;;" } .end annotation .end field</code> </pre> </div></div><br><p>  Usando jadx para descompilar em java, encontrei no c√≥digo descompilado um m√©todo respons√°vel por preench√™-los </p><br><div class="spoiler">  <b class="spoiler_title">M√©todo KN</b> <div class="spoiler_text"><pre> <code class="java hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">kN</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ Bundle extras = getIntent().getExtras(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (extras != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Sd = extras.getLong(<span class="hljs-string"><span class="hljs-string">"native"</span></span>); String[] stringArray = extras.getStringArray(<span class="hljs-string"><span class="hljs-string">"titles"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">double</span></span>[] doubleArray = extras.getDoubleArray(<span class="hljs-string"><span class="hljs-string">"coords"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (doubleArray != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> &amp;&amp; doubleArray.length &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; stringArray.length; i++) { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i2 = i * <span class="hljs-number"><span class="hljs-number">2</span></span>; LatLng latLng = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> LatLng(doubleArray[i2], doubleArray[i2 + <span class="hljs-number"><span class="hljs-number">1</span></span>]); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Xj.add(latLng); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Xk.add(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MarkerOptions().c(latLng).dS(stringArray[i])); } } } }</code> </pre></div></div><br><p>  Assim, a classe MapImplExtension adicionou o m√©todo ArrayList [] kN (String [] t√≠tulos, coordenadas duplas []) que, no primeiro elemento da matriz, retornar√° uma lista que precisar√° ser colocada em Xj e, no segundo, uma lista para Xk. </p><br><div class="spoiler">  <b class="spoiler_title">Classe MapImplExtension</b> <div class="spoiler_text"><pre> <code class="java hljs"> <span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.e1c.mobile; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.ArrayList; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.android.gms.maps.model.LatLng; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.android.gms.maps.model.MarkerOptions; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MapImplExtension</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> MapImpl mapImpl; MapImplExtension(MapImpl mapImpl){ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.mapImpl = mapImpl; } ArrayList[] kN(String[] titles, <span class="hljs-keyword"><span class="hljs-keyword">double</span></span>[] coordinates) { ArrayList[] result = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayList[<span class="hljs-number"><span class="hljs-number">2</span></span>]; ArrayList&lt;LatLng&gt; xj = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayList&lt;&gt;(); ArrayList&lt;MarkerOptions&gt; xk = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayList&lt;&gt;(); result[<span class="hljs-number"><span class="hljs-number">0</span></span>] = xj; result[<span class="hljs-number"><span class="hljs-number">1</span></span>] = xk; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> coordinatesOffset; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (coordinates != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> &amp;&amp; coordinates.length &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; titles.length; i++) { coordinatesOffset = i * <span class="hljs-number"><span class="hljs-number">2</span></span>; LatLng latlng = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> LatLng(coordinates[coordinatesOffset], coordinates[coordinatesOffset + <span class="hljs-number"><span class="hljs-number">1</span></span>]); xj.add(latlng); xk.add(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MarkerOptions().c(latlng).dS(<span class="hljs-string"><span class="hljs-string">" \n"</span></span> + titles[i])); } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result; } }</code> </pre></div></div><br><p>  Compilado com os seguintes comandos, primeiro na classe, depois no dex, depois descompilado no smali para empacotar junto com o restante dos arquivos </p><br><pre> <code class="plaintext hljs"> javac -encoding UTF-8 -d .\build -source 1.8 -target 1.8 -sourcepath .\src\stubJava .\src\java\com\e1c\mobile\MapImplExtenstion.java d8.bat .\build\com\e1c\mobile\MapImplExtension.class --output .\build java -jar C:\Path\to\baksmali\baksmali.jar d .\build\classes.dex -o .\build\unpackedOwn</code> </pre> <br><p>  Adicionado o campo de extens√£o do tipo de nossa nova classe ao MapImpl.smali e sua inicializa√ß√£o </p><br><div class="spoiler">  <b class="spoiler_title">Adicionando um campo</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">#    .field private extension:Lcom/e1c/mobile/MapImplExtension; #  ,  return-void new-instance v0, Lcom/e1c/mobile/MapImplExtension; invoke-direct {v0, p0}, Lcom/e1c/mobile/MapImplExtension;-&gt;&lt;init&gt;(Lcom/e1c/mobile/MapImpl;)V iput-object v0, p0, Lcom/e1c/mobile/MapImpl;-&gt;extension:Lcom/e1c/mobile/MapImplExtension;</code> </pre> </div></div><br><p>  E tamb√©m substituiu o processamento na classe MapImpl de dados de 1s pelo processamento na classe MapImplExtension </p><br><div class="spoiler">  <b class="spoiler_title">Altera√ß√µes no MapImpl.kN ()</b> <div class="spoiler_text"><pre> <code class="plaintext hljs"> # v0 - ; v1 - ; v2 - extension; #  MapImplExtension.kN(...) iget-object v2, p0, Lcom/e1c/mobile/MapImpl;-&gt;extension:Lcom/e1c/mobile/MapImplExtension; invoke-virtual {v2, v1, v0}, Lcom/e1c/mobile/MapImplExtension;-&gt;kN([Ljava/lang/String;[D)[Ljava/util/ArrayList; # v0 -   ; v1 - | ; v2 -    move-result-object v0 const/4 v2, 0x0 aget-object v1, v0, v2 iput-object v1, p0, Lcom/e1c/mobile/MapImpl;-&gt;Xj:Ljava/util/ArrayList; const/4 v2, 0x1 aget-object v1, v0, v2 iput-object v1, p0, Lcom/e1c/mobile/MapImpl;-&gt;Xk:Ljava/util/ArrayList;</code> </pre> </div></div><br><p>  Tendo empacotado e lan√ßado o aplicativo, vi com alegria que tudo estava funcionando.  Mas, no momento, n√£o fiz nada que pudesse expandir os recursos da plataforma m√≥vel.  Apenas alterei os cabe√ßalhos das marcas no mapa.  Mas, querendo mudar a imagem das tags, interrompi bastante e enterrei bastante tempo nas fontes e na documenta√ß√£o. </p><br><h1 id="dobavlenie-novoy-funkcionalnosti">  Adicionando nova funcionalidade </h1><br><p>  Primeiro, uma pequena explica√ß√£o de como o marcador do r√≥tulo est√° definido.  A classe <code>MarkerOptions</code> possui um <code>public MarkerOptions icon (BitmapDescriptor iconDescriptor)</code> m√©todo <code>public MarkerOptions icon (BitmapDescriptor iconDescriptor)</code> para o qual o objeto criado por um dos m√©todos est√°ticos da classe <code>BitmapDescriptorFactory</code> √© <code>BitmapDescriptorFactory</code> . </p><br><p>  E aqui, de fato, uma chatice estava me esperando.  Como 1c n√£o usa esse neg√≥cio, as classes correspondentes foram simplesmente cortadas durante a minifica√ß√£o.  Eu tive que restaur√°-los, e foi doloroso e longo.  Mais precisamente, as classes estavam l√°, mas foram renomeadas e n√£o continham os m√©todos necess√°rios.  Ao escolher o tipo de biblioteca completa para trabalhar com mapas - por assinaturas e constantes, descobri a correspond√™ncia das classes da biblioteca com as classes de aplicativos, adicionei os m√©todos e os campos necess√°rios, reconstru√≠-a e fiquei feliz por essa miss√£o finalmente terminar, j√° que finalmente funcionou, embora n√£o desde a primeira tentativa (v√°rias vezes cortada com assinaturas e classes minificadas confusas). </p><br><div class="spoiler">  <b class="spoiler_title">O resultado (exteriormente n√£o √© muito impressionante).</b>  <b class="spoiler_title">Dois pontos com coordenadas (45; 45) e (46; 46)</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/pv/cz/lu/pvczlujpmwuu2y2bauzieeszkby.png"></p></div></div><br><p>  Como o volume do c√≥digo alterado √© bastante grande - n√£o o incluirei no artigo, darei apenas as altera√ß√µes de assinatura.  Se algu√©m estiver interessado em todas as edi√ß√µes que fiz nesta etapa - voc√™ pode procurar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">neste commit</a> . </p><br><pre> <code class="java hljs">   Lcom/google/android/gms/maps/model/MarkerOptions -   .<span class="hljs-function"><span class="hljs-function">method </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">final</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">icon</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Lcom/google/android/gms/maps/model/a;)</span></span></span><span class="hljs-function">Lcom/google/android/gms/maps/model/MarkerOptions</span></span>;   com.google.android.gms.internal.fh   : <span class="hljs-function"><span class="hljs-function">b </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">zza</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> RemoteException</span></span>; <span class="hljs-function"><span class="hljs-function">b </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">zza</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> RemoteException</span></span>; <span class="hljs-function"><span class="hljs-function">b </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">zzb</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> RemoteException</span></span>; <span class="hljs-function"><span class="hljs-function">b </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">zzi</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> RemoteException</span></span>; <span class="hljs-function"><span class="hljs-function">b </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">zza</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> RemoteException</span></span>; <span class="hljs-function"><span class="hljs-function">b </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">zza</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Bitmap)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> RemoteException</span></span>; <span class="hljs-function"><span class="hljs-function">b </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">zzc</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> RemoteException</span></span>;   com.google.android.gms.internal.fj     h       com.google.android.gms.maps.model.b (BitmapDescriptorFactory)    <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> a </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fromResource</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> a </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fromAsset</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> a </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fromFile</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> a </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fromPath</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> a </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">defaultMarker</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> a </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">defaultMarker</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> a </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fromBitmap</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Bitmap)</span></span></span><span class="hljs-function">      MapImplExtension.java   xk.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">add</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(new MarkerOptions()</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">c</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(latlng)</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dS</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"  "</span></span></span></span><span class="hljs-function"><span class="hljs-params"> + titles[i])</span></span></span><span class="hljs-function">)</span></span>;     MarkerOptions markerOptions = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MarkerOptions() .c(latlng) .dS(<span class="hljs-string"><span class="hljs-string">"  "</span></span> + titles[i]); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (i == <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//      markerOptions.icon(b.defaultMarker(b.HUE_YELLOW)); } xk.add(markerOptions);</span></span></code> </pre><br><p>  Resumindo - a experi√™ncia foi bastante interessante.  Pelo menos para mim.  Ajudei a descobrir algumas ferramentas, aprendi um pouco melhor sobre o trabalho do andr√≥ide e o formato de bytecode para dalvik / art, a experi√™ncia de escolher c√≥digo minificado tamb√©m seria √∫til (j√° havia um caso em que, na vers√£o de lan√ßamento do R8, cortei os campos de classe que eram realmente usados, naquela √©poca apenas pelo m√©todo Eu descobri, agora n√£o causaria problemas). </p><br><p>  Se algu√©m est√° interessado em repetir tudo sozinho e, possivelmente, busc√°-lo ainda mais - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">eu postei no github</a> todas as fontes, juntamente com um script gradle torto que se baseia no apk original modificado. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt475266/">https://habr.com/ru/post/pt475266/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt475252/index.html">Como criticar a Microsoft</a></li>
<li><a href="../pt475258/index.html">Uma representa√ß√£o visual das elei√ß√µes em S√£o Petersburgo - a m√°gica do envolvimento de voz</a></li>
<li><a href="../pt475260/index.html">A diferen√ßa entre uma fun√ß√£o ass√≠ncrona e uma fun√ß√£o que retorna uma promessa</a></li>
<li><a href="../pt475262/index.html">O resumo de materiais frescos do mundo do front-end da √∫ltima semana n ¬∞ 388 (4 a 10 de novembro de 2019)</a></li>
<li><a href="../pt475264/index.html">Farejadores que poderiam: como a fam√≠lia FakeSecurity infectou lojas on-line</a></li>
<li><a href="../pt475268/index.html">Parametriza√ß√£o incerta como um m√©todo universal para criar arquitetura de aplicativos em C ++ e Java, no m√≠nimo. o pre√ßo</a></li>
<li><a href="../pt475270/index.html">SwiftUI: Criando se√ß√µes expans√≠veis / recolh√≠veis na exibi√ß√£o de lista</a></li>
<li><a href="../pt475272/index.html">Migrando para a infraestrutura de espera ass√≠ncrona no Rust</a></li>
<li><a href="../pt475276/index.html">Como escrever afirmar corretamente</a></li>
<li><a href="../pt475278/index.html">Como espiar um hacker enquanto um hacker espia voc√™</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>