<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üòê üë©üèæ‚Äçüé® üôåüèæ Assinatura est√°tica usando o modelo Observer usando C ++ e o microcontrolador Cortex M4 üéõÔ∏è üë¶üèæ üß†</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Boa sa√∫de a todos! 


 Na v√©spera do Ano Novo, quero continuar falando sobre o uso de C ++ em microcontroladores, desta vez tentarei falar sobre o uso...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Assinatura est√°tica usando o modelo Observer usando C ++ e o microcontrolador Cortex M4</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/481606/"><p><img src="https://habrastorage.org/webt/kq/jo/qx/kqjoqxpr1itcdx-_kq4luowkpqe.jpeg"></p><br><p>  Boa sa√∫de a todos! </p><br><p>  Na v√©spera do Ano Novo, quero continuar falando sobre o uso de C ++ em microcontroladores, desta vez tentarei falar sobre o uso do modelo Observer (mas a seguir chamarei Publisher-Subscriber ou apenas um Assinante, um trocadilho), bem como a implementa√ß√£o de uma assinatura est√°tica para C ++ 17 e as vantagens dessa abordagem em algumas aplica√ß√µes. </p><a name="habracut"></a><br><h2 id="vvedenie">  1. Introdu√ß√£o </h2><br><p> O Assinante de modelo √© um dos modelos mais comuns usados ‚Äã‚Äãno desenvolvimento de software.  Com ele, por exemplo, eles clicam no bot√£o do processamento do Windows Form.  E, de fato, em qualquer lugar em que voc√™ precise, de alguma forma, responder a altera√ß√µes nos par√¢metros do sistema, sejam altera√ß√µes nos arquivos ou atualizando o valor medido do sensor, √© hora <del>  sem pensar </del>  use o modelo de assinante. </p><br><p>  A vantagem do modelo √© que liberamos o conhecimento do Publicador e do Assinante sem estarmos vinculados a objetos espec√≠ficos.  Podemos assinar qualquer pessoa, sem afetar a implementa√ß√£o dos objetos Publisher e Subscriber. </p><br><h2 id="nachalnye-usloviya">  Condi√ß√µes iniciais </h2><br><p>  Antes de nos familiarizarmos com o modelo, vamos primeiro concordar que queremos desenvolver software confi√°vel no qual: </p><br><ul><li>  n√£o use aloca√ß√£o de mem√≥ria din√¢mica </li><li>  minimizar o trabalho com ponteiros </li><li>  usamos o maior n√∫mero poss√≠vel de constantes para que ningu√©m possa mudar ningu√©m, tanto quanto poss√≠vel </li><li>  mas, ao mesmo tempo, usamos o m√≠nimo de constantes poss√≠vel localizado na RAM </li></ul><br><p>  Agora, vejamos a implementa√ß√£o padr√£o do modelo de Assinante. </p><br><h2 id="standartnaya-realizaciya">  Implementa√ß√£o padr√£o </h2><br><p>  Suponha que tenhamos um bot√£o e, quando voc√™ clica no bot√£o, precisamos piscar os LEDs, mas quantos deles ser√£o desconhecidos at√© agora e, de fato, talvez voc√™ precise piscar n√£o com LEDs, mas com um holofote no navio para transmitir mensagens em c√≥digo Morse.  √â importante que n√£o saibamos quem estar√° assinando.  Infelizmente, eu n√£o tenho holofotes √† m√£o, portanto, todos os exemplos deste artigo, por uma quest√£o de simplicidade e melhor entendimento, s√£o feitos com LEDs. </p><br><p>  Portanto, quando voc√™ pressiona o bot√£o, √© necess√°rio notificar o LED sobre esta impressora.  Por sua vez, depois de aprender a pressionar o LED, deve passar para o estado oposto. <br>  A implementa√ß√£o padr√£o na UML √© a seguinte ... </p><br><p><img src="https://habrastorage.org/webt/zu/8g/ro/zu8gro30gxgngc8w36oesxy9w2i.png"></p><br><p> Aqui, a classe <code>ButtonController</code> √© respons√°vel por pesquisar o bot√£o e notificar os assinantes sobre o clique. Nesse caso, o <code>Led</code> √© o assinante.  Essas duas classes s√£o dissociadas por meio das <code>ISubsriber</code> e <code>ISubsriber</code> e nenhuma das classes conhece a outra.  Portanto, qualquer objeto herdado da interface <code>ISubscriber</code> pode se inscrever em um evento do <code>ButtonController</code> . </p><br><p>  Como a aloca√ß√£o din√¢mica de mem√≥ria √© proibida, declarei uma matriz de 3 elementos para assinatura.  I.e.  m√°ximo pode ser de 3 assinantes.  Portanto, em uma primeira aproxima√ß√£o, o m√©todo de notificar assinantes da classe <code>ButttonsController</code> pode parecer </p><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ButtonController</span></span></span><span class="hljs-class"> :</span></span> IPublisher { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Run</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(;;) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (UserButton::IsPressed()) { Notify() ; } } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Notify</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> override </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//          HandleEvent() for(auto it: pSubscribers) { if (it != nullptr) { it-&gt;HandleEvent() ; } } } } ;</span></span></code> </pre> <br><p>  Todo o sal est√° no m√©todo <code>Notify()</code> da classe <code>Publisher</code> .  Nesse m√©todo, <code>HandleEvent()</code> a lista de assinantes e chamamos o m√©todo <code>HandleEvent()</code> em cada um deles, e isso √© legal, porque cada assinante implementa esse m√©todo √† sua maneira e pode fazer isso l√° <del>  tudo </del>  o que seu cora√ß√£o desejar (na verdade, voc√™ precisa ter cuidado; caso contr√°rio, o diabo sabe o que o assinante est√° fazendo l√°, voc√™ pode chamar o m√©todo dele, por exemplo, de uma interrup√ß√£o e precisa estar vigilante para impedir que assinantes fa√ßam coisas longas e ruins) </p><br><p>  No nosso caso, o LED pode fazer qualquer coisa, assim como a mudan√ßa de seu estado: </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span> &lt;<span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> Port, <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-keyword"><span class="hljs-keyword">uint32_t</span></span> pinNum&gt; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Led</span></span></span><span class="hljs-class">:</span></span> ISubscriber { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Toggle</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ Port::ODR::Toggle(<span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; pinNum); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">HandleEvent</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> override </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//  ,    ,  Toggle() ; } };</span></span></code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Implementa√ß√£o completa de todas as classes</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> Port, <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> pinNum&gt; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Button</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">IsPressed</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> result = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((Port::IDR::Read() &amp; (<span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; pinNum)) == <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-comment"><span class="hljs-comment">//   { while ((Port::IDR::Read() &amp; (1 &lt;&lt; pinNum)) == 0) //     { }; result = true; } return result; } } ; //     GPIOC.13 using UserButton = Button&lt;GPIOC, 13&gt; ; struct ISubscriber { virtual void HandleEvent() = 0; } ; struct IPublisher { virtual void Notify() const = 0; virtual void Subscribe(ISubscriber* subscriber) = 0; } ; template &lt;typename Port, std::uint32_t pinNum&gt; struct Led: ISubscriber { static void Toggle() { Port::ODR::Toggle(1 &lt;&lt; pinNum); } void HandleEvent() override { Toggle() ; } }; struct ButtonController : IPublisher { void Run() { for(; ;) { if (UserButton::IsPressed()) { Notify() ; } } } void Notify() const override { for(auto it: pSubscribers) { if (it != nullptr) { it-&gt;HandleEvent() ; } } } void Subscribe(ISubscriber* subscriber) override { if (index &lt; pSubscribers.size()) { pSubscribers[index] = subscriber ; index ++ ; } //   3   ...   } private: std::array&lt;ISubscriber*, 3&gt; pSubscribers ; std::size_t index = 0U ; } ;</span></span></code> </pre></div></div><br><p>  Como uma assinatura pode parecer no c√≥digo?  E assim: </p><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//  Led1    5  GPIOC static Led&lt;GPIOC,5&gt; Led1 ; //  Led2    8  GPIOC static Led&lt;GPIOC,8&gt; Led2 ; //  Led3    9  GPIOC static Led&lt;GPIOC,9&gt; Led3 ; ButtonController buttonController ; //  3  buttonController.Subscribe(&amp;Led1) ; buttonController.Subscribe(&amp;Led2) ; buttonController.Subscribe(&amp;Led3) ; //       buttonController.Run() ; }</span></span></code> </pre> <br><p>  A boa not√≠cia √© que podemos assinar qualquer objeto e o tempo de sua cria√ß√£o n√£o importa para n√≥s.  Pode ser um objeto global, est√°tico ou local.  Por um lado, isso √© bom, mas, por outro, por que precisamos assinar o tempo de execu√ß√£o nesse c√≥digo.  De fato, aqui o endere√ßo dos objetos <code>Led1</code> , <code>Led2</code> , <code>Led3</code> √© conhecido no est√°gio de compila√ß√£o.  Ent√£o, por que voc√™ n√£o pode se inscrever no est√°gio de compila√ß√£o e manter uma s√©rie de indicadores para os assinantes na ROM? </p><br><p>  Al√©m disso, existe o risco de poss√≠veis erros, por exemplo, quantos se perguntaram o que aconteceria ao chamar o m√©todo <code>Subsribe()</code> se ele fosse chamado de v√°rios threads?  Estamos limitados a apenas 3 assinantes, e o que acontece se assinarmos 4 LEDs? </p><br><p>  Na maioria dos casos, precisamos dessa assinatura uma vez na vida durante a inicializa√ß√£o, apenas salvamos indicadores para os assinantes e √© isso.  O ponteiro manter√° o endere√ßo desses assinantes por toda a vida.  E o dia √© inevit√°vel, quando pode ser arruinado <del>  devido a surto de supernova </del>  (√© claro, se considerarmos um per√≠odo bastante longo).  Mas, em qualquer caso, a probabilidade de falha da RAM √© muito maior que a ROM e n√£o √© recomend√°vel armazenar dados permanentes na RAM. </p><br><p>  Bem, a m√° not√≠cia √© que essa solu√ß√£o arquitet√¥nica ocupa muito espa√ßo na ROM e na RAM.  Apenas no caso, escrevemos quantas ROM e RAM essa solu√ß√£o leva: </p><br><div class="scrollable-table"><table><thead><tr><th>  M√≥dulo </th><th>  c√≥digo ro </th><th>  dados ro </th><th>  dados rw </th></tr></thead><tbody><tr><td>  main.o </td><td>  488 </td><td>  64 </td><td>  21 </td></tr></tbody></table></div><br><p>  I.e.  no total, 552 bytes na ROM e 21 bytes na RAM - digamos que n√£o tanto para pressionar um bot√£o e piscar tr√™s LEDs. </p><br><p>  Bem, para se proteger de tais problemas e reduzir o consumo de recursos do controlador, vamos considerar a op√ß√£o com uma assinatura est√°tica. </p><br><h2 id="staticheskaya-podpiska">  Assinatura est√°tica </h2><br><p>  Para tornar a assinatura est√°tica, voc√™ pode usar v√°rias abordagens.  Vou nome√°-los assim: </p><br><ul><li>  A tradicional √© a mesma abordagem, mas usando o construtor constexpr e definindo a lista de assinantes por meio dela. </li><li><del>  N√£o convencional </del>  Usando modelos - transfira a lista de assinantes atrav√©s dos par√¢metros do modelo.  (aqui, um modelo √© uma defini√ß√£o do campo da metaprograma√ß√£o, n√£o dos padr√µes de design) </li></ul><br><h3 id="tradicionnyy-podhod-k-staticheskoy-podpiske">  A abordagem tradicional da assinatura est√°tica </h3><br><p>  Vamos tentar se inscrever na fase de compila√ß√£o.  Para fazer isso, ajustamos um pouco nossa arquitetura: </p><br><p><img src="https://habrastorage.org/webt/lr/_k/gy/lr_kgyobfgkebxpz9gfyqiod34u.png"></p><br><p>  A imagem n√£o √© muito diferente da original, mas existem v√°rias diferen√ßas: o m√©todo <code>Subscribe()</code> foi removido e agora a assinatura ser√° realizada diretamente no construtor.  O construtor deve aceitar um n√∫mero vari√°vel de argumentos e, para poder assinar estaticamente no est√°gio de compila√ß√£o, ser√° <code>constexpr</code> .  Uma matriz de assinantes ser√° inicializada e essa inicializa√ß√£o pode ser feita em tempo de compila√ß√£o: </p><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ButtonController</span></span></span><span class="hljs-class"> :</span></span> IPublisher { <span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">typename</span></span>... Args&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">constexpr</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ButtonController</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Args </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params">*... args)</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">pSubscribers</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">initializer_list</span></span>&lt;ISubscriber <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>*&gt; result = {args...} ; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> index = <span class="hljs-number"><span class="hljs-number">0U</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> it: result) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (index &lt; size) { pSubscribers[index] = <span class="hljs-keyword"><span class="hljs-keyword">const_cast</span></span>&lt;ISubscriber*&gt;(it); } index ++ ; } } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">constexpr</span></span> <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> size = <span class="hljs-number"><span class="hljs-number">3U</span></span>; ISubscriber* pSubscribers[size] ; } ;</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">C√≥digo completo para essa implementa√ß√£o</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ISubscriber</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">HandleEvent</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>= <span class="hljs-number"><span class="hljs-number">0</span></span>; } ; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IPublisher</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Notify</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>= <span class="hljs-number"><span class="hljs-number">0</span></span>; } ; <span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> Port, <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> pinNum&gt; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Button</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">IsPressed</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> result = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((Port::IDR::Read() &amp; (<span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; pinNum)) == <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-comment"><span class="hljs-comment">//   { while ((Port::IDR::Read() &amp; (1 &lt;&lt; pinNum)) == 0) //     { }; result = true; } return result; } } ; template &lt;typename Port, std::uint32_t pinNum&gt; struct Led: ISubscriber { constexpr Led() { } static void Toggle() { Port::ODR::Toggle(1&lt;&lt;pinNum); } void HandleEvent() const override { Toggle() ; } }; //     GPIOC.13 using UserButton = Button&lt;GPIOC, 13&gt; ; struct ButtonController : IPublisher { template&lt;typename... Args&gt; constexpr ButtonController(Args const*... args): pSubscribers() { std::initializer_list&lt;ISubscriber const*&gt; result = {args...} ; std::size_t index = 0U; for(auto it: result) { if (index &lt; size) { pSubscribers[index] = const_cast&lt;ISubscriber*&gt;(it); } index ++ ; } } void Run() const { for(; ;) { if (UserButton::IsPressed()) { Notify() ; } } } void Notify() const override { for(auto it: pSubscribers) { if (it != nullptr) { it-&gt;HandleEvent() ; } } } private: static constexpr std::size_t size = 3U; ISubscriber* pSubscribers[size] ; } ;</span></span></code> </pre></div></div><br><p>  Agora a assinatura pode ser feita no momento da compila√ß√£o: </p><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//  Led1    5  GPIOC static constexpr Led&lt;GPIOC,5&gt; Led1 ; //  Led2    8  GPIOC static constexpr Led&lt;GPIOC,8&gt; Led2 ; //  Led3    9  GPIOC static constexpr Led&lt;GPIOC,9&gt; Led3 ; static constexpr ButtonController buttonController(&amp;Led1, &amp;Led2, &amp;Led3) ; buttonController.Run() ; return 0 ; } ;</span></span></code> </pre> <br><p>  Aqui, o objeto <code>buttonController</code> completamente localizado na ROM junto com uma matriz de ponteiros para os assinantes: </p><br><blockquote>  main :: buttonController 0x800'1f04 0x10 Dados main.o [1] </blockquote><p>  Tudo parece n√£o ser nada, exceto que estamos novamente limitados a apenas tr√™s assinantes.  E a classe do editor deve ter um construtor constexpr e, em geral, ser completamente constante para garantir um ponteiro para os assinantes na ROM; caso contr√°rio, mesmo com endere√ßos de assinantes conhecidos, nosso objeto, juntamente com todo o conte√∫do, voltar√° √† RAM. </p><br><p>  Das outras desvantagens - como as fun√ß√µes virtuais ainda s√£o usadas, as tabelas de fun√ß√µes virtuais s√£o pouco a pouco nossa ROM.  E o recurso √©, embora acess√≠vel, mas n√£o infinito.  Na maioria das aplica√ß√µes, √© poss√≠vel martel√°-lo e levar um microcontrolador maior, mas geralmente acontece que cada byte conta, principalmente quando se trata de produtos fabricados por centenas de milhares, como sensores f√≠sicos f√≠sicos. </p><br><p>  Vamos ver como est√£o as coisas na mem√≥ria nesta solu√ß√£o: </p><br><div class="scrollable-table"><table><thead><tr><th>  M√≥dulo </th><th>  c√≥digo ro </th><th>  dados ro </th><th>  dados rw </th></tr></thead><tbody><tr><td>  main.o </td><td>  172 </td><td>  76 </td><td>  0 0 </td></tr></tbody></table></div><br><p>  E embora o resultado seja "impressionante": o consumo total de RAM √© de 0 bytes e a ROM √© de 248 bytes, o que equivale √† metade da primeira solu√ß√£o, parece que ainda h√° espa√ßo para melhorias.  Desses 248 bytes, aproximadamente 50 ocupam apenas as tabelas de m√©todos virtuais. </p><br><p>  <u>Uma pequena digress√£o:</u> <br>  Um passo no tamanho de ROM de 256 kB para microcontroladores modernos √© a norma (por exemplo, o microcontrolador TI Cortex M4 tem 256 kB de ROM e a pr√≥xima vers√£o j√° √© de 512 kB).  E n√£o ser√° muito bom quando, devido aos 50 bytes extras, for necess√°rio um controlador com uma ROM de 256 kByte maior e mais caro, portanto, abandonar as fun√ß√µes virtuais pode economizar ... at√© 50 centavos (a diferen√ßa entre o microcontrolador na ROM de 256 e 512 kBytes √© de cerca de 50-60 centavos). </p><br><p>  Isso parece rid√≠culo para 1 microcontrolador, mas em um lote de 400.000 dispositivos por ano, voc√™ pode economizar US $ 200.000.  J√° n√£o √© t√£o engra√ßado, mas considerando que tipo de rato.  eles podem recompensar a oferta com um diploma e um cart√£o-presente por 3.000 rublos. N√£o h√° absolutamente nenhuma d√∫vida sobre a corre√ß√£o de recusar fun√ß√µes virtuais e economizar 50 bytes extras em ROM. </p><br><h3 id="netradicionnyy-podhod">  Abordagem n√£o convencional </h3><br><p>  Vamos ver como voc√™ pode fazer o mesmo sem fun√ß√µes virtuais e economizar um pouco mais de ROM. </p><br><p>  Primeiro, vamos descobrir como poderia ser: </p><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//  Led1    5  GPIOC static Led&lt;GPIOC,5&gt; Led1 ; //  Led2    8  GPIOC static Led&lt;GPIOC,8&gt; Led2 ; //  Led3    9  GPIOC static Led&lt;GPIOC,9&gt; Led3 ; //   ButtonController&lt;Led1, Led2, Led3&gt; buttonController ; buttonController.Run() ; return 0 ; }</span></span></code> </pre> <br><p>  Nossa tarefa √© desacoplar os dois objetos Publisher ( <code>ButtonController</code> ) e Subscriber ( <code>Led</code> ) um do outro para que eles n√£o se conhe√ßam, mas ao mesmo tempo o <code>ButtonController</code> pode notificar o <code>Led</code> . </p><br><p>  Voc√™ pode declarar a classe <code>ButtonController</code> alguma maneira. </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span> &lt;Led&lt;GPIOC,<span class="hljs-number"><span class="hljs-number">5</span></span>&gt;&amp; subscriber1, Led&lt;GPIOC,<span class="hljs-number"><span class="hljs-number">8</span></span>&gt;&amp; subscriber2, Led&lt;GPIOC,<span class="hljs-number"><span class="hljs-number">9</span></span>&gt;&amp; subscriber3&gt; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ButtonController</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Run</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(; ;) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (UserButton::IsPressed()) { Notify() ; } } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Notify</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>{ subscriber1.HandleEvent() ; subscriber2.HandleEvent() ; subscriber3.HandleEvent() ; } ... } ;</code> </pre> <br><p>  Mas voc√™ entende, aqui estamos anexados a tipos espec√≠ficos e teremos que refazer a defini√ß√£o da classe <code>BbuttonController</code> sempre em um novo projeto.  E eu gostaria de pegar e usar o <code>ButtonController</code> no novo projeto sem <code>ButtonController</code> . </p><br><p>  O C ++ 17 vem para o resgate, onde voc√™ n√£o pode especificar o tipo, mas pe√ßa ao compilador para deduzir o tipo para voc√™ - √© exatamente isso que voc√™ precisa.  Podemos, assim como na abordagem tradicional, liberar o conhecimento do Publicador e do Assinante, enquanto o n√∫mero de assinantes √© praticamente ilimitado. </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span> &lt;<span class="hljs-keyword"><span class="hljs-keyword">auto</span></span>&amp; ... subscribers&gt; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ButtonController</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Run</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(; ;) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (UserButton::IsPressed()) { Notify() ; } } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Notify</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>{ pass((subscribers.HandleEvent() , <span class="hljs-literal"><span class="hljs-literal">true</span></span>)...) ; } ... } ;</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Como a fun√ß√£o pass (..) funciona</b> <div class="spoiler_text"><p>  O m√©todo <code>Notify()</code> tem uma chamada para a fun√ß√£o <code>pass()</code> ; √© usado para expandir os par√¢metros do modelo com um n√∫mero vari√°vel de argumentos </p><br><pre> <code class="cpp hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Notify</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>{ pass((subscribers.HandleEvent() , <span class="hljs-literal"><span class="hljs-literal">true</span></span>)...) ; }</code> </pre> <br><p>  A implementa√ß√£o da fun√ß√£o <code>pass()</code> √© simplesmente inimagin√°vel, √© apenas uma fun√ß√£o que recebe um n√∫mero vari√°vel de argumentos: </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">typename</span></span>... Args&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">pass</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Args...)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>{ } } ;</code> </pre> <br><p>  Como a fun√ß√£o <code>HandleEvent()</code> expande em v√°rias chamadas para cada um dos assinantes? </p><br><p>  Como a fun√ß√£o <code>pass()</code> recebe v√°rios argumentos de qualquer tipo, voc√™ pode passar v√°rios argumentos do tipo <code>bool</code> , por exemplo, voc√™ pode chamar a fun√ß√£o <code>pass(true, true, true)</code> .  Nesse caso, √© claro, nada vai acontecer, mas n√£o precisamos. </p><br><p>  A linha <code>(subscribers.HandleEvent() , true)</code> usa o operador "," (v√≠rgula), que executa os dois operandos (da esquerda para a direita) e retorna o valor do segundo operador, ou seja, aqui os <code>subscribers.HandleEvent()</code> ser√£o executados primeiro e, em seguida, <code>true</code> √† fun√ß√£o <code>pass()</code> ser√° definido como <code>true</code> . </p><br><p>  Bem, "..." √© uma entrada padr√£o para expandir um n√∫mero vari√°vel de argumentos.  Para o nosso caso, as a√ß√µes do compilador podem ser descritas muito esquematicamente da seguinte maneira: </p><br><pre> <code class="cpp hljs">pass((subscribers.HandleEvent() , <span class="hljs-literal"><span class="hljs-literal">true</span></span>)...) ; -&gt; pass((Led1.HandleEvent() , <span class="hljs-literal"><span class="hljs-literal">true</span></span>), (Led2.HandleEvent() , <span class="hljs-literal"><span class="hljs-literal">true</span></span>), (Led3.HandleEvent() , <span class="hljs-literal"><span class="hljs-literal">true</span></span>)) ; -&gt; Led1.HandleEvent() ; -&gt; pass(<span class="hljs-literal"><span class="hljs-literal">true</span></span>, (Led2.HandleEvent() , <span class="hljs-literal"><span class="hljs-literal">true</span></span>), (Led3.HandleEvent() , <span class="hljs-literal"><span class="hljs-literal">true</span></span>)) ; -&gt; Led2.HandleEvent() ; -&gt; pass(<span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-literal"><span class="hljs-literal">true</span></span>, (Led3.HandleEvent() , <span class="hljs-literal"><span class="hljs-literal">true</span></span>)) ; -&gt; Led3.HandleEvent() ; -&gt; pass(<span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-literal"><span class="hljs-literal">true</span></span>) ;</code> </pre> </div></div><br><p>  Em vez de links, voc√™ pode usar ponteiros: </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span> &lt;<span class="hljs-keyword"><span class="hljs-keyword">auto</span></span>* ... subscribers&gt; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ButtonController</span></span></span><span class="hljs-class"> {</span></span> ... } ;</code> </pre> <br><p>  <strong>Adi√ß√£o:</strong> Na verdade, gra√ßas a <a href="https://habr.com/ru/users/vamireh/" class="user_link">vamireh,</a> que <a href="https://habr.com/ru/post/481606/">apontou</a> que todas essas dan√ßas est√£o com <del>  pandeiro </del>  <code>pass</code> fun√ß√£o <code>pass</code> no C ++ 17 n√£o √© necess√°ria.  Como o operador "," a v√≠rgula √© suportada na express√£o fold (que foi introduzida no padr√£o C ++ 17), o c√≥digo √© ainda mais simplificado: </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span> &lt;<span class="hljs-keyword"><span class="hljs-keyword">auto</span></span>&amp; ... subscribers&gt; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ButtonController</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Run</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(; ;) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (UserButton::IsPressed()) { Notify() ; } } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Notify</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>{ ((subscribers.HandleEvent()), ...) ; } } ;</code> </pre> <br><p>  Arquitetonicamente, parece muito simples em geral: </p><br><p><img src="https://habrastorage.org/webt/hx/di/jj/hxdijj1xdfvncxtdsr04a1qp_ve.png"></p><br><p>  Adicionei outra classe de LCD aqui, mas apenas por exemplo, para mostrar que agora n√£o importa o tipo e o n√∫mero de assinantes, o principal √© que implementaria o m√©todo <code>HandleEvent()</code> . </p><br><p>  E todo o c√≥digo em geral tamb√©m √© mais f√°cil agora: </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> Port, <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> pinNum&gt; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Button</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">IsPressed</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> result = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((Port::IDR::Read() &amp; (<span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; pinNum)) == <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-comment"><span class="hljs-comment">//   { while ((Port::IDR::Read() &amp; (1 &lt;&lt; pinNum)) == 0) //     { }; result = true; } return result; } } ; //     GPIOC.13 using UserButton = Button&lt;GPIOC, 13&gt; ; template &lt;typename Port, std::uint32_t pinNum&gt; struct Led { static void Toggle() { Port::ODR::Toggle(1&lt;&lt;pinNum); } void HandleEvent() const { Toggle() ; } }; template &lt;auto&amp; ... subscribers&gt; struct ButtonController { void Run() const { for(; ;) { if (UserButton::IsPressed()) { Notify() ; } } } void Notify() const { ((subscribers.HandleEvent()), ...) ; } } ; int main() { //  Led1    5  GPIOC static constexpr Led&lt;GPIOC,5&gt; Led1 ; //  Led2    8  GPIOC static constexpr Led&lt;GPIOC,8&gt; Led2 ; //  Led3    9  GPIOC static constexpr Led&lt;GPIOC,9&gt; Led3 ; static constexpr ButtonController&lt;Led1, Led2, Led3&gt; buttonController ; buttonController.Run() ; return 0 ; }</span></span></code> </pre> <br><p>  A chamada <code>Notify()</code> no m√©todo <code>Run()</code> degenera em uma chamada seq√ºencial simples </p><br><pre> <code class="cpp hljs">Led1.HandleEvent() ; Led2.HandleEvent() ; Led3.HandleEvent() ;</code> </pre> <br><p>  E a mem√≥ria aqui? </p><br><div class="scrollable-table"><table><thead><tr><th>  M√≥dulo </th><th>  c√≥digo ro </th><th>  dados ro </th><th>  dados rw </th></tr></thead><tbody><tr><td>  main.o </td><td>  186 </td><td>  4 </td><td>  0 0 </td></tr></tbody></table></div><br><p>  ROM total de 190 bytes e 0 bytes de RAM.  Agora, o pedido √© quase tr√™s vezes menor que a vers√£o padr√£o, enquanto executa exatamente a mesma coisa. </p><br><p>  Portanto, se voc√™ possui os endere√ßos dos assinantes conhecidos com anteced√™ncia no aplicativo e segue as condi√ß√µes definidas no in√≠cio do artigo </p><br><div class="spoiler">  <b class="spoiler_title">Condi√ß√µes no in√≠cio do artigo</b> <div class="spoiler_text"><ul><li>  n√£o use aloca√ß√£o de mem√≥ria din√¢mica </li><li>  minimizar o trabalho com ponteiros </li><li>  usamos o maior n√∫mero poss√≠vel de constantes para que ningu√©m possa mudar ningu√©m, tanto quanto poss√≠vel </li><li>  mas, ao mesmo tempo, usamos o m√≠nimo de constantes poss√≠vel localizado na RAM </li></ul></div></div><br><p>  Com confian√ßa, voc√™ pode usar essa implementa√ß√£o do modelo Publisher-Subscriber para reduzir linhas de c√≥digo e economizar recursos. L√° voc√™ olha e pode reivindicar n√£o apenas um cart√£o-presente, mas tamb√©m um b√¥nus com base nos resultados do ano. </p><br><p>  O <a href="https://yadi.sk/d/_nF8mwnX0tXkKA" rel="nofollow">exemplo de</a> teste da <a href="https://yadi.sk/d/_nF8mwnX0tXkKA" rel="nofollow">IAR 8.40.2 est√° aqui</a> </p><br><p>  Tudo com a vinda!  E boa sorte no ano novo! </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt481606/">https://habr.com/ru/post/pt481606/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt481594/index.html">Desenvolvimento de um "gerador de tens√£o simples" de acordo com GOST R IEC 61508 (IEC 61508)</a></li>
<li><a href="../pt481596/index.html">Analisando as configura√ß√µes do ELK 7.5 para an√°lise de log do Mikrotik</a></li>
<li><a href="../pt481598/index.html">Uma pequena contribui√ß√£o para a luta contra as plataformas do zool√≥gico Avalonia UI</a></li>
<li><a href="../pt481600/index.html">Bonsai Family Wiki Engine: resultados de 2019</a></li>
<li><a href="../pt481604/index.html">Qu√£o severos desenvolvedores de Chelyabinsk criam jogos para o Google Play e as redes sociais</a></li>
<li><a href="../pt481610/index.html">Antipadr√µes do PostgreSQL: atualizando uma tabela grande sob carga</a></li>
<li><a href="../pt481612/index.html">Nossa pequena contribui√ß√£o para a luta da Avalonia UI por menos plataformas</a></li>
<li><a href="../pt481616/index.html">Domo geod√©sico. Sobre o dispositivo e minha experi√™ncia em c√°lculos</a></li>
<li><a href="../pt481618/index.html">MVP no Unity ou como simplificar a vida</a></li>
<li><a href="../pt481620/index.html">Juniper SRX e Cisco ASA: pr√≥xima s√©rie</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>