<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘©ğŸ¿â€ğŸ¤â€ğŸ‘¨ğŸ¾ ğŸšµğŸ» ğŸ¤• Reduxå°±åƒSwiftUIä¸­çš„çŠ¶æ€å®¹å™¨ã€‚ åŸºç¡€çŸ¥è¯† ğŸ¥‹ ğŸ‘‡ğŸ» ğŸš­</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="æœ¬å‘¨ï¼Œæˆ‘ä»¬å°†è®¨è®ºå¦‚ä½•åˆ›å»ºç±»ä¼¼äºReduxä½¿ç”¨çš„çŠ¶æ€å®¹å™¨ã€‚ å®ƒæ˜¯æ­£åœ¨å¼€å‘çš„åº”ç”¨ç¨‹åºçš„å”¯ä¸€ä»·å€¼æ¥æºã€‚ æ•´ä¸ªåº”ç”¨ç¨‹åºçš„å•ä¸€çŠ¶æ€ä½¿è°ƒè¯•å’ŒéªŒè¯æ›´åŠ å®¹æ˜“ã€‚ çœŸå€¼çš„å•ä¸€æ¥æºæ¶ˆé™¤äº†åœ¨åº”ç”¨ç¨‹åºä¸­åˆ›å»ºå¤šä¸ªçŠ¶æ€æ—¶å‘ç”Ÿçš„æ•°åƒä¸ªé”™è¯¯ã€‚ 

 çœŸç›¸å€¼çš„å•ä¸€æ¥æº 
 ä¸»è¦æ€æƒ³æ˜¯é€šè¿‡å•ä¸ªç»“æ„æˆ–ç»“æ„ç»„æˆæ¥æè¿°æ•´ä¸ªåº”ç”¨ç¨‹åºçš„çŠ¶æ€ã€‚ å‡...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Reduxå°±åƒSwiftUIä¸­çš„çŠ¶æ€å®¹å™¨ã€‚ åŸºç¡€çŸ¥è¯†</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/476398/"><img src="https://habrastorage.org/webt/d3/qh/59/d3qh59r27fxn9tp1eg3ygd7lmqi.jpeg" alt="å›¾ç‰‡"><br><br> æœ¬å‘¨ï¼Œæˆ‘ä»¬å°†è®¨è®ºå¦‚ä½•åˆ›å»ºç±»ä¼¼äº<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Redux</a>ä½¿ç”¨çš„çŠ¶æ€å®¹å™¨ã€‚ å®ƒæ˜¯æ­£åœ¨å¼€å‘çš„åº”ç”¨ç¨‹åºçš„å”¯ä¸€ä»·å€¼æ¥æºã€‚ æ•´ä¸ªåº”ç”¨ç¨‹åºçš„å•ä¸€çŠ¶æ€ä½¿è°ƒè¯•å’ŒéªŒè¯æ›´åŠ å®¹æ˜“ã€‚ çœŸå€¼çš„å•ä¸€æ¥æºæ¶ˆé™¤äº†åœ¨åº”ç”¨ç¨‹åºä¸­åˆ›å»ºå¤šä¸ªçŠ¶æ€æ—¶å‘ç”Ÿçš„æ•°åƒä¸ªé”™è¯¯ã€‚ <br><a name="habracut"></a><br><h3> çœŸç›¸å€¼çš„å•ä¸€æ¥æº </h3><br> ä¸»è¦æ€æƒ³æ˜¯é€šè¿‡å•ä¸ªç»“æ„æˆ–ç»“æ„ç»„æˆæ¥æè¿°æ•´ä¸ªåº”ç”¨ç¨‹åºçš„çŠ¶æ€ã€‚ å‡è®¾æˆ‘ä»¬æ­£åœ¨å¼€å‘ä¸€ä¸ªGithubå­˜å‚¨åº“æœç´¢åº”ç”¨ç¨‹åºï¼Œå…¶ä¸­stateæ˜¯æˆ‘ä»¬ä½¿ç”¨Github APIæ ¹æ®ç‰¹å®šè¯·æ±‚é€‰æ‹©çš„å­˜å‚¨åº“æ•°ç»„ã€‚ <br><br><pre><code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AppState</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> searchResult: [<span class="hljs-type"><span class="hljs-type">Repo</span></span>] = [] }</code> </pre> <br> ä¸‹ä¸€æ­¥æ˜¯å°†çŠ¶æ€ï¼ˆåªè¯»ï¼‰ä¼ é€’ç»™åº”ç”¨ç¨‹åºä¸­çš„æ¯ä¸ªè§†å›¾ã€‚ æœ€å¥½çš„æ–¹æ³•æ˜¯ä½¿ç”¨SwiftUIçš„ç¯å¢ƒã€‚ æ‚¨è¿˜å¯ä»¥å°†åŒ…å«æ•´ä¸ªåº”ç”¨ç¨‹åºçŠ¶æ€çš„å¯¹è±¡ä¼ é€’ç»™åŸºæœ¬è§†å›¾çš„ç¯å¢ƒã€‚ åŸºæœ¬è§†å›¾å°†ä¸æ‰€æœ‰å­è§†å›¾å…±äº«ç¯å¢ƒã€‚ è¦äº†è§£æœ‰å…³SwiftUIç¯å¢ƒçš„æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">SwiftUIå‡ºç‰ˆç‰©ä¸­çš„â€œç¯å¢ƒçš„åŠ›é‡â€</a> ã€‚ <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Store</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ObservableObject</span></span></span><span class="hljs-class"> </span></span>{ @<span class="hljs-type"><span class="hljs-type">Published</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">set</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> state: <span class="hljs-type"><span class="hljs-type">AppState</span></span> }</code> </pre><br> åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª<i>å­˜å‚¨</i>å¯¹è±¡ï¼Œè¯¥å¯¹è±¡å­˜å‚¨åº”ç”¨ç¨‹åºçš„çŠ¶æ€å¹¶æä¾›å¯¹å…¶çš„åªè¯»è®¿é—®ã€‚  Stateå±æ€§ä½¿ç”¨<i>@Published</i>å±æ€§çš„åŒ…è£…ï¼Œè¯¥åŒ…è£…å°†ä»»ä½•æ›´æ”¹é€šçŸ¥SwiftUIã€‚ å®ƒä½¿æ‚¨å¯ä»¥ä¸æ–­æ›´æ–°æ•´ä¸ªåº”ç”¨ç¨‹åºï¼Œä»å•ä¸ªçœŸå®å€¼æºä¸­æ´¾ç”Ÿå®ƒã€‚ åœ¨å‰é¢çš„æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬è®¨è®ºäº†å­˜å‚¨å¯¹è±¡ï¼Œè¦äº†è§£æ›´å¤šä¿¡æ¯ï¼Œæ‚¨éœ€è¦é˜…è¯»æ–‡ç« â€œ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åœ¨SwiftUIä¸­ä½¿ç”¨å­˜å‚¨å¯¹è±¡å¯¹åº”ç”¨ç¨‹åºçŠ¶æ€è¿›è¡Œå»ºæ¨¡</a> â€ã€‚ <br><br><h3> å‡é€Ÿå™¨å’ŒåŠ¨ä½œ </h3><br> ç°åœ¨è¯¥è®¨è®ºå¯¼è‡´çŠ¶æ€æ›´æ”¹çš„ç”¨æˆ·æ“ä½œã€‚ åŠ¨ä½œæ˜¯æè¿°çŠ¶æ€å˜åŒ–çš„ç®€å•æšä¸¾æˆ–æšä¸¾çš„é›†åˆã€‚ ä¾‹å¦‚ï¼Œåœ¨æ•°æ®é‡‡æ ·æœŸé—´è®¾ç½®è´Ÿè½½å€¼ï¼Œå°†ç»“æœå­˜å‚¨åº“åˆ†é…ç»™stateå±æ€§ï¼Œç­‰ç­‰ã€‚ ç°åœ¨è€ƒè™‘å¯¹Actionè¿›è¡Œæšä¸¾çš„ç¤ºä¾‹ä»£ç ã€‚ <br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">enum</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AppAction</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> search(query: <span class="hljs-type"><span class="hljs-type">String</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> setSearchResult(repos: [<span class="hljs-type"><span class="hljs-type">Repo</span></span>]) }</code> </pre><br>  <i>Reducer</i>æ˜¯ä¸€ç§åŠŸèƒ½ï¼Œå®ƒé‡‡ç”¨å½“å‰çŠ¶æ€ï¼Œå¯¹è¯¥çŠ¶æ€æ‰§è¡Œæ“ä½œï¼Œç„¶åç”Ÿæˆä¸€ä¸ªæ–°çŠ¶æ€ã€‚ é€šå¸¸ï¼Œ <i>å‡é€Ÿå™¨</i>æˆ–<i>å‡é€Ÿå™¨çš„</i> <i>ç»„æˆ</i>æ˜¯çŠ¶æ€æ›´æ”¹çš„åº”ç”¨ç¨‹åºä¸­å”¯ä¸€çš„ä½ç½®ã€‚ å•ä¸ªåŠŸèƒ½å¯ä»¥æ›´æ”¹åº”ç”¨ç¨‹åºçš„æ•´ä¸ªçŠ¶æ€çš„äº‹å®ä½¿ä»£ç éå¸¸ç®€å•ï¼Œæ˜“äºæµ‹è¯•å’Œæ˜“äºè°ƒè¯•ã€‚ ä»¥ä¸‹æ˜¯reduceå‡½æ•°çš„ç¤ºä¾‹ã€‚ <br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Reducer</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">State</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Action</span></span></span><span class="hljs-class">&gt; </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> <span class="hljs-built_in"><span class="hljs-built_in">reduce</span></span>: (<span class="hljs-keyword"><span class="hljs-keyword">inout</span></span> <span class="hljs-type"><span class="hljs-type">State</span></span>, <span class="hljs-type"><span class="hljs-type">Action</span></span>) -&gt; <span class="hljs-type"><span class="hljs-type">Void</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> appReducer: <span class="hljs-type"><span class="hljs-type">Reducer</span></span>&lt;<span class="hljs-type"><span class="hljs-type">AppState</span></span>, <span class="hljs-type"><span class="hljs-type">AppAction</span></span>&gt; = <span class="hljs-type"><span class="hljs-type">Reducer</span></span> { state, action <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> action { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> .setSearchResults(repos): state.searchResult = repos } }</code> </pre><br><h3> å•å‘æµ </h3><br> ç°åœ¨è¯¥è®¨è®ºæ•°æ®æµäº†ã€‚ æ¯ä¸ªè§†å›¾éƒ½å¯ä»¥é€šè¿‡å­˜å‚¨å¯¹è±¡å¯¹çŠ¶æ€è¿›è¡Œåªè¯»è®¿é—®ã€‚ è§†å›¾å¯ä»¥å°†æ“ä½œå‘é€åˆ°å­˜å‚¨åº“å¯¹è±¡ã€‚  Reduceræ›´æ”¹çŠ¶æ€ï¼Œç„¶åSwiftUIé€šçŸ¥æ‰€æœ‰çŠ¶æ€æ›´æ”¹è§†å›¾ã€‚  SwiftUIå…·æœ‰è¶…é«˜æ•ˆçš„æ¯”è¾ƒç®—æ³•ï¼Œå› æ­¤æ˜¾ç¤ºæ•´ä¸ªåº”ç”¨ç¨‹åºçš„çŠ¶æ€å’Œæ›´æ–°æ›´æ”¹çš„è§†å›¾éå¸¸å¿«ã€‚ <br><br>  <b>çŠ¶æ€-&gt;è§†å›¾-&gt;æ“ä½œ-&gt;çŠ¶æ€-&gt;è§†å›¾</b> <br><br> è¯¥ä½“ç³»ç»“æ„ä»…å›´ç»•å•å‘æ•°æ®æµå·¥ä½œã€‚ è¿™æ„å‘³ç€åº”ç”¨ç¨‹åºä¸­çš„æ‰€æœ‰æ•°æ®éƒ½éµå¾ªç›¸åŒçš„æ¨¡å¼ï¼Œè¿™ä½¿å¾—åˆ›å»ºçš„åº”ç”¨ç¨‹åºçš„é€»è¾‘æ›´å¯é¢„æµ‹ä¸”æ›´æ˜“äºç†è§£ã€‚ è®©æˆ‘ä»¬æ›´æ”¹storeå¯¹è±¡ä»¥æ”¯æŒæäº¤æ“ä½œã€‚ <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Store</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">State</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Action</span></span></span><span class="hljs-class">&gt;: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ObservableObject</span></span></span><span class="hljs-class"> </span></span>{ @<span class="hljs-type"><span class="hljs-type">Published</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">set</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> state: <span class="hljs-type"><span class="hljs-type">State</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> appReducer: <span class="hljs-type"><span class="hljs-type">Reducer</span></span>&lt;<span class="hljs-type"><span class="hljs-type">State</span></span>, <span class="hljs-type"><span class="hljs-type">Action</span></span>&gt; <span class="hljs-keyword"><span class="hljs-keyword">init</span></span>(initialState: <span class="hljs-type"><span class="hljs-type">State</span></span>, appReducer: @escaping <span class="hljs-type"><span class="hljs-type">Reducer</span></span>&lt;<span class="hljs-type"><span class="hljs-type">State</span></span>, <span class="hljs-type"><span class="hljs-type">Action</span></span>&gt;) { <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.state = initialState <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.appReducer = appReducer } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">send</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> action: Action)</span></span></span></span> { appReducer.<span class="hljs-built_in"><span class="hljs-built_in">reduce</span></span>(&amp;state, action) } }</code> </pre><br><h3> å‰¯ä½œç”¨ </h3><br> æˆ‘ä»¬å·²ç»å®ç°äº†ä¸€ä¸ª<b>å•å‘</b>æµï¼Œè¯¥æµå¯ä»¥æ¥å—ç”¨æˆ·æ“ä½œå¹¶æ›´æ”¹çŠ¶æ€ï¼Œä½†æ˜¯å¼‚æ­¥æ“ä½œåˆå¦‚ä½•å‘¢ï¼Ÿæˆ‘ä»¬é€šå¸¸å°†å…¶ç§°ä¸º<i>å‰¯ä½œç”¨</i> ã€‚ å¦‚ä½•ä¸ºä½¿ç”¨çš„å­˜å‚¨ç±»å‹æ·»åŠ å¼‚æ­¥ä»»åŠ¡æ”¯æŒï¼Ÿ æˆ‘è®¤ä¸ºæ˜¯æ—¶å€™ä»‹ç»ä½¿ç”¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Combine Frameworkäº†</a> ï¼Œå®ƒæ˜¯å¤„ç†å¼‚æ­¥ä»»åŠ¡çš„ç†æƒ³é€‰æ‹©ã€‚ <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Foundation <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Combine protocol Effect { associatedtype Action func mapToAction() -&gt; AnyPublisher&lt;Action, Never&gt; } enum SideEffect: Effect { case search(query: String) func mapToAction() -&gt; AnyPublisher&lt;Action, Never&gt; { switch self { case let .search(query): return dependencies.githubService .searchPublisher(matching: query) .replaceError(with: []) .map { AppAction.setSearchResults(repos: $0) } .eraseToAnyPublisher() } } }</code> </pre><br> é€šè¿‡å¼•å…¥æ•ˆæœåè®®ï¼Œæˆ‘ä»¬å¢åŠ äº†å¯¹<i>å¼‚æ­¥ä»»åŠ¡</i>çš„æ”¯æŒã€‚  <b>æ•ˆæœ</b>æ˜¯ä¸€ä¸ªåŠ¨ä½œåºåˆ—ï¼Œå¯ä»¥ä½¿ç”¨<b>Combineæ¡†æ¶çš„Publisher</b>ç±»å‹<b>æ¥å‘å¸ƒ</b> ã€‚ è¿™ä½¿æ‚¨å¯ä»¥ä½¿ç”¨Combineå¤„ç†å¼‚æ­¥ä½œä¸šï¼Œç„¶åå‘å¸ƒreducerç”¨äºå°†æ“ä½œåº”ç”¨äºå½“å‰çŠ¶æ€çš„æ“ä½œã€‚ <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Store</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">State</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Action</span></span></span><span class="hljs-class">&gt;: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ObservableObject</span></span></span><span class="hljs-class"> </span></span>{ @<span class="hljs-type"><span class="hljs-type">Published</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">set</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> state: <span class="hljs-type"><span class="hljs-type">State</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> appReducer: <span class="hljs-type"><span class="hljs-type">Reducer</span></span>&lt;<span class="hljs-type"><span class="hljs-type">State</span></span>, <span class="hljs-type"><span class="hljs-type">Action</span></span>&gt; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> cancellables: <span class="hljs-type"><span class="hljs-type">Set</span></span>&lt;<span class="hljs-type"><span class="hljs-type">AnyCancellable</span></span>&gt; = [] <span class="hljs-keyword"><span class="hljs-keyword">init</span></span>(initialState: <span class="hljs-type"><span class="hljs-type">State</span></span>, appReducer: <span class="hljs-type"><span class="hljs-type">Reducer</span></span>&lt;<span class="hljs-type"><span class="hljs-type">State</span></span>, <span class="hljs-type"><span class="hljs-type">Action</span></span>&gt;) { <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.state = initialState <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.appReducer = appReducer } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">send</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> action: Action)</span></span></span></span> { appReducer.<span class="hljs-built_in"><span class="hljs-built_in">reduce</span></span>(&amp;state, action) } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">send</span></span></span><span class="hljs-function">&lt;E: Effect&gt;</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> effect: E)</span></span></span></span> <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> <span class="hljs-type"><span class="hljs-type">E</span></span>.<span class="hljs-type"><span class="hljs-type">Action</span></span> == <span class="hljs-type"><span class="hljs-type">Action</span></span> { effect .mapToAction() .receive(on: <span class="hljs-type"><span class="hljs-type">DispatchQueue</span></span>.main) .sink(receiveValue: send) .store(<span class="hljs-keyword"><span class="hljs-keyword">in</span></span>: &amp;cancellables) } }</code> </pre><br><h3> å®é™…ä¾‹å­ </h3><br> æœ€åï¼Œæˆ‘ä»¬å¯ä»¥å®Œæˆå­˜å‚¨åº“æœç´¢åº”ç”¨ç¨‹åºï¼Œè¯¥åº”ç”¨ç¨‹åºå¼‚æ­¥è°ƒç”¨<i>Github API</i>å¹¶é€‰æ‹©ä¸æŸ¥è¯¢åŒ¹é…çš„å­˜å‚¨åº“ã€‚ è¯¥åº”ç”¨ç¨‹åºçš„å®Œæ•´æºä»£ç å¯åœ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Githubä¸Šæ‰¾åˆ°</a> ã€‚ <br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SearchContainerView</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">View</span></span></span><span class="hljs-class"> </span></span>{ @<span class="hljs-type"><span class="hljs-type">EnvironmentObject</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> store: <span class="hljs-type"><span class="hljs-type">Store</span></span>&lt;<span class="hljs-type"><span class="hljs-type">AppState</span></span>, <span class="hljs-type"><span class="hljs-type">AppAction</span></span>&gt; @<span class="hljs-type"><span class="hljs-type">State</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> query: <span class="hljs-type"><span class="hljs-type">String</span></span> = <span class="hljs-string"><span class="hljs-string">"Swift"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> body: some <span class="hljs-type"><span class="hljs-type">View</span></span> { <span class="hljs-type"><span class="hljs-type">SearchView</span></span>( query: $query, repos: store.state.searchResult, onCommit: fetch ).onAppear(perform: fetch) } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fetch</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { store.send(<span class="hljs-type"><span class="hljs-type">SideEffect</span></span>.search(query: query)) } } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SearchView</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">View</span></span></span><span class="hljs-class"> </span></span>{ @<span class="hljs-type"><span class="hljs-type">Binding</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> query: <span class="hljs-type"><span class="hljs-type">String</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> repos: [<span class="hljs-type"><span class="hljs-type">Repo</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> onCommit: () -&gt; <span class="hljs-type"><span class="hljs-type">Void</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> body: some <span class="hljs-type"><span class="hljs-type">View</span></span> { <span class="hljs-type"><span class="hljs-type">NavigationView</span></span> { <span class="hljs-type"><span class="hljs-type">List</span></span> { <span class="hljs-type"><span class="hljs-type">TextField</span></span>(<span class="hljs-string"><span class="hljs-string">"Type something"</span></span>, text: $query, onCommit: onCommit) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> repos.isEmpty { <span class="hljs-type"><span class="hljs-type">Text</span></span>(<span class="hljs-string"><span class="hljs-string">"Loading..."</span></span>) } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-type"><span class="hljs-type">ForEach</span></span>(repos) { repo <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-type"><span class="hljs-type">RepoRow</span></span>(repo: repo) } } }.navigationBarTitle(<span class="hljs-type"><span class="hljs-type">Text</span></span>(<span class="hljs-string"><span class="hljs-string">"Search"</span></span>)) } } }</code> </pre><br> å°†å±å¹•åˆ†ä¸ºä¸¤ä¸ªè§†å›¾ï¼š <i>å®¹å™¨è§†å›¾</i>å’Œ<i>æ¸²æŸ“è§†å›¾</i> ã€‚  <b>å®¹å™¨è§†å›¾</b>æ§åˆ¶åŠ¨ä½œå¹¶ä»<b>å…¨å±€çŠ¶æ€ä¸­</b>é€‰æ‹©å¿…è¦çš„éƒ¨åˆ†ã€‚  <b>æ¸²æŸ“è§†å›¾</b>æ¥æ”¶æ•°æ®å¹¶æ˜¾ç¤ºå®ƒä»¬ã€‚ æˆ‘ä»¬å·²ç»åœ¨ä¹‹å‰çš„æ–‡ç« ä¸­è®¨è®ºäº†å®¹å™¨è§†å›¾ï¼Œè¦äº†è§£æ›´å¤šï¼Œè¯·ç‚¹å‡»é“¾æ¥â€œ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åœ¨SwiftUIä¸­ä»‹ç»å®¹å™¨è§†å›¾</a> â€ <br><br><h3> ç»“è®º </h3><br> ä»Šå¤©ï¼Œæˆ‘ä»¬å­¦ä¹ äº†å¦‚ä½•åœ¨åˆ›å»ºæ—¶è€ƒè™‘åˆ°<i>å‰¯ä½œç”¨çš„ç±»ReduxçŠ¶æ€å®¹å™¨</i> ã€‚ ä¸ºæ­¤ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†SwiftUIç¯å¢ƒåŠŸèƒ½å’ŒCombineæ¡†æ¶ã€‚ å¸Œæœ›æœ¬æ–‡å¯¹æ‚¨æœ‰æ‰€å¸®åŠ©ã€‚ <br><br> æ„Ÿè°¢æ‚¨çš„é˜…è¯»ï¼Œå¾ˆå¿«å†è§ï¼ </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN476398/">https://habr.com/ru/post/zh-CN476398/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN476380/index.html">åŠ å¯†è´§å¸äº¤æ˜“-å¦‚ä½•åˆ¶å®šå¯æŒç»­å‘å±•ç­–ç•¥</a></li>
<li><a href="../zh-CN476382/index.html">å…·æœ‰14ä¸ªé…çº¿æ¶çš„æœåŠ¡å™¨æœºæŸœæˆ–åœ¨æœåŠ¡å™¨æœºæˆ¿ä¸­ä½¿ç”¨äº†5å¤©</a></li>
<li><a href="../zh-CN476384/index.html">å¦‚ä½•è®¾è®¡è®¾å¤‡å¤–å£³ã€‚ å®Œæ•´æŒ‡å—</a></li>
<li><a href="../zh-CN476394/index.html">æˆ‘å¦‚ä½•å¼€å§‹è¿›è¡Œè¥é”€</a></li>
<li><a href="../zh-CN476396/index.html">å£°éŸ³å®šä½ï¼šå¤§è„‘å¦‚ä½•è¯†åˆ«å£°æº</a></li>
<li><a href="../zh-CN476404/index.html">å®‰å…¨å‘¨åˆŠ47ï¼šéåŒå¯»å¸¸çš„æ¼æ´</a></li>
<li><a href="../zh-CN476406/index.html">çº¦ä¼šä¸­çš„ç¥ç»ç½‘ç»œ</a></li>
<li><a href="../zh-CN476408/index.html">ææ¬¾</a></li>
<li><a href="../zh-CN476412/index.html">Hannes Lindemannè¯‰Alain Bombardï¼šæ­ç©¿ç¥è¯ï¼Ÿ</a></li>
<li><a href="../zh-CN476414/index.html">è¯†åˆ«Linuxç£ç›˜æ´»åŠ¨</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>