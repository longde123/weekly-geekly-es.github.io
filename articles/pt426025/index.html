<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🌽 🧔🏽 👩🏽‍🚒 Usando métodos ofensivos para enriquecer a Inteligência de Ameaças 🏠 📄 🚈</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hoje, a Threat Intelligence, ou a coleta ativa de informações sobre ameaças à segurança da informação, é uma ferramenta essencial no processo de ident...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Usando métodos ofensivos para enriquecer a Inteligência de Ameaças</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/jetinfosystems/blog/426025/"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/440/45a/1d4/44045a1d4cbaec976766cd6206eee205.jpg" width="500"></div><br>  Hoje, a Threat Intelligence, ou a coleta ativa de informações sobre ameaças à segurança da informação, é uma ferramenta essencial no processo de identificação de incidentes de segurança da informação.  As fontes típicas de TI incluem assinaturas gratuitas com indicadores maliciosos, boletins de fabricantes de hardware e software que descrevem vulnerabilidades, relatórios de pesquisadores de segurança com descrições detalhadas de ameaças, além de assinaturas comerciais de fornecedores de TI.  Além disso, muitas vezes as informações obtidas usando as fontes acima não têm um grau suficiente de abrangência e relevância.  O uso de OSINT (inteligência de código aberto) e métodos ofensivos (ou seja, métodos que não são característicos do defensor, mas do atacante) na segurança da informação, que serão discutidos neste artigo, podem contribuir para melhorar a eficiência e melhorar a qualidade da TI. <br><a name="habracut"></a><br><h2>  AVISO LEGAL </h2><br>  Este artigo é apenas para fins informativos.  O autor não é responsável por possíveis danos e / ou interrupção das redes e / ou serviços de terceiros associados à execução de determinadas ações descritas no artigo.  O autor também incentiva os leitores a cumprir a lei. <br><br><h2>  Não em vez disso, mas juntos </h2><br>  Gostaria de fazer uma reserva imediatamente de que não se trata de recusar ou substituir as informações de Inteligência contra Ameaças recebidas de fontes tradicionais pagas e gratuitas, mas de complementá-las e enriquecê-las. <br><br>  Portanto, o uso de métodos adicionais de TI pode aumentar sua eficiência e ajudar na solução de vários problemas.  Por exemplo, com a próxima epidemia de IoT afetando certas versões vulneráveis ​​de firmware, em quanto tempo posso obter um feed com os endereços IP de dispositivos potencialmente vulneráveis ​​para detectar rapidamente suas atividades no perímetro?  Ou quando as regras do sistema de monitoramento são acionadas por um indicador (endereço IP ou nome de domínio) marcado como malicioso há um ano ou mais, como entender se ele ainda permanece malicioso, desde que você inicie alguma verificação adicional do indicador como "Por enquanto" é geralmente impossível. <br><br>  Ou seja, a adição e o enriquecimento serão especialmente úteis para indicadores de meia-idade, de acordo com a “pirâmide da dor” de David Bianco <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">[0]</a> (endereços IP, nomes de domínio, artefatos de rede), no entanto, em algumas circunstâncias, é possível obter novos indicadores de longa duração (acima da pirâmide) analistas. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/946/868/d57/946868d575b064e8f552c06fa0b8c363.png"><br><br><h2>  Verificação na Internet </h2><br>  Um dos métodos úteis para obter a Inteligência de ameaças é a verificação em rede. <br><br><div class="spoiler">  <b class="spoiler_title">O que geralmente é coletado ao digitalizar</b> <div class="spoiler_text">  Na maioria das vezes, ao realizar uma varredura, os resultados mais interessantes são obtidos coletando os chamados "banners" - as respostas do software aplicativo do sistema varrido às solicitações do scanner.  Os "banners" contêm muitos dados que identificam o software aplicativo e seus vários parâmetros no "outro lado", e essa verificação é feita rapidamente. </div></div><br>  Ao resolver a tarefa de expandir o escopo da Inteligência contra ameaças, a verificação terá como alvo toda a Internet.  Ao digitalizar um espaço de endereço público (~ 3,7 bilhões de endereços IPv4, excluindo endereços reservados), você pode extrair as seguintes informações úteis: <br><br><ul><li>  Quais nós são vulneráveis ​​a vulnerabilidades amplamente exploradas como parte de campanhas maliciosas reais e, em vista desse fato, são fontes potenciais de exposição maliciosa. </li><li>  Quais nós são os servidores de controle das redes botnet <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">[1]</a> , acessos aos quais podem ser identificados por um nó comprometido no perímetro protegido. </li><li>  Quais nós pertencem à parte não pública das redes anônimas distribuídas, que podem ser usadas para saída discretamente descontrolada fora do perímetro protegido. </li><li>  Informações mais detalhadas sobre os nós "acenderam" na operação do sistema de monitoramento. </li></ul><br><h2>  Seleção de ferramenta </h2><br>  Ao longo dos anos de desenvolvimento de redes de informação, um grande número de ferramentas para digitalização em rede foi criado.  Entre o software atual, os seguintes scanners podem ser distinguidos: <br><br><ul><li>  Nmap <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">[2]</a> </li><li>  Zmap <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">[3]</a> </li><li>  Masscan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">[4]</a> </li></ul><br>  Considere brevemente as principais vantagens e desvantagens dessas ferramentas para o enriquecimento da TI no espaço da Internet. <br><br><h4>  Nmap </h4><br>  Talvez o scanner de rede mais famoso, criado há 20 anos.  Devido à possibilidade de usar scripts personalizados (por meio do Nmap Scripting Engine), essa é uma ferramenta extremamente flexível, não se limitando apenas à coleta de "banners" aplicados.  No momento, um número bastante grande de scripts NSE foi gravado, muitos dos quais estão disponíveis gratuitamente.  Como o Nmap monitora cada conexão, ou seja, possui uma natureza síncrona, não vale a pena usá-la em grandes redes como a Internet devido à baixa velocidade do scanner.  Ao mesmo tempo, é aconselhável usar essa ferramenta em pequenas amostras de endereços obtidos por ferramentas mais rápidas, devido ao poder do NSE. <br><br><div class="spoiler">  <b class="spoiler_title">Sobre a velocidade do Nmap</b> <div class="spoiler_text">  Apesar da baixa produtividade inicialmente, desde o lançamento deste scanner, seus desenvolvedores adicionaram muitos recursos que aumentam a velocidade da digitalização.  Entre eles estão os modos operacionais paralelos e a tarefa de classificar em pacotes por segundo.  No entanto, mesmo com configurações distorcidas, o Nmap fica atrás dos concorrentes assíncronos em velocidade.  Usando o exemplo de varredura / 15 sub-redes em uma porta 443 / tcp de uma máquina virtual com 1 CPU Xeon Gold 6140 e um canal de gigabit, obtemos: <br><br><ul><li> 71,08 segundos para o Nmap com os parâmetros <code>-T5 -n -Pn -p 443 --open --min-rate 1000000 --randomize-hosts --defeat-rst-ratelimit –oG nmap.txt</code> </li><li>  9,15 segundos para o Zmap com os parâmetros <code>-p 443 –o zmap.txt</code> </li></ul><br></div></div><br><h4>  Zmap </h4><br>  Um scanner de rede assíncrono bastante conhecido, embora não o primeiro de seu tipo, que apareceu em 2013.  De acordo com o relatório dos desenvolvedores publicado na 22ª conferência do USENIX Security Simposium <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">[5]</a> , a ferramenta pode escanear todo o intervalo de endereços públicos, executado em um computador comum com conexão à Internet em gigabit, em menos de 45 minutos (através de uma porta).  Os benefícios do Zmap incluem: <br><br><ul><li>  Alta velocidade;  usando a estrutura PF_RING e uma conexão de 10 gigabit, o tempo teórico de varredura de um espaço de endereço IPv4 público é de 5 minutos (uma porta). </li><li>  Suporte para verificação aleatória de endereços de rede. </li><li>  Suporte de módulo para varreduras TCP SYN, ICMP, consultas DNS, UPnP, BACNET <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">[6]</a> , som UDP. </li><li>  Presença nos repositórios de distribuições comuns do GNU / Linux (além disso, há suporte para Mac OS e BSD). </li><li>  Além do Zmap, vários projetos de utilitários relacionados foram desenvolvidos para ampliar a funcionalidade do scanner. </li></ul><br>  Se falarmos sobre as desvantagens do Zmap, aqui podemos observar a capacidade de verificar endereços em apenas uma porta no momento. <br><br>  Dos projetos relacionados ao Zmap, expandindo sua funcionalidade para tarefas de interesse, podemos destacar: <br><br><ul><li>  O ZGrab é um scanner de protocolo de aplicativo com suporte para os protocolos TTP, HTTPS, SSH, Telnet, FTP, SMTP, POP3, IMAP, Modbus, BACNET, Siemens S7 e Tridium Fox (grabber de banner com recursos avançados). </li><li>  O ZDNS é um utilitário para consultas rápidas de DNS. </li><li>  O ZTag é um utilitário para marcar os resultados da verificação fornecidos pelo ZGrab. </li><li>  O ZBrowse é um utilitário de distribuição sem cabeça baseado no Chrome para rastrear alterações no conteúdo do site. </li></ul><br><div class="spoiler">  <b class="spoiler_title">Sobre os recursos do ZGrab</b> <div class="spoiler_text">  O scanner avançado dos protocolos de aplicativos ZGrab, para os quais a versão 2.0 já foi lançada (não há paridade funcional completa com a versão 1.X, mas será alcançada em um futuro próximo, após o qual será possível falar sobre a substituição completa da versão antiga por uma nova), o que permite filtrar os resultados com bastante flexibilidade digitalização graças ao suporte ao formato de saída estruturada (JSON).  Por exemplo, para coletar apenas o emissor e o assunto do nome distinto dos certificados HTTPS, basta um comando simples: <br><br><pre> <code class="hljs powershell">zmap -<span class="hljs-literal"><span class="hljs-literal">-target</span></span><span class="hljs-literal"><span class="hljs-literal">-port</span></span>=<span class="hljs-number"><span class="hljs-number">443</span></span> -<span class="hljs-literal"><span class="hljs-literal">-output</span></span><span class="hljs-literal"><span class="hljs-literal">-fields</span></span>=saddr | ./zgrab2 tls <span class="hljs-literal"><span class="hljs-literal">-o</span></span> - | jq <span class="hljs-string"><span class="hljs-string">'.ip + "|" + .data.tls.result.handshake_log.server_certificates.certificate.parsed.issuer_dn + "|" + .data.tls.result.handshake_log.server_certificates.certificate.parsed.subject_dn'</span></span> &gt; zmap<span class="hljs-literal"><span class="hljs-literal">-dn</span></span><span class="hljs-literal"><span class="hljs-literal">-443</span></span>.txt</code> </pre> <br></div></div><br><h4>  Masscan </h4><br>  O scanner assíncrono, criado no mesmo ano que o Zmap, é semelhante em sintaxe de comando ao Nmap. <br><br>  O criador (Robert David Graham) declarou maior produtividade do que todos os scanners assíncronos existentes na época, incluindo o Zmap, alcançados com o uso de uma pilha TCP / IP personalizada. <br><br>  Vantagens do scanner: <br><br><ul><li>  Alta velocidade com desempenho teórico de até 10 milhões de pacotes por segundo, o que permite digitalizar todo o espaço público IPv4 em alguns minutos (em uma porta) em uma conexão de 10 gigabits - o mesmo que no Zmap usando a estrutura PF_RING. </li><li>  Suporte para protocolos TCP, SCTP e UDP (via envio de cargas UDP do Nmap). </li><li>  Suporte para verificação aleatória de endereços de rede. </li><li>  Suporte para selecionar o intervalo de IP e o intervalo de portas ao digitalizar. </li><li>  Suporte para vários formatos para gerar resultados de varredura (XML, grepable, JSON, binário, como uma lista). </li></ul><br>  Ao mesmo tempo, o scanner tem várias desvantagens: <br><br><ul><li>  Em conexão com o uso de uma pilha TCP / IP personalizada, é recomendável executar uma varredura em um IP dedicado para evitar conflitos com a pilha do SO. </li><li>  Comparado ao ZGrab, as possibilidades do banner grabber são bastante limitadas. </li></ul><br><h4>  Gráfico de comparação do scanner </h4><br>  A tabela de resumo abaixo fornece uma comparação da funcionalidade desses scanners. <br><br><div class="spoiler">  <b class="spoiler_title">Valores nas linhas da tabela</b> <div class="spoiler_text">  "++" - muito bem implementado <br>  "+" - implementado <br>  "±" - implementado com restrições <br>  "-" - não implementado </div></div><br><img src="https://habrastorage.org/getpro/habr/post_images/253/a0d/74e/253a0d74ef6cf82937472729a65f1cd0.png"><br><br><h2>  Selecionando destinos e método de verificação </h2><br>  Depois de escolher quais ferramentas usar, você precisa decidir sobre o objeto e a finalidade da verificação, ou seja, entender o que e por que fazer a verificação.  Se o primeiro, via de regra, não surgir nenhuma dúvida (este é um espaço de endereço IPv4 público com várias exceções), e no segundo tudo depende do resultado final desejado.  Por exemplo: <br><br><ul><li>  Para identificar nós que estão sujeitos a uma vulnerabilidade específica, é razoável primeiro percorrer o intervalo verificado com uma ferramenta rápida (Zmap, Masscan) para identificar nós com portas abertas de serviços vulneráveis;  após finalizar a lista de endereços, vale a pena usar o Nmap com o script NSE correspondente, se houver, ou criar um script personalizado com base nas informações disponíveis sobre a vulnerabilidade nas publicações dos pesquisadores de segurança.  Às vezes, um grep simples é suficiente para banners de aplicativos coletados, porque muitos serviços exibem informações sobre sua versão nele. </li><li>  Para identificar os nós da infraestrutura oculta - redes anônimas e nós C2 (ou seja, os servidores de controle das redes botnet) - será necessário compilar cargas úteis / análises personalizadas. </li><li>  Para resolver uma ampla variedade de problemas na identificação de nós comprometidos, partes da infraestrutura de redes anônimas e outras coisas, a coleta e a análise de certificados podem dar muito durante os handshakes do TLS. </li></ul><br><h2>  Escolha da infraestrutura </h2><br>  O fato de os scanners rápidos modernos poderem mostrar resultados impressionantes em recursos bastante modestos do processador médio não significa que a carga na infraestrutura de rede seja insignificante.  Devido às especificidades do tráfego gerado durante a verificação, é obtida uma taxa suficientemente significativa de pacotes por segundo.  Segundo a experiência, um núcleo do processador médio (em uma CPU de produção dos últimos anos, em um ambiente virtual, em qualquer sistema operacional, sem nenhum ajuste da pilha TCP / IP) é capaz de gerar um fluxo da ordem de 100 a 150 mil pacotes por segundo por faixa de ~ 50 Mb / s , que é um fardo sério para roteadores de software.  Os equipamentos de rede de hardware também podem ter problemas para atingir o limite de desempenho do ASIC.  Ao mesmo tempo, a uma velocidade de varredura de 100-150 Kpps (mil pacotes por segundo), ignorar o intervalo público de IPv4 pode levar mais de 10 horas, ou seja,  uma quantidade bastante significativa de tempo.  Para uma varredura realmente rápida, você deve usar uma rede distribuída de nós de varredura que divide o pool varrido em partes.  Uma ordem de varredura aleatória também é necessária para que a utilização dos canais da Internet e o carregamento em lote de equipamentos de fornecedores na “última milha” não sejam significativos. <br><br><h2>  Dificuldades e momentos “sutis” </h2><br><img src="https://habrastorage.org/getpro/habr/post_images/a07/061/a45/a07061a458b372bd5bddbec15b9fb7a5.jpg"><br><br>  Na prática, ao realizar varreduras em rede de massa, pode-se encontrar uma série de dificuldades, tanto de natureza tecnológica quanto jurídica-organizacional. <br><br><h4>  Problemas de desempenho e disponibilidade </h4><br>  Como mencionado anteriormente, a verificação em rede em massa cria um fluxo de tráfego com um alto valor de PPS, causando uma grande carga na infraestrutura local e na rede do provedor à qual os nós de verificação estão conectados.  Antes de realizar qualquer varredura para fins de pesquisa, é imprescindível coordenar todas as ações com administradores locais e representantes do fornecedor.  Por outro lado, problemas de desempenho podem ocorrer nos nós de varredura final ao alugar servidores virtuais em serviços de hospedagem na Internet. <br><br><div class="spoiler">  <b class="spoiler_title">Nem todos os VPS são igualmente úteis.</b> <div class="spoiler_text">  No VPS alugado de hosts não convencionais, pode-se encontrar uma situação em que nas VMs produtivas (várias vCPUs e alguns gigabytes de memória), as taxas de pacotes Zmap e Masscan não ultrapassam algumas dezenas de Kpps.  Na maioria das vezes, a combinação de hardware desatualizado e uma combinação não ideal de software para ambiente virtual desempenha um papel negativo.  De uma maneira ou de outra, de acordo com a experiência do autor, garantias de desempenho mais ou menos substanciais podem ser obtidas apenas das empresas - líderes de mercado. </div></div><br>  Além disso, ao identificar nós vulneráveis, vale a pena considerar que determinadas verificações do NSE podem levar a uma negação de serviço nos nós verificados.  Esse desenvolvimento da situação não é simplesmente não ético, mas está definitivamente localizado fora do campo jurídico e implica o aparecimento de conseqüências na forma de responsabilidade penal. <br><br><h4>  O que estamos procurando e como? </h4><br>  Para encontrar algo, você precisa saber como procurar algo.  As ameaças estão em constante evolução e é necessário um novo estudo analítico para identificá-las.  Às vezes, as análises publicadas nos documentos de pesquisa ficam desatualizadas, levando-os a realizar suas próprias pesquisas. <br><br><div class="spoiler">  <b class="spoiler_title">Um exemplo famoso</b> <div class="spoiler_text">  Como exemplo, podemos fazer um estudo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">[5] de</a> 2013 pelos autores do Zmap, dedicado à identificação de nós de uma rede TOR.  No momento da publicação do documento, analisando a cadeia de certificados e identificando o nome do sujeito especialmente gerado nos certificados autoassinados, foram encontrados ~ 67 mil nós TOR trabalhando na porta tcp / 443 e ~ 2,9 mil nós trabalhando no tcp / 9001.  Atualmente, a lista de nós TOR detectados por esse método é muito menor (uma variedade maior de portas é usada, transportes obfs são usados, ocorre migração para certificados Let's Encrypt), o que força o uso de outros métodos analíticos para resolver um problema semelhante. </div></div><br><h4>  Reclamações de abuso </h4><br>  Ao digitalizar na Internet, existe quase um risco de 100% de receber um fluxo de reclamações de abuso.  Particularmente irritante é o abuso gerado automaticamente para algumas dezenas de pacotes SYN.  E se as verificações forem repetidas regularmente, as reclamações criadas manualmente também poderão fluir. <br><br><div class="spoiler">  <b class="spoiler_title">Quem reclama com mais frequência</b> <div class="spoiler_text">  As principais fontes de abuso (principalmente automáticas) são instituições educacionais na zona do domínio * .edu.  Por experiência, você deve evitar a digitalização de endereços de ASNs pertencentes à Indiana University (EUA).  Também nas apresentações de Zmap <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">[5]</a> e Masscan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">[7],</a> podemos encontrar alguns exemplos interessantes de resposta inadequada à digitalização em rede. </div></div><br>  Não tome esse abuso de ânimo leve, porque: <br><br><ul><li>  No caso de reclamações, o hoster geralmente bloqueia o tráfego de / para as máquinas virtuais alugadas ou até suspende sua operação. </li><li>  Um ISP pode desativar o uplink para eliminar os riscos de bloquear o sistema autônomo. </li></ul><br>  A melhor prática para minimizar reclamações é: <br><br><ol><li>  Familiaridade com os Termos de Serviço do seu provedor de Internet / hospedagem. </li><li>  Criando uma página de informações nos endereços de origem da verificação informando sobre o objetivo da verificação;  esclarecimentos apropriados nos registros DNS TXT. </li><li>  Esclarecimento das verificações ao receber reclamações de abuso. </li><li>  Manter uma lista de exclusões da verificação, adicionando à exclusão de sub-redes que se aplicam na primeira solicitação, fornecendo esclarecimentos sobre o procedimento para fazer exclusões na página de informações. </li><li>  A digitalização não é mais e não é mais frequente do que o necessário para resolver a tarefa. </li><li>  Distribuição do tráfego de digitalização por origem, endereços de destino e o horário em que é possível. </li></ol><br><h2>  Terceirização de digitalização em rede </h2><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/0ad/0fe/7bd/0ad0fe7bdfc413fb9e6326362bed1d9d.jpg" width="500"></div><br>  A realização de varreduras em massa independentes requer uma abordagem equilibrada (os riscos estão descritos acima), mas você deve estar ciente de que, se o processamento analítico dos resultados da varredura usados ​​não for suficientemente profundo, o resultado final poderá ser insatisfatório.  Pelo menos em termos técnicos, você pode facilitar a tarefa usando ferramentas comerciais existentes, como: <br><br><ul><li>  Shodan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">[8]</a> </li><li>  Censys <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">[9]</a> </li><li>  ZoomEye <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">[10]</a> </li></ul><br><div class="spoiler">  <b class="spoiler_title">Mais serviços</b> <div class="spoiler_text">  Além dos serviços mencionados, há um número bastante grande de projetos, de uma forma ou de outra conectados à digitalização em rede global.  Por exemplo: <br><br><ul><li>  Punk.sh (anteriormente mecanismo de pesquisa na web PunkSPIDER) </li><li>  Projeto Sonar (conjunto de dados com os resultados de varreduras de rede do Rapid7) </li><li>  Thingful (outro mecanismo de pesquisa da Internet das coisas) </li></ul></div></div><br><h2>  Shodan </h2><br><img src="https://habrastorage.org/getpro/habr/post_images/ce6/877/d6b/ce6877d6b6b39cb0639d148a7992e46e.jpg"><br><br>  O primeiro e mais famoso mecanismo de pesquisa de serviços publicados na Internet, que foi originalmente criado como um mecanismo de pesquisa da IoT e foi lançado em 2009 por John Materley <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">[11]</a> .  Atualmente, o mecanismo de busca oferece vários níveis de acesso às informações em si.  Sem registro, as possibilidades são muito básicas. Ao registrar e adquirir uma associação, as seguintes funcionalidades ficam disponíveis: <br><br><ul><li>  Pesquise por filtros básicos. </li><li>  Emitindo informações detalhadas sobre nós ("dados brutos"). </li><li>  Uma API "básica" com capacidade de integração com utilitários comuns como Maltego, Metasploit, Nmap e outros. </li><li>  A capacidade de exportar resultados de pesquisa (mediante taxa, por "Créditos" - a moeda interna do serviço). </li><li>  A capacidade de digitalizar, mediante solicitação, endereços e intervalos individuais (mediante taxa, por "Créditos"). </li></ul><br>  Os recursos mencionados já são suficientes para o OSINT básico <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">[12]</a> , no entanto, o mecanismo de pesquisa revela completamente seus recursos com uma assinatura Enterprise, a saber: <br><br><ul><li>  Verificação sob demanda de todo o intervalo público IPv4 da Internet, incluindo a verificação do intervalo especificado de portas e a especificação de coletores de banners específicos do protocolo. </li><li>  Notificações em tempo real com base nos resultados das verificações em execução. </li><li>  A capacidade de fazer upload de resultados brutos da varredura para análises adicionais (sem restrições, todo o banco de dados está disponível). </li><li>  A capacidade de desenvolver coletores personalizados para tarefas específicas (protocolos não padrão etc.). </li><li>  Acesso aos resultados históricos da verificação (até outubro de 2015). </li></ul><br>  O projeto Shodan criou vários projetos relacionados, como caçador de malware, verificação de honeypot, explorações, enriquecendo os resultados da verificação. <br><br><h2>  Censys </h2><br><img src="https://habrastorage.org/getpro/habr/post_images/29b/24e/4ef/29b24e4efeb65eb7c9d22fee64baa3e8.jpg"><br><br>  Motor de busca na IoT e não apenas, criado pelo autor do Zmap Zakir Durumerik e apresentado publicamente em 2015.  O mecanismo de pesquisa usa a tecnologia Zmap e vários projetos relacionados (ZGrab e ZTag).  Sem registro, diferentemente do Shodan, o mecanismo de pesquisa é limitado a 5 solicitações por dia a partir de um IP.  Após o registro, as possibilidades de uso são expandidas: uma API é exibida, os resultados da pesquisa para solicitações são aumentados (até 1000 resultados); no entanto, o acesso mais completo, incluindo o upload de dados históricos, fica disponível apenas no plano da empresa. <br><br>  As vantagens do mecanismo de pesquisa sobre Shodan incluem os seguintes recursos: <br><br><ul><li>  Não há restrições nos filtros de pesquisa nos planos tarifários básicos. </li><li>  Alta velocidade de atualização dos resultados da verificação automática (diariamente, de acordo com os autores; a velocidade do Shodan é muito menor). </li></ul><br>  As desvantagens incluem: <br><br><ul><li>  Menos portas digitalizadas em comparação com Shodan. </li><li>  Incapacidade de verificar “sob demanda” (por faixas de IP e por portas). </li><li>  Menos profundidade do enriquecimento dos resultados com os meios "prontos para uso" (o que é óbvio, dado o maior número de ferramentas Shodan implementadas por meio de projetos relacionados). </li></ul><br>  Se os resultados coletados no intervalo de portas suportadas pela Censys forem suficientes para atingir esse objetivo, a falta de capacidade de varredura sob demanda não deve ser um obstáculo sério devido à alta velocidade da atualização dos resultados da varredura. <br><br><h2>  Zoomeye </h2><br><img src="https://habrastorage.org/getpro/habr/post_images/b0a/9c4/46b/b0a9c446b5585b1256f1f707c2bdd40a.jpg"><br><br>  Um mecanismo de pesquisa de IoT criado pela empresa chinesa de segurança da informação Knowsec Inc em 2013.  Hoje, o mecanismo de pesquisa trabalha com seus próprios desenvolvimentos - Xmap (scanner host) e Wmap (web scanner).  O mecanismo de pesquisa coleta informações em uma ampla variedade de portas, ao pesquisar, é possível categorizar de acordo com um grande número de critérios (portas, serviços, SO, aplicativos) com detalhes para cada host (o conteúdo dos banners de aplicativos).  Os resultados da pesquisa listam possíveis vulnerabilidades para o software aplicativo identificado no projeto SeeBug relacionado (sem verificar a aplicabilidade).  Para contas registradas, uma API e uma pesquisa na web também estão disponíveis com um conjunto completo de filtros, mas com uma limitação no número de resultados exibidos.  Para remover restrições, propõe-se comprar um plano da empresa.  Das vantagens de um mecanismo de pesquisa, podemos observar: <br><br><ul><li>  Um grande número de portas digitalizadas (aproximadamente semelhante ao Shodan). </li><li>  Suporte expandido da web. </li><li>  Aplicativo e identificador do SO. </li></ul><br>  Entre as desvantagens estão: <br><br><ul><li>  Intervalo de atualização lento para resultados da verificação. </li><li>  Incapacidade de digitalizar sob demanda. </li><li>  O enriquecimento dos resultados da verificação limita-se à identificação de serviços, software aplicativo, SO e vulnerabilidades em potencial. </li></ul><br><h4>  Tabela de comparação de serviços </h4><br>  A tabela de resumo abaixo fornece uma comparação da funcionalidade dos serviços considerados. <br><br><div class="spoiler">  <b class="spoiler_title">Valores nas linhas da tabela</b> <div class="spoiler_text">  "++" - muito bem implementado <br>  "+" - implementado <br>  "±" - implementado com restrições <br>  "-" - não implementado </div></div><br><img src="https://habrastorage.org/getpro/habr/post_images/1fd/028/d58/1fd028d5843b449c8820b81d3f5d620f.png"><br><br><h2>  Digitalize você mesmo </h2><br>  A infraestrutura própria também pode ser uma fonte útil de TI, para que você possa entender quais novos hosts e serviços apareceram na rede, eles são vulneráveis ​​ou até maliciosos?  Se serviços externos puderem ser usados ​​para varrer o perímetro (por exemplo, esse caso de uso é oficialmente suportado pelo caso do usuário Shodan), todas as ações dentro do perímetro só poderão ser executadas independentemente.  A gama de ferramentas para análise de rede nesse caso pode ser bastante extensa: ambos são analisadores passivos, como Bro <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">[13]</a> , Argus <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">[14]</a> , Nfdump <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">[15]</a> , p0f <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">[16]</a> e scanners ativos - Nmap, Zmap, Masscan e seus concorrentes comerciais.  A estrutura do IVRE <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">[17]</a> , que permite obter sua própria ferramenta semelhante ao Shodan / Censys, pode ajudar a interpretar os resultados. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f32/ab2/cc3/f32ab2cc38acf9802402815b460574d0.jpg"><br><br>  A estrutura foi desenvolvida por um grupo de pesquisadores de segurança da informação, um dos autores é um desenvolvedor ativo do utilitário scapy <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">[18]</a> Pierre Lalet <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">[19]</a> .  Entre os recursos da estrutura incluem: <br><br><ul><li>  O uso de análise visual para identificar padrões e anormalidades anormais. </li><li>  Mecanismo de pesquisa avançado com análise detalhada dos resultados da verificação. </li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Integração com utilitários de terceiros por meio da API com suporte a Python. </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> O IVRE também é adequado para analisar grandes varreduras da Internet. </font></font><br><br><h2>  Conclusões </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A digitalização e a inteligência de rede ativa são excelentes ferramentas que há muito são utilizadas por vários pesquisadores no campo da segurança da informação. </font><font style="vertical-align: inherit;">No entanto, para guardas de segurança "clássicos", esses métodos de trabalho ainda são novos. </font><font style="vertical-align: inherit;">O uso de OSINT e métodos ofensivos em combinação com os meios defensivos clássicos fortalecerá significativamente a proteção e garantirá sua proatividade.</font></font><br><br><div class="spoiler">  <b class="spoiler_title">Referências</b> <div class="spoiler_text"> [0] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">https://detect-respond.blogspot.com/2013/03/the-pyramid-of-pain.html</a> <br> [1] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">https://malware-hunter.shodan.io/</a> <br> [2] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">https://nmap.org</a> <br> [3] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">https://zmap.io</a> <br> [4] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">https://github.com/robertdavidgraham/masscan</a> <br> [5] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">https://zmap.io/paper.pdf</a> <br> [6] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">https://en.wikipedia.org/wiki/BACnet</a> <br> [7] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">https://www.defcon.org/images/defcon-22/dc-22-presentations/Graham-McMillan-Tentler/DEFCON-22-Graham-McMillan-Tentler-Masscaning-the-Internet.pdf</a> <br> [8] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">https://shodan.io</a> <br> [9] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">https://censys.io</a> <br> [10] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">https://www.zoomeye.org</a> <br> [11] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">https://twitter.com/achillean</a> <br> [12] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">https://en.wikipedia.org/wiki/Open-source_intelligence</a> <br> [13] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">https://www.bro.org/</a> <br> [14] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">http://qosient.com/argus/</a> <br> [15] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">http://nfdump.sourceforge.net/</a> <br> [16] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">http://lcamtuf.coredump.cx/p0f/</a> <br> [17] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">https://github.com/cea-sec/ivre</a> <br> [18] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">https://scapy.net/</a> <br> [19] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">https://github.com/pl-</a> </div></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mikhail Larin, especialista no Centro de Monitoramento e Resposta a Incidentes de Segurança da Informação Jet CSIRT, Jet Infosystems.</font></font></i> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt426025/">https://habr.com/ru/post/pt426025/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt426015/index.html">O uso de drones civis serrados para fotografia aérea geodésica profissional da área</a></li>
<li><a href="../pt426017/index.html">Como reduzir o número de experiências em animais</a></li>
<li><a href="../pt426019/index.html">Estação meteorológica no Arduino de A a Z. Parte 5</a></li>
<li><a href="../pt426021/index.html">libgdx e sentimentos</a></li>
<li><a href="../pt426023/index.html">Lição aberta "Laboratório virtual no Vagrant"</a></li>
<li><a href="../pt426027/index.html">Análise de portfólio de investimentos e serviços em nuvem da Amazon</a></li>
<li><a href="../pt426029/index.html">Você desiste e quer sair da tarefa? É assim que o treinamento eficaz para desenvolvedores se parece</a></li>
<li><a href="../pt426031/index.html">Preocupar-se em capturar o mundo com inteligência artificial pode se basear em suposições não científicas</a></li>
<li><a href="../pt426033/index.html">Titãs matemáticos colidem com prova épica da hipótese do ABC</a></li>
<li><a href="../pt426039/index.html">Lançamento de emergência "Soyuz MS-10" (equipe resgatada, transmitida)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>