<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëäüèø üíõ üîπ Introdu√ß√£o ao ECMAScript 2017 (ES8) üê† üëº üë®üèª‚Äçüîß</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Sum√°rio 
 Pref√°cio 
 Vis√£o geral do ES7 
 1. Object.entries 
 2. Object.values 
 3. String.prototype.padEnd 
 4. String.prototype.padStart 
 5. Object...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Introdu√ß√£o ao ECMAScript 2017 (ES8)</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/475074/"><h4>  Sum√°rio </h4><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Pref√°cio</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Vis√£o geral do ES7</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">1. Object.entries</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">2. Object.values</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">3. String.prototype.padEnd</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">4. String.prototype.padStart</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">5. Object.getOwnPropertyDescriptor</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">6. V√≠rgulas √† direita</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">7. SharedArrayBuffer</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">8. Atomics</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">9. Fun√ß√µes ass√≠ncronas</a> <br><br><a name="section000"></a><h2>  Pref√°cio </h2><br>  Ol√°, no passado, eu j√° considerei inova√ß√µes no ES6 e agora √© hora de desmontar o ES8, pois trouxe muitas coisas novas.  N√£o considerei o ES7 (2016) separadamente, pois esse lan√ßamento trouxe apenas 2 inova√ß√µes.  Este √© o Array.prototype.includes () e o operador de exponencia√ß√£o.  Mas, ainda assim, antes de iniciar o ES8, vejamos as inova√ß√µes do ES7. <br><br><a name="section0000"></a><h2>  Vis√£o geral do ES7 </h2><br>  <b>O m√©todo includes ()</b> determina se a matriz cont√©m um elemento espec√≠fico, retornando verdadeiro ou falso, dependendo disso. <br><br><pre><code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>.prototype.includes(searchElement[, fromIndex = <span class="hljs-number"><span class="hljs-number">0</span></span>]) : <span class="hljs-built_in"><span class="hljs-built_in">Boolean</span></span></code> </pre> <br>  searchElement - O item a ser pesquisado. <br><br>  fromIndex - A posi√ß√£o na matriz a partir da qual come√ßar a procurar o elemento searchElement.  Para valores negativos, a pesquisa √© realizada come√ßando com o √≠ndice array.length + fromIndex ascendente.  O valor padr√£o √© 0. <a name="habracut"></a><br><br>  <b>Exemplos</b> <br><br><pre> <code class="javascript hljs">[<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>].includes(<span class="hljs-number"><span class="hljs-number">2</span></span>); <span class="hljs-comment"><span class="hljs-comment">// true [1, 2, 3].includes(4); // false [1, 2, 3].includes(3, 3); // false [1, 2, 3].includes(3, -1); // true [1, 2, NaN].includes(NaN); // true</span></span></code> </pre> <br>  includ () pode ser aplicado a outros tipos de objetos (por exemplo, objetos do tipo array).  Exemplo: usando o m√©todo includes () em um objeto de argumentos. <br><br><pre> <code class="javascript hljs">(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log([].includes.call(<span class="hljs-built_in"><span class="hljs-built_in">arguments</span></span>, <span class="hljs-string"><span class="hljs-string">'a'</span></span>)); <span class="hljs-comment"><span class="hljs-comment">// true console.log([].includes.call(arguments, 'd')); // false })('a','b','c');</span></span></code> </pre> <br>  <b>O operador de exponencia√ß√£o</b> (**) retorna uma pot√™ncia com base a e um expoente natural b.  Elevando a √† pot√™ncia de b. <br><br><pre> <code class="javascript hljs">a ** b</code> </pre> <br>  <b>Exemplos</b> <br><br><pre> <code class="javascript hljs"><span class="hljs-number"><span class="hljs-number">2</span></span> ** <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-comment"><span class="hljs-comment">// 8 3 ** 2 // 9 3 ** 2.5 // 15.588457268119896 10 ** -1 // 0.1 NaN ** 2 // NaN 2 ** 3 ** 2 // 512 2 ** (3 ** 2) // 512 (2 ** 3) ** 2 // 64 -(2 ** 2) // -4 (-2) ** 2 // 4</span></span></code> </pre> <br><a name="section001"></a><h2>  1. Object.entries </h2><br>  Object.entries () retorna uma matriz cujos elementos s√£o matrizes correspondentes √† propriedade enumerada do par [chave, valor] encontrada diretamente no objeto.  A ordem das propriedades √© a mesma de quando voc√™ percorre as propriedades de um objeto manualmente. <br><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.entries(obj) : <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span></code> </pre> <br>  obj - Um objeto cujas propriedades enumeradas ser√£o retornadas como uma matriz [chave, valor]. <br><br>  Object.entries () retorna as propriedades na mesma ordem que no loop for ... in (a diferen√ßa √© que o for-in tamb√©m lista as propriedades da cadeia de prot√≥tipos).  A ordem dos elementos na matriz que Object.entries () retorna √© independente de como o objeto √© declarado.  Se uma ordem espec√≠fica for necess√°ria, a matriz dever√° ser classificada antes que o m√©todo seja chamado. <br><br>  <b>Exemplos</b> <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> obj = { <span class="hljs-attr"><span class="hljs-attr">foo</span></span>: <span class="hljs-string"><span class="hljs-string">"bar"</span></span>, <span class="hljs-attr"><span class="hljs-attr">baz</span></span>: <span class="hljs-number"><span class="hljs-number">42</span></span> }; <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.entries(obj)); <span class="hljs-comment"><span class="hljs-comment">// [ ['foo', 'bar'], ['baz', 42] ] //    var obj = { 0: 'a', 1: 'b', 2: 'c' }; console.log(Object.entries(obj)); // [ ['0', 'a'], ['1', 'b'], ['2', 'c'] ] //    c random   var an_obj = { 100: 'a', 2: 'b', 7: 'c' }; console.log(Object.entries(an_obj)); // [ ['2', 'b'], ['7', 'c'], ['100', 'a'] ] // getFoo  ,    var my_obj = Object.create({}, { getFoo: { value: function() { return this.foo; } } }); my_obj.foo = "bar"; console.log(Object.entries(my_obj)); // [ ['foo', 'bar'] ] // non-object     object console.log(Object.entries("foo")); // [ ['0', 'f'], ['1', 'o'], ['2', 'o'] ] let obj = { one: 1, two: 2 }; for (let [k,v] of Object.entries(obj)) console.log(`${JSON.stringify(k)}: ${JSON.stringify(v)}`) // "one": 1 // "two": 2</span></span></code> </pre> <br>  <b>Converter objeto em mapa</b> <br><br>  O novo construtor Map () aceita a repeti√ß√£o de valores.  Com Object.entries, voc√™ pode converter facilmente Objeto em Mapa.  Isso √© mais conciso do que usar uma matriz de 2 matrizes de elementos, mas as chaves podem ser apenas cadeias de caracteres. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> obj = { <span class="hljs-attr"><span class="hljs-attr">foo</span></span>: <span class="hljs-string"><span class="hljs-string">"bar"</span></span>, <span class="hljs-attr"><span class="hljs-attr">baz</span></span>: <span class="hljs-number"><span class="hljs-number">42</span></span> }; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> map = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Map</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.entries(obj)); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(map); <span class="hljs-comment"><span class="hljs-comment">// Map {"foo" =&gt; "bar", "baz" =&gt; 42}</span></span></code> </pre> <br>  Por que o valor de retorno de Object.entries () √© uma matriz e n√£o um iterador? <br>  O caso de uso correspondente nesse caso √© Object.keys () e n√£o, por exemplo, Map.prototype.entries (). <br><br>  Por que Object.entries () retorna apenas propriedades nativas enumeradas com chaves de seq√º√™ncia de caracteres? <br><br>  Novamente, isso √© feito para corresponder a Object.keys ().  Este m√©todo tamb√©m ignora propriedades cujas chaves s√£o caracteres.  No final, pode haver um m√©todo Reflect.ownEntries () que retorna todas as suas pr√≥prias propriedades. <br><br>  Consulte object.entries na <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">especifica√ß√£o</a> oficial, bem como no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">MDN Web Docs</a> . <br><br><a name="section002"></a><h2>  2. Object.values </h2><br>  Object.values ‚Äã‚Äã() retorna uma matriz cujos elementos s√£o os valores das propriedades enumeradas encontradas no objeto.  A ordem √© a mesma que se voc√™ percorresse o objeto manualmente. <br><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.values(obj) : <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span></code> </pre> <br>  obj - Um objeto cujos valores das propriedades enumeradas ser√£o retornados. <br><br>  O m√©todo Object.values ‚Äã‚Äã() retorna uma matriz de valores das propriedades enumeradas do objeto na mesma ordem que o loop for ... in.  A diferen√ßa entre um loop e um m√©todo √© que o loop lista as propriedades da e da cadeia de prot√≥tipos. <br><br>  <b>Exemplos</b> <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> obj = { <span class="hljs-attr"><span class="hljs-attr">foo</span></span>: <span class="hljs-string"><span class="hljs-string">"bar"</span></span>, <span class="hljs-attr"><span class="hljs-attr">baz</span></span>: <span class="hljs-number"><span class="hljs-number">42</span></span> }; <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.values(obj)); <span class="hljs-comment"><span class="hljs-comment">// ['bar', 42] //    var obj = { 0: 'a', 1: 'b', 2: 'c' }; console.log(Object.values(obj)); // ['a', 'b', 'c']</span></span></code> </pre><br>  A diferen√ßa entre Object.entries e Object.values ‚Äã‚Äã() √© que a primeira retorna uma matriz de matrizes contendo o nome e o valor da propriedade, enquanto a segunda retorna apenas uma matriz com o valor das propriedades. <br><br>  <b>Diferen√ßa de exemplo entre Object.values ‚Äã‚Äã() e Object.entries ()</b> <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> object = { <span class="hljs-attr"><span class="hljs-attr">a</span></span>: <span class="hljs-string"><span class="hljs-string">'somestring'</span></span>, <span class="hljs-attr"><span class="hljs-attr">b</span></span>: <span class="hljs-number"><span class="hljs-number">42</span></span>, <span class="hljs-attr"><span class="hljs-attr">c</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span> }; <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.values(object)); <span class="hljs-comment"><span class="hljs-comment">// ["somestring", 42, false] console.log(Object.entries(object)); // [ ["a", "somestring"], ["b", 42], ["c", false] ]</span></span></code> </pre> <br>  Consulte Object.values ‚Äã‚Äã() na <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">especifica√ß√£o</a> oficial, bem como no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">MDN Web Docs</a> . <br><br><a name="section003"></a><h2>  3. String.prototype.padEnd </h2><br>  O m√©todo padEnd () completa a linha atual com a sequ√™ncia especificada (eventualmente repetindo) para que a sequ√™ncia resultante atinja o comprimento especificado.  A adi√ß√£o √© aplicada no final (√† direita) da linha atual. <br><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">String</span></span>.prototype.padEnd(maxLength [ , fillString ]) : <span class="hljs-built_in"><span class="hljs-built_in">String</span></span></code> </pre> <br>  maxLength - O comprimento da linha resultante ap√≥s a linha atual ter sido preenchida.  Se esse par√¢metro for menor que o comprimento da linha atual, a linha atual ser√° retornada como est√°. <br>  fillString - Uma string para complementar a linha atual.  Se essa linha for muito longa, ser√° truncada e a sua esquerda mais ser√° aplicada.  "" (0x0020 ESPA√áO) √© o valor padr√£o para este par√¢metro. <br><br>  <b>Exemplos</b> <br><br><pre> <code class="javascript hljs"><span class="hljs-string"><span class="hljs-string">'abc'</span></span>.padEnd(<span class="hljs-number"><span class="hljs-number">10</span></span>); <span class="hljs-comment"><span class="hljs-comment">// "abc " 'abc'.padEnd(10, "foo"); // "abcfoofoof" 'abc'.padEnd(6,"123456"); // "abc123"</span></span></code> </pre> <br>  Os casos de uso para preencher cadeias de caracteres incluem: <br><br><ul><li>  Adicionando um contador ou identificador a um nome ou URL de arquivo: 'file 001.txt' </li><li>  Alinhamento de sa√≠da do console: "Teste 001: ‚úì" </li><li>  Imprima n√∫meros hexadecimais ou bin√°rios com um n√∫mero fixo de d√≠gitos: '0x00FF' </li></ul><br>  Consulte String.prototype.padEnd na <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">especifica√ß√£o</a> oficial, bem como no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">MDN Web Docs</a> . <br><br><a name="section004"></a><h2>  4. String.prototype.padStart </h2><br>  O m√©todo padStart () preenche a linha atual com outra linha (v√°rias vezes, se necess√°rio), para que a linha resultante atinja o comprimento especificado.  O preenchimento √© realizado no in√≠cio (esquerda) da linha atual. <br><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">String</span></span>.prototype.padStart(maxLength [, fillString]) : <span class="hljs-built_in"><span class="hljs-built_in">String</span></span></code> </pre> <br>  maxLength - o comprimento da linha de resumo ap√≥s a conclus√£o da linha atual.  Se o valor for menor que o comprimento da linha atual, a linha atual ser√° retornada inalterada. <br><br>  fillString - Uma string para preencher a linha atual.  Se essa sequ√™ncia for muito longa para o comprimento especificado, ela ser√° truncada.  O valor padr√£o √© "" (0x0020 ESPA√áO). <br><br>  <b>Exemplos</b> <br><br><pre> <code class="javascript hljs"><span class="hljs-string"><span class="hljs-string">'abc'</span></span>.padStart(<span class="hljs-number"><span class="hljs-number">10</span></span>); <span class="hljs-comment"><span class="hljs-comment">// " abc" 'abc'.padStart(10, "foo"); // "foofoofabc" 'abc'.padStart(6,"123465"); // "123abc" 'abc'.padStart(8, "0"); // "00000abc" 'abc'.padStart(1); // "abc"</span></span></code> </pre> <br>  Por que os m√©todos de preenchimento n√£o s√£o chamados padLeft e padRight? <br><br>  Para idiomas bidirecionais ou da direita para a esquerda, os termos "esquerda" e "direita" n√£o funcionam.  Portanto, a nomea√ß√£o de padStart e padEnd segue os nomes existentes, come√ßando com beginWith e endsWith. <br><br>  Consulte String.prototype.padStart na <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">especifica√ß√£o</a> oficial, bem como no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">MDN Web Docs</a> . <br><br><a name="section005"></a><h2>  5. Object.getOwnPropertyDescriptor </h2><br>  O m√©todo Object.getOwnPropertyDescriptor () retorna um descritor de propriedade para sua pr√≥pria propriedade (ou seja, uma localizada diretamente no objeto e n√£o recebida pela cadeia de prot√≥tipos) do objeto passado.  Se a propriedade n√£o existir, retornar√° indefinido. <br><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.getOwnPropertyDescriptor(obj, prop) : <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span></code> </pre> <br>  obj - O objeto no qual a propriedade √© pesquisada. <br><br>  prop - O nome da propriedade cuja descri√ß√£o ser√° retornada. <br><br>  Este m√©todo permite visualizar a descri√ß√£o exata da propriedade.  Uma propriedade em JavaScript consiste em um nome de sequ√™ncia e um descritor de propriedades. <br><br>  Um descritor de propriedades √© um registro com alguns dos seguintes atributos: <br><br><ul><li>  valor - o valor associado √† propriedade (apenas no descritor de dados). </li><li>  grav√°vel - verdadeiro se o valor associado √† propriedade puder ser alterado, caso contr√°rio, falso (apenas no descritor de dados). </li><li>  get - Uma fun√ß√£o que retorna o valor da propriedade ou indefinida se n√£o houver essa fun√ß√£o (apenas no descritor de acesso). </li><li>  set - Uma fun√ß√£o que altera o valor de uma propriedade ou √© indefinida se n√£o houver essa fun√ß√£o (apenas no descritor de acesso). </li><li>  configurable - true se o tipo de identificador desta propriedade puder ser alterado e se a propriedade puder ser removida do objeto que a cont√©m, caso contr√°rio, false. </li><li>  enumerable - true se esta propriedade estiver dispon√≠vel ao listar as propriedades do objeto que a cont√©m, caso contr√°rio, false. </li></ul><br>  <b>Exemplos</b> <br><br><pre> <code class="javascript hljs">obj = { get foo() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span>; } }; <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.getOwnPropertyDescriptor(obj, <span class="hljs-string"><span class="hljs-string">'foo'</span></span>)); <span class="hljs-comment"><span class="hljs-comment">// {set: undefined, enumerable: true, configurable: true, get: ∆í} obj2 = { bar: 42 }; console.log(Object.getOwnPropertyDescriptor(obj2, 'bar')); // {value: 42, writable: true, enumerable: true, configurable: true}</span></span></code> </pre> <br><h4>  Casos de uso para Object.getOwnPropertyDescriptor () </h4><br>  <b>Primeiro</b> caso de uso: copiar propriedades para um objeto <br>  A partir do ES6, o JavaScript j√° possui um m√©todo de ferramenta para copiar propriedades: Object.assign ().  No entanto, esse m√©todo usa opera√ß√µes simples de obter e definir para copiar uma propriedade cuja chave √© a chave: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> value = source[key]; <span class="hljs-comment"><span class="hljs-comment">// get target[key] = value; // set</span></span></code> </pre>  Isso significa que ele n√£o copia corretamente propriedades com atributos diferentes dos especificados por padr√£o (m√©todos para obter, configurar, gravar etc.).  O exemplo a seguir ilustra essa limita√ß√£o.  A fonte do objeto possui um instalador cuja chave √© foo: <pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> source = { set foo(value) { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(value); } }; <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.getOwnPropertyDescriptor(source, <span class="hljs-string"><span class="hljs-string">'foo'</span></span>)); <span class="hljs-comment"><span class="hljs-comment">// { get: undefined, set: [Function: foo], enumerable: true, configurable: true }</span></span></code> </pre> <br>  O uso de Object.assign () para copiar a propriedade foo no objeto de destino falha: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> target1 = {}; <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.assign(target1, source); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.getOwnPropertyDescriptor(target1, <span class="hljs-string"><span class="hljs-string">'foo'</span></span>)); <span class="hljs-comment"><span class="hljs-comment">// { value: undefined, writable: true, enumerable: true, configurable: true }</span></span></code> </pre>  Felizmente, o uso de Object.getOwnPropertyDescriptors () junto com Object.defineProperties () funciona: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> target2 = {}; <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.defineProperties(target2, <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.getOwnPropertyDescriptors(source)); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.getOwnPropertyDescriptor(target2, <span class="hljs-string"><span class="hljs-string">'foo'</span></span>)); <span class="hljs-comment"><span class="hljs-comment">// { get: undefined, set: [Function: foo], enumerable: true, configurable: true }</span></span></code> </pre> <br>  <b>Segundo</b> caso de uso: clonando objetos <br>  A clonagem superficial √© semelhante √†s propriedades de c√≥pia; portanto, Object.getOwnPropertyDescriptors () tamb√©m √© uma boa op√ß√£o aqui. <br><br>  Desta vez, usamos Object.create (), que possui dois par√¢metros: <br>  O primeiro par√¢metro especifica o prot√≥tipo do objeto retornado. <br><br>  Um segundo par√¢metro opcional √© uma cole√ß√£o de descritores de propriedades, semelhantes aos retornados por Object.getOwnPropertyDescriptors (). <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> clone = <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.create(<span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.getPrototypeOf(obj), <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.getOwnPropertyDescriptors(obj));</code> </pre> <br>  <b>Terceiro</b> caso de uso: literais de objetos de plataforma cruzada com prot√≥tipos arbitr√°rios. <br><br>  A melhor maneira sintaticamente de usar um literal de objeto para criar um objeto com um prot√≥tipo arbitr√°rio √© usar a propriedade __proto__ especial: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> obj = { <span class="hljs-attr"><span class="hljs-attr">__proto__</span></span>: prot, <span class="hljs-attr"><span class="hljs-attr">foo</span></span>: <span class="hljs-number"><span class="hljs-number">123</span></span>, };</code> </pre> <br>  Infelizmente, esse recurso √© garantido para estar presente apenas nos navegadores.  A solu√ß√£o geral √© Object.create () e atribui√ß√£o: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> obj = <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.create(prot); obj.foo = <span class="hljs-number"><span class="hljs-number">123</span></span>;</code> </pre> <br>  Mas voc√™ tamb√©m pode usar Object.getOwnPropertyDescriptors (): <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> obj = <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.create( prot, <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.getOwnPropertyDescriptors({ <span class="hljs-attr"><span class="hljs-attr">foo</span></span>: <span class="hljs-number"><span class="hljs-number">123</span></span>, }) );</code> </pre> <br>  Outra alternativa √© Object.assign (): <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> obj = <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.assign( <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.create(prot), { <span class="hljs-attr"><span class="hljs-attr">foo</span></span>: <span class="hljs-number"><span class="hljs-number">123</span></span>, } );</code> </pre> <br>  Armadilha: copiando m√©todos usando super. <br><br>  O m√©todo que super usa est√° fortemente ligado ao seu objeto inicial (o objeto em que est√° armazenado).  Atualmente, n√£o h√° como copiar ou mover esse m√©todo para outro objeto. <br><br>  Consulte Object.getOwnPropertyDescriptor na <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">especifica√ß√£o</a> oficial, bem como no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">MDN Web Docs</a> . <br><br><a name="section006"></a><h2>  6. V√≠rgulas √† direita </h2><br>  V√≠rgulas suspensas (v√≠rgulas √† direita) - podem ser √∫teis ao adicionar novos elementos, par√¢metros ou propriedades ao c√≥digo JavaScript.  Se voc√™ deseja adicionar uma nova propriedade, basta adicionar uma nova linha sem alterar a anterior, se a v√≠rgula suspensa j√° estiver sendo usada nela.  Isso torna as diferen√ßas no controle de vers√£o mais limpas e as altera√ß√µes de c√≥digo podem ser menos problem√°ticas. <br><br><h4>  Pendurar v√≠rgulas em literais </h4><br>  <b>Matrizes</b> <br><br>  JavaScript ignora v√≠rgulas pendentes em matrizes: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> arr = [ <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, ]; <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(arr); <span class="hljs-comment"><span class="hljs-comment">// [0, 1, 2] console.log(arr.length); // 3 var arr2 = [0, 1, 2,,,]; console.log(arr2.length); // 5 arr2.forEach((e) =&gt; console.log(e)); // 0 1 2 console.log(arr.map((e) =&gt; e)); // 0 1 2</span></span></code> </pre> <br>  Se mais de um ponto de oscila√ß√£o for usado, ser√£o criados furos.  Uma matriz com "orif√≠cios" √© chamada esparsa (uma matriz densa n√£o possui "orif√≠cios").  Ao iterar uma matriz usando, por exemplo, Array.prototype.forEach () ou Array.prototype.map (), os buracos ser√£o ignorados. <br><br>  <b>Os objetos</b> <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> object = { <span class="hljs-attr"><span class="hljs-attr">foo</span></span>: <span class="hljs-string"><span class="hljs-string">"bar"</span></span>, <span class="hljs-attr"><span class="hljs-attr">baz</span></span>: <span class="hljs-string"><span class="hljs-string">"qwerty"</span></span>, <span class="hljs-attr"><span class="hljs-attr">age</span></span>: <span class="hljs-number"><span class="hljs-number">42</span></span>, }; <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(object); <span class="hljs-comment"><span class="hljs-comment">// {foo: "bar", baz: "qwerty", age: 42}</span></span></code> </pre> <br><h4>  Suspens√£o de v√≠rgulas em fun√ß√µes </h4><br>  <b>Defini√ß√£o de Par√¢metros</b> <br><br>  As seguintes defini√ß√µes de par√¢metros de fun√ß√£o s√£o v√°lidas e equivalentes entre si.  V√≠rgulas pendentes n√£o afetam a propriedade length de uma fun√ß√£o ou seu objeto de argumentos. <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">f</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">p</span></span></span><span class="hljs-function">) </span></span>{} <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">f</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">p,</span></span></span><span class="hljs-function">) </span></span>{} (p) =&gt; {}; <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">p,</span></span></span><span class="hljs-function">) =&gt;</span></span> {};</code> </pre> <br>  <b>Defini√ß√£o de m√©todo</b> <br><br>  A v√≠rgula suspensa tamb√©m funciona com a defini√ß√£o de m√©todos para classes ou objetos. <br><br><pre> <code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">C</span></span></span><span class="hljs-class"> </span></span>{ one(a,) {}, two(a, b,) {}, } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> obj = { one(a,) {}, two(a, b,) {}, };</code> </pre> <br>  <b>Chamada de fun√ß√£o</b> <br><br>  As seguintes chamadas de fun√ß√£o s√£o v√°lidas e equivalentes entre si. <br><br><pre> <code class="javascript hljs">f(p); f(p,); <span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.max(<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.max(<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>,);</code> </pre> <br>  <b>V√≠rgulas suspensas inv√°lidas</b> <br><br>  Definir par√¢metros de fun√ß√£o ou chamar uma fun√ß√£o contendo apenas uma v√≠rgula gerar√° um SyntaxError.  Al√©m disso, ao usar os par√¢metros restantes, v√≠rgulas suspensas n√£o s√£o permitidas. <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">f</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">,</span></span></span><span class="hljs-function">) </span></span>{} <span class="hljs-comment"><span class="hljs-comment">// SyntaxError: missing formal parameter (,) =&gt; {}; // SyntaxError: expected expression, got ',' f(,) // SyntaxError: expected expression, got ',' function f(...p,) {} // SyntaxError: parameter after rest parameter (...p,) =&gt; {} // SyntaxError: expected closing parenthesis, got ','</span></span></code> </pre> <br><h4>  V√≠rgulas suspensas na reestrutura√ß√£o </h4><br>  V√≠rgulas suspensas tamb√©m podem ser usadas √† esquerda ao usar tarefas destrutivas. <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//      [a, b,] = [1, 2]; //      var o = { p: 42, q: true, }; var {p, q,} = o;</span></span></code> </pre> <br>  Mais uma vez, usando os par√¢metros restantes, um SyntaxError ser√° lan√ßado. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> [a, ...b,] = [<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>]; <span class="hljs-comment"><span class="hljs-comment">// Uncaught SyntaxError: Rest element must be last element</span></span></code> </pre> <br><h4>  JSON Dangling V√≠rgulas </h4><br>  V√≠rgulas <b>suspensas</b> em um objeto s√£o permitidas apenas no ECMAScript 5. Como o JSON √© baseado na sintaxe JavaScript anterior ao ES5, <b>v√≠rgulas suspensas</b> n√£o s√£o permitidas <b>no JSON.</b> <br><br>  Ambas as linhas lan√ßam um SyntaxError <br><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">JSON</span></span>.parse(<span class="hljs-string"><span class="hljs-string">'[1, 2, 3, 4, ]'</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">JSON</span></span>.parse(<span class="hljs-string"><span class="hljs-string">'{"foo" : 1, }'</span></span>); <span class="hljs-comment"><span class="hljs-comment">// Uncaught SyntaxError: Unexpected token ] in JSON // Uncaught SyntaxError: Unexpected token } in JSON</span></span></code> </pre> <br><h4>  Por que as v√≠rgulas suspensas s√£o √∫teis? </h4><br>  Existem dois benef√≠cios. <br><br>  Em primeiro lugar, reorganizar elementos √© mais f√°cil porque voc√™ n√£o precisa adicionar ou remover v√≠rgulas se o √∫ltimo elemento mudar de posi√ß√£o. <br><br>  Em segundo lugar, ajuda os sistemas de controle de vers√£o a acompanhar o que realmente mudou.  Por exemplo, de: <br><br><pre> <code class="plaintext hljs">[ 'Foo' ] : [ 'Foo', '' ]</code> </pre> <br>  faz com que a linha com 'foo' e a linha com 'bar' sejam marcadas como alteradas, embora a √∫nica altera√ß√£o real seja adicionar a √∫ltima linha. <br><br>  Consulte Trails v√≠rgulas no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">MDN Web Docs</a> . <br><br><a name="section007"></a><h2>  7. SharedArrayBuffer </h2><br>  O objeto SharedArrayBuffer √© usado para criar um buffer dividido de tamanho fixo para armazenar dados bin√°rios primitivos, semelhante ao objeto ArrayBuffer, mas, por outro lado, as inst√¢ncias SharedArrayBuffer podem ser usadas para criar uma exibi√ß√£o na mem√≥ria compartilhada.  SharedArrayBuffer n√£o pode ser desconectado. <pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SharedArrayBuffer(length) : <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span></code> </pre>  length - o tamanho, em bytes, para criar a matriz do buffer. <br><br>  return - Um novo objeto SharedArrayBuffer do comprimento especificado.  Seu conte√∫do ap√≥s a inicializa√ß√£o √© 0. <br><br>  O PostMessage e a clonagem estruturada s√£o usados ‚Äã‚Äãpara dividir a mem√≥ria usando um objeto SharedArrayBuffer entre um agente no cluster e outro (o agente pode ser o programa principal da p√°gina da Web ou um dos trabalhadores da Web). <br><br>  O algoritmo de clonagem estruturada aceita SharedArrayBuffers e TypedArrays mapeados para SharedArrayBuffers.  Nos dois casos, o objeto SharedArrayBuffer √© passado ao destinat√°rio, o que cria um novo objeto PrivateArrayBuffer privado dentro do agente de recebimento (o mesmo que para ArrayBuffer).  No entanto, o bloco de dados compartilhados referenciado por ambos os objetos SharedArrayBuffer √© o mesmo bloco de dados, e os efeitos de terceiros no bloco em um dos agentes acabam se tornando vis√≠veis no outro agente. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> sab = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SharedArrayBuffer(<span class="hljs-number"><span class="hljs-number">1024</span></span>); worker.postMessage(sab);</code> </pre> <br>  A mem√≥ria compartilhada pode ser criada e alterada simultaneamente nos trabalhadores ou no encadeamento principal.  Dependendo do sistema (CPU, SO, navegador), pode levar algum tempo at√© que as altera√ß√µes sejam propagadas para todos os contextos.  Para sincroniza√ß√£o, s√£o necess√°rias opera√ß√µes at√¥micas. <br><br>  Buffers de matriz compartilhada √© um bloco de constru√ß√£o primitivo para abstra√ß√µes de paralelismo de n√≠vel superior.  Eles permitem que voc√™ compartilhe os bytes de um objeto SharedArrayBuffer entre v√°rios trabalhadores e o encadeamento principal (o buffer √© compartilhado para acessar bytes, envolva-o em uma Matriz digitada).  Esse tipo de troca tem duas vantagens: <br>  Voc√™ pode trocar dados entre trabalhadores mais rapidamente. <br><br>  A coordena√ß√£o entre trabalhadores se torna mais f√°cil e r√°pida (em compara√ß√£o com postMessage ()). <br><br>  A implementa√ß√£o do trabalhador √© a seguinte. <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// worker.js self.addEventListener ('message', function (event) { const {sharedBuffer} = event.data; const sharedArray = new Int32Array (sharedBuffer); // ¬∑¬∑¬∑ });</span></span></code> </pre><br>  Primeiro, extra√≠mos o buffer da matriz compartilhada que nos foi enviada e, em seguida, agrupamos em uma matriz digitada para que possamos us√°-la localmente. <br><br>  <b>Propriedades e m√©todos de SharedArrayBuffer.</b> <br><br>  SharedArrayBuffer.length - O comprimento do construtor SharedArrayBuffer cujo valor √© 1. <br>  SharedArrayBuffer.prototype - Permite propriedades adicionais para todos os objetos SharedArrayBuffer. <br><br>  <b>Inst√¢ncias SharedArrayBuffer</b> <br>  <b>As propriedades</b> <br><br>  SharedArrayBuffer.prototype.constructor - Define uma fun√ß√£o que cria um prot√≥tipo de um objeto.  O valor inicial √© o construtor padr√£o SharedArrayBuffer interno. <br><br>  SharedArrayBuffer.prototype.byteLength (somente leitura) - o tamanho da matriz em bytes.  Isso √© definido quando a matriz √© criada e n√£o pode ser alterada. <br><br>  <b>M√©todos</b> <br><br>  SharedArrayBuffer.prototype.slice () - Retorna um novo SharedArrayBuffer cujo conte√∫do √© uma c√≥pia dos bytes desse SharedArrayBuffer desde o in√≠cio, inclusive at√© o final, do exclusivo.  Se o in√≠cio ou o final forem negativos, isso se refere ao √≠ndice do final da matriz, n√£o do in√≠cio.  Este m√©todo tem o mesmo algoritmo que Array.prototype.slice (). <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//  SharedArrayBuffer     const buffer = new SharedArrayBuffer(16); const int32View = new Int32Array(buffer); //  view // produces Int32Array [0, 0, 0, 0] int32View[1] = 42; const sliced = new Int32Array(buffer.slice(4,12)); console.log(sliced); // Int32Array [42, 0]</span></span></code> </pre> <br><pre> <code class="javascript hljs">sab.slice([begin, end]) : <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span></code> </pre> <br>  begin - O √≠ndice zero no qual a extra√ß√£o come√ßa.  Voc√™ pode usar um √≠ndice negativo indicando o deslocamento do final da sequ√™ncia.  slice (-2) extrai os dois √∫ltimos elementos em uma sequ√™ncia.  Se o in√≠cio n√£o estiver definido, a fatia come√ßar√° no √≠ndice 0. <br>  Fim - O √≠ndice baseado em zero no qual a extra√ß√£o deve ser conclu√≠da. <br><br>  Por exemplo, a fatia (1,4) recupera o segundo elemento atrav√©s do quarto elemento (elementos com √≠ndices 1, 2 e 3).  Voc√™ pode usar um √≠ndice negativo indicando o deslocamento do final da sequ√™ncia.  slice (2, -1) recupera o terceiro elemento atrav√©s do pen√∫ltimo elemento na sequ√™ncia.  Se o fim for omitido, a fatia buscar√° no final da sequ√™ncia (sab.byteLength). <br><br>  <b>Exemplos</b> <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> sab = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SharedArrayBuffer(<span class="hljs-number"><span class="hljs-number">1024</span></span>); sab.slice(); <span class="hljs-comment"><span class="hljs-comment">// SharedArrayBuffer { byteLength: 1024 } sab.slice(2); // SharedArrayBuffer { byteLength: 1022 } sab.slice(-2); // SharedArrayBuffer { byteLength: 2 } sab.slice(0, 1); // SharedArrayBuffer { byteLength: 1 }</span></span></code> </pre> <br>  Consulte SharedArrayBuffer na <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">especifica√ß√£o</a> oficial, bem como no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">MDN Web Docs</a> . <br><br><a name="section008"></a><h2>  8. Atomics </h2><br>  O objeto Atomics fornece opera√ß√µes at√¥micas como m√©todos est√°ticos.  Usado com um objeto SharedArrayBuffer. <br><br>  As opera√ß√µes at√¥micas s√£o instaladas no m√≥dulo Atomics.  Ao contr√°rio de outros objetos globais, o Atomics n√£o √© um construtor.  Ele n√£o pode ser usado com o novo operador ou para chamar um objeto Atomics como uma fun√ß√£o.  Todas as propriedades e m√©todos Atomics s√£o est√°ticos (como um objeto Math, por exemplo). <br><br>  Quando a mem√≥ria √© compartilhada, v√°rios threads podem ler e gravar os mesmos dados na mem√≥ria.  As opera√ß√µes at√¥micas garantem que os valores esperados sejam gravados e lidos, e as opera√ß√µes conclu√≠das antes da pr√≥xima opera√ß√£o come√ßar seu trabalho, e elas n√£o ser√£o interrompidas. <br><br><h4>  As propriedades </h4><br>  Atomics [Symbol.toStringTag] - O valor dessa propriedade √© Atomics. <br><br><h4>  M√©todos </h4><br>  <b>Opera√ß√µes at√¥micas</b> <br><br><ul><li>  Atomics.add () - adiciona o valor apresentado ao atual na posi√ß√£o especificada na matriz.  Retorna o valor anterior nesta posi√ß√£o. </li><li>  Atomics.and () - Calcula um AND bit a bit na posi√ß√£o especificada da matriz.  Retorna o valor anterior nesta posi√ß√£o. </li><li>  Atomics.compareExchange () - Salva o valor apresentado na posi√ß√£o especificada da matriz, se for equivalente ao valor apresentado.  Retorna o valor anterior. </li><li> Atomics.exchange() ‚Äî       .   . </li><li> Atomics.load() ‚Äî      . </li><li> Atomics.or() ‚Äî   OR    .      . </li><li> Atomics.store() ‚Äî       .  . </li><li> Atomics.sub() ‚Äî          .      . </li><li> Atomics.xor() ‚Äî   XOR    .      . </li></ul><br>   Atomics.add()                .    ,      ,       . <br><br><pre> <code class="javascript hljs">Atomics.add(typedArray, index, value) : mixed</code> </pre> <br><ul><li> typedArray ‚Äî    . Int8Array, Uint8Array, Int16Array, Uint16Array, Int32Array  Uint32Array. </li><li> index ‚Äî   typedArray   value. </li><li> value ‚Äî   . </li><li> return ‚Äî      (typedArray[index]). </li></ul><br><ul><li>  TypeError,   typedArray       . </li><li>  TypeError,   typedArray   . </li><li>  RangeError,  index  typedArray. </li></ul><br> <b></b> <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> sab = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SharedArrayBuffer(<span class="hljs-number"><span class="hljs-number">1024</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ta = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Uint8Array</span></span>(sab); Atomics.add(ta, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>); <span class="hljs-comment"><span class="hljs-comment">//  0,   Atomics.load(ta, 0); // 12</span></span></code> </pre> <br> Atomics.add()  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"></a> ,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">MDN Web Docs</a> . <br><br><h4> Wait  notify </h4><br> wait()  wake()     futexes (¬´fast user-space mutex¬ª ‚Äî  mutex  ) Linux      ,      true,      . <br><br> Atomics.wait() <br> ,               -.  ¬´ok¬ª, ¬´not-equal¬ª  ¬´timed-out¬ª.       ,     (    wait()    ). <br><br><ul><li> Atomics.wait() ‚Äî ,               -.  ¬´ok¬ª, ¬´not-equal¬ª  ¬´timed-out¬ª.       ,     (    wait()    ). </li><li> Atomics.wake() ‚Äî   ,         .   ,   . </li><li> Atomics.isLockFree(size) ‚Äî  ,            .  true,                 (  ).   . </li></ul><br><h4>   </h4><br>      workers.       ,    . <br><br> ,  ,  : <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (sharedArray [<span class="hljs-number"><span class="hljs-number">0</span></span>] === <span class="hljs-number"><span class="hljs-number">123</span></span>);</code> </pre> <br>     sharedArray [0]        ( sharedArray ‚Äî     ,  -    ).      : <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> tmp = sharedArray [<span class="hljs-number"><span class="hljs-number">0</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (tmp === <span class="hljs-number"><span class="hljs-number">123</span></span>);</code> </pre> <br>               ,    . <br><br>   ‚Äî  : <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// main.js sharedArray [1] = 11; sharedArray [2] = 22;</span></span></code> </pre> <br>         ,       .     ,   ,       : <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// worker.js while (sharedArray [2]! == 22); console.log (sharedArray [1]); // 0  11</span></span></code> </pre> <br>          workers,       . <br><br><h4>    </h4><br>    Atomics,       . <br><br>   : <b>.</b> <br><br>  Atomics        workers. ,              : <br><br><pre> <code class="javascript hljs">Atomics.load (TypedArray &lt;T&gt;, index) : T Atomics.store (TypedArray &lt;T&gt;, index, <span class="hljs-attr"><span class="hljs-attr">value</span></span>: T) : T</code> </pre> <br>    ,          ,      Atomics (,   ) ,       .       ,   ,     Atomics. <br><br>    ,   ,  Atomics (   sharedArray): <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// main.js console.log ('notified...'); Atomics.store (sharedArray, 0, 123); // worker.js while (Atomics.load (sharedArray, 0)! == 123); console.log ('notified');</span></span></code> </pre> <br>   : <b> </b> . <br><br>   while      ,   Atomics  ,  : Atomics.wait (Int32Array, index, value, timeout)  Atomics.wake (Int32Array, index, count). <br><br>   : <b>atomic operations</b> <br>   Atomics         ,    .  Por exemplo: <br><br><pre> <code class="javascript hljs">Atomics.add (TypedArray &lt;T&gt;, index, value) : T</code> </pre> <br>  ,   : index += value; <br><br>  c  . <br><br>        ‚Äî   ():        ‚Äî          ,   . <br><br>   ¬´Tear-Free Reads¬ª   ,   ,    : <br><br><ul><li>  ,      Typed Arrays ( DataViews). </li><li>         : sharedArray.byteOffset% sharedArray.BYTES_PER_ELEMENT === 0 </li><li>         . </li></ul><br>  ,    ,           : <br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Um ou mais DateViews; </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> H√° uma ou mais matrizes digitadas n√£o alinhadas; </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Matrizes digitadas com diferentes tamanhos de elementos; </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Para evitar uma lacuna nos valores nesses casos, use Atomics ou sync. </font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Buffers de matriz compartilhada nos usos </font></font></h4><br> Shared Array Buffers   JavaScript    ¬´ ¬ª. JavaScript      ¬´ ¬ª:      ,          .        ,      ,    ,   . <br><br> Shared Array Buffers     (RTC): ,    ,         .    ,     RTC:     Shared Array Buffers,  . <br><br>     ,     RTC.          await. <br><br> Shared Array Buffers  emscripten  pthreads  asm.js.    emscripten: <br><br> [En] [Shared Array Buffers allow] Emscripten applications to share the main memory heap between web workers. This along with primitives for low level atomics and futex support enables Emscripten to implement support for the Pthreads (POSIX threads) API. <br><br> [Ru] [Shared Array Buffers ]  Emscripten      -.           futex  Emscripten   API Pthreads ( POSIX). <br><br>        C  C ++  asm.js. <br><br>    ,       WebAssembly. ,  web workers  , ,  WebAssembly   .    ,        WebAssembly. <br><br><h4>  ,     </h4><br>          (  32 ).  ,        ‚Äî      . ,   ,   : <br><br><ul><li> TextEncoder  TextDecoder:      Uint8Array,   . </li><li> stringview.js: ,      .   . </li><li> FlatJS:  JavaScript        (,   )    (ArrayBuffer  SharedArrayBuffer). JavaScript + FlatJS    JavaScript. JavaScript  (TypeScript  . .) . </li><li> TurboScript:  JavaScript-    .    asm.js  WebAssembly. </li></ul><br>   , ,   ‚Äî    ‚Äî    .     ,     . <br><br> <b>   ,   Shared Array?</b> <br><br>  .       (     " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">A Taste of JavaScript's New Parallel Primitives</a> ‚Äù¬ª,     ,    web workers.  4 web workers , ,  ,    ,  6,9    (1 web worker)  25,4    (4 web workers).  web workers    ,   . <br><br>  ,   ,         . <br><br> <b> </b>  Shared Array Buffers   : <br><br><ul><li> <a href="" rel="nofollow">Shared memory ‚Äì a brief tutorial</a> by Lars T. Hansen </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">A Taste of JavaScript's New Parallel Primitives</a> by Lars T. Hansen </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">SharedArrayBuffer and Atomics Stage 2.95 to Stage 3</a> (PDF), slides by Shu-yu Guo and Lars T. Hansen (2016-11-30) [c,   ES] </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">The Basics of Web Workers</a> by Eric Bidelman [  web workers]. </li></ul><br>   JavaScript,   : <br><br><ul><li> ‚Äú <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">The Path to Parallel JavaScript</a> ‚Äù by Dave Herman [  ,  JavaScript     PJS] </li><li> ‚Äú <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">Write massively-parallel GPU code for the browser with WebGL</a> ‚Äù by Steve Sanderson [ , ,   WebGL      GPU]. </li><li> ‚Äú <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">Concurrency is not parallelism</a> ‚Äù by Rob Pike [Rob Pike   ¬´concurrency¬ª  ¬´parallelism¬ª    ]. </li><li> " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">Using Web Workers</a> " from MDN [  MDN,      web workers]. </li><li> " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">Shared memory and atomics</a> " by Axel Rauschmayer [     js   Shared Array Buffers  Atomics] </li></ul><br>  Atomics Object   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"></a> ,    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">MDN Web Docs</a> . <br><br><a name="section009"></a><h2> 9. Async functions </h2><br><h4>  Async function   AsyncFunction constructor </h4><br>  AsyncFunction    async function.  JavaScript       AsyncFunction. <br><br>  ,  AsyncFunction    .   ,   . <br><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.getPrototypeOf(<span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{}).constructor</code> </pre> <br> <b></b> <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">new</span></span> AsyncFunction([arg1[, arg2[, ...argN]],] functionBody)</code> </pre> <br> arg1, arg2,‚Ä¶ argN ‚Äî ,      .     ,     JavaScript    ,  ; , ¬´x¬ª, ¬´theValue¬ª,  ¬´a,b¬ª. <br><br> functionBody ‚Äî ,         JavaScript. <br><br>  async function,    AsyncFunction constructor    ,   .   ,       async function expression      ,        . <br><br>  ,  ,           ,    . <br><br>  AsyncFunction constructor   (   new)    ,      . <br><br>  async functions    AsyncFunction constructor,       ;       .                ,        ,     AsyncFunction constructor.     eval    async function. <br><br>   async function   AsyncFunction constructor <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">resolveAfter2Seconds</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">x</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">resolve</span></span></span><span class="hljs-function"> =&gt;</span></span> { setTimeout(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> { resolve(x); }, <span class="hljs-number"><span class="hljs-number">2000</span></span>); }); } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> AsyncFunction = <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.getPrototypeOf(<span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{}).constructor <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> a = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> AsyncFunction(<span class="hljs-string"><span class="hljs-string">'a'</span></span>, <span class="hljs-string"><span class="hljs-string">'b'</span></span>, <span class="hljs-string"><span class="hljs-string">'return await resolveAfter2Seconds(a) + await resolveAfter2Seconds(b);'</span></span>); a(<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>).then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">v</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(v); <span class="hljs-comment"><span class="hljs-comment">//  30  4  });</span></span></code> </pre> <br><h4>  async function </h4><br>  async function   ,    AsyncFunction.     async-,   async function. <br><br> <b></b> <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">name</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[param[, param[, ... param]]]</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// body }</span></span></code> </pre> <br> name ‚Äî  . <br> param ‚Äî  ,     . <br> statements ‚Äî ,   . <br><br>    async  Promise.    , Promise ,   .   async  , Promise     (throws) . <br><br>  async    await,     async      Promise,     async    . <br><br>   await     .       SyntaxError. <br><br>   async/await   promises        Promises.     Promises   callback-, async/await     promises. <br><br>  <b>Exemplo</b> <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">resolveAfter2Seconds</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">x</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">resolve</span></span></span><span class="hljs-function"> =&gt;</span></span> { setTimeout(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> { resolve(x); }, <span class="hljs-number"><span class="hljs-number">2000</span></span>); }); } <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">add1</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">x</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> a = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> resolveAfter2Seconds(<span class="hljs-number"><span class="hljs-number">20</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> b = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> resolveAfter2Seconds(<span class="hljs-number"><span class="hljs-number">30</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> x + a + b; } add1(<span class="hljs-number"><span class="hljs-number">10</span></span>).then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">v</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(v); <span class="hljs-comment"><span class="hljs-comment">//  60  4  }); async function add2(x) { const a = resolveAfter2Seconds(20); const b = resolveAfter2Seconds(30); return x + await a + await b; } add2(10).then(v =&gt; { console.log(v); //  60  2  });</span></span></code> </pre> <br><h4>    ? </h4><br>     JS-   .js ,         .        ,     .         . <br><br>    ,    JS ‚Äî   ,       .  , ,      ,  ,   .        ,   . (You-Dont-Know-JS/async &amp; performance, Jake Archibald). <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// ajax(..)  Ajax-,   var data = ajax( "http://some.url.1" ); console.log( data );// !  `data`     Ajax-</span></span></code> </pre> <br>    ? console.log()  ,      . <br><br>   ¬´¬ª    ,   : <br><br><pre> <code class="javascript hljs">ajax( <span class="hljs-string"><span class="hljs-string">"http://some.url.1"</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">myCallbackFunction</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">data</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log( data ); <span class="hljs-comment"><span class="hljs-comment">// ,   ! } );</span></span></code> </pre> <br>        . <br><br>    3  getUser, getPosts, getComments. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { getUser, getPosts, getComments } = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'./db'</span></span>); getUser(<span class="hljs-number"><span class="hljs-number">1</span></span>, (error, user) =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(error) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.error(error); getPosts(user.id, (error, posts) =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(error) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.error(error); getComments(posts[<span class="hljs-number"><span class="hljs-number">0</span></span>].id, (error, comment) =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(error) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.error(error); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(comments); }); }); });</code> </pre> <br>       ,        .       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">Callback Hell</a> .   ,     () ,     . <br><br>         Promise (      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="></a> ,        .        .        . <br><br><pre> <code class="javascript hljs">getUser(<span class="hljs-number"><span class="hljs-number">1</span></span>) .then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">user</span></span></span><span class="hljs-function"> =&gt;</span></span> getPosts(user,id)) .then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">posts</span></span></span><span class="hljs-function"> =&gt;</span></span> getComments(posts[<span class="hljs-number"><span class="hljs-number">0</span></span>].id)) .then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">comments</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(comments)) .catch(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">error</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.error(error));</code> </pre> <br>  Promise  Generators (       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="></a> .          ,       Promise,      ‚Äî  ,   .            try...catch.        ‚Äî        Promise    ,      .          ,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">co</a> .         . <br><br><pre> <code class="javascript hljs">co(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">* (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> user = <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> getUser(<span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> posts = <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> getPosts(user.id); <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> comments = <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> getComments(posts[<span class="hljs-number"><span class="hljs-number">0</span></span>].id); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(comments); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (error) { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(error); } }); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">co</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">generator</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> iterator = generator(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">resolve, reject</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">run</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">prev</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { value, done } = iterator.next(prev); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (done) resolve(value); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (value <span class="hljs-keyword"><span class="hljs-keyword">instanceof</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>) value.then(run, reject); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> run(value); } run(); }); }</code> </pre> <br>             . <br>    (Calback functions) ‚Äî   ,        . <br><br>  (Promises) ‚Äî   ,     . <br><br>  (Generators) ‚Äî     ,      ,        . <br><br>        (Promises)   (Generators),  ,         . <br><br>     ,      ,   : <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getUser</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">id</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-attr"><span class="hljs-attr">id</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span> }; } <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> user = getUser(<span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(user); <span class="hljs-comment"><span class="hljs-comment">// { id: 1 }</span></span></code> </pre> <br>      (   async),    Promise      id. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getUser</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">id</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-attr"><span class="hljs-attr">id</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span> }; } <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> user = getUser(<span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(user); <span class="hljs-comment"><span class="hljs-comment">// Promise { {id: 1} }</span></span></code> </pre> <br>  ,  ,      Promis (    Promis     ).          ,      . <br><br>          then(). <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getUser</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">id</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-attr"><span class="hljs-attr">id</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span> }; } getUser(<span class="hljs-number"><span class="hljs-number">1</span></span>) .then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">user</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(user)); <span class="hljs-comment"><span class="hljs-comment">// { id: 1 }</span></span></code> </pre> <br>       await    . <br><br>      (          HTTP . <br><br><pre> <code class="javascript hljs">fetch(<span class="hljs-string"><span class="hljs-string">`https://jsonplaceholder.typicode.com/users/1`</span></span>) .then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">data</span></span></span><span class="hljs-function"> =&gt;</span></span> data.json()) .then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">data</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(data));</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√â assim que o c√≥digo ass√≠ncrono se parece com o Promise. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mas podemos escrever c√≥digo ass√≠ncrono como s√≠ncrono se usarmos fun√ß√µes ass√≠ncronas.</font></font><br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sendRequest</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> response= <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> fetch(<span class="hljs-string"><span class="hljs-string">`https://jsonplaceholder.typicode.com/users/1`</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> response.json(); } <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> a = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> sendRequest(); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(a); } main();</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A √∫nica coisa que n√£o gosto √© que o operador ass√≠ncrono possa ser usado apenas em fun√ß√µes ass√≠ncronas. </font><font style="vertical-align: inherit;">Caso contr√°rio, eu n√£o precisaria usar a fun√ß√£o main (). </font><font style="vertical-align: inherit;">Obviamente, voc√™ tamb√©m pode usar o m√©todo then (), mas o c√≥digo n√£o parecer√° mais ass√≠ncrono.</font></font><br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sendRequest</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> response= <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> fetch(<span class="hljs-string"><span class="hljs-string">`https://jsonplaceholder.typicode.com/users/1`</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> response.json(); } sendRequest() .then(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">data</span></span></span><span class="hljs-function">) =&gt;</span></span> <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(data));</code> </pre> <br>              fetch().       await,      :    fetch()      response.       :    fetch()       . <br><br>      Promise  async function <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//  Promise function sendRequest() { return fetch(`https://jsonplaceholder.typicode.com/users/1`) .then(data =&gt; data.json()); } //  async function async function sendRequest() { let response = await fetch(`https://jsonplaceholder.typicode.com/users/1`); return response.json(); }</span></span></code> </pre> <br>  await       ,          . <br><br>          try...catch. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sendRequest</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> response = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> fetch(<span class="hljs-string"><span class="hljs-string">`https://jsonplaceholder.typicode.com/users/1`</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Error</span></span>(<span class="hljs-string"><span class="hljs-string">"Unexpected error"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> response.json(); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span>(error) { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(error); <span class="hljs-comment"><span class="hljs-comment">// Error: Unexpected error at sendRequest } }</span></span></code> </pre> <br>   ‚Ä¶ <br><br><pre> <code class="javascript hljs"> <span class="hljs-comment"><span class="hljs-comment">//    async; await; async; await; async; await; async; await; In the System(); The function.sleep()s tonight~</span></span></code> </pre> <br>  Async Function Definitions   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"></a> ,    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">MDN Web Docs</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt475074/">https://habr.com/ru/post/pt475074/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt475058/index.html">A cidade adormece, moradores de Habrovsk acordam</a></li>
<li><a href="../pt475060/index.html">Criando um servi√ßo simples de rastreamento de chamadas, parte 2</a></li>
<li><a href="../pt475064/index.html">.NET Core 3 para √°rea de trabalho do Windows</a></li>
<li><a href="../pt475066/index.html">As cr√¥nicas da fome de livros</a></li>
<li><a href="../pt475072/index.html">Estagi√°rios atrav√©s dos olhos da empresa</a></li>
<li><a href="../pt475076/index.html">Super-her√≥is sovi√©ticos, boogers tchecos e clone australiano</a></li>
<li><a href="../pt475078/index.html">No√ß√µes b√°sicas sobre wrappers de propriedades no SwiftUI</a></li>
<li><a href="../pt475082/index.html">Habr Weekly # 26 / Semana de trabalho de quatro dias, GitLab entrou na pol√≠tica, Yandex est√° testando o rob√¥ de entrega Rover</a></li>
<li><a href="../pt475086/index.html">Digitando API REST para desenvolvedor frontend</a></li>
<li><a href="../pt475090/index.html">Pr√©-visualiza√ß√£o do .NET Core com Jupyter Notebooks 1</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>