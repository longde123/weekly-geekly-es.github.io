<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>答 锔  C贸mo hackear la protecci贸n de copia de la consola Sega Dreamcast   </title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Despu茅s del lanzamiento del DOOM Black Book, me fui de vacaciones a Jap贸n, donde logr茅 jugar a Ikaruga en una m谩quina arcade real en la sala de juegos...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>C贸mo hackear la protecci贸n de copia de la consola Sega Dreamcast</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/433072/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/75/nh/l3/75nhl327vyzpklsanxeb3yb9tsw.png"></div><br>  Despu茅s del lanzamiento del <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">DOOM Black Book,</a> me fui de vacaciones a Jap贸n, donde logr茅 jugar a Ikaruga en una m谩quina arcade real en la sala de juegos Taito HEY en el barrio Akihabara de Tokio.  Esta experiencia nuevamente revivi贸 mi inter茅s en la 煤ltima consola de videojuegos de SEGA: Dreamcast. <br><br>  En la red puede encontrar muchos documentos que facilitan enormemente el proceso de estudiar el problema.  Hay dos recursos excelentes que pueden actualizar r谩pidamente a cualquiera: el maravilloso sitio web de Marcus Comstedt, que describe todo hasta los registros de la GPU, y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">el</a> recurso de Jockel <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">"</a> Creemos <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">un juego para Sega Dreamcast desde cero"</a> . <br><br>  Mientras estudiaba el auto, descubr铆 una historia incre铆ble sobre c贸mo los hackers rompieron r谩pidamente la protecci贸n de copias de juegos y arruinaron las 煤ltimas esperanzas de hardware de SEGA. <br><a name="habracut"></a><br><h2>  Primer nivel de protecci贸n: GD-ROM </h2><br>  En el papel, la protecci贸n de copia para SEGA Dreamcast se ve铆a muy fuerte.  Los juegos se entregaron en un medio especial llamado GD-ROM, que solo SEGA pod铆a producir.  GD significa "Gigabyte Disc" ("disco gigabyte"), es decir, su mayor densidad de grabaci贸n proporcion贸 un volumen m谩ximo de 1 GB, que era mucho m谩s que las capacidades de un CD-ROM convencional (700 MB). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c59/3dc/d90/c593dcd90243f19b05b025685883c7de.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/797/044/2e8/7970442e84c49259e3a534c34a2909e0.svg" alt="imagen"></div><br>  GD-ROM ten铆a las mismas dimensiones f铆sicas que el CD-ROM, pero a nivel macro, consist铆a en dos 谩reas distinguibles a simple vista. <br><br>  La primera zona (oscura) es una regi贸n de baja densidad compatible con CD-ROM que contiene hasta 35 MB.  Conten铆a una pista de audio de voz que le recordaba al usuario que los contenidos del disco estaban destinados a SEGA Dreamcast, y no a un reproductor de CD <sup>[1]</sup> .  Adem谩s, el desarrollador agreg贸 una pista all铆 con archivos de texto, por ejemplo, informaci贸n de derechos de autor y, a veces, materiales promocionales, por ejemplo, arte del juego. <br><br>  El 谩rea de alta densidad (luz) se almacen贸 hasta 984 MB <sup>[2]</sup> y todo el contenido del juego se encuentra en 茅l. <br><br>  A los piratas inform谩ticos les parec铆a imposible expulsar el juego del disco y volver a grabarlo para su distribuci贸n. <br><br><h2>  Arranque desde GD-ROM: IP.BIN y 1ST_READ.BIN </h2><br>  Antes de hablar sobre c贸mo los piratas lograron copiar juegos, necesitamos entender la secuencia de carga.  Dreamcast no ten铆a un sistema operativo.  Existe una idea err贸nea popular de que usaba Windows CE, pero de hecho, el sistema operativo de Microsoft era solo una biblioteca est谩tica adicional que los desarrolladores de Dreamcast pod铆an conectar para usar DirectX, DirectInput y DirectSound <sup>[3]</sup> .  En algunos juegos, se utiliz贸 WinCE <sup>[4]</sup> , pero en la mayor铆a (por ejemplo, Ikaruga) no se us贸.  Independientemente de lo que usara el desarrollador, un juego con un sistema operativo totalmente conectado y Dreamcast siempre comenz贸 de la misma manera. <br><br>  Durante el uso normal y el lanzamiento del juego oficial en el Dreamcast recientemente activado, se lanz贸 BOOTROM, cargando el programa de arranque desde el GD-ROM a la RAM.  Este peque帽o programa, ubicado en la 煤ltima pista de GD-ROM y conocido por la comunidad como "IP.BIN", mostr贸 una pantalla con licencia SEGA y realiz贸 dos niveles de arranque para configurar registros de hardware, crear una pila de CPU e inicializar VBR <sup>[5]</sup> . <br><br>  M谩s importante a煤n, IP.BIN conten铆a el nombre del ejecutable del juego.  Este nombre se busc贸 en el sistema de archivos GD-ROM y se carg贸 en la RAM a 0x8C010000, despu茅s de lo cual el programa se transfiri贸 all铆.  T铆picamente, el ejecutable se llamaba "1ST_READ.BIN". <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/14f/fac/4a7/14ffac4a70c0af94444f819b03acf2af.svg"></div><br>  Despu茅s de que la CPU fue a la direcci贸n 0x8C010000, el juego comenz贸 como deber铆a. <br><br><h2>  Segundo nivel de protecci贸n: codificador ransomware </h2><br>  La posibilidad te贸rica de hackear surgi贸 debido a la capacidad aparentemente insignificante de Dreamcast para arrancar no desde GD-ROM, sino desde CD-ROM.  Inicialmente, esta funcionalidad llamada "MIL-CD" fue concebida para agregar funciones multimedia a los CD de m煤sica, pero pr谩cticamente no se us贸, con la excepci贸n de siete aplicaciones de karaoke. <br><br>  Los ingenieros de SEGA entendieron que cargar un MIL-CD podr铆a usarse como un vector de ataque, por lo que agregaron protecci贸n.  Cuando la consola reconoci贸 el CD-ROM, BOOTROM descarg贸 IP.BIN de la manera habitual, pero cifr贸 1ST_READ.BIN, a primera vista al azar.  El ejecutable de trabajo se convirti贸 en un hash ca贸tico que hizo que la consola se congelara. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/377/512/b26/377512b26e5672bd9f78bc904dc9715d.svg"></div><br>  Desde este punto de vista, la consola parec铆a estar protegida de manera confiable.  Dreamcast podr铆a reconocer una copia pirateada del juego, corromper el archivo ejecutable durante el proceso de descarga y derrotar a los piratas. <br><br><h2>  隆Sirve mi espada larga! </h2><br>  El problema con el archivo da帽ado se resolvi贸 cuando a finales de 1999 el equipo de piratas inform谩ticos Utopia rob贸 el Katana SDK (Sega SDK oficial para Dreamcast) <sup>[6]</sup> .  Result贸 que el codificador no era m谩s que una implementaci贸n del principio de "seguridad a trav茅s de la oscuridad".  El SDK conten铆a un codificador inverso, que convirti贸 el ejecutable correcto en un "hash hacia atr谩s", que nuevamente se convirti贸 en un ejecutable despu茅s de cargar y codificar con la consola Dreamcast al arrancar desde un CD-ROM. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/102/4e1/0b5/1024e10b5ec8dfd9b9604248728e9e83.svg"></div><br><h2>  Recuperando un juego con su GD-ROM </h2><br>  El SDK robado era todo lo que los piratas necesitaban.  Gracias a la capacidad de ejecutar c贸digo en una m谩quina, Dreamcast ahora podr铆a usarse no como una consola de juegos, sino como una unidad GD-ROM.  El "cable codificador" del SDK <sup>[7]</sup> hizo posible conectar la consola a una PC y establecer una conexi贸n f铆sica.  Para que la consola descargue el contenido de las pistas de GD, se escribi贸 un archivo ejecutable especial.  Luego se volvi贸 a codificar y se grab贸 en un CD-ROM para generar todos los 1 GB de datos a trav茅s del puerto serie de la consola.  Fue un proceso propenso a errores que tom贸 hasta 18 horas <sup>[8]</sup> <sup>[9]</sup> .  El resultado se guard贸 en un formato ".gdi" creado especialmente. <br><br><pre>  ikaruga.gdi 153 bytes
 track01.bin 13982 640 bytes
 track02.raw 2,088,576 bytes
 track03.bin 1 185 760 800 bytes </pre><br>  <b>Un hecho interesante</b> : puede ver que la cantidad total de datos no es 1 GB, como se mencion贸 anteriormente, sino 1.2 GB.  Esto se debe a que los sectores de GD-ROM de 2352 bytes siguen el formato del Libro Rojo, que utiliza 12 bytes para la sincronizaci贸n, 4 bytes para el encabezado, 2048 bytes para la carga 煤til y 288 bytes para el C贸digo de detecci贸n de errores / C贸digo de correcci贸n de errores <sup>[10 ]</sup> <br><br><pre>  $ cat ikaruga.gdi 
 3
 1 0 4 2352 track01.bin 0
 2 5945 0 2352 track02.raw 0
 3 45000 4 2352 track03.bin 0 </pre><br><h2>  C贸mo adaptar un GD-ROM de 1000 megabytes a un CD-ROM de 700 megabytes </h2><br>  Para ajustar el juego en un CD-ROM de 700 megabytes, se redise帽aron los recursos del juego.  El sistema de archivos ISO-9660 utilizado en GD-ROM facilit贸 cambiar la discretizaci贸n de videos y m煤sica, as铆 como eliminarlos por completo.  Sin embargo, para la mayor铆a de los juegos, no se requer铆a un proceso tan complejo porque no ocupaban el total de 1 GB.  Por ejemplo, el Ikaruga de Treasure ocupaba solo 150 MB, y la mayor parte de su contenido estaba lleno de ceros.  En tales casos, basta con editar los datos de relleno. <br><br>  De hecho, ISO-9660 es un formato tan conocido que incluso los scripts de Python (por ejemplo, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">gditools.py</a> ) se escribieron para <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">estudiar el</a> contenido de los archivos .gdi. <br><br><h2>  Empaque y distribuci贸n </h2><br>  Las 煤ltimas dos etapas del proceso fueron la codificaci贸n inversa 1ST_READ.BIN y el empaquetado de toda la informaci贸n en un archivo .cdi para que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">DiscJuggler</a> pudiera grabar la imagen en CD-R.  El resultado obtenido funcion贸 sin problemas en cualquier Dreamcast de vainilla sin la necesidad de un chip de modificaci贸n. <br><br><h2>  Reacci贸n y consecuencias de SEGA </h2><br>  SEGA lanz贸 r谩pidamente la segunda versi贸n de la consola DC con el CD de MIL deshabilitado por completo, pero el da帽o ya est谩 hecho.  Despu茅s de una ca铆da catastr贸fica en los ingresos y el lanzamiento de la competencia PS2, los desarrolladores abandonaron Dreamcast y SEGA abandon贸 el desarrollo de equipos, centr谩ndose completamente en la creaci贸n de software. <br><br><h2>  Referencias </h2><br>  [1] Fuente: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Taller SEGA GD</a> <br>  [2] Fuente: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">segaretro.org: GD-ROM</a> <br>  [3] Fuente: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Microsoft anuncia el kit de herramientas de Windows CE para Dreamcast</a> <br>  [4] Fuente: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">juegos de Dreamcast que utilizan Windows CE</a> <br>  [5] Fuente: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">IP.BIN y 1ST_READ.BIN</a> <br>  [6] Fuente: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Construyamos un juego Sega Dreamcast desde cero</a> <br>  [7] Fuente: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Adaptador serial de PC</a> <br>  [8] Fuente: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Una mirada m谩s precisa y profunda sobre la seguridad de Dreamcast</a> <br>  [9] Fuente: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Las formas m谩s r谩pidas se dise帽aron en 煤ltimo lugar, utilizando el conector de banda ancha de DC</a> <br>  [10] Fuente: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Dreamcast Mito: Capacidad de almacenamiento GD-ROM</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es433072/">https://habr.com/ru/post/es433072/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es433060/index.html">Por qu茅 no creo microbenchmarks</a></li>
<li><a href="../es433062/index.html">AXIS P1367 versus IDIS DC-B3303X: Comparar c谩maras CCTV</a></li>
<li><a href="../es433064/index.html">Gesti贸n de incidentes: "no puede darse por vencido" o el arte de colocar comas</a></li>
<li><a href="../es433066/index.html">HighLoad Cup # 2. Campeonato para desarrolladores de back-end de nuevo en servicio</a></li>
<li><a href="../es433070/index.html">C贸mo distinguir champ煤 de champi帽ones y brochetas de champ谩n ... Elasticsearch: busque productos en las bases de datos de la tienda</a></li>
<li><a href="../es433074/index.html">Cambiar a Kotlin en un proyecto de Android: consejos y trucos</a></li>
<li><a href="../es433076/index.html">C贸mo creamos nuestra biblioteca de la Galer铆a de Android para ver contenido multimedia</a></li>
<li><a href="../es433078/index.html">Escribimos robots comerciales utilizando el marco gr谩fico StockSharp. Parte 2</a></li>
<li><a href="../es433082/index.html">Bombear las cuentas de otras personas se ha convertido en un delito penal en Corea del Sur</a></li>
<li><a href="../es433084/index.html">Lecci贸n abierta "Ingenier铆a de caracter铆sticas en el ejemplo del cl谩sico conjunto de datos Titanic"</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>