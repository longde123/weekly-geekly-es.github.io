<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🎪 🔗 👉🏽 "Ich sehe keinen Grund, Python für die Arbeit mit Spark zu verwenden, außer Faulheit." 👨🏿‍🍳 🙇🏼 🥊</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Neulich haben wir beschlossen, mit Dmitry Bugaychenko ( dmitrybugaychenko ), einem unserer Lehrer des Programms "Datenanalyse auf Scala", zu sprechen ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>"Ich sehe keinen Grund, Python für die Arbeit mit Spark zu verwenden, außer Faulheit."</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/newprolab/blog/442812/"><p>  Neulich haben wir beschlossen, mit Dmitry Bugaychenko ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link">dmitrybugaychenko</a> ), einem unserer Lehrer des Programms "Datenanalyse auf Scala", zu sprechen und mit ihm aktuelle Probleme bei der Verwendung von Scala in den Aufgaben von Data Science und Data Engineering zu besprechen.  Dmitry ist Analytiker bei Odnoklassniki. </p><br><p><img src="https://habrastorage.org/webt/6h/7b/ut/6h7butyls-jgjkhi1plmqmd9gxy.jpeg" alt="Bild"></p><a name="habracut"></a><br><p>  <strong>- Dima, du arbeitest bei Odnoklassniki.</strong>  <strong>Sag mir, was machst du da?</strong> <strong><br></strong> <br>  In Odnoklassniki begann ich 2011 mit der Arbeit an einem Entwurf einer Musikempfehlung.  Es war eine sehr interessante und schwierige Aufgabe - die meisten Musikempfehlungsdienste zu dieser Zeit basierten auf gut katalogisierten Veröffentlichungsinhalten, während wir echte UGC (User Generated Content) hatten, die zuerst gekämmt und in Regale sortiert werden mussten.  Im Allgemeinen erwies sich das resultierende System als recht gut und sie beschlossen, die Erfahrung auf andere Bereiche der Website auszudehnen: Gruppenempfehlungen, Freundschaften, Rangfolge des Feeds usw.  Gleichzeitig wuchs das Team, die Infrastruktur entwickelte sich, neue Algorithmen und Technologien wurden eingeführt.  Jetzt habe ich ein ziemlich breites Spektrum an Verantwortlichkeiten: Koordination der Daten von Wissenschaftlern, Entwicklung der DS-Infrastruktur, Forschungsprojekte usw. </p><br><p>  <strong>- Wie lange verwenden Sie Spark schon?</strong>  <strong>Was ist die Notwendigkeit?</strong> </p><br><p>  Die ersten Versuche, sich mit Spark anzufreunden, waren 2013, waren jedoch erfolglos.  Wir brauchten dringend ein leistungsstarkes interaktives Tool, mit dem wir Hypothesen schnell testen konnten, aber Spark dieser Zeit konnte nicht die Stabilität und Skalierbarkeit bieten, die wir brauchten.  Der zweite Versuch, den wir ein Jahr später machten, im Jahr 2014, und diesmal lief alles viel besser.  Im selben Jahr begannen wir mit der Implementierung von Streaming-Analyse-Tools auf der Basis von Kafka und Samza, versuchten Spark Streaming, konnten es dann aber nicht starten.  Aufgrund der relativ frühen Implementierung befanden wir uns bis 2017 für eine Weile in einer Aufholposition - eine große Menge Code auf dem ersten Spark hat uns daran gehindert, auf den zweiten umzusteigen, aber im Sommer 2018 haben wir dieses Problem gelöst und arbeiten nun an 2.3.3.  In dieser Version hat das Streaming bereits stabiler funktioniert und wir haben bereits einige neue Produktaufgaben erledigt. </p><br><p>  <strong>- Soweit ich weiß, verwenden Sie die Scala-API, nicht wie die meisten Python.</strong>  <strong>Warum so?</strong> </p><br><p>  Ich sehe aufrichtig keinen Grund, Python für die Arbeit mit Spark zu verwenden, außer Faulheit.  Die Scala-API ist flexibler und effizienter, aber nicht komplizierter.  Wenn Sie die Standardfunktionen von Spark SQL verwenden, ist der Scala-Code fast identisch mit dem entsprechenden Python-Code, und die Geschwindigkeit ist identisch.  Wenn Sie jedoch versuchen, die einfachste benutzerdefinierte Funktion zu erstellen, wird der Unterschied offensichtlich: Die Arbeit des Scala-Codes bleibt ebenso effizient, und der Python-Code verwandelt einen Multi-Core-Cluster in einen Kürbis und beginnt, Kilowatt / Stunde für völlig unproduktive Aktivitäten zu verbrennen.  In dem Ausmaß, mit dem wir arbeiten müssen, können wir uns eine solche Verschwendung einfach nicht leisten. </p><br><p>  <strong>- C Python ist verständlich.</strong>  <strong>Und ist Scala im Vergleich zu Java überhaupt etwas Besseres für die Datenanalyse?</strong>  <strong>In Java werden viele Dinge in den Big Data Stack geschrieben.</strong> </p><br><p> Wir verwenden Java sehr häufig, auch beim maschinellen Lernen.  Wir versuchen, nicht auf die am höchsten geladenen Scala-Anwendungen zuzugreifen.  Aber wenn es um interaktive Analyse und Rapid Prototyping geht, wird der Lakonismus von Scala zu einem Plus.  Natürlich sollten Sie immer bedenken, dass es beim Programmieren in Scala sehr einfach ist, die Beine an die Ohren zu schießen - viele Designs verhalten sich möglicherweise nicht so, wie Sie es von einer Position des gesunden Menschenverstandes erwarten würden, und einige einfache Vorgänge verursachen unnötiges Kopieren und Versuche, sich zu materialisieren Datensätze im Speicher. </p><br><p>  <strong>- Warum ist Scala bei all diesen Vorteilen noch nicht so beliebt?</strong>  <strong>Übertrifft es Python und Java deutlich?</strong> </p><br><p>  Scala ist ein sehr leistungsfähiges Tool, das von demjenigen, der es verwendet, eine ausreichend hohe Qualifikation erfordert.  Darüber hinaus werden mit der Teamentwicklung zusätzliche Anforderungen an die allgemeine Ebene der Entwicklungskultur gestellt: Der Code auf Scala ist sehr einfach zu schreiben, wird jedoch nach einiger Zeit vom Autor nicht immer erfolgreich gelesen und kann unter der Haube einer einfachen API eine Art Spiel erstellen.  Daher sollte besonderes Augenmerk auf die Aufrechterhaltung eines einheitlichen Stils, Funktions- und Stresstests der Lösung gelegt werden. </p><br><p>  Nun, wenn man JVM-Sprachen vergleicht, kann man Kotlin nur erwähnen - es gewinnt an Popularität, wird von vielen als „ideologisch verifizierter“ angesehen und unterstützt Spark sogar als Teil des Sparklin-Projekts, obwohl es immer noch sehr begrenzt ist.  Wir selbst verwenden es noch nicht für Spark, verfolgen aber die Entwicklung genau. </p><br><p>  <strong>- Zurück zu Spark.</strong>  <strong>Soweit ich weiß, hat Ihnen diese Scala-API-Funktionalität immer noch nicht gefallen, und Sie haben eine Art Gabel für Spark geschrieben?</strong> </p><br><p>  Es wäre falsch, unsere <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">PravdaML-</a> Projektgabel <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">aufzurufen</a> : Diese Bibliothek ersetzt nicht die SparkML-Funktionalität, sondern ergänzt sie durch neue Funktionen.  Wir kamen zu den Entscheidungen, die dort umgesetzt wurden, und versuchten, die Band-Ranking-Modelle zu skalieren und auf die reproduzierbaren Schienen zu setzen.  Tatsache ist, dass Sie bei der Entwicklung effektiver Algorithmen für verteiltes maschinelles Lernen viele "technische" Faktoren berücksichtigen müssen: Wie werden Daten korrekt in Knoten zerlegt, an welchem ​​Punkt müssen sie zwischengespeichert, heruntergesampelt usw. werden?  Es gibt keine Möglichkeit, diese Aspekte in der Standard-SparkML zu verwalten, und sie müssen über die ML-Pipeline hinaus verschoben werden, was sich negativ auf die Verwaltbarkeit und Reproduzierbarkeit auswirkt. </p><br><p>  <strong>- Ich erinnere mich, dass Sie zwei Optionen für den Namen hatten ...</strong> </p><br><p>  Ja, der ursprüngliche Name ok-ml-pipelines schien den Jungs langweilig, daher sind wir gerade dabei, den neuen Namen PravdaML umzubenennen. </p><br><p>  <strong>- Viele Leute benutzen es außerhalb Ihres Teams?</strong> </p><br><p>  Ich denke nicht viel, aber wir arbeiten daran.  J. </p><br><p>  <strong>- Lassen Sie uns über Rollen und Berufe im Bereich der Arbeit mit Daten sprechen.</strong>  <strong>Sagen Sie mir, sollte ein Datenwissenschaftler Code in der Produktion schreiben oder ist dies bereits ein anderer Beruf und eine andere Rolle?</strong> <strong><br></strong> <br>  Die Antwort auf diese Frage ist meine Meinung, und es gibt eine harte Realität.  Ich habe immer gedacht, dass eine Person für die erfolgreiche Implementierung von ML-Lösungen verstehen muss, wo und warum alles implementiert wird (wer der Benutzer ist, welche Bedürfnisse er hat und welche Bedürfnisse das Unternehmen hat), er muss verstehen, welche mathematischen Methoden zur Entwicklung der Lösung angewendet werden können, und wie diese Methoden aus technischer Sicht funktionieren können.  Daher versuchen wir in Odnoklassniki immer noch, uns an das Modell der Einzelverantwortung zu halten, wenn eine Person eine Initiative entwickelt, diese umsetzt und umsetzt.  Um einzelne private Probleme zu lösen, sei es ein effektives DBMS oder ein interaktives Layout, können Sie natürlich immer Leute mit umfassender Erfahrung in diesen Bereichen anziehen, aber die Integration all dessen in einen einzigen Mechanismus bleibt beim Wissenschaftler als der Person, die am besten versteht, was genau und wie es funktionieren soll Ausgabe. </p><br><p>  Es gibt jedoch eine harte Realität auf dem Arbeitsmarkt, die im Bereich der ML inzwischen stark überhitzt ist, was dazu führt, dass viele junge Fachkräfte es nicht für notwendig halten, etwas anderes als ML selbst zu studieren.  Infolgedessen wird es immer schwieriger, einen Spezialisten für den gesamten Zyklus zu finden.  Obwohl kürzlich eine gute Alternative aufgetaucht ist: Die Praxis hat gezeigt, dass gute Programmierer ML ziemlich schnell und recht gut lernen.  J. </p><br><p>  <strong>- Datum Ingenieur müssen Scala kennen?</strong>  <strong>Wie gut übrigens?</strong>  <strong>Muss ich in den Dschungel der funktionalen Programmierung gehen?</strong> </p><br><p>  Es ist auf jeden Fall notwendig, Scala zu kennen, schon allein deshalb, weil zwei grundlegende Tools wie Kafka und Spark darauf geschrieben sind und Sie in der Lage sein müssen, ihren Quellcode zu lesen.  Was den "Dschungel der funktionalen Programmierung" betrifft, würde ich ihnen dringend raten, nicht zu viel zu missbrauchen: Je mehr Entwickler den Code lesen und verstehen können, desto besser.  Auch wenn dafür manchmal „elegantes“ funktionales Design in einem banalen Zyklus eingesetzt werden muss. </p><br><p>  <strong>- Das Universum der Berufe in diesem Bereich hat bereits aufgehört zu expandieren, oder sollten wir noch auf die Entstehung neuer Berufe warten?</strong> </p><br><p>  Ich denke, dass es in absehbarer Zeit in ML und DS einen Wendepunkt in Bezug auf die Automatisierung geben wird: Die Hauptmuster, denen Menschen bei der Arbeit mit Attributen, der Auswahl eines Modells und seiner Parameter und der Qualitätsprüfung folgen, werden automatisiert.  Dies wird dazu führen, dass die Nachfrage nach Spezialisten, die "die Parameter auswählen", erheblich sinken wird, aber AutoML-Ingenieure, die automatisierte Lösungen implementieren und entwickeln können, werden gefragt sein. </p><br><p>  <strong>"Sie unterrichten aktiv, wie ich es verstehe."</strong>  <strong>Warum halten Sie das für wichtig?</strong>  <strong>Was ist die Motivation dahinter?</strong> </p><br><p>  Wir alle werden eines Tages in den Ruhestand gehen und die Qualität unseres Lebens wird stark davon abhängen, wer uns ersetzen wird.  Investitionen in die Bildung der nächsten Generation sind daher eine der wichtigsten. </p><br><p>  <strong>- In unserem Programm <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">"Datenanalyse auf Scala" werden</a> Sie mehrere Klassen durchführen.</strong>  <strong>Erzähl mir kurz davon.</strong>  <strong>Welche Bedeutung haben sie?</strong> </p><br><p>  In diesen Kursen werden wir nur untersuchen, wie Ingenieurwesen und Mathematik zusammenpassen: wie man den Prozess richtig organisiert, ohne unnötige Hindernisse für ETL-&gt; ML-&gt; Prod einzuführen.  Der Kurs basiert auf den Funktionen von Spark ML: Grundkonzepte, unterstützte Konvertierungen, implementierte Algorithmen und deren Einschränkungen.  Wir werden auf den Bereich eingehen, in dem die vorhandenen SparkML-Funktionen nicht ausreichen, und es wird erforderlich, Erweiterungen wie PravdaML zu verwenden.  Nun, es wird definitiv Übung geben, nicht nur auf der Ebene des „Zusammenstellens einer Lösung aus vorgefertigten Würfeln“, sondern auch darüber, wie man versteht, dass hier ein neuer „Würfel“ benötigt wird und wie man ihn implementiert. </p><br><p>  <strong>- Gibt es ein Lieblingswortspiel mit Scala?</strong>  <strong>Kletterwand, Kletterer, Felskunst - verwenden Sie im Alltag?</strong> </p><br><p>  Es sei denn, das Epitheton „indoskal“, mit dem wir besonders bemerkenswerte Open-Source-Stücke ansprechen, deren Autor eindeutig die bemerkenswerte Fähigkeit demonstrieren wollte, unlesbaren Code mithilfe funktionaler Abstraktionen zu konstruieren. </p><br><p>  <strong>- Moskau oder Peter?</strong> </p><br><p>  Jede Stadt hat ihre eigene Lust.  Moskau ist eine reiche und gepflegte Stadt mit einem schnellen Rhythmus.  Peter ist ruhiger und erfüllt vom Charme der ehemaligen europäischen Hauptstadt.  Deshalb komme ich gerne nach Moskau, um dort zu besuchen, aber ich lebe lieber in St. Petersburg. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de442812/">https://habr.com/ru/post/de442812/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de442800/index.html">Einfacher Telegramm-Bot in Python in 30 Minuten</a></li>
<li><a href="../de442804/index.html">MVCC-1. Isolierung</a></li>
<li><a href="../de442806/index.html">Das vorläufige DUMP-2019-Programm ist fertig. Sprecher von Evil Martians, Tinkoff.ru, HTML Academy, SkyEng, 2GIS</a></li>
<li><a href="../de442808/index.html">Wir laden Sie zur Droid Party ein - einem Treffen, das sich praktischen Fragen der Entwicklung von Android-Anwendungen und -Geräten widmet</a></li>
<li><a href="../de442810/index.html">Mythen der Populärphysik, Fortsetzung: Schwerkraft</a></li>
<li><a href="../de442814/index.html">10 Jahre sind vergangen und niemand hat herausgefunden, wie man die Blockchain benutzt. Und wieder hier?</a></li>
<li><a href="../de442816/index.html">Erstellen Sie Ihren eigenen Gamecontroller</a></li>
<li><a href="../de442818/index.html">10 häufige Fehler in schriftlichem Englisch und wie man damit umgeht</a></li>
<li><a href="../de442820/index.html">Benutzerdefinierte Coroutinen in Einheit mit Vorlieben und Kurtisanen</a></li>
<li><a href="../de442822/index.html">Rechenzentrum im Meer und im Orbit: Haben sie praktische Bedeutung?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>