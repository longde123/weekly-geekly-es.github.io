<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>⚫️ 👩🏻‍🏫 👩 Spectrum-48 gegen eine Packung Zigaretten, Haferbrei von einer Axt oder was STM32F103C8T6 + Video kann (Update) ◾️ ⁉️ 👩🏽‍🎨</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Alles begann mit einem weiteren Versuch, mit dem Rauchen aufzuhören. Nachdem ich meine interne „Kröte“ auf der Suche nach Unterstützung geweckt habe, ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Spectrum-48 gegen eine Packung Zigaretten, Haferbrei von einer Axt oder was STM32F103C8T6 + Video kann (Update)</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/412325/">  Alles begann mit einem weiteren Versuch, mit dem Rauchen aufzuhören.  Nachdem ich meine interne „Kröte“ auf der Suche nach Unterstützung geweckt habe, sage ich zu ihr: „Sehen Sie, eine Packung <s>meiner</s> Zigaretten kostet heute wie ein Taschen-Retro-Computer mit einem Bildschirm, das sind ungefähr 10 US-Dollar, und einst haben wir für den Sinclair-48K-Klon das gesamte monatliche Gehalt ausgegeben und verbrachte mehr als einen Monat mit Assembly und Debugging. “  Sie: "Ihr seid Ziegen und Lügner, beweist es!"  Ich musste arbeiten <br><br>  Also, die Ausgangsmaterialien: <br><br><ol><li>  Blaue Pille: STM32F103C8T6 - 20K RAM 64K Flash $ 2.06 </li><li>  Arduino Display: ILI9341 2.8 "320x240 mit Touchscreen und 7,72 $ Kartensteckplatz </li><li>  Hochtöner $ 0,18 </li><li>  Ein paar Knöpfe (7 Stück) $ 0,2 </li><li>  Einige Drähte $ 0.1 </li><li>  Flash-Karte für 64 Mega (von einer alten Kamera), nicht in der Berechnung enthalten </li><li>  Der ST-LINK-Programmierer wird nicht verbraucht und ist nicht in der Berechnung enthalten, kostet aber auch ein paar Dollar </li><li>  Eine Packung Zigaretten - zu schnell und jeden Tag konsumiert - 8,37 USD </li></ol><br><img src="https://habrastorage.org/webt/ik/ll/r9/ikllr9oryxwdk8v04ktordurogk.jpeg"><br><a name="habracut"></a><br>  Die wunderbare „blaue Pille“, hergestellt in China, ist für alle gut, außer für die Menge an RAM, nur 20 KB (obwohl es auch wenig Konstante gibt, nur 64 KB).  Spectrum-48K benötigt 48K (Zufall? Ich glaube nicht) RAM und 16K Konstante.  Wir werden den RAM vom Bildschirm nehmen, da die Auflösung des Spessi 256x192 + Rand beträgt, während ILI9341 320x240 mit 18 Bit pro Punkt hat.  Das heißt, Sie können die Mitte des Bildschirms zum Rendern und alles andere für den eigentlichen „Swap-Bereich“ (Swap-Bereich?) Verwenden.  Darüber hinaus wird der vom Prozessoremulator Z80-Speicher am häufigsten verwendete (LRU-Algorithmus) im RAM STM32 zwischengespeichert, der Rest wird im Bildschirmspeicher ILI9341 mit langsamem (SPI) Zugriff gespeichert. <br><br>  Vor ungefähr 25 Jahren schrieb ich den Z80-Emulator auf der 80286-Plattform. Sie sind keine sehr entfernten Verwandten des Z80. Beide stammten aus 8080, was es mir ermöglichte, mit dem wunderbaren Borland TACM und C ++ einen sehr schnellen Code zu erhalten, aber dann war eine so detaillierte Emulation nicht erforderlich ( Der Code wurde für beide Seiten geschrieben: ein Notizbuch mit einem Wörterbuch und seinem Emulator unter Windows 3.1 zum Debuggen). <br><cut></cut><br>  Es war zu faul, um von Grund auf neu zu schreiben, und so fragte ich Google: "Sagen Sie mir, Google, wie sieht es heute mit der ordentlichen Z80-Emulation aus?"  Google gab mir ein <s>paar tausend</s> zwei geeignete Projekte: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Basierend auf STM32F4, Autor von Gorien</a> und dem fortschrittlichsten und debuggtesten <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Fuse-Emulator</a> .  Bei der ersten Zusammenstellung des Codes von Gorien stellte sich heraus, dass etwa 100.000 ausführbarer Code vorhanden waren, der zu diesem Thema deutlich besser verfügbar ist.  Ich musste ein bisschen daran basteln, einen <s>Elefanten in den Kühlschrank zu schieben</s> .  Beispielsweise werden Aufrufe lokaler Variablen zu einem kompakteren Code kompiliert als globale, alle erweiterten Befehle der Register IX und IY sind gleich, genau auf das Ersetzen von Variablen, die Zeichengeneratortabelle kann durch einen Link zum Spektrumzeichengenerator usw. ersetzt werden.  Außerdem musste der Prozessor auf 112 MHz übertaktet werden ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">danke an xedas für die Idee</a> ). <br><br>  Ergebnis: ein funktionierender (ich habe ungefähr ein Dutzend Spiele ausprobiert, während alle arbeiten) ZX Spectrum-48-Emulator mit einem Bildschirm von der Größe einer Zigarettenschachtel (er steckt bereits in Ihrer Tasche, aber die Drähte ragen heraus), der Dumps (Symbol + Speicherbild + Register ~ 50.000) von Spielen mit liest Flash-Kartenformat FAT32 (ein paar Kilobyte Code mehr) und mit einem Gesamtverbrauch von ~ 50 mA (dh etwa 50 Stunden von einem typischen 18650-Akku für 2500 mAh!) beträgt die Einschaltzeit weniger als eine Sekunde und die Gesamtkosten weniger als 10 US-Dollar. <br><br>  Nachteile: <br><br><ol><li>  Immer noch etwas langsamer als das Original. </li><li>  Der Bildschirm zeigt den Code des heruntergeladenen Programms in Farbe. </li><li>  Sie benötigen einen Joystick oder weichere Tasten.  Und die Gebühr.  Und eine Kiste.  Und gerade Arme.  Und ... </li></ol><br><cut></cut><br>  In ungefähren Plänen: Reduzierung des Verbrauchs (Abreißen der LEDs von der Platine), Hinzufügen einer Modulation der Bildschirmhelligkeit, Taktmodus bei ausgeschaltetem Bildschirm, Löten einer normalen Tastatur mit einem Joystick, Anpassen der Verzögerung für korrekten Ton und Lesen von einem Kassettenrekorder (und was?), PC-Dateiformatkonverter Dumps, drücken Sie etwas mehr Code, um die Benutzeroberfläche zu hosten.  Versuchen Sie, die Kosten der Plattform mithilfe eines 2,4-Zoll-Bildschirms zu senken.  Es ist wahr, na ja, sehr klein, aber für 5 ... Es ist klar, dass das Interesse hier rein sportlich ist, obwohl, wenn man die Geschwindigkeit berücksichtigt, mit der Enkelkinder Elektronik in unbrauchbare Teile zerlegen, der Preis immer noch wichtig ist. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Aktueller Arbeitscode auf Github</a> <br><br>  Und noch mehr Bilder für Fans, das R-Typ-Spiel, der Tauschbereich an den Rändern des Hauptbildschirms: <br><br><img src="https://habrastorage.org/webt/ee/_i/wt/ee_iwtuc-shar4iwezqs32vssz0.jpeg"><br><br>  Die andere Seite: <br><br><img src="https://habrastorage.org/webt/s4/bd/7_/s4bd7_7gn3xaunstac6hbje2b6s.jpeg"><br><br>  Atic-Atac-Spiel: <br><br><img src="https://habrastorage.org/webt/lm/gs/x3/lmgsx3jmparexgfw7kkom3jypco.jpeg"><br><br>  PS: Ich habe den Preis für eine Packung Zigaretten nicht erreicht, daher muss meine "Kröte" meine schlechten Gewohnheiten ertragen, aber ich bin bereits 55 Jahre alt, also habe ich das meiste davon bereits ausgegeben ... Fortsetzung folgt. <br>  Video, kein Ton, sorry: <br><iframe width="560" height="315" src="https://www.youtube.com/embed/n4u6VNxCTdA" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de412325/">https://habr.com/ru/post/de412325/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de412311/index.html">Eine in Navigation geschulte KI entwickelte ein System, das einem „Kompass“ eines Säugetiergehirns ähnelt</a></li>
<li><a href="../de412313/index.html">TooWheels - Rollstuhl mit offener Dokumentation</a></li>
<li><a href="../de412315/index.html">Google Duplex Service erschreckt mit seiner schönen und korrekten Sprache, da sind sie unzufrieden</a></li>
<li><a href="../de412319/index.html">Schwere Handarbeit von einem Elektronikingenieur: Zerlegen Sie das PocketBook 631 Plus und statten Sie es mit einer Solarbatterie aus</a></li>
<li><a href="../de412323/index.html">Hat mein Algorithmus psychische Probleme?</a></li>
<li><a href="../de412327/index.html">Die Ansicht des Fußgänger-Mathematikers: Warum unsere Straßen Guano sind</a></li>
<li><a href="../de412329/index.html">Stahlrahmen 3D Anet A8 Drucker</a></li>
<li><a href="../de412331/index.html">Digitale Assistenten befolgen Befehle, die für Menschen unhörbar sind</a></li>
<li><a href="../de412335/index.html">Wie Computex Taipei den Platzmangel und die PC-Marktkrise überlebte</a></li>
<li><a href="../de412337/index.html">Der Rostourismus wird das Booking.com-Verbot in Russland im Rahmen von Gegenmaßnahmen „ausarbeiten“</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>