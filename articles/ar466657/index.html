<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐๐ฝ ๐ธ ๐ฐ๐ผ ุงูุชูุงุตูู ุงูุฏููุงููููุฉ: ุฃูุนุงุจ ูุชุฑุฌู ุณุฑูุฉ ุ ุชุณุฑุจ ุงูุฐุงูุฑุฉ ุ ุงููุฑูู ุงูุฏูููุฉ ูู ุงูุฃุฏุงุก ๐ ๐จโ๐ญ ๐ด๐ป</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ููุฏูุฉ 

 ุงููุธุฑ ูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุงูุชุงููุฉ: 



//Any native COM object var comType = Type.GetTypeFromCLSID(new Guid("E13B6688-3F39-11D0-96F6-00A0C9...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ุงูุชูุงุตูู ุงูุฏููุงููููุฉ: ุฃูุนุงุจ ูุชุฑุฌู ุณุฑูุฉ ุ ุชุณุฑุจ ุงูุฐุงูุฑุฉ ุ ุงููุฑูู ุงูุฏูููุฉ ูู ุงูุฃุฏุงุก</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/466657/" style=";text-align:right;direction:rtl"><h2 style=";text-align:right;direction:rtl">  ููุฏูุฉ </h2><br><br>  ุงููุธุฑ ูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุงูุชุงููุฉ: <br><br><pre style=";text-align:right;direction:rtl"><code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">//Any native COM object var comType = Type.GetTypeFromCLSID(new Guid("E13B6688-3F39-11D0-96F6-00A0C9191601")); while (true) { dynamic com = Activator.CreateInstance(comType); //do some work Marshal.FinalReleaseComObject(com); }</span></span></code> </pre> <br><br>  ุชูููุน ุฃุณููุจ <i>Marshal.FinalReleaseComObject</i> ููุง ููู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FinalReleaseComObject</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Object o</span></span></span><span class="hljs-function">)</span></span></code> </pre> <br><br>  ูููู ุจุฅูุดุงุก ูุงุฆู COM ุจุณูุท ุ ููููู ุจุจุนุถ ุงูุฃุนูุงู ุ ูููุดุฑู ุนูู ุงูููุฑ.  ูุจุฏู ุฃู ูุง ูููู ุฃู ูุญุฏุซ ุงูุฎุทุฃุ  ูุนู ุ ุฅู ุฅูุดุงุก ูุงุฆู ุฏุงุฎู ุญููุฉ ูุง ููุงุฆูุฉ ููุณ ููุงุฑุณุฉ ุฌูุฏุฉ ุ ููู <i>GC</i> ุณูุถุทูุน ุจุฌููุน ุงูุฃุนูุงู ุงููุฐุฑุฉ.  ุงููุงูุน ูุฎุชูู ุจุนุถ ุงูุดูุก: <br><br><img src="https://habrastorage.org/webt/mt/xo/rx/mtxorxomorvksyskqgtn3b3z7_g.png"><br><br>  ูููู ุณุจุจ ุชุณุฑุจ ุงูุฐุงูุฑุฉ ุ ุชุญุชุงุฌ ุฅูู ููู ููููุฉ ุนูู <i>ุฏููุงููููุฉ</i> .  ููุฌุฏ ุจุงููุนู ุงูุนุฏูุฏ ูู ุงูููุงูุงุช ุญูู ูุฐุง ุงูููุถูุน ุญูู ุญุจุฑู ุ ุนูู ุณุจูู ุงููุซุงู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุฐุง ุงูููุงู</a> ุ ููููุง ูุง ุชุชูุงูู ุชูุงุตูู ุงูุชูููุฐ ุ ูุฐูู ุณูููู ุจุฅุฌุฑุงุก ุจุญุซูุง ุงูุฎุงุต. <br><br><a name="habracut"></a><br><br>  ุฃููุงู ุ ุณูู ูุฏุฑุณ ุจุงูุชูุตูู ุขููุฉ ุงูุนูู <i>ุงูุฏููุงููููุฉ</i> ุ ุซู ุณูููู ุจุชูููู ุงููุนุฑูุฉ ุงูููุชุณุจุฉ ุฅูู ุตูุฑุฉ ูุงุญุฏุฉ ููู ุงูููุงูุฉ ุณููุงูุด ุฃุณุจุงุจ ูุฐุง ุงูุชุณุฑุจ ูููููุฉ ุชุฌูุจู.  ูุจู ุงูุบูุต ูู ุงูููุฏ ุ ุฏุนููุง ููุถุญ ุงูุจูุงูุงุช ุงููุตุฏุฑ: ุฃู ูุฌููุนุฉ ูู ุงูุนูุงูู ุชุคุฏู ุฅูู ุงูุชุณุฑุจุ <br><br><h2 style=";text-align:right;direction:rtl">  ุงูุชุฌุงุฑุจ </h2><br><br>  ุฑุจูุง ูููู ุฅูุดุงุก ุงูุนุฏูุฏ ูู ูุงุฆูุงุช <i>COM ุงูุฃุตููุฉ</i> ููุฑุฉ ุณูุฆุฉ ุจุญุฏ ุฐุงุชูุ  ูููุญุต: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">//Any native COM object var comType = Type.GetTypeFromCLSID(new Guid("E13B6688-3F39-11D0-96F6-00A0C9191601")); while (true) { dynamic com = Activator.CreateInstance(comType); }</span></span></code> </pre> <br><br>  ูู ุดูุก ุฌูุฏ ูุฐู ุงููุฑุฉ: <br><br><img src="https://habrastorage.org/webt/l2/x4/01/l2x401f_4vsbrysnx1zctwoyfjk.png"><br><br>  ุฏุนูุง ูุฑุฌุน ุฅูู ุงูุฅุตุฏุงุฑ ุงูุฃุตูู ูู ุงูููุฏ ุ ูููู ูุบูุฑ ููุน ุงููุงุฆู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">//Any managed type include managed COM var type = typeof(int); while (true) { dynamic com = Activator.CreateInstance(type); //do some work Marshal.FinalReleaseComObject(com); }</span></span></code> </pre> <br><br>  ููุฑุฉ ุฃุฎุฑู ุ ูุง ููุงุฌุขุช: <br><br><img src="https://habrastorage.org/webt/09/lm/bv/09lmbvpiklt9lo43b1fv9wzhdhu.png"><br><br>  ููุฌุฑุจ ุงูุฎูุงุฑ ุงูุซุงูุซ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">//Simple COM object var comType = Type.GetTypeFromCLSID(new Guid("435356F9-F33F-403D-B475-1E4AB512FF95")); while (true) { dynamic com = Activator.CreateInstance(comType); //do some work Marshal.FinalReleaseComObject((object) com); }</span></span></code> </pre> <br><br>  ุญุณููุง ุ ุงูุขู ูุฌุจ ุฃู ูุญุตู ุนูู ููุณ ุงูุณููู!  ูุนูุ  ูุง :( <br><br><img src="https://habrastorage.org/webt/uu/2p/l1/uu2pl1_xtrmpc4kuuy3mwdh_7la.png"><br><br>  ุณุชููู ุตูุฑุฉ ููุงุซูุฉ ุฅุฐุง ููุช ุจุชุนุฑูู com <i>ููุงุฆู</i> ุฃู ุฅุฐุง ููุช ุชุนูู ูุน <i>Managed COM</i> .  ุชูุฎูุต ุงููุชุงุฆุฌ ุงูุชุฌุฑูุจูุฉ: <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุง ูุคุฏู ุฅูุดุงุก ูุงุฆูุงุช <i>COM ุฃุตููุฉ</i> ุจููุฑุฏู ุฅูู ุญุฏูุซ ุชุณุฑุจ - <i>GC</i> ุชุชููู ุจูุฌุงุญ ูุน ูุณุญ ุงูุฐุงูุฑุฉ </li><li style=";text-align:right;direction:rtl">  ุนูุฏ ุงูุนูู ูุน ุฃู ูุฆุฉ <i>ูุฏุงุฑุฉ</i> ุ ูุง ุชุญุฏุซ ุชุณุฑุจุงุช </li><li style=";text-align:right;direction:rtl">  ุนูุฏูุง ุชููู ุจุตูุงุบุฉ ูุงุฆู ุฅูู <i>ูุงุฆู</i> ุตุฑูุญ ุ ูู ุดูุก ุนูู ูุง ูุฑุงู ุฃูุถูุง </li></ol><br><br>  ุงูุชุทูุน ุฅูู ุงููุณุชูุจู ุ ุฅูู ุงูููุทุฉ ุงูุฃููู ุ ูููููุง ุฅุถุงูุฉ ุญูููุฉ ููุงุฏูุง ุฃู ุงูุนูู ูุน ูุงุฆูุงุช <i>ุฏููุงููููุฉ</i> (ุฃุณุงููุจ ุงูุงุชุตุงู ุฃู ุงูุนูู ูุน ุงูุฎุตุงุฆุต) ูู ุญุฏ ุฐุงุชู ูุง ูุคุฏู ุฃูุถูุง ุฅูู ุญุฏูุซ ุชุณุฑุจุงุช.  ุงูุงุณุชูุชุงุฌ ููุชุฑุญ ููุณู: ูุญุฏุซ ุชุณุฑุจ ููุฐุงูุฑุฉ ุนูุฏ ุชูุฑูุฑ ูุงุฆู <i>ุญููู</i> (ุจุฏูู ุชุญููู ููุน "ูุฏูู") ูุญุชูู ุนูู <i>COM ุฃุตูู</i> ุ ููุนููุฉ ุฃุณููุจ. <br><br><h2 style=";text-align:right;direction:rtl">  ูุญู ุจุญุงุฌุฉ ููุฐูุงุจ ุฃุนูู </h2><br><br>  ุญุงู ุงูููุช ููุชุฐูุฑ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุง</a> <i>ุชุฏูุฑ</i> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุญููู</a> ูุฐู <i>ุงูุฏููุงููููุฉ</i> : <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ูุฑุฌุน ุณุฑูุน</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><blockquote style=";text-align:right;direction:rtl">  ูููุฑ C # 4.0 ููุนูุง ุฌุฏูุฏูุง ูู <b>ุงูุฏููุงูููู</b> .  ูุชุฌูุจ ูุฐุง ุงูููุน ุงูุชุญูู ูู ุงูููุน ุงูุซุงุจุช ุจูุงุณุทุฉ ุงููุชุฑุฌู.  ูู ูุนุธู ุงูุญุงูุงุช ุ ูุนูู ูููุน <b>ูุงุฆู</b> .  ูู ููุช ุงูุชุญููู ุงูุจุฑูุฌู ุ ูู ุงูููุชุฑุถ ุฃู ุนูุตุฑูุง ุชู ุฅุนูุงูู <b>ุฏููุงูููููุง</b> ูุฏุนู ุฃู ุนูููุฉ.  ูุฐุง ูุนูู ุฃูู ูุณุช ุจุญุงุฌุฉ ุฅูู ุงูุชูููุฑ ูู ูุตุฏุฑ ุงูุนูุตุฑ - ูู COM API ุฃู ูุบุฉ ุฏููุงููููุฉ ูุซู IronPython ุฃู ุจุงุณุชุฎุฏุงู ุงูุงูุนูุงุณ ุฃู ูู ุฃู ููุงู ุขุฎุฑ.  ุนูุงูุฉ ุนูู ุฐูู ุ ุฅุฐุง ูุงูุช ุงูุดูุฑุฉ ุบูุฑ ุตุงูุญุฉ ุ ูุณูุชู ุทุฑุญ ุงูุฃุฎุทุงุก ูู ููุช ุงูุชุดุบูู. <br><br>  ุนูู ุณุจูู ุงููุซุงู ุ ุฅุฐุง ูุงู ุงูุฃุณููุจ <b>exampleMethod1</b> ูู ุงูุชุนูููุฉ ุงูุจุฑูุฌูุฉ ุงูุชุงููุฉ ูุญุชูู ุนูู ูุนููุฉ ูุงุญุฏุฉ ุชูุงููุง ุ <b>ูุณูู</b> ูุชุนุฑู ุงููุชุฑุฌู ุนูู ุฃู ุงูุงุณุชุฏุนุงุก ุงูุฃูู <b>ูุทุฑููุฉ ec.exampleMethod1 (10 ุ 4)</b> ุบูุฑ ุตุงูุญ ูุฃูู ูุญุชูู ุนูู ูุนููุชูู.  ุณูุคุฏู ูุฐุง ุฅูู ุฎุทุฃ ุชุฑุฌูุฉ.  ูู <b>ูุชู</b> ุงูุชุญูู ูู ุงุณุชุฏุนุงุก ุงูุทุฑููุฉ ุงูุซุงููุฉ ุ <b>dynamic_ec.exampleMethod1 (10 ุ 4)</b> ุจูุงุณุทุฉ ุงููุญูู ุงูุจุฑูุฌู ุ ุญูุซ <b>ูุชู</b> ุชุนุฑูู <b>dynamic_ec ุนูู</b> ุฃูู <b>ุฏููุงูููู</b> ุ ูุฐูู.  ูู ูููู ููุงู ุฃุฎุทุงุก ุชุฌููุน.  ููุน ุฐูู ุ ูู ููุฑ ุงูุฎุทุฃ ุฏูู ุฃู ููุงุญุธู ุฃุญุฏ ุฅูู ุงูุฃุจุฏ - ุณูุชู ุงูุชุดุงูู ูู ููุช ุงูุชุดุบูู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Main</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] args</span></span></span><span class="hljs-function">)</span></span> { ExampleClass ec = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ExampleClass(); <span class="hljs-comment"><span class="hljs-comment">//      ,  exampleMethod1    . //ec.exampleMethod1(10, 4); dynamic dynamic_ec = new ExampleClass(); //      ,  //      dynamic_ec.exampleMethod1(10, 4); //        ,  //  ,      dynamic_ec.someMethod("some argument", 7, null); dynamic_ec.nonexistentMethod(); }</span></span></code> </pre> <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">ExampleClass</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ExampleClass</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ExampleClass</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> v</span></span></span><span class="hljs-function">)</span></span> { } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">exampleMethod1</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> i</span></span></span><span class="hljs-function">)</span></span> { } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">exampleMethod2</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> str</span></span></span><span class="hljs-function">)</span></span> { } }</code> </pre> <br></blockquote><br></div></div><br><br>  ุชุฎุถุน ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุงูุชู ุชุณุชุฎุฏู ุงููุชุบูุฑุงุช <i>ุงูุญูููุฉ</i> ุชุบููุฑุงุช ูุจูุฑุฉ ุฃุซูุงุก ุงูุชุญููู ุงูุจุฑูุฌู.  ูุฐุง ุงูููุฏ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">dynamic</span></span> com = Activator.CreateInstance(comType); Marshal.FinalReleaseComObject(com);</code> </pre> <br><br>  ูุชุญูู ุฅูู ูุง ููู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">object</span></span> instance = Activator.CreateInstance(typeFromClsid); <span class="hljs-comment"><span class="hljs-comment">// ISSUE: reference to a compiler-generated field if (Foo.o__0.p__0 == null) { // ISSUE: reference to a compiler-generated field Foo.o__0.p__0 = CallSite&lt;Action&lt;CallSite, Type, object&gt;&gt;.Create(Binder.InvokeMember(CSharpBinderFlags.ResultDiscarded, "FinalReleaseComObject", (IEnumerable&lt;Type&gt;) null, typeof (Foo), (IEnumerable&lt;CSharpArgumentInfo&gt;) new CSharpArgumentInfo[2] { CSharpArgumentInfo.Create(CSharpArgumentInfoFlags.UseCompileTimeType | CSharpArgumentInfoFlags.IsStaticType, (string) null), CSharpArgumentInfo.Create(CSharpArgumentInfoFlags.None, (string) null) })); } // ISSUE: reference to a compiler-generated field // ISSUE: reference to a compiler-generated field Foo.o__0.p__0.Target((CallSite) Foo.o__0.p__0, typeof (Marshal), instance);</span></span></code> </pre> <br><br>  ุญูุซ <b>o__0</b> ูู ุงููุฆุฉ ุงูุซุงุจุชุฉ ุงููููุฏุฉ ุ ู <b>p__0</b> ูู ุงูุญูู ุงูุซุงุจุช ูููุง: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">o__0</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> CallSite&lt;Action&lt;CallSite, Type, <span class="hljs-keyword"><span class="hljs-keyword">object</span></span>&gt;&gt; p__0; }</code> </pre> <br><br>  <i>ููุงุญุธุฉ: ููู ุชูุงุนู ูุน <i>ุฏููุงูููู</i> ุ ูุชู ุฅูุดุงุก ุญูู CallSite.</i>  <i>ูุฐุง ุ ููุง ุณูุฑู ูุงุญููุง ุ ุถุฑูุฑู ูุชุญุณูู ุงูุฃุฏุงุก.</i> <br><br>  ูุงุญุธ ุฃูู ูู ูุชุจู ุฃู ุฐูุฑ <i>ููุฏููุงููููุฉ</i> - ูุชู ุชุฎุฒูู ูุงุฆููุง ุงูุขู ูู ูุชุบูุฑ <i>ูุงุฆู</i> type.  ุฏุนูุง ูุณูุฑ ุนุจุฑ ุงูููุฏ ุงูุฐู ุชู ุฅูุดุงุคู.  ุฃููุงู ุ ูุชู ุฅูุดุงุก ุงูุฑุจุท ุงูุฐู ูุตู ูุงุฐุง ููุงุฐุง ููุนูุ <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs">Binder.InvokeMember(CSharpBinderFlags.ResultDiscarded, <span class="hljs-string"><span class="hljs-string">"FinalReleaseComObject"</span></span>, (IEnumerable&lt;Type&gt;) <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span> (Foo), (IEnumerable&lt;CSharpArgumentInfo&gt;) <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CSharpArgumentInfo[<span class="hljs-number"><span class="hljs-number">2</span></span>] { CSharpArgumentInfo.Create(CSharpArgumentInfoFlags.UseCompileTimeType | CSharpArgumentInfoFlags.IsStaticType, (<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>) <span class="hljs-literal"><span class="hljs-literal">null</span></span>), CSharpArgumentInfo.Create(CSharpArgumentInfoFlags.None, (<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>) <span class="hljs-literal"><span class="hljs-literal">null</span></span>) })</code> </pre> <br><br>  ูุฐุง ูู ูุตู ูุนูููุฉ ุฏููุงููููุฉ ูุฏููุง.  ุงุณูุญูุง ูู ุฃู ุฃุฐูุฑู ุจุฃููุง ููุฑุฑ ูุชุบูุฑ <i>ุฏููุงูููู</i> ุฅูู ุทุฑููุฉ <i>FinalReleaseComObject</i> . <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  CSharpBinderFlags.ResultDiscarded - ูุง ูุชู ุงุณุชุฎุฏุงู ูุชูุฌุฉ ุชูููุฐ ุงูุทุฑููุฉ ูู ุงููุณุชูุจู </li><li style=";text-align:right;direction:rtl">  "FinalReleaseComObject" - ุงุณู ุงูุฃุณููุจ ูุณูู </li><li style=";text-align:right;direction:rtl">  typeof (Foo) - ุณูุงู ุงูุนูููุฉ ุ  ููุน ุงูููุงููุฉ </li></ul><br><br>  <b>CSharpArgumentInfo</b> - ูุตู ูุนููุงุช ุงูุฑุจุท.  ูู ุญุงูุชูุง: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  CSharpArgumentInfo.Create (CSharpArgumentInfoFlags.UseCompileTimeType | CSharpArgumentInfoFlags.IsStaticTypeุ (string) null) - ูุตู ุงููุนููุฉ ุงูุฃููู - ูุฆุฉ Marshal: ุฅูู ุซุงุจุช ููุฌุจ ุงุนุชุจุงุฑ ููุนู ุนูุฏ ุงูุฑุจุท </li><li style=";text-align:right;direction:rtl">  CSharpArgumentInfo.Create (CSharpArgumentInfoFlags.None ุ (ุณูุณูุฉ) ุฎุงููุฉ) - ูุตู ููุนููุฉ ุงูุทุฑููุฉ ุ ุนุงุฏุฉ ูุง ุชูุฌุฏ ูุนูููุงุช ุฅุถุงููุฉ. </li></ul><br><br>  ุฅุฐุง ูู ููู ุงูุฃูุฑ ูุชุนูู ุจุงุณุชุฏุนุงุก ุทุฑููุฉ ุ ูููู ุ ุนูู ุณุจูู ุงููุซุงู ุ ุงุณุชุฏุนุงุก ุฎุงุตูุฉ ูู ูุงุฆู <i>ุญููู</i> ุ ูุณูููู ููุงู <b>CSharpArgumentInfo</b> ูุงุญุฏ ููุท ูุตู ุงููุงุฆู <i>ุงูุฏููุงูููู</i> ููุณู. <br><br>  <b>CallSite</b> ูู ุงูุชูุงู ุนูู ุชุนุจูุฑ ุฏููุงูููู.  ูุญุชูู ุนูู ูุฌุงููู ููููู ุจุงููุณุจุฉ ููุง: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุชู ุงูุนุงู ุงูุชุญุฏูุซ </li><li style=";text-align:right;direction:rtl">  ุงููุฏู ุงูุนุงู </li></ul><br><br>  ูู ุงูุดูุฑุฉ ุงูุชู ุชู ุฅูุดุงุคูุง ุ ูุชุถุญ ุฃูู ุนูุฏ ุฅุฌุฑุงุก ุฃู ุนูููุฉ ุ ูุชู <b>ุงุณุชูุฏุงู ุงููุฏู</b> ุจุงุณุชุฎุฏุงู ูุนููุงุช ุชุตูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs">Foo.o__0.p__0.Target((CallSite) Foo.o__0.p__0, <span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span> (Marshal), instance);</code> </pre> <br><br>  ุจุงูุงูุชุฑุงู ูุน <b>CSharpArgumentInfo</b> ุงูููุถุญ ุฃุนูุงู <b>ุ</b> ูุนูู ูุฐุง ุงูุฑูุฒ ูุง ููู: ุชุญุชุงุฌ ุฅูู ุงุณุชุฏุนุงุก ุงูุฃุณููุจ FinalReleaseComObject ูู ูุฆุฉ Marshal ุงูุซุงุจุชุฉ ูุน ูุนููุฉ ุงููุซูู.  ูู ููุช ุงูููุงููุฉ ุงูุฃููู ุ ูุชู ุชุฎุฒูู ููุณ ุงููููุถ ูู <b>ุงููุฏู</b> ููุง ูู ุงูุญุงู ูู <b>ุงูุชุญุฏูุซ</b> .  ูููุถ <b>ุงูุชุญุฏูุซ</b> ูุณุคูู ุนู ูููุชูู ูููุชูู: <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุฑุจุท ุงูุนูููุฉ ุงูุฏููุงููููุฉ ุจุนูููุฉ ุซุงุจุชุฉ (ุขููุฉ ุงููุชุนูุฏุฉ ููุณูุง ุฎุงุฑุฌ ูุทุงู ูุฐู ุงูููุงูุฉ) </li><li style=";text-align:right;direction:rtl">  ุชุดููู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช </li></ol><br><br>  ูุญู ููุชููู ุจุงูููุทุฉ ุงูุซุงููุฉ.  ุชุฌุฏุฑ ุงูุฅุดุงุฑุฉ ููุง ุฅูู ุฃูู ุนูุฏ ุงูุนูู ูุน ูุงุฆู ุฏููุงูููู ุ ูุญุชุงุฌ ุฅูู ุงูุชุญูู ูู ุตุญุฉ ุงูุนูููุฉ ูู ูู ูุฑุฉ.  ูุฐู ูููุฉ ูุซููุฉ ุงูุงุณุชุฎุฏุงู ููููุงุฑุฏ ุ ูุฐูู ุฃุฑูุฏ ุชุฎุฒูู ูุชุงุฆุฌ ุนูููุงุช ุงููุญุต ูุฐู ูุคูุชูุง.  ูููุง ูุชุนูู ุจุงุณุชุฏุนุงุก ุทุฑููุฉ ุฐุงุช ูุนููุฉ ุ ูุญุชุงุฌ ุฅูู ุชุฐูุฑ ูุง ููู: <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุงูููุน ุงูุฐู ุชุณูู ุงูุทุฑููุฉ </li><li style=";text-align:right;direction:rtl">  ููุน ุงููุงุฆู ุงูุฐู ุชู ุชูุฑูุฑู ุจูุงุณุทุฉ ุงููุนููุฉ (ููุชุฃูุฏ ูู ุฃูู ูููู ูููู ุฅูู ููุน ุงููุนููุฉ) </li><li style=";text-align:right;direction:rtl">  ูู ุงูุนูููุฉ ุตุงูุญุฉ </li></ol><br><br>  ุจุนุฏ ุฐูู ุ ุนูุฏ ุงุณุชุฏุนุงุก <b>ุงููุฏู</b> ูุฑุฉ ุฃุฎุฑู ุ ูุง ูุญุชุงุฌ ุฅูู ุชูููุฐ ุฑูุงุจุท ููููุฉ ูุณุจููุง: ููุท ูุงุฑู ุจูู ุงูุฃููุงุน ุ ูุฅุฐุง ูุงูุช ูุชุทุงุจูุฉ ุ ูุงุชุตู ุจุงููุธููุฉ ุงููุฏู.  ูุญู ูุฐู ุงููุดููุฉ ุ ูุชู ุฅูุดุงุก <i>ExpressionTree</i> ููู ุนูููุฉ ุฏููุงููููุฉ ุ ูุงูุชู ุชุฎุฒู <i>ุงููููุฏ</i> <i>ูุงูุฏุงูุฉ ุงูููุถูุนูุฉ</i> ุงูุชู ูุฑุชุจุท ุจูุง ุงูุชุนุจูุฑ ุงูุฏููุงูููู. <br><br>  ูุฐู ุงููุธููุฉ ูููู ุฃู ุชููู ูู ููุนูู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <i>ุฎุทุฃ ููุฒู</i> : ุนูู ุณุจูู ุงููุซุงู ุ ูุชู ุงุณุชุฏุนุงุก ุฃุณููุจ ุนูู ูุงุฆู <i>ุฏููุงูููู</i> ุบูุฑ ููุฌูุฏ ุฃู ูุง ูููู ุชุญููู ูุงุฆู <i>ุฏููุงูููู</i> ุฅูู ููุน ุงููุนููุฉ ุงูุชู ูุชู ุชูุฑูุฑูุง ุฅูููุง: ุซู ุชุญุชุงุฌ ุฅูู ุฑูู ุงุณุชุซูุงุก ูุซู <i>Microsoft.CSharp.RuntimeBinderException: 'NoSuchMember'</i> </li><li style=";text-align:right;direction:rtl">  ุงูุชุญุฏู ูุงูููู: ุซู ูู ููุท ุจุชูููุฐ ุงูุฅุฌุฑุงุก ุงููุทููุจ </li></ul><br><br>  ูุชู ุชูููู <i>ExpressionTree</i> ูุฐุง ุนูุฏ ุชูููุฐ ูููุถ <b>ุงูุชุญุฏูุซ</b> ูุชุฎุฒููู ูู <b>ุงููุฏู</b> .  <b>ุงููุฏู</b> - ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช <i>L0</i> ุ ุณูุชุญุฏุซ ุฃูุซุฑ ุนู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ูุงุญููุง. <br><br>  ูุฐูู ุ ูุฎุฒู <b>Target</b> ุขุฎุฑ <i>ExpressionTree ุงูุฐู ุชู</i> ุฅูุดุงุคู ูู ุฎูุงู ูููุถ <b>ุงูุชุญุฏูุซ</b> .  ููุฑู ููู ุชุจุฏู ูุฐู <i>ุงููุงุนุฏุฉ</i> ููุซุงู ููููุน <i>ุงูููุฏุงุฑ ุงูุฐู</i> ุชู ุชูุฑูุฑู ุฅูู ุทุฑููุฉ <i>Boo</i> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Foo</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Test</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> type = <span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">dynamic</span></span> instance = Activator.CreateInstance(type); Boo(instance); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Boo</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> o</span></span></span><span class="hljs-function">)</span></span> { } }</code> </pre> <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs">.Lambda CallSite.Target&lt;System.Action`<span class="hljs-number"><span class="hljs-number">3</span></span>[Actionsss.CallSite,ConsoleApp12.Foo,System.Object]&gt;( Actionsss.CallSite $$site, ConsoleApp12.Foo $$arg0, System.Object $$arg1) { .Block() { .If ($$arg0 .TypeEqual ConsoleApp12.Foo &amp;&amp; $$arg1 .TypeEqual System.Int32) { .Return <span class="hljs-meta"><span class="hljs-meta">#Label1 { .Block() { .Call $$arg0.Boo((System.Object)((System.Int32)$$arg1)); .Default(System.Object) } } } .Else { .Default(System.Void) }; .Block() { .Constant&lt;Actionsss.Ast.Expression&gt;(IIF((($arg0 TypeEqual Foo) AndAlso ($arg1 TypeEqual Int32)), returnUnamedLabel_0 ({ ... }) , default(Void))); .Label .LabelTarget CallSiteBinder.UpdateLabel: }; .Label .If ( .Call Actionsss.CallSiteOps.SetNotMatched($$site) ) { .Default(System.Void) } .Else { .Invoke (((Actionsss.CallSite`1[System.Action`3[Actionsss.CallSite,ConsoleApp12.Foo,System.Object]])$$site).Update)( $$site, $$arg0, $$arg1) } .LabelTarget #Label1: } }</span></span></code> </pre> <br><br>  ุฃูู ูุชูุฉ ุจุงููุณุจุฉ ููุง: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs">.If ($$arg0 .TypeEqual ConsoleApp12.Foo &amp;&amp; $$arg1 .TypeEqual System.Int32)</code> </pre> <br><br>  <i>ุงููุนููุชุงู ุงููุชุงู ูุทูู ุนููููุง ุงููุฏู "arg arg0"</i> ู <i>$ arg1</i> : <br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs">Foo.o__0.p__0.Target((CallSite) Foo.o__0.p__0, &lt;b&gt;<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>&lt;/b&gt;, &lt;b&gt;instance&lt;/b&gt;);</code> </pre> <br><br>  ุชุฑุฌูุช ุฅูู ุฅูุณุงู ุ ููุฐุง ูุนูู ูุง ููู: <br><br>  ููุฏ ุชุญูููุง ุจุงููุนู ูู ุฃูู ุฅุฐุง ูุงูุช ุงููุนููุฉ ุงูุฃููู ูู ุงูููุน <i>Foo</i> ูุงูุซุงููุฉ ูู <i>Int32</i> ุ ูููููู ุงูุงุชุตุงู ุจุฃูุงู <i>Boo ((object) $$ arg1)</i> . <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs">.Return <span class="hljs-meta"><span class="hljs-meta">#Label1 { .Block() { .Call $$arg0.Boo((System.Object)((System.Int32)$$arg1)); .Default(System.Object) }</span></span></code> </pre> <br><br>  <i>ููุงุญุธุฉ: ูู ุญุงูุฉ ูุฌูุฏ ุฎุทุฃ ููุฒู ุ ุชุจุฏู ูุชูุฉ Label1 ุนูู ุงููุญู ุงูุชุงูู:</i> <br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs">.Return <span class="hljs-meta"><span class="hljs-meta">#Label1 { .Throw .New Microsoft.CSharp.RuntimeBinderException("NoSuchMember")</span></span></code> </pre> <br><br>  ูุชุณูู ูุฐู ุงูุดููุงุช <b>ุงููููุฏ</b> .  <b>ููุงู</b> ููุนุงู ูู <b>ุงููููุฏ</b> : ุญุณุจ ููุน ุงููุงุฆู ูุญุงูุฉ ุงููุงุฆู ุงููุญุฏุฏุฉ (ูุฌุจ ุฃู ูููู ุงููุงุฆู ูู ููุณู ุชูุงููุง).  ุฅุฐุง ูุดู ุฃุญุฏ ุงููููุฏ ุนูู ุงูุฃูู ุ ูุณูุชุนูู ุนูููุง ุฅุนุงุฏุฉ ุงูุชุญูู ูู ุงูุชุนุจูุฑ ุงูุฏููุงูููู ููุชุฃูุฏ ูู ุตุญุชู ุ ูุฐูู ุณูุชุตู ุจููุฏูุจ <b>Update</b> .  ููููุง ูููุฎุทุท ุงููุนุฑูู ูุฏููุง ุจุงููุนู ุ ุณูู ูููู ุจุงูุฑุจุท ูุน ุงูุฃููุงุน ุงูุฌุฏูุฏุฉ <i>ููุญูุธ ExpressionTree</i> ุงูุฌุฏูุฏ ูู <b>ุงููุฏู</b> . <br><br><h2 style=";text-align:right;direction:rtl">  ูุฎุจุฃ </h2><br><br>  ููุฏ ุงูุชุดููุง ุจุงููุนู ุฃู <b>ุงููุฏู</b> ูู <b>ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช L0</b> .  ูู ูู ูุฑุฉ ูุชู ูููุง ุงุณุชุฏุนุงุก <b>ุงููุฏู</b> ุ ุฃูู ุดูุก ุณููุนูู ูู ุชุฌุงูุฒ ุงููููุฏ ุงููุฎุฒูุฉ ุจุงููุนู ููู.  ุฅุฐุง ูุดูุช ุงููููุฏ ูุชู ุฅูุดุงุก ุฑุงุจุท ุฌุฏูุฏ ุ ูุณุชูุชูู ุงููุงุนุฏุฉ ุงููุฏููุฉ ูู ููุณ ุงูููุช ุฅูู <b>L1</b> ู <b>L2</b> .  ูู ุงููุณุชูุจู ุ ุนูุฏูุง ุชูุชูุฏ ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช <i>L0</i> ุ ุณูุชู ุงูุจุญุซ ุนู ุงูููุงุนุฏ ูู <i>L1</i> ู <i>L2</i> ุญุชู ูุชู ุงูุนุซูุฑ ุนูู ูุงุญุฏุฉ ููุงุณุจุฉ. <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <i>L1</i> : ุงูููุงุนุฏ ุงูุนุดุฑ ุงูุฃุฎูุฑุฉ ุงูุชู ุชุฑูุช <i>L0</i> (ุงููุฎุฒูุฉ ูุจุงุดุฑุฉ ูู <i>CallSite</i> ) </li><li style=";text-align:right;direction:rtl">  <i>L2</i> : ุขุฎุฑ 128 ููุงุนุฏ ุชู ุฅูุดุงุคูุง ุจุงุณุชุฎุฏุงู ูุซูู binder ูุนูู (ููู <i>CallSiteBinder</i> ุ ูุฑูุฏ ููู <i>CallSite</i> ) </li></ul><br><br>  ุงูุขู ูููููุง ุฃุฎูุฑูุง ุฅุถุงูุฉ ูุฐู ุงูุชูุงุตูู ุฅูู <i>ููู</i> ูุงุญุฏ ููุตู ูู ุดูู ุฎูุงุฑุฒููุฉ ูุง ูุญุฏุซ ุนูุฏูุง <i>ูุชู ุงุณุชุฏุนุงุก Foo.Bar (someDynamicObject)</i> : <br><br>  1. ูุชู ุฅูุดุงุก ุงูููุซู ุงูุฐู ูุชุฐูุฑ ุงูุณูุงู ูุงูุฃุณููุจ ุงููุณูู ุนูู ูุณุชูู ุชูููุนุงุชูู <br><br>  2. ูู ุงููุฑุฉ ุงูุฃููู ุงูุชู ุชุณูู ุงูุนูููุฉ ุ ูุชู ุฅูุดุงุก <i>ExpressionTree</i> ุ ูุงูุฐู ูููู ุจุชุฎุฒูู: <br>  2.1 <b>ุงููููุฏ</b> .  ูู ูุฐู ุงูุญุงูุฉ ุ ุณูููู ูุฐุง ููุฏุงู ุนูู ููุน ูุนููุงุช ุงูุฑุจุท ุงูุญุงููุฉ <br>  2.2 <b>ุงููุธููุฉ ุงูููุถูุนูุฉ</b> : ุฅูุง <i>ุงุณุชุจุนุงุฏ ุจุนุถ ุงูุงุณุชุซูุงุกุงุช</i> (ูู ูุฐู ุงูุญุงูุฉ ูููู ูู ุงููุณุชุญูู ุ ูุฃู ุฃู <i>ุฏููุงููููุฉ</i> ุณุชุคุฏู ุฅูู ุงูุงุนุชุฑุงุถ ุจูุฌุงุญ) ุฃู ุงุณุชุฏุนุงุก ุงูุฃุณููุจ <i>Bar</i> <br><br>  3. ูู ุจุชุฌููุน ูุชูููุฐ ExpressionTree ุงููุงุชุฌ <br><br>  4. ุนูุฏูุง ุชุชุฐูุฑ ุงูุนูููุฉ ุ ููุงู ุฎูุงุฑุงู ููููุงู: <br>  <b>ุนููุช</b> 4.1 <b>ุงููููุฏ</b> : ููุท ุงุชุตู <i>ุจุงุฑ</i> <br>  4.2 <b>ูู ุชูุฌุญ ุงููููุฏ</b> : ูุฑุฑ ุงูุฎุทูุฉ 2 ููุนููุงุช ุงูุฑุจุท ุงูุฌุฏูุฏุฉ <br><br>  ูุฐูู ุ ูุน ูุซุงู ุงูููุน <i>ุงูููุฏุงุฑ</i> ุ ุฃุตุจุญ ูู ุงููุงุถุญ ุชูุฑูุจูุง ููู ุชุนูู <i>ุงูุฏููุงููููุฉ</i> ูู ุงูุฏุงุฎู.  ูู ุงูุญุงูุฉ ุงูููุถุญุฉ ุ ูู <i>ูููุฏ</i> ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ุฃุจุฏูุง ุ ูุธุฑูุง ูุฃู ุงูุฃููุงุน <i>ูุชูุงุซูุฉ</i> ุฏุงุฆููุง * ุ ูุฐูู <b>ุณูุชู</b> ุงุณุชุฏุนุงุก <b>ุงูุชุญุฏูุซ</b> ูุฑุฉ ูุงุญุฏุฉ ููุท ุนูุฏ ุชููุฆุฉ <i>CallSite</i> .  ุซู ุ ููู ููุงููุฉ ุ ุณูุชู ูุญุต ุงููููุฏ ููุท ูุณูุชู ุงุณุชุฏุนุงุก ุงููุธููุฉ ุงููุฏู ุนูู ุงูููุฑ.  ูุฐุง ูู ูู ุงุชูุงู ููุชุงุฒ ูุน ููุงุญุธุงุชูุง ูู ุงูุฐุงูุฑุฉ: ูุง ููุฌุฏ ุญุณุงุจ - ูุง ุชุณุฑุจ. <br><br>  <i>* ููุฐุง ุงูุณุจุจ ุ ูููู ุงููุชุฑุฌู ุจุฅูุดุงุก CallSites ููู ูููุง: ูุชู ุชูููู ุงุญุชูุงู ููุฏุงู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช L0 ุจุดูู ูุจูุฑ</i> <br><br>  ุญุงู ุงูููุช ูุงูุชุดุงู ููู ูุฎุชูู ูุฐุง ุงููุฎุทุท ูู ุญุงูุฉ ูุงุฆูุงุช <i>COM ุงูุฃุตููุฉ</i> .  ุฏุนูุง ูููู ูุธุฑุฉ ุนูู <i>ExpressionTree</i> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs">.Lambda CallSite.Target&lt;System.Action`<span class="hljs-number"><span class="hljs-number">3</span></span>[Actionsss.CallSite,ConsoleApp12.Foo,System.Object]&gt;( Actionsss.CallSite $$site, ConsoleApp12.Foo $$arg0, System.Object $$arg1) { .Block() { .If ($$arg0 .TypeEqual ConsoleApp12.Foo &amp;&amp; .Block(System.Object $var1) { $var1 = .Constant&lt;System.WeakReference&gt;(System.WeakReference).Target; $var1 != <span class="hljs-literal"><span class="hljs-literal">null</span></span> &amp;&amp; (System.Object)$$arg1 == $var1 }) { .Return <span class="hljs-meta"><span class="hljs-meta">#Label1 { .Block() { .Call $$arg0.Boo((System.__ComObject)$$arg1); .Default(System.Object) } } } .Else { .Default(System.Void) }; .Block() { .Constant&lt;Actionsss.Ast.Expression&gt;(IIF((($arg0 TypeEqual Foo) AndAlso {var Param_0; ... }), returnUnamedLabel_1 ({ ... }) , default(Void))); .Label .LabelTarget CallSiteBinder.UpdateLabel: }; .Label .If ( .Call Actionsss.CallSiteOps.SetNotMatched($$site) ) { .Default(System.Void) } .Else { .Invoke (((Actionsss.CallSite`1[System.Action`3[Actionsss.CallSite,ConsoleApp12.Foo,System.Object]])$$site).Update)( $$site, $$arg0, $$arg1) } .LabelTarget #Label1: } }</span></span></code> </pre> <br><br>  ูููู ููุงุญุธุฉ ุฃู ุงูุงุฎุชูุงู ููุฌูุฏ ููุท ูู ุงูุชูููุฏ ุงูุซุงูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs">.If ($$arg0 .TypeEqual ConsoleApp12.Foo &amp;&amp; .Block(System.Object $var1) { $var1 = .Constant&lt;System.WeakReference&gt;(System.WeakReference).Target; $var1 != <span class="hljs-literal"><span class="hljs-literal">null</span></span> &amp;&amp; (System.Object)$$arg1 == $var1 })</code> </pre> <br><br>  ุฅุฐุง ูุงู ูุฏููุง ูู ุญุงูุฉ ุงูููุฏ <i>ุงููุฏุงุฑ</i> <i>ูููุฏุงู</i> ุนูู ููุน ุงููุงุฆูุงุช ุ ุซู ูุฑู ููุง ุฃู ุงูููุฏ ุงูุซุงูู ูุชุญูู ูู ูุนุงุฏูุฉ ุงููุซููุงุช ูู ุฎูุงู <i>WeakReference</i> . <br><br>  <i>ููุงุญุธุฉ: ูุชู ุฃูุถูุง ุงุณุชุฎุฏุงู ุชูููุฏ ุงููุซูู ุจุงูุฅุถุงูุฉ ุฅูู ูุงุฆูุงุช COM ูู TransparentProxy</i> <br><br>  ูู ุงูููุงุฑุณุฉ ุงูุนูููุฉ ุ ุจูุงุกู ุนูู ูุนุฑูุชูุง ุจุงูุชุฎุฒูู ุงููุคูุช ุ ููุฐุง ูุนูู ุฃูู ูู ูู ูุฑุฉ ูููู ุจุฅุนุงุฏุฉ ุฅูุดุงุก ูุงุฆู <i>COM</i> ูู ุญููุฉ ุ ุณููุชูุฏ ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช <i>L0</i> (ู <i>L1 / L2</i> ุฃูุถูุง ุ ูุฃูู ุณูุชู ุชุฎุฒูู ุงูููุงุนุฏ ุงููุฏููุฉ ูุน ุงูุฑูุงุจุท ููุงู ุฅูู ุงูุญุงูุงุช ุงููุฏููุฉ).  ุงูุงูุชุฑุงุถ ุงูุฃูู ุงูุฐู ูุณุฃูู ูู ุงูุฑุฃุณ ูู ุฃู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ููููุงุนุฏ ุชุชุฏูู.  ููู ุงูุฑูุฒ ููุงู ุจุณูุท ููุบุงูุฉ ููู ุดูุก ุนูู ูุง ูุฑุงู ููุงู: ูุชู ุญุฐู ุงูููุงุนุฏ ุงููุฏููุฉ ุจุดูู ุตุญูุญ.  ูู ุงูููุช ููุณู ุ ูุง ูุคุฏู ุงุณุชุฎุฏุงู <i>WeakReference</i> ูู <i>ExpressionTree ุฅูู</i> ููุน <i>GC</i> ูู ุชุฌููุน ูุงุฆูุงุช ุบูุฑ ุถุฑูุฑูุฉ. <br><br>  <i>ุขููุฉ ุญูุธ ุงูููุงุนุฏ ูู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช L1:</i> <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> MaxRules = <span class="hljs-number"><span class="hljs-number">10</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">internal</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AddRule</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">T newRule</span></span></span><span class="hljs-function">)</span></span> { T[] rules = Rules; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (rules == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { Rules = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span>[] { newRule }; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } T[] temp; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (rules.Length &lt; (MaxRules - <span class="hljs-number"><span class="hljs-number">1</span></span>)) { temp = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> T[rules.Length + <span class="hljs-number"><span class="hljs-number">1</span></span>]; Array.Copy(rules, <span class="hljs-number"><span class="hljs-number">0</span></span>, temp, <span class="hljs-number"><span class="hljs-number">1</span></span>, rules.Length); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { temp = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> T[MaxRules]; Array.Copy(rules, <span class="hljs-number"><span class="hljs-number">0</span></span>, temp, <span class="hljs-number"><span class="hljs-number">1</span></span>, MaxRules - <span class="hljs-number"><span class="hljs-number">1</span></span>); } temp[<span class="hljs-number"><span class="hljs-number">0</span></span>] = newRule; Rules = temp; }</code> </pre> <br><br>  ุฅุฐู ูุง ูู ุงูุตููุฉุ  ุฏุนูุง ูุญุงูู ุชูุถูุญ ุงููุฑุถูุฉ: ูุญุฏุซ ุชุณุฑุจ ููุฐุงูุฑุฉ ูู ููุงู ูุง ุนูุฏ ุฑุจุท ูุงุฆู <i>COM</i> . <br><br><h2 style=";text-align:right;direction:rtl">  ุงูุชุฌุงุฑุจ ุ ุงูุฌุฒุก 2 </h2><br><br>  ูุฑุฉ ุฃุฎุฑู ุ ุฏุนูุง ููุชูู ูู ุงุณุชูุชุงุฌุงุช ุงููุถุงุฑุจุฉ ุฅูู ุงูุชุฌุงุฑุจ.  ุฃููุงู ุ ุฏุนูุง ููุฑุฑ ูุง ููุนูู ุงููุชุฑุฌู ุจุงููุณุจุฉ ููุง: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">//Simple COM object var comType = Type.GetTypeFromCLSID(new Guid("435356F9-F33F-403D-B475-1E4AB512FF95")); var autogeneratedBinder = Binder.InvokeMember(CSharpBinderFlags.ResultDiscarded, "Boo", null, typeof(Foo), new CSharpArgumentInfo[2] { CSharpArgumentInfo.Create( CSharpArgumentInfoFlags.UseCompileTimeType, null), CSharpArgumentInfo.Create(CSharpArgumentInfoFlags.None, null) }); var callSite = CallSite&lt;Action&lt;CallSite, Foo, object&gt;&gt;.Create(autogeneratedBinder); while (true) { object instance = Activator.CreateInstance(comType); callSite.Target(callSite, this, instance); }</span></span></code> </pre> <br><br>  ูุชุญูู ูู: <br><br><img src="https://habrastorage.org/webt/bf/-u/k6/bf-uk6jtzrfh8_pyzaagi0p8cr4.png"><br><br>  ุชู ุงูุญูุงุธ ุนูู ุงูุชุณุฑุจ.  ุงููุนุฑุถ.  ููู ูุง ุงูุณุจุจุ  ุจุนุฏ ุฏุฑุงุณุฉ ุฑูุฒ ุงููุฌูุฏุงุช (ุงูุฐู ูุชุฑูู ูุฑุงุก ุงูุฃููุงุณ) ุ ูู ุงููุงุถุญ ุฃู ุงูุดูุก ุงููุญูุฏ ุงูุฐู ูุคุซุฑ ุนูู ููุน ูุงุฆููุง ูู ุฎูุงุฑ ุงูุชูููุฏ.  ุฑุจูุง ูุฐู ููุณุช ูุณุฃูุฉ ูุงุฆูุงุช <i>COM</i> ุ ูููู ุงูููุซูุ  ููุณ ููุงู ุงููุซูุฑ ูู ุงูุฎูุงุฑุงุช ุ ูููุณุชุญุซ ุงูุฑุจุท ุงููุชุนุฏุฏ ููููุน <i>ุงูููุฏุงุฑ</i> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (<span class="hljs-literal"><span class="hljs-literal">true</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">object</span></span> instance = Activator.CreateInstance(<span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> autogeneratedBinder = Binder.InvokeMember(CSharpBinderFlags.ResultDiscarded, <span class="hljs-string"><span class="hljs-string">"Boo"</span></span>, <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(Foo), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CSharpArgumentInfo[<span class="hljs-number"><span class="hljs-number">2</span></span>] { CSharpArgumentInfo.Create( CSharpArgumentInfoFlags.UseCompileTimeType, <span class="hljs-literal"><span class="hljs-literal">null</span></span>), CSharpArgumentInfo.Create(CSharpArgumentInfoFlags.None, <span class="hljs-literal"><span class="hljs-literal">null</span></span>) }); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> callSite = CallSite&lt;Action&lt;CallSite, Foo, <span class="hljs-keyword"><span class="hljs-keyword">object</span></span>&gt;&gt;.Create(autogeneratedBinder); callSite.Target(callSite, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, instance); }</code> </pre> <br><br><img src="https://habrastorage.org/webt/-y/an/hj/-yanhjj9jkmqr8bl2adf9rvjsvs.png"><br><br>  ูุฌุงุญ ุจุงูุฑ!  ูุจุฏู ุฃููุง ููุนูุงู.  ุงููุดููุฉ ููุณุช ุนูู ุงูุฅุทูุงู ูู <i>ูุงุฆู COM</i> ุ ููุง ุจุฏุง ููุง ูู ุงูุจุฏุงูุฉ ุ ููุท ุจุณุจุจ ุงููููุฏ ุงูููุฑูุถุฉ ุนูู ุงููุซูู ุ ูุฐู ูู ุงูุญุงูุฉ ุงููุญูุฏุฉ ุงูุชู ูุญุฏุซ ูููุง ุงูุฑุจุท ุนุฏุฉ ูุฑุงุช ุฏุงุฎู ุญููุฉ ูุฏููุง.  ูู ุฌููุน ุงูุญุงูุงุช ุงูุฃุฎุฑู ุ ููุถุช <i>ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช L0 ูุฃูุฒู</i> ูุฑุฉ ูุงุญุฏุฉ. <br><br><h2 style=";text-align:right;direction:rtl">  ุงููุชุงุฆุฌ </h2><br><br><h3 style=";text-align:right;direction:rtl">  ุชุณุฑุจ ุงูุฐุงูุฑุฉ </h3><br><br>  ุฅุฐุง ููุช ุชุนูู ูุน ูุชุบูุฑุงุช <i>ุฏููุงููููุฉ</i> ุชุญุชูู ุนูู <i>COM ุงูุฃุตูู</i> ุฃู <i>TransparentProxy</i> ุ ููุง ุชูุฑุฑูุง ุฃุจุฏุงู ููุนููุงุช ุฃุณููุจ.  ุฅุฐุง ููุช ูุง ุชุฒุงู ุจุญุงุฌุฉ ุฅูู ุงูููุงู ุจุฐูู ุ ุงุณุชุฎุฏู ุงููุฏุฎู ุงูุตุฑูุญ <i>ููุงุนุชุฑุงุถ</i> ุ ุซู ุณูุชุฎูู ุงููุชุฑุฌู ุนูู <br><br>  <b>ุฎุทุฃ</b> : <br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">dynamic</span></span> com = Activator.CreateInstance(comType); <span class="hljs-comment"><span class="hljs-comment">//do some work Marshal.FinalReleaseComObject(com);</span></span></code> </pre> <br><br>  <b>ุตุญูุญ</b> : <br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">dynamic</span></span> com = Activator.CreateInstance(comType); <span class="hljs-comment"><span class="hljs-comment">//do some work Marshal.FinalReleaseComObject((object) com);</span></span></code> </pre><br><br>  ูุฅุฌุฑุงุก ุงุญุชุฑุงุฒู ุฅุถุงูู ุ ุญุงูู ุฅูุดุงุก ูุซู ูุฐู ุงููุงุฆูุงุช ูู ุญุงูุงุช ูุงุฏุฑุฉ ูุฏุฑ ุงูุฅููุงู.  ุงููุนูู ูุฌููุน ุฅุตุฏุงุฑุงุช <i>.NET Framework</i> .  (ูู ุงูููุช ุงูุญุงูู) ููุณ ููุงุณุจูุง ุฌุฏูุง ูู.  <i>NET ุงูุฃุณุงุณูุฉ</i> ุ ูุฃูู ูุง <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุฌุฏ ุฏุนู</a> ููุงุฆูุงุช <i>COM ุงูุญูููุฉ</i> . <br><br><h3 style=";text-align:right;direction:rtl">  ุฅูุชุงุฌูุฉ </h3><br><br>  ูู ูุตูุญุชู ุญุฏูุซ ุญุงูุงุช ูุฏุฑุฉ ูู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ูู ุญุงูุงุช ูุงุฏุฑุฉ ูุฏุฑ ุงูุฅููุงู ุ ูุฃูู ูู ูุฐู ุงูุญุงูุฉ ูุง ุชูุฌุฏ ุญุงุฌุฉ ููุนุซูุฑ ุนูู ูุงุนุฏุฉ ููุงุณุจุฉ ูู ุฐุงูุฑุงุช ุงูุชุฎุฒูู ุงููุคูุช ุนุงููุฉ ุงููุณุชูู.  ุณูุญุฏุซ <i>ุงูููููุฏ ูู</i> ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช <i>L0</i> ุจุดูู ุฃุณุงุณู ูู ุญุงูุฉ ุนุฏู ุชุทุงุจู ููุน ุงููุงุฆู <i>ุงูุญููู</i> ูุน ุงูุงุญุชูุงุธ ุจุงููููุฏ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">dynamic</span></span> com = GetSomeObject(); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">object</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetSomeObject</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-comment"><span class="hljs-comment">//:      //:         }</span></span></code> </pre> <br><br>  ููุน ุฐูู ุ ูู ุงููุงุญูุฉ ุงูุนูููุฉ ุ ูู ุงููุญุชูู ุฃูุง ุชูุงุญุธ ุงูุงุฎุชูุงู ูู ุงูุฃุฏุงุก ูุง ูู ูุชู ููุงุณ ุนุฏุฏ ุงูููุงููุงุช ุฅูู ูุฐู ุงููุธููุฉ ุจุงูููุงููู ุฃู ุฅุฐุง ูุงู ุชุจุงูู ุงูุฃููุงุน ูุจูุฑูุง ุจุดูู ุบูุฑ ุนุงุฏู.  ุงูุชูุงููู ูู ุญุงูุฉ ุชูููุช ุนูู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช <i>L0</i> ูู ูุซู ุ <i>N</i> ูู ุนุฏุฏ ุงูุฃููุงุน: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุฃูู ูู 10  ุฅุฐุง ูุงุชุชู ุ ูู ุจุงูุชูุฑุงุฑ ููุท ุนูู ููุงุนุฏ ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช <i>L1</i> ุงูููุฌูุฏุฉ </li><li style=";text-align:right;direction:rtl">  10 &lt; <i>N &lt;128</i> .  ุชุนุฏุงุฏ <i>L1</i> ู <i>L2</i> ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช (ุจุญุฏ ุฃูุตู 10 ู <i>N</i> ุชูุฑุงุฑ).  ุฅูุดุงุก ูููุก ูุฌููุนุฉ ูู 10 ุนูุงุตุฑ </li><li style=";text-align:right;direction:rtl">  <i>N</i> &gt; 128.  ุชูุฑุงุฑ ุนุจุฑ ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช <i>L1</i> ู <i>L2</i> .  ุฅูุดุงุก ูููุก ุตูุงุฆู 10 ู 128 ุนูุตุฑ.  ุฅุฐุง ูุงุชู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช <i>L2</i> ุ ุฃุนุฏ ุงูุฑุจุท </li></ul><br><br>  ูู ุงูุญุงูุชูู ุงูุซุงููุฉ ูุงูุซุงูุซุฉ ุ ุณูุฒุฏุงุฏ ุงูุญูู ุนูู GC. <br><br><h2 style=";text-align:right;direction:rtl">  ุงุณุชูุชุงุฌ </h2><br><br>  ูุณูุก ุงูุญุธ ุ ูู ูุนุซุฑ ุนูู ุณุจุจ ุญูููู ูุชุณุฑุจ ุงูุฐุงูุฑุฉ ุ ููุฐุง ุณูุชุทูุจ ุฏุฑุงุณุฉ ูููุตูุฉ ููููุซู.  ูุญุณู ุงูุญุธ ุ ูููุฑ <i>WinDbg</i> ุชูููุญูุง ููุฒูุฏ ูู ุงูุชุญููู: ูุญุฏุซ ุดูุก ุณูุก ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">DLR</a> .  ุงูุนููุฏ ุงูุฃูู ูู ุนุฏุฏ ุงููุงุฆูุงุช <br><br><img src="https://habrastorage.org/webt/n_/6g/xf/n_6gxf7etpsj2fg17odfa0varvy.png"><br><br><h2 style=";text-align:right;direction:rtl">  ุนูุงูุฉ </h2><br><br>  <b>ููุงุฐุง ุงูุตุจ ูููุน <i>ุงููุงุฆู</i> ุตุฑุงุญุฉ ููุน ุชุณุฑุจุ</b> <br>  ูููู ุฅููุงุก ุฃู ููุน ุนูู <i>ุงูุนูุตุฑ</i> ุ ูุจุงูุชุงูู ุชุชููู ุงูุนูููุฉ ุนู ุฃู ุชููู ุฏููุงููููุฉ. <br><br>  <b>ููุงุฐุง ูุง ุชูุฌุฏ ุชุณุฑุจุงุช ุนูุฏ ุงูุนูู ูุน ุงูุญููู ูุทุฑู ูุงุฆู COMุ</b> <br>  ูุฐุง ูุง ูุดุจู <i>ExpressionTree</i> ูููุตูู ุฅูู ุงูุญูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs">.If ( .Call System.Dynamic.ComObject.IsComObject($$arg0) ) { .Return <span class="hljs-meta"><span class="hljs-meta">#Label1 { .Dynamic GetMember ComMarks(.Call System.Dynamic2.ComObject.ObjectToComObject($$arg0)) } }</span></span></code> </pre> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar466657/">https://habr.com/ru/post/ar466657/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar466643/index.html">ููุฎุต ุงูููุงุฏ ุงููุซูุฑุฉ ููุงูุชูุงู ููุทูุฑ ุงููุงุชู ุงููุญููู # 314 (ูู 2 ุฅูู 8 ุณุจุชูุจุฑ)</a></li>
<li><a href="../ar466647/index.html">ุงููุงุชู ููุญุตูู ุนูู ุงูุญุตุงู ูุงูุฃูุฑูุณุชุฑุง ุฏูู ุนุงุฒู ุงูุจูุงูู. ููููุฉ ุงูุฎุฑูุฌ ุจุงูููุงู ุงูุฑูุงุถูุฉ ุนูู ุงููุงุฌูุฉ ุงูุฃูุงููุฉ</a></li>
<li><a href="../ar466649/index.html">ุนุทูุฉ ููุงูุฉ ุงูุงุณุจูุน ุนูู ุณูุงุฑุฉ ููุฑุจุงุฆูุฉ</a></li>
<li><a href="../ar466651/index.html">ุงูุงุฎุชูุงุฑ ุจูู XML ู SQL ูุชุฏููู ุงูุจุฑุงูุฌ ุงููุตูุฉ LiquiBase ุจุงุณุชุฎุฏุงู Java / Spring / H2 ููุซุงู</a></li>
<li><a href="../ar466653/index.html">ุฃูุนุงุจ ุชุตุญูุญ ุงูุฃุฎุทุงุก ูู NES: ููู ูุญุฏุซ ุงูููู</a></li>
<li><a href="../ar466659/index.html">Kubecost ูุฑุงุฌุนุฉ ูุชูููุฑ ุงููุงู ุนูู Kubernetes ูู ุงูุบููู</a></li>
<li><a href="../ar466661/index.html">ุฏุฑุฌุฉ ุงููุงุฌุณุชูุฑ ูู ุงูุฎุงุฑุฌ: ููุงุญุธุงุช ูุจู ุงูุฃุทุฑูุญุฉ</a></li>
<li><a href="../ar466663/index.html">ุชุฌุงุฑุจ ุจุณูุทุฉ ูุน ูุชุญูู STM32F103 (ุงูุฌูุงุฒ ุงูููุญู ุงูุฃุฒุฑู)</a></li>
<li><a href="../ar466665/index.html">CSS ุชุฌุงูุฒ ูููุฏุงู ุงูุจูุงูุงุช</a></li>
<li><a href="../ar466667/index.html">ููุฎุต ุงูููุงุฏ ุงูุทุงุฒุฌุฉ ูู ุนุงูู ุงููุงุฌูุฉ ุงูุฃูุงููุฉ ููุฃุณุจูุน ุงููุงุถู ุฑูู 379 (ูู 2 ุฅูู 8 ุณุจุชูุจุฑ 2019)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>