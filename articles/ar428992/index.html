<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ด ๐ฐ๐ผ ๐๐ฝ ุชุฌุงูุฒ ุงูุชูุงุฆู ููุฃููุงู ุนูู ุฃุฌูุฒุฉ ุงูุชูุฌูู ุจุงุณุชุฎุฏุงู ุงูุจุฑุงูุฌ ุงูุซุงุจุชุฉ Padavan ู Keenetic OS ๐บ ๐ต ๐ถ๐พ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ุชู ูุดุฑ ุนุฏุฏ ูุจูุฑ ูู ุงูุฅุฑุดุงุฏุงุช ูุน ุฎูุงุฑุงุช ูุฎุชููุฉ ูุชุฌุงูุฒ ุญุธุฑ ููุงุฑุฏ ุงูุฅูุชุฑูุช. ููู ุงูููุถูุน ูุง ูููุฏ ุฃูููุชู. ูู ูุซูุฑ ูู ุงูุฃุญูุงู ุ ูุชู ุงูุงุณุชูุงุน ุฅูู ุงููุจุงุฏุฑุงุช ุน...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ุชุฌุงูุฒ ุงูุชูุงุฆู ููุฃููุงู ุนูู ุฃุฌูุฒุฉ ุงูุชูุฌูู ุจุงุณุชุฎุฏุงู ุงูุจุฑุงูุฌ ุงูุซุงุจุชุฉ Padavan ู Keenetic OS</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/428992/" style=";text-align:right;direction:rtl">  ุชู ูุดุฑ ุนุฏุฏ ูุจูุฑ ูู ุงูุฅุฑุดุงุฏุงุช ูุน ุฎูุงุฑุงุช ูุฎุชููุฉ ูุชุฌุงูุฒ ุญุธุฑ ููุงุฑุฏ ุงูุฅูุชุฑูุช.  ููู ุงูููุถูุน ูุง ูููุฏ ุฃูููุชู.  ูู ูุซูุฑ ูู ุงูุฃุญูุงู ุ ูุชู ุงูุงุณุชูุงุน ุฅูู ุงููุจุงุฏุฑุงุช ุนูู ุงููุณุชูู ุงูุชุดุฑูุนู ูุญุธุฑ ุงูููุงุฏ ุงููุชุนููุฉ ุจุฃุณุงููุจ ุชุฌุงูุฒ ุงูุฃููุงู.  ููุงูุช ููุงู ุดุงุฆุนุงุช ุจุฃู Roskomnadzor ุณุชุชููู ุญุฒูุฉ ุฃุฎุฑู ูู ุฃููุงู ุฏุงูุนู ุงูุถุฑุงุฆุจ ููุญุตูู ุนูู ุฃููุงู "ุฃูุถู".  ูู ูุชุนูู ุงููุณุชุฎุฏููู ุฐูู ุงูุฎุจุฑุฉ ุฃู ุดูุก ุฌุฏูุฏ ุฃู ูููุฏ ูู ุงูููุงูุฉ.  ูููู ุณูุญุตู ุงูุขุฎุฑูู ุนูู ุชุนูููุงุช ุฌุงูุฒุฉ ุฎุทูุฉ ุจุฎุทูุฉ ูุชุฌุงูุฒ ุงูุฃููุงู ุงูุงูุชูุงุฆู ุงูุจุณูุท ูุงููุนุงู ุนูู ุฃุฌูุฒุฉ ุงูุชูุฌูู ุงูุดุงุฆุนุฉ ุจุงุณุชุฎุฏุงู Padavan ู Keenetic ุงูุซุงุจุชุฉ. <br><br><img src="https://habrastorage.org/webt/is/kb/td/iskbtdxuaisqiyg3r4tsrjhj6aw.jpeg"><br><a name="habracut"></a><br><h1 style=";text-align:right;direction:rtl">  ุงููุญุชููุงุช </h1><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุฏูุฉ</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููู ุณุชุชููู ูู ุชุฌุงูุฒ ุงูุฃููุงู ุจุนุฏ ุงูุชููููุ</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุจุฏุฃ ุงูุนูู</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุชูููู ููุฌู Padavan</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุชูููู ุฌูุงุฒ ุชูุฌูู ุจูุธุงู ุชุดุบูู Keenetic</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุทุฑู ุงูุฃุณุงุณูุฉ ูุชุดุฎูุต ุงูุฃุฎุทุงุก ุจุนุฏ ุงูุชูููู</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุชุฌุงูุฒ ุฅุถุงูู ูุชุตููุฉ ุงุณุชุนูุงูุงุช DNS ูู ูุจู ุงููููุฑ</a> </li></ul><br><a name="con1"></a><h1 style=";text-align:right;direction:rtl">  ููุฏูุฉ </h1><br>  ุงุณุชุฎุฏูุช <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฎูุงุฑ ุชุฌุงูุฒ ููู</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Zolg</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุฏุฉ</a> ุนุงููู ุชูุฑูุจูุง.  ุชุณุชูุฏ ุงูุนุฏูุฏ ูู ุงูุชุนูููุงุช ุนูู ุงูุดุจูุฉ ุฅูู ุฐูู.  ุงูุฃูุบุงู ุจูุง ูู ุฐูู. <br><br>  ูุงู ูู ุดูุก ุฌูุฏูุง ุ ูููู "ุงูุฃูุถู ุฏุงุฆููุง ูู ุนุฏู ุงูุฎูุฑ".  ุฃููุงู ุ ุฃุตุจุญุช ุจุนุถ ุงูุจุฑุงูุฌ ุงูุฌุฏูุฏุฉ "ุฐููุฉ" ุฌุฏูุง ูุณุชุญู ุงููุทุงูุงุช ุจุงุณุชุฎุฏุงู ุทุฑููุง ุงูุฎุงุตุฉ ุ ูุชุฌุงูุฒุฉ ุฎุงุฏู DNS ุงูุฎุงุต ุจุงูููุฌู.  ูุง ูุณูุญ ูุฐุง dnsmasq ุนูู ุฌูุงุฒ ุงูุชูุฌูู ุจุฅุถุงูุฉ ุงูุนููุงู ุฅูู ูุฌููุนุฉ ipset ูุฅูุบุงุก ุงูููู ููุคุฏู ุฅูู ูุชูุฌุฉ ููุทููุฉ - ูุธู ุงูููุฑุฏ ููููุงู.  ูู Android 9 ุ ุงูุฏุนู ุงูุฃุตูู ูู DNS-over-TLS ุ ุฃู  ูุฐู ุงูุทุฑููุฉ ูุชุฌุงูุฒ ุงูููู ุชุชููู ุนู ุงูุนูู (ุฅุฐุง ูุงู ุงูุฌูุงุฒ ุงูุขุฎุฑ ูู ูุตู ุฅูู dnsmasq ูู ูุจู).  ุซุงูููุง ุ ูุคุฏู ุชุญุฏูุซ ูุงุฆูุฉ ุงููุทุงู ุจุงููุงูู ูู antizapret ุฅูู ูุชุงุฆุฌ ุบูุฑ ูุชููุนุฉ ูู ูู ูุฑุฉ.  ูุฏ ุชุชุถูู ุงููุงุฆูุฉ ุงููุฌุงูุงุช ุบูุฑ ุงููุญุธูุฑุฉ ุญููุง ูุงูุชู ูููู ุชุดุบูููุง ููููุง ูู ุฎูุงู ุงูููุงุฉ ุงูุฑุฆูุณูุฉ.  ูุฌุจ ุฃู ุชููู ุฏุงุฆููุง ูู ุญุงูุฉ ุชุฃูุจ ูุชุญุฑูุฑ ุงููููุงุช ุงูุชู ุชู ุฅูุดุงุคูุง ุจูุฏูู.  ุซุงูุซูุง ุ ููุฏ ุณุฆูุช ูู "ุฌุฑ" ูุงุฆูุฉ ูุจูุฑุฉ ูู ุงููุฌุงูุงุช ุงูุชู ุชุถู ุนุดุฑุงุช ุงูุขูุงู ูู ุงููุงุฒููููุงุช ููุง ุดุงุจููุง ุ ูุงูุชู ูุง ุญุงุฌุฉ ุฅูููุง ุจุจุณุงุทุฉ.  ุจูุฑูุฑ ุงูููุช ุ ุฃุฏุฑูุช ุฃููู ุจุญุงุฌุฉ ููุท ุฅูู ูุงุฆูุฉ ูุญุฏุฏุฉ ุตุบูุฑุฉ ูู ุงูููุงุฑุฏ ุงููุญุธูุฑุฉ. <br><br>  ูุฐูู ุ ููุฏุฉ ุนุงู ุ ููุช ุฃุณุชุฎุฏู ุทุฑููุฉ ูุชุญ ูุนุฏูุฉ ููููุงู ุ ูุฃูุง ุฑุงุถู ุชูุงููุง ุนู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุงูุจุณุงุทุฉ ูุณูููุฉ ุงูุชุญูู (ุจุนุฏ ุงูุชูููู). </li><li style=";text-align:right;direction:rtl">  ุงูุณูุทุฑุฉ ุงููุงููุฉ ุนูู ุงูููุงุฑุฏ ุงูุชู ุชุญุชุงุฌ ุฅูู ูุชุญูุง. </li><li style=";text-align:right;direction:rtl">  ุงูุญุฏ ุงูุฃุฏูู ูู ูุชุทูุจุงุช ููุงุฑุฏ ุงููุนุงูุฌ ูุฐุงูุฑุฉ ุงููุตูู ุงูุนุดูุงุฆู ูุฌูุงุฒ ุงูุชูุฌูู. </li><li style=";text-align:right;direction:rtl">  ุชุบุทูุฉ ูุงุณุนุฉ ูู ุงููุฑูู ุงูุฏูููุฉ ุนูุฏ ุชุฌุงูุฒ ุงูุฃููุงู. </li></ul><br>  ูู ุงูููู ุฃู ููุงุญุธ ุฃู ุฎูุงุฑู ููุณ ูุฎุตุตูุง ููุญุงูุฉ ุนูุฏูุง ุชุญุชุงุฌ ุฅูู ูุชุญ ูุฆุงุช ูุขูุงู ุงููุฌุงูุงุช.  ูุฃูู ุนูุฏ ุจุฏุก ุชุดุบูู ุฌูุงุฒ ุงูุชูุฌูู ุ ูุชู ุญู ูู ูุฌุงู ูู ุงููุงุฆูุฉ ุงููุญุฏุฏุฉ.  ูููุง ุฒุงุฏ ุนุฏุฏ ุงููุฌุงูุงุช ูู ุงููุงุฆูุฉ ุ ุฒุงุฏุช ูุฏุฉ ุชููุฆุฉ ุงูุนุฏูุฏ ูู ipset ููุชุญูุง. <br><br>  ุฃุณุงุณ ุชุฌุงูุฒ ุงูุฃููุงู ูู ููุณู - ุดุจูุฉ Tor.  ูุฑุฌุน ุงุณุชุฎุฏุงูู ุฅูู ุนุงูููู ุจุณูุทูู - ูุฌุงููุง ุ ูุงุญุชูุงู ุญุฌุจ Tor ูู ุฑูุณูุง ูุฑูุจ ูู ุงูุตูุฑ ุ ุนูู ุนูุณ ุฃู ุฎุฏูุฉ VPN.  ุชูุฑ ูู ุฃุณุงุณ ุชูุฑูุจ ุงููุฎุฏุฑุงุช ูู ุฑูุณูุง ูู ุงููุณุท ุฅูู ุงูุฃุณูู.  ุณูู ูุคุฏู Locking Tor ุฅูู ุงูุจุญุซ ุนู ุฃุฏูุงุช ุฌุฏูุฏุฉ ููุณูู ูุฎูุถ ูุณุชูู ุนุฏู ุงููุดู ุนู ูููุชู ุ ููุง ูุณุชุชุจุน ุชูุนูููุง ูุงุฌุญูุง ูุนูู ููุงูุงุช ุฅููุงุฐ ุงููุงููู ุงููุญููุฉ.  ูู ููุงูุฉ ุงููุทุงู ุ ุณูุจุฏุฃ ูุฐุง ุ ูุซู ุงูููุฑูุณ ุ ูู ุงูุชุฃุซูุฑ ุณูุจูุง ุนูู ุงูุฑุงุจุท ุงูุนููู.  ูุธุฑูุง ูุฃุญุฏุซ ุงูุฃุฎุจุงุฑ ุงููุฏูุดุฉ ุญูู ุงุชุตุงูุงุช ูุจุงุฑ ุงููุณุคูููู ุงูุญูููููู ุจุงูุงุชุฌุงุฑ ุงูุนุงููู ุจุงููุฎุฏุฑุงุช ุจุฑูุณูุง ุ ูุฅู ุญุธุฑ ุชูุฑ ูู ุฑูุณูุง ูู ูุฌุฑุฏ ุญุธุฑ ุ ุนูู ุงูุฑุบู ูู ุฃูู ุชุงูู.  ูุง Roskomnadzor ุ ุจุบุถ ุงููุธุฑ ุนู ุนุฏุฏ ุงููููุงุฑุงุช ุงููุฎุตุตุฉ ููุฐู ุงูููุงูุฉ ุ ููุณ ููุงู ูุญููุฉ ูุงุญุฏุฉ ูู ุฑูุณูุง ูุฏููุง ุฅุฐู ูู ุงูุฃุนูู ูููุน ุชูุฑ.  ููุง ููุงุฌุฆ ุฃุญุฏูุง ุฃู ูุฎูู ุฃู ุดุฎุต ุ ุนูู ุงูุฑุบู ูู ุฃู ุฑูุณูุง ุชุบุฑู ุจุจุณุงุทุฉ ูู ุงููุฎุฏุฑุงุช (ุฃู ุทูู ูู ุงููุฏุฑุณุฉ ูุนุฑู ูุง ุณููุนูู ุ ูุจุนุฏ 30 ุฏูููุฉ ูู ุงููููู ุจุงููุนู ูู ุฃู ูุฏููุฉ ูุจูุบ ุนุฏุฏ ุณูุงููุง 10 ุขูุงู ุดุฎุต ุงูุญุตูู ุนูู ุฃู ูุฎุฏุฑุงุช ุนููููุง ุจุญุฑูุฉ ุจุฃู ูููุฉ - ูุซู ุญูููุฉ ุงูุญูุงุฉ ุงูุดุฑูุฑุฉ).  ูู ุงููุถุน ุงูุญุงูู ุ ูุฅู ุงุญุชูุงู ุญุฌุจ ุดุจูุฉ Tor ุฃูู ูู ุงุญุชูุงู ุญุฌุจ ูููุน ูุชุญู Hermitage. <br><br>  ุงูุชุนูููุงุช ุงูููุฏูุฉ ุณููุฉ ููุชููู ูุน ุฃุฌูุฒุฉ ุงูุชูุฌูู ุจุงุณุชุฎุฏุงู OpenWrt.  ุฃูุถูุง ุ ุงูุชุบููุฑุงุช ุงูุตุบูุฑุฉ ุชุฌุนู ูู ุงูุณูู ุงุณุชุจุฏุงู Tor ุจู OpenVPN. <br><br><a name="con11"></a><h1 style=";text-align:right;direction:rtl">  ููู ุณุชุชููู ูู ุชุฌุงูุฒ ุงูุฃููุงู ุจุนุฏ ุงูุชููููุ </h1><br>  ูู ุดูุก ุจุณูุท ููุบุงูุฉ.  ูุฏูู ููู /opt/etc/unblock.txt - ูุงุฆูุฉ ุจุณูุทุฉ ููุชุญูุง.  ููููู ูุชุญ ูุทุงู ุฃู ุนููุงู IP ุฃู ูุทุงู ุนูุงููู ุฃู CIDR.  ุณุทุฑ ูุงุญุฏ - ุนูุตุฑ ูุงุญุฏ.  ููุณูุญ ุจุงุณุชุฎุฏุงู ุงูุฃุณุทุฑ ุงููุงุฑุบุฉ ุ ูููููู ุงุณุชุฎุฏุงู ุงูุญุฑู # ูู ุจุฏุงูุฉ ุงูุณุทุฑ ููุชุฌุงูู. <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ููุง ูุซุงู ุนูู ูููู ุงูุดุฎุตู</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"><code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">###- rutracker.org rutor.info rutor.is mega-tor.org kinozal.tv nnm-club.me nnm-club.ws tfile.me tfile-home.org tfile1.cc megatfile.cc megapeer.org megapeer.ru tapochek.net tparser.org tparser.me rustorka.com uniongang.tv fast-torrent.ru ###    rezka.ag hdrezka.ag hdrezka.me filmix.co filmix.cc seasonvar.ru ### lib.rus.ec flibusta.is flibs.me flisland.net flibusta.site ### telegram.org tdesktop.com tdesktop.org tdesktop.info tdesktop.net telesco.pe telegram.dog telegram.me t.me telegra.ph web.telegram.org desktop.telegram.org updates.tdesktop.com venus.web.telegram.org flora.web.telegram.org vesta.web.telegram.org pluto.web.telegram.org aurora.web.telegram.org 149.154.160.0/20 91.108.4.0/22 91.108.8.0/22 91.108.12.0/22 91.108.16.0/22 91.108.56.0/22 109.239.140.0/24 67.198.55.0/24 ### 7-zip.org edem.tv 4pna.com 2019.vote ### Tor check.torproject.org ###   IP ( #   ) #195.82.146.214 ###   CIDR ( #   ) #103.21.244.0/22 ###    ( #   ) #100.100.100.200-100.100.100.210</span></span></code> </pre> <br></div></div><br>  ุจุนุฏ ุชุญุฑูุฑ ูุฐุง ุงูููู ุ ูุง ุนููู ุณูู ุชูููุฐ ุงูุฃูุฑ ูุชุทุจูู ุงูุชูููู ุงูุฌุฏูุฏ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">unblock_update.sh</code> </pre> <br>  ูุชู ุฅูุบุงุก ุชุฃููู ุฌููุน ุงูููุงุฑุฏ ูู unlock.txt ุฏูู ุงูุญุงุฌุฉ ุฅูู ุฅุนุงุฏุฉ ุชุดุบูู ุฌูุงุฒ ุงูุชูุฌูู. <br><br><a name="con12"></a><h1 style=";text-align:right;direction:rtl">  ูุจุฏุฃ ุงูุนูู </h1><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุชุคุฏู ุชููุฆุฉ ุงูููุฌู ุฅูู ุฅูุดุงุก ูุฌููุนุฉ ูุงุฑุบุฉ ูู ุนูุงููู IP ููุฌููุนุฉ ipset ุชุณูู ุฅูุบุงุก ุงูุญุธุฑ. </li><li style=";text-align:right;direction:rtl">  ุชูุช ุฅุถุงูุฉ ูุงุนุฏุฉ ูุฅุนุงุฏุฉ ุชูุฌูู ุฌููุน ุงูุญุฒู ุฐุงุช ุงููุฌูุงุช ูู ุฅูุบุงุก ุงูุญุธุฑ ุฅูู ุฎุฏูุฉ Tor ุฅูู ุฌุฏุงุฑ ุงูุญูุงูุฉ. </li><li style=";text-align:right;direction:rtl">  ุชุจุฏุฃ ุฎุฏูุฉ Tor ูู ูุถุน ูููู ุดูุงู. </li><li style=";text-align:right;direction:rtl">  ุชู ุฅุทูุงู ุงูุจุฑูุงูุฌ ุงููุตู ุงูุฎุงุต unlock_ipset.sh ุ ูุงูุฐู ูุญู ุฌููุน ุงููุฌุงูุงุช ูู unlock.txt ููุถูู ุนูุงููู IP ุงูุฎุงุตุฉ ุจูู ุฅูู ูุฌููุนุฉ ุฅูุบุงุก ุงูุญุธุฑ.  ุชุชู ุฃูุถูุง ุฅุถุงูุฉ ุนูุงููู IP ูุงููุทุงูุงุช ู CIDRs ูู ูุฐุง ุงูููู ุฅูู ุฅูุบุงุก ุงูุญุธุฑ. </li><li style=";text-align:right;direction:rtl">  ูุชู ุฅุทูุงู Dnsmasq ูุน ููู ุชูููู ุฅุถุงูู ุ unlock.dnsmasq ุ ูุงูุฐู ูุดูุฑ ุฅูู ุฅุถุงูุฉ ุนูุงููู IP ูููุทุงู ูู unlock.txt ุฅูู ูุฌููุนุฉ ุฅูุบุงุก ุงูุญุธุฑ ุนูุฏ ุญููุง. </li><li style=";text-align:right;direction:rtl">  ูููู cron ุจุชุดุบูู unlock_ipset.sh ุจุชุฑุฏุฏ ูุนูู ููุชุนููุถ ุฌุฒุฆููุง ุนู ุงูุญุงูุงุช ุงููุญุชููุฉ ุฐุงุช ุงููุฑูู ุงูุฏูููุฉ. </li><li style=";text-align:right;direction:rtl">  ุฅุฐุง ูุฒู ุงูุฃูุฑ ุ ูุชู ุญู ุฌููุน ุงููุฌุงูุงุช ูู unlock.txt (ููุท) ูู ุฎูุงู dnscrypt-proxy ุฅุฐุง ูุงู ุงููููุฑ ุจุชุตููุฉ DNS. </li></ul><br><a name="con2"></a><h1 style=";text-align:right;direction:rtl">  ุชูููู ููุฌู Padavan </h1><br>  ูุฌุจ ุฃู ูููู ูุฏูู ุฌูุงุฒ ุชูุฌูู ูุซุจุช ุนููู ุจุฑูุงูุฌ Padavan ุงูุซุงุจุช ููุฏูุฑ ุญุฒูุฉ Entware ุงูุฐู ุชู ุชููููู ุจุงููุนู.  ูู ูุธุงู ุงูุชุดุบูู Windows ุ ููููู ุงุณุชุฎุฏุงู ุนููู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">PuTTY</a> ููุงุชุตุงู ุจุงูููุฌู ุนุจุฑ SSH. <br><br>  ุชุฃูุฏ ูู ุฃูู ุชุณุชุฎุฏู Entware ุ ูููุณ ุฅุตุฏุงุฑ Entware-ng ุงููุฏูู.  ุนุฑุถ ูุญุชููุงุช ูุฌูุฏ / opt / var / opkg-list.  ุณูููู ููุงู ููู entware ุฃู entware-ng.  ูู ุงูุญุงูุฉ ุงูุซุงููุฉ ุ ุชุญุชุงุฌ ุฅูู ุชุญุฏูุซ ุจุฑูุงูุฌ Padavan ุงูุซุงุจุช ูุฌูุงุฒ ุงูุชูุฌูู ุงูุฎุงุต ุจู ุฅูู ุฃุญุฏุซ ุฅุตุฏุงุฑ ูุฅุนุงุฏุฉ ุชุซุจูุช ูุฏูุฑ ุญุฒูุฉ Entware.  ุนูุฏูุง ููุท ุชุงุจุน ุงูุชุนูููุงุช ุฎุทูุฉ ุจุฎุทูุฉ. <br><br>  ููุง ุฃุธูุฑุช ุงููุฑุงุฌุนุงุช ุ ุจุดูู ุฑุฆูุณู ุฃููุฆู ุงูุฐูู ูุงููุง ุจุชูููู Entware ุจุดูู ุบูุฑ ุตุญูุญ ูู ุงูุจุฏุงูุฉ (ุฃู ูู ูุชู ุชุญููู ุงูุจุฑุงูุฌ ุงููุตูุฉ ูู init.d) ูู ุงูุฐุงูุฑุฉ ุงูุฏุงุฎููุฉ ูุฌูุงุฒ ุงูุชูุฌูู.  ุฅุฐุง ูุงู ูุฏูู Xiaomi Mi Router 3 ุฃู 3G ุ ููุณุช ูุชุฃูุฏูุง ูู ุฃู Entware ูู ุงูุฐุงูุฑุฉ ุงูุฏุงุฎููุฉ ูุนูู ุจุดูู ุตุญูุญ (ุจุฏุก ุชููุงุฆู) ุ ููู ููุท ุจุฅุนุฏุงุฏ ูู ุดูุก ูุฑุฉ ุฃุฎุฑู.  ุฎุฐ PROMETHEUS.  ูุญุฏูุซ ุงูุจุฑูุงูุฌ ุงููุตู (1).  ูู ุจุชุญุฏูุซ ููุฏ ุงููุตุฏุฑ (2).  ุงุฌูุน ุฃุญุฏุซ ุงูุจุฑุงูุฌ ุงูุซุงุจุชุฉ ูุงูุชุญูุง (4).  ุฅุนุงุฏุฉ ุชุนููู ุฅุนุฏุงุฏุงุช ุงูุจุฑุงูุฌ ุงูุซุงุจุชุฉ (NVRAM ูุชุฎุฒูู ุงููููุงุช) - ูุชูุฏู&gt; ุงูุฅุฏุงุฑุฉ&gt; ุงูุฅุนุฏุงุฏุงุช.  ุชูููู ุงููุตูู ุฅูู ุงูุฅูุชุฑูุช ุนูู ุฌูุงุฒ ุงูุชูุฌูู ูุชูููู SSH.  ููุฐ ูู PROMETHEUS Firmware&gt; ุชูุณูู RWFS.  ุงุฎุชุฑ Advanced&gt; Administration&gt; Settings&gt; Mount file system ูู ูุณู R / W&gt; UBIFS.  ุฃุนุฏ ุชุดุบูู ุฌูุงุฒ ุงูุชูุฌูู.  ุณูุชู ุชุณุฌูู ุฌููุน ุงูุจุฑุงูุฌ ุงููุตูุฉ ูุจุฏุก ุชุดุบูู Entware ุงูุญุงููุฉ ูู ุงูุฐุงูุฑุฉ ุงูุฏุงุฎููุฉ ุชููุงุฆููุง ุ ูุณูุนูู ูู ุดูุก ูุซู ุงูุณุงุนุฉ. <br><br>  ููุงุฎุชุจุงุฑุงุช ุ ุงุณุชุฎุฏูุช ุฌูุงุฒ Xiaomi Mi Router 3G ุงูุดููุฑ (ุชู ุชุซุจูุช Entware ูู ุงูุฐุงูุฑุฉ ุงูุฏุงุฎููุฉ) ูุน ุฃุญุฏุซ ุงูุจุฑุงูุฌ ุงูุซุงุจุชุฉ - 32a93db.  ูู ุดูุก ุณูุนูู ุญุชู ุนูู ุงูุทูู ุงูุฃุณุทูุฑู WT3020 AD / F / H ููุงุจู 10 ุฏููุงุฑุงุช. <br><br><img src="https://habrastorage.org/webt/th/kf/2k/thkf2kvtt2rhtnbxvmx0qri7dsk.jpeg"><br><br><h3 style=";text-align:right;direction:rtl">  1. ุชุซุจูุช ุงูุจุฑุงูุฌ ุงููุงุฒูุฉ ุนูู ุฌูุงุฒ ุงูุชูุฌูู </h3><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">opkg update opkg install mc tor tor-geoip <span class="hljs-built_in"><span class="hljs-built_in">bind</span></span>-dig cron</code> </pre> <br>  <b>ููููุฏูุฉ</b> - ูุฏูุฑ ูููุงุช ูุงุฆุฏ ููุชุตู ุงูููู.  ูู ูุทููุจ ููุท ุจุณุจุจ ูุญุฑุฑ mcedit ุงูููุงุณุจ.  ุฅุฐุง ููุช ูุนุชุงุฏูุง ุนูู ุงุณุชุฎุฏุงู ูุญุฑุฑ ูุตูุต ุขุฎุฑ ุ ููุง ูููู ุชุซุจูุช mc. <br>  ุฎุฏูุฉ Tor - Tor. <br>  <b>tor-geoip</b> - ูุงุนุฏุฉ ุจูุงูุงุช geo-IP ูู Tor. <br>  <b>ุฑุจุท ุญูุฑ</b> - ุนููู DNS (ุชูุงุธุฑู NSLOOKUP ูุงููุถูู). <br>  <b>ูุฑูู</b> - ุฌุฏููุฉ ุงูููุงู. <br><cut></cut><br><h3 style=";text-align:right;direction:rtl">  2. ุชููุฆุฉ ipset ุ ูุฅูุดุงุก ุนุฏุฉ ุนูุงููู IP ุบูุฑ ููููุฉ (start_script.sh) </h3><br>  ูู ุจุชูุตูู ุงููุญุฏุงุช ุงูุถุฑูุฑูุฉ ููู ุจุฅูุดุงุก ูุฌููุนุฉ ูุงุฑุบุฉ ูู ุงูุนูุงููู ุจุงุณุชุฎุฏุงู <b>ุฅูุบุงุก ุญุธุฑ</b> ุงูุงุณู ุนูุฏ ุชุดุบูู ุฌูุงุฒ ุงูุชูุฌูู.  ููููุงู ุจุฐูู ุ ุงูุชุญ ููู <b>/etc/storage/start_script.sh</b> ูู ุงููุญุฑุฑ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">mcedit /etc/storage/start_script.sh</code> </pre> <br>  ุฃุถู ูู ุงูููุงูุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">modprobe ip_set modprobe ip_set_hash_ip modprobe ip_set_hash_net modprobe ip_set_bitmap_ip modprobe ip_set_list_set modprobe xt_set ipset create unblock <span class="hljs-built_in"><span class="hljs-built_in">hash</span></span>:net</code> </pre> <br>  ููุตู ูู ุงููุฎุฒู ุงููุคูุช ุ ุงุณุชุฎุฏู Shift + Insert ุ ูุงุญูุธ - F2 ุ ูุงุฎุฑุฌ - F10. <br><br><img src="https://habrastorage.org/webt/tr/zp/cq/trzpcqqnadbonhsb0x3ebe7ltpo.png"><br><br>  ุฅุฐุง ููุช ุชุฑุบุจ ูู ุฐูู ุ ููููู ุชุนุฏูู ููู start_script.sh ูู ุฎูุงู ูุงุฌูุฉ ุงูููุจ ุงูุฎุงุตุฉ ุจุฌูุงุฒ ุงูุชูุฌูู - "ูุชูุฏู"&gt; "ุงูุชุฎุตูุต"&gt; "ุงูุจุฑุงูุฌ ุงููุตูุฉ"&gt; "ุชุดุบูู ูุจู ุชููุฆุฉ ุฌูุงุฒ ุงูุชูุฌูู".  ุจุนุฏ ุงูุชุญุฑูุฑ ุ ุงููุฑ ููู "ุชุทุจูู". <br><br><img src="https://habrastorage.org/webt/yr/aa/8q/yraa8qgcfwu-vesrp3wvvne2vui.png"><br><br><h3 style=";text-align:right;direction:rtl">  3. ุฅุนุฏุงุฏ ุชูุฑ </h3><br>  ุงุญุฐู ูุญุชููุงุช ููู ุชูููู Tor: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">cat /dev/null &gt; /opt/etc/tor/torrc</code> </pre> <br>  ุงูุชุญ ููู ุชูููู Tor: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">mcedit /opt/etc/tor/torrc</code> </pre> <br>  ุงูุตู (Shift + Insert) ุงููุญุชููุงุช: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">User admin PidFile /opt/var/run/tor.pid ExcludeExitNodes {RU},{UA},{AM},{KG},{BY} StrictNodes 1 TransPort 192.168.0.1:9141 ExitRelay 0 ExitPolicy reject *:* ExitPolicy reject6 *:* GeoIPFile /opt/share/tor/geoip GeoIPv6File /opt/share/tor/geoip6 DataDirectory /opt/var/lib/tor</code> </pre> <br>  ุฅุฐุง ูุฒู ุงูุฃูุฑ ุ <b>ุงุณุชุจุฏู 192.168.0.1</b> ุจุงูุนููุงู ุงูุฏุงุฎูู ูุฌูุงุฒ ุงูุชูุฌูู (LAN).  ูุตู ููุฌุฒ ุงูุชูููู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุงุณุชุจุนุงุฏ ุนูุฏ ุงูุฅุฎุฑุงุฌ: ุฑูุณูุง ุ ุฃููุฑุงููุง ุ ุฃุฑููููุง ููุฑุบูุฒุณุชุงู ุ ุฑูุณูุง ุงูุจูุถุงุก. </li><li style=";text-align:right;direction:rtl">  ูู ุจุชุนููู ูููู ุดูุงู ุฅูู ุงูุนููุงู 192.168.0.1 ุ ุงููููุฐ 9141. </li><li style=";text-align:right;direction:rtl">  ุฑูุถ ุฃู ุชููู ููุทุฉ ุฎุฑูุฌ. </li></ul><br><h3 style=";text-align:right;direction:rtl">  4. ูุงุฆูุฉ ุงููุฌุงูุงุช (ูููุณ ููุท) ูุชุฌุงูุฒ ุงูููู (unlock.txt) </h3><br>  ูุนุฏ ููู unlock.txt ูุงุฆูุฉ ุจุณูุทุฉ ููุชุญูุง.  ููููู ูุชุญ ูุทุงู ุฃู ุนููุงู IP ุฃู ูุทุงู ุฃู CIDR.  ุณุทุฑ ูุงุญุฏ - ุนูุตุฑ ูุงุญุฏ.  ูุชู ุชุฌุงูู ุงูุฃุณุทุฑ ุงููุงุฑุบุฉ (ุจูุง ูู ุฐูู ุงููุณุงูุงุช ูุนูุงูุงุช ุงูุชุจููุจ).  ููููู ุงุณุชุฎุฏุงู ุงูุญุฑู # ูู ุจุฏุงูุฉ ุงูุณุทุฑ ูุชุฌุงููู. <br><br>  ูู <b>ุจุฅูุดุงุก</b> ุงูููู <b>/opt/etc/unblock.txt</b> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">mcedit /opt/etc/unblock.txt</code> </pre> <br>  ูููู ุฃู ูุญุชูู ูู ุตู ุนูู ุงุณู ูุฌุงู ุฃู ุนููุงู IP ุฃู ูุทุงู ุฃู CIDR.  ููููู ุงุณุชุฎุฏุงู ุงูุญุฑู # ููุชุนููู ุนูู ุงูุฃุณุทุฑ. <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ููุง ูุซุงู ุนูู ูููู ุงูุดุฎุตู</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">###- rutracker.org rutor.info rutor.is mega-tor.org kinozal.tv nnm-club.me nnm-club.ws tfile.me tfile-home.org tfile1.cc megatfile.cc megapeer.org megapeer.ru tapochek.net tparser.org tparser.me rustorka.com uniongang.tv fast-torrent.ru ###    rezka.ag hdrezka.ag hdrezka.me filmix.co filmix.cc seasonvar.ru ### lib.rus.ec flibusta.is flibs.me flisland.net flibusta.site ### telegram.org tdesktop.com tdesktop.org tdesktop.info tdesktop.net telesco.pe telegram.dog telegram.me t.me telegra.ph web.telegram.org desktop.telegram.org updates.tdesktop.com venus.web.telegram.org flora.web.telegram.org vesta.web.telegram.org pluto.web.telegram.org aurora.web.telegram.org 149.154.160.0/20 91.108.4.0/22 91.108.8.0/22 91.108.12.0/22 91.108.16.0/22 91.108.56.0/22 109.239.140.0/24 67.198.55.0/24 ### 7-zip.org edem.tv 4pna.com 2019.vote ### Tor check.torproject.org ###   IP ( #   ) #195.82.146.214 ###   CIDR ( #   ) #103.21.244.0/22 ###    ( #   ) #100.100.100.200-100.100.100.210</span></span></code> </pre> <br></div></div><br><h3 style=";text-align:right;direction:rtl">  5. ูุต ุจุฑูุฌู ูููุก ูุฌููุนุฉ ูู ุนูุงููู IP ุบูุฑ ุงููุญุธูุฑุฉ ููุงุฆูุฉ ูุนููุฉ ูู ุงููุฌุงูุงุช (unlock_ipset.sh) </h3><br>  ูู <b>ุจุฅูุดุงุก</b> ุงูุจุฑูุงูุฌ ุงููุตู <b>/opt/bin/unblock_ipset.sh</b> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">mcedit /opt/bin/unblock_ipset.sh</code> </pre> <br>  ุงูุตู (Shift + Insert) ุงููุญุชููุงุช: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/sh until ADDRS=$(dig +short google.com @localhost) &amp;&amp; [ -n "$ADDRS" ] &gt; /dev/null 2&gt;&amp;1; do sleep 5; done while read line || [ -n "$line" ]; do [ -z "$line" ] &amp;&amp; continue [ "${line:0:1}" = "#" ] &amp;&amp; continue cidr=$(echo $line | grep -Eo '[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/[0-9]{1,2}') if [ ! -z "$cidr" ]; then ipset -exist add unblock $cidr continue fi range=$(echo $line | grep -Eo '[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}-[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}') if [ ! -z "$range" ]; then ipset -exist add unblock $range continue fi addr=$(echo $line | grep -Eo '[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}') if [ ! -z "$addr" ]; then ipset -exist add unblock $addr continue fi dig +short $line @localhost | grep -Eo '[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}' | awk '{system("ipset -exist add unblock "$1)}' done &lt; /opt/etc/unblock.txt</span></span></code> </pre> <br>  ููุญ ุญููู ุงูุชูููุฐ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">chmod +x /opt/bin/unblock_ipset.sh</code> </pre> <br>  ุงููุต ุงูุจุฑูุฌู ุจุณูุท ููุบุงูุฉ ุ ููุฐุง ูู ุฌููุฑ ุนููู ... ูุญู ูู ุงูุชุธุงุฑ ุฃู ูุนูู ุญู ูุทุงู google.com (ุฅุฐุง ูู ูุชู ุฐูู ุ ููู ูุชู ููุก ุงููุซูุฑ ูู ุนูููุงุช ุฅูุบุงุก ุงูุญุธุฑ ุนูุฏ ุชุดุบูู ุฌูุงุฒ ุงูุชูุฌูู ุ ูุฃู ุฌูุงุฒ ุงูุชูุฌูู ุณูุธู ููุฏ ุงูุชููุฆุฉ).  ููุฑุฃ ุงูุฃุณุทุฑ ูู ููู unlock.txt.  ุชููู ุฃุณุทุฑ ุงููุฑุงุกุฉ ุจุญุฐู ุงููุณุงูุงุช ูุนูุงูุงุช ุงูุชุจููุจ ุชููุงุฆููุง ูู ุงูุจุฏุงูุฉ ูุงูููุงูุฉ.  ุชุฎุทู ุงูุฃุณุทุฑ ุงููุงุฑุบุฉ.  ุชุฎุท ุงูุฃุณุทุฑ ุงูุชู ุชุจุฏุฃ ุจุญุฑู #.  ูุญู ูุจุญุซ ูู ุณุทุฑ CIDR.  ุฅุฐุง ุชู ุงูุนุซูุฑ ุนูู CIDR ุ ูุฃุถูู ุฅูู ุฅูุบุงุก ุงูุญุธุฑ.  ูุญู ูุจุญุซ ุนู ูุทุงู ูู ุงูุณูุณูุฉ.  ุฅุฐุง ุชู ุงูุนุซูุฑ ุนูููุง ุ ูุฃุถููุง ุฅูู ุฅูุบุงุก ุงูุญุธุฑ.  ูุญู ูุจุญุซ ุนู ุนููุงู IP ูู ุงูุณูุณูุฉ.  ุฅุฐุง ุชู ุงูุนุซูุฑ ุนูู IP ุ ูุฃุถูู ูุฅูุบุงุก ุงูุญุธุฑ.  ุฏุนููุง ุญู ุฎุท ูู ุฎูุงู ุญูุฑ.  ุชุชู ุฅุถุงูุฉ ุฌููุน ุนูุงููู IP ูููุชูุฌุฉ ุฅูู ุฅูุบุงุก ุงูุญุธุฑ. <br><br><h3 style=";text-align:right;direction:rtl">  6. ุจุฑูุงูุฌ ูุตู ูุฅูุดุงุก ููู ุชูููู dnsmasq ุฅุถุงูู ูู ูุงุฆูุฉ ูุฌุงูุงุช ูุนููุฉ (unlock_dnsmasq.sh) </h3><br>  ูู <b>ุจุฅูุดุงุก</b> ุงูุจุฑูุงูุฌ ุงููุตู <b>/opt/bin/unblock_dnsmasq.sh</b> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">mcedit /opt/bin/unblock_dnsmasq.sh</code> </pre> <br>  ุงูุตู (Shift + Insert) ุงููุญุชููุงุช: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/sh cat /dev/null &gt; /opt/etc/unblock.dnsmasq while read line || [ -n "$line" ]; do [ -z "$line" ] &amp;&amp; continue [ "${line:0:1}" = "#" ] &amp;&amp; continue echo $line | grep -Eq '[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}' &amp;&amp; continue echo "ipset=/$line/unblock" &gt;&gt; /opt/etc/unblock.dnsmasq done &lt; /opt/etc/unblock.txt</span></span></code> </pre> <br>  ููุญ ุญููู ุงูุชูููุฐ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">chmod +x /opt/bin/unblock_dnsmasq.sh</code> </pre> <br>  ุงูุจุฑูุงูุฌ ุงููุตู ุจุณูุท ููุบุงูุฉ ุ ูุฐุง ูู ุฌููุฑ ุนููู ... ููุฑุฃ ุชุณูุณููุง ูู /opt/etc/unblock.txt.  ุชููู ุฃุณุทุฑ ุงููุฑุงุกุฉ ุจุญุฐู ุงููุณุงูุงุช ูุนูุงูุงุช ุงูุชุจููุจ ุชููุงุฆููุง ูู ุงูุจุฏุงูุฉ ูุงูููุงูุฉ.  ุชุฎุทู ุงูุฃุณุทุฑ ุงููุงุฑุบุฉ.  ุชุฎุทู ุงูุฎุทูุท ุงูุชู ุชุจุฏุฃ ุจู #.  ูุญู ูุชุฎุทู ุงูุฎุทูุท ุงูุชู ุชุญุชูู ุนูู ุนููุงู IP (IP ุ range ุ CIDR) ุ ุฃู  ูุญู ููุชููู ููุท ุจุงูุณูุงุณู ูุน ุฃุณูุงุก ุงููุทุงูุงุช.  ูู ุงูููู /opt/etc/unblock.dnsmasq ูุถูู ุฃุณุทุฑูุง ูู ุงููููุฐุฌ "ipset = / domain_name / unlock".  ูุฐุง ูุนูู ุฃูู ุจุนุฏ ุชุญุฏูุฏ ุนูุงููู IP ุงูุฎุงุตุฉ ุจูุฌุงู ูุนูู ุ ุณุชุชู ุฅุถุงูุชูุง ุชููุงุฆููุง ุฅูู ูุฌููุนุฉ ุฅูุบุงุก ุงูุญุธุฑ. <br><br>  ุชุฃูุฏ ูู ุชุดุบูู ุงูุจุฑูุงูุฌ ุงููุตู ูุฅูุดุงุก ููู unlock.dnsmasq: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">unblock_dnsmasq.sh</code> </pre> <br>  ุชุญูู ูู ุฅูุดุงุก ููู unlock.dnsmasq: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">cat /opt/etc/unblock.dnsmasq</code> </pre> <br><h3 style=";text-align:right;direction:rtl">  7. ุงูุจุฑูุงูุฌ ุงููุตู ููุชุญุฏูุซ ุงูุฅุฌุจุงุฑู ูููุธุงู ุจุนุฏ ุชุญุฑูุฑ ูุงุฆูุฉ ุงููุฌุงูุงุช (unlock_update.sh) </h3><br>  ูู <b>ุจุฅูุดุงุก</b> ุงูุจุฑูุงูุฌ ุงููุตู <b>/opt/bin/unblock_update.sh</b> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">mcedit /opt/bin/unblock_update.sh</code> </pre> <br>  ุงูุตู (Shift + Insert) ุงููุญุชููุงุช: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/sh ipset flush unblock /opt/bin/unblock_dnsmasq.sh restart_dhcpd sleep 3 /opt/bin/unblock_ipset.sh &amp;</span></span></code> </pre> <br>  ููุญ ุญููู ุงูุชูููุฐ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">chmod +x /opt/bin/unblock_update.sh</code> </pre> <br><h3 style=";text-align:right;direction:rtl">  8. ุจุฑูุงูุฌ ูุตู ูุชุนุจุฆุฉ ูุฌููุนุฉ ูู ุนูููุงุช ุฅูุบุงุก ุงูุญุธุฑ ุชููุงุฆููุง ุนูุฏ ุชุดุบูู ุฌูุงุฒ ุชูุฌูู (S99unblock) </h3><br>  ูู <b>ุจุฅูุดุงุก</b> ุงูุจุฑูุงูุฌ ุงููุตู <b>/opt/etc/init.d/S99unblock</b> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">mcedit /opt/etc/init.d/S99unblock</code> </pre> <br>  ุงูุตู (Shift + Insert) ุงููุญุชููุงุช: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/sh [ "$1" != "start" ] &amp;&amp; exit 0 /opt/bin/unblock_ipset.sh &amp;</span></span></code> </pre><br>  ููุญ ุญููู ุงูุชูููุฐ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">chmod +x /opt/etc/init.d/S99unblock</code> </pre> <br><h3 style=";text-align:right;direction:rtl">  9. ุฅุนุงุฏุฉ ุชูุฌูู ุงูุญุฒู ุฐุงุช ุงููุฌูุงุช ูู ุฅูุบุงุก ุงูุญุธุฑ ุฅูู Tor (post_iptables_script.sh) </h3><br>  ุงูุชุญ ุงูููู <b>/etc/storage/post_iptables_script.sh</b> ูู ุงููุญุฑุฑ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">mcedit /etc/storage/post_iptables_script.sh</code> </pre> <br>  ุฃุถู ูู ุงูููุงูุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">iptables -t nat -A PREROUTING -i br0 -p tcp -m <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> --match-set unblock dst -j REDIRECT --to-port 9141</code> </pre> <br><img src="https://habrastorage.org/webt/af/u2/dl/afu2dld3v0nrhtjwfekvo6i-wsi.png"><br><br>  ุฅุฐุง ููุช ุชุฑุบุจ ูู ุฐูู ุ ููููู ุชุนุฏูู ููู post_iptables_script.sh ูู ุฎูุงู ูุงุฌูุฉ ุงูููุจ ุงูุฎุงุตุฉ ุจุงูููุฌู - "ูุชูุฏู"&gt; "ุงูุชุฎุตูุต"&gt; "ุงูุจุฑุงูุฌ ุงููุตูุฉ"&gt; "ุงูุชุดุบูู ุจุนุฏ ุฅุนุงุฏุฉ ุชุดุบูู ููุงุนุฏ ุฌุฏุงุฑ ุงูุญูุงูุฉ".  ุจุนุฏ ุงูุชุญุฑูุฑ ุ ุงููุฑ ููู "ุชุทุจูู". <br><br><img src="https://habrastorage.org/webt/pv/be/ot/pvbeotspo0xhzrukgp3dgvu5aws.png"><br><br>  ููููู ุฅุถุงูุฉ (ูุฐุง ุงุฎุชูุงุฑู) ุฅูู ููุณ ุงูููู ูุฅุนุงุฏุฉ ุชูุฌูู ุฌููุน ุงูุทูุจุงุช ุฅูู ุงููููุฐ ุงูุฎุงุฑุฌู 53 ูููุณู.  ูุนุฏ ุฐูู ุถุฑูุฑููุง ุญุชู ูุง ูุณุชุฎุฏู ุงูุนููุงุก ุนูู ุงูุดุจูุฉ ุงููุญููุฉ ุฎุฏูุงุช DNS ุงูุฎุงุตุฉ ุจุฌูุฉ ุฎุงุฑุฌูุฉ.  ุณุชูุฑ ุงูุทูุจุงุช ุนุจุฑ ุฎุงุฏู DNS ุงูุนุงุฏู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">iptables -t nat -I PREROUTING -i br0 -p udp --dport 53 -j DNAT --to 192.168.0.1 iptables -t nat -I PREROUTING -i br0 -p tcp --dport 53 -j DNAT --to 192.168.0.1</code> </pre> <br>  ุฅุฐุง ูุฒู ุงูุฃูุฑ ุ <b>ุงุณุชุจุฏู 192.168.0.1</b> ุจุงูุนููุงู ุงูุฏุงุฎูู ูุฌูุงุฒ ุงูุชูุฌูู (LAN). <br><br><h3 style=";text-align:right;direction:rtl">  10. ุชูุตูู ููู ุชูููู ุฅุถุงูู ุฅูู dnsmasq </h3><br>  ูุญู ุจุญุงุฌุฉ ุฅูู ุฑุจุท ููู unlock.dnsmasq ุงูุฐู ุชู ุฅูุดุงุคู ุจู dnsmasq.  ููููุงู ุจุฐูู ุ ุงูุชุญ ุงูููู <b>/etc/storage/dnsmasq/dnsmasq.conf</b> ูู ุงููุญุฑุฑ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">mcedit /etc/storage/dnsmasq/dnsmasq.conf</code> </pre> <br>  ุฃุถู ูู ุงูููุงูุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">conf-file=/opt/etc/unblock.dnsmasq</code> </pre> <br>  ุฅุฐุง ููุช ุชุฑูุฏ (ูุฐุง ุงุฎุชูุงุฑู) ุ ููููู ุฅุถุงูุฉ ุฎุงุฏู ุฅุถุงูู ููุฏูุฉ ูุงูููุซูููุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">server=8.8.8.8</code> </pre> <br>  ุฅุฐุง ููุช ุชุฑุบุจ ูู ุฐูู ุ ููููู ุชุนุฏูู ููู dnsmasq.conf ุนุจุฑ ูุงุฌูุฉ ุงูููุจ ุงูุฎุงุตุฉ ุจุฌูุงุฒ ุงูุชูุฌูู - "ูุชูุฏู"&gt; "LAN"&gt; "ุฎุงุฏู DHCP"&gt; "ููู ุชูููู ุงููุณุชุฎุฏู dnsmasq.conf".  ุจุนุฏ ุงูุชุญุฑูุฑ ุ ุงููุฑ ููู "ุชุทุจูู". <br><br><img src="https://habrastorage.org/webt/x0/ar/4c/x0ar4cm6v9pgsluqabh74qck-s0.png"><br><br><h3 style=";text-align:right;direction:rtl">  11. ุฅุถุงูุฉ ูููุฉ ุฅูู cron ูุชุญุฏูุซ ูุญุชููุงุช ูุฌููุนุฉ ุฅูุบุงุก ุงูุญุธุฑ ุจุดูู ุฏูุฑู </h3><br>  ูุนุฏ ูุฐุง ุชุฃููููุง ุฅุถุงูููุง ูู ุญุงูุฉ ุงุณุชุฎุฏุงู ุงูุจุฑุงูุฌ / ุงูุฃุฌูุฒุฉ ูุทุฑููุฉ ุญู ุฎุงุตุฉ ุจูุง ูุชุบููุฑ ุนููุงู IP ุงูุฎุงุต ุจุงููุฌุงู.  ูู ูุง ุนููู ูุนูู ูู ุชุดุบูู ุงูุจุฑูุงูุฌ ุงููุตู unlock_ipset.sh ุนูู ุงูุชุฑุฏุฏ ุงููุทููุจ.  ุนูู ุณุจูู ุงููุซุงู ุ ุณูุทูู ูู ููู ุงูุณุงุนุฉ 6 ุตุจุงุญูุง. <br><br>  ุงุณุชุจุฏู ุงุณู ุงูุฌุฐุฑ ุจุงุณู admin ูู ููู ุชููุฆุฉ cron: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">sed -i <span class="hljs-string"><span class="hljs-string">'s/root/admin/g'</span></span> /opt/etc/crontab</code> </pre> <br>  ุงูุชุญ ุงูููู <b>/ opt / etc / crontab</b> ูู ุงููุญุฑุฑ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">mcedit /opt/etc/crontab</code> </pre> <br>  ุฃุถู ูู ุงูููุงูุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">00 06 * * * admin /opt/bin/unblock_ipset.sh</code> </pre> <br>  ุฅุฐุง ููุช ุชุฑุบุจ ูู ุฐูู ุ ููููู ุงูุชุนููู ุนูู ุฌููุน ููุงู ุงููุงูุจ ุงูุฃุฎุฑู.  ุฅููู ูุง ุณูุจุฏู ุนููู ููู crontab: <br><br><img src="https://habrastorage.org/webt/hf/lb/fc/hflbfcv04lpvzlrjmehoc3l51ts.png"><br><br><h3 style=";text-align:right;direction:rtl">  12. ุฅุนุงุฏุฉ ุชุดุบูู ุฌูุงุฒ ุงูุชูุฌูู </h3><br>  ูู ุจุชุดุบูู ุงูุฃูุฑ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">reboot</code> </pre> <br>  ุจุนุฏ ุฅุนุงุฏุฉ ุงูุชุดุบูู ุ ุงูุชุญ ูููุน check.torproject.org ูู ูุชุตูุญู (ูุฌุจ ุฅุถุงูุชู ุฅูู unlock.txt).  ุฅุฐุง ูุนูุช ูู ุดูุก ุจุดูู ุตุญูุญ ุ ูุณุชุฑู ุงูููุด "ุชูุงูููุง.  ุชู ุชูููู ูุฐุง ุงููุชุตูุญ ูุงุณุชุฎุฏุงู Tor. ": <br><br><img src="https://habrastorage.org/webt/wa/19/dz/wa19dzxbu8qtldwrvkeijfqna7q.png"><br><br><br><a name="con3"></a><h1 style=";text-align:right;direction:rtl">  ุชูููู ุฌูุงุฒ ุชูุฌูู ุจูุธุงู ุชุดุบูู Keenetic </h1><br>  ูุฌุจ ุฃู ูููู ูุฏูู ููุฌู Keenetic / Zyxel ูุน ุชูููู Entware Package Manager (OPKG) ุจุงููุนู.  ุนูู ุณุจูู ุงููุซุงู ุ ุฅููู ูุงุฆูุฉ ุจุจุนุถ ุฃุฌูุฒุฉ ุงูุชูุฌูู ุงูุชู ุชุฏุนู Entware: Keenetic II ู Keenetic III ู Extra ู Extra II ู Giga II ู Giga III ู Omni ู Omni II ู Viva ู Ultra ู Ultra II ู Omni (KN-1410) ู Extra (KN -1710) ุ ุฌูุฌุง (KN-1010) ุ ุฃูุชุฑุง (KN-1810) ุ Viva (KN-1910) ุ DSL (KN-2010) ุ Duo (KN-2110).  ูููู ุงูุนุซูุฑ ุนูู ุชุนูููุงุช ุชูููู Entware <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุง</a> (ุญุชู 10 ููุงุท). <br><br>  ุฅุฐุง ุณุจู ูู (ูุน ุงูุจุฑุงูุฌ ุงูุซุงุจุชุฉ ุชุญุช 2.07) ุฃู ููุช ุจุงููุนู ุจุฅุถุงูุฉ ุฏุนู Entware ุ ูุชุฃูุฏ ูู ุฃูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุชุณุชุฎุฏู Entware-ng ุงููุฏููุฉ</a> . <br><br>  ุชุฃูุฏ ูู ุชูููู "ูุญุฏุงุช ููุงุฉ ุงููุธุงู ุงููุฑุนู ูู Netfilter" - ุงูุฅุนุฏุงุฏุงุช ุงูุนุงูุฉ&gt; ุชุบููุฑ ูุฌููุนุฉ ุงูููููุงุช.  ุฅุฐุง ูู ููู ููุฌูุฏูุง ูู ูุงุฆูุฉ ุงูุนูุงุตุฑ ุงููุชุงุญุฉ ุ ูุญุงูู ุชุซุจูุช ูููู ุจุฑูุชูููู IPv6 ุฃููุงู.  ุฅุฐุง ูู ูุธูุฑ ูุฐุง ุจุนุฏ ุฐูู ุ ูุญุงูู ุจุฏููู ุ ูููู ููุงู ุงุญุชูุงู ูุจูุฑ ุฃูู ูู ุชุชููู ูู ุฅูุบุงุก ุงูููู ุญุณุจ ุงููุทุงู ู CIDR (ูุฃูู ูู ูููู ููุงู ุฏุนู ููุชุฌุฒุฆุฉ: net set). <br><br><img src="https://habrastorage.org/webt/vv/dh/hi/vvdhhirhcktuefrgbxh3fkx5i0i.png"><br><br>  ููุงุฎุชุจุงุฑุงุช ุ ุงุณุชุฎุฏูุช Keenetic Ultra (KN-1810) ูุน ุฃุญุฏุซ ุงูุจุฑุงูุฌ ุงูุซุงุจุชุฉ - 2.14.C.0.0-4. <br><br>  <u>ููุงุญุธุฉ ูููุฉ.</u>  <u>ุณูููู ุนููู ุชุนุทูู ุฎุงุฏู DNS ุงูุนุงุฏู ูู ุงููุธุงู ุ ูุณูู ูุณุชุฎุฏู dnsmasq ุจุฏูุงู ูู ุฐูู.</u>  <u>ุณุชููุฏ ุงููุฏุฑุฉ ุนูู ุชุนููู ุฎุฏูุงุช DNS (Yandex.DNS / SkyDNS / AdGuard DNS) ุจุดูู ูุฑุฏู ููุนููุงุก ุ ูููู ููููู ุงุณุชุฎุฏุงููุง ุนุงููููุง ูู ุฎูุงู ุฅุนุฏุงุฏุงุช dnsmasq ุฅุฐุง ูุฒู ุงูุฃูุฑ.</u> <br><br><h3 style=";text-align:right;direction:rtl">  1. ุชุซุจูุช ุงูุจุฑุงูุฌ ุงููุงุฒูุฉ ุนูู ุฌูุงุฒ ุงูุชูุฌูู </h3><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">opkg update opkg install mc tor tor-geoip <span class="hljs-built_in"><span class="hljs-built_in">bind</span></span>-dig cron dnsmasq-full ipset iptables</code> </pre> <br>  <b>ููููุฏูุฉ</b> - ูุฏูุฑ ูููุงุช ูุงุฆุฏ ููุชุตู ุงูููู.  ูู ูุทููุจ ููุท ุจุณุจุจ ูุญุฑุฑ mcedit ุงูููุงุณุจ.  ุฅุฐุง ููุช ูุนุชุงุฏูุง ุนูู ุงุณุชุฎุฏุงู ูุญุฑุฑ ูุตูุต ุขุฎุฑ ุ ููุง ูููู ุชุซุจูุช mc. <br>  ุฎุฏูุฉ Tor - Tor. <br>  <b>tor-geoip</b> - ูุงุนุฏุฉ ุจูุงูุงุช geo-IP ูู Tor. <br>  <b>ุฑุจุท ุญูุฑ</b> - ุนููู DNS (ุชูุงุธุฑู NSLOOKUP ูุงููุถูู). <br>  <b>ูุฑูู</b> - ุฌุฏููุฉ ุงูููุงู. <br>  <b>dnsmasq-full</b> - ุฎุงุฏู DNS. <br>  ุชุนุฏ <b>ipset ู iptables</b> ุฃุฏูุงุช ูุณุงุนุฏุฉ ููุญุฏุฉ ุงูุชุญูู <b>ipset ู iptables</b> (ูุฏ ุชููู ููุฌูุฏุฉ ุจุงููุนู ุนูู ุงููุธุงู ูููุณุช ููุงู ุญุงุฌุฉ ุฅูููุง ุ ููุฏ ุฃุถูุชูุง ููุฃูุงู). <br><br><h3 style=";text-align:right;direction:rtl">  2. ุชููุฆุฉ ipset ุ ูุฅูุดุงุก ุนุฏุฉ ุนูุงููู IP ุบูุฑ ููููุฉ (100-ipset.sh) </h3><br>  ุชุญูู ูู ุฃู ูุธุงู ุงูููุฌู ุงูุฎุงุต ุจู ูุฏุนู ุงููุซูุฑ ูู ุงูุชุฌุฒุฆุฉ: net (ููุง ุงุชุถุญ ุ ููุณ ูู ุฃุฌูุฒุฉ ุงูุชูุฌูู Keenetic ุชูุชููู): <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">ipset create <span class="hljs-built_in"><span class="hljs-built_in">test</span></span> <span class="hljs-built_in"><span class="hljs-built_in">hash</span></span>:net</code> </pre> <br>  ุฅุฐุง ูู ูุนุท ุงููุฑูู ุฃู ุฃุฎุทุงุก ุฃู ุฑุณุงุฆู ุ ูููุงู ุฏุนู ุ ูุงุชุจุน ุงูุชุนูููุงุช ุฃูุถูุง.  ุฎูุงู ุฐูู (ููุงู ุฎุทุฃ) ูู ุงูุจุฑูุงูุฌ ุงููุตู ุงูุชุงูู ุ ุชุญุชุงุฌ ุฅูู ุงุณุชุจุฏุงู <b>ุงูุชุฌุฒุฆุฉ: net</b> ูุน <b>ุงูุชุฌุฒุฆุฉ: ip</b> .  ูู ูุฐู ุงูุญุงูุฉ ุ ุณุชููุฏ ุงููุฏุฑุฉ ุนูู ูุชุญ ุงููุทุงู ู CIDR. <br><br>  ูู ุจุฅูุดุงุก ูุฌููุนุฉ ูุงุฑุบุฉ ูู ุงูุนูุงููู ุชุณูู <b>ุฅูุบุงุก ุงูุญุธุฑ</b> ุนูุฏ ุชุดุบูู ุฌูุงุฒ ุงูุชูุฌูู.  ููููุงู ุจุฐูู ุ ูู ุจุฅูุดุงุก ุงูููู <b>/opt/etc/ndm/fs.d/100-ipset.sh</b> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">mcedit /opt/etc/ndm/fs.d/100-ipset.sh</code> </pre> <br>  ุงูุตู (Shift + Insert) ุงููุญุชููุงุช: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/sh [ "$1" != "start" ] &amp;&amp; exit 0 ipset create unblock hash:net -exist exit 0</span></span></code> </pre> <br>  ููุตู ูู ุงููุฎุฒู ุงููุคูุช ุ ุงุณุชุฎุฏู Shift + Insert ุ ูุงุญูุธ - F2 ุ ูุงุฎุฑุฌ - F10. <br><br>  ููุญ ุญููู ุงูุชูููุฐ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">chmod +x /opt/etc/ndm/fs.d/100-ipset.sh</code> </pre> <br><h3 style=";text-align:right;direction:rtl">  3. ุฅุนุฏุงุฏ ุชูุฑ </h3><br>  ุงุญุฐู ูุญุชููุงุช ููู ุชูููู Tor: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">cat /dev/null &gt; /opt/etc/tor/torrc</code> </pre> <br>  ุงูุชุญ ููู ุชูููู Tor: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">mcedit /opt/etc/tor/torrc</code> </pre> <br>  ุงูุตู (Shift + Insert) ุงููุญุชููุงุช: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">User root PidFile /opt/var/run/tor.pid ExcludeExitNodes {RU},{UA},{AM},{KG},{BY} StrictNodes 1 TransPort 192.168.0.1:9141 ExitRelay 0 ExitPolicy reject *:* ExitPolicy reject6 *:* GeoIPFile /opt/share/tor/geoip GeoIPv6File /opt/share/tor/geoip6 DataDirectory /opt/var/lib/tor</code> </pre> <br>  ุฅุฐุง ูุฒู ุงูุฃูุฑ ุ <b>ุงุณุชุจุฏู 192.168.0.1</b> ุจุงูุนููุงู ุงูุฏุงุฎูู ูุฌูุงุฒ ุงูุชูุฌูู (LAN).  ูุตู ููุฌุฒ ุงูุชูููู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุงุณุชุจุนุงุฏ ุนูุฏ ุงูุฅุฎุฑุงุฌ: ุฑูุณูุง ุ ุฃููุฑุงููุง ุ ุฃุฑููููุง ููุฑุบูุฒุณุชุงู ุ ุฑูุณูุง ุงูุจูุถุงุก. </li><li style=";text-align:right;direction:rtl">  ูู ุจุชุนููู ูููู ุดูุงู ุฅูู ุงูุนููุงู 192.168.0.1 ุ ุงููููุฐ 9141. </li><li style=";text-align:right;direction:rtl">  ุฑูุถ ุฃู ุชููู ููุทุฉ ุฎุฑูุฌ. </li></ul><br><h3 style=";text-align:right;direction:rtl">  4. ูุงุฆูุฉ ุงููุฌุงูุงุช (ูููุณ ููุท) ูุชุฌุงูุฒ ุงูููู (unlock.txt) </h3><br>  ูุนุฏ ููู unlock.txt ูุงุฆูุฉ ุจุณูุทุฉ ููุชุญูุง.  ููููู ูุชุญ ูุทุงู ุฃู ุนููุงู IP ุฃู ูุทุงู ุฃู CIDR.  ุณุทุฑ ูุงุญุฏ - ุนูุตุฑ ูุงุญุฏ.  ูุชู ุชุฌุงูู ุงูุฃุณุทุฑ ุงููุงุฑุบุฉ (ุจูุง ูู ุฐูู ุงููุณุงูุงุช ูุนูุงูุงุช ุงูุชุจููุจ).  ููููู ุงุณุชุฎุฏุงู ุงูุญุฑู # ูู ุจุฏุงูุฉ ุงูุณุทุฑ ูุชุฌุงููู. <br><br>  ูู <b>ุจุฅูุดุงุก</b> ุงูููู <b>/opt/etc/unblock.txt</b> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">mcedit /opt/etc/unblock.txt</code> </pre> <br>  ูููู ุฃู ูุญุชูู ูู ุตู ุนูู ุงุณู ูุฌุงู ุฃู ุนููุงู IP ุฃู ูุทุงู ุฃู CIDR.  ููููู ุงุณุชุฎุฏุงู ุงูุญุฑู # ููุชุนููู ุนูู ุงูุฃุณุทุฑ. <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ููุง ูุซุงู ุนูู ูููู ุงูุดุฎุตู</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">###- rutracker.org rutor.info rutor.is mega-tor.org kinozal.tv nnm-club.me nnm-club.ws tfile.me tfile-home.org tfile1.cc megatfile.cc megapeer.org megapeer.ru tapochek.net tparser.org tparser.me rustorka.com uniongang.tv fast-torrent.ru ###    rezka.ag hdrezka.ag hdrezka.me filmix.co filmix.cc seasonvar.ru ### lib.rus.ec flibusta.is flibs.me flisland.net flibusta.site ### telegram.org tdesktop.com tdesktop.org tdesktop.info tdesktop.net telesco.pe telegram.dog telegram.me t.me telegra.ph web.telegram.org desktop.telegram.org updates.tdesktop.com venus.web.telegram.org flora.web.telegram.org vesta.web.telegram.org pluto.web.telegram.org aurora.web.telegram.org 149.154.160.0/20 91.108.4.0/22 91.108.8.0/22 91.108.12.0/22 91.108.16.0/22 91.108.56.0/22 109.239.140.0/24 67.198.55.0/24 ### 7-zip.org edem.tv 4pna.com 2019.vote ### Tor check.torproject.org ###   IP ( #   ) #195.82.146.214 ###   CIDR ( #   ) #103.21.244.0/22 ###    ( #   ) #100.100.100.200-100.100.100.210</span></span></code> </pre> <br></div></div><br><h3 style=";text-align:right;direction:rtl">  5. ูุต ุจุฑูุฌู ูููุก ูุฌููุนุฉ ูู ุนูุงููู IP ุบูุฑ ุงููุญุธูุฑุฉ ููุงุฆูุฉ ูุนููุฉ ูู ุงููุฌุงูุงุช (unlock_ipset.sh) </h3><br>  ูู <b>ุจุฅูุดุงุก</b> ุงูุจุฑูุงูุฌ ุงููุตู <b>/opt/bin/unblock_ipset.sh</b> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">mcedit /opt/bin/unblock_ipset.sh</code> </pre> <br>  ุงูุตู (Shift + Insert) ุงููุญุชููุงุช: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/sh until ADDRS=$(dig +short google.com @localhost) &amp;&amp; [ -n "$ADDRS" ] &gt; /dev/null 2&gt;&amp;1; do sleep 5; done while read line || [ -n "$line" ]; do [ -z "$line" ] &amp;&amp; continue [ "${line:0:1}" = "#" ] &amp;&amp; continue cidr=$(echo $line | grep -Eo '[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/[0-9]{1,2}') if [ ! -z "$cidr" ]; then ipset -exist add unblock $cidr continue fi range=$(echo $line | grep -Eo '[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}-[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}') if [ ! -z "$range" ]; then ipset -exist add unblock $range continue fi addr=$(echo $line | grep -Eo '[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}') if [ ! -z "$addr" ]; then ipset -exist add unblock $addr continue fi dig +short $line @localhost | grep -Eo '[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}' | awk '{system("ipset -exist add unblock "$1)}' done &lt; /opt/etc/unblock.txt</span></span></code> </pre> <br>  ููุญ ุญููู ุงูุชูููุฐ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">chmod +x /opt/bin/unblock_ipset.sh</code> </pre> <br>  ุงููุต ุงูุจุฑูุฌู ุจุณูุท ููุบุงูุฉ ุ ููุฐุง ูู ุฌููุฑ ุนููู ... ูุญู ูู ุงูุชุธุงุฑ ุฃู ูุนูู ุญู ูุทุงู google.com (ุฅุฐุง ูู ูุชู ุฐูู ุ ููู ูุชู ููุก ุงููุซูุฑ ูู ุนูููุงุช ุฅูุบุงุก ุงูุญุธุฑ ุนูุฏ ุชุดุบูู ุฌูุงุฒ ุงูุชูุฌูู ุ ูุฃู ุฌูุงุฒ ุงูุชูุฌูู ุณูุธู ููุฏ ุงูุชููุฆุฉ).  ููุฑุฃ ุงูุฃุณุทุฑ ูู ููู unlock.txt.  ุชููู ุฃุณุทุฑ ุงููุฑุงุกุฉ ุจุญุฐู ุงููุณุงูุงุช ูุนูุงูุงุช ุงูุชุจููุจ ุชููุงุฆููุง ูู ุงูุจุฏุงูุฉ ูุงูููุงูุฉ.  ุชุฎุทู ุงูุฃุณุทุฑ ุงููุงุฑุบุฉ.  ุชุฎุท ุงูุฃุณุทุฑ ุงูุชู ุชุจุฏุฃ ุจุญุฑู #.  ูุญู ูุจุญุซ ูู ุณุทุฑ CIDR.  ุฅุฐุง ุชู ุงูุนุซูุฑ ุนูู CIDR ุ ูุฃุถูู ุฅูู ุฅูุบุงุก ุงูุญุธุฑ.  ูุญู ูุจุญุซ ุนู ูุทุงู ูู ุงูุณูุณูุฉ.  ุฅุฐุง ุชู ุงูุนุซูุฑ ุนูููุง ุ ูุฃุถููุง ุฅูู ุฅูุบุงุก ุงูุญุธุฑ.  ูุญู ูุจุญุซ ุนู ุนููุงู IP ูู ุงูุณูุณูุฉ.  ุฅุฐุง ุชู ุงูุนุซูุฑ ุนูู IP ุ ูุฃุถูู ูุฅูุบุงุก ุงูุญุธุฑ.  ุฏุนููุง ุญู ุฎุท ูู ุฎูุงู ุญูุฑ.  ุชุชู ุฅุถุงูุฉ ุฌููุน ุนูุงููู IP ูููุชูุฌุฉ ุฅูู ุฅูุบุงุก ุงูุญุธุฑ. <br><br><h3 style=";text-align:right;direction:rtl">  6. ุจุฑูุงูุฌ ูุตู ูุฅูุดุงุก ููู ุชูููู dnsmasq ุฅุถุงูู ูู ูุงุฆูุฉ ูุฌุงูุงุช ูุนููุฉ (unlock_dnsmasq.sh) </h3><br>  ูู <b>ุจุฅูุดุงุก</b> ุงูุจุฑูุงูุฌ ุงููุตู <b>/opt/bin/unblock_dnsmasq.sh</b> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">mcedit /opt/bin/unblock_dnsmasq.sh</code> </pre> <br>  ุงูุตู (Shift + Insert) ุงููุญุชููุงุช: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/sh cat /dev/null &gt; /opt/etc/unblock.dnsmasq while read line || [ -n "$line" ]; do [ -z "$line" ] &amp;&amp; continue [ "${line:0:1}" = "#" ] &amp;&amp; continue echo $line | grep -Eq '[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}' &amp;&amp; continue echo "ipset=/$line/unblock" &gt;&gt; /opt/etc/unblock.dnsmasq done &lt; /opt/etc/unblock.txt</span></span></code> </pre> <br>  ููุญ ุญููู ุงูุชูููุฐ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">chmod +x /opt/bin/unblock_dnsmasq.sh</code> </pre> <br>  ุงูุจุฑูุงูุฌ ุงููุตู ุจุณูุท ููุบุงูุฉ.  ููุฑุฃ ุงูุฃุณุทุฑ ุจุงูุชุชุงุจุน ูู /opt/etc/unblock.txt.  ุชููู ุฃุณุทุฑ ุงููุฑุงุกุฉ ุจุญุฐู ุงููุณุงูุงุช ูุนูุงูุงุช ุงูุชุจููุจ ุชููุงุฆููุง ูู ุงูุจุฏุงูุฉ ูุงูููุงูุฉ.  ุชุฎุทู ุงูุฃุณุทุฑ ุงููุงุฑุบุฉ.  ุชุฎุทู ุงูุฎุทูุท ุงูุชู ุชุจุฏุฃ ุจู #.  ุชุฎุทู ุงูุฎุทูุท ุงูุชู ุชุญุชูู ุนูู ุนููุงู IP (IP ุฃู CIDR) ุ ุฃู  ูุญู ููุชููู ููุท ุจุงูุณูุงุณู ูุน ุฃุณูุงุก ุงููุทุงูุงุช.  ูู ุงูููู /opt/etc/unblock.dnsmasq ูุถูู ุฃุณุทุฑูุง ูู ุงููููุฐุฌ "ipset = / domain_name / unlock".  ูุฐุง ูุนูู ุฃูู ุจุนุฏ ุชุญุฏูุฏ ุนูุงููู IP ุงูุฎุงุตุฉ ุจูุฌุงู ูุนูู ุ ุณุชุชู ุฅุถุงูุชูุง ุชููุงุฆููุง ุฅูู ูุฌููุนุฉ ุฅูุบุงุก ุงูุญุธุฑ. <br><br>  ุชุฃูุฏ ูู ุชุดุบูู ุงูุจุฑูุงูุฌ ุงููุตู ูุฅูุดุงุก ููู unlock.dnsmasq: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">unblock_dnsmasq.sh</code> </pre> <br>  ุชุญูู ูู ุฅูุดุงุก ููู unlock.dnsmasq: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">cat /opt/etc/unblock.dnsmasq</code> </pre> <br><h3 style=";text-align:right;direction:rtl">  7. ุงูุจุฑูุงูุฌ ุงููุตู ููุชุญุฏูุซ ุงูุฅุฌุจุงุฑู ูููุธุงู ุจุนุฏ ุชุญุฑูุฑ ูุงุฆูุฉ ุงููุฌุงูุงุช (unlock_update.sh) </h3><br>  ูู <b>ุจุฅูุดุงุก</b> ุงูุจุฑูุงูุฌ ุงููุตู <b>/opt/bin/unblock_update.sh</b> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">mcedit /opt/bin/unblock_update.sh</code> </pre> <br>  ุงูุตู (Shift + Insert) ุงููุญุชููุงุช: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/sh ipset flush unblock /opt/bin/unblock_dnsmasq.sh /opt/etc/init.d/S56dnsmasq restart /opt/bin/unblock_ipset.sh &amp;</span></span></code> </pre> <br>  ููุญ ุญููู ุงูุชูููุฐ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">chmod +x /opt/bin/unblock_update.sh</code> </pre> <br><h3 style=";text-align:right;direction:rtl">  8. ุจุฑูุงูุฌ ูุตู ูุชุนุจุฆุฉ ูุฌููุนุฉ ูู ุนูููุงุช ุฅูุบุงุก ุงูุญุธุฑ ุชููุงุฆููุง ุนูุฏ ุชุดุบูู ุฌูุงุฒ ุชูุฌูู (S99unblock) </h3><br>  ูู <b>ุจุฅูุดุงุก</b> ุงูุจุฑูุงูุฌ ุงููุตู <b>/opt/etc/init.d/S99unblock</b> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">mcedit /opt/etc/init.d/S99unblock</code> </pre> <br>  ุงูุตู (Shift + Insert) ุงููุญุชููุงุช: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/sh [ "$1" != "start" ] &amp;&amp; exit 0 /opt/bin/unblock_ipset.sh &amp;</span></span></code> </pre><br>  ููุญ ุญููู ุงูุชูููุฐ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">chmod +x /opt/etc/init.d/S99unblock</code> </pre> <br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 9. ุฅุนุงุฏุฉ ุชูุฌูู ุงูุญุฒู ุฐุงุช ุงููุฌูุงุช ูู ุฅูุบุงุก ุงูุญุธุฑ ุฅูู Tor (100-redirect.sh) </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููููุงู ุจุฐูู ุ ูู ุจุฅูุดุงุก ุงูููู </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/opt/etc/ndm/netfilter.d/100-redirect.sh</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">mcedit /opt/etc/ndm/netfilter.d/100-redirect.sh</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงูุตู (Shift + Insert) ุงููุญุชููุงุช: </font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/sh [ "$type" == "ip6tables" ] &amp;&amp; exit 0 if [ -z "$(iptables-save 2&gt;/dev/null | grep unblock)" ]; then ipset create unblock hash:net -exist iptables -w -t nat -A PREROUTING -i br0 -p tcp -m set --match-set unblock dst -j REDIRECT --to-port 9141 fi exit 0</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅุฐุง ุงุณุชุฎุฏูุช </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุชุฌุฒุฆุฉ: ip</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูู ุงูุฎุทูุฉ 2 </font><font style="vertical-align: inherit;">ูููุณ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุชุฌุฒุฆุฉ: net</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ ูุงุณุชุจุฏู ุงูุชุฌุฒุฆุฉ: net ุจุงูุชุฌุฒุฆุฉ: ip. ูู ุงููุงูุน ุ ูููู ุฃูุถูุง ุจุชูุฑุงุฑ ูุธููุฉ ุฅูุดุงุก ูุฌููุนุฉ ูู ุฅูุบุงุก ุงูุญุธุฑ ูู ุฎุทูุชูู. ูุนุฏ ุฐูู ุถุฑูุฑููุง ููุฃูุงู ุ ุฅุฐุง ูู ุชุจุฏุฃ ุงูุจุฑุงูุฌ ุงููุตูุฉ ูู fs.d ูู ุงูุชุดุบูู ุ ููุงูุช ุงูุจุฑุงูุฌ ุงููุตูุฉ netfilter.d ููุฏ ุงูุชุดุบูู ุจุงููุนู. ูุง ุจุฃุณ ุฅุฐุง ุชู ุฅูุบุงุก ุญุธุฑ ุจุงููุนู ูู ููุช ุณุงุจู ุ ุณูุชู ุจุจุณุงุทุฉ ุชุฌุงูู ุงูุฃูุฑ. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููููู ุฅุถุงูุฉ (ูุฐุง ุงุฎุชูุงุฑู) ุฅูู ููุณ ุงูููู ูุฅุนุงุฏุฉ ุชูุฌูู ุฌููุน ุงูุทูุจุงุช ุฅูู ุงููููุฐ ุงูุฎุงุฑุฌู 53 ูููุณู. ูุนุฏ ุฐูู ุถุฑูุฑููุง ุญุชู ูุง ูุณุชุฎุฏู ุงูุนููุงุก ุนูู ุงูุดุจูุฉ ุงููุญููุฉ ุฎุฏูุงุช DNS ุงูุฎุงุตุฉ ุจุฌูุฉ ุฎุงุฑุฌูุฉ. ุณุชูุฑ ุงูุทูุจุงุช ุนุจุฑ ุฎุงุฏู DNS ุงูุนุงุฏู. ูุจู ุงููุฎุฑุฌ ุงูุฃุฎูุฑ ุ ุฃุถู:</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> [ -z <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$(iptables-save 2&gt;/dev/null | grep "udp \-\-dport 53 \-j DNAT")</span></span></span><span class="hljs-string">"</span></span> ]; <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> iptables -w -t nat -I PREROUTING -i br0 -p udp --dport 53 -j DNAT --to 192.168.0.1 <span class="hljs-keyword"><span class="hljs-keyword">fi</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> [ -z <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$(iptables-save 2&gt;/dev/null | grep "tcp \-\-dport 53 \-j DNAT")</span></span></span><span class="hljs-string">"</span></span> ]; <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> iptables -w -t nat -I PREROUTING -i br0 -p tcp --dport 53 -j DNAT --to 192.168.0.1 <span class="hljs-keyword"><span class="hljs-keyword">fi</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅุฐุง ูุฒู ุงูุฃูุฑ ุ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงุณุชุจุฏู 192.168.0.1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุจุงูุนููุงู ุงูุฏุงุฎูู ูุฌูุงุฒ ุงูุชูุฌูู (LAN). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุญ ุญููู ุงูุชูููุฐ:</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">chmod +x /opt/etc/ndm/netfilter.d/100-redirect.sh</code> </pre> <br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 10. ุชูููู dnsmasq ูุฅุฑูุงู ููู ุชูููู ุฅุถุงูู ุฅูู dnsmasq </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุญุฐู ูุญุชููุงุช ููู ุชูููู dnsmasq: </font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">cat /dev/null &gt; /opt/etc/dnsmasq.conf</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงูุชุญ ููู ุชูููู dnsmasq: </font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">mcedit /opt/etc/dnsmasq.conf</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงูุตู (Shift + Insert) ุงููุญุชููุงุช: </font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">user=nobody bogus-priv no-negcache clear-on-reload <span class="hljs-built_in"><span class="hljs-built_in">bind</span></span>-dynamic listen-address=192.168.0.1 listen-address=127.0.0.1 min-port=4096 cache-size=1536 expand-hosts <span class="hljs-built_in"><span class="hljs-built_in">log</span></span>-async conf-file=/opt/etc/unblock.dnsmasq server=8.8.8.8</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅุฐุง ูุฒู ุงูุฃูุฑ ุ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงุณุชุจุฏู 192.168.0.1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุจุงูุนููุงู ุงูุฏุงุฎูู ูุฌูุงุฒ ุงูุชูุฌูู (LAN).</font></font><br><br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 11. ุฅุถุงูุฉ ูููุฉ ุฅูู cron ูุชุญุฏูุซ ูุญุชููุงุช ูุฌููุนุฉ ุฅูุบุงุก ุงูุญุธุฑ ุจุดูู ุฏูุฑู </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุนุฏ ูุฐุง ุชุฃููููุง ุฅุถุงูููุง ูู ุญุงูุฉ ุงุณุชุฎุฏุงู ุงูุจุฑุงูุฌ / ุงูุฃุฌูุฒุฉ ูุทุฑููุฉ ุญู ุฎุงุตุฉ ุจูุง ูุชุบููุฑ ุนููุงู IP ุงูุฎุงุต ุจุงููุฌุงู. </font><font style="vertical-align: inherit;">ูู ูุง ุนููู ูุนูู ูู ุชุดุบูู ุงูุจุฑูุงูุฌ ุงููุตู unlock_ipset.sh ุนูู ุงูุชุฑุฏุฏ ุงููุทููุจ. </font><font style="vertical-align: inherit;">ุนูู ุณุจูู ุงููุซุงู ุ ุณูุทูู ูู ููู ุงูุณุงุนุฉ 6 ุตุจุงุญูุง. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุชุญ ุงูููู </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ opt / etc / crontab</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูู ุงููุญุฑุฑ </font><font style="vertical-align: inherit;">:</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">mcedit /opt/etc/crontab</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุฃุถู ูู ุงูููุงูุฉ: </font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">00 06 * * * root /opt/bin/unblock_ipset.sh</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅุฐุง ููุช ุชุฑุบุจ ูู ุฐูู ุ ููููู ุงูุชุนููู ุนูู ุฌููุน ููุงู ุงููุงูุจ ุงูุฃุฎุฑู. </font><font style="vertical-align: inherit;">ุฅููู ูุง ุณูุจุฏู ุนููู ููู crontab:</font></font><br><br><img src="https://habrastorage.org/webt/le/y5/sl/ley5slcvjfvs-9odj9air9qdd8s.png"><br><br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 12. ุชุนุทูู ุฎุงุฏู DNS ุงูุนุงุฏู ูุฅุนุงุฏุฉ ุชุดุบูู ุฌูุงุฒ ุงูุชูุฌูู </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงุชุตู ุจู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Keenetic Router CLI</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (ูููุฐ 23 ูู Telnet ู 22 ูู SSH ุฅุฐุง ุชูุช ุฅุถุงูุฉ ูููู "ุฎุงุฏู SSH" ุฅูู ุงููุธุงู). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ุจุชุดุบูู ุงูุฃูุฑ:</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">opkg dns-override system configuration save system reboot</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุณูุชู ุฅููุงู ุชุดุบูู ุฎุงุฏู DNS ุงููุถูู ูู ุงูุจุฑูุงูุฌ ุงูุซุงุจุช ุ ูุณูุชู ุงุณุชุฎุฏุงู dnsmasq ูู Entware ุจุฏูุงู ูู ุฐูู. </font><font style="vertical-align: inherit;">ูุชุญูู ุงูููุฌู ุ ุนูุฏ ุงูุชูููุฏ ุ ููุง ุฅุฐุง ูุงู ุงููุฌูุฏ ุงูุงุฎุชูุงุฑู ูุซุจุชูุง (ูู ููุฌุฏ ูุญุฑู ุฃูุฑุงุต USB ูุญููู / ูุญุฑู ุฃูุฑุงุต ูุน Entware). </font><font style="vertical-align: inherit;">ุฅุฐุง ูุงู ููุงู ุ ููู ูุชู ุงุณุชุฎุฏุงู ุฎุงุฏู DNS ุนุงุฏู. </font><font style="vertical-align: inherit;">ุฅุฐุง ูู ููู ูุฐูู ุ ุงุณุชุฎุฏู.</font></font> ุนูู ุณุจูู ุงููุซุงู<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅุฒุงูุฉ ูุญุฑู ุงูุฃูุฑุงุต ุงููุญููู ูุฅุนุงุฏุฉ ุชุดุบูู ุฌูุงุฒ ุงูุชูุฌูู ุ ุณูุนูู ูู ุดูุก ุจุงููุณุจุฉ ูู ุ ููุง ูุงู ูู ูุจู (ูุจู ุงูุฅุนุฏุงุฏ). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุนุฏ ุฅุนุงุฏุฉ ุงูุชุดุบูู ุ ุงูุชุญ ูููุน check.torproject.org ูู ูุชุตูุญู (ูุฌุจ ุฅุถุงูุชู ุฅูู unlock.txt). </font><font style="vertical-align: inherit;">ุฅุฐุง ูุนูุช ูู ุดูุก ุจุดูู ุตุญูุญ ุ ูุณุชุฑู ุงูููุด "ุชูุงูููุง. </font><font style="vertical-align: inherit;">ุชู ุชูููู ูุฐุง ุงููุชุตูุญ ูุงุณุชุฎุฏุงู Tor. ":</font></font><br><br><img src="https://habrastorage.org/webt/wa/19/dz/wa19dzxbu8qtldwrvkeijfqna7q.png"><br><br><br><a name="con31"></a><h1 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงูุทุฑู ุงูุฃุณุงุณูุฉ ูุชุดุฎูุต ุงูุฃุฎุทุงุก ุจุนุฏ ุงูุชูููู </font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ุญุงูุฉ ูุฌุงุญ ุงูุชุญูู ุจุงุณุชุฎุฏุงู ุงููููุน check.torproject.org (ูุฌุจ ุฅุถุงูุชู ุฅูู unlock.txt) ุ ูููู ูุณุชูุฑ ูุนุจ ุงูุฑูุชูู ูู ุงููููุฑ ูู ูุชุญ ุงูููุงุฑุฏ ุงูุฃุฎุฑู (ุฃู ูุง ููุชุญ) ุ ููู ุงููุฑุฌุญ ุฃู ูุชุฏุฎู ุงููููุฑ ูู ุญุฑูุฉ ูุฑูุฑ DNS ุ ููุญู ูุญู ุงูุฅุฌุงุจุงุช - ุฃูุช ุชุญุชุงุฌ ุฅูู ุฅุฌุฑุงุก ุชุฌุงูุฒ ุฅุถุงูู ูุชุตููุฉ ุงุณุชุนูุงูุงุช DNS. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅุฐุง ูู ูุนูู ุดูุก ูุง ุจุนุฏ ุงูุชูููู ููุง ููุจุบู ุ ูุงุณุชุฎุฏู ุฃูุงูุฑ ุจุณูุทุฉ ูุชุญุฏูุฏ ุฎุทูุฉ ุงููุดููุฉ. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุนุฑุถ ูุญุชููุงุช ูุฌููุนุฉ ุงูููุน:</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">ipset list unblock</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅุฐุง ุฃุจูุบ ุงููุธุงู ุนู ุนุฏู ูุฌูุฏ ูุซู ูุฐู ุงููุฌููุนุงุช ุ ูุณูููู ุงูุฎุทุฃ ูู ุงูุฎุทูุฉ 2 ุฃู ุฃูู ูู ุชูู ุจุชูููู ูุญุฏุฉ Netfilter ูู ุงููุธุงู (ูู ุญุงูุฉ Keenetic). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅุฐุง ุชุจูู ุฃู ุงููุฌููุนุฉ ูุงุฑุบุฉ ุ ููู ูุนูู ุงูุจุฑูุงูุฌ ุงููุตู unlock_ipset.sh ุ ูุงูุฐู ุจุฏูุฑู ูุฌุจ ุฃู ูุจุฏุฃ ุจูุงุณุทุฉ ุงูุจุฑูุงูุฌ ุงููุตู ูุจุฏุก ุชุดุบูู S99unblock. ูู ุจุชุดุบูู ูุฐุง ุงูุจุฑูุงูุฌ ุงููุตู unlock_ipset.sh ูุฏูููุง. ุฅุฐุง ูุงูุช ุงููุฌููุนุฉ ููุชูุฆุฉ ุ ูููู ุงูุฎุทุฃ ูู ุงูุฎุทูุฉ 8. ุฅุฐุง ูู ููู ูู ุงููููู ุชูููุฐ ุงูุจุฑูุงูุฌ ุงููุตู (ุนูู ุงูุฃุฑุฌุญ ุ ูุฅูู ููุชุธุฑ ุฏูุฉ google.com) ุ ูุฅู ุงูุฎุทุฃ ูู ููุงู ูุง ุนูู ุฌุงูุจ ุฎุงุฏู DNS ุ ุฑุจูุง ูู ุงูุฎุทูุฉ 10 ุฃู 6. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุญูู ูู ุฅุนุงุฏุฉ ุงูุชูุฌูู ูู iptables :</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">iptables-save 2&gt;/dev/null | grep unblock</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅุฐุง ูู ููู ููุฌูุฏูุง ุ ูุฅู ุงูุฎุทุฃ ูููู ูู ุงูุฎุทูุฉ 9. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅุฐุง ูู ุชุนูู ุฌููุน ุงูููุงูุน ุนูู ุงูุฅุทูุงู ุ ุฃู </font><font style="vertical-align: inherit;">DNS ูุง ูุนูู ุ ุงูุฎุทุฃ ูู ููุงู ูุง ูู ุงููุฑุญูุฉ 6 ุฃู 10. ุฑุจูุง ุ ูู ุงููุฑุญูุฉ 9. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅุฐุง ูู ุชุนูู ุฌููุน ุงูููุงูุน ูู unlock.txt (ุชู ุชุฌุงูุฒ ุงููููุฉ) ุ ููู ุฌููุน ุงูููุงูุน ุงูุฃุฎุฑู ุชุนูู ุ ูุฅู ุงููุดููุฉ ุชููู ูู ููุงู ูุง ุนูู ุฌุงูุจ Tor ุ ุงูุฎุทุฃ ูู ุงููุฑุญูุฉ 3.</font></font><br><br><br><a name="con4"></a><h1 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุชุฌุงูุฒ ุฅุถุงูู ูุชุตููุฉ ุงุณุชุนูุงูุงุช DNS ูู ูุจู ุงููููุฑ </font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅุฐุง ุชุฏุงุฎู ูููุฑ ูุน ุญุฑูุฉ ูุฑูุฑ DNS ุนู ุทุฑูู ุงุณุชุจุฏุงู ุงูุงุณุชุฌุงุจุงุช ููููุงุฑุฏ ุงููุญุธูุฑุฉ ุ ููู ุงูุณูู ุฌุฏูุง ุงูุชููู. </font><font style="vertical-align: inherit;">ููุฐุง ุณูู ูุณุชุฎุฏู dnscrypt-proxy. </font><font style="vertical-align: inherit;">ุฅุฐุง ููุช ุชุฑุบุจ ูุชุฌุฑุจุฉ ุ ููููู ุจุณูููุฉ ุงุณุชุจุฏุงู dnscrypt ุจู ูุตูุฑ (DNS ุนุจุฑ TLS). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ูุชู ุงุณุชุฎุฏุงู dnscrypt ุฅูุง ูู ุงููุฌุงูุงุช ุงููุฏุฑุฌุฉ ูู ููู unlock.txt. </font><font style="vertical-align: inherit;">ุณุชูุฑ ุฌููุน ุงูุงุณุชุนูุงูุงุช ุงูุฃุฎุฑู ุนุจุฑ ุฎูุงุฏู DNS ุงูุนุงุฏูุฉ. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅุฐุง ููุช ูุชุฃูุฏูุง ูู ุฃู ูููุฑ ุงูุฎุฏูุฉ ุงูุฎุงุต ุจู ูุง ูููู ุจุชุตููุฉ ุงุณุชุนูุงูุงุช DNS ุ ููู ุชุญุชุงุฌ ุฅูู ุงูููุงู ุจูุฐุง ุงูุชูููู ุงูุฅุถุงูู. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฌุจ ุฃู ุชููู ูุฏ ููุช ุจุงููุนู ุจุชููุฆุฉ ุชุฌุงูุฒ ุงูุฃููุงู ุงูููุถุญุฉ ุฃุนูุงู. </font><font style="vertical-align: inherit;">ุงูุฅุนุฏุงุฏุงุช ุงูุชุงููุฉ ููุงุซูุฉ ููุธุงูู Padavan ู Keenetic OS. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุซุจูุช ุจุฑูุงูุฌ ุฅุถุงูู ุนูู ุฌูุงุฒ ุงูุชูุฌูู:</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">opkg update opkg install dnscrypt-proxy2</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงูุชุญ ููู ุชูููู dnscrypt-proxy: </font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">mcedit /opt/etc/dnscrypt-proxy.toml</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงุจุญุซ ุนู ุนูุงููู Listen_addresses ู fallback_resolver ู cache ููู ุจุชุบููุฑูุง: </font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">listen_addresses = [<span class="hljs-string"><span class="hljs-string">'127.0.0.1:9153'</span></span>] fallback_resolver = <span class="hljs-string"><span class="hljs-string">'77.88.8.8:1253'</span></span> cache = <span class="hljs-literal"><span class="hljs-literal">false</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">77.88.8.8:1253 ูู ุนููุงู ุฎุงุฏู Yandex DNS ุจูููุฐ ุบูุฑ ููุงุณู. </font><font style="vertical-align: inherit;">ููู ูุณุฎุฉ ุงุญุชูุงุทูุฉ ูู ุญุงูุฉ ูุฌูุฏ ุฃู ูุดุงูู ูู dnscrypt-proxy. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุดุบูู dnscrypt-proxy:</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">/opt/etc/init.d/S09dnscrypt-proxy2 start</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุชุฃูุฏ ูู ุนูู dnscrypt-proxy (ูุฌุจ ุฃู ุชุดุงูุฏ ูุงุฆูุฉ ุจุนูุงููู IP ูู ุงูุฑุฏ): </font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">dig +short google.com @localhost -p 9153</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุชุญ ุงูุจุฑูุงูุฌ ุงููุตู </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/opt/bin/unblock_ipset.sh</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูู ุงููุญุฑุฑ </font><font style="vertical-align: inherit;">:</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">mcedit /opt/bin/unblock_ipset.sh</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงุณุชุจุฏุงู ุงููุญุชููุงุช ุจู: </font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/sh until ADDRS=$(dig +short google.com @localhost -p 9153) &amp;&amp; [ -n "$ADDRS" ] &gt; /dev/null 2&gt;&amp;1; do sleep 5; done while read line || [ -n "$line" ]; do [ -z "$line" ] &amp;&amp; continue [ "${line:0:1}" = "#" ] &amp;&amp; continue cidr=$(echo $line | grep -Eo '[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/[0-9]{1,2}') if [ ! -z "$cidr" ]; then ipset -exist add unblock $cidr continue fi range=$(echo $line | grep -Eo '[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}-[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}') if [ ! -z "$range" ]; then ipset -exist add unblock $range continue fi addr=$(echo $line | grep -Eo '[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}') if [ ! -z "$addr" ]; then ipset -exist add unblock $addr continue fi dig +short $line @localhost -p 9153 | grep -Eo '[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}' | awk '{system("ipset -exist add unblock "$1)}' done &lt; /opt/etc/unblock.txt</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุฏ ุฃุฌุฑููุง ุชุบููุฑูุง ุจุณูุทูุง - ุงูุขู ุญูุฑ ูุญููุง ูุง ูุณุชุฎุฏู ุฎุงุฏู DNS ุนุงุฏู ุ ูููู dnscrypt-proxy ูุน ุงููููุฐ 9153. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุชุญ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/opt/bin/unblock_dnsmasq.sh</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงูุจุฑูุงูุฌ ุงููุตู ูู ุงููุญุฑุฑ </font><font style="vertical-align: inherit;">:</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">mcedit /opt/bin/unblock_dnsmasq.sh</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงุณุชุจุฏุงู ุงููุญุชููุงุช ุจู: </font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/sh cat /dev/null &gt; /opt/etc/unblock.dnsmasq while read line || [ -n "$line" ]; do [ -z "$line" ] &amp;&amp; continue [ "${line:0:1}" = "#" ] &amp;&amp; continue echo $line | grep -Eq '[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}' &amp;&amp; continue echo "ipset=/$line/unblock" &gt;&gt; /opt/etc/unblock.dnsmasq echo "server=/$line/127.0.0.1#9153" &gt;&gt; /opt/etc/unblock.dnsmasq done &lt; /opt/etc/unblock.txt</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุฏ ูููุง ุจุชุบููุฑ ุจุณูุท - ุงูุขู ุนูุฏ ุฅูุดุงุก ููู unlock.dnsmasq ุ ุชุชู ุฅุถุงูุฉ ุฎุทูุท ุฅุถุงููุฉ ูุซู "server = / domain_name / 127.0.0.1 # 9153". </font><font style="vertical-align: inherit;">ูุฐุง ูุนูู ุฃู ุญู ุงููุทุงูุงุช ูู ุงููุงุฆูุฉ ุณูุญุฏุซ ูู ุฎูุงู dnscrypt-proxy. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ุจุชุดุบูู unlock_update.sh:</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">unblock_update.sh</code> </pre> <br>  ุชู.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฌููุน ุงูุฅุนุฏุงุฏุงุช ุงููุนูุฏุฉ ูุชุฃุฎุฑุฉ. </font><font style="vertical-align: inherit;">ุงูุขู ุณุชููู ููุท ุจุชุญุฑูุฑ ูุงุฆูุฉ unlock.txt ุฅุฐุง ูุฒู ุงูุฃูุฑ ุ ูุฅุถุงูุฉ ุฃู ุฅุฒุงูุฉ ุงููุฌุงูุงุช ุฃู ุนูุงููู IP ูุฅูุบุงุก ุงูููู ูููุง ุ ูุชูุดูุท ุงูุชุบููุฑุงุช ุงูุชู ุชู ุฅุฌุฑุงุคูุง ุจุงุณุชุฎุฏุงู ุงูุฃูุฑ unlock_update.sh. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุญุฏูุซ 04/01/2019</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">ุบุงูุจูุง ูุง ุชุฃุชู ุงูุฑุณุงุฆู ุงูุดุฎุตูุฉ ุนูู ุงูููุงูุฉ ุจุฃุณุฆูุฉ ูููุฐุฌูุฉ. </font><font style="vertical-align: inherit;">ุณุฃุฌูุจ ููุง ุงูุฃูุซุฑ ุดููุนูุง. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููููุฉ ุชูููุฑ .onion ููุงูุน ููุทูุฉ ุงููุฌุงูุ </font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ููู torrc ุ ุฃุถู:</font></font><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">VirtualAddrNetwork 10.254.0.0/16 DNSPort 127.0.0.1:9053 AutomapHostsOnResolve 1</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูููุตูู ุฅูู ุฌููุน ูุฌุงูุงุช ููุทูุฉ ุงูุจุตู ุฃุถู ุฅูู dnsmasq.conf: </font></font><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">server=/onion/127.0.0.1<span class="hljs-comment"><span class="hljs-comment">#9053 ipset=/onion/unblock</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุฅุฐุง ููุช ูุง ุชุฑุบุจ ูู ูุชุญ ุงููุตูู ุฅูู ุฌููุน ูุฌุงูุงุช ููุทูุฉ ุงูุจุตู ุ ูููู ููุท ุฅูู ูุฌุงูุงุช ูุนููุฉ ุ ููู ุจุฅุถุงูุฉ ุงูุฅุฏุฎุงูุงุช ุงูุชุงููุฉ ูู dnsmasq.conf: </font></font><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">server=/rutorc6mqdinc4cz.onion/127.0.0.1<span class="hljs-comment"><span class="hljs-comment">#9053 ipset=/rutorc6mqdinc4cz.onion/unblock server=/nnmclub5toro7u65.onion/127.0.0.1#9053 ipset=/nnmclub5toro7u65.onion/unblock server=/flibustahezeous3.onion/127.0.0.1#9053 ipset=/flibustahezeous3.onion/unblock</span></span></code> </pre> <br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููููุฉ ุชุฌุงูุฒ ุงูุฃููุงู ูุนููุงุก ุฎุงุฏู VPN ูุนูู ุนูู ุฌูุงุฒ ุชูุฌููุ </font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู torrc ุ ุงุณุชุจุฏู ุงูุฎุท ุจู TransPort ุจูุง ููู:</font></font><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">TransPort 0.0.0.0:9141</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูู ุจุฅุถุงูุฉ ุฅุนุงุฏุฉ ุชูุฌูู ุฅุถุงููุฉ ุจุงุณุชุฎุฏุงู ุงููุงุฌูุฉ ุงูุถุฑูุฑูุฉ (INTERFACE - ูุงุฌูุฉ ุดุจูุฉ VPN): </font></font><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">iptables -t nat -A PREROUTING -i  -p tcp -m <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> --match-set unblock dst -j REDIRECT --to-port 9141</code> </pre> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar428992/">https://habr.com/ru/post/ar428992/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar428982/index.html">ููููุฉ ูุชุงุจุฉ D ุนูู ARM</a></li>
<li><a href="../ar428984/index.html">ุตูุฑ ุฌูููุง ููุฑุงุญู ุงููุธู ุงูุฏููุงููููุฉ</a></li>
<li><a href="../ar428986/index.html">ูุคุชูุฑ ThinkJava ุฑูู 8 ูู ุฎุงุฑููู</a></li>
<li><a href="../ar428988/index.html">ูุตุงุฆุญ ุงูุทุจูุนุฉ - ุถูุก ุงูููู ุงูุบุงุฆู</a></li>
<li><a href="../ar428990/index.html">ุฃูุซูุฉ ุนูู ุชูููู UIViewControllers ุจุงุณุชุฎุฏุงู RouteComposer</a></li>
<li><a href="../ar428994/index.html">ุงูุชูุงุตู ูู Android ุจุงุณุชุฎุฏุงู Corutin ู Retrofit</a></li>
<li><a href="../ar428996/index.html">ูุงุฏู ุณุงูุชุง ูููุฒ ุงููุฌููู 2018-2019 ุนูู ุญุจุฑุงุจุฑ</a></li>
<li><a href="../ar428998/index.html">ููููุฉ ุงุณุชุฎุฏุงู ููุฒุฉ ููู ุงูุชุนุฑูู ุงูุชุฌุฑูุจูุฉ ุงูุฌุฏูุฏุฉ ูู React</a></li>
<li><a href="../ar429000/index.html">ููุงุฐุง ุงุฎุชุฑุน ุจูู ุบูุชุณ ุงููุฑุญุงุถ ุจูุจูุบ 233 ูููุงุฑ ุฏููุงุฑ</a></li>
<li><a href="../ar429006/index.html">ุงูุตูู: "ูุชุฌุฑ ุงูุชุฌููุน ุงูุนุงููู" ููุณ ุจุงูุจุณุงุทุฉ ุงูุชู ูุจุฏู ุนูููุง</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>