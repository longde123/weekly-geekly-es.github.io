<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üóÑÔ∏è üë®üèø‚ÄçüöÄ ü•Å Blazor: Wie verhindert man, dass eine Komponente krank wird, oder wie trennt man Code vom Markup? üéÖüèΩ ü§î üèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ich denke, jeder Entwickler, als er zu einem neuen Projekt kam, dachte, dass es sch√∂n w√§re, in die Vergangenheit zu reisen und den V√§tern Ihres Projek...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Blazor: Wie verhindert man, dass eine Komponente krank wird, oder wie trennt man Code vom Markup?</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/484822/"><p>  Ich denke, jeder Entwickler, als er zu einem neuen Projekt kam, dachte, dass es sch√∂n w√§re, in die Vergangenheit zu reisen und den V√§tern Ihres Projekts mitzuteilen, dass die Muster nicht nur beim Interview abgefragt werden sollten, sondern auch f√ºr das eigentliche Projekt, aber ich im Ernst. </p><br><p>  Insbesondere ist dies wahrscheinlich ein Muster, aber eine sehr gute Regel ist, dass das Markup vom Code getrennt werden muss.  Dies gilt f√ºr die guten alten Web Forms, Asp.Net MVC - schreibt noch jemand Markup auf Razor?), Und Angular ist in einem rauen Unternehmen beliebt. </p><br><p>  Wenn Sie schon lange keine Hoffnungslosigkeit mehr in Bezug auf die Front der Ender mehr haben und auf die neuen Angular and React-Modelle umsteigen, dann ... </p><a name="habracut"></a><br><p>  Ja, meine Herren, die Backend-Entwickler, wir hatten wieder die Hoffnung, dass das √ºber die Jahre erworbene Wissen nicht im Kopf verloren geht.  Und diese Hoffnung ist die Blazor-Technologie von Microsoft. <br>  Nachdem ich das Standardprojekt ge√∂ffnet hatte, das das Studio beim Erstellen des Blazor-Projekts erstellt hatte, und dann mehrere Artikel angesehen hatte, schlich ich mich in den Gedanken, dass wirklich alles so schlecht ist und der Code und das Markup immer in der gleichen Datei sind, wie hier (im Folgenden werden alle Beispiele basierend auf gezeigt) Blazor Server App-Vorlagenprojekt aus Visual Studio 2019 mit installiertem .Net Core 3.1): </p><br><p><img src="https://habrastorage.org/webt/fz/uk/bn/fzukbn53judeqzxrqg7vim1t8xu.png" alt="Bild"></p><br><p>  Nichts verwirrt hier? </p><br><p>  Meiner Meinung nach hat alles, was mit Rot gef√ºllt ist, wenig mit dem Inhalt zu tun, den diese Komponente darstellt, und Sie m√ºssen ihn loswerden.  Warum? </p><br><ol><li>  Nun, erstens wird der Front-End-Entwickler, der gleichzeitig mit Ihnen an diesem Steuerelement arbeitet, ein wenig durch Symbole verwirrt sein, die f√ºr ihn unverst√§ndlich sind, und jedes Mal wird er vorsichtig sein und Ihnen Fragen stellen, wenn er etwas an dem von Razor-Markup eingerahmten Code √§ndern muss . </li><li>  Nat√ºrlich werden Frontender vorsichtig sein, aber Sie werden mit Sicherheit in regelm√§√üigen Abst√§nden feststellen, dass Ihre Seite nach einigen Manipulationen nicht wie erwartet oder einfach nicht funktioniert. </li><li>  Wenn Sie der Meinung sind, dass Front-End-Entwickler nicht ben√∂tigt werden, weil jetzt alles in C # geschrieben werden kann, dann irren Sie sich.  In jedem Fall m√ºssen Sie das Steuerelement stilisieren. Dies erfolgt entweder durch den Front-End-Entwickler oder durch den Schriftsetzer, der h√§ufig nicht wei√ü, was C # ist. </li><li>  Auf den ersten Blick scheint der Code klein zu sein und das Layout nicht sehr zu √ºberfrachten. Es t√§uscht. In einem wachsenden Projekt werden Sie sehr schnell von der B√ºhne aufsteigen und eine Tech-Demo starten, um ‚ÄûVerdammt, was hier passiert‚Äú.  Ich bin oft auf die Tatsache gesto√üen, dass in SQL Web Controls oder direkt auf der .cshtml-Seite eine SQL-Abfrage in die Datenbank gestellt wurde. Ja, ich mache keine Witze.  Sehr oft schreiben erfahrene Entwickler, die Sie gestern in einem Sozialversicherungsinterview gefoltert haben und bereits die SOLID-Prinzipien kennen, die Gesch√§ftslogik von morgen direkt im Markup. </li></ol><br><p>  Ich glaube, ich habe Sie schon genug erschreckt. Jetzt werde ich Ihnen sagen, wie Sie die oben genannten Probleme vermeiden k√∂nnen. Dies geschieht umso einfacher.  Und es ist gro√üartig, wenn Sie beim Erstellen einer neuen Razor-Komponente in der Regel die folgenden Ans√§tze verwenden.  Also der erste Ansatz. </p><br><h3 id="bazovyy-klass">  Basisklasse </h3><br><p>  Der erste und bis vor kurzem einzige Ansatz. </p><br><p>  F√ºr das Steuerelement aus dem obigen Beispiel erstellen Sie eine Basisklasse, in der sich die gesamte Anzeigelogik befindet.  Erstellen Sie eine neue Datei mit der Vorlage <br>  [Name der Kontrolle] .razor.cs </p><br><p>  Hier hilft uns das Studio und baut aus zwei Dateien etwas wie im Bild unten auf: </p><br><p><img src="https://habrastorage.org/webt/oc/96/u9/oc96u90oqb2zzpuomier1gks3dq.png" alt="Bild"></p><br><p>  Wie Sie sehen, ist das Studio ziemlich intelligent und hat selbst verstanden, was Sie von ihm wollen.  Das Steuerelement wurde mit der Datei gruppiert, in der wir unseren Code platzieren m√∂chten. </p><br><p>  Wenn Sie gerade eine neue Datei √∂ffnen, wird der <strong>Name</strong> der <strong>FetchData-</strong> Klasse mit einer roten <strong>Wellenlinie</strong> unterstrichen. Alles ist wahr, denn trotz der Tatsache, dass Sie in <strong>FetchData.razor nirgendwo</strong> Klassendeklarationen mit dem Namen <strong>FetchData sehen</strong> , wird dies sp√§ter nach dem Kompilieren des Projekts <strong>angezeigt</strong> es ist niedriger und daher ist der Klassenname <strong>FetchData</strong> bereits reserviert.  Wir haben keine andere Wahl, als die Konvention zu verwenden, dass wir die Anzeigelogik (und nur sie !!!) in die FetchDataBase-Klasse einf√ºgen, dh der Klassenname wird von der Vorlage gebildet: <br>  <strong>[ControlName] Base</strong> </p><br><p>  Nat√ºrlich k√∂nnen Sie verwirrt sein und Ihren eigenen statischen Analysator schreiben, der f√ºr jede Komponente nach solchen Dateien sucht. Warum nicht? <br>  Als N√§chstes m√ºssen wir diese Klasse von <strong>ComponentBase</strong> erben.  Vergessen Sie nicht hinzuzuf√ºgen <br>  <strong>using Microsoft.AspNetCore.Components</strong> ; </p><br><p>  Und hier ist was wir haben: </p><br><p><img src="https://habrastorage.org/webt/4z/8y/7d/4z8y7dupxs8f1z32uscjrblitky.png" alt="Bild"></p><br><p>  Wow, die Klasse ist jetzt bereit, die Anzeigelogik hierher zu √ºbertragen. Wir haben jetzt die M√∂glichkeit, sie vollst√§ndig in C # zu schreiben.  :) </p><br><p>  W√§hrend die Razor-Komponente selbst nichts √ºber unsere Datei wei√ü, wei√ü nur Visual Studio, dass sie etwas gemeinsam haben. </p><br><p>  Also mache den folgenden Trick: </p><br><p><img src="https://habrastorage.org/webt/q8/i3/p2/q8i3p2nhk-ecwlhusbd46fz7p58.png" alt="Bild"></p><br><p>  Wir haben die Razor-Komponente von der <strong>FetchDataBase-</strong> Klasse <strong>geerbt</strong> . </p><br><p>  Lassen Sie sich von C # -Code, der noch in <strong>FetchData.razor vorhanden ist,</strong> nicht st√∂ren. </p><br><p>  Im Moment werden wir die gesamte Anzeigelogik in unsere sogenannte Code-Behind-Datei √ºbertragen: </p><br><p><img src="https://habrastorage.org/webt/an/au/kn/anauknb0nxw3tzqxinb15_4j1fy.png" alt="Bild"></p><br><p>  Was ist passiert? Zuerst haben wir mit -und hinzugef√ºgt.  Auf Razor-Steuerelementen werden Sie sie praktisch nicht sehen, da es √ºblich ist, sie zu <strong>_Imports.razor hinzuzuf√ºgen</strong> .  Es sind bereits einige der am h√§ufigsten verwendeten hinzugef√ºgt. </p><br><p>  Als n√§chstes spritzen wir durch das Grundst√ºck, wie Sie sehen k√∂nnen, funktioniert unser Lieblings-DI einwandfrei. <br>  Sie m√ºssen die implementierte Eigenschaft nur mit dem Attribut <strong>[Inject]</strong> kennzeichnen.  In der Razor-Komponente wurde sie mit <strong><a href="https://habr.com/ru/users/inject/" class="user_link">Inject gekennzeichnet</a></strong> .  Das hei√üt, die √Ñnderungen sind minimal. </p><br><p>  Nun, dann folgt die Eigenschaft, in die wir die angezeigten Informationen laden. Sie m√ºssen mindestens <strong>gesch√ºtzt sein</strong> (da das Razor-Steuerelement von der aktuellen Klasse erbt).  Oder <strong>public,</strong> wenn Sie die Initialisierung von au√üen erm√∂glichen m√∂chten, m√ºssen Sie sie in diesem Fall weiterhin mit dem Attribut <strong>[Parameter]</strong> kennzeichnen.  In fr√ºheren Versionen von Blazor war es ziemlich <strong>gesch√ºtzt</strong> , aber jetzt schimpft der Studio Analyzer Sie daf√ºr. </p><br><p>  Im Prinzip k√∂nnen Sie dieser Klasse einen Konstruktor hinzuf√ºgen und dort einige Arbeiten <strong>ausf√ºhren.</strong> Dies wird jedoch nicht empfohlen. Es ist besser, die gesamte Initialisierungslogik in der <strong>OnInitializedAsync () -</strong> Methode zu platzieren </p><br><p>  Das ist alles, was in <strong>FetchData.razor verbleibt</strong> </p><br><p><img src="https://habrastorage.org/webt/_m/5f/3z/_m5f3zs5nzf8qvrguce_zc9pxbo.png" alt="Bild"></p><br><p>  Es gab vereinzelte Razor-Markups, aber wie k√∂nnte es anders sein, m√ºssen wir unsere Daten trotzdem irgendwie anzeigen.  Aber reiner C # -Code ist komplett verschwunden.  Und das ist meiner Meinung nach gro√üartig.  Ich rate Ihnen, zun√§chst einen √§hnlichen Ansatz zu verfolgen, und dann werden weder Sie noch Ihre Kollegen Ihren Kopf wieder in den Griff bekommen, wenn Ihre Kontrolle zu gro√ü wird. </p><br><p>  Das Wichtigste ist, ob es √ºberhaupt funktioniert. Lassen Sie uns nun Folgendes √ºberpr√ºfen: </p><br><p><img src="https://habrastorage.org/webt/gr/sn/rh/grsnrh24yfincyy0eq8rv9gvxme.png" alt="Bild"></p><br><p>  Gro√üartig, es ist, als h√§tten sie nichts kaputt gemacht =) </p><br><h3 id="partial-class">  Teilklasse </h3><br><p>  Und so wird der zweite Ansatz, der vor kurzem erschien ( <a href="https://docs.microsoft.com/en-us/aspnet/core/blazor/components%3Fview%3Daspnetcore-3.1" rel="nofollow">https://docs.microsoft.com/en-us/aspnet/core/blazor/components?view=aspnetcore-3.1#partial-class-support</a> ), aber h√∂chstwahrscheinlich vollst√§ndig ersetzen vorherige.  Auf Wunsch von Mitarbeitern wurde in .Net Core 3.1 die M√∂glichkeit hinzugef√ºgt, eine <strong>Teilklasse</strong> f√ºr Razor-Steuerelemente zu erstellen.  Wir lassen also fast alles so, wie es im vorherigen Ansatz der Fall war, aber jetzt m√ºssen wir nicht mehr von ComponentBase erben, und die Klasse kann genauso wie die Komponente aufgerufen werden, dh ihre Signatur lautet wie folgt: <br>  √∂ffentliche Teilklasse [ComponentName] </p><br><p>  Wie Sie unten sehen k√∂nnen, sind die √Ñnderungen minimal. Im Code dahinter haben wir die Vererbung von <strong>ComponentBase entfernt</strong> und die Klasse als <strong>partiell</strong> markiert </p><br><p><img src="https://habrastorage.org/webt/q1/5o/i5/q15oi5kifsulqhij-jhookhhryu.png" alt="Bild"></p><br><p>  Die Markup-Datei ist ebenfalls ein wenig vereinfacht, wir haben auch die Vererbung von FetchDataBase entfernt, da diese Klasse aufgrund ihrer Nutzlosigkeit nicht mehr existiert. </p><br><p><img src="https://habrastorage.org/webt/mq/53/tl/mq53tldh_tppbmfrcicmqe0wwbw.png" alt="Bild"></p><br><p>  Wie Sie sehen, gibt es zwei Ans√§tze, um Ihr Markup sauber zu halten.  Welches du w√§hlst, liegt ganz bei dir.  Leider w√§re es sch√∂n, wenn das Studio beim Erstellen einer neuen Komponente sofort Code-Behind generieren w√ºrde.  Jetzt wird dies aktiv diskutiert und, wie die Entwickler sagen, in Zukunft eine solche Wahrscheinlichkeit hinzugef√ºgt, wenn es eine Nachfrage daf√ºr gibt, und das wird es mit Sicherheit sein. <br>  Was wird nun aus unserer Razor-Komponente: </p><br><p><img src="https://habrastorage.org/webt/jf/2v/ef/jf2vefp9jwrsq5pb_psmcbvonua.png" alt="Bild"></p><br><p>  Es ist bekannt, nicht wahr?) Jeder, der einmal seine Razor Asp.Net MVC-Komponenten erstellt hat, wird den Inhalt der automatisch generierten Datei als sehr vertraut empfinden. </p><br><p>  Ich hoffe, Sie haben heute von meinem ersten Artikel √ºber Habr etwas mehr √ºber Blazor gelernt.  Hinterlasse unten Kritik, Fragen und W√ºnsche f√ºr neue Artikel =) </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de484822/">https://habr.com/ru/post/de484822/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de484812/index.html">Meine Erfahrung mit Plesk</a></li>
<li><a href="../de484814/index.html">6. Fortinet Getting Started v6.0. Webfilterung und Anwendungskontrolle</a></li>
<li><a href="../de484816/index.html">Verwenden von Operations Hooks zum Sichern von Dateien unter macOS im laufenden Betrieb</a></li>
<li><a href="../de484818/index.html">Das Buch "C ++. Die Praxis der Multithread-Programmierung "</a></li>
<li><a href="../de484820/index.html">FAQ.Net - ein kostenloses Notizenprogramm f√ºr Windows mit aktualisiertem Design</a></li>
<li><a href="../de484824/index.html">Der Krieg um das Licht auszuschalten</a></li>
<li><a href="../de484826/index.html">K√ºnstliche Intelligenz verschlimmert die schlechte Medizin noch mehr</a></li>
<li><a href="../de484834/index.html">Wie man eine Unternehmensstrategie f√ºr Training und Entwicklung entwickelt</a></li>
<li><a href="../de484836/index.html">Berechnung der Rentabilit√§t aus dem Gr√ºnen Tarif 2020, Ukraine</a></li>
<li><a href="../de484838/index.html">13 Beispiele f√ºr das Einrichten von Regeln in Google Ads [Anleitung]</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>