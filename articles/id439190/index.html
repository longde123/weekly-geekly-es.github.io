<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>⛎ 😳 🚙 Cara membuat aplikasi augmented reality menggunakan ARCore 🤾🏿 🏬 😜</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dalam panduan ini, Anda akan belajar cara menambahkan model 3D ke dunia nyata. Pustaka ARCore Google memungkinkan Anda untuk menambahkan model 3D leng...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Cara membuat aplikasi augmented reality menggunakan ARCore</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/439190/"><p><img src="https://habrastorage.org/getpro/habr/post_images/6a4/10f/e17/6a410fe175b5770acae9802ef64b4ced.jpg" alt="Cara membuat aplikasi augmented reality menggunakan ARCore"></p><br><p>  Dalam panduan ini, Anda akan belajar cara menambahkan model 3D ke dunia nyata.  Pustaka ARCore Google memungkinkan Anda untuk menambahkan model 3D lengkap ke gambar 2D (gambar atau video). </p><br><p>  Anda perlu memberi sistem semacam gambar referensi, yang akan dicari ARCore di dunia nyata untuk menambahkan model 3D ke gambar yang didasarkan padanya.  Augmented reality sudah banyak digunakan, misalnya, di buku, koran, majalah, dll. </p><a name="habracut"></a><br><p>  Sebelum masuk ke tutorial ini, Anda harus membiasakan diri dengan dua artikel sebelumnya tentang topik ini yang akan memperkenalkan Anda pada ketentuan AR dasar: </p><br><ul><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Apa itu ARCore?</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Yang perlu Anda ketahui</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Membuat aplikasi ARCore pertama Anda</a> </li></ul><br><h2 id="chto-takoe-izobrazheniya-dopolnennoy-realnosti">  Apa itu gambar augmented reality? </h2><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Menurut dokumentasi untuk pengembang</a> , gambar augmented reality di ARCore memungkinkan Anda membuat aplikasi augmented reality yang dapat "menghidupkan" gambar 2D, seperti poster atau kemasan produk. </p><br><p>  Anda mengunggah beberapa gambar referensi ke ARCore, dan kemudian itu memberi tahu Anda tentang deteksi mereka selama sesi AR, misalnya, saat merekam video.  Dan informasi ini digunakan untuk memposisikan model 3D pada gambar 2D. </p><br><h2 id="ogranicheniya-ispolzovaniya-izobrazheniy-dopolnennoy-realnosti">  Keterbatasan dalam Menggunakan Gambar Augmented Reality </h2><br><p>  Berikut adalah beberapa batasan yang mungkin Anda temui saat menggunakan gambar augmented reality: </p><br><ul><li>  ARCore hanya dapat memproses hingga 20 gambar referensi dalam satu waktu. </li><li>  Bidang fisik di dunia nyata harus datar, dan luasnya harus lebih dari 15 cm x 15 cm. </li><li>  ARCore tidak dapat melacak gambar dan objek bergerak. </li></ul><br><h2 id="vybor-podhodyaschego-opornogo-izobrazheniya">  Memilih Gambar Referensi yang Tepat </h2><br><p>  Berikut adalah beberapa tips untuk memilih gambar referensi yang bagus untuk ARCore: </p><br><ul><li>  Gambar augmented reality mendukung format PNG, JPEG dan JPG. </li><li>  Tidak masalah apakah gambar itu berwarna atau hitam dan putih, yang terpenting adalah kontrasnya tinggi. </li><li>  Resolusi gambar harus minimal 300 x 300 piksel. </li><li>  Menggunakan gambar beresolusi tinggi tidak berarti peningkatan kinerja. </li><li>  Gambar dengan pola berulang (seperti pola atau bintik-bintik) harus dihindari. </li><li>  Gunakan alat <strong>arcoreimg</strong> untuk mengevaluasi seberapa baik gambar Anda bekerja.  Rating minimal 75 poin direkomendasikan. </li></ul><br><h2 id="kak-ispolzovat-instrument-arcoreimg">  Cara menggunakan alat arcoreimg: </h2><br><ul><li>  Unduh ARCore SDK untuk Android <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">dari tautan ini</a> . </li><li>  Buka zip konten file ke lokasi mana pun. </li><li>  Di folder yang diekstraksi, buka <strong>alat&gt; arcoreimg&gt; windows</strong> (bahkan jika Anda memiliki Linux atau macOS). </li><li>  Buka prompt perintah di direktori ini. </li><li>  Dan masukkan perintah ini: </li></ul><br><pre><code class="xml hljs">arcoreimg.exe eval-img --input_image_path=dog.png</code> </pre> <br><p>  Ganti <strong>dog.png</strong> dengan path lengkap ke gambar Anda. </p><br><h2 id="nachalo-raboty-s-prilozheniem-dopolnennoy-realnosti">  Memulai dengan aplikasi augmented reality </h2><br><p>  Sekarang setelah Anda membiasakan diri dengan ARCore dan memilih gambar yang bagus dengan peringkat 75+, sekarang saatnya untuk mulai menulis kode aplikasi. </p><br><h3 id="sozdanie-fragmenta">  Penciptaan fragmen </h3><br><p>  Kami akan membuat fragmen dan menambahkannya ke Aktivitas kami.  Buat kelas yang disebut <code>CustomArFragment</code> dan mewarisinya dari <code>ArFragment</code> .  Berikut adalah kode untuk <code>CustomArFragment</code> : </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.ayusch.augmentedimages; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.util.Log; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.ar.core.Config; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.ar.core.Session; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.ar.sceneform.ux.ArFragment; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CustomArFragment</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ArFragment</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> Config </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getSessionConfiguration</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Session session)</span></span></span><span class="hljs-function"> </span></span>{ getPlaneDiscoveryController().setInstructionView(<span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); Config config = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Config(session); config.setUpdateMode(Config.UpdateMode.LATEST_CAMERA_IMAGE); session.configure(config); getArSceneView().setupSession(session); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> config; } }</code> </pre> <br><p>  Pertama-tama, kami mematikan deteksi pesawat.  Dengan melakukan ini, kami menghapus ikon tangan dari layar yang muncul segera setelah fragmen diinisialisasi dan memberi tahu pengguna tentang perlunya memindahkan ponsel cerdasnya untuk menemukan pesawat.  Kami tidak membutuhkan ini lagi, karena kami menemukan bukan pesawat acak, tetapi gambar konkret. </p><br><p>  Kemudian kami mengatur mode pembaruan untuk sesi <code>LATEST_CAMERA_IMAGE</code> .  Ini memastikan bahwa kami akan diberitahu tentang pembaruan gambar setiap kali bingkai kamera diperbarui. </p><br><h3 id="nastroyka-bazy-dannyh-izobrazheniy">  Pengaturan Database Gambar </h3><br><p>  Tambahkan gambar referensi yang dipilih (yang ingin Anda temukan di dunia fisik) ke folder <strong>aset</strong> (buat jika belum).  Sekarang kita dapat menambahkan gambar ke basis data kita. </p><br><p>  Kami akan membuat database ini segera setelah fragmen dibuat.  Dalam log kami menampilkan hasil operasi ini: </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((((MainActivity) getActivity()).setupAugmentedImagesDb(config, session))) { Log.d(<span class="hljs-string"><span class="hljs-string">"SetupAugImgDb"</span></span>, <span class="hljs-string"><span class="hljs-string">"Success"</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { Log.e(<span class="hljs-string"><span class="hljs-string">"SetupAugImgDb"</span></span>,<span class="hljs-string"><span class="hljs-string">"Faliure setting up db"</span></span>); }</code> </pre> <br><p>  Begini tampilannya <code>CustomArFragment</code> : </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.ayusch.augmentedimages; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.util.Log; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.ar.core.Config; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.ar.core.Session; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.ar.sceneform.ux.ArFragment; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CustomArFragment</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ArFragment</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> Config </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getSessionConfiguration</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Session session)</span></span></span><span class="hljs-function"> </span></span>{ getPlaneDiscoveryController().setInstructionView(<span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); Config config = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Config(session); config.setUpdateMode(Config.UpdateMode.LATEST_CAMERA_IMAGE); session.configure(config); getArSceneView().setupSession(session); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((((MainActivity) getActivity()).setupAugmentedImagesDb(config, session))) { Log.d(<span class="hljs-string"><span class="hljs-string">"SetupAugImgDb"</span></span>, <span class="hljs-string"><span class="hljs-string">"Success"</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { Log.e(<span class="hljs-string"><span class="hljs-string">"SetupAugImgDb"</span></span>,<span class="hljs-string"><span class="hljs-string">"Faliure setting up db"</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> config; } }</code> </pre> <br><p>  Segera kami akan menambahkan metode <code>setupAugmentedImagesDb</code> ke <code>MainActivity</code> .  Sekarang mari kita tambahkan <code>CustomArFragment</code> ke <code>activity_main.xml</code> kami: </p><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">android.support.constraint.ConstraintLayout</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:android</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.android.com/apk/res/android"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:app</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.android.com/apk/res-auto"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:tools</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.android.com/tools"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">tools:context</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">".MainActivity"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">fragment</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/sceneform_fragment"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.ayusch.augmentedimages.CustomArFragment"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">android.support.constraint.ConstraintLayout</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><h3 id="dobavlenie-izobrazheniya-v-bazu-dannyh">  Menambahkan gambar ke database </h3><br><p>  Sekarang kita akan mengatur basis data gambar kita, menemukan gambar referensi di dunia nyata dan menambahkan model 3D ke gambar. </p><br><p>  Mari kita mulai dengan mengatur basis data kita.  Buat metode <code>setupAugmentedImagesDb</code> publik di kelas <code>MainActivity</code> : </p><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setupAugmentedImagesDb</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Config config, Session session)</span></span></span><span class="hljs-function"> </span></span>{ AugmentedImageDatabase augmentedImageDatabase; Bitmap bitmap = loadAugmentedImage(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (bitmap == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; } augmentedImageDatabase = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> AugmentedImageDatabase(session); augmentedImageDatabase.addImage(<span class="hljs-string"><span class="hljs-string">"tiger"</span></span>, bitmap); config.setAugmentedImageDatabase(augmentedImageDatabase); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> Bitmap </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loadAugmentedImage</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> (InputStream is = getAssets().open(<span class="hljs-string"><span class="hljs-string">"blanket.jpeg"</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> BitmapFactory.decodeStream(is); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (IOException e) { Log.e(<span class="hljs-string"><span class="hljs-string">"ImageLoad"</span></span>, <span class="hljs-string"><span class="hljs-string">"IO Exception"</span></span>, e); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; }</code> </pre> <br><p>  Kami juga menciptakan metode <code>loadAugmentedImage</code> yang memuat gambar dari folder sumber daya dan mengembalikan bitmap. </p><br><p>  Di <code>setupAugmentedImagesDb</code> kami pertama-tama menginisialisasi database kami untuk sesi saat ini, dan kemudian menambahkan gambar ke database ini.  Kami menamai gambar <strong>harimau kami</strong> .  Kemudian kami menginstal database ini di config dan mengembalikan <code>true</code> , menunjukkan bahwa gambar berhasil ditambahkan. </p><br><h3 id="obnaruzhenie-opornyh-izobrazheniy-v-realnom-mire">  Deteksi gambar referensi dunia nyata </h3><br><p>  Sekarang kita akan mulai menemukan gambar referensi kita di dunia nyata.  Untuk melakukan ini, kita akan membuat pendengar yang akan dipanggil setiap kali bingkai video diperbarui, dan bingkai ini akan dianalisis untuk kehadiran gambar referensi di sana. </p><br><p>  Tambahkan baris ini ke metode <code>onCreate()</code> di <code>MainActivity</code> : </p><br><pre> <code class="java hljs">arFragment.getArSceneView().getScene().addOnUpdateListener(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>::onUpdateFrame);</code> </pre> <br><p>  Sekarang tambahkan metode <code>onUpdateFrame</code> ke <code>MainActivity</code> : </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@RequiresApi</span></span>(api = Build.VERSION_CODES.N) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onUpdateFrame</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(FrameTime frameTime)</span></span></span><span class="hljs-function"> </span></span>{ Frame frame = arFragment.getArSceneView().getArFrame(); Collection&lt;AugmentedImage&gt; augmentedImages = frame.getUpdatedTrackables(AugmentedImage.class); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (AugmentedImage augmentedImage : augmentedImages) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (augmentedImage.getTrackingState() == TrackingState.TRACKING) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (augmentedImage.getName().equals(<span class="hljs-string"><span class="hljs-string">"tiger"</span></span>) &amp;&amp; shouldAddModel) { placeObject(arFragment, augmentedImage.createAnchor(augmentedImage.getCenterPose()), Uri.parse(<span class="hljs-string"><span class="hljs-string">"Mesh_BengalTiger.sfb"</span></span>)); shouldAddModel = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; } } } }</code> </pre> <br><p>  Di baris pertama kita mendapatkan frame itu sendiri.  Bingkai dapat dibayangkan sebagai tangkapan layar biasa dari video.  Jika Anda terbiasa dengan cara video bekerja, Anda tahu bahwa itu hanya kumpulan gambar yang saling berubah dengan sangat cepat, memberikan kesan sesuatu bergerak.  Kami hanya mengambil satu dari foto-foto ini. </p><br><p>  Setelah kami menerima bingkai, kami menganalisisnya untuk keberadaan gambar referensi kami di atasnya.  Kami mengambil daftar semua item yang dilacak oleh ARCore menggunakan <code>frame.getUpdatedTrackables</code> .  Kemudian kita beralih dan memeriksa apakah gambar <strong>harimau</strong> kita ada di dalam bingkai. </p><br><p>  Jika kecocokan ditemukan, maka kami cukup mengambil dan menempatkan model 3D di atas gambar yang terdeteksi. </p><br><blockquote>  <em>Catatan</em>  <em>Bendera <code>shouldAddModel</code> digunakan sehingga kami menambahkan model 3D hanya sekali.</em> </blockquote><br><h3 id="razmeschenie-3d-modeli-nad-opornym-izobrazheniem">  Menempatkan model 3D di atas gambar referensi </h3><br><p>  Sekarang kami telah menemukan gambar referensi kami di dunia nyata, kami dapat menambahkan model 3D di atasnya.  Tambahkan metode <code>placeObject</code> dan <code>addNodeToScene</code> : </p><br><ul><li>  <code>placeObject</code> : metode ini digunakan untuk membangun objek yang dirender menggunakan <code>Uri</code> diberikan.  Setelah rendering selesai, objek diteruskan ke metode <code>addNodeToScene</code> , di mana objek dilampirkan ke node, dan node ini ditempatkan di tempat kejadian. </li><li>  <code>addNodeToScene</code> : metode ini membuat simpul dari jangkar yang dihasilkan, membuat simpul lain tempat objek yang divisualisasikan bergabung, kemudian menambahkan simpul ini ke simpul jangkar dan menempatkannya di atas panggung. </li></ul><br><p>  Inilah yang terlihat seperti <code>MainActivity</code> : </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.ayusch.augmentedimages; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.graphics.Bitmap; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.graphics.BitmapFactory; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.net.Uri; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.os.Build; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.support.annotation.RequiresApi; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.support.v7.app.AppCompatActivity; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.os.Bundle; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.util.Log; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.widget.Toast; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.ar.core.Anchor; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.ar.core.AugmentedImage; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.ar.core.AugmentedImageDatabase; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.ar.core.Config; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.ar.core.Frame; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.ar.core.Session; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.ar.core.TrackingState; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.ar.sceneform.AnchorNode; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.ar.sceneform.FrameTime; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.ar.sceneform.rendering.ModelRenderable; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.ar.sceneform.rendering.Renderable; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.ar.sceneform.ux.ArFragment; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.ar.sceneform.ux.TransformableNode; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.IOException; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.InputStream; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.Collection; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MainActivity</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AppCompatActivity</span></span></span><span class="hljs-class"> </span></span>{ ArFragment arFragment; <span class="hljs-keyword"><span class="hljs-keyword">boolean</span></span> shouldAddModel = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Bundle savedInstanceState)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onCreate(savedInstanceState); setContentView(R.layout.activity_main); arFragment = (CustomArFragment) getSupportFragmentManager().findFragmentById(R.id.sceneform_fragment); arFragment.getPlaneDiscoveryController().hide(); arFragment.getArSceneView().getScene().addOnUpdateListener(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>::onUpdateFrame); } <span class="hljs-meta"><span class="hljs-meta">@RequiresApi</span></span>(api = Build.VERSION_CODES.N) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">placeObject</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ArFragment arFragment, Anchor anchor, Uri uri)</span></span></span><span class="hljs-function"> </span></span>{ ModelRenderable.builder() .setSource(arFragment.getContext(), uri) .build() .thenAccept(modelRenderable -&gt; addNodeToScene(arFragment, anchor, modelRenderable)) .exceptionally(throwable -&gt; { Toast.makeText(arFragment.getContext(), <span class="hljs-string"><span class="hljs-string">"Error:"</span></span> + throwable.getMessage(), Toast.LENGTH_LONG).show(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } ); } <span class="hljs-meta"><span class="hljs-meta">@RequiresApi</span></span>(api = Build.VERSION_CODES.N) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onUpdateFrame</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(FrameTime frameTime)</span></span></span><span class="hljs-function"> </span></span>{ Frame frame = arFragment.getArSceneView().getArFrame(); Collection&lt;AugmentedImage&gt; augmentedImages = frame.getUpdatedTrackables(AugmentedImage.class); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (AugmentedImage augmentedImage : augmentedImages) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (augmentedImage.getTrackingState() == TrackingState.TRACKING) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (augmentedImage.getName().equals(<span class="hljs-string"><span class="hljs-string">"tiger"</span></span>) &amp;&amp; shouldAddModel) { placeObject(arFragment, augmentedImage.createAnchor(augmentedImage.getCenterPose()), Uri.parse(<span class="hljs-string"><span class="hljs-string">"Mesh_BengalTiger.sfb"</span></span>)); shouldAddModel = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; } } } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setupAugmentedImagesDb</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Config config, Session session)</span></span></span><span class="hljs-function"> </span></span>{ AugmentedImageDatabase augmentedImageDatabase; Bitmap bitmap = loadAugmentedImage(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (bitmap == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; } augmentedImageDatabase = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> AugmentedImageDatabase(session); augmentedImageDatabase.addImage(<span class="hljs-string"><span class="hljs-string">"tiger"</span></span>, bitmap); config.setAugmentedImageDatabase(augmentedImageDatabase); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> Bitmap </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loadAugmentedImage</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> (InputStream is = getAssets().open(<span class="hljs-string"><span class="hljs-string">"blanket.jpeg"</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> BitmapFactory.decodeStream(is); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (IOException e) { Log.e(<span class="hljs-string"><span class="hljs-string">"ImageLoad"</span></span>, <span class="hljs-string"><span class="hljs-string">"IO Exception"</span></span>, e); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">addNodeToScene</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ArFragment arFragment, Anchor anchor, Renderable renderable)</span></span></span><span class="hljs-function"> </span></span>{ AnchorNode anchorNode = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> AnchorNode(anchor); TransformableNode node = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TransformableNode(arFragment.getTransformationSystem()); node.setRenderable(renderable); node.setParent(anchorNode); arFragment.getArSceneView().getScene().addChild(anchorNode); node.select(); } }</code> </pre> <br><p>  Sekarang jalankan aplikasi Anda.  Anda akan melihat layar seperti yang ditunjukkan di bawah ini.  Pindahkan ponsel sedikit di atas objek referensi.  Dan begitu ARCore mendeteksi gambar referensi di dunia nyata, itu menambah model 3D Anda ke sana. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/285/6ea/3ed/2856ea3edbaffc05bb1bcb92b53dc8e9.jpg" alt="Hasil"></p><br><blockquote>  Baca juga: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Membuat aplikasi ARCore pertama Anda</a> </blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id439190/">https://habr.com/ru/post/id439190/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id439176/index.html">Kirim email dengan lampiran oleh JavaMailSender dari SpringFramework</a></li>
<li><a href="../id439180/index.html">Tantangan Rekko</a></li>
<li><a href="../id439182/index.html">Bagaimana kami mendistribusikan pesanan antar driver di Yandex.Taxi</a></li>
<li><a href="../id439184/index.html">Ubah kata sandi Anda: menguji kebijakan kata sandi layanan web</a></li>
<li><a href="../id439186/index.html">Editor UX: kisah nyata, kehidupan nyata</a></li>
<li><a href="../id439192/index.html">Speaker PC Ke Sebelas</a></li>
<li><a href="../id439194/index.html">Manajemen Karakter dengan SharedEvents</a></li>
<li><a href="../id439196/index.html">Analis JPMorgan: Apple harus membeli Blizzard, Netflix atau Sonos untuk meyakinkan investor</a></li>
<li><a href="../id439198/index.html">Generasi Pulau Barrier</a></li>
<li><a href="../id439200/index.html">Komposer untuk anak kecil</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>