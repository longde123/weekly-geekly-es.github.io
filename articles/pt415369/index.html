<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üîÖ üê∏ ü¶ì Pre√ßo de refatora√ß√£o üêá üëêüèΩ üí∏</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Subjetivamente: a refatora√ß√£o √© uma ‚Äúdoen√ßa‚Äù juvenil. Segundo observa√ß√µes pessoais, em algum lugar ap√≥s 26 anos come√ßa a deixar ir. Como na antiga fra...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Pre√ßo de refatora√ß√£o</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/415369/"><p></p><div style="text-align:center;"><img src="https://habrastorage.org/webt/2g/am/9h/2gam9hcz7vw9kp-513utyr0ezum.png" height="500"></div>  Subjetivamente: a refatora√ß√£o √© uma ‚Äúdoen√ßa‚Äù juvenil.  Segundo observa√ß√µes pessoais, em algum lugar ap√≥s 26 anos come√ßa a deixar ir.  Como na antiga frase: ‚ÄúAquele que n√£o foi revolucion√°rio em sua juventude - ele n√£o tem cora√ß√£o, ele que n√£o se torna conservador na maturidade - ele n√£o tem mente.  Portanto, at√© finalmente desistir, tentarei descrever os casos de refatora√ß√£o de usu√°rios e as poss√≠veis metas que podem ser alcan√ßadas com ele. <a name="habracut"></a><br><h2 id="vdohnoviteli">  Inspiradores </h2><br><p> Comecei a escrever ap√≥s a pr√≥xima visualiza√ß√£o da solicita√ß√£o de recebimento de mais de 150 arquivos, onde novas funcionalidades e refatora√ß√£o do existente estavam ferozmente envolvidas.  A refatora√ß√£o n√£o era apenas cosm√©tica, mas tamb√©m l√≥gica, o que causou a maior dor.  Por exemplo, no Ruby, o <code>amount == 0</code> substitu√≠do <code>amount.zero?</code> pelo <code>amount.zero?</code>  sem considerar que, no caso do <code>amount</code> <code>nil</code> <code>amount</code> essas constru√ß√µes n√£o s√£o equivalentes.  Tudo isso foi explicado aproximadamente da seguinte maneira: "mas de acordo com o c√≥digo o padr√£o √© t√£o suposto!"  Para a pergunta l√≥gica "qual √© o objetivo de seguir o c√≥digo at√© o padr√£o e, em geral, qual √© o seu objetivo como desenvolvedor?"  o homem se trancou e repetiu um pouco de culpa ", mas de acordo com o c√≥digo padr√£o, voc√™ tem que escrever assim ..." e parecia uma loira em uma loja de roupas que n√£o conseguia lidar com o desejo <del>  refatorar </del>  compre tudo. </p><br><h2 id="opredelenie">  Defini√ß√£o de </h2><br><p>  O t√≥pico √© sens√≠vel, ent√£o voc√™ precisa prestar aten√ß√£o especial √† pergunta "quem √© quem?"  Portanto, de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">acordo com o wiki</a> , a refatora√ß√£o √© um processo de altera√ß√£o da estrutura interna de um programa que <u>n√£o afeta seu comportamento externo</u> e visa facilitar a compreens√£o de seu trabalho. </p><br><p>  Da minha parte, quero limitar os limites e definir refatora√ß√£o (no pior sentido da palavra) como quaisquer altera√ß√µes que n√£o estejam diretamente relacionadas ao problema que est√° sendo resolvido e n√£o alteram o comportamento externo do sistema, mas que s√£o executadas como parte da tarefa original. </p><br><p>  Ou seja, n√£o quero falar sobre a mudan√ßa planejada na base de c√≥digo, para a qual o escopo do trabalho foi descrito e os objetivos espec√≠ficos foram definidos, mas sobre as modifica√ß√µes espont√¢neas que ocorrem durante o desenvolvimento. </p><br><h2 id="cennost-produkta">  Valor do produto </h2><br><p>  Agora vou come√ßar de longe.  O c√≥digo fonte n√£o √© uma meta nem um valor.  Obviamente, esteticamente ou artisticamente, pode ser de algum interesse, mas essas s√£o exce√ß√µes.  Em geral, o c√≥digo √© uma ferramenta para criar um produto de software usado por qualquer pessoa.  Portanto, para iniciantes, seria bom determinar quais s√£o os valores no produto. </p><br><h3 id="pryamye-cennosti-produkta">  Valores diretos do produto </h3><br><p>  Tudo √© simples aqui.  Eles usam o produto, ent√£o valores diretos s√£o o que o usu√°rio claramente sente / v√™ / sente.  Ou seja: </p><br><ol><li>  todos os tipos de funcionalidade do produto; </li><li>  usabilidade (UI / UX, desempenho, toler√¢ncia a falhas, etc.). </li></ol><br><p>  O segundo ponto pode causar alguma discuss√£o.  Afinal, muitos acreditam que isso n√£o √© o principal.  Como se a funcionalidade for boa, n√£o importa em que parte ela est√° envolvida.  Bons exemplos de funcionalidade sem UI / UX s√£: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Redmine</a> e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">SAP</a> .  No entanto, discordo desse olhar e de uma opini√£o mais pr√≥xima do camarada <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Alan Cooper</a> e de seu "Hospital Psiqui√°trico nas m√£os dos pacientes". </p><br><h3 id="kosvennye-cennosti-produkta">  Valores Indiretos do Produto </h3><br><p>  Esses s√£o valores que, por si s√≥, n√£o afetam o usu√°rio.  Mas eles podem "disparar" ou "acumular" e ter um impacto (de gravidade vari√°vel) no produto ou em sua funcionalidade. </p><br><ol><li>  Bugs.  Um caso lim√≠trofe de valores.  Eles s√£o secund√°rios porque os valores em si n√£o carregam, mas retiram isso dos recursos vizinhos. </li><li>  Limpeza.  Trata-se de legibilidade, modularidade, minimiza√ß√£o de componentes recebidos, padroniza√ß√£o e unifica√ß√£o de interfaces, etc. </li><li>  Documenta√ß√£o  Trata-se de c√≥digo e explica√ß√µes para desenvolvedores, n√£o de descri√ß√µes de neg√≥cios ou contas de usu√°rio.  √â bem ilustrado pela frase de um campon√™s alegre de uma das entrevistas: "A l√≥gica no banco de dados √© escrita como um livro". </li><li>  Escalabilidade / seguran√ßa / seguran√ßa.  O usu√°rio n√£o os v√™ at√© que algo ruim aconte√ßa. </li></ol><br><h3 id="cennosti-dlya-razrabotchika">  Valores do desenvolvedor </h3><br><p>  Uma categoria muito importante que muitos ignoram, mas que sempre afeta o resultado. </p><br><ol><li>  C√≥digo por padr√£o. </li><li>  Recuo no feng shui. </li><li>  Outras transa√ß√µes com consci√™ncia.  Afinal, o c√≥digo foi escrito, portanto, h√° um resultado para o dia e, portanto, h√° um benef√≠cio. </li><li>  Conformidade do c√≥digo com o mundo interior. </li></ol><br><p>  Mas sejamos honestos.  Tudo isso n√£o se refere aos valores associados ao produto e ao usu√°rio final.  Trata-se de psicologia e baratas pessoais. </p><br><h2 id="vzglyad-so-storony-biznesa">  Vista do lado dos neg√≥cios </h2><br><p>  Por uma quest√£o de integridade, seria necess√°rio analisar tudo isso do lado dos neg√≥cios, e n√£o um produto de software.  Nesse caso, a divis√£o em valores diretos e indiretos se torna bastante banal: direto - obviamente traga dinheiro e voc√™ pode fazer uma avalia√ß√£o quantitativa inequ√≠voca;  indiretos - eles n√£o trazem dinheiro e / ou √© muito dif√≠cil de quantificar;  os valores para o desenvolvedor n√£o trazem dinheiro de nenhuma forma (talvez at√© o levem embora). </p><br><p>  Por exemplo. </p><br><ul><li>  Um novo recurso com o uso do OAuth aumentou o n√∫mero de registros em 10% e recebemos + 1k $. </li><li>  Dividimos o m√≥dulo de cobran√ßa em v√°rias partes independentes, com base no padr√£o de responsabilidade √∫nica.  Parece que ficou mais f√°cil manter, mas n√£o foi poss√≠vel medir. </li><li>  N√≥s alinhamos a base de c√≥digo com o padr√£o de c√≥digo e ... n√£o recebemos nada. </li></ul><br><p>  Vale a pena notar que, pelas estimativas acima, as pernas crescem com a amada acelera√ß√£o dos neg√≥cios, a pressa geral e a relut√¢ncia em dedicar tempo a algo que n√£o seja a funcionalidade e, possivelmente, uma corre√ß√£o de bug.  De fato, os valores diretos podem ser estimados e "vendidos", e os indiretos s√£o muito dif√≠ceis ou imposs√≠veis.  E acontece que os valores indiretos s√£o realizados em virtude de uma forma√ß√£o em engenharia, ou s√£o entendidos em um n√≠vel intuitivo ou jogados fora como "in√∫teis". </p><br><p>  Para ser justo, precisamos lembrar o conceito de facilitador, que "abre o caminho" para a implementa√ß√£o do recurso desejado, mas n√£o gera um lucro √≥bvio para o usu√°rio.  Mas isso √© outra hist√≥ria. </p><br><h2 id="prichyom-tut-refaktoring">  E quanto √† refatora√ß√£o? </h2><br><p>  Pelo menos, apesar de ele poder influenciar apenas os valores indiretos do produto.  Portanto, o usu√°rio n√£o se sentir√° melhor com qualquer refatora√ß√£o. </p><br><p>  Tamb√©m √© importante lembrar sobre entropia.  A refatora√ß√£o sempre a minimiza.  Para reduzir a entropia, idealmente, voc√™ precisa de uma equipe de arquitetos que minimize a entropia no est√°gio de design.  Para citar uma pe√ßa do M√™s do Homem M√≠tico: </p><br><blockquote>  A programa√ß√£o do sistema √© um processo que reduz a entropia e, portanto, a metaestabilidade √© inerente a ela.  A manuten√ß√£o do programa √© um processo que aumenta a entropia, e mesmo a manuten√ß√£o mais h√°bil atrasa o sistema de cair na obsolesc√™ncia sem esperan√ßa. </blockquote><p>  Portanto, se considerarmos que a refatora√ß√£o faz parte do processo de manuten√ß√£o do programa, quanto menos refatorar, mais tempo o c√≥digo permanecer√° sem reescrever. </p><br><h2 id="kakie-celi-mogut-byt-u-refaktoringa">  Quais objetivos a refatora√ß√£o pode ter? </h2><br><p>  Deixe-me lembr√°-lo de que estou falando de uma mudan√ßa espont√¢nea durante a implementa√ß√£o dos recursos, e n√£o das mudan√ßas planejadas.  Nesse caso, a defini√ß√£o do objetivo √© inteiramente do desenvolvedor.  Ele deve se fazer a pergunta principal ‚Äúpor qu√™?‚Äù, Responda e depois disso, avance para o objetivo pretendido. </p><br><h3 id="za-entropiyu">  Para entropia! </h3><br><p>  √â dif√≠cil fazer voc√™ mesmo.  E passar pela revis√£o geralmente n√£o √© realista.  O objetivo √© certamente bom: limpar a ponte para novas conquistas, bem como limpar as toxinas e toxinas acumuladas durante o per√≠odo de suporte ao produto.  Mas remover alguns m√≥dulos do zero sem perder nada ao longo do caminho n√£o √© uma tarefa f√°cil.  Deve ser resolvido em conjunto com analistas de neg√≥cios e arquitetos, se houver.  Poucas pessoas correm o risco de fazer isso voluntariamente. </p><br><h3 id="za-dokumentaciyu">  Para a documenta√ß√£o! </h3><br><p>  J√° √© mais f√°cil  Renomeie vari√°veis ‚Äã‚Äã/ fun√ß√µes com o princ√≠pio de ‚Äúo que est√° na caixa e depois na caixa‚Äù, simplifique o design devido aos recursos da linguagem e das bibliotecas, adicione coment√°rios em locais n√£o √≥bvios etc.  Isso pode ser feito sozinho e, com a abordagem correta, pode ser feito bem tanto para si mesmo quanto para o futuro e para os colegas vizinhos. </p><br><h3 id="za-bystrodeystvie">  Para velocidade! </h3><br><p>  Para ser honesto, esse trabalho deve ser destacado como uma tarefa separada.  Como os recursos atuais do sistema s√£o suficientes para voc√™ e voc√™ n√£o precisa fazer nada, ou sabe exatamente o que e quanto precisa para acelerar. </p><br><p>  Tudo se enquadra nessa categoria: da corre√ß√£o in√≥cua de N + 1 √† acelera√ß√£o s√©ria devido a altera√ß√µes nos algoritmos de opera√ß√£o.  O problema √© que a "paridade" de bugs sempre fica em alta velocidade.  Aqui est√° um exemplo: em uma transa√ß√£o os dados no banco de dados s√£o enviados por push e na mesma transa√ß√£o uma tarefa √© definida no Sidekiq;  A fila do Sidekiq em Redis e a transa√ß√£o n√£o se aplica a ela;  quando a velocidade da fila aumenta, √†s vezes a tarefa √© executada antes dos dados serem confirmados;  Voc√™ pode imaginar as consequ√™ncias e o processo de depura√ß√£o. </p><br><h3 id="za-refaktoring">  Para refatora√ß√£o! </h3><br><p>  Imagine que voc√™ usou o servi√ßo de limpeza de apartamentos.  Eles vieram e come√ßaram a limpar, mas, ao longo do caminho, mudaram todos os m√≥veis do apartamento e delinearam as cortinas da sala de estar para a banheira com o argumento "nessas condi√ß√µes, o aspirador era mais agrad√°vel para fazer seu trabalho".  Imagem de "WTF?!"  voc√™ pode imaginar voc√™ mesmo. </p><br><p>  Espero que voc√™ entenda que precisa pensar n√£o em si mesmo, mas em quem voc√™ o faz. </p><br><h2 id="smirenie-i-prinyatie">  Humildade e aceita√ß√£o </h2><br><p>  Em conclus√£o, √© necess√°rio fornecer um ‚Äúmanual‚Äù sobre o que fazer antes da refatora√ß√£o.  √â verdade que essa n√£o √© uma lista TODO, mas uma lista de fatos com os quais voc√™ precisa chegar a um acordo e aceitar ou n√£o agir. </p><br><ol><li>  Estou aumentando o n√∫mero de bugs no projeto e posso obter um pandeiro para ele. </li><li>  Eu me torno o propriet√°rio do c√≥digo refatorado e todas as perguntas sobre ele, em primeiro lugar, ser√£o enviadas a mim. </li><li>  Pelas minhas a√ß√µes, n√£o produzo nada de valor para o usu√°rio final. </li></ol><br><p>  Uma pequena explica√ß√£o. </p><br><ol><li>  Qualquer altera√ß√£o no c√≥digo tem uma chance diferente de zero de gerar um erro.  E como essa a√ß√£o n√£o est√° conectada √† funcionalidade final, voc√™ simplesmente produz bugs sem gerar valores essenciais.  √â bom estar ciente disso e n√£o fingir ser mangueiras quando chegarem a voc√™ com perguntas. </li><li>  Desculpas como "anotate previous" e similares s√£o muito infelizes, porque no mesmo github / gitlab n√£o existe essa caracter√≠stica.  Al√©m disso, o autor anterior confirmou que tudo funciona em sua configura√ß√£o, e n√£o se responsabiliza por suas altera√ß√µes e perde parte da imagem do que est√° acontecendo.  Mais precisamente, voc√™ tira isso dele junto com a responsabilidade. </li><li>  O usu√°rio realmente n√£o se importa com a refatora√ß√£o, ele est√° interessado em estabilidade e funcionalidade, e a refatora√ß√£o n√£o √© sobre isso. </li></ol><br><p>  E novamente: se voc√™ n√£o concorda com pelo menos um dos pontos - n√£o comece a refatorar.  √â melhor ler Habr, Lurk, beber ch√° ou, na pior das hip√≥teses, cortar o pr√≥ximo recurso no painel. </p><br><h2 id="konec">  O fim </h2><br><p>  N√£o julgue estritamente.  Se poss√≠vel, critique construtivamente.  E sempre pense no prop√≥sito de suas a√ß√µes.  Obrigada </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt415369/">https://habr.com/ru/post/pt415369/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt415359/index.html">PHP 8: o que esperar. Carta de Zeev Surasky</a></li>
<li><a href="../pt415361/index.html">O Firefox verificar√° senhas comprometidas usando o m√©todo de k-anonimiza√ß√£o</a></li>
<li><a href="../pt415363/index.html">√çndia aumentar√° a produ√ß√£o de energia verde em 100 GW at√© 2022</a></li>
<li><a href="../pt415365/index.html">Vamos l√°! Ou um pouco sobre como projetar uma interface de selecionador de datas</a></li>
<li><a href="../pt415367/index.html">E se os alien√≠genas se tornarem m√°quinas com intelig√™ncia artificial?</a></li>
<li><a href="../pt415371/index.html">Privacidade de Criptomoedas</a></li>
<li><a href="../pt415373/index.html">NumPy em Python. Parte 4</a></li>
<li><a href="../pt415375/index.html">Ovelhas Ocultas e Arqueologia Tipogr√°fica</a></li>
<li><a href="../pt415377/index.html">Como o JS funciona: classes e heran√ßa, transpila√ß√£o em Babel e TypeScript</a></li>
<li><a href="../pt415381/index.html">Brinque com o Kubernetes - servi√ßo para familiarizar-se com os K8s</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>