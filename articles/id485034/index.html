<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🐗 🧔🏽 🥖 Mengotomatiskan pembuatan proyek Qt pada Windows di Travis CI 🌌 ⛳️ 🙆🏿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Baru-baru ini, untuk QtProtobuf, saya bingung dengan membuat CI yang suka memerintah untuk memverifikasi alias menarik permintaan, dan tentu saja, unt...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Mengotomatiskan pembuatan proyek Qt pada Windows di Travis CI</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/485034/"><p>  Baru-baru ini, untuk <a href="https://github.com/semlanik/qtprotobuf" rel="nofollow">QtProtobuf,</a> saya bingung dengan membuat CI yang suka memerintah untuk memverifikasi alias menarik permintaan, dan tentu saja, untuk memasukkan lencana modis di README proyek.  Pilihannya adalah <a href="https://github.com/features/actions" rel="nofollow">Tindakan GitHub</a> dan <a href="https://travis-ci.com/" rel="nofollow">Travis CI</a> .  Jujur, saya tidak berangkat mencari, membandingkan, menganalisis, saya ingin kesederhanaan dan solusi cepat untuk tugas yang sangat sederhana.  Pertama, saya menemukan CI untuk Tindakan GitHub, dan mengatur verifikasi uji coba unit dan bangunan melalui wadah buruh pelabuhan.  Tetapi karena berbagai keterbatasan, Tindakan GitHub ternyata tidak cocok untuk verifikasi proyek di Windows.  Saya harus beralih ke Travis CI. </p><br><p>  <em>KDPV_not_found.png</em> </p><a name="habracut"></a><br><p>  Pada saat menulis artikel ini di Travis CI, ada penafian seperti itu: </p><br><blockquote>  Windows build sedang dalam tahap akses awal.  Silakan menuju forum Komunitas Travis CI untuk mendapatkan bantuan atau memposting ide. </blockquote><p>  Hal ini menimbulkan kekhawatiran, karena pada awalnya saya mencoba mengkonfigurasi semuanya melalui buruh pelabuhan dan memasukkannya ke dalam Tindakan GitHub, tetapi usaha ini gagal karena pembatasan ukuran, jenis wadah, dll.  di github. </p><br><h2 id="k-delu">  Untuk bisnis </h2><br><p> Untuk memulai, Anda perlu mengesahkan Travis CI di GitHub, setelah itu aplikasi Travis CI akan muncul di pengaturan profil Anda.  Dengan mudah, Anda dapat menentukan repositori yang dapat diakses Travis CI: </p><br><p><img src="https://habrastorage.org/webt/x-/rl/lc/x-rllc93_hpbwe6vsoyqhd6ckj8.png"></p><br><p>  Langkah selanjutnya adalah mengkonfigurasi pemicu Travis CI.  Prosedur ini sudah dilakukan dari panel administrasi Travis CI sendiri, pada saat penulisan, pemicu berikut tersedia: </p><br><ul><li>  Dorong peluncuran ke brunch proyek apa pun </li><li>  Jalankan saat membuat permintaan gabungan </li><li>  Pemicu Berwaktu (cron) </li></ul><br><p>  Pada prinsipnya, satu set yang layak untuk membangun CI. </p><br><p>  Setelah memilih pemicu untuk meluncurkan build, Anda perlu membuat <em>.travis.yml</em> , dengan deskripsi prosedur konstruksi dan, tergantung pada pemicu yang tersedia, letakkan file ini di repositori.  Dokumentasi Travis CI yang tersebar dan tidak sistematis mengenai <em>.travis.yml</em> segera membingungkan, tetapi Anda dapat mengetahuinya jika mau. </p><br><p>  Tugas utama yang berdiri adalah untuk mempersiapkan lingkungan untuk perakitan, karena perakitan itu sendiri dan verifikasi adalah bisnis CMake. </p><br><h2 id="opisyvaem-proceduru-sborki-v-travisyml">  Kami menjelaskan prosedur perakitan di <em>.travis.yml</em> </h2><br><p>  Pertama, Anda perlu memilih sistem operasi yang berjalan sebagai mesin virtual di server Travis CI, dan bahasa pemrograman. </p><br><pre><code class="plaintext hljs">os: windows language: C++ ...</code> </pre> <br><p>  <em>Bahasa</em> , seperti yang saya pahami, mengotomatiskan beberapa langkah jika tidak ditentukan secara eksplisit, tetapi pengikatannya merupakan misteri bagi saya.  Saya berpikir bahwa tanpa itu tidak akan ada MSVC pra-instal, tetapi selama percobaan ternyata juga ada untuk bahasa lain. </p><br><p>  Langkah selanjutnya adalah mengunduh dan menginstal dependensi yang diperlukan.  Untuk QtProtobuf, ini adalah: </p><br><ul><li>  Qt 5.12.3 atau lebih tinggi </li><li>  cmake-3.1 atau lebih tinggi </li><li>  Strawberry perl 5.28 atau lebih tinggi </li><li>  GoLang 1.10 atau lebih tinggi </li><li>  Yasm 1.3 atau lebih tinggi </li><li>  Visual Studio Compiler 14.16.x </li></ul><br><p>  Dan di sini Travis CI sangat <a href="https://docs.travis-ci.com/user/reference/windows/" rel="nofollow">membantu</a> .  Di antara paket pra-instal tidak hanya Git dan MSVC, tetapi juga cmake, wget dan <a href="https://chocolatey.org/" rel="nofollow">cokelat</a> .  Dalam prisnip di hadapan cokelat, instalasi lebih lanjut dari dependensi sangat difasilitasi.  Benar, itu tetap menjadi misteri bagi saya mengapa Qt belum dikirim ke cokelat. </p><br><p>  Untuk memulai, unduh penginstal Qt lengkap dari repositori resmi: </p><br><pre> <code class="plaintext hljs">... before_install: - wget -q https://download.qt.io/official_releases/qt/5.13/5.13.2/qt-opensource-windows-x86-5.13.2.exe ...</code> </pre> <br><blockquote>  <em>Catatan:</em> Saat mengunduh, wget membuang sejumlah besar log dengan kemajuan pengunduhan.  Travis CI, seperti GitHub, memiliki batasan ukuran log pembangunan, jadi log yang tidak perlu harus dihindari.  Opsi -q alias --quite menyembunyikan keluaran log wget. </blockquote><p>  Kami melakukan pemasangan dependensi yang diperlukan: </p><br><pre> <code class="plaintext hljs">... install: - choco install golang - choco install yasm - ./qt-opensource-windows-x86-5.13.2.exe --script ./.ci/qt_installer_windows.qs ...</code> </pre> <br><p>  Dengan pemasangan GoLang dan Yasm, saya pikir seharusnya tidak ada pertanyaan.  Tapi peluncuran installer Qt, saya akan lebih memperhatikan. </p><br><p>  <a href="https://doc.qt.io/qtinstallerframework/index.html" rel="nofollow">QtInstallerFramework</a> mendukung otomatisasi proses instalasi dengan menulis <a href="https://doc.qt.io/qtinstallerframework/noninteractive.html" rel="nofollow">skrip</a> . </p><br><p>  Skrip siap pakai untuk menginstal versi Qt tertentu cukup mudah untuk google, saya hanya akan memberikan tautan ke yang sudah ada dan memperhatikan pilihan komponen untuk instalasi: </p><br><pre> <code class="plaintext hljs">... Controller.prototype.ComponentSelectionPageCallback = function() { var widget = gui.currentPageWidget(); widget.deselectAll(); widget.selectComponent("qt.qt5.5132.win32_msvc2017"); gui.clickButton(buttons.NextButton); } ...</code> </pre> <br><p>  Di sini saya mematikan semua komponen kotak centang dengan memanggil <code>widget.deselectAll();</code>  dan termasuk " <em>qt.qt5.5132.win32_msvc2017</em> " yang diperlukan untuk konstruksi.  Ada 2 aspek yang penting saat menulis prosedur ini: </p><br><ul><li>  selectComponent berfungsi seperti komponen grafis, dan oleh karena itu dependensi dan subkomponen dipilih oleh logika yang sama seperti jika kita memilihnya dalam antarmuka grafis.  Itu sebabnya tidak perlu khawatir tentang menyelesaikan dependensi. </li><li>  Nama-nama komponen dapat dilihat dalam mode instalasi "verbal".  Untuk melakukan ini, saya melakukan <code>widget.selectAll();</code> di salah satu iterasi <code>widget.selectAll();</code>  dan memulai instalasi dengan perintah <code>- ./qt-opensource-windows-x86-5.13.2.exe --verbose --script ./.ci/qt_installer_windows.qs</code> .  Dalam log, Anda dapat dengan mudah menemukan semua komponen yang Anda butuhkan dan memoderasi pemasangannya menggunakan widget.selectComponent / widget.deselectComponent. </li></ul><br><p>  Dan poin penting terakhir yang akan saya bahas dalam tutorial ini adalah lingkungan build.  Karena fakta bahwa instalasi dependensi dan perakitan berlangsung di dalam shell yang sama, setelah pengaturan Go dan Yasm di shell kami tidak ada PATH terdaftar sebelum file yang dapat dieksekusi.  Karena itu, Anda harus mendaftarkan PATH, GOROOT secara manual sebelum sujud: </p><br><pre> <code class="plaintext hljs">script: ... - setx path "%path%;C:\Qt\5.13.2\msvc2017\bin;C:\Go\bin;C:\ProgramData\chocolatey\lib\yasm\tools" - set GOROOT="c:\Go" - set PATH="%PATH%;C:\Qt\5.13.2\msvc2017\bin;C:\Go\bin;C:\ProgramData\chocolatey\lib\yasm\tools" - cmake -DCMAKE_PREFIX_PATH="C:\Qt\5.13.2\msvc2017;C:\Go\bin;C:\ProgramData\chocolatey\lib\yasm\tools" .. ...</code> </pre> <br><p>  Saya juga ingin memperhatikan fakta bahwa dalam CMAKE_PREFIX_PATH, dengan analogi, Anda perlu menentukan path to Go dan Yasm agar fungsi find_program berfungsi dengan benar. </p><br><p>  Mungkin nanti saya akan menjelaskan tentang pembuatan wadah buruh pelabuhan untuk bangunan dengan Qt di atas kapal. </p><br><p>  Semua skrip dapat ditemukan di <a href="https://github.com/semlanik/qtprotobuf" rel="nofollow">sini.</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id485034/">https://habr.com/ru/post/id485034/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id485024/index.html">Apa yang ada di bawah kap optimasi pengoptimalan GraalVM?</a></li>
<li><a href="../id485026/index.html">Peluang Georgia untuk para profesional TI</a></li>
<li><a href="../id485028/index.html">CRM 2020</a></li>
<li><a href="../id485030/index.html">8 biaya IEO teratas dan kapitalisasi mereka sekarang</a></li>
<li><a href="../id485032/index.html">Cara membuat aplikasi Bereaksi lebih cepat dengan negara hosting bersama</a></li>
<li><a href="../id485036/index.html">Mengapa saya perlu dukungan instrumental untuk pagination utama</a></li>
<li><a href="../id485042/index.html">Karena dukungan 5G wajib, smartphone dengan Snapdragon 865 akan lebih buruk pada tahun 2020</a></li>
<li><a href="../id485044/index.html">Kami membongkar jam digital dari pesawat ruang angkasa Soyuz</a></li>
<li><a href="../id485046/index.html">Bagaimana Merencanakan Strategi Produk Unggulan</a></li>
<li><a href="../id485050/index.html">Hypercube. Bagaimana kami menyediakan pengembang dengan perangkat uji dan tidak kehilangan mereka</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>