<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤛🏿 👩‍🌾 🚾 Prise en main de l'analyseur statique PVS-Studio pour Visual C ++ 👩🏻‍⚖️ 🤦 ✊🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dans cet article, je vais vous parler de PVS-Studio, un analyseur de code C et C ++, et vous montrer comment l'utiliser dans l'environnement Visual C ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Prise en main de l'analyseur statique PVS-Studio pour Visual C ++</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pvs-studio/blog/461007/"><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e61/add/44c/e61add44c3ad8d47978a57af0b2b60cb.png" alt="Image 8"></div><br>  Dans cet article, je vais vous parler de PVS-Studio, un analyseur de code C et C ++, et vous montrer comment l'utiliser dans l'environnement Visual C ++.  Ce guide est spécifiquement destiné aux utilisateurs débutants. <br><a name="habracut"></a><br><h2>  Installation de l'analyseur </h2><br>  PVS-Studio prend en charge Microsoft Visual Studio 2019, 2017, 2015, 2013, 2012 et 2010. Consultez la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">documentation</a> pour la configuration système requise.  Actuellement, PVS-Studio peut analyser des projets écrits en C, C ++, C # et Java.  Toutefois, cet article se concentre sur les programmeurs qui travaillent dans Visual C ++ et recherchent de l'aide pour démarrer avec l'analyseur. <br><br>  Le package d'installation peut être téléchargé <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> .  Après l'avoir exécuté, vous aurez le choix entre plusieurs options d'intégration (figure 1).  Les options non disponibles sont grisées. <br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f73/fd3/04d/f73fd304d32b6083509934876f4cc581.png" alt="Figure 1. Fenêtre de sélection des composants d'intégration."></div><br>  <font color="#999999"><i>Figure 1. Fenêtre de sélection des composants d'intégration.</i></font> <br><br>  Après avoir installé PVS-Studio, ouvrez la fenêtre À propos de Visual Studio et assurez-vous que l'analyseur est présent parmi les produits installés. <br><br><h2>  Vérification d'un projet </h2><br>  Une fois l'installation terminée, vous pouvez continuer à vérifier votre projet.  Vous pouvez également essayer d'analyser la solution entière.  Pour ce faire, cliquez sur Extensions → PVS-Studio → Vérifier → Solution (figure 2). <br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/716/ee3/2d8/716ee32d88dcc6bac832be8356dfaca6.png" alt="Figure 2. Vérification d'une solution avec PVS-Studio."></div><br>  <font color="#999999"><i>Figure 2. Vérification d'une solution avec PVS-Studio.</i></font> <br><br>  Si vous rencontrez des difficultés pour exécuter la vérification, consultez la section " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">PVS-Studio: Dépannage</a> " sur notre site Web.  Ce ne sont pas des conseils stupides comme "assurez-vous que la fiche est branchée dans la prise".  La section décrit les problèmes typiques signalés par nos utilisateurs et les moyens de les résoudre. <br><br><h2>  Gestion de la liste des avertissements </h2><br>  Une fois la vérification terminée, les messages de diagnostic apparaîtront dans une fenêtre spéciale.  Cette fenêtre contient de nombreux éléments, qui servent tous à manipuler la liste afin que vous puissiez afficher uniquement les avertissements qui vous intéressent.  Au début, cependant, cela pourrait sembler quelque peu compliqué. <br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b28/700/7c4/b287007c4520a416cd531e31962c01ca.png" alt="Figure 3. Fenêtre des avertissements. Cliquez sur l'image pour agrandir."></div><br>  <font color="#999999"><i>Figure 3. Fenêtre des avertissements.</i></font>  <font color="#999999"><i>Cliquez sur l'image pour agrandir.</i></font> <br><br>  La vue d'ensemble complète des éléments de la fenêtre se trouve dans la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">documentation</a> , mais maintenant nous allons nous concentrer uniquement sur les éléments de base: <br><br><ol><li>  Niveaux de certitude des avertissements.  La capture d'écran ci-dessus montre les niveaux moyen et élevé activés.  Le niveau bas traite davantage des «odeurs de code» et des avertissements qui, malheureusement, ont tendance à produire trop de faux positifs.  Pourquoi y a-t-il tant d'avertissements de bas et moyen niveaux mais si peu d'avertissements de haut niveau?  La réponse est que les diagnostics MISRA ont été activés, qui contiennent des règles telles que "la fonction ne doit avoir qu'un seul point de sortie".  Bien sûr, vous n'avez normalement pas besoin de ces diagnostics, ils sont donc désactivés par défaut.  Remarque: " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Comment vérifier rapidement les avertissements intéressants donnés par l'analyseur PVS-Studio pour le code C et C ++?</a> ". </li><li>  Le filtre.  Vous pouvez filtrer les messages par code, CWE, texte, projet ou fichier. </li><li>  Le numéro de la ligne de déclenchement.  Certains diagnostics peuvent faire référence à un certain nombre de lignes: ces avertissements ont des points de suspension à côté du numéro de ligne. </li></ol><br><h2>  SAST </h2><br>  PVS-Studio est un outil de test statique de sécurité des applications (SAST), ce qui signifie qu'il peut détecter les vulnérabilités potentielles dans le code source et afficher l'identificateur de faiblesse correspondant selon une classification particulière. <br><br>  PVS-Studio prend en charge les classifications de faiblesse suivantes: <br><br><ol><li>  CWE </li><li>  SEI CERT </li><li>  Misra </li></ol><br>  Pour activer les codes CWE, ouvrez le menu déroulant de la fenêtre de l'analyseur, puis cochez Afficher les colonnes&gt; CWE <br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/919/85b/e34/91985be349bf7385fa7f3878ef57dcde.png" alt="Figure 4. Activation des codes CWE dans le menu déroulant."></div><br>  <font color="#999999"><i>Figure 4. Activation des codes CWE dans le menu déroulant.</i></font> <br><br>  Une autre façon de le faire est Extensions&gt; PVS-Studio&gt; Afficher les codes CWE dans la fenêtre de sortie sur la barre de menus de Visual Studio <br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/0b6/582/d8c/0b6582d8c2626066567dfd111439cbc6.png" alt="Figure 5. Sous-menu PVS-Studio dans le menu Extensions."></div><br>  <font color="#999999"><i>Figure 5. Sous-menu PVS-Studio dans le menu Extensions.</i></font> <br><br>  Contrairement à cela, les diagnostics MISRA sont activés dans la fenêtre d'options: <br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b89/898/709/b89898709db7045f949fb564c6c80059.png" alt="Figure 6. Liste des faiblesses détectables."></div><br>  <font color="#999999"><i>Figure 6. Liste des faiblesses détectables.</i></font> <br><br>  Vous pouvez en savoir plus sur ces classifications <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> . <br><br><h2>  Vérification des projets à partir de la ligne de commande </h2><br>  PVS-Studio_Cmd.exe est un utilitaire pour vérifier les projets et solutions C ++ .vcxproj à partir de la ligne de commande.  Cela peut être utile si vous souhaitez automatiser le processus d'analyse.  Le programme se trouve dans le répertoire d'installation, qui est par défaut «C: \ Program Files (x86) \ PVS-Studio». <br><br>  L'utilitaire a plusieurs <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">paramètres</a> , mais vous n'en aurez besoin que de trois pour commencer: <ul><li>  --target: le fichier du projet ou de la solution à vérifier. </li><li>  --output: le fichier plog dans lequel stocker le rapport d'analyse. </li><li>  --progress: suivre la progression de l'analyse. </li></ul><br>  Voici ce que vous verrez après avoir commencé la vérification: <br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/3ce/ee2/aa1/3ceee2aa11c0bf9f887ad8959d7cdd65.png" alt="Figure 7. Sortie de l'utilitaire PVS-Studio_Cmd.exe"></div><br>  <font color="#999999"><i>Figure 7. Sortie de l'utilitaire PVS-Studio_Cmd.exe</i></font> <br><br>  Une fois la vérification terminée, un fichier plog contenant le rapport d'analyse sera créé dans le répertoire spécifié dans les paramètres de démarrage.  Ce rapport peut être converti dans d'autres formats à l'aide de l'utilitaire PlogConverter.exe, et si vous souhaitez ouvrir le rapport dans l'EDI, double-cliquez simplement sur le fichier plog dans l'Explorateur Windows. <br><br>  Le fichier de rapport peut également être ouvert à partir du menu Extensions: Extensions&gt; PVS-Studio&gt; Ouvrir / Enregistrer&gt; Ouvrir le rapport d'analyse ... <br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/490/7ac/cc5/4907accc516b05ccfedf52acc9c85d9f.png" alt="Figure 8. Ouverture d'un rapport d'analyse à partir du menu du plugin."></div><br>  <font color="#999999"><i>Figure 8. Ouverture d'un rapport d'analyse à partir du menu du plugin.</i></font> <br><br>  Consultez la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">documentation</a> pour plus de détails sur l'utilitaire et ses paramètres. <br><br><h2>  Suppression des faux positifs </h2><br>  L'analyseur fournit une variété de moyens pour supprimer les faux positifs.  Ils sont décrits en détail dans les sections suivantes: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Réglage fin</a> . </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Suppression en masse</a> , ce qui est particulièrement utile lorsque vous souhaitez supprimer uniquement les avertissements qui font référence à du code nouveau ou modifié. </li></ul><br><h2>  Exemple d'avertissement </h2><br>  Jetons un coup d'œil à un exemple d'avertissement émis par l'analyseur.  L'extrait de code suivant est extrait du projet ReactOS: <br><br><pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">VOID NTAPI </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AtapiDmaInit</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(....)</span></span></span><span class="hljs-function"> </span></span>{ .... ULONG treg = <span class="hljs-number"><span class="hljs-number">0x54</span></span> + (dev &lt; <span class="hljs-number"><span class="hljs-number">3</span></span>) ? (dev &lt;&lt; <span class="hljs-number"><span class="hljs-number">1</span></span>) : <span class="hljs-number"><span class="hljs-number">7</span></span>; .... }</code> </pre> <br>  Message de diagnostic de PVS-Studio: V502 L'opérateur '?:' Fonctionne peut-être d'une manière différente de celle attendue.  L'opérateur '?:' A une priorité inférieure à l'opérateur '+'.  uniata id_dma.cpp 1610 <br><br>  L'expression <i>0x54 + (dev &lt;3)</i> sera toujours évaluée à <i>vrai</i> : la constante non nulle <i>0x54</i> est d'abord ajoutée au résultat de l'expression <i>(dev &lt;3)</i> , qui peut être évaluée à 0 ou 1, et alors seulement est la valeur résultante par rapport à zéro. <br><br>  Voici à quoi ressemble la bonne version: <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">VOID NTAPI </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AtapiDmaInit</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(....)</span></span></span><span class="hljs-function"> </span></span>{ .... ULONG treg = <span class="hljs-number"><span class="hljs-number">0x54</span></span> + ((dev &lt; <span class="hljs-number"><span class="hljs-number">3</span></span>) ? (dev &lt;&lt; <span class="hljs-number"><span class="hljs-number">1</span></span>) : <span class="hljs-number"><span class="hljs-number">7</span></span>); .... }</code> </pre> <br>  Nous avons résolu le problème en plaçant l'opération <i>'?:'</i> Entre parenthèses afin que son résultat dépende désormais du résultat de l'expression <i>(dev &lt;3)</i> . <br><br><h2>  Conclusion </h2><br>  C'était une brève introduction à la prise en main de PVS-Studio pour Visual C ++.  Bien sûr, il ne couvre pas tous les aspects, alors bienvenue sur notre <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">blog</a> , où nous expliquons en détail comment travailler avec l'analyseur et voyons la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">documentation</a> pour une description complète des messages de diagnostic et des paramètres de l'outil. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr461007/">https://habr.com/ru/post/fr461007/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr460995/index.html">Nous déployons le projet ML en utilisant Flask comme API REST et le rendons accessible via l'application Flutter</a></li>
<li><a href="../fr460997/index.html">Les touristes aident les scientifiques à estimer le nombre de grands prédateurs</a></li>
<li><a href="../fr460999/index.html">Jouons un petit jeu avec Lamoda</a></li>
<li><a href="../fr461003/index.html">Analyse: comment fonctionne le marché du trading haute fréquence en bourse</a></li>
<li><a href="../fr461005/index.html">Test pour l'entreprise: poser les bonnes questions lors de l'entretien</a></li>
<li><a href="../fr461009/index.html">Comment faire un standard en 10 jours. Deuxième partie Ennuyeux</a></li>
<li><a href="../fr461013/index.html">Réservation d'une connexion Internet</a></li>
<li><a href="../fr461015/index.html">Vivez et apprenez. Partie 2. Université: 5 ans ou 5 couloirs?</a></li>
<li><a href="../fr461017/index.html">Nouvel algorithme de suivi du GPU: suivi du chemin du front d'onde</a></li>
<li><a href="../fr461019/index.html">Comment est la vie des développeurs en Iran</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>