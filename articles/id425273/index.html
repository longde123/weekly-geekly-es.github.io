<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ¦… ğŸ§—ğŸ¾ ğŸ§‘ğŸ¿â€ğŸ¤â€ğŸ§‘ğŸ¿ Cara lain untuk menggunakan komposisi buruh pelabuhan ğŸ¥ ğŸ‘¨ğŸ¼â€ğŸš€ ğŸ§¤</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Mengikuti Docker + Laravel =? Saya ingin berbicara tentang cara yang agak tidak biasa untuk menggunakan utilitas pembuat docker. 


 Sebagai permulaan...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Cara lain untuk menggunakan komposisi buruh pelabuhan</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/425273/"><p>  Mengikuti <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Docker + Laravel =?</a>  Saya ingin berbicara tentang cara yang agak tidak biasa untuk menggunakan utilitas pembuat docker. </p><br><p>  Sebagai permulaan, bagi mereka yang tidak tahu mengapa komposisi buruh pelabuhan diperlukan.  Ini adalah utilitas yang memungkinkan Anda untuk menjalankan pada host terpisah satu set layanan terkait yang dikemas dalam wadah buruh pelabuhan.  Versi awal ditulis dengan python dan dapat diinstal dengan dua cara: </p><a name="habracut"></a><br><ul><li> melalui manajer paket sistem operasi ( <code>apt install docker-compose</code> untuk Ubuntu dan <code>yum install docker-compose.noarch</code> for Centos) </li><li>  via python dependency manager ( <code>pip install docker-compose</code> ) </li></ul><br><p>  Masalah dengan metode pertama adalah bahwa biasanya dalam repositori sistem operasi docker-compose versi lama.  Ini merupakan masalah jika Anda perlu menggunakan versi terbaru dari docker daemon atau menggunakan fitur-fitur khusus untuk versi spesifik dari format file docker-compose.yaml (matriks fitur yang didukung oleh versi format dan versi utilitas docker-compose dapat ditemukan di situs web buruh pelabuhan resmi). </p><br><p>  Sekarang pengembang buruh pelabuhan <del>  menulis ulang utilitas saat bepergian </del>  , membuat kesalahan, sebenarnya mengemas skrip python dengan lingkungan ke dalam satu paket dan menyediakannya sebagai file biner, yang memungkinkan Anda untuk menginstalnya dengan cara berikut (ini adalah metode yang direkomendasikan saat ini): </p><br><ol><li><p>  Kami melihat versi terbaru di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">https://github.com/docker/compose/releases</a> dan mengunduhnya </p><br><pre> <code class="plaintext hljs">$ sudo curl -L "https://github.com/docker/compose/releases/download/1.22.0/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose</code> </pre> <br></li><li><p>  mengatur hak untuk menjalankan aplikasi </p><br><pre> <code class="plaintext hljs">$ sudo chmod +x /usr/local/bin/docker-compose</code> </pre> <br></li><li><p>  Selain itu, Anda dapat mengatur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">penyelesaian otomatis</a> untuk perintah penerjemah bash dan zsh </p><br></li><li><p>  periksa instalasi </p><br><pre> <code class="plaintext hljs">$ docker-compose --version docker-compose version 1.22.0, build 1719ceb</code> </pre> <br></li></ol><br><p>  Saya percaya bahwa satu biner sangat keren, karena  kita tidak perlu menarik dependensi python.  Ya, dan secara umum - mungkin lingkungan python kita benar-benar rusak pada mesin target, yang ingin kita konfigurasi !!! </p><br><p><img src="https://habrastorage.org/webt/1t/bj/hm/1tbjhmezttp2dgxb_wtiariskfm.png"><br>  <em>Contoh kebingungan di lingkungan python</em> </p><br><p>  Tetapi masih ada jalan ke-4, yang ingin saya bicarakan.  Ini adalah kemampuan untuk menjalankan docker-compose melalui docker.  Memang, sudah ada gambar resmi yang dikumpulkan di Docker Hub ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">https://hub.docker.com/r/docker/compose/</a> ).  Mengapa mereka dibutuhkan? </p><br><ul><li>  jika kita ingin bekerja dengan beberapa versi docker-compose secara bersamaan (walaupun biasanya versi stabil terakhir sudah cukup) </li><li>  jika kami tidak memiliki python atau tidak ingin menggunakannya (misalnya, kami memiliki distribusi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">CoreOS Container Linux yang</a> ringan) </li><li>  digunakan dalam pipa CI / CD. </li></ul><br><p>  Ayo kita coba! </p><br><p>  Seperti yang biasa kami lakukan meluncurkan kontainer: </p><br><pre> <code class="plaintext hljs">$ docker-compose up -d</code> </pre> <br><p>  Melalui utilitas yang dikemas dalam wadah buruh pelabuhan: </p><br><pre> <code class="plaintext hljs">$ docker run --rm -v /var/run/docker.sock:/var/run/docker.sock -v "$PWD:/rootfs/$PWD" -w="/rootfs/$PWD" docker/compose:1.13.0 up -d</code> </pre> <br><p>  Terlalu bertele-tele, ya?  Otak dapat rusak untuk mengingat semua parameter ini.  Karena itu, kami akan mencoba membuat hidup kami lebih mudah dan menulis pembungkus dalam bahasa shell.  Tapi pertama-tama, mari kita lihat parameter yang dilewati: </p><br><ul><li>  <code>--rm</code> - menghapus wadah sementara setelah berhenti, mis.  kami tidak meninggalkan sampah di sistem </li><li>  <code>-v /var/run/docker.sock:/var/run/docker.sock</code> - tanpa ini, komposisi buruh pelabuhan tidak akan dapat terhubung ke daemon buruh pelabuhan pada host </li><li>  <code>-v "$PWD:/rootfs/$PWD" -w="/rootfs/$PWD"</code> - memungkinkan Anda untuk meneruskan direktori saat ini di dalam wadah sehingga utilitas melihat file pembuat docker-compose </li></ul><br><p>  Kami masih kekurangan kemampuan untuk menginterpolasi nilai-nilai dalam file docker-compose.  Ini adalah proses dimana utilitas menggantikan variabel lingkungan dalam file YAML.  Misalnya, dalam sebuah fragmen </p><br><pre> <code class="plaintext hljs">version: "2.1" services: pg: image: postgres:9.6 environment: POSTGRES_USER: ${POSTGRES_DB_USER} POSTGRES_PASSWORD: ${POSTGRES_DB_PASSWORD}</code> </pre> <br><p>  variabel <code>POSTGRES_DB_USER</code> dan <code>POSTGRES_DB_PASSWORD</code> akan dibaca dari lingkungan.  Hal ini memungkinkan untuk mem-tempel file-file penyusun buruh pelabuhan dengan tingkat kenyamanan tertentu.  Yaitu  kita perlu menangkap lingkungan dari mesin host dan memindahkannya ke dalam wadah. </p><br><p>  Mari kita selesaikan masalahnya dengan menulis skrip bash. </p><br><pre> <code class="plaintext hljs">#!/bin/sh #       TMPFILE=$(mktemp) #       env &gt; "${TMPFILE}" #        VERSION="1.13.0" #  docker-compose docker run \ --rm \ -e PWD="$PWD" \ --env-file "${TMPFILE}" \ -v /var/run/docker.sock:/var/run/docker.sock \ -v "$PWD:/rootfs/$PWD" \ -w="/rootfs/$PWD" \ docker/compose:"${VERSION}" \ "$@" #         rm "{$TMPFILE}"</code> </pre> <br><p>  Baris tambahan muncul: </p><br><ul><li>  <code>-e PWD="$PWD"</code> - untuk berjaga-jaga, teruskan direktori saat ini </li><li>  <code>--env-file "${TMPFILE}"</code> - di sini semua variabel lingkungan lainnya ditransfer dari mesin host </li><li>  <code>docker/compose:"${VERSION}"</code> - nama gambar, ambil versi dari variabel </li><li>  <code>"$@"</code> - konstruksi ini memungkinkan Anda untuk menggunakan skrip seolah-olah itu adalah utilitas pembuat docker, mis.  secara transparan meneruskan argumennya ke wadah buruh pelabuhan. </li></ul><br><p>  Kita dapat menyimpan skrip, misalnya, di <code>/usr/local/bin/docker-compose</code> , atur flag eXecute di atasnya dan gunakan.  Skrip di atas tidak berpura-pura 100% bebas dari kesalahan atau kekurangan dan lebih merupakan ilustrasi dari metode ini. </p><br><p>  Kami sendiri menggunakan jalur pipa CI / CD dengan cara ini.  Ini bahkan menghemat lalu lintas sampai batas tertentu.  Gambar target buruh pelabuhan diambil dari cache lokal. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id425273/">https://habr.com/ru/post/id425273/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id425263/index.html">Festival iFEST akan diadakan di Nizhny Novgorod</a></li>
<li><a href="../id425265/index.html">Aturan pengembangan di Yandex.Health</a></li>
<li><a href="../id425267/index.html">Tempat kerja pengembang .NET atau kesulitan dalam memilih konfigurasi ideal ver.2.0</a></li>
<li><a href="../id425269/index.html">Hackathon GAZ - cara menyentuh raksasa otomatis</a></li>
<li><a href="../id425271/index.html">WPA3 bisa lebih aman: pendapat ahli</a></li>
<li><a href="../id425275/index.html">12 tips untuk menskalakan Node.js</a></li>
<li><a href="../id425279/index.html">Bagaimana cara mewawancarai Google: apa yang akan terjadi, apa yang tidak boleh dilewati</a></li>
<li><a href="../id425281/index.html">Pedoman untuk membawa "mengkondisikan" klon dari router mini populer Cina Hame A15, alias "A5-V11 tidak bermerek"</a></li>
<li><a href="../id425283/index.html">Lokalisasi tanpa batas, atau bagaimana kami menerjemahkan peta secara real time</a></li>
<li><a href="../id425285/index.html">Jika Anda tidak mempekerjakan Jones, maka Anda tidak layak mendapatkan junjungan</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>