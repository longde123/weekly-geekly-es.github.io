<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üéüÔ∏è ‚ÜôÔ∏è üîó Teknologi audio nirkabel Bluetooth: mana yang lebih baik? üöÆ ü§úüèæ ü§§</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dengan perkembangan teknologi, headphone analog ‚Äútabung‚Äù yang sudah begitu dikenal turun dalam sejarah - headphone ini semakin banyak digantikan oleh ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Teknologi audio nirkabel Bluetooth: mana yang lebih baik?</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/433502/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/uz/_p/or/uz_por_7qlk9snfb7v_jg2x5iae.jpeg"></div><br>  Dengan perkembangan teknologi, headphone analog ‚Äútabung‚Äù yang sudah begitu dikenal turun dalam sejarah - headphone ini semakin banyak digantikan oleh perangkat nirkabel Bluetooth. <br><br>  Smartphone modern kehilangan konektor biasa demi perlindungan kelembaban dan debu. <br><br>  Pengembang merilis semua versi baru protokol Bluetooth dan semua versi baru codec, menjanjikan "lebih cepat, lebih tinggi, lebih kuat" - lebih sedikit penundaan dalam pemutaran dan kualitas yang lebih baik. <br><br>  Apakah semuanya baik-baik saja?  Ayo lihat. <br><a name="habracut"></a><br><h2>  Pendahuluan </h2><br>  Saya tidak akan mempelajari implementasi teknis dari protokol, serta spesifikasi yang membosankan.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" class="user_link">ValdikSS yang</a> terhormat, yang sebagian besar bertindak sebagai inspirasi dan bahkan seorang konsultan ilmiah dalam artikel ini, sedang mempersiapkan materi komprehensif tentang codec - dan di sana semuanya akan disajikan secara lebih rinci dan benar secara teknis. <br><br>  Saya ingin menceritakan lebih banyak tentang pengalaman pribadi.  Nah, sedikit menghibur (membosankan?) Latihan. <br><br>  Setahun setengah yang lalu, saya bersemangat tentang gagasan aptX.  Ya, saya membaca banyak ulasan seperti <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">ini</a> dan percaya pada semua tikungan dan belokan teknis ini.  Seorang anak lahir - dan saya benar-benar ingin menonton pertunjukan dengan headphone di malam hari bersama istri saya, tanpa membuat keributan dan tidak membangunkan siapa pun di rumah. <br><br>  Apa akibatnya? <br><br><h2>  Kualitas </h2><br>  Mari kita mulai dengan angka dan fakta (halo, Wikipedia!) <br><br>  <b>SBC</b> adalah codec lama yang baik, sesuai dengan standar A2DP.  Codec adalah hasil karya Frans de Bont <i>(F. de Bont, M. Groenewegen dan W. Oomen, "Sistem Pengkodean Audio Berkualitas Tinggi pada 128 kb / s", Konvensi AES ke-98, 25-28 Februari, 1995)</i> dan menggunakan algoritma yang dijelaskan dalam <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">paten EP-0400755B1</a> .  Patut dicatat bahwa penulis paten memperbolehkan penggunaan SBC hanya secara gratis di aplikasi Bluetooth, namun paten tersebut berakhir pada 2 Juni 2010.  Karena standar A2DP sangat umum, sangat sulit untuk menemukan headphone atau speaker yang tidak memiliki dukungan SBC. <br><br>  Codec menyediakan frekuensi pengambilan sampel 16, 32, 44.1, 48 kHz dengan laju aliran 10-1500 kbit / s.  Ya, Anda dengar benar.  Hingga 1500 kbps.  Tidak ada batas bitrate dalam codec.  Tetapi lebih lanjut tentang itu nanti. <br><br>  Codec <b>aptX</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">dikembangkan pada tahun 1988 di Queen's University Belfast</a> .  Ya, sebelum Bluetooth masih ada sekitar belasan tahun, jadi codec itu digunakan dalam peralatan audio profesional.  Qualcomm saat ini memegang hak, dan oleh karena itu penggunaan memerlukan lisensi dan royalti.  Pada tahun 2014, biayanya kira-kira sebagai berikut: pembayaran satu kali sebesar $ 6.000 dan ‚âà $ 1 untuk setiap perangkat yang dirilis untuk pihak hingga 10.000 perangkat.  Karena alasan ini, banyak perangkat dengan chip Snapdragon 835, 845, 821, 820, 810, 805, 801, 800, 650, 615, 410 sangat mungkin dan mendukung aptX, tetapi tidak diaktifkan di sana, karena lisensi tidak dibeli.  Tentang itu - juga di bawah ini. <br><br>  Dengan kedalaman bit 16 bit dan frekuensi sampling 48 kHz, codec dapat memberikan bit rate 384 kbit / s (saluran ganda). <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Daftar produk yang secara resmi mendukung aptX</a> .  Anda dapat menemukan banyak sistem yang tidak dikenal dengan dukungan aptX di Aliexpress, tetapi bersiaplah untuk kenyataan bahwa sebenarnya akan ada SBC lama yang sama baik - dan tidak lebih. <br><br>  <b>aptX HD</b> - codec yang sama, tetapi dengan profil pengkodean yang berbeda, memiliki kecepatan aliran 576 kbit / s, dukungan untuk frekuensi pengambilan sampel hingga 48 kHz dan kedalaman bit hingga 24 bit.  Beberapa orang menyebut ini aptX Lossless codec - tetapi ini omong kosong, jika hanya karena saat ini tidak mungkin untuk mencapai nilai stream yang dapat membawa data lossless.  Keuntungan khusus dari codec ini adalah penundaan penyandian yang dapat disesuaikan, yang dapat dikurangi menjadi 1 ms pada frekuensi sampling 48 kHz.  Juga, codec ini sangat menguntungkan dari sudut pandang pemuatan prosesor, yang mengekspresikan keunggulan dibandingkan dengan MP3 dan AAS. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Daftar produk yang secara resmi mendukung aptX HD</a> .  Dia cukup kecil. <br><br>  <b>aptX Low latency</b> (atau LL) adalah versi khusus dari codec yang memungkinkan Anda untuk mengurangi waktu tunda suara menjadi kurang dari 40 ms.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Daftar produk yang secara resmi mendukung aptX LL</a> . <br><br><img src="https://habrastorage.org/webt/oz/nd/5q/oznd5qcoovjbj8f4xdtfydbl_ym.png" alt="gambar"><br><br>  Itu dia.  Gambar inilah yang pada suatu waktu membeli saya dengan jeroan ayam itik.  Keterlambatan!  Lagi pula, siapa yang ingin mendengar suara ledakan di beberapa film aksi, jeritan monster dalam film horor atau raungan kerumunan orang di pertandingan sepak bola ketika semuanya berakhir? <br><br>  Tetapi apakah semua ini benar-benar demikian? <br><br>  Sayangnya, tidak. <br><br>  Seperti halnya materi pemasaran, angkanya tidak masuk akal.  Penundaan sebagian besar tergantung pada buffering dalam sistem dan implementasi codec.  Jadi, penundaan dengan SBC mungkin kurang dari 40 ms, yang, mengingat standar penyiaran televisi (+40 ms ... ‚àí60 ms), sangat dapat diterima. <br><br>  <u>Singkatnya:</u> <br><br><ol><li>  Tidak ada codec yang ada yang bisa lebih baik dari teknologi kabel, karena tidak ada codec yang dapat mencapai kompresi lossless sejati. </li><li>  Codec paling populer adalah SBC.  Dia adalah yang paling fleksibel dalam pengaturan.  Dan terlepas dari kenyataan bahwa aptX dirilis sebelumnya, itu tidak bisa mengalahkan popularitas SBC, tampaknya karena yang terakhir ini gratis. </li><li>  Kualitas suara sangat tergantung pada implementasi codec, serta pada kinerja perangkat keras headphone / speaker pada umumnya - jika speaker itu sendiri lemah, maka kualitasnya tidak dapat ditingkatkan oleh codec apa pun.  Oleh karena itu, di masa depan, membandingkan kualitas, kita akan berbicara tentang memainkan konten yang sama dari sumber yang sama pada speaker / headphone yang sama, tetapi dengan codec yang berbeda. </li></ol><br><h2>  Hasil yang praktis dan sangat subyektif </h2><br><img src="https://habrastorage.org/webt/fj/uf/kj/fjufkjmv-sxcezemnqcz3ztyue4.jpeg"><br><br>  Informasi ini didasarkan pada pengalaman satu setengah tahun yang telah disebutkan dalam mengoperasikan, membandingkan dan menarik pendengar luar. <br><br>  Pengalaman ini didasarkan pada mendengarkan lossless pada pemutar SONY Walkman NWZ-A17, di mana codec dapat dipilih, serta menonton berbagai program dengan output audio melalui Avantree Priva III. <br><br>  Ada tiga headphone: Sennheiser PMX 60, Koss Porta Pro dan Koss UR-20. <br><br>  Jabra BT3030 (SBC) dan Avantree Clipper Pro (aptX) digunakan sebagai penerima sinyal nirkabel. <br><br>  Speaker Voombox Outdoor (SBC) dan headphone konduksi tulang Aftershokz Trekz Titanium (aptX) juga digunakan. <br><br>  Semua equalizer dan enhancers dimatikan - dan ini penting. <br><br>  <u>Total:</u> <br><br><ol><li>  Kualitas suara yang dimainkan dengan koneksi kabel selalu lebih baik.  Ini tanpa keraguan. </li><li>  Perbedaan antara SBC dan aptX sangat sulit didengar - dan hanya dalam hal beberapa jenis musik.  Sebagai contoh, penulis artikel jelas mendengar perbedaan dalam cello solo dalam komposisi klasik, sedangkan untuk instrumen biola dan frekuensi rendah perbedaannya kurang terlihat.  Dalam genre modern - pop, musik elektronik, dan rock - perbedaannya tidak terdengar.  Dalam beberapa kasus, secara subjektif tampak bahwa transmisi SBC terdengar lebih baik daripada aptX. </li><li>  Penundaan antara SBC dan aptX hanya dapat dilihat jika Anda terhubung ke sumber yang sama dan memasukkan penerima yang berbeda ke telinga yang berbeda (well, saluran kiri adalah SBC, dan yang kanan adalah aptX, misalnya).  Hampir tidak mungkin untuk melihat penundaan dengan gambar, tetapi karena cerita bahwa aptX dimaksudkan untuk adegan dan konten yang dinamis adalah mitos. </li><li>  Kejutan itu disebabkan oleh kualitas suara Voombox Outdoor yang agak murah dan "tidak terkenal".  Rupanya, ini adalah keberhasilan implementasi SBC, yang disebutkan di atas. </li><li>  Implementasi aptX pada headphone dengan konduksi tulang benar-benar tidak dapat dipahami - teknologinya sangat spesifik, dan oleh karena itu kehilangan kualitasnya signifikan karena teknologinya sendiri.  Dengan mempertimbangkan rentang kecil dari "rentang" operasi perangkat, implementasi pasangan yang sangat buruk dengan dua perangkat, saya dapat mengatakan bahwa Aftershokz adalah perusahaan yang berinvestasi lebih banyak dalam pemasaran daripada dalam pengembangan. </li></ol><br><br>  Saya tidak berpendapat bahwa jika Anda menghubungkan semua jenis alat analisa spektral dan sebagainya, Anda dapat dan harus melihat perbedaannya.  Tapi telinga manusia, dan bahkan lebih buruk - telinga manusia rata-rata - bukan perangkat spektral, dan karena itu tidak mendengar semua nuansa ini. <br><br><h2>  Latihan: memperbaiki apa yang bisa diperbaiki </h2><br><h3>  Bagian 1. Nyalakan aptX </h3><br>  Seperti yang telah disebutkan, di beberapa perangkat penggunaan aptX dinonaktifkan, mungkin untuk menghindari penuntutan paten. <br><br>  Masalah ini dapat diselesaikan dengan cukup sederhana dengan menyelipkan perangkat perpustakaan untuk mengimplementasikan codec dan menulis kemampuan untuk bekerja dengan codec ini di build.prop. <br><br>  Di Internet ada sejumlah besar solusi semacam ini.  Saya mengambil kebebasan menggabungkan mereka menjadi satu, sambil menyadarinya sebagai modul untuk Magisk.  Ya, saya sangat menyukai proyek ini dan saya pikir menerapkan perubahan dalam sistem dalam bentuk modul Magisk adalah solusi yang lebih baik dan lebih aman dengan kemampuan untuk menyimpan sistem dalam bentuk aslinya dan dengan cara yang mudah untuk memutar kembali. <br><br>  Modul ini dapat diunduh <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">dari sini</a> .  Ya, saya tahu tentang github.  Dan tidak, sampai saya punya waktu untuk meletakkannya di sana. <br><br>  Entri dalam build.prop, termasuk aptX, dan, jika memungkinkan, aptX HD, akan ditiru secara otomatis oleh modul. <br><br><img src="https://habrastorage.org/webt/vg/lc/gu/vglcguyqsbbyxptonmhdw-5ta3y.png"><br><br><h3>  Bagian 2. Meningkatkan Bitrate SBC </h3><br>  Seperti yang dilaporkan sebelumnya, codec SBC pada dasarnya tidak memiliki batasan bitrate.  Namun, pabrikan biasanya menetapkan batas 342 kbit / s untuk mono dan 345 kbit / s untuk stereo untuk memastikan operasi yang andal dengan semua jenis perangkat penerima. <br><br>  Pada saat yang sama, spesifikasi A2DP v1.2, yang aktif dari 2007 hingga 2015, mengharuskan semua perangkat decoding untuk bekerja dengan benar dengan bitrate hingga 320 kbit / s untuk mono dan 512 kbit / s dalam hal sinyal stereo. <br><br>  Dalam versi baru spesifikasi, tidak ada batas bitrate sama sekali.  Diasumsikan bahwa headphone modern yang dirilis setelah 2015 dan mendukung EDR dapat mendukung bitrate hingga 730 kbps. <br><br>  Bahkan, ini tentu saja tidak demikian.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Dalam sebuah studi ekstensif yang</a> dilakukan oleh <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" class="user_link">ValdikSS</a> , ditemukan bahwa hampir semua perangkat penerima andal bekerja dengan laju bit 454 kbit / dtk, dan angka yang cukup besar dengan laju bit 507 kbit / dtk. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Dalam penelitiannya,</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" class="user_link">ValdikSS</a> juga menunjukkan bahwa, berbeda dengan kepercayaan populer tentang kualitas suara dari aptX codec, itu mungkin menghasilkan hasil yang lebih buruk pada beberapa file daripada SBC dengan bit rate standar 328 kbps, dan beralih ke SBC bitrate tinggi akan menghasilkan suara yang sering melebihi aptX, pada headphone apa pun. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" class="user_link">Berdasarkan</a> data ini, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" class="user_link">ValdikSS</a> mengirim komentar ke para pengembang Lineage OS dan Google, tetapi sejauh ini belum ada reaksi. <br><br>  Dengan demikian, kita hanya bisa melakukan modifikasi pada tumpukan Bluetooth secara manual. <br><br>  Kami membutuhkan IDA Pro dengan kemampuan untuk mendekompilasi ARM, editor HEX apa pun (saya menggunakan WinHEX) dan file bluetooth.default.so dari perangkat kami.  Biasanya terletak di jalur / sistem / lib / hw dan lebih jarang - juga di jalur / sistem / lib64 / hw (akses root pasti diperlukan). <br><br>  Jadi, buka file bluetooth.default.so. Operasi dan modifikasi yang dijelaskan di bawah ini hanya berlaku untuk tumpukan Android asli (bluedroid).  Jika Anda melihat baris ‚ÄúNeeded Library 'com.qualcomm.qti.bluetooth_audio@1.0.so'‚Äù atau sejenisnya di IDA Pro, dengan probabilitas tinggi instruksi ini tidak akan membantu Anda. <br><br><img src="https://habrastorage.org/webt/cf/3l/jb/cf3ljbjgckew4pd9tbutsy-tyaw.png"><br><br>  Tugas pertama kami adalah mengganti Stereo Bersama dengan Dual Channel dalam konfigurasi standar. <br><br>  Kami akan bekerja dengan <a href="">fungsi bta_av_build_src_cfg</a> . <br><br>  Untuk menemukan prosedur ini di IDA, kami akan menggunakan pencarian <a href="">baris untuk pesan karakteristik di log debug "Cant parse src cap ret =% d"</a> : <br><br><img src="https://habrastorage.org/webt/wh/dk/ex/whdkexvibrxijvj7pqb-buzb0z8.png"><br><br><img src="https://habrastorage.org/webt/ea/2h/nh/ea2hnhbszbtyieokldywuch2qvi.png"><br><br>  Akibatnya, cukup cepat kita menemukan fungsi itu sendiri dalam bentuk kode: <br><br><img src="https://habrastorage.org/webt/mf/5_/_9/mf5__9yydhgwip0lvemgqwcwocw.png"><br><br>  Tugas kita adalah mengganti struktur asli cek <br><br><pre><code class="plaintext hljs">if (src_cap.ch_mode &amp; A2D_SBC_IE_CH_MD_JOINT) pref_cap.ch_mode = A2D_SBC_IE_CH_MD_JOINT; else if (src_cap.ch_mode &amp; A2D_SBC_IE_CH_MD_STEREO) pref_cap.ch_mode = A2D_SBC_IE_CH_MD_STEREO; else if (src_cap.ch_mode &amp; A2D_SBC_IE_CH_MD_DUAL) pref_cap.ch_mode = A2D_SBC_IE_CH_MD_DUAL; else if (src_cap.ch_mode &amp; A2D_SBC_IE_CH_MD_MONO) pref_cap.ch_mode = A2D_SBC_IE_CH_MD_MONO;&lt;/code&gt;  &lt;code&gt; if (src_cap.ch_mode &amp; A2D_SBC_IE_CH_MD_DUAL) pref_cap.ch_mode = A2D_SBC_IE_CH_MD_DUAL; else if (src_cap.ch_mode &amp; A2D_SBC_IE_CH_MD_STEREO) pref_cap.ch_mode = A2D_SBC_IE_CH_MD_STEREO; else if (src_cap.ch_mode &amp; A2D_SBC_IE_CH_MD_DUAL) pref_cap.ch_mode = A2D_SBC_IE_CH_MD_DUAL; else if (src_cap.ch_mode &amp; A2D_SBC_IE_CH_MD_MONO) pref_cap.ch_mode = A2D_SBC_IE_CH_MD_MONO;</code> </pre> <br>  Ada beberapa cara untuk melakukan ini. <br><br>  Yang pertama adalah penggantian instruksi TST.W R0, # 1 dengan TST.W R0, # 4 dan MOVS R0, # 1 dengan MOVS R0, # 4 dalam urutan pemeriksaan: <br><br><img src="https://habrastorage.org/webt/6e/zu/so/6ezusojttx0gavinlppmqeroet8.png"><br><br>  Dalam bytecode, ini adalah penggantian x01 ke x04.  Penting untuk mencatat urutan karakteristik byte yang dengannya pola ini dapat ditemukan.  Tanpa merinci lebih dalam, saya akan mengatakan bahwa pada intinya itu adalah pencarian urutan <br><br><pre> <code class="plaintext hljs">10 20 8D F8 04 00 9D F8 0D 00 10 F0 01 0F ?? ?? 10 F0 02 0F ?? ?? 10 F0 04 0F ?? ?? 10 F0 08 0F ?? ?? 08 20 ?? ?? 01 20 ?? ?? 02 20 ?? ?? 04 20</code> </pre> <br>  dan penggantiannya oleh <br><br><pre> <code class="plaintext hljs">?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? 04 ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? 04 ?? ?? ?? ?? ?? ?? ?? ?? ??</code> </pre> <br>  Namun, metode ini memiliki kekurangan. <br><br>  Sejumlah kompiler mengubah urutan pelaksanaan perintah tergantung pada optimasi.  Dan dalam hal ini, tidak mungkin untuk menemukan pola yang diinginkan, dan kadang-kadang mekanisme pemeriksaan dalam struktur umumnya dimasukkan ke dalam kode sebaris.  Oleh karena itu, lebih dapat diandalkan untuk mengubah <a href="">btif_av_sbc_default_config</a> konstan. <br><br>  Sebagai permulaan - temukan dia.  Dia berada di awal fungsi kita, karena <br><br><pre> <code class="plaintext hljs">void bta_av_build_src_cfg (UINT8 *p_pref_cfg, UINT8 *p_src_cap) { tA2D_SBC_CIE src_cap; tA2D_SBC_CIE pref_cap; UINT8 status = 0; /* initialize it to default SBC configuration */ A2D_BldSbcInfo(AVDT_MEDIA_AUDIO, (tA2D_SBC_CIE *) &amp;btif_av_sbc_default_config, p_pref_cfg); /* now try to build a preferred one */ /* parse configuration */ if ((status = A2D_ParsSbcInfo(&amp;src_cap, p_src_cap, TRUE)) != 0) { APPL_TRACE_DEBUG(" Cant parse src cap ret = %d", status);</code> </pre> <br>  Dan ini dia: <br><br><img src="https://habrastorage.org/webt/xi/j2/dt/xij2dtvma0evlnggxkxzqxkvdn4.png"><br><br><img src="https://habrastorage.org/webt/7a/z9/36/7az936re6naesontslfi1ogkd5c.png"><br><br>  Dapat dilihat bahwa btif_av_sbc_default_config sendiri merupakan urutan byte 20 01 10 04 01 35 02, sedangkan byte pertama mengkodekan frekuensi sampling dan dapat 10 (48 kHz) dan 20 (44 kHz), dan karenanya tidak spesifik.  Dengan demikian, tugas kita adalah mengganti urutan <br> <code>01 10 04 01 35 02</code> <br>  pada <br> <code>04 ?? ?? ?? ?? ??</code> <br> <br>  Ini akan memungkinkan Anda untuk mengubah logika struktur dengan cara yang serupa, tetapi pada saat yang sama mengoptimalkan kompiler tidak akan menyebabkan masalah. <br><br>  Dalam beberapa kasus, headphone atau speaker sendiri yang memulai koneksi.  Dalam hal ini, mode ditentukan oleh fungsi <a href="">bta_av_co_audio_init</a> . <br><br>  Fungsi <a href="">dicirikan oleh baris "bta_av_co_audio_init:% d"</a> dan mudah dicari dalam kode: <br><img src="https://habrastorage.org/webt/fi/5o/ku/fi5okug9tbn6gvleetxo93uk9qg.png"><br><br>  Enumerasi kemungkinan mode koneksi dilakukan dalam perintah berikut: <br><br><pre> <code class="plaintext hljs"> switch (index) { case BTIF_SV_AV_AA_SBC_INDEX: /* Set up for SBC codec for SRC*/ *p_codec_type = BTA_AV_CODEC_SBC; /* This should not fail because we are using constants for parameters */ A2D_BldSbcInfo(AVDT_MEDIA_AUDIO, (tA2D_SBC_CIE *) &amp;bta_av_co_sbc_caps, p_codec_info); /* Codec is valid */ return TRUE;</code> </pre> <br>  <a href="">bta_av_co_sbc_caps konstanta memiliki struktur berikut</a> : <br><br><pre> <code class="plaintext hljs">const tA2D_SBC_CIE bta_av_co_sbc_caps = { (A2D_SBC_IE_SAMP_FREQ_44), /* samp_freq */ (A2D_SBC_IE_CH_MD_MONO | A2D_SBC_IE_CH_MD_STEREO | A2D_SBC_IE_CH_MD_JOINT | A2D_SBC_IE_CH_MD_DUAL), /* ch_mode */ (A2D_SBC_IE_BLOCKS_16 | A2D_SBC_IE_BLOCKS_12 | A2D_SBC_IE_BLOCKS_8 | A2D_SBC_IE_BLOCKS_4), /* block_len */ (A2D_SBC_IE_SUBBAND_4 | A2D_SBC_IE_SUBBAND_8), /* num_subbands */ (A2D_SBC_IE_ALLOC_MD_L | A2D_SBC_IE_ALLOC_MD_S), /* alloc_mthd */ BTA_AV_CO_SBC_MAX_BITPOOL, /* max_bitpool */ A2D_SBC_IE_MIN_BITPOOL /* min_bitpool */ };</code> </pre> <br>  Konstanta mudah ditemukan dalam kode, dalam kasus saya itu adalah 20 0F F0 0C 03 35 02: <br><br><img src="https://habrastorage.org/webt/kj/hw/oi/kjhwoibpuk8brwa3kzvxiuxgeba.png"><br><br>  Perhatikan byte <b>0F</b> - karena menyediakan kemampuan untuk terhubung dengan salah satu mode yang valid, sejak <br><br><pre> <code class="plaintext hljs">x0F = A2D_SBC_IE_CH_MD_MONO | A2D_SBC_IE_CH_MD_STEREO | A2D_SBC_IE_CH_MD_JOINT | A2D_SBC_IE_CH_MD_DUAL = x08 | x02 | x01 | x04</code> </pre> <br>  Tugas kami adalah mengubah nilai ini sebagai berikut: <br><br><pre> <code class="plaintext hljs">x0F = A2D_SBC_IE_CH_MD_DUAL = x04</code> </pre> <br>  Karena itu, perlu diganti <br><br> <code>?? 0F F0 0C 03 35 02</code> <br>  pada <br> <code>?? 04 ?? ?? ?? ?? ??</code> <br> <br>  Jadi, kami memaksa tumpukan untuk terhubung dalam mode Dual Channel baik dalam hal memulai koneksi oleh perangkat, dan dalam kasus memulai koneksi oleh sisi penerima sinyal. <br><br>  Sekarang Anda harus menghapus pembatasan dalam bitrate atau meningkatkan ambang atasnya. <br><br>  Perlu menangani <a href="">btif_media_task_get_sbc_rate</a> .  Demikian pula, untuk mencari <a href="">garis karakteristik "wastafel a2dp non-edr terdeteksi, batasi laju ke% d", kami</a> mencari fungsi dalam kode: <br><img src="https://habrastorage.org/webt/kp/go/j2/kpgoj2xsq6vt8kbnexy81jy6j6s.png"><br><br>  Batas laju bit dinyatakan dalam string <br>  Tingkat UINT16 = DEFAULT_SBC_BITRATE (yang pada gilirannya <a href="">adalah 328 kbps</a> ) <br><br>  Dalam kodenya, begini: <br><br><img src="https://habrastorage.org/webt/tf/ba/bn/tfbabnrxfks3pejhzqzdegiwn04.png"><br><br>  Ubah nilai ini menjadi 454 kbit / s - ini lebih tinggi dari standar dan bekerja dengan sebagian besar penerima.  Untuk melakukan ini, ganti byte <br><br> <code>B1 4F F4 A4 74 ?? E0</code> <br>  pada <br> <code>?? ?? ?? E3 ?? ?? ??</code> <br> <br>  Anda juga harus mencari berdasarkan pola. <br><br> <code>E0 4F F4 A4 74 ?? E0</code> <br>  dan ganti dengan <br> <code>?? ?? ?? E3 ?? ?? ??</code> <br>  - Ini diperlukan untuk sejumlah perangkat. <br><br>  Nilai E3 mungkin berbeda tergantung pada laju bit maksimum yang diinginkan: <br><br><ul><li>  E3 - 454 kbps </li><li>  F1 - 482 kbps </li><li>  F3 - 486 kbps </li><li>  10 - 576 kbps </li><li>  48 - tidak ada batas </li></ul><br>  Secara umum, ini ditentukan oleh bytecode dari operasi MOV.W R4, XXX. <br><br>  Dalam praktiknya, ada baiknya bereksperimen dan memilih nilai maksimum di mana semua perangkat penerima Anda menerima penerimaan sinyal yang stabil, tidak ada retak, gangguan atau distorsi. <br><br>  Pada semua penerima dalam percobaan saya (saya tunjukkan di atas), nilai ini adalah 576 kbps, telepon Xiaomi Redmi 4x MIUI10 Android 7.1 adalah sumber sinyal. <br><br>  Berdasarkan tindakan yang dijelaskan, tambalan umum telah dibuat yang menemukan pola yang ditentukan dalam Bluetooth.default.so dan menggantinya?  termasuk mode Dual Channel paksa dan mengatur batas bitrate ke 454 kbps.  Jika perlu, nilai batas dapat dengan mudah diubah berdasarkan pencarian dan penggantian byte yang sesuai - pembaca yang penuh perhatian akan melakukan ini tanpa kesulitan. <br><br>  Saya menekankan: tambalan hanya berfungsi dalam kasus tumpukan bluedroid dan kemungkinan besar tidak akan berhasil dalam kasus tumpukan Fluoride dan Android versi 8 dan yang lebih baru. <br><br>  Patch dapat diunduh <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">dari sini</a> . <br><br>  Sangat disarankan agar Anda mengganti file asli sebagai modul Magisk, untuk saya sendiri saya melakukan ini <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sebagai berikut</a> .  <b>Harap dicatat</b> : modul ini dibuat oleh saya untuk telepon Xiaomi Redmi 4x 3/32 GB dengan firmware MIUI 10 stabil global saat ini pada saat penulisan. Dalam kasus Anda, file bluetooth.default.so harus diganti dengan Anda sendiri, ditambal, seperti dijelaskan di atas.  Mungkin juga file tersebut harus diduplikasi di sepanjang jalur / sistem / lib64 / hw - tergantung pada model dan versi firmware ponsel Anda. <br><br>  Pendekatan ini menggunakan modul Magisk membuatnya mudah untuk mengubah bitrate maksimum dan umumnya menonaktifkan perubahan jika ternyata beberapa perangkat penerima tidak mendukung Dual Channel. <br><br><h2>  Kesimpulan </h2><br>  Pada saat ini, dalam mengejar penjualan, banyak perusahaan mengajukan beberapa inovasi teknologi sebagai pembenaran untuk harga yang lebih tinggi. <br><br>  Dalam praktiknya, ternyata teknologi yang ada dan lebih murah tidak sepenuhnya berkembang, dan inovasi teknologi tidak sepenuhnya diimplementasikan, yang secara signifikan mempengaruhi kualitas. <br><br>  Sangat sering, pengguna mengalami "efek plasebo", meyakinkan diri mereka tentang kesempurnaan produk hanya karena lebih baru atau lebih berwarna disajikan.  Padahal, kualitas ini hanya imajiner. <br><br>  Terlepas dari kemunduran yang nyata dalam kualitas transmisi audio nirkabel dibandingkan dengan versi kabel, tampaknya produsen perangkat modern ditujukan pada transisi lengkap ke teknologi nirkabel.  Pada saat yang sama, trik pemasaran digunakan untuk membenarkan kenaikan harga: perlindungan terhadap perendaman telepon di dalam air (bagaimana Anda bisa berbicara di bawah air? Mengapa menjatuhkan perangkat ke dalam air?), Penggunaan codec yang lebih mahal, dll.  Pada saat yang sama, potensi codec SBC populer yang ada tidak sepenuhnya dimanfaatkan. <br><br>  Kami tidak dapat memperoleh klarifikasi dari Google mengenai batas bitrate 328 kbps, juga tidak menghilangkan batas ini dan menambahkan opsi untuk mengaktifkan Dual Channel di menu Bluetooth dari pengembang Lineage OS. <br><br>  Terima kasih kepada semua orang yang membaca sampai akhir! <br><br>  Beberapa kelanjutan yang disebabkan oleh diskusi dalam komentar dan ruang mengenai codec LDAC ada di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sini</a> . <br><br><img src="https://habrastorage.org/webt/ob/mr/cc/obmrccmcn21gzh8g1ca3g3ykfs4.jpeg"></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id433502/">https://habr.com/ru/post/id433502/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id433490/index.html">Ulasan Printer Creality CR-X 3D</a></li>
<li><a href="../id433494/index.html">10 idiom bahasa Inggris yang tidak akan Anda ketahui</a></li>
<li><a href="../id433496/index.html">Perusahaan milik negara wajib untuk beralih ke perangkat lunak dalam negeri pada tahun 2022</a></li>
<li><a href="../id433498/index.html">Sberbank - Anda memiliki "paket" untuk saya, tetapi saya tidak akan menerimanya ...</a></li>
<li><a href="../id433500/index.html">Robot kurir Berkeley terbakar karena kurangnya status sistem pemantauan</a></li>
<li><a href="../id433504/index.html">Bagaimana cara berhenti menulis firmware untuk mikrokontroler dan mulai hidup</a></li>
<li><a href="../id433506/index.html">UE mencari hak untuk memperbaiki peralatan rumah tangga besar</a></li>
<li><a href="../id433508/index.html">Pemilik arsitektur MIPS bermaksud untuk membuka set instruksi (ISA) pada tahun 2019</a></li>
<li><a href="../id433510/index.html">Perbedaan lintas budaya dalam permainan</a></li>
<li><a href="../id433512/index.html">Teori kebahagiaan. Sandwich sandwich dengan mentega</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>