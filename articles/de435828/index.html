<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©‚Äç‚öñÔ∏è üì∏ üö∂üèø Mathe in Gamedev ist einfach. Einheitskurven und Wellen f√ºr Regeneffekt üåÅ ‚¨ÖÔ∏è üéÖüèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hallo allerseits! Mein Name ist Grisha und ich bin der Gr√ºnder von CGDevs. Reden wir weiter √ºber Mathe oder so. Vielleicht ist VFX die Hauptanwendung ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Mathe in Gamedev ist einfach. Einheitskurven und Wellen f√ºr Regeneffekt</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/435828/"> Hallo allerseits!  Mein Name ist Grisha und ich bin der Gr√ºnder von CGDevs.  Reden wir weiter √ºber Mathe oder so.  Vielleicht ist VFX die Hauptanwendung der Mathematik in der Spieleentwicklung und der Computergrafik im Allgemeinen.  Sprechen wir also √ºber einen solchen Effekt - Regen oder vielmehr √ºber seinen Hauptteil, der Mathematik erfordert - Wellen auf der Oberfl√§che.  Schreiben Sie nacheinander einen Shader f√ºr Wellen auf der Oberfl√§che und analysieren Sie dessen Mathematik.  Bei Interesse - willkommen bei cat.  Github-Projekt beigef√ºgt. <br><br><img src="https://habrastorage.org/webt/15/5m/zm/155mzmadkwqhsef6lpvb7us1kbe.png"><br><a name="habracut"></a><br>  Manchmal kommt ein Moment im Leben, in dem ein Programmierer sich ein Tamburin schnappen und nach Regen rufen muss.  Im Allgemeinen ist das Thema der Regenmodellierung selbst sehr tiefgreifend.  Es gibt viele mathematische Arbeiten zu verschiedenen Teilen dieses Prozesses, von Tropfen und den damit verbundenen Effekten bis zur Verteilung der Tr√∂pfchen im Volumen.  Wir werden nur einen Aspekt analysieren - den Shader, mit dem wir aus einem Tropfen einen Effekt erzeugen k√∂nnen, der der Welle √§hnelt.  Es ist Zeit, ein Tamburin zu nehmen! <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/K5ISaIAx3-o" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  <b>Mathe Welle</b> <br><br>  Wenn Sie im Internet suchen, finden Sie viele lustige mathematische Ausdr√ºcke zum Erzeugen von Wellen.  Oft bestehen sie aus einer Art "magischen" Zahlen und periodischen Funktionen ohne Begr√ºndung.  Im Allgemeinen ist die Mathematik dieses Effekts jedoch recht einfach. <br><br>  Wir brauchen im eindimensionalen Fall nur eine ebene Wellengleichung.  Warum wir etwas sp√§ter flach und eindimensional analysieren werden. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Die ebene Wellengleichung kann</a> in unserem Fall wie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">folgt</a> geschrieben werden: <br><br>  <i>Ergebnis = A * cos (2 * PI * (x / Wellenl√§nge - t * Frequenz));</i> <br>  Wo: <br>  <i>Ergebnis</i> - Amplitude am Punkt x zum Zeitpunkt t <br>  <i>A</i> ist die maximale Amplitude <br>  <i>Wellenl√§nge</i> - Wellenl√§nge <br>  <i>Frequenz</i> - Wellenfrequenz <br>  <i>PI</i> - <i>PI</i> Nummer = 3.14159 (float) <br><br>  <b>Shader</b> <br><br><div class="oembed"><div><div style="left: 0; width: 100%; height: 0; position: relative; padding-bottom: 56.25%;"><video controls="" style="top: 0; left: 0; width: 100%; height: 100%; position: absolute;">  Ihr Browser unterst√ºtzt kein HTML5-Video. <source src="https://media.giphy.com/media/2ywmKSvq53ptEXK60f/giphy.mp4" type="video/mp4"></video></div></div></div><br>  Lass uns mit den Shadern spielen.  F√ºr die "Spitze" ist die Koordinate -Z verantwortlich.  Dies ist im 2D-Fall in Unity bequemer.  Falls gew√ºnscht, ist es nicht schwierig, den Shader in Y umzuschreiben. <br><br>  Das erste, was wir brauchen, ist die Gleichung eines Kreises.  Die Welle unseres Shaders ist symmetrisch zum Zentrum.  Die Gleichung des Kreises im 2d-Fall wird beschrieben als: <br><br>  <i>r ^ 2 = x ^ 2 + y ^ 2</i> <br><br>  Wir brauchen einen Radius, also hat die Gleichung die Form: <br><br>  <i>r = sqrt (x ^ 2 + y ^ 2)</i> <br><br>  und dies gibt uns Symmetrie um den Punkt (0, 0) im Netz, wodurch alles auf den eindimensionalen Fall einer ebenen Welle reduziert wird. <br><br>  Jetzt schreiben wir einen Shader.  Ich werde nicht jeden Schritt des Schreibens eines Shaders analysieren, da dies nicht der Zweck des Artikels ist, sondern die Basis aus dem Standard Surface Shader von Unity stammt, dessen Vorlage √ºber Create-&gt; Shader-&gt; StandardSurfaceShader abgerufen werden kann. <br><br>  Zus√§tzlich werden die notwendigen Eigenschaften f√ºr die Wellengleichung <i>hinzugef√ºgt</i> : <i>_Frequency</i> , <i>_WaveLength</i> und <i>_WaveHeight</i> .  Eigenschaft <i>_Timer</i> (es w√§re m√∂glich, Zeit mit GPU zu verwenden, aber w√§hrend der Entwicklung und der anschlie√üenden Animation ist es bequemer, sie manuell zu steuern. <br><br>  Wir schreiben die Funktion getHeight, um die H√∂he (jetzt ist dies die Z-Koordinate) zu erhalten, indem wir die Kreisgleichung in die Wellengleichung einsetzen <br><br>  Indem wir einen Shader mit unserer Wellengleichung und der Kreisgleichung schreiben, erhalten wir diesen Effekt. <br><br><div class="spoiler">  <b class="spoiler_title">Shader-Code</b> <div class="spoiler_text"><pre><code class="cpp hljs">Shader <span class="hljs-string"><span class="hljs-string">"CGDevs/Rain/RainRipple"</span></span> { Properties { _WaveHeight(<span class="hljs-string"><span class="hljs-string">"Wave Height"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">float</span></span>) = <span class="hljs-number"><span class="hljs-number">1</span></span> _WaveLength(<span class="hljs-string"><span class="hljs-string">"Wave Length"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">float</span></span>) = <span class="hljs-number"><span class="hljs-number">1</span></span> _Frequency(<span class="hljs-string"><span class="hljs-string">"Frequency"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">float</span></span>) = <span class="hljs-number"><span class="hljs-number">1</span></span> _Timer(<span class="hljs-string"><span class="hljs-string">"Timer"</span></span>, Range(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>)) = <span class="hljs-number"><span class="hljs-number">0</span></span> _Color (<span class="hljs-string"><span class="hljs-string">"Color"</span></span>, Color) = (<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>) _MainTex (<span class="hljs-string"><span class="hljs-string">"Albedo (RGB)"</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>D) = <span class="hljs-string"><span class="hljs-string">"white"</span></span> {} _Glossiness (<span class="hljs-string"><span class="hljs-string">"Smoothness"</span></span>, Range(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>)) = <span class="hljs-number"><span class="hljs-number">0</span></span> _Metallic (<span class="hljs-string"><span class="hljs-string">"Metallic"</span></span>, Range(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>)) = <span class="hljs-number"><span class="hljs-number">0.0</span></span> } SubShader { Tags { <span class="hljs-string"><span class="hljs-string">"RenderType"</span></span>= <span class="hljs-string"><span class="hljs-string">"Opaque"</span></span> } LOD <span class="hljs-number"><span class="hljs-number">200</span></span> CGPROGRAM #pragma surface surf Standard fullforwardshadows vertex:vert #pragma target <span class="hljs-number"><span class="hljs-number">3.0</span></span> sampler2D _MainTex; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Input</span></span></span><span class="hljs-class"> {</span></span> float2 uv_MainTex; }; half _Glossiness, _Metallic, _Frequency, _Timer, _WaveLength, _WaveHeight; fixed4 _Color; <span class="hljs-function"><span class="hljs-function">half </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getHeight</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(half x, half y)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> PI = <span class="hljs-number"><span class="hljs-number">3.14159</span></span>; half rad = <span class="hljs-built_in"><span class="hljs-built_in">sqrt</span></span>(x * x + y * y); half wavefunc = _WaveHeight * <span class="hljs-built_in"><span class="hljs-built_in">cos</span></span>(<span class="hljs-number"><span class="hljs-number">2</span></span> * PI * (_Frequency * _Timer - rad / _WaveLength)); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> wavefunc; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">vert</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(inout appdata_full v)</span></span></span><span class="hljs-function"> </span></span>{ v.vertex.z -= getHeight(v.vertex.x, v.vertex.y); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">surf</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Input IN, inout SurfaceOutputStandard o)</span></span></span><span class="hljs-function"> </span></span>{ fixed4 c = tex2D (_MainTex, IN.uv_MainTex) * _Color; o.Albedo = c.rgb; o.Metallic = _Metallic; o.Smoothness = _Glossiness; o.Alpha = _Color.a; } ENDCG } FallBack <span class="hljs-string"><span class="hljs-string">"Diffuse"</span></span> }</code> </pre> <br></div></div><br><div class="oembed"><div><div style="left: 0; width: 100%; height: 0; position: relative; padding-bottom: 56.25%;"><video controls="" style="top: 0; left: 0; width: 100%; height: 100%; position: absolute;">  Ihr Browser unterst√ºtzt kein HTML5-Video. <source src="https://media.giphy.com/media/kvPWJaw0nqhZU0v3eV/giphy.mp4" type="video/mp4"></video></div></div></div><br>  Es gibt Wellen.  Aber ich m√∂chte, dass die Animation mit einem Flugzeug beginnt und endet.  Die Sinusfunktion hilft uns dabei.  Multipliziert man die Amplitude mit sin (_Timer * PI), so erh√§lt man ein glattes Erscheinungsbild und Verschwinden der Wellen.  Da _Timer Werte von 0 bis 1 annimmt und der Sinus bei Null und in PI Null ist, ist dies genau das, was Sie brauchen. <br><br><div class="oembed"><div><div style="left: 0; width: 100%; height: 0; position: relative; padding-bottom: 56.25%;"><video controls="" style="top: 0; left: 0; width: 100%; height: 100%; position: absolute;">  Ihr Browser unterst√ºtzt kein HTML5-Video. <source src="https://media.giphy.com/media/5zotyAkAgtISUCoB0o/giphy.mp4" type="video/mp4"></video></div></div></div><br>  W√§hrend √ºberhaupt nicht wie ein fallender Tropfen.  Das Problem ist, dass die Wellenenergie gleichm√§√üig verloren geht.  F√ºgen Sie die Eigenschaft _Radius hinzu, die f√ºr den Radius des Effekts verantwortlich ist.  Und wir multiplizieren die Klemmamplitude (_Radius - rad, 0, 1) und erhalten bereits einen Effekt, der eher der Wahrheit √§hnelt. <br><br><div class="oembed"><div><div style="left: 0; width: 100%; height: 0; position: relative; padding-bottom: 56.25%;"><video controls="" style="top: 0; left: 0; width: 100%; height: 100%; position: absolute;">  Ihr Browser unterst√ºtzt kein HTML5-Video. <source src="https://media.giphy.com/media/7i9kpPPHDJWUNJXeuV/giphy.mp4" type="video/mp4"></video></div></div></div><br>  Nun, der letzte Schritt.  Die Tatsache, dass die Amplitude an jedem einzelnen Punkt zu einem Zeitpunkt von 0,5 ihr Maximum erreicht, ist nicht ganz richtig. Es ist besser, diese Funktion zu ersetzen. <br><br><img src="https://habrastorage.org/webt/bn/9h/dy/bn9hdyvxobu313uitppdz4j68ik.png"><br><br>  Dann f√ºhlte ich mich etwas zu faul, um zu z√§hlen, und ich multiplizierte einfach den Sinus mit (1 - _Timer) und bekam eine solche Kurve. <br><br><img src="https://habrastorage.org/webt/xp/nu/f2/xpnuf2rrjiqtxj7f_g_q5luq7h0.png"><br><br>  Im Allgemeinen k√∂nnen Sie hier aus mathematischer Sicht auch die gew√ºnschte Kurve basierend auf der Logik ausw√§hlen, zu welchem ‚Äã‚ÄãZeitpunkt Sie einen Peak und eine ungef√§hre Form w√ºnschen, und dann an diesen Punkten eine Interpolation erstellen. <br><br>  Das Ergebnis ist ein solcher Shader und Effekt. <br><br><div class="spoiler">  <b class="spoiler_title">Shader-Code</b> <div class="spoiler_text"><pre> <code class="cpp hljs">Shader <span class="hljs-string"><span class="hljs-string">"CGDevs/Rain/RainRipple"</span></span> { Properties { _WaveHeight(<span class="hljs-string"><span class="hljs-string">"Wave Height"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">float</span></span>) = <span class="hljs-number"><span class="hljs-number">1</span></span> _WaveLength(<span class="hljs-string"><span class="hljs-string">"Wave Length"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">float</span></span>) = <span class="hljs-number"><span class="hljs-number">1</span></span> _Frequency(<span class="hljs-string"><span class="hljs-string">"Frequency"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">float</span></span>) = <span class="hljs-number"><span class="hljs-number">1</span></span> _Radius(<span class="hljs-string"><span class="hljs-string">"Radius"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">float</span></span>) = <span class="hljs-number"><span class="hljs-number">1</span></span> _Timer(<span class="hljs-string"><span class="hljs-string">"Timer"</span></span>, Range(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>)) = <span class="hljs-number"><span class="hljs-number">0</span></span> _Color (<span class="hljs-string"><span class="hljs-string">"Color"</span></span>, Color) = (<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>) _MainTex (<span class="hljs-string"><span class="hljs-string">"Albedo (RGB)"</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>D) = <span class="hljs-string"><span class="hljs-string">"white"</span></span> {} _Glossiness (<span class="hljs-string"><span class="hljs-string">"Smoothness"</span></span>, Range(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>)) = <span class="hljs-number"><span class="hljs-number">0</span></span> _Metallic (<span class="hljs-string"><span class="hljs-string">"Metallic"</span></span>, Range(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>)) = <span class="hljs-number"><span class="hljs-number">0.0</span></span> } SubShader { Tags { <span class="hljs-string"><span class="hljs-string">"RenderType"</span></span>= <span class="hljs-string"><span class="hljs-string">"Opaque"</span></span> } LOD <span class="hljs-number"><span class="hljs-number">200</span></span> CGPROGRAM #pragma surface surf Standard fullforwardshadows vertex:vert #pragma target <span class="hljs-number"><span class="hljs-number">3.0</span></span> sampler2D _MainTex; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Input</span></span></span><span class="hljs-class"> {</span></span> float2 uv_MainTex; }; half _Glossiness, _Metallic, _Frequency, _Timer, _WaveLength, _WaveHeight, _Radius; fixed4 _Color; <span class="hljs-function"><span class="hljs-function">half </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getHeight</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(half x, half y)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> PI = <span class="hljs-number"><span class="hljs-number">3.14159</span></span>; half rad = <span class="hljs-built_in"><span class="hljs-built_in">sqrt</span></span>(x * x + y * y); half wavefunc = _WaveHeight * <span class="hljs-built_in"><span class="hljs-built_in">sin</span></span>(_Timer * PI) * (<span class="hljs-number"><span class="hljs-number">1</span></span> - _Timer) * clamp(_Radius - rad, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>) * <span class="hljs-built_in"><span class="hljs-built_in">cos</span></span>(<span class="hljs-number"><span class="hljs-number">2</span></span> * PI * (_Frequency * _Timer - rad / _WaveLength)); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> wavefunc; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">vert</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(inout appdata_full v)</span></span></span><span class="hljs-function"> </span></span>{ v.vertex.z -= getHeight(v.vertex.x, v.vertex.y); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">surf</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Input IN, inout SurfaceOutputStandard o)</span></span></span><span class="hljs-function"> </span></span>{ fixed4 c = tex2D (_MainTex, IN.uv_MainTex) * _Color; o.Albedo = c.rgb; o.Metallic = _Metallic; o.Smoothness = _Glossiness; o.Alpha = _Color.a; } ENDCG } FallBack <span class="hljs-string"><span class="hljs-string">"Diffuse"</span></span> }</code> </pre><br></div></div><br><iframe width="560" height="315" src="https://www.youtube.com/embed/https://translate" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><div class="oembed"><div><div style="left: 0; width: 100%; height: 0; position: relative; padding-bottom: 56.25%;"><video controls="" style="top: 0; left: 0; width: 100%; height: 100%; position: absolute;">  Ihr Browser unterst√ºtzt kein HTML5-Video. <source src="https://media.giphy.com/media/pOwf43ETsackhG30CA/giphy.mp4" type="video/mp4"></video></div></div></div><br>  <b>Mesh Mesh ist wichtig</b> <br><br>  Zur√ºck zum Thema des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">vorherigen Artikels</a> .  Die Wellen werden vom Vertex-Shader implementiert, sodass das Netz des Netzes eine ziemlich gro√üe Rolle spielt.  Da die Art der Bewegung bekannt ist, wird die Aufgabe vereinfacht, aber im Allgemeinen h√§ngt das endg√ºltige Bild von der Form des Gitters ab.  Der Unterschied wird bei hoher Polygonalit√§t unbedeutend, aber f√ºr die Leistung gilt: Je weniger Polygone, desto besser.  Unten sehen Sie Bilder, die den Unterschied zwischen Gittern und Grafiken veranschaulichen. <br><br>  <b>Richtig:</b> <br><br><img src="https://habrastorage.org/webt/xw/tt/r5/xwttr5ikn3utin3bk8zovtafiuk.png"><br><br>  <b>Falsch:</b> <br><br><img src="https://habrastorage.org/webt/mt/kn/jz/mtknjzazxsvlolfild-i_pspsrw.png"><br><br>  Selbst bei doppelt so vielen Polygonen ergibt das zweite Netz die falsche Darstellung (beide Netze wurden mit Triangle.Net generiert, nur mit unterschiedlichen Algorithmen). <br><br>  <b>Endg√ºltiges Bild</b> <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/rb7DolTp6Hc" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  In einer anderen Version des Shaders wurde ein spezieller Teil hinzugef√ºgt, um Wellen nicht ausschlie√ülich in der Mitte, sondern an mehreren Stellen zu erzeugen.  Wie dies implementiert wird und wie Sie solche Parameter √ºbergeben k√∂nnen, kann ich in den folgenden Artikeln feststellen, ob das Thema interessant ist. <br><br>  Hier ist der Shader selbst: <br><br><div class="spoiler">  <b class="spoiler_title">Wellenscheitel mit Stange kr√§useln</b> <div class="spoiler_text"><pre> <code class="cpp hljs">Shader <span class="hljs-string"><span class="hljs-string">"CGDevs/Rain/Ripple Vertex with Pole"</span></span> { Properties { _MainTex (<span class="hljs-string"><span class="hljs-string">"Albedo (RGB)"</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>D) = <span class="hljs-string"><span class="hljs-string">"white"</span></span> {} _Normal (<span class="hljs-string"><span class="hljs-string">"Bump Map"</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>D) = <span class="hljs-string"><span class="hljs-string">"white"</span></span> {} _Roughness (<span class="hljs-string"><span class="hljs-string">"Metallic"</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>D) = <span class="hljs-string"><span class="hljs-string">"white"</span></span> {} _Occlusion (<span class="hljs-string"><span class="hljs-string">"Occlusion"</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>D) = <span class="hljs-string"><span class="hljs-string">"white"</span></span> {} _PoleTexture(<span class="hljs-string"><span class="hljs-string">"PoleTexture"</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>D) = <span class="hljs-string"><span class="hljs-string">"white"</span></span> {} _Color (<span class="hljs-string"><span class="hljs-string">"Color"</span></span>, Color) = (<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>) _Glossiness (<span class="hljs-string"><span class="hljs-string">"Smoothness"</span></span>, Range(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>)) = <span class="hljs-number"><span class="hljs-number">0</span></span> _WaveMaxHeight(<span class="hljs-string"><span class="hljs-string">"Wave Max Height"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">float</span></span>) = <span class="hljs-number"><span class="hljs-number">1</span></span> _WaveMaxLength(<span class="hljs-string"><span class="hljs-string">"Wave Length"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">float</span></span>) = <span class="hljs-number"><span class="hljs-number">1</span></span> _Frequency(<span class="hljs-string"><span class="hljs-string">"Frequency"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">float</span></span>) = <span class="hljs-number"><span class="hljs-number">1</span></span> _Timer(<span class="hljs-string"><span class="hljs-string">"Timer"</span></span>, Range(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>)) = <span class="hljs-number"><span class="hljs-number">0</span></span> } SubShader { Tags { <span class="hljs-string"><span class="hljs-string">"IgnoreProjector"</span></span> = <span class="hljs-string"><span class="hljs-string">"True"</span></span> <span class="hljs-string"><span class="hljs-string">"RenderType"</span></span> = <span class="hljs-string"><span class="hljs-string">"Opaque"</span></span>} LOD <span class="hljs-number"><span class="hljs-number">200</span></span> CGPROGRAM #pragma surface surf Standard fullforwardshadows vertex:vert #pragma target <span class="hljs-number"><span class="hljs-number">3.0</span></span> sampler2D _PoleTexture, _MainTex, _Normal, _Roughness, _Occlusion; half _Glossiness, _WaveMaxHeight, _Frequency, _Timer, _WaveMaxLength, _RefractionK; fixed4 _Color; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Input</span></span></span><span class="hljs-class"> {</span></span> float2 uv_MainTex; }; <span class="hljs-function"><span class="hljs-function">half </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getHeight</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(half x, half y, half offetX, half offetY, half radius, half phase)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> PI = <span class="hljs-number"><span class="hljs-number">3.14159</span></span>; half timer = _Timer + phase; half rad = <span class="hljs-built_in"><span class="hljs-built_in">sqrt</span></span>((x - offetX) * (x - offetX) + (y - offetY) * (y - offetY)); half A = _WaveMaxHeight * <span class="hljs-built_in"><span class="hljs-built_in">sin</span></span>(_Timer * PI) * (<span class="hljs-number"><span class="hljs-number">1</span></span> - _Timer) * (<span class="hljs-number"><span class="hljs-number">1</span></span> - timer) * radius; half wavefunc = <span class="hljs-built_in"><span class="hljs-built_in">cos</span></span>(<span class="hljs-number"><span class="hljs-number">2</span></span> * PI * (_Frequency * timer - rad / _WaveMaxLength)); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> A * wavefunc; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">vert</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(inout appdata_full v)</span></span></span><span class="hljs-function"> </span></span>{ float4 poleParams = tex2Dlod (_PoleTexture, float4(v.texcoord.xy, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>)); v.vertex.z += getHeight(v.vertex.x, v.vertex.y, (poleParams.r - <span class="hljs-number"><span class="hljs-number">0.5</span></span>) * <span class="hljs-number"><span class="hljs-number">2</span></span>, (poleParams.g - <span class="hljs-number"><span class="hljs-number">0.5</span></span>) * <span class="hljs-number"><span class="hljs-number">2</span></span>, poleParams.b , poleParams.a); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">surf</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Input IN, inout SurfaceOutputStandard o)</span></span></span><span class="hljs-function"> </span></span>{ o.Albedo = tex2D(_MainTex, IN.uv_MainTex).rgb * _Color.rgb; o.Normal = UnpackNormal(tex2D(_Normal, IN.uv_MainTex)); o.Metallic = tex2D(_Roughness, IN.uv_MainTex).rgb; o.Occlusion = tex2D(_Occlusion, IN.uv_MainTex).rgb; o.Smoothness = _Glossiness; o.Alpha = _Color.a; } ENDCG } FallBack <span class="hljs-string"><span class="hljs-string">"Diffuse"</span></span> }</code> </pre><br></div></div><br>  Das gesamte Projekt und seine Funktionsweise finden Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> .  Zwar musste ein Teil der Ressourcen aufgrund von Gewichtsbeschr√§nkungen des Githubs (HDR Skybox und Auto) entfernt werden. <br><br>  Vielen Dank f√ºr Ihre Aufmerksamkeit!  Ich hoffe, der Artikel wird jemandem n√ºtzlich sein, und es wurde ein wenig klarer, warum Trigonometrie, analytische Geometrie (alles, was mit Kurven zu tun hat) und andere mathematische Disziplinen erforderlich sein k√∂nnen. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de435828/">https://habr.com/ru/post/de435828/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de435814/index.html">[The Old New Thing] Kann ich meinen Stapel nach Belieben verwenden?</a></li>
<li><a href="../de435816/index.html">Das Massachusetts Hospital und DeepMind haben unabh√§ngig voneinander die AI Black Box in der Medizin ge√∂ffnet</a></li>
<li><a href="../de435822/index.html">So steuern Sie Hardware in einem Rechenzentrum mithilfe von Sound</a></li>
<li><a href="../de435824/index.html">Was Sie wissen m√ºssen, bevor Sie eine Karriere in der Audioindustrie beginnen</a></li>
<li><a href="../de435826/index.html">5 Gebote eines erfolgreichen Verhandlungsf√ºhrers und Partners</a></li>
<li><a href="../de435830/index.html">OMEGA - Automatisierung des Timings von Sportveranstaltungen</a></li>
<li><a href="../de435834/index.html">EXAM - Modernste Textklassifizierungsmethode</a></li>
<li><a href="../de435836/index.html">Die gr√∂√üten Unternehmen der Wall Street vereinbaren, eine neue B√∂rse zu er√∂ffnen, um mit Nasdaq und NYSE zu konkurrieren</a></li>
<li><a href="../de435838/index.html">Lazy-Funktionen von JavaScript</a></li>
<li><a href="../de435840/index.html">Ein kleiner √úberblick √ºber SIMD in .NET / C #</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>