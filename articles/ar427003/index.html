<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐จโ๐ฆโ๐ฆ ๐๐ฝ ๐ฒ๏ธ ุงูุฎุฑุงุฆุท ุงูุณุฏุงุณูุฉ ูู ุงููุญุฏุฉ: ุถุจุงุจ ุงูุญุฑุจ ุ ูุจุญูุซ ุงูุฎุฑุงุฆุท ุ ูุงูุชูููุฏ ุงูุฅุฌุฑุงุฆู ๐ฅ ๐๏ธ โฑ๏ธ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ุงูุฃุฌุฒุงุก 1-3: ุงูุดุจูุฉ ูุงูุฃููุงู ูุงุฑุชูุงุนุงุช ุงูุฎููุฉ 

 ุงูุฃุฌุฒุงุก 4-7: ุงููุทุจุงุช ูุงูุฃููุงุฑ ูุงูุทุฑู 

 ุงูุฃุฌุฒุงุก 8-11: ุงููุงุก ูุงูุฃุดูุงู ุงูุฃุฑุถูุฉ ูุงูุฃุณูุงุฑ 

 ุงูุฃุฌุฒุงุก 12-1...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ุงูุฎุฑุงุฆุท ุงูุณุฏุงุณูุฉ ูู ุงููุญุฏุฉ: ุถุจุงุจ ุงูุญุฑุจ ุ ูุจุญูุซ ุงูุฎุฑุงุฆุท ุ ูุงูุชูููุฏ ุงูุฅุฌุฑุงุฆู</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/427003/" style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุฃุฌุฒุงุก 1-3: ุงูุดุจูุฉ ูุงูุฃููุงู ูุงุฑุชูุงุนุงุช ุงูุฎููุฉ</a> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุฃุฌุฒุงุก 4-7: ุงููุทุจุงุช ูุงูุฃููุงุฑ ูุงูุทุฑู</a> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุฃุฌุฒุงุก 8-11: ุงููุงุก ูุงูุฃุดูุงู ุงูุฃุฑุถูุฉ ูุงูุฃุณูุงุฑ</a> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุฃุฌุฒุงุก 12-15: ุงูุญูุธ ูุงูุชุญููู ุ ุงูููุงู ุ ุงููุณุงูุงุช</a> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุฃุฌุฒุงุก 16-19: ุฅูุฌุงุฏ ุงูุทุฑูู ููุฑู ุงููุงุนุจูู ูุงูุฑุณูู ุงููุชุญุฑูุฉ</a> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุฃุฌุฒุงุก 20-23: ุถุจุงุจ ุงูุญุฑุจ ุ ุจุญุซ ุงูุฎุฑุงุฆุท ุ ุงูุฌูู ุงูุฅุฌุฑุงุฆู</a> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุฃุฌุฒุงุก 24-27: ุฏูุฑุฉ ุงููุงุก ุ ุงูุชุขูู ุ ุงูููุงุทู ุงูุฃุญูุงุฆูุฉ ุ ุงูุฎุฑูุทุฉ ุงูุฃุณุทูุงููุฉ</a> <br><br><h1 style=";text-align:right;direction:rtl">  ุงูุฌุฒุก 20: ุถุจุงุจ ุงูุญุฑุจ </h1><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุญูุธ ุจูุงูุงุช ุงูุฎููุฉ ูู ุงููุณูุฌ. </li><li style=";text-align:right;direction:rtl">  ุชุบููุฑ ุฃููุงุน ุงูุฅุบุงุซุฉ ุฏูู ุงูุชุซููุซ. </li><li style=";text-align:right;direction:rtl">  ูุญู ูุชุชุจุน ุงูุฑุคูุฉ. </li><li style=";text-align:right;direction:rtl">  ุชุนุชูู ูู ุดูุก ุบูุฑ ูุฑุฆู. </li></ul><br>  ูู ูุฐุง ุงูุฌุฒุก ุ ุณูุถูู ุถุจุงุจ ุชุฃุซูุฑ ุงูุญุฑุจ ุฅูู ุงูุฎุฑูุทุฉ. <br><br>  ุงูุขู ุณูุชู ุฅูุดุงุก ุงููุณูุณู ุนูู Unity 2017.1.0. <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/716/b6b/8a9/716b6b8a9d024dc87b2d645b5d4bdbb6.jpg"></div><br>  <i>ุงูุขู ูุฑู ุฃููุง ูุณุชุทูุน ููุง ูุณุชุทูุน ุฃู ูุฑู.</i> <br><a name="habracut"></a><br><h2 style=";text-align:right;direction:rtl">  ุจูุงูุงุช ุงูุฎููุฉ ูู Shader </h2><br>  ุชุณุชุฎุฏู ุงูุนุฏูุฏ ูู ุงูุฃูุนุงุจ ุงูุฅุณุชุฑุงุชูุฌูุฉ ููููู ุถุจุงุจ ุงูุญุฑุจ.  ูุฐุง ูุนูู ุฃู ุฑุคูุฉ ุงููุงุนุจ ูุญุฏูุฏุฉ.  ููููู ููุท ุฑุคูุฉ ูุง ูู ูุฑูุจ ูู ูุญุฏุงุชู ุฃู ุงูููุทูุฉ ุงูุฎุงุถุนุฉ ููุณูุทุฑุฉ.  ุนูู ุงูุฑุบู ูู ุฃููุง ูุฑู ุงูุงุฑุชูุงุญ ุ ุฅูุง ุฃููุง ูุง ูุนุฑู ูุง ูุญุฏุซ ููุงู.  ุนุงุฏุฉ ูุง ุชุตุจุญ ุงูุชุถุงุฑูุณ ุบูุฑ ุงููุฑุฆูุฉ ุฃูุซุฑ ูุชุงูุฉ.  ูุชุญููู ุฐูู ุ ูุญุชุงุฌ ุฅูู ุชุชุจุน ุฑุคูุฉ ุงูุฎููุฉ ูุชูุฏูููุง ููููุง ูุฐูู. <br><br>  ุฅู ุฃุจุณุท ุทุฑููุฉ ูุชุบููุฑ ูุธูุฑ ุงูุฎูุงูุง ุงููุฎููุฉ ูู ุฅุถุงูุฉ ูููุงุณ ููุฑุคูุฉ ุฅูู ุจูุงูุงุช ุงูุดุจูุฉ.  ููุน ุฐูู ุ ูู ุงูููุช ููุณู ุ ุณูุชุนูู ุนูููุง ุจุฏุก ุชุซููุซ ุฅุบุงุซุฉ ุฌุฏูุฏ ูุน ุชุบููุฑ ูู ุงูุฑุคูุฉ.  ูุฐุง ูุฑุงุฑ ุณูุฆ ูุฃู ุงูุฑุคูุฉ ุชุชุบูุฑ ุจุงุณุชูุฑุงุฑ ุฃุซูุงุก ุงููุนุจุฉ. <br><br>  ุบุงูุจูุง ูุง ูุชู ุงุณุชุฎุฏุงู ุชูููุฉ ุงูุนุฑุถ ุนูู ุชุถุงุฑูุณ ุณุทุญ ุดูุงู ุ ูุงูุชู ุชุฎูู ุฌุฒุฆููุง ุงูุฎูุงูุง ุบูุฑ ุงููุฑุฆูุฉ ููุงุนุจ.  ูุฐู ุงูุทุฑููุฉ ููุงุณุจุฉ ููุชุถุงุฑูุณ ุงููุณุทุญุฉ ูุณุจููุง ูุน ุฒุงููุฉ ุนุฑุถ ูุญุฏูุฏุฉ.  ูููู ูุธุฑูุง ูุฃู ุชุถุงุฑูุณูุง ูููู ุฃู ุชุญุชูู ุนูู ุงุฑุชูุงุนุงุช ูุฃุดูุงุก ูุฎุชููุฉ ุฌุฏูุง ูููู ุฑุคูุชูุง ูู ุฒูุงูุง ูุฎุชููุฉ ุ ูุฐูู ูุญุชุงุฌ ุฅูู ุดุจูุฉ ููุตูุฉ ููุบุงูุฉ ุชุชูุงุณุจ ูุน ุดูู ุงูุชุถุงุฑูุณ.  ุณุชููู ูุฐู ุงูุทุฑููุฉ ุฃูุซุฑ ุชูููุฉ ูู ุฃุจุณุท ุงูููุฌ ุงููุฐููุฑ ุฃุนูุงู. <br><br>  ููุฌ ุขุฎุฑ ูู ููู ุจูุงูุงุช ุงูุฎูุงูุง ุฅูู ุงูุชุธููู ุนูุฏ ุงูุชูุฏูู ุจุดูู ูููุตู ุนู ุดุจูุฉ ุงูุฅุบุงุซุฉ.  ูุฐุง ุณูุณูุญ ููุง ุจุฅุฌุฑุงุก ุงูุชุซููุซ ูุฑุฉ ูุงุญุฏุฉ ููุท.  ูููู ููู ุจูุงูุงุช ุงูุฎููุฉ ุจุงุณุชุฎุฏุงู ูุงุฏุฉ.  ูุนุฏ ุชุบููุฑ ุงููุณูุฌ ุนูููุฉ ุฃุจุณุท ุจูุซูุฑ ูู ุชุซููุซ ุงูุชุถุงุฑูุณ.  ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ุชูููุฐ ุนุฏุฉ ุนููุงุช ูุณูุฌ ุฅุถุงููุฉ ุฃุณุฑุน ูู ุชูุฏูู ุทุจูุฉ ุดูุงูุฉ ูุงุญุฏุฉ. <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ูุงุฐุง ุนู ุงุณุชุฎุฏุงู ูุตูููุงุช ุชุธูููุ</b> <div class="spoiler_text" style=";text-align:right;direction:rtl">  ููููู ุฃูุถูุง ููู ุจูุงูุงุช ุงูุฎููุฉ ุฅูู ุฌูุงุฒ ุชุธููู ุจุงุณุชุฎุฏุงู ูุฌููุนุฉ ูู ุงููุชุฌูุงุช.  ููุน ุฐูู ุ ูุฅู ุตูุงุฆู ุงูุชุธููู ููุง ุญุฏ ุญุฌู ุ ููุงุณุฉ ุจุขูุงู ุงูุจุงูุช ุ ููููู ุฃู ุชุญุชูู ุงูุฃูุณุฌุฉ ุนูู ููุงููู ุงูุจูุณู.  ูุฏุนู ุงูุฎุฑุงุฆุท ุงููุจูุฑุฉ ุ ุณูุณุชุฎุฏู ุงูููุงู. </div></div><br><h3 style=";text-align:right;direction:rtl">  ุฅุฏุงุฑุฉ ุจูุงูุงุช ุงูุฎููุฉ </h3><br>  ูุญุชุงุฌ ุฅูู ุทุฑููุฉ ููุชุญูู ูู ุงููุณูุฌ ุงูุฐู ูุญุชูู ุนูู ุจูุงูุงุช ุงูุฎููุฉ.  ูููู ุจุฅูุดุงุก ูููู <code>HexCellShaderData</code> ุฌุฏูุฏ <code>HexCellShaderData</code> ุจุฐูู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEngine; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">HexCellShaderData</span></span> : <span class="hljs-title"><span class="hljs-title">MonoBehaviour</span></span> { Texture2D cellTexture; }</code> </pre> <br>  ุนูุฏ ุฅูุดุงุก ุฃู ุชุญููู ุฎุฑูุทุฉ ุฌุฏูุฏุฉ ุ ูุญุชุงุฌ ุฅูู ุฅูุดุงุก ูุณูุฌ ุฌุฏูุฏ ุจุงูุญุฌู ุงูุตุญูุญ.  ูุฐูู ุ ูุถูู ุทุฑููุฉ ุงูุชููุฆุฉ ุงูุชู ุชุฎูู ูุณูุฌูุง ููุง.  ูุญู ูุณุชุฎุฏู ูุณูุฌ RGBA ุจุฏูู ุฒุฎุงุฑู ุตุบูุฑุฉ ููุณุงุญุฉ ููููุฉ ุฎุทูุฉ.  ูุณูุง ุจุญุงุฌุฉ ุฅูู ุฎูุท ุจูุงูุงุช ุงูุฎููุฉ ุ ูุฐูู ูุณุชุฎุฏู ุชุตููุฉ ุงูููุงุท.  ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ูุง ููุจุบู ุทู ุงูุจูุงูุงุช.  ุณูุญุชูู ูู ุจูุณู ูู ุงููุงุฏุฉ ุนูู ุจูุงูุงุช ูู ุฎููุฉ ูุงุญุฏุฉ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Initialize</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> x, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> z</span></span></span><span class="hljs-function">)</span></span> { cellTexture = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Texture2D( x, z, TextureFormat.RGBA32, <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-literal"><span class="hljs-literal">true</span></span> ); cellTexture.filterMode = FilterMode.Point; cellTexture.wrapMode = TextureWrapMode.Clamp; }</code> </pre> <br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ูู ูุฌุจ ุฃู ูุชุทุงุจู ุญุฌู ุงููุณูุฌ ูุน ุญุฌู ุงูุฎุฑูุทุฉุ</b> <div class="spoiler_text" style=";text-align:right;direction:rtl">  ูุง ุ ุฅููุง ุชุญุชุงุฌ ููุท ุฅูู ูุฌูุฏ ูุญุฏุงุช ุจูุณู ูุงููุฉ ูุงุณุชูุนุงุจ ุฌููุน ุงูุฎูุงูุง.  ูุน ุงูุชุทุงุจู ุงูุชุงู ูุน ุญุฌู ุงูุฎุฑูุทุฉ ุ ูู ุงููุฑุฌุญ ุฃู ูุชู ุฅูุดุงุก ูุณูุฌ ุจุฃุญุฌุงู ููุณุช ููุฉ ูู ุงุซููู (ุบูุฑ ููุฉ ูู ุงุซููู ุ NPOT) ุ ูููุณ ุชูุณูู ุงููุณูุฌ ูุฐุง ูู ุงูุฃูุซุฑ ูุนุงููุฉ.  ุนูู ุงูุฑุบู ูู ุฃูู ูููููุง ุชูููู ุงูููุฏ ููุนูู ูุน ููุงุฏ ุจุญุฌู ููุฉ ุงุซููู ุ ููุฐุง ุชุญุณูู ุซุงููู ุ ููุง ูุนูุฏ ุงููุตูู ุฅูู ุจูุงูุงุช ุงูุฎููุฉ. </div></div><br>  ูู ุงููุงูุน ุ ูุง ูุชุนูู ุนูููุง ุฅูุดุงุก ูุณูุฌ ุฌุฏูุฏ ูู ูู ูุฑุฉ ูููู ูููุง ุจุฅูุดุงุก ุฎุฑูุทุฉ ุฌุฏูุฏุฉ.  ูููู ุชุบููุฑ ุญุฌู ุงููุณูุฌ ุฅุฐุง ูุงู ููุฌูุฏูุง ุจุงููุนู.  ูุง ูุญุชุงุฌ ุญุชู ุฅูู ุงูุชุญูู ููุง ุฅุฐุง ูุงู ูุฏููุง ุงูุญุฌู ุงูุตุญูุญ ุจุงููุนู ุ ูุฃู <code>Texture2D.Resize</code> ุฐูู ุจูุง ูููู ููููุงู ุจุฐูู ูู ุฃุฌููุง. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Initialize</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> x, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> z</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (cellTexture) { cellTexture.Resize(x, z); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { cellTexture = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Texture2D( cellCountX, cellCountZ, TextureFormat.RGBA32, <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-literal"><span class="hljs-literal">true</span></span> ); cellTexture.filterMode = FilterMode.Point; cellTexture.wrapMode = TextureWrapMode.Clamp; } }</code> </pre> <br>  ุจุฏูุงู ูู ุชุทุจูู ุจูุงูุงุช ุงูุฎููุฉ ุจูุณู ูุงุญุฏ ูู ูู ูุฑุฉ ุ ูุณุชุฎุฏู ูุฎุฒู ุงูุฃููุงู ููุทุจู ุจูุงูุงุช ุฌููุน ุงูุฎูุงูุง ูู ูู ูุฑุฉ.  ููููุงู ุจุฐูู ุ ุณูู ูุณุชุฎุฏู ูุฌููุนุฉ <code>Color32</code> .  ุฅุฐุง ูุฒู ุงูุฃูุฑ ุ ูุณููุดุฆ ูุณุฎุฉ ูุตูููุฉ ุฌุฏูุฏุฉ ูู ููุงูุฉ <code>Initialize</code> .  ุฅุฐุง ูุงู ูุฏููุง ุจุงููุนู ูุฌููุนุฉ ูู ุงูุญุฌู ุงูุตุญูุญ.  ุซู ูููู ุจูุณุญ ูุญุชููุงุชู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> Texture2D cellTexture; Color32[] cellTextureData; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Initialize</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { โฆ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (cellTextureData == <span class="hljs-literal"><span class="hljs-literal">null</span></span> || cellTextureData.Length != x * z) { cellTextureData = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Color32[x * z]; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; cellTextureData.Length; i++) { cellTextureData[i] = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Color32(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); } } }</code> </pre> <br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ูุง ูู color32ุ</b> <div class="spoiler_text" style=";text-align:right;direction:rtl">  ุชุญุชูู ุฒุฎุงุฑู RGBA ุงูููุงุณูุฉ ุบูุฑ ุงููุถุบูุทุฉ ุนูู ูุญุฏุงุช ุจูุณู ุจุฃุฑุจุนุฉ ุจุงูุช.  ุชุชููู ูู ููุงุฉ ูู ูููุงุช ุงูุฃููุงู ุงูุฃุฑุจุนุฉ ุจุงูุชูุง ุ ุฃู ุฃููุง ุชุญุชูู ุนูู 256 ูููุฉ ูุญุชููุฉ.  ุนูุฏ ุงุณุชุฎุฏุงู ุจููุฉ Unity <code>Color</code> ุ ูุชู ุชุญููู ููููุงุช ุงููุงุตูุฉ ุงูุนุงุฆูุฉ ูู ุงููุงุตู ุงูุฒููู 0-1 ุฅูู ูุญุฏุงุช ุจุงูุช ูู ุงููุงุตู ุงูุฒููู 0-255.  ุนูุฏ ุฃุฎุฐ ุงูุนููุงุช ุ ูููู GPU ุจุงูุชุญููู ุงูุนูุณู. <br><br>  ุชุนูู ุจููุฉ <code>Color32</code> ูุจุงุดุฑุฉ ูุน ูุญุฏุงุช ุงูุจุงูุช ุ ูุฐุง ููู <code>Color32</code> ูุณุงุญุฉ ุฃูู ููุง ุชุชุทูุจ ุงูุชุญููู ุ ููุง ูุฒูุฏ ูู ููุงุกุฉ ุงุณุชุฎุฏุงููุง.  ูุธุฑูุง ูุฃููุง ูููู ุจุชุฎุฒูู ุจูุงูุงุช ุงูุฎููุฉ ุจุฏูุงู ูู ุงูุฃููุงู ุ ูุณูููู ูู ุงูููุทูู ุงูุนูู ูุจุงุดุฑุฉ ูุน ุจูุงูุงุช ุงููุณูุฌ ุงูุฎุงู ุ ูููุณ ูุน <code>Color</code> . </div></div><br>  ูุฌุจ ุฃู ุชุชุนุงูู <code>HexGrid</code> ูุน ุฅูุดุงุก ูุชููุฆุฉ ูุฐู ุงูุฎูุงูุง ูู ุชุธููู.  ูุฐูู ุ ุณูููู ุจุฅุถุงูุฉ ุญูู <code>cellShaderData</code> ูุฅูุดุงุก ูููู ุฏุงุฎู <code>Awake</code> . <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> HexCellShaderData cellShaderData; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Awake</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { HexMetrics.noiseSource = noiseSource; HexMetrics.InitializeHashGrid(seed); HexUnit.unitPrefab = unitPrefab; cellShaderData = gameObject.AddComponent&lt;HexCellShaderData&gt;(); CreateMap(cellCountX, cellCountZ); }</code> </pre> <br>  ุนูุฏ ุฅูุดุงุก ุฎุฑูุทุฉ ุฌุฏูุฏุฉ ุ ูุฌุจ ุฃูุถูุง <code>cellShaderData</code> . <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CreateMap</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> x, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> z</span></span></span><span class="hljs-function">)</span></span> { โฆ cellCountX = x; cellCountZ = z; chunkCountX = cellCountX / HexMetrics.chunkSizeX; chunkCountZ = cellCountZ / HexMetrics.chunkSizeZ; cellShaderData.Initialize(cellCountX, cellCountZ); CreateChunks(); CreateCells(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; }</code> </pre> <br><h3 style=";text-align:right;direction:rtl">  ุชุญุฑูุฑ ุจูุงูุงุช ุงูุฎููุฉ </h3><br>  ุญุชู ุงูุขู ุ ุนูุฏ ุชุบููุฑ ุฎุตุงุฆุต ุงูุฎููุฉ ุ ูุงู ูู ุงูุถุฑูุฑู ุชุญุฏูุซ ุฌุฒุก ูุงุญุฏ ุฃู ุนุฏุฉ ุฃุฌุฒุงุก ุ ูููู ูุฏ ูููู ูู ุงูุถุฑูุฑู ุงูุขู ุชุญุฏูุซ ุจูุงูุงุช ุงูุฎูุงูุง.  ูุฐุง ูุนูู ุฃู ุงูุฎูุงูุง ูุฌุจ ุฃู ูููู ููุง ุงุฑุชุจุงุท ุจุจูุงูุงุช ุงูุฎููุฉ ูู ุงูุชุธููู.  ููููุงู ุจุฐูู ุ ูู ุจุฅุถุงูุฉ ุฎุงุตูุฉ ุฅูู <code>HexCell</code> . <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> HexCellShaderData ShaderData { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; }</code> </pre> <br>  ูู <code>HexGrid.CreateCell</code> ุณูููู ุจุชุนููู ูููู ุจูุงูุงุช ุชุธููู ููุฐู ุงูุฎุงุตูุฉ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CreateCell</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> x, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> z, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> i</span></span></span><span class="hljs-function">)</span></span> { โฆ HexCell cell = cells[i] = Instantiate&lt;HexCell&gt;(cellPrefab); cell.transform.localPosition = position; cell.coordinates = HexCoordinates.FromOffsetCoordinates(x, z); cell.ShaderData = cellShaderData; โฆ }</code> </pre> <br>  ูููููุง ุงูุขู ุงูุญุตูู ุนูู ุงูุฎูุงูุง ูุชุญุฏูุซ ุจูุงูุงุช ุงูุชุธููู ุงูุฎุงุตุฉ ุจูุง.  ุจูููุง ูุญู ูุง ูุชุชุจุน ุงูุฑุคูุฉ ุ ูููููุง ุงุณุชุฎุฏุงู ุจูุงูุงุช ุชุธููู ูุดูุก ุขุฎุฑ.  ูุญุฏุฏ ููุน ุงูุฅุบุงุซุฉ ููุฎููุฉ ุงููุณูุฌ ุงููุณุชุฎุฏู ูุชูุฏูููุง.  ูุง ูุคุซุฑ ุนูู ููุฏุณุฉ ุงูุฎููุฉ ุ ูุฐูู ูููููุง ุชุฎุฒูู ููุฑุณ ููุน ุงูุงุฑุชูุงุน ูู ุจูุงูุงุช ุงูุฎููุฉ ุ ูููุณ ูู ุจูุงูุงุช ุงูุดุจูุฉ.  ุณูุณูุญ ููุง ูุฐุง ุจุงูุชุฎูุต ูู ุงูุญุงุฌุฉ ุฅูู ุงูุชุซููุซ ุนูุฏ ุชุบููุฑ ููุน ุฑุงุญุฉ ุงูุฎููุฉ. <br><br>  ุฃุถู ุทุฑููุฉ <code>HexCellShaderData</code> ุฅูู <code>RefreshTerrain</code> ูุชุจุณูุท ูุฐู ุงููููุฉ ูุฎููุฉ ูุนููุฉ.  ููุชุฑู ูุฐู ุงูุทุฑููุฉ ูุงุฑุบุฉ ุงูุขู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RefreshTerrain</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">HexCell cell</span></span></span><span class="hljs-function">)</span></span> { }</code> </pre> <br>  ูู ุจุชุบููุฑ <code>HexCell.TerrainTypeIndex</code> ุจุญูุซ <code>HexCell.TerrainTypeIndex</code> ูุฐู ุงูุทุฑููุฉ ุ ููุง ุชุฃูุฑ ุจุชุญุฏูุซ ุงูุฃุฌุฒุงุก. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> TerrainTypeIndex { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> terrainTypeIndex; } <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (terrainTypeIndex != <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>) { terrainTypeIndex = <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>; <span class="hljs-comment"><span class="hljs-comment">// Refresh(); ShaderData.RefreshTerrain(this); } } }</span></span></code> </pre> <br>  ุณูู ูุทูู ุนููู ุฃูุถูุง ุงุณู <code>HexCell.Load</code> ุจุนุฏ ุงุณุชูุงู ููุน ุชุถุงุฑูุณ ุงูุฎููุฉ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Load</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">BinaryReader reader</span></span></span><span class="hljs-function">)</span></span> { terrainTypeIndex = reader.ReadByte(); ShaderData.RefreshTerrain(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); elevation = reader.ReadByte(); RefreshPosition(); โฆ }</code> </pre> <br><h3 style=";text-align:right;direction:rtl">  ูุคุดุฑ ุงูุฎููุฉ </h3><br>  ูุชุบููุฑ ูุฐู ุงูุฎูุงูุง ุ ูุญุชุงุฌ ุฅูู ูุนุฑูุฉ ููุฑุณ ุงูุฎููุฉ.  ุฃุณูู ุทุฑููุฉ ููููุงู ุจุฐูู ูู ุจุฅุถุงูุฉ ุฎุงุตูุฉ <code>Index</code> ุฅูู <code>HexCell</code> .  ุณูุดูุฑ ุฅูู ููุฑุณ ุงูุฎููุฉ ูู ูุงุฆูุฉ ุงูุฎูุงูุง ูู ุงูุฎุฑูุทุฉ ุ ูุงูุฐู ูุชูุงูู ูุน ููุฑุณูุง ูู ุงูุฎูุงูุง ุงููุญุฏุฏุฉ ูู ุงูุชุธููู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> Index { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; }</code> </pre> <br>  ูุฐุง ุงูููุฑุณ ููุฌูุฏ ุจุงููุนู ูู <code>HexGrid.CreateCell</code> ุ ูุฐุง ูู ุจุชุนูููู ุฅูู ุงูุฎููุฉ ุงูุชู ุชู ุฅูุดุงุคูุง. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CreateCell</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> x, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> z, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> i</span></span></span><span class="hljs-function">)</span></span> { โฆ cell.coordinates = HexCoordinates.FromOffsetCoordinates(x, z); cell.Index = i; cell.ShaderData = cellShaderData; โฆ }</code> </pre> <br>  ุงูุขู ูููู ูู <code>HexCellShaderData.RefreshTerrain</code> ุงุณุชุฎุฏุงู ูุฐุง ุงูููุฑุณ ูุชุญุฏูุฏ ุจูุงูุงุช ุงูุฎููุฉ.  ููุญูุธ ููุฑุณ ููุน ุงูุงุฑุชูุงุน ูู ูููู ุฃููุง ูู ุจูุณูู ุจุจุณุงุทุฉ ุนู ุทุฑูู ุชุญููู ุงูููุน ุฅูู ุจุงูุช.  ููุฐุง ุณูุฏุนู ูุง ูุตู ุฅูู 256 ููุนูุง ูู ุงูุชุถุงุฑูุณ ุ ููู ูุง ุณูููู ููุง. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RefreshTerrain</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">HexCell cell</span></span></span><span class="hljs-function">)</span></span> { cellTextureData[cell.Index].a = (<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>)cell.TerrainTypeIndex; }</code> </pre> <br>  ูุชุทุจูู ุงูุจูุงูุงุช ุนูู ูุงุฏุฉ <code>Texture2D.SetPixels32</code> ุฅูู GPU ุ ูุญุชุงุฌ ุฅูู ุงุณุชุฏุนุงุก <code>Texture2D.SetPixels32</code> ุ ุซู <code>Texture2D.Apply</code> .  ููุง ูู ุงูุญุงู ูู ุงูุฃุฌุฒุงุก ุ ุณูููู ุจุชุฃุฌูู ูุฐู ุงูุนูููุงุช ุนูู <code>LateUpdate</code> ุจุญูุซ ูุง ูููู ุฅุฌุฑุงุคูุง ุฃูุซุฑ ูู ูุฑุฉ ููู ุฅุทุงุฑ ุ ุจุบุถ ุงููุธุฑ ุนู ุนุฏุฏ ุงูุฎูุงูุง ุงููุชุบูุฑุฉ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RefreshTerrain</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">HexCell cell</span></span></span><span class="hljs-function">)</span></span> { cellTextureData[cell.Index].a = (<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>)cell.TerrainTypeIndex; enabled = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">LateUpdate</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { cellTexture.SetPixels32(cellTextureData); cellTexture.Apply(); enabled = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; }</code> </pre> <br>  ูุถูุงู ุชุญุฏูุซ ุงูุจูุงูุงุช ุจุนุฏ ุฅูุดุงุก ุฎุฑูุทุฉ ุฌุฏูุฏุฉ ุ ูู ุจุชูููู ุงููููู ุจุนุฏ ุงูุชููุฆุฉ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Initialize</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> x, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> z</span></span></span><span class="hljs-function">)</span></span> { โฆ enabled = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; }</code> </pre> <br><h3 style=";text-align:right;direction:rtl">  ุชุซููุซ ูุคุดุฑุงุช ุงูุฎููุฉ </h3><br>  ูุธุฑูุง ูุฃููุง ูุฎุฒู ุงูุขู ูุคุดุฑ ููุน ุงูุงุฑุชูุงุน ูู ูุฐู ุงูุฎูุงูุง ุ ูู ูุนุฏ ุจุญุงุฌุฉ ุฅูู ุชุถููููุง ูู ุนูููุฉ ุงูุชุซููุซ.  ูููู ูู ุฃุฌู ุงุณุชุฎุฏุงู ุจูุงูุงุช ุงูุฎููุฉ ุ ูุฌุจ ุฃู ูุนุฑู ุฌูุงุฒ ุชุธููู ุฃู ุงูููุงุฑุณ ูุงุณุชุฎุฏุงููุง.  ูุฐูู ุ ุชุญุชุงุฌ ุฅูู ุชุฎุฒูู ูุคุดุฑุงุช ุงูุฎูุงูุง ูู ุจูุงูุงุช ุงูุดุจูุฉ ุ ูุงุณุชุจุฏุงู ูุคุดุฑุงุช ููุน ุงูุงุฑุชูุงุน.  ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ูุง ุฒููุง ุจุญุงุฌุฉ ุฅูู ููุงุฉ ุงูููู ููุดุจูุฉ ูุฎูุท ุงูุฎูุงูุง ุนูุฏ ุงุณุชุฎุฏุงู ูุฐู ุงูุฎูุงูุง. <br><br>  <code>HexMesh</code> ุงูุญููู ุงูุดุงุฆุนุฉ ุงููุชูุงุฏูุฉ <code>useColors</code> ู <code>useTerrainTypes</code> .  <code>useCellData</code> ุจุญูู <code>useCellData</code> ูุงุญุฏ <code>useCellData</code> . <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">// public bool useCollider, useColors, useUVCoordinates, useUV2Coordinates; // public bool useTerrainTypes; public bool useCollider, useCellData, useUVCoordinates, useUV2Coordinates;</span></span></code> </pre><br>  ูุญู <code>terrainTypes</code> ูุงุฆูุฉ <code>cellIndices</code> ุฅูู <code>cellIndices</code> .  ูููู ุฃูุถูุง ุจุฅุนุงุฏุฉ ุชุณููุฉ <code>colors</code> ุฅูู <code>cellWeights</code> - <code>cellWeights</code> ูุฐุง ุงูุงุณู ุจุดูู ุฃูุถู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">// [NonSerialized] List&lt;Vector3&gt; vertices, terrainTypes; // [NonSerialized] List&lt;Color&gt; colors; [NonSerialized] List&lt;Vector3&gt; vertices, cellIndices; [NonSerialized] List&lt;Color&gt; cellWeights; [NonSerialized] List&lt;Vector2&gt; uvs, uv2s; [NonSerialized] List&lt;int&gt; triangles;</span></span></code> </pre><br>  ุชุบููุฑ <code>Clear</code> ุจุญูุซ ุชุญุตู ุนูุฏ ุงุณุชุฎุฏุงู ูุฐู ุงูุฎูุงูุง ุนูู ูุงุฆูุชูู ูุนูุง ุ ูููุณ ุจุดูู ูููุตู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Clear</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { hexMesh.Clear(); vertices = ListPool&lt;Vector3&gt;.Get(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (useCellData) { cellWeights = ListPool&lt;Color&gt;.Get(); cellIndices = ListPool&lt;Vector3&gt;.Get(); } <span class="hljs-comment"><span class="hljs-comment">// if (useColors) { // colors = ListPool&lt;Color&gt;.Get(); // } if (useUVCoordinates) { uvs = ListPool&lt;Vector2&gt;.Get(); } if (useUV2Coordinates) { uv2s = ListPool&lt;Vector2&gt;.Get(); } // if (useTerrainTypes) { // terrainTypes = ListPool&lt;Vector3&gt;.Get(); // } triangles = ListPool&lt;int&gt;.Get(); }</span></span></code> </pre> <br>  ุชูููุฐ ููุณ ุงูุชุฌููุน ูู <code>Apply</code> . <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Apply</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { hexMesh.SetVertices(vertices); ListPool&lt;Vector3&gt;.Add(vertices); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (useCellData) { hexMesh.SetColors(cellWeights); ListPool&lt;Color&gt;.Add(cellWeights); hexMesh.SetUVs(<span class="hljs-number"><span class="hljs-number">2</span></span>, cellIndices); ListPool&lt;Vector3&gt;.Add(cellIndices); } <span class="hljs-comment"><span class="hljs-comment">// if (useColors) { // hexMesh.SetColors(colors); // ListPool&lt;Color&gt;.Add(colors); // } if (useUVCoordinates) { hexMesh.SetUVs(0, uvs); ListPool&lt;Vector2&gt;.Add(uvs); } if (useUV2Coordinates) { hexMesh.SetUVs(1, uv2s); ListPool&lt;Vector2&gt;.Add(uv2s); } // if (useTerrainTypes) { // hexMesh.SetUVs(2, terrainTypes); // ListPool&lt;Vector3&gt;.Add(terrainTypes); // } hexMesh.SetTriangles(triangles, 0); ListPool&lt;int&gt;.Add(triangles); hexMesh.RecalculateNormals(); if (useCollider) { meshCollider.sharedMesh = hexMesh; } }</span></span></code> </pre> <br>  ุฏุนูุง ูุฒูู ูู <code>AddTriangleTerrainTypes</code> ู <code>AddTriangleTerrainTypes</code> .  <code>AddTriangleCellData</code> ุจุฃุณุงููุจ <code>AddTriangleCellData</code> ุงูููุงุณุจุฉ ุ ูุงูุชู ุชุถูู ุงูููุงุฑุณ ูุงูุฃูุฒุงู ูู ูู ูุฑุฉ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AddTriangleCellData</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> Vector3 indices, Color weights1, Color weights2, Color weights3 </span></span></span><span class="hljs-function">)</span></span> { cellIndices.Add(indices); cellIndices.Add(indices); cellIndices.Add(indices); cellWeights.Add(weights1); cellWeights.Add(weights2); cellWeights.Add(weights3); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AddTriangleCellData</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Vector3 indices, Color weights</span></span></span><span class="hljs-function">)</span></span> { AddTriangleCellData(indices, weights, weights, weights); }</code> </pre> <br>  ุงูุนู ููุณ ุงูุดูุก ูู ุทุฑููุฉ <code>AddQuad</code> ุงูููุงุณุจุฉ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AddQuadCellData</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> Vector3 indices, Color weights1, Color weights2, Color weights3, Color weights4 </span></span></span><span class="hljs-function">)</span></span> { cellIndices.Add(indices); cellIndices.Add(indices); cellIndices.Add(indices); cellIndices.Add(indices); cellWeights.Add(weights1); cellWeights.Add(weights2); cellWeights.Add(weights3); cellWeights.Add(weights4); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AddQuadCellData</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> Vector3 indices, Color weights1, Color weights2 </span></span></span><span class="hljs-function">)</span></span> { AddQuadCellData(indices, weights1, weights1, weights2, weights2); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AddQuadCellData</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Vector3 indices, Color weights</span></span></span><span class="hljs-function">)</span></span> { AddQuadCellData(indices, weights, weights, weights, weights); }</code> </pre> <br><h3 style=";text-align:right;direction:rtl">  ุฅุนุงุฏุฉ ููููุฌุฑูุฏุชุดููู </h3><br>  ูู ูุฐู ุงููุฑุญูุฉ ุ ูุญุตู ุนูู ุงููุซูุฑ ูู ุฃุฎุทุงุก ุงููุชุฑุฌู ูู <code>HexGridChunk</code> ุงูุชู ูุฌุจ <code>HexGridChunk</code> .  ูููู ุฃููุงู ุ ูู ุฃุฌู ุงูุงุชุณุงู ุ ูุนูุฏ ุชุณููุฉ ุงูุฃููุงู ุงูุซุงุจุชุฉ ููุฃูุฒุงู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> Color weights1 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Color(<span class="hljs-number"><span class="hljs-number">1f</span></span>, <span class="hljs-number"><span class="hljs-number">0f</span></span>, <span class="hljs-number"><span class="hljs-number">0f</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> Color weights2 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Color(<span class="hljs-number"><span class="hljs-number">0f</span></span>, <span class="hljs-number"><span class="hljs-number">1f</span></span>, <span class="hljs-number"><span class="hljs-number">0f</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> Color weights3 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Color(<span class="hljs-number"><span class="hljs-number">0f</span></span>, <span class="hljs-number"><span class="hljs-number">0f</span></span>, <span class="hljs-number"><span class="hljs-number">1f</span></span>);</code> </pre> <br>  ููุจุฏุฃ ุจุฅุตูุงุญ <code>TriangulateEdgeFan</code> .  ูุงู ูุญุชุงุฌ ุฅูู ููุน ุ ูููู ุงูุขู ุจุญุงุฌุฉ ุฅูู ููุฑุณ ุฎููุฉ.  <code>AddTriangleColor</code> ุฑูุฒ <code>AddTriangleTerrainTypes</code> ู <code>AddTriangleTerrainTypes</code> ุจุฑูุฒ <code>AddTriangleCellData</code> ุงูููุงุจู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TriangulateEdgeFan</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Vector3 center, EdgeVertices edge, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> index</span></span></span><span class="hljs-function">)</span></span> { terrain.AddTriangle(center, edge.v1, edge.v2); terrain.AddTriangle(center, edge.v2, edge.v3); terrain.AddTriangle(center, edge.v3, edge.v4); terrain.AddTriangle(center, edge.v4, edge.v5); Vector3 indices; indices.x = indices.y = indices.z = index; terrain.AddTriangleCellData(indices, weights1); terrain.AddTriangleCellData(indices, weights1); terrain.AddTriangleCellData(indices, weights1); terrain.AddTriangleCellData(indices, weights1); <span class="hljs-comment"><span class="hljs-comment">// terrain.AddTriangleColor(weights1); // terrain.AddTriangleColor(weights1); // terrain.AddTriangleColor(weights1); // terrain.AddTriangleColor(weights1); // Vector3 types; // types.x = types.y = types.z = type; // terrain.AddTriangleTerrainTypes(types); // terrain.AddTriangleTerrainTypes(types); // terrain.AddTriangleTerrainTypes(types); // terrain.AddTriangleTerrainTypes(types); }</span></span></code> </pre> <br>  ุชุณูู ูุฐู ุงูุทุฑููุฉ ูู ุนุฏุฉ ุฃูุงูู.  ุฏุนููุง ูุฑุงุฌุนูุง ููุชุฃูุฏ ูู ุฃู ููุฑุณ ุงูุฎููุฉ ูููู ููุงู ุ ูููุณ ููุน ุงูุชุถุงุฑูุณ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> TriangulateEdgeFan(center, e, cell.Index);</code> </pre> <br>  ุงูุชุงูู ูู <code>TriangulateEdgeStrip</code> .  ูู ุดูุก ุฃูุซุฑ ุชุนููุฏูุง ููุง ุ ููููุง ูุณุชุฎุฏู ููุณ ุงูููุฌ.  ุฃูุถุง ุฅุนุงุฏุฉ ุชุณููุฉ refactor ุฃุณูุงุก ุงููุนููุงุช <code>c1</code> ู <code>c2</code> ุฅูู <code>w1</code> ู <code>w2</code> . <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TriangulateEdgeStrip</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> EdgeVertices e1, Color w1, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> index1, EdgeVertices e2, Color w2, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> index2, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> hasRoad = </span></span><span class="hljs-literal"><span class="hljs-function"><span class="hljs-params"><span class="hljs-literal">false</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span></span><span class="hljs-function">)</span></span> { terrain.AddQuad(e1.v1, e1.v2, e2.v1, e2.v2); terrain.AddQuad(e1.v2, e1.v3, e2.v2, e2.v3); terrain.AddQuad(e1.v3, e1.v4, e2.v3, e2.v4); terrain.AddQuad(e1.v4, e1.v5, e2.v4, e2.v5); Vector3 indices; indices.x = indices.z = index1; indices.y = index2; terrain.AddQuadCellData(indices, w1, w2); terrain.AddQuadCellData(indices, w1, w2); terrain.AddQuadCellData(indices, w1, w2); terrain.AddQuadCellData(indices, w1, w2); <span class="hljs-comment"><span class="hljs-comment">// terrain.AddQuadColor(c1, c2); // terrain.AddQuadColor(c1, c2); // terrain.AddQuadColor(c1, c2); // terrain.AddQuadColor(c1, c2); // Vector3 types; // types.x = types.z = type1; // types.y = type2; // terrain.AddQuadTerrainTypes(types); // terrain.AddQuadTerrainTypes(types); // terrain.AddQuadTerrainTypes(types); // terrain.AddQuadTerrainTypes(types); if (hasRoad) { TriangulateRoadSegment(e1.v2, e1.v3, e1.v4, e2.v2, e2.v3, e2.v4); } }</span></span></code> </pre> <br>  ูู ุจุชุบููุฑ ุงูููุงููุงุช ุฅูู ูุฐู ุงูุทุฑููุฉ ุจุญูุซ ูุชู ุชูุฑูุฑ ููุฑุณ ุงูุฎููุฉ ุฅูููุง.  ูุญุงูุธ ุฃูุถูุง ุนูู ุชูุงุณู ุฃุณูุงุก ุงููุชุบูุฑุงุช. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> TriangulateEdgeStrip( m, weights1, cell.Index, e, weights1, cell.Index ); โฆ TriangulateEdgeStrip( e1, weights1, cell.Index, e2, weights2, neighbor.Index, hasRoad ); โฆ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TriangulateEdgeTerraces</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> EdgeVertices begin, HexCell beginCell, EdgeVertices end, HexCell endCell, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> hasRoad </span></span></span><span class="hljs-function">)</span></span> { EdgeVertices e2 = EdgeVertices.TerraceLerp(begin, end, <span class="hljs-number"><span class="hljs-number">1</span></span>); Color w2 = HexMetrics.TerraceLerp(weights1, weights2, <span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> i1 = beginCell.Index; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> i2 = endCell.Index; TriangulateEdgeStrip(begin, weights1, i1, e2, w2, i2, hasRoad); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">2</span></span>; i &lt; HexMetrics.terraceSteps; i++) { EdgeVertices e1 = e2; Color w1 = w2; e2 = EdgeVertices.TerraceLerp(begin, end, i); w2 = HexMetrics.TerraceLerp(weights1, weights2, i); TriangulateEdgeStrip(e1, w1, i1, e2, w2, i2, hasRoad); } TriangulateEdgeStrip(e2, w2, i1, end, weights2, i2, hasRoad); }</code> </pre> <br>  ุงูุขู ููุชูู ุฅูู ุทุฑู ุงูุฒุงููุฉ.  ูุฐู ุงูุชุบููุฑุงุช ุจุณูุทุฉ ุ ูููู ูุฌุจ ุฅุฌุฑุงุคูุง ูู ูููุฉ ูุจูุฑุฉ ูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ.  ุฃููุงู ูู <code>TriangulateCorner</code> . <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TriangulateCorner</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> Vector3 bottom, HexCell bottomCell, Vector3 left, HexCell leftCell, Vector3 right, HexCell rightCell </span></span></span><span class="hljs-function">)</span></span> { โฆ <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { terrain.AddTriangle(bottom, left, right); Vector3 indices; indices.x = bottomCell.Index; indices.y = leftCell.Index; indices.z = rightCell.Index; terrain.AddTriangleCellData(indices, weights1, weights2, weights3); <span class="hljs-comment"><span class="hljs-comment">// terrain.AddTriangleColor(weights1, weights2, weights3); // Vector3 types; // types.x = bottomCell.TerrainTypeIndex; // types.y = leftCell.TerrainTypeIndex; // types.z = rightCell.TerrainTypeIndex; // terrain.AddTriangleTerrainTypes(types); } features.AddWall(bottom, bottomCell, left, leftCell, right, rightCell); }</span></span></code> </pre> <br>  ุงููุงุฏูุฉ ุฅูู <code>TriangulateCornerTerraces</code> . <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TriangulateCornerTerraces</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> Vector3 begin, HexCell beginCell, Vector3 left, HexCell leftCell, Vector3 right, HexCell rightCell </span></span></span><span class="hljs-function">)</span></span> { Vector3 v3 = HexMetrics.TerraceLerp(begin, left, <span class="hljs-number"><span class="hljs-number">1</span></span>); Vector3 v4 = HexMetrics.TerraceLerp(begin, right, <span class="hljs-number"><span class="hljs-number">1</span></span>); Color w3 = HexMetrics.TerraceLerp(weights1, weights2, <span class="hljs-number"><span class="hljs-number">1</span></span>); Color w4 = HexMetrics.TerraceLerp(weights1, weights3, <span class="hljs-number"><span class="hljs-number">1</span></span>); Vector3 indices; indices.x = beginCell.Index; indices.y = leftCell.Index; indices.z = rightCell.Index; terrain.AddTriangle(begin, v3, v4); terrain.AddTriangleCellData(indices, weights1, w3, w4); <span class="hljs-comment"><span class="hljs-comment">// terrain.AddTriangleColor(weights1, w3, w4); // terrain.AddTriangleTerrainTypes(indices); for (int i = 2; i &lt; HexMetrics.terraceSteps; i++) { Vector3 v1 = v3; Vector3 v2 = v4; Color w1 = w3; Color w2 = w4; v3 = HexMetrics.TerraceLerp(begin, left, i); v4 = HexMetrics.TerraceLerp(begin, right, i); w3 = HexMetrics.TerraceLerp(weights1, weights2, i); w4 = HexMetrics.TerraceLerp(weights1, weights3, i); terrain.AddQuad(v1, v2, v3, v4); terrain.AddQuadCellData(indices, w1, w2, w3, w4); // terrain.AddQuadColor(w1, w2, w3, w4); // terrain.AddQuadTerrainTypes(indices); } terrain.AddQuad(v3, v4, left, right); terrain.AddQuadCellData(indices, w3, w4, weights2, weights3); // terrain.AddQuadColor(w3, w4, weights2, weights3); // terrain.AddQuadTerrainTypes(indices); }</span></span></code> </pre> <br>  ุซู ูู <code>TriangulateCornerTerracesCliff</code> . <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TriangulateCornerTerracesCliff</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> Vector3 begin, HexCell beginCell, Vector3 left, HexCell leftCell, Vector3 right, HexCell rightCell </span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> b = <span class="hljs-number"><span class="hljs-number">1f</span></span> / (rightCell.Elevation - beginCell.Elevation); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (b &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { b = -b; } Vector3 boundary = Vector3.Lerp( HexMetrics.Perturb(begin), HexMetrics.Perturb(right), b ); Color boundaryWeights = Color.Lerp(weights1, weights3, b); Vector3 indices; indices.x = beginCell.Index; indices.y = leftCell.Index; indices.z = rightCell.Index; TriangulateBoundaryTriangle( begin, weights1, left, weights2, boundary, boundaryWeights, indices ); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (leftCell.GetEdgeType(rightCell) == HexEdgeType.Slope) { TriangulateBoundaryTriangle( left, weights2, right, weights3, boundary, boundaryWeights, indices ); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { terrain.AddTriangleUnperturbed( HexMetrics.Perturb(left), HexMetrics.Perturb(right), boundary ); terrain.AddTriangleCellData( indices, weights2, weights3, boundaryWeights ); <span class="hljs-comment"><span class="hljs-comment">// terrain.AddTriangleColor(weights2, weights3, boundaryColor); // terrain.AddTriangleTerrainTypes(indices); } }</span></span></code> </pre> <br>  ูุจุดูู ูุฎุชูู ููููุง ูู <code>TriangulateCornerCliffTerraces</code> . <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TriangulateCornerCliffTerraces</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> Vector3 begin, HexCell beginCell, Vector3 left, HexCell leftCell, Vector3 right, HexCell rightCell </span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> b = <span class="hljs-number"><span class="hljs-number">1f</span></span> / (leftCell.Elevation - beginCell.Elevation); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (b &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { b = -b; } Vector3 boundary = Vector3.Lerp( HexMetrics.Perturb(begin), HexMetrics.Perturb(left), b ); Color boundaryWeights = Color.Lerp(weights1, weights2, b); Vector3 indices; indices.x = beginCell.Index; indices.y = leftCell.Index; indices.z = rightCell.Index; TriangulateBoundaryTriangle( right, weights3, begin, weights1, boundary, boundaryWeights, indices ); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (leftCell.GetEdgeType(rightCell) == HexEdgeType.Slope) { TriangulateBoundaryTriangle( left, weights2, right, weights3, boundary, boundaryWeights, indices ); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { terrain.AddTriangleUnperturbed( HexMetrics.Perturb(left), HexMetrics.Perturb(right), boundary ); terrain.AddTriangleCellData( indices, weights2, weights3, boundaryWeights ); <span class="hljs-comment"><span class="hljs-comment">// terrain.AddTriangleColor(weights2, weights3, boundaryWeights); // terrain.AddTriangleTerrainTypes(indices); } }</span></span></code> </pre> <br>  ุชุณุชุฎุฏู ุงูุทุฑููุชุงู <code>TriangulateBoundaryTriangle</code> ุ ูุงูุฐู ูุชุทูุจ ุฃูุถูุง ุงูุชุญุฏูุซ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TriangulateBoundaryTriangle</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> Vector3 begin, Color beginWeights, Vector3 left, Color leftWeights, Vector3 boundary, Color boundaryWeights, Vector3 indices </span></span></span><span class="hljs-function">)</span></span> { Vector3 v2 = HexMetrics.Perturb(HexMetrics.TerraceLerp(begin, left, <span class="hljs-number"><span class="hljs-number">1</span></span>)); Color w2 = HexMetrics.TerraceLerp(beginWeights, leftWeights, <span class="hljs-number"><span class="hljs-number">1</span></span>); terrain.AddTriangleUnperturbed(HexMetrics.Perturb(begin), v2, boundary); terrain.AddTriangleCellData(indices, beginWeights, w2, boundaryWeights); <span class="hljs-comment"><span class="hljs-comment">// terrain.AddTriangleColor(beginColor, c2, boundaryColor); // terrain.AddTriangleTerrainTypes(types); for (int i = 2; i &lt; HexMetrics.terraceSteps; i++) { Vector3 v1 = v2; Color w1 = w2; v2 = HexMetrics.Perturb(HexMetrics.TerraceLerp(begin, left, i)); w2 = HexMetrics.TerraceLerp(beginWeights, leftWeights, i); terrain.AddTriangleUnperturbed(v1, v2, boundary); terrain.AddTriangleCellData(indices, w1, w2, boundaryWeights); // terrain.AddTriangleColor(c1, c2, boundaryColor); // terrain.AddTriangleTerrainTypes(types); } terrain.AddTriangleUnperturbed(v2, HexMetrics.Perturb(left), boundary); terrain.AddTriangleCellData(indices, w2, leftWeights, boundaryWeights); // terrain.AddTriangleColor(c2, leftColor, boundaryColor); // terrain.AddTriangleTerrainTypes(types); }</span></span></code> </pre> <br>  ุงูุทุฑููุฉ ุงูุฃุฎูุฑุฉ ุงูุชู ุชุญุชุงุฌ ุฅูู ุชุบููุฑ ูู <code>TriangulateWithRiver</code> . <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TriangulateWithRiver</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> HexDirection direction, HexCell cell, Vector3 center, EdgeVertices e </span></span></span><span class="hljs-function">)</span></span> { โฆ terrain.AddTriangle(centerL, m.v1, m.v2); terrain.AddQuad(centerL, center, m.v2, m.v3); terrain.AddQuad(center, centerR, m.v3, m.v4); terrain.AddTriangle(centerR, m.v4, m.v5); Vector3 indices; indices.x = indices.y = indices.z = cell.Index; terrain.AddTriangleCellData(indices, weights1); terrain.AddQuadCellData(indices, weights1); terrain.AddQuadCellData(indices, weights1); terrain.AddTriangleCellData(indices, weights1); <span class="hljs-comment"><span class="hljs-comment">// terrain.AddTriangleColor(weights1); // terrain.AddQuadColor(weights1); // terrain.AddQuadColor(weights1); // terrain.AddTriangleColor(weights1); // Vector3 types; // types.x = types.y = types.z = cell.TerrainTypeIndex; // terrain.AddTriangleTerrainTypes(types); // terrain.AddQuadTerrainTypes(types); // terrain.AddQuadTerrainTypes(types); // terrain.AddTriangleTerrainTypes(types); โฆ }</span></span></code> </pre> <br>  ููู ูุนูู ูู ุดูุก ุ ูุญุชุงุฌ ุฅูู ุงูุฅุดุงุฑุฉ ุฅูู ุฃููุง ุณูุณุชุฎุฏู ุจูุงูุงุช ุงูุฎููุฉ ููุนูุตุฑ ุงููุฑุนู ูุชุฎููู ุงูุฌุฒุก ุงูุฌุงูุฒ. <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/919/b8c/731/919b8c7317b2aa3c06f1077eef27fe96.png"></div><br>  <i>ูุณุชุฎุฏู ุงูุฅุบุงุซุฉ ุจูุงูุงุช ุงูุฎููุฉ.</i> <br><br>  ูู ูุฐู ุงููุฑุญูุฉ ุ ุชุญุชูู ุงูุดุจูุฉ ุนูู ููุงุฑุณ ุงูุฎูุงูุง ุจุฏูุงู ูู ูุคุดุฑุงุช ููุน ุงูุงุฑุชูุงุน.  ูุธุฑูุง ูุฃู ุชุธููู ุงูุงุฑุชูุงุน ูุง ูุฒุงู ููุณุฑูุง ููุคุดุฑุงุช ุงุฑุชูุงุน ุ ุณูุฑู ุฃู ุงูุฎููุฉ ุงูุฃููู ูุชู ุชูุฏูููุง ูุน ุงููุณูุฌ ุงูุฃูู ูููุฐุง ุญุชู ูุชู ุงููุตูู ุฅูู ูุณูุฌ ุงูุฅุบุงุซุฉ ุงูุฃุฎูุฑ. <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/8a5/a23/ce8/8a5a23ce850af789e759dde6879f93eb.png"></div><br>  <i>ุงุณุชุฎุฏุงู ูุคุดุฑุงุช ุงูุฎููุฉ ููุคุดุฑุงุช ูุณูุฌ ุงูุงุฑุชูุงุน.</i> <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ูุง ูููููู ุงูุญุตูู ุนูู ุฑูุฒ ุฅุนุงุฏุฉ ุงูุชุดุบูู ููุนูู.</b>  <b class="spoiler_title">ูุงุฐุง ุฃูุนู ุฎุทุฃุ</b> <div class="spoiler_text" style=";text-align:right;direction:rtl">  ูู ููุช ูุงุญุฏ ุ ูููุง ุจุชุบููุฑ ูููุฉ ูุจูุฑุฉ ูู ุฑูุฒ ุงูุชุซููุซ ุ ูุฐูู ููุงู ุงุญุชูุงู ูุจูุฑ ููุฃุฎุทุงุก ุฃู ุนูููุงุช ุงููุฑุงูุจุฉ.  ุฅุฐุง ูู ุชุชููู ูู ุงูุนุซูุฑ ุนูู ุงูุฎุทุฃ ุ ูุญุงูู ุชูุฒูู ุงูุญุฒูุฉ ูู ูุฐุง ุงููุณู ูุงุณุชุฎุฑุงุฌ ุงููููุงุช ุงูููุงุณุจุฉ.  ููููู ุงุณุชูุฑุงุฏูุง ุฅูู ูุดุฑูุน ูููุตู ูููุงุฑูุชูุง ุจุงูุฑูุฒ ุงูุฎุงุต ุจู. </div></div><br><h3 style=";text-align:right;direction:rtl">  ููู ุจูุงูุงุช ุงูุฎููุฉ ุฅูู ุชุธููู </h3><br>  ูุงุณุชุฎุฏุงู ูุฐู ุงูุฎูุงูุง ุ ูุฌุจ ุฃู ูููู ุจุฅููุงู ุฌูุงุฒ ุชุธููู ุงูุชุถุงุฑูุณ ุงููุตูู ุฅูููุง.  ูููู ุชูููุฐ ุฐูู ูู ุฎูุงู ุฎุงุตูุฉ ุชุธููู.  ุณูุชุทูุจ ูุฐุง <code>HexCellShaderData</code> ูุชุนููู ุฎุงุตูุฉ ุงูููุงุฏ ููุฅุบุงุซุฉ.  ุฃู ูููููุง ุฌุนู ูุณูุฌ ูุฐู ุงูุฎูุงูุง ูุฑุฆููุง ุนุงููููุง ูุฌููุน ุงูุชุธููู.  ูุฐุง ููุงุณุจ ูุฃููุง ูุญุชุงุฌู ูู ุงูุนุฏูุฏ ูู ุงูุชุธููู ุ ูุฐูู ุณูุณุชุฎุฏู ูุฐุง ุงูููุฌ. <br><br>  ุจุนุฏ ุฅูุดุงุก ูุณูุฌ ุงูุฎููุฉ ุ ูู ุจุงุณุชุฏุนุงุก ุทุฑููุฉ <code>Shader.SetGlobalTexture</code> ุงูุซุงุจุชุฉ ูุฌุนููุง ูุฑุฆูุฉ ุนุงููููุง ุจุงุณู <em>_HexCellData</em> . <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Initialize</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> x, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> z</span></span></span><span class="hljs-function">)</span></span> { โฆ <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { cellTexture = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Texture2D( x, z, TextureFormat.RGBA32, <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-literal"><span class="hljs-literal">true</span></span> ); cellTexture.filterMode = FilterMode.Point; cellTexture.wrapMode = TextureWrapMode.Clamp; Shader.SetGlobalTexture(<span class="hljs-string"><span class="hljs-string">"_HexCellData"</span></span>, cellTexture); } โฆ }</code> </pre> <br>  ุนูุฏ ุงุณุชุฎุฏุงู ุฎุงุตูุฉ ุงูุชุธููู ุ ุชุฌุนู Unity ุญุฌู ุงููุงุฏุฉ ูุชุงุญูุง <em>ููุชุธููู</em> ุนุจุฑ ูุชุบูุฑ <em>ูุณูุฌ ุงูุงุณู _exelSize</em> .  ูุฐุง ุนุจุงุฑุฉ ุนู ุฃุฏุงุฉ ูุงูู ููููุฉ ูู ุฃุฑุจุนุฉ ููููุงุช ุชุญุชูู ุนูู ููู ูุนููุณุฉ ููุนุฑุถ ูุงูุงุฑุชูุงุน ุ ููุฐูู ุงูุนุฑุถ ูุงูุงุฑุชูุงุน.  ูููู ุนูุฏ ุชุญุฏูุฏ ุงููููุณ ุงูุนุงููู ุ ูุง ูุชู ุชูููุฐ ุฐูู.  ูุฐูู ุ ุณููุนู ุฐูู ุจุฃููุณูุง ุจุงุณุชุฎุฏุงู <code>Shader.SetGlobalVector</code> ุจุนุฏ ุฅูุดุงุก ุฃู ุชุบููุฑ ุญุฌู ุงููุณูุฌ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { cellTexture = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Texture2D( x, z, TextureFormat.RGBA32, <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-literal"><span class="hljs-literal">true</span></span> ); cellTexture.filterMode = FilterMode.Point; cellTexture.wrapMode = TextureWrapMode.Clamp; Shader.SetGlobalTexture(<span class="hljs-string"><span class="hljs-string">"_HexCellData"</span></span>, cellTexture); } Shader.SetGlobalVector( <span class="hljs-string"><span class="hljs-string">"_HexCellData_TexelSize"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector4(<span class="hljs-number"><span class="hljs-number">1f</span></span> / x, <span class="hljs-number"><span class="hljs-number">1f</span></span> / z, x, z) );</code> </pre> <br><h3 style=";text-align:right;direction:rtl">  ุงููุตูู ุฅูู ุจูุงูุงุช ุดุงุฏุฑ </h3><br>  ูู ุจุฅูุดุงุก ููู ุชุธููู ุฌุฏูุฏ ูู ููู ุงูููุงุฏ ูุณูู <em>HexCellData</em> .  ุฏุงุฎูู ุ ูุญุฏุฏ ุงููุชุบูุฑุงุช ููุญุตูู ุนูู ูุนูููุงุช ุญูู ูุณูุฌ ูุญุฌู ูุฐู ุงูุฎูุงูุง.  ูููู ุฃูุถูุง ุจุฅูุดุงุก ูุธููุฉ ููุญุตูู ุนูู ุจูุงูุงุช ุงูุฎููุฉ ูุจูุงูุงุช ุดุจูุฉ ุงูุฑุฃุณ ุงููุญุฏุฏุฉ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">sampler2D</span></span> _HexCellData; <span class="hljs-attribute"><span class="hljs-attribute">float4</span></span> _HexCellData_TexelSize; <span class="hljs-attribute"><span class="hljs-attribute">float4</span></span> GetCellData (appdata_full v) { }</code> </pre> <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/a64/604/dbc/a64604dbc7d3ad5ff1e1578bd0c84eec.png"></div><br>  <i>ููู ุชุถููู ุฌุฏูุฏ.</i> <br><br>  ูุชู ุชุฎุฒูู ูุคุดุฑุงุช ุงูุฎูุงูุง ูู <code>v.texcoord2</code> ุ ููุง ูุงู ุงูุญุงู ูุน ุฃููุงุน ุงูุชุถุงุฑูุณ.  ููุจุฏุฃ ุจุงููุคุดุฑ ุงูุฃูู - <code>v.texcoord2.x</code> .  ูุณูุก ุงูุญุธ ุ ูุง ูููููุง ุงุณุชุฎุฏุงู ุงูููุฑุณ ูุจุงุดุฑุฉู ูุงุฎุชุจุงุฑ ุนููุฉ ูุณูุฌ ูุฐู ุงูุฎูุงูุง.  ุณูุชุนูู ุนูููุง ุชุญูููู ุฅูู ุฅุญุฏุงุซูุงุช ููุฃุดุนุฉ ููู ุงูุจููุณุฌูุฉ. <br><br>  ุงูุฎุทูุฉ ุงูุฃููู ูู ุฅูุดุงุก ุฅุญุฏุงุซูุงุช U ูู ุชูุณูู ููุฑุณ ุงูุฎููุฉ ุญุณุจ ุนุฑุถ ุงููุณูุฌ.  ูููููุง ุงูููุงู ุจุฐูู ุนู ุทุฑูู <code>_HexCellData_TexelSize.x</code> . <br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs cs"><span class="hljs-function"><span class="hljs-function">float4 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetCellData</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">appdata_full v</span></span></span><span class="hljs-function">)</span></span> { float2 uv; uv.x = v.texcoord2.x * _HexCellData_TexelSize.x; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุณุชููู ุงููุชูุฌุฉ ุฑูููุง ูู ุงููููุฐุฌ ZU ุ ุญูุซ Z ูู ููุฑุณ ุงูุตู ู U ูู ุฅุญุฏุงุซูุงุช ุงูุฎููุฉ U. </font><font style="vertical-align: inherit;">ูููููุง ุงุณุชุฎุฑุงุฌ ุงูุณูุณูุฉ ุนู ุทุฑูู ุชูุฑูุจ ุงูุฑูู ูุฃุณูู ุซู ุทุฑุญู ูู ุงูุฑูู ููุญุตูู ุนูู ุฅุญุฏุงุซูุงุช U.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs pgsql"><span class="hljs-type"><span class="hljs-type">float4</span></span> GetCellData (appdata_full v) { float2 uv; uv.x = v.texcoord2.x * _HexCellData_TexelSize.x; <span class="hljs-type"><span class="hljs-type">float</span></span> <span class="hljs-keyword"><span class="hljs-keyword">row</span></span> = floor(uv.x); uv.x -= <span class="hljs-keyword"><span class="hljs-keyword">row</span></span>; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงูุฅุญุฏุงุซูุงุช V ุชูุณู ุงูุฎุท ุนูู ุงุฑุชูุงุน ุงููุณูุฌ. </font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs pgsql"><span class="hljs-type"><span class="hljs-type">float4</span></span> GetCellData (appdata_full v) { float2 uv; uv.x = v.texcoord2.x * _HexCellData_TexelSize.x; <span class="hljs-type"><span class="hljs-type">float</span></span> <span class="hljs-keyword"><span class="hljs-keyword">row</span></span> = floor(uv.x); uv.x -= <span class="hljs-keyword"><span class="hljs-keyword">row</span></span>; uv.y = <span class="hljs-keyword"><span class="hljs-keyword">row</span></span> * _HexCellData_TexelSize.y; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุธุฑูุง ูุฃููุง ูุฃุฎุฐ ุนููุงุช ูู ุงููุณูุฌ ุ ูุญุชุงุฌ ุฅูู ุงุณุชุฎุฏุงู ุงูุฅุญุฏุงุซูุงุช ูู ูุฑุงูุฒ ุงูุจูุณู ุ ูููุณ ุนูู ุญูุงููุง. </font><font style="vertical-align: inherit;">ุจูุฐู ุงูุทุฑููุฉ ูุถูู ุฃู ูุชู ุฃุฎุฐ ุนููุงุช ุงูุจูุณู ุงูุตุญูุญุฉ. </font><font style="vertical-align: inherit;">ูุฐูู ุ ุจุนุฏ ุงููุณูุฉ ุนูู ุญุฌู ุงููุณูุฌ ุ ุฃุถู ยฝ.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs pgsql"><span class="hljs-type"><span class="hljs-type">float4</span></span> GetCellData (appdata_full v) { float2 uv; uv.x = (v.texcoord2.x + <span class="hljs-number"><span class="hljs-number">0.5</span></span>) * _HexCellData_TexelSize.x; <span class="hljs-type"><span class="hljs-type">float</span></span> <span class="hljs-keyword"><span class="hljs-keyword">row</span></span> = floor(uv.x); uv.x -= <span class="hljs-keyword"><span class="hljs-keyword">row</span></span>; uv.y = (<span class="hljs-keyword"><span class="hljs-keyword">row</span></span> + <span class="hljs-number"><span class="hljs-number">0.5</span></span>) * _HexCellData_TexelSize.y; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฐุง ูุนุทููุง ุฅุญุฏุงุซูุงุช ุงูุฃุดุนุฉ ููู ุงูุจููุณุฌูุฉ ุงูุตุญูุญุฉ ููุคุดุฑ ุงูุฎููุฉ ุงูุฃููู ุงููุฎุฒูุฉ ูู ุจูุงูุงุช ุงูููุฉ. </font><font style="vertical-align: inherit;">ูููู ูู ุงูุฃุนูู ูููู ุฃู ูููู ูุฏููุง ูุง ูุตู ุฅูู ุซูุงุซุฉ ูุคุดุฑุงุช ูุฎุชููุฉ. </font><font style="vertical-align: inherit;">ูุฐูู ุ ุณูุฌุนููุง </font></font><code>GetCellData</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุนูู ูุฃู ููุฑุณ. </font><font style="vertical-align: inherit;">ุฃุถู ูุนููุฉ ุนุฏุฏ ุตุญูุญ ุฅูููุง </font></font><code>index</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ ูุงูุชู ุณูุณุชุฎุฏููุง ูููุตูู ุฅูู ูููู ุงููุชุฌู ูุน ููุฑุณ ุงูุฎููุฉ.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs pgsql"><span class="hljs-type"><span class="hljs-type">float4</span></span> GetCellData (appdata_full v, <span class="hljs-type"><span class="hljs-type">int</span></span> <span class="hljs-keyword"><span class="hljs-keyword">index</span></span>) { float2 uv; uv.x = (v.texcoord2[<span class="hljs-keyword"><span class="hljs-keyword">index</span></span>] + <span class="hljs-number"><span class="hljs-number">0.5</span></span>) * _HexCellData_TexelSize.x; <span class="hljs-type"><span class="hljs-type">float</span></span> <span class="hljs-keyword"><span class="hljs-keyword">row</span></span> = floor(uv.x); uv.x -= <span class="hljs-keyword"><span class="hljs-keyword">row</span></span>; uv.y = (<span class="hljs-keyword"><span class="hljs-keyword">row</span></span> + <span class="hljs-number"><span class="hljs-number">0.5</span></span>) * _HexCellData_TexelSize.y; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุขู ูุฏููุง ุฌููุน ุงูุฅุญุฏุงุซูุงุช ุงููุงุฒูุฉ ููุฐู ุงูุฎูุงูุง ุ ูููููุง ุฃุฎุฐ ุงูุนููุงุช </font></font><code>_HexCellData</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ูุธุฑูุง ูุฃููุง ูุฃุฎุฐ ุนููุงุช ูู ุงููุณูุฌ ูู ุจุฑูุงูุฌ vertex ุ ููุญู ุจุญุงุฌุฉ ุฅูู ุฃู ูููู ููุชุธููู ุจุดูู ุตุฑูุญ ุฃู ููุน ูู ุงููููุณ ูุฌุจ ุงุณุชุฎุฏุงูู. </font><font style="vertical-align: inherit;">ูููู ุงูููุงู ุจุฐูู ุจุงุณุชุฎุฏุงู ูุธููุฉ </font></font><code>tex2Dlod</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุชุทูุจ ุฅุญุฏุงุซูุงุช ุฃุฑุจุนุฉ ููุงุฏ. </font><font style="vertical-align: inherit;">ูุธุฑูุง ูุฃู ูุฐู ุงูุฎูุงูุง ูุง ุชุญุชูู ุนูู ููุงุฏ mip ุ ูุฅููุง ูุนูู ููููุง ุตูุฑูุฉ ููุฅุญุฏุงุซูุงุช ุงูุฅุถุงููุฉ.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs pgsql"><span class="hljs-type"><span class="hljs-type">float4</span></span> GetCellData (appdata_full v, <span class="hljs-type"><span class="hljs-type">int</span></span> <span class="hljs-keyword"><span class="hljs-keyword">index</span></span>) { float2 uv; uv.x = (v.texcoord2[<span class="hljs-keyword"><span class="hljs-keyword">index</span></span>] + <span class="hljs-number"><span class="hljs-number">0.5</span></span>) * _HexCellData_TexelSize.x; <span class="hljs-type"><span class="hljs-type">float</span></span> <span class="hljs-keyword"><span class="hljs-keyword">row</span></span> = floor(uv.x); uv.x -= <span class="hljs-keyword"><span class="hljs-keyword">row</span></span>; uv.y = (<span class="hljs-keyword"><span class="hljs-keyword">row</span></span> + <span class="hljs-number"><span class="hljs-number">0.5</span></span>) * _HexCellData_TexelSize.y; <span class="hljs-type"><span class="hljs-type">float4</span></span> data = tex2Dlod(_HexCellData, <span class="hljs-type"><span class="hljs-type">float4</span></span>(uv, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>)); }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุญุชูู ูููู ุงูุจูุงูุงุช ุงูุฑุงุจุน ุนูู ููุฑุณ ููุน ุงูุงุฑุชูุงุน ุ ูุงูุฐู ูููู ุจุชุฎุฒููู ูุจุงุดุฑุฉู ูุจุงูุช. </font><font style="vertical-align: inherit;">ููุน ุฐูู ุ ูุฅู GPU ูุญูููุง ุชููุงุฆููุง ุฅูู ูููุฉ ููุทุฉ ุนุงุฆูุฉ ูู ุงููุทุงู 0-1. </font><font style="vertical-align: inherit;">ูุชุญููููุง ูุฑุฉ ุฃุฎุฑู ุฅูู ุงููููุฉ ุงูุตุญูุญุฉ ุ ุงุถุฑุจูุง ูู 255. ุจุนุฏ ุฐูู ุ ููููู ุฅุฑุฌุงุน ุงูุจูุงูุงุช.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs kotlin"> float4 <span class="hljs-keyword"><span class="hljs-keyword">data</span></span> = tex2Dlod(_HexCellData, float4(uv, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">data</span></span>.w *= <span class="hljs-number"><span class="hljs-number">255</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">data</span></span>;</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุงุณุชุฎุฏุงู ูุฐู ุงููุธููุฉ ุ ูู </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุชูููู HexCellData</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูู </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Terrain</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> shader </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ูุธุฑูุง ูุฃููู ูุถุนุช ูุฐุง ุงูุชุธููู ูู </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูููุงุฏ / ุงูุชุถุงุฑูุณ</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ ุฃุญุชุงุฌ ุฅูู ุงุณุชุฎุฏุงู ุงููุณุงุฑ ุงููุณุจู </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">../HexCellData.cginc</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs lisp"> #include <span class="hljs-string"><span class="hljs-string">"../HexCellData.cginc"</span></span> UNITY_DECLARE_TEX2DARRAY(<span class="hljs-name"><span class="hljs-name">_MainTex</span></span>)<span class="hljs-comment"><span class="hljs-comment">;</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ุจุฑูุงูุฌ ุงูููุฉ ุ ูุญุตู ุนูู ุจูุงูุงุช ุงูุฎููุฉ ูุฌููุน ูุคุดุฑุงุช ุงูุฎูุงูุง ุงูุซูุงุซุฉ ุงููุฎุฒูุฉ ูู ุจูุงูุงุช ุงูููุฉ. </font><font style="vertical-align: inherit;">ุซู ูู ุจุชุนููู </font></font><code>data.terrain</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุคุดุฑุงุช ุงูุงุฑุชูุงุน ุงูุฎุงุตุฉ ุจูู.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs pgsql"> <span class="hljs-type"><span class="hljs-type">void</span></span> vert (<span class="hljs-keyword"><span class="hljs-keyword">inout</span></span> appdata_full v, <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Input</span></span> data) { UNITY_INITIALIZE_OUTPUT(<span class="hljs-keyword"><span class="hljs-keyword">Input</span></span>, data); // data.terrain = v.texcoord2.xyz; <span class="hljs-type"><span class="hljs-type">float4</span></span> cell0 = GetCellData(v, <span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-type"><span class="hljs-type">float4</span></span> cell1 = GetCellData(v, <span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-type"><span class="hljs-type">float4</span></span> cell2 = GetCellData(v, <span class="hljs-number"><span class="hljs-number">2</span></span>); data.terrain.x = cell0.w; data.terrain.y = cell1.w; data.terrain.z = cell2.w; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุนูุฏ ูุฐู ุงูููุทุฉ ุ ุจุฏุฃุช ุงูุฎุฑูุทุฉ ูุฑุฉ ุฃุฎุฑู ูู ุนุฑุถ ุงูุชุถุงุฑูุณ ุงูุตุญูุญุฉ. </font><font style="vertical-align: inherit;">ุงูุงุฎุชูุงู ุงููุจูุฑ ูู ุฃู ุชุญุฑูุฑ ุฃููุงุน ุงูุชุถุงุฑูุณ ููุท ูู ูุนุฏ ูุคุฏู ุฅูู ุชุซููุซ ุฌุฏูุฏ. </font><font style="vertical-align: inherit;">ุฅุฐุง ุชู ุชุบููุฑ ุฃู ุจูุงูุงุช ุฎููุฉ ุฃุฎุฑู ุฃุซูุงุก ุงูุชุญุฑูุฑ ุ ูุณูุชู ุฅุฌุฑุงุก ุงูุชุซููุซ ูุงููุนุชุงุฏ. </font></font><br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุญุฒูุฉ ุงููุญุฏุฉ</font></font></a> <br><br><h2 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงูุฑุคูุฉ </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุนุฏ ุฅูุดุงุก ุฃุณุงุณ ูุฐู ุงูุฎูุงูุง ุ ูููููุง ุงูุงูุชูุงู ูุฏุนู ุงูุฑุคูุฉ. </font><font style="vertical-align: inherit;">ููููุงู ุจุฐูู ุ ูุณุชุฎุฏู ุงูุชุธููู ูุงูุฎูุงูุง ููุณูุง ูุงูุฃุดูุงุก ุงูุชู ุชุญุฏุฏ ุงูุฑุคูุฉ. </font><font style="vertical-align: inherit;">ูุงุญุธ ุฃู ุนูููุฉ ุงูุชุซููุซ ูุง ุชุนุฑู ุดูุฆูุง ุนูู ุงูุฅุทูุงู ุนู ูุฐุง.</font></font><br><br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุดุงุฏุฑ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุจุฏุฃ ุจุฅุฎุจุงุฑ ุฌูุงุฒ ุชุธููู </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุชุถุงุฑูุณ</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุนู ุงูุฑุคูุฉ. </font><font style="vertical-align: inherit;">ุณูุชููู ุจูุงูุงุช ุงูุฑุคูุฉ ูู ุจุฑูุงูุฌ vertex ูููุฑุฑูุง ุฅูู ุจุฑูุงูุฌ ุงูุชุฌุฒุฆุฉ ุจุงุณุชุฎุฏุงู ุงูุจููุฉ </font></font><code>Input</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ูุธุฑูุง ูุฃููุง ูุฌุชุงุฒ ุซูุงุซุฉ ูุคุดุฑุงุช ุงุฑุชูุงุน ูููุตูุฉ ุ ูุฅููุง ุณููุฑุฑ ุซูุงุซ ููู ุฑุคูุฉ ุฃูุถูุง.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs swift"> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Input</span></span></span><span class="hljs-class"> </span></span>{ float4 color : <span class="hljs-type"><span class="hljs-type">COLOR</span></span>; float3 worldPos; float3 terrain; float3 visibility; };</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุชุฎุฒูู ุงูุฑุคูุฉ ุ ูุณุชุฎุฏู ุงููููู ุงูุฃูู ูู ูุฐู ุงูุฎูุงูุง. </font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs kotlin"> void vert (inout appdata_full v, <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> Input <span class="hljs-keyword"><span class="hljs-keyword">data</span></span>) { UNITY_INITIALIZE_OUTPUT(Input, <span class="hljs-keyword"><span class="hljs-keyword">data</span></span>); float4 cell0 = GetCellData(v, <span class="hljs-number"><span class="hljs-number">0</span></span>); float4 cell1 = GetCellData(v, <span class="hljs-number"><span class="hljs-number">1</span></span>); float4 cell2 = GetCellData(v, <span class="hljs-number"><span class="hljs-number">2</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">data</span></span>.terrain.x = cell0.w; <span class="hljs-keyword"><span class="hljs-keyword">data</span></span>.terrain.y = cell1.w; <span class="hljs-keyword"><span class="hljs-keyword">data</span></span>.terrain.z = cell2.w; <span class="hljs-keyword"><span class="hljs-keyword">data</span></span>.visibility.x = cell0.x; <span class="hljs-keyword"><span class="hljs-keyword">data</span></span>.visibility.y = cell1.x; <span class="hljs-keyword"><span class="hljs-keyword">data</span></span>.visibility.z = cell2.x; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุนูู ุฑุคูุฉ 0 ุฃู ุงูุฎููุฉ ุบูุฑ ูุฑุฆูุฉ ุญุงูููุง. </font><font style="vertical-align: inherit;">ุฅุฐุง ูุงูุช ูุฑุฆูุฉ ุ ูุณูููู ููุง ูููุฉ ุงูุฑุคูุฉ 1. ูุจุงูุชุงูู ุ ูููููุง ุชุนุชูู ุงูุชุถุงุฑูุณ ุจุถุฑุจ ุงููุชูุฌุฉ </font></font><code>GetTerrainColor</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ุงููุชุฌู ุงูููุงุจู ููุฑุคูุฉ. </font><font style="vertical-align: inherit;">ูุจุงูุชุงูู ุ ูููู ุจุชุนุฏูู ููู ุงูุฅุบุงุซุฉ ููู ุฎููุฉ ูุฎุชูุทุฉ ุจุดูู ูุฑุฏู.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs pgsql"> <span class="hljs-type"><span class="hljs-type">float4</span></span> GetTerrainColor (<span class="hljs-keyword"><span class="hljs-keyword">Input</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span>, <span class="hljs-type"><span class="hljs-type">int</span></span> <span class="hljs-keyword"><span class="hljs-keyword">index</span></span>) { float3 uvw = float3(<span class="hljs-keyword"><span class="hljs-keyword">IN</span></span>.worldPos.xz * <span class="hljs-number"><span class="hljs-number">0.02</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span>.terrain[<span class="hljs-keyword"><span class="hljs-keyword">index</span></span>]); <span class="hljs-type"><span class="hljs-type">float4</span></span> c = UNITY_SAMPLE_TEX2DARRAY(_MainTex, uvw); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> c * (<span class="hljs-keyword"><span class="hljs-keyword">IN</span></span>.color[<span class="hljs-keyword"><span class="hljs-keyword">index</span></span>] * <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span>.visibility[<span class="hljs-keyword"><span class="hljs-keyword">index</span></span>]); }</code> </pre> <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/1bf/183/e69/1bf183e695a42f4691f63cec72255993.png"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุญููุช ุงูุฎูุงูุง ุฅูู ุงูููู ุงูุฃุณูุฏ.</font></font></i> <br><br><div class="spoiler" style=";text-align:right;direction:rtl"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃูุง ูููููุง ุจุฏูุงู ูู ุฐูู ุฏูุฌ ุงูุฑุคูุฉ ูู ุจุฑูุงูุฌ ุงูููุฉุ</font></font></b> <div class="spoiler_text" style=";text-align:right;direction:rtl">   ,           .              .           .        ,      .   ,     . </div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุธูุงู ุงููุงูู ูู ุชูุซุงู ูุตูู ููุฎูุงูุง ุบูุฑ ุงููุฑุฆูุฉ ูุคูุชูุง. </font><font style="vertical-align: inherit;">ุญุชู ูุชููู ูู ุฑุคูุฉ ุงูุงุฑุชูุงุญ ุ ูุญุชุงุฌ ุฅูู ุฒูุงุฏุฉ ุงููุคุดุฑ ุงููุณุชุฎุฏู ููุฎูุงูุง ุงููุฎููุฉ. </font><font style="vertical-align: inherit;">ุฏุนูุง ููุชูู ูู 0-1 ุฅูู ยผ - 1 ุ ูุงูุฐู ูููู ุงูููุงู ุจู ุจุงุณุชุฎุฏุงู ุงููุธููุฉ </font></font><code>lerp</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ููุงูุฉ ุจุฑูุงูุฌ ุงูููุฉ.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs kotlin"> void vert (inout appdata_full v, <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> Input <span class="hljs-keyword"><span class="hljs-keyword">data</span></span>) { โฆ <span class="hljs-keyword"><span class="hljs-keyword">data</span></span>.visibility.x = cell0.x; <span class="hljs-keyword"><span class="hljs-keyword">data</span></span>.visibility.y = cell1.x; <span class="hljs-keyword"><span class="hljs-keyword">data</span></span>.visibility.z = cell2.x; <span class="hljs-keyword"><span class="hljs-keyword">data</span></span>.visibility = lerp(<span class="hljs-number"><span class="hljs-number">0.25</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">data</span></span>.visibility); }</code> </pre> <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/a20/090/3e2/a200903e2f31f3bdcd0c996d42f91a02.png"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฎูุงูุง ูุธููุฉ.</font></font></i> <br><br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุชุชุจุน ุฑุคูุฉ ุงูุฎููุฉ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููู ุชุนูู ุงูุฑุคูุฉ ุ ูุฌุจ ุนูู ุงูุฎูุงูุง ุชุชุจุน ุฑุคูุชูุง. ูููู ููู ุชุญุฏุฏ ุงูุฎููุฉ ูุง ุฅุฐุง ูุงูุช ูุฑุฆูุฉุ ูููููุง ุงูููุงู ุจุฐูู ุนู ุทุฑูู ุชุชุจุน ุนุฏุฏ ุงูููุงูุงุช ุงูุชู ุชุฑุงู. ุนูุฏูุง ูุจุฏุฃ ุดุฎุต ูู ุฑุคูุฉ ุฎููุฉ ุ ูุฌุจ ุนููู ุงูุฅุจูุงุบ ุนู ูุฐู ุงูุฎููุฉ. ูุนูุฏูุง ูุชููู ุดุฎุต ุนู ุฑุคูุฉ ุงูุฒูุฒุงูุฉ ุ ูุฌุจ ุนููู ุฃูุถูุง ุฅุฎุทุงุฑูุง ุจุฐูู. ุงูุฎููุฉ ุจุจุณุงุทุฉ ุชุชุจุน ุนุฏุฏ ุงููุฑุงูุจูู ุ ูููุง ูุงูุช ุชูู ุงูููุงูุงุช. ุฅุฐุง ูุงู ููุฎููุฉ ูููุฉ ุฑุคูุฉ 1 ุนูู ุงูุฃูู ุ ุชููู ูุฑุฆูุฉ ุ ูุฅูุง ููู ุบูุฑ ูุฑุฆูุฉ. ูุชุทุจูู ูุฐุง ุงูุณููู ุ ูุถูู </font></font><code>HexCell</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุทุฑููุชูู ูุฎุงุตูุฉ </font><font style="vertical-align: inherit;">ุฅูู </font><font style="vertical-align: inherit;">ุงููุชุบูุฑ.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> IsVisible { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> visibility &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>; } } โฆ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> visibility; โฆ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">IncreaseVisibility</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { visibility += <span class="hljs-number"><span class="hljs-number">1</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">DecreaseVisibility</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { visibility -= <span class="hljs-number"><span class="hljs-number">1</span></span>; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุนุฏ ุฐูู ุ ุฃุถู ุฅูู </font></font><code>HexCellShaderData</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุทุฑููุฉ </font></font><code>RefreshVisibility</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ ุงูุชู ุชูุนู ููุณ ุงูุดูุก </font></font><code>RefreshTerrain</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ ููุท ูู ุฃุฌู ุงูุฑุคูุฉ. </font><font style="vertical-align: inherit;">ุญูุธ ุงูุจูุงูุงุช ูู ุงููููู R ูุฎูุงูุง ุงูุจูุงูุงุช. </font><font style="vertical-align: inherit;">ูุธุฑูุง ูุฃููุง ูุนูู ูุน ูุญุฏุงุช ุงูุจุงูุช ุงูุชู ูุชู ุชุญููููุง ุฅูู ุงูููู ูู 0 ุฅูู 1 ุ ูุฅููุง ูุณุชุฎุฏููุง ููุฅุดุงุฑุฉ ุฅูู ุงูุฑุคูุฉ </font></font><code>(byte)255</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RefreshVisibility</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">HexCell cell</span></span></span><span class="hljs-function">)</span></span> { cellTextureData[cell.Index].r = cell.IsVisible ? (<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>)<span class="hljs-number"><span class="hljs-number">255</span></span> : (<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>)<span class="hljs-number"><span class="hljs-number">0</span></span>; enabled = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุณูู ูุณูู ูุฐู ุงูุทุฑููุฉ ุจุฒูุงุฏุฉ ุงูุฑุคูุฉ ูุชูุงูุตูุง ุ ูุชุบููุฑ ุงููููุฉ ุจูู 0 ู 1. </font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">IncreaseVisibility</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { visibility += <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (visibility == <span class="hljs-number"><span class="hljs-number">1</span></span>) { ShaderData.RefreshVisibility(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">DecreaseVisibility</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { visibility -= <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (visibility == <span class="hljs-number"><span class="hljs-number">0</span></span>) { ShaderData.RefreshVisibility(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); } }</code> </pre> <br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุฎูู ุฑุคูุฉ ุงููุฑูู </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฏุนููุง ูุฌุนููุง ุญุชู ุชุชููู ุงููุญุฏุงุช ูู ุฑุคูุฉ ุงูุฎููุฉ ุงูุชู ุชุดุบููุง. </font><font style="vertical-align: inherit;">ูุชู ุชุญููู ุฐูู ุจุงุณุชุฎุฏุงู ููุงููุฉ </font></font><code>IncreaseVisibility</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅูู ุงููููุน ุงูุฌุฏูุฏ ูููุญุฏุฉ ุฃุซูุงุก ุงููููุฉ </font></font><code>HexUnit.Location</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ูุฏุนู ุฃูุถูุง ุฅูู ุงููููุน ุงููุฏูู (ุฅู ูุฌุฏ) </font></font><code>DecreaseVisibility</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> HexCell Location { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> location; } <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (location) { location.DecreaseVisibility(); location.Unit = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; } location = <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>.Unit = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>.IncreaseVisibility(); transform.localPosition = <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>.Position; } }</code> </pre> <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/7bc/f95/a07/7bcf95a07fdf4c10ed1d53055dddf6a4.png"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูููู ูููุญุฏุงุช ูุนุฑูุฉ ููุงููุง. </font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃุฎูุฑุง ุงุณุชุฎุฏููุง ุงูุฑุคูุฉ! </font><font style="vertical-align: inherit;">ุนูุฏ ุฅุถุงูุชูุง ุฅูู ุฎุฑูุทุฉ ุ ุชุฌุนู ุงููุญุฏุงุช ุฎููุชูุง ูุฑุฆูุฉ. </font><font style="vertical-align: inherit;">ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ูุชู ููู ูุทุงููู ุนู ุจุนุฏ ุนูุฏ ุงูุงูุชูุงู ุฅูู ูููุนูู ุงูุฌุฏูุฏ. </font><font style="vertical-align: inherit;">ููู ูุทุงููุง ูุธู ูุดุทูุง ุนูุฏ ุฅุฒุงูุฉ ุงููุญุฏุงุช ูู ุงูุฎุฑูุทุฉ. </font><font style="vertical-align: inherit;">ูุฅุตูุงุญ ุฐูู ุ ุณูููู ูู ูุถูุญ ููุงูุนูุง ุนูุฏ ุชุฏููุฑ ุงููุญุฏุงุช.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Die</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (location) { location.DecreaseVisibility(); } location.Unit = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; Destroy(gameObject); }</code> </pre> <br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุทุงู ุงูุฑุคูุฉ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุญุชู ุงูุขู ุ ูุฑู ููุท ุงูุฎููุฉ ุงูุชู ุชูุน ูููุง ููุฑุฒุฉ ุ ููุฐุง ูุญุฏ ูู ุงูุงุญุชูุงูุงุช. ุนูู ุงูุฃูู ูุญุชุงุฌ ูุฑุคูุฉ ุงูุฎูุงูุง ุงููุฌุงูุฑุฉ. ูู ุงูุญุงูุฉ ุงูุนุงูุฉ ุ ูููู ูููุญุฏุงุช ุฑุคูุฉ ุฌููุน ุงูุฎูุงูุง ุถูู ูุณุงูุฉ ูุนููุฉ ุ ูุงูุชู ุชุนุชูุฏ ุนูู ุงููุญุฏุฉ. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฏุนูุง ูุถูู ุฅูู </font></font><code>HexGrid</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุทุฑููุฉ ููุนุซูุฑ ุนูู ุฌููุน ุงูุฎูุงูุง ุงููุฑุฆูุฉ ูู ุฎููุฉ ูุงุญุฏุฉ ูุน ูุฑุงุนุงุฉ ุงููุทุงู. ูููููุง ุฅูุดุงุก ูุฐู ุงูุทุฑููุฉ ุนู ุทุฑูู ุงูุชูุฑุงุฑ ูุงูุชุบููุฑ </font></font><code>Search</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. ูู ุจุชุบููุฑ ูุนููุงุชู ูุงุฌุนูู ูุนูุฏ ูุงุฆูุฉ ุจุงูุฎูุงูุง ุงูุชู ููููู ุงุณุชุฎุฏุงู ุชุฌูุน ุงูููุงุฆู ููุง. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุนูุฏ ูู ุชูุฑุงุฑ ุ ุชุชู ุฅุถุงูุฉ ุงูุฎููุฉ ุงูุญุงููุฉ ุฅูู ุงููุงุฆูุฉ. ูู ุชุนุฏ ููุงู ุฃู ุฎููุฉ ููุงุฆูุฉ ุ ูุฐูู ูู ููุชูู ุงูุจุญุซ ุฃุจุฏูุง ุนูุฏูุง ูุตู ุฅูู ูุฐู ุงูููุทุฉ. ูุชุฎูุต ุฃูุถูุง ูู ููุทู ุงูุชุญุฑูุงุช ูุชูููุฉ ุงูุงูุชูุงู. ุฌุนู ุงูุฎุตุงุฆุต</font></font><code>PathFrom</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ุชุนุฏ ุชูุณุฃู ูุฃููุง ูุณูุง ุจุญุงุฌุฉ ุฅูููุง ุ ููุง ูุฑูุฏ ุงูุชุฏุฎู ูู ุงููุณุงุฑ ุนูู ุทูู ุงูุดุจูุฉ. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ูู ุฎุทูุฉ ุ ุชุฒูุฏ ุงููุณุงูุฉ ุจุจุณุงุทุฉ ุจููุฏุงุฑ 1. ุฅุฐุง ุชุฌุงูุฒุช ุงููุทุงู ุ ูุชู ุชุฎุทู ูุฐู ุงูุฎููุฉ. </font><font style="vertical-align: inherit;">ููุณูุง ุจุญุงุฌุฉ ุฅูู ุงูุจุญุซ ุนู ูุฌุฑูุงุช ุงูุจุญุซ ุ ูุฐูู ูููู ุจุชููุฆุชู ุจูููุฉ 0. ุฃู ุ ูู ุงูุฌููุฑ ุ ุนุฏูุง ุฅูู ุฎูุงุฑุฒููุฉ Dijkstra.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-function">List&lt;HexCell&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetVisibleCells</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">HexCell fromCell, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> range</span></span></span><span class="hljs-function">)</span></span> { List&lt;HexCell&gt; visibleCells = ListPool&lt;HexCell&gt;.Get(); searchFrontierPhase += <span class="hljs-number"><span class="hljs-number">2</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (searchFrontier == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { searchFrontier = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HexCellPriorityQueue(); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { searchFrontier.Clear(); } fromCell.SearchPhase = searchFrontierPhase; fromCell.Distance = <span class="hljs-number"><span class="hljs-number">0</span></span>; searchFrontier.Enqueue(fromCell); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (searchFrontier.Count &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { HexCell current = searchFrontier.Dequeue(); current.SearchPhase += <span class="hljs-number"><span class="hljs-number">1</span></span>; visibleCells.Add(current); <span class="hljs-comment"><span class="hljs-comment">// if (current == toCell) { // return true; // } // int currentTurn = (current.Distance - 1) / speed; for (HexDirection d = HexDirection.NE; d &lt;= HexDirection.NW; d++) { HexCell neighbor = current.GetNeighbor(d); if ( neighbor == null || neighbor.SearchPhase &gt; searchFrontierPhase ) { continue; } // โฆ // int moveCost; // โฆ int distance = current.Distance + 1; if (distance &gt; range) { continue; } // int turn = (distance - 1) / speed; // if (turn &gt; currentTurn) { // distance = turn * speed + moveCost; // } if (neighbor.SearchPhase &lt; searchFrontierPhase) { neighbor.SearchPhase = searchFrontierPhase; neighbor.Distance = distance; // neighbor.PathFrom = current; neighbor.SearchHeuristic = 0; searchFrontier.Enqueue(neighbor); } else if (distance &lt; neighbor.Distance) { int oldPriority = neighbor.SearchPriority; neighbor.Distance = distance; // neighbor.PathFrom = current; searchFrontier.Change(neighbor, oldPriority); } } } return visibleCells; }</span></span></code> </pre> <br><div class="spoiler" style=";text-align:right;direction:rtl"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃูุง ูููููุง ุงุณุชุฎุฏุงู ุฎูุงุฑุฒููุฉ ุฃุจุณุท ููุนุซูุฑ ุนูู ุฌููุน ุงูุฎูุงูุง ุฏุงุฎู ุงููุทุงูุ</font></font></b> <div class="spoiler_text" style=";text-align:right;direction:rtl"> ,          ,      . </div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃุถู ุฃูุถุง </font></font><code>HexGrid</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุฃุณุงููุจ </font></font><code>IncreaseVisibility</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ู </font></font><code>DecreaseVisibility</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ูุญุตููู ุนูู ุงูุฎููุฉ ูุงููุทุงู ุ ููุฃุฎุฐูู ูุงุฆูุฉ ุจุงูุฎูุงูุง ุงูููุงุจูุฉ ููุฒูุฏูู / ูููููู ูู ุฑุคูุชูู. </font><font style="vertical-align: inherit;">ุนูุฏ ุงูุงูุชูุงุก ุ ูุฌุจ ุนูููู ุฅุนุงุฏุฉ ุงููุงุฆูุฉ ุฅูู ูุฌููุนุชูุง.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">IncreaseVisibility</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">HexCell fromCell, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> range</span></span></span><span class="hljs-function">)</span></span> { List&lt;HexCell&gt; cells = GetVisibleCells(fromCell, range); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; cells.Count; i++) { cells[i].IncreaseVisibility(); } ListPool&lt;HexCell&gt;.Add(cells); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">DecreaseVisibility</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">HexCell fromCell, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> range</span></span></span><span class="hljs-function">)</span></span> { List&lt;HexCell&gt; cells = GetVisibleCells(fromCell, range); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; cells.Count; i++) { cells[i].DecreaseVisibility(); } ListPool&lt;HexCell&gt;.Add(cells); }</code> </pre> <br><font style="vertical-align: inherit;"></font><code>HexUnit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุชุทูุจ </font><font style="vertical-align: inherit;">ุงุณุชุฎุฏุงู ูุฐู ุงูุทุฑู </font><font style="vertical-align: inherit;">ุงููุตูู ุฅูู ุงูุดุจูุฉ ุ ูุฐุง ุฃุถู ุฎุงุตูุฉ ุฅูููุง </font></font><code>Grid</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> HexGrid Grid { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุนูุฏ ุฅุถุงูุฉ ูุฑูุฉ ุฅูู ุดุจูุฉ ุ ุณูุชู ุชุนููู ุดุจูุฉ ููุฐู ุงูุฎุงุตูุฉ </font></font><code>HexGrid.AddUnit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AddUnit</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">HexUnit unit, HexCell location, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> orientation</span></span></span><span class="hljs-function">)</span></span> { units.Add(unit); unit.Grid = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; unit.transform.SetParent(transform, <span class="hljs-literal"><span class="hljs-literal">false</span></span>); unit.Location = location; unit.Orientation = orientation; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุงุฏุฆ ุฐู ุจุฏุก ุ ูุฅู ูุฏู ุฑุคูุฉ ุซูุงุซ ุฎูุงูุง ุณูููู ูุงูููุง. </font><font style="vertical-align: inherit;">ููููุงู ุจุฐูู ุ ูุถูู ุฅูู </font></font><code>HexUnit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุซุงุจุช ุ ูุงูุฐู ูููู ุฃู ูุชุญูู ุฏุงุฆููุง ูู ุงููุณุชูุจู ุฅูู ูุชุบูุฑ. </font><font style="vertical-align: inherit;">ุซู ุงูููุงู ุจุฐูู ุฅูู ุงููุตุงู ุชุณุจุจุช ูุดุจูุฉ ุชูููุงุช </font></font><code>IncreaseVisibility</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ู </font></font><code>DecreaseVisibility</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ ูููุฑ ููุง ูุถูุญูุ ูู ูุฌุชุฒ ููุท ูู ูุฐุง ุงูููุงู.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> visionRange = <span class="hljs-number"><span class="hljs-number">3</span></span>; โฆ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> HexCell Location { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> location; } <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (location) { <span class="hljs-comment"><span class="hljs-comment">// location.DecreaseVisibility(); Grid.DecreaseVisibility(location, visionRange); location.Unit = null; } location = value; value.Unit = this; // value.IncreaseVisibility(); Grid.IncreaseVisibility(value, visionRange); transform.localPosition = value.Position; } } โฆ public void Die () { if (location) { // location.DecreaseVisibility(); Grid.DecreaseVisibility(location, visionRange); } location.Unit = null; Destroy(gameObject); }</span></span></code> </pre> <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/8cd/c45/ccb/8cdc45ccb01449b3c7d50a7bef9b249c.png"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงููุญุฏุงุช ุฐุงุช ูุทุงู ุงูุฑุคูุฉ ุงูุชู ูููู ุฃู ุชุชุฏุงุฎู.</font></font></i> <br><br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงูุฑุคูุฉ ุนูุฏ ุงูุญุฑูุฉ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ุงูููุช ุงูุญุงูู ุ ูุชู ููู ููุทูุฉ ุฑุคูุฉ ุงููุฑูู ุจุนุฏ ุฃูุฑ ุงูููู ููุฑูุง ุฅูู ููุทุฉ ุงูููุงูุฉ. </font><font style="vertical-align: inherit;">ูุงู ุณูุจุฏู ุฃูุถู ุฅุฐุง ุชุญุฑูุช ุงููุญุฏุฉ ููุฌุงู ุงูุฑุคูุฉ ูุนูุง. </font><font style="vertical-align: inherit;">ุงูุฎุทูุฉ ุงูุฃููู ูู ุฃููุง ูู ูุนุฏ ุฎุงุตูุฉ </font></font><code>Location</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c </font></font><code>HexUnit.Travel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ุจุฏูุงู ูู ุฐูู ุ ุณูููู ุจุชุบููุฑ ุงูุญูู ูุจุงุดุฑุฉ </font></font><code>location</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ ูุชุฌูุจ ุฑูุฒ ุงูููููุฉ. </font><font style="vertical-align: inherit;">ูุฐูู ุ ุณูููู ุจูุณุญ ุงููููุน ุงููุฏูู ูุฏูููุง ูุชูููู ูููุน ุฌุฏูุฏ. </font><font style="vertical-align: inherit;">ุณุชุจูู ุงูุฑุคูุฉ ุฏูู ุชุบููุฑ.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Travel</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">List&lt;HexCell&gt; path</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-comment"><span class="hljs-comment">// Location = path[path.Count - 1]; location.Unit = null; location = path[path.Count - 1]; location.Unit = this; pathToTravel = path; StopAllCoroutines(); StartCoroutine(TravelPath()); }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฏุงุฎู ุงูููุฑููุงุช ุ ุณูููู </font></font><code>TravelPath</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ุฑุคูุฉ ุงูุฎููุฉ ุงูุฃููู ููุท ุจุนุฏ ุงูุงูุชูุงุก </font></font><code>LookAt</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ุจุนุฏ ุฐูู ุ ูุจู ุงูุงูุชูุงู ุฅูู ุฎููุฉ ุฌุฏูุฏุฉ ุ ุณูุฒูุฏ ุงูุฑุคูุฉ ูู ูุฐู ุงูุฎููุฉ. </font><font style="vertical-align: inherit;">ุจุนุฏ ุงูุงูุชูุงุก ูู ูุฐุง ุ ููููุง ูู ุธููุฑู ูุฑุฉ ุฃุฎุฑู. </font><font style="vertical-align: inherit;">ุฃุฎูุฑูุง ุ ูู ุจุฒูุงุฏุฉ ุงูุฑุคูุฉ ูู ุงูุฎููุฉ ุงูุฃุฎูุฑุฉ.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-function">IEnumerator </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TravelPath</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { Vector3 a, b, c = pathToTravel[<span class="hljs-number"><span class="hljs-number">0</span></span>].Position; <span class="hljs-comment"><span class="hljs-comment">// transform.localPosition = c; yield return LookAt(pathToTravel[1].Position); Grid.DecreaseVisibility(pathToTravel[0], visionRange); float t = Time.deltaTime * travelSpeed; for (int i = 1; i &lt; pathToTravel.Count; i++) { a = c; b = pathToTravel[i - 1].Position; c = (b + pathToTravel[i].Position) * 0.5f; Grid.IncreaseVisibility(pathToTravel[i], visionRange); for (; t &lt; 1f; t += Time.deltaTime * travelSpeed) { โฆ } Grid.DecreaseVisibility(pathToTravel[i], visionRange); t -= 1f; } a = c; b = location.Position; // We can simply use the destination here. c = b; Grid.IncreaseVisibility(location, visionRange); for (; t &lt; 1f; t += Time.deltaTime * travelSpeed) { โฆ } โฆ }</span></span></code> </pre> <br><iframe width="560" height="315" src="https://www.youtube.com/embed/https://translate" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุฑุคูุฉ ุฃุซูุงุก ุงูุญุฑูุฉ. </font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ูุฐุง ูุนูู ุ ุจุงุณุชุซูุงุก ุนูุฏูุง ูุชู ุฅุตุฏุงุฑ ุฃูุฑ ุฌุฏูุฏ ูู ุงูููุช ุงูุฐู ุชุชุญุฑู ููู ููุฑุฒุฉ. </font><font style="vertical-align: inherit;">ูุฐุง ูุคุฏู ุฅูู ุงูููู ุงูููุฑู ุ ูุงูุฐู ูุฌุจ ุฃู ููุทุจู ุฃูุถูุง ุนูู ุงูุฑุคูุฉ. </font><font style="vertical-align: inherit;">ูุชุญููู ุฐูู ุ ูุญุชุงุฌ ุฅูู ุชุชุจุน ุงููููุน ุงูุญุงูู ูููุฑูู ุฃุซูุงุก ุงูุชุญุฑู.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> HexCell location, currentTravelLocation;</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุณูููู ุจุชุญุฏูุซ ูุฐุง ุงููููุน ูู ูู ูุฑุฉ ูุตู ูููุง ุฅูู ุฎููุฉ ุฌุฏูุฏุฉ ุฃุซูุงุก ุงูุชุญุฑู ุ ุญุชู ุชุตู ุงููุฑูุฉ ุฅูู ุงูุฎููุฉ ุงูุฃุฎูุฑุฉ. </font><font style="vertical-align: inherit;">ุซู ูุฌุจ ุฅุนุงุฏุฉ ุชุนูููู.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-function">IEnumerator </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TravelPath</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { โฆ <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">1</span></span>; i &lt; pathToTravel.Count; i++) { currentTravelLocation = pathToTravel[i]; a = c; b = pathToTravel[i - <span class="hljs-number"><span class="hljs-number">1</span></span>].Position; c = (b + currentTravelLocation.Position) * <span class="hljs-number"><span class="hljs-number">0.5f</span></span>; Grid.IncreaseVisibility(pathToTravel[i], visionRange); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (; t &lt; <span class="hljs-number"><span class="hljs-number">1f</span></span>; t += Time.deltaTime * travelSpeed) { transform.localPosition = Bezier.GetPoint(a, b, c, t); Vector3 d = Bezier.GetDerivative(a, b, c, t); dy = <span class="hljs-number"><span class="hljs-number">0f</span></span>; transform.localRotation = Quaternion.LookRotation(d); <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>; } Grid.DecreaseVisibility(pathToTravel[i], visionRange); t -= <span class="hljs-number"><span class="hljs-number">1f</span></span>; } currentTravelLocation = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; โฆ }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุขู ุจุนุฏ ุฅููุงู ุงูุชุณููู ุ </font></font><code>TravelPath</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูููููุง ุงูุชุญูู ููุง ุฅุฐุง ูุงู ุงููููุน ุงููุณูุท ุงููุฏูู ูููุณุงุฑ ูุนุฑูููุง ุฃู ูุง. </font><font style="vertical-align: inherit;">ุฅุฐุง ูุงูุช ุงูุฅุฌุงุจุฉ ุจูุนู ุ ูุฃูุช ุจุญุงุฌุฉ ุฅูู ุชูููู ุงูุฑุคูุฉ ูู ูุฐู ุงูุฎููุฉ ุ ูููุณ ูู ุจุฏุงูุฉ ุงููุณุงุฑ.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-function">IEnumerator </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TravelPath</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { Vector3 a, b, c = pathToTravel[<span class="hljs-number"><span class="hljs-number">0</span></span>].Position; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">yield</span></span></span><span class="hljs-function"> return </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">LookAt</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">pathToTravel[</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">1</span></span></span></span><span class="hljs-function"><span class="hljs-params">].Position</span></span></span><span class="hljs-function">)</span></span>; Grid.DecreaseVisibility( currentTravelLocation ? currentTravelLocation : pathToTravel[<span class="hljs-number"><span class="hljs-number">0</span></span>], visionRange ); โฆ }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุญุชุงุฌ ุฃูุถูุง ุฅูู ุชุตุญูุญ ุงูุฑุคูุฉ ุจุนุฏ ุฅุนุงุฏุฉ ุงูุชุฌููุน ุงูุชู ุญุฏุซุช ุฃุซูุงุก ุญุฑูุฉ ุงููุฑูุฉ. </font><font style="vertical-align: inherit;">ุฅุฐุง ูุงู ุงููููุน ุงููุณูุท ูุง ูุฒุงู ูุนุฑูููุง ุ ููู ุจุชูููู ุงูุฑุคูุฉ ููู ูุฒูุงุฏุฉ ุงูุฑุคูุฉ ุนูุฏ ููุทุฉ ุงูููุงูุฉ ุ ุซู ูู ุจุฅุนุงุฏุฉ ุชุนููู ุงููููุน ุงููุณูุท.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnEnable</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (location) { transform.localPosition = location.Position; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (currentTravelLocation) { Grid.IncreaseVisibility(location, visionRange); Grid.DecreaseVisibility(currentTravelLocation, visionRange); currentTravelLocation = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; } } }</code> </pre> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุญุฒูุฉ ุงููุญุฏุฉ</font></font></a> <br><br><h2 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุถูุญ ุงูุทุฑู ูุงูููุงู </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุนูู ุงูุฑุบู ูู ุฃู ุชุบูุฑุงุช ุฃููุงู ุงูุฅุบุงุซุฉ ุชุนุชูุฏ ุนูู ุงูุฑุคูุฉ ุ ุฅูุง ุฃู ูุฐุง ูุง ูุคุซุฑ ุนูู ุงูุทุฑู ูุงูููุงู. </font><font style="vertical-align: inherit;">ุชุจุฏู ูุดุฑูุฉ ููุบุงูุฉ ุจุงููุณุจุฉ ููุฎูุงูุง ุบูุฑ ุงููุฑุฆูุฉ. </font><font style="vertical-align: inherit;">ูุชุทุจูู ุงูุฑุคูุฉ ุนูู ุงูุทุฑู ูุงูููุงู ุ ูุญุชุงุฌ ุฅูู ุฅุถุงูุฉ ูุคุดุฑุงุช ุงูุฎูุงูุง ููุฒุฌ ุงูุฃูุฒุงู ุฅูู ุจูุงูุงุช ุงูุดุจูุฉ ุงูุฎุงุตุฉ ุจูุง. </font><font style="vertical-align: inherit;">ูุฐูู ุชุญูู ุงูุนูุงุตุฑ ุงูุชุงุจุนุฉ ูู </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจูุงูุงุช ุงุณุชุฎุฏุงู ุฎููุฉ</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูู </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃููุงุฑ</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุทุฑู</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูููุงู</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุดูุฑ ุงูููุงู</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ู </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุตุจุงุช</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุฌุฒุก ุงูุฌุงูุฒุฉ.</font></font><br><br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงูุทุฑู </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุณูุจุฏุฃ ูู ุงูุทุฑู. </font><font style="vertical-align: inherit;">ุชูุณุชุฎุฏู ุงูุทุฑููุฉ </font></font><code>HexGridChunk.TriangulateRoadEdge</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฅูุดุงุก ุฌุฒุก ุตุบูุฑ ูู ุงูุทุฑูู ูู ููุชุตู ุงูุฎููุฉ ุ ูุฐุง ููู ุชุญุชุงุฌ ุฅูู ููุฑุณ ุฎููุฉ ูุงุญุฏ. </font><font style="vertical-align: inherit;">ุฃุถู ูุนููุฉ ุฅููู ููู ุจุฅูุดุงุก ุจูุงูุงุช ุงูุฎููุฉ ูููุซูุซ.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TriangulateRoadEdge</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> Vector3 center, Vector3 mL, Vector3 mR, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> index </span></span></span><span class="hljs-function">)</span></span> { roads.AddTriangle(center, mL, mR); roads.AddTriangleUV( <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector2(<span class="hljs-number"><span class="hljs-number">1f</span></span>, <span class="hljs-number"><span class="hljs-number">0f</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector2(<span class="hljs-number"><span class="hljs-number">0f</span></span>, <span class="hljs-number"><span class="hljs-number">0f</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector2(<span class="hljs-number"><span class="hljs-number">0f</span></span>, <span class="hljs-number"><span class="hljs-number">0f</span></span>) ); Vector3 indices; indices.x = indices.y = indices.z = index; roads.AddTriangleCellData(indices, weights1); }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุทุฑููุฉ ุฃุฎุฑู ุณููุฉ ูุฅูุดุงุก ุงูุทุฑู </font></font><code>TriangulateRoadSegment</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ูุชู ุงุณุชุฎุฏุงูู ุฏุงุฎู ุงูุฎูุงูุง ููููุง ุจูููุง ุ ูุฐูู ูุฌุจ ุฃู ูุนูู ูุน ููุฑุณูู ูุฎุชูููู. </font><font style="vertical-align: inherit;">ููุฐุง ุ ูู ุงูููุงุฆู ุงุณุชุฎุฏุงู ูุนููุฉ ูุชุฌู ุงูููุฑุณ. </font><font style="vertical-align: inherit;">ูุธุฑูุง ูุฃู ุฃุฌุฒุงุก ุงูุทุฑูู ูููู ุฃู ุชููู ุฃุฌุฒุงุก ูู ุงูุญูุงู ุ ูุฌุจ ุฃูุถูุง ุชูุฑูุฑ ุงูุฃูุฒุงู ูู ุฎูุงู ุงููุนููุงุช.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TriangulateRoadSegment</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> Vector3 v1, Vector3 v2, Vector3 v3, Vector3 v4, Vector3 v5, Vector3 v6, Color w1, Color w2, Vector3 indices </span></span></span><span class="hljs-function">)</span></span> { roads.AddQuad(v1, v2, v4, v5); roads.AddQuad(v2, v3, v5, v6); roads.AddQuadUV(<span class="hljs-number"><span class="hljs-number">0f</span></span>, <span class="hljs-number"><span class="hljs-number">1f</span></span>, <span class="hljs-number"><span class="hljs-number">0f</span></span>, <span class="hljs-number"><span class="hljs-number">0f</span></span>); roads.AddQuadUV(<span class="hljs-number"><span class="hljs-number">1f</span></span>, <span class="hljs-number"><span class="hljs-number">0f</span></span>, <span class="hljs-number"><span class="hljs-number">0f</span></span>, <span class="hljs-number"><span class="hljs-number">0f</span></span>); roads.AddQuadCellData(indices, w1, w2); roads.AddQuadCellData(indices, w1, w2); }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุขู ุฏุนูุง ููุชูู ุฅูู </font></font><code>TriangulateRoad</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุฃูุฑ ุงูุฐู ูุฎูู ุงูุทุฑู ุฏุงุฎู ุงูุฎูุงูุง. </font><font style="vertical-align: inherit;">ูุญุชุงุฌ ุฃูุถุง ุฅูู ูุนููุฉ ููุฑุณ. </font><font style="vertical-align: inherit;">ููุฑุฑ ูุฐู ุงูุจูุงูุงุช ุฅูู ุทุฑู ุงูุทุฑูู ุงูุชู ูุณูููุง ุ ููุถูููุง ุฅูู ุงููุซูุซุงุช ุงูุชู ููุดุฆูุง.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TriangulateRoad</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> Vector3 center, Vector3 mL, Vector3 mR, EdgeVertices e, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> hasRoadThroughCellEdge, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> index </span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (hasRoadThroughCellEdge) { Vector3 indices; indices.x = indices.y = indices.z = index; Vector3 mC = Vector3.Lerp(mL, mR, <span class="hljs-number"><span class="hljs-number">0.5f</span></span>); TriangulateRoadSegment( mL, mC, mR, e.v2, e.v3, e.v4, weights1, weights1, indices ); roads.AddTriangle(center, mL, mC); roads.AddTriangle(center, mC, mR); roads.AddTriangleUV( <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector2(<span class="hljs-number"><span class="hljs-number">1f</span></span>, <span class="hljs-number"><span class="hljs-number">0f</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector2(<span class="hljs-number"><span class="hljs-number">0f</span></span>, <span class="hljs-number"><span class="hljs-number">0f</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector2(<span class="hljs-number"><span class="hljs-number">1f</span></span>, <span class="hljs-number"><span class="hljs-number">0f</span></span>) ); roads.AddTriangleUV( <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector2(<span class="hljs-number"><span class="hljs-number">1f</span></span>, <span class="hljs-number"><span class="hljs-number">0f</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector2(<span class="hljs-number"><span class="hljs-number">1f</span></span>, <span class="hljs-number"><span class="hljs-number">0f</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector2(<span class="hljs-number"><span class="hljs-number">0f</span></span>, <span class="hljs-number"><span class="hljs-number">0f</span></span>) ); roads.AddTriangleCellData(indices, weights1); roads.AddTriangleCellData(indices, weights1); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { TriangulateRoadEdge(center, mL, mR, index); } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจูู ุฃู ุฃุถูู ุงูุญุฌุฌ ุทุฑููุฉ ุงููุทููุจุฉ </font></font><code>TriangulateRoad</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ </font></font><code>TriangulateRoadEdge</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ู </font></font><code>TriangulateRoadSegment</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุชุตุญูุญ ูุงูุฉ ุงูุฃุฎุทุงุก ูุชุฑุฌู.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TriangulateWithoutRiver</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> HexDirection direction, HexCell cell, Vector3 center, EdgeVertices e </span></span></span><span class="hljs-function">)</span></span> { TriangulateEdgeFan(center, e, cell.Index); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (cell.HasRoads) { Vector2 interpolators = GetRoadInterpolators(direction, cell); TriangulateRoad( center, Vector3.Lerp(center, e.v1, interpolators.x), Vector3.Lerp(center, e.v5, interpolators.y), e, cell.HasRoadThroughEdge(direction), cell.Index ); } } โฆ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TriangulateRoadAdjacentToRiver</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> HexDirection direction, HexCell cell, Vector3 center, EdgeVertices e </span></span></span><span class="hljs-function">)</span></span> { โฆ TriangulateRoad(roadCenter, mL, mR, e, hasRoadThroughEdge, cell.Index); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (previousHasRiver) { TriangulateRoadEdge(roadCenter, center, mL, cell.Index); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (nextHasRiver) { TriangulateRoadEdge(roadCenter, mR, center, cell.Index); } } โฆ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TriangulateEdgeStrip</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> โฆ </span></span></span><span class="hljs-function">)</span></span> { โฆ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (hasRoad) { TriangulateRoadSegment( e1.v2, e1.v3, e1.v4, e2.v2, e2.v3, e2.v4, w1, w2, indices ); } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุขู ุจูุงูุงุช ุงูุดุจูุฉ ุตุญูุญุฉ ุ ูุณููุชูู ุฅูู ุชุธููู </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุทุฑูู</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">ูุญุชุงุฌ ุจุฑูุงูุฌ vertex ููุฌุจ ุฃู ูุญุชูู ุนูู </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HexCellData</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs css"> <span class="hljs-selector-id"><span class="hljs-selector-id">#pragma</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">surface</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">surf</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Standard</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">fullforwardshadows</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">decal</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:blend</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">vertex</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:vert</span></span> <span class="hljs-selector-id"><span class="hljs-selector-id">#pragma</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">target</span></span> 3<span class="hljs-selector-class"><span class="hljs-selector-class">.0</span></span> <span class="hljs-selector-id"><span class="hljs-selector-id">#include</span></span> "<span class="hljs-selector-tag"><span class="hljs-selector-tag">HexCellData</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.cginc</span></span>"</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุธุฑูุง ูุฃููุง ูุง ููุฒุฌ ุงูุนุฏูุฏ ูู ุงูููุงุฏ ุ ูุณูููู ูุงููุงู ุจุงููุณุจุฉ ููุง ูุชูุฑูุฑ ูุคุดุฑ ูุงุญุฏ ููุฑุคูุฉ ุฅูู ุจุฑูุงูุฌ ุงูุฌุฒุก. </font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs cpp"> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Input</span></span></span><span class="hljs-class"> {</span></span> float2 uv_MainTex; float3 worldPos; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> visibility; };</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูููู ุฃู ูููู ุจุฑูุงูุฌ ุงูููุฉ ุงูุฌุฏูุฏ ุจุงุณุชูุจุงู ุงูุจูุงูุงุช ูู ุฎููุชูู. </font><font style="vertical-align: inherit;">ููุฒุฌ ุนูู ุงูููุฑ ุฑุคูุชูู ุ ููุนุฏููุง ููุถูููุง ุฅูู ุงููุฎุฑุฌุงุช.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs pgsql"> <span class="hljs-type"><span class="hljs-type">void</span></span> vert (<span class="hljs-keyword"><span class="hljs-keyword">inout</span></span> appdata_full v, <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Input</span></span> data) { UNITY_INITIALIZE_OUTPUT(<span class="hljs-keyword"><span class="hljs-keyword">Input</span></span>, data); <span class="hljs-type"><span class="hljs-type">float4</span></span> cell0 = GetCellData(v, <span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-type"><span class="hljs-type">float4</span></span> cell1 = GetCellData(v, <span class="hljs-number"><span class="hljs-number">1</span></span>); data.visibility = cell0.x * v.color.x + cell1.x * v.color.y; data.visibility = lerp(<span class="hljs-number"><span class="hljs-number">0.25</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, data.visibility); }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูู ุจุฑูุงูุฌ ุงูุฌุฒุก ุ ูุญุชุงุฌ ููุท ุฅูู ุฅุถุงูุฉ ุฑุคูุฉ ูููู. </font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs pgsql"> <span class="hljs-type"><span class="hljs-type">void</span></span> surf (<span class="hljs-keyword"><span class="hljs-keyword">Input</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">inout</span></span> SurfaceOutputStandard o) { <span class="hljs-type"><span class="hljs-type">float4</span></span> noise = tex2D(_MainTex, <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span>.worldPos.xz * <span class="hljs-number"><span class="hljs-number">0.025</span></span>); fixed4 c = _Color * ((noise.y * <span class="hljs-number"><span class="hljs-number">0.75</span></span> + <span class="hljs-number"><span class="hljs-number">0.25</span></span>) * <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span>.visibility); โฆ }</code> </pre> <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/af8/92f/46e/af892f46e364906cc547aaecb4e50e3a.png"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุทุฑู ุฐุงุช ุงูุฑุคูุฉ.</font></font></i> <br><br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงูููุงู ุงูููุชูุญุฉ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฏ ูุจุฏู ุฃู ุงูุฑุคูุฉ ูุฏ ุฃุซุฑุช ุจุงููุนู ุนูู ุงูููุงู ุ ูููู ูุฐุง ูู ูุฌุฑุฏ ุณุทุญ ุชุถุงุฑูุณ ูุบููุฑุฉ ูู ุงููุงุก. </font><font style="vertical-align: inherit;">ููุจุฏุฃ ุจุชุทุจูู ุงูุฑุคูุฉ ุนูู ุงูููุงู ุงูููุชูุญุฉ. </font><font style="vertical-align: inherit;">ููุฐุง ูุญู ุจุญุงุฌุฉ ุฅูู ุงูุชุบููุฑ </font></font><code>HexGridChunk.TriangulateOpenWater</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TriangulateOpenWater</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> HexDirection direction, HexCell cell, HexCell neighbor, Vector3 center </span></span></span><span class="hljs-function">)</span></span> { โฆ water.AddTriangle(center, c1, c2); Vector3 indices; indices.x = indices.y = indices.z = cell.Index; water.AddTriangleCellData(indices, weights1); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (direction &lt;= HexDirection.SE &amp;&amp; neighbor != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { โฆ water.AddQuad(c1, c2, e1, e2); indices.y = neighbor.Index; water.AddQuadCellData(indices, weights1, weights2); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (direction &lt;= HexDirection.E) { โฆ water.AddTriangle( c2, e2, c2 + HexMetrics.GetWaterBridge(direction.Next()) ); indices.z = nextNeighbor.Index; water.AddTriangleCellData( indices, weights1, weights2, weights3 ); } } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุญุชุงุฌ ุฃูุถูุง ุฅูู ุฅุถุงูุฉ ุจูุงูุงุช ุงูุฎููุฉ ุฅูู ูุฑุงูุญ ุงููุซูุซุงุช ุจุงููุฑุจ ูู ุงูุณูุงุญู. </font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TriangulateWaterShore</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> HexDirection direction, HexCell cell, HexCell neighbor, Vector3 center </span></span></span><span class="hljs-function">)</span></span> { โฆ water.AddTriangle(center, e1.v1, e1.v2); water.AddTriangle(center, e1.v2, e1.v3); water.AddTriangle(center, e1.v3, e1.v4); water.AddTriangle(center, e1.v4, e1.v5); Vector3 indices; indices.x = indices.y = indices.z = cell.Index; water.AddTriangleCellData(indices, weights1); water.AddTriangleCellData(indices, weights1); water.AddTriangleCellData(indices, weights1); water.AddTriangleCellData(indices, weights1); โฆ }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฌุจ ุชุบููุฑ </font><font style="vertical-align: inherit;">Shader </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Water</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุจููุณ ุงูุทุฑููุฉ ูุซู Shader </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Road</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ ููููู ูุญุชุงุฌ ุฅูู ุงูุฌูุน ุจูู ุฑุคูุฉ ููุณ ุฎููุชูู ุ ูููู ุซูุงุซ ุฎูุงูุง.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs pgsql"> #pragma surface surf Standard alpha vertex:vert #pragma target <span class="hljs-number"><span class="hljs-number">3.0</span></span> #<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> "Water.cginc" #<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> "HexCellData.cginc" sampler2D _MainTex; struct <span class="hljs-keyword"><span class="hljs-keyword">Input</span></span> { float2 uv_MainTex; float3 worldPos; <span class="hljs-type"><span class="hljs-type">float</span></span> visibility; }; โฆ <span class="hljs-type"><span class="hljs-type">void</span></span> vert (<span class="hljs-keyword"><span class="hljs-keyword">inout</span></span> appdata_full v, <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Input</span></span> data) { UNITY_INITIALIZE_OUTPUT(<span class="hljs-keyword"><span class="hljs-keyword">Input</span></span>, data); <span class="hljs-type"><span class="hljs-type">float4</span></span> cell0 = GetCellData(v, <span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-type"><span class="hljs-type">float4</span></span> cell1 = GetCellData(v, <span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-type"><span class="hljs-type">float4</span></span> cell2 = GetCellData(v, <span class="hljs-number"><span class="hljs-number">2</span></span>); data.visibility = cell0.x * v.color.x + cell1.x * v.color.y + cell2.x * v.color.z; data.visibility = lerp(<span class="hljs-number"><span class="hljs-number">0.25</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, data.visibility); } <span class="hljs-type"><span class="hljs-type">void</span></span> surf (<span class="hljs-keyword"><span class="hljs-keyword">Input</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">inout</span></span> SurfaceOutputStandard o) { <span class="hljs-type"><span class="hljs-type">float</span></span> waves = Waves(<span class="hljs-keyword"><span class="hljs-keyword">IN</span></span>.worldPos.xz, _MainTex); fixed4 c = saturate(_Color + waves); o.Albedo = c.rgb * <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span>.visibility; โฆ }</code> </pre> <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/6a4/c52/36c/6a4c5236c52eaae78cbde54fb2fdeeac.png"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูููุงู ุงูููุชูุญุฉ ูุน ุงูุฑุคูุฉ.</font></font></i> <br><br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงูุณุงุญู ูุงููุตุจ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฏุนู ุงูุณุงุญู ุ ูุญุชุงุฌ ุฅูู ุงูุชุบููุฑ ูุฑุฉ ุฃุฎุฑู </font></font><code>HexGridChunk.TriangulateWaterShore</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ููุฏ ุฃูุดุฃูุง ุจุงููุนู ูุชุฌููุง ููุฑุณูุง ุ ููููุง ุงุณุชุฎุฏููุง ููุฑุณ ุฎููุฉ ูุงุญุฏ ููุท ููููุงู ุงูููุชูุญุฉ. </font><font style="vertical-align: inherit;">ูุญุชุงุฌ ุงูุณุงุญู ุฃูุถูุง ุฅูู ููุฑุณ ุงูุฌูุงุฑ ุ ูุฐุง ูู ุจุชุบููุฑ ุงูุฑูุฒ.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> Vector3 indices; <span class="hljs-comment"><span class="hljs-comment">// indices.x = indices.y = indices.z = cell.Index; indices.x = indices.z = cell.Index; indices.y = neighbor.Index;</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅุถุงูุฉ ุจูุงูุงุช ุงูุฎููุฉ ุฅูู ุงูููุงุฏ ููุซูุซ ุงูุณุงุญู. </font><font style="vertical-align: inherit;">ูููู ุจุชูุฑูุฑ ุงูููุงุฑุณ ุนูู ุงูููุงููุฉ </font></font><code>TriangulateEstuary</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (cell.HasRiverThroughEdge(direction)) { TriangulateEstuary( e1, e2, cell.IncomingRiver == direction, indices ); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { โฆ waterShore.AddQuadUV(<span class="hljs-number"><span class="hljs-number">0f</span></span>, <span class="hljs-number"><span class="hljs-number">0f</span></span>, <span class="hljs-number"><span class="hljs-number">0f</span></span>, <span class="hljs-number"><span class="hljs-number">1f</span></span>); waterShore.AddQuadCellData(indices, weights1, weights2); waterShore.AddQuadCellData(indices, weights1, weights2); waterShore.AddQuadCellData(indices, weights1, weights2); waterShore.AddQuadCellData(indices, weights1, weights2); } HexCell nextNeighbor = cell.GetNeighbor(direction.Next()); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (nextNeighbor != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { โฆ waterShore.AddTriangleUV( โฆ ); indices.z = nextNeighbor.Index; waterShore.AddTriangleCellData( indices, weights1, weights2, weights3 ); }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅุถุงูุฉ ุงููุนููุฉ ุงููุงุฒูุฉ </font></font><code>TriangulateEstuary</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุงูุนูุงูุฉ ุจูุฐู ุงูุฎูุงูุง ููุณูุงุญู ูุงููู. </font><font style="vertical-align: inherit;">ูุง ุชูุณ ุฃู ุงููู ูุตููุน ูู ุดุจู ููุญุฑู ูุน ูุซูุซูู ูู ุงูุณุงุญู ุนูู ุงูุฌุงูุจูู. </font><font style="vertical-align: inherit;">ูุชุฃูุฏ ูู ููู ุงูุฃูุฒุงู ุจุงูุชุฑุชูุจ ุงูุตุญูุญ.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TriangulateEstuary</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> EdgeVertices e1, EdgeVertices e2, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> incomingRiver, Vector3 indices </span></span></span><span class="hljs-function">)</span></span> { waterShore.AddTriangle(e2.v1, e1.v2, e1.v1); waterShore.AddTriangle(e2.v5, e1.v5, e1.v4); waterShore.AddTriangleUV( <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector2(<span class="hljs-number"><span class="hljs-number">0f</span></span>, <span class="hljs-number"><span class="hljs-number">1f</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector2(<span class="hljs-number"><span class="hljs-number">0f</span></span>, <span class="hljs-number"><span class="hljs-number">0f</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector2(<span class="hljs-number"><span class="hljs-number">0f</span></span>, <span class="hljs-number"><span class="hljs-number">0f</span></span>) ); waterShore.AddTriangleUV( <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector2(<span class="hljs-number"><span class="hljs-number">0f</span></span>, <span class="hljs-number"><span class="hljs-number">1f</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector2(<span class="hljs-number"><span class="hljs-number">0f</span></span>, <span class="hljs-number"><span class="hljs-number">0f</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector2(<span class="hljs-number"><span class="hljs-number">0f</span></span>, <span class="hljs-number"><span class="hljs-number">0f</span></span>) ); waterShore.AddTriangleCellData(indices, weights2, weights1, weights1); waterShore.AddTriangleCellData(indices, weights2, weights1, weights1); estuaries.AddQuad(e2.v1, e1.v2, e2.v2, e1.v3); estuaries.AddTriangle(e1.v3, e2.v2, e2.v4); estuaries.AddQuad(e1.v3, e1.v4, e2.v4, e2.v5); estuaries.AddQuadUV( <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector2(<span class="hljs-number"><span class="hljs-number">0f</span></span>, <span class="hljs-number"><span class="hljs-number">1f</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector2(<span class="hljs-number"><span class="hljs-number">0f</span></span>, <span class="hljs-number"><span class="hljs-number">0f</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector2(<span class="hljs-number"><span class="hljs-number">1f</span></span>, <span class="hljs-number"><span class="hljs-number">1f</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector2(<span class="hljs-number"><span class="hljs-number">0f</span></span>, <span class="hljs-number"><span class="hljs-number">0f</span></span>) ); estuaries.AddTriangleUV( <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector2(<span class="hljs-number"><span class="hljs-number">0f</span></span>, <span class="hljs-number"><span class="hljs-number">0f</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector2(<span class="hljs-number"><span class="hljs-number">1f</span></span>, <span class="hljs-number"><span class="hljs-number">1f</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector2(<span class="hljs-number"><span class="hljs-number">1f</span></span>, <span class="hljs-number"><span class="hljs-number">1f</span></span>) ); estuaries.AddQuadUV( <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector2(<span class="hljs-number"><span class="hljs-number">0f</span></span>, <span class="hljs-number"><span class="hljs-number">0f</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector2(<span class="hljs-number"><span class="hljs-number">0f</span></span>, <span class="hljs-number"><span class="hljs-number">0f</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector2(<span class="hljs-number"><span class="hljs-number">1f</span></span>, <span class="hljs-number"><span class="hljs-number">1f</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector2(<span class="hljs-number"><span class="hljs-number">0f</span></span>, <span class="hljs-number"><span class="hljs-number">1f</span></span>) ); estuaries.AddQuadCellData( indices, weights2, weights1, weights2, weights1 ); estuaries.AddTriangleCellData(indices, weights1, weights2, weights2); estuaries.AddQuadCellData(indices, weights1, weights2); โฆ }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ุชุธููู </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WaterShore</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ </font><font style="vertical-align: inherit;">ุชุญุชุงุฌ ุฅูู ุฅุฌุฑุงุก ููุณ ุงูุชุบููุฑุงุช ููุง ูู ุงูุญุงู ูู ุชุธููู </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงููุงุก</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ ูุฎูุท ุฑุคูุฉ ุงูุฎูุงูุง ุงูุซูุงุซ.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs pgsql"> #pragma surface surf Standard alpha vertex:vert #pragma target <span class="hljs-number"><span class="hljs-number">3.0</span></span> #<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> "Water.cginc" #<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> "HexCellData.cginc" sampler2D _MainTex; struct <span class="hljs-keyword"><span class="hljs-keyword">Input</span></span> { float2 uv_MainTex; float3 worldPos; <span class="hljs-type"><span class="hljs-type">float</span></span> visibility; }; โฆ <span class="hljs-type"><span class="hljs-type">void</span></span> vert (<span class="hljs-keyword"><span class="hljs-keyword">inout</span></span> appdata_full v, <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Input</span></span> data) { UNITY_INITIALIZE_OUTPUT(<span class="hljs-keyword"><span class="hljs-keyword">Input</span></span>, data); <span class="hljs-type"><span class="hljs-type">float4</span></span> cell0 = GetCellData(v, <span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-type"><span class="hljs-type">float4</span></span> cell1 = GetCellData(v, <span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-type"><span class="hljs-type">float4</span></span> cell2 = GetCellData(v, <span class="hljs-number"><span class="hljs-number">2</span></span>); data.visibility = cell0.x * v.color.x + cell1.x * v.color.y + cell2.x * v.color.z; data.visibility = lerp(<span class="hljs-number"><span class="hljs-number">0.25</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, data.visibility); } <span class="hljs-type"><span class="hljs-type">void</span></span> surf (<span class="hljs-keyword"><span class="hljs-keyword">Input</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">inout</span></span> SurfaceOutputStandard o) { โฆ fixed4 c = saturate(_Color + max(foam, waves)); o.Albedo = c.rgb * <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span>.visibility; โฆ }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุดุงูุฏุฑ </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุตุจ</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ููุฒุฌ ุงูุฑุคูุฉ ูู ุฎููุชููุ ููุฐูู ุชุธููู </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงููุตู ุงูุทุฑูู ุงูุนุงู</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">ูุฏูู ุจุงููุนู ุจุฑูุงูุฌ ููุฉ ุ ูุฃููุง ูุญุชุงุฌ ุฅููู ูุฅุฑุณุงู ุฅุญุฏุงุซูุงุช ุงูุฃุดุนุฉ ููู ุงูุจููุณุฌูุฉ ููุฃููุงุฑ.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs pgsql"> #<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> "Water.cginc" #<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> "HexCellData.cginc" sampler2D _MainTex; struct <span class="hljs-keyword"><span class="hljs-keyword">Input</span></span> { float2 uv_MainTex; float2 riverUV; float3 worldPos; <span class="hljs-type"><span class="hljs-type">float</span></span> visibility; }; half _Glossiness; half _Metallic; fixed4 _Color; <span class="hljs-type"><span class="hljs-type">void</span></span> vert (<span class="hljs-keyword"><span class="hljs-keyword">inout</span></span> appdata_full v, <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Input</span></span> o) { UNITY_INITIALIZE_OUTPUT(<span class="hljs-keyword"><span class="hljs-keyword">Input</span></span>, o); o.riverUV = v.texcoord1.xy; <span class="hljs-type"><span class="hljs-type">float4</span></span> cell0 = GetCellData(v, <span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-type"><span class="hljs-type">float4</span></span> cell1 = GetCellData(v, <span class="hljs-number"><span class="hljs-number">1</span></span>); o.visibility = cell0.x * v.color.x + cell1.x * v.color.y; o.visibility = lerp(<span class="hljs-number"><span class="hljs-number">0.25</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, o.visibility); } <span class="hljs-type"><span class="hljs-type">void</span></span> surf (<span class="hljs-keyword"><span class="hljs-keyword">Input</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">inout</span></span> SurfaceOutputStandard o) { โฆ fixed4 c = saturate(_Color + water); o.Albedo = c.rgb * <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span>.visibility; โฆ }</code> </pre> <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/88f/829/254/88f829254235a293040ac755d8318bc3.png"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุณุงุญู ูุงููุตุจ ูุน ุงูุฑุคูุฉ.</font></font></i> <br><br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงูุฃููุงุฑ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุขุฎุฑ ููุงุทู ุงูููุงู ููุนูู ูุนูุง ูู ุงูุฃููุงุฑ. </font><font style="vertical-align: inherit;">ุฃุถู </font></font><code>HexGridChunk.TriangulateRiverQuad</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุชุฌู ููุฑุณ </font><font style="vertical-align: inherit;">ุฅูู </font><font style="vertical-align: inherit;">ุงููุนููุฉ ูุฃุถูู ุฅูู ุงูุดุจูุฉ ุญุชู ูุชููู ูู ุงูุญูุงุธ ุนูู ุฑุคูุฉ ุฎููุชูู.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TriangulateRiverQuad</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> Vector3 v1, Vector3 v2, Vector3 v3, Vector3 v4, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> y, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> v, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> reversed, Vector3 indices </span></span></span><span class="hljs-function">)</span></span> { TriangulateRiverQuad(v1, v2, v3, v4, y, y, v, reversed, indices); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TriangulateRiverQuad</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> Vector3 v1, Vector3 v2, Vector3 v3, Vector3 v4, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> y1, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> y2, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> v, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> reversed, Vector3 indices </span></span></span><span class="hljs-function">)</span></span> { โฆ rivers.AddQuadCellData(indices, weights1, weights2); }</code> </pre> <br> <code>TriangulateWithRiverBeginOrEnd</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฎูู ููุงุท ููุงูุฉ ููุฑูุฉ ูุน ุฑุจุงุนู ููุซูุซ ูู ูุณุท ุงูุฎููุฉ. </font><font style="vertical-align: inherit;">ุฃุถู ุจูุงูุงุช ุงูุฎููุฉ ุงููุงุฒูุฉ ูุฐูู.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TriangulateWithRiverBeginOrEnd</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> HexDirection direction, HexCell cell, Vector3 center, EdgeVertices e </span></span></span><span class="hljs-function">)</span></span> { โฆ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!cell.IsUnderwater) { <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> reversed = cell.HasIncomingRiver; Vector3 indices; indices.x = indices.y = indices.z = cell.Index; TriangulateRiverQuad( m.v2, m.v4, e.v2, e.v4, cell.RiverSurfaceY, <span class="hljs-number"><span class="hljs-number">0.6f</span></span>, reversed, indices ); center.y = m.v2.y = m.v4.y = cell.RiverSurfaceY; rivers.AddTriangle(center, m.v2, m.v4); โฆ rivers.AddTriangleCellData(indices, weights1); } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฏููุง ุจุงููุนู ูุคุดุฑุงุช ุงูุฎูุงูุง ูุฐู </font></font><code>TriangulateWithRiver</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ ูุฐูู ูููู ููุท ุจุชูุฑูุฑูุง ุนูู ุงูููุงููุฉ </font></font><code>TriangulateRiverQuad</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TriangulateWithRiver</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> HexDirection direction, HexCell cell, Vector3 center, EdgeVertices e </span></span></span><span class="hljs-function">)</span></span> { โฆ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!cell.IsUnderwater) { <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> reversed = cell.IncomingRiver == direction; TriangulateRiverQuad( centerL, centerR, m.v2, m.v4, cell.RiverSurfaceY, <span class="hljs-number"><span class="hljs-number">0.4f</span></span>, reversed, indices ); TriangulateRiverQuad( m.v2, m.v4, e.v2, e.v4, cell.RiverSurfaceY, <span class="hljs-number"><span class="hljs-number">0.6f</span></span>, reversed, indices ); } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ููุง ูุถูู ุฏุนููุง ููุงุณููุง ููุดูุงูุงุช ุงูุชู ุชุตุจ ูู ุงูููุงู ุงูุนูููุฉ. </font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TriangulateWaterfallInWater</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> Vector3 v1, Vector3 v2, Vector3 v3, Vector3 v4, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> y1, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> y2, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> waterY, Vector3 indices </span></span></span><span class="hljs-function">)</span></span> { โฆ rivers.AddQuadCellData(indices, weights1, weights2); }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฃุฎูุฑูุง ุ ูู ุจุชุบููุฑู </font></font><code>TriangulateConnection</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุญูุซ ููุฑุฑ ุงูููุงุฑุณ ุงููุงุฒูุฉ ูุฃุณุงููุจ ุงูุฃููุงุฑ ูุงูุดูุงูุงุช.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TriangulateConnection</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> HexDirection direction, HexCell cell, EdgeVertices e1 </span></span></span><span class="hljs-function">)</span></span> { โฆ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (hasRiver) { e2.v3.y = neighbor.StreamBedY; Vector3 indices; indices.x = indices.z = cell.Index; indices.y = neighbor.Index; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!cell.IsUnderwater) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!neighbor.IsUnderwater) { TriangulateRiverQuad( e1.v2, e1.v4, e2.v2, e2.v4, cell.RiverSurfaceY, neighbor.RiverSurfaceY, <span class="hljs-number"><span class="hljs-number">0.8f</span></span>, cell.HasIncomingRiver &amp;&amp; cell.IncomingRiver == direction, indices ); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (cell.Elevation &gt; neighbor.WaterLevel) { TriangulateWaterfallInWater( e1.v2, e1.v4, e2.v2, e2.v4, cell.RiverSurfaceY, neighbor.RiverSurfaceY, neighbor.WaterSurfaceY, indices ); } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( !neighbor.IsUnderwater &amp;&amp; neighbor.Elevation &gt; cell.WaterLevel ) { TriangulateWaterfallInWater( e2.v4, e2.v2, e1.v4, e1.v2, neighbor.RiverSurfaceY, cell.RiverSurfaceY, cell.WaterSurfaceY, indices ); } } โฆ }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุญุชุงุฌ </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">River</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Shader </font><font style="vertical-align: inherit;">ุฅูู ุฅุฌุฑุงุก ููุณ ุงูุชุบููุฑุงุช ูุซู Shader </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Road</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs pgsql"> #pragma surface surf Standard alpha vertex:vert #pragma target <span class="hljs-number"><span class="hljs-number">3.0</span></span> #<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> "Water.cginc" #<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> "HexCellData.cginc" sampler2D _MainTex; struct <span class="hljs-keyword"><span class="hljs-keyword">Input</span></span> { float2 uv_MainTex; <span class="hljs-type"><span class="hljs-type">float</span></span> visibility; }; โฆ <span class="hljs-type"><span class="hljs-type">void</span></span> vert (<span class="hljs-keyword"><span class="hljs-keyword">inout</span></span> appdata_full v, <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Input</span></span> data) { UNITY_INITIALIZE_OUTPUT(<span class="hljs-keyword"><span class="hljs-keyword">Input</span></span>, data); <span class="hljs-type"><span class="hljs-type">float4</span></span> cell0 = GetCellData(v, <span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-type"><span class="hljs-type">float4</span></span> cell1 = GetCellData(v, <span class="hljs-number"><span class="hljs-number">1</span></span>); data.visibility = cell0.x * v.color.x + cell1.x * v.color.y; data.visibility = lerp(<span class="hljs-number"><span class="hljs-number">0.25</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, data.visibility); } <span class="hljs-type"><span class="hljs-type">void</span></span> surf (<span class="hljs-keyword"><span class="hljs-keyword">Input</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">inout</span></span> SurfaceOutputStandard o) { <span class="hljs-type"><span class="hljs-type">float</span></span> river = River(<span class="hljs-keyword"><span class="hljs-keyword">IN</span></span>.uv_MainTex, _MainTex); fixed4 c = saturate(_Color + river); o.Albedo = c.rgb * <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span>.visibility; โฆ }</code> </pre> <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/1ef/db6/76a/1efdb676afe28b61b73f317d25158505.png"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุฃููุงุฑ ุจุฑุคูุฉ. </font></font></i> <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุญุฒูุฉ ุงููุญุฏุฉ</font></font></a> <br><br><h2 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงูุฃุดูุงุก ูุงูุฑุคูุฉ </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุนูู ุงูุฑุคูุฉ ุงูุขู ุนูู ูุงูู ุงูุชุถุงุฑูุณ ุงูุชู ุชู ุฅูุดุงุคูุง ุฅุฌุฑุงุฆููุง ุ ููููุง ุญุชู ุงูุขู ูุง ุชุคุซุฑ ุนูู ููุฒุงุช ุงูุชุถุงุฑูุณ. ูุชู ุฅูุดุงุก ุงููุจุงูู ูุงููุฒุงุฑุน ูุงูุฃุดุฌุงุฑ ูู ุงููุจุงูู ุงูุฌุงูุฒุฉ ุ ูููุณ ูู ุงูููุฏุณุฉ ุงูุฅุฌุฑุงุฆูุฉ ุ ูุฐูู ูุง ูููููุง ุฅุถุงูุฉ ูุคุดุฑุงุช ุงูุฎูุงูุง ููุฒุฌ ุงูุฃูุฒุงู ูุน ุฑุคูุณูู. ูุธุฑูุง ูุฃู ูู ูู ูุฐู ุงููุงุฆูุงุช ููุชูู ุฅูู ุฎููุฉ ูุงุญุฏุฉ ููุท ุ ูุญุชุงุฌ ุฅูู ุชุญุฏูุฏ ุงูุฎููุฉ ุงูุชู ุชูุฌุฏ ูููุง. ุฅุฐุง ุงุณุชุทุนูุง ุงูููุงู ุจุฐูู ุ ูุณูู ูุญุตู ุนูู ุจูุงูุงุช ุงูุฎูุงูุง ุงูููุงุจูุฉ ููุทุจู ุงูุฑุคูุฉ.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูููููุง ุจุงููุนู ุชุญููู ููุงูุน XZ ููุนุงูู ุฅูู ูุคุดุฑุงุช ุฎูููุฉ. ุชู ุงุณุชุฎุฏุงู ูุฐุง ุงูุชุญูู ูุชุญุฑูุฑ ุงูุชุถุงุฑูุณ ูุฅุฏุงุฑุฉ ุงููุฑู. ููุน ุฐูู ุ ูุฅู ุงูุฑูุฒ ุงูููุงุจู ุบูุฑ ุจุฏููู. ูุณุชุฎุฏู ุนูููุงุช ุนุฏุฏ ุตุญูุญ ููุชุทูุจ ุงูููุทู ููุนูู ูุน ุงูุญูุงู. ูุฐุง ุบูุฑ ุนููู ุจุงููุณุจุฉ ููุชุธููู ุ ูุฐูู ูููููุง ุฎุจุฒ ุงูุฌุฒุก ุงูุฃูุจุฑ ูู ุงูููุทู ูู ูุณูุฌ ูุงุณุชุฎุฏุงูู. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุญู ูุณุชุฎุฏู ุจุงููุนู ูุณูุฌูุง ุจููุท ุณุฏุงุณู ูุฅุณูุงุท ุงูุดุจูุฉ ููู ุงูุชุถุงุฑูุณ. ูุญุฏุฏ ูุฐุง ุงููุณูุฌ ูุณุงุญุฉ ุงูุฎููุฉ 2 ร 2. ูุฐูู ุ ูููููุง ุจุณูููุฉ ุงูุญุณุงุจ ูู ุฃู ููุทูุฉ ูุญู. ุจุนุฏ ุฐูู ุ ููููู ุชุทุจูู ูุณูุฌ ูุญุชูู ุนูู ุชุนููุถุงุช X ู Z ููุฎูุงูุง ูู ูุฐู ุงูููุทูุฉ ูุงุณุชุฎุฏุงู ูุฐู ุงูุจูุงูุงุช ูุญุณุงุจ ุงูุฎููุฉ ุงูุชู ูุญู ูููุง.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุง ูุณูุฌ ููุงุซู. ูุชู ุชุฎุฒูู ุงูุฅุฒุงุญุฉ X ูู ููุงุชูุง ุงูุญูุฑุงุก ุ ููุชู ุชุฎุฒูู ุงูุฅุฒุงุญุฉ Z ูู ุงูููุงุฉ ุงูุฎุถุฑุงุก. ูุธุฑูุง ูุฃููุง ุชุบุทู ูุณุงุญุฉ ุฎูุงูุง 2 ร 2 ุ ูุญุชุงุฌ ุฅูู ุชุนููุถุงุช ูู 0 ู 2. ูุง ูููู ุชุฎุฒูู ูุฐู ุงูุจูุงูุงุช ูู ููุงุฉ ุงูุฃููุงู ุ ูุฐูู ูุชู ุชูููู ุงูุฅุฒุงุญุงุช ุจููุฏุงุฑ ุงููุตู. ูุญู ูุง ูุญุชุงุฌ ุฅูู ุญูุงู ูุงุถุญุฉ ููุฎูุงูุง ุ ูุฐูู ูููู ูุณูุฌ ุตุบูุฑ.</font></font><br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/795/63c/d3c/79563cd3c22e7aa2ca66e40b5ffe3f7e.png"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุณูุฌ ุฅุญุฏุงุซูุงุช ุงูุดุจูุฉ. </font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃุถู ูุณูุฌ ูููุดุฑูุน. </font><font style="vertical-align: inherit;">ุงุถุจุท </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุถุน ุงูุงูุชูุงู</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุนูู </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุชูุฑุงุฑ</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ ุชูุงููุง ูุซู ูุณูุฌ ุงูุดุจูุฉ ุงูุขุฎุฑ. </font><font style="vertical-align: inherit;">ูุญู ูุง ูุญุชุงุฌ ุฅูู ุฃู ุฎูุท ุ ูุฐูู ูู </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุถุน Blend ุ</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุณูุฎุชุงุฑ </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Point</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">ูู ุฃูุถูุง ุจุฅููุงู </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุถุบุท</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุญุชู ูุง ูุชู ุชุดููู ุงูุจูุงูุงุช. </font><font style="vertical-align: inherit;">ูู ุจุฅููุงู ุชุดุบูู ูุถุน </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sRGB</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุจุญูุซ ูุง ูุชู ุฅุฌุฑุงุก ุชุญูููุงุช ููุณุงุญุฉ ุงูุฃููุงู ุนูุฏ ุงูุนุฑุถ ูู ุงููุถุน ุงูุฎุทู. </font><font style="vertical-align: inherit;">ูุฃุฎูุฑูุง ุ ูุง ูุญุชุงุฌ ุฅูู ููุงุฏ mip.</font></font><br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/866/aa9/de3/866aa9de36f6953f54d4fb8197fb75ff.png"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฎูุงุฑุงุช ุงุณุชูุฑุงุฏ ุงููููุณ.</font></font></i> <br><br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุชุธููู ุงููุงุฆู ูุน ุงูุฑุคูุฉ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ุจุฅูุดุงุก ุชุธููู </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุฒุฉ</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุฌุฏูุฏ </font><font style="vertical-align: inherit;">ูุฅุถุงูุฉ ุฏุนู ุงูุฑุคูุฉ ูููุงุฆูุงุช. </font><font style="vertical-align: inherit;">ูุฐุง ูู ุชุธููู ุณุทุญ ุจุณูุท ูุน ุจุฑูุงูุฌ ููุฉ. </font><font style="vertical-align: inherit;">ุฃุถู </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HexCellData</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุฅููู </font><font style="vertical-align: inherit;">ููู ุจุชูุฑูุฑ ูุคุดุฑ ุงูุฑุคูุฉ ุฅูู ุจุฑูุงูุฌ ุงูุฌุฒุก ุ ููุงูุนุงุฏุฉ ุ ุงุนุชุจุฑู ุจุงูุฃููุงู. </font><font style="vertical-align: inherit;">ุงูุงุฎุชูุงู ููุง ูู ุฃูู ูุง ูููููุง ุงุณุชุฎุฏุงููุง </font></font><code>GetCellData</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุนุฏู ูุฌูุฏ ุจูุงูุงุช ุงูุดุจูุฉ ุงููุทููุจุฉ. </font><font style="vertical-align: inherit;">ุจุฏูุงู ูู ุฐูู ุ ูุฏููุง ูููุน ูู ุงูุนุงูู. </font><font style="vertical-align: inherit;">ูููู ูู ุงูููุช ุงูุญุงูู ุ ุงุชุฑู ูุณุชูู ุงูุฑุคูุฉ ูุณุงูู 1.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs pgsql">Shader "Custom/Feature" { Properties { _Color ("Color", Color) = (<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>) _MainTex ("Albedo (RGB)", <span class="hljs-number"><span class="hljs-number">2</span></span>D) = "white" {} _Glossiness ("Smoothness", Range(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>)) = <span class="hljs-number"><span class="hljs-number">0.5</span></span> _Metallic ("Metallic", Range(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>)) = <span class="hljs-number"><span class="hljs-number">0.0</span></span> [NoTilingOffset] _GridCoordinates ("Grid Coordinates", <span class="hljs-number"><span class="hljs-number">2</span></span>D) = "white" {} } SubShader { Tags { "RenderType"="Opaque" } LOD <span class="hljs-number"><span class="hljs-number">200</span></span> CGPROGRAM #pragma surface surf Standard fullforwardshadows vertex:vert #pragma target <span class="hljs-number"><span class="hljs-number">3.0</span></span> #<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> "../HexCellData.cginc" sampler2D _MainTex, _GridCoordinates; half _Glossiness; half _Metallic; fixed4 _Color; struct <span class="hljs-keyword"><span class="hljs-keyword">Input</span></span> { float2 uv_MainTex; <span class="hljs-type"><span class="hljs-type">float</span></span> visibility; }; <span class="hljs-type"><span class="hljs-type">void</span></span> vert (<span class="hljs-keyword"><span class="hljs-keyword">inout</span></span> appdata_full v, <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Input</span></span> data) { UNITY_INITIALIZE_OUTPUT(<span class="hljs-keyword"><span class="hljs-keyword">Input</span></span>, data); float3 pos = mul(unity_ObjectToWorld, v.vertex); data.visibility = <span class="hljs-number"><span class="hljs-number">1</span></span>; } <span class="hljs-type"><span class="hljs-type">void</span></span> surf (<span class="hljs-keyword"><span class="hljs-keyword">Input</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">inout</span></span> SurfaceOutputStandard o) { fixed4 c = tex2D (_MainTex, <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span>.uv_MainTex) * _Color; o.Albedo = c.rgb * <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span>.visibility; o.Metallic = _Metallic; o.Smoothness = _Glossiness; o.Alpha = ca; } ENDCG } FallBack "Diffuse" }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูู ุจุชุบููุฑ ุฌููุน ููุงุฏ ุงููุงุฆูุงุช ุจุญูุซ ุชุณุชุฎุฏู ุชุธููู ุฌุฏูุฏ ูุชุนููู ูุณูุฌ ุฅุญุฏุงุซูุงุช ุงูุดุจูุฉ ููุง. </font></font><br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/e35/fad/546/e35fad5469e6c9e5c6a31626ba182ec8.png"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุญุถุฑูุฉ ูุน ูุณูุฌ ุดุจูู.</font></font></i> <br><br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงููุตูู ุฅูู ุจูุงูุงุช ุงูุฎููุฉ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฃุฎุฐ ุนููุฉ ูู ุฅุญุฏุงุซูุงุช ุงูุดุจูุฉ ูู ุจุฑูุงูุฌ ุงูููุฉ ุ ูุญุชุงุฌ ูุฑุฉ ุฃุฎุฑู ุฅูู </font></font><code>tex2Dlod</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุงูู ุฅุญุฏุงุซูุงุช ูููู ูู ุฃุฑุจุนุฉ ููููุงุช. </font><font style="vertical-align: inherit;">ุงูุฅุญุฏุงุซูุงุช ุงูุฃููู ูุงูุซุงููุฉ ูู ูููุน ุนุงูู XZ. </font><font style="vertical-align: inherit;">ุงูุงุซูุงู ุงูุขุฎุฑุงู ูุณุงููุงู ุงูุตูุฑ ููุง ูุงู ูู ูุจู.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs pgsql"> <span class="hljs-type"><span class="hljs-type">void</span></span> vert (<span class="hljs-keyword"><span class="hljs-keyword">inout</span></span> appdata_full v, <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Input</span></span> data) { UNITY_INITIALIZE_OUTPUT(<span class="hljs-keyword"><span class="hljs-keyword">Input</span></span>, data); float3 pos = mul(unity_ObjectToWorld, v.vertex); <span class="hljs-type"><span class="hljs-type">float4</span></span> gridUV = <span class="hljs-type"><span class="hljs-type">float4</span></span>(pos.xz, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); data.visibility = <span class="hljs-number"><span class="hljs-number">1</span></span>; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุง ูู ุงูุญุงู ูู ุชุธููู </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุชุถุงุฑูุณ</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ ูููู ุจุชูุฏูุฏ ุฅุญุฏุงุซูุงุช ุงูุฃุดุนุฉ ููู ุงูุจููุณุฌูุฉ ุจุญูุซ ูููู ูููุณูุฌ ูุณุจุฉ ุงูุนุฑุถ ุฅูู ุงูุงุฑุชูุงุน ุงูููุงุณุจุฉ ูุดุจูุฉ ุงูุณุฏุงุณูุงุช.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs pgsql"> <span class="hljs-type"><span class="hljs-type">float4</span></span> gridUV = <span class="hljs-type"><span class="hljs-type">float4</span></span>(pos.xz, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); gridUV.x *= <span class="hljs-number"><span class="hljs-number">1</span></span> / (<span class="hljs-number"><span class="hljs-number">4</span></span> * <span class="hljs-number"><span class="hljs-number">8.66025404</span></span>); gridUV.y *= <span class="hljs-number"><span class="hljs-number">1</span></span> / (<span class="hljs-number"><span class="hljs-number">2</span></span> * <span class="hljs-number"><span class="hljs-number">15.0</span></span>);</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูููููุง ูุนุฑูุฉ ุฃู ุฌุฒุก ูู ุฎูุงูุง 2 ร 2 ุงูุชู ูุฃุฎุฐูุง ุนู ุทุฑูู ุฃุฎุฐ ูููุฉ ุฅุญุฏุงุซูุงุช ุงูุฃุดุนุฉ ููู ุงูุจููุณุฌูุฉ ููุฑุจุฉ. </font><font style="vertical-align: inherit;">ูุฐุง ูุดูู ุงูุฃุณุงุณ ูุฅุญุฏุงุซูุงุช ุงูุฎูุงูุง.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs pgsql"> <span class="hljs-type"><span class="hljs-type">float4</span></span> gridUV = <span class="hljs-type"><span class="hljs-type">float4</span></span>(pos.xz, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); gridUV.x *= <span class="hljs-number"><span class="hljs-number">1</span></span> / (<span class="hljs-number"><span class="hljs-number">4</span></span> * <span class="hljs-number"><span class="hljs-number">8.66025404</span></span>); gridUV.y *= <span class="hljs-number"><span class="hljs-number">1</span></span> / (<span class="hljs-number"><span class="hljs-number">2</span></span> * <span class="hljs-number"><span class="hljs-number">15.0</span></span>); float2 cellDataCoordinates = floor(gridUV.xy);</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ููุนุซูุฑ ุนูู ุฅุญุฏุงุซูุงุช ุงูุฎููุฉ ุงูุชู ูุญู ูููุง ุ ูุถูู ุงูุฅุฒุงุญุฉ ุงููุฎุฒูุฉ ูู ุงููุณูุฌ. </font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs pgsql"> float2 cellDataCoordinates = floor(gridUV.xy) + tex2Dlod(_GridCoordinates, gridUV).rg;</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุธุฑูุง ูุฃู ุฌุฒุกูุง ูู ุงูุดุจูุฉ ูุจูุบ ุญุฌูู 2 ร 2 ุ ููุชู ุชุนููุถ ุงูุชุนููุถุงุช ุฅูู ุงููุตู ุ ููุญู ุจุญุงุฌุฉ ุฅูู ูุถุงุนูุฉ ุงููุชูุฌุฉ ููุญุตูู ุนูู ุงูุฅุญุฏุงุซูุงุช ุงูููุงุฆูุฉ. </font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs nginx"> <span class="hljs-attribute"><span class="hljs-attribute">float2</span></span> cellDataCoordinates = floor(gridUV.xy) + tex2Dlod(_GridCoordinates, gridUV).rg; <span class="hljs-attribute"><span class="hljs-attribute">cellDataCoordinates</span></span> *= <span class="hljs-number"><span class="hljs-number">2</span></span>;</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุขู ูุฏููุง ุฅุญุฏุงุซูุงุช XZ ูุดุจูุฉ ุงูุฎูุงูุง ุงูุชู ูุญุชุงุฌ ุฅูู ุชุญููููุง ุฅูู ุฅุญุฏุงุซูุงุช ุงูุฃุดุนุฉ ููู ุงูุจููุณุฌูุฉ ููุฐู ุงูุฎูุงูุง. </font><font style="vertical-align: inherit;">ูููู ุงูููุงู ุจุฐูู ุนู ุทุฑูู ุงูุงูุชูุงู ุจุจุณุงุทุฉ ุฅูู ูุฑุงูุฒ ุงูุจูุณู ุซู ุชูุณูููุง ุฅูู ุฃุญุฌุงู ูุณูุฌ. </font><font style="vertical-align: inherit;">ูุฐุง ุฏุนูุง ูุถูู </font><font style="vertical-align: inherit;">ุฏุงูุฉ ููุฐุง ุฅูู </font><font style="vertical-align: inherit;">ููู </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HexCellData</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงูุฐู ุณูุชูุงูู ุฃูุถูุง ุฃุฎุฐ ุงูุนููุงุช.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs pgsql"><span class="hljs-type"><span class="hljs-type">float4</span></span> GetCellData (float2 cellDataCoordinates) { float2 uv = cellDataCoordinates + <span class="hljs-number"><span class="hljs-number">0.5</span></span>; uv.x *= _HexCellData_TexelSize.x; uv.y *= _HexCellData_TexelSize.y; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> tex2Dlod(_HexCellData, <span class="hljs-type"><span class="hljs-type">float4</span></span>(uv, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>)); }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุขู ูููููุง ุงุณุชุฎุฏุงู ูุฐุง ูู ุจุฑูุงูุฌ ููุฉ ุชุธููู </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุฒุฉ</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs haskell"> cellDataCoordinates *= <span class="hljs-number"><span class="hljs-number">2</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">data</span></span></span><span class="hljs-class">.visibility = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">GetCellData</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">cellDataCoordinates</span></span></span><span class="hljs-class">).x; </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">data</span></span></span><span class="hljs-class">.visibility = lerp(0.25, 1, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">data</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">visibility</span></span></span><span class="hljs-class">);</span></span></code> </pre> <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/1ed/9c9/7ed/1ed9c97ed37aa88aaee6c0efd9d075d7.png"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุงุฆูุงุช ุฐุงุช ุฑุคูุฉ.</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุฃุฎูุฑูุง ุ ุชุคุซุฑ ุงูุฑุคูุฉ ุนูู ุงูุฎุฑูุทุฉ ุจุฃููููุง ุ ุจุงุณุชุซูุงุก ุงููุญุฏุงุช ุงูุชู ุชููู ูุฑุฆูุฉ ุฏุงุฆููุง. ูุธุฑูุง ูุฃููุง ูุญุฏุฏ ุฑุคูุฉ ุงููุงุฆูุงุช ููู ููุฉ ุ ุซู ุจุงููุณุจุฉ ูููุงุฆู ุงูุฐู ูุนุจุฑ ุญุฏูุฏ ุงูุฎููุฉ ุ ูุฅู ุฑุคูุฉ ุงูุฎูุงูุง ุงูุชู ูุชู ุฅุบูุงููุง ุณูุชู ูุฒุฌูุง. ููู ุงูุฃุฌุณุงู ุตุบูุฑุฉ ุฌุฏูุง ุจุญูุซ ุชุจูู ุจุงุณุชูุฑุงุฑ ุฏุงุฎู ุฒูุฒุงูุชูุง ุ ุญุชู ูุน ูุฑุงุนุงุฉ ุชุดููู ุงูููุงุถุน. ููุน ุฐูู ุ ูุฏ ูููู ุงูุจุนุถ ุฌุฒุกูุง ูู ุงูููู ูู ุฎููุฉ ุฃุฎุฑู. ูุฐูู ุ ููุฌูุง ุฑุฎูุต ุ ูููู ุบูุฑ ูุงูู. ูุฐุง ูู ุฃูุซุฑ ูุง ููุงุญุธ ูู ุญุงูุฉ ุงูุฌุฏุฑุงู ุ ูุงูุชู ุชุฎุชูู ุฑุคูุชูุง ุจูู ุฑุคู ุงูุฎูุงูุง ุงููุฌุงูุฑุฉ.</font></font><br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/421/1c7/f7d/4211c7f7dea80bbbd13664586074c43a.png"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุฌุฏุฑุงู ุฐุงุช ุงูุฑุคูุฉ ุงููุชุบูุฑุฉ. </font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุธุฑูุง ูุฃู ููุงุทุน ุงูุฌุฏุงุฑ ูุชู ุฅูุดุงุคูุง ุฅุฌุฑุงุฆููุง ุ ูููููุง ุฅุถุงูุฉ ุจูุงูุงุช ุงูุฎููุฉ ุฅูู ุดุจูุชูุง ูุงุณุชุฎุฏุงู ุงูููุฌ ุงูุฐู ุงุณุชุฎุฏููุงู ููุชุฎููู. </font><font style="vertical-align: inherit;">ูุณูุก ุงูุญุธ ุ ูุฅู ุงูุฃุจุฑุงุฌ ุณุงุจูุฉ ุงูุชุฌููุฒ ุ ูุฐูู ูุง ูุฒุงู ูุฏููุง ุชูุงูุถุงุช. </font><font style="vertical-align: inherit;">ุจุดูู ุนุงู ุ ูุจุฏู ุงููููุฌ ุงูุญุงูู ุฌูุฏูุง ุจูุง ูููู ููููุฏุณุฉ ุงูุจุณูุทุฉ ุงูุชู ูุณุชุฎุฏููุง. </font><font style="vertical-align: inherit;">ูู ุงููุณุชูุจู ุ ุณููุธุฑ ูู ููุงุฐุฌ ูุฌุฏุฑุงู ุฃูุซุฑ ุชูุตููุงู ุ ูุฐูู ุ ุณูุญุณู ุทุฑููุฉ ูุฒุฌ ุฑุคูุชูุง. </font></font><br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุญุฒูุฉ ุงููุญุฏุฉ</font></font></a> <br><br><h1 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงูุฌุฒุก 21: ุจุญุซ ุงูุฎุฑุงุฆุท </font></font></h1><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุนุฑุถ ูู ุดูุก ุฃุซูุงุก ุงูุชุญุฑูุฑ. </font></font></li><li style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุญู ูุชุชุจุน ุงูุฎูุงูุง ุงูุชู ุชู ุงูุชุญููู ูููุง. </font></font></li><li style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุฎูู ูุง ูุง ูุฒุงู ูุฌูููุง. </font></font></li><li style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุญู ูุฌุจุฑ ุงููุญุฏุงุช ุนูู ุชุฌูุจ ุงูููุงุทู ุบูุฑ ุงููุณุชูุดูุฉ. </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูู ุงูุฌุฒุก ุงูุณุงุจู ุ ุฃุถููุง ุถุจุงุจ ุงูุญุฑุจ ุ ูุงูุฐู ุณูููู ุงูุขู ุจุชูููุญู ูุชูููุฐ ุฃุจุญุงุซ ุงูุฎุฑุงุฆุท. </font></font><br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/81d/40e/bff/81d40ebff615fc7c4e39a15d88da016d.jpg"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุญู ูุณุชุนุฏูู ูุงุณุชูุดุงู ุงูุนุงูู.</font></font></i> <br><br><h2 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงุนุฑุถ ุงูุฎุฑูุทุฉ ุจุงููุงูู ูู ูุถุน ุงูุชุญุฑูุฑ </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุนูู ุงูุฏุฑุงุณุฉ ูู ุฃูู ุญุชู ูุง ุชุฑู ุงูุฎูุงูุง ุชุนุชุจุฑ ุบูุฑ ูุนุฑููุฉ ุ ูุจุงูุชุงูู ุบูุฑ ูุฑุฆูุฉ. </font><font style="vertical-align: inherit;">ูุง ูุฌุจ ุญุฌุจูุง ุ ูููู ูุง ูุชู ุนุฑุถูุง ุนูู ุงูุฅุทูุงู. </font><font style="vertical-align: inherit;">ูุฐูู ุ ูุจู ุฅุถุงูุฉ ุฏุนู ุงูุจุญุซ ุ ุณูููู ุจุชูููู ุงูุฑุคูุฉ ูู ูุถุน ุงูุชุญุฑูุฑ.</font></font><br><br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุชุจุฏูู ุงูุฑุคูุฉ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูููููุง ุงูุชุญูู ูููุง ุฅุฐุง ูุงู ุงูุชุธููู ูุณุชุฎุฏู ุงูุฑุคูุฉ ุจุงุณุชุฎุฏุงู ุงููููุฉ ุงูุฑุฆูุณูุฉ ุ ููุง ุญุฏุซ ูุน ุงูุชุฑุงูุจ ุนูู ุงูุดุจูุฉ. </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุณุชุฎุฏู</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงููููุฉ ุงูุฑุฆูุณูุฉ </font><em><font style="vertical-align: inherit;">HEX_MAP_EDIT_MODE</font></em><font style="vertical-align: inherit;"> ููุฅุดุงุฑุฉ ุฅูู ุญุงูุฉ ูุถุน ุงูุชุญุฑูุฑ. </font><font style="vertical-align: inherit;">ูุธุฑูุง ูุฃู ุงูุนุฏูุฏ ูู ุงูุชุธููู ูุฌุจ ุฃู ูุนุฑููุง ุนู ูุฐู ุงููููุฉ ุงูุฑุฆูุณูุฉ ุ ูุณูู ูุญุฏุฏูุง ุนุงููููุง ุจุงุณุชุฎุฏุงู ุงูุฃุณุงููุจ ุงูุซุงุจุชุฉ </font></font><code>Shader.EnableKeyWord</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ู </font></font><code>Shader.DisableKeyword</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ุณูุณุชุฏุนู ุงูุทุฑููุฉ ุงูููุงุณุจุฉ </font></font><code>HexGameUI.SetEditMode</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุนูุฏ ุชุบููุฑ ูุถุน ุงูุชุญุฑูุฑ.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SetEditMode</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> toggle</span></span></span><span class="hljs-function">)</span></span> { enabled = !toggle; grid.ShowUI(!toggle); grid.ClearPath(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (toggle) { Shader.EnableKeyword(<span class="hljs-string"><span class="hljs-string">"HEX_MAP_EDIT_MODE"</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { Shader.DisableKeyword(<span class="hljs-string"><span class="hljs-string">"HEX_MAP_EDIT_MODE"</span></span>); } }</code> </pre> <br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุชุนุฏูู ุชุธููู ุงููุถุน </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุนูุฏ ุชุญุฏูุฏ </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HEX_MAP_EDIT_MODE</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ ุณุชุชุฌุงูู ุงูุชุธููู ุงูุฑุคูุฉ. </font><font style="vertical-align: inherit;">ูุฐุง ูุชูุฎุต ูู ุญูููุฉ ุฃู ุฑุคูุฉ ุงูุฎููุฉ ุณุชุนุชุจุฑ ุฏุงุฆููุง ูุณุงููุฉ ูู 1. ุฏุนูุง ูุถูู </font><font style="vertical-align: inherit;">ูุธููุฉ ูุชุตููุฉ ุจูุงูุงุช ุงูุฎูุงูุง ุงุนุชูุงุฏูุง ุนูู ุงููููุฉ ุงูุฑุฆูุณูุฉ </font><font style="vertical-align: inherit;">ูู ุจุฏุงูุฉ ููู ุงูุชุถููู </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HexCellData</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs kotlin">sampler2D _HexCellData; float4 _HexCellData_TexelSize; float4 FilterCellData (float4 <span class="hljs-keyword"><span class="hljs-keyword">data</span></span>) { #<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> defined(HEX_MAP_EDIT_MODE) <span class="hljs-keyword"><span class="hljs-keyword">data</span></span>.x = <span class="hljs-number"><span class="hljs-number">1</span></span>; #endif <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">data</span></span>; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูููู ุจุชูุฑูุฑ ูุฐู ุงููุธููุฉ ูุชูุฌุฉ ููุชุง ุงููุธููุชูู </font></font><code>GetCellData</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุจู ุฅุนุงุฏุชูุง.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs pgsql"><span class="hljs-type"><span class="hljs-type">float4</span></span> GetCellData (appdata_full v, <span class="hljs-type"><span class="hljs-type">int</span></span> <span class="hljs-keyword"><span class="hljs-keyword">index</span></span>) { โฆ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> FilterCellData(data); } <span class="hljs-type"><span class="hljs-type">float4</span></span> GetCellData (float2 cellDataCoordinates) { โฆ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> FilterCellData(tex2Dlod(_HexCellData, <span class="hljs-type"><span class="hljs-type">float4</span></span>(uv, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>))); }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููู ูุนูู ูู ุดูุก ุ ูุฌุจ ุฃู ูุชููู ุฌููุน ุฃุฌูุฒุฉ ุงูุชุธููู ุฐุงุช ุงูุตูุฉ ุงูุชูุฌูู ูุชุนุฏุฏ_ุงููููุงุช ูุฅูุดุงุก ุฎูุงุฑุงุช ูู ุญุงูุฉ </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุญุฏูุฏ</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงููููุฉ ุงูุฑุฆูุณูุฉ </font><em><font style="vertical-align: inherit;">HEX_MAP_EDIT_MODE</font></em><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">ุฃุถู ุงูุณุทุฑ ุงูููุงุณุจ ูู ุชุธููู </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุตุจ</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุฒุฉ</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุฑ</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุทุฑูู</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุชุถุงุฑูุณ</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูููุงู</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ู </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุดุงุทุฆ ุงูููุงู</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ ุจูู ุงููุฏู ูุฃูู ุชูุฌูู ุงูุชูุฌููู ุชุดูู.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs cs"> <span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">pragma</span></span></span><span class="hljs-meta"> multi_compile _ HEX_MAP_EDIT_MODE</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุขู ุ ุนูุฏ ุงูุชุจุฏูู ุฅูู ูุถุน ุชุญุฑูุฑ ุงูุฎุฑูุทุฉ ุ ุณูุฎุชูู ุถุจุงุจ ุงูุญุฑุจ. </font></font><br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุญุฒูุฉ ุงููุญุฏุฉ</font></font></a> <br><br><h2 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงูุจุญุซ ุงูุฎููู </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุดูู ุงูุชุฑุงุถู ุ ูุฌุจ ุงุนุชุจุงุฑ ุงูุฎูุงูุง ุบูุฑ ูุณุชูุดูุฉ. </font><font style="vertical-align: inherit;">ูุชู ุงุณุชูุดุงููู ุนูุฏูุง ุชุฑุงูู ูุฑูุฉ. </font><font style="vertical-align: inherit;">ุจุนุฏ ุฐูู ุ ูุณุชูุฑูู ูู ุงูุชุญููู ุฅุฐุง ูุงู ุจุฅููุงู ููุฑุฒุฉ ุฑุคูุชูู.</font></font><br><br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุชุชุจุน ุญุงูุฉ ุงูุฏุฑุงุณุฉ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฅุถุงูุฉ ุฏุนู ูุฑุตุฏ ุญุงูุฉ ุงูุฏุฑุงุณุงุช ุ ูุถูู ุฅูู </font></font><code>HexCell</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูููุชููุงุช ุงูุนุงูุฉ </font></font><code>IsExplored</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> IsExplored { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุชู ุชุญุฏูุฏ ุญุงูุฉ ุงูุฏุฑุงุณุฉ ูู ูุจู ุงูุฎููุฉ ููุณูุง. </font><font style="vertical-align: inherit;">ูุฐูู ุ ูุฌุจ ุชุนููู ูุฐู ุงูุฎุงุตูุฉ ููุท </font></font><code>HexCell</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ูุฅุถุงูุฉ ูุฐุง ุงูุชูููุฏ ุ ุณูููู ุจุชุนููู ุงูุถุงุจุท ุฎุงุต.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> IsExplored { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ุงููุฑุฉ ุงูุฃููู ุงูุชู ุชุตุจุญ ูููุง ุฑุคูุฉ ุงูุฎููุฉ ุฃูุจุฑ ูู ุงูุตูุฑ ุ ุชุจุฏุฃ ุงูุฎููุฉ ูู ุงูุชุญููู ุ ูุจุงูุชุงูู </font></font><code>IsExplored</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฌุจ ุชุนููู ูููุฉ </font></font><code>true</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ูู ุงููุงูุน ุ ุณูููู ูุงููุงู ุจุงููุณุจุฉ ููุง ุจุจุณุงุทุฉ ูุถุน ุนูุงูุฉ ุนูู ุงูุฎููุฉ ุนูู ุฃููุง ุชู ูุญุตูุง ุนูุฏ ุฒูุงุฏุฉ ุงูุฑุคูุฉ ุฅูู 1. ูุฌุจ ุฃู ูุชู ุฐูู ูุจู ุงูููุงููุฉ </font></font><code>RefreshVisibility</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">IncreaseVisibility</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { visibility += <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (visibility == <span class="hljs-number"><span class="hljs-number">1</span></span>) { IsExplored = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; ShaderData.RefreshVisibility(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); } }</code> </pre> <br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ููู ุญุงูุฉ ุงูุจุญุซ ุฅูู ุชุธููู </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุง ูู ุงูุญุงู ูู ุฑุคูุฉ ุงูุฎูุงูุง ุ ูููู ุญุงูุฉ ุงูุจุญุซ ุงูุฎุงุตุฉ ุจูู ุฅูู ุชุธููู ูู ุฎูุงู ุจูุงูุงุช ุชุธููู. </font><font style="vertical-align: inherit;">ูู ุงูููุงูุฉ ุ ุฅูู ูุฌุฑุฏ ููุน ุขุฎุฑ ูู ุงูุฑุคูุฉ. </font></font><code>HexCellShaderData.RefreshVisibility</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฎุฒู ุญุงูุฉ ุงูุฑุคูุฉ ูู ููุงุฉ ุงูุจูุงูุงุช ุฑ. </font><font style="vertical-align: inherit;">ุฏุนููุง ูุญุงูุธ ุนูู ุญุงูุฉ ุงูุฏุฑุงุณุฉ ูู ุจูุงูุงุช ุงูููุงุฉ G.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RefreshVisibility</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">HexCell cell</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> index = cell.Index; cellTextureData[index].r = cell.IsVisible ? (<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>)<span class="hljs-number"><span class="hljs-number">255</span></span> : (<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>)<span class="hljs-number"><span class="hljs-number">0</span></span>; cellTextureData[index].g = cell.IsExplored ? (<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>)<span class="hljs-number"><span class="hljs-number">255</span></span> : (<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>)<span class="hljs-number"><span class="hljs-number">0</span></span>; enabled = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; }</code> </pre> <br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุฑุงุญุฉ ุณูุฏุงุก ุบูุฑ ูุณุชูุดูุฉ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูููููุง ุงูุขู ุงุณุชุฎุฏุงู ุฃุฌูุฒุฉ ุชุธููู ูุชุตูุฑ ุญุงูุฉ ุฃุจุญุงุซ ุงูุฎูุงูุง. </font><font style="vertical-align: inherit;">ููุชุฃูุฏ ูู ุฃู ูู ุดูุก ูุนูู ููุง ููุจุบู ุ ูุญู ููุท ูุฌุนู ุงูุชุถุงุฑูุณ ุบูุฑ ุงููุณุชูุดูุฉ ุณูุฏุงุก. </font><font style="vertical-align: inherit;">ูููู ุฃููุงู ุ ูุฌุนู ูุถุน ุงูุชุญุฑูุฑ ูุนูู ุ ูู ุจุชุบููุฑู </font></font><code>FilterCellData</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุญูุซ ูููู ุจุชุตููุฉ ุจูุงูุงุช ุงูุจุญุซ.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs kotlin">float4 FilterCellData (float4 <span class="hljs-keyword"><span class="hljs-keyword">data</span></span>) { #<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> defined(HEX_MAP_EDIT_MODE) <span class="hljs-keyword"><span class="hljs-keyword">data</span></span>.xy = <span class="hljs-number"><span class="hljs-number">1</span></span>; #endif <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">data</span></span>; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูููู ุฌูุงุฒ ุชุธููู </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุชุถุงุฑูุณ</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุจุชูุฑูุฑ ุจูุงูุงุช ุงูุฑุคูุฉ ููุฎูุงูุง ุงูุซูุงุซ ุงูููููุฉ ุฅูู ุจุฑูุงูุฌ ุงูุฃุฌุฒุงุก. </font><font style="vertical-align: inherit;">ูู ุญุงูุฉ ุงูุจุญุซ ุ ูููู ุจุฏูุฌูุง ูู ุจุฑูุงูุฌ ุงูููุฉ ููููู ุงููููุฉ ุงููุญูุฏุฉ ุฅูู ุจุฑูุงูุฌ ุงูุชุฌุฒุฆุฉ. </font><font style="vertical-align: inherit;">ุฃุถู </font></font><code>visibility</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงููููู ุงูุฑุงุจุน ุฅูู </font><font style="vertical-align: inherit;">ุงููุฏุฎูุงุช </font><font style="vertical-align: inherit;">ุจุญูุซ ูููู ูุฏููุง ููุงู ูุฐูู.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs pgsql"> struct <span class="hljs-keyword"><span class="hljs-keyword">Input</span></span> { <span class="hljs-type"><span class="hljs-type">float4</span></span> color : COLOR; float3 worldPos; float3 terrain; <span class="hljs-type"><span class="hljs-type">float4</span></span> visibility; };</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุขู ุ ูู ุจุฑูุงูุฌ ุงูููุฉ ุ ุนูุฏูุง ูุบูุฑ ูุคุดุฑ ุงูุฑุคูุฉ ุ ูุฌุจ ุฃู ูุตู ุตุฑุงุญุฉ </font></font><code>data.visibility.xyz</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs pgsql"> <span class="hljs-type"><span class="hljs-type">void</span></span> vert (<span class="hljs-keyword"><span class="hljs-keyword">inout</span></span> appdata_full v, <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Input</span></span> data) { โฆ data.visibility.xyz = lerp(<span class="hljs-number"><span class="hljs-number">0.25</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, data.visibility.xyz); }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุนุฏ ุฐูู ุ ูุฌูุน ุจูู ุญุงูุงุช ุงูุฏุฑุงุณุฉ ูููุชุจ ุงููุชูุฌุฉ </font></font><code>data.visibility.w</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ูุฐุง ูุดุงุจู ููุฌูุน ุจูู ุงูุฑุคูุฉ ูู ุชุธููู ุฃุฎุฑู ุ ูููู ุจุงุณุชุฎุฏุงู ุงููููู Y ููุฐู ุงูุฎูุงูุง.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs haskell"> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">data</span></span></span><span class="hljs-class">.visibility.xyz = lerp(0.25, 1, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">data</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">visibility</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">xyz</span></span></span><span class="hljs-class">); </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">data</span></span></span><span class="hljs-class">.visibility.w = cell0.y * v.color.x + cell1.y * v.color.y + cell2.y * v.color.z;</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุญุงูุฉ ุงูุจุญุซ ูุชุงุญุฉ ุงูุขู ูู ุจุฑูุงูุฌ ุงูุฌุฒุก ูู ุฎูุงู </font></font><code>IN.visibility.w</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ุงุนุชุจุฑูุง ูู ุญุณุงุจ ุงูุจูุงุถ.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs pgsql"> <span class="hljs-type"><span class="hljs-type">void</span></span> surf (<span class="hljs-keyword"><span class="hljs-keyword">Input</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">inout</span></span> SurfaceOutputStandard o) { โฆ <span class="hljs-type"><span class="hljs-type">float</span></span> explored = <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span>.visibility.w; o.Albedo = c.rgb * grid * _Color * explored; o.Metallic = _Metallic; o.Smoothness = _Glossiness; o.Alpha = ca; }</code> </pre> <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/b2d/de4/c18/b2dde4c1831a9ecc637550b2b8e2e134.png"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุชุถุงุฑูุณ ุบูุฑ ุงูููุชุดูุฉ ุฃุตุจุญุช ุงูุขู ุณูุฏุงุก. </font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅู ุชุฎููู ุงูุฎูุงูุง ุบูุฑ ุงูููุชุดูุฉ ุฃุตุจุญ ุงูุขู ูููู ุฃุณูุฏ. </font><font style="vertical-align: inherit;">ููู ูุฐุง ูู ูุคุซุฑ ุจุนุฏ ุนูู ุงูุฃุดูุงุก ูุงูุทุฑู ูุงูููุงู. </font><font style="vertical-align: inherit;">ููุน ุฐูู ุ ูุฐุง ูููู ููุชุฃูุฏ ูู ุฃู ุงูุฏุฑุงุณุฉ ุชุนูู.</font></font><br><br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุญูุธ ูุชุญููู ุญุงูุฉ ุงูุจุญุซ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุขู ุจุนุฏ ุฃู ุฃุถููุง ุฏุนู ุงูุจุญุซ ุ ูุญุชุงุฌ ุฅูู ุงูุชุฃูุฏ ูู ุฃุฎุฐ ุญุงูุฉ ุงูุจุญุซ ุจุนูู ุงูุงุนุชุจุงุฑ ุนูุฏ ุญูุธ ุงูุฎุฑุงุฆุท ูุชุญููููุง. </font><font style="vertical-align: inherit;">ูุฐูู ุ ูุญุชุงุฌ ุฅูู ุฒูุงุฏุฉ ุฅุตุฏุงุฑ ูููุงุช ุงูุฎุฑุงุฆุท ุฅูู 3. ูุฌุนู ูุฐู ุงูุชุบููุฑุงุช ุฃูุซุฑ ููุงุกูุฉ ุ ุฏุนูุง ูุถูู </font></font><code>SaveLoadMenu</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุซุงุจุชูุง </font><font style="vertical-align: inherit;">ูุฐูู </font><font style="vertical-align: inherit;">.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> mapFileVersion = <span class="hljs-number"><span class="hljs-number">3</span></span>;</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุณูุณุชุฎุฏู ูุฐุง ุงูุซุงุจุช ุนูุฏ ูุชุงุจุฉ ุฅุตุฏุงุฑ ุงูููู ุฅูู </font></font><code>Save</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุนูุฏ ุงูุชุญูู ูู ุฏุนู ุงูููู </font></font><code>Load</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Save</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> path</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> ( BinaryWriter writer = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BinaryWriter(File.Open(path, FileMode.Create)) ) { writer.Write(mapFileVersion); hexGrid.Save(writer); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Load</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> path</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!File.Exists(path)) { Debug.LogError(<span class="hljs-string"><span class="hljs-string">"File does not exist "</span></span> + path); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> (BinaryReader reader = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BinaryReader(File.OpenRead(path))) { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> header = reader.ReadInt32(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (header &lt;= mapFileVersion) { hexGrid.Load(reader, header); HexMapCamera.ValidatePosition(); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { Debug.LogWarning(<span class="hljs-string"><span class="hljs-string">"Unknown map format "</span></span> + header); } } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฎุทูุฉ ุฃุฎูุฑุฉ ุ </font></font><code>HexCell.Save</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุณุฌู ุญุงูุฉ ุงูุฏุฑุงุณุฉ.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Save</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">BinaryWriter writer</span></span></span><span class="hljs-function">)</span></span> { โฆ writer.Write(IsExplored); }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุณููุฑุฃู ูู ุงูููุงูุฉ </font></font><code>Load</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ุจุนุฏ ุฐูู ุ ุณูุชุตู </font></font><code>RefreshVisibility</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ุญุงูุฉ ุงุฎุชูุงู ุญุงูุฉ ุงูุฏุฑุงุณุฉ ุนู ุงูุญุงูุฉ ุงูุณุงุจูุฉ.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Load</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">BinaryReader reader</span></span></span><span class="hljs-function">)</span></span> { โฆ IsExplored = reader.ReadBoolean(); ShaderData.RefreshVisibility(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุญูุงุธ ุนูู ุงูุชูุงูู ูุน ูููุงุช ุงูุญูุธ ุงููุฏููุฉ ุ ูุญุชุงุฌ ุฅูู ุชุฎุทู ูุฑุงุกุฉ ุญุงูุฉ ุงูุญูุธ ุฅุฐุง ูุงู ุฅุตุฏุงุฑ ุงูููู ุฃูู ูู 3. ูู ูุฐู ุงูุญุงูุฉ ุ ุจุดูู ุงูุชุฑุงุถู ุ ุณูููู ููุฎูุงูุง ุงูุญุงูุฉ "ุบูุฑ ูุณุชูุดูุฉ". </font><font style="vertical-align: inherit;">ููููุงู ุจุฐูู ุ ูุญุชุงุฌ ุฅูู ุฅุถุงูุฉ </font></font><code>Load</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจูุงูุงุช ุฑุฃุณ </font><font style="vertical-align: inherit;">ููุนููุฉ </font><font style="vertical-align: inherit;">.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Load</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">BinaryReader reader, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> header</span></span></span><span class="hljs-function">)</span></span> { โฆ IsExplored = header &gt;= <span class="hljs-number"><span class="hljs-number">3</span></span> ? reader.ReadBoolean() : <span class="hljs-literal"><span class="hljs-literal">false</span></span>; ShaderData.RefreshVisibility(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุขู </font></font><code>HexGrid.Load</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฌุจ ุฃู ุชูุฑ ูู </font></font><code>HexCell.Load</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจูุงูุงุช ุงูุฑุฃุณ.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Load</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">BinaryReader reader, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> header</span></span></span><span class="hljs-function">)</span></span> { โฆ <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; cells.Length; i++) { cells[i].Load(reader, header); } โฆ }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุขู ุ ุนูุฏ ุญูุธ ูุชุญููู ุงูุฎุฑุงุฆุท ุ ุณูุชู ุฃุฎุฐ ุญุงูุฉ ุงุณุชูุดุงู ุงูุฎูุงูุง ุจุนูู ุงูุงุนุชุจุงุฑ. </font></font><br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุญุฒูุฉ ุงููุญุฏุฉ</font></font></a> <br><br><h2 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุฅุฎูุงุก ุงูุฎูุงูุง ุบูุฑ ุงููุนุฑููุฉ </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ุงููุฑุญูุฉ ุงูุญุงููุฉ ุ ูุชู ุชุญุฏูุฏ ุงูุฎูุงูุง ุบูุฑ ุงููุณุชูุดูุฉ ุจุตุฑููุง ุจูุงุณุทุฉ ุงุฑุชูุงุญ ุฃุณูุฏ. </font><font style="vertical-align: inherit;">ููู ูู ุงููุงูุน ุ ูุฑูุฏ ุฃู ุชููู ูุฐู ุงูุฎูุงูุง ุบูุฑ ูุฑุฆูุฉ ูุฃููุง ุบูุฑ ูุนุฑููุฉ. </font><font style="vertical-align: inherit;">ูููููุง ุฃู ูุฌุนู ุงูููุฏุณุฉ ุบูุฑ ุงูุดูุงูุฉ ุดูุงูุฉ ุจุญูุซ ูุง ุชููู ูุฑุฆูุฉ. </font><font style="vertical-align: inherit;">ููุน ุฐูู ุ ุชู ุชุทููุฑ ุฅุทุงุฑ ุชุธููู ุณุทุญ ุงููุญุฏุฉ ุฏูู ูุถุน ูุฐู ุงูุฅููุงููุฉ ูู ุงูุงุนุชุจุงุฑ. </font><font style="vertical-align: inherit;">ุจุฏูุงู ูู ุงุณุชุฎุฏุงู ุงูุดูุงููุฉ ุงูุญููููุฉ ุ ุณูููู ุจุชุบููุฑ ุงูุธูุงู ูุชุชูุงุณุจ ูุน ุงูุฎูููุฉ ุ ููุง ุณูุฌุนููุง ุฃูุถูุง ุบูุฑ ูุฑุฆูุฉ.</font></font><br><br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุฌุนู ุงูุฅุบุงุซุฉ ุณูุฏุงุก ุญูุง </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุนูู ุงูุฑุบู ูู ุฃู ุงูุฅุบุงุซุฉ ุงููุฏุฑูุณุฉ ุณูุฏุงุก ุ ูุง ูุฒุงู ุจุฅููุงููุง ุงูุชุนุฑู ุนูููุง ูุฃููุง ูุง ุชุฒุงู ุชุญุชูู ุนูู ุฅุถุงุกุฉ ุจุฑุงู. ููุชุฎูุต ูู ุงูุฅุถุงุกุฉ ุ ูุญุชุงุฌ ุฅูู ุฌุนููุง ุณูุฏุงุก ุบูุฑ ูุงูุนุฉ ุชูุงููุง. ููู ูุง ุชุคุซุฑ ุนูู ุฎุตุงุฆุต ุงูุณุทุญ ุงูุฃุฎุฑู ุ ูู ุงูุฃุณูู ุชุบููุฑ ููู ุงููุฑุขุฉ ุฅูู ุงูุฃุณูุฏ. ูุฐุง ูููู ุฅุฐุง ููุช ุชุณุชุฎุฏู ุชุธููู ุณุทุญ ูุนูู ูุน ุจุฑุงู ุ ูููู ุงูุขู ูุณุชุฎุฏู ุงููุนุฏูู ุงูููุงุณู. ููุจุฏุฃ ูู ุฎูุงู ุชุจุฏูู ุฌูุงุฒ ุชุธููู </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Terrain</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุฅูู ููุธุงุฑู. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงุณุชุจุฏุงู ุงูููุชููุงุช ุงูููู </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_Metallic</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุนูู ุงูููุชููุงุช </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_Specular</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . ุจุดูู ุงูุชุฑุงุถู ุ ูุฌุจ ุฃู ุชููู ูููุฉ ูููู ุชุณุงูู (0.2 ุ 0.2 ุ 0.2). ูุฐูู ูุญู ูุถูู ุฃููุง ุณุชุทุงุจู ูุธูุฑ ุงููุณุฎุฉ ุงููุนุฏููุฉ.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs nginx"> <span class="hljs-section"><span class="hljs-section">Properties</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">_Color</span></span> (<span class="hljs-string"><span class="hljs-string">"Color"</span></span>, Color) = (<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>) _MainTex (<span class="hljs-string"><span class="hljs-string">"Terrain Texture Array"</span></span>, 2DArray) = <span class="hljs-string"><span class="hljs-string">"white"</span></span> {} <span class="hljs-attribute"><span class="hljs-attribute">_GridTex</span></span> (<span class="hljs-string"><span class="hljs-string">"Grid Texture"</span></span>, 2D) = <span class="hljs-string"><span class="hljs-string">"white"</span></span> {} <span class="hljs-attribute"><span class="hljs-attribute">_Glossiness</span></span> (<span class="hljs-string"><span class="hljs-string">"Smoothness"</span></span>, Range(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>)) = <span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">5</span></span> // _Metallic (<span class="hljs-string"><span class="hljs-string">"Metallic"</span></span>, Range(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>)) = <span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span> _Specular (<span class="hljs-string"><span class="hljs-string">"Specular"</span></span>, Color) = (<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">2</span></span>) }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ุฃูุถูุง ุจุชุบููุฑ ูุชุบูุฑุงุช ุงูุชุธููู ุงูููุงุจูุฉ. </font><font style="vertical-align: inherit;">ูุชู ุชุนุฑูู ููู ุชุธููู ุงูุณุทุญ ุงููุฑุขูู ุนูู ุฃูู </font></font><code>fixed3</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ ูุฐูู ุฏุนููุง ูุณุชุฎุฏูู.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs objectivec"> half _Glossiness; <span class="hljs-comment"><span class="hljs-comment">// half _Metallic; fixed3 _Specular; fixed4 _Color;</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุบููุฑ ุชุตูุญ ุณุทุญ pragma ูู </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Standard</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุฅูู </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">StandardSpecular</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">ูุฐุง ุณูุฌุจุฑ ุงููุญุฏุฉ ุนูู ุชูููุฏ ุชุธููู ุจุงุณุชุฎุฏุงู ุจุฑุงู.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs cs"> <span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">pragma</span></span></span><span class="hljs-meta"> surface surf StandardSpecular fullforwardshadows vertex:vert</span></span></code> </pre> <br><font style="vertical-align: inherit;"></font><code>surf</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุญุชุงุฌ </font><font style="vertical-align: inherit;">ุงููุธููุฉ ุงูุขู </font><font style="vertical-align: inherit;">ุฅูู ุงููุนููุฉ ุงูุซุงููุฉ ูู ุงูููุน </font></font><code>SurfaceOutputStandardSpecular</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ุชุญุชุงุฌ ุงูุขู ุฅูู ุชุนููู ุงููููุฉ ูุง </font></font><code>o.Metallic</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ ูููู </font></font><code>o.Specular</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs pgsql"> <span class="hljs-type"><span class="hljs-type">void</span></span> surf (<span class="hljs-keyword"><span class="hljs-keyword">Input</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">inout</span></span> SurfaceOutputStandardSpecular o) { โฆ <span class="hljs-type"><span class="hljs-type">float</span></span> explored = <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span>.visibility.w; o.Albedo = c.rgb * grid * _Color * explored; // o.Metallic = _Metallic; o.Specular = _Specular; o.Smoothness = _Glossiness; o.Alpha = ca; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุขู ูููููุง ุฅุฎูุงุก ุงูููุงุท ุงูุจุงุฑุฒุฉ ูู ุฎูุงู ุงููุธุฑ ูู </font></font><code>explored</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูููู ุงููุฑุขูู.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs"> o.Specular = _Specular * explored;</code> </pre> <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/289/d05/128/289d0512816a7d6f692b0e7639e882eb.png"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุถุงุฑูุณ ุบูุฑ ูุณุชูุดูุฉ ุจุฏูู ุฅุถุงุกุฉ ุนุงูุณุฉ. </font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุง ุชุฑู ูู ุงูุตูุฑุฉ ุ ุชุจุฏู ุงููููุด ุบูุฑ ุงูููุชุดูุฉ ุงูุขู ุณูุฏุงุก ุจุงูุชุฉ. </font><font style="vertical-align: inherit;">ููุน ุฐูู ุ ุนูุฏ ุนุฑุถู ุจุฒุงููุฉ ููุงุณุฉ ุ ุชุชุญูู ุงูุฃุณุทุญ ุฅูู ูุฑุขุฉ ุ ูุงูุชู ุจุณุจุจูุง ูุจุฏุฃ ุงูุงุฑุชุฎุงุก ูู ุนูุณ ุงูุจูุฆุฉ ุ ุฃู ุตูุฏูู ุงูุณูุงุก.</font></font><br><br><div class="spoiler" style=";text-align:right;direction:rtl"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุงุฐุง ุชุตุจุญ ุงูุฃุณุทุญ ูุฑุงูุงุ</font></font></b> <div class="spoiler_text" style=";text-align:right;direction:rtl">    .  .    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Rendering</a> . </div></div><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/255/d63/627/255d636278eb947c27117d6c596a9489.png"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุง ุชุฒุงู ุงูููุงุทู ุบูุฑ ุงููุณุชูุดูุฉ ุชุนูุณ ุงูุจูุฆุฉ. </font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุชุฎูุต ูู ูุฐู ุงูุงูุนูุงุณุงุช ุ ุณููุธุฑ ูู ุงูุฅุบุงุซุฉ ุบูุฑ ุงููุณุชูุดูุฉ ูุธููุฉ ุชูุงููุง. </font><font style="vertical-align: inherit;">ูุชู ุชุญููู ุฐูู ุนู ุทุฑูู ุชุนููู ูููุฉ </font></font><code>explored</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุนููุฉ ุงูุฅุทุจุงู ุ ูุงูุชู ูุณุชุฎุฏููุง ูููุงุน ุงูุนูุงุณ.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs pgsql"> <span class="hljs-type"><span class="hljs-type">float</span></span> explored = <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span>.visibility.w; o.Albedo = c.rgb * grid * _Color * explored; o.Specular = _Specular * explored; o.Smoothness = _Glossiness; o.Occlusion = explored; o.Alpha = ca;</code> </pre> <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/118/ab6/a5a/118ab6a5a91711eda2165433a7b99513.png"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุบูุฑ ูุณุชูุดูุฉ ุจุฏูู ุชุฃููุงุช.</font></font></i> <br><br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุทุงุจูุฉ ุงูุฎูููุฉ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุขู ุจุนุฏ ุฃู ุชุชุฌุงูู ุงูุชุถุงุฑูุณ ุบูุฑ ุงููุณุชูุดูุฉ ุฌููุน ุงูุฅุถุงุกุฉ ุ ุชุญุชุงุฌ ุฅูู ุฌุนููุง ุชุชูุงุณุจ ูุน ุงูุฎูููุฉ. </font><font style="vertical-align: inherit;">ูุธุฑูุง ูุฃู ุงููุงููุฑุง ุงูุฎุงุตุฉ ุจูุง ุชุจุฏู ุฏุงุฆููุง ูู ุงูุฃุนูู ุ ูุฅู ุงูุฎูููุฉ ุฏุงุฆููุง ูุง ุชููู ุฑูุงุฏูุฉ. </font><font style="vertical-align: inherit;">ูุฅุฎุจุงุฑ ุฃุฏุงุฉ </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Terrain</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> shader ุนู </font><font style="vertical-align: inherit;">ุงูููู ุงูุฐู ูุฌุจ ุงุณุชุฎุฏุงูู ุ ุฃุถู ุฎุงุตูุฉ </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_BackgroundColor</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ ุงูุชู ูุชู </font><em><font style="vertical-align: inherit;">ุชุนููููุง</font></em><font style="vertical-align: inherit;"> ุงูุชุฑุงุถููุง ุฅูู ุงูููู ุงูุฃุณูุฏ.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs dos"> Properties { โฆ _BackgroundColor ("Background <span class="hljs-built_in"><span class="hljs-built_in">Color</span></span>", <span class="hljs-built_in"><span class="hljs-built_in">Color</span></span>) = (<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>) } โฆ half _Glossiness; fixed3 _Specular; fixed4 _Color; half3 _BackgroundColor;</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุงุณุชุฎุฏุงู ูุฐุง ุงูููู ุ ุณูุถููู ูุถูุก ููุจุนุซ ููู. </font><font style="vertical-align: inherit;">ูุชู </font></font><code>o.Emission</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุญููู ุฐูู ุนู ุทุฑูู ุชุนููู ูููุฉ ููู ุงูุฎูููุฉ ูุถุฑูุจุฉ ูู ูุงูุต ูุงุญุฏ ุชู ุงุณุชูุดุงูู.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs"> o.Occlusion = explored; o.Emission = _BackgroundColor * (1 - explored);</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุธุฑูุง ูุฃููุง ูุณุชุฎุฏู ุตูุฏูู Skybox ุงูุงูุชุฑุงุถู ุ ูุฅู ููู ุงูุฎูููุฉ ุงููุฑุฆู ููุณ ูู ููุณู ูู ุงููุงูุน. </font><font style="vertical-align: inherit;">ุจุดูู ุนุงู ุ ูููู ุงูููู ุงูุฑูุงุฏู ุงููุญูุฑ ููููุงู ูู ุฃูุถู ููู. </font><font style="vertical-align: inherit;">ุนูุฏ ุฅุนุฏุงุฏ ููุงุฏ ุงูุฅุบุงุซุฉ ุ ููููู ุงุณุชุฎุฏุงู </font><font style="vertical-align: inherit;">ุงูุฑูุฒ 68615BFF </font><font style="vertical-align: inherit;">ูู </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hex Color</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/eeb/307/7dd/eeb3077dd097a7649575a371cbb361f6.png"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุงุฏ ุงูุฅุบุงุซุฉ ุจููู ุงูุฎูููุฉ ุงูุฑูุงุฏูุฉ. </font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุดูู ุนุงู ุ ูุนูู ูุฐุง ุ ุนูู ุงูุฑุบู ูู ุฃูู ุฅุฐุง ููุช ุชุนุฑู ุฅูู ุฃูู ุชุจุญุซ ุ ุณุชูุงุญุธ ุงูุตูุฑ ุงูุธููุฉ ุถุนููุฉ ููุบุงูุฉ. </font><font style="vertical-align: inherit;">ุญุชู ูุง ูุชููู ุงููุงุนุจ ูู ุฑุคูุชูุง ุ ููููู ุชุนููู ููู ุฎูููุฉ ููุญุฏ ูุจูุบ 68615BFF ูููุงููุฑุง ุจุฏูุงู ูู skybox.</font></font><br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/7b9/8cc/ec9/7b98ccec9228ac333cc23ec19cc6f28b.png"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุงููุฑุง ุจููู ุฎูููุฉ ููุญุฏ.</font></font></i> <br><br><div class="spoiler" style=";text-align:right;direction:rtl"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุงุฐุง ูุง ุชูู ุจุฅุฒุงูุฉ ุตูุฏูู Skyboxุ</font></font></b> <div class="spoiler_text" style=";text-align:right;direction:rtl">   ,   ,     environmental lighting .     ,     . </div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุขู ูุง ูููููุง ุงูุนุซูุฑ ุนูู ุงููุฑู ุจูู ุงูุฎูููุฉ ูุงูุฎูุงูุง ุบูุฑ ุงููุณุชูุดูุฉ. </font><font style="vertical-align: inherit;">ูุง ูุฒุงู ุจุฅููุงู ุงูุชุถุงุฑูุณ ุงูุนุงููุฉ ุบูุฑ ุงูููุชุดูุฉ ุฃู ุชุญุฌุจ ุงูุชุถุงุฑูุณ ุงูููุฎูุถุฉ ุงููุณุชูุดูุฉ ุจุฒูุงูุง ุงููุงููุฑุง ุงูููุฎูุถุฉ. </font><font style="vertical-align: inherit;">ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ูุง ุชุฒุงู ุงูุฃุฌุฒุงุก ุบูุฑ ุงููุณุชูุดูุฉ ุชููู ุจุธูุงููุง ุนูู ุงููุณุชูุดู. </font><font style="vertical-align: inherit;">ูููู ูููู ุชุฌุงูู ูุฐู ุงููุฑุงุฆู ุงูุฏููุง.</font></font><br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/f88/764/d67/f88764d67aec0bf90267d273e1a248d5.png"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุฎูุงูุง ุบูุฑ ุงููุณุชูุดูุฉ ูู ุชุนุฏ ูุฑุฆูุฉ.</font></font></i> <br><br><div class="spoiler" style=";text-align:right;direction:rtl"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุงุฐุง ูู ููุช ูุง ุชุณุชุฎุฏู ููู ุฎูููุฉ ููุญุฏุ</font></font></b> <div class="spoiler_text" style=";text-align:right;direction:rtl">    ,        ,      .        .      ,          .       ,     ,  ,  UV-           . </div></div><br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุฅุฎูุงุก ูุงุฆูุงุช ุงูุฅุบุงุซุฉ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุขู ูุฏููุง ููุท ุดุจูุฉ ุงูุฅุบุงุซุฉ ุงููุฎููุฉ. </font><font style="vertical-align: inherit;">ูุง ุชุจูู ูู ุญุงูุฉ ุงูุฏุฑุงุณุฉ ูู ุชุชุฃุซุฑ ุจุนุฏ.</font></font><br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/282/c0c/a0f/282c0ca0fb55bf26ee0bb1d43cadd42f.png"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุญุชู ุงูุขู ุ ุชู ุฅุฎูุงุก ุงูุฅุบุงุซุฉ ููุท. </font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฏุนูุง ูุบูุฑ Shader </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Feature</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ ููู </font><font style="vertical-align: inherit;">ุชุธููู </font><font style="vertical-align: inherit;">ุบูุฑ ุดูุงู ูุซู </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Terrain</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">ุญูููุง ุฅูู ุชุธููู ุจุฑุงู ูุฃุถู ููู ุงูุฎูููุฉ ุฅูููุง. </font><font style="vertical-align: inherit;">ููุจุฏุฃ ุจุงูุฎุตุงุฆุต.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs nginx"> <span class="hljs-section"><span class="hljs-section">Properties</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">_Color</span></span> (<span class="hljs-string"><span class="hljs-string">"Color"</span></span>, Color) = (<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>) _MainTex (<span class="hljs-string"><span class="hljs-string">"Albedo (RGB)"</span></span>, 2D) = <span class="hljs-string"><span class="hljs-string">"white"</span></span> {} <span class="hljs-attribute"><span class="hljs-attribute">_Glossiness</span></span> (<span class="hljs-string"><span class="hljs-string">"Smoothness"</span></span>, Range(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>)) = <span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">5</span></span> // _Metallic (<span class="hljs-string"><span class="hljs-string">"Metallic"</span></span>, Range(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>)) = <span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span> _Specular (<span class="hljs-string"><span class="hljs-string">"Specular"</span></span>, Color) = (<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">2</span></span>) _BackgroundColor (<span class="hljs-string"><span class="hljs-string">"Background Color"</span></span>, Color) = (<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>) [NoScaleOffset] _GridCoordinates (<span class="hljs-string"><span class="hljs-string">"Grid Coordinates"</span></span>, 2D) = <span class="hljs-string"><span class="hljs-string">"white"</span></span> {} }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุฒูุฏ ูู ุงูุณุทุญ ูุงููุชุบูุฑุงุช ุจุฑุงุบูุง ุ ููุง ูุงู ูู ูุจู. </font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs cpp"> <span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">pragma</span></span></span><span class="hljs-meta"> surface surf StandardSpecular fullforwardshadows vertex:vert โฆ half _Glossiness; </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">// half _Metallic; fixed3 _Specular; fixed4 _Color; half3 _BackgroundColor;</span></span></span></span></code> </pre> <br> <code>visibility</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุทููุจ ูููู ูุงุญุฏ ุขุฎุฑ ุฃูุถุง. </font><font style="vertical-align: inherit;">ูุธุฑูุง ูุฃู </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูููุฒุฉ</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุชุฌูุน ุจูู ุงูุฑุคูุฉ ููู ููุฉ ุ ูุฅููุง ุชุญุชุงุฌ ููุท ุฅูู ูููุฉ ุชุนููู ูุงุญุฏุฉ. </font><font style="vertical-align: inherit;">ุงูุขู ูุญู ุจุญุงุฌุฉ ุฅูู ุงุซููู.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs swift"> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Input</span></span></span><span class="hljs-class"> </span></span>{ float2 uv_MainTex; float2 visibility; };</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ุจุชุบููุฑู </font></font><code>vert</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุญูุซ ูุณุชุฎุฏู ุจุดูู ุตุฑูุญ ูุจูุงูุงุช ุงูุฑุคูุฉ </font></font><code>data.visibility.x</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ ุซู ูู ุจุชุนููู </font></font><code>data.visibility.y</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูููุฉ ุจูุงูุงุช ุงูุฏุฑุงุณุฉ.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs kotlin"> void vert (inout appdata_full v, <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> Input <span class="hljs-keyword"><span class="hljs-keyword">data</span></span>) { โฆ float4 cellData = GetCellData(cellDataCoordinates); <span class="hljs-keyword"><span class="hljs-keyword">data</span></span>.visibility.x = cellData.x; <span class="hljs-keyword"><span class="hljs-keyword">data</span></span>.visibility.x = lerp(<span class="hljs-number"><span class="hljs-number">0.25</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">data</span></span>.visibility.x); <span class="hljs-keyword"><span class="hljs-keyword">data</span></span>.visibility.y = cellData.y; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ุจุชุบููุฑู </font></font><code>surf</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุญูุซ ูุณุชุฎุฏู ุงูุจูุงูุงุช ุงูุฌุฏูุฏุฉ ุ ูุซู </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Terrain</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs pgsql"> <span class="hljs-type"><span class="hljs-type">void</span></span> surf (<span class="hljs-keyword"><span class="hljs-keyword">Input</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">inout</span></span> SurfaceOutputStandardSpecular o) { fixed4 c = tex2D (_MainTex, <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span>.uv_MainTex) * _Color; <span class="hljs-type"><span class="hljs-type">float</span></span> explored = <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span>.visibility.y; o.Albedo = c.rgb * (<span class="hljs-keyword"><span class="hljs-keyword">IN</span></span>.visibility.x * explored); // o.Metallic = _Metallic; o.Specular = _Specular * explored; o.Smoothness = _Glossiness; o.Occlusion = explored; o.Emission = _BackgroundColor * (<span class="hljs-number"><span class="hljs-number">1</span></span> - explored); o.Alpha = ca; }</code> </pre> <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/d13/863/dc6/d13863dc60bbb92750cd5c8f8b69d82b.png"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุงุฆูุงุช ุงูุฅุบุงุซุฉ ุงููุฎููุฉ.</font></font></i> <br><br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุฅุฎูุงุก ุงูููุงู </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูููุง ููู ุชุธููู </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูููุงู</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ู </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุดุงุทุฆ ุงูููุงู</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">ููุจุฏุฃ ุจุชุญููููุง ุฅูู ุชุธููู ุจุฑุงู. </font><font style="vertical-align: inherit;">ููุน ุฐูู ุ ูุง ูุญุชุงุฌูู ุฅูู ููู ุฎูููุฉ ูุฃููู ุชุธููู ุดูุงู. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุนุฏ ุงูุชุญููู ุ ุฃุถู </font></font><code>visibility</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูููููุง ุขุฎุฑ ููู ุจุชุบููุฑู ููููุง ูุฐูู </font></font><code>vert</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ูุฌูุน ููุง ุงูุธูุงู ุจูุงูุงุช ูู ุซูุงุซ ุฎูุงูุง.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs dos"> struct Input { โฆ float2 visibility; }; โฆ void vert (inout appdata_full v, out Input data) { โฆ data.visibility.x = cell0.x * v.<span class="hljs-built_in"><span class="hljs-built_in">color</span></span>.x + cell1.x * v.<span class="hljs-built_in"><span class="hljs-built_in">color</span></span>.y + cell2.x * v.<span class="hljs-built_in"><span class="hljs-built_in">color</span></span>.z; data.visibility.x = lerp(<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">25</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, data.visibility.x); data.visibility.y = cell0.y * v.<span class="hljs-built_in"><span class="hljs-built_in">color</span></span>.x + cell1.y * v.<span class="hljs-built_in"><span class="hljs-built_in">color</span></span>.y + cell2.y * v.<span class="hljs-built_in"><span class="hljs-built_in">color</span></span>.z; }</code> </pre> <br> <em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชููู Water</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Water Shore</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุจุนูููุงุช </font></font><code>surf</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฎุชููุฉ ุ ูููููุง ุชุญุฏุฏ ุฎุตุงุฆุตูุง ุงูุณุทุญูุฉ ุจููุณ ุงูุทุฑููุฉ. </font><font style="vertical-align: inherit;">ูุธุฑูุง ูุฃููุง ุดูุงูุฉ ุ ุณูุฃุฎุฐ ูู ุงูุงุนุชุจุงุฑ </font></font><code>explore</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ููุงุฉ ุฃููุง ุ ููู ูููู ุจุชุนููู ุงูุงูุจุนุงุซุงุช.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs pgsql"> <span class="hljs-type"><span class="hljs-type">void</span></span> surf (<span class="hljs-keyword"><span class="hljs-keyword">Input</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">inout</span></span> SurfaceOutputStandardSpecular o) { โฆ <span class="hljs-type"><span class="hljs-type">float</span></span> explored = <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span>.visibility.y; o.Albedo = c.rgb * <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span>.visibility.x; o.Specular = _Specular * explored; o.Smoothness = _Glossiness; o.Occlusion = explored; o.Alpha = ca * explored; }</code> </pre> <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/15a/e39/390/15ae39390ccbe91f3d12f068992a7c14.png"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูููุงู ุงูุฎููุฉ.</font></font></i> <br><br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุฎูู ูุตุจุงุช ุงูุฃููุงุฑ ูุงูุฃููุงุฑ ูุงูุทุฑู </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจูููุง ุชุธููู </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุตุจ</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุฑ</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ู </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงููุตู ุงูุทุฑูู ุงูุนุงู</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">ุงูุซูุงุซุฉ ุฌููุนูุง ุดูุงูุฉ ูุชุฌูุน ุจูุงูุงุช ุฎููุชูู. </font><font style="vertical-align: inherit;">ูู ุจุชุญููููุง ุฌููุนูุง ุฅูู specular ุ ุซู ุฃุถููุง ุฅูู </font></font><code>visibility</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจูุงูุงุช ุงูุจุญุซ.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs kotlin"> struct Input { โฆ float2 visibility; }; โฆ void vert (inout appdata_full v, <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> Input <span class="hljs-keyword"><span class="hljs-keyword">data</span></span>) { โฆ <span class="hljs-keyword"><span class="hljs-keyword">data</span></span>.visibility.x = cell0.x * v.color.x + cell1.x * v.color.y; <span class="hljs-keyword"><span class="hljs-keyword">data</span></span>.visibility.x = lerp(<span class="hljs-number"><span class="hljs-number">0.25</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">data</span></span>.visibility.x); <span class="hljs-keyword"><span class="hljs-keyword">data</span></span>.visibility.y = cell0.y * v.color.x + cell1.y * v.color.y; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุนุฏูู ุงูุฏุงูุฉ </font></font><code>surf</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุธููู </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุตุจ</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ู </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุฑ</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุจุญูุซ ูุณุชุฎุฏู ุงูุจูุงูุงุช ุงูุฌุฏูุฏุฉ. </font><font style="vertical-align: inherit;">ููุงููุง ุจุญุงุฌุฉ ุฅูู ุฅุฌุฑุงุก ููุณ ุงูุชุบููุฑุงุช.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs pgsql"> <span class="hljs-type"><span class="hljs-type">void</span></span> surf (<span class="hljs-keyword"><span class="hljs-keyword">Input</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">inout</span></span> SurfaceOutputStandardSpecular o) { โฆ <span class="hljs-type"><span class="hljs-type">float</span></span> explored = <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span>.visibility.y; fixed4 c = saturate(_Color + water); o.Albedo = c.rgb * <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span>.visibility.x; o.Specular = _Specular * explored; o.Smoothness = _Glossiness; o.Occlusion = explored; o.Alpha = ca * explored; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฎุชูู </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุทุฑูู</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Shader </font><font style="vertical-align: inherit;">ููููุงู ูุฃูู ูุณุชุฎุฏู ูููุงุณ ูุฒุฌ ุฅุถุงูู.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs pgsql"> <span class="hljs-type"><span class="hljs-type">void</span></span> surf (<span class="hljs-keyword"><span class="hljs-keyword">Input</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">inout</span></span> SurfaceOutputStandardSpecular o) { <span class="hljs-type"><span class="hljs-type">float4</span></span> noise = tex2D(_MainTex, <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span>.worldPos.xz * <span class="hljs-number"><span class="hljs-number">0.025</span></span>); fixed4 c = _Color * ((noise.y * <span class="hljs-number"><span class="hljs-number">0.75</span></span> + <span class="hljs-number"><span class="hljs-number">0.25</span></span>) * <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span>.visibility.x); <span class="hljs-type"><span class="hljs-type">float</span></span> blend = <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span>.uv_MainTex.x; blend *= noise.x + <span class="hljs-number"><span class="hljs-number">0.5</span></span>; blend = smoothstep(<span class="hljs-number"><span class="hljs-number">0.4</span></span>, <span class="hljs-number"><span class="hljs-number">0.7</span></span>, blend); <span class="hljs-type"><span class="hljs-type">float</span></span> explored = <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span>.visibility.y; o.Albedo = c.rgb; o.Specular = _Specular * explored; o.Smoothness = _Glossiness; o.Occlusion = explored; o.Alpha = blend * explored; }</code> </pre> <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/1c6/1d2/c65/1c61d2c652b436385b42188c39476c14.png"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ุดูุก ูุฎูู. </font></font></i> <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุญุฒูุฉ ุงููุญุฏุฉ</font></font></a> <br><br><h2 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุชุฌูุจ ุงูุฎูุงูุง ุบูุฑ ุงููุณุชูุดูุฉ </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุนูู ุงูุฑุบู ูู ุฃู ูู ุดูุก ุบูุฑ ูุนุฑูู ูุฎูู ุจุตุฑููุง ุ ูู ุญูู ุฃู ุญุงูุฉ ุงูุฏุฑุงุณุฉ ูุง ุชุคุฎุฐ ูู ุงูุงุนุชุจุงุฑ ุนูุฏ ุงูุจุญุซ ุนู ูุณุงุฑ. </font><font style="vertical-align: inherit;">ููุชูุฌุฉ ูุฐูู ุ ูููู ุฃู ุชุฃูุฑ ุงููุญุฏุงุช ุจุงูุชุญุฑู ูู ุฎูุงู ุงูุฎูุงูุง ุบูุฑ ุงููุณุชูุดูุฉ ูุนุจุฑูุง ุ ูุชุญุฏูุฏ ุทุฑููุฉ ุงูุชููู ุจุทุฑููุฉ ุณุญุฑูุฉ. </font><font style="vertical-align: inherit;">ูุญู ุจุญุงุฌุฉ ุฅูู ููุฉ ุงููุญุฏุงุช ูุชุฌูุจ ุงูุฎูุงูุง ุบูุฑ ุงููุณุชูุดูุฉ.</font></font><br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/ca9/eb9/f22/ca9eb9f22cd36b917bd5f0c38028bce7.png"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุชููู ูู ุงูุฎูุงูุง ุบูุฑ ุงููุณุชูุดูุฉ.</font></font></i> <br><br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุชุญุฏุฏ ุงููุฑู ุชูููุฉ ุงูููู </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุจู ูุนุงูุฌุฉ ุงูุฎูุงูุง ุบูุฑ ุงููุณุชูุดูุฉ ุ ุฏุนูุง ูุนูุฏ ุงูุฑูุฒ ูููู ุชูููุฉ ุงูุงูุชูุงู ูู </font></font><code>HexGrid</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅูู </font></font><code>HexUnit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ุณูุคุฏู ุฐูู ุฅูู ุชุจุณูุท ุงูุฏุนู ูููุญุฏุงุช ุฐุงุช ููุงุนุฏ ุงูุญุฑูุฉ ุงููุฎุชููุฉ. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃุถู ุฅูู </font></font><code>HexUnit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุทุฑููุฉ ุงูุนุงูุฉ </font></font><code>GetMoveCost</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุชุญุฏูุฏ ุชูููุฉ ุงูููู. </font><font style="vertical-align: inherit;">ุฅูู ุจุญุงุฌุฉ ุฅูู ูุนุฑูุฉ ุงูุฎูุงูุง ุงูุชู ุชุชุญุฑู ุจูููุง ุ ููุฐูู ุงูุงุชุฌุงู. </font><font style="vertical-align: inherit;">ูููู ุจูุณุฎ ุงูููุฏ ุงูููุงุจู ูุชูุงููู ุงูุงูุชูุงู ูู </font></font><code>HexGrid.Search</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฐู ุงูุทุฑููุฉ ูุชุบููุฑ ุฃุณูุงุก ุงููุชุบูุฑุงุช.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetMoveCost</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> HexCell fromCell, HexCell toCell, HexDirection direction</span></span></span><span class="hljs-function">)</span></span> { HexEdgeType edgeType = fromCell.GetEdgeType(toCell); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (edgeType == HexEdgeType.Cliff) { <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> moveCost; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (fromCell.HasRoadThroughEdge(direction)) { moveCost = <span class="hljs-number"><span class="hljs-number">1</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (fromCell.Walled != toCell.Walled) { <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { moveCost = edgeType == HexEdgeType.Flat ? <span class="hljs-number"><span class="hljs-number">5</span></span> : <span class="hljs-number"><span class="hljs-number">10</span></span>; moveCost += toCell.UrbanLevel + toCell.FarmLevel + toCell.PlantLevel; } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฌุจ ุฃู ุชุนูุฏ ุงูุทุฑููุฉ ุชูููุฉ ุงูููู. </font><font style="vertical-align: inherit;">ุงุณุชุฎุฏูุช ุงูุฑูุฒ ุงููุฏูู ูุชุฎุทู ุงูุชุญุฑูุงุช ุบูุฑ ุงูุตุงูุญุฉ </font></font><code>continue</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ ูููู ูุฐุง ุงูููุฌ ูู ูุนูู ููุง. </font><font style="vertical-align: inherit;">ุฅุฐุง ูุงูุช ุงูุญุฑูุฉ ุบูุฑ ููููุฉ ุ ูุณูุนูุฏ ุงูุชูุงููู ุงูุณูุจูุฉ ููุชุญุฑู.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetMoveCost</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> HexCell fromCell, HexCell toCell, HexDirection direction</span></span></span><span class="hljs-function">)</span></span> { HexEdgeType edgeType = fromCell.GetEdgeType(toCell); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (edgeType == HexEdgeType.Cliff) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">-1</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> moveCost; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (fromCell.HasRoadThroughEdge(direction)) { moveCost = <span class="hljs-number"><span class="hljs-number">1</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (fromCell.Walled != toCell.Walled) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">-1</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { moveCost = edgeType == HexEdgeType.Flat ? <span class="hljs-number"><span class="hljs-number">5</span></span> : <span class="hljs-number"><span class="hljs-number">10</span></span>; moveCost += toCell.UrbanLevel + toCell.FarmLevel + toCell.PlantLevel; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> moveCost; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุขู ูุญู ุจุญุงุฌุฉ ุฅูู ูุนุฑูุฉ ุนูุฏ ุงูุนุซูุฑ ุนูู ุงููุณุงุฑ ุ ููุณ ููุท ุงูุณุฑุนุฉ ุ ูููู ุฃูุถูุง ุงููุญุฏุฉ ุงููุญุฏุฏุฉ. </font><font style="vertical-align: inherit;">ุญุณุจ ุงูุชุบููุฑ </font></font><code>HexGameUI.DoPathFinding</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">DoPathfinding</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (UpdateCurrentCell()) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (currentCell &amp;&amp; selectedUnit.IsValidDestination(currentCell)) { grid.FindPath(selectedUnit.Location, currentCell, selectedUnit); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { grid.ClearPath(); } } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุธุฑูุง ูุฃููุง ูุง ุฒููุง ุจุญุงุฌุฉ ุฅูู ุงููุตูู ุฅูู ุณุฑุนุฉ ุงููุฑูู ุ ูุณูุถูู ุฅูู </font></font><code>HexUnit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงููููุน </font></font><code>Speed</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ุจูููุง ุณุชุนูุฏ ุจูููุฉ ุซุงุจุชุฉ 24.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> Speed { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">24</span></span>; } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ู </font></font><code>HexGrid</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุชุบููุฑ </font></font><code>FindPath</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ ู </font></font><code>Search</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุญุชู ูุชููููุง ูู ุงูุนูู ูุน ููุฌูุง ุงูุฌุฏูุฏ.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FindPath</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">HexCell fromCell, HexCell toCell, HexUnit unit</span></span></span><span class="hljs-function">)</span></span> { ClearPath(); currentPathFrom = fromCell; currentPathTo = toCell; currentPathExists = Search(fromCell, toCell, unit); ShowPath(unit.Speed); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Search</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">HexCell fromCell, HexCell toCell, HexUnit unit</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> speed = unit.Speed; โฆ }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุขู ุณูุฒูู ูู </font></font><code>Search</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูููุฏ ุงููุฏูู ุงูุฐู ุญุฏุฏ ูุง ุฅุฐุง ูุงู ูู ุงููููู ุงูุงูุชูุงู ุฅูู ุงูุฎููุฉ ุงูุชุงููุฉ ููุง ูู ุชูุงููู ุงูููู. </font><font style="vertical-align: inherit;">ุจุฏูุง ูู ุฐูู ุ ุณูุชุตู </font></font><code>HexUnit.IsValidDestination</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ู </font></font><code>HexUnit.GetMoveCost</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ุณูู ูุชุฎุทู ุงูุฎููุฉ ุฅุฐุง ูุงูุช ุชูููุฉ ุงูููู ุณุงูุจุฉ.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (HexDirection d = HexDirection.NE; d &lt;= HexDirection.NW; d++) { HexCell neighbor = current.GetNeighbor(d); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( neighbor == <span class="hljs-literal"><span class="hljs-literal">null</span></span> || neighbor.SearchPhase &gt; searchFrontierPhase ) { <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; } <span class="hljs-comment"><span class="hljs-comment">// if (neighbor.IsUnderwater || neighbor.Unit) { // continue; // } // HexEdgeType edgeType = current.GetEdgeType(neighbor); // if (edgeType == HexEdgeType.Cliff) { // continue; // } // int moveCost; // if (current.HasRoadThroughEdge(d)) { // moveCost = 1; // } // else if (current.Walled != neighbor.Walled) { // continue; // } // else { // moveCost = edgeType == HexEdgeType.Flat ? 5 : 10; // moveCost += neighbor.UrbanLevel + neighbor.FarmLevel + // neighbor.PlantLevel; // } if (!unit.IsValidDestination(neighbor)) { continue; } int moveCost = unit.GetMoveCost(current, neighbor, d); if (moveCost &lt; 0) { continue; } int distance = current.Distance + moveCost; int turn = (distance - 1) / speed; if (turn &gt; currentTurn) { distance = turn * speed + moveCost; } โฆ }</span></span></code> </pre> <br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุชุฌุงูุฒ ุงูููุงุทู ุบูุฑ ุงููุณุชูุดูุฉ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุชุฌูุจ ุงูุฎูุงูุง ุบูุฑ ุงููุณุชูุดูุฉ ุ ูููู ููุง ุงูุชุฃูุฏ ูู </font></font><code>HexUnit.IsValidDestination</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุชุญูู ููุง ุฅุฐุง ูุงูุช ุงูุฎููุฉ ูุฏ ุชู ูุญุตูุง.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">IsValidDestination</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">HexCell cell</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> cell.IsExplored &amp;&amp; !cell.IsUnderwater &amp;&amp; !cell.Unit; }</code> </pre> <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/a84/831/2c6/a848312c6231a168a966e4cdafc2df38.png"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ุชุชููู ุงููุฒูุฏ ูู ุงููุญุฏุงุช ูู ุงููุตูู ุฅูู ุงูุฎูุงูุง ุบูุฑ ุงูููุชุดูุฉ. </font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุธุฑูุง ูุฃู ุงูุฎูุงูุง ุบูุฑ ุงูููุชุดูุฉ ูู ุชุนุฏ ููุงุทูุง ููุงุฆูุฉ ุตุงูุญุฉ ุ ุณุชุชุฌูุจูุง ุงููุฑู ุนูุฏ ุงูุงูุชูุงู ุฅูู ููุทุฉ ุงูููุงูุฉ. </font><font style="vertical-align: inherit;">ุฃู ุฃู ุงูููุงุทู ุบูุฑ ุงููุณุชูุดูุฉ ุชุนูู ูุญูุงุฌุฒ ุชุทูู ุงููุณุงุฑ ุฃู ุชุฌุนูู ูุณุชุญููุงู. </font><font style="vertical-align: inherit;">ุณูุชุนูู ุนูููุง ุชูุฑูุจ ุงููุญุฏุงุช ูู ููุทูุฉ ุบูุฑ ูุนุฑููุฉ ูุงุณุชูุดุงู ุงูููุทูุฉ ุฃููุงู.</font></font><br><br><div class="spoiler" style=";text-align:right;direction:rtl"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุงุฐุง ูู ุธูุฑ ูุณุงุฑ ุฃูุตุฑ ุฃุซูุงุก ุงูุญุฑูุฉุ</font></font></b> <div class="spoiler_text" style=";text-align:right;direction:rtl">                .           ,        .       . <br><br>   ,        ,            .            ,    . </div></div><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุญุฒูุฉ ุงููุญุฏุฉ</font></font></a> <br><br><h1 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงูุฌุฒุก 22: ุฑุคูุฉ ูุญุณูุฉ </font></font></h1><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุชุบููุฑ ุงูุฑุคูุฉ ุจุณูุงุณุฉ. </font></font></li><li style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงุณุชุฎุฏู ุงุฑุชูุงุน ุงูุฎููุฉ ูุชุญุฏูุฏ ุงููุทุงู. </font></font></li><li style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุฅุฎูุงุก ุญุงูุฉ ุงูุฎุฑูุทุฉ. </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูู ุฎูุงู ุฅุถุงูุฉ ุฏุนู ูุงุณุชูุดุงู ุงูุฎุฑุงุฆุท ุ ุณูุนูู ุนูู ุชุญุณูู ุงูุญุณุงุจุงุช ูุงูุงูุชูุงูุงุช ูู ุงููุทุงู. </font></font><br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/2d2/c4a/793/2d2c4a7939e75fe09298f96ff6125478.jpg"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฑุคูุฉ ุงููุฒูุฏ ุ ุชุณูู ุฃุนูู.</font></font></i> <br><br><h2 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงูุชูุงูุงุช ุงูุฑุคูุฉ </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุฎููุฉ ุฅูุง ูุฑุฆูุฉ ุฃู ุบูุฑ ูุฑุฆูุฉ ุ ูุฃููุง ุฅูุง ูู ูุทุงู ููุฑุฒุฉ ุฃู ูุง. </font><font style="vertical-align: inherit;">ุญุชู ุฅุฐุง ูุงู ูุจุฏู ุฃู ุงูุฃูุฑ ูุณุชุบุฑู ูุญุฏุฉ ูู ุงูููุช ููุชููู ุจูู ุงูุฎูุงูุง ุ ูุฅู ูุทุงููุง ููุชูู ูู ุฎููุฉ ุฅูู ุฃุฎุฑู ุนูู ุงูููุฑ. </font><font style="vertical-align: inherit;">ููุชูุฌุฉ ูุฐูู ุ ุชุชุบูุฑ ุฑุคูุฉ ุงูุฎูุงูุง ุงููุญูุทุฉ ุจุดูู ูุจูุฑ. </font><font style="vertical-align: inherit;">ุชุจุฏู ุญุฑูุฉ ุงููุฑูุฉ ุณูุณุฉ ุ ููู ุงูุชุบููุฑุงุช ูู ุงูุฑุคูุฉ ููุงุฌุฆุฉ. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ุงููุงุญูุฉ ุงููุซุงููุฉ ุ ูุฌุจ ุฃู ุชุชุบูุฑ ุงูุฑุคูุฉ ุฃูุถูุง ุจุณูุงุณุฉ. </font><font style="vertical-align: inherit;">ูุฑุฉ ูุงุญุฏุฉ ูู ูุฌุงู ุงูุฑุคูุฉ ุ ูุฌุจ ุฃู ุชุถูุก ุงูุฎูุงูุง ุชุฏุฑูุฌูุง ุ ูุชุฑููุง ุ ูุชุงูุฉ ุชุฏุฑูุฌูุง. </font><font style="vertical-align: inherit;">ุฃู ุฑุจูุง ุชูุถู ุงูุชุญููุงุช ุงูููุฑูุฉุ </font><font style="vertical-align: inherit;">ุฏุนูุง ูุถูู ุฅูู </font></font><code>HexCellShaderData</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุฎุงุตูุฉ ุงูุชู ุชููู ุจุชุจุฏูู ุงูุชุญููุงุช ุงูููุฑูุฉ. </font><font style="vertical-align: inherit;">ุจุดูู ุงูุชุฑุงุถู ุ ุณุชููู ุงูุงูุชูุงูุงุช ุณูุณุฉ.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> ImmediateMode { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; }</code> </pre> <br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุชุชุจุน ุงูุฎููุฉ ุงูุงูุชูุงููุฉ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุญุชู ุนูุฏ ุนุฑุถ ุงูุชุญููุงุช ุงูุณูุณุฉ ุ ุชุธู ุจูุงูุงุช ุงูุฑุคูุฉ ุงูุญููููุฉ ุซูุงุฆูุฉ ุ ุฃู ุฃู ุงูุชุฃุซูุฑ ูุฑุฆู ููุท. </font><font style="vertical-align: inherit;">ูุฐุง ูุนูู ุฃูู ูุฌุจ ุงูุชุนุงูู ูุน ุงูุชูุงูุงุช ุงูุฑุคูุฉ </font></font><code>HexCellShaderData</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ุณููุฏู ููุง ูุงุฆูุฉ ุจุงูุฎูุงูุง ุงูุชู ูุชู ูููุง ุฅุฌุฑุงุก ุงูุงูุชูุงู. </font><font style="vertical-align: inherit;">ุชุฃูุฏ ูู ุฃููุง ูุงุฑุบุฉ ุนูุฏ ูู ุชููุฆุฉ.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections.Generic; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEngine; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">HexCellShaderData</span></span> : <span class="hljs-title"><span class="hljs-title">MonoBehaviour</span></span> { Texture2D cellTexture; Color32[] cellTextureData; List&lt;HexCell&gt; transitioningCells = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> List&lt;HexCell&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> ImmediateMode { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Initialize</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> x, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> z</span></span></span><span class="hljs-function">)</span></span> { โฆ transitioningCells.Clear(); enabled = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } โฆ }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ุงูููุช ุงูุญุงูู ุ ูููู ุจุชุนููู ุจูุงูุงุช ุงูุฎููุฉ </font></font><code>RefreshVisibility</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุจุงุดุฑุฉ. </font><font style="vertical-align: inherit;">ูุง ูุฒุงู ูุฐุง ุตุญูุญูุง ููุถุน ุงูุงูุชูุงู ุงูููุฑู ุ ูููู ุนูุฏูุง ูุชู ุชุนุทููู ุ ูุฌุจ ุฃู ูุถูู ุฎููุฉ ุฅูู ูุงุฆูุฉ ุงูุฎูุงูุง ุงูุงูุชูุงููุฉ.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RefreshVisibility</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">HexCell cell</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> index = cell.Index; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ImmediateMode) { cellTextureData[index].r = cell.IsVisible ? (<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>)<span class="hljs-number"><span class="hljs-number">255</span></span> : (<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>)<span class="hljs-number"><span class="hljs-number">0</span></span>; cellTextureData[index].g = cell.IsExplored ? (<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>)<span class="hljs-number"><span class="hljs-number">255</span></span> : (<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>)<span class="hljs-number"><span class="hljs-number">0</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { transitioningCells.Add(cell); } enabled = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุจุฏู ุฃู ุงูุฑุคูุฉ ูู ุชุนุฏ ุชุนูู ุ ูุฃููุง ูู ุงูููุช ุงูุญุงูู ูุง ููุนู ุฃู ุดูุก ูุน ุงูุฎูุงูุง ูู ุงููุงุฆูุฉ. </font></font><br><br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุญููุฉ ุนุจุฑ ุงูุฎูุงูุง ูู ุญููุฉ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุฏูุงู ูู ุชุนููู ุงูููู ุงูููุงุจูุฉ ุนูู ุงูููุฑ ุฅูู 255 ุฃู 0 ุ ุณูููู ุจุฒูุงุฏุฉ / ุชูููู ูุฐู ุงูููู ุชุฏุฑูุฌููุง. </font><font style="vertical-align: inherit;">ุชุนุชูุฏ ุณูุงุณุฉ ุงูุงูุชูุงู ุนูู ูุนุฏู ุงูุชุบููุฑ. </font><font style="vertical-align: inherit;">ูุง ูุฌุจ ุฃู ุชููู ุณุฑูุนุฉ ุฌุฏูุง ูููุณุช ุจุทูุฆุฉ ุฌุฏูุง. </font><font style="vertical-align: inherit;">ุญู ูุณุท ุฌูุฏ ุจูู ุงูุชุญููุงุช ุงูุฌูููุฉ ูุฑุงุญุฉ ุงููุนุจุฉ ูู ุงูุชุบููุฑ ูู ุบุถูู ุซุงููุฉ ูุงุญุฏุฉ. </font><font style="vertical-align: inherit;">ุฏุนูุง ูุถุน ุซุงุจุชูุง ููุฐุง ูุชุณููู ุงูุชุบููุฑ.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> transitionSpeed = <span class="hljs-number"><span class="hljs-number">255f</span></span>;</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุขู </font></font><code>LateUpdate</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูููููุง ุชุญุฏูุฏ ุฏูุชุง ุงููุทุจูุฉ ุนูู ุงูููู. </font><font style="vertical-align: inherit;">ููููุงู ุจุฐูู ุ ุงุถุฑุจ ุฏูุชุง ุงูููุช ุจุงูุณุฑุนุฉ. </font><font style="vertical-align: inherit;">ูุฌุจ ุฃู ูููู ุนุฏุฏูุง ุตุญูุญูุง ูุฃููุง ูุง ูุนุฑู ุญุฌูู. </font><font style="vertical-align: inherit;">ูููู ุฃู ูุคุฏู ุงูุงูุฎูุงุถ ุงูุญุงุฏ ูู ูุนุฏู ุงูุฅุทุงุฑุงุช ุฅูู ุฌุนู ุงูุฏูุชุง ุฃูุซุฑ ูู 255. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ูุญุชุงุฌ ุฅูู ุงูุชุญุฏูุซ ุฃุซูุงุก ูุฌูุฏ ุฎูุงูุง ุงูุชูุงููุฉ. </font><font style="vertical-align: inherit;">ูุฐูู ุ ูุฌุจ ุชุถููู ุงูุฑูุฒ ุฃุซูุงุก ูุฌูุฏ ุดูุก ูู ุงููุงุฆูุฉ.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">LateUpdate</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> delta = (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)(Time.deltaTime * transitionSpeed); cellTexture.SetPixels32(cellTextureData); cellTexture.Apply(); enabled = transitioningCells.Count &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃูุถุง ูู ุงููุงุญูุฉ ุงููุธุฑูุฉ ูุนุฏูุงุช ุงูุฅุทุงุฑ ุนุงููุฉ ุฌุฏุง. </font><font style="vertical-align: inherit;">ุจุงูุงูุชุฑุงู ูุน ุณุฑุนุฉ ุงูุชูุงู ููุฎูุถุฉ ุ ูููู ุฃู ูุนุทููุง ูุฐุง ุฏูุชุง 0. ููู ูุญุฏุซ ุงูุชุบููุฑ ุ ููุฑุถ ุฃู ูููู ุงูุญุฏ ุงูุฃุฏูู ููุฏูุชุง 1.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> delta = (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)(Time.deltaTime * transitionSpeed); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (delta == <span class="hljs-number"><span class="hljs-number">0</span></span>) { delta = <span class="hljs-number"><span class="hljs-number">1</span></span>; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุนุฏ ุชููู ุงูุฏูุชุง ุ ูููููุง ุงูุงูุชูุงู ุญูู ุฌููุน ุงูุฎูุงูุง ุงูุงูุชูุงููุฉ ูุชุญุฏูุซ ุจูุงูุงุชูุง. </font><font style="vertical-align: inherit;">ูููุชุฑุถ ุฃู ูุฏููุง ุทุฑููุฉ ูุฐูู </font></font><code>UpdateCellData</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ ููุนููุงุชูุง ูู ุงูุฎููุฉ ุงูููุงุจูุฉ ูุงูุฏูุชุง.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> delta = (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)(Time.deltaTime * transitionSpeed); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (delta == <span class="hljs-number"><span class="hljs-number">0</span></span>) { delta = <span class="hljs-number"><span class="hljs-number">1</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; transitioningCells.Count; i++) { UpdateCellData(transitioningCells[i], delta); }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ูุฑุญูุฉ ูุง ุ ูุฌุจ ุฃู ููุชูู ุงูุชูุงู ุงูุฎููุฉ. </font><font style="vertical-align: inherit;">ุงูุชุฑุถ ุฃู ุงูุทุฑููุฉ ุชููู ุจุฅุฑุฌุงุน ูุนูููุงุช ุญูู ูุง ุฅุฐุง ูุงู ุงูุงูุชูุงู ูุง ูุฒุงู ูุณุชูุฑูุง. </font><font style="vertical-align: inherit;">ุนูุฏูุง ุชุชููู ุ ูููููุง ุฅุฒุงูุฉ ุงูุฎููุฉ ูู ุงููุงุฆูุฉ. </font><font style="vertical-align: inherit;">ุจุนุฏ ุฐูู ุ ูุฌุจ ุนูููุง ุฅููุงุต ุงูููุฑุฑ ุญุชู ูุง ูุชุฎุทู ุงูุฎูุงูุง.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; transitioningCells.Count; i++) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!UpdateCellData(transitioningCells[i], delta)) { transitioningCells.RemoveAt(i--); } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุชุฑุชูุจ ุงูุฐู ุชุชู ููู ูุนุงูุฌุฉ ุงูุฎูุงูุง ุงูุงูุชูุงููุฉ ููุณ ููููุง. </font><font style="vertical-align: inherit;">ูุฐูู ุ ูุง ูุชุนูู ุนูููุง ุญุฐู ุงูุฎููุฉ ูู ุงูููุฑุณ ุงูุญุงูู ุ ููุง ุณูุฌุจุฑ </font></font><code>RemoveAt</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฌููุน ุงูุฎูุงูุง </font><font style="vertical-align: inherit;">ุนูู </font><font style="vertical-align: inherit;">ุงูุชุญุฑู ุจุนุฏูุง. </font><font style="vertical-align: inherit;">ุจุฏูุงู ูู ุฐูู ุ ูููู ุงูุฎููุฉ ุงูุฃุฎูุฑุฉ ุฅูู ุงูููุฑุณ ุงูุญุงูู ุ ุซู ูุญุฐู ุงูุฎููุฉ ุงูุฃุฎูุฑุฉ.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!UpdateCellData(transitioningCells[i], delta)) { transitioningCells[i--] = transitioningCells[transitioningCells.Count - <span class="hljs-number"><span class="hljs-number">1</span></span>]; transitioningCells.RemoveAt(transitioningCells.Count - <span class="hljs-number"><span class="hljs-number">1</span></span>); }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุขู ุนูููุง ุฅูุดุงุก ุทุฑููุฉ </font></font><code>UpdateCellData</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ููููุงู ุจุนููู ุ ุณูุญุชุงุฌ ุฅูู ููุฑุณ ูุจูุงูุงุช ุงูุฎููุฉ ุ ูุฐูู ุฏุนููุง ูุจุฏุฃ ุจุงูุญุตูู ุนูููุง. </font><font style="vertical-align: inherit;">ูุฌุจ ุฃู ุชุญุฏุฏ ุฃูุถูุง ูุง ุฅุฐุง ูุงูุช ุณุชุณุชูุฑ ูู ุชุญุฏูุซ ุงูุฎููุฉ. </font><font style="vertical-align: inherit;">ุงูุชุฑุงุถููุง ุ ุณููุชุฑุถ ุฃูู ููุณ ุถุฑูุฑููุง. </font><font style="vertical-align: inherit;">ุจุนุฏ ุงูุงูุชูุงุก ูู ุงูุนูู ุ ูู ุงูุถุฑูุฑู ุชุทุจูู ุงูุจูุงูุงุช ุงูุชู ุชู ุชุบููุฑูุง ูุฅุนุงุฏุฉ ุงูุญุงูุฉ "ุงูุชุญุฏูุซ ูุณุชูุฑ".</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">UpdateCellData</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">HexCell cell, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> delta</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> index = cell.Index; Color32 data = cellTextureData[index]; <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> stillUpdating = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; cellTextureData[index] = data; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> stillUpdating; }</code> </pre> <br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุชุญุฏูุซ ุจูุงูุงุช ุงูุฎููุฉ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ูุฐู ุงููุฑุญูุฉ ุ ูุฏููุง ุฎููุฉ ูู ูุฑุญูุฉ ุงูุชูุงู ุฃู ุฃูููุช ุจุงููุนู. </font><font style="vertical-align: inherit;">ุฃููุงู ุ ุฏุนูุง ูุชุญูู ูู ุญุงูุฉ ูุณุจุงุฑ ุงูุฎููุฉ. </font><font style="vertical-align: inherit;">ุฅุฐุง ุชู ูุญุต ุงูุฎููุฉ ุ ูููู ูููุฉ G ุงูุฎุงุตุฉ ุจูุง ูุง ุชุณุงูู 255 ุจุนุฏ ุ ููู ูู ุนูููุฉ ุงูุชูุงู ุ ูุฐูู ุณูุฑุงูุจ ุฐูู.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> stillUpdating = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (cell.IsExplored &amp;&amp; data.g &lt; <span class="hljs-number"><span class="hljs-number">255</span></span>) { stillUpdating = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } cellTextureData[index] = data;</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฅุฌุฑุงุก ุงูุงูุชูุงู ุ ุณูุถูู ุฏูุชุง ุฅูู ูููุฉ G ููุฎููุฉ. </font><font style="vertical-align: inherit;">ูุง ุชุนูู ุงูุนูููุงุช ุงูุญุณุงุจูุฉ ูุน ูุญุฏุงุช ุงูุจุงูุช ุ ูุชู ุชุญููููุง ุฃููุงู ุฅูู ุนุฏุฏ ุตุญูุญ. </font><font style="vertical-align: inherit;">ูุฐูู ุ ุณูููู ุงููุฌููุน ุจุชูุณูู ุตุญูุญ ุ ูุงูุฐู ูุฌุจ ุชุญูููู ุฅูู ุจุงูุช.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (cell.IsExplored &amp;&amp; data.g &lt; <span class="hljs-number"><span class="hljs-number">255</span></span>) { stillUpdating = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> t = data.g + delta; data.g = (<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>)t; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูููู ูุจู ุงูุชุญููู ุ ุชุญุชุงุฌ ุฅูู ุงูุชุฃูุฏ ูู ุฃู ุงููููุฉ ูุง ุชุชุฌุงูุฒ 255. </font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> t = data.g + delta; data.g = t &gt;= <span class="hljs-number"><span class="hljs-number">255</span></span> ? (<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>)<span class="hljs-number"><span class="hljs-number">255</span></span> : (<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>)t;</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุจุนุฏ ุฐูู ุ ูุญุชุงุฌ ุฅูู ุงูููุงู ุจููุณ ุงูุดูุก ูู ุฃุฌู ุงูุฑุคูุฉ ุ ุงูุชู ุชุณุชุฎุฏู ูููุฉ R. </font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (cell.IsExplored &amp;&amp; data.g &lt; <span class="hljs-number"><span class="hljs-number">255</span></span>) { โฆ } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (cell.IsVisible &amp;&amp; data.r &lt; <span class="hljs-number"><span class="hljs-number">255</span></span>) { stillUpdating = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> t = data.r + delta; data.r = t &gt;= <span class="hljs-number"><span class="hljs-number">255</span></span> ? (<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>)<span class="hljs-number"><span class="hljs-number">255</span></span> : (<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>)t; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุธุฑูุง ูุฃู ุงูุฎููุฉ ูููู ุฃู ุชุตุจุญ ุบูุฑ ูุฑุฆูุฉ ูุฑุฉ ุฃุฎุฑู ุ ูุญุชุงุฌ ุฅูู ุงูุชุญูู ููุง ุฅุฐุง ูุงู ูู ุงูุถุฑูุฑู ุชูููู ูููุฉ R. ูุญุฏุซ ูุฐุง ุนูุฏูุง ุชููู ุงูุฎููุฉ ุบูุฑ ูุฑุฆูุฉ ุ ูููู R ุฃูุจุฑ ูู ุงูุตูุฑ. </font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (cell.IsVisible) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (data.r &lt; <span class="hljs-number"><span class="hljs-number">255</span></span>) { stillUpdating = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> t = data.r + delta; data.r = t &gt;= <span class="hljs-number"><span class="hljs-number">255</span></span> ? (<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>)<span class="hljs-number"><span class="hljs-number">255</span></span> : (<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>)t; } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (data.r &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { stillUpdating = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> t = data.r - delta; data.r = t &lt; <span class="hljs-number"><span class="hljs-number">0</span></span> ? (<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>)<span class="hljs-number"><span class="hljs-number">0</span></span> : (<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>)t; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุขู ุฃุตุจุญ </font></font><code>UpdateCellData</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฌุงูุฒูุง ููุชู ุชูููุฐ ุงูุชูุงูุงุช ุงูุฑุคูุฉ ุจุดูู ุตุญูุญ.</font></font><br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/https://translate" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุชูุงูุงุช ุงูุฑุคูุฉ.</font></font></i> <br><br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงูุญูุงูุฉ ุถุฏ ุงูุนูุงุตุฑ ุงูุงูุชูุงููุฉ ุงูููุฑุฑุฉ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุนูู ุงูุงูุชูุงูุงุช ุ ูููู ูุฏ ุชุธูุฑ ุงูุนูุงุตุฑ ุงูููุฑุฑุฉ ูู ุงููุงุฆูุฉ. </font><font style="vertical-align: inherit;">ูุญุฏุซ ูุฐุง ุฅุฐุง ุชุบูุฑุช ุญุงูุฉ ุฑุคูุฉ ุงูุฎููุฉ ุฃุซูุงุก ุงูุชูุงููุง. </font><font style="vertical-align: inherit;">ุนูู ุณุจูู ุงููุซุงู ุ ุนูุฏูุง ุชููู ุงูุฎููุฉ ูุฑุฆูุฉ ุฃุซูุงุก ุชุญุฑู ุงููุฑูุฉ ููุชุฑุฉ ูุตูุฑุฉ ููุท. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุชูุฌุฉ ูุธููุฑ ุงูุนูุงุตุฑ ุงูููุฑุฑุฉ ุ ูุชู ุชุญุฏูุซ ุงูุชูุงู ุงูุฎููุฉ ุนุฏุฉ ูุฑุงุช ููู ุฅุทุงุฑ ุ ููุง ูุคุฏู ุฅูู ุงูุชูุงูุงุช ุฃุณุฑุน ูุนูู ุฅุถุงูู. </font><font style="vertical-align: inherit;">ูููููุง ููุน ุฐูู ุนู ุทุฑูู ุงูุชุญูู ูุจู ุฅุถุงูุฉ ุฎููุฉ ูุง ุฅุฐุง ูุงูุช ููุฌูุฏุฉ ุจุงููุนู ูู ุงููุงุฆูุฉ. </font><font style="vertical-align: inherit;">ููุน ุฐูู ุ ุจุญุซ ูุงุฆูุฉ ูู ูู ููุงููุฉ</font></font><code>RefreshVisibility</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููููุฉ ุ ุฎุงุตุฉ ุนูุฏูุง ูุชู ุชูููุฐ ุนูููุงุช ุงูุชูุงู ูุชุนุฏุฏุฉ ููุฎูุงูุง. </font><font style="vertical-align: inherit;">ุจุฏูุงู ูู ุฐูู ุ ุฏุนูุง ูุณุชุฎุฏู ููุงุฉ ุฃุฎุฑู ูู ูุชู ุงุณุชุฎุฏุงููุง ุญุชู ุงูุขู ููุฅุดุงุฑุฉ ุฅูู ูุง ุฅุฐุง ูุงูุช ุงูุฎููุฉ ูู ุนูููุฉ ุงูุชูุงู ุ ุนูู ุณุจูู ุงููุซุงู ุ ุจูุงุณุทุฉ B. ุนูุฏูุง ูุถูู ุฎููุฉ ุฅูู ุงููุงุฆูุฉ ุ ูุณูุนูููุง ุจูููุฉ 255 ุ ููุถูู ููุท ุชูู ุงูุฎูุงูุง ุงูุชู ูุง ุชููู ูููุชูุง 255.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RefreshVisibility</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">HexCell cell</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> index = cell.Index; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ImmediateMode) { cellTextureData[index].r = cell.IsVisible ? (<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>)<span class="hljs-number"><span class="hljs-number">255</span></span> : (<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>)<span class="hljs-number"><span class="hljs-number">0</span></span>; cellTextureData[index].g = cell.IsExplored ? (<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>)<span class="hljs-number"><span class="hljs-number">255</span></span> : (<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>)<span class="hljs-number"><span class="hljs-number">0</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (cellTextureData[index].b != <span class="hljs-number"><span class="hljs-number">255</span></span>) { cellTextureData[index].b = <span class="hljs-number"><span class="hljs-number">255</span></span>; transitioningCells.Add(cell); } enabled = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ููู ูุนูู ูุฐุง ุ ูุญุชุงุฌ ุฅูู ุฅุนุงุฏุฉ ุชุนููู ูููุฉ B ุจุนุฏ ุงูุงูุชูุงุก ูู ุงูุชูุงู ุงูุฎููุฉ. </font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">UpdateCellData</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">HexCell cell, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> delta</span></span></span><span class="hljs-function">)</span></span> { โฆ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!stillUpdating) { data.b = <span class="hljs-number"><span class="hljs-number">0</span></span>; } cellTextureData[index] = data; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> stillUpdating; }</code> </pre> <br><iframe width="560" height="315" src="https://www.youtube.com/embed/https://translate" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุชูุงูุงุช ุจุฏูู ุชูุฑุงุฑุงุช.</font></font></i> <br><br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุชุญููู ุงูุฑุคูุฉ ุนูู ุงูููุฑ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฏุงุฆููุง ูุง ุชููู ุชุบููุฑุงุช ุงูุฑุคูุฉ ุชุฏุฑูุฌูุฉ ุ ุญุชู ุนูุฏ ุชุญููู ุฎุฑูุทุฉ. </font><font style="vertical-align: inherit;">ูุฐุง ุบูุฑ ููุทูู ุ ูุฃู ุงูุฎุฑูุทุฉ ุชุตู ุงูุญุงูุฉ ุงูุชู ุชููู ูููุง ุงูุฎูุงูุง ูุฑุฆูุฉ ุจุงููุนู ุ ูุฐุง ูุฅู ุงูุงูุชูุงู ุบูุฑ ููุงุณุจ ููุง. </font><font style="vertical-align: inherit;">ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ูููู ุฃู ูุคุฏู ุฅุฌุฑุงุก ุงูุชุญููุงุช ููุนุฏูุฏ ูู ุงูุฎูุงูุง ุงููุฑุฆูุฉ ูุฎุฑูุทุฉ ูุจูุฑุฉ ุฅูู ุฅุจุทุงุก ุงููุนุจุฉ ุจุนุฏ ุงูุชุญููู. </font><font style="vertical-align: inherit;">ูุฐูู ุ ูุจู ุชุญููู ุงูุฎูุงูุง ูุงููุฑู ุ ุฏุนูุง ููุชูู </font></font><code>HexGrid.Load</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅูู ูุถุน ุงูุงูุชูุงู ุงูููุฑู.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Load</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">BinaryReader reader, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> header</span></span></span><span class="hljs-function">)</span></span> { โฆ cellShaderData.ImmediateMode = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; cells.Length; i++) { cells[i].Load(reader, header); } โฆ }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฐุง ูุฅููุง ูุนูุฏ ุชุนุฑูู ุงูุฅุนุฏุงุฏ ุงูุฃููู ููุถุน ุงูุงูุชูุงู ุงูููุฑู ุ ูููุง ูุงู. </font><font style="vertical-align: inherit;">ุฑุจูุง ุชู ุฅููุงู ุชุดุบููู ุจุงููุนู ุ ุฃู ุฌุนู ุฎูุงุฑ ุงูุชูููู ุ ูุฐูู ุณูุชุฐูุฑ ุงููุถุน ุงูุฃููู ูุณูุชุญูู ุฅููู ุจุนุฏ ุงูุงูุชูุงุก ูู ุงูุนูู.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Load</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">BinaryReader reader, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> header</span></span></span><span class="hljs-function">)</span></span> { โฆ <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> originalImmediateMode = cellShaderData.ImmediateMode; cellShaderData.ImmediateMode = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; โฆ cellShaderData.ImmediateMode = originalImmediateMode; }</code> </pre> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุญุฒูุฉ ุงููุญุฏุฉ</font></font></a> <br><br><h2 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุทุงู ูุนุชูุฏ ุนูู ุงูุงุฑุชูุงุน </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุญุชู ุงูุขู ุงุณุชุฎุฏููุง ูุทุงููุง ุซุงุจุชูุง ูู ุซูุงุซุฉ ูุฌููุน ุงููุญุฏุงุช ุ ููููู ูู ุงููุงูุน ุฃูุซุฑ ุชุนููุฏูุง. ูู ุงูุญุงูุฉ ุงูุนุงูุฉ ุ ูุง ูููููุง ุฑุคูุฉ ุงููุงุฆู ูุณุจุจูู: ุฅูุง ุฃู ููุงู ุนูุจุฉ ุชููุนูุง ูู ุฑุคูุชู ุ ุฃู ุฃู ุงููุงุฆู ุตุบูุฑ ุฌุฏูุง ุฃู ุจุนูุฏ ุฌุฏูุง. ูู ูุนุจุชูุง ุ ูููู ููุท ุจุชุทุจูู ุญุฏูุฏ ุงููุทุงู. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุง ูููููุง ุฃู ูุฑู ูุง ูู ุนูู ุงูุฌุงูุจ ุงูุขุฎุฑ ูู ุงูุฃุฑุถ ุ ูุฃู ุงููููุจ ูุญุฌุจูุง. ูููููุง ุฃู ูุฑู ููุท ูู ุงูุฃูู. ูุธุฑูุง ูุฃู ุงููููุจ ูููู ุงุนุชุจุงุฑู ูุฑูููุง ุชูุฑูุจูุง ุ ูููุง ุงุฑุชูุนุช ูุฌูุฉ ุงููุธุฑ ุ ูููุง ุฑุฃููุง ุงููุฒูุฏ ูู ุงูุณุทุญ ุ ุฃู ุฃู ุงูุฃูู ูุนุชูุฏ ุนูู ุงูุงุฑุชูุงุน.</font></font><br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/071/788/208/0717882082a42e92b14e158876c6e28b.png"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุนุชูุฏ ุงูุฃูู ุนูู ุงุฑุชูุงุน ูุฌูุฉ ุงููุธุฑ. </font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุญุงูู ุงูุฑุคูุฉ ุงููุญุฏูุฏุฉ ููุญุฏุงุชูุง ุชุฃุซูุฑ ุงูุฃูู ุงููุงุชุฌ ุนู ุงูุญูุงุก ุงูุฃุฑุถ. </font><font style="vertical-align: inherit;">ูุนุชูุฏ ูุฏู ูุฑุงุฌุนุชูู ุนูู ุญุฌู ุงููููุจ ูุญุฌู ุงูุฎุฑูุทุฉ. </font><font style="vertical-align: inherit;">ุนูู ุงูุฃูู ูุฐุง ูู ุงูุชูุณูุฑ ุงูููุทูู. </font><font style="vertical-align: inherit;">ููู ุงูุณุจุจ ุงูุฑุฆูุณู ูุชูููู ุงููุทุงู ูู ุฃุณููุจ ุงููุนุจ ุ ููุฐุง ุชูููุฏ ูุณูู ุถุจุงุจ ุงูุญุฑุจ. </font><font style="vertical-align: inherit;">ููุน ุฐูู ุ ูู ุฎูุงู ููู ุงูููุฒูุงุก ุงููุงููุฉ ูู ูุฌุงู ุงูุฑุคูุฉ ุ ูููููุง ุฃู ูุณุชูุชุฌ ุฃู ูุฌูุฉ ูุธุฑ ุนุงููุฉ ูุฌุจ ุฃู ูููู ููุง ูููุฉ ุงุณุชุฑุงุชูุฌูุฉ ุ ูุฃููุง ุชุญุฑู ุงูุฃูู ุจุนูุฏูุง ูุชุณูุญ ูู ุจุงููุธุฑ ุฅูู ุงูุนูุจุงุช ุงูุฃูู. </font><font style="vertical-align: inherit;">ููู ุญุชู ุงูุขู ูู ูููุฐูุง.</font></font><br><br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงูุงุฑุชูุงุน ูููุฑุงุฌุนุฉ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฃุฎุฐ ุงูุงุฑุชูุงุน ูู ุงูุงุนุชุจุงุฑ ุนูุฏ ุชุญุฏูุฏ ุงููุทุงู ุ ูุญุชุงุฌ ุฅูู ูุนุฑูุฉ ุงูุงุฑุชูุงุน. </font><font style="vertical-align: inherit;">ุณูููู ูุฐุง ูู ุงูุงุฑุชูุงุน ุฃู ูุณุชูู ุงููุงุก ุงููุนุชุงุฏ ุ ุงุนุชูุงุฏูุง ุนูู ูุง ุฅุฐุง ูุงูุช ุงูุฎููุฉ ุงูุฃุฑุถูุฉ ุฃู ุงููุงุก. </font><font style="vertical-align: inherit;">ุฏุนูุง ูุถูู ูุฐุง ุฅูู </font></font><code>HexCell</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูููุชููุงุช.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> ViewElevation { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> elevation &gt;= waterLevel ? elevation : waterLevel; } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูููู ุฅุฐุง ูุงู ุงูุงุฑุชูุงุน ูุคุซุฑ ุนูู ุงููุทุงู ุ ูุนูุฏุฆุฐู ูุน ุชุบููุฑ ูู ุงุฑุชูุงุน ุนุฑุถ ุงูุฎููุฉ ุ ููุฏ ูุชุบูุฑ ูุถุน ุงูุฑุคูุฉ ุฃูุถูุง. </font><font style="vertical-align: inherit;">ูุธุฑูุง ูุฃู ุงูุฎููุฉ ุญุธุฑุช ูุทุงู ุนุฏุฉ ูุญุฏุงุช ุฃู ุชุญุธุฑู ุงูุขู ุ ูููุณ ูู ุงูุณูู ุชุญุฏูุฏ ูุง ูุฌุจ ุชุบููุฑู. </font><font style="vertical-align: inherit;">ูู ุชุชููู ุงูุฎููุฉ ููุณูุง ูู ุญู ูุฐู ุงููุดููุฉ ุ ูุฐุง ุฏุนูุง ุชุจูุบ ุนู ุชุบููุฑ ูู ุงููููู </font></font><code>HexCellShaderData</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ุงูุชุฑุถ ุฃู </font></font><code>HexCellShaderData</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฏูู ุทุฑููุฉ ูุฐูู </font></font><code>ViewElevationChanged</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ุณูู ูุทูู ุนููู ุนูุฏ ุงูุชุนููู </font></font><code>HexCell.Elevation</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ ุฅุฐุง ูุฒู ุงูุฃูุฑ.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> Elevation { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> elevation; } <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (elevation == <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> originalViewElevation = ViewElevation; elevation = <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ViewElevation != originalViewElevation) { ShaderData.ViewElevationChanged(); } โฆ } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูููุทุจู ููุณ ุงูุดูุก </font></font><code>WaterLevel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> WaterLevel { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> waterLevel; } <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (waterLevel == <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> originalViewElevation = ViewElevation; waterLevel = <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ViewElevation != originalViewElevation) { ShaderData.ViewElevationChanged(); } ValidateRivers(); Refresh(); } }</code> </pre> <br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุฅุนุงุฏุฉ ุชุนููู ุงูุฑุคูุฉ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุขู ูุญู ุจุญุงุฌุฉ ุฅูู ุฅูุดุงุก ุทุฑููุฉ </font></font><code>HexCellShaderData.ViewElevationChanged</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ูุนุฏ ุชุญุฏูุฏ ููููุฉ ุชุบูุฑ ุญุงูุฉ ุงูุฑุคูุฉ ุงูุนุงูุฉ ูููุฉ ูุนูุฏุฉ ุ ุฎุงุตุฉ ุนูุฏ ุชุบููุฑ ุฎูุงูุง ูุชุนุฏุฏุฉ ูู ููุณ ุงูููุช. </font><font style="vertical-align: inherit;">ูุฐูู ุ ูู ูุฎุฑุฌ ุจุฃู ุญูู ุ ูููู ุจุจุณุงุทุฉ ูุฎุทุท ูุฅุนุงุฏุฉ ุชุนููู ุฑุคูุฉ ุฌููุน ุงูุฎูุงูุง. </font><font style="vertical-align: inherit;">ุฃุถู ุญูููุง ููุทูููุง ูุชุชุจุน ูุง ุฅุฐุง ููุช ุณุชูุนู ุฐูู ุฃู ูุง. </font><font style="vertical-align: inherit;">ุฏุงุฎู ุงูุทุฑููุฉ ุ ุณูู ูููู ุจุจุณุงุทุฉ ุจุชุนููููุง ุนูู true ูุชุถููู ุงููููู. </font><font style="vertical-align: inherit;">ุจุบุถ ุงููุธุฑ ุนู ุนุฏุฏ ุงูุฎูุงูุง ุงูุชู ุชุบูุฑุช ูู ููุช ูุงุญุฏ ุ ุณูุคุฏู ุฐูู ุฅูู ุฅุนุงุฏุฉ ุชุนููู ูุงุญุฏุฉ.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> needsVisibilityReset; โฆ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ViewElevationChanged</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { needsVisibilityReset = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; enabled = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฅุนุงุฏุฉ ุชุนููู ููู ุงูุฑุคูุฉ ูุฌููุน ุงูุฎูุงูุง ุ ูุฌุจ ุฃู ูููู ูุฏูู ุญู ุงููุตูู ุฅูููุง ุ ุงูุฐู </font></font><code>HexCellShaderData</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุณ ูุฏูู. </font><font style="vertical-align: inherit;">ูุฐุง ุฏุนููุง ูููุถ ูุฐู ุงููุณุคูููุฉ </font></font><code>HexGrid</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ููููุงู ุจุฐูู ุ ุชุญุชุงุฌ ุฅูู ุงูุฅุถุงูุฉ ุฅูู </font></font><code>HexCellShaderData</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุฎุงุตูุฉ ุ ูุงูุชู ุณุชุณูุญ ูู ุจุงูุฑุฌูุน ุฅูู ุงูุดุจูุฉ. </font><font style="vertical-align: inherit;">ุซู ูููููุง ุงุณุชุฎุฏุงูู </font></font><code>LateUpdate</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุทูุจ ุฅุนุงุฏุฉ ุชุนููู.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> HexGrid Grid { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } โฆ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">LateUpdate</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (needsVisibilityReset) { needsVisibilityReset = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; Grid.ResetVisibility(); } โฆ }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฏุนูุง ููุชูู ุฅูู </font></font><code>HexGrid</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: ุชุนููู ุงูุฑุงุจุท ุฅูู ุงูุดุจูุฉ </font></font><code>HexGrid.Awake</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุนุฏ ุฅูุดุงุก ุจูุงูุงุช ุงูุชุธููู.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Awake</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { HexMetrics.noiseSource = noiseSource; HexMetrics.InitializeHashGrid(seed); HexUnit.unitPrefab = unitPrefab; cellShaderData = gameObject.AddComponent&lt;HexCellShaderData&gt;(); cellShaderData.Grid = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; CreateMap(cellCountX, cellCountZ); }</code> </pre> <br> <code>HexGrid</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฌุจ ุฃู ุชุญุตู ุฃูุถูุง ุนูู ุทุฑููุฉ </font></font><code>ResetVisibility</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุชุฎูุต ูู ุฌููุน ุงูุฎูุงูุง. </font><font style="vertical-align: inherit;">ููุท ุงุฌุนููุง ุชุฏูุฑ ุญูู ุฌููุน ุงูุฎูุงูุง ูู ุงูุญููุฉ ูุชูููุถ ุฅุนุงุฏุฉ ุงูุชุนููู ูููุณูุง.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ResetVisibility</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; cells.Length; i++) { cells[i].ResetVisibility(); } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุขู ูุญู ุจุญุงุฌุฉ ุฅูู ุฅุถุงูุฉ ุฅูู </font></font><code>HexCell</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุฃุณููุจ </font></font><code>ResetVisibilty</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ุณุชููู ุจุจุณุงุทุฉ ุจุฅูุบุงุก ุชุญุฏูุฏ ุงูุฑุคูุฉ ูุชุดุบูู ุชุญุฏูุซ ุงูุฑุคูุฉ. </font><font style="vertical-align: inherit;">ูุฌุจ ุฃู ูุชู ุฐูู ุนูุฏูุง ุชููู ุฑุคูุฉ ุงูุฎููุฉ ุฃูุจุฑ ูู ุงูุตูุฑ.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ResetVisibility</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (visibility &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { visibility = <span class="hljs-number"><span class="hljs-number">0</span></span>; ShaderData.RefreshVisibility(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุนุฏ ุฅุนุงุฏุฉ ุชุนููู ุฌููุน ุจูุงูุงุช ุงูุฑุคูุฉ ุ </font></font><code>HexGrid.ResetVisibility</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฌุจ ุนููู ูุฑุฉ ุฃุฎุฑู ุชุทุจูู ุงูุฑุคูุฉ ุนูู ุฌููุน ุงููุฑู ุ ูุงูุชู ูุญุชุงุฌ ุฅูู ูุนุฑูุฉ ูุทุงู ูู ูุฑูุฉ. </font><font style="vertical-align: inherit;">ุงูุชุฑุถ ุฃูู ูููู ุงูุญุตูู ุนูููุง ุจุงุณุชุฎุฏุงู ุงูุฎุงุตูุฉ </font></font><code>VisionRange</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ResetVisibility</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; cells.Length; i++) { cells[i].ResetVisibility(); } <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; units.Count; i++) { HexUnit unit = units[i]; IncreaseVisibility(unit.Location, unit.VisionRange); } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุฐุง ููุนููุ ูุฅุนุงุฏุฉ ุชุณููุฉ refactor- </font></font><code>HexUnit.visionRange</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู </font></font><code>HexUnit.VisionRange</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุชุญููููุง ุฅูู ููุฒุฉ. </font><font style="vertical-align: inherit;">ุจูููุง ุณุชุญุตู ุนูู ูููุฉ ุซุงุจุชุฉ 3 ุ ููููุง ุณุชุชุบูุฑ ูู ุงููุณุชูุจู.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> VisionRange { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span>; } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุชูุฌุฉ ูุฐูู ุ ุณูุชู ุฅุนุงุฏุฉ ุชุนููู ุจูุงูุงุช ุงูุฑุคูุฉ ูุณุชุธู ุตุญูุญุฉ ุจุนุฏ ุชุบููุฑ ุงุฑุชูุงุน ุนุฑุถ ุงูุฎููุฉ. </font><font style="vertical-align: inherit;">ูููู ูู ุงููุญุชูู ุฃููุง ุณูุบูุฑ ููุงุนุฏ ุชุญุฏูุฏ ุงููุทุงู ูุชุดุบูู ุฅุนุงุฏุฉ ุงูุชุฑุฌูุฉ ูู ูุถุน ุงูุชุดุบูู. </font><font style="vertical-align: inherit;">ุจุญูุซ ูุชุบูุฑ ุงููุทุงู ุจุดูู ูุณุชูู ุ ููููู ุจุฅุนุงุฏุฉ ุชุนููู </font></font><code>HexGrid.OnEnable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุนูุฏ ุงูุชุดุงู ุฅุนุงุฏุฉ ุงูุชุฑุฌูุฉ.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnEnable</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!HexMetrics.noiseSource) { โฆ ResetVisibility(); } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงูุขู ููููู ุชุบููุฑ ุฑูุฒ ุงููุทุงู ูุฑุคูุฉ ุงููุชุงุฆุฌ ุ ุจูููุง ุชุจูู ูู ูุถุน ุงูุชุดุบูู. </font></font><br><br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุชูุณูุน ุงูุฃูู </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุชู ุชุญุฏูุฏ ุญุณุงุจ ุงููุทุงู </font></font><code>HexGrid.GetVisibleCells</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ุจุญูุซ ูุคุซุฑ ุงูุงุฑุชูุงุน ุนูู ุงููุทุงู ุ ูููููุง ุจุจุณุงุทุฉ ุงุณุชุฎุฏุงู ุงุฑุชูุงุน ุงูุนุฑุถ </font></font><code>fromCell</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุฅุนุงุฏุฉ ุชุนุฑูู ุงูููุทูุฉ ุงููุฑุณูุฉ ูุคูุชูุง. </font><font style="vertical-align: inherit;">ุญุชู ูุชููู ูู ุงูุชุญูู ุจุณูููุฉ ููุง ุฅุฐุง ูุงู ูุฐุง ูุนูู.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-function">List&lt;HexCell&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetVisibleCells</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">HexCell fromCell, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> range</span></span></span><span class="hljs-function">)</span></span> { โฆ range = fromCell.ViewElevation; fromCell.SearchPhase = searchFrontierPhase; fromCell.Distance = <span class="hljs-number"><span class="hljs-number">0</span></span>; searchFrontier.Enqueue(fromCell); โฆ }</code> </pre> <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/727/032/6d3/7270326d379796f2b4f2f3c3ca65512c.png"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงุณุชุฎุฏู ุงูุงุฑุชูุงุน ููุทุงู.</font></font></i> <br><br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุนููุงุช ุงูุฑุคูุฉ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุทุจูู ุงุฑุชูุงุน ุงูุนุฑุถ ููุทุงู ูุนูู ุจุดูู ุตุญูุญ ููุท ุนูุฏูุง ุชููู ุฌููุน ุงูุฎูุงูุง ุงูุฃุฎุฑู ุนูุฏ ุงุฑุชูุงุน ุตูุฑู. </font><font style="vertical-align: inherit;">ูููู ุฅุฐุง ูุงู ูุฌููุน ุงูุฎูุงูุง ููุณ ุงุฑุชูุงุน ูุฌูุฉ ุงููุธุฑ ุ ููุฌุจ ุฃู ูููู ูุฌุงู ุงูุฑุคูุฉ ุตูุฑูุง. </font><font style="vertical-align: inherit;">ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ูุฌุจ ุฃู ุชููุน ุงูุฎูุงูุง ุฐุงุช ุงููุฑุชูุนุงุช ุงูุนุงููุฉ ุฑุคูุฉ ุงูุฎูุงูุง ุงูููุฎูุถุฉ ุฎูููุง. </font><font style="vertical-align: inherit;">ุญุชู ุงูุขู ุ ูู ูุชู ุชูููุฐ ุฃู ูู ูุฐุง.</font></font><br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/de8/7be/a6f/de87bea6f4b88cd61765450a63f738f9.png"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุง ูุชุฏุฎู ุงููุทุงู. </font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุทุฑููุฉ ุงูุฃูุซุฑ ุตุญุฉ ูุชุญุฏูุฏ ุงููุทุงู ูู ุงูุชุญูู ุนู ุทุฑูู ุงูุจุนุงุซ ุงูุฃุดุนุฉ ุ ูููููุง ุณุชุตุจุญ ููููุฉ ููุบุงูุฉ ูุณุชุธู ุชูุชุฌ ูุชุงุฆุฌ ุบุฑูุจุฉ. </font><font style="vertical-align: inherit;">ูุญู ุจุญุงุฌุฉ ุฅูู ุญู ุณุฑูุน ูุฎูู ูุชุงุฆุฌ ุฌูุฏุฉ ุจูุง ููู ุงูููุงูุฉ ูุงูุชู ูุง ูุฌุจ ุฃู ุชููู ูุซุงููุฉ. </font><font style="vertical-align: inherit;">ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ูู ุงูููู ุฃู ุชููู ููุงุนุฏ ุชุญุฏูุฏ ุงููุทุงู ุจุณูุทุฉ ูุจุฏูููุฉ ููููู ุงูุชูุจุค ุจูุง ููุงุนุจูู. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุณูููู ุญููุง ุนูู ุงููุญู ุงูุชุงูู - ุนูุฏ ุชุญุฏูุฏ ูุฏู ุฑุคูุฉ ุงูุฎููุฉ ุ ุณูุถูู ุงุฑุชูุงุน ุนุฑุถ ุงูุฎููุฉ ุงููุฌุงูุฑุฉ ุฅูู ุงููุณุงูุฉ ุงููุบุทุงุฉ. </font><font style="vertical-align: inherit;">ูู ุงููุงูุน ุ ูุฐุง ูููู ูู ุงููุทุงู ุนูุฏูุง ููุธุฑ ุฅูู ูุฐู ุงูุฎูุงูุง ุ ูุฅุฐุง ุชู ุชุฎุทููุง ุ ููู ูุณูุญ ููุง ูุฐุง ุจุงููุตูู ุฅูู ุงูุฎูุงูุง ุฎูููุง.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> distance = current.Distance + <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (distance + neighbor.ViewElevation &gt; range) { <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; }</code> </pre> <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/774/44c/efe/77444cefe82d428ee32e094213e82a1a.png"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุฎูุงูุง ุงูุนุงููุฉ ุชููุน ุงูุฑุคูุฉ.</font></font></i> <br><br><div class="spoiler" style=";text-align:right;direction:rtl"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃูุง ูุฌุจ ุฃู ูุฑู ุฎูุงูุง ุทูููุฉ ูู ุงููุณุงูุฉุ</font></font></b> <div class="spoiler_text" style=";text-align:right;direction:rtl">      ,     ,   ,   .       ,       . </div></div><br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุง ุชูุธุฑ ุญูู ุงูุฒูุงูุง </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุขู ูุจุฏู ุฃู ุงูุฎูุงูุง ุงููุฑุชูุนุฉ ุชููุน ุงูุนุฑุถ ุฅูู ุงูุงูุฎูุงุถ ุ ูููู ูู ุจุนุถ ุงูุฃุญูุงู ูุฎุชุฑู ุงููุทุงู ูุฐู ุ ุนูู ุงูุฑุบู ูู ุฃูู ูุจุฏู ุฃูู ูุง ููุจุบู ุฃู ูููู ูุฐุง. </font><font style="vertical-align: inherit;">ูุญุฏุซ ูุฐุง ูุฃู ุฎูุงุฑุฒููุฉ ุงูุจุญุซ ูุง ุชุฒุงู ุชุฌุฏ ูุณุงุฑูุง ููุฐู ุงูุฎูุงูุง ุ ูุชุฌุงูุฒุฉ ุงูุฎูุงูุง ุงููุญุธูุฑุฉ. </font><font style="vertical-align: inherit;">ููุชูุฌุฉ ูุฐูู ุ ูุจุฏู ููุง ูู ุฃู ูุฌุงู ุฑุคูุชูุง ูููู ุฃู ูุฏูุฑ ุญูู ุงูุนูุจุงุช. </font><font style="vertical-align: inherit;">ูุชุฌูุจ ุฐูู ุ ูุญุชุงุฌ ุฅูู ุงูุชุฃูุฏ ูู ุฃู ุฃูุตุฑ ุงููุณุงุฑุงุช ููุท ุชุคุฎุฐ ูู ุงูุงุนุชุจุงุฑ ุนูุฏ ุชุญุฏูุฏ ุฑุคูุฉ ุงูุฎููุฉ. </font><font style="vertical-align: inherit;">ูููู ุงูููุงู ุจุฐูู ุนู ุทุฑูู ุฅุณูุงุท ุงููุณุงุฑุงุช ุงูุชู ุชุตุจุญ ุฃุทูู ูู ุงููุงุฒู.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> HexCoordinates fromCoordinates = fromCell.coordinates; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (searchFrontier.Count &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { โฆ <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (HexDirection d = HexDirection.NE; d &lt;= HexDirection.NW; d++) { โฆ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> distance = current.Distance + <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (distance + neighbor.ViewElevation &gt; range || distance &gt; fromCoordinates.DistanceTo(neighbor.coordinates) ) { <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; } โฆ } }</code> </pre> <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/30d/bfa/1c2/30dbfa1c2df2fb6119249f00cdc3d8d8.png"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุณุชุฎุฏู ุฃูุตุฑ ุงูุทุฑู ููุท.</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุฐูู ุฃุตูุญูุง ูุนุธู ุงูุญุงูุงุช ุงูุฎุงุทุฆุฉ ุจุดูู ูุงุถุญ. ุจุงููุณุจุฉ ููุฎูุงูุง ุงููุฌุงูุฑุฉ ุ ูุนูู ูุฐุง ุจุดูู ุฌูุฏ ุ ูุฃูู ูุง ููุฌุฏ ุณูู ุฃูุตุฑ ุงููุณุงุฑุงุช ููุง. ุชุญุชูู ุงูุฎูุงูุง ุงูุจุนูุฏุฉ ุนูู ุงููุฒูุฏ ูู ุงูุฎูุงุฑุงุช ูููุณุงุฑุงุช ุ ูุจุงูุชุงูู ุ ุนุจุฑ ูุณุงูุงุช ุทูููุฉ ุ ูุง ูุฒุงู ูููู ุฃู ูุญุฏุซ ุธุฑู ููุฑุคูุฉ. ูู ูููู ูุฐุง ูุดููุฉ ุฅุฐุง ุธูุช ููุงุทู ุงูุฑุคูุฉ ุตุบูุฑุฉ ูุงูุงุฎุชูุงูุงุช ูู ุงูุงุฑุชูุงุนุงุช ุงููุฌุงูุฑุฉ ููุณุช ูุจูุฑุฉ ุฌุฏูุง. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฃุฎูุฑูุง ุ ุจุฏูุงู ูู ุงุณุชุจุฏุงู ูุฌุงู ุงูุฑุคูุฉ ุงููุฑุณูู ุ ูุถูู ุฅููู ุงุฑุชูุงุน ุงูุนุฑุถ. ูุดูุฑ ูุฌุงู ุฑุคูุฉ ุงููุฑูู ุฅูู ุงุฑุชูุงุนู ุฃู ุงุฑุชูุงุน ุทูุฑุงูู ุฃู ูุฏุฑุงุชู ุงูุงุณุชุทูุงุนูุฉ.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> range += fromCell.ViewElevation;</code> </pre> <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/3ff/1ce/a2b/3ff1cea2b833bda69990576fa8323aec.png"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุนุฑุถ ูุน ูุฌุงู ุฑุคูุฉ ูุงูู ูู ูุฌูุฉ ูุธุฑ ููุฎูุถุฉ. </font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃู ุฃู ุงูููุงุนุฏ ุงูููุงุฆูุฉ ููุฑุคูุฉ ุชูุทุจู ุนูู ุงูุฑุคูุฉ ุนูุฏ ุงูุชุญุฑู ุนูู ุทูู ุฃูุตุฑ ูุณุงุฑ ุฅูู ูุฌุงู ุงูุฑุคูุฉ ุ ูุน ูุฑุงุนุงุฉ ุงูุงุฎุชูุงู ูู ุงุฑุชูุงุน ุงูุฎููุฉ ุจุงููุณุจุฉ ููุฌูุฉ ุงููุธุฑ. </font><font style="vertical-align: inherit;">ุนูุฏูุง ุชููู ุงูุฎููุฉ ุฎุงุฑุฌ ุงููุทุงู ุ ูุฅููุง ุชุญุฌุจ ุฌููุน ุงููุณุงุฑุงุช ุนุจุฑูุง. </font><font style="vertical-align: inherit;">ููุชูุฌุฉ ูุฐูู ุ ุชุตุจุญ ููุงุท ุงููุฑุงูุจุฉ ุงูุนุงููุฉ ุ ุงูุชู ูุง ุดูุก ูููุน ุงูุฑุคูุฉ ุ ุฐุงุช ูููุฉ ุงุณุชุฑุงุชูุฌูุฉ.</font></font><br><br><div class="spoiler" style=";text-align:right;direction:rtl"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุงุฐุง ุนู ุฅุนุงูุฉ ุฑุคูุฉ ุงูุฃุดูุงุกุ</font></font></b> <div class="spoiler_text" style=";text-align:right;direction:rtl">  ,        ,  . ,  ,        .          . </div></div><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุญุฒูุฉ ุงููุญุฏุฉ</font></font></a> <br><br><h2 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงูุฎูุงูุง ุงูุชู ูุง ูููู ุงุณุชูุดุงููุง </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงููุดููุฉ ุงูุฃุฎูุฑุฉ ูุน ุงูุฑุคูุฉ ุชุชุนูู ุจุญูุงู ุงูุฎุฑูุทุฉ. </font><font style="vertical-align: inherit;">ูุชููู ุงูุงูุชุนุงุด ูุฌุฃุฉ ูุจุฏูู ุงูุชูุงูุงุช ุ ูุฃู ุงูุฎูุงูุง ุงูููุฌูุฏุฉ ุนูู ุงูุญุงูุฉ ููุณ ููุง ุฌูุฑุงู.</font></font><br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/587/217/fbb/587217fbb248ae8a13759a33e22e25ff.png"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุญุงูุฉ ููุญูุธุฉ ููุฎุฑูุทุฉ.</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ุงููุงุญูุฉ ุงููุซุงููุฉ ุ ูุฌุจ ุฃู ูููู ุงูุนุฑุถ ุงููุฑุฆู ููููุงุทู ูุงูุญูุงู ุบูุฑ ุงูููุชุดูุฉ ูู ููุณู. ูููููุง ุชุญููู ุฐูู ุนู ุทุฑูู ุฅุถุงูุฉ ุญุงูุงุช ุฎุงุตุฉ ุนูุฏ ุชุซููุซ ุงูุญูุงู ุ ุนูุฏูุง ูุง ูููู ูุฏููู ุฌูุฑุงู ุ ูููู ูุฐุง ุณูุชุทูุจ ููุทููุง ุฅุถุงูููุง ุ ูุณูููู ุนูููุง ุงูุนูู ูุน ุงูุฎูุงูุง ุงูููููุฏุฉ. ูุฐูู ุ ูุซู ูุฐุง ุงูุญู ุบูุฑ ุจุฏููู. ููุฌ ุจุฏูู ูู ุฅุฌุจุงุฑ ุงูุฎูุงูุง ุงูุญุฏูุฏูุฉ ููุฎุฑูุทุฉ ุนูู ุฃู ุชููู ุบูุฑ ูุณุชูุดูุฉ ุ ุญุชู ูู ูุงูุช ูู ูุทุงู ุงููุฑูุฉ. ูุฐุง ุงูููุฌ ุฃุจุณุท ุจูุซูุฑ ุ ูุฐูู ุฏุนููุง ูุณุชุฎุฏูู. ููุง ูุณูุญ ูู ุจูุถุน ุนูุงูุฉ ุนูู ุฃููุง ุฎูุงูุง ุบูุฑ ูุณุชูุดูุฉ ูุฎูุงูุง ุฃุฎุฑู ุ ููุง ูุณูู ุชุญููู ุฅูุดุงุก ุญูุงู ุบูุฑ ูุณุชููุฉ ููุฎุฑูุทุฉ. ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ุชุณูุญ ูู ุงูุฎูุงูุง ุงููุฎููุฉ ุนูุฏ ุงูุญูุงู ุจุฅูุดุงุก ุงูุทุฑู ูุงูุฃููุงุฑ ุงูุชู ุชุฏุฎู ูุชุฎุฑุฌ ูู ุฎุฑูุทุฉ ุงูููุฑ ูุงูุทุฑูู ุ ูุฃู ููุงุท ุงูููุงูุฉ ุณุชููู ุฎุงุฑุฌ ุงููุทุงู.ุฃูุถูุง ุ ุจูุณุงุนุฏุฉ ูุฐุง ุงูุญู ุ ููููู ุฅุถุงูุฉ ูุญุฏุงุช ุชุฏุฎู ูุชุฎุฑุฌ ูู ุงูุฎุฑูุทุฉ.</font></font><br><br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุถุน ุนูุงูุฉ ุนูู ุงูุฎูุงูุง ููุง ุชู ุงูุชุญููู ูููุง </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุฅุดุงุฑุฉ ุฅูู ุฅููุงููุฉ ูุญุต ุงูุฎููุฉ ุ ุฃุถู ุฅูู </font></font><code>HexCell</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุฎุงุตูุฉ </font></font><code>Explorable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> Explorable { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุขู ูููู ุฃู ุชููู ุงูุฎููุฉ ูุฑุฆูุฉ ุฅุฐุง ุชู ุงูุชุญููู ูููุง ุ ูุฐูู </font></font><code>IsVisible</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุณูููู </font><font style="vertical-align: inherit;">ุจุชุบููุฑ ุงููููุน </font><font style="vertical-align: inherit;">ูุฃุฎุฐ ุฐูู ูู ุงูุงุนุชุจุงุฑ.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> IsVisible { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> visibility &gt; <span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; Explorable; } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุฃูุฑ ููุณู ููุทุจู ุนูู </font></font><code>IsExplored</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ููุน ุฐูู ุ ูููุง ุจุงูุชุญููู ูู ุงูุฎุงุตูุฉ ุงูููุงุณูุฉ. </font><font style="vertical-align: inherit;">ูุญู ุจุญุงุฌุฉ ุฅูู ุชุญููููุง ุฅูู ุฎุงุตูุฉ ุตุฑูุญุฉ ุญุชู ูุชููู ูู ุชุบููุฑ ููุทู getter ุงูุฎุงุต ุจูุง.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> IsExplored { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> explored &amp;&amp; Explorable; } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> { explored = <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>; } } โฆ <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> explored;</code> </pre> <br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุฅุฎูุงุก ุญุงูุฉ ุงูุฎุฑูุทุฉ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููููู ุฅุฎูุงุก ุญุงูุฉ ุฎุฑูุทุฉ ูุณุชุทููุฉ ูู ุงูุทุฑููุฉ </font></font><code>HexGrid.CreateCell</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ูุชู ุงูุชุญููู ูู ุงูุฎูุงูุง ุบูุฑ ุงูููุฌูุฏุฉ ุนูู ุงูุญุงูุฉ ุ ููู ุงูุจุงูู ุบูุฑ ููุชุดู.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CreateCell</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> x, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> z, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> i</span></span></span><span class="hljs-function">)</span></span> { โฆ HexCell cell = cells[i] = Instantiate&lt;HexCell&gt;(cellPrefab); cell.transform.localPosition = position; cell.coordinates = HexCoordinates.FromOffsetCoordinates(x, z); cell.Index = i; cell.ShaderData = cellShaderData; cell.Explorable = x &gt; <span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; z &gt; <span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; x &lt; cellCountX - <span class="hljs-number"><span class="hljs-number">1</span></span> &amp;&amp; z &lt; cellCountZ - <span class="hljs-number"><span class="hljs-number">1</span></span>; โฆ }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุขู ุฃุตุจุญุช ุงูุจุทุงูุงุช ูุธููุฉ ุญูู ุงูุญูุงู ุ ูุฎุชุจุฆุฉ ุฎูููุง ูุณุงุญุงุช ุถุฎูุฉ ุบูุฑ ููุชุดูุฉ. </font><font style="vertical-align: inherit;">ููุชูุฌุฉ ูุฐูู ุ ููู ุญุฌู ููุทูุฉ ุงูุฎุฑุงุฆุท ุงููุฏุฑูุณุฉ ูู ูู ุจุนุฏ ุจููุฏุงุฑ ุงุซููู.</font></font><br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/594/19f/353/59419f35345fa4eac3380c4e16461baf.png"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุญุงูุฉ ุบูุฑ ูุณุชูุดูุฉ ููุฎุฑูุทุฉ.</font></font></i> <br><br><div class="spoiler" style=";text-align:right;direction:rtl"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ูู ุงููููู ุฌุนู ุญุงูุฉ ุงูุจุญุซ ูุงุจูุฉ ููุชุญุฑูุฑุ</font></font></b> <div class="spoiler_text" style=";text-align:right;direction:rtl"> ,  ,     .          . </div></div><br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงูุฎูุงูุง ุบูุฑ ุงููุณุชูุดูุฉ ุชุนูู ุงูุฑุคูุฉ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃุฎูุฑูุง ุ ุฅุฐุง ูุงู ูุง ูููู ูุญุต ุงูุฎููุฉ ุ ููุฌุจ ุฃู ุชุชุฏุงุฎู ูุน ุงูุฑุคูุฉ. </font><font style="vertical-align: inherit;">ุงูุชุบููุฑ </font></font><code>HexGrid.GetVisibleCells</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฃุฎุฐ ูุฐุง ูู ุงูุงุนุชุจุงุฑ.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( neighbor == <span class="hljs-literal"><span class="hljs-literal">null</span></span> || neighbor.SearchPhase &gt; searchFrontierPhase || !neighbor.Explorable ) { <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; }</code> </pre><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุญุฒูุฉ ุงููุญุฏุฉ</font></font></a> <br><br><h1 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงูุฌุฒุก 23: ุชูููุฏ ุงูุฃุฑุถ </font></font></h1><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงููุฃ ุงูุฎุฑุงุฆุท ุงูุฌุฏูุฏุฉ ุจุงูููุงุธุฑ ุงูุทุจูุนูุฉ ุงููููุฏุฉ. </font></font></li><li style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุฑูุน ุงูุฃุฑุถ ููู ุงููุงุก ุ ููุบุฑู ุจุนุถูุง. </font></font></li><li style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุญู ูุชุญูู ูู ูุณุงุญุฉ ุงูุฃุฑุถ ุงููุฎูููุฉ ูุงุฑุชูุงุนูุง ูุนุฏู ุชูุงูุคูุง. </font></font></li><li style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุถูู ุฏุนููุง ูุฎูุงุฑุงุช ุงูุชูููู ุงููุฎุชููุฉ ูุฅูุดุงุก ุฎุฑุงุฆุท ูุชุบูุฑุฉ. </font></font></li><li style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุตูุนูุง ุจุญูุซ ูููู ุฅูุดุงุก ููุณ ุงูุฎุฑูุทุฉ ูุฑุฉ ุฃุฎุฑู. </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุณูููู ูุฐุง ุงูุฌุฒุก ูู ุงูุจุฑูุงูุฌ ุงูุชุนูููู ุจุฏุงูุฉ ุณูุณูุฉ ุญูู ุฅูุดุงุก ุงูุฎุฑูุทุฉ ุงูุฅุฌุฑุงุฆูุฉ. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชู ุฅูุดุงุก ูุฐุง ุงูุฌุฒุก ูู Unity 2017.1.0.</font></font><br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/99e/798/7bb/99e7987bbcb46f1f961b72ba76a78aa0.jpg"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุงุญุฏุฉ ูู ุงูุฎุฑุงุฆุท ุงูุนุฏูุฏุฉ ุงูุชู ุชู ุฅูุดุงุคูุง.</font></font></i> <br><br><h2 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุชูููุฏ ุงูุจุทุงูุฉ </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุนูู ุงูุฑุบู ูู ุฃูู ูููููุง ุฅูุดุงุก ุฃู ุฎุฑูุทุฉ ุ ุฅูุง ุฃููุง ุชุณุชุบุฑู ุงููุซูุฑ ูู ุงูููุช. ุณูููู ูู ุงูููุงุฆู ุฅุฐุง ูุงู ุงูุชุทุจูู ูููู ุฃู ูุณุงุนุฏ ุงููุตูู ูู ุฎูุงู ุฅูุดุงุก ุจุทุงูุงุช ูู ุ ูุงูุชู ููููู ุจุนุฏ ุฐูู ุชุนุฏูููุง ุญุณุจ ุฐููู. ููููู ุงุชุฎุงุฐ ุฎุทูุฉ ุฃุฎุฑู ูุงูุชุฎูุต ุชูุงููุง ูู ุฅูุดุงุก ุงูุชุตููู ูุฏูููุง ุ ูููู ุงููุณุคูููุฉ ุงููุงููุฉ ุนู ุฅูุดุงุก ุงูุฎุฑูุทุฉ ุงูููุงุฆูุฉ ุฅูู ุงูุชุทุจูู. ููุชูุฌุฉ ูุฐูู ุ ูููู ูุนุจ ุงููุนุจุฉ ูู ูู ูุฑุฉ ุจุจุทุงูุฉ ุฌุฏูุฏุฉ ูุณุชููู ูู ุฌูุณุฉ ูุนุจุฉ ูุฎุชููุฉ. ููู ูููู ูู ูุฐุง ูููููุง ุ ูุฌุจ ุฃู ููุดุฆ ุฎูุงุฑุฒููุฉ ูุชูููุฏ ุงูุฎุฑุงุฆุท. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุนุชูุฏ ููุน ุฎูุงุฑุฒููุฉ ุงูุชูููุฏ ุงูุชู ุชุญุชุงุฌูุง ุนูู ููุน ุงูุจุทุงูุฉ ุงูุชู ุชุญุชุงุฌูุง. ูุง ููุฌุฏ ููุฌ ูุงุญุฏ ุตุญูุญ ุ ุนููู ุฏุงุฆููุง ุงูุจุญุซ ุนู ุญู ูุณุท ุจูู ุงููุตุฏุงููุฉ ููุงุจููุฉ ุงููุนุจ.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููู ุชููู ุงูุจุทุงูุฉ ูุงุจูุฉ ููุชุตุฏูู ุ ูุฌุจ ุฃู ุชุจุฏู ููููุฉ ุชูุงููุง ูุญููููุฉ ููุงุนุจ. ูุฐุง ูุง ูุนูู ุฃู ุงูุฎุฑูุทุฉ ูุฌุจ ุฃู ุชุจุฏู ููุฃููุง ุฌุฒุก ูู ูููุจูุง. ูุฏ ูููู ูููุจูุง ูุฎุชูููุง ุฃู ุญูููุฉ ูุฎุชููุฉ ุชูุงููุง. ูููู ุฅุฐุง ูุงู ูุฌุจ ุฃู ูุดูุฑ ุฅูู ุงุฑุชูุงุญ ุงูุฃุฑุถ ุ ููุฌุจ ุฃู ูุดุจููุง ุฌุฒุฆููุง ุนูู ุงูุฃูู. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุฑุชุจุท ุฅููุงููุฉ ุงูุชุดุบูู ุจููููุฉ ุชุทุงุจู ุงูุจุทุงูุงุช ูุน ุทุฑููุฉ ุงููุนุจ. ูู ุจุนุถ ุงูุฃุญูุงู ูุชุนุงุฑุถ ูุน ุงููุตุฏุงููุฉ. ุนูู ุณุจูู ุงููุซุงู ุ ุนูู ุงูุฑุบู ูู ุฃู ุงูุณูุงุณู ุงูุฌุจููุฉ ูููู ุฃู ุชุจุฏู ุฌูููุฉ ุ ุฅูุง ุฃููุง ูู ููุณ ุงูููุช ุชุญุฏ ุจุดูู ูุจูุฑ ูู ุญุฑูุฉ ุงููุญุฏุงุช ูุนุฑุถูุง. ุฅุฐุง ูุงู ูุฐุง ุบูุฑ ูุฑุบูุจ ููู ุ ูุนููู ุงูุงุณุชุบูุงุก ุนู ุงูุฌุจุงู ุ ููุง ุณูููู ูู ุงููุตุฏุงููุฉ ููุญุฏ ูู ุชุนุจูุฑุงุช ุงููุนุจุฉ. ุฃู ูููููุง ุฅููุงุฐ ุงูุฌุจุงู ุ ูููู ุชูููู ุชุฃุซูุฑูุง ุนูู ุงููุนุจ ุ ูุงูุฐู ูููู ุฃู ูููู ุฃูุถูุง ูู ุงููุตุฏุงููุฉ.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ูุฌุจ ุงููุธุฑ ูู ุงูุฌุฏูู. ุนูู ุณุจูู ุงููุซุงู ุ ููููู ุฅูุดุงุก ูููุจ ูุงูุนู ููุบุงูุฉ ูุดุจู ุงูุฃุฑุถ ูู ุฎูุงู ูุญุงูุงุฉ ุงูุตูุงุฆุญ ุงูุชูุชูููุฉ ูุงูุชุขูู ูุงูุฃูุทุงุฑ ูุงูุงููุฌุงุฑุงุช ุงูุจุฑูุงููุฉ ูุชุฃุซูุฑุงุช ุงูููุงุฒู ูุงูููุฑ ููุง ุฅูู ุฐูู. ููู ุชุทููุฑ ูุซู ูุฐุง ุงููุธุงู ุณูู ูุชุทูุจ ุงููุซูุฑ ูู ุงูููุช. ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ูุฏ ูุณุชุบุฑู ุฅูุดุงุก ูุซู ูุฐุง ุงููููุจ ููุชูุง ุทูููุงู ุ ููู ูุฑุบุจ ุงููุงุนุจูู ูู ุงูุงูุชุธุงุฑ ุจุถุน ุฏูุงุฆู ูุจู ุจุฏุก ูุนุจุฉ ุฌุฏูุฏุฉ. ุฃู ุฃู ุงููุญุงูุงุฉ ุฃุฏุงุฉ ูููุฉ ุ ูููู ููุง ุซูู.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุบุงูุจูุง ูุง ุชุณุชุฎุฏู ุงูุฃูุนุงุจ ููุงูุถุงุช ุจูู ุงููุตุฏุงููุฉ ูุฅููุงููุฉ ุงููุนุจ ูุงูุฌุฏูู. ูู ุจุนุถ ุงูุฃุญูุงู ุชููู ูุซู ูุฐู ุงูุชูุงุฒูุงุช ุบูุฑ ูุฑุฆูุฉ ูุชุจุฏู ุทุจูุนูุฉ ุชูุงููุง ุ ูุฃุญูุงููุง ุชุจุฏู ุนุดูุงุฆูุฉ ุฃู ุบูุฑ ูุชุณูุฉ ุฃู ููุถููุฉ ุ ุงุนุชูุงุฏูุง ุนูู ุงููุฑุงุฑุงุช ุงููุชุฎุฐุฉ ุฃุซูุงุก ุนูููุฉ ุงูุชุทููุฑ. ูุง ููุทุจู ูุฐุง ููุท ุนูู ุฅูุดุงุก ุงูุจุทุงูุฉ ุ ูููู ุนูุฏ ุชุทููุฑ ูููุฏ ุจุทุงูุฉ ุฅุฌุฑุงุฆู ุ ุชุญุชุงุฌ ุฅูู ุฅููุงุก ุงูุชูุงู ุฎุงุต ูุฐูู. ููููู ูุถุงุก ุงููุซูุฑ ูู ุงูููุช ูู ุฅูุดุงุก ุฎูุงุฑุฒููุฉ ุชููุฏ ุจุทุงูุงุช ุฌูููุฉ ุชุจูู ุฃููุง ุบูุฑ ูุฌุฏูุฉ ููุนุจุฉ ุงูุชู ุชููู ุจุฅูุดุงุฆูุง.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ูุฐู ุงูุณูุณูุฉ ุงูุชุนููููุฉ ุ ุณูููู ุจุนูู ุฅุบุงุซุฉ ุชุดุจู ุงูุฃุฑุถ. </font><font style="vertical-align: inherit;">ูุฌุจ ุฃู ุชุจุฏู ูุซูุฑุฉ ููุงูุชูุงู ุ ูุน ุชุบูุฑ ูุจูุฑ ูุบูุงุจ ููุงุทู ูุชุฌุงูุณุฉ ูุจูุฑุฉ. </font><font style="vertical-align: inherit;">ุณูููู ุญุฌู ุงูุฅุบุงุซุฉ ูุจูุฑูุง ุ ูุณุชุบุทู ุงูุฎุฑุงุฆุท ูุงุฑุฉ ูุงุญุฏุฉ ุฃู ุฃูุซุฑ ุ ุฃู ููุงุทู ูู ุงููุญูุทุงุช ุ ุฃู ุญุชู ูููุจูุง ูุงููุงู. </font><font style="vertical-align: inherit;">ูุญู ุจุญุงุฌุฉ ุฅูู ุงูุณูุทุฑุฉ ุนูู ุงูุฌุบุฑุงููุง ุ ุจูุง ูู ุฐูู ุงููุชู ุงูุฃุฑุถูุฉ ูุงูููุงุฎ ูุนุฏุฏ ุงูููุงุทู ููุถุฎุงุช ุงูุชุถุงุฑูุณ. </font><font style="vertical-align: inherit;">ูู ูุฐุง ุงูุฌุฒุก ุ ุณูุถุน ุงูุฃุณุงุณ ูุฅูุดุงุก ุงูุณูุดู.</font></font><br><br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงูุดุฑูุน ูู ูุถุน ุงูุชุญุฑูุฑ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุณูุฑูุฒ ุนูู ุงูุฎุฑูุทุฉ ุ ูููุณ ุนูู ุทุฑููุฉ ุงููุนุจ ุ ูุฐูู ุณูููู ูู ุงูุฃูุณุจ ุชุดุบูู ุงูุชุทุจูู ูู ูุถุน ุงูุชุญุฑูุฑ. </font><font style="vertical-align: inherit;">ุจูุถู ูุฐุง ุ ูููููุง ุฑุคูุฉ ุงูุจุทุงูุงุช ุนูู ุงูููุฑ. </font><font style="vertical-align: inherit;">ูุฐูู ุ ุณูู ูุชุบูุฑ ุนู ุทุฑูู </font></font><code>HexMapEditor.Awake</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุถุจุท ูุถุน ุงูุชุญุฑูุฑ ุนูู "true" ูุชุดุบูู ุงููููุฉ ุงูุฃุณุงุณูุฉ ููุชุธููู ูู ูุฐุง ุงููุถุน.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Awake</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { terrainMaterial.DisableKeyword(<span class="hljs-string"><span class="hljs-string">"GRID_ON"</span></span>); Shader.EnableKeyword(<span class="hljs-string"><span class="hljs-string">"HEX_MAP_EDIT_MODE"</span></span>); SetEditMode(<span class="hljs-literal"><span class="hljs-literal">true</span></span>); }</code> </pre> <br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูููุฏ ุงูุจุทุงูุฉ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุธุฑูุง ูุฃู ููุงู ุญุงุฌุฉ ุฅูู ุงููุซูุฑ ูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ูุฅูุดุงุก ุฎุฑุงุฆุท ุฅุฌุฑุงุฆูุฉ ุ ููู ูุถูููุง ูุจุงุดุฑุฉู ุฅูู </font></font><code>HexGrid</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ุจุฏูุงู ูู ุฐูู ุ ุณูููู ุจุฅูุดุงุก ูููู ุฌุฏูุฏ </font></font><code>HexMapGenerator</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ </font></font><code>HexGrid</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููู ูุนุฑู ุนูู. </font><font style="vertical-align: inherit;">ุณูุคุฏู ุฐูู ุฅูู ุชุจุณูุท ุงูุงูุชูุงู ุฅูู ุฎูุงุฑุฒููุฉ ุฃุฎุฑู ุฅุฐุง ููุง ุจุญุงุฌุฉ ุฅูููุง. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุญุชุงุฌ ุงููููุฏ ุฅูู ุงุฑุชุจุงุท ุจุงูุดุจูุฉ ุ ูุฐูู ุณูุถูู ุญููุงู ุนุงููุง ุฅููู. </font><font style="vertical-align: inherit;">ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ูุถูู ุทุฑููุฉ ุนุงูุฉ </font></font><code>GenerateMap</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุชุนุงูู ูุน ุนูู ุงูุฎูุงุฑุฒููุฉ. </font><font style="vertical-align: inherit;">ุณูุนุทููุง ุฃุจุนุงุฏ ุงูุฎุฑูุทุฉ ููุนููุงุช ุ ุซู ูุฌุจุฑูุง ุนูู ุงุณุชุฎุฏุงููุง ูุฅูุดุงุก ุฎุฑูุทุฉ ูุงุฑุบุฉ ุฌุฏูุฏุฉ.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections.Generic; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEngine; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">HexMapGenerator</span></span> : <span class="hljs-title"><span class="hljs-title">MonoBehaviour</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> HexGrid grid; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GenerateMap</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> x, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> z</span></span></span><span class="hljs-function">)</span></span> { grid.CreateMap(x, z); } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃุถู ูุงุฆููุง ูุน ูููู ุฅูู ุงููุดูุฏ </font></font><code>HexMapGenerator</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููู ุจุชูุตููู ุจุงูุดุจูุฉ.</font></font><br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/932/b6e/fd2/932b6efd2dd1809893af27ec7a91c620.png"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุงุฆู ููุดุฆ ุงูุฎุฑูุทุฉ.</font></font></i> <br><br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุชุบููุฑ ูุงุฆูุฉ ุฎุฑูุทุฉ ุฌุฏูุฏุฉ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุณูููู ุจุชุบููุฑูุง </font></font><code>NewMapMenu</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุญูุซ ูููููุง ุฅูุดุงุก ุจุทุงูุงุช ุ ูููุณ ููุท ุฅูุดุงุก ุจุทุงูุงุช ูุงุฑุบุฉ. </font><font style="vertical-align: inherit;">ุณูุชุญูู ูู ูุธุงุฆูู ูู ุฎูุงู ุญูู ููุทูู </font></font><code>generateMaps</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ ูุงูุฐู ูู ูููุฉ ุจุดูู ุงูุชุฑุงุถู </font></font><code>true</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ูููู ุจุฅูุดุงุก ุทุฑููุฉ ุนุงูุฉ ูุชุนููู ูุฐุง ุงูุญูู ุ ููุง ูุนููุง ููุชุจุฏูู ุจูู ุงูุฎูุงุฑุงุช </font></font><code>HexMapEditor</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ุฃุถู ุงูููุชุงุญ ุงูููุงุณุจ ุฅูู ุงููุงุฆูุฉ ููู ุจุชูุตููู ุจุงูุทุฑููุฉ.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> generateMaps = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ToggleMapGeneration</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> toggle</span></span></span><span class="hljs-function">)</span></span> { generateMaps = toggle; }</code> </pre> <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/fc9/9c7/0c9/fc99c70c99095b3565104ef42254859d.png"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุงุฆูุฉ ุจุทุงูุฉ ุฌุฏูุฏุฉ ุจููุชุงุญ. </font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงููุญ ุงููุงุฆูุฉ ุฑุงุจุทูุง ููููุฏ ุงูุฎุฑูุทุฉ. </font><font style="vertical-align: inherit;">ุซู ุณูุถุทุฑ ุฅูู ุงุณุชุฏุนุงุก ุทุฑููุฉ </font></font><code>GenerateMap</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงููููุฏ </font><font style="vertical-align: inherit;">ุฅุฐุง ูุฒู ุงูุฃูุฑ </font><font style="vertical-align: inherit;">ุ ูููุณ ููุท ุชูููุฐ </font></font><code>CreateMap</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุดุจูุฉ.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> HexMapGenerator mapGenerator; โฆ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CreateMap</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> x, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> z</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (generateMaps) { mapGenerator.GenerateMap(x, z); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { hexGrid.CreateMap(x, z); } HexMapCamera.ValidatePosition(); Close(); }</code> </pre> <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/7d1/e98/3d9/7d1e983d927d912b75d9b245219659f1.png"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชูุตูู ุงููููุฏ.</font></font></i> <br><br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงููุตูู ุฅูู ุงูุฎููุฉ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููู ูุนูู ุงููููุฏ ุ ูุญุชุงุฌ ุฅูู ุงููุตูู ุฅูู ุงูุฎูุงูุง. </font><font style="vertical-align: inherit;">ูุญู </font></font><code>HexGrid</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุงููุนู ุงูุทุฑู ุงูุดุงุฆุนุฉ </font></font><code>GetCell</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุชู ุชุชุทูุจ ุฃู ูุงููุงุช ุงูููููุ ุฃู ุงูุฅุญุฏุงุซูุงุช ูุณุฏุณ. </font><font style="vertical-align: inherit;">ูุง ูุญุชุงุฌ ุงููููุฏ ููุนูู ูุน ุฃุญุฏููุง ุฃู ุงูุขุฎุฑ ุ ูุฐูู ูุถูู ุทุฑููุชูู ููุงุณุจุชูู ุณุชุนููุงู </font></font><code>HexGrid.GetCell</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุน ุฅุญุฏุงุซูุงุช ุงูุฅุฒุงุญุฉ ุฃู ููุฑุณ ุงูุฎููุฉ.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> HexCell </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetCell</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> xOffset, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> zOffset</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> cells[xOffset + zOffset * cellCountX]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> HexCell </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetCell</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> cellIndex</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> cells[cellIndex]; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุขู </font></font><code>HexMapGenerator</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููููู ุงุณุชูุจุงู ุงูุฎูุงูุง ูุจุงุดุฑุฉ. </font><font style="vertical-align: inherit;">ุนูู ุณุจูู ุงููุซุงู ุ ุจุนุฏ ุฅูุดุงุก ุฎุฑูุทุฉ ุฌุฏูุฏุฉ ุ ููููู ุงุณุชุฎุฏุงู ุฅุญุฏุงุซูุงุช ุงูุนุดุจ ูุชุนููู ุงูุนุดุจ ูุชุฎููู ุงูุนููุฏ ุงูุฃูุณุท ูู ุงูุฎูุงูุง.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GenerateMap</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> x, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> z</span></span></span><span class="hljs-function">)</span></span> { grid.CreateMap(x, z); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; z; i++) { grid.GetCell(x / <span class="hljs-number"><span class="hljs-number">2</span></span>, i).TerrainTypeIndex = <span class="hljs-number"><span class="hljs-number">1</span></span>; } }</code> </pre> <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/860/aee/119/860aee119f0e000ef290f6c87e61ad05.jpg"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุนููุฏ ูู ุงูุนุดุจ ุนูู ุฎุฑูุทุฉ ุตุบูุฑุฉ. </font></font></i> <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุญุฒูุฉ ุงููุญุฏุฉ</font></font></a> <br><br><h2 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุตูุน ุงูุณูุดู </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุนูุฏ ุฅูุดุงุก ุฎุฑูุทุฉ ุ ูุจุฏุฃ ุชูุงููุง ุจุฏูู ุฃุฑุถ. </font><font style="vertical-align: inherit;">ูููู ูููุฑุก ุฃู ูุชุตูุฑ ุฃู ุงูุนุงูู ููู ูุบููุฑ ุจูุญูุท ูุงุญุฏ ุถุฎู. </font><font style="vertical-align: inherit;">ูุชู ุฅูุดุงุก ุงูุฃุฑุถ ุนูุฏูุง ูุชู ุฏูุน ุฌุฒุก ูู ูุงุน ุงููุญูุท ุฅูู ุฃุนูู ุจุญูุซ ูุฑุชูุน ููู ุงููุงุก. </font><font style="vertical-align: inherit;">ูุญู ุจุญุงุฌุฉ ุฅูู ุชุญุฏูุฏ ููุฏุงุฑ ุงูุฃุฑุถ ุงูุชู ูุฌุจ ุฅูุดุงุคูุง ุจูุฐู ุงูุทุฑููุฉ ุ ุฃูู ุณุชุธูุฑ ูุงูุดูู ุงูุฐู ุณุชููู ุนููู.</font></font><br><br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงุฑูุน ุงูุฑุงุญุฉ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุจุฏุฃ ุตุบูุฑูุง - ูุฑูุน ูุทุนุฉ ุฃุฑุถ ููู ุงููุงุก. </font><font style="vertical-align: inherit;">ููุดุฆ ููุฐุง ุงูุฃุณููุจ </font></font><code>RaiseTerrain</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุน ูุนููุฉ ููุชุญูู ูู ุญุฌู ุงููุคุงูุฑุฉ. </font><font style="vertical-align: inherit;">ุงุณุชุฏุนุงุก ูุฐู ุงูุทุฑููุฉ ูู </font></font><code>GenerateMap</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงุณุชุจุฏุงู ุฑูุฒ ุงูุงุฎุชุจุงุฑ ุงูุณุงุจู. </font><font style="vertical-align: inherit;">ููุจุฏุฃ ุจูุทุนุฉ ุฃุฑุถ ุตุบูุฑุฉ ุชุชููู ูู ุณุจุน ุฎูุงูุง.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GenerateMap</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> x, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> z</span></span></span><span class="hljs-function">)</span></span> { grid.CreateMap(x, z); <span class="hljs-comment"><span class="hljs-comment">// for (int i = 0; i &lt; z; i++) { // grid.GetCell(x / 2, i).TerrainTypeIndex = 1; // } RaiseTerrain(7); } void RaiseTerrain (int chunkSize) {}</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุญุชู ุงูุขู ุ ูุณุชุฎุฏู ููุน ุงูุฅุบุงุซุฉ "ุงูุนุดุจ" ููุฅุดุงุฑุฉ ุฅูู ุงูุฃุฑุถ ุงููุฑุชูุนุฉ ุ ูููุด "ุงูุฑูุงู" ุงูุฃุตูู ูุดูุฑ ุฅูู ุงููุญูุท. </font><font style="vertical-align: inherit;">ุงุฌุนููุง </font></font><code>RaiseTerrain</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฃุฎุฐ ุฎููุฉ ุนุดูุงุฆูุฉ ููุบูุฑ ููุน ุงุฑุชูุงุญูุง ุญุชู ูุญุตู ุนูู ุงููุณุงุญุฉ ุงูููุงุณุจุฉ ูู ุงูุฃุฑุถ. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุญุตูู ุนูู ุฎููุฉ ุนุดูุงุฆูุฉ ุ ูุถูู ุทุฑููุฉ </font></font><code>GetRandomCell</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุญุฏุฏ ููุฑุณ ุฎููุฉ ุนุดูุงุฆูุฉ ูุชุญุตู ุนูู ุงูุฎููุฉ ุงูููุงุจูุฉ ูู ุงูุดุจูุฉ.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RaiseTerrain</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> chunkSize</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; chunkSize; i++) { GetRandomCell().TerrainTypeIndex = <span class="hljs-number"><span class="hljs-number">1</span></span>; } } <span class="hljs-function"><span class="hljs-function">HexCell </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetRandomCell</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> grid.GetCell(Random.Range(<span class="hljs-number"><span class="hljs-number">0</span></span>, grid.cellCountX * grid.cellCountZ)); }</code> </pre> <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/396/fb8/ce6/396fb8ce67de74961b31562e275bd81a.jpg"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุณุจุน ุฎูุงูุง ุณูุดู ุนุดูุงุฆูุฉ. </font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุธุฑูุง ูุฃูู ูู ุงูููุงูุฉ ูุฏ ูุญุชุงุฌ ุฅูู ุงููุซูุฑ ูู ุงูุฎูุงูุง ุงูุนุดูุงุฆูุฉ ุฃู ุงูุชูุฑุงุฑ ุนุจุฑ ุฌููุน ุงูุฎูุงูุง ุนุฏุฉ ูุฑุงุช ุ ุฏุนูุง ูุชุชุจุน ุนุฏุฏ ุงูุฎูุงูุง ูู ุงูุฎููุฉ ููุณูุง </font></font><code>HexMapGenerator</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> cellCount; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GenerateMap</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> x, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> z</span></span></span><span class="hljs-function">)</span></span> { cellCount = x * z; โฆ } โฆ <span class="hljs-function"><span class="hljs-function">HexCell </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetRandomCell</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> grid.GetCell(Random.Range(<span class="hljs-number"><span class="hljs-number">0</span></span>, cellCount)); }</code> </pre> <br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุฅูุดุงุก ูููุน ูุงุญุฏ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุญุชู ุงูุขู ุ ูููู ุจุชุญููู ุณุจุน ุฎูุงูุง ุนุดูุงุฆูุฉ ุฅูู ุฃุฑุถ ุ ููููู ุฃู ุชููู ูู ุฃู ููุงู. </font><font style="vertical-align: inherit;">ุนูู ุงูุฃุฑุฌุญ ุฃููู ูุง ูุดูููู ูุณุงุญุฉ ุฃุฑุถ ูุงุญุฏุฉ. </font><font style="vertical-align: inherit;">ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ูููููุง ุชุญุฏูุฏ ุงูุฎูุงูุง ููุณูุง ุนุฏุฉ ูุฑุงุช ุ ุญุชู ูุญุตู ุนูู ูุณุงุญุฉ ุฃูู. </font><font style="vertical-align: inherit;">ูุญู ููุชุง ุงููุดููุชูู ุ ุจุฏูู ูููุฏ ุ ุณูุฎุชุงุฑ ุงูุฎููุฉ ุงูุฃููู ููุท. </font><font style="vertical-align: inherit;">ุจุนุฏ ุฐูู ุ ูุฌุจ ุฃู ูุฎุชุงุฑ ููุท ุงูุฎูุงูุง ุงููุฌุงูุฑุฉ ููุฎูุงูุง ุงููุญุฏุฏุฉ ุณุงุจููุง. </font><font style="vertical-align: inherit;">ุชุดุจู ูุฐู ุงููููุฏ ูููุฏ ุงูุจุญุซ ุนู ุงููุณุงุฑ ุ ูุฐูู ูุณุชุฎุฏู ููุณ ุงูููุฌ ููุง. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุถูู </font></font><code>HexMapGenerator</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุชููุงุชูุง ุงูุฎุงุตุฉ ูุนุฏุงุฏ ูุฑุญูุฉ ุญุฏูุฏ ุงูุจุญุซ ุ ููุง ูุงูุช </font></font><code>HexGrid</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> HexCellPriorityQueue searchFrontier; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> searchFrontierPhase;</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุชุญูู ูู ูุฌูุฏ ูุงุฆูุฉ ุงูุชุธุงุฑ ุงูุฃููููุฉ ูุจู ุฃู ูุญุชุงุฌ ุฅูููุง. </font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GenerateMap</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> x, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> z</span></span></span><span class="hljs-function">)</span></span> { cellCount = x * z; grid.CreateMap(x, z); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (searchFrontier == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { searchFrontier = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HexCellPriorityQueue(); } RaiseTerrain(<span class="hljs-number"><span class="hljs-number">7</span></span>); }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุนุฏ ุฅูุดุงุก ุฎุฑูุทุฉ ุฌุฏูุฏุฉ ุ ูููู ุญุฏ ุงูุจุญุซ ูุฌููุน ุงูุฎูุงูุง ุตูุฑูุง. ูููู ุฅุฐุง ุฃุฑุฏูุง ุงูุจุญุซ ุนู ุงูุฎูุงูุง ูู ุนูููุฉ ุฅูุดุงุก ุงูุฎุฑูุทุฉ ุ ูุณูุฒูุฏ ุญุฏูุฏ ุงูุจุญุซ ูู ูุฐู ุงูุนูููุฉ. ุฅุฐุง ูููุง ุจุฅุฌุฑุงุก ุงูุนุฏูุฏ ูู ุนูููุงุช ุงูุจุญุซ ุ ููุฏ ุชููู ูุจู ูุฑุญูุฉ ุญุฏูุฏ ุงูุจุญุซ ุงููุณุฌูุฉ </font></font><code>HexGrid</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. ูุฏ ูุชุฏุงุฎู ูุฐุง ูุน ุงูุจุญุซ ุนู ูุณุงุฑุงุช ุงููุญุฏุฉ. ูุชุฌูุจ ุฐูู ุ ูู ููุงูุฉ ุนูููุฉ ุฅูุดุงุก ุงูุฎุฑูุทุฉ ุ ุณูุนูุฏ ุถุจุท ูุฑุญูุฉ ุงูุจุญุซ ูุฌููุน ุงูุฎูุงูุง ุฅูู ุตูุฑ.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> RaiseTerrain(<span class="hljs-number"><span class="hljs-number">7</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; cellCount; i++) { grid.GetCell(i).SearchPhase = <span class="hljs-number"><span class="hljs-number">0</span></span>; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุขู </font></font><code>RaiseTerrain</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฌุจ ุฃู ุฃุจุญุซ ุนู ุงูุฎูุงูุง ุงูููุงุณุจุฉ ุ ูุฃู ูุง ุฃุฎุชุงุฑูุง ุจุดูู ุนุดูุงุฆู. ูุฐู ุงูุนูููุฉ ุชุดุจู ุฅูู ุญุฏ ูุจูุฑ ุทุฑููุฉ ุงูุจุญุซ ูู </font></font><code>HexGrid</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. ููุน ุฐูู ุ ูู ูููู ุจุฒูุงุฑุฉ ุงูุฎูุงูุง ุฃูุซุฑ ูู ูุฑุฉ ุ ูุฐุง ุณูููู ูุงููุงู ุจุงููุณุจุฉ ููุง ูุฒูุงุฏุฉ ูุฑุญูุฉ ุญุฏ ุงูุจุญุซ ุจููุฏุงุฑ 1 ุจุฏูุงู ูู 2. ุซู ูููู ุจุชููุฆุฉ ุงูุญุฏูุฏ ุจุงูุฎููุฉ ุงูุฃููู ุ ุงูุชู ูุชู ุชุญุฏูุฏูุง ุนุดูุงุฆููุง. ูุงูุนุงุฏุฉ ุ ุจุงูุฅุถุงูุฉ ุฅูู ุชุญุฏูุฏ ูุฑุญูุฉ ุงูุจุญุซ ุ ูุฅููุง ูุฎุตุต ุงููุณุงูุฉ ูุงูููุฌู ุฅูู ุงูุตูุฑ.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RaiseTerrain</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> chunkSize</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-comment"><span class="hljs-comment">// for (int i = 0; i &lt; chunkSize; i++) { // GetRandomCell().TerrainTypeIndex = 1; // } searchFrontierPhase += 1; HexCell firstCell = GetRandomCell(); firstCell.SearchPhase = searchFrontierPhase; firstCell.Distance = 0; firstCell.SearchHeuristic = 0; searchFrontier.Enqueue(firstCell); }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุนุฏ ุฐูู ุ ุณุชููู ุญููุฉ ุงูุจุญุซ ูุฃูููุฉ ููุง ูู ุงูุบุงูุจ. </font><font style="vertical-align: inherit;">ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ูููุงุตูุฉ ุงูุจุญุซ ุญุชู ุชุตุจุญ ุงูุญุฏูุฏ ูุงุฑุบุฉ ุ ูุญุชุงุฌ ุฅูู ุงูุชููู ุนูุฏูุง ูุตู ุงูุฌุฒุก ุฅูู ุงูุญุฌู ุงููุทููุจ ุ ูุฐูู ุณูุชุชุจุนู. </font><font style="vertical-align: inherit;">ูู ูู ุชูุฑุงุฑ ุ ุณูููู ุจุงุณุชุฎุฑุงุฌ ุงูุฎููุฉ ุงูุชุงููุฉ ูู ูุงุฆูุฉ ุงูุงูุชุธุงุฑ ุ ูุชุนููู ููุน ุงุฑุชูุงุญูุง ุ ูุฒูุงุฏุฉ ุงูุญุฌู ุ ุซู ุชุฌุงูุฒ ุฌูุฑุงู ูุฐู ุงูุฎููุฉ. </font><font style="vertical-align: inherit;">ุชุชู ุฅุถุงูุฉ ุฌููุน ุงูุฌูุฑุงู ุจุจุณุงุทุฉ ุฅูู ุงูุญุฏูุฏ ุฅุฐุง ูู ุชุชู ุฅุถุงูุชูู ููุงู ุจุนุฏ. </font><font style="vertical-align: inherit;">ูุณูุง ุจุญุงุฌุฉ ูุฅุฌุฑุงุก ุฃู ุชุบููุฑุงุช ุฃู ููุงุฑูุงุช. </font><font style="vertical-align: inherit;">ุจุนุฏ ุงูุงูุชูุงุก ุ ุชุญุชุงุฌ ุฅูู ูุณุญ ุงูุญุฏูุฏ.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> searchFrontier.Enqueue(firstCell); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> size = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (size &lt; chunkSize &amp;&amp; searchFrontier.Count &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { HexCell current = searchFrontier.Dequeue(); current.TerrainTypeIndex = <span class="hljs-number"><span class="hljs-number">1</span></span>; size += <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (HexDirection d = HexDirection.NE; d &lt;= HexDirection.NW; d++) { HexCell neighbor = current.GetNeighbor(d); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (neighbor &amp;&amp; neighbor.SearchPhase &lt; searchFrontierPhase) { neighbor.SearchPhase = searchFrontierPhase; neighbor.Distance = <span class="hljs-number"><span class="hljs-number">0</span></span>; neighbor.SearchHeuristic = <span class="hljs-number"><span class="hljs-number">0</span></span>; searchFrontier.Enqueue(neighbor); } } } searchFrontier.Clear();</code> </pre> <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/97a/f44/023/97af440236cb6909130d6a8bfaab3f5a.jpg"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฎุท ูู ุงูุฎูุงูุง. </font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุฏ ุญุตููุง ุนูู ูุทุนุฉ ูุงุญุฏุฉ ูู ุงูุญุฌู ุงูุตุญูุญ. </font><font style="vertical-align: inherit;">ุณูููู ุฃุตุบุฑ ููุท ุฅุฐุง ูู ููู ููุงู ุนุฏุฏ ูุงู ูู ุงูุฎูุงูุง. </font><font style="vertical-align: inherit;">ุจุณุจุจ ุทุฑููุฉ ููุก ุงูุญุฏูุฏ ุ ุชุชููู ุงููุคุงูุฑุฉ ุฏุงุฆููุง ูู ุฎุท ููุชุฏ ุดูุงู ุบุฑุจ. </font><font style="vertical-align: inherit;">ูุบูุฑ ุงูุงุชุฌุงู ููุท ุนูุฏูุง ูุตู ุฅูู ุญุงูุฉ ุงูุฎุฑูุทุฉ.</font></font><br><br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุญู ูุฑุจุท ุงูุฎูุงูุง </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุงุฏุฑูุง ูุง ุชุดุจู ูุณุงุญุงุช ุงูุฃุฑุงุถู ุงูุฎุทูุท ุ ูุฅุฐุง ูุงูุช ูุฐูู ุ ูุฅููุง ูุง ุชููู ุฏุงุฆููุง ููุฌูุฉ ุจููุณ ุงูุทุฑููุฉ. </font><font style="vertical-align: inherit;">ูุชุบููุฑ ุดูู ุงููููุน ุ ูุญุชุงุฌ ุฅูู ุชุบููุฑ ุฃููููุงุช ุงูุฎูุงูุง. </font><font style="vertical-align: inherit;">ูููู ุงุณุชุฎุฏุงู ุงูุฎููุฉ ุงูุนุดูุงุฆูุฉ ุงูุฃููู ููุฑูุฒ ููุฑุณู. </font><font style="vertical-align: inherit;">ุซู ุณุชููู ุงููุณุงูุฉ ุฅูู ุฌููุน ุงูุฎูุงูุง ุงูุฃุฎุฑู ูุณุจุฉ ุฅูู ูุฐู ุงูููุทุฉ. </font><font style="vertical-align: inherit;">ูุฐูู ุณูุนุทู ุฃููููุฉ ุฃุนูู ููุฎูุงูุง ุงูุฃูุฑุจ ุฅูู ุงููุฑูุฒ ุ ูุฐูู ูู ูููู ุงููููุน ูุฎุท ุ ูููู ุญูู ุงููุฑูุฒ.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> searchFrontier.Enqueue(firstCell); HexCoordinates center = firstCell.coordinates; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> size = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (size &lt; chunkSize &amp;&amp; searchFrontier.Count &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { HexCell current = searchFrontier.Dequeue(); current.TerrainTypeIndex = <span class="hljs-number"><span class="hljs-number">1</span></span>; size += <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (HexDirection d = HexDirection.NE; d &lt;= HexDirection.NW; d++) { HexCell neighbor = current.GetNeighbor(d); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (neighbor &amp;&amp; neighbor.SearchPhase &lt; searchFrontierPhase) { neighbor.SearchPhase = searchFrontierPhase; neighbor.Distance = neighbor.coordinates.DistanceTo(center); neighbor.SearchHeuristic = <span class="hljs-number"><span class="hljs-number">0</span></span>; searchFrontier.Enqueue(neighbor); } } }</code> </pre> <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/841/117/149/84111714960a293415b1d24edf92f56b.jpg"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุฑุงูู ุงูุฎูุงูุง. </font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููู ุงููุงูุน ุ ุงูุขู ุชูุชูุฆ ุฎูุงูุงูุง ุงูุณุจุน ุจุดูู ุฌููู ูู ููุทูุฉ ุณุฏุงุณูุฉ ูุถุบูุทุฉ ุฅุฐุง ูู ุชุธูุฑ ุงูุฎููุฉ ุงููุฑูุฒูุฉ ุนูู ุญุงูุฉ ุงูุฎุฑูุทุฉ. </font><font style="vertical-align: inherit;">ุฏุนูุง ูุญุงูู ุงูุขู ุงุณุชุฎุฏุงู ูุทุนุฉ ุฃุฑุถ ุจุญุฌู 30.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> RaiseTerrain(<span class="hljs-number"><span class="hljs-number">30</span></span>);</code> </pre> <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/893/c36/13e/893c3613edfe02b457cc4ee6d191072c.jpg"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุชูุฉ ุณูุดู ูู 30 ุฎููุฉ. </font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุญุตููุง ูุฑุฉ ุฃุฎุฑู ุนูู ููุณ ุงูุดูู ุ ุนูู ุงูุฑุบู ูู ุนุฏู ูุฌูุฏ ุฎูุงูุง ูุงููุฉ ููุญุตูู ุนูู ุงูุณุฏุงุณู ุงูุตุญูุญ. </font><font style="vertical-align: inherit;">ูุธุฑูุง ูุฃู ูุตู ูุทุฑ ุงููุฎุทุท ุฃูุจุฑ ุ ููู ุงููุฑุฌุญ ุฃู ูููู ูุฑูุจูุง ูู ุญุงูุฉ ุงูุฎุฑูุทุฉ ุ ููุง ุณูุฌุจุฑูุง ุนูู ุงุชุฎุงุฐ ุดูู ูุฎุชูู.</font></font><br><br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงูุนุดูุงุฆูุฉ ุงูุณูุดู </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุง ูุฑูุฏ ุฃู ุชุจุฏู ุฌููุน ุงูููุงุทู ูุชุดุงุจูุฉ ุ ูุฐูู ุณูุบูุฑ ุฃููููุงุช ุงูุฎููุฉ ููููุงู. </font><font style="vertical-align: inherit;">ูู ูู ูุฑุฉ ูุถูู ูููุง ุฎููุฉ ูุฌุงูุฑุฉ ุฅูู ุงูุญุฏูุฏ ุ ุฅุฐุง ูุงู ุงูุฑูู ุงูุชุงูู </font></font><code>Random.value</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃูู ูู ูููุฉ ุญุฏ ูุนููุฉ ุ ูุฅู ุงูุชูุฌูู ูู ูุฐู ุงูุฎููุฉ ูุง ูุตุจุญ 0 ุ ูููู 1. ููุณุชุฎุฏู ุงููููุฉ 0.5 ูุนุชุจุฉ ุ ุฃู ุฃููุง ุณุชุคุซุฑ ุนูู ุงูุฃุฑุฌุญ ุนูู ูุตู ุงูุฎูุงูุง.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> neighbor.Distance = neighbor.coordinates.DistanceTo(center); neighbor.SearchHeuristic = Random.<span class="hljs-keyword"><span class="hljs-keyword">value</span></span> &lt; <span class="hljs-number"><span class="hljs-number">0.5f</span></span> ? <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>; searchFrontier.Enqueue(neighbor);</code> </pre> <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/43e/aec/793/43eaec79315f68e0618fe71c0f93c3f3.jpg"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุทูุฉ ูุดููุฉ.</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูู ุฎูุงู ุฒูุงุฏุฉ ุงูุจุญุซ ุนู ุงูุจุญุซ ุนู ุงูุฎููุฉ ุ ูููุง ุจุฒูุงุฑุชูุง ูู ููุช ูุชุฃุฎุฑ ุนู ุงููุชููุน. ูู ุงูููุช ููุณู ุ ุณูุชู ุฒูุงุฑุฉ ุงูุฎูุงูุง ุงูุฃุฎุฑู ุงูููุฌูุฏุฉ ุนูู ุจุนุฏ ุฎุทูุฉ ูุงุญุฏุฉ ูู ุงููุฑูุฒ ูู ููุช ุณุงุจู ุ ูุง ูู ุชุฒูุฏ ุฃูุถูุง ูู ุงูุงุณุชุฏูุงู. ูุฐุง ูุนูู ุฃูู ุฅุฐุง ูููุง ุจุฒูุงุฏุฉ ุงูุชูุฌูู ูุฌููุน ุงูุฎูุงูุง ุจูููุฉ ูุงุญุฏุฉ ุ ููู ูุคุซุฑ ุฐูู ุนูู ุงูุฎุฑูุทุฉ. ุฃู ุฃู ุงูุนุชุจุฉ 1 ูู ูููู ููุง ุชุฃุซูุฑ ุ ูุซู ุงูุนุชุจุฉ 0. ูุงูุนุชุจุฉ 0.8 ุณุชููู ูุณุงููุฉ ูู 0.2. ุฃู ุฃู ุงุญุชูุงููุฉ 0.5 ุชุฌุนู ุนูููุฉ ุงูุจุญุซ ูู ุงูุฃูุซุฑ "ุงุฑุชุฌุงููุง". </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุนุชูุฏ ูููุฉ ุงูุชุฐุจุฐุจ ุงูููุงุณุจุฉ ุนูู ููุน ุงูุชุถุงุฑูุณ ุงููุทููุจ ุ ูุฐุง ุฏุนูุง ูุฎุตุตู. ูู ุจุฅุถุงูุฉ ุญูู ุนุงุฆู ุนุงู </font></font><code>jitterProbability</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุน ุงูุณูุฉ </font><font style="vertical-align: inherit;">ุฅูู ุงููููุฏ</font></font><code>Range</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุญุฏูุฏุฉ ูู ูุทุงู 0-0.5. </font><font style="vertical-align: inherit;">ุฏุนููุง ูุนุทููุง ูููุฉ ุงูุชุฑุงุถูุฉ ุชุณุงูู ูุชูุณุท โโูุฐู ุงููุชุฑุฉ ุ ุฃู 0.25. </font><font style="vertical-align: inherit;">ุณูุชูุญ ููุง ุฐูู ุชูููู ุงููููุฏ ูู ูุงูุฐุฉ ููุชุด ุงููุญุฏุฉ.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> [<span class="hljs-meta"><span class="hljs-meta">Range(0f, 0.5f)</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> jitterProbability = <span class="hljs-number"><span class="hljs-number">0.25f</span></span>;</code> </pre> <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/795/b50/381/795b50381d8c9cda219ff092cf64cee5.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงุญุชูุงู ุงูุชููุจุงุช. </font></font><br><br><div class="spoiler" style=";text-align:right;direction:rtl"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ููููู ุฌุนูู ูุงุจูุงู ููุชุฎุตูุต ูู ูุงุฌูุฉ ูุณุชุฎุฏู ุงููุนุจุฉุ</font></font></b> <div class="spoiler_text" style=";text-align:right;direction:rtl">  ,       .           UI,       .          ,      UI.  ,     .         ,       . </div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงูุขู ุ ูุงุชุฎุงุฐ ูุฑุงุฑ ุจุดุฃู ุงูููุช ุงูุฐู ูุฌุจ ุฃู ูููู ููู ุงูุชูุฌูู ูุณุงูู 1 ุ ูุณุชุฎุฏู ุงูุงุญุชูุงููุฉ ุจุฏูุงู ูู ุงููููุฉ ุงูุซุงุจุชุฉ. </font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> neighbor.SearchHeuristic = Random.<span class="hljs-keyword"><span class="hljs-keyword">value</span></span> &lt; jitterProbability ? <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>;</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุณุชุฎุฏู ููููุง ุงุณุชูุดุงููุฉ ูู 0 ู 1. ุนูู ุงูุฑุบู ูู ุฃูู ูููู ุงุณุชุฎุฏุงู ุงูููู ุงูุฃูุจุฑ ุ ุฅูุง ุฃู ูุฐุง ุณูุฒูุฏ ูู ุชุดูู ุงูุฃูุณุงู ุจุดูู ูุจูุฑ ุ ุนูู ุงูุฃุฑุฌุญ ุชุญููููุง ุฅูู ูุฌููุนุฉ ูู ุงูุฎุทูุท. </font></font><br><br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงุฑูุนูุง ุจุนุถ ุงูุฃุฑุถ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ููุชุตุฑ ุนูู ุฅูุดุงุก ูุณุงุญุฉ ุฃุฑุถ ูุงุญุฏุฉ. </font><font style="vertical-align: inherit;">ุนูู ุณุจูู ุงููุซุงู ุ ูุถุน ููุงููุฉ </font></font><code>RaiseTerrain</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฏุงุฎู ุญููุฉ ููุญุตูู ุนูู ุฎูุณุฉ ุฃูุณุงู.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-number"><span class="hljs-number">5</span></span>; i++) { RaiseTerrain(<span class="hljs-number"><span class="hljs-number">30</span></span>); }</code> </pre> <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/d42/83f/acd/d4283facd88705107d705290c3d8e78b.jpg"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฎูุณ ูุทุน ุฃุฑุถ. </font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุนูู ุงูุฑุบู ูู ุฃููุง ุงูุขู ูููุฏ ุฎูุณ ูุทุน ุฃุฑุถ ูู 30 ุฎููุฉ ููู ูููุง ุ ูููู ููุณ ุจุงูุถุฑูุฑุฉ ุฃู ูุญุตู ุนูู 150 ุฎููุฉ ุจุงูุถุจุท ูู ุงูุฃุฑุถ. </font><font style="vertical-align: inherit;">ูุธุฑูุง ูุฃู ูู ูููุน ูุชู ุฅูุดุงุคู ุจุดูู ูููุตู ุ ูุฅููู ูุง ูุนุฑููู ุนู ุจุนุถูู ุงูุจุนุถ ุ ุญุชู ูุชููููุง ูู ุงูุชูุงุทุน. </font><font style="vertical-align: inherit;">ูุฐุง ุฃูุฑ ุทุจูุนู ูุฃูู ูููู ุฃู ูุฎูู ููุงุธุฑ ุทุจูุนูุฉ ุฃูุซุฑ ุฅุซุงุฑุฉ ููุงูุชูุงู ูู ูุฌุฑุฏ ูุฌููุนุฉ ูู ุงูุฃูุณุงู ุงููุนุฒููุฉ. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฒูุงุฏุฉ ุชููุน ุงูุฃุฑุถ ุ ูููููุง ุฃูุถูุง ุชุบููุฑ ุญุฌู ูู ูุทุนุฉ ุฃุฑุถ. </font><font style="vertical-align: inherit;">ุฃุถู ุญููู ุนุฏุฏ ุตุญูุญูู ููุชุญูู ูู ุงูุญุฏ ุงูุฃุฏูู ูุงูุญุฏ ุงูุฃูุตู ูุฃุญุฌุงู ุงููุทุน. </font><font style="vertical-align: inherit;">ูู ุจุชุนููู ูุงุตู ุฒููู ูุจูุฑ ุจูุง ููู ุงูููุงูุฉ ุ ุนูู ุณุจูู ุงููุซุงู ุ 20-200. </font><font style="vertical-align: inherit;">ุณุฃุฌุนู ุงูุญุฏ ุงูุฃุฏูู ุงูููุงุณู ูุณุงูู 30 ุ ูุงูุญุฏ ุงูุฃูุตู ุงูููุงุณู - 100.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> [<span class="hljs-meta"><span class="hljs-meta">Range(20, 200)</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> chunkSizeMin = <span class="hljs-number"><span class="hljs-number">30</span></span>; [Range(<span class="hljs-number"><span class="hljs-number">20</span></span>, <span class="hljs-number"><span class="hljs-number">200</span></span>)] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> chunkSizeMax = <span class="hljs-number"><span class="hljs-number">100</span></span>;</code> </pre> <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/9ea/026/e43/9ea026e43e949f571be0358332447de5.png"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงููุงุตู ุงูุฒููู ุงูุชุญุฌูู. </font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุณุชุฎุฏู ูุฐู ุงูุญููู ูุชุญุฏูุฏ ุญุฌู ุงูููุทูุฉ ุจุดูู ุนุดูุงุฆู ุนูุฏ ุงุณุชุฏุนุงุฆูุง </font></font><code>RaiseTerrain</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> RaiseTerrain(Random.Range(chunkSizeMin, chunkSizeMax + <span class="hljs-number"><span class="hljs-number">1</span></span>));</code> </pre> <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/0df/124/dab/0df124dab1f706825f75304d2862aea3.jpg"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฎูุณุฉ ุฃูุณุงู ุจุญุฌู ุนุดูุงุฆู ุนูู ุงูุฎุฑูุทุฉ ุงููุณุทู.</font></font></i> <br><br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงุตูุน ูุง ูููู ูู ุงูุณูุดู </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ุญูู ุฃููุง ูุง ูุณุชุทูุน ุงูุณูุทุฑุฉ ุจุดูู ุฎุงุต ุนูู ูุณุงุญุฉ ุงูุฃุฑุงุถู ุงููุชููุฏุฉ. </font><font style="vertical-align: inherit;">ุนูู ุงูุฑุบู ูู ุฃูู ูููููุง ุฅุถุงูุฉ ุฎูุงุฑ ุงูุชูููู ูุนุฏุฏ ุงููุทุน ุ ุฅูุง ุฃู ูุทุน ุงูุฃุฑุถ ููุณูุง ุนุดูุงุฆูุฉ ุงูุญุฌู ููุฏ ุชุชุฏุงุฎู ููููุงู ุฃู ุจููุฉ. </font><font style="vertical-align: inherit;">ูุฐูู ุ ูุฅู ุนุฏุฏ ุงูููุงูุน ูุง ูุถูู ุงุณุชูุงู ุงููููุฉ ุงููุทููุจุฉ ูู ุงูุฃุฑุถ ุนูู ุงูุฎุฑูุทุฉ. </font><font style="vertical-align: inherit;">ุฏุนูุง ูุถูู ุฎูุงุฑูุง ููุชุญูู ุงููุจุงุดุฑ ูู ุงููุณุจุฉ ุงููุฆููุฉ ููุฃุฑุถ ุงููุนุจุฑ ุนููุง ูุนุฏุฏ ุตุญูุญ. </font><font style="vertical-align: inherit;">ูุธุฑูุง ูุฃู 100 ูช ูู ุงูุฃุฑุงุถู ุฃู ุงูููุงู ููุณุช ูุซูุฑุฉ ููุงูุชูุงู ููุบุงูุฉ ุ ูุฅููุง ููุตุฑูุง ุนูู ุงููุงุตู ุงูุฒููู 5-95 ุ ุจูููุฉ 50 ุงูุชุฑุงุถููุง.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> [<span class="hljs-meta"><span class="hljs-meta">Range(5, 95)</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> landPercentage = <span class="hljs-number"><span class="hljs-number">50</span></span>;</code> </pre> <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/21e/281/912/21e281912ad5a4a5378c5e55514c639c.png"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุณุจุฉ ุงูุณูุดู. </font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุถูุงู ุฅูุดุงุก ุงููุณุงุญุฉ ุงูููุงุณุจุฉ ูู ุงูุฃุฑุถ ุ ูุญุชุงุฌ ููุท ุฅูู ุงูุงุณุชูุฑุงุฑ ูู ุฑูุน ูุณุงุญุงุช ุงูุชุถุงุฑูุณ ุญุชู ูุญุตู ุนูู ูููุฉ ูุงููุฉ. </font><font style="vertical-align: inherit;">ููููุงู ุจุฐูู ุ ูุญู ุจุญุงุฌุฉ ููุณูุทุฑุฉ ุนูู ุงูุนูููุฉ ุ ุงูุฃูุฑ ุงูุฐู ุณูุนูุฏ ุชุนููุฏ ุชูููุฏ ุงูุฃุฑุถ. </font><font style="vertical-align: inherit;">ูุฐูู ุ ุฏุนูุง ูุณุชุจุฏู ุงูุฏูุฑุฉ ุงูุญุงููุฉ ูุฑูุน ุงูููุงูุน ุนู ุทุฑูู ุงุณุชุฏุนุงุก ุทุฑููุฉ ุฌุฏูุฏุฉ </font></font><code>CreateLand</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ุฃูู ุดูุก ุชูุนูู ูุฐู ุงูุทุฑููุฉ ูู ุญุณุงุจ ุนุฏุฏ ุงูุฎูุงูุง ุงูุชู ูุฌุจ ุฃู ุชุตุจุญ ุฃุฑุถูุง. </font><font style="vertical-align: inherit;">ุณูููู ูุฐุง ุงููุจูุบ ุฅุฌูุงูู ูุฌููุน ุฎูุงูุง ุงูุณูุดู ูุฏููุง.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GenerateMap</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> x, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> z</span></span></span><span class="hljs-function">)</span></span> { โฆ <span class="hljs-comment"><span class="hljs-comment">// for (int i = 0; i &lt; 5; i++) { // RaiseTerrain(Random.Range(chunkSizeMin, chunkSizeMax + 1)); // } CreateLand(); for (int i = 0; i &lt; cellCount; i++) { grid.GetCell(i).SearchPhase = 0; } } void CreateLand () { int landBudget = Mathf.RoundToInt(cellCount * landPercentage * 0.01f); }</span></span></code> </pre> <br> <code>CreateLand</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุณูู ูุณุจุจ </font></font><code>RaiseTerrain</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุญุชู ูููู ูุงูู ูููุฉ ุงูุฎูุงูุง. </font><font style="vertical-align: inherit;">ููู ูุง ูุชุฌุงูุฒ ุงููุจูุบ ุ ูููู ุจุชุบููุฑู </font></font><code>RaiseTerrain</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุญูุซ ูุชููู ุงููุจูุบ ููุนููุฉ ุฅุถุงููุฉ. </font><font style="vertical-align: inherit;">ุจุนุฏ ุงูุงูุชูุงุก ูู ุงูุนูู ุนููู ุฅุนุงุฏุฉ ุงููุจูุบ ุงููุชุจูู.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">// void RaiseTerrain (int chunkSize) { int RaiseTerrain (int chunkSize, int budget) { โฆ return budget; }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฌุจ ุฃู ููุฎูุถ โโุงููุจูุบ ูู ูู ูุฑุฉ ุชุชู ุฅุฒุงูุฉ ุงูุฎููุฉ ูู ุงูุญุฏูุฏ ูุชุญููููุง ุฅูู ุฃุฑุถ. </font><font style="vertical-align: inherit;">ุฅุฐุง ุชู ุฅููุงู ุงููุจูุบ ุจุงููุงูู ุจุนุฏ ุฐูู ุ ููุฌุจ ุนูููุง ุฅููุงู ุงูุจุญุซ ูุฅููุงู ุงููููุน. </font><font style="vertical-align: inherit;">ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ูุฌุจ ุฃู ูุชู ุฐูู ููุท ุนูุฏูุง ุชููู ุงูุฎููุฉ ุงูุญุงููุฉ ูู ุชูุจุท ุจุนุฏ.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (size &lt; chunkSize &amp;&amp; searchFrontier.Count &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { HexCell current = searchFrontier.Dequeue(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (current.TerrainTypeIndex == <span class="hljs-number"><span class="hljs-number">0</span></span>) { current.TerrainTypeIndex = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (--budget == <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } } size += <span class="hljs-number"><span class="hljs-number">1</span></span>; โฆ }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุขู </font></font><code>CreateLand</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูููููุง ุฑูุน ุงูุฃุฑุถ ุญุชู ุชููู ูุงูู ูููุฉ ุงูุฎูุงูุง.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CreateLand</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> landBudget = Mathf.RoundToInt(cellCount * landPercentage * <span class="hljs-number"><span class="hljs-number">0.01f</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (landBudget &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { landBudget = RaiseTerrain( Random.Range(chunkSizeMin, chunkSizeMax + <span class="hljs-number"><span class="hljs-number">1</span></span>), landBudget ); } }</code> </pre> <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/d15/34e/7f4/d1534e7f47ba4cf87f3dbeed60aa7d00.jpg"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃุตุจุญ ูุตู ุงูุฎุฑูุทุฉ ุจุงูุถุจุท ุฃุฑุถูุง. </font></font></i> <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุญุฒูุฉ ุงููุญุฏุฉ</font></font></a> <br><br><h2 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุฎุฐ ุจุนูู ุงูุงุนุชุจุงุฑ ุงูุงุฑุชูุงุน </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุฃุฑุถ ููุณุช ูุฌุฑุฏ ููุญุฉ ูุณุทุญุฉ ุ ูุญุฏูุฏุฉ ุจุงูุณุงุญู. </font><font style="vertical-align: inherit;">ูุฏููุง ุงุฑุชูุงุน ูุชุบูุฑ ุ ูุญุชูู ุนูู ุงูุชูุงู ูุงูุฌุจุงู ูุงููุฏูุงู ูุงูุจุญูุฑุงุช ุ ููุง ุฅูู ุฐูู. </font><font style="vertical-align: inherit;">ุชูุฌุฏ ุงุฎุชูุงูุงุช ูุจูุฑุฉ ูู ุงูุงุฑุชูุงุน ุจุณุจุจ ุชูุงุนู ุงูุตูุงุฆุญ ุงูุชูุชูููุฉ ุงูุชู ุชุชุญุฑู ุจุจุทุก. </font><font style="vertical-align: inherit;">ุนูู ุงูุฑุบู ูู ุฃููุง ูู ูุญุงูููุง ุ ูุฌุจ ุฃู ุชุดุจู ููุงุทู ุฃุฑุถูุง ูุฐู ุงูููุญุงุช ุจุทุฑููุฉ ุฃู ุจุฃุฎุฑู. </font><font style="vertical-align: inherit;">ูุง ุชุชุญุฑู ุงูููุงูุน ุ ูููู ูุฏ ุชุชูุงุทุน. </font><font style="vertical-align: inherit;">ููููููุง ุงูุงุณุชูุงุฏุฉ ูู ูุฐุง.</font></font><br><br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงุฏูุน ุงูุฃุฑุถ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชูุซู ูู ูุทุนุฉ ุฃุฑุถ ุฌุฒุกูุง ูู ุงูุฃุฑุถ ูุฏููุนุฉ ูู ูุงุน ุงููุญูุท. </font><font style="vertical-align: inherit;">ูุฐูู ุ ุฏุนููุง ุจุงุณุชูุฑุงุฑ ุฒูุงุฏุฉ ุงุฑุชูุงุน ุงูุฎููุฉ ุงูุญุงููุฉ </font></font><code>RaiseTerrain</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุฑู ูุง ุณูุญุฏุซ.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> HexCell current = searchFrontier.Dequeue(); current.Elevation += <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (current.TerrainTypeIndex == <span class="hljs-number"><span class="hljs-number">0</span></span>) { โฆ }</code> </pre> <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/b3c/f6e/d3e/b3cf6ed3e71eb737ea7246c92bdd5624.jpg"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃุฑุถ ุจุงุฑุชูุงุนุงุช. </font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุตููุง ุฅูู ุงููุฑุชูุนุงุช ุ ููู ูู ุงูุตุนุจ ุฑุคูุชูุง. </font><font style="vertical-align: inherit;">ููููู ุฌุนููุง ุฃูุซุฑ ูุถูุญูุง ุฅุฐุง ููุช ุชุณุชุฎุฏู ููุน ุงูุชุถุงุฑูุณ ุงูุฎุงุต ุจู ููู ูุณุชูู ูู ุงูุงุฑุชูุงุน ุ ูุซู ุงูุทุจูุงุช ุงูุฌุบุฑุงููุฉ. </font><font style="vertical-align: inherit;">ุณููุนู ุฐูู ููุท ุจุญูุซ ุชููู ุงูุงุฑุชูุงุนุงุช ุฃูุซุฑ ูุถูุญูุง ุ ุจุญูุซ ููููู ุจุจุณุงุทุฉ ุงุณุชุฎุฏุงู ูุณุชูู ุงูุงุฑุชูุงุน ููุคุดุฑ ููุงุฑุชูุงุน.</font></font><br><br><div class="spoiler" style=";text-align:right;direction:rtl"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุงุฐุง ูุญุฏุซ ุฅุฐุง ุชุฌุงูุฒ ุงูุงุฑุชูุงุน ุนุฏุฏ ุฃููุงุน ุงูุชุถุงุฑูุณุ</font></font></b> <div class="spoiler_text" style=";text-align:right;direction:rtl">        .        ,     . </div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุฏูุงู ูู ุชุญุฏูุซ ููุน ุชุถุงุฑูุณ ุงูุฎููุฉ ูุน ูู ุชุบููุฑ ูู ุงูุงุฑุชูุงุน ุ ุฏุนูุง ููุดุฆ ุทุฑููุฉ ูููุตูุฉ </font></font><code>SetTerrainType</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุชุนููู ุฌููุน ุฃููุงุน ุงูุชุถุงุฑูุณ ูุฑุฉ ูุงุญุฏุฉ ููุท.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SetTerrainType</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; cellCount; i++) { HexCell cell = grid.GetCell(i); cell.TerrainTypeIndex = cell.Elevation; } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุณูู ูุทูู ุนูู ูุฐู ุงูุทุฑููุฉ ุจุนุฏ ุฅูุดุงุก ุงูุณูุดู. </font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GenerateMap</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> x, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> z</span></span></span><span class="hljs-function">)</span></span> { โฆ CreateLand(); SetTerrainType(); โฆ }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุขู </font></font><code>RaiseTerrain</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุง ูุณุชุทูุน ุงูุชุนุงูู ูุน ููุน ุงูุฑุงุญุฉ ุ ูุงูุชุฑููุฒ ุนูู ุงููุฑุชูุนุงุช. </font><font style="vertical-align: inherit;">ููููุงู ุจุฐูู ุ ุชุญุชุงุฌ ุฅูู ุชุบููุฑ ููุทูู. </font><font style="vertical-align: inherit;">ุฅุฐุง ูุงู ุงูุงุฑุชูุงุน ุงูุฌุฏูุฏ ููุฎููุฉ ุงูุญุงููุฉ ูู 1 ุ ููุฏ ุฃุตุจุญ ุฃูุซุฑ ุฌูุงููุง ุ ูุฐุง ููุฏ ุงูุฎูุถ ูุฌููุน ุงูุฎูุงูุง ุ ููุง ูุฏ ูุคุฏู ุฅูู ุงุณุชููุงู ููู ุงููููุน.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> HexCell current = searchFrontier.Dequeue(); current.Elevation += <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (current.Elevation == <span class="hljs-number"><span class="hljs-number">1</span></span> &amp;&amp; --budget == <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } <span class="hljs-comment"><span class="hljs-comment">// if (current.TerrainTypeIndex == 0) { // current.TerrainTypeIndex = 1; // if (--budget == 0) { // break; // } // }</span></span></code> </pre> <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/ee0/eec/b9e/ee0eecb9e59f527bd27f0275e230de0a.jpg"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุชูุณูู ุงูุทุจูู ููุทุจูุงุช.</font></font></i> <br><br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุฃุถู ุงููุงุก </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฏุนูุง ููุถุญ ุจุดูู ุตุฑูุญ ุฃู ุงูุฎูุงูุง ูู ุงููุงุก ุฃู ุงูุฃุฑุถ ุ ูุชุนููู ูุณุชูู ุงูููุงู ูุฌููุน ุงูุฎูุงูุง ุฅูู 1. ูู ุจุฐูู </font></font><code>GenerateMap</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุจู ุฅูุดุงุก ุงูุฃุฑุถ.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GenerateMap</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> x, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> z</span></span></span><span class="hljs-function">)</span></span> { cellCount = x * z; grid.CreateMap(x, z); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (searchFrontier == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { searchFrontier = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HexCellPriorityQueue(); } <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; cellCount; i++) { grid.GetCell(i).WaterLevel = <span class="hljs-number"><span class="hljs-number">1</span></span>; } CreateLand(); โฆ }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุขู ูุชุนููู ุทุจูุงุช ุงูุฃุฑุถ ูููููุง ุงุณุชุฎุฏุงู ุฌููุน ุฃููุงุน ุงูุชุถุงุฑูุณ. </font><font style="vertical-align: inherit;">ุณุชุจูู ุฌููุน ุฎูุงูุง ุงูุบูุงุตุฉ ุฑูููุฉ ุ ููุฐูู ุงูุฎูุงูุง ุงูุฃุฑุถูุฉ ุงูุฃูู. </font><font style="vertical-align: inherit;">ูููู ุงูููุงู ุจุฐูู ุนู ุทุฑูู ุทุฑุญ ูุณุชูู ุงููุงุก ูู ุงูุงุฑุชูุงุน ูุงุณุชุฎุฏุงู ุงููููุฉ ููุคุดุฑ ูููุน ุงูุฅุบุงุซุฉ.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SetTerrainType</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; cellCount; i++) { HexCell cell = grid.GetCell(i); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!cell.IsUnderwater) { cell.TerrainTypeIndex = cell.Elevation - cell.WaterLevel; } } }</code> </pre> <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/1b5/449/bc3/1b5449bc37b1c677d908484c7bcd0286.jpg"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุฃุฑุถ ูุงูููุงู.</font></font></i> <br><br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงุฑูุน ูุณุชูู ุงููุงุก </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุญู ูุง ููุชุตุฑ ุนูู ูุณุชูู ููุงู ูุงุญุฏ. </font><font style="vertical-align: inherit;">ุฏุนูุง ูุฌุนูู ูุงุจูุงู ููุชุฎุตูุต ุจุงุณุชุฎุฏุงู ุญูู ูุดุชุฑู ุจูุงุตู ุฒููู 1-5 ููููุฉ ุงูุชุฑุงุถูุฉ 3. </font><font style="vertical-align: inherit;">ุงุณุชุฎุฏู ูุฐุง ุงููุณุชูู ุนูุฏ ุชููุฆุฉ ุงูุฎูุงูุง.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> [<span class="hljs-meta"><span class="hljs-meta">Range(1, 5)</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> waterLevel = <span class="hljs-number"><span class="hljs-number">3</span></span>; โฆ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GenerateMap</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> x, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> z</span></span></span><span class="hljs-function">)</span></span> { โฆ <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; cellCount; i++) { grid.GetCell(i).WaterLevel = waterLevel; } โฆ }</code> </pre> <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/c32/9cf/82f/c329cf82f9a847ac01f2754cc3252500.png"></div><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/850/c9d/fe4/850c9dfe4694834486bf4be64ac1783a.jpg"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุณุชูู ุงูููุงู 3.</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุนูุฏูุง ูููู ูุณุชูู ุงูููุงู 3 ุ ูุญุตู ุนูู ุฃุฑุถ ุฃูู ููุง ุชููุนูุง. </font><font style="vertical-align: inherit;">ูุฐุง ูุฃูู </font></font><code>RaiseTerrain</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุง ูุฒุงู ูุนุชูุฏ ุฃู ูุณุชูู ุงูููุงู ูู 1. ูููุตูุญ ุฐูู.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> HexCell current = searchFrontier.Dequeue(); current.Elevation += <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (current.Elevation == waterLevel &amp;&amp; --budget == <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุคุฏู ุงุณุชุฎุฏุงู ูุณุชููุงุช ุฃุนูู ูู ุงูููุงู ุฅูู ุฐูู. </font><font style="vertical-align: inherit;">ุฃู ุงูุฎูุงูุง ูุง ุชุตุจุญ ุฃุฑุถูุง ุนูู ุงูููุฑ. </font><font style="vertical-align: inherit;">ุนูุฏูุง ูููู ูุณุชูู ุงููุงุก 2 ุ ุณูุธู ุงููุณู ุงูุฃูู ุชุญุช ุงููุงุก. </font><font style="vertical-align: inherit;">ููุฏ ุงุฑุชูุน ูุงุน ุงููุญูุท ุ ููููู ูุง ูุฒุงู ุชุญุช ุงููุงุก. </font><font style="vertical-align: inherit;">ุชุชููู ุงูุฃุฑุถ ููุท ุนูุฏ ุชูุงุทุน ูุณููู ุนูู ุงูุฃูู. </font><font style="vertical-align: inherit;">ูููุง ุงุฑุชูุน ูุณุชูู ุงูููุงู ุ ูุฌุจ ุฃู ุชุนุจุฑ ุงููุฒูุฏ ูู ุงูููุงูุน ูุฅูุดุงุก ุงูุฃุฑุถ. </font><font style="vertical-align: inherit;">ูุฐูู ุ ูุน ุงุฑุชูุงุน ูุณุชููุงุช ุงูููุงู ุ ุชุตุจุญ ุงูุฃุฑุถ ุฃูุซุฑ ููุถููุฉ. </font><font style="vertical-align: inherit;">ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ุนูุฏูุง ุชููู ููุงู ุญุงุฌุฉ ุฅูู ุงููุฒูุฏ ูู ุงูุฃุฑุงุถู ุ ููู ุงููุฑุฌุญ ุฃู ุชุชูุงุทุน ุนูู ุงูุฃุฑุถ ุงูููุฌูุฏุฉ ุจุงููุนู ุ ููุฐุง ูู ุงูุณุจุจ ูู ุฃู ุงูุฌุจุงู ุณุชููู ุฃูุซุฑ ุดููุนูุง ูุฃุฑุถ ูุณุทุญุฉ ุฃูู ูู ูุซูุฑ ูู ุงูุฃุญูุงู ุ ููุง ูู ุงูุญุงู ูู ุงุณุชุฎุฏุงู ูุทุน ุงูุฃุฑุถ ุงูุตุบูุฑุฉ.</font></font><br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/c39/f02/abf/c39f02abf2bfa93f01395208da92ae9a.jpg"></div><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/5a9/01f/4e2/5a901f4e2785456e0784f33508be4ede.jpg"></div><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/863/816/cc1/863816cc19c0fd7cbf172905962970d9.jpg"></div><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/fd0/412/190/fd041219043df072443b00d6799f3946.jpg"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุณุชููุงุช ุงูููุงู 2-5 ุ ุงูุณูุดู ุฏุงุฆูุง 50ูช. </font></font></i> <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุญุฒูุฉ ุงููุญุฏุฉ</font></font></a> <br><br><h2 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุญุฑูุฉ ุฑุฃุณูุฉ </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุญุชู ุงูุขู ุ ูููุง ุจุฑูุน ุงููุคุงูุฑุงุช ุฅูู ูุณุชูู ูุงุญุฏ ูู ูู ูุฑุฉ ุ ูููู ููุณ ุนูููุง ุฃู ููุตุฑ ุฃููุณูุง ุนูู ุฐูู. </font></font><br><br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ููุงูุน ุนุงููุฉ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุนูู ุงูุฑุบู ูู ุฃู ูู ูุณู ูุฒูุฏ ูู ุงุฑุชูุงุน ุฎูุงูุงู ุจููุฏุงุฑ ูุณุชูู ูุงุญุฏ ุ ููุฏ ุชุญุฏุซ ูุตุงุตุงุช. </font><font style="vertical-align: inherit;">ูุญุฏุซ ูุฐุง ุนูุฏูุง ุชููุณ ุญูุงู ูุณููู. </font><font style="vertical-align: inherit;">ูููู ุฃู ูุคุฏู ุฐูู ุฅูู ุฅูุดุงุก ุฌุฑู ุตุฎุฑู ูุนุฒูู ุ ููู ุฎุทูุท ุงูุฌุฑู ุงูุทูููุฉ ุณุชููู ูุงุฏุฑุฉ. </font><font style="vertical-align: inherit;">ูููููุง ุฒูุงุฏุฉ ุชูุฑุงุฑ ุธููุฑูุง ุนู ุทุฑูู ุฒูุงุฏุฉ ุงุฑุชูุงุน ุงููุคุงูุฑุฉ ุจุฃูุซุฑ ูู ุฎุทูุฉ. </font><font style="vertical-align: inherit;">ูููู ูุฌุจ ุงูููุงู ุจุฐูู ููุท ููุณุจุฉ ูุนููุฉ ูู ุงูููุงูุน. </font><font style="vertical-align: inherit;">ุฅุฐุง ูุงูุช ุฌููุน ุงูููุงุทู ุชุฑุชูุน ุ ูุณูููู ูู ุงูุตุนุจ ุฌุฏูุง ุงูุชุญุฑู ุนูู ุทูู ุงูุชุถุงุฑูุณ. </font><font style="vertical-align: inherit;">ูุฐูู ุฏุนููุง ูุฌุนู ูุฐู ุงููุนููุฉ ูุงุจูุฉ ููุชุฎุตูุต ุจุงุณุชุฎุฏุงู ุญูู ุงุญุชูุงูู ุจูููุฉ ุงูุชุฑุงุถูุฉ 0.25.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> [<span class="hljs-meta"><span class="hljs-meta">Range(0f, 1f)</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> highRiseProbability = <span class="hljs-number"><span class="hljs-number">0.25f</span></span>;</code> </pre> <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/cb6/485/8d7/cb64858d7531bb31842aebdd49b68304.png"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงุญุชูุงููุฉ ุงุฑุชูุงุน ููู ูู ุงูุฎูุงูุง. </font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุนูู ุงูุฑุบู ูู ุฃูู ูููููุง ุงุณุชุฎุฏุงู ุฃู ุฒูุงุฏุฉ ูู ุงูุงุฑุชูุงุน ููููุงุทู ุงููุฑุชูุนุฉ ุ ุฅูุง ุฃู ุฐูู ูุฎุฑุฌ ุนู ุงูุณูุทุฑุฉ ุจุณุฑุนุฉ. </font><font style="vertical-align: inherit;">ูุฑู ุงูุงุฑุชูุงุน 2 ูุฎูู ุจุงููุนู ุงูููุญุฏุฑุงุช ุ ูุฐูู ูุฐุง ูููู. </font><font style="vertical-align: inherit;">ูุธุฑูุง ูุฃูู ููููู ุชุฎุทู ุงุฑุชูุงุน ูุณุงูู ููุณุชูู ุงููุงุก ุ ูุญุชุงุฌ ุฅูู ุชุบููุฑ ุงูุทุฑููุฉ ุงูุชู ูุญุฏุฏ ุจูุง ูุง ุฅุฐุง ูุงูุช ุงูุฎููุฉ ูุฏ ุฃุตุจุญุช ุฃุฑุถูุง. </font><font style="vertical-align: inherit;">ุฅุฐุง ูุงู ุชุญุช ูุณุชูู ุงููุงุก ุ ูุงูุขู ูู ุนูู ููุณ ุงููุณุชูู ุฃู ุฃุนูู ุ ููุฏ ุฃูุดุฃูุง ุฎููุฉ ุฃุฑุถูุฉ ุฌุฏูุฏุฉ.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> rise = Random.<span class="hljs-keyword"><span class="hljs-keyword">value</span></span> &lt; highRiseProbability ? <span class="hljs-number"><span class="hljs-number">2</span></span> : <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> size = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (size &lt; chunkSize &amp;&amp; searchFrontier.Count &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { HexCell current = searchFrontier.Dequeue(); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> originalElevation = current.Elevation; current.Elevation = originalElevation + rise; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( originalElevation &lt; waterLevel &amp;&amp; current.Elevation &gt;= waterLevel &amp;&amp; --budget == <span class="hljs-number"><span class="hljs-number">0</span></span> ) { <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } size += <span class="hljs-number"><span class="hljs-number">1</span></span>; โฆ }</code> </pre> <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/b31/8c1/ea5/b318c1ea557ced17d2cb0d9a951bcfc3.jpg"></div><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/4ba/353/78b/4ba35378bc60e74b624e136b90a4a7eb.jpg"></div><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/ea3/8ac/b0a/ea38acb0a5cf12835c2ba177e41d6178.jpg"></div><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/018/0df/bd9/0180dfbd9869a0d0e0d5a1712af34fb3.jpg"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงุญุชูุงูุงุช ุฒูุงุฏุฉ ูููุฉ ูู ุงูุงุฑุชูุงุน ูู 0.25 ู 0.50 ู 0.75 ู 1.</font></font></i> <br><br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงุฎูุถ ุงูุฃุฑุถ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุฃุฑุถ ูุง ุชุฑุชูุน ุฏุงุฆููุง ุ ูุฃุญูุงููุง ุชุณูุท. </font><font style="vertical-align: inherit;">ุนูุฏูุง ุชูุฎูุถ ุงูุฃุฑุถ ุจุฏุฑุฌุฉ ูุงููุฉ ุ ูููุฃูุง ุงููุงุก ูุชุถูุน. </font><font style="vertical-align: inherit;">ุญุชู ุงูุขู ูุญู ูุง ููุนู ุฐูู. </font><font style="vertical-align: inherit;">ูุธุฑูุง ูุฃููุง ูุฏูุน ุงูููุงุทู ููุท ููุฃุนูู ุ ุชุจุฏู ุงูุฃุฑุถ ุนุงุฏุฉู ููุฌููุนุฉ ูู ุงูููุงุทู ุงููุณุชุฏูุฑุฉ ุฅูู ุญุฏ ูุง ููุฒูุฌุฉ ูุนูุง. </font><font style="vertical-align: inherit;">ุฅุฐุง ูููุง ูู ุจุนุถ ุงูุฃุญูุงู ุจุชุฎููุถ ุงูููุทูุฉ ูุฃุณูู ุ ูุญุตู ุนูู ุฃุดูุงู ุฃูุซุฑ ุชููุนูุง.</font></font><br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/9e4/95e/d81/9e495ed818dfffc39e5a238f273c8c5b.jpg"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฎุฑูุทุฉ ูุจูุฑุฉ ุจุฏูู ุณูุดู ุบุงุฑูุฉ. </font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูููููุง ุงูุชุญูู ูู ุชูุฑุงุฑ ูุจูุท ุงูุฃุฑุถ ุจุงุณุชุฎุฏุงู ูุฌุงู ุงุญุชูุงู ุขุฎุฑ. </font><font style="vertical-align: inherit;">ุจูุง ุฃู ุงูุชุฎููุถ ูููู ุฃู ูุฏูุฑ ุงูุฃุฑุถ ุ ูุฌุจ ุฃู ูููู ุงุญุชูุงู ุงูุงูุฎูุงุถ ุฏุงุฆููุง ุฃูู ูู ุงุญุชูุงู ุงูุฑูุน. </font><font style="vertical-align: inherit;">ุฎูุงู ุฐูู ุ ูุฏ ูุณุชุบุฑู ุงูุฃูุฑ ููุชุง ุทูููุง ุฌุฏุง ููุญุตูู ุนูู ุงููุณุจุฉ ุงูุตุญูุญุฉ ูู ุงูุฃุฑุถ. </font><font style="vertical-align: inherit;">ูุฐูู ุ ุฏุนูุง ูุณุชุฎุฏู ุงุญุชูุงู ุชุฎููุถ ุฃูุตู ูุจูุบ 0.4 ูุน ูููุฉ ุงูุชุฑุงุถูุฉ 0.2.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> [<span class="hljs-meta"><span class="hljs-meta">Range(0f, 0.4f)</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> sinkProbability = <span class="hljs-number"><span class="hljs-number">0.2f</span></span>;</code> </pre> <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/a11/997/e82/a11997e824700a045e9faaedaafeb121.png"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงุญุชูุงููุฉ ุงูุชุฎููุถ. </font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุดุจู ุฎูุถ ุงููููุน ุฑูุน ุ ูุน ุจุนุถ ุงูุงุฎุชูุงูุงุช. </font><font style="vertical-align: inherit;">ูุฐูู ุ ูููู ุจุชูุฑุงุฑ ุงูุฃุณููุจ </font></font><code>RaiseTerrain</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุชุบููุฑ ุงุณูู ุฅูู </font></font><code>SinkTerrain</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ุจุฏูุงู ูู ุชุญุฏูุฏ ุญุฌู ุงูุงุฑุชูุงุน ุ ูุญุชุงุฌ ุฅูู ูููุฉ ุฃูู ูููู ุฃู ุชุณุชุฎุฏู ููุณ ุงูููุทู. </font><font style="vertical-align: inherit;">ูู ุงูููุช ููุณู ุ ูุฌุจ ุฅุฌุฑุงุก ููุงุฑูุงุช ููุชุญูู ููุง ุฅุฐุง ููุง ูุฏ ูุฑุฑูุง ุนุจุฑ ุณุทุญ ุงููุงุก. </font><font style="vertical-align: inherit;">ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ุนูุฏ ุฎูุถ ุงูุฅุบุงุซุฉ ุ ูุญู ูุง ููุชุตุฑ ุนูู ูุฌููุน ุงูุฎูุงูุง. </font><font style="vertical-align: inherit;">ุจุฏูุงู ูู ุฐูู ุ ุชููู ูู ุฎููุฉ ุณูุดู ููููุฏุฉ ุจุฅุฑุฌุงุน ุงููุจูุบ ุงูุฐู ุชู ุฅููุงูู ุนูููุง ุ ูุฐูู ูุฒูุฏูุง ููุณุชูุฑ ูู ุงูุนูู.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SinkTerrain</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> chunkSize, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> budget</span></span></span><span class="hljs-function">)</span></span> { โฆ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> sink = Random.<span class="hljs-keyword"><span class="hljs-keyword">value</span></span> &lt; highRiseProbability ? <span class="hljs-number"><span class="hljs-number">2</span></span> : <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> size = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (size &lt; chunkSize &amp;&amp; searchFrontier.Count &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { HexCell current = searchFrontier.Dequeue(); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> originalElevation = current.Elevation; current.Elevation = originalElevation - sink; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( originalElevation &gt;= waterLevel &amp;&amp; current.Elevation &lt; waterLevel <span class="hljs-comment"><span class="hljs-comment">// &amp;&amp; --budget == 0 ) { // break; budget += 1; } size += 1; โฆ } searchFrontier.Clear(); return budget; }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุขู ุ ูู ูู ุชูุฑุงุฑ ููุฏุงุฎู ุ </font></font><code>CreateLand</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฌุจ ุฅูุง ุฃู ูุฎูุถ ุงูุฃุฑุถ ุฃู ูุฑูุนูุง ุ ุงุนุชูุงุฏูุง ุนูู ุงุญุชูุงู ุงูุงูุฎูุงุถ.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CreateLand</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> landBudget = Mathf.RoundToInt(cellCount * landPercentage * <span class="hljs-number"><span class="hljs-number">0.01f</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (landBudget &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> chunkSize = Random.Range(chunkSizeMin, chunkSizeMax - <span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Random.<span class="hljs-keyword"><span class="hljs-keyword">value</span></span> &lt; sinkProbability) { landBudget = SinkTerrain(chunkSize, landBudget); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { landBudget = RaiseTerrain(chunkSize, landBudget); } } }</code> </pre> <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/d6b/c5e/762/d6bc5e76274e4aa9c8a692f90fde3646.jpg"></div><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/c2f/8ae/3e3/c2f8ae3e3a4b814b6ae954d40225149e.jpg"></div><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/1e3/f5d/461/1e3f5d461421feddbb145d4e1d56c000.jpg"></div><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/33b/39d/462/33b39d462682688fc2a8094556e4fc91.jpg"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงุญุชูุงู ุงูุณููุท 0.1 ู 0.2 ู 0.3 ู 0.4.</font></font></i> <br><br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงุฑุชูุงุน ุงูุญุฏ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ุงููุฑุญูุฉ ุงูุญุงููุฉ ุ ูููู ุฃู ูุชุฏุงุฎู ูุน ุงูุนุฏูุฏ ูู ุงูุฃูุณุงู ุ ูุฃุญูุงููุง ุจุงุฑุชูุงุนุงุช ุนุฏูุฏุฉ ูู ุงูุงุฑุชูุงุน ุ ูุจุนุถูุง ูููู ุฃู ููุฎูุถ โโุซู ูุฑุชูุน ูุฑุฉ ุฃุฎุฑู. </font><font style="vertical-align: inherit;">ูู ุงูููุช ููุณู ุ ูููููุง ุฅูุดุงุก ุงุฑุชูุงุนุงุช ุนุงููุฉ ุฌุฏูุง ูุฃุญูุงููุง ููุฎูุถุฉ ุฌุฏูุง ุ ุฎุงุตุฉ ุนูุฏูุง ุชููู ููุงู ุญุงุฌุฉ ุฅูู ูุณุจุฉ ุนุงููุฉ ูู ุงูุฃุฑุงุถู.</font></font><br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/f3f/c2e/359/f3fc2e359db04b4411f2bcd06b81888b.jpg"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฑุชูุนุงุช ุถุฎูุฉ ุจูุณุจุฉ 90ูช ูู ุงูุฃุฑุถ. </font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุญุฏ ูู ุงูุงุฑุชูุงุน ุ ุฏุนูุง ูุถูู ุงูุญุฏ ุงูุฃุฏูู ูุงูุญุฏ ุงูุฃูุตู ุงููุฎุตุต. </font><font style="vertical-align: inherit;">ุณูููู ุงูุญุฏ ุงูุฃุฏูู ุงููุนููู ูู ููุงู ูุง ุจูู โ4 ู 0 ุ ููุฏ ูููู ุงูุญุฏ ุงูุฃูุตู ุงูููุจูู ูู ูุทุงู 6-10. </font><font style="vertical-align: inherit;">ุงุฌุนู ุงูููู ุงูุงูุชุฑุงุถูุฉ ูู โ2 ู 8. ุนูุฏ ุชุนุฏูู ุงูุฎุฑูุทุฉ ูุฏูููุง ุ ุณุชููู ุฎุงุฑุฌ ุงูุญุฏ ุงูููุจูู ุ ุญุชู ุชุชููู ูู ุชุบููุฑ ุดุฑูุท ุชูุฑูุฑ ูุงุฌูุฉ ูุณุชุฎุฏู ุงููุญุฑุฑ ุ ุฃู ุชุฑูู ููุง ูู.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> [<span class="hljs-meta"><span class="hljs-meta">Range(-4, 0)</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> elevationMinimum = <span class="hljs-number"><span class="hljs-number">-2</span></span>; [Range(<span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>)] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> elevationMaximum = <span class="hljs-number"><span class="hljs-number">8</span></span>;</code> </pre> <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/bcb/20b/efc/bcb20befc496cd2c5bffbc94b0a9d267.png"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุงุฑุชูุงุนุงุช ุงูุฏููุง ูุงููุตูู. </font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุขู </font></font><code>RaiseTerrain</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฌุจ ุฃู ูุชุฃูุฏ ูู ุฃู ุงูุงุฑุชูุงุน ูุง ูุชุฌุงูุฒ ุงูุญุฏ ุงูุฃูุตู ุงููุณููุญ ุจู. </font><font style="vertical-align: inherit;">ูููู ุงูููุงู ุจุฐูู ุนู ุทุฑูู ุงูุชุญูู ููุง ุฅุฐุง ูุงูุช ุงูุฎูุงูุง ุงูุญุงููุฉ ูุฑุชูุนุฉ ููุบุงูุฉ. </font><font style="vertical-align: inherit;">ุฅุฐุง ูุงู ุงูุฃูุฑ ูุฐูู ุ ูุฅููุง ูุชุฎุทุงูู ุฏูู ุชุบููุฑ ุงูุงุฑุชูุงุน ูุฅุถุงูุฉ ุฌูุฑุงููู. </font><font style="vertical-align: inherit;">ุณูุคุฏู ูุฐุง ุฅูู ุญูููุฉ ุฃู ููุงุทู ุงูุฃุฑุถ ุณุชุชุฌูุจ ุงูููุงุทู ุงูุชู ูุตูุช ุฅูู ุฃูุตู ุงุฑุชูุงุน ุ ูุชููู ุญูููุง.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> HexCell current = searchFrontier.Dequeue(); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> originalElevation = current.Elevation; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> newElevation = originalElevation + rise; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (newElevation &gt; elevationMaximum) { <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; } current.Elevation = newElevation; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( originalElevation &lt; waterLevel &amp;&amp; newElevation &gt;= waterLevel &amp;&amp; --budget == <span class="hljs-number"><span class="hljs-number">0</span></span> ) { <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } size += <span class="hljs-number"><span class="hljs-number">1</span></span>;</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุนู ุงูุดูุก ููุณู </font></font><code>SinkTerrain</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูููู ุจุญุฏ ุฃุฏูู ููุงุฑุชูุงุน.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> HexCell current = searchFrontier.Dequeue(); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> originalElevation = current.Elevation; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> newElevation = current.Elevation - sink; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (newElevation &lt; elevationMinimum) { <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; } current.Elevation = newElevation; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( originalElevation &gt;= waterLevel &amp;&amp; newElevation &lt; waterLevel ) { budget += <span class="hljs-number"><span class="hljs-number">1</span></span>; } size += <span class="hljs-number"><span class="hljs-number">1</span></span>;</code> </pre> <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/4af/cbe/339/4afcbe339d0d697779ff0649f6c2c125.jpg"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงุฑุชูุงุน ูุญุฏูุฏ ูุน 90ูช ุฃุฑุถ.</font></font></i> <br><br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงูุญูุงุธ ุนูู ุงูุงุฑุชูุงุน ุงูุณูุจู </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ูุฐู ุงููุฑุญูุฉ ุ ูุง ูููู ูุฑูุฒ ุงูุญูุธ ูุงูุชุญููู ุงูุชุนุงูู ูุน ุงูุงุฑุชูุงุนุงุช ุงูุณุงูุจุฉ ูุฃููุง ูุฎุฒู ุงูุงุฑุชูุงุน ูุจุงูุช. </font><font style="vertical-align: inherit;">ูุชู ุชุญููู ุฑูู ุณุงูุจ ุนูุฏ ุญูุธู ุฅูู ููุฌุจ ูุจูุฑ. </font><font style="vertical-align: inherit;">ูุฐูู ุ ุนูุฏ ุญูุธ ูุชุญููู ุงูุฎุฑูุทุฉ ุงูุชู ุชู ุฅูุดุงุคูุง ุ ูุฏ ุชุธูุฑ ุฎุฑุงุฆุท ุนุงููุฉ ุฌุฏูุง ุจุฏูุงู ูู ุงูุฎูุงูุง ุงูุฃุตููุฉ ุชุญุช ุงููุงุก. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูููููุง ุฅุถุงูุฉ ุฏุนู ููุงุฑุชูุงุนุงุช ุงูุณูุจูุฉ ุนู ุทุฑูู ุชุฎุฒููู ูุนุฏุฏ ุตุญูุญ ูููุณ ุจุงูุช. </font><font style="vertical-align: inherit;">ููุน ุฐูู ุ ูุง ุฒููุง ูุง ูุญุชุงุฌ ุฅูู ุฏุนู ูุณุชููุงุช ูุชุนุฏุฏุฉ ูู ุงูุงุฑุชูุงุน. </font><font style="vertical-align: inherit;">ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ูููููุง ุชุนููุถ ุงููููุฉ ุงููุฎุฒูุฉ ุนู ุทุฑูู ุฅุถุงูุฉ 127. ููุฐุง ุณูุณูุญ ููุง ุจุชุฎุฒูู ุงูุงุฑุชูุงุนุงุช ุจุดูู ุตุญูุญ ูู ุงููุทุงู โ127-128 ูู ุจุงูุช ูุงุญุฏ. </font></font><code>HexCell.Save</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุญุณุจ </font><font style="vertical-align: inherit;">ุงูุชุบููุฑ </font><font style="vertical-align: inherit;">.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Save</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">BinaryWriter writer</span></span></span><span class="hljs-function">)</span></span> { writer.Write((<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>)terrainTypeIndex); writer.Write((<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>)(elevation + <span class="hljs-number"><span class="hljs-number">127</span></span>)); โฆ }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุธุฑูุง ูุฃููุง ูููุง ุจุชุบููุฑ ุทุฑููุฉ ุญูุธ ุจูุงูุงุช ุงูุฎุฑุงุฆุท ุ ูุฅููุง ูุฒูุฏูุง </font></font><code>SaveLoadMenu.mapFileVersion</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅูู 4.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> mapFileVersion = <span class="hljs-number"><span class="hljs-number">4</span></span>;</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฃุฎูุฑูุง ุ ูู ุจุชุบููุฑู </font></font><code>HexCell.Load</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุญูุซ ูุทุฑุญ 127 ูู ุงูุงุฑุชูุงุนุงุช ุงููุญููุฉ ูู ูููุงุช ุงูุฅุตุฏุงุฑ 4.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Load</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">BinaryReader reader, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> header</span></span></span><span class="hljs-function">)</span></span> { terrainTypeIndex = reader.ReadByte(); ShaderData.RefreshTerrain(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); elevation = reader.ReadByte(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (header &gt;= <span class="hljs-number"><span class="hljs-number">4</span></span>) { elevation -= <span class="hljs-number"><span class="hljs-number">127</span></span>; } โฆ }</code> </pre> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุญุฒูุฉ ุงููุญุฏุฉ</font></font></a> <br><br><h2 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุฅุนุงุฏุฉ ุฅูุดุงุก ููุณ ุงูุฎุฑูุทุฉ </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูููููุง ุงูุขู ุฅูุดุงุก ูุฌููุนุฉ ูุชููุนุฉ ูู ุงูุฎุฑุงุฆุท. </font><font style="vertical-align: inherit;">ุนูุฏ ุฅูุดุงุก ูู ูุชูุฌุฉ ุฌุฏูุฏุฉ ุณุชููู ุนุดูุงุฆูุฉ. </font><font style="vertical-align: inherit;">ูููููุง ุงูุชุญูู ุจุงุณุชุฎุฏุงู ุฎูุงุฑุงุช ุงูุชูููู ููุท ุฎุตุงุฆุต ุงูุจุทุงูุฉ ุ ูููู ููุณ ุงูุดูู ุงูุฃูุซุฑ ุฏูุฉ. </font><font style="vertical-align: inherit;">ูููู ูู ุจุนุถ ุงูุฃุญูุงู ูุญุชุงุฌ ุฅูู ุฅุนุงุฏุฉ ุฅูุดุงุก ููุณ ุงูุฎุฑูุทุฉ ูุฑุฉ ุฃุฎุฑู. </font><font style="vertical-align: inherit;">ุนูู ุณุจูู ุงููุซุงู ุ ููุดุงุฑูุฉ ุฎุฑูุทุฉ ุฌูููุฉ ูุน ุตุฏูู ุ ุฃู ุงูุจุฏุก ูุฑุฉ ุฃุฎุฑู ุจุนุฏ ุชุญุฑูุฑูุง ูุฏูููุง. </font><font style="vertical-align: inherit;">ููุง ุฃููุง ูููุฏุฉ ูู ุนูููุฉ ุชุทููุฑ ุงููุนุจุฉ ุ ูุฐุง ุฏุนูุง ูุถูู ูุฐู ุงูููุฒุฉ.</font></font><br><br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุจุงุณุชุฎุฏุงู ุงูุจุฐูุฑ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฌุนู ุนูููุฉ ุฅูุดุงุก ุงูุฎุฑูุทุฉ ุบูุฑ ูุชููุนุฉ ุ ูุณุชุฎุฏู </font></font><code>Random.Range</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ู </font></font><code>Random.value</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ููุญุตูู ุนูู ููุณ ุชุณูุณู ุงูุฃุฑูุงู ุงูุฒุงุฆูุฉ ูุงูุนุดูุงุฆูุฉ ูุฑุฉ ุฃุฎุฑู ุ ุชุญุชุงุฌ ุฅูู ุงุณุชุฎุฏุงู ููุณ ุงููููุฉ ุงูุฃูููุฉ. </font><font style="vertical-align: inherit;">ููุฏ ุงุชุฎุฐูุง ุจุงููุนู ููุฌุง ููุงุซูุง ูู ูุจู ุ ูู </font></font><code>HexMetrics.InitializeHashGrid</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ูููู ุฃููุงู ุจุญูุธ ุงูุญุงูุฉ ุงูุญุงููุฉ ููููุฏ ุงูุฃุฑูุงู ุงูุฐู ุชูุช ุชููุฆุชู ุจูููุฉ ุฃุณุงุณูุฉ ูุญุฏุฏุฉ ุ ุซู ูุณุชุนูุฏ ุญุงูุชู ุงูุฃุตููุฉ. </font><font style="vertical-align: inherit;">ูููููุง ุงุณุชุฎุฏุงู ููุณ ุงูููุฌ ู </font></font><code>HexMapGenerator.GenerateMap</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ูููููุง ูุฑุฉ ุฃุฎุฑู ุฃู ูุชุฐูุฑ ุงูุญุงูุฉ ุงููุฏููุฉ ููุณุชุนูุฏูุง ุจุนุฏ ุงูุงูุชูุงุก ุ ุญุชู ูุง ูุชุฏุฎู ูู ุฃู ุดูุก ุขุฎุฑ ูุณุชุฎุฏู </font></font><code>Random</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GenerateMap</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> x, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> z</span></span></span><span class="hljs-function">)</span></span> { Random.State originalRandomState = Random.state; โฆ Random.state = originalRandomState; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุนุฏ ุฐูู ุ ูุญุชุงุฌ ุฅูู ุชูููุฑ ุงูุจุฐูุฑ ุงููุณุชุฎุฏูุฉ ูุฅูุดุงุก ุงูุจุทุงูุฉ ุงูุฃุฎูุฑุฉ. </font><font style="vertical-align: inherit;">ูุชู ุฐูู ุจุงุณุชุฎุฏุงู ุญูู ุนุฏุฏ ุตุญูุญ ูุดุชุฑู.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> seed;</code> </pre> <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/41d/3b5/538/41d3b553898698698636b6bada081aa6.png"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุนุฑุถ ุงูุจุฐูุฑ. </font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุขู ูุญู ุจุญุงุฌุฉ ุฅูู ูููุฉ ุงูุจุฐูุฑ ููุชููุฆุฉ </font></font><code>Random</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ูุฅูุดุงุก ุจุทุงูุงุช ุนุดูุงุฆูุฉ ุ ุชุญุชุงุฌ ุฅูู ุงุณุชุฎุฏุงู ุจุฐุฑุฉ ุนุดูุงุฆูุฉ. </font><font style="vertical-align: inherit;">ุฃุจุณุท ุงูููุฌ ูู ุงุณุชุฎุฏุงู ูููุฉ ุงูุจุฐูุฑ ุงูุชุนุณููุฉ ูุชูููุฏ </font></font><code>Random.Range</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ุญุชู ูุง ุชุคุซุฑ ุนูู ุงูุญุงูุฉ ุงูุนุดูุงุฆูุฉ ุงูุฃูููุฉ ุ ูุญุชุงุฌ ุฅูู ุงูููุงู ุจุฐูู ุจุนุฏ ุญูุธูุง.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GenerateMap</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> x, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> z</span></span></span><span class="hljs-function">)</span></span> { Random.State originalRandomState = Random.state; seed = Random.Range(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>.MaxValue); Random.InitState(seed); โฆ }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุฐ ุงูุงูุชูุงุก ุ ูุณุชุนูุฏ ุญุงูุฉ ุนุดูุงุฆูุฉ ุ ุฅุฐุง ุฃูุดุฃูุง ุนูู ุงูููุฑ ุจุทุงูุฉ ุฃุฎุฑู ุ ููุชูุฌุฉ ูุฐูู ูุญุตู ุนูู ููุณ ูููุฉ ุงูุฃุตู. </font><font style="vertical-align: inherit;">ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ูุง ูุนุฑู ููู ุชู ุชููุฆุฉ ุงูุญุงูุฉ ุงูุนุดูุงุฆูุฉ ุงูุฃูููุฉ. </font><font style="vertical-align: inherit;">ูุฐูู ุ ุนูู ุงูุฑุบู ูู ุฃูู ูููู ุฃู ูููู ุจูุซุงุจุฉ ููุทุฉ ุงูุทูุงู ุนุดูุงุฆูุฉ ุ ูุฅููุง ุจุญุงุฌุฉ ุฅูู ุดูุก ุฃูุซุฑ ุนุดูุงุฆููุง ููู ููุงููุฉ.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุงู ุทุฑู ูุฎุชููุฉ ูุชููุฆุฉ ูููุฏุงุช ุงูุฃุฑูุงู ุงูุนุดูุงุฆูุฉ. </font><font style="vertical-align: inherit;">ูู ูุฐู ุงูุญุงูุฉ ุ ููููู ุจุจุณุงุทุฉ ุงูุฌูุน ุจูู ุงูุนุฏูุฏ ูู ุงูููู ุงูุนุดูุงุฆูุฉ ุงูุชู ุชุฎุชูู ุนูู ูุทุงู ูุงุณุน ุ ุฃู ุฃู ุงุญุชูุงู ุฅุนุงุฏุฉ ุฅูุดุงุก ููุณ ุงูุจุทุงูุฉ ุณูููู ููุฎูุถูุง. </font><font style="vertical-align: inherit;">ุนูู ุณุจูู ุงููุซุงู ุ ูุณุชุฎุฏู ุฃูู 32 ุจุชูุง ูู ููุช ุงููุธุงู ุ ูุนุจุฑุงู ุนููุง ุจุงูุฏูุฑุงุช ุ ุจุงูุฅุถุงูุฉ ุฅูู ููุช ุงูุชุดุบูู ุงูุญุงูู ููุชุทุจูู. </font><font style="vertical-align: inherit;">ูู ุจุฏูุฌ ูุฐู ุงูููู ุจุงุณุชุฎุฏุงู ุนูููุฉ ุฃุญุงุฏู ุงููุนุงูู OR ุญุชู ูุง ุชููู ุงููุชูุฌุฉ ูุจูุฑุฉ ุฌุฏูุง.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> seed = Random.Range(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>.MaxValue); seed ^= (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)System.DateTime.Now.Ticks; seed ^= (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)Time.unscaledTime; Random.InitState(seed);</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฏ ูููู ุงูุฑูู ุงููุงุชุฌ ุณูุจููุง ุ ูุงูุฐู ูุง ูุจุฏู ูุทูููุง ุฌุฏูุง ุจุงููุณุจุฉ ูุจุฐูุฑ ุงููููุฉ ุงูุนุงูุฉ. </font><font style="vertical-align: inherit;">ูููููุง ุฃู ูุฌุนููุง ุฅูุฌุงุจูุฉ ุชูุงููุง ุจุงุณุชุฎุฏุงู ุฅุฎูุงุก ุงูุจุช ูุน ุงูุญุฏ ุงูุฃูุตู ูู ุงููููุฉ ุงูุตุญูุญุฉ ุงูุชู ุณุชุนูุฏ ุชุนููู ุจุช ุงูุฅุดุงุฑุฉ.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> seed ^= (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)Time.unscaledTime; seed &amp;= <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>.MaxValue; Random.InitState(seed);</code> </pre> <br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงูุจุฐูุฑ ุงููุงุจูุฉ ูุฅุนุงุฏุฉ ุงูุงุณุชุฎุฏุงู </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุง ุฒููุง ููุดุฆ ุจุทุงูุงุช ุนุดูุงุฆูุฉ ุ ูููู ูููููุง ุงูุขู ูุนุฑูุฉ ูููุฉ ุงูุจุฐูุฑ ุงูุชู ุชู ุงุณุชุฎุฏุงููุง ููู ูููุง. </font><font style="vertical-align: inherit;">ูุฅุนุงุฏุฉ ุฅูุดุงุก ููุณ ุงูุฎุฑูุทุฉ ูุฑุฉ ุฃุฎุฑู ุ ูุฌุจ ุฃู ูุทูุจ ูู ุงููููุฏ ุงุณุชุฎุฏุงู ููุณ ุงููููุฉ ุงูุฃุณุงุณูุฉ ูุฑุฉ ุฃุฎุฑู ุ ุจุฏูุงู ูู ุฅูุดุงุก ูุงุญุฏุฉ ุฌุฏูุฏุฉ. </font><font style="vertical-align: inherit;">ุณููุนู ุฐูู ุจุฅุถุงูุฉ ููุชุงุญ ุชุจุฏูู ุจุงุณุชุฎุฏุงู ุญูู ููุทูู.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> useFixedSeed;</code> </pre> <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/200/4c6/eed/2004c6eed8c2244bdfe660bf477d2fa3.png"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฎูุงุฑ ุงุณุชุฎุฏุงู ุจุฐุฑุฉ ุซุงุจุชุฉ. </font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅุฐุง ุชู ุงุฎุชูุงุฑ ุจุฐุฑุฉ ุซุงุจุชุฉ ุ ูุฅููุง ุจุจุณุงุทุฉ ูุชุฎุทู ุชูููุฏ ุงูุจุฐุฑุฉ ุงูุฌุฏูุฏุฉ </font></font><code>GenerateMap</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ุฅุฐุง ูู ูุบูุฑ ุญูู ุงูุจุฐูุฑ ูุฏูููุง ุ ูุณุชููู ุงููุชูุฌุฉ ูู ููุณ ุงูุฎุฑูุทุฉ ูุฑุฉ ุฃุฎุฑู.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> Random.State originalRandomState = Random.state; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!useFixedSeed) { seed = Random.Range(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>.MaxValue); seed ^= (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)System.DateTime.Now.Ticks; seed ^= (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)Time.time; seed &amp;= <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>.MaxValue; } Random.InitState(seed);</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูููููุง ุงูุขู ูุณุฎ ุงููููุฉ ุงูุฃูููุฉ ููุฎุฑูุทุฉ ุงูุชู ูุญุจูุง ูุญูุธูุง ูู ููุงู ูุง ุ ูุชูููุฏูุง ูุฑุฉ ุฃุฎุฑู ูู ุงููุณุชูุจู. </font><font style="vertical-align: inherit;">ูุง ุชูุณ ุฃููุง ูู ูุญุตู ุนูู ููุณ ุงูุจุทุงูุฉ ุฅูุง ุฅุฐุง ุงุณุชุฎุฏููุง ููุณ ูุนููุงุช ุงููููุฏ ุจุงูุถุจุท ุ ุฃู ููุณ ุญุฌู ุงูุจุทุงูุฉ ุ ุจุงูุฅุถุงูุฉ ุฅูู ุฌููุน ุฎูุงุฑุงุช ุงูุชูููู ุงูุฃุฎุฑู. </font><font style="vertical-align: inherit;">ุญุชู ุงูุชุบููุฑ ุงูุจุณูุท ูู ูุฐู ุงูุงุญุชูุงูุงุช ูููู ุฃู ูุฎูู ุฎุฑูุทุฉ ูุฎุชููุฉ ุชูุงููุง. </font><font style="vertical-align: inherit;">ูุฐูู ุ ุจุงูุฅุถุงูุฉ ุฅูู ุงูุจุฐูุฑ ุ ูุญุชุงุฌ ุฅูู ุชุฐูุฑ ุฌููุน ุงูุฅุนุฏุงุฏุงุช.</font></font><br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/7ff/cd2/279/7ffcd2279b4dd882db924d8e1fc61d0e.jpg"></div><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/486/6db/156/4866db15628d75936b7e19fa4841f2f5.jpg"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุทุงูุงุช ูุจูุฑุฉ ุจููู ุฃุณุงุณูุฉ 0 ู 929396788 ุ ูุนููุงุช ููุงุณูุฉ. </font></font></i> <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุญุฒูุฉ ุงููุญุฏุฉ</font></font></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar427003/">https://habr.com/ru/post/ar427003/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar426991/index.html">Startup Digest: 10 ุฃุญุฏุงุซ ุชูููููุฌูุง ูุนูููุงุช ูุงุฏูุฉ ูู ููุณูู</a></li>
<li><a href="../ar426993/index.html">ูู ุฃุญุชุงุฌ ุฅูู ุชุนูู ูุบุฉ C ูููู ููููุฉ ุนูู ุฌูุงุฒ ุงูููุจููุชุฑุ</a></li>
<li><a href="../ar426995/index.html">ูุถุฑ ุฅุนุงุฏุฉ ุงูุชุฏููุฑ ูู ูู ุงูููุชุฌุงุช ูุงูููุธููู</a></li>
<li><a href="../ar426997/index.html">ููููุฉ ุฅูุดุงุก ุฃุดูุงู ูุฎุตุตุฉ ุจุงุณุชุฎุฏุงู MaterialShapeDrawable</a></li>
<li><a href="../ar426999/index.html">ุงุชุจุงุน ุงูุงุชุฌุงูุงุช ุ ุฃู ุงูุชุญุฑู ูุญู RxJava ู LiveData</a></li>
<li><a href="../ar427005/index.html">ูุทูุฑู ุงูุฐูุงุก ุงูุงุตุทูุงุนู - ูููุฉ ุงูููููููุฑุงุชุ</a></li>
<li><a href="../ar427009/index.html">"ุงููุดู" ููุฅููุชุฑูู: ุงูุชูุงุนุจ ุจุดุญูุฉ ุฏุงุฎู ุจููุฉ ุงูุฑูุงุจุท ุบูุฑ ุงููุดุจุนุฉ</a></li>
<li><a href="../ar427011/index.html">"ูุฑุญุจุง ุจุงูุนุงูู!" ุนูู FPGA ุฃู ุงูุฅุตุฏุงุฑ ุงูุชุงูู ูู UART</a></li>
<li><a href="../ar427013/index.html">ูุฌููุง ููุฌู NeoQUEST-2018: ุชุฐูุฑ ููู ูุงู ุงูุฃูุฑ</a></li>
<li><a href="../ar427015/index.html">ููุงุฐุง ุชุญุชุงุฌ ูุฑุงูุฒ ุงูุจูุงูุงุช ุงูุฐููุฉ ุงูุชุฌุงุฑูุฉ ุฅูู ูุญุฏุงุช PDU ุฐููุฉุ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>