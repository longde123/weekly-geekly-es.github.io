<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤥 🙋🏽 💥 Rocker - Rocksdb-Treiber für Erlang 😕 😆 👨🏾‍🤝‍👨🏽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Einführung 


 Im Internet gibt es viele Informationen und Debatten über die Wahl des SQL / NOSQL-Ansatzes sowie über die Vor- und Nachteile des einen...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Rocker - Rocksdb-Treiber für Erlang</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/413353/"><h3 id="vvedenie">  Einführung </h3><br><p>  Im Internet gibt es viele Informationen und Debatten über die Wahl des SQL / NOSQL-Ansatzes sowie über die Vor- und Nachteile des einen oder anderen KV-Speichers.  Was Sie gerade lesen, ist kein Rocksdb-Handbuch oder eine Aufregung, um dieses Repository und meinen Treiber dafür zu verwenden.  Ich möchte das Zwischenergebnis der Optimierung des NIF-Entwicklungsprozesses für Erlang mitteilen.  Dieser Artikel stellt einen funktionsfähigen Treiber für rocksbb vor, der an mehreren Abenden entwickelt wurde. </p><a name="habracut"></a><br><p>  In einem der Projekte bestand die Aufgabe darin, eine große Anzahl von Ereignissen zuverlässig zu verarbeiten.  Jedes Ereignis dauert 50 bis 350 Bytes. Pro Knoten und Tag werden mehr als 80 Millionen Ereignisse generiert.  Ich möchte nur darauf hinweisen, dass die Probleme der Fehlertoleranz bei der Nachrichtenübermittlung an Knoten nicht berücksichtigt werden.  Eine der Verarbeitungsbeschränkungen ist auch die atomare und konsistente Änderung der Ereignisgruppe. </p><br><p>  Somit sind die Hauptanforderungen an den Fahrer: </p><br><ol><li>  Zuverlässigkeit </li><li>  Leistung </li><li> Sicherheit (im kanonischen Sinne) </li><li>  Funktionalität: <br><ul><li>  Alle grundlegenden kv-Funktionen </li><li>  Spaltenfamilien </li><li>  Transaktionen </li><li>  Datenkomprimierung </li><li>  Unterstützung für die flexible Speicherkonfiguration </li></ul></li><li>  Minimale Codebasis </li></ol><br><h3 id="obzor-suschestvuyuschih-resheniy">  Übersicht bestehender Lösungen </h3><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">erocksdb</a> ist eine Lösung von Leofs-Entwicklern.  Zu den Vorteilen gehört die Genehmigung in einem realen Projekt.  Durch Nachteile - eine veraltete Codebasis und mangelnde Transaktionsfähigkeit.  Dieser Treiber basiert auf rocksbb 4.13. </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">rockse</a> hat eine Reihe von Einschränkungen, zum Beispiel das Fehlen von Konfigurationsoptionen, aber am wichtigsten ist, dass alle Schlüssel und Werte Zeichenfolgen sein müssen.  Er ging nur als Beispiel für eine Reihe von Treibern in die Überprüfung ein, die die eine oder andere Funktion implementieren und eine andere einschränken. </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">erlang-rocksbb</a> ist ein voll ausgestattetes Projekt, dessen Entwicklung 2014 begann.  Wie erocksdb wird in realen Projekten verwendet.  Es hat eine große Codebasis in C / C ++ und eine breite Funktionalität.  Dieser Treiber ist für die allgemeine Praxis und den Einsatz in den meisten Projekten geeignet. </li></ul><br><p>  Nach einer kurzen Analyse der aktuellen Situation mit erlang-Treibern für rocksbb wurde klar, dass keiner von ihnen die Projektanforderungen vollständig erfüllt.  Obwohl es möglich wäre, erlang-rocksbb zu verwenden, gab es einige freie Abende und nach der erfolgreichen Entwicklung und Implementierung des Bloom-Filters für Rost und Neugier: Ist es möglich, alle Anforderungen des aktuellen Projekts zu implementieren und die meisten Funktionen in NIF in kurzer Zeit zu implementieren? </p><br><h3 id="rocker">  Rocker </h3><br><p>  Rocker ist ein NIF für Erlang und verwendet den Rust-Wrapper für Rocksdb.  Hauptmerkmale sind Sicherheit, Leistung und eine minimale Codebasis.  Schlüssel und Daten werden in binärer Form gespeichert, wodurch das Speicherformat nicht eingeschränkt wird.  Derzeit ist das Projekt für den Einsatz in Lösungen von Drittanbietern geeignet. <br>  Der Quellcode befindet sich im <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Projekt-Repository</a> . </p><br><h3 id="obzor-api">  API-Übersicht </h3><br><h4 id="otkrytie-bazy">  Basisöffnung </h4><br><p>  Das Arbeiten mit der Datenbank ist in zwei Modi möglich: </p><br><ol><li><p>  Der gesamte Schlüsselraum.  In diesem Modus werden alle Ihre Schlüssel in einem Satz platziert.  Mit Rocksdb können Sie Speicheroptionen für aktuelle Aufgaben flexibel konfigurieren.  Abhängig von ihnen kann die Datenbank auf zwei Arten geöffnet werden: </p><br><ul><li><p>  Verwenden eines Standardsatzes von Optionen </p><br><pre><code class="erlang hljs">rocker:open_default(&lt;&lt;<span class="hljs-string"><span class="hljs-string">"/project/priv/db_default_path"</span></span>&gt;&gt;) -&gt; {ok, Db}.</code> </pre> <br><p>  Das Ergebnis dieser Operation ist ein Zeiger für die Arbeit mit der Datenbank, und die Datenbank wird für alle anderen Öffnungsversuche blockiert.  Die Datenbank wird sofort nach dem Löschen dieses Zeigers automatisch entsperrt. </p><br></li><li>  Konfigurieren Sie entweder Optionen für die Aufgabe <br><pre> <code class="erlang hljs">{ok, Db} = rocker:open(&lt;&lt;<span class="hljs-string"><span class="hljs-string">"/project/priv/db_path"</span></span>&gt;&gt;, #{ create_if_missing =&gt; true, set_max_open_files =&gt; <span class="hljs-number"><span class="hljs-number">1000</span></span>, set_use_fsync =&gt; false, set_bytes_per_sync =&gt; <span class="hljs-number"><span class="hljs-number">8388608</span></span>, optimize_for_point_lookup =&gt; <span class="hljs-number"><span class="hljs-number">1024</span></span>, set_table_cache_num_shard_bits =&gt; <span class="hljs-number"><span class="hljs-number">6</span></span>, set_max_write_buffer_number =&gt; <span class="hljs-number"><span class="hljs-number">32</span></span>, set_write_buffer_size =&gt; <span class="hljs-number"><span class="hljs-number">536870912</span></span>, set_target_file_size_base =&gt; <span class="hljs-number"><span class="hljs-number">1073741824</span></span>, set_min_write_buffer_number_to_merge =&gt; <span class="hljs-number"><span class="hljs-number">4</span></span>, set_level_zero_stop_writes_trigger =&gt; <span class="hljs-number"><span class="hljs-number">2000</span></span>, set_level_zero_slowdown_writes_trigger =&gt; <span class="hljs-number"><span class="hljs-number">0</span></span>, set_max_background_compactions =&gt; <span class="hljs-number"><span class="hljs-number">4</span></span>, set_max_background_flushes =&gt; <span class="hljs-number"><span class="hljs-number">4</span></span>, set_disable_auto_compactions =&gt; true, set_compaction_style =&gt; universal }).</code> </pre> </li></ul><br></li><li>  Aufteilung in mehrere Räume.  Schlüssel werden in den sogenannten Spaltenfamilien gespeichert, und jede Spaltenfamilie kann unterschiedliche Optionen haben.  Betrachten wir ein Beispiel für das Öffnen einer Datenbank mit Standardoptionen für alle Spaltenfamilien <br><pre> <code class="erlang hljs">{ok, Db} = <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> rocker:list_cf(BookDbPath) <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> {ok, CfList} -&gt; rocker:open_cf_default(BookDbPath, CfList); _Else -&gt; CfList = [], rocker:open_default(BookDbPath) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>.</code> </pre> </li></ol><br><h4 id="udalenie-bazy">  Basisentfernung </h4><br><p>  Um die Datenbank korrekt zu löschen, müssen Sie <code>rocker:destroy(Path).</code> aufrufen <code>rocker:destroy(Path).</code>  In diesem Fall sollte die Basis nicht verwendet werden. </p><br><h4 id="vosstanovlenie-bazy-posle-sboya">  Datenbankwiederherstellung nach einem Fehler </h4><br><p>  Im Falle eines Systemausfalls kann die Datenbank mithilfe der Methode <code>rocker:repair(Path)</code> wiederhergestellt werden. Dieser Vorgang besteht aus 4 Schritten: </p><br><ol><li>  Dateisuche </li><li>  Stellen Sie Tische wieder her, indem Sie WAL spielen </li><li>  Metadaten extrahieren </li><li>  Deskriptordatensatz </li></ol><br><h4 id="sozdanie-column-family">  Spaltenfamilie erstellen </h4><br><pre> <code class="erlang hljs">Cf = &lt;&lt;<span class="hljs-string"><span class="hljs-string">"testcf1"</span></span>&gt;&gt;, rocker:create_cf_default(Db, Cf) -&gt; ok.</code> </pre> <br><h4 id="udalenie-column-family">  Entfernen der Spaltenfamilie </h4><br><pre> <code class="erlang hljs">Cf = &lt;&lt;<span class="hljs-string"><span class="hljs-string">"testcf1"</span></span>&gt;&gt;, rocker:drop_cf(Db, Cf) -&gt; ok.</code> </pre> <br><h4 id="crud-operacii">  CRUD-Operationen </h4><br><h6 id="zapis-dannyh-po-klyuchu">  Schlüsseldateneingabe </h6><br><pre> <code class="erlang hljs">rocker:put(Db, &lt;&lt;<span class="hljs-string"><span class="hljs-string">"key"</span></span>&gt;&gt;, &lt;&lt;<span class="hljs-string"><span class="hljs-string">"value"</span></span>&gt;&gt;) -&gt; ok.</code> </pre> <br><h6 id="poluchenie-dannyh-po-klyuchu">  Daten per Schlüssel abrufen </h6><br><pre> <code class="erlang hljs">rocker:get(Db, &lt;&lt;<span class="hljs-string"><span class="hljs-string">"key"</span></span>&gt;&gt;) -&gt; {ok, &lt;&lt;<span class="hljs-string"><span class="hljs-string">"value"</span></span>&gt;&gt;} | notfound</code> </pre> <br><h6 id="udalenie-dannyh-po-klyuchu">  Löschen von Schlüsseldaten </h6><br><pre> <code class="erlang hljs">rocker:delete(Db, &lt;&lt;<span class="hljs-string"><span class="hljs-string">"key"</span></span>&gt;&gt;) -&gt; ok.</code> </pre> <br><h6 id="zapis-dannyh-po-klyuchu-v-ramkah-cf">  Schlüsseldateneingabe in CF </h6><br><pre> <code class="erlang hljs">rocker:put_cf(Db, &lt;&lt;<span class="hljs-string"><span class="hljs-string">"testcf"</span></span>&gt;&gt;, &lt;&lt;<span class="hljs-string"><span class="hljs-string">"key"</span></span>&gt;&gt;, &lt;&lt;<span class="hljs-string"><span class="hljs-string">"value"</span></span>&gt;&gt;) -&gt; ok.</code> </pre> <br><h6 id="poluchenie-dannyh-po-klyuchu-v-ramkah-cf">  Abrufen von Schlüsseldaten innerhalb von CF. </h6><br><pre> <code class="erlang hljs">rocker:get_cf(Db, &lt;&lt;<span class="hljs-string"><span class="hljs-string">"testcf"</span></span>&gt;&gt;, &lt;&lt;<span class="hljs-string"><span class="hljs-string">"key"</span></span>&gt;&gt;) -&gt; {ok, &lt;&lt;<span class="hljs-string"><span class="hljs-string">"value"</span></span>&gt;&gt;} | notfound</code> </pre> <br><h6 id="udalenie-dannyh-po-klyuchu-v-ramkah-cf">  Entfernen des CF-Schlüssels </h6><br><pre> <code class="erlang hljs">rocker:delete_cf(Db, &lt;&lt;<span class="hljs-string"><span class="hljs-string">"testcf"</span></span>&gt;&gt;, &lt;&lt;<span class="hljs-string"><span class="hljs-string">"key"</span></span>&gt;&gt;) -&gt; ok</code> </pre> <br><h4 id="iteratory">  Iteratoren </h4><br><p>  Wie Sie wissen, ist eines der Grundprinzipien von rocksbb die ordnungsgemäße Aufbewahrung von Schlüsseln.  Diese Funktion ist bei realen Aufgaben sehr nützlich.  Um es zu verwenden, benötigen wir Dateniteratoren.  Rocksdb verfügt über mehrere Modi zum Übergeben von Daten (detaillierte Codebeispiele finden Sie in den <a href="">Tests</a> ): </p><br><ul><li>  Vom Anfang der Tabelle.  Der Rocker ist dafür im Iterator <code>{'start'}</code> </li><li>  Vom Ende der Tabelle: <code>{'end'}</code> </li><li>  Ausgehend von einem bestimmten Schlüssel vorwärts <code>{'from', Key, forward}</code> </li><li>  Ausgehend von einem bestimmten Schlüssel zurück <code>{'from', Key, reverse}</code> </li></ul><br><p>  Es ist anzumerken, dass diese Modi auch zum Durchlaufen der in Spaltenfamilien gespeicherten Daten funktionieren. </p><br><h6 id="sozdanie-iteratora">  Erstellen Sie einen Iterator </h6><br><pre> <code class="erlang hljs">rocker:iterator(Db, {'start'}) -&gt; {ok, Iter}.</code> </pre> <br><h6 id="proverka-iteratora">  Iteratorprüfung </h6><br><pre> <code class="erlang hljs">rocker:iterator_valid(Iter) -&gt; {ok, true} | {ok, false}.</code> </pre> <br><h6 id="sozdanie-iteratora-dlya-cf">  Erstellen eines Iterators für CF </h6><br><pre> <code class="erlang hljs">rocker:iterator_cf(Db, Cf, {'start'}) -&gt; {ok, Iter}.</code> </pre> <br><h6 id="sozdanie-prefiksnogo-iteratora">  Erstellen eines Präfix-Iterators </h6><br><p>  Der Präfix-Iterator erfordert die explizite Angabe der Länge des Präfixes beim Erstellen der Datenbank. </p><br><pre> <code class="erlang hljs">{ok, Db} = rocker:open(Path, #{ prefix_length =&gt; <span class="hljs-number"><span class="hljs-number">3</span></span> }).</code> </pre> <br><p>  Ein Beispiel für die Erstellung eines Iterators mit dem Präfix "aaa": </p><br><pre> <code class="erlang hljs">{ok, Iter} = rocker:prefix_iterator(Db, &lt;&lt;<span class="hljs-string"><span class="hljs-string">"aaa"</span></span>&gt;&gt;).</code> </pre> <br><h6 id="sozdanie-prefiksnogo-iteratora-dlya-cf">  Erstellen eines Präfix-Iterators für CF </h6><br><p>  Ähnlich wie beim vorherigen Präfix-Iterator ist für die Spaltenfamilie eine explizite <code>prefix_length</code> erforderlich </p><br><pre> <code class="erlang hljs">{ok, Iter} = rocker:prefix_iterator_cf(Db, Cf, &lt;&lt;<span class="hljs-string"><span class="hljs-string">"aaa"</span></span>&gt;&gt;).</code> </pre> <br><h6 id="polucheniya-sleduyuschego-elementa">  Holen Sie sich den nächsten Artikel </h6><br><p>  Die Methode gibt den nächsten Schlüssel / Wert zurück oder ok, wenn der Iterator abgeschlossen ist. </p><br><pre> <code class="erlang hljs">rocker:next(Iter) -&gt; {ok, &lt;&lt;<span class="hljs-string"><span class="hljs-string">"key"</span></span>&gt;&gt;, &lt;&lt;<span class="hljs-string"><span class="hljs-string">"value"</span></span>&gt;&gt;} | ok</code> </pre> <br><h4 id="tranzakcii">  Transaktionen </h4><br><p>  Ein ziemlich häufiges Ereignis ist die Anforderung, Änderungen an einer Schlüsselgruppe gleichzeitig aufzuzeichnen.  Mit Rocker können Sie CRUD-Operationen sowohl innerhalb eines gemeinsamen Satzes als auch innerhalb von CF kombinieren. <br>  Dieses Beispiel zeigt die Arbeit mit Transaktionen: </p><br><pre> <code class="erlang hljs">{ok, <span class="hljs-number"><span class="hljs-number">6</span></span>} = rocker:tx(Db, [ {put, &lt;&lt;<span class="hljs-string"><span class="hljs-string">"k1"</span></span>&gt;&gt;, &lt;&lt;<span class="hljs-string"><span class="hljs-string">"v1"</span></span>&gt;&gt;}, {put, &lt;&lt;<span class="hljs-string"><span class="hljs-string">"k2"</span></span>&gt;&gt;, &lt;&lt;<span class="hljs-string"><span class="hljs-string">"v2"</span></span>&gt;&gt;}, {delete, &lt;&lt;<span class="hljs-string"><span class="hljs-string">"k0"</span></span>&gt;&gt;, &lt;&lt;<span class="hljs-string"><span class="hljs-string">"v0"</span></span>&gt;&gt;}, {put_cf, Cf, &lt;&lt;<span class="hljs-string"><span class="hljs-string">"k1"</span></span>&gt;&gt;, &lt;&lt;<span class="hljs-string"><span class="hljs-string">"v1"</span></span>&gt;&gt;}, {put_cf, Cf, &lt;&lt;<span class="hljs-string"><span class="hljs-string">"k2"</span></span>&gt;&gt;, &lt;&lt;<span class="hljs-string"><span class="hljs-string">"v2"</span></span>&gt;&gt;}, {delete_cf, Cf, &lt;&lt;<span class="hljs-string"><span class="hljs-string">"k0"</span></span>&gt;&gt;, &lt;&lt;<span class="hljs-string"><span class="hljs-string">"v0"</span></span>&gt;&gt;} ]).</code> </pre> <br><h4 id="proizvoditelnost">  Leistung </h4><br><p>  Einen Leistungstest finden Sie in der Testsuite.  Es werden ungefähr 30.000 RPS zum Schreiben und 200.000 RPS zum Lesen auf meinem Computer angezeigt.  Unter realen Bedingungen können Sie 15 bis 20.000 RPS zum Schreiben und etwa 120.000 RPS zum Lesen mit einer durchschnittlichen Datengröße von etwa 1 KB pro Schlüssel erwarten, und die Gesamtzahl der Schlüssel beträgt mehr als 1 Milliarde. </p><br><h4 id="zaklyuchenie">  Fazit </h4><br><p>  Die Entwicklung und Anwendung von Rocker in unserem Projekt ermöglichte es uns, die Reaktionszeit des Systems zu verkürzen, die Zuverlässigkeit zu erhöhen und die Neustartzeit zu verkürzen.  Diese Vorteile wurden mit minimalen Entwicklungs- und Implementierungskosten erzielt. </p><br><p>  Ich bin zu dem Schluss gekommen, dass für Erlang-Projekte, die optimiert werden müssen, die Verwendung von Rust optimal ist.  Erlang schafft es, 95% des Codes schnell und effizient zu implementieren, während Rust 5% hemmend umschreibt / hinzufügt, ohne die Zuverlässigkeit des Gesamtsystems zu beeinträchtigen. </p><br><p>  PS Es gibt positive Erfahrungen bei der Entwicklung von NIF für Arithmetik mit beliebiger Genauigkeit in Erlang, die in einem separaten Artikel beschrieben werden kann.  Ich möchte klarstellen, ob das NIF-Thema zu Rust für die Community interessant ist. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de413353/">https://habr.com/ru/post/de413353/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de413341/index.html">Mitapa Sbertekh im Juni: MOSDROID in Moskau und Vert.x in Rjasan</a></li>
<li><a href="../de413343/index.html">BCG-Bericht: Neue Milliardäre und disruptive Technologien in der Philanthropie</a></li>
<li><a href="../de413347/index.html">Analyse der negativen Atmosphäre und wie man damit umgeht</a></li>
<li><a href="../de413349/index.html">Welche Google Analytics-Metriken lösen schlechte Entscheidungen aus?</a></li>
<li><a href="../de413351/index.html">Über Menschen, Monster - und thematische Modellierung</a></li>
<li><a href="../de413357/index.html">Schauen Sie sich zuerst das Gaming-Smartphone ASUS ROG Phone an</a></li>
<li><a href="../de413359/index.html">Windows 10 IoT Enterprise - Konfigurationsgeheimnisse für eingebettete Skripte</a></li>
<li><a href="../de413361/index.html">Theorie der großen Deponie: Wir suchen nach wissenschaftlichen Dokumenten im Internet</a></li>
<li><a href="../de413363/index.html">Der Handwerker schraubte das Canon EF 70-200 mm Teleobjektiv an die Game Boy Kamera</a></li>
<li><a href="../de413367/index.html">Was ist eine globale Kohlenwasserstoffblase? Energiemarktsimulationsergebnisse bis 2050 g</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>