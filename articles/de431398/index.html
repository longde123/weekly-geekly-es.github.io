<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§æüèª üçí üïµüèº Wie ich einen Hosting-Anbieter gehackt habe ü§§ üèüÔ∏è üë£</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Vor kurzem erhielt ich einen Vorschlag, den Betrieb verschiedener Dienste auf Fehler und Schwachstellen zu √ºberpr√ºfen. Und in solchen Vorschl√§gen vers...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Wie ich einen Hosting-Anbieter gehackt habe</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/431398/"><img src="https://habrastorage.org/webt/ll/i7/8h/lli78hrfs3wa8mxil9xhv4mux44.gif"><br><br>  Vor kurzem erhielt ich einen Vorschlag, den Betrieb verschiedener Dienste auf Fehler und Schwachstellen zu √ºberpr√ºfen.  Und in solchen Vorschl√§gen versuche ich, f√ºr das Ergebnis zu arbeiten und die maximale Freude am Prozess zu haben.  Aber das Ergebnis des letzten ‚ÄûProjekts‚Äú hat mich gelinde gesagt schockiert. <br><br>  Ich wurde gebeten, den Hosting-Anbieter zu testen. <br><a name="habracut"></a><br>  Ich werde den Namen nicht preisgeben.  Und in meiner Geschichte werde ich den Namen Hoster verwenden.  Bei der Site selbst war der Hosting-Service Standard.  Angebote zum Kauf von VDS, Domains, SSL-Zertifikaten. <br><br>  Zun√§chst war ich √ºberrascht, wie das pers√∂nliche Konto des Benutzers implementiert wurde.  Ein Eigentumsnachweis der E-Mail-Adresse bei der Registrierung war nicht erforderlich.  Das hei√üt, Sie k√∂nnen sich unter der E-Mail-Adresse steve.jobs@apple.com registrieren.  Oder noch besser, support@hoster.com. <br><br>  Gl√ºcklicherweise fand in Analogie zu <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">dieser Geschichte</a> die Offenlegung sensibler Informationen des Service-Support-Desks nicht statt. <br><br>  Dies geschah jedoch, als ich eine Test-Support-Anfrage erstellte und sofort die Verf√ºgbarkeit benachbarter ID-Anfragen f√ºr andere Support-Anfragen √ºberpr√ºfte.  √úberraschenderweise waren sie verf√ºgbar.  Und es war m√∂glich zu beobachten, wer und was sich beim Hoster anmeldet.  Und mit welchen Problemen sind Benutzer konfrontiert?  Im Allgemeinen die Standard-IDOR-Sicherheitsl√ºcke, die jetzt niemanden √ºberraschen wird.  Nat√ºrlich wurde sie sofort korrigiert. <br><br>  Es gab auch mehrere Orte mit Stored XSS.  Es gab auch Blind XSS, das mir das Service Administrator Cookie zur√ºckgab.  Dank dieses XSS konnte ich herausfinden, wo sich die Administratoroberfl√§che befindet, und im Allgemeinen enth√ºllte es viele interessante Informationen. <br><br><ul><li>  Wie viele aktive Benutzer. </li><li>  Wie viele Domains haben die Kontrolle? </li><li>  Wie viele VDS werden bereitgestellt? </li></ul><br>  Und vieles mehr ... <br><br><img src="https://habrastorage.org/webt/ua/iz/zl/uaizzlxoh7o3eutwvtomg6mfrvu.png"><br><br>  Es gab verschiedene Fehler mit CSRF-Token, die es dem Benutzer erm√∂glichten, viele gef√§hrliche Dinge in Ihrem Konto zu tun.  Und wenn es Orte gab, an denen CSRF-Token √ºbertragen wurden, wurden sie einfach √ºbertragen.  Niemand hatte vor, sie im Backend zu √ºberpr√ºfen.  Aufgrund meiner Erkenntnisse war ein Teil der Funktionalit√§t vollst√§ndig deaktiviert.  Beispielsweise wurde beschlossen, die 2FA-Authentifizierung vor√ºbergehend zu entfernen, da sie in der Implementierung nicht stattfand. <br><br>  Bei meiner Arbeit habe ich nicht nur auf Sicherheitsprobleme geachtet, sondern auch auf Implementierungsfehler oder Probleme beim Betrieb einiger Funktionen.  Ich mag QA konnte so nicht vorbeigehen.  Infolgedessen erreichte mein Issue-Tracker die Zahl 22. So viele Probleme insgesamt habe ich gefunden und behoben (√§u√üerst bemerkenswert). <br><br>  Die Ergebnisse waren mehr als √ºberzeugend.  Und ich hatte bereits vor, dieses Projekt abzuschlie√üen.  Aber aus irgendeinem Grund erinnerte ich mich wieder an das Problem der fehlenden Best√§tigung des Inhabers der E-Mail-Adresse bei der Registrierung.  Und er begann Situationen zu entwickeln, in denen dies dem Hosting und seinen Eigent√ºmern maximale Probleme bereiten kann.  Irgendwann begann ich √ºber die Beziehungen der Eigent√ºmer dieses Hosting-Dienstes zu anderen Projekten des gleichen Unternehmens nachzudenken, von denen ich wusste.  Nach ein paar Minuten registrierte ich ein Konto mit der E-Mail-Adresse eines anderen Projekts desselben Unternehmens (sei es support@example.com).  Dann habe ich es geschafft, die Domain example.com an mein erstelltes Konto suppot@example.com zu binden.  Aber ich konnte den Inhalt der gebundenen Domain immer noch nicht kontrollieren. <br><br>  Aber er konnte im Auftrag des example.com-Dienstes perfekt mit E-Mails fischen. <br><br><img src="https://habrastorage.org/webt/fi/qk/it/fiqkityfxwga7pfldwvdhlgoqnq.png"><br><br>  Es ist nicht klar, wohin die Antwortschreiben kamen.  Weil ich mir einen solchen Testbrief beantwortet habe.  Aber ich habe die Antwort selbst nicht erhalten.  Es ist wahrscheinlich als Antwort auf den tats√§chlichen Eigent√ºmer des E-Mail-Kontos support@example.com verschwunden. <br><br>  Und dann passierte etwas, f√ºr das ich mich entschied, diesen Artikel zu schreiben. <br><br>  Ich habe es geschafft, die vergessene Subdomain aufzul√∂sen.  Klassische Sicherheitsl√ºcke bei der √úbernahme von Subdomains.  Mehr dazu lesen Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> . <br><br>  Ich wei√ü nicht warum, aber ich habe versucht, einer nicht vorhandenen Domain eine Bindung hinzuzuf√ºgen.  Und ich habe es geschafft. <br><br><img src="https://habrastorage.org/webt/eo/hw/l0/eohwl0ueicowiesegl-jtpiamog.png"><br><br>  Die Subdomain wurde erfolgreich hinzugef√ºgt und ich konnte den Inhalt dieser Subdomain steuern.  Und der Inhalt wurde angezeigt. <br><br><img src="https://habrastorage.org/webt/go/dp/k_/godpk_k1sl3c056c-atq7t30fjy.png"><br><br>  Das kann aber nicht dasselbe sein!  Wie so ?!  Schlie√ülich funktioniert die klassische Sicherheitsanf√§lligkeit bez√ºglich der √úbernahme von Subdomains nur mit vorhandenen Subdomains. <br><br>  Diese Situation passte absolut nicht in meinen Kopf.  Das hei√üt, okay, ich konnte die Validierungsstufen meiner Einstellung zu example.com umgehen, die niemals meine ist (wahrscheinlich dank <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link">example</a> .com im Namen meines Kontos).  Aber wie ist es √ºberhaupt m√∂glich, Subdomains hinzuzuf√ºgen und zu steuern, ohne Komponenten in den A-, TXT-, CNAME-Datens√§tzen zu √ºberpr√ºfen ...? <br><br>  Normalerweise sehe ich das - wir werden Ihnen eine Subdomain hinzuf√ºgen, nur Sie beweisen, dass Sie es k√∂nnen.  Gehen Sie und f√ºgen Sie TXT diesen Hash <i>ololopyshpyshpyshbdysh123 hinzu</i> . <br><br>  Aber so etwas gab es nicht.  M√∂chten Sie die Subdomain admin.example.com?  Kein Problem! <br><br><img src="https://habrastorage.org/webt/vr/-1/ub/vr-1ub4gdfw7oerzole8jbvfl_i.jpeg"><br><br>  Als ob eine Subdomain Takeover V2-Sicherheitsl√ºcke. <br><br>  Aufgrund der M√∂glichkeit, schnell mit den Eigent√ºmern des getesteten Hosting-Dienstes zu kommunizieren, wurde mir diese Box von Pandora ge√∂ffnet. <br><br>  Es stellte sich Folgendes heraus.  Das Hosting funktionierte √ºber CloudFlare.  Und er arbeitete sehr schlau. <br>  Ich werde versuchen, es in einfachen Worten zu erkl√§ren. <br><br>  Grob gesagt, ich sage dir, komm zu mir, ich werde dich aufnehmen.  Delegieren Sie Ihre Domains an mich. <br>  Und dann sende ich alle eingehenden Anrufe wahllos an CloudFlare, wenn ich sie f√ºr richtig halte. <br>  Und wenn mir die Domain vasya.ru anvertraut wurde und ein Nachbar kam und die Site mit test.vasya.ru geknebelt und mir auch zum Hosting gegeben hat, hat mein Server, der Zugriff auf CloudFlare hat und bereits Rechte an vasya.ru hat, die dritte Ebene ohne Probleme hinzugef√ºgt Domain f√ºr einen Nachbarn und alle Regeln, schnell und ohne Frage.  F√ºr alle DNS sind die richtigen Informationen von CloudFlare eingetroffen.  Und CloudFlare vertraut mir. <br><br>  Normalerweise konfigurieren Hosting-Anbieter ihre DNS-Dienste nat√ºrlich.  Aber hier stellt sich heraus, dass sie betrogen haben und einfach alles von einem Benutzer auf CloudFlare √ºbertragen. <br><br>  Wir haben also eine Subdomain-√úbernahme god_mode.  Dies funktionierte zwar nur mit den Adressen, die das Hosting bereits steuert.  In Verbindung mit dem zuvor entdeckten Service-Admin-Panel k√∂nnte dies sowohl f√ºr den Hoster als auch f√ºr die Hosting-Service-Clients einen Streich spielen. <br><br>  Im Moment wurden fast alle kritischen Schwachstellen und Fehler behoben.  Und ich hoffe, dass sich niemand nach dem Lesen dieser Geschichte f√ºr solche architektonischen Freuden entscheiden wird. <br><br>  PS: Kommentare und Vorschl√§ge zum Artikel sind willkommen.  Besonderer Dank geht an <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link">Patriot2k</a> f√ºr die technische Beratung!  Ich bin auch offen f√ºr Vorschl√§ge zum Testen von etwas Interessantem. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de431398/">https://habr.com/ru/post/de431398/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de431388/index.html">Die Welt mit den Augen eines Autos. Wie sehen ihn Drohnen?</a></li>
<li><a href="../de431390/index.html">Digitale Trends 2019 und ihre Auswirkungen auf das ver√§nderte Verbraucherverhalten</a></li>
<li><a href="../de431392/index.html">Shamirs geheimes Austauschschema</a></li>
<li><a href="../de431394/index.html">Neugierige Perversionen aus der IT-Welt</a></li>
<li><a href="../de431396/index.html">Wie wir biometrische Kundendaten erfassen</a></li>
<li><a href="../de431400/index.html">30 Android-Bibliotheken und -Tools, die Sie bis 2018 nicht weitergeben sollten</a></li>
<li><a href="../de431402/index.html">Uber AI Montezumas Rache ging besser als menschlich vorbei</a></li>
<li><a href="../de431404/index.html">Echte Wi-Fi-Geschwindigkeit (in Unternehmen)</a></li>
<li><a href="../de431406/index.html">Wie man einen Hackathon gewinnt</a></li>
<li><a href="../de431408/index.html">Wie man Kunden effektiv vorbereitet und Fragen stellt</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>