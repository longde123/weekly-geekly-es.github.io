<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐๏ธ ๐ฉ๐ปโ๐จ ๐ ุทุจูุฉ ุงูุงูุชูุงู: ุชูููุงุช ุชุญุณูู ุงูุถุฑุจ ุจุงููุตูููุฉ ๐ฎ ๐ฏ๏ธ ๐ฉ๐ผโโ๏ธ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ููุฏูุฉ 
 ูุฐู ุงูููุงูุฉ ูู ุณูุณูุฉ ูู ุงูููุงูุงุช ุงูุชู ุชุตู ุงูุฎูุงุฑุฒููุงุช ุงูุฃุณุงุณูุฉ. 
 Synet ูู ุฅุทุงุฑ ูุฅุทูุงู ุดุจูุงุช ุนุตุจูุฉ ูุฏุฑุจุฉ ูุณุจููุง ุนูู ูุญุฏุฉ ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉ. 

...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ุทุจูุฉ ุงูุงูุชูุงู: ุชูููุงุช ุชุญุณูู ุงูุถุฑุจ ุจุงููุตูููุฉ</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/448436/" style=";text-align:right;direction:rtl"><h2 style=";text-align:right;direction:rtl">  ููุฏูุฉ </h2><br>  ูุฐู ุงูููุงูุฉ ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุณูุณูุฉ ูู ุงูููุงูุงุช ุงูุชู</a> ุชุตู ุงูุฎูุงุฑุฒููุงุช ุงูุฃุณุงุณูุฉ. <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">Synet</a> ูู ุฅุทุงุฑ ูุฅุทูุงู ุดุจูุงุช ุนุตุจูุฉ ูุฏุฑุจุฉ ูุณุจููุง ุนูู ูุญุฏุฉ ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉ. <br><br>  ุฅุฐุง ูุธุฑุช ุฅูู ุชูุฒูุน ููุช ุงููุนุงูุฌ ุงูุฐู ูุชู ุฅููุงูู ุนูู ุงูุชุดุงุฑ ุงูุฅุดุงุฑุงุช ุงููุจุงุดุฑุฉ ูู ุงูุดุจูุงุช ุงูุนุตุจูุฉ ุ ุงุชุถุญ ุฃู ุฃูุซุฑ ูู 90ูช ูู ุงูููุช ูุชู ุฅููุงูู ูู ุทุจูุงุช ุชูุงููููุฉ.  ูุฐูู ุ ุฅุฐุง ุฃุฑุฏูุง ุงูุญุตูู ุนูู ุฎูุงุฑุฒููุฉ ุณุฑูุนุฉ ูุดุจูุฉ ุนุตุจูุฉ ุ ูุญุชุงุฌ ุฃููุงู ููุจู ูู ุดูุก ุฅูู ุฎูุงุฑุฒููุฉ ุณุฑูุนุฉ ูุทุจูุฉ ุชูุงููููุฉ.  ูู ูุฐู ุงูููุงูุฉ ุ ุฃูุฏ ุฃู ุฃุตู ุทุฑู ุชุญุณูู ุงูุชุดุงุฑ ุงูุฅุดุงุฑุงุช ุงููุจุงุดุฑุฉ ูู ุทุจูุฉ ุชูุงููููุฉ.  ูุฃุฑูุฏ ุฃู ุฃุจุฏุฃ ุจุงูุฃุณุงููุจ ุงูุฃูุซุฑ ุงุณุชุฎุฏุงููุง ุนูู ุฃุณุงุณ ุถุฑุจ ุงููุตูููุฉ.  ุณุฃุญุงูู ุงูุงุญุชูุงุธ ุจุงูุนุฑุถ ุงูุชูุฏููู ุจุฃูุซุฑ ุฃุดูุงูู ุณูููุฉ ูููุตูู ุ ุจุญูุซ ุชููู ุงูููุงูุฉ ูุซูุฑุฉ ููุงูุชูุงู ููุณ ููุท ูููุชุฎุตุตูู (ุฅููู ูุนุฑููู ูู ุดูุก ุนููุง ุจุงููุนู) ุ ูููู ุฃูุถูุง ูุฏุงุฆุฑุฉ ุฃูุณุน ูู ุงููุฑุงุก.  ูุง ุฃุฏุนู ุฃู ุฃููู ูุฑุงุฌุนุฉ ูุงููุฉ ุ ูุฐุง ูุฅู ุฃู ุชุนูููุงุช ุฃู ุฅุถุงูุงุช ูุฑุญุจ ุจูุง ููุท. <br><a name="habracut"></a><br><h2 style=";text-align:right;direction:rtl">  ุฎูุงุฑุงุช ุทุจูุฉ ุงูุงูุชูุงุก </h2><br>  ุฃูุฏ ุฃู ุฃุจุฏุฃ ุงููุตู ูุน ูุตู ูููุนููุงุช ุงูููุฌูุฏุฉ ูู ุงูุทุจูุฉ ุงูุชูุงููููุฉ.  ูููู ููุฎุจุฑุงุก ุจุฃูุงู ุชุฎุทู ูุฐุง ุงููุณู. <br><br><h4 style=";text-align:right;direction:rtl">  ุฃุญุฌุงู ุงูุตูุฑ ุงููุฏุฎูุงุช ูุงููุฎุฑุฌุงุช </h4><br>  ุจุงุฏุฆ ุฐู ุจุฏุก ุ ุชุชููุฒ ุงูุทุจูุฉ ุงูุชูุงููููุฉ ุจูุฏุฎูุงุช ูุตูุฑุฉ ูุฎุฑุฌุงุช ุชุชููุฒ ุจุงููุนููุงุช ุงูุชุงููุฉ: <br><br><img src="https://habrastorage.org/webt/tg/-_/c1/tg-_c1xgj4vbobu3_7l8rcp5u_0.png" alt="ุตูุฑุฉ"><br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <b>srcC / dstC</b> - ุนุฏุฏ ุงููููุงุช ูู ุตูุฑุฉ ุงููุฏุฎูุงุช ูุงููุฎุฑุฌุงุช.  ุชุฏููู ุจุฏูู: <b>C / D.</b> </li><li style=";text-align:right;direction:rtl">  <b>srcH / dstH</b> - ุงุฑุชูุงุน ุตูุฑุฉ ุงููุฏุฎูุงุช ูุงููุฎุฑุฌุงุช.  ุงูุชุนููู ุงูุจุฏูู: <b>H.</b> </li><li style=";text-align:right;direction:rtl">  <b>srcW / dstW</b> - ุนุฑุถ ุตูุฑุฉ ุงููุฏุฎูุงุช ูุงููุฎุฑุฌุงุช.  ุงูุชุนููู ุงูุจุฏูู: <b>W.</b> </li><li style=";text-align:right;direction:rtl">  <b>ุฏูุนุฉ</b> - ุนุฏุฏ ุตูุฑ ุงููุฏุฎูุงุช (ุงูุฅุฎุฑุงุฌ) - ูููู ููุทุจูุฉ ูุนุงูุฌุฉ ูุฌููุนุฉ ูุงููุฉ ูู ุงูุตูุฑ ูู ููุช ูุงุญุฏ.  ุงูุชุนููู ุงูุจุฏูู: <b>N.</b> </li></ul><br><h4 style=";text-align:right;direction:rtl">  ุฃุญุฌุงู ุงูุฃุณุงุณูุฉ ุงูุงูุชูุงุก </h4><br>  ุนูููุฉ ุงูุงูุชูุงุก ูู ุจุทุจูุนุชูุง ูุฌููุน ูุฑุฌุญ ูููุทูุฉ ูุนููุฉ ูู ููุทุฉ ูุนููุฉ ูู ุงูุตูุฑุฉ.  ุญุฌู ุงูููุงุฉ ุงูุฅูุชูุงุกูุฉ - ูููุฒ ุญุฌู ูุฐุง ุงูุญู ูููุตู ุจูุนููุชูู: <br><br><img src="https://habrastorage.org/webt/2y/kj/z5/2ykjz5xeebrq6p2dmhrqxxk1pqu.png" alt="ุตูุฑุฉ"><br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <b>kernelY</b> ูู ุงุฑุชูุงุน ููุงุฉ ุงูุงูุชูุงุก.  ุงูุชุนููู ุงูุจุฏูู: <b>Y.</b> </li><li style=";text-align:right;direction:rtl">  <b>kernelX</b> ูู ุนุฑุถ kernel ุงูุงูุชูุงุก.  ุงูุชุนููู ุงูุจุฏูู: <b>X.</b> </li></ul><br>  ุงูุชููุงุฒ ุงูุฃูุซุฑ ุดููุนูุง ูุน ุญุฌู ุงูููุงุฉ <b>1 ร 1</b> ู <b>3</b> <b>ร</b> <b>3</b> .  ุงูุฃุญุฌุงู <b>5 ร 5</b> ู 7 <b>ร 7</b> ุฃูู ุดููุนูุง.  ุฃุญุฌุงู ุงูุฅูุชูุงุก ุงููุจูุฑุฉ ุ ููุฐูู ุงูุชุดุงุจู ูุน ููุงุฉ ุบูุฑ ูุฑุจุนุฉ ุ ุชูุฌุฏ ุฃูุถูุง ูู ุจุนุถ ุงูุฃุญูุงู ุ ููู ูุฐุง ุฃูุซุฑ ุบุฑุงุจุฉ. <br><br><h4 style=";text-align:right;direction:rtl">  ุฎุทูุฉ ุงูุงูุชูุงุก </h4><br>  ูุนููุฉ ูููุฉ ุฃุฎุฑู ูู ุฎุทูุฉ ุงูุงูุชูุงุก: <br><br><img src="https://habrastorage.org/webt/ya/wn/qb/yawnqbziijnefknaqbjalqkzzgu.png" alt="ุตูุฑุฉ"><br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <b>strideY</b> ูู ุฎุทูุฉ ุงูุงูุชูุงุก ุงูุนููุฏู. </li><li style=";text-align:right;direction:rtl">  <b>strideX</b> - ุฎุทูุฉ ุงูุงูุชูุงุก ุงูุฃููู. </li></ul><br>  ุฅุฐุง ูุงูุช ุงูุฎุทูุฉ ูุฎุชููุฉ ุนู <b>1x1</b> ุ ุนูู ุณุจูู ุงููุซุงู - <b>2x2</b> ุ ูุณุชููู ุตูุฑุฉ ุงููุฎุฑุฌุงุช ุจููุฏุงุฑ ุงููุตู (ุณูุชู ุญุณุงุจ ุงูุฅูุชูุงุก ููุท ูู ุฌูุงุฑ ุงูููุงุท ุงูุฒูุฌูุฉ). <br><br><h4 style=";text-align:right;direction:rtl">  ุชูุชุฏ ุงูุฅูุชูุงุก </h4><br>  ูููู ุชูุฏูุฏ ููุงุฉ ุงูุงูุชูุงุก (ุฒูุงุฏุฉ ุญุฌู ุงูุฅุทุงุฑ ุงููุนุงู ุ ูุน ุงูุญูุงุธ ุนูู ุนุฏุฏ ุงูุนูููุงุช) ุจุงุณุชุฎุฏุงู ุงููุนููุงุช ุงูุชุงููุฉ: <br><br><img src="https://habrastorage.org/webt/vb/sv/ev/vbsvevdr2qioxy8htvhxwzx2e4k.png" alt="ุตูุฑุฉ"><br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <b>ุงุชุณุงุน</b> - <b>ุงูุชูุฏุฏ</b> ุงูุนููุฏู ููุงูุชูุงุก. </li><li style=";text-align:right;direction:rtl">  <b>ุงูุชูุฏุฏ</b> - ุงูุงูุชุฏุงุฏ ุงูุฃููู ููุงูุชูุงุก. </li></ul><br>  ุชุฌุฏุฑ ุงูุฅุดุงุฑุฉ ุฅูู ุฃู ุงูุญุงูุงุช ุงูุชู ุชูุชุฏ ุจุฎูุงู <b>1x1 ูู ุฃูุฑ</b> ูุงุฏุฑ ุงูุญุฏูุซ (ูู ุฃุตุงุฏู ูุซู ูุฐุง ุงูุดูุก ูู ุญูุงุชู ุงูููููุฉ). <br><br><h4 style=";text-align:right;direction:rtl">  ุงูุญุดู ุตูุฑุฉ ุงูุฅุฏุฎุงู </h4><br>  ุฅุฐุง ููุช ุจุชุทุจูู ููููู ูุน ูุงูุฐุฉ ูุฎุชููุฉ ุนู ูุงูุฐุฉ ูุงุญุฏุฉ ุฅูู ุงูุตูุฑุฉ ุ ูุฅู ุตูุฑุฉ ุงูุฅุฎุฑุงุฌ ุณุชููู ุฃูู ุจููุฏุงุฑ <b>kernel - 1</b> .  ุงูุญุฒูุฉ ุ ููุง ูุงูุช ุ "ุชุฃูู" ุงูุญูุงู.  ููุญูุงุธ ุนูู ุญุฌู ุงูุตูุฑุฉ ุ ุบุงูุจูุง ูุง ูุชู ุชุนุจุฆุฉ ุตูุฑุฉ ุงูุฅุฏุฎุงู ุญูู ุงูุญูุงู ุจุงุณุชุฎุฏุงู ุงูุฃุตูุงุฑ.  ููุงู ุฃุฑุจุน ูุนููุงุช ุฃุฎุฑู ูุณุคููุฉ ุนู ูุฐุง: <br><br><img src="https://habrastorage.org/webt/p7/px/n0/p7pxn0rfwa2zhinvydqg7gu0-si.png" alt="ุตูุฑุฉ"><br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <b>padY / padX</b> - <b>ุงูุญุดู</b> ุงูุฃูุงูู ูุงูุฃููู ุงูุฃูุงูู. </li><li style=";text-align:right;direction:rtl">  <b>padH / padW</b> - <b>ุงูุญุดูุฉ</b> ุงูุฎูููุฉ ุงูุนููุฏูุฉ ูุงูุฃูููุฉ. </li></ul><br><h4 style=";text-align:right;direction:rtl">  ูุฌููุนุงุช ุงููููุงุช </h4><br>  ุนุงุฏุฉู ูุง ุชููู ูู ููุงุฉ ุฅุฎุฑุงุฌ ุนุจุงุฑุฉ ุนู ูุฌููุน ุงูุชููููุงุช ุนุจุฑ ุฌููุน ูููุงุช ุงูุฅุฏุฎุงู.  ููุน ุฐูู ุ ูุฐุง ููุณ ูู ุงูุญุงู ุฏุงุฆูุง.  ูู ุงููููู ุชูุณูู ูููุงุช ุงูุฅุฏุฎุงู ูุงูุฅุฎุฑุงุฌ ุฅูู ูุฌููุนุงุช ุ ููุชู ุงูุฌูุน ููุท ุฏุงุฎู ุงููุฌููุนุงุช: <br><br><img src="https://habrastorage.org/webt/pz/uu/xp/pzuuxpq0grj9zxpmz_oft_eacnm.png" alt="ุตูุฑุฉ"><br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <b>ุงููุฌููุนุฉ</b> - ุนุฏุฏ ุงููุฌููุนุงุช. </li></ul><br>  ูู ุงูููุงุฑุณุฉ ุงูุนูููุฉ ุ ุบุงูุจุงู ูุง ุชุชู ููุงุฌูุฉ ุงูููุงูู ูุน <b>group = 1</b> ู <b>group = srcC = dstC</b> ุ ูุง ูุณูู <b>ุจุงูุงูุชูุงุก ุจุนูู</b> . <br><br><h4 style=";text-align:right;direction:rtl">  ูุธููุฉ ุงูุชุดุฑุฏ ูุงูุชูุนูู </h4><br>  ุนูู ุงูุฑุบู ูู ุฃู ูุธููุฉ ุงูุฅุฒุงุญุฉ ูุงูุชูุนูู ูุง ูุชู ุชุถููููุง ุฑุณูููุง ูู ุงูุงูุชูุงุก ุ ูููู ูู ูุซูุฑ ูู ุงูุฃุญูุงู ุชุชุจุน ูุงุชุงู ุงูุนูููุชุงู ุงูุทุจูุฉ ุงูููุชููุฉ ุ ููุงุฐุง ูุชู ุชุถููููุง ุฃูุถูุง ูู ุงูุนุงุฏุฉ.  ูู ุถูุก ุชููุน ูุธุงุฆู ุงูุชูุดูุท ุงูููููุฉ ููุนููุงุชูุง ุ ูู ุฃุตููุง ููุง ุจุงูุชูุตูู. <br><br><h2 style=";text-align:right;direction:rtl">  ุงูุชูููุฐ ุงูุฃุณุงุณู ููุฎูุงุฑุฒููุฉ </h2><br>  ุจุงุฏุฆ ุฐู ุจุฏุก ุ ุฃูุฏ ุฃู ุฃูุฏู ุชุทุจูููุง ุฃุณุงุณููุง ููุฎูุงุฑุฒููุฉ: <br><br><pre style=";text-align:right;direction:rtl"><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">float</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">relu</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> value)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> value &gt; <span class="hljs-number"><span class="hljs-number">0</span></span> ? <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> value : <span class="hljs-number"><span class="hljs-number">0</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">convolution</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> * src, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> batch, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> srcC, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> srcH, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> srcW, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> kernelY, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> kernelX, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> dilationY, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> dilationX, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> strideY, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> strideX, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> padY, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> padX, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> padH, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> padW, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> group, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> * weight, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> * bias, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> * dst, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> dstC)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> dstH = (srcH + padY + padH - (dilationY * (kernelY - <span class="hljs-number"><span class="hljs-number">1</span></span>) + <span class="hljs-number"><span class="hljs-number">1</span></span>)) / strideY + <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> dstW = (srcW + padX + padW - (dilationX * (kernelX - <span class="hljs-number"><span class="hljs-number">1</span></span>) + <span class="hljs-number"><span class="hljs-number">1</span></span>)) / strideX + <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> b = <span class="hljs-number"><span class="hljs-number">0</span></span>; b &lt; batch; ++b) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> g = <span class="hljs-number"><span class="hljs-number">0</span></span>; g &lt; group; ++g) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> dc = <span class="hljs-number"><span class="hljs-number">0</span></span>; dc &lt; dstC / group; ++dc) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> dy = <span class="hljs-number"><span class="hljs-number">0</span></span>; dy &lt; dstH; ++dy) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> dx = <span class="hljs-number"><span class="hljs-number">0</span></span>; dx &lt; dstW; ++dx) { <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> sum = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> sc = <span class="hljs-number"><span class="hljs-number">0</span></span>; sc &lt; srcC / group; ++sc) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> ky = <span class="hljs-number"><span class="hljs-number">0</span></span>; ky &lt; kernelY; ky++) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> kx = <span class="hljs-number"><span class="hljs-number">0</span></span>; kx &lt; kernelX; kx++) { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> sy = dy * strideY + ky * dilationY - padY; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> sx = dx * strideX + kx * dilationX - padX; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (sy &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; sy &lt; srcH &amp;&amp; sx &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; sx &lt; srcW) sum += src[((b * srcC + sc)*srcH + sy)*srcW + sx] * weight[((dc * srcC / group + sc)*kernelY + ky)*kernelX + kx]; } } } dst[((b * dstC + dc)*dstH + dy)*dstW + dx] = relu(sum + bias[dc]); } } } } } }</code> </pre> <br>  ูู ูุฐุง ุงูุชุทุจูู ุ ุงูุชุฑุถุช ุฃู ุตูุฑุฉ ุงููุฏุฎูุงุช ูุงููุฎุฑุฌุงุช ูู ุชูุณูู <b>NCHW</b> : <br><br><img src="https://habrastorage.org/webt/rv/qn/4u/rvqn4uc1mdjt_ltl0wlrzyf8ows.png" alt="ุตูุฑุฉ"><br><br>  ูุชู ุชุฎุฒูู ุฃูุฒุงู <b>ุงูุฅูุชูุงู</b> ุจุชูุณูู <b>DCYX</b> ุ ููุธููุฉ ุงูุชูุดูุท ุงูุฎุงุตุฉ ุจูุง ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">ReLU</a> .  ูู ุงูุญุงูุฉ ุงูุนุงูุฉ ุ ุงูุฃูุฑ ููุณ ูุฐูู ุ ูููู ุจุงููุณุจุฉ ููุชุทุจูู ุงูุฃุณุงุณู ุ ูุฅู ูุฐู ุงูุงูุชุฑุงุถุงุช ููุงุณุจุฉ ุชูุงููุง - ุนููู ุฃู ุชุจุฏุฃ ูู ุดูุก ูุง. <br><br>  ูุฏููุง 8 ุฏูุฑุงุช ูุชุฏุงุฎูุฉ ูุฅุฌูุงูู ุนุฏุฏ ุงูุนูููุงุช: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs">batch * kernelY * kernelX * srcC * dstH * dstW * dstC / group * <span class="hljs-number"><span class="hljs-number">2</span></span>,</code> </pre><br>  ุจูููุง ูููุฉ ุงูุจูุงูุงุช ูู ุงููุฏุฎูุงุช: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs">batch * srcC * srcH * srcW,</code> </pre><br>  ูุฅุฎุฑุงุฌ ุงูุตูุฑุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs">batch * dstC * dstH * dstW,</code> </pre><br>  ูุนุฏุฏ ุงูุฃูุฒุงู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs">kernelY * kernelX * srcC * dstC / group.</code> </pre><br>  ุฅุฐุง ูุงูุช <b>ุงููุฌููุนุฉ &lt;&lt; srcC</b> (ุนุฏุฏ ุงููุฌููุนุงุช ุฃุตุบุฑ ุจูุซูุฑ ูู ุนุฏุฏ ุงููููุงุช) ุ ููุฐูู ูุน ุงููุนููุงุช ุงููุจูุฑุฉ ุจูุง ููู ุงูููุงูุฉ <b>srcC</b> ู <b>srcH</b> ู <b>srcW</b> ู <b>dstC</b> ุ <b>ูุณููุงุฌู</b> ูุดููุฉ ุญุณุงุจูุฉ ููุงุณูููุฉ ุนูุฏูุง ูุชุฌุงูุฒ ุนุฏุฏ ุงูุนูููุงุช ุงูุญุณุงุจูุฉ ุจุดูู ูุจูุฑ ููุฏุงุฑ ุจูุงูุงุช ุงููุฏุฎูุงุช ูุงููุฎุฑุฌุงุช.  ุฃู  ูุฌุจ ุฃู ุชุนุชูุฏ ุนูููุฉ ุงูุงูุชูุงุก ูุน ุงูุชูููุฐ ุงูุณููู ุนูู ููุงุฑุฏ ุงูุญูุณุจุฉ ูููุนุงูุฌ ุ ูููุณ ุนูู ุนุฑุถ ุงููุทุงู ุงูุชุฑุฏุฏู ููุฐุงูุฑุฉ.  ูุจูู ููุท ููุนุซูุฑ ุนูู ูุฐุง ุงูุชูููุฐ. <br><br><h2 style=";text-align:right;direction:rtl">  ุงูุญุฏ ูู ุงููุดููุฉ ููุตูููุฉ ุงูุถุฑุจ </h2><br>  ุงูุนูููุฉ ุงูุฑุฆูุณูุฉ ูู ุงูุฅูุชูุงู ูู ุงูุญุตูู ุนูู ูุจูุบ ููุฒูู ุ ูุงูุฃูุฒุงู ูุชุณุงููุฉ ุจุงููุณุจุฉ ูุฌููุน ููุงุท ุตูุฑุฉ ุงููุฎุฑุฌุงุช.  ุฅุฐุง ููุช ุจุฅุนุงุฏุฉ ุชุฑุชูุจ ุตูุฑุฉ ุงูุฅุฏุฎุงู ููุง ููู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">im2col</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> * src, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> srcC, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> srcH, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> srcW, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> kernelY, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> kernelX, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> dilationY, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> dilationX, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> strideY, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> strideX, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> padY, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> padX, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> padH, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> padW, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> * buf)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> dstH = (srcH + padY + padH - (dilationY * (kernelY - <span class="hljs-number"><span class="hljs-number">1</span></span>) + <span class="hljs-number"><span class="hljs-number">1</span></span>)) / strideY + <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> dstW = (srcW + padX + padW - (dilationX * (kernelX - <span class="hljs-number"><span class="hljs-number">1</span></span>) + <span class="hljs-number"><span class="hljs-number">1</span></span>)) / strideX + <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> sc = <span class="hljs-number"><span class="hljs-number">0</span></span>; sc &lt; srcC; ++sc) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> ky = <span class="hljs-number"><span class="hljs-number">0</span></span>; ky &lt; kernelY; ky++) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> kx = <span class="hljs-number"><span class="hljs-number">0</span></span>; kx &lt; kernelX; kx++) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> dy = <span class="hljs-number"><span class="hljs-number">0</span></span>; dy &lt; dstH; ++dy) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> dx = <span class="hljs-number"><span class="hljs-number">0</span></span>; dx &lt; dstW; ++dx) { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> sy = dy * strideY + ky * dilationY - padY; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> sx = dx * strideX + kx * dilationX - padX; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (sy &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; sy &lt; srcH &amp;&amp; sx &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; sx &lt; srcW) *buf++ = src[((b * srcC + sc)*srcH + sy)*srcW + sx]; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> *buf++ = <span class="hljs-number"><span class="hljs-number">0</span></span>; } } } } } }</code> </pre><br>  ุซู <b>ุณููุชูู ูู</b> ุงูุชูุณูู <b>srcC - srcH - srcW ุณูุชุญูู</b> ุฅูู ุงูุชูุณูู <b>srcC - kernelY - kernelX - dstH - dstW</b> .  ููุถุญ ุงูุดูู ุฃุฏูุงู ููููุฉ ุชุญููู ุงูุตูุฑุฉ ุจุงุณุชุฎุฏุงู ุงูุญุดู <b>1</b> ู <b>3 ร 3</b> : <br><br><img src="https://habrastorage.org/webt/mn/lz/rw/mnlzrw76nnibv73tcjn2yuzsfhk.png" alt="ุตูุฑุฉ"><br><br>  ูู ูุฐู ุงูุญุงูุฉ ุ ุชุชู ูุญุงุฐุงุฉ ุฌููุน ููุงุท ุญู ุงูุตูุฑุฉ ุงููุทููุจุฉ ูุนูููุฉ ุงูุงูุชูุงู ุนูู ุทูู ุฃุนูุฏุฉ ุงููุตูููุฉ ุงููุงุชุฌุฉ (ููู ููุง ุฌุงุกุช ุชุณููุชูุง ุงุณู ุฃูู <b>ุฅูู</b> ุฃุนูุฏุฉ <b>ุงูุนููุฏ</b> ). <br><br>  ููุซู ุงูุชูุซูู ุงูุฌุฏูุฏ ูุตูุฑุฉ ุงูุฅุฏุฎุงู ุฃูุฑูุง ูุซูุฑูุง ููุงูุชูุงู ูุฃูู ูุชู ุงูุขู ุชูููู ุนูููุฉ ุงูุงูุชูุงู ูููุง ุฅูู ุถุฑุจ ุงููุตูููุฉ: <br><br><img src="https://habrastorage.org/webt/2l/cm/lp/2lcmlpitdsgjyztxnyylyqi62jo.png" alt="ุตูุฑุฉ"><br><br>  ุงูุขู ุณูุจุฏู ุฑูุฒ ุงูุฅูุชูุงู ููุฐุง: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">gemm_nn</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> M, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> N, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> K, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> alpha, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> * A, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> lda, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> beta, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> * B, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ldb, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> * C, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ldc)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; M; ++i) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> j = <span class="hljs-number"><span class="hljs-number">0</span></span>; j &lt; N; ++j) { C[i*ldc + j] = beta; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> k = <span class="hljs-number"><span class="hljs-number">0</span></span>; k &lt; K; ++k) C[i*ldc + j] += alpha * A[i*lda + k] * B[k*ldb + j]; } } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">convolution</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> * src, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> batch, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> srcC, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> srcH, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> srcW, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> kernelY, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> kernelX, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> dilationY, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> dilationX, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> strideY, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> strideX, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> padY, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> padX, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> padH, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> padW, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> group, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> * weight, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> * bias, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> * dst, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> dstC, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> * buf)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> dstH = (srcH + padY + padH - (dilationY * (kernelY - <span class="hljs-number"><span class="hljs-number">1</span></span>) + <span class="hljs-number"><span class="hljs-number">1</span></span>)) / strideY + <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> dstW = (srcW + padX + padW - (dilationX * (kernelX - <span class="hljs-number"><span class="hljs-number">1</span></span>) + <span class="hljs-number"><span class="hljs-number">1</span></span>)) / strideX + <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> M = dstC / group; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> N = dstH * dstW; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> K = srcC * kernelY * kernelX / group; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> b = <span class="hljs-number"><span class="hljs-number">0</span></span>; b &lt; batch; ++b) { im2col(src, srcC, srcH, srcW, kernelY, kernelX, dilationY, dilationY, strideY, strideX, padY, padX, padH, padW, buf); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> g = <span class="hljs-number"><span class="hljs-number">0</span></span>; g &lt; group; ++g) gemm_nn(M, N, K, <span class="hljs-number"><span class="hljs-number">1</span></span>, weight + M * K * g, K, <span class="hljs-number"><span class="hljs-number">0</span></span>, buf + N * K * g, N, dst + M * N * g, N)); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; M; ++i) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> j = <span class="hljs-number"><span class="hljs-number">0</span></span>; j &lt; N; ++j) dst[i*N+ j] = relu(dst[i*N + j] + bias[i]); src += srcC*srcH*srcW; dst += dstC*dstH*dstW; } }</code> </pre><br>  ููุง ูุชู ุชูููุฐ ุชุงููุฉ ูู ุงูุถุฑุจ ูุตูููุฉ ููุท ููุซุงู.  ูููููุง ุงุณุชุจุฏุงูู ุจุฃู ุชุทุจูู ุขุฎุฑ.  ูุญุณู ุงูุญุธ ุ ุชุนุฏ ุนูููุฉ ุงูุถุฑุจ ุงููุตูููุฉ ุนูููุฉ ูุงุฆูุฉ ููุฐ ูุชุฑุฉ ุทูููุฉ ุชู ุชูููุฐูุง ุจุงููุนู ูู ุงูุนุฏูุฏ ูู ุงูููุชุจุงุช ุจููุงุกุฉ ุนุงููุฉ ุฌุฏูุง (ุชุตู ุฅูู 90ูช ูู ุฃุฏุงุก ูุญุฏุฉ ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉ ูููู ูุธุฑููุง).  ุญูู ููุถูุน ููููุฉ ุชุญููู ูุฐู ุงูููุงุกุฉ ุ ูุฏู ุญุชู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุงูุฉ ูููุตูุฉ</a> . <br><br><h2 style=";text-align:right;direction:rtl">  ุจุงุณุชุฎุฏุงู ุงูุถุฑุจ ูุตูููุฉ ูุชูุณูู NHWC </h2><br>  ุฌูุจุง ุฅูู ุฌูุจ ูุน ุชูุณูู <b>NCHW</b> ุ ูุบุงูุจุง ูุง ุชุณุชุฎุฏู <b>NHWC</b> ูู ุงูุชุนูู ุงูุขูู: <br><br><img src="https://habrastorage.org/webt/9x/rk/j6/9xrkj6vqbrmdiamgfpmkmkxsaoo.png" alt="ุตูุฑุฉ"><br><br>  ุนูู ุณุจูู ุงููุซุงู ุ ูุงุญุธ ุฃู <b>NHWC</b> ูู ุชูุณูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">Tensorflow</a> ุงูุฃุตูู. <br><br>  ุชุฌุฏุฑ ุงูุฅุดุงุฑุฉ ุฅูู ุฃูู ุจุงููุณุจุฉ ููุฐุง ุงูุชูุณูู ุ ูููู ุฃู ุชุคุฏู ุนูููุฉ ุงูุงูุชูุงู ุฃูุถูุง ุฅูู ูุถุงุนูุฉ ุงููุตูููุฉ.  ููููุงู ุจุฐูู ุ ูู ุงูุชูุณูู <b>srcH - srcW - srcC ุ ูููู</b> ุจุชุฑุฌูุฉ ุงูุตูุฑุฉ ุงูุฃุตููุฉ ุฅูู ุงูุชูุณูู <b>dstH - dstW - kernelY - kernelX - srcC</b> ุจุงุณุชุฎุฏุงู ุฏุงูุฉ <b>im2row</b> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">im2row</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> * src, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> srcC, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> srcH, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> srcW, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> kernelY, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> kernelX, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> dilationY, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> dilationX, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> strideY, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> strideX, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> padY, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> padX, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> padH, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> padW, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> group, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> * buf)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> dstH = (srcH + padY + padH - (dilationY * (kernelY - <span class="hljs-number"><span class="hljs-number">1</span></span>) + <span class="hljs-number"><span class="hljs-number">1</span></span>)) / strideY + <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> dstW = (srcW + padX + padW - (dilationX * (kernelX - <span class="hljs-number"><span class="hljs-number">1</span></span>) + <span class="hljs-number"><span class="hljs-number">1</span></span>)) / strideX + <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> g = <span class="hljs-number"><span class="hljs-number">0</span></span>; g &lt; group; ++g) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> dy = <span class="hljs-number"><span class="hljs-number">0</span></span>; dy &lt; dstH; ++dy) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> dx = <span class="hljs-number"><span class="hljs-number">0</span></span>; dx &lt; dstW; ++dx) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> ky = <span class="hljs-number"><span class="hljs-number">0</span></span>; ky &lt; kernelY; ky++) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> kx = <span class="hljs-number"><span class="hljs-number">0</span></span>; kx &lt; kernelX; kx++) { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> sy = dy * strideY + ky * dilationY - padY; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> sx = dx * strideX + kx * dilationX - padX; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> sc = <span class="hljs-number"><span class="hljs-number">0</span></span>; sc &lt; srcC; ++sc) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (sy &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; sy &lt; srcH &amp;&amp; sx &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; sx &lt; srcW) *buf++ = src[(sy * srcW + sx)*srcC + sc]; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> *buf++ = <span class="hljs-number"><span class="hljs-number">0</span></span>; } } } } } src += srcC / group; } }</code> </pre><br>  ุนูุงูุฉ ุนูู ุฐูู ุ ุชุชู ูุญุงุฐุงุฉ ุฌููุน ููุงุท ุญู ุงูุตูุฑุฉ ุงููุทููุจุฉ ูุนูููุฉ ุงูุงูุชูุงู ุนูู ุทูู ุตููู ุงููุตูููุฉ ุงููุงุชุฌุฉ (ููู ููุง ุฌุงุกุช ุชุณููุชูุง ุงุณู ุงูุนูุฑ <b>ุฅูู</b> <b>ุงูุตู</b> s).  ูุฌุจ ุนูููุง ุฃูุถูุง ุชุบููุฑ ุชูุณูู ุชุฎุฒูู ููุงุฒูู ุงูุงูุชูุงู ูู ุชูุณูู <b>DCYX</b> ุฅูู ุชูุณูู <b>YXCD</b> .  ุงูุขู ูููููุง ุชุทุจูู ูุตูููุฉ ุงูุถุฑุจ: <br><br><img src="https://habrastorage.org/webt/6p/k-/q-/6pk-q-wqfe060sq1y_vrstkw3ea.png" alt="ุตูุฑุฉ"><br><br>  ุนูู ุนูุณ ุชูุณูู <b>NCHW</b> ุ ูููู ุจุถุฑุจ ูุตูููุฉ ุงูุตูุฑุฉ ุจูุตูููุฉ ุงููุฒู ุ ูููุณ ุงูุนูุณ.  ุงูุชุงูู ูู ุฑูุฒ ุฏุงูุฉ ุงูุงูุชูุงุก: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">convolution</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> * src, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> batch, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> srcC, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> srcH, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> srcW, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> kernelY, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> kernelX, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> dilationY, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> dilationX, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> strideY, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> strideX, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> padY, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> padX, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> padH, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> padW, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> group, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> * weight, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> * bias, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> * dst, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> dstC, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> * buf)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> dstH = (srcH + padY + padH - (dilationY * (kernelY - <span class="hljs-number"><span class="hljs-number">1</span></span>) + <span class="hljs-number"><span class="hljs-number">1</span></span>)) / strideY + <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> dstW = (srcW + padX + padW - (dilationX * (kernelX - <span class="hljs-number"><span class="hljs-number">1</span></span>) + <span class="hljs-number"><span class="hljs-number">1</span></span>)) / strideX + <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> M = dstH * dstW; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> N = dstC / group; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> K = srcC * kernelY * kernelX / group; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> b = <span class="hljs-number"><span class="hljs-number">0</span></span>; b &lt; batch; ++b) { im2row(src, srcC, srcH, srcW, kernelY, kernelX, dilationY, dilationY, strideY, strideX, padY, padX, padH, padW, group, buf); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> g = <span class="hljs-number"><span class="hljs-number">0</span></span>; g &lt; group; ++g) gemm_nn(M, N, K, <span class="hljs-number"><span class="hljs-number">1</span></span>, buf + M * K * g, K * group, <span class="hljs-number"><span class="hljs-number">0</span></span>, weight + N * g, dstC, dst + N * g, dstC)); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; M; ++i) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> j = <span class="hljs-number"><span class="hljs-number">0</span></span>; j &lt; N; ++j) dst[i*N+ j] = relu(dst[i*N + j] + bias[i]); src += srcC*srcH*srcW; dst += dstC*dstH*dstW; } }</code> </pre><br><h2 style=";text-align:right;direction:rtl">  ูุฒุงูุง ูุนููุจ ุงูุทุฑููุฉ </h2><br>  ูู ุงูุจุฏุงูุฉ ุ ุฃูุฏ ุฃู ุฃุณุฑุฏ ูุฒุงูุง ูุฐุง ุงูููุฌ: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุฐู ุงูุทุฑููุฉ ูุฏููุง ุชูููุฐ ุจุณูุท ุฌุฏุง.  ูุง ูุดูุก ุฃูู ูุณุชุฎุฏู ูู ุฌููุน ุงูููุชุจุงุช ุงูุชู ุฃุนุฑููุง ุชูุฑูุจูุง. </li><li style=";text-align:right;direction:rtl">  ุชุนุฏ ูุนุงููุฉ ุงูุทุฑููุฉ ูู ุงูุนุฏูุฏ ูู ุงูุญุงูุงุช ุนุงููุฉ ุฌุฏูุง: ูู ูุญุฏุงุช ุงููุณุจุฉ ุงููุฆููุฉ ูู ุงูุฅุตุฏุงุฑ ุงูุฃุณุงุณู ุ ูุตู ุฅูู ุฃูุซุฑ ูู 80ูช ูู ุงูุญุฏ ุงูุฃูุตู ุงููุธุฑู. </li><li style=";text-align:right;direction:rtl">  ุงูููุฌ ุนุงููู - ูุฏููุง ุฑูุฒ ูุงุญุฏ ูุฌููุน ุงููุนููุงุช ุงูููููุฉ ููุทุจูุฉ ุงูุชูุงููููุฉ (ูููุงู ุงููุซูุฑ ูููุง!).  ูุฐูู ุ ุชุนูู ูุฐู ุงูุทุฑููุฉ ุบุงูุจูุง ูู ุงูุญุงูุงุช ุงูุชู ูููู ูููุง ูููููุฌ ุงูุฃูุซุฑ ูุนุงููุฉ (ูุจุงูุชุงูู ุฃูุซุฑ ุชุฎุตุตูุง) ูููุฏ. </li><li style=";text-align:right;direction:rtl">  ูุนูู ุงูููุฌ ูุน ุงูุฃุดูุงู ุงูุฑุฆูุณูุฉ <b>ูุชูุณูุฑุงุช</b> ุงูุตูุฑ - <b>NCHW</b> ู <b>NHWC</b> . </li></ul><br>  ุงูุขู ุนู ุงูุนููุจ: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุณูุก ุงูุญุธ ุ ูููู ุงูุถุฑุจ ุงูููุงุณู ูููุตูููุฉ ูุนุงููุง ุจุดุฑุท ุฃู ุชููู ููู ุงููุนููุงุช <b>M ู N ู K</b> ูุจูุฑุฉ ุจุฏุฑุฌุฉ ูุงููุฉ ุ ูุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ููู ุชูุฑูุจูุง ุจููุณ ุงูุชุฑุชูุจ ูู ุญูุซ ุงูุญุฌู (ุชุนุชูุฏ ุงูููุงุกุฉ ุนูู ุญูููุฉ ุฃู ุงูุนุฏุฏ ุงููุทููุจ ูู ุงูุญุณุงุจุงุช ูู <b>~ O (N ^ 3)</b> ุ ูุงูุฅูุชุงุฌูุฉ ุงููุทููุจุฉ ูุฏุฑุฉ ุงูุฐุงูุฑุฉ <b>~ O (N ^ 2)</b> ).  ูุฐูู ุ ุฅุฐุง ูุงูุช ุฃู ูู ุงููุนููุงุช <b>M ู N ู K</b> ุตุบูุฑุฉ ุ ูุฅู ููุงุกุฉ ุงูุทุฑููุฉ ุชูุฎูุถ ุจุดูู ุญุงุฏ. </li><li style=";text-align:right;direction:rtl">  ุชุชุทูุจ ุงูุทุฑููุฉ ุชุญููู ุจูุงูุงุช ุงูุฅุฏุฎุงู.  ููุฐุง ุฃุจุนุฏ ูุง ูููู ุนู ุงูุนูููุฉ ุงููุฌุงููุฉ.  ูุง ูููู ุฅููุงููุง ุฅูุง ุฅุฐุง ูุงูุช <b>K</b> ูุจูุฑุฉ ุจุฏุฑุฌุฉ ูุงููุฉ.  ูุฅุฐุง ุฃุฎุฐูุง ูู ุงูุงุนุชุจุงุฑ ุฃูู ุฏุงุฎู ุงูุถุฑุจ ุงูููุงุณู ูููุตูููุฉ ุ ูุง ูุฒุงู ููุงู ุชุญูู ุฏุงุฎูู ูุจูุงูุงุช ุงูุฅุฏุฎุงู ุ ูุตุจุญ ุงููููู ุฃูุซุฑ ุญุฒููุง. </li><li style=";text-align:right;direction:rtl">  ุงุณุชูุงุฏูุง ุฅูู ุญูููุฉ ุฃู <b>K = srcC * kernelY * kernelX / group</b> ุ ุชููู ููุงุกุฉ ุงูุทุฑููุฉ ููุฎูุถุฉ ุจุดูู ุฎุงุต ุจุงููุณุจุฉ ููุทุจูุงุช ุงูุชูุงููููุฉ ุงููุฏุฎูุฉ.  <b>ูููุงูุชูุงู ุจุดูู ุนููู ุ</b> ุชููุฏ ุทุฑููุฉ ุงููุตูููุฉ ุนููููุง ุงูุชูููุฐ ุงูุชุงูู. </li><li style=";text-align:right;direction:rtl">  ุชุชุทูุจ ูุฐู ุงูุทุฑููุฉ ูุนุงูุฌุฉ ุฅุถุงููุฉ ูุจูุงูุงุช ุงููุฎุฑุฌุงุช ูุนูููุฉ ุงูุชุญูู ูุญุณุงุจ ูุธููุฉ ุงูุชูุดูุท. </li><li style=";text-align:right;direction:rtl">  ููุงู ุทุฑู ุฑูุงุถูุฉ ุฃูุซุฑ ูุนุงููุฉ ูุญุณุงุจ ุงูุฅูุชูุงุก ุ ูุงูุชู ุชุชุทูุจ ุนูููุงุช ุฃูู. </li></ul><br><h2 style=";text-align:right;direction:rtl">  ุงููุชุงุฆุฌ </h2><br>  ุทุฑููุฉ ุญุณุงุจ ุงูุฅูุชูุงุก ุจูุงุกู ุนูู ุถุฑุจ ุงููุตูููุฉ ุณููุฉ ุงูุชูููุฐ ูุฐุงุช ููุงุกุฉ ุนุงููุฉ.  ูุณูุก ุงูุญุธ ุ ููุณุช ุนุงูููุฉ.  ุจุงููุณุจุฉ ูุนุฏุฏ ูู ุงูุญุงูุงุช ุงูุฎุงุตุฉ ุ ุชูุฌุฏ ุทุฑู ุฃุณุฑุน ุ ุฃูุตู ูุตููุง ุจุชุฃุฌูู ุงูููุงูุงุช ุงูุชุงููุฉ ูู ูุฐู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุณูุณูุฉ</a> .  ูู ุงูุชุธุงุฑ ุฑุฏูุฏ ุงููุนู ูุงูุชุนูููุงุช ูู ุงููุฑุงุก.  ุขูู ุฃู ุชููููุง ููุชููู! <br><br>  <b>ููุงุญุธุฉ:</b> ูุชู ุชูููุฐ ูุฐุง ุงูููุฌ ูุบูุฑู ูู ุงูุฃุณุงููุจ ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">ุฅุทุงุฑ</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">Convolution</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">Framework</a> ูุฌุฒุก ูู ููุชุจุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">Simd</a> . <br>  ูุฑุชูุฒ ูุฐุง ุงูุฅุทุงุฑ ุนูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">Synet</a> ุ ููู ุฅุทุงุฑ ูุชุดุบูู ุงูุดุจูุงุช ุงูุนุตุจูุฉ ุงููุฏุฑุจุฉ ูุณุจููุง ุนูู ูุญุฏุฉ ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉ. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar448436/">https://habr.com/ru/post/ar448436/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar448422/index.html">E-Dobavki ุนุจุงุฑุฉ ุนู ุฎุฏูุฉ ุจุญุซ ุนู ุงูุฅุถุงูุงุช ุงูุบุฐุงุฆูุฉ ูู Java ู Spring Boot ูุชุจูุง ุทูุงุจู</a></li>
<li><a href="../ar448424/index.html">ุจุนุฏ 55 ุนุงููุง: ููุญุงุช ุชุญูู IBM System / 360 ุงููุฑูุฒูุฉ</a></li>
<li><a href="../ar448430/index.html">ูุญุชูู ุงููุญุชุฑู 2019: ุซูุงุซุฉ ุชูุงุฑูุฑ ู ุชูุงุตูู ูููุฉ</a></li>
<li><a href="../ar448432/index.html">ุงูุฅุดุนุงุน ุงููุงุตู: ุงููุดุงุท ุงูุฅุดุนุงุนู ุงููุณุชุญุซ ุ ุงูุชููุซ ุงูุฅุดุนุงุนู ุ ุฅุฒุงูุฉ ุงูุชููุซ ...</a></li>
<li><a href="../ar448434/index.html">ุฃูุถู ุดุฑูุงุช ุชุทููุฑ ุชุทุจููุงุช ุงูุฌูุงู</a></li>
<li><a href="../ar448438/index.html">ุงูุญุฏ ูู ุณุฑุนุฉ ูุนุงูุฌุฉ ุงูุทูุจุงุช ุ ุฃู ููููุฉ ุนุฏู ุชุฑุชูุจ ูุฌูู DDoS ุนูู ุนูููู</a></li>
<li><a href="../ar448440/index.html">ูุฆุงุช ุงูุขูุงู ูู ุงููุฏููุนุงุช ุงูุชู ูุงู ุจูุง ุงูููุงุทููู ุฅูู STSI ู FSSP ูุงูุช ูู ุงููุฌุงู ุงูุนุงู</a></li>
<li><a href="../ar448442/index.html">SSD GIGABYTE Aorus RGB M.2: ุตุบูุฑ ุ ุจุนูุฏ ุญุชู ุจุงููุณุจุฉ ููุตุงุจูุญ RGB (ุฌุฒุก ูุงุญุฏ)</a></li>
<li><a href="../ar448444/index.html">ุงูุชุฎูุต ูู ุงูุฎูู ูู ุงูุชูุธูู ุงูุฃูู</a></li>
<li><a href="../ar448448/index.html">ุชูุฑูุฑ ุงูุณูููุช: ุงูุฎูุถ ุญุฌู ุงูุฃููุงู ุงูุชู ุณุฑููุง ุงููุชุณูููู ูู ุงูุจููู ุนุดุฑุฉ ุฃุถุนุงู ุจุนุฏ ุซูุงุซุฉ ุฃุดูุฑ ูู ุงูุงุฎุชุฑุงู ุจูุจูุบ 100 ููููู ุฏููุงุฑ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>