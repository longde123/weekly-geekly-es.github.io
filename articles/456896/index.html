<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üçå üòä üë®‚Äç‚öïÔ∏è Identificaci√≥n de direcciones IP reales de usuarios de la red Tor a trav√©s de un cach√© distorsionado üèæ üò∑ üò°</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Este art√≠culo describe un ejemplo de la aplicaci√≥n pr√°ctica del ataque de "distorsi√≥n de cach√© a trav√©s del redireccionamiento 301", que puede ser uti...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Identificaci√≥n de direcciones IP reales de usuarios de la red Tor a trav√©s de un cach√© distorsionado</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/vds/blog/456896/"><img src="https://habrastorage.org/getpro/habr/post_images/e0e/20c/130/e0e20c13066a38bd4c0c81d1d60de6db.jpg" alt="imagen"><br><br>  Este art√≠culo describe un ejemplo de la aplicaci√≥n pr√°ctica del ataque de "distorsi√≥n de cach√© a trav√©s del redireccionamiento 301", que puede ser utilizado por el nodo de salida de la red Tor con c√≥digo malicioso para identificar las direcciones IP reales de los usuarios seleccionados. <br><a name="habracut"></a><br><h4>  Escenario de ataque </h4><br>  El escenario de ataque es el siguiente: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://player.vimeo.com/video/337756409" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><ul><li>  Cliente: Chrome Canary (76.0.3796.0) </li><li>  IP del cliente real: 5.60.164.177 </li><li>  Par√°metro de seguimiento del cliente: 6b48c94a-cf58-452c-bc50-96bace981b27 </li><li>  Direcci√≥n IP del nodo de salida de la red Tor: 51.38.150.126 </li><li>  Proxy inverso transparente: tor.modlishka.io (Modlishka - se actualizar√° el c√≥digo actualizado). </li></ul><br>  Nota: En este escenario, el navegador Chrome se configur√≥ a trav√©s del protocolo de red SOCKS5 para usar la red Tor.  El canal Tor se ha sintonizado a un nodo de salida de prueba espec√≠fico: '51 .38.150.126 '.  Tambi√©n es una validaci√≥n del concepto y muchas configuraciones se pueden optimizar en el futuro ... <br><br>  En el caso de un nodo de salida malicioso de la red Tor, todo el tr√°fico se redirige a trav√©s del servidor proxy Modlishka: <br><br><pre><code class="bash hljs">iptables -A OUTPUT -p tcp -m tcp --dport 80 -j DNAT --to-destination ip_address:80 iptables -A FORWARD -j ACCEPT</code> </pre> <br><iframe width="560" height="315" src="https://www.youtube.com/embed/.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://player.vimeo.com/video/339586722" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><h4>  Descripci√≥n del escenario de ataque </h4><br>  Suposiciones <br><br><ul><li>  Una aplicaci√≥n de navegador (en este caso, un navegador est√°ndar) que utilizar√° la conexi√≥n de red "Tor" y, finalmente, la conexi√≥n pasar√° por un nodo de salida malicioso. </li><li>  El nodo de salida malicioso de la red Tor, que intercepta y distorsiona la memoria cach√© de todo el tr√°fico HTTP (c√≥digo de respuesta HTTP 301), que no tiene un protocolo criptogr√°fico de seguridad (TLS) de la capa de transporte. </li></ul><br><img src="https://habrastorage.org/webt/4b/kl/6d/4bkl6damygrn1rnfce9fxujbeny.png"><br><br>  Veamos los siguientes pasos de un escenario de ataque: <br><br><ol><li>  El usuario se conecta a Internet a trav√©s de la red Tor configurando el navegador para usar el protocolo de red SOCKS5 del sistema Tor, o configurando para que todo el tr√°fico del sistema operativo se redirija a trav√©s de la red Tor. </li><li>  El usuario comienza su sesi√≥n normal de acceso a Internet con su navegador favorito, donde generalmente se env√≠a mucho tr√°fico HTTP sin el protocolo de seguridad TLS a trav√©s del t√∫nel de la red Tor. </li><li>  El nodo de salida malicioso de la red Tor intercepta las solicitudes y responde reenviando cada una utilizando el c√≥digo de respuesta HTTP 301.  Estas redirecciones ser√°n almacenadas en cach√© constantemente por el navegador y se enviar√°n a la URL de seguimiento con el identificador de cliente Tor asignado.  La URL de seguimiento se puede crear de la siguiente manera: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">user-identifier.evil.tld</a> , donde 'evil.tld' recopilar√° toda la informaci√≥n sobre la direcci√≥n IP de origen y redirigir√° a los usuarios a los hosts solicitados originalmente ... o, alternativamente, al reverso transparente un servidor proxy que intentar√° interceptar todo el flujo posterior de tr√°fico de clientes HTTP.  Adem√°s, dado que es posible distorsionar autom√°ticamente el cach√© para la mayor√≠a de los dominios m√°s populares (como se describe en un art√≠culo anterior), p.  100 principales sitios de acuerdo con las estad√≠sticas de la empresa ¬´Alexa¬ª, el atacante maximiza sus posibilidades de identificar direcciones IP reales. </li><li>  Despu√©s de salir de la sesi√≥n de la red Tor, el usuario cambiar√° a su red normal. </li><li>  Tan pronto como el usuario ingresa la direcci√≥n de uno de los dominios distorsionados anteriores en la barra de direcciones (por ejemplo, "google.com"), el navegador utiliza el cach√© para la redirecci√≥n interna a la URL de seguimiento con el identificador de contexto del nodo de salida. </li><li>  El host de salida podr√° hacer coincidir la solicitud HTTP previamente interceptada con la direcci√≥n IP real del usuario utilizando la informaci√≥n recibida de un host externo que utiliz√≥ la URL de seguimiento con la ID de usuario.  El host evil.tld tendr√° informaci√≥n sobre todas las direcciones IP que se utilizaron para acceder a la URL de seguimiento. </li></ol><br>  Obviamente, este m√©todo le permite hacer coincidir eficientemente las solicitudes HTTP seleccionadas con las direcciones IP del cliente utilizando el nodo de salida de la red Tor.  Esto sucede porque la URL de seguimiento generada previamente ser√° solicitada por el cliente a trav√©s del t√∫nel de red "Tor" y, nuevamente, tan pronto como se realice la conexi√≥n a trav√©s de la conexi√≥n est√°ndar del proveedor de Internet.  Todo se debe al c√≥digo confuso en el cach√©. <br><br>  Otro enfoque puede basarse en la introducci√≥n de c√≥digo JavaScript modificado con URL incrustadas para rastrear las respuestas correspondientes que no tienen el protocolo de seguridad TLS, y cambiar los encabezados de cach√© de control necesarios (por ejemplo, 'Control de cach√©: max-age = 31536000') .  Sin embargo, este enfoque no es muy efectivo. <br><br>  Tambi√©n es posible rastrear a los usuarios a trav√©s de las cookies est√°ndar de varias aplicaciones web, pero es muy dif√≠cil obligar al cliente a visitar el dominio que est√° bajo el control del atacante dos veces: primero, cuando se conecta a trav√©s del nodo de salida de la red Tor, y luego nuevamente despu√©s de cambiar a la conexi√≥n a Internet est√°ndar proveedor <br><br><h4>  Conclusiones </h4><br>  El hecho es que un atacante tiene la capacidad de lograr ciertos cambios en la memoria cach√© del navegador al inyectar c√≥digo mal formado a trav√©s de nodos de salida maliciosos y detectar las direcciones IP reales de los usuarios de Tor que env√≠an tr√°fico HTTP sin el protocolo de seguridad TLS. <br><br>  Adem√°s, la distorsi√≥n de un n√∫mero significativo de nombres de dominio populares aumentar√° la probabilidad de recibir una respuesta inversa de una solicitud HTTP (con un ID de usuario asignado), lo que determinar√° la direcci√≥n IP real del usuario.  Puede intentar interceptar el dominio de algunos clientes del navegador y esperar que el usuario no note un error tipogr√°fico en el nombre de dominio o no se muestre (por ejemplo, la aplicaci√≥n m√≥vil WebViews). <br><br>  Formas de reducir el riesgo: <br><br><ul><li>  Al conectarse a Internet a trav√©s de la red Tor, aseg√∫rese de que todo el tr√°fico que no utiliza el protocolo de seguridad TLS est√© desactivado.  Un ejemplo de complementos del navegador que se pueden utilizar: para los navegadores Firefox "y" Chrome ". </li><li>  Adem√°s, utilice siempre el modo de navegador "privado" cuando se conecte a Internet a trav√©s de la red Tor. </li><li>  No redirija el tr√°fico a todo su sistema operativo a trav√©s de la red Tor hasta que est√© seguro de que todo el tr√°fico saliente usa el protocolo de seguridad TLS ... </li><li>  Siempre que sea posible, use la √∫ltima versi√≥n del navegador Tor para navegar por la web. </li></ul><br><hr><br>  Las √∫ltimas configuraciones de doble procesador de servidores dedicados con procesadores escalables Intel 2019 est√°n disponibles en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><b>DEDIC.SH</b></a> : <br><br><ul><li>  2x Xeon Silver 4214: un total de 24 n√∫cleos </li><li>  2x Xeon Gold 5218 - un total de 32 n√∫cleos </li><li>  2x Xeon Gold 6240 - configuraci√≥n con 36 n√∫cleos. </li></ul><br>  El costo de un servidor con dos Xeon Silver 4214 - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><b>desde 15210 rublos / mes</b></a> <br>  Tambi√©n estamos listos para recopilar <b>cualquier configuraci√≥n</b> para usted, ¬° <b><a href="">escr√≠banos</a></b> ! <br><br>  Si no se requieren grandes potencias de un servidor dedicado, ¬° <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">VDS desde 150 rublos / mes</a></b> es lo que necesita! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/456896/">https://habr.com/ru/post/456896/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../456886/index.html">Lista de verificaci√≥n de ASO: c√≥mo no perderse nada</a></li>
<li><a href="../456888/index.html">C√≥mo se derriten los sat√©lites en la atm√≥sfera terrestre</a></li>
<li><a href="../456890/index.html">Control remoto IR en stm32</a></li>
<li><a href="../456892/index.html">C√≥mo buscar vulnerabilidades de aplicaciones web: comparando ocho esc√°neres populares</a></li>
<li><a href="../456894/index.html">Docker y autenticaci√≥n a trav√©s de Nginx</a></li>
<li><a href="../456898/index.html">Multiplicaci√≥n entera r√°pida usando tablas</a></li>
<li><a href="../456902/index.html">Notificaciones push seguras: de la teor√≠a a la pr√°ctica</a></li>
<li><a href="../456904/index.html">Prueba de carga de un proyecto web: sin efectivo</a></li>
<li><a href="../456908/index.html">C√≥mo Telegram te fusiona con Rostelecom</a></li>
<li><a href="../456910/index.html">Internet project security.txt - conociendo otro archivo .well conocido</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>