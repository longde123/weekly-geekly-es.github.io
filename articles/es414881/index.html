<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üóìÔ∏è üí• üïñ Un poco de backstage VK ‚¨ÜÔ∏è üë©üèº‚Äç‚öïÔ∏è üòé</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="En v√≠speras del Siberian HighLoad ++, hablamos con uno de nuestros oradores, Yuri Nasretdinov, pregunt√°ndole si trabaj√≥ bien en VKontakte, al mismo ti...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Un poco de backstage VK</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/oleg-bunin/blog/414881/"> En v√≠speras del <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Siberian HighLoad ++,</a> hablamos con uno de nuestros oradores, Yuri Nasretdinov, pregunt√°ndole si trabaj√≥ bien en VKontakte, al mismo tiempo que abrimos el velo del secreto sobre la cocina interna de la red social. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/dd8/bf5/262/dd8bf526210478b0312431ee75a96903.jpg"><br><br>  En el marco de la conferencia, Yuri hablar√° sobre c√≥mo una red social inserta datos en ClickHouse desde decenas de miles de servidores, que acabamos de mencionar en la conversaci√≥n actual. <br><a name="habracut"></a><br>  <b>- Cu√©ntanos sobre tu trabajo.</b> <br><br>  Actualmente trabajo en VK.  Es cierto, no tanto tiempo, desde principios de este a√±o.  Estoy comprometido con la infraestructura de video y la infraestructura del sitio.  El sitio est√° escrito principalmente en PHP, y desarrollo servicios y utilidades en PHP y Go. <br><br>  <b>- ¬øQu√© te llev√≥ a trabajar en VK?</b> <br><br>  Fui invitado a trabajar en VK.  Y pens√©, ¬øpor qu√© no?  VKontakte es el sitio con mayor carga en Rusia y uno de los sitios m√°s grandes en Internet.  Siempre me interes√≥ trabajar en un proyecto tan grande, participar en el desarrollo del sitio y la aplicaci√≥n m√≥vil.  Quiz√°s incluso afecte su desarrollo, de alguna manera mejore.  Este es probablemente el factor m√°s motivador: VKontakte que todos conocen y usan.  Y es muy agradable trabajar en un producto de este tipo, para ayudarlo a mejorar. <br><br>  <b>- Antes de eso, ¬øtuviste que lidiar con algo similar en escala?</b> <br><br>  S√≠, durante unos cinco a√±os trabaj√© en Badoo en un puesto similar: en desarrollo de infraestructura.  Pero la carga en VK es un orden de magnitud mayor. <br><br>  <b>- ¬øTuviste alg√∫n problema al cambiar a VK?</b> <br><br>  La oficina de VKontakte se encuentra en San Petersburgo.  Y antes de eso viv√≠a en los suburbios, as√≠ que tuve que mudarme.  La mudanza en s√≠ fue bastante f√°cil: la compa√±√≠a ayuda.  Pero en San Petersburgo hace mucho fr√≠o en invierno.  Esta fue probablemente la cosa m√°s dif√≠cil de enfrentar. <br><br>  <b>- ¬øNo hay sensaci√≥n de que la vida haya quedado en alg√∫n lugar dentro de la carretera de circunvalaci√≥n de Mosc√∫?</b> <br><br>  Al principio, realmente me pareci√≥ as√≠, a pesar del hecho de que anteriormente hab√≠a estado en otras ciudades de Rusia, adem√°s de Mosc√∫.  Pero, de hecho, me gusta San Petersburgo, probablemente incluso m√°s que Mosc√∫.  Est√° m√°s tranquilo: menos personas, no tienen prisa, y esto es agradable. <br><br>  <b>- Y desde el punto de vista de las tecnolog√≠as utilizadas en el trabajo, ¬øqu√© fue fundamentalmente nuevo para usted?</b> <br><br>  VKontakte es muy grande, respectivamente, realmente hay algunos matices aqu√≠ que no he encontrado antes.  Por ejemplo, en Badoo pr√°cticamente no hay perfiles muy populares que visiten un porcentaje significativo de personas.  VKontakte lo tiene, ya que hay una serie de herramientas interesantes que le permiten escalar r√°pidamente cuentas muy populares. <br><br>  Adem√°s, VKontakte es diferente en que, por razones hist√≥ricas, casi todo est√° aqu√≠.  A diferencia de, por ejemplo, Badoo, que usa principalmente MySQL y Memcache (m√°s sus servicios), VKontakte usa sus propias bases de datos e incluso su propia versi√≥n de Memcache.  Los desarrolladores de VK podr√≠an permitirse crear servicios m√°s eficientes (en el contexto del mismo MySQL) que funcionen bien en una escala tan grande.  La mayor√≠a de las herramientas terminadas sin un archivo no se pueden usar en una infraestructura que incluye decenas de miles de servidores, como VK, y esto crea dificultades significativas. <br><br>  <b>- ¬øFue dif√≠cil penetrar r√°pidamente en herramientas "internas"?</b> <br><br>  Trabajo en el departamento de infraestructura, y no hay muchas cosas no est√°ndar aqu√≠.  B√°sicamente, esta es una pila a√∫n m√°s est√°ndar que la que trabaj√© antes.  Pero si trabajara, por ejemplo, en un departamento que se ocupa de las funciones de back-end, entonces, por supuesto, habr√≠a un conocimiento √∫til de c√≥mo se construye b√°sicamente el sistema Highload, pero no detalles espec√≠ficos.  En tales situaciones, las p√°ginas para nuevos empleados, las descripciones de los mecanismos internos ayudan. <br><br>  En principio, Pavel Durov public√≥ una parte tangible de la infraestructura VK en c√≥digo abierto junto con la documentaci√≥n.  Cualquiera puede leerlo, leer c√≥mo funciona todo.  Pero, por supuesto, es mucho m√°s f√°cil percibir esto en el contexto de c√≥mo se usa internamente.  Vienes y comienzas a hacer tareas, estudiando gradualmente lo que se necesita para resolverlas.  Vea c√≥mo ya est√° hecho y haga lo mismo.  Y eso es suficiente.  Despu√©s de todo, incluso si dominas la lectura de toda la documentaci√≥n sobre la infraestructura de VK, hasta que comiences a usarla, lo m√°s probable es que no entiendas c√≥mo funciona todo en detalle. <br><br>  Observo que todo lo anterior se aplica a mi departamento (en otros puede ser diferente). <br><br>  <b>- ¬øTienes alguna especializaci√≥n dentro de VK?</b>  <b>¬øEn qu√© tareas lograste participar?</b> <br><br>  No hay especializaci√≥n como tal.  Hago lo que se requiere actualmente. <br>  Trabajo en un departamento cuyas actividades afectan a diferentes partes de la infraestructura de la red social, y este es un gran proyecto (lleva mucho tiempo comprender completamente el dispositivo VK). <br><br>  Por ejemplo, particip√© en una actualizaci√≥n parcial a PHP7.  Esto, en principio, se aplica a todo el sitio, pero al mismo tiempo no se aplica a ning√∫n detalle espec√≠fico. <br><br>  Otro ejemplo es el problema con la recopilaci√≥n de registros, para cuya soluci√≥n usamos ClickHouse.  Hablar√© de esto en HighLoad ++. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/02b/ab0/b88/02bab0b88c3afe4212bb71fdfbc17ed8.jpg"><br><br>  <b>- Veamos un peque√±o spoiler: ¬øcu√°l fue la caracter√≠stica de este problema?</b> <br><br>  La captura fue una combinaci√≥n de dos factores: por un lado, tenemos muchos registros escritos y, por otro, necesitamos revisarlos r√°pidamente. <br><br>  El sistema existente, de hecho, no pod√≠a almacenar grandes cantidades de datos, dando r√°pidamente solo la informaci√≥n m√°s reciente.  Para obtener la historia, ten√≠a que realizar manualmente consultas muy pesadas. <br><br>  <b>- Los lectores pueden estar interesados ‚Äã‚Äãen por qu√© se utiliz√≥ la columna ClickHouse para la soluci√≥n.</b> <br><br>  Columna: debido a los detalles del trabajo.  A menudo, cuando buscamos informaci√≥n en los registros, necesitamos filtrar por servidor o usuario.  Cuando se trata de leer desde el disco, una base de datos de columnas le permite acelerar la lectura muchas veces (en el contexto de la l√≠nea), lo que se logra leyendo solo las columnas necesarias y una compresi√≥n m√°s eficiente en bits.  Adem√°s, ClickHouse paraleliza bien las consultas a trav√©s de los n√∫cleos.  Es decir  A diferencia de las bases de datos cl√°sicas, puede realizar una sola consulta incluso en un cl√∫ster completo, utilizando casi todos los recursos del procesador y del disco.  Tales bases de datos, especialmente las gratuitas, no son muy numerosas, si las hay.  ClickHouse surgi√≥ muy bien para la tarea de almacenar registros. <br><br>  Tambi√©n noto que antes de mi llegada, ClickHouse fue utilizado por los administradores de VK en una tarea bastante especializada, como una herramienta de back-end para Grafana.  Este es un sistema de recopilaci√≥n de datos y gr√°ficos para servidores.  Es cierto que solo se implementaron unos pocos servidores con ClickHouse, es decir, de hecho, no estaba disponible para los programadores. <br><br>  Despu√©s de tomar la decisi√≥n de usar ClickHouse para almacenar registros, ayud√© a crear la infraestructura adecuada para que fuera conveniente y comprensible para todos. <br><br>  <b>- ¬øVK utiliza soluciones de terceros en una cantidad significativa (adem√°s de las mencionadas anteriormente)?</b> <br><br>  Por supuesto usado.  Por ejemplo, Linux, en el que gira todo esto.  No subestimes la parte del trabajo que el sistema operativo hace por nosotros. <br><br>  Curiosamente, se usa PHP.  Tenemos un motor patentado llamado KittenPHP, que traduce PHP a C ++, pero para una serie de tareas, incluida la producci√≥n, tambi√©n se usa PHP normal. <br><br>  Usado por nginx.  Hasta ahora, MySQL est√° involucrado en algunos lugares, pero poco a poco lo rechazamos: utilizamos una base de datos autoescrita. <br><br>  <b>- ¬øY c√≥mo se construye el proceso de desarrollo?</b> <br><br>  No veo grandes diferencias entre los procesos en VK y lo que se acepta en la industria.  Tenemos un rastreador de errores, departamentos que se ocupan de diferentes funciones, responsables de su parte del proyecto;  hay sprints responsables de componentes, etc. <br><br>  <b>- En lugar de los resultados, ¬øes posible indicar la direcci√≥n en la que se est√° desarrollando el departamento en el que trabaja?</b> <br><br>  Hasta donde s√©, antes el departamento en el que ahora trabajo consist√≠a en 1-2 personas. <br>  Y comenzamos a involucrarnos en la infraestructura en la forma en que se est√° haciendo ahora (probablemente, parece DevOps) no hace mucho tiempo.  Por lo tanto, es demasiado pronto para hablar de planes: estamos resolviendo problemas existentes y hasta ahora tenemos suficiente trabajo.  Y luego ya veremos. <br><br><hr><br>  Yuri le contar√° m√°s sobre las partes internas de VK, utilizando ClickHouse y otros detalles en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">su charla</a> en Siberian HighLoad ++ del 25 al 26 de junio.  Tambi√©n le interesar√°n estos informes: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Replicaci√≥n de datos en tiempo real de MySQL a ClickHouse para una migraci√≥n sin problemas de an√°lisis de MySQL a ClickHouse</a> (Vladislav Klimenko, Valery Panov) </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Aprendiendo a clasificar un poco</a> (Andrey Aksenov) </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">La evoluci√≥n de las herramientas y servicios en Badoo: nuestros criterios de selecci√≥n y sus resultados</a> (Anton Turetsky) </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es414881/">https://habr.com/ru/post/es414881/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es414871/index.html">La tormenta de polvo en Marte alcanz√≥ la escala planetaria, incluso la curiosidad se vio afectada</a></li>
<li><a href="../es414873/index.html">IDisposable: que su madre no habl√≥ sobre la liberaci√≥n de recursos. Parte 1</a></li>
<li><a href="../es414875/index.html">La integraci√≥n de contenedores Kubernetes reemplaza a Docker listo para la producci√≥n</a></li>
<li><a href="../es414877/index.html">Una lente inusual para una c√°mara normal o c√≥mo dejar de pensar en el enfoque.</a></li>
<li><a href="../es414879/index.html">¬øPor qu√© 2 extrusoras en una impresora 3D?</a></li>
<li><a href="../es414883/index.html">Los recuerdos sonaron de una nueva manera: la BBC actualiz√≥ el archivo de sonido del proyecto RemArc</a></li>
<li><a href="../es414885/index.html">Nos ocupamos de errores y "muletas" en el Registro Estatal Unificado de Entidades Legales - el registro estatal de entidades legales</a></li>
<li><a href="../es414887/index.html">Creando un gancho de gato en Unity. Parte 1</a></li>
<li><a href="../es414889/index.html">Cuando las agencias digitales necesitan IaaS</a></li>
<li><a href="../es414891/index.html">H√°bitos del desarrollador</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>