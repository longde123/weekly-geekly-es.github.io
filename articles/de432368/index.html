<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üé≥ üèí üÜô Vor Ihnen - Reagieren Sie auf eine moderne Web-App ü§π üëçüèª üö´</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bevor Sie mit dem Erstellen einer modernen Webanwendung von Grund auf beginnen , m√ºssen Sie herausfinden, was eine moderne Webanwendung ist. 


 Moder...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Vor Ihnen - Reagieren Sie auf eine moderne Web-App</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/432368/"><p>  Bevor Sie mit dem Erstellen einer <strong>modernen Webanwendung</strong> von Grund auf beginnen <strong>, m√ºssen</strong> Sie herausfinden, was eine moderne Webanwendung ist. </p><br><p> Modern Web App (MWA) ist eine Anwendung, die allen modernen Webstandards entspricht.  Darunter die Progressive Web App - die M√∂glichkeit, eine mobile Browserversion auf Ihr Telefon herunterzuladen und als vollwertige Anwendung zu verwenden.  Es ist auch eine M√∂glichkeit, die Site sowohl von einem mobilen Ger√§t als auch von einem Computer aus offline zu scrollen.  modernes Materialdesign;  perfekte Suchmaschinenoptimierung;  und nat√ºrlich - hohe Download-Geschwindigkeit. </p><br><p><img src="https://habrastorage.org/webt/cp/p4/sr/cpp4srk-it2nhotgkfg5q6kczqi.png"></p><br><p>  Folgendes wird in unserer MWA passieren (ich rate Ihnen, diesen Navigationsartikel zu verwenden): </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Universelle Web-App</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Material-ui</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Code-Aufteilung</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Redux Beispiel</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Mobile Version</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Progressive Web App</a> </li><li>  Babel 7, Webpack und mehr </li></ul><br><p>  Die Leute auf Habr√© sind gesch√§ftlich, also holen Sie sich sofort einen Link zum <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">GitHub-Repository</a> , ein <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Archiv</a> aus jeder Entwicklungsphase und eine <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Demo</a> .  Dieser Artikel richtet sich an Entwickler, die mit node.js vertraut sind und reagieren.  Alle notwendigen Theorien werden im notwendigen Band vorgestellt.  Erweitern Sie Ihren Horizont, indem Sie auf die Links klicken. </p><br><p>  Fangen wir an! </p><a name="habracut"></a><br><a name="ssr"></a><br><h3 id="1-universal">  1. Universal </h3><br><p> Standardaktionen: Erstellen Sie ein Arbeitsverzeichnis und f√ºhren Sie <code>git init</code> .  √ñffnen Sie <em>package.json</em> und f√ºgen Sie einige Zeilen hinzu: </p><br><pre> <code class="json hljs"><span class="hljs-string"><span class="hljs-string">"dependencies"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"@babel/cli"</span></span>: <span class="hljs-string"><span class="hljs-string">"^7.1.5"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"@babel/core"</span></span>: <span class="hljs-string"><span class="hljs-string">"^7.1.6"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"@babel/preset-env"</span></span>: <span class="hljs-string"><span class="hljs-string">"^7.1.6"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"@babel/preset-react"</span></span>: <span class="hljs-string"><span class="hljs-string">"^7.0.0"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"@babel/register"</span></span>: <span class="hljs-string"><span class="hljs-string">"^7.0.0"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"babel-loader"</span></span>: <span class="hljs-string"><span class="hljs-string">"^8.0.4"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"babel-plugin-root-import"</span></span>: <span class="hljs-string"><span class="hljs-string">"^6.1.0"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"express"</span></span>: <span class="hljs-string"><span class="hljs-string">"^4.16.4"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"react"</span></span>: <span class="hljs-string"><span class="hljs-string">"^16.6.3"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"react-dom"</span></span>: <span class="hljs-string"><span class="hljs-string">"^16.6.3"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"react-helmet"</span></span>: <span class="hljs-string"><span class="hljs-string">"^5.2.0"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"react-router"</span></span>: <span class="hljs-string"><span class="hljs-string">"^4.3.1"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"react-router-dom"</span></span>: <span class="hljs-string"><span class="hljs-string">"^4.3.1"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"webpack"</span></span>: <span class="hljs-string"><span class="hljs-string">"^4.26.1"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"webpack-cli"</span></span>: <span class="hljs-string"><span class="hljs-string">"^3.1.2"</span></span> }</code> </pre> <br><p>  Wir f√ºhren <code>npm install</code> und verstehen es, w√§hrend es installiert ist. </p><br><p>  Da wir uns um die Wende von 2018 und 2019 befinden, wird unsere Webanwendung <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">universell (oder isomorph) sein</a> . Sowohl auf der R√ºckseite als auch auf der Vorderseite wird es eine <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ECMAScript-</a> Version geben, die nicht niedriger als ES2017 ist.  Zu diesem <em>Zweck</em> verbindet <em>index.js</em> (die Anwendungseingabedatei) babel / register, und <strong>babel</strong> on-the-fly <em>wandelt</em> den gesamten darauf folgenden ES-Code mithilfe von babel / preset-env und babel / preset-react in browserfreundliches JavaScript um.  Zur Vereinfachung der Entwicklung verwende ich normalerweise das Babel-Plugin-Root-Import-Plugin, mit dem alle Importe aus dem Root-Verzeichnis wie '~ /' und von src / - '&amp; /' aussehen.  Alternativ k√∂nnen Sie lange Pfade schreiben oder einen Alias ‚Äã‚Äãaus dem Webpack verwenden. </p><br><p>  <em>index.js</em> </p><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">"@babel/register"</span></span>)(); <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">"./app"</span></span>);</code> </pre> <br><p>  <em>.babelrc</em> </p><br><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"presets"</span></span>: [ [ <span class="hljs-string"><span class="hljs-string">"@babel/preset-env"</span></span>, { <span class="hljs-attr"><span class="hljs-attr">"targets"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"node"</span></span>: <span class="hljs-string"><span class="hljs-string">"current"</span></span> } } ], <span class="hljs-string"><span class="hljs-string">"@babel/preset-react"</span></span> ], <span class="hljs-attr"><span class="hljs-attr">"plugins"</span></span>: [ [<span class="hljs-string"><span class="hljs-string">"babel-plugin-root-import"</span></span>, { <span class="hljs-attr"><span class="hljs-attr">"paths"</span></span>: [{ <span class="hljs-attr"><span class="hljs-attr">"rootPathPrefix"</span></span>: <span class="hljs-string"><span class="hljs-string">"~"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"rootPathSuffix"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"rootPathPrefix"</span></span>: <span class="hljs-string"><span class="hljs-string">"&amp;"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"rootPathSuffix"</span></span>: <span class="hljs-string"><span class="hljs-string">"src/"</span></span> }] }] ] }</code> </pre> <br><p>  Zeit, <strong>Webpack einzurichten</strong> .  Wir erstellen <em>webpack.config.js</em> und verwenden den Code (im Folgenden beachten Sie die Kommentare im Code). </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> path = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'path'</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">module</span></span>.exports = { <span class="hljs-comment"><span class="hljs-comment">// ,      Universal web app entry: { client: './src/client.js' }, // ,      webpack' output: { path: path.resolve(__dirname, 'public'), publicPath: '/' }, module: { //  babel-loader     ECMAScript    // JavaScript.       /public rules: [ { test: /\.js$/, exclude: /node_modules/, loader: "babel-loader" } ] } }</span></span></code> </pre> <br><p>  Ab diesem Moment beginnt der Spa√ü.  Es ist Zeit, die Serverseite der Anwendung zu entwickeln.  <strong>Server-Side Rendering</strong> (SSR) ist eine Technologie, die entwickelt wurde, um das Laden von Webanwendungen zeitweise zu beschleunigen und die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ewige Debatte</a> √ºber die Suchmaschinenoptimierung in Single Page Application (SEO in SPA) zu l√∂sen.  Dazu nehmen wir die HTML-Vorlage, f√ºgen den Inhalt ein und senden ihn an den Benutzer.  Der Server erledigt dies sehr schnell - die Seite wird in wenigen Millisekunden gezeichnet.  Es gibt jedoch keine M√∂glichkeit, das DOM auf dem Server zu bearbeiten, sodass der Client-Teil der Anwendung die Seite aktualisiert und sie schlie√ülich interaktiv wird.  Okay?  Wir entwickeln uns! </p><br><p>  <em>app.js.</em> </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> express <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'express'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> path <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'path'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> stateRoutes <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./server/stateRoutes'</span></span> <span class="hljs-comment"><span class="hljs-comment">//   Express     Node.js const app = express() //    app.use(express.static('public')) app.use('/assets', express.static(path.resolve(__dirname, 'assets'))) //    3000 ,      const PORT = process.env.PORT || 3000 app.listen(PORT, '0.0.0.0', () =&gt; { console.log(`The app is running in PORT ${PORT}`) }) //   -  GET-   state  -  //    ,     . stateRoutes(app)</span></span></code> </pre> <br><p>  <em>server / stateRoutes.js</em> </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ssr <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./server'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">app</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//        // ssr - ,   HTML app.get('*', (req, res) =&gt; { const response = ssr(req.url) res.send(response) }) }</span></span></code> </pre> <br><p>  Die <em>Datei server / server.js</em> sammelt den durch react generierten Inhalt und √ºbergibt ihn an die HTML-Vorlage - <em>/server/template.js</em> .  Es sollte klargestellt werden, dass der Server einen statischen Router verwendet, da wir die URL der Seite beim Laden nicht √§ndern m√∂chten.  Und <strong>React-Helm</strong> ist eine Bibliothek, die die Arbeit mit Metadaten (und tats√§chlich mit dem Head-Tag) erheblich vereinfacht. </p><br><p>  <em>server / server.js</em> </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { renderToString } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-dom/server'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { StaticRouter } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-router-dom'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { Helmet } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-helmet'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> App <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'&amp;/app/App'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> template <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./template'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">render</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">url</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//      const reactRouterContext = {} //     HTML let content = renderToString( &lt;StaticRouter location={url} context={reactRouterContext}&gt; &lt;App/&gt; &lt;/StaticRouter&gt; ) //  &lt;head&gt;  HTML- const helmet = Helmet.renderStatic() //   HTML-     return template(helmet, content) }</span></span></code> </pre> <br><p>  In <em>server / template.js</em> drucken wir im Kopf die Daten vom Helm, verbinden das Favicon und die Stile aus dem statischen Verzeichnis / Assets.  Im Body-Content- und Webpack-Bundle <em>client.js</em> , das sich im Ordner / public befindet, aber da es statisch ist, gehen wir zur Adresse des Stammverzeichnisses - /client.js. </p><br><p>  <em>server / template.js</em> </p><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// HTML- export default function template(helmet, content = '') { const scripts = `&lt;script src="/client.js"&gt;&lt;/script&gt;` const page = `&lt;!DOCTYPE html&gt; &lt;html lang="en"&gt; &lt;head&gt; ${helmet.title.toString()} ${helmet.meta.toString()} ${helmet.link.toString()} &lt;meta charset="utf-8"&gt; &lt;meta name="viewport" content="width=device-width, initial-scale=1"&gt; &lt;meta name="theme-color" content="#810051"&gt; &lt;link rel="shortcut icon" href="/assets/logos/favicon.ico" type="image/x-icon"&gt; &lt;link rel="icon" href="/assets/logos/favicon.ico" type="image/x-icon"&gt; &lt;link rel="stylesheet" href="/assets/global.css"&gt; &lt;/head&gt; &lt;body&gt; &lt;div class="content"&gt; &lt;div id="app" class="wrap-inner"&gt; &lt;!--- magic happens here --&gt; ${content} &lt;/div&gt; &lt;/div&gt; ${scripts} &lt;/body&gt; ` return page }</span></span></code> </pre> <br><p>  Wir wenden uns dem Einfachen zu - der Kundenseite.  Die <em>Datei src / client.js</em> stellt den vom Server generierten HTML- <em>Code</em> ohne Aktualisierung des DOM wieder her und macht ihn interaktiv.  (Mehr dazu <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> ).  Die <strong>Hydratreaktionsfunktion</strong> √ºbernimmt dies.  Und jetzt haben wir nichts mehr mit einem statischen Router zu tun.  Wir verwenden den √ºblichen BrowserRouter. </p><br><p>  <em>src / client.js</em> </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { hydrate } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-dom'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { BrowserRouter } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-router-dom'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> App <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./app/App'</span></span> hydrate( <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">BrowserRouter</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">App</span></span></span></span><span class="xml"><span class="hljs-tag">/&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">BrowserRouter</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span>, <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.querySelector(<span class="hljs-string"><span class="hljs-string">'#app'</span></span>) )</code> </pre> <br><p>  Bereits in zwei Dateien konnte die Reaktionskomponente der App aufleuchten.  Dies ist die Hauptkomponente der Desktopanwendung, die das Routing ausf√ºhrt.  Sein Code ist sehr allt√§glich: </p><br><p>  <em>src / app / App.js.</em> </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { Switch, Route } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-router'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Home <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./Home'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">App</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>( <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Switch</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Route</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">exact</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">path</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"/"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">component</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{Home}/</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Switch</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> ) }</span></span></code> </pre> <br><p>  Nun, <em>src / app / Home.js.</em>  Beachten Sie, wie der Helm funktioniert - der √ºbliche Head Tag Wrapper. </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { Helmet } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-helmet'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Home</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>( <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Helmet</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">title</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">Universal Page</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">title</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">meta</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"description"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">content</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"Modern Web App - Home Page"</span></span></span></span><span class="xml"><span class="hljs-tag"> /&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Helmet</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> Welcome to the page of Universal Web App </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> ) }</span></span></code> </pre> <br><p>  Gl√ºckwunsch!  Wir haben den ersten Teil der Entwicklung von MWA auseinander genommen!  Es blieben nur ein paar Ber√ºhrungen, um das Ganze zu testen.  Idealerweise k√∂nnen Sie den Ordner <em>/ assets</em> mit Dateien im globalen Stil und einem Favicon gem√§√ü der Vorlage - server / template.js - f√ºllen.  Wir haben auch keine Befehle zum Starten von Anwendungen.  Zur√ºck zu <em>package.json</em> : </p><br><pre> <code class="json hljs"><span class="hljs-string"><span class="hljs-string">"scripts"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"start"</span></span>: <span class="hljs-string"><span class="hljs-string">"npm run pack &amp;&amp; npm run startProd"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"startProd"</span></span>: <span class="hljs-string"><span class="hljs-string">"NODE_ENV=production node index.js"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"pack"</span></span>: <span class="hljs-string"><span class="hljs-string">"webpack --mode production --config webpack.config.js"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"startDev"</span></span>: <span class="hljs-string"><span class="hljs-string">"npm run packDev &amp;&amp; node index.js"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"packDev"</span></span>: <span class="hljs-string"><span class="hljs-string">"webpack --mode development --config webpack.config.js"</span></span> }</code> </pre> <br><p>  M√∂glicherweise stellen Sie zwei Kategorien von Befehlen fest - Prod und Dev.  Sie unterscheiden sich in der Webpack v4-Konfiguration.  √úber <code>--mode</code> lohnt es sich <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> zu lesen. <br>  Probieren Sie unbedingt die resultierende universelle Anwendung bei <strong>localhost: 3000 aus</strong> </p><br><a name="material"></a><br><h3 id="2-material-ui">  2. Material-UI </h3><br><p>  Dieser Teil des Tutorials konzentriert sich auf die Verbindung mit der Webanwendung mit dem SSR der Material-UI-Bibliothek.  Warum genau sie?  Alles ist einfach - die Bibliothek entwickelt sich aktiv, wird gepflegt und verf√ºgt √ºber eine umfangreiche Dokumentation.  Mit ihm k√∂nnen Sie eine sch√∂ne Benutzeroberfl√§che erstellen, nur um zu spucken. </p><br><p>  Das f√ºr unsere Anwendung geeignete Verbindungsschema selbst wird <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> beschrieben.  Nun, lass es uns tun. </p><br><p>  Installieren Sie die erforderlichen Abh√§ngigkeiten: </p><br><pre> <code class="bash hljs">npm i @material-ui/core jss react-jss</code> </pre> <br><p>  Als n√§chstes m√ºssen wir √Ñnderungen an vorhandenen Dateien vornehmen.  In <em>server / server.js</em> verpacken wir unsere Anwendung in JssProvider und MuiThemeProvider, die Material-UI-Komponenten und vor allem das sheetRegistry-Objekt - css - bereitstellen, das in der HTML-Vorlage platziert werden muss.  Auf der Client-Seite verwenden wir nur MuiThemeProvider und liefern ihm ein Themenobjekt. </p><br><div class="spoiler">  <b class="spoiler_title">Server, Vorlage und Client</b> <div class="spoiler_text"><p>  <em>server / server.js</em> </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { renderToString } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-dom/server'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { StaticRouter } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-router-dom'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { Helmet } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-helmet'</span></span> <span class="hljs-comment"><span class="hljs-comment">//     material-ui import { SheetsRegistry } from 'react-jss/lib/jss' import JssProvider from 'react-jss/lib/JssProvider' import { MuiThemeProvider, createMuiTheme, createGenerateClassName, } from '@material-ui/core/styles' import purple from '@material-ui/core/colors/purple' import App from '&amp;/app/App' import template from './template' export default function render(url) { const reactRouterContext = {} //  sheetsRegistry -    const sheetsRegistry = new SheetsRegistry() const sheetsManager = new Map() //   -        const theme = createMuiTheme({ palette: { primary: purple, secondary: { main: '#f44336', }, }, //      3.*.*.   v4 -  typography: { useNextVariants: true, }, }) const generateClassName = createGenerateClassName() //     let content = renderToString( &lt;StaticRouter location={url} context={reactRouterContext}&gt; &lt;JssProvider registry={sheetsRegistry} generateClassName={generateClassName}&gt; &lt;MuiThemeProvider theme={theme} sheetsManager={sheetsManager}&gt; &lt;App/&gt; &lt;/MuiThemeProvider&gt; &lt;/JssProvider&gt; &lt;/StaticRouter&gt; ) const helmet = Helmet.renderStatic() //  sheetsRegistry        html return template(helmet, content, sheetsRegistry) }</span></span></code> </pre> <br><p>  <em>server / template.js</em> </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">template</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">helmet, content = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">''</span></span></span></span><span class="hljs-function"><span class="hljs-params">, sheetsRegistry</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> css = sheetsRegistry.toString() <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> scripts = <span class="hljs-string"><span class="hljs-string">`&lt;script src="/client.js"&gt;&lt;/script&gt;`</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> page = <span class="hljs-string"><span class="hljs-string">`&lt;!DOCTYPE html&gt; &lt;html lang="en"&gt; &lt;head&gt; ... &lt;/head&gt; &lt;body&gt; &lt;div class="content"&gt;...&lt;/div&gt; &lt;style id="jss-server-side"&gt;</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${css}</span></span></span><span class="hljs-string">&lt;/style&gt; </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${scripts}</span></span></span><span class="hljs-string"> &lt;/body&gt; `</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> page }</code> </pre> <br><p>  <em>src / client.js</em> </p><br><pre> <code class="javascript hljs">... import MuiThemeProvider <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'@material-ui/core/styles/MuiThemeProvider'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> createMuiTheme <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'@material-ui/core/styles/createMuiTheme'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> purple <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'@material-ui/core/colors/purple'</span></span> <span class="hljs-comment"><span class="hljs-comment">//       ,     //         const theme = createMuiTheme({ palette: { primary: purple, secondary: { main: '#f44336', }, }, typography: { useNextVariants: true, }, }) //     hydrate( &lt;MuiThemeProvider theme={theme}&gt; &lt;BrowserRouter&gt; &lt;App/&gt; &lt;/BrowserRouter&gt; &lt;/MuiThemeProvider&gt;, document.querySelector('#app') )</span></span></code> </pre> </div></div><br><p>  Jetzt schlage ich vor, der Home-Komponente ein wenig stilvolles Design hinzuzuf√ºgen.  Sie k√∂nnen sich alle Material-UI-Komponenten auf ihrer offiziellen Website ansehen. Hier reichen Papier, Button, AppBar, Symbolleiste und Typografie aus. </p><br><p>  <em>src / app / Home.js.</em> </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { Helmet } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-helmet'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Paper <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'@material-ui/core/Paper'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Typography <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'@material-ui/core/Typography'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Button <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'@material-ui/core/Button'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Header <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./Header'</span></span> <span class="hljs-comment"><span class="hljs-comment">// Inline styles -       css  react const styles = { paper: { margin: "auto", marginTop: 200, width: "40%", padding: 15 }, btn: { marginRight: 20 } } export default function Home() { return( &lt;div&gt; &lt;Helmet&gt; &lt;title&gt;Universal Material Page&lt;/title&gt; &lt;/Helmet&gt; &lt;Header/&gt; &lt;Paper elevation={4} style={styles.paper} align="center"&gt; &lt;Typography variant="h5"&gt;Universal Web App with Material-ui&lt;/Typography&gt; &lt;br/&gt; &lt;Button variant="contained" color="primary" style={styles.btn}&gt;I like it!&lt;/Button&gt; &lt;/Paper&gt; &lt;/div&gt; ) }</span></span></code> </pre> <br><p>  <em>src / app / Header.js</em> </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> AppBar <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'@material-ui/core/AppBar'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Toolbar <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'@material-ui/core/Toolbar'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Typography <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'@material-ui/core/Typography'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Header</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ( <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">AppBar</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">position</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"static"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Toolbar</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Typography</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">variant</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"h5"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">color</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"inherit"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> Modern Web App </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Typography</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Toolbar</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">AppBar</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> ) }</code> </pre> <br><p>  Nun sollte sich so etwas herausstellen: </p><br><p><img src="https://habrastorage.org/webt/hw/sz/tz/hwsztzwymykxqtpq09zvrriozvy.png"></p><br><a name="splitting"></a><br><h3 id="3-code-splitting">  3. Code-Aufteilung </h3><br><p>  Wenn Sie mehr als eine TODO-Liste schreiben m√∂chten, wird Ihre Anwendung proportional zum Paket client.js erh√∂ht.  Um ein langes Laden von Seiten beim Benutzer zu vermeiden, wurde die Codeaufteilung seit langem erfunden.  Als Ryan Florence, einer der Entwickler von React-Router, potenzielle Entwickler mit seinem Satz erschreckte: </p><br><blockquote>  Godspeed diejenigen, die versuchen, die vom Server gerenderten, Code-Split-Apps. </blockquote><p>  <em>Viel Gl√ºck f√ºr alle, die sich entscheiden, SSR-Anwendungen mit Code-Aufteilung zu erstellen</em> </p><br><p>  Wir sind abgesto√üen - wir werden es tun!  Installieren Sie die erforderlichen: <cut></cut></p><br><pre> <code class="bash hljs">npm i @babel/plugin-syntax-dynamic-import babel-plugin-dynamic-import-node react-loadable</code> </pre> <br><p>  Das Problem ist nur eine Funktion - Import.  Webpack unterst√ºtzt diese asynchrone dynamische Importfunktion, aber die Babel-Kompilierung wird ein gro√ües Problem sein.  Gl√ºcklicherweise kamen bis 2018 Bibliotheken an, um dies zu bew√§ltigen.  babel / plugin-syntax-dynamic-import und babel-plugin-dynamic-import-node bewahren uns vor dem Fehler <code>"Unexpected token when using import()"</code> .  Warum zwei Bibliotheken f√ºr eine Aufgabe?  Der dynamische Importknoten wird speziell f√ºr das Rendern von Servern ben√∂tigt und nimmt Importe auf dem Server im laufenden Betrieb auf: </p><br><p>  <em>index.js</em> </p><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">"@babel/register"</span></span>)({ <span class="hljs-attr"><span class="hljs-attr">plugins</span></span>: [<span class="hljs-string"><span class="hljs-string">"@babel/plugin-syntax-dynamic-import"</span></span>, <span class="hljs-string"><span class="hljs-string">"dynamic-import-node"</span></span>] }); <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">"./app"</span></span>);</code> </pre> <br><p>  Gleichzeitig √§ndern wir die globale Babel-Konfigurationsdatei <em>.babelrc</em> </p><br><pre> <code class="json hljs"><span class="hljs-string"><span class="hljs-string">"plugins"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"@babel/plugin-syntax-dynamic-import"</span></span>, <span class="hljs-string"><span class="hljs-string">"react-loadable/babel"</span></span>, ... ]</code> </pre> <br><p>  Hier erschien <strong>reaktionsladbar</strong> .  Diese Bibliothek mit hervorragender Dokumentation sammelt alle Module, die durch den Webpack-Import auf dem Server besch√§digt wurden, und der Client kann sie genauso einfach abrufen.  Dazu muss der Server alle Module herunterladen: </p><br><p>  <em>app.js.</em> </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Loadable <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-loadable'</span></span> ... Loadable.preloadAll().then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> app.listen(PORT, <span class="hljs-string"><span class="hljs-string">'0.0.0.0'</span></span>, () =&gt; { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">`The app is running in PORT </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${PORT}</span></span></span><span class="hljs-string">`</span></span>) })) ...</code> </pre> <br><p>  Die Module selbst sind sehr einfach anzuschlie√üen.  Schauen Sie sich den Code an: </p><br><p>  <em>src / app / App.js.</em> </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { Switch, Route } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-router'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Loadable <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-loadable'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Loading <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'&amp;/Loading'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> AsyncHome = Loadable({ <span class="hljs-attr"><span class="hljs-attr">loader</span></span>: <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span>(<span class="hljs-comment"><span class="hljs-comment">/* webpackChunkName: "Home" */</span></span> <span class="hljs-string"><span class="hljs-string">'./Home'</span></span>), <span class="hljs-attr"><span class="hljs-attr">loading</span></span>: Loading, <span class="hljs-attr"><span class="hljs-attr">delay</span></span>: <span class="hljs-number"><span class="hljs-number">300</span></span>, }) <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">App</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>( <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Switch</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Route</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">exact</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">path</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"/"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">component</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{AsyncHome}/</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Switch</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> ) }</span></span></code> </pre> <br><p>  React-loadable l√§dt die Home-Komponente asynchron und macht dem Webpack klar, dass sie Home hei√üen sollte (ja, dies ist ein seltener Fall, wenn Kommentare sinnvoll sind).  <code>delay: 300</code> bedeutet, dass wenn nach <code>delay: 300</code> ms die Komponente immer noch nicht geladen wird, Sie zeigen m√ºssen, dass der Download noch l√§uft.  Es befasst sich mit Laden: </p><br><p>  <em>src / Loading.js</em> </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> CircularProgress <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'@material-ui/core/CircularProgress'</span></span> <span class="hljs-comment"><span class="hljs-comment">//        .   const styles = { div: { width: '20%', margin: 'auto', transition: 'margin 1s', backgroundColor: 'lightgreen', color: 'white', cursor: 'pointer', borderRadius: '3px' } } export default function Loading(props) { if (props.error) { //      (  PWA  ),  //  ,      return &lt;div style={styles.div} onClick={ () =&gt; window.location.reload(true) } align="center"&gt; &lt;h3&gt; Please, click here or reload the page. New content is ready. &lt;/h3&gt; &lt;/div&gt; } else if (props.pastDelay) { //     300,    return &lt;CircularProgress color="primary"/&gt; } else { //    Loading  return null } }</span></span></code> </pre> <br><p>  Um dem Server klar zu machen, welche Module wir importieren, m√ºssten wir uns registrieren: </p><br><pre> <code class="javascript hljs">Loadable({ <span class="hljs-attr"><span class="hljs-attr">loader</span></span>: <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span>(<span class="hljs-string"><span class="hljs-string">'./Bar'</span></span>), <span class="hljs-attr"><span class="hljs-attr">modules</span></span>: [<span class="hljs-string"><span class="hljs-string">'./Bar'</span></span>], <span class="hljs-attr"><span class="hljs-attr">webpack</span></span>: <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> [<span class="hljs-built_in"><span class="hljs-built_in">require</span></span>.resolveWeak(<span class="hljs-string"><span class="hljs-string">'./Bar'</span></span>)], });</code> </pre> <br><p>  Um jedoch nicht denselben Code zu wiederholen, gibt es ein <em>reaktionsladbares</em> / babel-Plugin, das wir bereits erfolgreich mit <em>.babelrc</em> verbunden <em>haben</em> .  Nachdem der Server wei√ü, was importiert werden soll, m√ºssen Sie herausfinden, was gerendert wird.  Der Workflow ist ein bisschen wie beim Helm: </p><br><p>  <em>server / server.js</em> </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Loadable <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-loadable'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { getBundles } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-loadable/webpack'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> stats <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'~/public/react-loadable.json'</span></span> ... let modules = [] <span class="hljs-comment"><span class="hljs-comment">//      modules let content = renderToString( &lt;StaticRouter location={url} context={reactRouterContext}&gt; &lt;JssProvider registry={sheetsRegistry} generateClassName={generateClassName}&gt; &lt;MuiThemeProvider theme={theme} sheetsManager={sheetsManager}&gt; &lt;Loadable.Capture report={moduleName =&gt; modules.push(moduleName)}&gt; &lt;App/&gt; &lt;/Loadable.Capture&gt; &lt;/MuiThemeProvider&gt; &lt;/JssProvider&gt; &lt;/StaticRouter&gt; ) ... //     ( ) let bundles = getBundles(stats, modules) //    HTML- return template(helmet, content, sheetsRegistry, bundles)</span></span></code> </pre> <br><p>  Um sicherzustellen, dass der Client alle auf dem Server gerenderten Module l√§dt, m√ºssen sie mit den von webpack erstellten Bundles korreliert werden.  Nehmen Sie dazu √Ñnderungen an der Konfiguration des Kollektors vor.  Das React-Load / Webpack-Plugin schreibt alle Module in eine separate Datei.  Wir sollten Webpack auch anweisen, Module nach dem dynamischen Import korrekt zu speichern - im Ausgabeobjekt. </p><br><p>  <em>webpack.config.js</em> </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> ReactLoadablePlugin = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'react-loadable/webpack'</span></span>).ReactLoadablePlugin; ... output: { <span class="hljs-attr"><span class="hljs-attr">path</span></span>: path.resolve(__dirname, <span class="hljs-string"><span class="hljs-string">'public'</span></span>), <span class="hljs-attr"><span class="hljs-attr">publicPath</span></span>: <span class="hljs-string"><span class="hljs-string">'/'</span></span>, <span class="hljs-attr"><span class="hljs-attr">chunkFilename</span></span>: <span class="hljs-string"><span class="hljs-string">'[name].bundle.js'</span></span>, <span class="hljs-attr"><span class="hljs-attr">filename</span></span>: <span class="hljs-string"><span class="hljs-string">"[name].js"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">plugins</span></span>: [ <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ReactLoadablePlugin({ <span class="hljs-attr"><span class="hljs-attr">filename</span></span>: <span class="hljs-string"><span class="hljs-string">'./public/react-loadable.json'</span></span>, }) ]</code> </pre> <br><p>  Wir schreiben die Module in die Vorlage und laden sie nacheinander: </p><br><p>  <em>server / template.js</em> </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">template</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">helmet, content = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">''</span></span></span></span><span class="hljs-function"><span class="hljs-params">, sheetsRegistry, bundles</span></span></span><span class="hljs-function">) </span></span>{ ... const page = <span class="hljs-string"><span class="hljs-string">`&lt;!DOCTYPE html&gt; &lt;html lang="en"&gt; &lt;head&gt;...&lt;/head&gt; &lt;body&gt; &lt;div class="content"&gt; &lt;div id="app" class="wrap-inner"&gt; &lt;!--- magic happens here --&gt; </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${content}</span></span></span><span class="hljs-string"> &lt;/div&gt; </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${bundles.map(bundle =&gt; </span></span><span class="hljs-string"><span class="hljs-string"><span class="hljs-subst"><span class="hljs-string">`&lt;script src='/</span></span></span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${bundle.file}</span></span></span></span></span><span class="hljs-string"><span class="hljs-subst"><span class="hljs-string">'&gt;&lt;/script&gt;`</span></span></span></span><span class="hljs-string"><span class="hljs-subst">).join(</span></span><span class="hljs-string"><span class="hljs-string"><span class="hljs-subst"><span class="hljs-string">'\n'</span></span></span></span><span class="hljs-string"><span class="hljs-subst">)}</span></span></span><span class="hljs-string"> &lt;/div&gt; &lt;style id="jss-server-side"&gt;</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${css}</span></span></span><span class="hljs-string">&lt;/style&gt; </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${scripts}</span></span></span><span class="hljs-string"> &lt;/body&gt; `</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> page }</code> </pre> <br><p>  Es bleibt nur die Bearbeitung des Client-Teils.  Die <code>Loadable.preloadReady()</code> -Methode l√§dt alle Module, die der Server dem Benutzer im Voraus gegeben hat. </p><br><p>  <em>src / client.js</em> </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Loadable <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-loadable'</span></span> Loadable.preloadReady().then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> { hydrate( <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">MuiThemeProvider</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">theme</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{theme}</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">BrowserRouter</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">App</span></span></span></span><span class="xml"><span class="hljs-tag">/&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">BrowserRouter</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">MuiThemeProvider</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span>, <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.querySelector(<span class="hljs-string"><span class="hljs-string">'#app'</span></span>) ) })</code> </pre> <br><p>  Fertig!  Wir beginnen und schauen uns das Ergebnis an - im letzten Teil war das Bundle nur eine Datei - client.js mit einem Gewicht von 265 KB, und jetzt gibt es 3 Dateien, von denen die gr√∂√üte 215 KB wiegt.  Es ist unn√∂tig zu erw√§hnen, dass die Geschwindigkeit beim Laden von Seiten beim Skalieren eines Projekts erheblich zunimmt. </p><br><p><img src="https://habrastorage.org/webt/a-/-t/k_/a--tk_6dxr4zzvg-7z8zys_cas4.png"></p><br><a name="redux"></a><br><h3 id="4-redux-schetchik">  4. Reduxz√§hler </h3><br><p>  Jetzt werden wir beginnen, praktische Probleme zu l√∂sen.  Um das Dilemma zu l√∂sen, wenn der Server √ºber Daten verf√ºgt (z. B. aus einer Datenbank), m√ºssen Sie diese anzeigen, damit Such-Bots den Inhalt finden und diese Daten dann auf dem Client verwenden k√∂nnen. </p><br><p>  Es gibt eine L√∂sung.  Es wird in fast jedem SSR-Artikel verwendet, aber die Art und Weise, wie es dort implementiert wird, ist bei weitem nicht immer f√ºr eine gute Skalierbarkeit zug√§nglich.  Mit einfachen Worten, nach den meisten Tutorials k√∂nnen Sie mit SSR keine echte Site nach dem Prinzip "Eins, Zwei und Produktion" erstellen.  Jetzt werde ich versuchen, das i zu punktieren. </p><br><p>  Wir brauchen nur <strong>Redux</strong> .  Tatsache ist, dass Redux einen globalen Speicher hat, den wir mit einem Fingerklick vom Server auf den Client √ºbertragen k√∂nnen. <br>  Nun das Wichtige (!): Wir haben einen Grund, eine <em>Server / StateRoutes-Datei zu haben</em> .  Es verwaltet das <strong>dort</strong> generierte <strong>initialState-</strong> Objekt, erstellt daraus einen Speicher und <strong>√ºbergibt</strong> ihn an die HTML-Vorlage.  Der Client ruft dieses Objekt aus dem <code>window.__STATE__</code> , <code>window.__STATE__</code> Speicher neu und <code>window.__STATE__</code> .  Es scheint einfach. </p><cut></cut><br><p>  Installieren: </p><br><pre> <code class="bash hljs">npm i redux react-redux</code> </pre> <br><p>  Befolgen Sie die obigen Schritte.  Hier zum gr√∂√üten Teil Wiederholung des zuvor verwendeten Codes. </p><br><div class="spoiler">  <b class="spoiler_title">Server- und Client-Verarbeitungsz√§hler</b> <div class="spoiler_text"><p>  <em>server / stateRoutes.js</em> : </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ssr <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./server'</span></span> <span class="hljs-comment"><span class="hljs-comment">//   -  = 5 const initialState = { count: 5 } export default function (app) { app.get('*', (req, res) =&gt; { //  initialState  const response = ssr(req.url, initialState) res.send(response) }) }</span></span></code> </pre><br><p>  <em>server / server.js</em> : </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { Provider } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-redux'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> configureStore <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'&amp;/redux/configureStore'</span></span> ... export <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">render</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">url, initialState</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//   const store = configureStore(initialState) ... // Redux Provider    . let content = renderToString( &lt;StaticRouter location={url} context={reactRouterContext}&gt; &lt;Provider store={store} &gt; &lt;JssProvider registry={sheetsRegistry} generateClassName={generateClassName}&gt; &lt;MuiThemeProvider theme={theme} sheetsManager={sheetsManager}&gt; &lt;Loadable.Capture report={moduleName =&gt; modules.push(moduleName)}&gt; &lt;App/&gt; &lt;/Loadable.Capture&gt; &lt;/MuiThemeProvider&gt; &lt;/JssProvider&gt; &lt;/Provider&gt; &lt;/StaticRouter&gt; ) ... //  initialState  HTML- return template(helmet, content, sheetsRegistry, bundles, initialState) }</span></span></code> </pre> <br><p>  <em>server / template.js</em> </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">template</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">helmet, content = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">''</span></span></span></span><span class="hljs-function"><span class="hljs-params">, sheetsRegistry, bundles, initialState = {}</span></span></span><span class="hljs-function">) </span></span>{ ... <span class="hljs-comment"><span class="hljs-comment">//   initialState       const scripts = `&lt;script&gt; window.__STATE__ = ${JSON.stringify(initialState)} &lt;/script&gt; &lt;script src="/client.js"&gt;&lt;/script&gt;` const page = `&lt;!DOCTYPE html&gt; &lt;html lang="en"&gt; &lt;head&gt;...&lt;/head&gt; &lt;body&gt; ... ${scripts} &lt;/body&gt; ` return page }</span></span></code> </pre> <br><p>  Wir bekommen Gesch√§ft auf dem Kunden.  <em>src / client.js</em> </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Loadable <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-loadable'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { Provider } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-redux'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> configureStore <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./redux/configureStore'</span></span> ... <span class="hljs-comment"><span class="hljs-comment">//   initialState  ""     const state = window.__STATE__ const store = configureStore(state) Loadable.preloadReady().then(() =&gt; { hydrate( &lt;Provider store={store} &gt; &lt;MuiThemeProvider theme={theme}&gt; &lt;BrowserRouter&gt; &lt;App/&gt; &lt;/BrowserRouter&gt; &lt;/MuiThemeProvider&gt; &lt;/Provider&gt;, document.querySelector('#app') ) })</span></span></code> </pre> </div></div><br><p>  Die Redux-Logik im SSR ist beendet.  Die √ºbliche Arbeit mit Redux besteht nun darin, ein Gesch√§ft, Aktionen, Reduzierungen, Verbindungen und mehr zu erstellen.  Ich hoffe, dass dies ohne viel Erkl√§rung klar wird.  Wenn nicht, lesen Sie die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Dokumentation</a> . </p><br><div class="spoiler">  <b class="spoiler_title">Ganzer Redux hier</b> <div class="spoiler_text"><p>  <em>src / redux / configureStore.js</em> </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { createStore } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'redux'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> rootReducer <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./reducers'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">configureStore</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">preloadedState</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> createStore( rootReducer, preloadedState ) }</code> </pre> <br><p>  <em>src / redux / action.js</em> </p><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// actions export const INCREASE = 'INCREASE' export const DECREASE = 'DECREASE' //  action creators export function increase() { return { type: INCREASE } } export function decrease() { return { type: DECREASE } }</span></span></code> </pre> <br><p>  <em>src / redux / reducers.js</em> </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { INCREASE, DECREASE } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./actions'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">count</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state, action</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (action.type) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> INCREASE: <span class="hljs-comment"><span class="hljs-comment">//   action = INCREASE -  state.count  1 return Object.assign({}, state, { count: state.count + 1 }) case DECREASE: //  DECREASE -   1.    return Object.assign({}, state, { count: state.count - 1 }) default: //      return state } }</span></span></code> </pre> <br><p>  <em>src / app / Home.js.</em> </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { Helmet } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-helmet'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { bindActionCreators } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'redux'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { connect } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-redux'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> Actions <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'&amp;/redux/actions'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Header <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./Header'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Paper <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'@material-ui/core/Paper'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Typography <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'@material-ui/core/Typography'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Button <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'@material-ui/core/Button'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> styles = { <span class="hljs-attr"><span class="hljs-attr">paper</span></span>: { <span class="hljs-attr"><span class="hljs-attr">margin</span></span>: <span class="hljs-string"><span class="hljs-string">'auto'</span></span>, <span class="hljs-attr"><span class="hljs-attr">marginTop</span></span>: <span class="hljs-string"><span class="hljs-string">'10%'</span></span>, <span class="hljs-attr"><span class="hljs-attr">width</span></span>: <span class="hljs-string"><span class="hljs-string">'40%'</span></span>, <span class="hljs-attr"><span class="hljs-attr">padding</span></span>: <span class="hljs-number"><span class="hljs-number">15</span></span> }, <span class="hljs-attr"><span class="hljs-attr">btn</span></span>: { <span class="hljs-attr"><span class="hljs-attr">marginRight</span></span>: <span class="hljs-number"><span class="hljs-number">20</span></span> } } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Home</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">React</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Component</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(){ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>() <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.increase = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.increase.bind(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.decrease = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.decrease.bind(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>) } <span class="hljs-comment"><span class="hljs-comment">//   dispatch   increase  decrease increase(){ this.props.actions.increase() } decrease(){ this.props.actions.decrease() } render(){ return ( &lt;div&gt; &lt;Helmet&gt; &lt;title&gt;MWA - Home&lt;/title&gt; &lt;meta name="description" content="Modern Web App - Home Page" /&gt; &lt;/Helmet&gt; &lt;Header/&gt; &lt;Paper elevation={4} style={styles.paper} align="center"&gt; &lt;Typography variant="h5"&gt;Redux-Counter&lt;/Typography&gt; &lt;Typography variant="subtitle1"&gt;Counter: {this.props.count}&lt;/Typography&gt; &lt;br/&gt; &lt;Button variant="contained" color="primary" onClick={this.increase} style={styles.btn}&gt;Increase&lt;/Button&gt; &lt;Button variant="contained" color="primary" onClick={this.decrease}&gt;Decrease&lt;/Button&gt; &lt;/Paper&gt; &lt;/div&gt; ) } } //   props  const mapStateToProps = (state) =&gt; ({ count: state.count }) //  actions  this.props const mapDispatchToProps = (dispatch) =&gt; ({ actions: bindActionCreators(Actions, dispatch) }) //  react-redux connect     export default connect( mapStateToProps, mapDispatchToProps )(Home)</span></span></code> </pre> </div></div><br><p>    : </p><br><p><img src="https://habrastorage.org/webt/jx/hl/yn/jxhlynjixnl5i0r-g7zygxuax4y.gif"></p><br><a name="mobile"></a><br><h3 id="5-mobilnaya-versiya"> 5.   </h3><br><p><img src="https://habrastorage.org/webt/ek/3a/on/ek3aonmzc8w0atrngq6zjngea_g.gif" align="left">     ,         ‚Äî  .       .        ,    ,        <strong>initialState</strong> ,      . </p><br><p>     : </p><br><pre> <code class="bash hljs">npm i mobile-detect</code> </pre> <br><p> <strong>mobile detect</strong>      user-agent,  null             . <br><br clear="left"></p><br><p>   : </p><br><p> <em>server/stateRoutes.js</em> </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ssr <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./server'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> MobileDetect <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'mobile-detect'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> initialState = { <span class="hljs-attr"><span class="hljs-attr">count</span></span>: <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-attr"><span class="hljs-attr">mobile</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">app</span></span></span><span class="hljs-function">) </span></span>{ app.get(<span class="hljs-string"><span class="hljs-string">'*'</span></span>, (req, res) =&gt; { <span class="hljs-comment"><span class="hljs-comment">// md == null,  ,    const md = new MobileDetect(req.headers['user-agent']) const response = ssr(req.url, initialState, md.mobile()) res.send(response) }) }</span></span></code> </pre> <br><p>           ‚Äî  : </p><br><div class="spoiler"> <b class="spoiler_title">     </b> <div class="spoiler_text"><p> <em>server/server.js</em> </p><br><pre> <code class="javascript hljs">... import App <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'&amp;/app/App'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> MobileApp <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'&amp;/mobileApp/App'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">render</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">url, initialState, mobile</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//    -    let content = renderToString( &lt;StaticRouter location={url} context={reactRouterContext}&gt; &lt;Provider store={store} &gt; &lt;JssProvider registry={sheetsRegistry} generateClassName={generateClassName}&gt; &lt;MuiThemeProvider theme={theme} sheetsManager={sheetsManager}&gt; &lt;Loadable.Capture report={moduleName =&gt; modules.push(moduleName)}&gt; {mobile === null ? &lt;App/&gt; : &lt;MobileApp/&gt; } &lt;/Loadable.Capture&gt; &lt;/MuiThemeProvider&gt; &lt;/JssProvider&gt; &lt;/Provider&gt; &lt;/StaticRouter&gt; ) //       initialState.mobile = mobile return template(helmet, content, sheetsRegistry, bundles, initialState) }</span></span></code> </pre> <br><p> <em>src/client.js</em> </p><br><pre> <code class="javascript hljs">... const state = <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.__STATE__ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> store = configureStore(state) <span class="hljs-comment"><span class="hljs-comment">//       state Loadable.preloadReady().then(() =&gt; { hydrate( &lt;Provider store={store} &gt; &lt;MuiThemeProvider theme={theme}&gt; &lt;BrowserRouter&gt; {state.mobile === null ? &lt;App/&gt; : &lt;MobileApp/&gt; } &lt;/BrowserRouter&gt; &lt;/MuiThemeProvider&gt; &lt;/Provider&gt;, document.querySelector('#app') ) })</span></span></code> </pre> </div></div><br><p>         react-,     .    ,     .       <em>src/mobileApp</em> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="></a> . </p><br><a name="pwa"></a><br><h3 id="6-progressivnoe-prilozhenie"> 6.   </h3><br><p> <em>Progressive Web App</em> (PWA), <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">  Google</a> ‚Äî  ,    ,    ,   . </p><br><p><img src="https://habrastorage.org/webt/6g/iw/x_/6giwx_0fwzwfcppxqp1kfvsle_a.gif" align="left">      .         :  Chrome, Opera  Samsung Internet     ,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> </a> .  iOS             Safari,       .  ,     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> </a> .      PWA:  Windows  Chrome v70, Linux  v70, ChromeOS  v67.  PWA  macOS ‚Äî         2019    Chrome v72. </p><br><p>       : PWA        .  ,       ,   ,  . <br><br clear="left"></p><br><p> 2  ‚Äî manifest.json  service-worker.js ‚Äî  . <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="></a> ‚Äî  json , ,     ,  . <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Service-worker</a>   :    push-,        . </p><br><p>   .      ,     : </p><br><p> <em>public/manifest.json</em> : </p><br><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"short_name"</span></span>: <span class="hljs-string"><span class="hljs-string">"MWA"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"Modern Web App"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">"Modern app built with React SSR, PWA, material-ui, code splitting and much more"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"icons"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"src"</span></span>: <span class="hljs-string"><span class="hljs-string">"/assets/logos/yellow 192.png"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"sizes"</span></span>: <span class="hljs-string"><span class="hljs-string">"192x192"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"image/png"</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"src"</span></span>: <span class="hljs-string"><span class="hljs-string">"/assets/logos/yellow 512.png"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"sizes"</span></span>: <span class="hljs-string"><span class="hljs-string">"512x512"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"image/png"</span></span> } ], <span class="hljs-attr"><span class="hljs-attr">"start_url"</span></span>: <span class="hljs-string"><span class="hljs-string">"."</span></span>, <span class="hljs-attr"><span class="hljs-attr">"display"</span></span>: <span class="hljs-string"><span class="hljs-string">"standalone"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"theme_color"</span></span>: <span class="hljs-string"><span class="hljs-string">"#810051"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"background_color"</span></span>: <span class="hljs-string"><span class="hljs-string">"#FFFFFF"</span></span> }</code> </pre> <br><p>    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> </a>   service-worker',        .    ,  ,   : </p><br><p> <em>public/service-worker.js</em> </p><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//   -       var CACHE = 'cache' //     self.addEventListener('install', function(evt) { evt.waitUntil(precache()) }) //   fetch  ,       self.addEventListener('fetch', function(evt) { console.log('The service worker is serving the asset.') evt.respondWith(fromCache(evt.request)) evt.waitUntil(update(evt.request)) }) // ,      function precache() { return caches.open(CACHE).then(function (cache) { return cache.addAll([ './', '/assets/MWA.png', '/assets/global.css', '/assets/logos/favicon.ico', '/assets/logos/yellow 192.png', '/assets/logos/yellow 512.png', '/robots.txt' ]) }) } //   ,      .  ,   function fromCache(request) { return caches.open(CACHE).then(function (cache) { return cache.match(request).then(function (matching) { return matching || null }) }) } //     ,    //     function update(request) { return caches.open(CACHE).then(function (cache) { return fetch(request).then(function (response) { return cache.put(request, response) }) }) }</span></span></code> </pre> <br><p>    PWA ,      -  html-: </p><br><p> <em>server/template.js</em> </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">template</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">helmet, content = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">''</span></span></span></span><span class="hljs-function"><span class="hljs-params">, sheetsRegistry, bundles, initialState = {}</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> scripts = <span class="hljs-string"><span class="hljs-string">`... &lt;script&gt; //    service-worker -  if ('serviceWorker' in navigator) { window.addEventListener('load', () =&gt; { navigator.serviceWorker.register('/service-worker.js') .then(registration =&gt; { console.log('Service Worker is registered! '); }) .catch(err =&gt; { console.log('Registration failed ', err); }); }); } &lt;/script&gt;`</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> page = <span class="hljs-string"><span class="hljs-string">`&lt;!DOCTYPE html&gt; &lt;html lang="en"&gt; &lt;head&gt; ... &lt;link rel="manifest" href="/manifest.json"&gt; &lt;/head&gt; &lt;body&gt; ... </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${scripts}</span></span></span><span class="hljs-string"> &lt;/body&gt; `</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> page }</code> </pre> <br><p> !     https,     ,     gif     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">demo</a> . </p><br><h3 id="7-konec"> 7.  </h3><br><p>        MWA.      ,     ,    .      ,     SSR  Code Splitting,      PWA           . </p><br><p> ,     MWA    - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">web.dev</a> : </p><br><p><img src="https://habrastorage.org/webt/wh/xx/tr/whxxtrgl_djujcsj8rvhzatf8sg.png"></p><br><p>      ,  ‚Äî .  ,    ,     ‚Äî     . </p><br><p> , MWA ‚Äî opensource . , , ! </p><br><p>  Viel Gl√ºck </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de432368/">https://habr.com/ru/post/de432368/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de432356/index.html">So schreiben Sie in 20 Stunden einen hervorragenden VKontakte-Newsfeed</a></li>
<li><a href="../de432360/index.html">"Nachkomme" AlphaGo lernte selbst√§ndig Schach, Shogi und Go</a></li>
<li><a href="../de432362/index.html">Chang'e 4 - Mission auf der anderen Seite des Mondes beginnt heute</a></li>
<li><a href="../de432364/index.html">Phonetisches Alphabet: Wie eine L√∂sung f√ºr die Luftfahrt hilft, ein Login per Telefon zu √ºbertragen</a></li>
<li><a href="../de432366/index.html">Implementieren Sie das SSD-Caching im QSAN XCubeSAN-Speicher</a></li>
<li><a href="../de432370/index.html">AlphaZero besiegte Stockfish in einem Match mit 1.000 Spielen</a></li>
<li><a href="../de432372/index.html">Microsoft hat offiziell best√§tigt, dass Edge auf die Chromium-Engine umschaltet</a></li>
<li><a href="../de432374/index.html">Gut zug√§ngliche und skalierbare Elasticsearch in Kubernetes</a></li>
<li><a href="../de432378/index.html">Ein Zehntkl√§ssler aus Sibirien m√∂chte Prozessordesigner werden. Warum nicht einen neuronalen FPGA-Beschleuniger herstellen?</a></li>
<li><a href="../de432380/index.html">Sechs Jahre Leben mit einem iPhone, das mich nicht ablenkt</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>