<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>❣️ 👼 👇🏽 iMaterialist家具挑战赛或50副椅子 🎵 💇🏿 🍜</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="最近，iMaterialist挑战赛（家具）竞赛在Kaggle结束，其任务是将图像分类为128种家具和家用物品（所谓的细分类，类别之间非常接近）。 

 在本文中，我将介绍使我们在m0rtido方面获得第三名的方法，但是在继续讨论这一点之前，我建议使用脑中的自然神经网络来解决此问题，并将以下照片中的...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>iMaterialist家具挑战赛或50副椅子</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/414865/">最近，iMaterialist挑战赛（家具）竞赛在Kaggle结束，其任务是将图像分类为128种家具和家用物品（所谓的细分类，类别之间非常接近）。 <br><br> 在本文中，我将介绍使我们在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" class="user_link">m0rtido方面获得</a>第三名的方法，但是在继续讨论这一点之前，我建议使用脑中的自然神经网络来解决此问题，并将以下照片中的椅子分为三类。 <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><img src="https://habrastorage.org/webt/gc/to/5k/gcto5kett7sesdsd-_sej5xsbie.png"></a> <br><a name="habracut"></a><br><div class="spoiler">  <b class="spoiler_title">实班</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/jq/jb/md/jqjbmdbxl1mkuyxfvjusdzt2piu.png"><br></div></div><br> 你猜对了吗？ 我也没有 <br><br> 但是先停下来，第一件事。 <br><br><h2> 问题陈述 </h2><br> 在比赛中，我们获得了一个数据集，其中提供了128类普通家用物品，例如动漫人物形式的椅子，电视，锅和枕头。 <br> 数据集的训练部分包含约19万张图片（由于参与者仅获得了一组下载URL（其中的某些当然不起作用），因此很难说出确切的数字），而且课程的分布也不尽相同（请参见下面的可点击图片） 。 <br><br> <a href=""><img src="https://habrastorage.org/webt/s4/df/jb/s4dfjblcnusqknbhcyqpnabzv0q.png"></a> <br><br> 测试数据集由12800张图片表示，并且完全平衡：每个类别有100张图片。 还发布了一个验证数据集，该数据集也具有均衡的类分布，并且恰好是测试数据集的一半。 <br><br> 任务评估指标为 <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x9519;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x8BEF;</mo></mrow><msub><mtext>&amp;#xA0;</mtext><mi>r</mi></msub><mi>a</mi><mi>t</mi><mi>e</mi><mo>=</mo><mn>1</mn><mo>&amp;#x2212;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x7CBE;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x5EA6;</mo></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="19.519ex" height="2.419ex" viewBox="0 -780.1 8404.2 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">错</text><g transform="translate(829,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">误</text></g><g transform="translate(1659,0)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/414865/&amp;usg=ALkJrhhXMDjHl6BGcHrt_C34IJdyT2Us7w#MJMATHI-72" x="353" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/414865/&amp;usg=ALkJrhhXMDjHl6BGcHrt_C34IJdyT2Us7w#MJMATHI-61" x="2329" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/414865/&amp;usg=ALkJrhhXMDjHl6BGcHrt_C34IJdyT2Us7w#MJMATHI-74" x="2858" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/414865/&amp;usg=ALkJrhhXMDjHl6BGcHrt_C34IJdyT2Us7w#MJMATHI-65" x="3220" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/414865/&amp;usg=ALkJrhhXMDjHl6BGcHrt_C34IJdyT2Us7w#MJMAIN-3D" x="3964" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/414865/&amp;usg=ALkJrhhXMDjHl6BGcHrt_C34IJdyT2Us7w#MJMAIN-31" x="5020" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/414865/&amp;usg=ALkJrhhXMDjHl6BGcHrt_C34IJdyT2Us7w#MJMAIN-2212" x="5743" y="0"></use><g transform="translate(6744,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">精</text></g><g transform="translate(7574,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">度</text></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mo>错</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>误</mo></mrow><msub><mtext>&nbsp;</mtext><mi>r</mi></msub><mi>a</mi><mi>t</mi><mi>e</mi><mo>=</mo><mn>1</mn><mo>−</mo><mrow class="MJX-TeXAtom-ORD"><mo>精</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>度</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-1">错误\ _rate = 1-精度</script>  。 <br><br><h2> 我们如何决定？ </h2><br> 首先，我们下载了数据并用眼睛看了一小部分。 而不是许多图片，而是下载了1x1图像或有错误的占位符。 我们立即使用脚本删除了此类图像。 <br><br><h4> 转移学习 </h4><br> 很明显，在可用图像数量和时间限制的情况下，在此数据集上从头开始训练神经网络并不是一个好主意。 取而代之的是，我们使用了转移学习方法，其思想如下：在一项任务上训练的网络的权重可以用于完全不同的数据集，并具有不错的质量，甚至与从头开始学习相比，其准确性也得到提高。 <br><br> 如何运作？ 深度神经网络中的隐藏层充当特征提取器，提取出的特征然后由上层直接用于分类。 <br><br> 我们通过完成一系列先前在ImageNet上进行过训练的深层CNN来利用这一优势。 为此，我们使用了Keras及其模型动物园，其中以下代码足以加载完成的架构： <br><br><pre><code class="python hljs">base_model = densenet.DenseNet201(weights=<span class="hljs-string"><span class="hljs-string">'imagenet'</span></span>, include_top=<span class="hljs-keyword"><span class="hljs-keyword">False</span></span>, input_shape=(img_width, img_height, <span class="hljs-number"><span class="hljs-number">3</span></span>), pooling=<span class="hljs-string"><span class="hljs-string">'avg'</span></span>)</code> </pre> <br> 之后，我们从网络中提取了所谓的瓶颈标志（位于最后一个卷积层出口处的特征），并训练了softmax并在它们之上放置了drop。 <br><br> 然后，我们将训练后的“最高”权重连接到网络的卷积部分，并立即训练整个网络。 <br><br><div class="spoiler">  <b class="spoiler_title">查看代码。</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> layer <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> base_model.layers: layer.trainable = <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> top_model = Sequential() top_model.add(Dropout(<span class="hljs-number"><span class="hljs-number">0.5</span></span>, name=<span class="hljs-string"><span class="hljs-string">'top_dropout'</span></span>, input_shape=base_model.output_shape[<span class="hljs-number"><span class="hljs-number">1</span></span>:])) top_model.add(Dense(<span class="hljs-number"><span class="hljs-number">128</span></span>, activation=<span class="hljs-string"><span class="hljs-string">'softmax'</span></span>, name=<span class="hljs-string"><span class="hljs-string">'top_softmax'</span></span>)) top_model.load_weights(<span class="hljs-string"><span class="hljs-string">'top-weights-densenet.hdf5'</span></span>, by_name=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) model = Model(inputs=base_model.input, outputs=top_model(base_model.output)) initial_lrate = <span class="hljs-number"><span class="hljs-number">0.0005</span></span> model.compile(optimizer=Adam(lr=initial_lrate), loss=<span class="hljs-string"><span class="hljs-string">'categorical_crossentropy'</span></span>, metrics=[<span class="hljs-string"><span class="hljs-string">'accuracy'</span></span>])</code> </pre><br></div></div><br> 通过对网络进行这样的微调，我们设法尝试了以下技巧： <br><br><ol><li>  <b>数据扩充</b> 。 为了避免过度拟合，我们使用了非常严格的增强方法：水平反射，缩放，移位，旋转，倾斜，添加颜色噪声，颜色通道移位，对五条裁剪线（图像的角度和中心）进行训练。 我们也想尝试<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">FancyPCA</a> ，但是由于缺乏计算资源而失败了。 </li><li>  <b>贸易协定</b> 为了预测验证和测试的班级，我们使用了增强方法，其积极性比训练期间要低一些，并对预测结果取平均值以提高准确性。 </li><li>  <b>自行车学习率</b> 。 训练速度的周期性增加和减少帮助模型避免陷入局部低点。 </li><li>  <b>在一部分班上进行模型训练</b> 。 从上方的图片可以看出，数据集包含非常接近的类。 如此接近，以致于在某些对象簇上（例如，在最多代表8类的椅子和扶手椅上），我们的模型比在其他类型的对象上更容易出错。 我们试图训练一个单独的CNN仅识别椅子，希望这种网络比通用网络更好地区分椅子的种类，但是这种方法并没有提高准确性。 <br><br> 怎么了 该问题的部分答案显示在剪切之前的图片中-这些类是如此相似，以至于即使使用数据的初始标记，放下这些类标签的人也无法区分它们，因此不可能以很高的准确性挤出这些数据。 </li><li>  <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">空间变压器网络</a></b> 。 尽管我们使用它训练了一个网络并获得了相当不错的准确性，但是不幸的是，它并未包含在最终提交中。 </li><li>  <b>加权损失函数</b> 。 为了补偿类别的不平衡分配，我们使用了加权损失。 这不仅有助于培训softmax“顶”，而且还有助于进一步培训整个网络。 使用scikit-learn中的函数计算权重，然后将其传递给模型的拟合方法： </li></ol><br><pre> <code class="python hljs">train_labels = utils.to_categorical(train_generator.classes) y_integers = np.argmax(train_labels, axis=<span class="hljs-number"><span class="hljs-number">1</span></span>) class_weights = compute_class_weight(<span class="hljs-string"><span class="hljs-string">'balanced'</span></span>, np.unique(y_integers), y_integers)</code> </pre><br> 经过这种方式训练的网络占了我们最终合奏的90％。 <br><br><h4> 堆叠瓶颈标签 </h4><br> 免责声明：切勿重复现实生活中稍后描述的技术。 <br><br> 因此，正如我们在上一节中确定的那样，可以将ImageNet上训练的网络的瓶颈功能用于其他任务的分类。  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" class="user_link">m0rtido</a>决定走得更远，并提出了以下策略： <br><br><ol><li> 我们采用了所有可用的经过预先训练的架构（特别是NasNet Large，InceptionV4，Vgg19，Vgg16，InceptionV3，InceptionResnetV2，Resnet-50，Resnet-101，Resnet-152，Xception，Densenet-169，Densenet-121，Densenet-201 ）并从中提取瓶颈标志。 我们还将计算图片的反射版本的标记（例如，简约的增幅）。 </li><li> 在SAR的帮助下，将每个模型的功能尺寸减小三倍，以使它们正常地适合我们可用的16 Gb RAM。 </li><li> 将这些特征连接成一个大特征向量。 </li><li> 我们将在所有这些之上教一个多层感知器，并产生预测。 我们还将训练<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">成折叠</a>并平均所有这些预测。 </li></ol><br> 产生的怪异堆积使整体整体的准确性大大提高。 <br><br><h4> 模型集合 </h4><br> 完成以上所有操作后，我们大约有十二个模糊的卷积网络，以及位于瓶颈标志上方的两个感知器。 问题是：如何从所有这一切中获得一个预测？ <br><br> 在最好的Kaggle传统中，以一种很好的方式，我们必须在所有这些之上<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">堆叠</a> ，但是为了进行OOF堆叠，我们既没有时间也没有GPU，并且在验证保持上训练顶级模型会导致很大的过拟合。 因此，我们决定为贪婪的合奏创建一个相当简单的算法： <br><br><ol><li> 初始化一个空的合奏。 </li><li> 我们尝试依次添加每个模型并考虑得分。 我们选择最能增加指标的模型，然后将其添加到集合中。 对集合中模型的预测结果进行简单平均。 </li><li> 如果没有一个模型可以提高性能，我们将进行整体测试并尝试从中删除模型。 如果结果是删除某些模型以提高分数，我们将执行此操作并返回到步骤2。 </li></ol><br> 作为指标 <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x5206;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x6570;</mo></mrow><mo>=</mo><mn>0.5</mn><mo>&amp;#x2217;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x51C6;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x786E;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x6027;</mo></mrow><mo>&amp;#x2212;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x5BF9;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x6570;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x635F;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x5931;</mo></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="28.455ex" height="2.298ex" viewBox="0 -780.1 12251.3 989.6" role="img" focusable="false" style="vertical-align: -0.487ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">分</text><g transform="translate(829,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">数</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/414865/&amp;usg=ALkJrhhXMDjHl6BGcHrt_C34IJdyT2Us7w#MJMAIN-3D" x="1937" y="0"></use><g transform="translate(2994,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/414865/&amp;usg=ALkJrhhXMDjHl6BGcHrt_C34IJdyT2Us7w#MJMAIN-30"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/414865/&amp;usg=ALkJrhhXMDjHl6BGcHrt_C34IJdyT2Us7w#MJMAIN-2E" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/414865/&amp;usg=ALkJrhhXMDjHl6BGcHrt_C34IJdyT2Us7w#MJMAIN-35" x="779" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/414865/&amp;usg=ALkJrhhXMDjHl6BGcHrt_C34IJdyT2Us7w#MJMAIN-2217" x="4495" y="0"></use><g transform="translate(5218,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">准</text></g><g transform="translate(6048,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">确</text></g><g transform="translate(6878,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">性</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/414865/&amp;usg=ALkJrhhXMDjHl6BGcHrt_C34IJdyT2Us7w#MJMAIN-2212" x="7930" y="0"></use><g transform="translate(8931,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">对</text></g><g transform="translate(9761,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">数</text></g><g transform="translate(10591,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">损</text></g><g transform="translate(11421,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">失</text></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mo>分</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>数</mo></mrow><mo>=</mo><mn>0.5</mn><mo>∗</mo><mrow class="MJX-TeXAtom-ORD"><mo>准</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>确</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>性</mo></mrow><mo>−</mo><mrow class="MJX-TeXAtom-ORD"><mo>对</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>数</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>损</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>失</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-2">分数= 0.5 *准确性-对数损失</script>  。 该公式是根据经验选择的 <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x7CBE;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x5EA6;</mo></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.855ex" height="2.298ex" viewBox="0 -780.1 1660 989.6" role="img" focusable="false" style="vertical-align: -0.487ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">精</text><g transform="translate(829,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">度</text></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mo>精</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>度</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-3">精度</script> 和 <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>l</mi><mi>o</mi><mi>g</mi><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.939ex" height="2.419ex" viewBox="0 -780.1 2987.5 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/414865/&amp;usg=ALkJrhhXMDjHl6BGcHrt_C34IJdyT2Us7w#MJMATHI-6C" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/414865/&amp;usg=ALkJrhhXMDjHl6BGcHrt_C34IJdyT2Us7w#MJMATHI-6F" x="298" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/414865/&amp;usg=ALkJrhhXMDjHl6BGcHrt_C34IJdyT2Us7w#MJMATHI-67" x="784" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/414865/&amp;usg=ALkJrhhXMDjHl6BGcHrt_C34IJdyT2Us7w#MJMATHI-6C" x="1264" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/414865/&amp;usg=ALkJrhhXMDjHl6BGcHrt_C34IJdyT2Us7w#MJMATHI-6F" x="1563" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/414865/&amp;usg=ALkJrhhXMDjHl6BGcHrt_C34IJdyT2Us7w#MJMATHI-73" x="2048" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/414865/&amp;usg=ALkJrhhXMDjHl6BGcHrt_C34IJdyT2Us7w#MJMATHI-73" x="2518" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi><mi>o</mi><mi>g</mi><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-4"> logloss </script> 原来是差不多的规模。 这样一个完整的指标与 <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x7CBE;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x5EA6;</mo></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.855ex" height="2.298ex" viewBox="0 -780.1 1660 989.6" role="img" focusable="false" style="vertical-align: -0.487ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">精</text><g transform="translate(829,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">度</text></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mo>精</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>度</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-5">精度</script> 在验证和公共排行榜上。 <br><br> 此外，在每次迭代中我们添加或删除一个模型（即模型权重始终保持为整数）的事实起到了一种正则化的作用，不允许整体在验证数据集下过度拟合。 <br><br> 结果，该合奏包括以下模型： <br><br> <a href=""><img src="https://habrastorage.org/webt/-o/bj/tb/-objtbfafz4roayenpmoqp0-ura.png"></a> <br><br><h2> 结果 </h2><br> 根据比赛结果，我们获得了第三名。 在我看来，成功的关键在于对集成算法的成功选择以及<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" class="user_link">m0rtido</a>和我在训练大量模型上投入的大量时间。 <br><br><img src="https://habrastorage.org/webt/jo/lm/oo/jolmooekmiu5ku-4fatlgnejfli.png"></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN414865/">https://habr.com/ru/post/zh-CN414865/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN414853/index.html">试玩，但要检查：引擎如何使设计师短路</a></li>
<li><a href="../zh-CN414855/index.html">可供任何即将学习的人使用的精选Python新书</a></li>
<li><a href="../zh-CN414857/index.html">加密市场创始人Ilya Stenkov的访谈</a></li>
<li><a href="../zh-CN414859/index.html">如何在Raspberry Pi或BeagleBone Blue上使用带有ROS的USB摄像机-将视频流传输到大型计算机</a></li>
<li><a href="../zh-CN414861/index.html">隧道建模-版本1.0</a></li>
<li><a href="../zh-CN414867/index.html">ThinkingHome.Migrator版本的.NET Core平台上的数据库架构迁移</a></li>
<li><a href="../zh-CN414869/index.html">消失的框架</a></li>
<li><a href="../zh-CN414871/index.html">火星上的沙尘暴达到了行星级，甚至好奇心也受到影响</a></li>
<li><a href="../zh-CN414873/index.html">IDisposable-您的妈妈没有谈论释放资源。 第一部分</a></li>
<li><a href="../zh-CN414875/index.html">Kubernetes容器集成取代Docker并投入生产</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>