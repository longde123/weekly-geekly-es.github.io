<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚§µÔ∏è üì∏ üßöüèª Simplifique las construcciones de edificios en Unity3D üë©‚Äçüé® ü§ó üë®üèº‚Äçü§ù‚Äçüë®üèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="M√°s recientemente, me di cuenta de que con el creciente n√∫mero de proyectos terminados, se debe dedicar m√°s y m√°s tiempo a la construcci√≥n de edificio...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Simplifique las construcciones de edificios en Unity3D</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/433460/"><p>  M√°s recientemente, me di cuenta de que con el creciente n√∫mero de proyectos terminados, se debe dedicar m√°s y m√°s tiempo a la construcci√≥n de edificios.  Esto no quiere decir que la unidad de alguna manera complica mucho este proceso, pero ciertamente no lo simplifica.  Especialmente cuando cada proyecto se ensambla para varias plataformas e incluso en diferentes configuraciones.  En principio, el problema no es nuevo y tiene muchas soluciones diferentes.  Pero por varias razones, decid√≠ escribir mi propio complemento. </p><br><p>  Se parece a esto: </p><br><p><img src="https://habrastorage.org/webt/da/_r/yz/da_ryzek6oeheil25xrraw_m8xo.png"></p><br><p>  Y por qu√©, por qu√©, d√≥nde conseguirlo y c√≥mo usarlo, lo contar√© a continuaci√≥n. </p><a name="habracut"></a><br><h3 id="bol">  Dolor </h3><br><p>  El primer malestar generalmente se siente cuando se prepara m√°s de una plataforma para su lanzamiento.  Resulta que en la unidad algunas configuraciones de proyecto son comunes para todas las plataformas, y otras no.  Y esto siempre debe ser recordado y tomado en cuenta.  Pero en general puedes vivir. </p><br><p>  Entonces resulta que no hay forma de guardar diferentes configuraciones dentro de la misma plataforma.  Un ejemplo simple: solo hay una compilaci√≥n, pero hay muchos sitios en los que se distribuir√°.  Y para cada uno necesitas algo diferente.  Este problema se resuelve parcialmente poniendo la configuraci√≥n en la configuraci√≥n de tiempo de ejecuci√≥n en StreamingAssets.  Pero solo parcialmente, porque de esta manera solo puedes configurar lo que est√° sucediendo dentro del juego.  No puede reemplazar un icono de esta manera.  Cada vez que necesite cambiar el √≠cono usted mismo.  Ya sea por c√≥digo, por manos, pero por ti mismo.  Y en alg√∫n momento, el gerente responsable a quien entren√≥ para trabajar con StreamingAssets durante un mes se va de vacaciones y ayer se necesitan construcciones. </p><br><p>  M√°s adelante, descubrir√° que se planea una versi√≥n coreana separada, que todo deber√≠a ser diferente all√≠ y que no puede prescindir de #ifdef aqu√≠. </p><br><p>  Y luego te dicen que el juego debe ser lanzado en plataformas m√≥viles, playstation, nintendo y lavadoras. </p><br><p>  Como resultado, la preparaci√≥n de cada nueva construcci√≥n a lo largo del tiempo se vuelve similar a esto: </p><br><p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/3/30/STSCPanel.jpg/640px-STSCPanel.jpg"></p><br><p>  <em>Verifique las lecturas, encienda el interruptor de palanca a la izquierda, gire la palanca a la derecha, apriete la v√°lvula roja.</em>  <em>No confundas y no olvides.</em> </p><br><p>  Al principio, a√∫n puede ser nada, pero se cansa r√°pidamente.  Y recuerda todas las manipulaciones en un mes o dos. </p><br><h3 id="kakie-vashi-varianty">  Cuales son tus opciones? </h3><br><p>  Internet y la sabidur√≠a popular nos ofrecen lo siguiente: </p><br><ul><li>  Resolver un problema a nivel de proyecto.  Las implementaciones de este enfoque pueden ser diferentes: proyectos separados con c√≥digo y activos comunes, subm√≥dulos en un git, ramas en un git y similares. <br>  No puedo considerar esto seriamente.  Para cercar un jard√≠n en aras de reemplazar el icono, y luego tambi√©n apoyarlo.  Todo un aficionado.  Pero lo vio con sus propios ojos, por lo que no pudo evitar mencionarlo. </li><li>  Bash / bat / python / ... scripts. <br>  Ya mas calido.  Pero requiere conocimiento adicional y es dif√≠cil llamarlo multiplataforma (a menudo parte del equipo se desarrolla bajo los makos, parte bajo Windows).  Una vez m√°s, los scripts deben ser compatibles, y este no es siempre el momento. </li><li>  Script de editor en la propia unidad. <br>  Muy c√°lido  Rotamos el proyecto dentro de la unidad como queramos.  Y si utiliza el m√©todo est√°tico y BuildPipeline, puede configurar CI.  Como regla, los art√≠culos sobre la unidad y CI describen esto.  Sin embargo, un inconveniente del enfoque anterior permanece aqu√≠: este es el c√≥digo y debe escribirse, agregarse y mantenerse.  Necesitamos algo similar, pero sin la necesidad de que cada plataforma y configuraci√≥n ingrese al c√≥digo. </li></ul><br><p>  Est√° resuelto.  Estamos escribiendo nuestro complemento, con UI y hadas. </p><br><h3 id="nam-nuzhen-plan">  Necesitamos un plan </h3><br><p>  Primero debe decidir qu√© queremos obtener y por qu√©. </p><br><ol><li>  Almacenamiento de la configuraci√≥n del proyecto para cada configuraci√≥n (aqu√≠ puede ir a la terminolog√≠a del complemento en s√≠ y llamarlas opciones).  Es deseable implementar la herencia de opciones.  Por ejemplo, para todas las compilaciones independientes, la configuraci√≥n del proyecto ser√° com√∫n, y las opciones entre s√≠ solo diferir√°n en el icono y el nombre del proyecto.  Es bastante l√≥gico resolver esto por herencia, en lugar de copiar y pegar. </li><li>  Representaci√≥n visual de lo que var√≠a en una realizaci√≥n particular y c√≥mo difiere de la configuraci√≥n actual del proyecto. </li><li>  Combinando opciones en una colecci√≥n.  Para poder recopilar un subconjunto de compilaciones con un bot√≥n o un m√©todo est√°tico a la vez. </li><li>  Embalaje de la compilaci√≥n en el archivo.  Este es un requisito opcional.  En el caso de usar el complemento en conjunto con el servidor de compilaci√≥n, este elemento se puede implementar de forma paralela.  Pero quiero simplificar la vida para simplificar todo, pero no siempre hay un servidor de compilaci√≥n. </li><li>  Mover archivos en diferentes etapas de ensamblaje.  Por ejemplo, debe reemplazar alg√∫n activo (icono, bienvenida, escena, etc.) antes de ensamblar (reemplazar los activos en este caso debe ser reversible, la construcci√≥n de la construcci√≥n no debe cambiar el estado actual del proyecto).  O cambie el nombre de la compilaci√≥n de Windows terminada {exe_name} _Data to Data (comportamiento de unidad muy molesto, sin esta manipulaci√≥n no puede cambiar el nombre del ejecutable).  O, de nuevo, en las compilaciones de Windows, organice los StreamingAssets necesarios.  Debe hacer esto antes de empaquetar el archivo.  Y luego, por ejemplo, arrastre todos los archivos a alg√∫n lugar en un lugar. </li><li>  Los proyectos de unidad tienen una gran cantidad de configuraciones y no queremos escribir nuestra propia interfaz de usuario para todos ellos.  Adem√°s, √©l ya est√° en la unidad misma.  Por lo tanto, cambiaremos la configuraci√≥n del proyecto como de costumbre, y en el complemento simplemente seguimos los cambios en la configuraci√≥n y guardamos las opciones necesarias. </li><li>  Me gustar√≠a almacenar cada opci√≥n en un archivo separado para que sea posible arrastrarlas entre proyectos. </li><li>  Es recomendable trabajar con Unity desde la versi√≥n 5.6.  Hay algunos proyectos heredados con mucho alboroto en torno a las compilaciones. </li></ol><br><h3 id="pognali">  Condujo </h3><br><p>  La parte principal de nuestro complemento es trabajar con la configuraci√≥n del proyecto, as√≠ como almacenar y procesar opciones de configuraci√≥n individuales.  Por lo tanto, nos centraremos en esto. </p><br><p>  La unidad almacena todas las configuraciones en el directorio ProjectSettings en la ra√≠z del proyecto.  Y lo primero al iniciar guardaremos esta configuraci√≥n en el directorio de complementos (por cierto, se trata de BuildVariants en la ra√≠z del proyecto).  Esto es necesario para que podamos rastrear todos los cambios posteriores.  A continuaci√≥n, tenemos que almacenarlos de alguna manera.  Lo m√°s f√°cil ser√≠a simplemente copiar ProjectSettings a una ubicaci√≥n separada para cada opci√≥n.  Y en el momento de su activaci√≥n, simplemente reempl√°celos enteros.  La idea est√° funcionando bastante y al principio lo consider√©.  Pero esto nos priva por completo de la oportunidad de heredar opciones.  Y si ya estamos escribiendo un complemento, lo haremos de inmediato de manera hermosa.  Por lo tanto, debemos aprender a leer y escribir el contenido de ProjectSettings. </p><br><p>  Para hacer esto, debe comprender lo que est√° almacenado all√≠.  Y los activos m√°s comunes se almacenan all√≠, que se serializan y deserializan de manera regular.  Esto significa que podemos leerlos a trav√©s de AssetsDatabase y obtener SerializedObject.  Esto ya es algo.  Debido a que podemos pasar por toda la Propiedad Serializada, rastrear sus diferencias con la "instant√°nea" original y guardarlas como una variante.  Luego, al ensamblar o activar la variante, recopilamos los cambios a lo largo de toda la cadena de herencia, los aplicamos a la "instant√°nea" y los deslizamos en ProjectSettings.  Voila </p><br><p>  Pero SerializedProperty tiene algunas caracter√≠sticas desagradables: una forma de almacenar valores (todos estos intValue, floatValue, isArray), la falta de un mecanismo normal para compararlos (hay dos objetos relacionados, ¬øc√≥mo entendemos si todos los SerializedProperty tienen los mismos valores?) Y parad√≥jico (y tal vez no) la ausencia del atributo Serializable (lo que significa que necesitaremos un contenedor para guardar).  No puedo decir que estos son algunos defectos fatales. Todo esto se ha hecho m√°s de una vez en numerosos guiones de editor.  Pero a√∫n quiero algo m√°s simple, comprensible y universal. </p><br><p>  ¬øO tal vez limitaremos ligeramente el uso de nuestro complemento?  Deje que funcione solo en proyectos con serializaci√≥n de activos basada en texto (¬øalguien m√°s usa binario?).  Luego, todos los ProjectSettings se almacenar√°n como documentos yaml.  Puede tomar la biblioteca YamlDotNet y usarla para analizar y guardar la configuraci√≥n.  Al mismo tiempo, almacene sus configuraciones en yaml.  As√≠ que a√∫n m√°s claramente.  Solo necesita agregar algunas extensiones para diferencias de documentos yaml y su combinaci√≥n. </p><br><p>  Alborotarse un poco con la ventana del editor (ni siquiera quiero describir, espero que vivir con UIElements sea m√°s f√°cil y m√°s divertido), se hace todo en un mont√≥n. </p><br><h3 id="rezultat">  Resultado </h3><br><p>  Es hora de mostrar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">lo que hice</a> .  Ya se ha familiarizado con los principales mecanismos de la operaci√≥n del complemento, por lo tanto, se trata de una tesis adicional sobre algunas caracter√≠sticas: </p><br><ul><li>  Las opciones se agregan a la colecci√≥n seleccionada utilizando una marca de verificaci√≥n a la izquierda del nombre. </li><li>  La ruta de compilaci√≥n debe especificarse con la extensi√≥n.  No encontr√© una lista completa de extensiones para todos los BuildTarget posibles, as√≠ que lo dej√© hasta ahora. </li><li>  Mover archivos se hereda de la misma manera que la configuraci√≥n. </li><li>  No se han implementado matrices de diferencias.  Por lo tanto, si en la versi√≥n heredada cambi√≥ algo en la lista de escenas, la lista completa se reemplazar√° por completo.  El bien deber√° ser finalizado. </li><li>  La configuraci√≥n actual del proyecto diff es una lista de todas las diferencias entre la opci√≥n seleccionada y la configuraci√≥n actual del proyecto.  Adem√°s, si se selecciona la opci√≥n activa, se pueden deshacer los cambios en la configuraci√≥n actual. </li><li>  Las configuraciones de variantes son, en consecuencia, cambios individuales en la opci√≥n seleccionada, excluyendo los cambios parentales. </li><li>  Cuando se activa la opci√≥n, se perder√°n todos los cambios no guardados en la configuraci√≥n del proyecto. </li><li>  Si hay cambios no guardados en la configuraci√≥n del proyecto, cualquier intento de compilar la compilaci√≥n a trav√©s del complemento finalizar√° con la ejecuci√≥n.  Porque ver arriba, y como recordamos, la construcci√≥n de la construcci√≥n no deber√≠a cambiar el estado actual del proyecto. </li><li> El complemento se puede usar junto con el servidor de compilaci√≥n.  Existen m√©todos est√°ticos para esto: BuildVariants.Controller.BuildController.BuildAll, BuildVariants.Controller.BuildController.BuildCollection (con el nombre de la colecci√≥n en el par√°metro -collection) y BuildVariants.Controller.BuildController.BuildVariant (con el nombre de la variante en el par√°metro -variante).  Se ver√° m√°s o menos as√≠: <br> <code>$unity_path -batchmode -projectPath $project_path -quit -logfile -executeMethod BuildVariants.Controller.BuildController.BuildCollection -collection standalone</code> </li> <li>  Para archivar, el complemento tiene otra dependencia en forma de biblioteca DotNetZip. </li><li>  El complemento se escribi√≥ en las condiciones de una peque√±a pausa de trabajo, por lo que todav√≠a no hay oportunidad de probarlo y moderarlo en feroces batallas.  Puede haber errores, tal vez incluso malos y desagradables. </li></ul><br><h3 id="plany-na-buduschee">  Planes futuros </h3><br><p>  Por supuesto, quiero alimentar las caracter√≠sticas del complemento indefinidamente, pero es hora de volver a proyectos reales y, al mismo tiempo, probar la funcionalidad existente.  Un poco m√°s tarde quiero aplicar UIElements para nuevas versiones de la unidad, espero que esto lo haga m√°s hermoso y conveniente.  Tambi√©n me gustar√≠a atornillar versiones y algunas semejanzas de variables de entorno.  Tal vez el p√∫blico le dir√° algo m√°s sobre funcionalidad o usabilidad. </p><br><p>  Por lo tanto, me complacer√° recibir sugerencias, comentarios, preguntas e informes de errores.  ¬°Construcciones f√°ciles para ti! </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es433460/">https://habr.com/ru/post/es433460/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es433442/index.html">Entity Framework Core 2.2 lanzado. Que hay de nuevo (3 de 3)</a></li>
<li><a href="../es433446/index.html">Semana de la seguridad 51: error en WordPress 5.0 y software Logitech, vulnerabilidad de fotos en Facebook</a></li>
<li><a href="../es433448/index.html">An√°lisis comparativo de mercados usados. Autos alemanes y franceses en el segmento B y C</a></li>
<li><a href="../es433450/index.html">Crece y ense√±a. C√≥mo nos hicimos amigos de PEGA</a></li>
<li><a href="../es433456/index.html">C√≥mo convencer a un cliente o empresa para que use Flutter</a></li>
<li><a href="../es433466/index.html">Compara p√°ginas. Complemento simple para Atlassian Confluence</a></li>
<li><a href="../es433468/index.html">Inyecci√≥n de fallas: su sistema no es confiable si no ha intentado romperlo</a></li>
<li><a href="../es433472/index.html">Lanzamiento de Unity 2018.3</a></li>
<li><a href="../es433474/index.html">Pylint de adentro hacia afuera. Como lo hace</a></li>
<li><a href="../es433476/index.html">50 tonos de apio</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>