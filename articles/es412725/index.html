<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üò∂ üì¢ üõèÔ∏è C√≥mo hacer que su infraestructura de TI sea aburrida üèúÔ∏è üöà üëì</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Michael DeHaan es el hombre que cre√≥ Ansible. Muchas de las cosas que los administradores de sistemas, la versi√≥n y los ingenieros de DevOps hacen reg...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>C√≥mo hacer que su infraestructura de TI sea aburrida</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/redhatrussia/blog/412725/">  Michael DeHaan es el hombre que cre√≥ Ansible.  Muchas de las cosas que los administradores de sistemas, la versi√≥n y los ingenieros de DevOps hacen regularmente son, por decirlo suavemente, poco interesantes.  DeHaan quiere que estas personas liberen su tiempo para cosas m√°s interesantes (en el trabajo o fuera de la puerta de la oficina) y escriban un c√≥digo de producto que libere el tiempo del administrador. <br>  M√°s tiempo, menos adrenalina durante el horario comercial, menos guiones y menos errores. <br>  Por cierto, puede terminar de leer este p√°rrafo conect√°ndose a livestream el 6 de junio <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu√≠</a> . <br><br><img src="https://habrastorage.org/webt/4p/xi/b6/4pxib6asllealgf8sje7orcjsbg.png" width="100%"><br><a name="habracut"></a><br>  Si a√∫n segu√≠as leyendo ... <br><br><h3>  Ansible: Integraci√≥n continua y entrega </h3><br>  Ansible es un poderoso lenguaje de automatizaci√≥n de c√≥digo abierto.  S√≠, es excelente no solo para la administraci√≥n, sino tambi√©n para la implementaci√≥n y la orquestaci√≥n de los sistemas de TI.  Ansible se cre√≥ originalmente para resolver eficazmente una amplia gama de tareas de automatizaci√≥n y como una base universal simple para reemplazar los controles tradicionales, pero al final result√≥ ser muy √∫til en muchas √°reas.  Por ejemplo, al tiempo que garantiza un tiempo de inactividad cero durante la integraci√≥n continua y la entrega de aplicaciones (CI / CD).  Por lo general, este problema se resuelve debido al refinamiento extenso del software, el uso de varios paquetes de software y muchos trucos √∫nicos para cada configuraci√≥n espec√≠fica.  Ansible fue originalmente dise√±ado espec√≠ficamente para tales escenarios de orquestaci√≥n y ofrece una soluci√≥n llave en mano "todo en uno". <br><br><h3>  Integraci√≥n continua y entrega de aplicaciones (CI / CD) </h3><br>  Algunas verdades comunes.  La pr√°ctica de desarrollar sistemas de software en los √∫ltimos 10 a√±os muestra que el largo ciclo de vida de las versiones de software (modelo de desarrollo en cascada) tiene una sobrecarga mucho mayor en comparaci√≥n con un ciclo corto (el llamado desarrollo "iterativo" o √°gil).  Se trata de una arritmia: cuando los programadores reci√©n comienzan a trabajar en una nueva versi√≥n, el personal de TI responsable de las pruebas y la implementaci√≥n simplemente no tiene nada que hacer.  Pero cuanto m√°s se acerca la versi√≥n al lanzamiento, m√°s ocupados est√°n los profesionales de TI y m√°s a menudo los programadores tienen que cambiar los contextos, alternando entre trabajar en errores y planificar la pr√≥xima versi√≥n. <br><br><img src="https://habrastorage.org/webt/qv/sl/b1/qvslb1fsnltkxftsz2hxtgebghg.png" align="right">  Adem√°s, un ciclo largo aumenta el intervalo entre la identificaci√≥n y la eliminaci√≥n de errores de software y deficiencias, lo cual es especialmente cr√≠tico para grandes sistemas web con una audiencia de usuarios multimillonaria.  Por lo tanto, la industria del software est√° adoptando r√°pidamente metodolog√≠as √°giles bajo el lema "lanzar m√°s r√°pido y con m√°s frecuencia" para que los participantes en el proceso de desarrollo puedan cambiar su contexto de trabajo con menos frecuencia y crear, depurar e implementar mejoras e innovaciones mucho m√°s r√°pido. <br><br>  La automatizaci√≥n del control de calidad, el desarrollo de TDD a trav√©s de pruebas y otras t√©cnicas relacionadas aumentan a√∫n m√°s la efectividad de los nuevos m√©todos de trabajo.  ¬øD√≥nde est√° la automatizaci√≥n?  ¬øD√≥nde est√°n las tecnolog√≠as que hacen que los engranajes giren m√°s r√°pido y reducen la participaci√≥n humana al m√≠nimo estrictamente necesario? <br><br>  Y aqu√≠, por ejemplo, la torre Ansible y Ansible Tower de Red Hat para orquestar sistemas de TI como parte de los procesos modernos de desarrollo de software. <br><br><h3>  Tiempo de inactividad cero </h3><br>  Un poco m√°s obvio.  El tiempo de inactividad significa ganancias perdidas y clientes insatisfechos.  Por lo tanto, en los sistemas de colas web, cuyos usuarios se distribuyen en todas las zonas horarias, el apagado programado solo se permite en casos realmente graves, cuya lista no incluye expl√≠citamente la actualizaci√≥n de las versiones de la aplicaci√≥n.  La situaci√≥n es similar en entornos corporativos donde la inaccesibilidad de una intranet o un sistema de contabilidad reduce dr√°sticamente la productividad de los empleados.  Por lo tanto, cualquier automatizaci√≥n de procesos debe proporcionar actualizaciones sin interrumpir las operaciones, en otras palabras, con un tiempo de inactividad cero. <br><br>  Es muy posible lograr un tiempo de inactividad cero, pero para esto necesitamos herramientas apropiadas, como proporcionar una orquestaci√≥n avanzada, de m√∫ltiples niveles y etapas, como, por ejemplo, el sistema Ansible. <br><br><h3>  Sistemas de construcci√≥n de aplicaciones </h3><br>  La entrega continua (CD) comienza con la integraci√≥n continua (CI).  Un sistema que supervisa los repositorios de c√≥digo fuente en busca de cambios, ejecuta independientemente las pruebas correspondientes y crea autom√°ticamente (e idealmente prueba) una nueva versi√≥n de la aplicaci√≥n con cada actualizaci√≥n de c√≥digo, por ejemplo, el proyecto Jenkins (jenkins.io). <br><br>  Para transmitir el testigo al sistema de CD despu√©s de ensamblar con √©xito la nueva versi√≥n de la aplicaci√≥n, el subsistema de compilaci√≥n del sistema CI puede llamar a Ansible para proporcionar de inmediato esta nueva versi√≥n a aquellos que realizan pruebas de unidad o integraci√≥n.  En particular, Jenkins puede usar Tower para desplegar ensamblajes en diversos entornos, y el entorno de prueba o intermedio se puede modelar en funci√≥n del entorno de producci√≥n, lo que mejora en gran medida la previsibilidad durante todo el ciclo de vida del software.  Los datos devueltos por Ansible de los resultados de la ejecuci√≥n de scripts de automatizaci√≥n pueden estar directamente involucrados en los trabajos de Build Systems del sistema Tower.  De hecho, Tower incluso le permite probar escenarios de implementaci√≥n en un entorno intermedio antes de ejecutarlos en servidores de "combate". <br><br><h3>  Actualizaci√≥n de aplicaciones multinivel una por una </h3><br>  El sistema de CD debe poder organizar los procesos de actualizaci√≥n continua de las aplicaciones multinivel.  Gracias a la arquitectura de inserci√≥n y las capacidades de la orquestaci√≥n de m√∫ltiples niveles y m√∫ltiples etapas, Ansible puede hacer frente a esta tarea actualizando cualquier aplicaci√≥n nivel por nivel, mientras intercambia datos entre ellos. <br><br>  Para implementar actualizaciones una por una, Ansible utiliza scripts de Play que le permiten especificar con precisi√≥n el grupo de hosts de destino y asignar tareas (Rol) que deben realizarse en ellos.  Por lo general, las tareas son anuncios de que un recurso de TI espec√≠fico debe estar en un estado determinado, por ejemplo, para una versi√≥n de un software se debe instalar un paquete determinado y para otro es necesario verificar el repositorio de c√≥digo.  Las topolog√≠as de aplicaciones web, por regla general, requieren actualizarlas en un orden estricto, y a√∫n no puede actualizar las aplicaciones y las configuraciones del sistema en todas las m√°quinas al mismo tiempo. <br><br>  Cuando se reinicia el servicio, no est√° disponible por alg√∫n tiempo, y el reemplazo de la versi√≥n de la aplicaci√≥n tampoco ocurre instant√°neamente.  Por lo tanto, antes de actualizar el sistema, lo retiramos del grupo de equilibrio.  Como resultado, necesita la capacidad de automatizar las operaciones de conectar y desconectar m√°quinas del grupo.  Consistentemente es la palabra clave.  Ansible puede controlar con mucha precisi√≥n el tama√±o de la ventana de una actualizaci√≥n sucesiva.  Bueno, el desarrollo de tales actualizaciones se lleva a cabo con mucho cuidado, y si en alg√∫n momento ocurre una falla, la actualizaci√≥n se suspende para no deshabilitar el resto de la infraestructura de TI. <br><br><h3>  Implementaci√≥n continua para scripts de automatizaci√≥n </h3><br>  Adem√°s de la funcionalidad de CD para servicios que operan en modo de operaci√≥n comercial, tambi√©n puede organizar la implementaci√≥n continua de los propios scripts de automatizaci√≥n (conjuntos de instrucciones Ansible Playbook. No deje de leer, en la segunda parte habr√° ejemplos de libros de jugadas).  Esto permite a los administradores y desarrolladores del sistema administrar los scripts utilizando el repositorio de c√≥digo fuente, probar estos scripts en un entorno intermedio y transferirlos autom√°ticamente al entorno de producci√≥n en caso de un robo exitoso.  En otras palabras, cuando trabaja con scripts, obtiene todas las ventajas metodol√≥gicas y de otro tipo del repositorio de c√≥digo central al que est√° acostumbrado cuando desarrolla software. <br><br>  Realizar cambios en el software y las configuraciones del sistema es una de las principales razones de las interrupciones no planificadas.  Por lo tanto, adem√°s de las pruebas automatizadas, existe un control humano.  Se puede organizar mediante la integraci√≥n con un sistema de inspecci√≥n de c√≥digo como <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Gerrit</a> , y aplicar los cambios solo despu√©s de que sean aprobados por los camaradas responsables. <br><br><h3>  Actualizaciones alternativas y sistemas de equilibrio de carga. </h3><br>  Ansible funciona de manera muy independiente con los sistemas de equilibrio de carga cuando realiza actualizaciones sucesivas.  Por lo tanto, simplemente puede escribir en un script de Playbook, en cualquier ciclo para un grupo de hosts, algo as√≠ como "realizar esta acci√≥n en el sistema X en nombre del host Y", y Ansible se encargar√° del resto. <br><br>  Ansible interact√∫a bien con los equilibradores de carga de todo tipo y puede establecer un indicador para desconectar temporalmente un host para desactivar la supervisi√≥n de disponibilidad durante el per√≠odo de actualizaci√≥n.  El esquema simple "apagar el monitoreo - eliminar del grupo - actualizar el nivel de software deseado - regresar al grupo - activar el monitoreo" implementa f√°cilmente una actualizaci√≥n secuencial con tiempo de inactividad cero y sin falsas alarmas.  Y todo esto en un modo totalmente automatizado, sin intervenci√≥n del operador. <br><br><h3>  Pruebas intermedias integradas </h3><br>  Tower puede trabajar con varios archivos de inventario de recursos (Inventory), lo que facilita probar escenarios de actualizaci√≥n sucesivos en un entorno intermedio antes de ejecutarlos en servidores de "batalla".  Para hacer esto, es suficiente simular el entorno de producci√≥n en el entorno de prueba, ejecutar Ansible con el par√°metro "-i" e indicar qu√© archivo de inventario debe usarse al ejecutar el script, para el entorno de prueba o para el entorno de producci√≥n.  El script en s√≠ no necesita ser modificado. <br><br><h3>  Implementaci√≥n de control de versiones </h3><br>  A algunas personas les gusta empacar aplicaciones junto con paquetes del sistema operativo (RPM, debs, etc.) m√°s calientes, pero a menudo, especialmente para aplicaciones web, dicho empaque no es necesario.  Por lo tanto, Ansible incluye varios m√≥dulos para implementar aplicaciones directamente desde los sistemas de control de versiones.  En la secuencia de comandos de Playbook, puede escribir una reconciliaci√≥n con el repositorio de c√≥digo para la etiqueta o el n√∫mero de versi√≥n especificados, despu√©s de lo cual Ansible verificar√° esta condici√≥n en todos los servidores de destino y activar√° los siguientes pasos solo si la versi√≥n necesita ser reemplazada, eliminando as√≠ reinicios de servicio innecesarios. <br><br><h3>  Integraci√≥n con herramientas de monitoreo </h3><br>  Como un sistema de orquestaci√≥n completo, Ansible admite la integraci√≥n con sistemas de gesti√≥n de rendimiento de aplicaciones basados ‚Äã‚Äãen APM a nivel de monitoreo.  Por ejemplo, durante la fase de prueba de implementaci√≥n o integraci√≥n, debe instalar o actualizar el agente de software APM con la aplicaci√≥n.  Ansible tiene un papel especial para esto, y despu√©s de instalar y activar el agente, Ansible puede configurarlo en la pila de monitoreo APM (si a√∫n no est√° configurado) para que los administradores de aplicaciones puedan verificar de inmediato que la nueva versi√≥n se ha instalado y funciona sin problemas . <br><br>  Si algo sali√≥ mal despu√©s de actualizar la aplicaci√≥n en el entorno de producci√≥n, las herramientas de monitoreo pueden llamar a Ansible para volver a la versi√≥n anterior.  Por supuesto, solo si se permite dicha reversi√≥n. <br><br><h3>  Notificaci√≥n de evento </h3><br>  En el paradigma de CI / CD, todos quieren recibir notificaciones de eventos lo m√°s r√°pido posible.  Ansible ofrece funciones integradas, incluido un m√≥dulo de correo electr√≥nico, as√≠ como la integraci√≥n con herramientas de notificaci√≥n externas, como mensajer√≠a instant√°nea, redes sociales o sistemas de registro de eventos. <br><br><h3>  Implementaci√≥n utilizando un modelo de estado de recursos </h3><br>  Una de las caracter√≠sticas clave de Ansible, que lo convierte en una herramienta muy √∫til para implementar aplicaciones, es el uso regular del modelo de estado de recursos en los procesos de actualizaci√≥n de software, que ha ganado popularidad en la gesti√≥n de las configuraciones del sistema.  A diferencia de los controles tradicionales de c√≥digo abierto, Ansible no necesita estar equipado con ning√∫n software adicional o scripts especiales para organizar la entrega de la aplicaci√≥n. <br><br>  En Ansible, puede registrar y controlar con mucha precisi√≥n el orden de los eventos en diferentes niveles arquitect√≥nicos, lo que le permite delegar acciones a otros sistemas, as√≠ como combinar directivas del modelo de recursos (como ‚Äúel paquete X debe estar en estado Y‚Äù) y los comandos de script tradicionales (como ‚Äúejecutar script .sh ") dentro de un proceso. <br><br>  Ansible tambi√©n facilita la ejecuci√≥n de verificaciones de diversas condiciones y la toma de decisiones en funci√≥n de sus resultados.  La combinaci√≥n de los procesos de configuraci√≥n del sistema y el despliegue de aplicaciones dentro de una sola cadena de herramientas es mucho m√°s eficiente que un esquema con varias herramientas especializadas y, adem√°s, aumenta la coherencia de las pol√≠ticas y aplicaciones del sistema operativo. <br><br><h3>  Prueba de implementaci√≥n </h3><br>  Cuantas m√°s oportunidades, mayor es la responsabilidad.  La automatizaci√≥n de los procesos de entrega continua aumenta dr√°sticamente el riesgo de implementar una configuraci√≥n fallida en todos los nodos del sistema.  Para reducir los riesgos, Ansible sugiere insertar pruebas de control en el script, lo que interrumpir√° la actualizaci√≥n secuencial si algo sale mal.  Para probar varias condiciones, incluido el estado del funcionamiento de los servicios, puede implementar pruebas arbitrarias utilizando los m√≥dulos Command o Script, e incluso crear tales pruebas como m√≥dulos Ansible separados. <br><br>  El m√≥dulo Fail puede interrumpir la ejecuci√≥n del script en el host en cualquier momento, lo que le permite detectar fallas en una etapa temprana de la actualizaci√≥n secuencial.  Por ejemplo, debido a la diferencia entre el entorno intermedio y el entorno de producci√≥n, este √∫ltimo genera un error de configuraci√≥n, que desactiva los servidores de "combate".  En este caso, se puede registrar una salida de emergencia en el script de Playbooks en la primera etapa de la actualizaci√≥n secuencial.  Y si tiene 100 servidores, y el tama√±o de la ventana de actualizaci√≥n sucesiva es 10, una parada de emergencia de este tipo le dar√° tiempo para resolverlo con calma, corregir el script y continuar actualizando. <br><br>  En caso de falla, Ansible no contin√∫a trabajando, dejando los sistemas en un estado semiconfigurado, y genera un error para atraer la atenci√≥n del operador y decirle qu√© host se produjo el ciclo de actualizaci√≥n con errores y cu√°ntos cambios se realizaron en cada plataforma.  Ansible tiene un modo de ejecuci√≥n de simulaci√≥n, cuando el sistema genera un informe sobre los cambios que se habr√≠an realizado si el script se hubiera ejecutado sin su ejecuci√≥n real. <br><br><h3>  Verificaci√≥n de cumplimiento </h3><br>  Hay entornos donde las configuraciones cambian solo cuando no hay forma de hacerlo sin √©l.  Cualquier cambio en dichos entornos se analiza previamente.  Utiliza sistemas de entrega continua "con reservas". <br><br>  Ansible tiene un modo de ejecuci√≥n de simulaci√≥n (activado por el indicador "--check"), cuando el sistema genera un informe sobre los cambios que se realizar√≠an cuando se ejecutara el script.  En este caso, la ejecuci√≥n real del script no ocurre, la ejecuci√≥n de la simulaci√≥n no permite detectar errores, pero ayuda a comprender y analizar mejor los detalles y resultados de los cambios propuestos. <br><br>  Por otro lado, incluso con el despliegue continuo de nuevos ensamblajes, Ansible le permite ejecutar verificaciones de conformidad con mucha m√°s frecuencia para detectar el momento en que algunas cosas en el entorno de producci√≥n cambian como resultado de la intervenci√≥n humana y deben corregirse ejecutando el script correspondiente de Ansible, por ejemplo, para cambiar versi√≥n de software, ajustar permisos, etc. <br><br><h3>  Despliegue de piloto autom√°tico </h3><br>  Si vives en un mundo de orquestaci√≥n de m√∫ltiples niveles y m√∫ltiples etapas de procesos de actualizaci√≥n de software secuenciales con tiempo de inactividad cero, lo m√°s probable es que CI / CD sea realizado exclusivamente por operadores (tanto manualmente como con automatizaci√≥n parcial) y requiera, como en un baile redondo, acciones coordinadas de todos los participantes del proceso.  Ansible, junto con su arquitectura √∫nica y la ausencia de agentes de software en los hosts de destino (lo que aumenta la seguridad y elimina la necesidad de administrar el sistema de gesti√≥n en s√≠), puede describir y automatizar f√°cilmente procesos de implementaci√≥n complejos, es decir, Ansible implementa el modo de piloto autom√°tico completo aqu√≠. <br><br>  Se pueden encontrar ejemplos de scripts de automatizaci√≥n Ansible en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">GitHub</a> , y ahora daremos una base y un ejemplo de c√≥mo escribir un script de Playbook que se puede ejecutar en Ansible o Ansible Tower.  Junto con una <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">lista de m√≥dulos</a> y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">otros documentos,</a> ella lo ayudar√° a aprender c√≥mo crear sus propios scripts de Playbooks. <br><br><h3>  ¬øQu√© es un libro de jugadas? </h3><br>  Un script de Playbook es esencialmente un conjunto de jugadas que se env√≠a para ejecutarse en un √∫nico host remoto o grupo de hosts.  Es como una gu√≠a de ensamblaje de muebles de IKEA: siga las instrucciones exactamente y obtenga exactamente lo que vio en la tienda.  As√≠ funcionan los guiones. <br><br><h3>  M√≥dulos </h3><br>  Crearemos un Playbook que instalar√° el servidor web en el host RHEL / CentOS 7 y crearemos un archivo index.html basado en la plantilla especificada en el script.  El script de muestra que se muestra aqu√≠ est√° en pleno funcionamiento y listo para usar.  A continuaci√≥n, veremos un script de Playbook de ejemplo y mostraremos c√≥mo usar los m√≥dulos. <br><br><h3>  Autores (Autores) </h3><br>  Un autor es alguien que crea instrucciones que ser√°n ejecutadas por m√≥dulos (a menudo junto con valores adicionales: argumentos, ubicaciones, etc.).  Los m√≥dulos se ejecutan en el host de destino en el orden en que se siguen en el script de Playbook (incluidos include'y y otros archivos adicionales incluidos en √©l).  El estado del host cambia (o no cambia) seg√∫n los resultados de la ejecuci√≥n del m√≥dulo, que se muestran en forma de salida Ansible y Tower. <br><br><h3>  Ejecuci√≥n de guiones de Playbook </h3><br>  Primero, hay algunas cosas que debe saber sobre la ejecuci√≥n de scripts de Playbook.  Playbook es un tipo de sistema simb√≥lico que informa al m√≥dulo sobre la necesidad de realizar alguna tarea.  Para iniciar con √©xito su Playbook, es importante comprender los siguientes puntos: <br><br>  <b>1. Sistema de destino (Target)</b> <br>  Debido a que los scripts de Playbook proporcionan instrucciones e interact√∫an con los m√≥dulos, Ansible cree que usted comprende lo que est√° tratando de hacer y simplemente lo automatiza.  Es por eso que decimos que los Playbooks son como instrucciones o instrucciones: le dices a los elementos automatizados c√≥mo quieres configurar la tarea.  Pero al mismo tiempo, usted mismo debe comprender muy bien c√≥mo funciona el host de destino en el que se ejecuta el script Playbook. <br><br>  <b>2. Tareas</b> <br>  Si necesita iniciar un servidor web en alguna parte de Playbook, debe comprender c√≥mo se hace para saber qu√© m√≥dulo de servicio utilizar para esto e iniciar el servidor web por su nombre.  Si Playbook instala el paquete de software, debe saber c√≥mo hacerlo en el host de destino.  Tambi√©n debe comprender, al menos en un nivel b√°sico, la esencia de las tareas realizadas.  ¬øSe requiere una configuraci√≥n de host adicional para el software que desea instalar?  ¬øHay alguna rama dependiendo de las condiciones y valores de los argumentos?  Si se pasan variables en el proceso, debe comprender exactamente qu√© y por qu√©. <br><br>  <b>Ejemplo de script de Playbook</b> <br>  El siguiente ejemplo de secuencia de comandos de Playbook lo ayudar√° a comprender lo que acaba de leer.  El host de destino en √©l es el servidor RHEL / CentOS 7, en el que nuestro script instala el servidor web NGINX, y luego crea el archivo index.html en el directorio ra√≠z predeterminado.      ,   -. <br><br> <i>*:      Playbook  Ansible Tower    inventory  .</i> <br><br> Playbooks     YAML (---),   : <br><br> <b>Name</b> :   ,    Playbook. <br><br> <b>Hosts</b> :   ,     Ansible. <br><br> <b>Become</b> :     ,  ,  nginx    (    ). <br><br><pre><code class="hljs css">1 <span class="hljs-selector-tag"><span class="hljs-selector-tag">---</span></span> 2 <span class="hljs-selector-tag"><span class="hljs-selector-tag">-</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">name</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">Install</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">nginx</span></span> 3 <span class="hljs-selector-tag"><span class="hljs-selector-tag">hosts</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">host</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.name</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.ip</span></span> 4 <span class="hljs-selector-tag"><span class="hljs-selector-tag">become</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">true</span></span></code> </pre> <br>  Con la sangr√≠a como las tres l√≠neas anteriores, est√°n las <b>tareas</b> : directiva, despu√©s de lo cual, con sangr√≠a adicional (de acuerdo con las reglas de anidamiento de YAML), se enumeran las tareas (jugadas).  En este ejemplo, tenemos dos tareas, y ambas usan el m√≥dulo Yum.  La primera tarea agrega un repositorio epel-release para que pueda instalar nginx.  Despu√©s de que epel aparece en el sistema, la segunda tarea instala el paquete nginx. <br><br>  La directiva <b>state</b> : significa que Ansible debe verificar el estado del host de destino antes de realizar cualquier otra acci√≥n.  En nuestro ejemplo, si ya hay un repositorio o nginx en el host, Ansible comprende que no es necesario realizar estas dos tareas y pasa a lo siguiente. <br><br><pre> <code class="hljs sql">1 tasks: 2 - name: Add epel-<span class="hljs-keyword"><span class="hljs-keyword">release</span></span> repo <span class="hljs-number"><span class="hljs-number">3</span></span> yum: <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-keyword"><span class="hljs-keyword">name</span></span>: epel-<span class="hljs-keyword"><span class="hljs-keyword">release</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> state: <span class="hljs-keyword"><span class="hljs-keyword">present</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-number"><span class="hljs-number">7</span></span> - <span class="hljs-keyword"><span class="hljs-keyword">name</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">Install</span></span> nginx <span class="hljs-number"><span class="hljs-number">8</span></span> yum: <span class="hljs-number"><span class="hljs-number">9</span></span> <span class="hljs-keyword"><span class="hljs-keyword">name</span></span>: nginx <span class="hljs-number"><span class="hljs-number">10</span></span> state: <span class="hljs-keyword"><span class="hljs-keyword">present</span></span></code> </pre> <br>  La p√°gina de descarga, que se usa por defecto en nginx, es excelente para verificar que nginx se haya instalado correctamente, pero probablemente querr√° hacer esto con su archivo html de inicio.  En este ejemplo, por simplicidad, la plantilla del archivo de √≠ndice est√° en el mismo directorio donde se inicia el Playbook.  El destino es solo la ruta predeterminada en nginix sin sitios configurados. <br><br><pre> <code class="hljs pgsql"><span class="hljs-number"><span class="hljs-number">1</span></span> - <span class="hljs-type"><span class="hljs-type">name</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">Insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> Page <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">template</span></span>: <span class="hljs-number"><span class="hljs-number">3</span></span> src: <span class="hljs-keyword"><span class="hljs-keyword">index</span></span>.html <span class="hljs-number"><span class="hljs-number">4</span></span> dest: /usr/<span class="hljs-keyword"><span class="hljs-keyword">share</span></span>/nginx/html/<span class="hljs-keyword"><span class="hljs-keyword">index</span></span>.html</code> </pre> <br>  La √∫ltima l√≠nea de nuestro Playbook sirve solo para verificar que el servicio nginx se haya iniciado con √©xito (o para iniciarlo si no). <br><br><pre> <code class="hljs pgsql"><span class="hljs-number"><span class="hljs-number">1</span></span> - <span class="hljs-type"><span class="hljs-type">name</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">Start</span></span> NGiNX <span class="hljs-number"><span class="hljs-number">2</span></span> service: <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-type"><span class="hljs-type">name</span></span>: nginx <span class="hljs-number"><span class="hljs-number">4</span></span> state: started</code> </pre> <br>  El gui√≥n completo de Playbook ten√≠a aproximadamente la misma longitud que el p√°rrafo inicial de esta publicaci√≥n: <br><br><pre> <code class="hljs delphi"><span class="hljs-number"><span class="hljs-number">1</span></span> --- <span class="hljs-number"><span class="hljs-number">2</span></span> - <span class="hljs-keyword"><span class="hljs-keyword">name</span></span>: Install nginx <span class="hljs-number"><span class="hljs-number">3</span></span> hosts: host.<span class="hljs-keyword"><span class="hljs-keyword">name</span></span>.ip <span class="hljs-number"><span class="hljs-number">4</span></span> become: true <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span> tasks: <span class="hljs-number"><span class="hljs-number">7</span></span> - <span class="hljs-keyword"><span class="hljs-keyword">name</span></span>: Add epel-release repo <span class="hljs-number"><span class="hljs-number">8</span></span> yum: <span class="hljs-number"><span class="hljs-number">9</span></span> <span class="hljs-keyword"><span class="hljs-keyword">name</span></span>: epel-release <span class="hljs-number"><span class="hljs-number">10</span></span> state: present <span class="hljs-number"><span class="hljs-number">11</span></span> <span class="hljs-number"><span class="hljs-number">12</span></span> - <span class="hljs-keyword"><span class="hljs-keyword">name</span></span>: Install nginx <span class="hljs-number"><span class="hljs-number">13</span></span> yum: <span class="hljs-number"><span class="hljs-number">14</span></span> <span class="hljs-keyword"><span class="hljs-keyword">name</span></span>: nginx <span class="hljs-number"><span class="hljs-number">15</span></span> state: present <span class="hljs-number"><span class="hljs-number">16</span></span> <span class="hljs-number"><span class="hljs-number">17</span></span> - <span class="hljs-keyword"><span class="hljs-keyword">name</span></span>: Insert <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> Page <span class="hljs-number"><span class="hljs-number">18</span></span> template: <span class="hljs-number"><span class="hljs-number">19</span></span> src: <span class="hljs-keyword"><span class="hljs-keyword">index</span></span>.html <span class="hljs-number"><span class="hljs-number">20</span></span> dest: /usr/share/nginx/html/<span class="hljs-keyword"><span class="hljs-keyword">index</span></span>.html <span class="hljs-number"><span class="hljs-number">21</span></span> <span class="hljs-number"><span class="hljs-number">22</span></span> - <span class="hljs-keyword"><span class="hljs-keyword">name</span></span>: Start NGiNX <span class="hljs-number"><span class="hljs-number">23</span></span> service: <span class="hljs-number"><span class="hljs-number">24</span></span> <span class="hljs-keyword"><span class="hljs-keyword">name</span></span>: nginx <span class="hljs-number"><span class="hljs-number">25</span></span> state: started</code> </pre> <br><h3>  Resumen </h3><br>  Los scripts de Playbook son una manera f√°cil y conveniente de hacer muchas cosas con un peque√±o c√≥digo.  En el ejemplo anterior, utilizamos tres m√≥dulos: mmm, plantilla y servicio, para instalar el repositorio y el paquete de software en el servidor, crear un archivo desde la plantilla local y luego iniciar el servicio que acaba de instalar.  ¬°Al mismo tiempo, nuestro gui√≥n de Playbook sali√≥ un poco m√°s largo que esta oferta!  Y aunque lo ejecutamos en un host, tambi√©n podr√≠a hacerlo en docenas y cientos de servidores, para esto solo necesita hacer cambios muy peque√±os.  Adem√°s, Tower le permite colocar un script de Playbook en una plantilla de trabajo para ejecutar en un grupo de servidores en la nube de AWS o en un centro de datos corporativo. <br><br>  Las caracter√≠sticas arquitect√≥nicas y la capacidad de integrarse con los sistemas de CI, como Jenkins, automatizan no solo los procesos de gesti√≥n de la configuraci√≥n, sino tambi√©n una gama mucho m√°s amplia de tareas de TI.  Es por eso que llamamos cari√±osamente a Ansible un sistema de orquestaci√≥n integrado, y no solo una herramienta de administraci√≥n de configuraci√≥n y despliegue de software. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es412725/">https://habr.com/ru/post/es412725/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es412715/index.html">Aprender programaci√≥n multiproceso Go con im√°genes</a></li>
<li><a href="../es412717/index.html">Hola extraterrestres; por favor no nos mates</a></li>
<li><a href="../es412719/index.html">MDG anuncia concurso de s√≠ntesis de voz</a></li>
<li><a href="../es412721/index.html">Tres esperanzas de la humanidad para el descubrimiento de extraterrestres</a></li>
<li><a href="../es412723/index.html">Buscando un nuevo color de mil millones de d√≥lares</a></li>
<li><a href="../es412727/index.html">¬øC√≥mo elegir una herramienta para la creaci√≥n de prototipos en 2018?</a></li>
<li><a href="../es412729/index.html">RGPD. ¬øEs necesario realizarlo en Rusia?</a></li>
<li><a href="../es412735/index.html">Deja el concurso ATM Alone en PHDays 8</a></li>
<li><a href="../es412737/index.html">Protecci√≥n de datos personales de 3.000 millones de personas: similitudes y diferencias en la legislaci√≥n de los pa√≠ses BRICS</a></li>
<li><a href="../es412739/index.html">Perro pastor</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>