<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>游댤 游끧 游눉游 Reconocimiento facial a nivel de la rodilla 游뱝游낖 游깩 游꺜</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="En general, el reconocimiento de la cara y la identificaci칩n de las personas de acuerdo con sus resultados parece ser sexo adolescente para los ancian...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Reconocimiento facial a nivel de la rodilla</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/465145/"> En general, el reconocimiento de la cara y la identificaci칩n de las personas de acuerdo con sus resultados parece ser sexo adolescente para los ancianos: todos hablan mucho de 칠l, pero pocos practican.  Est치 claro que ya no nos sorprende que despu칠s de descargar fotos de reuniones amistosas, Facebook / VK sugiera marcar a las personas que se encuentran en la imagen, pero aqu칤 intuitivamente sabemos que las redes sociales tienen una buena ayuda en forma de gr치fico de conexiones de una persona.  쯏 si no hay tal gr치fico?  Sin embargo, comencemos en orden. <br><br><img src="https://habrastorage.org/webt/m9/y6/h4/m9y6h4ogtivd9hcrktofvqcqzue.jpeg" alt="Una maldita cosa se esconde en la puerta con una caja"><br><a name="habracut"></a><br>  Inicialmente, el reconocimiento facial y la identificaci칩n de "amigos / enemigos" con nosotros surgieron de necesidades exclusivamente dom칠sticas: los adictos se met칤an en la puerta de un colega y vigilaban constantemente la imagen desde la c치mara de video instalada, e incluso desensamblaban d칩nde el vecino y el extra침o no deseaban no <br><br>  Por lo tanto, en solo una semana, se ensambl칩 un prototipo en la rodilla, que constaba de una c치mara IP, un dispositivo de placa 칰nica, un sensor de movimiento y la biblioteca de reconocimiento de Python de reconocimiento facial.  Dado que la biblioteca de Python estaba en un hardware de placa 칰nica y bastante potente ... digamos con cuidado, no muy r치pido, decidimos construir el proceso de procesamiento de la siguiente manera: <br><ul><li>  el sensor de movimiento determina si hay movimiento en el 치rea del espacio que se le conf칤a y se침ala su presencia; </li><li>  un servicio escrito basado en gstreamer, que recibe constantemente una transmisi칩n de una c치mara IP, corta 5 segundos antes y 10 segundos despu칠s de la detecci칩n y lo env칤a a la biblioteca de reconocimiento para su an치lisis; </li><li>  ella, a su vez, mira el video, encuentra caras all칤, las compara con muestras conocidas y, si se encuentra una desconocida, entrega el video al canal Telegram, luego se supon칤a que deb칤a controlarse en el mismo lugar para cortar inmediatamente los falsos positivos, por ejemplo, cuando un vecino Se volvi칩 hacia la c치mara del lado equivocado de las muestras. </li></ul><br>  Todo nuestro proceso fue pegado por nuestro querido Erlang, y en el proceso de pruebas en colegas demostr칩 su capacidad de trabajo m칤nima. <br><br>  Sin embargo, el modelo ensamblado no encontr칩 aplicaci칩n en la vida real, no debido a su imperfecci칩n t칠cnica, que indudablemente lo fue, como lo demuestra la experiencia, recolectado en la rodilla en condiciones de invernadero tiene una muy mala tendencia a romperse en el campo y al momento de la demostraci칩n al cliente. , y debido a las organizaciones, los residentes de la entrada rechazaron la mayor칤a de cualquier video vigilancia. <br><br>  El proyecto sali칩 a la venta y peri칩dicamente pinch칩 con un palo para hacer demostraciones durante las ventas y la necesidad de reencarnar en el hogar personal. <br><br>  Todo ha cambiado desde el momento en que tuvimos un proyecto m치s espec칤fico y bastante comercial sobre el mismo tema.  Dado que no ser칤a posible cortar esquinas usando un sensor de movimiento directamente desde el enunciado del problema, tuve que profundizar en los matices de buscar y reconocer caras en tres cabezas (est치 bien, dos y media, si cuentas las m칤as) directamente en la secuencia.  Y luego ocurri칩 una revelaci칩n. <br><br>  El problema es que la mayor칤a de los hallazgos sobre este tema son bocetos puramente acad칠micos sobre el tema de que "tuve que escribir un art칤culo en una revista sobre un tema de moda y obtener una marca para publicar".  No menosprecio los m칠ritos de los cient칤ficos: entre los documentos que encontr칠 que eran muy 칰tiles e interesantes, pero, por desgracia, tengo que admitir que la reproducibilidad del trabajo de su c칩digo publicado en Github deja mucho que desear o parece una empresa dudosa con el tiempo perdido al final. <br><br>  Numerosos marcos para las redes neuronales y el aprendizaje autom치tico a menudo eran dif칤ciles de levantar: el reconocimiento facial era una tarea estrecha y separada para ellos, sin inter칠s en una amplia gama de problemas que resolvieron.  En otras palabras, tomar un ejemplo listo y ejecutarlo en el hardware de destino solo para verificar c칩mo funciona y si funciona, no funcion칩.  Ese no fue un ejemplo, entonces la necesidad de obtenerlo sugiri칩 una b칰squeda agria del ensamblaje de ciertas bibliotecas de ciertas versiones para un SO estrictamente definido.  Es decir  para tomar y volar en movimiento, literalmente migajas como la face_recognition mencionada anteriormente, que utilizamos para las embarcaciones anteriores. <br><br>  Las grandes empresas, como siempre, nos salvaron.  Tanto Intel como Nvidia han sentido durante mucho tiempo el creciente impulso y el atractivo comercial de esta clase de tareas, pero como proveedores de equipos en primer lugar, distribuyen sus marcos para resolver problemas de aplicaciones espec칤ficas de forma gratuita. <br><br>  Nuestro proyecto probablemente no era de investigaci칩n, sino de naturaleza experimental, por lo que no analizamos ni comparamos las soluciones de proveedores individuales, sino que simplemente tomamos el primero con el objetivo de recolectar un prototipo listo y probarlo en la batalla, mientras recib칤amos la respuesta m치s r치pida posible.  Por lo tanto, la elecci칩n recay칩 r치pidamente en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Intel OpenVINO</a> , una biblioteca para la aplicaci칩n pr치ctica del aprendizaje autom치tico en tareas aplicadas. <br><br>  Para comenzar, armamos un soporte, que tradicionalmente es un conjunto de nettop con un procesador Intel Core i3 y c치maras IP de proveedores chinos en el mercado.  La c치mara se conect칩 directamente al nettop y se le suministr칩 una transmisi칩n RTSP con un FPS no muy grande, basado en el supuesto de que la gente todav칤a no correr칤a delante de ella como en las competiciones.  La velocidad de procesamiento de un cuadro (b칰squeda y reconocimiento de caras) fluctu칩 en la regi칩n de decenas a cientos de milisegundos, lo que fue suficiente para integrar el mecanismo de b칰squeda de personas que usan muestras existentes.  Adem치s, tambi칠n ten칤amos un plan de respaldo: Intel tiene un coprocesador especial para acelerar los c치lculos de las redes neuronales <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Neural Compute Stick 2</a> , que podr칤amos usar si no tuvi칠ramos un procesador de uso general.  Pero hasta ahora no ha pasado nada. <br><br>  Despu칠s de completar el ensamblaje y verificar la funcionalidad de los ejemplos b치sicos, una caracter칤stica distintiva del SDK de Intel estaba en una gu칤a de ejemplos paso a paso y muy detallada, comenzamos a construir el software. <br><br>  La tarea principal a la que nos enfrentamos era buscar a una persona en el campo de visi칩n de la c치mara, su identificaci칩n y notificaci칩n oportuna de su presencia.  En consecuencia, adem치s de reconocer caras y compararlas con patrones (c칩mo hacer esto, en ese momento, no caus칩 menos preguntas que todo lo dem치s), necesit치bamos proporcionar elementos secundarios del plan de interfaz.  Es decir, debemos recibir marcos con las caras de las personas necesarias de la misma c치mara para su posterior identificaci칩n.  Por qu칠, desde la misma c치mara, creo que tambi칠n es bastante obvio: el punto de instalaci칩n de la c치mara en el objeto y la 칩ptica del objetivo introducen ciertas distorsiones que, presumiblemente, pueden afectar la calidad del reconocimiento, utilizamos una fuente de datos de origen diferente a una herramienta de seguimiento. <br><br>  Es decir  Adem치s del controlador de flujo en s칤, necesitamos al menos un archivo de video y un analizador de archivos de video que aislar치n todas las caras detectadas de la grabaci칩n y guardar치n las m치s adecuadas como referencias. <br><br>  Como siempre, tomamos el conocido Erlang y PostgreSQL como pegamento entre ffmpeg, aplicaciones en OpenVINO y Telegram Bot API para alertas.  Adem치s, necesit치bamos una interfaz de usuario web para proporcionar el conjunto m칤nimo de procedimientos para administrar el complejo, que nuestro interlocutor colega hab칤a subido a VueJS. <br><br>  La l칩gica del trabajo fue la siguiente: <br><ul><li>  bajo el control de un plano de control (en Erlang) ffmpeg escribe un flujo de la c치mara al video en segmentos de cinco minutos, un proceso separado asegura que los registros se almacenan en un volumen estrictamente especificado y limpia el m치s antiguo cuando se alcanza este umbral; </li><li>  a trav칠s de la interfaz de usuario web puede ver cualquier registro, est치n ordenados cronol칩gicamente, lo que, aunque no sin dificultad, le permite aislar el fragmento deseado y enviarlo para su procesamiento; </li><li>  el procesamiento consiste en analizar el video y extraer cuadros con caras detectadas, solo hace el software basado en OpenVINO (debo decir, aqu칤 logramos cortar un poco el 치ngulo; el software para analizar el flujo y analizar archivos es casi id칠ntico, por lo que la mayor parte fue a una biblioteca compartida, y las utilidades en s칤 mismas difieren solo en la cadena de procesamiento a la modular gstreamer).  El procesamiento se realiza en video, aislando las caras encontradas utilizando una red neuronal especialmente entrenada.  Los fragmentos resultantes del marco que contiene caras caen en otra red neuronal, que forma un vector de 256 elementos, que es, de hecho, las coordenadas de los puntos de referencia de la cara de una persona.  Este vector, el marco detectado y las coordenadas del rect치ngulo de la cara encontrada se almacenan en la base de datos; </li><li>  Adem치s, una vez que se completa el procesamiento, el operador abre la variedad de cuadros dibujados, se horroriza por su n칰mero y procede a buscar a las personas objetivo.  Las muestras seleccionadas se pueden agregar a una persona existente o crear una nueva.  Una vez que se completa el procesamiento de la tarea, los resultados del an치lisis se eliminan, con la excepci칩n de los vectores almacenados asignados a los registros de observables; </li><li>  en consecuencia, podemos ver tanto los cuadros como los vectores de detecci칩n en cualquier momento y editarlos, eliminando muestras que no tuvieron 칠xito; </li><li>  Paralelamente al ciclo de detecci칩n en segundo plano, el servicio de an치lisis de flujo siempre funciona, lo que hace lo mismo, pero con el flujo de la c치mara.  Selecciona caras en el flujo observado y las compara con muestras de la base de datos, que se basa en la simple suposici칩n de que los vectores de una persona estar치n m치s cerca uno del otro que de todos los dem치s vectores.  Se produce un c치lculo por pares de la distancia entre los vectores, cuando se alcanza el umbral, un registro de detecci칩n y un marco se colocan en la base de datos.  Adem치s, una persona se agrega a la lista de paradas en un futuro cercano, lo que evita m칰ltiples notificaciones sobre la misma persona; </li><li>  el plano de control verifica peri칩dicamente el registro de detecci칩n y, en caso de nuevas entradas, notifica con un mensaje con la foto adjunta y destacando la cara a trav칠s del bot a aquellos que est치n autorizados de acuerdo con la configuraci칩n. </li></ul><br><br>  Se parece a esto: <br><br><img src="https://habrastorage.org/webt/vc/jo/_h/vcjo_haxpwhnxoe1-37sozet9gs.jpeg" alt="Entonces podemos meternos en el archivo"><br>  <i>Ver archivo</i> <br><br><img src="https://habrastorage.org/webt/07/dq/x8/07dqx8o9vmcavh7qxj7rnduca8m.jpeg" alt="Y as칤: mete las tazas iluminadas en el video"><br>  <i>Resultados de an치lisis de video</i> <br><br><img src="https://habrastorage.org/webt/fp/ky/ct/fpkyctbrq3slopbowp5wurzoaug.jpeg" alt="춰Y aqu칤 est치n, estos tipos!"><br>  <i>Lista de personalidades observadas</i> <br><br>  La soluci칩n resultante es, en muchos sentidos, controvertida y, a veces, incluso no 칩ptima, tanto en t칠rminos de productividad como en t칠rminos de reducci칩n del tiempo de reacci칩n.  Pero, repito, no ten칤amos el objetivo de obtener un sistema efectivo de inmediato, sino simplemente seguir esta ruta y llenar el n칰mero m치ximo de conos, identificar caminos estrechos y posibles problemas no obvios. <br><br>  El sistema ensamblado se prob칩 en condiciones de invernadero durante una semana.  Durante este tiempo, se observaron las siguientes observaciones: <br><ul><li>  Existe una clara dependencia de la calidad de reconocimiento de la calidad de las muestras originales.  Si la persona observada atraviesa la zona de observaci칩n demasiado r치pido, con un alto grado de probabilidad no dejar치 datos para el muestreo y no ser치 reconocida.  Sin embargo, creo que se trata de ajustar el sistema, incluidos los par치metros de iluminaci칩n y transmisi칩n de video; </li><li>  Dado que el sistema funciona con el reconocimiento de elementos de caras (ojos, nariz, boca, cejas, etc.), es f치cil enga침ar al colocar un obst치culo visual entre la cara y la c치mara (cabello, anteojos oscuros, usar una capucha, etc.): la cara, lo m치s probable es que se encuentre, pero la comparaci칩n con las muestras no funcionar치 debido a la fuerte discrepancia entre los vectores de detecci칩n y las muestras; </li><li>  los anteojos comunes no afectan demasiado: tuvimos ejemplos de respuestas positivas en personas con anteojos y respuestas falsas negativas en personas que se pusieron anteojos para la prueba; </li><li>  si la barba estaba en las muestras originales, y luego desapareci칩, entonces el n칰mero de operaciones se reduce (el autor de estas l칤neas recort칩 su barba a 2 mm y el n칰mero de operaciones en ella se redujo a la mitad); </li><li>  Tambi칠n se produjeron falsos positivos, esta es una ocasi칩n para una mayor inmersi칩n en las matem치ticas del problema y, posiblemente, una soluci칩n a la cuesti칩n de la correspondencia parcial de los vectores y el m칠todo 칩ptimo para calcular la distancia entre ellos.  Sin embargo, las pruebas de campo deber칤an revelar a칰n m치s problemas a este respecto. </li></ul><br>  Lo que est치 por venir?  Verificando el sistema en batalla, optimizando el ciclo de procesamiento de detecci칩n, simplificando el procedimiento para buscar eventos en el archivo de video, agregando m치s datos al an치lisis (edad, g칠nero, emociones) y otras 100,500 tareas peque침as y no tan importantes que a칰n deben hacerse.  Pero el primer paso en el camino de mil pasos ya hemos dado.  Si alguien comparte su experiencia en la soluci칩n de tales problemas o da enlaces interesantes sobre este tema, le agradecer칠 mucho. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/465145/">https://habr.com/ru/post/465145/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../465135/index.html">Telefon칤a DECT en edificios</a></li>
<li><a href="../465137/index.html">Infraestructura como c칩digo: primer conocido</a></li>
<li><a href="../465139/index.html">C칩mo hacerlo: Factores importantes para revisar al elegir una VPN gratuita para la navegaci칩n web</a></li>
<li><a href="../465141/index.html">M치s de 33 herramientas de seguridad de Kubernetes</a></li>
<li><a href="../465143/index.html">쮺칩mo encontrar la mejor ubicaci칩n para los negocios? Hack de vida sin registro y SMS</a></li>
<li><a href="../465149/index.html">'Hola mundo' para ti en la nube</a></li>
<li><a href="../465151/index.html">Instalar Apache Cassandra en Windows</a></li>
<li><a href="../465153/index.html">La visi칩n por computadora ve emociones, pulso, respiraci칩n y mentiras, pero c칩mo construir una startup sobre esto. Conversaci칩n con Neurodata Lab</a></li>
<li><a href="../465155/index.html">Dos entidades de programaci칩n neuroling칲칤stica.</a></li>
<li><a href="../465161/index.html">Modelo de datos de quinteto y cientos de gigabytes de datos</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>