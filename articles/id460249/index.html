<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸŒ­ ğŸ†“ ğŸ¤Ÿ Solusi tugas dengan pwnable.kr 07 - input. Memahami pwntools ğŸ‘©ğŸ¼â€ğŸ¤â€ğŸ‘©ğŸ» â›¹ğŸ» ğŸ‘‚ğŸ¾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Pada artikel ini, kami akan menganalisis solusi tugas multi-level menggunakan pwntools library. 

 Informasi Organisasi  Terutama bagi mereka yang ing...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Solusi tugas dengan pwnable.kr 07 - input. Memahami pwntools</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/460249/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/al/py/ef/alpyefagnx81cc2xc1ncjqs8lus.png" alt="gambar"></div><br>  Pada artikel ini, kami akan menganalisis solusi tugas multi-level menggunakan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">pwntools</a> library. <br><br><div class="spoiler">  <b class="spoiler_title">Informasi Organisasi</b> <div class="spoiler_text">  Terutama bagi mereka yang ingin mempelajari sesuatu yang baru dan berkembang di bidang informasi dan keamanan komputer, saya akan menulis dan berbicara tentang kategori berikut: <br><br><ul><li>  PWN; </li><li>  kriptografi (Crypto); </li><li>  teknologi jaringan (Jaringan); </li><li>  membalikkan (Reverse Engineering); </li><li>  steganografi (Stegano); </li><li>  pencarian dan eksploitasi kerentanan WEB. </li></ul><br>  Selain itu, saya akan membagikan pengalaman saya dalam forensik komputer, analisis malware dan firmware, serangan pada jaringan nirkabel dan jaringan area lokal, melakukan pentest dan menulis eksploitasi. <br><a name="habracut"></a><br>  Agar Anda dapat mengetahui tentang artikel baru, perangkat lunak, dan informasi lainnya, saya membuat <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">saluran di Telegram</a> dan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">grup untuk membahas masalah apa pun</a> di bidang ICD.  Juga, saya pribadi akan mempertimbangkan permintaan pribadi Anda, pertanyaan, saran dan rekomendasi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">secara pribadi dan akan menjawab semua orang</a> . <br><cut></cut><br>  Semua informasi disediakan hanya untuk tujuan pendidikan.  Penulis dokumen ini tidak bertanggung jawab atas kerusakan yang disebabkan seseorang sebagai akibat dari menggunakan pengetahuan dan metode yang diperoleh sebagai hasil dari mempelajari dokumen ini. <br></div></div><br><h2>  Masukan solusi pekerjaan </h2><br>  Kami mengklik ikon dengan input tanda tangan, dan kami diberitahu bahwa kami perlu terhubung melalui SSH dengan tamu kata sandi. <br><br><img src="https://habrastorage.org/webt/_w/fs/8n/_wfs8nwkwtgd-2ezbk3prmnfrwq.png" alt="gambar"><br><br>  Saat terhubung, kami melihat spanduk yang sesuai. <br><br><img src="https://habrastorage.org/webt/ta/h-/f-/tah-f-wuqrhtghcchgvy1vbxvki.png" alt="gambar"><br><br>  Mari cari tahu file apa yang ada di server, serta hak apa yang kita miliki. <br><br><pre><code class="bash hljs">ls -l</code> </pre> <br><img src="https://habrastorage.org/webt/k6/re/aa/k6reaalaqoyg13qhbu0arwtvali.png" alt="gambar"><br><br>  Dengan demikian, kita dapat membaca kode sumber program, karena ada hak untuk membaca untuk semua orang, dan menjalankan program input (set bit-sticky) dengan hak-hak pemilik.  Mari kita lihat hasil kodenya. <br><br><div class="spoiler">  <b class="spoiler_title">Kode Sumber input.c</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;stdio.h&gt; #include &lt;stdlib.h&gt; #include &lt;string.h&gt; #include &lt;sys/socket.h&gt; #include &lt;arpa/inet.h&gt; int main(int argc, char* argv[], char* envp[]){ printf("Welcome to pwnable.kr\n"); printf("Let's see if you know how to give input to program\n"); printf("Just give me correct inputs then you will get the flag :)\n"); // argv if(argc != 100) return 0; if(strcmp(argv['A'],"\x00")) return 0; if(strcmp(argv['B'],"\x20\x0a\x0d")) return 0; printf("Stage 1 clear!\n"); // stdio char buf[4]; read(0, buf, 4); if(memcmp(buf, "\x00\x0a\x00\xff", 4)) return 0; read(2, buf, 4); if(memcmp(buf, "\x00\x0a\x02\xff", 4)) return 0; printf("Stage 2 clear!\n"); // env if(strcmp("\xca\xfe\xba\xbe", getenv("\xde\xad\xbe\xef"))) return 0; printf("Stage 3 clear!\n"); // file FILE* fp = fopen("\x0a", "r"); if(!fp) return 0; if( fread(buf, 4, 1, fp)!=1 ) return 0; if( memcmp(buf, "\x00\x00\x00\x00", 4) ) return 0; fclose(fp); printf("Stage 4 clear!\n"); // network int sd, cd; struct sockaddr_in saddr, caddr; sd = socket(AF_INET, SOCK_STREAM, 0); if(sd == -1){ printf("socket error, tell admin\n"); return 0; } saddr.sin_family = AF_INET; saddr.sin_addr.s_addr = INADDR_ANY; saddr.sin_port = htons( atoi(argv['C']) ); if(bind(sd, (struct sockaddr*)&amp;saddr, sizeof(saddr)) &lt; 0){ printf("bind error, use another port\n"); return 1; } listen(sd, 1); int c = sizeof(struct sockaddr_in); cd = accept(sd, (struct sockaddr *)&amp;caddr, (socklen_t*)&amp;c); if(cd &lt; 0){ printf("accept error, tell admin\n"); return 0; } if( recv(cd, buf, 4, 0) != 4 ) return 0; if(memcmp(buf, "\xde\xad\xbe\xef", 4)) return 0; printf("Stage 5 clear!\n"); // here's your flag system("/bin/cat flag"); return 0; }</span></span></span></span></code> </pre> <br></div></div><br>  Dari kode itu kita perlu melewati lima level.  Kami akan membawanya pada gilirannya. <br><br><img src="https://habrastorage.org/webt/lf/iz/rr/lfizrrvs8nymwjwmz_kgruwhr8q.png" alt="gambar"><br><br>  Pada tingkat pertama, diperiksa bahwa jumlah argumen program adalah 100. Dalam hal ini, elemen ke-65 harus berupa string "\ x00", dan elemen ke-66 harus "\ x20 \ x0a \ x0d".  Buat direktori Anda sendiri di direktori / tmp / dan buat skrip Python di sana. <br><br><img src="https://habrastorage.org/webt/hr/jv/cp/hrjvcpftgukbkucztpoxfarvxum.png" alt="gambar"><br><br>  Untuk menyelesaikan level pertama, kita akan membuat larik seratus baris 'A'.  Dan berikan argumen yang diperlukan untuk nilai yang diinginkan.  Kita dapat memulai proses dengan argumen ini sebagai berikut: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pwn <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * a = [<span class="hljs-string"><span class="hljs-string">'A'</span></span>]*<span class="hljs-number"><span class="hljs-number">100</span></span> a[<span class="hljs-number"><span class="hljs-number">0</span></span>] = <span class="hljs-string"><span class="hljs-string">'/home/input2/input'</span></span> a[ord(<span class="hljs-string"><span class="hljs-string">'A'</span></span>)] = <span class="hljs-string"><span class="hljs-string">'\x00'</span></span> a[ord(<span class="hljs-string"><span class="hljs-string">'B'</span></span>)] = <span class="hljs-string"><span class="hljs-string">'\x20\x0a\x0d'</span></span> ex = process(argv=a) ex.interactive()</code> </pre> <br><img src="https://habrastorage.org/webt/2x/wq/ak/2xwqakwlb0r_kfrt77plnmtnofi.png" alt="gambar"><br><br>  Kami melewati level pertama.  Lihatlah yang kedua. <br><br><img src="https://habrastorage.org/webt/qd/s4/ep/qds4epgg8p3ucpibt5wxlhajzeo.png" alt="gambar"><br><br>  Pada level ini, dua baris dibaca, satu dari stdin input standar, dan lainnya dari stderr.  Kita perlu membuat dua file yang akan berisi baris-baris ini. <br><br><img src="https://habrastorage.org/webt/y4/wz/en/y4wzenzqoyigjqmaa3cuhjdyam4.png" alt="gambar"><br><br>  Buka stream ke file-file ini dan tentukan deskriptor untuk streaming satu file sebagai deskriptor stdin, dan file lain sebagai deskriptor stderr. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pwn <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * a = [<span class="hljs-string"><span class="hljs-string">'A'</span></span>]*<span class="hljs-number"><span class="hljs-number">100</span></span> a[<span class="hljs-number"><span class="hljs-number">0</span></span>] = <span class="hljs-string"><span class="hljs-string">'/home/input2/input'</span></span> a[ord(<span class="hljs-string"><span class="hljs-string">'A'</span></span>)] = <span class="hljs-string"><span class="hljs-string">'\x00'</span></span> a[ord(<span class="hljs-string"><span class="hljs-string">'B'</span></span>)] = <span class="hljs-string"><span class="hljs-string">'\x20\x0a\x0d'</span></span> fin = open(<span class="hljs-string"><span class="hljs-string">'/tmp/ex/in.txt'</span></span>, <span class="hljs-string"><span class="hljs-string">'r'</span></span>) ferr = open(<span class="hljs-string"><span class="hljs-string">'/tmp/ex/err.txt'</span></span>, <span class="hljs-string"><span class="hljs-string">'r'</span></span>) ex = process(argv=a, stdin=fin, stderr=ferr) fin.close() ferr.close() ex.interactive()</code> </pre> <br><img src="https://habrastorage.org/webt/os/se/qq/osseqqsq37snhvxbku7sq4_pqok.png" alt="gambar"><br><br>  Kami melanjutkan ke keputusan tingkat ketiga. <br><br><img src="https://habrastorage.org/webt/fd/ec/de/fdecdeek9nfii1n9txv-hpyczmw.png" alt="gambar"><br><br>  Fungsi getenv () mengembalikan nilai variabel lingkungan, yang harus sama dengan nilai referensi.  Jadi, Anda perlu membuat variabel lingkungan dengan nilai tertentu. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pwn <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * a = [<span class="hljs-string"><span class="hljs-string">'A'</span></span>]*<span class="hljs-number"><span class="hljs-number">100</span></span> a[<span class="hljs-number"><span class="hljs-number">0</span></span>] = <span class="hljs-string"><span class="hljs-string">'/home/input2/input'</span></span> a[ord(<span class="hljs-string"><span class="hljs-string">'A'</span></span>)] = <span class="hljs-string"><span class="hljs-string">'\x00'</span></span> a[ord(<span class="hljs-string"><span class="hljs-string">'B'</span></span>)] = <span class="hljs-string"><span class="hljs-string">'\x20\x0a\x0d'</span></span> fin = open(<span class="hljs-string"><span class="hljs-string">'/tmp/ex/in.txt'</span></span>, <span class="hljs-string"><span class="hljs-string">'r'</span></span>) ferr = open(<span class="hljs-string"><span class="hljs-string">'/tmp/ex/err.txt'</span></span>, <span class="hljs-string"><span class="hljs-string">'r'</span></span>) e={<span class="hljs-string"><span class="hljs-string">'\xde\xad\xbe\xef'</span></span>:<span class="hljs-string"><span class="hljs-string">'\xca\xfe\xba\xbe'</span></span>} ex = process(argv=a, stdin=fin, stderr=ferr, env=e) fin.close() ferr.close() ex.interactive()</code> </pre> <br><img src="https://habrastorage.org/webt/si/g2/w7/sig2w7bze79xuf5de9xnurbxl7o.png" alt="gambar"><br><br>  Kami mengelola variabel lingkungan, sekarang mari kita mulai dari tingkat keempat. <br><br><img src="https://habrastorage.org/webt/v7/2z/_1/v72z_1rlpvr49dlumkw1zsjye-8.png" alt="gambar"><br><br>  Menurut kode, kita dapat mengatakan bahwa program membuka file dengan nama "\ x0a" dan membaca 4 karakter dari itu, setelah itu membandingkannya dengan byte "\ x00".  Karena karakter itu sendiri dan nama file terdiri dari karakter yang tidak dapat dicetak, kami menggunakan python. <br><br><img src="https://habrastorage.org/webt/x2/kj/lx/x2kjlx3bsbpca-cljqvqvdp5nja.png" alt="gambar"><br><br><img src="https://habrastorage.org/webt/ku/qe/pn/kuqepnlbnrp90jzzz6jxiuiltcg.png" alt="gambar"><br><br>  Level terakhir tetap ada.  Mari kita mulai. <br><br><img src="https://habrastorage.org/webt/mc/9m/a6/mc9ma61qo_tgnnyypnwz7yn4m4u.png" alt="gambar"><br><br>  Program membuka soket pada port yang ditentukan dalam argumen ke-66.  Kemudian ia menerima 4 byte melalui jaringan dan membandingkannya dengan string referensi.  Kita perlu menambahkan argumen lain ke program - nomor port, membangun koneksi dan mengirim 4 byte yang diperlukan. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pwn <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * a = [<span class="hljs-string"><span class="hljs-string">'A'</span></span>]*<span class="hljs-number"><span class="hljs-number">100</span></span> a[<span class="hljs-number"><span class="hljs-number">0</span></span>] = <span class="hljs-string"><span class="hljs-string">'/home/input2/input'</span></span> a[ord(<span class="hljs-string"><span class="hljs-string">'A'</span></span>)] = <span class="hljs-string"><span class="hljs-string">'\x00'</span></span> a[ord(<span class="hljs-string"><span class="hljs-string">'B'</span></span>)] = <span class="hljs-string"><span class="hljs-string">'\x20\x0a\x0d'</span></span> a[ord(<span class="hljs-string"><span class="hljs-string">'C'</span></span>)] = <span class="hljs-string"><span class="hljs-string">'1234'</span></span> fin = open(<span class="hljs-string"><span class="hljs-string">'/tmp/ex/in.txt'</span></span>, <span class="hljs-string"><span class="hljs-string">'r'</span></span>) ferr = open(<span class="hljs-string"><span class="hljs-string">'/tmp/ex/err.txt'</span></span>, <span class="hljs-string"><span class="hljs-string">'r'</span></span>) e={<span class="hljs-string"><span class="hljs-string">'\xde\xad\xbe\xef'</span></span>:<span class="hljs-string"><span class="hljs-string">'\xca\xfe\xba\xbe'</span></span>} ex = process(argv=a, stdin=fin, stderr=ferr, env=e) fin.close() ferr.close() ex.interactive()</code> </pre> <br><img src="https://habrastorage.org/webt/hl/qh/io/hlqhiowvmaorjc2hn3dllpj_yfq.png" alt="gambar"><br><br><img src="https://habrastorage.org/webt/oy/x-/kb/oyx-kb5xbrbt0pmwgeern_omjji.png" alt="gambar"><br><br>  Itu saja, dapatkan poin Anda. <br><br><img src="https://habrastorage.org/webt/kb/im/le/kbimlec-28qy9gzfxfjydg-z90a.png" alt="gambar"><br><br>  Sampai jumpa di artikel berikut! <br><br>  Kami berada di saluran telegram: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">saluran di Telegram</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id460249/">https://habr.com/ru/post/id460249/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id460233/index.html">Game Cities: Skylines ternyata Turing-complete: kami membuat penambah 4-bit</a></li>
<li><a href="../id460237/index.html">Scammers EBay (satu cerita curang)</a></li>
<li><a href="../id460239/index.html">Cara mendapatkan NextGen Firewall sendiri di rumah benar-benar gratis</a></li>
<li><a href="../id460241/index.html">Neraka atau air tinggi: sejarah literatur sains populer Rusia</a></li>
<li><a href="../id460247/index.html">Resep untuk ELF</a></li>
<li><a href="../id460251/index.html">Kebodohan Buatan: bot yang tidak membantu saya</a></li>
<li><a href="../id460253/index.html">10 alasan untuk menjadikan keterampilan Anda sebagai asisten suara</a></li>
<li><a href="../id460255/index.html">Backdoor di Node.js: mengapa, mengapa, dan cara kerjanya</a></li>
<li><a href="../id460257/index.html">Halo Dunia! Perendaman dalam di Terminal</a></li>
<li><a href="../id460259/index.html">Apa itu desain UI dan UX? Apa yang umum dan berbeda?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>