<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚û∞ üí≤ üöÅ ADSM3. Sistem IPAM / DCIM ü§Ωüèø ü•õ üè¥</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dalam seri ADSM sebelumnya, kami mengembangkan kerangka kerja otomatisasi, menemukan mengapa virtualisasi muncul dan cara kerjanya. Pada bagian terakh...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ADSM3. Sistem IPAM / DCIM</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/486000/"> Dalam seri ADSM sebelumnya, kami mengembangkan kerangka kerja otomatisasi, menemukan mengapa virtualisasi muncul dan cara kerjanya.  Pada bagian <a href="https://linkmeup.ru/blog/479.html" rel="nofollow">terakhir,</a> kami memilih dan membenarkan desain jaringan, peran perangkat, produsen, memutuskan LLD (pengalamatan, perutean, jumlah Sistem Otonomi). <br><br>  Sekarang kita siap untuk berpikir tentang bagaimana menyimpan seluruh informasi ini dan untuk mengambilnya dengan mudah di masa depan. <br><br>  Tidak, tentu saja, ada perusahaan saat ini yang melacak alamat IP yang dialokasikan dalam spreadsheet Excel.  Tapi ini bukan cara kita. <br><br>  Bahkan untuk kantor ukuran terkecil di beberapa cabang, keberadaan sistem manajemen ruang IP terpusat tidak akan merugikan. <br><br>  Kebutuhan akan sistem inventaris jelas tanpa sepatah kata pun. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b44/a21/5cc/b44a215cc7c93ecf6eeca48c41d721d9.svg" width="800"><br><br>  Semua masalah ADSM: <br><br>  <a href="https://habr.com/ru/post/453516/">0. ADSM.</a>  <a href="https://habr.com/ru/post/453516/">Bagian Nol.</a>  <a href="https://habr.com/ru/post/453516/">Perencanaan</a> <br>  <a href="https://habr.com/ru/post/458622/">1. ADSM.</a>  <a href="https://habr.com/ru/post/458622/">Bagian Satu (yang setelah nol).</a>  <a href="https://habr.com/ru/post/458622/">Virtualisasi jaringan</a> <br>  <a href="https://habr.com/ru/post/475614/">2. ADSM.</a>  <a href="https://habr.com/ru/post/475614/">Bagian Dua.</a>  <a href="https://habr.com/ru/post/475614/">Desain jaringan</a> <br>  <a href="https://habr.com/ru/post/485618/">3. ADSM.</a>  <a href="https://habr.com/ru/post/485618/">Bagian Tiga.</a>  <a href="https://habr.com/ru/post/485618/">Sistem IPAM / DCIM</a> <br><br>  Masalah ini saya akan mencurahkan untuk sistem integral dalam otomatisasi jaringan - sistem manajemen ruang alamat dan sistem persediaan. <br><br>  Kami akan memilih dan menginstalnya, kami akan berurusan dengan arsitektur, skema basis data, antarmuka interaksi dan mengisinya.  Dan di bagian berikut, kita akan mulai menulis skrip sederhana yang mengotomatiskan operasi berulang, seperti menambahkan rak baru. <br><br>  Selain itu, saya sudah menerbitkan artikel terpisah tentang <a href="https://habr.com/ru/post/485618/">RESTful API</a> , di mana saya membuat ulasan singkat tentang prinsip dan kerjanya, kita akan membutuhkannya. <br><a name="habracut"></a><br><h1>  Isi </h1><br><ul><li>  <b>Arsitektur sistem</b> </li><li>  <b>Skema Data NetBox</b> </li><li>  <b>Kesimpulan</b> </li><li>  <b>Beberapa nuansa menginstal NetBox</b> </li><li>  <b>Sedikit tentang PostgreSQL</b> </li><li>  <b>Tautan yang bermanfaat</b> </li></ul><br>  Saat ini, pasar menawarkan sekitar selusin alat yang mengimplementasikan tugas ini: berbayar dan Open Source. <br><br>  Untuk tugas-tugas dalam seri artikel ini, saya memilih NetBox karena alasan berikut: <br><br><ol><li>  Ini gratis </li><li>  Ini berisi bagian yang diperlukan - inventaris dan manajemen ruang-IP. </li><li>  Ini memiliki API yang tenang. </li><li>  Ini dikembangkan oleh Digital Ocean (dan lebih khusus lagi, dicintai oleh semua orang Jeremy Stretch) untuk dirinya sendiri, yaitu untuk pusat data.  Karena itu, ada hampir semua yang Anda butuhkan, dan hampir tidak lebih. </li><li>  Ini didukung secara aktif (Slack, Github, Google Newsletters) dan sedang diperbarui. </li><li>  Ini open source </li></ol><br><blockquote>  Untuk kebutuhan ADSM, saya menggunakan NetBox di virtualochka di server kami (terima kasih kepada Anton Klochkov dan <a href="https://miran.ru/" rel="nofollow">Miran</a> ): <a href="http://netbox.linkmeup.ru:45127/" rel="nofollow">http://netbox.linkmeup.ru:45127</a> <br>  Selain itu, saya mengisi hampir semua data yang kami butuhkan di masa depan. <br>  Oleh karena itu, Anda dapat mencoba hampir semua contoh dan mempelajari skema data dalam mode baca hingga Anda menggunakan instalasi Anda. <br></blockquote>  Sedikit berguna sebelum Anda mulai: <br><br><ul><li>  <a href="https://github.com/netbox-community/netbox" rel="nofollow">NetBox sendiri di github</a> </li><li>  <a href="https://github.com/netbox-community/netbox-docker" rel="nofollow">Versi kontainer</a> </li><li>  <a href="https://netbox.readthedocs.io/en/stable/" rel="nofollow">Lengkapi instruksi pemasangan dan semua dokumentasi produk</a> </li><li>  <a href="https://github.com/digitalocean/pynetbox" rel="nofollow">Python NetKox SDK</a> </li><li>  <a href="http://netbox.linkmeup.ru:45127/api/docs/" rel="nofollow">Dokumentasi API</a> </li><li>  <a href="https://groups.google.com/forum/" rel="nofollow">Milis</a> </li><li>  <a href="https://networktocode.slack.com/" rel="nofollow">NetworkToCode Slack Channel</a> </li><li>  <a href="https://habr.com/ru/post/485618/">Apa itu REST?</a> </li><li>  <a href="http://netbox.linkmeup.ru:45127/" rel="nofollow">Instalasi NetBox untuk ADSM</a> </li></ul><br><hr><br><h1>  Arsitektur sistem </h1><br><ul><li>  NetBox ditulis dalam Python3.  Yang bagus, karena sejumlah solusi lain ditulis dalam php dan mengubahnya jika perlu tidak begitu sederhana. </li><li>  Kerangka kerja untuk situs itu sendiri adalah Django. </li><li>  PostgreSQL digunakan sebagai basis data. </li><li>  WEB-frontend (layanan HTTP) - NGINX - proksi permintaan ke Gunicron. </li><li>  WSGI - Gunicorn - antarmuka antara Nginx dan aplikasi itu sendiri. </li><li>  Kerangka kerja dokumentasi API - Sombong. </li><li>  Untuk menjelekkan NetBox - Systemd. </li></ul><br><blockquote>  NetBox adalah proyek muda dan serba cepat.  Sebagai contoh, pada 2.7 mereka meninggalkan supervisord dan Python 2.7 meraihnya demi systemd.  Belum lama ini, tidak ada caching atau Webhooks. <br><br>  Oleh karena itu, segala sesuatu berubah dengan cepat dan informasi dalam artikel dapat menjadi usang pada saat membaca. <br></blockquote><br>  Dengan kata lain, semua komponen sudah matang dan diuji. <br><br>  Menurut penulis, NetBox tidak mencerminkan keadaan sebenarnya dari jaringan, tetapi target.  Oleh karena itu, tidak ada yang dimuat ke NetBox dari jaringan - jaringan ini dikonfigurasi sesuai dengan isi NetBox. <br>  Dengan demikian, NetBox bertindak sebagai satu-satunya sumber kebenaran (kertas kalkir dengan satu sumber kebenaran). <br><br>  Dan perubahan pada jaringan harus dipicu oleh perubahan pada NetBox. <br><br>  Dan itu sangat cocok dengan ideologi yang saya anut dalam seri artikel ini - jika Anda ingin membuat perubahan pada jaringan - pertama-tama buatlah itu dalam sistem. <br><br><hr><br><h1>  Skema Data NetBox </h1><br>  Dua tugas utama yang diselesaikan NetBox adalah menangani manajemen ruang dan inventaris. <br><br>  NetBox tidak mungkin menjadi satu-satunya sistem inventaris di perusahaan, melainkan, itu akan menjadi sistem tambahan khusus untuk inventaris jaringan, mengambil data dari yang utama. <br><br>  Jelas, dalam kasus kami, hanya akan ada NetBox untuk keperluan ADSM. <br><blockquote>  Pada titik ini, sebagian besar data awal di NetBox telah dimasukkan. <br>  Pada data ini saya akan menunjukkan berbagai contoh bekerja melalui API. <br>  Anda bisa memanjat dan melihat: <a href="http://netbox.linkmeup.ru/" rel="nofollow">netbox.linkmeup.ru</a> : 45127 <br>  Dan data yang sama akan dibutuhkan di masa mendatang, ketika kita beralih ke otomatisasi. <br></blockquote>  Secara umum, skema data dapat dilihat oleh skema database di Postgres. <br><br><pre><code class="bash hljs">List of relations Schema | Name | Type | Owner --------+------------------------------------+-------+-------- public | auth_group | table | netbox public | auth_group_permissions | table | netbox public | auth_permission | table | netbox public | auth_user | table | netbox public | auth_user_groups | table | netbox public | auth_user_user_permissions | table | netbox public | circuits_circuit | table | netbox public | circuits_circuittermination | table | netbox public | circuits_circuittype | table | netbox public | circuits_provider | table | netbox public | dcim_cable | table | netbox public | dcim_consoleport | table | netbox public | dcim_consoleporttemplate | table | netbox public | dcim_consoleserverport | table | netbox public | dcim_consoleserverporttemplate | table | netbox public | dcim_device | table | netbox public | dcim_devicebay | table | netbox public | dcim_devicebaytemplate | table | netbox public | dcim_devicerole | table | netbox public | dcim_devicetype | table | netbox public | dcim_frontport | table | netbox public | dcim_frontporttemplate | table | netbox public | dcim_interface | table | netbox public | dcim_interface_tagged_vlans | table | netbox public | dcim_interfacetemplate | table | netbox public | dcim_inventoryitem | table | netbox public | dcim_manufacturer | table | netbox public | dcim_platform | table | netbox public | dcim_powerfeed | table | netbox public | dcim_poweroutlet | table | netbox public | dcim_poweroutlettemplate | table | netbox public | dcim_powerpanel | table | netbox public | dcim_powerport | table | netbox public | dcim_powerporttemplate | table | netbox public | dcim_rack | table | netbox public | dcim_rackgroup | table | netbox public | dcim_rackreservation | table | netbox public | dcim_rackrole | table | netbox public | dcim_rearport | table | netbox public | dcim_rearporttemplate | table | netbox public | dcim_region | table | netbox public | dcim_site | table | netbox public | dcim_virtualchassis | table | netbox public | django_admin_log | table | netbox public | django_content_type | table | netbox public | django_migrations | table | netbox public | django_session | table | netbox public | extras_configcontext | table | netbox public | extras_configcontext_platforms | table | netbox public | extras_configcontext_regions | table | netbox public | extras_configcontext_roles | table | netbox public | extras_configcontext_sites | table | netbox public | extras_configcontext_tags | table | netbox public | extras_configcontext_tenant_groups | table | netbox public | extras_configcontext_tenants | table | netbox public | extras_customfield | table | netbox public | extras_customfield_obj_type | table | netbox public | extras_customfieldchoice | table | netbox public | extras_customfieldvalue | table | netbox public | extras_customlink | table | netbox public | extras_exporttemplate | table | netbox public | extras_graph | table | netbox public | extras_imageattachment | table | netbox public | extras_objectchange | table | netbox public | extras_reportresult | table | netbox public | extras_tag | table | netbox public | extras_taggeditem | table | netbox public | extras_webhook | table | netbox public | extras_webhook_obj_type | table | netbox public | ipam_aggregate | table | netbox public | ipam_ipaddress | table | netbox public | ipam_prefix | table | netbox public | ipam_rir | table | netbox public | ipam_role | table | netbox public | ipam_service | table | netbox public | ipam_service_ipaddresses | table | netbox public | ipam_vlan | table | netbox public | ipam_vlangroup | table | netbox public | ipam_vrf | table | netbox public | secrets_secret | table | netbox public | secrets_secretrole | table | netbox public | secrets_secretrole_groups | table | netbox public | secrets_secretrole_users | table | netbox public | secrets_sessionkey | table | netbox public | secrets_userkey | table | netbox public | taggit_tag | table | netbox public | taggit_taggeditem | table | netbox public | tenancy_tenant | table | netbox public | tenancy_tenantgroup | table | netbox public | users_token | table | netbox public | virtualization_cluster | table | netbox public | virtualization_clustergroup | table | netbox public | virtualization_clustertype | table | netbox public | virtualization_virtualmachine | table | netbox</code> </pre> <br>  <a href="https://netbox.readthedocs.io/en/stable/" rel="nofollow">Fitur NetBox</a> : <br><br><ul><li>  <b>Manajemen alamat IP (IPAM)</b> - Awalan IP, alamat, VRF, dan VLAN </li><li>  <b>Rak peralatan</b> - <b>Rak peralatan yang</b> diorganisir berdasarkan lokasi, grup, dan peran </li><li>  <b>Perangkat</b> - Perangkat, model, peran, komponen, dan penyebarannya </li><li>  <b>Koneksi</b> - <b>Koneksi</b> jaringan, konsol, dan daya antar perangkat </li><li>  <b>Virtualisasi</b> - Mesin Virtual dan Cluster Komputer </li><li>  <b>Sirkuit data</b> - Koneksi Penyedia </li><li>  <b>Rahasia</b> - Penyimpanan Kredensial Pengguna Terenkripsi </li></ul><br>  Pada artikel ini saya akan menyentuh hal-hal berikut: DCIM - Manajemen Infrastruktur Pusat Data, IPAM - Manajemen Alamat IP, Virtualisasi, Hal-hal baik tambahan. <br><br><hr><br>  Hal pertama yang pertama. <br><br><h2>  DCIM </h2><br>  Bagian yang paling penting tidak diragukan lagi peralatan apa yang kita miliki dan bagaimana itu saling terhubung.  Tapi itu semua dimulai dari <b>tempatnya</b> . <br><br><h3>  Wilayah dan situs (wilayah / situs) </h3><br>  Dalam paradigma NetBox, perangkat dipasang di situs, situs milik wilayah, wilayah dapat disarangkan.  Namun, perangkat tidak dapat diinstal hanya di wilayah tersebut.  Jika ada kebutuhan seperti itu, situs terpisah harus didirikan. <br><br>  Untuk kasus kami, ini mungkin (dan akan) terlihat seperti ini: <br><br><ul><li>  <a href="http://netbox.linkmeup.ru:45127/dcim/sites/%3Fregion%3Dru" rel="nofollow">Rusia</a> : <a href="http://netbox.linkmeup.ru:45127/dcim/sites/msk/" rel="nofollow">Moskow</a> , <a href="http://netbox.linkmeup.ru:45127/dcim/sites/kzn/" rel="nofollow">Kazan</a> </li><li>  <a href="http://netbox.linkmeup.ru:45127/dcim/sites/%3Fregion%3Dsp" rel="nofollow">Spanyol</a> : <a href="http://netbox.linkmeup.ru:45127/dcim/sites/bcn/" rel="nofollow">Barcelona</a> , <a href="http://netbox.linkmeup.ru:45127/dcim/sites/mlg/" rel="nofollow">Malaga</a> </li><li>  <a href="http://netbox.linkmeup.ru:45127/dcim/sites/%3Fregion%3Dcn" rel="nofollow">Cina</a> : <a href="http://netbox.linkmeup.ru:45127/dcim/sites/sha/" rel="nofollow">Shanghai</a> , <a href="http://netbox.linkmeup.ru:45127/dcim/sites/Sia/" rel="nofollow">Xi'an</a> . </li></ul><br><img src="https://habrastorage.org/getpro/habr/post_images/703/ab7/358/703ab73587ab4d1fe9079aa548ba93d1.png" width="800"><br><br>  Saya mengingatkan Anda di mana dan bagaimana kami merencanakan jaringan kami: <a href="https://linkmeup.ru/blog/479.html" rel="nofollow">ADSM2.</a>  <a href="https://linkmeup.ru/blog/479.html" rel="nofollow">Desain jaringan</a> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1df/012/888/1df0128888e0708959f6108e176a0de9.png" width="700"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/d5d/b34/709/d5db34709814c8e1fe07f74b8c9f96fd.png" width="800"><br><br>  Mari kita lihat apa yang diizinkan oleh API. <br><br>  Berikut adalah daftar semua wilayah: <br><br><pre> <code class="bash hljs">curl -X GET <span class="hljs-string"><span class="hljs-string">"http://netbox.linkmeup.ru:45127/api/dcim/regions/"</span></span> -H <span class="hljs-string"><span class="hljs-string">"Accept: application/json; indent=4"</span></span></code> </pre> <br><pre> <code class="python hljs">nb.dcim.regions.all()</code> </pre> <br><blockquote>  Selanjutnya saya akan memberikan contoh curl dan pynetbox tanpa mengeluarkan hasilnya. <br>  <b>Jangan lupa</b> garis miring di akhir URL - tanpanya tidak akan berfungsi. <br>  Saya berbicara tentang cara menggunakan pynetbox dalam sebuah artikel tentang RESTful <a href="https://habr.com/ru/post/485618/">API</a> . <br></blockquote>  Dapatkan daftar situs: <br><br><pre> <code class="bash hljs">curl -X GET <span class="hljs-string"><span class="hljs-string">"http://netbox.linkmeup.ru:45127/api/dcim/sites/"</span></span> -H <span class="hljs-string"><span class="hljs-string">"Accept: application/json; indent=4"</span></span></code> </pre> <br><pre> <code class="python hljs">nb.dcim.sites.all()</code> </pre><br>  Daftar situs di wilayah tertentu: <br><br><pre> <code class="bash hljs">curl -X GET <span class="hljs-string"><span class="hljs-string">"http://netbox.linkmeup.ru:45127/api/dcim/sites/?region=ru"</span></span> -H <span class="hljs-string"><span class="hljs-string">"Accept: application/json; indent=4"</span></span></code> </pre> <br><pre> <code class="python hljs">nb.dcim.sites.filter(region=<span class="hljs-string"><span class="hljs-string">"ru"</span></span>)</code> </pre><br><blockquote>  Harap dicatat bahwa pencarian bukan dengan nama lengkap, tetapi oleh yang disebut <a href="https://qna.habr.com/q/375615" rel="nofollow">siput</a> . <br>  <b>Slug</b> adalah pengidentifikasi yang hanya berisi karakter aman: [0-9A-Za-z-_], yang dapat digunakan dalam URL.  Sudah diatur saat membuat objek, misalnya, "bcn" bukan "Barcelona". <br><img src="https://habrastorage.org/getpro/habr/post_images/3db/6cc/f89/3db6ccf89097c571900457aebbc922fe.png" width="400"><br></blockquote><br><hr><br><h3>  Perangkat </h3><br>  Perangkat itu sendiri memiliki <a href="http://netbox.linkmeup.ru:45127/dcim/device-roles/" rel="nofollow">peran</a> , misalnya, daun, tulang belakang, tepi, tepi. <br><br>  Jelas, itu adalah semacam <a href="http://netbox.linkmeup.ru:45127/dcim/device-types/" rel="nofollow">model dari</a> beberapa <a href="http://netbox.linkmeup.ru:45127/dcim/manufacturers/" rel="nofollow">vendor</a> . <br>  Misalnya, <a href="http://netbox.linkmeup.ru:45127/dcim/device-types/%3Fmanufacturer%3Darista" rel="nofollow">Arista</a> . <br><br>  Jadi, vendor dibuat terlebih dahulu, lalu di dalam model. <br><br>  <a href="http://netbox.linkmeup.ru:45127/dcim/device-types/2/" rel="nofollow">Model ini</a> ditandai dengan nama, satu set antarmuka layanan, antarmuka kontrol jarak jauh, port konsol, dan satu set modul daya. <br><br>  Selain sakelar, router, dan host dengan antarmuka Ethernet, Anda dapat membuat server konsol. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/826/9a4/f9f/8269a4f9ffb7f7e66096eff89dc19013.png" width="800"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/c81/cce/0f9/c81cce0f9d543eedd4f7c1e1ede5f43f.png" width="500"><br><br>  Dapatkan daftar semua perangkat: <br><br><pre> <code class="bash hljs">curl -X GET <span class="hljs-string"><span class="hljs-string">"http://netbox.linkmeup.ru:45127/api/dcim/devices/"</span></span> -H <span class="hljs-string"><span class="hljs-string">"Accept: application/json; indent=4"</span></span></code> </pre> <br><pre> <code class="python hljs">nb.dcim.devices.all()</code> </pre><br>  Semua perangkat untuk situs tertentu: <br><br><pre> <code class="bash hljs">curl -X GET <span class="hljs-string"><span class="hljs-string">"http://netbox.linkmeup.ru:45127/api/dcim/devices/?site=mlg"</span></span> -H <span class="hljs-string"><span class="hljs-string">"Accept: application/json; indent=4"</span></span></code> </pre> <br><pre> <code class="python hljs">nb.dcim.devices.filter(site=<span class="hljs-string"><span class="hljs-string">"mlg"</span></span>)</code> </pre><br>  Semua perangkat model tertentu <br><br><pre> <code class="bash hljs">curl -X GET <span class="hljs-string"><span class="hljs-string">"http://netbox.linkmeup.ru:45127/api/dcim/devices/?model=veos"</span></span> -H <span class="hljs-string"><span class="hljs-string">"Accept: application/json; indent=4"</span></span></code> </pre> <br><pre> <code class="python hljs">nb.dcim.devices.filter(device_type_id=<span class="hljs-number"><span class="hljs-number">2</span></span>)</code> </pre><br>  Semua perangkat dengan peran tertentu: <br><br><pre> <code class="bash hljs">curl -X GET <span class="hljs-string"><span class="hljs-string">"http://netbox.linkmeup.ru:45127/api/dcim/devices/?role=leaf"</span></span> -H <span class="hljs-string"><span class="hljs-string">"Accept: application/json; indent=4"</span></span></code> </pre> <br><pre> <code class="python hljs">nb.dcim.devices.filter(role=<span class="hljs-string"><span class="hljs-string">"leaf"</span></span>)</code> </pre><br>  Perangkat dapat dalam berbagai status: Aktif, Offline, Direncanakan, dll. <br><br>  Semua perangkat aktif: <br><br><pre> <code class="bash hljs">curl -X GET <span class="hljs-string"><span class="hljs-string">"http://netbox.linkmeup.ru:45127/api/dcim/devices/?status=active"</span></span> -H <span class="hljs-string"><span class="hljs-string">"Accept: application/json; indent=4"</span></span></code> </pre> <br><pre> <code class="python hljs">nb.dcim.devices.filter(status=<span class="hljs-string"><span class="hljs-string">"active"</span></span>)</code> </pre><br><hr><br><h3>  Antarmuka </h3><br>  NetBox mendukung banyak jenis <a href="http://netbox.linkmeup.ru:45127/api/dcim/_choices/" rel="nofollow">antarmuka</a> fisik dan LAG, namun, semua yang virtual seperti Vlan / IRB dan loopback digabungkan dalam satu jenis - Virtual. <br>  Setiap antarmuka terikat ke perangkat. <br><br>  Antarmuka perangkat dapat dihubungkan satu sama lain.  Ini akan ditampilkan baik di antarmuka maupun di respons API (atribut connected_endpoint). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/aea/c56/b47/aeac56b47e58145211f5726c8e48cb91.png" width="800"><br><br>  Antarmuka dapat dalam berbagai mode: Ditandai atau Akses. <br><br>  Dengan demikian, dapat diluncurkan ke tag dengan atau tanpa VLAN - situs ini atau global. <br><br>  Dapatkan daftar semua antarmuka perangkat: <br><br><pre> <code class="bash hljs">curl -X GET <span class="hljs-string"><span class="hljs-string">"http://netbox.linkmeup.ru:45127/api/dcim/interfaces/?device=mlg-leaf-0"</span></span> -H <span class="hljs-string"><span class="hljs-string">"Accept: application/json; indent=4"</span></span></code> </pre> <br><pre> <code class="python hljs">nb.dcim.interfaces.filter(device=<span class="hljs-string"><span class="hljs-string">"mlg-leaf-0"</span></span>)</code> </pre><br>  Dapatkan daftar VLAN dari antarmuka tertentu. <br><br><pre> <code class="bash hljs">curl -X GET <span class="hljs-string"><span class="hljs-string">"http://netbox.linkmeup.ru:45127/api/dcim/interfaces/?device=mlg-leaf-0&amp;name=Ethernet7"</span></span> -H <span class="hljs-string"><span class="hljs-string">"Accept: application/json; indent=4"</span></span></code> </pre> <br><pre> <code class="python hljs">nb.dcim.interfaces.get(device=<span class="hljs-string"><span class="hljs-string">"mlg-leaf-0"</span></span>, name=<span class="hljs-string"><span class="hljs-string">"Ethernet7"</span></span>).untagged_vlan.vid</code> </pre><br><blockquote>  Perhatikan bahwa di sini saya sudah menggunakan metode <b>get</b> alih-alih <b>filter</b> .  Filter mengembalikan daftar, bahkan jika hasilnya adalah satu objek tunggal.  Dapatkan - mengembalikan satu objek atau gagal jika hasil kueri adalah daftar objek. <br><br>  Karena itu, gunakan hanya jika Anda benar-benar yakin bahwa hasilnya akan ada dalam satu salinan. <br><br>  Di sini, tepat setelah permintaan, saya beralih ke atribut objek.  Sebenarnya, ini salah: jika tidak ada yang ditemukan oleh permintaan, maka pynetbox akan mengembalikan Tidak ada, dan tidak memiliki atribut "untagged_vlan". <br><br>  Dan juga perhatikan bahwa tidak di mana-mana pynetbox mengharapkan siput, di suatu tempat, dan nama. <br></blockquote>  Cari tahu antarmuka perangkat mana yang terhubung dengan antarmuka tertentu: <br><br><pre> <code class="bash hljs">curl -X GET <span class="hljs-string"><span class="hljs-string">"http://netbox.linkmeup.ru:45127/api/dcim/interfaces/?device=mlg-leaf-0&amp;name=Ethernet1"</span></span> -H <span class="hljs-string"><span class="hljs-string">"Accept: application/json; indent=4"</span></span></code> </pre> <br><pre> <code class="python hljs">iface = nb.dcim.interfaces.get(device=<span class="hljs-string"><span class="hljs-string">"mlg-leaf-0"</span></span>, name=<span class="hljs-string"><span class="hljs-string">"Ethernet1"</span></span>) iface.connected_endpoint.device iface.connected_endpoint.name</code> </pre><br>  Cari tahu nama antarmuka manajemen: <br><br><pre> <code class="bash hljs">curl -X GET <span class="hljs-string"><span class="hljs-string">"http://netbox.linkmeup.ru:45127/api/dcim/interfaces/?device=mlg-leaf-0&amp;mgmt_only=true"</span></span> -H <span class="hljs-string"><span class="hljs-string">"Accept: application/json; indent=4"</span></span></code> </pre> <br><pre> <code class="python hljs">nb.dcim.interfaces.get(device=<span class="hljs-string"><span class="hljs-string">"mlg-leaf-0"</span></span>, mgmt_only=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)</code> </pre><br><hr><br><h3>  Port konsol </h3><br>  Port konsol bukan antarmuka, oleh karena itu port diberikan sebagai titik akhir yang terpisah. <br>  Port perangkat dapat dikaitkan dengan port server konsol. <br><br>  Cari tahu port mana yang terhubung ke server konsol perangkat tertentu. <br><br><pre> <code class="bash hljs">curl -X GET <span class="hljs-string"><span class="hljs-string">"http://netbox.linkmeup.ru:45127/api/dcim/console-ports/?device=mlg-leaf-0"</span></span> -H <span class="hljs-string"><span class="hljs-string">"Accept: application/json; indent=4"</span></span></code> </pre> <br><pre> <code class="python hljs">nb.dcim.console_ports.get(device=<span class="hljs-string"><span class="hljs-string">"mlg-leaf-0"</span></span>).serialize()</code> </pre><br><blockquote>  Metode <b>serialisasi</b> dalam pynetbox memungkinkan Anda untuk mengubah atribut instance kelas menjadi kamus. <br></blockquote><hr><br><h2>  Ipam </h2><br><h3>  VLAN dan VRF </h3><br>  Mereka dapat diikat ke lokasi - berguna untuk VLAN. <br><br>  Saat membuat VRF, Anda dapat menentukan apakah ruang alamat diizinkan untuk berpotongan dengan VRF lain. <br><br>  Dapatkan daftar semua VLAN: <br><br><pre> <code class="bash hljs">curl -X GET <span class="hljs-string"><span class="hljs-string">"http://netbox.linkmeup.ru:45127/api/ipam/vlans/"</span></span> -H <span class="hljs-string"><span class="hljs-string">"Accept: application/json; indent=4"</span></span></code> </pre> <br><pre> <code class="python hljs">nb.ipam.vlans.all()</code> </pre><br>  Dapatkan daftar semua VRF: <br><br><pre> <code class="bash hljs">curl -X GET <span class="hljs-string"><span class="hljs-string">"http://netbox.linkmeup.ru:45127/api/ipam/vrfs/"</span></span> -H <span class="hljs-string"><span class="hljs-string">"Accept: application/json; indent=4"</span></span></code> </pre> <br><pre> <code class="python hljs">nb.ipam.vrfs.all()</code> </pre><br><hr><br><h3>  Awalan IP </h3><br>  Mereka memiliki struktur hierarkis.  Ini mungkin milik VRF apa pun (jika tidak, maka Global). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/94b/ea6/8c4/94bea68c425c9a8bd601c9a0da74193e.png" width="800"><br><br>  NetBox memiliki representasi visual awalan gratis yang sangat nyaman: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1be/90e/14d/1be90e14da8f4c3bedc4bcb892cb5156.png" width="800"><br><br>  Anda dapat memilihnya hanya dengan mengklik garis hijau. <br><br>  Itu bisa dilampirkan ke suatu lokasi.  Anda dapat memilih sub-awalan gratis berikutnya dari ukuran yang diperlukan atau alamat IP gratis berikutnya melalui API. <br><br>  Tanda centang / parameter "Apakah kolam" menentukan apakah alamat ke-0 dari awalan ini akan disorot selama pemilihan otomatis, atau apakah akan mulai dari tanggal 1. <br><br>  Dapatkan daftar awalan IP dari situs Malaga dengan peran dan panjang Underlay 19: <br><br><pre> <code class="bash hljs">curl -X GET <span class="hljs-string"><span class="hljs-string">"http://netbox.linkmeup.ru:45127/api/ipam/prefixes/?site=mlg&amp;role=underlay&amp;mask_length=19"</span></span> -H <span class="hljs-string"><span class="hljs-string">"Accept: application/json; indent=4"</span></span></code> </pre> <br><pre> <code class="python hljs">prefix = nb.ipam.prefixes.get(site=<span class="hljs-string"><span class="hljs-string">"mlg"</span></span>, role=<span class="hljs-string"><span class="hljs-string">"underlay"</span></span>, mask_length=<span class="hljs-string"><span class="hljs-string">"19"</span></span>)</code> </pre><br>  Dapatkan daftar awalan gratis di wilayah Rusia dengan peran Underlay: <br><br><pre> <code class="bash hljs">curl -X GET <span class="hljs-string"><span class="hljs-string">"http://netbox.linkmeup.ru:45127/api/ipam/prefixes/40/available-prefixes/"</span></span> -H <span class="hljs-string"><span class="hljs-string">"Accept: application/json; indent=4"</span></span></code> </pre> <br><pre> <code class="bash hljs">prefix.available_prefixes.list()</code> </pre> <br>  Sorot 24 awalan gratis berikut: <br><br><pre> <code class="bash hljs">curl -X POST <span class="hljs-string"><span class="hljs-string">"http://netbox.linkmeup.ru:45127/api/ipam/prefixes/40/available-prefixes/"</span></span> \ -H <span class="hljs-string"><span class="hljs-string">"accept: application/json"</span></span> \ -H <span class="hljs-string"><span class="hljs-string">"Content-Type: application/json"</span></span> \ -H <span class="hljs-string"><span class="hljs-string">"Authorization: TOKEN a9aae70d65c928a554f9a038b9d4703a1583594f"</span></span> \ -d <span class="hljs-string"><span class="hljs-string">"{\"prefix_length\": 24}"</span></span></code> </pre> <br><pre> <code class="bash hljs">prefix.available_prefixes.create({<span class="hljs-string"><span class="hljs-string">"prefix_length"</span></span>:24})</code> </pre> <br><blockquote>  Ketika kita perlu memilih beberapa anak di dalam satu objek, metode POST digunakan dan kita perlu menentukan ID objek induk - dalam hal ini - <b>40</b> .  Kami mengetahuinya dengan menelepon dari contoh sebelumnya. <br>  Dalam kasus kotak sinkronisasi, pertama-tama kita (dalam contoh sebelumnya) menyimpan hasilnya ke variabel <b>awalan</b> , dan kemudian beralih ke atribut <b>available_prefixes</b> dan metode <b>create</b> . <br>  Contoh ini <b>tidak</b> akan <b>berfungsi</b> untuk Anda, karena token dengan hak tulis sudah tidak valid. <br></blockquote><hr><br><h3>  Alamat IP </h3><br>  Jika ada awalan termasuk alamat ini, mereka akan menjadi bagian dari itu.  Mereka bisa sendirian. <br>  Dapat menjadi bagian dari VRF atau berada di Global. <br>  Mereka dapat dilampirkan ke antarmuka, tetapi dapat menggantung di udara. <br>  Anda dapat memilih alamat IP gratis berikutnya di awalan. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/4a1/c4d/442/4a1c4d4428f703d9a90766ffa9351fe8.png" width="800"><br><br>  Untuk melakukan ini, cukup klik pada garis hijau. <br><br>  Dapatkan daftar alamat IP untuk antarmuka tertentu: <br><br><pre> <code class="bash hljs">curl -X GET <span class="hljs-string"><span class="hljs-string">"http://netbox.linkmeup.ru:45127/api/ipam/ip-addresses/?interface_id=8"</span></span> -H <span class="hljs-string"><span class="hljs-string">"Accept: application/json; indent=4"</span></span></code> </pre> <br><pre> <code class="python hljs">nb.ipam.ip_addresses.filter(interface_id=<span class="hljs-number"><span class="hljs-number">8</span></span>)</code> </pre><br>  Atau: <br><br><pre> <code class="bash hljs">curl -X GET <span class="hljs-string"><span class="hljs-string">"http://netbox.linkmeup.ru:45127/api/ipam/ip-addresses/?device=mlg-leaf-0&amp;interface=Ethernet1"</span></span> -H <span class="hljs-string"><span class="hljs-string">"Accept: application/json; indent=4"</span></span></code> </pre> <br><pre> <code class="python hljs">nb.ipam.ip_addresses.filter(device=<span class="hljs-string"><span class="hljs-string">"mlg-leaf-0"</span></span>, interface=<span class="hljs-string"><span class="hljs-string">"Ethernet1"</span></span>)</code> </pre><br>  Dapatkan daftar semua alamat IP perangkat: <br><br><pre> <code class="bash hljs">curl -X GET <span class="hljs-string"><span class="hljs-string">"http://netbox.linkmeup.ru:45127/api/ipam/ip-addresses/?device=mlg-leaf-0"</span></span> -H <span class="hljs-string"><span class="hljs-string">"Accept: application/json; indent=4"</span></span></code> </pre> <br><pre> <code class="python hljs">nb.ipam.ip_addresses.filter(device=<span class="hljs-string"><span class="hljs-string">"mlg-leaf-0"</span></span>)</code> </pre><br>  Dapatkan daftar alamat IP awalan yang tersedia: <br><br><pre> <code class="bash hljs">curl -X GET <span class="hljs-string"><span class="hljs-string">"http://netbox.linkmeup.ru:45127/api/ipam/prefixes/28/available-ips/"</span></span> -H <span class="hljs-string"><span class="hljs-string">"Accept: application/json; indent=4"</span></span></code> </pre> <br><pre> <code class="python hljs">prefix = nb.ipam.prefixes.get(site=<span class="hljs-string"><span class="hljs-string">"mlg"</span></span>, role=<span class="hljs-string"><span class="hljs-string">"leaf-loopbacks"</span></span>) prefix.available_ips.list()</code> </pre><br><blockquote>  Di sini lagi, Anda perlu menentukan ID awalan di URL dari mana kami memilih alamat - kali ini adalah 28. <br></blockquote>  Sorot alamat IP gratis berikut di awalan: <br><br><pre> <code class="bash hljs">curl -X POST <span class="hljs-string"><span class="hljs-string">"http://netbox.linkmeup.ru:45127/api/ipam/prefixes/28/available-ips/"</span></span> \ -H <span class="hljs-string"><span class="hljs-string">"accept: application/json"</span></span> \ -H <span class="hljs-string"><span class="hljs-string">"Content-Type: application/json"</span></span> \ -H <span class="hljs-string"><span class="hljs-string">"Authorization: TOKEN a9aae70d65c928a554f9a038b9d4703a1583594f"</span></span></code> </pre> <br><pre> <code class="bash hljs">prefix.available_ips.create()</code> </pre> <br><hr><br><h2>  Virtualisasi </h2><br>  Kami masih berjuang untuk gelar DC modern.  Dimana tanpa virtualisasi. <br><br>  NetBox tidak terlihat dan bukan tempat yang layak menyimpan informasi tentang mesin virtual (Anda bahkan dapat berspekulasi tentang perlunya menyimpan mesin fisik di dalamnya).  Namun, ini mungkin berguna bagi kami, misalnya, Anda dapat memasukkan informasi tentang Rute Reflektor, mesin servis, seperti NTP, Syslog, server S-Flow, dan mesin kontrol. <br><br>  VM memiliki daftar antarmuka sendiri - mereka berbeda dari antarmuka perangkat fisik dan memiliki Endpoint tersendiri. <br><br>  Jadi, Anda dapat mendaftar semua mesin virtual: <br><br><pre> <code class="bash hljs">curl -X GET <span class="hljs-string"><span class="hljs-string">"http://netbox.linkmeup.ru:45127/api/virtualization/virtual-machines/"</span></span> -H <span class="hljs-string"><span class="hljs-string">"Accept: application/json; indent=4"</span></span></code> </pre> <br><pre> <code class="python hljs">nb.virtualization.virtual_machines.all()</code> </pre><br>  Jadi - dari semua antarmuka semua VM: <br><br><pre> <code class="bash hljs">curl -X GET <span class="hljs-string"><span class="hljs-string">"http://netbox.linkmeup.ru:45127/api/virtualization/interfaces/"</span></span> -H <span class="hljs-string"><span class="hljs-string">"Accept: application/json; indent=4"</span></span></code> </pre> <br><pre> <code class="python hljs">nb.virtualization.interfaces.all()</code> </pre><br>  Untuk VM, Anda tidak bisa menentukan mesin hypervisor / fisik spesifik yang menjalankannya, tetapi Anda bisa menentukan cluster.  Meski tidak semuanya begitu putus asa.  Baca terus. <br><br><hr><br><h2>  Barang-barang ekstra bagus </h2><br>  Fungsi dasar NetBox mencakup sebagian besar tugas banyak pengguna, tetapi tidak semua.  Meski begitu, produk ini awalnya ditulis untuk memecahkan masalah perusahaan tertentu.  Namun, itu secara aktif berkembang dan rilis baru keluar cukup <a href="https://github.com/netbox-community/netbox/releases" rel="nofollow">sering</a> .  Dengan demikian, fungsi-fungsi baru muncul. <br><br>  Jadi, misalnya, dari instalasi NetBox pertama saya beberapa tahun yang lalu, tag muncul di dalamnya, konfigurasi konteks, webhooks, caching, pengawas diubah menjadi systemd, penyimpanan file eksternal. <br><br>  Hati-hati <br><br><h3>  Bidang khusus </h3><br>  Terkadang Anda ingin menambahkan bidang ke entitas mana pun di mana Anda dapat menempatkan data sewenang-wenang. <br><br>  Misalnya, tunjukkan jumlah perjanjian pasokan dengan mana sakelar dibeli atau nama mesin fisik tempat VM dijalankan. <br><br>  Di sinilah bidang khusus datang ke penyelamatan - hanya bidang seperti itu dengan nilai teks yang dapat ditambahkan ke hampir semua entitas di NetBox. <br><br>  Buat bidang khusus di panel admin <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1cf/10e/568/1cf10e56808f227ce7f7270581b84a31.png" width="600"><br><br>  Ini adalah tampilannya ketika mengedit perangkat tempat bidang khusus dibuat: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d3a/c2b/c78/d3ac2bc78d80acccc3895463f7ed7295.png" width="450"><br><br>  Minta daftar perangkat dengan nilai custom_field <br><br><pre> <code class="bash hljs">curl -X GET <span class="hljs-string"><span class="hljs-string">"http://netbox.linkmeup.ru:45127/api/dcim/devices/?cf_contract_number=0123456789"</span></span> -H <span class="hljs-string"><span class="hljs-string">"Accept: application/json; indent=4"</span></span></code> </pre> <br><pre> <code class="python hljs">nb.dcim.devices.filter(cf_contract_number=<span class="hljs-string"><span class="hljs-string">"0123456789"</span></span>)</code> </pre><br><hr><br><h3>  Konteks Konfigurasi </h3><br>  Terkadang Anda menginginkan sesuatu lebih dari teks yang tidak terstruktur.  Kemudian <a href="http://netbox.linkmeup.ru:45127/extras/config-contexts/1/" rel="nofollow">Konteks Config</a> datang untuk menyelamatkan. <br><br>  Ini adalah kesempatan untuk memperkenalkan sekumpulan data terstruktur dalam format JSON, yang tidak bisa ditaruh di tempat lain. <br><br>  Ini bisa, misalnya, satu set komunitas BGP atau daftar server Syslog. <br><br>  Konteks Config dapat lokal - dikonfigurasi untuk objek tertentu - atau global, ketika dikonfigurasi sekali, dan kemudian berlaku untuk semua objek yang memenuhi kondisi tertentu (misalnya, terletak di situs yang sama, atau berjalan di platform yang sama). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/97a/406/224/97a406224499ed35e9c471c3709a8d98.png" width="800"><br><br>  Konteks Config secara otomatis ditambahkan ke hasil permintaan.  Pada saat yang sama, konteks lokal dan global bergabung menjadi satu. <br><br>  Misalnya, untuk perangkat yang hanya seorang gadis Rusia, yang memiliki konteks lokal, output akan berisi kunci ‚Äúconfig_context‚Äù: <br><br><pre> <code class="bash hljs">curl -X GET <span class="hljs-string"><span class="hljs-string">"http://netbox.linkmeup.ru:45127/api/dcim/devices/?q=russian"</span></span> -H <span class="hljs-string"><span class="hljs-string">"Accept: application/json; indent=4"</span></span></code> </pre> <br><img src="https://habrastorage.org/getpro/habr/post_images/031/608/4bd/0316084bd52d028434631298a22ba33e.png" width="204"><br><br><hr><br><h3>  Tag </h3><br>  Sulit mengatakan sesuatu yang baru tentang tag.  Mereka adalah.  Mereka nyaman untuk menambahkan fitur apa pun.  Misalnya, Anda dapat menandai "byada" untuk beralih dari kumpulan memori yang gagal. <br><br><hr><br><h3>  Situs web </h3><br>  Suatu hal yang tak tergantikan ketika Anda membutuhkan layanan lain untuk mempelajari tentang perubahan di NetBox. <br>  Misalnya, ketika memulai sakelar baru, kait dikirim ke sistem otomasi, yang memulai proses pengaturan perangkat dan mengoperasikannya. <br><br><hr><br><h1>  Kesimpulan </h1><br>  Pada artikel ini, saya tidak bermaksud mempertimbangkan semua fitur NetBox, jadi saya akan memberikan segalanya kepada Anda.  Pahami, coba. <br><br>  Selanjutnya, sebagai bagian dari pembangunan sistem otomasi, saya hanya akan menyentuh bagian-bagian yang benar-benar kita butuhkan. <br><br>  Jadi, di atas, saya secara singkat berbicara tentang apa itu NetBox dan bagaimana data disimpan di dalamnya. <br><br>  Saya ulangi bahwa saya sudah memasukkan hampir semua data yang diperlukan di sana, dan Anda dapat menyeret <a href="" rel="nofollow">database dump untuk</a> Anda sendiri. <br><br>  Semuanya siap untuk tahap otomatisasi berikutnya: menulis sistem (ahaha, hanya skrip) untuk menginisialisasi perangkat dan mengelola konfigurasi. <br><br><hr><br>  Tapi, sebelum menyelesaikan artikel, saya akan mengatakan beberapa kata tentang pemasangan dan pengoperasian komponen NetBox. <br><br><h1>  Beberapa nuansa menginstal NetBox </h1><br>  Saya tidak akan menjelaskan proses instalasi secara terperinci - ini lebih dari yang terkenal dijelaskan dalam <a href="https://netbox.readthedocs.io/en/stable/installation/" rel="nofollow">dokumentasi resmi</a> . <br><br>  Anda dapat melihat proses peluncuran gambar buruh pelabuhan NetBox dan bekerja di GUI dalam video Dima Figol ( <a href="https://www.youtube.com/watch%3Fv%3DGGXgAlWm9aY%26t%3D9655s" rel="nofollow">sekali</a> dan <a href="https://www.youtube.com/watch%3Fv%3Da3yK_WAisPw" rel="nofollow">dua kali</a> ) dan <a href="https://www.youtube.com/watch%3Fv%3DI_Ra3PIR2Lc%26feature%3Dyoutu.be" rel="nofollow">Emil Garipov</a> . <br><br>  Secara umum, jika Anda mengikuti langkah-langkah instalasi / start ketat, maka semuanya akan berhasil. <br>  Tapi di sini ada nuansa yang secara tidak sengaja bisa Anda lupakan. <br><br><ul><li>  Dalam file configuration.py, parameter <a href="https://netbox.readthedocs.io/en/stable/installation/2-netbox/" rel="nofollow">ALLOWED_HOSTS</a> harus diisi: <br><pre> <code class="bash hljs">ALLOWED_HOSTS = [<span class="hljs-string"><span class="hljs-string">'netbox.linkmeup.ru'</span></span>, <span class="hljs-string"><span class="hljs-string">'localhost'</span></span>]</code> </pre> <br>  Di sini Anda perlu menentukan semua nama NetBox yang mungkin akan Anda akses, misalnya, mungkin ada alamat IP eksternal atau 127.0.0.1 atau DNS-alias. <br>  Jika ini tidak dilakukan, situs web NetBox tidak akan terbuka dan akan menampilkan 400. </li><li>  Dalam file yang sama, <a href="https://netbox.readthedocs.io/en/stable/installation/2-netbox/" rel="nofollow">SECRET_KEY</a> harus ditentukan, yang dapat Anda temukan sendiri atau buat skrip. </li><li>  Halaman utama akan menampilkan 502 Bad Gateway jika ada yang salah dengan mengatur database PostgreSQL: periksa host (jika diinstal pada komputer lain), port, nama database, nama pengguna, kata sandi. </li><li>  Untuk <a href="" rel="nofollow">beberapa waktu sekarang,</a> NetBox tidak secara default memberikan hak baca apa pun tanpa otorisasi. <br><br>  Ini semua perubahan di configuration.py yang sama: <br><br><pre> <code class="bash hljs">EXEMPT_VIEW_PERMISSIONS = [<span class="hljs-string"><span class="hljs-string">'*'</span></span>]</code> </pre> </li><li>  Dan juga permintaan API akan menghasilkan 200 dan tidak akan berfungsi jika tidak ada garis miring pada URL API di bagian akhir. <br><pre> <code class="bash hljs">curl -X GET -H <span class="hljs-string"><span class="hljs-string">"Accept: application/json; indent=4"</span></span> <span class="hljs-string"><span class="hljs-string">"http://netbox.linkmeup.ru:45127/api/dcim/devices"</span></span></code> </pre> <br></li></ul><br><hr><br><h1>  Sedikit tentang PostgreSQL </h1><br>  Untuk terhubung ke server: <br><br><pre> <code class="bash hljs">psql -U &lt;i&gt;username&lt;/i&gt; -h &lt;i&gt;hostname&lt;/i&gt; &lt;i&gt;db_name&lt;/i&gt;</code> </pre> <br>  Sebagai contoh: <br><br><pre> <code class="bash hljs">psql -U netbox -h localhost netbox</code> </pre> <br>  Untuk menampilkan semua tabel: <br><br><pre> <code class="bash hljs">/dt</code> </pre> <br>  Untuk keluar: <br><br><pre> <code class="bash hljs">/q</code> </pre> <br>  Untuk dump basis data: <br><br><pre> <code class="bash hljs">pg_dump -U &lt;i&gt;username&lt;/i&gt; -h &lt;i&gt;hostname&lt;/i&gt; &lt;i&gt;db_name&lt;/i&gt; &gt; netbox.sql</code> </pre> <br>  Jika Anda tidak ingin memasukkan kata sandi setiap kali: <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> *:*:*:&lt;i&gt;username&lt;/i&gt;:&lt;i&gt;password&lt;/i&gt; &gt; ~/.pgpass chmod 600 ~/.pgpass</code> </pre> <br>  Jika Anda memiliki instalasi sendiri dan tidak ingin membuat semuanya dengan tangan, Anda dapat melakukannya dengan mengambil dump dari database NetBox saat ini di <a href="" rel="nofollow">sini</a> : <br><br><pre> <code class="bash hljs">psql -U &lt;i&gt;username&lt;/i&gt; -h &lt;i&gt;hostname&lt;/i&gt; &lt;i&gt;db_name&lt;/i&gt; &lt; netbox_initial_db.sql</code> </pre> <br>  Jika Anda pertama-tama harus menghapus semua tabel (dan Anda harus melakukan ini), maka Anda dapat menyiapkan file di muka: <br><br><pre> <code class="bash hljs">psql -U &lt;i&gt;username&lt;/i&gt; -h &lt;i&gt;hostname&lt;/i&gt; &lt;i&gt;db_name&lt;/i&gt; \o drop_all_tables.sql select <span class="hljs-string"><span class="hljs-string">'drop table '</span></span> || tablename || <span class="hljs-string"><span class="hljs-string">' cascade;'</span></span> from pg_tables; \q psql -U &lt;i&gt;username&lt;/i&gt; -h &lt;i&gt;hostname&lt;/i&gt; &lt;i&gt;db_name&lt;/i&gt; -f drop_all_tables.sql</code> </pre> <br><hr><br><h1>  Tautan yang bermanfaat </h1><br><ul><li>  <a href="https://github.com/netbox-community/netbox" rel="nofollow">NetBox sendiri di guthub</a> </li><li>  <a href="https://github.com/netbox-community/netbox-docker" rel="nofollow">Versi kontainer</a> </li><li>  <a href="https://netbox.readthedocs.io/en/stable/" rel="nofollow">Lengkapi instruksi pemasangan dan semua dokumentasi produk</a> </li><li>  <a href="http://karneliuk.com/2019/04/documenting-your-network-infrastructure-in-netbox-integrating-with-ansible-over-rest-api-and-automating-provisioning-of-cumulus-linux-arista-eos-nokia-sr-os-and-cisco-ios-xr/" rel="nofollow">Mendokumentasikan infrastruktur jaringan Anda di NetBox, berintegrasi dengan Ansible over REST API</a> </li><li>  <a href="https://www.youtube.com/watch%3Fv%3DGGXgAlWm9aY%26t%3D9655s" rel="nofollow">IPAM NetBox dan API, Docker, Postman</a> </li><li>  <a href="https://www.youtube.com/watch%3Fv%3Da3yK_WAisPw" rel="nofollow">IPAM NetBox dan API-nya, templat konfigurasi dengan Python</a> </li><li>  <a href="https://github.com/digitalocean/pynetbox" rel="nofollow">Python NetKox SDK</a> </li><li>  <a href="http://netbox.linkmeup.ru:45127/api/docs/" rel="nofollow">Dokumentasi API</a> </li><li>  <a href="https://groups.google.com/forum/" rel="nofollow">Milis</a> </li><li>  <a href="https://networktocode.slack.com/" rel="nofollow">NetworkToCode Slack Channel</a> </li><li>  <a href="https://habr.com/ru/post/485618/">Apa itu REST?</a> </li><li>  <a href="http://netbox.linkmeup.ru:45127/" rel="nofollow">Instalasi NetBox untuk ADSM</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id486000/">https://habr.com/ru/post/id486000/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id485986/index.html">5 Tren Pelokalan Teratas di 2020</a></li>
<li><a href="../id485988/index.html">[Case Locomizer] Cara mempercepat perhitungan peta panas sebanyak 20.000 kali dalam dua setengah tahun</a></li>
<li><a href="../id485990/index.html">Otomatisasi membunuh?</a></li>
<li><a href="../id485996/index.html">APM elastis di aplikasi</a></li>
<li><a href="../id485998/index.html">LyX: Komentar umum. Bagian 2</a></li>
<li><a href="../id486006/index.html">Simpan status obrolan di tumpukan</a></li>
<li><a href="../id486010/index.html">Membuat demo untuk ponsel lama - AONDEMO</a></li>
<li><a href="../id486014/index.html">Tur SLAC: Laboratorium Akselerator Nasional Departemen Energi AS di Stanford</a></li>
<li><a href="../id486018/index.html">Hasil Survei Sesi</a></li>
<li><a href="../id486024/index.html">Grafik yang sangat sederhana dalam R untuk sains dan jurnalisme</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>