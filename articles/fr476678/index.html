<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🈸 👩🏼‍🏭 👦🏻 API pour l'extraction asynchrone à distance à l'aide d'Apple Combine 🆔 👖 🖐🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Combine est un framework Swift réactif fonctionnel qui a été récemment implémenté pour toutes Apple plateformes Apple , y compris Xcode 11 . Avec Comb...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>API pour l'extraction asynchrone à distance à l'aide d'Apple Combine</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/476678/"><img src="https://habrastorage.org/webt/t6/lj/xl/t6ljxl5w2xxh7v0inoq5oebgbro.png"><br><br>  <font color="#0000FF">Combine</font> est un framework <code>Swift</code> réactif fonctionnel qui a été récemment implémenté pour toutes <code>Apple</code> plateformes <code>Apple</code> , y compris <code>Xcode 11</code> .  Avec <font color="#0000FF">Combine, il est</font> très facile de traiter des séquences de valeurs qui apparaissent de manière asynchrone dans le temps.  Il simplifie également le code asynchrone en abandonnant la délégation et les <font color="#0000FF">rappels</font> imbriqués complexes. <br><br>  Mais étudier <font color="#0000FF">Combiner lui-même</font> au début peut ne pas sembler si simple.  Le fait est que les principaux «acteurs» de <font color="#0000FF">Combine</font> sont des concepts abstraits tels que «éditeurs» <font color="#0000FF">Éditeurs</font> , «abonnés» <font color="#0000FF">Abonnés</font> et opérateurs <font color="#0000FF">Opérateurs</font> , sans lesquels il ne sera pas possible d'avancer dans la compréhension de la logique de fonctionnement de <font color="#0000FF">Combine</font> .  Cependant, étant donné <code>Apple</code> fournit aux développeurs des "éditeurs", des "abonnés" et des opérateurs prêts à l'emploi, le code écrit avec <font color="#0000FF">Combine</font> est très compact et bien lisible. <br><br>  Vous le verrez dans l'exemple d'une application liée à la <a href="https://developers.themoviedb.org/3/getting-started/introduction">récupération</a> asynchrone <a href="https://developers.themoviedb.org/3/getting-started/introduction">des</a> informations sur les <a href="https://developers.themoviedb.org/3/getting-started/introduction">films</a> de la très populaire base de données <a href="https://developers.themoviedb.org/3/getting-started/introduction">TMDb</a> .  Nous allons créer deux applications différentes: <font color="#0000FF">UIKit</font> et <font color="#0000FF">SwiftUI</font> , et montrer comment <font color="#0000FF">Combine</font> fonctionne avec elles. <br><br><img src="https://habrastorage.org/webt/sd/jn/py/sdjnpyhqecxf8q7wvtxlkm7qbr0.png"><br><a name="habracut"></a><br>  J'espère que cet article vous facilitera l'apprentissage du <font color="#0000FF">Combine</font> .  Le code de toutes les applications développées dans cet article se trouve sur <a href="https://github.com/BestKora/CombineFetchAPI">Github</a> . <br><br>  <font color="#0000FF">La moissonneuse-batteuse</font> comprend plusieurs composants principaux: <br><br><h3>  Publisher <b><font color="#0000FF">Publisher</font></b> . </h3><br><img src="https://habrastorage.org/webt/cu/6q/93/cu6q93meoo0iyfmkyqa4si1y68c.png"><br><br>  Éditeurs Les <font color="#0000FF">éditeurs</font> sont des TYPES qui apportent des <font color="#0000FF">valeurs à</font> tous ceux qui se soucient.  <font color="#0000FF">Le</font> concept «éditeur» de l'éditeur est implémenté dans <font color="#0000FF">Combine en</font> tant que <font color="#0000FF">protocole</font> , et non en tant que TYPE spécifique.  Le protocole <font color="#0000FF">Publisher</font> a associé des TYPES génériques pour la valeur de sortie et l'erreur d' <font color="#0000FF">échec</font> . <br>  Un «éditeur» qui ne publie jamais d'erreur utilise l'erreur TYPE <font color="#0000FF">Never</font> for a <font color="#0000FF">Failure</font> . <br><br><img src="https://habrastorage.org/webt/04/mt/gt/04mtgtm8ucbh38ywukqa-jv0qb0.png"><br><br><img src="https://habrastorage.org/webt/c9/py/wg/c9pywgmfyp5aa8t9mb0extzy764.png"><br><br>  <code>Apple</code> fournit aux développeurs des implémentations spécifiques de «éditeurs» prêts à l'emploi: <font color="#0000FF">Just</font> , <font color="#0000FF">Future</font> , <font color="#0000FF">Empty</font> , <font color="#0000FF">Deferred</font> , <font color="#0000FF">Sequence</font> , <font color="#0000FF">@Published</font> , etc.  Des "éditeurs" sont également ajoutés aux classes <font color="#0000FF">Foundation</font> : <font color="#0000FF">URLSession</font> , &lt; <font color="#0000FF">NotificationCenter</font> , <font color="#0000FF">Timer</font> . <br><br><h3>  Abonné "Abonné". </h3><br><img src="https://habrastorage.org/webt/1t/h5/aj/1th5aj2egefg5fkjsikc-jurleq.png"><br><br>  C'est également un protocole <font color="#0000FF">protocolaire</font> qui fournit une interface pour «s'abonner» aux <font color="#0000FF">valeurs</font> d'un «éditeur».  Il a associé des TYPES génériques pour les erreurs d' <font color="#0000FF">entrée</font> et d' <font color="#0000FF">échec</font> .  Évidemment, les TYPES de Publisher <font color="#0000FF">Publisher</font> et <font color="#0000FF">Subscriber Subscriber</font> doivent correspondre. <br><br><img src="https://habrastorage.org/webt/2g/de/2n/2gde2nlg6zae1fezvtewfziyh0w.png"><br><br>  Pour tout éditeur Publisher, il existe deux <font color="#0000FF">abonnés</font> intégrés: <font color="#0000FF">regrouper</font> et <font color="#0000FF">attribuer</font> : <br><br><img src="https://habrastorage.org/webt/vq/ua/q-/vquaq-t465oyg5ku4plfd-jvyks.png"><br><br>  Le récepteur «Subscriber» <font color="#0000FF">est</font> basé sur deux fermetures: une fermeture, <font color="#0000FF">receiveValue</font> , est exécutée lorsque vous obtenez les <font color="#0000FF">valeurs</font> , la deuxième fermeture, <font color="#0000FF">receiveCompletion</font> , est exécutée lorsque la «publication» est terminée (normalement ou avec une erreur). <br><br><img src="https://habrastorage.org/webt/im/fj/56/imfj56ymla1daatwof2b1qxkja8.png"><br><br>  L' <font color="#0000FF">affectation</font> «Abonné» avance chaque valeur reçue vers le <code>key Path</code> spécifié. <br><br><h3>  Abonnement "Abonnement". </h3><br><img src="https://habrastorage.org/webt/ha/rn/bv/harnbvbg6gigvyslb2aex_ujy4m.png"><br><br>  Premièrement, l'éditeur «éditeur» crée et livre l'abonnement «Abonnement» <font color="#0000FF">à l'</font> abonné « <font color="#0000FF">Abonné</font> » via sa méthode de <font color="#0000FF">réception (abonnement :)</font> : <br><br><img src="https://habrastorage.org/webt/rk/tk/s8/rktks8zchgxyblozzz96otrxiee.png"><br><br>  Après cela, l' <font color="#0000FF">abonnement</font> peut envoyer ses <font color="#0000FF">valeurs aux</font> «abonnés» des <font color="#0000FF">abonnés en</font> utilisant deux méthodes: <br><br><img src="https://habrastorage.org/webt/hl/4x/ev/hl4xev6fakwtgs-wpv3afwuaywa.png"><br><br>  Si vous avez fini de travailler avec l' <font color="#0000FF">abonnement Abonnement</font> , vous pouvez appeler sa méthode <font color="#0000FF">cancel ()</font> : <br><br><img src="https://habrastorage.org/webt/lz/ap/bt/lzapbts_gq9by1lw8qicdg3v2hc.png"><br><br><h3>  Sujet "Sujet". </h3><br><img src="https://habrastorage.org/webt/hy/cq/5p/hycq5pytsfa_gkzmqrwtmtal7tw.png"><br><br>  Il s'agit d'un protocole de <font color="#0000FF">protocole</font> qui fournit une interface pour les deux clients, à la fois pour «l'éditeur» et pour «l'abonné».  Essentiellement, le sujet « <font color="#0000FF">subject</font> » est le «publisher» <font color="#0000FF">Publisher</font> , qui peut accepter la valeur d' <font color="#0000FF">entrée Input</font> et que vous pouvez utiliser pour «injecter» les <font color="#0000FF">valeurs</font> dans le flux en appelant la méthode <font color="#0000FF">send ()</font> .  Cela peut être utile lors de l'adaptation du code impératif existant dans les modèles <font color="#0000FF">combinés</font> . <br><br><h3>  Opérateur <font color="#0000FF">Opérateur</font> . </h3><br><img src="https://habrastorage.org/webt/h-/d-/r1/h-d-r1jmm2yxa5kefxpf5opmuw4.png"><br><br>  À l'aide de l'opérateur, vous pouvez créer un nouvel «éditeur» d'éditeur à partir d'un autre «éditeur» d'éditeur en convertissant, en filtrant et même en combinant les <font color="#0000FF">valeurs</font> des nombreux <b><font color="#0000FF">éditeurs en</font></b> <code>upstream</code> précédents. <br><br><img src="https://habrastorage.org/webt/ol/he/rz/olherzm4jvlkfwer3x0gdbc0guk.png"><br><br>  Vous voyez ici beaucoup de noms d'opérateurs familiers: <font color="#0000FF">compactMap</font> , <font color="#0000FF">map</font> , <font color="#0000FF">filter</font> , <font color="#0000FF">dropFirst</font> , <font color="#0000FF">append</font> . <br><br><h3>  <font color="#0000FF">Éditeurs de</font> la <font color="#0000FF">Fondation</font> <font color="#0000FF">Éditeurs</font> intégrés à la <font color="#0000FF">Fondation</font> . </h3><br>  <code>Apple</code> fournit également aux développeurs plusieurs des fonctionnalités <font color="#0000FF">Combine déjà</font> intégrées dans le framework <font color="#0000FF">Foundation</font> &lt;, c'est-à-dire les éditeurs des éditeurs, pour des tâches telles que la récupération de données à l'aide d' <font color="#0000FF">URLSession</font> , l'utilisation de notifications à l'aide de <font color="#0000FF">Notification</font> , <font color="#0000FF">Timer</font> et les propriétés de surveillance basées sur <font color="#0000FF">KVO</font> .  Cette compatibilité intégrée nous aidera vraiment à intégrer le framework <font color="#0000FF">Combine</font> dans notre projet actuel. <br>  Pour en savoir plus à ce sujet, consultez l'article <a href="https://theswiftdev.com/2019/10/31/the-ultimate-combine-framework-tutorial-in-swift/">«Le didacticiel ultime du framework Combine dans Swift»</a> . <br><br><h3>  Qu'apprenons-nous à faire avec <font color="#0000FF">Combine</font> ? </h3><br>  Dans cet article, nous allons apprendre à utiliser le framework <font color="#0000FF">Combine</font> pour récupérer des données de film à partir du site Web <a href="https://developers.themoviedb.org/3/getting-started/introduction">TMDb</a> .  Voici ce que nous étudierons ensemble: <br><br><ul><li>  Utiliser le <font color="#0000FF">futur</font> "éditeur" pour créer une fermeture avec <font color="#0000FF">Promise</font> pour une seule valeur: <font color="#0000FF">valeur</font> ou erreur. </li><li>  Utilisation de l' <font color="#0000FF">URL</font> " <font color="#0000FF">session</font> " de l'éditeur " <font color="#0000FF">datataskPublisher</font> " pour "s'abonner" aux <font color="#0000FF">données</font> publiées par un <code>UR</code> L. donné </li><li>  Utilisation de l'opérateur <font color="#0000FF">tryMap</font> pour convertir des données de <font color="#0000FF">données à l'</font> aide d'un autre éditeur Publisher. </li><li>  Utilisation de l'opérateur de <font color="#0000FF">décodage</font> pour convertir les données de <font color="#0000FF">données</font> en un objet <font color="#0000FF">décodable</font> et les publier pour transmission aux éléments suivants de la chaîne. </li><li>  Utiliser l'opérateur <font color="#0000FF">récepteur</font> pour «s'abonner» à un «éditeur» d'éditeur à l'aide de fermetures. </li><li>  Utilisez l'instruction <font color="#0000FF">assign</font> pour vous «abonner» à l'éditeur «éditeur» et attribuer la valeur qu'il fournit au <code>key Path</code> donné. </li></ul><br><h3>  Projet initial </h3><br>  Avant de commencer, nous devons nous enregistrer pour recevoir la clé <code>API</code> sur le site Web <a href="https://developers.themoviedb.org/3/getting-started/introduction">TMDb</a> .  Vous devez également télécharger le projet initial à partir du référentiel <a href="https://github.com/alfianlosari/CombineFetchAPIStarter">GitHub</a> . <br>  Assurez-vous de placer votre clé <code>API</code> dans la <font color="#0000FF">classe MovieStore de classe</font> dans <font color="#0000FF">let apiKey</font> constant. <br><br><img src="https://habrastorage.org/webt/u0/fp/ev/u0fpevrqivppfng0lyoglbkp-cq.png"><br><br>  Voici les principaux blocs de construction à partir desquels nous allons créer notre projet: <br><br><ul><li>  1. À l'intérieur du fichier <code>Movie.swift</code> trouvent des modèles que nous utiliserons dans notre projet.  La structure racine de <font color="#0000FF">struct MoviesResponse</font> implémente le protocole <font color="#0000FF">Decodable</font> , et nous l'utiliserons lors du décodage <code>JSON</code> données <code>JSON</code> dans un modèle.  La structure <font color="#0000FF">MoviesResponse</font> a une propriété <font color="#0000FF">results</font> , qui implémente également le protocole <font color="#0000FF">Decodable</font> et est une collection de films <font color="#0000FF">[Movie]</font> .  C'est elle qui nous intéresse: </li></ul><br><img src="https://habrastorage.org/webt/1o/9s/xz/1o9sxzm4t-edp2l2hhauqky2dve.png"><br><br><ul><li>  2. <font color="#0000FF">Énumération</font> énumération <font color="#0000FF">MovieStoreAPIError</font> implémente le protocole d' <font color="#0000FF">erreur</font> .  Notre <code>API</code> utilisera cette énumération pour représenter différents types d'erreurs: erreurs de <font color="#0000FF">récupération d'</font> <code>URL</code> <font color="#0000FF">urlError</font> , erreurs de décodage <font color="#0000FF">decodingError</font> et erreurs d'extraction de données <font color="#0000FF">responseError</font> . </li></ul><br><img src="https://habrastorage.org/webt/kn/3n/av/kn3nav2xvctmabav1v2zdi_6hrw.png"><br><br><ul><li>  3. Notre <code>API</code> possède un protocole <font color="#0000FF">MovieService</font> avec une seule méthode, <font color="#0000FF">fetchMovies (de endpoint: Endpoint)</font> , qui sélectionne les films <font color="#0000FF">[Movie] en</font> fonction du paramètre de <font color="#0000FF">endpoint</font> .  <font color="#0000FF">Le point de terminaison</font> lui-même est un <font color="#0000FF">enum enum</font> qui représente un <font color="#0000FF">point</font> de <font color="#0000FF">terminaison</font> pour accéder à la base de données <a href="https://developers.themoviedb.org/3/getting-started/introduction">TMDb</a> pour récupérer des films comme <font color="#0000FF">nowPlaying</font> (dernier), <font color="#0000FF">populaire</font> (populaire), <font color="#0000FF">topRated</font> (haut) et à <font color="#0000FF">venir</font> (à venir bientôt à l'écran). </li></ul><br><img src="https://habrastorage.org/webt/4b/a1/ki/4ba1kiw5glfklazq04txpbbs6fy.png"><br><br><ul><li>  4. La <font color="#0000FF">classe</font> MovieStore est une classe spécifique qui implémente le protocole <font color="#0000FF">MovieService</font> pour récupérer des données à partir du site <a href="https://developers.themoviedb.org/3/getting-started/introduction">TMDb</a> .  Dans cette classe, nous implémentons la <font color="#0000FF">méthode fetchMovies (...) en</font> utilisant <font color="#0000FF">Combine</font> . </li></ul><br><img src="https://habrastorage.org/webt/l2/lr/q1/l2lrq1ff5w76cxbvpmr53eywiy4.png"><br><br><ul><li>  5. La classe <font color="#0000FF">MovieListViewController</font> est la principale classe <font color="#0000FF">ViewController</font> dans laquelle nous utilisons la méthode <font color="#0000FF">Sink</font> pour «souscrire» à la méthode de lecture de film <font color="#0000FF">fetchMovies (...)</font> , qui renvoie le <font color="#0000FF">futur</font> «éditeur», puis mettre à jour la table <font color="#0000FF">TableView</font> avec de nouvelles données de film <font color="#0000FF">films</font> utilisant la nouvelle <code>API</code> <font color="#0000FF">DiffableDataSourceSnapshot</font> . </li></ul><br>  Avant de commencer, examinons certains des composants de base de <font color="#0000FF">Combine</font> que nous utiliserons pour <code>API</code> récupération de données à distance. <br><br><h3>  «Abonnez-vous» à «l'éditeur» en utilisant <font color="#0000FF">évier</font> et ses fermetures. </h3><br>  Le moyen le plus simple de «souscrire» à «l'éditeur» de l'éditeur est d'utiliser le <font color="#0000FF">récepteur</font> avec ses fermetures, dont l'une sera exécutée chaque fois que nous obtiendrons une nouvelle <font color="#0000FF">valeur</font> , et l'autre lorsque «l'éditeur» aura fini de livrer les <font color="#0000FF">valeurs</font> . <br><br><img src="https://habrastorage.org/webt/yb/wt/ng/ybwtnglt5iuxpbfpkj3tgud_qpo.png"><br><br>  N'oubliez pas que dans <font color="#0000FF">Combine,</font> chaque «abonnement» renvoie une <font color="#0000FF">annulation</font> , qui sera supprimée dès que nous quitterons notre contexte.  Afin de maintenir un «abonnement» pendant une période plus longue, par exemple, pour obtenir des valeurs de manière asynchrone, nous devons enregistrer «l'abonnement» dans la propriété <font color="#0000FF">subscription1</font> .  Cela nous a permis d'obtenir systématiquement toutes les <font color="#0000FF">valeurs (7,8,3,4)</font> . <br><br><h3>  <font color="#0000FF">Future</font> «publie» de façon asynchrone une seule valeur: soit une <font color="#0000FF">valeur,</font> soit une erreur d' <font color="#0000FF">échec</font> . </h3><br>  Dans le cadre <font color="#0000FF">Combine</font> , le <font color="#0000FF">futur</font> «éditeur» peut être utilisé pour obtenir de manière asynchrone un seul TYPE de <font color="#0000FF">résultat à l'</font> aide d'une fermeture.  La fermeture a un paramètre - <font color="#0000FF">Promise</font> , qui est une fonction de TYPE <font color="#0000FF">(Result &lt;Output, Failure&gt;) -&gt; Void</font> . <br><br>  Regardons un exemple simple pour comprendre comment fonctionne le <font color="#0000FF">futur</font> éditeur: <br><br><img src="https://habrastorage.org/webt/x9/6p/_p/x96p_plt6deyew9_q5yupqa_zsc.png"><br><br>  Nous créons <font color="#0000FF">Future</font> avec un résultat réussi de TYPE <font color="#0000FF">Int</font> et une erreur de TYPE <font color="#0000FF">Never</font> .  Dans la fermeture <font color="#0000FF">Future</font> , nous utilisons <font color="#0000FF">DispatchQueue.main.asyncAfter (...)</font> pour retarder l'exécution du code de <font color="#0000FF">2</font> secondes, simulant ainsi un comportement asynchrone.  À l'intérieur de la fermeture, nous <font color="#0000FF">renvoyons</font> <font color="#0000FF">Promise</font> avec un résultat de <font color="#0000FF">promesse réussi (.success (...)) en</font> tant que valeur entière aléatoire <font color="#0000FF">Int</font> comprise entre <font color="#0000FF">0</font> et <font color="#0000FF">100</font> .  Ensuite, nous utilisons deux abonnements <font color="#0000FF">futurs</font> - <font color="#0000FF">annulable</font> et <font color="#0000FF">annulable1</font> - et les deux donnent le même résultat, bien qu'un nombre aléatoire soit généré à l'intérieur. <br><blockquote>  <u><i><code> 1.</code></i></u> Il convient de noter que l '«éditeur» de <font color="#0000FF">Future</font> in <font color="#0000FF">Combine</font> présente certaines caractéristiques comportementales par rapport aux autres «éditeurs»: <br><br><ul><li>  Le <font color="#0000FF">futur</font> "éditeur" publie toujours "UNE valeur ( <font color="#0000FF">valeur</font> ou erreur), et ceci termine son travail. </li></ul><br><ul><li>  <font color="#0000FF">Le futur</font> «éditeur» est une <font color="#0000FF">classe</font> ( <code>reference type</code> ), contrairement aux autres «éditeurs», qui sont principalement des <font color="#0000FF">structures struct</font> ( <code>value type</code> ), et il est transmis en tant que paramètre une fermeture de <font color="#0000FF">promesse</font> , qui est créée immédiatement lors de l'initialisation de l'instance d'éditeur <font color="#0000FF">futur</font> .  C'est-à-dire que la clôture de la <font color="#0000FF">promesse</font> est transmise avant que tout abonné « <font color="#0000FF">abonné</font> » ne <font color="#0000FF">s'abonne</font> à la <font color="#0000FF">future</font> instance «éditeur».  L '«éditeur» de <font color="#0000FF">Future</font> n'a <font color="#0000FF">absolument</font> pas besoin d'un «abonné» pour son fonctionnement, comme tous les autres <font color="#0000FF">éditeurs</font> ordinaires l'exigent.  C'est pourquoi le texte «Bonjour de l'intérieur du futur!» N'est imprimé qu'une seule fois dans le code ci-dessus. </li></ul><br><ul><li>  <font color="#0000FF">Le futur</font> "éditeur" est un "éditeur" <code>eager</code> (impatient), contrairement à la plupart des autres "éditeurs" <font color="#0000FF">paresseux</font> ("publier" uniquement s'il y a un "abonnement").  Ce n'est qu'une fois que le <font color="#0000FF">futur</font> éditeur a fermé sa <font color="#0000FF">promesse que</font> le résultat est mémorisé et ensuite transmis aux «abonnés» actuels et futurs.  D'après le code ci-dessus, nous voyons que lorsque vous vous «abonnez» à plusieurs reprises au <font color="#0000FF">futur</font> éditeur, vous obtenez toujours la même valeur «aléatoire» (dans ce cas <font color="#0000FF">6</font> , mais elle peut être différente, mais toujours la même), bien qu'elle soit utilisée dans la fermeture valeur <font color="#0000FF">int</font> aléatoire. </li></ul></blockquote><br>  Une telle logique de «l'éditeur» de <font color="#0000FF">Future</font> permet de l'utiliser avec succès pour stocker un résultat calculé asynchrone consommateur de ressources et de ne pas perturber le «serveur» pour les multiples «abonnements» ultérieurs. <br><br>  Si une telle logique de l '«éditeur» de <font color="#0000FF">Future</font> ne vous convient pas et que vous voulez que votre <font color="#0000FF">Future soit</font> appelé <font color="#0000FF">paresseux</font> et chaque fois que vous obtenez de nouvelles valeurs <font color="#0000FF">Int</font> aléatoires, alors vous devriez «boucler» <font color="#0000FF">Future</font> dans <font color="#0000FF">Deferred</font> : <br><br><img src="https://habrastorage.org/webt/j3/gf/25/j3gf25golyfoyl0jvkfddej2mk8.png"><br><br>  Nous utiliserons <font color="#0000FF">Future de manière</font> classique, comme suggéré dans <font color="#0000FF">Combine</font> , c'est-à-dire comme un «éditeur» asynchrone calculé «partagé». <br><br><blockquote>  Remarque 2. Nous devons faire une dernière remarque concernant l '«abonnement» utilisant le récepteur au «Publisher» asynchrone.  La méthode <font color="#0000FF">Sink</font> renvoie <font color="#0000FF">AnyCancellable</font> , dont nous ne nous souvenons pas constamment.  Cela signifie que <code>Swift</code> détruira <font color="#0000FF">AnyCancellable</font> au moment où vous quitterez le contexte donné, ce qui se produit sur le <code>main thread</code> .  Ainsi, il s'avère que <font color="#0000FF">AnyCancellable</font> est détruit avant que la fermeture avec <font color="#0000FF">Promise</font> ne puisse démarrer sur le <code>main thread</code> .  Lorsque <font color="#0000FF">AnyCancellable est</font> détruit, sa méthode d' <font color="#0000FF">annulation</font> est appelée, ce qui annule dans ce cas «l'abonnement».  C'est pourquoi nous nous souvenons de nos «abonnements» de <font color="#0000FF">puits</font> au <font color="#0000FF">futur</font> dans les variables <font color="#0000FF">annulables &lt;et annulables1</font> ou dans <font color="#0000FF">Set &lt;AnyCancellable&gt; ()</font> . </blockquote><br><br><h3>  Utilisation de <font color="#0000FF">Combine</font> pour récupérer des films sur le site Web de <a href="https://developers.themoviedb.org/3/getting-started/introduction">TMDb</a> . </h3><br>  Pour commencer, vous ouvrez le projet de démarrage et accédez au fichier <code>MovieStore.swift</code> et à la méthode <font color="#0000FF">fetchMovies</font> avec une implémentation vide: <br><br><img src="https://habrastorage.org/webt/fg/aw/s0/fgaws0kq7u9kz5ojjz3jlij9zl8.png"><br><br>  En utilisant la méthode <font color="#0000FF">fetchMovies,</font> nous pouvons sélectionner différents films en définissant des valeurs spécifiques pour le <font color="#0000FF">paramètre d'</font> entrée de <font color="#0000FF">point final</font> de TYPE <font color="#0000FF">Endpoint</font> .  TYPE <font color="#0000FF">Endpoint</font> est une <font color="#0000FF">énumération d'</font> énumération qui prend les valeurs <font color="#0000FF">nowPlaying</font> (actuel), à <font color="#0000FF">venir</font> (bientôt à l'écran), <font color="#0000FF">populaire</font> (populaire), <font color="#0000FF">topRated</font> (haut): <br><br><img src="https://habrastorage.org/webt/-a/xt/-f/-axt-f0lhtfrt8u_a-ay7q3z8jk.png"><br><br>  Commençons par initialiser <font color="#0000FF">Future</font> avec une fermeture de <code>callback</code> .  Reçu <font color="#0000FF">Future,</font> nous vous rembourserons ensuite. <br><br><img src="https://habrastorage.org/webt/hu/v0/pu/huv0pu3w26r2fms4ih4fvhrx8to.png"><br><br>  À l'intérieur de la fermeture de <code>callback</code> , nous générons l' <code>URL</code> de la valeur correspondante du <font color="#0000FF">paramètre d'</font> entrée de <font color="#0000FF">point final en</font> utilisant la fonction <font color="#0000FF">generateURL (avec endpoint: Endpoint)</font> : <br><br><img src="https://habrastorage.org/webt/q8/ce/9e/q8ce9ez5nokjff1c_oowpfdlncm.png"><br><br>  Si l' <code>URL</code> correcte n'a pas pu être générée, nous <font color="#0000FF">renvoyons</font> une erreur à l'aide de <font color="#0000FF">promise (.failure (.urlError (...))</font> , sinon nous allons de l'avant et implémentons l' <font color="#0000FF">URL</font> « <font color="#0000FF">session</font> éditeur» <font color="#0000FF">URLSession.dataTaskPublisher</font> . <br><br>  Pour "souscrire" aux données d'une certaine <code>URL</code> nous pouvons utiliser la méthode <font color="#0000FF">datataskPublisher</font> intégrée à la classe <font color="#0000FF">URLSession</font> , qui prend l' <code>URL</code> comme paramètre et renvoie l'éditeur "publisher" avec les données de sortie du tuple <font color="#0000FF">(data: Data, response: URLResponse)</font> et une erreur <font color="#0000FF">URLError</font> . <br><br><img src="https://habrastorage.org/webt/wb/dv/uy/wbdvuyzbpv6w3qxfzjyfxxwtmx8.png"><br><br>  Pour convertir un éditeur Publisher vers un autre éditeur Publisher, utilisez l'opérateur <font color="#0000FF">tryMap</font> .  Par rapport à la <font color="#0000FF">carte</font> , l'opérateur <font color="#0000FF">tryMap</font> peut <font color="#0000FF">renvoyer</font> une erreur <font color="#0000FF">Error</font> <font color="#0000FF">throws à l'</font> intérieur d'une fermeture, ce qui nous renvoie le nouvel éditeur Publisher. <br><br>  Dans l'étape suivante, nous utiliserons l'opérateur <font color="#0000FF">tryMap</font> pour vérifier le code <code>http</code> <font color="#0000FF">statusCode</font> de la réponse de <font color="#0000FF">réponse</font> pour nous assurer que sa valeur est comprise entre <font color="#0000FF">200</font> et <font color="#0000FF">300</font> .  Sinon, nous lançons <font color="#0000FF">la</font> valeur d'erreur d' <font color="#0000FF">énumération MovieStoreAPIError enum responseError</font> .  Sinon (lorsqu'il n'y a pas d'erreur), nous renvoyons simplement les données reçues <font color="#0000FF">au</font> prochain <font color="#0000FF">éditeur</font> de la chaîne «éditeur». <br><br><img src="https://habrastorage.org/webt/wy/ln/6c/wyln6c46anluun6s7woysgopsma.png"><br><br>  Dans l'étape suivante, nous utiliserons l'opérateur de <font color="#0000FF">décodage</font> , qui décode les données <code>JSON</code> sortie du <font color="#0000FF">tryMap</font> «éditeur» <font color="#0000FF">précédent</font> dans <font color="#0000FF">MovieResponse</font> &lt;Model à l'aide de <font color="#0000FF">JSONDecoder</font> . <br><br><img src="https://habrastorage.org/webt/-s/jt/0j/-sjt0j9lf5pbkugsryptozbb0ei.png"><br><br>  ... <font color="#0000FF">jsonDecoder est</font> configuré pour un format de date spécifique: <br><br><img src="https://habrastorage.org/webt/ub/ed/pu/ubedpue91eckdhygbfmxbnk4oqk.png"><br><br>  Pour que le traitement soit effectué sur le <code>main thread</code> , nous utiliserons l'opérateur <font color="#0000FF">receive (on :)</font> et passerons <font color="#0000FF">RunLoop.main</font> comme paramètre d'entrée.  Cela permettra à "l'abonné" d'obtenir la valeur de <font color="#0000FF">valeur</font> sur le thread <code>main</code> . <br><br><img src="https://habrastorage.org/webt/gr/n2/wh/grn2whzqqawxp_1-ffqh6jwhmse.png"><br><br>  Enfin, nous sommes arrivés à la fin de notre chaîne de transformation, et là, nous utilisons le <font color="#0000FF">puits</font> pour obtenir un abonnement « <font color="#0000FF">abonnement</font> » à la «chaîne» formée d'éditeurs «éditeurs».  Pour initialiser une instance de la classe <font color="#0000FF">Sink</font> , nous avons besoin de deux choses, bien que l'une d'entre elles soit facultative: <br><br><ul><li>  fermeture <font color="#0000FF">recevoirValeur :.</font>  Il sera appelé chaque fois qu'un abonnement "abonnement" reçoit une nouvelle <font color="#0000FF">valeur</font> de l'éditeur "éditeur". </li></ul><br><ul><li>  <font color="#0000FF">Clôture de la réception:</font> (Facultatif).  Il sera appelé une fois que l' <font color="#0000FF">éditeur</font> «éditeur» a fini de publier la <font color="#0000FF">valeur</font> , il recevra l'énumération d' <font color="#0000FF">achèvement</font> , que nous pouvons utiliser pour vérifier si la «publication» des valeurs est vraiment terminée ou si l'achèvement est dû à une erreur. </li></ul><br>  Dans la fermeture de <font color="#0000FF">receiveValue</font> , nous <font color="#0000FF">invoquons</font> simplement <font color="#0000FF">une</font> <font color="#0000FF">promesse</font> avec une option <font color="#0000FF">.success</font> et une valeur de <font color="#0000FF">0 $ .résultats</font> , qui dans notre cas est un tableau de films <font color="#0000FF">films</font> .  Dans la fermeture de <font color="#0000FF">receiveCompletion,</font> nous vérifions si l' <font color="#0000FF">achèvement comporte une</font> erreur d' <font color="#0000FF">erreur</font> , puis transmettons l'erreur de <font color="#0000FF">promesse</font> correspondante avec l'option <font color="#0000FF">.failure</font> . <br><br><img src="https://habrastorage.org/webt/gr/qh/tm/grqhtm3xthdx7snxlmwfawmd3rq.png"><br><br>  Notez que nous collectons ici toutes les erreurs «rejetées» dans les étapes précédentes de la «chaîne des éditeurs». <br><br>  Ensuite, nous mémorisons l'abonnement «souscription» dans la propriété <font color="#0000FF">Set &lt;AnyCancellable&gt; ()</font> . <br>  Le fait est que l'abonnement «abonnement» est <font color="#0000FF">annulable</font> , c'est un tel protocole qui détruit et efface tout après l'achèvement de la fonction <font color="#0000FF">fetchMovies</font> .  Pour garantir la conservation de l'abonnement «abonnement» même après l'achèvement de cette fonction, il faut se souvenir de l'abonnement « <font color="#0000FF">abonnement</font> » dans la variable externe à la fonction <font color="#0000FF">fetchMovies</font> .  Dans notre cas, nous utilisons la propriété <font color="#0000FF">subscriptions</font> , qui a le type <font color="#0000FF">Set &lt;AnyCancellable&gt; ()</font> et utilisons la <font color="#0000FF">méthode .store (in: &amp; self.subscriptions)</font> , qui garantit la <font color="#0000FF">convivialité de l '</font> «abonnement» une fois que la fonction <font color="#0000FF">fetchMovies a terminé</font> son travail. <br><br><img src="https://habrastorage.org/webt/uh/zx/j9/uhzxj91hkb5y5tm-hd1bheoukcu.png"><br><br>  Ceci conclut la formation de la méthode <font color="#0000FF">fetchMovies pour</font> sélectionner des films dans la base de données <a href="https://developers.themoviedb.org/3/getting-started/introduction">TMDb en</a> utilisant le framework <font color="#0000FF">Combine</font> .  La méthode <font color="#0000FF">fetchMovies</font> , en tant que paramètre d'entrée <font color="#0000FF">de,</font> prend la valeur de l' <font color="#0000FF">énumération enum Endpoint</font> , c'est-à-dire quels films spécifiques nous intéressent: <br><br>  <font color="#0000FF">.nowPlaying</font> - films actuellement à l'écran, <br>  <font color="#0000FF">.upcoming</font> - films à venir, <br>  <font color="#0000FF">.popular</font> - films populaires, <br>  <font color="#0000FF">.topRated</font> - meilleurs films, c'est-à-dire avec une cote très élevée. <br>  Essayons d'appliquer cette <code>API</code> à la conception d'applications avec les interfaces utilisateur <font color="#0000FF">UIKit</font> habituelles sous la forme d'un <code>Table View Controller</code> : <br><br><img src="https://habrastorage.org/webt/lr/6g/gu/lr6gguhjajdke_udcrw1ihyaonu.png"><br><br>  et à une application dont l'interface utilisateur est construite en utilisant le nouveau <font color="#0000FF">framework</font> déclaratif <font color="#0000FF">SwiftUI</font> : <br><br><img src="https://habrastorage.org/webt/md/_v/kf/md_vkfmsoa--efg4ig5ej-98nue.png"><br><br><h3>  "Abonnez-vous" aux <font color="#0000FF">films</font> des <font color="#0000FF">films</font> <code>View Controller</code> habituels. </h3><br>  Nous passons au fichier <i>MovieListViewController.swift</i> et dans la méthode <font color="#0000FF">viewDidLoad</font> appelons la méthode <font color="#0000FF">fetchMovies</font> . <br><br><img src="https://habrastorage.org/webt/k3/pw/p_/k3pwp_hzhixbhhkgnvuughyv5na.png"><br><br>  Dans notre méthode <font color="#0000FF">fetchMovies,</font> nous utilisons le <font color="#0000FF">movieAPI</font> développé précédemment et sa méthode <font color="#0000FF">fetchMovies</font> avec le paramètre <font color="#0000FF">.nowPlaying</font> comme <font color="#0000FF">point de terminaison du paramètre d'</font> entrée <font color="#0000FF">from</font> .  Autrement dit, nous choisirons les films qui sont actuellement sur les écrans des salles de cinéma. <br><br><img src="https://habrastorage.org/webt/k2/x0/xj/k2x0xjbdbgvi-sk9ifo9u5zxj9e.png"><br><br>  La <font color="#0000FF">méthode movieAPI.fetchMovies (from: .nowPlaying)</font> renvoie le <font color="#0000FF">futur</font> "éditeur", auquel nous "souscrivons" à l'aide de <font color="#0000FF">sink</font> , et lui fournissons deux fermetures.  Dans la fermeture de <font color="#0000FF">receiveCompletion</font> , <font color="#0000FF">nous</font> vérifions s'il y a une erreur d' <font color="#0000FF">erreur</font> et affichons un avertissement d'urgence à l'alerte de l'utilisateur avec le message d'erreur affiché. <br><br><img src="https://habrastorage.org/webt/i8/3f/po/i83fpotmo-qab-imavpikbmsbxo.png"><br><br>  Dans la fermeture <font color="#0000FF">receiveValue,</font> nous appelons la méthode <font color="#0000FF">generateSnapshot</font> et lui passons les <font color="#0000FF">films</font> sélectionnés. <br><br><img src="https://habrastorage.org/webt/iz/hm/qi/izhmqi60prl_u55nf-iypvstnnq.png"><br><br>  La fonction <font color="#0000FF">generateSnapshot génère</font> un nouveau <font color="#0000FF">NSDiffableDataSourceSnapshot à l'</font> aide de nos <font color="#0000FF">films</font> et applique l' <font color="#0000FF">instantané</font> résultant au <font color="#0000FF">diffableDataSource de</font> notre table. <br><br>  Nous lançons l'application et <font color="#0000FF">observons</font> comment <font color="#0000FF">UIKit</font> fonctionne avec les «éditeurs» et les «abonnés» du framework <font color="#0000FF">Combine</font> .  Il s'agit d'une application très simple qui ne vous permet pas de syntoniser diverses collections de films - désormais présentés à l'écran, populaires, très appréciés ou qui vont apparaître à l'écran dans un avenir proche.  Nous ne voyons que les films qui vont apparaître à l'écran (. À <font color="#0000FF">venir</font> ).  Bien sûr, vous pouvez le faire en ajoutant un élément d' <code>UI</code> pour définir les valeurs de l'énumération de point <font color="#0000FF">final</font> , par exemple, à l'aide de <code>Stepper</code> ou de <code>Segmented Control</code> , puis mettez à jour l'interface utilisateur.  C'est bien connu, mais nous ne le ferons pas dans une <font color="#0000FF">application</font> basée sur <font color="#0000FF">UIKit</font> , mais laissons cela au nouveau cadre déclaratif <font color="#0000FF">SwiftUI</font> . <br>  Le code d'une <font color="#0000FF">application</font> basée sur <font color="#0000FF">UIKit</font> se trouve sur <a href="https://github.com/BestKora/CombineFetchAPI">Github</a> dans le <i><code>CombineFetchAPICompleted-UIKit</code></i> . <br><br><h3>  Utilisez <font color="#0000FF">SwiftUI</font> pour afficher des films <font color="#0000FF">films</font> </h3>  . <br>    <code>CombineFetchAPI-MY</code>  <font color="#0000FF">SwiftUI</font>     <code>File</code> -&gt; <code>New</code> -&gt; <code>Project</code>    <code>Single View App</code>   <code>iOS</code> : <br><br><img src="https://habrastorage.org/webt/pi/bu/xu/pibuxuc4tnqd6roa_puo0-iwdpq.png"><br><br>        <code>UI</code> — <font color="#0000FF">SwiftUI</font> : <br><br><img src="https://habrastorage.org/webt/mm/zy/_o/mmzy_o9znv-qwuodqzaveavzsak.png"><br><br>            <code><i>Movie.swift</i></code>      <code><i>Model</i></code> ,     <a href="https://developers.themoviedb.org/3/getting-started/introduction">TMDb</a>  <code><i>MovieStore.swift</i></code> , <code><i>MovieStoreAPIError.swift</i></code>  <code><i>MovieService.swift</i></code> ,       <code><i>MovieService</i></code>  <code><i>Protocol</i></code> : <br><br><img src="https://habrastorage.org/webt/21/ni/4f/21ni4fl3gnd-j4jrehzqt7vf218.png"><br><br>  <font color="#0000FF">SwiftUI</font> ,  <code></code>  <font color="#0000FF">Codable</font> ,      <code>JSON</code> ,  <font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Identifiable</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , si l' </font><font style="vertical-align: inherit;">on veut faciliter l'affichage de la liste des films </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[Film]</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sous la forme d'une liste d' </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">une liste</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Les modèles dans </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SwiftUI</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> n'ont pas besoin d'être </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">équitables</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hashable</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , comme requis par </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UIKit</font></font></font> <code>API</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pour </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UITableViewDiffableDataSource</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dans l' </font><font style="vertical-align: inherit;">application </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UIKit</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> précédente </font><font style="vertical-align: inherit;">. Par conséquent, nous supprimons de la </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">structure</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &lt; </font><font color="#0000FF"><font style="vertical-align: inherit;">struct Movie</font></font><font style="vertical-align: inherit;"> toutes les méthodes associées aux </font><font color="#0000FF"><font style="vertical-align: inherit;">protocoles </font></font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Equatable</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hashable</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br><br><img src="https://habrastorage.org/webt/9m/tu/zd/9mtuzdjefl-wbw3jigfpr5op5bw.png"><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">............................</font></font></b> <br><img src="https://habrastorage.org/webt/_q/uc/b2/_qucb2csrso2vfuac1cvow_ysvm.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Il existe un excellent article </font></font><a href="https://nshipster.com/identifiable/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">identifiable</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> qui montre la différence et les similitudes entre les </font></font><code>Swift</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">protocoles.</font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Identifiable</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hashable</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">équitable</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'interface utilisateur que nous créerons à l'aide de </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SwiftUI</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est basée sur le fait que nous changeons le </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">point de terminaison</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> lors de la récupération des données et obtenons la collection de films dont nous avons besoin, qui est présentée sous la forme d'une liste: </font></font><br><br><img src="https://habrastorage.org/webt/o4/-k/qa/o4-kqamned7_ee6snel_57zc0ek.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ainsi que dans le cas d' </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UIKit</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , les données sont échantillonnées à l'aide de la fonction </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">movieAPI .fetchMovies (from endpoint: Endpoint)</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , qui obtient le </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">point de terminaison</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> souhaité </font><font style="vertical-align: inherit;">et renvoie le "publisher" </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Future &lt;[Movie, MovieStoreAPIError]&gt;</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Si nous jetons un œil à l'énumération </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Endpoint</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , nous verrons que nous pouvons initialiser l'option souhaitée</font></font><font color="#0000FF">case</font>   <font color="#0000FF">Endpoint</font>         <font color="#0000FF">index</font> : <br><br><img src="https://habrastorage.org/webt/ze/jb/9d/zejb9d_o2gr4m4oymkatehr2uuw.png"><br><br> ,       <font color="#0000FF">movies</font> ,     <font color="#0000FF">indexEndpoint</font>  <font color="#0000FF">Endpoint</font> .     <code>View Model</code> ,       <font color="#0000FF">MoviesViewModel</font> ,   <font color="#0000FF">ObservableObject</font> .       <i>MoviesViewModel.swift</i>   <code>View Model</code> : <br><br><img src="https://habrastorage.org/webt/w3/tx/bl/w3txblf8e8ectsgykvterljstjk.png"><br><br>         <font color="#0000FF">@Published</font> :  <font color="#0000FF">@Published var indexEndpoint: Int</font> — ,  <font color="#0000FF">@Published var movies: [Movie]</font> - .     <font color="#0000FF">@Published</font>   <font color="#0000FF">indexEndpoint</font> ,          <font color="#0000FF">indexEndpoint</font> ,    <font color="#0000FF">$indexEndpoint</font> . <br>      <font color="#0000FF">MoviesViewModel</font>       «» <font color="#0000FF">$indexEndpoint</font>   «»  <font color="#0000FF">AnyPublisher&lt;[Movie], Never&gt;</font> ,          <font color="#0000FF">movieAPI.fetchMovies (from: Endpoint (index: indexPoint))</font>   <font color="#0000FF">flatMap</font> . <br><br><img src="https://habrastorage.org/webt/ur/e7/y2/ure7y2ym3mkucrvj-r0ubwezc0i.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ensuite, nous nous «abonnons» à cet «éditeur» nouvellement reçu en utilisant un </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">assing</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> «abonné» très simple </font><font color="#0000FF"><font style="vertical-align: inherit;">(à: \ .movies, on: self)</font></font><font style="vertical-align: inherit;"> et attribuons la valeur reçue de «l'éditeur» au tableau de sortie des </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">films</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Nous pouvons appliquer l' </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">assing</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> «abonnement» </font><font color="#0000FF"><font style="vertical-align: inherit;">(à: \ .movies, on: self)</font></font><font style="vertical-align: inherit;"> uniquement si «l'éditeur» ne </font><font color="#0000FF"><font style="vertical-align: inherit;">renvoie</font></font><font style="vertical-align: inherit;"> pas d'erreur, c'est-à-dire qu'il a un TYPE d'erreur </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Never</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Comment y parvenir? Utilisation de l' </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">opérateur replaceError (avec: [])</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , qui remplace toute erreur par un tableau de </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">films</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> vide de </font><font color="#0000FF"><font style="vertical-align: inherit;">films</font></font><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Autrement dit, la première version plus simple de notre </font><font style="vertical-align: inherit;">application </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SwiftUI</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> n'affichera pas d'informations sur les erreurs possibles pour l'utilisateur.</font></font><br><br> ,     <code>View Model</code>   ,    <code>UI</code> .    <i>ContentView.swift</i>  <code>View Model</code>  <font color="#0000FF">@EnvironmentObject</font>  <font color="#0000FF">var moviesViewModel</font>   <font color="#0000FF">Text(«Hello, World!»)</font>  <br> <font color="#0000FF">Text("\(moviesViewModel.indexEndpoint)")</font> ,     <font color="#0000FF">indexEndpoint</font>   . <br><br><img src="https://habrastorage.org/webt/pr/bu/ic/prbuicibqgoshncctnfzxustbby.png"><br><br>     <code>View Model</code>   <font color="#0000FF">indexEndpoint = 2</font> ,         ,        ( <font color="#0000FF">Upcoming</font> ): <br><br><img src="https://habrastorage.org/webt/bz/ll/-g/bzll-g26ytgu4kya4dh0t5m5wjw.png"><br><br>   <code>UI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Éléments pour contrôler la collection de films que nous voulons montrer. Voici </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Stepper</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br><br><img src="https://habrastorage.org/webt/o5/4j/rg/o54jrgkra0vggnuxmzjrgrfrkkc.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">... et </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Picker</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : les </font></font><br><br><img src="https://habrastorage.org/webt/ei/ln/g6/eilng6a6zeizbtswoq5isrsbxje.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">deux utilisent le "publisher" </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ moviesViewModel.indexEndpoint de la</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nôtre </font></font><code>View Model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, et avec l'un d'eux (de toute façon, lequel) nous pouvons sélectionner la collection de films dont nous avons besoin: </font></font><br><br><img src="https://habrastorage.org/webt/hb/sz/mi/hbszmixxzg4_njoodr2_p-bz3v8.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ensuite, nous ajoutons la liste des films reçus en utilisant </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">List</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ForEach</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et des attributs minimaux film lui-même </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">film</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br><br><img src="https://habrastorage.org/webt/no/zf/g7/nozfg7kd8ednspilzhe0ibzw9cg.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Liste des films affichés </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">filmsViewModel.movies que</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nous prenons également du nôtre </font></font><code>View Model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br><br><img src="https://habrastorage.org/webt/6g/mi/eu/6gmieuzemvr0tjecr_ks_rpq9_w.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous N'utilisons PAS le </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> publisher </font><font color="#0000FF"><font style="vertical-align: inherit;">$ moviesViewModel.movies</font></font><font style="vertical-align: inherit;"> avec le signe </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, car nous n'allons rien éditer dans cette liste de films. Nous utilisons la propriété habituelle </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">moviesViewModel.movies</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vous pouvez rendre la liste de films plus intéressante en affichant dans chaque ligne de la liste l'affiche du film correspondant, </font></font><code>URL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">qui est présentée dans la structure du </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">film</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br><br><img src="https://habrastorage.org/webt/wj/wc/mr/wjwcmrzdsx2g_dxzkj5tt7-cets.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous empruntons cette opportunité à </font></font><a href="https://twitter.com/Dimillian"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Thomas Ricouard</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de son beau projet </font></font><a href="https://github.com/Dimillian/MovieSwiftUI/blob/1d0ebdcb33f1164a3eba8b52a3f212ef0aef1dd9/MovieSwift/MovieSwift/binding/ImageLoader.swift"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MovieSwiftUI</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comme dans le cas du chargement de </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">films</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , pour l'image </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UIImage</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , nous avons le service </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ImageService</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , qui implémente </font><font style="vertical-align: inherit;">la méthode </font><font color="#0000FF"><font style="vertical-align: inherit;">fetchImage</font></font><font style="vertical-align: inherit;"> avec </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Combine</font></font></font><font style="vertical-align: inherit;"></font><font color="#0000FF"><font style="vertical-align: inherit;"></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">De retour « éditeur» </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AnyPublisher &lt;?, un UIImage Never&gt;</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br><br><img src="https://habrastorage.org/webt/ta/rq/zi/tarqziqr1neusqhuvy3xusnbb-c.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">... et </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ImageLoader de classe finale: ObservableObject</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , met en </font><font style="vertical-align: inherit;">œuvre le protocole </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ObservableObject</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> avec </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@Published</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> propriété d' </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">image: UIImage?</font></font></font>  : <br><br><img src="https://habrastorage.org/webt/nm/mf/xb/nmmfxbdfrw54rbwkeghgbrbbq_i.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La seule condition requise par le protocole </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ObservableObject</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est l'existence de la propriété </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">objectWillChange</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SwiftUI</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> utilise cette propriété pour comprendre que quelque chose a changé dans l'instance de cette classe et dès que cela se produit, met à jour toutes les </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vues</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> qui dépendent de l'instance de cette classe. En règle générale, le compilateur crée automatiquement une propriété </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">objectWillChange</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et toutes les </font><font style="vertical-align: inherit;">propriétés </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@Published</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> la notifient également automatiquement. Dans le cas de certaines situations exotiques, vous pouvez créer manuellement un </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">objectWillChange</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et le notifier des modifications. Nous avons juste un tel cas. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dans la classe </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ImageLoader</font></font></font>    <font color="#0000FF">@Published</font>  <font color="#0000FF">var image:UIImage?</font>  .           ,     <font color="#0000FF">ImageLoader</font> ,   «» <font color="#0000FF">$image</font>   «»     <font color="#0000FF">loadImage()</font> ,      <font color="#0000FF">poster</font>   <font color="#0000FF">size</font>    <font color="#0000FF">@Published</font>  <font color="#0000FF">var image:UIImage?</font>  .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous informerons </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">objectWillChange de</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ces modifications </font><font style="vertical-align: inherit;">. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous pouvons avoir beaucoup de ces images dans le tableau, ce qui entraîne des coûts de temps importants, nous utilisons donc la mise en cache des instances </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imageLoader</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de la classe </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ImageLoader</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br><br><img src="https://habrastorage.org/webt/bh/3z/yr/bh3zyrhhwbalksaw_78v2iotffk.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous avons une </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vue</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> spéciale </font><font style="vertical-align: inherit;">pour lire l' </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">affiche du</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> film </font><font color="#0000FF"><font style="vertical-align: inherit;">MoviePosterImage</font></font><font style="vertical-align: inherit;"> : </font></font><br><br><img src="https://habrastorage.org/webt/8o/hs/bj/8ohsbjrvisd-ijjef0nbfrc3p6i.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">... et nous l'utiliserons lors de l'affichage d'une liste de films dans notre </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ContentView</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> principal </font><font style="vertical-align: inherit;">: </font></font><br><br><img src="https://habrastorage.org/webt/h0/xn/l9/h0xnl9hwptsp8flgpsxwq2zpf-u.png"><br><br><img src="https://habrastorage.org/webt/ew/ft/op/ewftopem4n5r0wwh_zv2xj2r07g.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le code de l' </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">application</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> basée sur </font><font color="#0000FF"><font style="vertical-align: inherit;">SwiftUI</font></font><font style="vertical-align: inherit;"> sans affichage d'erreur peut être trouvé sur </font></font><a href="https://github.com/BestKora/CombineFetchAPI"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Github</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dans le dossier </font></font><code>CombineFetchAPI-NOError</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Afficher les erreurs de récupération de film asynchrone à distance. </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jusqu'à présent, nous n'avons pas utilisé ou affiché d'erreurs qui se produisent lors de la sélection asynchrone à distance de films sur le site Web de </font></font><a href="https://developers.themoviedb.org/3/getting-started/introduction"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TMDb</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Bien que la fonction </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">movieAPI.fetchMovies (de endpoint: Endpoint) que nous utilisons</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nous permette de le faire, car elle renvoie le "publisher" </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Future &lt;[Movie, MovieStoreAPIError]&gt;</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Afin de permettre des erreurs, ajouter à notre </font></font><code>View Model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">autre </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@Published</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> propriété </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">moviesError: MovieStoreAPIError?</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> cela représente l'erreur. Il s'agit d'une </font><font style="vertical-align: inherit;">propriété </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">facultative</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , sa valeur initiale est </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nil</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , ce qui correspond à l'absence d'erreur: </font></font><br><br><img src="https://habrastorage.org/webt/-t/em/_y/-tem_ynqrewyk3bdubok9jcb7pu.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pour obtenir cette erreur </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">moviesError</font></font></font> ,       <font color="#0000FF">MoviesViewModel</font>     «» <font color="#0000FF">sink</font> : <br><br><img src="https://habrastorage.org/webt/7c/ie/m0/7ciem0walfc1pwbjraeqlzpwr5q.png"><br><br>  <font color="#0000FF">moviesError</font>    <code>UI</code> ,     <font color="#0000FF">nil</font> … <br><br><img src="https://habrastorage.org/webt/i1/o5/ve/i1o5ve67nptlwcubxxl7ylvup5i.png"><br><br>   <font color="#0000FF">AlertView</font> : <br><br><img src="https://habrastorage.org/webt/kd/st/u8/kdstu80nyu1jvikbxzunxfigkks.png"><br><br>    ,    <code>API</code> : <br><br><img src="https://habrastorage.org/webt/f_/4i/ha/f_4ihalskxufzgz1xra_pdqxwoy.png"><br><br>      <font color="#0000FF">SwiftUI</font>       <a href="https://github.com/BestKora/CombineFetchAPI">Github</a>   <i>CombineFetchAPI-Error</i> . <br><br>       ,     <font color="#0000FF">Future&lt;[Movie],MovieStoreAPIError&gt;</font> ,    <font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AnyPublisher &lt;[Movie], Never&gt;</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dans la méthode </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fetchMoviesLight</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br><br><img src="https://habrastorage.org/webt/-v/3m/hx/-v3mhx-uwkxlzzla7iu-qgigyt0.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'absence d'erreurs ( </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Never</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) nous permet d'utiliser une </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">assignation</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> "abonné" très simple </font><font color="#0000FF"><font style="vertical-align: inherit;">(à: \ .movies, on: self)</font></font><font style="vertical-align: inherit;"> : </font></font><br><br><img src="https://habrastorage.org/webt/zw/ro/up/zwroupvq_yi7shbzefyhsdj8t6e.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tout fonctionnera comme avant:</font></font><br><br><img src="https://habrastorage.org/webt/ux/sa/-n/uxsa-n17hh_tu7nqp_znak3oa-w.png"><br><br><h3>  Conclusion </h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'utilisation du framework </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Combine</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pour traiter une séquence de </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">valeurs</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> apparaissant de manière asynchrone dans le temps est </font><font style="vertical-align: inherit;">très simple et facile. Les opérateurs </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">proposés</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> par </font><font color="#0000FF"><font style="vertical-align: inherit;">Combine</font></font><font style="vertical-align: inherit;"> sont puissants et flexibles. </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Combine</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nous permet d'éviter d'écrire du code asynchrone complexe en utilisant la chaîne en amont des éditeurs </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Éditeurs</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , en utilisant des opérateurs et des </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">abonnés</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> intégrés </font><font style="vertical-align: inherit;">. </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La moissonneuse-batteuse est</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> construite à un niveau inférieur à </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Foundation</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , dans de nombreux cas n'a pas besoin de </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Foundation</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et a des performances incroyables. </font></font><br><br><img src="https://habrastorage.org/webt/eo/la/1q/eola1qc122ogmvluicy5odv9x4g.png"><br><br> <font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SwiftUI est</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> également fortement lié à </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Combine</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&lt;grâce à ses </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@ObservableObject</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@Binding</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@EnvironmentObject</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br> <code>iOS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">les développeurs attendent depuis longtemps </font></font><code>Apple</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ce genre </font><font style="vertical-align: inherit;">de </font><font style="vertical-align: inherit;">cadre officiel, et finalement cette année, c'est arrivé.</font></font><br><br>  Références: <br><br> <a href="https://medium.com/%40alfianlosari/fetching-remote-async-api-with-apple-combine-framework-f7c067c7bb3"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Récupérer l'API Remote Async avec Apple Combine Framework </font></font></a> <br> <a href="https://www.youtube.com/watch%3Fv%3DfejmsuxoIvA"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">essayez! Swift NYC 2019 - Premiers pas avec Combine </font></font></a> <br> <a href="https://theswiftdev.com/2019/10/31/the-ultimate-combine-framework-tutorial-in-swift/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Le tutoriel ultime du framework Combine dans Swift". </font></font></a> <br><br> <a href="https://store.raywenderlich.com/products/combine-asynchronous-programming-with-swift"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Combine: Programmation asynchrone avec Swift </font></font></a> <br><br> <a href="https://developer.apple.com/videos/play/wwdc2019/722/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Présentation de Combine - WWDC 2019 - Vidéos - Développeur Apple. session 722 </font></font></a> <br> <a href="https://developer.apple.com/videos/play/wwdc2019/722/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(synopsis de la session 722 "Introduction to Combine" en russe) </font></font></a> <br><br> <a href="https://developer.apple.com/videos/play/wwdc2019/721"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Combine in Practice - WWDC 2019 - Vidéos - Apple Developer. session 721 </font></font></a> <br> <a href="https://docs.google.com/document/d/1Klsc_7OLx_NWQ-vj6WbdyrmJG1DmoqAAoxLoVB2lbaA/edit%3Fusp%3Dsharing"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(synopsis de la session 721 "Utilisation pratique de Combine" en russe) </font></font></a> <br><br> <a href="https://bestkora.com/IosDeveloper/swiftui-combine-vmeste-luchshe-pochemu-swiftui-i-combine-pomogut-vam-sozdavat-bolee-luchshie-prilozheniya/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SwiftUI &amp; Combine: Together is better. Pourquoi SwiftUI et Combine vous aident à créer de meilleures applications. </font></font></a> <br><br> <a href="https://github.com/Dimillian/MovieSwiftUI/blob/1d0ebdcb33f1164a3eba8b52a3f212ef0aef1dd9/MovieSwift/MovieSwift/binding/ImageLoader.swift"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MovieSwiftUI</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br> <a href="https://medium.com/flawless-app-stories/visualize-combine-magic-with-swiftui-part-1-3a56e2a461b3"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Visualisez Combine Magic avec SwiftUI Partie 1 ()</font></font></a> <br> <a href="https://medium.com/better-programming/visualize-combine-magic-with-swiftui-part-2-2c613370388b">Visualize Combine Magic with SwiftUI – Part 2 (Operators, subscribing, and canceling in Combine)</a> <br><a href="https://medium.com/better-programming/visualize-combine-magic-with-swiftui-part-2-2c613370388b"></a> <a href="https://medium.com/better-programming/visualize-combine-magic-with-swiftui-part-2-2c613370388b">Visualize Combine Magic with SwiftUI Part 3 (See Combine Merge and Append in Action) <br> Visualize Combine Magic with SwiftUI — Part 4</a> <br> <a href="https://medium.com/flawless-app-stories/visualize-combine-magic-with-swiftui-part-5-2783adddbd1d">Visualize Combine Magic with SwiftUI — Part 5</a> <br><br> <a href="https://medium.com/better-programming/getting-started-with-the-combine-framework-in-swift-36fe4ff6e568">Getting Started With the Combine Framework in Swift</a> <br> <a href="https://www.vadimbulavin.com/map-flatmap-switchtolatest-in-combine-framework/">Transforming Operators in Swift Combine Framework: Map vs FlatMap vs SwitchToLatest</a> <br> <a href="https://www.thomasvisser.me/2019/07/06/combine-future/">Combine's Future</a> <br> <a href="https://heckj.github.io/swiftui-notes/">Using Combine</a> <br> <a href="https://theswiftdev.com/2019/08/15/urlsession-and-the-combine-framework/">URLSession and the Combine framework</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr476678/">https://habr.com/ru/post/fr476678/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr476666/index.html">Biologie pour les programmeurs: comment une approche d'ingénierie change le monde</a></li>
<li><a href="../fr476668/index.html">Comment j'ai contrôlé l'ordinateur à partir du téléphone</a></li>
<li><a href="../fr476670/index.html">Vue d'ensemble de la CAO sur le noyau géométrique C3D - 2</a></li>
<li><a href="../fr476674/index.html">Déploiement rapide de ReportPortal pour la familiarisation</a></li>
<li><a href="../fr476676/index.html">48 ressources open source pour JavaScript (2019)</a></li>
<li><a href="../fr476680/index.html">Le système de planification de la production continue de Rodov est le Lean / MRP soviétique de 1961. Décollage, coucher de soleil et nouvelle naissance</a></li>
<li><a href="../fr476682/index.html">Comment écrire un sapeur dans Phaser et exécuter une tâche de test de développeur HTML5</a></li>
<li><a href="../fr476686/index.html">Développement d'une passerelle IoT basée sur Raspberry CM3 +</a></li>
<li><a href="../fr476688/index.html">Nouveau cours d'OTUS. «Développeur IOS. Cours avancé V 2.0 »</a></li>
<li><a href="../fr476692/index.html">Principes du marketing de contenu</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>