<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>â›„ï¸ ğŸ¤³ğŸ¿ ğŸ‘¨â€ğŸ¤ Kubernetesçš„ç”Ÿæ´»ï¼šè¥¿ç­ç‰™äººHTTPæœåŠ¡å™¨å¦‚ä½•ä¸æŠ±æ€¨ ğŸ‘©ğŸ¾â€ğŸ’» ğŸ™‹ğŸ¼ âœ¨</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="æˆ‘ä»¬çš„å®¢æˆ·ä»£è¡¨çš„åº”ç”¨ç¨‹åºå †æ ˆä½äºMicrosoftï¼ˆAzureï¼‰çš„äº‘ä¸­ï¼Œè¯¥å®¢æˆ·çš„ä»£è¡¨é¢ä¸´ä¸€ä¸ªé—®é¢˜ï¼šæœ€è¿‘ï¼Œæ¥è‡ªæ¬§æ´²çš„ä¸€äº›å®¢æˆ·çš„éƒ¨åˆ†è¯·æ±‚å¼€å§‹ä»¥é”™è¯¯400ï¼ˆ é”™è¯¯è¯·æ±‚ ï¼‰ç»“æŸã€‚ æ‰€æœ‰åº”ç”¨ç¨‹åºå‡ä»¥.NETç¼–å†™ï¼Œå¹¶éƒ¨ç½²åœ¨Kubernetesä¸­ã€‚ 

 APIå°±æ˜¯ä¸€ä¸ªåº”ç”¨ç¨‹åºï¼Œæœ€ç»ˆæ‰€æœ‰æµé‡éƒ½é€šè¿‡è¯¥APIåˆ°è¾¾ã€‚ ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Kubernetesçš„ç”Ÿæ´»ï¼šè¥¿ç­ç‰™äººHTTPæœåŠ¡å™¨å¦‚ä½•ä¸æŠ±æ€¨</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/flant/blog/448420/"><img src="https://habrastorage.org/webt/ip/ao/5m/ipao5mmzkrvel4vcwyc-bliov4c.png"><br><br> æˆ‘ä»¬çš„å®¢æˆ·ä»£è¡¨çš„åº”ç”¨ç¨‹åºå †æ ˆä½äºMicrosoftï¼ˆAzureï¼‰çš„äº‘ä¸­ï¼Œè¯¥å®¢æˆ·çš„ä»£è¡¨é¢ä¸´ä¸€ä¸ªé—®é¢˜ï¼šæœ€è¿‘ï¼Œæ¥è‡ªæ¬§æ´²çš„ä¸€äº›å®¢æˆ·çš„éƒ¨åˆ†è¯·æ±‚å¼€å§‹ä»¥é”™è¯¯400ï¼ˆ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">é”™è¯¯è¯·æ±‚</a> ï¼‰ç»“æŸã€‚ æ‰€æœ‰åº”ç”¨ç¨‹åºå‡ä»¥.NETç¼–å†™ï¼Œå¹¶éƒ¨ç½²åœ¨Kubernetesä¸­ã€‚ <a name="habracut"></a><br><br>  APIå°±æ˜¯ä¸€ä¸ªåº”ç”¨ç¨‹åºï¼Œæœ€ç»ˆæ‰€æœ‰æµé‡éƒ½é€šè¿‡è¯¥APIåˆ°è¾¾ã€‚ ç”±.NETå®¢æˆ·ç«¯é…ç½®å¹¶æ‰˜ç®¡åœ¨podä¸­çš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Kestrel</a> HTTPæœåŠ¡å™¨ä¾¦å¬æ­¤æµé‡ã€‚ é€šè¿‡è°ƒè¯•ï¼Œæˆ‘ä»¬æ„Ÿåˆ°å¹¸è¿çš„æ˜¯ï¼Œæœ‰ä¸€ä¸ªç‰¹å®šçš„ç”¨æˆ·å­˜åœ¨ç¨³å®šçš„é‡ç°é—®é¢˜ã€‚ ä½†æ˜¯ï¼Œäº¤é€šé“¾ä½¿ä¸€åˆ‡å˜å¾—å¤æ‚ï¼š <br><br><img src="https://habrastorage.org/webt/c7/-k/rc/c7-krcflwcqow7jevkwx57ypntu.png"><br><br>  Ingressä¸­çš„é”™è¯¯å¦‚ä¸‹æ‰€ç¤ºï¼š <br><br><pre><code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"number_fields"</span></span>:{ <span class="hljs-attr"><span class="hljs-attr">"status"</span></span>:<span class="hljs-number"><span class="hljs-number">400</span></span>, <span class="hljs-attr"><span class="hljs-attr">"request_time"</span></span>:<span class="hljs-number"><span class="hljs-number">0.001</span></span>, <span class="hljs-attr"><span class="hljs-attr">"bytes_sent"</span></span>:<span class="hljs-number"><span class="hljs-number">465</span></span>, <span class="hljs-attr"><span class="hljs-attr">"upstream_response_time"</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-attr"><span class="hljs-attr">"upstream_retries"</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-attr"><span class="hljs-attr">"bytes_received"</span></span>:<span class="hljs-number"><span class="hljs-number">2328</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"stream"</span></span>:<span class="hljs-string"><span class="hljs-string">"stdout"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"string_fields"</span></span>:{ <span class="hljs-attr"><span class="hljs-attr">"ingress"</span></span>:<span class="hljs-string"><span class="hljs-string">"app"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"protocol"</span></span>:<span class="hljs-string"><span class="hljs-string">"HTTP/1.1"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"request_id"</span></span>:<span class="hljs-string"><span class="hljs-string">"f9ab8540407208a119463975afda90bc"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"path"</span></span>:<span class="hljs-string"><span class="hljs-string">"/api/sign-in"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"nginx_upstream_status"</span></span>:<span class="hljs-string"><span class="hljs-string">"400"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"service"</span></span>:<span class="hljs-string"><span class="hljs-string">"app"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"namespace"</span></span>:<span class="hljs-string"><span class="hljs-string">"production"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"location"</span></span>:<span class="hljs-string"><span class="hljs-string">"/front"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"scheme"</span></span>:<span class="hljs-string"><span class="hljs-string">"https"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"method"</span></span>:<span class="hljs-string"><span class="hljs-string">"POST"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"nginx_upstream_response_time"</span></span>:<span class="hljs-string"><span class="hljs-string">"0.000"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"nginx_upstream_bytes_received"</span></span>:<span class="hljs-string"><span class="hljs-string">"120"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"vhost"</span></span>:<span class="hljs-string"><span class="hljs-string">"api.app.example.com"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"host"</span></span>:<span class="hljs-string"><span class="hljs-string">"api.app.example.com"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"user"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"address"</span></span>:<span class="hljs-string"><span class="hljs-string">"83.41.81.250"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"nginx_upstream_addr"</span></span>:<span class="hljs-string"><span class="hljs-string">"10.240.0.110:80"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"referrer"</span></span>:<span class="hljs-string"><span class="hljs-string">"https://api.app.example.com/auth/login?long_encrypted_header"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"service_port"</span></span>:<span class="hljs-string"><span class="hljs-string">"http"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"user_agent"</span></span>:<span class="hljs-string"><span class="hljs-string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/72.0.3626.121 Safari/537.36"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"time"</span></span>:<span class="hljs-string"><span class="hljs-string">"2019-03-06T18:29:16+00:00"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"content_kind"</span></span>:<span class="hljs-string"><span class="hljs-string">"cache-headers-not-present"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"request_query"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"timestamp"</span></span>:<span class="hljs-string"><span class="hljs-string">"2019-03-06 18:29:16"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"labels"</span></span>:{ <span class="hljs-attr"><span class="hljs-attr">"app"</span></span>:<span class="hljs-string"><span class="hljs-string">"nginx"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"pod-template-generation"</span></span>:<span class="hljs-string"><span class="hljs-string">"6"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"controller-revision-hash"</span></span>:<span class="hljs-string"><span class="hljs-string">"1682636041"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"namespace"</span></span>:<span class="hljs-string"><span class="hljs-string">"kube-nginx-ingress"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"nsec"</span></span>:<span class="hljs-number"><span class="hljs-number">6726612</span></span>, <span class="hljs-attr"><span class="hljs-attr">"source"</span></span>:<span class="hljs-string"><span class="hljs-string">"kubernetes"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"host"</span></span>:<span class="hljs-string"><span class="hljs-string">"k8s-node-55555-0"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"pod_name"</span></span>:<span class="hljs-string"><span class="hljs-string">"nginx-v2hcb"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"container_name"</span></span>:<span class="hljs-string"><span class="hljs-string">"nginx"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"boolean_fields"</span></span>:{} }</code> </pre> <br> åŒæ—¶ï¼ŒèŒ¶estç»™ï¼š <br><br><pre> <code class="plaintext hljs">HTTP/1.1 400 Bad Request Connection: close Date: Wed, 06 Mar 2019 12:34:20 GMT Server: Kestrel Content-Length: 0</code> </pre> <br> å³ä½¿æ˜¯æœ€å¤§ç¨‹åº¦çš„å†—é•¿ï¼ŒKestrelé”™è¯¯ä¹ŸåŒ…å«äº†<b>å¾ˆå°‘çš„æœ‰ç”¨ä¿¡æ¯</b> ï¼š <br><br><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"number_fields"</span></span>:{<span class="hljs-attr"><span class="hljs-attr">"ThreadId"</span></span>:<span class="hljs-number"><span class="hljs-number">76</span></span>}, <span class="hljs-attr"><span class="hljs-attr">"stream"</span></span>:<span class="hljs-string"><span class="hljs-string">"stdout"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"string_fields"</span></span>:{ <span class="hljs-attr"><span class="hljs-attr">"EventId"</span></span>:<span class="hljs-string"><span class="hljs-string">"{\"Id\"=&gt;17, \"Name\"=&gt;\"ConnectionBadRequest\"}"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"SourceContext"</span></span>:<span class="hljs-string"><span class="hljs-string">"Microsoft.AspNetCore.Server.Kestrel"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"ConnectionId"</span></span>:<span class="hljs-string"><span class="hljs-string">"0HLL2VJSST5KV"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"@mt"</span></span>:<span class="hljs-string"><span class="hljs-string">"Connection id \"{ConnectionId}\" bad request data: \"{message}\""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"@t"</span></span>:<span class="hljs-string"><span class="hljs-string">"2019-03-07T13:06:48.1449083Z"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"@x"</span></span>:<span class="hljs-string"><span class="hljs-string">"Microsoft.AspNetCore.Server.Kestrel.Core.BadHttpRequestException: Malformed request: invalid headers.\n at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.Http1Connection.TryParseRequest(ReadResult result, Boolean&amp; endConnection)\n at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.&lt;ProcessRequestsAsync&gt;d__185`1.MoveNext()"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"message"</span></span>:<span class="hljs-string"><span class="hljs-string">"Malformed request: invalid headers."</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"timestamp"</span></span>:<span class="hljs-string"><span class="hljs-string">"2019-03-07 13:06:48"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"labels"</span></span>:{ <span class="hljs-attr"><span class="hljs-attr">"pod-template-hash"</span></span>:<span class="hljs-string"><span class="hljs-string">"2368795483"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"service"</span></span>:<span class="hljs-string"><span class="hljs-string">"app"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"namespace"</span></span>:<span class="hljs-string"><span class="hljs-string">"production"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"nsec"</span></span>:<span class="hljs-number"><span class="hljs-number">145341848</span></span>, <span class="hljs-attr"><span class="hljs-attr">"source"</span></span>:<span class="hljs-string"><span class="hljs-string">"kubernetes"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"host"</span></span>:<span class="hljs-string"><span class="hljs-string">"k8s-node-55555-1"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"pod_name"</span></span>:<span class="hljs-string"><span class="hljs-string">"app-67bdcf98d7-mhktx"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"container_name"</span></span>:<span class="hljs-string"><span class="hljs-string">"app"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"boolean_fields"</span></span>:{} }</code> </pre> <br> ä¼¼ä¹åªæœ‰tcpdumpå¯ä»¥å¸®åŠ©è§£å†³æ­¤é—®é¢˜...ä½†æ˜¯æˆ‘å°†åœ¨æµé‡é“¾ä¸Šé‡å¤ä¸€éï¼š <br><br><img src="https://habrastorage.org/webt/c7/-k/rc/c7-krcflwcqow7jevkwx57ypntu.png"><br><br><h2> è°ƒæŸ¥ä¸­ </h2><br> æ˜¾ç„¶ï¼Œæœ€å¥½åœ¨Kuberneteséƒ¨ç½²äº†Podçš„<b>é‚£ä¸ªç‰¹å®šèŠ‚ç‚¹ä¸Š</b>ä¾¦å¬æµé‡ï¼šè½¬å‚¨é‡å°†ä½¿å¾—å¯ä»¥å¾ˆå¿«æ‰¾åˆ°è‡³å°‘ä¸€äº›ä¸œè¥¿ã€‚ ç¡®å®ï¼Œåœ¨è€ƒè™‘å®ƒæ—¶ï¼Œæ³¨æ„åˆ°äº†è¿™æ ·ä¸€ä¸ªæ¡†æ¶ï¼š <br><br><pre> <code class="plaintext hljs">GET /back/user HTTP/1.1 Host: api.app.example.com X-Request-ID: 27ceb14972da8c21a8f92904b3eff1e5 X-Real-IP: 83.41.81.250 X-Forwarded-For: 83.41.81.250 X-Forwarded-Host: api.app.example.com X-Forwarded-Port: 443 X-Forwarded-Proto: https X-Original-URI: /front/back/user X-Scheme: https X-Original-Forwarded-For: 83.41.81.250 X-Nginx-Geo-Client-Country: Spain X-Nginx-Geo-Client-City: M.laga Accept-Encoding: gzip CF-IPCountry: ES CF-RAY: 4b345cfd1c4ac691-MAD CF-Visitor: {"scheme":"https"} pragma: no-cache cache-control: no-cache accept: application/json, text/plain, */* origin: https://app.example.com user-agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/72.0.3626.119 Safari/537.36 referer: https://app.example.com/auth/login accept-language: en-US,en;q=0.9,en-GB;q=0.8,pl;q=0.7 cookie: many_encrypted_cookies; .AspNetCore.Identity.Application=something_encrypted; CF-Connecting-IP: 83.41.81.250 True-Client-IP: 83.41.81.250 CDN-Loop: cloudflare HTTP/1.1 400 Bad Request Connection: close Date: Wed, 06 Mar 2019 12:34:20 GMT Server: Kestrel Content-Length: 0</code> </pre> <br> åœ¨ä»”ç»†æ£€æŸ¥è½¬å‚¨åï¼Œå‘ç°äº†<code>M.laga</code>ä¸€è¯ã€‚ å¾ˆå®¹æ˜“çŒœåˆ°åœ¨è¥¿ç­ç‰™æ²¡æœ‰åŸå¸‚M.lagaï¼ˆä½†æ˜¯æœ‰<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">MÃ¡laga</a> ï¼‰ã€‚ æŒæ¡äº†è¿™ä¸ªæƒ³æ³•ä¹‹åï¼Œæˆ‘ä»¬æŸ¥çœ‹äº†Ingressé…ç½®ï¼Œå…¶ä¸­æˆ‘ä»¬çœ‹åˆ°ä¸€ä¸ªæœˆå‰ï¼ˆåº”å®¢æˆ·è¦æ±‚ï¼‰æ’å…¥çš„<b>â€œæ— å®³â€ä»£ç æ®µ</b> ï¼š <br><br><pre> <code class="plaintext hljs"> ingress.kubernetes.io/configuration-snippet: | proxy_set_header X-Nginx-Geo-Client-Country $geoip_country_name; proxy_set_header X-Nginx-Geo-Client-City $geoip_city;</code> </pre> <br> å½“æ‚¨ç¦ç”¨è¿™äº›æ ‡å¤´çš„è½¬å‘æ—¶ï¼Œä¸€åˆ‡å°±å˜å¥½äº†ï¼  ï¼ˆå¾ˆå¿«å°±çŸ¥é“ï¼Œåº”ç”¨ç¨‹åºæœ¬èº«ä¸å†éœ€è¦è¿™äº›æ ‡å¤´ã€‚ï¼‰ <br><br> ç°åœ¨ï¼Œè®©æˆ‘ä»¬<b>ä»¥æ›´ä¸€èˆ¬çš„æ–¹å¼</b>æ¥çœ‹é—®é¢˜ã€‚ å¦‚æœæ‚¨å‘<code>localhost:80</code>å‘å‡ºtelnetè¯·æ±‚ï¼Œåˆ™å¯ä»¥åœ¨åº”ç”¨ç¨‹åºå†…éƒ¨è½»æ¾å¤åˆ¶å®ƒ<code>localhost:80</code> ï¼š <br><br><pre> <code class="plaintext hljs">GET /back/user HTTP/1.1 Host: api.app.example.com cache-control: no-cache accept: application/json, text/plain, */* origin: https://app.example.com Cookie: test=Desiree</code> </pre> <br>  ... <code>401 Unauthorized</code>é€€è´§ï¼Œä¸é¢„æœŸçš„ä¸€æ ·ã€‚ å¦‚æœæˆ‘ä»¬è¿™æ ·åšä¼šå‘ç”Ÿä»€ä¹ˆï¼š <br><br><pre> <code class="plaintext hljs">GET /back/user HTTP/1.1 Host: api.app.example.com cache-control: no-cache accept: application/json, text/plain, */* origin: https://app.example.com Cookie: test=DÃ©sirÃ©e</code> </pre> <br>  ï¼Ÿ <br><br>  <code>400 Bad request</code>è¿”å›-åœ¨åº”ç”¨ç¨‹åºæ—¥å¿—ä¸­ï¼Œæˆ‘ä»¬å°†å¾—åˆ°æˆ‘ä»¬å·²ç»çŸ¥é“çš„é”™è¯¯ï¼š <br><br><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"@t"</span></span>:<span class="hljs-string"><span class="hljs-string">"2019-03-31T12:59:54.3746446Z"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"@mt"</span></span>:<span class="hljs-string"><span class="hljs-string">"Connection id \"{ConnectionId}\" bad request data: \"{message}\""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"@x"</span></span>:<span class="hljs-string"><span class="hljs-string">"Microsoft.AspNetCore.Server.Kestrel.Core.BadHttpRequestException: Malformed request: invalid headers.\n at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.Http1Connection.TryParseRequest(ReadResult result, Boolean&amp; endConnection)\n at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.&lt;ProcessRequestsAsync&gt;d__185`1.MoveNext()"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"ConnectionId"</span></span>:<span class="hljs-string"><span class="hljs-string">"0HLLLR1J974L9"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"message"</span></span>:<span class="hljs-string"><span class="hljs-string">"Malformed request: invalid headers."</span></span>, <span class="hljs-attr"><span class="hljs-attr">"EventId"</span></span>:{ <span class="hljs-attr"><span class="hljs-attr">"Id"</span></span>:<span class="hljs-number"><span class="hljs-number">17</span></span>, <span class="hljs-attr"><span class="hljs-attr">"Name"</span></span>:<span class="hljs-string"><span class="hljs-string">"ConnectionBadRequest"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"SourceContext"</span></span>:<span class="hljs-string"><span class="hljs-string">"Microsoft.AspNetCore.Server.Kestrel"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"ThreadId"</span></span>:<span class="hljs-number"><span class="hljs-number">71</span></span> }</code> </pre> <br><h2> æ€»ç»“ </h2><br> å…·ä½“æ¥è¯´ï¼ŒKestrel <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ— æ³•</a>æ­£ç¡®å¤„ç†UTF-8ä¸­å…·æœ‰æ­£ç¡®å­—ç¬¦çš„HTTPæ ‡å¤´ï¼Œè¿™äº›æ ‡å¤´åŒ…å«åœ¨ç›¸å½“å¤šçš„åŸå¸‚çš„åç§°ä¸­ã€‚ <br><br> åœ¨æˆ‘ä»¬çš„æ¡ˆä¾‹ä¸­ï¼Œå¦ä¸€ä¸ªå› ç´ æ˜¯å®¢æˆ·ç«¯å½“å‰ä¸æ‰“ç®—æ›´æ”¹åº”ç”¨ç¨‹åºä¸­Kestrelçš„å®ç°ã€‚ ä½†æ˜¯ï¼ŒAspNetCoreæœ¬èº«ï¼ˆ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ç¼–å·4318</a> ï¼Œ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ç¼–å·7707</a> ï¼‰ä¸­çš„é—®é¢˜è¡¨æ˜ï¼Œè¿™æ— æµäºäº‹... <br><br> æ€»ç»“ï¼šæ³¨é‡Šä¸å†æ˜¯å…³äºKestrelæˆ–UTF-8çš„ç‰¹å®šé—®é¢˜ï¼ˆåœ¨2019å¹´ï¼Œï¼Ÿï¼ï¼‰ï¼Œè€Œæ˜¯åœ¨å¯»æ‰¾é—®é¢˜çš„è¿‡ç¨‹ä¸­<b>å¯¹</b>æ¯ä¸ªæ­¥éª¤çš„<b>å…³æ³¨å’Œä¸€è‡´ç ”ç©¶</b>è¿Ÿæ—©ä¼šè§æ•ˆã€‚ ç¥ä½ å¥½è¿ï¼ <br><br><h2> èšè‹¯ä¹™çƒ¯ </h2><br> å¦è¯·å‚é˜…æˆ‘ä»¬çš„åšå®¢ï¼š <br><br><ul><li>  â€œ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Kubernetes [åŠå…¶è§£å†³æ–¹æ¡ˆ]æ“ä½œä¸­çš„6ä¸ªæœ‰è¶£çš„ç³»ç»Ÿé”™è¯¯</a> â€ï¼› </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Kubernetesæç¤ºå’ŒæŠ€å·§ï¼šNGINX Ingressä¸­çš„ä¸ªæ€§åŒ–é”™è¯¯é¡µé¢</a> ï¼› </li><li>  â€œ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Kubernetesçš„Ingressæ§åˆ¶å™¨æ¦‚è¿°å’Œæ¯”è¾ƒ</a> â€ï¼› </li><li>  â€œ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ç›‘æ§Kubernetesä¸»æœºä¹‹é—´çš„pingæ˜¯æˆ‘ä»¬çš„è¯€çª</a> â€ï¼› </li><li>  â€œ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å…³äºLinuxç½‘ç»œå­ç³»ç»Ÿçš„3ç§å¼‚å¸¸æƒ…å†µ</a> ã€‚â€ </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN448420/">https://habr.com/ru/post/zh-CN448420/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN448404/index.html">å¦‚ä½•ä½¿ç”¨Yandex.Direct APIç¤ºä¾‹ï¼ˆç¬¬2éƒ¨åˆ†ï¼‰ä½¿ç”¨å¹¶è¡Œè®¡ç®—æ¥åŠ å¿«Rè¯­è¨€APIçš„å·¥ä½œé€Ÿåº¦</a></li>
<li><a href="../zh-CN448408/index.html">DCIM-æ•°æ®ä¸­å¿ƒç®¡ç†çš„å…³é”®</a></li>
<li><a href="../zh-CN448410/index.html">Googleçš„è·Ÿè¸ªå™¨å·²å†…ç½®åœ¨è®¸å¤šä¿„ç½—æ–¯å®˜æ–¹ç”µå­èµ„æºä¸­</a></li>
<li><a href="../zh-CN448414/index.html">ç”¨äºè‡ªæ§çš„å®¶åº­å®éªŒå®¤ï¼Œæˆ–ä½¿ç”¨æ€ªèƒå¥—ä»¶è´­ä¹°çš„ç‰©å“</a></li>
<li><a href="../zh-CN448416/index.html">åœ¨iOSåº”ç”¨ç¨‹åºä¸­è¿›è¡ŒèŠå¤©çš„æœ€ç®€å•æ–¹æ³•</a></li>
<li><a href="../zh-CN448422/index.html">E-Dobavkiæ˜¯æˆ‘çš„å­¦ç”Ÿç¼–å†™çš„Javaå’ŒSpring Booté£Ÿå“è¡¥å……æœç´¢æœåŠ¡</a></li>
<li><a href="../zh-CN448424/index.html">55å¹´åï¼šæ ‡å¿—æ€§çš„IBM System / 360å¤§å‹æœºå´‡æ‹œæ§åˆ¶å°</a></li>
<li><a href="../zh-CN448430/index.html">Pro Content 2019ï¼šä¸‰ä»½ç¡¬æ€§æŠ¥å‘Šå’Œç®€çŸ­å†…å®¹</a></li>
<li><a href="../zh-CN448432/index.html">èƒ¶ç²˜å‰‚è¾å°„ï¼šè¯±å¯¼çš„æ”¾å°„æ€§ï¼Œæ”¾å°„æ€§æ±¡æŸ“ï¼Œå»æ±¡...</a></li>
<li><a href="../zh-CN448434/index.html">é¡¶çº§ç§»åŠ¨åº”ç”¨å¼€å‘å…¬å¸</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>