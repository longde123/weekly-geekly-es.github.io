<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üéæ ‚úäüèæ üë®‚Äçüë©‚Äçüë¶‚Äçüë¶ Entwicklerkochbuch: DDD-Rezepte (Teil 4, Strukturen) üëêüèæ üë©üèΩ‚Äçü§ù‚Äçüë®üèº üëº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Einf√ºhrung 


 Daher haben wir uns bereits f√ºr Umfang , Methodik und Architektur entschieden . Gehen wir von der Theorie zur Praxis und zum Schreiben ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Entwicklerkochbuch: DDD-Rezepte (Teil 4, Strukturen)</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/435920/"><h1 id="vvedenie">  Einf√ºhrung </h1><br><p> Daher haben wir uns bereits f√ºr <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Umfang</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Methodik</a> und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Architektur entschieden</a> .  Gehen wir von der Theorie zur Praxis und zum Schreiben von Code.  Ich m√∂chte mit Entwurfsmustern beginnen, die die Gesch√§ftslogik beschreiben - <em>Service</em> und <em>Interactor</em> .  Bevor wir uns jedoch mit ihnen befassen, werden wir die Strukturmuster - <em>ValueObject</em> und <em>Entity - untersuchen</em> .  Wir werden uns in <em>Rubinsprache</em> entwickeln.  In weiteren Artikeln werden wir alle f√ºr die Entwicklung erforderlichen Muster mithilfe der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Variablenarchitektur</a> analysieren.  Alle Entwicklungen, die f√ºr diese Artikelserie gelten, werden in einem separaten Rahmen zusammengefasst. </p><br><p><img src="https://habrastorage.org/webt/uc/iz/ea/ucizea6-xkpivfyv18q9fvds9wm.jpeg" alt="Blacjack &amp; Hockers"></p><br><p>  Und wir haben bereits einen passenden Namen gefunden - <strong>LunaPark</strong> . <br>  Aktuelle Entwicklungen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">auf Github</a> . <br>  Nachdem wir alle Vorlagen gepr√ºft haben, werden wir einen vollwertigen Mikroservice zusammenstellen. </p><a name="habracut"></a><br><h1 id="tak-istoricheski-slozhilos">  Also historisch </h1><br><p>  Eine komplexe Unternehmensanwendung, die in Ruby on Rails geschrieben wurde, musste √ºberarbeitet werden.  Es gab ein fertiges Team von Ruby-Entwicklern.  Die Domain Driven Development-Methode war perfekt f√ºr diese Aufgaben, aber es gab keine schl√ºsselfertige L√∂sung in der verwendeten Sprache.  Trotz der Tatsache, dass die Wahl der Sprache haupts√§chlich von unserer Spezialisierung bestimmt wurde, erwies sie sich als recht erfolgreich.  Unter allen Sprachen, die √ºblicherweise f√ºr Webanwendungen verwendet werden, ist Ruby meiner Meinung nach die ausdrucksst√§rkste.  Und daher mehr als andere, die zur Modellierung realer Objekte geeignet sind.  Dies ist nicht nur meine Meinung. </p><br><blockquote>  Das ist die Java-Welt.  Dann haben Sie die Neuank√∂mmlinge wie Ruby.  Ruby hat eine sehr ausdrucksstarke Syntax, und auf dieser Grundstufe sollte es eine sehr gute Sprache f√ºr DDD sein (obwohl ich noch nicht von einer tats√§chlichen Verwendung in solchen Anwendungen geh√∂rt habe).  Rails hat viel Aufregung ausgel√∂st, da es die Erstellung von Web-Benutzeroberfl√§chen endlich so einfach zu machen scheint, wie es die Benutzeroberfl√§chen Anfang der neunziger Jahre vor dem Web waren.  Im Moment wurde diese Funktion haupts√§chlich zum Erstellen einiger der zahlreichen Webanwendungen verwendet, hinter denen nicht viel Dom√§nenreichtum steckt, da selbst diese in der Vergangenheit √§u√üerst schwierig waren.  Ich hoffe jedoch, dass die Leute dies als Gelegenheit sehen, ihre Aufmerksamkeit mehr auf die Dom√§ne zu richten, da der Teil der UI-Implementierung des Problems reduziert wird.  Sollte die Verwendung von Ruby jemals in diese Richtung gehen, k√∂nnte dies meiner Meinung nach eine hervorragende Plattform f√ºr DDD darstellen.  (Ein paar Infrastrukturteile m√ºssten wahrscheinlich ausgef√ºllt werden.) <br><br>  Eric Evans 2006 </blockquote><p>  Leider hat sich in den letzten 13 Jahren nicht viel ge√§ndert.  Im Internet finden Sie Versuche, Rails daf√ºr anzupassen, aber alle sehen schrecklich aus.  Das Rails-Framework ist schwer, langsam und nicht fest.  Es ist sehr schwierig, ohne Tr√§nen zu beobachten, wie jemand versucht, die Implementierung des <em>Repository-</em> Musters auf der Basis von <em>ActiveRecord</em> darzustellen.  Wir haben uns entschlossen, ein Mikroframework zu √ºbernehmen und es an unsere Bed√ºrfnisse anzupassen.  Wir haben <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Grape</a> ausprobiert, die Idee mit der automatischen Dokumentation schien erfolgreich zu sein, aber ansonsten wurde sie aufgegeben und wir haben die Idee, sie zu verwenden, schnell aufgegeben.  Und fast sofort begannen sie, eine andere L√∂sung zu verwenden - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Sinatra</a> .  Wir verwenden es weiterhin f√ºr REST- <em>Controller</em> und <em>Endpunkte</em> . </p><br><div class="spoiler">  <b class="spoiler_title">RUHE?</b> <div class="spoiler_text"><p>  Wenn Sie Webanwendungen entwickelt haben, haben Sie bereits eine Vorstellung von der Technologie.  Es hat seine Vor- und Nachteile, deren vollst√§ndige Auflistung den Rahmen dieses Artikels sprengt.  F√ºr uns als Entwickler von Unternehmensanwendungen ist der wichtigste Nachteil jedoch, dass REST (dies geht sogar aus dem Namen hervor) nicht den Prozess, sondern seinen Status widerspiegelt.  Der Vorteil ist die Verst√§ndlichkeit: Die Technologie ist sowohl f√ºr Back-End-Entwickler als auch f√ºr Front-End-Entwickler klar. <br>  Aber dann konzentrieren Sie sich vielleicht nicht auf REST, sondern implementieren Ihre http + json-L√∂sung?  Selbst wenn Sie es schaffen, Ihre Service-API zu entwickeln, erhalten Sie viele Fragen, wenn Sie die Beschreibung an Dritte weitergeben.  Viel mehr als wenn Sie den bekannten REST bereitstellen. <br>  Wir werden die Verwendung von REST als Kompromissl√∂sung in Betracht ziehen.  Wir verwenden JSON aus <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Gr√ºnden</a> der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">√úbersichtlichkeit</a> und des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">jsonapi-</a> Standards, um Entwicklern keine Zeit mit heiligen Kriegen bez√ºglich des Anforderungsformats zu verschwenden. <br>  Wenn wir in Zukunft <em>Endpoint</em> analysieren, werden wir <em>feststellen</em> , dass es ausreicht, nur eine Klasse neu zu schreiben, um die Ruhe loszuwerden.  REST sollte sich also √ºberhaupt nicht darum k√ºmmern, wenn Zweifel bestehen. </p></div></div><br><p>  W√§hrend des Schreibens mehrerer Microservices haben wir Grundlagen geschaffen - eine Reihe abstrakter Klassen.  Jede solche Klasse kann in einer halben Stunde geschrieben werden. Der Code ist leicht zu verstehen, wenn Sie wissen, wof√ºr dieser Code gedacht ist. </p><br><p>  Hier traten die Hauptschwierigkeiten auf.  Neue Mitarbeiter, die sich nicht mit DDD-Praktiken und einer sauberen Architektur befassten, konnten den Code und seinen Zweck nicht verstehen.  Wenn ich diesen Code selbst zum ersten Mal sehen w√ºrde, bevor ich Evans lese, w√ºrde ich ihn als Verm√§chtnis betrachten, als √úberentwicklung. </p><br><p>  Um dieses Hindernis zu √ºberwinden, wurde beschlossen, eine Dokumentation (Richtlinie) zu verfassen, die die Philosophie der verwendeten Ans√§tze beschreibt.  Die Umrisse dieser Dokumentation schienen erfolgreich zu sein, und es wurde beschlossen, sie auf Habr√© zu setzen.  Abstrakte Klassen, die von Projekt zu Projekt wiederholt wurden, wurde beschlossen, ein separates Juwel einzubauen. </p><br><h1 id="filosofiya">  Philosophie </h1><br><p><img src="https://habrastorage.org/webt/eg/zm/c8/egzmc89jktbwuobb67mh-stoijc.png" alt="Legacy-weg"><br>  Wenn Sie sich an einen klassischen Film √ºber Kampfkunst erinnern, dann wird es einen coolen Typen geben, der sehr geschickt mit einer Stange umgeht.  Ein Sechster ist im Wesentlichen ein Stock, ein sehr primitives Werkzeug, eines der ersten, das in menschliche H√§nde gefallen ist.  Aber in den H√§nden des Meisters wird er zu einer beeindruckenden Waffe. <br>  Sie k√∂nnen Zeit damit verbringen, eine Pistole zu erstellen, die Sie nicht ins Bein schie√üt, oder Sie k√∂nnen Zeit damit verbringen, die Schie√ütechnik zu erlernen.  Wir haben 4 Grundprinzipien identifiziert: </p><br><ul><li>  Sie m√ºssen komplexe Dinge einfach machen. </li><li>  Wissen ist wichtiger als Technologie.  Dokumentation ist f√ºr eine Person verst√§ndlicher als Code, man sollte sie nicht durch eine andere ersetzen. </li><li>  Pragmatismus ist wichtiger als Dogmatismus.  Standards sollten den Weg weisen und keinen Begrenzungsrahmen festlegen. </li><li>  Strukturalit√§t in der Architektur, Flexibilit√§t bei der Auswahl der L√∂sungen. </li></ul><br><p>  Eine √§hnliche Philosophie l√§sst sich beispielsweise im ArchLinux OS - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">The Arch Way</a> nachvollziehen.  Auf meinem Laptop hat Linux lange Zeit keine Wurzeln geschlagen, fr√ºher oder sp√§ter ist es kaputt gegangen und ich musste es st√§ndig neu installieren.  Dies verursachte eine Reihe von Problemen, manchmal schwerwiegende Probleme wie die Unterbrechung der Arbeitsfrist.  Aber nachdem ich 2-3 Tage mit der Installation von Arch verbracht hatte, fand ich heraus, wie mein Betriebssystem funktioniert.  Danach begann sie ohne Fehler stabiler zu arbeiten.  Meine Notizen halfen mir, es in ein paar Stunden auf neuen PCs zu installieren.  Eine reichliche Dokumentation half mir, neue Probleme zu l√∂sen. </p><br><p>  Das Framework hat einen absolut hochrangigen Charakter.  Die Klassen, die es beschreiben, sind f√ºr die Struktur der Anwendung verantwortlich.  L√∂sungen von Drittanbietern werden verwendet, um mit Datenbanken zu interagieren, das http-Protokoll und andere Dinge auf niedriger Ebene zu implementieren.  Wir m√∂chten, dass der Programmierer den Code untersucht, wenn eine Frage auftaucht, und versteht, wie eine bestimmte Klasse funktioniert, und dass die Dokumentation es uns erm√∂glicht, zu verstehen, wie sie verwaltet werden.  Wenn Sie das Motordesign verstehen, k√∂nnen Sie kein Auto fahren. </p><br><h1 id="freymvork">  Framework </h1><br><p>  Es ist schwierig, LunaPark als Framework im √ºblichen Sinne zu bezeichnen.  Rahmen - Rahmen, Arbeit - Arbeit.  Wir dr√§ngen darauf, uns nicht auf den Umfang zu beschr√§nken.  Der einzige Frame, den wir deklarieren, ist derjenige, der der Klasse mitteilt, in der diese oder jene Logik beschrieben werden soll.  Es handelt sich vielmehr um eine Reihe von Tools mit ausf√ºhrlichen Anweisungen. <br>  Jede Klasse ist abstrakt und hat drei Ebenen: </p><br><pre><code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">LunaPark</span></span></span><span class="hljs-class"> </span><span class="hljs-comment"><span class="hljs-class"><span class="hljs-comment">#  module Forms #  class Single # / end end end</span></span></span></span></code> </pre> <br><p>  Wenn Sie ein Formular implementieren m√∂chten, das ein einzelnes Element erstellt, erben Sie von dieser Klasse: </p><br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Forms</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Create</span></span></span><span class="hljs-class"> &lt; LunaPark::Forms::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Single</span></span></span></span></code> </pre> <br><p>  Wenn es mehrere Elemente gibt, verwenden wir eine andere <em>Implementierung</em> . </p><br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Forms</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Create</span></span></span><span class="hljs-class"> &lt; LunaPark::Forms::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Multiple</span></span></span></span></code> </pre> <br><p>  Im Moment sind nicht alle Entwicklungen in perfekter Reihenfolge und Edelstein befindet sich im Alpha-Zustand.  Wir werden es in √úbereinstimmung mit der Ver√∂ffentlichung von Artikeln schrittweise zitieren.  Das hei√üt,  Wenn Sie einen Artikel √ºber <code>ValueObject</code> und <code>Entity</code> , sind diese beiden Vorlagen bereits implementiert.  Am Ende des Zyklus sind alle f√ºr den Einsatz im Projekt geeignet.  Da das Framework selbst ohne einen Link zu sinatra \ roda wenig n√ºtzlich ist, wird ein separates Repository erstellt, das zeigt, wie Sie ‚Äûalles vermasseln‚Äú k√∂nnen, um Ihr Projekt schnell zu starten. </p><br><p>  Das Framework ist in erster Linie eine Anwendung auf die Dokumentation.  Nehmen Sie diese Artikel nicht als Dokumentation f√ºr das Framework wahr. </p><br><p>  Kommen wir also zur Sache. </p><br><h1 id="obekt-znachenie-value">  Wertobjekt </h1><br><blockquote>  - Wie gro√ü ist deine Freundin? <br>  - 151 <br>  - Sie haben angefangen, sich mit der Freiheitsstatue zu treffen? </blockquote><p>  So etwas h√§tte in Indiana passieren k√∂nnen.  Das menschliche Wachstum ist nicht nur eine Zahl, sondern auch eine Ma√üeinheit.  Nicht immer k√∂nnen Attribute eines Objekts nur durch Grundelemente (Integer, String, Boolean usw.) beschrieben werden. Manchmal sind Kombinationen davon erforderlich: </p><br><ul><li>  Geld ist nicht nur eine Zahl, es ist eine Zahl (Betrag) + W√§hrung. </li><li>  Ein Datum besteht aus einem Tag, einem Monat und einem Jahr. </li><li>  Um das Gewicht zu messen, reicht uns eine einzige Zahl nicht aus, sondern es ist auch eine Ma√üeinheit erforderlich. </li><li>  Die Passnummer besteht aus einer Reihe und tats√§chlich aus der Nummer. </li></ul><br><p>  Andererseits ist dies nicht immer eine Kombination, vielleicht ist es eine Art Erweiterung des Primitiven. <br>  Eine Telefonnummer wird oft als Nummer genommen.  Andererseits ist es unwahrscheinlich, dass er eine Methode der Addition oder Division haben sollte.  Vielleicht gibt es eine Methode, die einen L√§ndercode ausgibt, und eine Methode, die einen Stadtcode definiert.  Vielleicht gibt es eine bestimmte dekorative Methode, die es nicht nur als Zeichenfolge <code>79001231212</code> , sondern als lesbare Zeichenfolge darstellt: <code>7-900-123-12-12</code> . </p><br><div class="spoiler">  <b class="spoiler_title">vielleicht ein Dekorateur?</b> <div class="spoiler_text"><p>  Basierend auf Dogmen ist es unbestreitbar - ja.  Wenn wir uns diesem Dilemma des gesunden Menschenverstandes n√§hern, werden wir, wenn wir uns entscheiden, diese Nummer anzurufen, das Objekt selbst auf das Telefon √ºbertragen: </p><br><pre> <code class="ruby hljs">phone.call Values::PhoneNumber.new(<span class="hljs-number"><span class="hljs-number">79001231212</span></span>)</code> </pre> <br><p>  Und wenn wir uns entschieden haben, es als String zu pr√§sentieren, dann ist dies eindeutig f√ºr eine Person getan.  Warum machen wir diese Zeile nicht sofort f√ºr eine Person lesbar? </p><br><pre> <code class="ruby hljs">Values::PhoneNumber.new(<span class="hljs-number"><span class="hljs-number">79001231212</span></span>).to_s</code> </pre> </div></div><br><p>  Stellen Sie sich vor, wir erstellen die Online-Casino-Website Three Axes und verkaufen Kartenspiele.  Wir brauchen die Klasse "Spielkarte". </p><br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Values</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PlayingCard</span></span></span><span class="hljs-class"> &lt; Lunapark::Values::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Compound</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">attr_reader</span></span></span><span class="hljs-class"> :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">suit</span></span></span><span class="hljs-class">, :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">rank</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span></span></code> </pre> <br><p>  Unsere Klasse hat also zwei schreibgesch√ºtzte Attribute: </p><br><ul><li>  Anzug - Kartenanzug </li><li>  Rangkartenw√ºrde </li></ul><br><p>  Diese Attribute werden nur beim Erstellen einer Karte festgelegt und k√∂nnen bei Verwendung nicht ge√§ndert werden.  Nat√ºrlich k√∂nnen Sie eine Spielkarte nehmen und <s>8</s> streichen, Q schreiben, aber das ist nicht akzeptabel.  In einer anst√§ndigen Gesellschaft werden Sie h√∂chstwahrscheinlich erschossen.  Die Unf√§higkeit, Attribute nach dem Erstellen des Objekts zu √§ndern, bestimmt die erste Eigenschaft des <em>Wertobjekts</em> - die Unver√§nderlichkeit. <br>  Die zweite wichtige Eigenschaft des <em>Wertobjekts</em> ist, wie wir sie vergleichen. </p><br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Values</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RSpec</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">describe</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PlayingCard</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">do</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">let</span></span></span><span class="hljs-class">(:</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">card</span></span></span><span class="hljs-class">) { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">described_class</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">new</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">suit</span></span></span><span class="hljs-class">: :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">clubs</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">rank</span></span></span><span class="hljs-class">: 10 } </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">let</span></span></span><span class="hljs-class">(:</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">other</span></span></span><span class="hljs-class">) { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">described_class</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">new</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">suit</span></span></span><span class="hljs-class">: :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">clubs</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">rank</span></span></span><span class="hljs-class">: 10 } </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">it</span></span></span><span class="hljs-class"> '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">should</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">be</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">eql</span></span></span><span class="hljs-class">' </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">do</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">expect</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">card</span></span></span><span class="hljs-class">).</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">to</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">eq</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">other</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span></span></code> </pre> <br><p>  Ein solcher Test schl√§gt fehl, da sie an der Adresse verglichen werden.  Damit der Test erfolgreich ist, m√ºssen wir <em>Value-Obects</em> nach Wert vergleichen. <em>Dazu</em> f√ºgen wir eine Vergleichsmethode hinzu: </p><br><pre> <code class="ruby hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">==</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(other)</span></span></span></span> suit == other.suit &amp;&amp; rank == other.rank <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre> <br><p>  Jetzt wird unser Test bestehen.  Wir k√∂nnen auch Methoden hinzuf√ºgen, die f√ºr den Vergleich verantwortlich sind, aber wie vergleichen wir 10 und K?  Wie Sie wahrscheinlich bereits vermutet haben, werden wir sie auch in Form <em>von Wertobjekten pr√§sentieren</em> .  Ok, jetzt m√ºssen wir die zehn besten Clubs wie folgt initiieren: </p><br><pre> <code class="ruby hljs">ten = Values::Rank.new(<span class="hljs-string"><span class="hljs-string">'10'</span></span>) clubs = Values::Suits.new(<span class="hljs-symbol"><span class="hljs-symbol">:clubs</span></span>) ten_clubs = Values::PlayingCards.new(<span class="hljs-symbol"><span class="hljs-symbol">rank:</span></span> ten, <span class="hljs-symbol"><span class="hljs-symbol">clubs:</span></span> clubs)</code> </pre> <br><p>  Drei Zeilen reichen f√ºr Rubin.  Um diese Einschr√§nkung zu umgehen, f√ºhren wir die dritte Eigenschaft des <em>Objektwerts ein</em> - Umsatz.  Lassen Sie uns eine spezielle Methode der <code>.wrap</code> Klasse haben, die Werte verschiedener Typen annehmen und in die richtigen konvertieren kann. </p><br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PlayingCard</span></span></span><span class="hljs-class"> &lt; Lunapark::Values::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Compound</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">self</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wrap</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">obj</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">case</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">obj</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">is_a?</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">self</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span><span class="hljs-comment"><span class="hljs-class"><span class="hljs-comment">#      PlayingCard obj #      case obj.is_a? Hash #    ,      new(obj) #    case obj.is_a String #    ,     new rank: obj[0..-2], suit:[-1] # ,  -  . else #       raise ArgumentError #  . end end def initialize(suit:, rank:) #     </span></span><span class="hljs-doctag"><span class="hljs-class"><span class="hljs-comment"><span class="hljs-doctag">@suit</span></span></span></span><span class="hljs-class"><span class="hljs-comment"> = Suit.wrap(suit) #      </span></span><span class="hljs-doctag"><span class="hljs-class"><span class="hljs-comment"><span class="hljs-doctag">@rank</span></span></span></span><span class="hljs-class"><span class="hljs-comment"> = Rank.wrap(rank) end end</span></span></span></span></code> </pre> <br><p>  Dieser Ansatz bietet einen gro√üen Vorteil: </p><br><pre> <code class="ruby hljs">ten = Values::Rank.new(<span class="hljs-string"><span class="hljs-string">'10'</span></span>) clubs = Values::Suits.new(<span class="hljs-symbol"><span class="hljs-symbol">:clubs</span></span>) from_values = Values::PlayingCard.wrap <span class="hljs-symbol"><span class="hljs-symbol">rank:</span></span> ten, <span class="hljs-symbol"><span class="hljs-symbol">suit:</span></span> clubs from_hash = Values::PlayingCard.wrap <span class="hljs-symbol"><span class="hljs-symbol">rank:</span></span> <span class="hljs-string"><span class="hljs-string">'10'</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">suit:</span></span> <span class="hljs-symbol"><span class="hljs-symbol">:clubs</span></span> from_obj = Values::PlayingCard.wrap from_values from_str = Values::PlayingCard.wrap <span class="hljs-string"><span class="hljs-string">'10C'</span></span> <span class="hljs-comment"><span class="hljs-comment">#        utf ,  ,  .</span></span></code> </pre> <br><p>  Alle diese Karten sind einander gleich.  Wenn die <code>wrap</code> Methode zu einer guten Praxis wird, wird sie in eine separate Klasse eingeordnet.  Aus Sicht des dogmatischen Ansatzes wird auch eine separate Klasse obligatorisch sein. <br>  Hmm, was ist mit dem Platz im Deck?  Wie kann man herausfinden, ob diese Karte ein Trumpf ist?  Dies ist keine Spielkarte.  Dies ist der <em>Wert der</em> Spielkarte.  Dies ist genau die Inschrift 10, die Sie an der Ecke des Kartons f√ºhren. <br>  Es ist notwendig, sich sowohl auf den <em>Objektwert</em> als auch auf das Primitiv zu beziehen, das aus irgendeinem Grund nicht in Ruby implementiert wurde.  Von hier aus entsteht die letzte Eigenschaft - <em>Object-Value ist</em> an keine Domain gebunden. </p><br><h2 id="rekomendacii">  Empfehlungen </h2><br><blockquote>  Unter der Vielzahl von Methoden und Werkzeugen, die zu jedem Zeitpunkt eines jeden Prozesses verwendet werden, gibt es immer eine Methode und ein Werkzeug, die schneller und besser funktionieren als andere. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Frederick Taylor</a> 1914 </blockquote><br><h5 id="arifmeticheskie-operacii-dolzhny-vozvraschat-novyy-obekt">  Arithmetische Operationen m√ºssen ein neues Objekt zur√ºckgeben </h5><br><pre> <code class="ruby hljs"><span class="hljs-comment"><span class="hljs-comment"># GOOD class Money &lt; LunaPark::Values::Compound def +(other) other = self.class.wrap(other) raise ArgumentError unless same_currency? other self.class.new( amount: amount + other.amount, currency: currency ) end end</span></span></code> </pre> <br><h5 id="atributy-_obekta-znacheniya_-mogu-byt-tolko-primitivami-ili-drugimi-_obektami-znacheniya_">  Attribute <em>eines Wertobjekts</em> k√∂nnen nur Grundelemente oder andere <em>Wertobjekte sein</em> </h5><br><pre> <code class="ruby hljs"><span class="hljs-comment"><span class="hljs-comment"># GOOD class Weight &lt; LunaPark::Values::Compound def intialize(value:, unit:) </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@value</span></span></span><span class="hljs-comment"> = value </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@unit</span></span></span><span class="hljs-comment"> = Unit.wrap(unit) end end # BAD class PlaingCard &lt; LunaPark::Value def initialize(rank:, suit:, deck:) ... </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@deck</span></span></span><span class="hljs-comment"> = Entity::Deck.wrap(deck) #    end end</span></span></code> </pre> <br><h5 id="prostye-operacii-derzhite-vnutri-metodov-klassa">  Behalten Sie einfache Operationen in Klassenmethoden bei </h5><br><pre> <code class="ruby hljs"><span class="hljs-comment"><span class="hljs-comment"># GOOD class Weight &lt; LunaPark::Values::Compound def &gt;(other) value &gt; other.convert_to(unit).value end end</span></span></code> </pre> <br><h5 id="esli-operaciya-konvertaciya-bolshaya-to-vozmozhno-est-smysl-vynesti-ee-v-otdelnyy-klass">  Wenn die "Konvertierungs" -Operation gro√ü ist, ist es m√∂glicherweise sinnvoll, sie in eine separate Klasse zu verschieben </h5><br><pre> <code class="ruby hljs"><span class="hljs-comment"><span class="hljs-comment"># UGLY class Weight &lt; LunaPark::Values::Compound def convert_to(unit) unit = Unit.wrap(unit) case { self.unit.to_sym =&gt; unit.to_sym } when { :kg =&gt; :ft } Weight.new(value: 2.2046 * value, unit.to_sym) when # ... end end end # GOOD #./lib/values/weight/converter.rb class Weight class Converter &lt; LunaPark::Services::Simple def initialize(weight, to:) ... end end end #./lib/values/weight.rb class Weight &lt; LunaPark::Values::Compound def convert_to(unit) Converter.call! self, to: unit end end</span></span></code> </pre> <br><p>  Eine solche Entfernung der Logik in einen separaten <em>Dienst ist</em> <strong>nur</strong> unter der Bedingung m√∂glich, dass der <em>Dienst</em> isoliert ist: Er verwendet keine Daten aus externen Quellen.  Dieser Service sollte durch den Kontext des <em>Wertobjekts</em> selbst eingeschr√§nkt sein. </p><br><h5 id="obekt-znachenie-ne-mozhet-nichego-znat-o-domennoy-logike">  Der Objektwert kann nichts √ºber die Dom√§nenlogik wissen </h5><br><p>  Angenommen, wir schreiben einen Online-Shop und haben eine Warenbewertung.  Um es zu erhalten, m√ºssen Sie √ºber das <em>Repository</em> eine Anfrage an die Datenbank stellen. </p><br><pre> <code class="ruby hljs"><span class="hljs-comment"><span class="hljs-comment"># DEADLY BAD class Rate &lt; LunaPark::Values::Single def top?(10) Repository::Rates.top(first: 10).include? self end end</span></span></code> </pre> <br><h1 id="suschnost-entity">  Entit√§t </h1><br><p>  Die <em>Entity-</em> Klasse ist f√ºr ein reales Objekt verantwortlich.  Es kann ein Vertrag sein, ein Stuhl, ein Immobilienmakler, ein Kuchen, ein B√ºgeleisen, eine Katze, ein K√ºhlschrank - alles.  Jedes Objekt, das Sie m√∂glicherweise zur Modellierung Ihrer Gesch√§ftsprozesse ben√∂tigen, ist eine <em>Entit√§t</em> . <br>  Das Konzept der <em>Entit√§t ist</em> f√ºr Evans und f√ºr Martin unterschiedlich.  Aus der Sicht von Evans ist eine Entit√§t ein Objekt, das durch etwas gekennzeichnet ist, das seine Individualit√§t betont. </p><br><div class="spoiler">  <b class="spoiler_title">Essenz von Zvans</b> <div class="spoiler_text"><blockquote>  Wenn ein Objekt durch eine eindeutige individuelle Existenz und nicht durch eine Reihe von Attributen bestimmt wird, sollte diese Eigenschaft beim Definieren eines Objekts in einem Modell als Haupteigenschaft gelesen werden.  Die Definition der Klasse sollte einfach sein und auf der Kontinuit√§t und Einzigartigkeit des Zyklus der Existenz des Objekts beruhen.  Finden Sie einen Weg, um jedes Objekt unabh√§ngig von seiner Form oder Existenzgeschichte zu unterscheiden.  Achten Sie besonders auf die technischen Anforderungen, die mit dem Vergleichen von Objekten nach ihren Attributen verbunden sind.  Definieren Sie eine Operation, die notwendigerweise ein eindeutiges Ergebnis f√ºr jedes dieser Objekte liefert. M√∂glicherweise muss dazu ein bestimmtes Symbol mit einer garantierten Eindeutigkeit verkn√ºpft werden.  Ein solches Identifikationsmittel kann einen externen Ursprung haben, es kann jedoch auch eine willk√ºrliche Kennung sein, die vom System f√ºr seine eigene Bequemlichkeit erzeugt wird.  Ein solches Werkzeug muss jedoch den Regeln zur Unterscheidung zwischen Objekten im Modell entsprechen.  Das Modell sollte eine genaue Definition der identischen Objekte enthalten. </blockquote></div></div><br><p>  Aus Martins Sicht ist <em>Entity</em> kein Objekt, sondern eine Ebene.  Diese Ebene kombiniert sowohl das Objekt als auch die Gesch√§ftslogik zum √Ñndern. </p><br><div class="spoiler">  <b class="spoiler_title">Trostlosigkeit von Martin</b> <div class="spoiler_text"><blockquote>  Meiner Ansicht nach enthalten Entit√§ten anwendungsunabh√§ngige Gesch√§ftsregeln.  Sie sind nicht einfach Datenobjekte.  Sie k√∂nnen Verweise auf Datenobjekte enthalten.  Ihr Zweck ist es jedoch, Gesch√§ftsregelmethoden zu implementieren, die von vielen verschiedenen Anwendungen verwendet werden k√∂nnen. <br><br>  Gateways geben Entit√§ten zur√ºck.  Die Implementierung (unterhalb der Zeile) ruft die Daten aus der Datenbank ab und erstellt daraus Datenstrukturen, die dann an die Entit√§ten √ºbergeben werden.  Dies kann entweder mit Eind√§mmung oder Vererbung erfolgen. <br><br>  Zum Beispiel: <br><br>  √∂ffentliche Klasse MyEntity {private MyDataStructure-Daten;} <br><br>  oder <br><br>  √∂ffentliche Klasse MyEntity erweitert MyDataStructure {...} <br><br>  Und denken Sie daran, wir sind alle von Natur aus Piraten.  und die Regeln, √ºber die ich hier spreche, sind wirklich eher Richtlinien ... </blockquote></div></div><br><p>  Mit <em>Essenz</em> meinen wir nur Struktur.  In ihrer einfachsten Form sieht die <em>Entity-</em> Klasse folgenderma√üen aus: </p><br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Entities</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MeatBag</span></span></span><span class="hljs-class"> &lt; LunaPark::Entities::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Simple</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">attr_accessor</span></span></span><span class="hljs-class"> :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">id</span></span></span><span class="hljs-class">, :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">, :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">hegiht</span></span></span><span class="hljs-class">, :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">weight</span></span></span><span class="hljs-class">, :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">birthday</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span></span></code> </pre> <br><p>  Ein ver√§nderliches Objekt, das die Struktur eines Gesch√§ftsmodells beschreibt, kann primitive Typen und <em>Werte enthalten</em> . <br>  Die <code>LunaPark::Entites::Simple</code> Klasse ist unglaublich einfach, Sie k√∂nnen ihren Code sehen, sie gibt uns nur eines - einfache Initialisierung. </p><br><div class="spoiler">  <b class="spoiler_title">LunaPark :: Entites :: Simple</b> <div class="spoiler_text"><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">LunaPark</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Entities</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Simple</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">initialize</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">params</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">set_attributes</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">params</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">private</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">set_attributes</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">hash</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">hash</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">each</span></span></span><span class="hljs-class"> { |</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">k</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">v</span></span></span><span class="hljs-class">| </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">send</span></span></span><span class="hljs-class">(:"</span><span class="hljs-comment"><span class="hljs-class"><span class="hljs-comment">#{k}=", v) } end end end end</span></span></span></span></code> </pre> </div></div><br><p>  Sie k√∂nnen schreiben: </p><br><pre> <code class="ruby hljs">john_doe = Entity::MeatBag.new( <span class="hljs-symbol"><span class="hljs-symbol">id:</span></span> <span class="hljs-number"><span class="hljs-number">42</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">name:</span></span> <span class="hljs-string"><span class="hljs-string">'John Doe'</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">height:</span></span> <span class="hljs-string"><span class="hljs-string">'180cm'</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">weight:</span></span> <span class="hljs-string"><span class="hljs-string">'80kg'</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">birthday:</span></span> <span class="hljs-string"><span class="hljs-string">'01-01-1970'</span></span> )</code> </pre> <br><p>  Wie Sie wahrscheinlich bereits vermutet haben, m√∂chten wir Gewicht, Gr√∂√üe und Geburtsdatum in <em>Value Objects einbinden</em> . </p><br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Entities</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MeatBag</span></span></span><span class="hljs-class"> &lt; LunaPark::Entites::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Simple</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">attr_accessor</span></span></span><span class="hljs-class"> :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">id</span></span></span><span class="hljs-class">, :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">attr_reader</span></span></span><span class="hljs-class"> :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">heiht</span></span></span><span class="hljs-class">, :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wight</span></span></span><span class="hljs-class">, :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">birthday</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">height</span></span></span><span class="hljs-class">=(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">height</span></span></span><span class="hljs-class">) @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">height</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Values::Height</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wrap</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">height</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">weight</span></span></span><span class="hljs-class">=(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">height</span></span></span><span class="hljs-class">) @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">height</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Values::Weight</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wrap</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">weight</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">birthday</span></span></span><span class="hljs-class">=(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">day</span></span></span><span class="hljs-class">) @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">birthday</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Date</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">parse</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">day</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span></span></code> </pre> <br><p>  Um keine Zeit mit solchen Konstruktoren zu verschwenden, haben wir eine komplexere <em>Implementierung von</em> <a href=""><code>LunaPark::Entites::Nested</code></a> vorbereitet: </p><br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Entities</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MeatBag</span></span></span><span class="hljs-class"> &lt; LunaPark::Entities::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Nested</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">attr</span></span></span><span class="hljs-class"> :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">id</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">attr</span></span></span><span class="hljs-class"> :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">attr</span></span></span><span class="hljs-class"> :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">heiht</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Values::Height</span></span></span><span class="hljs-class">, :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wrap</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">attr</span></span></span><span class="hljs-class"> :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">weight</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Values::Weight</span></span></span><span class="hljs-class">, :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wrap</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">attr</span></span></span><span class="hljs-class"> :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">birthday</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Values::Date</span></span></span><span class="hljs-class">, :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">parse</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span></span></code> </pre> <br><p>  Wie der Name schon sagt, k√∂nnen Sie mit dieser <em>Implementierung</em> Baumstrukturen erstellen. </p><br><p>  Lassen Sie uns meine Leidenschaft f√ºr sperrige Haushaltsger√§te befriedigen.  In einem fr√ºheren Artikel haben wir eine Analogie zwischen der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">‚ÄûWendung‚Äú einer Waschmaschine und der Architektur gezogen</a> .  Und jetzt beschreiben wir ein so wichtiges Gesch√§ftsobjekt wie einen K√ºhlschrank: </p><br><p><img src="https://habrastorage.org/webt/xl/65/pj/xl65pjsr5ou5a4nurhdm9qxbo50.png" alt="Refregerator"></p><br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Refregerator</span></span></span><span class="hljs-class"> &lt; LunaPark::Entites::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Nested</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">attr</span></span></span><span class="hljs-class"> :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">id</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">attr</span></span></span><span class="hljs-class"> :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">brand</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">attr</span></span></span><span class="hljs-class"> :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">title</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">namespace</span></span></span><span class="hljs-class"> :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">fridge</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">do</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">namespace</span></span></span><span class="hljs-class"> :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">door</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">do</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">attr</span></span></span><span class="hljs-class"> :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">upper</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Shelf</span></span></span><span class="hljs-class">, :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wrap</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">attr</span></span></span><span class="hljs-class"> :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">lower</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Shelf</span></span></span><span class="hljs-class">, :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wrap</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">attr</span></span></span><span class="hljs-class"> :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">upper</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Shelf</span></span></span><span class="hljs-class">, :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wrap</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">attr</span></span></span><span class="hljs-class"> :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">lower</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Shelf</span></span></span><span class="hljs-class">, :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wrap</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">namespace</span></span></span><span class="hljs-class"> :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">main</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">do</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">namespace</span></span></span><span class="hljs-class"> :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">door</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">do</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">attr</span></span></span><span class="hljs-class"> :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Shelf</span></span></span><span class="hljs-class">, :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wrap</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">attr</span></span></span><span class="hljs-class"> :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Shelf</span></span></span><span class="hljs-class">, :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wrap</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">attr</span></span></span><span class="hljs-class"> :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">third</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Shelf</span></span></span><span class="hljs-class">, :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wrap</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">namespace</span></span></span><span class="hljs-class"> :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boxes</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">do</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">attr</span></span></span><span class="hljs-class"> :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">left</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Box</span></span></span><span class="hljs-class">, :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wrap</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">attr</span></span></span><span class="hljs-class"> :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">right</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Box</span></span></span><span class="hljs-class">, :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wrap</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">attr</span></span></span><span class="hljs-class"> :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Shelf</span></span></span><span class="hljs-class">, :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wrap</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">attr</span></span></span><span class="hljs-class"> :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Shelf</span></span></span><span class="hljs-class">, :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wrap</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">attr</span></span></span><span class="hljs-class"> :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">third</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Shelf</span></span></span><span class="hljs-class">, :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wrap</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">attr</span></span></span><span class="hljs-class"> :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">fourth</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Shelf</span></span></span><span class="hljs-class">, :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wrap</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">attr</span></span></span><span class="hljs-class"> :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">last_open_at</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">comparable</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span></span></code> </pre> <br><p>  Dieser Ansatz erspart uns die Erstellung unn√∂tiger <em>Entit√§ten</em> wie der T√ºr zum K√ºhlschrank.  Ohne K√ºhlschrank sollte es Teil des K√ºhlschranks sein.  Dieser Ansatz eignet sich zum Zusammenstellen relativ gro√üer Dokumente, beispielsweise eines Antrags auf Abschluss einer Versicherung. </p><br><p>  Die <code>LunaPark::Entites::Nested</code> Klasse hat zwei weitere wichtige Eigenschaften: </p><br><p>  Vergleichbarkeit: </p><br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Entites</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">User</span></span></span><span class="hljs-class"> &lt; LunaPark::Entites::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Nested</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">attr</span></span></span><span class="hljs-class"> :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">email</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">attr</span></span></span><span class="hljs-class"> :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">registred_at</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">u1</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Entites::User</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">new</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">email</span></span></span><span class="hljs-class">: '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">john</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">doe</span></span></span><span class="hljs-class">@</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">mail</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">com</span></span></span><span class="hljs-class">', </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">registred_at</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Time</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">now</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">u2</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Entites::User</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">new</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">email</span></span></span><span class="hljs-class">: '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">john</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">doe</span></span></span><span class="hljs-class">@</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">mail</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">com</span></span></span><span class="hljs-class">', </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">registred_at</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Time</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">now</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">u1</span></span></span><span class="hljs-class"> == </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">u2</span></span></span><span class="hljs-class"> </span><span class="hljs-comment"><span class="hljs-class"><span class="hljs-comment"># =&gt; false</span></span></span></span></code> </pre> <br><p>  Die beiden angegebenen Benutzer sind nicht gleichwertig, weil  Sie wurden zu unterschiedlichen Zeiten erstellt und daher ist der Wert des Attributs <code>registred_at</code> unterschiedlich.  Aber wenn wir das Attribut aus der Liste der verglichenen streichen: </p><br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Entites</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">User</span></span></span><span class="hljs-class"> &lt; LunaPark::Entites::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Nested</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">attr</span></span></span><span class="hljs-class"> :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">email</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">attr</span></span></span><span class="hljs-class"> :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">registred_at</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">comparable</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span></span></code> </pre> <br><p>  dann bekommen wir zwei vergleichbare Objekte. </p><br><p>  Diese <em>Implementierung</em> hat auch die Eigenschaft des Umsatzes - wir k√∂nnen die Klassenmethode verwenden </p><br><pre> <code class="ruby hljs">Entites::User.wrap(<span class="hljs-symbol"><span class="hljs-symbol">email:</span></span> <span class="hljs-string"><span class="hljs-string">'john.doe@mail.com'</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">registred_at:</span></span> Time.now)</code> </pre> <br><p>  Sie k√∂nnen Hash, OpenStruct oder ein beliebiges Juwel als <em>Entit√§t verwenden</em> , um die Struktur Ihrer Entit√§t zu erkennen. </p><br><p>  <em>Eine Entit√§t</em> ist ein Modell eines Gesch√§ftsobjekts. Lassen Sie es einfach.  Wenn eine Immobilie von Ihrem Unternehmen nicht genutzt wird, beschreiben Sie sie nicht. </p><br><h1 id="izmeneniya-suschnosti">  Entit√§ts√§nderungen </h1><br><p>  Wie Sie bemerkt haben, verf√ºgt die <em>Entity-</em> Klasse √ºber keine eigenen √Ñnderungsmethoden.  Alle √Ñnderungen werden von au√üen vorgenommen.  <em>Das Wertobjekt ist</em> ebenfalls unver√§nderlich.  Alle Funktionen, die im Gro√üen und Ganzen darin vorhanden sind, schm√ºcken die Essenz oder schaffen neue Objekte.  Die Essenz selbst bleibt unver√§ndert.  F√ºr einen Ruby on Rails-Entwickler ist dieser Ansatz ungew√∂hnlich.  Von au√üen mag es so aussehen, als w√ºrden wir die OOP-Sprache im Allgemeinen f√ºr etwas anderes verwenden.  Aber wenn Sie etwas tiefer schauen, ist das nicht so.  Kann sich ein Fenster von selbst √∂ffnen?  Ein Auto zur Arbeit bringen, ein Hotel buchen, eine s√º√üe Katze einen neuen Abonnenten bekommen?  Dies sind alles √§u√üere Einfl√ºsse.  In der realen Welt passiert etwas, und wir reflektieren dies in uns.  F√ºr jede Anfrage nehmen wir √Ñnderungen an unserem Modell vor.  Und damit halten wir es auf dem neuesten Stand, ausreichend f√ºr unsere Gesch√§ftsaufgaben.  Es ist notwendig, den Status des Modells und die Prozesse zu trennen, die √Ñnderungen in diesem Status verursachen.  Wie das geht, erfahren Sie im n√§chsten Artikel. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de435920/">https://habr.com/ru/post/de435920/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de435908/index.html">Asketisches Netz: Prototyp-Flohm√§rkte f√ºr unterwegs und js</a></li>
<li><a href="../de435910/index.html">Warum hat BSD den Kampf mit GNU / Linux verloren?</a></li>
<li><a href="../de435912/index.html">Die Hauptprobleme bei der Entwicklung moderner Schnittstellen</a></li>
<li><a href="../de435914/index.html">Packen von ASP.NET Core-Anwendungen mit Docker</a></li>
<li><a href="../de435916/index.html">Wenn Sie VK hacken, wird die Zwei-Faktor-Authentifizierung nicht gespeichert</a></li>
<li><a href="../de435922/index.html">Java, Spring, Kurento und Mediendienste. Teil 2</a></li>
<li><a href="../de435924/index.html">Das neuronale Netzwerk erzeugt Bilder von Gerichten nach Rezepten f√ºr ihre Zubereitung</a></li>
<li><a href="../de435926/index.html">Das neuronale Netz sammelt Fragmente arch√§ologischer Funde</a></li>
<li><a href="../de435928/index.html">K√ºhlschrank statt Bruce Willis: Die Erde trifft zuerst</a></li>
<li><a href="../de435930/index.html">Der Ursprung der Thermoakustik. Die singende Flamme von Higgins. Rijke Rohr</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>