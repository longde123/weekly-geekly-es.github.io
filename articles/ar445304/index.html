<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🍵 ⛩️ 👊🏻 برمجة قاعدة LibreOffice. الجزء 2 ⚽️ 🍤 🎠</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="الجزء 2 سوف يناقش العلاقة بين جداول قاعدة البيانات والنماذج. على وجه الخصوص ، كيفية تحديد العلاقة بين جدولين واستخدام "الجداول المرجعية" كمصدر بيانات ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>برمجة قاعدة LibreOffice. الجزء 2</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/445304/" style=";text-align:right;direction:rtl"> الجزء 2 سوف يناقش العلاقة بين جداول قاعدة البيانات والنماذج.  على وجه الخصوص ، كيفية تحديد العلاقة بين جدولين واستخدام "الجداول المرجعية" كمصدر بيانات للقوائم المنسدلة. <br><a name="habracut"></a><br>  إصدارات OpenOffice و LibreOffice التي تتعلق بها هذه الرسالة من 3.0 إلى 6.2 (الإصدار الحالي من LibreOffice).  بدءًا من الإصدار 3.0 ، يتمتع OpenOffice Base بالقدرة على حفظ البرامج النصية في ملف قاعدة بيانات (بملحق .odb) ، مما يجعل من المناسب توزيع رمز ماكرو OO Basic <br><br>  كان هناك بعض الالتباس مع النماذج الموجودة في OpenOffice Base.  والحقيقة هي أنه في عملية تطوير البرمجيات من مجموعة المكتب إلى بيئة قاعدة البيانات ، اتضح أن النماذج والنماذج والنماذج والنماذج ليست هي نفس الشيء.  والاستمارة ليست فقط النموذج.  سأشرح بمزيد من التفصيل. <br><br>  عندما تفتح قاعدة بيانات OpenOffice Base في وضع التحرير ، ترى أربع إشارات مرجعية على الجانب الأيسر من الشاشة.  في النسخة الروسية ، سوف يبدو مثل <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  الجداول </li><li style=";text-align:right;direction:rtl">  طلبات </li><li style=";text-align:right;direction:rtl">  شكل </li><li style=";text-align:right;direction:rtl">  تقارير </li></ul><br>  في هذا المعنى ، النموذج هو تطبيق منفصل يعمل في نافذة منفصلة.  وألاحظ أيضًا أنه في الحقيقة هذه هي النافذة التي يتم فيها تشغيل مثيل OpenOffice Writer. <br><br>  <i>المذكرة.</i>  <i>نظرًا لأن النموذج هو بالفعل مثيل لـ OpenOffice Writer - يمكنك إنشاء تطبيق دون تحميل مكون OpenOffice Base - مباشرة في OpenOffice Writer.</i> <br><br>  يحتوي كل نموذج على مجموعة من نماذج الكائنات.  في البداية ، هذه المجموعة فارغة.  على الرغم من ذلك ، يمكنك فتح وإغلاق النموذج.  وحتى عرض المعلومات النصية فيه.  وفقط عندما تضيف عنصر تحكم جديد (على سبيل المثال ، زر) ، سيقوم النظام بإنشاء كائن نموذج بالاسم الافتراضي نموذج ، إذا لم تقم بإنشاء مثل هذا الكائن بنفسك بحلول ذلك الوقت. <br><br>  من الأنسب إنشاء نماذج جديدة من Form Navigator (يتم عرضها على اللوحة كوصلة بوصلة) ، والتي يمكن استدعاؤها أيضًا من القائمة View | Toolbar | Form Navigation.  يتم إنشاء كائنات النموذج إما في المستوى العلوي في مجموعة النماذج أو تابعة لكائن نموذج آخر.  هذا لا يؤثر على مظهر النموذج ، لكنه قد يكون مفيدًا عند تحديد العلاقات بين الجداول. <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">قطة</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/ceb/e4b/db1/cebe4bdb1f339866597f8c0ba95736fb.png" alt="صورة"><br></div></div><br><br>  هنا يجب أن نلاحظ شذوذ واحد من كائن النموذج.  هذا الكائن هو في المقام الأول كائن مرتبط بجدول قاعدة بيانات أو باستعلام SQL.  يمكنك التفكير في النموذج ككائن ResultSet (كما هو حقًا).  النموذج ، من ناحية أخرى ، عبارة عن حاوية لعناصر التحكم ، مثل النموذج في مستند HTML (وهذا صحيح أيضًا). <br><br>  افتح النموذج المنشأ حديثًا في وضع التحرير (زر الماوس الأيمن | تحرير).  قم بإنشاء كائن نموذج جديد فيه باسم النموذج ، أو اسم آخر تريده.  في عنصر النموذج هذا ، قم بإنشاء عنصر نموذج فرعي. <br><br>  يجب أن يرتبط كل نموذج بجدول قاعدة بيانات أو استعلام أو استعلام SQL موجود.  في نموذج الرقيق ، يمكنك ضبط القواعد بحيث يتم عرض البيانات التي تمت تصفيتها حسب قيمة الحقول ذات الصلة في النموذج الرئيسي على شكل سيد / عبد.  للقيام بذلك ، في محرر خاصية النموذج الفرعي ، قم بملء حقول الرابط الرئيسية وخصائص حقول الرقيق. <br><br>  الآن سنضيف عنصر تحكم جدول إلى كل نموذج من النماذج عن طريق تحديد النموذج المناسب في "نموذج المستكشف"&gt;.  عنصر التحكم في الجدول ليس في لوحة العناصر المتاحة.  لعرض قائمة موسعة من العناصر ، تحتاج إلى تنشيط الزر "مزيد من عناصر التحكم" في لوحة العناصر.  بعد إضافة عنصر التحكم في الجدول ، من الضروري إدخال وضع التحرير لهذا العنصر وإضافة الأعمدة المطلوبة لعرض الجدول (زر الفأرة الأيمن -&gt; إدراج / استبدال / حذف العمود) <br><br>  النوع الثاني هو النوع الذي يتم مواجهته بشكل متكرر في الممارسة العملية للعلاقة بين الجداول (بعد Master / Slave) ، والتي سنأخذها في الاعتبار - علاقة من النوع Directory.  نقوم بتخزين مفتاح كائن GUID ، autoincrement ، في جدول البيانات ، وفي الجدول المعروض ، نعرض اسمه الكامل ، مأخوذ من الجدول المرجعي المرتبط.  هناك آلية مريحة لهذا الغرض.  في "مصمم الجدول المرئي" ، أضف عمودًا من النوع "مربع قائمة".  إذا كان قد تم بالفعل إنشاء عمود من النوع الرقمي / النص ، حيث يتم عرض المفتاح (وليس الاسم) ، فمن الممكن تغيير نوعه إلى مربع قائمة (انقر بزر الماوس الأيمن | استبدال بـ | مربع القائمة).  بعد ذلك ، قم بتحرير قائمة خصائص العمود.  في علامة التبويب "البيانات" ، قم بتعيين خاصية "نوع قائمة المحتوى" إلى SQL.  يجب أن يحتوي الاستعلام في خاصية Content List على القيمة المعروضة في العمود الأول ، وستكون خاصية Bound Field هي فهرس العمود بحقل المفتاح (على افتراض أن العمود الأول به فهرس 0).  وهذا هو ، في الغالبية العظمى من الاستعلامات سيكون هذا 1 للاستعلامات من النوع <br><br><pre style=";text-align:right;direction:rtl"><code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> USERNAME, USERID <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> <span class="hljs-keyword"><span class="hljs-keyword">USERS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> USERNAME</code> </pre> <br>  حتى الآن ، تم وصف العمل في وضع مكون دون برمجة.  إضافة وظيفة مع وحدات الماكرو OO الأساسية. <br><br>  قم بإنشاء عامل تصفية لجدول قاعدة البيانات حسب القيمة التي تم إدخالها في مربع النص.  للقيام بذلك ، نكتب بلغة OO Basic إجراءً يعالج حدثًا من لوحة المفاتيح. <br><br><pre style=";text-align:right;direction:rtl"> <code class="vbscript hljs"> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> TextBox_onKeyUp(oEvent) oDocument = ThisComponent oDocument.LockControllers sText = oEvent.Source.text <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Len</span></span>(sText) &gt; <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> oForm = ThisComponent.Drawpage.Forms.getByName(<span class="hljs-string"><span class="hljs-string">"MyForm"</span></span>) oForm.<span class="hljs-built_in"><span class="hljs-built_in">Filter</span></span> = <span class="hljs-string"><span class="hljs-string">"USERNAME LIKE '"</span></span> + sText + <span class="hljs-string"><span class="hljs-string">"%'"</span></span> oForm.reload() <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> oDocument.UnlockControllers <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span></code> </pre><br>  نحن نربط هذا الإجراء بالحدث الذي تم إصداره من المفتاح لحقل النص (في علامة تبويب الأحداث في قائمة خصائص العنصر).  لاحظ أن حقل النص هذا يجب أن يكون موجودًا في نموذج آخر (وليس في النموذج الذي يتم تثبيت المرشح عليه) ، حتى لا يؤدي إعادة تحميل oForm.reload () إلى "إلغاء" قيمته الحالية التي تم إدخالها من لوحة المفاتيح. <br><br>  أن تستمر. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar445304/">https://habr.com/ru/post/ar445304/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar445292/index.html">ما لم أخبر به عن CSS</a></li>
<li><a href="../ar445294/index.html">ومرة أخرى عن الشاشة الثانية من الكمبيوتر اللوحي ...</a></li>
<li><a href="../ar445298/index.html">أسبوع الأمان 13: افتح كلمات المرور على Facebook</a></li>
<li><a href="../ar445300/index.html">أخبار صناعة الألعاب (11-25 مارس 2019)</a></li>
<li><a href="../ar445302/index.html">"لعبة العروش ، والمضي قدما." ما أظهرته Apple اليوم في حدث Show Time</a></li>
<li><a href="../ar445308/index.html">ميزات اختبار الفرضيات للتطبيقات المحمولة</a></li>
<li><a href="../ar445310/index.html">ارتفع سعر الرونيت السيادي إلى 30 مليار ين</a></li>
<li><a href="../ar445312/index.html">تخصيص ذاكرة JVM</a></li>
<li><a href="../ar445314/index.html">لماذا التعدين الكويكبات صعبة؟</a></li>
<li><a href="../ar445316/index.html">DevDay إدارة تكنولوجيا المعلومات. تسجيل الأداء</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>