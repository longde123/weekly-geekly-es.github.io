<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üöè üíáüèª üöÆ Prueba de carga con langosta üìù üëéüèø üö≥</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Las pruebas de carga no son tan demandadas y est√°n tan extendidas como otros tipos de pruebas: no hay tantas herramientas que le permitan realizar dic...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Prueba de carga con langosta</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/infopulse/blog/430502/">  Las pruebas de carga no son tan demandadas y est√°n tan extendidas como otros tipos de pruebas: no hay tantas herramientas que le permitan realizar dichas pruebas, pero generalmente se puede contar con los dedos de una mano simple y conveniente. <br><br>  Cuando se trata de pruebas de rendimiento, en primer lugar, todos piensan en JMeter, sin duda sigue siendo la herramienta m√°s famosa con la mayor cantidad de complementos.  Nunca me gust√≥ JMeter debido a su interfaz no obvia y su alto umbral de entrada, tan pronto como sea necesario probar una aplicaci√≥n que no sea Hello World. <br><br>  Y ahora, inspirado por el √©xito de las pruebas en dos proyectos diferentes, decid√≠ compartir informaci√≥n sobre un software relativamente simple y conveniente: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Locust</a> <br><br>  Para aquellos que son demasiado flojos para pasar por debajo del corte, grab√© un video: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/ZYKIyyY1qvY" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><a name="habracut"></a><br><h2>  Que es esto </h2><br>  Herramienta de c√≥digo abierto que le permite especificar escenarios de carga con c√≥digo Python que admite carga distribuida y, como afirman los autores, se utiliz√≥ para las pruebas de estr√©s de Battlelog para la serie de juegos Battlefild (inmediatamente cautivador) <br><br>  De los profesionales: <br><br><ul><li>  documentaci√≥n simple que incluye ejemplo de copiar y pegar.  Puede comenzar a realizar pruebas, incluso con casi ninguna habilidad de programaci√≥n. </li><li>  "Under the hood" utiliza la biblioteca de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">solicitudes</a> (HTTP para personas).  Su documentaci√≥n se puede utilizar como una hoja de trucos extendida y pruebas de d√©bito </li><li>  Soporte de Python: me gusta el idioma </li><li>  El p√°rrafo anterior ofrece multiplataforma para ejecutar pruebas </li><li>  Propio servidor web <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Flask</a> para mostrar los resultados de la prueba </li></ul><br>  De las desventajas: <br><br><ul><li>  Sin captura y reproducci√≥n: todas las manos </li><li>  El resultado del p√°rrafo anterior: necesitas un cerebro.  Al igual que con Postman, debe comprender c√≥mo funciona HTTP. </li><li>  Habilidades m√≠nimas de programaci√≥n necesarias </li><li>  Modelo de carga lineal, que inmediatamente molesta a los fan√°ticos para generar usuarios "seg√∫n Gauss" </li></ul><br><h2>  Proceso de prueba </h2><br>  Cualquier prueba es una tarea compleja que requiere planificaci√≥n, preparaci√≥n, monitoreo de implementaci√≥n y an√°lisis de resultados.  Durante la prueba de esfuerzo, si es posible, es posible y necesario recopilar todos los datos posibles que pueden afectar el resultado: <br><br><ul><li>  Hardware del servidor (CPU, RAM, ROM) </li><li>  Software del servidor (SO, versi√≥n del servidor, JAVA, .NET, etc., la base de datos y la cantidad de datos en s√≠, el servidor y los registros de la aplicaci√≥n de prueba) </li><li>  Ancho de banda de red </li><li>  La presencia de servidores proxy, equilibradores de carga y protecci√≥n DDOS </li><li>  Datos de prueba de carga (n√∫mero de usuarios, tiempo de respuesta promedio, n√∫mero de solicitudes por segundo) </li></ul><br>  Los ejemplos descritos a continuaci√≥n se pueden clasificar como pruebas de carga funcional de caja negra.  Incluso sin saber nada sobre la aplicaci√≥n bajo prueba y sin acceso a los registros, podemos medir su rendimiento. <br><br><h2>  Antes de empezar </h2><br>  Para probar las pruebas de carga en la pr√°ctica, implement√© un servidor web localmente simple <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">https://github.com/typicode/json-server</a> .  Dar√© casi todos los siguientes ejemplos para √©l.  Tom√© los datos para el servidor de un ejemplo en l√≠nea implementado: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">https://jsonplaceholder.typicode.com/</a> <br>  Para ejecutarlo, se requiere nodeJS. <br><br>  <b>Spoiler obvio</b> : al igual que con las pruebas de seguridad, es mejor realizar experimentos con pruebas de estr√©s en gatos localmente, sin cargar los servicios en l√≠nea para que no est√© prohibido <br><br>  Para comenzar, tambi√©n se requiere Python: en todos los ejemplos utilizar√© la versi√≥n 3.6, as√≠ como la propia langosta (al momento de escribir, versi√≥n 0.9.0).  Se puede instalar con el comando <br><br><pre><code class="bash hljs">python -m pip install locustio</code> </pre> <br>  Los detalles de instalaci√≥n se pueden encontrar en la documentaci√≥n oficial. <br><br><h2>  Analizando un ejemplo </h2><br>  Luego necesitamos un archivo de prueba.  Tom√© un ejemplo de la documentaci√≥n, ya que es muy simple y directo: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> locust <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> HttpLocust, TaskSet <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">login</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(l)</span></span></span><span class="hljs-function">:</span></span> l.client.post(<span class="hljs-string"><span class="hljs-string">"/login"</span></span>, {<span class="hljs-string"><span class="hljs-string">"username"</span></span>:<span class="hljs-string"><span class="hljs-string">"ellen_key"</span></span>, <span class="hljs-string"><span class="hljs-string">"password"</span></span>:<span class="hljs-string"><span class="hljs-string">"education"</span></span>}) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">logout</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(l)</span></span></span><span class="hljs-function">:</span></span> l.client.post(<span class="hljs-string"><span class="hljs-string">"/logout"</span></span>, {<span class="hljs-string"><span class="hljs-string">"username"</span></span>:<span class="hljs-string"><span class="hljs-string">"ellen_key"</span></span>, <span class="hljs-string"><span class="hljs-string">"password"</span></span>:<span class="hljs-string"><span class="hljs-string">"education"</span></span>}) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">index</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(l)</span></span></span><span class="hljs-function">:</span></span> l.client.get(<span class="hljs-string"><span class="hljs-string">"/"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">profile</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(l)</span></span></span><span class="hljs-function">:</span></span> l.client.get(<span class="hljs-string"><span class="hljs-string">"/profile"</span></span>) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UserBehavior</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(TaskSet)</span></span></span><span class="hljs-class">:</span></span> tasks = {index: <span class="hljs-number"><span class="hljs-number">2</span></span>, profile: <span class="hljs-number"><span class="hljs-number">1</span></span>} <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">on_start</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> login(self) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">on_stop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> logout(self) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">WebsiteUser</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(HttpLocust)</span></span></span><span class="hljs-class">:</span></span> task_set = UserBehavior min_wait = <span class="hljs-number"><span class="hljs-number">5000</span></span> max_wait = <span class="hljs-number"><span class="hljs-number">9000</span></span></code> </pre> <br>  Eso es todo!  ¬°Esto es realmente suficiente para comenzar la prueba!  Veamos un ejemplo antes de comenzar. <br><br>  Saltando importaciones, al principio vemos 2 funciones de inicio y cierre de sesi√≥n casi id√©nticas, que consisten en una l√≠nea.  <b>l.client</b> : un objeto de sesi√≥n HTTP con el que crearemos una carga.  Utilizamos el m√©todo POST, que es casi id√©ntico al de la biblioteca de solicitudes.  Casi, porque en este ejemplo estamos pasando como primer argumento no una URL completa, sino solo una parte de ella, un servicio espec√≠fico. <br><br>  El segundo argumento pasa los datos, y no puedo evitar notar que es muy conveniente usar los diccionarios de Python, que se convierten autom√°ticamente a json <br><br>  Tambi√©n puede tener en cuenta que no procesamos el resultado de la solicitud de ninguna manera; si tiene √©xito, los resultados (por ejemplo, cookies) se guardar√°n en esta sesi√≥n.  Si se produce un error, se registrar√° y se agregar√° a las estad√≠sticas sobre la carga. <br><br>  Si queremos saber si hemos escrito la solicitud correctamente, siempre podemos verificarla de la siguiente manera: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> requests <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> r response=r.post(base_url+<span class="hljs-string"><span class="hljs-string">"/login"</span></span>,{<span class="hljs-string"><span class="hljs-string">"username"</span></span>:<span class="hljs-string"><span class="hljs-string">"ellen_key"</span></span>,<span class="hljs-string"><span class="hljs-string">"password"</span></span>:<span class="hljs-string"><span class="hljs-string">"education"</span></span>}) print(response.status_code)</code> </pre> <br>  <b>Agregu√©</b> solo la variable <b>base_url</b> , que deber√≠a contener la direcci√≥n completa del recurso que se est√° probando. <br><br>  Las siguientes funciones son consultas, que crear√°n una carga.  Nuevamente, no necesitamos procesar la respuesta del servidor; los resultados ir√°n inmediatamente a las estad√≠sticas. <br><br>  Lo siguiente es la clase <b>UserBehavior</b> (el nombre de la clase puede ser cualquiera).  Como su nombre lo indica, describir√° el comportamiento de un usuario esf√©rico en el vac√≠o de la aplicaci√≥n bajo prueba.  Pasamos a la propiedad de <b>tareas</b> un diccionario de m√©todos que el usuario llamar√° y su frecuencia de llamadas.  Ahora, a pesar de que no sabemos qu√© funci√≥n y en qu√© orden llamar√° cada usuario, se seleccionan al azar, garantizamos que la funci√≥n de <b>√≠ndice</b> se llamar√° en promedio 2 veces m√°s a menudo que la funci√≥n de <b>perfil</b> . <br><br>  Adem√°s del comportamiento, la clase principal TaskSet le permite especificar 4 funciones que se pueden realizar antes y despu√©s de las pruebas.  El orden de las llamadas ser√° el siguiente: <br><br><ol><li>  <b>setup</b> - se llama 1 vez al inicio de <b>UserBehavior (TaskSet)</b> - no est√° en el ejemplo </li><li>  <b>on_start</b> : llamado 1 vez por cada nuevo usuario de la carga al inicio </li><li>  <b>tareas</b> : ejecuci√≥n de las tareas mismas </li><li>  <b>on_stop</b> : llamado una vez por cada usuario cuando la prueba termina de funcionar </li><li>  <b>desmontaje</b> - se llama 1 vez cuando se <b>cierra</b> el <b>TaskSet</b> - tampoco est√° en el ejemplo </li></ol><br>  Vale la pena mencionar aqu√≠ que hay 2 formas de declarar el comportamiento del usuario: la primera ya est√° indicada en el ejemplo anterior: las funciones se anuncian por adelantado.  La segunda forma es declarar m√©todos directamente dentro de la clase <b>UserBehavior</b> : <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> locust <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> HttpLocust, TaskSet, task <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UserBehavior</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(TaskSet)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">on_start</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.client.post(<span class="hljs-string"><span class="hljs-string">"/login"</span></span>, {<span class="hljs-string"><span class="hljs-string">"username"</span></span>:<span class="hljs-string"><span class="hljs-string">"ellen_key"</span></span>, <span class="hljs-string"><span class="hljs-string">"password"</span></span>:<span class="hljs-string"><span class="hljs-string">"education"</span></span>}) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">on_stop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.client.post(<span class="hljs-string"><span class="hljs-string">"/logout"</span></span>, {<span class="hljs-string"><span class="hljs-string">"username"</span></span>:<span class="hljs-string"><span class="hljs-string">"ellen_key"</span></span>, <span class="hljs-string"><span class="hljs-string">"password"</span></span>:<span class="hljs-string"><span class="hljs-string">"education"</span></span>}) @task(<span class="hljs-number"><span class="hljs-number">2</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">index</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.client.get(<span class="hljs-string"><span class="hljs-string">"/"</span></span>) @task(<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">profile</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.client.get(<span class="hljs-string"><span class="hljs-string">"/profile"</span></span>) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">WebsiteUser</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(HttpLocust)</span></span></span><span class="hljs-class">:</span></span> task_set = UserBehavior min_wait = <span class="hljs-number"><span class="hljs-number">5000</span></span> max_wait = <span class="hljs-number"><span class="hljs-number">9000</span></span></code> </pre> <br>  En este ejemplo, las funciones del usuario y la frecuencia de su llamada se configuran mediante la anotaci√≥n de la <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" class="user_link">tarea</a></b> .  Funcionalmente, nada ha cambiado. <br><br>  La √∫ltima clase del ejemplo es <b>WebsiteUser</b> (el nombre de la clase puede ser cualquiera).  En esta clase, definimos el modelo de comportamiento del usuario <b>UserBehavior</b> *** +, as√≠ como los tiempos de espera m√≠nimo y m√°ximo entre llamadas a tareas individuales por parte de cada usuario.  Para que quede m√°s claro, aqu√≠ est√° c√≥mo visualizarlo: <br><br><img src="https://habrastorage.org/webt/mv/ss/7j/mvss7jfvob_tufawwbx-41w6i8y.png"><br><br><h2>  Empezando </h2><br>  Ejecute el servidor, cuyo rendimiento probaremos: <br><br><pre> <code class="bash hljs">json-server --watch sample_server/db.json</code> </pre> <br>  Tambi√©n modificamos el archivo de ejemplo para que pueda probar el servicio, eliminar el inicio y cierre de sesi√≥n, establecer el comportamiento del usuario: <br><br><ol><li>  Abra la p√°gina principal 1 vez al comienzo del trabajo. </li><li>  Obtenga una lista de todas las publicaciones x2 </li><li>  Escribe un comentario en la primera publicaci√≥n x1 </li></ol><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> locust <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> HttpLocust, TaskSet, task <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UserBehavior</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(TaskSet)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">on_start</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.client.get(<span class="hljs-string"><span class="hljs-string">"/"</span></span>) @task(<span class="hljs-number"><span class="hljs-number">2</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">posts</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.client.get(<span class="hljs-string"><span class="hljs-string">"/posts"</span></span>) @task(<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">comment</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> data = { <span class="hljs-string"><span class="hljs-string">"postId"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"my comment"</span></span>, <span class="hljs-string"><span class="hljs-string">"email"</span></span>: <span class="hljs-string"><span class="hljs-string">"test@user.habr"</span></span>, <span class="hljs-string"><span class="hljs-string">"body"</span></span>: <span class="hljs-string"><span class="hljs-string">"Author is cool. Some text. Hello world!"</span></span> } self.client.post(<span class="hljs-string"><span class="hljs-string">"/comments"</span></span>, data) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">WebsiteUser</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(HttpLocust)</span></span></span><span class="hljs-class">:</span></span> task_set = UserBehavior min_wait = <span class="hljs-number"><span class="hljs-number">1000</span></span> max_wait = <span class="hljs-number"><span class="hljs-number">2000</span></span></code> </pre><br>  Para comenzar en el s√≠mbolo del sistema, ejecute el comando <br><br><pre> <code class="bash hljs">locust -f my_locust_file.py --host=http://localhost:3000</code> </pre> <br>  donde host es la direcci√≥n del recurso probado.  A √©l se agregar√°n las direcciones de los servicios indicados en la prueba. <br><br>  Si no hay errores en la prueba, el servidor de carga se iniciar√° y estar√° disponible en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">http: // localhost: 8089 /</a> <br><br><img src="https://habrastorage.org/webt/p9/km/lc/p9kmlc3hqgi3_gupjrvkhduhl2a.png"><br><br>  Como puede ver, el servidor que vamos a probar se indica aqu√≠: es a esta URL donde se agregar√°n las direcciones de los servicios del archivo de prueba. <br><br>  Tambi√©n aqu√≠ podemos indicar el n√∫mero de usuarios para la carga y su crecimiento por segundo. <br>  En el bot√≥n, comenzamos la carga! <br><br><img src="https://habrastorage.org/webt/di/d8/xt/did8xtea9mlpfzzxwlfq1lcofne.png"><br><br><h2>  Resultados </h2><br>  Despu√©s de cierto tiempo, detenemos la prueba y echamos un vistazo a los primeros resultados: <br><br><ol><li>  Como se esperaba, cada uno de los 10 usuarios creados al principio fue a la p√°gina principal </li><li>  La lista de publicaciones en promedio se abri√≥ 2 veces m√°s de lo que se escribi√≥ un comentario </li><li>  Hay un tiempo de respuesta promedio y medio para cada operaci√≥n, el n√∫mero de operaciones por segundo ya son datos √∫tiles, aunque ahora los tome y compare con el resultado esperado de los requisitos. </li></ol><br>  En la segunda pesta√±a, puede ver los gr√°ficos de carga en tiempo real.  Si el servidor se bloquea con una carga determinada o su comportamiento cambia, esto ser√° visible inmediatamente en el gr√°fico. <br><br><img src="https://habrastorage.org/webt/qm/ym/pd/qmympdj2picpcms6mkdb7eonenu.png"><br><br>  En la tercera pesta√±a, puede ver los errores; en mi caso, este es un error del cliente.  Pero si el servidor devuelve un error 4XX o 5XX, su texto se escribir√° aqu√≠ <br>  Si se produce un error en el c√≥digo de su texto, caer√° en la pesta√±a Excepciones.  Hasta ahora, tengo el error m√°s com√∫n relacionado con el uso del comando print () en el c√≥digo; esta no es la mejor manera de iniciar sesi√≥n :) <br><br>  En la √∫ltima pesta√±a, puede descargar todos los resultados de la prueba en formato csv <br><br>  ¬øSon relevantes estos resultados?  Vamos a resolverlo.  La mayor√≠a de las veces, los requisitos de rendimiento (si los hay) suenan as√≠: el tiempo promedio de carga de la p√°gina (respuesta del servidor) debe ser inferior a N segundos con una carga de M usuarios.  Realmente no especifica qu√© deben hacer los usuarios.  Y me gusta la langosta por esto: crea actividad de un n√∫mero espec√≠fico de usuarios que realizan aleatoriamente las acciones esperadas que esperan de los usuarios. <br><br>  Si necesitamos llevar a cabo un punto de referencia, para medir el comportamiento del sistema con diferentes cargas, podemos crear varias clases de comportamiento y realizar varias pruebas con diferentes cargas. <br><br>  Eso es suficiente para empezar.  Si te gust√≥ el art√≠culo, planeo escribir sobre: <br><br><ul><li>  escenarios de prueba complejos en los que los resultados de un paso se utilizan en los siguientes </li><li>  procesamiento de respuesta del servidor, como  puede estar equivocado incluso si HTTP 200 OK ha llegado </li><li>  dificultades obvias que pueden encontrarse y c√≥mo sortearlas </li><li>  prueba sin usar la interfaz de usuario </li><li>  prueba de carga distribuida </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es430502/">https://habr.com/ru/post/es430502/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es430492/index.html">Intel Neural Compute Stick. Mente artificial en una unidad flash USB - 2</a></li>
<li><a href="../es430494/index.html">InfoWatch Traffic Monitor. Al borde de errores y caracter√≠sticas</a></li>
<li><a href="../es430496/index.html">NB-IoT: ¬øc√≥mo funciona? Parte 1</a></li>
<li><a href="../es430498/index.html">Omitir el Control de cuentas de usuario (UAC) imitando directorios confiables</a></li>
<li><a href="../es430500/index.html">Evitar el caos de la base de conocimiento corporativo: nuestra experiencia de confluencia</a></li>
<li><a href="../es430504/index.html">M√©todos de pensamiento junior y racional.</a></li>
<li><a href="../es430506/index.html">Dark art of resurrection: c√≥mo recuperar datos de medios da√±ados</a></li>
<li><a href="../es430508/index.html">DevOps: ¬øqu√© es realmente?</a></li>
<li><a href="../es430510/index.html">¬øC√≥mo escribir c√≥digo que todos entiendan?</a></li>
<li><a href="../es430512/index.html">C√≥mo viven los freelancers: no trabaje con clientes que lo saben todo y perm√≠tase postergar</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>