<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘©â€ğŸ’» â™¦ï¸ ğŸ§’ğŸ½ Suite Ã  la rencontre Â«Nouvelles fonctionnalitÃ©s de PostgreSQL 11Â» (Partie 2) ğŸŒ¾ ğŸ˜ ğŸ’¿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dans la premiÃ¨re partie, nous avons parlÃ© des principales innovations et modifications de PostgreSQL 11. Cette fois, nous allons discuter plus en dÃ©ta...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Suite Ã  la rencontre Â«Nouvelles fonctionnalitÃ©s de PostgreSQL 11Â» (Partie 2)</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/raiffeisenbank/blog/416187/">  Dans la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">premiÃ¨re partie,</a> nous avons parlÃ© des principales innovations et modifications de PostgreSQL 11. Cette fois, nous allons discuter plus en dÃ©tail de certains points du format question / rÃ©ponse qui ont Ã©tÃ© soulevÃ©s par meetup. <br><a name="habracut"></a><br><h4>  Quelle est la meilleure faÃ§on de transfÃ©rer un grand tableau de donnÃ©es sous la forme d'un ensemble de paramÃ¨tres d'entrÃ©e pour une procÃ©dure stockÃ©e dans PL / pgSQL? </h4><br>  Le moyen le plus pratique consiste Ã  crÃ©er une table temporaire, Ã  y faire des copies des donnÃ©es, puis Ã  les utiliser dans la procÃ©dure. <br><br><h4>  Moteurs externes (zheap) et dÃ©veloppement de PostgreSQL en mÃ©moire </h4><br>  Pas pour toutes les charges de travail, un modÃ¨le avec le stockage des anciennes versions d'enregistrements dans la table elle-mÃªme convient.  Dans tous les autres sous-fichiers (versionionniki), ils sont stockÃ©s dans un journal d'annulation.  Vous pouvez discuter de la faisabilitÃ©, mais l'essentiel est que vous devez stocker les anciens enregistrements quelque part.  S'ils ont une courte durÃ©e de vie et que quelqu'un s'adresse rarement Ã  eux, le stockage dans la table elle-mÃªme est dangereux.  Le moteur zheap externe PostgreSQL est une tentative d'EnterpriseDB de crÃ©er un moteur de table pour PostgreSQL avec un journal d'annulation.  Cela fonctionne, bien qu'il y ait encore quelque chose Ã  amÃ©liorer. <br><br>  Qui travaille avec Mme  SQL en mode SNAPSHOT Isolation Level, sait qu'il a tempdb, oÃ¹ il met les anciennes versions, et est Ã©quipÃ© d'un aspirateur complÃ¨tement vide pour nettoyer tempdb.  En revanche, la communautÃ© demande de crÃ©er des tables en mÃ©moire dans PostgreSQL.  Cela peut Ãªtre fait assez facilement: tmpfs, et c'est tout.  Dans PostgreSQL Pro, mÃªme sorti la premiÃ¨re version pilote, vous pouvez essayer. <br><br>  PostgreSQL n'a jamais eu de moteurs de plug-in.  Il y avait des index enfichables qui utilisaient un WAL commun.  PostgreSQL a beaucoup Ã  brancher et peu Ã  remplacer Ã  la volÃ©e.  Par exemple, l'exÃ©cuteur n'est pas dÃ©sactivÃ©, mais vous pouvez dÃ©jÃ  y utiliser des nÅ“uds personnalisÃ©s que vous programmez vous-mÃªme.  Les optimiseurs de PostgreSQL sont complÃ¨tement enfichables.  Vous pouvez Ã©crire le vÃ´tre et utiliser PostgreSQL comme interprÃ¨te de vos requÃªtes.  L'analyseur SQL ne peut pas Ãªtre connectÃ©. <br><br>  Les moteurs veulent se connecter dans trois directions: <br><br><ul><li> moteur avec journal d'annulation </li><li>  en mÃ©moire </li><li>  stockage de colonnes pour les requÃªtes OLAP </li></ul><br>  Postgres Pro est en pourparlers avec EnterpriseDB sur la faÃ§on de crÃ©er une API pour connecter tout cela. <br><br><h4>  Ã€ propos de la clÃ© Ã©trangÃ¨re </h4><br>  La clÃ© Ã©trangÃ¨re Ã  l'intÃ©rieur de PostgreSQL est implÃ©mentÃ©e par des dÃ©clencheurs.  Vous pouvez Ã©crire votre dÃ©clencheur qui implÃ©mentera tout type de fonctionnalitÃ©.  Toutes les restrictions possibles doivent Ãªtre effectuÃ©es dans le dÃ©clencheur.  La logique dans les dÃ©clencheurs n'est pas particuliÃ¨rement nÃ©cessaire Ã  conserver, mais vÃ©rifiez tout - c'est nÃ©cessaire. <br><br><h4>  Postgres Pro prÃ©voit-il de faire du SaaS ou du PaaS? </h4><br>  Postgres Pro prÃ©voit de rendre PostgreSQL plus optimisÃ© pour le cloud, en particulier pour implÃ©menter des modifications dynamiques des tampons de partage, afin de rÃ©duire le nombre de paramÃ¨tres qui nÃ©cessitent un redÃ©marrage de PostgreSQL.  Ils ne vont pas construire le cloud eux-mÃªmes. <br><br><h4>  Comment configurer un lecteur pour que l'indexation parallÃ¨le fonctionne plus rapidement?  Quel est le meilleur, plusieurs disques durs ou un SSD? </h4><br>  Mieux vaut quelques SSD.  Plus le matÃ©riel offre d'options de parallÃ©lisation, mieux c'est.  Si vous avez un disque, pas assez de mÃ©moire et un processeur, la parallÃ©lisation ne vous aidera pas.  Mais les SSD ont une particularitÃ©: ils commencent Ã  ralentir si plus de 80% du volume est occupÃ©.  Par consÃ©quent, n'oubliez pas de rÃ©gler le trim, sinon la limite de 80% se situera autour de 50%. <br><br><h4>  Gestion du dictionnaire et ajout de mots dans la recherche en texte intÃ©gral </h4><br>  Si vous utilisez un sort ou une boule de neige, changez simplement le dictionnaire des mots vides.  Le problÃ¨me est que si vous avez ajoutÃ© un mot d'arrÃªt, il n'y a aucun intÃ©rÃªt Ã  l'indexation.  Cela peut se faire lentement.  Un mot d'arrÃªt sera rejetÃ© d'une demande et ne sera jamais recherchÃ©.  Et si vous avez supprimÃ© le mot d'arrÃªt, alors nulle part dans la collection, il n'est pas lÃ  et vous devez le rÃ©indexer.  Le problÃ¨me n'est pas dans le dictionnaire, mais dans le fait que vous l'avez dÃ©jÃ  utilisÃ© et enregistrÃ© vos connaissances. <br><br>  De plus, dans de nombreux cas, vous pouvez utiliser la fonction peu connue ts_rewrite, qui vous permet de remplacer une partie de la demande par une autre demande.  Par exemple, lorsque le sous-marin de Koursk s'est noyÃ©, tout le monde s'est prÃ©cipitÃ© pour chercher des informations Ã  ce sujet.  Fedor Sigaev travaillait alors Ã  la randonnÃ©e et Ã  la demande de "Koursk", des informations sur la ville ont Ã©tÃ© diffusÃ©es.  Ils ont rapidement fait une substitution: sur ce mot, donnez des informations sur le sous-marin.  Mais alors les utilisateurs ont commencÃ© Ã  maudire, qui s'intÃ©ressaient au village lui-mÃªme.  Je ne sais pas sâ€™ils ont rÃ©alisÃ© ou non, mais il a fallu introduire la Â«ville de KourskÂ».  De telles substitutions permettent d'effectuer ts_rewrite.  En outre, la fonction peut Ãªtre utilisÃ©e pour une transition en douceur pendant la pÃ©riode de modifications du dictionnaire. <br><br>  Bien sÃ»r, changer l'analyseur et les dictionnaires sont des tÃ¢ches complexes.  Les langues avec diffÃ©rents alphabets, comme le russe et l'anglais, s'entendent bien.  Aujourd'hui, les textes franÃ§ais-anglais sont bien pires.  Il n'est pas clair Ã  quelle langue un mot fait rÃ©fÃ©rence, qui est Ã©crit de la mÃªme maniÃ¨re, mais dans une langue, c'est un mot d'arrÃªt, et dans une autre il ne l'est pas.  Postgres Pro travaille actuellement sur des dictionnaires de rÃ©glage fin pour dÃ©crire des configurations plus complexes. <br><br><h4>  Couverture des indices et mise Ã  jour Ã  chaud </h4><br>  Câ€™est complÃ¨tement amis.  Vrai, si au moins un champ est mis Ã  jour dans l'index de couverture, alors l'index se comportera comme d'habitude, tout sera remplacÃ©. <br><br><h4>  ImpossibilitÃ© de crÃ©er des tables temporaires lors de l'exÃ©cution de requÃªtes en veille </h4><br>  PostgreSQL ne stocke pas les connaissances des tables dans le rÃ©pertoire systÃ¨me, mais il existe un correctif qui transfÃ¨re les connaissances dans le rÃ©pertoire systÃ¨me.  Par consÃ©quent, avec ce correctif, vous pouvez utiliser des tables temporaires.  Mais alors un autre problÃ¨me se pose: il n'y a pas de transactions en attente.  Pour travailler avec une table temporaire, vous devrez utiliser deux fois l'ID de transaction virtuelle, qui s'applique uniquement aux tables temporaires, et non aux principales qui proviennent de l'assistant.  Et lorsque vous regardez un nombre 32 bits, ce seront deux nombres diffÃ©rents. <br><br>  Postgres Pro dispose Ã©galement d'un module pg_variables, qui fonctionne Ã©galement en mode veille.  Ce n'est pas une table temporaire, mais les fonctionnalitÃ©s nÃ©cessaires peuvent Ãªtre reprÃ©sentÃ©es. <br><br><h4>  ImplÃ©menter l'index de cluster </h4><br>  Postgres Pro a eu plusieurs tentatives pour l'implÃ©menter.  Vous pouvez maintenant entrer l'index de la table de cluster et la table sera dans le mÃªme ordre.  A souffert de la faÃ§on de maintenir une table dans un Ã©tat en cluster.  Nous avons essayÃ© diffÃ©rentes approches, mais invariablement l'insertion dans une telle table Ã©tait trÃ¨s coÃ»teuse.  Et ce n'est intÃ©ressant pour personne.  Par consÃ©quent, jusqu'Ã  prÃ©sent, il a Ã©tÃ© conclu qu'il Ã©tait nÃ©cessaire de passer aux tables organisÃ©es d'index. <br><br><h4>  Facteur d'Ã©chelle Ã  vide automatique recommandÃ© </h4><br>  Recommande gÃ©nÃ©ralement de rÃ©gler 1 Ã  5%.  Mais c'est complÃ¨tement facultatif.  Pour les petites tables, dans lesquelles, malgrÃ© les changements, en moyenne, la mÃªme distribution reste, une grande valeur peut Ãªtre dÃ©finie.  Si le tableau est grand et rarement rÃ©approvisionnÃ©, mais Ã  juste titre, avec un fort changement de distribution, vous devrez inventer autre chose.  Tout dÃ©pend de la distribution de vos donnÃ©es. <br><br><h4>  Conseils dans les requÃªtes complexes </h4><br>  Dans Oracle, avec des requÃªtes complexes, vous devez pÃ©riodiquement aider avec des conseils, car des analyses complÃ¨tes soudaines se produisent.  Il y a des indices dans Postgres Pro, assez moroses, mais vous pouvez les obtenir.  Cependant, il n'y a aucune indication dans PostgreSQL standard, et il est peu probable qu'ils apparaissent.  Si vous avez des indices intÃ©grÃ©s, les utilisateurs, confrontÃ©s Ã  un problÃ¨me d'optimiseur, insÃ¨rent des indices, se calment et ne signalent aucun problÃ¨me.  Le dÃ©veloppement de l'optimiseur s'arrÃªte. <br><br>  Soit dit en passant, l'optimiseur PostgreSQL a un problÃ¨me.  Lorsqu'il estime un Ã©chantillon Ã  partir d'un tableau, mÃªme pour un montant plus ou moins raisonnable, il devine avec une certaine erreur.  Ensuite, il commence Ã  se connecter, le rÃ©sultat est connectÃ© Ã  autre chose, l'erreur s'accumule et au troisiÃ¨me ou au quatriÃ¨me niveau, PostgreSQL manque beaucoup. <br><br>  Il existe un tel paramÃ¨tre - limite d'effondrement des jointures.  PostgreSQL trie les JOIN pour une utilisation plus efficace, mais la limite de tri par dÃ©faut est 8. S'il y a plus de 8 JOIN dans une rangÃ©e, le systÃ¨me ne les triera pas et il y aura une dÃ©pendance Ã  l'ordre JOIN dans la requÃªte. <br><br>  Il existe Ã©galement un optimiseur gÃ©nÃ©tique avec diffÃ©rents paramÃ¨tres.  Vous pouvez activer divers paramÃ¨tres dans une session et dÃ©crire plus ou moins comment la demande doit Ãªtre exÃ©cutÃ©e.  En utilisant cet ordre, Ã  l'aide de crochets, vous pouvez dÃ©finir l'arrÃªt de certaines opÃ©rations, le mÃªme balayage sec.  Une autre option consiste Ã  insÃ©rer certains paramÃ¨tres dans les fonctions.  Dans un sens, ce sont aussi des indices.  Pas trÃ¨s pratique, mais au moins quelque chose. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr416187/">https://habr.com/ru/post/fr416187/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr416175/index.html">RÃ©sultats du concours des jeunes dÃ©veloppeurs d'applications AR Epson Moverio BT-300</a></li>
<li><a href="../fr416177/index.html">Formule de Tupper et implÃ©mentation de l'algorithme en Python</a></li>
<li><a href="../fr416179/index.html">Une porte qui nous accueille par son nom et ne s'ouvre qu'aux employÃ©s du dÃ©partement</a></li>
<li><a href="../fr416181/index.html">Modulation d'amplitude sur les doigts</a></li>
<li><a href="../fr416183/index.html">Test des donnÃ©es: exigences et niveaux</a></li>
<li><a href="../fr416189/index.html">Le traitement de Scrum "mÃ©canique". Partie 3. Travail SM</a></li>
<li><a href="../fr416191/index.html">ImplÃ©mentation de bas niveau de l'arborescence des prÃ©fixes trie en PHP</a></li>
<li><a href="../fr416193/index.html">Comment les robots peuvent travailler ensemble avec les humains (et non Ã  la place)</a></li>
<li><a href="../fr416195/index.html">Dijkstra pour le temps linÃ©aire</a></li>
<li><a href="../fr416197/index.html">Les moteurs du nouveau programme DARPA rÃ©ussissent les tests</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>