<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üï¥Ô∏è üë®‚Äçüë©‚Äçüë¶‚Äçüë¶ ‚ÄºÔ∏è Lanzar Predator - Repositorios de datos precompilados ‚òÑÔ∏è ‚úèÔ∏è üë®üèº‚ÄçüöÄ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hoy, el equipo de Micronaut en Object Computing Inc (OCI) present√≥ Predator , un nuevo proyecto de c√≥digo abierto cuyo objetivo es mejorar significati...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Lanzar Predator - Repositorios de datos precompilados</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/460839/"><p><img src="https://habrastorage.org/webt/zy/lo/n1/zylon1nrzso3rt7yshzjaia3krg.jpeg"></p><br><p>  Hoy, el equipo de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Micronaut</a> en Object Computing Inc (OCI) present√≥ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Predator</a> , un nuevo proyecto de c√≥digo abierto cuyo objetivo es mejorar significativamente el tiempo de ejecuci√≥n y el rendimiento (desde la memoria) del acceso a datos para microservicios y aplicaciones sin servidor, sin perder productividad en comparaci√≥n con herramientas como GORM y Spring Data. </p><a name="habracut"></a><br><h2 id="istoriya-instrumentov-dostupa-k-dannym">  Historial de herramientas de acceso a datos </h2><br><p>  Podemos rastrear el historial de la plantilla de repositorio de datos desde 2004, cuando Ruby on Rails lanz√≥ el subsistema ActiveRecord, una API que revolucion√≥ nuestra comprensi√≥n del acceso a los datos en t√©rminos de productividad del desarrollador. </p><br><p>  En 2007, el equipo de Grails introdujo por primera vez una API similar a ActiveRecord para JVM - GORM (parte de Grails).  GORM se bas√≥ en la naturaleza din√°mica de Groovy para implementar m√©todos de b√∫squeda adem√°s de Hibernate y proporcion√≥ los mismos beneficios de productividad a los usuarios de JVM. </p><br><p> Dado que GORM depende del lenguaje Groovy, en 2011 se cre√≥ un proyecto Spring Data que permiti√≥ a los desarrolladores de Java definir m√©todos de b√∫squeda, como <code>findByTitle</code> , en la interfaz e implementar autom√°ticamente la l√≥gica de consulta en tiempo de ejecuci√≥n. </p><br><h2 id="kak-rabotayut-instrumenty-dostupa-k-dannym">  C√≥mo funcionan las herramientas de acceso a datos </h2><br><p>  Todas las implementaciones mencionadas usan la misma plantilla, que es construir un metamodelo de entidades de proyecto en tiempo de ejecuci√≥n que modela las relaciones entre sus clases de entidad.  En Spring Data es un MappingContext, y en GORM tambi√©n se llama MappingContext.  Se construyen escaneando clases usando la reflexi√≥n.  (La similitud en los nombres no es accidental aqu√≠. En 2010, trabaj√© con el equipo de Spring Data para intentar recrear GORM para Java, en un proyecto que finalmente se convirti√≥ en lo que hoy se llama Spring Data) </p><br><p>  Este metamodelo se usa para transformar una expresi√≥n de b√∫squeda, como <code>bookRepository.findByTitle("The Stand")</code> , en un modelo de consulta abstracta en tiempo de ejecuci√≥n utilizando una combinaci√≥n de an√°lisis de expresiones regulares y l√≥gica de marco.  Necesitamos un modelo de consulta abstracta porque el dialecto objetivo de la consulta es diferente para cada base de datos (SQL, JPA-QL, Cypher, Bson, etc.) </p><br><h2 id="podderzhka-repozitoriev-v-micronaut">  Soporte de repositorio de Micronaut </h2><br><p>  Desde el lanzamiento de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Micronaut hace</a> poco m√°s de un a√±o, la principal caracter√≠stica que nos faltaba era "GORM para Java" o soporte de Spring Data.  Muchos desarrolladores est√°n enamorados de la productividad que proporcionan estas herramientas, as√≠ como de la facilidad de definir las interfaces que implementa el marco.  Dir√≠a que la mayor parte del √©xito de Grails y Spring Boot se puede atribuir a GORM y Spring Data respectivamente. </p><br><p>  Para los usuarios de Micronaut que usaban Groovy, ten√≠amos soporte GORM desde el primer d√≠a, y los usuarios de Java y Kotlin no ten√≠an nada, porque necesitaban implementar repositorios por su cuenta. </p><br><p>  Ser√≠a t√©cnicamente posible, y francamente m√°s f√°cil, simplemente agregar un m√≥dulo para Micronaut que configurar√≠a Spring Data.  Sin embargo, siguiendo este camino, proporcionar√≠amos un subsistema implementado utilizando todos los m√©todos que Micronaut intent√≥ evitar: uso generalizado de proxies, reflexi√≥n y alto consumo de memoria. </p><br><h2 id="predstavlyaem-predator">  ¬°Presentamos Predator! </h2><br><p>  Predator, abreviatura de repositorios de datos precalculados, utiliza la API de Micronaut para compilar antes de la ejecuci√≥n (AoT, por adelantado) para transferir un <code>findByTitle</code> de entidades y convertir expresiones de b√∫squeda (como <code>findByTitle</code> ) al SQL o JPA-QL apropiado en su compilador .  Como resultado, la consulta ejecuta una capa de tiempo de ejecuci√≥n del programa muy delgada sin reflejo, y solo le queda ejecutar la consulta y devolver los resultados. </p><br><p>  El resultado es abrumador ... el arranque en fr√≠o se reduce significativamente, obtenemos un consumo de memoria sorprendentemente bajo y una mejora notable en el rendimiento. </p><br><p>  Hoy abrimos el c√≥digo fuente de Predator bajo la licencia Apache 2, vendr√° con dos implementaciones iniciales (m√°s caracter√≠sticas planificadas para el futuro) para JPA (basado en Hibernate) y para SQL con JDBC. </p><br><p>  La implementaci√≥n de JDBC me agrada m√°s, ya que es completamente independiente de la reflexi√≥n, no utiliza proxies y carga de clase din√°mica para su nivel de acceso a datos, lo que conduce a un mejor rendimiento.  La capa de tiempo de ejecuci√≥n es tan ligera que incluso el c√≥digo de repositorio equivalente escrito a mano no se ejecutar√° m√°s r√°pido. </p><br><h2 id="proizvoditelnost-predator">  Depredador de rendimiento </h2><br><p>  Dado que Predator no necesita ejecutar ninguna transformaci√≥n de consulta en tiempo de ejecuci√≥n, la ganancia de rendimiento es significativa.  En el mundo de la utilizaci√≥n de la computaci√≥n en la nube, donde paga la cantidad de tiempo que se ejecuta su aplicaci√≥n o la ejecuci√≥n de una sola funci√≥n, los desarrolladores a menudo pierden de vista el rendimiento de sus mecanismos de acceso a datos. </p><br><p>  La siguiente tabla resume las diferencias de rendimiento que se pueden esperar para una expresi√≥n de b√∫squeda simple, como <code>findByTitle</code> , en comparaci√≥n con otras implementaciones.  Todas las pruebas se realizaron utilizando un banco de pruebas en el Xeon iMac Pro de 8 n√∫cleos en las mismas condiciones, las pruebas est√°n abiertas y se pueden encontrar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">en el repositorio</a> : </p><br><div class="scrollable-table"><table><thead><tr><th>  Implementaci√≥n </th><th>  Operaciones por segundo </th></tr></thead><tbody><tr><td>  Depredador JDBC </td><td>  225K operaciones / seg. </td></tr><tr><td>  Depredador jpa </td><td>  130K operaciones / seg. </td></tr><tr><td>  Spring data jpa </td><td>  90K operaciones / seg. </td></tr><tr><td>  GORM JPA </td><td>  50K operaciones / seg. </td></tr><tr><td>  Spring Data JDBC </td><td>  Buscadores no admitidos </td></tr></tbody></table></div><br><p>  S√≠, lo le√≠ste bien.  Con Predator JDBC, puede esperar un aumento de rendimiento de casi 4X sobre GORM y 2.5X sobre Spring Data. </p><br><p>  E incluso si usa Predator JPA, puede contar con m√°s de 2 veces las mejoras de rendimiento en comparaci√≥n con GORM y hasta un 40% de aumento en comparaci√≥n con Spring Data JPA. </p><br><p>  Observe la diferencia en el tama√±o de la pila de ejecuci√≥n cuando usa Predator en comparaci√≥n con las alternativas: </p><br><p>  <strong>Depredador</strong> </p><br><p><img src="https://habrastorage.org/webt/6_/5l/ns/6_5lnsvtlyng0zisy5updpoii30.png"></p><br><p>  <strong>Predator JPA:</strong> </p><br><p><img src="https://habrastorage.org/webt/dw/us/bc/dwusbcyeubxeu8l-glmhgq0r7me.png"></p><br><p>  <strong>Datos de primavera:</strong> </p><br><p><img src="https://habrastorage.org/webt/di/m2/uv/dim2uvimrgxvs4ksszq0gsxujkq.png"></p><br><p>  <strong>GORM:</strong> </p><br><p><img src="https://habrastorage.org/webt/ad/7z/rs/ad7zrsyjfc1-fpr-cm3vqp9cmle.png"></p><br><p>  Predator JDBC usa solo 15 cuadros hasta el momento en que se ejecuta su solicitud, mientras que Predator JPA usa 30 (principalmente debido a Hibernate), en comparaci√≥n con m√°s de 50 cuadros de pila en Spring Data o GORM.  Y todo gracias a los mecanismos Micronaut AOP que no utilizan la reflexi√≥n. </p><br><p>  Las razas de pila m√°s cortas tambi√©n simplifican la depuraci√≥n de la aplicaci√≥n.  Una de las ventajas de hacer la mayor parte del trabajo durante la compilaci√≥n es que se pueden detectar errores antes de que se inicie la aplicaci√≥n, lo que mejora en gran medida la experiencia del desarrollador.  Recibimos errores de compilaci√≥n inmediatamente en lugar de errores de tiempo de ejecuci√≥n para los errores m√°s comunes. </p><br><h2 id="proverki-vremeni-kompilyacii">  Comprobaciones de tiempo de compilaci√≥n </h2><br><p>  La mayor√≠a de las implementaciones de la plantilla de repositorio se basan √∫nicamente en la realizaci√≥n de todas las operaciones en tiempo de ejecuci√≥n.  Esto significa que si el desarrollador comete un error al definir la interfaz del repositorio, los errores no ser√°n visibles hasta que la aplicaci√≥n se inicie realmente. </p><br><p>  Esto nos roba algunos de los beneficios de Java para la verificaci√≥n de tipos y tenemos poca experiencia en datos.  Este no es el caso con Predator.  Considere el siguiente ejemplo: </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@JdbcRepository</span></span>(dialect = Dialect.H2) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BookRepository</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CrudRepository</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Book</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Long</span></span></span><span class="hljs-class">&gt; </span></span>{ <span class="hljs-function"><span class="hljs-function">Book </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">findByTile</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String t)</span></span></span></span>; }</code> </pre> <br><p>  Aqu√≠ <code>BookRepository</code> una solicitud a un objeto llamado <code>Book</code> , que tiene una propiedad de <code>title</code> .  Desafortunadamente, hay un error en esta declaraci√≥n: <code>findByTile</code> m√©todo <code>findByTile</code> lugar de <code>findByTitle</code> .  En lugar de ejecutar este c√≥digo, Predator no permitir√° que su c√≥digo se compile con un mensaje de error informativo: </p><br><pre> <code class="plaintext hljs">Error:(9, 10) java: Unable to implement Repository method: BookRepository.findByTile(String title). Cannot use [Equals] criterion on non-existent property path: tile</code> </pre> <br><p>  Muchos aspectos de Predator se verifican en tiempo de compilaci√≥n, cuando es posible, para garantizar que un error de tiempo de ejecuci√≥n no sea causado por una declaraci√≥n de repositorio incorrecta. </p><br><h2 id="predator-jdbc-i-graalvm-substrate">  Predator JDBC y GraalVM Substrate </h2><br><p>  Otra raz√≥n por la que Predator deber√≠a estar contento es que es compatible con las im√°genes nativas de sustrato GraalVM y no requiere conversiones complejas de c√≥digo de bytes durante la compilaci√≥n, a diferencia de las de Hibernate en GraalVM. </p><br><p>  Al eliminar por completo la reflexi√≥n y los proxys din√°micos de la capa de acceso a datos, Predator simplifica enormemente la creaci√≥n de aplicaciones que funcionan con datos que se ejecutan en GraalVM. </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">La aplicaci√≥n de ejemplo Predator JDBC se</a> ejecuta en Substrate sin problemas y le permite crear una imagen nativa mucho m√°s peque√±a (¬°25 MB menos!) De lo que Hibernate necesita para funcionar, gracias a una capa de tiempo de ejecuci√≥n mucho m√°s delgada. </p><br><p>  Vimos el mismo resultado cuando implementamos la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">compilaci√≥n de reglas de Validaci√≥n de Bean</a> para Micronaut 1.2.  El tama√±o de la imagen nativa disminuy√≥ en 10 MB, tan pronto como eliminamos la dependencia del Validador de Hibernate, y el tama√±o JAR en 2 MB. </p><br><p>  La ventaja aqu√≠ es obvia: al hacer m√°s trabajo durante la compilaci√≥n y crear tiempos de ejecuci√≥n m√°s compactos, obtienes una imagen nativa m√°s peque√±a y un archivo JAR, lo que conduce a microservicios m√°s peque√±os y f√°ciles de implementar cuando se implementa a trav√©s de Docker.  El futuro de los frameworks Java son compiladores m√°s potentes y tiempos de ejecuci√≥n m√°s peque√±os y ligeros. </p><br><h2 id="predator-i-buduschee">  Depredador y el futuro </h2><br><p>  Reci√©n estamos empezando a trabajar con Predator y estamos extremadamente satisfechos con las oportunidades que se abren. </p><br><p>  Inicialmente, comenzamos con soporte para JPA y SQL, pero en el futuro puede esperar soporte para MongoDB, Neo4J, Reactive SQL y otras bases de datos.  Afortunadamente, este trabajo es mucho m√°s simple porque la mayor√≠a de Predator se basa realmente en el c√≥digo fuente GORM, y podemos reutilizar la l√≥gica GORM para Neo4J y la l√≥gica GORM para MongoDB para lanzar estas implementaciones m√°s r√°pido de lo que espera. </p><br><p>  Predator es la culminaci√≥n de combinar los diversos bloques de construcci√≥n en Micronaut Core que hicieron posible implementarlo, desde las API de AoT, que tambi√©n se utilizan para generar documentaci√≥n Swagger, hasta el soporte relativamente nuevo de Bean Introspection, que le permite analizar objetos en tiempo de ejecuci√≥n sin reflexi√≥n. </p><br><p>  Micronaut proporciona bloques de construcci√≥n para cosas incre√≠bles.  Predator es una de esas cosas, y estamos empezando a trabajar en algunas de las caracter√≠sticas prometedoras de Micronaut 1.0. </p><br><p>  ACTUALIZACI√ìN: Despu√©s del anuncio impactante, el asesino de Spring Data pas√≥ a llamarse Micronaut Data: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">https://micronaut-projects.github.io/micronaut-data/1.0.x/guide/</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/460839/">https://habr.com/ru/post/460839/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../460825/index.html">Introducci√≥n a la API de captura de pantalla: escanee c√≥digos QR en un navegador</a></li>
<li><a href="../460827/index.html">Problema PGP</a></li>
<li><a href="../460831/index.html">Los peligros de los dise√±adores.</a></li>
<li><a href="../460833/index.html">F√≠sica y econom√≠a. Diferencia gnoseol√≥gica y su manifestaci√≥n en TI</a></li>
<li><a href="../460837/index.html">Manual de podcast para principiantes</a></li>
<li><a href="../460841/index.html">TOP-23 aplicaciones de aprendizaje de idiomas</a></li>
<li><a href="../460843/index.html">Presentamos el nuevo 3CX Call Flow Designer y el generador de plantillas 3CX CRM</a></li>
<li><a href="../460845/index.html">Fernando Corbato, el padre de su computadora (y contrase√±a), muri√≥ a los 93 a√±os</a></li>
<li><a href="../460847/index.html">12,3 millones de WebSockets concurrentes</a></li>
<li><a href="../460849/index.html">Parte 4. Un modelo gr√°fico para calcular funciones l√≥gicas para procesos paralelos asincr√≥nicos</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>