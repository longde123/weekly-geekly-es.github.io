<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>う   驴Qu茅 se puede hacer a trav茅s del conector OBD en el autom贸vil?   </title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="No es ning煤n secreto que en los autom贸viles modernos todos los sistemas de los globos oculares est谩n obstruidos con varios dispositivos electr贸nicos, ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>驴Qu茅 se puede hacer a trav茅s del conector OBD en el autom贸vil?</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/448658/"> No es ning煤n secreto que en los autom贸viles modernos todos los sistemas de los globos oculares est谩n obstruidos con varios dispositivos electr贸nicos, incluso un simple regulador de ventana tiene su propio microcontrolador y una direcci贸n en la red compartida.  Como propietario interesado, me preguntaba qu茅 se puede hacer con solo acceder al conector OBD y nada m谩s. <br><a name="habracut"></a><br>  <i>Todo lo descrito en el art铆culo se refiere al autom贸vil de 2008 (Mitsubishi Lancer), pero como lo ha demostrado la pr谩ctica, despu茅s de 10 a帽os, el fabricante no ha cambiado nada y todas las funciones se siguen utilizando y funcionan en autom贸viles modernos.</i> <br><br>  La estructura de red en el autom贸vil se muestra en la imagen: <br><br><img src="https://habrastorage.org/webt/hf/6h/vj/hf6hvjpyobul4yj9vrkugy1jlao.png" alt="imagen"><br><br>  El autom贸vil tiene 3 buses CAN (bus de motor de alta velocidad de 500 kbps, cabina de baja velocidad de 83.3 kbps, diagn贸stico) y un bus LIN.  El enlace de conexi贸n entre ellos es el bloque ETACS (Sistema electr贸nico de control total del autom贸vil), que act煤a como una "puerta de enlace" y env铆a mensajes de un autob煤s a otro, de acuerdo con ciertas reglas, y tambi茅n procesa algunos de ellos.  驴Qu茅 se puede hacer con el bus CAN?  Por ejemplo, chatear con bloques, o tal vez cambiar algo.  Para iniciar un di谩logo con cualquier bloque, debe conocer su direcci贸n, as铆 como las funciones compatibles (PID), que puede procesar y dar una respuesta. <br><br>  En el dominio p煤blico se encuentra el software para concesionarios llamado MUT III.  Despu茅s de estudiar la base de datos de ella, puede encontrar toda la informaci贸n que nos interesa. <br><br>  Acerca de las direcciones (solicitud-respuesta) en la red CAN: <br><br><img src="https://habrastorage.org/webt/qb/sw/m4/qbswm4lnyqnvdrtm1cbtu9bynac.jpeg" alt="imagen"><br><br>  PID de solicitudes, descifrado completo de respuestas de todos los bloques, incluida la posici贸n de los bytes en la respuesta (si se env铆an varios valores en un marco) y factores con unidades: <br><br><img src="https://habrastorage.org/webt/6t/ed/_z/6ted_zg_aechaxuzspylu-eossc.jpeg" alt="imagen"><br><br>  Por ejemplo, queremos saber el 谩ngulo de direcci贸n.  Para hacer esto, env铆e el comando 2102 a la unidad de control ESP. En respuesta, llegar谩 el mensaje 6102 FFEA000008FFF302 <br><br>  Mirando la tabla, descubrimos que se necesitan los bytes 2 y 3. <br><br><img src="https://habrastorage.org/webt/zk/it/ma/zkitmagzo2sqagf1zwgxp55ldfy.jpeg" alt="imagen"><br><br>  El valor en int16.  0xFFEA = -22, multiplicando por un factor de 0.04375 obtenemos un 谩ngulo de direcci贸n de -0.9625 grados. <br><br>  Por lo tanto, puede solicitar una gran cantidad de informaci贸n a las unidades de control, hasta cu谩ntas horas se reprodujo la radio y cu谩ntos discos se cargaron en la radio, as铆 como ejecutar pruebas de diagn贸stico en todos los nodos (puede encender diferentes luces en el tablero y tirar flechas, por ejemplo). <br><br><img src="https://habrastorage.org/webt/c-/vs/d_/c-vsd_0fbijn2pkhxq3znablkse.jpeg" alt="imagen"><br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/csiLZci6MO8" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Bueno, todo lo que quer铆amos era lo que aprendimos, pero 驴de qu茅 sirve?  Ahora, si cambia / habilita / deshabilita algo ... <br><br>  Un simple ejemplo.  En la unidad de control de transmisi贸n autom谩tica hay un contador de software para el nivel de envejecimiento del aceite, y cuando se acumula un cierto valor umbral, aparece un mensaje en la pantalla bk que indica que la transmisi贸n necesita servicio.  Se cambi贸 el aceite, y el mensaje contin煤a mostr谩ndose en la pantalla, porque nadie puede reiniciar el contador y solo se puede reiniciar el esc谩ner del distribuidor MUT-III (que cuesta alrededor de $ 1000, no todos pueden pagarlo) y algunos programas (tampoco gratuitos).  En todas las mismas tablas puede encontrar el equipo con el nombre que se explica por s铆 mismo CLEAR_CVT_oil_degradation_level_Start.  Puede re铆rse viciosamente en direcci贸n a OD y reiniciar este contador desafortunado.  Enviamos el comando <b>31</b> 03 al bloque CVT y ... obtenemos 7F <b>31</b> 33 en respuesta. <br><br>  <i>Una peque帽a digresi贸n.</i>  Casi todos los veh铆culos usan el mecanismo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">UDS (tambi茅n conocido como ISO 14229)</a> para diagn贸stico y mantenimiento. <br><br>  Simplifica la vida de los desarrolladores de esc谩neres de diagn贸stico automotriz y est谩 unificada para todos los fabricantes de autom贸viles (pero esto no significa que algunos no puedan inventar sus propios complementos). <br><br>  Como resultado, tenemos una respuesta descifrada del variador: 7F: la solicitud es rechazada, 31 es el PID que enviamos y el <i>c贸digo de respuesta negativa</i> 33, es decir, Acceso de seguridad denegado.  Es decir, no tenemos derechos para cambiar o solicitar esta funci贸n.  驴A qui茅n tiene ella? <br><br>  <i>Digresi贸n 2.</i> UDS utiliza un mecanismo para restringir el acceso a varios niveles: una sesi贸n de diagn贸stico regular, una sesi贸n extendida, una sesi贸n de programaci贸n, etc.  Cada sesi贸n tiene niveles de acceso que deciden qu茅 puede y qu茅 no.  Para acceder a ellos, debe solicitar la llamada Semilla del bloque, procesarla con un algoritmo espec铆fico y enviarla nuevamente al bloque (Clave).  Lee m谩s <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu铆</a> . <br><br>  Intentemos solicitar una semilla.  Enviamos el comando 2701 a la ECU y obtenemos la respuesta 6701 6A43FD3C. <br>  Enviando cualquier valor de 4 bytes en respuesta ( <b>27</b> 02 DEADBEEF), obtenemos la respuesta 7F <b>27</b> 35, donde 35 es la clave inv谩lida (clave inv谩lida), porque  se envi贸 el valor "desde el techo".  驴D贸nde buscar un algoritmo de c谩lculo clave?  No hay otro lugar en el firmware de la unidad de control.  Es bastante f谩cil obtenerlo (pero no en todos los bloques, todo depende del microcontrolador utilizado), primero encontramos el controlador de recepci贸n CAN, luego la funci贸n de procesamiento PID 0x27. <br><br><img src="https://habrastorage.org/webt/ev/ob/0s/evob0smuav3lsj_g66al3yoxrdy.jpeg" alt="imagen"><br><br>  Repitiendo el intercambio de clave de semilla con el algoritmo del firmware, obtenemos 6702 34 en respuesta, donde 34 es "Acceso permitido".  Despu茅s de eso, el comando para restablecer el nivel de degradaci贸n del aceite cumple con 茅xito y no devuelve un c贸digo de respuesta negativa, sino una respuesta positiva 7103 01 y el contador se restablece con 茅xito. <br><br>  Por lo tanto, a trav茅s del conector OBD, puede hacer casi cualquier cosa con el autom贸vil: cambie los n煤meros VIN en los bloques, configure la codificaci贸n (configuraci贸n), apague el inmovilizador en menos de un segundo, borre la informaci贸n de error, ingrese el bloque en el estado de arranque cuando pueda cargar cualquier codificar y ejecutarlo.  <i>El sistema de seguridad japon茅s es un poco cojo.</i> <br><br>  Un ejemplo de cambio de configuraci贸n en un video: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/xMoWuYTAGrM" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  El art铆culo est谩 escrito solo con fines informativos.  Cualquier intervenci贸n en las unidades de control electr贸nico del autom贸vil puede ser la 煤ltima para ellos.  隆Que tengan un buen d铆a todos! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/448658/">https://habr.com/ru/post/448658/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../448644/index.html">Expresiones regulares aplicativas como functor alternativo gratuito</a></li>
<li><a href="../448648/index.html">C贸mo sentar a todos en la ciencia y no convertir la oficina en un hervidero de odio</a></li>
<li><a href="../448652/index.html">Mozilla WebThings en Raspberry Pi: c贸mo empezar</a></li>
<li><a href="../448654/index.html">Mozilla WebThings - Configuraci贸n de la puerta de enlace</a></li>
<li><a href="../448656/index.html">Gran hermano est谩 mirando ... a s铆 mismo o un mapa con la historia de los movimientos en HomeAssistant</a></li>
<li><a href="../448662/index.html">"Rusia 404": una opci贸n no para mostrar</a></li>
<li><a href="../448664/index.html">Crear cartas como yesca en Swift</a></li>
<li><a href="../448666/index.html">C贸mo elegimos un servicio para la gesti贸n de documentos electr贸nicos con clientes</a></li>
<li><a href="../448668/index.html">gil: el mayor problema ideol贸gico en TI</a></li>
<li><a href="../448670/index.html">Dise帽o de interfaz integrada</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>