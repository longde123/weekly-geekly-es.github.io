<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧑🏿‍🤝‍🧑🏾 ↙️ 👨‍🎓 PVS-Studio静态分析仪作为防止零日漏洞的工具 🍖 🙌 👨‍🚀</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="零日（0天）漏洞是在开发过程中引入的，尚未被开发人员发现的计算机软件漏洞。 黑客可以利用零日漏洞，从而影响公司声誉。 开发人员应设法减少导致此类漏洞的缺陷数量。 PVS-Studio是用于C，C ++，C＃和Java代码的静态代码分析器，是能够检测安全问题的工具之一。 

 零日漏洞 
 零日漏洞 ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>PVS-Studio静态分析仪作为防止零日漏洞的工具</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pvs-studio/blog/477838/"><p></p><div style="text-align:center;"><img src="https://habrastorage.org/webt/wn/yg/mo/wnygmobm1xqfcuxn4cmsqzay8lg.png" alt="PVS-Studio静态分析仪作为防止零日漏洞的工具"></div><br> 零日（0天）漏洞是在开发过程中引入的，尚未被开发人员发现的计算机软件漏洞。 黑客可以利用零日漏洞，从而影响公司声誉。 开发人员应设法减少导致此类漏洞的缺陷数量。  PVS-Studio是用于C，C ++，C＃和Java代码的静态代码分析器，是能够检测安全问题的工具之一。 <br><a name="habracut"></a><br><h2> 零日漏洞 </h2><br>  <a href="https://en.wikipedia.org/wiki/Zero-day_(computing)">零日漏洞</a> （也称为<i>0天</i>漏洞）是一种计算机软件漏洞，对于那些有兴趣缓解该漏洞（包括目标软件的供应商）的人来说是未知的或无法解决的。 在缓解漏洞之前，黑客可以利用它对计算机程序，数据，其他计算机或网络产生不利影响。 该术语表示开发人员没有一天可以修复该缺陷，因为尚无人知道。 在过去，某些知名供应商和软件产品（如<a href="https://securelist.com/sykipot-exploits-an-adobe-flash-zero-day/29760/">Adobe</a> ， <a href="https://www.bleepingcomputer.com/news/security/new-windows-zero-day-bug-helps-delete-any-file-exploit-available/">Windows</a> ， <a href="https://www.netsparker.com/blog/web-security/noscript-vulnerability-tor-browser/">Tor浏览器</a>等）受到零日漏洞的影响。 <br><br> 有些人很幸运能找到不想要利用此漏洞的人并予以报告。  <a href="https://securityaffairs.co/wordpress/86543/hacking/synthetic-clicks-macos-0day.html">MacOS</a>就是这样的一个例子。 在另一些情况下，开发人员自己制作了一个补丁，使用该补丁，在添加新功能的同时，还修复了零日漏洞，却不知道该漏洞。 <br><br> 其他人则不那么幸运。 例如，不久前，谷歌浏览器不得不紧急修复一个<a href="https://www.lansweeper.com/vulnerability/major-chrome-zero-day-exploit-patched-time-to-update/">漏洞</a> ，可以利用该<a href="https://www.lansweeper.com/vulnerability/major-chrome-zero-day-exploit-patched-time-to-update/">漏洞</a>远程执行任意代码。 <br><br> 问题是您无法保证100％抵御这些漏洞，因为您无法有效抵抗甚至不知道的威胁。 但是，有一些方法可以减少此类缺陷在您的程序中的发生-这将是本文的主题，但是我们应该首先了解一些理论。 <br><br><h2> 静态分析 </h2><br> 静态分析是一种使用分析器检查软件程序源代码而不执行程序本身的方法，可以看作是自动代码审查。 有时，静态分析可能比对等代码检查更为有效，但不能完全取代它。 我试图在下表中总结代码审查和静态分析相对于彼此的优缺点： <br><div class="scrollable-table"><table><tbody><tr><th> 代码审查 <br></th><th> 静态分析 <br></th></tr><tr><td> 帮助您不仅发现琐碎的问题，而且还发现高级错误 <br></td><td> 帮助发现不熟悉的缺陷或漏洞 <br></td></tr><tr><td> 帮助改善程序的体系结构并制定一致的编码样式 <br></td><td> 帮助发现人眼不易察觉的错误（例如错别字） <br></td></tr><tr><td> 贵的 <br></td><td> 比代码审查便宜 <br></td></tr><tr><td> 占用大量程序员的时间。 休息是必要的，因为审阅者的注意力会迅速减弱 <br></td><td> 误报是不可避免的。 用户必须自定义分析仪 <br></td></tr></tbody></table></div><h2>  CVE和CWE </h2><br> 常见漏洞和披露（CVE）是一个信息安全漏洞和披露的数据库。 其最初目的是将已知的软件缺陷组织到一个统一的列表中。 过去，大多数信息安全工具都使用自己的数据库和此类缺陷的名称，这是为了解决这种混乱，并建立MITER Corporation在1999年开发CVE的不同工具之间的兼容性。不足以估计代码安全性。 还需要其他一些系统，具有更好的分类和更详细的描述。 这就是常见弱点枚举（CWE）诞生的方式。 如果CWE中列出了缺陷，则可能导致可利用的漏洞，并且也被添加到CVE列表中。 下面的欧拉图显示了标准之间的关系。 <br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/webt/ec/02/l7/ec02l74mwthliqvd97vw2cqmblq.png" alt="CWE，CVE"></div><br> 某些静态分析器可以通知您，例如，您的项目是否使用了包含漏洞的库。 知道了这一点，您可以下载已修复缺陷的库的更新版本，以使您的代码不太容易受到他人代码错误引起的安全威胁的影响。 <br><br> 随着CVE和CWE标准被开发人员社区所接受，它们也得到了包括静态分析器在内的许多信息安全工具的支持。 支持这些分类的分析仪可以视为SAST解​​决方案。  SAST（静态应用程序安全性测试）允许开发人员在软件开发生命周期的最早阶段检测程序源代码中的漏洞。 <br><br>  SAST是另一种实践，可以最大程度地减少项目中发生零日漏洞的可能性。 支持CWE标准的分析器可以告诉您潜在漏洞在哪里潜伏，以便您可以对其进行修复，以使您的应用程序更可靠，更不可能包含0天威胁。 <br><br> 有各种各样的SAST工具。 我将以<a href="https://www.viva64.com/en/sast/">PVS-Studio</a>分析仪为例，以说明这些工具如何帮助对抗漏洞。 该分析仪的警告被归类为CWE。 下面给出一些示例。 <br><br>  PVS-Studio诊断消息： <a href="https://cwe.mitre.org/data/definitions/561.html">CWE-561</a> ： <a href="https://www.viva64.com/en/w/v3021/">无效</a>代码（ <a href="https://www.viva64.com/en/w/v3021/">V3021</a> ）。 <br><br><pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-built_in">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">EncodeImage</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(....)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>.IsNullOrWhiteSpace(inputPath)) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArgumentNullException(<span class="hljs-string"><span class="hljs-string">"inputPath"</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>.IsNullOrWhiteSpace(inputPath)) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArgumentNullException(<span class="hljs-string"><span class="hljs-string">"outputPath"</span></span>); } .... }</code> </pre> <br> 这段代码包含一个错字：两个<i>if</i>语句的条件都检查同一个变量。 伴随异常的消息表明第二种情况应改为检查<i>outputPath</i>变量。 此错误使代码的某些部分无法访问。 <br><br> 这样的错误似乎无害，但这种印象是错误的。 让我们看一下另一个与重复的<i>goto</i>语句有关的琐碎且看似无害的错误。 <br><br> 此错误曾经导致iOS中的漏洞。 <br><br>  <a href="https://cve.mitre.org/cgi-bin/cvename.cgi%3Fname%3DCVE-2014-1266">CVE-2014-1266</a>漏洞：Apple TV 6.x之前的6.1.6版和7.0.6之前的7.x版，Apple TV中的数据传输组件中的安全传输功能中的libsecurity_ssl / lib / sslKeyExchange.c中的libsecurity_ssl / lib / sslKeyExchange.c中的SSLVerifySignedServerKeyExchange函数6.0.2之前的6.x和10.9.2之前的Apple OS X 10.9.x不会检查TLS服务器密钥交换消息中的签名，该消息允许中间人攻击者使用任意内容来欺骗SSL服务器签名步骤或省略签名步骤的私钥。 <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> OSStatus </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SSLVerifySignedServerKeyExchange</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(SSLContext *ctx, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> isRsa, SSLBuffer signedParams, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint8_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *signature, UInt16 signatureLen)</span></span></span><span class="hljs-function"> </span></span>{ OSStatus err; .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((err = SSLHashSHA1.update(&amp;hashCtx, &amp;serverRandom)) != <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> fail; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((err = SSLHashSHA1.update(&amp;hashCtx, &amp;signedParams)) != <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> fail; <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> fail; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((err = SSLHashSHA1.final(&amp;hashCtx, &amp;hashOut)) != <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> fail; .... fail: SSLFreeBuffer(&amp;signedHashes); SSLFreeBuffer(&amp;hashCtx); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> err; }</code> </pre> <br> 像在第一个示例中一样，此处重复的<i>goto</i>导致了无法访问的代码：无论<i>if</i>语句的条件如何，无论如何都将执行第二个<i>goto</i>语句。 结果，将不检查签名，该函数将返回0，表示签名正常，并且即使签名检查失败，程序也将从服务器接收密钥。 该密钥用于加密正在传输的数据。 <br><br> 这个琐碎的错误产生了深远的影响。 该事件说明了为什么没有理由推测这种或那种CWE缺陷是否危险–您仅出于代码安全的考虑而必须对其进行修复。 <br><br> 顺便说一句，PVS-Studio可以很容易地发现此错误，并立即通过两个CWE警告报告此错误： <br><br><ul><li>  <a href="https://cwe.mitre.org/data/definitions/561.html">CWE-561</a> （ <a href="https://www.viva64.com/en/w/v779/">V779</a> ）： <a href="https://www.viva64.com/en/w/v779/">无效</a>代码 </li><li>  <a href="https://cwe.mitre.org/data/definitions/483.html">CWE-483</a> （ <a href="https://www.viva64.com/en/w/v640/">V640</a> ）：不正确的块定界 </li></ul><br> 这是另一个例子。 很久以前，在2012年，MySQL中发现了一个安全问题，攻击者可以利用它来进入MySQL数据库。 在下面，您将看到存在漏洞的代码片段。 <br><br>  <a href="https://cve.mitre.org/cgi-bin/cvename.cgi%3Fname%3DCVE-2012-2122">CVE-2012-2122</a>漏洞：Oracle MySQL 5.1.x（5.1.63之前），5.5.x（5.5.24之前）和5.6.x（5.6.6之前）以及MariaDB 5.1.x（5.1.62之前）中的sql / password.c ，5.2.12之前的5.2.x，5.3.6之前的5.3.x和5.5.23之前的5.5.x，在具有memcmp功能某些实现的某些环境中运行时，允许远程攻击者通过使用相同的错误密码，由于返回值检查不正确，最终导致令牌比较成功。 <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">typedef</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> my_bool; <span class="hljs-function"><span class="hljs-function">my_bool </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">check_scramble</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *scramble_arg, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *message, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> uint8 *hash_stage2)</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">memcmp</span></span>(hash_stage2, hash_stage2_reassured, SHA1_HASH_SIZE); }</code> </pre> <br>  <i>memcmp</i>函数返回<i>int</i>类型的值，而<i>check_scramble</i>函数返回<i>my_bool</i>类型的值，实际上是<i>char</i> 。  <i>int</i>值隐式转换为<i>char</i> ，最高有效位被截断。 这导致大约256次尝试中使用任意密码登录的尝试中有1次成功使已知用户名成功。 <br><br> 同样，此CWE缺陷在编码阶段可以更早地被消除并防止成为CVE漏洞。 例如，PVS-Studio将其报告为<a href="https://cwe.mitre.org/data/definitions/197.html">CWE-197</a> （ <a href="https://www.viva64.com/en/w/v642/">V642</a> ）：数值截断错误。 <br><br> 请参阅文章“ <a href="https://www.viva64.com/en/b/0514/">PVS-Studio如何帮助检测漏洞？</a> ”以获取有关该主题的更多信息。 <br><br><h2> 结论 </h2><br> 您不能100％地确定您的程序不受0天漏洞的影响。 但是您仍然可以使它们发生的可能性大大降低。 这可以通过使用专用的SAST工具（例如PVS-Studio）来完成。 如果发现您的项目包含归类为CWE问题的缺陷，请确保对其进行修复。 尽管很少有CWE缺陷最终出现在CVE列表中，但修复它们有助于保护您的程序免受许多潜在威胁的侵害。 <br><br><h2> 参考文献 </h2><br><ol><li>  <a href="https://www.viva64.com/en/pvs-studio-download/">下载并评估PVS-Studio</a> </li><li>  <a href="https://www.viva64.com/en/b/0592/">PVS-Studio代码分析器中用于查找错误和潜在漏洞的技术</a> </li><li>  <a href="https://www.viva64.com/en/cwe/">根据常见弱点枚举（CWE）对PVS-Studio警告进行分类</a> </li><li>  <a href="https://www.viva64.com/en/cert/">根据SEI CERT编码标准对PVS-Studio警告进行分类</a> </li></ol></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN477838/">https://habr.com/ru/post/zh-CN477838/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN477822/index.html">PHP 7.4发布了！ Badoo如何升级</a></li>
<li><a href="../zh-CN477824/index.html">让我们活到星期一或如何在黑色星期五生存</a></li>
<li><a href="../zh-CN477826/index.html">V2X技术概述和比较</a></li>
<li><a href="../zh-CN477832/index.html">如何与Z世代相处</a></li>
<li><a href="../zh-CN477834/index.html">构建流分析系统的原则</a></li>
<li><a href="../zh-CN477840/index.html">PVS-Studio静态代码分析仪可抵御零日漏洞</a></li>
<li><a href="../zh-CN477842/index.html">Gennady Zelenko和Sergey Popov的故事-苏联的技术普及者</a></li>
<li><a href="../zh-CN477844/index.html">使用SAP Data Intelligence从思想到机器学习的实际应用的5个步骤</a></li>
<li><a href="../zh-CN477848/index.html">大心脏的小秘密：历史上的第一个蓝鲸心电图</a></li>
<li><a href="../zh-CN477850/index.html">React Native-解决所有问题的灵丹妙药吗？ 我们如何为Profi.ru选择跨平台工具</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>