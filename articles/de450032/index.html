<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üõ¢Ô∏è üèÖ üë©‚Äçüé§ So erstellen Sie ein dunkles Thema, ohne Dinge zu besch√§digen: Lernen Sie mit dem Yandex Mail-Team üÜì üëêüèª ‚öîÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Mein Name ist Vladimir und ich entwickle ein mobiles Frontend f√ºr Yandex Mail. Unsere Apps hatten eine Weile ein dunkles Thema, aber es war unvollst√§n...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>So erstellen Sie ein dunkles Thema, ohne Dinge zu besch√§digen: Lernen Sie mit dem Yandex Mail-Team</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yandex/blog/450032/"><p><img src="https://habrastorage.org/webt/ji/4q/pr/ji4qprfkpuotssmzabus4cjflrq.png"></p><br><p>  Mein Name ist Vladimir und ich entwickle ein mobiles Frontend f√ºr Yandex Mail.  Unsere Apps hatten eine Weile ein dunkles Thema, aber es war unvollst√§ndig: Nur die Benutzeroberfl√§che und einfache E-Mails waren dunkel.  Nachrichten mit benutzerdefinierter Formatierung blieben hell und hoben sich von der dunklen Oberfl√§che ab, wodurch die Augen unserer Benutzer nachts verletzt wurden. </p><br><p>  Heute werde ich Ihnen sagen, wie wir dieses Problem behoben haben.  Sie lernen zwei einfache Techniken kennen, die bei uns nicht funktioniert haben, und die Methode, die schlie√ülich den Trick ausgef√ºhrt hat - das adaptive Umf√§rben von Seiten.  Ich werde auch einige Ideen zum Anpassen von Bildern an ein dunkles Thema teilen.  Um fair zu sein, ist das Abdunkeln von Seiten mit benutzerdefiniertem CSS eine ziemlich eigenartige Aufgabe, aber ich glaube, einige von Ihnen finden unsere Erfahrung hilfreich. </p><a name="habracut"></a><br><h2 id="simple-methods">  Einfache Methoden </h2><br><p>  Bevor wir uns f√ºr unsere magische Farbbiegetechnik entschieden haben, haben wir zwei wirklich grundlegende Optionen ausprobiert: entweder zus√§tzliches dunkles Styling oder einen CSS-Filter auf Elemente anwenden.  Keine der beiden Optionen hat bei uns funktioniert, aber in anderen F√§llen sind sie m√∂glicherweise besser geeignet (einfach ist cool, oder?). </p><br><h3 id="overriding-styles">  Stile √ºberschreiben </h3><br><p>  Dies ist eine kinderleichte Option, die das dunkle CSS-Thema der App logisch erweitert.  Sie f√ºgen einfach zus√§tzliche dunkle Stile in einen E-Mail-Container ein (oder im Allgemeinen in einen Container, damit der vom Benutzer generierte Inhalt dunkler wird): </p><br><pre><code class="css hljs"><span class="hljs-selector-class"><span class="hljs-selector-class">.message--dark</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">background-color</span></span>: black; <span class="hljs-attribute"><span class="hljs-attribute">color</span></span>: white; }</code> </pre> <br><p>  Alle Stile f√ºr die Elemente in der E-Mail √ºberschreiben jedoch unseren Stammstil.  Und nein <code>!important</code> hilft hier nicht.  Die Idee kann noch einen Schritt weiter gehen, indem Vererbung verhindert wird: </p><br><pre> <code class="css hljs"><span class="hljs-selector-class"><span class="hljs-selector-class">.message--dark</span></span> * { <span class="hljs-attribute"><span class="hljs-attribute">background-color</span></span>: black <span class="hljs-meta"><span class="hljs-meta">!important</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">color</span></span>: white <span class="hljs-meta"><span class="hljs-meta">!important</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">border-color</span></span>: <span class="hljs-number"><span class="hljs-number">#333</span></span> <span class="hljs-meta"><span class="hljs-meta">!important</span></span>; }</code> </pre> <br><p>  In diesem Fall k√∂nnen Sie nicht darauf verzichten <code>!important</code> , da der Selektor selbst nicht sehr spezifisch ist.  Dies √ºberschreibt auch die meisten Inline-Stile (diejenigen mit Inline <code>!important</code> wird immer noch Eingang finden, und Sie k√∂nnen nicht viel dagegen tun). </p><br><p>  Unser Stil malt eifrig alles in der gleichen Farbe und bringt so ein weiteres Problem mit sich.  Es besteht die M√∂glichkeit, dass der Designer etwas √ºber die Art und Weise sagen wollte, wie sie die Farben angeordnet haben (Sie wissen, Priorit√§ten, Paarungen, all das Designermaterial), und wir haben einfach ihre Idee aufgegriffen und sie aus dem Fenster geworfen.  Keine sch√∂ne Sache. </p><br><p><img src="https://habrastorage.org/webt/cu/-1/ka/cu-1kav8ydvyjxlobshlklgio9u.png"></p><br><p>  Wenn Sie Designer nicht so sehr respektieren wie ich und sich f√ºr diese Methode entscheiden, vergessen Sie nicht, die nicht so offensichtlichen Dinge zu behandeln: </p><br><ul><li>  <code>box-shadow</code> .  Sie k√∂nnen jedoch nicht nur die Farbe √ºberschreiben.  Entweder die Schatten ganz loswerden oder mit den hellen Frieden schlie√üen. </li><li>  Die Farben semantischer Elemente wie Links oder Eingaben. </li><li>  Inline-SVG.  Verwenden Sie <code>fill</code> anstelle von <code>background</code> und <code>stroke</code> anstelle von <code>color</code> , aber Sie k√∂nnen nie sicher sein, dass es auch umgekehrt sein kann. </li></ul><br><p>  Aus technischer Sicht ist dies eine solide Methode: Es werden drei Codezeilen ben√∂tigt (OK, drei√üig f√ºr eine produktionsbereite Version mit allen Randf√§llen), es ist mit allen Browsern der Welt kompatibel Funktioniert sofort mit dynamischen Seiten, und die Art und Weise, wie CSS an das Dokument angeh√§ngt wird, ist v√∂llig irrelevant.  Es gibt auch einen sch√∂nen Bonus: Sie k√∂nnen die Farben im Stil leicht an die Hauptfarben der Anwendung <code>#bbbbb8</code> (z. B. den Hintergrund <code>#bbbbb8</code> anstelle von Schwarz). </p><br><p>  √úbrigens haben wir fr√ºher so E-Mails abgedunkelt.  Wenn eine E-Mail einen eigenen Stil h√§tte, w√ºrden wir einfach aufgeben und sie f√ºr alle F√§lle leicht lassen. </p><br><h3 id="using-a-css-filter">  Verwenden eines CSS-Filters </h3><br><p>  Dies ist eine intelligente und elegante Methode.  Sie k√∂nnen eine Seite mit einem CSS-Filter abdunkeln: </p><br><pre> <code class="css hljs"><span class="hljs-selector-class"><span class="hljs-selector-class">.message--dark</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">filter</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">invert</span></span>(100) <span class="hljs-built_in"><span class="hljs-built_in">hue-rotate</span></span>(180deg); <span class="hljs-comment"><span class="hljs-comment">/* hue-rotate    */</span></span> }</code> </pre> <br><p>  Die Bilder werden gruselig, aber wir k√∂nnen das leicht beheben: </p><br><pre> <code class="css hljs"><span class="hljs-selector-class"><span class="hljs-selector-class">.message-dark</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">img</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">filter</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">invert</span></span>(100) <span class="hljs-built_in"><span class="hljs-built_in">hue-rotate</span></span>(180deg); }</code> </pre> <br><p><img src="https://habrastorage.org/webt/dr/3a/ix/dr3aix8opihd2nlq6oqzjfbdtvs.png"></p><br><p>  Dies l√∂st jedoch nicht das Problem von Inhaltsbildern, die √ºber die Hintergrundeigenschaft angeh√§ngt werden (sicher, es ist praktisch, um das Seitenverh√§ltnis anzupassen, aber was ist mit der Semantik?).  OK, nehmen wir an, wir k√∂nnen alle diese Elemente finden, explizit markieren und auch ihre Farben zur√ºck √§ndern. </p><br><p>  Das Gute an dieser Methode ist, dass die urspr√ºngliche Helligkeits- und Kontrastbalance erhalten bleibt.  Auf der anderen Seite gibt es viele Probleme, die die Vorteile √ºberwiegen: </p><br><p><img src="https://habrastorage.org/webt/ed/qe/h1/edqeh1dpkqv-w2gydobzojuaia0.png" width="300"></p><br><ol><li>  Dunkle Seiten werden hell. </li><li>  Sie k√∂nnen die endg√ºltigen Farben nicht steuern.  Welchen Filter wenden Sie auf den Hintergrund an, damit er zu Ihrer Marke <code>#bbbbb8</code> ?  Das ist ein echter Kopfkratzer. </li><li>  Durch die doppelte Inversion werden die Bilder ausgeblendet. </li><li>  Die Leistung ist schleppend, insbesondere auf Mobilger√§ten. Anstatt die Seite einfach zu rendern, f√ºhrt der Browser bei jeder Ziehung Fourier-Transformationen aus. </li></ol><br><p>  Diese Methode w√ºrde f√ºr E-Mails mit neutralem Text funktionieren, aber ich habe noch nie jemanden mit einem Posteingang voller solcher Inhalte getroffen.  Auf der anderen Seite sind Filter die einzige M√∂glichkeit, Elemente abzudunkeln, ohne auf deren Inhalt zuzugreifen - Frames, Webkomponenten oder Bilder. </p><br><h2 id="adaptive-dark-theme">  Adaptives dunkles Thema </h2><br><p>  Und jetzt ist es Zeit f√ºr Magie!  Basierend auf den Nachteilen der ersten beiden Ans√§tze haben wir eine Checkliste erstellt, um was wir uns k√ºmmern sollten: </p><br><ol><li>  Machen Sie den Hintergrund dunkel, den Text hell und die R√§nder irgendwo dazwischen. </li><li>  Erkennen Sie dunkle Seiten und bewahren Sie deren Farben. </li><li>  Behalten Sie das urspr√ºngliche Gleichgewicht zwischen Helligkeit und Kontrast bei. </li><li>  Geben Sie die Kontrolle √ºber die resultierenden Farben. </li><li>  Lassen Sie die Farbt√∂ne unver√§ndert. </li></ol><br><p>  Sie m√ºssen also die Farben der Stile √§ndern, um den Hintergrund dunkel zu machen.  Warum nicht einfach das buchst√§blich tun?  Nehmen Sie alle Stile, extrahieren Sie die farbbezogenen Regeln ( <code>color</code> , <code>background</code> , Rahmen, <code>box-shadow</code> und ihre Untereigenschaften) und ersetzen Sie sie durch ihre "abgedunkelten" Versionen: Verdunkeln Sie den Hintergrund und die R√§nder (aber nicht so stark wie die Hintergrund), heller den Text usw. </p><br><p>  Diese Methode hat einen unglaublichen Vorteil, der das Herz eines jeden Entwicklers erw√§rmt.  Sie k√∂nnen Farbkonvertierungsregeln f√ºr jede Eigenschaft konfigurieren - ja, mithilfe von Code!  Mit ein wenig Fantasie k√∂nnen Sie die Farben an jedes externe Thema anpassen, jede gew√ºnschte Farbkorrektur durchf√ºhren (z. B. ein helles Thema anstelle eines dunklen oder ein Thema einer beliebigen Farbe) und sogar ein hinzuf√ºgen ein bisschen Kontextualit√§t - behandeln Sie zum Beispiel breite und schmale Grenzen unterschiedlich. </p><br><p>  Die Nachteile sind das, was Sie von einem "Alles-in-Js" -Ansatz erwarten w√ºrden.  Wir f√ºhren Skripte aus, bringen die Kapselung durcheinander und analysieren CSS mit Regex.  Letzteres ist jedoch nicht so dem√ºtigend wie bei HTML, da die CSS-Grammatik regelm√§√üig ist (zumindest auf der Ebene, mit der wir arbeiten). </p><br><p>  Hier ist unser dunkler Plan: </p><br><ol><li>  Normalisieren Sie die <code>bgcolor</code> ( <code>bgcolor</code> und andere) und verschieben Sie sie in <code>style="..."</code> . </li><li>  Hier finden Sie alle Inline-Stile. </li><li>  Finden Sie alle farbbezogenen Regeln in jedem Stil ( <code>background-color</code> , <code>color</code> , <code>box-shadow</code> und andere). </li><li>  Nehmen Sie die Farben aus den farbbezogenen Eigenschaften und stimmen Sie sie mit dem richtigen Konverter ab (verdunkeln Sie den Hintergrund, erhellen Sie den Text). </li><li>  Rufen Sie den Konverter an. </li><li>  F√ºgen Sie die konvertierten Eigenschaften wieder in das CSS ein. </li></ol><br><p>  Der Wrapper-Code - Normalisierung, Suchen von Stilen, Parsen - ist ziemlich trivial.  Mal sehen, wie genau unser Magic Converter funktioniert. </p><br><h3 id="hsl-conversions">  HSL-Konvertierungen </h3><br><p>  Das Abdunkeln einer Farbe ist nicht so einfach, wie es sich anh√∂rt, insbesondere wenn Sie den Farbton beibehalten m√∂chten (z. B. Blau in Dunkelblau und nicht Orange umwandeln).  Sie k√∂nnen dies in normalem RGB tun, aber es ist problematisch.  Wenn Sie sich f√ºr algorithmisches Design interessieren, wissen Sie, dass in RGB sogar Farbverl√§ufe unterbrochen sind.  In der Zwischenzeit ist die Arbeit mit Farben in HSL ein wahrer Genuss: Anstelle von Rot, Gr√ºn und Blau, mit denen Sie keine Ahnung haben, was Sie tun sollen, haben Sie die folgenden drei Kan√§le: </p><br><ul><li>  Farbton - das, was wir bewahren wollen. </li><li>  S√§ttigung, die uns momentan nicht sehr wichtig ist. </li><li>  Leichtigkeit, die wir √§ndern werden. </li></ul><br><p>  Man kann es sich als Zylinder vorstellen.  Wir m√ºssen diesen Zylinder auf den Kopf stellen.  Die Farbkorrektur macht ungef√§hr so: <code>(h, s, l) =&gt; [h, s, 1-l]</code> . </p><br><h3 id="colors-that-are-already-ok">  Farben, die schon in Ordnung sind </h3><br><p>  Manchmal haben wir Gl√ºck und das benutzerdefinierte Design der E-Mail (oder eines Teils davon) ist bereits dunkel.  Dies bedeutet, dass wir nichts √§ndern m√ºssen - der Designer hat wahrscheinlich die Farben besser ausgew√§hlt, als unser Algorithmus jemals tr√§umen konnte.  In HSL m√ºssen Sie nur die L-Leichtigkeit ber√ºcksichtigen.  Wenn der Wert h√∂her oder niedriger (f√ºr den Text bzw. den Hintergrund) als der Schwellenwert (den Sie festlegen k√∂nnen) ist, lassen Sie ihn einfach in Ruhe. </p><br><h3 id="dynamic-circus">  Dynamischer Zirkus </h3><br><p>  Auch wenn wir nichts davon brauchten (vielen Dank, Desinfektionsmittel, Sie haben meinen Tag hier gerettet), werde ich die zus√§tzlichen Funktionen auflisten, die ein adaptives Thema ben√∂tigt, um ganze Seiten und nicht nur doofe statische E-Mails aus den 90ern abzudunkeln.  Faire Warnung: Diese Aufgabe ist nicht jedermanns Sache. </p><br><h4 id="dynamic-inline-styles">  Dynamische Inline-Stile </h4><br><p>  Das √Ñndern von Inline-Stilen ist der einfachste Fall, der unsere dunklen Seiten durcheinander bringt.  Es ist √ºblich, aber es gibt eine einfache L√∂sung: F√ºgen Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><code>MutationObserver</code></a> und korrigieren Sie Inline-Stile, sobald die √Ñnderungen eintreten. </p><br><h4 id="external-styles">  Externe Stile </h4><br><p>  Das Arbeiten mit Stilen, auf die ein <code>&lt;link&gt;</code> -Element innerhalb der Seite <code>@import</code> kann aufgrund der Asynchronit√§t und der <code>@import</code> Anweisungen qualvoll sein.  Und CORS macht die Dinge nicht besser.  Es sieht so aus, als ob dieses Problem mit einem Web-Worker (Proxy f√ºr alle <code>*.css</code> ) recht elegant gel√∂st werden kann. </p><br><h4 id="dynamic-styles">  Dynamische Stile </h4><br><p>  Um die Sache noch schlimmer zu machen, k√∂nnen Skripte <code>&lt;style&gt;</code> und <code>&lt;link&gt;</code> -Elemente nach Belieben hinzuf√ºgen, entfernen oder neu anordnen und sogar die Regeln in <code>&lt;style&gt;</code> √§ndern.  Hier m√ºssen Sie auch <code>MutationObserver</code> , aber jede √Ñnderung erfordert mehr Verarbeitung. </p><br><h4 id="css-variables">  CSS-Variablen </h4><br><p>  Wenn CSS-Variablen ins Spiel kommen, wird es richtig wild.  Sie k√∂nnen die Variablen nicht abdunkeln: Selbst wenn Sie vermuten, dass eine Variable eine Farbe enth√§lt, die auf ihrem Format basiert (obwohl ich davon abraten w√ºrde), wissen Sie immer noch nicht, welche Rolle sie spielt - Hintergrund, Text, Rahmen oder alles sofort?  Dar√ºber hinaus werden die Werte von CSS-Variablen vererbt, sodass Sie nicht nur die Stile, sondern auch die Elemente verfolgen m√ºssen, auf die sie angewendet werden. Dies eskaliert schnell au√üer Kontrolle. </p><br><p>  Sobald die CSS-Variablen den Mainstream erreicht haben, sind wir in Schwierigkeiten.  Auf der anderen Seite wird <code>color()</code> bis dahin unterst√ºtzt, sodass wir alle unsere JS-Konvertierungen durch eine <code>color(var(--bg) lightness(-50%))</code> ersetzen k√∂nnen. </p><br><h3 id="summary">  Zusammenfassung </h3><br><p><img src="https://habrastorage.org/webt/46/rl/mz/46rlmzxvgus52n7_77t3ydz2ms0.png"></p><br><p>  In unserem Fall wirkt die adaptive Verdunkelung auf CSS-Ebene wie ein Zauber, wenn der Desinfektionsmittel nur Inline-Stile bel√§sst: Sie bietet eine Verdunkelung von h√∂herer Qualit√§t, st√∂rt die urspr√ºngliche Struktur nicht und ist relativ einfach und schnell.  Die Erweiterung auf dynamische Seiten ist jedoch wahrscheinlich nicht die M√ºhe wert.  Wenn Sie mit benutzergenerierten Inhalten arbeiten und keinen Browser entwickeln, funktioniert Ihr Desinfektionsprogramm wahrscheinlich genauso. </p><br><p>  In der Praxis sollte der adaptive Modus mit Stil√ºberschreibungen gepaart werden, da Standardelemente wie <code>&lt;input&gt;</code> oder <code>&lt;a&gt;</code> h√§ufig die Standardlichtstile verwenden. </p><br><h2 id="how-to-darken-images">  So verdunkeln Sie Bilder </h2><br><p>  Die Bildverdunkelung ist ein separates Problem, das mich pers√∂nlich st√∂rt.  Es ist eine Herausforderung und gibt mir eine Entschuldigung, endlich den Ausdruck "Spektralanalyse" zu verwenden.  Es gibt einige typische Probleme mit Bildern in einem dunklen Thema. </p><br><p>  Einige Bilder sind einfach zu hell.  Diese bereiten uns die gleichen Probleme wie die hellen E-Mails, mit denen wir unsere Suche begonnen haben.  Dieses Problem tritt h√§ufig bei normalen Fotos auf, ist jedoch nicht ausschlie√ülich f√ºr diese.  Da das Schreiben von Newsletter-CSS nicht viel Spa√ü macht, √ºberspringen einige Leute gerne Ecken, indem sie ein komplexes Layout als Bild einf√ºgen, wodurch eine Verdunkelung verhindert wird.  Wenn ich das sehe, st√∂hnt mein innerer Perfektionist frustriert.  Diese Bilder sollten abgeblendet, aber nicht invertiert sein, es sei denn, Sie m√∂chten Ihre Benutzer erschrecken. </p><br><p><img src="https://habrastorage.org/webt/6-/zz/nx/6-zznxvkap9ywdvgjpglm5v6wqc.png"></p><br><p>  Dann gibt es dunkle Bilder mit echter Transparenz.  Dies ist ein typisches Problem bei Logos. Sie sind f√ºr einen hellen Hintergrund konzipiert. Wenn wir sie durch einen dunklen Hintergrund ersetzen, verschwindet das Logo darin.  Diese Bilder m√ºssen invertiert werden. </p><br><p><img src="https://habrastorage.org/webt/xo/at/cc/xoatcc7dg3nhb_ufdoyye4hxsoo.png"></p><br><p>  Irgendwo dazwischen befinden sich Bilder, die einen wei√üen Hintergrund verwenden, der Transparenz darstellen soll.  Im dunklen Thema landen sie einfach in einem seltsamen wei√üen Dreieck.  In einer perfekten Welt k√∂nnten wir den wei√üen Hintergrund in einen transparenten √§ndern, aber wenn Sie jemals einen Zauberstab verwendet haben, wissen Sie, wie schwierig es ist, dies automatisch zu tun. </p><br><p><img src="https://habrastorage.org/webt/fi/o4/v9/fio4v9n1lcpve_wa1jhj5usj4yo.png"></p><br><p>  Interessanterweise haben einige Bilder keinerlei Bedeutung.  Dies sind normalerweise Tracking-Pixel oder "Formathalter" in besonders bizarren Layouts.  Sie k√∂nnen sie sicher unsichtbar machen (z. B. mit einer <code>opacity: 0</code> ). </p><br><p><img src="https://habrastorage.org/webt/5y/ba/tu/5ybatucrfhczsgc_aqykbgtnop0.png"></p><br><h3 id="analyzing-whats-inside">  Analysieren, was drin ist </h3><br><p>  Um herauszufinden, wie ein Bild f√ºr ein dunkles Thema angepasst werden kann, m√ºssen wir nach innen schauen und dessen Inhalt analysieren, vorzugsweise mit einer schnellen und einfachen Methode.  Hier ist die erste Version eines Algorithmus, der dies l√∂st. </p><br><p>  Z√§hlen Sie zuerst die dunklen, hellen und transparenten Pixel des Bildes.  Als offensichtliche Optimierung kann nur eine kleine Teilmenge von Pixeln betrachtet werden.  Bestimmen Sie als N√§chstes die Gesamthelligkeit des Bildes (hell, dunkel oder mittel) und ob Transparenz vorhanden ist.  Invertieren Sie dunkle Bilder mit Transparenz, dimmen Sie undurchsichtige helle Bilder und lassen Sie den Rest unver√§ndert. </p><br><p>  Ich habe mich sehr √ºber diese Entdeckung gefreut, bis ich auf einen Charity-Newsletter stie√ü, der ein Foto einer Lektion an einer afrikanischen Schule enthielt.  Der Designer zentrierte es, indem er transparente Pixel an den Seiten hinzuf√ºgte.  Wir wollten uns nicht auf eine Geschichte √ºber anst√∂√üige Bilderkennung einlassen, deshalb haben wir beschlossen, die Bildmanipulation aus unserer ersten Iteration herauszulassen. </p><br><p>  In Zukunft k√∂nnen wir solche Probleme verhindern, indem wir diese Heuristik verwenden, die ich "Spektralanalyse" nenne.  Das hei√üt, Sie z√§hlen die Anzahl der verschiedenen Farbt√∂ne im Bild und invertieren nur, wenn nicht zu viele vorhanden sind.  Mit derselben Methode k√∂nnen Sie helle, skizzenhafte Bilder erkennen und auch invertieren. </p><br><p><img src="https://habrastorage.org/webt/sj/c1/di/sjc1diiz68fpljjzii64f9j7nrq.png"></p><br><h2 id="conclusion">  Fazit </h2><br><p>  Um ein vollwertiges dunkles Thema zu entwerfen, mussten wir einen Weg finden, E-Mails mit benutzerdefinierten Formatierungen abzudunkeln - und das taten wir auch.  Zuerst haben wir zwei einfache, reine CSS-L√∂sungen ausprobiert - √úberschreiben von Stilen und Verwenden eines CSS-Filters.  Keiner von beiden traf ins Schwarze: Der erste war zu hart f√ºr das urspr√ºngliche Design, und der andere funktionierte einfach nicht gut.  Am Ende haben wir uns f√ºr die adaptive Verdunkelung entschieden.  Wir nehmen die Stile auseinander, ersetzen die Farben und setzen sie wieder zusammen.  Wir arbeiten derzeit daran, das dunkle Thema auf Bilder anzuwenden.  Dazu m√ºssen wir ihren Inhalt analysieren und dann nur einige davon anpassen. </p><br><p>  Wenn Sie jemals die Farbe von benutzerdefinierten HTML-Snipets √§ndern m√ºssen, um sie in ein dunkles Thema einzuf√ºgen, sollten Sie drei Methoden ber√ºcksichtigen: </p><br><ul><li>  Stile √ºberschreiben.  Es ist eine unkomplizierte, keine Muss-Methode, und Sie werden sie sowieso f√ºr Ihre Anwendung ben√∂tigen.  Die schlechte Nachricht ist, dass alle Originalfarben zerst√∂rt werden. </li><li>  CSS-Filter.  Es macht Spa√ü, l√§sst aber zu w√ºnschen √ºbrig.  Reservieren Sie es f√ºr Elemente, auf die nicht einfach zugegriffen werden kann, z. B. Frames oder Webkomponenten. </li><li>  Stilumschreibung.  Diese Methode macht einen guten Job beim Abdunkeln, ist aber komplexer. </li></ul><br><p>  Selbst wenn Sie nichts davon ausprobieren, hoffe ich, dass Sie viel Spa√ü beim Lesen dieses Artikels hatten! </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de450032/">https://habr.com/ru/post/de450032/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de450020/index.html">Silicon Valley kam zu Schulkindern aus Kansas. Dies f√ºhrte zu Protesten.</a></li>
<li><a href="../de450024/index.html">Informationen zu Open-Source-Implementierungen der Hash-Funktion GOST R 34.11-2012 und deren Auswirkungen auf die elektronische Signatur von GOST R 34.10-2012</a></li>
<li><a href="../de450026/index.html">Beschleunigungsverschl√ºsselung: Wir untersuchen den Beschleunigungsmesser eines Android-Ger√§ts am Beispiel der Aufgabe NeoQUEST-2019</a></li>
<li><a href="../de450028/index.html">Aufbau einer serviceorientierten Architektur auf Schienen + Kafka</a></li>
<li><a href="../de450030/index.html">Ich kann Rift S nicht verwenden und Sie werden es auch nicht schaffen</a></li>
<li><a href="../de450034/index.html">Warum sollten Sie an Hackathons teilnehmen?</a></li>
<li><a href="../de450036/index.html">Summ3r 0f h4ck: Praktikum Digital Security 2019</a></li>
<li><a href="../de450040/index.html">Neues Unternehmen wird OpenJDK 8 und 11 unterst√ºtzen - wir verstehen die Situation</a></li>
<li><a href="../de450042/index.html">Russisches erweitertes Tastaturlayout</a></li>
<li><a href="../de450044/index.html">Auf der Suche nach einem Problem am falschen Ort</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>