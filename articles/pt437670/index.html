<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üêª üì¨ üîä Atualiza√ß√µes de back-end do MSVC no Visual Studio 2019 Preview 2: Novas otimiza√ß√µes, OpenMP e melhorias na taxa de compila√ß√£o üé§ ü§≤üèº üéÑ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="No Visual Studio 2019 Preview 2, continuamos aprimorando o back-end do C ++ com novos recursos, otimiza√ß√µes novas e aprimoradas, aprimoramentos de pro...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Atualiza√ß√µes de back-end do MSVC no Visual Studio 2019 Preview 2: Novas otimiza√ß√µes, OpenMP e melhorias na taxa de compila√ß√£o</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/microsoft/blog/437670/"><img width="140" align="left" src="https://habrastorage.org/webt/gq/ke/xi/gqkexi_dekwffzpjqtx04zp7ee8.png"><br><p>  No Visual Studio 2019 Preview 2, continuamos aprimorando o back-end do C ++ com novos recursos, otimiza√ß√µes novas e aprimoradas, aprimoramentos de produ√ß√£o e altera√ß√µes na qualidade de vida. </p><a name="habracut"></a><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Original no blog</a> <br><br><h3>  Novos recursos </h3><br><ul><li>  Adicionada uma nova op√ß√£o de linha de comando embutida: -Ob3.  -Ob3 √© uma vers√£o mais agressiva do -O2.  -O2 (otimizar o bin√°rio para velocidade) ainda implica -Ob2 por padr√£o, mas isso pode mudar no futuro.  Se voc√™ achar que o compilador est√° sublinhado, considere passar -O2 -Ob3. </li><li>  Adicionado suporte b√°sico √† vetoriza√ß√£o OpenMP SIMD, que √© o recurso OpenMP mais amplamente usado nas bibliotecas de aprendizado de m√°quina (ML).  Nosso estudo de caso √© a biblioteca Intel MKL-DNN, usada como base para outras bibliotecas ML de c√≥digo aberto conhecidas, incluindo o Tensor Flow.  Isso pode ser ativado com um novo comutador CL -openmp: experimental.  Isso permite que os loops anotados com "#pragma omp simd" sejam potencialmente vetorizados.  A vetoriza√ß√£o n√£o √© garantida e os loops anotados, mas n√£o vetorizados, receber√£o um aviso relatado.  N√£o h√° suporte para cl√°usulas SIMD, elas ser√£o simplesmente ignoradas com um aviso relatado. </li><li>  Adicionado um novo manipulador de exce√ß√£o C ++ __CxxFrameHandler4 que reduz a sobrecarga de metadados de manipula√ß√£o de exce√ß√£o em 66%.  Isso fornece uma melhoria total de at√© 15% no tamanho bin√°rio em bin√°rios que usam grandes quantidades de manipula√ß√£o de exce√ß√£o em C ++.  Atualmente desativado, tente test√°-lo passando ‚Äú/ d2FH4‚Äù ao compilar com o cl.exe.  Observe que / d2FH4 √© de outro modo n√£o documentado e sem suporte a longo prazo.  No momento, isso n√£o √© suportado em aplicativos UWP, pois o tempo de execu√ß√£o UWP ainda n√£o possui esse recurso. </li><li>  Para oferecer suporte √† vetoriza√ß√£o manual de loops contendo chamadas para fun√ß√µes da biblioteca matem√°tica e certas outras opera√ß√µes como divis√£o inteira, o MSVC agora suporta fun√ß√µes intr√≠nsecas da SVML (Short Vector Math Library) que calculam os equivalentes de vetores.  O suporte para vetores de 128, 256 e 512 bits est√° dispon√≠vel para a maioria das fun√ß√µes, com as exce√ß√µes listadas abaixo.  Observe que essas fun√ß√µes n√£o configuram errno.  Consulte o Intel Intrinsic Guide para obter defini√ß√µes das fun√ß√µes suportadas. <br>  As exce√ß√µes incluem: <br><ul><li>  A divis√£o e o restante combinados de n√∫meros inteiros de vetores est√£o dispon√≠veis apenas para elementos de 32 bits e comprimentos de vetor de 128 e 256 bits.  Use fun√ß√µes separadas de divis√£o e restante para outros tamanhos de elemento e comprimentos de vetor. </li><li>  A raiz quadrada SVML est√° dispon√≠vel apenas nos comprimentos de vetor de 128 e 256 bits.  Voc√™ pode usar as fun√ß√µes <em>_mm512_sqrt_pd</em> ou <em>_mm512_sqrt_ps</em> para vetores de 512 bits. </li><li>  Apenas vers√µes vetoriais de 512 bits das fun√ß√µes <em>rint</em> e <em>nearbyint</em> est√£o dispon√≠veis.  Em muitos casos, voc√™ pode usar fun√ß√µes redondas, por exemplo, use <em>_mm256_round_ps (x, _MM_FROUND_CUR_DIRECTION)</em> como uma vers√£o vetorial de <em>rint de</em> 256 bits ou <em>_mm256_round_ps (x, _MM_FROUND_TO_NEAREST_INT)</em> <em>paraintint</em> nas <em>proximidades</em> . </li><li>  Somente rec√≠proco de 512 bits √© fornecido.  Voc√™ pode calcular o equivalente usando as fun√ß√µes set1 e div, por exemplo, rec√≠proco de 256 bits pode ser calculado como <em>_mm256_div_ps (_mm256_set1_ps (1.0f), (x))</em> . </li><li>  Existem fun√ß√µes SVML para raiz quadrada complexa de precis√£o √∫nica, logaritmo e exponencia√ß√£o apenas em comprimentos vetoriais de 128 e 256 bits. </li></ul></li></ul><br><h3>  Otimiza√ß√µes novas e aprimoradas </h3><br><ul><li>  Memsets desenrolados e inicializa√ß√µes de bloco agora usar√£o instru√ß√µes SSE2 (ou instru√ß√µes AVX, se permitido).  O limite de tamanho para o que ser√° desenrolado aumentou de acordo (compile para tamanho com SSE2: o limite de desenrolamento se move de 31 para 63 bytes, compile para velocidade com SSE2: limite se move de 79 para 159 bytes). </li><li>  Otimizou a gera√ß√£o de c√≥digo para pequenos conjuntos de mems, direcionados principalmente para fun√ß√µes <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">protegidas</a> por <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">initall</a> . </li><li>  Melhorias na elimina√ß√£o redundante de armazenamento do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">SSA Optimizer</a> : melhor an√°lise de escape e manipula√ß√£o de loops </li><li>  O compilador reconhece memmove () como uma fun√ß√£o intr√≠nseca e otimiza de acordo.  Isso melhora a gera√ß√£o de c√≥digo para opera√ß√µes criadas no memmove (), incluindo std :: copy () e outro c√≥digo de biblioteca de n√≠vel superior, como constru√ß√£o std :: vector e std :: string </li><li>  O otimizador faz um trabalho melhor ao otimizar opera√ß√µes curtas e de comprimento fixo memmove (), memcpy () e memcmp (). </li><li>  Implementa√ß√£o da otimiza√ß√£o de duplica√ß√£o de comutadores para melhor desempenho dos comutadores dentro de hot loops.  Duplicamos os saltos do comutador para ajudar a melhorar a precis√£o da previs√£o de ramifica√ß√£o e, consequentemente, o desempenho do tempo de execu√ß√£o. </li><li>  Adicionadas simplifica√ß√µes aritm√©ticas e dobragem constante para express√µes usando SIMD (vetor) intr√≠nseco, para formas flutuantes e inteiras.  A maioria das otimiza√ß√µes de express√£o usuais agora lida com intr√≠nsecas SSE2 e AVX2, a partir do c√≥digo do usu√°rio ou como resultado da vetoriza√ß√£o autom√°tica. </li><li> V√°rios novos padr√µes escalares de adi√ß√£o m√∫ltipla combinada (FMA) s√£o identificados com / arch: AVX2 / fp: fast.  Isso inclui as seguintes express√µes comuns: <code>(x + 1.0) * y; (x ‚Äì 1.0) * y; (1.0 ‚Äì x) * y; (-1.0 ‚Äì x) * y</code> <code>(x + 1.0) * y; (x ‚Äì 1.0) * y; (1.0 ‚Äì x) * y; (-1.0 ‚Äì x) * y</code> </li><li>  Sequ√™ncias de c√≥digo que inicializam um valor __m128 SIMD (vetor) elemento por elemento s√£o identificadas e substitu√≠das por um <em>_mm_set_ps</em> intr√≠nseco.  Isso permite que as novas otimiza√ß√µes do SIMD considerem o valor como parte das express√µes, √∫til principalmente se o valor tiver apenas elementos constantes.  Uma atualiza√ß√£o futura suportar√° mais tipos de valor. </li><li>  A elimina√ß√£o de subexpress√£o comum (ECE) √© mais eficaz na presen√ßa de vari√°veis ‚Äã‚Äãque podem ser modificadas de maneira indireta, porque o endere√ßo √© utilizado. </li><li>  C√≥pias de estrutura / classe in√∫teis est√£o sendo removidas em v√°rios outros casos, incluindo c√≥pias para par√¢metros e fun√ß√µes de sa√≠da que retornam um objeto.  Essa otimiza√ß√£o √© especialmente eficaz em programas C ++ que transmitem objetos por valor. </li><li>  Adicionada uma an√°lise mais poderosa para extrair informa√ß√µes sobre vari√°veis ‚Äã‚Äãdo fluxo de controle (instru√ß√µes if / else / switch), usadas para remover ramifica√ß√µes que podem ser sempre verdadeiras ou falsas e para melhorar a estimativa do intervalo vari√°vel.  O c√≥digo usando gsl :: span v√™ melhorias, algumas verifica√ß√µes de intervalo desnecess√°rias est√£o sendo removidas. </li><li>  A otimiza√ß√£o da destirtualiza√ß√£o agora ter√° oportunidades adicionais, como quando as classes s√£o definidas em namespaces an√¥nimos. </li></ul><br><h3>  Construir melhorias na taxa de transfer√™ncia </h3><br><ul><li>  Filtre as informa√ß√µes de depura√ß√£o durante a compila√ß√£o com base nos s√≠mbolos e tipos referenciados para reduzir o tamanho da se√ß√£o de depura√ß√£o e melhorar o rendimento do vinculador.  A atualiza√ß√£o de 15.9 para 16.0 pode reduzir o tamanho da entrada para o vinculador em at√© 40%. </li><li>  Melhorias no tempo do link na fus√£o e cria√ß√£o do tipo PDB. </li><li>  A atualiza√ß√£o para 16.0 a partir de 15.9 pode melhorar o tempo de link em at√© uma velocidade de 2X.  Por exemplo, a vincula√ß√£o do Chrome resultou em uma acelera√ß√£o do tempo do link 1,75X ao usar / DEBUG: full e uma acelera√ß√£o do tempo do link 1,4X no uso do / link r√°pido / DEBUG :. </li></ul><br><h3>  Melhorias na Qualidade de Vida </h3><br><ul><li>  O compilador exibe nomes e caminhos de arquivos usando o revestimento fornecido pelo usu√°rio, onde anteriormente o compilador exibia nomes e caminhos de arquivos com letras min√∫sculas. </li><li>  O novo vinculador agora reportar√° s√≠mbolos potencialmente correspondentes para s√≠mbolos n√£o resolvidos, como: </li></ul><br><pre> <code class="cpp hljs">main.obj : error LNK2019: unresolved external symbol _foo referenced in function _main Hint on symbols that are defined <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> could potentially match: <span class="hljs-string"><span class="hljs-string">"int __cdecl foo(int)"</span></span> (?foo@@YAHH@Z) <span class="hljs-string"><span class="hljs-string">"bool __cdecl foo(double)"</span></span> (?foo@@YA_NN@Z) @foo@<span class="hljs-number"><span class="hljs-number">0</span></span> foo@@<span class="hljs-number"><span class="hljs-number">4</span></span> main.exe : fatal error LNK1120: <span class="hljs-number"><span class="hljs-number">1</span></span> unresolved externals</code> </pre> <ul><li>  Ao gerar uma biblioteca est√°tica, n√£o √© mais necess√°rio passar o sinalizador / LTCG para LIB.exe. </li><li>  Adicionada uma op√ß√£o de vinculador / LINKREPROTARGET: [binary_name] para gerar apenas uma reprodu√ß√£o de link para o bin√°rio especificado.  Isso permite que% LINK_REPRO% ou / LINKREPRO: [directory_name] seja definido em uma compila√ß√£o grande com v√°rios v√≠nculos, e o vinculador gerar√° apenas a reprodu√ß√£o do bin√°rio especificado em / linkreprotarget. </li></ul><br><p>  Adorar√≠amos que voc√™ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">baixasse o Visual Studio 2019</a> e experimente.  Como sempre, agradecemos seus coment√°rios.  Podemos ser contatados pelos coment√°rios abaixo ou por e-mail ( <a href="">visualcpp@microsoft.com</a> ).  Se voc√™ encontrar problemas com o Visual Studio ou MSVC ou tiver uma sugest√£o para n√≥s, informe-nos atrav√©s de <strong>Ajuda&gt; Enviar coment√°rios&gt; Relatar um problema / Fornecer uma sugest√£o</strong> no produto ou na <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Comunidade de desenvolvedores</a> .  Voc√™ tamb√©m pode encontrar-nos no Twitter ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">@VisualC</a> ) e no Facebook (msftvisualcpp). </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt437670/">https://habr.com/ru/post/pt437670/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt437656/index.html">Elefante em uma loja de porcelana: impressoras 3D com um enorme campo de impress√£o</a></li>
<li><a href="../pt437658/index.html">Guia: Thymeleaf + Spring. Parte 3</a></li>
<li><a href="../pt437660/index.html">Atualiza√ß√£o do perfil vital√≠cio no Visual Studio 2019 Preview 2</a></li>
<li><a href="../pt437664/index.html">Recupera√ß√£o composta</a></li>
<li><a href="../pt437666/index.html">Anunciando a visualiza√ß√£o do F # 4.6</a></li>
<li><a href="../pt437672/index.html">cyberd: computando o conhecimento da web3</a></li>
<li><a href="../pt437674/index.html">M√©todos de reconhecimento de objetos 3D para ve√≠culos n√£o tripulados. Relat√≥rio Yandex</a></li>
<li><a href="../pt437676/index.html">Universidades e aceleradores corporativos como alavanca para lan√ßar startups B2B nos EUA</a></li>
<li><a href="../pt437680/index.html">Minha cole√ß√£o DIY no Youtube</a></li>
<li><a href="../pt437682/index.html">Escrevendo mais uma ferramenta de modelagem do Kubernetes</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>