<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧑🏿‍🤝‍🧑🏿 🌩️ 🕙 Membuat arsitektur: bekerja dengan pola Koordinator iOS 🤞🏿 💮 👨🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="( Ilustrasi ) 

 Setiap tim cepat atau lambat mulai berpikir untuk memperkenalkan pendekatan arsitekturalnya sendiri, dan banyak salinannya dipecahkan...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Membuat arsitektur: bekerja dengan pola Koordinator iOS</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/umbrellaitcom/blog/426507/"><img src="https://habrastorage.org/webt/3s/ap/0w/3sap0w70jyzre12wi-c8r9132l4.png"><br>  ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><i>Ilustrasi</i></a> ) <br><br>  Setiap tim cepat atau lambat mulai berpikir untuk memperkenalkan pendekatan arsitekturalnya sendiri, dan banyak salinannya dipecahkan.  Jadi di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Umbrella IT kami</a> selalu ingin bekerja dengan alat yang fleksibel sehingga pembentukan arsitektur bukanlah sesuatu yang menyakitkan, dan masalah navigasi, file tiruan, isolasi dan pengujian berhenti menjadi sesuatu yang menakutkan, sesuatu yang cepat atau lambat menggantung proyek yang ditumbuhi.  Untungnya, kita tidak berbicara tentang arsitektur "eksklusif" baru dengan singkatan yang megah.  Saya harus mengakui bahwa arsitektur yang saat ini populer (MVP, MVVM, VIPER, Clean-swift) mengatasi tugas-tugas mereka, dan hanya pilihan yang salah dan penggunaan yang salah dari pendekatan ini atau itu yang dapat menyebabkan kesulitan.  Namun, dalam kerangka arsitektur yang diadopsi, berbagai pola dapat digunakan, yang akan memungkinkan mencapai indikator yang hampir mitos tersebut: fleksibilitas, isolasi, testabilitas, penggunaan kembali. <a name="habracut"></a><br><br>  Tentu saja, aplikasi berbeda.  Jika suatu proyek hanya berisi beberapa layar yang terhubung secara seri, maka tidak ada kebutuhan khusus untuk interaksi yang kompleks antar modul.  Hal ini dimungkinkan untuk dilakukan dengan koneksi segue biasa, bumbu semua ini dengan MVC / MVP lama yang baik.  Dan meskipun keangkuhan arsitektur cepat atau lambat mengalahkan setiap pengembang, masih implementasi harus sepadan dengan tujuan dan kompleksitas proyek.  Jadi, jika proyek melibatkan struktur layar yang kompleks dan berbagai status (otorisasi, mode tamu, offline, peran untuk pengguna, dll.), Maka pendekatan yang disederhanakan untuk arsitektur tentu akan memainkan trik: banyak dependensi, transfer data yang tidak jelas dan mahal antara layar dan status, masalah dengan navigasi dan yang paling penting - semua ini tidak akan memiliki fleksibilitas dan penggunaan kembali, solusi akan dicairkan dengan ketat ke dalam proyek dan layar A akan selalu membuka layar B. Upaya untuk membuat perubahan akan mengarah ke refaktor yang menyakitkan  ngam selama itu sangat mudah untuk membuat kesalahan dan merusak apa yang dulu bekerja.  Pada contoh di bawah ini, kami akan menjelaskan cara fleksibel untuk mengatur aplikasi yang memiliki dua status: pengguna tidak diotorisasi dan harus diarahkan ke layar otorisasi, pengguna diotorisasi dan layar Utama tertentu harus dibuka. <br><br><h1>  <b>1. Implementasi protokol utama</b> </h1><br>  Pertama kita perlu mengimplementasikan basis.  Semuanya dimulai dengan protokol yang Dapat Dikoordinasikan, Dapat Datang, dan Dapat Dirute: <br><br><pre><code class="hljs swift"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">protocol</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Coordinatable</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">start</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">protocol</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Presentable</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> toPresent: <span class="hljs-type"><span class="hljs-type">UIViewController?</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> } } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extension</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UIViewController</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Presentable</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> toPresent: <span class="hljs-type"><span class="hljs-type">UIViewController?</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span> } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">showAlert</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(title: String, message: String? = </span></span><span class="hljs-literal"><span class="hljs-function"><span class="hljs-params"><span class="hljs-literal">nil</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { <span class="hljs-type"><span class="hljs-type">UIAlertController</span></span>.showAlert(title: title, message: message, inViewController: <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>, actionBlock: <span class="hljs-literal"><span class="hljs-literal">nil</span></span>) } }</code> </pre> <br>  <i>Dalam contoh ini, showAlert hanyalah metode yang mudah untuk memanggil notifikasi, yang ada dalam ekstensi UIViewController.</i> <br><br><pre> <code class="hljs swift"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">protocol</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Routable</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Presentable</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">present</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> module: Presentable?)</span></span></span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">present</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> module: Presentable?, animated: Bool)</span></span></span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">push</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> module: Presentable?)</span></span></span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">push</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> module: Presentable?, animated: Bool)</span></span></span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">push</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> module: Presentable?, animated: Bool, completion: CompletionBlock?)</span></span></span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">popModule</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">popModule</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(animated: Bool)</span></span></span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dismissModule</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dismissModule</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(animated: Bool, completion: CompletionBlock?)</span></span></span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setRootModule</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> module: Presentable?)</span></span></span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setRootModule</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> module: Presentable?, hideBar: Bool)</span></span></span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">popToRootModule</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(animated: Bool)</span></span></span></span> }</code> </pre> <br><h1>  <b>2. Buat koordinator</b> </h1><br>  Dari waktu ke waktu, ada kebutuhan untuk mengubah layar aplikasi, yang berarti akan perlu untuk mengimplementasikan lapisan yang diuji tanpa downcast, serta tanpa melanggar prinsip-prinsip SOLID. <br><br>  Kami melanjutkan ke implementasi layer koordinat: <br><br><img src="https://habrastorage.org/webt/iw/og/ya/iwogyacswjrawufbwtijmp9mbp0.jpeg"><br><br>  Setelah memulai aplikasi, metode AppCoordinator harus dipanggil, yang menentukan aliran mana yang harus dimulai.  Misalnya, jika pengguna terdaftar, maka Anda harus menjalankan aplikasi aliran, dan jika tidak, maka otorisasi mengalir.  Dalam hal ini, Koordinator Utama dan Koordinator Otorisasi diperlukan.  Kami akan menjelaskan koordinator untuk otorisasi, semua layar lain dapat dibuat dengan cara yang sama. <br><br>  Pertama, Anda perlu menambahkan output ke koordinator sehingga ia dapat memiliki koneksi dengan koordinator yang lebih tinggi (AppCoordinator): <br><br><pre> <code class="hljs swift"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">protocol</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AuthorizationCoordinatorOutput</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> finishFlow: <span class="hljs-type"><span class="hljs-type">CompletionBlock?</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> } } <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AuthorizationCoordinator</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BaseCoordinator</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AuthorizationCoordinatorOutput</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> finishFlow: <span class="hljs-type"><span class="hljs-type">CompletionBlock?</span></span> <span class="hljs-keyword"><span class="hljs-keyword">fileprivate</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> factory: <span class="hljs-type"><span class="hljs-type">AuthorizationFactoryProtocol</span></span> <span class="hljs-keyword"><span class="hljs-keyword">fileprivate</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> router : <span class="hljs-type"><span class="hljs-type">Routable</span></span> <span class="hljs-keyword"><span class="hljs-keyword">init</span></span>(router: <span class="hljs-type"><span class="hljs-type">Routable</span></span>, factory: <span class="hljs-type"><span class="hljs-type">AuthorizationFactoryProtocol</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.router = router <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.factory = factory } } <span class="hljs-comment"><span class="hljs-comment">// MARK:- Coordinatable extension AuthorizationCoordinator: Coordinatable { func start() { performFlow() } } // MARK:- Private methods private extension AuthorizationCoordinator { func performFlow() { //:- Will implement later } }</span></span></code> </pre> <br><br><img src="https://habrastorage.org/webt/dd/gt/fj/ddgtfjhqknwgahfd2dtbpffvice.jpeg"><br>  Seperti yang ditunjukkan di atas, kami memiliki koordinator Otorisasi dengan router dan pabrik modul.  Tetapi siapa dan kapan memanggil metode start ()? <br>  Di sini kita perlu mengimplementasikan AppCoordinator. <br><br><pre> <code class="hljs powershell">final <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AppCoordinator</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BaseCoordinator</span></span></span></span> { fileprivate let factory: CoordinatorFactoryProtocol fileprivate let router : Routable fileprivate let gateway = Gateway() init(router: Routable, factory: CoordinatorFactory) { self.router = router self.factory = factory } } // MARK:- Coordinatable extension AppCoordinator: Coordinatable { func start() { self.gateway.getState { [<span class="hljs-type"><span class="hljs-type">unowned</span></span> <span class="hljs-type"><span class="hljs-type">self</span></span>] (state) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> state { case .authorization: self.performAuthorizationFlow() case .main: self.performMainFlow() } } } } // MARK:- Private methods func performAuthorizationFlow() { let coordinator = factory.makeAuthorizationCoordinator(with: router) coordinator.finishFlow = { [<span class="hljs-type"><span class="hljs-type">weak</span></span> <span class="hljs-type"><span class="hljs-type">self</span></span>, <span class="hljs-type"><span class="hljs-type">weak</span></span> <span class="hljs-type"><span class="hljs-type">coordinator</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> guard let `self` = self, let `coordinator` = coordinator <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> } self.removeDependency(coordinator) self.start() } addDependency(coordinator) coordinator.start() } func performMainFlow() { // MARK:- main flow logic }</code> </pre><br>  Dari contoh, Anda dapat melihat bahwa AppCoordinator memiliki router, pabrik koordinator, dan status titik masuk untuk AppCoordinator, yang perannya menentukan awal aliran aplikasi. <br><br><pre> <code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CoordinatorFactory</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">fileprivate</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> modulesFactory = <span class="hljs-type"><span class="hljs-type">ModulesFactory</span></span>() } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extension</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CoordinatorFactory</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CoordinatorFactoryProtocol</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">makeAuthorizationCoordinator</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(with router: Routable)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Coordinatable</span></span> &amp; <span class="hljs-type"><span class="hljs-type">AuthorizationCoordinatorOutput</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-type"><span class="hljs-type">AuthorizationCoordinator</span></span>(router: router, factory: modulesFactory) } }</code> </pre> <br><h1>  <b>3. Implementasi koordinator pabrik</b> </h1><br>  Masing-masing koordinator diinisialisasi dengan router dan pabrik modul.  Selain itu, masing-masing koordinator harus mewarisi dari koordinator pangkalan: <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">class</span></span> BaseCoordinator { var childCoordinators: [Coordinatable] = [] // <span class="hljs-keyword"><span class="hljs-keyword">Add</span></span> <span class="hljs-keyword"><span class="hljs-keyword">only</span></span> <span class="hljs-keyword"><span class="hljs-keyword">unique</span></span> <span class="hljs-keyword"><span class="hljs-keyword">object</span></span> func addDependency(_ coordinator: Coordinatable) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> element <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> childCoordinators { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> element === coordinator { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> } } childCoordinators.append(coordinator) } func removeDependency(_ coordinator: Coordinatable?) { guard childCoordinators.isEmpty == <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, let coordinator = coordinator <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">index</span></span>, element) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> childCoordinators.enumerated() { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> element === coordinator { childCoordinators.remove(at: <span class="hljs-keyword"><span class="hljs-keyword">index</span></span>) break } } } }</code> </pre> <br>  BaseCoordinator - kelas yang berisi larik koordinator anak dan dua metode: Hapus dan Tambahkan ketergantungan koordinator. <br><br><h1>  <b>4. Mengkonfigurasi AppDelegate</b> </h1><br>  Sekarang mari kita lihat seperti apa tampilan <b>UIAplatformMain:</b> <br><br><pre> <code class="hljs swift"><span class="hljs-meta"><span class="hljs-meta">@UIApplicationMain</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AppDelegate</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UIResponder</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UIApplicationDelegate</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> window: <span class="hljs-type"><span class="hljs-type">UIWindow?</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> rootController: <span class="hljs-type"><span class="hljs-type">UINavigationController</span></span> { window?.rootViewController = <span class="hljs-type"><span class="hljs-type">UINavigationController</span></span>() window?.rootViewController?.view.backgroundColor = .white <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> window?.rootViewController <span class="hljs-keyword"><span class="hljs-keyword">as</span></span>! <span class="hljs-type"><span class="hljs-type">UINavigationController</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">fileprivate</span></span> <span class="hljs-built_in"><span class="hljs-built_in">lazy</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> coordinator: <span class="hljs-type"><span class="hljs-type">Coordinatable</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.makeCoordinator() <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">application</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplicationLaunchOptionsKey: </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">Any</span></span></span></span><span class="hljs-function"><span class="hljs-params">]?)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Bool</span></span> { coordinator.start() <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span> } } <span class="hljs-comment"><span class="hljs-comment">// MARK:- Private methods private extension AppDelegate { func makeCoordinator() -&gt; Coordinatable { return AppCoordinator(router: Router(rootController: rootController), factory: CoordinatorFactory()) } }</span></span></code> </pre> <br>  Segera setelah metode delegasi didFinishLaunchingWithOptions dipanggil, metode start () dari AppCoordinator dipanggil, yang akan menentukan logika aplikasi selanjutnya. <br><br><h1>  <b>5. Membuat modul layar</b> </h1><br>  Untuk menunjukkan apa yang terjadi selanjutnya, mari kita kembali ke AuthorizationCoordinator dan mengimplementasikan metode performFlow (). <br><br>  Pertama, kita perlu mengimplementasikan antarmuka AuthorizationFactoryProtocol di kelas ModulesFactory: <br><br><pre> <code class="hljs pgsql">final <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> ModulesFactory {} // MARK:- AuthorizationFactoryProtocol <span class="hljs-keyword"><span class="hljs-keyword">extension</span></span> ModulesFactory: AuthorizationFactoryProtocol { func makeEnterView() -&gt; EnterViewProtocol { let <span class="hljs-keyword"><span class="hljs-keyword">view</span></span>: EnterViewController = EnterViewController.controllerFromStoryboard(.<span class="hljs-keyword"><span class="hljs-keyword">authorization</span></span>) EnterAssembly.assembly(<span class="hljs-keyword"><span class="hljs-keyword">with</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">view</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">view</span></span></code> </pre> <br>  Dengan memanggil metode apa pun di pabrik modul, sebagai aturan, kami bermaksud menginisialisasi ViewController dari storyboard, dan kemudian menautkan semua komponen yang diperlukan dari modul ini dalam arsitektur tertentu (MVP, MVVM, CleanSwift). <br><br>  Setelah persiapan yang diperlukan, kita dapat menerapkan metode performFlow () dari AuthorizationCoordinator. <br>  Layar mulai dalam koordinator ini adalah EnterView. <br>  Dalam metode performFlow (), menggunakan pabrik modul, pembuatan modul yang sudah jadi untuk koordinator yang diberikan disebut, kemudian logika pemrosesan penutupan yang dipanggil oleh pengontrol tampilan kami pada satu waktu atau yang lain diimplementasikan, maka modul ini diatur oleh router sebagai root di tumpukan navigasi layar: <br><br><pre> <code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extension</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AuthorizationCoordinator</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">performFlow</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> enterView = factory.makeEnterView() finishFlow = enterView.onCompleteAuthorization enterView.output?.onAlert = { [<span class="hljs-keyword"><span class="hljs-keyword">unowned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>] (message: <span class="hljs-type"><span class="hljs-type">String</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.router.toPresent?.showAlert(message: message) } router.setRootModule(enterView) } }</code> </pre> <br><br><img src="https://habrastorage.org/webt/j-/og/t9/j-ogt9bti0cndmozt4znuly95sk.jpeg"><br><br>  Terlepas dari kompleksitas yang tampak di beberapa tempat, pola ini sangat ideal untuk bekerja dengan file tiruan, memungkinkan Anda untuk sepenuhnya mengisolasi modul dari satu sama lain, dan juga mengabstraksi kami dari UIKit, yang sangat cocok untuk cakupan pengujian penuh.  Pada saat yang sama, Koordinator tidak memaksakan persyaratan yang ketat pada arsitektur aplikasi dan hanya merupakan tambahan yang nyaman, penataan navigasi, dependensi dan aliran data antar modul. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Tautan ke github</a> , yang berisi demo berdasarkan arsitektur Bersih dan Templat Xcode yang mudah digunakan untuk membuat lapisan arsitektur yang diperlukan. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id426507/">https://habr.com/ru/post/id426507/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id426497/index.html">Core CPU atau apa itu SMP dan apa yang dimakannya</a></li>
<li><a href="../id426499/index.html">Program pendidikan untuk bekerja dengan kartu punch (atau kisah tentang bagaimana "data besar" diproses dari tahun 1890 hingga 1970)</a></li>
<li><a href="../id426501/index.html">Lamoda dari dalam: mengapa toko online 300 insinyur</a></li>
<li><a href="../id426503/index.html">Fungsi SAP HANA sebagai basis data untuk SAP HANA Data Management Suite</a></li>
<li><a href="../id426505/index.html">Acara digital di Moskow dari 15 hingga 21 Oktober</a></li>
<li><a href="../id426509/index.html">Apa itu sistem informasi komputer</a></li>
<li><a href="../id426511/index.html">Contoh pendekatan proses: survei pra-proyek perusahaan industri. Contoh grafik BPMN</a></li>
<li><a href="../id426513/index.html">Membangun model proses ketika mengimplementasikan perangkat lunak</a></li>
<li><a href="../id426515/index.html">[Mikro-navigasi (mendorong mikro)] - mikro-animasi untuk mengubah perilaku pengguna</a></li>
<li><a href="../id426517/index.html">“Perpustakaan Anda, seperti anak Anda, dapat pergi ke arah yang tidak terduga untuk Anda”: ​​wawancara dengan pencipta MobX</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>