<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>  拣 Hackear medidores inteligentes en PHDays 8: an谩lisis del concurso MeterH3cker   </title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Este a帽o, el programa de competencia Positive Hack Days se ha reabastecido con la competencia para piratear elementos del sistema de red inteligente: ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Hackear medidores inteligentes en PHDays 8: an谩lisis del concurso MeterH3cker</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pt/blog/414557/"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><img src="https://habrastorage.org/getpro/habr/post_images/8c1/644/011/8c1644011798aca6c1886a379d7ad93b.png" alt="imagen"></a> <br><br>  Este a帽o, el programa de competencia Positive Hack Days se ha reabastecido con la competencia para piratear elementos del sistema de red inteligente: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">MeterH3cker</a> .  Los participantes ten铆an a su disposici贸n una maqueta de dos casas, seg煤n lo concebido por los organizadores, los paneles solares suministraban electricidad a las casas, y la energ铆a excedente que se generaba pod铆a venderse a la red el茅ctrica general a una tarifa especial.  La tarea de los atacantes era interrumpir el proceso normal de medici贸n de electricidad y afectar el saldo de caja en el sistema de facturaci贸n por cualquier medio posible. <a name="habracut"></a><br><br><h2>  Pararse </h2><br><img src="https://habrastorage.org/getpro/habr/post_images/382/1ab/0ae/3821ab0ae60f54a1581ea05096f5833b.jpg" alt="imagen"><br><br>  <i>Stand MeterH3cker</i> <br><br>  Las casas modernas equipadas con paneles solares pueden consumir electricidad y devolver el exceso de generaci贸n a la red.  Este modelo form贸 la base de la cabina MeterH3cker. <br><br>  El stand era un modelo de dos edificios residenciales modernos con equipos reales, que implementaron elementos de tecnolog铆a de red inteligente.  En cada casa, se instalaron controladores solares, medidores de electricidad inteligentes y consumidores de energ铆a.  Ambas casas estaban conectadas a un modelo de subestaci贸n el茅ctrica en la que se instal贸 un dispositivo de transmisi贸n y recolecci贸n de datos (DTD);  entrevist贸 los medidores y el medidor de subestaci贸n. <br><br>  Adem谩s, cada casa estaba equipada con un sistema de calefacci贸n y aire acondicionado, que estaba bajo el control general de un controlador disponible en la red general del stand.  Adem谩s, cerca de las casas inteligentes, se instal贸 una estaci贸n de carga real para veh铆culos el茅ctricos, que transmiti贸 a la USPD indicaciones de su consumo de electricidad para el veh铆culo el茅ctrico conectado. <br><br>  Establecimos los escenarios de d铆a y de noche.  En el modo "d铆a", los paneles solares en las casas generaban electricidad, y sus contadores giraban en la direcci贸n opuesta y tomaban en cuenta la energ铆a "consumida" y "dada".  Cada casa ten铆a su propia cuenta personal, cuyo saldo aument贸 durante la generaci贸n de energ铆a y disminuy贸 durante el consumo, y las tarifas configuradas en los medidores tambi茅n influyeron en los valores. <br><br>  La tarea principal de los participantes del concurso era aumentar el saldo de la cuenta personal de las casas atacando el equipo del stand, y as铆 obtener beneficios financieros directos de sus acciones de piratas inform谩ticos. <br><br>  Para visualizar los resultados, escribimos nuestro propio servidor de facturaci贸n, que recopilaba datos de USPD.  El propio USPD, a su vez, interrog贸 a los contadores de varias maneras: <br><br><ol><li>  mostrador en la casa No. 1 - de acuerdo con el protocolo abierto de tipo Modbus del vendedor; </li><li>  el dispositivo VR-007.3 interrog贸 al mostrador de la casa No. 2 utilizando el protocolo abierto tipo Modbus del proveedor, y luego el USPD recibi贸 datos del servidor web VR-007.3 a trav茅s de HTTP; </li><li>  medidor de subestaci贸n - de acuerdo con el protocolo Modbus TCP. </li></ol><br>  Para obtener valores reales de consumo de energ铆a, los medidores de referencia que no estaban disponibles para los atacantes se conectaron a los mismos circuitos de corriente y voltaje que los medidores atacados.  El servidor de facturaci贸n los encuest贸 directamente a trav茅s de la interfaz RS-485. <br><br>  Para permitir a los visitantes del foro observar lo que estaba sucediendo, se instal贸 un gran monitor cerca del stand, en el que se mostraban gr谩ficos de consumo de electricidad en tiempo real.  El gr谩fico azul marcaba las lecturas de la USPD.  Cambiaron dependiendo de las acciones de los atacantes.  El gr谩fico verde mostr贸 lecturas reales de la generaci贸n y el consumo de electricidad recopilados de medidores de referencia. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/fed/36b/e9e/fed36be9e3a8837882f01e700cbc60c3.png" alt="imagen"><br><br>  <i>Visualizaci贸n de los valores actuales de cada vivienda: saldo de cuenta personal, energ铆a consumida y entregada a la red, tarifa</i> <br><br>  Un portal interno para los participantes del concurso tambi茅n estaba disponible en la red del stand.  All铆, se mostraron los valores actuales de los gr谩ficos, una secci贸n con una descripci贸n de cada elemento del stand;  Las reglas del concurso fueron publicadas all铆 y de vez en cuando aparec铆an consejos. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/431/650/9fe/4316509fe0a3694cfd33f28b36bb259a.png" alt="imagen"><br><br>  <i>Portal interno</i> <br><br><h2>  T茅rminos de participaci贸n </h2><br>  La competencia se llev贸 a cabo durante dos d铆as.  El primer d铆a hubo competiciones clasificatorias.  Al conectarse a la red de stands, cada participante tuvo acceso a todos los equipos de dos casas, una subestaci贸n y una estaci贸n de carga.  Los participantes tuvieron la oportunidad de estudiar equipos, encontrar vulnerabilidades y posibles vectores de ataque.  Durante el d铆a, peri贸dicamente se agregaron nuevos consejos al portal interno de la competencia, lo que permiti贸 a los participantes detectar debilidades en el equipo del stand.  Los participantes que alcanzaron el 茅xito en el stand el primer d铆a fueron invitados a participar en el torneo final el segundo d铆a. <br><br>  La final fue una especie de duelo.  Dos participantes fueron invitados al stand, cada uno de los cuales ten铆a su propia casa.  Su tarea es enga帽ar a los contadores por cualquier medio durante una ronda de diez minutos y generar m谩s energ铆a que el enemigo: un vecino condicional.  El ganador fue el que ten铆a un mayor saldo de cuenta personal al final de la competencia.  Al mismo tiempo, la tarea se complic贸 por el hecho de que los participantes ten铆an acceso al equipo de los dem谩s, lo que significa que podr铆an da帽ar a su vecino y subestimar sus resultados. <br><br><h2>  D铆a uno: ronda clasificatoria </h2><br>  Hab铆a muchas personas que quer铆an probar suerte en piratear equipos.  Tenga en cuenta que algunos de ellos estaban seriamente preparados para la competencia y ten铆an el software necesario con ellos.  Entre ellos se encontraban participantes de Jap贸n, quienes desde las primeras horas de la competencia estudiaron cuidadosamente el stand, lo que les permiti贸 lograr resultados significativos en el segundo d铆a. <br><br>  Una gran sorpresa para nosotros fue la participaci贸n de un entusiasta de la pirater铆a de 12 a帽os: a pesar de su edad, pudo navegar por el equipo presentado y mostr贸 varios ataques. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/54e/004/621/54e0046211bf029f7cda68cfdb4e9d1f.jpg" alt="imagen"><br><br>  <i>Concursantes</i> <br><br>  Obtuvimos los primeros resultados a mitad del d铆a: los investigadores japoneses unieron fuerzas para tomar el control de la estaci贸n de carga de autom贸viles el茅ctricos y dejaron de cargar el autom贸vil el茅ctrico enviando comandos de control a trav茅s de una interfaz web.  Un poco m谩s tarde, pudieron obtener la contrase帽a del administrador del controlador solar y apagar la generaci贸n de electricidad. <br><br>  El joven hacker tampoco se qued贸 atr谩s de los adultos: aprendi贸 a provocar un reinicio continuo del USPD, implementando as铆 un ataque de denegaci贸n de servicio e interrumpi贸 la encuesta de los contadores. <br><br>  Hacia la noche, uno de los miembros del grupo japon茅s logr贸 serias desviaciones entre los valores de energ铆a en la referencia y los contadores atacados, aumentando considerablemente el valor del conteo.  Y su colega descubri贸 una vulnerabilidad en la interfaz web del contador de la subestaci贸n, que permiti贸 leer el contenido de los archivos de la tarjeta flash del dispositivo, uno de los cuales conten铆a un hash de contrase帽a de administrador.  Por lo tanto, despu茅s de seleccionar con 茅xito una contrase帽a, obtuvo acceso a los par谩metros del contador. <br><br>  Una hora antes del final de la ronda de clasificaci贸n, un participante llamado Oleg se uni贸 al stand.  A pesar de que le quedaba poco tiempo, logr贸 llevar a cabo un ataque exitoso y entrar en el torneo, que se celebr贸 al d铆a siguiente. <br><br>  Como resultado, al final del d铆a, todos los participantes podr铆an cambiar las lecturas de energ铆a en todos los medidores el茅ctricos disponibles y controlar varios elementos del soporte: controladores, una estaci贸n de carga. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/8c1/644/011/8c1644011798aca6c1886a379d7ad93b.png" alt="imagen"><br><br>  <i>Resultados de los ataques de los participantes contra los mostradores.</i>  <i>El gr谩fico inferior derecho muestra que el coeficiente de transformaci贸n del contador ha cambiado, y el gr谩fico inferior izquierdo muestra que se realiz贸 con 茅xito un ataque de denegaci贸n de servicio en el contador -4</i> <br><br><h2>  D铆a dos: torneo y final </h2><br>  Con base en los resultados de los informes enviados por los participantes al final del primer d铆a, seleccionamos a siete participantes que pudieron encontrar y explotar vulnerabilidades en el equipo del stand. <br><br>  Dado que el segundo d铆a, los participantes durante las rondas podr铆an influir en las lecturas no solo de sus contadores, sino tambi茅n del contador del vecino rival, cualquier negligencia podr铆a acarrear graves consecuencias.  Entonces, el participante Oleg, al realizar un ataque contra el equipo de un vecino, aument贸 err贸neamente el puntaje de su vecino, porque llev贸 a cabo el ataque en el momento de la generaci贸n, y luego no logr贸 "torcerlo" en la otra direcci贸n durante el tiempo restante de la ronda.  En las peleas posteriores, los participantes tomaron en cuenta esta triste experiencia y actuaron de manera competente, por ejemplo, establecieron los valores m谩ximos de los coeficientes de su contador durante el per铆odo de generaci贸n (modo "d铆a") y los m铆nimos durante el per铆odo de consumo (modo "noche"). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/cb7/5f0/43d/cb75f043da8d96831ba77d47ab75f569.png" alt="imagen"><br><br>  <i>Posiciones</i> <br><br>  Una batalla seria se desarroll贸 en la final de la competencia.  Al comienzo de la ronda, la ventaja fue para Satoru Takeksoshi, quien en los primeros minutos pudo llevar a cabo con 茅xito el ataque y aumentar considerablemente el saldo de su cuenta.  El segundo participante, Alexey Kuznetsov, tambi茅n pudo realizar un ataque al comienzo de la ronda y aumentar el saldo de su cuenta, pero en una cantidad mucho menor.  La brecha en las lecturas de energ铆a generada fue de 25 GW 路 h contra 5 GW 路 h.  Durante la mayor parte de la ronda, el puntaje no ha cambiado.  Probablemente, para no repetir la triste experiencia de los primeros participantes que atacaron en el momento equivocado, Alex se comport贸 con cautela y monitore贸 el cambio de reg铆menes.  En la segunda mitad de la ronda, logr贸 realizar un ataque exitoso en el medidor de la subestaci贸n el茅ctrica y hacer que la separaci贸n del vecino sea m铆nima, pero el puntaje total a煤n no le permiti贸 ganar.  En los 煤ltimos segundos, Alex volvi贸 a atacar su contador y aument贸 con 茅xito su testimonio, lo que le permiti贸 arrebatarle la victoria al l铆der.  Por lo tanto, Alexey gan贸, aumentando su saldo a 92 mil millones.  e., y dado su exitoso ataque al medidor de la subestaci贸n el茅ctrica, su puntaje total le permiti贸 ganar incondicionalmente. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/dad/440/f0e/dad440f0ec1b6875c49671dc3a8e2dd0.png" alt="imagen"><br><br>  <i>El estado de las cuentas personales en los 煤ltimos segundos despu茅s del ataque final.</i> <br><br><h2>  Resumen </h2><br>  Entonces, los ganadores: el primer lugar fue ocupado por Alexei Kuznetsov, el segundo lugar fue para Satoru Takekoshi, Nikita Stupin cerr贸 los tres primeros.  El premio especial, por el 4to lugar, fue recibido por el joven cracker Yuri Grishin. <br><br>  Durante la competencia (especialmente en el torneo final) se demostraron ataques completamente diferentes.  La mayor铆a de los participantes intentaron realizar ataques a las lecturas de energ铆a tomadas de los medidores, aumentar la producci贸n de energ铆a en el momento de la generaci贸n y reducirla en el momento del consumo.  Adem谩s, en algunas rondas, los competidores atacaron con 茅xito la estaci贸n de carga para el autom贸vil el茅ctrico y el controlador solar. <br><br>  Sin embargo, ninguno de los participantes pudo realizar ataques exitosos contra USPD y reemplazar los datos recopilados directamente en 茅l.  Potencialmente, estos ataques podr铆an llevar a un control completo de los datos transmitidos al centro de facturaci贸n y aumentar su cuenta por un valor arbitrario.  Durante los dos d铆as, registramos solo uno de esos intentos de ataque, que, aparentemente, termin贸 en fracaso. <br><br>  Adem谩s, nadie atac贸 el controlador que controla el sistema de calefacci贸n y aire acondicionado.  Se supon铆a que el atacante se conectar铆a al dispositivo y podr铆a controlar el equipo utilizando las se帽ales de control existentes.  La principal dificultad para los atacantes fue comparar los puertos abiertos y el nombre del equipo, por ejemplo, para solicitar informaci贸n utilizando el protocolo FOX.  No fue necesario utilizar software especializado para atacar este equipo.  La sugerencia tampoco ayud贸, porque los atacantes no la usaron, y todo lo que se necesitaba era reemplazar el encabezado User-Agent en su navegador para una conexi贸n exitosa. <br><br>  De otras observaciones.  Durante la competencia, los concursantes hicieron muchas preguntas aclaratorias sobre la estructura y el funcionamiento del stand, as铆 como sobre los dispositivos disponibles.  Esto puede explicarse por el hecho de que, adem谩s de la tarea de "romper" los dispositivos, era necesario descubrir qu茅 hace cada uno de ellos y c贸mo explotar sus vulnerabilidades para obtener ganancias. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f8b/033/579/f8b033579fb97d33b1f448e3175a1217.jpg" alt="imagen"><br><br>  <i>La altura del primer d铆a</i> <br><br>  Nos complaci贸 que, aunque nuestra competencia es una reci茅n llegada al foro, vinieron muchos espectadores que no iban a participar, pero estaban interesados en el trabajo del stand, los 茅xitos de los concursantes.  隆Otomanas gratis frente al stand terminaron r谩pidamente! <br><br>  Otro hecho interesante est谩 asociado con los participantes de Jap贸n.  El portal interno de la competencia y la documentaci贸n de los dispositivos de los fabricantes nacionales estaban en ruso, sin embargo, esto no se convirti贸 en un obst谩culo para el equipo japon茅s: hab铆a suficientes habilidades pr谩cticas para demostrar una serie de ataques exitosos.  Sin embargo, despu茅s de la competencia, admitieron que, sin embargo, les caus贸 peque帽os inconvenientes. <br><br>  En general, la competencia demostr贸 que en menos de dos d铆as es muy posible comprender los sistemas modernos de medici贸n de electricidad y llevar a cabo ataques exitosos contra ellos. <br><br><h2>  An谩lisis de otros concursos Positive Hack Days 8: </h2><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Concurso CAMBreaker: c贸mo se atacaron las c谩maras de seguridad</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">HackBattle 2.0: c贸mo fue atacada la cafeter铆a de la escuela ICO</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Deja el concurso ATM Alone en PHDays 8</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">An谩lisis de la competencia "inteligencia competitiva"</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es414557/">https://habr.com/ru/post/es414557/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es414541/index.html">Optimizaci贸n de la aplicaci贸n node.js</a></li>
<li><a href="../es414547/index.html">Planificaci贸n de infraestructura para la recuperaci贸n instant谩nea de m谩quinas virtuales Recuperaci贸n instant谩nea de VM: Parte 2</a></li>
<li><a href="../es414549/index.html">3.000 ojos para inteligencia artificial. 驴Cu谩l es el sistema de monitoreo de estructuras del Centro Lakhta?</a></li>
<li><a href="../es414551/index.html">Instrucciones de admisi贸n de doctorado en EE. UU.</a></li>
<li><a href="../es414555/index.html">C贸mo transferimos 36 millones de clientes a un servicio de soporte t茅cnico digital</a></li>
<li><a href="../es414561/index.html">Escuela de videojuegos francesa: otro mundo</a></li>
<li><a href="../es414563/index.html">驴Qu茅 son las pruebas de componentes y c贸mo es ser un SDET?</a></li>
<li><a href="../es414565/index.html">L谩mpara para muebles, cocina o ba帽o.</a></li>
<li><a href="../es414567/index.html">Anuncio de RamblerFront & # 5</a></li>
<li><a href="../es414569/index.html">Los arrecifes de coral guardan secretos del pasado y el futuro de los oc茅anos.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>