<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèΩ‚Äçü§ù‚Äçüë®üèø üêó üí® Curso MIT "Seguran√ßa de sistemas de computadores". Palestra 4: ‚ÄúCompartilhando Privil√©gios‚Äù, Parte 3 üèÆ üïù üë©üèº‚Äç‚öïÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Instituto de Tecnologia de Massachusetts. Curso de Aula n¬∫ 6.858. "Seguran√ßa de sistemas de computador". Nikolai Zeldovich, James Mickens. 2014 ano 
 ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Curso MIT "Seguran√ßa de sistemas de computadores". Palestra 4: ‚ÄúCompartilhando Privil√©gios‚Äù, Parte 3</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ua-hosting/blog/418211/"><h3>  Instituto de Tecnologia de Massachusetts.  Curso de Aula n¬∫ 6.858.  "Seguran√ßa de sistemas de computador".  Nikolai Zeldovich, James Mickens.  2014 ano </h3><br>  Computer Systems Security √© um curso sobre o desenvolvimento e implementa√ß√£o de sistemas de computador seguros.  As palestras abrangem modelos de amea√ßas, ataques que comprometem a seguran√ßa e t√©cnicas de seguran√ßa baseadas em trabalhos cient√≠ficos recentes.  Os t√≥picos incluem seguran√ßa do sistema operacional (SO), recursos, gerenciamento de fluxo de informa√ß√µes, seguran√ßa de idiomas, protocolos de rede, seguran√ßa de hardware e seguran√ßa de aplicativos da web. <br><br>  Palestra 1: ‚ÄúIntrodu√ß√£o: modelos de amea√ßas‚Äù <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 3</a> <br>  Palestra 2: ‚ÄúControle de ataques de hackers‚Äù <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 3</a> <br>  Aula 3: ‚ÄúEstouros de Buffer: Explora√ß√µes e Prote√ß√£o‚Äù <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 3</a> <br>  Palestra 4: ‚ÄúSepara√ß√£o de Privil√©gios‚Äù <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 3</a> <a name="habracut"></a><br><br>  Assim, nosso desenho mostra uma "obra de arte", que seus criadores tentaram proteger contra amea√ßas.  No caso deles, acho que estavam muito preocupados, porque, ao criar o <b>site de</b> namoro <b>okcupid.com</b> , eles realmente queriam garantir que a reputa√ß√£o dos usu√°rios do site n√£o fosse afetada pela divulga√ß√£o de dados pessoais.  De uma conversa com um dos desenvolvedores do site que escreveu o artigo sobre isso, sabe-se que eles n√£o foram realmente comprometidos.  Pelo menos, n√£o houve vazamento de dados devido ao uso da arquitetura <b>OKWS</b> e em parte devido ao monitoramento de atividades maliciosas. <br><br>  A raz√£o pela qual as pessoas n√£o dividem seus aplicativos em componentes menores √© porque esse processo exige algum esfor√ßo.  √â necess√°rio selecionar todas as partes do c√≥digo, definir interfaces claras entre elas e decidir a quais dados cada componente deve ter acesso.  Se voc√™ decidir implementar uma nova fun√ß√£o, precisar√° alterar os dados aos quais cada componente do programa tem acesso, para conceder novos privil√©gios ou selecionar alguns, e assim por diante.  Portanto, este √© um processo bastante demorado. <br><br><img src="https://habrastorage.org/webt/th/7c/nb/th7cnbytweb-shrbg6mai4qmhpw.jpeg"><br><br>  Vamos tentar entender como o servidor da web √© projetado, e talvez uma maneira de fazer isso seja rastrear como a solicita√ß√£o http √© processada pelo servidor <b>OKWS</b> .  Assim, semelhante ao mostrado na figura anterior, temos um navegador da web que deseja acessar <b>okcupid.com</b> .  Os desenvolvedores do projeto do site imaginaram que teriam um monte de m√°quinas, mas analisaremos apenas a interface do site em que o <b>OKWS</b> funcionar√° e outra m√°quina em segundo plano que armazenar√° o banco de dados.  Esta segunda m√°quina usa o <b>MySQL</b> porque √© um bom software para muitas tarefas.  Eles querem realmente proteger esses dados porque √© realmente dif√≠cil acessar um disco ou banco de dados bruto com datagramas brutos. <br><br>  Ent√£o, como a solicita√ß√£o funciona, como a solicita√ß√£o √© processada pelo servidor <b>OKWS</b> ?  Primeiro, ele chega e √© processado por um processo chamado <b>okd</b> para o despachante <b>OKWS</b> .  Ele verifica se solicita essa solicita√ß√£o e, em seguida, faz algumas coisas.  Como voc√™ pode precisar registrar essa solicita√ß√£o primeiro, ela a redireciona para um componente chamado <b>oklogd</b> , ap√≥s o qual voc√™ precisar√° criar alguns modelos e pode ser necess√°rio cri√°-los mesmo antes da chegada da solicita√ß√£o.  E faz outro componente chamado <b>pubd</b> . <br><br><img src="https://habrastorage.org/webt/wq/uz/o0/wquzo0-ivmzrydzbxgj_ckcecsw.jpeg"><br><br>  E, finalmente, h√° um servi√ßo espec√≠fico para o qual essa solicita√ß√£o √© enviada; portanto, no <b>okd,</b> h√° uma tabela do conjunto de servi√ßos que ele suporta.  Presumivelmente, essa solicita√ß√£o trata de um desses servi√ßos, portanto, ap√≥s revisar o <b>okd, a</b> solicita√ß√£o <b>ser√°</b> redirecionada para um processo de servi√ßo <b>svc</b> espec√≠fico.  Este servi√ßo far√° exatamente o que a solicita√ß√£o exige, por exemplo, inscrever o usu√°rio no boletim informativo ou possibilitar a visualiza√ß√£o do diret√≥rio de usu√°rios do <b>ocupid</b> , utilizando o banco de dados, etc. <br><br>  E para isso, voc√™ provavelmente precisar√° do servi√ßo para deixar as informa√ß√µes do aplicativo no <b>log do</b> componente <b>oklogd</b> .  E no final do dia, ele deve "conversar" com o banco de dados.  Os criadores do site implementaram esse processo de "comunica√ß√£o" de maneira um pouco diferente do que normalmente acontece no <b>Apache</b> , onde voc√™ simplesmente se comunica com o banco de dados e emite consultas <b>SQL</b> arbitr√°rias.  Eles criaram esse conceito de proxy de banco de dados, <b>dbproxy</b> , localizado na frente do <b>banco de dados MySQL</b> e aceita solicita√ß√µes do servi√ßo <b>svc</b> para execut√°-los.  Penso que esta ilustra√ß√£o mostra basicamente como o <b>OKWS</b> funciona. <br><br><img src="https://habrastorage.org/webt/e1/nb/be/e1nbbexq_wqwyqtsop6vnvlmfd0.jpeg"><br><br>  H√° outro componente que inicia tudo isso, chamado <b>okld</b> , e √© respons√°vel por iniciar todos os processos na interface deste servidor web.  Espero que algumas dessas coisas lhe pare√ßam familiares, porque essa √© exatamente a arquitetura que foi considerada em laborat√≥rio.  Parece que √© um bom design.  Voc√™ n√£o tinha <b>pubd</b> , <b>logd</b> e <b>dbproxy no LR</b> , mas tinha <b>okd</b> e <b>svc</b> .  Tem d√∫vidas sobre o <b>OKWS</b> ? <br><br>  <b>P√∫blico:</b> entendemos corretamente que o <b>dbproxy</b> n√£o aceita consultas SQL, mas um tipo diferente de consulta? <br><br>  <b>Professor:</b> sim, certo!  Como √© essa interface?  Eles n√£o descrevem isso detalhadamente, mas uma coisa que voc√™ pode fazer com esse <b>dbproxy</b> √© estocar muitos argumentos para modelos de consulta <b>SQL</b> .  Por exemplo, poderia ser um modelo de consulta de pesquisa para seus amigos, selecionando-os por <b>ID</b> . <br><br><img src="https://habrastorage.org/webt/0e/fv/33/0efv33jbe-yuwdw82mwqzxof_xc.jpeg"><br><br>  Suponha que exista um modelo como ‚Äúselecione <b>^ ID</b> da sua lista de amigos, em que <b>^ ID =‚Äú% S ‚Äù</b> .  Suponha que voc√™ queira encontrar <b>Alice</b> entre seus amigos e enviar uma solicita√ß√£o <b>S</b> , onde o argumento √© <b>"alice"</b> .  Deixe nosso aplicativo, dispon√≠vel na interface, saber que o <b>dbproxy est√°</b> pronto para executar tr√™s tipos de solicita√ß√µes em seu nome.  Se voc√™ deseja executar a consulta n√∫mero 1 e seu argumento √© <b>"Alice"</b> , ele fornece acesso ao banco de dados. <br><br>  <b>P√∫blico-alvo:</b> um usu√°rio externo no n√≠vel de um navegador da Web pode enviar essa solicita√ß√£o ao banco de dados ou tudo se aplica apenas a usu√°rios internos da rede? <br><br>  <b>Professor:</b> sim, talvez.  Ent√£o, como isso funciona?  De fato, √© estranho que esse banco de dados esteja em uma m√°quina separada, porque voc√™ pode simplesmente se conectar ao banco de dados <b>OKWS</b> ou ao servidor <b>MySQL</b> ?  Ent√£o, o que est√° parando isso? <br><br>  <b>P√∫blico:</b> firewall? <br><br>  <b>Professor:</b> sim, provavelmente em algum n√≠vel.  Os desenvolvedores n√£o descrevem isso com muitos detalhes, mas provavelmente existe alguma rede interna na segunda m√°quina, e h√° uma altern√¢ncia entre a interface e o banco de dados que n√£o pode ser acessado do mundo exterior.  De fato, ambas as m√°quinas est√£o na mesma rede, mas h√° um firewall <b>Fw</b> que possui certas regras.  Talvez eles s√≥ possam ser conectados a esse computador de interface atrav√©s da porta 80, mas n√£o diretamente ao servidor interno.  Essa √© uma das op√ß√µes de prote√ß√£o. <br><br><img src="https://habrastorage.org/webt/uu/lq/pt/uulqptu9yvouev1n-gdwegusujc.jpeg"><br><br>  Outro, provavelmente, √© que, quando voc√™ se conecta a esse <b>proxy do</b> banco de dados <b>dbproxy</b> , precisa fornecer um token ou chave criptogr√°fica de 20 bytes e, se n√£o o fornecer, o <b>dbproxy</b> rejeitar√° sua conex√£o.  Portanto, a regra √© que voc√™ abra uma conex√£o TCP, envie 20 bytes e, se estiverem errados, a conex√£o ser√° fechada.  Acho que esse √© o significado de um projeto desse sistema. <br><br>  Ent√£o, vamos tentar descobrir como esses diferentes processos s√£o isolados aqui.  Como voc√™ pode garantir que todos esses componentes n√£o se sobrecarreguem? <br><br>  <b>P√∫blico-alvo:</b> direitos de root diferentes e IDs de usu√°rio diferentes? <br><br>  <b>Professor:</b> sim, quase cada um desses componentes funciona como um <b>uid</b> diferente; portanto, aqui, na descri√ß√£o do sistema, h√° uma tabela inteira que descreve para cada componente onde ele trabalha e com qual <b>uid</b> .  Ent√£o, podemos escrever que o <b>okd</b> tem seu pr√≥prio <b>uid</b> , o <b>pubd</b> tem o seu pr√≥prio <b>uid</b> e o <b>oklogd</b> tamb√©m tem o seu pr√≥prio <b>uid</b> . <br><br>  <b>Okld</b> funciona como <b>root</b> , o que √© um pouco mal sucedido, mas talvez isso n√£o seja um grande problema.  Depois, h√° um monte de identificadores de usu√°rio atribu√≠dos dinamicamente para cada servi√ßo, por exemplo, ID 51001 etc. <br><br><img src="https://habrastorage.org/webt/hc/bp/bj/hcbpbjjrkwqqhtdun36v3fm7b_s.jpeg"><br><br>  Assim, isso garante que cada servi√ßo n√£o possa interferir nos processos de outros servi√ßos.  <b>O chroot</b> tamb√©m <b>√©</b> amplamente usado aqui, portanto, alguns desses componentes t√™m direitos <b>chroot</b> em diret√≥rios separados.  Por exemplo, <b>okd</b> e <b>svc</b> s√£o dotados de direitos <b>chroot</b> comuns em alguns diret√≥rios.  Por que voc√™ acha que esses dois componentes t√™m um separado e n√£o √© comum com outros componentes <b>chroot</b> ? <br><br>  <b>P√∫blico:</b> porque o <b>okd</b> n√£o tem privil√©gios de root. <br><br>  <b>Professor:</b> sim, mas por que eles n√£o colocam <b>pubd</b> , <b>oklogd</b> e todos os outros no mesmo <b>chroot</b> ? <br><br>  <b>P√∫blico-alvo: √©</b> poss√≠vel que, se os servi√ßos precisem compartilhar muitos dados, eles sejam isolados um do outro? <br><br>  <b>Professor:</b> talvez.  Eu acho que eles devem compartilhar alguns dados, mas esses dados n√£o est√£o nos arquivos, eles s√£o transferidos atrav√©s de sockets do <b>okd</b> para os servi√ßos.  Mas, de fato, nenhum desses componentes armazena algo interessante no sistema de arquivos. <br><br>  Portanto, n√£o h√° nada de interessante no diret√≥rio <b>chroot</b> , e acho que os <b>funcion√°rios</b> da <b>OKWS</b> simplesmente decidiram reduzir despesas improdutivas para o <b>chroot</b> , como a necessidade de criar uma c√≥pia do diret√≥rio.  Talvez eles tamb√©m quisessem se livrar de algumas despesas gerais de gerenciamento para cada comando <b>chroot</b> .  Mas como n√£o h√° arquivos reais aqui, tudo est√° em ordem. <br><br>  A raz√£o pela qual esses caras atribu√≠ram <b>chroot</b> diferente para os componentes do ambiente √© por causa de algumas coisas interessantes.  Pode haver modelos, mas aqui, talvez, haja um arquivo de log, portanto eles n√£o desejam que o arquivo de log seja lido acidentalmente e assim por diante. <br><br>  <b>P√∫blico-alvo:</b> esses servi√ßos possuem arquivos, por exemplo, como <b>aspx</b> ? <br><br>  <b>Professor:</b> como eles descrevem no artigo, o servi√ßo √© um √∫nico bin√°rio <b>C ++</b> compilado; portanto, n√£o h√° arquivos adicionais. <br><br>  Existem modelos, mas eles s√£o realmente transmitidos por esse mecanismo estranho: o <b>pubd</b> possui modelos em seu diret√≥rio, os exibe em algum pr√©-computador, formul√°rio inicial no <b>okd</b> e o <b>okd</b> j√° fornece modelos para todos os servi√ßos atrav√©s de chamadas <b>RPC</b> .  Assim, eles ficam na mem√≥ria, mas na verdade s√£o inacess√≠veis diretamente atrav√©s do sistema de arquivos.  Esse √© um design um tanto paran√≥ico quando eu nem consigo ler os modelos. <br>  Ent√£o, qual √© o sentido de separar todos esses componentes?  Por que precisamos de um <b>oklogd</b> separado? <br><br>  <b>P√∫blico:</b> para eliminar a possibilidade de substituir ou aparar o di√°rio? <br><br>  <b>Professor:</b> sim, ent√£o queremos realmente garantir que, se algo der errado, o di√°rio, pelo menos, n√£o seja corrompido.  Portanto, h√° um arquivo de log separado grav√°vel por este <b>uid</b> e todas as mensagens de log s√£o enviadas como <b>RPC</b> para este servi√ßo de log.  E mesmo que todo o resto esteja arruinado, bem, com exce√ß√£o do <b>okld</b> , a revista permanecer√° ilesa. <br><br>  <b>P√∫blico:</b> e se voc√™ acidentalmente encontrou uma maneira de ler a revista e n√£o v√™ o que os outros fizeram com ela? <br><br>  <b>Professor:</b> n√£o, acho que se voc√™ " <b>hackear</b> " algum servi√ßo, <b>pubd</b> ou qualquer outra coisa, poder√° escrever qualquer coisa no di√°rio.  Portanto, a cria√ß√£o de uma <b>entrada oklogd</b> separada faz sentido.  Na verdade, o <b>oklogd</b> √© um processo separado, e n√£o apenas atualizado, anexando arquivos como <b>um arquivo somente anexado</b> .  Portanto, o <b>oklogd</b> n√£o pode adicionar algumas informa√ß√µes adicionais a cada entrada de log, porque se o sistema operacional suportar o arquivo <b>somente anexado</b> , voc√™ n√£o saber√° que algu√©m gravou no arquivo quando isso acontecer.  Enquanto o <b>oklogd</b> coloca um registro de data e hora para cada mensagem e permite descobrir qual servi√ßo fez a grava√ß√£o ou veio do <b>okd</b> .  Portanto, voc√™ realmente obt√©m informa√ß√µes adicionais nesse arquivo de log porque √© um servi√ßo separado. <br><br>  E qual √© o significado da <b>boa</b> separa√ß√£o e por que ela deveria funcionar com direitos de root?  Eu acho que existem v√°rias raz√µes para isso. <br><br>  P√∫blico: se voc√™ quiser que mais ningu√©m aja com privil√©gios de root, voc√™ precisar√° delegar a fun√ß√£o de autentica√ß√£o de usu√°rio <b>okld</b> . <br><br><img src="https://habrastorage.org/webt/xg/c2/p0/xgc2p0qzezaptmg1jagd1l3koxi.jpeg"><br><br>  <b>Professor:</b> sim.  Algu√©m tem que configurar tudo isso <b>uid chroot</b> , e voc√™ precisa de <b>root</b> para este <b>Unix</b> , ent√£o o <b>okld</b> fornece isso.  Essa √© uma das raz√µes.  Mais alguma coisa? <br><br>  <b>P√∫blico:</b> defini√ß√£o de 80 portas? <br><br>  <b>Professor:</b> sim, claro!  Voc√™ precisa ligar a porta 80, que est√° <b>okld</b> e fornece mais <b>alguma</b> coisa? <br><br>  <b>P√∫blico:</b> conclui a abertura do arquivo de log <b>oklogd</b> porque n√£o queremos deixar o <b>oklogd</b> aberto para impedir o acesso ao arquivo de log. <br><br>  <b>Professor:</b> talvez.  Mas n√£o sei se os desenvolvedores realmente fizeram isso porque n√£o examinaram o c√≥digo-fonte.  Voc√™ acha que o <b>okld</b> abre o arquivo de log e o passa <b>oklogd</b> ?  Possivelmente. <br><br>  <b>P√∫blico-alvo:</b> caso contr√°rio, um invasor que comprometeu o <b>oklogd</b> pode apagar o log inteiro. <br><br>  <b>Professor:</b> sim, est√° certo.  Talvez voc√™ queira abri-lo no modo de <b>acr√©scimo</b> e depois pass√°-lo para <b>oklogd</b> , para ter mais garantias de seguran√ßa para o log.  Isso √© algo que voc√™ n√£o pode fazer sem privil√©gios de root. <br><br>  Ent√£o, tivemos uma pergunta sobre a li√ß√£o de casa, o que acontecer√° quando esse token de 20 bytes for "vazado" para acessar o banco de dados.  Que dano isso pode causar?  Devemos nos preocupar com isso? <br><br>  <b>P√∫blico:</b> neste caso, um invasor pode assumir o controle de um servi√ßo espec√≠fico. <br><br>  <b>Professor:</b> sim, certo, porque agora voc√™ pode se conectar e obter todos os modelos de consulta.  Na verdade, parece bastante simples.  Voc√™ provavelmente precisar√° comprometer um desses componentes para poder conectar-se ao banco de dados do servidor primeiro.  Portanto, acho que se voc√™ tiver esse token e puder comprometer um desses componentes mostrados na figura, poder√° usar todas essas consultas. <br><br>  Agora vamos ver como esse design do <b>OKWS</b> pode ser aprimorado?  Por exemplo, seria poss√≠vel alocar uma unidade de <b>uid</b> separada para cada usu√°rio, al√©m de alocar uma <b>uid</b> separada para cada servi√ßo.  Aqui, cada servi√ßo, por exemplo, not√≠cias, pesquisa de amigos ou cria√ß√£o de uma conta, possui um <b>ID do usu√°rio</b> separado, mas cada usu√°rio do <b>OKWS</b> n√£o <b>√©</b> representado como um <b>UID do Unix</b> .  Na verdade, n√£o h√° <b>ID do usu√°rio</b> aqui, apenas <b>IDs de</b> servi√ßo est√£o presentes aqui.  Voc√™ acha que precisa ter um <b>uid</b> diferente para cada cliente do <b>OKWS</b> ? <br><br>  <b>P√∫blico:</b> neste caso, acontece que, se um usu√°rio "hackear" um servi√ßo, ele poder√° acessar todos os dados de outros usu√°rios deste servidor. <br><br>  <b>Professor:</b> sim, est√° certo! <br><br>  <b>P√∫blico:</b> mas se voc√™ tivesse, de fato, um servi√ßo separado e um <b>dbproxy</b> separado para cada usu√°rio, seria imposs√≠vel acessar os dados de outras pessoas. <br><br>  <b>Professor:</b> sim, mas poderia ser um modelo mais forte?  Eu acho que os desenvolvedores <b>do OKWS</b> n√£o d√£o esse passo por duas raz√µes.  O primeiro √© o desempenho.  Se voc√™ possui alguns milh√µes de usu√°rios do site <b>okcupid</b> , v√°rios milh√µes de processos em execu√ß√£o e alguns milh√µes de <b>dbproxie</b> , as despesas gerais de desempenho s√£o poss√≠veis.  E isso n√£o permitir√° obter o mesmo desempenho que a arquitetura <b>OKWS</b> existente <b>fornece</b> . <br><br>  <b>P√∫blico: a</b> descri√ß√£o <b>da</b> <b>OKWS</b> diz que o desempenho deste sistema √© melhor que outros sistemas.  Como isso foi alcan√ßado? <br><br>  <b>Professor:</b> Eu acho que isso ocorre em parte porque eles ajustaram seu design para uma carga de trabalho espec√≠fica. Al√©m disso, eles escreveram tudo isso em <b>C ++</b> .  Uma alternativa √© escrever algumas coisas em <b>PHP</b> , e √© prov√°vel que voc√™ obtenha benef√≠cios nessa frente. <br><br>  Al√©m disso, eles n√£o t√™m muitos dos recursos que o <b>Apache</b> possui.  Ele tem um design de uso geral, portanto, possui muitos processos de trabalho e os recarrega de tempos em tempos.  Existem muitas conex√µes <b>TTP</b> que garantem a dura√ß√£o do processo de conex√£o e mant√™m suas atividades.  Tamb√©m aumenta o n√∫mero de processos em execu√ß√£o no sistema.  <b>O Apache tornou-se</b> mais universal e pode fazer tudo o que voc√™ deseja obter do servidor da Internet, e os <b>funcion√°rios</b> da <b>OKWS est√£o</b> mais focados em resolver problemas espec√≠ficos. <br><br>  Mas acho que <b>atualmente</b> existem outros servidores da web que provavelmente podem corresponder <b>ao</b> desempenho do <b>OKWS</b> .  Por exemplo, o <b>Nginx</b> √© um servidor da web muito otimizado que voc√™ pode executar atualmente.  Se voc√™ deseja aplicativos de alto desempenho no lado do servidor, provavelmente deseja que o longo processo seja muito semelhante ao servi√ßo <b>OKWS</b> .  E para que houvesse um mecanismo para uma interface r√°pida comum de gateway <b>CGI</b> para conectar um programa externo a um servidor da Web ou um tipo de protocolo que pudesse ser usado no servidor para implementar isso, mesmo no <b>Apache</b> ou <b>Nginx</b> .  Portanto, acho que muitas dessas id√©ias n√£o s√£o exclusivas do <b>OKWS</b> , elas podem ser implementadas em outros servidores da web.  Eles simplesmente mostram que melhorar a seguran√ßa n√£o exclui o uso desses "truques".  Eu acho que eles come√ßaram com um esquema semelhante ao <b>Apache</b> , mas pensaram que n√£o seria seguro o suficiente. <br><br>  Portanto, acho que uma das raz√µes pelas quais os criadores do <b>OKWS</b> n√£o quiseram introduzir privil√©gios separados para os usu√°rios foi uma poss√≠vel degrada√ß√£o do desempenho. <br><br><img src="https://habrastorage.org/webt/ai/s9/zb/ais9zbrgrmnoslcojxk0jacxdyc.jpeg"><br><br>  Outro motivo √© que o modelo de aplicativo completo "gira" em torno de um servi√ßo que tenta acessar os dados de cada usu√°rio, como encontrar amigos no <b>okcupid</b> ou algu√©m que voc√™ possa convidar para uma data.  Como resultado, esse modelo de isolamento do usu√°rio n√£o faz muito sentido, porque, em √∫ltima an√°lise, deve haver um servi√ßo para o qual voc√™ envia uma solicita√ß√£o e ele examinar√° todos os outros dados para encontrar uma correspond√™ncia para sua solicita√ß√£o.  Portanto, mesmo se voc√™ tiver identificadores de usu√°rio ou algum mecanismo para isol√°-los, ainda precisar√° abrir o acesso ao servi√ßo para cada usu√°rio. <br><br>  Para outros servi√ßos, como o <b>Gmail</b> ou o <b>Dropbox</b> , que s√£o muito mais focados em um usu√°rio espec√≠fico e n√£o oferecem uma capacidade aberta de compartilhar seus arquivos, o isolamento de usu√°rios pode oferecer mais vantagens.  Por exemplo, no servidor do <b>Dropbox,</b> h√° um <b>ID</b> do <b>usu√°rio</b> para cada cliente do <b>Dropbox</b> .  E se houver um processo em execu√ß√£o para voc√™ e outro para outra pessoa, mesmo usando uma explora√ß√£o maliciosa, voc√™ n√£o poder√° se apossar das informa√ß√µes de outras pessoas. <br>  Agora vamos ver se o <b>OKWS realmente</b> conseguiu melhorar a seguran√ßa nesse modelo de servidor.  Para avaliar a seguran√ßa, voc√™ precisa considerar cada componente do sistema e determinar que tipo de ataque poderia prejudic√°-lo. <br><br>  Vamos come√ßar com <b>okd</b> .  Pode ser atacado com solicita√ß√µes via navegador, por exemplo, causando um estouro de buffer.       c++,  ,       - ,   <b>okd</b>  .      ? <br><br><img src="https://habrastorage.org/webt/qz/md/d9/qzmdd9xheqlsc2fpbgs4e5to3_i.jpeg"><br><br> <b>:</b>        ? <br><br> <b>:</b> ,  ,      .   ? <br><br> <b>:</b>       ,  . <br><br> <b>:</b> ,  .  , ,       ,        <b>http</b> ,   ,   ,     .  ,     . <br><br> <b>:</b>           ? <br><br> <b>:</b> ,       .    ,  ,      ,        , ,  <b>match.com</b>    . , ,      <b>OkCupid</b> . , - ?          ? <br><br> <b>:</b> ,    ,      <b>okd</b> .           ,    ? <br><br> <b>:</b> .   , <b>okd</b>     . <br><br> <b>:</b> ,     ? <br><br> <b>:</b> !      ,      , , ,      ,   .      ,   , ,   ,      . , ,   .   ¬´¬ª <b>okd</b> ,     ,     ,         . <br><br> <b>:</b>         DOS-? <br><br> <b>:</b> ,  , , ¬´¬ª       ¬´¬ª  ,   DOS-    -   . <br><br> <b>:</b>       <b>okd</b> ,     ,  ‚Ä¶ <br><br> <b>:</b> ,  .  ,   , <b>okd</b>    ,         <b>okd</b> ,     .     <b>okd</b> ,           .  ,    <b>okd</b>  ,       ,      ,   ,            . <br><br> <b>:</b>          . <br><br> <b>:</b> ,    .  , <b>okd</b>     .   ,    <b>oklogd</b> ?    ? <br><br> <b>:</b>      . <br><br> <b>:</b> ,          ,             ,   ?       <b>pubd</b> ,  ,     ,  -  . <br><br> <b>:</b> ,    ,   ¬´¬ª  <b>oklogd</b> . <br><br> <b>:</b> ,  .      ,      ,   <b>append-only</b>    ,        . <br><br> <b>:</b> ,      ‚Ä¶ <br><br> <b>:</b> ,        ,   .          . <br><br>     <b>svc</b> ? ,  ,   .       , ,   <b>okd</b>  <b>oklogd</b>    .         ,  ,        . <br><br>   <b>svc</b>  - -,        ,       ,         .   ,         ,        ,       . <br><br>      <b>okld</b> ?       ,      root.       ? ,       .           <b>dbproxy</b> .    <b>okld</b> ?      ¬´¬ª?    ? <br><br> <b>:</b> ,  -   ? <br><br> <b>:</b> ,       .          ,    ,       . ,        ,  -    ,     , ,     -    .         -     .          root-   . <br><br> <b>:</b> -,    ,     -   <b>dbproxy</b> . <br><br> <b>:</b> ! <br><br> <b>:</b>  ,     ,  ,     <b>RPC</b> ,       ,     ,     ,  ,   !      . <br><br><img src="https://habrastorage.org/webt/qs/cu/x6/qscux6nxwgoo9wqu10wj04npz38.jpeg"><br><br> <b>:</b> ,    .       <b>dbproxy</b> ?  ,            .   ,   ¬´¬ª   ,      <b>dbproxy</b>  - . <br><br> <b>:</b>      ,   <b>svc</b>  ‚Ä¶ <br><br> <b>:</b> ,  <b>svc</b>   ,     ! <br><br> <b>:</b>  ,    ,     ! <br><br> <b>:</b>  ,  ,      <b>¬´¬ª</b> ,       ‚Ä¶ <br><br> <b>:</b>   <b></b>     <b>dbproxy</b> . <br><br> <b>:</b> . ,      <b>dbproxy</b> ,   . <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Espero que voc√™ entenda o que os privil√©gios de compartilhamento de aplicativos nos d√£o. </font><font style="vertical-align: inherit;">E como podemos ver, isso n√£o √© perfeito. </font><font style="vertical-align: inherit;">H√° muito mais coisas que podem dar errado. </font><font style="vertical-align: inherit;">Mas parece que esta solu√ß√£o √© melhor que projetar aplicativos individuais sem privil√©gios de acesso, onde come√ßamos.</font></font><br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/dNl22h1kW1k" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A vers√£o completa do curso est√° dispon√≠vel </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aqui</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br>  Obrigado por ficar conosco.  Voc√™ gosta dos nossos artigos?  Deseja ver materiais mais interessantes?  Ajude-nos fazendo um pedido ou recomendando a seus amigos, um <b>desconto de 30% para os usu√°rios da Habr em um an√°logo exclusivo de servidores b√°sicos que inventamos para voc√™:</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Toda a verdade sobre o VPS (KVM) E5-2650 v4 (6 n√∫cleos) 10GB DDR4 240GB SSD 1Gbps de US $ 20 ou como dividir o servidor?</a>  (as op√ß√µes est√£o dispon√≠veis com RAID1 e RAID10, at√© 24 n√∫cleos e at√© 40GB DDR4). <br><br>  <b>Dell R730xd 2 vezes mais barato?</b>  Somente n√≥s temos <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">2 TVs Intel Dodeca-Core Xeon E5-2650v4 128GB DDR4 6x480GB SSD 1Gbps 100 a partir de US $ 249</a> na Holanda e nos EUA!</b>  Leia sobre <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Como criar um pr√©dio de infraestrutura.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">classe usando servidores Dell R730xd E5-2650 v4 custando 9.000 euros por um centavo?</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt418211/">https://habr.com/ru/post/pt418211/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt418201/index.html">Podemos reviver Duck Hunt?</a></li>
<li><a href="../pt418203/index.html">API do GraphQL (CRUD) on Go</a></li>
<li><a href="../pt418205/index.html">Space Language Vol. 2: Bem-vindo, GJ273b</a></li>
<li><a href="../pt418207/index.html">An√°lise dos laptops para jogos ASUS ROG Strix GL504GS SCAR II e ASUS ROG Strix GL504GM HERO II</a></li>
<li><a href="../pt418209/index.html">Recebemos dados dos contadores Mercury 203.2T na RS-485</a></li>
<li><a href="../pt418213/index.html">Curso MIT "Seguran√ßa de sistemas de computadores". Palestra 5: ‚ÄúDe onde v√™m os sistemas de seguran√ßa‚Äù, parte 1</a></li>
<li><a href="../pt418215/index.html">Curso MIT "Seguran√ßa de sistemas de computadores". Aula 5: ‚ÄúDe onde v√™m os erros do sistema de seguran√ßa‚Äù, Parte 2</a></li>
<li><a href="../pt418217/index.html">Curso MIT "Seguran√ßa de sistemas de computadores". Palestra 6: ‚ÄúOportunidades‚Äù, parte 1</a></li>
<li><a href="../pt418219/index.html">Curso MIT "Seguran√ßa de sistemas de computadores". Palestra 6: Oportunidades, Parte 2</a></li>
<li><a href="../pt418221/index.html">Curso MIT "Seguran√ßa de sistemas de computadores". Palestra 6: ‚ÄúOportunidades‚Äù, parte 3</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>