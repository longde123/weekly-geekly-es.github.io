<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üéí üí™üèº üë©üèæ‚Äçüè´ Regras Sigma. Artesanato ou novo padr√£o para SOC üîπ üïß üêñ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Sou Sergey Rublev, chefe do SOC (Security Operations Center) na Infosecurity. 
 Neste artigo, examinarei em detalhes o ambicioso projeto Sigma Rules ,...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Regras Sigma. Artesanato ou novo padr√£o para SOC</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/softline/blog/442570/">  Sou Sergey Rublev, chefe do SOC (Security Operations Center) na Infosecurity. <br>  Neste artigo, examinarei em detalhes o ambicioso projeto <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Sigma Rules</a> , cujo lema √©: "Sigma para logs √© como Snort para tr√°fego e Yara para arquivos". <br><br><img src="https://habrastorage.org/webt/xi/c9/_a/xic9_a4hwhjkjsi4shhsk2oqalk.png"><br><br>  Ser√£o cerca de tr√™s aspectos: <br><br><ul><li>  Aplicabilidade da sintaxe da regra Sigma para manter uma base de conhecimento de scripts de detec√ß√£o de amea√ßas </li><li>  Recursos de ferramentas de gera√ß√£o de regras para sistemas SIEM in a box </li><li>  Valor para o SOC do conte√∫do atual dos reposit√≥rios p√∫blicos de regras Sigma </li></ul><a name="habracut"></a><br><h2>  Era uma vez, em uma gal√°xia distante, distante </h2><br>  Tudo come√ßou h√° alguns anos atr√°s, quando as √°rvores eram grandes e nossa equipe de monitoramento ainda era pequena.  Enfrentamos muitas perguntas, quase todas as equipes que crescem em uma linha de tr√™s pessoas passam por isso. <br><br><img src="https://habrastorage.org/webt/eu/0a/1t/eu0a1ti-3y93okrcileh_cymq3w.png"><br><br>  As raz√µes para o surgimento de perguntas s√£o diferentes: <br><br><ul><li>  Crescimento da equipe </li><li>  Rotatividade de pessoal </li><li>  Um grande n√∫mero de sistemas heterog√™neos para monitoramento </li></ul><br>  Se voc√™ precisar de suporte j√° configurado por algu√©m SIEM, o n√∫mero de perguntas aumenta como uma avalanche. <br><br><h2>  Biblioteca de Casos de Uso </h2><br>  A experi√™ncia mundial na constru√ß√£o de centros de monitoramento j√° encontrou uma solu√ß√£o para organizar o caos e seu nome √© a biblioteca de estudos de caso.  O objetivo de cada caso √© descrever de maneira abrangente a solu√ß√£o para um problema na estrutura do monitoramento de seguran√ßa da informa√ß√£o. <br><br>  A composi√ß√£o do conhecimento estabelecida em cada caso pode variar; procedemos do seguinte conjunto: <br><br><ul><li>  <b>Objetivo</b> - a tarefa resolvida pelo caso </li><li>  <b>Amea√ßa</b> - a amea√ßa que a regra de detec√ß√£o procura detectar. </li><li>  <b>Stakeholders</b> - pessoas interessadas nesta regra: IB / TI / Neg√≥cios </li><li>  <b>Requisitos de dados</b> - o conjunto de dados necess√°rio para identificar uma amea√ßa </li><li>  <b>L√≥gica</b> - l√≥gica da regra de detec√ß√£o de amea√ßas </li><li>  <b>Teste</b> - um algoritmo para testar a corre√ß√£o da regra de detec√ß√£o </li><li>  <b>Prioridade</b> - prioridade do processamento de eventos por caso (geralmente calculada a partir do dano potencial de uma amea√ßa implementada com sucesso) </li><li>  <b>Sa√≠da</b> - Uma lista de a√ß√µes para analisar o alerta, uma descri√ß√£o das sa√≠das corretas do procedimento de an√°lise e a composi√ß√£o dos dados registrados nos resultados da an√°lise </li></ul><br>  Exemplo de caso de uso para a tarefa de detectar a comunica√ß√£o com o servidor de gerenciamento de botnet (vulgarmente conhecido como C&amp;C ou apenas C2): <br><br><img src="https://habrastorage.org/webt/jh/zz/s9/jhzzs9zblfsxc5-vehzmadc_hjk.png"><br><br>  O exemplo √© bastante simplificado: na realidade, com uma descri√ß√£o adequada, um caso cresce em um documento de v√°rias p√°ginas. <br><br>  Naquele momento, quando o n√∫mero de casos excedeu v√°rias dezenas, come√ßamos a procurar ferramentas prontas para manter essa base de conhecimento, de prefer√™ncia tendo, al√©m de amig√°vel ao ser humano, tamb√©m algum tipo de interface amig√°vel para o trabalho. <br><br><h2>  Projeto Sigma </h2><br>  O projeto Sigma certamente merece considera√ß√£o no contexto da base de conhecimento sobre regras de detec√ß√£o de incidentes.  Tudo come√ßou em 2016, e eu o acompanho quase desde o come√ßo. <br><br>  De fato, o projeto consiste em <br><br><ul><li>  A Sigma se governa </li><li>  Utilit√°rios para converter regras em consultas para v√°rios sistemas SIEM </li></ul><br>  A lista SIEM √© impressionante: quase todas as solu√ß√µes populares de an√°lise de eventos est√£o presentes.  Mais sobre tudo em detalhes e em ordem. <br><br><h2>  Sintaxe da regra </h2><br>  Regras Sigma s√£o documentos YAML que descrevem um cen√°rio para detectar um ataque espec√≠fico.  Sintaticamente, as regras consistem nos seguintes blocos: <br><br><h3>  Meta informa√ß√£o </h3><br>  Pe√ßa descritiva para estruturar e simplificar a busca pelas regras necess√°rias. <br><br><pre><code class="plaintext hljs">title: Access to ADMIN$ Share description: Detects access to $ADMIN share author: Florian Roth falsepositives: - Legitimate administrative activity level: low tags: - attack.lateral_movement - attack.t1077 status: experimental</code> </pre> <br>  Tamb√©m gostaria de observar que muitas regras j√° s√£o fornecidas com links para a t√©cnica de ataque, de acordo com a metodologia MITRE ATT &amp; CK. <br><br><h3>  Declara√ß√£o de fonte de dados </h3><br>  Descri√ß√£o da fonte com base nos eventos em que a l√≥gica de detec√ß√£o √© implementada. <br><br><pre> <code class="actionscript hljs">logsource: product: windows service: security</code> </pre><br>  √â sintaticamente poss√≠vel descrever o servi√ßo final de um produto espec√≠fico e uma categoria inteira de sistemas. <br><br><h3>  Declara√ß√£o de l√≥gica de processamento </h3><br>  No n√≠vel da l√≥gica de detec√ß√£o, s√£o descritos a seguir: <br><br><ul><li>  Padr√µes pesquisados </li><li>  Valores de determinados campos no log </li><li>  Prazo </li><li>  Fun√ß√µes agregadas </li></ul><br>  A l√≥gica pode ser trivial, por exemplo, condi√ß√µes impostas a um conjunto de campos: <br><br><pre> <code class="actionscript hljs">detection: selection: EventID: <span class="hljs-number"><span class="hljs-number">5140</span></span> ShareName: Admin$ filter: SubjectUserName: <span class="hljs-string"><span class="hljs-string">'*$'</span></span> condition: selection and not filter</code> </pre><br>  e bastante complicado: <br><br><pre> <code class="actionscript hljs">detection: selection1: EventID: - <span class="hljs-number"><span class="hljs-number">529</span></span> - <span class="hljs-number"><span class="hljs-number">4625</span></span> UserName: <span class="hljs-string"><span class="hljs-string">'*'</span></span> WorkstationName: <span class="hljs-string"><span class="hljs-string">'*'</span></span> selection2: EventID: <span class="hljs-number"><span class="hljs-number">4776</span></span> UserName: <span class="hljs-string"><span class="hljs-string">'*'</span></span> Workstation: <span class="hljs-string"><span class="hljs-string">'*'</span></span> timeframe: <span class="hljs-number"><span class="hljs-number">24</span></span>h condition: - selection1 | count(UserName) by WorkstationName &gt; <span class="hljs-number"><span class="hljs-number">3</span></span> - selection2 | count(UserName) by Workstation &gt; <span class="hljs-number"><span class="hljs-number">3</span></span></code> </pre><br>  Os meios expressivos da linguagem, embora n√£o sejam universais, ainda s√£o bastante amplos e permitem descrever um grande n√∫mero de casos para identificar ataques. <br><br><h2>  Ferramentas de desenvolvimento de regras </h2><br>  Al√©m do seu editor de texto favorito para YAML, a interface WEB da SOC Prime tamb√©m est√° dispon√≠vel, o que permite validar a sintaxe de uma regra j√° escrita e criar regras manualmente a partir de blocos gr√°ficos. <br><br><img src="https://habrastorage.org/webt/_a/fj/yv/_afjyva1emrq4kapfrzhsdfa25g.png"><br><br><h2>  Sigma como uma ferramenta da base de conhecimento </h2><br>  Para resumir um breve resumo. <br><br>  No momento, a sintaxe das regras concentra-se principalmente na descri√ß√£o da l√≥gica de detec√ß√£o de amea√ßas e n√£o se destina a uma descri√ß√£o abrangente do caso de uso; portanto, n√£o funcionar√° para manter uma biblioteca completa usando apenas regras Sigma. <br><br>  Para a estrutura de casos de uso que escolhemos, o Sigma fecha apenas metade (Objetivo, Requisitos de dados, L√≥gica e Prioridade). <br><br><img src="https://habrastorage.org/webt/cc/f7/ee/ccf7ee58wrz2rtolzizshobhrdi.png"><br><br><h2>  Converta para v√°rios SIEM </h2><br>  Como somos prestadores de servi√ßos SOC, a ideia de manter todos os nossos desenvolvimentos de acordo com as regras de correla√ß√£o em algum formato universal e no est√°gio de implementa√ß√£o para converter para o formato SIEM desejado nos pareceu muito atraente. <br><br>  O projeto inclui utilit√°rios de console para gerar solicita√ß√µes de eventos no formato de v√°rios SIEMs.  Considere o que √© a convers√£o e o que est√° por baixo dela. <br><br><img src="https://habrastorage.org/webt/ff/eh/6e/ffeh6eo7eo57c9jqruz-wzptwnm.png"><br><br>  A convers√£o ocorre em 3 etapas: <br><br><ol><li>  Regras de an√°lise - acho que isso est√° claro: o documento YAML √© classificado em blocos de componentes </li><li>  Redu√ß√£o √† taxonomia SIEM <br>  A necessidade desse est√°gio est√° relacionada ao fato de que a normaliza√ß√£o nos sistemas SIEM √© implementada de uma maneira um pouco diferente; portanto, as declara√ß√µes das regras Sigma precisam ser reduzidas √† taxonomia dos eventos do SIEM selecionado. </li><li>  Gera√ß√£o de solicita√ß√£o para SIEM <br>  Para que esta etapa funcione, √© necess√°rio outro componente - um back-end para este SIEM. <br>  De fato, o back-end √© um plug-in para o utilit√°rio de convers√£o, que cont√©m a l√≥gica para converter para o formato de solicita√ß√£o final no SIEM.  Os blocos de detec√ß√£o e de origem de log s√£o convertidos levando em considera√ß√£o o mapeamento de campos previamente sobrepostos, informa√ß√µes adicionais espec√≠ficas do SIEM s√£o adicionadas. <br></li></ol><br>  Como resultado, iniciar o utilit√°rio de convers√£o fica assim: <br><br><img src="https://habrastorage.org/webt/p8/co/pu/p8copuabozrkspbihteeynh_sxy.png"><br><br>  Os seguintes par√¢metros s√£o passados: <br><br><ul><li>  Target SIEM </li><li>  A regra </li><li>  Arquivo de mapeamento para este SIEM </li></ul><br><br>  O SOC Prime tamb√©m possui uma interface pronta para a fun√ß√£o de convers√£o ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">uncoder.io</a> ) <br><br><img src="https://habrastorage.org/webt/gz/-i/jj/gz-ijj-iw3bu_pcbng8orprja0w.png"><br><br><h2>  Armadilhas da convers√£o </h2><br><ul><li>  Depois de estudar a mec√¢nica da convers√£o, encontramos limita√ß√µes significativas, o que nos impediu de converter todos os desenvolvimentos para o formato Sigma: </li><li>  O conversor opera apenas com uma solicita√ß√£o.  A regra de correla√ß√£o no SIEM afeta mais aspectos: janela de tempo, agrega√ß√£o, a√ß√µes com base nos resultados dos alertas identificados </li><li>  Os principais recursos de SIEMs individuais, como ActiveLists, n√£o s√£o levados em considera√ß√£o. </li><li>  Detalhamento insuficiente do mapeamento de campo - como parte da configura√ß√£o do mapeamento, os campos de apenas algumas fontes s√£o descritos; portanto, tendo regras para v√°rias dezenas de tipos diferentes de fontes de eventos no banco de dados, voc√™ ter√° que investir muito na escrita do mapeamento. </li></ul><br><h2>  Base de regra </h2><br>  Vamos ver o que a base de regras Sigma dispon√≠vel ao p√∫blico carrega.  Atualmente, o conte√∫do est√° sendo adicionado ativamente a dois reposit√≥rios: <br><br><ul><li>  O reposit√≥rio principal do projeto </li><li>  Mercado de detec√ß√£o de amea√ßas SOC SOC </li></ul><br>  As regras nos reposit√≥rios t√™m uma interse√ß√£o diferente de zero. <br>  O SOC Prime possui v√°rias regras que se aplicam a assinaturas pagas; n√£o considero seu conte√∫do neste artigo. <br><br>  Para an√°lise, precisamos da biblioteca <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">sigmatools</a> para Python e algumas habilidades de programa√ß√£o. <br><br>  Para analisar e carregar regras de um diret√≥rio em um dicion√°rio, voc√™ pode usar o seguinte c√≥digo: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sigma.parser.collection <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> SigmaCollectionParser <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pathlib <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> itertools <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">alliter</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(path)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> sub <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> path.iterdir(): <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> sub.name.startswith(<span class="hljs-string"><span class="hljs-string">"."</span></span>): <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> sub.is_dir(): <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> alliter(sub) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> sub <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_inputs</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(paths, recursive)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> recursive: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> list(itertools.chain.from_iterable([list(alliter(pathlib.Path(p))) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> p <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> paths])) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> [pathlib.Path(p) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> p <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> paths] BASE_PATH = [<span class="hljs-string"><span class="hljs-string">r'sigma\rules'</span></span>] path_list = get_inputs(BASE_PATH, <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) rules_map = {} <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> sigmafile <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> get_inputs(BASE_PATH, <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>): f = sigmafile.open(encoding=<span class="hljs-string"><span class="hljs-string">'utf-8'</span></span>) parser = SigmaCollectionParser(f) rule = next(iter(parser)) rules_map[rule[<span class="hljs-string"><span class="hljs-string">'title'</span></span>]] = rule</code> </pre><br>  Desduplicando as mesmas regras, surge a seguinte imagem: <br><br><img src="https://habrastorage.org/webt/pd/92/jt/pd92jtrbth6glocd2kh-m9rcuqw.png"><br><br>  Como parte de uma lista exclusiva de regras, obtemos as seguintes distribui√ß√µes: <br><br>  <b>Por tipo de fonte de eventos:</b> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/av/sn/h5/avsnh5hk5_szx4lfbc7tule8d9g.png"></div><br>  Estat√≠sticas um pouco maiores <br><br><ul><li>  Windows ~ 80% </li><li>  Sysmon ~ 53% </li><li>  Proxy ~ 8% </li><li>  Linux ~ 4% </li></ul><br>  Basicamente, o conte√∫do atual se concentra no sistema Windows e Sysmon, em particular, as regras para o restante dos sistemas s√£o poucas. <br><br>  <b>Por disponibilidade de conte√∫do:</b> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/rt/v2/vd/rtv2vd91ppx816ok1jtdhchylmq.png"></div><br>  Acontece que os desenvolvedores das regras da Sigma marcaram como est√°veis ‚Äã‚Äãmenos de 20% de todas as regras existentes. <br><br><h2>  Resumir </h2><br>  Nas fontes publicamente dispon√≠veis, h√° um grande n√∫mero de regras.  Eles s√£o atualizados regularmente, e as regras para a detec√ß√£o de indicadores e, √†s vezes, at√© as t√©cnicas das empresas de alto n√≠vel do APT, aparecem rapidamente. <br><br>  Existem muitas restri√ß√µes para a aplica√ß√£o das regras na vida real: <br><br><ul><li>  Existem muitas regras para o Microsoft Sysmon, que raramente s√£o usadas na empresa. </li><li>  Existem muitas regras que realmente executam verifica√ß√µes de IoC (hashes, endere√ßos IP, URLs, agentes do usu√°rio).  Essas regras rapidamente se tornam obsoletas e existem mecanismos mais eficazes para encontrar a IoC do que regras. </li><li>  Muitos conte√∫dos experimentais, respectivamente, s√£o impostos a testes de alta qualidade antes do comissionamento. </li></ul><br>  Na Infosecurity, usamos o conte√∫do das regras Sigma como uma fonte adicional de conhecimento para uma detec√ß√£o mais eficaz de incidentes.  Se encontrarmos algo interessante, j√° o implementaremos dentro da estrutura de nossas regras de correla√ß√£o, que levar√£o em considera√ß√£o o kernel no qual as regras funcionam (Apache Spark) e as especificidades das infraestruturas e os meios de prote√ß√£o que usamos. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt442570/">https://habr.com/ru/post/pt442570/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt442558/index.html">‚ÄúSe um produto n√£o for necess√°rio, n√£o importa como voc√™ o embale, n√£o far√° sentido‚Äù: como as empresas de tecnologia trabalham em interfaces</a></li>
<li><a href="../pt442560/index.html">Mash: multithreading, coroutines, ass√≠ncrono e espera</a></li>
<li><a href="../pt442562/index.html">Como resfriar equipamentos em um data center - tr√™s novas tecnologias</a></li>
<li><a href="../pt442566/index.html">Igual √† lua: engenharia reversa de um m√≥dulo h√≠brido de amp op</a></li>
<li><a href="../pt442568/index.html">Semana 10 de seguran√ßa: Vulnerabilidades de driver NVIDIA</a></li>
<li><a href="../pt442572/index.html">Usando a ferramenta de configura√ß√£o do Datapath</a></li>
<li><a href="../pt442574/index.html">A base para uma teoria generalizada das redes neurais √© criada</a></li>
<li><a href="../pt442576/index.html">Overclockers de longa dura√ß√£o: como o resfriamento l√≠quido come√ßou a dominar nos data centers</a></li>
<li><a href="../pt442578/index.html">Lan√ßamento do Linux 5.0</a></li>
<li><a href="../pt442580/index.html">Engenharia reversa de formato bin√°rio usando arquivos .SNG da Korg como exemplo</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>