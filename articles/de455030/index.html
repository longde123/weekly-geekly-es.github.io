<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üöá üõ°Ô∏è üö∂üèº PHP-Spezifikationen ‚öíÔ∏è üöÖ üçÖ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Kurz zu den Spezifikationen: 
 Eine Spezifikation ist ein Entwurfsmuster, mit dem Sie die Regeln der Gesch√§ftslogik in Form einer Kette von Objekten w...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>PHP-Spezifikationen</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/455030/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/4f/oc/jy/4focjyd0nzj8tpdc_evzhlt4zx4.png" alt="Happyr Doctrine Spezifikation"></div><br><p>  Kurz zu den Spezifikationen: </p><br><blockquote>  Eine Spezifikation ist ein Entwurfsmuster, mit dem Sie die Regeln der Gesch√§ftslogik in Form einer Kette von Objekten widerspiegeln k√∂nnen, die durch boolesche Logikoperationen verbunden sind.  Mit den Spezifikationen k√∂nnen Sie doppelte, √§hnliche Methoden im Repository entfernen und die Gesch√§ftslogik duplizieren. </blockquote><p>  Heute gibt es zwei erfolgreiche und beliebte PHP-Projekte <em>(wenn Sie andere Projekte kennen, schreiben Sie bitte in die Kommentare)</em> , mit denen Sie Gesch√§ftsregeln in Spezifikationen beschreiben und Datens√§tze filtern k√∂nnen.  Dies sind die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Spezifikationen von RulerZ</a> und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Happyr Doctrine</a> .  Beide Projekte sind leistungsstarke Werkzeuge mit ihren Vor- und Nachteilen.  Beim Vergleich dieser Projekte wird ein ganzer Artikel gezeichnet.  Hier m√∂chte ich Ihnen sagen, was uns die neue Version in der Doctrine Specification gebracht hat. </p><a name="habracut"></a><br><h1 id="kratko-o-doctrine-specification">  Kurz √ºber die Doctrine Specification </h1><br><p> <em>Wer mit dem Projekt mehr oder weniger vertraut ist, kann diesen Abschnitt sicher <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">√ºberspringen</a> .</em> </p><br><p>  Mit Hilfe dieses Projekts k√∂nnen Sie Spezifikationen in Form von Objekten beschreiben, diese aus der Komposition zusammensetzen und dadurch komplexe Gesch√§ftsregeln erstellen.  Die resultierenden Zusammensetzungen k√∂nnen frei wiederverwendet und zu noch komplexeren Zusammensetzungen kombiniert werden, die leicht zu testen sind.  Die Doctrine-Spezifikation wird verwendet, um Doctrine-Abfragen zu erstellen.  Im Wesentlichen ist die Doctrine-Spezifikation die Abstraktionsebene √ºber den Doctrine ORM QueryBuilder und die Doctrine ORM Query. </p><br><p>  Die Spezifikationen gelten √ºber das Doctrine Repository: </p><br><pre><code class="php hljs">$result = $em-&gt;getRepository(MyEntity::class)-&gt;match($spec);</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Die Spezifikation kann manuell angewendet werden, ist jedoch nicht besonders praktisch und auf lange Sicht sinnlos.</b> <div class="spoiler_text"><pre> <code class="php hljs">$spec = ... $alias = <span class="hljs-string"><span class="hljs-string">'e'</span></span>; $qb = $em-&gt;getRepository(MyEntity::class)-&gt;createQueryBuilder($alias); $spec-&gt;modify($qb, $alias); $filter = (string) $spec-&gt;getFilter($qb, $alias); $qb-&gt;andWhere($filter); $result = $qb-&gt;getQuery()-&gt;execute();</code> </pre> </div></div><br><p>  Es gibt verschiedene Methoden im Repository: </p><br><ul><li>  <code>match</code> - alle Ergebnisse erhalten, die der Spezifikation entsprechen; </li><li>  <code>matchSingleResult</code> - √Ñquivalent zu <code>Query::getSingleResult()</code> ; </li><li>  <code>matchOneOrNullResult</code> - entspricht <code>matchSingleResult</code> , l√§sst jedoch <code>null</code> ; </li><li>  <code>getQuery</code> - <code>getQuery</code> einen QueryBuilder, indem eine Spezifikation darauf angewendet wird, und gibt ein Query-Objekt daraus zur√ºck. </li></ul><br><p>  K√ºrzlich wurde ihnen die Methode <code>getQueryBuilder</code> hinzugef√ºgt, mit der ein QueryBuilder erstellt und unter Anwendung der Spezifikation zur√ºckgegeben wird. </p><br><p>  Das Projekt identifiziert verschiedene Arten von Spezifikationen: </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Logische Spezifikationen</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Filterspezifikation</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Abfragemodifikatoren</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Ergebnismodifikatoren</a> </li></ul><br><h2 id="logicheskie-specifikacii">  Logische Spezifikationen </h2><br><p>  Die <code>andX</code> und <code>orX</code> dienen auch als Sammlung von Spezifikationen. </p><br><ul><li> <code>Spec::andX()</code> </li> <li> <code>Spec::orX()</code> </li> <li> <code>Spec::not()</code> </li> </ul><br><p>  Es ist √ºblich, Objekte mit Bibliotheksspezifikationen √ºber die Spezifikationsfassade zu installieren, dies ist jedoch nicht erforderlich.  Sie k√∂nnen das Spezifikationsobjekt explizit instanziieren: </p><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">new</span></span> AndX(); <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> OrX(): <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Not();</code> </pre> <br><h2 id="filtruyuschie-specifikacii">  Filterspezifikation </h2><br><p>  Filterspezifikationen bilden tats√§chlich die Regeln der Gesch√§ftslogik und werden in der <code>WHERE</code> Anforderung verwendet.  Dazu geh√∂ren Vergleichsoperationen: </p><br><ul><li>  <code>isNull</code> - SQL ist <code>IS NULL</code> √§quivalent </li><li>  <code>isNotNull</code> - SQL ist <code>IS NOT NULL</code> √§quivalent </li><li>  <code>in</code> - √§quivalent zu <code>IN ()</code> </li><li>  <code>notIn</code> - <code>NOT IN ()</code> √§quivalent </li><li>  <code>eq</code> - Gleichheitstest <code>=</code> </li><li>  <code>neq</code> - auf Ungleichheit pr√ºfen <code>!=</code> </li><li>  <code>lt</code> weniger als <code>&lt;</code> </li><li>  <code>lte</code> - kleiner oder gleich <code>&lt;=</code> </li><li>  <code>gt</code> - mehr als <code>&gt;</code> </li><li>  <code>gte</code> - gr√∂√üer oder gleich <code>&gt;=</code> </li><li>  <code>like</code> - SQL <code>LIKE</code> √Ñquivalent </li><li>  <code>instanceOfX</code> - √Ñquivalent zu DQL <code>INSTANCE OF</code> </li></ul><br><p>  Ein Beispiel f√ºr die Verwendung von Filterspezifikationen: </p><br><pre> <code class="php hljs">$spec = Spec::andX( Spec::eq(<span class="hljs-string"><span class="hljs-string">'ended'</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>), Spec::orX( Spec::lt(<span class="hljs-string"><span class="hljs-string">'endDate'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> \DateTime()), Spec::andX( Spec::isNull(<span class="hljs-string"><span class="hljs-string">'endDate'</span></span>), Spec::lt(<span class="hljs-string"><span class="hljs-string">'startDate'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> \DateTime(<span class="hljs-string"><span class="hljs-string">'-4 weeks'</span></span>)) ) ) );</code> </pre> <br><h2 id="modifikatory-zaprosa">  Abfragemodifikatoren </h2><br><p>  Abfragemodifikatoren haben nichts mit Gesch√§ftslogik und Gesch√§ftsregeln zu tun.  Wie der Name schon sagt, √§ndern sie nur QueryBuilder.  Der Name und der Zweck der vordefinierten Modifikatoren entsprechen √§hnlichen Methoden in QueryBuilder. </p><br><ul><li> <code>join</code> </li> <li> <code>leftJoin</code> </li> <li> <code>innerJoin</code> </li> <li> <code>limit</code> </li> <li> <code>offset</code> </li> <li> <code>orderBy</code> </li> <li> <code>groupBy</code> </li> <li> <code>having</code> </li> </ul><br><p>  Ich m√∂chte den <code>slice</code> Modifikator separat notieren.  Es kombiniert die Funktionen <code>limit</code> und <code>offset</code> und berechnet den Offset basierend auf der Gr√∂√üe des Slice und seiner Seriennummer.  Bei der Implementierung dieses Modifikators waren wir mit dem Autor des Projekts nicht einverstanden.  Mit der Erstellung eines Modifikators verfolgte ich das Ziel, die Konfiguration von Spezifikationen w√§hrend der Paginierung zu vereinfachen.  In diesem Zusammenhang sollte die erste Seite mit der Seriennummer 1 dem ersten Slice mit der Seriennummer 1 entsprechen. Der Autor des Projekts hielt es jedoch f√ºr richtig, die Z√§hlung im Programmierstil zu starten, dh 0. Daher sollten Sie angeben, dass Sie angeben m√ºssen, wenn Sie das erste Slice ben√∂tigen 0 als Seriennummer. </p><br><h2 id="modifikatory-rezultata">  Ergebnismodifikatoren </h2><br><p>  Ergebnismodifikatoren existieren geringf√ºgig au√üerhalb der Spezifikationen.  Sie gelten f√ºr Doctrine Query.  Die folgenden Modifikatoren steuern die <code>Query::setHydrationMode()</code> ): </p><br><ul><li> <code>asArray</code> </li> <li> <code>asSingleScalar</code> </li> <li> <code>asScalar</code> </li> </ul><br><p>  Der <code>cache</code> Modifikator steuert das Caching des Abfrageergebnisses. </p><br><p>  Wir sollten auch den Modifikator <code>roundDateTimeParams</code> .  Es hilft bei der L√∂sung von Caching-Problemen, wenn Sie mit Gesch√§ftsregeln arbeiten m√ºssen, bei denen einige Werte mit der aktuellen Zeit verglichen werden m√ºssen.  Dies sind normale Gesch√§ftsregeln, aber aufgrund der Tatsache, dass die Zeit keine Konstante ist, funktioniert das Zwischenspeichern f√ºr mehr als eine Sekunde f√ºr Sie nicht.  Der Modifikator <code>roundDateTimeParams</code> entwickelt, um dieses Problem zu l√∂sen.  Es durchl√§uft alle Parameter der Anforderung, sucht nach dem darin enthaltenen Datum und rundet es auf den angegebenen Wert ab. Dadurch erhalten wir Datumswerte, die immer ein Vielfaches eines Werts sind, und wir werden das Datum in Zukunft nicht mehr erhalten.  Das hei√üt, wenn wir die Anforderung 10 Minuten zwischenspeichern m√∂chten, verwenden wir <code>Spec::cache(600)</code> und <code>Spec::roundDateTimeParams(600)</code> .  Urspr√ºnglich wurde vorgeschlagen, diese beiden Modifikatoren der Einfachheit halber zu kombinieren, es wurde jedoch beschlossen, sie f√ºr SRP zu trennen. </p><br><h1 id="vstroennye-specifikacii">  Eingebettete Spezifikationen </h1><br><p>  Die Happyr Doctrine-Spezifikation verf√ºgt √ºber eine separate Schnittstelle f√ºr Spezifikationen, die einen Filter und einen Anforderungsmodifikator kombiniert.  Die einzige vordefinierte Spezifikation ist <code>countOf</code> der Sie die Anzahl der Entit√§ten ermitteln k√∂nnen, die der Spezifikation entsprechen.  Um Ihre eigenen Spezifikationen zu erstellen, ist es √ºblich, die abstrakte <code>BaseSpecification</code> Klasse zu erweitern. </p><br><h1 id="novovvedeniya">  Innovationen </h1><br><p>  Dem Repository wurden neue Methoden hinzugef√ºgt: </p><br><ul><li>  <code>matchSingleScalarResult</code> - √Ñquivalent zu <code>Query::getSingleScalarResult()</code> ; </li><li>  <code>matchScalarResult</code> - entspricht <code>Query::getScalarResult()</code> ; </li><li>  <code>iterate</code> ist das √Ñquivalent von <code>Query::iterate()</code> . </li></ul><br><p>  Die <code>MemberOfX</code> Spezifikation wird <code>MemberOfX</code> - das DQL-√Ñquivalent von <code>MEMBER OF</code> und der Abfragemodifikator <code>indexBy</code> werden <code>indexBy</code> - das √Ñquivalent von <code>QueryBuilder::indexBy()</code> . </p><br><h2 id="operandy">  Operanden </h2><br><p>  Die neue Version f√ºhrt das Konzept des <strong>Operanden ein</strong> .  Alle Bedingungen in den Filtern bestehen aus linken und rechten Operanden und einem Operator dazwischen. </p><br><pre> <code class="plaintext hljs">&lt;left_operand&gt; &lt;operator&gt; &lt;right_operand&gt;</code> </pre> <br><p>  In fr√ºheren Versionen konnte der linke Operand nur ein Entit√§tsfeld und der rechte Operand nur ein Wert sein.  Dies ist ein einfacher und effektiver Mechanismus, der f√ºr die meisten Aufgaben ausreicht.  Gleichzeitig werden bestimmte Einschr√§nkungen auferlegt: </p><br><ul><li>  Funktionen k√∂nnen nicht verwendet werden; </li><li>  Aliase k√∂nnen nicht f√ºr Felder verwendet werden. </li><li>  Es ist unm√∂glich, zwei Felder zu vergleichen. </li><li>  Es ist unm√∂glich, zwei Werte zu vergleichen; </li><li>  Arithmetische Operationen k√∂nnen nicht verwendet werden. </li><li>  Datentyp f√ºr Wert kann nicht angegeben werden. </li></ul><br><p>  In der neuen Version werden Operandenobjekte in Argumenten an die Filter √ºbergeben und ihre Transformation in DQL an die Operanden selbst delegiert.  Dies er√∂ffnet viele M√∂glichkeiten und erleichtert Filter. </p><br><h3 id="pole-i-znachenie">  Feld und Wert </h3><br><p>  Um die Abw√§rtskompatibilit√§t aufrechtzuerhalten, wird das erste Argument in den Filtern in einen Feldoperanden konvertiert, wenn es kein Operand ist, und das letzte Argument wird in einen Wertoperanden konvertiert.  Daher sollten Sie keine Probleme beim Aktualisieren haben. </p><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">// DQL: e.day &gt; :day Spec::gt('day', $day); // or Spec::gt(Spec::field('day'), $day); // or Spec::gt(Spec::field('day', $dqlAlias), $day);</span></span></code> </pre> <br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">// DQL: e.day &gt; :day Spec::gt('day', $day); // or Spec::gt('day', Spec::value($day)); // or Spec::gt('day', Spec::value($day, Type::DATE));</span></span></code> </pre> <br><p>  Sie k√∂nnen 2 Felder vergleichen: </p><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">// DQL: e.price_current &lt; e.price_old Spec::lt(Spec::field('price_current'), Spec::field('price_old'));</span></span></code> </pre> <br><p>  Sie k√∂nnen 2 Felder verschiedener Entit√§ten vergleichen: </p><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">// DQL: a.email = u.email Spec::eq(Spec::field('email', 'a'), Spec::field('email', 'u'));</span></span></code> </pre> <br><h3 id="arifmeticheskie-operacii">  Arithmetische Operationen </h3><br><p>  Unterst√ºtzung f√ºr Standard-Arithmetikoperationen hinzugef√ºgt <code>-</code> , <code>+</code> , <code>*</code> , <code>/</code> , <code>%</code> .  Betrachten Sie beispielsweise die Berechnung von Benutzerpunkten: </p><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">// DQL: e.posts_count + e.likes_count &gt; :user_score Spec::gt( Spec::add(Spec::field('posts_count'), Spec::field('likes_count')), $user_score );</span></span></code> </pre> <br><p>  Arithmetische Operationen k√∂nnen ineinander verschachtelt werden: </p><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">// DQL: ((e.price_old - e.price_current) / (e.price_current / 100)) &gt; :discount Spec::gt( Spec::div( Spec::sub(Spec::field('price_old'), Spec::field('price_current')), Spec::div(Spec::field('price_current'), Spec::value(100)) ), Spec::value($discount) );</span></span></code> </pre> <br><h3 id="funkcii">  Funktionen </h3><br><p>  Die neue Version f√ºgte Operanden mit Funktionen hinzu.  Sie k√∂nnen als statische Methoden der <code>Spec</code> Klasse oder √ºber die <code>Spec::fun()</code> -Methode verwendet werden. </p><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">// DQL: size(e.products) &gt; 2 Spec::gt(Spec::size('products'), 2); // or Spec::gt(Spec::fun('size', 'products'), 2); // or Spec::gt(Spec::fun('size', Spec::field('products')), 2);</span></span></code> </pre> <br><p>  Funktionen k√∂nnen ineinander verschachtelt werden: </p><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">// DQL: trim(lower(e.email)) = :email Spec::eq(Spec::trim(Spec::lower('email')), trim(strtolower($email))); // or Spec::eq( Spec::fun('trim', Spec::fun('lower', Spec::field('email'))), trim(strtolower($email)) );</span></span></code> </pre> <br><p>  Argumente f√ºr Funktionen k√∂nnen als separate Argumente oder durch √úbergabe in einem Array √ºbergeben werden: </p><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">// DQL: DATE_DIFF(e.create_at, :date) Spec::DATE_DIFF('create_at', $date); // or Spec::DATE_DIFF(['create_at', $date]); // or Spec::fun('DATE_DIFF', 'create_at', $date); // or Spec::fun('DATE_DIFF', ['create_at', $date]);</span></span></code> </pre> <br><h2 id="upravlenie-vyborkoy">  Probenahmeverwaltung </h2><br><p>  Manchmal m√ºssen Sie eine Liste von R√ºckgabewerten verwalten.  Zum Beispiel: </p><br><ul><li>  F√ºgen Sie dem Ergebnis eine weitere Entit√§t hinzu, um keine Unterabfragen zum Abrufen der Links durchzuf√ºhren. </li><li>  Nicht die gesamte Entit√§t zur√ºckgeben, sondern nur eine Reihe separater Felder; </li><li>  Verwenden Sie Aliase. </li><li>  Verwenden Sie versteckte Aliase mit Sortierbedingungen (es erfordert Doctrine, aber sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">versprechen, es zu beheben</a> ). </li></ul><br><p>  Vor Version 0.8.0 mussten f√ºr diese Aufgaben Spezifikationen f√ºr diese Anforderungen erstellt werden.  Ab Version 0.8.0 k√∂nnen Sie die Methode <code>getQueryBuilder()</code> verwenden und die Auswahl √ºber die QueryBuilder-Oberfl√§che verwalten. </p><br><p>  Die neue Version 1.0.0 f√ºgt <code>select</code> Anforderungsmodifikatoren <code>select</code> und <code>addSelect</code> hinzu.  <code>select</code> ersetzt die Liste der ausw√§hlbaren Werte vollst√§ndig und <code>addSelect</code> f√ºgt der Liste neue Werte hinzu.  Als Wert k√∂nnen Sie ein Objekt verwenden, das die <code>Selection</code> oder einen Filter implementiert.  Auf diese Weise k√∂nnen Sie die Funktionen der Bibliothek an Ihre Anforderungen anpassen.  Betrachten Sie die M√∂glichkeiten, die bereits vorhanden sind. </p><br><p>  Sie k√∂nnen ein Feld ausw√§hlen: </p><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">// DQL: SELECT e.email FROM ... Spec::select('email') // or Spec::select(Spec::field('email'))</span></span></code> </pre> <br><p>  Sie k√∂nnen der Auswahl ein Feld hinzuf√ºgen: </p><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">// DQL: SELECT e, u.email FROM ... Spec::addSelect(Spec::field('email', $dqlAlias))</span></span></code> </pre> <br><p>  Sie k√∂nnen mehrere Felder ausw√§hlen: </p><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">// DQL: SELECT e.title, e.cover, u.name, u.avatar FROM ... Spec::andX( Spec::select('title', 'cover'), Spec::addSelect(Spec::field('name', $dqlAlias), Spec::field('avatar', $dqlAlias)) )</span></span></code> </pre> <br><p>  Sie k√∂nnen den zur√ºckgegebenen Werten eine Entit√§t hinzuf√ºgen: </p><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">// DQL: SELECT e, u FROM ... Spec::addSelect(Spec::selectEntity($dqlAlias))</span></span></code> </pre> <br><p>  Sie k√∂nnen Aliase f√ºr ausw√§hlbare Felder verwenden: </p><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">// DQL: SELECT e.name AS author FROM ... Spec::select(Spec::selectAs(Spec::field('name'), 'author'))</span></span></code> </pre> <br><p>  Sie k√∂nnen der Auswahl ausgeblendete Felder hinzuf√ºgen: </p><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">// DQL: SELECT e, u.name AS HIDDEN author FROM ... Spec::addSelect(Spec::selectHiddenAs(Spec::field('email', $dqlAlias), 'author')))</span></span></code> </pre> <br><p>  Sie k√∂nnen beispielsweise Ausdr√ºcke verwenden, um einen Rabatt auf ein Produkt zu erhalten: </p><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">// DQL: SELECT (e.price_old is not null and e.price_current &lt; e.price_old) AS discount FROM ... Spec::select(Spec::selectAs( Spec::andX( Spec::isNotNull('price_old'), Spec::lt(Spec::field('price_current'), Spec::field('price_old')) ), 'discount' ))</span></span></code> </pre> <br><p>  Sie k√∂nnen Aliase in den Spezifikationen verwenden: </p><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">// DQL: SELECT e.price_current AS price FROM ... WHERE price &lt; :low_cost_limit Spec::andX( Spec::select(Spec::selectAs('price_current', 'price')), Spec::lt(Spec::alias('price'), $low_cost_limit) )</span></span></code> </pre> <br><p>  Das ist im Grunde alles.  Hier enden die Innovationen.  Die neue Version hat viele interessante und n√ºtzliche Funktionen gebracht.  Ich hoffe sie haben dich interessiert. </p><br><p>  <em>PS: Ich kann anhand eines Beispiels die Verwendung von Spezifikationen analysieren und die Vor- und Nachteile ihrer Verwendung aufzeigen.</em>  <em>Wenn dies f√ºr Sie interessant ist, schreiben Sie in die Kommentare oder in PM.</em> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de455030/">https://habr.com/ru/post/de455030/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de455016/index.html">Wir erstellen die unzug√§nglichste Website mit einer idealen Bewertung Leuchtturm</a></li>
<li><a href="../de455018/index.html">Der Posten der gro√üen Liebe f√ºr kleine Unternehmen</a></li>
<li><a href="../de455020/index.html">Vor- und Nachteile der Verwendung von Flutter f√ºr die mobile Entwicklung</a></li>
<li><a href="../de455024/index.html">5 Common-Sense-Prinzipien zum Erstellen von Cloud-nativen Apps</a></li>
<li><a href="../de455026/index.html">Telefonie mit Snom: f√ºr diejenigen, die zu Hause arbeiten</a></li>
<li><a href="../de455032/index.html">Kein Fehler, sondern ein Merkmal: eine Untersuchung der Motilit√§t und Gehirnaktivit√§t einer Person mit Polydaktylie</a></li>
<li><a href="../de455038/index.html">Wie Plesk die KubeCon besucht hat</a></li>
<li><a href="../de455040/index.html">Verbesserung der Arbeit von Wi-Fi. Teil 2. Ausstattungsmerkmale</a></li>
<li><a href="../de455042/index.html">Kotlin DSL, Fixtures und elegante UI-Tests in Android</a></li>
<li><a href="../de455046/index.html">N + 7 n√ºtzliche B√ºcher</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>