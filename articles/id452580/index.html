<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🏂🏻 🎳 👐🏻 20 proyek, 20 bahasa, batas waktu kemarin. Bagian 3 🔝 🦔 💪🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Artikel terakhir tentang integrasi Serge + Smartcat . Dalam artikel ini, saya akan memberi tahu Anda bagaimana kami mengukur Serge ke seluruh perusaha...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>20 proyek, 20 bahasa, batas waktu kemarin. Bagian 3</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/452580/"> Artikel terakhir tentang <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">integrasi</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Serge</a> + <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Smartcat</a> .  Dalam artikel ini, saya akan memberi tahu Anda bagaimana kami mengukur Serge ke seluruh perusahaan, mempertimbangkan 4 integrasi non-standar dan, sebagai bonus, berbicara tentang 2 fitur yang dapat menyederhanakan hidup Anda. <br><br>  Artikel sebelumnya: <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">20 proyek, 20 bahasa, batas waktu kemarin</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">20 proyek, 20 bahasa, batas waktu kemarin.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Bagian 2</a> <br><a name="habracut"></a><br><h2>  Skalabilitas </h2><br>  Dalam artikel sebelumnya, saya berbicara tentang cara mengkonfigurasi Serge untuk repositori tunggal.  Di perusahaan kami, kami memiliki beberapa lusin repositori yang membutuhkan terjemahan, sehingga server terpisah untuk pelokalan dialokasikan.  Struktur file dan lingkungan di atasnya benar-benar identik dengan apa yang dijelaskan dalam artikel sebelumnya.  Setiap repositori menggunakan instance Serge-nya sendiri.  Agar tidak menjalankan perintah secara manual, setiap instance memiliki mahkota, yang secara berturut-turut menjalankan perintah Serge: menerima baris baru dari repositori, menerima terjemahan baru, penguraian, mengirim baris baru ke Smartcat dan mengirim terjemahan baru ke Gitlab. <br><br><h2>  Opsi integrasi </h2><br><h3>  Dua set bahasa dalam satu repositori </h3><br>  Mari kita mulai dengan kasing paling sederhana.  Bayangkan repositori Anda memiliki beberapa set file sumber daya.  Sebagai contoh, string klien dan API aplikasi disimpan dalam repositori yang sama, tetapi dalam direktori yang berbeda.  Klien diterjemahkan ke dalam 20 bahasa, API ke dalam 6. <br><br>  <b>Tujuan</b> : untuk mengatur persediaan terjemahan yang independen di setiap direktori. <br>  <b>Solusi</b> : <br><br><ol><li>  Menyiapkan 2 proyek di Smartcat: dalam 6 bahasa dan dalam 20. </li><li>  Menyiapkan 2 proyek di server pelokalan. </li><li>  Pada proyek pertama, tambahkan baris <i>$ unmerged_branch_mask = '^ (translateAPI-)' kami</i> di file <b>project1.cfg</b> <i>;</i>  <i># proses cabut cabang yang tidak cocok dengan topeng ini</i> , di mana " <i>translateAPI-</i> " adalah awalan nama cabang.  Awalan akan menunjukkan kepada Serge bahwa cabang ini membutuhkan terjemahan di direktori API. </li><li>  Dalam file <b>project1.serge.tmpl</b> , tentukan path ke file sumber daya di direktori API di parameter <i>source_dir</i> . </li><li>  Demikian pula, untuk proyek kedua dalam file <b>project2.cfg</b> tambahkan baris <i>$ unmerged_branch_mask kami = '^ (translateCLIENT-)';</i>  <i># memproses cabang-cabang yang tidak digabung yang cocok dengan topeng ini</i> , di mana " <i>translateCLIENT</i> " adalah awalan untuk cabang-cabang dari proyek ini.  Awalan akan menunjukkan kepada Serge bahwa cabang ini membutuhkan terjemahan di direktori Klien. </li><li>  Dalam file <b>project2.serge.tmpl</b> , tentukan path ke file sumber daya di direktori CLIENT dalam parameter <i>source_dir</i> . </li></ol><br>  Harap dicatat bahwa awalan harus unik di antara semua proyek yang dikonfigurasi untuk satu repositori. <br><br>  Secara total, kami memiliki 2 proyek di Smartcat dan 2 proyek yang sesuai di server lokalisasi.  Kedua proyek melihat repositori yang sama di Gitlab, tetapi di direktori yang berbeda.  Serge, menggunakan awalan cabang, mengerti baris mana yang harus dia kirim untuk terjemahan.  Untuk menghitung diff, cabang-basis terjemahan yang sama digunakan. <br><br><h3>  Kesombongan Lokalisasi </h3><br>  Di perusahaan kami, semua produk, termasuk dokumentasi, dilokalkan.  Sekarang kami memperkenalkan dokumentasi auto-generation dari angkuh, dan kami dihadapkan dengan kebutuhan untuk melokalisasikannya. <br>  <b>Tugas</b> : melokalkan kesombongan dengan sedikit usaha. <br><br>  <b>Solusi</b> : Dalam file <b>myproject.tmpl.serge</b> , tambahkan objek <i>data</i> ke objek <i>parser</i> dan cantumkan di dalamnya bidang-bidang yang nilainya harus diekstraksi dan dikirim untuk diterjemahkan: <br><br><pre><code class="bash hljs">parser { plugin parse_json data { path_matches \/(summary|description)$ } }</code> </pre> <br>  <b>Tugas serupa</b> : perlu menerjemahkan teks dari file, tetapi tidak semua, tetapi hanya yang legal.  Teks-teks lain disediakan oleh tim pemasaran.  Agar tidak menyulitkan struktur dan tidak membuat file tambahan untuk teks hukum, kunci dari semua baris hukum menerima awalan "legal": <br><br><pre> <code class="bash hljs">parser { plugin parse_json data { path_matches ^\/legal\..* } }</code> </pre><br><h3>  Seluk-beluk terjemahan hukum </h3><br>  Kasus lain yang menarik.  Kami memiliki dokumen hukum, yang persyaratannya bervariasi dari satu negara ke negara.  Tetapi, bagaimanapun, ini adalah satu aplikasi dan file sumber daya berada di direktori yang sama. <br><br>  <b>Tujuan</b> : dalam rangka satu proyek untuk menerjemahkan beberapa dokumen, setiap dokumen harus diterjemahkan ke dalam satu bahasa tertentu. <br><br>  <b>Apa yang telah dilakukan</b> : <br><br><ol><li>  Direktori yang sesuai dibuat untuk setiap negara, di dalamnya terdapat file sumber bahasa Inggris yang relevan dengan negara itu. </li><li>  Path untuk variabel <i>source_dir</i> ditentukan ke direktori bersama dengan file sumber. </li><li>  Kami mengaktifkan pencarian untuk file sumber di semua <i>subdirektori</i> : <i>source_process_subdirs YA</i> </li><li>  Kami menambahkan plugin baru ke daftar yang disebut plug-in, yang memungkinkan Anda mengirim setiap file sumber daya spesifik ke bahasa yang diinginkan.  Sebagai panduan, gunakan nama direktori tempat ia berada: </li></ol><br><pre> <code class="bash hljs">callback_plugins { :feature_branch { plugin feature_branch data { master_job job.base-translate } } :limit_languages { plugin limit_languages data { <span class="hljs-comment"><span class="hljs-comment"># all rules are processed top to bottom; each rule can add or remove languages # so the most priority rules are placed at the bottom if { # by default, don't localize file_matches . then { exclude_all_languages YES } } if { file_matches de-au\/ then { include_languages de-AT } } if { file_matches li-LI\/ then { include_languages li } } if { file_matches pt\/ then { include_languages pt-BR } } if { file_matches zh-Hans\/ then { include_languages zh-Hans } } # and so on.. } }</span></span></code> </pre><br><h3>  Lokalisasi saat menyimpan baris dalam database </h3><br>  Sistem kami memiliki bagian dari kode yang menyimpan terjemahan dalam database, dan karena beberapa alasan ia tidak dapat pindah ke file sumber daya dalam repositori.  Namun, kami harus dapat mengirimkan terjemahan dengan cepat dan otomatis. <br><br>  <b>Tugas</b> : Mengatur proses pelokalan berkelanjutan jika baris tidak disimpan dalam repositori, tetapi dalam database. <br><br>  <b>Solusi</b> : <br><br><ol><li>  Buat repositori, kumpulkan, dan kelompokkan di dalamnya semua baris dari database sesuai dengan prinsip yang nyaman bagi kami (dengan jumlah bahasa terjemahan atau produk). </li><li>  Buat proyek di Smartcat. </li><li>  Mulai siklus standar pelokalan berkelanjutan. </li><li>  Gabungkan cabang terjemahan ke cabang terjemahan dasar. </li><li>  Dengan mahkota, periksa nilai hash dari commit terakhir di base-translate.  Jika hash telah berubah, yaitu, terjemahan baru telah dihasilkan, parsing perbedaan antara hash lama dan saat ini, dan kirim baris baru / ubah ke basis data. </li></ol><br><h2>  Fitur Bonus </h2><br><h3>  Lansiran </h3><br>  Lansiran Smartcat dasar tidak cocok untuk kami, karena setiap tim ingin menerima pemberitahuan hanya tentang cabang-cabangnya dan hanya tentang kesiapan terjemahan yang lengkap di semua file sumber daya produk. <br><br>  Diputuskan untuk membangun ketersediaan semua terjemahan dalam repositori dan, jika sudah sepenuhnya siap, kirim pemberitahuan ke messenger perusahaan, dalam kasus kami, Google Chat. <br><br>  <b>Tugas</b> : mengatur peringatan di repositori, tempat 8 tim dapat melakukan, menduplikasi semua peringatan di saluran departemen dokumentasi teknis. <br><br>  <b>Solusi</b> : <br><br><ol><li>  Setuju dengan masing-masing tim bahwa nama cabang harus berisi nama tim.  Masih menggunakan terjemahan awalan- untuk menunjukkan cabang yang perlu diterjemahkan. </li><li>  Buat pipa yang hanya berjalan untuk cabang yang diawali dengan translate-. </li><li>  Di jalur pipa, tentukan perintah yang dimiliki cabang, periksa keberadaan garis dengan nilai kosong, dan, jika tidak ada, kirim pemberitahuan kesiapan ke saluran yang sesuai.  Karena kodenya cukup banyak, saya memasukkannya ke dalam skrip. </li></ol><br><h4>  Ci </h4><br><pre> <code class="bash hljs">check-translations: stage: check-translations image: node:8.14.0 tags: - devops script: - chmod +x ./notification.sh - ./notification.sh only: - base-translate - /^translate.*$/ when: always</code> </pre><br><h4>  Alert Script </h4><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash hangouts(){ curl -X POST --max-time 180 -H "Content-Type: application/json; charset=UTF-8" --data "{ \"cards\": [{\"header\": {\"title\": \"LOCALIZATION IS READY\",\"subtitle\": \"REPOSITORY NAME\",\"imageUrl\": \"https://avatanplus.com/files/resources/mid/5775880ee27f8155a31b7a50.png\"},\"sections\": [{\"widgets\": [{\"keyValue\": {\"topLabel\": \"Translation is finished in the branch\",\"content\": \"$1\"}}]},{\"widgets\": [{\"buttons\": [{\"textButton\": {\"text\": \"SEE COMMIT\",\"onClick\": {\"openLink\": {\"url\": \"https://gitlab.loc/common/publisher-client/commit/$2\"}}}}]}]}]}]}" "$3" || true } cd app/translations if echo "$CI_COMMIT_REF_NAME" | grep "commandname1"; then grep -rl '\:\s\"\"' *.json &gt;&gt; result.file if [ -s network.file ]; then echo "Translations are not ready"; cat result.file else hangouts $CI_COMMIT_REF_NAME $CI_COMMIT_SHA $HANGOUTS_NOTIFICATIONS_COMMAND_NAME_1 hangouts $CI_COMMIT_REF_NAME $CI_COMMIT_SHA $HANGOUTS_NOTIFICATIONS_DOC fi fi if echo "$CI_COMMIT_REF_NAME" | grep "commandname2"; then grep -rl '\:\s\"\"' *.json &gt;&gt; result.file if [ -s result.file ]; then echo "Translations are not ready"; cat result.file else hangouts $CI_COMMIT_REF_NAME $CI_COMMIT_SHA $HANGOUTS_NOTIFICATIONS_COMMAND_NAME_2 hangouts $CI_COMMIT_REF_NAME $CI_COMMIT_SHA $HANGOUTS_NOTIFICATIONS_DOC fi fi ... if echo "$CI_COMMIT_REF_NAME" | grep "commandname8"; then grep -rl '\:\s\"\"' *.json &gt;&gt; result.file if [ -s result.file ]; then echo "Translations are not ready"; cat result.file else hangouts $CI_COMMIT_REF_NAME $CI_COMMIT_SHA $HANGOUTS_NOTIFICATIONS_COMMAND_NAME_8 hangouts $CI_COMMIT_REF_NAME $CI_COMMIT_SHA $HANGOUTS_NOTIFICATIONS_DOC fi fi</span></span></code> </pre><br><h3>  Tugas Penerjemah melalui Smartcat API </h3><br><img src="https://habrastorage.org/webt/to/a5/ix/toa5ixiw7yebxjc5v7ejuyqskmy.jpeg"><br><br>  Ini adalah apa yang tampak seperti manajer lokalisasi kami ketika tiba saatnya untuk menetapkan semua cabang untuk terjemahan. <br><br>  Rata-rata, kami memiliki lebih dari 10 cabang dalam pekerjaan kami setiap hari.  Di Smartcat, setiap pasangan bahasa adalah dokumen terpisah, dan penerjemah harus ditugaskan untuk setiap dokumen tersebut.  Secara manual.  Bayangkan: 40-60 janji setiap hari.  Untuk menyederhanakan proses ini, kami membuat janji melalui API, dan juga memasukkannya ke dalam saluran pipa.  Pekerjaan ini diluncurkan oleh tombol.  Sebuah pertanyaan yang masuk akal: mengapa tidak membuat penugasan otomatis saat mengirim transfer, dan tidak menempatkan pemanggilan metode pada plugin Smartcat, dan tidak dalam pipa? <br><br>  Ada beberapa alasan untuk keputusan ini: <br><br><ol><li>  Faktor manusia.  Terlepas dari kenyataan bahwa kami membangun proses dan mencoba untuk mematuhinya, baris atau garis yang belum dibaca tanpa konteks secara teratur masuk ke Smartcat.  Penugasan otomatis dalam hal ini akan berarti biaya tambahan bagi kami, karena beberapa baris akan dikirim untuk terjemahan dua kali: sebelum dan setelah pengeditan. </li><li>  Distribusi peran.  Proyek dikonfigurasikan dan dikelola di tingkat server pelokalan oleh insinyur pelokalan atau penulis teknis proyek.  Janji temu dan komunikasi dengan penerjemah ditangani oleh manajer pelokalan.  Dengan demikian, penugasan harus dapat dikelola, transparan, dan dapat diakses melalui GUI. </li></ol><br>  Solusi: ketika manajer lokalisasi menganggap bahwa garis-garis di cabang ini siap untuk terjemahan, ia menekan tombol di Gitlab.  Seluruh tim penerjemah ditugaskan ke cabang ini.  Tugas ini diambil oleh penerjemah yang merespons pertama. <br><br><h4>  Ci </h4><br><pre> <code class="bash hljs">assignee: stage: assignee image: node:8.14.0 tags: - devops script: - chmod +x ./assignee.sh - ./assignee.sh only: - base-translate - /^translate.*$/ - assignee when: manual</code> </pre><br><h4>  Skrip penugasan </h4><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash if echo "$CI_COMMIT_REF_NAME" | grep "translate-"; then node -pe "JSON.parse(process.argv[1]).documents.forEach(function(elem){ if(elem.name.indexOf(\"$CI_COMMIT_REF_NAME\") !== -1) { console.log(elem.id) } });" "$(curl -XGET -H "Authorization: Basic $SMARTCAT_API_KEY" -H "Content-type: application/json" "https://smartcat.ai/api/integration/v1/project/$SMARTCAT_PROJECT_ID")" &gt;&gt; documents fi sed '$d' documents &gt; documents.list while read LINE; do bash -c "curl -XPOST -H 'Authorization: Basic $SMARTCAT_API_KEY' -H "Content-type:application/json" -d '{"documentIds":[\""$LINE"\"],"stageNumber": 1}' 'https://smartcat.ai/api/integration/v1/document/assignFromMyTeam'";done &lt; documents.list</span></span></code> </pre><br>  Ini menyimpulkan seri artikel saya tentang mengintegrasikan dan mengkonfigurasi pelokalan berkelanjutan.  Saya akan dengan senang hati menjawab pertanyaan Anda. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id452580/">https://habr.com/ru/post/id452580/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id452566/index.html">Node.js untuk pemula: dasar-dasar bekerja dengan file</a></li>
<li><a href="../id452568/index.html">Analisis terperinci fitur baru React 16+, bagian 1: informasi umum</a></li>
<li><a href="../id452570/index.html">Linux Install Fest - side view</a></li>
<li><a href="../id452572/index.html">EFORTH untuk MK-161: Struktur Data</a></li>
<li><a href="../id452576/index.html">Tentang Introvert di TI</a></li>
<li><a href="../id452584/index.html">Pemrogram kesalahpahaman tentang waktu Unix</a></li>
<li><a href="../id452586/index.html">Cara memulai pemrograman di Adobe Illustrator. Bagian satu</a></li>
<li><a href="../id452590/index.html">Amerika menciptakan ruang kelas mobile untuk mengajar anak-anak di sekolah percetakan 3D anggaran rendah, proyek ini telah mengumpulkan lebih dari 100.000</a></li>
<li><a href="../id452592/index.html">Bagian 0. Membutuhkan peri untuk bekerja di Matrix. Relokasi dimungkinkan</a></li>
<li><a href="../id452596/index.html">735.000 alamat IPv4 diambil dari scammer dan dikembalikan ke registri</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>