<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🛸 🤼 🔸 使用Telebot库第1部分在python中编写电报bot 👩🏼‍🏭 💅🏿 🧜🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="注意， 文章的第二部分已经出版 ，我建议阅读 

 抒情离题 
 如今，机器人是用于商务和娱乐的多功能工具。 我个人认为，未来与他们同在。 当然，阅读本文后，您将无法创建大型项目，但是要引起兴趣并开始就可以了。 

 安装与设定 
 首先，让我们下载python本身。 您可以在官方网站上进行此操作。...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>使用Telebot库第1部分在python中编写电报bot</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/448310/"><h2> 注意， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">文章</a>的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">第二部分已经出版</a> ，我建议阅读 </h2><br><br><h2> 抒情离题 </h2><br> 如今，机器人是用于商务和娱乐的多功能工具。 我个人认为，未来与他们同在。 当然，阅读本文后，您将无法创建大型项目，但是要引起兴趣并开始就可以了。 <br><br><h2> 安装与设定 </h2><br> 首先，让我们下载python本身。 您可以在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">官方网站</a>上进行此操作。 不要忘记在安装过程中检查添加到PATH！ 安装python之后，我们需要一个好的代码编辑器。  JetBrains提供免费的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">PyCharm</a>进行救援。 我们很接近，仍然需要下载远程机器人库。 为此，请转到命令行并输入： <br><br><pre><code class="python hljs">pip install pytelegrambotapi</code> </pre> <br> 如果一切顺利，我们可以继续！ <br><a name="habracut"></a><br><h2> 虚拟专用网 </h2><br> 我想每个人都知道俄罗斯的电报封锁，而且一如既往，唯一的解决方案是vpn。 就个人而言，我建议使用<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Windscribe</a> 他们给你2 GB。 交通完全免费！ <br><br><h2>  Bot父亲 </h2><br> 在搜索电报时，我们找到了Bot Farher，并使用/ newbot命令创建了我们的机器人。 然后输入名称和用户名。 请注意，用户名必须以bot结尾！ <br><br><img src="https://habrastorage.org/webt/wo/5q/ol/wo5qol8zqfljoiv5qvpm83sm5ag.png" alt="图片"><br><br> 如您所见，我们获得了一个特殊的api令牌，您可以使用它来控制您的机器人（在我的情况下，它是： <i>776550937：AAELEr0c3H6dM-9QnlDD-0Q0Fcd65pPyAiM</i> ）。 您可以记住您的令牌，但我建议您记下它。 <br><cut></cut><br><h2> 代号 </h2><br> 所有人都在等待的时刻到了。 打开PyCharm并创建一个新项目。 <br><br><img src="https://habrastorage.org/webt/wv/x1/ek/wvx1ekh5i4fzwmohaedrqrdsuf4.png" alt="图片"><br><br> 在这里，我建议将所有内容都归我所有（名称可以更改）。 创建项目后，让我们创建一个文件，其中将包含我们的代码。 右键单击项目所在的文件夹，然后单击新建→Python文件。 好的，让我们开始编写代码。 使用以下命令导入远程机器人库： <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> telebot</code> </pre> <br> 现在，您需要创建bot变量。 实际上，变量名可以是任何东西，但是我习惯于编写bot。 <br><br><pre> <code class="python hljs">bot = telebot.TeleBot(<span class="hljs-string"><span class="hljs-string">' '</span></span>)</code> </pre> <br> 我们将编写<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" class="user_link">机器人</a> .message_handler（）装饰器，我们的机器人将使用它来响应/ start命令。 为此，我们在括号中写命令= ['start']。 结果，我们应该得到以下信息： <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">@bot.message_handler(commands=['start'])</span></span></code> </pre> <br> 如果您尝试启动您的漫游器（人民币-&gt;运行），那么您将无法使用。 首先，在代码末尾，我们需要编写bot.polling（）。 这是必要的，这样机器人就不会立即关闭，而是可以工作并检查服务器上是否有新消息。 其次，我们的机器人即使检查消息，也仍然无法回答任何问题。 现在该修复它了！ 装饰器之后，我们创建start_message函数，该函数将使用message参数（该函数的名称可以是任何东西）。 接下来，让我们实现从机器人本身发送消息。 在函数中，我们编写bot.send_message（message.chat.id，“您好，您给我写了/开始”）。 看看您应该得到什么： <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> telebot bot = telebot.TeleBot(<span class="hljs-string"><span class="hljs-string">'776550937:AAELEr0c3H6dM-9QnlDD-0Q0Fcd65pPyAiM'</span></span>) @bot.message_handler(commands=[<span class="hljs-string"><span class="hljs-string">'start'</span></span>]) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">start_message</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(message)</span></span></span><span class="hljs-function">:</span></span> bot.send_message(message.chat.id, <span class="hljs-string"><span class="hljs-string">',    /start'</span></span>) bot.polling()</code> </pre> <br> 让我们检查一下... <br><br><img src="https://habrastorage.org/webt/yc/j_/ib/ycj_iba4bvugurlniy1vbbwsahi.png" alt="图片"><br><br> 太好了，我们的机器人可以工作了！ 这样他不仅可以回答命令，还可以回答消息，创建一个新的装饰器<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" class="user_link">bot</a> .message_handler（），并在括号中编写content_types = ['text']。 通常，内容类型很多，例如位置，照片，音频，标签等。 但是我们需要回复文本，对不对？ 因此，我们创建了一个带有message参数的send_text函数。 在函数中，我们编写条件： <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">@bot.message_handler(content_types=['text']) def send_text(message): if message.text == '': bot.send_message(message.chat.id, ',  ') elif message.text == '': bot.send_message(message.chat.id, ', ')</span></span></code> </pre> <br> 如果消息文本为“ Hello”，则机器人将回答“您好，我的创建者”；如果消息文本为“ Bye”，则机器人将回答“再见创建者”。 在这里，我认为一切都清楚了。 但是您最想知道的是，如果用户输入“ hello”或“ Hi”，在这种情况下您应该怎么做？ 一切都非常简单！ 在这种情况下，在message.text之后编写函数.lower（），然后在文本中将所有大写字母替换为小写字母。 现在，我们的机器人不仅会响应“ hello”，还会响应“ PrivT”，甚至是“ PRIVET”。 <br><br><img src="https://habrastorage.org/webt/fj/4f/ha/fj4fhaph66c_szwnv6vy4n4ytqu.png" alt="图片"><br><br> 这是您应该得到的： <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> telebot bot = telebot.TeleBot(<span class="hljs-string"><span class="hljs-string">'776550937:AAELEr0c3H6dM-9QnlDD-0Q0Fcd65pPyAiM'</span></span>) @bot.message_handler(commands=[<span class="hljs-string"><span class="hljs-string">'start'</span></span>]) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">start_message</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(message)</span></span></span><span class="hljs-function">:</span></span> bot.send_message(message.chat.id, <span class="hljs-string"><span class="hljs-string">',    /start'</span></span>) @bot.message_handler(content_types=[<span class="hljs-string"><span class="hljs-string">'text'</span></span>]) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">send_text</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(message)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> message.text.lower() == <span class="hljs-string"><span class="hljs-string">''</span></span>: bot.send_message(message.chat.id, <span class="hljs-string"><span class="hljs-string">',  '</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">elif</span></span> message.text.lower() == <span class="hljs-string"><span class="hljs-string">''</span></span>: bot.send_message(message.chat.id, <span class="hljs-string"><span class="hljs-string">', '</span></span>) bot.polling()</code> </pre> <br> 好吧，我们弄清楚了文本，但是例如如何发送标签？ 一切都很简单！ 每个贴纸都有自己的ID，知道此ID后，我们就可以发送它了。 有两种获取标签ID的方法。 第一个（简单）-通过特殊机器人“贴纸ID是什么？” <br><br><img src="https://habrastorage.org/webt/qy/aa/r2/qyaar20gutlmozp-q82sq5v4r1u.png" alt="图片"><br><br> 好吧，第二种方式，对于那些不寻求简单方法的人。 我们创建一个新的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" class="user_link">bot</a> .message_handler（）装饰器，仅在括号中写入content_types = ['sticker']。 然后一切照常。 我们创建了一个使用message参数的函数，但是在这里我们编写了print（消息）。 我们启动机器人。 <br><br><img src="https://habrastorage.org/webt/kc/2i/4b/kc2i4bybrgm7wxpn9iivds0rspa.png"><br><br> 看，一旦我发送了贴纸，它将立即在控制台中显示信息，并且最后将是我们的贴纸ID（file_id）。 让我们确保当用户向漫游器发送“我爱你”时，漫游器会回复一个贴纸。 无需创建新的装饰器，我们只需添加之前的条件即可。 但是，我们使用bot.send_sticker（）代替bot.send_message（），而不是文本，而是使用贴纸的ID。 <br><br><img src="https://habrastorage.org/webt/ko/vd/nu/kovdnuuzi4vtdzqv8pbwxxep4mi.png" alt="图片"><br><br> 恭喜，一切顺利！ 我正在考虑如何发送音频，照片和地理位置，您可以自己解决。 我想向您展示如何制作一个键盘，让机器人在启动时向您显示。 这将使其更加困难。 我们创建keyboard1变量，在其中写入telebot.types.ReplyKeyboardMarkup（）。 此功能调出键盘。 接下来，创建行，但请记住最多不能超过12行！ 为了创建它们，编写keyboard1.row（）。 在括号中，写下您想要的任何内容；我个人将写下“ Hello”和“ Bye”。 现在，要调用键盘，让我们在启动时将message_markup = keyboard1添加到发送消息的功能中。 这是您应该得到的： <br><br><pre> <code class="python hljs">keyboard1 = telebot.types.ReplyKeyboardMarkup() keyboard1.row(<span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>) @bot.message_handler(commands=[<span class="hljs-string"><span class="hljs-string">'start'</span></span>]) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">start_message</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(message)</span></span></span><span class="hljs-function">:</span></span> bot.send_message(message.chat.id, <span class="hljs-string"><span class="hljs-string">',    /start'</span></span>, reply_markup=keyboard1)</code> </pre> <br> 我们启动机器人... <br><br><img src="https://habrastorage.org/webt/wk/_w/zm/wk_wzmzm2escg0e4mllmymems0y.png"><br><br> 您会看到键盘很大。 要解决此问题，您只需要在ReplyKeyboardMarkup（）中注册True。 好吧，如果您希望键盘在用户单击时立即隐藏，请编写另一个True。 您可以在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">官方文档中</a>详细了解这些True的含义。 <br><br><pre> <code class="python hljs">keyboard1 = telebot.types.ReplyKeyboardMarkup(<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)</code> </pre> <br> 好，仅此而已！ 当然，这并不是电报中所有可能的漫游器，但我向您展示了其主要功能。 谢谢您的关注。 <br><br> 源代码： <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> telebot bot = telebot.TeleBot(<span class="hljs-string"><span class="hljs-string">'&lt; &gt;'</span></span>) keyboard1 = telebot.types.ReplyKeyboardMarkup() keyboard1.row(<span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>) @bot.message_handler(commands=[<span class="hljs-string"><span class="hljs-string">'start'</span></span>]) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">start_message</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(message)</span></span></span><span class="hljs-function">:</span></span> bot.send_message(message.chat.id, <span class="hljs-string"><span class="hljs-string">',    /start'</span></span>, reply_markup=keyboard1) @bot.message_handler(content_types=[<span class="hljs-string"><span class="hljs-string">'text'</span></span>]) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">send_text</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(message)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> message.text.lower() == <span class="hljs-string"><span class="hljs-string">''</span></span>: bot.send_message(message.chat.id, <span class="hljs-string"><span class="hljs-string">',  '</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">elif</span></span> message.text.lower() == <span class="hljs-string"><span class="hljs-string">''</span></span>: bot.send_message(message.chat.id, <span class="hljs-string"><span class="hljs-string">', '</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">elif</span></span> message.text.lower() == <span class="hljs-string"><span class="hljs-string">'  '</span></span>: bot.send_sticker(message.chat.id, <span class="hljs-string"><span class="hljs-string">'CAADAgADZgkAAnlc4gmfCor5YbYYRAI'</span></span>) @bot.message_handler(content_types=[<span class="hljs-string"><span class="hljs-string">'sticker'</span></span>]) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sticker_id</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(message)</span></span></span><span class="hljs-function">:</span></span> print(message) bot.polling()</code> </pre> <br><br> 如果您有任何疑问，可以写电报<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" class="user_link">dimagorovtsov</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN448310/">https://habr.com/ru/post/zh-CN448310/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN448298/index.html">GLTF和GLB基础知识，第2部分</a></li>
<li><a href="../zh-CN448300/index.html">会议邮件：CLOUD-关于云及其周围</a></li>
<li><a href="../zh-CN448302/index.html">AdBlock和uBlock过滤器中的漏洞允许在用户端执行任意代码</a></li>
<li><a href="../zh-CN448304/index.html">《行动中的Vue.js》一书</a></li>
<li><a href="../zh-CN448308/index.html">数据科学文摘（2019年4月）</a></li>
<li><a href="../zh-CN448316/index.html">确定狗的品种：完整的开发周期，从Python中的神经网络到Google Play上的应用</a></li>
<li><a href="../zh-CN448320/index.html">为什么要硅，为什么要CMOS？</a></li>
<li><a href="../zh-CN448322/index.html">C ++ Russia 2019：免费播放第一大厅，并简要介绍了会议的内容</a></li>
<li><a href="../zh-CN448324/index.html">创建程序性地球仪</a></li>
<li><a href="../zh-CN448326/index.html">看穿 如何在不破坏学科的情况下学习学科？</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>