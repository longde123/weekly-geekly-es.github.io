<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ЁЯеб тППя╕П ЁЯС╝ЁЯП╜ рдЕрднреА рддрдХ рдХрд┐рд╡реА, рдЕрдЬрдЧрд░ рдХреЗ рд╕рд╛рде рдПрдХ рдФрд░ рдПрдВрдбреНрд░реЙрдЗрдб рд╕рд╛рдВрдк ЁЯУл ЁЯПе ЁЯО║</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="рдирдорд╕реНрдХрд╛рд░ред 

 рдмрд╣реБрдд рд╕реЗ рд▓реЛрдЧ рдПрдВрдбреНрд░реЙрдЗрдб рдХреЗ рд▓рд┐рдП рдкреНрд░реЛрдЧреНрд░рд╛рдорд┐рдВрдЧ рдРрдк рд╢реБрд░реВ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рд╡реЗ рдПрдВрдбреНрд░реЙрдЗрдб рд╕реНрдЯреВрдбрд┐рдпреЛ рдФрд░ / рдпрд╛ рдЬрд╛рд╡рд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд░рдирд╛ рдкрд╕рдВрдж рдХрд░рддреЗ рд╣реИрдВред...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>рдЕрднреА рддрдХ рдХрд┐рд╡реА, рдЕрдЬрдЧрд░ рдХреЗ рд╕рд╛рде рдПрдХ рдФрд░ рдПрдВрдбреНрд░реЙрдЗрдб рд╕рд╛рдВрдк</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/465523/"> рдирдорд╕реНрдХрд╛рд░ред <br><br>  рдмрд╣реБрдд рд╕реЗ рд▓реЛрдЧ рдПрдВрдбреНрд░реЙрдЗрдб рдХреЗ рд▓рд┐рдП рдкреНрд░реЛрдЧреНрд░рд╛рдорд┐рдВрдЧ рдРрдк рд╢реБрд░реВ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рд╡реЗ рдПрдВрдбреНрд░реЙрдЗрдб рд╕реНрдЯреВрдбрд┐рдпреЛ рдФрд░ / рдпрд╛ рдЬрд╛рд╡рд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд░рдирд╛ рдкрд╕рдВрдж рдХрд░рддреЗ рд╣реИрдВред  рдХреНрдпреЛрдВ?  рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдПрдХ рдУрд╡рд░рдХрд┐рд▓ рд╣реИред  "рдореИрдВ рд╕рд┐рд░реНрдл рд╕рд╛рдБрдк рдмрдирд╛рдирд╛ рдЪрд╛рд╣рддрд╛ рд╣реВрдБ рдФрд░ рдЗрд╕рд╕реЗ рдЬреНрдпрд╛рджрд╛ рдХреБрдЫ рдирд╣реАрдВ!" <br><br><img src="https://habrastorage.org/webt/gb/yu/vz/gbyuvzpeftcwxbxi9gwa2xz5axe.png"><br><br>  рд╕рд╛рдВрдк рдмрд┐рдирд╛ рдЬрд╛рд╡рд╛ рдХреЗ!  (рдЕрдВрдд рдореЗрдВ рдПрдХ рдмреЛрдирд╕ рдХреЗ рд╕рд╛рде) <br><a name="habracut"></a><br><div class="spoiler">  <b class="spoiler_title">рдХреНрдпреЛрдВ рдЕрднреА рддрдХ рдПрдХ рдФрд░ рд╕рд╛рдБрдк рдЯреНрдпреВрдЯреЛрд░рд┐рдпрд▓?</b> <div class="spoiler_text">  рдпрджрд┐ рдЖрдк рдПрдХ рдЕрдЬрдЧрд░ рдХреЛрдбрд░ рд╣реИрдВ рдФрд░ рдПрдВрдбреНрд░реЙрдЗрдб рдХреЗ рд▓рд┐рдП gamedev рд╕реАрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рддреЛ рдЖрдкрдХреЛ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА "рдПрдВрдбреНрд░реЙрдЗрдб рдкрд░ рд╕рд╛рдВрдк" рдЧреБрдЧреБрд▓ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП рдФрд░ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдпрд╣ (Eng)</a> рдпрд╛ рдЗрд╕рдХрд╛ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЕрдиреБрд╡рд╛рдж (рд░рд╕) рдорд┐рд▓рд╛</a> ред  рдЗрд╕рд▓рд┐рдП рдореИрдВрдиреЗ рдХрд┐рдпрд╛ред рджреБрд░реНрднрд╛рдЧреНрдп рд╕реЗ, рдореИрдВрдиреЗ рд▓реЗрдЦ рдХреЛ рдмрд╣реБрдд рдмреЗрдХрд╛рд░ рдкрд╛рдпрд╛ рдХреНрдпреЛрдВрдХрд┐: <br><br><h5>  рдЙрдирдХрд╛ рдХреЛрдб рдЦрд░рд╛рдм рд╣реИ </h5><br>  рдЫреЛрдЯреЗ рдореБрджреНрджреЗ: <br><br><ol><li>  "рдЯрд╛рдЗрд▓" рдпрд╛ "рдХреЛрд╢рд┐рдХрд╛рдУрдВ" рдХреЗ рдмрдЬрд╛рдп "рдЯрд╛рдЗрд▓" рдФрд░ "рд╕рд┐рд░" рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдореЗрд░реЗ рд▓рд┐рдП рд╕рдордЭ рдореЗрдВ рдирд╣реАрдВ рдЖрддрд╛ рд╣реИред  рд╕рд┐рд░ рдЯрд╛рдЗрд▓ рд╕реЗ рдЕрд▓рдЧ-рдЕрд▓рдЧ рдЪрд░ рд╣реЛрдиреЗ рдХреЗ рд▓рд┐рдП рдкрд░реНрдпрд╛рдкреНрдд рдЕрд▓рдЧ рдирд╣реАрдВ рд╣реИред </li><li>  Self.update рдХреЗ рд▓рд┐рдП Clock.schedule рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ ... self.update рд╕реЗред </li><li>  рд╕реЗрдХрдВрдб-рд▓реЗрд╡рд▓ рдХреНрд▓рд╛рд╕ рдкреНрд▓реЗрдЧреНрд░рд╛рдЙрдВрдб рдХреЛ рд╢реБрд░реБрдЖрдд рдореЗрдВ рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬрдмрдХрд┐ рдлрд░реНрд╕реНрдЯ-рд▓реЗрд╡рд▓ рдХреНрд▓рд╛рд╕ рд╕реНрдиреЗрдкрдРрдк рдХреЛ рдЕрдВрдд рдореЗрдВ рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред </li><li>  рдирд┐рд░реНрджреЗрд╢реЛрдВ рдХреЗ рд▓рд┐рдП рдирд╛рдо ("рдКрдкрд░", "рдиреАрдЪреЗ", ...) рдХрд╛ рдЙрдкрдпреЛрдЧ рд╡реИрдХреНрдЯрд░ ((0, 1), (1, 0) ...) рдХреЗ рдмрдЬрд╛рдп рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред </li></ol><br>  рдкреНрд░рдореБрдЦ рдореБрджреНрджреЗ: <br><br><ol><li>  рдЕрдзрд┐рдХрд╛рдВрд╢ рдЧрддрд┐рд╢реАрд▓ рд╡рд╕реНрддреБрдПрдВ (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдлрд▓) рдХреЗрд╡реА рдлрд╝рд╛рдЗрд▓ рд╕реЗ рдЬреБрдбрд╝реА рд╣реЛрддреА рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рдЖрдк 1 рд╕реЗ рдЕрдзрд┐рдХ рд╕реЗрдм рдирд╣реАрдВ рдмрдирд╛ рд╕рдХрддреЗ рдХреНрдпреЛрдВрдХрд┐ рддрдм рдЖрдкрдХреЛ рдЗрд╕ рд╣рд┐рд╕реНрд╕реЗ рдХреЛ рдлрд┐рд░ рд╕реЗ рд▓рд┐рдЦрдирд╛ рдЪрд╛рд╣рд┐рдП </li><li>  рд╕рд╛рдБрдк рдХреА рдЧрддрд┐ рдХреЗ рд▓рд┐рдП рдЕрдЬреАрдм рддрд░реНрдХ "рд╕реЗрд▓-рдЖрдлреНрдЯрд░-рд╕реЗрд▓" рдЧрддрд┐ рдХреЗ рдмрдЬрд╛рдпред </li><li>  рдХреЛрдб 350 рд▓рд╛рдЗрдиреЛрдВ рд╕реЗ рдЕрдзрд┐рдХ рд▓рдВрдмрд╛ рд╣реИред </li></ol><br><h5>  рдиреМрд╕рд┐рдЦрд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП рд▓реЗрдЦ рд╕реНрдкрд╖реНрдЯ рдирд╣реАрдВ рд╣реИ </h5><br>  рдпрд╣ рдореЗрд░реА рдирд┐рдЬреА рд░рд╛рдп рд╣реИред  рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдореИрдВ рдЗрд╕ рдмрд╛рдд рдХреА рдЧрд╛рд░рдВрдЯреА рдирд╣реАрдВ рджреЗрддрд╛ рдХрд┐ рдореЗрд░рд╛ рдЯреНрдпреВрдЯреЛрд░рд┐рдпрд▓ рдЕрдзрд┐рдХ рд░реЛрдЪрдХ рдФрд░ рд╕реНрдкрд╖реНрдЯ рд╣реЛрдЧрд╛ред  рд▓реЗрдХрд┐рди рдореИрдВ рдЕрдкрдиреЗ рд▓реЗрдЦ рдХреЗ рд▓рд┐рдП рдЕрдкрдирд╛ рд╕рд░реНрд╡рд╢реНрд░реЗрд╖реНрда рдкреНрд░рдпрд╛рд╕ рдХрд░реВрдВрдЧрд╛, рдЧрд╛рд░рдВрдЯреА рд╣реИ рдХрд┐: <br><br><ol><li>  рдХреЛрдб рдЫреЛрдЯрд╛ рд╣реИ </li><li>  рд╕рд╛рдВрдк рдЕрдЪреНрдЫрд╛ рд╣реИ </li><li>  рдирд┐рд░реНрджреЗрд╢ рдореЗрдВ рдЪрд░рдг-рджрд░-рдЪрд░рдг рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдФрд░ "рд╣реЗрд▓реНрд▓реЛ, рд╡рд░реНрд▓реНрдб" рд╕реЗ рдЪрд┐рдХрдиреА рдкреНрд░рдЧрддрд┐ рдХреЗ рд▓рд┐рдП рддреИрдпрд╛рд░ рд╕рд╛рдВрдк рдХреЗ рд╕рд╛рде рд╕рдВрдХреНрд░рдордгрдХрд╛рд▓реАрди рдХрджрдо рд╣реЛрдВрдЧреЗред </li></ol><br><h5>  рдЕрд╡рд╛рдВрдЫрдиреАрдп рдкрд░рд┐рдгрд╛рдо </h5><br><img src="https://habrastorage.org/webt/n6/q-/li/n6q-lieen74-rcs-tzwrr1yguwa.png"><br>  рдХреЛрд╢рд┐рдХрд╛рдУрдВ рдХреЗ рдмреАрдЪ рдХреЛрдИ рд╕реНрдерд╛рди рдирд╣реАрдВ рд╣реИ, рддреНрд░рд┐рдХреЛрдг рд╢рд░реНрдордирд╛рдХ рд╣реИ, рдЧреНрд░рд╛рдлрд┐рдХреНрд╕ рдЧрдбрд╝рдмрдбрд╝ рд╣реИрдВред <br></div></div><br><h1>  рдкрд░рд┐рдЪрд┐рдд рд╣реЛ рдЬрд╛рдУ </h1><br><h3>  рдкрд╣рд▓рд╛ рдРрдк </h3><br>  рдХреГрдкрдпрд╛, рдкреБрд╖реНрдЯрд┐ рдХрд░реЗрдВ рдХрд┐ рдЖрдкрдиреЗ рдкрд╣рд▓реЗ рд╣реА рдХреАрд╡реА рдХреЛ рд╕реНрдерд╛рдкрд┐рдд рдХрд┐рдпрд╛ рд╣реИ (рдпрджрд┐ рдирд╣реАрдВ, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдирд┐рд░реНрджреЗрд╢реЛрдВ</a> рдХрд╛ рдкрд╛рд▓рди <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдХрд░реЗрдВ</a> ) рдФрд░ рднрд╛рдЧрд╛ <br>  <code>buildozer init</code> рдкрд░рд┐рдпреЛрдЬрдирд╛ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдореЗрдВ <code>buildozer init</code> ред <br><br>  рдЪрд▓рд┐рдП рдЕрдкрдирд╛ рдкрд╣рд▓рд╛ рдРрдк рдЪрд▓рд╛рддреЗ рд╣реИрдВ: <br><br>  main.py <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> kivy.app <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> App <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> kivy.uix.widget <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Widget <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">WormApp</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(App)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">build</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Widget() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> __name__ == <span class="hljs-string"><span class="hljs-string">'__main__'</span></span>: WormApp().run()</code> </pre><br><img src="https://habrastorage.org/webt/ms/he/ud/msheudwu1tc3wcvjj8z2x9oswgi.png"><br><br>  рд╣рдордиреЗ рдПрдХ рд╡рд┐рдЬреЗрдЯ рдмрдирд╛рдпрд╛ред  рдЕрдиреБрд░реВрдкрддрд╛ рд╕реЗ, рд╣рдо рдПрдХ рдмрдЯрди рдпрд╛ рдХреЛрдИ рдЕрдиреНрдп UI рддрддреНрд╡ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> kivy.app <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> App <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> kivy.uix.widget <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Widget <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> kivy.uix.button <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Button <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">WormApp</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(App)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">build</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.but = Button() self.but.pos = (<span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>) self.but.size = (<span class="hljs-number"><span class="hljs-number">200</span></span>, <span class="hljs-number"><span class="hljs-number">200</span></span>) self.but.text = <span class="hljs-string"><span class="hljs-string">"Hello, cruel world"</span></span> self.form = Widget() self.form.add_widget(self.but) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self.form <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> __name__ == <span class="hljs-string"><span class="hljs-string">'__main__'</span></span>: WormApp().run()</code> </pre><br><img src="https://habrastorage.org/webt/gp/k1/cn/gpk1cngh7ns5z9wdtjuua5d1ogg.png"><br><br>  рд╡рд╛рд╣!  рдмрдзрд╛рдИ!  рдЖрдкрдиреЗ рдПрдХ рдмрдЯрди рдмрдирд╛рдпрд╛ рд╣реИ! <br><br><h3>  .kv рдлрд╛рдЗрд▓реЗрдВ </h3><br>  рд╣рд╛рд▓рд╛рдБрдХрд┐, UI рддрддреНрд╡ рдмрдирд╛рдиреЗ рдХрд╛ рдПрдХ рдФрд░ рддрд░реАрдХрд╛ рд╣реИред  рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рд╣рдо рдЕрдкрдирд╛ рдлреЙрд░реНрдо рд▓рд╛рдЧреВ рдХрд░рддреЗ рд╣реИрдВ: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> kivy.app <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> App <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> kivy.uix.widget <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Widget <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> kivy.uix.button <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Button <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Form</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Widget)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> super().__init__() self.but1 = Button() self.but1.pos = (<span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>) self.add_widget(self.but1) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">WormApp</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(App)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">build</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.form = Form() <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self.form <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> __name__ == <span class="hljs-string"><span class="hljs-string">'__main__'</span></span>: WormApp().run()</code> </pre><br>  рдлрд┐рд░, рд╣рдо "worm.kv" рдлрд╝рд╛рдЗрд▓ рдмрдирд╛рддреЗ рд╣реИрдВред <br><br>  worm.kv <br><br><pre> <code class="plaintext hljs">&lt;Form&gt;: but2: but_id Button: id: but_id pos: (200, 200)</code> </pre><br>  рдмрд╕ рдХреНрдпрд╛ рд╣реБрдЖ?  рд╣рдордиреЗ рдПрдХ рдФрд░ рдмрдЯрди рдмрдирд╛рдпрд╛ рдФрд░ id but_id рдЕрд╕рд╛рдЗрди рдХрд┐рдпрд╛ред  рдлрд┐рд░, but_id рдХреЛ рдлреЙрд░реНрдо рдХреЗ but2 рд╕реЗ рдорд┐рд▓рд╛рди рдХрд┐рдпрд╛ рдЧрдпрд╛ред  рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдЕрдм рд╣рдо but2 рджреНрд╡рд╛рд░рд╛ рдЗрд╕ рдмрдЯрди рдХреЛ рд╕рдВрджрд░реНрднрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ <br><br><pre> <code class="plaintext hljs">class Form(Widget): def __init__(self): super().__init__() self.but1 = Button() self.but1.pos = (100, 100) self.add_widget(self.but1) # self.but2.text = "OH MY"</code> </pre><br><img src="https://habrastorage.org/webt/ug/a6/88/uga688dhltpl2klklqbigyodu40.png"><br><br><h3>  рдЧреНрд░рд╛рдлрд┐рдХреНрд╕ </h3><br>  рд╣рдо рдЖрдЧреЗ рдХреНрдпрд╛ рдХрд░рддреЗ рд╣реИрдВ рдПрдХ рдЧреНрд░рд╛рдлрд┐рдХрд▓ рддрддреНрд╡ рдмрдирд╛ рд░рд╣рд╛ рд╣реИред  рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рд╣рдо рдЗрд╕реЗ worm.kv рдореЗрдВ рд▓рд╛рдЧреВ рдХрд░рддреЗ рд╣реИрдВ: <br><br><pre> <code class="plaintext hljs">&lt;Form&gt;: &lt;Cell&gt;: canvas: Rectangle: size: self.size pos: self.pos</code> </pre><br>  рд╣рдордиреЗ рдЖрдпрдд рдХреА рд╕реНрдерд┐рддрд┐ рдХреЛ рд╕реНрд╡.рдкреЛрд╕ рдФрд░ рдЙрд╕рдХреЗ рдЖрдХрд╛рд░ рдХреЛ рд╕реНрд╡.рд╕рд╛рдЗрдЬрд╝ рд╕реЗ рдЬреЛрдбрд╝рд╛ред  рдЗрд╕рд▓рд┐рдП рдЕрдм рд╡реЗ рдЧреБрдг рд╕реЗрд▓ рд╕реЗ рдЙрдкрд▓рдмреНрдз рд╣реИрдВ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдПрдХ рдмрд╛рд░ рд╕реЗрд▓ рдмрдирд╛рдиреЗ рдХреЗ рдмрд╛рдж, рд╣рдо рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Cell</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Widget)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, x, y, size)</span></span></span><span class="hljs-function">:</span></span> super().__init__() self.size = (size, size) <span class="hljs-comment"><span class="hljs-comment"># As you can see, we can change self.size which is "size" property of a rectangle self.pos = (x, y) class Form(Widget): def __init__(self): super().__init__() self.cell = Cell(100, 100, 30) self.add_widget(self.cell)</span></span></code> </pre><br><img src="https://habrastorage.org/webt/we/j4/dn/wej4dnu0jojperjlmnlflu5dxi8.png"><br><br>  рдареАрдХ рд╣реИ, рд╣рдордиреЗ рдПрдХ рд╕реЗрд▓ рдмрдирд╛рдпрд╛ рд╣реИред <br><br><h3>  рдЕрдирд╛рд╡рд╢реНрдпрдХ рддрд░реАрдХреЗ </h3><br>  рдЪрд▓реЛ рдЗрд╕реЗ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВред  рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ Form.update рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдЬреЛрдбрд╝рдирд╛ рдЪрд╛рд╣рд┐рдП рдФрд░ рдЗрд╕реЗ рд╢реЗрдбреНрдпреВрд▓ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдПред <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> kivy.app <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> App <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> kivy.uix.widget <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Widget <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> kivy.clock <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Clock <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Cell</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Widget)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, x, y, size)</span></span></span><span class="hljs-function">:</span></span> super().__init__() self.size = (size, size) self.pos = (x, y) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Form</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Widget)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> super().__init__() self.cell = Cell(<span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-number"><span class="hljs-number">30</span></span>) self.add_widget(self.cell) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">start</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> Clock.schedule_interval(self.update, <span class="hljs-number"><span class="hljs-number">0.01</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">update</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, _)</span></span></span><span class="hljs-function">:</span></span> self.cell.pos = (self.cell.pos[<span class="hljs-number"><span class="hljs-number">0</span></span>] + <span class="hljs-number"><span class="hljs-number">2</span></span>, self.cell.pos[<span class="hljs-number"><span class="hljs-number">1</span></span>] + <span class="hljs-number"><span class="hljs-number">3</span></span>) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">WormApp</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(App)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">build</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.form = Form() self.form.start() <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self.form <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> __name__ == <span class="hljs-string"><span class="hljs-string">'__main__'</span></span>: WormApp().run()</code> </pre><br>  рд╕реЗрд▓ рдкреВрд░реЗ рдлреЙрд░реНрдо рдореЗрдВ рдЪрд▓реА рдЬрд╛рдПрдЧреАред  рдЬреИрд╕рд╛ рдХрд┐ рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ, рд╣рдо рдШрдбрд╝реА рдХреЗ рд╕рд╛рде рдХрд┐рд╕реА рднреА рдлрд╝рдВрдХреНрд╢рди рдХреЛ рд╢реЗрдбреНрдпреВрд▓ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред <br><br>  рдЕрдЧрд▓рд╛, рдПрдХ рд╕реНрдкрд░реНрд╢ рдШрдЯрдирд╛ рдмрдирд╛рддреЗ рд╣реИрдВред  рдкреБрдирд░реНрд▓реЗрдЦрди рдлреЙрд░реНрдо: <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Form</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Widget)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> super().__init__() self.cells = [] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">start</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> Clock.schedule_interval(self.update, <span class="hljs-number"><span class="hljs-number">0.01</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">update</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, _)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> cell <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> self.cells: cell.pos = (cell.pos[<span class="hljs-number"><span class="hljs-number">0</span></span>] + <span class="hljs-number"><span class="hljs-number">2</span></span>, cell.pos[<span class="hljs-number"><span class="hljs-number">1</span></span>] + <span class="hljs-number"><span class="hljs-number">3</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">on_touch_down</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, touch)</span></span></span><span class="hljs-function">:</span></span> cell = Cell(touch.x, touch.y, <span class="hljs-number"><span class="hljs-number">30</span></span>) self.add_widget(cell) self.cells.append(cell)</code> </pre><br>  рдкреНрд░рддреНрдпреЗрдХ рдЯрдЪ_рдбрд╛рдЙрди рдирд┐рд░реНрджреЗрд╢рд╛рдВрдХ = (рдЯрдЪ.x, рдЯрдЪ.рд╡рд╛рдИ) рдФрд░ 30 рдХреЗ рдЖрдХрд╛рд░ рдХреЗ рд╕рд╛рде рдПрдХ рд╕реЗрд▓ рдмрдирд╛рддрд╛ рд╣реИред рдлрд┐рд░, рд╣рдо рдЗрд╕реЗ рдкреНрд░рдкрддреНрд░ рдХреЗ рд╡рд┐рдЬреЗрдЯ рдХреЗ рд░реВрдк рдореЗрдВ рдФрд░ рд╣рдорд╛рд░реЗ рдЕрдкрдиреЗ рд╕рд░рдгреА рдореЗрдВ рдЬреЛрдбрд╝рддреЗ рд╣реИрдВ (рддрд╛рдХрд┐ рдЖрд╕рд╛рдиреА рд╕реЗ рдЙрдиреНрд╣реЗрдВ рдПрдХреНрд╕реЗрд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП)ред <br><br>  рдЕрдм рдЖрдк рдЕрдкрдиреЗ рдлреЙрд░реНрдо рдкрд░ рдЯреИрдк рдХрд░рдХреЗ рд╕реЗрд▓ рдЬрдирд░реЗрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред <br><br><img src="https://habrastorage.org/webt/sf/rt/of/sfrtofg5ylwk8pxm3mowelxw1by.png"><br><br><h3>  рдиреАрдЯ рд╕реЗрдЯрд┐рдВрдЧреНрд╕ </h3><br>  рдХреНрдпреЛрдВрдХрд┐ рд╣рдо рдПрдХ рдЕрдЪреНрдЫрд╛ рд╕рд╛рдБрдк рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рд╣рдореЗрдВ рдЧреНрд░рд╛рдлрд┐рдХрд▓ рдкреЛрдЬреАрд╢рди рдФрд░ рдХреЛрд╢рд┐рдХрд╛рдУрдВ рдХреА рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд╕реНрдерд┐рддрд┐ рдореЗрдВ рдЕрдВрддрд░ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдПред <br><br><div class="spoiler">  <b class="spoiler_title">рдХреНрдпреЛрдВ?</b> <div class="spoiler_text">  рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмрд╣реБрдд рд╕рд╛рд░реЗ рдХрд╛рд░рдгред  рд╕рднреА рддрд░реНрдХ рддрдерд╛рдХрдерд┐рдд рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдбреЗрдЯрд╛ рд╕реЗ рдЬреБрдбрд╝реЗ рд╣реЛрдиреЗ рдЪрд╛рд╣рд┐рдП, рдЬрдмрдХрд┐ рдЧреНрд░рд╛рдлрд┐рдХрд▓ рдбреЗрдЯрд╛ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдбреЗрдЯрд╛ рдХрд╛ рдкрд░рд┐рдгрд╛рдо рд╣реИред  рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЕрдЧрд░ рд╣рдо рдорд╛рд░реНрдЬрд┐рди рдмрдирд╛рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рддреЛ рд╕реЗрд▓ рдХрд╛ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдкреЙрдЬрд╝ (100, 100) рд╣реЛрдЧрд╛ рдЬрдмрдХрд┐ рдЖрдпрдд рдХрд╛ рдЧреНрд░рд╛рдлрд┐рдХрд▓ рдкреЙрдЬрд╝ - (102, 102)ред <br><br>  рдЕрдЧрд░ рд╣рдо рд╢рд╛рд╕реНрддреНрд░реАрдп on_draw рд╕реЗ рдирд┐рдкрдЯрддреЗ рд╣реИрдВ рддреЛ PS рд╣рдо рдРрд╕рд╛ рдирд╣реАрдВ рдХрд░реЗрдВрдЧреЗред  рд▓реЗрдХрд┐рди рдпрд╣рд╛рдБ рд╣рдореЗрдВ on_draw рдкрд░ рдкреНрд░реЛрдЧреНрд░рд╛рдо рдирд╣реАрдВ рдХрд░рдирд╛ рд╣реИред <br></div></div><br>  рдЪрд▓реЛ рдХреГрдорд┐.рдХреЗрд╡реА рдлрд╝рд╛рдЗрд▓ рдХреЛ рдареАрдХ рдХрд░реЗрдВ: <br><br><pre> <code class="plaintext hljs">&lt;Form&gt;: &lt;Cell&gt;: canvas: Rectangle: size: self.graphical_size pos: self.graphical_pos</code> </pre><br>  рдФрд░ рдореЗрдирд╣реЛрдо <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">... </span></span><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> kivy.properties <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * ... <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Cell</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Widget)</span></span></span><span class="hljs-class">:</span></span> graphical_size = ListProperty([<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>]) graphical_pos = ListProperty([<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>]) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, x, y, size, margin=</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">4</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> super().__init__() self.actual_size = (size, size) self.graphical_size = (size - margin, size - margin) self.margin = margin self.actual_pos = (x, y) self.graphical_pos_attach() <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">graphical_pos_attach</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.graphical_pos = (self.actual_pos[<span class="hljs-number"><span class="hljs-number">0</span></span>] - self.graphical_size[<span class="hljs-number"><span class="hljs-number">0</span></span>] / <span class="hljs-number"><span class="hljs-number">2</span></span>, self.actual_pos[<span class="hljs-number"><span class="hljs-number">1</span></span>] - self.graphical_size[<span class="hljs-number"><span class="hljs-number">1</span></span>] / <span class="hljs-number"><span class="hljs-number">2</span></span>) ... <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Form</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Widget)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> super().__init__() self.cell1 = Cell(<span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-number"><span class="hljs-number">30</span></span>) self.cell2 = Cell(<span class="hljs-number"><span class="hljs-number">130</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-number"><span class="hljs-number">30</span></span>) self.add_widget(self.cell1) self.add_widget(self.cell2) ...</code> </pre><br><img src="https://habrastorage.org/webt/sa/0m/yi/sa0myibds8nzaymucynrard6ixk.png"><br><br>  рдорд╛рд░реНрдЬрд┐рди рджрд┐рдЦрд╛рдИ рджрд┐рдпрд╛, рдЗрд╕рд▓рд┐рдП рдпрд╣ рдмрд╣реБрдд рдЕрдЪреНрдЫрд╛ рд▓рдЧ рд░рд╣рд╛ рд╣реИ, рд╣рд╛рд▓рд╛рдВрдХрд┐ рд╣рдордиреЗ 132 рдХреЗ рдмрдЬрд╛рдп X = 130 рдХреЗ рд╕рд╛рде рджреВрд╕рд░реА рд╕реЗрд▓ рдмрдирд╛рдИред рдмрд╛рдж рдореЗрдВ, рд╣рдо рд╡рд╛рд╕реНрддрд╡рд┐рдХ_рдкреЛрд╕ рдФрд░ рдЧреНрд░рд╛рдлрд┐рдХрд▓_рдкреЛрд╕ рдХреЗ рдмреАрдЪ рдХреА рджреВрд░реА рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдЪрд┐рдХрдиреА рдЧрддрд┐ рдмрдирд╛рдПрдВрдЧреЗред <br><br><h1>  рдХреГрдорд┐ рдХреЛ рдХреВрдЯрдирд╛ </h1><br><h3>  рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди </h3><br>  рдореЗрдирдлреНрд░реЗрдо рдореЗрдВ рдЗрдирдлрд┐рдЯ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░реЗрдВ <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Config</span></span></span><span class="hljs-class">:</span></span> DEFAULT_LENGTH = <span class="hljs-number"><span class="hljs-number">20</span></span> CELL_SIZE = <span class="hljs-number"><span class="hljs-number">25</span></span> APPLE_SIZE = <span class="hljs-number"><span class="hljs-number">35</span></span> MARGIN = <span class="hljs-number"><span class="hljs-number">4</span></span> INTERVAL = <span class="hljs-number"><span class="hljs-number">0.2</span></span> DEAD_CELL = (<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>) APPLE_COLOR = (<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>)</code> </pre><br>  (рдореБрдЭ рдкрд░ рднрд░реЛрд╕рд╛ рдХрд░реЛ, рдЖрдк рдЗрд╕реЗ рдкреНрдпрд╛рд░ рдХрд░реЗрдВрдЧреЗ!) <br><br>  рдлрд┐рд░, рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рдХреЙрдиреНтАНрдлрд╝рд┐рдЧрд░ рдХрд░реЗрдВ: <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">WormApp</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(App)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> super().__init__() self.config = Config() self.form = Form(self.config) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">build</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.form.start() <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self.form</code> </pre><br>  рдкреБрдирдГ рдЖрд░рдВрдн рдХрд░реЗрдВ рдФрд░ рдкреНрд░рд╛рд░рдВрдн рдХрд░реЗрдВ: <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Form</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Widget)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, config)</span></span></span><span class="hljs-function">:</span></span> super().__init__() self.config = config self.worm = <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">start</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.worm = Worm(self.config) self.add_widget(self.worm) Clock.schedule_interval(self.update, self.config.INTERVAL)</code> </pre><br>  рдлрд┐рд░, рд╕реЗрд▓: <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Cell</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Widget)</span></span></span><span class="hljs-class">:</span></span> graphical_size = ListProperty([<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>]) graphical_pos = ListProperty([<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>]) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, x, y, size, margin=</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">4</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> super().__init__() self.actual_size = (size, size) self.graphical_size = (size - margin, size - margin) self.margin = margin self.actual_pos = (x, y) self.graphical_pos_attach() <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">graphical_pos_attach</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.graphical_pos = (self.actual_pos[<span class="hljs-number"><span class="hljs-number">0</span></span>] - self.graphical_size[<span class="hljs-number"><span class="hljs-number">0</span></span>] / <span class="hljs-number"><span class="hljs-number">2</span></span>, self.actual_pos[<span class="hljs-number"><span class="hljs-number">1</span></span>] - self.graphical_size[<span class="hljs-number"><span class="hljs-number">1</span></span>] / <span class="hljs-number"><span class="hljs-number">2</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">move_to</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, x, y)</span></span></span><span class="hljs-function">:</span></span> self.actual_pos = (x, y) self.graphical_pos_attach() <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">move_by</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, x, y, **kwargs)</span></span></span><span class="hljs-function">:</span></span> self.move_to(self.actual_pos[<span class="hljs-number"><span class="hljs-number">0</span></span>] + x, self.actual_pos[<span class="hljs-number"><span class="hljs-number">1</span></span>] + y, **kwargs) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_pos</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self.actual_pos <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">step_by</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, direction, **kwargs)</span></span></span><span class="hljs-function">:</span></span> self.move_by(self.actual_size[<span class="hljs-number"><span class="hljs-number">0</span></span>] * direction[<span class="hljs-number"><span class="hljs-number">0</span></span>], self.actual_size[<span class="hljs-number"><span class="hljs-number">1</span></span>] * direction[<span class="hljs-number"><span class="hljs-number">1</span></span>], **kwargs)</code> </pre><br>  рдЙрдореНрдореАрдж рд╣реИ, рдпрд╣ рдЕрдзрд┐рдХ рдпрд╛ рдХрдо рд╕реНрдкрд╖реНрдЯ рд╣реИред <br><br>  рдФрд░ рдЕрдВрдд рдореЗрдВ рдЗрд▓реНрд▓реА: <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Worm</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Widget)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, config)</span></span></span><span class="hljs-function">:</span></span> super().__init__() self.cells = [] self.config = config self.cell_size = config.CELL_SIZE self.head_init((<span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(config.DEFAULT_LENGTH): self.lengthen() <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">destroy</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(len(self.cells)): self.remove_widget(self.cells[i]) self.cells = [] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">lengthen</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, pos=None, direction=</span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">(</span></span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span></span><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">, </span></span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params"><span class="hljs-number">1</span></span></span></span></span><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">)</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-comment"><span class="hljs-comment"># If pos is set, we put the cell in pos, otherwise accordingly to the specified direction if pos is None: px = self.cells[-1].get_pos()[0] + direction[0] * self.cell_size py = self.cells[-1].get_pos()[1] + direction[1] * self.cell_size pos = (px, py) self.cells.append(Cell(*pos, self.cell_size, margin=self.config.MARGIN)) self.add_widget(self.cells[-1]) def head_init(self, pos): self.lengthen(pos=pos)</span></span></code> </pre><br>  рдЖрдЗрдП рд╣рдорд╛рд░реА рдХреГрдорд┐ рдХреЛ рдЬреАрд╡рдирджрд╛рди рджреЗрдВред <br><br><img src="https://habrastorage.org/webt/x8/89/ve/x889vemqslo2x8rxvp54jgbwgpi.png"><br><br><h3>  рдкреНрд░рд╕реНрддрд╛рд╡ </h3><br>  рдЕрдм рд╣рдо рдЗрд╕реЗ рдЖрдЧреЗ рдмрдврд╝рд╛рдПрдВрдЧреЗред <br><br>  рдпрд╣ рд╕рд░рд▓ рд╣реИ: <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Worm</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Widget)</span></span></span><span class="hljs-class">:</span></span> ... <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">move</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, direction)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(len(self.cells) - <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>): self.cells[i].move_to(*self.cells[i - <span class="hljs-number"><span class="hljs-number">1</span></span>].get_pos()) self.cells[<span class="hljs-number"><span class="hljs-number">0</span></span>].step_by(direction)</code> </pre><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Form</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Widget)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, config)</span></span></span><span class="hljs-function">:</span></span> super().__init__() self.config = config self.worm = <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> self.cur_dir = (<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">start</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.worm = Worm(self.config) self.add_widget(self.worm) self.cur_dir = (<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) Clock.schedule_interval(self.update, self.config.INTERVAL) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">update</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, _)</span></span></span><span class="hljs-function">:</span></span> self.worm.move(self.cur_dir)</code> </pre><br><img src="https://habrastorage.org/webt/jx/8v/jw/jx8vjwv5zpnnhfprs7peo1o_gfm.png"><br><br>  рдпрд╣ рдЬрд┐рдВрджрд╛ рд╣реИ!  рдпрд╣ рдЬрд┐рдВрджрд╛ рд╣реИ! <br><br><h3>  рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рдирд╛ </h3><br>  рдЬреИрд╕рд╛ рдХрд┐ рдЖрдк рдкреВрд░реНрд╡рд╛рд╡рд▓реЛрдХрди рдЫрд╡рд┐ рд╕реЗ рдЖрдВрдХ рд╕рдХрддреЗ рд╣реИрдВ, рд╕рд╛рдБрдк рдХрд╛ рдирд┐рдпрдВрддреНрд░рдг рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╣реЛрдЧрд╛: <br><br><img src="https://habrastorage.org/webt/va/u0/ad/vau0adepnd4fsjgcjxe0lp6jkqk.png"><br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Form</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Widget)</span></span></span><span class="hljs-class">:</span></span> ... <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">on_touch_down</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, touch)</span></span></span><span class="hljs-function">:</span></span> ws = touch.x / self.size[<span class="hljs-number"><span class="hljs-number">0</span></span>] hs = touch.y / self.size[<span class="hljs-number"><span class="hljs-number">1</span></span>] aws = <span class="hljs-number"><span class="hljs-number">1</span></span> - ws <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ws &gt; hs <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> aws &gt; hs: cur_dir = (<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>) <span class="hljs-comment"><span class="hljs-comment"># Down elif ws &gt; hs &gt;= aws: cur_dir = (1, 0) # Right elif ws &lt;= hs &lt; aws: cur_dir = (-1, 0) # Left else: cur_dir = (0, 1) # Up self.cur_dir = cur_dir</span></span></code> </pre><br><img src="https://habrastorage.org/webt/ff/8k/c2/ff8kc2ur1rct6cjmkt-ozc9xch4.png"><br><br>  рдХреВрд▓ред <br><br><h3>  рдлрд▓ рдкреИрджрд╛ рдХрд░рдирд╛ </h3><br>  рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рд╣рдо рдЗрд╕реЗ рд╢реБрд░реВ рдХрд░рддреЗ рд╣реИрдВред <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Form</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Widget)</span></span></span><span class="hljs-class">:</span></span> ... <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, config)</span></span></span><span class="hljs-function">:</span></span> super().__init__() self.config = config self.worm = <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> self.cur_dir = (<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) self.fruit = <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> ... <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">random_cell_location</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, offset)</span></span></span><span class="hljs-function">:</span></span> x_row = self.size[<span class="hljs-number"><span class="hljs-number">0</span></span>] // self.config.CELL_SIZE x_col = self.size[<span class="hljs-number"><span class="hljs-number">1</span></span>] // self.config.CELL_SIZE <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> random.randint(offset, x_row - offset), random.randint(offset, x_col - offset) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">random_location</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, offset)</span></span></span><span class="hljs-function">:</span></span> x_row, x_col = self.random_cell_location(offset) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self.config.CELL_SIZE * x_row, self.config.CELL_SIZE * x_col <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fruit_dislocate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> x, y = self.random_location(<span class="hljs-number"><span class="hljs-number">2</span></span>) self.fruit.move_to(x, y) ... <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">start</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.fruit = Cell(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, self.config.APPLE_SIZE, self.config.MARGIN) self.worm = Worm(self.config) self.fruit_dislocate() self.add_widget(self.worm) self.add_widget(self.fruit) self.cur_dir = (<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) Clock.schedule_interval(self.update, self.config.INTERVAL)</code> </pre><br>  рд╡рд░реНрддрдорд╛рди рдкрд░рд┐рдгрд╛рдо: <br><br><img src="https://habrastorage.org/webt/bb/t0/wh/bbt0whhowgmfdhnyjawtmnbv0ny.png"><br><br>  рдЕрдм рд╣рдореЗрдВ рдХреБрдЫ рдХреГрдорд┐ рд╡рд┐рдзрд┐рдпреЛрдВ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП: <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Worm</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Widget)</span></span></span><span class="hljs-class">:</span></span> ... <span class="hljs-comment"><span class="hljs-comment"># Here we get all the positions of our cells def gather_positions(self): return [cell.get_pos() for cell in self.cells] # Just check if our head has the same position as another Cell def head_intersect(self, cell): return self.cells[0].get_pos() == cell.get_pos()</span></span></code> </pre><br><div class="spoiler">  <b class="spoiler_title">рдЗрдХрдЯреНрдард╛_рд╕реЗрдХреНрд╢рди рдХреЗ рдЕрдиреНрдп рд▓рд╛рдн</b> <div class="spoiler_text">  рд╡реИрд╕реЗ, рдЬрдм рд╣рдордиреЗ рдПрдХрддреНрд░рд┐рдд_ рдкреНрд░рд╕реНрддрд╛рд╡ рд▓рд╛рдЧреВ рдХрд┐рдП, рддрдм рд╣рдо fruit_dislocate рдХреЛ рдмрджрд▓ рд╕рдХрддреЗ рд╣реИрдВ: <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Form</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Widget)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fruit_dislocate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> x, y = self.random_location(<span class="hljs-number"><span class="hljs-number">2</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (x, y) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> self.worm.gather_positions(): x, y = self.random_location(<span class="hljs-number"><span class="hljs-number">2</span></span>) self.fruit.move_to(x, y)</code> </pre><br>  рдЗрд╕ рдмрд┐рдВрджреБ рдкрд░, рдлрд▓ рдХреГрдорд┐ рдХреА рдЯрд╛рдЗрд▓ рдореЗрдВ рд╕реНрдерд┐рдд рдирд╣реАрдВ рд╣реЛрдЧрд╛ред <br></div></div><br>  ... рдФрд░ рдЕрджреНрдпрддрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕ рдЪреЗрдХ рдХреЛ рдЬреЛрдбрд╝реЗрдВ () <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Form</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Widget)</span></span></span><span class="hljs-class">:</span></span> ... <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">update</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, _)</span></span></span><span class="hljs-function">:</span></span> self.worm.move(self.cur_dir) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> self.worm.head_intersect(self.fruit): directions = [(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>), (<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>), (<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>), (<span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>)] self.worm.lengthen(direction=random.choice(directions)) self.fruit_dislocate()</code> </pre><br><h3>  рдЖрддреНрдо рдЯрд╛рдЗрд▓ рдорд╛рд░рдиреЗ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдирд╛ </h3><br>  рд╣рдо рдпрд╣ рдЬрд╛рдирдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдХреНрдпрд╛ рд╕рд┐рд░ рдореЗрдВ рдХреГрдорд┐ рдХреЛрд╢рд┐рдХрд╛рдУрдВ рдореЗрдВ рд╕реЗ рдПрдХ рдХреЗ рд╕рдорд╛рди рд╕реНрдерд┐рддрд┐ рд╣реИ рдпрд╛ рдирд╣реАрдВред <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Form</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Widget)</span></span></span><span class="hljs-class">:</span></span> ... <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, config)</span></span></span><span class="hljs-function">:</span></span> super().__init__() self.config = config self.worm = <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> self.cur_dir = (<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) self.fruit = <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> self.game_on = <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">update</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, _)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> self.game_on: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self.worm.move(self.cur_dir) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> self.worm.head_intersect(self.fruit): directions = [(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>), (<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>), (<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>), (<span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>)] self.worm.lengthen(direction=random.choice(directions)) self.fruit_dislocate() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> self.worm_bite_self(): self.game_on = <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">worm_bite_self</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> cell <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> self.worm.cells[<span class="hljs-number"><span class="hljs-number">1</span></span>:]: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> self.worm.head_intersect(cell): <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> cell <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">False</span></span></code> </pre><br><img src="https://habrastorage.org/webt/fu/yt/m4/fuytm4is8yrdbrlym0c5yj8bta8.png"><br><br><h3>  рд░рдВрдЧ, рд╕рдЬрд╛рдиреЗ, рдФрд░ рдХреЛрдб refactoring </h3><br>  рдЪрд▓реЛ рдХреЛрдб рд░реАрдлреИрдХреНрдЯрд░рд┐рдВрдЧ рдХреЗ рд╕рд╛рде рд╢реБрд░реВ рдХрд░рддреЗ рд╣реИрдВред <br><br>  рдлрд┐рд░ рд╕реЗ рд▓рд┐рдЦрдирд╛ рдФрд░ рдЬреЛрдбрд╝рдирд╛ <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Form</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Widget)</span></span></span><span class="hljs-class">:</span></span> ... <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">start</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.worm = Worm(self.config) self.add_widget(self.worm) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> self.fruit <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>: self.remove_widget(self.fruit) self.fruit = Cell(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, self.config.APPLE_SIZE) self.fruit_dislocate() self.add_widget(self.fruit) Clock.schedule_interval(self.update, self.config.INTERVAL) self.game_on = <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> self.cur_dir = (<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">stop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.game_on = <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> Clock.unschedule(self.update) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">game_over</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.stop() ... <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">on_touch_down</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, touch)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> self.game_on: self.worm.destroy() self.start() <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ...</code> </pre><br>  рдЕрдм рдЕрдЧрд░ рдХреАрдбрд╝рд╛ рдорд░ рдЧрдпрд╛ рд╣реИ (рдЬрдореЗ рд╣реБрдП), рдпрджрд┐ рдЖрдк рдлрд┐рд░ рд╕реЗ рдЯреИрдк рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдЧреЗрдо рд░реАрд╕реЗрдЯ рд╣реЛ рдЬрд╛рдПрдЧрд╛ред <br><br>  рдЕрдм рдЪрд▓реЛ рд╕рдЬрд╛рдиреЗ рдФрд░ рд░рдВрдЧ рджреЗрдиреЗ рдХреЗ рд▓рд┐рдПред <br><br>  worm.kv <br><br><pre> <code class="plaintext hljs">&lt;Form&gt;: popup_label: popup_label score_label: score_label canvas: Color: rgba: (.5, .5, .5, 1.0) Line: width: 1.5 points: (0, 0), self.size Line: width: 1.5 points: (self.size[0], 0), (0, self.size[1]) Label: id: score_label text: "Score: " + str(self.parent.worm_len) width: self.width Label: id: popup_label width: self.width &lt;Worm&gt;: &lt;Cell&gt;: canvas: Color: rgba: self.color Rectangle: size: self.graphical_size pos: self.graphical_pos</code> </pre><br>  рдкреБрдирдГ рднреЗрдЬреЗрдВ WormApp: <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">WormApp</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(App)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">build</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.config = Config() self.form = Form(self.config) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self.form <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">on_start</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.form.start()</code> </pre><br><img src="https://habrastorage.org/webt/fk/cq/6v/fkcq6vobxfathjjvs3pg3aak7oo.png"><br><br>  рдЗрд╕реЗ рд░рдВрдЧ рджреЗрдВред  рд░реАрдХреНрд░рд┐рдПрдЯ рд╕реЗрд▓ .kv: <br><br><pre> <code class="plaintext hljs">&lt;Cell&gt;: canvas: Color: rgba: self.color Rectangle: size: self.graphical_size pos: self.graphical_pos</code> </pre><br>  рдЗрд╕реЗ рд╕реЗрд▓ рдореЗрдВ рдЬреЛрдбрд╝реЗрдВ ред__ init__ <br><br><pre> <code class="python hljs">self.color = (<span class="hljs-number"><span class="hljs-number">0.2</span></span>, <span class="hljs-number"><span class="hljs-number">1.0</span></span>, <span class="hljs-number"><span class="hljs-number">0.2</span></span>, <span class="hljs-number"><span class="hljs-number">1.0</span></span>) <span class="hljs-comment"><span class="hljs-comment">#</span></span></code> </pre><br>  рдФрд░ рдпрд╣ рдлреЙрд░реНрдо.рд╕реНрдЯрд╛рд░реНрдЯ рдХреЛ <br><br><pre> <code class="python hljs">self.fruit.color = (<span class="hljs-number"><span class="hljs-number">1.0</span></span>, <span class="hljs-number"><span class="hljs-number">0.2</span></span>, <span class="hljs-number"><span class="hljs-number">0.2</span></span>, <span class="hljs-number"><span class="hljs-number">1.0</span></span>)</code> </pre><br>  рдорд╣рд╛рди, рдЕрдкрдиреЗ рд╕рд╛рдБрдк рдХрд╛ рдЖрдирдВрдж рд▓реЗрдВ <br><br><img src="https://habrastorage.org/webt/1e/nh/6f/1enh6fainu28aqcei-9fg0of8iq.png"><br><br>  рдЕрдВрдд рдореЗрдВ, рд╣рдо рдПрдХ "рдЧреЗрдо рдУрд╡рд░" рд▓реЗрдмрд▓ рдмрдирд╛рдПрдВрдЧреЗ <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Form</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Widget)</span></span></span><span class="hljs-class">:</span></span> ... <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, config)</span></span></span><span class="hljs-function">:</span></span> ... self.popup_label.text = <span class="hljs-string"><span class="hljs-string">""</span></span> ... <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">stop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, text=</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">""</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> self.game_on = <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> self.popup_label.text = text Clock.unschedule(self.update) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">game_over</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.stop(<span class="hljs-string"><span class="hljs-string">"GAME OVER"</span></span> + <span class="hljs-string"><span class="hljs-string">" "</span></span> * <span class="hljs-number"><span class="hljs-number">5</span></span> + <span class="hljs-string"><span class="hljs-string">"\ntap to reset"</span></span>)</code> </pre><br>  рдФрд░ рд╣рд┐рдЯ рд╕реЗрд▓ рдХреЛ рд▓рд╛рд▓ рдХрд░реЗрдВ: <br><br>  рдХреЗ рдмрдЬрд╛рдп <br><br><pre> <code class="python hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">update</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, _)</span></span></span><span class="hljs-function">:</span></span> ... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> self.worm_bite_self(): self.game_over() ...</code> </pre><br>  рд▓рд┐рдЦрдиреЗ <br><br><pre> <code class="python hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">update</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, _)</span></span></span><span class="hljs-function">:</span></span> cell = self.worm_bite_self() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> cell: cell.color = (<span class="hljs-number"><span class="hljs-number">1.0</span></span>, <span class="hljs-number"><span class="hljs-number">0.2</span></span>, <span class="hljs-number"><span class="hljs-number">0.2</span></span>, <span class="hljs-number"><span class="hljs-number">1.0</span></span>) self.game_over()</code> </pre><br><img src="https://habrastorage.org/webt/lw/mr/na/lwmrnagdbvjt79qacs0kt9jg_2k.png"><br><br>  рдХреНрдпрд╛ рдЖрдк рдЕрднреА рднреА рдзреНрдпрд╛рди рджреЗ рд░рд╣реЗ рд╣реИрдВ?  рдЕрдЧрд▓рд╛ рднрд╛рдЧ рд╕рдмрд╕реЗ рджрд┐рд▓рдЪрд╕реНрдк рд╣рд┐рд╕реНрд╕рд╛ рд╣реИред <br><br><h3>  рдмреЛрдирд╕ рдЕрдиреБрднрд╛рдЧ - рдЪрд┐рдХрдиреА рдЧрддрд┐ </h3><br>  рдХреНрдпреЛрдВрдХрд┐ рдХреАрдбрд╝рд╛ рдХрд╛ рдЪрд░рдг рд╕реЗрд▓_рд╕рд╛рдЗрдЬ рдХреЗ рдмрд░рд╛рдмрд░ рд╣реИ, рдпрд╣ рдЙрддрдирд╛ рдЪрд┐рдХрдирд╛ рдирд╣реАрдВ рд╣реИред  рд▓реЗрдХрд┐рди рд╣рдо рдЗрд╕реЗ рдЦреЗрд▓ рдХреЗ рдкреВрд░реЗ рддрд░реНрдХ рдХреЛ рдлрд┐рд░ рд╕реЗ рд▓рд┐рдЦреЗ рдмрд┐рдирд╛, рдЬрд┐рддрдирд╛ рд╕рдВрднрд╡ рд╣реЛ рдЙрддрдирд╛ рдмрд╛рд░ рд╕рдВрднрд╡ рдмрдирд╛рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВред  рдЗрд╕рд▓рд┐рдП, рд╣рдореЗрдВ рдЕрдкрдиреЗ рдЧреНрд░рд╛рдлрд┐рдХрд▓ рдкреЛрдЬрд╝ рдХреЛ рдЖрдЧреЗ рдмрдврд╝рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рддрдВрддреНрд░ рдмрдирд╛рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рд╣рдорд╛рд░реЗ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдкреЛрдЬрд╝ рдХреА рдирд╣реАрдВред  рдЗрд╕рд▓рд┐рдП, рдореИрдВрдиреЗ рдПрдХ рд╕рд╛рдзрд╛рд░рдг рдлрд╛рдЗрд▓ рд▓рд┐рдЦреА рд╣реИ: <br><br>  smooth.py <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> kivy.clock <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Clock <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> time <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Timing</span></span></span><span class="hljs-class">:</span></span> @staticmethod <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">linear</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> x <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Smooth</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, interval=</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">1.0</span></span></span></span><span class="hljs-function"><span class="hljs-params">/</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">60.0</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> self.objs = [] self.running = <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> self.interval = interval <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">run</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> self.running: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self.running = <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> Clock.schedule_interval(self.update, self.interval) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">stop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> self.running: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self.running = <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> Clock.unschedule(self.update) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setattr</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, obj, attr, value)</span></span></span><span class="hljs-function">:</span></span> exec(<span class="hljs-string"><span class="hljs-string">"obj."</span></span> + attr + <span class="hljs-string"><span class="hljs-string">" = "</span></span> + str(value)) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getattr</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, obj, attr)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> float(eval(<span class="hljs-string"><span class="hljs-string">"obj."</span></span> + attr)) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">update</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, _)</span></span></span><span class="hljs-function">:</span></span> cur_time = time.time() <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> line <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> self.objs: obj, prop_name_x, prop_name_y, from_x, from_y, to_x, to_y, start_time, period, timing = line time_gone = cur_time - start_time <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> time_gone &gt;= period: self.setattr(obj, prop_name_x, to_x) self.setattr(obj, prop_name_y, to_y) self.objs.remove(line) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: share = time_gone / period acs = timing(share) self.setattr(obj, prop_name_x, from_x * (<span class="hljs-number"><span class="hljs-number">1</span></span> - acs) + to_x * acs) self.setattr(obj, prop_name_y, from_y * (<span class="hljs-number"><span class="hljs-number">1</span></span> - acs) + to_y * acs) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> len(self.objs) == <span class="hljs-number"><span class="hljs-number">0</span></span>: self.stop() <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">move_to</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, obj, prop_name_x, prop_name_y, to_x, to_y, t, timing=Timing.linear)</span></span></span><span class="hljs-function">:</span></span> self.objs.append((obj, prop_name_x, prop_name_y, self.getattr(obj, prop_name_x), self.getattr(obj, prop_name_y), to_x, to_y, time.time(), t, timing)) self.run() <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">XSmooth</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Smooth)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, props, timing=Timing.linear, *args, **kwargs)</span></span></span><span class="hljs-function">:</span></span> super().__init__(*args, **kwargs) self.props = props self.timing = timing <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">move_to</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, obj, to_x, to_y, t)</span></span></span><span class="hljs-function">:</span></span> super().move_to(obj, *self.props, to_x, to_y, t, timing=self.timing)</code> </pre><br><div class="spoiler">  <b class="spoiler_title">рдореЗрд░реЗ рдХреЛрдб рдХреЛ рдирд╛рдкрд╕рдВрдж рдХрд░рдиреЗ рд╡рд╛рд▓реЛрдВ рдХреЛ</b> <div class="spoiler_text">  рдпрд╣ рдореЙрдбреНрдпреВрд▓ рд╕рдмрд╕реЗ рд╕реБрд░реБрдЪрд┐рдкреВрд░реНрдг рд╕рдорд╛рдзрд╛рди рдирд╣реАрдВ рд╣реИ ┬йред  рдпрд╣ рдПрдХ рдмреБрд░рд╛ рд╕рдорд╛рдзрд╛рди рд╣реИ рдФрд░ рдореИрдВ рдЗрд╕реЗ рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рддрд╛ рд╣реВрдВред  рдпрд╣ рдПрдХрдорд╛рддреНрд░-рд╣реИрд▓реЛ-рд╡рд░реНрд▓реНрдб рд╕рдорд╛рдзрд╛рди рд╣реИред <br></div></div><br>  рдЗрд╕рд▓рд┐рдП рдЖрдк рдмрд╕ рдЗрд╕ рдХреЛрдб рдХреЛ рдлрд╝рд╛рдЗрд▓ рдХреЗ рд▓рд┐рдП smooth.py рдФрд░ copy-paste рдХрд░реЗрдВред <br>  рдЕрдВрдд рдореЗрдВ, рдЪрд▓реЛ рдЗрд╕реЗ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ: <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Form</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Widget)</span></span></span><span class="hljs-class">:</span></span> ... <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, config)</span></span></span><span class="hljs-function">:</span></span> ... self.smooth = smooth.XSmooth([<span class="hljs-string"><span class="hljs-string">"graphical_pos[0]"</span></span>, <span class="hljs-string"><span class="hljs-string">"graphical_pos[1]"</span></span>])</code> </pre><br>  рддрдм рд╣рдо self.worm.move () рдХреЛ рдкреНрд░рддрд┐рд╕реНрдерд╛рдкрд┐рдд рдХрд░рддреЗ рд╣реИрдВ <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Form</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Widget)</span></span></span><span class="hljs-class">:</span></span> ... <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">update</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, _)</span></span></span><span class="hljs-function">:</span></span> ... self.worm.move(self.cur_dir, smooth_motion=(self.smooth, self.config.INTERVAL))</code> </pre><br>  рдФрд░ рдпрд╣ рд╣реИ рдХрд┐ рд╕реЗрд▓ рдХреЗ рддрд░реАрдХреЗ рдХреИрд╕реЗ рджрд┐рдЦрдирд╛ рдЪрд╛рд╣рд┐рдП <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Cell</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Widget)</span></span></span><span class="hljs-class">:</span></span> ... <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">graphical_pos_attach</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, smooth_motion=None)</span></span></span><span class="hljs-function">:</span></span> to_x, to_y = self.actual_pos[<span class="hljs-number"><span class="hljs-number">0</span></span>] - self.graphical_size[<span class="hljs-number"><span class="hljs-number">0</span></span>] / <span class="hljs-number"><span class="hljs-number">2</span></span>, self.actual_pos[<span class="hljs-number"><span class="hljs-number">1</span></span>] - self.graphical_size[<span class="hljs-number"><span class="hljs-number">1</span></span>] / <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> smooth_motion <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>: self.graphical_pos = to_x, to_y <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: smoother, t = smooth_motion smoother.move_to(self, to_x, to_y, t) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">move_to</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, x, y, **kwargs)</span></span></span><span class="hljs-function">:</span></span> self.actual_pos = (x, y) self.graphical_pos_attach(**kwargs) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">move_by</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, x, y, **kwargs)</span></span></span><span class="hljs-function">:</span></span> self.move_to(self.actual_pos[<span class="hljs-number"><span class="hljs-number">0</span></span>] + x, self.actual_pos[<span class="hljs-number"><span class="hljs-number">1</span></span>] + y, **kwargs)</code> </pre><br>  рдпрд╣реА рд╣реИ, рдЖрдкрдХреЗ рдзреНрдпрд╛рди рдХреЗ рд▓рд┐рдП рдзрдиреНрдпрд╡рд╛рдж! <br><br>  рдЕрдВрддрд┐рдо рдкрд░рд┐рдгрд╛рдо рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/0clOAucqRDE" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><div class="spoiler">  <b class="spoiler_title">рдЕрдВрддрд┐рдо рдХреЛрдб</b> <div class="spoiler_text"><div class="spoiler">  <b class="spoiler_title">main.py</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> kivy.app <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> App <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> kivy.uix.widget <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Widget <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> kivy.clock <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Clock <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> kivy.properties <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> random <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> smooth <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Cell</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Widget)</span></span></span><span class="hljs-class">:</span></span> graphical_size = ListProperty([<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>]) graphical_pos = ListProperty([<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>]) color = ListProperty([<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>]) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, x, y, size, margin=</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">4</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> super().__init__() self.actual_size = (size, size) self.graphical_size = (size - margin, size - margin) self.margin = margin self.actual_pos = (x, y) self.graphical_pos_attach() self.color = (<span class="hljs-number"><span class="hljs-number">0.2</span></span>, <span class="hljs-number"><span class="hljs-number">1.0</span></span>, <span class="hljs-number"><span class="hljs-number">0.2</span></span>, <span class="hljs-number"><span class="hljs-number">1.0</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">graphical_pos_attach</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, smooth_motion=None)</span></span></span><span class="hljs-function">:</span></span> to_x, to_y = self.actual_pos[<span class="hljs-number"><span class="hljs-number">0</span></span>] - self.graphical_size[<span class="hljs-number"><span class="hljs-number">0</span></span>] / <span class="hljs-number"><span class="hljs-number">2</span></span>, self.actual_pos[<span class="hljs-number"><span class="hljs-number">1</span></span>] - self.graphical_size[<span class="hljs-number"><span class="hljs-number">1</span></span>] / <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> smooth_motion <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>: self.graphical_pos = to_x, to_y <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: smoother, t = smooth_motion smoother.move_to(self, to_x, to_y, t) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">move_to</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, x, y, **kwargs)</span></span></span><span class="hljs-function">:</span></span> self.actual_pos = (x, y) self.graphical_pos_attach(**kwargs) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">move_by</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, x, y, **kwargs)</span></span></span><span class="hljs-function">:</span></span> self.move_to(self.actual_pos[<span class="hljs-number"><span class="hljs-number">0</span></span>] + x, self.actual_pos[<span class="hljs-number"><span class="hljs-number">1</span></span>] + y, **kwargs) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_pos</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self.actual_pos <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">step_by</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, direction, **kwargs)</span></span></span><span class="hljs-function">:</span></span> self.move_by(self.actual_size[<span class="hljs-number"><span class="hljs-number">0</span></span>] * direction[<span class="hljs-number"><span class="hljs-number">0</span></span>], self.actual_size[<span class="hljs-number"><span class="hljs-number">1</span></span>] * direction[<span class="hljs-number"><span class="hljs-number">1</span></span>], **kwargs) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Worm</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Widget)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, config)</span></span></span><span class="hljs-function">:</span></span> super().__init__() self.cells = [] self.config = config self.cell_size = config.CELL_SIZE self.head_init((<span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(config.DEFAULT_LENGTH): self.lengthen() <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">destroy</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(len(self.cells)): self.remove_widget(self.cells[i]) self.cells = [] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">lengthen</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, pos=None, direction=</span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">(</span></span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span></span><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">, </span></span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params"><span class="hljs-number">1</span></span></span></span></span><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">)</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> pos <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>: px = self.cells[<span class="hljs-number"><span class="hljs-number">-1</span></span>].get_pos()[<span class="hljs-number"><span class="hljs-number">0</span></span>] + direction[<span class="hljs-number"><span class="hljs-number">0</span></span>] * self.cell_size py = self.cells[<span class="hljs-number"><span class="hljs-number">-1</span></span>].get_pos()[<span class="hljs-number"><span class="hljs-number">1</span></span>] + direction[<span class="hljs-number"><span class="hljs-number">1</span></span>] * self.cell_size pos = (px, py) self.cells.append(Cell(*pos, self.cell_size, margin=self.config.MARGIN)) self.add_widget(self.cells[<span class="hljs-number"><span class="hljs-number">-1</span></span>]) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">head_init</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, pos)</span></span></span><span class="hljs-function">:</span></span> self.lengthen(pos=pos) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">move</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, direction, **kwargs)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(len(self.cells) - <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>): self.cells[i].move_to(*self.cells[i - <span class="hljs-number"><span class="hljs-number">1</span></span>].get_pos(), **kwargs) self.cells[<span class="hljs-number"><span class="hljs-number">0</span></span>].step_by(direction, **kwargs) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">gather_positions</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> [cell.get_pos() <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> cell <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> self.cells] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">head_intersect</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, cell)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self.cells[<span class="hljs-number"><span class="hljs-number">0</span></span>].get_pos() == cell.get_pos() <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Form</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Widget)</span></span></span><span class="hljs-class">:</span></span> worm_len = NumericProperty(<span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, config)</span></span></span><span class="hljs-function">:</span></span> super().__init__() self.config = config self.worm = <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> self.cur_dir = (<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) self.fruit = <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> self.game_on = <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> self.smooth = smooth.XSmooth([<span class="hljs-string"><span class="hljs-string">"graphical_pos[0]"</span></span>, <span class="hljs-string"><span class="hljs-string">"graphical_pos[1]"</span></span>]) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">random_cell_location</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, offset)</span></span></span><span class="hljs-function">:</span></span> x_row = self.size[<span class="hljs-number"><span class="hljs-number">0</span></span>] // self.config.CELL_SIZE x_col = self.size[<span class="hljs-number"><span class="hljs-number">1</span></span>] // self.config.CELL_SIZE <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> random.randint(offset, x_row - offset), random.randint(offset, x_col - offset) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">random_location</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, offset)</span></span></span><span class="hljs-function">:</span></span> x_row, x_col = self.random_cell_location(offset) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self.config.CELL_SIZE * x_row, self.config.CELL_SIZE * x_col <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fruit_dislocate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> x, y = self.random_location(<span class="hljs-number"><span class="hljs-number">2</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (x, y) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> self.worm.gather_positions(): x, y = self.random_location(<span class="hljs-number"><span class="hljs-number">2</span></span>) self.fruit.move_to(x, y) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">start</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.worm = Worm(self.config) self.add_widget(self.worm) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> self.fruit <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>: self.remove_widget(self.fruit) self.fruit = Cell(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, self.config.APPLE_SIZE) self.fruit.color = (<span class="hljs-number"><span class="hljs-number">1.0</span></span>, <span class="hljs-number"><span class="hljs-number">0.2</span></span>, <span class="hljs-number"><span class="hljs-number">0.2</span></span>, <span class="hljs-number"><span class="hljs-number">1.0</span></span>) self.fruit_dislocate() self.add_widget(self.fruit) self.game_on = <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> self.cur_dir = (<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>) Clock.schedule_interval(self.update, self.config.INTERVAL) self.popup_label.text = <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">stop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, text=</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">""</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> self.game_on = <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> self.popup_label.text = text Clock.unschedule(self.update) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">game_over</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.stop(<span class="hljs-string"><span class="hljs-string">"GAME OVER"</span></span> + <span class="hljs-string"><span class="hljs-string">" "</span></span> * <span class="hljs-number"><span class="hljs-number">5</span></span> + <span class="hljs-string"><span class="hljs-string">"\ntap to reset"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">align_labels</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: self.popup_label.pos = ((self.size[<span class="hljs-number"><span class="hljs-number">0</span></span>] - self.popup_label.width) / <span class="hljs-number"><span class="hljs-number">2</span></span>, self.size[<span class="hljs-number"><span class="hljs-number">1</span></span>] / <span class="hljs-number"><span class="hljs-number">2</span></span>) self.score_label.pos = ((self.size[<span class="hljs-number"><span class="hljs-number">0</span></span>] - self.score_label.width) / <span class="hljs-number"><span class="hljs-number">2</span></span>, self.size[<span class="hljs-number"><span class="hljs-number">1</span></span>] - <span class="hljs-number"><span class="hljs-number">80</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">except</span></span>: print(self.__dict__) <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">update</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, _)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> self.game_on: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self.worm.move(self.cur_dir, smooth_motion=(self.smooth, self.config.INTERVAL)) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> self.worm.head_intersect(self.fruit): directions = [(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>), (<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>), (<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>), (<span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>)] self.worm.lengthen(direction=random.choice(directions)) self.fruit_dislocate() cell = self.worm_bite_self() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> cell: cell.color = (<span class="hljs-number"><span class="hljs-number">1.0</span></span>, <span class="hljs-number"><span class="hljs-number">0.2</span></span>, <span class="hljs-number"><span class="hljs-number">0.2</span></span>, <span class="hljs-number"><span class="hljs-number">1.0</span></span>) self.game_over() self.worm_len = len(self.worm.cells) self.align_labels() <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">on_touch_down</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, touch)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> self.game_on: self.worm.destroy() self.start() <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ws = touch.x / self.size[<span class="hljs-number"><span class="hljs-number">0</span></span>] hs = touch.y / self.size[<span class="hljs-number"><span class="hljs-number">1</span></span>] aws = <span class="hljs-number"><span class="hljs-number">1</span></span> - ws <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ws &gt; hs <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> aws &gt; hs: cur_dir = (<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">elif</span></span> ws &gt; hs &gt;= aws: cur_dir = (<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">elif</span></span> ws &lt;= hs &lt; aws: cur_dir = (<span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: cur_dir = (<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>) self.cur_dir = cur_dir <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">worm_bite_self</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> cell <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> self.worm.cells[<span class="hljs-number"><span class="hljs-number">1</span></span>:]: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> self.worm.head_intersect(cell): <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> cell <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Config</span></span></span><span class="hljs-class">:</span></span> DEFAULT_LENGTH = <span class="hljs-number"><span class="hljs-number">20</span></span> CELL_SIZE = <span class="hljs-number"><span class="hljs-number">25</span></span> APPLE_SIZE = <span class="hljs-number"><span class="hljs-number">35</span></span> MARGIN = <span class="hljs-number"><span class="hljs-number">4</span></span> INTERVAL = <span class="hljs-number"><span class="hljs-number">0.3</span></span> DEAD_CELL = (<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>) APPLE_COLOR = (<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">WormApp</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(App)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">build</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.config = Config() self.form = Form(self.config) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self.form <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">on_start</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.form.start() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> __name__ == <span class="hljs-string"><span class="hljs-string">'__main__'</span></span>: WormApp().run()</code> </pre><br></div></div><br><br><div class="spoiler">  <b class="spoiler_title">smooth.py</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> kivy.clock <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Clock <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> time <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Timing</span></span></span><span class="hljs-class">:</span></span> @staticmethod <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">linear</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> x <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Smooth</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, interval=</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">1.0</span></span></span></span><span class="hljs-function"><span class="hljs-params">/</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">60.0</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> self.objs = [] self.running = <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> self.interval = interval <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">run</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> self.running: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self.running = <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> Clock.schedule_interval(self.update, self.interval) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">stop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> self.running: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self.running = <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> Clock.unschedule(self.update) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setattr</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, obj, attr, value)</span></span></span><span class="hljs-function">:</span></span> exec(<span class="hljs-string"><span class="hljs-string">"obj."</span></span> + attr + <span class="hljs-string"><span class="hljs-string">" = "</span></span> + str(value)) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getattr</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, obj, attr)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> float(eval(<span class="hljs-string"><span class="hljs-string">"obj."</span></span> + attr)) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">update</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, _)</span></span></span><span class="hljs-function">:</span></span> cur_time = time.time() <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> line <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> self.objs: obj, prop_name_x, prop_name_y, from_x, from_y, to_x, to_y, start_time, period, timing = line time_gone = cur_time - start_time <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> time_gone &gt;= period: self.setattr(obj, prop_name_x, to_x) self.setattr(obj, prop_name_y, to_y) self.objs.remove(line) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: share = time_gone / period acs = timing(share) self.setattr(obj, prop_name_x, from_x * (<span class="hljs-number"><span class="hljs-number">1</span></span> - acs) + to_x * acs) self.setattr(obj, prop_name_y, from_y * (<span class="hljs-number"><span class="hljs-number">1</span></span> - acs) + to_y * acs) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> len(self.objs) == <span class="hljs-number"><span class="hljs-number">0</span></span>: self.stop() <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">move_to</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, obj, prop_name_x, prop_name_y, to_x, to_y, t, timing=Timing.linear)</span></span></span><span class="hljs-function">:</span></span> self.objs.append((obj, prop_name_x, prop_name_y, self.getattr(obj, prop_name_x), self.getattr(obj, prop_name_y), to_x, to_y, time.time(), t, timing)) self.run() <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">XSmooth</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Smooth)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, props, timing=Timing.linear, *args, **kwargs)</span></span></span><span class="hljs-function">:</span></span> super().__init__(*args, **kwargs) self.props = props self.timing = timing <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">move_to</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, obj, to_x, to_y, t)</span></span></span><span class="hljs-function">:</span></span> super().move_to(obj, *self.props, to_x, to_y, t, timing=self.timing)</code> </pre><br></div></div><br><br><div class="spoiler">  <b class="spoiler_title">worm.kv</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">&lt;Form&gt;: popup_label: popup_label score_label: score_label canvas: Color: rgba: (.5, .5, .5, 1.0) Line: width: 1.5 points: (0, 0), self.size Line: width: 1.5 points: (self.size[0], 0), (0, self.size[1]) Label: id: score_label text: "Score: " + str(self.parent.worm_len) width: self.width Label: id: popup_label width: self.width &lt;Worm&gt;: &lt;Cell&gt;: canvas: Color: rgba: self.color Rectangle: size: self.graphical_size pos: self.graphical_pos</code> </pre><br></div></div><br></div></div><br><br><div class="spoiler">  <b class="spoiler_title">рдХреЛрдб, @tshirtman рджреНрд╡рд╛рд░рд╛ рд╕рдорд╛рдпреЛрдЬрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛</b> <div class="spoiler_text">  рдореБрдЭреЗ рдЕрдкрдиреЗ рдХреЛрдб рдХреЗ рд╕рд╛рде рдХреБрдЫ рдореБрджреНрджреЗ рдорд┐рд▓реЗ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЯреАрд╢рд░реНрдЯрдореИрди, рдХрд┐рд╡реА рдкрд░рд┐рдпреЛрдЬрдирд╛ рдХреЗ рдпреЛрдЧрджрд╛рдирдХрд░реНрддрд╛рдУрдВ рдореЗрдВ рд╕реЗ рдПрдХ, рдиреЗ рдореБрдЭреЗ рд╕реЗрд▓ рдХреЛ рд╡рд┐рдЬреЗрдЯ рдХреЗ рд░реВрдк рдореЗрдВ рдирд╣реАрдВ рдмрдирд╛рдиреЗ рдХрд╛ рд╕реБрдЭрд╛рд╡ рджрд┐рдпрд╛, рд▓реЗрдХрд┐рди рдЗрд╕рдХреЗ рдмрдЬрд╛рдп рдПрдХ рдкреНрд╡рд╛рдЗрдВрдЯ рдирд┐рд░реНрджреЗрд╢ рдмрдирд╛рдпрд╛ред  рд╣рд╛рд▓рд╛рдБрдХрд┐, рдореБрдЭреЗ рдпрд╣ рдХреЛрдб рд╕рдордЭрдиреЗ рдореЗрдВ рдЖрд╕рд╛рди рдирд╣реАрдВ рд╣реИ, рднрд▓реЗ рд╣реА рдпрд╣ рдпреВрдЖрдИ рдФрд░ рдЧреЗрдо рдбреЗрд╡рд▓рдкрдореЗрдВрдЯ рдХреЗ рдорд╛рдорд▓реЗ рдореЗрдВ рдирд┐рд╢реНрдЪрд┐рдд рд░реВрдк рд╕реЗ рдЕрдЪреНрдЫрд╛ рд╣реИред  рд╡реИрд╕реЗ рднреА, рдХреЛрдб: <br><div class="spoiler">  <b class="spoiler_title">main.py</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> kivy.app <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> App <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> kivy.uix.widget <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Widget <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> kivy.clock <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Clock <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> kivy.properties <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> random <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> smooth <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Cell</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, x, y)</span></span></span><span class="hljs-function">:</span></span> self.actual_pos = (x, y) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">move_to</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, x, y)</span></span></span><span class="hljs-function">:</span></span> self.actual_pos = (x, y) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">move_by</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, x, y)</span></span></span><span class="hljs-function">:</span></span> self.move_to(self.actual_pos[<span class="hljs-number"><span class="hljs-number">0</span></span>] + x, self.actual_pos[<span class="hljs-number"><span class="hljs-number">1</span></span>] + y) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_pos</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self.actual_pos <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Fruit</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Cell)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, x, y)</span></span></span><span class="hljs-function">:</span></span> super().__init__(x, y) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Worm</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Widget)</span></span></span><span class="hljs-class">:</span></span> margin = NumericProperty(<span class="hljs-number"><span class="hljs-number">4</span></span>) graphical_poses = ListProperty() inj_pos = ListProperty([<span class="hljs-number"><span class="hljs-number">-1000</span></span>, <span class="hljs-number"><span class="hljs-number">-1000</span></span>]) graphical_size = NumericProperty(<span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, config, **kwargs)</span></span></span><span class="hljs-function">:</span></span> super().__init__(**kwargs) self.cells = [] self.config = config self.cell_size = config.CELL_SIZE self.head_init((self.config.CELL_SIZE * random.randint(<span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>), self.config.CELL_SIZE * random.randint(<span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>))) self.margin = config.MARGIN self.graphical_size = self.cell_size - self.margin <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(config.DEFAULT_LENGTH): self.lengthen() <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">destroy</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.cells = [] self.graphical_poses = [] self.inj_pos = [<span class="hljs-number"><span class="hljs-number">-1000</span></span>, <span class="hljs-number"><span class="hljs-number">-1000</span></span>] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cell_append</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, pos)</span></span></span><span class="hljs-function">:</span></span> self.cells.append(Cell(*pos)) self.graphical_poses.extend([<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>]) self.cell_move_to(len(self.cells) - <span class="hljs-number"><span class="hljs-number">1</span></span>, pos) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">lengthen</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, pos=None, direction=</span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">(</span></span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span></span><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">, </span></span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params"><span class="hljs-number">1</span></span></span></span></span><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">)</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> pos <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>: px = self.cells[<span class="hljs-number"><span class="hljs-number">-1</span></span>].get_pos()[<span class="hljs-number"><span class="hljs-number">0</span></span>] + direction[<span class="hljs-number"><span class="hljs-number">0</span></span>] * self.cell_size py = self.cells[<span class="hljs-number"><span class="hljs-number">-1</span></span>].get_pos()[<span class="hljs-number"><span class="hljs-number">1</span></span>] + direction[<span class="hljs-number"><span class="hljs-number">1</span></span>] * self.cell_size pos = (px, py) self.cell_append(pos) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">head_init</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, pos)</span></span></span><span class="hljs-function">:</span></span> self.lengthen(pos=pos) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cell_move_to</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, i, pos, smooth_motion=None)</span></span></span><span class="hljs-function">:</span></span> self.cells[i].move_to(*pos) to_x, to_y = pos[<span class="hljs-number"><span class="hljs-number">0</span></span>], pos[<span class="hljs-number"><span class="hljs-number">1</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> smooth_motion <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>: self.graphical_poses[i * <span class="hljs-number"><span class="hljs-number">2</span></span>], self.graphical_poses[i * <span class="hljs-number"><span class="hljs-number">2</span></span> + <span class="hljs-number"><span class="hljs-number">1</span></span>] = to_x, to_y <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: smoother, t = smooth_motion smoother.move_to(self, <span class="hljs-string"><span class="hljs-string">"graphical_poses["</span></span> + str(i * <span class="hljs-number"><span class="hljs-number">2</span></span>) + <span class="hljs-string"><span class="hljs-string">"]"</span></span>, <span class="hljs-string"><span class="hljs-string">"graphical_poses["</span></span> + str(i * <span class="hljs-number"><span class="hljs-number">2</span></span> + <span class="hljs-number"><span class="hljs-number">1</span></span>) + <span class="hljs-string"><span class="hljs-string">"]"</span></span>, to_x, to_y, t) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">move</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, direction, **kwargs)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(len(self.cells) - <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>): self.cell_move_to(i, self.cells[i - <span class="hljs-number"><span class="hljs-number">1</span></span>].get_pos(), **kwargs) self.cell_move_to(<span class="hljs-number"><span class="hljs-number">0</span></span>, (self.cells[<span class="hljs-number"><span class="hljs-number">0</span></span>].get_pos()[<span class="hljs-number"><span class="hljs-number">0</span></span>] + self.cell_size * direction[<span class="hljs-number"><span class="hljs-number">0</span></span>], self.cells[<span class="hljs-number"><span class="hljs-number">0</span></span>].get_pos()[<span class="hljs-number"><span class="hljs-number">1</span></span>] + self.cell_size * direction[<span class="hljs-number"><span class="hljs-number">1</span></span>]), **kwargs) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">gather_positions</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> [cell.get_pos() <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> cell <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> self.cells] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">head_intersect</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, cell)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self.cells[<span class="hljs-number"><span class="hljs-number">0</span></span>].get_pos() == cell.get_pos() <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Form</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Widget)</span></span></span><span class="hljs-class">:</span></span> worm_len = NumericProperty(<span class="hljs-number"><span class="hljs-number">0</span></span>) fruit_pos = ListProperty([<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>]) fruit_size = NumericProperty(<span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, config, **kwargs)</span></span></span><span class="hljs-function">:</span></span> super().__init__(**kwargs) self.config = config self.worm = <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> self.cur_dir = (<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) self.fruit = <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> self.game_on = <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> self.smooth = smooth.Smooth() <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">random_cell_location</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, offset)</span></span></span><span class="hljs-function">:</span></span> x_row = self.size[<span class="hljs-number"><span class="hljs-number">0</span></span>] // self.config.CELL_SIZE x_col = self.size[<span class="hljs-number"><span class="hljs-number">1</span></span>] // self.config.CELL_SIZE <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> random.randint(offset, x_row - offset), random.randint(offset, x_col - offset) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">random_location</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, offset)</span></span></span><span class="hljs-function">:</span></span> x_row, x_col = self.random_cell_location(offset) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self.config.CELL_SIZE * x_row, self.config.CELL_SIZE * x_col <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fruit_dislocate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, xy=None)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> xy <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>: x, y = xy <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: x, y = self.random_location(<span class="hljs-number"><span class="hljs-number">2</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (x, y) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> self.worm.gather_positions(): x, y = self.random_location(<span class="hljs-number"><span class="hljs-number">2</span></span>) self.fruit.move_to(x, y) self.fruit_pos = (x, y) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">start</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.worm = Worm(self.config) self.add_widget(self.worm) self.fruit = Fruit(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) self.fruit_size = self.config.APPLE_SIZE self.fruit_dislocate() self.game_on = <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> self.cur_dir = (<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>) Clock.schedule_interval(self.update, self.config.INTERVAL) self.popup_label.text = <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">stop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, text=</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">""</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> self.game_on = <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> self.popup_label.text = text Clock.unschedule(self.update) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">game_over</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.stop(<span class="hljs-string"><span class="hljs-string">"GAME OVER"</span></span> + <span class="hljs-string"><span class="hljs-string">" "</span></span> * <span class="hljs-number"><span class="hljs-number">5</span></span> + <span class="hljs-string"><span class="hljs-string">"\ntap to reset"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">align_labels</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.popup_label.pos = ((self.size[<span class="hljs-number"><span class="hljs-number">0</span></span>] - self.popup_label.width) / <span class="hljs-number"><span class="hljs-number">2</span></span>, self.size[<span class="hljs-number"><span class="hljs-number">1</span></span>] / <span class="hljs-number"><span class="hljs-number">2</span></span>) self.score_label.pos = ((self.size[<span class="hljs-number"><span class="hljs-number">0</span></span>] - self.score_label.width) / <span class="hljs-number"><span class="hljs-number">2</span></span>, self.size[<span class="hljs-number"><span class="hljs-number">1</span></span>] - <span class="hljs-number"><span class="hljs-number">80</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">update</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, _)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> self.game_on: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self.worm.move(self.cur_dir, smooth_motion=(self.smooth, self.config.INTERVAL)) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> self.worm.head_intersect(self.fruit): directions = [(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>), (<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>), (<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>), (<span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>)] self.worm.lengthen(direction=random.choice(directions)) self.fruit_dislocate() cell = self.worm_bite_self() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> cell <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>: self.worm.inj_pos = cell.get_pos() self.game_over() self.worm_len = len(self.worm.cells) self.align_labels() <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">on_touch_down</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, touch)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> self.game_on: self.worm.destroy() self.start() <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ws = touch.x / self.size[<span class="hljs-number"><span class="hljs-number">0</span></span>] hs = touch.y / self.size[<span class="hljs-number"><span class="hljs-number">1</span></span>] aws = <span class="hljs-number"><span class="hljs-number">1</span></span> - ws <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ws &gt; hs <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> aws &gt; hs: cur_dir = (<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">elif</span></span> ws &gt; hs &gt;= aws: cur_dir = (<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">elif</span></span> ws &lt;= hs &lt; aws: cur_dir = (<span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: cur_dir = (<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>) self.cur_dir = cur_dir <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">worm_bite_self</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> cell <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> self.worm.cells[<span class="hljs-number"><span class="hljs-number">1</span></span>:]: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> self.worm.head_intersect(cell): <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> cell <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Config</span></span></span><span class="hljs-class">:</span></span> DEFAULT_LENGTH = <span class="hljs-number"><span class="hljs-number">20</span></span> CELL_SIZE = <span class="hljs-number"><span class="hljs-number">26</span></span> <span class="hljs-comment"><span class="hljs-comment"># DO NOT FORGET THAT CELL_SIZE - MARGIN WILL BE DIVIDED BY 4 APPLE_SIZE = 36 MARGIN = 2 INTERVAL = 0.3 DEAD_CELL = (1, 0, 0, 1) APPLE_COLOR = (1, 1, 0, 1) class WormApp(App): def __init__(self, **kwargs): super().__init__(**kwargs) self.form = None def build(self, **kwargs): self.config = Config() self.form = Form(self.config, **kwargs) return self.form def on_start(self): self.form.start() if __name__ == '__main__': WormApp().run()</span></span></code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">smooth.py</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> kivy.clock <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Clock <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> time <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Timing</span></span></span><span class="hljs-class">:</span></span> @staticmethod <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">linear</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> x <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Smooth</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, interval=</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">1.0</span></span></span></span><span class="hljs-function"><span class="hljs-params">/</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">60.0</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> self.objs = [] self.running = <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> self.interval = interval <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">run</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> self.running: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self.running = <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> Clock.schedule_interval(self.update, self.interval) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">stop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> self.running: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self.running = <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> Clock.unschedule(self.update) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">set_attr</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, obj, attr, value)</span></span></span><span class="hljs-function">:</span></span> exec(<span class="hljs-string"><span class="hljs-string">"obj."</span></span> + attr + <span class="hljs-string"><span class="hljs-string">" = "</span></span> + str(value)) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_attr</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, obj, attr)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> float(eval(<span class="hljs-string"><span class="hljs-string">"obj."</span></span> + attr)) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">update</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, _)</span></span></span><span class="hljs-function">:</span></span> cur_time = time.time() <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> line <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> self.objs: obj, prop_name_x, prop_name_y, from_x, from_y, to_x, to_y, start_time, period, timing = line time_gone = cur_time - start_time <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> time_gone &gt;= period: self.set_attr(obj, prop_name_x, to_x) self.set_attr(obj, prop_name_y, to_y) self.objs.remove(line) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: share = time_gone / period acs = timing(share) self.set_attr(obj, prop_name_x, from_x * (<span class="hljs-number"><span class="hljs-number">1</span></span> - acs) + to_x * acs) self.set_attr(obj, prop_name_y, from_y * (<span class="hljs-number"><span class="hljs-number">1</span></span> - acs) + to_y * acs) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> len(self.objs) == <span class="hljs-number"><span class="hljs-number">0</span></span>: self.stop() <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">move_to</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, obj, prop_name_x, prop_name_y, to_x, to_y, t, timing=Timing.linear)</span></span></span><span class="hljs-function">:</span></span> self.objs.append((obj, prop_name_x, prop_name_y, self.get_attr(obj, prop_name_x), self.get_attr(obj, prop_name_y), to_x, to_y, time.time(), t, timing)) self.run() <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">XSmooth</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Smooth)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, props, timing=Timing.linear, *args, **kwargs)</span></span></span><span class="hljs-function">:</span></span> super().__init__(*args, **kwargs) self.props = props self.timing = timing <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">move_to</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, obj, to_x, to_y, t)</span></span></span><span class="hljs-function">:</span></span> super().move_to(obj, *self.props, to_x, to_y, t, timing=self.timing)</code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">worm.kv</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">&lt;Form&gt;: popup_label: popup_label score_label: score_label canvas: Color: rgba: (.5, .5, .5, 1.0) Line: width: 1.5 points: (0, 0), self.size Line: width: 1.5 points: (self.size[0], 0), (0, self.size[1]) Color: rgba: (1.0, 0.2, 0.2, 1.0) Point: points: self.fruit_pos pointsize: self.fruit_size / 2 Label: id: score_label text: "Score: " + str(self.parent.worm_len) width: self.width Label: id: popup_label width: self.width &lt;Worm&gt;: canvas: Color: rgba: (0.2, 1.0, 0.2, 1.0) Point: points: self.graphical_poses pointsize: self.graphical_size / 2 Color: rgba: (1.0, 0.2, 0.2, 1.0) Point: points: self.inj_pos pointsize: self.graphical_size / 2</code> </pre><br></div></div></div></div><br>  рдХреЛрдИ рднреА рдкреНрд░рд╢реНрди рдкреВрдЫрдиреЗ рдХреЗ рд▓рд┐рдП рд╕реНрд╡рддрдВрддреНрд░ рдорд╣рд╕реВрд╕ рдХрд░реЗрдВред </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/hi465523/">https://habr.com/ru/post/hi465523/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi465513/index.html">рдЖрдВрдЦ рдореЗрдВ рдПрдХ рд▓реЙрдЧ: рд╕реАрд╕реАрдЯреАрд╡реА рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рдХреНрдпрд╛ рдХрдордЬреЛрд░рд┐рдпрд╛рдВ рд╣реИрдВ</a></li>
<li><a href="../hi465515/index.html">рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╕рд┐рд╕реНрдХреЛ 200-125 CCNA v3.0ред рджрд┐рди 27. ACL рдХрд╛ рдкрд░рд┐рдЪрдпред рднрд╛рдЧ 1</a></li>
<li><a href="../hi465517/index.html">рдбреВрдбрд▓рдмреЗрд▓ рдкреЗрдкрд░ рдмреЛрд░реНрдб рдЧреЗрдо</a></li>
<li><a href="../hi465519/index.html">рдкреНрд░рджрд░реНрд╢рдиреА PRO // Movement.Expo</a></li>
<li><a href="../hi465521/index.html">рдлреНрд▓рд╛рдИ-рдлреНрд▓рд╛рдИ-рдкреЗрдЯрд▓ ... рдпрд╛ рдпреВрдПрдХреНрд╕ рдбрд┐рдЬрд╛рдЗрдирд░ рдиреЗ рдЗрдВрд╕реНрдЯрд╛рдЧреНрд░рд╛рдо рдкрд░ рдЕрдкрдиреЗ рдЙрддреНрдкрд╛рдж рдХреЛ рдХреИрд╕реЗ рдмрдврд╝рд╛рд╡рд╛ рджрд┐рдпрд╛, рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдПрдХ рдХрд╣рд╛рдиреА</a></li>
<li><a href="../hi465525/index.html">Oracle BI EE 12c рдкрд░ рдореЛрдмрд╛рдЗрд▓ рд░рд┐рдкреЛрд░реНрдЯ - рдПрдХ, рджреЛ, рддреАрдиред рдУрд░реЗрдХрд▓ рдмреАрдЖрдИ рдИрдИ 12 рд╕реА рд╕реАрдПрдбреА рдХреЛрд░реНрд╕ рд╕реЗ рдкрджреНрдзрддрд┐</a></li>
<li><a href="../hi465527/index.html">RFC 4357 рд╕реЗ RFC 8645 рддрдХ рд▓рдВрдмреА рдпрд╛рддреНрд░рд╛ рдпрд╛ рдПрдиреНрдХреНрд░рд┐рдкреНрд╢рди рдХреБрдВрдЬреА рдХрд╛ рдкреНрд░рдмрдВрдзрди рдХреИрд╕реЗ рдХрд░реЗрдВ</a></li>
<li><a href="../hi465529/index.html">рдЕрд╡рд░реБрджреНрдз рдХрд░рдиреЗ рдкрд░ рдирд┐рд▓рдВрдмрди</a></li>
<li><a href="../hi465531/index.html">рдЕрдирд┐рд╢реНрдЪрд┐рддрдХрд╛рд▓реАрди рдЧрд╣рд░рд╛рдИ рдХреА рдиреЗрд╕реНрдЯреЗрдб рд╕реВрдЪрд┐рдпреЛрдВ рдХреЛ рдЦреЛрд▓рдирд╛</a></li>
<li><a href="../hi465535/index.html">IPv6 рдХреЛ рдХреМрди рд▓рд╛рдЧреВ рдХрд░рддрд╛ рд╣реИ, рдФрд░ рдЗрд╕рдХреЗ рд╡рд┐рдХрд╛рд╕ рдореЗрдВ рдХреНрдпрд╛ рдмрд╛рдзрд╛ рдЖрддреА рд╣реИ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>