<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üê∑ üë®üèø‚Äç‚öñÔ∏è üíú Vergleichen von Profilierungssitzungen in XHProf Admin ü•ì üî¥ üöõ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Der Artikel handelt von einem praktischen Tool zum Vergleichen von Sitzungen zur Erstellung von PHP-Code-Profilen, mit dem Engp√§sse im Projekt auf CMS...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Vergleichen von Profilierungssitzungen in XHProf Admin</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/478858/"><p>  Der Artikel handelt von einem praktischen Tool zum Vergleichen von Sitzungen zur Erstellung von PHP-Code-Profilen, mit dem Engp√§sse im Projekt auf CMS Bitrix schnell festgestellt werden konnten. </p><a name="habracut"></a><br><h2 id="iz-daleka">  Aus der Ferne </h2><br><p>  Im Juli wurde Bitrix zu diesem Zeitpunkt auf die neueste Version aktualisiert ... Und die Seitenladegeschwindigkeit sank: irgendwo um 20%, irgendwo um 300 +%.  Besonders in der Phase der Kundenbestellung. </p><br><p>  Die Zahlen sind beeindruckend und traurig.  Warum aktualisiert? </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/b06/a95/419/b06a95419ddf005efa67abf943d51c28.png" alt="N | Feststoff"></p><br><p> Das hei√üt  Es bestand die Gefahr, dass wir, wenn wir nicht aktualisierten, zwei Probleme auf einmal l√∂sen m√ºssten: das tats√§chliche Aktualisieren von Bitrix und das Aktualisieren unserer Codebasis auf PHP&gt; 7.1. </p><br><h2 id="prichina-tormozov">  Grund f√ºr die Bremsen </h2><br><p>  Wie sich herausstellte, ist der Grund f√ºr die gr√∂√üten Bremsen die neue Codelogik f√ºr die Arbeit mit Lieferprofilen.  Gem√§√ü dem Code haben sie es korrekter gemacht, oder so etwas: Sendungen wurden als separate Einheiten angezeigt.  Jetzt kann die Bestellung in mehreren Sendungen versendet werden (mit eigenen Merkmalen in Bezug auf Kosten, Versandart und Zusammensetzung der Ware). </p><br><p>  Das √úbermittlungsprofil ist jetzt jedoch ein separater Eintrag in der Datenbank mit den Einschr√§nkungen des Bitrix-Kernels, der jedes Mal angezeigt wird, wenn Sie bei einer Bestellung die M√∂glichkeit pr√ºfen, dieses Profil anzuzeigen. </p><br><p>  Im Allgemeinen konzentriert sich der Artikel nicht darauf, was genau √ºberarbeitet wurde, um mit den Bremsen fertig zu werden, sondern auf ein Tool, mit dem Engp√§sse im Code schnell gefunden und behoben werden k√∂nnen. </p><br><h2 id="xhprof-admin">  XHProf Admin </h2><br><p>  Zu unserer Verf√ºgung stand ein beliebter Profiler von Facebook - XHProf.  Die Nachteile, die den Betrieb des Tools behindern, beziehen sich auf die GUI: </p><br><ul><li>  Keine klare Navigation zwischen den Profilierungssitzungen </li><li>  Es k√∂nnen nicht mehr als zwei Sitzungen gleichzeitig au√üerhalb desselben Namespaces verglichen werden. </li><li>  Sie k√∂nnen sie in der Sitzungsliste nicht kommentieren.  Nach der zehnten Sitzung vergessen Sie bereits, mit welchen √Ñnderungen die vorherigen Profilerstellungsergebnisse zusammenh√§ngen. </li></ul><br><p>  Infolgedessen wurde unter Ber√ºcksichtigung der SOURCES der nativen XHProf-GUI und ein wenig entsetzt eine neue GUI daf√ºr geschrieben, die die oben genannten Nachteile abdeckt. </p><br><h2 id="ustanovka">  Installation </h2><br><p>  ‚Üí <a href="https://github.com/SergeyRock/xhprof-admin" rel="nofollow">Link zum Projekt</a> </p><br><p>  Ich werde nicht beschreiben, wie man XHProf und Profile installiert, es gibt zumindest einige gute Tutorials auf dem Habr√©. </p><br><p>  Um XHProf Admin zu installieren, legen Sie den Ordner xhprof_admin im Ordner xhprof_html des nativen XHProf ab.  Oder klonen Sie das gesamte Projekt (es enth√§lt bereits sowohl XHProf als auch die neue GUI). </p><br><p>  √ñffnen Sie dann die Seite &lt;Pfad zu xhprof&gt; / xhprof_html / xhprof_admin / <br>  Wenn die Zuordnung aktiviert ist, wie in der Dokumentation empfohlen, m√ºssen Sie &lt;Pfad zu xhprof&gt; / xhprof_admin / √∂ffnen. </p><br><h2 id="glavnaya--stranica">  Hauptseite </h2><br><p><img src="https://habrastorage.org/getpro/habr/post_images/2ad/de6/6e6/2adde66e6ba9b0ca7b8b2f3e74038c3c.png" alt="N"></p><br><p>  Enth√§lt: </p><br><ul><li>  Listet alle Profilerstellungssitzungen nach Datum sortiert auf </li><li>  Felder f√ºr Sitzungskommentare </li><li>  Dohlen, mit denen Sie Sitzungen zum L√∂schen, Vergleichen und Zusammenfassen ausw√§hlen k√∂nnen </li><li>  Link zu einem neuen Bericht </li><li>  Links zu nativem Bericht und Callgraph </li><li>  Sitzungsgewichtungsfelder f√ºr Diff und Aggregat </li><li>  Ein Feld, das die Reihenfolge angibt, in der Sitzungen im Vergleichsmodus und im Diff-Modus angezeigt werden </li><li>  Schaltfl√§chen: <br><ul><li>  Vergleichen - vergleicht ausgew√§hlte Sitzungen (neuer Bericht) </li><li>  Diff - Ein Standardbericht zum Vergleichen von Sitzungen in einem Namespace </li><li>  Aggregat - Standardbericht mit Sitzungsaggregation in einem Namespace </li><li>  Benutzerdefinierte Kommentare speichern - speichert den Kommentar f√ºr die Sitzung (in einer separaten Datei) </li><li>  Ausgew√§hlte L√§ufe l√∂schen - l√∂scht Sitzungs- und Kommentardateien </li><li>  Link zur nativen Sitzungsliste </li></ul></li></ul><br><p>  Originalbericht anzeigen, Diff-L√§ufe, Aggregierte L√§ufe, Callgraph-native Funktionen der XHProf-Benutzeroberfl√§che anzeigen - ich werde sie nicht beschreiben.  Ich kann nur sagen, dass Sie mit XHProf Admin bequem zu ihnen navigieren k√∂nnen, anstatt Links manuell zu kompilieren. </p><br><h2 id="compare-runs">  L√§ufe vergleichen </h2><br><p><img src="https://habrastorage.org/getpro/habr/post_images/70e/4d2/1ca/70e4d21caaf3a804af695716c673a179.png" alt="N | Feststoff"></p><br><p>  Ein neuer Bericht, mit dem Sie das Wachstum oder den R√ºckgang der Produktivit√§t schnell bewerten k√∂nnen. <br>  Um es zu benutzen, auf der Hauptseite: </p><br><ul><li>  W√§hlen Sie die Sitzungen aus, die wir vergleichen m√∂chten. </li><li>  Wir legen das Sortierfeld "Sortieren" fest, um die Reihenfolge zu bestimmen, in der Sitzungen angezeigt werden: Je kleiner der Wert des Feldes, desto fr√ºher wird die Sitzung angezeigt.  Die allererste Sitzung wird als Basissitzung genommen - alle nachfolgenden Sitzungen werden damit verglichen. </li><li>  Wenn wir die Durchschnittswerte von Metriken anzeigen m√∂chten, markieren Sie "show average". </li><li>  Klicken Sie auf "Vergleichen". <br><img src="https://habrastorage.org/getpro/habr/post_images/28d/452/9f2/28d4529f2011bd7df9a57b2ac1f90641.png" alt="N | Feststoff"></li></ul><br><p>  Der Bericht zeigt nicht die% an, die die Funktion f√ºr jede Metrik belegt, um die Seite nicht zu √ºberladen, sondern um absolute Werte anzuzeigen.  Wenn in der Metrik f√ºr die Funktion, die zwischen der Basissitzung und der folgenden profiliert wird, ein Unterschied von mehr als 1% besteht, wird dies deutlich angezeigt: Gr√ºn bedeutet eine Verbesserung, Rot bedeutet eine Regression. </p><br><p>  Default: </p><br><ul><li>  Der Bericht zeigt die ersten 100 Funktionen an.  Wenn Sie mehr ben√∂tigen, klicken Sie auf "Alle anzeigen". </li><li>  Die Daten sind sortiert nach der Angabe ‚ÄûInkl.  Wall Time (microsec) ‚Äù, aber Sie k√∂nnen auf eine Metrik klicken und danach sortieren. </li></ul><br><p>  Um eine Sitzung aus dem Bericht auszuschlie√üen, klicken Sie auf "Ausschlie√üen". </p><br><p>  Es ist eine Sortierung nach jeder Metrik m√∂glich - klicken Sie einfach auf die Spalten√ºberschrift. </p><br><p>  Um die Durchschnittswerte f√ºr alle ausgew√§hlten Sitzungen anzuzeigen, klicken Sie auf ‚ÄûDurchschnittswerte anzeigen‚Äú. </p><br><p>  F√ºr einen Drilldown zu einer Funktion k√∂nnen Sie auf eine Zelle am Schnittpunkt von Funktion und Metrik mit der angezeigten Sitzung klicken. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/1cf/114/e12/1cf114e12049d9514d052240e6e0dc27.png" alt="N | Feststoff"></p><br><h1 id="primer-ispolzovaniya">  Anwendungsbeispiel </h1><br><ol><li>  Wir haben den Profiler im Quellcode gestartet.  Wir haben die Sitzungsliste ge√∂ffnet und einen Kommentar hinzugef√ºgt. </li><li>  Wir haben den Profiler f√ºr den verbesserten Code gestartet.  F√ºgte auch einen Kommentar hinzu. </li><li>  Habe Punkt 2 mehrmals gemacht. </li><li>  Dann √∂ffneten wir die Liste der Profilerstellungssitzungen, w√§hlten nacheinander alle Sitzungen aus und klickten auf Vergleichen. </li><li>  Wir haben uns die √Ñnderungen angesehen. </li><li>  Sie entschieden, was sie sonst noch beschleunigen sollten. </li></ol><br><p>  <a href="https://github.com/SergeyRock/xhprof-admin" rel="nofollow">Mit XHProf Admin</a> k√∂nnen h√§ufig verwendete Funktionen, die von einem einzelnen Benutzer ausgef√ºhrt werden, bequem identifiziert werden.  Beispielsweise werden in Bitrix beim Aufgeben einer Bestellung beim Wechsel von einer Phase zur anderen (Lieferung, Zahlung, Kontakte usw.) jedes Mal mehrere Funktionen aufgerufen, um die Integrit√§t des Warenkorbs usw. zu √ºberpr√ºfen. Diese Phasen werden separat profiliert und dann im Bericht zusammen angezeigt Vergleichen Sie.  Die Ergebnisse dieser Funktionen k√∂nnen zwischengespeichert werden, was die √úbergangszeit von Stufe zu Stufe erheblich beschleunigt. </p><br><h1 id="itog">  Zusammenfassung </h1><br><p>  Infolgedessen haben wir den Geschwindigkeitsverlust in den Phasen der Auftragserteilung bei der Aktualisierung von Bitrix ausgeglichen und gleichzeitig andere Bereiche der Website analysiert und beschleunigt. <br>  Von Zeit zu Zeit verwenden wir XHProf Admin f√ºr Projekte als intuitivere Benutzeroberfl√§che. <br>  Dokumentationslink zu XHProf Admin: <a href="" rel="nofollow">go</a> </p><br><p>  Wer sich f√ºr das Thema Codeoptimierung und Tools daf√ºr interessiert, schreibt in die Kommentare. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de478858/">https://habr.com/ru/post/de478858/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de478848/index.html">Die Evolution der digitalen Fotografie</a></li>
<li><a href="../de478850/index.html">CSS Grid Naming</a></li>
<li><a href="../de478852/index.html">Einf√ºhrung in GitOps f√ºr OpenShift</a></li>
<li><a href="../de478854/index.html">Der Kampf der Webserver. Teil 1 - HTTP von der Realit√§t getrennt:</a></li>
<li><a href="../de478856/index.html">SD-WAN - aktuelle Trends und Prognosen f√ºr 2020</a></li>
<li><a href="../de478862/index.html">Wie ist der Frontend-Test in Yandex.Market aufgebaut und warum lehnen wir w√∂chentliche Releases ab?</a></li>
<li><a href="../de478866/index.html">Meet Space - Neues Produkt von JetBrains</a></li>
<li><a href="../de478872/index.html">DIY: Wie wir die Lager√ºberwachung automatisieren</a></li>
<li><a href="../de478874/index.html">Toshiba hat zwei neue Festplattenreihen mit einer Kapazit√§t von bis zu 6 TB angek√ºndigt und seine Ausrichtung auf das Unternehmenssegment seit 2020 angek√ºndigt</a></li>
<li><a href="../de478878/index.html">Das beliebteste St√ºck Code in der Geschichte von StackOverflow hat einen Fehler!</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>