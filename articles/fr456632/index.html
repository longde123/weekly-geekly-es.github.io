<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚úçüèæ üåõ üéº Nous construisons le quatri√®me √©tage des mod√®les C ++ dans RESTinio. Pourquoi et comment? üè¢ üë©‚Äç‚ù§Ô∏è‚Äçüë® üí™</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="RESTinio est un projet relativement petit, qui est un serveur HTTP asynchrone int√©gr√© aux applications C ++. Sa caract√©ristique est l'utilisation r√©pa...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Nous construisons le quatri√®me √©tage des mod√®les C ++ dans RESTinio. Pourquoi et comment?</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/456632/"><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">RESTinio</a> est un projet relativement petit, qui est un serveur HTTP asynchrone int√©gr√© aux applications C ++.  Sa caract√©ristique est l'utilisation r√©pandue, pourrait-on dire, des mod√®les C ++.  Tant dans l'impl√©mentation que dans l'API publique. </p><br><p>  Les mod√®les C ++ dans RESTinio sont utilis√©s si activement que le premier article qui parlait de RESTinio sur Habr s'appelait " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Mod√®les C ++ √† trois √©tages dans la mise en ≈ìuvre d'un serveur HTTP asynchrone int√©gr√© √† visage humain</a> ". </p><br><p>  Mod√®les √† trois √©tages.  Et cela, en g√©n√©ral, n'√©tait pas une figure de style. </p><br><p>  Et r√©cemment, nous avons √† nouveau mis √† jour RESTinio, et pour ajouter de nouvelles fonctionnalit√©s √† la version 0.5.1, nous avons d√ª augmenter encore le "nombre d'√©tages" des mod√®les.  Donc, par endroits, les mod√®les C ++ dans RESTinio sont d√©j√† √† quatre √©tages. </p><br><p><img src="https://habrastorage.org/webt/vz/t3/vw/vzt3vwbp8snyu3y7hhrcr6crela.jpeg"></p><br><p>  Et si quelqu'un se demande pourquoi nous en avions besoin et comment nous avons utilis√© les mod√®les, alors restez avec nous, il y aura quelques d√©tails sous la coupe.  Les gourous inv√©t√©r√©s du C ++ ne trouveront probablement rien de nouveau pour eux-m√™mes, mais les surnoms C ++ moins avanc√©s pourront voir comment les mod√®les sont utilis√©s pour ins√©rer / supprimer des fonctionnalit√©s.  Presque √† l'√©tat sauvage. </p><a name="habracut"></a><br><h1 id="slushatel-sostoyaniya-podklyucheniy">  √âcouteur d'√©tat de connexion </h1><br><p>  La principale fonctionnalit√© pour laquelle la version 0.5.1 a √©t√© cr√©√©e est la possibilit√© d'informer l'utilisateur que l'√©tat de la connexion au serveur HTTP a chang√©.  Par exemple, le client est "tomb√©" et il n'a donc pas √©t√© n√©cessaire de traiter les demandes de ce client qui sont toujours en attente. </p><br><p>  On nous a parfois pos√© des questions sur cette fonctionnalit√© et maintenant nos mains ont atteint sa mise en ≈ìuvre.  Mais depuis  tout le monde n'a pas pos√© de questions sur cette fonctionnalit√©, on a pens√© qu'elle devrait √™tre facultative: si un utilisateur en a besoin, alors laissez-la l'inclure explicitement, et tout le reste ne devrait rien payer pour son existence dans RESTinio. </p><br><p>  Et comme les principales caract√©ristiques du serveur HTTP dans RESTinio sont d√©finies via des "traits", il a √©t√© d√©cid√© d'activer / d√©sactiver l'√©coute sur l'√©tat des connexions via les propri√©t√©s du serveur. </p><br><h2 id="kak-polzovatel-zadaet-sobstvennogo-slushatelya-sostoyaniya-podklyucheniy">  Comment un utilisateur d√©finit-il son propre √©couteur pour l'√©tat de la connexion? </h2><br><p>  Afin de d√©finir votre <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">√©couteur pour l'√©tat des connexions, l'</a> utilisateur doit effectuer trois √©tapes. </p><br><p>  √âtape # 1: d√©finissez votre propre classe, qui devrait avoir une m√©thode state_changed non statique de la forme suivante: </p><br><pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">state_changed</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> restinio::connection_state::</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">notice_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> &amp; notice)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">noexcept</span></span></span></span>;</code> </pre> <br><p>  Par exemple, cela pourrait √™tre quelque chose comme: </p><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">my_state_listener</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::mutex lock_; ... <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">state_changed</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> restinio::connection_state::</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">notice_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> &amp; notice)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">noexcept</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::lock_guard&lt;<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::mutex&gt; l{lock_}; .... } ... };</code> </pre> <br><p>  √âtape # 2: √† l'int√©rieur des propri√©t√©s du serveur, vous devez d√©finir un typedef appel√© <code>connection_state_listener_t</code> , qui devrait faire r√©f√©rence au nom du type cr√©√© √† l'√©tape # 1: </p><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">my_traits</span></span></span><span class="hljs-class"> :</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> restinio::<span class="hljs-keyword"><span class="hljs-keyword">default_traits_t</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">connection_state_listener_t</span></span> = my_state_listener; };</code> </pre> <br><p>  Par cons√©quent, ces propri√©t√©s doivent √™tre utilis√©es lors du d√©marrage du serveur HTTP: </p><br><pre> <code class="cpp hljs">restinio::run(restinio::on_thread_pool&lt;my_traits&gt;(<span class="hljs-number"><span class="hljs-number">8</span></span>)...);</code> </pre> <br><p>  √âtape # 3: l'utilisateur doit cr√©er une instance de son √©couteur et passer ce pointeur via shared_ptr dans les param√®tres du serveur: </p><br><pre> <code class="cpp hljs">restinio::run( restinio::on_thread_pool&lt;my_traits&gt;(<span class="hljs-number"><span class="hljs-number">8</span></span>) .port(<span class="hljs-number"><span class="hljs-number">8080</span></span>) .address(<span class="hljs-string"><span class="hljs-string">"localhost"</span></span>) .request_handler(...) .connection_state_listener(<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::make_shared&lt;my_state_listener&gt;(...)) ) );</code> </pre> <br><p>  Si l'utilisateur n'appelle pas la m√©thode <code>connection_state_listener</code> , une exception sera lev√©e lors du d√©marrage du serveur HTTP: le nord ne peut pas fonctionner si l'utilisateur veut utiliser l'√©couteur d'√©tat mais ne sp√©cifie pas cet √©couteur. </p><br><h3 id="a-esli-ne-zadavat-connection_state_listener_t">  Et si vous ne d√©finissez pas connection_state_listener_t? </h3><br><p>  Si l'utilisateur d√©finit le nom <code>connection_state_listener_t</code> dans les propri√©t√©s du serveur, il doit alors appeler la m√©thode <code>connection_state_listener</code> pour d√©finir les param√®tres du serveur.  Mais si l'utilisateur ne sp√©cifie pas <code>connection_state_listener_t</code> ? </p><br><p>  Dans ce cas, le nom <code>connection_state_listener_t</code> sera toujours pr√©sent dans les propri√©t√©s du serveur, mais ce nom pointera vers le type sp√©cial <code>restinio::connection_state::noop_listener_t</code> . </p><br><p>  En fait, ce qui suit se produit: dans RESTinio, lors de la d√©finition de traits r√©guliers, la valeur <code>connection_state_listener_t</code> est d√©finie.  Quelque chose comme: </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> restinio { <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">default_traits_t</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">time_manager_t</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">asio_time_manager_t</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">logger_t</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">null_logger_t</span></span>; ... <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">connection_state_listener_t</span></span> = connection_state::<span class="hljs-keyword"><span class="hljs-keyword">noop_listener_t</span></span>; }; } <span class="hljs-comment"><span class="hljs-comment">/* namespace restinio */</span></span></code> </pre> <br><p>  Et lorsque l'utilisateur h√©rite de <code>restinio::default_traits_t</code> , la d√©finition standard de <code>connection_state_listener_t</code> est √©galement h√©rit√©e.  Mais si le nouveau nom <code>connection_state_listener_t</code> d√©fini dans la classe successeur: </p><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">my_traits</span></span></span><span class="hljs-class"> :</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> restinio::<span class="hljs-keyword"><span class="hljs-keyword">default_traits_t</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">connection_state_listener_t</span></span> = my_state_listener; ... };</code> </pre> <br><p>  puis le nouveau nom masque la d√©finition h√©rit√©e de <code>connection_state_listener_t</code> .  Et s'il n'y a pas de nouvelle d√©finition, l'ancienne d√©finition reste visible. </p><br><p>  Donc, si l'utilisateur ne d√©finit pas sa propre valeur pour <code>connection_state_listener_t</code> , alors RESTinio utilisera la valeur par d√©faut, <code>noop_listener_t</code> , qui est trait√©e par RESTinio d'une mani√®re sp√©ciale.  Par exemple: </p><br><ul><li>  RESTinio ne stocke pas du tout shared_ptr dans ce cas pour <code>connection_state_listener_t</code> .  Et, en cons√©quence, un appel √† la m√©thode <code>connection_state_listener</code> est interdit (un tel appel entra√Ænera une erreur de compilation); </li><li>  RESTinio ne fait aucun appel suppl√©mentaire li√© √† la modification de l'√©tat de la connexion. </li></ul><br><p>  Et √† peu pr√®s comment tout cela est r√©alis√© et sera discut√© ci-dessous. </p><br><h2 id="kak-eto-realizovano-v-restinio">  Comment est-ce impl√©ment√© dans RESTinio? </h2><br><p>  Ainsi, dans le code RESTinio, vous devez v√©rifier la valeur de la d√©finition de <code>connection_state_listener_t</code> dans les propri√©t√©s du serveur et, en fonction de cette valeur: </p><br><ul><li>  stocker ou ne pas stocker l'instance shared_ptr pour un objet de type <code>connecton_state_listener_t</code> ; </li><li>  autoriser ou interdire les appels aux m√©thodes <code>connection_state_listener</code> pour d√©finir les param√®tres du serveur HTTP; </li><li>  v√©rifier ou non la pr√©sence d'un pointeur en cours sur un objet de type <code>connection_state_listener_t</code> avant de d√©marrer le fonctionnement du serveur HTTP; </li><li>  effectuer ou non des appels √† la m√©thode <code>state_changed</code> lorsque l'√©tat de la connexion au client change. </li></ul><br><p>  Il est √©galement ajout√© aux conditions aux limites que RESTinio d√©veloppe toujours en tant que biblioth√®que pour C ++ 14, par cons√©quent, vous ne pouvez pas utiliser les capacit√©s de C ++ 17 dans l'impl√©mentation (la m√™me chose si constexpr). </p><br><p>  Tout cela est impl√©ment√© √† travers des astuces simples: les classes de mod√®les et leurs sp√©cialisations pour le type <code>restinio::connection_state::noop_listener_t</code> .  Par exemple, voici comment le stockage shared_ptr est effectu√© pour un objet de type <code>connection_state_listener_t</code> dans les param√®tres du serveur.  Premi√®re partie: </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt; <span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> Listener &gt; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">connection_state_listener_holder_t</span></span></span><span class="hljs-class"> {</span></span> ... <span class="hljs-comment"><span class="hljs-comment">//  compile-time . std::shared_ptr&lt; Listener &gt; m_connection_state_listener; static constexpr bool has_actual_connection_state_listener = true; void check_valid_connection_state_listener_pointer() const { if( !m_connection_state_listener ) throw exception_t{ "connection state listener is not specified" }; } }; template&lt;&gt; struct connection_state_listener_holder_t&lt; connection_state::noop_listener_t &gt; { static constexpr bool has_actual_connection_state_listener = false; void check_valid_connection_state_listener_pointer() const { // Nothing to do. } };</span></span></code> </pre> <br><p>  Une structure de mod√®le est d√©finie ici qui a un contenu utile ou non.  Juste pour le type <code>noop_listener_t</code> , il n'a pas de contenu utile. </p><br><p>  Et la deuxi√®me partie: </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> Derived, <span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> Traits&gt; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">basic_server_settings_t</span></span></span><span class="hljs-class"> :</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">socket_type_dependent_settings_t</span></span>&lt; Derived, <span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> Traits::<span class="hljs-keyword"><span class="hljs-keyword">stream_socket_t</span></span> &gt; , <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">connection_state_listener_holder_t</span></span>&lt; <span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> Traits::<span class="hljs-keyword"><span class="hljs-keyword">connection_state_listener_t</span></span> &gt; , <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ip_blocker_holder_t</span></span>&lt; <span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> Traits::<span class="hljs-keyword"><span class="hljs-keyword">ip_blocker_t</span></span> &gt; { ... };</code> </pre> <br><p>  La classe qui contient les param√®tres du serveur HTTP est h√©rit√©e de <code>connection_state_listener_holder_t</code> .  Ainsi, les param√®tres du serveur affichent shared_ptr pour un objet de type <code>connection_state_listener_t</code> , ou ce n'est pas le cas. </p><br><p>  Je dois dire que stocker ou ne pas stocker shared_ptr dans les param√®tres sont des fleurs.  Mais les baies sont all√©es en essayant de rendre les m√©thodes destin√©es √† travailler avec l'√©couteur d'√©tat dans <code>basic_server_settings_t</code> disponibles uniquement si <code>connection_state_listener_t</code> est diff√©rent de <code>noop_listener_t</code> . </p><br><p>  Id√©alement, je voulais que le compilateur ¬´ne les voie pas¬ª du tout.  Mais j'ai √©t√© tortur√© d'√©crire des conditions pour <code>std::enable_if</code> afin de cacher ces m√©thodes.  Par cons√©quent, il √©tait simplement limit√© √† l'ajout de static_asser: </p><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">Derived &amp; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">connection_state_listener</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( </span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">std</span></span></span></span><span class="hljs-function"><span class="hljs-params">::</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">shared_ptr</span></span></span></span><span class="hljs-function"><span class="hljs-params">&lt; </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">typename</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Traits::</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">connection_state_listener_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> &gt; listener )</span></span></span><span class="hljs-function"> &amp; </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">static_assert</span></span>( has_actual_connection_state_listener, <span class="hljs-string"><span class="hljs-string">"connection_state_listener(listener) can't be used "</span></span> <span class="hljs-string"><span class="hljs-string">"for the default connection_state::noop_listener_t"</span></span> ); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>-&gt;m_connection_state_listener = <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::move(listener); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> reference_to_derived(); } <span class="hljs-function"><span class="hljs-function">Derived &amp;&amp; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">connection_state_listener</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( </span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">std</span></span></span></span><span class="hljs-function"><span class="hljs-params">::</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">shared_ptr</span></span></span></span><span class="hljs-function"><span class="hljs-params">&lt; </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">typename</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Traits::</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">connection_state_listener_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> &gt; listener )</span></span></span><span class="hljs-function"> &amp;&amp; </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::move(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>-&gt;connection_state_listener(<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::move(listener))); } <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">shared_ptr</span></span>&lt; <span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> Traits::<span class="hljs-keyword"><span class="hljs-keyword">connection_state_listener_t</span></span> &gt; &amp; connection_state_listener() <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">noexcept</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">static_assert</span></span>( has_actual_connection_state_listener, <span class="hljs-string"><span class="hljs-string">"connection_state_listener() can't be used "</span></span> <span class="hljs-string"><span class="hljs-string">"for the default connection_state::noop_listener_t"</span></span> ); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>-&gt;m_connection_state_listener; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ensure_valid_connection_state_listener</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>-&gt;check_valid_connection_state_listener_pointer(); }</code> </pre> <br><p>  Il y a eu juste un autre moment o√π j'ai <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">regrett√© qu'en C ++ si constexpr n'est pas la m√™me chose que statique si en D.</a>  Et en g√©n√©ral en C ++ 14 il n'y a rien de similaire :( </p><br><p>  Ici, vous pouvez √©galement voir la disponibilit√© de la m√©thode <code>ensure_valid_connection_state_listener</code> .  Cette m√©thode est appel√©e dans le constructeur <code>http_server_t</code> pour v√©rifier que les param√®tres du serveur contiennent toutes les valeurs n√©cessaires: </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> D&gt; <span class="hljs-keyword"><span class="hljs-keyword">http_server_t</span></span>( <span class="hljs-keyword"><span class="hljs-keyword">io_context_holder_t</span></span> io_context, <span class="hljs-keyword"><span class="hljs-keyword">basic_server_settings_t</span></span>&lt; D, Traits &gt; &amp;&amp; settings ) : m_io_context{ io_context.giveaway_context() } , m_cleanup_functor{ settings.giveaway_cleanup_func() } { <span class="hljs-comment"><span class="hljs-comment">// Since v.0.5.1 the presence of custom connection state // listener should be checked before the start of HTTP server. settings.ensure_valid_connection_state_listener(); ...</span></span></code> </pre> <br><p>  Dans le m√™me temps, √† l'int√©rieur de la <code>ensure_valid_connection_state_listener</code> m√©thode <code>ensure_valid_connection_state_listener</code> h√©rit√©e de <code>connection_state_listener_holder_t</code> est <code>check_valid_connection_state_listener_pointer</code> , ce qui, en raison de la sp√©cialisation <code>connection_state_listener_holder_t</code> , effectue une v√©rification r√©elle ou ne fait rien. </p><br><p>  Des astuces similaires ont √©t√© utilis√©es pour appeler le <code>state_changed</code> actuel si l'utilisateur voulait utiliser l'√©couteur d'√©tat, ou pour ne rien appeler autrement. </p><br><p>  Tout d'abord, nous avons besoin d'une autre option <code>state_listener_holder_t</code> : </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> connection_settings_details { <span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt; <span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> Listener &gt; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">state_listener_holder_t</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">shared_ptr</span></span>&lt; Listener &gt; m_connection_state_listener; <span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt; <span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> Settings &gt; <span class="hljs-keyword"><span class="hljs-keyword">state_listener_holder_t</span></span>( <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> Settings &amp; settings ) : m_connection_state_listener{ settings.connection_state_listener() } {} <span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt; <span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> Lambda &gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">call_state_listener</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( Lambda &amp;&amp; lambda )</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">noexcept</span></span></span><span class="hljs-function"> </span></span>{ m_connection_state_listener-&gt;state_changed( lambda() ); } }; <span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;&gt; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">state_listener_holder_t</span></span></span><span class="hljs-class">&lt; connection_state::noop_listener_t &gt; {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt; <span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> Settings &gt; <span class="hljs-keyword"><span class="hljs-keyword">state_listener_holder_t</span></span>( <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> Settings &amp; ) { <span class="hljs-comment"><span class="hljs-comment">/* nothing to do */</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt; <span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> Lambda &gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">call_state_listener</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( Lambda &amp;&amp; </span></span><span class="hljs-comment"><span class="hljs-function"><span class="hljs-params"><span class="hljs-comment">/*lambda*/</span></span></span></span><span class="hljs-function"><span class="hljs-params"> )</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">noexcept</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/* nothing to do */</span></span> } }; } <span class="hljs-comment"><span class="hljs-comment">/* namespace connection_settings_details */</span></span></code> </pre> <br><p>  Contrairement √† <code>connection_state_listener_holder_t</code> , qui a √©t√© montr√© pr√©c√©demment et qui a √©t√© utilis√© pour stocker l'√©couteur d'√©tat de connexion dans les param√®tres de l'ensemble du serveur (c'est-√†-dire, dans des objets de type <code>basic_server_settings_t</code> ), cet <code>state_listener_holder_t</code> sera utilis√© √† des fins similaires, mais pas dans les param√®tres de l'ensemble du serveur, mais d'un serveur s√©par√© connexion: </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span> &lt; <span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> Traits &gt; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">connection_settings_t</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">final</span></span></span><span class="hljs-class"> :</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::enable_shared_from_this&lt; <span class="hljs-keyword"><span class="hljs-keyword">connection_settings_t</span></span>&lt; Traits &gt; &gt; , <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> connection_settings_details::<span class="hljs-keyword"><span class="hljs-keyword">state_listener_holder_t</span></span>&lt; <span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> Traits::<span class="hljs-keyword"><span class="hljs-keyword">connection_state_listener_t</span></span> &gt; { <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">connection_state_listener_holder_t</span></span> = connection_settings_details::<span class="hljs-keyword"><span class="hljs-keyword">state_listener_holder_t</span></span>&lt; <span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> Traits::<span class="hljs-keyword"><span class="hljs-keyword">connection_state_listener_t</span></span> &gt;; ...</code> </pre> <br><p>  Il y a deux fonctionnalit√©s ici. </p><br><p>  Tout d'abord, initialiser <code>state_listener_holder_t</code> .  Il est n√©cessaire ou non.  Mais seul <code>state_listener_holder_t</code> sait.  Par cons√©quent, le constructeur <code>connection_settings_t</code> ¬´tire¬ª simplement le constructeur <code>state_listener_holder_t</code> , comme on dit, juste au cas o√π: </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span> &lt; <span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> Settings &gt; <span class="hljs-keyword"><span class="hljs-keyword">connection_settings_t</span></span>( Settings &amp;&amp; settings, http_parser_settings parser_settings, <span class="hljs-keyword"><span class="hljs-keyword">timer_manager_handle_t</span></span> timer_manager ) : <span class="hljs-keyword"><span class="hljs-keyword">connection_state_listener_holder_t</span></span>{ settings } , m_request_handler{ settings.request_handler() }</code> </pre> <br><p>  Et le constructeur <code>state_listener_holder_t</code> effectue les actions n√©cessaires ou ne fait rien du tout (dans ce dernier cas, le compilateur plus ou moins sensible ne g√©n√©rera aucun code pour initialiser <code>state_listener_holder_t</code> ). </p><br><p>  Deuxi√®mement, c'est la <code>state_listner_holder_t::call_state_listener</code> , qui effectue l'appel <code>state_changed</code> √† l'√©couteur d'√©tat.  Ou pas, s'il n'y a pas d'auditeur d'√©tat.  Ce <code>call_state_listener</code> aux endroits o√π RESTinio diagnostique un changement d'√©tat de connexion.  Par exemple, lorsqu'il est d√©tect√© que la connexion a √©t√© ferm√©e: </p><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">close</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ m_logger.trace( [&amp;]{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> fmt::format( <span class="hljs-string"><span class="hljs-string">"[connection:{}] close"</span></span>, connection_id() ); } ); ... <span class="hljs-comment"><span class="hljs-comment">// Inform state listener if it used. m_settings-&gt;call_state_listener( [this]() noexcept { return connection_state::notice_t{ this-&gt;connection_id(), this-&gt;m_remote_endpoint, connection_state::cause_t::closed }; } ); }</span></span></code> </pre> <br><p>  Un <code>call_state_listener</code> est transmis √† <code>call_state_listener</code> , √† partir duquel un objet <code>notice_t</code> avec des informations sur l'√©tat de la connexion est renvoy√©.  S'il y a un √©couteur r√©el, alors ce lambda sera en effet appel√©, et la valeur retourn√©e par lui sera pass√©e √† <code>state_changed</code> . </p><br><p>  Cependant, s'il n'y a pas d'√©couteur, alors <code>call_state_listener</code> sera vide et, par cons√©quent, aucun lambda ne sera appel√©.  En fait, le compilateur normal envoie simplement tous les appels √† un <code>call_state_listener</code> vide.  Et dans ce cas, dans le code g√©n√©r√©, il n'y aura rien du tout li√© √† l'√©tat de connexion auquel l'auditeur acc√®de. </p><br><h1 id="esche-i-ip-blocker">  √âgalement bloqueur IP </h1><br><p>  Dans RESTinio-0.5.1, en plus de l'√©couteur d'√©tat de connexion, une chose telle qu'un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">bloqueur IP a</a> √©t√© ajout√©e.  C'est-√†-dire  l'utilisateur peut sp√©cifier un objet que RESTinio ¬´tirera¬ª pour chaque nouvelle connexion entrante.  Si le bloqueur IP dit que vous pouvez travailler avec la connexion, alors RESTinio d√©marre la maintenance habituelle de la nouvelle connexion (il lit et analyse la demande, appelle le gestionnaire de demandes, contr√¥le les d√©lais, etc.).  Mais si le bloqueur IP interdit de travailler avec la connexion, alors RESTinio ferme b√™tement cette connexion et ne fait plus rien avec elle. </p><br><p>  Comme l'√©couteur d'√©tat, le bloqueur IP est une fonctionnalit√© facultative.  Pour utiliser le bloqueur IP, vous devez l'activer explicitement.  Gr√¢ce aux propri√©t√©s du serveur HTTP.  Tout comme avec l'√©couteur d'√©tat de connexion.  Et l'impl√©mentation de la prise en charge du bloqueur IP dans RESTinio utilise les m√™mes techniques qui ont d√©j√† √©t√© d√©crites ci-dessus.  Par cons√©quent, nous ne nous attarderons pas sur la fa√ßon dont le bloqueur IP est utilis√© dans RESTinio.  Prenons plut√¥t un exemple dans lequel le bloqueur IP et l'√©couteur d'√©tat sont le m√™me objet. </p><br><h2 id="razbor-shtatnogo-primera-ip_blocker">  Analyse de l'exemple standard ip_blocker </h2><br><p>  Dans la version 0.5.1, un autre exemple est inclus dans les exemples RESTinio standard: <a href="">ip_blocker</a> .  Cet exemple montre comment vous pouvez limiter le nombre de connexions simultan√©es au serveur √† partir d'une seule adresse IP. </p><br><p>  Cela n√©cessitera non seulement un bloqueur IP, qui permettra ou interdira l'acceptation des connexions.  Mais aussi un √©couteur pour l'√©tat de la connexion.  Un √©couteur est n√©cessaire pour suivre les moments de cr√©ation et de fermeture de connexions. </p><br><p>  En m√™me temps, le bloqueur IP et l'auditeur auront besoin du m√™me ensemble de donn√©es.  Par cons√©quent, la solution la plus simple consiste √† faire du bloqueur IP et de l'√©couteur le m√™me objet. </p><br><p>  Pas de probl√®me, nous pouvons facilement le faire: </p><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">blocker_t</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::mutex m_lock; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">connections_t</span></span> = <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">map</span></span>&lt; restinio::asio_ns::ip::address, <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">vector</span></span>&lt; restinio::<span class="hljs-keyword"><span class="hljs-keyword">connection_id_t</span></span> &gt; &gt;; <span class="hljs-keyword"><span class="hljs-keyword">connections_t</span></span> m_connections; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>: <span class="hljs-comment"><span class="hljs-comment">//   IP-blocker-. restinio::ip_blocker::inspection_result_t inspect( const restinio::ip_blocker::incoming_info_t &amp; info ) noexcept {...} //     . void state_changed( const restinio::connection_state::notice_t &amp; notice ) noexcept {...} };</span></span></code> </pre> <br><p>  Ici, nous n'avons aucun h√©ritage d'aucune interface ni substitution de m√©thodes virtuelles h√©rit√©es.  La seule condition requise pour l'√©couteur est la pr√©sence de la m√©thode <code>state_changed</code> .  Cette exigence est satisfaite. </p><br><p>  De m√™me, avec la seule exigence pour un bloqueur IP: existe-t-il une m√©thode d' <code>inspect</code> avec la signature requise?  Voil√†!  Donc tout va bien. </p><br><p>  Il reste ensuite √† d√©terminer les propri√©t√©s correctes pour le serveur HTTP: </p><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">my_traits_t</span></span></span><span class="hljs-class"> :</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> restinio::<span class="hljs-keyword"><span class="hljs-keyword">default_traits_t</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">logger_t</span></span> = restinio::<span class="hljs-keyword"><span class="hljs-keyword">shared_ostream_logger_t</span></span>; <span class="hljs-comment"><span class="hljs-comment">//      . using connection_state_listener_t = blocker_t; using ip_blocker_t = blocker_t; };</span></span></code> </pre> <br><p>  Apr√®s cela, il ne reste plus qu'√† cr√©er une instance de <code>blocker_t</code> et √† la passer dans les param√®tres au serveur HTTP: </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> blocker = <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::make_shared&lt;<span class="hljs-keyword"><span class="hljs-keyword">blocker_t</span></span>&gt;(); restinio::run( ioctx, restinio::on_thread_pool&lt;<span class="hljs-keyword"><span class="hljs-keyword">my_traits_t</span></span>&gt;( <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::thread::hardware_concurrency() ) .port( <span class="hljs-number"><span class="hljs-number">8080</span></span> ) .address( <span class="hljs-string"><span class="hljs-string">"localhost"</span></span> ) .connection_state_listener( blocker ) .ip_blocker( blocker ) .max_pipelined_requests( <span class="hljs-number"><span class="hljs-number">4</span></span> ) .handle_request_timeout( <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::chrono::seconds{<span class="hljs-number"><span class="hljs-number">20</span></span>} ) .request_handler( [&amp;ioctx](<span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> req) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> handler( ioctx, <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::move(req) ); } ) );</code> </pre> <br><h1 id="zaklyuchenie">  Conclusion </h1><br><h2 id="o-cnyh-shablonah">  √Ä propos des mod√®les C ++ </h2><br><p>  √Ä mon avis, les mod√®les C ++ sont ce qu'on appelle des pistolets trop gros.  C'est-√†-dire  fonctionnalit√© si puissante que vous devez involontairement r√©fl√©chir √† la mani√®re et √† la mani√®re dont son utilisation est justifi√©e.  Par cons√©quent, la communaut√© C ++ moderne est comme divis√©e en plusieurs camps en guerre. </p><br><p>  Les repr√©sentants de l'un d'entre eux pr√©f√®rent rester √† l'√©cart des mod√®les.  Les mod√®les √©tant complexes, ils g√©n√®rent des longueurs illisibles de feuilles de messages d'erreur illisibles, ce qui augmente consid√©rablement le temps de compilation.  Sans parler des l√©gendes urbaines sur le ballonnement du code et la r√©duction des performances. </p><br><p>  Les repr√©sentants d'un autre camp (comme moi) pensent que les mod√®les sont l'un des aspects les plus puissants du C ++.  Il est m√™me possible que les mod√®les soient l'un des rares avantages comp√©titifs les plus s√©rieux du C ++ dans le monde moderne.  Par cons√©quent, √† mon avis, l'avenir du C ++ est pr√©cis√©ment les mod√®les.  Et certains des inconv√©nients actuels associ√©s √† l'utilisation g√©n√©ralis√©e des mod√®les (comme la compilation longue et gourmande en ressources ou les messages d'erreur non informatifs) seront √©limin√©s d'une mani√®re ou d'une autre au fil du temps. </p><br><p>  Par cons√©quent, il me semble personnellement que l'approche choisie lors de la mise en ≈ìuvre de RESTinio, √† savoir l'utilisation g√©n√©ralis√©e de mod√®les et la sp√©cification des caract√©ristiques d'un serveur HTTP via les propri√©t√©s, porte toujours ses fruits.  Gr√¢ce √† cela, nous obtenons une bonne personnalisation pour des besoins sp√©cifiques.  Et en m√™me temps, au sens litt√©ral, nous ne payons pas ce que nous n'utilisons pas. </p><br><p>  Cependant, d'un autre c√¥t√©, il semble que la programmation dans les mod√®les C ++ soit encore excessivement compliqu√©e.  Vous le ressentez particuli√®rement lorsque vous devez programmer non pas constamment, mais lorsque vous basculez entre diff√©rentes activit√©s.  Vous serez distrait pendant quelques semaines du codage, puis vous reviendrez et commencerez ouvertement et sp√©cifiquement stupide si n√©cessaire, masquerez une m√©thode en utilisant SFINAE ou v√©rifiez si un objet avec une certaine signature a une m√©thode. </p><br><p>  C'est donc bien qu'il y ait des mod√®les en C ++.  Ce serait encore mieux s'ils √©taient amen√©s √† un √©tat tel que m√™me des d√©marreurs comme moi pourraient facilement utiliser des mod√®les C ++ sans avoir √† √©tudier cppreference et stackoverflow toutes les 10-15 minutes. </p><br><h2 id="o-tekuschem-sostoyanii-restinio-i-buduschey-funkcionalnosti-restinio-i-ne-tolko-restinio">  √Ä propos de l'√©tat actuel de RESTinio et des fonctionnalit√©s futures de RESTinio.  Et pas seulement RESTinio </h2><br><p>  En ce moment, RESTinio se d√©veloppe sur le principe "quand il y a du temps et qu'il y a une liste de souhaits".  Par exemple, √† l'automne 2018 et √† l'hiver 2019, nous n'avons pas eu beaucoup de temps pour le d√©veloppement de RESTinio.  Ils ont r√©pondu aux questions des utilisateurs, ont apport√© des modifications mineures, mais pour quelque chose de plus, nos ressources n'√©taient pas suffisantes. </p><br><p>  Mais √† la fin du printemps 2019, il √©tait temps pour RESTinio, et nous avons d'abord cr√©√© RESTinio <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">0.5.0</a> , puis <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">0.5.1</a> .  Dans le m√™me temps, l'offre de notre liste de souhaits et de celle des autres a √©t√© √©puis√©e.  C'est-√†-dire  ce que nous voulions nous-m√™mes voir dans RESTinio et ce que les utilisateurs nous ont dit, est d√©j√† dans RESTinio. </p><br><p>  De toute √©vidence, RESTinio peut √™tre rempli de beaucoup plus.  Mais quoi exactement? </p><br><p>  Et ici la r√©ponse est tr√®s simple: seulement ce qu'on nous demande d'entrer dans RESTinio.  Par cons√©quent, si vous voulez voir quelque chose dont vous avez besoin dans RESTinio, prenez le temps de nous en parler (par exemple, via des probl√®mes sur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">GitHub</a> ou <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">BitBucket</a> , soit via le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">groupe Google</a> , soit directement dans les commentaires ici sur Habr√©) .  Vous ne direz rien - vous ne recevrez rien;) </p><br><p>  En fait, la m√™me situation est avec nos autres projets, en particulier avec <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">SObjectizer</a> .  Leurs nouvelles versions seront publi√©es √† la r√©ception d'une liste de souhaits intelligible. </p><br><p>  Et enfin, je voudrais offrir √† tous ceux qui n'ont pas encore essay√© RESTinio: essayez-le <del>  gratuitement </del>  pas mal.  Tout √† coup, j'aime √ßa.  Et si vous ne l'aimez pas, partagez quoi exactement.  Cela nous aidera √† rendre RESTinio encore plus pratique et fonctionnel. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr456632/">https://habr.com/ru/post/fr456632/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr456616/index.html">3 millions de roubles pour ceux qui savent coder</a></li>
<li><a href="../fr456618/index.html">Larabeer Moscou - 21 juin</a></li>
<li><a href="../fr456622/index.html">Comment cr√©er un OS certifi√© selon la protection de classe I</a></li>
<li><a href="../fr456624/index.html">Outils Python utiles</a></li>
<li><a href="../fr456630/index.html">Pr√©sentation d'Airflow pour g√©rer les Spark Jobs √† ivi: espoirs et b√©quilles</a></li>
<li><a href="../fr456634/index.html">Recettes Nginx: CAS (Central Authorization Service)</a></li>
<li><a href="../fr456638/index.html">Comparaison du m√™me projet dans Rust, Haskell, C ++, Python, Scala et OCaml</a></li>
<li><a href="../fr456640/index.html">Analyse du concours d'intelligence √©conomique √† PHDays 9</a></li>
<li><a href="../fr456642/index.html">La premi√®re remise des dipl√¥mes du programme JetBrains Corporate Master et ITMO University</a></li>
<li><a href="../fr456644/index.html">Une imprimante photo-polym√®re 3D √† bas prix plus longue appara√Æt sur Kickstarter</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>