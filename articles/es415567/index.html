<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>游뛊游낕 游녢游낕 游눊 Transmita video h264 sin transcodificar desde una c치mara Logitech C920 游낓 游돗游 游끼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="El retraso no fue m치s de 0.3 segundos, dado el hecho de que la c치mara est치 conectada a un BeagleBone Blue d칠bil con una carga de procesador de no m치s ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Transmita video h264 sin transcodificar desde una c치mara Logitech C920</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/415567/"><img src="https://habrastorage.org/webt/dc/by/xs/dcbyxsicqllz2-jksmikcesodlu.jpeg"><br><br>  El retraso no fue m치s de 0.3 segundos, dado el hecho de que la c치mara est치 conectada a un BeagleBone Blue d칠bil con una carga de procesador de no m치s del 30% y la transmisi칩n de video se transmite a trav칠s de un enrutador wifi a una computadora port치til. <br><a name="habracut"></a><br>  Inicialmente, la tarea era transmitir video desde el robot a una computadora grande sin cargar el procesador en el robot y sin demoras.  En el proceso de buscar c치maras y programas en Google para esta tarea, se descubri칩 que hay <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">c치maras con codificaci칩n de video basada en hardware en la propia c치mara</a> , despu칠s de lo cual se compr칩 la c치mara Logitech C920.  Y comenzaron las pruebas y experimentos, durante los cuales se encontraron dos opciones de traducci칩n sin transcodificaci칩n. <br><br>  Todas las acciones adicionales se verifican en Ubuntu 16.04, la segunda opci칩n probablemente funcione en Windows <br><br><h3>  Transmita video codificado por hardware desde una c치mara Logitech C920 a trav칠s de cvlc y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">v4l2</a> </h3><br>  clvc: el servidor transmite video a trav칠s de vlc desde la l칤nea de comandos. <br><br><h4>  Hardware que codifica una transmisi칩n de video </h4><br>  Establecer c치maras de formato de p칤xel a H264 <br><br><pre><code class="bash hljs">v4l2-ctl --device=/dev/video1 --<span class="hljs-built_in"><span class="hljs-built_in">set</span></span>-fmt-video=width=800,height=600,pixelformat=1</code> </pre> <br>  Pruebe H264 con vlc, por lo que no restablecer치 la configuraci칩n: <br><br><pre> <code class="bash hljs">cvlc v4l2:///dev/video1 --demux h264</code> </pre> <br>  Si intenta esto, vlc restablecer치 la configuraci칩n antes de jugar: <br><br><pre> <code class="bash hljs">cvlc v4l2:///dev/video1:chroma=h264</code> </pre> <br>  La reproducci칩n funciona.  Obtenemos el flujo H264 de la c치mara.  Ahora pasemos por la red a trav칠s de HTTP: <br><br><pre> <code class="bash hljs">cvlc v4l2:///dev/video1:chroma=h264:width=800:height=600 --sout <span class="hljs-string"><span class="hljs-string">'#standard{access=http,mux=ts,dst=localhost:8080,name=stream,mime=video/ts}'</span></span> -vvv</code> </pre> <br>  (en la red, debe usar la direcci칩n IP de su dispositivo local en lugar de localhost) <br><br>  Lanzamiento del receptor: <br><br><pre> <code class="bash hljs">mplayer http://localhost:8080/</code> </pre> <br>  Resulta que MPEG-TS permite que mplayer se conecte a la transmisi칩n en cualquier momento con un ligero retraso (probablemente esperando un fotograma clave o algo). <br><br>  Si usa mux = avi, mime = video / avi, debe ejecutar mplayer en el momento en que inicia vlc, de lo contrario, mplayer no comenzar치 a reproducirse. <br><br><h4>  Error de ffmpeg </h4><br><ul><li>  Si prueba ffmpeg en lugar de vlc para jugar, probablemente se encontrar치 con este problema: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">ffmpeg.org/trac/ffmpeg/ticket/1387</a> </li><li>  Tan pronto como ejecute ffmpeg, cambiar치 a "Video: rawvideo (YUY2 / 0x32595559)" </li><li>  Si bien acepta MJPEG, no funcionar치 con H.264 </li><li>  Lo mismo sucede cuando se usa qv4l2: al iniciar la captura en modo H264, en realidad se obtiene la ventana de video YUY2 </li></ul><br><h4>  Reproducir video decodificado por hardware </h4><br>  Mplayer puede reproducir framebuffer, aseg칰rese de que X no funcione e ingrese: <br><br><pre> <code class="bash hljs">mplayer http://192.168.1.100:8080/ -fs -framedrop -vo fbdev</code> </pre> <br>  Tambi칠n puedes jugar en la ventana X si quieres: ejecuta X desde la l칤nea de comando: <br><br><pre> <code class="bash hljs">Xorg -retro &amp;&gt; /dev/zero</code> </pre> <br>  Hay toneladas de mensajes de error de fbdev que silenciosamente colocamos en / dev / zero <br><br>  Reproduzca una transmisi칩n de video desde una fuente LAN vlc (consulte la secci칩n anterior): <br><br><pre> <code class="bash hljs">DISPLAY=<span class="hljs-string"><span class="hljs-string">":0"</span></span> mplayer http://192.168.1.100:8080/ -fs -framedrop</code> </pre> <br><ul><li>  Si hacemos esto, notaremos que todav칤a no estamos utilizando Xvideo o ninguna aceleraci칩n de hardware </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">linux-sunxi.org/CedarX</a> parece proporcionarnos una biblioteca de VPU, que desafortunadamente es una cosa insegura de Allwinner </li><li>  Pero hay un VLC pirateado que puede usarlo: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">linux-sunxi.org/VLC</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Compilado con 칠xito</a> </li></ul><br><h4>  Raspberry pi </h4><br>  En caso de que experimente artefactos en la imagen y transmisiones de Raspberry Pi, use: <br><br><pre> <code class="bash hljs">cvlc v4l2:///dev/video0:chroma=h264 ...</code> </pre> <br>  Es posible que deba actualizar el firmware: <br><br><pre> <code class="bash hljs">apt-get install rpi-update raspi-config rpi-update reboot</code> </pre> <br><h4>  Resumen de difusi칩n a trav칠s de cvlc y v4l2 </h4><br>  Las pruebas mostraron que la carga del procesador en Beaglebone Blue no es m치s del 30%, lo cual es muy bueno para un procesador d칠bil, pero no est치 claro c칩mo empujar este video a ROS. <br><br>  Si el ancho de banda wifi no es suficiente, el retraso del video aumenta considerablemente, en teor칤a esto se puede resolver cambiando de tcp a udp, la documentaci칩n de cvlc menciona la posibilidad de transmitir a trav칠s de udp. <br><br><h3>  Transmita video codificado por hardware desde una c치mara Logitech C920 a trav칠s de Gstreamer </h3><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Art칤culo original del desarrollador que admite este m칠todo en Gstreamer.</a> <br>  Instalar gstreamer en Ubuntu 16.04 <br><br><pre> <code class="bash hljs">sudo apt-get install libgstreamer1.0-0 gstreamer1.0-plugins-base gstreamer1.0-plugins-good gstreamer1.0-plugins-bad gstreamer1.0-plugins-ugly gstreamer1.0-libav gstreamer1.0-doc gstreamer1.0-tools sudo apt-get install libgstreamer-plugins-base1.0-dev</code> </pre> <br><h4>  La fuente uvch264src le permite: </h4><br><ul><li>  Capture simult치neamente una transmisi칩n de video codificada por hardware h264 y una transmisi칩n de video del rastreador. </li><li>  Configure la codificaci칩n de video de hardware (velocidad de bits, fotogramas clave y m치s) </li></ul><br>  La fuente del visor secundario es un concepto interesante.  Adem치s de la transmisi칩n principal H.264, obtienes una transmisi칩n secundaria de baja resoluci칩n en formato MJPG o YUV.  No estoy seguro de si esta es una caracter칤stica de la c치mara, el controlador o el bloque fuente de gstreamer, pero espero que sea 칰til para nuestras c치maras Beaglebone, siempre que la funci칩n no utilice un procesador demasiado grande para convertir entre raw y jpg. <br><br>  El siguiente es un ejemplo de una tuber칤a que muestra una transmisi칩n H.264 de alta resoluci칩n y una transmisi칩n del visor: <br><br><pre> <code class="bash hljs">gst-launch-1.0 -v -e uvch264src device=/dev/video0 name=src auto-start=<span class="hljs-literal"><span class="hljs-literal">true</span></span> src.vfsrc ! queue ! video/x-raw,format=YUY2,width=320,height=240,framerate=10/1 ! xvimagesink sync=<span class="hljs-literal"><span class="hljs-literal">false</span></span> src.vidsrc ! queue ! video/x-h264,width=1280,height=720,framerate=30/1 ! h264parse ! avdec_h264 ! xvimagesink sync=<span class="hljs-literal"><span class="hljs-literal">false</span></span></code> </pre> <br>  El flujo primario H.264 se decodifica utilizando el bloque avdec_h264, accesible a trav칠s del paquete gst-libav, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">consulte las notas en el wiki de oz9aec</a> .  El panel del visor se puede conectar al fakelink si no es necesario, pero no creo que se pueda deshabilitar (a칰n puede deshabilitarlo).  Al menos esta es la impresi칩n de que estoy leyendo la publicaci칩n original del <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">blog KaKaRoTo</a> . <br><br>  Probablemente se sobrecargar치 cuando vea una gran cantidad de par치metros que se pueden configurar para este bloque de origen: <br><br><pre> <code class="bash hljs">gst-inspect-1.0 uvch264src</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Lista de par치metros de Uvch264src</b> <div class="spoiler_text">  Detalles de la f치brica: <br>  Rango ninguno (0) <br>  Fuente UVC H264 de nombre largo <br>  Fuente de Klass / video <br>  Descripci칩n Fuente de c치mara de codificaci칩n UVC H264 <br>  Autora Youness Alaoui &lt;youness.alaoui@collabora.co.uk&gt; <br><br>  Detalles del complemento: <br>  Nombre uvch264 <br>  Descripci칩n Complemento de c치maras de codificaci칩n H264 compatible con UVC <br>  Nombre de archivo /usr/lib/x86_64-linux-gnu/gstreamer-1.0/libgstuvch264.so <br>  Version 1.8.3 <br>  Licencia LGPL <br>  M칩dulo fuente gst-plugins-bad <br>  Fecha de lanzamiento de origen 2016-08-19 <br>  Paquete binario GStreamer Bad Plugins (Ubuntu) <br>  URL de origen <a href="">launchpad.net/distros/ubuntu/+source/gst-plugins-bad1.0</a> <br><br>  GObject <br>  + ---- GInicialmente desconocido <br>  + ---- GstObject <br>  + ---- GstElement <br>  + ---- GstBin <br>  + ---- GstBaseCameraSrc <br>  + ---- GstUvcH264Src <br><br>  Interfaces implementadas: <br>  Gstchildproxy <br><br>  Plantillas de almohadilla: <br>  Plantilla SRC: 'vidsrc' <br>  Disponibilidad: siempre <br>  Capacidades: <br>  video / x-raw <br>  formato: {I420, YV12, YUY2, UYVY, AYUV, RGBx, BGRx, xRGB, xBGR, RGBA, BGRA, ARGB, ABGR, RGB, BGR, Y41B, Y42B, YVYU, Y444, v210, v216, NV12, NV21, NV16 , NV61, NV24, GREY8, GREY16_BE, GREY16_LE, v308, RGB16, BGR16, RGB15, BGR15, UYVP, A420, RGB8P, YUV9, YVU9, IYU1, ARGB64, AYUV64, r210, I420_10LE, I420_10_104, , GBR, GBR_10LE, GBR_10BE, NV12_64Z32, A420_10LE, A420_10BE, A422_10LE, A422_10BE, A444_10LE, A444_10BE} <br>  ancho: [1, 2147483647] <br>  altura: [1, 2147483647] <br>  velocidad de fotogramas: [0/1, 2147483647/1] <br>  imagen / jpeg <br>  ancho: [1, 2147483647] <br>  altura: [1, 2147483647] <br>  velocidad de fotogramas: [0/1, 2147483647/1] <br>  video / x-h264 <br>  ancho: [1, 2147483647] <br>  altura: [1, 2147483647] <br>  velocidad de fotogramas: [0/1, 2147483647/1] <br>  formato de transmisi칩n: {byte-stream, avc} <br>  alineaci칩n: au <br>  perfil: {alto, principal, l칤nea base, l칤nea base restringida} <br><br>  Plantilla SRC: 'imgsrc' <br>  Disponibilidad: siempre <br>  Capacidades: <br>  VAC칈O <br><br>  Plantilla SRC: 'vfsrc' <br>  Disponibilidad: siempre <br>  Capacidades: <br>  video / x-raw <br>  formato: {I420, YV12, YUY2, UYVY, AYUV, RGBx, BGRx, xRGB, xBGR, RGBA, BGRA, ARGB, ABGR, RGB, BGR, Y41B, Y42B, YVYU, Y444, v210, v216, NV12, NV21, NV16 , NV61, NV24, GREY8, GREY16_BE, GREY16_LE, v308, RGB16, BGR16, RGB15, BGR15, UYVP, A420, RGB8P, YUV9, YVU9, IYU1, ARGB64, AYUV64, r210, I420_10LE, I420_10_104, , GBR, GBR_10LE, GBR_10BE, NV12_64Z32, A420_10LE, A420_10BE, A422_10LE, A422_10BE, A444_10LE, A444_10BE} <br>  ancho: [1, 2147483647] <br>  altura: [1, 2147483647] <br>  velocidad de fotogramas: [0/1, 2147483647/1] <br>  imagen / jpeg <br>  ancho: [1, 2147483647] <br>  altura: [1, 2147483647] <br>  velocidad de fotogramas: [0/1, 2147483647/1] <br><br>  Banderas de elementos: <br>  sin banderas <br><br>  Banderas de la papelera: <br>  sin banderas <br><br>  Implementaci칩n de elementos: <br>  Tiene la funci칩n change_state (): 0x7ff438f22ba0 <br><br>  Element no tiene capacidades de reloj. <br>  Element no tiene capacidades de manejo de URI. <br><br>  Almohadillas: <br>  Src: 'vfsrc' <br>  Src: 'imgsrc' <br>  SRC: 'vidsrc' <br><br>  Propiedades del elemento: <br>  nombre: el nombre del objeto <br>  banderas: leer, escribir <br>  Cadena  Valor predeterminado: "uvch264src0" <br>  parent: el padre del objeto <br>  banderas: leer, escribir <br>  Objeto de tipo "GstObject" <br>  manejo as칤ncrono: el contenedor manejar치 cambios de estado asincr칩nicos <br>  banderas: leer, escribir <br>  Booleano  Predeterminado: falso <br>  message-forward: reenv칤a todos los mensajes secundarios <br>  banderas: leer, escribir <br>  Booleano  Predeterminado: falso <br>  modo: el modo de captura (captura de im치genes fijas o grabaci칩n de video) <br>  banderas: leer, escribir <br>  Enum "GstCameraBin2Mode" Predeterminado: 2, "mode-video" <br>  (1): mode-image - Captura de imagen fija (predeterminado) <br>  (2): modo-video - Grabaci칩n de video <br>  zoom: factor de zoom digital (por ejemplo, 1.5 significa 1.5x) <br>  banderas: leer, escribir <br>  Flotador  Rango: 1 - 3.402823e + 38 Valor predeterminado: 1 <br>  zoom m치ximo: factor de zoom digital (por ejemplo, 1.5 significa 1.5x) <br>  banderas: legible <br>  Flotador  Rango: 1 - 3.402823e + 38 Valor predeterminado: 10 <br>  listo para capturar: informa que este elemento est치 listo para comenzar otra captura <br>  banderas: legible <br>  Booleano  Predeterminado: verdadero <br>  vistas previas posteriores: si las im치genes de vista previa de captura deben publicarse en el bus <br>  banderas: leer, escribir <br>  Booleano  Predeterminado: verdadero <br>  preview-caps: los caps de la imagen de vista previa que se publicar치 (NULL significa CUALQUIERA) <br>  banderas: leer, escribir <br>  Cualquier <br><br>  vista previa-filtro: un filtro de vista previa personalizado para procesar datos de vista previa de la imagen <br>  banderas: leer, escribir <br>  Objeto de tipo "GstElement" <br>  inicio autom치tico: inicia autom치ticamente la captura cuando pasa al estado PAUSADO <br>  banderas: leer, escribir <br>  Booleano  Predeterminado: falso <br>  nombre del espacio de colores: el nombre del elemento del espacio de colores <br>  banderas: leer, escribir, solo puede ser NULL o READY <br>  Cadena  Valor predeterminado: "videoconvert" <br>  jpeg-decoder-name: el nombre del elemento decodificador jpeg <br>  banderas: leer, escribir, solo puede ser NULL o READY <br>  Cadena  Valor predeterminado: "jpegdec" <br>  num-clock-samples: n칰mero de muestras de reloj para recopilar para la sincronizaci칩n PTS (-1 = ilimitado) <br>  banderas: leer, escribir, puede ser NULO, LISTO, PAUSADO o JUGANDO <br>  Entero  Rango: 0 - 2147483647 Valor predeterminado: 0 <br>  num-buffers: N칰mero de buffers para generar antes de enviar EOS (-1 = ilimitado) <br>  banderas: leer, escribir <br>  Entero  Rango: -1 - 2147483647 Valor predeterminado: -1 <br>  dispositivo: ubicaci칩n del dispositivo <br>  banderas: leer, escribir <br>  Cadena  Valor predeterminado: "/ dev / video0" <br>  nombre-dispositivo: nombre del dispositivo <br>  banderas: legible <br>  Cadena  Predeterminado: "" <br>  velocidad de bits inicial: velocidad de bits inicial en bits / segundo (control est치tico) <br>  banderas: leer, escribir, solo puede ser NULL o READY <br>  Entero sin signo.  Rango: 0 - 4294967295 Valor predeterminado: 3,000,000 <br>  unidades de corte: unidades de corte (control est치tico) <br>  banderas: leer, escribir, solo puede ser NULL o READY <br>  Entero sin signo.  Rango: 0-65535 Valor predeterminado: 4 <br>  modo de divisi칩n: define la unidad de la propiedad de unidades de divisi칩n (control est치tico) <br>  banderas: leer, escribir, solo puede ser NULL o READY <br>  Enum "UvcH264SliceMode" Predeterminado: 3, "slice / frame" <br>  (0): ignorado - Ignorado <br>  (1): bits / segmento - Bits por segmento <br>  (2): MB / segmento - MB por segmento <br>  (3): corte / marco - Corte por marco <br>  iframe-period: tiempo entre tramas IDR en milisegundos (control est치tico) <br>  banderas: leer, escribir, solo puede ser NULL o READY <br>  Entero sin signo.  Rango: 0-65535 Valor predeterminado: 10000 <br>  tipo de uso: el tipo de uso (control est치tico) <br>  banderas: leer, escribir, solo puede ser NULL o READY <br>  Enum "UvcH264UsageType" Valor predeterminado: 1, "en tiempo real" <br>  (1): tiempo real - Tiempo real (videoconferencia) <br>  (2): transmisi칩n - Transmisi칩n <br>  (3): almacenamiento - Almacenamiento <br>  (4): ucconfig0 - UCConfig 0 <br>  (5): ucconfig1 - UCConfig 1 <br>  (6): ucconfig2q - UCConfig 2Q <br>  (7): ucconfig2s - UCConfig 2S <br>  (8): ucconfig3 - UCConfig 3 <br>  entrop칤a: entrop칤a (control est치tico) <br>  banderas: leer, escribir, solo puede ser NULL o READY <br>  Enum "UvcH264Entropy" Valor predeterminado: 0, "cavlc" <br>  (0): cavlc - CAVLC <br>  (1): cabac - CABAC <br>  enable-sei: Habilita el tiempo de imagen SEI (control est치tico) <br>  banderas: leer, escribir, solo puede ser NULL o READY <br>  Booleano  Predeterminado: falso <br>  num-reorder-frames: N칰mero de cuadros B entre los cuadros de referencia (control est치tico) <br>  banderas: leer, escribir, solo puede ser NULL o READY <br>  Entero sin signo.  Rango: 0-255 Predeterminado: 0 <br>  vista previa volteada: imagen volteada horizontal para flujos no H.264 (control est치tico) <br>  banderas: leer, escribir, solo puede ser NULL o READY <br>  Booleano  Predeterminado: falso <br>  tama침o del cubo con fugas: tama침o del tama침o del cubo con fugas en milisegundos (control est치tico) <br>  banderas: leer, escribir, solo puede ser NULL o READY <br>  Entero sin signo.  Rango: 0-65535 Valor predeterminado: 1000 <br>  control de velocidad: modo de control de velocidad (control est치tico y din치mico) <br>  banderas: leer, escribir, puede ser NULO, LISTO, PAUSADO o JUGANDO <br>  Enum "UvcH264RateControl" Valor predeterminado: 1, "cbr" <br>  (1): cbr - Velocidad de bits constante <br>  (2): vbr - Velocidad de bits variable <br>  (3): qp - QP constante <br>  velocidad de fotogramas fija: velocidad de fotogramas fija (control est치tico y din치mico) <br>  banderas: leer, escribir, puede ser NULO, LISTO, PAUSADO o JUGANDO <br>  Booleano  Predeterminado: falso <br>  max-mbps: el n칰mero de macrobloques por segundo para la velocidad de procesamiento m치xima <br>  banderas: legible <br>  Entero sin signo.  Rango: 0 - 4294967295 Valor predeterminado: 0 <br>  level-idc: Level IDC (control din치mico) <br>  banderas: leer, escribir, puede ser NULO, LISTO, PAUSADO o JUGANDO <br>  Entero sin signo.  Rango: 0-255 Predeterminado: 40 <br>  velocidad de bits m치xima: la velocidad de bits m치xima en bits / segundo (control din치mico) <br>  banderas: leer, escribir, puede ser NULO, LISTO, PAUSADO o JUGANDO <br>  Entero sin signo.  Rango: 0 - 4294967295 Valor predeterminado: 3,000,000 <br>  velocidad de bits promedio: la velocidad de bits promedio en bits / segundo (control din치mico) <br>  banderas: leer, escribir, puede ser NULO, LISTO, PAUSADO o JUGANDO <br>  Entero sin signo.  Rango: 0 - 4294967295 Valor predeterminado: 3,000,000 <br>  min-iframe-qp: el tama침o m칤nimo del paso de cuantizaci칩n para cuadros I (control din치mico) <br>  banderas: leer, escribir, puede ser NULO, LISTO, PAUSADO o JUGANDO <br>  Entero  Rango: -127-127 Predeterminado: 10 <br>  max-iframe-qp: el tama침o m칤nimo del paso de cuantizaci칩n para cuadros I (control din치mico) <br>  banderas: leer, escribir, puede ser NULO, LISTO, PAUSADO o JUGANDO <br>  Entero  Rango: -127-127 Predeterminado: 46 <br>  min-pframe-qp: el tama침o m칤nimo del paso de cuantizaci칩n para cuadros P (control din치mico) <br>  banderas: leer, escribir, puede ser NULO, LISTO, PAUSADO o JUGANDO <br>  Entero  Rango: -127-127 Predeterminado: 10 <br>  max-pframe-qp: el tama침o m칤nimo del paso de cuantizaci칩n para cuadros P (control din치mico) <br>  banderas: leer, escribir, puede ser NULO, LISTO, PAUSADO o JUGANDO <br>  Entero  Rango: -127-127 Predeterminado: 46 <br>  min-bframe-qp: el tama침o m칤nimo del paso de cuantizaci칩n para cuadros B (control din치mico) <br>  banderas: leer, escribir, puede ser NULO, LISTO, PAUSADO o JUGANDO <br>  Entero  Rango: -127-127 Predeterminado: 10 <br>  max-bframe-qp: el tama침o m칤nimo del paso de cuantizaci칩n para cuadros B (control din치mico) <br>  banderas: leer, escribir, puede ser NULO, LISTO, PAUSADO o JUGANDO <br>  Entero  Rango: -127-127 Predeterminado: 46 <br>  ltr-buffer-size: n칰mero total de marcos de referencia a largo plazo (control din치mico) <br>  banderas: leer, escribir, puede ser NULO, LISTO, PAUSADO o JUGANDO <br>  Entero  Rango: 0-255 Predeterminado: 0 <br>  ltr-encoder-control: n칰mero de tramas LTR que el dispositivo puede controlar (control din치mico) <br>  banderas: leer, escribir, puede ser NULO, LISTO, PAUSADO o JUGANDO <br>  Entero  Rango: 0-255 Predeterminado: 0 <br><br>  Acciones de elementos: <br>  "Get-enum-setting": gboolean user_function (objeto GstElement *, <br>  gchararray arg0, <br>  gpointer arg1, <br>  gpointer arg2); <br>  "Get-boolean-setting": gboolean user_function (objeto GstElement *, <br>  gchararray arg0, <br>  gpointer arg1, <br>  gpointer arg2); <br>  "Get-int-setting": gboolean user_function (objeto GstElement *, <br>  gchararray arg0, <br>  gpointer arg1, <br>  gpointer arg2, <br>  gpointer arg3); <br>  "Start-capture": void user_function (objeto GstElement *); <br>  "Stop-capture": void user_function (objeto GstElement *); <br></div></div><br>  Muchos de estos par치metros se pueden usar para configurar par치metros en compresi칩n H.264.  Esto me parece bastante sorprendente dado que la compresi칩n se realiza mediante el chip dentro de la c치mara.  El siguiente ejemplo aumenta la velocidad de datos predeterminada de 3 a 5 Mbps y reduce el intervalo de fotogramas clave predeterminado de 10 a 3 segundos: <br><br><pre> <code class="bash hljs">gst-launch-1.0 -v -e uvch264src initial-bitrate=5000000 average-bitrate=5000000 iframe-period=3000 device=/dev/video0 name=src auto-start=<span class="hljs-literal"><span class="hljs-literal">true</span></span> src.vfsrc ! queue ! video/x-raw,format=YUY2,width=320,height=240,framerate=10/1 ! xvimagesink sync=<span class="hljs-literal"><span class="hljs-literal">false</span></span> src.vidsrc ! queue ! video/x-h264,width=1280,height=720,framerate=30/1 ! h264parse ! avdec_h264 ! xvimagesink sync=<span class="hljs-literal"><span class="hljs-literal">false</span></span></code> </pre> <br>  Por otro lado, no hay par치metros para ajustar los par치metros habituales de la c치mara web, como contraste, brillo, enfoque, etc. Por lo tanto, para configurarlos, todav칤a necesitamos herramientas externas, como v4l2.ctl, o la opci칩n mencionada en siguiente secci칩n <br><br><h4>  v4l2src </h4><br>  Parece que tambi칠n podemos usar el viejo v4l2src para capturar transmisiones codificadas H.264 del Logitech C920: <br><br><pre> <code class="bash hljs">gst-launch-1.0 -v -e v4l2src device=/dev/video1 ! queue ! video/x-h264,width=1280,height=720,framerate=30/1 ! h264parse ! avdec_h264 ! xvimagesink sync=<span class="hljs-literal"><span class="hljs-literal">false</span></span></code> </pre> <br>  Esto probablemente se deba a la evoluci칩n de gstreamer y V4L2.  Esta opci칩n parece m치s simple si no necesita cambiar la configuraci칩n de compresi칩n H.264, y esto nos da acceso a la configuraci칩n de la c치mara, como el brillo y el contraste.  Tambi칠n tiene la ventaja de estar en un buen paquete de complementos que podr칤a mantenerse mejor en el futuro. <br><br><h4>  Transmisi칩n web a trav칠s de Gstreamer </h4><br>  En la computadora receptora, inicie el receptor: <br><br><pre> <code class="bash hljs">gst-launch-1.0 -v udpsrc port=6666 ! application/x-rtp, encoding-name=H264 ! rtph264depay ! h264parse ! avdec_h264 ! videoconvert ! autovideosink</code> </pre> <br>  En un dispositivo con c치mara, comenzamos a transmitir video codificado por hardware: <br><br><pre> <code class="bash hljs">gst-launch-1.0 uvch264src name=src auto-start=<span class="hljs-literal"><span class="hljs-literal">true</span></span> src.vidsrc ! video/x-h264,width=160,height=120,framerate=30/1 ! h264parse ! rtph264pay ! udpsink host=192.168.1.196 port=6666</code> </pre> <br>  Un agradecimiento especial a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" class="user_link">Amomum</a> por ayudarme a escribir este c칩digo. <br><br><h4>  Resumen del retraso de la transmisi칩n de video a trav칠s de Gstreamer </h4><br>  Incluso con una resoluci칩n de 1920 * 1080, la carga del procesador en Beaglebone Blue no super칩 el 30%, y el retraso del video no fue m치s de 0.3 segundos.  S칤, dado que el video en esta versi칩n se transmiti칩 a trav칠s de udp, cuando se pierden los paquetes, la imagen se desmorona al siguiente cuadro clave, pero podemos configurarlo para que los cuadros clave se env칤en con m치s frecuencia. <br><br><h3>  Tareas ROS </h3><br>  Ahora solo queda insertar el video recibido en ROS, si alguien puede ayudar con esto, escriba un mensaje personal. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es415567/">https://habr.com/ru/post/es415567/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es415557/index.html">C칩dec 2 + red neuronal = podcast completo en un disquete</a></li>
<li><a href="../es415559/index.html">La historia del desarrollo de los centros de llamadas o c칩mo las tecnolog칤as han cambiado el trabajo de los operadores con los clientes.</a></li>
<li><a href="../es415561/index.html">C칩mo enviar eventos de Veeam Backup & Replication a mensajer칤a instant치nea</a></li>
<li><a href="../es415563/index.html">El tratamiento de Scrum "mec치nico". Parte 2. Equipo</a></li>
<li><a href="../es415565/index.html">Por qu칠 (hoy) el retorno 444 no siempre es 칰til</a></li>
<li><a href="../es415569/index.html">C칍MO configurar ubuntu 18.04 sendmail + DKIM + SPF + DMARC o c칩mo logr칠 ingresar al basti칩n de Gmail</a></li>
<li><a href="../es415571/index.html">kaggle: identificaci칩n del modelo de c치mara de IEEE</a></li>
<li><a href="../es415573/index.html">Optimizaci칩n de un modelo para impresi칩n 3D usando el software Blender como ejemplo</a></li>
<li><a href="../es415575/index.html">Funciones para documentar bases de datos PostgreSQL. Primera parte</a></li>
<li><a href="../es415577/index.html">Diapositivas del curso "DBMS Technologies and Development"</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>