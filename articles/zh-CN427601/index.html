<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘©ğŸ½â€ğŸ¤â€ğŸ‘¨ğŸ¼ ğŸ‘©ğŸ¾â€ğŸ¤â€ğŸ‘©ğŸ½ ğŸ‘©ğŸ»â€ğŸ¤ 5 + 1æƒ…å†µï¼ŒREST APIè§„èŒƒèµ·ç€é‡è¦ä½œç”¨ ğŸ‘°ğŸ½ ğŸ§œğŸ½ ğŸ˜¤</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="æœ¬æ–‡å°†é‡ç‚¹ä»‹ç»ä¸ºREST APIé¡¹ç›®ç¼–å†™å’Œæ”¯æŒæœ‰ç”¨ä¸”ç›¸å…³çš„è§„èŒƒï¼Œè¯¥è§„èŒƒå°†èŠ‚çœå¤§é‡é¢å¤–çš„ä»£ç ï¼Œå¹¶ä»æ•´ä½“ä¸Šæé«˜æ•´ä¸ªé¡¹ç›®çš„å®Œæ•´æ€§ï¼Œå¯é æ€§å’Œé€æ˜åº¦ã€‚ 
 ä»€ä¹ˆæ˜¯RESTful APIï¼Ÿ 



 è¿™æ˜¯ä¸€ä¸ªç¥è¯ã€‚ 


 è®¤çœŸåœ°è¯´ï¼Œå¦‚æœæ‚¨è®¤ä¸ºæ‚¨çš„é¡¹ç›®å…·æœ‰RESTful APIï¼Œé‚£ä¹ˆå‡ ä¹å¯ä»¥è‚¯å®šä¼šå¼„é”™ã€‚ RES...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>5 + 1æƒ…å†µï¼ŒREST APIè§„èŒƒèµ·ç€é‡è¦ä½œç”¨</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/427601/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/b1/dg/ob/b1dgobh5dxfw3q-firfz-77qu-0.png"></div><br><p> æœ¬æ–‡å°†é‡ç‚¹ä»‹ç»ä¸ºREST APIé¡¹ç›®ç¼–å†™å’Œæ”¯æŒæœ‰ç”¨ä¸”ç›¸å…³çš„è§„èŒƒï¼Œè¯¥è§„èŒƒå°†èŠ‚çœå¤§é‡é¢å¤–çš„ä»£ç ï¼Œå¹¶ä»æ•´ä½“ä¸Šæé«˜æ•´ä¸ªé¡¹ç›®çš„å®Œæ•´æ€§ï¼Œå¯é æ€§å’Œé€æ˜åº¦ã€‚ </p><br><h3 id="chto-takoe-restful-api"> ä»€ä¹ˆæ˜¯RESTful APIï¼Ÿ </h3><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/dde/ee8/857/ddeee88570832b82d7a7ff7231255c3f.png"></div><br><p> è¿™æ˜¯ä¸€ä¸ªç¥è¯ã€‚ </p><br><p> è®¤çœŸåœ°è¯´ï¼Œå¦‚æœæ‚¨è®¤ä¸ºæ‚¨çš„é¡¹ç›®å…·æœ‰RESTful APIï¼Œé‚£ä¹ˆå‡ ä¹å¯ä»¥è‚¯å®šä¼šå¼„é”™ã€‚  RESTfulçš„æƒ³æ³•æ˜¯æ„å»ºä¸€ä¸ªåœ¨æ‰€æœ‰æ–¹é¢éƒ½ç¬¦åˆRESTæ ·å¼æè¿°çš„ä½“ç³»ç»“æ„è§„åˆ™å’Œé™åˆ¶çš„APIï¼Œä½†æ˜¯åœ¨å®é™…æƒ…å†µä¸‹ï¼Œè¿™<em>å‡ ä¹æ˜¯ä¸å¯èƒ½çš„</em> ã€‚ </p><a name="habracut"></a><br><p> ä¸€æ–¹é¢ï¼ŒRESTåŒ…å«å¤ªå¤šæ¨¡ç³Šä¸æ¸…çš„å®šä¹‰ã€‚ ä¾‹å¦‚ï¼ŒHTTPæ–¹æ³•å’ŒçŠ¶æ€ç è¯å…¸ä¸­çš„æŸäº›æœ¯è¯­åœ¨å®è·µä¸­å¹¶æœªæŒ‰é¢„æœŸç›®çš„ä½¿ç”¨ï¼Œè€Œå…¶ä¸­è®¸å¤šæ ¹æœ¬æ²¡æœ‰ä½¿ç”¨ã€‚ </p><br><p> å¦ä¸€æ–¹é¢ï¼ŒRESTåˆ›é€ äº†å¤ªå¤šçš„é™åˆ¶ã€‚ ä¾‹å¦‚ï¼Œç°å®ä¸–ç•Œä¸­èµ„æºçš„åŸå­ä½¿ç”¨å¯¹äºç§»åŠ¨åº”ç”¨ç¨‹åºä½¿ç”¨çš„APIæ˜¯ä¸åˆç†çš„ã€‚ å®Œå…¨æ‹’ç»åœ¨è¯·æ±‚ä¹‹é—´å­˜å‚¨çŠ¶æ€å®è´¨ä¸Šæ˜¯å¯¹è®¸å¤šAPIä¸­ä½¿ç”¨çš„ç”¨æˆ·ä¼šè¯æœºåˆ¶çš„ç¦æ­¢ã€‚ </p><br><p>  <strong>ä½†æ˜¯ï¼Œç­‰ç­‰ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„äº‹æƒ…éƒ½é‚£ä¹ˆç³Ÿç³•ï¼</strong> </p><br><h3 id="zachem-nuzhna-specifikaciya-rest-api"> ä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦REST APIè§„èŒƒï¼Ÿ </h3><br><p> å°½ç®¡å­˜åœ¨è¿™äº›ç¼ºç‚¹ï¼Œä½†é‡‡ç”¨åˆç†çš„æ–¹æ³•ï¼ŒRESTä»ç„¶æ˜¯è®¾è®¡çœŸæ­£å‡ºè‰²çš„APIçš„è‰¯å¥½åŸºç¡€ã€‚ è¿™æ ·çš„APIåº”è¯¥å…·æœ‰å†…éƒ¨ç»Ÿä¸€æ€§ï¼Œæ¸…æ™°çš„ç»“æ„ï¼Œæ–¹ä¾¿çš„æ–‡æ¡£è®°å½•å’Œè‰¯å¥½çš„å•å…ƒæµ‹è¯•è¦†ç›–èŒƒå›´ã€‚ æ‰€æœ‰è¿™äº›éƒ½å¯ä»¥é€šè¿‡ä¸ºæ‚¨çš„APIåˆ¶å®šè´¨é‡<strong>è§„èŒƒ</strong>æ¥å®ç°ã€‚ </p><br><p> é€šå¸¸ï¼ŒREST API <em>è§„èŒƒ</em>ä¸å…¶<em>æ–‡æ¡£</em>ç›¸å…³è”ã€‚ ä¸ç¬¬ä¸€ä¸ªæ–‡æ¡£ä¸åŒï¼ˆåè€…æ˜¯APIçš„æ­£å¼æè¿°ï¼‰ï¼Œè¯¥æ–‡æ¡£æ—¨åœ¨ä¾›äººä»¬é˜…è¯»ï¼šä¾‹å¦‚ï¼Œä½¿ç”¨APIâ€‹â€‹çš„ç§»åŠ¨æˆ–Webåº”ç”¨ç¨‹åºçš„å¼€å‘äººå‘˜ã€‚ </p><br><p> ä½†æ˜¯ï¼Œé™¤äº†å®é™…åˆ›å»ºæ–‡æ¡£å¤–ï¼Œæ­£ç¡®çš„APIæè¿°ä»ç„¶å¯ä»¥å¸¦æ¥å¾ˆå¤šå¥½å¤„ã€‚ åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘æƒ³åˆ†äº«ä¸€äº›ç¤ºä¾‹ï¼Œè¯´æ˜å¦‚ä½•æœ‰æ•ˆä½¿ç”¨è§„èŒƒï¼Œæ‚¨å¯ä»¥ï¼š </p><br><ul><li> ä½¿å•å…ƒæµ‹è¯•æ›´ç®€å•ï¼Œæ›´å¯é ï¼› </li><li> é…ç½®è¾“å…¥æ•°æ®çš„é¢„å¤„ç†å’ŒéªŒè¯ï¼› </li><li> è‡ªåŠ¨åºåˆ—åŒ–å¹¶ç¡®ä¿å“åº”çš„å®Œæ•´æ€§ï¼› </li><li> ç”šè‡³åˆ©ç”¨é™æ€ç±»å‹ã€‚ </li></ul><br><h3 id="openapi">  Openapi </h3><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/222/aae/af9/222aaeaf95adf9cb50af1ed7702d4c9b.png" width="500"></div><br><p> ä»Šå¤©ï¼Œæè¿°REST APIçš„å…¬è®¤æ ¼å¼æ˜¯<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><strong>OpenAPI</strong></a> ï¼Œä¹Ÿç§°ä¸º<em>Swagger</em> ã€‚ è¯¥è§„èŒƒæ˜¯JSONæˆ–YAMLæ ¼å¼çš„å•ä¸ªæ–‡ä»¶ï¼Œç”±ä¸‰ä¸ªéƒ¨åˆ†ç»„æˆï¼š </p><br><ul><li> æ ‡å¤´ï¼Œå…¶ä¸­åŒ…å«APIçš„åç§°ï¼Œè¯´æ˜å’Œç‰ˆæœ¬ï¼Œä»¥åŠå…¶ä»–ä¿¡æ¯ï¼› </li><li> å¯¹æ‰€æœ‰èµ„æºçš„æè¿°ï¼ŒåŒ…æ‹¬å…¶æ ‡è¯†ç¬¦ï¼ŒHTTPæ–¹æ³•ï¼Œæ‰€æœ‰è¾“å…¥å‚æ•°ä»¥åŠå“åº”ä¸»ä½“çš„ä»£ç å’Œæ ¼å¼ï¼Œä»¥åŠæŒ‡å‘å®šä¹‰çš„é“¾æ¥ï¼› </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><strong>JSONæ¨¡å¼</strong></a>æ ¼å¼çš„å¯¹è±¡çš„æ‰€æœ‰å®šä¹‰ï¼Œéƒ½å¯ä»¥åœ¨è¾“å…¥å‚æ•°å’Œå“åº”ä¸­ä½¿ç”¨ã€‚ </li></ul><br><p>  OpenAPIæœ‰ä¸€ä¸ªä¸¥é‡çš„ç¼ºç‚¹- <em>ç»“æ„å¤æ‚ï¼Œé€šå¸¸è¿˜æœ‰å†—ä½™</em> ã€‚ å¯¹äºä¸€ä¸ªå°å‹é¡¹ç›®ï¼Œè§„èŒƒJSONæ–‡ä»¶çš„å†…å®¹å¯ä»¥è¿…é€Ÿå¢é•¿åˆ°å‡ åƒè¡Œã€‚ æ— æ³•ä»¥è¿™ç§å½¢å¼æ‰‹åŠ¨ç»´æŠ¤æ­¤æ–‡ä»¶ã€‚ éšç€APIçš„å‘å±•ï¼Œè¿™å¯¹ç»´æŠ¤æœ€æ–°è§„èŒƒçš„æƒ³æ³•æ„æˆäº†ä¸¥é‡å¨èƒã€‚ </p><br><p> æœ‰è®¸å¤šå¯è§†åŒ–ç¼–è¾‘å™¨å¯è®©æ‚¨æè¿°APIå¹¶å½¢æˆæœ€ç»ˆçš„OpenAPIè§„èŒƒã€‚ åè¿‡æ¥ï¼Œå…¶ä»–æœåŠ¡å’Œäº‘è§£å†³æ–¹æ¡ˆä¹ŸåŸºäºå®ƒä»¬ï¼Œä¾‹å¦‚<em>Swagger</em> ï¼Œ <em>Apiary</em> ï¼Œ <em>Stoplight</em> ï¼Œ <em>Restlet</em>ç­‰ã€‚ </p><br><p> ä½†æ˜¯ï¼Œå¯¹æˆ‘æ¥è¯´ï¼Œç”±äºéš¾ä»¥å¿«é€Ÿç¼–è¾‘è§„èŒƒå¹¶å°†å…¶ä¸ä»£ç ç¼–å†™è¿‡ç¨‹ç»“åˆåœ¨ä¸€èµ·ï¼Œå› æ­¤æ­¤ç±»æœåŠ¡å¹¶ä¸æ˜¯å¾ˆæ–¹ä¾¿ã€‚ å¦ä¸€ä¸ªç¼ºç‚¹æ˜¯å¯¹æ¯ä¸ªç‰¹å®šæœåŠ¡åŠŸèƒ½é›†çš„ä¾èµ–ã€‚ ä¾‹å¦‚ï¼Œå‡ ä¹ä¸å¯èƒ½ä»…é€šè¿‡äº‘æœåŠ¡æ¥å®æ–½å…¨é¢çš„å•å…ƒæµ‹è¯•ã€‚ å°½ç®¡çœ‹èµ·æ¥å¾ˆæœ‰å¯èƒ½ï¼Œä½†æ˜¯ä»£ç ç”Ÿæˆç”šè‡³ä¸ºç«¯ç‚¹åˆ›å»ºâ€œæ’ä»¶â€å®é™…ä¸Šéƒ½æ²¡æœ‰ç”¨ã€‚ </p><br><h3 id="tinyspec">  Tinyspec </h3><br><p> åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†ä½¿ç”¨åŸºäºæœ¬åœ°REST APIæè¿°æ ¼å¼<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><strong>-tinyspecçš„ç¤ºä¾‹</strong></a> ã€‚ æ ¼å¼æ˜¯å°çš„æ–‡ä»¶ï¼Œè¿™äº›æ–‡ä»¶ä»¥ç›´è§‚çš„è¯­æ³•æè¿°äº†é¡¹ç›®ä¸­ä½¿ç”¨çš„ç«¯ç‚¹å’Œæ•°æ®æ¨¡å‹ã€‚ æ–‡ä»¶å­˜å‚¨åœ¨ä»£ç æ—è¾¹ï¼Œå¯è®©æ‚¨åœ¨ç¼–å†™æ–‡ä»¶æ—¶å¯¹å…¶è¿›è¡Œæ£€æŸ¥å’Œç¼–è¾‘ã€‚ åŒæ—¶ï¼Œtinyspecä¼šè‡ªåŠ¨ç¼–è¯‘ä¸ºæˆç†Ÿçš„OpenAPIï¼Œå¯ç«‹å³åœ¨é¡¹ç›®ä¸­ä½¿ç”¨ã€‚ ç°åœ¨è¯¥å‘Šè¯‰æ‚¨ç¡®åˆ‡çš„æ–¹æ³•äº†ã€‚ </p><br><p> åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†æä¾›Node.jsï¼ˆkoaï¼Œexpressï¼‰å’ŒRuby on Railsä¸­çš„ç¤ºä¾‹ï¼Œå°½ç®¡è¿™äº›å®è·µé€‚ç”¨äºå¤§å¤šæ•°æŠ€æœ¯ï¼ŒåŒ…æ‹¬Pythonï¼ŒPHPå’ŒJavaã€‚ </p><br><h2 id="kogda-eschyo-specifikaciya-okazyvaetsya-neveroyatno-poleznoy"> å½“è§„èŒƒéå¸¸æœ‰ç”¨æ—¶ </h2><br><h3 id="1-unit-testy-endpointov">  1.ç«¯ç‚¹çš„å•å…ƒæµ‹è¯• </h3><br><p>  <em>è¡Œä¸ºé©±åŠ¨å¼€å‘ï¼ˆBDDï¼‰æ˜¯</em>å¼€å‘REST APIçš„ç†æƒ³é€‰æ‹©ã€‚ ç¼–å†™å•å…ƒæµ‹è¯•çš„æœ€æ–¹ä¾¿æ–¹æ³•ä¸æ˜¯é’ˆå¯¹å•ä¸ªç±»ï¼Œæ¨¡å‹å’Œæ§åˆ¶å™¨ï¼Œè€Œæ˜¯é’ˆå¯¹ç‰¹å®šç«¯ç‚¹ã€‚ åœ¨æ¯ä¸ªæµ‹è¯•ä¸­ï¼Œæ‚¨éƒ½æ¨¡æ‹Ÿä¸€ä¸ªçœŸå®çš„HTTPè¯·æ±‚å¹¶æ£€æŸ¥æœåŠ¡å™¨å“åº”ã€‚ åœ¨Node.jsä¸­ï¼Œä¸ºäº†æ¨¡æ‹Ÿæµ‹è¯•è¯·æ±‚ï¼Œåœ¨Ruby on Rails- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">airborne</a>ä¸­æä¾›äº†<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">supertest</a>å’Œ<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=http://www.chaijs.com/plugins/chai-">chai-http</a> ã€‚ </p><br><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ª<code>User</code>æ¨¡å¼å’Œä¸€ä¸ªè¿”å›æ‰€æœ‰ç”¨æˆ·çš„<code>GET /users</code>ç«¯ç‚¹ã€‚ è¿™æ˜¯tinyspecè¯­æ³•ï¼Œå¯¹æ­¤è¿›è¡Œäº†æè¿°ï¼š </p><br><ol><li>  <em>User.models.tinyspec</em>æ–‡ä»¶ï¼š </li></ol><br><pre> <code class="python hljs">User {name, isAdmin: b, age?: i}</code> </pre> <br><ol><li> æ–‡ä»¶<em>users.endpoints.tinyspec</em> ï¼š </li></ol><br><pre> <code class="python hljs">GET /users =&gt; {users: User[]}</code> </pre> <br><p> è¿™æ˜¯æˆ‘ä»¬çš„æµ‹è¯•ç»“æœï¼š </p><br><h4 id="nodejs">  Node.js </h4><br><pre> <code class="javascript hljs">describe(<span class="hljs-string"><span class="hljs-string">'/users'</span></span>, () =&gt; { it(<span class="hljs-string"><span class="hljs-string">'List all users'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> () =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { status, <span class="hljs-attr"><span class="hljs-attr">body</span></span>: { users } } = request.get(<span class="hljs-string"><span class="hljs-string">'/users'</span></span>); expect(status).to.equal(<span class="hljs-number"><span class="hljs-number">200</span></span>); expect(users[<span class="hljs-number"><span class="hljs-number">0</span></span>].name).to.be(<span class="hljs-string"><span class="hljs-string">'string'</span></span>); expect(users[<span class="hljs-number"><span class="hljs-number">0</span></span>].isAdmin).to.be(<span class="hljs-string"><span class="hljs-string">'boolean'</span></span>); expect(users[<span class="hljs-number"><span class="hljs-number">0</span></span>].age).to.be.oneOf([<span class="hljs-string"><span class="hljs-string">'boolean'</span></span>, <span class="hljs-literal"><span class="hljs-literal">null</span></span>]); }); });</code> </pre> <br><h4 id="ruby-on-rails">  Ruby on Rails </h4><br><pre> <code class="ruby hljs">describe <span class="hljs-string"><span class="hljs-string">'GET /users'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> it <span class="hljs-string"><span class="hljs-string">'List all users'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> get <span class="hljs-string"><span class="hljs-string">'/users'</span></span> expect_status(<span class="hljs-number"><span class="hljs-number">200</span></span>) expect_json_types(<span class="hljs-string"><span class="hljs-string">'users.*'</span></span>, { <span class="hljs-symbol"><span class="hljs-symbol">name:</span></span> <span class="hljs-symbol"><span class="hljs-symbol">:string</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">isAdmin:</span></span> <span class="hljs-symbol"><span class="hljs-symbol">:boolean</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">age:</span></span> <span class="hljs-symbol"><span class="hljs-symbol">:integer_or_null</span></span>, }) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre> <br><p> å½“æˆ‘ä»¬æœ‰æè¿°æœåŠ¡å™¨å“åº”æ ¼å¼çš„è§„èŒƒæ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ç®€åŒ–æµ‹è¯•ï¼Œå¹¶ä»…<em>æ ¹æ®è¯¥è§„èŒƒæ£€æŸ¥å“åº”</em> ã€‚ ä¸ºæ­¤ï¼Œæˆ‘ä»¬å°†åˆ©ç”¨æˆ‘ä»¬çš„tinyspecæ¨¡å‹è¢«è½¬æ¢ä¸ºOpenAPIå®šä¹‰è¿™ä¸€äº‹å®ï¼Œè¯¥å®šä¹‰åˆå¯¹åº”äºJSON Schemaæ ¼å¼ã€‚ </p><br><p> å¯ä»¥æµ‹è¯•JSä¸­çš„ä»»ä½•<em>æ–‡å­—å¯¹è±¡</em> ï¼ˆæˆ–Rubyä¸­çš„<code>Hash</code> ï¼ŒPythonä¸­çš„<code>dict</code> ï¼ŒPHPä¸­<em>çš„å…³è”æ•°ç»„</em> ï¼Œç”šè‡³Javaä¸­çš„<code>Map</code> ï¼‰æ˜¯å¦ç¬¦åˆJSONæ–¹æ¡ˆã€‚ ç”šè‡³è¿˜æœ‰ç”¨äºæµ‹è¯•æ¡†æ¶çš„ç›¸åº”æ’ä»¶ï¼Œä¾‹å¦‚<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">RSpecçš„jest-ajv</a> ï¼ˆnpmï¼‰ï¼Œ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">chai-ajv-json-schema</a> ï¼ˆnpmï¼‰å’Œ<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">json_matchers</a> ï¼ˆrubygemï¼‰ã€‚ </p><br><p> ä½¿ç”¨æ–¹æ¡ˆä¹‹å‰ï¼Œå¿…é¡»å°†å®ƒä»¬è¿æ¥åˆ°é¡¹ç›®ã€‚ é¦–å…ˆï¼Œæˆ‘ä»¬å°†åŸºäºtinyspecç”Ÿæˆopenapi.jsonè§„èŒƒæ–‡ä»¶ï¼ˆæ­¤æ“ä½œå¯ä»¥åœ¨æ¯æ¬¡æµ‹è¯•è¿è¡Œä¹‹å‰è‡ªåŠ¨æ‰§è¡Œï¼‰ï¼š </p><br><pre> <code class="bash hljs">tinyspec -j -o openapi.json</code> </pre> <br><h4 id="nodejs-1">  Node.js </h4><br><p> ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨é¡¹ç›®ä¸­ä½¿ç”¨æ¥æ”¶åˆ°çš„JSONï¼Œå¹¶ä»ä¸­è·å–<code>definitions</code>é”®ï¼Œå…¶ä¸­åŒ…å«æ‰€æœ‰JSONæ–¹æ¡ˆã€‚ æ–¹æ¡ˆå¯ä»¥åŒ…å«äº¤å‰å¼•ç”¨ï¼ˆ <code>$ref</code> ï¼‰ï¼Œå› æ­¤ï¼Œå¦‚æœæˆ‘ä»¬æœ‰åµŒå¥—æ–¹æ¡ˆï¼ˆä¾‹å¦‚<code>Blog {posts: Post[]}</code> ï¼‰ï¼Œåˆ™éœ€è¦â€œæ‰©å±•â€å®ƒä»¬ä»¥ä¾¿åœ¨éªŒè¯ä¸­ä½¿ç”¨å®ƒä»¬ã€‚ ä¸ºæ­¤ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">json-schema-deref-sync</a> ï¼ˆnpmï¼‰ã€‚ </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> deref <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'json-schema-deref-sync'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> spec = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'./openapi.json'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> schemas = deref(spec).definitions; describe(<span class="hljs-string"><span class="hljs-string">'/users'</span></span>, () =&gt; { it(<span class="hljs-string"><span class="hljs-string">'List all users'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> () =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { status, <span class="hljs-attr"><span class="hljs-attr">body</span></span>: { users } } = request.get(<span class="hljs-string"><span class="hljs-string">'/users'</span></span>); expect(status).to.equal(<span class="hljs-number"><span class="hljs-number">200</span></span>); <span class="hljs-comment"><span class="hljs-comment">// Chai expect(users[0]).to.be.validWithSchema(schemas.User); // Jest expect(users[0]).toMatchSchema(schemas.User); }); });</span></span></code> </pre> <br><h4 id="ruby-on-rails-1">  Ruby on Rails </h4><br><p>  <code>json_matchers</code>å¯ä»¥å¤„ç†<code>$ref</code>é“¾æ¥ï¼Œä½†æ˜¯éœ€è¦ä»¥æŸç§æ–¹å¼åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­ä½¿ç”¨å¸¦æœ‰æ–¹æ¡ˆçš„å•ç‹¬æ–‡ä»¶ï¼Œå› æ­¤é¦–å…ˆæ‚¨å¿…é¡»å°†<code>swagger.json</code> â€œæ‹†åˆ†â€ä¸ºè®¸å¤šå°æ–‡ä»¶ï¼ˆæœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œè¯·<code>swagger.json</code> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ­¤å¤„</a> ï¼‰ï¼š </p><br><pre> <code class="ruby hljs"><span class="hljs-comment"><span class="hljs-comment"># ./spec/support/json_schemas.rb require 'json' require 'json_matchers/rspec' JsonMatchers.schema_root = 'spec/schemas' # Fix for json_matchers single-file restriction file = File.read 'spec/schemas/openapi.json' swagger = JSON.parse(file, symbolize_names: true) swagger[:definitions].keys.each do |key| File.open("spec/schemas/#{key}.json", 'w') do |f| f.write(JSON.pretty_generate({ '$ref': "swagger.json#/definitions/#{key}" })) end end</span></span></code> </pre> <br><p> ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·ç¼–å†™æµ‹è¯•ï¼š </p><br><pre> <code class="ruby hljs">describe <span class="hljs-string"><span class="hljs-string">'GET /users'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> it <span class="hljs-string"><span class="hljs-string">'List all users'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> get <span class="hljs-string"><span class="hljs-string">'/users'</span></span> expect_status(<span class="hljs-number"><span class="hljs-number">200</span></span>) expect(result[<span class="hljs-symbol"><span class="hljs-symbol">:users</span></span>][<span class="hljs-number"><span class="hljs-number">0</span></span>]).to match_json_schema(<span class="hljs-string"><span class="hljs-string">'User'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre> <br><p> æ³¨æ„ï¼šç”¨è¿™ç§æ–¹å¼ç¼–å†™æµ‹è¯•éå¸¸æ–¹ä¾¿ã€‚ ç‰¹åˆ«æ˜¯åœ¨æ‚¨çš„IDEæ”¯æŒè¿è¡Œæµ‹è¯•å’Œè°ƒè¯•ï¼ˆä¾‹å¦‚WebStormï¼ŒRubyMineå’ŒVisual Studioï¼‰çš„æƒ…å†µä¸‹ã€‚ å› æ­¤ï¼Œæ‚¨å®Œå…¨ä¸èƒ½ä½¿ç”¨ä»»ä½•å…¶ä»–è½¯ä»¶ï¼Œå¹¶ä¸”è¯¥APIçš„æ•´ä¸ªå¼€å‘å‘¨æœŸç¼©çŸ­ä¸º3ä¸ªè¿ç»­çš„æ­¥éª¤ï¼š </p><br><ol><li> è§„èŒƒè®¾è®¡ï¼ˆä¾‹å¦‚åœ¨tinyspecä¸­ï¼‰; </li><li> ä¸ºæ·»åŠ /æ›´æ”¹çš„ç«¯ç‚¹ç¼–å†™ä¸€å¥—å®Œæ•´çš„æµ‹è¯•ï¼› </li><li> å¼€å‘æ»¡è¶³æ‰€æœ‰æµ‹è¯•è¦æ±‚çš„ä»£ç ã€‚ </li></ol><br><h3 id="2-validaciya-vhodnyh-dannyh">  2.è¾“å…¥éªŒè¯ </h3><br><p>  OpenAPIä¸ä»…æè¿°äº†å“åº”çš„æ ¼å¼ï¼Œè€Œä¸”è¿˜æâ€‹â€‹è¿°äº†è¾“å…¥æ•°æ®çš„æ ¼å¼ã€‚ è¿™ä½¿æˆ‘ä»¬å¯ä»¥åœ¨è¯·æ±‚æœŸé—´<em>éªŒè¯</em>ä»ç”¨æˆ·æƒé™æ¥æ”¶<em>çš„æ•°æ®</em> ã€‚ </p><br><p> å‡è®¾æˆ‘ä»¬å…·æœ‰ä»¥ä¸‹æè¿°æ›´æ–°ç”¨æˆ·æ•°æ®ä»¥åŠæ‰€æœ‰å¯æ›´æ”¹å­—æ®µçš„è§„èŒƒï¼š </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># user.models.tinyspec UserUpdate !{name?, age?: i} # users.endpoints.tinyspec PATCH /users/:id {user: UserUpdate} =&gt; {success: b}</span></span></code> </pre> <br><p> ä¹‹å‰æˆ‘ä»¬çœ‹è¿‡æµ‹è¯•ä¸­ç”¨äºéªŒè¯çš„æ’ä»¶ï¼Œä½†æ˜¯å¯¹äºæ›´ä¸€èˆ¬çš„æƒ…å†µï¼Œæœ‰<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ajv</a> ï¼ˆnpmï¼‰å’Œ<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">json-schema</a> ï¼ˆrubygemï¼‰éªŒè¯æ¨¡å—ï¼Œè®©æˆ‘ä»¬ä½¿ç”¨å®ƒä»¬å¹¶ç¼–å†™ä¸€ä¸ªå¸¦æœ‰éªŒè¯çš„æ§åˆ¶å™¨ã€‚ </p><br><h4 id="nodejs-koa">  Node.jsï¼ˆKoaï¼‰ </h4><br><p> è¿™æ˜¯Expressçš„åç»§è€…<strong>Koaçš„</strong>ä¸€ä¸ªç¤ºä¾‹ï¼Œä½†æ˜¯å¯¹äºExpressï¼Œä»£ç å°†çœ‹èµ·æ¥ç›¸ä¼¼ã€‚ </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Router <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'koa-router'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Ajv <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'ajv'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { schemas } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./schemas'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> router = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Router(); <span class="hljs-comment"><span class="hljs-comment">// Standard resource update action in Koa. router.patch('/:id', async (ctx) =&gt; { const updateData = ctx.body.user; // Validation using JSON schema from API specification. await validate(schemas.UserUpdate, updateData); const user = await User.findById(ctx.params.id); await user.update(updateData); ctx.body = { success: true }; }); async function validate(schema, data) { const ajv = new Ajv(); if (!ajv.validate(schema, data)) { const err = new Error(); err.errors = ajv.errors; throw err; } }</span></span></code> </pre> <br><p> åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œå¦‚æœè¾“å…¥æ•°æ®ä¸ç¬¦åˆè§„èŒƒï¼Œåˆ™æœåŠ¡å™¨å°†å‘å®¢æˆ·ç«¯è¿”å›<code>500 Internal Server Error</code>å“åº”ã€‚ ä¸ºäº†é˜²æ­¢è¿™ç§æƒ…å†µçš„å‘ç”Ÿï¼Œæˆ‘ä»¬å¯ä»¥æ‹¦æˆªéªŒè¯å™¨é”™è¯¯å¹¶å½¢æˆè‡ªå·±çš„å“åº”ï¼Œè¯¥å“åº”å°†åŒ…å«æœ‰å…³å°šæœªé€šè¿‡æµ‹è¯•çš„ç‰¹å®šå­—æ®µçš„æ›´è¯¦ç»†ä¿¡æ¯ï¼Œå¹¶ä¸”è¿˜åº”<em>ç¬¦åˆè§„èŒƒ</em> ã€‚ </p><br><p> åœ¨<code>FieldsValidationError</code>æ–‡ä»¶ä¸­æ·»åŠ <code>FieldsValidationError</code>æ¨¡å‹çš„æè¿°ï¼š </p><br><pre> <code class="python hljs">Error {error: b, message} InvalidField {name, message} FieldsValidationError &lt; Error {fields: InvalidField[]}</code> </pre> <br><p> ç°åœ¨ï¼Œæˆ‘ä»¬å°†å…¶æŒ‡ç¤ºä¸ºç«¯ç‚¹çš„å¯èƒ½ç­”æ¡ˆä¹‹ä¸€ï¼š </p><br><pre> <code class="python hljs">PATCH /users/:id {user: UserUpdate} =&gt; <span class="hljs-number"><span class="hljs-number">200</span></span> {success: b} =&gt; <span class="hljs-number"><span class="hljs-number">422</span></span> FieldsValidationError</code> </pre> <br><p> è¿™ç§æ–¹æ³•å°†å…è®¸æ‚¨ç¼–å†™å•å…ƒæµ‹è¯•ï¼Œä»¥ä½¿ç”¨ä»å®¢æˆ·ç«¯æ¥æ”¶åˆ°çš„ä¸æ­£ç¡®æ•°æ®æ¥éªŒè¯é”™è¯¯å½¢æˆçš„æ­£ç¡®æ€§ã€‚ </p><br><h3 id="3-serializaciya-modeley">  3.æ¨¡å‹çš„åºåˆ—åŒ– </h3><br><p> å‡ ä¹æ‰€æœ‰ç°ä»£æœåŠ¡å™¨æ¡†æ¶éƒ½<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä»¥ä¸€ç§</a>æˆ–å¦<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä¸€ç§</a>æ–¹å¼ä½¿ç”¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ORM</a> ã€‚ è¿™æ„å‘³ç€ç³»ç»Ÿå†…éƒ¨APIä¸­ä½¿ç”¨çš„å¤§å¤šæ•°èµ„æºéƒ½ä»¥æ¨¡å‹ï¼Œå…¶å®ä¾‹å’Œé›†åˆçš„å½¢å¼å‘ˆç°ã€‚ </p><br><p> ç”Ÿæˆè¿™äº›å®ä½“çš„JSONè¡¨ç¤ºå½¢å¼ä»¥åœ¨APIå“åº”ä¸­ä¼ è¾“çš„è¿‡ç¨‹ç§°ä¸º<em>åºåˆ—åŒ–</em> ã€‚ æœ‰è®¸å¤šç”¨äºæ‰§è¡Œåºåˆ—åŒ–åŠŸèƒ½çš„ä¸åŒæ¡†æ¶çš„æ’ä»¶ï¼Œä¾‹å¦‚ï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">sequelize-to-json</a> ï¼ˆnpmï¼‰ï¼Œ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">acts_as_api</a> ï¼ˆrubygemï¼‰ï¼Œ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">jsonapi-rails</a> ï¼ˆrubygemï¼‰ã€‚ å®é™…ä¸Šï¼Œè¿™äº›æ’ä»¶å…è®¸ç‰¹å®šçš„æ¨¡å‹æŒ‡å®šå¿…é¡»åŒ…å«åœ¨JSONå¯¹è±¡ä¸­çš„å­—æ®µåˆ—è¡¨ä»¥åŠå…¶ä»–è§„åˆ™ï¼Œä¾‹å¦‚é‡å‘½åå®ƒä»¬æˆ–åŠ¨æ€è®¡ç®—å€¼ã€‚ </p><br><p> å½“æˆ‘ä»¬éœ€è¦ä½¿ç”¨åŒä¸€æ¨¡å‹çš„å‡ ç§ä¸åŒçš„JSONè¡¨ç¤ºå½¢å¼ï¼Œæˆ–è€…å½“ä¸€ä¸ªå¯¹è±¡åŒ…å«åµŒå¥—å®ä½“ï¼ˆå…³è”ï¼‰æ—¶ï¼Œå°±ä¼šå‡ºç°å›°éš¾ã€‚ éœ€è¦<em>ç»§æ‰¿ï¼Œé‡ç”¨å’Œé“¾æ¥åºåˆ—åŒ–ç¨‹åº</em> ã€‚ </p><br><p> ä¸åŒçš„æ¨¡å—ä»¥ä¸åŒçš„æ–¹å¼è§£å†³è¿™äº›é—®é¢˜ï¼Œä½†æ˜¯è®©æˆ‘ä»¬æƒ³æƒ³ï¼Œè§„èŒƒå¯ä»¥å†æ¬¡ä¸ºæˆ‘ä»¬æä¾›å¸®åŠ©å—ï¼Ÿ å®é™…ä¸Šï¼Œäº‹å®ä¸Šï¼Œæœ‰å…³JSONè¡¨ç¤ºçš„è¦æ±‚çš„æ‰€æœ‰ä¿¡æ¯ï¼Œæ‰€æœ‰å¯èƒ½çš„å­—æ®µç»„åˆï¼ˆåŒ…æ‹¬åµŒå¥—å®ä½“ï¼‰éƒ½å·²åŒ…å«åœ¨å…¶ä¸­ã€‚ å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ç¼–å†™ä¸€ä¸ªè‡ªåŠ¨åºåˆ—åŒ–å™¨ã€‚ </p><br><p> æˆ‘æè¯·æ‚¨æ³¨æ„ä¸€ä¸ªå°æ¨¡å—<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">sequelize-serialize</a> ï¼ˆnpmï¼‰ï¼Œå®ƒä½¿æ‚¨å¯ä»¥å¯¹Sequelizeæ¨¡å‹è¿›è¡Œæ­¤æ“ä½œã€‚ å®ƒé‡‡ç”¨æ¨¡å‹æˆ–æ•°ç»„çš„å®ä¾‹ä»¥åŠæ‰€éœ€çš„ç”µè·¯ï¼Œå¹¶è€ƒè™‘æ‰€æœ‰å¿…éœ€çš„å­—æ®µå¹¶ä¸ºå…³è”å®ä½“ä½¿ç”¨åµŒå¥—ç”µè·¯ï¼Œä»¥è¿­ä»£æ–¹å¼æ„é€ ä¸€ä¸ªåºåˆ—åŒ–å¯¹è±¡ã€‚ </p><br><p> å› æ­¤ï¼Œå‡è®¾æˆ‘ä»¬éœ€è¦ä»APIä¸­è¿”å›æ‰€æœ‰æ‹¥æœ‰åšå®¢å¸–å­çš„ç”¨æˆ·ï¼ŒåŒ…æ‹¬å¯¹è¿™äº›å¸–å­çš„è¯„è®ºã€‚ æˆ‘ä»¬ä½¿ç”¨ä»¥ä¸‹è§„èŒƒå¯¹æ­¤è¿›è¡Œæè¿°ï¼š </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># models.tinyspec Comment {authorId: i, message} Post {topic, message, comments?: Comment[]} User {name, isAdmin: b, age?: i} UserWithPosts &lt; User {posts: Post[]} # blogUsers.endpoints.tinyspec GET /blog/users =&gt; {users: UserWithPosts[]}</span></span></code> </pre> <br><p> ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨Sequelizeæ„å»ºæŸ¥è¯¢å¹¶è¿”å›ä¸ä¸Šè¿°è§„èŒƒå®Œå…¨åŒ¹é…çš„åºåˆ—åŒ–å¯¹è±¡ï¼š </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Router <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'koa-router'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> serialize <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'sequelize-serialize'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { schemas } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./schemas'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> router = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Router(); router.get(<span class="hljs-string"><span class="hljs-string">'/blog/users'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> (ctx) =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> users = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> User.findAll({ <span class="hljs-attr"><span class="hljs-attr">include</span></span>: [{ <span class="hljs-attr"><span class="hljs-attr">association</span></span>: User.posts, <span class="hljs-attr"><span class="hljs-attr">required</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">include</span></span>: [Post.comments] }] }); ctx.body = serialize(users, schemas.UserWithPosts); });</code> </pre> <br><p> å‡ ä¹æ˜¯é­”æœ¯ï¼Œå¯¹ä¸å¯¹ï¼Ÿ </p><br><h3 id="4-staticheskaya-tipizaciya">  4.é™æ€æ‰“å­— </h3><br><p> å¦‚æœæ‚¨å¤ªé…·äº†ï¼Œä»¥è‡³äºæ­£åœ¨ä½¿ç”¨TypeScriptæˆ–Flowï¼Œæ‚¨å¯èƒ½å·²ç»æƒ³çŸ¥é“ï¼Œ <em>â€œäº²çˆ±çš„é™æ€ç±»å‹å‘¢ï¼Ÿï¼â€</em>  ã€‚ ä½¿ç”¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">sw2dts</a>æˆ–<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">swagger-to-flowtypeæ¨¡å—ï¼Œ</a>æ‚¨å¯ä»¥åŸºäºJSONæ–¹æ¡ˆç”Ÿæˆæ‰€æœ‰å¿…è¦çš„å®šä¹‰ï¼Œå¹¶å°†å®ƒä»¬ç”¨äºæµ‹è¯•ï¼Œè¾“å…¥æ•°æ®å’Œåºåˆ—åŒ–ç¨‹åºçš„é™æ€ç±»å‹ã€‚ </p><br><pre> <code class="bash hljs">tinyspec -j sw2dts ./swagger.json -o Api.d.ts --namespace Api</code> </pre> <br><p> ç°åœ¨æˆ‘ä»¬å¯ä»¥åœ¨æ§åˆ¶å™¨ä¸­ä½¿ç”¨ç±»å‹ï¼š </p><br><pre> <code class="hljs pgsql">router.patch(<span class="hljs-string"><span class="hljs-string">'/users/:id'</span></span>, async (ctx) =&gt; { // Specify <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> request data <span class="hljs-keyword"><span class="hljs-keyword">object</span></span> const userData: Api.UserUpdate = ctx.request.body.<span class="hljs-keyword"><span class="hljs-keyword">user</span></span>; // Run spec validation await <span class="hljs-keyword"><span class="hljs-keyword">validate</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">schemas</span></span>.UserUpdate, userData); // Query the <span class="hljs-keyword"><span class="hljs-keyword">database</span></span> const <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> = await <span class="hljs-keyword"><span class="hljs-keyword">User</span></span>.findById(ctx.params.id); await <span class="hljs-keyword"><span class="hljs-keyword">user</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">update</span></span>(userData); // <span class="hljs-keyword"><span class="hljs-keyword">Return</span></span> serialized result const serialized: Api.<span class="hljs-keyword"><span class="hljs-keyword">User</span></span> = serialize(<span class="hljs-keyword"><span class="hljs-keyword">user</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">schemas</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">User</span></span>); ctx.body = { <span class="hljs-keyword"><span class="hljs-keyword">user</span></span>: serialized }; });</code> </pre> <br><p> åœ¨æµ‹è¯•ä¸­ï¼š </p><br><pre> <code class="hljs pgsql">it(<span class="hljs-string"><span class="hljs-string">'Update user'</span></span>, async () =&gt; { // Static <span class="hljs-keyword"><span class="hljs-keyword">check</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> test <span class="hljs-keyword"><span class="hljs-keyword">input</span></span> data. const updateData: Api.UserUpdate = { <span class="hljs-type"><span class="hljs-type">name</span></span>: MODIFIED }; const res = await request.patch(<span class="hljs-string"><span class="hljs-string">'/users/1'</span></span>, { <span class="hljs-keyword"><span class="hljs-keyword">user</span></span>: updateData }); // <span class="hljs-keyword"><span class="hljs-keyword">Type</span></span> helper <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> request response: const <span class="hljs-keyword"><span class="hljs-keyword">user</span></span>: Api.<span class="hljs-keyword"><span class="hljs-keyword">User</span></span> = res.body.<span class="hljs-keyword"><span class="hljs-keyword">user</span></span>; expect(<span class="hljs-keyword"><span class="hljs-keyword">user</span></span>).<span class="hljs-keyword"><span class="hljs-keyword">to</span></span>.be.validWithSchema(<span class="hljs-keyword"><span class="hljs-keyword">schemas</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">User</span></span>); expect(<span class="hljs-keyword"><span class="hljs-keyword">user</span></span>).<span class="hljs-keyword"><span class="hljs-keyword">to</span></span>.containSubset(updateData); });</code> </pre> <br><p> è¯·æ³¨æ„ï¼Œç”Ÿæˆçš„ç±»å‹å®šä¹‰ä¸ä»…å¯ä»¥åœ¨APIé¡¹ç›®æœ¬èº«ä¸­ä½¿ç”¨ï¼Œè€Œä¸”å¯ä»¥åœ¨å®¢æˆ·ç«¯åº”ç”¨ç¨‹åºé¡¹ç›®ä¸­ä½¿ç”¨ï¼Œä»¥æè¿°APIå·¥ä½œçš„åŠŸèƒ½ç±»å‹ã€‚  Angularå®¢æˆ·å¼€å‘äººå‘˜å°†å¯¹æ­¤ç¤¼ç‰©ç‰¹åˆ«æ»¡æ„ã€‚ </p><br><h3 id="5-privedenie-tipov-query-string">  5.æŸ¥è¯¢å­—ç¬¦ä¸²çš„ç±»å‹è½¬æ¢ </h3><br><p> å¦‚æœç”±äºæŸç§åŸå› æ‚¨çš„APIæ¥å—MIMEç±»å‹ä¸º<code>application/x-www-form-urlencoded</code>è€Œä¸æ˜¯<code>application/json</code>çš„è¯·æ±‚ï¼Œåˆ™è¯·æ±‚æ­£æ–‡å°†å¦‚ä¸‹æ‰€ç¤ºï¼š </p><br><pre> <code class="python hljs">param1=value&amp;param2=<span class="hljs-number"><span class="hljs-number">777</span></span>&amp;param3=false</code> </pre> <br><p> è¿™åŒæ ·é€‚ç”¨äºæŸ¥è¯¢å‚æ•°ï¼ˆä¾‹å¦‚ï¼Œåœ¨GETè¯·æ±‚ä¸­ï¼‰ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒWebæœåŠ¡å™¨å°†æ— æ³•è‡ªåŠ¨è¯†åˆ«ç±»å‹-æ‰€æœ‰æ•°æ®éƒ½å°†ä»¥å­—ç¬¦ä¸²å½¢å¼ï¼ˆ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è¿™æ˜¯</a> qpm npmæ¨¡å—å­˜å‚¨åº“ä¸­<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">çš„è®¨è®º</a> ï¼‰ï¼Œå› æ­¤åœ¨è§£æä¹‹åï¼Œæ‚¨å°†è·å¾—ä»¥ä¸‹å¯¹è±¡ï¼š </p><br><pre> <code class="python hljs">{ param1: <span class="hljs-string"><span class="hljs-string">'value'</span></span>, param2: <span class="hljs-string"><span class="hljs-string">'777'</span></span>, param3: <span class="hljs-string"><span class="hljs-string">'false'</span></span> }</code> </pre> <br><p> åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå°†ä¸ä¼šæ ¹æ®æ–¹æ¡ˆéªŒè¯è¯·æ±‚ï¼Œè¿™æ„å‘³ç€æœ‰å¿…è¦æ‰‹åŠ¨éªŒè¯æ¯ä¸ªå‚æ•°çš„æ ¼å¼æ­£ç¡®ï¼Œå¹¶å°†å…¶è½¬æ¢ä¸ºæ‰€éœ€çš„ç±»å‹ã€‚ </p><br><p> æ‚¨å¯èƒ½ä¼šçŒœåˆ°ï¼Œè¿™å¯ä»¥ä½¿ç”¨æˆ‘ä»¬è§„èŒƒä¸­æ‰€æœ‰ç›¸åŒçš„æ–¹æ¡ˆæ¥å®Œæˆã€‚ æƒ³è±¡ä¸€ä¸‹ï¼Œæˆ‘ä»¬æœ‰è¿™æ ·ä¸€ä¸ªç«¯ç‚¹å’Œæ–¹æ¡ˆï¼š </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># posts.endpoints.tinyspec GET /posts?PostsQuery # post.models.tinyspec PostsQuery { search, limit: i, offset: i, filter: { isRead: b } }</span></span></code> </pre> <br><p> è¿™æ˜¯å¯¹æ­¤ç±»ç«¯ç‚¹çš„è¯·æ±‚ç¤ºä¾‹ </p><br><pre> <code class="python hljs">GET /posts?search=needle&amp;offset=<span class="hljs-number"><span class="hljs-number">10</span></span>&amp;limit=<span class="hljs-number"><span class="hljs-number">1</span></span>&amp;filter[isRead]=true</code> </pre> <br><p> è®©æˆ‘ä»¬ç¼–å†™ä¸€ä¸ª<code>castQuery</code>å‡½æ•°ï¼Œå®ƒå°†æ‰€æœ‰å‚æ•°<code>castQuery</code>ä¸ºæˆ‘ä»¬æ‰€éœ€çš„ç±»å‹ã€‚ å®ƒçœ‹èµ·æ¥åƒè¿™æ ·ï¼š </p><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">castQuery</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">query, schema</span></span></span><span class="hljs-function">) </span></span>{ _.mapValues(query, (value, key) =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { type } = schema.properties[key] || {}; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!value || !type) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> value; } <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (type) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">'integer'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">parseInt</span></span>(value, <span class="hljs-number"><span class="hljs-number">10</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">'number'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">parseFloat</span></span>(value); <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">'boolean'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> value !== <span class="hljs-string"><span class="hljs-string">'false'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> value; } }); }</code> </pre> <br><p> å®ƒçš„æ›´å®Œæ•´çš„å®ç°æ”¯æŒåµŒå¥—æ¨¡å¼ï¼Œæ•°ç»„å’Œ<code>null</code>ç±»å‹ï¼Œå¯åœ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ¨¡å¼è½¬æ¢</a> ï¼ˆnpmï¼‰ä¸­ä½¿ç”¨ã€‚ ç°åœ¨æˆ‘ä»¬å¯ä»¥åœ¨ä»£ç ä¸­ä½¿ç”¨å®ƒï¼š </p><br><pre> <code class="javascript hljs">router.get(<span class="hljs-string"><span class="hljs-string">'/posts'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> (ctx) =&gt; { <span class="hljs-comment"><span class="hljs-comment">// Cast parameters to expected types const query = castQuery(ctx.query, schemas.PostsQuery); // Run spec validation await validate(schemas.PostsQuery, query); // Query the database const posts = await Post.search(query); // Return serialized result ctx.body = { posts: serialize(posts, schemas.Post) }; });</span></span></code> </pre> <br><p> æ³¨æ„ç«¯ç‚¹ä»£ç çš„å››è¡Œï¼Œä»¥åŠè§„èŒƒä¸­çš„ä¸‰ç§ä½¿ç”¨æ–¹æ¡ˆã€‚ </p><br><h2 id="luchshie-praktiki"> æœ€ä½³å®åŠ¡ </h2><br><h3 id="otdelnye-shemy-dlya-sozdaniya-i-izmeneniya"> ç”¨äºåˆ›å»ºå’Œä¿®æ”¹çš„å•ç‹¬æ–¹æ¡ˆ </h3><br><p> é€šå¸¸ï¼Œæè¿°æœåŠ¡å™¨å“åº”çš„æ–¹æ¡ˆä¸æè¿°ç”¨äºåˆ›å»ºå’Œä¿®æ”¹æ¨¡å‹çš„è¾“å…¥çš„æ–¹æ¡ˆä¸åŒã€‚ ä¾‹å¦‚ï¼Œåº”ä¸¥æ ¼é™åˆ¶<code>POST</code>å’Œ<code>PATCH</code>è¯·æ±‚çš„å¯ç”¨å­—æ®µåˆ—è¡¨ï¼Œè€Œåœ¨<code>PATCH</code>è¯·æ±‚ä¸­ï¼Œé€šå¸¸å°†æ–¹æ¡ˆçš„æ‰€æœ‰å­—æ®µéƒ½è®¾ä¸ºå¯é€‰ã€‚ ç¡®å®šç­”æ¡ˆçš„æ–¹æ¡ˆå¯èƒ½æ›´å…è´¹ã€‚ </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">tinyspec CRUDL</a>ç«¯ç‚¹çš„è‡ªåŠ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ç”Ÿæˆ</a>ä½¿ç”¨â€œ <code>New</code>å’Œâ€œ <code>Update</code>åç¼€ã€‚  <code>User*</code>å¯ä»¥å®šä¹‰å¦‚ä¸‹ï¼š </p><br><pre> <code class="python hljs">User {id, email, name, isAdmin: b} UserNew !{email, name} UserUpdate !{email?, name?}</code> </pre> <br><p> å°½é‡ä¸è¦å¯¹ä¸åŒç±»å‹çš„æ“ä½œä½¿ç”¨ç›¸åŒçš„æ–¹æ¡ˆï¼Œä»¥é¿å…ç”±äºé‡ç”¨æˆ–ç»§æ‰¿æ—§æ–¹æ¡ˆè€Œå¯¼è‡´æ„å¤–çš„å®‰å…¨é—®é¢˜ã€‚ </p><br><h3 id="semantika-v-nazvaniyah-shem"> æ¨¡å¼åç§°ä¸­çš„è¯­ä¹‰ </h3><br><p> åŒä¸€æ¨¡å‹çš„å†…å®¹å¯èƒ½åœ¨ä¸åŒçš„ç«¯ç‚¹ä¸­æœ‰æ‰€ä¸åŒã€‚ åœ¨æ¶æ„åç§°ä¸­ä½¿ç”¨<code>With*</code>å’Œ<code>For*</code>åç¼€ä»¥æ˜¾ç¤ºå®ƒä»¬ä¹‹é—´çš„åŒºåˆ«ä»¥åŠå®ƒä»¬çš„ç”¨é€”ã€‚ åœ¨tinyspecæ¨¡å‹ä¸­ï¼Œæ¨¡å‹ä¹Ÿå¯ä»¥å½¼æ­¤ç»§æ‰¿ã€‚ ä¾‹å¦‚ï¼š </p><br><pre> <code class="python hljs">User {name, surname} UserWithPhotos &lt; User {photos: Photo[]} UserForAdmin &lt; User {id, email, lastLoginAt: d}</code> </pre> <br><p> åç¼€å¯ä»¥æ›´æ”¹å¹¶ç»„åˆã€‚ æœ€ä¸»è¦çš„æ˜¯ï¼Œå®ƒä»¬çš„åç§°åæ˜ äº†æœ¬è´¨ï¼Œå¹¶ç®€åŒ–äº†å¯¹æ–‡æ¡£çš„ç†Ÿæ‚‰ã€‚ </p><br><h3 id="razdelenie-endpointov-po-tipu-klienta"> æŒ‰å®¢æˆ·ç«¯ç±»å‹åˆ†éš”ç«¯ç‚¹ </h3><br><p> é€šå¸¸ï¼Œæ ¹æ®å®¢æˆ·ç«¯çš„ç±»å‹æˆ–è®¿é—®ç«¯ç‚¹çš„ç”¨æˆ·è§’è‰²ï¼Œç›¸åŒçš„ç«¯ç‚¹ä¼šè¿”å›ä¸åŒçš„æ•°æ®ã€‚ ä¾‹å¦‚ï¼Œå¯¹äºæ‚¨çš„ç§»åŠ¨åº”ç”¨ç¨‹åºçš„ç”¨æˆ·å’Œåå°ç®¡ç†äººå‘˜ï¼Œ <code>GET /users</code>å’Œ<code>GET /messages</code>çš„ç«¯ç‚¹å¯èƒ½ä¼šéå¸¸ä¸åŒã€‚ åŒæ—¶ï¼Œæ›´æ”¹ç«¯ç‚¹æœ¬èº«çš„åç§°å¯èƒ½ä¼šéå¸¸å¤æ‚ã€‚ </p><br><p> è¦å¤šæ¬¡æè¿°åŒä¸€ç«¯ç‚¹ï¼Œå¯ä»¥åœ¨è·¯å¾„åçš„æ–¹æ‹¬å·ä¸­æ·»åŠ å…¶ç±»å‹ã€‚ æ­¤å¤–ï¼Œä½¿ç”¨æ ‡ç­¾å¾ˆæœ‰ç”¨ï¼šè¿™å°†æœ‰åŠ©äºå°†ç«¯ç‚¹çš„æ–‡æ¡£åˆ†ä¸ºå‡ ç»„ï¼Œæ¯ç»„å°†é’ˆå¯¹APIçš„ç‰¹å®šå®¢æˆ·ç«¯ç»„è€Œè®¾è®¡ã€‚ ä¾‹å¦‚ï¼š </p><br><pre> <code class="python hljs">Mobile app: GET /users (mobile) =&gt; UserForMobile[] CRM admin panel: GET /users (admin) =&gt; UserForAdmin[]</code> </pre> <br><h2 id="dokumentaciya-rest-api">  REST APIæ–‡æ¡£ </h2><br><p> ä¸€æ—¦æœ‰äº†tinyspecæˆ–OpenAPIæ ¼å¼çš„è§„èŒƒï¼Œå°±å¯ä»¥ä½¿ç”¨HTMLç”Ÿæˆæ¼‚äº®çš„æ–‡æ¡£ï¼Œå¹¶å°†å…¶å‘å¸ƒç»™ä½¿ç”¨APIâ€‹â€‹çš„å¼€å‘äººå‘˜ã€‚ </p><br><p> é™¤äº†å‰é¢æåˆ°çš„äº‘æœåŠ¡ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€äº›CLIå·¥å…·å¯å°†OpenAPI 2.0è½¬æ¢ä¸ºHTMLå’ŒPDFï¼Œä¹‹åæ‚¨å¯ä»¥å°†å…¶ä¸‹è½½åˆ°ä»»ä½•é™æ€ä¸»æœºã€‚ èŒƒä¾‹ï¼š </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">bootprint-openapi</a> ï¼ˆnpmï¼Œåœ¨tinyspecä¸­é»˜è®¤ä½¿ç”¨ï¼‰ </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">swagger2markup-cli</a> ï¼ˆjarï¼Œæœ‰<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä¸€ä¸ªuseçš„ç¤ºä¾‹</a> ï¼Œå®ƒå°†åœ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">tinyspec Cloudä¸­ä½¿ç”¨</a> ï¼‰ </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">redoc-cli</a> ï¼ˆnpmï¼‰ </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ç»´å¾·æ¬£</a> ï¼ˆnpmï¼‰ </li></ul><br><p>  <em>æ‚¨çŸ¥é“æ›´å¤šç¤ºä¾‹å—ï¼Ÿ</em>  <em>åœ¨è¯„è®ºä¸­åˆ†äº«å®ƒä»¬ã€‚</em> </p><br><p> ä¸å¹¸çš„æ˜¯ï¼Œä¸€å¹´å‰å‘å¸ƒçš„OpenAPI 3.0ä»ç„¶å¾—ä¸åˆ°å¾ˆå¥½çš„æ”¯æŒï¼Œæˆ‘æ‰¾ä¸åˆ°åŸºäºå®ƒçš„æœ‰ä»·å€¼çš„æ–‡æ¡£ç¤ºä¾‹ï¼šæ— è®ºæ˜¯åœ¨äº‘è§£å†³æ–¹æ¡ˆä¸­ï¼Œè¿˜æ˜¯åœ¨CLIå·¥å…·ä¸­ã€‚ ç”±äºç›¸åŒçš„åŸå› ï¼Œtinyspecä¸­å°šä¸æ”¯æŒOpenAPI 3.0ã€‚ </p><br><h3 id="publikaciya-v-github"> å‘å¸ƒåˆ°GitHub </h3><br><p> å‘å¸ƒæ–‡æ¡£æœ€ç®€å•çš„æ–¹æ³•ä¹‹ä¸€æ˜¯<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">GitHub Pages</a> ã€‚ åªéœ€åœ¨å­˜å‚¨åº“è®¾ç½®ä¸­ä¸º<code>/docs</code>ç›®å½•å¯ç”¨é™æ€é¡µé¢æ”¯æŒï¼Œå¹¶å°†HTMLæ–‡æ¡£å­˜å‚¨åœ¨æ­¤æ–‡ä»¶å¤¹ä¸­ã€‚ </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/09b/5ad/775/09b5ad7757239f4405cb370cb59c6a7b.png"></p><br><p> æ‚¨å¯ä»¥åœ¨<code>package.json</code> <code>scripts</code>ä¸­æ·»åŠ å‘½ä»¤é€šè¿‡tinyspecæˆ–å¦ä¸€ä¸ªCLIå·¥å…·ç”Ÿæˆæ–‡æ¡£ï¼Œå¹¶åœ¨æ¯æ¬¡æäº¤æ—¶æ›´æ–°æ–‡æ¡£ï¼š </p><br><pre> <code class="javascript hljs"><span class="hljs-string"><span class="hljs-string">"scripts"</span></span>: { <span class="hljs-string"><span class="hljs-string">"docs"</span></span>: <span class="hljs-string"><span class="hljs-string">"tinyspec -h -o docs/"</span></span>, <span class="hljs-string"><span class="hljs-string">"precommit"</span></span>: <span class="hljs-string"><span class="hljs-string">"npm run docs"</span></span> }</code> </pre> <br><h3 id="continuous-integration"> æŒç»­æ•´åˆ </h3><br><p> æ‚¨å¯ä»¥åœ¨CIå‘¨æœŸä¸­åŒ…å«æ–‡æ¡£ç”Ÿæˆå¹¶å°†å…¶å‘å¸ƒï¼Œä¾‹å¦‚ï¼Œæ ¹æ®ç¯å¢ƒæˆ–APIç‰ˆæœ¬åœ¨ä¸åŒåœ°å€ä¸‹çš„Amazon S3ä¸­å‘å¸ƒï¼Œä¾‹å¦‚ï¼š <code>/docs/2.0</code> <code>/docs/stable</code> <code>/docs/2.0</code> ï¼Œ <code>/docs/staging</code> ã€‚ </p><br><h3 id="tinyspec-cloud">  Tinyspecäº‘ </h3><br><p> å¦‚æœæ‚¨å–œæ¬¢tinyspecè¯­æ³•ï¼Œåˆ™å¯ä»¥åœ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">tinyspec.cloudä¸Š</a>æ³¨å†Œä¸ºæ—©æœŸé‡‡ç”¨è€…ã€‚ æˆ‘ä»¬å°†åœ¨å…¶åŸºç¡€ä¸Šæ„å»ºäº‘æœåŠ¡å’ŒCLIï¼Œä»¥è‡ªåŠ¨å‘å¸ƒå…·æœ‰å¤šç§æ¨¡æ¿çš„æ–‡æ¡£ï¼Œå¹¶å…·æœ‰å¼€å‘è‡ªå·±çš„æ¨¡æ¿çš„èƒ½åŠ›ã€‚ </p><br><h2 id="zaklyuchenie"> ç»“è®º </h2><br><p> å¼€å‘REST APIå¯èƒ½æ˜¯åœ¨ç°ä»£Webå’Œç§»åŠ¨æœåŠ¡ä¸Šå·¥ä½œçš„è¿‡ç¨‹ä¸­æœ€æœ‰è¶£çš„æ´»åŠ¨ã€‚ æ²¡æœ‰æµè§ˆå™¨ï¼Œæ“ä½œç³»ç»Ÿå’Œå±å¹•å°ºå¯¸çš„åŠ¨ç‰©å›­ï¼Œä¸€åˆ‡éƒ½åœ¨æˆ‘ä»¬çš„æ§åˆ¶ä¹‹ä¸‹-â€œå”¾æ‰‹å¯å¾—â€ã€‚ </p><br><p> åŒæ—¶æä¾›å„ç§è‡ªåŠ¨åŒ–å½¢å¼æ¥ä¿æŒå½“å‰çš„è§„æ ¼å’Œå¥–é‡‘ï¼Œä½¿æ­¤è¿‡ç¨‹å˜å¾—æ›´åŠ ä»¤äººæ„‰æ‚¦ã€‚ è¿™æ ·çš„APIå˜å¾—ç»“æ„åŒ–ï¼Œé€æ˜å’Œå¯é ã€‚ </p><br><p>  <em>ç¡®å®ï¼Œå®é™…ä¸Šï¼Œå³ä½¿æˆ‘ä»¬ä»äº‹ç¥è¯çš„åˆ›é€ ï¼Œä½†ä¸ºä»€ä¹ˆæˆ‘ä»¬ä¸ä½¿å®ƒå˜å¾—ç¾ä¸½å‘¢ï¼Ÿ</em> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN427601/">https://habr.com/ru/post/zh-CN427601/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN427587/index.html">Javaé›†ä¸­ä¾›ä¸€åƒäº”ç™¾äººä½¿ç”¨ã€‚ Joker 2018æ€ä¹ˆæ ·</a></li>
<li><a href="../zh-CN427589/index.html">æˆ‘ä»¬ä½¿ç”¨Swooleåœ¨Websocketsä¸Šè¿›è¡Œåœ¨çº¿èŠå¤©</a></li>
<li><a href="../zh-CN427591/index.html">å»ºç­‘æˆä¸ºè´Ÿæ‹…</a></li>
<li><a href="../zh-CN427593/index.html">Vivaldi 2.1ä¸­çš„å¿«é€Ÿå‘½ä»¤é­”æœ¯</a></li>
<li><a href="../zh-CN427595/index.html">å°è¯•Micronautæˆ–Darlingï¼Œæˆ‘ç®€åŒ–äº†æ¡†æ¶</a></li>
<li><a href="../zh-CN427603/index.html">å¦‚ä½•æœ€ç»ˆå¼€å§‹ç¼–å†™æµ‹è¯•è€Œä¸åæ‚”</a></li>
<li><a href="../zh-CN427605/index.html">Yandexä¼—åŒ…å¹³å°å¦‚ä½•å¸®åŠ©åŸ¹è®­æ— äººæœºå¹¶è¯„ä¼°æœåŠ¡è´¨é‡</a></li>
<li><a href="../zh-CN427607/index.html">ç‘å£«çš„æ•°æ®ä¸­å¿ƒï¼šåƒå‘æ¡ä¸€æ ·å·¥ä½œ</a></li>
<li><a href="../zh-CN427609/index.html">åœ¨æ²¡æœ‰è›®åŠ›çš„æƒ…å†µä¸‹ç”¨æ•´æ•°é™¤æ³•æ±‚è§£æ–¹ç¨‹</a></li>
<li><a href="../zh-CN427611/index.html">æˆ‘å¦‚ä½•åœ¨iOSæˆ–åœ°å›¾ï¼Œé‡‘é’±ï¼Œ2ä¸ªMappitsä¸Šæ›´æ–°Yandex MapKitçš„æ•…äº‹</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>