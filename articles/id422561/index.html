<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ“‘ ğŸ‘¨ğŸ¿â€ğŸš’ âœ‹ğŸ¾ Bagaimana Yandex menerapkan visi komputer untuk meningkatkan kualitas siaran video. Teknologi DeepHD ğŸ¬ ğŸ‘® ğŸ—‘ï¸</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ketika orang mencari gambar atau video di Internet, mereka sering menambahkan frasa "berkualitas baik." Kualitas biasanya mengacu pada resolusi - peng...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Bagaimana Yandex menerapkan visi komputer untuk meningkatkan kualitas siaran video. Teknologi DeepHD</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yandex/blog/422561/">  Ketika orang mencari gambar atau video di Internet, mereka sering menambahkan frasa "berkualitas baik."  Kualitas biasanya mengacu pada resolusi - pengguna ingin gambar menjadi besar dan pada saat yang sama terlihat bagus di layar komputer modern, smartphone atau TV.  Tetapi bagaimana jika sumber dalam kualitas yang baik tidak ada? <br><br>  Hari ini kami akan memberi tahu pembaca Habr tentang bagaimana, dengan bantuan jaringan saraf, kami dapat meningkatkan resolusi video secara real time.  Anda juga akan belajar bagaimana pendekatan teoretis untuk menyelesaikan masalah ini berbeda dari yang praktis.  Jika Anda tidak tertarik dengan perincian teknis, maka Anda dapat dengan aman menelusuri pos - pada akhirnya Anda akan menemukan contoh pekerjaan kami. <br><br><img width="800" src="https://habrastorage.org/webt/hx/lu/ak/hxluakxdy2mxmmskebqieei5zq4.png"><br><br>  Ada banyak konten video di Internet dalam kualitas dan resolusi rendah.  Ini bisa berupa film yang direkam beberapa dekade yang lalu, atau menyiarkan saluran TV, yang karena berbagai alasan tidak dalam kualitas terbaik.  Saat pengguna merentangkan video seperti itu ke layar penuh, gambar menjadi keruh dan kabur.  Solusi ideal untuk film-film lama adalah menemukan film aslinya, memindai dengan peralatan modern dan mengembalikannya secara manual, tetapi ini tidak selalu memungkinkan.  Siaran masih lebih rumit - mereka harus diproses secara langsung.  Dalam hal ini, opsi yang paling dapat diterima bagi kita untuk bekerja adalah meningkatkan resolusi dan membersihkan artefak menggunakan teknologi visi komputer. <br><br><a name="habracut"></a>  Dalam industri ini, tugas meningkatkan gambar dan video tanpa kehilangan kualitas disebut istilah super-resolusi.  Banyak artikel telah ditulis tentang topik ini, tetapi kenyataan dari aplikasi "pertarungan" ternyata jauh lebih rumit dan menarik.  Secara singkat tentang masalah utama yang harus kami pecahkan dalam teknologi DeepHD kami sendiri: <br><br><ul><li>  Anda harus dapat mengembalikan detail yang tidak ada di video asli karena resolusi dan kualitasnya yang rendah, untuk "menyelesaikannya". </li><li>  Solusi dari area super-resolusi mengembalikan detail, tetapi mereka membuat jelas dan terperinci tidak hanya objek dalam video, tetapi juga artefak kompresi, yang menyebabkan ketidaksukaan bagi penonton. </li><li> Ada masalah dengan pengumpulan sampel pelatihan - sejumlah besar pasangan diperlukan di mana video yang sama hadir dalam resolusi dan kualitas rendah, dan dalam tinggi.  Pada kenyataannya, biasanya tidak ada pasangan berkualitas untuk konten yang buruk. </li><li>  Solusinya harus bekerja secara real time. </li></ul><br><h3>  Pemilihan teknologi </h3><br>  Dalam beberapa tahun terakhir, penggunaan jaringan saraf telah menyebabkan keberhasilan yang signifikan dalam menyelesaikan hampir semua tugas penglihatan komputer, dan tugas super-resolusi tidak terkecuali.  Kami menemukan solusi paling menjanjikan berdasarkan GAN (Generative Adversarial Networks, generative networks saingan).  Mereka memungkinkan Anda untuk mendapatkan gambar fotorealistik definisi tinggi, melengkapi mereka dengan detail yang hilang, misalnya, menggambar rambut dan bulu mata pada gambar orang. <br><br><img src="https://habrastorage.org/webt/gq/hl/kz/gqhlkzdwwmq3ad9p78j7wapfhzs.png"><br><br>  Dalam kasus paling sederhana, jaringan saraf terdiri dari dua bagian.  Bagian pertama - generator - mengambil gambar input dan mengembalikan pembesaran dua kali lipat.  Bagian kedua - pembeda - menerima gambar yang dihasilkan dan "nyata" sebagai input, dan mencoba membedakannya satu sama lain. <br><br><img width="700" src="https://habrastorage.org/webt/kn/3s/sc/kn3sscgtqtwqzcnga59cwaor-8y.png"><br><br><h3>  Persiapan pelatihan </h3><br>  Untuk pelatihan, kami telah mengumpulkan puluhan klip dalam kualitas UltraHD.  Pertama, kami menguranginya menjadi resolusi 1080p, sehingga mendapatkan contoh referensi.  Lalu kami membagi dua video-video ini, mengompresnya pada bitrate berbeda sepanjang jalan untuk mendapatkan sesuatu yang mirip dengan video nyata dalam kualitas rendah.  Kami membagi video yang dihasilkan menjadi bingkai dan menggunakannya sedemikian rupa untuk melatih jaringan saraf. <br><br><h3>  Deblocking </h3><br>  Tentu saja, kami ingin mendapatkan solusi ujung ke ujung: untuk melatih jaringan saraf untuk menghasilkan video resolusi tinggi dan kualitas langsung dari aslinya.  Namun, GAN ternyata sangat berubah-ubah dan terus-menerus mencoba untuk memperbaiki artefak kompresi, daripada menghilangkannya.  Karena itu, saya harus memecah proses menjadi beberapa tahap.  Yang pertama adalah penindasan artefak kompresi video, juga dikenal sebagai deblocking. <br><br>  Contoh salah satu metode rilis: <br><br><img src="https://habrastorage.org/webt/0c/sg/zx/0csgzx4zwbtceyujcgcay4mclac.jpeg"><br><br>  Pada tahap ini, kami meminimalkan deviasi standar antara frame yang dihasilkan dan yang asli.  Jadi, meskipun kami meningkatkan resolusi gambar, kami tidak mendapatkan peningkatan nyata dalam resolusi karena regresi ke rata-rata: jaringan saraf, tidak tahu di mana piksel tertentu perbatasan tertentu dalam gambar dilewati, dipaksa untuk rata-rata beberapa opsi, mendapatkan hasil yang buram.  Hal utama yang kami capai pada tahap ini adalah penghapusan artefak kompresi video, sehingga jaringan generatif pada tahap berikutnya hanya diperlukan untuk meningkatkan kejelasan dan menambahkan detail kecil yang hilang, tekstur.  Setelah ratusan percobaan, kami memilih arsitektur yang optimal dalam hal kinerja dan kualitas, samar-samar mengingatkan pada arsitektur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">DRCN</a> : <br><br><img width="800" src="https://habrastorage.org/webt/oq/au/pc/oqaupcp8k9m4rdspvx8rrrbhpy0.png"><br><br>  Ide utama dari arsitektur semacam itu adalah keinginan untuk mendapatkan arsitektur yang paling dalam, sementara tidak mengalami masalah dengan konvergensi dalam pelatihannya.  Di satu sisi, setiap lapisan konvolusional berikutnya mengekstraksi fitur gambar input yang lebih dan lebih kompleks, yang memungkinkan Anda untuk menentukan objek seperti apa pada titik tertentu dalam gambar dan mengembalikan bagian yang kompleks dan rusak parah.  Di sisi lain, jarak dalam grafik jaringan saraf dari salah satu lapisannya ke pintu keluar tetap kecil, yang meningkatkan konvergensi jaringan saraf dan memungkinkan untuk menggunakan sejumlah besar lapisan. <br><br><h3>  Pelatihan Jaringan Generatif </h3><br>  Kami mengambil arsitektur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">SRGAN sebagai</a> dasar jaringan saraf untuk meningkatkan resolusi.  Sebelum melatih jaringan kompetitif, Anda perlu melatih generator - melatihnya dengan cara yang sama seperti pada tahap deblocking.  Kalau tidak, pada awal pelatihan, generator hanya akan menghasilkan suara, pembeda akan segera mulai "menang" - ia akan dengan mudah belajar membedakan suara dari bingkai asli, dan tidak ada pelatihan yang akan berhasil. <br><br><img width="800" src="https://habrastorage.org/webt/tx/pb/r-/txpbr-pwdisdcwj62mrd6h4wuxm.png"><br><br>  Kemudian kami melatih GAN, tetapi ada beberapa nuansa.  Penting bagi kita bahwa generator tidak hanya menciptakan bingkai fotorealistik, tetapi juga menyimpan informasi yang tersedia pada mereka.  Untuk melakukan ini, kami menambahkan fungsi kehilangan konten ke arsitektur GAN klasik.  Ini mewakili beberapa lapisan jaringan saraf VGG19 yang dilatih pada dataset ImageNet standar.  Lapisan-lapisan ini mengubah gambar menjadi peta fitur yang berisi informasi tentang isi gambar.  Fungsi kehilangan meminimalkan jarak antara kartu-kartu tersebut yang diperoleh dari frame asli dan yang dihasilkan.  Juga, kehadiran fungsi kerugian seperti itu memungkinkan untuk tidak merusak generator pada langkah-langkah pertama pelatihan, ketika pembeda belum dilatih dan memberikan informasi yang tidak berguna. <br><br><img width="800" src="https://habrastorage.org/webt/d7/5p/uu/d75puuaa6jqsy6wmvknjqo-hh84.png"><br><br><h3>  Akselerasi jaringan saraf </h3><br>  Semuanya berjalan dengan baik, dan setelah serangkaian percobaan, kami mendapatkan model yang bagus yang sudah bisa diterapkan pada film-film lama.  Namun, masih terlalu lambat untuk memproses video streaming.  Ternyata tidak mungkin hanya mengurangi generator tanpa kehilangan yang signifikan dalam kualitas model akhir.  Kemudian pendekatan penyulingan pengetahuan datang membantu kami.  Metode ini melibatkan pelatihan model yang lebih ringan sehingga mengulangi hasil yang lebih berat.  Kami mengambil banyak video nyata dalam kualitas rendah, memprosesnya dengan jaringan saraf generatif yang diperoleh pada langkah sebelumnya, dan melatih jaringan yang lebih ringan untuk mendapatkan hasil yang sama dari frame yang sama.  Karena teknik ini, kami mendapatkan jaringan yang kualitasnya tidak kalah dengan aslinya, tetapi sepuluh kali lebih cepat daripada itu: untuk memproses satu saluran TV dalam resolusi 576p, diperlukan satu kartu NVIDIA Tesla V100. <br><br><img width="800" src="https://habrastorage.org/webt/15/b3/eg/15b3eguc_ikkl-fdaclwdsga2ka.png"><br><br><h3>  Penilaian kualitas solusi </h3><br>  Mungkin saat yang paling sulit ketika bekerja dengan jaringan generatif adalah penilaian kualitas model yang dihasilkan.  Tidak ada fungsi kesalahan yang jelas, seperti, misalnya, ketika menyelesaikan masalah klasifikasi.  Alih-alih, kami hanya mengetahui keakuratan pembeda, yang tidak mencerminkan kualitas generator yang menarik minat kami (pembaca yang terbiasa dengan bidang ini dapat menyarankan penggunaan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">metrik Wasserstein</a> , tetapi, sayangnya, hasilnya jauh lebih buruk). <br><br>  Orang-orang membantu kami memecahkan masalah ini.  Kami menunjukkan kepada pengguna pasangan layanan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Yandex.Tolok</a> dari pasangan gambar, salah satunya adalah sumber satu dan yang lainnya diproses oleh jaringan saraf, atau keduanya diproses oleh versi berbeda dari solusi kami.  Untuk biaya, pengguna memilih video yang lebih baik dari pasangan, jadi kami mendapat perbandingan versi yang signifikan secara statistik bahkan dengan perubahan yang sulit dilihat dengan mata.  Model akhir kami menang di lebih dari 70% kasus, yang cukup banyak, mengingat pengguna hanya menghabiskan beberapa detik untuk memberi peringkat pada beberapa video. <br><br>  Hasil yang menarik juga adalah fakta bahwa video dalam resolusi 576p, meningkat oleh teknologi DeepHD menjadi 720p, mengungguli video asli yang sama dengan resolusi 720p dalam 60% kasus - mis.  Memproses tidak hanya meningkatkan resolusi video, tetapi juga meningkatkan persepsi visualnya. <br><br><h3>  Contohnya </h3><br>  Pada musim semi, kami menguji teknologi DeepHD pada beberapa film lama yang dapat ditonton di KinoPoisk: " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Rainbow</a> " oleh Mark Donskoy (1943), " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Cranes are Flying</a> " oleh Mikhail Kalatozov (1957), " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">My Dear Man</a> " oleh Joseph Kheifits (1958), " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">The Fate of Man</a> " Sergei Bondarchuk (1959), " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Ivan Childhood</a> " oleh Andrei Tarkovsky (1962), " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Father of a Soldier</a> " Rezo Chkheidze (1964) dan " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Tango of Our Childhood</a> " oleh Albert Mkrtchyan (1985). <br><br><img width="800" src="https://habrastorage.org/webt/zh/un/-d/zhun-dugkeykn9bmodmrgrjfxma.png"><br><br>  Perbedaan antara versi sebelum dan sesudah pemrosesan terutama terlihat jika Anda mengintip detail: pelajari ekspresi wajah para pahlawan secara close-up, pertimbangkan tekstur pakaian atau pola kain.  Dimungkinkan untuk mengkompensasi beberapa kekurangan digitalisasi: misalnya, untuk menghilangkan eksposur berlebih pada wajah atau untuk membuat objek yang ditempatkan di tempat teduh lebih terlihat. <br><br>  Kemudian, teknologi DeepHD mulai digunakan untuk meningkatkan kualitas siaran <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">beberapa</a> saluran di layanan Yandex.Air.  Mengenali konten seperti itu mudah dilakukan dengan tag <b>dHD</b> . <br><br>  Sekarang <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">di Yandex</a> dalam kualitas yang ditingkatkan, Anda dapat menonton "Ratu Salju", "Musisi Kota Bremen", "Antelope Emas" dan kartun populer lainnya dari studio film Soyuzmultfilm.  Beberapa contoh dalam dinamika dapat dilihat dalam video: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/ainlhiNn0Yk" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Bagi pemirsa yang menuntut, perbedaannya akan sangat mencolok: gambarnya menjadi lebih tajam, dedaunan pohon, kepingan salju, bintang di langit malam di atas hutan dan detail kecil lainnya lebih terlihat. <br><br>  Lebih banyak lebih. <br><br><h3>  Tautan yang bermanfaat </h3><br>  Jiwon Kim, Jung Kwon Lee, Kyoung Mu Lee Jaringan Konvolusional yang Sangat Rekursif untuk Gambar Super-Resolusi [ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">arXiv: 1511.04491</a> ]. <br><br>  Christian Ledig et al.  Foto-Realistis Gambar Tunggal Resolusi Super Menggunakan Jaringan Adversarial Generatif [ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">arXiv: 1609.04802</a> ]. <br><br>  Mehdi SM Sajjadi, Bernhard SchÃ¶lkopf, Michael Hirsch EnhanceNet: Resolusi Super Gambar Tunggal Melalui Sintesis Tekstur Otomatis [ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">arXiv: 1612.07919</a> ]. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id422561/">https://habr.com/ru/post/id422561/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id422547/index.html">Untuk menghilangkan Specter dan Meltdown, Anda mungkin harus membuat jenis prosesor yang sama sekali baru</a></li>
<li><a href="../id422549/index.html">Corda: Kotlin</a></li>
<li><a href="../id422551/index.html">Cara mencuri uang dari kartu contactless dan Apple Pay</a></li>
<li><a href="../id422553/index.html">Ekstensi browser resmi Mega mencuri data berbagi file dan cryptocurrency</a></li>
<li><a href="../id422555/index.html">Arsitektur multi-modul Android. A hingga Z</a></li>
<li><a href="../id422565/index.html">Webmaster Skillbox Friday: Semuanya untuk Programer dan Desainer</a></li>
<li><a href="../id422569/index.html">Setiap jam, aplikasi pelacakan waktu</a></li>
<li><a href="../id422571/index.html">Menyejajarkan tugas dengan dependensi - .NET contoh</a></li>
<li><a href="../id422573/index.html">Rekayasa terbalik dari rendering The Witcher 3</a></li>
<li><a href="../id422575/index.html">Entri telepon langka</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>