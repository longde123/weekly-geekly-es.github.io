<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🐝 🌶️ 🧙🏻 什么是GitOps？ 🧝🏿 🍿 👩🏽‍🔧</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="注意事项 佩雷夫 ：最近发布了有关GitOps中的推拉方法的材料之后，我们整体上对这种模型很感兴趣，但是，关于该主题的俄文出版物很少（他们根本不在中心）。 因此，我们很高兴引起您的注意，尽管差不多一年前，但另一篇文章的翻译！ -来自Weaveworks公司，该公司的负责人创造了“ GitOps”一词...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>什么是GitOps？</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/flant/blog/458878/"> <i><b>注意事项</b></i>  <i><b>佩雷夫</b></i>  <i>：最近发布了有关GitOps中的推拉方法的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">材料</a>之后，我们整体上对这种模型很感兴趣，但是，关于该主题的俄文出版物很少（他们根本不在中心）。</i>  <i>因此，我们很高兴引起您的注意，尽管差不多一年前，但另一篇文章的翻译！</i>  <i>-来自Weaveworks公司，该公司的负责人创造了“ GitOps”一词。</i>  <i>文本解释了该方法的本质以及与现有方法的主要区别。</i> <br><br><img src="https://habrastorage.org/webt/i0/8b/fc/i08bfcph3kkhapzkitpwhylzdhc.png"><br><br> 一年前，我们发布了<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">GitOps简介</a> 。 然后，我们讨论了Weaveworks团队如何启动基于Kubernetes的SaaS，并开发了一套规范性的最佳实践，用于在云原生环境中进行部署，管理和监视。 <a name="habracut"></a><br><br> 这篇文章很受欢迎。 其他人开始谈论GitOps，开始发布用于<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">git push</a> ， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">开发</a> ， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">秘密</a> ， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">功能</a> ， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">持续集成</a>等的新工具。  GitOps的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">大量</a>出版物和用例已经出现在我们的网站上。 但是有些人仍然有疑问。 该模型与传统<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">基础架构在代码</a>和连续交付方面有何不同？ 使用Kubernetes是强制性的吗？ <br><br> 很快，我们意识到需要一个新的描述，其中包括： <br><br><ol><li> 大量的例子和故事； </li><li>  GitOps的具体定义； </li><li> 与传统连续交付的比较。 </li></ol><br> 在本文中，我们试图涵盖所有这些主题。 在其中，您将找到有关GitOps的更新介绍，并从开发人员和CI / CD的角度对其进行研究。 尽管该模型可以推广，但我们主要关注Kubernetes。 <br><br><h2> 认识GitOps </h2><br> 想象一下爱丽丝。 她经营家庭保险公司（Family Insurance），该公司为忙于无法独自理解合同细微差别的人们提供医疗，汽车，房地产和旅行保险。 当爱丽丝（Alice）在该银行担任数据科学家时，她的业务始于一项附属项目。 一旦她意识到可以使用高级计算机算法来更有效地分析数据并形成保险包。 投资者为该项目提供了资金，现在她的公司每年带来超过2000万美元的收入，并且发展迅速。 目前，有180人在其中担任不同职务。 其中，一个技术团队负责开发，维护站点，数据库并分析客户群。 该公司的技术总监Bob领导一个60人的团队。 <br><br>  Bob的团队正在云中部署生产系统。 他们的主要应用程序在GKE上运行，利用了Google Cloud上的Kubernetes。 此外，他们在工作中使用各种工具来处理数据和分析。 <br><br> 家庭保险公司不打算使用容器，但是感染了对Docker的热情。 不久，公司专家发现GKE使部署集群以测试新功能变得容易。 添加了用于CI和Quay的Jenkins以组织容器注册表，并编写了用于Jenkins的脚本，这些脚本在GKE中推送或新的容器和配置。 <br><br> 一段时间过去了。 爱丽丝和鲍勃对所选方法的效果及其对业务的影响感到失望。 引入容器并没有像团队希望的那样提高生产率。 有时部署会中断，目前尚不清楚是否应归咎于代码更改。 事实证明，跟踪配置更改也很困难。 通常，有必要创建一个新集群并将应用程序移入其中，因为这是消除系统陷入困境的最简单方法。  Alice担心随着应用程序的开发，情况会恶化（此外，正在酝酿一个基于机器学习的新项目）。 鲍勃将大部分工作自动化了，却不明白为什么管道仍然不稳定，伸缩性不好并且需要时常进行人工干预？ <br><br>  <b>然后他们了解了GitOps。</b>  <b>事实证明，这一决定正是他们自信地前进的必要条件。</b> <br><br> 多年来，Alice和Bob听说过基于Git，DevOps和基础架构作为代码的工作流。  GitOps的独特之处在于，它带来了许多最佳实践（分类和规范），以在Kubernetes的背景下实现这些想法。 这个话题<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">已经被反复提出</a> ，包括<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">在Weaveworks博客上</a> 。 <br><br> 家庭保险决定实施GitOps。 该公司现在拥​​有与Kubernetes兼容的自动化操作模型，该模型结合了<i>速度</i>和<i>稳定性</i> ，因为它们： <br><br><ul><li> 发现团队的工作效率提高了一倍，没有人发疯； </li><li> 停止服务脚本。 相反，他们现在可以专注于新功能并改进工程方法-例如，引入金​​丝雀推出并改善测试； </li><li> 改进了部署过程-现在很少中断； </li><li> 有机会在部分故障后无需手动干预即可恢复部署； </li><li> 对供应系统有了更大的信心。 爱丽丝（Alice）和鲍勃（Bob）发现，该团队可以分为在微服务中工作和并行工作的小组。 </li><li> 在每个小组的努力下，每天可以对项目进行30-50次更改，并尝试新技术； </li><li> 他们很容易被新开发人员吸引到项目中，他们能够在几个小时内使用拉取请求对生产进行更新。 </li><li> 可以轻松地在SOC2中<i>进行</i>审核<i>（以确保服务提供商符合对安全数据管理的要求；例如， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">在此处</a>了解更多-大约翻译）</i> 。 </li></ul><br><h3> 发生什么事了 </h3><br>  GitOps有两件事： <br><br><ol><li>  Kubernetes和Cloud Native的运营模型。 它提供了一组用于部署，管理和监视容器化集群和应用程序的最佳实践。  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Luis Faceira</a>的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">一张幻灯片中的</a>优雅定义： <br><br><img src="https://habrastorage.org/webt/or/fl/uu/orfluutk_hcqu6dnclf6pu1ewes.jpeg"></li><li> 创建面向开发人员的环境以管理应用程序的路径。 我们将Git工作流程应用于开发和开发。 请注意，这不仅涉及Git推送，还涉及组织整套CI / CD和UI / UX工具。 </li></ol><br><h3> 关于Git的几句话 </h3><br> 如果您不熟悉版本控制系统和基于Git的工作流程，强烈建议您学习它们。 最初，处理分支和请求请求可能看起来像是不可思议的事情，但是专业人士值得付出努力。 这是一篇<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">很好的</a>入门指南。 <br><br><h2>  Kubernetes如何工作 </h2><br> 在我们的故事中，Alice和Bob在与Kubernetes合作一段时间后转向了GitOps。 实际上，GitOps与Kubernetes紧密相连-它是基于Kubernetes的基础架构和应用程序的运营模型。 <br><br><h3>  Kubernetes给用户带来了什么？ </h3><br> 以下是一些主要功能： <br><br><ol><li> 在Kubernetes模型中，所有内容都可以声明性形式描述。 </li><li>  Kubernetes API服务器接受这样的声明作为输入，然后不断尝试使集群进入声明中描述的状态。 </li><li> 声明足以描述和管理各种各样的工作负载，即“应用程序”。 </li><li> 结果，对应用程序和集群的更改归因于： <br><ul><li> 更改容器图像； </li><li> 声明性规范的更改； </li><li> 环境中的错误-例如，容器崩溃。 </li></ul></li></ol><br><h3>  Kubernetes的强大收敛能力 </h3><br> 当管理员进行配置更改时，Kubernetes Orchestrator会将其应用于集群，直到其状态<i>接近新配置</i> 。 该模型适用于任何Kubernetes资源，并扩展了自定义资源定义（CRD）。 因此，Kubernetes部署具有以下出色的属性： <br><br><ul><li>  <b>自动化</b> ：Kubernetes更新提供了一种机制，该机制可以使正确，及时地应用更改的过程自动化。 </li><li>  <b>融合</b> ：Kubernetes将继续尝试更新直到成功。 </li><li>  <b>幂等</b> ：反复应用收敛会产生相同的结果。 </li><li>  <b>确定性</b> ：具有足够的资源，更新后的集群的状态仅取决于所需的状态。 </li></ul><br><h2>  GitOps如何工作 </h2><br> 我们已经对Kubernetes有了足够的了解，以解释GitOps的工作原理。 <br><br> 让我们回到与微服务有关的家庭保险团队。 他们通常需要做什么？ 请查看下面的列表（如果其中有任何问题似乎很陌生或不熟悉，请推迟批评并与我们在一起）。 这些只是基于Jenkins的工作流的示例。 使用其他工具时，还有许多其他过程。 <br><br> 最主要的是，我们看到每次更新都以对配置文件和Git存储库的更改结束。  Git中的这些更改导致“ GitOps语句”更新集群： <br><br>  1.工作流程：“ <i>Jenkins Build-master分支</i> ”。 <br> 任务清单： <br><br><ul><li> 詹金斯（Jenkins）将标记的图片推送到码头； </li><li>  Jenkins将“ it”配置和Helm图表推入主存储桶； </li><li> 云功能将配置和图表从主存储桶复制到主git存储库； </li><li>  GitOps语句更新集群。 </li></ul><br>  2. <i>Jenkins build-release或hotfix分支</i> ： <br><br><ul><li> 詹金斯（Jenkins）将“未加标签的图像”推入码头； </li><li>  Jenkins将config和Helm图表推到暂存存储区。 </li><li> 云功能将配置和图表从分段存储的存储桶复制到Git存储库分段； </li><li>  GitOps语句更新集群。 </li></ul><br>  3. <i>Jenkins构建-开发或功能分支</i> ： <br><br><ul><li> 詹金斯（Jenkins）将“未加标签的图像”推入码头； </li><li> 詹金斯（Jenkins）将config和Helm图推到开发存储桶中。 </li><li> 云功能将配置和图表从开发存储桶复制到开发git存储库； </li><li>  GitOps语句更新集群。 </li></ul><br>  4. <i>添加一个新客户端</i> ： <br><br><ul><li> 经理或管理员（LCM / ops）呼叫Gradle最初部署和配置网络负载平衡器（NLB）； </li><li>  LCM / ops提交新的配置以准备部署更新。 </li><li>  GitOps语句更新集群。 </li></ul><br><h3>  GitOps的简短说明 </h3><br><ol><li> 使用每种环境的声明性规范描述整个系统的期望状态（在我们的历史中，Bob团队在Git中定义了整个系统配置）。 <br><br><ul><li>  git存储库是有关整个系统所需状态的唯一事实来源。 </li><li> 对所需状态的所有更改都是通过Git中的提交进行的。 </li><li> 所有所需的群集参数也可以在群集本身中观察到。 因此，我们可以确定期望状态和观察状态是否重合（converge， <i>converge</i> ）或<i>相异</i> （ <i>diverge</i> ， <i>diverge</i> ）。 </li></ul></li><li> 如果期望状态和观察到的状态不同，则： <br><br><ul><li> 有一种收敛机制，迟早会自动同步目标状态和观察到的状态。 在集群内部，Kubernetes会执行此操作。 </li><li> 该过程立即以“更改已提交”通知开始。 </li><li> 经过一段可配置的时间后，如果状态不同，则可以发送差异警报。 </li></ul></li><li> 因此，Git中的所有提交都会触发集群中可验证的幂等更新。 <br><br><ul><li> 回滚是收敛到先前期望的状态。 </li></ul></li><li> 收敛是最终的。 关于其发病证明： <br><br><ul><li> 一段时间内缺乏“差异”警报。 </li><li> 聚合警报（例如，webhook，Git写回事件）。 </li></ul></li></ol><br><h3> 什么是分歧？ </h3><br> 我们再次重复： <i>群集的所有所需属性应在群集本身中可见</i> 。 <br><br> 分歧的一些例子： <br><br><ul><li> 由于在Git中合并了分支，因此配置文件中的更改。 </li><li> 由于GUI客户端在Git中进行的提交，导致配置文件中的更改。 </li><li> 由于Git中的PR以及后续容器图像的组装以及对配置的更改，期望状态发生了多次更改。 </li><li> 由于错误，导致“不良行为”的资源冲突或只是与原始状态的意外偏离而导致的群集状态更改。 </li></ul><br><h3> 什么是收敛机制？ </h3><br> 一些例子： <br><br><ul><li> 对于容器和集群，收敛机制提供了Kubernetes。 </li><li> 可以使用相同的机制来管理基于Kubernetes的应用程序和设计（例如Istio和Kubeflow）。 </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Weave Flux GitOps运算符</a>提供<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">了</a>用于管理Kubernetes，图像存储库和Git之间的工作交互的机制，该机制是<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Weave Cloud的</a>一部分。 </li><li> 对于基本计算机，收敛机制必须是声明性的和自治的。 根据我们自己的经验，可以说<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Terraform</a>最接近此定义，但仍需要人工控制。 从这个意义上讲，GitOps扩展了基础架构即代码的传统。 </li></ul><br>  GitOps将Git与Kubernetes的出色收敛引擎结合在一起，提供了操作模型。 <br><br>  GitOps允许我们声明<i>只有可以描述和观察的系统才可以自动化和控制</i> 。 <br><br><h3>  GitOps适用于整个云本机堆栈（例如Terraform等） </h3><br>  GitOps不仅是Kubernetes。 我们希望对整个系统进行声明式管理并使用收敛。 对于整个系统，我们指的是一组与Kubernetes一起使用的环境，例如“开发集群1”，“生产”等。每个环境都包括机器，集群，应用程序以及用于提供数据，监控和维护的外部服务的接口。等 <br><br> 请注意，在这种情况下，Terraform对于引导问题非常重要。  Kubernetes需要部署在某个地方，使用Terraform意味着我们可以使用相同的GitOps工作流程来创建作为Kubernetes和应用程序基础的控制层。 这是一个好的最佳实践。 <br><br> 人们非常关注将GitOps概念应用于Kubernetes上的各个层。 当前，有针对Istio，Helm，Ksonnet，OpenFaaS和Kubeflow以及例如Pulumi的GitOps类型的解决方案，这些解决方案创建了一个层来开发用于云原生的应用程序。 <br><br><h2>  Kubernetes CI / CD：将GitOps与其他方法进行比较 </h2><br> 如前所述，GitOps有两件事： <br><br><ol><li> 上述Kubernetes和Cloud Native的运营模型。 </li><li> 组织以开发人员为中心的应用程序管理环境的路​​径。 </li></ol><br> 对于许多人来说，GitOps主要是基于Git推送的工作流程。 我们也喜欢他。 但这还不是全部：现在让我们看一下CI / CD管道。 <br><br><h3>  GitOps为Kubernetes提供持续部署（CD） </h3><br>  GitOps提供了一种持续的部署机制，从而消除了对单独的“部署管理系统”的需求。  Kubernetes为您完成所有工作。 <br><br><ul><li> 更新应用程序需要在Git中进行更新。 这是到所需状态的事务性升级。 然后，Kubernetes会根据更新的说明在集群内执行“部署”。 </li><li> 由于Kubernetes的特性，这些更新是收敛的。 这提供了一种连续部署的机制，其中所有更新都是原子的。 </li><li> 注意： <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Weave Cloud</a>提供了一个GitOps运算符，该运算符集成了Git和Kubernetes，并允许您通过匹配集群的期望状态和当前状态来运行CD。 </li></ul><br><h3> 没有kubectl和脚本 </h3><br> 避免使用Kubectl升级群集，尤其是使用脚本对kubectl命令进行分组。 相反，使用GitOps管道，用户可以通过Git升级其Kubernetes集群。 <br><br> 好处包括： <br><br><ol><li>  <b>正确性</b> 。 可以应用，融合并最终验证一组更新，这使我们更接近原子部署的目标。 相反，脚本的使用并不能保证任何收敛性（更多内容请参见下文）。 </li><li>  <b>安全性</b>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">引用</a> Kelsey Hightower的话：“将Kubernetes集群的访问权限限制为负责调试或维护它的自动化工具和管理员。” 另请参阅<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">我</a>关于安全性和合规性的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">出版物</a> ，以及<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">有关</a>通过从粗心的Jenkins脚本中窃取凭据来<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">破解Homebrew的文章</a> 。 </li><li>  <b>用户体验</b> 。  Kubectl揭示了非常复杂的Kubernetes对象模型的机制。 理想情况下，用户应在更高的抽象级别上与系统进行交互。 在这里，我将再次提及Kelsey，并建议您查看<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">这样的简历</a> 。 </li></ol><br><h3>  CI和CD之间的区别 </h3><br>  GitOps对现有CI / CD模型进行了改进。 <br><br> 现代CI服务器是用于编排的工具。 特别是，它是用于编排CI管道的工具。 它们包括构建，测试，合并到中继线等。CI服务器可自动管理复杂的多步骤管道。 常见的诱惑是为Kubernetes更新集创建脚本，并将其作为用于将更改推送到集群的管道元素执行。 确实，这是许多专家所做的。 但是，这不是最佳选择，这就是原因。 <br><br> 必须使用CI对中继进行更新，并且Kubernetes集群必须根据这些更新进行自身更改，以便“内部”管理CD。 我们将其称为<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">CD</a>的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">拉模型，这</a>与CI推模型不同。  CD是<i>运行时业务流程的</i>一部分。 <br><br><h3> 为什么CI服务器不应该通过Kubernetes中的直接更新来制作CD </h3><br>  <i>请勿使用CI服务器将Kubernetes中的直接更新编排为一组CI任务。</i>  <i>这是我们在博客上<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">已经讨论过</a>的反模式。</i> <br><br> 让我们回到爱丽丝和鲍勃。 <br><br> 他们遇到了什么问题？  Bob的CI服务器将更改应用到群集，但是如果更改属于该过程，则Bob不会知道群集处于（或应该处于）什么状态以及如何修复它。 如果成功，也是如此。 <br><br> 假设Bob的团队整理了一个新映像，然后修补了其部署以部署该映像（全部来自CI管道）。 <br><br> 如果映像正常生成，但管道中断，则团队必须找出： <br><br><ul><li> 更新是否已部署？ </li><li> 我们要开始一个新的版本吗？        —           ? </li><li>      ,    ? </li><li>     ?     (     )? </li></ul><br> <i>   Git'    ,        .  -    push' ,    -  ;          --.</i> <br><br> ,   CI-    CD: <br><br><ul><li>     ;     . </li><li> CI-      . </li><li>   .       . </li><li>      . </li></ul><br> <i>  Helm'e:     Helm,      GitOps-,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Flux-Helm</a> .    .    Helm    ,  .</i> <br><br><h2> GitOps     Continuous Delivery  Kubernetes </h2><br>      GitOps  ,        ,     .     , ,     . ,         ,  GitOps      . <br><br><h3>    Kubernetes </h3><br>    .   Git            : <br><br><ul><li>   ,       Git      . </li><li>  Runtime GitOps,      .       Git     . </li></ul><br><img src="https://habrastorage.org/webt/0h/mo/vs/0hmovs2jg182thgg_hxll6jabwk.png"><br><br><h3>   ? </h3><br><ol><li> <b> </b> :  ,      ,   Git   .  ,     CI  runtime-.    « » <i>(immutability firewall)</i> ,       .          72-87 <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="> </a> . </li><li> <b>   CI-  Git-</b> : GitOps    .       CI-  Git-,     .      Continuous Delivery     CI-/Git-   .        cloud native.   GitOps     . </li><li> <b>   </b> :     Git , Weave Flux (  Weave Cloud)    runtime.  ,  Kubernetes   , Git .           GitOps,   . </li></ol><br><img src="https://habrastorage.org/webt/xh/wn/83/xhwn83itzgegzohc4vyp2sprpe8.png"><br><br><h2> 结论 </h2><br> GitOps    ,     CI/CD: <br><br><ul><li> ; </li><li> ; </li><li> ; </li><li> . </li></ul><br>  ,          cloud native. <br><br><ul><li>           ,    runbook' <i>(     — . .)</i> ,    deployment'. </li><li>   cloud native-         ,        . </li></ul><br>   ,              . GitOps  -      . <br><br><h2> 译者的PS </h2><br> 另请参阅我们的博客： <br><br><ul><li> « <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="> werf 1.0 stable:    GitOps,   </a> »; </li><li> « <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">GitOps:   Pull  Push</a> »; </li><li> « <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">  kubedog     Kubernetes</a> »; </li><li> « <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">   Kubernetes (   )</a> ». </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN458878/">https://habr.com/ru/post/zh-CN458878/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN458866/index.html">团队平衡器在《战车世界：闪击战》中的运作方式</a></li>
<li><a href="../zh-CN458868/index.html">大数据中的噪音。 熵分析</a></li>
<li><a href="../zh-CN458870/index.html">我们每天都面临的最流行的计算机问题</a></li>
<li><a href="../zh-CN458874/index.html">ASO清单：文本优化</a></li>
<li><a href="../zh-CN458876/index.html">星期五迷你周日</a></li>
<li><a href="../zh-CN458880/index.html">使用WSL和Visual Studio Code Remote在Windows上进行Linux开发</a></li>
<li><a href="../zh-CN458882/index.html">公开演讲。 简要介绍主要内容</a></li>
<li><a href="../zh-CN458884/index.html">关于空间通信标准的一些知识</a></li>
<li><a href="../zh-CN458886/index.html">最有用的Mail.ru设计会议×Dribbble Meetup 2019论文，由True Engineering提供</a></li>
<li><a href="../zh-CN458888/index.html">夏季机器人聚会</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>