<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§∏ üëØ üëµüèæ Verwaiste Dienste: Die Kehrseite der (Mikro-) Dienstarchitektur üë©üèø‚Äçü§ù‚Äçüë©üèª üôÖüèø üôè</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Auf der letztj√§hrigen Konferenz DevOpsDays Moscow berichtete der Betriebsleiter des Banki.ru-Portals Andrei Nikolsky √ºber Waisendienste: Wie man ein W...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Verwaiste Dienste: Die Kehrseite der (Mikro-) Dienstarchitektur</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/scienceman_events/blog/471146/">  Auf der letztj√§hrigen Konferenz <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">DevOpsDays Moscow berichtete der</a> Betriebsleiter des Banki.ru-Portals Andrei Nikolsky √ºber Waisendienste: Wie man ein Waisenkind in der Infrastruktur identifiziert, was schlechte Waisendienste sind, was man mit ihnen macht und wie man ist, wenn nichts hilft. <br><br>  Unter dem Schnitt befindet sich die Textversion des Berichts. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/j9I4oeEXBO8" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><a name="habracut"></a><br>  Hallo Kollegen!  Mein Name ist Andrey, ich leite die Operation bei Banki.ru. <br><br>  Wir haben gro√üartige Dienstleistungen, dies sind monolithische Dienstleistungen, es gibt Dienstleistungen im klassischen Sinne, es gibt sehr kleine.  In der Terminologie meiner Arbeiter und Bauern sage ich, wenn der Dienst einfach und klein ist, dann ist er mikro, und wenn er nicht sehr einfach und nicht klein ist, dann ist er nur ein Dienst. <br><br><h3>  <b>Service-Profis</b> </h3><br>  Ich werde schnell auf die Vorteile von Diensten eingehen. <br><br><img src="https://habrastorage.org/webt/ji/xj/_u/jixj_uxelvtokkt54xoul15fsnu.png"><br><br>  Der erste ist die Skalierung.  Sie k√∂nnen schnell etwas f√ºr den Service tun und mit der Produktion beginnen.  Sie sind im Verkehr angekommen, Sie haben den Dienst geklont.  Du hast immer noch Verkehr, du hast immer noch geklont und lebst damit.  Dies ist ein guter Bonus, und als wir anfingen, wurde er im Prinzip als der wichtigste unter uns angesehen, warum wir das alles tun. <br><br><img src="https://habrastorage.org/webt/lc/oq/d3/lcoqd397ppryaemtruvd7awdoxe.png"><br><br>  Zweitens: Isolierte Entwicklung, wenn Sie mehrere Entwicklungsteams, mehrere verschiedene Entwickler in jedem Team und jedes Team eine Art Service sehen. <br><br>  Es gibt eine Nuance mit den Teams.  Entwickler sind anders.  Und es gibt zum Beispiel <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Menschen-Schneeflocken</a> .  Ich habe das zum ersten Mal bei Maxim Dorofeev gesehen.  Manchmal haben Leute in einigen Teams Schneeflocken, andere nicht.  Dies macht die verschiedenen Dienste, die im Unternehmen verwendet werden, etwas ungleichm√§√üig. <br><br><img src="https://habrastorage.org/webt/_k/nk/ml/_knkmlyetdgucwl7bkuxuvtpahe.png"><br><br>  Schauen Sie sich das Bild an: Er ist ein guter Entwickler, er hat gro√üe H√§nde, er kann viel.  Das Hauptproblem ist, woher diese H√§nde wachsen. <br><br><img src="https://habrastorage.org/webt/-6/li/zn/-6liznhfxdjynboqueccoayiat8.png"><br><br>  Dienste erm√∂glichen die Verwendung verschiedener Programmiersprachen, die f√ºr verschiedene Aufgaben besser geeignet sind.  Einige Dienste auf Go, einige auf Erlang, einige auf Ruby, einige auf PHP, einige auf Python.  Im Allgemeinen k√∂nnen Sie sich sehr breit umdrehen.  Hier gibt es auch Nuancen. <br><br><img src="https://habrastorage.org/webt/7h/ob/ka/7hobkajsj1y7nsdqr1sfoqt7ljo.jpeg"><br><br>  Bei der serviceorientierten Architektur geht es haupts√§chlich um Entwickler.  Das hei√üt, wenn Sie keine Automatisierung haben, gibt es keinen Bereitstellungsprozess. Wenn Sie mit Ihren H√§nden konfigurieren, k√∂nnen sich Ihre Konfigurationen von einer Dienstinstanz zu einer Instanz √§ndern, und Sie m√ºssen dorthin gehen, um etwas zu tun, dann sind Sie in der H√∂lle. <br><br>  Zum Beispiel haben Sie 20 Dienste, und Sie m√ºssen mit Ihren H√§nden bereitstellen, Sie haben 20 Konsolen und Sie dr√ºcken gleichzeitig die Eingabetaste, wie ein Ninja.  Das ist nicht sehr gut. <br><br>  Wenn Sie nach dem Testen einen Dienst haben (wenn es nat√ºrlich Tests gibt) und Sie ihn auch mit einer Datei beenden m√ºssen, damit er in der Produktion funktioniert, habe ich auch schlechte Nachrichten f√ºr Sie. <br><br>  Wenn Sie sich auf die spezifischen Dienste von Amazon verlassen und in Russland arbeiten, hatten Sie vor zwei Monaten auch die Meldung "Alles brennt, mir geht es gut, alles ist cool." <br><br><img src="https://habrastorage.org/webt/vu/z0/u6/vuz0u6eenpfaob592_jtdrnpp8e.png"><br><br>  Wir verwenden Ansible f√ºr die Bereitstellungsautomatisierung, Puppet f√ºr die Konvergenz, Bamboo f√ºr die Bereitstellungsautomatisierung und Confluence, um alles irgendwie zu beschreiben. <br><br>  Ich werde nicht im Detail darauf eingehen, da es in dem Bericht mehr um die Praxis von Interaktionen und nicht um die technische Umsetzung geht. <br><br><img src="https://habrastorage.org/webt/dg/c5/cz/dgc5cz_nevmer6hzgcxjj1tqe5g.png"><br><br>  Zum Beispiel hatten wir Probleme, dass Puppet auf dem Server mit Ruby 2 funktioniert, und einige Anwendungen wurden unter Ruby 1.8 geschrieben, und zusammen funktionieren sie nicht.  Dort passiert eine Art Pfosten.  Und wenn Sie mehrere Versionen von Ruby auf demselben Computer behalten m√ºssen, treten normalerweise Probleme auf. <br><br>  Zum Beispiel geben wir jedem Entwickler eine Plattform, auf der es fast alles gibt, was wir haben, alle Dienste, die entwickelt werden k√∂nnen, damit er eine isolierte Umgebung hat. Er kann sie aufteilen und nach Belieben erstellen. <br><br>  Es kommt vor, dass Sie eine Art speziell kompiliertes Paket ben√∂tigen, das dort etwas unterst√ºtzt.  Das ist hart genug.  Ich habe mir einen Bericht angeh√∂rt, in dem das Docker-Image 45 GB wiegt.  Unter Linux ist es nat√ºrlich einfacher, dort ist alles kleiner, aber es wird sowieso nicht genug Pl√§tze geben. <br><br>  Nun, es gibt widerspr√ºchliche Abh√§ngigkeiten, wenn Sie einen Teil eines Projekts in Abh√§ngigkeit von der Bibliothek einer Version, einen anderen Teil des Projekts in einer anderen Version haben und Bibliotheken √ºberhaupt nicht zusammengestellt werden. <br><br><img src="https://habrastorage.org/webt/9m/dr/vn/9mdrvnnkajxl_8cxfmj79ukk8dk.png"><br><br>  Wir haben Websites und Dienste in PHP 5.6, wir sch√§men uns daf√ºr, aber was zu tun ist.  Dies ist unsere einzige Seite.  Es gibt Websites und Dienste in PHP 7, es gibt mehr davon, wir sch√§men uns nicht daf√ºr.  Und jeder Entwickler hat seine eigene Basis, in der er gerne s√§gt. <br><br>  Wenn Sie im Unternehmen in einer Sprache schreiben, dann drei virtuelle Maschinen pro Entwickler - das klingt normal.  Wenn Sie verschiedene Programmiersprachen haben, verschlechtert sich die Situation. <br><br><img src="https://habrastorage.org/webt/mp/np/b0/mpnpb0q-gcmneomvazzs_1gd4-w.jpeg"><br><br>  Sie haben Websites und Dienste auf dieser, auf einer anderen Plattform f√ºr Go, einer Plattform f√ºr Ruby und einer weiteren Redis auf der Seite.  Infolgedessen wird all dies zu einem gro√üen Feld f√ºr die Unterst√ºtzung, und w√§hrenddessen kann ein Teil davon brechen. <br><br><img src="https://habrastorage.org/webt/cb/cq/u_/cbcqu_ynjcnffa0fepuvln_gib8.png"><br><br>  Aus diesem Grund haben wir die Br√∂tchen der Programmiersprache durch die Verwendung unterschiedlicher Frameworks ersetzt, da die Frameworks in PHP sehr unterschiedlich sind, unterschiedliche Funktionen, unterschiedliche Communitys und unterschiedliche Unterst√ºtzung haben.  Und Sie k√∂nnen einen Dienst schreiben, damit Sie bereits etwas daf√ºr bereit haben. <br><br><h3>  <b>Jeder Dienst hat ein eigenes Team.</b> </h3><br><img src="https://habrastorage.org/webt/zp/nc/6m/zpnc6mlp098fx0xriegr8mwn1jm.png"><br><br>  Unser Hauptvorteil, der sich √ºber mehrere Jahre herauskristallisierte, ist, dass jeder Service sein eigenes Team hat.  Dies ist praktisch f√ºr ein gro√ües Projekt. Sie k√∂nnen Zeit bei der Dokumentation sparen. Die Manager sind sich ihres Projekts bewusst. <br><br>  Aufgaben vom Support k√∂nnen perfekt geworfen werden.  Zum Beispiel ist der Versicherungsdienst zusammengebrochen.  Und sofort geht das Versicherungsteam zur Reparatur. <br><br>  Neue Funktionen werden schnell erstellt, denn wenn Sie einen Atomdienst haben, k√∂nnen Sie schnell etwas hineinschrauben. <br><br>  Und wenn Sie Ihren Dienst unterbrochen haben und dies unweigerlich passiert, haben Sie die Dienste anderer nicht verletzt, und Entwickler mit Teilen anderer Teams greifen nicht auf Sie zur√ºck und sagen nicht: "Aw, tun Sie das nicht." <br><br><img src="https://habrastorage.org/webt/34/hw/ro/34hwroxdvr056crrpgakpbk2f1g.png"><br><br>  Wie immer gibt es Nuancen.  Wir haben stabile Teams, Manager sind an das Team gebunden.  Es gibt klare Dokumente, Manager √ºberwachen dies alles genau.  Jedes Team mit einem Manager verf√ºgt √ºber mehrere Dienste, und es gibt einen bestimmten Kompetenzpunkt. <br><br>  Wenn die Teams schweben (dies wird manchmal auch bei uns verwendet), gibt es eine gute Methode, die als Sternenkarte bezeichnet wird. <br><br><img src="https://habrastorage.org/webt/lu/01/uq/lu01uqtz9m1qqsp-dndyetupouq.png"><br><br>  Sie haben eine Liste von Diensten und Personen.  Ein Sternchen bedeutet, dass eine Person ein Experte f√ºr diesen Dienst ist. Ein Buch bedeutet, dass eine Person diesen Dienst studiert.  Die Aufgabe des Menschen ist es, ein kleines Buch gegen ein Sternchen auszutauschen.  Und wenn gegen√ºber dem Dienst nichts geschrieben steht, beginnen Probleme, √ºber die ich weiter sprechen werde. <br><br><h3>  <b>Wie erscheinen verwaiste Dienste?</b> </h3><br><img src="https://habrastorage.org/webt/eh/rx/97/ehrx971egg-nuycxtteb8q824wo.jpeg"><br><br>  Das erste Problem, der erste Weg, um ein Service-Waisenkind in Ihre Infrastruktur zu bringen, besteht darin, Menschen zu entlassen.  Ist jemals jemand passiert, wenn Fristen aus dem Gesch√§ft eintreffen, bevor sie Aufgaben bewerten?  Manchmal kommt es vor, dass die Fristen knapp sind und einfach nicht genug Zeit f√ºr die Dokumentation bleibt.  "Wir m√ºssen den Service an die Produktion √ºbergeben, dann werden wir ihn hinzuf√ºgen." <br><br>  Wenn das Team klein ist, gibt es einen Entwickler, der alles schreibt, der Rest ist in den Startl√∂chern.  "Ich habe die grundlegende Architektur geschrieben, Sie geben mir die Schnittstellen."  Dann geht der Manager zum Beispiel irgendwann.  In dieser Zeit, in der der Manager gegangen ist und noch kein neuer ernannt wurde, entscheiden die Entwickler selbst, wohin der Service verlegt wird und was dort vor sich geht.  Und wie wir wissen (lassen Sie uns ein paar Folien zur√ºckgehen), gibt es in einigen Teams Menschen-Schneeflocken, manchmal einen Schneeflocken-Timlid.  Dann gibt er auf und wir bekommen eine Dienstwaise. <br><br><img src="https://habrastorage.org/webt/rh/ro/qw/rhroqwez4ltwh8a5petmhcvszi4.png"><br><br>  Gleichzeitig verschwinden Aufgaben aus dem Support und aus dem Gesch√§ft nicht, sondern werden im R√ºckstand erledigt.  Wenn w√§hrend der Entwicklung des Dienstes Architekturfehler aufgetreten sind, werden diese auch im R√ºckstand ber√ºcksichtigt.  Der Service verschlechtert sich langsam. <br><br><h3>  <b>Wie identifiziere ich eine Waise?</b> </h3><br>  Diese Liste beschreibt die Situation gut.  Wer hat etwas in der Infrastruktur gelernt? <br><br><img src="https://habrastorage.org/webt/4r/gy/nv/4rgynviquavl_b6pmfr85mhzybo.png"><br><br>  Zu den dokumentierten Workarounds: Es gibt einen Service, der im Allgemeinen funktioniert. Er enth√§lt ein zweiseitiges Handbuch, wie man damit arbeitet, aber niemand wei√ü, wie es im Inneren funktioniert. <br><br>  Oder es gibt zum Beispiel eine Art Link-Shortener.  Zum Beispiel verwenden wir jetzt drei Link-Shortener f√ºr verschiedene Zwecke in verschiedenen Diensten.  Das sind die Konsequenzen. <br><br><img src="https://habrastorage.org/webt/sm/ka/0f/smka0fa5trizu6rxhzit6e-6fj0.png"><br><br>  Jetzt werde ich der Hauptmann der Beweise sein.  Was muss getan werden?  Zun√§chst m√ºssen Sie den Service an einen anderen Manager oder ein anderes Team √ºbertragen.  Wenn Ihr Teamleiter noch nicht gek√ºndigt hat, m√ºssen Sie in diesem anderen Team, wenn Sie verstehen, dass der Dienst wie eine Waise ist, jemanden einbeziehen, der zumindest etwas √ºber ihn versteht. <br><br>  Die Hauptsache: Sie m√ºssen blutgeschriebene √úbertragungsverfahren haben.  In unserem Fall folge ich normalerweise dem, weil ich das brauche, um zu funktionieren.  Manager brauchen dies, um schnell geliefert zu werden, und was sp√§ter mit ihm geschehen wird, ist f√ºr sie nicht so wichtig. <br><br><img src="https://habrastorage.org/webt/6b/wy/5p/6bwy5pd9qqzaki4jfyo0qimq8tk.png"><br><br>  Der n√§chste Weg, um eine Waise zu machen, ist: "Lass es uns auslagern, es wird schneller und dann werden wir es an das Team √ºbertragen."  Es ist klar, dass jeder einige Pl√§ne im Team hat, der Warteschlange.  Oft glaubt ein Gesch√§ftskunde, dass ein Outsourcer dasselbe tut wie die technische Abteilung im Unternehmen.  Obwohl ihre Motivatoren unterschiedlich sind.  Outsourcing hat seltsame technologische L√∂sungen und seltsame algorithmische L√∂sungen. <br><br><img src="https://habrastorage.org/webt/3o/iv/zg/3oivzgpkzi_5akenrhhsfl9r8h8.png"><br><br>  Zum Beispiel hatten wir einen Dienst, bei dem sich Sphinx an verschiedenen unerwarteten Orten befand.  Ich werde dir sp√§ter sagen, was ich tun musste. <br><br>  Outsourcer haben selbstgeschriebene Rahmenbedingungen.  Dies ist nur nacktes PHP mit Copy-Paste aus dem vorherigen Projekt, wo Sie alles finden k√∂nnen.  Gro√üe Kr√ºcken in Bereitstellungsskripten, wenn Sie mehrere Zeilen in einer Datei mit einigen komplexen Bash-Skripten √§ndern m√ºssen, w√§hrend diese Bereitstellungsskripten von einem dritten Skript aufgerufen werden.  Infolgedessen √§ndern Sie das Bereitstellungssystem, w√§hlen etwas anderes aus, h√ºpfen und Ihr Dienst funktioniert nicht.  Weil es 8 weitere Links zwischen verschiedenen Ordnern gab.  Oder es kommt vor, dass tausend Datens√§tze funktionieren, aber hunderttausend weg sind. <br><br>  Ich werde weiterhin Kapit√§n.  Das Akzeptieren eines Dienstes aus dem Outsourcing ist ein Verfahren, das erforderlich ist.  Wer ist passiert, dass ein Service von einem Outsourcer eintrifft, der aber nirgendwo akzeptiert wird?  Dies ist nat√ºrlich nicht so beliebt wie ein Dienstwaisenkind, aber dennoch. <br><br><img src="https://habrastorage.org/webt/ak/8j/lh/ak8jlhfoevrsvkv4d-y1rfu8gri.png"><br><br>  Der Dienst muss √ºberpr√ºft werden, der Dienst muss √ºberpr√ºft werden, die Passw√∂rter m√ºssen ge√§ndert werden.  Wir hatten einen Fall, als der Dienst uns warf, dort ist das Admin-Panel "if login == 'admin' &amp;&amp; password == 'admin' ..." direkt in den Code geschrieben.  Wir sitzen und denken, und die Leute schreiben das im Jahr 2018? <br><br>  Das Testen des Speichervolumens ist ebenfalls ein Muss.  Sie m√ºssen sich ansehen, was auf hunderttausend Datens√§tzen passieren wird, noch bevor Sie diesen Service irgendwo in der Produktion starten. <br><br><img src="https://habrastorage.org/webt/mc/k2/qa/mck2qagxhsslsxcojjpekfludq4.png"><br><br>  Senden Sie den Dienst zur √úberarbeitung sollte sich nicht sch√§men.  Wenn Sie sagen: ‚ÄûWir werden diesen Service nicht annehmen, wir haben 20 Aufgaben, erledigen sie, dann werden wir annehmen‚Äú, ist dies normal.  Das Gewissen sollte nicht dadurch schaden, dass Sie einen Manager ersetzen oder dass ein Unternehmen Geld ausgibt.  Das Gesch√§ft wird dann mehr ausgeben. <br><br>  Wir hatten einen Fall, als wir beschlossen, ein Pilotprojekt zum Thema Outsourcing durchzuf√ºhren. <br><br><img src="https://habrastorage.org/webt/fo/cm/be/focmbesdalmj5fa1ia9_lkpxss4.png"><br><br>  Es wurde p√ºnktlich geliefert, und dies war das einzige Qualit√§tskriterium.  Deshalb haben sie ein weiteres Pilotprojekt durchgef√ºhrt, nicht einmal ein Pilotprojekt.  Diese Dienste wurden akzeptiert, sagten sie auf administrative Weise, hier ist Ihr Code, hier ist ein Team, hier ist Ihr Manager.  Dienstleistungen haben wirklich bereits begonnen, Gewinn zu machen.  Dar√ºber hinaus blieben sie tats√§chlich Waisen, niemand versteht, wie sie arbeiten, und Manager lehnen ihre Aufgaben in jeder Hinsicht ab. <br><br><img src="https://habrastorage.org/webt/z6/lo/mn/z6lomn7i2eknkjah0pquashtywu.png"><br><br>  Es gibt ein weiteres hervorragendes Konzept - die Partisanenentwicklung.  Wenn eine Abteilung in der Regel eine Marketingabteilung ist, m√∂chten sie eine Hypothese testen und den gesamten Service auslagern.  Der Verkehr beginnt auf ihn zu str√∂men, sie schlie√üen Dokumente, unterschreiben Gesetze mit dem Auftragnehmer, treten in Betrieb und sagen: ‚ÄûLeute, wir haben hier einen Dienst, er hat bereits Verkehr, er bringt uns Geld, lass es uns nehmen.‚Äú  Wir sind: "Oppa, wie so." <br><br><img src="https://habrastorage.org/webt/bw/g-/vj/bwg-vjk4-tvz3574ib3mbjw18ue.png"><br><br>  Und noch ein Weg, um einen Waisendienst zu erhalten: Wenn ein Team pl√∂tzlich geladen wird, sagt das Management: ‚ÄûLassen Sie uns den Dienst dieses Teams auf ein anderes Team √ºbertragen, es hat weniger Last.‚Äú  Und dann werden wir zum dritten Team wechseln und den Manager wechseln.  Und am Ende haben wir wieder eine Waise. <br><br><h3>  <b>Was ist das Problem mit Waisenkindern?</b> </h3><br><img src="https://habrastorage.org/webt/_o/-3/ux/_o-3uxqtu_lh_cmgfg8mf6pousc.png"><br><br>  Wer wei√ü nicht, dies war das Schiff der Linie Wasa, das in Schweden angehoben wurde und ber√ºhmt daf√ºr ist, dass es 5 Minuten nach dem Start gesunken ist.  Und der K√∂nig von Schweden hat √ºbrigens niemanden daf√ºr hingerichtet.  Es wurde von zwei Generationen von Ingenieuren gebaut, die solche Schiffe nicht bauen konnten.  Die nat√ºrliche Wirkung. <br><br>  Das Schiff k√∂nnte √ºbrigens viel schlimmer sinken, wenn der K√∂nig es irgendwo im Sturm reiten w√ºrde.  Und so ertrank er sofort, laut Ajail ist es gut, fr√ºh zu scheitern. <br><br>  Wenn wir fr√ºh versagen, gibt es normalerweise keine Probleme.  Zum Beispiel haben sie w√§hrend der Annahme zur √úberarbeitung geschickt.  Und wenn wir bereits in der Produktion gescheitert sind, wenn das Geld investiert wird, kann es Probleme geben.  Die Konsequenzen, wie sie im Gesch√§ft genannt werden. <br><br>  Warum gef√§hrliche Waisendienste: <br><br><ul><li>  Der Service kann pl√∂tzlich unterbrochen werden. </li><li>  Service wird f√ºr eine lange Zeit repariert oder √ºberhaupt nicht repariert. </li><li>  Sicherheitsprobleme. </li><li>  Probleme mit Verbesserungen und Updates. </li><li>  Wenn ein wichtiger Service ausf√§llt, leidet der Ruf des Unternehmens. </li></ul><br><h3>  <b>Was tun mit Waisendiensten?</b> </h3><br><img src="https://habrastorage.org/webt/3k/ex/8v/3kex8vjbf7clzd9jbktsfzjclby.png"><br><br>  Noch einmal, was zu tun ist.  Erstens sollte es eine Dokumentation geben.  7 Jahre lang wurde mir bei Banki.ru beigebracht, dass Tester kein Wort f√ºr Entwickler und Betrieb kein Wort f√ºr alle haben sollten.  Es ist notwendig zu √ºberpr√ºfen. <br><br><img src="https://habrastorage.org/webt/dx/rc/ub/dxrcubcmw-ybkov8kdag3cz2rzs.png"><br><br>  Zweitens m√ºssen Interaktionsschemata geschrieben werden, da Dienste, die nicht gut aufgenommen werden, Abh√§ngigkeiten enthalten, √ºber die niemand gesprochen hat.  Zum Beispiel setzen die Entwickler den Dienst auf ihren Schl√ºssel zu einigen Yandex.Maps oder zu Dadata.  Sie haben kein freies Limit mehr, alles ist kaputt und Sie wissen gar nicht, was passiert ist.  Alle diese Rechen sollten beschrieben werden: Der Dienst verwendet Dadata, SMS, etwas anderes. <br><br><img src="https://habrastorage.org/webt/hy/6o/ki/hy6okizhuhhwibejacdgchvoo68.png"><br><br>  Drittens arbeiten mit der technischen Verschuldung.  Wenn Sie Kr√ºcken bauen oder den Service annehmen und sagen, dass etwas getan werden muss, m√ºssen Sie sicherstellen, dass sie es tun.  Denn dann kann sich herausstellen, dass das kleine Loch nicht so klein ist und Sie dort hinfallen. <br><br>  Bei architektonischen Aufgaben hatten wir eine Geschichte √ºber Sphinx.  In einem der Dienste wurde Sphinx verwendet, um Listen einzugeben.  Nur eine Paginierungsliste, die aber jede Nacht neu indiziert wurde.  Es wurde aus zwei Indizes zusammengestellt: Einer wurde jede Nacht gro√ü indiziert, und es gab immer noch einen kleinen Index, der daran angeschraubt war.  Jeden Tag, mit einer Wahrscheinlichkeit von 50%, wird der Index w√§hrend der Berechnung entweder bombardiert oder nicht, und die Nachrichten wurden auf der Hauptseite nicht mehr aktualisiert.  Zuerst waren es 5 Minuten, w√§hrend der Index neu indiziert wurde, dann wuchs der Index und irgendwann begann er 40 Minuten neu zu indizieren.  Als wir es herausschnitten, atmeten wir erleichtert auf, denn es war klar, dass etwas mehr Zeit vergehen w√ºrde und unser Index ganzt√§gig neu indiziert werden w√ºrde.  Es wird eine Datei f√ºr unser Portal sein, acht Stunden gibt es keine Neuigkeiten - das war's, das Gesch√§ft ist aufgestanden. <br><br><h3>  <b>Arbeitsplan mit einem Waisendienst</b> </h3><br><img src="https://habrastorage.org/webt/ox/ny/wq/oxnywqk2gpyoczjewhrt_ngsiz0.png"><br><br>  In der Tat ist es sehr schwierig, weil es bei Devops um Kommunikation geht.  Ich m√∂chte in guten Beziehungen zu meinen Kollegen stehen, und wenn Sie Kollegen und Manager mit Vorschriften auf den Kopf schlagen, haben sie m√∂glicherweise widerspr√ºchliche Gef√ºhle f√ºr diejenigen, die dies tun. <br><br>  Zus√§tzlich zu all diesen Punkten gibt es noch eine weitere wichtige Sache: F√ºr jeden bestimmten Dienst, f√ºr jeden bestimmten Abschnitt des Bereitstellungsverfahrens sollten bestimmte Personen verantwortlich sein.  Wenn es keine Leute gibt und man andere Leute anziehen muss, um das Ganze zu studieren, wird es schwierig. <br><br><img src="https://habrastorage.org/webt/6o/-d/co/6o-dcolwznowrvatclrcvbvau0a.png"><br><br>  Wenn all dies nicht hilft und das Dienstwaisenkind immer noch ein Waisenkind ist, niemand es zu Ihnen bringen m√∂chte, die Dokumentation nicht geschrieben ist, das Team, das zu diesem Dienst gerufen wurde, sich weigert, etwas zu tun, gibt es eine einfache M√∂glichkeit, alles zu wiederholen . <br><br>  Das hei√üt, Sie nehmen die Serviceanforderungen neu und schreiben einen neuen Service, besser, auf einer besseren Plattform, ohne seltsame technologische L√∂sungen.  Und im Kampf dorthin migrieren. <br><br><img src="https://habrastorage.org/webt/_j/f2/wk/_jf2wkfeybtdq4xty4syofgx1ei.png"><br><br>  Wir hatten eine Situation, als wir den Dienst auf Yii 1 in Anspruch nahmen und feststellten, dass wir ihn nicht weiterentwickeln k√∂nnen, da wir keine Entwickler mehr haben, die gut auf Yii 1 schreiben k√∂nnen. Alle Entwickler schreiben gut auf dem dritten Symfony.  Was zu tun ist?  Wir haben uns die Zeit genommen, das Team zugewiesen, den Manager zugewiesen, das Projekt neu geschrieben und den Datenverkehr reibungslos darauf umgestellt. <br><br>  Danach kann der alte Dienst gel√∂scht werden.  Dies ist mein Lieblingsverfahren, wenn Sie einen Dienst aus dem Konfigurationsmanagementsystem entfernen und bereinigen und dann √ºberpr√ºfen m√ºssen, ob alle Fahrzeuge in der Produktion zur√ºckgezahlt wurden, damit die Entwickler keine Spuren mehr haben.  Das Repository im Git bleibt erhalten. <br><br>  Das ist alles, wor√ºber ich sprechen wollte, ich bin bereit zu diskutieren, das Thema ist ganzheitlich, viele schwebten darin. <br><br>  <b>Auf den Folien ging es um die Tatsache, dass Sie Sprachen vereinheitlicht haben.</b>  <b>Ein Beispiel war die Gr√∂√üen√§nderung von Bildern.</b>  <b>Aber ist es wirklich notwendig, hart auf eine Sprache zu sprechen?</b>  <b>Da Sie die Gr√∂√üe von Bildern in PHP √§ndern k√∂nnen, k√∂nnen Sie dies auch in Golang tun.</b> <br><br>  Tats√§chlich ist dies nicht wie bei allen Praktiken erforderlich.  Vielleicht in einigen F√§llen sogar unerw√ºnscht.  Aber Sie m√ºssen verstehen, dass wenn Sie 50 Leute in der technischen Abteilung haben, 45 von ihnen PHP-Entwickler sind, weitere 3 Entwickler, die Python, Ansible, Puppet und so etwas k√∂nnen, und nur einer von ihnen schreibt √ºber einige Gehen Sie zum Service, um die Gr√∂√üe von Bildern zu √§ndern. Wenn er geht, geht die Pr√ºfung mit ihm.  Gleichzeitig m√ºssen Sie nach einem marktspezifischen Entwickler suchen, der diese Sprache kennt, insbesondere wenn sie selten ist.  Das ist aus organisatorischer Sicht problematisch.  Aus Sicht der Entwickler m√ºssen Sie nicht nur einige vorgefertigte Playbooks klonen, die Sie zum Bereitstellen von Diensten verwenden, sondern diese auch erneut schreiben. <br><br>  Wir sehen jetzt den Dienst auf Node.js und es wird nur eine Plattform in der N√§he f√ºr jeden Entwickler mit einer eigenen Sprache sein.  Aber wir sa√üen da und dachten, dass das Spiel die Kerze wert war.  Das hei√üt, die Frage hier ist, zu sitzen und nachzudenken. <br><br>  <b>Wie √ºberwachen Sie Ihre Dienste?</b>  <b>Wie sammeln und verfolgen Sie Protokolle?</b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wir sammeln Protokolle in Elasticsearch und legen sie in Kibana ab. Je nach Produktions- oder Testumgebung werden dort verschiedene Kollektoren verwendet. Irgendwo Holzf√§ller, irgendwo anders etwas, an das ich mich nicht mehr erinnere. Und es gibt immer noch einige Stellen in bestimmten Diensten, an denen wir Telegraf und Kugel getrennt woanders ablegen. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wie lebe ich mit Puppet und Ansible in einer Umgebung?</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tats√§chlich haben wir jetzt zwei Umgebungen, eine ist Puppet, die andere ist Ansible. Wir arbeiten daran, sie zu hybridisieren. Ansible ist eine gute Umgebung f√ºr die Ersteinrichtung, Puppet ist eine schlechte Umgebung f√ºr die Ersteinrichtung, da H√§nde erforderlich sind, um direkt mit der Site zu arbeiten, und Puppet eine Konvergenz der Konfiguration bietet. Dies bedeutet, dass die Site selbst auf dem neuesten Stand gehalten wird. Damit der ansiblisierte Computer auf dem neuesten Stand gehalten werden kann, m√ºssen Sie Playbooks in beliebiger H√§ufigkeit damit verfolgen. Hier ist so ein Unterschied. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wie erhalten Sie die Kompatibilit√§t aufrecht? Haben Sie Konfigurationen in Ansible und Puppet?</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dies ist unser gro√üer Schmerz, wir behalten die Kompatibilit√§t mit unseren H√§nden bei und denken, als ob wir uns jetzt von all dem irgendwo wegbewegen w√ºrden. Es stellt sich heraus, dass Puppet Pakete rollt und dort einige Links unterst√ºtzt, w√§hrend Ansible beispielsweise den Code rollt und dort neue Anwendungskonfigurationen steuert. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Pr√§sentation befasste sich mit verschiedenen Versionen von Ruby. Was ist die L√∂sung?</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Wir sind an einem Ort damit konfrontiert, und wir m√ºssen dies die ganze Zeit im Auge behalten. Wir haben gerade den Teil deaktiviert, der auf dem Ruby funktioniert hat, der mit Anwendungen nicht kompatibel war, und ihn getrennt gehalten.</font></font><br><br><blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dieses Jahr findet die </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DevOpsDays-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Konferenz </font><font style="vertical-align: inherit;">in </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">Moskau</font></a><font style="vertical-align: inherit;"> am 7. Dezember in Technopolis statt. </font><font style="vertical-align: inherit;">Bis zum 11. November akzeptieren wir Bewerbungen f√ºr Berichte. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mailen Sie</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> uns, wenn Sie sprechen m√∂chten. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Registrierung f√ºr Teilnehmer ist offen, mach mit!</font></font><br></blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de471146/">https://habr.com/ru/post/de471146/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de471134/index.html">Python vs JavaScript: Welches kann Ihnen am meisten n√ºtzen?</a></li>
<li><a href="../de471136/index.html">Russlands erstes gro√ües U-Bahn-Treffen der Scala-Gemeinde - so wie es war</a></li>
<li><a href="../de471138/index.html">Paarprogrammierung in Vineti</a></li>
<li><a href="../de471140/index.html">Vorbereitung auf die Spring Professional-Zertifizierung. Fr√ºhlingsruhe</a></li>
<li><a href="../de471142/index.html">12 ES10-Funktionen in 12 einfachen Beispielen</a></li>
<li><a href="../de471150/index.html">‚ÄûWie man mit Intellektuellen umgeht. Ich, Nerds und Geeks "(kostenlose elektronische Version des Buches)</a></li>
<li><a href="../de471154/index.html">Zur√ºck in die Schule: Wie man Handheld-Tester f√ºr den Umgang mit Autotests ausbildet</a></li>
<li><a href="../de471158/index.html">ID @ Xbox in Russland: Erweiterung des Spielhorizonts</a></li>
<li><a href="../de471160/index.html">Problem bei der Installation von Ruby on Rails Ende 2019</a></li>
<li><a href="../de471162/index.html">Ank√ºndigung der Unterst√ºtzung f√ºr die native Bearbeitung von Jupyter-Notizb√ºchern in VS-Code</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>