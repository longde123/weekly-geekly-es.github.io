<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>📛 👏🏿 👛 Top 10 Bug Ditemukan di Proyek Java pada tahun 2019 😋 👨🏽‍🤝‍👨🏻 🤾🏽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="2019 akan segera berakhir, dan tim PVS-Studio sedang melihat kembali pencapaian tahun ini. Pada awal 2019, kami meningkatkan kemampuan diagnostik anal...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Top 10 Bug Ditemukan di Proyek Java pada tahun 2019</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pvs-studio/blog/481184/"><p></p><div style="text-align:center;"><img src="https://habrastorage.org/webt/n2/uy/oe/n2uyoeo7ko6owq_omdtzx419gty.png"></div><br>  2019 akan segera berakhir, dan tim PVS-Studio sedang melihat kembali pencapaian tahun ini.  Pada awal 2019, kami meningkatkan kemampuan diagnostik analis kami dengan menambahkan dukungan Java, yang memungkinkan kami untuk memeriksa dan meninjau proyek-proyek Java juga.  Kami telah menemukan banyak bug selama tahun ini, dan inilah 10 bug teratas kami yang ditemukan di proyek Java. <br><a name="habracut"></a><br><br><h2>  Tidak.  10: byte yang ditandatangani </h2><br>  Sumber: <a href="https://www.viva64.com/en/b/0663/">Analisis Kerangka Apache Dubbo RPC oleh PVS-Studio Static Code Analyzer</a> <br><br>  Ekspresi <a href="https://www.viva64.com/en/w/v6007/">V6007</a> 'endKey [i] &lt;0xff' selalu benar.  OptionUtil.java (32) <br><br><pre><code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">final</span></span></span><span class="hljs-function"> ByteSequence </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">prefixEndOf</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ByteSequence prefix)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] endKey = prefix.getBytes().clone(); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = endKey.length - <span class="hljs-number"><span class="hljs-number">1</span></span>; i &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span>; i--) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (endKey[i] &lt; <span class="hljs-number"><span class="hljs-number">0xff</span></span>) { <span class="hljs-comment"><span class="hljs-comment">// &lt;= endKey[i] = (byte) (endKey[i] + 1); return ByteSequence.from(Arrays.copyOf(endKey, i + 1)); } } return ByteSequence.from(NO_PREFIX_END); }</span></span></code> </pre> <br>  Banyak programmer percaya bahwa tipe <i>byte</i> tidak ditandai.  Ini memang terjadi dalam banyak bahasa pemrograman.  Misalnya, ini berlaku untuk C #.  Tetapi tidak demikian halnya di Jawa. <br><br>  Dalam kondisi <i>endKey [i] &lt;0xff</i> , variabel tipe <i>byte</i> dibandingkan dengan angka 255 (0xff) yang diwakili dalam bentuk heksadesimal.  Pengembang mungkin lupa bahwa kisaran tipe <i>byte</i> Java adalah [-128, 127].  Kondisi ini akan selalu benar, dan <i>untuk</i> loop akan selalu memproses hanya elemen terakhir dari array <i>endKey</i> . <br><br><h2>  Tidak.  9: Dua dalam satu </h2><br>  Sumber: <a href="https://www.viva64.com/en/b/0621/">PVS-Studio untuk Jawa menyentuh jalan.</a>  <a href="https://www.viva64.com/en/b/0621/">Perhentian berikutnya adalah Elasticsearch</a> <br><br>  Ekspresi <a href="https://www.viva64.com/en/w/v6007/">V6007</a> '(int) x &lt;0' selalu salah.  BCrypt.java (429) <br><br>  <a href="https://www.viva64.com/en/w/v6025/">V6025</a> Kemungkinan indeks '(int) x' di luar batas.  BCrypt.java (431) <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">byte</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">char64</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> x)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)x &lt; <span class="hljs-number"><span class="hljs-number">0</span></span> || (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)x &gt; index_64.length) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> -<span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> index_64[(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)x]; }</code> </pre> <br>  Diskon!  Satu metode - dua bug!  Yang pertama berkaitan dengan tipe <i>char</i> : karena tidak ditandatangani di Java, kondisi <i>(int) x &lt;0</i> akan selalu salah.  Bug kedua adalah pengindeksan biasa di luar batas array <i>index_64</i> ketika <i>(int) x == index_64.length</i> .  Ini terjadi karena kondisi <i>(int) x&gt; index_64.length</i> .  Bug dapat diperbaiki dengan mengubah operator '&gt;' menjadi '&gt; =': <i>(int) x&gt; = index_64.length</i> . <br><br><h2>  Tidak.  8: Solusi dan implikasinya </h2><br>  Sumber: <a href="https://www.viva64.com/en/b/0626/">Menganalisis Kode Platform CUBA dengan PVS-Studio</a> <br><br>  Ekspresi <a href="https://www.viva64.com/en/w/v6007/">V6007</a> 'previousMenuItemFlatIndex&gt; = 0' selalu benar.  CubaSideMenuWidget.java (328) <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> MenuItemWidget </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">findNextMenuItem</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(MenuItemWidget currentItem)</span></span></span><span class="hljs-function"> </span></span>{ List&lt;MenuTreeNode&gt; menuTree = buildVisibleTree(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); List&lt;MenuItemWidget&gt; menuItemWidgets = menuTreeToList(menuTree); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> menuItemFlatIndex = menuItemWidgets.indexOf(currentItem); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> previousMenuItemFlatIndex = menuItemFlatIndex + <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (previousMenuItemFlatIndex &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-comment"><span class="hljs-comment">// &lt;= return menuItemWidgets.get(previousMenuItemFlatIndex); } return null; }</span></span></code> </pre> <br>  Penulis metode <i>findNextMenuItem</i> ingin menyingkirkan nilai -1 yang dikembalikan oleh metode <i>indexOf</i> ketika daftar <i>menuItemWidgets</i> tidak mengandung <i>currentItem</i> .  Untuk melakukan itu, programmer menambahkan 1 ke hasil <i>indexOf</i> (variabel <i>menuItemFlatIndex</i> ) dan menulis nilai yang dihasilkan ke variabel <i>beforeMenuItemFlatIndex</i> , yang kemudian digunakan dalam metode ini.  Penambahan -1 terbukti menjadi solusi yang buruk karena menyebabkan beberapa kesalahan sekaligus: <br><br><ul><li>  Pernyataan <i>null kembali tidak</i> akan pernah dieksekusi karena ekspresi <i>beforeMenuItemFlatIndex&gt; = 0</i> akan selalu benar;  Oleh karena itu, metode <i>findNextMenuItem</i> akan selalu kembali dari dalam pernyataan <i>if</i> ; </li><li>  <i>IndexOutOfBoundsException</i> akan dimunculkan ketika daftar <i>menuItemWidgets</i> telah menjadi kosong karena program akan mencoba mengakses elemen pertama dari daftar kosong; </li><li>  <i>IndexOutOfBoundsException</i> akan dimunculkan ketika argumen <i>currentItem</i> telah menjadi elemen terakhir dari daftar <i>menuItemWidget</i> . </li></ul><br><h2>  Tidak.  7: Membuat file dari ketiadaan </h2><br>  Sumber: <a href="https://www.viva64.com/en/b/0688/">Huawei Cloud: Berawan di PVS-Studio Hari Ini</a> <br><br>  <a href="https://www.viva64.com/en/w/v6008/">V6008</a> Potensi null dereference dari 'dataTmpFile'.  CacheManager.java (91) <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">putToCache</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(PutRecordsRequest putRecordsRequest)</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (dataTmpFile == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> || !dataTmpFile.exists()) { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { dataTmpFile.createNewFile(); <span class="hljs-comment"><span class="hljs-comment">// &lt;= } catch (IOException e) { LOGGER.error("Failed to create cache tmp file, return.", e); return; } } .... }</span></span></code> </pre> <br>  Saat menulis metode <i>putToCache</i> , programmer membuat kesalahan ketik dalam kondisi <i>dataTmpFile == null ||</i>  <i>! dataTmpFile.exists ()</i> sebelum membuat file baru <i>dataTmpFile.createNewFile ()</i> : mereka menulis operator '==' alih-alih '! ='.  Kesalahan ketik ini akan menyebabkan Anda melempar <i>NullPointerException</i> saat memanggil metode <i>createNewFile</i> .  Beginilah kondisinya dengan kesalahan pengetikan: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (dataTmpFile != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> || !dataTmpFile.exists())</code> </pre> <br>  Anda mungkin berpikir, “Baiklah, kita bisa santai sekarang.” Belum! <br><br>  Sekarang satu bug telah diperbaiki, satu lagi muncul.  <i>NullPointerException</i> dapat dilemparkan saat memanggil metode <i>dataTmpFile.exists ()</i> .  Untuk memperbaiki ini, kita perlu mengganti '||'  operator dengan '&amp;&amp;'.  Ini adalah versi terakhir dari kondisi, setelah semua perbaikan: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (dataTmpFile != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> &amp;&amp; !dataTmpFile.exists())</code> </pre> <br><h2>  Tidak.  6: Kesalahan logika yang sangat aneh </h2><br>  Sumber: <a href="https://www.viva64.com/en/b/0603/">PVS-Studio untuk Java</a> <br><br>  <a href="https://www.viva64.com/en/w/v6007/">V6007</a> [CWE-570] Ekspresi '"0". Equals (text)' selalu salah.  ConvertIntegerToDecimalPredicate.java 46 <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">satisfiedBy</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(@NotNull PsiElement element)</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-meta"><span class="hljs-meta">@NonNls</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String text = expression.getText().replaceAll(<span class="hljs-string"><span class="hljs-string">"_"</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (text == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> || text.length() &lt; <span class="hljs-number"><span class="hljs-number">2</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-string"><span class="hljs-string">"0"</span></span>.equals(text) || <span class="hljs-string"><span class="hljs-string">"0L"</span></span>.equals(text) || <span class="hljs-string"><span class="hljs-string">"0l"</span></span>.equals(text)) {<span class="hljs-comment"><span class="hljs-comment">// &lt;= return false; } return text.charAt(0) == '0'; }</span></span></code> </pre> <br>  Hal yang menarik tentang metode ini adalah mengandung kesalahan logika yang jelas.  Jika metode <i>puas dengan</i> tidak kembali setelah pernyataan <i>if</i> pertama, itu berarti bahwa string <i>teks</i> setidaknya dua karakter.  Ini juga berarti bahwa pemeriksaan pertama <i>"0". Sama dengan (teks)</i> di pernyataan berikutnya <i>jika</i> tidak ada artinya.  Apa yang sebenarnya dimaksud oleh programmer itu masih merupakan misteri. <br><br><h2>  Tidak.  5: Benar-benar aneh! </h2><br>  Sumber: <a href="https://www.viva64.com/en/b/0657/">PVS-Studio Mengunjungi Apache Hive</a> <br><br>  <a href="https://www.viva64.com/en/w/v6034/">V6034</a> Shift dengan nilai 'bitShiftsInWord - 1' bisa tidak konsisten dengan ukuran tipe: 'bitShiftsInWord - 1' = [-1 ... 30].  UnsignedInt128.java (1791) <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">shiftRightDestructive</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> wordShifts, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> bitShiftsInWord, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">boolean</span></span></span></span><span class="hljs-function"><span class="hljs-params"> roundUp)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (wordShifts == <span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; bitShiftsInWord == <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> (wordShifts &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> (bitShiftsInWord &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> (bitShiftsInWord &lt; <span class="hljs-number"><span class="hljs-number">32</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (wordShifts &gt;= <span class="hljs-number"><span class="hljs-number">4</span></span>) { zeroClear(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> shiftRestore = <span class="hljs-number"><span class="hljs-number">32</span></span> - bitShiftsInWord; <span class="hljs-comment"><span class="hljs-comment">// check this because "123 &lt;&lt; 32" will be 123. final boolean noRestore = bitShiftsInWord == 0; final int roundCarryNoRestoreMask = 1 &lt;&lt; 31; final int roundCarryMask = (1 &lt;&lt; (bitShiftsInWord - 1)); // &lt;= .... }</span></span></code> </pre> <br>  Dengan argumen input <i>wordShifts = 3</i> dan <i>bitShiftsInWord = 0</i> , variabel <i>roundCarryMask</i> , yang menyimpan hasil pergeseran bitwise <i>(1 &lt;&lt; (bitShiftsInWord - 1))</i> , akan menjadi angka negatif.  Pengembang mungkin tidak mengharapkan itu. <br><br><h2>  Tidak.  4: Bisakah kita melihat pengecualian? </h2><br>  Sumber: <a href="https://www.viva64.com/en/b/0657/">PVS-Studio Mengunjungi Apache Hive</a> <br><br>  <a href="https://www.viva64.com/en/w/v6051/">V6051</a> Penggunaan pernyataan 'kembali' di blok 'akhirnya' dapat menyebabkan hilangnya pengecualian yang tidak ditangani.  ObjectStore.java (9080) <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> List&lt;MPartitionColumnStatistics&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getMPartitionColumnStatistics</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(....)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> NoSuchObjectException, MetaException </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">boolean</span></span> committed = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { .... <span class="hljs-comment"><span class="hljs-comment">/*some actions*/</span></span> committed = commitTransaction(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result; } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Exception ex) { LOG.error(<span class="hljs-string"><span class="hljs-string">"Error retrieving statistics via jdo"</span></span>, ex); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ex <span class="hljs-keyword"><span class="hljs-keyword">instanceof</span></span> MetaException) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> (MetaException) ex; } <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MetaException(ex.getMessage()); } <span class="hljs-keyword"><span class="hljs-keyword">finally</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!committed) { rollbackTransaction(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Lists.newArrayList(); } } }</code> </pre> <br>  Deklarasi metode <i>getMPartitionColumnStatistics</i> menyesatkan karena dikatakan bisa melempar pengecualian.  Pada kenyataannya, pengecualian apa pun yang dihasilkan di blok <i>percobaan</i> , variabel yang <i>dikomit</i> akan selalu <i>salah</i> , sehingga pernyataan <i>kembali</i> di blok <i>akhirnya</i> akan mengembalikan nilai, sementara semua pengecualian yang dilemparkan akan hilang, tidak dapat diproses di luar metode.  Jadi, tidak ada pengecualian yang dilemparkan dalam metode ini yang dapat meninggalkannya. <br><br><h2>  Tidak.  3: Hocus-pocus, atau mencoba untuk mendapatkan topeng baru </h2><br>  Sumber: <a href="https://www.viva64.com/en/b/0657/">PVS-Studio Mengunjungi Apache Hive</a> <br><br>  <a href="https://www.viva64.com/en/w/v6034/">V6034</a> Shift dengan nilai 'j' bisa tidak konsisten dengan ukuran tipe: 'j' = [0 ... 63].  IoTrace.java (272) <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">logSargResult</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> stripeIx, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">boolean</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] rgsToRead)</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>, valOffset = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; elements; ++i, valOffset += <span class="hljs-number"><span class="hljs-number">64</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> val = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> j = <span class="hljs-number"><span class="hljs-number">0</span></span>; j &lt; <span class="hljs-number"><span class="hljs-number">64</span></span>; ++j) { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> ix = valOffset + j; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (rgsToRead.length == ix) <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!rgsToRead[ix]) <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; val = val | (<span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; j); <span class="hljs-comment"><span class="hljs-comment">// &lt;= } .... } .... }</span></span></code> </pre> <br>  Bug ini juga ada hubungannya dengan perubahan bitwise, tetapi tidak hanya itu.  Variabel <i>j</i> digunakan sebagai penghitung rentang [0 ... 63] di dalam <i>untuk</i> loop.  Penghitung ini berpartisipasi dalam shift bitwise <i>1 &lt;&lt; j</i> .  Semuanya tampak OK, tetapi di sinilah '1' integer literal dari tipe <i>int</i> (nilai 32-bit) ikut bermain.  Karena itu, pergeseran bitwise akan mulai mengembalikan nilai yang sebelumnya dikembalikan ketika nilai variabel <i>j</i> telah melebihi 31. Jika perilaku ini tidak seperti yang diinginkan oleh programmer, nilai 1 harus direpresentasikan sebagai <i>panjang</i> : <i>1L &lt;&lt; j</i> atau <i>(panjang) 1 &lt;&lt; j</i> . <br><br><h2>  Tidak.  2: Pesanan inisialisasi </h2><br>  Sumber: <a href="https://www.viva64.com/en/b/0688/">Huawei Cloud: Berawan di PVS-Studio Hari Ini</a> <br><br>  Siklus inisialisasi Kelas <a href="https://www.viva64.com/en/w/v6050/">V6050</a> hadir.  Inisialisasi 'INSTANCE' muncul sebelum inisialisasi 'LOG'.  UntrustedSSL.java (32), UntrustedSSL.java (59), UntrustedSSL.java (33) <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UntrustedSSL</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> UntrustedSSL INSTANCE = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> UntrustedSSL(); <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> Logger LOG = LoggerFactory.getLogger(UntrustedSSL.class); .... <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">UntrustedSSL</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { .... } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Throwable t) { LOG.error(t.getMessage(), t); <span class="hljs-comment"><span class="hljs-comment">// &lt;= } } }</span></span></code> </pre> <br>  Urutan bidang mana yang dideklarasikan dalam kelas membuat perbedaan karena mereka diinisialisasi dalam urutan yang sama mereka dideklarasikan.  Melupakan fakta ini menyebabkan bug yang sulit dipahami seperti yang ada di atas. <br><br>  Penganalisis menunjukkan bahwa bidang statis <i>LOG</i> didereferensi dalam konstruktor saat ini diinisialisasi ke nilai <i>nol</i> , yang mengarah ke melempar serangkaian pengecualian <i>NullPointerException</i> -&gt; <i>ExceptionInInitializerError</i> . <br><br>  Tetapi mengapa <i>LOG</i> bidang statis memiliki nilai <i>nol</i> pada saat memanggil konstruktor? <br><br>  <i>ExceptionInInitializerError</i> adalah petunjuknya.  Konstruktor sedang menginisialisasi <i>INSTANCE</i> bidang statis, yang dideklarasikan sebelum bidang <i>LOG</i> .  Itu sebabnya bidang <i>LOG</i> belum diinisialisasi ketika konstruktor dipanggil.  Agar kode ini berfungsi dengan baik, bidang <i>LOG</i> harus diinisialisasi sebelum panggilan. <br><br><h2>  Pertama: pemrograman berorientasi copy-paste </h2><br>  Sumber: <a href="https://www.viva64.com/en/b/0697/">Apache Hadoop Code Quality: Production VS Test</a> <br><br>  <a href="https://www.viva64.com/en/w/v6072/">V6072</a> Dua fragmen kode serupa ditemukan.  Mungkin, ini adalah kesalahan ketik dan variabel 'localFiles' harus digunakan daripada 'localArchives'.  LocalDistributedCacheManager.java (183), LocalDistributedCacheManager.java (178), LocalDistributedCacheManager.java (176), LocalDistributedCacheManager.java (181) <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">synchronized</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setup</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(JobConf conf, JobID jobId)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> IOException </span></span>{ .... <span class="hljs-comment"><span class="hljs-comment">// Update the configuration object with localized data. if (!localArchives.isEmpty()) { conf.set(MRJobConfig.CACHE_LOCALARCHIVES, StringUtils .arrayToString(localArchives.toArray(new String[localArchives // &lt;= .size()]))); } if (!localFiles.isEmpty()) { conf.set(MRJobConfig.CACHE_LOCALFILES, StringUtils .arrayToString(localFiles.toArray(new String[localArchives // &lt;= .size()]))); } .... }</span></span></code> </pre> <br>  Tempat pertama dalam daftar Top 10 kami diberikan untuk menyalin-menempel, atau, lebih tepatnya, bug yang berasal dari penggunaan teknik ini secara sembrono.  Pernyataan <i>if</i> kedua terlihat sangat mirip dengan salinan yang pertama, dengan beberapa variabel dimodifikasi: <br><br><ul><li>  <i>localArchives</i> diubah menjadi <i>LocalFiles</i> ; </li><li>  <i>MRJobConfig.CACHE_LOCALARCHIVES</i> diubah menjadi <i>MRJobConfig.CACHE_LOCALFILES</i> . </li></ul><br>  Tetapi programmer berhasil membuat kesalahan bahkan dalam operasi sederhana ini: pernyataan <i>if</i> di baris yang ditunjukkan oleh penganalisa masih menggunakan variabel <i>localArchives</i> bukannya variabel <i>localFiles</i> yang dimaksudkan. <br><br><h2>  Kesimpulan </h2><br>  Memperbaiki bug yang ditemukan pada tahap pengembangan selanjutnya atau setelah rilis membutuhkan banyak sumber daya.  Alat analisa statis PVS-Studio memungkinkan Anda untuk mendeteksi bug pada tahap pengkodean, sehingga membuatnya lebih mudah dan lebih murah.  Banyak <a href="https://www.viva64.com/en/customers/">perusahaan</a> telah membuat hidup pengembang mereka lebih mudah dengan mulai menggunakan analisa secara teratur.  Jika Anda ingin benar-benar menikmati pekerjaan Anda, cobalah <a href="https://www.viva64.com/en/pvs-studio-download/">PVS-Studio</a> . <br><br>  Kami tidak akan berhenti pada hal itu dan berencana untuk terus meningkatkan dan meningkatkan alat kami.  Nantikan diagnostik dan artikel baru dengan bug yang lebih menarik di tahun berikutnya. <br><br>  Saya melihat Anda suka petualangan!  Pertama, Anda mengalahkan <a href="https://habr.com/en/company/pvs-studio/blog/481174/">10 bug teratas dalam proyek C # pada tahun 2019</a> dan sekarang Anda berhasil dengan Java!  Selamat datang di tingkat berikutnya - artikel tentang <a href="https://habr.com/en/company/pvs-studio/blog/481188/">kesalahan terbaik dalam proyek C ++ pada 2019</a> . <br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/webt/24/2j/ex/242jexzqwnmth1lyfcrr8icxmms.png"></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id481184/">https://habr.com/ru/post/id481184/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id481174/index.html">10 Bug Top Ditemukan di Proyek C # pada tahun 2019</a></li>
<li><a href="../id481176/index.html">Kurir Yandex. Klub Makanan dan Pengiriman membutuhkan serikat pekerja</a></li>
<li><a href="../id481178/index.html">10 bug teratas dalam proyek C # untuk 2019</a></li>
<li><a href="../id481180/index.html">Apakah pengembang perlu menerima saran dari pengguna?</a></li>
<li><a href="../id481182/index.html">Seri Posting Layanan Istio</a></li>
<li><a href="../id481186/index.html">10 bug terbaik di proyek Java untuk 2019</a></li>
<li><a href="../id481188/index.html">10 Bug Top Ditemukan di Proyek C ++ pada 2019</a></li>
<li><a href="../id481190/index.html">10 bug teratas dalam proyek C ++ untuk 2019</a></li>
<li><a href="../id481200/index.html">Kontrol Suara dan VoiceOver: cara menyesuaikan aplikasi untuk orang buta atau diam</a></li>
<li><a href="../id481202/index.html">Antiquities: prinsip pengumpulan sampah dan hasil 2019</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>