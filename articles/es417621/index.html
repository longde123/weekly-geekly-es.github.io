<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üíÉüèΩ üåú üíÉ ¬øQu√© pas√≥ cuando desciframos la exhibici√≥n? üë©üèª‚Äç‚öïÔ∏è üîÑ üî∑</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Q RC OD E a trav√©s de una aplicaci√≥n m√≥vil para escanear las insignias de los expositores de proyectos de seguridad de la informaci√≥n. 

 El a√±o pasad...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>¬øQu√© pas√≥ cuando desciframos la exhibici√≥n?</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/417621/">  Q <b>RC</b> OD <b>E a</b> trav√©s de una aplicaci√≥n m√≥vil para escanear las insignias de los expositores de proyectos de seguridad de la informaci√≥n. <br><a name="habracut"></a><br>  El a√±o pasado, visitamos una gran exposici√≥n de proyectos de seguridad de la informaci√≥n en Londres.  En preparaci√≥n, nos enviaron nuestros pases en forma de archivos PDF ‚Äúimpr√≠malo usted mismo‚Äù. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/3cf/c19/9ba/3cfc199ba6b29143007fb4871a3536b5.png" alt="Insignia de expositor de Toms"></div><br>  Inmediatamente notamos dos tipos de c√≥digos de barras.  Curiosamente, el c√≥digo QR parec√≠a demasiado denso, dado que es suficiente para almacenar solo la identificaci√≥n del participante.  Siendo curiosos por naturaleza, lanzamos un esc√°ner QR y recibimos el contenido del c√≥digo: <br><br><pre><code class="hljs objectivec">{<span class="hljs-string"><span class="hljs-string">"CJe"</span></span>;<span class="hljs-string"><span class="hljs-string">"BHEEZST"</span></span>,<span class="hljs-string"><span class="hljs-string">"DO"</span></span>;<span class="hljs-string"><span class="hljs-string">"Cvmmfuqsppg"</span></span>,<span class="hljs-string"><span class="hljs-string">"G"</span></span>;<span class="hljs-string"><span class="hljs-string">"upn"</span></span>,<span class="hljs-string"><span class="hljs-string">"KU"</span></span>;<span class="hljs-string"><span class="hljs-string">"Qfofusbujpo uftufs"</span></span>,<span class="hljs-string"><span class="hljs-string">"T"</span></span>;<span class="hljs-string"><span class="hljs-string">"xzbuu"</span></span>}</code> </pre> <br>  Result√≥ ser casi, pero no del todo, JSON.  Una de las ventajas de un nombre tan corto como el m√≠o es que llama la atenci√≥n en tales situaciones.  Por lo tanto, inmediatamente not√© que mi nombre estaba codificado en ROT-25 ("tom" se convirti√≥ en "upn").  Tambi√©n se conoce como Cifrado de C√©sar, donde cada letra se reemplaza por otra con un desplazamiento fijo (en este caso, se utiliz√≥ la letra del alfabeto en lugar de cada letra).  Despu√©s de pasar la l√≠nea por el decodificador (teniendo en cuenta el marcado JSON), obtuvimos: <br><br><pre> <code class="hljs objectivec">{<span class="hljs-string"><span class="hljs-string">"BId"</span></span>;<span class="hljs-string"><span class="hljs-string">"AGDDYRS"</span></span>,<span class="hljs-string"><span class="hljs-string">"CN"</span></span>;<span class="hljs-string"><span class="hljs-string">"Bulletproof"</span></span>,<span class="hljs-string"><span class="hljs-string">"F"</span></span>;<span class="hljs-string"><span class="hljs-string">"tom"</span></span>,<span class="hljs-string"><span class="hljs-string">"JT"</span></span>;<span class="hljs-string"><span class="hljs-string">"Penetration tester"</span></span>,<span class="hljs-string"><span class="hljs-string">"S"</span></span>;<span class="hljs-string"><span class="hljs-string">"wyatt"</span></span>}</code> </pre> <br>  Esto es m√°s legible. <br><br><h2>  ¬øRomperlo? </h2><br>  Curiosamente, el c√≥digo QR almacena informaci√≥n que parece estar relacionada con el campo BId en la base de datos.  Por qu√©  Bueno, eso es bastante simple.  Los organizadores han creado una aplicaci√≥n m√≥vil para proveedores que les ayuda a recopilar los contactos de los participantes durante la exposici√≥n.  Asumimos que los datos est√°n encriptados en un c√≥digo QR en caso de que la se√±al de Wi-Fi o celular sea inestable. <br><br>  Hasta ahora, podemos hacer poco con esta informaci√≥n, excepto cambiar nuestros datos para evitar el spam de los proveedores del evento.  Ser√≠a divertido, pero dif√≠cilmente digno de un correo electr√≥nico al desarrollador del sistema.  Entonces, fuimos al Play Market e instalamos la aplicaci√≥n adecuada para ver qu√© hace. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/544/bf7/ff1/544bf7ff1910ec9044f73bf566dbb997.png" alt="Capturas de pantalla de la aplicaci√≥n."></div><br>  Y aqu√≠ encontramos un problema: no ten√≠amos los datos necesarios de los organizadores del evento.  Pensamos que podr√≠amos falsificar la respuesta del servidor utilizando el proxy MiTM, y la aplicaci√≥n nos dejar√° ir.  Configuramos Burpsuite y registramos algunos intentos fallidos de inicio de sesi√≥n, con la esperanza de interceptar el tr√°fico y jugar con √©l. <br><br>  Por desgracia, no tuvimos √©xito.  La aplicaci√≥n dirigi√≥ todas las solicitudes utilizando SOAP, y las respuestas no fueron obvias.  Sin embargo, el servidor publica documentos WSDL para la aplicaci√≥n. <br><br><h2>  Este no es el final </h2><br>  ¬øPor qu√© no escribir un servicio web falso para que ya no pueda acceder al servidor de aplicaciones real?  Unas horas m√°s tarde tuvimos un servicio de este tipo y todo el tr√°fico se activ√≥.  Funciona!  La aplicaci√≥n autenticada con cualquier dato y conectada a un evento falso. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c32/e23/0a9/c32e230a94d053e2bd63cc2f7849e4ba.png" alt="Show falso en la aplicaci√≥n"></div><br>  Escaneamos un par de insignias, y todo parec√≠a funcionar correctamente.  Progreso!  Despu√©s de deambular por la aplicaci√≥n durante un tiempo, se hizo evidente que estaba usando alg√∫n tipo de marco basado en WebView.  Excavando un poco en el APK, encontramos una serie de menciones de Sencha y Ext.js, que confirmaron nuestra suposici√≥n. <br><br>  Y ahora, lo m√°s interesante.  Si una aplicaci√≥n consta de una combinaci√≥n regular de HTML y JavaScript, ¬øpuede ser vulnerable a los ataques web est√°ndar?  Envolvimos algunos XSS en el "no-JSON" que la aplicaci√≥n espera, los escaneamos y ... <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/21c/64d/940/21c64d940bd21911a963ff8ee4a8a697.png" alt="Identificaci√≥n falsa en la aplicaci√≥n"></div><br><h2>  Lo rompimos </h2><br>  Genial  La inyecci√≥n de HTML en el campo "JT" mostr√≥ la imagen.  Podemos agregar el atributo "onerror" a esta etiqueta para lograr la ejecuci√≥n del script, pero estamos limitados por la restricci√≥n en la longitud m√°xima del c√≥digo QR.  Como resultado, creamos una carga √∫til que descarg√≥ el archivo JS del servidor y lo ejecut√≥ en el dispositivo.  Aqu√≠, por ejemplo, est√° la prueba de alerta est√°ndar (): <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/831/726/56e/83172656e9f9340bfec3447e8d24ac3f.png" alt="codificar una alerta"></div><br>  Escanear un c√≥digo de barras activa XSS y ejecuta el c√≥digo: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c9c/d23/7e2/c9cd237e297e61234ad05df380b52a3d.png" alt="Mostrando un defecto XSS"></div><br>  Lo picamos para que se ajuste perfectamente al tama√±o m√°ximo de un c√≥digo QR legible, no demasiado denso para imprimir en un pase.  Despu√©s de leer la documentaci√≥n de la API Ext.js y compararla con el c√≥digo APK descompilado, pudimos crear un c√≥digo de barras que: <br><br><ol><li>  Descargue un archivo JS de un servidor remoto </li><li>  Lee las claves de sesi√≥n desde un tel√©fono inteligente y las env√≠a a nuestro servidor </li><li>  Lee el contenido de la base de datos de contactos en cach√© de la aplicaci√≥n, incluidos los nombres y las direcciones de correo electr√≥nico de todos los pases que este dispositivo escane√≥ </li><li>  Elimina tu grabaci√≥n de un tel√©fono inteligente </li></ol><br>  Luego, el ataque se reduce a lo siguiente: el proveedor escanea mi c√≥digo QR a cambio de un bol√≠grafo gratuito, y obtengo una lista completa de todos los contactos escaneados por este dispositivo. <br><br>  Carga √∫til: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/23d/604/4fc/23d6044fccd94b03cdd82e833a6c0d65.png" alt="Mostrando la carga √∫til"><br><br>  Solicitudes al servidor web: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b3c/257/8de/b3c2578de409b7d6409e138f8aba5717.png" alt="Mostrando la respuesta del servidor"><br><br><h2>  Todo est√° bien, eso termina bien </h2><br>  Llamamos la atenci√≥n de los vendedores en la exposici√≥n, y despu√©s de algunas discusiones, decidieron no usar la aplicaci√≥n este a√±o.  Solo unas pocas personas en el evento aprovecharon la aplicaci√≥n, mientras que la mayor√≠a prefiri√≥ esc√°neres de c√≥digo de barras peque√±os y simples.  La aplicaci√≥n de Market se descarg√≥ solo unas 500 veces.  Sin embargo, este es un vector interesante para XSS, que muestra que realmente necesita filtrar los datos antes de usarlos, independientemente de su origen. <br><br>  Aunque esta aplicaci√≥n en particular no se ha utilizado ampliamente, ¬øimagina si la vulnerabilidad se encontrara en una aplicaci√≥n utilizada por miles o descargada por millones?  Todos estos datos ser√≠an para atacantes que los hubieran eliminado a su discreci√≥n: desde campa√±as de phishing hasta ataques de fuerza bruta. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es417621/">https://habr.com/ru/post/es417621/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es417609/index.html">Especializaci√≥n en programaci√≥n deportiva en el cursor</a></li>
<li><a href="../es417613/index.html">Ceph como almacenamiento conectable: 5 ideas pr√°cticas de un gran proyecto</a></li>
<li><a href="../es417615/index.html">Confesiones de Disk Cracker para Apple II: 4am Secrets</a></li>
<li><a href="../es417617/index.html">Cassandra por almacenar metadatos: √©xitos y fracasos</a></li>
<li><a href="../es417619/index.html">Win32 / Glupteba ya no est√° asociado con la operaci√≥n Windigo</a></li>
<li><a href="../es417627/index.html">Hyper CRM o Mini ERP? Negocio en mal estado</a></li>
<li><a href="../es417629/index.html">Edici√≥n comunitaria de Delphi y C ++ Builder</a></li>
<li><a href="../es417631/index.html">Tutorial de video CSS Grid</a></li>
<li><a href="../es417637/index.html">Desarrollo de un editor para crear sitios web / aterrizajes (experiencia)</a></li>
<li><a href="../es417639/index.html">El reverso del neuromancer. Parte 4: Sonido, Animaci√≥n, Huffman, Github</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>