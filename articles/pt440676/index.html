<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü•Ö ‚õΩÔ∏è üìÄ O dia em que Dodo parou. Script s√≠ncrono üéôÔ∏è üçï üòà</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dodo IS √© um sistema global que ajuda voc√™ a gerenciar efetivamente seus neg√≥cios na Dodo Pizza. Fecha quest√µes de pedidos de pizza, ajuda o franquead...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>O dia em que Dodo parou. Script s√≠ncrono</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/dodopizzadev/blog/440676/">  Dodo IS √© um sistema global que ajuda voc√™ a gerenciar efetivamente seus neg√≥cios na Dodo Pizza.  Fecha quest√µes de pedidos de pizza, ajuda o franqueado a acompanhar os neg√≥cios, melhora a efici√™ncia dos funcion√°rios e √†s vezes cai.  O √∫ltimo √© o pior para n√≥s.  Cada minuto dessas quedas leva √† perda de lucros, insatisfa√ß√£o do usu√°rio e noites sem dormir dos desenvolvedores. <br><br>  Mas agora dormimos melhor.  Aprendemos a reconhecer cen√°rios de apocalipse sist√™mico e process√°-los.  Abaixo, mostrarei como fornecemos estabilidade do sistema. <br><img src="https://habrastorage.org/webt/cj/_g/bz/cj_gbzxwy6ky8m_qqomj46f4nf4.png"><br><a name="habracut"></a><blockquote> <b>Uma s√©rie de artigos sobre o colapso do sistema Dodo IS *</b> : <br>  1. O <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">dia em que Dodo est√° parado.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Script s√≠ncrono.</a> <br>  2. O <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">dia em que o Dodo est√° parado.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Script ass√≠ncrono.</a> <br><br>  * Os <i>materiais foram escritos com base no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">meu desempenho no DotNext 2018 em Moscou</a></i> . </blockquote><br><h2>  Dodo √© </h2><br>  O sistema √© uma grande vantagem competitiva de nossa franquia, porque os franqueados obt√™m um modelo de neg√≥cios pronto.  Estes s√£o ERP, HRM e CRM, tudo em um. <br><br>  O sistema apareceu alguns meses ap√≥s a abertura da primeira pizzaria.  √â usado por gerentes, clientes, caixas, cozinheiros, compradores misteriosos, funcion√°rios de call center - isso √© tudo.  Convencionalmente, o Dodo IS √© dividido em duas partes.  O primeiro √© para os clientes.  Isso inclui um site, um aplicativo m√≥vel, um centro de contato.  O segundo para parceiros franqueados, ajuda a gerenciar pizzarias.  Por meio do sistema, faturas de fornecedores, gerenciamento de pessoal, pessoas que fazem turnos, contabilidade autom√°tica da folha de pagamento, treinamento on-line para pessoal, certifica√ß√£o de gerentes, sistema de controle de qualidade e compradores misteriosos passam pelo sistema. <br><br><h2>  Desempenho do sistema </h2><br>  Desempenho do sistema Dodo IS = Confiabilidade = Toler√¢ncia a falhas / recupera√ß√£o.  Vamos nos concentrar em cada um dos pontos. <br><br><h4>  Confiabilidade </h4><br>  N√£o temos grandes c√°lculos matem√°ticos: precisamos atender a um certo n√∫mero de pedidos, h√° certas zonas de entrega.  O n√∫mero de clientes n√£o varia particularmente.  √â claro que ficaremos felizes quando crescer, mas isso raramente acontece em grandes explos√µes.  Para n√≥s, o desempenho se resume a qu√£o poucas falhas ocorrem, √† confiabilidade do sistema. <br><br><h4>  Toler√¢ncia a falhas </h4><br>  Um componente pode depender de outro componente.  Se ocorrer um erro em um sistema, o outro subsistema n√£o deve cair. <br><br><h4>  Resili√™ncia </h4><br>  Falhas de componentes individuais ocorrem todos os dias.  Isso √© normal.  √â importante a rapidez com que podemos nos recuperar de uma falha. <br><br><h2>  Cen√°rio de falha do sistema s√≠ncrono </h2><br><h4>  O que √© isso </h4><br>  O instinto de um grande neg√≥cio √© atender muitos clientes ao mesmo tempo.  Assim como √© imposs√≠vel trabalhar para uma pizzaria de cozinha que trabalha para entrega da mesma maneira que uma dona de casa em uma cozinha em casa, um c√≥digo projetado para execu√ß√£o s√≠ncrona n√£o pode funcionar com √™xito no atendimento ao cliente em massa em um servidor. <br><br>  H√° uma diferen√ßa fundamental entre executar o algoritmo em uma √∫nica inst√¢ncia e executar o mesmo algoritmo que um servidor na estrutura de servi√ßo em massa. <br><br>  D√™ uma olhada na imagem abaixo.  √Ä esquerda, vemos como as solicita√ß√µes ocorrem entre dois servi√ßos.  Essas s√£o chamadas RPC.  A pr√≥xima solicita√ß√£o termina ap√≥s a anterior.  Obviamente, essa abordagem n√£o √© escal√°vel - pedidos adicionais ser√£o alinhados. <br><br>  Para atender a muitos pedidos, precisamos da op√ß√£o certa: <br><br><img src="https://habrastorage.org/webt/ce/ux/u0/ceuxu0aoqpmcgvnuvj0oboctjdm.png"><br><br>  A opera√ß√£o do c√≥digo de bloqueio em um aplicativo s√≠ncrono √© bastante afetada pelo modelo de multithreading usado, ou seja, multitarefa preemptiva.  S√≥ isso pode levar a falhas. <br><br>  A multitarefa simplificada e preventiva pode ser ilustrada da seguinte maneira: <br><br><img src="https://habrastorage.org/webt/k_/i3/pi/k_i3piihcieztws0hjgt-l6jw1q.png"><br><br>  Blocos coloridos s√£o o trabalho real que a CPU faz, e vemos que o trabalho √∫til indicado por verde no diagrama √© bastante pequeno no contexto geral.  Precisamos despertar o fluxo, coloc√°-lo para dormir, e isso √© uma sobrecarga.  Esse sono / vig√≠lia ocorre durante a sincroniza√ß√£o em quaisquer primitivas de sincroniza√ß√£o. <br><br>  Obviamente, o desempenho da CPU diminuir√° se voc√™ diluir o trabalho √∫til com um grande n√∫mero de sincroniza√ß√µes.  Com que intensidade a multitarefa preemptiva afeta o desempenho? <br><br>  Considere os resultados de um teste sint√©tico: <br><br><img src="https://habrastorage.org/webt/k5/vo/bh/k5vobhcdjza0tu5-gz5nkmxb2yu.png"><br><br>  Se o intervalo de fluxo entre as sincroniza√ß√µes for de cerca de 1000 nanossegundos, a efici√™ncia ser√° bastante pequena, mesmo que o n√∫mero de Threads seja igual ao n√∫mero de n√∫cleos.  Nesse caso, a efici√™ncia √© de cerca de 25%.  Se o n√∫mero de threads for 4 vezes maior, a efici√™ncia cai drasticamente, para 0,5%. <br><br>  Pense bem: na nuvem, voc√™ encomendou uma m√°quina virtual com 72 n√∫cleos.  Custa dinheiro e voc√™ usa menos da metade de um n√∫cleo.  √â exatamente isso que pode acontecer em um aplicativo multiencadeado. <br><br>  Se houver menos tarefas, mas sua dura√ß√£o for maior, a efici√™ncia aumenta.  Vemos que em 5.000 opera√ß√µes por segundo, em ambos os casos, a efici√™ncia √© de 80 a 90%.  Para um sistema multiprocessador, isso √© muito bom. <br><br><img src="https://habrastorage.org/webt/mk/h0/ku/mkh0kui8a2xqylkxs4obdexrpms.png"><br><br>  Em nossos aplicativos reais, a dura√ß√£o de uma opera√ß√£o entre sincroniza√ß√µes fica em algum lugar no meio, portanto o problema √© urgente. <br><br><h4>  O que est√° havendo? </h4><br>  Preste aten√ß√£o ao resultado do teste de estresse.  Nesse caso, era o chamado "teste de extrus√£o". <br><br><img src="https://habrastorage.org/webt/bs/cc/pu/bsccpuz17k6921f54mhkjzg3p_k.png"><br><br>  A ess√™ncia do teste √© que, usando um suporte de carga, enviamos mais e mais solicita√ß√µes artificiais ao sistema, tentamos fazer o maior n√∫mero poss√≠vel de pedidos por minuto.  Tentamos encontrar o limite ap√≥s o qual o aplicativo se recusar√° a atender solicita√ß√µes al√©m de seus recursos.  Intuitivamente, esperamos que o sistema seja executado at√© o limite, descartando solicita√ß√µes adicionais.  √â exatamente o que aconteceria na vida real, por exemplo - ao servir em um restaurante lotado de clientes.  Mas algo mais acontece.  Os clientes fizeram mais pedidos e o sistema come√ßou a servir menos.  O sistema come√ßou a atender t√£o poucos pedidos que pode ser considerado uma falha completa, avaria.  Isso acontece com muitos aplicativos, mas deveria ser? <br><br>  No segundo gr√°fico, o tempo para processar uma solicita√ß√£o aumenta, durante esse intervalo, menos solicita√ß√µes s√£o atendidas.  Os pedidos que chegaram mais cedo s√£o atendidos muito mais tarde. <br><br><img src="https://habrastorage.org/webt/au/ho/9y/auho9yjcdbtb8gqqbjytppvyuc0.png"><br><br>  Por que o aplicativo est√° parando?  Havia um algoritmo, funcionou.  Come√ßamos a partir da nossa m√°quina local, funciona muito rapidamente.  Pensamos que, se pegarmos uma m√°quina cem vezes mais poderosa e executarmos cem solicita√ß√µes id√™nticas, elas dever√£o ser executadas ao mesmo tempo.  Acontece que solicita√ß√µes de diferentes clientes colidem.  Entre eles, surge a conten√ß√£o e esse √© um problema fundamental em aplicativos distribu√≠dos.  Solicita√ß√µes separadas lutam por recursos. <br><br><h2>  Maneiras de encontrar um problema </h2><br>  Se o servidor n√£o funcionar, primeiro tentaremos encontrar e corrigir os problemas triviais dos bloqueios dentro do aplicativo, no banco de dados e durante a E / S do arquivo.  Ainda existe toda uma classe de problemas nas redes, mas at√© agora nos limitaremos a esses tr√™s, isso √© suficiente para aprender a reconhecer problemas semelhantes e estamos principalmente interessados ‚Äã‚Äãnos problemas que causam a Conten√ß√£o - a luta por recursos. <br><br><h4>  Bloqueios em processo </h4><br>  Aqui est√° uma solicita√ß√£o t√≠pica em um aplicativo de bloqueio. <br><img src="https://habrastorage.org/webt/xn/za/vw/xnzavw3w6riwwwnd9tblut9pj0m.png"><br>  Essa √© uma varia√ß√£o do diagrama de sequ√™ncia que descreve o algoritmo para a intera√ß√£o do c√≥digo do aplicativo e do banco de dados como resultado de alguma opera√ß√£o condicional.  Vemos que uma chamada de rede est√° sendo feita e, em seguida, algo acontece no banco de dados - o banco de dados √© um pouco usado.  Em seguida, outro pedido √© feito.  Durante todo o per√≠odo, uma transa√ß√£o no banco de dados e uma chave comum a todas as solicita√ß√µes s√£o usadas.  Pode ser dois clientes diferentes ou dois pedidos diferentes, mas um e o mesmo objeto de menu de restaurante, armazenados no mesmo banco de dados dos pedidos dos clientes.  Trabalhamos usando uma transa√ß√£o para obter consist√™ncia; duas consultas cont√™m Conten√ß√£o na chave do objeto comum. <br><br>  Vamos ver como ele escala. <br><img src="https://habrastorage.org/webt/ej/wl/s1/ejwls1dfpfr0hzq-ysxsvakwm9m.png"><br>  Thread dorme na maioria das vezes.  Ele, de fato, n√£o faz nada.  Temos um bloqueio que interfere com outros processos.  O mais irritante √© que a opera√ß√£o menos √∫til em uma transa√ß√£o que bloqueou uma chave ocorre no in√≠cio.  Aumenta as transa√ß√µes de escopo no tempo. <br><br>  Vamos lutar dessa maneira. <br><pre><code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> fallback = FallbackPolicy&lt;OptionalData&gt; .Handle&lt;OperationCancelledException&gt;() .FallbackAsync&lt;OptionalData&gt;(OptionalData.Default); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> optionalDataTask = fallback .ExecuteAsync(<span class="hljs-keyword"><span class="hljs-keyword">async</span></span> () =&gt; <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> CalculateOptionalDataAsync()); <span class="hljs-comment"><span class="hljs-comment">//‚Ä¶ var required = await CalculateRequiredData(); var optional = await optionalDataTask; var price = CalculatePriceAsync(optional, required);</span></span></code> </pre> <br>  Esta √© a consist√™ncia eventual.  Assumimos que alguns de nossos dados podem ser menos recentes.  Para fazer isso, precisamos trabalhar com o c√≥digo de maneira diferente.  Devemos aceitar que os dados s√£o de qualidade diferente.  N√£o veremos o que aconteceu antes - o gerente alterou algo no menu ou o cliente clicou no bot√£o "checkout".  Para n√≥s, n√£o faz diferen√ßa qual deles pressionou o bot√£o dois segundos antes.  E para os neg√≥cios n√£o h√° diferen√ßa. <br><br>  N√£o h√° diferen√ßa, podemos fazer exatamente isso.  Condicionalmente, chame-o de opcionalData.  Ou seja, algum valor que podemos prescindir.  Temos um fallback - o valor que obtemos do cache ou passamos algum valor padr√£o.  E para a opera√ß√£o mais importante (a vari√°vel necess√°ria), aguardaremos.  Vamos esperar por ele com firmeza e s√≥ ent√£o esperaremos uma resposta aos pedidos de dados opcionais.  Isso nos permitir√° acelerar o trabalho.  H√° outro ponto significativo - essa opera√ß√£o pode n√£o ser realizada por algum motivo.  Suponha que o c√≥digo para esta opera√ß√£o n√£o seja o ideal e no momento exista um erro.  Se a opera√ß√£o falhar, fa√ßa o fallback.  E ent√£o trabalhamos com isso como com o significado usual. <br><br><h4>  DB Locks </h4><br>  Obtemos aproximadamente o mesmo layout quando reescrevemos em ass√≠ncrono e alteramos o modelo de consist√™ncia. <br><img src="https://habrastorage.org/webt/aw/lq/xv/awlqxvspzylkqut1gklosn6pooi.png"><br>  O que importa aqui n√£o √© que a solicita√ß√£o tenha se tornado mais r√°pida no tempo.  O importante √© que n√£o temos conten√ß√£o.  Se adicionarmos solicita√ß√µes, apenas o lado esquerdo da imagem ficar√° saturado conosco. <br><img src="https://habrastorage.org/webt/_y/to/gz/_ytogzwl2pvkvzuxjy6mt365xnm.png"><br><br>  Esta √© uma solicita√ß√£o de bloqueio.  Aqui os Threads se sobrep√µem e as chaves nas quais a Conten√ß√£o ocorre.  √Ä direita, n√£o temos nenhuma transa√ß√£o no banco de dados e elas s√£o executadas silenciosamente.  O caso certo pode funcionar neste modo indefinidamente.  Esquerda causar√° uma falha no servidor. <br><br><h4>  Sync io </h4><br>  √Äs vezes, precisamos de logs de arquivos.  Surpreendentemente, o sistema de registro pode causar falhas desagrad√°veis.  Lat√™ncia em disco no Azure - 5 milissegundos.  Se escrevermos um arquivo em uma linha, ser√£o apenas 200 solicita√ß√µes por segundo.  √â isso a√≠, o aplicativo parou. <br><img src="https://habrastorage.org/webt/4f/ye/oz/4fyeozpwhurta8vmpo6qelgvot4.png"><br><br>  S√≥ que seu cabelo fica arrepiado quando voc√™ v√™ isso - mais de 2000 Threads foram criados no aplicativo.  78% de todos os segmentos s√£o da mesma pilha de chamadas.  Eles pararam no mesmo local e est√£o tentando entrar no monitor.  Este monitor delimita o acesso ao arquivo em que todos n√≥s registramos.  Claro, isso deve ser cortado. <br><img src="https://habrastorage.org/webt/ga/7f/27/ga7f27rhtreou-lssvsrcfjcvzo.png"><br>  Aqui est√° o que voc√™ precisa fazer no NLog para configur√°-lo.  Criamos um alvo ass√≠ncrono e escrevemos nele.  E o destino ass√≠ncrono grava no arquivo real.  Obviamente, podemos perder uma certa quantidade de mensagens no log, mas o que √© mais importante para os neg√≥cios?  Quando o sistema caiu por 10 minutos, perdemos um milh√£o de rublos.  Provavelmente, √© melhor perder v√°rias mensagens no log de servi√ßo, que falharam e foram reinicializadas. <br><br><h2>  Tudo est√° muito ruim </h2><br>  A conten√ß√£o √© um grande problema em aplicativos com v√°rios threads, o que n√£o permite que voc√™ simplesmente dimensione um aplicativo com thread √∫nico.  As fontes de conten√ß√£o precisam ser capazes de identificar e eliminar.  Um grande n√∫mero de threads √© desastroso para aplicativos e as chamadas de bloqueio devem ser reescritas para serem ass√≠ncronas. <br><br>  Eu tive que reescrever muito legado do bloqueio de chamadas ass√≠ncronas, eu mesmo frequentemente iniciei essa atualiza√ß√£o.  Frequentemente, algu√©m aparece e pergunta: "Ou√ßa, estamos reescrevendo h√° duas semanas, quase todas ass√≠ncronas.  E quanto vai funcionar mais r√°pido? ‚Äù  Gente, eu vou incomod√°-lo - n√£o vai funcionar mais r√°pido.  Vai se tornar ainda mais lento.  Afinal, o TPL √© um modelo competitivo em cima do outro - multitarefa cooperativa sobre multitarefa preemptiva, e isso √© uma sobrecarga.  Em um de nossos projetos - aproximadamente + 5% para uso e carregamento da CPU no GC. <br><br>  H√° mais uma not√≠cia ruim - o aplicativo pode funcionar muito pior depois de reescrever no modo ass√≠ncrono, sem perceber os recursos do modelo competitivo.  Falarei sobre esses recursos em detalhes no pr√≥ximo artigo. <br><br>  Isso levanta a quest√£o - √© necess√°rio reescrever? <br><br>  O c√≥digo s√≠ncrono √© reescrito no modo ass√≠ncrono, a fim de desvincular o modelo da execu√ß√£o competitiva do processo (Modelo de Concorr√™ncia) e livrar-se do modelo de Multitarefa Preemptiva.  Vimos que o n√∫mero de threads pode afetar adversamente o desempenho, portanto, voc√™ precisa se libertar da necessidade de aumentar o n√∫mero de threads para aumentar a simultaneidade.  Mesmo se tivermos o Legacy e n√£o quisermos reescrever esse c√≥digo, esse √© o principal motivo para reescrev√™-lo. <br><br>  A boa not√≠cia no final √© que agora sabemos algo sobre como se livrar dos problemas triviais da Conten√ß√£o de c√≥digo de bloqueio.  Se voc√™ encontrar esses problemas em seu aplicativo de bloqueio, √© hora de se livrar deles antes de reescrever para ass√≠ncrono, porque eles n√£o desaparecer√£o por conta pr√≥pria. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt440676/">https://habr.com/ru/post/pt440676/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt440662/index.html">Tutorial Reagir Parte 18: A sexta fase do trabalho em um aplicativo TODO</a></li>
<li><a href="../pt440666/index.html">Classifica√ß√£o de desenhos manuscritos. Relat√≥rio em Yandex</a></li>
<li><a href="../pt440670/index.html">O Banco Central publicou recomenda√ß√µes sobre a prote√ß√£o criptogr√°fica do EBS</a></li>
<li><a href="../pt440672/index.html">M√©todos de racionalidade e o tapete de ora√ß√£o do Magrebe</a></li>
<li><a href="../pt440674/index.html">Usando gr√°ficos de dispers√£o para visualizar dados</a></li>
<li><a href="../pt440678/index.html">DIY router CNC passatempo. Humanidades para as humanidades. Parte 2</a></li>
<li><a href="../pt440680/index.html">Como assistir amanh√£ igrofikuyuchi</a></li>
<li><a href="../pt440682/index.html">- E voc√™ produz g√°s l√° na ind√∫stria petroqu√≠mica, certo?</a></li>
<li><a href="../pt440688/index.html">Rela√ß√µes P√∫blicas em TI: como viver, para onde ir?</a></li>
<li><a href="../pt440690/index.html">Recursos do trabalho com o Mesh in Unity</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>