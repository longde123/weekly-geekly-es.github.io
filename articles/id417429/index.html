<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤶 🔵 🔒 Kami menyiapkan proyek npm yang nyaman untuk kami dan tim atau sedikit tentang alat modern front-end 👩‍🌾 🌅 🧑🏽‍🤝‍🧑🏽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Halo semuanya. Baru-baru ini saya menemukan tugas untuk menyiapkan paket npm pribadi. Semuanya terdengar sangat menarik dan menjanjikan sampai ternyat...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Kami menyiapkan proyek npm yang nyaman untuk kami dan tim atau sedikit tentang alat modern front-end</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/417429/"><p><img src="https://habrastorage.org/webt/de/cu/3u/decu3uxv998uiwmqbioi99ojnfi.png"></p><br><p>  Halo semuanya.  Baru-baru ini saya menemukan tugas untuk menyiapkan paket npm pribadi.  Semuanya terdengar sangat menarik dan menjanjikan sampai ternyata tidak banyak yang bisa dilakukan di sana.  Semuanya akan berakhir di sini, tetapi tugas kedua muncul - untuk menulis repositori demo untuk paket npm, yang dapat diambil, dikloning dan didasarkan padanya dengan cepat membuat sesuatu yang berguna dan dengan gaya yang sama. </p><br><p> Hasilnya adalah proyek dengan pemformatan yang disesuaikan, gaya kode, pengujian untuk setiap kumpulan, batas cakupan kode, laporan cakupan kode dan dokumentasi otomatis.  Ditambah penerbitan nyaman di npm.  Detail tentang pengaturan - di bawah potongan. </p><a name="habracut"></a><br><h2 id="trebovaniya">  Persyaratan </h2><br><p>  Pertama, saya menemukan apa yang sudah kita miliki: </p><br><ul><li>  Proyek-proyek baru ditulis dalam TypeScript </li><li>  Selain proyek-proyek baru, ada banyak proyek dalam JavaScript murni </li><li>  Ada persyaratan untuk menulis tes dan hasilnya harus dikirim untuk analisis </li></ul><br><p>  Lalu ia memperkirakan Daftar Keinginannya - karena ada waktu dan keinginan, mengapa tidak santai saja.  Yang saya inginkan lebih banyak: </p><br><ul><li>  Saya ingin gaya pemformatan yang seragam </li><li>  Saya ingin gaya TypeScript terpadu </li><li>  Saya ingin dokumentasi, tetapi saya tidak ingin menulisnya </li><li>  Secara umum, saya ingin mengotomatiskan semuanya dengan maksimal.  Apa yang akan fyr-fyr-fyr dan dalam produksi </li></ul><br><p>  Akibatnya, persyaratan mulai berlaku sebagai berikut: </p><br><ul><li>  Modul harus TypeScript dan diuji menggunakan TsLint </li><li>  Modul harus digunakan dari bawah TypeScript dan dari bawah JavaScript </li><li>  Pengujian harus dikonfigurasi pada git hook, cakupan kode minimum juga harus dikonfigurasi, statistik seharusnya </li><li>  Pemformatan harus dikonfigurasikan </li><li>  Dokumentasi harus dibuat dari kode. </li><li>  Publikasi harus nyaman dan konsisten. </li><li>  Semua itu bisa otomatis </li></ul><br><p>  Tampaknya menyenangkan, Anda perlu mencoba. </p><br><h2 id="predvaritelnye-telodvizheniya">  Gerakan awal </h2><br><p>  Kami membuat (mengkloning) repositori, menginisialisasi package.json, mengatur TypeScript secara lokal.  Secara umum, kami mengatur semua dependensi secara lokal, karena  semuanya akan masuk ke server.  Jangan lupa untuk <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">memperbaiki dependensi versi</a> . </p><br><pre><code class="hljs swift">git <span class="hljs-keyword"><span class="hljs-keyword">init</span></span> npm <span class="hljs-keyword"><span class="hljs-keyword">init</span></span> npm i -<span class="hljs-type"><span class="hljs-type">D</span></span> typescript ./node_modules/.bin/tsc --<span class="hljs-keyword"><span class="hljs-keyword">init</span></span></code> </pre> <br><p>  Segera di tempat Anda perlu mengubah tsconfig.json untuk diri Anda sendiri - tetapkan target, libs, sertakan / kecualikan, outDir, dan opsi lainnya. </p><br><h2 id="stil-formatirovaniya">  Gaya pemformatan </h2><br><p>  Untuk mempertahankan format seragam, saya mengambil dua alat.  Yang pertama adalah file .editorconfig.  Ini dipahami oleh semua IDE utama (WebStorm, VSCode, Visual Studio, dll.), Tidak memerlukan instalasi apa pun yang berlebihan, dan bekerja dengan sejumlah besar tipe file - js, ts, md, dan sebagainya. </p><br><pre> <code class="hljs vbscript">#root = <span class="hljs-literal"><span class="hljs-literal">true</span></span> [*] indent_style = <span class="hljs-built_in"><span class="hljs-built_in">space</span></span> end_of_line = lf charset = utf<span class="hljs-number"><span class="hljs-number">-8</span></span> trim_trailing_whitespace = <span class="hljs-literal"><span class="hljs-literal">true</span></span> insert_final_newline = <span class="hljs-literal"><span class="hljs-literal">true</span></span> max_line_length = <span class="hljs-number"><span class="hljs-number">100</span></span> indent_size = <span class="hljs-number"><span class="hljs-number">4</span></span> [*.md] trim_trailing_whitespace = <span class="hljs-literal"><span class="hljs-literal">false</span></span></code> </pre> <br><p>  Sekarang, autoformatting akan berperilaku kurang lebih sama dengan kolega saya. </p><br><p>  Alat kedua <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">lebih cantik</a> .  Ini adalah paket npm yang memeriksa dan, jika mungkin, secara otomatis memperbaiki format teks Anda.  Instal secara lokal dan tambahkan perintah pertama ke package.json </p><br><pre> <code class="hljs matlab">npm <span class="hljs-built_in"><span class="hljs-built_in">i</span></span> -D prettier</code> </pre> <br><p>  package.json </p><br><pre> <code class="hljs css">"<span class="hljs-selector-tag"><span class="hljs-selector-tag">prettier</span></span>": "<span class="hljs-selector-tag"><span class="hljs-selector-tag">prettier</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">--config</span></span> <span class="hljs-selector-class"><span class="hljs-selector-class">.prettierrc</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.json</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">--write</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">src</span></span><span class="hljs-comment"><span class="hljs-comment">/**/</span></span>*<span class="hljs-selector-class"><span class="hljs-selector-class">.ts</span></span>"</code> </pre> <br><p>  Prettier tidak memiliki perintah init, jadi Anda perlu <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">mengkonfigurasinya</a> secara manual.  Buat .prettierrc.json di root proyek dengan sesuatu seperti konten kontroversial ini (jika ada, posnya sama sekali bukan tentang kutipan mana yang lebih baik, tetapi Anda dapat mencoba) </p><br><p>  .prettierrc.json </p><br><pre> <code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"tabWidth"</span></span>: <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-attr"><span class="hljs-attr">"useTabs"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"semi"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"singleQuote"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"trailingComma"</span></span>: <span class="hljs-string"><span class="hljs-string">"es5"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"arrowParens"</span></span>: <span class="hljs-string"><span class="hljs-string">"always"</span></span> }</code> </pre> <br><p>  Sekarang buat folder src, buat index.ts dengan beberapa konten bersyarat di dalamnya dan coba jalankan lebih cantik.  Jika dia tidak menyukai format Anda, ia akan memperbaikinya secara otomatis.  Sangat nyaman  Jika Anda tidak ingin mengingat ini hanya selama komit / push, Anda dapat <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">mengonfigurasinya untuk autorun</a> atau menginstal ekstensi untuk studio. </p><br><h2 id="stil-koda">  Gaya Kode </h2><br><p>  Dengan gaya kode, semuanya juga tidak rumit.  Untuk JavaScript, ada <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">eslint</a> , untuk TypeScript, ada <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">tslint</a> .  Kami menempatkan tslint dan membuat tsconfig.js untuk menyimpan pengaturan </p><br><pre> <code class="hljs coffeescript"><span class="hljs-built_in"><span class="hljs-built_in">npm</span></span> i -D tslint .<span class="hljs-regexp"><span class="hljs-regexp">/node_modules/</span></span>.bin/tslint --init</code> </pre> <br><p>  package.json </p><br><pre> <code class="hljs objectivec"><span class="hljs-string"><span class="hljs-string">"lint"</span></span>: <span class="hljs-string"><span class="hljs-string">"tslint -c tslint.json 'src/**/*.ts' 'tests/**/*.spec.ts'"</span></span></code> </pre> <br><p>  Anda bisa menulis aturan Anda sendiri, atau Anda bisa menggunakan aturan yang ada menggunakan parameter extended.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Di sini</a> , misalnya, konfigurasi dari airbnb. </p><br><div class="spoiler">  <b class="spoiler_title">Pengembang Tslint sedang bercanda</b> <div class="spoiler_text"><pre> <code class="hljs powershell">module.exports = { extends: <span class="hljs-string"><span class="hljs-string">"./tslint-base.json"</span></span>, rules: { <span class="hljs-string"><span class="hljs-string">"no-excessive-commenting"</span></span>: [<span class="hljs-type"><span class="hljs-type">true</span></span>, {<span class="hljs-type"><span class="hljs-type">maxComments</span></span>: <span class="hljs-type"><span class="hljs-type">Math.random</span></span>() * <span class="hljs-number"><span class="hljs-number">10</span></span>}] } };</code> </pre> <br><p>  Bukankah itu cantik? </p></div></div><br><p>  Ada poin penting - persimpangan tslint dan lebih cantik dalam fungsi (misalnya, dalam panjang string atau "menggantung" koma).  Jadi, jika Anda menggunakan keduanya, Anda perlu memantau kepatuhan atau meninggalkan sesuatu. </p><br><p>  Namun, bagi mereka yang ingin memeriksa tidak semua file, tetapi hanya dipentaskan - ada paket <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">bertahap</a> </p><br><h2 id="testy">  Tes </h2><br><p>  Apa yang kita butuhkan dari semua tes di atas?  Pertama, sehingga mereka mulai secara otomatis, kedua, kontrol cakupan, ketiga laporan, lebih disukai dalam format lcov (jika ada, lcov dipahami dengan baik oleh analis yang berbeda - dari SonarQube ke CodeCov).  Kami akan berurusan dengan otomasi sedikit kemudian, sambil menyiapkan tes sendiri. </p><br><p>  Kami <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">menempatkan karma</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">melati</a> , dan semua kotak tubuh yang sesuai </p><br><pre> <code class="hljs powershell">npm i <span class="hljs-literal"><span class="hljs-literal">-D</span></span> karma karma<span class="hljs-literal"><span class="hljs-literal">-jasmine</span></span> jasmine karma<span class="hljs-literal"><span class="hljs-literal">-typescript</span></span> karma<span class="hljs-literal"><span class="hljs-literal">-chrome</span></span><span class="hljs-literal"><span class="hljs-literal">-launcher</span></span> @types/jasmine ./node_modules/.bin/karma init</code> </pre> <br><p>  Kami memodifikasi karma.conf.js sedikit dan segera mengkonfigurasi pekerjaan dengan cakupan </p><br><div class="spoiler">  <b class="spoiler_title">karma.conf.js</b> <div class="spoiler_text"><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">karmaTypescriptConfig</span></span> : { <span class="hljs-attribute"><span class="hljs-attribute">include</span></span>: [<span class="hljs-string"><span class="hljs-string">"./src/**/*.ts"</span></span>, <span class="hljs-string"><span class="hljs-string">"./tests/**/*.spec.ts"</span></span>], tsconfig: <span class="hljs-string"><span class="hljs-string">"./tsconfig.json"</span></span>, reports: { <span class="hljs-string"><span class="hljs-string">"html"</span></span>: <span class="hljs-string"><span class="hljs-string">"coverage"</span></span>, <span class="hljs-string"><span class="hljs-string">"lcovonly"</span></span>: { directory: <span class="hljs-string"><span class="hljs-string">'./coverage'</span></span>, filename: <span class="hljs-string"><span class="hljs-string">'../lcov.dat'</span></span> } }, <span class="hljs-selector-tag"><span class="hljs-selector-tag">coverageOptions</span></span>: { <span class="hljs-attribute"><span class="hljs-attribute">threshold</span></span>: { global: { statements: <span class="hljs-number"><span class="hljs-number">60</span></span>, branches: <span class="hljs-number"><span class="hljs-number">60</span></span>, functions: <span class="hljs-number"><span class="hljs-number">60</span></span>, lines: <span class="hljs-number"><span class="hljs-number">60</span></span>, excludes: [] }, <span class="hljs-selector-tag"><span class="hljs-selector-tag">file</span></span>: { <span class="hljs-attribute"><span class="hljs-attribute">statements</span></span>: <span class="hljs-number"><span class="hljs-number">60</span></span>, branches: <span class="hljs-number"><span class="hljs-number">60</span></span>, functions: <span class="hljs-number"><span class="hljs-number">60</span></span>, lines: <span class="hljs-number"><span class="hljs-number">60</span></span>, excludes: [], overrides: {} } } }, }</code> </pre> </div></div><br><p>  Dan, tentu saja, jangan lupa untuk menambahkan perintah baru ke package.json </p><br><p>  package.json </p><br><pre> <code class="hljs objectivec"><span class="hljs-string"><span class="hljs-string">"test"</span></span>: <span class="hljs-string"><span class="hljs-string">"karma start"</span></span></code> </pre> <br><p>  Jika Anda menggunakan atau berencana menggunakan CI, maka lebih baik meletakkan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">HeadlessChrome</a> : </p><br><pre> <code class="hljs matlab">npm <span class="hljs-built_in"><span class="hljs-built_in">i</span></span> -D puppeteer</code> </pre> <br><p>  Dan pra-konfigurasi Karma (perbaikan Chrome di ChromeHeadless) plus sesuatu yang lain.  Hasil edit dapat dilihat di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">repositori demo</a> . </p><br><p>  Jalankan tes, periksa apakah semuanya berfungsi.  Pada saat yang sama, periksa laporan cakupan (ada di folder cakupan) dan hapus dari kontrol versi, itu tidak diperlukan di repositori. </p><br><p>  Laporkan: </p><br><p><img src="https://habrastorage.org/webt/9h/0l/pi/9h0lpiplvfhu8pxbrawnnwysdw4.png"></p><br><h2 id="stil-kommitov">  Gaya berkomitmen </h2><br><p>  Komit juga dapat disatukan (dan pada saat yang sama membawa seseorang ke kehangatan, jika Anda berlebihan, jadi lebih baik tanpa fanatisme).  Untuk ini, saya mengambil <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">komitmen</a> .  Ia bekerja dalam bentuk dialog, mendukung format changelog konvensional (Anda dapat membuat changelog dari komitmennya) dan ada <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">plugin</a> VsCode untuknya </p><br><pre> <code class="hljs powershell">npm i <span class="hljs-literal"><span class="hljs-literal">-D</span></span> commitizen npm i <span class="hljs-literal"><span class="hljs-literal">-D</span></span> cz<span class="hljs-literal"><span class="hljs-literal">-conventional</span></span><span class="hljs-literal"><span class="hljs-literal">-changelog</span></span></code> </pre> <br><p>  cz-konvensional-changelog adalah adaptor yang bertanggung jawab atas pertanyaan, dan sebagai hasilnya, untuk format komit Anda </p><br><p>  Tambahkan perintah baru ke bagian skrip </p><br><pre> <code class="hljs objectivec"><span class="hljs-string"><span class="hljs-string">"commit"</span></span>:<span class="hljs-string"><span class="hljs-string">"git-cz"</span></span></code> </pre> <br><p>  Dan bagian package.json baru - konfigurasi untuk komit </p><br><pre> <code class="hljs objectivec"><span class="hljs-string"><span class="hljs-string">"config"</span></span>: { <span class="hljs-string"><span class="hljs-string">"commitizen"</span></span>: { <span class="hljs-string"><span class="hljs-string">"path"</span></span>: <span class="hljs-string"><span class="hljs-string">"./node_modules/cz-conventional-changelog"</span></span> } }</code> </pre> <br><p>  Dialog dengan komitmen terlihat seperti ini: </p><br><p><img src="https://habrastorage.org/webt/tn/xk/_l/tnxk_ll7a-chazpw8p0a2fnl3wk.png"></p><br><h2 id="dokumentaciya">  Dokumentasi </h2><br><p>  Sekarang ke dokumentasi.  Kami akan memiliki dua jenis dokumentasi - dari kode dan dari komitmen.  Untuk dokumentasi dari kode, saya mengambil <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">typedoc</a> (analog dengan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">esdoc</a> tetapi untuk TypeScript).  Sangat mudah untuk mengatur dan bekerja.  Hal utama adalah jangan lupa untuk menghapus hasil karyanya dari kontrol versi. </p><br><pre> <code class="hljs matlab">npm <span class="hljs-built_in"><span class="hljs-built_in">i</span></span> typedoc -D</code> </pre> <br><p>  dan perbarui package.json </p><br><p>  package.json </p><br><pre> <code class="hljs objectivec"><span class="hljs-string"><span class="hljs-string">"doc"</span></span>: <span class="hljs-string"><span class="hljs-string">"typedoc --out docs/src/ --readme ./README.md"</span></span></code> </pre> <br><p>  Bendera --readme akan memaksa readme untuk dimasukkan di halaman dokumentasi utama, yang nyaman. </p><br><p>  Jenis dokumentasi kedua adalah changelog, dan paket <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">konvensional-changelog-cli</a> akan membantu kami. </p><br><pre> <code class="hljs powershell">npm i <span class="hljs-literal"><span class="hljs-literal">-D</span></span> conventional<span class="hljs-literal"><span class="hljs-literal">-changelog</span></span><span class="hljs-literal"><span class="hljs-literal">-cli</span></span></code> </pre> <br><p>  package.json </p><br><pre> <code class="hljs objectivec"><span class="hljs-string"><span class="hljs-string">"changelog"</span></span>: <span class="hljs-string"><span class="hljs-string">"conventional-changelog -p angular -i CHANGELOG.md -s"</span></span></code> </pre> <br><p>  Dari sudut hanya ada pemformatan dan tidak lebih.  Sekarang untuk memperbarui changelog, jalankan npm run changelog.  Hal utama adalah menulis komit dengan hati-hati.  Yah, kami selalu menulis komitmen yang sempurna, jadi ini seharusnya tidak menjadi masalah. </p><br><h2 id="bild">  Membangun </h2><br><p>  Karena paket kami juga bisa digunakan untuk JavaScript, kami harus mengubah TypeScript menjadi JavaScript.  Selain itu, akan menyenangkan untuk membuat bundel yang diperkecil, untuk berjaga-jaga.  Untuk ini kita perlu <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">uglifyjs</a> dan sedikit paket <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">tweak.json</a> </p><br><pre> <code class="hljs matlab">npm <span class="hljs-built_in"><span class="hljs-built_in">i</span></span> -D uglifyjs</code> </pre> <br><p>  package.json </p><br><pre> <code class="hljs objectivec"><span class="hljs-string"><span class="hljs-string">"clean"</span></span>:<span class="hljs-string"><span class="hljs-string">"rmdir dist /S /Q"</span></span>, <span class="hljs-string"><span class="hljs-string">"build"</span></span>: <span class="hljs-string"><span class="hljs-string">"tsc --p ./ --sourceMap false"</span></span>, <span class="hljs-string"><span class="hljs-string">"bundle"</span></span>: <span class="hljs-string"><span class="hljs-string">"uglifyjs ./dist/*.js --compress --mangle --output ./dist/index.min.js"</span></span></code> </pre> <br><p>  Omong-omong, jika Anda ingin mengontrol ukuran proyek Anda, ada dua paket yang lebih menarik </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">bundel</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sizelimit</a> - hal yang sama tetapi di webpack </li></ul><br><p>  Mereka juga dapat diintegrasikan dalam proses commit / push / publish untuk tetap dalam ukuran bundel yang dapat diterima.  Sangat, sangat membantu. </p><br><h2 id="avtomatizaciya">  Otomasi </h2><br><p>  Yah, kami telah mengambil langkah-langkah dasar, sekarang semuanya perlu diotomatisasi, jika tidak maka akan sangat tidak nyaman untuk bekerja. </p><br><p>  Untuk ini kita perlu satu paket lagi - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">husky</a> .  Ia menulis ulang git hooks dan memanggil perintah yang terkait dari package.json.  Misalnya, ketika Anda komit, precommit akan bekerja, push - prepush, dan sebagainya.  Jika skrip mengembalikan kesalahan, komit akan gagal. </p><br><pre> <code class="hljs matlab">npm <span class="hljs-built_in"><span class="hljs-built_in">i</span></span> -D husky</code> </pre> <br><p>  package.json </p><br><pre> <code class="hljs objectivec"><span class="hljs-string"><span class="hljs-string">"precommit"</span></span>:<span class="hljs-string"><span class="hljs-string">"npm run prettier"</span></span>, <span class="hljs-string"><span class="hljs-string">"prepush"</span></span>: <span class="hljs-string"><span class="hljs-string">"call npm run lint &amp;&amp; call npm run test"</span></span></code> </pre> <br><p>  Ada nuansa penting di sini, penggunaan sintaks panggilan tidak lintas platform dan tidak akan lepas landas pada sistem unix.  Jadi jika Anda ingin melakukan semuanya dengan jujur, Anda harus menginstal paket <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">npm-run-all</a> juga, ia melakukan hal yang sama tetapi lintas-platform. </p><br><h2 id="publikaciya">  Posting </h2><br><p>  Nah, di sini kita sampai pada publikasi paket kami (walaupun kosong).  Mari kita pikirkan apa yang kita inginkan dari publikasi? </p><br><ul><li>  Uji semuanya lagi </li><li>  Kumpulkan artefak bangunan </li><li>  Kumpulkan dokumentasi </li><li>  Naikkan versi </li><li>  Tag pemicu </li><li>  Kirim ke npm </li></ul><br><p>  Tangan melakukan semuanya - sedih.  Atau Anda lupa sesuatu, atau Anda perlu menulis daftar periksa.  Juga perlu untuk mengotomatisasi.  Anda dapat meletakkan paket lain - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">lepaskan</a> .  Dan Anda dapat menggunakan kait asli dari npm sendiri - preversion, versi, postversion, misalnya seperti ini: </p><br><pre> <code class="hljs sql">"preversion": "npm run test", "version": "<span class="hljs-keyword"><span class="hljs-keyword">call</span></span> npm run clean &amp;&amp; <span class="hljs-keyword"><span class="hljs-keyword">call</span></span> npm run <span class="hljs-keyword"><span class="hljs-keyword">build</span></span> &amp;&amp; npm run bundle &amp;&amp; <span class="hljs-keyword"><span class="hljs-keyword">call</span></span> npm run doc &amp;&amp; <span class="hljs-keyword"><span class="hljs-keyword">call</span></span> npm run changelog &amp;&amp; git <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> . &amp;&amp; git <span class="hljs-keyword"><span class="hljs-keyword">commit</span></span> -m <span class="hljs-string"><span class="hljs-string">'changelogupdate'</span></span> <span class="hljs-comment"><span class="hljs-comment">--no-verify", "postversion": "git add . &amp;&amp; git push &amp;&amp; git push --tags",</span></span></code> </pre> <br><p>  Masih menentukan untuk package.json apa yang akan disertakan dalam paket, titik masuk dan path ke tipe kita (jangan lupa untuk menentukan flag --declaration di tsconfig.json untuk mendapatkan file d.ts) </p><br><p>  package.json </p><br><pre> <code class="hljs powershell"><span class="hljs-string"><span class="hljs-string">"main"</span></span>: <span class="hljs-string"><span class="hljs-string">"./dist/index.min.js"</span></span>, <span class="hljs-string"><span class="hljs-string">"types"</span></span>: <span class="hljs-string"><span class="hljs-string">"./dist/index.d.ts"</span></span>, <span class="hljs-string"><span class="hljs-string">"files"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"dist/"</span></span>, <span class="hljs-string"><span class="hljs-string">"src/"</span></span>, <span class="hljs-string"><span class="hljs-string">"tests/"</span></span> ]</code> </pre> <br><p>  Ya, sepertinya hanya itu saja.  Sekarang sudah cukup untuk dilakukan </p><br><pre> <code class="hljs coffeescript"><span class="hljs-built_in"><span class="hljs-built_in">npm</span></span> version ... <span class="hljs-built_in"><span class="hljs-built_in">npm</span></span> publish</code> </pre> <br><p>  Dan semuanya akan dilakukan secara otomatis. </p><br><h2 id="bonus">  Bonus </h2><br><p>  Sebagai bonus, ada <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">repositori demo</a> yang mendukung semua + CI ini menggunakan travis-ci.  Biarkan saya mengingatkan Anda bahwa HeadlessChrome dikonfigurasi di sana, jadi jika ini penting bagi Anda, saya sarankan Anda untuk melihat di sana. </p><br><h2 id="blagodarnosti">  Ucapan Terima Kasih </h2><br><p>  Terima kasih banyak kepada <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Alexei Volkov</a> untuk laporannya tentang JsFest, yang menjadi dasar artikel ini. </p><br><p>  Berkat <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" class="user_link">max7z</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" class="user_link">tidak bisa dihancurkan</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" class="user_link">justboris</a> untuk mengklarifikasi bahwa jalan menuju dependensi lokal dapat dihilangkan. </p><br><h2 id="i-nemnogo-statistiki">  Dan beberapa statistik </h2><br><ul><li>  Ukuran Node_modules: 444 MB (NTFS) </li><li>  Jumlah dependensi dari level pertama: 17 </li><li>  Total Paket Yang Digunakan: 643 </li></ul><br><h2 id="poleznye-ssylki">  Tautan yang bermanfaat </h2><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">.editorconfig</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">lebih cantik</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">tslint</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">eslint</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">typedoc</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">esdoc</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">warga negara</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">plugin commitizen untuk vscode</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">changelog konvensional</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">uglifyjs</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">bundel</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">tidur sebentar</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">serak</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">npm-run-all</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">lepaskan</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">repositori demo</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id417429/">https://habr.com/ru/post/id417429/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id417415/index.html">Pelajaran pencetakan 3D. Mencetak komponen dengan ketebalan lapisan berbeda dari 3Dtool</a></li>
<li><a href="../id417419/index.html">[Yekaterinburg, pengumuman] Alice mengunjungi Kontur - hackathon untuk menciptakan keterampilan bagi asisten suara</a></li>
<li><a href="../id417421/index.html">Menjadi buta warna: percobaan empati</a></li>
<li><a href="../id417423/index.html">33 tips untuk pemasaran ICO</a></li>
<li><a href="../id417427/index.html">Video dari mitral UralJS # 8 - bekerja dengan data mentah dalam peramban dan keterampilan menulis untuk Alice</a></li>
<li><a href="../id417431/index.html">Anti-wawancara</a></li>
<li><a href="../id417435/index.html">Kesalahan ketik ditemukan pada konfigurasi Aliens: Colonial Marines, yang menyebabkan game AI buggy selama empat tahun</a></li>
<li><a href="../id417437/index.html">Proyektor vs panel datar. Kami mencoba jubah dokter mata dan mencari tahu mengapa ukuran itu penting</a></li>
<li><a href="../id417441/index.html">Bagaimana kami merusak pemain biasa dan untuk DDoS atau server kami: panduan praktis</a></li>
<li><a href="../id417443/index.html">Organik di Mars dapat ditemukan 40 tahun lalu jika metode analisis yang berbeda digunakan</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>