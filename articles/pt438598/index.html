<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üì£ üìπ üëà React & BEM - colabora√ß√£o oficial. Parte hist√≥rica üåè ‚ùå ‚õ≤Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Aqui est√° a hist√≥ria da integra√ß√£o da metodologia BEM no universo React. O material que voc√™ ler√° √© baseado na experi√™ncia dos desenvolvedores Yandex ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>React & BEM - colabora√ß√£o oficial. Parte hist√≥rica</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yandex/blog/438598/"><p>  Aqui est√° a hist√≥ria da integra√ß√£o da metodologia BEM no universo React.  O material que voc√™ ler√° √© baseado na experi√™ncia dos desenvolvedores Yandex no desenvolvimento do maior e mais carregado servi√ßo na R√∫ssia - Yandex.Search.  Nunca falamos com tanto detalhe e profundidade sobre por que o fizemos, e n√£o de outra forma, o que nos motivou e o que realmente quer√≠amos.  O forasteiro recebeu lan√ßamentos secos e cr√≠ticas em confer√™ncias.  Somente √† margem podia-se ouvir algo assim.  Como co-autor, fiquei indignado por causa da escassez de informa√ß√µes externas sempre que falava sobre novas vers√µes de bibliotecas.  Mas desta vez vamos compartilhar todos os detalhes. </p><br><img src="https://habrastorage.org/webt/wb/mt/xc/wbmtxcvurtd6cdv1aomjrtcyfw8.png"><br><p>  Todo mundo j√° ouviu falar sobre a metodologia BEM.  Seletores de CSS com sublinhados.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">A abordagem de componente</a> mencionada, tendo em mente a maneira como os seletores de CSS CSS s√£o escritos.  Mas n√£o haver√° uma palavra sobre CSS no artigo.  Apenas JS, apenas hardcore! </p><a name="habracut"></a><br><p>  Para entender por que a metodologia apareceu e quais problemas a Yandex enfrentou, recomendo que voc√™ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">se familiarize com o hist√≥rico do</a> BEM. </p><br><h2 id="prolog">  Pr√≥logo </h2><br><p> O BEM realmente nasceu como uma salva√ß√£o da forte conectividade e aninhamento no CSS.  Mas dividir a planilha <code>style.css</code> em arquivos para cada bloco, elemento ou modificador inevitavelmente levou a uma estrutura semelhante do c√≥digo JavaScript. </p><br><p>  Em 2011, o Open Source adquiriu os <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">primeiros commits da estrutura</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><code>i-bem.js</code></a> , que funcionavam em conjunto com <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><code>bem-xjst</code></a> modelo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><code>bem-xjst</code></a> .  Ambas as tecnologias surgiram do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">XSLT</a> e serviram √† ideia popular de separar a l√≥gica de neg√≥cios e a apresenta√ß√£o de componentes.  No mundo exterior, esses foram os <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">grandes tempos do</a> guid√£o e do sublinhado. </p><br><p>  <code>bem-xjst</code> √© um tipo diferente de mecanismo de modelo.  Para aumentar meu conhecimento da arquitetura das abordagens de padroniza√ß√£o, recomendo vivamente o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">relat√≥rio de Sergei Berezhnoy</a> .  <code>bem-xjst</code> pode experimentar o <code>bem-xjst</code> modelo <code>bem-xjst</code> na <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">sandbox online</a> . </p><br><p>  Devido √†s especificidades dos servi√ßos de pesquisa Yandex, as interfaces do usu√°rio s√£o constru√≠das usando dados.  A p√°gina de resultados da pesquisa √© exclusiva para cada consulta. </p><br><p><img src="https://habrastorage.org/webt/6g/af/sc/6gafsczppz4ul8glzeliauwnkjc.png"><br>  <em>Consulta de pesquisa por <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">refer√™ncia</a></em> </p><br><p><img src="https://habrastorage.org/webt/ni/z5/nc/niz5ncgv3rlci2jfymornobfvcy.png"><br>  <em>Consulta de pesquisa por <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">link</a></em> </p><br><p><img src="https://habrastorage.org/webt/eb/6q/ws/eb6qws6vwtclkce_jsumewy4jkk.png"><br>  <em>Consulta de pesquisa por <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">refer√™ncia</a></em> </p><br><p>  Quando a divis√£o em um bloco, elemento e modificador se espalha pelo sistema de arquivos, isso permite coletar o m√°ximo poss√≠vel apenas o c√≥digo necess√°rio, de fato para cada p√°gina, para cada solicita√ß√£o do usu√°rio.  Mas como </p><br><pre> <code class="plaintext hljs">src/components ‚îú‚îÄ‚îÄ ComponentName ‚îÇ ‚îú‚îÄ‚îÄ _modName ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ ComponentName_modName.tsx ‚Äî   ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ ComponentName_modName_modVal.tsx ‚Äî    ‚îÇ ‚îú‚îÄ‚îÄ ElementName ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ ComponentName-ElementName.tsx ‚Äî   ComponentName ‚îÇ ‚îú‚îÄ‚îÄ ComponentName.i18n ‚Äî   ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ ru.ts ‚Äî     ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ en.ts ‚Äî     ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ index.ts ‚Äî    ‚îÇ ‚îú‚îÄ‚îÄ ComponentName.test ‚Äî   ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ ComponentName.page-object.js ‚Äî Page Object ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ ComponentName.hermione.js ‚Äî   ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ ComponentName.test.tsx ‚Äî unit- ‚îÇ ‚îú‚îÄ‚îÄ ComponentName.tsx ‚Äî    ‚îÇ ‚îú‚îÄ‚îÄ ComponentName.scss ‚Äî   ‚îÇ ‚îú‚îÄ‚îÄ ComponentName.examples.tsx ‚Äî    Storybook ‚îÇ ‚îî‚îÄ‚îÄ README.md ‚Äî  </code> </pre> <br><p>  <em>Estrutura moderna de diret√≥rio de componentes</em> </p><br><p>  Como em outras empresas, no Yandex, os desenvolvedores de interface s√£o respons√°veis ‚Äã‚Äãpelo frontend, que consiste na parte do cliente no navegador e na parte do servidor no <code>Node.js</code>  A parte do servidor processa os dados da pesquisa "grande" e imp√µe modelos a eles.  O processamento de dados prim√°rio converte JSON em <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">BEMJSON</a> , a estrutura de dados <code>bem-xjst</code> modelo <code>bem-xjst</code> .  O mecanismo de modelo percorre cada n√≥ da √°rvore e imp√µe um modelo a ele.  Como a convers√£o prim√°ria ocorre no servidor e, devido √† divis√£o em pequenas entidades, os n√≥s correspondem aos arquivos, durante a gera√ß√£o do modelo, enviamos o c√≥digo para o navegador que ser√° usado apenas na p√°gina atual. </p><br><p>  Abaixo est√° a correspond√™ncia dos n√≥s BEMJSON com os arquivos no sistema de arquivos. </p><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">module</span></span>.exports = { <span class="hljs-attr"><span class="hljs-attr">block</span></span>: <span class="hljs-string"><span class="hljs-string">'Select'</span></span>, <span class="hljs-attr"><span class="hljs-attr">elem</span></span>: <span class="hljs-string"><span class="hljs-string">'Item'</span></span>, <span class="hljs-attr"><span class="hljs-attr">elemMods</span></span>: { <span class="hljs-attr"><span class="hljs-attr">type</span></span>: <span class="hljs-string"><span class="hljs-string">'navigation'</span></span> } };</code> </pre> <br><pre> <code class="plaintext hljs">src/components ‚îú‚îÄ‚îÄ Select ‚îÇ ‚îú‚îÄ‚îÄ Item ‚îÇ ‚îÇ _type ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ Select-Item_type_navigation.js ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ Select-Item_type_navigation.css</code> </pre> <br><p>  O sistema modular <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><code>YModules</code></a> foi respons√°vel por isolar os componentes do c√≥digo JavaScript no navegador.  Ele permite que voc√™ entregue m√≥dulos de forma s√≠ncrona e ass√≠ncrona ao navegador.  Um exemplo de como os componentes funcionam com o <code>YModules</code> e o <code>i-bem.js</code> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">pode ser encontrado aqui</a> .  Hoje, para a maioria dos desenvolvedores, o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><code>  webpack</code></a> e o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">padr√£o</a> in√©dito <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">de importa√ß√µes din√¢micas fazem isso</a> . </p><br><p>  Um conjunto de metodologia BEM, mecanismo de modelo declarativo e estrutura JS com um sistema modular tornou poss√≠vel resolver qualquer problema.  Mas com o tempo, a din√¢mica chegou √†s interfaces do usu√°rio. </p><br><h2 id="novaya-nadezhda">  Nova esperan√ßa </h2><br><p>  Em 2013, o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">React encantou o</a> c√≥digo-fonte aberto.  De fato, o Facebook come√ßou a us√°-lo em 2011.  James Long, em suas anota√ß√µes da confer√™ncia <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">JS Conf US</a> , diz: </p><br><blockquote>  As duas √∫ltimas sess√µes foram uma surpresa.  O primeiro foi dado por dois desenvolvedores do Facebook e eles anunciaram o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Facebook React</a> .  N√£o fiz muitas anota√ß√µes porque fiquei meio chocado com a id√©ia que acho ruim.  Essencialmente, eles criaram uma linguagem chamada JSX, que permite incorporar XML em JavaScript para criar interfaces de usu√°rio reativas ao vivo.  XML  Em JavaScript. </blockquote><p>  O React mudou a abordagem para projetar aplicativos da web.  Tornou-se t√£o popular que hoje voc√™ n√£o consegue encontrar um desenvolvedor que nunca ouviu falar do React.  Mas outra coisa √© importante: as aplica√ß√µes se tornaram diferentes, o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">SPA</a> entrou em nossas vidas. </p><br><p>  √â geralmente aceito que os desenvolvedores Yandex tenham um senso especial de beleza com rela√ß√£o √† tecnologia.  √Äs vezes estranho, dif√≠cil de argumentar, mas nunca sem raz√£o.  Quando o React estava ganhando <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">estrelas no GitHub</a> , muitos que estavam familiarizados com as tecnologias da Web Yandex insistiram: o Facebook venceu, abandonou seu trabalho e reescreve tudo no React antes que seja tarde demais.  √â importante entender duas coisas. </p><br><p>  Em primeiro lugar, n√£o houve guerra.  As empresas n√£o competem na cria√ß√£o da melhor estrutura na Terra.  Se uma empresa come√ßar a gastar menos tempo (dinheiro de leitura) em tarefas de infraestrutura com a mesma produtividade, todos ser√£o beneficiados.  N√£o faz sentido escrever estruturas para escrever estruturas.  Os melhores desenvolvedores criam ferramentas que resolvem as tarefas da empresa da melhor maneira.  Empresas, servi√ßos, objetivos - √© tudo diferente.  Da√≠ a variedade de ferramentas. </p><br><p>  Em segundo lugar, est√°vamos procurando uma maneira de usar o React da maneira que gostar√≠amos que fosse.  Com todos os recursos que nossas tecnologias descritas acima forneceram. </p><br><p>  Acredita-se que o c√≥digo usando o React seja r√°pido por padr√£o.  Se voc√™ tamb√©m pensa assim, est√° profundamente enganado.  A √∫nica coisa que o React faz √©, na maioria dos casos, ajudar a interagir de maneira ideal com o DOM. </p><br><p>  At√© a vers√£o 16, o React tinha uma falha fatal.  Era 10 vezes mais lento que o <code>bem-xjst</code> no servidor.  N√£o pod√≠amos pagar esse desperd√≠cio.  O tempo de resposta para o Yandex √© uma das principais m√©tricas.  Imagine que, ao solicitar uma receita de vinho quente, voc√™ ter√° uma resposta 10 vezes mais lenta que o normal.  Voc√™ n√£o ficar√° satisfeito com as desculpas, mesmo que saiba algo sobre desenvolvimento web.  O que podemos dizer sobre a explica√ß√£o, como "mas tornou-se mais conveniente para os desenvolvedores se comunicarem com o DOM".  Adicione aqui a rela√ß√£o entre o pre√ßo da implementa√ß√£o e o lucro - e voc√™ mesmo tomar√° a √∫nica decis√£o certa. </p><br><p>  Felizmente para a tristeza, os desenvolvedores s√£o pessoas estranhas.  Se algo n√£o der certo, esse n√£o √© um motivo para largar tudo ... </p><br><h2 id="shivorot-navyvorot">  De cabe√ßa para baixo </h2><br><p>  Est√°vamos confiantes de que poder√≠amos derrotar a lentid√£o do React.  J√° temos um mecanismo de modelo r√°pido.  Tudo que voc√™ precisa √© gerar HTML no servidor usando o <code>bem-xjst</code> e, no cliente, "for√ßar" o React a aceitar esta marca√ß√£o como sua.  A id√©ia era t√£o simples que nada indicava um fracasso. </p><br><p>  Nas vers√µes at√© 15, inclusive, o React validou a validade da marca√ß√£o usando uma soma de hash - um algoritmo que transforma qualquer otimiza√ß√£o em uma ab√≥bora.  Para convencer o React da validade da marca√ß√£o, foi necess√°rio definir um ID para cada n√≥ e calcular a soma de hash de todos os n√≥s.  Tamb√©m significava suportar um conjunto duplo de modelos: reagir para o cliente e <code>bem-xjst</code> para o servidor.  Testes simples de velocidade com instala√ß√£o de identifica√ß√£o deixaram claro que n√£o havia sentido em continuar. </p><br><p>  O <code>bem-xjst</code> bem <code>bem-xjst</code> √© uma ferramenta muito subestimada.  Veja o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">relat√≥rio do principal mantenedor da Glory Oliyanchuk</a> e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">veja por</a> si mesmo.  <code>bem-xjst</code> √© baseado em uma arquitetura que permite usar uma sintaxe de modelo para diferentes transforma√ß√µes da √°rvore de origem.  Muito parecido com React, n√£o √©?  Hoje, esse recurso permite que ferramentas como o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><code>react-sketchapp</code></a> . </p><br><p>  Fora da caixa <code>bem-xjst</code> cont√©m dois tipos de convers√µes: em HTML e em JSON.  Qualquer desenvolvedor suficientemente diligente pode escrever seu pr√≥prio mecanismo para transformar modelos em qualquer coisa.  <code>bem-xjst</code> transformar uma √°rvore de dados em uma sequ√™ncia de chamadas para <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">fun√ß√µes HyperScript</a> .  O que significava total compatibilidade com o React e outras implementa√ß√µes do algoritmo Virtual DOM, por exemplo, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Preact</a> . </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/yPV6pcMdezM" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><p>  <em>Uma introdu√ß√£o detalhada √† gera√ß√£o de chamadas de fun√ß√£o HyperScript</em> </p><br><p>  Como os modelos React exigem a coexist√™ncia de layout e l√≥gica de neg√≥cios, tivemos que trazer a l√≥gica do <code>i-bem.js</code> para nossos modelos, que n√£o foram projetados para isso.  Para eles, isso n√£o era natural.  Eles estavam indo de maneira diferente.  A prop√≥sito! </p><br><p>  Abaixo est√° um exemplo das profundidades de colar diferentes mundos em um tempo de execu√ß√£o. </p><br><pre> <code class="javascript hljs">block(<span class="hljs-string"><span class="hljs-string">'select'</span></span>).elem(<span class="hljs-string"><span class="hljs-string">'menu'</span></span>)( def()(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> React = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'react'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> Menu = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'../components/menu/menu'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> MenuItem = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'../components/menu-item/menu-item'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> _select = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.ctx._select; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> selectComponent = _select._select; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> React.createElement.apply(React, [ Menu, { <span class="hljs-attr"><span class="hljs-attr">mix</span></span>: { <span class="hljs-attr"><span class="hljs-attr">block</span></span> : <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.block, <span class="hljs-attr"><span class="hljs-attr">elem</span></span> : <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.elem }, <span class="hljs-attr"><span class="hljs-attr">ref</span></span>: <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">menu</span></span></span><span class="hljs-function"> =&gt;</span></span> selectComponent._menu = menu, <span class="hljs-attr"><span class="hljs-attr">size</span></span>: _select.mods.size, <span class="hljs-attr"><span class="hljs-attr">disabled</span></span>: _select.mods.disabled, <span class="hljs-attr"><span class="hljs-attr">mode</span></span>: _select.mods.mode, <span class="hljs-attr"><span class="hljs-attr">content</span></span>: _select.options, <span class="hljs-attr"><span class="hljs-attr">checkedItems</span></span>: _select.bindings.checkedItems, <span class="hljs-attr"><span class="hljs-attr">style</span></span>: _select.bindings.popupMenuWidth, <span class="hljs-attr"><span class="hljs-attr">onKeyDown</span></span>: _select.bindings.onKeyDown, <span class="hljs-attr"><span class="hljs-attr">theme</span></span>: _select.mods.theme, }].concat(_select.options.map(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">option</span></span></span><span class="hljs-function"> =&gt;</span></span> React.createElement( MenuItem, { <span class="hljs-attr"><span class="hljs-attr">onClick</span></span>: _select.bindings.onOptionCheck, <span class="hljs-attr"><span class="hljs-attr">theme</span></span>: _select.mods.theme, <span class="hljs-attr"><span class="hljs-attr">val</span></span>: option.value, }, option.content) )) ); }) );</code> </pre> <br><p>  Claro, tivemos nossa pr√≥pria assembl√©ia.  Como voc√™ sabe, a opera√ß√£o mais r√°pida √© a concatena√ß√£o de cadeias.  O mecanismo <code>bem-xjst</code> foi constru√≠do sobre ele, a montagem sobre ele.  Arquivos de blocos, elementos e modificadores est√£o em pastas, e a montagem apenas teve que colar os arquivos na seq√º√™ncia correta.  Com essa abordagem, voc√™ pode colar JS, CSS e modelos em paralelo, bem como as pr√≥prias entidades.  Ou seja, se voc√™ possui quatro componentes em um projeto, quatro n√∫cleos no laptop e a montagem de uma tecnologia de componente leva um segundo, a cria√ß√£o do projeto leva dois segundos.  Aqui deve ficar mais claro como conseguimos inserir apenas o c√≥digo necess√°rio no navegador. </p><br><p>  Tudo isso para n√≥s fez a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">ENB</a> .  Recebemos a √°rvore final para padroniza√ß√£o apenas em tempo de execu√ß√£o e, como a depend√™ncia entre os componentes precisava surgir um pouco antes para coletar pacotes, essa fun√ß√£o foi assumida pela pouco conhecida tecnologia <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><code>deps.js</code></a>  Ele permitiu criar um gr√°fico de depend√™ncia entre os componentes, ap√≥s o qual o coletor poderia colar o c√≥digo na sequ√™ncia desejada, ignorando o gr√°fico. </p><br><p>  A vers√£o 16 do React parou de funcionar nessa dire√ß√£o.A velocidade de execu√ß√£o dos modelos no servidor foi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">igual</a> .  Nas instala√ß√µes de produ√ß√£o, a diferen√ßa se tornou impercept√≠vel. </p><br><p>  N√≥: <strong>v8.4.0</strong> <br>  Crian√ßas: <strong>5K</strong> </p><br><table><thead><tr><th>  renderizador </th><th>  tempo m√©dio </th><th>  ops / s </th></tr></thead><tbody><tr><td>  <strong>pr√©-</strong> execu√ß√£o v8.2.6 </td><td>  66.235ms </td><td>  15 </td></tr><tr><td>  <strong>bem-xjst</strong> v8.8.4 </td><td>  71.326ms </td><td>  14 </td></tr><tr><td>  react v16.1.0 </td><td>  73.966ms </td><td>  14 </td></tr></tbody></table><br><p>  Usando os links abaixo, voc√™ pode restaurar o hist√≥rico da abordagem: </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">https://ru.bem.info/forum/961/</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">https://github.com/awinogradov/react-bl</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">https://github.com/awinogradov/xjst-ddsl</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">https://github.com/awinogradov/ddsl-react</a> </li></ul><br><p>  J√° tentamos mais alguma coisa? </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">https://github.com/veged/bem-components-react</a> - a primeira abordagem para implementar a metodologia no React; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">https://github.com/Yeti-or/bem-hazard</a> - uma abordagem semelhante com base no mecanismo de modelo BH.  Com BH, a prop√≥sito, voc√™ pode brincar on-line; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">https://github.com/dfilatov/bem-react</a> - criando componentes atrav√©s do BEMJSON; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">https://github.com/rebem</a> - utilit√°rios BEM no mundo React. </li></ul><br><p><img src="https://habrastorage.org/webt/uv/si/wt/uvsiwtsrexhffeuznrqhpxvtjva.png"></p><br><h2 id="motivaciya">  Motiva√ß√£o </h2><br><p>  No meio da hist√≥ria, ser√° √∫til falar sobre o que nos motivou.  Valeu a pena fazer isso no come√ßo, mas - quem se lembra do velho, daquele olho de presente.  Por que precisamos de tudo isso?  O que o BEM pode trazer que o React n√£o pode fazer?  Perguntas que quase todo mundo faz. </p><br><h3 id="dekompoziciya">  Decomposi√ß√£o </h3><br><p>  A funcionalidade dos componentes se torna mais complicada de ano para ano, e o n√∫mero de varia√ß√µes aumenta.  Isso √© expresso pelas constru√ß√µes <code>if</code> ou <code>switch</code> , como resultado, a base de c√≥digo aumenta inevitavelmente, como resultado - o peso do componente e do projeto usando esse componente aumenta.  A parte principal da l√≥gica do componente React est√° contida no m√©todo <code>render()</code> .  Para alterar a funcionalidade de um componente, √© necess√°rio reescrever a maior parte do m√©todo, o que inevitavelmente leva a um aumento exponencial no n√∫mero de componentes altamente especializados. </p><br><p>  Todo mundo conhece as <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">bibliotecas</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">material-ui</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">fabric-ui</a> e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">react-bootstrap</a> .  Em geral, todas as <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">bibliotecas conhecidas</a> com componentes t√™m a mesma desvantagem.  Imagine que voc√™ tem v√°rios projetos e todos usam a mesma biblioteca.  Voc√™ usa os mesmos componentes, mas em varia√ß√µes diferentes: aqui existem sele√ß√µes com caixas de sele√ß√£o, n√£o existem, existem bot√µes azuis com um √≠cone, existem bot√µes vermelhos sem.  O peso de CSS e JS que a biblioteca traz para voc√™ ser√° o mesmo em todos os projetos.  Mas porque?  Varia√ß√µes de componentes s√£o incorporadas no pr√≥prio componente e v√™m com ele, se voc√™ deseja ou n√£o.  Para n√≥s, isso √© inaceit√°vel. </p><br><p>  O Yandex tamb√©m possui sua pr√≥pria biblioteca com componentes - Lego.  √â aplicado em ~ 200 servi√ßos.  Queremos que o uso do Lego na Pesquisa custe o mesmo para o Yandex.Health?  Voc√™ sabe a resposta. </p><br><h3 id="krossplatformennaya-razrabotka">  Desenvolvimento multiplataforma </h3><br><p>  Para oferecer suporte a v√°rias plataformas, na maioria das vezes, eles criam uma vers√£o separada para cada plataforma ou uma adapt√°vel. </p><br><p>  O desenvolvimento de vers√µes individuais requer recursos adicionais: quanto mais plataformas, mais esfor√ßo.  Manter o estado s√≠ncrono das propriedades do produto em diferentes vers√µes causar√° novas dificuldades. </p><br><p>  O desenvolvimento de uma vers√£o adapt√°vel complica o c√≥digo, aumenta o peso, reduz a velocidade do produto com a diferen√ßa adequada entre as plataformas. </p><br><p>  Queremos que nossos pais / amigos / colegas / filhos usem vers√µes para computador no celular com menor velocidade da Internet e menor produtividade?  Voc√™ sabe a resposta. </p><br><h3 id="eksperimenty">  Os experimentos </h3><br><p>  Se voc√™ estiver desenvolvendo projetos para um grande p√∫blico, precisar√° ter certeza de todas as altera√ß√µes.  Os experimentos A / B s√£o uma maneira de ganhar essa confian√ßa. </p><br><p>  Maneiras de organizar o c√≥digo para experimentos: </p><br><ul><li>  bifurca√ß√£o do projeto e cria√ß√£o de inst√¢ncias de servi√ßo na produ√ß√£o; </li><li>  condi√ß√µes pontuais dentro da base de c√≥digo. </li></ul><br><p>  Se o projeto tiver muitas experi√™ncias longas, a ramifica√ß√£o da base de c√≥digo causar√° custos significativos.  √â necess√°rio manter cada filial atualizada com o experimento: erros de porta corrigidos e funcionalidade do produto.  A ramifica√ß√£o da base de c√≥digo complica experimentos cruzados v√°rias vezes. </p><br><p>  As condi√ß√µes pontuais funcionam com mais flexibilidade, mas complicam a base de c√≥digo: as condi√ß√µes do experimento podem afetar diferentes partes do projeto.  Um grande n√∫mero de condi√ß√µes prejudica o desempenho aumentando a quantidade de c√≥digo para o navegador.  √â necess√°rio remover as condi√ß√µes, tornar o c√≥digo b√°sico ou excluir completamente o experimento com falha. </p><br><p>  Na Pesquisa ~ 100 experi√™ncias on-line em v√°rias combina√ß√µes para diferentes p√∫blicos.  Voc√™ poderia ver por si mesmo.  Lembre-se, talvez voc√™ tenha notado a funcionalidade e, uma semana depois, ela desapareceu magicamente.  Queremos testar as teorias de produtos ao custo de manter centenas de ramifica√ß√µes da base de c√≥digo ativa de 500.000 linhas, que s√£o alteradas por ~ 60 desenvolvedores diariamente?  Voc√™ sabe a resposta. </p><br><h3 id="globalnye-izmeneniya">  Mudan√ßa global </h3><br><p>  Por exemplo, voc√™ pode criar um componente <code>CustomButton</code> herdado de <code>Button</code> de uma biblioteca.  Mas o <code>CustomButton</code> herdado n√£o se aplicar√° a todos os componentes da biblioteca que cont√©m <code>Button</code> .  Uma biblioteca pode ter um componente de <code>Search</code> criado a partir de <code>Input</code> e <code>Button</code> .  Nesse caso, o <code>CustomButton</code> herdado n√£o aparece dentro do componente <code>Search</code> .  Queremos contornar manualmente toda a base de c√≥digos em que o <code>Button</code> usado? </p><br><p><img src="https://habrastorage.org/webt/po/7j/fg/po7jfgnxrawurvtkoi-3ch2wneu.jpeg"></p><br><h2 id="dolgaya-doroga-v-kompoziciyu">  Longo caminho para a composi√ß√£o </h2><br><p>  Decidimos mudar a estrat√©gia.  Na abordagem anterior, eles tomaram a tecnologia Yandex como base e tentaram fazer com que o React funcionasse com base nisso.  Novas t√°ticas sugeriam o contr√°rio.  Foi assim que surgiu o projeto <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">bem-react-core</a> . </p><br><blockquote>  Pare com isso!  Por que reagir? </blockquote><p>  Vimos nela a oportunidade de nos livrarmos da renderiza√ß√£o inicial expl√≠cita em HTML e do suporte manual do estado do componente JS posteriormente no tempo de execu√ß√£o - na verdade, tornou-se poss√≠vel mesclar modelos BEMHMTL e componentes JS em uma √∫nica tecnologia. </p><br><h3 id="v100httpsgithubcombembem-reacttreev100">  <a href="">v1.0.0</a> </h3><br><p>  Inicialmente, planejamos transferir todas as melhores pr√°ticas e propriedades <code>bem-xjst</code> para a biblioteca no topo do React.  A primeira coisa que chama sua aten√ß√£o √© a assinatura ou, se preferir, a sintaxe para descrever os componentes. </p><br><p>  <em>O que voc√™ fez, existe o JSX!</em> </p><br><p>  A primeira vers√£o foi constru√≠da com base na <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">heran√ßa</a> - uma biblioteca que ajuda a implementar classes e heran√ßa.  Como alguns de voc√™s lembram, naquela √©poca, prot√≥tipos de prot√≥tipo em JavaScript n√£o tinham classes, n√£o havia <code>super</code> .  Em geral, eles ainda est√£o ausentes, mais precisamente, essas n√£o s√£o as classes que primeiro v√™m √† mente.  <code>inherit</code> fez tudo o que as classes no padr√£o ES2015 podem fazer agora e o que √© considerado magia negra: heran√ßa m√∫ltipla e fus√£o de prot√≥tipos em vez de reconstruir a cadeia, o que afeta positivamente o desempenho.  Voc√™ n√£o se enganar√° se acha que parece fazer sentido como <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">herda no Node.js</a> , mas eles funcionam de maneira diferente. </p><br><p>  Abaixo est√° um exemplo da sintaxe dos modelos <code>bem-react-core@v1.0.0</code> . </p><br><p>  <strong>App-Header.js</strong> </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { decl } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'bem-react-core'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> decl({ <span class="hljs-attr"><span class="hljs-attr">block</span></span>: <span class="hljs-string"><span class="hljs-string">'App'</span></span>, <span class="hljs-attr"><span class="hljs-attr">elem</span></span>: <span class="hljs-string"><span class="hljs-string">'Header'</span></span>, <span class="hljs-attr"><span class="hljs-attr">attrs</span></span>: { <span class="hljs-attr"><span class="hljs-attr">role</span></span>: <span class="hljs-string"><span class="hljs-string">'heading'</span></span> }, content() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">' '</span></span>; } });</code> </pre> <br><p>  <strong>App-Header@desktop.js</strong> </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { decl } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'bem-react-core'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> decl({ <span class="hljs-attr"><span class="hljs-attr">block</span></span>: <span class="hljs-string"><span class="hljs-string">'App'</span></span>, <span class="hljs-attr"><span class="hljs-attr">elem</span></span>: <span class="hljs-string"><span class="hljs-string">'Header'</span></span>, <span class="hljs-attr"><span class="hljs-attr">tag</span></span>: <span class="hljs-string"><span class="hljs-string">'h1'</span></span>, attrs() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { ...this.__base(...arguments), <span class="hljs-string"><span class="hljs-string">'aria-level'</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span> }, }, content() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">` </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${</span></span><span class="hljs-keyword"><span class="hljs-string"><span class="hljs-subst"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-string"><span class="hljs-subst">.__base(...</span></span><span class="hljs-built_in"><span class="hljs-string"><span class="hljs-subst"><span class="hljs-built_in">arguments</span></span></span></span><span class="hljs-string"><span class="hljs-subst">)}</span></span></span><span class="hljs-string">     h1`</span></span>; } });</code> </pre> <br><p>  <strong>App-Header@touch.js</strong> </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { decl } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'bem-react-core'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> decl({ <span class="hljs-attr"><span class="hljs-attr">block</span></span>: <span class="hljs-string"><span class="hljs-string">'App'</span></span>, <span class="hljs-attr"><span class="hljs-attr">elem</span></span>: <span class="hljs-string"><span class="hljs-string">'Header'</span></span>, <span class="hljs-attr"><span class="hljs-attr">tag</span></span>: <span class="hljs-string"><span class="hljs-string">'h2'</span></span>, content() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">` </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${</span></span><span class="hljs-keyword"><span class="hljs-string"><span class="hljs-subst"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-string"><span class="hljs-subst">.__base(...</span></span><span class="hljs-built_in"><span class="hljs-string"><span class="hljs-subst"><span class="hljs-built_in">arguments</span></span></span></span><span class="hljs-string"><span class="hljs-subst">)}</span></span></span><span class="hljs-string">  `</span></span>; } });</code> </pre> <br><p>  <strong>index.js</strong> </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ReactDomServer <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-dom/server'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> AppHeader <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'b:App e:Header'</span></span>; ReactDomServer.renderToStaticMarkup(<span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">AppHeader</span></span></span></span><span class="xml"><span class="hljs-tag"> /&gt;</span></span></span><span class="xml">);</span></span></code> </pre> <br><p>  <strong>output@desktop.html</strong> </p><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"App-Header"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">role</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"heading"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">aria-level</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag">&gt;</span></span>A       h1<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h2</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  <strong>output@touch.html</strong> </p><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h2</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"App-Header"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">role</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"heading"</span></span></span><span class="hljs-tag">&gt;</span></span>   <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h2</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  <em>Os modelos de dispositivo para componentes mais complexos podem ser encontrados <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> .</em> </p><br><p>  Como uma classe √© um objeto e o trabalho com objetos em JavaScript √© mais conveniente, a sintaxe √© apropriada.  A <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">sintaxe</a> posteriormente <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">migrou</a> para sua mente <code>bem-xjst</code> . </p><br><p>  A biblioteca era um reposit√≥rio global de declara√ß√µes de objetos - os resultados da execu√ß√£o da fun√ß√£o <code>decl</code> , partes de entidades: um bloco, elemento ou modificador.  O BEM fornece um mecanismo de nomea√ß√£o exclusivo e, portanto, √© adequado para criar chaves em um cofre.  O componente React resultante foi colado no local de uso.  O truque √© que <code>decl</code> funcionou ao importar o m√≥dulo.  Isso tornou poss√≠vel indicar quais partes do componente s√£o necess√°rias em cada local espec√≠fico, usando uma lista simples de importa√ß√µes.  Mas lembre-se: os componentes s√£o complexos, existem muitas partes, a lista de importa√ß√µes √© longa, os desenvolvedores s√£o pregui√ßosos. </p><br><h4 id="magiya-importov">  Import Magic </h4><br><p>  Como voc√™ pode ver, nos exemplos de c√≥digo, existem linhas <code>import AppHeader from 'b:App e:Header'</code> . </p><br><p>  <em>Voc√™ quebrou o padr√£o!</em>  <em>√â imposs√≠vel!</em>  <em>Simplesmente n√£o vai funcionar!</em> </p><br><p>  Em primeiro lugar, o padr√£o de importa√ß√£o n√£o opera com os termos do esp√≠rito "deve haver um caminho para um m√≥dulo real na linha de importa√ß√£o".  Em segundo lugar, √© o a√ß√∫car sint√°tico que foi convertido usando Babel.  Terceiro, constru√ß√µes de pontua√ß√£o de <code>import txt from 'raw-loader!./file.txt';</code> estranhas para o webpack <code>import txt from 'raw-loader!./file.txt';</code>  por algum motivo eles n√£o incomodaram ningu√©m. <br>  Portanto, nosso bloco √© apresentado em duas plataformas: <code>desktop</code> , <code>touch</code> . </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Hello <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'b:Hello'</span></span>; <span class="hljs-comment"><span class="hljs-comment">//     : var Hello = [ require('path/to/desktop/Hello/Hello.js'), require('path/to/touch/Hello/Hello.js') ][0].applyDecls();</span></span></code> </pre> <br><p>          <code>Hello</code> ,     <code>applyDecls</code> ,          <code>inherit</code>   ,       React-. </p><br><p>   Babel,   ,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="> </a> .    webpack,       , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="> </a> . </p><br><p>  ,   : </p><br><ul><li> ,   ,         ; </li><li>     ; </li><li>  React-    . </li></ul><br><p>    : </p><br><ul><li>   TypeScript/Flow; </li><li>    React- ; </li><li> -         ; </li><li>      . </li></ul><br><h3 id="v200httpsgithubcombembem-reacttreev200"> <a href="">v2.0.0</a> </h3><br><p>     <code>bem-react-core@v1.0.0</code>  ,       . </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { Elem } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'bem-react-core'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { Button } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../Button'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AppHeader</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Elem</span></span></span><span class="hljs-class"> </span></span>{ block = <span class="hljs-string"><span class="hljs-string">'App'</span></span>; elem = <span class="hljs-string"><span class="hljs-string">'Header'</span></span>; tag() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">'h2'</span></span>; } content() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ( <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Button</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Button</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> ); } }</code> </pre> <br><p>     ,     .    ,   ,      TypeScript/Flow.   ,     <code>inherit</code>  ¬´¬ª ,     ,            . </p><br><p>   : <br> ‚Äî         webpack    Babel; <br> ‚Äî      ; <br> ‚Äî       ,    . </p><br><p>        <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">HOC</a> ,             . </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> React <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> ReactDOM <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-dom'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { Block, Elem, withMods } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'bem-react-core'</span></span>; interface IButtonProps { <span class="hljs-attr"><span class="hljs-attr">children</span></span>: string; } interface IModsProps extends IButtonProps { <span class="hljs-attr"><span class="hljs-attr">type</span></span>: <span class="hljs-string"><span class="hljs-string">'link'</span></span> | <span class="hljs-string"><span class="hljs-string">'button'</span></span>; } <span class="hljs-comment"><span class="hljs-comment">//   Text class Text extends Elem { block = 'Button'; elem = 'Text'; tag() { return 'span'; } } //   Button class Button&lt;T extends IModsProps&gt; extends Block&lt;T&gt; { block = 'Button'; tag() { return 'button'; } mods() { return { type: this.props.type }; } content() { return ( &lt;Text&gt;{this.props.children}&lt;/Text&gt; ); } } //    Button,    type   link class ButtonLink extends Button&lt;IModsProps&gt; { static mod = ({ type }: any) =&gt; type === 'link'; tag() { return 'a'; } mods() { return { type: this.props.type }; } attrs() { return { href: 'www.yandex.ru' }; } } //   Button  ButtonLink const ButtonView = withMods(Button, ButtonLink); ReactDOM.render( &lt;React.Fragment&gt; &lt;ButtonView type='button'&gt;Click me&lt;/ButtonView&gt; &lt;ButtonView type='link'&gt;Click me&lt;/ButtonView&gt; &lt;/React.Fragment&gt;, document.getElementById('root') );</span></span></code> </pre> <br><p>              ,     . </p><br><p> <code>withMods</code>       ,   (),      .   ,     , withMods        ,      .      .       , ,     ,   ( )   .               .       ,   ,    ‚Äî    ,    . </p><br><p> ,   : </p><br><ul><li>    . ,        .   ,    TS.        ,      .    ES5 TS   super   ,         . , TS     ,    . </li><li>    . TS  ES6  Babel  ES5.      ,    npm-    .  ,          Babel. </li></ul><br><p>  : </p><br><ul><li>       ,   . ,     . :    DOM-.     HOC,      .   withMods       . </li><li>   (, , )       .             <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">SFC</a> . </li><li>  CSS-.  CSS-   JS-     .      ,   ,          . </li></ul><br><p>      v2. </p><br><h2 id="manifest">  </h2><br><p> ,    .   .  ,    ,      1  2.      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="> </a> . </p><br><p>   ‚Äî    .   CSS-     HOC,        ‚Äî  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">dependency injection</a> . </p><br><p>       React: </p><br><ul><li>   CSS-. </li><li>     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="> </a> (, ); </li></ul><br><p>         .         .        <code>React.ComponentType</code>     -.         HOC     compose    . </p><br><p>             . </p><br><p>        dependency injection,     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><code>React.ContextAPI</code></a>    .             ,        ,        .        ,      .   DI ‚Äî  HOC,     .         .     ,  ,         . </p><br><p> ,    ,         .   ,      ,    4 ,    <code>1.5Kb</code> . </p><br><p>     .  Obrigado a quem leu at√© o fim.     ,     React  . . </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt438598/">https://habr.com/ru/post/pt438598/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt438588/index.html">Widget googleTranslate personalizado para o site</a></li>
<li><a href="../pt438590/index.html">Thunder in Paradise ou Por que voc√™ n√£o deve usar o FlylinkDC ++</a></li>
<li><a href="../pt438592/index.html">O que procurar ao escolher um leitor - estamos falando sobre o fator de forma e a exibi√ß√£o</a></li>
<li><a href="../pt438594/index.html">Local de trabalho e 4k a 60Hz</a></li>
<li><a href="../pt438596/index.html">Salvando dados do usu√°rio ap√≥s o recarregamento da p√°gina</a></li>
<li><a href="../pt438600/index.html">SciPy, entrada e sa√≠da em MATLAB</a></li>
<li><a href="../pt438602/index.html">Desmontamos o protocolo de mensagens de pager POCSAG, parte 1</a></li>
<li><a href="../pt438604/index.html">Bitrix em um monte de Nginx + PHP-FPM, configurando o CNC, bem como um cache composto com feedback atrav√©s do nginx. Configura√ß√£o modificada</a></li>
<li><a href="../pt438606/index.html">Degrada√ß√£o graciosa. Relat√≥rio Yandex.Taxi</a></li>
<li><a href="../pt438610/index.html">Templates Figma responsivos: Criando um componente de design flex√≠vel para navega√ß√£o m√≥vel iOS</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>