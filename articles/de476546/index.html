<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🐸 👨🏻‍💻 🚁 Cloud WebRTC Streaming bei DigitalOcean ❣️ 🧜🏿 🙇🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Das berühmte Cloud-Hosting-Unternehmen DigitalOcean hat kürzlich einen eigenen Store mit vorgefertigten Images erworben, über den Sie schnell jeden An...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Cloud WebRTC Streaming bei DigitalOcean</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/flashphoner/blog/476546/"><p><img src="https://habrastorage.org/webt/qu/k2/rk/quk2rkqml_odwigj2khcbkjsgaa.png"></p><br><p>  Das berühmte Cloud-Hosting-Unternehmen DigitalOcean hat kürzlich einen eigenen Store mit vorgefertigten Images erworben, über den Sie schnell jeden Anwendungsserver bereitstellen können.  Genau wie AWS nur für diejenigen, die bereits die Dienste dieses Anbieters nutzen.  Lassen Sie uns sehen, wie Sie mit einem DO-Konto einen einfachen Server für 10 USD pro Monat für das Streaming von WebRTC auf der Basis von Flashphoner WebCallServer bereitstellen und wie ein solcher Server nützlich sein kann. </p><a name="habracut"></a><br><h2 id="razvertyvanie">  Bereitstellung </h2><br><p>  Wir geben das Konto auf DO ein, folgen dem Link zum <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Flashphoner WebCallServer-</a> Image und klicken auf die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Schaltfläche</a> "Flashphoner Web Call Server-Droplet erstellen" </p><br><p><img src="https://habrastorage.org/webt/3l/_f/35/3l_f35kar7y9bm3thyu1hvynmbk.png"></p><br><p>  Wir wählen die Merkmale des Nordens und den Tarifplan.  Standardmäßig bietet DO etwas aus dem mittleren Segment an, aber wir sind an den minimalen Kosten interessiert </p><br><p><img src="https://habrastorage.org/webt/er/y4/ck/ery4ckt3mvppfgrv10ui5a9st9u.png"></p><br><p>  Wählen Sie die Region aus, in der sich das Rechenzentrum befindet, z. B. Frankfurt </p><br><p><img src="https://habrastorage.org/webt/dt/sw/3g/dtsw3gy3cy76buk6p2dgtikr_oc.png"></p><br><p>  Wählen Sie eine Authentifizierungsmethode aus, z. B. ein Einmalkennwort </p><br><p><img src="https://habrastorage.org/webt/jm/vn/5g/jmvn5g5yy6m702li7ovvxluzu8a.png"></p><br><p>  Wir geben die Anzahl der Server an (soweit wir an einem Server interessiert sind) und geben unserem Server einen Namen.  Dieser Name wird einschließlich in / etc / hostname geschrieben </p><br><br><p>  Klicken Sie auf "Droplet erstellen" </p><br><p><img src="https://habrastorage.org/webt/fm/q1/ql/fmq1qlgnbpz5bq7r8ncqiyr40sw.png"></p><br><p>  Nach der Erstellung wird der Server automatisch gestartet.  Sie können eine Verbindung über SSH herstellen und das Kennwort ändern, wenn als Authentifizierungsmethode ein Einmalkennwort ausgewählt wurde.  In der Konsole wird eine kurze Beschreibung des Flashphoner WebCallServers mit Dokumentationslinks angezeigt </p><br><p><img src="https://habrastorage.org/webt/rm/h2/xc/rmh2xcmpcjs5tvut5aybhumulgi.png"></p><br><h2 id="eto-test-menya-vidno">  "Dies ist ein Test. Kann ich dich sehen?" </h2><br><p>  Der Flashphoner WebCallServer startet vollständig betriebsbereit, eine 30-Tage-Testlizenz wird automatisch aktiviert.  Um alle Grundfunktionen eines Webinterfaces zu testen, beschränken wir uns darauf, die Veröffentlichung und Wiedergabe des WebRTC-Streams zu überprüfen. </p><br><p> Öffnen Sie die Browserseite <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https: // droplet_ip: 8444 / admin /</a> .  Standardmäßig wird ein selbstsigniertes Zertifikat mit dem Server geliefert, sodass Sie die Sicherheitsausnahme bestätigen müssen.  In Zukunft können Sie die Zertifikate durch Ihre eigenen ersetzen.  Benutzername und Passwort eingeben (Standard <em>Demo</em> ) </p><br><p><img src="https://habrastorage.org/webt/-a/xu/qw/-axuqw0izvkcml9ycx4qev8dbam.png"></p><br><p>  Wählen Sie das Two-Way-Streaming-Beispiel in der Seitenleiste aus, klicken Sie auf die Schaltfläche "Verbinden" und dann auf "Veröffentlichen".  Um den Stream abzuspielen, klicken Sie auf "Abspielen". </p><br><p><img src="https://habrastorage.org/webt/gg/uu/vg/gguuvghawemad1ch60ka4voke0a.png"></p><br><h2 id="za-prigorshnyu-dollarov">  Für eine Handvoll Dollar </h2><br><p>  Was kann ein Server für 10 US-Dollar pro Monat als Hardwareplattform für WebRTC-Streaming?  Mal sehen, was der DigitalOcean-Prozessor uns bietet </p><br><pre><code class="bash hljs">lscpu</code> </pre> <br><p><img src="https://habrastorage.org/webt/gz/my/dw/gzmydw2rmby7xbf_jfefcegdj14.png"></p><br><p>  und aus dem Gedächtnis </p><br><pre> <code class="bash hljs">free -h</code> </pre> <br><p><img src="https://habrastorage.org/webt/0f/m8/fl/0fm8fllsykumuxadaai1zqlf-lk.png"></p><br><p>  Beim Überprüfen des Servers mit Auslastungstests stellen wir fest, dass der Server möglicherweise nicht so klein ist. </p><br><p>  Beispielsweise veröffentlichen wir eine Stream-Instanz und sehen, wie viele Abonnenten diesen Stream gleichzeitig verlieren können, wobei sie nicht mehr als 90% des Prozessors belegen: </p><br><div class="scrollable-table"><table><thead><tr><th>  Erlaubnis </th><th>  Bitrate, Kbps </th><th>  Anzahl der Veröffentlichungen </th><th>  Anzahl der Abonnenten </th></tr></thead><tbody><tr><td>  360p </td><td>  1300 </td><td>  1 </td><td>  70 </td></tr><tr><td>  480p </td><td>  1800 </td><td>  1 </td><td>  70 </td></tr><tr><td>  720p </td><td>  3000 </td><td>  1 </td><td>  50 </td></tr></tbody></table></div><br><p>  Bei mehreren gleichzeitigen Veröffentlichungen bleibt die maximale Anzahl verarbeiteter Streams auf demselben Niveau: Wenn Sie 7 Streams veröffentlichen, können bis zu 10 Zuschauer jeden abonnieren. </p><br><p>  Angenommen, wir müssen den Stream auf dem Server umcodieren, um die Auflösung zu verringern oder die FPS auszurichten.  Überprüfen Sie in diesem Fall die maximale Anzahl der Veröffentlichungen: </p><br><div class="scrollable-table"><table><thead><tr><th>  Erlaubnis </th><th>  Bitrate, Kbps </th><th>  Anzahl der Threads </th></tr></thead><tbody><tr><td>  360p </td><td>  1300 </td><td>  5 </td></tr><tr><td>  480p </td><td>  1800 </td><td>  3 </td></tr><tr><td>  720p </td><td>  3000 </td><td>  2 </td></tr></tbody></table></div><br><p>  Ein kostenoptimierter Server mit Parametern wie 1 CPU-Kern, 2 GB RAM und 2 TB Datenverkehr pro Monat eignet sich daher nicht nur zum Testen von WebRTC-Streaming, sondern auch für den Einsatz in kleinen Projekten.  Zum Beispiel können Sie: </p><br><ul><li>  Verteilen Sie den Stream der IP-Kamera über WebRTC, um die einfachste Videoüberwachung für Unternehmen zu ermöglichen. </li><li>  Organisation eines Webinars für Mitarbeiter eines kleinen Unternehmens </li><li>  Erhöhen Sie Ihr Internetradio (Audiostream benötigt weniger CPU-Ressourcen) </li></ul><br><p>  Darüber hinaus kann dieser Server als Referenzplattform für Skalierungsberechnungen betrachtet werden, die wir weiterhin durchführen werden. </p><br><h2 id="ya-dostoyna-bolshego">  "Ich verdiene mehr!" </h2><br><p>  Die Regeln sind im Allgemeinen sehr einfach: Es gibt nicht viele Kerne, ebenso wie das Gedächtnis.  Abhängig von der geplanten Teilnehmerzahl lauten die Empfehlungen aus den von DO angebotenen Konfigurationssätzen wie folgt: </p><br><div class="scrollable-table"><table><thead><tr><th>  Anzahl der Abonnenten </th><th>  vCPUs </th><th>  RAM, GB </th><th>  Verkehr, TB </th><th>  Anwendungsbeispiel </th></tr></thead><tbody><tr><td>  bis zu 200 </td><td>  4 </td><td>  8 </td><td>  5 </td><td>  Videoüberwachungssystem </td></tr><tr><td>  bis zu 500 </td><td>  8 </td><td>  16 </td><td>  6 </td><td>  Webinare </td></tr><tr><td>  bis zu 1000 </td><td>  16 </td><td>  64 </td><td>  9 </td><td>  Video-Chat </td></tr><tr><td>  bis 2000 </td><td>  20 </td><td>  96 </td><td>  10 </td><td>  Streamen von HD-Videos </td></tr></tbody></table></div><br><p>  Wenn Sie weiter wachsen möchten, müssen Sie ein CDN mit einer Rate von 1 Edgeserver für 2000 Abonnenten bereitstellen.  Angenommen, wir müssen HD-Videos verteilen, die geplante Anzahl der Zuschauer beträgt 10.000. In diesem Fall benötigen Sie 2 Origin-Server zum Veröffentlichen und 5 Edge-Server zum Anzeigen. </p><br><p><img src="https://habrastorage.org/webt/d2/ky/xw/d2kyxwehzmckmsc09bltxy5epes.png"></p><br><p>  Einstellungsbeispiel: </p><br><ul><li>  Herkunft 1 </li></ul><br><pre> <code class="plaintext hljs">cdn_enabled=true cdn_ip=origin1.flashponer.com cdn_nodes_resolve_ip=false cdn_role=origin</code> </pre> <br><ul><li>  Herkunft 2 </li></ul><br><pre> <code class="plaintext hljs">cdn_enabled=true cdn_ip=origin2.flashponer.com cdn_point_of_entry=origin1.flashponer.com cdn_nodes_resolve_ip=false cdn_role=origin</code> </pre> <br><ul><li>  Edge 1 - Edge 5 (hier wird nur die Serveradresse im Parameter <code>cdn_ip</code> ) </li></ul><br><pre> <code class="plaintext hljs">cdn_enabled=true cdn_ip=edge1.flashphoner.com cdn_point_of_entry=origin1.flashponer.com cdn_nodes_resolve_ip=false cdn_role=edge</code> </pre> <br><p>  Ein CDN kann auch nützlich sein, wenn Abonnenten geografisch verteilt sind, z. B. wenn unsere potenziellen Zuschauer in Europa und Amerika leben. </p><br><p><img src="https://habrastorage.org/webt/gd/45/2b/gd452bd762x9ou7zie8svwpvi8c.png"></p><br><p>  Einstellungsbeispiel: </p><br><ul><li>  Herkunft EU </li></ul><br><pre> <code class="plaintext hljs">cdn_enabled=true cdn_ip=origin_eu.flashponer.com cdn_nodes_resolve_ip=false cdn_role=origin cdn_groups=EU</code> </pre> <br><ul><li>  Herkunft USA </li></ul><br><pre> <code class="plaintext hljs">cdn_enabled=true cdn_ip=origin_us.flashponer.com cdn_point_of_entry=origin_eu.flashponer.com cdn_nodes_resolve_ip=false cdn_role=origin cdn_groups=US</code> </pre> <br><ul><li>  Rand 1 EU </li></ul><br><pre> <code class="plaintext hljs">cdn_enabled=true cdn_ip=edge1_eu.flashphoner.com cdn_point_of_entry=origin_eu.flashponer.com cdn_nodes_resolve_ip=false cdn_role=edge cdn_groups=EU</code> </pre> <br><ul><li>  Edge 1 US </li></ul><br><pre> <code class="plaintext hljs">cdn_enabled=true cdn_ip=edge1_us.flashphoner.com cdn_point_of_entry=origin_eu.flashponer.com cdn_nodes_resolve_ip=false cdn_role=edge cdn_groups=US</code> </pre> <br><p>  Je mehr Zuschauer, desto größer die Auswahl an Wiedergabegeräten und Kanälen für diese Geräte.  Um die Qualität der Übertragung an verschiedene Geräte sicherzustellen, ist höchstwahrscheinlich eine Video-Transcodierung erforderlich, die speziellen CDN-Transcoder-Servern zugewiesen werden kann. </p><br><p><img src="https://habrastorage.org/webt/da/wi/n1/dawin1lf1bz_cqnovovjmcg5tms.png"></p><br><p>  Einstellungsbeispiel: </p><br><ul><li>  Herkunft </li></ul><br><pre> <code class="plaintext hljs">cdn_enabled=true cdn_ip=origin.flashponer.com cdn_nodes_resolve_ip=false cdn_role=origin cdn_groups=default</code> </pre> <br><ul><li>  Transcoder EU </li></ul><br><pre> <code class="plaintext hljs">cdn_enabled=true cdn_ip=transcoder_eu.flashponer.com cdn_point_of_entry=origin.flashponer.com cdn_nodes_resolve_ip=false cdn_role=transcoder cdn_groups=EU</code> </pre> <br><ul><li>  Rand 1 EU </li></ul><br><pre> <code class="plaintext hljs">cdn_enabled=true cdn_ip=edge1_eu.flashphoner.com cdn_point_of_entry=origin.flashponer.com cdn_nodes_resolve_ip=false cdn_role=edge cdn_groups=EU</code> </pre> <br><p>  Wie wir im Test herausgefunden haben, ist für die Transcodierung die Anzahl der Prozessorkerne wichtig.  Aus der CPU-optimierten Konfigurationslinie ist die teuerste 32-vCPU mit 64-Gbit-RAM am besten geeignet.  Gleichzeitig können in anderen Zeilen Konfigurationen mit einer großen Speicherkapazität in der Nähe der Anzahl der CPUs erheblich teurer sein.  Das Speichern von Transcodern funktioniert leider nicht: Da das Video Frame für Frame codiert wird, sollte genügend Speicher für alle Bilder und Prozessoren für die Verarbeitung aller Streams vorhanden sein. </p><br><p>  Bei der Bereitstellung eines CDN ist es hilfreich, mehrere Server mit derselben Konfiguration gleichzeitig zu erstellen.  Bei geografisch verteilten CDNs muss sich jedoch derselbe Edge- und Transcoder-Servertyp in verschiedenen Rechenzentren befinden. </p><br><h2 id="zaklyuchenie">  Fazit </h2><br><p>  Daher haben wir einen kleinen Server für das Streamen von WebRTC-Videos mit geringer Latenz auf DigitalOcean bereitgestellt und getestet. Wir haben sichergestellt, dass der Server in der Mindestkonfiguration nicht nur zum Testen, sondern auch für den Einsatz in kleinen Projekten geeignet ist. Wir haben Daten für die Skalierung in Abhängigkeit von der erwarteten Anzahl von Zuschauern erhalten. und ging auf das Thema der CDN-Bereitstellung ein, das an sich einen eigenen Artikel verdient.  Bleiben Sie bei uns, um fortzufahren ... </p><br><h2 id="ssylki">  Referenzen </h2><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Der Flashphoner WebCallServer auf dem DigitalOcean Marketplace</a> ist ein <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">vorgefertigtes</a> Web Call Server-Image auf DigitalOcean. </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">WebRTC-Streaming mit geringer Latenz CDN ist ein auf</a> Web Call Server basierendes Netzwerk für die Bereitstellung von Inhalten. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de476546/">https://habr.com/ru/post/de476546/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de476528/index.html">Software-Architekt Neuer Kurs von OTUS</a></li>
<li><a href="../de476532/index.html">Grundlegende UI / UX-Muster</a></li>
<li><a href="../de476534/index.html">Wie man ein effektives Management Accounting aufbaut und Superprofits erzielt</a></li>
<li><a href="../de476538/index.html">Verteilungsprotokolle für asymmetrische kryptografische Schlüssel: Denning - Sacco, DASS, Wu Lama</a></li>
<li><a href="../de476540/index.html">Smart Home - Sprachsteuerung in drei Schritten. Himbeere + HomeKit</a></li>
<li><a href="../de476548/index.html">Was haben Overclocking und Downsizing gemeinsam?</a></li>
<li><a href="../de476550/index.html">Slurm Basic in Moskau. Zweiter Tag Mizaru, Kikazaru, Iwazaru und der technische Support sind immer im Einsatz</a></li>
<li><a href="../de476554/index.html">Cloud-basiertes WebRTC-Streaming auf DigitalOcean</a></li>
<li><a href="../de476556/index.html">Erzählung und "Dungeons": Wie kann ein Game Designer Orte mit einer Handlung verknüpfen?</a></li>
<li><a href="../de476558/index.html">ONYX BOOX Max 3 Test: Maximaler Bildschirmleser</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>