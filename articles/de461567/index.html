<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🛀🏼 🗾 🕴🏻 SQL Unterhaltsame Rätsel 🏇🏻 🕟 🕴🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hallo Habr! 

 Seit über 3 Jahren unterrichte ich SQL in verschiedenen Schulungszentren. Eine meiner Beobachtungen ist, dass die Schüler SQL besser be...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>SQL Unterhaltsame Rätsel</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/461567/"> Hallo Habr! <br><br>  Seit über 3 Jahren unterrichte ich SQL in verschiedenen Schulungszentren. Eine meiner Beobachtungen ist, dass die Schüler SQL besser beherrschen und verstehen, wenn sie eine Aufgabe festlegen, und nicht nur über die Möglichkeiten und theoretischen Grundlagen sprechen. <br><br>  In diesem Artikel werde ich Ihnen meine Liste von Aufgaben mitteilen, die ich den Schülern als Hausaufgaben gebe und über die wir verschiedene Arten von Brainstorms durchführen, was zu einem tiefen und klaren Verständnis von SQL führt. <br><br><img src="https://habrastorage.org/webt/gr/ue/1m/grue1mys5l7b9rieubqlrxu5jfo.png"><br><br>  SQL (ˈɛsˈkjuˈɛl; englische strukturierte Abfragesprache) ist eine deklarative Programmiersprache, mit der Daten in einer relationalen Datenbank erstellt, geändert und verwaltet werden, die von einem geeigneten Datenbankverwaltungssystem verwaltet wird.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">Erfahren Sie mehr</a> <br><br>  Sie können SQL aus verschiedenen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">Quellen</a> lesen. <br>  Dieser Artikel soll Ihnen SQL nicht von Grund auf beibringen. <br><a name="habracut"></a><br>  Also lass uns gehen. <br><br>  Wir werden das bekannte <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">HR-Schema</a> in Oracle mit seinen Tabellen verwenden ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">mehr</a> ): <br><br><img src="https://habrastorage.org/webt/lw/4k/mm/lw4kmmf6abadgz5cdtaf2jsggyu.gif"><br>  Ich stelle fest, dass wir nur SELECT-Aufgaben berücksichtigen werden.  Es gibt keine Probleme mit DML und DDL. <br><br><h2>  Die Aufgaben </h2><br>  <b>Daten einschränken und sortieren</b> <br><br>  Mitarbeitertabelle.  Holen Sie sich eine Liste mit Informationen zu allen Mitarbeitern <br><div class="spoiler">  <b class="spoiler_title">Lösung</b> <div class="spoiler_text"><pre><code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees</code> </pre> <br></div></div><br>  Mitarbeitertabelle.  Holen Sie sich eine Liste aller Mitarbeiter mit dem Namen "David" <br><div class="spoiler">  <b class="spoiler_title">Lösung</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> first_name = <span class="hljs-string"><span class="hljs-string">'David'</span></span>;</code> </pre><br></div></div><br>  Mitarbeitertabelle.  Holen Sie sich eine Liste aller Mitarbeiter mit job_id gleich 'IT_PROG' <br><div class="spoiler">  <b class="spoiler_title">Lösung</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> job_id = <span class="hljs-string"><span class="hljs-string">'IT_PROG'</span></span></code> </pre><br></div></div><br>  Mitarbeitertabelle.  Holen Sie sich eine Liste aller Mitarbeiter aus der 50. Abteilung (department_id) mit einem Gehalt (Gehalt) von mehr als 4000 <br><div class="spoiler">  <b class="spoiler_title">Lösung</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> department_id = <span class="hljs-number"><span class="hljs-number">50</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> salary &gt; <span class="hljs-number"><span class="hljs-number">4000</span></span>;</code> </pre><br></div></div><br>  Mitarbeitertabelle.  Holen Sie sich eine Liste aller Mitarbeiter der 20. und 30. Abteilung (abteilungs_id) <br><div class="spoiler">  <b class="spoiler_title">Lösung</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> department_id = <span class="hljs-number"><span class="hljs-number">20</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OR</span></span> department_id = <span class="hljs-number"><span class="hljs-number">30</span></span>;</code> </pre><br></div></div><br>  Mitarbeitertabelle.  Holen Sie sich eine Liste aller Mitarbeiter, deren letzter Buchstabe im Namen "a" ist. <br><div class="spoiler">  <b class="spoiler_title">Lösung</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> first_name <span class="hljs-keyword"><span class="hljs-keyword">LIKE</span></span> <span class="hljs-string"><span class="hljs-string">'%a'</span></span>;</code> </pre><br></div></div><br>  Mitarbeitertabelle.  Holen Sie sich eine Liste aller Mitarbeiter der 50. und 80. Abteilung (department_id), die einen Bonus haben (der Wert in der Spalte Commission_Pct ist nicht leer). <br><div class="spoiler">  <b class="spoiler_title">Lösung</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> (department_id = <span class="hljs-number"><span class="hljs-number">50</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OR</span></span> department_id = <span class="hljs-number"><span class="hljs-number">80</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> commission_pct <span class="hljs-keyword"><span class="hljs-keyword">IS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>;</code> </pre><br></div></div><br>  Mitarbeitertabelle.  Holen Sie sich eine Liste aller Mitarbeiter, deren Name mindestens 2 Buchstaben 'n' enthält. <br><div class="spoiler">  <b class="spoiler_title">Lösung</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> first_name <span class="hljs-keyword"><span class="hljs-keyword">LIKE</span></span> <span class="hljs-string"><span class="hljs-string">'%n%n%'</span></span>;</code> </pre><br></div></div><br>  Mitarbeitertabelle.  Holen Sie sich eine Liste aller Mitarbeiter, deren Name länger als 4 Buchstaben ist <br><div class="spoiler">  <b class="spoiler_title">Lösung</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> first_name <span class="hljs-keyword"><span class="hljs-keyword">LIKE</span></span> <span class="hljs-string"><span class="hljs-string">'%_____%'</span></span>;</code> </pre><br></div></div><br>  Mitarbeitertabelle.  Erhalten Sie eine Liste aller Mitarbeiter, deren Gehalt im Bereich von 8000 bis 9000 (einschließlich) liegt. <br><div class="spoiler">  <b class="spoiler_title">Lösung</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> salary <span class="hljs-keyword"><span class="hljs-keyword">BETWEEN</span></span> <span class="hljs-number"><span class="hljs-number">8000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> <span class="hljs-number"><span class="hljs-number">9000</span></span>;</code> </pre><br></div></div><br>  Mitarbeitertabelle.  Rufen Sie eine Liste aller Mitarbeiter ab, deren Name das Zeichen '%' enthält. <br><div class="spoiler">  <b class="spoiler_title">Lösung</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> first_name <span class="hljs-keyword"><span class="hljs-keyword">LIKE</span></span> <span class="hljs-string"><span class="hljs-string">'%\%%'</span></span> ESCAPE <span class="hljs-string"><span class="hljs-string">'\';</span></span></code> </pre><br></div></div><br>  Mitarbeitertabelle.  Holen Sie sich eine Liste aller ID-Manager <br><div class="spoiler">  <b class="spoiler_title">Lösung</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DISTINCT</span></span> manager_id <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> manager_id <span class="hljs-keyword"><span class="hljs-keyword">IS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>;</code> </pre><br></div></div><br>  Mitarbeitertabelle.  Holen Sie sich eine Liste der Mitarbeiter mit ihren Positionen im Format: Donald (sh_clerk) <br><div class="spoiler">  <b class="spoiler_title">Lösung</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> first_name || <span class="hljs-string"><span class="hljs-string">'('</span></span> || <span class="hljs-keyword"><span class="hljs-keyword">LOWER</span></span> (job_id) || <span class="hljs-string"><span class="hljs-string">')'</span></span> employee <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees;</code> </pre><br></div></div><br><br>  <b>Verwenden einzeiliger Funktionen zum Anpassen der Ausgabe</b> <br><br>  Mitarbeitertabelle.  Holen Sie sich eine Liste aller Mitarbeiter, deren Name länger als 10 Buchstaben ist <br><div class="spoiler">  <b class="spoiler_title">Lösung</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">LENGTH</span></span> (first_name) &gt; <span class="hljs-number"><span class="hljs-number">10</span></span>;</code> </pre><br></div></div><br>  Mitarbeitertabelle.  Erhalten Sie eine Liste aller Mitarbeiter, deren Name den Buchstaben "b" enthält (Groß- und Kleinschreibung wird nicht berücksichtigt). <br><div class="spoiler">  <b class="spoiler_title">Lösung</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INSTR</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">LOWER</span></span> (first_name), <span class="hljs-string"><span class="hljs-string">'b'</span></span>) &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>;</code> </pre><br></div></div><br>  Mitarbeitertabelle.  Holen Sie sich eine Liste aller Mitarbeiter, deren Name mindestens 2 Buchstaben 'a' enthält. <br><div class="spoiler">  <b class="spoiler_title">Lösung</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INSTR</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">LOWER</span></span> (first_name),<span class="hljs-string"><span class="hljs-string">'a'</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>) &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>;</code> </pre><br></div></div><br>  Mitarbeitertabelle.  Holen Sie sich eine Liste aller Mitarbeiter, deren Gehalt ein Vielfaches von 1000 ist <br><div class="spoiler">  <b class="spoiler_title">Lösung</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">MOD</span></span> (salary, <span class="hljs-number"><span class="hljs-number">1000</span></span>) = <span class="hljs-number"><span class="hljs-number">0</span></span>;</code> </pre><br></div></div><br>  Mitarbeitertabelle.  Rufen Sie die erste dreistellige Nummer der Telefonnummer des Mitarbeiters ab, wenn seine Nummer das Format XXXX.XXX.XXXX hat <br><div class="spoiler">  <b class="spoiler_title">Lösung</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> phone_number, <span class="hljs-keyword"><span class="hljs-keyword">SUBSTR</span></span> (phone_number, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>) new_phone_number <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> phone_number <span class="hljs-keyword"><span class="hljs-keyword">LIKE</span></span> <span class="hljs-string"><span class="hljs-string">'___.___.____'</span></span>;</code> </pre><br></div></div><br>  Abteilungstabelle.  Holen Sie sich das erste Wort aus dem Namen der Abteilung für diejenigen mit mehr als einem Wort im Namen <br><div class="spoiler">  <b class="spoiler_title">Lösung</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> department_name, <span class="hljs-keyword"><span class="hljs-keyword">SUBSTR</span></span> (department_name, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">INSTR</span></span> (department_name, <span class="hljs-string"><span class="hljs-string">' '</span></span>)<span class="hljs-number"><span class="hljs-number">-1</span></span>) first_word <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> departments <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INSTR</span></span> (department_name, <span class="hljs-string"><span class="hljs-string">' '</span></span>) &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>;</code> </pre><br></div></div><br>  Mitarbeitertabelle.  Holen Sie sich die Namen der Mitarbeiter ohne den ersten und letzten Buchstaben im Namen <br><div class="spoiler">  <b class="spoiler_title">Lösung</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> first_name, <span class="hljs-keyword"><span class="hljs-keyword">SUBSTR</span></span> (first_name, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">LENGTH</span></span> (first_name) - <span class="hljs-number"><span class="hljs-number">2</span></span>) new_name <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees;</code> </pre><br></div></div><br>  Mitarbeitertabelle.  Holen Sie sich eine Liste aller Mitarbeiter, deren letzter Buchstabe im Namen 'm' und ein langer Name größer als 5 ist <br><div class="spoiler">  <b class="spoiler_title">Lösung</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SUBSTR</span></span> (first_name, <span class="hljs-number"><span class="hljs-number">-1</span></span>) = <span class="hljs-string"><span class="hljs-string">'m'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> <span class="hljs-keyword"><span class="hljs-keyword">LENGTH</span></span>(first_name)&gt;<span class="hljs-number"><span class="hljs-number">5</span></span>;</code> </pre><br></div></div><br>  Doppeltisch.  Holen Sie sich nächsten Freitag Datum <br><div class="spoiler">  <b class="spoiler_title">Lösung</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> NEXT_DAY (<span class="hljs-keyword"><span class="hljs-keyword">SYSDATE</span></span>, <span class="hljs-string"><span class="hljs-string">'FRIDAY'</span></span>) next_friday <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> DUAL;</code> </pre><br></div></div><br>  Mitarbeitertabelle.  Erhalten Sie eine Liste aller Mitarbeiter, die seit über 17 Jahren im Unternehmen tätig sind <br><div class="spoiler">  <b class="spoiler_title">Lösung</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> MONTHS_BETWEEN (<span class="hljs-keyword"><span class="hljs-keyword">SYSDATE</span></span>, hire_date) / <span class="hljs-number"><span class="hljs-number">12</span></span> &gt; <span class="hljs-number"><span class="hljs-number">17</span></span>;</code> </pre><br></div></div><br>  Mitarbeitertabelle.  Holen Sie sich eine Liste aller Mitarbeiter, deren letzte Ziffer der Telefonnummer ungerade ist und aus 3 durch einen Punkt getrennten Zahlen besteht <br><div class="spoiler">  <b class="spoiler_title">Lösung</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">MOD</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SUBSTR</span></span> (phone_number, <span class="hljs-number"><span class="hljs-number">-1</span></span>), <span class="hljs-number"><span class="hljs-number">2</span></span>) != <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INSTR</span></span> (phone_number,<span class="hljs-string"><span class="hljs-string">'.'</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span>) = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INSTR</span></span> (phone_number,<span class="hljs-string"><span class="hljs-string">'.'</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>) &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>;</code> </pre><br></div></div><br>  Mitarbeitertabelle.  Rufen Sie eine Liste aller Mitarbeiter ab, deren Job_id-Wert nach dem Zeichen '_' mindestens 3 Zeichen enthält. Dieser Wert nach '_' entspricht jedoch nicht 'CLERK'. <br><div class="spoiler">  <b class="spoiler_title">Lösung</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">LENGTH</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SUBSTR</span></span> (job_id, <span class="hljs-keyword"><span class="hljs-keyword">INSTR</span></span> (job_id, <span class="hljs-string"><span class="hljs-string">'_'</span></span>) + <span class="hljs-number"><span class="hljs-number">1</span></span>)) &gt; <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SUBSTR</span></span> (job_id, <span class="hljs-keyword"><span class="hljs-keyword">INSTR</span></span> (job_id, <span class="hljs-string"><span class="hljs-string">'_'</span></span>) + <span class="hljs-number"><span class="hljs-number">1</span></span>) != <span class="hljs-string"><span class="hljs-string">'CLERK'</span></span>;</code> </pre><br></div></div><br>  Mitarbeitertabelle.  Holen Sie sich eine Liste aller Mitarbeiter, indem Sie alle '.' Im Wert PHONE_NUMBER ersetzen.  auf '-' <br><div class="spoiler">  <b class="spoiler_title">Lösung</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> phone_number, <span class="hljs-keyword"><span class="hljs-keyword">REPLACE</span></span> (phone_number, <span class="hljs-string"><span class="hljs-string">'.'</span></span>, <span class="hljs-string"><span class="hljs-string">'-'</span></span>) new_phone_number <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees;</code> </pre><br></div></div><br><br>  <b>Verwenden von Konvertierungsfunktionen und bedingten Ausdrücken</b> <br><br>  Mitarbeitertabelle.  Holen Sie sich eine Liste aller Mitarbeiter, die am ersten Tag des Monats zur Arbeit gekommen sind (beliebig) <br><div class="spoiler">  <b class="spoiler_title">Lösung</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> TO_CHAR (hire_date, <span class="hljs-string"><span class="hljs-string">'DD'</span></span>) = <span class="hljs-string"><span class="hljs-string">'01'</span></span>;</code> </pre><br></div></div><br>  Mitarbeitertabelle.  Holen Sie sich eine Liste aller Mitarbeiter, die 2008 zur Arbeit kamen <br><div class="spoiler">  <b class="spoiler_title">Lösung</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> TO_CHAR (hire_date, <span class="hljs-string"><span class="hljs-string">'YYYY'</span></span>) = <span class="hljs-string"><span class="hljs-string">'2008'</span></span>;</code> </pre><br></div></div><br>  DUAL Tabelle.  Zeigen Sie das Datum von morgen im Format an: Morgen ist der zweite Tag im Januar <br><div class="spoiler">  <b class="spoiler_title">Lösung</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> TO_CHAR (<span class="hljs-keyword"><span class="hljs-keyword">SYSDATE</span></span>, <span class="hljs-string"><span class="hljs-string">'fm""Tomorrow is ""Ddspth ""day of"" Month'</span></span>) info <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> DUAL;</code> </pre><br></div></div><br>  Mitarbeitertabelle.  Holen Sie sich eine Liste aller Mitarbeiter und das Datum, an dem alle zur Arbeit kamen, im Format: 21. Juni 2007 <br><div class="spoiler">  <b class="spoiler_title">Lösung</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> first_name, TO_CHAR (hire_date, <span class="hljs-string"><span class="hljs-string">'fmddth ""of"" Month, YYYY'</span></span>) hire_date <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees;</code> </pre><br></div></div><br>  Mitarbeitertabelle.  Holen Sie sich eine Liste der Mitarbeiter mit um 20% höheren Gehältern.  Gehalt mit Dollarzeichen anzeigen <br><div class="spoiler">  <b class="spoiler_title">Lösung</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> first_name, TO_CHAR (salary + salary * <span class="hljs-number"><span class="hljs-number">0.20</span></span>, <span class="hljs-string"><span class="hljs-string">'fm$999,999.00'</span></span>) new_salary <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees;</code> </pre><br></div></div><br>  Mitarbeitertabelle.  Holen Sie sich eine Liste aller Mitarbeiter, die im Februar 2007 zur Arbeit kommen. <br><div class="spoiler">  <b class="spoiler_title">Lösung</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> hire_date <span class="hljs-keyword"><span class="hljs-keyword">BETWEEN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TO_DATE</span></span> (<span class="hljs-string"><span class="hljs-string">'01.02.2007'</span></span>, <span class="hljs-string"><span class="hljs-string">'DD.MM.YYYY'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> <span class="hljs-keyword"><span class="hljs-keyword">LAST_DAY</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">TO_DATE</span></span> (<span class="hljs-string"><span class="hljs-string">'01.02.2007'</span></span>, <span class="hljs-string"><span class="hljs-string">'DD.MM.YYYY'</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> to_char(hire_date,<span class="hljs-string"><span class="hljs-string">'MM.YYYY'</span></span>) = <span class="hljs-string"><span class="hljs-string">'02.2007'</span></span>;</code> </pre><br></div></div><br>  DUAL Tabelle.  Nehmen Sie das aktuelle Datum, + Sekunde, + Minute, + Stunde, + Tag, + Monat, + Jahr heraus <br><div class="spoiler">  <b class="spoiler_title">Lösung</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SYSDATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">now</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">SYSDATE</span></span> + <span class="hljs-number"><span class="hljs-number">1</span></span> / (<span class="hljs-number"><span class="hljs-number">24</span></span> * <span class="hljs-number"><span class="hljs-number">60</span></span> * <span class="hljs-number"><span class="hljs-number">60</span></span>) plus_second, <span class="hljs-keyword"><span class="hljs-keyword">SYSDATE</span></span> + <span class="hljs-number"><span class="hljs-number">1</span></span> / (<span class="hljs-number"><span class="hljs-number">24</span></span> * <span class="hljs-number"><span class="hljs-number">60</span></span>) plus_minute, <span class="hljs-keyword"><span class="hljs-keyword">SYSDATE</span></span> + <span class="hljs-number"><span class="hljs-number">1</span></span> / <span class="hljs-number"><span class="hljs-number">24</span></span> plus_hour, <span class="hljs-keyword"><span class="hljs-keyword">SYSDATE</span></span> + <span class="hljs-number"><span class="hljs-number">1</span></span> plus_day, ADD_MONTHS (<span class="hljs-keyword"><span class="hljs-keyword">SYSDATE</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>) plus_month, ADD_MONTHS (<span class="hljs-keyword"><span class="hljs-keyword">SYSDATE</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>) plus_year <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> DUAL;</code> </pre><br></div></div><br>  Mitarbeitertabelle.  Erhalten Sie eine Liste aller Mitarbeiter mit vollem Gehalt (Gehalt + Provision_Pkt (%)) im Format: 24.000,00 USD <br><div class="spoiler">  <b class="spoiler_title">Lösung</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> first_name, salary, TO_CHAR (salary + salary * NVL (commission_pct, <span class="hljs-number"><span class="hljs-number">0</span></span>), <span class="hljs-string"><span class="hljs-string">'fm$99,999.00'</span></span>) full_salary <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees;</code> </pre><br></div></div><br>  Mitarbeitertabelle.  Erhalten Sie eine Liste aller Mitarbeiter und Informationen zur Verfügbarkeit von Gehaltsprämien (Ja / Nein) <br><div class="spoiler">  <b class="spoiler_title">Lösung</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> first_name, commission_pct, NVL2 (commission_pct, <span class="hljs-string"><span class="hljs-string">'Yes'</span></span>, <span class="hljs-string"><span class="hljs-string">'No'</span></span>) has_bonus <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees;</code> </pre><br></div></div><br>  Mitarbeitertabelle.  Ermitteln Sie das Gehaltsniveau jedes Mitarbeiters: Weniger als 5000 gelten als niedrig, mehr als oder gleich 5000 und weniger als 10000 als normal, mehr als oder gleich 10000 als hoch <br><div class="spoiler">  <b class="spoiler_title">Lösung</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> first_name, salary, <span class="hljs-keyword"><span class="hljs-keyword">CASE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> salary &lt; <span class="hljs-number"><span class="hljs-number">5000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> <span class="hljs-string"><span class="hljs-string">'Low'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> salary &gt;= <span class="hljs-number"><span class="hljs-number">5000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> salary &lt; <span class="hljs-number"><span class="hljs-number">10000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> <span class="hljs-string"><span class="hljs-string">'Normal'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> salary &gt;= <span class="hljs-number"><span class="hljs-number">10000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> <span class="hljs-string"><span class="hljs-string">'High'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ELSE</span></span> <span class="hljs-string"><span class="hljs-string">'Unknown'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">END</span></span> salary_level <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees;</code> </pre><br></div></div><br>  Ländertabelle.  Zeigen Sie für jedes Land die Region an, in der es sich befindet: 1-Europa, 2-Amerika, 3-Asien, 4-Afrika (ohne Beitritt) <br><div class="spoiler">  <b class="spoiler_title">Lösung</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> country_name country, <span class="hljs-keyword"><span class="hljs-keyword">DECODE</span></span> (region_id, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">'Europe'</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-string"><span class="hljs-string">'America'</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-string"><span class="hljs-string">'Asia'</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-string"><span class="hljs-string">'Africa'</span></span>, <span class="hljs-string"><span class="hljs-string">'Unknown'</span></span>) region <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> countries; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> country_name country, <span class="hljs-keyword"><span class="hljs-keyword">CASE</span></span> region_id <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> <span class="hljs-string"><span class="hljs-string">'Europe'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> <span class="hljs-string"><span class="hljs-string">'America'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> <span class="hljs-string"><span class="hljs-string">'Asia'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> <span class="hljs-string"><span class="hljs-string">'Africa'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ELSE</span></span> <span class="hljs-string"><span class="hljs-string">'Unknown'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">END</span></span> region <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> countries;</code> </pre><br></div></div><br><br>  <b>Aggregierte Daten mithilfe der Gruppenfunktionen melden</b> <br><br>  Mitarbeitertabelle.  Erhalten Sie einen Bericht über department_id mit einem Mindest- und Höchstgehalt, einem frühen und späten Ankunftsdatum bei der Arbeit und der Anzahl der Mitarbeiter.  Sortieren nach Anzahl der Mitarbeiter (absteigend) <br><div class="spoiler">  <b class="spoiler_title">Lösung</b> <div class="spoiler_text"><pre> <code class="sql hljs"> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> department_id, <span class="hljs-keyword"><span class="hljs-keyword">MIN</span></span> (salary) min_salary, <span class="hljs-keyword"><span class="hljs-keyword">MAX</span></span> (salary) max_salary, <span class="hljs-keyword"><span class="hljs-keyword">MIN</span></span> (hire_date) min_hire_date, <span class="hljs-keyword"><span class="hljs-keyword">MAX</span></span> (hire_date) max_hire_Date, <span class="hljs-keyword"><span class="hljs-keyword">COUNT</span></span> (*) <span class="hljs-keyword"><span class="hljs-keyword">count</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">GROUP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> department_id <span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> <span class="hljs-keyword"><span class="hljs-keyword">count</span></span>(*) <span class="hljs-keyword"><span class="hljs-keyword">desc</span></span>;</code> </pre><br></div></div><br>  Mitarbeitertabelle.  Wie viele Mitarbeiter, deren Namen mit demselben Buchstaben beginnen?  Nach Menge sortieren.  Zeigen Sie nur, wo die Menge größer als 1 ist <br><div class="spoiler">  <b class="spoiler_title">Lösung</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SUBSTR</span></span> (first_name, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>) first_char, <span class="hljs-keyword"><span class="hljs-keyword">COUNT</span></span> (*) <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">GROUP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SUBSTR</span></span> (first_name, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">HAVING</span></span> <span class="hljs-keyword"><span class="hljs-keyword">COUNT</span></span> (*) &gt; <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DESC</span></span>;</code> </pre><br></div></div><br>  Mitarbeitertabelle.  Wie viele Mitarbeiter arbeiten in derselben Abteilung und erhalten dasselbe Gehalt? <br><div class="spoiler">  <b class="spoiler_title">Lösung</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> department_id, salary, <span class="hljs-keyword"><span class="hljs-keyword">COUNT</span></span> (*) <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">GROUP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> department_id, salary <span class="hljs-keyword"><span class="hljs-keyword">HAVING</span></span> <span class="hljs-keyword"><span class="hljs-keyword">COUNT</span></span> (*) &gt; <span class="hljs-number"><span class="hljs-number">1</span></span>;</code> </pre><br></div></div><br>  Mitarbeitertabelle.  Erhalten Sie einen Bericht darüber, wie viele Mitarbeiter an jedem Wochentag eingestellt wurden.  Nach Menge sortieren <br><div class="spoiler">  <b class="spoiler_title">Lösung</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> TO_CHAR (hire_Date, <span class="hljs-string"><span class="hljs-string">'Day'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">day</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">COUNT</span></span> (*) <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">GROUP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> TO_CHAR (hire_Date, <span class="hljs-string"><span class="hljs-string">'Day'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DESC</span></span>;</code> </pre><br></div></div><br>  Mitarbeitertabelle.  Erhalten Sie einen Bericht darüber, wie viele Mitarbeiter pro Jahr eingestellt wurden.  Nach Menge sortieren <br><div class="spoiler">  <b class="spoiler_title">Lösung</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> TO_CHAR (hire_date, <span class="hljs-string"><span class="hljs-string">'YYYY'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">year</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">COUNT</span></span> (*) <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">GROUP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> TO_CHAR (hire_date, <span class="hljs-string"><span class="hljs-string">'YYYY'</span></span>);</code> </pre><br></div></div><br>  Mitarbeitertabelle.  Ermitteln Sie die Anzahl der Abteilungen, in denen Mitarbeiter beschäftigt sind <br><div class="spoiler">  <b class="spoiler_title">Lösung</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">COUNT</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">COUNT</span></span> (*)) department_count <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> department_id <span class="hljs-keyword"><span class="hljs-keyword">IS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GROUP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> department_id;</code> </pre><br></div></div><br>  Mitarbeitertabelle.  Holen Sie sich eine Liste von department_id mit mehr als 30 Mitarbeitern <br><div class="spoiler">  <b class="spoiler_title">Lösung</b> <div class="spoiler_text"><pre> <code class="sql hljs"> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> department_id <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">GROUP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> department_id <span class="hljs-keyword"><span class="hljs-keyword">HAVING</span></span> <span class="hljs-keyword"><span class="hljs-keyword">COUNT</span></span> (*) &gt; <span class="hljs-number"><span class="hljs-number">30</span></span>;</code> </pre><br></div></div><br>  Mitarbeitertabelle.  Holen Sie sich eine Liste von department_id und ein gerundetes Durchschnittsgehalt für Mitarbeiter in jeder Abteilung. <br><div class="spoiler">  <b class="spoiler_title">Lösung</b> <div class="spoiler_text"><pre> <code class="sql hljs"> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> department_id, <span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">AVG</span></span> (salary)) avg_salary <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">GROUP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> department_id;</code> </pre><br></div></div><br>  Ländertabelle.  Holen Sie sich eine Liste von region_id die Summe aller Buchstaben aller country_name, in denen mehr als 60 <br><div class="spoiler">  <b class="spoiler_title">Lösung</b> <div class="spoiler_text"><pre> <code class="sql hljs"> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> region_id <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> countries <span class="hljs-keyword"><span class="hljs-keyword">GROUP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> region_id <span class="hljs-keyword"><span class="hljs-keyword">HAVING</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SUM</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">LENGTH</span></span> (country_name)) &gt; <span class="hljs-number"><span class="hljs-number">60</span></span>;</code> </pre><br></div></div><br>  Mitarbeitertabelle.  Rufen Sie eine Liste der Abteilungs-ID ab, in der Mitarbeiter mehrerer (&gt; 1) Job-ID arbeiten <br><div class="spoiler">  <b class="spoiler_title">Lösung</b> <div class="spoiler_text"><pre> <code class="sql hljs"> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> department_id <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">GROUP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> department_id <span class="hljs-keyword"><span class="hljs-keyword">HAVING</span></span> <span class="hljs-keyword"><span class="hljs-keyword">COUNT</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">DISTINCT</span></span> job_id) &gt; <span class="hljs-number"><span class="hljs-number">1</span></span>;</code> </pre><br></div></div><br>  Mitarbeitertabelle.  Holen Sie sich eine Liste von manager_id, deren Anzahl der Untergebenen mehr als 5 beträgt und deren Summe aller Gehälter seiner Untergebenen mehr als 50.000 beträgt <br><div class="spoiler">  <b class="spoiler_title">Lösung</b> <div class="spoiler_text"><pre> <code class="sql hljs"> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> manager_id <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">GROUP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> manager_id <span class="hljs-keyword"><span class="hljs-keyword">HAVING</span></span> <span class="hljs-keyword"><span class="hljs-keyword">COUNT</span></span> (*) &gt; <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SUM</span></span> (salary) &gt; <span class="hljs-number"><span class="hljs-number">50000</span></span>;</code> </pre><br></div></div><br>  Mitarbeitertabelle.  Holen Sie sich eine Liste von manager_id, für die das durchschnittliche Gehalt aller seiner Untergebenen im Bereich von 6000 bis 9000 liegt, die keine Boni erhalten (Commission_pct ist leer). <br><div class="spoiler">  <b class="spoiler_title">Lösung</b> <div class="spoiler_text"><pre> <code class="sql hljs"> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> manager_id, <span class="hljs-keyword"><span class="hljs-keyword">AVG</span></span> (salary) avg_salary <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> commission_pct <span class="hljs-keyword"><span class="hljs-keyword">IS</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GROUP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> manager_id <span class="hljs-keyword"><span class="hljs-keyword">HAVING</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AVG</span></span> (salary) <span class="hljs-keyword"><span class="hljs-keyword">BETWEEN</span></span> <span class="hljs-number"><span class="hljs-number">6000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> <span class="hljs-number"><span class="hljs-number">9000</span></span>;</code> </pre><br></div></div><br>  Mitarbeitertabelle.  Holen Sie sich das maximale Gehalt von allen Mitarbeitern job_id, die mit dem Wort "CLERK" enden. <br><div class="spoiler">  <b class="spoiler_title">Lösung</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">MAX</span></span> (salary) max_salary <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> job_id <span class="hljs-keyword"><span class="hljs-keyword">LIKE</span></span> <span class="hljs-string"><span class="hljs-string">'%CLERK'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">MAX</span></span> (salary) max_salary <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SUBSTR</span></span> (job_id, <span class="hljs-number"><span class="hljs-number">-5</span></span>) = <span class="hljs-string"><span class="hljs-string">'CLERK'</span></span>;</code> </pre><br></div></div><br>  Mitarbeitertabelle.  Holen Sie sich das maximale Gehalt unter allen Durchschnittsgehältern in der Abteilung <br><div class="spoiler">  <b class="spoiler_title">Lösung</b> <div class="spoiler_text"><pre> <code class="sql hljs"> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">MAX</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">AVG</span></span> (salary)) <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">GROUP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> department_id;</code> </pre><br></div></div><br>  Mitarbeitertabelle.  Ermitteln Sie die Anzahl der Mitarbeiter mit der gleichen Anzahl von Buchstaben im Namen.  Zeigen Sie gleichzeitig nur diejenigen mit einer Namenslänge von mehr als 5 und einer Anzahl von Mitarbeitern mit diesem Namen von mehr als 20 an. Sortieren Sie nach Namenslänge <br><div class="spoiler">  <b class="spoiler_title">Lösung</b> <div class="spoiler_text"><pre> <code class="sql hljs"> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">LENGTH</span></span> (first_name), <span class="hljs-keyword"><span class="hljs-keyword">COUNT</span></span> (*) <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">GROUP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> <span class="hljs-keyword"><span class="hljs-keyword">LENGTH</span></span> (first_name) <span class="hljs-keyword"><span class="hljs-keyword">HAVING</span></span> <span class="hljs-keyword"><span class="hljs-keyword">LENGTH</span></span> (first_name) &gt; <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> <span class="hljs-keyword"><span class="hljs-keyword">COUNT</span></span> (*) &gt; <span class="hljs-number"><span class="hljs-number">20</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> <span class="hljs-keyword"><span class="hljs-keyword">LENGTH</span></span> (first_name); <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">LENGTH</span></span> (first_name), <span class="hljs-keyword"><span class="hljs-keyword">COUNT</span></span> (*) <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">LENGTH</span></span> (first_name) &gt; <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GROUP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> <span class="hljs-keyword"><span class="hljs-keyword">LENGTH</span></span> (first_name) <span class="hljs-keyword"><span class="hljs-keyword">HAVING</span></span> <span class="hljs-keyword"><span class="hljs-keyword">COUNT</span></span> (*) &gt; <span class="hljs-number"><span class="hljs-number">20</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> <span class="hljs-keyword"><span class="hljs-keyword">LENGTH</span></span> (first_name);</code> </pre><br></div></div><br><br>  <b>Anzeigen von Daten aus mehreren Tabellen mithilfe von Verknüpfungen</b> <br><br>  Tabelle Mitarbeiter, Abteilungen, Standorte, Länder, Regionen.  Holen Sie sich eine Liste der Regionen und die Anzahl der Mitarbeiter in jeder Region <br><div class="spoiler">  <b class="spoiler_title">Lösung</b> <div class="spoiler_text"><pre> <code class="sql hljs"> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> region_name, <span class="hljs-keyword"><span class="hljs-keyword">COUNT</span></span> (*) <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees e <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> departments d <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> (e.department_id = d.department_id) <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> locations l <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> (d.location_id = l.location_id) <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> countries c <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> (l.country_id = c.country_id) <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> regions r <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> (c.region_id = r.region_id) <span class="hljs-keyword"><span class="hljs-keyword">GROUP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> region_name;</code> </pre><br></div></div><br>  Tabelle Mitarbeiter, Abteilungen, Standorte, Länder, Regionen.  Erhalten Sie detaillierte Informationen zu jedem Mitarbeiter: <br>  Vorname, Nachname, Abteilung, Job, Straße, Land, Region <br><div class="spoiler">  <b class="spoiler_title">Lösung</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> First_name, Last_name, Department_name, Job_id, street_address, Country_name, Region_name <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees e <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> departments d <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> (e.department_id = d.department_id) <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> locations l <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> (d.location_id = l.location_id) <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> countries c <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> (l.country_id = c.country_id) <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> regions r <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> (c.region_id = r.region_id);</code> </pre><br></div></div><br>  Mitarbeitertabelle.  Zeigen Sie alle Manager mit mehr als 6 Mitarbeitern <br><div class="spoiler">  <b class="spoiler_title">Lösung</b> <div class="spoiler_text"><pre> <code class="sql hljs"> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> man.first_name, <span class="hljs-keyword"><span class="hljs-keyword">COUNT</span></span> (*) <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees emp <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> employees man <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> (emp.manager_id = man.employee_id) <span class="hljs-keyword"><span class="hljs-keyword">GROUP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> man.first_name <span class="hljs-keyword"><span class="hljs-keyword">HAVING</span></span> <span class="hljs-keyword"><span class="hljs-keyword">COUNT</span></span> (*) &gt; <span class="hljs-number"><span class="hljs-number">6</span></span>;</code> </pre><br></div></div><br>  Mitarbeitertabelle.  Zeigen Sie alle Mitarbeiter an, die niemandem Bericht erstatten <br><div class="spoiler">  <b class="spoiler_title">Lösung</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> emp.first_name <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees emp <span class="hljs-keyword"><span class="hljs-keyword">LEFT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> employees man <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> (emp.manager_id = man.employee_id) <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> man.FIRST_NAME <span class="hljs-keyword"><span class="hljs-keyword">IS</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> first_name <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> manager_id <span class="hljs-keyword"><span class="hljs-keyword">IS</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>;</code> </pre><br></div></div><br>  Mitarbeitertabelle, Job_history.  In der Mitarbeitertabelle werden alle Mitarbeiter gespeichert.  In der Tabelle Job_history werden die Mitarbeiter gespeichert, die das Unternehmen verlassen haben.  Erhalten Sie einen Bericht über alle Mitarbeiter und ihren Status im Unternehmen (arbeitet oder verlässt das Unternehmen mit dem Datum der Abreise) <br>  Ein Beispiel: <br>  Vorname |  Status <br>  Jennifer |  Hat das Unternehmen am 31. Dezember 2006 verlassen <br>  Clara |  Derzeit arbeitet <br><div class="spoiler">  <b class="spoiler_title">Lösung</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> first_name, NVL2 ( end_date, TO_CHAR (end_date, <span class="hljs-string"><span class="hljs-string">'fm""Left the company at"" DD ""of"" Month, YYYY'</span></span>), <span class="hljs-string"><span class="hljs-string">'Currently Working'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">status</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees e <span class="hljs-keyword"><span class="hljs-keyword">LEFT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> job_history j <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> (e.employee_id = j.employee_id);</code> </pre><br></div></div><br>  Tabelle Mitarbeiter, Abteilungen, Standorte, Länder, Regionen.  Holen Sie sich eine Liste der Mitarbeiter, die in Europa leben (region_name) <br><div class="spoiler">  <b class="spoiler_title">Lösung</b> <div class="spoiler_text"><pre> <code class="sql hljs"> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> first_name <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> departments <span class="hljs-keyword"><span class="hljs-keyword">USING</span></span> (department_id) <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> locations <span class="hljs-keyword"><span class="hljs-keyword">USING</span></span> (location_id) <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> countries <span class="hljs-keyword"><span class="hljs-keyword">USING</span></span> (country_id) <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> regions <span class="hljs-keyword"><span class="hljs-keyword">USING</span></span> (region_id) <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> region_name = <span class="hljs-string"><span class="hljs-string">'Europe'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> first_name <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees e <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> departments d <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> (e.department_id = d.department_id) <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> locations l <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> (d.location_id = l.location_id) <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> countries c <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> (l.country_id = c.country_id) <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> regions r <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> (c.region_id = r.region_id) <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> region_name = <span class="hljs-string"><span class="hljs-string">'Europe'</span></span>;</code> </pre><br></div></div><br>  Mitarbeitertabelle, Abteilungen.  Zeigen Sie alle Abteilungen mit mehr als 30 Mitarbeitern <br><div class="spoiler">  <b class="spoiler_title">Lösung</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> department_name, <span class="hljs-keyword"><span class="hljs-keyword">COUNT</span></span> (*) <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees e <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> departments d <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> (e.department_id = d.department_id) <span class="hljs-keyword"><span class="hljs-keyword">GROUP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> department_name <span class="hljs-keyword"><span class="hljs-keyword">HAVING</span></span> <span class="hljs-keyword"><span class="hljs-keyword">COUNT</span></span> (*) &gt; <span class="hljs-number"><span class="hljs-number">30</span></span>;</code> </pre><br></div></div><br>  Mitarbeitertabelle, Abteilungen.  Zeigen Sie alle Mitarbeiter an, die keiner Abteilung angehören <br><div class="spoiler">  <b class="spoiler_title">Lösung</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> first_name <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees e <span class="hljs-keyword"><span class="hljs-keyword">LEFT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> departments d <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> (e.department_id = d.department_id) <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> d.department_name <span class="hljs-keyword"><span class="hljs-keyword">IS</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> first_name <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> department_id <span class="hljs-keyword"><span class="hljs-keyword">IS</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>;</code> </pre><br></div></div><br>  Mitarbeitertabelle, Abteilungen.  Alle Abteilungen ohne einen Mitarbeiter anzeigen <br><div class="spoiler">  <b class="spoiler_title">Lösung</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> department_name <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees e <span class="hljs-keyword"><span class="hljs-keyword">RIGHT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> departments d <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> (e.department_id = d.department_id) <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> first_name <span class="hljs-keyword"><span class="hljs-keyword">IS</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>;</code> </pre><br></div></div><br>  Mitarbeitertabelle.  Zeigen Sie alle Mitarbeiter an, die keine Untergebenen haben <br><div class="spoiler">  <b class="spoiler_title">Lösung</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> man.first_name <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees emp <span class="hljs-keyword"><span class="hljs-keyword">RIGHT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> employees man <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> (emp.manager_id = man.employee_id) <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> emp.FIRST_NAME <span class="hljs-keyword"><span class="hljs-keyword">IS</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>;</code> </pre><br></div></div><br>  Tischangestellte, Jobs, Abteilungen.  Zeigen Sie Mitarbeiter im Format: Vorname, Jobtitel, Abteilungsname. <br>  Ein Beispiel: <br>  Vorname |  Job_title |  Abteilungsname <br>  Donald |  Versand |  Sachbearbeiter Versand <br><div class="spoiler">  <b class="spoiler_title">Lösung</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> first_name, job_title, department_name <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees e <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> jobs j <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> (e.job_id = j.job_id) <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> departments d <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> (d.department_id = e.department_id);</code> </pre><br></div></div><br>  Mitarbeitertabelle.  Holen Sie sich eine Liste der Mitarbeiter, deren Manager 2005 einen Job bekommen haben, aber gleichzeitig haben diese Mitarbeiter selbst vor 2005 einen Job bekommen <br><div class="spoiler">  <b class="spoiler_title">Lösung</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> emp.* <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees emp <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> employees man <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> (emp.manager_id = man.employee_id) <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> TO_CHAR (man.hire_date, <span class="hljs-string"><span class="hljs-string">'YYYY'</span></span>) = <span class="hljs-string"><span class="hljs-string">'2005'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> emp.hire_date &lt; <span class="hljs-keyword"><span class="hljs-keyword">TO_DATE</span></span> (<span class="hljs-string"><span class="hljs-string">'01012005'</span></span>, <span class="hljs-string"><span class="hljs-string">'DDMMYYYY'</span></span>);</code> </pre><br></div></div><br>  Mitarbeitertabelle.  Holen Sie sich eine Liste der Mitarbeiter, deren Manager im Januar eines jeden Jahres einen Job bekommen haben, und die Länge des job_title dieser Mitarbeiter beträgt mehr als 15 Zeichen <br><div class="spoiler">  <b class="spoiler_title">Lösung</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> emp.* <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees emp <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> employees man <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> (emp.manager_id = man.employee_id) <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> jobs j <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> (emp.job_id = j.job_id) <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> TO_CHAR (man.hire_date, <span class="hljs-string"><span class="hljs-string">'MM'</span></span>) = <span class="hljs-string"><span class="hljs-string">'01'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> <span class="hljs-keyword"><span class="hljs-keyword">LENGTH</span></span> (j.job_title) &gt; <span class="hljs-number"><span class="hljs-number">15</span></span>;</code> </pre><br></div></div><br><br>  <b>Verwenden von Unterabfragen zum Lösen von Abfragen</b> <br><br>  Mitarbeitertabelle.  Holen Sie sich eine Liste der Mitarbeiter mit dem längsten Namen. <br><div class="spoiler">  <b class="spoiler_title">Lösung</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">LENGTH</span></span> (first_name) = (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">MAX</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">LENGTH</span></span> (first_name)) <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees);</code> </pre><br></div></div><br>  Mitarbeitertabelle.  Holen Sie sich eine Liste der Mitarbeiter mit einem Gehalt, das über dem Durchschnittsgehalt aller Mitarbeiter liegt. <br><div class="spoiler">  <b class="spoiler_title">Lösung</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> salary &gt; (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AVG</span></span> (salary) <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees);</code> </pre><br></div></div><br>  Tabelle Mitarbeiter, Abteilungen, Standorte.  Holen Sie sich eine Stadt, in der Mitarbeiter insgesamt weniger verdienen. <br><div class="spoiler">  <b class="spoiler_title">Lösung</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> city <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees e <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> departments d <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> (e.department_id = d.department_id) <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> locations l <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> (d.location_id = l.location_id) <span class="hljs-keyword"><span class="hljs-keyword">GROUP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> city <span class="hljs-keyword"><span class="hljs-keyword">HAVING</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SUM</span></span> (salary) = ( <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">MIN</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SUM</span></span> (salary)) <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees e <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> departments d <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> (e.department_id = d.department_id) <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> locations l <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> (d.location_id = l.location_id) <span class="hljs-keyword"><span class="hljs-keyword">GROUP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> city);</code> </pre><br></div></div><br>  Mitarbeitertabelle.  Holen Sie sich eine Liste der Mitarbeiter, deren Manager ein Gehalt von mehr als 15.000 erhält. <br><div class="spoiler">  <b class="spoiler_title">Lösung</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> manager_id <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> employee_id <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> salary &gt; <span class="hljs-number"><span class="hljs-number">15000</span></span>)</code> </pre><br></div></div><br>  Mitarbeitertabelle, Abteilungen.  Alle Abteilungen ohne einen Mitarbeiter anzeigen <br><div class="spoiler">  <b class="spoiler_title">Lösung</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> departments <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> department_id <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> department_id <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> department_id <span class="hljs-keyword"><span class="hljs-keyword">IS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>);</code> </pre><br></div></div><br>  Mitarbeitertabelle.  Zeigen Sie alle Mitarbeiter, die keine Manager sind <br><div class="spoiler">  <b class="spoiler_title">Lösung</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> employee_id <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> manager_id <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> manager_id <span class="hljs-keyword"><span class="hljs-keyword">IS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>)</code> </pre><br></div></div><br>  Mitarbeitertabelle.  Zeigen Sie alle Manager mit mehr als 6 Mitarbeitern <br><div class="spoiler">  <b class="spoiler_title">Lösung</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees e <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">COUNT</span></span> (*) <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> manager_id = e.employee_id) &gt; <span class="hljs-number"><span class="hljs-number">6</span></span>;</code> </pre><br></div></div><br>  Mitarbeitertabelle, Abteilungen.  Zeigen Sie Mitarbeitern, die in der IT-Abteilung arbeiten <br><div class="spoiler">  <b class="spoiler_title">Lösung</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> department_id = (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> department_id <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> departments <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> department_name = <span class="hljs-string"><span class="hljs-string">'IT'</span></span>);</code> </pre><br></div></div><br>  Tischangestellte, Jobs, Abteilungen.  Zeigen Sie Mitarbeiter im Format: Vorname, Jobtitel, Abteilungsname. <br>  Ein Beispiel: <br>  Vorname |  Job_title |  Abteilungsname <br>  Donald |  Versand |  Sachbearbeiter Versand <br><div class="spoiler">  <b class="spoiler_title">Lösung</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> first_name, (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> job_title <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> jobs <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> job_id = e.job_id) job_title, (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> department_name <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> departments <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> department_id = e.department_id) department_name <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees e;</code> </pre><br></div></div><br>  Mitarbeitertabelle.  Holen Sie sich eine Liste der Mitarbeiter, deren Manager 2005 einen Job bekommen haben, aber gleichzeitig haben diese Mitarbeiter selbst vor 2005 einen Job bekommen <br><div class="spoiler">  <b class="spoiler_title">Lösung</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> manager_id <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> employee_id <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> TO_CHAR (hire_date, <span class="hljs-string"><span class="hljs-string">'YYYY'</span></span>) = <span class="hljs-string"><span class="hljs-string">'2005'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> hire_date &lt; <span class="hljs-keyword"><span class="hljs-keyword">TO_DATE</span></span> (<span class="hljs-string"><span class="hljs-string">'01012005'</span></span>, <span class="hljs-string"><span class="hljs-string">'DDMMYYYY'</span></span>);</code> </pre><br></div></div><br>  Mitarbeitertabelle.  Holen Sie sich eine Liste der Mitarbeiter, deren Manager im Januar eines jeden Jahres einen Job bekommen haben, und die Länge des job_title dieser Mitarbeiter beträgt mehr als 15 Zeichen <br><div class="spoiler">  <b class="spoiler_title">Lösung</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees e <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> manager_id <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> employee_id <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> TO_CHAR (hire_date, <span class="hljs-string"><span class="hljs-string">'MM'</span></span>) = <span class="hljs-string"><span class="hljs-string">'01'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">LENGTH</span></span> (job_title) <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> jobs <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> job_id = e.job_id) &gt; <span class="hljs-number"><span class="hljs-number">15</span></span>;</code> </pre><br></div></div><br><br>  <b>Das ist alles für jetzt.</b> <br><br>  Ich hoffe, die Aufgaben waren interessant und faszinierend. <br>  Wenn möglich, werde ich diese Aufgabenliste ergänzen. <br>  Ich freue mich auch über Kommentare und Vorschläge. <br><br>  PS: Wenn jemand eine interessante SELECT-Aufgabe hat, schreibe in die Kommentare und füge sie der Liste hinzu. <br><br>  Vielen Dank. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de461567/">https://habr.com/ru/post/de461567/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de461553/index.html">Erfahrung in der Automatisierung visueller Regressionstests in Java + Selenium Webdriver + aShot</a></li>
<li><a href="../de461555/index.html">Google Spreadsheets-Visualisierungen</a></li>
<li><a href="../de461561/index.html">Arduino Timer</a></li>
<li><a href="../de461563/index.html">Selbstgemachtes Kupferdampflaser-Lichtschwert - Teil 3 Finale</a></li>
<li><a href="../de461565/index.html">Die 5 Gebote von TypeScript Developer</a></li>
<li><a href="../de461569/index.html">Hinweis für das Frontend: Was ist vor dem Testen zu überprüfen?</a></li>
<li><a href="../de461571/index.html">SVG im wirklichen Leben. Yandex-Bericht</a></li>
<li><a href="../de461575/index.html">Erstellen einer Cloud-basierten 3CX-TK-Anlage auf jedem Openstack-kompatiblen Hosting</a></li>
<li><a href="../de461577/index.html">Teil 5/2 Gebäude 1: Kreuzung der RocketChip Avenue und der rutschigen Instrumentierungsspur</a></li>
<li><a href="../de461579/index.html">WebMoney führt neue WMP-Geldbörsen ein und ändert die Spielregeln</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>