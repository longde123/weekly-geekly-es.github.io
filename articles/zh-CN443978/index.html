<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>📘 ⛹🏾 😌 ATtiny13与PLC的比较，或者如何从8英尺控制器获取14 I / O 🍫 🍵 🎙️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="在继续之前，我想警告一位热心的读者。 



1. 由于许多原因，我无法完成所描述的内容，这些原因将在评论中高兴地告诉您，而我绝不敦促您这样做。 而且，我绝不声称以下描述的设备可以代替真正的PLC。 所做的一切只是为了向我自己证明这在技术上是可行的，并且不适用于实际设备。 
2. 如果仅因提起“ A...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ATtiny13与PLC的比较，或者如何从8英尺控制器获取14 I / O</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/443978/"><img src="https://habrastorage.org/webt/lk/bp/pb/lkbppbhy4dv1ifgmfeoc3w_mcua.jpeg" alt="图片"><br><br> 在继续之前，我想警告一位热心的读者。 <br><br><ol><li> 由于许多原因，我无法完成所描述的内容，这些原因将在评论中高兴地告诉您，而我绝不敦促您这样做。 而且，我绝不声称以下描述的设备可以代替真正的PLC。 所做的一切只是为了向我自己证明这在技术上是可行的，并且不适用于实际设备。 </li><li> 如果仅因提起“ Arduino”一词而感到不适，最好不要阅读。 我使用Arduino IDE中的控制器执行了所有操作，对我来说更容易。 但是没有什么可以阻止不使用它的人做同样的事情。 </li></ol><a name="habracut"></a><br> 很长一段时间以来，我都想写一篇关于我在ATtiny13上进行的实验的文章，但主要是因为我对现场的Arduino专家的态度感到恐惧。 而且，我已经使用控制器仅几年了（再次感谢Arduino，哦，您去哪儿了！）。 对文章的评论<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">帖子</a>上有<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">三只眼睛……</a>表明该主题仍然吸引了足够多的用户。 顺便说一句，文章的标题应该是“ ATtiny13上的PLC”，但在同一评论中，他们<s>在桌上</s>对我客气地解释说所描述的设备不能称为“ PLC”。 好吧，不。 <br><br><h3> 我们需要PLC提供什么？ </h3><br> 首先，我想对企业中使用的PLC进行功能模拟，同时考虑到它们的使用方式。 我们拥有的大多数控制电路都有随之而来的所有缺点。 从90年代开始，各种类型的PLC也被广泛使用。 基本上，它们从限位开关和接近传感器的状态开始执行控制电路的逻辑任务。 <br><br> 没有复杂的接口，没有模拟信号。 开/关。 仅此而已。 在大多数情况下，甚至PLC输出的负载也由它们急于摆脱的继电器提供。  （有趣的是，几乎所有地方都使用PLC继电器输出，这些继电器开关外部继电器，液压分配器的电磁开关...有时还增加了起动器的另一个链接。）因此，我需要PLC提供什么： <br><br><ol><li> 离散输入，信号电平为24伏。 </li><li> 离散输出电压为24伏。 </li><li> 根据给定的方案测试内部算法，可以在必要时进行更改（主要是在调试过程中）。 </li><li> 速度约为50毫秒，不再需要更换继电器电路。 </li></ol><br> 就是这样。 没有接口。 没有打扰。 没有屏幕。 嗯，是的，屏幕...显示输入和输出的状态不会有任何问题；在这里，LED还没有配备更可靠的LED。 好吧，不要忘了一切都是出于体育运动的兴趣，预算分别落在开发人员的肩上。 顺便说一句，很好的激励。 <br><br> 如果您不考虑24伏特的信号电平，那么绝对不超过I / O（输入/输出）数量不少于所需数量的任何微控制器都可以轻松地完成任务。 <br><br><h3> 我们处理的水平 </h3><br> 最初，我想在输入端使用光耦合器。 任何对电子学，特别是对工业特别熟悉的人都知道，光耦合器并不多。 这些评论将详细告诉您为什么没有光耦合器是不可能的。 但是我权衡了利弊，决定拒绝。 因此，有些读者可能无法继续阅读，请立即写评论。 <br> 因此，我们有一个24伏的输入信号，或者在没有信号的情况下有一个0伏的输入信号。 这将允许使用非接触式感应位置传感器或常规的接触限位开关。 从24伏特开始，您需要为控制器获得安全的逻辑单元电压。 好的旧的分压器会尽可能地应对。 <br><br><img src="https://habrastorage.org/webt/k4/mh/5u/k4mh5u-z5xmykgkjexscgcu_pba.jpeg" alt="图片"><br><br> 计算电阻器时要考虑到，如果输入电压的任何偏差在微控制器输入端的额定电压的正负20％之内，都应该大于开关电压（通常是控制器电压的一半），但不大于控制器电压，我们认为它等于5 V. 适用于AVR系列中的任何控制器。 此外，通过分压器的估计电流约为7 mA，这降低了干扰的可能性，并且同时不会给传感器输出和电源带来沉重的负担。  4.7 V齐纳二极管可防止相同干扰下的电涌。 仍然有联系的反弹，我们可以通过编程或根本不使用它来解决，这只是一个模型。 现在，我仍然必须指出输入的状态。 在这里，您可以进行救生，用一块石头杀死两只鸟： <br><br><img src="https://habrastorage.org/webt/q9/rd/bj/q9rdbjjfnccqucc0cl6h9_19pr0.jpeg" alt="图片"><br><br> 电路上的LED具有两个功能-就像一个齐纳二极管一样，将电压限制在2.8 ... 2.9伏（仅适用于蓝色和白色LED！），并且它也发光。 我必须警告您，在某些情况下，LED上的电压不足以切换控制器输入！ 因此，当使用多个控制器输入时，我们简化了安装并节省了多个齐纳二极管。 通过平稳地增加输入电压，您会注意到LED的点亮时刻与切换输入的时刻并不一致。 但这并不会给我们带来太大的麻烦，因为输入处不应有中间电平，只有0 V或24V。自然，此时，控制器中至少应具有一个输入和一个输出的最低测试固件。 <br><br> 现在，还需要将控制器的输出信号调整为24 V，并考虑到所有输出继电器的公共线也为负号。 在这里，您至少需要2个晶体管和2个电阻器： <br><br><div class="spoiler">  <b class="spoiler_title">方案</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/v6/ap/um/v6apumv_nl09p0ozminlcjzajp8.jpeg" alt="图片"><br></div></div><br> 实际上，将需要一个更多的电阻器，以及一个与继电器并联的保护二极管，但这并非如此。 首先，我使用了该电路。 但是有一次，我提请注意光耦合器，一开始我就拒绝了。 <br><blockquote> 困扰我们的人会帮助我们 </blockquote><br><div class="spoiler">  <b class="spoiler_title">方案</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/gr/hp/hf/grhphftzdbeeqn4qplwr1pup8z4.jpeg" alt="图片"><br></div></div> 我们通过数据表查看光耦合器的参数：最便宜，最实惠的PC817C输出允许您切换U o：35 V：I o：50 mA。 在我们所在地（在企业中）连接到PLC的那些继电器占用的电流最大为45 mA。 没有库存，但是很合适。 大多数24 V的小型继电器的最大上拉电流为15 ... 20 mA。 最后，您可以购买更昂贵的光耦合器，如果确实需要它，则电流高达80 mA，电压高达60V。我们适合布局和817。 为了避免您从错误中汲取教训，我警告您，要使最大电流通过光耦合器LED，您需要通过7 mA以上的电流。 <br><br> 好了，再次回顾一下指示。 为了显示输出的状态，我们增加了一个与光耦合器的LED串联的LED，在那里仍有3伏以上的电压处于空闲状态。 现在是在烧毁光耦合器之前绘制保护二极管的时候了。 顺便说一句，我找不到根据继电器参数选择保护二极管的方法。 一方面，它必须被脉冲化，高压。 另外，它可以与晶体管平行放置，哪个更好？ 实践证明，在这种情况下，二极管IN4148的功率足够低，但是我想从理论上进行论证。 <br><br><div class="spoiler">  <b class="spoiler_title">方案</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/yb/w6/-y/ybw6-ymcrmjzgumo8m3bcss2gek.jpeg" alt="图片"><br></div></div><br> 计算结果再次在蓝色或白色LED上显示一个220欧姆的电阻，如果您将其设置为红色，则电路中的电流将从3.5 mA增加到9 mA，必须考虑到这一点。 <br><br><h3> 关于编程的一点 </h3><br> 好了，有这么多字母，但我还没打到标题的最底端，也没打到ATtiny13。 为了对控制器进行编程，我使用<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">了FLProg项目</a> ，这是一个可视化编程环境，可以使控制器编程尽可能接近LAD和FBD中的PLC编程。 在这个环境中创建的电路（也是一个项目）被编译成一个Arduino草图，我已经将它从Arduino上传到ATtiny13或AVR系列的另一个控制器。 例如，这样一个简单的方案 <br><br><img src="https://habrastorage.org/webt/wl/i9/1m/wli91mdh38s505j7e5qlz4dpxym.png" alt="图片"><br><br> 编译成如下代码： <br><br><pre><code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> _k1 = <span class="hljs-number"><span class="hljs-number">0</span></span>;
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setup</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">
</span></span>{
pinMode(<span class="hljs-number"><span class="hljs-number">1</span></span>, INPUT);
pinMode(<span class="hljs-number"><span class="hljs-number">2</span></span>, INPUT);
pinMode(<span class="hljs-number"><span class="hljs-number">3</span></span>, OUTPUT);
}
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">
</span></span>{
_k1 = (((((!(digitalRead (<span class="hljs-number"><span class="hljs-number">1</span></span>)))) &amp;&amp;((digitalRead (<span class="hljs-number"><span class="hljs-number">2</span></span>))))) || ((((!(digitalRead (<span class="hljs-number"><span class="hljs-number">1</span></span>)))) &amp;&amp;(_k1))));
digitalWrite (<span class="hljs-number"><span class="hljs-number">3</span></span>, _k1);
}</code></pre><br>
     -   - ,   .     FLProg  ,       «»    .       ,      . , pin     –      ,      .      ATtiny13,    : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">    Attiny13  Attiny13a   Arduino IDE</a> ,  : FLProg     ATtiny13 (     ),   ,     ,  ATmega168.  FLProg     ,    ATtiny13,     .    Arduino IDE     ,    .<br>
<br>
<h3>    </h3><br>
    ?    ATtiny13,      5 ,       .   ,   6 ,   ,  , : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="> ?  RESET</a>.<br>
<br>
,  6,   .   ?<br>
<br>
  :<br>
<br>
<div class="spoiler"><b class="spoiler_title"></b><div class="spoiler_text"><img src="https://habrastorage.org/webt/i-/bo/y8/i-boy8fj5pf1ryijqu4pjdpyjto.jpeg" alt="image"><br>
</div></div><br>
 ,           .      .       ,    .  . <br>
<br>
  ,       50 . ,    50     ,    ,       .     ,   . <br>
<br>
        0   2,8 ,       ,           .  ,      ,    1,1  (   )  2,9 ,   4 .      ,  .<br>
<br>
   .      ,        ,  .      ,       ,    5 ,      --  ,       .          3  (   )  680 .      ,     .         ,   ,           .<br>
<br>
    ?       50 ,    1 ,    50 .  ,  1     ,             .       ,    .<br>
<br>
   ,     .       ,     . <br>
<br>
    6+6=12 -,    2?<br>
<br>
<div class="spoiler"><b class="spoiler_title"> </b><div class="spoiler_text"><img src="https://habrastorage.org/webt/kf/rj/nu/kfrjnufoiyvhmwvetvqlf8x3mx4.jpeg" alt="image"><br>
</div></div><br>
,   ?     ,    )   4 , ,      ,     .          0 ,        ,  2,8 ,       (    ).        24,    0,  ,    2  – 0,93   1,87 .         ,       .   Arduino IDE       ,            ATtiny,   .       ,    .<br>
<br>
,  , 6   10 (!)    ATtiny13     (     ). ,     ,     .         ,     «»  ATtiny. ,         ATmega8,     .     :-)<br>
<br>
            ,      .<br>
<br>
        ,        ,    ,     .   I/O     . ,   (8/6)    ,       ,     «   ».<br>
<br>
 ,       , ,       «»,    <s></s>.  .<br>
<br>
P.S.       ,  : «    ?»<br>
<br>
<div class="spoiler"><b class="spoiler_title"></b><div class="spoiler_text"><img src="https://habrastorage.org/webt/uu/9d/ah/uu9dahstj6whlhfckbfknzfdth4.png" alt="image"><br>
</div></div></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN443978/">https://habr.com/ru/post/zh-CN443978/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN443966/index.html">Google文档-学生们最喜欢的聊天</a></li>
<li><a href="../zh-CN443968/index.html">我们如何购买带有太阳能电池板的房子以及它的来龙去脉</a></li>
<li><a href="../zh-CN443972/index.html">Yandex将使用机器人搜索海盗</a></li>
<li><a href="../zh-CN443974/index.html">内存和跨度pt.1</a></li>
<li><a href="../zh-CN443976/index.html">内存和跨度pt.2</a></li>
<li><a href="../zh-CN443980/index.html">内存和跨度pt.3</a></li>
<li><a href="../zh-CN443984/index.html">基于PCIe 5.0的新标准将“连接” CPU和GPU-关于它的已知信息</a></li>
<li><a href="../zh-CN443986/index.html">像是一只松鼠，或者关于残障环境中的用户研究</a></li>
<li><a href="../zh-CN443988/index.html">微服务架构=分布式计算</a></li>
<li><a href="../zh-CN443990/index.html">ID @ Xbox计划的一部分引入了13个新游戏</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>