<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ด๐ผ ๐ฝ๏ธ ๐ด๐ฝ ุฎูุงุฑุฒููุงุช ูุนุงูุฌุฉ ุงูุณูุณูุฉ ุงูุฐููุฉ ูู ClickHouse ๐๐ป ๐จ๐ฟโ๐ณ ๐ผ๐ป</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ุชูุงุฌู ClickHouse ุจุงุณุชูุฑุงุฑ ููุงู ูุนุงูุฌุฉ ุงูุณูุณูุฉ. ุนูู ุณุจูู ุงููุซุงู ุ ุงูุจุญุซ ุ ูุญุณุงุจ ุฎุตุงุฆุต ุณูุงุณู UTF-8 ุ ุฃู ุดูุก ุฃูุซุฑ ุบุฑุงุจุฉ ุ ุณูุงุก ูุงู ุจุญุซูุง ุญุณุงุณูุง ูุญุงูุฉ ุงูุฃ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ุฎูุงุฑุฒููุงุช ูุนุงูุฌุฉ ุงูุณูุณูุฉ ุงูุฐููุฉ ูู ClickHouse</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yandex/blog/466183/" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl">  ุชูุงุฌู ClickHouse ุจุงุณุชูุฑุงุฑ ููุงู ูุนุงูุฌุฉ ุงูุณูุณูุฉ.  ุนูู ุณุจูู ุงููุซุงู ุ ุงูุจุญุซ ุ ูุญุณุงุจ ุฎุตุงุฆุต ุณูุงุณู UTF-8 ุ ุฃู ุดูุก ุฃูุซุฑ ุบุฑุงุจุฉ ุ ุณูุงุก ูุงู ุจุญุซูุง ุญุณุงุณูุง ูุญุงูุฉ ุงูุฃุญุฑู ุฃู ุจุญุซูุง ุนู ุจูุงูุงุช ูุถุบูุทุฉ. </p><br><p style=";text-align:right;direction:rtl"> ุจุฏุฃ ูู ุดูุก ุจุญูููุฉ ุฃู ูุฏูุฑ ุชุทููุฑ ClickHouse ุ ูููุดุง ููููููุฏูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" class="user_link">o6CuFl2Q ุ</a> ุฌุงุก ุฅูููุง ูู ูููุฉ ุนููู ุงูุญุงุณุจ ูู ุงููุฏุฑุณุฉ ุงูุนููุง ููุงูุชุตุงุฏ ููุฏู ุนุฏุฏูุง ูุจูุฑูุง ูู ุงูููุถูุนุงุช ูุฃูุฑุงู ุงููุตู ุงูุฏุฑุงุณู ูุงูุฏุจูููุงุช.  ุนูุฏูุง ุฑุฃูุช "ุฎูุงุฑุฒููุงุช ูุนุงูุฌุฉ ุงูุณูุณูุฉ ุงูุฐููุฉ ูู ClickHouse" (ุฃูุง ุ ุดุฎุต ููุชู ุจุฎูุงุฑุฒููุงุช ูุชููุนุฉ ุ ุจูุง ูู ุฐูู ุชูู ุงูุชุฌุฑูุจูุฉ) ุ ููุช ุนูู ุงูููุฑ ุจูุถุน ุฎุทุท ูููููุฉ ุงูุญุตูู ุนูู ุฃูุถู ุฏุจููู.  ูุฑุญู ูุงูุชุนุจูุฑ ูููู ูุตููุง ุนูู ุงููุญู ุงูุชุงูู: </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/av/4d/2g/av4d2gj_pplevfljaomiqsnccda.jpeg"></p><br><a name="habracut"></a><br><h2 id="clickhouse" style=";text-align:right;direction:rtl">  ClickHouse </h2><br><p style=";text-align:right;direction:rtl">  ClickHouse ุจุนูุงูุฉ ูุฏุฑูุณุฉ ุชูุธูู ุชุฎุฒูู ุงูุจูุงูุงุช ูู ุงูุฐุงูุฑุฉ - ูู ุงูุฃุนูุฏุฉ.  ูู ููุงูุฉ ูู ุนููุฏ ููุฌุฏ ุญุดูุฉ ูู 15 ุจุงูุช ููุฑุงุกุฉ ุขููุฉ ูู ุณุฌู 16 ุจุงูุช.  ุนูู ุณุจูู ุงููุซุงู ุ ูุฎุฒู ColumnString ุณูุงุณู ููุชููุฉ ุจูููุฉ ุฎุงููุฉ ูุน ุงูุฅุฒุงุญุฉ.  ุฃููุง ูุฑูุญุฉ ููุบุงูุฉ ููุนูู ูุน ูุฐู ุงููุตูููุงุช. </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/w4/go/yp/w4goypgrxiigdp5tpdy3eyao2bu.png"><br></p><br><p style=";text-align:right;direction:rtl">  ููุงู ุฃูุถูุง ColumnFixedString ู ColumnConst ู LowCardinality ุ ููููุง ูู ูุชุญุฏุซ ุนููุง ุจูุซู ูุฐู ุงูุชูุงุตูู ุงูููู.  ุงูููุทุฉ ุงูุฃุณุงุณูุฉ ูู ูุฐู ุงููุฑุญูุฉ ูู ุฃู ุชุตููู ุงููุฑุงุกุฉ ุงูุขููุฉ ููุฐููู ุนูู ูุง ูุฑุงู ุ ูุฃู ูููุน ุงูุจูุงูุงุช ููุนุจ ุฃูุถูุง ุฏูุฑูุง ูู ุงููุนุงูุฌุฉ. </p><br><h2 id="poisk-po-podstrokam" style=";text-align:right;direction:rtl">  ุงูุจุญุซ ุนู ุณูุณูุฉ ูุฑุนูุฉ </h2><br><p style=";text-align:right;direction:rtl">  ุนูู ุงูุฃุฑุฌุญ ุ ุฃูุช ุชุนุฑู ุงูุนุฏูุฏ ูู ุงูุฎูุงุฑุฒููุงุช ุงููุฎุชููุฉ ููุนุซูุฑ ุนูู ุณูุณูุฉ ูุฑุนูุฉ ูู ุณูุณูุฉ.  ุณูุชุญุฏุซ ุนู ุชูู ุงููุณุชุฎุฏูุฉ ูู ClickHouse.  ุฃููุงู ูุนุฑุถ ุชุนุฑูููู: </p><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูููุฉ ูุด - ุงูุฎุท ุงูุฐู ูุชุทูุน ุฅููู ุ  ุนุงุฏุฉ ูุง ูุชู ุงูุฅุดุงุฑุฉ ุฅูู ุงูุทูู ุจูุงุณุทุฉ <em>n</em> . </li><li style=";text-align:right;direction:rtl">  ุฅุจุฑุฉ - ุงูุณูุณูุฉ ุฃู ุงูุชุนุจูุฑ ุงูููุชุธู ุงูุฐู ูุจุญุซ ุนูู ุ  ุณูุชู ุงูุฅุดุงุฑุฉ ุฅูู ุทูู ุจูุงุณุทุฉ <em>ู</em> . </li></ol><br><p style=";text-align:right;direction:rtl">  ุจุนุฏ ุฏุฑุงุณุฉ ุนุฏุฏ ูุจูุฑ ูู ุงูุฎูุงุฑุฒููุงุช ุ ูููููู ุงูููู ุฃู ููุงู ููุนูู (3 ูุญุฏ ุฃูุตู) ูู ุฎูุงุฑุฒููุงุช ุงูุจุญุซ ูู ุงูุณูุณูุฉ ุงููุฑุนูุฉ.  ุงูุฃูู ูู ุฅูุดุงุก ุจููุงุช ูุงุญูุฉ ุจุดูู ุฃู ุจุขุฎุฑ.  ุงูููุน ุงูุซุงูู ูู ุฎูุงุฑุฒููุงุช ุชุณุชูุฏ ุฅูู ููุงุฑูุฉ ุงูุฐุงูุฑุฉ.  ููุงู ุฃูุถูุง ุฎูุงุฑุฒููุฉ Rabin-Karp ุ ุงูุชู ุชุณุชุฎุฏู ุงูุชุฌุฒุฆุฉ ุ ููููุง ูุฑูุฏุฉ ูู ููุนูุง ุชูุงููุง.  ุฃุณุฑุน ุฎูุงุฑุฒููุฉ ุบูุฑ ููุฌูุฏุฉ ุ ูู ูุฐุง ูุชููู ุนูู ุญุฌู ุงูุฃุจุฌุฏูุฉ ูุทูู ุงูุฅุจุฑุฉ ููููุฉ ุงููุด ูุชูุฑุงุฑ ุญุฏูุซูุง. </p><br><p style=";text-align:right;direction:rtl">  ุงูุฑุฃ ุนู ุงูุฎูุงุฑุฒููุงุช ุงููุฎุชููุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุง</a> .  ูููุง ุงูุฎูุงุฑุฒููุงุช ุงูุฃูุซุฑ ุดุนุจูุฉ: </p><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูููุช - ููุฑูุณ - ุจุฑุงุช ุ </li><li style=";text-align:right;direction:rtl">  ุจููุฑ - ููุฑ ุ </li><li style=";text-align:right;direction:rtl">  ุจููุฑ - ููุฑ - Horspool ุ </li><li style=";text-align:right;direction:rtl">  ุฑุงุจูู - ุดุจูุท ุ </li><li style=";text-align:right;direction:rtl">  ุนูู ุงููุฌููู (ูุณุชุฎุฏู ูู glibc ูุณูู "memmem") ุ </li><li style=";text-align:right;direction:rtl">  BNDM. </li></ol><br><p style=";text-align:right;direction:rtl">  ุงููุงุฆูุฉ ุชุทูู.  ููุฏ ุฌุฑุจูุง ูู ClickHouse ุจูู ุดูุก ุจูู ุตุฏู ุ ููู ูู ุงูููุงูุฉ ุงุณุชูุฑูุง ุนูู ุฅุตุฏุงุฑ ุฃูุซุฑ ุงุณุชุซูุงุฆูุฉ. </p><br><h4 id="algoritm-volnickogo" style=";text-align:right;direction:rtl">  ุฎูุงุฑุฒููุฉ Volnitsky </h4><br><p style=";text-align:right;direction:rtl">  ุชู ูุดุฑ ุงูุฎูุงุฑุฒููุฉ ุนูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุฏููุฉ</a> ูุจุฑูุฌ ูููููุฏ Volnitsky ูู ุฃูุงุฎุฑ ุนุงู 2010.  ุฅูู ูุดุจู ุฅูู ุญุฏ ูุง ุฎูุงุฑุฒููุฉ Boyer-Moore-Horspool ุ ููุท ูุณุฎุฉ ูุญุณูุฉ. </p><br><p style=";text-align:right;direction:rtl">  ุฅุฐุง ูุงูุช <em>m &lt;4</em> ุ ูุณูุชู ุงุณุชุฎุฏุงู ุฎูุงุฑุฒููุฉ ุงูุจุญุซ ุงูููุงุณูุฉ.  ุงุญูุธ ูู ุฅุจุฑุฉ bigrams (2 ุจุงูุช ูุชุชุงููุฉ) ูู ุงูููุงูุฉ ุฅูู ุทุงููุฉ ุชุฌุฒุฆุฉ ูุน ุนูููุฉ ููุชูุญุฉ ููุญุฌู <em>| Sigma |</em>  <em><sup>2</sup></em> ุนูุตุฑุง (ูู ุงูููุงุฑุณุฉ ุ ูุฐู ูู 2 <sup>16</sup> ุนูุตุฑุง) ุ ุญูุซ ุชููู ุฅุฒุงุญุฉ ูุฐุง bigram ูู ุงูููู ุ ูุณุชููู bigram ููุณูุง ูู ุงูุชุฌุฒุฆุฉ ูุงูููุฑุณ ูู ููุณ ุงูููุช.  ุณูููู ุงููููู ุงูุฃููู ูู ุงูููุถุน <em>ู -2</em> ูู ุจุฏุงูุฉ ูููุฉ ุงููุด.  ูุชุจุน ูููุฉ ูุด ุจุฎุทูุฉ <em>m - 1</em> ุ ูููุธุฑ ุฅูู bigram ุงูุชุงูู ูู ูุฐุง ุงููููู ูู ูููุฉ ูุด ูููุธุฑ ูู ุฌููุน ุงูููู ูู bigram ูู ุฌุฏูู ุงูุชุฌุฒุฆุฉ.  ุซู ุณููุงุฑู ูุทุนุชูู ูู ุงูุฐุงูุฑุฉ ูุน ุฎูุงุฑุฒููุฉ ุงูููุงุฑูุฉ ุงููุนุชุงุฏุฉ.  ุณูุชู ูุนุงูุฌุฉ ุงูุฐูู ุงููุชุจูู ุจูุงุณุทุฉ ููุณ ุงูุฎูุงุฑุฒููุฉ. </p><br><p style=";text-align:right;direction:rtl">  <em>ูุชู</em> ุงุฎุชูุงุฑ ุงูุฎุทูุฉ <em>m - 1</em> ุจุทุฑููุฉ ุฃูู ุฅุฐุง ูุงู ููุงู ุฅุจุฑุฉ ูู ูููุฉ ูุด ุ ูุณููุธุฑ ุจุงูุชุฃููุฏ ูู bigram ูู ูุฐุง ุงูุฅุฏุฎุงู - ูุจุงูุชุงูู ุงูุชุฃูุฏ ูู ุฃููุง ูุนูุฏ ูููู ุงูุฅุฏุฎุงู ูู ูููุฉ ูุด.  ุงูุญุฏุซ ุงูุฃูู ูุถููู ูู ุฎูุงู ุญูููุฉ ุฃููุง ูุถูู ููุงุฑุณ ูู ุงูููุงูุฉ ุฅูู ุฌุฏูู ุงูุชุฌุฒุฆุฉ ุจูุงุณุทุฉ bigram.  ูุฐุง ูุนูู ุฃูู ุนูุฏูุง ููุชูู ูู ุงููุณุงุฑ ุฅูู ุงููููู ุ ุณููุธุฑ ุฃููุงู ูู ุงูุญููุงุช ุงููุจูุฑุฉ ูู ููุงูุฉ ุงูุณุทุฑ (ุฑุจูุง ุชููุฑ ูุจุฏุฆููุง ูู ุฐูู ูู ุงูููุงู ุงูุฃูู) ุ ุซู ููุชุฑุจ ูู ุงูุจุฏุงูุฉ. </p><br><p style=";text-align:right;direction:rtl"> ุงููุธุฑ ูู ูุซุงู.  ูุงุณูุญูุง ูููุฉ ูุด ุณูุณูุฉ ูููู <code>abacabaac</code> ูุฅุจุฑุฉ ุชุณุงูู <code>aaca</code> .  ุณูููู ุฌุฏูู ุงูุชุฌุฒุฆุฉ <code>{aa : 0, ac : 1, ca : 2}</code> . </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">0 1 2 3 4 5 6 7 8 9 abacabaaca ^ -   </code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุฑู bigram <code>ac</code> .  ูู ุงูุฅุจุฑุฉ ุ ูุญู ุจุฏูู ูู ุงููุณุงูุงุฉ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">0 1 2 3 4 5 6 7 8 9 abacabaaca aaca</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูู ุชุชุทุงุจู.  ุจุนุฏ <code>ac</code> ูุง ุชูุฌุฏ ุฅุฏุฎุงูุงุช ูู ุฌุฏูู ุงูุชุฌุฒุฆุฉ ุ ูุฎุทู ุงูุฎุทูุฉ 3: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">0 1 2 3 4 5 6 7 8 9 abacabaaca ^ -   </code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุง ุชูุฌุฏ bigrams <code>ba</code> ูู ุฌุฏูู ุงูุชุฌุฒุฆุฉ ุ ุชุงุจุน: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">0 1 2 3 4 5 6 7 8 9 abacabaaca ^ -   </code> </pre> <br><p style=";text-align:right;direction:rtl">  ููุงู bigram <code>ca</code> ูู ุงูุฅุจุฑุฉ ุ ููุญู ููุธุฑ ุฅูู ุงูุฅุฒุงุญุฉ ูุงูุนุซูุฑ ุนูู ุงูุฅุฏุฎุงู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">0 1 2 3 4 5 6 7 8 9 abacabaaca aaca</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุงูุฎูุงุฑุฒููุฉ ูุฏููุง ุงูุนุฏูุฏ ูู ุงููุฒุงูุง.  ุฃููุงู ุ ูุง ุชุญุชุงุฌ ุฅูู ุชุฎุตูุต ุฐุงูุฑุฉ ุนูู ุงููููุฉ ุ ู 64 ูููู ุจุงูุช ุนูู ุงูููุฏุณ ููุณุช ุดูุฆูุง ูุชุฌุงูุฒูุง ุงูุขู.  ุซุงููุง ุ 2 <sup>16</sup> ูู ุฑูู ููุชุงุฒ ูุงุชุฎุงุฐ modulo ูููุนุงูุฌ.  ูุฐู ูุฌุฑุฏ ุชุนูููุงุช movzwl (ุฃู ุ ููุง ููุชุฉ ุ "movsvl") ูุงูุนุงุฆูุฉ. </p><br><p style=";text-align:right;direction:rtl">  ูู ุงููุชูุณุท โโุ ุฃุซุจุชุช ูุฐู ุงูุฎูุงุฑุฒููุฉ ุฃููุง ุงูุฃูุถู.  ุฃุฎุฐูุง ุงูุจูุงูุงุช ูู Yandex.Metrica ุ ุทูุจุงุช ุญููููุฉ ุชูุฑูุจุง.  ุณุฑุนุฉ ุชูุงุฑ ูุงุญุฏุฉ ุ ุฃูุซุฑ ุฃูุถู ุ KMP: ุฎูุงุฑุฒููุฉ Knut - Morris - Pratt ุ BM: Boyer - Moore ุ BMH: Boyer - Moore - Horspool. </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/wp/vn/v2/wpvnv2eqrbhhvqvryaqmdjc9igy.png"><br></p><br><p style=";text-align:right;direction:rtl">  ุญุชู ูุง ุชููู ุจุฏูู ุฃุณุงุณ ุ ูููู ุฃู ุชุนูู ุงูุฎูุงุฑุฒููุฉ ููุชูุง ุชุฑุจูุนููุง: </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/oi/3x/dh/oi3xdhxe7awdlsqxxui2lyqvxjc.png"><br></p><br><p style=";text-align:right;direction:rtl">  ูุชู ุงุณุชุฎุฏุงูู ูู ูุธููุฉ <code>position(Column, ConstNeedle)</code> ุ ููุนูู ุฃูุถูุง <code>position(Column, ConstNeedle)</code> ูุนูููุงุช ุจุญุซ ุงูุชุนุจูุฑ <code>position(Column, ConstNeedle)</code> . </p><br><h2 id="poisk-po-regulyarnym-vyrazheniyam" style=";text-align:right;direction:rtl">  ุจุญุซ ุงูุชุนุจูุฑ ุงูุนุงุฏู </h2><br><p style=";text-align:right;direction:rtl">  ุณูุฎุจุฑู ููู ุชููู ClickHouse ุจุชุญุณูู ุนูููุงุช ุงูุจุญุซ ุงูุนุงุฏูุฉ ุนู ุงูุชุนุจูุฑ.  ุชุญุชูู ุงูุนุฏูุฏ ูู ุงูุชุนุจูุฑุงุช ุงูุนุงุฏูุฉ ุนูู ุณูุณูุฉ ูุฑุนูุฉ ูู ุงูุฏุงุฎู ุ ูุงูุชู ูุฌุจ ุฃู ุชููู ุฏุงุฎู ูููุฉ ูุด.  ุญุชู ูุง ูุจูู ุฌูุงุฒูุง ูุญุฏุฏูุง ููุฏููุฉ ููุญุตู ุถุฏู ุ ุณูููู ุจุนุฒู ูุซู ูุฐู ุงูุฏุนุงูุงุช. </p><br><p style=";text-align:right;direction:rtl">  ููููุงู ุจุฐูู ุจุณูุท ููุบุงูุฉ: ุฃู ุฃููุงุณ ูุชุญ ุชุฒูุฏ ูู ูุณุชูู ุงูุชุนุดูุด ุ ุฃู ุฃููุงุณ ุฅุบูุงู ุชูุฎูุถ ุ  ููุงู ุฃูุถูุง ุฃุญุฑู ุฎุงุตุฉ ุจุงูุชุนุจูุฑุงุช ุงูุนุงุฏูุฉ (ูุซู "." ุ "*" ุ "ุ" ุ "\ w" ุ ุฅูุฎ).  ูุญุชุงุฌ ุฅูู ุงูุญุตูู ุนูู ุฌููุน ุงูุนูุงุตุฑ ุงููุฑุนูุฉ ูู ุงููุณุชูู 0. ููุฑ ูู ูุซุงู: <br><img src="https://habrastorage.org/webt/2x/uk/uo/2xukuompabpmnrjpk-muwg1yydi.png"><br></p><br><p style=";text-align:right;direction:rtl">  ูุญู ููุณููุง ุฅูู ุชูู ุงูุฃุณุณ ุงูุชู ูุฌุจ ุฃู ุชููู ูู ูููุฉ ูุด ูู ุงูุชุนุจูุฑ ุงูุนุงุฏู ุ ูุจุนุฏ ุฐูู ูููู ุจุชุญุฏูุฏ ุงูุญุฏ ุงูุฃูุตู ููุทูู ุ ุงุจุญุซ ุนู ุงููุฑุดุญูู ุนูููุง ุซู ุชุญูู ูุน ูุญุฑู ุงูุชุนุจูุฑ ุงูุนุงุฏู ุงููุนุชุงุฏ RE2.  ูู ุงูุตูุฑุฉ ุฃุนูุงู ุ ููุฌุฏ ุชุนุจูุฑ ููุชุธู ุ ุชุชู ูุนุงูุฌุชู ุจูุงุณุทุฉ ูุญุฑู RE2 ุงููุนุชุงุฏ ุจุณุฑุนุฉ 736 ููุฌุงุจุงูุช / ุซุงููุฉ ุ ูุชูููู Hyperscan (ุญูุงูู ุฐูู ูุงุญููุง ููููุงู) ูู 1.6 ุฌูุฌุงุจุงูุช / ุซุงููุฉ ุ ููุฏูุฑ 1.69 ุฌูุฌุงุจุงูุช / ุซุงููุฉ ููู ููุงุฉ ูุน ุฅูุบุงุก ุงูุถุบุท LZ4.  ุจุดูู ุนุงู ุ ูููู ูุฐุง ุงูุชุญุณูู ุนูู ุงูุณุทุญ ููุณุฑุน ุจุดูู ูุจูุฑ ูู ุงูุจุญุซ ุนู ุงูุชุนุจูุฑุงุช ุงูุนุงุฏูุฉ ุ ูููู ูู ูุซูุฑ ูู ุงูุฃุญูุงู ูุง ูุชู ุชูููุฐู ูู ุงูุฃุฏูุงุช ุ ููู ูุง ููุงุฌุฆูู ุฅูู ุญุฏ ูุจูุฑ. </p><br><p style=";text-align:right;direction:rtl">  ุชู ุชุญุณูู ุงููููุฉ ุงูุฑุฆูุณูุฉ LIKE ุฃูุถูุง ุจุงุณุชุฎุฏุงู ูุฐู ุงูุฎูุงุฑุฒููุฉ ุ ููุท ุจุนุฏ LIKE ูููู ุงูุชุนุจูุฑ ุงูุนุงุฏู ุงููุจุณุท ููุบุงูุฉ ูู ุฎูุงู ูชูชูชูชูช (ุณูุณูุฉ ูุฑุนูุฉ ุชุนุณููุฉ) ู <code>_</code> (ุญุฑู ุชุนุณูู). </p><br><p style=";text-align:right;direction:rtl">  ูุณูุก ุงูุญุธ ุ ููุณุช ูู ุงูุชุนุจูุฑุงุช ุงูุนุงุฏูุฉ ุชุฎุถุน ููุซู ูุฐู ุงูุชุญุณููุงุช ุ ุนูู ุณุจูู ุงููุซุงู ุ ูู <code>yandex|google</code> ูู ุงููุณุชุญูู ุตุฑุงุญุฉ ุงุณุชุฎุฑุงุฌ ุณูุงุณู ูุฑุนูุฉ ูุฌุจ ุฃู ุชุญุฏุซ ูู ูููุฉ ูุด.  ูุฐูู ุ ุชูุตููุง ุฅูู ุญู ูุฎุชูู ุชูุงูุง. </p><br><h2 id="poisk-po-mnogim-podstrokam" style=";text-align:right;direction:rtl">  ุงูุจุญุซ ุนู ุงูุนุฏูุฏ ูู ุงูุฏุนุงูุงุช </h2><br><p style=";text-align:right;direction:rtl">  ุงููุดููุฉ ูู ุฃู ููุงู ุงููุซูุฑ ูู ุงูุฅุจุฑ ุ ูุฃุฑูุฏ ุฃู ุฃููู ูุง ุฅุฐุง ูุงู ูุฏ ุชู ุชุถููู ูุงุญุฏุฉ ูููุง ุนูู ุงูุฃูู ูู ูููุฉ ูุด.  ููุงู ุทุฑู ููุงุณูููุฉ ุชูุงููุง ููุซู ูุฐุง ุงูุจุญุซ ุ ุนูู ุณุจูู ุงููุซุงู ุ ุฎูุงุฑุฒููุฉ Aho-Korasik.  ูููู ูู ููู ุณุฑูุนูุง ุฌุฏูุง ููููุชูุง.  ุณูุชุญุฏุซ ุนู ูุฐุง ุจุนุฏ ูููู. </p><br><p style=";text-align:right;direction:rtl"><del>  ููุด </del>  ูุญุจ ClickHouse ุงูุญููู ุบูุฑ ุงูููุงุณูุฉ ุ ูุฐูู ูุฑุฑูุง ุชุฌุฑุจุฉ ุดูุก ูุฎุชูู ุ ูุฑุจูุง ุ ุฅูุดุงุก ุฎูุงุฑุฒููุฉ ุจุญุซ ุฌุฏูุฏุฉ ุจุฃููุณูุง.  ููุนููุง. </p><br><p style=";text-align:right;direction:rtl">  ูุธุฑูุง ุฅูู ุฎูุงุฑุฒููุฉ Volnitsky ููููุง ุจุชุนุฏูููุง ุจุญูุซ ุจุฏุฃุช ูู ุงูุจุญุซ ุนู ุงูุนุฏูุฏ ูู ุงูููุงุฏ ุงููุฑุนูุฉ ูู ููุช ูุงุญุฏ.  ููููุงู ุจุฐูู ุ ุชุญุชุงุฌ ููุท ุฅูู ุฅุถุงูุฉ bigrams ูู ุฌููุน ุงูุตููู ูุชุฎุฒูู ููุฑุณ ุงูุตู ูู ุฌุฏูู ุงูุชุฌุฒุฆุฉ.  ุณูุชู ุงุฎุชูุงุฑ ุงูุฎุทูุฉ ูู ุนูู ุงูุฃูู ูู ุฃุทูุงู ุงูุฅุจุฑุฉ ูุทุฑูุญูุง ูููุง 1 ูุถูุงู ูุฑุฉ ุฃุฎุฑู ุนูู ุงูุนูุงุฑ ุฃูู ูู ุญุงูุฉ ุญุฏูุซ ุฐูู ุ ูุณูู ูุดุงูุฏ ุญุฌูู ุงููุจูุฑ.  ุณูููู ุฌุฏูู ุงูุชุฌุฒุฆุฉ ุฅูู 128 ูููู ุจุงูุช (ุชุชู ูุนุงูุฌุฉ ุงูุฃุณุทุฑ ุงูุฃุทูู ูู 255 ุจูุงุณุทุฉ ุงูุฎูุงุฑุฒููุฉ ุงูููุงุณูุฉ ุ ููู ูุฏุฑุณ ุฃูุซุฑ ูู 256 ุฅุจุฑุฉ).  ุฃูุง ูุณูู ุฌุฏูุง ุ ูุฐุง ุฅููู ูุซุงู ูู ุงูุนุฑุถ ุงูุชูุฏููู (ุงูุฑุฃ ูู ุงููุณุงุฑ ุฅูู ุงููููู ูู ุฃุนูู ุฅูู ุฃุณูู): </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/ak/no/hq/aknohqtvebtx-c_ijmza8af0emm.png"><br></p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/x6/cm/z4/x6cmz4d3i5qy5i3tfj1ngbssewc.png"><br></p><br><p style=";text-align:right;direction:rtl">  ุจุฏุฃูุง ูู ุงููุธุฑ ูู ููููุฉ ุชุตุฑู ูุฐู ุงูุฎูุงุฑุฒููุฉ ููุงุฑูุฉู ุจุงูุขุฎุฑูู (ูุชู ุฃุฎุฐ ุงูุตููู ูู ุงูุจูุงูุงุช ุงูุญููููุฉ).  ูุจุงููุณุจุฉ ูุนุฏุฏ ุตุบูุฑ ูู ุงูุฎุทูุท ุ ููุนู ูู ุดูุก (ุชุชู ุงูุฅุดุงุฑุฉ ุฅูู ุงูุณุฑุนุฉ ุฌูุจูุง ุฅูู ุฌูุจ ูุน ุงูุชูุฑูุบ - ุญูุงูู 2.5 ุฌูุฌุงุจุงูุช / ุซุงููุฉ). </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/nl/t_/pt/nlt_pt077xl7n-cya0qb6eh67re.png"><br></p><br><p style=";text-align:right;direction:rtl">  ุซู ุฃุตุจุญุช ูุซูุฑุฉ ููุงูุชูุงู.  ุนูู ุณุจูู ุงููุซุงู ุ ูุน ูุฌูุฏ ุนุฏุฏ ูุจูุฑ ูู ุงูุดุฑูุงุช ุงููุจูุฑุฉ ุงูููุงุซูุฉ ุ ูุฎุณุฑ ุจุนุถ ุงูููุงูุณูู.  ุฅูู ุฃูุฑ ููููู - ูุจุฏุฃ ูู ููุงุฑูุฉ ุงูุนุฏูุฏ ูู ุฃุฌุฒุงุก ุงูุฐุงูุฑุฉ ูุงูุชุญูู. </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/n8/wm/uz/n8wmuzm_vcepo4olqcse1e7gwqy.png"><br></p><br><p style=";text-align:right;direction:rtl">  ูุง ููููู ุชุณุฑูุน ุงููุซูุฑ ุฅุฐุง ูุงู ุงูุญุฏ ุงูุฃุฏูู ูุทูู ุงูุฅุจุฑุฉ ูุจูุฑูุง ุจูุง ูููู.  ูู ุงููุงุถุญ ุ ูุฏููุง ุงููุฒูุฏ ูู ุงููุฑุต ูุชุฎุทู ูุทุน ูุงููุฉ ูู ูููุฉ ูุด ุฏูู ุฏูุน ุฃู ุดูุก ููุงุจู ุฐูู. </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/zg/z1/ej/zgz1ejecxev4-j-oz3m6egxydt0.png"><br></p><br><p style=";text-align:right;direction:rtl">  ุชุจุฏุฃ ููุทุฉ ุงูุชุญูู ูู ููุงู ูุง ุนูู ุงูุฎุทูุท 13-15.  ุญูุงูู 97ูช ูู ุงูุทูุจุงุช ุงูุชู ุฑุฃูุชูุง ุนูู ุงููุฌููุนุฉ ูุงูุช ุฃูู ูู 15 ุตููุง: </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/x-/6j/od/x-6jodqalhriam_byxewdzoxzhs.png"><br></p><br><p style=";text-align:right;direction:rtl">  ุญุณููุง ุ ุตูุฑุฉ ูุฎููุฉ ุฌุฏูุง - 41 ุณุทุฑูุง ุ ุงูุนุฏูุฏ ูู ุงูุดุฎุตูุงุช ุงููุจูุฑุฉ ุงููุชูุฑุฑุฉ: </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/yx/ez/da/yxezdam_2poycdgttd9nnsyjjqy.png"><br></p><br><p style=";text-align:right;direction:rtl">  ูุชูุฌุฉ ูุฐูู ุ ูู ClickHouse (19.5) ูููุง ุจุชูููุฐ ุงููุธุงุฆู ุงูุชุงููุฉ ูู ุฎูุงู ูุฐู ุงูุฎูุงุฑุฒููุฉ: </p><br><p style=";text-align:right;direction:rtl">  - <code>multiSearchAny(h, [n_1, ..., n_k])</code> - 1 ุ ุฅุฐุง ูุงู ูุงุญุฏ ุนูู ุงูุฃูู ูู ุงูุฅุจุฑ ูู ูููุฉ ูุด. <br>  - <code>multiSearchFirstPosition(h, [n_1, ..., n_k])</code> - ุงูููุถุน <code>multiSearchFirstPosition(h, [n_1, ..., n_k])</code> ููุฏุฎูู ูู ูููุฉ ูุด (ูู ูุงุญุฏ) ุฃู 0 ุฅุฐุง ูู ูุชู ุงูุนุซูุฑ ุนููู. <br>  - <code>multiSearchFirstIndex(h, [n_1, ..., n_k])</code> - ูุคุดุฑ ุงูุฅุจุฑุฉ ูู ุฃูุตู ุงููุณุงุฑ ุ ูุงูุฐู ุชู ุงูุนุซูุฑ ุนููู ูู ูููุฉ ูุด.  0 ุฅุฐุง ูู ูุชู ุงูุนุซูุฑ ุนูููุง. <br>  - <code>multiSearchAllPositions(h, [n_1, ..., n_k])</code> - ุฌููุน ุงูููุงุถุน ุงูุฃููู ูุฌููุน ุงูุฅุจุฑ ุ ุชููู ุจุฅุฑุฌุงุน ุตููู. </p><br><p style=";text-align:right;direction:rtl">  ุงูููุงุญู ูู -UTF8 (ูุญู ูุง ูุทุจูุน) ุ -CaseInsensitive (ูุถูู 4 bigrams ูุน ุญุงูุฉ ูุฎุชููุฉ) ุ -CaseInsensitiveUTF8 (ููุงู ุดุฑุท ุฃู ุงูุฃุญุฑู ุงููุจูุฑุฉ ูุงูุตุบูุฑุฉ ูุฌุจ ุฃู ูููู ููุณ ุนุฏุฏ ูุญุฏุงุช ุงูุจุงูุช).  ุงูุธุฑ ุงูุชูููุฐ <a href="">ููุง</a> . </p><br><p style=";text-align:right;direction:rtl">  ุจุนุฏ ุฐูู ุ ุชุณุงุกููุง ุนูุง ุฅุฐุง ูุงู ุจุฅููุงููุง ูุนู ุดูุก ููุงุซู ูุน ุงูุนุฏูุฏ ูู ุงูุชุนุจูุฑุงุช ุงูุนุงุฏูุฉ.  ููุฌุฏูุง ุญูุงู ูุฏ ุฃูุณุฏ ุจุงููุนู ูู ุงููุนุงููุฑ. </p><br><h2 id="poisk-po-mnogim-regulyarnym-vyrazheniyam" style=";text-align:right;direction:rtl">  ุงูุจุญุซ ุนู ุทุฑูู ุงูุนุฏูุฏ ูู ุงูุชุนุจูุฑุงุช ุงูุนุงุฏูุฉ </h2><br><p style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Hyperscan</a> ูู ููุชุจุฉ ูู Intel ุชููู ุจุงูุจุญุซ ุงูููุฑู ุนู ุงูุนุฏูุฏ ูู ุงูุชุนุจูุฑุงุช ุงูุนุงุฏูุฉ.  ูุณุชุฎุฏู ุงูุงุณุชุฏูุงู ูุนุฒู ุงููููุงุช ุงููุฑุนูุฉ ูู ุงูุชุนุจูุฑุงุช ุงูุนุงุฏูุฉ ุงูุชู ูุชุจูุง ุนููุง ุ ูุงููุซูุฑ ูู ุจุทุงูุงุช SIM ููุจุญุซ ุนู ุบููุดููู ุงูุขูู (ูุจุฏู ุฃู ุงูุฎูุงุฑุฒููุฉ ุชุณูู ุชูุฏู). </p><br><p style=";text-align:right;direction:rtl">  ุจุดูู ุนุงู ุ ูู ุดูุก ูู ุฃูุถู ุชูุงููุฏ ุงูุญุตูู ุนูู ุฃูุตู ุงุณุชูุงุฏุฉ ูู ุงูุจุญุซ ุนู ุงูุชุนุจูุฑุงุช ุงูุนุงุฏูุฉ.  ุงูููุชุจุฉ ุญูุง ูุง ุฃุนูู ูู ูุธุงุฆููุง. </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/of/xl/dd/ofxlddsnj92zghvsducv9e9jktu.png"><br></p><br><p style=";text-align:right;direction:rtl">  ูุญุณู ุงูุญุธ ุ ูู ุงูุดูุฑ ุงูุฐู ุฃูุถูุชู ูู ClickHouse ุ ุชูููุช ูู ุชุฌุงูุฒ ุงูุชุทููุฑ ููุฏุฉ 12 ุนุงููุง ุนูู ูุฆุฉ ูู ุงูุงุณุชุนูุงูุงุช ุงููุงุฆูุฉ ูุฃูุง ูุณุฑูุฑ ุฌุฏูุง ุจูุฐุง. </p><br><p style=";text-align:right;direction:rtl">  ูู Yandex ุ ุชุณุชุฎุฏู ููุชุจุฉ Hyperscan ุฃูุถูุง ูู ููุงูุญุฉ ุงูุจุฑูุฏ ุงูุนุดูุงุฆู.  ุงุณุชูุงุฏุง ุฅูู ุงููุฑุงุฌุนุงุช ุ ุชุนุงูุฌ ุจูุฏูุก ุงูุขูุงู ูู ุงูุชุนุจูุฑุงุช ุงูุนุงุฏูุฉ ูุชุจุญุซ ุจุณุฑุนุฉ ุนููุง. </p><br><p style=";text-align:right;direction:rtl">  ุงูููุชุจุฉ ูุฏููุง ุงูุนุฏูุฏ ูู ุงูุนููุจ.  ุงูุฃูู ูู ููุฏุงุฑ ุงูุฐุงูุฑุฉ ุบูุฑ ุงููุณุชูููุฉ ุงููุณุชูููุฉ ูููุฒุฉ ุบุฑูุจุฉ ูุฌุจ ุฃู ูููู ูููุฉ ูุด ุฃูู ูู <sup>32</sup> ุจุงูุช.  ุงูุซุงูู - ูุง ููููู ุฅุฑุฌุงุน ุงูููุงุถุน ุงูุฃููู ูุฌุงููุง ุ ููุคุดุฑุงุช ุงูุฅุจุฑุฉ ุงูููุฌูุฏุฉ ูู ุฃูุตู ุงููุณุงุฑ ุ ููุง ุฅูู ุฐูู ุ ูุงูุซุงูุซ ูุงูุต - ููุงู ุจุนุถ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุฃุฎุทุงุก</a> ูู ุงูููู ุงูุฃุฒุฑู.  ูุฐูู ุ ูู ClickHouse ุ ูููุง ุจุชูููุฐ ุงููุธุงุฆู ุงูุชุงููุฉ ุจุงุณุชุฎุฏุงู Hyperscan: </p><br><p style=";text-align:right;direction:rtl">  - <code>multiMatchAny(h, [n_1, ..., n_k])</code> - 1 ุ ุฅุฐุง ุชู ุงูุชูุตู ุฅูู ูููุฉ ูู ุงูุฅุจุฑ ุนูู ุงูุฃูู. <br>  - <code>multiMatchAnyIndex(h, [n_1, ..., n_k])</code> - ุฃู ููุฑุณ ูู ุงูุฅุจุฑุฉ <code>multiMatchAnyIndex(h, [n_1, ..., n_k])</code> ูููุฉ ูุด. </p><br><p style=";text-align:right;direction:rtl">  ูุญู ููุชููู ุ ูููู ููู ููููู ุงูุจุญุซ ููุณ ุจุงูุถุจุท ุ ูููู ุชูุฑูุจูุงุ  ูุฌุงุกุช ูุน ุงูุนุฏูุฏ ูู ุงูุญููู. </p><br><h2 id="priblizhyonnyy-poisk" style=";text-align:right;direction:rtl">  ุงูุจุญุซ ุงูุชูุฑูุจู </h2><br><p style=";text-align:right;direction:rtl">  ุงููุนูุงุฑ ูู ุงูุจุญุซ ุงูุชูุฑูุจู ูู ุงููุณุงูุฉ Levenshtein - ุงูุญุฏ ุงูุฃุฏูู ูุนุฏุฏ ุงูุฃุญุฑู ุงูุชู ูููู ุงุณุชุจุฏุงููุง ูุฅุถุงูุชูุง ูุฅุฒุงูุชูุง ููุญุตูู ุนูู ุณูุณูุฉ b ุจุทูู n ูู ุณูุณูุฉ a ูู ุงูุทูู m.  ูุณูุก ุงูุญุธ ุ ุชุนูู ุฎูุงุฑุฒููุฉ ุงูุจุฑูุฌุฉ ุงูุฏููุงููููุฉ ุงูุณุงุฐุฌุฉ ูู <em>O (mn)</em> ุ  ุฃูุถู ุงูุนููู ูู SHAD ูููู ุฃู ุชูุนู ุฐูู ูู <em>O (ููููู / ุณุฌู ูุงูุณ (ู ุ ู))</em> ุ  ูู ุงูุณูู ุงูุชูููุฑ ูู <em>O ((n + m) โ alpha)</em> ุ ุญูุซ <em>alpha</em> ูู ุงูุญู ุ  ูููู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุนูู</a> ุงูููุงู ุจุฐูู ูู ุฃุฌู <em>O ((alpha - | n - m |) ุฏูููุฉ (m ุ n ุ alpha) + m + n)</em> (ุงูุฎูุงุฑุฒููุฉ ุจุณูุทุฉ ุ ุงูุฑุฃ ุนูู ุงูุฃูู ูู ShAD) ุฃู ุ ุฅุฐุง ูุงูุช ุฃูุถุญ ููููุงู ุ ูู <em>O (alpha ^ 2 + m + ู)</em> .  ูุง ูุฒุงู ููุงู ูุงูุต: ูู ุงููุณุชุญูู ุนูู ุงูุฃุฑุฌุญ ุงูุชุฎูุต ูู ุงูููุช ุงูุชุฑุจูุนู ูู ุฃุณูุฃ ุงูุญุงูุงุช ูุชุนุฏุฏ ุงูุญุฏูุฏ - ูุชุจ ุจูุชุฑ ุฅูุฏูู ููุงูุฉ ูููุฉ ููุบุงูุฉ ุญูู ูุฐุง ุงูููุถูุน. </p><br><p style=";text-align:right;direction:rtl">  ููุงู ุชูุฑูู: ุชุฎูู ุฃูู ูุงุณุชุจุฏุงู ุดุฎุตูุฉ ูู ูุณุงูุฉ Levenshtein ูุฅูู ุชุฏูุน ุบุฑุงูุฉ ูุง ุงุซููู ุ ูููู ุงุซููู ุ  ุซู ุงูุฎุฑูุฌ ุจุฎูุงุฑุฒููุฉ ูู <em>O ((n + m) log (n + m))</em> . </p><br><p style=";text-align:right;direction:rtl">  ูุง ุฒุงู ูุง ูุนูู ุ ุทููู ุฌุฏูุง ููููู.  ูููู ุจูุณุงุนุฏุฉ ูุฐู ุงููุณุงูุฉ ุ ูููุง ุจุงููุดู ุนู ุงูุฃุฎุทุงุก ุงููุทุจุนูุฉ ูู ุงูุงุณุชุนูุงูุงุช. </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/ok/b8/gg/okb8ggb8vwkzft3ggzdipy29pja.png"><br></p><br><p style=";text-align:right;direction:rtl">  ุจุงูุฅุถุงูุฉ ุฅูู ุงููุณุงูุฉ Levenshtein ุ ููุงู ูุณุงูุฉ Hamming.  ูุนู ุ ุฃูุถูุง ุ ูู ุดูุก ุณูุก ุฌุฏูุง ุ ูููู ุฃูุถู ููููุงู ูู ูุณุงูุฉ ูููููุดุชุงูู.  ูุง ุชุฃุฎุฐ ูู ุงูุญุณุจุงู ุฅุฒุงูุฉ ุงูุญุฑูู ุ ูููููุง ุชุฃุฎุฐ ุจุนูู ุงูุงุนุชุจุงุฑ ุนุฏุฏ ุงูุฃุญุฑู ุงูุชู ุชุฎุชูู ูููุง ููุท ูุฎุทูู.  ูุฐูู ุ ุฅุฐุง ุงุณุชุฎุฏููุง ุงููุณุงูุฉ ูุณูุงุณู ุงูุทูู m &lt;n ุ ุนูุฏุฆุฐู ููุท ูู ุงูุจุญุซ ุนู ุฃูุฑุจ ุณูุงุณู ูุฑุนูุฉ. </p><br><p style=";text-align:right;direction:rtl">  ููููุฉ ุญุณุงุจ ูุซู ูุฐุง ุงูุตููู ูู ุงูุชูุงูุถุงุช (ุตููู d ูู ุนูุงุตุฑ n - m + 1 ุ ุญูุซ d [i] ูู ุนุฏุฏ ุงูุฃุญุฑู ุงููุฎุชููุฉ ูู i-th ูู ุจุฏุงูุฉ ุงูุชุฑุงูุจ <em>) ูุณุฌู O (| Sigma | (n + m) (n + m) )</em> ุ  ุฃููุง ุ ูู <em>| ุณูุบูุง |</em>  ุฃููุนุฉ ุจุช ุชุดูุฑ ุฅูู ูุง ุฅุฐุง ูุงู ูุฐุง ุงูุฑูุฒ ูุณุงููุงู ููุฑูุฒ ุงููุนุชุจุฑ.  ุจุนุฏ ุฐูู ุ ูุญุณุจ ุงูุฅุฌุงุจุฉ ููู ูู ุฃููุนุฉ Sigma ููุถูู - ูุญุตู ุนูู ุงูุฅุฌุงุจุฉ ุงูุฃุตููุฉ. </p><br><p style=";text-align:right;direction:rtl">  ุงููุธุฑ ูู ูุซุงู.  <code>abba</code> ุ ุณูุณูุฉ ูุฑุนูุฉ <code>ba</code> ุ ุงูุฃุจุฌุฏูุฉ ุงูุซูุงุฆูุฉ.  ูุญุตู ุนูู ุฃููุนุฉ <code>1001, 01</code> ู <code>0110, 10</code> . </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">   a 1001 01 - 0  01 - 0  01 - 1 </code> </pre> <br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">   b 0110 10 - 0  10 - 1  10 - 1 </code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุญุตู ุนูู ุงููุตูููุฉ [0 ุ 1 ุ 2] - ูุฐู ูู ุงูุฅุฌุงุจุฉ ุงูุตุญูุญุฉ ุชูุฑูุจูุง.  ููู ูุงุญุธ ุฃูู ุจุงููุณุจุฉ ููู ุญุฑู ุ ูุฅู ุนุฏุฏ ุงูุชุทุงุจูุงุช ูู ูุฌุฑุฏ ูุชุงุฌ ุงูุนุฏุฏูุฉ ูุฅุจุฑุฉ ุซูุงุฆูุฉ ุซุงุจุชุฉ ูุฌููุน ุณูุงุณู ุงูุชุจุทูู.  ูููุฐุง ุ ุจุงูุทุจุน ุ ููุงู ุชุญูู ููุฑููู ุณุฑูุน! </p><br><p style=";text-align:right;direction:rtl">  ุจุงููุณุจุฉ ูุฃููุฆู ุงูุฐูู ูุง ูุนุฑููู: ูููู ูู FFT ูุถุงุนูุฉ ูุชุนุฏุฏู ุงูุญุฏูุฏ ูู ุงูุฏุฑุฌุงุช <em>m &lt;n</em> ูู ููุช <em>O (n log n)</em> ุ ุจุดุฑุท ุฃู ูุชู ุชูููุฐ ุงูุนูู ูุน ุงููุนุงููุงุช ููู ูุญุฏุฉ ุฒูููุฉ.  ุชุดุงุจูุงุช ุชุดุจู ุฅูู ุญุฏ ูุจูุฑ ุงูููุชุฌุงุช ุงูุนุฏุฏูุฉ.  ูููู ุชูุฑุงุฑ ูุนุงููุงุช ูุชุนุฏุฏ ุงูุญุฏูุฏ ุงูุฃููู ุ ูุชูุณูุน ูุงุณุชููุงู ุงูุซุงูู ุจุงูุนุฏุฏ ุงููุทููุจ ูู ุงูุฃุตูุงุฑ ุ ุซู ูุญุตู ุนูู ุฌููุน ุงูููุชุฌุงุช ุงูุนุฏุฏูุฉ ูุณูุณูุฉ ุซูุงุฆูุฉ ูุงุญุฏุฉ ูุฌููุน ุงูุนูุงุตุฑ ุงููุฑุนูุฉ ุงูุฃุฎุฑู ูู <em>O (n log n)</em> - ููุน ูู ุงูุณุญุฑ!  ููู ุตุฏูููู ุ ูุฐุง ุญูููู ุชูุงููุง ุ ูุฃุญูุงููุง ููุนูู ุงููุงุณ. </p><br><p style=";text-align:right;direction:rtl">  ูููู ููุณ ูู ClickHouse.  ุจุงููุณุจุฉ ููุง ุ ุงูุนูู ูุน | Sigma |  = 30 ูุจูุฑุฉ ุจุงููุนู ุ ู FFT ููุณุช ุงูุฎูุงุฑุฒููุฉ ุงูุนูููุฉ ุงูุฃูุซุฑ ูุชุนุฉ ูููุนุงูุฌ ุฃู ุ ููุง ูููููู ูู ุนุงูุฉ ุงููุงุณ ุ "ุงูุซุงุจุช ูุจูุฑ." </p><br><p style=";text-align:right;direction:rtl">  ูุฐูู ุ ูุฑุฑูุง ุฃู ููุธุฑ ุฅูู ููุงููุณ ุฃุฎุฑู.  ูุตููุง ุฅูู ุงููุนูููุงุชูุฉ ุงูุญูููุฉ ุ ุญูุซ ูุณุชุฎุฏู ุงููุงุณ ูุณุงูุฉ ู ุบุฑุงู.  ูู ุงููุงูุน ุ ูุญู ูุฃุฎุฐ ุฌููุน ุบุฑุงูุงุช ุงููููุฉ ูุงูุฅุจุฑุฉ ุ ูุฃุฎุฐ ุจุนูู ุงูุงุนุชุจุงุฑ ูุฌููุนุชูู ูุชุนุฏุฏุชูู ูุน ูุฐู ุงูุบุฑุงูุงุช n.  ุซู ูุฃุฎุฐ ุงููุฑู ุงููุชูุงุซู ูููุณู ุนูู ูุฌููุน ุงููุงุฑุฏูููุง ููุฌููุนุชูู ูุชุนุฏุฏุชูู ูุน n-gram.  ูุญุตู ุนูู ุฑูู ูู 0 ุฅูู 1 - ูููุง ุงูุชุฑุจูุง ูู 0 ุ ูููุง ูุงูุช ุงูุฎุทูุท ูุชุดุงุจูุฉ.  ุงููุธุฑ ูู ูุซุงู ุญูุซ <em>ู = 4</em> : </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">abcda โ {abcd, bcda}; Size = 2 bcdab โ {bcda, cdab}; Size = 2         . |{abcd, cdab}| / (2 + 2) = 0.5</code> </pre> <br><p style=";text-align:right;direction:rtl">  ููุชูุฌุฉ ูุฐูู ุ ูุทุนูุง ูุณุงูุฉ 4 ุบุฑุงูุงุช ูุชูุณููุง ุจูุฌููุนุฉ ูู ุงูุฃููุงุฑ ูู SSE ููุงู ุ ููุง ุฃุถุนููุง ููููุงู ูู ุชูููุฐ ุชุฌุฒุฆุงุช crc32 ูุฒุฏูุฌุฉ ุงูุจุงูุช. </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/ad/36/uk/ad36ukzmrspftbjxxwbc3djljv4.png"><br></p><br><p style=";text-align:right;direction:rtl">  ุชุญูู ูู <a href="">ุงูุชูููุฐ</a> .  ุชุญุฐูุฑ: ุฑูุฒ ูููู ููุญุณูู ููุบุงูุฉ ูููุชุฑุฌููู. </p><br><p style=";text-align:right;direction:rtl">  ุฃูุตุญู ุจุดูู ุฎุงุต ุฃู ุชูุชุจู ุฅูู <a href="">ุงูุงุฎุชุฑุงู ุงููุฐุฑ ุงูุฐู</a> ูููู ุธูุงูุงู ุตุบูุฑุฉ ุนูู ููุงุท ASCII ูุงูุฑููุฒ ุงูุฑูุณูุฉ. </p><br><p style=";text-align:right;direction:rtl">  - <code>ngramDistance(haystack, needle)</code> - ุฅุฑุฌุงุน ุฑูู ูู 0 ุฅูู 1 ุ  ุฃูุฑุจ ุฅูู 0 ุ ูุงููุฒูุฏ ูู ุฎุทูุท ุชุดุจู ุจุนุถูุง ุงูุจุนุถ. <br>  - -UTF8 ุ -CaseInsensitive ุ -CaseInsensitiveUTF8 (ุงูุงุฎุชุฑุงู ุงููุฐุฑ ููุฑูุณ ู ASCII). </p><br><p style=";text-align:right;direction:rtl">  Hyperscan ุฃูุถูุง ูุง ููู ููุชูู ุงูุฃูุฏู - ูุฏูู ูุธููุฉ ููุจุญุซ ุงูุชูุฑูุจู: ููููู ุงูุจุญุซ ุนู ุงูุฎุทูุท ุงูุชู ุชุจุฏู ูุซู ุงูุชุนุจูุฑุงุช ุงูุนุงุฏูุฉ ุนู ุทุฑูู ุงููุณุงูุฉ ุงููุณุชูุฑุฉ ูู Levenshtein.  ูุชู ุฅูุดุงุก <em>ูุณุงูุฉ + 1</em> ุขูููุง ุ ูุชุฑุงุจุทุฉ ุนู ุทุฑูู ุญุฐู ุญุฑู ุฃู ุงุณุชุจุฏุงูู ุฃู ุฅุฏุฎุงูู ุ ุจูุนูู "ุฌูุฏ" ุ ูุจุนุฏ ุฐูู ูุชู ุชุทุจูู ุงูุฎูุงุฑุฒููุฉ ุงููุนุชุงุฏุฉ ููุญุต ูุง ุฅุฐุง ูุงู ุฅูุณุงู ุขูู ููุจู ุณุทุฑูุง ูุนูููุง ุฃู ูุง.  ูู ClickHouse ุ ูููุง ุจุชูููุฐูุง ุชุญุช ุงูุฃุณูุงุก ุงูุชุงููุฉ: </p><br><p style=";text-align:right;direction:rtl">  - <code>multiFuzzyMatchAny(haystack, distance, [n_1, ..., n_k])</code> - ุชุดุจู multiMatchAny ุ ููุท ูุน ุงููุณุงูุฉ. <br>  - <code>multiFuzzyMatchAnyIndex(haystack, distance, [n_1, ..., n_k])</code> - ุชุดุจู multiMatchAnyIndex ุ ููุท ูุน ุงููุณุงูุฉ. </p><br><p style=";text-align:right;direction:rtl">  ูุน ุฒูุงุฏุฉ <em>ุงููุณุงูุฉ ุ</em> ุชุจุฏุฃ ุงูุณุฑุนุฉ ูู ุงูุชุฏููุฑ ุฅูู ุญุฏ ูุจูุฑ ุ ููููุง ูุง ุชุฒุงู ุนูุฏ ูุณุชูู ูุงุฆู ุฅูู ุญุฏ ูุง. </p><br><p style=";text-align:right;direction:rtl">  ุงูุงูุชูุงุก ูู ุงูุจุญุซ ูุงููุฒูู ุฅูู ูุนุงูุฌุฉ ุณูุงุณู UTF-8.  ูุงู ููุงู ุฃูุถุง ุงููุซูุฑ ูู ุงูุฃุดูุงุก ุงููุซูุฑุฉ ููุงูุชูุงู. </p><br><h2 id="obrabotka-utf-8-strok" style=";text-align:right;direction:rtl">  ุชุฌููุฒ ุฎุท UTF-8 </h2><br><p style=";text-align:right;direction:rtl">  ุฃุนุชุฑู ุฃูู ูุงู ูู ุงูุตุนุจ ุงุฎุชุฑุงู ุณูู ุงูุชุทุจููุงุช ุงูุณุงุฐุฌุฉ ูู ุงูุณูุงุณู ุงููุดูุฑุฉ UTF-8.  ูุงู ูู ุงูุตุนุจ ุจุดูู ุฎุงุต ุงููุณูุงุฑ SIMD.  ุณูู ุฃุดุงุฑู ุจุนุถ ุงูุฃููุงุฑ ุญูู ููููุฉ ุงูููุงู ุจุฐูู. </p><br><p style=";text-align:right;direction:rtl">  ุงุณุชุฐูุฑ ููู ูุจุฏู ุชุณูุณู UTF-8 ุตุงูุญ: </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/iu/xn/zu/iuxnzucrcetohvgsxb7ozohxwws.png"><br></p><br><p style=";text-align:right;direction:rtl">  ุฏุนูุง ูุญุงูู ุญุณุงุจ ุทูู ููุทุฉ ุงูุฑูุฒ ุจูุงุณุทุฉ ุงูุจุงูุช ุงูุฃูู.  ูุฐุง ูู ุงูููุงู ุงูุฐู ูุจุฏุฃ ุงูุณุญุฑ ููููุง.  ูุฑุฉ ุฃุฎุฑู ููุชุจ ุจุนุถ ุงูุฎุตุงุฆุต: </p><br><p style=";text-align:right;direction:rtl">  - ุจุฏุกูุง ูู 0xC <em>ููู 0xD</em> ูููู ูุฏูู 2 ุจุงูุช <br>  - 0xC2 = 11 <u>0</u> 00010 <br>  - 0xDF = 11 <u>0</u> 11111 <br>  - 0xE0 = 111 <u>0</u> 0000 <br>  - 0xF4 = 1111 <u>0</u> 100 ุ ูุง ููุฌุฏ ุดูุก ุฃูุซุฑ ูู 0xF4 ุ ูููู ุฅุฐุง ูุงู ููุงู 0xF8 ุ ููู ูููู ููุงู ูุตุฉ ูุฎุชููุฉ <br>  - ุงูุฅุฌุงุจุฉ 7 ูุงูุต ููุถุน ุงูุตูุฑ ุงูุฃูู ูู ุงูููุงูุฉ ุ ุฅุฐุง ูู ููู ุญุฑู ASCII </p><br><p style=";text-align:right;direction:rtl">  ูุญุณุจ ุทูู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">inline</span></span></span><span class="hljs-function"> size_t </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seqLength</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> UInt8 first_octet)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (first_octet &lt; <span class="hljs-number"><span class="hljs-number">0x80</span></span>u) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> first_zero = bitScanReverse(<span class="hljs-keyword"><span class="hljs-keyword">static_cast</span></span>&lt;UInt8&gt;(~first_octet)); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">7</span></span> - first_zero; }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุญุณู ุงูุญุธ ุ ูุฏููุง ูู ุงููุฎุฒูู ุชุนูููุงุช ุงูุชู ูููู ุฃู ุชุญุณุจ ุนุฏุฏ ุตูุฑ ุจุช ุ ุจุฏุกุง ูู ุฃูู ูููุง. </p><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs">f = __builtin_clz(val) <span class="hljs-comment"><span class="hljs-comment">// (bsrl,     ) f(2) = 30, f(8) = 28, f(7) = 29</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ุญุณุงุจ bitScanReverse: </p><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">unsigned</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bitScanReverse</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">unsigned</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> x)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">31</span></span> - __builtin_clz(x); }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุฏุนูุง ูุญุงูู ุญุณุงุจ ุทูู ุณูุณูุฉ UTF-8 ุจููุงุท ุงูููุฏ ุนุจุฑ SIMD.  ููููุงู ุจุฐูู ุ ุงูุธุฑ ุฅูู ูู ุจุงูุช ูุฑูู ููููุน ููุงุญุธ ุงูุฎุตุงุฆุต ุงูุชุงููุฉ: </p><br><p style=";text-align:right;direction:rtl">  - 0xBF = -65 <br>  - 0x80 = -128 <br>  - 0xC2 = -62 <br>  - 0x7F = 127 <br>  - ุฌููุน ุงูุจุงูุชุงุช ุงูุฃููู ููุฌูุฏุฉ ูู [0xC2 ุ 0x7F] <br>  - ุฌููุน ุงูุจุงูุชุงุช ุบูุฑ ุงูุฃููู ููุฌูุฏุฉ ูู [0x80 ุ 0xBF] </p><br><p style=";text-align:right;direction:rtl">  ุงูุฎูุงุฑุฒููุฉ ุจุณูุทุฉ ููุบุงูุฉ.  ูุงุฑู ุจูู ูู ุจุงูุช ู -65 ุ ูุฅุฐุง ูุงู ุฃูุจุฑ ูู ูุฐุง ุงูุฑูู ุ ุฃุถู ูุงุญุฏุฉ.  ุฅุฐุง ุฃุฑุฏูุง ุงุณุชุฎุฏุงู SIMD ุ ููุฐุง ูู ุงูุญูู ุงููุนุชุงุฏ ุงูุจุงูุบ 16 ุจุงูุช ูู ุฏูู ุงูุฅุฏุฎุงู.  ุซู ููุงู ููุงุฑูุฉ ุจุงูุช ุ ูุงูุชู ูู ุญุงูุฉ ูุฌูุฏ ูุชูุฌุฉ ุฅูุฌุงุจูุฉ ุณูู ุชุนุทู ุงูุจุงูุช 0xFF ุ ููู ุญุงูุฉ ุณูุจูุฉ - 0x00.  ุซู ุงูุชุนูููุงุช <code>pmovmskb</code> ุ ูุงูุชู ุณูู ุชุฌูุน ุจุช ุนุงููุฉ ูู ูู ุจุงูุช ูู ุงูุณุฌู.  ุซู ูุฒุฏุงุฏ ุนุฏุฏ <code>popcnt</code> ุงูุณูููุฉ ุ ูุณุชุฎุฏู ุงููุถููุฉ ูู <code>popcnt</code> popcnt SSE4.  ูููู ุชูุถูุญ ูุฎุทุท ูุฐู ุงูุฎูุงุฑุฒููุฉ ุจูุงุณุทุฉ ูุซุงู: </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/gn/mh/q5/gnmhq5lwynwpkdmqe2k3xsowxfs.png"><br></p><br><p style=";text-align:right;direction:rtl">  ุงุชุถุญ ุฃูู ุจุงูุฅุถุงูุฉ ุฅูู ุชุฎููู ุงูุถุบุท ุ ุณุชููู ุงููุนุงูุฌุฉ ููู ููุงุฉ ุญูุงูู 1.5 ุฌูุฌุงุจุงูุช / ุซุงููุฉ. </p><br><p style=";text-align:right;direction:rtl">  ุชุณูู ุงููุธุงุฆู: </p><br><p style=";text-align:right;direction:rtl">  - <code>lengthUTF8(string)</code> - ููุฑุฌุน ุทูู ุณูุณูุฉ UTF-8 ุงููุดูุฑุฉ ุจุดูู ุตุญูุญ ุ ูุนุชุจุฑ ุดูุฆูุง ุบูุฑ ุตุงูุญ ุ ููุง ูุชู ุทุฑุญ ุงุณุชุซูุงุก. </p><br><p style=";text-align:right;direction:rtl">  ุฐูุจูุง ุฃุจุนุฏ ูู ุฐูู ูุฃููุง ุฃุฑุฏูุง ุงููุฒูุฏ ูู ุงููุธุงุฆู ูุน ูุนุงูุฌุฉ ุณูุณูุฉ UTF-8.  ุนูู ุณุจูู ุงููุซุงู ุ ุงูุชุญูู ูู ุงูุตูุงุญูุฉ ูุงูุฅุฑุณุงู ุฅูู ุชุนุจูุฑ UTF-8 ุตุงูุญ. </p><br><p style=";text-align:right;direction:rtl">  ููุชุญูู ูู ุงูุตูุงุญูุฉ ุ ุฃุฎุฐุช <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">https://github.com/cyb70289/utf8/</a> ุ ุชู ุชูููููุง ูู ุฃุฌู ClickHouse (ุบููุฑุช ุจุงููุนู ูุนุงูุฌุฉ ุฐููู) ูุญุตูุช ุนูู ุณุฑุนุฉ 1.22 ุฌูุฌุงุจุงูุช / ุซุงููุฉ ููุงุฑูุฉ ุจู 900 ููุบุงุจุงูุช / ุซุงููุฉ ููุฎูุงุฑุฒููุฉ ุงูุณุงุฐุฌุฉ .  ูู ุฃุตู ุงูุฎูุงุฑุฒููุฉ ููุณูุง ุ ููู ูุนูุฏุฉ ููุบุงูุฉ ุจุงููุณุจุฉ ููุฅุฏุฑุงู. </p><br><p style=";text-align:right;direction:rtl">  - <code>isValidUTF8(string)</code> - ุจุฅุฑุฌุงุน 1 ุฅุฐุง ุชู ุชุดููุฑ ุงูุณูุณูุฉ ุจุดูู ุตุญูุญ ูุน UTF-8 ุ ูุฅูุง 0. <br>  - <code>toValidUTF8(string)</code> - ูุณุชุจุฏู ุฃุญุฑู UTF-8 ุบูุฑ ุงูุตุงูุญุฉ ุจุญุฑู U (U + FFFD).  ุชููุณู ูู ุงูุฃุญุฑู ุบูุฑ ุงูุตุญูุญุฉ ุงููุชุชุงููุฉ ุฅูู ุญุฑู ุจุฏูู ูุงุญุฏ.  ูุง ุนูู ุงูุตูุงุฑูุฎ. </p><br><p style=";text-align:right;direction:rtl">  ุจุดูู ุนุงู ุ ูู ุฎุทูุท UTF-8 ุ ูุธุฑูุง ููุฎุทุฉ ุงูุซุงุจุชุฉ ุบูุฑ ุงูุณุงุฑุฉ ุ ูู ุงูุตุนุจ ุฏุงุฆููุง ุงูุชูุตู ุฅูู ุดูุก ูุญุณู ุฌูุฏูุง. </p><br><h2 id="chto-dalshe" style=";text-align:right;direction:rtl">  ูุง ุงูุชุงููุ </h2><br><p style=";text-align:right;direction:rtl">  ุงุณูุญูุง ูู ุฃู ุฃุฐูุฑู ุฃู ูุฐู ูุงูุช ุฑุณุงูุชู.  ุจุงูุทุจุน ุ ุฏุงูุนุช ุนููุง ููุฏุฉ 10/10.  ููุฏ ุฐูุจูุง ูุนูุง ุจุงููุนู ุฅูู Highload ++ Siberia (ุนูู ุงูุฑุบู ูู ุฃูู ุจุฏุง ูู ุฃููุง ูู ุชูู ุชูู ุฃู ุฃุญุฏ).  ูุดุงูุฏุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุนุฑุถ ุงูุชูุฏููู</a> .  ุฃุญุจุจุช ุฃู ุงูุฌุฒุก ุงูุนููู ูู ุงูุฃุทุฑูุญุฉ ุฃุฏู ุฅูู ุงููุซูุฑ ูู ุงูุจุญูุซ ุงููุซูุฑุฉ ููุงูุชูุงู.  ูููุง ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุฏุจููู</a> ููุณู.  ูุฏููุง ุงููุซูุฑ ูู ุงูุฃุฎุทุงุก ุงููุทุจุนูุฉ ุ ูุฃูู ูุง ุฃุญุฏ ููุฑุฃูุง.  :) </p><br><p style=";text-align:right;direction:rtl">  ูุฌุฒุก ูู ุฅุนุฏุงุฏ ุงูุฏุจููู ุ ููุช ุจูุฌููุนุฉ ูู ุงูุฃุนูุงู ุงูููุงุซูุฉ ุงูุฃุฎุฑู (ุงูุฑูุงุจุท ุชุคุฏู ุฅูู ุทูุจุงุช ุงูุชุฌููุน): </p><br><p style=";text-align:right;direction:rtl">  - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุญุณู ูุธููุฉ concat 2 ูุฑุงุช</a> ุ <br>  - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุตูุน ุฃุจุณุท ุดูู ุจูุซูู ููุทูุจุงุช</a> ุ <br>  - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุชุณุงุฑุน LZ4 ุจูุณุจุฉ 4 ูช</a> . <br>  - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุฏ ููุช ุจุนูู ุฑุงุฆุน ุนูู SIMD ููุธุงู ARM ู PPC64LE</a> ุ <br>  - ููุตุญ ุงุซููู ูู ุงูุทูุงุจ ูู FCS ูุน ุงูุฏุจูููุงุช ูู ClickHouse. </p><br><p style=";text-align:right;direction:rtl">  ูู ุงูููุงูุฉ ุ ุงุชุถุญ ุ ูู ุชุฌุฑุจุชู ุ <del>  ูู ุดูุฑ ุญุงูู ููุดุง ุฃู ููุชููุง ูู </del>  ClickHouse ูู ุงููุธุงู ุงูุฃูุซุฑ ูุชุนุฉ ููุชุงุจุฉ ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุนุงููุฉ ุงูุฃุฏุงุก ุ ุญูุซ ููุฌุฏ ูุซุงุฆู ูุชุนูููุงุช ููุทูุฑ ููุชุงุฒ ูุฏุนู devops.  ClickHouse ุฑุงุฆุน ุ ุญูุง.  ุชุนุจุช ูู ุชุญููู ุตูุบ JSONุ  ุชุนุงู ุฅูู ููุดุง ูุงุณุฃู ุนู ูููุฉ ูู ุฃู ูุณุชูู - ุณููุฏููุง ูู ุ ูุฎูุงู ุนุทูุฉ ููุงูุฉ ุงูุฃุณุจูุน ุ ุณุชุดุนุฑ ุจุณุนุงุฏุฉ ุบุงูุฑุฉ ูู ูุชุงุจุฉ ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ. </p><br><p style=";text-align:right;direction:rtl">  ูููู ูุน ูู ุฅูุฌุงุฒุงุช ClickHouse ูุชุตููููุง ุ ูุฑุจูุง ูุง ูุชุนูู ุงูุฃูุฑ ุจูุง.  ููุณ ูู ุงูููุงู ุงูุฃูู ูููุง. </p><br><p style=";text-align:right;direction:rtl">  ูุฑุฑุช ุจุฃุฑุจุน ุณููุงุช ูู ุงูุฏุฑุงุณุงุช ุงูุฌุงูุนูุฉ ูู ูููุฉ ุงูุฏุฑุงุณุงุช ุงูุนููุง ุ ูู ููููู ุชุฎุฑุฌุช ูู HSE ูุน ูุฑุชุจุฉ ุงูุดุฑู ุ ูุนููุช ููุฏุฉ ุณูุฉ ููุตู ูู ูุฑูู ุฑุงุฆุน ูู ูุงูุฏูุณ ุ ุจุนุฏ ุฃู ุถุฎุช ุฌูุฏูุง.  ุจุฏูู ุฎุจุฑุฉ ูุงููุฉ ูู ูุฐุง ุงูููุช <del>  ูุงูุญุฏูุฏ </del>  ูุง ุดูุก ููุชูุจ ูู ุขุฎุฑ ูุฏ ุนููุช.  FCN ุฑุงุฆุน ุฌุฏูุง ุ ุฅุฐุง ููุช ุชุฃุฎุฐ ุงูุญุฏ ุงูุฃูุตู ููู.  ุจูุถู Vana Puzyrevsky <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" class="user_link">ivan_puzyrevskiy</a> ุ Ignat Kolesnichenko ุ Gleb Evstropov ุ Max Babenko <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" class="user_link">maxim_babenko ูููุงุกูู</a> ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" class="user_link">ูุบุงูุฑุชู</a> ุงููุถุญูุฉ ุนูู FCN.  ูุดูุฑูุง ุฃูุถูุง ูุฌููุน ุงููุนูููู ุงูุฐูู ุนููููู ุดูุฆูุง. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar466183/">https://habr.com/ru/post/ar466183/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar466165/index.html">ููู ูุณุงุนุฏ ุงูุฐูุงุก ุงูุงุตุทูุงุนู ูู ุฅุฏุงุฑุฉ ุงููุดุงุฑูุน</a></li>
<li><a href="../ar466169/index.html">ุนุฑุถ ุฎุงุต ููุทูุงุจ ุงูุนุงูููู ูู JetBrains</a></li>
<li><a href="../ar466171/index.html">ุฎูุณุฉ ุฃุณุจุงุจ ููุฐูุงุจ ู JUG.EKB</a></li>
<li><a href="../ar466179/index.html">fform: React & JSONSchema - ุฃูุตู ูุฑููุฉ</a></li>
<li><a href="../ar466181/index.html">ุจุงูุซูู ูู C (C API)</a></li>
<li><a href="../ar466187/index.html">ูุญุฑุฑ ุงูููุทู ุงููุฑุฆู ูู Unity3d. ุงูุฌุฒุก 2</a></li>
<li><a href="../ar466191/index.html">ุงูุดูุก ุงูุฑุฆูุณู ุญูู ุงููุนุฑูุฉ ูู ุฃุฌู ุญูุงุฏูุฉ ุงูุดุจูุงุช ูู ุงูููุงูุงุช ุงููุชุญุฏุฉ ุงูุฃูุฑูููุฉ ูู ุงูุชุณูุณู ุงูุฒููู ููุฃุญุฏุงุซ ูุงูุญุงูุฉ ุงูุฑุงููุฉ</a></li>
<li><a href="../ar466193/index.html">ุนุฑู MailChimp ุงูุชููุงุฆู ุชุบุฐูุฉ ูู ุขุฑ ุฅุณ ุฅุณ</a></li>
<li><a href="../ar466195/index.html">PVS-Studio 7.04</a></li>
<li><a href="../ar466197/index.html">PVS-Studio 7.04</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>