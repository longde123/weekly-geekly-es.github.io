<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üß§ üõµ ‚ôèÔ∏è Como configurar o SNI no Zimbra OSE? üê™ üò≠ üí≥</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="No in√≠cio do s√©culo XXI, um recurso como endere√ßos IPv4 est√° √† beira do esgotamento. Em 2011, a IANA alocou os √∫ltimos cinco blocos restantes / 8 de s...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Como configurar o SNI no Zimbra OSE?</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/zimbra/blog/468025/">  No in√≠cio do s√©culo XXI, um recurso como endere√ßos IPv4 est√° √† beira do esgotamento.  Em 2011, a IANA alocou os √∫ltimos cinco blocos restantes / 8 de seu espa√ßo de endere√ßo para registradores regionais da Internet e, j√° em 2017, os endere√ßos terminaram com eles.  A resposta para a escassez catastr√≥fica de endere√ßos IPv4 n√£o foi apenas o advento do IPv6, mas tamb√©m a tecnologia SNI, que tornou poss√≠vel hospedar um grande n√∫mero de sites em um endere√ßo IPv4.  A ess√™ncia do SNI √© que essa extens√£o permite que os clientes digam ao servidor o nome do site com o qual desejam se conectar durante um handshake.  Isso permite que o servidor armazene v√°rios certificados, o que significa que v√°rios dom√≠nios podem operar no mesmo endere√ßo IP.  A tecnologia SNI se tornou especialmente popular entre os provedores de SaaS para empresas, que foram capazes de hospedar um n√∫mero quase ilimitado de dom√≠nios sem levar em considera√ß√£o o n√∫mero de endere√ßos IPv4 necess√°rios para isso.  Vamos descobrir como voc√™ pode implementar o suporte SNI no Zimbra Collaboration Suite Open-Source Edition. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e98/93d/7d9/e9893d7d9f995c2a24dce02df7fa5d51.png" alt="imagem"><a name="habracut"></a><br><br>  O SNI funciona em todas as vers√µes atuais e suportadas do Zimbra OSE.  Caso seu Zimbra Open-Source seja executado em uma infraestrutura de v√°rios servidores, voc√™ precisar√° executar todas as a√ß√µes a seguir no n√≥ com o servidor Zimbra Proxy instalado.  Al√©m disso, voc√™ precisar√° de pares de certificados + chaves correspondentes, bem como cadeias de certificados confi√°veis ‚Äã‚Äãda sua autoridade de certifica√ß√£o para cada um dos dom√≠nios que deseja colocar no seu endere√ßo IPv4.  Observe que o motivo da grande maioria dos erros ao configurar o SNI no Zimbra OSE est√° precisamente em arquivos de certificado incorretos.  Portanto, recomendamos que voc√™ verifique cuidadosamente tudo antes de instal√°-los diretamente. <br><br>  Primeiro, para que o SNI funcione normalmente, √© necess√°rio inserir o comando <b>zmprov mcf zimbraReverseProxySNIEnabled TRUE</b> no n√≥ com o servidor proxy Zimbra e, em seguida, reinicie o servi√ßo Proxy usando o comando <b>zmproxyctl restart</b> . <br><br>  Come√ßaremos criando um nome de dom√≠nio.  Por exemplo, pegamos o dom√≠nio <b>company.ru</b> e, depois que o dom√≠nio j√° foi criado, determinaremos o nome do host virtual do Zimbra e o endere√ßo IP virtual.  Observe que o nome do host virtual Zimbra deve corresponder ao nome que o usu√°rio deve digitar na linha do navegador para obter acesso ao dom√≠nio e tamb√©m corresponder ao nome indicado no certificado.  Como exemplo, use Zimbra <b>mail.company.ru</b> como o nome do host virtual e use <b>1.2.3.4</b> como o endere√ßo IPv4 virtual. <br><br>  Depois disso, basta digitar o comando <b>zmprov md company.ru zimbraVirtualHostName mail.company.ru zimbraVirtualIPAddress 1.2.3.4</b> para vincular o host virtual do Zimbra ao endere√ßo IP virtual.  Chamamos sua aten√ß√£o para o fato de que, se o servidor estiver localizado atr√°s de um NAT ou firewall, voc√™ dever√° garantir que todas as solicita√ß√µes ao dom√≠nio sejam direcionadas para o endere√ßo IP externo vinculado a ele, e n√£o para o endere√ßo na rede local. <br><br>  Depois que tudo estiver pronto, resta apenas verificar e preparar os certificados de dom√≠nio para instala√ß√£o e instal√°-los. <br><br>  Se o certificado para o dom√≠nio foi emitido corretamente, voc√™ dever√° ter tr√™s arquivos com certificados dispon√≠veis: dois deles s√£o cadeias de certificados da sua autoridade de certifica√ß√£o e um √© um certificado direto para o dom√≠nio.  Al√©m disso, voc√™ deve ter um arquivo com a chave usada para obter o certificado.  Crie uma pasta separada <b>/tmp/company.ru</b> e coloque todos os arquivos dispon√≠veis com chaves e certificados.  O resultado deve ser algo como isto: <br><br><pre><code class="bash hljs">ls /tmp/company.ru company.ru.key  company.ru.crt  company.ru.root.crt  company.ru.intermediate.crt</code> </pre> <br>  Depois disso, combine as cadeias de certificados em um arquivo usando o comando <b>cat company.ru.root.crt company.ru.intermediate.crt &gt;&gt; company.ru_ca.crt</b> e verifique se est√° tudo bem com os certificados usando o comando <b>/ opt / zimbra / bin / zmcertmgr confirmcrt comm /tmp/company.ru/company.ru.key /tmp/company.ru/company.ru.crt /tmp/company.ru/company.ru_ca.crt</b> .  Ap√≥s a verifica√ß√£o dos certificados e da chave, √© poss√≠vel prosseguir com a instala√ß√£o. <br><br>  Para iniciar a instala√ß√£o, primeiro combinaremos o certificado de dom√≠nio e as cadeias confi√°veis ‚Äã‚Äãdas autoridades de certifica√ß√£o em um arquivo.  Isso tamb√©m √© feito usando um comando no formato <b>cat company.ru.crt company.ru_ca.crt &gt;&gt; company.ru.bundle</b> .  Depois disso, √© necess√°rio executar o comando para gravar todos os certificados e a chave no LDAP: <b>/ opt / zimbra / libexec / zmdomaincertmgr savecrt company.ru company.ru.bundle company.ru.key</b> e, em seguida, instale os certificados usando o comando <b>/ opt / zimbra / libexec / zmdomaincertmgr deploycrts</b> .  Ap√≥s a instala√ß√£o, os certificados e a chave do dom√≠nio company.ru ser√£o armazenados na pasta <b>/opt/zimbra/conf/domaincerts/company.ru</b> . <br><br>  Repetindo essas etapas usando nomes de dom√≠nio diferentes, mas com o mesmo endere√ßo IP, voc√™ pode obter o local de v√°rias centenas de dom√≠nios no mesmo endere√ßo IPv4.  Ao mesmo tempo, voc√™ pode usar certificados de v√°rios centros de emiss√£o sem problemas.  Voc√™ pode verificar a exatid√£o de todas as a√ß√µes executadas em qualquer navegador, onde para cada nome de host virtual seu certificado SSL deve ser exibido. <br><br>  Para todas as perguntas relacionadas ao Zextras Suite, voc√™ pode entrar em contato com o representante da Zextras, Ekaterina Triandafilidi, pelo e-mail katerina@zextras.com </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt468025/">https://habr.com/ru/post/pt468025/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt468015/index.html">O que se sabe sobre o ITIL 4 no momento e quem j√° est√° usando a nova biblioteca</a></li>
<li><a href="../pt468017/index.html">O Maybe Monad via ass√≠ncrono / espera em C # (sem a tarefa Ov!)</a></li>
<li><a href="../pt468019/index.html">Desenvolvimento de site no WebAssembly usando NetCore 3 e Blazor</a></li>
<li><a href="../pt468021/index.html">PHP, quanta abstra√ß√£o para as pessoas?</a></li>
<li><a href="../pt468023/index.html">Intelig√™ncia artificial no jogo de luta Shadow Fight 3</a></li>
<li><a href="../pt468027/index.html">M√©todos de otimiza√ß√£o de c√≥digo para Redd. Parte 2: mem√≥ria n√£o armazen√°vel em cache e opera√ß√£o de barramento paralelo</a></li>
<li><a href="../pt468031/index.html">Portamos um jogo multiplayer de C ++ para a web com Cheerp, WebRTC e Firebase</a></li>
<li><a href="../pt468035/index.html">Fa√ßa o download da impressora usando um controlador de jogo ou 8 patentes incomuns para dispositivos de entrada</a></li>
<li><a href="../pt468039/index.html">Moscow Kubernetes Meetup # 6 em Acronis (Fiztehpark) 03/03/2019</a></li>
<li><a href="../pt468041/index.html">An√∫ncio da interface da web do Kubernetes Web View (e uma breve vis√£o geral de outras UIs da web para o Kubernetes)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>