<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üà≥ üõåüèª üë∞üèº Comment nous avons test√© le WD ActiveScale P100 pour notre stockage S3 üë®‚Äçüë®‚Äçüë¶ ü§± ‚ú¥Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Nous testons p√©riodiquement de nouveaux mat√©riels et logiciels √† utiliser dans nos services. Vous voulez toujours plus de fonctionnalit√©s pour un prix...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Comment nous avons test√© le WD ActiveScale P100 pour notre stockage S3</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/dataline/blog/477836/">  Nous testons p√©riodiquement de nouveaux mat√©riels et logiciels √† utiliser dans nos services.  Vous voulez toujours plus de fonctionnalit√©s pour un prix raisonnable.  Aujourd'hui, je vais vous dire comment nous avons compris le p√©riph√©rique Western Digital ActiveScale P100 et essay√© de l'essayer pour notre stockage S3. <br><br>  Imm√©diatement un petit avertissement: nous avons test√© le produit en termes d'utilisation dans un service public.  Peut-√™tre que certaines fonctions, int√©ressantes et importantes pour un usage priv√©, ont √©t√© laiss√©es de c√¥t√©. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/gv/3r/w8/gv3rw8w72ap3doe1cynul2fb_rw.jpeg"></div><br>  <i>Il s'agit d'ActiveScale P100 en avril 2019 avant l'installation dans le centre de donn√©es OST.</i> <br><br>  Maintenant, notre <a href="https://www.dtln.ru/uslugi/datamanagement/odw">S3</a> fonctionne sur Cloudian HyperStore 7.1.5.  Cette version offre une compatibilit√© √† 98% avec les API Amazon.  La solution actuelle a tout ce dont nous avons besoin en tant que prestataire de services et nos clients, nous n'avons donc pas moins cherch√© des alternatives. <a name="habracut"></a><br><br>  Cette fois, la solution mat√©rielle et logicielle Western Digital ActiveScale est tomb√©e entre nos mains.  Le vendeur le positionne comme une solution pour organiser un cluster S3. <br><br>  Voici √† quoi cela ressemble: <br><br><img src="https://habrastorage.org/webt/g3/6g/cb/g36gcb-oacoww2pa1zqifnxjrti.png"><br>  <i>ActiveScale P100 install√© dans l'une des salles du centre de donn√©es OST.</i> <br><br>  Les trois premi√®res unit√©s sont des n≈ìuds de contr√¥le.  Les six unit√©s suivantes sont des n≈ìuds pour stocker des donn√©es.  Chacun des six n≈ìuds contient 12 disques de 10 To chacun.  720 To de capacit√© "brute" au total.  Le complexe comprend √©galement 2 p√©riph√©riques r√©seau.  Pour chaque n≈ìud - 2 liens de 10G.  Au total, cette d√©cision prend 11 unit√©s dans le rack. <br><br>  Nous avons ex√©cut√© ActiveScale √† travers des tests de charge: un script a g√©n√©r√© un nombre diff√©rent de fichiers de diff√©rentes tailles, a essay√© de les t√©l√©charger en modes mono-thread et multi-thread et a enregistr√© le temps d'ex√©cution des commandes pour t√©l√©charger et supprimer des fichiers.  Ce test √©tait artificiel: il a √©t√© effectu√© √† partir d'un ordinateur avec un lecteur SSD, une grande quantit√© de m√©moire et un processeur avec une fr√©quence de 3,2 GHz, avec une largeur de canal limit√©e de 100 Mb / s.  N√©anmoins, nous avons les r√©sultats d'un test similaire pour la solution actuelle, et les r√©sultats obtenus √©taient plus que conformes √† nos attentes. <br><br><div class="scrollable-table"><table><tbody><tr><td>  Test <br></td><td>  Taille de l'objet <br></td><td>  Nombre d'objets <br></td><td>  Nombre de fils <br></td><td>  Vitesse moyenne <br></td><td>  Temps de chargement <br></td><td>  Temps de retrait * <br></td></tr><tr><td>  1 <br></td><td>  10 Ko <br></td><td>  100 000 <br></td><td>  1 <br></td><td>  104 ko / s <br></td><td>  2 h 40 m <br></td><td>  6 m 58 s <br></td></tr><tr><td>  2 <br></td><td>  10 Ko <br></td><td>  100 000 <br></td><td>  20 <br></td><td>  11 Mo / s <br></td><td>  35 m 4 s <br></td><td>  11 m 38 s <br></td></tr><tr><td>  3 <br></td><td>  1 Mo <br></td><td>  100 000 <br></td><td>  1 <br></td><td>  5 Mo / s <br></td><td>  5 h 55 m <br></td><td>  7 m 16 s <br></td></tr><tr><td>  4 <br></td><td>  1 Mo <br></td><td>  100 000 <br></td><td>  20 <br></td><td>  11 Mo / s <br></td><td>  2 h 30 min <br></td><td>  7 m 26 s <br></td></tr><tr><td>  5 <br></td><td>  10 Go <br></td><td>  1 <br></td><td>  1 <br></td><td>  10 Mo / s <br></td><td>  16 m 5 s <br></td><td>  3 s <br></td></tr><tr><td>  6 <br></td><td>  10 Go <br></td><td>  1 <br></td><td>  20 <br></td><td>  10 Mo / s <br></td><td>  16 m 2 s <br></td><td>  3 s <br></td></tr></tbody></table></div>  <i>R√©sultats des tests de r√©sistance.</i> <i><br><br></i>  <i>* Lors de la suppression d'un objet est uniquement marqu√© pour la suppression.</i>  <i>L'enl√®vement lui-m√™me a lieu une fois par jour.</i>  <i>Lorsque le cluster est presque plein, cela peut compliquer la gestion de la capacit√©, car il n'y a pas d'informations √† jour sur les ressources utilis√©es.</i> <br><br>  La compatibilit√© d'Amazon S3 a √©t√© test√©e de mani√®re standard.  <a href="">Voici l'</a> un des tests que j'ai utilis√©s. <br><br>  Au moment des tests, nous avions la documentation la plus basique, nous avons donc trait√© le p√©riph√©rique de cette ¬´bo√Æte noire¬ª ind√©pendamment - via l'interface Web d'administration, l'API et l'acc√®s physique. <br><br><h3>  Ce qui a √©t√© trouv√© √† l'int√©rieur </h3><br>  <b>Interface d'administration</b>  Sur la page principale, des informations r√©capitulatives sur les tailles de cluster et les mesures de travail, les statistiques sur les objets, les utilisateurs, les compartiments, les politiques de stockage. <br><br><img src="https://habrastorage.org/webt/nv/kk/yc/nvkkycjcqzdkpmxwj4sdxpufolq.png"><br><br>  <b>Interface utilisateur</b>  Dans le service S3, il est n√©cessaire pour que l'administrateur c√¥t√© client puisse ajouter / supprimer des utilisateurs, g√©n√©rer des cl√©s d'acc√®s pour eux, citer des utilisateurs, etc. Le P100 ne l'a pas, mais apr√®s nos commentaires, le fournisseur pr√©voit de le mettre en ≈ìuvre. <br><br>  <b>Gestion des utilisateurs / r√¥les.</b>  Pour organiser un service public, nous avons besoin de pouvoir cr√©er des utilisateurs avec diff√©rents droits d'acc√®s.  Le P100 pr√©sente des limites importantes √† cet √©gard: <br><br><ul><li>  Vous ne pouvez cr√©er qu'un seul utilisateur syst√®me, c'est-√†-dire un administrateur de cluster.  Plus - uniquement gr√¢ce √† l'int√©gration avec Active Directory. </li><li>  Les utilisateurs ne peuvent pas √™tre group√©s et assign√©s √† un administrateur.  En fait, cela nous emp√™che de fournir un service public. </li><li>  l'utilisateur ne peut pas √™tre supprim√© d√©finitivement, donc si le nouvel utilisateur poss√®de la m√™me connexion, vous devrez √™tre cr√©atif. </li><li>  la d√©finition de quotas pour les utilisateurs (volume, nombre de transactions, etc.) n'est possible que via la CLI. </li></ul><br>  <b>Facturation.</b>  Le P100 est pr√™t √† l'emploi, et c'est le plus gros inconv√©nient pour nous en tant que fournisseur de services.  Nous avons un produit commercial et nous devons en quelque sorte facturer les clients.  Le P100 poss√®de des journaux de statistiques qui peuvent √™tre supprim√©s toutes les heures via le panneau d'administration.  Th√©oriquement, vous pouvez les analyser, extraire les donn√©es n√©cessaires et effectuer un calcul √† leur sujet.  Mais ces journaux ne sont stock√©s que 30 jours.  Que faire dans les situations o√π au cours du mois de 31 jours ou le client demande √† rev√©rifier le compte des mois pr√©c√©dents n'est pas clair. <br><br>  <b>D√©finition de vos propres r√®gles de stockage d'objets.</b>  Le P100 nous est d√©j√† parvenu avec les param√®tres suivants: les fichiers plus petits que le bloc (20 Ko) sont stock√©s en mode <a href="https://habr.com/ru/post/141487/">code d'effacement (EC)</a> 6 + 2.  Les fichiers plus gros que le bloc sont stock√©s en mode EC 13 + 4.  Le P100 d√©termine lui-m√™me la taille du fichier et s√©lectionne le mode appropri√©. <br><br>  D'une part, le P100 a plus d'options.  En revanche, tous les param√®tres de r√®gles de stockage pour le facteur de r√©plication et le code d'effacement ne sont possibles qu'au stade du d√©ploiement du cluster.  Plus tard, pendant le fonctionnement, il n'est plus possible d'ajouter de nouvelles r√®gles de stockage de donn√©es ou de modifier celles existantes.  Lors de l'expansion du cluster, cela doit √™tre fait pour que l'efficacit√© et la fiabilit√© du stockage soient optimales. <br><br><img src="https://habrastorage.org/webt/ri/f0/kv/rif0kvhc-ajofhymolphcme1psg.png"><br>  <i>Tableau des performances de stockage du code d'effacement.</i> <br><br>  <b>CLI native \ AdminAPI.</b>  Pour g√©rer le cluster, le P100 poss√®de une CLI, mais il est √©crit et test√© uniquement pour Ubuntu (nous utilisons Red Hat).  Il ne donne pas d'avantages significatifs par rapport √† l'interaction via les requ√™tes curl (put, get, post), mais il existe certaines fonctionnalit√©s pour g√©rer le cluster. <br><br>  <b>Prise en charge de l'API AWS S3 de base et de l'AWS CLI.</b>  Ceci n'est qu'un indicateur de compatibilit√© avec l'API Amazon.  Autrement dit, est-il possible d'utiliser les commandes pour Amazon S3 dans cette solution.  Selon l'exp√©rience, cet indicateur varie en moyenne quelque part entre 50 et 70%. <br><br>  P100 a obtenu 58% selon les r√©sultats des tests.  Il n'a pas √©t√© possible de faire des tests de compatibilit√© sur l'attribution des droits d'acc√®s √† des objets individuels, car dans la solution P100, vous pouvez attribuer un acc√®s g√©n√©ral uniquement √† un compartiment, et non √† un objet distinct.  Il n'y a pas non plus d'IAM (gestion des identit√©s et des acc√®s).  En cons√©quence, la compatibilit√© est plus proche de 50%. <br><br><img src="https://habrastorage.org/webt/xy/-q/d6/xy-qd6ev4kzjd4znhvtsr3snvck.png"><br>  <i>D'apr√®s les r√©sultats des tests.</i> <br><br>  <b>Gestion du syst√®me d'exploitation.</b>  Selon la sp√©cification, ActiveScale OS 5.x appara√Æt.Selon les journaux et les dossiers disponibles via l'interface Web, j'ai d√©couvert qu'il est tr√®s probablement bas√© sur une distribution Debian.  Pendant les tests, il n'a pas √©t√© possible de trouver des moyens pour les mises √† jour autog√©r√©es, comment installer les mises √† jour de s√©curit√© critiques, vos agents de surveillance, etc.  Il faut absolument contacter le support technique P100 avec le d√©part d'une personne sp√©cialement form√©e. <br><br>  <b>Le nombre de compartiments par utilisateur.</b>  Dans ces services, l'utilisateur peut g√©n√©ralement cr√©er jusqu'√† 100 compartiments, une sorte de ¬´dossier¬ª pour stocker des fichiers.  Dans le cas g√©n√©ral, cela suffit, mais la pratique montre qu'il n'y a pas beaucoup de seaux.  Dans le P100, 100 godets est le maximum.  Dans notre solution actuelle, l'utilisateur peut cr√©er 1000 seaux. <br><br>  <b>D√©finition des droits d'acc√®s au compartiment et aux objets.</b>  Dans P100, vous pouvez donner acc√®s √† un compartiment sp√©cifique, mais pas √† un objet sp√©cifique.  Ce dernier est souvent utilis√© par les utilisateurs car il vous permet de fixer des limites sur le nombre de t√©l√©chargements et le moment o√π il peut √™tre t√©l√©charg√©. <br><br>  <b>Statistiques de cluster / utilisateur / compartiment.</b>  Nous avons besoin de ces informations pour suivre l'occupation des clusters et ne pas manquer le moment o√π nous arrivons au plafond par les ressources. <br><br>  Dans l'interface, vous pouvez voir des statistiques presque en temps r√©el sur les utilisateurs et les compartiments (les informations sont mises √† jour une fois par heure). <br><br><img src="https://habrastorage.org/webt/xj/ai/bq/xjaibqqw9gdv07yzza2kzjeaok4.png"><br><br>  Il peut √™tre t√©l√©charg√© via un compartiment syst√®me sp√©cial, mais sous la forme t√©l√©charg√©e au lieu d'un e-mail ou de noms d'utilisateur, il y aura un UUID, vous devez donc en quelque sorte comparer le type d'utilisateur qui se cache derri√®re des UUID sp√©cifiques.  Ce n'est pas un probl√®me s'il y a 10 utilisateurs, mais si plus? <br><br>  <b>Auto-diagnostic.</b>  Le P100 peut interroger via SNMP toute la partie fer du cluster et l'afficher sur un tableau de bord.  Par exemple, vous pouvez voir la saturation et la temp√©rature des disques, l'utilisation de la m√©moire, etc. <br><br><img src="https://habrastorage.org/webt/pd/qa/vl/pdqavlm376zmqdizh6izrlvjax4.png"><br>  <i>Informations sur l'√©tat du n≈ìud syst√®me.</i> <br><br><img src="https://habrastorage.org/webt/h8/t1/hz/h8t1hzlznyaquktbmfrd1gbqdvs.png"><br>  <i>Informations sur l'√©tat des disques.</i>  <i>Lorsqu'un disque tombe en panne, vous pouvez activer le r√©tro√©clairage pour trouver et remplacer rapidement.</i> <br><br><img src="https://habrastorage.org/webt/gc/82/1v/gc821vydlpzudaueudlaushnuu4.png"><br>  <i>Param√®tres de chargement du CPU et de la m√©moire dans le cluster.</i> <br><br>  <b>Journalisation des actions des utilisateurs.</b>  Ce n'est pas l√†, ce qui signifie qu'il n'est pas facile de comprendre les situations de "qui a supprim√© le fichier et l'a supprim√©". <br><br>  <b>Prise en charge SSE / SSE-C.</b>  Le P100 prend en charge le cryptage, mais avec des limitations: vous devez demander une cl√© de licence distincte, ce qui repr√©sente un suppl√©ment d'argent. <br><br>  <b>√âquilibreur de charge.</b>  Il est int√©gr√© et vaut probablement HAProxy.  Vous devez le configurer au minimum: sp√©cifiez simplement les adresses IP entrantes et sortantes. <br><br>  <b>Automatisation des processus d'entr√©e / sortie des n≈ìuds ou des disques sur les n≈ìuds.</b>  Il est utile lorsqu'un n≈ìud se casse dans un cluster et doit √™tre mis hors service.  Maintenant, pour de telles situations, nous avons une solution toute faite.  Je n'ai pas trouv√© un tel m√©canisme dans le P100, vous ne pouvez d√©sactiver qu'un n≈ìud s√©par√© via l'interface Web d'administration.  Tr√®s probablement, vous devrez inviter l'ing√©nieur du vendeur. <br><br>  <b>Appliance S3 Gate.</b>  Cette solution logicielle vous permet de d√©ployer ftp / nfs / samba-gate c√¥t√© client et d'y d√©poser les fichiers qui devraient se trouver dans S3.  Une chose pratique si l'utilisateur final ne sait pas utiliser S3.  Malheureusement, le P100 n'a pas cela √† bord. <br><br>  <b>Ports d'application fonctionnels.</b>  Dans le P100, seuls les ports standard pour S3 sont disponibles - 80, 443. <br><br>  <b>Documentation utilisateur.</b>  Il n'y a que de la documentation API. <br><br>  <b>Documentation administrative.</b>  Fourni par le vendeur sur demande. <br><br><h3>  Non test√©, mais d√©clar√© par le vendeur </h3><br>  <b>Plusieurs points de terminaison.</b>  Nous sommes arriv√©s avec une installation pr√™te, o√π un seul point de terminaison par cluster √©tait d√©j√† configur√©.  Le changement a √©chou√©. <br><br>  <b>G√©o-r√©servation.</b>  Cette option permet de r√©pliquer les donn√©es sur trois sites et de basculer les clients vers des sites de sauvegarde.  Nous n'avions qu'un seul cluster, il n'√©tait donc pas possible de tester. <br><br>  <b>Int√©gration avec AD.</b>  D√©clar√©, mais nous n'utilisons pas AD par rapport √† S3, nous n'avons donc pas test√©. <br><br><h3>  Conclusions </h3><br>  En g√©n√©ral, le WD ActiveScale P100 a laiss√© une impression positive: il fonctionne ¬´pr√™t √† l'emploi¬ª, rapidement et en m√™me temps, il est tr√®s acceptable.  N√©anmoins, il s'agit d'une solution priv√©e qui ne peut pas encore √™tre utilis√©e pour cr√©er un service S3 public.  Voici l'essentiel que nous n'avions pas assez: <br><br><ul><li>  il n'y a aucun moyen de cr√©er des groupes d'utilisateurs et de d√©finir un administrateur pour eux; </li><li>  pas d'interface utilisateur graphique; </li><li>  pas de facturation; </li><li>  inclusion de fonctions suppl√©mentaires uniquement par un appel au fournisseur; </li><li>  l'incapacit√© √† conserver diff√©rentes politiques de stockage et √† les affecter √† diff√©rents groupes d'utilisateurs au sein du m√™me cluster, en fonction des t√¢ches en cours. </li></ul><br>  Selon les r√©sultats des tests, le vendeur a accept√© tous les souhaits.  Peut-√™tre que dans un proche avenir l'un d'entre eux sera r√©alis√©. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr477836/">https://habr.com/ru/post/fr477836/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr477822/index.html">PHP 7.4 est sorti! Comment les mises √† niveau de Badoo</a></li>
<li><a href="../fr477824/index.html">Vivons jusqu'√† lundi ou comment survivre au vendredi noir</a></li>
<li><a href="../fr477826/index.html">Pr√©sentation et comparaison des technologies V2X</a></li>
<li><a href="../fr477832/index.html">Comment s'entendre avec la g√©n√©ration Z</a></li>
<li><a href="../fr477834/index.html">Principes de construction de syst√®mes d'analyse en streaming</a></li>
<li><a href="../fr477840/index.html">Analyseur de code statique PVS-Studio comme protection contre les vuln√©rabilit√©s zero-day</a></li>
<li><a href="../fr477842/index.html">Histoires de Gennady Zelenko et Sergey Popov - vulgarisateurs de la technologie en URSS</a></li>
<li><a href="../fr477844/index.html">5 √©tapes de l'id√©e √† l'application pratique de l'apprentissage automatique avec SAP Data Intelligence</a></li>
<li><a href="../fr477846/index.html">Le condens√© des √©v√©nements pour les professionnels des RH en informatique pour d√©cembre 2019</a></li>
<li><a href="../fr477848/index.html">Le petit secret d'un grand c≈ìur: le premier cardiogramme de la baleine bleue de l'histoire</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>