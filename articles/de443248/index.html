<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëî üèîÔ∏è üîÜ Protokolle zur nahtlosen Reservierung von PRP und HSR üåÇ üöè ü§ï</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In der Industrie werden die LAN-Anforderungen immer ernster ICS √ºbernehmen immer mehr Funktionen, und Datenverlust kann zu erheblichen Kosten f√ºhren. ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Protokolle zur nahtlosen Reservierung von PRP und HSR</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/phoenix_contact/blog/443248/">  In der Industrie werden die LAN-Anforderungen immer ernster  ICS √ºbernehmen immer mehr Funktionen, und Datenverlust kann zu erheblichen Kosten f√ºhren. <br><br>  Wenn beispielsweise im Energiesektor die Daten von den Messwandlern die Relaisklemme nicht rechtzeitig erreichen, kann dies zu einem Kurzschluss f√ºhren, der sich auf benachbarte Abschnitte des Stromnetzes ausbreitet, was zu viel schwerwiegenderen Verlusten f√ºhrt als im Fall einer rechtzeitigen Trennung des Abschnitts vom Kurzschluss.  Daher k√∂nnen Sie in Energieprojekten h√§ufig die Anforderung "Erholungszeit weniger als 1 ms" erf√ºllen. <br><a name="habracut"></a><br>  Die Netzwerkredundanz basierend auf branchenweiten Protokollen wie RSTP, MRP, DLR und dergleichen basiert auf einer √Ñnderung der Topologie im Falle einer Fehlfunktion bei der Daten√ºbertragung.  Das √Ñndern der Topologie dauert eine bestimmte Zeit (von Millisekunden bis Sekunden, je nach Protokoll), die als "Wiederherstellungszeit" bezeichnet wird.  W√§hrend dieser Zeit gibt es keine Kommunikation mit einem Teil des Netzwerks und dementsprechend gehen Daten verloren.  Das hei√üt,  Herk√∂mmliche Ringredundanztechnologien erlauben keine Wiederherstellungszeiten von weniger als 1 ms. <br><br>  Vor diesem Hintergrund werden die sogenannten ‚Äûnahtlosen‚Äú Redundanztechnologien - PRP und HSR - immer beliebter.  Eine auf PRP und HSR basierende Redundanz wird im Gegensatz zu den obigen Protokollen nicht durch Neuerstellen der Topologie, sondern durch Duplizieren von Frames ausgef√ºhrt.  Jeder Frame wird vom Absender dupliziert, und beide Frames werden auf unterschiedliche Weise √ºbertragen, und der empfangende Knoten verarbeitet den zuerst eingehenden Frame und verwirft den zweiten.  Dieses Funktionsprinzip erfordert keine Umstrukturierung der Topologie, und dementsprechend arbeitet dieses Protokoll nahezu ‚Äûnahtlos‚Äú.  Unter dem Schnitt finden Sie Details zur Implementierung dieser Protokolle. <br><br><h4>  Netzwerkstruktur </h4><br>  Nahtlose Redundanz wird auf Endknoten implementiert, nicht auf Netzwerkkomponenten.  Dies ist einer der Hauptunterschiede zwischen PRP und HSR zu anderen Sicherungsprotokollen wie RSTP oder MRP.  Ber√ºcksichtigen Sie die Merkmale der Netzwerkstruktur f√ºr PRP und HSR. <br><br><h4>  PRP - Netzwerkstruktur </h4><br>  Der Endknoten verf√ºgt √ºber zwei Ethernet-Schnittstellen, die mit zwei voneinander isolierten Netzwerken verbunden sind, parallel arbeiten und eine unabh√§ngige Topologie aufweisen (d. H. Die Topologien dieser beiden Netzwerke k√∂nnen gleich oder unterschiedlich sein).  Die Netzwerke m√ºssen isoliert sein, damit eine Fehlfunktion und ein Stopp der Daten√ºbertragung in einem Netzwerk das zweite nicht beeintr√§chtigen, d. H.  Sogar die Netzwerkstromversorgung erfolgt aus verschiedenen Quellen.  Es sollten keine direkten Verbindungen zwischen diesen Netzwerken bestehen. <br><br><img src="https://habrastorage.org/webt/rc/19/go/rc19go3yzzhhcc8ej24_7pbxhb4.png"><br><br>  <i>PRP-Netzwerkstruktur</i> <br><br>  Diese beiden Netzwerke werden normalerweise als LAN A und LAN B bezeichnet. Wie bereits erw√§hnt, k√∂nnen sie unterschiedliche Topologien sowie unterschiedliche Leistungen aufweisen.  Verz√∂gerungen bei der Daten√ºbertragung k√∂nnen ebenfalls variieren. <br><br>  Das Netzwerk kann die folgenden Elemente enthalten: <br><br><ul><li>  DAN (Dual Attached Node) - Ein Knoten, der eine Verbindung zu beiden Netzwerken herstellt und doppelte Frames sendet / empf√§ngt. </li><li>  SAN (Single Attached Node) - Ein Knoten, der nur eine Verbindung zu einem Netzwerk (LAN A oder LAN B) herstellt und normale Frames sendet / empf√§ngt. </li><li>  F√ºr den Fall, dass ein Ger√§t mit einer Ethernet-Schnittstelle, das das PRP-Protokoll nicht unterst√ºtzt, redundant mit dem RPR-Netzwerk verbunden werden muss, wird die sogenannte Redundancy Box (normalerweise RedBox) verwendet.  Auf der RedBox wird das Paket vom Ger√§t dupliziert und an das PRP-Netzwerk √ºbertragen, als ob die Daten vom DAN √ºbertragen w√ºrden.  Dar√ºber hinaus wird das Ger√§t hinter RedBox als DAN f√ºr andere Ger√§te angesehen.  Ein solcher Knoten wird als virtueller DAN oder VDAN (Virtual DAN) bezeichnet. </li></ul><br><br><img src="https://habrastorage.org/webt/ko/1f/ye/ko1fyehyesxd7zlz5qs-_q2zs_e.png"><br><br>  <i>Das Arbeitsprinzip von RedBox</i> <br><br><h4>  HSR - Netzwerkstruktur </h4><br><img src="https://habrastorage.org/webt/sd/mi/hd/sdmihdk3aqfpandamwmu3artwf0.png"><br><br>  <i>HSR-Netzwerkstruktur</i> <br><br>  Das Funktionsprinzip von HSR besteht darin, dass alle Ger√§te zu einem Ring zusammengefasst und alle Nachrichten sowie in PRP dupliziert werden.  Das Ger√§t sendet beide Frames durch den Ring: eine Kopie im Uhrzeigersinn, die andere gegen den Uhrzeigersinn.  Der Empf√§nger empf√§ngt beide Kopien, verarbeitet jedoch nur die erste und l√∂scht die zweite.  Wenn einem der Links etwas passiert und einer der duplizierten Frames nicht kommt, wird der andere einfach akzeptiert.  Alle HSR-Ger√§te verf√ºgen √ºber zwei Ethernet-Schnittstellen - Port A und Port B. <br><br>  Gem√§√ü dem HSR-Protokoll k√∂nnen die folgenden Elemente in einem Netzwerk vorhanden sein: <br><br><ul><li>  SAN ist ein Knoten mit nur einer Ethernet-Schnittstelle.  Ein solcher Knoten kann ausschlie√ülich √ºber RedBox mit dem HSR-Netzwerk verbunden werden. </li><li>  DAN - Ein Knoten, der Daten innerhalb eines HSR-Rings austauschen kann (doppelte Frames senden / empfangen kann). </li><li>  RedBox - Wie in PRP k√∂nnen Sie mit RedBox ein Ger√§t mit einer Ethernet-Schnittstelle an ein HSR-Netzwerk anschlie√üen.  Das Ger√§t hinter RedBox wird als DAN f√ºr andere Ger√§te angesehen.  Ein solcher Knoten wird als virtueller DAN oder VDAN (Virtual DAN) bezeichnet. </li><li>  QuadBox - HSR f√ºhrt auch ein neues Element ein - QuadBox.  Dieses Ger√§t verf√ºgt √ºber vier HSR-Ports.  Sie k√∂nnen zwei HSR-Ringe kombinieren.  In jedem Ring fungiert die QuadBox als DAN und kann Daten von einem Ring zu einem anderen √ºbertragen. </li></ul><br><img src="https://habrastorage.org/webt/we/7n/dc/we7ndcshvu_8oefjqm9ykvrc8a8.png"><br><br>  <i>QuadBox-Beispiel</i> <br><br><h4>  DAN-Struktur </h4><br>  F√ºr PRP und f√ºr HSR ist die DAN-Struktur √§hnlich.  Jeder DAN verf√ºgt √ºber zwei parallel arbeitende Schnittstellen, die √ºber die sogenannte LRE-Schicht - Verbindungsredundanzeinheit - mit der oberen Ebene eines Kommunikationsstapels verbunden sind.  Auf dieser Ebene werden alle Sicherungsfunktionen ausgef√ºhrt. <br><br>  Beide DAN-Schnittstellen haben dieselbe MAC-Adresse und eine IP-Adresse.  Auf diese Weise k√∂nnen Sie die Reservierung f√ºr die oberste Ebene transparent machen.  Besonders wichtig ist die Tatsache, dass dies die Verwendung von ARP f√ºr DAN sowie f√ºr jeden nicht redundanten Knoten erm√∂glicht. <br><br>  Nat√ºrlich gibt es Nuancen in der DAN-Struktur f√ºr PRP und f√ºr HSR. <br><br><h4>  PRP - DAN Struktur </h4><br>  Wenn ein Frame von der obersten Ebene gesendet wird, dupliziert die LRE ihn und sendet beide Pakete fast gleichzeitig √ºber die Ports.  Beide Frames werden parallel √ºber zwei Netzwerke mit unterschiedlichen Verz√∂gerungen √ºbertragen.  Im Idealfall werden sie mit einem minimalen Zeitunterschied an den Zielknoten geliefert.  Nach dem Empfang der LRE sendet der Empf√§nger den ersten empfangenen Rahmen an die obere Schicht und verwirft den zweiten. <br><br>  LRE erstellt beim Senden doppelte Frames und verarbeitet diese beim Empfang.  Diese Ebene stellt in Bezug auf die obere Ebene die √ºbliche Schnittstelle eines nicht redundanten Netzwerkadapters dar.  LRE f√ºhrt zwei Aufgaben aus: die Behandlung doppelter Frames und die Verwaltung der Redundanz.  Um die Steuerung zu implementieren, f√ºgt LRE jedem Frame einen 32-Bit-Redundanzsteuerungs-Trailer (RCT) hinzu und l√∂scht ihn, wenn der Frame empfangen wird. <br><br><img src="https://habrastorage.org/webt/7v/tf/p7/7vtfp7drkalyuxwvs7c1fnbdewy.png"><br><br>  <i>√úbertragen von Daten zwischen zwei DANs in PRP</i> <br><br><h4>  HSR - DAN Struktur </h4><br>  Ein von der oberen Schicht gesendeter Frame wird von der LRE-Schicht dupliziert, und Pakete werden fast gleichzeitig √ºber Port A und Port B gesendet.  (1 und 2 im Diagramm). <br><br>  Beim Empfang des Frames √ºbertr√§gt der Empf√§nger ihn auf die LRE-Ebene, leitet ihn auch an einen anderen Port weiter und leitet ihn weiter im Ring weiter.  (3, 4). <br><br>  Wenn ein Frame beim Absender ankommt, wird dieser Frame nicht weiter √ºbertragen, sondern zerst√∂rt (5, 6). <br><br>  Beide Frames erreichen die LRE-Ebene, aber derjenige, der schneller gesendet wurde, wird auf die obere Ebene √ºbertragen und der duplizierte Frame wird verworfen. <br><br>  LRE f√ºgt jedem Frame ein 48-Bit-HSR-Tag hinzu (√§hnlich dem Hinzuf√ºgen eines VLAN-Tags) und l√∂scht dieses Tag beim Empfang. <br><br><img src="https://habrastorage.org/webt/k9/xl/pj/k9xlpj2jf76juzewex9ocyuze_k.png"><br><br>  <i>√úbertragen von Daten zwischen zwei DANs in einem HSR</i> <br><br><h4>  Interoperabilit√§t zwischen SAN und DAN </h4><br>  In PRP kann ein SAN mit jedem Netzwerk verbunden werden - LAN A oder LAN B, aber ein solcher Knoten unterst√ºtzt keine Sicherungsfunktionen.  Daher kann ein mit einem Netzwerk verbundenes SAN nicht mit einem anderen √§hnlichen Knoten kommunizieren, der mit einem zweiten Netzwerk verbunden ist.  F√ºr die Interaktion mit SAN generiert DAN spezielle Frames.  Dieser Bedarf ist auf die Tatsache zur√ºckzuf√ºhren, dass das SAN im normalen Frame des redundanten Ger√§ts die RCT ignorieren muss, was nicht m√∂glich ist, da das SAN die RCT nicht vom √ºblichen IEEE 802.3-Datenblock unterscheiden kann.  Der DAN versteht wiederum, dass er den Frame an das SAN sendet und dem Frame keine RCT hinzuf√ºgt.  Es leitet einfach einen Frame von der obersten Ebene an die Schnittstelle weiter, an die das SAN angeschlossen ist.  Mit anderen Worten, wenn der DAN nicht bestimmen kann, was Daten mit einem anderen DAN austauscht, f√ºgt er dem Frame keine RCT hinzu. <br><br>  In HSR kann ein SAN nicht direkt mit dem Netzwerk verbunden werden.  Es kann ausschlie√ülich √ºber RedBox verbunden werden. <br><br><h4>  DAN-Modi </h4><br>  Wenn Sie mit doppelten Frames arbeiten, die auf beiden Schnittstellen empfangen wurden (sofern diese gewartet werden k√∂nnen), muss der DAN einen der Frames akzeptieren und den zweiten verwerfen.  In PRP gibt es zwei Verarbeitungsmethoden: <br><br><ul><li>  Duplicate Accept ist eine Methode, bei der beide eingehenden Frames empfangen und auf die obere Ebene umgeleitet werden. </li><li>  Duplicate Discard - Eine Methode, bei der der empfangende Knoten Informationen aus der RCT des eingehenden Frames liest, um zu bestimmen, welcher Frame verworfen werden soll. </li></ul><br>  Ber√ºcksichtigen Sie f√ºr HSR die beliebtesten U- und X-Modi. <br><br><h4>  Duplizieren akzeptieren </h4><br>  Ein DAN, der in diesem Modus arbeitet, l√∂scht bei der Verarbeitung auf der Datenverbindungsschicht keinen der Frames. <br><br>  Frames werden ohne RCT an LAN A und LAN B gesendet.  Die LRE des Empf√§ngers leitet einfach beide Frames zur oberen Schicht um, vorausgesetzt, dass eine weitere √úbertragung die Duplikate zerst√∂rt (IEEE 802.1D gibt eindeutig an, dass die Protokolle der oberen Schicht in der Lage sein m√ºssen, doppelte Frames zu verarbeiten). <br><br>  Beispielsweise weisen TCP und UDP eine hohe Ausfallsicherheit f√ºr doppelte Frames auf. <br><br>  Diese Methode ist sehr einfach zu implementieren, hat jedoch einen schwerwiegenden Nachteil: Sie bietet keine Netzwerksteuerungsfunktionen  Der Empfang beider Frames wird in keiner Weise √ºberwacht. <br><br><h4>  Doppelte Verwerfung auf Kanalebene </h4><br>  Bei Verwendung der zweiten Methode wird dem Frame ein Feld hinzugef√ºgt, das aus vier Oktetten besteht - RCT (Redundancy Control Trailer).  Ein Trailer wird auf der LRE-Ebene hinzugef√ºgt, wenn der Frame von der obersten Ebene empfangen wird.  RCT besteht aus folgenden Parametern: <br><br><ul><li>  16-Bit-Sequenznummer; </li><li>  4-Bit-Netzwerkkennung, 1010 (0xA) f√ºr LAN A und 1011 (0xB) f√ºr LAN B; </li><li>  12-Bit-Frame-Gr√∂√üe. </li></ul><br>  Aufgrund der Hinzuf√ºgung eines RCT-Anh√§ngers zum Rahmen ist seine Gr√∂√üe gr√∂√üer als die im IEEE 802.3-2005-Standard definierte maximale Rahmengr√∂√üe.  Um Daten innerhalb des Netzwerks mit PRP zu √ºbertragen, muss das Ger√§t so konfiguriert sein, dass Daten in der Gr√∂√üe von 1496 Oktetten √ºbertragen werden.  Aus diesem Grund ist nicht jeder Switch f√ºr die Verwendung in LAN A oder LAN B geeignet. <br><br><img src="https://habrastorage.org/webt/-c/sa/9z/-csa9zpwutrbhyuemwfexrw6xki.png"><br><br>  <i>Rahmen mit hinzugef√ºgtem RCT</i> <br><br>  Jedes Mal, wenn die Verbindungsschicht einen Rahmen an eine bestimmte Adresse sendet, erh√∂ht der Absender die Sequenznummer f√ºr den entsprechenden Knoten und sendet identische Rahmen √ºber beide Schnittstellen. <br><br>  Der empfangende Knoten muss Duplikate basierend auf Informationen aus dem RCT ermitteln. <br><br><h4>  Algorithmus f√ºr doppelte Verwerfungsmethode </h4><br>  Der Empf√§nger geht davon aus, dass Frames, die von einer beliebigen Quelle unter Verwendung des PRP-Protokolls gesendet werden, nacheinander mit einer st√§ndig steigenden Anzahl gesendet werden.  Die f√ºr den n√§chsten Frame erwartete Sequenznummer wird in den Variablen ExpectedSeqA und entsprechend ExpectedSeqB gespeichert. <br><br>  Nach dem Empfang kann die Richtigkeit der Sequenz √ºberpr√ºft werden, indem der Wert von ExpectedSeqA (ExpectedSeqB) mit der Sequenznummer des empfangenen Frames verglichen wird, die in der currentSeq-Variablen in RCT gespeichert ist.  Wenn das Ergebnis positiv ist, wird die Variable ExpectedSeq auf eins mehr als currentSeq gesetzt, damit eine korrekte √úberpr√ºfung dieser Zeile durchgef√ºhrt werden kann. <br><br><img src="https://habrastorage.org/webt/6q/ty/-p/6qty-pwnzatajmck0f9ciyzu4so.png"><br><br>  <i>Frame Drop Interval (Drop-Fenster)</i> <br><br>  F√ºr beide Schnittstellen gibt es ein dynamisches Frame-Drop-Intervall f√ºr die gepaarten Sequenznummern.  Die Obergrenze dieses Intervalls ist ExpectedSeq (die n√§chste erwartete Sequenznummer auf dieser Schnittstelle) ohne den angegebenen Wert selbst, und die Untergrenze dieses Intervalls ist startSeq (die kleinste Sequenznummer, bei der der duplizierte Frame mit dieser Sequenznummer verworfen wird). <br><br>  Nach √úberpr√ºfung der Sequenznummer entscheidet der Empf√§nger, ob der Frame verworfen werden soll oder nicht.  Angenommen, LAN A hat eine Frame-Drop-Intervallgr√∂√üe ungleich Null (Abb. 5).  Ein Frame aus LAN B, dessen Nummer in diesem Intervall liegt, wird verworfen.  Alle anderen Frames aus LAN B werden akzeptiert und an die obere Ebene gesendet. <br><br>  Durch das L√∂schen eines Frames aus LAN B wird die Gr√∂√üe von LAN A verringert, da  Nach dem Empfang dieses Frames werden keine Frames mit einer niedrigeren Nummer auf dieser Schnittstelle erwartet.  Dementsprechend wird startSeqA auf eins mehr als currentSeqB gesetzt.  In diesem Fall wird die Gr√∂√üe des Drop-Intervalls des LAN B-Frames auf 0 zur√ºckgesetzt (startSeqB = expectedSeqB), weil  Offensichtlich befinden sich LAN B-Frames hinter LAN LAN, und es sollten keine Frames von LAN A gel√∂scht werden. <br><br><img src="https://habrastorage.org/webt/px/8a/l5/px8al5_iebz0d8qr-atw4zepiy0.png"><br><br>  <i>Verringern Sie das LAN A-Intervall, nachdem Sie den Frame aus LAN B entfernt haben</i> <br><br>  In der Situation in Fig. 7, wenn mehrere Rahmen von LAN A hintereinander kommen, aber nichts von LAN B kommt, werden sie akzeptiert, weil  Ihr currentSeq liegt au√üerhalb des Verwerfungsintervalls des LAN B-Frames und das LAN A-Intervall wird um eine Position erh√∂ht.  Wenn weiterhin Frames aus LAN A eintreffen, aber noch nichts aus LAN B kommt, erh√∂ht sich startSeqA bei Erreichen der maximalen Intervallgr√∂√üe ebenfalls um eins. <br><br>  Wenn sich der empfangene Frame au√üerhalb des Verwerfungsintervalls des Frames eines anderen LAN befindet, wird dieser Frame gespeichert und die Intervallgr√∂√üe dieser Schnittstelle auf 1 gesetzt. Dies bedeutet, dass nur ein Frame aus einem anderen LAN mit derselben Sequenznummer verworfen wird, w√§hrend das Drop-Fenster der anderen Schnittstelle wird auf 0 gesetzt, was bedeutet, dass keine Frames gel√∂scht werden (Abb. 7). <br><br><img src="https://habrastorage.org/webt/_r/gy/b2/_rgyb2_tufbtbbi3wfr18yqby6a.png"><br><br>  Frame aus LAN B wurde nicht gel√∂scht <br><br>  Die h√§ufigste Situation ist, wenn beide Schnittstellen synchronisiert sind und die Gr√∂√üe beider Intervalle 0 ist (Abb. 8). Dies bedeutet, dass der Frame der Schnittstelle, der zuerst kommt, akzeptiert wird und das Intervall dieser Schnittstelle auf 1 erh√∂ht wird, wodurch der Frame von einer anderen Schnittstelle mit gel√∂scht werden kann gleiche Sequenznummer. <br><br><img src="https://habrastorage.org/webt/x5/sj/n9/x5sjn9q0lxkcg6xbc6jwgzopvpa.png"><br><br>  <i>Synchronisiertes LAN</i> <br><br>  Aufgrund des Vorhandenseins einer LAN-Kennung in RCT unterscheiden sich doppelte Frames um ein Bit (und haben unterschiedliche Pr√ºfsummen).  Der Empf√§nger pr√ºft, ob der Rahmen zur Schnittstelle geh√∂rt (d. H. √úberpr√ºft, ob der Rahmen mit LAN A-Kennung an der Schnittstelle A angekommen ist).  Der Empf√§nger l√§sst diesen Frame nicht fallen, da  Es kann n√ºtzliche Informationen im Datenblock enthalten, aber in diesem Fall wird der Z√§hler cntWrongLanA oder cntWrongLanB um eins erh√∂ht.  Da solche Fehler nicht einmalig sind (verwechselt mit LAN A und LAN B), steigt der Z√§hler st√§ndig an. <br><br><h4>  HSR-Verkehr verbinden </h4><br>  Bei der √úbertragung von Daten innerhalb des HSR-Netzwerks wird jedem Frame ein HSR-Tag hinzugef√ºgt. <br>  Das HSR-Tag besteht aus folgenden Parametern: <br><br><ul><li>  16-Bit-HSR-Ethertyp </li><li>  4-Bit-Pfadanzeige </li><li>  12-Bit-Frame-Gr√∂√üe </li><li>  16-Bit-Sequenznummer </li></ul><br>  Der Absender f√ºgt die gleichen Sequenznummern in die zu sendenden doppelten Frames ein und erh√∂ht dann die Sequenznummer f√ºr jede von diesem Knoten gesendete Nachricht. <br><br>  Der Empf√§nger √ºberwacht die Sequenznummern aller Frames von jeder Quelle, von der er Daten empf√§ngt (er unterscheidet Quellen nach MAC-Adresse).  Wenn Frames aus verschiedenen Zeilen stammen und dieselbe Quell- und Sequenznummer haben, wird einer von ihnen akzeptiert und der zweite verworfen. <br><br>  Zur Steuerung des Netzwerks verwaltet jedes Ger√§t eine Tabelle aller Knoten im Netzwerk, von denen es Daten empf√§ngt.  Auf diese Weise k√∂nnen Sie das Verschwinden von Knoten und Fehler auf dem Bus erkennen. <br><br>  Der Knoten definiert den Frame, den er gesendet hat, nach Quelle und Sequenznummer. <br><br><img src="https://habrastorage.org/webt/0w/al/xj/0walxjqivh2nvo3ae-dr20d7b7e.png"><br><br>  <i>Rahmen mit hinzugef√ºgtem HSR-Tag</i> <br><br>  Ein HSR-Knoten verwirft niemals einen Frame, den er zuvor nicht empfangen hat.  Der Knoten definiert fast alle duplizierten Frames, aber wenn es nur wenige davon gibt, werden sie nicht gel√∂scht, d. H.  Der Rahmen durchl√§uft nur den gesamten Ring und wird auf dem Absender zerst√∂rt. <br><br>  In der Norm ist der Algorithmus zum Bestimmen doppelter Frames nicht definiert.  Als m√∂gliche Methoden k√∂nnen Hash-Tabellen, Warteschlangen und die Verfolgung von Sequenznummern verwendet werden. <br><br><h4>  U-Modus </h4><br>  In diesem Modus zerst√∂rt der Knoten, der den Frame empf√§ngt, das Duplikat und l√§sst es nicht weiter verbreiten.  Wenn der Frame dennoch weiter √ºbertragen wurde, wird er auf den folgenden Knoten zerst√∂rt.  In diesem Modus k√∂nnen Sie den Ring aus dem Unicast-Verkehr entladen. <br><br>  In dem Diagramm zeigen rote Pfeile Pakete mit dem HSR-Tag an, die von Port "A" (im Folgenden - Rahmen "A") gesendet wurden. <br><br>  Gr√ºne Pfeile zeigen Pakete mit einem HSR-Tag an, das von Port "B" (im Folgenden - Rahmen "B") gesendet wird. <br><br>  Leere Pfeile zeigen unterbrochenen Verkehr an, d.h.  Frames, die w√§hrend des normalen Betriebs √ºbertragen w√ºrden, aber in diesem Modus, wurden verworfen. <br>  Das Kreuz zeigt an, dass der Verkehr (auf jeden Fall) aus dem Ring entfernt wurde. <br><br><img src="https://habrastorage.org/webt/sk/yk/14/skyk14uoacfn9l4y1hcdnvvytwe.png"><br><br><h4>  X-Modus </h4><br>  In diesem Modus leitet der Knoten den Rahmen nicht weiter weiter und verwirft ihn, wenn ein solcher Rahmen aus einer anderen Richtung empfangen wurde. <br><br>  Zum Beispiel leitet DAN 1 im Bild den Rahmen "B" nicht weiter weiter, weil  Er hat bereits den Rahmen "A" empfangen, und DAN 2 wird den Rahmen "A" nicht weiter senden, weil  bereits empfangener Rahmen "B". <br><br>  Falls irgendwo im Algorithmus ein Fehler aufgetreten ist und die Frames weiter √ºbertragen wurden, werden sie auf den folgenden Knoten oder auf dem Knoten, auf dem sie erstellt wurden, verworfen. <br><br>  Der X-Modus gilt nicht f√ºr PTP-Nachrichten und f√ºr die √úberwachung von √úberwachungsrahmen. <br><br><img src="https://habrastorage.org/webt/tn/jk/ih/tnjkihj4soziqhacnpxdfh7soeo.png"><br><br><h3>  Netzwerksteuerung </h3><br><h4>  PRP </h4><br>  Der Empf√§nger pr√ºft, ob alle Frames nacheinander ankommen und auf beiden Kan√§len korrekt empfangen werden.  Es unterst√ºtzt Fehlerz√§hler, die beispielsweise √ºber SNMP gelesen werden k√∂nnen. <br><br>  Alle Ger√§te unterst√ºtzen Knotentabellen, mit denen sie Daten austauschen.  Diese Tabellen enthalten Informationen √ºber den Zeitpunkt, zu dem der letzte Frame von einem bestimmten Knoten gesendet oder empfangen wurde, sowie weitere Informationen zum PRP-Protokoll. <br><br>  Gleichzeitig erm√∂glichen diese Tabellen das Erkennen von Verbindungen, bei denen Sequenznummern synchronisiert werden m√ºssen, sowie das Erkennen unterbrochener Sequenzen und fehlender Knoten. <br><br>  Die Diagnose basiert auf der Tatsache, dass jeder DAN regelm√§√üig einen Diagnoserahmen (√úberwachungsrahmen) sendet, mit dem Sie die Integrit√§t des Netzwerks und das Vorhandensein von Knoten √ºberpr√ºfen k√∂nnen.  Gleichzeitig k√∂nnen Sie mit diesen Frames √ºberpr√ºfen, welche Ger√§te als DANs fungieren, ihre MAC-Adressen ermitteln und in welchem ‚Äã‚ÄãModus sie funktionieren - doppeltes Akzeptieren oder doppeltes Verwerfen. <br><br><h4>  Hsr </h4><br>  Jeder Knoten √ºberpr√ºft st√§ndig alle Verbindungen. <br><br>  Jeder Knoten sendet regelm√§√üig einen Diagnoserahmen (an beide Ports), der Informationen √ºber den Status des Knotens enth√§lt.  Dieser Frame wird von allen Knoten einschlie√ülich des Absenders akzeptiert.  Wenn der Absender eine eigene Diagnosemeldung erh√§lt, wird eine √úberpr√ºfung der Integrit√§t des physischen Kanals durchgef√ºhrt. <br><br>  Das Intervall zum Senden eines Diagnoserahmens ist relativ gro√ü (einige Sekunden), weil  Es ist nicht erforderlich, Redundanz bereitzustellen, sondern nur f√ºr Diagnosezwecke. <br><br>  Alle Knoten werden in die Tabelle aller gefundenen Partner eingetragen, und die Zeit wird aufgezeichnet, als der Knoten zuletzt aktiv war, sowie alle fehlenden Frames und Frames, die nicht nacheinander gesendet wurden. <br><br>  Alle aufgetretenen Topologie√§nderungen werden ebenfalls protokolliert und alle Informationen k√∂nnen √ºber SNMP abgerufen werden. <br><br>  HSR und PRP: Vor- und Nachteile <br><br><img src="https://habrastorage.org/webt/90/zj/xf/90zjxfixfn8ixq80tbqdf8s4lem.png"><br><br><h4>  Fazit </h4><br>  Dies bedeutet nicht, dass ein Protokoll besser ist als ein anderes - sie sind ein wenig f√ºr verschiedene Anwendungen konzipiert.  Sowohl HSR als auch PRP erm√∂glichen eine nahtlose Netzwerkredundanz. Mit HSR k√∂nnen Sie jedoch kosteng√ºnstigere L√∂sungen erstellen.  Eine solche Rentabilit√§t bringt jedoch Schwierigkeiten mit sich, weil  Ein HSR-basiertes Netzwerk ist schwer zu skalieren und Anwendungen sind nicht sehr flexibel.  Eine geringe Flexibilit√§t wird durch eine begrenzte Topologie (Ring, Paarung von Ringen) sowie eine schlechte Kompatibilit√§t des Protokolls mit anderen Technologien verursacht.  Daher eignet sich HSR besser f√ºr die Redundanz kleiner Systeme und die Integration in ein gro√ües Netzwerk.  Eine HSR-basierte Sicherung des gesamten Netzwerks ist problematisch.  PRP ist wiederum eine teurere L√∂sung, erm√∂glicht es Ihnen jedoch, ein ziemlich gro√ües Netzwerk zu organisieren, das in Zukunft problemlos erweitert werden kann, weil<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dieses Protokoll erm√∂glicht die bequeme Integration nahezu jeder Technologie und die Implementierung v√∂llig unterschiedlicher Topologien. </font></font><br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Finden Sie eine L√∂sung</font></font></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de443248/">https://habr.com/ru/post/de443248/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de443238/index.html">Wie man sich nicht in eine Libelle verwandelt, wenn man viele verschiedene Datenbanken hat</a></li>
<li><a href="../de443240/index.html">Q-Learning verstehen, das Problem ‚ÄûAuf einem Felsen gehen‚Äú</a></li>
<li><a href="../de443242/index.html">Quarkus ist ein subatomares √úberschall-Java. Ein kurzer √úberblick √ºber das Framework</a></li>
<li><a href="../de443244/index.html">Nachbesprechungsaufgaben. Beanpoisk_1</a></li>
<li><a href="../de443246/index.html">Wie wir Askozia IP PBX neu erfunden haben, nachdem das Projekt vom Entwickler verkauft und geschlossen wurde</a></li>
<li><a href="../de443252/index.html">Modulare Ant Bots mit Speicher</a></li>
<li><a href="../de443254/index.html">Triton ist das t√∂dlichste Virus</a></li>
<li><a href="../de443256/index.html">PowerShell, Dump meiner Erfahrung</a></li>
<li><a href="../de443258/index.html">Gotify - ein Open Source-Projekt zum √úbermitteln von Benachrichtigungen und zum Senden von Nachrichten an den Server</a></li>
<li><a href="../de443260/index.html">Migrieren Sie nach Zimbra, ohne das Gesch√§ft mit einer gemeinsamen Domain zu riskieren</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>