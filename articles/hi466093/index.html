<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ЁЯУд ЁЯХ┤ЁЯП╛ ЁЯЩЗЁЯП╗ рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ kubectl? ЁЯН╛ ЁЯСйтАНЁЯН│ ЁЯОЯя╕П</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="рд▓рдЧрднрдЧред рдЯреНрд░рд╛рдВрд╕ред : рд▓реЗрдЦ рдХреЗ рд▓реЗрдЦрдХ - рдПрд░рдХрд╛рди рдПрд░реЛрд▓, рдПрд╕рдПрдкреА рдХреЗ рдПрдХ рдЗрдВрдЬреАрдирд┐рдпрд░ - kubectl exec рдЯреАрдо рдХреЗ рдХрд╛рдордХрд╛рдЬ рддрдВрддреНрд░ рдХреЗ рдЕрдкрдиреЗ рдЕрдзреНрдпрдпрди рдХреЛ рд╕рд╛рдЭрд╛ рдХрд░рддреЗ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рдХреБрдмреЗрд░рдиреЗрдЯреНрд╕ рдХреЗ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ kubectl?</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/flant/blog/466093/"> <i><b>рд▓рдЧрднрдЧред</b></i>  <i><b>рдЯреНрд░рд╛рдВрд╕ред</b></i>  <i>: рд▓реЗрдЦ рдХреЗ рд▓реЗрдЦрдХ - рдПрд░рдХрд╛рди рдПрд░реЛрд▓, рдПрд╕рдПрдкреА рдХреЗ рдПрдХ рдЗрдВрдЬреАрдирд┐рдпрд░ - <code>kubectl exec</code> рдЯреАрдо рдХреЗ рдХрд╛рдордХрд╛рдЬ рддрдВрддреНрд░ рдХреЗ рдЕрдкрдиреЗ рдЕрдзреНрдпрдпрди рдХреЛ рд╕рд╛рдЭрд╛ рдХрд░рддреЗ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рдХреБрдмреЗрд░рдиреЗрдЯреНрд╕ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рд╕рднреА рд▓реЛрдЧреЛрдВ рд╕реЗ рдкрд░рд┐рдЪрд┐рдд рд╣реИрдВред</i>  <i>рд╡рд╣ рдХреБрдмреЗрд░рдиреЗрдЯреНрд╕ рд╕реНрд░реЛрдд рдХреЛрдб (рдФрд░ рд╕рдВрдмрдВрдзрд┐рдд рдкрд░рд┐рдпреЛрдЬрдирд╛рдУрдВ) рдХреА рд▓рд┐рд╕реНрдЯрд┐рдВрдЧ рдХреЗ рд╕рд╛рде рдкреВрд░реЗ рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рдХрд╛ рд╕рд╛рде рджреЗрддрд╛ рд╣реИ, рдЬреЛ рдЖрдкрдХреЛ рд╡рд┐рд╖рдп рдХреЛ рдЬрд┐рддрдирд╛ рд╕рдВрднрд╡ рд╣реЛ рдЙрддрдирд╛ рдЧрд╣рд░рд╛ рд╕рдордЭрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред</i> <br><br><img src="https://habrastorage.org/webt/z7/je/ja/z7jejaxnf5kisqkvemay56t6_pe.png"><br><br>  рдПрдХ рд╢реБрдХреНрд░рд╡рд╛рд░, рдПрдХ рд╕рд╣рдХрд░реНрдореА рдореЗрд░реЗ рдкрд╛рд╕ рдЖрдпрд╛ рдФрд░ рдкреВрдЫрд╛ рдХрд┐ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдХреНрд▓рд╛рдЗрдВрдЯ-рдЧреЛ</a> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреЙрдб рдореЗрдВ рдХрдорд╛рдВрдб рдХреИрд╕реЗ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░реЗрдВред  рдореИрдВ рдЙрд╕реЗ рдЬрд╡рд╛рдм рдирд╣реАрдВ рджреЗ рд╕рдХрд╛ рдФрд░ рдЕрдЪрд╛рдирдХ рдорд╣рд╕реВрд╕ рдХрд┐рдпрд╛ рдХрд┐ рдореБрдЭреЗ <code>kubectl exec</code> рдХреЗ рдХрд╛рдо рдХреЗ рддрдВрддреНрд░ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдХреБрдЫ рднреА рдирд╣реАрдВ рдкрддрд╛ рд╣реИред  рд╣рд╛рдВ, рдореБрдЭреЗ рдЗрд╕рдХреЗ рдбрд┐рд╡рд╛рдЗрд╕ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдХреБрдЫ рд╡рд┐рдЪрд╛рд░ рдереЗ, рд▓реЗрдХрд┐рди рдореИрдВ рдЙрдирдХреА рд╢реБрджреНрдзрддрд╛ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ 100% рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдирд╣реАрдВ рдерд╛ рдФрд░ рдЗрд╕рд▓рд┐рдП рдЗрд╕ рдореБрджреНрджреЗ рд╕реЗ рдирд┐рдкрдЯрдиреЗ рдХрд╛ рдлреИрд╕рд▓рд╛ рдХрд┐рдпрд╛ред  рдмреНрд▓реЙрдЧ, рдкреНрд░рд▓реЗрдЦрди рдФрд░ рд╕реНрд░реЛрдд рдХреЛрдб рдХрд╛ рдЕрдзреНрдпрдпрди рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж, рдореИрдВрдиреЗ рдмрд╣реБрдд рд╕реА рдирдИ рдЪреАрдЬреЗрдВ рд╕реАрдЦреАрдВ, рдФрд░ рдЗрд╕ рд▓реЗрдЦ рдореЗрдВ рдореИрдВ рдЕрдкрдиреА рдЦреЛрдЬреЛрдВ рдФрд░ рд╕рдордЭ рдХреЛ рд╕рд╛рдЭрд╛ рдХрд░рдирд╛ рдЪрд╛рд╣рддрд╛ рд╣реВрдВред  рдЕрдЧрд░ рдХреБрдЫ рдЧрд▓рдд рд╣реИ, рддреЛ рдХреГрдкрдпрд╛ рдореБрдЭреЗ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЯреНрд╡рд┐рдЯрд░</a> рдкрд░ рд╕рдВрдкрд░реНрдХ рдХрд░реЗрдВред <a name="habracut"></a><br><br><h2>  рдЯреНрд░реЗрдирд┐рдВрдЧ </h2><br>  рдореИрдХрдмреБрдХ рдкрд░ рдПрдХ рдХреНрд▓рд╕реНрдЯрд░ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП, рдореИрдВрдиреЗ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">ecomm-рдПрдХреАрдХрд░рдг-рдмреИрд▓реЗрд░реАрдирд╛ / рдХреБрдмреЗрд░рдиреЗрдЯреНрд╕-рдХреНрд▓рд╕реНрдЯрд░ рдХреЛ рдХреНрд▓реЛрди рдХрд┐рдпрд╛</a> ред  рдлрд┐рд░ рдЙрдиреНрд╣реЛрдВрдиреЗ рдХреНрдпреВрдмрд▓реЗрдЯ рдХреЙрдиреНрдлрд┐рдЧ рдореЗрдВ рдиреЛрдбреНрд╕ рдХреЗ рдЖрдИрдкреА рдкрддреЗ рдХреЛ рд╕рд╣реА рдХрд┐рдпрд╛, рдХреНрдпреЛрдВрдХрд┐ рдбрд┐рдлреЙрд▓реНрдЯ рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдиреЗ <code>kubectl exec</code> рдХреЛ <code>kubectl exec</code> рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдирд╣реАрдВ рджреА рдереАред  рдЗрд╕рдХреЗ рдореБрдЦреНрдп рдХрд╛рд░рдг рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЖрдк рдпрд╣рд╛рдБ рдкрдврд╝ рд╕рдХрддреЗ рд╣реИрдВред <br><br><ul><li>  рдХреЛрдИ рднреА рдХрд╛рд░ = рдореЗрд░реА рдореИрдХрдмреБрдХ </li><li>  рдорд╛рд╕реНрдЯрд░ рдЖрдИрдкреА = 192.168.205.10 </li><li>  рдХрд╛рд░реНрдпрдХрд░реНрддрд╛ рдореЗрдЬрдмрд╛рди рдЖрдИрдкреА = 192.168.205.11 </li><li>  рдПрдкреАрдЖрдИ рд╕рд░реНрд╡рд░ рдкреЛрд░реНрдЯ = 6443 </li></ul><br><h2>  рдШрдЯрдХреЛрдВ </h2><br><img src="https://habrastorage.org/webt/of/q5/dv/ofq5dvsbuqvr8bp6gryhxsficfk.png"><br><br><ul><li>  <b>kubectl рдирд┐рд╖реНрдкрд╛рджрди рдкреНрд░рдХреНрд░рд┐рдпрд╛</b> : рдЬрдм рд╣рдо "kubectl рдирд┐рд╖реНрдкрд╛рджрд┐рдд ..." рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╢реБрд░реВ рд╣реЛрддреА рд╣реИред  рдЖрдк K8s API рд╕рд░реНрд╡рд░ рддрдХ рдкрд╣реБрдВрдЪ рдХреЗ рд╕рд╛рде рдХрд┐рд╕реА рднреА рдорд╢реАрди рдкрд░ рдРрд╕рд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  <i>рд▓рдЧрднрдЧред</i>  <i>рдЯреНрд░рд╛рдВрд╕ред: рдЖрдЧреЗ рдХрдВрд╕реЛрд▓ рд▓рд┐рд╕реНрдЯрд┐рдВрдЧ рдореЗрдВ, рд▓реЗрдЦрдХ рдЯрд┐рдкреНрдкрдгреА "рдХрд┐рд╕реА рднреА рдорд╢реАрди" рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рдХрд╛ рдЕрд░реНрде рд╣реИ рдХрд┐ рдмрд╛рдж рдХреЗ рдЖрджреЗрд╢реЛрдВ рдХреЛ рдХреБрдмреЗрд░рдиреЗрдЯреНрд╕ рддрдХ рдкрд╣реБрдВрдЪ рдХреЗ рд╕рд╛рде рдРрд╕реА рдХрд┐рд╕реА рднреА рдорд╢реАрди рдкрд░ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред</i> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><b>рдПрдкреАрдЖрдИ рд╕рд░реНрд╡рд░</b></a> : рдорд╛рд╕реНрдЯрд░ рдкрд░ рдПрдХ рдШрдЯрдХ рдЬреЛ рдХреБрдмреЗрд░рдиреЗрдЯреНрд╕ рдПрдкреАрдЖрдИ рддрдХ рдкрд╣реБрдВрдЪ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред  рдпрд╣ рдХреБрдмреЗрд░рдиреЗрдЯреНрд╕ рдореЗрдВ рдирд┐рдпрдВрддреНрд░рдг рд╡рд┐рдорд╛рди рдХреЗ рд▓рд┐рдП рджреГрд╢реНрдпрдкрдЯрд▓ рд╣реИред </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><b>рдХреНрдпреВрдмрд▓реЗрдЯ</b></a> : рдПрдХ рдПрдЬреЗрдВрдЯ рдЬреЛ рдХреНрд▓рд╕реНрдЯрд░ рдореЗрдВ рдкреНрд░рддреНрдпреЗрдХ рдиреЛрдб рдкрд░ рдЪрд▓рддрд╛ рд╣реИред  рдпрд╣ рдлрд▓реА рдореЗрдВ рдХрдВрдЯреЗрдирд░ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><b>рдХрдВрдЯреЗрдирд░ рд░рдирдЯрд╛рдЗрдо</b></a> ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><b>рдХрдВрдЯреЗрдирд░ рд░рдирдЯрд╛рдЗрдо</b></a> ): рдХрдВрдЯреЗрдирд░ рдХреЗ рд╕рдВрдЪрд╛рд▓рди рдХреЗ рд▓рд┐рдП рдЬрд┐рдореНрдореЗрджрд╛рд░ рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ред  рдЙрджрд╛рд╣рд░рдг: рдбреЙрдХрд░, CRI-O, рдХрдВрдЯреЗрдирдб ... </li><li>  <b>рдХрд░реНрдиреЗрд▓</b> : рдУрдПрд╕ рдХрд░реНрдиреЗрд▓ рдХрд╛рдо рдиреЛрдб рдкрд░;  рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдкреНрд░рдмрдВрдзрди рдХреЗ рд▓рд┐рдП рдЬрд┐рдореНрдореЗрджрд╛рд░ред </li><li>  <b>рд▓рдХреНрд╖реНрдп</b> <b>рдХрдВрдЯреЗрдирд░</b> : рдПрдХ рдХрдВрдЯреЗрдирд░ рдЬреЛ рдПрдХ рдлрд▓реА рдХрд╛ рд╣рд┐рд╕реНрд╕рд╛ рд╣реЛрддрд╛ рд╣реИ рдФрд░ рдПрдХ рдХрд╛рдо рдиреЛрдб рдкрд░ рд╕рдВрдЪрд╛рд▓рд┐рдд рд╣реЛрддрд╛ рд╣реИред </li></ul><br><h2>  рдореИрдВрдиреЗ рдХреНрдпрд╛ рдЦреЛрдЬрд╛ </h2><br><h3>  1. рдЧреНрд░рд╛рд╣рдХ рдкрдХреНрд╖ рдЧрддрд┐рд╡рд┐рдзрд┐ </h3><br>  <code>default</code> рдирд╛рдо рд╕реНрдерд╛рди рдореЗрдВ рдПрдХ рдкреЙрдб рдмрдирд╛рдПрдВ: <br><br><pre> <code class="bash hljs">// any machine $ kubectl run <span class="hljs-built_in"><span class="hljs-built_in">exec</span></span>-test-nginx --image=nginx</code> </pre> <br>  рдлрд┐рд░ рд╣рдо рдирд┐рд╖реНрдкрд╛рджрди рдХрдорд╛рдВрдб рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рддреЗ рд╣реИрдВ рдФрд░ рдЖрдЧреЗ рдХреА рдЯрд┐рдкреНрдкрдгрд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП 5000 рд╕реЗрдХрдВрдб рддрдХ рдкреНрд░рддреАрдХреНрд╖рд╛ рдХрд░рддреЗ рд╣реИрдВ: <br><br><pre> <code class="bash hljs">// any machine $ kubectl <span class="hljs-built_in"><span class="hljs-built_in">exec</span></span> -it <span class="hljs-built_in"><span class="hljs-built_in">exec</span></span>-test-nginx-6558988d5-fgxgg -- sh <span class="hljs-comment"><span class="hljs-comment"># sleep 5000</span></span></code> </pre> <br>  рдХреБрдмреНрдЬреЗрд▓ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдкреНрд░рдХрдЯ рд╣реЛрддреА рд╣реИ (рд╣рдорд╛рд░реЗ рдорд╛рдорд▓реЗ рдореЗрдВ pid = 8507 рдХреЗ рд╕рд╛рде): <br><br><pre> <code class="bash hljs">// any machine $ ps -ef |grep kubectl 501 8507 8409 0 7:19PM ttys000 0:00.13 kubectl <span class="hljs-built_in"><span class="hljs-built_in">exec</span></span> -it <span class="hljs-built_in"><span class="hljs-built_in">exec</span></span>-test-nginx-6558988d5-fgxgg -- sh</code> </pre> <br>  рдпрджрд┐ рд╣рдо рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреА рдиреЗрдЯрд╡рд░реНрдХ рдЧрддрд┐рд╡рд┐рдзрд┐ рдХреА рдЬрд╛рдВрдЪ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рд╣рдо рдкрд╛рддреЗ рд╣реИрдВ рдХрд┐ рдЗрд╕рдореЗрдВ рдПрдкреА-рд╕рд░реНрд╡рд░ (192.168.205.10.6443) рдХреЗ рдХрдиреЗрдХреНрд╢рди рд╣реИрдВ: <br><br><pre> <code class="bash hljs">// any machine $ netstat -atnv |grep 8507 tcp4 0 0 192.168.205.1.51673 192.168.205.10.6443 ESTABLISHED 131072 131768 8507 0 0x0102 0x00000020 tcp4 0 0 192.168.205.1.51672 192.168.205.10.6443 ESTABLISHED 131072 131768 8507 0 0x0102 0x00000028</code> </pre> <br>  рдХреЛрдб рдХреЛ рджреЗрдЦрддреЗ рд╣реИрдВред  Kubectl рдирд┐рд╖реНрдкрд╛рджрдХ рд╕рдм-рд╕реЛрд░реНрд╕ рдХреЗ рд╕рд╛рде рдПрдХ POST рдЕрдиреБрд░реЛрдз рдмрдирд╛рддрд╛ рд╣реИ рдФрд░ рдПрдХ REST рдЕрдиреБрд░реЛрдз рднреЗрдЬрддрд╛ рд╣реИ: <br><br><pre> <code class="go hljs"> req := restClient.Post(). Resource(<span class="hljs-string"><span class="hljs-string">"pods"</span></span>). Name(pod.Name). Namespace(pod.Namespace). SubResource(<span class="hljs-string"><span class="hljs-string">"exec"</span></span>) req.VersionedParams(&amp;corev1.PodExecOptions{ Container: containerName, Command: p.Command, Stdin: p.Stdin, Stdout: p.Out != <span class="hljs-literal"><span class="hljs-literal">nil</span></span>, Stderr: p.ErrOut != <span class="hljs-literal"><span class="hljs-literal">nil</span></span>, TTY: t.Raw, }, scheme.ParameterCodec) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> p.Executor.Execute(<span class="hljs-string"><span class="hljs-string">"POST"</span></span>, req.URL(), p.Config, p.In, p.Out, p.ErrOut, t.Raw, sizeQueue)</code> </pre> <br>  <i>( <a href="">kubectl / pkg / cmd / рдирд┐рд╖реНрдкрд╛рджрд┐рдд / рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░реЗрдВ</a> )</i> <br><br><img src="https://habrastorage.org/webt/og/nn/cg/ognncgumyrwb7cr6l8wq5alo2je.png"><br><h3>  2. рдорд╛рд╕реНрдЯрд░ рдиреЛрдб рдХреЗ рдХрд┐рдирд╛рд░реЗ рдЧрддрд┐рд╡рд┐рдзрд┐ </h3><br>  рд╣рдо рдПрдкреАрдЖрдИ-рд╕рд░реНрд╡рд░ рд╕рд╛рдЗрдб рдкрд░ рдЕрдиреБрд░реЛрдз рдХрд╛ рднреА рдирд┐рд░реАрдХреНрд╖рдг рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: <br><br><pre> <code class="bash hljs">handler.go:143] kube-apiserver: POST <span class="hljs-string"><span class="hljs-string">"/api/v1/namespaces/default/pods/exec-test-nginx-6558988d5-fgxgg/exec"</span></span> satisfied by gorestful with webservice /api/v1 upgradeaware.go:261] Connecting to backend proxy (intercepting redirects) https://192.168.205.11:10250/<span class="hljs-built_in"><span class="hljs-built_in">exec</span></span>/default/<span class="hljs-built_in"><span class="hljs-built_in">exec</span></span>-test-nginx-6558988d5-fgxgg/<span class="hljs-built_in"><span class="hljs-built_in">exec</span></span>-test-nginx?<span class="hljs-built_in"><span class="hljs-built_in">command</span></span>=sh&amp;input=1&amp;output=1&amp;tty=1 Headers: map[Connection:[Upgrade] Content-Length:[0] Upgrade:[SPDY/3.1] User-Agent:[kubectl/v1.12.10 (darwin/amd64) kubernetes/e3c1340] X-Forwarded-For:[192.168.205.1] X-Stream-Protocol-Version:[v4.channel.k8s.io v3.channel.k8s.io v2.channel.k8s.io channel.k8s.io]]</code> </pre> <br>  <i>рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ HTTP рдЕрдиреБрд░реЛрдз рдореЗрдВ рдПрдХ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдкрд░рд┐рд╡рд░реНрддрди рдЕрдиреБрд░реЛрдз рд╢рд╛рдорд┐рд▓ рд╣реИред</i>  <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">SPDY</a> рдЖрдкрдХреЛ рдПрдХрд▓ рдЯреАрд╕реАрдкреА рдХрдиреЗрдХреНрд╢рди рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╡реНрдпрдХреНрддрд┐рдЧрдд рд╕реНрдЯрдб / stdout / stderr / spdy-error рдзрд╛рд░рд╛рдУрдВ рдХреЛ рдорд▓реНрдЯреАрдкреНрд▓реЗрдХреНрд╕ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред</i> <br><br>  API рд╕рд░реНрд╡рд░ рдЕрдиреБрд░реЛрдз рдкреНрд░рд╛рдкреНрдд рдХрд░рддрд╛ рд╣реИ рдФрд░ рдЗрд╕реЗ <code>PodExecOptions</code> рдкрд░рд┐рд╡рд░реНрддрд┐рдд рдХрд░рддрд╛ рд╣реИ: <br><br><pre> <code class="go hljs"><span class="hljs-comment"><span class="hljs-comment">// PodExecOptions is the query options to a Pod's remote exec call type PodExecOptions struct { metav1.TypeMeta // Stdin if true indicates that stdin is to be redirected for the exec call Stdin bool // Stdout if true indicates that stdout is to be redirected for the exec call Stdout bool // Stderr if true indicates that stderr is to be redirected for the exec call Stderr bool // TTY if true indicates that a tty will be allocated for the exec call TTY bool // Container in which to execute the command. Container string // Command is the remote command to execute; argv array; not executed within a shell. Command []string }</span></span></code> </pre> <br>  <i>( <a href="">pkg / рдПрдкрд┐рд╕ / рдХреЛрд░ / type.go</a> )</i> <br><br>  рдЖрд╡рд╢реНрдпрдХ рдХрд╛рд░реНрд░рд╡рд╛рдИ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдПрдкреАрдЖрдИ-рд╕рд░реНрд╡рд░ рдХреЛ рдпрд╣ рдкрддрд╛ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП рдХрд┐ рдЙрд╕реЗ рдХрд┐рд╕ рдкреЙрдб рд╕реЗ рд╕рдВрдкрд░реНрдХ рдХрд░рдирд╛ рд╣реИ: <br><br><pre> <code class="go hljs"><span class="hljs-comment"><span class="hljs-comment">// ExecLocation returns the exec URL for a pod container. If opts.Container is blank // and only one container is present in the pod, that container is used. func ExecLocation( getter ResourceGetter, connInfo client.ConnectionInfoGetter, ctx context.Context, name string, opts *api.PodExecOptions, ) (*url.URL, http.RoundTripper, error) { return streamLocation(getter, connInfo, ctx, name, opts, opts.Container, "exec") }</span></span></code> </pre> <br>  <i>( <a href="">pkg / рд░рдЬрд┐рд╕реНрдЯреНрд░реА / рдХреЛрд░ / рдкреЙрдб / strategy.go</a> )</i> <br><br>  рдмреЗрд╢рдХ, рд╕рдорд╛рдкрди рдмрд┐рдВрджреБ рдбреЗрдЯрд╛ рд╣реЛрд╕реНрдЯ рдЬрд╛рдирдХрд╛рд░реА рд╕реЗ рд▓рд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ: <br><br><pre> <code class="go hljs"> nodeName := types.NodeName(pod.Spec.NodeName) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-built_in"><span class="hljs-built_in">len</span></span>(nodeName) == <span class="hljs-number"><span class="hljs-number">0</span></span> { <span class="hljs-comment"><span class="hljs-comment">// If pod has not been assigned a host, return an empty location return nil, nil, errors.NewBadRequest(fmt.Sprintf("pod %s does not have a host assigned", name)) } nodeInfo, err := connInfo.GetConnectionInfo(ctx, nodeName)</span></span></code> </pre> <br>  <i>( <a href="">pkg / рд░рдЬрд┐рд╕реНрдЯреНрд░реА / рдХреЛрд░ / рдкреЙрдб / strategy.go</a> )</i> <br><br>  рд╣реБрд░реНрд░реЗ!  рдЕрдм рдХреНрдпреВрдмрд▓реЗрдЯ рдореЗрдВ рдПрдХ рдкреЛрд░реНрдЯ ( <code>node.Status.DaemonEndpoints.KubeletEndpoint.Port</code> ) рд╣реИ, рдЬрд┐рд╕рд╕реЗ API рд╕рд░реНрд╡рд░ рдХрдиреЗрдХреНрдЯ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ: <br><br><pre> <code class="go hljs"><span class="hljs-comment"><span class="hljs-comment">// GetConnectionInfo retrieves connection info from the status of a Node API object. func (k *NodeConnectionInfoGetter) GetConnectionInfo(ctx context.Context, nodeName types.NodeName) (*ConnectionInfo, error) { node, err := k.nodes.Get(ctx, string(nodeName), metav1.GetOptions{}) if err != nil { return nil, err } // Find a kubelet-reported address, using preferred address type host, err := nodeutil.GetPreferredNodeAddress(node, k.preferredAddressTypes) if err != nil { return nil, err } // Use the kubelet-reported port, if present port := int(node.Status.DaemonEndpoints.KubeletEndpoint.Port) if port &lt;= 0 { port = k.defaultPort } return &amp;ConnectionInfo{ Scheme: k.scheme, Hostname: host, Port: strconv.Itoa(port), Transport: k.transport, }, nil }</span></span></code> </pre> <br>  <i>( <a href="">pkg / kubelet / рдЧреНрд░рд╛рд╣рдХ / kubelet_client.go</a> )</i> <br><br><blockquote>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдорд╛рд╕реНрдЯрд░-рдиреЛрдб рдХрдореНрдпреБрдирд┐рдХреЗрд╢рди</a> рдХреЗ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рд╕реЗ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">&gt; рдорд╛рд╕реНрдЯрд░ рд╕реЗ рдХреНрд▓рд╕реНрдЯрд░&gt; рдПрдкреНрд╕реЗрд╡рд░ рд╕реЗ рдХреНрдпреВрдмрд▓реЗрдЯ</a> : <br><br>  рдпреЗ рдХрдиреЗрдХреНрд╢рди рдХреНрдпреВрдмрд▓реЗрдЯ рдХреЗ HTTPS рд╕рдорд╛рдкрди рдмрд┐рдВрджреБ рдкрд░ рдмрдВрдж рд╣реИрдВред  рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ, рдПрдкрд┐рд╕реНрд╡рд░, рдХреНрдпреВрдмрд▓реЗрдЯ рдХреЗ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдХреЛ рд╕рддреНрдпрд╛рдкрд┐рдд рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ, рдЬреЛ рдХрдиреЗрдХреНрд╢рди рдХреЛ "рдордзреНрдпрд╕реНрде рд╣рдорд▓реЛрдВ" (MITMs) рдХреЗ рд▓рд┐рдП <i><b>рдЕрд╕реБрд░рдХреНрд╖рд┐рдд</b></i> рдмрдирд╛рддрд╛ рд╣реИ рдФрд░ рдЕрд╡рд┐рд╢реНрд╡рд╕рдиреАрдп рдФрд░ / рдпрд╛ рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдиреЗрдЯрд╡рд░реНрдХ рдкрд░ рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП <i><b>рдЕрд╕реБрд░рдХреНрд╖рд┐рдд</b></i> рд╣реИред </blockquote><br>  рдЕрдм API рд╕рд░реНрд╡рд░ рдПрдВрдбрдкреЙрдЗрдВрдЯ рдХреЛ рдЬрд╛рдирддрд╛ рд╣реИ рдФрд░ рдПрдХ рдХрдиреЗрдХреНрд╢рди рд╕реНрдерд╛рдкрд┐рдд рдХрд░рддрд╛ рд╣реИ: <br><br><pre> <code class="go hljs"><span class="hljs-comment"><span class="hljs-comment">// Connect returns a handler for the pod exec proxy func (r *ExecREST) Connect(ctx context.Context, name string, opts runtime.Object, responder rest.Responder) (http.Handler, error) { execOpts, ok := opts.(*api.PodExecOptions) if !ok { return nil, fmt.Errorf("invalid options object: %#v", opts) } location, transport, err := pod.ExecLocation(r.Store, r.KubeletConn, ctx, name, execOpts) if err != nil { return nil, err } return newThrottledUpgradeAwareProxyHandler(location, transport, false, true, true, responder), nil }</span></span></code> </pre> <br>  <i>( <a href="">pkg / рд░рдЬрд┐рд╕реНрдЯреНрд░реА / рдХреЛрд░ / рдкреЙрдб / рд░реЗрд╕реНрдЯ / рд╕рдм-рд╕реЛрд░реНрд╕.go</a> )</i> <br><br>  рдЖрдЗрдП рджреЗрдЦреЗрдВ рдХрд┐ рдорд╛рд╕реНрдЯрд░ рдиреЛрдб рдкрд░ рдХреНрдпрд╛ рд╣реЛрддрд╛ рд╣реИред <br><br>  рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ рд╣рдо рдХрд╛рдо рдХрд░ рд░рд╣реЗ рдиреЛрдб рдХрд╛ рдЖрдИрдкреА рдкрддрд╛ рдХрд░рддреЗ рд╣реИрдВред  рд╣рдорд╛рд░реЗ рдорд╛рдорд▓реЗ рдореЗрдВ, рдпрд╣ 192.168.205.11 рд╣реИ: <br><br><pre> <code class="bash hljs">// any machine $ kubectl get nodes k8s-node-1 -o wide NAME STATUS ROLES AGE VERSION INTERNAL-IP EXTERNAL-IP OS-IMAGE KERNEL-VERSION CONTAINER-RUNTIME k8s-node-1 Ready &lt;none&gt; 9h v1.15.3 192.168.205.11 &lt;none&gt; Ubuntu 16.04.6 LTS 4.4.0-159-generic docker://17.3.3</code> </pre> <br>  рдлрд┐рд░ рдХреНрдпреВрдмрд▓реЗрдЯ рдкреЛрд░реНрдЯ рд╕реНрдерд╛рдкрд┐рдд рдХрд░реЗрдВ (рд╣рдорд╛рд░реЗ рдорд╛рдорд▓реЗ рдореЗрдВ 10250): <br><br><pre> <code class="bash hljs">// any machine $ kubectl get nodes k8s-node-1 -o jsonpath=<span class="hljs-string"><span class="hljs-string">'{.status.daemonEndpoints.kubeletEndpoint}'</span></span> map[Port:10250]</code> </pre> <br>  рдЕрдм рдиреЗрдЯрд╡рд░реНрдХ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХрд╛ рд╕рдордп рдЖ рдЧрдпрд╛ рд╣реИред  рдХреНрдпрд╛ рдХрд╛рд░реНрдп рдиреЛрдб (192.168.205.11) рд╕реЗ рдХреЛрдИ рд╕рдВрдмрдВрдз рд╣реИ?  рдпрд╣ рд╡рд╣рд╛рдБ рд╣реИ!  рдпрджрд┐ рдЖрдк <code>exec</code> рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рдорд╛рд░рддреЗ рд╣реИрдВ, рддреЛ рдпрд╣ рдЧрд╛рдпрдм рд╣реЛ рдЬрд╛рдПрдЧрд╛, рдЗрд╕рд▓рд┐рдП рдореБрдЭреЗ рдкрддрд╛ рд╣реИ рдХрд┐ рдПрдкреАрдЖрдИ-рд╕рд░реНрд╡рд░ рджреНрд╡рд╛рд░рд╛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдирд┐рд╖реНрдкрд╛рджрди рдХрдорд╛рдВрдб рдХреЗ рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк рдХрдиреЗрдХреНрд╢рди рд╕реНрдерд╛рдкрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред <br><br><pre> <code class="bash hljs">// master node $ netstat -atn |grep 192.168.205.11 tcp 0 0 192.168.205.10:37870 192.168.205.11:10250 ESTABLISHED тАж</code> </pre> <br><img src="https://habrastorage.org/webt/mp/-l/ql/mp-lqlocn8io490w9r9xenbawwg.png"><br><br>  Kubectl рдФрд░ рдПрдкреАрдЖрдИ рд╕рд░реНрд╡рд░ рдХреЗ рдмреАрдЪ рдХрдиреЗрдХреНрд╢рди рдЕрднреА рднреА рдЦреБрд▓рд╛ рд╣реИред  рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдПрдкреАрдЖрдИ-рд╕рд░реНрд╡рд░ рдФрд░ рдХреНрдпреВрдмрд▓реЗрдЯ рдХреЛ рдЬреЛрдбрд╝рдиреЗ рд╡рд╛рд▓рд╛ рдПрдХ рдФрд░ рдХрдиреЗрдХреНрд╢рди рд╣реИред <br><br><h3>  3. рдХрд╛рд░реНрдп рдиреЛрдб рдкрд░ рдЧрддрд┐рд╡рд┐рдзрд┐ </h3><br>  рдЕрдм рдХрд╛рд░реНрдпрдХрд░реНрддрд╛ рдиреЛрдб рд╕реЗ рдХрдиреЗрдХреНрдЯ рдХрд░реЗрдВ рдФрд░ рджреЗрдЦреЗрдВ рдХрд┐ рдЗрд╕ рдкрд░ рдХреНрдпрд╛ рд╣реЛрддрд╛ рд╣реИред <br><br>  рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рд╣рдо рджреЗрдЦрддреЗ рд╣реИрдВ рдХрд┐ рдЗрд╕рдХреЗ рд╕рд╛рде рдХрдиреЗрдХреНрд╢рди рднреА рд╕реНрдерд╛рдкрд┐рдд рд╣реИ (рджреВрд╕рд░реА рдкрдВрдХреНрддрд┐);  192.168.205.10 рдорд╛рд╕реНрдЯрд░ рдиреЛрдб рдХрд╛ рдЖрдИрдкреА рд╣реИ: <br><br><pre> <code class="bash hljs"> // worker node $ netstat -atn |grep 10250 tcp6 0 0 :::10250 :::* LISTEN tcp6 0 0 192.168.205.11:10250 192.168.205.10:37870 ESTABLISHED</code> </pre> <br>  рд╣рдорд╛рд░реА <code>sleep</code> рдЯреАрдо рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдХреНрдпрд╛?  рд╣реБрд░реНрд░реЗ, рд╡рд╣ рднреА рдореМрдЬреВрдж рд╣реИ! <br><br><pre> <code class="bash hljs"> // worker node $ ps -afx ... 31463 ? Sl 0:00 \_ docker-containerd-shim 7d974065bbb3107074ce31c51f5ef40aea8dcd535ae11a7b8f2dd180b8ed583a /var/run/docker/libcontainerd/7d974065bbb3107074ce31c51 31478 pts/0 Ss 0:00 \_ sh 31485 pts/0 S+ 0:00 \_ sleep 5000 тАж</code> </pre> <br>  рд▓реЗрдХрд┐рди рд░реБрдХрд┐рдП: рдХреНрдпреВрдмрд▓реЗрдЯ рдиреЗ рдЗрд╕реЗ рдХреИрд╕реЗ рдХреНрд░реИрдВрдХ рдХрд┐рдпрд╛?  рдХреНрдпреВрдмрд▓реЗрдЯ рдореЗрдВ рдПрдХ рдбреЗрдореЙрди рд╣реИ рдЬреЛ рдПрдкреАрдЖрдИ-рд╕рд░реНрд╡рд░ рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЗ рд▓рд┐рдП рдкреЛрд░реНрдЯ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдПрдкреАрдЖрдИ рддрдХ рдкрд╣реБрдВрдЪ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ: <br><br><pre> <code class="go hljs"><span class="hljs-comment"><span class="hljs-comment">// Server is the library interface to serve the stream requests. type Server interface { http.Handler // Get the serving URL for the requests. // Requests must not be nil. Responses may be nil iff an error is returned. GetExec(*runtimeapi.ExecRequest) (*runtimeapi.ExecResponse, error) GetAttach(req *runtimeapi.AttachRequest) (*runtimeapi.AttachResponse, error) GetPortForward(*runtimeapi.PortForwardRequest) (*runtimeapi.PortForwardResponse, error) // Start the server. // addr is the address to serve on (address:port) stayUp indicates whether the server should // listen until Stop() is called, or automatically stop after all expected connections are // closed. Calling Get{Exec,Attach,PortForward} increments the expected connection count. // Function does not return until the server is stopped. Start(stayUp bool) error // Stop the server, and terminate any open connections. Stop() error }</span></span></code> </pre> <br>  <i>( <a href="">pkg / kubelet / рд╕рд░реНрд╡рд░ / рд╕реНрдЯреНрд░реАрдорд┐рдВрдЧ / server.go</a> )</i> <br><br>  Kubelet рдирд┐рд╖реНрдкрд╛рджрди рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЗ рд▓рд┐рдП рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рд╕рдорд╛рдкрди рдмрд┐рдВрджреБ рдХреА рдЧрдгрдирд╛ рдХрд░рддрд╛ рд╣реИ: <br><br><pre> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(s *server)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetExec</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(req *runtimeapi.ExecRequest)</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(*runtimeapi.ExecResponse, error)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> err := validateExecRequest(req); err != <span class="hljs-literal"><span class="hljs-literal">nil</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">nil</span></span>, err } token, err := s.cache.Insert(req) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> err != <span class="hljs-literal"><span class="hljs-literal">nil</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">nil</span></span>, err } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> &amp;runtimeapi.ExecResponse{ Url: s.buildURL(<span class="hljs-string"><span class="hljs-string">"exec"</span></span>, token), }, <span class="hljs-literal"><span class="hljs-literal">nil</span></span> }</code> </pre> <br>  <i>( <a href="">pkg / kubelet / рд╕рд░реНрд╡рд░ / рд╕реНрдЯреНрд░реАрдорд┐рдВрдЧ / server.go</a> )</i> <br><br>  рднреНрд░рдорд┐рдд рдордд рдХрд░реЛред  рдпрд╣ рдХрдорд╛рдВрдб рдХрд╛ рдкрд░рд┐рдгрд╛рдо рдирд╣реАрдВ рджреЗрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рд╕рдВрдЪрд╛рд░ рдХреЗ рд▓рд┐рдП рд╕рдорд╛рдкрди рдмрд┐рдВрджреБ: <br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">type</span></span> ExecResponse <span class="hljs-keyword"><span class="hljs-keyword">struct</span></span> { <span class="hljs-comment"><span class="hljs-comment">// Fully qualified URL of the exec streaming server. Url string `protobuf:"bytes,1,opt,name=url,proto3" json:"url,omitempty"` XXX_NoUnkeyedLiteral struct{} `json:"-"` XXX_sizecache int32 `json:"-"` }</span></span></code> </pre> <br>  <i>( <a href="">cri-api / pkg / apis / runtime / v1alpha2 / api.pb.go</a> )</i> <br><br>  рдХреНрдпреВрдмрд▓реЗрдЯ <code>RuntimeServiceClient</code> рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рддрд╛ рд╣реИ, рдЬреЛ рдХрдВрдЯреЗрдирд░ рд░рдирдЯрд╛рдЗрдо рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдХрд╛ рд╣рд┐рд╕реНрд╕рд╛ рд╣реИ <i>(рд╣рдордиреЗ рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рд▓рд┐рдЦрд╛ рд╣реИ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдпрд╣рд╛рдВ</a> - рд▓рдЧрднрдЧред рдЕрдиреБрд╡рд╛рджред)</i> : <br><br><div class="spoiler">  <b class="spoiler_title">Cri-api рд╕реЗ kubernetes / kubernetes рддрдХ рд▓рдВрдмреА рд╕реВрдЪреА</b> <div class="spoiler_text"><pre> <code class="go hljs"><span class="hljs-comment"><span class="hljs-comment">// For semantics around ctx use and closing/ending streaming RPCs, please refer to https://godoc.org/google.golang.org/grpc#ClientConn.NewStream. type RuntimeServiceClient interface { // Version returns the runtime name, runtime version, and runtime API version. Version(ctx context.Context, in *VersionRequest, opts ...grpc.CallOption) (*VersionResponse, error) // RunPodSandbox creates and starts a pod-level sandbox. Runtimes must ensure // the sandbox is in the ready state on success. RunPodSandbox(ctx context.Context, in *RunPodSandboxRequest, opts ...grpc.CallOption) (*RunPodSandboxResponse, error) // StopPodSandbox stops any running process that is part of the sandbox and // reclaims network resources (eg, IP addresses) allocated to the sandbox. // If there are any running containers in the sandbox, they must be forcibly // terminated. // This call is idempotent, and must not return an error if all relevant // resources have already been reclaimed. kubelet will call StopPodSandbox // at least once before calling RemovePodSandbox. It will also attempt to // reclaim resources eagerly, as soon as a sandbox is not needed. Hence, // multiple StopPodSandbox calls are expected. StopPodSandbox(ctx context.Context, in *StopPodSandboxRequest, opts ...grpc.CallOption) (*StopPodSandboxResponse, error) // RemovePodSandbox removes the sandbox. If there are any running containers // in the sandbox, they must be forcibly terminated and removed. // This call is idempotent, and must not return an error if the sandbox has // already been removed. RemovePodSandbox(ctx context.Context, in *RemovePodSandboxRequest, opts ...grpc.CallOption) (*RemovePodSandboxResponse, error) // PodSandboxStatus returns the status of the PodSandbox. If the PodSandbox is not // present, returns an error. PodSandboxStatus(ctx context.Context, in *PodSandboxStatusRequest, opts ...grpc.CallOption) (*PodSandboxStatusResponse, error) // ListPodSandbox returns a list of PodSandboxes. ListPodSandbox(ctx context.Context, in *ListPodSandboxRequest, opts ...grpc.CallOption) (*ListPodSandboxResponse, error) // CreateContainer creates a new container in specified PodSandbox CreateContainer(ctx context.Context, in *CreateContainerRequest, opts ...grpc.CallOption) (*CreateContainerResponse, error) // StartContainer starts the container. StartContainer(ctx context.Context, in *StartContainerRequest, opts ...grpc.CallOption) (*StartContainerResponse, error) // StopContainer stops a running container with a grace period (ie, timeout). // This call is idempotent, and must not return an error if the container has // already been stopped. // </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">TODO:</span></span></span><span class="hljs-comment"> what must the runtime do after the grace period is reached? StopContainer(ctx context.Context, in *StopContainerRequest, opts ...grpc.CallOption) (*StopContainerResponse, error) // RemoveContainer removes the container. If the container is running, the // container must be forcibly removed. // This call is idempotent, and must not return an error if the container has // already been removed. RemoveContainer(ctx context.Context, in *RemoveContainerRequest, opts ...grpc.CallOption) (*RemoveContainerResponse, error) // ListContainers lists all containers by filters. ListContainers(ctx context.Context, in *ListContainersRequest, opts ...grpc.CallOption) (*ListContainersResponse, error) // ContainerStatus returns status of the container. If the container is not // present, returns an error. ContainerStatus(ctx context.Context, in *ContainerStatusRequest, opts ...grpc.CallOption) (*ContainerStatusResponse, error) // UpdateContainerResources updates ContainerConfig of the container. UpdateContainerResources(ctx context.Context, in *UpdateContainerResourcesRequest, opts ...grpc.CallOption) (*UpdateContainerResourcesResponse, error) // ReopenContainerLog asks runtime to reopen the stdout/stderr log file // for the container. This is often called after the log file has been // rotated. If the container is not running, container runtime can choose // to either create a new log file and return nil, or return an error. // Once it returns error, new container log file MUST NOT be created. ReopenContainerLog(ctx context.Context, in *ReopenContainerLogRequest, opts ...grpc.CallOption) (*ReopenContainerLogResponse, error) // ExecSync runs a command in a container synchronously. ExecSync(ctx context.Context, in *ExecSyncRequest, opts ...grpc.CallOption) (*ExecSyncResponse, error) // Exec prepares a streaming endpoint to execute a command in the container. Exec(ctx context.Context, in *ExecRequest, opts ...grpc.CallOption) (*ExecResponse, error) // Attach prepares a streaming endpoint to attach to a running container. Attach(ctx context.Context, in *AttachRequest, opts ...grpc.CallOption) (*AttachResponse, error) // PortForward prepares a streaming endpoint to forward ports from a PodSandbox. PortForward(ctx context.Context, in *PortForwardRequest, opts ...grpc.CallOption) (*PortForwardResponse, error) // ContainerStats returns stats of the container. If the container does not // exist, the call returns an error. ContainerStats(ctx context.Context, in *ContainerStatsRequest, opts ...grpc.CallOption) (*ContainerStatsResponse, error) // ListContainerStats returns stats of all running containers. ListContainerStats(ctx context.Context, in *ListContainerStatsRequest, opts ...grpc.CallOption) (*ListContainerStatsResponse, error) // UpdateRuntimeConfig updates the runtime configuration based on the given request. UpdateRuntimeConfig(ctx context.Context, in *UpdateRuntimeConfigRequest, opts ...grpc.CallOption) (*UpdateRuntimeConfigResponse, error) // Status returns the status of the runtime. Status(ctx context.Context, in *StatusRequest, opts ...grpc.CallOption) (*StatusResponse, error) }</span></span></code> </pre> <br>  <i>( <a href="">cri-api / pkg / apis / runtime / v1alpha2 / api.pb.go</a> )</i> </div></div><br>  рдпрд╣ рд╕рд┐рд░реНрдл рдХрдВрдЯреЗрдирд░ рд░рдирдЯрд╛рдЗрдо рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдПрдХ рд╡рд┐рдзрд┐ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП gRPC рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ: <br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">type</span></span> runtimeServiceClient <span class="hljs-keyword"><span class="hljs-keyword">struct</span></span> { cc *grpc.ClientConn }</code> </pre> <br>  <i>( <a href="">cri-api / pkg / apis / runtime / v1alpha2 / api.pb.go</a> )</i> <br><br><pre> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(c *runtimeServiceClient)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Exec</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ctx context.Context, in *ExecRequest, opts ...grpc.CallOption)</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(*ExecResponse, error)</span></span></span></span> { out := <span class="hljs-built_in"><span class="hljs-built_in">new</span></span>(ExecResponse) err := c.cc.Invoke(ctx, <span class="hljs-string"><span class="hljs-string">"/runtime.v1alpha2.RuntimeService/Exec"</span></span>, in, out, opts...) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> err != <span class="hljs-literal"><span class="hljs-literal">nil</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">nil</span></span>, err } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> out, <span class="hljs-literal"><span class="hljs-literal">nil</span></span> }</code> </pre> <br>  <i>( <a href="">cri-api / pkg / apis / runtime / v1alpha2 / api.pb.go</a> )</i> <br><br>  рдХрдВрдЯреЗрдирд░ рд░рдирдЯрд╛рдЗрдо <code>RuntimeServiceServer</code> рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЬрд┐рдореНрдореЗрджрд╛рд░ рд╣реИ: <br><br><div class="spoiler">  <b class="spoiler_title">Cri-api рд╕реЗ kubernetes / kubernetes рддрдХ рд▓рдВрдмреА рд╕реВрдЪреА</b> <div class="spoiler_text"><pre> <code class="go hljs"><span class="hljs-comment"><span class="hljs-comment">// RuntimeServiceServer is the server API for RuntimeService service. type RuntimeServiceServer interface { // Version returns the runtime name, runtime version, and runtime API version. Version(context.Context, *VersionRequest) (*VersionResponse, error) // RunPodSandbox creates and starts a pod-level sandbox. Runtimes must ensure // the sandbox is in the ready state on success. RunPodSandbox(context.Context, *RunPodSandboxRequest) (*RunPodSandboxResponse, error) // StopPodSandbox stops any running process that is part of the sandbox and // reclaims network resources (eg, IP addresses) allocated to the sandbox. // If there are any running containers in the sandbox, they must be forcibly // terminated. // This call is idempotent, and must not return an error if all relevant // resources have already been reclaimed. kubelet will call StopPodSandbox // at least once before calling RemovePodSandbox. It will also attempt to // reclaim resources eagerly, as soon as a sandbox is not needed. Hence, // multiple StopPodSandbox calls are expected. StopPodSandbox(context.Context, *StopPodSandboxRequest) (*StopPodSandboxResponse, error) // RemovePodSandbox removes the sandbox. If there are any running containers // in the sandbox, they must be forcibly terminated and removed. // This call is idempotent, and must not return an error if the sandbox has // already been removed. RemovePodSandbox(context.Context, *RemovePodSandboxRequest) (*RemovePodSandboxResponse, error) // PodSandboxStatus returns the status of the PodSandbox. If the PodSandbox is not // present, returns an error. PodSandboxStatus(context.Context, *PodSandboxStatusRequest) (*PodSandboxStatusResponse, error) // ListPodSandbox returns a list of PodSandboxes. ListPodSandbox(context.Context, *ListPodSandboxRequest) (*ListPodSandboxResponse, error) // CreateContainer creates a new container in specified PodSandbox CreateContainer(context.Context, *CreateContainerRequest) (*CreateContainerResponse, error) // StartContainer starts the container. StartContainer(context.Context, *StartContainerRequest) (*StartContainerResponse, error) // StopContainer stops a running container with a grace period (ie, timeout). // This call is idempotent, and must not return an error if the container has // already been stopped. // </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">TODO:</span></span></span><span class="hljs-comment"> what must the runtime do after the grace period is reached? StopContainer(context.Context, *StopContainerRequest) (*StopContainerResponse, error) // RemoveContainer removes the container. If the container is running, the // container must be forcibly removed. // This call is idempotent, and must not return an error if the container has // already been removed. RemoveContainer(context.Context, *RemoveContainerRequest) (*RemoveContainerResponse, error) // ListContainers lists all containers by filters. ListContainers(context.Context, *ListContainersRequest) (*ListContainersResponse, error) // ContainerStatus returns status of the container. If the container is not // present, returns an error. ContainerStatus(context.Context, *ContainerStatusRequest) (*ContainerStatusResponse, error) // UpdateContainerResources updates ContainerConfig of the container. UpdateContainerResources(context.Context, *UpdateContainerResourcesRequest) (*UpdateContainerResourcesResponse, error) // ReopenContainerLog asks runtime to reopen the stdout/stderr log file // for the container. This is often called after the log file has been // rotated. If the container is not running, container runtime can choose // to either create a new log file and return nil, or return an error. // Once it returns error, new container log file MUST NOT be created. ReopenContainerLog(context.Context, *ReopenContainerLogRequest) (*ReopenContainerLogResponse, error) // ExecSync runs a command in a container synchronously. ExecSync(context.Context, *ExecSyncRequest) (*ExecSyncResponse, error) // Exec prepares a streaming endpoint to execute a command in the container. Exec(context.Context, *ExecRequest) (*ExecResponse, error) // Attach prepares a streaming endpoint to attach to a running container. Attach(context.Context, *AttachRequest) (*AttachResponse, error) // PortForward prepares a streaming endpoint to forward ports from a PodSandbox. PortForward(context.Context, *PortForwardRequest) (*PortForwardResponse, error) // ContainerStats returns stats of the container. If the container does not // exist, the call returns an error. ContainerStats(context.Context, *ContainerStatsRequest) (*ContainerStatsResponse, error) // ListContainerStats returns stats of all running containers. ListContainerStats(context.Context, *ListContainerStatsRequest) (*ListContainerStatsResponse, error) // UpdateRuntimeConfig updates the runtime configuration based on the given request. UpdateRuntimeConfig(context.Context, *UpdateRuntimeConfigRequest) (*UpdateRuntimeConfigResponse, error) // Status returns the status of the runtime. Status(context.Context, *StatusRequest) (*StatusResponse, error) }</span></span></code> </pre> <br>  <i>( <a href="">cri-api / pkg / apis / runtime / v1alpha2 / api.pb.go</a> )</i> </div></div><br><img src="https://habrastorage.org/webt/ud/wx/mb/udwxmbczx1kgrhy_etiwnmkhlha.png"><br><br>  рдпрджрд┐ рд╣рд╛рдВ, рддреЛ рд╣рдореЗрдВ рдХреНрдпреВрдмрд▓реЗрдЯ рдФрд░ рдХрдВрдЯреЗрдирд░ рд░рдирдЯрд╛рдЗрдо рдХреЗ рдмреАрдЪ рд╕рдВрдмрдВрдз рджреЗрдЦрдирд╛ рдЪрд╛рд╣рд┐рдП, рд╣реИ рдирд╛?  рдЖрдЗрдП рдЗрд╕реЗ рджреЗрдЦреЗрдВред <br><br>  рдЗрд╕ рдХрдорд╛рдВрдб рдХреЛ рдПрдЧреНрдЬреАрдХреНрдпреВрдЯ рдХрдорд╛рдВрдб рд╕реЗ рдкрд╣рд▓реЗ рдФрд░ рдмрд╛рдж рдореЗрдВ рдЪрд▓рд╛рдПрдВ рдФрд░ рдЕрдВрддрд░ рджреЗрдЦреЗрдВред  рдореЗрд░реЗ рдорд╛рдорд▓реЗ рдореЗрдВ, рдпрд╣ рдЕрдВрддрд░ рд╣реИ: <br><br><pre> <code class="bash hljs">// worker node $ ss -a -p |grep kubelet ... u_str ESTAB 0 0 * 157937 * 157387 users:((<span class="hljs-string"><span class="hljs-string">"kubelet"</span></span>,pid=5714,fd=33)) ...</code> </pre> <br>  рд╣рдореНрдо ... рдХреНрдпреВрдмрд▓реЗрдЯ (рдкреАрдЖрдИрдбреА тАЛтАЛ= 5714) рдФрд░ рдХреБрдЫ рдЕрдЬреНрдЮрд╛рдд рдХреЗ рдмреАрдЪ рдпреВрдирд┐рдХреНрд╕ рд╕реЙрдХреЗрдЯреНрд╕ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдПрдХ рдирдпрд╛ рдХрдиреЗрдХреНрд╢рдиред  рдпрд╣ рдХреНрдпрд╛ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ?  рдпрд╣ рд╕рд╣реА рд╣реИ, рдпрд╣ рдбреЙрдХрд░ (рдкреГрд╖реНрда 1186) рд╣реИ! <br><br><pre> <code class="bash hljs">// worker node $ ss -a -p |grep 157387 ... u_str ESTAB 0 0 * 157937 * 157387 users:((<span class="hljs-string"><span class="hljs-string">"kubelet"</span></span>,pid=5714,fd=33)) u_str ESTAB 0 0 /var/run/docker.sock 157387 * 157937 users:((<span class="hljs-string"><span class="hljs-string">"dockerd"</span></span>,pid=1186,fd=14)) ...</code> </pre> <br>  рдЬреИрд╕рд╛ рдХрд┐ рдЖрдкрдХреЛ рдпрд╛рдж рд╣реИ, рдпрд╣ рдПрдХ рдбреЙрдХ рдбреЗрдореЙрди рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╣реИ (pid = 1186) рдЬреЛ рд╣рдорд╛рд░реА рдЖрдЬреНрдЮрд╛ рдХрд╛ рдкрд╛рд▓рди рдХрд░рддреА рд╣реИ: <br><br><pre> <code class="bash hljs">// worker node $ ps -afx ... 1186 ? Ssl 0:55 /usr/bin/dockerd -H fd:// 17784 ? Sl 0:00 \_ docker-containerd-shim 53a0a08547b2f95986402d7f3b3e78702516244df049ba6c5aa012e81264aa3c /var/run/docker/libcontainerd/53a0a08547b2f95986402d7f3 17801 pts/2 Ss 0:00 \_ sh 17827 pts/2 S+ 0:00 \_ sleep 5000 ...</code> </pre> <br><h3>  4. рдХрдВрдЯреЗрдирд░ рд░рдирдЯрд╛рдЗрдо рдореЗрдВ рдЧрддрд┐рд╡рд┐рдзрд┐ </h3><br>  рдЖрдЗрдП CRI-O рдХреЗ рд╕реЛрд░реНрд╕ рдХреЛрдб рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ рдХрд┐ рдХреНрдпрд╛ рд╣реЛ рд░рд╣рд╛ рд╣реИред  рдбреЙрдХрд░ рдореЗрдВ, рддрд░реНрдХ рд╕рдорд╛рди рд╣реИред <br><br>  <code>RuntimeServiceServer</code> рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЬрд┐рдореНрдореЗрджрд╛рд░ рдПрдХ рд╕рд░реНрд╡рд░ рд╣реИ: <br><br><pre> <code class="go hljs"><span class="hljs-comment"><span class="hljs-comment">// Server implements the RuntimeService and ImageService type Server struct { config libconfig.Config seccompProfile *seccomp.Seccomp stream StreamService netPlugin ocicni.CNIPlugin hostportManager hostport.HostPortManager appArmorProfile string hostIP string bindAddress string *lib.ContainerServer monitorsChan chan struct{} defaultIDMappings *idtools.IDMappings systemContext *types.SystemContext // Never nil updateLock sync.RWMutex seccompEnabled bool appArmorEnabled bool }</span></span></code> </pre> <br>  <i>( <a href="">cri-o / server / server.go</a> )</i> <br><br><pre> <code class="go hljs"><span class="hljs-comment"><span class="hljs-comment">// Exec prepares a streaming endpoint to execute a command in the container. func (s *Server) Exec(ctx context.Context, req *pb.ExecRequest) (resp *pb.ExecResponse, err error) { const operation = "exec" defer func() { recordOperation(operation, time.Now()) recordError(operation, err) }() resp, err = s.getExec(req) if err != nil { return nil, fmt.Errorf("unable to prepare exec endpoint: %v", err) } return resp, nil }</span></span></code> </pre> <br>  <i>( <a href="">cri-o / erver / container_exec.go</a> )</i> <br><br>  рд╢реНрд░реГрдВрдЦрд▓рд╛ рдХреЗ рдЕрдВрдд рдореЗрдВ, рдХрдВрдЯреЗрдирд░ рд░рдирдЯрд╛рдЗрдо рдХрд╛рд░реНрдп рдиреЛрдб рдкрд░ рдХрдорд╛рдВрдб рдЪрд▓рд╛рддрд╛ рд╣реИ: <br><br><pre> <code class="go hljs"><span class="hljs-comment"><span class="hljs-comment">// ExecContainer prepares a streaming endpoint to execute a command in the container. func (r *runtimeOCI) ExecContainer(c *Container, cmd []string, stdin io.Reader, stdout, stderr io.WriteCloser, tty bool, resize &lt;-chan remotecommand.TerminalSize) error { processFile, err := prepareProcessExec(c, cmd, tty) if err != nil { return err } defer os.RemoveAll(processFile.Name()) args := []string{rootFlag, r.root, "exec"} args = append(args, "--process", processFile.Name(), c.ID()) execCmd := exec.Command(r.path, args...) if v, found := os.LookupEnv("XDG_RUNTIME_DIR"); found { execCmd.Env = append(execCmd.Env, fmt.Sprintf("XDG_RUNTIME_DIR=%s", v)) } var cmdErr, copyError error if tty { cmdErr = ttyCmd(execCmd, stdin, stdout, resize) } else { if stdin != nil { // Use an os.Pipe here as it returns true *os.File objects. // This way, if you run 'kubectl exec &lt;pod&gt; -i bash' (no tty) and type 'exit', // the call below to execCmd.Run() can unblock because its Stdin is the read half // of the pipe. r, w, err := os.Pipe() if err != nil { return err } go func() { _, copyError = pools.Copy(w, stdin) }() execCmd.Stdin = r } if stdout != nil { execCmd.Stdout = stdout } if stderr != nil { execCmd.Stderr = stderr } cmdErr = execCmd.Run() } if copyError != nil { return copyError } if exitErr, ok := cmdErr.(*exec.ExitError); ok { return &amp;utilexec.ExitErrorWrapper{ExitError: exitErr} } return cmdErr }</span></span></code> </pre> <br>  <i>( <a href="">cri-o / internal / oci / runtime_oci.go</a> )</i> <br><br><img src="https://habrastorage.org/webt/hm/dt/jk/hmdtjkw28fyrng0zsjghbw7tq5g.png"><br><br>  рдЕрдВрдд рдореЗрдВ, рдХрд░реНрдиреЗрд▓ рдХрдорд╛рдВрдб рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рддрд╛ рд╣реИ: <br><br><img src="https://habrastorage.org/webt/f2/7n/jk/f27njkgk1lqwo0ik-9vkj-kocic.png"><br><br><h2>  рдЕрдиреБрд╕реНрдорд╛рд░рдХ </h2><br><ul><li>  рдПрдкреАрдЖрдИ рд╕рд░реНрд╡рд░ рднреА рдХреНрдпреВрдмрд▓реЗрдЯ рд╕реЗ рдХрдиреЗрдХреНрд╢рди рд╢реБрд░реВ рдХрд░ рд╕рдХрддрд╛ рд╣реИред </li><li>  рдЗрдВрдЯрд░реИрдХреНрдЯрд┐рд╡ рдирд┐рд╖реНрдкрд╛рджрди рд╕рддреНрд░ рдХреЗ рдЕрдВрдд рддрдХ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрдиреЗрдХреНрд╢рди рдмрдирд╛рдП рд░рдЦреЗ рдЬрд╛рддреЗ рд╣реИрдВ: <ul><li>  kubectl рдФрд░ api-server рдХреЗ рдмреАрдЪ; </li><li>  рдПрдкрд┐-рд╕рд░реНрд╡рд░ рдФрд░ рдХреБрдмреЗрдЯреЗрд▓ рдХреЗ рдмреАрдЪ; </li><li>  рдХреНрдпреВрдмрд▓реЗрдЯ рдФрд░ рдХрдВрдЯреЗрдирд░ рд░рдирдЯрд╛рдЗрдо рдХреЗ рдмреАрдЪред </li></ul></li><li>  Kubectl рдпрд╛ рдПрдкреАрдЖрдИ рд╕рд░реНрд╡рд░ рдЙрддреНрдкрд╛рджрди рдиреЛрдбреНрд╕ рдкрд░ рдХреБрдЫ рднреА рдирд╣реАрдВ рдЪрд▓рд╛ рд╕рдХрддрд╛ рд╣реИред  рдХреНрдпреВрдмрд▓реЗрдЯ рд╢реБрд░реВ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдЗрди рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП рдпрд╣ рдХрдВрдЯреЗрдирд░ рд░рдирдЯрд╛рдЗрдо рдХреЗ рд╕рд╛рде рднреА рдмрд╛рддрдЪреАрдд рдХрд░рддрд╛ рд╣реИред </li></ul><br><h2>  рд╕рд╛рдзрди </h2><br><ul><li>  рдЪрд░реНрдЪрд╛ " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдХреИрд╕реЗ" kubectl рдирд┐рд╖реНрдкрд╛рджрд┐рдд "рдХрд╛рдо</a> " kubernetes-dev рдореЗрдВ; </li><li>  рд▓реЗрдЦ " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╡реИрдЧреНрд░рдВрдЯ рдорд╢реАрдиреЛрдВ рдореЗрдВ рдХреБрдмреЗрджрдо рдХреЗ рд╕рд╛рде рдЦреЗрд▓рдирд╛, рднрд╛рдЧ 2</a> "; </li><li>  рдЪрд░реНрдЪрд╛ " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдпреВрдирд┐рдХреНрд╕ рд╕реЙрдХреЗрдЯ рдХрдиреЗрдХреНрд╢рди рдХреЗ рджреВрд╕рд░реЗ рдЫреЛрд░ рдХреЛ рдХреИрд╕реЗ рдвреВрдВрдвреЗрдВ?</a>  "рд╕рд░реНрд╡рд░ рджреЛрд╖ рдкрд░ред </li></ul><br><h2>  рдЕрдиреБрд╡рд╛рджрдХ рд╕реЗ рдкреА.рдПрд╕. </h2><br>  рд╣рдорд╛рд░реЗ рдмреНрд▓реЙрдЧ рдореЗрдВ рднреА рдкрдврд╝реЗрдВ: <br><br><ul><li>  "рдХреБрдмреЗрд░рдиреЗрдЯреНрд╕ рдореЗрдВ рдХреНрдпрд╛ рд╣реЛрддрд╛ рд╣реИ рдЬрдм рдХреБрдмреЗрдЯреЗрд▓ рд░рди рд╢реБрд░реВ рд╣реЛрддрд╛ рд╣реИ?"  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рднрд╛рдЧ 1</a> рдФрд░ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рднрд╛рдЧ 2</a> ; </li><li>  тАЬ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рддреЛ рдХреБрдмреЗрд░рдиреЗрдЯреНрд╕ рдореЗрдВ рдПрдХ рдлрд▓реА рдХреНрдпрд╛ рд╣реИ?</a>  "; </li><li>  " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдХреБрдмреЗрд░рдиреЗрдЯреНрд╕ рдЕрдиреБрд╕реВрдЪрдХ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ?"</a>  "; </li><li> ┬л <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">     Kubernetes</a> ┬╗. </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/hi466093/">https://habr.com/ru/post/hi466093/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi466071/index.html">10.3 рд╕реЗрдХрдВрдб рдкреНрд░рддрд┐ рд╣реИрд╢: рдЕрдкреЛрд▓реЛ рдЕрдВрддрд░рд┐рдХреНрд╖ рдпрд╛рди рдкрд░ рдмреЛрд░реНрдб рдирд┐рдпрдВрддреНрд░рдг рдХрдВрдкреНрдпреВрдЯрд░ рдкрд░ рдЦрдирди</a></li>
<li><a href="../hi466075/index.html">рдореИрдВрдиреЗ рдПрдХ рд╕реНрдЯрд╛рд░реНрдЯрдЕрдк рдореЗрдВ рдмреЗрд╕рд┐рдХ рд╕рд╛рдЗрдВрд╕ рдХреЛ рдХреИрд╕реЗ рдЫреЛрдбрд╝рд╛</a></li>
<li><a href="../hi466077/index.html">рд╕реЗрдВрдЯ рдкреАрдЯрд░реНрд╕рдмрд░реНрдЧ рдореЗрдВ рдкреНрд░рд╕рд╛рд░рдг рдЯреЗрдХрдбрд┐рдпрд░ рджрд┐рд╡рд╕</a></li>
<li><a href="../hi466081/index.html">3 рд╕рд┐рддрдВрдмрд░</a></li>
<li><a href="../hi466089/index.html">рд╕реЛрдЪ рдФрд░ рдЪреЗрддрдирд╛ рдХрд╛ рдПрд▓реНрдЧреЛрд░рд┐рдердо, рднрд╛рдЧ 2</a></li>
<li><a href="../hi466097/index.html">.NET рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдХреА рдирд┐рдЧрд░рд╛рдиреА</a></li>
<li><a href="../hi466099/index.html">рд╡реАрдбрд┐рдпреЛ рд╕реЗрд╡рд╛ рдХреЗ рд▓рд┐рдП рд╡реЗрдм рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рдкрд░реАрдХреНрд╖рдг рдХреА рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдВ</a></li>
<li><a href="../hi466103/index.html">рдХреНрд▓рд╛рдЙрдб рд╕реБрд░рдХреНрд╖рд╛ рдирд┐рдЧрд░рд╛рдиреА</a></li>
<li><a href="../hi466105/index.html">RoadRunner рдХреЗ рд╕рд╛рде Magento Rest API рдХреЛ рдУрд╡рд░рдХреНрд▓реЙрдХ рдХрд░рдирд╛</a></li>
<li><a href="../hi466107/index.html">рдбреВ-рдЗрдЯ-рдЦреБрдж рд╕реНрдорд╛рд░реНрдЯ рд╣реЛрдо рд╕рд┐рд╕реНрдЯрдо</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>