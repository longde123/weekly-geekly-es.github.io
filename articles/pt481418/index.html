<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üõÄüèΩ üë∏ ü§£ Como o codec de v√≠deo funciona. Parte 1. No√ß√µes b√°sicas ü¶î ü§∂ ‚úãüèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Parte 2: Como o codec de v√≠deo funciona 

 Qualquer imagem rasterizada pode ser representada como uma matriz bidimensional . No que diz respeito √†s co...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Como o codec de v√≠deo funciona. Parte 1. No√ß√µes b√°sicas</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/edison/blog/481418/"><h3>  Parte 2: <a href="https://habr.com/ru/company/edison/blog/480430/">Como o codec de v√≠deo funciona</a> </h3><br><hr><br>  Qualquer <b>imagem</b> rasterizada pode ser representada como uma <b>matriz bidimensional</b> .  No que diz respeito √†s cores, a ideia pode ser desenvolvida observando a imagem na forma de uma <b>matriz tridimensional</b> , na qual medi√ß√µes adicionais s√£o usadas para armazenar dados para cada uma das cores. <br><br>  Se considerarmos a cor final como uma combina√ß√£o dos chamados  cores prim√°rias (vermelho, verde e azul), em nossa matriz tridimensional, determinamos tr√™s planos: o primeiro para o vermelho, o segundo para o verde e o √∫ltimo para o azul. <br><div style="text-align:center;"><img width="746" height="235" src="https://habrastorage.org/webt/gz/rx/7q/gzrx7qp8p_kzdeb2cat-raur3sk.png" alt="Matriz 3D RGB" title="Matriz 3D RGB"></div><br>  Vamos chamar cada ponto dessa matriz de pixel (elemento de imagem).  Cada pixel cont√©m informa√ß√µes de intensidade (geralmente na forma de um valor num√©rico) de cada cor.  Por exemplo, um <b>pixel vermelho</b> significa que possui 0 verde, 0 azul e vermelho m√°ximo.  <b>Um pixel rosa</b> pode ser formado usando uma combina√ß√£o de tr√™s cores.  Usando um intervalo num√©rico de 0 a 255, o pixel rosa √© definido como <b>Vermelho = 255</b> , <b>Verde = 192</b> e <b>Azul = 203</b> . <a name="habracut"></a><blockquote> <a href="https://www.edsd.ru/" title="EDISON Software - desenvolvimento web"><img align="left" width="153" height="75" src="https://habrastorage.org/webt/w0/zl/to/w0zltoxvysbr0yeinstkfvw1wbg.png" alt="EDISON Software - desenvolvimento web"></a> <br clear="right">  Este artigo foi publicado com o apoio da EDISON. <br><br>  Desenvolvemos <a href="https://www.edsd.ru/ru/portfolio/tehnologiya/video">aplicativos para vigil√¢ncia por v√≠deo, streaming de v√≠deo</a> e <a href="https://www.edsd.ru/videozapis-v-bolnichnoj-operacionnoj-s-vozmozhnostyu-obsuzhdeniya-na-forume">grava√ß√£o de v√≠deo na sala cir√∫rgica</a> . </blockquote><h3>  T√©cnicas alternativas de codifica√ß√£o por cores </h3><br>  Para representar as cores que comp√µem a imagem, existem muitos outros modelos.  Por exemplo, voc√™ pode usar uma paleta indexada na qual apenas um byte √© necess√°rio para representar cada pixel, em vez dos tr√™s necess√°rios ao usar o modelo RGB.  Nesse modelo, voc√™ pode usar uma matriz 2D em vez de uma matriz 3D para representar cada cor.  Isso economiza mem√≥ria, mas fornece menos cores. <br><br><img width="479" height="120" src="https://habrastorage.org/webt/yx/pp/nb/yxppnbcixbaszve4ixpqzbvsrdy.png" alt="Paleta NES" title="Paleta nes"><br><br><h2>  RGB </h2><br><br>  Por exemplo, veja esta imagem abaixo.  A primeira face √© completamente pintada.  Outros s√£o os planos vermelho, verde e azul (a intensidade das cores correspondentes √© mostrada em escala de cinza). <br><br><img src="https://habrastorage.org/webt/n1/_6/uc/n1_6uc9on4ze-fixad_o7ijvl1u.png" alt="Intensidade do canal RGB" title="Intensidade do canal RGB"><br><br>  Vemos que os tons de vermelho no original estar√£o nos mesmos lugares em que as partes mais brilhantes da segunda pessoa s√£o observadas.  Enquanto a contribui√ß√£o do azul pode ser vista principalmente apenas nos olhos de Mario (o √∫ltimo rosto) e nos elementos de suas roupas.  Observe onde os tr√™s planos de cores contribuem menos (as partes mais escuras das imagens) - este √© o bigode de Mario. <br><br>  Para armazenar a intensidade de cada cor, √© necess√°rio um certo n√∫mero de bits - esse valor √© chamado <b>profundidade de bits</b> .  Digamos que 8 bits sejam gastos (com base em um valor de 0 a 255) em um plano de cores.  Em seguida, temos uma profundidade de cor de 24 bits (8 bits * 3 plano R / G / B). <br><br>  Outra propriedade da imagem √© a <b>resolu√ß√£o</b> , que √© o n√∫mero de pixels em uma dimens√£o.  √â geralmente chamado de <b>largura √ó altura</b> , como abaixo na imagem de exemplo 4 por 4. <br><img width="401" height="185" src="https://habrastorage.org/webt/5q/2i/so/5q2isolirmyfjxl-hb7m4hj_7au.png" alt="Resolu√ß√£o da imagem" title="Resolu√ß√£o da imagem"><br><br>  Outra propriedade com a qual lidamos ao trabalhar com imagens / v√≠deo √© a <b>propor√ß√£o</b> , que descreve a rela√ß√£o proporcional usual entre a largura e a altura de uma imagem ou pixel. <br><br>  Quando eles dizem que um filme ou imagem tem 16 por 9, geralmente se refere √† <b>propor√ß√£o da tela</b> ( <b>DAR</b> - da <i>propor√ß√£o</i> da <i>tela</i> ).  No entanto, √†s vezes pode haver diferentes formas de pixels individuais - neste caso, estamos falando sobre a <b>propor√ß√£o de pixels</b> ( <b>PAR</b> - da <i>rela√ß√£o de aspecto de pixel</i> ). <br><br><img width="536" height="254" src="https://habrastorage.org/webt/xg/mb/gp/xgmbgpydyzkiraifaxf9ltiqkxq.png" alt="Propor√ß√£o da tela" title="Propor√ß√£o da tela"><br><br><img width="725" height="318" src="https://habrastorage.org/webt/sg/ti/eq/sgtieqvisg6eu5oaddpmfxmrxnm.png" alt="propor√ß√£o de pixel" title="propor√ß√£o de pixel"><br><blockquote>  Nota para a anfitri√£: <b>DVD</b> corresponde a <b>DAR 4 por 3</b> <br><br>  Embora a resolu√ß√£o real do DVD seja 704x480, ela mant√©m uma propor√ß√£o de aspecto 4: 3, pois o PAR est√° definido em 10:11 (704x10 / 480x11). </blockquote><br>  E, finalmente, podemos definir um <b>v√≠deo</b> como uma sequ√™ncia de <b>n</b> quadros ao longo de um per√≠odo de <b>tempo</b> , o que pode ser considerado uma dimens√£o adicional.  E ent√£o √© a taxa de quadros ou o n√∫mero de quadros por segundo ( <b>FPS</b> - de <i>quadros por segundo</i> ). <br><br><img width="710" height="240" src="https://habrastorage.org/webt/67/kd/us/67kdus1r36qphfoi1jqqt9uinpy.png" alt="o video" title="o video"><br><br>  O n√∫mero de bits por segundo necess√°rio para exibir um v√≠deo √© sua <b>taxa de bits</b> . <br><blockquote>  taxa de bits = largura * altura * profundidade de bits * quadros por segundo </blockquote><br>  Por exemplo, para v√≠deos com 30 quadros por segundo, 24 bits por pixel, resolu√ß√£o 480x240, 82.944.000 bits por segundo ou 82.944 Mbit / s (30x480x240x24) seriam necess√°rios - mas isso √© se voc√™ n√£o usar nenhum dos m√©todos de compacta√ß√£o. <br><br>  Se a taxa de bits √© <i>quase constante</i> , √© chamada de <i>taxa de bits constante</i> ( <b>CBR</b> - da <i>taxa de bits constante</i> ).  Mas tamb√©m pode variar, neste caso, √© chamada de <i>taxa de bits vari√°vel</i> ( <b>VBR</b> - da <i>taxa de bits vari√°vel</i> ). <br><br>  Este gr√°fico mostra um VBR limitado quando n√£o s√£o gastos muitos bits no caso de um quadro completamente escuro. <br><br><img src="https://habrastorage.org/webt/5l/sb/v-/5lsbv-4t7iucyksv39yyqgqmggs.png" alt="VBR limitado" title="VBR limitado"><br><br>  Inicialmente, os engenheiros desenvolveram um m√©todo para dobrar a taxa de quadros percebida de uma exibi√ß√£o de v√≠deo sem usar largura de banda adicional.  Este m√©todo √© conhecido como <b>v√≠deo entrela√ßado</b> ;  basicamente, ele envia metade da tela no primeiro "quadro" e a outra metade no pr√≥ximo "quadro". <br><br>  Atualmente, a visualiza√ß√£o de cenas √© realizada principalmente usando a <b>tecnologia de varredura progressiva</b> .  Este √© um m√©todo de exibi√ß√£o, armazenamento ou transmiss√£o de imagens em movimento, em que todas as linhas de cada quadro s√£o desenhadas seq√ºencialmente. <br><br><img width="747" height="299" src="https://habrastorage.org/webt/bp/z5/u8/bpz5u84cyduvkd6izoangniaevs.png" alt="entrela√ßado e progressivo" title="entrela√ßado e progressivo"><br><br>  Bem ent√£o!  Agora sabemos como a imagem √© representada em formato digital, como suas cores s√£o organizadas, quantos bits por segundo gastamos para mostrar o v√≠deo se a velocidade de transmiss√£o for constante (CBR) ou vari√°vel (VBR).  Conhecemos uma determinada resolu√ß√£o usando uma determinada taxa de quadros, nos familiarizamos com muitos outros termos, como v√≠deo entrela√ßado, PAR e outros. <br><br><h2>  Remo√ß√£o de redund√¢ncia </h2><br>  Sabe-se que o v√≠deo sem compacta√ß√£o n√£o pode ser usado normalmente.  O v√≠deo por hora com uma resolu√ß√£o de 720p e uma frequ√™ncia de 30 quadros por segundo ocuparia 278 GB.  Chegamos a esse valor multiplicando 1280 x 720 x 24 x 30 x 3600 (largura, altura, bits por pixel, FPS e tempo em segundos). <br><br>  O uso de <b>algoritmos de compacta√ß√£o sem perdas</b> como DEFLATE (usado em PKZIP, Gzip e PNG) n√£o reduzir√° suficientemente a largura de banda necess√°ria.  Voc√™ precisa procurar outras maneiras de comprimir o v√≠deo. <br><br>  Para isso, voc√™ pode usar os recursos de nossa vis√£o.  Distinguimos melhor brilho do que cores.  Um v√≠deo √© um conjunto de imagens seq√ºenciais que se repetem com o tempo.  Existem pequenas diferen√ßas entre os quadros adjacentes da mesma cena.  Al√©m disso, cada quadro cont√©m muitas √°reas que usam a mesma cor (ou similar). <br><br><h2>  Cor, brilho e nossos olhos </h2><br>  Nossos olhos s√£o mais sens√≠veis ao brilho do que √† cor.  Voc√™ pode ver por si mesmo olhando para esta foto. <br><br><div style="text-align:center;"><img width="637" height="239" src="https://habrastorage.org/webt/gj/00/kv/gj00kvz32okevvthxqf9_jqi9ng.png" alt="  " title="brilho versus cor"></div><br><br>  Se voc√™ n√£o perceber que na metade esquerda da imagem as cores dos quadrados <b>A</b> e <b>B</b> s√£o realmente as mesmas, ent√£o isso √© normal.  Nosso c√©rebro nos faz prestar mais aten√ß√£o ao claro-escuro do que √† cor.  No lado direito entre os quadrados marcados, h√° um jumper da mesma cor - portanto, n√≥s (ou seja, nosso c√©rebro) podemos determinar facilmente que, de fato, a mesma cor est√° l√°. <blockquote>  Vejamos (simplificado) como nossos olhos funcionam.  O olho √© um √≥rg√£o complexo composto de muitas partes.  No entanto, estamos mais interessados ‚Äã‚Äãem cones e paus.  O olho cont√©m cerca de 120 milh√µes de hastes e 6 milh√µes de cones. <br><br>  Considere a percep√ß√£o de cor e brilho como fun√ß√µes separadas de certas partes do olho (de fato, tudo √© um pouco mais complicado, mas simplificaremos).  As c√©lulas-tronco s√£o respons√°veis ‚Äã‚Äãprincipalmente pelo brilho, enquanto as c√©lulas-cone s√£o respons√°veis ‚Äã‚Äãpela cor.  Os cones s√£o divididos em tr√™s tipos, dependendo do pigmento contido: cones S (azul), cones M (verde) e cones L (vermelho). <br><br>  Como temos muito mais bast√µes (brilho) do que cones (cores), podemos concluir que somos mais capazes de distinguir entre as transi√ß√µes entre escurid√£o e luz do que cores. <br><br><img width="672" height="373" src="https://habrastorage.org/webt/8z/ul/yl/8zulylhy-pkitzl5mubbzdcbswm.jpeg" alt=" " title="maquiagem dos olhos"><br><br><h2>  Fun√ß√µes de sensibilidade ao contraste </h2><br>  Pesquisadores em psicologia experimental e em muitos outros campos desenvolveram muitas teorias da vis√£o humana.  E um deles √© chamado de <b>fun√ß√µes de sensibilidade ao contraste</b> .  Eles est√£o associados √† ilumina√ß√£o espacial e temporal.  Em resumo, trata-se de quantas mudan√ßas s√£o necess√°rias antes que o observador as veja.  Observe o plural da palavra "fun√ß√£o".  Isso se deve ao fato de podermos medir as fun√ß√µes de sensibilidade para contrastar n√£o apenas com imagens em preto e branco, mas tamb√©m com cores.  Os resultados desses experimentos mostram que, na maioria dos casos, nossos olhos s√£o mais sens√≠veis ao brilho do que √† cor. </blockquote>  Como se sabe que somos mais sens√≠veis ao brilho da imagem, voc√™ pode tentar usar esse fato. <br><br><h2>  Modelo de cor </h2><br>  N√≥s descobrimos um pouco como trabalhar com imagens coloridas usando o esquema RGB.  Existem outros modelos.  Existe um modelo que separa a lumin√¢ncia da cor e √© conhecido como <b>YCbCr</b> .  A prop√≥sito, existem outros modelos que fazem uma separa√ß√£o semelhante, mas consideraremos apenas este. <br><br>  Nesse modelo de cores, <b>Y</b> √© uma representa√ß√£o do brilho e dois canais de cores s√£o usados: <b>Cb</b> (azul saturado) e <b>Cr</b> (vermelho saturado).  YCbCr pode ser obtido no RGB, assim como a transforma√ß√£o inversa √© poss√≠vel.  Usando esse modelo, podemos criar imagens coloridas, como podemos ver abaixo: <br><br><img src="https://habrastorage.org/webt/_y/ee/3x/_yee3xnjjk7xq1mpw_bvndfsnru.png" alt=" ycbcr" title="exemplo ycbcr"><br><br><h2>  Converter entre YCbCr e RGB </h2><br>  Algu√©m se opor√°: como √© poss√≠vel obter todas as cores se o verde n√£o for usado? <br><br>  Para responder a esta pergunta, converta RGB em YCbCr.  Utilizamos os coeficientes adotados no <b>padr√£o BT.601</b> , recomendado pela unidade <b>ITU-R</b> .  Esta unidade define os padr√µes de v√≠deo digital.  Por exemplo: o que √© 4K?  Qual deve ser a taxa de quadros, resolu√ß√£o, modelo de cores? <br><br>  Primeiro, calculamos o brilho.  Usamos as constantes propostas pela ITU e substitu√≠mos os valores RGB. <br><br>  <b>Y</b> = 0,299 <b>R</b> + 0,587 <b>G</b> + 0,114 <b>B</b> <br><br>  Depois de obter o brilho, separaremos as cores azul e vermelho: <br><br>  <b>Cb</b> = 0,564 ( <b>B</b> - <b>Y</b> ) <br><br>  <b>Cr</b> = 0,713 ( <b>R</b> - <b>Y</b> ) <br><br>  E tamb√©m podemos converter de volta e at√© ficar verde com o YCbCr: <br><br>  <b>R</b> = <b>Y</b> + 1,402 <b>Cr</b> <br><br>  <b>B</b> = <b>Y</b> + 1,772 <b>Cb</b> <br><br>  <b>G</b> = <b>Y</b> - 0,344 <b>Cb</b> - 0,714 <b>Cr</b> <br><br>  Como regra, os monitores (monitores, TVs, telas etc.) usam apenas o modelo RGB.  Mas esse modelo pode ser organizado de diferentes maneiras: <br><br><img width="550" height="550" src="https://habrastorage.org/webt/rq/is/by/rqisbywjfks_tvcpk7liyvyaiqw.jpeg" alt=" " title="geometria de pixel"><br><br><h2>  Redu√ß√£o de escala de cores </h2><br>  Com a imagem apresentada como uma combina√ß√£o de brilho e cor, podemos usar uma sensibilidade mais alta do sistema visual humano ao brilho do que √† cor se excluirmos as informa√ß√µes seletivamente.  A redu√ß√£o da amostragem de cores √© um m√©todo de codifica√ß√£o de imagens usando resolu√ß√£o mais baixa para cores do que para brilho. <br><br><div style="text-align:center;"><img width="715" height="361" src="https://habrastorage.org/webt/ce/ee/9_/ceee9_x9vh8b_vpklek7rnhvoz0.png" alt="ycbcr  " title="Permiss√µes de subamostragem Ycbcr"></div><br><br>  Qu√£o aceit√°vel √© reduzir a resolu√ß√£o de cores ?!  Acontece que j√° existem alguns esquemas que descrevem como lidar com a resolu√ß√£o e a mesclagem <nobr>(Cor final = Y + Cb + Cr).</nobr> <br><br>  Esses esquemas s√£o conhecidos como <b>sistemas de subamostragem</b> e s√£o expressos na forma de uma propor√ß√£o de tr√™s vezes - <b>a</b> : <b>x</b> : <b>y</b> , que determina o n√∫mero de amostras de sinais de lumin√¢ncia e diferen√ßa de cor. <br><br>  <b>a</b> - amostragem horizontal padr√£o (geralmente igual a 4) <br>  <b>x</b> - o n√∫mero de amostras de cores na primeira linha de pixels (resolu√ß√£o horizontal em rela√ß√£o a) <br>  <b>y</b> √© o n√∫mero de altera√ß√µes nas amostras de cores entre a primeira e a segunda linha de pixels. <blockquote>  A exce√ß√£o √© <b>4</b> : <b>1</b> : <b>0</b> , que fornece uma amostra de cor em cada bloco de resolu√ß√£o de brilho de 4 por 4. </blockquote>  Esquemas comuns usados ‚Äã‚Äãem codecs modernos: <br><br><ul><li>  <b>4</b> : <b>4</b> : <b>4</b> (sem redu√ß√£o da amostra) </li><li>  <b>4</b> : <b>2</b> : <b>2</b> </li><li>  <b>4</b> : <b>1</b> : <b>1</b> </li><li>  <b>4</b> : <b>2</b> : <b>0</b> </li><li>  <b>4</b> : <b>1</b> : <b>0</b> </li><li>  <b>3</b> : <b>1</b> : <b>1</b> </li></ul><blockquote><h3>  YCbCr 4: 2: 0 - Exemplo de mesclagem </h3><br>  Aqui est√° o fragmento de imagem combinado usando YCbCr 4: 2: 0.  Observe que gastamos apenas 12 bits por pixel. <br><br><div style="text-align:center;"><img width="555" height="315" src="https://habrastorage.org/webt/yq/fj/oi/yqfjoiza1glbn0rcj4nl0gfrsrm.png" alt="YCbCr 4:2:0" title="YCbCr 4: 2: 0"></div></blockquote>  √â assim que a mesma imagem codificada pelos principais tipos de subamostragem de cores se parece.  A primeira linha √© o YCbCr final, a linha inferior mostra a resolu√ß√£o da cor.  Resultados muito decentes, dada a pequena perda de qualidade. <br><br><img src="https://habrastorage.org/webt/q5/g_/-f/q5g_-f0w41riagjrnt3msc0a-us.jpeg" alt="  " title="exemplos de subamostragem de croma"><br><br>  Lembre-se, contamos 278 GB de espa√ßo de armazenamento para um arquivo de v√≠deo de uma hora com uma resolu√ß√£o de 720p e 30 quadros por segundo?  Se usarmos YCbCr 4: 2: 0, esse tamanho ser√° reduzido pela metade - 139 GB.  At√© agora, ainda est√° longe de ser um resultado aceit√°vel. <br><br>  Voc√™ pode obter o histograma YCbCr com FFmpeg.  Nesta imagem, o azul prevalece sobre o vermelho, que √© claramente vis√≠vel no pr√≥prio histograma. <br><br><img src="https://habrastorage.org/webt/gj/wa/lr/gjwalry6l_oeqssuishxlxtjrae.png"><blockquote><h4>  Cor, brilho, gama de cores - revis√£o de v√≠deo </h4><br>  √â recomend√°vel assistir a este v√≠deo incr√≠vel.  Isso explica o que √© brilho e, de fato, todos os pontos s√£o colocados sobre brilho e cor. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/Ymt47wXUDEU" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></blockquote><h2>  Tipos de quadro </h2><br>  N√≥s seguimos em frente.  Vamos tentar eliminar a redund√¢ncia no tempo.  Mas primeiro, vamos definir uma terminologia b√°sica.  Suponha que tenhamos um filme com 30 quadros por segundo, eis os quatro primeiros quadros: <br><br><img width="64" height="64" src="https://habrastorage.org/webt/iv/6n/5x/iv6n5xrkspmna4ysdwmx-geaavg.png" alt="ball 1" title="bola 1"><img width="64" height="64" src="https://habrastorage.org/webt/yx/pm/jb/yxpmjbgftbludyfwblix9e51mie.png" alt="ball 2" title="bola 2"><img width="64" height="64" src="https://habrastorage.org/webt/gp/wk/no/gpwknos5yniugafyfj-hk_a1pkk.png" alt="ball 3" title="bola 3"><img width="64" height="64" src="https://habrastorage.org/webt/-k/22/81/-k228175bwr2raujpfa-72p7hnm.png" alt="ball 4" title="bola 4"><br><br>  Podemos ver muitas repeti√ß√µes nos quadros: por exemplo, um fundo azul que n√£o muda de quadro para quadro.  Para resolver esse problema, podemos abstratamente classific√°-los como tr√™s tipos de quadros. <br><br><h3>  Quadro <b>I</b> (Quadro Intro) </h3><br>  O quadro I (quadro de refer√™ncia, quadro chave, quadro interno) √© aut√¥nomo.  Independentemente do que precisa ser visualizado, o quadro I √©, de fato, uma fotografia est√°tica.  O primeiro quadro geralmente √© um quadro I, mas observaremos regularmente os quadros I longe dos primeiros quadros. <br><br><img width="64" height="64" src="https://habrastorage.org/webt/iv/6n/5x/iv6n5xrkspmna4ysdwmx-geaavg.png" alt="ball 1" title="bola 1"><br><br><h3>  Moldura <b>P</b> (Moldura Redita <b>P</b> ) </h3><br>  O quadro P (quadro previsto) tira proveito do fato de que quase sempre a imagem atual pode ser reproduzida usando o quadro anterior.  Por exemplo, no segundo quadro, a √∫nica altera√ß√£o √© a bola para frente.  Podemos obter o quadro 2 apenas modificando levemente o quadro 1, usando apenas a diferen√ßa entre esses quadros.  Para criar o quadro 2, consulte o quadro 1 que o precede. <br><br><img width="64" height="64" src="https://habrastorage.org/webt/iv/6n/5x/iv6n5xrkspmna4ysdwmx-geaavg.png" alt="ball 1" title="bola 1">  ‚Üê <img width="64" height="64" src="https://habrastorage.org/webt/3o/-a/-_/3o-a-_o0jmv5vrg6wu2jmma0xpo.png" alt=" 1" title="bola 1"><br><br><h3>  Quadro <b>B</b> (Quadro <b>B</b> preditivo i) </h3><br>  E os links n√£o apenas para quadros passados, mas tamb√©m para quadros futuros, para fornecer uma compress√£o ainda melhor ?!  Este √© basicamente um quadro B (quadro bidirecional). <br><br><img width="64" height="64" src="https://habrastorage.org/webt/iv/6n/5x/iv6n5xrkspmna4ysdwmx-geaavg.png" alt="ball 1" title="bola 1">  ‚Üê <img width="64" height="64" src="https://habrastorage.org/webt/3o/-a/-_/3o-a-_o0jmv5vrg6wu2jmma0xpo.png" alt=" 1" title="bola 1">  ‚Üí <img width="64" height="64" src="https://habrastorage.org/webt/gp/wk/no/gpwknos5yniugafyfj-hk_a1pkk.png" alt="ball 3" title="bola 3"><br><br><h2>  Retirada intermedi√°ria </h2><br>  Esses tipos de quadros s√£o usados ‚Äã‚Äãpara fornecer a melhor compacta√ß√£o.  Discutiremos como isso acontece na pr√≥xima se√ß√£o.  Enquanto isso, observamos que o quadro I √© o mais "caro" em termos de mem√≥ria, o quadro P √© muito mais barato, mas o quadro B √© a op√ß√£o mais rent√°vel para o v√≠deo. <br><br><img src="https://habrastorage.org/webt/kb/tq/iv/kbtqivaoykzul7air0x-bi4p0nk.png" alt="  " title="exemplo de tipos de quadro"><br><br><h2>  Redund√¢ncia temporal (previs√£o entre quadros) </h2><br>  Vejamos quais oportunidades temos para minimizar as repeti√ß√µes de tempo.  Esse tipo de redund√¢ncia pode ser resolvido usando os m√©todos de previs√£o m√∫tua. <br><br>  Vamos tentar gastar o m√≠nimo de bits poss√≠vel para codificar uma sequ√™ncia de quadros 0 e 1. <br><br><img width="489" height="249" src="https://habrastorage.org/webt/_r/or/uu/_roruusxx8nchbiamc6hxqxv7ns.png" alt=" " title="quadros originais"><br><br>  Podemos <b>subtrair</b> , apenas subtrair o quadro 1 do quadro 0. Obtemos o quadro 1, usamos apenas a diferen√ßa entre ele e o quadro anterior; na verdade, apenas codificamos o restante resultante. <br><br><img width="334" height="330" src="https://habrastorage.org/webt/lz/1q/vm/lz1qvmad3_cjsaulbo4dy-qfwuc.png" alt=" " title="quadros delta"><br><br>  Mas e se eu lhe disser que existe um m√©todo ainda melhor que usa ainda menos bits ?!  Primeiro, vamos dividir o quadro 0 em uma grade clara de blocos.  E ent√£o tentamos comparar os blocos do quadro 0 com o quadro 1. Em outras palavras, avaliamos o movimento entre os quadros. <blockquote>  Wikipedia - <b>bloquear compensa√ß√£o de movimento</b> <br><br>  A compensa√ß√£o de movimento do bloco divide o quadro atual em blocos disjuntos e o vetor de compensa√ß√£o de movimento relata a origem dos blocos (um equ√≠voco comum √© que o quadro <i>anterior</i> √© dividido em blocos disjuntos, e os vetores de compensa√ß√£o de movimento informam para onde v√£o esses blocos. o quadro e o pr√≥ximo, n√£o √© para onde os blocos est√£o se movendo, mas de onde eles vieram).  Normalmente, os blocos de origem se sobrep√µem no quadro de origem.  Alguns algoritmos de compacta√ß√£o de v√≠deo coletam o quadro atual de partes n√£o apenas de um, mas de v√°rios quadros transmitidos anteriormente. </blockquote><img width="489" height="249" src="https://habrastorage.org/webt/mm/0n/r3/mm0nr3fmjnihn1xgvgeip8lnqcy.png" alt=" " title="quadros delta"><br><br>  No processo de avalia√ß√£o, vemos que a bola mudou de <nobr>(</nobr> <b>x</b> = 0, <b>y</b> = 25) para <nobr>(</nobr> <b>x</b> = 6, <b>y</b> = 26), os valores de <b>xey</b> determinam o vetor de movimento.  Outro passo que podemos dar para salvar os bits √© codificar apenas a diferen√ßa dos vetores de movimento entre a √∫ltima posi√ß√£o do bloco e a prevista, de modo que o vetor de movimento final ser√° <nobr>(x = 6-0 = 6, y = 26-25 = 1).</nobr> <br><br>  Em uma situa√ß√£o real, essa bola seria dividida em <b>n</b> blocos, mas isso n√£o muda a ess√™ncia da quest√£o. <br><br>  Os objetos no quadro se movem em tr√™s dimens√µes; portanto, quando a bola se move, ela pode se tornar visualmente menor (ou mais se se mover em dire√ß√£o ao espectador).  √â normal que n√£o haja combina√ß√£o perfeita entre os blocos.  Aqui est√° uma vis√£o combinada de nossa avalia√ß√£o e da imagem real. <br><br><img width="374" height="361" src="https://habrastorage.org/webt/g2/0v/lf/g20vlfrxrjfd2z5jopsrwtjeayu.png" alt=" " title="estimativa de movimento"><br><br>  Mas vemos que, quando aplicamos a estimativa de movimento, os dados para codifica√ß√£o s√£o muito menores do que quando usamos o m√©todo mais simples de calcular o delta entre os quadros. <br><br><img width="489" height="249" src="https://habrastorage.org/webt/al/yh/um/alyhumga0r2vz1sduqqpbbfwsf0.png" alt="   " title="delta de estimativa de movimento"><br><br><h2>  Como ser√° a compensa√ß√£o de movimento real </h2><br>  Essa t√©cnica se aplica imediatamente a todos os blocos.  Freq√ºentemente, nossa bola em movimento condicional ser√° dividida em v√°rios blocos ao mesmo tempo. <br><br><img src="https://habrastorage.org/webt/qd/r9/zi/qdr9zittbih-suwng4vhcktrini.png" alt="    " title="    "><br><br>      ,  <a href="https://jupyter.org/">Jupyter</a> . <br><br>             <a href="https://www.ffmpeg.org/">ffmpeg</a> . <br><br><img width="730" height="434" src="https://habrastorage.org/webt/8p/fz/y4/8pfzy4_x_u8rhx0e-qdwggcfz18.png" alt="  ( )   ffmpeg" title="  ( )   ffmpeg"><br><br>    <a href="https://software.intel.com/en-us/video-pro-analyzer">Intel Video Pro Analyzer</a> ( ,     ,      ). <br><br><img src="https://habrastorage.org/webt/gi/xv/2x/gixv2xsurl-vpyoqppvr_w9qtc4.png" alt="    " title="    "><br><br><h2>   ( ) </h2><br>      ,     . <br><br><img width="550" height="312" src="https://habrastorage.org/webt/cy/rt/wu/cyrtwua6vufuvoommyb-3ggyfu0.png"><br><br>    .          . <br><br><img width="277" height="156" src="https://habrastorage.org/webt/-i/yr/8r/-iyr8rtaba0yxiwgvrp0xzhpghg.png"><br><br>  I-.       ,    .    .      ,  ,     -  . <br><br><img width="278" height="413" src="https://habrastorage.org/webt/pi/2l/bg/pi2lbg2js6klz5_qepjcqtgevqq.png"><br><br> ,       .  ,         . <br><br><img width="246" height="404" src="https://habrastorage.org/webt/wy/qe/zt/wyqezt5qtss2h37wim8itgpgobe.png"><br><br>      .         (  ),      .     ,           . <br><br><img src="https://habrastorage.org/webt/ks/at/av/ksatavivnluz7pgxmawvtgixu1y.png"><br><br>      ,            ffmpeg.           ffmpeg. <br><br><img src="https://habrastorage.org/webt/70/pd/tq/70pdtqqlhlx-atda44tfwrygtna.png" alt="  ()   ffmpeg" title="  ( )   ffmpeg"><br><br>     Intel Video Pro Analyzer (    ,        10 ,       ). <br><br><img src="https://habrastorage.org/webt/_e/3x/f-/_e3xf-wuez64lr6x89oxhozl0a4.png" alt="- Intel Video Pro " title="  Intel Pro Pro"><br><br><hr><br><h3>  : <a href="https://habr.com/ru/company/edison/blog/480430/">  </a> </h3><br><hr><br><br> <a href="https://habr.com/ru/company/edison/blog/485460/"><img align="right" width="404" height="150" src="https://habrastorage.org/webt/2b/9i/gm/2b9igmgpbxunecpetjj6hhqsa9m.png"></a> <br clear="left"><h4>  Leia tamb√©m o blog <br>  Empresa EDISON: </h4><br>  <a href="https://habr.com/ru/company/edison/blog/485460/"><b>20 bibliotecas para</b></a> <a href="https://habr.com/ru/company/edison/blog/485460/"><b><br></b></a>  <a href="https://habr.com/ru/company/edison/blog/485460/"><b>aplica√ß√£o iOS espetacular</b></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt481418/">https://habr.com/ru/post/pt481418/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt481394/index.html">Recriar em um novo jogo o que amamos pelos velhos</a></li>
<li><a href="../pt481398/index.html">Comandos b√°sicos do Linux para testadores e mais</a></li>
<li><a href="../pt481402/index.html">Implementa√ß√£o pregui√ßosa de atravessar uma √°rvore de filhos da classe QObject</a></li>
<li><a href="../pt481406/index.html">Imers√£o profunda no investimento da Ilona Mask</a></li>
<li><a href="../pt481416/index.html">An√∫ncio do segundo Meetup da AWS em Minsk (13/02/2020)</a></li>
<li><a href="../pt481420/index.html">15 melhores e maiores bibliotecas de √≠cones</a></li>
<li><a href="../pt481424/index.html">Controles personalizados em Angular</a></li>
<li><a href="../pt481426/index.html">Benef√≠cios da arquitetura de microsservi√ßos para desenvolvimento de software</a></li>
<li><a href="../pt481428/index.html">Jogo para programadores FuncBall</a></li>
<li><a href="../pt481430/index.html">Como restaurar uma revista cient√≠fica na lista HAC</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>