<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤹🏻 🎀 🥔 VMware NSX untuk yang terkecil. Bagian 6. Penyiapan VPN 🚠 🌨️ 🤶🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bagian Satu Pendahuluan 
 Bagian Dua Konfigurasikan Firewall dan Aturan NAT 
 Bagian tiga. Pengaturan DHCP 
 Bagian Empat Pengaturan rute 
 Bagian Lim...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>VMware NSX untuk yang terkecil. Bagian 6. Penyiapan VPN</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/dataline/blog/454004/"><img src="https://habrastorage.org/webt/wq/yu/qy/wqyuqynprr8iaabtcn7nhbkqkje.png"><br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Bagian Satu</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Pendahuluan</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Bagian Dua</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Konfigurasikan Firewall dan Aturan NAT</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Bagian tiga.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Pengaturan DHCP</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Bagian Empat</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Pengaturan rute</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Bagian Lima</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Mengkonfigurasi penyeimbang beban</a> <br><br>  Hari ini kami melihat opsi konfigurasi VPN yang ditawarkan NSX Edge kepada kami. <br><br>  Secara umum, kami dapat membagi teknologi VPN menjadi dua jenis utama: <br><br><ul><li>  <b>VPN situs-ke-situs.</b>  Paling sering, IPSec digunakan untuk membuat terowongan yang aman, misalnya, antara jaringan kantor utama dan jaringan di situs terpencil atau di cloud. <br></li><li>  <b>VPN Akses Jarak Jauh.</b>  Ini digunakan untuk menghubungkan pengguna individu ke jaringan pribadi organisasi yang menggunakan perangkat lunak klien VPN. </li></ul><br>  NSX Edge memungkinkan kita untuk menggunakan kedua opsi tersebut. <br>  Kami akan mengonfigurasi menggunakan bangku tes dengan dua NSX Edge, server Linux dengan daemon <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">racoon</a> terpasang, dan laptop Windows untuk menguji Remote Access VPN. <a name="habracut"></a><br><br><h3>  IPsec </h3><br><ol><li>  Di antarmuka vCloud Director, buka bagian Administrasi dan pilih vDC.  Pada tab Edge Gateways, pilih Edge yang kami butuhkan, klik kanan dan pilih Edge Gateway Services. <br><img src="https://habrastorage.org/webt/gx/g_/7s/gxg_7s4odqm4vy8lgxitl79ahtu.png"></li><li>  Di antarmuka NSX Edge, buka tab VPN-IPsec VPN, lalu buka bagian IPsec VPN Sites dan klik + untuk menambahkan situs baru. <br><br><img src="https://habrastorage.org/webt/9w/kw/yz/9wkwyzxy6fwv6mm6tiw30juuemc.png"></li><li>  Isi kolom yang wajib diisi: <br><ul><li>  <b>Diaktifkan</b> - mengaktifkan situs jarak jauh. </li><li>  <b>PFS</b> - memastikan bahwa setiap kunci kriptografi baru tidak terkait dengan kunci sebelumnya. </li><li>  <b>ID Lokal dan Local Endpoin</b> t adalah alamat eksternal NSX Edge. </li><li>  <b>Subnet Lokal</b> - Jaringan lokal yang akan menggunakan IPsec VPN. </li><li>  <b>Peer ID dan Peer Endpoint</b> - alamat situs jarak jauh. </li><li>  <b>Peer Subnets</b> - jaringan yang akan menggunakan IPsec VPN di sisi jarak jauh. </li><li>  <b>Algoritma Enkripsi</b> - algoritma enkripsi terowongan. </li></ul><br><img src="https://habrastorage.org/webt/fr/2h/af/fr2haf6yil98f0e9p2tpjpsdlu8.png"><br><br><ul><li>  <b>Otentikasi</b> - bagaimana kami akan mengotentikasi sebuah pesta.  Anda dapat menggunakan Kunci Yang Dibagikan Sebelumnya atau sertifikat. </li><li>  <b>Pre-Shared Key</b> - tentukan kunci yang akan digunakan untuk otentikasi dan harus cocok di kedua sisi. </li><li>  <b>Diffie-Hellman Group</b> - algoritma pertukaran kunci. </li></ul><br>  Setelah mengisi bidang yang diperlukan, klik Simpan. <br><br><img src="https://habrastorage.org/webt/k9/yd/nk/k9ydnkf0ncd8dqajktdkux1wc58.png"></li><li>  Selesai <br><br><img src="https://habrastorage.org/webt/z9/ij/ot/z9ijot3wthx7dklptivvra-8pws.png"></li><li>  Setelah menambahkan situs, buka tab Status Aktivasi dan aktifkan Layanan IPsec. <br><br><img src="https://habrastorage.org/webt/p9/oc/la/p9oclawmegzrekhuxslid1cvnzu.png"></li><li>  Setelah pengaturan diterapkan, buka Statistik -&gt; tab IPsec VPN dan periksa status terowongan.  Kita melihat bahwa terowongan telah naik. <br><br><img src="https://habrastorage.org/webt/fn/ai/fm/fnaifmaxtxbfs-sumd9t5xyfhn0.png"></li><li>  Periksa status terowongan dari konsol Edge gateway: <br><ul><li>  tampilkan ipsec layanan - periksa status layanan. <br><br><img src="https://habrastorage.org/webt/tu/sv/_y/tusv_yq3-jzm_bavjx_fefpv_d0.png"></li><li>  tampilkan layanan situs ipsec - informasi tentang status situs dan parameter yang disepakati. <br><br><img src="https://habrastorage.org/webt/ct/ex/j0/ctexj0sypvimdsgyaogvob0rx1w.png"></li><li>  tampilkan layanan ipsec sa - Pemeriksaan status Asosiasi Keamanan (SA). <br><br><img src="https://habrastorage.org/webt/m2/of/ng/m2ofnggyimplhfnlvfvnec_yawa.png"></li></ul></li><li>  Cek Konektivitas Situs Jarak Jauh: <br><br><pre><code class="plaintext hljs">root@racoon:~# ifconfig eth0:1 | grep inet inet 10.255.255.1 netmask 255.255.255.0 broadcast 0.0.0.0 root@racoon:~# ping -c1 -I 10.255.255.1 192.168.0.10 PING 192.168.0.10 (192.168.0.10) from 10.255.255.1 : 56(84) bytes of data. 64 bytes from 192.168.0.10: icmp_seq=1 ttl=63 time=59.9 ms --- 192.168.0.10 ping statistics --- 1 packets transmitted, 1 received, 0% packet loss, time 0ms rtt min/avg/max/mdev = 59.941/59.941/59.941/0.000 ms</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">File konfigurasi dan perintah diagnostik tambahan dari server Linux jarak jauh:</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">root@racoon:~# cat /etc/racoon/racoon.conf log debug; path pre_shared_key "/etc/racoon/psk.txt"; path certificate "/etc/racoon/certs"; listen { isakmp 80.211.43.73 [500]; strict_address; } remote 185.148.83.16 { exchange_mode main,aggressive; proposal { encryption_algorithm aes256; hash_algorithm sha1; authentication_method pre_shared_key; dh_group modp1536; } generate_policy on; } sainfo address 10.255.255.0/24 any address 192.168.0.0/24 any { encryption_algorithm aes256; authentication_algorithm hmac_sha1; compression_algorithm deflate; } === root@racoon:~# cat /etc/racoon/psk.txt 185.148.83.16 testkey === root@racoon:~# cat /etc/ipsec-tools.conf #!/usr/sbin/setkey -f flush; spdflush; spdadd 192.168.0.0/24 10.255.255.0/24 any -P in ipsec esp/tunnel/185.148.83.16-80.211.43.73/require; spdadd 10.255.255.0/24 192.168.0.0/24 any -P out ipsec esp/tunnel/80.211.43.73-185.148.83.16/require; === root@racoon:~# racoonctl show-sa isakmp Destination Cookies Created 185.148.83.16.500 2088977aceb1b512:a4c470cb8f9d57e9 2019-05-22 13:46:13 === root@racoon:~# racoonctl show-sa esp 80.211.43.73 185.148.83.16 esp mode=tunnel spi=1646662778(0x6226147a) reqid=0(0x00000000) E: aes-cbc 00064df4 454d14bc 9444b428 00e2296e c7bb1e03 06937597 1e522ce0 641e704d A: hmac-sha1 aa9e7cd7 51653621 67b3b2e9 64818de5 df848792 seq=0x00000000 replay=4 flags=0x00000000 state=mature created: May 22 13:46:13 2019 current: May 22 14:07:43 2019 diff: 1290(s) hard: 3600(s) soft: 2880(s) last: May 22 13:46:13 2019 hard: 0(s) soft: 0(s) current: 72240(bytes) hard: 0(bytes) soft: 0(bytes) allocated: 860 hard: 0 soft: 0 sadb_seq=1 pid=7739 refcnt=0 185.148.83.16 80.211.43.73 esp mode=tunnel spi=88535449(0x0546f199) reqid=0(0x00000000) E: aes-cbc c812505a 9c30515e 9edc8c4a b3393125 ade4c320 9bde04f0 94e7ba9d 28e61044 A: hmac-sha1 cd9d6f6e 06dbcd6d da4d14f8 6d1a6239 38589878 seq=0x00000000 replay=4 flags=0x00000000 state=mature created: May 22 13:46:13 2019 current: May 22 14:07:43 2019 diff: 1290(s) hard: 3600(s) soft: 2880(s) last: May 22 13:46:13 2019 hard: 0(s) soft: 0(s) current: 72240(bytes) hard: 0(bytes) soft: 0(bytes) allocated: 860 hard: 0 soft: 0 sadb_seq=0 pid=7739 refcnt=0</code> </pre> <br></div></div></li><li>  Semuanya siap, VPN IPsec situs-ke-situs dikonfigurasikan dan berfungsi. <br><br>  Dalam contoh ini, kami menggunakan PSK untuk mengotentikasi peer, tetapi opsi otentikasi sertifikat juga dimungkinkan.  Untuk melakukan ini, buka tab Konfigurasi Global, aktifkan otentikasi sertifikat dan pilih sertifikat itu sendiri. <br><br>  Selain itu, dalam pengaturan situs akan perlu untuk mengubah metode otentikasi. <br><br><img src="https://habrastorage.org/webt/gv/x0/e8/gvx0e80ogisdslhrxbvcwci54gq.png"><br><br><img src="https://habrastorage.org/webt/uj/uf/xh/ujufxh2n4da4fcfb1hsrnlppv3w.png"><br><br>  Saya perhatikan bahwa jumlah terowongan IPsec tergantung pada ukuran Edge Gateway yang digunakan (baca tentang ini di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">artikel pertama</a> kami). <br><br><img src="https://habrastorage.org/webt/bf/sq/rv/bfsqrvatekltpr2xy1wx4b35t-q.png"></li></ol><br><h3>  SSL VPN </h3><br>  SSL VPN-Plus adalah salah satu opsi untuk Remote Access VPN.  Ini memungkinkan pengguna jarak jauh individu untuk terhubung dengan aman ke jaringan pribadi di belakang gateway NSX Edge.  Terenkripsi SSL VPN-plus tunnel didirikan antara klien (Windows, Linux, Mac) dan NSX Edge. <br><br><ol><li>  Mari mengatur.  Di panel kontrol layanan Edge Gateway, buka tab SSL VPN-Plus, lalu ke Pengaturan Server.  Kami memilih alamat dan port tempat server akan mendengarkan koneksi yang masuk, mengaktifkan pencatatan dan memilih algoritma enkripsi yang diperlukan. <br><br><img src="https://habrastorage.org/webt/o4/nt/hq/o4nthq3cjj_sh1pwpz-5bm0q1oo.png"><br><br>  Di sini Anda dapat mengubah sertifikat yang akan digunakan server. <br><br><img src="https://habrastorage.org/webt/ij/ep/eg/ijepegloixlveu3aa9juqhuegzg.png"></li><li>  Setelah semuanya siap, hidupkan server dan jangan lupa untuk menyimpan pengaturan. <br><br><img src="https://habrastorage.org/webt/ml/dz/pj/mldzpjn23fhhyljhr7zlre9tdcm.png"></li><li>  Selanjutnya, kita perlu mengonfigurasi kumpulan alamat yang akan kita terbitkan kepada klien ketika terhubung.  Jaringan ini terpisah dari setiap subnet yang ada di lingkungan NSX Anda, tidak perlu dikonfigurasi pada perangkat lain di jaringan fisik, kecuali untuk rute yang mengarah ke sana. <br><br>  Buka tab IP Pools dan klik +. <br><br><img src="https://habrastorage.org/webt/vb/yx/4x/vbyx4xh7xvbp4aacm0_dsrx4lau.png"></li><li>  Pilih alamat, subnet mask dan gateway.  Di sini Anda dapat mengubah pengaturan untuk server DNS dan WINS. <br><br><img src="https://habrastorage.org/webt/fy/s4/un/fys4unlo2c_-ees8uduwgw--_oa.png"></li><li>  Kolam yang dihasilkan. <br><br><img src="https://habrastorage.org/webt/2n/7_/lr/2n7_lrsb5jjtgi9o8vgbkrijck4.png"></li><li>  Sekarang tambahkan jaringan yang akan diakses pengguna yang terhubung ke VPN.  Buka tab Jaringan Pribadi dan klik +. <br><br><img src="https://habrastorage.org/webt/cp/xj/c5/cpxjc55glum1i7qbultrqxeelwq.png"></li><li>  Kami mengisi: <br><br><ul><li>  Jaringan - jaringan lokal di mana pengguna jarak jauh akan memiliki akses. </li><li>  Kirim traffic, ia memiliki dua opsi: <br>  - over tunnel - mengirim lalu lintas ke jaringan melalui terowongan, <br>  - memotong terowongan - mengirim lalu lintas ke jaringan secara langsung memotong terowongan. </li><li>  Aktifkan TCP Optimization - tandai jika opsi over tunnel dipilih.  Ketika optimalisasi diaktifkan, Anda dapat menentukan nomor port yang ingin Anda optimalkan lalu lintas.  Lalu lintas untuk port yang tersisa dari jaringan khusus ini tidak akan dioptimalkan.  Jika nomor port tidak ditentukan, lalu lintas untuk semua port dioptimalkan.  Baca lebih lanjut tentang fitur ini di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sini</a> . </li></ul><br><img src="https://habrastorage.org/webt/6z/pm/c7/6zpmc7-cic6jlregwi2ylyt9apu.png"></li><li>  Selanjutnya, buka tab Otentikasi dan klik +.  Untuk otentikasi, kami akan menggunakan server lokal di NSX Edge itu sendiri. <br><br><img src="https://habrastorage.org/webt/aq/kx/bp/aqkxbp8ux9csyx2bui2o5hxdtjc.png"></li><li>  Di sini kita dapat memilih kebijakan untuk membuat kata sandi baru dan mengonfigurasi opsi untuk memblokir akun pengguna (misalnya, jumlah coba lagi ketika kata sandi dimasukkan secara salah). <br><br><img src="https://habrastorage.org/webt/oz/gd/mi/ozgdmimubqauqwo6gymipuvv8va.png"><br><br><img src="https://habrastorage.org/webt/cp/6n/fl/cp6nflis843n8edmtjimkmk2gdo.png"></li><li>  Karena kami menggunakan otentikasi lokal, kami perlu membuat pengguna. <br><br><img src="https://habrastorage.org/webt/sb/ui/kt/sbuikttq8ew3bu8rhqt4kpiq7ho.png"></li><li>  Selain hal-hal dasar seperti nama dan kata sandi, di sini Anda dapat, misalnya, mencegah pengguna mengubah kata sandi atau, sebaliknya, memaksanya untuk mengubah kata sandi pada login berikutnya. <br><br><img src="https://habrastorage.org/webt/ki/am/qw/kiamqwt8jphlg5f0b_b2ifa4-wy.png"></li><li>  Setelah semua pengguna yang diperlukan telah ditambahkan, buka tab Paket Instalasi, klik + dan buat installer itu sendiri, yang akan mengunduh karyawan jarak jauh untuk instalasi. <br><br><img src="https://habrastorage.org/webt/wg/js/4t/wgjs4tj0efxxlrj9mcpu-gql2z4.png"></li><li>  Klik +.  Kami memilih alamat dan port server tempat klien akan terhubung, dan platform yang Anda inginkan untuk menghasilkan paket instalasi. <br><br><img src="https://habrastorage.org/webt/gd/sx/i4/gdsxi44atfhzs0yh-wcv8gooqp8.png"><br><br>  Anda dapat menentukan pengaturan klien untuk Windows di bawah ini di jendela ini.  Pilih: <br><br><ul><li>  mulai klien saat masuk - klien VPN akan ditambahkan ke startup pada mesin jarak jauh; </li><li>  buat ikon desktop - akan membuat ikon klien VPN di desktop; </li><li>  validasi sertifikat keamanan server - akan memvalidasi sertifikat server saat tersambung. <br>  Pengaturan server selesai. </li></ul><br><img src="https://habrastorage.org/webt/7j/po/ia/7jpoiawbsxmetmvijnvnvtu7mfm.png"></li><li>  Sekarang unduh paket instalasi yang kami buat pada langkah terakhir pada PC jarak jauh.  Saat mengatur server, kami menentukan alamat eksternal (185.148.83.16) dan port (445).  Ke alamat ini kita harus pergi ke browser web.  Dalam kasus saya, ini adalah <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">185.148.83.16</a> : 445. <br><br>  Di jendela otorisasi, Anda harus memasukkan kredensial pengguna yang kami buat sebelumnya. <br><br><img src="https://habrastorage.org/webt/w6/5t/b3/w65tb3thu0i3yvh2wkp0dq5enc4.png"></li><li>  Setelah otorisasi, kami melihat daftar paket instalasi yang dibuat tersedia untuk diunduh.  Kami hanya membuat satu - dan mengunduhnya. <br><br><img src="https://habrastorage.org/webt/62/_m/af/62_mafqhlxpqpqa3wrq5g_9gpvo.png"></li><li>  Kami mengklik tautan, pengunduhan klien dimulai. <br><br><img src="https://habrastorage.org/webt/du/1n/th/du1nth1rhphihfhpctp1hmnk1es.png"></li><li>  Buka kemasan arsip yang diunduh dan jalankan penginstalnya. <br><br><img src="https://habrastorage.org/webt/np/bs/69/npbs69o4arrddkvwqxrvomnn5l0.png"></li><li>  Setelah instalasi, jalankan klien, di jendela otorisasi, klik Login. <br><br><img src="https://habrastorage.org/webt/og/lq/uc/oglqucpuesvmhe8tj9kphxxeqdk.png"></li><li>  Di jendela verifikasi sertifikat, pilih Ya. <br><br><img src="https://habrastorage.org/webt/nf/m3/da/nfm3dacakvoreocayzwrmacmjoa.png"></li><li>  Kami memasukkan kredensial untuk pengguna yang dibuat sebelumnya dan melihat bahwa koneksi berhasil diselesaikan. <br><br><img src="https://habrastorage.org/webt/zz/ot/_r/zzot_riaf24alcpw2cmobskcl0c.png"><br><br><img src="https://habrastorage.org/webt/yq/d5/dz/yqd5dzwb3yarbdaqidoxk-g2l2a.png"></li><li>  Periksa statistik klien VPN di komputer lokal. <br><br><img src="https://habrastorage.org/webt/mf/qi/yi/mfqiyi-qzvx7_aiyptg-jb7yocy.jpeg"><br><br><img src="https://habrastorage.org/webt/qv/no/fr/qvnofrg8hclsrdjrp1lo-pdkdom.jpeg"></li><li>  Pada baris perintah Windows (ipconfig / all) kita melihat bahwa adaptor virtual tambahan telah muncul dan ada konektivitas dengan jaringan jarak jauh, semuanya berfungsi: <br><br><img src="https://habrastorage.org/webt/01/hf/5t/01hf5tzh6ej5o-6pq8a4wkms2dq.jpeg"><br><br><img src="https://habrastorage.org/webt/qb/km/he/qbkmhe0m1q1hfrhlceovxla3ldw.png"></li><li>  Dan akhirnya - cek dari konsol Edge Gateway. <br><br><img src="https://habrastorage.org/webt/2e/ot/wr/2eotwriama_etzynpyasqcimg2k.png"></li></ol><br><h3>  L2 VPN </h3><br>  L2VPN diperlukan ketika Anda perlu menggabungkan beberapa secara geografis <br>  jaringan terdistribusi dalam satu domain siaran. <br><br>  Ini dapat berguna, misalnya, ketika memigrasi mesin virtual: ketika VM pindah ke situs geografis lain, mesin akan menyimpan pengaturan pengalamatan IP dan tidak akan kehilangan konektivitas dengan mesin lain yang terletak di domain L2 yang sama dengannya. <br><br>  Dalam lingkungan pengujian kami, kami akan menghubungkan dua situs satu sama lain, kami akan menyebutnya masing-masing A dan B. Kami memiliki dua NSX dan dua jaringan yang dirutekan secara identik yang terhubung ke Edge yang berbeda.  Mesin A memiliki alamat 10.10.10.250/24, mesin B memiliki alamat 10.10.10.2/24. <br><br><ol><li>  Di vCloud Director, buka tab Administration, pergi ke VDC yang kita butuhkan, buka tab Org VDC Networks dan tambahkan dua jaringan baru. <br><br><img src="https://habrastorage.org/webt/jh/8x/oa/jh8xoarvrbmyd0cexp1forwc5fo.png"></li><li>  Kami memilih jenis jaringan yang diarahkan dan mengikat jaringan ini ke NSX kami.  Kami menempatkan kotak centang Buat sebagai subinterface. <br><br><img src="https://habrastorage.org/webt/ke/fa/gp/kefagptrkwzznjydhktrom9g2ww.png"></li><li>  Akibatnya, kita harus mendapatkan dua jaringan.  Dalam contoh kita, mereka disebut network-a dan network-b dengan pengaturan gateway yang sama dan mask yang sama. <br><br><img src="https://habrastorage.org/webt/s2/fs/m0/s2fsm0dcmiqyrka4acercwf26ww.png"><br><br><img src="https://habrastorage.org/webt/ev/mr/k8/evmrk8fmiyzemartcv_hjakdhus.png"></li><li>  Sekarang mari kita beralih ke pengaturan NSX pertama.  Ini akan menjadi NSX yang terhubung dengan jaringan A. Ini akan bertindak sebagai server. <br><br>  Kembali ke antarmuka NSx Edge / Buka VPN -&gt; tab L2VPN.  Kami mengaktifkan L2VPN, pilih mode operasi Server, dalam pengaturan Server Global, tentukan alamat IP eksternal NSX, di mana port untuk terowongan akan didengarkan.  Secara default, soket akan terbuka pada port 443, tetapi dapat diubah.  Jangan lupa untuk memilih pengaturan enkripsi untuk terowongan masa depan. <br><br><img src="https://habrastorage.org/webt/5s/cp/yl/5scpylcprxcu_wmgtvgwxqi3bv0.png"></li><li>  Buka tab Server Sites dan tambahkan sebuah pesta. <br><br><img src="https://habrastorage.org/webt/9u/az/bm/9uazbmzmfihywslasekwqmrhm1o.png"></li><li>  Nyalakan pesta, atur nama, deskripsi, jika perlu, atur nama pengguna dan kata sandi.  Kami akan membutuhkan data ini nanti ketika menyiapkan situs klien. <br><br>  Di Alamat Gateway Optimasi Egress, tetapkan alamat gateway.  Ini diperlukan agar tidak ada konflik alamat IP, karena gateway di jaringan kami memiliki alamat yang sama.  Kemudian kita tekan tombol SELECT SUB-INTERFACES. <br><br><img src="https://habrastorage.org/webt/lh/y8/t2/lhy8t2pxycomacepgel1vess6jy.png"></li><li>  Di sini kita memilih subinterface yang diinginkan.  Simpan pengaturan. <br><br><img src="https://habrastorage.org/webt/_o/hn/3l/_ohn3lperjba15rifdy6yyzvk0u.png"></li><li>  Kami melihat bahwa situs klien yang baru dibuat muncul di pengaturan. <br><br><img src="https://habrastorage.org/webt/sd/p_/lf/sdp_lf6amh08k9aexlsxl724ioc.png"></li><li>  Sekarang mari kita beralih ke mengkonfigurasi NSX di sisi klien. <br><br>  Kami pergi ke sisi NSX B, pergi ke VPN -&gt; L2VPN, nyalakan L2VPN, atur mode L2VPN ke mode klien.  Pada tab Global Client, atur alamat dan port NSX A, yang sebelumnya kami tunjukkan sebagai Listening IP and Port di sisi server.  Anda juga perlu mengatur pengaturan enkripsi yang sama agar konsisten ketika menaikkan terowongan. <br><br><img src="https://habrastorage.org/webt/wn/yx/ug/wnyxug_ioltwju3lcqh-fzqk2sy.png"><br><br>  Gulir ke bawah, pilih subinterface di mana terowongan untuk L2VPN akan dibangun. <br>  Di Alamat Gateway Optimasi Egress, tetapkan alamat gateway.  Tetapkan user-id dan kata sandi.  Kami memilih subinterface dan jangan lupa untuk menyimpan pengaturan. <br><br><img src="https://habrastorage.org/webt/bi/bf/qj/bibfqjjaw-s5rridzyz_vxtb_ng.png"></li><li>  Itu saja, sebenarnya.  Pengaturan klien dan server hampir identik, dengan pengecualian beberapa nuansa. </li><li>  Sekarang kita bisa melihat apa yang didapat terowongan kita dengan masuk ke Statistik -&gt; L2VPN di NSX apa pun. <br><br><img src="https://habrastorage.org/webt/dj/uj/iu/djujiuzlvgswhq1osmpajodl4fe.png"></li><li>  Jika kita masuk ke konsol Edge Gateway sekarang, kita akan melihat alamat kedua VM di masing-masingnya di tabel arp. <br><br><img src="https://habrastorage.org/webt/uy/si/r8/uysir84foday_fr6xip0tku5sca.png"></li></ol><br><br>  Itu semua tentang VPN di NSX Edge.  Tanyakan apakah ada sesuatu yang tidak jelas.  Ini juga merupakan bagian terakhir dari serangkaian artikel tentang bekerja dengan NSX Edge.  Semoga bermanfaat :) </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id454004/">https://habr.com/ru/post/id454004/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id453994/index.html">Badoo Techleads Meetup # 4. Kelelahan dan motivasi profesional</a></li>
<li><a href="../id453996/index.html">Uhhhhhh. Cara menjual di Internet tanpa situs web</a></li>
<li><a href="../id453998/index.html">Aeroexpress: pergi ke depot</a></li>
<li><a href="../id454000/index.html">SENYUM BUKANLASIK. Tentang koreksi penglihatan laser</a></li>
<li><a href="../id454002/index.html">Eksperimen: Cara menutupi Tor menggunakan untuk memotong kunci</a></li>
<li><a href="../id454006/index.html">Tentang TI tanpa ikatan: Promosi, retensi, dan omset perusahaan di CIS dan AS</a></li>
<li><a href="../id454010/index.html">Pendidikan Tinggi dan Berkelanjutan di TI: Hasil Studi Lingkaran Saya</a></li>
<li><a href="../id454012/index.html">Akhir dari era perangkat perbaikan. Bagaimana Apple dan Amazon Membersihkan Pedagang Elektronik Lama</a></li>
<li><a href="../id454016/index.html">3CX v16 Pembaruan 1, aplikasi 3CX untuk iOS Beta dan versi baru 3CX Call Flow Designer</a></li>
<li><a href="../id454018/index.html">iOS Digest No. 6 (17 Mei - 30 Mei)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>