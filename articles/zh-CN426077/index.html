<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🔔 👩🏼‍💼 🙆🏻 新的TeleBots Cyber​​group后门：工业证明和NotPetya链接的首个证明 ✍🏽 ⭕️ 🧑🏻‍🤝‍🧑🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="对NotPetya编码器流行背后的TeleBots网络集团的新后门进行的一项研究表明，该代码与Industroyer主后门具有显着的相似性，从而证实了之前的传言。 


 近年来最大的网络事件之一是对乌克兰能源企业的 攻击和NotPetya编码器的流行 。 在帖子中，我们将检查这些事件之间的关系。 ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>新的TeleBots Cyber​​group后门：工业证明和NotPetya链接的首个证明</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/eset/blog/426077/">对NotPetya编码器流行背后的TeleBots网络集团的新后门进行的一项研究表明，该代码与Industroyer主后门具有显着的相似性，从而证实了之前的传言。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/9x/gy/6j/9xgy6jvrselsayjand3fqqjfzuk.jpeg"></div><br> 近年来最大的网络事件之一是对乌克兰<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">能源企业的</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">攻击</a>和<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">NotPetya编码器</a>的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">流行</a> 。 在帖子中，我们将检查这些事件之间的关系。 <br><br><a name="habracut"></a> 由于<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">BlackEnergy</a>恶意软件<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">软件包</a> ，历史上第一次由网络攻击引起的大规模停电发生在2015年12月。 在此次活动之前和之后，ESET专家都使用BlackEnergy <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">监控了</a> ART组的活动。 在2015年停电之后，该小组显然关闭了与BlackEnergy的积极合作，并发展成为我们现在称为<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">TeleBots的组织</a> 。 <br><br> 这里应该注意的是，在谈论ART小组时，我们会考虑一般的技术指标：代码相似性，通用网络（C＆C）基础结构，恶意软件执行链等。通常，我们不直接参与开发人员或机构的调查和识别。操作员。 术语“ ART组”没有明确的定义，通常用于表征恶意软件参数。 出于这些原因，我们避免猜测攻击源，攻击者的国家或州身份。 <br><br> 无论如何，我们发现BlackEnergy攻击（针对乌克兰能源公司以及其他行业和高级设施）与TeleBots团体运动（主要针对乌克兰金融部门）之间存在联系。 <br><br>  2017年6月，全球各地的公司都遭受<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Diskcoder.C viper</a> （更名为Petya / NotPetya）的困扰-感染的大规模性质显然是一种副作用。 通过研究该事件，我们发现受到<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">TeleBots组后门</a>感染的公司成为这种流行病的“零病人”，这是由于在乌克兰公司中流行的MEDoc会计软件遭到破坏。 <br><br> 问题是， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Industroyer</a>与这个故事有什么关系？这个复杂的恶意软件导致2016年12月在基辅停电。  ESET报告发布后，一些信息安全公司和媒体立即建议Industroyer成立了BlackEnergy / TeleBots小组（有时也称为Sandworm）。 但是，迄今为止尚未提交任何证据。 <br><br> 在2018年4月，我们记录了TeleBots组的一项新活动-尝试部署新的<b>Win32 / Exaramel后门</b> 。 我们的分析表明，此后门是Industroyer主后门的改进版本-这是第一个证明。 <br><br><img src="https://habrastorage.org/webt/wr/q4/8t/wrq48tqiohrrau3omuybnkgekh8.png"><br><br><h2>  Win32 / Exaramel后门分析 </h2> <br>  Win32 / Exaramel后门最初是使用吸管安装的。 根据dropper的元数据，在将后门部署到特定的受感染计算机之前，该后门已立即编译到Microsoft Visual Studio中。 <br><br><img src="https://habrastorage.org/webt/cn/ad/2j/cnad2jaagghbga--dtzrfttj6o8.png"><br>  <i>图1. Win32 / Exaramel后门滴管的PE时间戳</i> <br><br> 执行后，放置器将Win32 / Exaramel二进制文件放入Windows系统目录中，并以名称<code>wsmproav</code>启动Windows服务，并描述为“ Windows Check AV”。  Windows服务的文件名和描述都在滴管中进行了硬编码。 <br><br><img src="https://habrastorage.org/webt/5z/sp/5l/5zsp5lzsejmdmt3b5jlr0un7rlo.png"><br>  <i>图2. Win32 / Exaramel后门创建的Windows服务注册表设置</i> <br><br> 此外，放置程序将后门配置以XML格式写入Windows注册表。 <br><br><img src="https://habrastorage.org/webt/ra/id/sr/raidsre0afcy2xxbvvapqpt9tmq.png"><br>  <i>图3. Win32 / Exaramel的XML配置</i> <br><br> 该配置包括几个块： <br><br>  - <i>间隔</i> -睡眠功能所用的时间（以毫秒为单位） <br>  - <i>服务器</i> -命令服务器（C＆C）列表 <br>  - <i>检查</i> -用于确定主机是否可以访问Internet的网站 <br>  - <i>代理</i> -主机网络中的代理服务器 <br>  - <i>存储</i> -用于存储要渗透的文件的路径 <br><br> 从配置的第一行可以看到，攻击者根据使用的防病毒产品对目标进行分组。 在Industroyer组合物中使用了类似的方法-特别是，某些Industroyer后门也伪装成一种防病毒服务（以<code>avtask.exe</code>的名称<code>avtask.exe</code> ），并使用相同的方法进行分组。 <br><br> 另一个有趣的事实是，后门使用C＆C服务器，其域名模仿了属于ESET的域。 除了上述配置中的<code>esetsmart[.]org</code> ，我们还发现了一个类似的域<code>um10eset[.]net</code> ，该域<code>um10eset[.]net</code>最近打开的Linux版本的TeleBots恶意软件使用。 重要的是要注意，这些由攻击者控制的服务器与<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">合法的ESET网络基础结构</a>无关。 目前，我们还没有发现Exaramel使用的域可以模仿其他信息安全公司的基础架构。 <br><br> 启动后，后门将与C＆C服务器建立连接，并接收要在系统中执行的命令。 以下是可用命令的列表： <br><br>  -开始过程 <br>  -从特定的Windows用户启动进程 <br>  -将数据写入给定路径的文件中 <br>  -将文件复制到存储子目录（下载文件） <br>  -运行shell命令 <br>  -从特定的Windows用户运行shell命令 <br>  -使用<code>MSScriptControl.ScriptControl.1</code>运行VBS代码<code>MSScriptControl.ScriptControl.1</code> <br><br>  Win32 / Exaramel中的命令循环代码和前六个命令的实现与Industroyer软件包中的后门非常相似。 <br><br><img src="https://habrastorage.org/webt/dh/2m/z7/dh2mz7u12gct6ja5rcogi2nfqze.png"><br>  <i>图4.反编译的Win32 / Exaramel后门代码（左）和Win32 / Industroyer（右）的比较</i> <br><br> 这两个恶意软件家族都使用报告文件来存储已执行的Shell命令和正在运行的进程的输出。 如果是Win32 / Industroyer后门，则报告文件将以随机名称存储在一个临时文件夹中。 在Win32 / Exaramel中，报告文件名为<code>report.txt</code> ，并且其到存储库的路径在后门配置文件中指定。 <br><br> 要将标准输出（stdout）和标准错误（stderr）重定向到报告文件，两个后门都将<code>hStdOutput</code>和<code>hStdError</code>参数设置为报告文件描述符。 这是这些恶意软件家族之间的另一个相似之处。 <br><br><img src="https://habrastorage.org/webt/1b/hu/13/1bhu13rxf11if_z6tz-hwazje1c.png"><br>  <i>图5.分别对反编译的Win32 / Exaramel和Win32 / Industroyer后门代码进行比较</i> <br><br> 如果恶意软件操作员想要从受害者的计算机中窃取文件，则只需将这些文件复制到配置中指定的<code>data</code>存储路径的子目录中。 在与C＆C服务器建立新连接之前，后门将在发送文件之前自动压缩和加密这些文件。 <br><br>  Industroyer后门与新的TeleBots后门之间的主要区别在于，后者使用XML格式进行通信和配置，而不是使用自定义二进制格式。 <br><br><h2> 恶意密码盗窃工具 </h2><br>  TeleBots小组与Exaramel一起使用了一些旧工具，包括密码盗窃工具（内部名称为CredRaptor或PAI）和稍作修改的Mimikatz。 <br><br> 自2016年以来仅由该小组使用的高级密码窃取工具CredRaptor已完成。 与以前的版本不同，它不仅从浏览器收集已保存的密码，而且还从Outlook和许多FTP客户端收集已保存的密码。 以下是受支持的应用程序的列表： <br><br>  -BitKinex FTP <br>  -BulletProof FTP客户端 <br>  -经典FTP <br>  -咖啡杯子 <br>  -核心FTP <br>  -Cryer WebSitePublisher <br>  -CuteFTP <br>  -FAR经理 <br>  -filezilla <br>  -FlashFXP <br>  -护卫舰3 <br>  -FTP指挥官 <br>  -FTP资源管理器 <br>  -FTP导航器 <br>  -谷歌浏览器 <br>  -Internet Explorer 7-11 <br>  -Mozilla Firefox <br>  -歌剧 <br>  -Outlook 2010、2013、2016 <br>  -SmartFTP <br>  -SoftX FTP客户端 <br>  -总指挥官 <br>  -TurboFTP <br>  -Windows保险柜 <br>  -WinSCP <br>  -WS_FTP客户端 <br><br> 这些改进使攻击者可以从网站的网站管理员帐户和内部基础结构中的服务器收集数据。 有权访问此类服务器，您可以安装其他后门。 通常，这些服务器安装的操作系统不是Windows，因此攻击者必须改编后门。 <br><br> 在事件响应期间，我们发现了TeleBots的Linux后门<b>-Linux / Exaramel.A</b> 。 <br><br><h2>  Linux / Exaramel后门分析 </h2><br> 后门用Go编程语言编写，并编译为64位ELF二进制文件。 攻击者可以使用任何名称在所选目录中部署后门。 <br><br> 如果后门是由攻击者以字符串“ none”作为命令行参数执行的，则它会尝试使用持久性机制在重新启动后自动启动。 如果后门未在root帐户下运行，则使用<code>crontab</code>文件。 但是，如果以root身份运行，则它支持各种Linux <code>init</code>系统。 通过执行以下命令，可以确定当前正在使用哪个<code>init</code>系统： <br><br> <code>strings /sbin/init | awk 'match($0, /(upstart|systemd|sysvinit)/){ print substr($0, RSTART, RLENGTH);exit; }'</code> <br> <br> 根据结果​​，后门使用以下硬编码位置来确保持久性（以下称为Init系统及其位置）： <br><br>  <b>sysvinit-/etc</b> /init.d/syslogd <br>  <b>新贵</b> -/etc/ <b>init</b> /syslogd.conf <br>  <b>systemd-</b> /etc/ <b>systemd/system</b> /syslogd.service <br><br> 在启动期间，后门尝试打开配置文件，该文件与后门存储在相同目录下，名称为<code>config.json</code> 。 如果配置文件不存在，则创建一个新文件。 使用<b>s0m3t3rr0r</b>密钥和RC4算法对配置进行加密。 <br><br><img src="https://habrastorage.org/webt/rl/5w/yf/rl5wyfa7qmt6ryiafwrdejw_ezu.png"><br>  <i>图6.解密的Linux / Exaramel后门JSON配置</i> <br><br> 后门连接到硬编码的C＆C（默认情况下，在我们看到的示例中为176.31.225 [。] 204）或配置文件中指定为<code>Hosts</code>的C＆C服务器。 通信是通过HTTPS进行的。 后门支持以下命令： <br><br>  <b>App.Update-</b>更新到新版本 <br>  <b>App.Delete-</b>从系统中自动<b>删除</b> <br>  <b>App.SetProxy-</b>在配置中设置代理服务器设置 <br>  <b>App.SetServer-</b>更新配置中的C＆C服务器 <br>  <b>App.SetTimeout-</b>设置超时值（与C＆C服务器的连接之间的间隔） <br>  <b>IO.WriteFile-</b>从远程服务器下载文件 <br>  <b>IO.ReadFile-将</b>文件从本地磁盘<b>上传</b>到C＆C服务器 <br>  <b>OS.ShellExecute-</b>执行Shell命令 <br><br><h2> 结论 </h2><br>  Exaramel的开业表明，TeleBots小组在2018年仍然活跃，攻击者继续改进战术和工具。 <br><br>  Win32 / Exaramel代码与Industroyer主后门之间的显着相似之处是第一个公开发表的证据，该证据将Industroyer与TeleBots组联系在一起，因此也与NotPetya和BlackEnergy网络活动联系在一起。 在网络攻击的来源之间建立联系时，值得考虑错误或故意欺骗的可能性，但是在这种情况下，我们认为这不太可能。 <br><br> 值得注意的是，Exaramel后门的Win32和Linux版本是在与该行业无关的组织中发现的。  ESET专家向乌克兰调查部门报告了这一发现，因此及时发现并阻止了攻击。 <br><br>  ESET继续监视该网络组的活动。 <br><br><h2> 危害指标（IoC） </h2><br><h4>  ESET检测 </h4><br> <code>Win32/Exaramel trojan <br> Win32/Agent.TCD trojan <br> Linux/Agent.EJ trojan <br> Linux/Exaramel.A trojan <br> Win32/PSW.Agent.OEP trojan <br> Win32/RiskWare.Mimikatz.Z application <br> Win64/Riskware.Mimikatz.AI application</code> <br> <br><h4>  SHA-1哈希 </h4><br>  <b>后门Win32 / Exaramel Cyber​​group TeleBots</b> <br> <code>65BC0FF4D4F2E20507874F59127A899C26294BC7 <br> 3120C94285D3F86A953685C189BADE7CB575091D</code> <br> <br>  <b>密码盗窃工具</b> <br> <code>F4C4123849FDA08D1268D45974C42DEB2AAE3377 <br> 970E8ACC97CE5A8140EE5F6304A1E7CB56FA3FB8 <br> DDDF96F25B12143C7292899F9D5F42BB1D27CB20 <br> 64319D93B69145398F9866DA6DF55C00ED2F593E <br> 1CF8277EE8BF255BB097D53B338FC18EF0CD0B42 <br> 488111E3EB62AF237C68479730B62DD3F52F8614</code> <br> <br>  <b>米米卡茨</b> <br> <code>458A6917300526CC73E510389770CFF6F51D53FC <br> CB8912227505EF8B8ECCF870656ED7B8CA1EB475</code> <br> <br>  <b>Linux / Exaramel</b> <br> <code>F74EA45AD360C8EF8DB13F8E975A5E0D42E58732</code> <br> <br><h4>  C＆C服务器 </h4><br> <code>um10eset[.]net (IP: 176.31.225.204) <br> esetsmart[.]org (IP: 5.133.8.46)</code> </div> </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN426077/">https://habr.com/ru/post/zh-CN426077/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN426063/index.html">HPE MSA入门级阵列创新：更实惠的闪存阵列和丰富的解决方案集成</a></li>
<li><a href="../zh-CN426065/index.html">智能电视本身决定了最有趣的频道，还是一种独特的视频内容数独解决方案</a></li>
<li><a href="../zh-CN426067/index.html">像两次大火一样移动？ 再次关于人员搬迁</a></li>
<li><a href="../zh-CN426071/index.html">哪些促销吸引服装店？</a></li>
<li><a href="../zh-CN426073/index.html">进口替代，故事继续（续）</a></li>
<li><a href="../zh-CN426079/index.html">未经授权授权：我们不会收集个人数据</a></li>
<li><a href="../zh-CN426081/index.html">如何组织电子文档的长期归档存储</a></li>
<li><a href="../zh-CN426083/index.html">iOS开发人员需要什么技能才能适应？</a></li>
<li><a href="../zh-CN426085/index.html">如何订购网站开发而不会带来令人惊讶的惊喜：3个专家提示</a></li>
<li><a href="../zh-CN426087/index.html">使用Crypto PRO在JS中签名PDF并在C＃中粘贴签名</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>