<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🥫 ⛅️ 💆🏼 Lembar cheat administrator sistem SELinux: 42 jawaban untuk pertanyaan penting 🛸 🌌 🆘</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Terjemahan artikel disiapkan khusus untuk siswa kursus Administrator Linux . 



 Di sini Anda akan mendapatkan jawaban atas pertanyaan-pertanyaan pen...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Lembar cheat administrator sistem SELinux: 42 jawaban untuk pertanyaan penting</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/484896/">  <i><b>Terjemahan artikel disiapkan khusus untuk siswa kursus <a href="https://otus.pw/xIJ4/">Administrator Linux</a> .</b></i> <br><br><img src="https://habrastorage.org/webt/of/jl/y2/ofjly2ppm7zgwrztknxeodbhih0.png"><br><hr><br>  <i>Di sini Anda akan mendapatkan jawaban atas pertanyaan-pertanyaan penting tentang kehidupan, alam semesta dan semua yang ada di Linux dengan keamanan yang ditingkatkan.</i> <br><br><blockquote>  "Kebenaran penting adalah bahwa segala sesuatu tidak selalu seperti apa yang tampaknya diketahui ..." <br><br>  <b>―Douglas Adams, The <i>Hitchhiker's Guide to the Galaxy</i></b> </blockquote><br>  <b>Keamanan</b>  <b>Meningkatkan keandalan.</b>  <b>Kepatuhan.</b>  <b>Politik.</b>  Empat Penunggang Kuda dari Kiamat sysadmin.  Selain tugas sehari-hari kami - memantau, mencadangkan, menerapkan, mengonfigurasi, memperbarui, dll. - kami juga bertanggung jawab atas keamanan sistem kami.  Bahkan sistem di mana penyedia pihak ketiga merekomendasikan agar kami mematikan keamanan yang ditingkatkan.  Ini mirip dengan karya <a href="https://en.wikipedia.org/wiki/Ethan_Hunt">Ethan Hunt</a> dari Mission Impossible. <a name="habracut"></a><br><br>  Menghadapi dilema ini, beberapa administrator sistem memutuskan untuk mengambil <a href="https://en.wikipedia.org/wiki/Red_pill_and_blue_pill">pil biru</a> karena mereka pikir mereka tidak akan pernah tahu jawaban atas pertanyaan besar kehidupan, alam semesta dan semua itu.  Dan, seperti kita semua tahu, jawaban ini adalah 42. <br><br>  Dalam semangat "Panduan Hitchhiker untuk Galaxy", berikut adalah 42 jawaban untuk pertanyaan penting tentang mengelola dan menggunakan <a href="https://en.wikipedia.org/wiki/Security-Enhanced_Linux">SELinux</a> pada sistem Anda. <br><br>  <b>1.</b> SELinux adalah sistem kontrol akses paksa, yang berarti bahwa setiap proses memiliki label.  Setiap file, direktori, dan objek sistem juga memiliki tag.  Aturan kebijakan mengontrol akses antara proses dan objek yang berlabel.  Kernel memberlakukan aturan ini. <br><br>  <b>2.</b> Dua konsep paling penting adalah: <i>Pelabelan</i> - pelabelan (file, proses, port, dll.) Dan <i>Penegakan tipe</i> (yang mengisolasi proses dari satu sama lain berdasarkan jenis). <br><br>  <b>3.</b> Format label yang benar adalah <code>user:role:type:level</code> (opsional). <br><br>  <b>4.</b> Tujuan menyediakan <i>Multi-Level Security (MLS</i> ) adalah untuk mengelola proses (domain) berdasarkan tingkat keamanan data yang akan mereka gunakan.  Misalnya, proses rahasia tidak dapat membaca data rahasia. <br><br>  <b>5.</b> Memastikan <i>Multi-Category Security (MCS</i> ) melindungi proses serupa dari satu sama lain (misalnya, mesin virtual, mekanisme OpenShift, SELinux sandboxes, container, dll.). <br><br>  <b>6.</b> Parameter kernel untuk mengubah mode SELinux saat boot: <br><br><ul><li>  <code>autorelabel=1</code> memaksa sistem untuk mulai menandai ulang </li><li>  <code>selinux=0</code> kernel tidak memuat infrastruktur SELinux </li><li>  <code>enforcing=0</code> memuat dalam mode permisif </li></ul><br>  <b>7.</b> Jika Anda perlu menandai ulang seluruh sistem: <br><br> <code># touch /.autorelabel <br> #reboot</code> <br> <br>  Jika penandaan sistem mengandung banyak kesalahan, Anda mungkin perlu mem-boot dalam mode permisif agar penandaan berhasil. <br><br>  <b>8.</b> Untuk memeriksa apakah SELinux diaktifkan: <code># getenforce</code> <br><br>  <b>9.</b> Untuk sementara mengaktifkan / menonaktifkan SELinux: <code># setenforce [1|0]</code> <br><br>  <b>10.</b> Memeriksa status SELinux: <code># sestatus</code> <br><br>  <b>11.</b> File konfigurasi: <code>/etc/selinux/config</code> <br><br>  <b>12.</b> Bagaimana cara kerja SELinux?  Ini adalah contoh pelabelan untuk server web Apache: <br><br><ul><li>  Representasi biner: <code>/usr/sbin/httpd→httpd_exec_t</code> </li><li>  Direktori Konfigurasi: <code>/etc/httpd→httpd_config_t</code> </li><li>  Direktori file log: <code>/var/log/httpd → httpd_log_t</code> </li><li>  Direktori Konten: <code>/var/www/html → httpd_sys_content_t</code> </li><li>  Skrip peluncuran: <code>/usr/lib/systemd/system/httpd.service → httpd_unit_file_d</code> </li><li>  Proses: <code>/usr/sbin/httpd -DFOREGROUND → httpd_t</code> </li><li>  Port: <code>80/tcp, 443/tcp → httpd_t, http_port_t</code> </li></ul><br>  <i>Sebuah proses yang berjalan dalam konteks <code>httpd_t</code> dapat berinteraksi dengan objek berlabel <code>httpd_something_t</code> .</i> <br><br>  <b>13.</b> Banyak perintah menerima argumen <code>-Z</code> untuk melihat, membuat, dan mengubah konteks: <br><br><ul><li> <code>ls -Z</code> </li> <li> <code>id -Z</code> </li> <li> <code>ps -Z</code> </li> <li> <code>netstat -Z</code> </li> <li> <code>cp -Z</code> </li> <li> <code>mkdir -Z</code> </li> </ul><br>  <i>Konteks ditetapkan ketika file dibuat berdasarkan konteks direktori induknya (dengan beberapa pengecualian).</i>  <i>RPM dapat mengatur konteks seperti saat instalasi.</i> <br><br>  <b>14.</b> Ada empat penyebab utama kesalahan SELinux, yang dijelaskan secara lebih rinci dalam paragraf 15-21 di bawah: <br><br><ul><li>  Masalah Pelabelan </li><li>  Karena sesuatu yang SELinux perlu ketahui </li><li>  Kesalahan dalam kebijakan / aplikasi SELinux </li><li>  Informasi Anda dapat dikompromikan. </li></ul><br>  <b>15.</b> <i>Masalah dengan penandaan</i> : jika file Anda di <code>/srv/myweb</code> ditandai dengan salah, akses mungkin ditolak.  Berikut ini beberapa cara untuk memperbaikinya: <br><br><ul><li>  Jika Anda tahu labelnya: <br> <code># semanage fcontext -a -t httpd_sys_content_t '/srv/myweb(/.*)?'</code> </li> <li>  Jika Anda tahu file dengan tanda yang setara: <br> <code># semanage fcontext -a -e /srv/myweb /var/www</code> </li> <li>  Setelah memulihkan konteks (untuk kedua kasus): <br> <code># restorecon -vR /srv/myweb</code> </li> </ul><br>  <b>16.</b> <i>Masalah dengan penandaan:</i> jika Anda memindahkan file alih-alih menyalinnya, file akan mempertahankan konteks aslinya.  Untuk memperbaiki masalah ini: <br><br><ul><li>  Ubah perintah konteks yang berlabel: <br> <code># chcon -t httpd_system_content_t /var/www/html/index.html</code> </li> <li>  Ubah perintah konteks dengan label tautan: <br> <code># chcon --reference /var/www/html/ /var/www/html/index.html</code> </li> <li>  Pulihkan konteks (untuk kedua kasus): <code># restorecon -vR /var/www/html/</code> </li></ul><br>  <b>17.</b> Jika <i>SELinux perlu tahu</i> bahwa HTTPD sedang mendengarkan pada port 8585, beri tahu SELinux: <br><br> <code># semanage port -a -t http_port_t -p tcp 8585</code> <br> <br>  <b>18.</b> <i>SELinux perlu mengetahui</i> nilai-nilai boolean yang memungkinkan Anda untuk mengubah bagian-bagian dari kebijakan SELinux saat runtime tanpa pengetahuan menulis ulang kebijakan SELinux.  Misalnya, jika Anda ingin httpd mengirim email, masukkan: <code># setsebool -P httpd_can_sendmail 1</code> <br><br>  <b>19.</b> <i>SELinux perlu mengetahui nilai</i> -nilai logis untuk mengaktifkan / menonaktifkan pengaturan SELinux: <br><br><ul><li>  Untuk melihat semua nilai boolean: <code># getsebool -a</code> </li><li>  Untuk melihat deskripsi masing-masing: <code># semanage boolean -l</code> </li><li>  Untuk menetapkan nilai boolean: <code># setsebool [_boolean_] [1|0]</code> </li><li>  Untuk instalasi permanen, tambahkan <code>-P</code> .  Sebagai contoh: <code># setsebool httpd_enable_ftp_server 1 -P</code> </li></ul><br>  <b>20.</b> Kebijakan / aplikasi SELinux dapat mengandung kesalahan, termasuk: <br><br><ul><li>  Jalur Kode Mewah </li><li>  Konfigurasi </li><li>  Redirect stdout </li><li>  Kebocoran deskriptor file </li><li>  Memori yang bisa dieksekusi </li><li>  Perpustakaan yang dibangun dengan buruk </li></ul><br>  Buka tiket (jangan mengirim laporan ke Bugzilla; tidak ada SLA di Bugzilla). <br><br>  <b>21.</b> <i>Informasi Anda dapat dikompromikan</i> jika Anda memiliki domain terbatas yang mencoba untuk: <br><br><ul><li>  Unduh modul kernel </li><li>  Nonaktifkan mode SELinux yang dipaksakan </li><li>  Tulis dalam <code>etc_t/shadow_t</code> </li><li>  Ubah aturan iptables </li></ul><br>  <b>22.</b> Alat SELinux untuk mengembangkan modul kebijakan: <br><br> <code># yum -y install setroubleshoot setroubleshoot-server</code> <br> <br>  Reboot atau mulai ulang <code>auditd</code> setelah instalasi. <br><br>  <b>23.</b> Gunakan <pre> <code class="1c hljs">journalctl</code> </pre>  untuk mendaftar semua log yang terkait dengan <code>setroubleshoot</code> : <br><br> <code># journalctl -t setroubleshoot --since=14:20</code> <br> <br>  <b>24.</b> Gunakan <code>journalctl</code> untuk mendaftar semua log yang terkait dengan label SELinux tertentu.  Sebagai contoh: <br><br> <code># journalctl _SELINUX_CONTEXT=system_u:system_r:policykit_t:s0</code> <br> <br>  <b>25.</b> Jika kesalahan SELinux terjadi, gunakan log <code>setroubleshoot</code> dengan beberapa solusi yang mungkin. <br>  Misalnya, dari <code>journalctl</code> : <br><br><pre> <code class="xml hljs">Jun 14 19:41:07 web1 setroubleshoot: SELinux is preventing httpd from getattr access on the file /var/www/html/index.html. For complete message run: sealert -l 12fd8b04-0119-4077-a710-2d0e0ee5755e # sealert -l 12fd8b04-0119-4077-a710-2d0e0ee5755e SELinux is preventing httpd from getattr access on the file /var/www/html/index.html. ***** Plugin restorecon (99.5 confidence) suggests ************************ If you want to fix the label, /var/www/html/index.html default label should be httpd_syscontent_t. Then you can restorecon. Do # /sbin/restorecon -v /var/www/html/index.html</code> </pre> <br><br>  <b>26.</b> Logging: SELinux mencatat informasi di banyak tempat: <br><br><ul><li>  / var / log / messages </li><li>  /var/log/audit/audit.log </li><li>  /var/lib/setroubleshoot/setroubleshoot_database.xml </li></ul><br>  <b>27.</b> Logging: cari kesalahan SELinux di log audit: <br><br> <code># ausearch -m AVC,USER_AVC,SELINUX_ERR -ts today</code> <br> <br>  <b>28.</b> Untuk menemukan pesan SELinux Access Vector Cache (AVC) untuk layanan tertentu: <br><br> <code># ausearch -m avc -c httpd</code> <br> <br>  <b>29.</b> Utilitas <code>audit2allow</code> mengumpulkan informasi dari log operasi yang dilarang, dan kemudian menghasilkan aturan kebijakan izin SELinux.  Sebagai contoh: <br><br><ul><li>  Untuk membuat deskripsi yang dapat dibaca tentang alasan akses ditolak: <code># audit2allow -w -a</code> </li><li>  Untuk melihat aturan jenis penegakan yang memungkinkan akses ditolak: <code># audit2allow -a</code> </li><li>  Untuk membuat modul khusus: <code># audit2allow -a -M mypolicy</code> </li><li>  Opsi <code>-M</code> membuat file jenis penegakan (.te) dengan nama yang ditentukan dan mengkompilasi aturan ke dalam paket kebijakan (.pp): <code>mypolicy.pp mypolicy.te</code> </li><li>  Untuk menginstal modul khusus: <code># semodule -i mypolicy.pp</code> </li></ul><br>  <b>30.</b> Untuk mengonfigurasi proses terpisah (domain) agar berfungsi dalam mode permisif: <code># semanage permissive -a httpd_t</code> <br><br>  <b>31.</b> Jika Anda tidak lagi ingin domain menjadi permisif: <code># semanage permissive -d httpd_t</code> <br><br>  <b>32.</b> Untuk menonaktifkan semua domain permisif: <code># semodule -d permissivedomains</code> <br><br>  <b>33.</b> Mengaktifkan kebijakan MLS SELinux: <code># yum install selinux-policy-mls <br>  /etc/selinux/config: <br> <br> SELINUX=permissive <br> SELINUXTYPE=mls</code> <code># yum install selinux-policy-mls <br>  /etc/selinux/config: <br> <br> SELINUX=permissive <br> SELINUXTYPE=mls</code> <br> <br>  Pastikan SELinux dalam mode permisif: <code># setenforce 0</code> <br>  Gunakan skrip <code>fixfiles</code> untuk memastikan bahwa file akan ditandai kembali selama reboot berikutnya: <br><br> <code># fixfiles -F onboot # reboot</code> <br> <br>  <b>34.</b> Buat pengguna dengan rentang MLS tertentu: <code># useradd -Z staff_u john</code> <br><br>  Menggunakan perintah <code>useradd</code> , memetakan pengguna baru ke pengguna SELinux yang ada (dalam hal ini, <code>staff_u</code> ). <br><br>  <b>35.</b> Untuk melihat korespondensi antara pengguna SELinux dan Linux: <code># semanage login -l</code> <br><br>  <b>36.</b> Tentukan kisaran spesifik untuk pengguna: <code># semanage login --modify --range s2:c100 john</code> <br><br>  <b>37.</b> Untuk memperbaiki label di direktori home pengguna (jika perlu): <code># chcon -R -l s2:c100 /home/john</code> <br><br>  <b>38.</b> Untuk melihat kategori saat ini: <code># chcat -L</code> <br><br>  <b>39.</b> Untuk mengubah kategori atau mulai membuat kategori Anda sendiri, edit file sebagai berikut: <br><br> <code><code>/etc/selinux/_&lt;</code> selinuxtype <code>&gt;</code> _/setrans.conf</code> <br> <br>  <b>40.</b> Untuk menjalankan perintah atau skrip dalam file, peran, dan konteks pengguna tertentu: <br><br> <code># runcon -t initrc_t -r system_r -u user_u yourcommandhere</code> <br> <br><ul><li>  konteks file <code>-t</code> </li><li>  konteks peran <code>-r</code> </li><li>  konteks pengguna <code>-u</code> </li></ul><br>  <b>41.</b> Kontainer yang bekerja dengan SELinux yang dinonaktifkan: <br><br><ul><li>  Podman: <code># podman run --security-opt label=disable …</code> </li><li>  Docker: <code># docker run --security-opt label=disable …</code> </li></ul><br>  <b>42.</b> Jika Anda perlu memberi wadah akses penuh ke sistem: <br><br><ul><li>  Podman: <code># podman run --privileged …</code> </li><li>  Docker: <code># docker run --privileged …</code> </li></ul><br>  <i>Dan sekarang Anda sudah tahu jawabannya.</i>  <i>Karena itu, tolong: jangan panik dan nyalakan SELinux.</i> <br><br><h3>  Referensi: </h3><br><ul><li>  <a href="https://fedorapeople.org/~dwalsh/SELinux/SELinux">SELinux</a> oleh <a href="https://opensource.com/users/rhatdan">Dan Walsh</a> </li><li>  <a href="https://opensource.com/business/13/11/selinux-policy-guide">Panduan cara visual Anda untuk penegakan kebijakan SELinux juga</a> oleh Dan Walsh </li><li>  <a href="http://people.redhat.com/tcameron/Summit2018/selinux/SELinux_for_Mere_Mortals_Summit_2018.pdf">Keamanan Enhanced Linux untuk manusia biasa</a> oleh <a href="http://twitter.com/thomasdcameron">Thomas Cameron</a> </li><li>  <a href="http://blog.linuxgrrl.com/2014/04/16/the-selinux-coloring-book/">The SELinux Coloring Book</a> oleh <a href="https://opensource.com/users/mairin">Máirín Duffy</a> </li><li>  <a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/selinux_users_and_administrators_guide/index">Panduan Pengguna dan Administrator SELinux - Red Hat Enterprise Linux 7</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id484896/">https://habr.com/ru/post/id484896/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id484882/index.html">Windows Terminal Preview v0.8 dirilis</a></li>
<li><a href="../id484884/index.html">HIPEC. Bertahun-tahun hidup bukannya berbulan-bulan dengan tumor ganas di rongga perut</a></li>
<li><a href="../id484886/index.html">RTL Styling 101 - Panduan terperinci untuk gaya CSS RTL</a></li>
<li><a href="../id484890/index.html">Membatasi akses ke atribut dimensi dalam model tabel SSAS</a></li>
<li><a href="../id484892/index.html">Perawatan turnkey: cara kerja hosting SAP</a></li>
<li><a href="../id484898/index.html">Alasan yang bagus untuk menguji dependensi Anda: AGPL-edisi</a></li>
<li><a href="../id484900/index.html">Rendering Situs Web 101</a></li>
<li><a href="../id484902/index.html">Pada persamaan derajat yang lebih tinggi</a></li>
<li><a href="../id484904/index.html">Setahun tanpa Splunk - bagaimana sebuah perusahaan Amerika mengubah pasar untuk analisis data mesin di Rusia dan yang ditinggalkannya</a></li>
<li><a href="../id484906/index.html">Tim terdistribusi dan tim memimpin pada remote</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>