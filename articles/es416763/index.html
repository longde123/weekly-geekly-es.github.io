<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèª‚Äç‚öïÔ∏è üï¥üèΩ ü•ã Puppet Salt Chef Ensemble: compara Ansible, SaltStack, Chef y Puppet üñêüèø üìï üêñ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hoy hablaremos sobre qu√© es SCM y contaremos algunas historias a trav√©s del prisma de las cuales consideraremos Ansible, SaltStack, Chef y Puppet, eli...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Puppet Salt Chef Ensemble: compara Ansible, SaltStack, Chef y Puppet</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/jugru/blog/416763/">  Hoy hablaremos sobre qu√© es SCM y contaremos algunas historias a trav√©s del prisma de las cuales consideraremos Ansible, SaltStack, Chef y Puppet, eligiendo la mejor opci√≥n para una tarea espec√≠fica. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/3xA2SggKQKo" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  El material se basa en una transcripci√≥n de un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">informe de Andrei Filatov</a> , ingeniero jefe de sistemas de EPAM Systems, de nuestra conferencia DevOops 2017 de octubre. <br><a name="habracut"></a><br><h2>  ¬øQu√© es SCM y con qu√© se come? </h2><br><img src="https://habrastorage.org/webt/hc/qk/qz/hcqkqz63ox1qwcu5qrfc08hkg7o.jpeg"><br><br>  ¬øQu√© es SCM?  En primer lugar, es algo que permite que nuestra infraestructura del estado A ejecute el estado B mediante la ejecuci√≥n de alg√∫n c√≥digo. Muchos desarrolladores que no son ingenieros de DevOps en la pr√°ctica piensan que algo est√° sucediendo de alguna manera "autom√°tica". en infraestructura. <br><br>  El m√©todo "autom√°tico" nos implementa SCM (System Configuration Management).  ¬øPara qu√© es esto?  Principalmente para construir infraestructuras repetibles y consistentes.  SCM extiende bien los procesos de CI / CD.  Como se trata de c√≥digo, puede almacenarse en cualquier sistema de control de versiones: Git, Mercurial.  Es bastante simple de desarrollar y mantener. <br><br>  El final es un ciclo de automatizaci√≥n cerrado: todo se puede hacer autom√°ticamente, desde crear la infraestructura hasta implementarla e implementar el c√≥digo. <br><br><h2>  Qu√© es SCM: Ansible </h2><br><img src="https://habrastorage.org/webt/w8/kg/5z/w8kg5z-9n6uy-eva2x5ofgeiuig.jpeg"><br><br>  Considere a nuestros solicitantes.  El primero es Ansible.  Tiene una arquitectura sin agente, si estamos hablando de una versi√≥n de c√≥digo abierto, est√° escrita en Python, tiene un DSL similar a Yaml, es f√°cilmente extensible debido a los m√≥dulos escritos en Python, es muy simple y liviano.  Ansible tiene el umbral de entrada m√°s bajo: puede ense√±ar a cualquiera. <br><br>  Existe experiencia cuando una persona, sin conocer Python, sin saber nada sobre SCM, ingres√≥ a Ansible en solo dos d√≠as y ya comenz√≥ a hacer algo. <br>  A continuaci√≥n se muestra un ejemplo de ChatOps: un notificador en Slack.  El c√≥digo Ansible que vio a Yaml no es nada nuevo. <br><br><pre><code class="hljs pgsql">- block: - <span class="hljs-type"><span class="hljs-type">name</span></span>: "SlackNotify : Deploy Start" local_action: module: slack token: "{{ slack_url }}" attachments: - title: "Deploy to {{ inventory_hostname }} has been Started" <span class="hljs-type"><span class="hljs-type">text</span></span>: "&lt;!here&gt; :point_up_2:" color: "#551a8b" - <span class="hljs-keyword"><span class="hljs-keyword">include</span></span>: configure.yml tags: - configure - <span class="hljs-keyword"><span class="hljs-keyword">include</span></span>: remote-<span class="hljs-keyword"><span class="hljs-keyword">fetch</span></span>.yml tags: - remote - <span class="hljs-keyword"><span class="hljs-keyword">include</span></span>: assets.yml</code> </pre> <br><hr><br><h2>  Qu√© es SCM: Chef </h2><br><img src="https://habrastorage.org/webt/wi/kr/bd/wikrbdzapzntbjimi4ns5jw2bm0.jpeg"><br><br>  Chef es una arquitectura cliente-servidor, hay un servidor Chef y un cliente Chef.  La configuraci√≥n basada en b√∫squedas, escrita en Ruby, tiene Ruby DSL.  En consecuencia, dentro de sus libros de cocina y recetas puede usar todo el poder de Ruby, pero no le recomiendo hacerlo.  Chef tiene una gran comunidad y el mayor conjunto de herramientas entre todos los SCM.  As√≠ es como se ve el c√≥digo Chef, esta es la implementaci√≥n de Jetty. <br><br><pre> <code class="ruby hljs"><span class="hljs-comment"><span class="hljs-comment"># # Cookbook Name:: dg-app-edl # Recipe::fe # node.normal[:jetty][:home] = "/usr/share/jetty" node.normal[:jetty][:group] = "deploy" include_recipe "dg-auth::deploy" include_recipe "newrelic::repository" include_recipe "newrelic::server-monitor" include_recipe "dg-jetty::jetty9" include_recipe "newrelic::java-agent" directory "edl" do action :create owner group "deploy" mode "0775" path "/usr/share/where/edl" recursive true end</span></span></code> </pre><br><hr><br><h2>  Qu√© es SCM: SaltStack </h2><br><img src="https://habrastorage.org/webt/um/dp/qa/umdpqavcnru1d40qd-bncyclmx8.jpeg"><br><br>  SaltStack tiene una arquitectura sin agente que funciona en modo push usando Salt-SSH, y una arquitectura cliente-servidor cuando hay Salt-master y Salt-minion.  El √©nfasis est√° en la automatizaci√≥n en tiempo real, la ejecuci√≥n paralela inmediata de todos los procesos y escrita en Python.  Tambi√©n es un lenguaje similar a Yaml, el c√≥digo es muy similar a Ansible. <br><br><pre> <code class="hljs mel">#ntp-packages: pkg.installed: - pkgs: - ntp - ntpdate #/etc/ntp.conf: <span class="hljs-keyword"><span class="hljs-keyword">file</span></span>: - managed - <span class="hljs-keyword"><span class="hljs-keyword">source</span></span>: salt:<span class="hljs-comment"><span class="hljs-comment">//common/ntpd/ntp.conf - template: jinja - mode: 644 #/etc/sysconfig/ntpd: file: - managed - source: salt://common/ntpd/ntpd - template: jinja - mode: 644 #ntp-service: service.running: - name: ntpd</span></span></code> </pre><br><hr><br><h2>  Qu√© es SCM: Puppet </h2><br><img src="https://habrastorage.org/webt/iz/-3/ac/iz-3acdxp8hdgg-lxxk_lp8oilq.jpeg"><br><br>  El √∫ltimo de nuestros postores es Puppet.  Tambi√©n tiene una arquitectura cliente-servidor, como Chef, la configuraci√≥n no se basa en la b√∫squeda, sino en los "hechos" que vienen con el Puppet-master, escrito en Ruby, tiene un DSL similar a Ruby.  Pero a los t√≠teres no se les permite usar c√≥digo Ruby puro en sus manifiestos.  Esto es tanto un plus como un menos.  As√≠ es como se ve el c√≥digo de manifiesto de Puppet: <br><br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> { '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">mysql::server</span></span></span><span class="hljs-class">' : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">root_password</span></span></span><span class="hljs-class"> =&gt; '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">password</span></span></span><span class="hljs-class">' } </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">mysql::db</span></span></span><span class="hljs-class">{ ['</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">test</span></span></span><span class="hljs-class">', '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">test2</span></span></span><span class="hljs-class">', '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">test3</span></span></span><span class="hljs-class">']: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ensure</span></span></span><span class="hljs-class"> =&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">present</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">charset</span></span></span><span class="hljs-class"> =&gt; '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">utf8</span></span></span><span class="hljs-class">', </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">require</span></span></span><span class="hljs-class"> =&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Class</span></span></span><span class="hljs-class">['</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">mysql::server</span></span></span><span class="hljs-class">'], } </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">mysql::db</span></span></span><span class="hljs-class">{ '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">test4</span></span></span><span class="hljs-class">': </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ensure</span></span></span><span class="hljs-class"> =&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">present</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">charset</span></span></span><span class="hljs-class"> =&gt; '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">latin1</span></span></span><span class="hljs-class">', } </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">mysql::db</span></span></span><span class="hljs-class">{ '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">test5</span></span></span><span class="hljs-class">': </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ensure</span></span></span><span class="hljs-class"> =&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">present</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">charset</span></span></span><span class="hljs-class"> =&gt; '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">binary</span></span></span><span class="hljs-class">', </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">collate</span></span></span><span class="hljs-class"> =&gt; '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">binary</span></span></span><span class="hljs-class">', }</span></span></code> </pre><br><h2>  SCM en la pr√°ctica </h2><br><h3>  SaltStack en un ambiente desmilitarizado </h3><br>  En primer lugar, me gustar√≠a compartir un proyecto escrito en SaltStack.  Este es nuestro proyecto anterior y el dolor m√°s fresco, y el dolor m√°s fresco es siempre el m√°s doloroso.  Nuestro cliente se dedica al almacenamiento de datos: esta es la producci√≥n de servidores de hierro para almacenar datos en GPFS, GlusterFS, pero construcciones personalizadas.  √âl vino a nosotros con las siguientes tareas: <br><br><ol><li>  Creaci√≥n de un instalador USB / DVD.  Debe crear un medio desde el que est√© instalado todo.  Esto se hace para clientes clientes que viven en √°reas cerradas, donde los servidores con mayor frecuencia no tienen Internet.  Necesitamos empacar en un ISO, enviar a ingenieros de campo que implementar√°n todo lo necesario en el sitio. <br></li><li>  Implemente un cl√∫ster de productos.  Los clientes tienen varios productos grandes, debemos poder implementarlos en modo de cl√∫ster. <br></li><li>  Gesti√≥n, configuraci√≥n y mantenimiento del cl√∫ster utilizando la utilidad CLI.  Nuestro marco deber√≠a ayudar a los ingenieros de campo a administrar el cl√∫ster. <br></li></ol><br>  El cliente ten√≠a varios requisitos.  En primer lugar, tiene una gran experiencia en Python, de hecho, solo desarrolladores de C y Python.  El cliente dijo de inmediato: "Queremos SaltStack", sin dejar otra opci√≥n. <br><br>  ¬øA qu√© nos enfrentamos?  El cliente tiene varios productos en la instalaci√≥n, todos deben ser con Salt-Masters.  Pero nos enfrentamos con el problema de escalar la configuraci√≥n Multi-Master.  Por ejemplo, en NODE Info (el estado de un servidor espec√≠fico), seleccionamos milisegundos con una configuraci√≥n de dos maestros, segundos con tres maestros y con cinco nunca esperamos que se complete la operaci√≥n.  MultiMaster es una buena caracter√≠stica, pero no escala bien. <br><br>  El segundo problema que encontramos fue el trabajo en equipo: SaltStack tiene Runner y M√≥dulo.  El m√≥dulo es una extensi√≥n que se ejecuta en Salt Minion, en el lado de la m√°quina.  El corredor se ejecuta en el lado del servidor.  A menudo tuvimos batallas: qu√© hacer Runner y qu√© hacer M√≥dulos. <br><br>  Luego nos encontramos con una peque√±a sorpresa de cache.mine: <br><br><pre> <code class="python hljs">ime = ImeActions() id = __grains__[<span class="hljs-string"><span class="hljs-string">'id'</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> id == ime.master_id: ret = __salt__[<span class="hljs-string"><span class="hljs-string">'mine.get'</span></span>](id, <span class="hljs-string"><span class="hljs-string">'ime_actions.make_bfs_uuid'</span></span>) ime_dict = ret.get(id, <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> ime_dict: <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: result = __salt__[<span class="hljs-string"><span class="hljs-string">'mine.send'</span></span>](<span class="hljs-string"><span class="hljs-string">'ime_actions.make_bfs_uuid'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> Exeption, e: log.error(<span class="hljs-string"><span class="hljs-string">"Failed to generate uuid: {0}."</span></span>.format(str(e))) result = <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>:</code> </pre><br>  Tenemos una utilidad que est√° escrita en C. La ejecutamos, genera una identificaci√≥n aleatoria.  Debe ser √∫nico entre todos los participantes en el cl√∫ster, respectivamente, debemos hacer esto una vez en el maestro y luego distribuirlo entre las m√°quinas.  Usamos cache.mine para esto.  Al final result√≥ que, √©l no est√° experimentando un reinicio. <br><br><img src="https://habrastorage.org/webt/g1/n6/bo/g1n6boipselezqysof41glvfa5s.jpeg"><br><br>  "Condici√≥n de carrera".  La paralelizaci√≥n es buena, pero en la configuraci√≥n b√°sica state.orchestrate entra en state.sls se est√° ejecutando si se producen procesos largos.  Por tiempo de espera, √©l cree que el Estado ya se ha completado, aunque todav√≠a se est√° ejecutando, y est√° tratando de comenzar el pr√≥ximo.  Se produce un error  Y este problema a√∫n no se ha solucionado. <br><br><img src="https://habrastorage.org/webt/uq/s5/wb/uqs5wbeqhfc8o22yr9mwck3fcbg.jpeg"><br>  Puedes <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">mirar GitHub</a> . <br><br>  ¬øQu√© podr√≠amos usar adem√°s de SaltStack? <br><br><h3>  SaltStack en un entorno DMZ </h3><br><img src="https://habrastorage.org/webt/ze/k6/me/zek6meak3aivzorfh7rsgf4e9na.jpeg"><br><br><ul><li>  DMZ  Chef es genial, Puppet tambi√©n.  Y con Ansible, el problema es que, si no hay Torre, no hay forma de iniciar la configuraci√≥n en modo Pull desde nuestros nodos, lo que debe hacerse en la zona desmilitarizada. <br></li><li>  Marco para CLI (en Python).  Chef y Puppet no son muy adecuados, pero si no tiene restricciones para usar solo Python, puede escribir en Ruby y usar las API Chef o Puppet.  Ansible toolkit no es compatible con esto. <br></li><li>  Gesti√≥n de cl√∫steres.  Chef es muy adecuado para administrar cl√∫steres, Puppet tambi√©n, y Ansible se escribi√≥ originalmente para administrar cl√∫steres en Amazon. <br></li></ul><br><h3>  Chef en un ambiente amplio y din√°mico. </h3><br>  Al cliente se le ocurri√≥ la tarea de consolidar todos los recursos en una nube: era Openstack.  Antes de eso, todo estaba disperso: algo en Rackspace Cloud, algo en servidores dedicados o sus centros de datos privados. <br><br>  Quer√≠an una gesti√≥n de recursos totalmente din√°mica, y tambi√©n para que sus aplicaciones pudieran agregar capacidad para s√≠ mismos si fuera necesario.  Es decir, necesitamos una infraestructura din√°mica completa y un entorno totalmente din√°mico tanto hacia arriba como hacia abajo. <br><br>  Para construir correctamente el proceso de CD, necesita un entorno totalmente automatizado.  Creamos SDLC - Ciclo de vida de desarrollo de software para ellos, y lo aplicamos, incluso para SCM.  Pasan pruebas de integraci√≥n no solo de aplicaciones, sino tambi√©n de infraestructura. <br><br>  En consecuencia, cuando algo va mal con nosotros, nosotros, como los chicos de Netflix, deber√≠amos ser capaces de matar recursos defectuosos y restaurar a los trabajadores frescos y garantizados a su lugar. <br><br>  ¬øQu√© problemas encontramos? <br><br><ol><li>  Era 2013, utilizaba Chef 10, en el que una b√∫squeda lenta.  Comenzamos la b√∫squeda, recorriendo todos los autos, y nos llev√≥ una eternidad.  Intentamos resolver el problema con la convenci√≥n de nomenclatura, as√≠ como con la selecci√≥n y b√∫squeda de fqdn.  Esto redujo el alcance de la b√∫squeda, debido a que se aceler√≥. <br><br>  Pero algunas operaciones deben hacerse en todo el entorno.  En consecuencia, la b√∫squeda se ejecut√≥ una vez al principio, el resultado se almacen√≥ en el atributo y, utilizando Ruby, filtramos los resultados: analizamos las piezas que necesit√°bamos e hicimos lo que era necesario. <br><br><pre> <code class="ruby hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> !Chef::Config[<span class="hljs-symbol"><span class="hljs-symbol">:solo</span></span>] search(<span class="hljs-symbol"><span class="hljs-symbol">:node</span></span>, <span class="hljs-string"><span class="hljs-string">"fqdn:*metro-</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">#{node[</span></span><span class="hljs-symbol"><span class="hljs-string"><span class="hljs-subst"><span class="hljs-symbol">:env</span></span></span></span><span class="hljs-string"><span class="hljs-subst">]}</span></span></span><span class="hljs-string">-mongodb*"</span></span>).each <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-params"><span class="hljs-params">|mongo|</span></span> @mongodbs &lt;&lt; mongo.fqdn <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> @mongodbs = [<span class="hljs-string"><span class="hljs-string">"lvs-metro-</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">#{node[</span></span><span class="hljs-symbol"><span class="hljs-string"><span class="hljs-subst"><span class="hljs-symbol">:env</span></span></span></span><span class="hljs-string"><span class="hljs-subst">]}</span></span></span><span class="hljs-string">-mongodb3001.qa.example.com"</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre><br>  En pocas palabras: use convenciones de nomenclatura, ejecute la b√∫squeda una vez, use Ruby para filtrar los resultados deseados. <br></li><li>  Usar "node.save" no es seguro, tenga cuidado y cuidado.  Encontramos este problema al implementar cl√∫steres MySQL y utilizamos node.save dentro de la receta en un nodo MySQL configurado de forma incompleta.  Y en el momento de la ampliaci√≥n, algunas aplicaciones dieron un error 500.  Result√≥ que est√°bamos guardando el nodo en el momento equivocado: va al servidor Chef, all√≠ mismo, el cliente Chef en la interfaz de usuario recoge un nuevo nodo que no estaba configurado antes del modo operativo. <br></li><li>  La falta de "splay" puede matar al servidor del chef.  Splay es un par√°metro del cliente Chef que le permite establecer el rango cuando el cliente va al servidor para la configuraci√≥n.  Con una carga pesada, cuando necesita implementar muchos nodos al mismo tiempo, esto no matar√° al servidor. <br></li></ol><br>  ¬øQu√© podemos usar en lugar de chef? <br><br><img src="https://habrastorage.org/webt/0w/xx/rm/0wxxrmdr90fpnyppzwoumgkbmai.jpeg"><br><br><ul><li>  Aprovisionamiento din√°mico  SaltStack es perfecto porque tiene SaltCloud que se integra perfectamente en cualquier lugar.  Puppet tiene una funcionalidad similar, pero solo est√° disponible en Puppet Enterprise, por dinero.  Ansible es muy adecuado si la empresa "vive" en Amazon, si es algo m√°s: puede vincularlo con alternativas, pero no es tan conveniente. <br></li><li>  SDLC  Chef tiene todo, desde Test Kitchen hasta la elecci√≥n de herramientas para las pruebas de integraci√≥n.  SaltStack tiene todas las herramientas de Python disponibles, ahora Puppet lo tiene todo.  Ansible tiene una especificaci√≥n de rol, puede usar Chef's Test Kitchen, pero no es una herramienta nativa. <br></li><li>  Reemplazo de recursos.  Todo est√° bien en Chef, en SaltStack puedes terminar SaltCloud al estado deseado, en Puppet las herramientas solo est√°n en la versi√≥n Enterprise, y Ansible funciona bien solo con Amazon. <br></li></ul><br><h3>  EPAM Private Cloud con Chef </h3><br>  Un a√±o y medio antes del advenimiento de AWS OpsWorks, quer√≠amos crear un Amazon CloudFormation avanzado integrando Chef para que los recursos no solo se implementaran, sino que tambi√©n se configuraran. <br><br>  La segunda tarea global es crear un cat√°logo de servicios para que los clientes y usuarios puedan usar la CLI para implementar una pila LAMP completamente lista para usar, por ejemplo. <br><br><img src="https://habrastorage.org/webt/a4/cy/f6/a4cyf6ep8anoudzr6ydh7as2yrg.jpeg"><br><br>  Elegimos Chef, pero el proyecto ten√≠a que soportar diferentes SCM.  Comenzamos con el Chef-Server incorporado, y los usuarios tambi√©n podr√≠an usar su propio Chef-Server, que est√° alojado en alg√∫n lugar con ellos.  Es decir, no obtuvimos acceso a los recursos de los usuarios y las computadoras port√°tiles, pero funcion√≥ de todos modos. <br><br><img src="https://habrastorage.org/webt/xf/vh/py/xfvhpysd5j89seh3qgrei3o5ryi.jpeg"><br><br>  Se puede usar cualquier SCM para implementar CloudFormation + OpsWork, todos son adecuados.  Para crear un cat√°logo, todos, excepto SaltStack, lo har√°n bien.  SaltStack tiene sus matices: es extremadamente dif√≠cil encontrar un especialista que conozca bien a SaltStack y pueda crear un servicio y llenar el cat√°logo. <br><br><h3>  La popularidad de SCM en EPAM </h3><br><img src="https://habrastorage.org/webt/d3/o1/z2/d3o1z2giceihh4izcy4r6zlnkpq.jpeg"><br><br>  Estas son estad√≠sticas de popularidad de SCM dentro de EPAM.  SaltStack est√° muy lejos.  En primer lugar Ansible, es el m√°s simple y con un umbral de entrada bajo.  Cuando tratamos de encontrar a alguien en el mercado con conocimiento de SCM, el mercado se ve casi igual. <br><br><h3>  Trabaja con Ansible </h3><br>  Consejos que puedo dar al trabajar con Ansible: <br><ol><li>  Use 'acelerar', implementa configuraciones 2-6 veces m√°s r√°pido que SSH (para el6).  Para todos los dem√°s, hay 'canalizaci√≥n'.  Est√° desactivado por compatibilidad con versiones anteriores, pero volver a activar la canalizaci√≥n es muy f√°cil, recomiendo hacerlo. <br></li><li>  Use 'with_items' <br><br><pre> <code class="hljs powershell">- name: project apt dependencies installed apt: name: <span class="hljs-string"><span class="hljs-string">"{{ item }}"</span></span> become: yes with_items: - build<span class="hljs-literal"><span class="hljs-literal">-essential</span></span> - acl - git - curl - gnupg2 - libpcre3<span class="hljs-literal"><span class="hljs-literal">-dev</span></span> - python<span class="hljs-literal"><span class="hljs-literal">-apt</span></span> - python<span class="hljs-literal"><span class="hljs-literal">-pycurl</span></span> - python<span class="hljs-literal"><span class="hljs-literal">-boto</span></span> - imagemagick - libmysqlclient<span class="hljs-literal"><span class="hljs-literal">-dev</span></span> <span class="hljs-comment"><span class="hljs-comment"># needed for data import</span></span></code> </pre><br>  En este ejemplo, instalamos paquetes, este esquema se puede utilizar para crear usuarios y operaciones similares. <br></li><li>  Utilice con cuidado 'local_action' y 'delegated'.  El primero le permite obtener algo similar al SaltStack Runner, el segundo puede delegar tareas a m√°quinas espec√≠ficas. <br><br><pre> <code class="hljs sql">- name: <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> postgresql <span class="hljs-keyword"><span class="hljs-keyword">database</span></span> postgresql_db: <span class="hljs-keyword"><span class="hljs-keyword">name</span></span>: <span class="hljs-string"><span class="hljs-string">"{{ database_name }}"</span></span> login_host: <span class="hljs-string"><span class="hljs-string">"{{ database_host }}"</span></span> login_user: <span class="hljs-string"><span class="hljs-string">"{{ database_master_user }}"</span></span> login_password: <span class="hljs-string"><span class="hljs-string">"{{ database_master_password }}"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">encoding</span></span>: <span class="hljs-string"><span class="hljs-string">"UTF-8"</span></span> lc_collate: <span class="hljs-string"><span class="hljs-string">"en_US.UTF-8"</span></span> lc_ctype: <span class="hljs-string"><span class="hljs-string">"en_US.UTF-8"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">template</span></span>: <span class="hljs-string"><span class="hljs-string">"template0"</span></span> state: <span class="hljs-keyword"><span class="hljs-keyword">present</span></span> delegate_to: <span class="hljs-string"><span class="hljs-string">"{{ groups.pg_servers|random}}"</span></span></code> </pre><br>  Esta es una pieza de creaci√≥n de base de datos.  Sin la √∫ltima l√≠nea, la operaci√≥n se realizar√≠a varias veces y recaer√≠a en el segundo intento de crear la misma base de datos. <br></li><li>  Optimice sus roles y rendimiento con etiquetas.  Esto puede reducir significativamente el tiempo de entrega. <br></li></ol><br><h3>  Conclusiones </h3><br>  Para m√≠, Ansible es un favorito.  SaltStack es muy bueno, muy flexible, pero requiere conocimiento de Python, sin ellos es mejor no usar SaltStack.  Chef es una bala de plata universal para cualquier tarea y cualquier escala, pero requiere m√°s conocimiento que Ansible.  Y qui√©n usa Puppet, no lo s√©.  En principio, es muy similar al Chef, pero con sus propios matices. <br><blockquote>  Minuto de publicidad.  Si le gust√≥ este informe de la conferencia <b>DevOops</b> , tenga en cuenta que el 14 de octubre se llevar√° a cabo el nuevo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">DevOops 2018</a> en San Petersburgo, habr√° muchas cosas interesantes en su programa.  El sitio ya tiene los primeros oradores e informes. </blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es416763/">https://habr.com/ru/post/es416763/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es416753/index.html">El popular plugin Hola VPN est√° comprometido</a></li>
<li><a href="../es416755/index.html">Me gusta extremo - Comit√© de investigaci√≥n contra</a></li>
<li><a href="../es416757/index.html">Pruebas escamosas</a></li>
<li><a href="../es416759/index.html">¬øPor qu√© la inteligencia artificial no resolver√° todos los problemas?</a></li>
<li><a href="../es416761/index.html">Lenguaje c√≥smico, parte 1: ¬øes universal la gram√°tica universal?</a></li>
<li><a href="../es416765/index.html">Empresa Foliplast: un ciclo completo de producci√≥n digital en Rusia</a></li>
<li><a href="../es416767/index.html">Un deuce para ti o una auditor√≠a con pirater√≠a</a></li>
<li><a href="../es416775/index.html">Otro papercraft</a></li>
<li><a href="../es416777/index.html">El principio de funcionamiento de la red neuronal convolucional. Casi complicado</a></li>
<li><a href="../es416781/index.html">¬øQui√©n salvar√° la teor√≠a de la relatividad?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>