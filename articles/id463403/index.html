<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🚷 📚 ⛪️ Seluruh kebenaran tentang RTOS. Artikel # 31. Diagnostik dan pengecekan kesalahan RTOS 🃏 👨🏼 🤚</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Penanganan kesalahan bukanlah hal yang paling umum untuk sistem operasi yang dirancang untuk aplikasi sistem tertanam. Ini adalah hasil dari sumber da...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Seluruh kebenaran tentang RTOS. Artikel # 31. Diagnostik dan pengecekan kesalahan RTOS</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/463403/"><img src="https://habrastorage.org/webt/ot/7b/f6/ot7bf602l2thhfxphukcduobth8.jpeg"><br><br>  Penanganan kesalahan bukanlah hal yang paling umum untuk sistem operasi yang dirancang untuk aplikasi sistem tertanam.  Ini adalah hasil dari sumber daya yang terbatas, karena semua sistem yang tertanam memiliki batasan tertentu.  Dan hanya sejumlah kecil sistem yang memiliki kemampuan untuk berperilaku seperti sistem desktop, yaitu, menawarkan kepada pengguna kemampuan untuk memilih tindakan jika terjadi peristiwa luar biasa. <br><br>  Dalam Nucleus SE, secara umum, ada tiga jenis pemeriksaan kesalahan: <br><ul><li>  sarana untuk memverifikasi kesehatan konfigurasi yang dipilih untuk memastikan bahwa parameter yang dipilih tidak mengarah pada kesalahan; </li><li>  secara opsional menyertakan kode untuk memeriksa perilaku runtime; </li><li>  Fungsi API tertentu yang berkontribusi pada pengembangan kode yang lebih kuat. </li></ul><br>  Semua ini akan dibahas dalam artikel ini, bersama dengan beberapa ide mengenai diagnostik oleh pengguna. <br><a name="habracut"></a><br><div class="spoiler">  <b class="spoiler_title">Artikel sebelumnya dalam seri:</b> <div class="spoiler_text">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Artikel # 30.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Inisialisasi Nucleus SE dan Prosedur Memulai</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Artikel # 29.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Gangguan pada Nucleus SE</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Artikel # 28.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Pengatur waktu perangkat lunak</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Artikel # 27.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Waktu sistem</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Artikel # 26.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Saluran: layanan tambahan dan struktur data</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Artikel # 25.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Saluran Data: Pengantar dan Layanan Dasar</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Artikel # 24.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Antrian: layanan tambahan dan struktur data</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Artikel # 23.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Antrian: pengantar dan layanan dasar</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Artikel # 22.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Kotak Surat: Layanan Tambahan dan Struktur Data</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Artikel # 21.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Kotak Surat: Pengantar dan Layanan Dasar</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Artikel # 20.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Semaphores: Layanan Tambahan dan Struktur Data</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Artikel # 19.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Semaphores: pengantar dan layanan dasar</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Artikel # 18.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Grup Bendera Acara: Layanan Pembantu dan Struktur Data</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Artikel # 17.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Grup Bendera Acara: Pengantar dan Layanan Dasar</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Artikel # 16.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Sinyal</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Artikel # 15.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Partisi Memori: Layanan dan Struktur Data</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Artikel # 14.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Bagian memori: pengantar dan layanan dasar</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Artikel # 13.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Struktur data tugas dan panggilan API yang tidak didukung</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Artikel # 12.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Layanan untuk bekerja dengan tugas</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Artikel # 11.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Tugas: konfigurasi dan pengantar API</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Artikel # 10.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Penjadwal: fitur canggih dan pelestarian konteks</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Artikel # 9.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Penjadwal: implementasi</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Artikel # 8.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Nucleus SE: Desain dan Penyebaran Internal</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Artikel # 7.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Nucleus SE: Pendahuluan</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Artikel # 6.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Layanan RTOS lainnya</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Artikel # 5.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Interaksi tugas dan sinkronisasi</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Artikel # 4.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Tugas, pengalihan konteks, dan interupsi</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Artikel # 3.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Tugas dan Perencanaan</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Artikel # 2.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">RTOS: Struktur dan mode waktu-nyata</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><br></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Artikel # 1.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">RTOS: pengantar.</a> <br></div></div><br><br><h2>  Verifikasi Pengaturan </h2><br>  Nucleus SE dirancang dengan fokus pada konfigurasi pengguna yang tinggi, yang harus memastikan penggunaan terbaik sumber daya yang tersedia.  Konfigurasi seperti itu adalah tugas yang kompleks, karena jumlah parameter yang mungkin dan saling ketergantungan di antara mereka sangat besar.  Seperti yang dinyatakan dalam banyak artikel sebelumnya, sebagian besar langkah pengguna untuk mengkonfigurasi Nucleus SE dilakukan menggunakan arahan <b>#define</b> dalam file <b>nuse_config.h</b> . <br><br>  Untuk membantu mengidentifikasi kesalahan konfigurasi, file <b>nuse_config.c</b> melalui <b>#include</b> menyertakan file <b>nuse_config_check.h</b> , yang melakukan pemeriksaan integritas pada arahan <b>#define</b> .  Berikut ini cuplikan dari file ini: <br><pre><code class="plaintext hljs">/*** Tasks and task control ***/ #if NUSE_TASK_NUMBER &lt; 1 || NUSE_TASK_NUMBER &gt; 16 #error NUSE: invalid number of tasks - must be 1-16 #endif #if NUSE_TASK_RELINQUISH &amp;&amp; (NUSE_SCHEDULER_TYPE == NUSE_PRIORITY_SCHEDULER) #error NUSE: NUSE_Task_Relinquish() selected - not valid with priority scheduler #endif #if NUSE_TASK_RESUME &amp;&amp; !NUSE_SUSPEND_ENABLE #error NUSE: NUSE_Task_Resume() selected - task suspend not enabled #endif #if NUSE_TASK_SUSPEND &amp;&amp; !NUSE_SUSPEND_ENABLE #error NUSE: NUSE_Task_Suspend() selected - task suspend not enabled #endif #if NUSE_INITIAL_TASK_STATE_SUPPORT &amp;&amp; !NUSE_SUSPEND_ENABLE #error NUSE: Initial task state enabled - task suspend not enabled #endif /*** Partition pools ***/ #if NUSE_PARTITION_POOL_NUMBER &gt; 16 #error NUSE: invalid number of partition pools - must be 0-16 #endif #if NUSE_PARTITION_POOL_NUMBER == 0 #if NUSE_PARTITION_ALLOCATE #error NUSE: NUSE_Partition_Allocate() enabled – no partition pools configured #endif #if NUSE_PARTITION_DEALLOCATE #error NUSE: NUSE_Partition_Deallocate() enabled – no partition pools configured #endif #if NUSE_PARTITION_POOL_INFORMATION #error NUSE: NUSE_Partition_Pool_Information() enabled – no partition pools configured #endif #endif</code> </pre> <br>  Kode di atas melakukan pemeriksaan berikut: <br><ul><li>  periksa setidaknya satu, tetapi tidak lebih dari enam belas tugas yang dikonfigurasikan; </li><li>  Konfirmasi bahwa fungsi API yang dipilih kompatibel dengan penjadwal yang dipilih dan parameter tertentu lainnya; </li><li>  verifikasi bahwa tidak lebih dari enam belas contoh objek kernel lain dibuat; </li><li>  Konfirmasi bahwa fungsi API yang terkait dengan objek yang tidak dideklarasikan belum dipilih. </li><li>  memastikan bahwa fungsi API untuk sinyal dan waktu sistem tidak digunakan ketika dukungan untuk layanan ini dinonaktifkan; </li><li>  verifikasi jenis penjadwal yang dipilih dan parameter terkait. </li></ul><br>  Dalam semua kasus, deteksi kesalahan mengarah ke pelaksanaan arahan <b>#error</b> saat kompilasi.  Ini biasanya menyebabkan kompilasi berhenti dan menampilkan pesan yang sesuai. <br><br>  File ini tidak menjamin ketidakmungkinan membuat konfigurasi / konfigurasi yang salah, tetapi membuatnya sangat tidak mungkin. <br><br><h2>  Memeriksa Pengaturan API </h2><br>  Seperti Nucleus RTOS, Nucleus SE memiliki kemampuan untuk memasukkan kode untuk memeriksa parameter fungsi panggilan API saat runtime.  Biasanya ini hanya digunakan selama debugging awal dan pengujian, karena dalam kode program akhir konsumsi memori yang berlebihan tidak diinginkan. <br><br>  Pemeriksaan parameter diaktifkan dengan mengatur parameter <b>NUSE_API_PARAMETER_CHECKING</b> dalam file <b>nuse_config.h</b> ke <b>TRUE</b> .  Ini mengarah pada kompilasi dari kode tambahan yang diperlukan.  Berikut ini adalah contoh memeriksa parameter fungsi API: <br><pre> <code class="plaintext hljs">STATUS NUSE_Mailbox_Send(NUSE_MAILBOX mailbox, ADDR *message, U8 suspend) { STATUS return_value; #if NUSE_API_PARAMETER_CHECKING if (mailbox &gt;= NUSE_MAILBOX_NUMBER) { return NUSE_INVALID_MAILBOX; } if (message == NULL) { return NUSE_INVALID_POINTER; } #if NUSE_BLOCKING_ENABLE if ((suspend != NUSE_NO_SUSPEND) &amp;&amp; (suspend != NUSE_SUSPEND)) { return NUSE_INVALID_SUSPEND; } #else if (suspend != NUSE_NO_SUSPEND) { return NUSE_INVALID_SUSPEND; } #endif #endif</code> </pre><br>  Pemeriksaan parameter semacam itu dapat mengarah pada fakta bahwa panggilan API akan menampilkan kode kesalahan.  Ini adalah nilai negatif dari formulir <b>NUSE_INVALID_xxx</b> (misalnya, <b>NUSE_INVALID_POINTER</b> ) - satu set definisi lengkap terkandung dalam file <b>nuse_codes.h</b> . <br><br>  Untuk memproses nilai-nilai kesalahan, kode aplikasi tambahan (mungkin dibuat menggunakan kompilasi bersyarat) dapat ditambahkan, namun, untuk mendeteksinya, lebih baik menggunakan alat pemantauan dari data para penentang firmware modern. <br><br>  Memeriksa parameter mengarah pada konsumsi memori tambahan (kode tambahan) dan memengaruhi kinerja kode, oleh karena itu, penggunaannya akan memengaruhi keseluruhan sistem.  Karena seluruh kode sumber Nucleus SE tersedia untuk pengembang, verifikasi dan debugging dapat dilakukan secara manual pada kode aplikasi akhir jika akurasi mutlak diperlukan. <br><br><h2>  Memeriksa tumpukan tugas </h2><br>  Sampai Run to Completion Scheduler digunakan, Nucleus SE menyediakan kemampuan untuk memeriksa tumpukan tugas, yang mirip dengan fungsi serupa di Nucleus RTOS dan menunjukkan ruang yang tersisa di tumpukan.  Panggilan utilitas API ini ( <b>NUSE_Task_Check_Stack ()</b> ) dijelaskan secara rinci dalam <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">artikel sebelumnya</a> (# 12).  Beberapa ide untuk memeriksa kesalahan tumpukan disediakan nanti di artikel ini di bagian Custom Diagnostics. <br><br><h2>  Informasi Versi </h2><br>  Nucleus RTOS dan Nucleus SE memiliki fungsi API yang hanya mengembalikan versi kernel / membangun informasi. <br><br><h3>  Panggilan API RTOS Nucleus </h3><br>  Prototipe panggilan layanan: <br>  CHAR * NU_Release_Information (VOID); <br><br>  Parameter: tidak ada. <br><br>  Nilai pengembalian: <br>  Pointer ke string yang berisi informasi versi yang diakhiri dengan byte nol. <br><br><h3>  Nucleus SE API Call </h3><br>  Panggilan API ini mendukung fungsionalitas inti API Nucleus RTOS. <br><br>  Prototipe panggilan layanan: <br>  char * NUSE_Release_Information (void); <br><br>  Parameter: tidak ada. <br><br>  Nilai pengembalian: <br>  Pointer ke string yang berisi informasi versi yang diakhiri dengan byte nol. <br><br><h3>  Melakukan panggilan untuk mendapatkan informasi perakitan Nucleus SE </h3><br>  Menerapkan panggilan API ini cukup sederhana.  Pointer dikembalikan ke baris konstan <b>NUSE_Release_Info</b> , yang dideklarasikan dan diinisialisasi dalam file <b>nuse_globals.c</b> . <br><br>  Baris ini memiliki bentuk Nucleus SE - <b>Xyymmmdd</b> , di mana: <br>  Status <b>X</b> -build: <b>A</b> = alpha;  <b>B</b> = beta;  <b>R</b> = rilis <br>  <b>yy</b> - tahun rilis <br>  <b>mm</b> - bulan rilis <br>  <b>dd</b> - hari rilis <br><br><h2>  Kompatibel dengan RTOS Inti </h2><br>  Nucleus RTOS berisi dukungan majalah sejarah opsional.  Kernel mencatat detail berbagai tindakan sistem.  Ada fungsi API yang memungkinkan program untuk: <br><ul><li>  aktifkan / nonaktifkan logging; </li><li>  buat entri jurnal; </li><li>  Dapatkan entri jurnal. </li></ul><br>  Fitur ini tidak didukung di Nucleus SE. <br><br>  Nucleus RTOS juga memiliki beberapa makro manajemen kesalahan yang memungkinkan Anda untuk melakukan konfirmasi kesalahan (ASSERT) dan memberikan kemampuan untuk memanggil fungsi kesalahan kritis yang ditentukan pengguna.  Mereka secara opsional termasuk dalam rakitan OS.  Nucleus SE tidak mendukung fungsi ini. <br><br><h3>  Diagnostik Pengguna </h3><br>  Sejauh ini dalam artikel ini, kita telah melihat alat diagnostik dan pengecekan kesalahan yang disediakan oleh Nucleus SE itu sendiri.  Sekarang perlu diceritakan bagaimana alat diagnostik yang ditetapkan oleh pengguna atau berorientasi pada aplikasi tertentu dapat diimplementasikan menggunakan alat yang disediakan oleh kernel dan / atau pengetahuan kita tentang struktur internal dan implementasinya <br><br><h3>  Diagnostik khusus aplikasi </h3><br>  Di hampir setiap aplikasi, Anda dapat menambahkan kode tambahan untuk memverifikasi integritasnya saat runtime.  Inti multitasking memudahkan dan sederhana untuk membuat tugas khusus untuk pekerjaan ini.  Jelas, dalam artikel ini kami tidak akan mempertimbangkan kasus diagnosis yang terlalu tidak biasa, tetapi mempertimbangkan beberapa ide umum. <br><br><h3>  Pemeriksaan memori </h3><br>  Jelas, operasi memori yang tepat sangat penting untuk integritas sistem prosesor apa pun.  Tidak kurang jelas bahwa kesalahan kritis tidak akan memungkinkan Anda untuk menjalankan, tidak hanya diagnosa, tetapi seluruh produk perangkat lunak secara keseluruhan ( <i>catatan penerjemah: Omong-omong, ini persis kasus yang kami teliti dalam <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">artikel "Pil Biru Palsu"</a></i> ).  Namun, ada situasi ketika kesalahan tertentu muncul, yang merupakan penyebab serius yang perlu diperhatikan, tetapi tidak mengganggu eksekusi kode.  Pengujian memori adalah topik yang agak rumit yang berada di luar cakupan artikel ini, jadi saya hanya akan memberikan beberapa gagasan umum. <br><br>  Dua kesalahan paling umum yang terjadi pada RAM adalah: <br><ul><li>  "Sticky bits" ketika bit memiliki nilai 0 atau 1, yang tidak dapat diubah; </li><li>  "Crosstalk" ketika bit yang berdekatan menyebabkan gangguan satu sama lain. </li></ul><br>  Kedua kesalahan dapat diperiksa dengan menulis dan membaca pola pengujian tertentu untuk setiap area RAM secara bergantian.  Beberapa pemeriksaan dapat dilakukan hanya pada saat startup, bahkan sebelum stack terbentuk ( <i>catatan penerjemah: dalam artikel yang disebutkan di atas ternyata itu adalah penggunaan pertama dari stack yang menghancurkan semuanya sekaligus</i> ).  Misalnya, "unit yang berjalan" memeriksa, di mana setiap bit memori diberi nilai satu, dan semua bit lainnya diperiksa untuk memastikan bahwa mereka sama dengan nol.  Pola pengujian bitwise lainnya dapat dilakukan selama operasi, asalkan saat area RAM rusak, pengalihan konteks tidak akan terjadi.  Menggunakan makro pembatasan bagian kritis <b>Nucleus SE NUSE_CS_Enter ()</b> dan <b>NUSE_CS_Exit ()</b> cukup sederhana dan dapat diskalakan. <br><br>  Berbagai jenis ROM juga rentan terhadap kesalahan berkala, tetapi tidak ada banyak alat untuk memeriksanya.  Sebuah checksum yang dihitung setelah kode telah dikumpulkan dapat berguna di sini.  Pemeriksaan ini dapat dilakukan saat boot, dan mungkin saat runtime. <br><br>  Kesalahan dalam logika pengalamatan memori dapat memengaruhi ROM dan RAM.  Anda dapat mengembangkan pemeriksaan khusus untuk kesalahan ini, tetapi kemungkinan besar akan terdeteksi sebagai bagian dari pemeriksaan yang dijelaskan di atas. <br><br><h3>  Menguji Periferal </h3><br>  Selain CPU, sirkuit periferal juga dapat rawan kesalahan.  Tentu saja, ini sangat bervariasi dari satu sistem ke sistem lainnya, namun di sebagian besar perangkat ada berbagai cara untuk memeriksa integritasnya menggunakan perangkat lunak diagnostik.  Misalnya, saluran komunikasi mungkin memiliki mode verifikasi loopback di mana setiap data yang masuk ke saluran segera dikembalikan. <br><br><h3>  Layanan Watchdog </h3><br>  Pengembang yang disematkan sering menggunakan anjing penjaga.  Ini adalah perangkat periferal yang mengganggu CPU dan menunggu respons, atau (lebih disukai) memerlukan akses berkala dari perangkat lunak.  Dalam kedua kasus, hasil umum dari pengawas waktu adalah reset sistem. <br><br>  Penggunaan pengawas yang efektif di lingkungan multitasking adalah masalah yang kompleks.  Jika Anda membuat tugas yang secara berkala mengaksesnya (pengawas waktu), itu akan mengkonfirmasi bahwa tugas khusus ini berfungsi.  Sebuah solusi yang mungkin bisa menjadi implementasi dari "tugas operator".  Contoh dari tugas semacam itu akan diberikan di bawah ini. <br><br><h3>  Stack overflow check </h3><br>  Jika Anda tidak menggunakan Run to Completion Scheduler, tumpukan akan dibuat untuk setiap tugas dalam aplikasi Nucleus SE.  Integritas tumpukan ini sangat penting, tetapi jumlah RAM cenderung terbatas, oleh karena itu, penting untuk membuat ukuran aplikasi optimal.  Memprediksi secara statis persyaratan untuk tumpukan setiap tugas dimungkinkan, tetapi sangat sulit.  Tumpukan harus cukup besar bahkan untuk fungsi yang paling bersarang, bersama dengan pengendali interrupt yang paling menuntut.  Pendekatan yang lebih sederhana untuk menyelesaikan masalah ini adalah dengan menggunakan pengujian runtime lengkap. <br><br>  Secara umum, ada dua pendekatan untuk menumpuk verifikasi.  Jika Anda menggunakan debugger perangkat lunak tertanam yang canggih, batas-batas tumpukan dapat dimonitor dan semua pelanggaran akan terdeteksi.  <b>Lokasi</b> dan ukuran tumpukan Nucleus SE tersedia dalam struktur data ROM global: <b>NUSE_Task_Stack_Base []</b> dan <b>NUSE_Task_Stack_Size []</b> . <br><br>  Alternatif adalah pengujian runtime.  Pendekatan umum adalah dengan menggunakan "kata-kata penjaga" di akhir setiap tumpukan, biasanya elemen pertama dari setiap area data tumpukan.  Kata-kata ini diinisialisasi dengan nilai bukan nol yang dikenali.  Tugas layanan / diagnostik kemudian memeriksa untuk melihat apakah kata-kata ini telah berubah, dan melakukan tindakan yang sesuai.  Menghancurkan kata keamanan tidak berarti bahwa tumpukan sudah penuh, tetapi menunjukkan bahwa ini akan terjadi.  Oleh karena itu, perangkat lunak dapat terus berfungsi, Anda mungkin perlu mengambil tindakan korektif atau melaporkan kesalahan kepada pengguna. <br><br><h3>  Tugas Pengawas </h3><br>  Terlepas dari kenyataan bahwa Nucleus SE tidak menyimpan salah satu dari enam belas tugas yang mungkin untuk kebutuhannya sendiri, pengguna dapat memilih satu tugas untuk diagnostik.  Ini bisa menjadi tugas dengan prioritas rendah yang hanya menggunakan waktu prosesor "bebas", atau bisa menjadi tugas dengan prioritas tinggi yang berjalan secara berkala, mengambil periode waktu singkat, yang memastikan bahwa diagnostik dilakukan secara teratur. <br><br>  Berikut ini adalah contoh bagaimana tugas serupa mungkin bekerja. <br><br>  Bendera sinyal dari tugas dispatcher digunakan untuk melacak operasi enam tugas sistem kritis.  Masing-masing tugas ini menggunakan flag tertentu (dari bit 0 ke bit 5) dan harus ditetapkan secara teratur.  Tugas operator ulang semua bendera, dan kemudian berhenti pekerjaannya untuk jangka waktu tertentu.  Ketika dia melanjutkan kembali pekerjaannya, dia berharap bahwa keenam tugas tersebut "diperiksa" dengan mengatur bendera yang sesuai, kemudian dia mencari kecocokan yang tepat dengan nilai <b>b00111111</b> (dari file <b>nuse_binary.h</b> ).  Jika semuanya memenuhi persyaratan, itu akan mengatur ulang bendera dan berhenti lagi.  Jika tidak, ini disebut rutin penanganan kesalahan kritis, yang pada gilirannya dapat, misalnya, reboot sistem. <br><br>  Dalam implementasi alternatif, kelompok bendera acara dapat digunakan.  Ini masuk akal jika sinyal tidak digunakan di tempat lain dalam aplikasi (jika tidak, ini akan menyebabkan penggunaan RAM yang berlebihan oleh semua tugas) dan terutama jika flag event digunakan untuk tujuan lain. <br><br><h2>  Menelusuri dan membuat profil </h2><br>  Terlepas dari kenyataan bahwa banyak debugger perangkat lunak tertanam modern memiliki tingkat penyesuaian yang tinggi dan dapat digunakan untuk bekerja dengan RTOS, men-debug aplikasi multi-utas masih sulit.  Pendekatan yang banyak digunakan adalah profil pasca-eksekusi, di mana kode (RTOS) diimplementasikan sehingga audit rinci pekerjaannya dapat dianalisis dalam retrospeksi.  Biasanya, implementasi layanan seperti itu mencakup dua komponen: <br><ol><li>  Kode tambahan ditambahkan ke RTOS untuk mencatat tindakan.  Biasanya, itu akan dibungkus dalam arahan preprocessor untuk menggunakan kompilasi bersyarat.  Kode ini merekam beberapa byte informasi ketika peristiwa penting terjadi (misalnya, memanggil fungsi API atau mengalihkan konteks).  Informasi tersebut dapat meliputi: <br><ul><li>  alamat saat ini (PC); </li><li>  ID tugas saat ini (indeks); </li><li>  indeks benda bekas lainnya; </li><li>  kode yang sesuai dengan operasi yang dilakukan. </li></ul><br></li><li>  Tugas yang dialokasikan untuk menurunkan buffer informasi profil ke penyimpanan eksternal, biasanya ke komputer host. </li></ol><br>  Analisis data yang diperoleh juga membutuhkan beberapa pekerjaan, tetapi tidak lebih rumit daripada menggunakan lembar kerja Excel biasa. <br><br>  Pada artikel berikutnya, kita akan memeriksa secara rinci kompatibilitas Nucleus SE dan Nucleus RTOS. <br><br>  <b>Tentang Pengarang:</b> Colin Walls telah bekerja di industri elektronik selama lebih dari tiga puluh tahun, mencurahkan sebagian besar waktunya untuk firmware.  Dia sekarang adalah seorang insinyur firmware di Mentor Embedded (sebuah divisi dari Mentor Graphics).  Colin Walls sering berbicara di konferensi dan seminar, penulis berbagai artikel teknis dan dua buku tentang firmware.  Tinggal di Inggris.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Blog</a> profesional <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Colin</a> , email: colin_walls@mentor.com. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id463403/">https://habr.com/ru/post/id463403/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id463391/index.html">Cara menikahi semua orang (pernikahan satu, dua, dan tiga jenis kelamin) dari sudut pandang matematika dan mengapa pria selalu menang</a></li>
<li><a href="../id463393/index.html">Apakah perusahaan Anda keluarga atau tim olahraga?</a></li>
<li><a href="../id463397/index.html">Pasar valuta asing dan rekayasa keuangan pada Abad Pertengahan</a></li>
<li><a href="../id463399/index.html">Memperkenalkan Pembaruan 3CX 16 3 Alpha - Advanced DNS dan Mobile Client Reconnection</a></li>
<li><a href="../id463401/index.html">Naples ke Roma: CPU AMD EPYC Baru</a></li>
<li><a href="../id463405/index.html">Lapisan kedua pengembangan (mobile game), apa, kapan, dan mengapa</a></li>
<li><a href="../id463411/index.html">Jangan bekerja dalam proyek yang buruk</a></li>
<li><a href="../id463415/index.html">Security Week 33: menarik dengan Black Hat / DEF CON 2019</a></li>
<li><a href="../id463417/index.html">Porting OS ke Aarch64</a></li>
<li><a href="../id463419/index.html">Acara digital di Moskow dari 12 hingga 18 Agustus</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>