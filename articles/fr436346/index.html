<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üè£ üèÇüèΩ ‚õΩÔ∏è Avez-vous toujours besoin de Docker, de microservices et d'une programmation r√©active? üíáüèª ü¶ã üíª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Publi√© par Denis Tsyplakov , architecte de solutions, DataArt 

 Dans DataArt, je travaille de deux mani√®res. Dans le premier, j'aide les gens √† r√©par...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Avez-vous toujours besoin de Docker, de microservices et d'une programmation r√©active?</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/dataart/blog/436346/"><img src="https://habrastorage.org/webt/1i/fo/8q/1ifo8qsvpiw12dn-kv78tby-gue.jpeg"><br><br>  <i>Publi√© par <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Denis Tsyplakov</a> , architecte de solutions, DataArt</i> <br><br>  Dans DataArt, je travaille de deux mani√®res.  Dans le premier, j'aide les gens √† r√©parer des syst√®mes qui sont cass√©s d'une mani√®re ou d'une autre et pour diverses raisons.  Dans le second, j'aide √† concevoir de nouveaux syst√®mes afin qu'ils ne soient pas cass√©s √† l'avenir, ou, plus r√©aliste, les casser √©tait plus difficile. <br><br>  Si vous ne faites pas quelque chose de fondamentalement nouveau, par exemple le premier moteur de recherche Internet ou l'intelligence artificielle au monde pour contr√¥ler le lancement de missiles nucl√©aires, la cr√©ation d'une bonne conception de syst√®me est assez simple.  Il suffit de prendre en compte toutes les exigences, d'examiner la conception de syst√®mes similaires et de faire √† peu pr√®s la m√™me chose, sans commettre de graves erreurs.  Cela ressemble √† une simplification excessive du probl√®me, mais rappelons que dans le chantier est l'ann√©e 2019, et il existe des ¬´recettes standard¬ª pour la conception du syst√®me pour presque tout.  Une entreprise peut s'attaquer √† des t√¢ches techniques complexes - par exemple, traiter un million de fichiers PDF h√©t√©rog√®nes et en supprimer des tableaux de d√©penses - mais l'architecture du syst√®me est rarement tr√®s originale.  L'essentiel ici n'est pas de se tromper en d√©terminant quel syst√®me nous construisons, et de ne pas rater le choix des technologies. <br><br>  Des erreurs typiques se produisent r√©guli√®rement dans le dernier paragraphe, dont certaines dont je parlerai dans un article. <a name="habracut"></a><br><br>  Quelle est la difficult√© de choisir une pile technique?  L'ajout de toute technologie au projet le rend plus difficile et apporte une sorte de limitations.  Par cons√©quent, l'ajout d'un nouvel outil (framework, biblioth√®que) ne doit √™tre effectu√© que lorsque cet outil est plus utile que nuisible.  Dans les conversations avec les membres de l'√©quipe sur l'ajout de biblioth√®ques et de frameworks, j'utilise souvent en plaisantant l'astuce suivante: ¬´Si vous voulez ajouter une nouvelle d√©pendance au projet, vous mettez une bo√Æte de bi√®re pour l'√©quipe.  Si vous pensez que cette d√©pendance d'une caisse de bi√®re n'en vaut pas la peine, ne l'ajoutez pas. ¬ª <br><br>  Supposons que nous cr√©ons une certaine application, disons, en Java et que nous ajoutions la biblioth√®que TimeMagus au projet pour manipuler les dates (un exemple est fictif).  La biblioth√®que est excellente, elle nous offre de nombreuses fonctionnalit√©s qui ne sont pas disponibles dans la biblioth√®que de classes standard.  Comment une telle d√©cision peut-elle √™tre nuisible?  Regardons les sc√©narios possibles: <br><br><ol><li>  Tous les d√©veloppeurs ne connaissent pas une biblioth√®que non standard, le seuil d'entr√©e pour les nouveaux d√©veloppeurs sera plus √©lev√©.  Les chances augmentent qu'un nouveau d√©veloppeur commettra une erreur lors de la manipulation d'une date √† l'aide d'une biblioth√®que inconnue. </li><li> La taille de la distribution augmente.  Lorsque la taille de l'application moyenne sur Spring Boot peut facilement atteindre 100 Mo, ce n'est en aucun cas une bagatelle.  J'ai vu des cas o√π, pour le bien d'une m√©thode, une biblioth√®que de 30 Mo a √©t√© tir√©e dans le kit de distribution.  Ils l'ont justifi√© ainsi: "J'ai utilis√© cette biblioth√®que dans un projet pr√©c√©dent, et il y a l√† une m√©thode pratique." </li><li>  Selon la biblioth√®que, l'heure de d√©but peut augmenter consid√©rablement. </li><li>  Le d√©veloppeur de la biblioth√®que peut abandonner son id√©e originale, puis la biblioth√®que commencera √† entrer en conflit avec la nouvelle version de Java, ou un bogue sera d√©tect√© (provoqu√©, par exemple, par un changement de fuseau horaire), et aucun correctif ne sera publi√©. </li><li>  √Ä un moment donn√©, la licence de la biblioth√®que entrera en conflit avec la licence de votre produit (v√©rifiez-vous les licences de tous les produits que vous utilisez?). </li><li>  Jar hell - La biblioth√®que TimeMagus a besoin de la derni√®re version de la biblioth√®que SuperCollections, puis apr√®s quelques mois, vous devez connecter la biblioth√®que pour l'int√©gration avec une API tierce, qui ne fonctionne pas avec la derni√®re version de SuperCollections, et ne fonctionne qu'avec la version 2.x.  Vous ne pouvez pas connecter une API. Il n'y a pas d'autre biblioth√®que pour travailler avec cette API. </li></ol><br>  D'un autre c√¥t√©, la biblioth√®que standard nous fournit des outils pratiques pour manipuler les dates, et si vous n'avez pas besoin de maintenir, par exemple, un calendrier exotique ou de calculer le nombre de jours √† partir d'aujourd'hui jusqu'au ¬´deuxi√®me jour de la troisi√®me nouvelle lune de l'ann√©e pr√©c√©dente de l'aigle planeur¬ª, cela peut valoir la peine s'abstenir d'utiliser une biblioth√®que tierce.  M√™me si c'est compl√®tement merveilleux et √† l'√©chelle d'un projet, cela vous fera √©conomiser jusqu'√† 50 lignes de code. <br><br>  L'exemple consid√©r√© est assez simple et je pense qu'il est facile de prendre une d√©cision.  Mais il existe un certain nombre de technologies qui sont r√©pandues, √† l'oreille de tous, et leur utilisation est √©vidente, ce qui rend le choix plus difficile - elles offrent vraiment de s√©rieux avantages au d√©veloppeur.  Mais cela ne doit pas toujours √™tre l'occasion de les faire glisser dans votre projet.  Regardons certains d'entre eux. <br><br><h2>  Docker </h2><br>  Avant l'√©mergence de cette technologie vraiment cool, lors du d√©ploiement de syst√®mes, de nombreux probl√®mes d√©sagr√©ables et complexes √©taient li√©s aux conflits de versions et aux d√©pendances obscures.  Docker vous permet de cr√©er un instantan√© de l'√©tat du syst√®me, de le faire rouler en production et de l'ex√©cuter l√†-bas.  Cela permet d'√©viter les conflits mentionn√©s, ce qui, bien s√ªr, est formidable. <br><br>  Auparavant, cela se faisait de mani√®re monstrueuse et certaines t√¢ches n'√©taient pas r√©solues du tout.  Par exemple, vous avez une application PHP qui utilise la biblioth√®que ImageMagick pour travailler avec des images, votre application a √©galement besoin de param√®tres php.ini sp√©cifiques et l'application elle-m√™me est h√©berg√©e √† l'aide d'Apache httpd.  Mais il y a un probl√®me: certaines routines r√©guli√®res sont impl√©ment√©es en ex√©cutant des scripts Python √† partir de cron, et la biblioth√®que utilis√©e par ces scripts entre en conflit avec les versions des biblioth√®ques utilis√©es dans votre application.  Docker vous permet de regrouper l'int√©gralit√© de votre application, ainsi que les param√®tres, les biblioth√®ques et un serveur HTTP, dans un conteneur qui sert les requ√™tes sur le port 80 et les routines dans un autre conteneur.  Tous ensemble fonctionneront parfaitement et vous pouvez oublier le conflit des biblioth√®ques. <br><br>  Dois-je utiliser Docker pour emballer chaque application?  Mon avis: non, √ßa ne vaut pas le coup.  L'image montre une composition typique d'une application dock√©e d√©ploy√©e dans AWS.  Les rectangles ici indiquent les couches d'isolation que nous avons. <br><br><img src="https://habrastorage.org/webt/wg/l9/0_/wgl90_ho4o9feo2r7o7ktzhiy4a.png"><br><br>  Le plus grand rectangle est la machine physique.  Vient ensuite le syst√®me d'exploitation de la machine physique.  Ensuite - le virtualiseur amazonien, puis le syst√®me d'exploitation de la machine virtuelle, puis le conteneur de docker, suivi du syst√®me d'exploitation du conteneur, de la JVM, puis du conteneur de servlet (s'il s'agit d'une application Web), et votre code d'application est d√©j√† √† l'int√©rieur.  Autrement dit, nous voyons d√©j√† quelques couches d'isolation. <br><br>  La situation sera encore pire si nous regardons l'acronyme JVM.  JVM est, curieusement, la machine virtuelle Java, c'est-√†-dire qu'en fait, nous avons toujours au moins une machine virtuelle en Java.  Ajouter ici un conteneur Docker suppl√©mentaire, d'une part, ne donne souvent pas un tel avantage notable, car la JVM en elle-m√™me nous isole d√©j√† assez bien de l'environnement externe, et d'autre part, ce n'est pas sans co√ªt. <br><br>  J'ai pris des chiffres d'une √©tude IBM, si ce n'est par erreur, il y a deux ans.  En bref, si nous parlons des op√©rations sur le disque, de l'utilisation du processeur ou de l'acc√®s √† la m√©moire, Docker n'ajoute presque pas de surcharge (litt√©ralement une fraction de pour cent), mais si nous parlons de latence du r√©seau, les retards sont assez visibles.  Ils ne sont pas gigantesques, mais selon l'application que vous utilisez, ils peuvent vous surprendre d√©sagr√©ablement. <br><br><img src="https://habrastorage.org/webt/pb/om/j-/pbomj-5curelulxpmomito3jy7a.png"><br><br>  De plus, Docker consomme de l'espace disque suppl√©mentaire, occupe une partie de la m√©moire et ajoute du temps de d√©marrage.  Ces trois points ne sont pas critiques pour la plupart des syst√®mes - il y a g√©n√©ralement beaucoup d'espace disque et de m√©moire.  Le temps de lancement, en r√®gle g√©n√©rale, n'est pas non plus un probl√®me critique, l'essentiel est que l'application d√©marre.  Mais il existe encore des situations o√π la m√©moire peut s'√©puiser et l'heure de d√©marrage totale du syst√®me, compos√© de vingt services d√©pendants, est d√©j√† assez grande.  De plus, cela affecte le co√ªt de l'h√©bergement.  Et si vous √™tes engag√© dans un trading √† haute fr√©quence, Docker ne vous convient absolument pas.  Dans le cas g√©n√©ral, il est pr√©f√©rable de ne pas ancrer une application sensible aux retards du r√©seau jusqu'√† 250-500 ms. <br><br>  De plus, avec le docker, l'analyse des probl√®mes dans les protocoles r√©seau est sensiblement compliqu√©e, non seulement les retards augmentent, mais tous les timings deviennent diff√©rents. <br><br><h3>  Quand Docker est-il vraiment n√©cessaire? </h3><br>  Lorsque nous avons diff√©rentes versions du JRE, et ce serait bien de le faire glisser.  Il y a des moments o√π vous devez ex√©cuter une certaine version de Java (pas ¬´la derni√®re Java 8¬ª, mais quelque chose de plus sp√©cifique).  Dans ce cas, il est bon d'emballer le JRE avec l'application et de l'ex√©cuter en tant que conteneur.  En principe, il est clair que diff√©rentes versions de Java peuvent √™tre mises sur le syst√®me cible en raison de JAVA_HOME, etc. Mais Docker dans ce sens est beaucoup plus pratique, car vous connaissez la version exacte du JRE, tout est emball√© et avec un autre JRE, l'application ne d√©marre m√™me pas par accident . <br><br>  Docker est √©galement n√©cessaire si vous avez des d√©pendances sur certaines biblioth√®ques binaires, par exemple pour le traitement d'images.  Dans ce cas, il peut √™tre judicieux de regrouper toutes les biblioth√®ques n√©cessaires avec l'application Java elle-m√™me. <br><br>  Le cas suivant se r√©f√®re √† un syst√®me qui est un composite complexe de divers services √©crits dans diff√©rentes langues.  Vous avez un morceau sur Node.js, une partie en Java, une biblioth√®que en Go, et, en plus, une sorte de Machine Learning en Python.  Tout ce zoo doit √™tre soigneusement et soigneusement r√©gl√© afin d'apprendre √† ses √©l√©ments √† se voir.  D√©pendances, chemins, adresses IP - tout cela doit √™tre peint et soigneusement relev√© en production.  Bien s√ªr, dans ce cas, Docker vous aidera beaucoup.  De plus, le faire sans son aide est tout simplement douloureux. <br><br>  Docker peut offrir une certaine commodit√© lorsque vous devez sp√©cifier de nombreux param√®tres diff√©rents sur la ligne de commande pour d√©marrer l'application.  D'un autre c√¥t√©, les scripts bash le font tr√®s bien, souvent √† partir d'une seule ligne.  D√©cidez lequel utiliser le mieux. <br><br>  La derni√®re chose qui vous vient √† l'esprit est la situation lorsque vous utilisez, disons, Kubernetes, et que vous devez faire une orchestration du syst√®me, c'est-√†-dire augmenter un certain nombre de microservices diff√©rents qui √©voluent automatiquement selon certaines r√®gles. <br><br>  Dans tous les autres cas, Spring Boot est suffisant pour tout regrouper dans un seul fichier jar.  Et, en principe, le pot Springboot est une bonne m√©taphore pour le conteneur Docker.  Bien s√ªr, ce n'est pas la m√™me chose, mais en termes de facilit√© de d√©ploiement, ils sont vraiment similaires. <br><br><h2>  Kubernetes </h2><br>  Et si nous utilisons Kubernetes?  Pour commencer, cette technologie vous permet de d√©ployer un grand nombre de microservices sur diff√©rentes machines, de les g√©rer, d'effectuer une mise √† l'√©chelle automatique, etc. Cependant, il existe de nombreuses applications qui vous permettent de contr√¥ler l'orchestration, par exemple, Puppet, CF engine, SaltStack, etc.  Kubernetes lui-m√™me est certainement bon, mais il peut ajouter des frais g√©n√©raux importants, avec lesquels tous les projets ne sont pas pr√™ts √† vivre. <br><br>  Mon outil pr√©f√©r√© est Ansible, combin√© avec Terraform l√† o√π vous en avez besoin.  Ansible est un outil l√©ger d√©claratif assez simple.  Il ne n√©cessite pas l'installation d'agents sp√©ciaux et poss√®de la syntaxe compr√©hensible des fichiers de configuration.  Si vous connaissez Docker compose, vous verrez imm√©diatement des sections qui se chevauchent.  Et si vous utilisez Ansible, il n'est pas n√©cessaire de pr√©-rezerez - vous pouvez d√©ployer des syst√®mes en utilisant des moyens plus classiques. <br><br>  Il est clair que tout de m√™me, ce sont des technologies diff√©rentes, mais il y a un ensemble de t√¢ches dans lesquelles elles sont interchangeables.  Et une approche consciencieuse de la conception n√©cessite une analyse de la technologie qui convient le mieux au syst√®me en cours de d√©veloppement.  Et comment il vaudra mieux y correspondre dans quelques ann√©es. <br><br>  Si le nombre de services diff√©rents sur votre syst√®me est petit et que leur configuration est relativement simple, par exemple, vous n'avez qu'un seul fichier jar et vous ne voyez pas de croissance soudaine et explosive de la complexit√©, vous pouvez probablement vous en tirer avec les m√©canismes de d√©ploiement classiques. <br><br>  Cela soul√®ve la question ¬´attendez, comment est un fichier jar?¬ª.  Le syst√®me doit comprendre autant de microservices atomiques que possible!  Voyons qui et quoi le syst√®me devrait utiliser avec les microservices. <br><br><h2>  Microservices </h2><br>  Tout d'abord, les microservices permettent d'atteindre une plus grande flexibilit√© et √©volutivit√©, et permettent un versionnage flexible des diff√©rentes parties du syst√®me.  Supposons que nous ayons une sorte d'application qui est en production depuis de nombreuses ann√©es.  La fonctionnalit√© est en croissance, mais nous ne pouvons pas la d√©velopper √† l'infini de mani√®re extensive.  Par exemple. <br><br>  Nous avons une application dans Spring Boot 1 et Java 8. Une merveilleuse combinaison stable.  Mais l'ann√©e est 2019, et que cela nous plaise ou non, nous devons √©voluer vers Spring Boot 2 et Java 12. M√™me la transition relativement simple d'un grand syst√®me vers la nouvelle version de Spring Boot peut √™tre tr√®s laborieuse, mais il faut sauter par-dessus l'ab√Æme de Java 8 √† Java 12 Je ne veux pas parler.  Autrement dit, en th√©orie, tout est simple: nous migrons, corrigeons les probl√®mes qui se sont pos√©s, nous testons tout et l'ex√©cutons en production.  En pratique, cela peut signifier plusieurs mois de travail qui n'apportent pas de nouvelles fonctionnalit√©s √† l'entreprise.  Un petit passage √† Java 12, comme vous le savez, ne fonctionne pas non plus.  Ici, l'architecture de microservices peut nous aider. <br><br>  Nous pouvons allouer un groupe compact de fonctions de notre application dans un service distinct, migrer ce groupe de fonctions vers une nouvelle pile technique et le mettre en production en un temps relativement court.  R√©p√©tez le processus pi√®ce par pi√®ce jusqu'√† √©puisement des anciennes technologies. <br><br>  De plus, les microservices peuvent fournir une isolation des pannes, lorsqu'un composant tomb√© ne d√©truit pas le syst√®me entier. <br><br>  Les microservices nous permettent d'avoir une pile technique flexible, c'est-√†-dire de ne pas tout √©crire en une seule pi√®ce dans une langue et une version, et si n√©cessaire d'utiliser une pile technique diff√©rente pour les composants individuels.  Bien s√ªr, c'est mieux lorsque vous utilisez une pile technique uniforme, mais ce n'est pas toujours possible, et dans ce cas, les microservices peuvent vous aider. <br><br>  Les microservices permettent √©galement de r√©soudre techniquement un certain nombre de probl√®mes de gestion.  Par exemple, lorsque votre grande √©quipe se compose de groupes distincts travaillant dans diff√©rentes entreprises (assis dans des fuseaux horaires diff√©rents et parlant diff√©rentes langues).  Les microservices aident √† isoler cette diversit√© organisationnelle par des composants qui seront d√©velopp√©s s√©par√©ment.  Les probl√®mes d'une partie de l'√©quipe resteront dans un m√™me service et ne se propageront pas dans toute l'application. <br><br>  Mais les microservices ne sont pas le seul moyen de r√©soudre ces probl√®mes.  Curieusement, il y a quelques d√©cennies, pour la moiti√© d'entre eux, les gens ont propos√© des classes, et un peu plus tard - les composants et le mod√®le d'inversion de contr√¥le. <br><br>  Si nous regardons Spring, nous voyons qu'il s'agit en fait d'une architecture de microservices √† l'int√©rieur d'un processus Java.  Nous pouvons d√©clarer un composant, qui, par essence, est un service.  Nous avons la possibilit√© d'effectuer une recherche via @Autowired, il existe des outils pour g√©rer le cycle de vie des composants et la possibilit√© de configurer s√©par√©ment les composants √† partir d'une douzaine de sources diff√©rentes.  En principe, nous obtenons presque tout ce que nous avons avec les microservices - uniquement dans un seul processus, ce qui r√©duit consid√©rablement les co√ªts.  Une classe Java standard est le m√™me contrat d'API qui vous permet √©galement d'isoler les d√©tails de l'impl√©mentation. <br><br>  √Ä strictement parler, dans le monde Java, les microservices sont les plus similaires √† OSGi - nous avons l√† une copie presque exacte de tout ce qui est dans les microservices, sauf, en plus de la possibilit√© d'utiliser diff√©rents langages de programmation et l'ex√©cution de code sur diff√©rents serveurs.  Mais m√™me en restant dans les capacit√©s des classes Java, nous avons un outil assez puissant pour r√©soudre un grand nombre de probl√®mes d'isolement. <br><br>  M√™me dans un sc√©nario ¬´manag√©rial¬ª avec isolement d'√©quipe, nous pouvons cr√©er un r√©f√©rentiel s√©par√© qui contient un module Java distinct avec un contrat externe clair et un ensemble de tests.  Cela r√©duira consid√©rablement la capacit√© d'une √©quipe √† compliquer par inadvertance la vie d'une autre √©quipe. <br><br><img src="https://habrastorage.org/webt/fq/kn/v8/fqknv8g8bzypbpunprhjeeru_is.png"><br><br>  J'ai entendu √† plusieurs reprises qu'il est impossible d'isoler les d√©tails de mise en ≈ìuvre sans microservices.  Mais je peux r√©pondre que toute l'industrie du logiciel consiste √† isoler la mise en ≈ìuvre.  Pour cela, le sous-programme a d'abord √©t√© invent√© (dans les ann√©es 50 du si√®cle dernier), puis les fonctions, les proc√©dures, les classes et plus tard les microservices.  Mais le fait que les microservices de cette s√©rie soient apparus en dernier ne fait pas d'eux le point de d√©veloppement le plus √©lev√© et ne nous oblige pas √† toujours recourir √† leur aide. <br><br>  Lors de l'utilisation de microservices, il faut √©galement tenir compte du fait que les appels entre eux prennent un certain temps.  Ce n'est souvent pas important, mais j'ai vu un cas o√π le client devait adapter le temps de r√©ponse du syst√®me de 3 secondes.  Il s'agissait d'une obligation contractuelle de se connecter √† un syst√®me tiers.  La cha√Æne d'appels a travers√© plusieurs dizaines de microservices atomiques, et le surco√ªt li√© aux appels HTTP n'a pas permis de r√©tr√©cir en 3 secondes.  En g√©n√©ral, vous devez comprendre que toute division de code monolithique en un certain nombre de services affecte in√©vitablement les performances globales du syst√®me.  Tout simplement parce que les donn√©es ne peuvent pas √™tre t√©l√©port√©es entre les processus et les serveurs "gratuitement". <br><br><h3>  Quand faut-il des microservices? </h3><br>  Dans quels cas une application monolithique doit-elle vraiment √™tre divis√©e en plusieurs microservices?  Premi√®rement, lorsqu'il y a une utilisation d√©s√©quilibr√©e des ressources dans les domaines fonctionnels. <br><br>  Par exemple, nous avons un groupe d'appels d'API qui effectuent des calculs qui n√©cessitent beaucoup de temps processeur.  Et il existe un groupe d'appels API qui sont ex√©cut√©s tr√®s rapidement, mais n√©cessitent une structure de donn√©es encombrante de 64 Go pour √™tre stock√©s en m√©moire.  Pour le premier groupe, nous avons besoin d'un groupe de machines avec un total de 32 processeurs, pour le second une machine suffit (OK, qu'il y ait deux machines pour la tol√©rance de panne) avec 64 Go de m√©moire.  Si nous avons une application monolithique, nous aurons alors besoin de 64 Go de m√©moire sur chaque machine, ce qui augmente le co√ªt de chaque machine.  Si ces fonctions sont divis√©es en deux services distincts, nous pouvons √©conomiser des ressources en optimisant le serveur pour une fonction sp√©cifique.  La configuration du serveur peut ressembler √† ceci: <br><br><img src="https://habrastorage.org/webt/q3/2s/yo/q32syo6fpc3c3avb_wphdtwupp8.png"><br><br>  Des microservices sont n√©cessaires et si nous devons s√©rieusement mettre √† l'√©chelle une zone fonctionnelle √©troite.  Par exemple, une centaine de m√©thodes API sont appel√©es 10 fois par seconde et, disons, quatre m√©thodes API sont appel√©es 10 000 fois par seconde.  La mise √† l'√©chelle de l'ensemble du syst√®me n'est souvent pas n√©cessaire, c'est-√†-dire que nous pouvons bien s√ªr multiplier les 100 m√©thodes sur de nombreux serveurs, mais cela est g√©n√©ralement plus co√ªteux et plus compliqu√© que la mise √† l'√©chelle d'un groupe restreint de m√©thodes.  Nous pouvons s√©parer ces quatre appels dans un service distinct et ne l'adapter qu'√† un grand nombre de serveurs. <br><br>  Il est √©galement clair que nous pouvons avoir besoin d'un microservice si nous avons √©crit une zone fonctionnelle distincte, par exemple, en Python.  Parce que certaines biblioth√®ques (par exemple, pour Machine Learning) se sont av√©r√©es disponibles uniquement en Python, et nous voulons la s√©parer en un service distinct.  Il est √©galement judicieux de cr√©er un microservice si une partie du syst√®me est sujette √† des d√©faillances.  Bien s√ªr, il est bon d‚Äô√©crire du code pour qu‚Äôil n‚Äôy ait pas d‚Äô√©chec en principe, mais les raisons peuvent √™tre externes.  Et personne n'est √† l'abri de ses propres erreurs.  Dans ce cas, le bogue peut √™tre isol√© dans un processus distinct. <br><br>  Si votre application ne pr√©sente aucun des √©l√©ments ci-dessus et n'est pas attendue dans un avenir pr√©visible, il est fort probable qu'une application monolithique vous convienne le mieux.  La seule chose - je recommande de l'√©crire afin que les zones fonctionnelles qui ne sont pas li√©es les unes aux autres ne d√©pendent pas les unes des autres dans le code.  De sorte que, si n√©cessaire, les zones fonctionnelles qui ne sont pas interconnect√©es peuvent √™tre s√©par√©es les unes des autres.  Cependant, c'est toujours une bonne recommandation, ce qui augmente la coh√©rence interne et vous apprend √† formuler soigneusement les contrats de module. <br><br><h2>  Architecture r√©active et programmation r√©active </h2><br>  Une approche r√©active est une chose relativement nouvelle.  Le moment de son apparition peut √™tre consid√©r√© comme l'ann√©e 2014, lorsque <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">le manifeste r√©actif a</a> √©t√© publi√©.  Deux ans apr√®s la publication du manifeste, il √©tait bien connu de tous.  Il s'agit d'une approche vraiment r√©volutionnaire de la conception de syst√®mes.       ,      ,   ,     ,              . <br><br><img src="https://habrastorage.org/webt/5x/dh/zb/5xdhzbusskuvnn13ygva5cwu2wk.png"><br><br>  ,         .  ,      ,    : ¬´  ,      !?¬ª     , ,  ,            ,         ¬´¬ª.     ,   100%   ,      ,     . <br><br>      ‚Äî   ,      ‚Äî     .          . <br><br>     ?  ,     . <br><br>   - ,  - .     -  -, , HTTP-.     ,      .   ,       .     ,   ,     ,  . <br><br>          ?   ,  HTTP-            ,   ( callback)        (  )  .     ,  -   ( ,      HTTP-)   . <br><br>    ‚Äî   .            . . .      3 Ghz      ,   ,      . .    .  ,   Java-,    HTTP- ‚Äî     5-10%.  ,   , , ,    100   50 $/  ‚Äî    $500    .  ,  ,      . <br><br> ,   ?    . <br><br>        ,       .  ,        ,   ,   ,        ,       ,    .     ,   ,             .      . <br><br>     -   . , JDBC      (     . ADA, R2DBC,         ).   90 %      ,         .      ‚Äî  HTTP-    ,         .      ,          . <br><br><img src="https://habrastorage.org/webt/t-/om/uv/t-omuvjblahs0nbrkpmeomfh970.png"><br><br><h3>     ? </h3><br>  ,     , ,      (    )              .    ‚Äî         -    ,    .      ,      , ,  HTTP. <br><br>             ,       , ,        ,     , ,  . <br><br>              . ,  ¬´          ,       ¬ª       , ,     ,                 . ,        ,    ,    10  11 , ,         ,    . <br><br><h2>  Conclusion </h2><br>    ,         .              ,  ,        ,        . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr436346/">https://habr.com/ru/post/fr436346/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr436334/index.html">Apprentissage de concepts par interaction sensorimotrice</a></li>
<li><a href="../fr436338/index.html">Comment fonctionne l'a√©roport de Vnoukovo</a></li>
<li><a href="../fr436340/index.html">Niveau de journalisation distinct pour chaque demande</a></li>
<li><a href="../fr436342/index.html">Une introduction √† l'optimisation robuste [... et une petite liste de courses que j'ai oubli√© ...]</a></li>
<li><a href="../fr436344/index.html">Fibaro Home Center 2 et thermostat pour chauffage au sol HeatIt. Comment augmenter la temp√©rature</a></li>
<li><a href="../fr436348/index.html">D√©velopper une √©quipe pour demander des donn√©es √† partir d'une base de donn√©es - partie 2</a></li>
<li><a href="../fr436350/index.html">Apprenez les tactiques, techniques et connaissances communes contradictoires (ATT @ CK). Tactiques d'entreprise. Partie 7</a></li>
<li><a href="../fr436352/index.html">R√©sum√© des nouvelles de PostgreSQL. Num√©ro 14</a></li>
<li><a href="../fr436354/index.html">L'arm√©e am√©ricaine n√©glige les probl√®mes de cybers√©curit√©</a></li>
<li><a href="../fr436356/index.html">[Int√©ressant de derri√®re la colline] Comment arr√™ter la d√©pendance technologique?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>