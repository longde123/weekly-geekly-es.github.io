<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>âœï¸ ğŸš¾ ğŸ‘±ğŸ¿ æˆ‘ä»¬ä½¿ç”¨PowerShellå’ŒWSLåœ¨Windowsä¸­é›†æˆLinuxå‘½ä»¤ ğŸ¤·ğŸ¼ ğŸ‘ğŸ¿ ğŸ‘¨ğŸ¾â€ğŸ¤â€ğŸ‘¨ğŸ½</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Windowså¼€å‘äººå‘˜ç»å¸¸é‡åˆ°çš„ä¸€ä¸ªé—®é¢˜ï¼šâ€œä¸ºä»€ä¹ˆåœ¨è¿™é‡Œ< LINUX>ä»ç„¶æ²¡æœ‰ï¼Ÿâ€ã€‚ æ— è®ºæ˜¯åŠŸèƒ½å¼ºå¤§çš„lessæ»šåŠ¨åŠŸèƒ½è¿˜æ˜¯å¸¸ç”¨çš„grepæˆ–sedå·¥å…·ï¼ŒWindowså¼€å‘äººå‘˜éƒ½å¸Œæœ›åœ¨æ—¥å¸¸å·¥ä½œä¸­è½»æ¾è®¿é—®è¿™äº›å‘½ä»¤ã€‚ 

 åœ¨è¿™æ–¹é¢ï¼ŒWindows Linuxå­ç³»ç»Ÿï¼ˆWSLï¼‰å‘å‰è¿ˆå‡ºäº†ä¸€å¤§æ­¥ã€‚ å®ƒå…è®¸æ‚¨ä»...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>æˆ‘ä»¬ä½¿ç”¨PowerShellå’ŒWSLåœ¨Windowsä¸­é›†æˆLinuxå‘½ä»¤</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/469257/"> Windowså¼€å‘äººå‘˜ç»å¸¸é‡åˆ°çš„ä¸€ä¸ªé—®é¢˜ï¼šâ€œä¸ºä»€ä¹ˆåœ¨è¿™é‡Œ<code>&lt;    LINUX&gt;</code>ä»ç„¶æ²¡æœ‰ï¼Ÿâ€ã€‚ æ— è®ºæ˜¯åŠŸèƒ½å¼ºå¤§çš„<code>less</code>æ»šåŠ¨åŠŸèƒ½è¿˜æ˜¯å¸¸ç”¨çš„<code>grep</code>æˆ–<code>sed</code>å·¥å…·ï¼ŒWindowså¼€å‘äººå‘˜éƒ½å¸Œæœ›åœ¨æ—¥å¸¸å·¥ä½œä¸­è½»æ¾è®¿é—®è¿™äº›å‘½ä»¤ã€‚ <br><br> åœ¨è¿™æ–¹é¢<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ï¼ŒWindows Linuxå­ç³»ç»Ÿï¼ˆWSLï¼‰</a>å‘å‰è¿ˆå‡ºäº†ä¸€å¤§æ­¥ã€‚ å®ƒå…è®¸æ‚¨ä»Windowsè°ƒç”¨Linuxå‘½ä»¤ï¼Œå¹¶é€šè¿‡<code>wsl.exe</code> ï¼ˆä¾‹å¦‚<code>wsl ls</code> ï¼‰å¯¹å®ƒä»¬è¿›è¡Œ<code>wsl.exe</code> ã€‚ å°½ç®¡è¿™æ˜¯ä¸€ä¸ªé‡å¤§çš„æ”¹è¿›ï¼Œä½†æ˜¯æ­¤é€‰é¡¹æœ‰è®¸å¤šç¼ºç‚¹ã€‚ <br><a name="habracut"></a><br><ul><li>  <code>wsl</code>çš„æ™®éæ·»åŠ å¾ˆç´¯ï¼Œè€Œä¸”ä¸è‡ªç„¶ã€‚ <br></li><li> å‚æ•°ä¸­çš„Windowsè·¯å¾„å¹¶éå§‹ç»ˆæœ‰æ•ˆï¼Œå› ä¸ºåæ–œæ è¢«è§£é‡Šä¸ºè½¬ä¹‰ç¬¦ï¼Œè€Œä¸æ˜¯ç›®å½•åˆ†éš”ç¬¦ã€‚ <br></li><li> å‚æ•°ä¸­çš„Windowsè·¯å¾„ä¸ä¼šè½¬æ¢ä¸ºWSLä¸­çš„ç›¸åº”å®‰è£…ç‚¹ã€‚ <br></li><li>  WSLæ¦‚è¦æ–‡ä»¶ä¸­å¸¦æœ‰åˆ«åå’Œç¯å¢ƒå˜é‡çš„é»˜è®¤è®¾ç½®æœªè€ƒè™‘åœ¨å†…ã€‚ <br></li><li> ä¸æ”¯æŒLinuxè·¯å¾„å®Œæˆã€‚ <br></li><li> ä¸æ”¯æŒå‘½ä»¤å®Œæˆã€‚ <br></li><li> ä¸æ”¯æŒå‚æ•°å®Œæˆã€‚ </li></ul><br> ç»“æœï¼ŒLinuxå‘½ä»¤åœ¨Windowsä¸‹è¢«è§†ä¸ºäºŒç­‰å…¬æ°‘-ä¸æœ¬åœ°å›¢é˜Ÿç›¸æ¯”ï¼Œå®ƒä»¬æ›´éš¾ä½¿ç”¨ã€‚ ä¸ºäº†ä½¿ä»–ä»¬çš„æƒåˆ©å¹³ç­‰ï¼Œæ‚¨éœ€è¦è§£å†³è¿™äº›é—®é¢˜ã€‚ <br><br><h1>  PowerShellå¤–å£³ </h1><br> ä½¿ç”¨PowerShellå‡½æ•°åŒ…è£…å™¨ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å°†Windowsè·¯å¾„è½¬æ¢ä¸ºWSLè·¯å¾„æ¥æ·»åŠ å‘½ä»¤å®ŒæˆåŠŸèƒ½å¹¶æ¶ˆé™¤å¯¹<code>wsl</code>å‰ç¼€çš„éœ€è¦ã€‚ å¤–å£³çš„åŸºæœ¬è¦æ±‚ï¼š <br><br><ul><li> æ¯ä¸ªLinuxå‘½ä»¤å¿…é¡»å…·æœ‰ä¸€ä¸ªå…·æœ‰ç›¸åŒåç§°çš„å‡½æ•°å¤–å£³ã€‚ <br></li><li> å¤–å£³ç¨‹åºå¿…é¡»è¯†åˆ«ä½œä¸ºå‚æ•°ä¼ é€’çš„Windowsè·¯å¾„ï¼Œå¹¶å°†å…¶è½¬æ¢ä¸ºWSLè·¯å¾„ã€‚ <br></li><li> å¤–å£³ç¨‹åºåº”ä½¿ç”¨é€‚å½“çš„Linuxå‘½ä»¤å¯¹ä»»ä½•ç®¡é“è¾“å…¥è°ƒç”¨<code>wsl</code> ï¼Œå¹¶å°†ä¼ é€’ç»™å‡½æ•°çš„ä»»ä½•å‘½ä»¤è¡Œå‚æ•°ä¼ é€’ç»™è¯¥å‡½æ•°ã€‚ </li></ul><br> ç”±äºæ­¤æ¨¡æ¿å¯ä»¥åº”ç”¨äºä»»ä½•å‘½ä»¤ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥æŠ½è±¡åŒ–è¿™äº›shellçš„å®šä¹‰ï¼Œå¹¶ä»è¦å¯¼å…¥çš„å‘½ä»¤åˆ—è¡¨ä¸­åŠ¨æ€ç”Ÿæˆå®ƒä»¬ã€‚ <br><br><pre> <code class="plaintext hljs"># The commands to import. $commands = "awk", "emacs", "grep", "head", "less", "ls", "man", "sed", "seq", "ssh", "tail", "vim" # Register a function for each command. $commands | ForEach-Object { Invoke-Expression @" Remove-Alias $_ -Force -ErrorAction Ignore function global:$_() { for (`$i = 0; `$i -lt `$args.Count; `$i++) { # If a path is absolute with a qualifier (eg C:), run it through wslpath to map it to the appropriate mount point. if (Split-Path `$args[`$i] -IsAbsolute -ErrorAction Ignore) { `$args[`$i] = Format-WslArgument (wsl.exe wslpath (`$args[`$i] -replace "\\", "/")) # If a path is relative, the current working directory will be translated to an appropriate mount point, so just format it. } elseif (Test-Path `$args[`$i] -ErrorAction Ignore) { `$args[`$i] = Format-WslArgument (`$args[`$i] -replace "\\", "/") } } if (`$input.MoveNext()) { `$input.Reset() `$input | wsl.exe $_ (`$args -split ' ') } else { wsl.exe $_ (`$args -split ' ') } } "@ }</code> </pre> <br>  <code>$command</code>åˆ—è¡¨å®šä¹‰è¦å¯¼å…¥çš„å‘½ä»¤ã€‚ ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨<code>Invoke-Expression</code>å‘½ä»¤ä¸ºå®ƒä»¬ä¸­çš„æ¯ä¸€ä¸ªåŠ¨æ€ç”Ÿæˆä¸€ä¸ªå‡½æ•°åŒ…è£…å™¨ï¼ˆé¦–å…ˆåˆ é™¤å°†ä¸è¯¥å‡½æ•°å†²çªçš„ä»»ä½•åˆ«åï¼‰ã€‚ <br><br> è¯¥å‡½æ•°éå†å‘½ä»¤è¡Œå‚æ•°ï¼Œä½¿ç”¨<code>Split-Path</code>å’Œ<code>Test-Path</code>å‘½ä»¤ç¡®å®šWindowsè·¯å¾„ï¼Œç„¶åå°†è¿™äº›è·¯å¾„è½¬æ¢ä¸ºWSLè·¯å¾„ã€‚ æˆ‘ä»¬é€šè¿‡å¸®åŠ©å‡½æ•°<code>Format-WslArgument</code>æ¥è¿è¡Œè·¯å¾„ï¼Œç¨åå°†å¯¹å…¶è¿›è¡Œå®šä¹‰ã€‚ å®ƒè½¬ä¹‰äº†ç‰¹æ®Šå­—ç¬¦ï¼Œä¾‹å¦‚ç©ºæ ¼å’Œæ–¹æ‹¬å·ï¼Œå¦åˆ™ä¼šè¢«è¯¯è§£ã€‚ <br><br> æœ€åï¼Œæˆ‘ä»¬å°†<code>wsl</code>è¾“å…¥å’Œä»»ä½•å‘½ä»¤è¡Œå‚æ•°ä¼ é€’ç»™<code>wsl</code> ã€‚ <br><br> ä½¿ç”¨è¿™äº›åŒ…è£…å™¨ï¼Œæ‚¨å¯ä»¥æ›´è‡ªç„¶çš„æ–¹å¼è°ƒç”¨è‡ªå·±å–œæ¬¢çš„Linuxå‘½ä»¤ï¼Œè€Œæ— éœ€æ·»åŠ <code>wsl</code>å‰ç¼€ï¼Œä¹Ÿä¸å¿…æ‹…å¿ƒè·¯å¾„å¦‚ä½•è½¬æ¢ï¼š <br><br><ul><li> <code>man bash</code> <br> </li><li> <code>less -i $profile.CurrentUserAllHosts</code> <br> </li><li> <code>ls -Al C:\Windows\ | less</code> <br> </li><li> <code>grep -Ein error *.log</code> <br> </li><li> <code>tail -f *.log</code> </li> </ul><br> åŸºæœ¬çš„å‘½ä»¤é›†æ˜¾ç¤ºåœ¨è¿™é‡Œï¼Œä½†æ˜¯æ‚¨å¯ä»¥é€šè¿‡å°†ä»»ä½•Linuxå‘½ä»¤æ·»åŠ åˆ°åˆ—è¡¨ä¸­æ¥ä¸ºä»»ä½•Linuxå‘½ä»¤åˆ›å»ºä¸€ä¸ªshellã€‚ å¦‚æœå°†æ­¤ä»£ç æ·»åŠ åˆ°PowerShell <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">é…ç½®æ–‡ä»¶ä¸­</a> ï¼Œè¿™äº›å‘½ä»¤å°†åœ¨æ¯ä¸ªPowerShellä¼šè¯ä¸­å¯¹æ‚¨å¯ç”¨ï¼Œæœ¬æœºå‘½ä»¤ä¹Ÿå°†å¯ç”¨ï¼ <br><br><h1> é»˜è®¤é€‰é¡¹ </h1><br> åœ¨Linuxä¸Šï¼Œä¹ æƒ¯ä¸Šåœ¨é…ç½®æ–‡ä»¶ï¼ˆç™»å½•é…ç½®æ–‡ä»¶ï¼‰ä¸­å®šä¹‰åˆ«åå’Œ/æˆ–ç¯å¢ƒå˜é‡ï¼Œä¸ºå¸¸ç”¨å‘½ä»¤è®¾ç½®é»˜è®¤å‚æ•°ï¼ˆä¾‹å¦‚ï¼Œ <code>alias ls=ls -AFh</code>æˆ–<code>export LESS=-i</code> ï¼‰ã€‚ é€šè¿‡éäº¤äº’å¼<code>wsl.exe</code> shellè¿›è¡Œä»£ç†çš„ç¼ºç‚¹ä¹‹ä¸€æ˜¯æœªåŠ è½½é…ç½®æ–‡ä»¶ï¼Œå› æ­¤é»˜è®¤æƒ…å†µä¸‹è¿™äº›é€‰é¡¹ä¸å¯ç”¨ï¼ˆå³ï¼ŒWSLä¸­çš„<code>wsl ls</code>å’Œ<code>wsl ls</code>è¡Œä¸ºä¸ä¸Šé¢å®šä¹‰çš„åˆ«åä¸åŒï¼‰ã€‚ <br><br>  PowerShellæä¾›äº†<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">$ PSDefaultParameterValues</a> ï¼Œè¿™æ˜¯ç”¨äºå®šä¹‰é»˜è®¤å‚æ•°çš„æ ‡å‡†æœºåˆ¶ï¼Œä½†ä»…é€‚ç”¨äºcmdletå’Œé«˜çº§åŠŸèƒ½ã€‚ å½“ç„¶ï¼Œæ‚¨å¯ä»¥ä»æˆ‘ä»¬çš„Shellä¸­æ‰§è¡Œé«˜çº§åŠŸèƒ½ï¼Œä½†è¿™ä¼šå¸¦æ¥ä¸å¿…è¦çš„å¤æ‚æ€§ï¼ˆä¾‹å¦‚ï¼ŒPowerShellåŒ¹é…éƒ¨åˆ†å‚æ•°åç§°ï¼ˆä¾‹å¦‚ï¼Œ <code>-a</code>å¯¹åº”äº<code>-ArgumentList</code> ï¼‰ï¼Œè¿™å°†ä¸æ¥å—éƒ¨åˆ†åç§°ä½œä¸ºå‚æ•°çš„Linuxå‘½ä»¤å†²çªï¼‰ï¼Œå¹¶ä¸”å®šä¹‰é»˜è®¤å€¼çš„è¯­æ³•å°†ä¸æ˜¯æœ€åˆé€‚çš„ï¼ˆå¯¹äºå®šä¹‰é»˜è®¤å‚æ•°ï¼Œé”®ä¸­çš„å‚æ•°åç§°æ˜¯å¿…éœ€çš„ï¼Œè€Œä¸ä»…ä»…æ˜¯å‘½ä»¤åç§°ï¼‰ã€‚ <br><br> ä½†æ˜¯ï¼Œåªè¦å¯¹æˆ‘ä»¬çš„shellç¨åŠ ä¿®æ”¹ï¼Œæˆ‘ä»¬å°±å¯ä»¥å®ç°ç±»ä¼¼äº<code>$PSDefaultParameterValues</code>çš„æ¨¡å‹ï¼Œå¹¶ä¸ºLinuxå‘½ä»¤å¯ç”¨é»˜è®¤é€‰é¡¹ï¼ <br><br><pre> <code class="plaintext hljs">function global:$_() { â€¦ `$defaultArgs = ((`$WslDefaultParameterValues.$_ -split ' '), "")[`$WslDefaultParameterValues.Disabled -eq `$true] if (`$input.MoveNext()) { `$input.Reset() `$input | wsl.exe $_ `$defaultArgs (`$args -split ' ') } else { wsl.exe $_ `$defaultArgs (`$args -split ' ') } }</code> </pre> <br> é€šè¿‡<code>$WslDefaultParameterValues</code>åˆ°å‘½ä»¤è¡Œï¼Œæˆ‘ä»¬é€šè¿‡<code>wsl.exe</code>å‘é€å‚æ•°ã€‚ ä¸‹é¢æ˜¾ç¤ºäº†å¦‚ä½•å‘PowerShellé…ç½®æ–‡ä»¶æ·»åŠ æŒ‡ä»¤ä»¥é…ç½®é»˜è®¤è®¾ç½®ã€‚ ç°åœ¨æˆ‘ä»¬å¯ä»¥åšåˆ°ï¼ <br><br><pre> <code class="plaintext hljs">$WslDefaultParameterValues["grep"] = "-E" $WslDefaultParameterValues["less"] = "-i" $WslDefaultParameterValues["ls"] = "-AFh --group-directories-first"</code> </pre> <br> ç”±äºå‚æ•°æ˜¯åœ¨<code>$PSDefaultParameterValues</code>ä¹‹åå»ºæ¨¡çš„ï¼Œå› æ­¤å¯ä»¥é€šè¿‡å°†<code>"Disabled"</code>é”®è®¾ç½®ä¸º<code>$true</code> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è½»æ¾åœ°</a>æš‚æ—¶<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å°†å…¶å…³é—­</a> ã€‚ å•ç‹¬çš„å“ˆå¸Œè¡¨çš„å¦ä¸€ä¸ªä¼˜ç‚¹æ˜¯èƒ½å¤Ÿä¸<code>$WslDefaultParameterValues</code>åˆ†åˆ«ç¦ç”¨<code>$PSDefaultParameterValues</code> ã€‚ <br><br><h1> å‚æ•°å®Œæˆ </h1><br>  PowerShellå…è®¸ä½¿ç”¨<code>Register-ArgumentCompleter</code>å‘½ä»¤æ³¨å†Œå‚æ•°ç»ˆæ­¢ç¬¦ã€‚  Bashå…·æœ‰åŠŸèƒ½å¼ºå¤§çš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å¯ç¼–ç¨‹å®Œæˆå·¥å…·</a> ã€‚  WSLå…è®¸æ‚¨ä»PowerShellè°ƒç”¨bashã€‚ å¦‚æœæˆ‘ä»¬å¯ä»¥ä¸ºPowerShellå‡½æ•°åŒ…è£…å™¨æ³¨å†Œå‚æ•°ç»ˆæ­¢ç¬¦å¹¶è°ƒç”¨bashæ¥åˆ›å»ºç»ˆæ­¢ç¬¦ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°†ä»¥ä¸bashæœ¬èº«ç›¸åŒçš„ç²¾åº¦è·å¾—å‚æ•°çš„å®Œæ•´å®Œæˆï¼ <br><br><pre> <code class="plaintext hljs"># Register an ArgumentCompleter that shims bash's programmable completion. Register-ArgumentCompleter -CommandName $commands -ScriptBlock { param($wordToComplete, $commandAst, $cursorPosition) # Map the command to the appropriate bash completion function. $F = switch ($commandAst.CommandElements[0].Value) { {$_ -in "awk", "grep", "head", "less", "ls", "sed", "seq", "tail"} { "_longopt" break } "man" { "_man" break } "ssh" { "_ssh" break } Default { "_minimal" break } } # Populate bash programmable completion variables. $COMP_LINE = "`"$commandAst`"" $COMP_WORDS = "('$($commandAst.CommandElements.Extent.Text -join "' '")')" -replace "''", "'" for ($i = 1; $i -lt $commandAst.CommandElements.Count; $i++) { $extent = $commandAst.CommandElements[$i].Extent if ($cursorPosition -lt $extent.EndColumnNumber) { # The cursor is in the middle of a word to complete. $previousWord = $commandAst.CommandElements[$i - 1].Extent.Text $COMP_CWORD = $i break } elseif ($cursorPosition -eq $extent.EndColumnNumber) { # The cursor is immediately after the current word. $previousWord = $extent.Text $COMP_CWORD = $i + 1 break } elseif ($cursorPosition -lt $extent.StartColumnNumber) { # The cursor is within whitespace between the previous and current words. $previousWord = $commandAst.CommandElements[$i - 1].Extent.Text $COMP_CWORD = $i break } elseif ($i -eq $commandAst.CommandElements.Count - 1 -and $cursorPosition -gt $extent.EndColumnNumber) { # The cursor is within whitespace at the end of the line. $previousWord = $extent.Text $COMP_CWORD = $i + 1 break } } # Repopulate bash programmable completion variables for scenarios like '/mnt/c/Program Files'/&lt;TAB&gt; where &lt;TAB&gt; should continue completing the quoted path. $currentExtent = $commandAst.CommandElements[$COMP_CWORD].Extent $previousExtent = $commandAst.CommandElements[$COMP_CWORD - 1].Extent if ($currentExtent.Text -like "/*" -and $currentExtent.StartColumnNumber -eq $previousExtent.EndColumnNumber) { $COMP_LINE = $COMP_LINE -replace "$($previousExtent.Text)$($currentExtent.Text)", $wordToComplete $COMP_WORDS = $COMP_WORDS -replace "$($previousExtent.Text) '$($currentExtent.Text)'", $wordToComplete $previousWord = $commandAst.CommandElements[$COMP_CWORD - 2].Extent.Text $COMP_CWORD -= 1 } # Build the command to pass to WSL. $command = $commandAst.CommandElements[0].Value $bashCompletion = ". /usr/share/bash-completion/bash_completion 2&gt; /dev/null" $commandCompletion = ". /usr/share/bash-completion/completions/$command 2&gt; /dev/null" $COMPINPUT = "COMP_LINE=$COMP_LINE; COMP_WORDS=$COMP_WORDS; COMP_CWORD=$COMP_CWORD; COMP_POINT=$cursorPosition" $COMPGEN = "bind `"set completion-ignore-case on`" 2&gt; /dev/null; $F `"$command`" `"$wordToComplete`" `"$previousWord`" 2&gt; /dev/null" $COMPREPLY = "IFS=`$'\n'; echo `"`${COMPREPLY[*]}`"" $commandLine = "$bashCompletion; $commandCompletion; $COMPINPUT; $COMPGEN; $COMPREPLY" -split ' ' # Invoke bash completion and return CompletionResults. $previousCompletionText = "" (wsl.exe $commandLine) -split '\n' | Sort-Object -Unique -CaseSensitive | ForEach-Object { if ($wordToComplete -match "(.*=).*") { $completionText = Format-WslArgument ($Matches[1] + $_) $true $listItemText = $_ } else { $completionText = Format-WslArgument $_ $true $listItemText = $completionText } if ($completionText -eq $previousCompletionText) { # Differentiate completions that differ only by case otherwise PowerShell will view them as duplicate. $listItemText += ' ' } $previousCompletionText = $completionText [System.Management.Automation.CompletionResult]::new($completionText, $listItemText, 'ParameterName', $completionText) } } # Helper function to escape characters in arguments passed to WSL that would otherwise be misinterpreted. function global:Format-WslArgument([string]$arg, [bool]$interactive) { if ($interactive -and $arg.Contains(" ")) { return "'$arg'" } else { return ($arg -replace " ", "\ ") -replace "([()|])", ('\$1', '`$1')[$interactive] } }</code> </pre> <br> åœ¨ä¸äº†è§£æŸäº›bashå†…éƒ¨åŸç†çš„æƒ…å†µä¸‹ï¼Œä»£ç æœ‰äº›ç´§ï¼Œä½†æ˜¯åŸºæœ¬ä¸Šï¼Œæˆ‘ä»¬æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š <br><br><ul><li> é€šè¿‡å°†<code>$commands</code>åˆ—è¡¨ä¼ é€’ç»™<code>Register-ArgumentCompleter</code>çš„<code>-CommandName</code>å‚æ•°ï¼Œæˆ‘ä»¬ä¸ºæ‰€æœ‰å‡½æ•°åŒ…è£…å™¨æ³¨å†Œå‚æ•°ç»ˆç»“å™¨ã€‚ <br></li><li> æˆ‘ä»¬å°†æ¯ä¸ªå‘½ä»¤æ˜ å°„åˆ°bashç”¨äºè‡ªåŠ¨å®Œæˆçš„shellå‡½æ•°ï¼ˆbashä½¿ç”¨<code>$F</code>å®šä¹‰è‡ªåŠ¨å®Œæˆè§„èŒƒï¼Œæ˜¯<code>complete -F &lt;FUNCTION&gt;</code>ç¼©å†™ï¼‰ã€‚ <br></li><li> æ ¹æ®bash <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å¯ç¼–ç¨‹å®Œæˆ</a>è§„èŒƒï¼Œå°†PowerShellå‚æ•°<code>$wordToComplete</code> ï¼Œ <code>$commandAst</code>å’Œ<code>$cursorPosition</code>è½¬æ¢ä¸ºbashå®Œæˆå‡½æ•°æœŸæœ›çš„æ ¼å¼ã€‚ <br></li><li> æˆ‘ä»¬<code>wsl.exe</code>ç”¨äºä¼ è¾“åˆ°<code>wsl.exe</code>çš„å‘½ä»¤è¡Œï¼Œä»¥ç¡®ä¿æ­£ç¡®çš„ç¯å¢ƒè®¾ç½®ï¼Œè°ƒç”¨é€‚å½“çš„è‡ªåŠ¨å®ŒæˆåŠŸèƒ½å¹¶æ˜¾ç¤ºå¸¦æœ‰æ¢è¡Œç¬¦çš„ç»“æœã€‚ <br></li><li> ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨å‘½ä»¤è¡Œè°ƒç”¨<code>wsl</code> ï¼Œç”¨è¡Œåˆ†éš”ç¬¦åˆ†éš”è¾“å‡ºï¼Œå¹¶ä¸ºæ¯ä¸ªåˆ†éš”ç¬¦ç”Ÿæˆ<code>CompletionResults</code> ï¼Œå¯¹å®ƒä»¬è¿›è¡Œæ’åºï¼Œå¹¶è½¬ä¹‰è¯¸å¦‚ç©ºæ ¼å’Œæ–¹æ‹¬å·ä¹‹ç±»çš„å­—ç¬¦ï¼Œå¦åˆ™è¿™äº›å­—ç¬¦å°†è¢«è¯¯è§£ã€‚ </li></ul><br> ç»“æœï¼Œæˆ‘ä»¬çš„Linuxå‘½ä»¤å¤–å£³å°†ä½¿ç”¨ä¸bashä¸­å®Œå…¨ç›¸åŒçš„è‡ªåŠ¨å®ŒæˆåŠŸèƒ½ï¼ ä¾‹å¦‚ï¼š <br><br><ul><li> <code>ssh -c &lt;TAB&gt; -J &lt;TAB&gt; -m &lt;TAB&gt; -O &lt;TAB&gt; -o &lt;TAB&gt; -Q &lt;TAB&gt; -w &lt;TAB&gt; -b &lt;TAB&gt;</code> </li> </ul><br> æ¯ä¸ªè‡ªåŠ¨è¡¥å…¨éƒ½æä¾›ç‰¹å®šäºå‰ä¸€ä¸ªå‚æ•°çš„å€¼ï¼Œä»WSLä¸­è¯»å–é…ç½®æ•°æ®ï¼Œä¾‹å¦‚å·²çŸ¥ä¸»æœºï¼ <br><br>  <code>&lt;TAB&gt;</code>å°†å¾ªç¯æ˜¾ç¤ºå‚æ•°ã€‚  <code>&lt;Ctrl + &gt;</code>å°†æ˜¾ç¤ºæ‰€æœ‰å¯ç”¨é€‰é¡¹ã€‚ <br><br> å¦å¤–ï¼Œç”±äºbashè‡ªåŠ¨å®Œæˆç°åœ¨å¯ä»¥ä¸æˆ‘ä»¬ä¸€èµ·ä½¿ç”¨ï¼Œå› æ­¤æ‚¨å¯ä»¥ç›´æ¥åœ¨PowerShellä¸­è‡ªåŠ¨å®ŒæˆLinuxè·¯å¾„ï¼ <br><br><ul><li> <code>less /etc/&lt;TAB&gt;</code> <br> </li><li> <code>ls /usr/share/&lt;TAB&gt;</code> <br> </li><li> <code>vim ~/.bash&lt;TAB&gt;</code> </li> </ul><br> å¦‚æœbashè‡ªåŠ¨è¡¥å…¨å¤±è´¥ï¼ŒPowerShellå°†æ¢å¤ä¸ºå…·æœ‰Windowsè·¯å¾„çš„é»˜è®¤ç³»ç»Ÿã€‚ å› æ­¤ï¼Œå®é™…ä¸Šï¼Œæ‚¨å¯ä»¥æ ¹æ®è‡ªå·±çš„åˆ¤æ–­åŒæ—¶ä½¿ç”¨è¿™äº›æ–¹å¼å’Œå…¶ä»–æ–¹å¼ã€‚ <br><br><h1> ç»“è®º </h1><br> ä½¿ç”¨PowerShellå’ŒWSLï¼Œæˆ‘ä»¬å¯ä»¥å°†Linuxå‘½ä»¤ä½œä¸ºæœ¬æœºåº”ç”¨ç¨‹åºé›†æˆåˆ°Windowsä¸­ã€‚ æ— éœ€å¯»æ‰¾Win32æ„å»ºæˆ–Linuxå®ç”¨ç¨‹åºï¼Œä¹Ÿæ— éœ€é€šè¿‡åˆ‡æ¢åˆ°Linux Shellæ¥ä¸­æ–­å·¥ä½œæµç¨‹ã€‚ åªéœ€<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å®‰è£…WSL</a> ï¼Œé…ç½®<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">PowerShellé…ç½®æ–‡ä»¶</a>å¹¶<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åˆ—å‡ºè¦å¯¼å…¥çš„å‘½ä»¤</a> ï¼  Linuxå’ŒWindowsæ–‡ä»¶çš„å‘½ä»¤å’Œè·¯å¾„å‚æ•°ä¸°å¯Œçš„è‡ªåŠ¨è¡¥å…¨åŠŸèƒ½æ˜¯å½“ä»Šæœ¬æœºWindowså‘½ä»¤ç”šè‡³éƒ½æ²¡æœ‰çš„åŠŸèƒ½ã€‚ <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ­¤å¤„</a>æä¾›<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">äº†</a>ä¸Šè¿°å®Œæ•´æºä»£ç ä»¥åŠå°†å…¶åŒ…æ‹¬åœ¨å·¥ä½œæµç¨‹ä¸­çš„å…¶ä»–å»ºè®®ã€‚ <br><br> æ‚¨å‘ç°å“ªä¸ªLinuxå‘½ä»¤æœ€æœ‰ç”¨ï¼Ÿ åœ¨Windowsä¸Šå·¥ä½œæ—¶ï¼Œè¿˜ç¼ºå°‘å“ªäº›å…¶ä»–ç†Ÿæ‚‰çš„ä¸œè¥¿ï¼Ÿ å†™è¯„è®ºæˆ–<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åœ¨GitHubä¸Š</a> ï¼ </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN469257/">https://habr.com/ru/post/zh-CN469257/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN469235/index.html">æˆ´ä¸Šæ–°é¢å…·çš„Troldeshï¼šå‹’ç´¢è½¯ä»¶ç—…æ¯’çš„ä¸‹ä¸€æ³¢å¤§è§„æ¨¡ä¼ æ’­</a></li>
<li><a href="../zh-CN469237/index.html">Androidä»£ç è½¬æ¢</a></li>
<li><a href="../zh-CN469245/index.html">å†¬è‡³æå‡ºå°ç»„é¡¹ç›®çš„æ„æƒ³ï¼Œä»¥ä»æˆ¿å±‹çš„å±‹é¡¶è·å–å¤ªé˜³èƒ½</a></li>
<li><a href="../zh-CN469249/index.html">Nitterï¼ŒTwitterçš„æ›¿ä»£å‰ç«¯</a></li>
<li><a href="../zh-CN469253/index.html">åº”ç”¨ç¨‹å¼å»ºç«‹æˆæœ¬</a></li>
<li><a href="../zh-CN469259/index.html">æ°”å€™å˜åŒ–ï¼šæˆ‘ä»¬åˆ†æäº†è¿‡å»100å¹´ä¸­ä¸åŒåŸå¸‚çš„æ¸©åº¦</a></li>
<li><a href="../zh-CN469263/index.html">ä¸ºä»€ä¹ˆå“ˆå¸ƒé›·çš„ä¸šåŠ›å¥½ï¼Ÿ</a></li>
<li><a href="../zh-CN469265/index.html">é€šè¿‡RESTè¿›è¡Œå¤šå¤„ç†Intelç¥ç»è®¡ç®—æœºæ£’è®¿é—®</a></li>
<li><a href="../zh-CN469267/index.html">ä½¿ç”¨LD_PRELOADå’Œå•ä¸ªå…¥å£ç‚¹å¤„ç†ç³»ç»Ÿè°ƒç”¨</a></li>
<li><a href="../zh-CN469271/index.html">åºåˆ—åŒ–å’Œååºåˆ—åŒ–.NET Coreä¸Go Data</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>