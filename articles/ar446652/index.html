<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐๐ฟ ๐ ๐จ๐พโ๐ฌ MVCC-4. ููุทุงุช ุงูุจูุงูุงุช ๐ฉโ๐ค ๐ป ๐</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ุจุนุฏ ูุญุต ุงููุดููุงุช ุงููุชุนููุฉ ุจุงูุนุฒูุฉ ุ ูุงุณุชูุจุงุท ุชูุธูู ุงูุจูุงูุงุช ุจูุณุชูู ููุฎูุถ ุ ูุงูุช ุขุฎุฑ ูุฑุฉ ุชุญุฏุซูุง ูููุง ุจุงูุชูุตูู ุนู ุฅุตุฏุงุฑุงุช ุงูุตู ูุชุชุจุนุช ููู ุชุบูุฑุช ูุนูููุงุช ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>MVCC-4. ููุทุงุช ุงูุจูุงูุงุช</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/postgrespro/blog/446652/" style=";text-align:right;direction:rtl">  ุจุนุฏ ูุญุต ุงููุดููุงุช ุงููุชุนููุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุจุงูุนุฒูุฉ</a> ุ ูุงุณุชูุจุงุท <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุชูุธูู ุงูุจูุงูุงุช ุจูุณุชูู ููุฎูุถ</a> ุ ูุงูุช ุขุฎุฑ ูุฑุฉ ุชุญุฏุซูุง ูููุง ุจุงูุชูุตูู ุนู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฅุตุฏุงุฑุงุช ุงูุตู</a> ูุชุชุจุนุช ููู ุชุบูุฑุช ูุนูููุงุช ุงูุฎุฏูุฉ ูู ุฑุฃุณ ุงูุฅุตุฏุงุฑ ุฃุซูุงุก ุงูุนูููุงุช ุงููุฎุชููุฉ. <br><br>  ููุธุฑ ุงูููู ุฅูู ููููุฉ ุงูุญุตูู ุนูู ุฅุตุฏุงุฑุงุช ูุชุณูุฉ ูู ุงูุจูุงูุงุช ูู ุฅุตุฏุงุฑุงุช ุงูุตููู. <br><br><h1 style=";text-align:right;direction:rtl">  ูุง ูู ููุทุฉ ุงูุจูุงูุงุช </h1><br>  ูุนูููุง ุ ูุฏ ุชุญุชูู ุตูุญุงุช ุงูุจูุงูุงุช ุนูู ุนุฏุฉ ุฅุตุฏุงุฑุงุช ูู ููุณ ุงูุตู.  ุนูุงูุฉ ุนูู ุฐูู ุ ูุฌุจ ุฃู ุชุฑู ูู ูุนุงููุฉ ุฅุตุฏุงุฑูุง ูุงุญุฏูุง ููุท (ุฃู ูุง ุดูุก) ูู ูู ุตู ุจุญูุซ ุชุดูู ูุนูุง ุตูุฑุฉ ูุชุณูุฉ ูุน ACID ููุจูุงูุงุช ูู ููุช ูุนูู. <br><br>  ุชู ุจูุงุก ุงูุนุฒู ูู PostgreSQL ุนูู ุฃุณุงุณ ุงูููุทุงุช: ุชุนูู ูู ูุนุงููุฉ ูุน ููุทุฉ ุงูุจูุงูุงุช ุงูุฎุงุตุฉ ุจูุง ุ ูุงูุชู "ุชุญุชูู" ุนูู ุงูุจูุงูุงุช ุงูุชู ุชู ุชุณุฌูููุง ูุจู ุฅูุดุงุก ุงูููุทุฉ ููุง "ุชุญุชูู" ุนูู ุงูุจูุงูุงุช ุงูุชู ูู ูุชู ุฅุตูุงุญูุง ุญุชู ุงูุขู.  ููุฏ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฑุฃููุง ุจุงููุนู</a> ุฃู ุงูุนุฒูุฉ ูู ูุฐู ุงูุญุงูุฉ ุฃูุซุฑ ุตุฑุงูุฉ ููุง ูุชุทูุจู ุงููุนูุงุฑ ุ ูููู ููุณ ูู ุฏูู ุญุงูุงุช ุดุงุฐุฉ. <br><a name="habracut"></a><br>  ุนูู ูุณุชูู ุงูุนุฒู ูุฑุงุกุฉ ููุชุฒู ุ ูุชู ุฅูุดุงุก ููุทุฉ ูู ุจุฏุงูุฉ ูู ุนุจุงุฑุฉ ุงููุนุงููุฉ.  ูุฐู ุงูููุทุฉ ูุดุทุฉ ุฃุซูุงุก ุชูููุฐ ุงูุจูุงู.  ูู ุงูุดูู ุ ุชุธูุฑ ูุญุธุฉ ุฅูุดุงุก ุงูููุทุฉ (ุงูุชู ุ ููุง ูุฐูุฑ ุ ูุญุฏุฏูุง ุฑูู ุงููุนุงููุฉ) ุจุงูููู ุงูุฃุฒุฑู. <br><br><img src="https://habrastorage.org/webt/5g/nz/nj/5gnznjhyp869w4ls01o0wy5kxlo.png"><br><br>  ุนูุฏ ูุณุชููุงุช ุงููุฑุงุกุฉ ุงููุงุจูุฉ ููุชูุฑุงุฑ ูุงููุงุจูุฉ ููุชุณูุณู ุ ูุชู ุฅูุดุงุก ููุทุฉ ูุฑุฉ ูุงุญุฏุฉ ูู ุจุฏุงูุฉ ุจูุงู ุงููุนุงููุฉ ุงูุฃูู.  ุชุจูู ูุฐู ุงูููุทุฉ ูุดุทุฉ ุญุชู ููุงูุฉ ุงููุนุงููุฉ. <br><br><img src="https://habrastorage.org/webt/ff/dp/17/ffdp17xhiqemal2dj8k6a21ql38.png"><br><br><h1 style=";text-align:right;direction:rtl">  ุฑุคูุฉ ุฅุตุฏุงุฑุงุช ุงูุตู ูู ููุทุฉ </h1><br><h2 style=";text-align:right;direction:rtl">  ููุงุนุฏ ุงูุฑุคูุฉ </h2><br>  ุจุงูุทุจุน ุ ููุทุฉ ููุณุช ูุณุฎุฉ ูุงุฏูุฉ ูุฌููุน ุฅุตุฏุงุฑุงุช ุงูุตู ุงููุทููุจุฉ.  ูู ุงููุงูุน ุ ูุชู ุชุญุฏูุฏ ููุทุฉ ูู ุฎูุงู ุนุฏุฉ ุฃุฑูุงู ุ ููุชู ุชุญุฏูุฏ ูุฏู ูุถูุญ ุฅุตุฏุงุฑุงุช ุงูุตู ูู ุงูููุทุฉ ูู ุฎูุงู ุงูููุงุนุฏ. <br><br>  ูุง ุฅุฐุง ูุงู ูุฐุง ุงูุฅุตุฏุงุฑ ูู ุงูุฎุท ูุฑุฆููุง ูู ุงูููุทุฉ ุฃู ูุง ุ ูุนุชูุฏ ุนูู ุญููู ุฑุฃุณู - xmin ู xmax - ุฃู ุนูู ุนุฏุฏ ุงููุนุงููุงุช ุงูุชู ูุงููุง ุจุฅูุดุงุฆูุง ูุญุฐููุง.  ูุง ุชุชูุงุทุน ูุฐู ุงูููุงุตู ุงูุฒูููุฉ ุ ูุจุงูุชุงูู ุ ูุชู ุชูุซูู ุณุทุฑ ูุงุญุฏ ูู ุฃู ุตูุฑุฉ ุจุญุฏ ุฃูุตู ูุงุญุฏ ูู ุฅุตุฏุงุฑุงุชู. <br><br>  ุงูููุงุนุฏ ุงูุฏูููุฉ ููุฑุคูุฉ ูุนูุฏุฉ ููุบุงูุฉ ูุชุฃุฎุฐ ูู ุงูุงุนุชุจุงุฑ ุงูุนุฏูุฏ ูู ุงูุญุงูุงุช ุงููุฎุชููุฉ ูุงูุญุงูุงุช ุงููุตูู. <br><blockquote style=";text-align:right;direction:rtl">  ูููู ุงูุชุญูู ูู ุฐูู ุจุณูููุฉ ูู ุฎูุงู ุงููุธุฑ ุฅูู src / backend / utils / time / tqual.c (ูู ุงูุฅุตุฏุงุฑ 12 ุ ุชู ููู ุงูุดูู ุฅูู src / backend / access / heap / heapam_visibility.c). <br></blockquote><br>  ูุชุจุณูุท ุ ูููููุง ุฃู ูููู ุฃู ุฅุตุฏุงุฑ ุงูุฎุท ูุฑุฆู ุนูุฏูุง ุชููู ุงูุชุบููุฑุงุช ุงูุชู ุฃุฌุฑุงูุง ูุนุงููุงุช xmin ูุฑุฆูุฉ ูู ุงูุตูุฑุฉ ุ ูุงูุชุบููุฑุงุช ุงูุชู ุชู ุฅุฌุฑุงุคูุง ุจูุงุณุทุฉ ูุนุงููุฉ xmax ุบูุฑ ูุฑุฆูุฉ (ุจูุนูู ุขุฎุฑ ุ ูู ุงููุงุถุญ ุจุงููุนู ุฃู ุฅุตุฏุงุฑ ุงูุฎุท ูุฏ ุธูุฑ ุ ููู ูู ููู ูุฑุฆููุง ุจุนุฏ ุฃู ุชู ุญุฐูู). <br><br>  ูุจุฏูุฑูุง ุ ุชููู ุชุบููุฑุงุช ุงููุนุงููุฉ ูุฑุฆูุฉ ูู ุงูููุทุฉ ุ ุฅุฐุง ูุงูุช ุงููุนุงููุฉ ููุณูุง ูู ุงูุชู ุฃูุฌุฏุช ุงูููุทุฉ ููุณูุง (ุชุฑู ุงูุชุบููุฑุงุช ุงูุฎุงุตุฉ ุจูุง) ุ ุฃู ุชู ุงูุงูุชุฒุงู ุจุงููุนุงููุฉ ูุจู ุฅูุดุงุก ุงูููุทุฉ. <br><br>  ูู ุงููููู ุชุตููุฑ ุงููุนุงููุงุช ุจูุงููุง ูู ุดูู ูุทุงุนุงุช (ูู ุงูุจุฏุงูุฉ ุฅูู ููุช ุงูุงูุชุฒุงู): <br><br><img src="https://habrastorage.org/webt/w2/cq/yr/w2cqyrzhqwmzzenek8ski3mhbzo.png"><br><br>  ููุง: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุณุชููู ุงูุชุบููุฑุงุช ูู ุงููุนุงููุฉ 2 ูุฑุฆูุฉ ูุฃููุง ุงูุชููุช ูุจู ุฅูุดุงุก ุงูููุทุฉ ุ </li><li style=";text-align:right;direction:rtl">  ูู ุชููู ุงูุชุบููุฑุงุช ูู ุงููุนุงููุฉ 1 ูุฑุฆูุฉ ูุฃููุง ูุงูุช ูุดุทุฉ ููุช ุงูุชูุงุท ุงูููุทุฉ ุ </li><li style=";text-align:right;direction:rtl">  ูู ุชููู ุงูุชุบููุฑุงุช ูู ุงููุนุงููุฉ 3 ูุฑุฆูุฉ ูุฃููุง ุจุฏุฃุช ุจุนุฏ ุงูุชูุงุท ุงูููุทุฉ (ูุง ููู ุฅุฐุง ุงูุชูุช ุฃู ูุง). </li></ul><br>  ูุณูุก ุงูุญุธ ุ ูุฅู ูุญุธุฉ ุงุฑุชูุงุจ ุงููุนุงููุงุช ุบูุฑ ูุนุฑููุฉ ูููุธุงู.  ุชุนุฑู ูุญุธุฉ ุจุฏุงูุชูุง ููุท (ูุชู ุชุญุฏูุฏูุง ุจูุงุณุทุฉ ุฑูู ุงููุนุงููุฉ ููุชู ุงูุฅุดุงุฑุฉ ุฅูููุง ุจุฎุท ูุชูุทุน ูู ุงูุฃุดูุงู ุฃุนูุงู) ุ ูููู ุญูููุฉ ุงูุงูุชูุงู ูุง ุชุณุฌู ูู ุฃู ููุงู. <br><br>  ูู ูุง ูููููุง ูุนูู ูู ูุนุฑูุฉ ุงูุญุงูุฉ <em>ุงูุญุงููุฉ</em> ูููุนุงููุงุช ุนูุฏ ุฅูุดุงุก ููุทุฉ.  ุชูุฌุฏ ูุฐู ุงููุนูููุงุช ูู ุงูุฐุงูุฑุฉ ุงููุดุชุฑูุฉ ููุฎุงุฏู ูู ุจููุฉ ProcArray ุ ูุงูุชู ุชุญุชูู ุนูู ูุงุฆูุฉ ุจุฌููุน ุงูุฌูุณุงุช ุงููุดุทุฉ ููุนุงููุงุชูุง. <br><br>  ูุจุนุฏ ุงูุญูููุฉ ุ ูู ูุชููู ุจุนุฏ ุงูุขู ูู ููู ูุง ุฅุฐุง ูุงูุช ุฃู ูุนุงููุฉ ูุดุทุฉ ูู ููุช ุฅูุดุงุก ุงูููุทุฉ ุฃู ูุง.  ูุฐูู ุ ูุฌุจ ุชุฐูุฑ ูุงุฆูุฉ ุจุฌููุน ุงููุนุงููุงุช ุงููุดุทุฉ ุญุงูููุง ูู ุงูุตูุฑุฉ. <br><br>  ูุชุถุญ ููุง ุณุจู ุฃูู ูู PostgreSQL ูุง ููููู ุฅูุดุงุก ููุทุฉ ุชุธูุฑ ุจูุงูุงุช ูุชุณูุฉ ููุฐ ููุช ุชุนุณูู ุ <em>ุญุชู ูู ูุงูุช</em> ุฌููุน ุงูุฅุตุฏุงุฑุงุช ุงูุถุฑูุฑูุฉ ููุตููู ููุฌูุฏุฉ ูู ุตูุญุงุช ุงูุฌุฏูู.  ุบุงูุจูุง ูุง ูุณูุน ุงููุฑุก ุงูุณุคุงู ุนู ุณุจุจ ุนุฏู ูุฌูุฏ ุงุณุชุนุงุฏุงุช (ุฃู ุฒูููุฉ) ุจุฃุซุฑ ุฑุฌุนู ูู ุฃูุฑุงูู ุ ููุทูู ุนูููุง ุงุณุชุนูุงูุงุช flashback) ูู PostgreSQL - ููุฐุง ุฃุญุฏ ุงูุฃุณุจุงุจ. <br><blockquote style=";text-align:right;direction:rtl">  ูู ุงููุถุญู ุฃูู ูู ุงูุจุฏุงูุฉ ูุงูุช ููุงู ูุซู ูุฐู ุงููุธุงุฆู ุ ูููู ุชูุช ุฅุฒุงูุชูุง ูุงุญููุง ูู ูุธุงู ุฅุฏุงุฑุฉ ููุงุนุฏ ุงูุจูุงูุงุช.  ููููู ุฃู ุชูุฑุฃ ุนู ูุฐุง ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุงู ุจููู ุฌูุฒูู ูููุฑุณุชูู</a> . <br></blockquote>  ูุฐูู ุ ูุชู ุชุญุฏูุฏ ููุทุฉ ุงูุจูุงูุงุช ูู ุฎูุงู ุงูุนุฏูุฏ ูู ุงููุนููุงุช: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุญุธุฉ ุฅูุดุงุก ุงูููุทุฉ ุ ุฃู ุฑูู ุงููุนุงููุฉ ุงูุชุงููุฉ ุบูุฑ ุงูููุฌูุฏุฉ ูู ุงููุธุงู ( <strong>snapshot.xmax</strong> ) ุ </li><li style=";text-align:right;direction:rtl">  ูุงุฆูุฉ ุจุงููุนุงููุงุช ุงููุดุทุฉ ูู ููุช ุงูุชูุงุท <strong>ุงูููุทุฉ</strong> ( <strong>snapshot.xip</strong> ). </li></ul><br>  ููุฑุงุญุฉ ูุงูุชุญุณูู ุ ูุชู ุฃูุถูุง ุชุฎุฒูู ุฑูู ุงููุนุงููุฉ ุงููุดุทุฉ ุงูุฃููู ( <strong>snapshot.xmin</strong> ) ุจุดูู ูููุตู.  ูุฐู ุงููููุฉ ููุง ูุนูู ููู ุ ูุงูุชู ุณููุงูุดูุง ุฃุฏูุงู. <br><br>  ุฃูุถูุง ุ ูุชู ุญูุธ ุจุนุถ ุงููุนููุงุช ูู ุงูุตูุฑุฉ ุ ูููููุง ููุณุช ูููุฉ ุจุงููุณุจุฉ ููุง. <br><br><img src="https://habrastorage.org/webt/-r/8v/aa/-r8vaa6fvrltfpd4tjjnv_zxnk4.png"><br><br><h2 style=";text-align:right;direction:rtl">  ูุซุงู </h2><br>  ููุฑู ููู ูุชู ุชุญุฏูุฏ ุงูุฑุคูุฉ ูู ุฎูุงู ุงูููุทุฉ ุ ูุนูุฏ ุฅูุชุงุฌ ุงููููู ูุน ุงููุนุงููุงุช ุงูุซูุงุซ ุงูุชู ูููุดุช ุฃุนูุงู.  ูุญุชูู ุงูุฌุฏูู ุนูู ุซูุงุซุฉ ุตููู ุ ูุน: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุชูุช ุฅุถุงูุฉ ุงูุฃููู ุจูุงุณุทุฉ ูุนุงููุฉ ุจุฏุฃุช ูุจู ุฅูุดุงุก ุงูููุทุฉ ุ ูููููุง ุงูุชูุช ูู ููุช ูุงุญู ุ </li><li style=";text-align:right;direction:rtl">  ุชุชู ุฅุถุงูุฉ ุงูุซุงููุฉ ุจูุนุงููุฉ ุจุฏุฃุช ูุชูุชูู ูุจู ุฅูุดุงุก ุงูููุทุฉ ุ </li><li style=";text-align:right;direction:rtl">  ุชูุช ุฅุถุงูุฉ ุงูุซุงูุซ ุจุนุฏ ุงูุชูุงุท ุงูุตูุฑุฉ. </li></ul><br><pre style=";text-align:right;direction:rtl"><code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">TRUNCATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> accounts;</code> </pre> <br>  ุงููุนุงููุฉ ุงูุฃููู (ูู ุชูุชูู ุจุนุฏ): <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span>; =&gt; <span class="hljs-keyword"><span class="hljs-keyword">INSERT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INTO</span></span> accounts <span class="hljs-keyword"><span class="hljs-keyword">VALUES</span></span> (<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">'1001'</span></span>, <span class="hljs-string"><span class="hljs-string">'alice'</span></span>, <span class="hljs-number"><span class="hljs-number">1000.00</span></span>); =&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> txid_current();</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">=&gt; SELECT txid_current(); txid_current -------------- 3695 (1 row)</code> </pre><br>  ุงููุนุงููุฉ ุงูุซุงููุฉ (ุงูุชููุช ูุจู ุฅูุดุงุก ุงูููุทุฉ): <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">| =&gt; <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span>; | =&gt; <span class="hljs-keyword"><span class="hljs-keyword">INSERT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INTO</span></span> accounts <span class="hljs-keyword"><span class="hljs-keyword">VALUES</span></span> (<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-string"><span class="hljs-string">'2001'</span></span>, <span class="hljs-string"><span class="hljs-string">'bob'</span></span>, <span class="hljs-number"><span class="hljs-number">100.00</span></span>); | =&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> txid_current();</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">| txid_current | -------------- | 3696 | (1 row)</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">| =&gt; <span class="hljs-keyword"><span class="hljs-keyword">COMMIT</span></span>;</code> </pre><br>  ุฅูุดุงุก ููุทุฉ ูู ูุนุงููุฉ ูู ุฌูุณุฉ ุฃุฎุฑู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">|| =&gt; <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ISOLATION</span></span> <span class="hljs-keyword"><span class="hljs-keyword">LEVEL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">REPEATABLE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">READ</span></span>; || =&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> xmin, xmax, * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> accounts;</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">|| xmin | xmax | id | number | client | amount || ------+------+----+--------+--------+-------- || 3696 | 0 | 2 | 2001 | bob | 100.00 || (1 row)</code> </pre><br>  ูููู ุฃูู ูุนุงููุฉ ุจุนุฏ ุฅูุดุงุก ุงูููุทุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">COMMIT</span></span>;</code> </pre><br>  ูุงููุนุงููุฉ ุงูุซุงูุซุฉ (ุธูุฑุช ูุงุญููุง ูู ุงูููุทุฉ): <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">| =&gt; <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span>; | =&gt; <span class="hljs-keyword"><span class="hljs-keyword">INSERT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INTO</span></span> accounts <span class="hljs-keyword"><span class="hljs-keyword">VALUES</span></span> (<span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-string"><span class="hljs-string">'2002'</span></span>, <span class="hljs-string"><span class="hljs-string">'bob'</span></span>, <span class="hljs-number"><span class="hljs-number">900.00</span></span>); | =&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> txid_current();</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">| txid_current | -------------- | 3697 | (1 row)</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">| =&gt; <span class="hljs-keyword"><span class="hljs-keyword">COMMIT</span></span>;</code> </pre><br>  ูู ุงููุงุถุญ ุ ุณุทุฑ ูุงุญุฏ ูุง ูุฒุงู ูุฑุฆููุง ูู ุตูุฑุชูุง: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">|| =&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> xmin, xmax, * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> accounts;</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">|| xmin | xmax | id | number | client | amount || ------+------+----+--------+--------+-------- || 3696 | 0 | 2 | 2001 | bob | 100.00 || (1 row)</code> </pre><br>  ูุงูุณุคุงู ูู ููู ูููู ุจูุณุชุฌุฑุณ ูุฐุง. <br><br>  ูู ุดูุก ูุชุญุฏุฏ ุจุงูุตูุฑุฉ.  ุฏุนููุง ููุธุฑ ูู ุงูุฃูุฑ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">|| =&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> txid_current_snapshot();</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">|| txid_current_snapshot || ----------------------- || 3695:3697:3695 || (1 row)</code> </pre><br>  ููุง ุ ูุณุฑุฏ ุงูููุทุชุงู snapshot.xmin ู snapshot.xmax ู snapshot.xip (ูู ูุฐู ุงูุญุงูุฉ ุ ุฑูู ูุงุญุฏ ุ ูููู ุจุดูู ุนุงู - ูุงุฆูุฉ). <br><br>  ููููุง ููููุงุนุฏ ุงูููุถุญุฉ ุฃุนูุงู ุ ูุฌุจ ุฃู ุชูุธูุฑ ุงูุตูุฑุฉ ุงูุชุบููุฑุงุช ุงูุชู ุชู ุฅุฌุฑุงุคูุง ุจูุงุณุทุฉ ุงููุนุงููุงุช ุจุงุณุชุฎุฏุงู ุงูุฃุฑูุงู snapshot.xmin &lt;= xid &lt;snapshot.xmax ุ ุจุงุณุชุซูุงุก snapshot.xip.  ููููู ูุธุฑุฉ ุนูู ุฌููุน ุตููู ุงูุฌุฏูู (ูู ุตูุฑุฉ ุฌุฏูุฏุฉ): <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> xmin, xmax, * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> accounts <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> id;</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> xmin | xmax | id | number | client | amount ------+------+----+--------+--------+--------- 3695 | 0 | 1 | 1001 | alice | 1000.00 3696 | 0 | 2 | 2001 | bob | 100.00 3697 | 0 | 3 | 2002 | bob | 900.00 (3 rows)</code> </pre><br>  ุงูุณุทุฑ ุงูุฃูู ุบูุฑ ูุฑุฆู - ุชู ุฅูุดุงุคู ุจูุงุณุทุฉ ูุนุงููุฉ ุ ูุงูุชู ูุชู ุชุถููููุง ูู ูุงุฆูุฉ ูุดุท (xip). <br>  ุงูุณุทุฑ ุงูุซุงูู ูุฑุฆู - ูุชู ุฅูุดุงุคู ุจูุงุณุทุฉ ูุนุงููุฉ ุชูุน ูู ูุทุงู ุงูุตูุฑุฉ. <br>  ุงูุตู ุงูุซุงูุซ ุบูุฑ ูุฑุฆู - ุชู ุฅูุดุงุคู ุจูุงุณุทุฉ ูุนุงููุฉ ููุณุช ูู ูุทุงู ุงูููุทุฉ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">|| =&gt; <span class="hljs-keyword"><span class="hljs-keyword">COMMIT</span></span>;</code> </pre><br><h1 style=";text-align:right;direction:rtl">  ุงูุชุบููุฑุงุช ุงูุฎุงุตุฉ </h1><br>  ุชุนูุฏ ุงูุตูุฑุฉ ุฅูู ุญุฏ ูุง ุญุงูุฉ ุชุญุฏูุฏ ูุฏู ูุถูุญ ุชุบููุฑุงุช ุงููุนุงููุฉ ุงูุฎุงุตุฉ ุจู.  ููุง ูุฏ ุชุญุชุงุฌ ุฅูู ุฑุคูุฉ ุฌุฒุก ููุท ูู ูุฐู ุงูุชุบููุฑุงุช.  ุนูู ุณุจูู ุงููุซุงู ุ ูุฌุจ ุฃูุง ูุดุงูุฏ ุงููุคุดุฑ ุงูููุชูุญ ูู ูุญุธุฉ ูุนููุฉ ุงูุชุบููุฑุงุช ุงูุชู ุชู ุฅุฌุฑุงุคูุง ุจุนุฏ ุชูู ุงููุญุธุฉ ุนูู ุฃู ูุณุชูู ุนุฒู. <br><br>  ููููุงู ุจุฐูู ุ ููุฌุฏ ูู ุฑุฃุณ ุฅุตุฏุงุฑ ุงูุตู ุญูู ุฎุงุต (ูุชู ุนุฑุถู ูู ุฃุนูุฏุฉ ุงูุฒุงุฆูุฉ cmin ู cmax) ุ ููุธูุฑ ุฑูู ุชุณูุณู ุงูุนูููุฉ ุฏุงุฎู ุงููุนุงููุฉ.  ููุซู Cmin ุงูุฑูู ุงููุฑุงุฏ ุฅุฏุฑุงุฌู ุ ูููุซู cmax ุงูุฑูู ุงููุฑุงุฏ ุญุฐูู ุ ูููู ูุชูููุฑ ูุณุงุญุฉ ูู ุฑุฃุณ ุงูุณุทุฑ ุ ูุฐุง ูู ุงููุงูุน ุญูู ูุงุญุฏ ุ ูููุณ ุญูููู ูุฎุชูููู.  ููุนุชูุฏ ุฃู ุฅุฏุฑุงุฌ ูุญุฐู ููุณ ุงูุตู ูู ูุนุงููุฉ ูุงุญุฏุฉ ุฃูุฑ ูุงุฏุฑ ุงูุญุฏูุซ. <br><br>  ุฅุฐุง ุงุณุชูุฑ ุญุฏูุซ ุฐูู ุ ูุณูุชู ุฅุฏุฎุงู ุฑูู "ุชุญุฑูุฑ ูุณุฑุฏ" ุฎุงุต ูู ููุณ ุงูุญูู ุ ุญูุซ ุชุชุฐูุฑ ุนูููุฉ ุงูุฎุฏูุฉ ุญูู cmin ู cmax ุงูุญูููู.  ูููู ูุฐุง ุบุฑูุจ ุชูุงูุง. <br><br>  ูุซุงู ุจุณูุท.  ูุจุฏุฃ ุงููุนุงููุฉ ููุถูู ุงูุณุทุฑ ุฅูู ุงูุฌุฏูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span>; =&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> txid_current();</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> txid_current -------------- 3698 (1 row)</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs"><span class="hljs-keyword"><span class="hljs-keyword">INSERT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INTO</span></span> accounts(id, number, client, amount) <span class="hljs-keyword"><span class="hljs-keyword">VALUES</span></span> (<span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">3001</span></span>, <span class="hljs-string"><span class="hljs-string">'charlie'</span></span>, <span class="hljs-number"><span class="hljs-number">100.00</span></span>);</code> </pre><br>  ุณูููู ุจุนุฑุถ ูุญุชููุงุช ุงูุฌุฏูู ูุน ุญูู cmin (ูููู ููุท ููุตููู ุงูุชู ุฃุถุงูุชูุง ูุนุงููุงุชูุง - ุจุงููุณุจุฉ ููุขุฎุฑูู ุ ูุง ูุนูู ูุฐูู): <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> xmin, <span class="hljs-keyword"><span class="hljs-keyword">CASE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> xmin = <span class="hljs-number"><span class="hljs-number">3698</span></span> <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> cmin <span class="hljs-keyword"><span class="hljs-keyword">END</span></span> cmin, * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> accounts;</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> xmin | cmin | id | number | client | amount ------+------+----+--------+---------+--------- 3695 | | 1 | 1001 | alice | 1000.00 3696 | | 2 | 2001 | bob | 100.00 3697 | | 3 | 2002 | bob | 900.00 3698 | 0 | 4 | 3001 | charlie | 100.00 (4 rows)</code> </pre><br>  ุงูุชุญ ุงูุขู ุงููุคุดุฑ ููุงุณุชุนูุงู ุงูุฐู ูุนุฑุถ ุนุฏุฏ ุงูุตููู ูู ุงูุฌุฏูู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">DECLARE</span></span> c <span class="hljs-keyword"><span class="hljs-keyword">CURSOR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FOR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> count(*) <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> accounts;</code> </pre><br>  ูุจุนุฏ ุฐูู ุฃุถู ุฎุทูุง ุขุฎุฑ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">INSERT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INTO</span></span> accounts(id, number, client, amount) <span class="hljs-keyword"><span class="hljs-keyword">VALUES</span></span> (<span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">3002</span></span>, <span class="hljs-string"><span class="hljs-string">'charlie'</span></span>, <span class="hljs-number"><span class="hljs-number">200.00</span></span>);</code> </pre><br>  ุณูุนูุฏ ุงูุทูุจ 4 - ูู ููุฏุฑุฌ ุงูุณุทุฑ ุงูุฐู ุชูุช ุฅุถุงูุชู ุจุนุฏ ูุชุญ ุงููุคุดุฑ ูู ููุทุฉ ุงูุจูุงูุงุช: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">FETCH</span></span> c;</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> count ------- 4 (1 row)</code> </pre><br>  ููุงุฐุงุ  ูุฃูู ูู ุงูููุทุฉ ุ ุชุคุฎุฐ ููุท ุฅุตุฏุงุฑุงุช ุงูุฎุทูุท ูุน cmin &lt;1 ูู ุงูุงุนุชุจุงุฑ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> xmin, <span class="hljs-keyword"><span class="hljs-keyword">CASE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> xmin = <span class="hljs-number"><span class="hljs-number">3698</span></span> <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> cmin <span class="hljs-keyword"><span class="hljs-keyword">END</span></span> cmin, * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> accounts;</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> xmin | cmin | id | number | client | amount ------+------+----+--------+---------+--------- 3695 | | 1 | 1001 | alice | 1000.00 3696 | | 2 | 2001 | bob | 100.00 3697 | | 3 | 2002 | bob | 900.00 3698 | 0 | 4 | 3001 | charlie | 100.00 3698 | 1 | 5 | 3002 | charlie | 200.00 (5 rows)</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">ROLLBACK</span></span>;</code> </pre><br><h1 style=";text-align:right;direction:rtl">  ุฃูู ุงูุญุฏุซ </h1><br>  ุนุฏุฏ ุงููุนุงููุงุช ุงูุฃูุฏู ุงููุดุทุฉ (snapshot.xmin) ูู ูุนูู ููู - ููู ูุนุฑูู "ุฃูู ุงูุญุฏุซ" ูููุนุงููุฉ.  ููู ุ ูุฑุงุก ุฃูููุง ุ ุชุฑู ุงูุตููุฉ ุฏุงุฆููุง ุงูุฅุตุฏุงุฑุงุช ุงูุญุงููุฉ ููุท ูู ุงูุตููู. <br><br>  ูู ุงููุงูุน ุ ูุง ูุฌุจ ุฑุคูุฉ ุฅุตุฏุงุฑ ุบูุฑ ุฐู ุตูุฉ ุฅูุง ุฅุฐุง ุชู ุฅูุดุงุก ุงูุฅุตุฏุงุฑ ุงูุญุงูู ูู ุฎูุงู ูุนุงููุฉ ูู ุชูุชูู ุจุนุฏ ุ ูุจุงูุชุงูู ููู ุบูุฑ ูุฑุฆูุฉ ุจุนุฏ.  ูููู ูููุง ูุฑุงุก "ุงูุฃูู" ุ ูุฅู ุฌููุน ุงููุนุงููุงุช ูุถูููุฉ ุจุงููุนู ูุงุณุชููุงููุง. <br><br><img src="https://habrastorage.org/webt/8z/vp/oo/8zvpoocv891hhtnv9lcs6j7g4ry.png"><br><br>  ูููู ุฑุคูุฉ "ุฃูู ุงูุญุฏุซ" ูููุนุงููุฉ ูู ุฏููู ุงููุธุงู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span>; =&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> backend_xmin <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> pg_stat_activity <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> pid = pg_backend_pid();</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> backend_xmin -------------- 3699 (1 row)</code> </pre><br>  ููููู ุฃูุถูุง ุชุญุฏูุฏ "ุฃูู ุงูุญุฏุซ" ุนูู ูุณุชูู ูุงุนุฏุฉ ุงูุจูุงูุงุช.  ููููุงู ุจุฐูู ุ ุฎุฐ ุฌููุน ุงูููุทุงุช ุงููุดุทุฉ ููู ุจูููุง ุงูุนุซูุฑ ุนูู xmin ุงูุฃูุฏู.  ุณูุญุฏุฏ ุงูุฃูู ุงูุฐู ูู ุชุธูุฑ ุจุนุฏู ุงูุฅุตุฏุงุฑุงุช ุบูุฑ ุงูููุงุฆูุฉ ูู ุงูุตููู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุฐู ูุฃู ูุนุงููุงุช.  <em>ูููู ูุณุญ ูุฐู ุงูุฅุตุฏุงุฑุงุช ูู ุงูุณูุงุณู</em> - ููุฐุง ูู ุงูุณุจุจ ูู ุฃู ููููู ุงูุฃูู ููู ููุบุงูุฉ ูู ูุฌูุฉ ูุธุฑ ุนูููุฉ. <br><br>  ุฅุฐุง ูุงูุช ุฅุญุฏู ุงููุนุงููุงุช ุชุญุชูู ุนูู ููุทุฉ ููุชุฑุฉ ุทูููุฉ ุ ูุณุชุญุชูุธ ุฃูุถูุง ุจุฃูู ุญุฏุซ ูุงุนุฏุฉ ุงูุจูุงูุงุช.  ุนูุงูุฉ ุนูู ุฐูู ุ ูุฅู ุงูุตููุฉ ุบูุฑ ุงูููุชููุฉ ุณูู ุชุจูู ุนูู ุงูุฃูู ูู ุฎูุงู ุญูููุฉ ูุฌูุฏูุง ุ ุญุชู ูู ูู ูุชู ุงูุงุญุชูุงุธ ุจูุง. <br><br>  ููุฐุง ูุนูู ุฃูู ูุง ูููู ูุณุญ ุงูุฅุตุฏุงุฑุงุช ุบูุฑ ุงูููุงุฆูุฉ ูู ุงูุตููู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุฐู.  ูู ุงูููุช ููุณู ุ ูุฏ ูุง ุชุชุฏุงุฎู ูุนุงููุฉ "ุงูุชุดุบูู ุงูุทููู" ูุน ุงููุนุงููุงุช ุงูุฃุฎุฑู ูู ุงูุจูุงูุงุช - ููุฐุง ููุณ ููููุง ุนูู ุงูุฅุทูุงู ุ ุฃูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ูู ููุณู ุจุงููุณุจุฉ ููุฌููุน. <br><br>  ุฅุฐุง ุชู ุนุฑุถ ุงูุขู ุ ูููุณ ูุนุงููุฉ ุ ูููู ุงูููุทุงุช (ูู snapshot.xmin ุฅูู snapshot.xmax) ููุทุนุฉ ุ ูููู ุชุตูุฑ ุงููููู ุนูู ุงููุญู ุงูุชุงูู: <br><br><img src="https://habrastorage.org/webt/nd/ve/wi/ndvewikoeiljposax85zp7mmmn8.png"><br><br>  ูู ูุฐุง ุงูุดูู ุ ุชุดูุฑ ุงูููุทุฉ ุงูุฃุฎูุฑุฉ ุฅูู ูุนุงููุฉ ุบูุฑ ูุงููุฉ ุ ููู ุงูููุทุงุช ุงููุชุจููุฉ. ูุง ูููู ุฃู ุชููู ุงูููุทุงุช ุงููุงุญูุฉ ุฃูุจุฑ ูู ุนุฏุฏูุง. <br><br>  ูู ูุซุงููุง ุ ุชู ุจุฏุก ูุนุงููุฉ ุจูุณุชูู ุนุฒู Read Committed.  ุนูู ุงูุฑุบู ูู ุนุฏู ูุฌูุฏ ููุทุฉ ุจูุงูุงุช ูุดุทุฉ ูููุง ุ ุฅูุง ุฃููุง ุชุณุชูุฑ ูู ุงูุฃูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">| =&gt; <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span>; | =&gt; <span class="hljs-keyword"><span class="hljs-keyword">UPDATE</span></span> accounts <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> amount = amount + <span class="hljs-number"><span class="hljs-number">1.00</span></span>; | =&gt; <span class="hljs-keyword"><span class="hljs-keyword">COMMIT</span></span>;</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> backend_xmin <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> pg_stat_activity <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> pid = pg_backend_pid();</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> backend_xmin -------------- 3699 (1 row)</code> </pre><br>  ูููุท ุจุนุฏ ุงูุชูุงู ุงููุนุงููุฉ ุ ูุชุญุฑู ุงูุฃูู ููุฃูุงู ุ ููุง ูุณูุญ ูู ุจูุณุญ ุงูุฅุตุฏุงุฑุงุช ุบูุฑ ุงูููุงุฆูุฉ ูู ุงูุตููู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">COMMIT</span></span>; =&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> backend_xmin <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> pg_stat_activity <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> pid = pg_backend_pid();</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> backend_xmin -------------- 3700 (1 row)</code> </pre><br>  ุฅุฐุง ูุงู ุงููููู ุงูููุตูู ูุฎูู ูุดุงูู ุจุงููุนู ููุง ุชูุฌุฏ ุทุฑููุฉ ูุชุฌูุจูุง ุนูู ูุณุชูู ุงูุชุทุจูู ุ ูุนูุฏุฆุฐ ุ ุจุฏุกูุง ูู ุงูุฅุตุฏุงุฑ 9.6 ุ ูุชููุฑ ุฎูุงุฑุงู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุญุฏุฏ <em>old_snapshot_threshold</em> ุงูุญุฏ ุงูุฃูุตู ูุนูุฑ ุงูููุทุฉ.  ุจุนุฏ ูุฐุง ุงูููุช ุ ูุญุตู ุงูุฎุงุฏู ุนูู ุงูุญู ูู ุญุฐู ุงูุฅุตุฏุงุฑุงุช ุบูุฑ ุฐุงุช ุงูุตูุฉ ูู ุงูุฎุทูุท ุ ูุฅุฐุง ูุงู ูุญุชุงุฌ ุฅูู ูุนุงููุฉ "ุงูุชุดุบูู ููุฐ ูุชุฑุฉ ุทูููุฉ" ุ ูููู ุณูุชููู ุฎุทุฃ ูุฏูู ุฌุฏุงู. </li><li style=";text-align:right;direction:rtl">  ูุญุฏุฏ <em>idle_in_transaction_session_timeout</em> ุงูุญุฏ ุงูุฃูุตู ูุนูุฑ ุงููุนุงููุงุช ุบูุฑ ุงููุดุทุฉ.  ุจุนุฏ ูุฐุง ุงูููุช ุ ูุชู ุฅุญุจุงุท ุงููุนุงููุฉ. </li></ul><br><h1 style=";text-align:right;direction:rtl">  ููุทุฉ ุจูุงูุงุช ุงูุชุตุฏูุฑ </h1><br>  ููุงู ุญุงูุงุช ุนูุฏูุง ูุฌุจ ุถูุงู ุนุฏุฉ ูุนุงููุงุช ูุชุฒุงููุฉ ูุฑุคูุฉ ููุณ ุตูุฑุฉ ุงูุจูุงูุงุช.  ุนูู ุณุจูู ุงููุซุงู ุ ูููููุง ุงุณุชุฎุฏุงู ุงูุฃุฏุงุฉ ุงููุณุงุนุฏุฉ pg_dump ุ ูุงูุชู ูููู ุฃู ุชุนูู ูู ุงููุถุน ุงููุชูุงุฒู: ูุฌุจ ุฃู ุชุฑู ุฌููุน ุงูุนูููุงุช ุงููููุฐุฉ ูุงุนุฏุฉ ุงูุจูุงูุงุช ูู ููุณ ุงูุญุงูุฉ ุจุญูุซ ุชููู ูุณุฎุฉ ุงููุณุฎ ุงูุงุญุชูุงุทู ูุชูุงุณูุฉ. <br><br>  ุจุงูุทุจุน ุ ูุง ููููู ุงูุงุนุชูุงุฏ ุนูู ุญูููุฉ ุฃู ุฃููุงุท ุงูุจูุงูุงุช ุชุชุฒุงูู ุจุจุณุงุทุฉ ูุฃู ุงููุนุงููุงุช ูุชู ุฅุทูุงููุง "ูู ููุช ูุงุญุฏ".  ููุงู ุขููุฉ ูุชุตุฏูุฑ ูุงุณุชูุฑุงุฏ ููุทุฉ ูุฐูู. <br><br>  ุชุฑุฌุน ุงูุฏุงูุฉ pg_export_snapshot ูุนุฑู ุงูููุทุฉ ุงูุชู ูููู ููููุง (ุจูุงุณุทุฉ ูุณุงุฆู ุฎุงุฑุฌูุฉ ุฅูู DBMS) ุฅูู ูุนุงููุฉ ุฃุฎุฑู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ISOLATION</span></span> <span class="hljs-keyword"><span class="hljs-keyword">LEVEL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">REPEATABLE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">READ</span></span>; =&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> count(*) <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> accounts; <span class="hljs-comment"><span class="hljs-comment">--  </span></span></code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> count ------- 3 (1 row)</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> pg_export_snapshot();</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> pg_export_snapshot --------------------- 00000004-00000E7B-1 (1 row)</code> </pre><br>  ูููู ููุนุงููุฉ ุฃุฎุฑู ุงุณุชูุฑุงุฏ ุงูููุทุฉ ุจุงุณุชุฎุฏุงู ุงูุฃูุฑ SET TRANSACTION SNAPSHOT ูุจู ุชูููุฐ ุงูุทูุจ ุงูุฃูู ููู.  ูุฌุจ ุนููู ุฃููุงู ุชุนููู ูุณุชูู ุงูุนุฒู ูู "ูุฑุงุกุฉ ูุชูุฑุฑุฉ" ุฃู "ูุชุณูุณูุฉ" ุ ูุฃูู ุนูู ูุณุชูู "ุงูุชุฒุงู ุงููุฑุงุกุฉ" ุ ูุณุชุฎุฏู ุงููุดุบููู ููุทุงุชูู ุงูุฎุงุตุฉ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">| =&gt; <span class="hljs-keyword"><span class="hljs-keyword">DELETE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> accounts; | =&gt; <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ISOLATION</span></span> <span class="hljs-keyword"><span class="hljs-keyword">LEVEL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">REPEATABLE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">READ</span></span>; | =&gt; <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TRANSACTION</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SNAPSHOT</span></span> <span class="hljs-string"><span class="hljs-string">'00000004-00000E7B-1'</span></span>;</code> </pre><br>  ุงูุขู ุณุชุนูู ุงููุนุงููุฉ ุงูุซุงููุฉ ูุน ููุทุฉ ูู ุงูุฃููู ุ ูุจูุงุกู ุนูู ุฐูู ุ ุงูุธุฑ ุซูุงุซุฉ ุตููู (ูููุณ ุตูุฑ): <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">| =&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> count(*) <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> accounts;</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">| count | ------- | 3 | (1 row)</code> </pre><br>  ุนูุฑ ุงูููุทุฉ ุงููุตุฏุฑุฉ ูู ุนูุฑ ุงููุนุงููุฉ ุงููุตุฏุฑุฉ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">| =&gt; <span class="hljs-keyword"><span class="hljs-keyword">COMMIT</span></span>; =&gt; <span class="hljs-keyword"><span class="hljs-keyword">COMMIT</span></span>;</code> </pre><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฃู ุชุณุชูุฑ</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar446652/">https://habr.com/ru/post/ar446652/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar446638/index.html">Cisco HyperFlex vs. ุงูููุงูุณูู: ุงุฎุชุจุงุฑ ุงูุฃุฏุงุก</a></li>
<li><a href="../ar446640/index.html">20 ูุดุฑูุนูุง ุ 20 ูุบุฉ ุ ุงูููุนุฏ ุงูููุงุฆู ุฃูุณ. ุงูุฌุฒุก 2</a></li>
<li><a href="../ar446642/index.html">ูุงุฆูุฉ ูุฑุฌุนูุฉ ูุฅูุดุงุก ููุดุฑ ุชุทุจููุงุช ุงูููุจ</a></li>
<li><a href="../ar446648/index.html">ุชุทููุฑ ูุดุบู Kubernetes ูุน ุฅุทุงุฑ ุงููุดุบู</a></li>
<li><a href="../ar446650/index.html">ูู ุชูููุฉ ุงุฎุชุจุงุฑ ููุง ุฑูุงุชุจูู ุชุนุชูุฏ ุนููุ ุจูุงุก ุตูุฑุฉ ููุชุฎุตุต ุถูุงู ุงูุฌูุฏุฉ ุงููุงุฌุญ</a></li>
<li><a href="../ar446654/index.html">ููู ุญูุธูุง ูุฑุงุฌุนุฉ ุงูููุฏุ</a></li>
<li><a href="../ar446658/index.html">ููุงุจูุฉ ูุน ุฃูุฏุฑูู ุณุชุงููููุชุด ุญูู ุงูุจุฑูุฌุฉ ุงูุฑูุงุถูุฉ</a></li>
<li><a href="../ar446660/index.html">ููุธูุฉ ุงูุนูู ุงูุฏูููุฉ ุ ุทุงูุจ ูุฌุงุฆุฒุฉ ูุจูุฑุฉ: ููููุฉ ุงูููุงู ุจุงูุชุนูู ุงูุขูู ูู ุงูุตู ุงูุซุงูู</a></li>
<li><a href="../ar446662/index.html">ุงููุนุงููุงุช ูุขููุงุช ุงูุณูุทุฑุฉ ุนูููุง</a></li>
<li><a href="../ar446664/index.html">ูุจุนุฏ SAP Forum 2019 ุฃุณุจูุนูู ููุท! ูุงุฐุง ุณูููู ููุงูุ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>