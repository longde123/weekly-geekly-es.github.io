<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏼‍🔬 🤛🏽 🎭 Android Gustuff木马如何从您的帐户中删除奶油（法定和加密货币） 🏭 🌵 👎🏿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="就在前几天，Group-IB 报告了Android移动Trojan Gustuff的活动。 它仅在国际市场上运作，攻击100家最大的外国银行的客户，32个移动加密钱包的用户以及庞大的电子商务资源。 但古斯塔夫（Gustuff）的开发商是俄语的网络犯罪分子，绰号为Bestoffer。 直到最近，他还称...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Android Gustuff木马如何从您的帐户中删除奶油（法定和加密货币）</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/group-ib/blog/446948/"><img src="https://habrastorage.org/webt/b9/hn/wr/b9hnwrlclblkmurq29bkezeanui.png"><br><br> 就在前几天，Group-IB <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">报告</a>了Android移动Trojan Gustuff的活动。 它仅在国际市场上运作，攻击100家最大的外国银行的客户，32个移动加密钱包的用户以及庞大的电子商务资源。 但古斯塔夫（Gustuff）的开发商是俄语的网络犯罪分子，绰号为Bestoffer。 直到最近，他还称赞他的木马程序“对有知识和经验的人来说是一种严肃的产品”。 <br><br> 分析Group-IB恶意代码<b>的</b>专家<b>Ivan</b> Pisarev在他的研究中详细讲述了Gustuff的工作原理及其危害。 <a name="habracut"></a><br><br><h2> 古斯塔夫在寻找谁？ </h2><br>  Gustuff是具有全自动功能的新一代恶意软件。 根据开发人员的说法，该木马已成为AndyBot恶意软件的新改进版本，自2017年11月以来，该恶意软件一直在攻击Android手机并通过伪装成知名国际银行和支付系统的移动应用程序的网络钓鱼形式窃取资金。  Bestoffer报道说，古斯塔夫·波特的租金为每月800美元。 <br><br> 对Gustuff样本的分析表明，该木马可能针对使用最大银行的移动应用程序的客户，例如美国银行，苏格兰银行，摩根大通，富国银行，Capital One，TD银行，PNC银行以及比特币钱包，BitPay加密钱包，Cryptopay，Coinbase等。 <br><br>  Gustuff最初是作为经典的银行木马创建的，当前的版本大大扩展了潜在的攻击目标。 除了银行，金融科技公司和加密服务的Android应用程序之外，Gustuff还面向市场应用程序，在线商店，支付系统和即时通讯程序的用户。 特别是PayPal，Western Union，eBay，Walmart，Skype，WhatsApp，Gett Taxi，Revolut等。 <br><br><h2> 切入点：大规模感染的计算 </h2><br>  Gustuff的特征是通过带有链接到APK的SMS邮件渗透到Android智能手机的“经典”载体。 如果在服务器的命令下Android设备感染了木马，则Gustuff可能会通过受感染手机的通讯录数据库或服务器数据库进一步传播。  Gustuff的功能专为大规模感染和运营商业务的最大资本化而设计-它具有独特的功能，可以“自动填充”到合法的移动银行应用程序和加密货币钱包中，从而使您能够加速并扩大盗窃资金的规模。 <br><br> 对特洛伊木马的研究表明，自动填充功能是通过使用“无障碍服务”（残疾人服务）实现的。  Gustuff并不是第一个成功绕过保护功能的木马程序，该功能可以防止与使用此Android服务的其他应用程序的窗口元素进行交互。 但是，将辅助功能服务与自动加载结合使用仍然很少。 <br><br> 将受害者下载到手机后，Gustuff使用Accessibility Service获得了与其他应用程序（银行，加密货币以及用于在线购物，消息传递等的应用程序）的窗口元素进行交互的机会，从而为攻击者执行了必要的操作。 例如，在服务器的命令下，木马可以单击按钮并更改银行应用程序中文本字段的值。 使用无障碍服务机制，特洛伊木马可以绕过银行用来抵抗上一代移动特洛伊木马的保护机制，以及Google在新版Android OS中引入的安全策略的更改。 因此，古斯塔夫“知道如何”禁用Google Protect保护：根据作者的说法，此功能在70％的情况下都有效。 <br><br><img src="https://habrastorage.org/webt/ih/x4/1k/ihx41k2p4hqubcaaisklwvdyoy8.png"><br><br>  Gustuff还可以显示带有合法移动应用程序图标的假PUSH通知。 用户单击“推送”通知，然后看到从服务器下载的网络钓鱼窗口，他本人在该窗口中输入了所请求的银行卡或加密钱包数据。 在另一个Gustuff方案中，将打开一个代表显示PUSH通知的应用程序。 在这种情况下，根据服务器通过辅助功能服务的命令，恶意程序可以填写银行应用程序的表单字段以进行欺诈性交易。 <br><br>  Gustuff的功能还包括将有关受感染设备的信息发送到服务器，读取/发送SMS消息，发送USSD请求，启动SOCKS5代理，跟随链接，将文件（包括文档的照片扫描，屏幕截图，照片）发送到服务器的功能。将设备重置为出厂设置。 <br><br><h2> 恶意软件分析 </h2><br> 在安装恶意应用程序之前，Android OS向用户显示一个窗口，其中包含Gustuff请求的权限列表： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ku/th/ac/kuthacuzh0webqtrwhgktysougi.png" alt="图片替代"></div><br> 仅在获得用户同意后才能安装应用程序。 启动该应用程序后，该木马程序将向用户显示一个窗口： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/hj/uq/xa/hjuqxaw2ezubek_xmd3clywhpsw.png" alt="图片替代"></div><br> 然后它将删除其图标。 <br><br> 根据作者的说法，古斯塔夫是由FTT包装商包装的。 启动后，应用程序会定期访问CnC服务器以接收命令。 在我们检查的几个文件中，IP地址<b>88.99.171 [。] 105被</b>用作控制服务器（在下面，我们将其指定为<b>&lt;％CnC％&gt;</b> ）。 <br><br> 启动后，程序开始向服务器<b>http：// &lt;％CnC％&gt; /api/v1/get.php</b>发送消息。 <br><br> 作为回答，JSON应采用以下格式： <br><br><pre><code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"results"</span></span> : <span class="hljs-string"><span class="hljs-string">"OK"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"command"</span></span>:{ <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"&lt;%id%&gt;"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"command"</span></span>:<span class="hljs-string"><span class="hljs-string">"&lt;%command%&gt;"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"timestamp"</span></span>:<span class="hljs-string"><span class="hljs-string">"&lt;%Server Timestamp%&gt;"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"params"</span></span>:{ &lt;%Command parameters as JSON%&gt; }, }, }</code> </pre> <br> 每次应用程序发送有关受感染设备的信息时。 消息的格式如下所示。 值得注意的是， <b>full</b> ， <b>extra</b> ， <b>apps</b>和<b>Permission</b>字段是可选的，仅在来自CnC的请求命令的情况下才发送。 <br><br><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"info"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"info"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"cell"</span></span>:&lt;%Sim operator name%&gt;, <span class="hljs-attr"><span class="hljs-attr">"country"</span></span>:&lt;%Country ISO%&gt;, <span class="hljs-attr"><span class="hljs-attr">"imei"</span></span>:&lt;%IMEI%&gt;, <span class="hljs-attr"><span class="hljs-attr">"number"</span></span>:&lt;%Phone number%&gt;, <span class="hljs-attr"><span class="hljs-attr">"line1Number"</span></span>:&lt;%Phone number%&gt;, <span class="hljs-attr"><span class="hljs-attr">"advertisementId"</span></span>:&lt;%ID%&gt; }, <span class="hljs-attr"><span class="hljs-attr">"state"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"admin"</span></span>:&lt;%Has admin rights%&gt;, <span class="hljs-attr"><span class="hljs-attr">"source"</span></span>:&lt;%String%&gt;, <span class="hljs-attr"><span class="hljs-attr">"needPermissions"</span></span>:&lt;%Application needs permissions%&gt;, <span class="hljs-attr"><span class="hljs-attr">"accesByName"</span></span>:&lt;%Boolean%&gt;, <span class="hljs-attr"><span class="hljs-attr">"accesByService"</span></span>:&lt;%Boolean%&gt;, <span class="hljs-attr"><span class="hljs-attr">"safetyNet"</span></span>:&lt;%String%&gt;, <span class="hljs-attr"><span class="hljs-attr">"defaultSmsApp"</span></span>:&lt;%Default Sms Application%&gt;, <span class="hljs-attr"><span class="hljs-attr">"isDefaultSmsApp"</span></span>:&lt;%Current application is Default Sms Application%&gt;, <span class="hljs-attr"><span class="hljs-attr">"dateTime"</span></span>:&lt;%Current date time%&gt;, <span class="hljs-attr"><span class="hljs-attr">"batteryLevel"</span></span>:&lt;%Battery level%&gt; }, <span class="hljs-attr"><span class="hljs-attr">"socks"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>:&lt;%Proxy module ID%&gt;, <span class="hljs-attr"><span class="hljs-attr">"enabled"</span></span>:&lt;%Is enabled%&gt;, <span class="hljs-attr"><span class="hljs-attr">"active"</span></span>:&lt;%Is active%&gt; }, <span class="hljs-attr"><span class="hljs-attr">"version"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"versionName"</span></span>:&lt;%Package Version Name%&gt;, <span class="hljs-attr"><span class="hljs-attr">"versionCode"</span></span>:&lt;%Package Version Code%&gt;, <span class="hljs-attr"><span class="hljs-attr">"lastUpdateTime"</span></span>:&lt;%Package Last Update Time%&gt;, <span class="hljs-attr"><span class="hljs-attr">"tag"</span></span>:&lt;%Tag, default value: <span class="hljs-string"><span class="hljs-string">"TAG"</span></span>%&gt;, <span class="hljs-attr"><span class="hljs-attr">"targetSdkVersion"</span></span>:&lt;%Target Sdk Version%&gt;, <span class="hljs-attr"><span class="hljs-attr">"buildConfigTimestamp"</span></span>:<span class="hljs-number"><span class="hljs-number">1541309066721</span></span> }, }, <span class="hljs-attr"><span class="hljs-attr">"full"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"model"</span></span>:&lt;%Device Model%&gt;, <span class="hljs-attr"><span class="hljs-attr">"localeCountry"</span></span>:&lt;%Country%&gt;, <span class="hljs-attr"><span class="hljs-attr">"localeLang"</span></span>:&lt;%Locale language%&gt;, <span class="hljs-attr"><span class="hljs-attr">"accounts"</span></span>:&lt;%JSON array, contains from <span class="hljs-attr"><span class="hljs-attr">"name"</span></span> and <span class="hljs-attr"><span class="hljs-attr">"type"</span></span> of accounts%&gt;, <span class="hljs-attr"><span class="hljs-attr">"lockType"</span></span>:&lt;%Type of lockscreen password%&gt; }, <span class="hljs-attr"><span class="hljs-attr">"extra"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"serial"</span></span>:&lt;%Build serial number%&gt;, <span class="hljs-attr"><span class="hljs-attr">"board"</span></span>:&lt;%Build Board%&gt;, <span class="hljs-attr"><span class="hljs-attr">"brand"</span></span>:&lt;%Build Brand%&gt;, <span class="hljs-attr"><span class="hljs-attr">"user"</span></span>:&lt;%Build User%&gt;, <span class="hljs-attr"><span class="hljs-attr">"device"</span></span>:&lt;%Build Device%&gt;, <span class="hljs-attr"><span class="hljs-attr">"display"</span></span>:&lt;%Build Display%&gt;, <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>:&lt;%Build ID%&gt;, <span class="hljs-attr"><span class="hljs-attr">"manufacturer"</span></span>:&lt;%Build manufacturer%&gt;, <span class="hljs-attr"><span class="hljs-attr">"model"</span></span>:&lt;%Build model%&gt;, <span class="hljs-attr"><span class="hljs-attr">"product"</span></span>:&lt;%Build product%&gt;, <span class="hljs-attr"><span class="hljs-attr">"tags"</span></span>:&lt;%Build tags%&gt;, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>:&lt;%Build type%&gt;, <span class="hljs-attr"><span class="hljs-attr">"imei"</span></span>:&lt;%imei%&gt;, <span class="hljs-attr"><span class="hljs-attr">"imsi"</span></span>:&lt;%imsi%&gt;, <span class="hljs-attr"><span class="hljs-attr">"line1number"</span></span>:&lt;%phonenumber%&gt;, <span class="hljs-attr"><span class="hljs-attr">"iccid"</span></span>:&lt;%Sim serial number%&gt;, <span class="hljs-attr"><span class="hljs-attr">"mcc"</span></span>:&lt;%Mobile country code of operator%&gt;, <span class="hljs-attr"><span class="hljs-attr">"mnc"</span></span>:&lt;%Mobile network codeof operator%&gt;, <span class="hljs-attr"><span class="hljs-attr">"cellid"</span></span>:&lt;%GSM-data%&gt;, <span class="hljs-attr"><span class="hljs-attr">"lac"</span></span>:&lt;%GSM-data%&gt;, <span class="hljs-attr"><span class="hljs-attr">"androidid"</span></span>:&lt;%Android Id%&gt;, <span class="hljs-attr"><span class="hljs-attr">"ssid"</span></span>:&lt;%Wi-Fi SSID%&gt; }, <span class="hljs-attr"><span class="hljs-attr">"apps"</span></span>:{&lt;%List of installed applications%&gt;}, <span class="hljs-attr"><span class="hljs-attr">"permission"</span></span>:&lt;%List of granted permissions%&gt; }</code> </pre> <br><h3> 配置数据存储 </h3><br>  Gustuff将重要的工作信息存储在首选项文件中。 文件名以及其中的参数名是从行<b>15413090667214.6.1 &lt;％name％&gt;</b>中计算MD5总和的结果，其中<b>&lt;％name％&gt;</b>是原始名称值。 名称生成函数的Python解释： <br><br><pre> <code class="json hljs"> nameGenerator(input): output = md<span class="hljs-number"><span class="hljs-number">5</span></span>(<span class="hljs-string"><span class="hljs-string">"15413090667214.6.1"</span></span> + input)</code> </pre> <br> 在下文中，我们将其表示为<b>nameGenerator（输入）</b> 。 <br><br> 因此，第一个文件的名称是： <b>nameGenerator（“ API_SERVER_LIST”）</b> ，它包含具有以下名称的值： <br><br><table><tbody><tr><th width="400">  <b>变量名</b> </th><th>  <b>价值</b> </th></tr><tr><td>  <b>nameGenerator（“ API_SERVER_LIST”）</b> </td><td> 包含CnC地址列表作为数组。 </td></tr><tr><td>  <b>nameGenerator（“ API_SERVER_URL”）</b> </td><td> 包含一个CnC地址。 </td></tr><tr><td>  <b>nameGenerator（“ SMS_UPLOAD”）</b> </td><td> 该标志是默认设置的。 如果设置了此标志，则将SMS消息发送到CnC。 </td></tr><tr><td>  <b>nameGenerator（“ SMS_ROOT_NUMBER”）</b> </td><td> 被感染设备接收到的SMS消息将被发送到的电话号码。 默认为空。 </td></tr><tr><td>  <b>nameGenerator（“ SMS_ROOT_NUMBER_RESEND”）</b> </td><td> 默认情况下，该标志被清除。 如果已安装，则当受感染的设备收到SMS时，它将发送到根号。 </td></tr><tr><td>  <b>nameGenerator（“ DEFAULT_APP_SMS”）</b> </td><td> 默认情况下，该标志被清除。 如果设置了此标志，则应用程序将处理传入的SMS消息。 </td></tr><tr><td>  <b>nameGenerator（“ DEFAULT_ADMIN”）</b> </td><td> 默认情况下，该标志被清除。 如果设置了该标志，则该应用程序具有管理员权限。 </td></tr><tr><td>  <b>nameGenerator（“ DEFAULT_ACCESSIBILITY”）</b> </td><td> 默认情况下，该标志被清除。 如果设置了该标志，则启动使用辅助功能的服务。 </td></tr><tr><td>  <b>nameGenerator（“ APPS_CONFIG”）</b> </td><td>  JSON对象包含一个与特定应用程序关联的Accessibility事件触发时必须执行的操作的列表。 </td></tr><tr><td>  <b>nameGenerator（“ APPS_INSTALLED”）</b> </td><td> 存储设备上安装的应用程序列表。 </td></tr><tr><td>  <b>nameGenerator（“ IS_FIST_RUN”）</b> </td><td> 该标志在首次启动时被重置。 </td></tr><tr><td>  <b>nameGenerator（“ UNIQUE_ID”）</b> </td><td> 包含唯一标识符。 它是在bot首次启动时生成的。 </td></tr></tbody></table><br><h3> 服务器命令处理模块 </h3><br> 该应用程序将CnC服务器的地址存储为<b>Base85</b>编码的字符串数组。 收到适当的命令后，即可更改CnC服务器列表，在这种情况下，地址将存储在首选项文件中。 <br><br> 响应该请求，服务器将命令发送到应用程序。 值得注意的是，命令和参数以JSON格式显示。 应用程序可以处理以下命令： <br><table><tbody><tr><th width="150">  <b>团队</b> </th><th>  <b>内容描述</b> </th></tr><tr><td>  <b>forwardStart</b> </td><td> 开始将受感染设备收到的SMS消息发送到CnC服务器。 </td></tr><tr><td>  <b>前进停止</b> </td><td> 停止将受感染设备收到的SMS消息发送到CnC服务器。 </td></tr><tr><td>  <b>ussdRun</b> </td><td> 运行USSD请求。 您要向其发出USSD请求的号码位于JSON字段“号码”中。 </td></tr><tr><td>  <b>sendSms</b> </td><td> 发送一条SMS消息（如有必要，该消息被“拆分”为多个部分）。 作为参数，该命令采用一个JSON对象，该对象包含“收件人”字段-目标号码和“正文”-消息正文。 </td></tr><tr><td>  <b>sendSmsAb</b> </td><td> 从受感染设备的联系人列表向所有人发送SMS消息（如有必要，将消息“拆分”为多个部分）。 发送消息之间的间隔为10秒。 消息正文在JSON字段“ body”中 </td></tr><tr><td>  <b>sendSmsMass</b> </td><td> 向命令参数中指定的联系人发送SMS消息（如有必要，将消息“拆分”为多个部分）。 发送消息之间的间隔为10秒。 作为参数，该命令接受一个JSON数组（字段“ sms”），其元素包含字段“ to”（目标号码）和“ body”（消息正文）。 </td></tr><tr><td>  <b>changeServer</b> </td><td> 该命令作为参数可以使用键“ url”获取值-机器人将更改nameGenerator（“ SERVER_URL”）或“ array”的值-然后机器人将数组写入nameGenerator（“ API_SERVER_LIST”）。因此，应用程序更改了CnC服务器的地址。 </td></tr><tr><td>  <b>adminNumber</b> </td><td> 该命令旨在使用根号。 该命令接受具有以下参数的JSON对象：“数字”-将nameGenerator（“ ROOT_NUMBER”）更改为接收值，“重新发送”-更改nameGenerator（“ SMS_ROOT_NUMBER_RESEND”），“ sendId”-发送给nameGenerator（“ ROOT_NUMBER”）唯一ID。 </td></tr><tr><td>  <b>updateInfo</b> </td><td> 将有关受感染设备的信息发送到服务器。 </td></tr><tr><td>  <b>擦拭数据</b> </td><td> 该命令旨在删除用户数据。 根据启动应用程序的名称，随着设备重启（主用户）完全删除数据，或者仅删除用户数据（辅助用户）。 </td></tr><tr><td>  <b>socks开始</b> </td><td> 启动代理模块。 模块的操作在单独的部分中进行描述。 </td></tr><tr><td>  <b>袜子停止</b> </td><td> 停止代理模块。 </td></tr><tr><td>  <b>开放链接</b> </td><td> 按照链接。 该链接位于键“ URL”中的JSON参数中。 要打开链接，请使用“ android.intent.action.VIEW”。 </td></tr><tr><td>  <b>uploadAllSms</b> </td><td> 将设备收到的所有SMS消息发送到服务器。 </td></tr><tr><td>  <b>uploadAllPhotos</b> </td><td> 将图像从受感染的设备发送到URL。  URL作为参数。 </td></tr><tr><td>  <b>uploadFile</b> </td><td> 将文件发送到受感染设备的URL。  URL作为参数。 </td></tr><tr><td>  <b>uploadPhoneNumbers</b> </td><td> 将电话号码从联系人列表发送到服务器。 如果带有键“ ab”的JSON对象作为参数，则应用程序将从电话簿中接收联系人列表。 如果带有“ sms”键的JSON对象作为参数，则应用程序将从SMS消息的发件人中读取联系人列表。 </td></tr><tr><td>  <b>changeArchive</b> </td><td> 该应用程序从地址下载文件，该地址作为带有键“ url”的参数来提供。 下载的文件以“ archive.zip”的名称保存。 之后，如果需要，应用程序将使用存档文件“ b5jXh37gxgHBrZhQ4j3D”的密码来解压缩文件。 解压缩的文件保存在[external storage] / hgps目录中。 该应用程序在此目录中存储Web伪造品（稍后描述）。 </td></tr><tr><td>  <b>行动</b> </td><td> 该命令旨在与Action Service一起使用，这将在单独的部分中进行描述。 </td></tr><tr><td>  <b>测试</b> </td><td> 它什么也没做。 </td></tr><tr><td>  <b>资料下载</b> </td><td> 该命令旨在从远程服务器下载文件并将其保存到Downloads目录。  URL和文件名作为参数，JSON对象参数中的字段分别为：“ url”和“ fileName”。 </td></tr><tr><td>  <b>删除</b> </td><td> 从下载目录中删除文件。 文件名位于JSON参数中，键为“ fileName”。 默认文件名为“ tmp.apk”。 </td></tr><tr><td>  <b>通知事项</b> </td><td> 显示包含管理服务器定义的描述和标题文本的通知。 </td></tr></tbody></table><br>  <b>通知</b>命令的格式为： <br><br><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"results"</span></span> : <span class="hljs-string"><span class="hljs-string">"OK"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"command"</span></span>:{ <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: &lt;%id%&gt;, <span class="hljs-attr"><span class="hljs-attr">"command"</span></span>:<span class="hljs-string"><span class="hljs-string">"notification"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"timestamp"</span></span>:&lt;%Server Timestamp%&gt;, <span class="hljs-attr"><span class="hljs-attr">"params"</span></span>:{ <span class="hljs-attr"><span class="hljs-attr">"openApp"</span></span>:&lt;%Open original app or not%&gt;, <span class="hljs-attr"><span class="hljs-attr">"array"</span></span>:[ {<span class="hljs-attr"><span class="hljs-attr">"title"</span></span>:&lt;%Title text%&gt;, <span class="hljs-attr"><span class="hljs-attr">"desc"</span></span>:&lt;%Description text%&gt;, <span class="hljs-attr"><span class="hljs-attr">"app"</span></span>:&lt;%Application name%&gt;} ] }, }, }</code> </pre> <br> 由调查文件生成的通知看起来与在<b>应用程序</b>字段中指定的<b>应用</b>程序创建的通知相同。 如果<b>openApp</b>字段的值为True，则在打开通知时，将启动在<b>app</b>字段中指定的<b>应用程序</b> 。 如果<b>openApp</b>字段的值为False，则： <br><br><ul><li> 网络钓鱼窗口打开，其内容从目录<b>&lt;％external storage％&gt; / hgps / &lt;％filename％&gt;下载</b> </li><li> 将打开一个网络钓鱼窗口，该钓鱼窗口的内容是从服务器<b>&lt;％url％&gt;下载的吗？id = &lt;％Bot id％&gt;＆app = &lt;％应用程序名称％&gt;</b> </li><li> 伪装成Google Play卡的网络钓鱼窗口打开，并具有输入卡信息的功能。 </li></ul><br> 该应用程序将任何命令的执行结果作为以下格式的JSON对象发送到<b>&lt;％CnC％&gt; \ set_state.php</b> ： <br><br><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"command"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"command"</span></span>:&lt;%command%&gt;, <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>:&lt;%command_id%&gt;, <span class="hljs-attr"><span class="hljs-attr">"state"</span></span>:&lt;%command_state%&gt; } <span class="hljs-string"><span class="hljs-string">"id"</span></span>:&lt;%bot_id%&gt; }</code> </pre> <br>  <b>行动服务</b> <br><br> 应用程序处理的命令列表包括<b>action</b> 。 一旦接收到命令，命令处理模块就访问该服务以便执行扩展命令。 该服务接受JSON对象作为参数。 服务可以执行以下命令： <br><br>  <b>1.</b> <b>PARAMS_ACTION-</b>在接收到这样的命令后，服务首先通过Type密钥从JSON参数接收值，它可能如下： <br><br><ul><li>  <b>serviceInfo-</b>子命令从JSON参数接收<b>includeNotImportant</b>键的值。 如果该标志为True，则应用程序将<b>FLAG_ISOLATED_PROCESS</b>标志设置为使用可访问性服务的服务。 因此，该服务将在单独的过程中启动。 </li><li>  <b>root-</b>获取有关窗口的信息并将其发送到服务器，该窗口现已成为焦点。 应用程序使用AccessibilityNodeInfo类检索信息。 </li><li>  <b>admin-</b>请求管理员权限。 </li><li>  <b>延迟</b> -将ActionsService暂停参数中使用“数据”键指定的毫秒数。 </li><li>  <b>windows-</b>发送对用户可见的窗口列表。 </li><li>  <b>安装</b> -在受感染的设备上安装该应用程序。 包的名称-存档在键“ fileName”中。 存档本身位于下载目录中。 </li><li>  <b>全局</b> -子命令旨在从当前窗口过渡： <br><ul><li> 在快速设置菜单上 </li><li> 回去 </li><li> 家 </li><li> 到通知 </li><li> 到最近打开的应用程序的窗口 </li></ul><br></li><li>  <b>启动</b> -启动应用程序。 应用程序的名称作为<b>数据</b>键的参数来使用。 </li><li>  <b>声音</b> -将声音模式更改为静音。 </li><li>  <b>解锁</b> -以全亮度打开屏幕和键盘的背光。 应用程序使用WakeLock（字符串[Application lable]：INFO）执行此操作。 </li><li>  <b>PermissionOverlay-</b>函数未实现（对命令执行的响应为{“ message”：“不支持”}或{“ message”：“低sdk”}） </li><li>  <b>手势</b> -未实现该功能（命令执行的响应为{“ message”：“不支持”}或{“ message”：“ Low API”}） </li><li>  <b>权限</b> -需要此命令才能请求该应用程序的权限。 但是，查询功能未实现，因此该命令没有意义。 请求的权限列表以JSON数组的形式提供，键为“ permissions”。 标准清单： <br><br><ul><li>  android.permission.READ_PHONE_STATE </li><li>  android.permission.READ_CONTACTS </li><li>  android.permission.CALL_PHONE </li><li>  android.permission.RECEIVE_SMS </li><li>  android.permission.SEND_SMS </li><li>  android.permission.READ_SMS </li><li>  android.permission.READ_EXTERNAL_STORAGE </li><li>  android.permission.WRITE_EXTERNAL_STORAGE </li></ul><br></li><li>  <b>打开</b> -显示网络钓鱼窗口。 根据来自服务器的参数，应用程序可能会显示以下网络钓鱼窗口： <br><br><ul><li> 显示一个网络钓鱼窗口，其内容写入目录<b>&lt;％external directory％&gt; / hgps / &lt;％param_filename％&gt;中的文件中</b> 。 用户与窗口交互的结果将发送到<b>&lt;％CnC％&gt; / records.php</b> </li><li> 显示一个网络钓鱼窗口，该窗口的内容是从地址<b>&lt;％url_param％&gt;</b>中预加载的<b>？id = &lt;％bot_id％&gt;＆app = &lt;％packagename％&gt;</b> 。 用户与窗口交互的结果将发送到<b>&lt;％CnC％&gt; / records.php</b> </li><li> 显示伪装为Google Play卡的网络钓鱼窗口。 </li></ul></li><li>  <b>交互式</b> -该命令旨在使用AcessibilityService与其他应用程序的窗口元素进行交互。 为了进行交互，在程序中实现了特殊服务。 正在研究的应用程序可以与Windows交互： <br><ul><li> 目前处于活跃状态。 在这种情况下，参数包含需要与之交互的对象的ID或文本（名称）。 </li><li> 在执行命令时对用户可见。 该应用程序通过ID选择窗口。 </li></ul><br> 接收到感兴趣的窗口元素的<b>AccessibilityNodeInfo</b>对象后，该应用程序可以根据参数执行以下操作： <br><ul><li>  focus-将焦点设置为对象。 </li><li> 单击-单击一个对象。 </li><li>  actionId-按ID执行操作。 </li><li>  setText-更改对象的文本。 您可以通过两种方式更改文本：执行<b>ACTION_SET_TEXT</b>操作（如果受感染设备的Android版本较新或等于<b>LOLLIPOP</b> ），或者在剪贴板中放置一行并将其粘贴到对象中（对于较旧的版本）。 此命令可用于更改银行应用程序中的数据。 </li></ul></li></ul><br>  <b>2.</b> <b>PARAMS_ACTIONS-</b>与<b>PARAMS_ACTION</b>相同，仅命令的JSON数组出现。 <br><br> 似乎许多人会对与另一个应用程序的窗口元素进行交互的功能的外观感兴趣。 这是在Gustuff中实现此功能的方式： <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">interactiveAction</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(List aiList, JSONObject action, JsonObject res)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> count = action.optInt(<span class="hljs-string"><span class="hljs-string">"repeat"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); Iterator aiListIterator = ((Iterable)aiList).iterator(); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> count = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(aiListIterator.hasNext()) { Object ani = aiListIterator.next(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-number"><span class="hljs-number">1</span></span> &lt;= count) { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> index; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(index = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; ++index) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(action.has(<span class="hljs-string"><span class="hljs-string">"focus"</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(((AccessibilityNodeInfo)ani).performAction(<span class="hljs-number"><span class="hljs-number">1</span></span>)) { ++count; } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(action.has(<span class="hljs-string"><span class="hljs-string">"click"</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(((AccessibilityNodeInfo)ani).performAction(<span class="hljs-number"><span class="hljs-number">16</span></span>)) { ++count; } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(action.has(<span class="hljs-string"><span class="hljs-string">"actionId"</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(((AccessibilityNodeInfo)ani).performAction(action.optInt(<span class="hljs-string"><span class="hljs-string">"actionId"</span></span>))) { ++count; } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(action.has(<span class="hljs-string"><span class="hljs-string">"setText"</span></span>)) { customHeader ch = CustomAccessibilityService.a; Context context = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.getApplicationContext(); String text = action.optString(<span class="hljs-string"><span class="hljs-string">"setText"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(performSetTextAction(ch, context, ((AccessibilityNodeInfo)ani), text)) { ++count; } } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(index == count) { <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } } } ((AccessibilityNodeInfo)ani).recycle(); } res.addPropertyNumber(<span class="hljs-string"><span class="hljs-string">"res"</span></span>, Integer.valueOf(count)); }</code> </pre> <br> 文字替换功能： <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">performSetTextAction</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Context context, AccessibilityNodeInfo ani, String text)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">boolean</span></span> result; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(Build$VERSION.SDK_INT &gt;= <span class="hljs-number"><span class="hljs-number">21</span></span>) { Bundle b = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Bundle(); b.putCharSequence(<span class="hljs-string"><span class="hljs-string">"ACTION_ARGUMENT_SET_TEXT_CHARSEQUENCE"</span></span>, ((CharSequence)text)); result = ani.performAction(<span class="hljs-number"><span class="hljs-number">0x200000</span></span>, b); <span class="hljs-comment"><span class="hljs-comment">// ACTION_SET_TEXT } else { Object clipboard = context.getSystemService("clipboard"); if(clipboard != null) { ((ClipboardManager)clipboard).setPrimaryClip(ClipData.newPlainText("autofill_pm", ((CharSequence)text))); result = ani.performAction(0x8000); // ACTION_PASTE } else { result = false; } } return result; }</span></span></code> </pre> <br> 因此，如果控制服务器配置正确，则Gustuff能够填写银行应用程序中的文本字段，然后单击交易所需的按钮。 特洛伊木马程序甚至不需要在应用程序中得到授权-只需发送命令以演示PUSH通知，然后打开先前安装的银行应用程序即可。 用户将通过授权，之后Gustuff将能够自动填充。 <br><br><h3> 短信处理模块 </h3><br> 应用程序将事件处理程序设置为接受受感染设备的SMS消息。 所研究的应用程序可以从操作员接收SMS消息正文中的命令。 命令采用以下格式： <br><br>  <b>7！5 = &lt;％Base64编码的命令％&gt;</b> <br><br> 该应用程序在所有传入的SMS消息中搜索字符串<b>7！5 =</b> ，如果它检测到字符串，则它将在偏移量4处解码Base64字符串并执行命令。 命令类似于使用CnC的命令。 执行结果将发送到命令发出的相同编号。 答案格式： <br><br>  <b>7 * 5 = &lt;％的“ result_code命令”的Base64编码％</b> <br><br>  （可选）应用程序可以将所有收到的消息发送到根号。 为此，必须在首选项文件中指定根号，并设置消息重定向标志。  SMS消息的格式为： <br><br>  <b>&lt;％from number％&gt;-&lt;％时间，格式：dd / MM / yyyy HH：mm：ss％&gt; &lt;％SMS正文％&gt;</b> <br><br> 同样，应用程序可以选择将消息发送到CnC。  SMS消息以JSON格式发送到服务器： <br><br><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>:&lt;%BotID%&gt;, <span class="hljs-attr"><span class="hljs-attr">"sms"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"text"</span></span>:&lt;%SMS body%&gt;, <span class="hljs-attr"><span class="hljs-attr">"number"</span></span>:&lt;%From number%&gt;, <span class="hljs-attr"><span class="hljs-attr">"date"</span></span>:&lt;%Timestamp%&gt; } }</code> </pre> <br> 如果设置了标志<b>名称生成器（“ DEFAULT_APP_SMS”）</b> ，则应用程序将停止处理SMS消息并清除传入消息列表。 <br><br><h3> 代理模块 </h3><br> 在所研究的应用程序中，有一个Backconnect Proxy模块（以下称为Proxy模块），该模块具有一个单独的类，该类包含具有配置的静态字段。 配置数据以开放格式存储在样本中： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/g-/4f/mi/g-4fmidam6alfsjuhw1ltmcodhy.png" alt="图片替代"></div><br><br> 代理模块执行的所有操作均记录到文件中。 为此，外部存储中的应用程序创建一个名为“ logs”的目录（配置类中的ProxyConfigClass.logsDir字段），该目录中存储了日志文件。 记录发生在具有以下名称的文件中： <br><br><ol><li>  <b>main.txt-</b>此类<b>记录</b>名为CommandServer的类<b>的</b>操作。 将字符串str进一步记录到该文件中将表示为mainLog（str）。 </li><li>  <b>session-&lt;％id％&gt;。txt-</b>与特定代理会话关联的日志数据已保存到此文件。 将字符串str进一步记录到该文件的过程将称为sessionLog（str）。 </li><li>  <b>server.txt-</b>此数据记录写入上述文件的所有数据。 </li></ol><br> 日志数据格式： <br><br>  &lt;％Date％&gt; [线程[&lt;％线程ID％&gt;]，ID []]：日志字符串 <br><br> 代理模块操作期间发生的异常也记录到文件中。 为此，应用程序生成以下格式的JSON对象： <br><br><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"uncaughtException"</span></span>:&lt;%short description of throwable%&gt; <span class="hljs-string"><span class="hljs-string">"thread"</span></span>:&lt;%thread%&gt; <span class="hljs-string"><span class="hljs-string">"message"</span></span>:&lt;%detail message of throwable%&gt; <span class="hljs-string"><span class="hljs-string">"trace"</span></span>: //Stack trace info [ { <span class="hljs-attr"><span class="hljs-attr">"ClassName"</span></span>: <span class="hljs-string"><span class="hljs-string">"FileName"</span></span>: <span class="hljs-string"><span class="hljs-string">"LineNumber"</span></span>: <span class="hljs-string"><span class="hljs-string">"MethodName"</span></span>: }, { <span class="hljs-attr"><span class="hljs-attr">"ClassName"</span></span>: <span class="hljs-string"><span class="hljs-string">"FileName"</span></span>: <span class="hljs-string"><span class="hljs-string">"LineNumber"</span></span>: <span class="hljs-string"><span class="hljs-string">"MethodName"</span></span>: } ] }</code> </pre> <br> 然后将其转换为字符串表示形式并进行记录。 <br><br> 收到相应团队后，将启动代理模块。 当命令到达以启动Proxy模块时，应用程序将启动一个名为<b>MainService</b>的服务，该服务负责控制Proxy模块的操作-其启动和停止。 <br><br> 启动服务的阶段： <br><br>  <b>1.</b>启动一个计时器，该计时器每分钟工作一次，并检查代理模块的活动。 如果模块未激活，则将其启动。 <br> 另外，触发<b>android.net.conn.CONNECTIVITY_CHANGE</b>事件时，代理模块也会启动。 <br><br>  <b>2.</b>应用程序使用<b>PARTIAL_WAKE_LOCK</b>参数创建唤醒锁并捕获它。 因此，它不允许设备的CPU进入睡眠模式。 <br><br>  <b>3.</b>首先登录mainLog行<b>（“启动服务器”）</b>并启动代理模块命令处理类，然后 <br><br>  <b>服务器::开始（）主机[&lt;％proxy_cnc％&gt;]，commandPort [&lt;％command_port％&gt;]，proxyPort [&lt;％proxy_port％&gt;]</b> <br><br> 其中<b>proxy_cnc，command_port和proxy_port</b>是从代理服务器配置获得的参数。 <br><br> 命令处理类称为<b>CommandConnection</b> 。 启动后，它将立即执行以下操作： <br><br>  <b>4.</b>连接到<b>ProxyConfigClass.host：ProxyConfigClass.commandPort</b>并以JSON格式向其中发送有关受感染设备的数据： <br><br><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>:&lt;%id%&gt;, <span class="hljs-attr"><span class="hljs-attr">"imei"</span></span>:&lt;%imei%&gt;, <span class="hljs-attr"><span class="hljs-attr">"imsi"</span></span>:&lt;%imsi%&gt;, <span class="hljs-attr"><span class="hljs-attr">"model"</span></span>:&lt;%model%&gt;, <span class="hljs-attr"><span class="hljs-attr">"manufacturer"</span></span>:&lt;%manufacturer%&gt;, <span class="hljs-attr"><span class="hljs-attr">"androidVersion"</span></span>:&lt;%androidVersion%&gt;, <span class="hljs-attr"><span class="hljs-attr">"country"</span></span>:&lt;%country%&gt;, <span class="hljs-attr"><span class="hljs-attr">"partnerId"</span></span>:&lt;%partnerId%&gt;, <span class="hljs-attr"><span class="hljs-attr">"packageName"</span></span>:&lt;%packageName%&gt;, <span class="hljs-attr"><span class="hljs-attr">"networkType"</span></span>:&lt;%networkType%&gt;, <span class="hljs-attr"><span class="hljs-attr">"hasGsmSupport"</span></span>:&lt;%hasGsmSupport%&gt;, <span class="hljs-attr"><span class="hljs-attr">"simReady"</span></span>:&lt;%simReady%&gt;, <span class="hljs-attr"><span class="hljs-attr">"simCountry"</span></span>:&lt;%simCountry%&gt;, <span class="hljs-attr"><span class="hljs-attr">"networkOperator"</span></span>:&lt;%networkOperator%&gt;, <span class="hljs-attr"><span class="hljs-attr">"simOperator"</span></span>:&lt;%simOperator%&gt;, <span class="hljs-attr"><span class="hljs-attr">"version"</span></span>:&lt;%version%&gt; }</code> </pre> <br> 其中： <br><br><ul><li>  id-标识符，尝试从名称为“ x”的共享首选项文件中获取字段为“ id”的值。 如果无法获得该值，它将生成一个新值。  , Proxy-  ̆ , ̆   Bot ID. </li><li> imei — IMEI ̆.        —         . </li><li> imsi — International Mobile Subscriber Identity ̆.        —         . </li><li> model — The end-user-visible name for the end product. </li><li> manufacturer — The manufacturer of the product/hardware (Build.MANUFACTURER). </li><li> androidVersion —    "&lt;%release_version%&gt; (&lt;%os_version%&gt;),&lt;%sdk_version%&gt;" </li><li> country —   ̆. </li><li> partnerId –  . </li><li> packageName – package name. </li><li> networkType —     (: «WIFI», «MOBILE»).     null. </li><li> hasGsmSupport – true –    GSM,  false. </li><li> simReady –  SIM-. </li><li> simCountry — ISO-  (  ̆ -). </li><li> networkOperator —  .        —         . </li><li> simOperator — The Service Provider Name (SPN).        —         . </li><li> version —     -,   ̆     «1.6». </li></ul><br> <b>5.</b>       .      : <br><br><ul><li> 0 offset – command </li><li> 1 offset – sessionId </li><li> 2 offset – length </li><li> 4 offset — data </li></ul><br>     : <br><br> <b>mainLog(«Header { sessionId&lt;%id%&gt;], type[&lt;%command%&gt;], length[&lt;%length%&gt;] }»)</b> <br><br>     : <br><br><table><tbody><tr><th> Name </th><th> Command </th><th> Data </th><th> 内容描述 </th></tr><tr><td> <b>connectionId</b> </td><td>  0 </td><td> Connection ID </td><td>    </td></tr><tr><td> <b>SLEEP</b> </td><td> 3 </td><td> 时间 </td><td>   Proxy- </td></tr><tr><td> <b>PING_PONG</b> </td><td> 4 </td><td>  -- </td><td>  PONG- </td></tr></tbody></table><br> PONG-   4     : <b>0x04000000</b> . <br><br>    connectionId (   ) <b>CommandConnection</b>    <b>ProxyConnection</b> . <br><br><ul><li>      : <b>ProxyConnection</b>  <b>end</b> .    <b>ProxyConnection</b>     <b>ProxyConfigClass.host</b> : <b>ProxyConfigClass.proxyPort</b>   JSON-: </li></ul><br><pre> <code class="json hljs"> { <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>:&lt;%connectionId%&gt; }</code> </pre> <br>     SOCKS5-,     ,     . ̆       <b>end</b> .       : <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/hz/ed/y7/hzedy7sapdijp20ayiacbiwarc8.png" alt="图片替代"></div><br><h2>  ̆ </h2><br>       ̆  CnC-        SSL.             JSON-.       : <br><br><ul><li> <b>http://&lt;%CnC%&gt;/api/v1/set_state.php</b> —   . </li><li> <b>http://&lt;%CnC%&gt;/api/v1/get.php</b> —  . </li><li> <b>http://&lt;%CnC%&gt;/api/v1/load_sms.php</b> —  SMS-̆   ̆. </li><li> <b>http://&lt;%CnC%&gt;/api/v1/load_ab.php</b> —      ̆. </li><li> <b>http://&lt;%CnC%&gt;/api/v1/aevents.php</b> –     ,   preference-̆. </li><li> <b>http://&lt;%CnC%&gt;/api/v1/set_card.php</b> —  ,    -,   Google Play Market. </li><li> <b>http://&lt;%CnC%&gt;/api/v1/logs.php</b> –  -. </li><li> <b>http://&lt;%CnC%&gt;/api/v1/records.php</b> –  ,     . </li><li> <b>http://&lt;%CnC%&gt;/api/v1/set_error.php</b> –   ̆ . </li></ul><br><h2>  </h2><br>              ,          ,     . <br><br>              ,    .               ,   ,             . <br><br>    –   - ,      ,      -,    , ,     ,       ,     . <br><br><h3>    : </h3><br><ul><li>         Android  - ,  Google Play; </li><li>     <b> </b>    ; </li><li>     Android; </li><li>      ; </li><li>    ; </li><li>    ,   SMS-. </li></ul><br>   <b> </b> ,          Group-IB. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN446948/">https://habr.com/ru/post/zh-CN446948/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN446932/index.html">TDMS航道和BIM</a></li>
<li><a href="../zh-CN446938/index.html">核心动画中的粒子系统。 圣诞故事</a></li>
<li><a href="../zh-CN446940/index.html">对产品进行质量检查。 为什么很酷</a></li>
<li><a href="../zh-CN446942/index.html">服务器，您能听到我说话吗？ NeoQUEST-2019任务示例的BROP攻击</a></li>
<li><a href="../zh-CN446944/index.html">为什么要投资无利可图的公司？</a></li>
<li><a href="../zh-CN446950/index.html">76％的制造商没有实施添加剂的经验-为什么如此好</a></li>
<li><a href="../zh-CN446952/index.html">使用R创建动画直方图</a></li>
<li><a href="../zh-CN446956/index.html">它对光线有害，或者如何保持汽车电池的电量</a></li>
<li><a href="../zh-CN446958/index.html">Tricky Perl Quine</a></li>
<li><a href="../zh-CN446960/index.html">杰克建的房子</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>