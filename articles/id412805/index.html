<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🐑 😕 👉 Langkah-langkah saya, keberhasilan dan kesalahan dalam dunia dev game dengan contoh bot game di Telegram 🅿️ 💃 👂🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Halo semuanya! Nama saya Maxim dan saya ingin menceritakan kisah pembuatan proyek Wasteland Wars. Saya harap Anda akan tertarik, dan mungkin beberapa ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Langkah-langkah saya, keberhasilan dan kesalahan dalam dunia dev game dengan contoh bot game di Telegram</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/412805/">  Halo semuanya!  Nama saya Maxim dan saya ingin menceritakan kisah pembuatan proyek Wasteland Wars.  Saya harap Anda akan tertarik, dan mungkin beberapa di antaranya dapat membantu Anda menghindari kesalahan saya. <br><a name="habracut"></a><br><h2>  Pemilihan platform </h2><br>  Telegram adalah platform yang sangat tidak standar untuk membuat game online.  Terutama ketika datang ke MMORPG.  Saya bertanya-tanya apakah mungkin untuk menciptakan produk yang berkualitas di platform ini sama sekali, dan jika demikian, apakah akan ada permintaan untuk itu sama sekali.  Jadi, pada Juni 2017, saya mulai mengembangkan Wasteland Wars. <br><br><h2>  Virality </h2><br>  Pada hari-hari awal pengembangan, diputuskan untuk mengumpulkan kelompok fokus dari teman-teman saya untuk tes permainan.  Lagi pula, ketika berhadapan dengan IMO, pengujian saja ternyata bermasalah.  Jadi saya meluncurkan uji beta tertutup game, membuat akses ke bot menggunakan kunci satu kali.  Setelah menghasilkan 10 buah seperti itu, saya mengirimnya ke teman-teman saya di TG.  Sistem rujukan sudah ditambahkan ke titik ini, meskipun sebenarnya tidak bekerja mengingat pengujian tertutup.  Intinya adalah bahwa untuk setiap orang yang terdaftar dalam permainan sesuai dengan referensi Anda.  Tautkan, pemain mendapat +1 ke stamina maksimum dan beberapa topi (mata uang lokal) untuk pengeluaran saku.  Ini mengarah pada fakta bahwa setelah 2 minggu dari awal PTA, 50 orang mengambil bagian di dalamnya, dan pesan pribadi saya penuh dengan permintaan dari orang-orang untuk memberi mereka 1-2-10 kunci lagi untuk teman-teman mereka.  Alih-alih terus-menerus menghasilkan kunci baru, saya memutuskan untuk fokus memperbaiki bug yang ditemukan dalam pengujian dan meluncurkan uji beta terbuka, tidak mendaftar dengan kunci.  Pada hari pertama MBT, 120 orang mendaftar dalam game.  Sebulan kemudian, online hariannya adalah 200-250 orang per hari, dan jumlah total pemain terdaftar mendekati 800. Dan semua ini tanpa ada gerakan di bagian PR saya, permainan menjadi dikenal secara eksklusif berkat sistem komunikasi dari mulut ke mulut dan rujukan. <br><br><h2>  Memproyeksikan fitur yang disukai pemain </h2><br>  Selama pengujian, pemain mencatat genre permainan yang sangat tidak biasa untuk format ini, pertempuran PVT lengkap dan sistem pemompaan pemain tanpa poin keterampilan klasik dan peningkatan level.  Tapi, yang mengejutkan saya - kebanyakan orang memuji teks permainan, terutama memperhatikan kualitas humor, referensi budaya populer dan situasi atmosfer, kontras dengan humor hitam dengan drama mereka. <br><br><h2>  Rincian teknis </h2><br>  Kesulitan pertama yang terkait dengan platform Bot API muncul di hari-hari pertama pengembangan.  Telegram memiliki 2 sistem utama untuk menghubungkan bot mereka ke server Anda: yang disebut Long Polling dan Webhooks.  Yang pertama menyiratkan bahwa server Anda akan terus-menerus melakukan polling Telegram pada interval tertentu untuk permintaan baru, dan jika ada, itu akan memprosesnya dengan mengembalikan respons Bot API.  Yang kedua sedikit lebih sulit untuk diterapkan - ini terdiri dari fakta bahwa server Anda memberi tahu Telegram "jika Anda memiliki permintaan, letakkan di alamat ini."  Dengan demikian, untuk menerapkan bot menggunakan teknologi Webhooks, diperlukan alamat IP permanen dan sertifikat SSL, setidaknya ditandatangani sendiri.  Setelah memulai pengembangan berdasarkan Long Polling, pada awalnya saya tidak melihat adanya masalah yang terkait dengan metode ini.  Namun, setelah seharian beroperasi terus-menerus, bot itu secara tak terduga jatuh.  Telegram mulai mengembalikan kesalahan ketika menerima permintaan.  Ternyata, masalah ini mengganggu sepenuhnya semua bot berbasis Polling Panjang - telegram menutup pemrosesan permintaan dari bot setelah beberapa waktu, karena itu Anda harus terus-menerus menyalakannya kembali.  Pertama, saya memutuskan untuk mencoba mengotomatiskan proses "reanimation" bot dengan menulis skrip cron untuk memeriksa denyut nadi proses dan memulai kembali jika pasien tidak menanggapi stick poke.  Namun, proses restart konstan ini menyebabkan ketidaknyamanan bagi pemain, seperti  membutuhkan waktu, dan juga mengatur ulang penghitung waktu saat ini dalam permainan.  Akibatnya, proyek dipindahkan ke Webhooks, dan masalah ini segera hilang. <br><br>  Lebih jauh dalam hal kompleksitas dari Bot API itu sendiri, semuanya tenang.  Sampai suatu saat. <br><br>  Proyek ini mendapatkan ruang lingkup, membangun audiens dan terus berkembang.  Pada satu titik, bot itu tiba-tiba mulai "tumpul" setelah menerima permintaan.  Lebih tepatnya, ada keterlambatan dalam respons bot terhadap pemain.  Pertama-tama, saya naik ke server, berpikir bahwa itu telah berhenti untuk mengatasi meningkatnya jumlah permintaan.  Tapi tidak, beban server tidak melebihi 30% pada waktu puncak, tidak ada masalah dengan memori bebas, tidak ada kesalahan dan peringatan di log sistem.  Tetapi rem terus tumbuh.  Ternyata, bot mulai bertumpu pada batas Bot API dalam hal jumlah permintaan simultan untuk itu.  Pada awalnya, saya berhasil mengurangi dan mengoptimalkan bot untuk mengurangi jumlah ini.  Namun, ketika permainan menyebar ke massa, menjadi jelas: segera bot akan mencapai langit-langit ini dan tidak ada optimasi yang akan membantu saya.  Kemudian diputuskan untuk menulis mendukung Telegram dengan permintaan untuk meningkatkan batas khusus untuk bot saya.  Dan saya sangat terkejut, mereka menjawab keesokan harinya, dan batasnya bertambah, meskipun mereka tidak menyebutkan ambang baru.  Selain itu, mereka memberi tahu saya bahwa bot bertumpu pada batas untuk jenis permintaan tertentu - Callback pada apa yang disebut.  Tombol sebaris.  Ini adalah keyboard di Telegram, yang ditampilkan di bawah pesan tertentu.  Untuk permintaan teks (termasuk yang dengan tombol biasa), batasnya jauh lebih tinggi, dan juga tidak ada batas 15 detik untuk respons dari server.  Masalahnya adalah bahwa 70% dari antarmuka game dibangun di atas tombol inline.  Saya harus mengolahnya sepenuhnya untuk menyingkirkan kejahatan ini, begitu nyaman dan indah. <br><br>  Masalah selanjutnya yang dihadapi proyek adalah sudah ada di lingkungan pengembangan dan kode saya.  Secara khusus, dalam Python 3 dan cara kerjanya dengan utas.  Setiap utas baru di Python 3 dibuat bersama dengan variabel lingkungan, memakan sejumlah besar memori.  Gim ini penuh timer (2 menit untuk beralih di antara lokasi, menunggu pertempuran, dll.), Dan meluncurkannya di aliran terpisah membuat kebocoran memori.  Seiring permainan online tumbuh, kebocoran telah mencapai skala gila, melahap semua kemungkinan RAM dan memompa memori yang tersisa dari server SSD.  Tentu saja, masalah itu diselesaikan dengan membuat antrian timer yang diproses dalam satu utas untuk setiap jenis. <br><br><h2>  Bagian visual dalam permainan teks </h2><br>  Salah satu fitur utama dari Wasteland Wars relatif terhadap permainan serupa lainnya di Telegram adalah pengenalan bagian visual.  Avatar interaktif karakter ditambahkan ke permainan, serta tampilan visual dari setiap item peralatan dalam permainan.  Seperti dalam RPG ukuran penuh pada platform game, pemain dapat mendandani karakternya dengan baju besi berbeda, memberinya senjata yang berbeda, dan kemudian melihat semua perubahan secara visual.  Beberapa saat kemudian, saya mengembangkan ide ini, sekarang ketika pemain lain bertemu dalam permainan, avatarnya juga ditampilkan - dengan cara ini menjadi mungkin untuk tidak mengetahui pemompaan musuh, untuk mengevaluasi bahayanya dalam penampilan.  Selain peralatan, "Masker" juga ditampilkan pada avatar - mereka dapat dibeli untuk sumbangan, mereka tidak memberikan keuntungan bagi pemain, tetapi mereka mengubah penampilannya di avatar.  Selain itu, peta interaktif lengkap muncul di game.  Karena setiap lokasi ditemukan, itu ditambahkan ke pemain di peta. <br><br>  Semua gambar ditampilkan dalam resolusi yang cukup rendah, cukup untuk memahami kontennya.  Ini karena fakta bahwa avatar dan peta dikumpulkan dari banyak elemen berbeda untuk setiap pemain, dan dengan sejumlah besar permintaan simultan, perakitan mereka dalam resolusi tinggi dapat secara signifikan memuat server game. <br><br><h2>  Rencana pengembangan proyek </h2><br>  Saat ini, gim tersebut sedang disalin ke Go - bahasa ini, ternyata, jauh lebih cocok untuk pengembangan proyek semacam itu.  Memiliki server web saya sendiri di Go dan kecepatannya memungkinkan saya untuk mulai membuat API saya sendiri untuk proyek untuk melepaskannya dari satu platform tunggal di Telegram.  API akan memungkinkan Anda untuk menerima dan memproses permintaan dari klien mana pun, dan semua logika hanya akan diproses di server. <br><br>  Dengan demikian, mengembangkan klien untuk platform apa pun akan sesederhana klien itu sendiri, ini akan menghindari banyak keterbatasan Telegram, kesulitan memblokirnya, serta menarik sejumlah besar audiens baru ke permainan. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id412805/">https://habr.com/ru/post/id412805/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id412795/index.html">Dan mari kita menarik kesimpulan dari diskusi artikel "Apa yang salah dengan kembalinya Geektimes ke Habr"</a></li>
<li><a href="../id412797/index.html">Tentang bahaya CDN, layanan, dan font dari Google</a></li>
<li><a href="../id412799/index.html">Selalu berkomunikasi: Mango Talker - messenger dan softphone</a></li>
<li><a href="../id412801/index.html">Studi: peretas mencuri jutaan dolar karena keamanan pertukaran mata uang kripto yang rendah</a></li>
<li><a href="../id412803/index.html">Pandangan yang lebih dalam pada berbagai platform kontrak pintar</a></li>
<li><a href="../id412807/index.html">Catatan dari penyedia IoT. Propriety</a></li>
<li><a href="../id412809/index.html">Otentikasi dua faktor di situs menggunakan token USB. Bagaimana cara membuat akses ke portal layanan aman?</a></li>
<li><a href="../id412811/index.html">C DevTools on Elbrus: laporan yang jelas dari HolyJS 2018 Piter</a></li>
<li><a href="../id412813/index.html">Header HTTP yang tidak perlu</a></li>
<li><a href="../id412815/index.html">Manajer Web, OpenVPN Client Keys VPNFace Lite</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>